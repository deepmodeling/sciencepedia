{
    "hands_on_practices": [
        {
            "introduction": "Before building complex numerical simulations, it is essential to master the fundamental analytical model of a detonation. This exercise guides you through the derivation of the Chapman-Jouguet (CJ) detonation speed from first principles, using the Zeldovich–von Neumann–Döring (ZND) model . By applying the conservation laws for mass, momentum, and energy across the wave, you will see how a unique, stable detonation velocity emerges from the interplay of fluid dynamics, thermodynamics, and chemical energy release.",
            "id": "4045497",
            "problem": "Consider a one-dimensional planar detonation modeled by the Zeldovich–von Neumann–Döring (ZND) framework, in which a leading inert shock is followed by a finite reaction zone that releases a fixed specific heat $q$ and reaches thermochemical equilibrium at the end of the reaction zone. Assume a calorically perfect ideal gas with constant ratio of specific heats $\\gamma$, gas constant $R$, and a single overall irreversible reaction with heat release $q$ per unit mass. Work in the detonation-wave-attached frame and treat the shock and the reaction zone as inviscid, steady, and one-dimensional.\n\nGiven the initial unburned state $(p_{1}, T_{1})$, use the fundamental conservation laws for mass, momentum, and energy, together with the ideal gas equation of state, to:\n- derive the post-shock von Neumann state immediately behind the inert shock (no reaction),\n- apply the reaction while preserving the conserved mass and momentum fluxes to reach the ZND final equilibrium state,\n- enforce the Chapman–Jouguet (CJ) condition by requiring the flow at the end of the reaction zone to be sonic relative to the detonation front,\n- and compute the corresponding CJ detonation speed $D_{\\mathrm{CJ}}$.\n\nUse only the following foundational relations throughout your derivation:\n- mass conservation: $m = \\rho u$ (constant through shock and reaction zone),\n- momentum conservation: $p + m^{2} v = \\text{constant}$,\n- energy conservation: $h + \\frac{u^{2}}{2} = \\text{constant}$ across the shock, and $h + \\frac{u^{2}}{2}$ increases by $q$ across the reaction zone,\n- ideal gas: $p = \\rho R T$, $h = \\frac{\\gamma}{\\gamma - 1} \\frac{p}{\\rho}$, $v = \\frac{1}{\\rho}$.\n\nData:\n- $p_{1} = 1.01325 \\times 10^{5}$,\n- $T_{1} = 300$,\n- $\\gamma = 1.4$,\n- $R = 287$,\n- $q = 3.0 \\times 10^{6}$.\n\nCompute $D_{\\mathrm{CJ}}$ and express the final answer in $\\mathrm{m/s}$. Round your answer to four significant figures.",
            "solution": "The user wants me to solve a problem based on the Zeldovich–von Neumann–Döring (ZND) model of detonation.\n\n### 1. Problem Validation\n\n#### Step 1: Extract Givens\n- **Framework**: One-dimensional planar detonation, ZND model, calorically perfect ideal gas.\n- **Assumptions**: Inviscid, steady, one-dimensional shock and reaction zone.\n- **Initial State (Unburned Gas, State 1)**: $p_1 = 1.01325 \\times 10^{5} \\, \\text{Pa}$, $T_1 = 300 \\, \\text{K}$.\n- **Gas Properties**: Ratio of specific heats $\\gamma = 1.4$, gas constant $R = 287 \\, \\text{J/(kg}\\cdot\\text{K)}$.\n- **Reaction**: Single irreversible reaction with specific heat release $q = 3.0 \\times 10^{6} \\, \\text{J/kg}$.\n- **Conservation Laws (wave-attached frame)**:\n    - Mass: $m = \\rho u = \\text{constant}$\n    - Momentum: $p + m^{2} v = \\text{constant}$, where $v=1/\\rho$.\n    - Energy (shock): $h + \\frac{u^{2}}{2} = \\text{constant}$\n    - Energy (reaction): $h + \\frac{u^{2}}{2}$ increases by $q$.\n- **Equation of State**:\n    - Ideal Gas Law: $p = \\rho R T$\n    - Specific Enthalpy: $h = \\frac{\\gamma}{\\gamma - 1} \\frac{p}{\\rho}$\n- **Condition**: Chapman–Jouguet (CJ) condition: flow at the end of the reaction zone is sonic relative to the detonation front.\n- **Objective**: Compute the CJ detonation speed, $D_{\\mathrm{CJ}}$, in $\\mathrm{m/s}$ and round to four significant figures.\n\n#### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a classic problem in combustion theory based on the well-established ZND model. The provided data are physically realistic for a gaseous mixture. The problem is well-posed, providing all necessary information ($\\gamma, R, q, T_1$) to calculate the CJ detonation speed, a unique value under the given assumptions. The language is objective and precise. The problem does not violate any of the invalidity criteria.\n\n#### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### 2. Solution Derivation\n\nThe problem asks for the detonation speed $D_{\\mathrm{CJ}}$ for a ZND detonation wave satisfying the Chapman-Jouguet condition. We work in a coordinate system attached to the detonation wave. In this frame, the unburned gas (state 1) enters the stationary wave at a speed $u_1$, which is equal to the detonation speed in the laboratory frame, $D$. The burned gas (state 2) exits the wave at a speed $u_2$.\n\nThe governing equations for the overall change from state 1 to state 2 are the Rankine-Hugoniot relations for a reacting flow:\n1.  **Mass Conservation**:\n    $$m = \\rho_1 u_1 = \\rho_2 u_2$$\n2.  **Momentum Conservation**:\n    $$p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2$$\n3.  **Energy Conservation**:\n    $$h_1 + \\frac{u_1^2}{2} + q = h_2 + \\frac{u_2^2}{2}$$\n\nWe use the ideal gas relations: $h = \\frac{\\gamma}{\\gamma-1} \\frac{p}{\\rho}$ and the speed of sound $c = \\sqrt{\\gamma \\frac{p}{\\rho}} = \\sqrt{\\gamma R T}$. Thus, the enthalpy can be written as $h = \\frac{c^2}{\\gamma-1}$.\n\nThe Chapman-Jouguet (CJ) condition states that for a self-sustaining detonation, the flow at the end of the reaction zone (state 2) is sonic with respect to the wave.\n$$u_2 = c_2$$\n\nThe logical path to the solution is to use the CJ condition to determine the unique detonation speed, $D_{\\mathrm{CJ}}$. Let $u_1 = D_{\\mathrm{CJ}}$. The detonation Mach number is $M_{\\mathrm{CJ}} = D_{\\mathrm{CJ}}/c_1$. Let's express the state variables in terms of $M_{\\mathrm{CJ}}$.\n\nFrom the momentum equation, using $u_1 = D_{\\mathrm{CJ}}$ and $u_2=c_2$:\n$$p_1 + \\rho_1 D_{\\mathrm{CJ}}^2 = p_2 + \\rho_2 c_2^2$$\nUsing $c_2^2 = \\gamma p_2/\\rho_2$, we get:\n$$p_1 + \\rho_1 D_{\\mathrm{CJ}}^2 = p_2 + \\rho_2 (\\gamma p_2/\\rho_2) = p_2(1+\\gamma)$$\nRearranging for the pressure ratio $p_2/p_1$:\n$$\\frac{p_2}{p_1} = \\frac{p_1 + \\rho_1 D_{\\mathrm{CJ}}^2}{p_1(1+\\gamma)} = \\frac{1 + \\frac{\\rho_1 D_{\\mathrm{CJ}}^2}{p_1}}{1+\\gamma}$$\nRecognizing that $\\frac{\\rho_1 D_{\\mathrm{CJ}}^2}{p_1} = \\frac{\\gamma \\rho_1 D_{\\mathrm{CJ}}^2}{\\gamma p_1} = \\gamma \\frac{D_{\\mathrm{CJ}}^2}{c_1^2} = \\gamma M_{\\mathrm{CJ}}^2$, we have:\n$$\\frac{p_2}{p_1} = \\frac{1 + \\gamma M_{\\mathrm{CJ}}^2}{1+\\gamma}$$\n\nNext, we combine the mass and momentum equations to find the specific volume ratio $v_2/v_1 = \\rho_1/\\rho_2$.\nThe momentum equation can be written as $p_2 - p_1 = m^2(v_1 - v_2)$, where $v=1/\\rho$. From the CJ condition, we can also relate the mass flux $m$ to the properties at state 2.\n$$m = \\rho_2 u_2 = \\rho_2 c_2 \\implies m^2 = \\rho_2^2 c_2^2 = \\rho_2^2 \\frac{\\gamma p_2}{\\rho_2} = \\gamma p_2 \\rho_2 = \\frac{\\gamma p_2}{v_2}$$\nEquating the two expressions for $m^2$:\n$$\\frac{p_2 - p_1}{v_1 - v_2} = \\frac{\\gamma p_2}{v_2}$$\n$$(p_2 - p_1)v_2 = \\gamma p_2(v_1-v_2) \\implies p_2 v_2 (1+\\gamma) = \\gamma p_2 v_1 + p_1 v_2$$\nDividing by $p_2 v_2$ gives the relation $1+\\gamma = \\gamma \\frac{v_1}{v_2} + \\frac{p_1}{p_2}$.\nFrom this, we find the specific volume ratio:\n$$\\frac{v_2}{v_1} = \\frac{\\rho_1}{\\rho_2} = \\frac{1}{\\gamma} \\frac{v_1}{v_2}(1+\\gamma - \\frac{p_1}{p_2})$$\nNo, this is circular. Use $\\frac{v_1}{v_2} = \\frac{1}{\\gamma}(1+\\gamma - \\frac{p_1}{p_2})$.\nSubstitute the pressure ratio:\n$$\\frac{v_1}{v_2} = \\frac{1}{\\gamma}\\left(1+\\gamma - \\frac{1+\\gamma}{1+\\gamma M_{\\mathrm{CJ}}^2}\\right) = \\frac{1+\\gamma}{\\gamma}\\left(1 - \\frac{1}{1+\\gamma M_{\\mathrm{CJ}}^2}\\right) = \\frac{1+\\gamma}{\\gamma}\\left(\\frac{\\gamma M_{\\mathrm{CJ}}^2}{1+\\gamma M_{\\mathrm{CJ}}^2}\\right) = \\frac{(1+\\gamma)M_{\\mathrm{CJ}}^2}{1+\\gamma M_{\\mathrm{CJ}}^2}$$\nTherefore, the specific volume ratio is:\n$$\\frac{v_2}{v_1} = \\frac{1+\\gamma M_{\\mathrm{CJ}}^2}{(1+\\gamma)M_{\\mathrm{CJ}}^2}$$\n\nNow we use the energy equation, substituting $h = c^2/(\\gamma-1)$, $u_1=D_{\\mathrm{CJ}}=M_{\\mathrm{CJ}}c_1$, and $u_2=c_2$:\n$$\\frac{c_1^2}{\\gamma-1} + \\frac{M_{\\mathrm{CJ}}^2 c_1^2}{2} + q = \\frac{c_2^2}{\\gamma-1} + \\frac{c_2^2}{2}$$\n$$c_2^2\\left(\\frac{1}{\\gamma-1} + \\frac{1}{2}\\right) - c_1^2\\left(\\frac{1}{\\gamma-1} + \\frac{M_{\\mathrm{CJ}}^2}{2}\\right) = q$$\n$$c_2^2\\frac{\\gamma+1}{2(\\gamma-1)} - c_1^2\\frac{2 + M_{\\mathrm{CJ}}^2(\\gamma-1)}{2(\\gamma-1)} = q$$\nDivide by $c_1^2$ and multiply by $2(\\gamma-1)$:\n$$\\frac{c_2^2}{c_1^2}(\\gamma+1) - (2 + M_{\\mathrm{CJ}}^2(\\gamma-1)) = \\frac{2(\\gamma-1)q}{c_1^2}$$\nThe ratio of sound speeds squared is $\\frac{c_2^2}{c_1^2} = \\frac{\\gamma p_2 v_2}{\\gamma p_1 v_1} = \\frac{p_2}{p_1}\\frac{v_2}{v_1}$.\n$$\\frac{c_2^2}{c_1^2} = \\left(\\frac{1 + \\gamma M_{\\mathrm{CJ}}^2}{1+\\gamma}\\right)\\left(\\frac{1+\\gamma M_{\\mathrm{CJ}}^2}{(1+\\gamma)M_{\\mathrm{CJ}}^2}\\right) = \\frac{(1+\\gamma M_{\\mathrm{CJ}}^2)^2}{(1+\\gamma)^2 M_{\\mathrm{CJ}}^2}$$\nSubstitute this into the energy equation:\n$$\\frac{(1+\\gamma M_{\\mathrm{CJ}}^2)^2}{(1+\\gamma)^2 M_{\\mathrm{CJ}}^2}(\\gamma+1) - (2 + M_{\\mathrm{CJ}}^2(\\gamma-1)) = \\frac{2(\\gamma-1)q}{c_1^2}$$\n$$\\frac{(1+\\gamma M_{\\mathrm{CJ}}^2)^2}{(1+\\gamma) M_{\\mathrm{CJ}}^2} - (2 + M_{\\mathrm{CJ}}^2(\\gamma-1)) = \\frac{2(\\gamma-1)q}{c_1^2}$$\nMultiplying the second term by $\\frac{(1+\\gamma)M_{\\mathrm{CJ}}^2}{(1+\\gamma)M_{\\mathrm{CJ}}^2}$ and combining numerators:\n$$(1+\\gamma M_{\\mathrm{CJ}}^2)^2 - (2 + M_{\\mathrm{CJ}}^2(\\gamma-1))(1+\\gamma)M_{\\mathrm{CJ}}^2 = (1+\\gamma)M_{\\mathrm{CJ}}^2 \\frac{2(\\gamma-1)q}{c_1^2}$$\n$$(1+2\\gamma M_{\\mathrm{CJ}}^2 + \\gamma^2 M_{\\mathrm{CJ}}^4) - (2(1+\\gamma)M_{\\mathrm{CJ}}^2 + (\\gamma-1)(\\gamma+1)M_{\\mathrm{CJ}}^4) = 2(\\gamma^2-1)M_{\\mathrm{CJ}}^2 \\frac{q}{c_1^2}$$\n$$(1+2\\gamma M_{\\mathrm{CJ}}^2 + \\gamma^2 M_{\\mathrm{CJ}}^4) - (2+2\\gamma)M_{\\mathrm{CJ}}^2 - (\\gamma^2-1)M_{\\mathrm{CJ}}^4 = 2(\\gamma^2-1)M_{\\mathrm{CJ}}^2 \\frac{q}{c_1^2}$$\n$$1 - 2M_{\\mathrm{CJ}}^2 + M_{\\mathrm{CJ}}^4 = 2(\\gamma^2-1)M_{\\mathrm{CJ}}^2 \\frac{q}{c_1^2}$$\n$$(M_{\\mathrm{CJ}}^2 - 1)^2 = 2(\\gamma^2-1)M_{\\mathrm{CJ}}^2 \\frac{q}{c_1^2}$$\nThis simplifies to a standard result relating the Mach number to the heat release:\n$$\\frac{(M_{\\mathrm{CJ}}^2 - 1)^2}{M_{\\mathrm{CJ}}^2} = \\frac{2(\\gamma^2-1)q}{c_1^2} = \\frac{2(\\gamma^2-1)q}{\\gamma R T_1}$$\nLet $X = M_{\\mathrm{CJ}}^2$. Let the constant on the right be $C = \\frac{2(\\gamma^2-1)q}{\\gamma R T_1}$.\n$$(X-1)^2 = CX \\implies X^2 - 2X + 1 = CX \\implies X^2 - (2+C)X + 1 = 0$$\nThis is a quadratic equation for $M_{\\mathrm{CJ}}^2$. The physically meaningful solution for a detonation must have $M_{\\mathrm{CJ}}>1$, corresponding to the larger root:\n$$M_{\\mathrm{CJ}}^2 = \\frac{(2+C) + \\sqrt{(2+C)^2-4}}{2} = 1 + \\frac{C}{2} + \\sqrt{C + \\frac{C^2}{4}}$$\nAn equivalent, more elegant form for $M_{\\mathrm{CJ}}$ is:\n$$M_{\\mathrm{CJ}} = \\sqrt{1 + Q} + \\sqrt{Q} \\quad \\text{where} \\quad Q = \\frac{(\\gamma^2-1)q}{2\\gamma R T_1}$$\n\n### 3. Numerical Calculation\nWe are given:\n- $\\gamma = 1.4$\n- $R = 287 \\, \\text{J/(kg}\\cdot\\text{K)}$\n- $T_1 = 300 \\, \\text{K}$\n- $q = 3.0 \\times 10^6 \\, \\text{J/kg}$\n\nFirst, we calculate the initial speed of sound $c_1$:\n$$c_1 = \\sqrt{\\gamma R T_1} = \\sqrt{1.4 \\times 287 \\times 300} = \\sqrt{120540} \\approx 347.1887 \\, \\mathrm{m/s}$$\nNext, we calculate the dimensionless heat release parameter $Q$:\n$$\\gamma^2 - 1 = 1.4^2 - 1 = 1.96 - 1 = 0.96$$\n$$Q = \\frac{(\\gamma^2-1)q}{2\\gamma R T_1} = \\frac{0.96 \\times (3.0 \\times 10^6)}{2 \\times 1.4 \\times (287 \\times 300)} = \\frac{2.88 \\times 10^6}{2 \\times 1.4 \\times 86100} = \\frac{2.88 \\times 10^6}{241080} \\approx 11.9462$$\nNow, we compute the Chapman-Jouguet Mach number $M_{\\mathrm{CJ}}$:\n$$M_{\\mathrm{CJ}} = \\sqrt{1 + 11.9462} + \\sqrt{11.9462} = \\sqrt{12.9462} + \\sqrt{11.9462}$$\n$$M_{\\mathrm{CJ}} \\approx 3.59808 + 3.45633 \\approx 7.05441$$\nFinally, we compute the CJ detonation speed $D_{\\mathrm{CJ}}$:\n$$D_{\\mathrm{CJ}} = M_{\\mathrm{CJ}} c_1 \\approx 7.05441 \\times 347.1887 \\, \\mathrm{m/s} \\approx 2449.19 \\, \\mathrm{m/s}$$\nRounding the result to four significant figures gives $2449 \\, \\mathrm{m/s}$.",
            "answer": "$$\\boxed{2449}$$"
        },
        {
            "introduction": "The governing equations for reactive flows couple fluid dynamics and chemical kinetics, which can operate on vastly different timescales. A powerful numerical strategy is operator splitting, which solves the hydrodynamic and chemical steps separately. This practice  dives into the practical consequences of this approach by having you implement an exact Riemann solver and a chemistry integrator to quantify the first-order splitting error, revealing the non-commutative nature of the physical processes.",
            "id": "4045489",
            "problem": "Consider the one-dimensional Riemann problem for an inviscid, calorically perfect ideal gas governed by the Euler equations. You will construct the exact solution for the inert hydrodynamics (no source terms in mass, momentum, or total energy equations) and then introduce chemical source terms for a single-step exothermic reaction that evolves a passive species mass fraction and temperature under a constant-volume assumption. The goal is to quantify the error introduced by operator splitting, by comparing two first-order Lie-splitting sequences over one finite time step: hydrodynamics-first followed by chemistry, versus chemistry-first followed by hydrodynamics. You must express all physical quantities in the International System of Units (SI). All angles, if any, must be expressed in radians. Any answer that contains a proportion should be expressed as a decimal number.\n\nFundamental base: The governing laws and definitions you must use are the following.\n- The Euler equations for mass, momentum, and energy for a one-dimensional inviscid ideal gas, with an initial left–right discontinuity at $x = 0$, define the self-similar solution structure of the Riemann problem in terms of waves emanating from $x = 0$ with speed proportional to $x/t$.\n- For an ideal gas, the equation of state is $p = \\rho R T$, where $p$ is pressure, $\\rho$ is density, $R$ is the specific gas constant, and $T$ is temperature. The ratios of specific heats satisfy $\\gamma = c_p / c_v$, with $c_v = R / (\\gamma - 1)$ and $c_p = \\gamma R / (\\gamma - 1)$.\n- The exact Riemann solution at the contact discontinuity (center state) has equal pressure and velocity on its left and right sides, denoted $p^\\star$ and $u^\\star$, respectively. The nonlinearity arises from the Rankine–Hugoniot relations for shocks and the isentropic rarefaction relations, which together yield a scalar nonlinear equation for $p^\\star$.\n- The chemical model is a single-step, exothermic reaction in a well-mixed gas under constant volume, with species mass fraction $Y$ evolving as $\\mathrm{d}Y/\\mathrm{d}t = -\\omega(T) \\, Y$, where $\\omega(T) = A \\exp\\!\\left(- E / (R_u T)\\right)$ is an Arrhenius rate, $A$ is the pre-exponential factor, $E$ is the activation energy, and $R_u$ is the universal gas constant. The heat release per unit mass is $Q$, and the temperature evolves via $\\mathrm{d}T/\\mathrm{d}t = (Q/c_v) \\, \\omega(T) \\, Y$.\n\nOperator splitting design: Over a single time step of duration $t > 0$, define two first-order Lie-splitting sequences that act on the left–right Riemann initial data at $x = 0$.\n- Hydrodynamics-first (HF): Solve the inert Riemann problem to find $(p^\\star,u^\\star)$ and the corresponding central temperature $T^\\star$ at $x=0$. Then, at constant volume, evolve the species and temperature from $(Y_0, T^\\star)$ for time $t$ using the chemical source ordinary differential equations (ODEs). Denote the resulting temperature by $T_{\\mathrm{HF}}(t)$.\n- Chemistry-first (CF): At constant volume, independently evolve the left and right initial states from $(Y_0, T_L)$ and $(Y_0, T_R)$ for time $t$ using the chemical source ODEs, yielding $(Y_L(t), T_L(t))$ and $(Y_R(t), T_R(t))$. Update the left and right pressures using $p_L'(t) = \\rho_L R T_L(t)$ and $p_R'(t) = \\rho_R R T_R(t)$, while keeping $\\rho$ and $u$ unchanged. Then solve the inert Riemann problem with these updated left–right states to obtain the corresponding center-state temperature at $x=0$, denoted $T_{\\mathrm{CF}}(t)$.\n\nDefine the splitting error at the center as the absolute temperature difference $e_T = \\left| T_{\\mathrm{HF}}(t) - T_{\\mathrm{CF}}(t) \\right|$, expressed in $\\mathrm{K}$.\n\nYou must implement the following steps in a single, complete program:\n1. Construct the exact inert Riemann solution at the center $x=0$ for given left and right states. Use a robust root-finding iteration for the scalar equation defining $p^\\star$ based on physically consistent shock and rarefaction relations. Then compute $u^\\star$ and the left/right star-state densities. Determine the center temperature $T^\\star$ as the star-state temperature on the side of the contact that contains $x/t = 0$, i.e., $T^\\star = T_L^\\star$ if $u^\\star > 0$ and $T^\\star = T_R^\\star$ if $u^\\star < 0$.\n2. Implement the constant-volume chemistry integration for $(Y,T)$ using the Arrhenius source with given parameters, yielding $(Y(t),T(t))$ from initial conditions $(Y_0,T_0)$.\n3. Compute $e_T$ for each test case based on the HF and CF sequences defined above.\n\nPhysical and numerical parameters:\n- Universal gas constant: $R_u = 8.314462618 \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n- Mixture molecular weight: $M = 0.02897 \\ \\mathrm{kg}\\,\\mathrm{mol}^{-1}$.\n- Specific gas constant: $R = R_u / M$.\n- Ratio of specific heats: $\\gamma = 1.4$.\n- Heat release per unit mass: $Q = 2.0 \\times 10^{6} \\ \\mathrm{J}\\,\\mathrm{kg}^{-1}$.\n- Arrhenius pre-exponential: $A = 1.0 \\times 10^{3} \\ \\mathrm{s}^{-1}$.\n- Activation energy: $E = 6.0 \\times 10^{4} \\ \\mathrm{J}\\,\\mathrm{mol}^{-1}$.\n- Initial fuel mass fraction: $Y_0 = 0.10$.\n- All initial velocities are expressed in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, densities in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, pressures in $\\mathrm{Pa}$, temperatures in $\\mathrm{K}$, and times in $\\mathrm{s}$.\n\nTest suite:\n- Case $1$ (canonical strong left state): Left state $(\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0 \\times 10^{5})$, Right state $(\\rho_R, u_R, p_R) = (0.125, 0.0, 1.0 \\times 10^{4})$, time $t = 1.0 \\times 10^{-4}$.\n- Case $2$ (high-pressure left state): Left state $(\\rho_L, u_L, p_L) = (5.0, 0.0, 2.0 \\times 10^{6})$, Right state $(\\rho_R, u_R, p_R) = (1.0, 0.0, 1.0 \\times 10^{5})$, time $t = 5.0 \\times 10^{-5}$.\n- Case $3$ (counterflow equal pressures): Left state $(\\rho_L, u_L, p_L) = (1.0, 1.0 \\times 10^{2}, 1.0 \\times 10^{5})$, Right state $(\\rho_R, u_R, p_R) = (1.0, -1.0 \\times 10^{2}, 1.0 \\times 10^{5})$, time $t = 1.0 \\times 10^{-5}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the splitting errors $e_T$ for the three test cases as a comma-separated list enclosed in square brackets, for example, $\\left[ e_1, e_2, e_3 \\right]$. The values must be printed as decimal floating-point numbers in $\\mathrm{K}$, with the default string conversion of the language, and no additional text.",
            "solution": "The task is to quantify the first-order operator splitting error for the one-dimensional reactive Euler equations. This is achieved by comparing two Lie-splitting sequences: hydrodynamics-first (HF) and chemistry-first (CF). The error is measured as the absolute difference in temperature at the center of a Riemann problem solution after a single time step $t$.\n\nThe physical model consists of two parts: the inert fluid dynamics governed by the Euler equations and the chemical kinetics governed by a set of ordinary differential equations (ODEs).\n\nThe governing equations for one-dimensional inviscid, non-heat-conducting flow are the Euler equations:\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E_t \\end{pmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E_t + p) \\end{pmatrix}\n= 0\n$$\nwhere $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E_t = \\rho e + \\frac{1}{2}\\rho u^2$ is the total energy per unit volume, with $e$ being the specific internal energy. For a calorically perfect ideal gas, the equation of state is $p = \\rho R T$, where $T$ is the temperature and $R$ is the specific gas constant. The specific internal energy is $e = c_v T$, where $c_v$ is the specific heat at constant volume. The constants are related by $R = c_p - c_v$ and $\\gamma = c_p/c_v$, which gives $c_v = R/(\\gamma - 1)$.\n\nThe chemical model describes the evolution of a species mass fraction $Y$ and temperature $T$ in a constant-volume, well-mixed system. The governing ODEs are:\n$$\n\\frac{\\mathrm{d}Y}{\\mathrm{d}t} = -\\omega(T) Y\n$$\n$$\n\\frac{\\mathrm{d}T}{\\mathrm{d}t} = \\frac{Q}{c_v} \\omega(T) Y\n$$\nwhere $Q$ is the heat of reaction and $\\omega(T)$ is the Arrhenius reaction rate, $\\omega(T) = A \\exp(-E / (R_u T))$. Here, $A$ is the pre-exponential factor, $E$ is the activation energy, and $R_u$ is the universal gas constant.\n\nThe solution strategy involves implementing an exact Riemann solver for the inert Euler equations and a numerical integrator for the chemical ODEs, and then combining them according to the specified splitting sequences.\n\n**1. Exact Inert Riemann Solver**\n\nThe Riemann problem with an initial discontinuity at $x=0$ has a self-similar solution that depends only on the similarity variable $\\xi = x/t$. The solution consists of left-moving and right-moving waves (either shocks or rarefactions) separating the initial left (L) and right (R) states from a central \"star\" region. Within the star region, pressure $p^\\star$ and velocity $u^\\star$ are constant, but density and temperature are discontinuous across a contact surface that moves with velocity $u^\\star$.\n\nThe core of the solver is to find the pressure $p^\\star$. This is achieved by solving a single nonlinear algebraic equation that ensures velocity compatibility at the contact discontinuity:\n$$\n\\phi(p^\\star) = f_L(p^\\star, \\rho_L, p_L) + f_R(p^\\star, \\rho_R, p_R) + u_R - u_L = 0\n$$\nThe function $f_K(p, \\rho_K, p_K)$ represents the change in velocity across the right-going wave starting from state K (for $f_L$) or the left-going wave starting from state K (for $f_R$). Its form depends on whether the wave is a shock ($p > p_K$) or a rarefaction ($p \\le p_K$). Let $a_K = \\sqrt{\\gamma p_K / \\rho_K}$ be the sound speed in state $K$.\n\nFor a shock wave ($p > p_K$), the Rankine-Hugoniot relations give:\n$$\nf_K(p, \\rho_K, p_K) = (p - p_K) \\sqrt{\\frac{2 / ((\\gamma+1)\\rho_K)}{p + \\frac{\\gamma-1}{\\gamma+1}p_K}}\n$$\nFor a rarefaction wave ($p \\le p_K$), the isentropic relations give:\n$$\nf_K(p, \\rho_K, p_K) = \\frac{2 a_K}{\\gamma - 1} \\left[ \\left(\\frac{p}{p_K}\\right)^{\\frac{\\gamma-1}{2\\gamma}} - 1 \\right]\n$$\nThis nonlinear equation for $p^\\star$ is solved numerically using the Newton-Raphson method, which requires the derivative $\\phi'(p^\\star) = f'_L(p^\\star) + f'_R(p^\\star)$. The derivatives $f'_K(p)$ are also determined analytically.\n\nOnce $p^\\star$ is found, the velocity $u^\\star$ is computed as:\n$$\nu^\\star = \\frac{1}{2}(u_L + u_R) + \\frac{1}{2}(f_R(p^\\star, \\rho_R, p_R) - f_L(p^\\star, \\rho_L, p_L))\n$$\nThe densities in the star region, $\\rho_L^\\star$ and $\\rho_R^\\star$, are found using the appropriate shock or rarefaction relations:\n- For a shock ($p^\\star > p_K$): $\\rho_K^\\star = \\rho_K \\frac{ p^\\star/p_K + (\\gamma-1)/(\\gamma+1) }{ ((\\gamma-1)/(\\gamma+1)) p^\\star/p_K + 1 }$\n- For a rarefaction ($p^\\star \\le p_K$): $\\rho_K^\\star = \\rho_K ( p^\\star/p_K )^{1/\\gamma}$\n\nFinally, the star-region temperatures are calculated from the ideal gas law: $T_L^\\star = p^\\star/(\\rho_L^\\star R)$ and $T_R^\\star = p^\\star/(\\rho_R^\\star R)$. The problem specifies that the temperature at the center, $T^\\star$, is the temperature on the side of the contact discontinuity that contains the point $x/t = 0$. This depends on the sign of $u^\\star$: if $u^\\star > 0$, the origin is in the left star state, so $T^\\star=T_L^\\star$. If $u^\\star < 0$, the origin is in the right star state, so $T^\\star=T_R^\\star$. For the special case $u^\\star=0$, we select $T_L^\\star$, which is valid for the given test cases as symmetry ensures $T_L^\\star=T_R^\\star$.\n\n**2. Chemical Kinetics Integrator**\n\nThe chemical system is evolved under a constant-volume assumption. For a first-order splitting method evaluated over a small time step $t$, it is consistent to use a first-order numerical integrator. A single explicit forward Euler step is sufficient and appropriate, as its local truncation error is $O(t^2)$, matching the order of the Lie-splitting error.\nThe states $(Y, T)$ are updated from an initial state $(Y_0, T_0)$ as:\n$$\nY(t) \\approx Y_0 - t \\cdot \\omega(T_0) Y_0\n$$\n$$\nT(t) \\approx T_0 + t \\cdot \\frac{Q}{c_v} \\omega(T_0) Y_0\n$$\nSince only the final temperature is needed for the subsequent steps, we compute $T(t)$ directly.\n\n**3. Operator Splitting Sequences**\n\nThe two sequences are implemented as follows over a single time step of duration $t$:\n\n**Hydrodynamics-First (HF):**\n1. Given initial states $(\\rho_L, u_L, p_L)$ and $(\\rho_R, u_R, p_R)$.\n2. Solve the inert Riemann problem to find $u^\\star$ and the central temperature $T^\\star$.\n3. Evolve chemistry from initial conditions $(Y_0, T^\\star)$ for time $t$ using the Euler step to obtain the final temperature $T_{\\mathrm{HF}}(t)$.\n\n**Chemistry-First (CF):**\n1. Given initial states $(\\rho_L, u_L, p_L)$ and $(\\rho_R, u_R, p_R)$, calculate the initial temperatures $T_L = p_L/(\\rho_L R)$ and $T_R = p_R/(\\rho_R R)$.\n2. Evolve the left state chemistry from $(Y_0, T_L)$ for time $t$ to get $T_L(t)$.\n3. Evolve the right state chemistry from $(Y_0, T_R)$ for time $t$ to get $T_R(t)$.\n4. Update pressures according to the new temperatures, keeping densities constant: $p'_L(t) = \\rho_L R T_L(t)$ and $p'_R(t) = \\rho_R R T_R(t)$.\n5. Solve a new inert Riemann problem with the updated states $(\\rho_L, u_L, p'_L(t))$ and $(\\rho_R, u_R, p'_R(t))$ to find the new central velocity $u^{\\star\\prime}$ and central temperature $T_{\\mathrm{CF}}(t)$.\n\nThe splitting error at the center is then computed as the absolute difference $e_T = |T_{\\mathrm{HF}}(t) - T_{\\mathrm{CF}}(t)|$. The provided code implements this logic for each of the test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    # Define physical and numerical parameters\n    R_u = 8.314462618  # Universal gas constant, J/(mol*K)\n    M = 0.02897        # Mixture molecular weight, kg/mol\n    R = R_u / M        # Specific gas constant, J/(kg*K)\n    GAMMA = 1.4        # Ratio of specific heats\n    Q = 2.0e6          # Heat release per unit mass, J/kg\n    A = 1.0e3          # Arrhenius pre-exponential, 1/s\n    E = 6.0e4          # Activation energy, J/mol\n    Y0 = 0.10          # Initial fuel mass fraction\n    CV = R / (GAMMA - 1.0) # Specific heat at constant volume, J/(kg*K)\n    TOLERANCE = 1e-7   # Tolerance for Newton-Raphson solver\n    MAX_ITER = 20      # Max iterations for Newton-Raphson\n\n    def solve_chemistry(T0, y0, t_step):\n        \"\"\"\n        Integrates the chemistry ODEs for one explicit Euler step.\n        \"\"\"\n        if T0 <= 0:\n            return T0\n        omega = A * np.exp(-E / (R_u * T0))\n        T_t = T0 + t_step * (Q / CV) * omega * y0\n        return T_t\n\n    def pres_func(p, rho_k, p_k, a_k):\n        \"\"\"\n        Computes the wave function f_k(p) used in the pressure function.\n        \"\"\"\n        if p > p_k:  # Shock\n            A_k = 2.0 / ((GAMMA + 1.0) * rho_k)\n            B_k = (GAMMA - 1.0) / (GAMMA + 1.0) * p_k\n            val = (p - p_k) * np.sqrt(A_k / (p + B_k))\n        else:  # Rarefaction\n            val = (2.0 * a_k / (GAMMA - 1.0)) * ((p / p_k)**((GAMMA - 1.0) / (2.0 * GAMMA)) - 1.0)\n        return val\n\n    def pres_func_deriv(p, rho_k, p_k, a_k):\n        \"\"\"\n        Computes the derivative of the wave function f_k(p).\n        \"\"\"\n        if p > p_k: # Shock\n            A_k = 2.0 / ((GAMMA + 1.0) * rho_k)\n            B_k = (GAMMA - 1.0) / (GAMMA + 1.0) * p_k\n            derivative = np.sqrt(A_k / (p + B_k)) * (1.0 - (p - p_k) / (2.0 * (B_k + p)))\n        else: # Rarefaction\n            derivative = (1.0 / (rho_k * a_k)) * (p / p_k)**(-(GAMMA + 1.0) / (2.0 * GAMMA))\n        return derivative\n\n    def solve_riemann(state_L, state_R):\n        \"\"\"\n        Solves the exact Riemann problem for an ideal gas.\n        Returns (p_star, u_star, T_L_star, T_R_star)\n        \"\"\"\n        rho_L, u_L, p_L = state_L\n        rho_R, u_R, p_R = state_R\n\n        a_L = np.sqrt(GAMMA * p_L / rho_L)\n        a_R = np.sqrt(GAMMA * p_R / rho_R)\n\n        pressure_eq = lambda p: pres_func(p, rho_L, p_L, a_L) + pres_func(p, rho_R, p_R, a_R) + (u_R - u_L)\n        deriv_eq = lambda p: pres_func_deriv(p, rho_L, p_L, a_L) + pres_func_deriv(p, rho_R, p_R, a_R)\n\n        # Initial guess for p_star (two-rarefaction approximation)\n        p_pvrs_num = a_L + a_R - (GAMMA - 1.0)/2.0 * (u_R - u_L)\n        p_pvrs_den = a_L / p_L**((GAMMA - 1.0)/(2.0 * GAMMA)) + a_R / p_R**((GAMMA - 1.0)/(2.0 * GAMMA))\n        p_star = (p_pvrs_num / p_pvrs_den)**(2.0 * GAMMA / (GAMMA - 1.0))\n        p_star = max(1e-6, p_star)\n\n        for _ in range(MAX_ITER):\n            f_val = pressure_eq(p_star)\n            df_val = deriv_eq(p_star)\n            p_star_new = p_star - f_val / df_val\n            if abs(p_star_new - p_star) < TOLERANCE:\n                p_star = p_star_new\n                break\n            p_star = p_star_new\n            if p_star < 0: p_star = 1e-6\n        \n        f_L = pres_func(p_star, rho_L, p_L, a_L)\n        f_R = pres_func(p_star, rho_R, p_R, a_R)\n        u_star = 0.5 * (u_L + u_R) + 0.5 * (f_R - f_L)\n\n        # Left side density\n        if p_star > p_L:\n            rho_L_star = rho_L * ((p_star/p_L + (GAMMA-1.0)/(GAMMA+1.0)) / \n                                  (((GAMMA-1.0)/(GAMMA+1.0)) * (p_star/p_L) + 1.0))\n        else:\n            rho_L_star = rho_L * (p_star / p_L)**(1.0 / GAMMA)\n        \n        # Right side density\n        if p_star > p_R:\n            rho_R_star = rho_R * ((p_star/p_R + (GAMMA-1.0)/(GAMMA+1.0)) / \n                                  (((GAMMA-1.0)/(GAMMA+1.0)) * (p_star/p_R) + 1.0))\n        else:\n            rho_R_star = rho_R * (p_star / p_R)**(1.0 / GAMMA)\n\n        T_L_star = p_star / (rho_L_star * R)\n        T_R_star = p_star / (rho_R_star * R)\n\n        return p_star, u_star, T_L_star, T_R_star\n\n    test_cases = [\n        ((1.0, 0.0, 1.0e5), (0.125, 0.0, 1.0e4), 1.0e-4),\n        ((5.0, 0.0, 2.0e6), (1.0, 0.0, 1.0e5), 5.0e-5),\n        ((1.0, 100.0, 1.0e5), (1.0, -100.0, 1.0e5), 1.0e-5)\n    ]\n    results = []\n\n    for case in test_cases:\n        state_L, state_R, t_step = case\n        rho_L, u_L, p_L = state_L\n        rho_R, u_R, p_R = state_R\n        \n        T_L = p_L / (rho_L * R)\n        T_R = p_R / (rho_R * R)\n        \n        # --- Hydrodynamics-First (HF) ---\n        _, u_star, T_L_star, T_R_star = solve_riemann(state_L, state_R)\n        \n        if u_star > 0:\n            T_star = T_L_star\n        elif u_star < 0:\n            T_star = T_R_star\n        else:\n            T_star = T_L_star  # For symmetric cases, T_L_star == T_R_star\n\n        T_HF = solve_chemistry(T_star, Y0, t_step)\n        \n        # --- Chemistry-First (CF) ---\n        T_L_chem = solve_chemistry(T_L, Y0, t_step)\n        T_R_chem = solve_chemistry(T_R, Y0, t_step)\n\n        p_L_new = rho_L * R * T_L_chem\n        p_R_new = rho_R * R * T_R_chem\n        \n        state_L_new = (rho_L, u_L, p_L_new)\n        state_R_new = (rho_R, u_R, p_R_new)\n        \n        _, u_star_cf, T_L_star_cf, T_R_star_cf = solve_riemann(state_L_new, state_R_new)\n\n        if u_star_cf > 0:\n            T_CF = T_L_star_cf\n        elif u_star_cf < 0:\n            T_CF = T_R_star_cf\n        else:\n            T_CF = T_L_star_cf\n        \n        error = abs(T_HF - T_CF)\n        results.append(error)\n        \n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A significant challenge in simulating detonation waves is maintaining physical admissibility; numerical oscillations near the sharp shock front can lead to unphysical states like negative pressure, causing the simulation to fail. This problem  addresses this critical issue of numerical robustness. You will first explore why negative pressure invalidates the hyperbolic nature of the Euler equations and then derive and apply a projection method to enforce physical constraints, a vital technique for building stable and reliable simulation codes.",
            "id": "4045455",
            "problem": "Consider a one-dimensional finite-volume update for a reactive Euler model of a detonation wave, closed with a calorically perfect ideal-gas equation of state with constant ratio of specific heats $\\gamma$. Let the cell-averaged conservative state after an explicit predictor step be $U^{*} = [\\rho^{*}, m^{*}, (\\rho E)^{*}, (\\rho Y_{F})^{*}]^{\\mathsf{T}}$, where $\\rho$ is the density, $m=\\rho u$ is the momentum with velocity $u$, $\\rho E$ is the total energy density, and $\\rho Y_{F}$ is the fuel partial density. The pressure is recovered from conservative variables via the ideal-gas relation\n$$\np \\;=\\; (\\gamma - 1)\\!\\left[(\\rho E) - \\frac{m^{2}}{2\\rho}\\right],\n$$\nand the sound speed satisfies $c^{2} = \\gamma p/\\rho$. The physical admissible set requires $\\rho > 0$, $p > 0$, and $0 \\le Y_{F} \\le 1$. You may assume the caloric model is independent of composition (so that $\\gamma$ is constant and $p$ depends only on $(\\rho, m, \\rho E)$).\n\nYou are given the following data for a cell located on the reaction zone side of a detonation front:\n- $\\gamma = 1.4$,\n- $\\rho^{*} = 1.0$ $\\mathrm{kg\\,m^{-3}}$,\n- $m^{*} = 1.0 \\times 10^{3}$ $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$,\n- $(\\rho E)^{*} = 4.80 \\times 10^{5}$ $\\mathrm{J\\,m^{-3}}$,\n- $(\\rho Y_{F})^{*} = -2.00 \\times 10^{-2}$ $\\mathrm{kg\\,m^{-3}}$.\n\nAnswer the following:\n\n1) Starting from the definition of the sound speed $c^{2} = \\gamma p/\\rho$ and the form of the inviscid Euler flux Jacobian, explain why violating the admissibility conditions $p>0$ or $Y_{F}\\in[0,1]$ undermines the well-posedness of the hyperbolic update near a detonation front.\n\n2) To restore admissibility while minimally perturbing conserved quantities, consider the constrained projection problem\n$$\n\\min_{\\Delta U} \\;\\frac{1}{2}\\,\\|\\mathrm{W}^{1/2}\\Delta U\\|_{2}^{2}\n$$\nsubject to the constraints\n$$\n\\Delta \\rho = 0,\\quad \\Delta m = 0,\\quad p(U^{*}+\\Delta U) \\ge p_{\\min},\\quad 0 \\le \\frac{(\\rho Y_{F})^{*}+\\Delta(\\rho Y_{F})}{\\rho^{*}} \\le 1,\n$$\nwhere $p_{\\min} = 1.00 \\times 10^{3}$ $\\mathrm{Pa}$ is a small positive floor to avoid loss of hyperbolicity, and the weighting matrix is diagonal with $\\mathrm{W}=\\mathrm{diag}(0,0,s_{E}^{-2},s_{Y}^{-2})$, $s_{E} = 1.00 \\times 10^{6}$ $\\mathrm{J\\,m^{-3}}$, and $s_{Y} = 1.00$ $\\mathrm{kg\\,m^{-3}}$. Derive the closed-form projected corrections $\\Delta(\\rho E)$ and $\\Delta(\\rho Y_{F})$ that solve this problem.\n\n3) Compute the minimal weighted perturbation magnitude\n$$\nJ_{\\min} \\;=\\; \\left\\|\\mathrm{W}^{1/2}\\Delta U_{\\mathrm{proj}}\\right\\|_{2}\n$$\nand report it as a dimensionless number rounded to four significant figures. Do not include units in your final boxed answer. State any intermediate values you compute in coherent SI units, and express the final answer as a pure number.",
            "solution": "The problem is first validated to ensure it is well-posed, scientifically grounded, and objective.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n-   Model: One-dimensional finite-volume update, reactive Euler model.\n-   State vector: $U = [\\rho, m, \\rho E, \\rho Y_{F}]^{\\mathsf{T}}$.\n-   Equation of State: Calorically perfect ideal gas with constant $\\gamma$.\n-   Pressure relation: $p = (\\gamma - 1)\\!\\left[(\\rho E) - \\frac{m^{2}}{2\\rho}\\right]$.\n-   Sound speed: $c^{2} = \\gamma p/\\rho$.\n-   Admissibility conditions: $\\rho > 0$, $p > 0$, $0 \\le Y_{F} \\le 1$.\n-   Predicted state: $U^{*} = [\\rho^{*}, m^{*}, (\\rho E)^{*}, (\\rho Y_{F})^{*}]^{\\mathsf{T}}$.\n-   Given data:\n    -   $\\gamma = 1.4$\n    -   $\\rho^{*} = 1.0$ $\\mathrm{kg\\,m^{-3}}$\n    -   $m^{*} = 1.0 \\times 10^{3}$ $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$\n    -   $(\\rho E)^{*} = 4.80 \\times 10^{5}$ $\\mathrm{J\\,m^{-3}}$\n    -   $(\\rho Y_{F})^{*} = -2.00 \\times 10^{-2}$ $\\mathrm{kg\\,m^{-3}}$\n-   Part 2 givens (Projection):\n    -   Objective: $\\min_{\\Delta U} \\;\\frac{1}{2}\\,\\|\\mathrm{W}^{1/2}\\Delta U\\|_{2}^{2}$\n    -   Constraints: $\\Delta \\rho = 0$, $\\Delta m = 0$, $p(U^{*}+\\Delta U) \\ge p_{\\min}$, $0 \\le \\frac{(\\rho Y_{F})^{*}+\\Delta(\\rho Y_{F})}{\\rho^{*}} \\le 1$.\n    -   $p_{\\min} = 1.00 \\times 10^{3}$ $\\mathrm{Pa}$.\n    -   Weighting matrix: $\\mathrm{W}=\\mathrm{diag}(0,0,s_{E}^{-2},s_{Y}^{-2})$.\n    -   $s_{E} = 1.00 \\times 10^{6}$ $\\mathrm{J\\,m^{-3}}$.\n    -   $s_{Y} = 1.00$ $\\mathrm{kg\\,m^{-3}}$.\n-   Part 3 target: Compute $J_{\\min} = \\left\\|\\mathrm{W}^{1/2}\\Delta U_{\\mathrm{proj}}\\right\\|_{2}$ rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, describing a common numerical issue (loss of admissibility) in computational fluid dynamics for hyperbolic conservation laws, and a standard correction technique (constrained projection). The problem is well-posed, consisting of a qualitative explanation followed by a solvable constrained convex optimization problem. The language is objective and all terms are clearly defined. A preliminary calculation of the pressure for the given state $U^{*}$ yields:\n$$\np^{*} \\;=\\; (\\gamma - 1)\\!\\left[(\\rho E)^{*} - \\frac{(m^{*})^{2}}{2\\rho^{*}}\\right] \\;=\\; (1.4 - 1)\\!\\left[4.80 \\times 10^{5} - \\frac{(1.0 \\times 10^{3})^{2}}{2 \\times 1.0}\\right]\n$$\n$$\np^{*} \\;=\\; 0.4 \\times (4.80 \\times 10^{5} - 5.0 \\times 10^{5}) \\;=\\; 0.4 \\times (-2.0 \\times 10^{4}) \\;=\\; -8.0 \\times 10^{3} \\; \\mathrm{Pa}\n$$\nThis negative pressure violates the admissibility condition $p>0$. Additionally, the fuel mass fraction is $Y_F^{*} = (\\rho Y_F)^{*}/\\rho^{*} = -2.00 \\times 10^{-2} / 1.0 = -0.02$, which violates $0 \\le Y_F \\le 1$. The problem setup intentionally creates an inadmissible state, which is the premise for the subsequent correction task. This does not represent a flaw but is the central element of the problem. Therefore, the problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid and a solution will be provided.\n\n**Part 1: Well-Posedness and Admissibility**\n\nThe one-dimensional inviscid Euler equations form a system of hyperbolic partial differential equations. The hyperbolicity of the system is a fundamental property that guarantees that information propagates at finite speeds along characteristic curves, and that the initial-value problem is well-posed. The system $\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0$ is hyperbolic if the flux Jacobian matrix $A(U) = \\frac{\\partial F}{\\partial U}$ has a full set of real eigenvalues and corresponding linearly independent eigenvectors.\n\nFor the non-reactive Euler equations, the eigenvalues of the flux Jacobian are $u$, $u-c$, and $u+c$, where $u$ is the fluid velocity and $c$ is the speed of sound. The sound speed is defined by $c^{2} = \\gamma p / \\rho$. For the eigenvalues to be real, $c$ must be a real number, which requires $c^2 \\ge 0$. Since both $\\gamma$ and $\\rho$ are physically required to be positive, this condition reduces to $p \\ge 0$. If the pressure $p$ becomes negative, $c^2$ becomes negative, and the eigenvalues $u \\pm c$ become complex conjugates. A system with complex eigenvalues is elliptic, not hyperbolic. Numerical schemes for hyperbolic equations, such as the explicit finite-volume method mentioned, rely on the Courant-Friedrichs-Lewy (CFL) condition, which restricts the time step based on the finite speed of wave propagation. If the system becomes locally elliptic, the notion of a finite domain of dependence breaks down, and such explicit schemes become unconditionally unstable, thus undermining the well-posedness of the numerical update.\n\nThe condition $0 \\le Y_F \\le 1$ is a matter of physical realizability. The mass fraction $Y_F$ represents the fraction of a fluid parcel's mass that is fuel. It cannot be negative, nor can it exceed unity. Violating this constraint, e.g., $Y_F < 0$, is unphysical. Furthermore, chemical reaction rate models, which provide the source terms for the species equations, are almost always formulated assuming $Y_F \\ge 0$. A negative mass fraction can lead to ill-defined or unphysical behavior in the reaction model (e.g., fuel being created from products at an explosive rate), causing the simulation to fail or produce nonsensical results. For a detonation, where the wave structure is dictated by a tight coupling between fluid dynamics and chemistry, maintaining the physical bounds on species is critical for correct modeling.\n\n**Part 2: Derivation of Projected Corrections**\n\nThe goal is to find $\\Delta U = [0, 0, \\Delta(\\rho E), \\Delta(\\rho Y_F)]^{\\mathsf{T}}$ that minimizes the objective function\n$$\nJ(\\Delta(\\rho E), \\Delta(\\rho Y_F)) = \\frac{1}{2} \\left[ \\left(\\frac{\\Delta(\\rho E)}{s_E}\\right)^2 + \\left(\\frac{\\Delta(\\rho Y_F)}{s_Y}\\right)^2 \\right]\n$$\nsubject to two constraints. Let $x = \\Delta(\\rho E)$ and $y = \\Delta(\\rho Y_F)$.\n\nThe first constraint is on pressure: $p(U^{*}+\\Delta U) \\ge p_{\\min}$.\nThe new pressure, $p_{\\text{new}}$, is\n$$\np_{\\text{new}} = (\\gamma - 1)\\left[ ((\\rho E)^{*} + x) - \\frac{(m^{*})^2}{2\\rho^{*}} \\right]\n$$\nThe constraint becomes:\n$$\n(\\gamma - 1)\\left[ ((\\rho E)^{*} + x) - \\frac{(m^{*})^2}{2\\rho^{*}} \\right] \\ge p_{\\min}\n$$\nRearranging to solve for $x$:\n$$\n(\\rho E)^{*} + x - \\frac{(m^{*})^2}{2\\rho^{*}} \\ge \\frac{p_{\\min}}{\\gamma - 1}\n$$\n$x \\ge \\frac{p_{\\min}}{\\gamma - 1} - \\left( (\\rho E)^{*} - \\frac{(m^{*})^2}{2\\rho^{*}} \\right) = \\frac{p_{\\min}}{\\gamma - 1} - \\frac{p^{*}}{\\gamma-1} = \\frac{p_{\\min} - p^{*}}{\\gamma - 1}$\nThis defines a lower bound for $x$: $x \\ge x_{\\min}$, where $x_{\\min} = \\frac{p_{\\min} - p^{*}}{\\gamma-1}$.\n\nThe second constraint is on the fuel mass fraction: $0 \\le Y_F \\le 1$. Since `ρ` is constant, this is equivalent to $0 \\le \\rho Y_F \\le \\rho$.\n$$\n0 \\le (\\rho Y_F)^{*} + y \\le \\rho^{*}\n$$\nThis gives a lower and upper bound for $y$:\n$$ -(\\rho Y_F)^{*} \\le y \\le \\rho^{*} - (\\rho Y_F)^{*} $$\nThis defines an interval for $y$: $y \\in [y_{\\min}, y_{\\max}]$, where $y_{\\min} = -(\\rho Y_F)^{*}$ and $y_{\\max} = \\rho^{*} - (\\rho Y_F)^{*}$.\n\nThe minimization problem is now to find $(x, y)$ that minimizes $\\frac{1}{2s_E^2}x^2 + \\frac{1}{2s_Y^2}y^2$ subject to $x \\ge x_{\\min}$ and $y_{\\min} \\le y \\le y_{\\max}$. This is a search for the point in the feasible rectangular region that is closest to the origin $(0,0)$ in the $L_2$-norm scaled by $s_E$ and $s_Y$. Because the objective function is separable and the constraints for $x$ and $y$ are independent, we can minimize each term separately.\n\nThe value of $x$ in the interval $[x_{\\min}, \\infty)$ that is closest to $0$ is $\\Delta(\\rho E) = \\max(0, x_{\\min})$.\nThe value of $y$ in the interval $[y_{\\min}, y_{\\max}]$ that is closest to $0$ is $\\Delta(\\rho Y_F) = \\max(y_{\\min}, \\min(0, y_{\\max}))$.\n\nThus, the closed-form projected corrections are:\n$$\n\\Delta(\\rho E) = \\max\\left(0, \\frac{p_{\\min} - p^{*}}{\\gamma - 1}\\right)\n$$\nwhere $p^{*} = (\\gamma - 1)\\left[(\\rho E)^{*} - \\frac{(m^{*})^2}{2\\rho^{*}}\\right]$, and\n$$\n\\Delta(\\rho Y_F) = \\max\\left(-(\\rho Y_F)^{*}, \\min(0, \\rho^{*} - (\\rho Y_F)^{*})\\right)\n$$\n\n**Part 3: Computation of the Perturbation Magnitude**\n\nFirst, we compute the necessary intermediate values using the provided data.\nWe already calculated $p^{*} = -8.0 \\times 10^{3} \\; \\mathrm{Pa}$.\n\nNow, we compute the required corrections $\\Delta(\\rho E)$ and $\\Delta(\\rho Y_F)$.\nFor $\\Delta(\\rho E)$:\n$x_{\\min} = \\frac{p_{\\min} - p^{*}}{\\gamma - 1} = \\frac{1.00 \\times 10^{3} - (-8.0 \\times 10^{3})}{1.4 - 1} = \\frac{9.0 \\times 10^{3}}{0.4} = 2.25 \\times 10^{4} \\; \\mathrm{J\\,m^{-3}}$.\nSince $x_{\\min} > 0$, the correction is:\n$$\n\\Delta(\\rho E) = x_{\\min} = 2.25 \\times 10^{4} \\; \\mathrm{J\\,m^{-3}}\n$$\n\nFor $\\Delta(\\rho Y_F)$:\n$y_{\\min} = -(\\rho Y_F)^{*} = -(-2.00 \\times 10^{-2}) = 2.00 \\times 10^{-2} \\; \\mathrm{kg\\,m^{-3}}$.\n$y_{\\max} = \\rho^{*} - (\\rho Y_F)^{*} = 1.00 - (-2.00 \\times 10^{-2}) = 1.02 \\; \\mathrm{kg\\,m^{-3}}$.\nThe allowed interval for the correction is $[0.02, 1.02]$. Since this interval does not contain $0$ and lies entirely on the positive side, the point in the interval closest to $0$ is the lower bound, $y_{\\min}$.\n$$\n\\Delta(\\rho Y_F) = y_{\\min} = 2.00 \\times 10^{-2} \\; \\mathrm{kg\\,m^{-3}}\n$$\n\nThe problem asks for the magnitude $J_{\\min} = \\left\\|\\mathrm{W}^{1/2}\\Delta U_{\\mathrm{proj}}\\right\\|_{2}$.\nThe projected perturbation vector is $\\Delta U_{\\mathrm{proj}} = [0, 0, 2.25 \\times 10^{4}, 2.00 \\times 10^{-2}]^{\\mathsf{T}}$.\nThe weighting matrix is $\\mathrm{W}^{1/2} = \\mathrm{diag}(0, 0, s_E^{-1}, s_Y^{-1})$.\n$$\n\\mathrm{W}^{1/2}\\Delta U_{\\mathrm{proj}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\Delta(\\rho E)/s_E \\\\ \\Delta(\\rho Y_F)/s_Y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ (2.25 \\times 10^{4}) / (1.00 \\times 10^{6}) \\\\ (2.00 \\times 10^{-2}) / 1.00 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 2.25 \\times 10^{-2} \\\\ 2.00 \\times 10^{-2} \\end{pmatrix}\n$$\nThe $L_2$ norm of this vector is:\n$$\nJ_{\\min} = \\sqrt{0^2 + 0^2 + (2.25 \\times 10^{-2})^2 + (2.00 \\times 10^{-2})^2}\n$$\n$$\nJ_{\\min} = \\sqrt{(5.0625 \\times 10^{-4}) + (4.00 \\times 10^{-4})}\n$$\n$$\nJ_{\\min} = \\sqrt{9.0625 \\times 10^{-4}} = \\sqrt{9.0625} \\times 10^{-2}\n$$\n$$\nJ_{\\min} \\approx 3.0103986 \\times 10^{-2}\n$$\nRounding to four significant figures, the result is $3.010 \\times 10^{-2}$.",
            "answer": "$$\n\\boxed{3.010 \\times 10^{-2}}\n$$"
        }
    ]
}