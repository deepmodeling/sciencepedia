{
    "hands_on_practices": [
        {
            "introduction": "本实践旨在建立坚实的理论基础。我们将从一个经典的理想化流动结构——稳定对冲射流——入手。通过求解基本的输运方程，我们将解析地推导出标量耗散率与流动应变率之间的关系，这个练习将抽象的 $\\chi$ 概念具体化，将其与一个可触摸的、表征火焰拉伸的物理量直接联系起来。",
            "id": "4041998",
            "problem": "考虑一个形成驻点混合层的稳态平面相对射流。令混合分数 $Z$ 为一个守恒标量，服从不可压缩流动的稳态对流-扩散方程，\n$$\n\\boldsymbol{u}\\cdot\\nabla Z = D_Z \\nabla^{2} Z,\n$$\n其中 $D_Z$ 是混合分数扩散系数。假设在驻点平面附近的一个薄邻域内，速度场具有垂直于混合层的一维线性应变形式，\n$$\nu_y(y) = - a\\, y,\n$$\n其中 $a$ 是应变率，$y$ 是垂直于混合层的坐标。在这种一维设定下，混合分数满足\n$$\n- a\\, y\\, \\frac{d Z}{d y} = D_Z \\frac{d^{2} Z}{d y^{2}},\n$$\n并具有物理上一致的远场边界条件 $Z(y\\to -\\infty)=1$（燃料流）和 $Z(y\\to +\\infty)=0$（氧化剂流）。\n\n定义在化学计量混合分数 $Z_{st}$ 处的条件标量耗散率为\n$$\n\\chi_{st} \\equiv 2\\,D_Z\\,\\big|\\nabla Z\\big|^{2}\\Big|_{Z=Z_{st}},\n$$\n其中梯度是取 $Z=Z_{st}$ 等值面的法向梯度。使用混合分数输运方程的相似性分析，推导 $\\chi_{st}$ 关于 $a$、$D_Z$ 以及在化学计量面上 $Z$ 的法向梯度 $\\left|\\frac{\\partial Z}{\\partial n}\\right|_{st}$ 的表达式。然后，将问题特化到对称相对射流情况，其中 $Z_{st}=\\frac{1}{2}$，此时化学计量面与 $y=0$ 处的驻点平面重合，并求出在这种对称情况下 $\\chi_{st}$ 的闭合形式表达式。\n\n将对称情况的最终答案表示为单个闭合形式的解析表达式。不需要数值近似。将最终的条件标量耗散率 $\\chi_{st}$ 以 $\\mathrm{s}^{-1}$ 为单位表示。",
            "solution": "用户希望我解决一个问题。\n\n### 问题验证\n\n#### 第 1 步：提取已知信息\n- **混合分数 $Z$ 的控制方程**：混合分数 $Z$ 是一个守恒标量，服从不可压缩流动的稳态对流-扩散方程：$\\boldsymbol{u}\\cdot\\nabla Z = D_Z \\nabla^{2} Z$，其中 $D_Z$ 是混合分数扩散系数。\n- **速度场**：在驻点平面附近的一个薄邻域内，速度场是垂直于混合层的一维线性应变：$u_y(y) = - a\\, y$，其中 $a$ 是应变率。\n- **一维控制方程**：在这种一维设定下，$Z$ 的方程是：$- a\\, y\\, \\frac{d Z}{d y} = D_Z \\frac{d^{2} Z}{d y^{2}}$。\n- **边界条件**：$Z(y\\to -\\infty)=1$（燃料流）和 $Z(y\\to +\\infty)=0$（氧化剂流）。\n- **条件标量耗散率的定义**：在化学计量混合分数 $Z_{st}$ 处的条件标量耗散率定义为 $\\chi_{st} \\equiv 2\\,D_Z\\,\\big|\\nabla Z\\big|^{2}\\Big|_{Z=Z_{st}}$，其中梯度是取 $Z=Z_{st}$ 等值面的法向梯度。\n- **对称情况条件**：对于问题的最后一部分，情况被指定为对称的，其中 $Z_{st}=\\frac{1}{2}$ 且化学计量面在 $y=0$ 处。\n\n#### 第 2 步：使用提取的已知信息进行验证\n1.  **科学基础**：该问题是燃烧理论中的一个经典表述，描述了一个层流逆流扩散火焰混合层，通常被称为 Burke-Schumann 问题。控制方程是标准的稳态对流-扩散方程。线性应变速度剖面是驻点附近流场的有效且标准的近似。标量耗散率的定义在湍流燃烧和火焰面理论的研究中是基础性的。该问题牢固地植根于流体力学和输运现象的原理。\n2.  **适定性**：该问题提供了一个带有两个边界条件的二阶线性常微分方程，这足以确定唯一解。这些条件具有物理意义且在数学上是一致的。\n3.  **客观性**：问题以精确、客观的数学语言陈述，没有任何主观性或模糊性。\n4.  **无其他缺陷**：问题是完整的、一致的、现实的（在模型的标准假设范围内），并提出了一个实质性的概念挑战。\n\n#### 第 3 步：结论和行动\n问题有效。我将继续进行解答。\n\n### 解答\n\n问题要求推导条件标量耗散率 $\\chi_{st}$ 的表达式，首先是在一般情况下，然后是针对特定的对称情况。\n\n混合分数 $Z(y)$ 的一维输运方程为：\n$$\nD_Z \\frac{d^{2} Z}{d y^{2}} + a\\, y\\, \\frac{d Z}{d y} = 0\n$$\n其中 $a$ 是应变率，$D_Z$ 是扩散系数。这是一个二阶线性常微分方程。我们可以通过令 $W(y) = \\frac{dZ}{dy}$ 来求解它。该方程变为关于 $W$ 的一阶可分离常微分方程：\n$$\nD_Z \\frac{dW}{dy} = -a\\, y\\, W\n$$\n分离变量，我们得到：\n$$\n\\frac{dW}{W} = -\\frac{a}{D_Z} y\\, dy\n$$\n对两边积分得到：\n$$\n\\int \\frac{dW}{W} = \\int -\\frac{a}{D_Z} y\\, dy \\implies \\ln|W| = -\\frac{a}{2D_Z} y^2 + C_1\n$$\n其中 $C_1$ 是积分常数。对两边取指数函数得到：\n$$\nW(y) = C_2 \\exp\\left(-\\frac{a y^2}{2D_Z}\\right)\n$$\n其中 $C_2$ 是另一个常数。由于 $W(y) = \\frac{dZ}{dy}$，我们现在对这个表达式进行积分以求得 $Z(y)$：\n$$\nZ(y) = \\int C_2 \\exp\\left(-\\frac{a y^2}{2D_Z}\\right) dy + C_3\n$$\n这个积分涉及高斯函数。解可以用误差函数 $\\text{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_0^x \\exp(-t^2) dt$ 来表示。让我们引入一个相似性变量 $\\eta = y \\sqrt{\\frac{a}{2D_Z}}$。那么 $d\\eta = \\sqrt{\\frac{a}{2D_Z}} dy$。\n$Z(y)$ 的积分变为：\n$$\nZ(y) = C_2 \\int \\exp(-\\eta^2) \\sqrt{\\frac{2D_Z}{a}} d\\eta + C_3 = C_2 \\sqrt{\\frac{2D_Z}{a}} \\left(\\frac{\\sqrt{\\pi}}{2} \\text{erf}(\\eta)\\right) + C_3\n$$\n合并常数，我们可以写出通解为：\n$$\nZ(y) = C_4 \\text{erf}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right) + C_3\n$$\n我们使用远场边界条件来确定常数 $C_3$ 和 $C_4$：$Z(y\\to\\infty)=0$ 和 $Z(y\\to-\\infty)=1$。我们使用误差函数的极限：$\\lim_{x\\to\\infty} \\text{erf}(x) = 1$ 和 $\\lim_{x\\to-\\infty} \\text{erf}(x) = -1$。\n对于 $y \\to \\infty$：\n$$\nZ(\\infty) = C_4(1) + C_3 = 0\n$$\n对于 $y \\to -\\infty$：\n$$\nZ(-\\infty) = C_4(-1) + C_3 = 1\n$$\n我们得到一个由两个线性方程组成的方程组：\n1. $C_4 + C_3 = 0 \\implies C_3 = -C_4$\n2. $-C_4 + C_3 = 1$\n\n将(1)代入(2)得到 $-C_4 - C_4 = 1 \\implies -2C_4 = 1 \\implies C_4 = -\\frac{1}{2}$。\n然后 $C_3 = -(-\\frac{1}{2}) = \\frac{1}{2}$。\n混合分数剖面的解是：\n$$\nZ(y) = \\frac{1}{2} - \\frac{1}{2} \\text{erf}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right) = \\frac{1}{2} \\text{erfc}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right)\n$$\n其中 $\\text{erfc}(x) = 1 - \\text{erf}(x)$ 是互补误差函数。\n\n现在，我们来处理条件标量耗散率 $\\chi_{st}$。问题将其定义为：\n$$\n\\chi_{st} \\equiv 2\\,D_Z\\,\\big|\\nabla Z\\big|^{2}\\Big|_{Z=Z_{st}}\n$$\n在我们的一维设定中，梯度 $\\nabla Z$ 就是 $\\frac{dZ}{dy}\\boldsymbol{e}_y$，所以其大小的平方是 $|\\nabla Z|^2 = \\left(\\frac{dZ}{dy}\\right)^2$。表达式变为：\n$$\n\\chi_{st} = 2\\,D_Z\\,\\left(\\frac{dZ}{dy}\\right)^2\\Big|_{y=y_{st}}\n$$\n其中 $y_{st}$ 是满足 $Z(y_{st}) = Z_{st}$ 的坐标。\n\n问题现在要求特化到 $Z_{st} = \\frac{1}{2}$ 的对称情况。我们找到这个面的位置 $y_{st}$：\n$$\nZ(y_{st}) = \\frac{1}{2} \\implies \\frac{1}{2} \\text{erfc}\\left(y_{st} \\sqrt{\\frac{a}{2D_Z}}\\right) = \\frac{1}{2} \\implies \\text{erfc}\\left(y_{st} \\sqrt{\\frac{a}{2D_Z}}\\right) = 1\n$$\n由于只有在参数为0时互补误差函数才为1（$\\text{erfc}(0)=1$），我们必须有 $y_{st} \\sqrt{\\frac{a}{2D_Z}} = 0$，这意味着 $y_{st}=0$。如问题所述，化学计量面在驻点平面上。\n\n接下来，我们需要计算梯度 $\\frac{dZ}{dy}$ 并在 $y_{st}=0$ 处求值。\n$$\n\\frac{dZ}{dy} = \\frac{d}{dy}\\left[ \\frac{1}{2} - \\frac{1}{2} \\text{erf}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right) \\right]\n$$\n使用链式法则和误差函数的导数 $\\frac{d}{dx}\\text{erf}(u) = \\frac{2}{\\sqrt{\\pi}} \\exp(-u^2) \\frac{du}{dx}$：\n$$\n\\frac{dZ}{dy} = -\\frac{1}{2} \\left[ \\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right)^2\\right) \\cdot \\sqrt{\\frac{a}{2D_Z}} \\right]\n$$\n$$\n\\frac{dZ}{dy} = -\\frac{1}{\\sqrt{\\pi}} \\exp\\left(-\\frac{a y^2}{2D_Z}\\right) \\sqrt{\\frac{a}{2D_Z}} = -\\sqrt{\\frac{a}{2\\pi D_Z}} \\exp\\left(-\\frac{a y^2}{2D_Z}\\right)\n$$\n现在，我们在化学计量面 $y_{st}=0$ 处计算这个梯度：\n$$\n\\left.\\frac{dZ}{dy}\\right|_{y=0} = -\\sqrt{\\frac{a}{2\\pi D_Z}} \\exp(0) = -\\sqrt{\\frac{a}{2\\pi D_Z}}\n$$\n最后，我们将这个梯度代入 $\\chi_{st}$ 的表达式中：\n$$\n\\chi_{st} = 2D_Z \\left(\\left.\\frac{dZ}{dy}\\right|_{y=0}\\right)^2 = 2D_Z \\left(-\\sqrt{\\frac{a}{2\\pi D_Z}}\\right)^2\n$$\n$$\n\\chi_{st} = 2D_Z \\left(\\frac{a}{2\\pi D_Z}\\right) = \\frac{2D_Z a}{2\\pi D_Z}\n$$\n这简化为最终的闭合形式表达式：\n$$\n\\chi_{st} = \\frac{a}{\\pi}\n$$\n应变率 $a$ 的单位是 $\\mathrm{s}^{-1}$，$\\pi$ 是无量纲的，所以 $\\chi_{st}$ 的单位是 $\\mathrm{s}^{-1}$，符合要求。这是对称逆流构型中标量耗散率的著名结果。",
            "answer": "$$ \\boxed{\\frac{a}{\\pi}} $$"
        },
        {
            "introduction": "在解析理解的基础上，本实践转向一个核心的计算应用。你将亲手实现一个稳定小火焰模型——这是现代燃烧模拟的基石——来研究标量耗散率如何控制火焰行为。通过数值求解小火焰方程，你将确定导致火焰熄火的临界 $\\chi_{st}$ 值，从而直接体验标量耗散率在燃烧理论中最重要的一种作用。",
            "id": "4041973",
            "problem": "要求您在一个典型的稳态非预混火焰面框架内对条件标量耗散率进行建模，并确定随着化学计量条件标量耗散率的增加而发生的熄火现象。构建一个程序，该程序针对一组给定的具有物理意义的参数，在混合分数空间中建立并求解稳态一维火焰面边值问题，并数值确定反应解不再存在时的临界化学计量条件标量耗散率。\n\n从以下非预混稳态火焰面的既定基础开始：\n- 混合分数坐标 $z \\in [0,1]$ 索引氧化剂流（$z=0$）和燃料流（$z=1$）。\n- 标量耗散率（以混合分数为条件）被建模为一个在化学计量混合分数 $\\,z_{st}\\,$ 处有峰值的给定函数 $\\,\\chi(z)\\,$。控制参数是化学计量条件标量耗散率 $\\,\\chi_{st}\\,$。\n- 在单位刘易斯数和恒定密度近似下，混合分数空间中的穩态组分和能量平衡方程是二阶边值问题，其中扩散由 $\\,\\chi(z)\\,$ 乘以曲率表示，反应作为源项出现。考虑一个具有阿伦尼乌斯动力学的单步不可逆反应 $\\,F + s\\,O \\to P\\,$，其中 $\\,s\\,$ 是以质量单位表示的化学计量系数。\n\n设未知量为燃料质量分数 $\\,Y_F(z)\\,$、氧化剂质量分数 $\\,Y_O(z)\\,$ 和温度 $\\,T(z)\\,$。控制方程为\n$$\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_F}{dz^2} = -\\,\\omega(T, Y_F, Y_O), \\quad\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_O}{dz^2} = -\\,s\\,\\omega(T, Y_F, Y_O), \\quad\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 T}{dz^2} = -\\,\\frac{q}{c_p}\\,\\omega(T, Y_F, Y_O),\n$$\n其中反应速率建模为\n$$\n\\omega(T, Y_F, Y_O) = A\\,\\exp\\!\\left(-\\frac{E}{R\\,T}\\right)\\,Y_F\\,Y_O,\n$$\n并且 $\\,q\\,$ 是单位质量放热量（单位 $\\mathrm{J}/\\mathrm{kg}$），$\\,c_p\\,$ 是定压比热（单位 $\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$），$\\,A\\,$ 是指前因子（单位 $\\mathrm{s}^{-1}$），$\\,E\\,$ 是活化能（单位 $\\mathrm{J}/\\mathrm{mol}$），$\\,R\\,$ 是普适气体常数（单位 $\\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$）。施加代表燃料流和氧化剂流的狄利克雷边界条件：\n$$\nY_F(0) = 0, \\quad Y_O(0) = Y_{O,\\infty}, \\quad T(0) = T_{O,\\infty},\n$$\n$$\nY_F(1) = Y_{F,\\infty}, \\quad Y_O(1) = 0, \\quad T(1) = T_{F,\\infty}.\n$$\n\n根据来流和化学计量关系计算化学计量混合分数 $\\,z_{st}\\,$。对于单位分子量和单步反应 $\\,F + s\\,O \\to P\\,$，在标准非预混假设下，使用\n$$\nz_{st} = \\frac{Y_{F,\\infty}}{Y_{F,\\infty} + s\\,Y_{O,\\infty}}.\n$$\n将条件标量耗散率剖面建模为以 $\\,z_{st}\\,$ 为中心、宽度参数为 $\\,\\sigma\\,$ 的高斯分布：\n$$\n\\chi(z) = \\chi_{st}\\,\\exp\\!\\left(-\\frac{(z - z_{st})^2}{2\\,\\sigma^2}\\right),\n$$\n其中 $\\,\\chi_{st}\\,$ 是化学计量条件标量耗散率（单位 $\\mathrm{s}^{-1}$）。\n\n将熄火定义为反应解未能达到点火阈值温度 $\\,T_{\\mathrm{ign}}\\,$。具体来说，如果最高温度 $\\,\\max_z T(z)\\,$ 大于或等于 $\\,T_{\\mathrm{ign}}\\,$，则将解分类为反应解，否则为非反应解。对于给定的参数集和扫描范围 $\\,\\chi_{st} \\in [\\chi_{\\min}, \\chi_{\\max}]\\,$, 找出该范围内使解保持反应状态的最大 $\\,\\chi_{st}\\,$。如果即使在 $\\,\\chi_{st} = \\chi_{\\min}\\,$ 时也不存在反应解，则报告 $\\,0.0\\,$。如果解直到 $\\,\\chi_{st} = \\chi_{\\max}\\,$ 都保持反应状态，则报告 $\\,\\chi_{\\max}\\,$。\n\n您的程序必须：\n- 建立上述边值问题，将其转换为一阶系统，并使用适合非线性问题的鲁棒边值问题求解器进行求解。\n- 使用物理上合理的参数，并在反应速率评估中强制施加正值约束，以确保科学真实性。\n- 在给定范围内对 $\\,\\chi_{st}\\,$ 实现二分搜索，以根据点火准则确定熄火极限。\n\n物理单位：\n- 返回的 $\\,\\chi_{st}\\,$ 值单位为 $\\mathrm{s}^{-1}$。\n- 温度 $\\,T\\,$ 单位为 $\\mathrm{K}$。\n- 比热 $\\,c_p\\,$ 单位为 $\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$。\n- 放热量 $\\,q\\,$ 单位为 $\\mathrm{J}/\\mathrm{kg}$。\n- 普适气体常数 $\\,R\\,$ 单位为 $\\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$。\n\n测试套件：\n提供三个测试用例以测试不同工况。对于每个用例，您必须使用以下参数。\n\n- 案例 $\\,1\\,$（标称冷流，中等化学反应）：\n  - $\\,A = 4.0\\times 10^6\\,\\mathrm{s}^{-1}$,\n  - $\\,E/R = 1.5\\times 10^4\\,\\mathrm{K}$,\n  - $\\,q = 3.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$,\n  - $\\,c_p = 1.0\\times 10^3\\,\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$,\n  - $\\,Y_{F,\\infty} = 0.80$, $\\,Y_{O,\\infty} = 0.23$, $\\,s = 0.50$,\n  - $\\,T_{F,\\infty} = 300\\,\\mathrm{K}$, $\\,T_{O,\\infty} = 300\\,\\mathrm{K}$,\n  - $\\,\\sigma = 0.08$,\n  - $\\,\\chi_{\\min} = 1.0\\,\\mathrm{s}^{-1}$, $\\,\\chi_{\\max} = 500.0\\,\\mathrm{s}^{-1}$,\n  - $\\,T_{\\mathrm{ign}} = 1400\\,\\mathrm{K}$。\n\n- 案例 $\\,2\\,$（预热氧化剂，强点火，可能在上限之外熄火）：\n  - $\\,A = 4.0\\times 10^6\\,\\mathrm{s}^{-1}$,\n  - $\\,E/R = 1.5\\times 10^4\\,\\mathrm{K}$,\n  - $\\,q = 3.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$,\n  - $\\,c_p = 1.0\\times 10^3\\,\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$,\n  - $\\,Y_{F,\\infty} = 0.80$, $\\,Y_{O,\\infty} = 0.23$, $\\,s = 0.50$,\n  - $\\,T_{F,\\infty} = 300\\,\\mathrm{K}$, $\\,T_{O,\\infty} = 600\\,\\mathrm{K}$,\n  - $\\,\\sigma = 0.08$,\n  - $\\,\\chi_{\\min} = 1.0\\,\\mathrm{s}^{-1}$, $\\,\\chi_{\\max} = 500.0\\,\\mathrm{s}^{-1}$,\n  - $\\,T_{\\mathrm{ign}} = 1400\\,\\mathrm{K}$。\n\n- 案例 $\\,3\\,$（高活化能，弱化学反应，可能无法点火）：\n  - $\\,A = 1.0\\times 10^6\\,\\mathrm{s}^{-1}$,\n  - $\\,E/R = 2.0\\times 10^4\\,\\mathrm{K}$,\n  - $\\,q = 2.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$,\n  - $\\,c_p = 1.0\\times 10^3\\,\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$,\n  - $\\,Y_{F,\\infty} = 0.80$, $\\,Y_{O,\\infty} = 0.23$, $\\,s = 0.50$,\n  - $\\,T_{F,\\infty} = 300\\,\\mathrm{K}$, $\\,T_{O,\\infty} = 300\\,\\mathrm{K}$,\n  - $\\,\\sigma = 0.08$,\n  - $\\,\\chi_{\\min} = 1.0\\,\\mathrm{s}^{-1}$, $\\,\\chi_{\\max} = 500.0\\,\\mathrm{s}^{-1}$,\n  - $\\,T_{\\mathrm{ign}} = 1400\\,\\mathrm{K}$。\n\n算法要求：\n- 使用适用于非线性系统的数值边值问题求解器求解给定 $\\,\\chi_{st}\\,$ 的边值问题。\n- 对于每个案例，在 $\\,\\chi_{st} \\in [\\chi_{\\min}, \\chi_{\\max}]\\,$ 上实现二分搜索，以在一个小的容差范围内估计临界熄火值。\n- 在评估 $\\,\\omega\\,$ 时，强制 $\\,Y_F\\,$ 和 $\\,Y_O\\,$ 的非负性。\n- 使用一个满足边界条件的光滑初始猜测，并在 $\\,z_{st}\\,$ 附近设置一个小的温度凸起以帮助收敛。\n\n最终输出规范：\n- 您的程序必须生成单行输出，其中包含三个测试用例的结果，格式为方括号内逗号分隔的浮点数列表。\n- 每个浮点数必须是相应测试用例的估计临界 $\\,\\chi_{st}\\,$ 值（单位 $\\mathrm{s}^{-1}$），四舍五入到三位小数。\n- 对于在 $\\,\\chi_{st} \\in [\\chi_{\\min}, \\chi_{\\max}]\\,$ 范围内不存在反应解的情况，返回 $\\,0.000\\,$。对于反应解持续存在直到 $\\,\\chi_{\\max}\\,$ 的情况，返回相应四舍五入的 $\\,\\chi_{\\max}\\,$。\n- 所需输出格式示例：$\\,\\left[ \\chi_{crit,1}, \\chi_{crit,2}, \\chi_{crit,3} \\right]\\,$，需精确打印为 $\\,\\left[\\chi_{crit,1},\\chi_{crit,2},\\chi_{crit,3}\\right]\\,$。",
            "solution": "该问题具有科学依据、良定且客观。它提出了一个稳态非预混层流火焰面的典型模型，这是燃烧理论中的一个基本概念。控制方程、边界条件以及动力学/输运模型是用于研究火焰结构和熄火等现象的标准简化（例如，单位刘易斯数、单步阿伦尼乌斯动力学）。所有参数都已提供，其目标——找到熄火的临界标量耗散率——是一个定义明確的计算任务。因此，该问题是有效的，并且可以构建一个解决方案。\n\n求解方法分三个阶段进行：\n1.  控制常微分方程的数学简化。\n2.  数值边值问题 (BVP) 的建立。\n3.  实现用于寻找熄火极限的搜索算法。\n\n**1. 数学公式建立与简化**\n\n所提供的系统由三个关于燃料质量分数 $Y_F(z)$、氧化剂质量分数 $Y_O(z)$ 和温度 $T(z)$ 的耦合、二阶、非线性常微分方程组成，其中 $z$ 是混合分数坐标。\n$$\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_F}{dz^2} = -\\,\\omega, \\quad\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_O}{dz^2} = -\\,s\\,\\omega, \\quad\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 T}{dz^2} = -\\,\\frac{q}{c_p}\\,\\omega\n$$\n其中 $\\omega = A\\,\\exp\\!\\left(-\\frac{E}{R\\,T}\\right)\\,\\max(0, Y_F)\\,\\max(0, Y_O)$。对质量分数强制施加非负性是一种物理约束。\n\n该系统可以通过引入守恒标量（施瓦布-泽尔多维奇变量）来简化。请注意，因变量的某些线性组合会导致源项为零。\n\n首先，考虑 $Y_F$ 和 $Y_O$ 的组合。从控制方程我们有：\n$$\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_O}{dz^2} = s \\left( \\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_F}{dz^2} \\right)\n$$\n这意味着 $\\frac{d^2 Y_O}{dz^2} - s \\frac{d^2 Y_F}{dz^2} = 0$，或 $\\frac{d^2}{dz^2}(Y_O - s Y_F) = 0$。因此，耦合变量 $\\beta_1(z) = Y_O(z) - s Y_F(z)$ 是 $z$ 的线性函数。\n\n类似地，考虑 $T$ 和 $Y_F$ 的组合。从控制方程我们有：\n$$\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 T}{dz^2} = \\frac{q}{c_p} \\left( \\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_F}{dz^2} \\right)\n$$\n这意味着 $\\frac{d^2 T}{dz^2} - \\frac{q}{c_p} \\frac{d^2 Y_F}{dz^2} = 0$，或 $\\frac{d^2}{dz^2}(T - \\frac{q}{c_p} Y_F) = 0$。因此，耦合变量 $\\beta_2(z) = T(z) - \\frac{q}{c_p} Y_F(z)$ 也是 $z$ 的线性函数。\n\n我们可以写出 $\\beta_1(z) = C_1 z + C_2$ 和 $\\beta_2(z) = C_3 z + C_4$。常数 $C_1, C_2, C_3, C_4$ 通过在 $z=0$ 和 $z=1$ 处应用边界条件来确定。\n\n对于 $\\beta_1(z)$:\n- 在 $z=0$ 处: $Y_O(0) - s Y_F(0) = Y_{O,\\infty} - 0 = C_2$。\n- 在 $z=1$ 处: $Y_O(1) - s Y_F(1) = 0 - s Y_{F,\\infty} = C_1 + C_2 = C_1 + Y_{O,\\infty}$。 因此, $C_1 = -s Y_{F,\\infty} - Y_{O,\\infty}$。\n这得到了 $Y_O$ 的耦合关系:\n$$ Y_O(z) = s Y_F(z) - (s Y_{F,\\infty} + Y_{O,\\infty})z + Y_{O,\\infty} $$\n\n对于 $\\beta_2(z)$:\n- 在 $z=0$ 处: $T(0) - \\frac{q}{c_p} Y_F(0) = T_{O,\\infty} - 0 = C_4$。\n- 在 $z=1$ 处: $T(1) - \\frac{q}{c_p} Y_F(1) = T_{F,\\infty} - \\frac{q}{c_p} Y_{F,\\infty} = C_3 + C_4 = C_3 + T_{O,\\infty}$。 因此, $C_3 = T_{F,\\infty} - T_{O,\\infty} - \\frac{q}{c_p} Y_{F,\\infty}$。\n这得到了 $T$ 的耦合关系:\n$$ T(z) = \\frac{q}{c_p} Y_F(z) + (T_{F,\\infty} - T_{O,\\infty} - \\frac{q}{c_p} Y_{F,\\infty})z + T_{O,\\infty} $$\n\n通过这些关系，$Y_O$ 和 $T$ 由 $Y_F$ 和 $z$ 唯一确定。该系统简化为关于 $Y_F(z)$ 的单个二阶常微分方程：\n$$\n\\frac{d^2 Y_F}{dz^2} = -\\frac{2}{\\chi(z;\\chi_{st})} \\omega(T(Y_F, z), Y_F, Y_O(Y_F, z))\n$$\n边界条件为 $Y_F(0) = 0$ 和 $Y_F(1) = Y_{F,\\infty}$。\n\n**2. 数值边值问题建立**\n\n为了数值求解这个非线性BVP，我们使用一个基于配置点的求解器 `scipy.integrate.solve_bvp`，它需要一个一阶常微分方程组。我们定义一个状态向量 $\\mathbf{y}(z) = [y_0(z), y_1(z)]^T = [Y_F(z), \\frac{dY_F}{dz}(z)]^T$。然后将二阶常微分方程转换为以下系统：\n$$\n\\frac{d\\mathbf{y}}{dz} =\n\\begin{pmatrix}\ny_1 \\\\\n-\\frac{2}{\\chi(z;\\chi_{st})} \\omega(T(y_0, z), y_0, Y_O(y_0, z))\n\\end{pmatrix}\n$$\n边界条件在 $z=0$ 和 $z=1$ 处对 $\\mathbf{y}$ 指定：\n$$\ny_0(0) = 0, \\quad y_0(1) = Y_{F,\\infty}\n$$\n这就构成了一个完整的BVP公式。在分母中的 $\\chi(z)$ 上加入一个小的正则化项 $\\epsilon$（例如，$10^{-20}$），以防止在反应速率 $\\omega$ 也为零的域边界处出现除以零的情况。\n\n求解此类非线性系统的一个关键要素是提供给求解器的初始猜测。为了有利于收敛到物理上有趣的“点燃”解分支，我们构建了一个具有超绝热温度峰值的猜测。首先，计算一个非反应温度剖面：$T_{\\text{nr}}(z) = (T_{F,\\infty} - T_{O,\\infty})z + T_{O,\\infty}$。在该剖面靠近化学计量混合分数 $z_{st}$ 的位置添加一个高斯凸起，从而创建 $T_{\\text{guess}}(z)$。最后，使用施瓦布-泽尔多维奇关系将其反转，得到 $Y_F(z)$ 的初始猜测。\n\n**3. 用于寻找熄火极限的二分搜索**\n\n问题的核心是找到熄火极限，该极限定义为存在反应解的化学计量标量耗散率 $\\chi_{st}$ 的最大值。如果一个解的最高温度 $\\max_z T(z)$ 超过给定的点火阈值 $T_{\\mathrm{ign}}$，则该解被视为“反应”解。\n\n我们定义一个布尔函数 `is_reactive(chi_st)`，它为给定的 $\\chi_{st}$ 求解BVP，并在 $\\max T(z) \\ge T_{\\mathrm{ign}}$（且求解器收敛）时返回 `True`，否则返回 `False`。\n\n在指定范围 $[\\chi_{\\min}, \\chi_{\\max}]$ 内实现一个二分搜索来找到临界值 $\\chi_{crit}$。算法流程如下：\n1.  检查 `is_reactive(chi_min)`。如果为 `False`，则该范围内不存在反应解。根据问题要求，结果为 $0.0$。\n2.  检查 `is_reactive(chi_max)`。如果为 `True`，则火焰在达到搜索最大值之前都保持稳定。结果为 $\\chi_{\\max}$。\n3.  如果 `is_reactive(chi_min)` 为 `True` 且 `is_reactive(chi_max)` 为 `False`，则熄火极限位于该区间内。二分搜索迭代地缩小该区间：\n    - 设置 `low = chi_min`, `high = chi_max`。\n    - 重复固定次数的迭代（例如，30次以获得足够精度）：\n        - 计算 `mid = (low + high) / 2`。\n        - 如果 `is_reactive(mid)` 为 `True`，则临界值至少为 `mid`，因此我们设置 `low = mid`。\n        - 如果 `is_reactive(mid)` 为 `False`，则火焰已熄灭，因此临界值至多为 `mid`。我们设置 `high = mid`。\n4.  最终结果是 `low`，它代表了所发现的能够维持反应火焰的 $\\chi_{st}$ 的最高值。\n\n该程序应用于所提供的三个测试用例中的每一个，以确定它们各自的熄火极限。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_bvp\n\ndef solve():\n    \"\"\"\n    Main function to solve the flamelet extinction problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (nominal cold streams, moderate chemistry)\n        {\n            \"A\": 4.0e6, \"E_over_R\": 1.5e4, \"q\": 3.0e6, \"cp\": 1.0e3,\n            \"YF_inf\": 0.80, \"YO_inf\": 0.23, \"s\": 0.50,\n            \"TF_inf\": 300.0, \"TO_inf\": 300.0, \"sigma\": 0.08,\n            \"chi_min\": 1.0, \"chi_max\": 500.0, \"T_ign\": 1400.0\n        },\n        # Case 2 (preheated oxidizer, robust ignition)\n        {\n            \"A\": 4.0e6, \"E_over_R\": 1.5e4, \"q\": 3.0e6, \"cp\": 1.0e3,\n            \"YF_inf\": 0.80, \"YO_inf\": 0.23, \"s\": 0.50,\n            \"TF_inf\": 300.0, \"TO_inf\": 600.0, \"sigma\": 0.08,\n            \"chi_min\": 1.0, \"chi_max\": 500.0, \"T_ign\": 1400.0\n        },\n        # Case 3 (high activation energy, weak chemistry)\n        {\n            \"A\": 1.0e6, \"E_over_R\": 2.0e4, \"q\": 2.0e6, \"cp\": 1.0e3,\n            \"YF_inf\": 0.80, \"YO_inf\": 0.23, \"s\": 0.50,\n            \"TF_inf\": 300.0, \"TO_inf\": 300.0, \"sigma\": 0.08,\n            \"chi_min\": 1.0, \"chi_max\": 500.0, \"T_ign\": 1400.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        critical_chi = find_extinction_chi_st(params)\n        results.append(f\"{critical_chi:.3f}\")\n    \n    print(f\"[{','.join(results)}]\")\n\ndef find_extinction_chi_st(params):\n    \"\"\"\n    Performs a bisection search to find the critical stoichiometric scalar dissipation rate\n    for extinction.\n    \"\"\"\n    flamelet_problem = FlameletProblem(params)\n\n    # Check boundaries of the search range first\n    if not flamelet_problem.is_reactive(params['chi_min']):\n        return 0.0\n    if flamelet_problem.is_reactive(params['chi_max']):\n        return params['chi_max']\n\n    low = params['chi_min']\n    high = params['chi_max']\n    \n    # Bisection search\n    for _ in range(30):  # 30 iterations give high precision\n        mid = (low + high) / 2.0\n        if flamelet_problem.is_reactive(mid):\n            low = mid\n        else:\n            high = mid\n            \n    return low\n\nclass FlameletProblem:\n    \"\"\"\n    Encapsulates the physics and numerical setup for a single flamelet problem.\n    \"\"\"\n    def __init__(self, params):\n        self.params = params\n        self.z_st = params['YF_inf'] / (params['YF_inf'] + params['s'] * params['YO_inf'])\n        # Schvab-Zeldovich relation for T: T - (q/cp)YF = C1*z + C2\n        self.C1_T = (params['TF_inf'] - params['TO_inf'] - \n                     params['q'] / params['cp'] * params['YF_inf'])\n        self.C2_T = params['TO_inf']\n        # Schvab-Zeldovich relation for YO: YO - s*YF = C1*z + C2\n        self.C1_YO = -(params['s'] * params['YF_inf'] + params['YO_inf'])\n        self.C2_YO = params['YO_inf']\n\n    def T_from_YF(self, YF, z):\n        \"\"\"Calculates temperature T from fuel mass fraction YF and position z.\"\"\"\n        return self.params['q'] / self.params['cp'] * YF + self.C1_T * z + self.C2_T\n\n    def YO_from_YF(self, YF, z):\n        \"\"\"Calculates oxidizer mass fraction YO from YF and z.\"\"\"\n        return self.params['s'] * YF + self.C1_YO * z + self.C2_YO\n\n    def reaction_rate(self, T, YF, YO):\n        \"\"\"Calculates the Arrhenius reaction rate.\"\"\"\n        # Enforce non-negativity for mass fractions\n        YF_pos = np.maximum(0.0, YF)\n        YO_pos = np.maximum(0.0, YO)\n        # Avoid overflow in exp for very low T\n        if np.any(T  250): return 0.0 \n        return self.params['A'] * np.exp(-self.params['E_over_R'] / T) * YF_pos * YO_pos\n\n    def chi(self, z, chi_st):\n        \"\"\"Calculates the scalar dissipation rate profile.\"\"\"\n        return chi_st * np.exp(-(z - self.z_st)**2 / (2 * self.params['sigma']**2))\n\n    def ode_system(self, z, y, chi_st):\n        \"\"\"Defines the system of first-order ODEs for the BVP solver.\"\"\"\n        # y[0] = YF, y[1] = dYF/dz\n        YF = y[0]\n        \n        # Calculate T and YO from YF using Schvab-Zeldovich relations\n        T = self.T_from_YF(YF, z)\n        YO = self.YO_from_YF(YF, z)\n        \n        # Calculate reaction rate\n        omega = self.reaction_rate(T, YF, YO)\n        \n        # Calculate d2YF/dz2\n        # Add a small epsilon to chi to avoid division by zero\n        chi_val = self.chi(z, chi_st)\n        d2YF_dz2 = -2.0 * omega / (chi_val + 1e-20)\n        \n        return np.vstack((y[1], d2YF_dz2))\n\n    def bc(self, ya, yb):\n        \"\"\"Defines the boundary conditions for the BVP solver.\"\"\"\n        # ya: solution at z=0, yb: solution at z=1\n        # y[0] = YF\n        return np.array([ya[0] - 0.0, yb[0] - self.params['YF_inf']])\n\n    def make_initial_guess(self, z_mesh):\n        \"\"\"Creates a physically-informed initial guess to aid convergence.\"\"\"\n        YF_guess = np.zeros_like(z_mesh)\n        \n        # Non-reacting T profile + bump\n        T_nr = (self.params['TF_inf'] - self.params['TO_inf']) * z_mesh + self.params['TO_inf']\n        T_bump = 800.0 * np.exp(-(z_mesh - self.z_st)**2 / (2 * 0.05**2))\n        T_guess = T_nr + T_bump\n        \n        # Invert T_guess to get YF_guess via S-Z relation\n        YF_guess = (self.params['cp'] / self.params['q']) * (T_guess - (self.C1_T * z_mesh + self.C2_T))\n        \n        # The derivative can be approximated from the linear profile\n        dYF_dz_guess = np.full_like(z_mesh, self.params['YF_inf'])\n        \n        return np.vstack((YF_guess, dYF_dz_guess))\n\n    def solve_single_chi_st(self, chi_st):\n        \"\"\"Solves the flamelet BVP for a given chi_st.\"\"\"\n        z_mesh = np.linspace(0, 1, 150)\n        y_guess = self.make_initial_guess(z_mesh)\n\n        sol = solve_bvp(lambda z, y: self.ode_system(z, y, chi_st),\n                        self.bc, z_mesh, y_guess, tol=1e-4, max_nodes=2000)\n\n        if sol.success:\n            # Re-interpolate on a fine mesh to find a more accurate max temperature\n            z_fine = np.linspace(0, 1, 500)\n            YF_sol = sol.sol(z_fine)[0]\n            T_sol = self.T_from_YF(YF_sol, z_fine)\n            return np.max(T_sol)\n        else:\n            return 0.0  # Solver failure implies non-reactive\n\n    def is_reactive(self, chi_st):\n        \"\"\"Checks if a solution is reactive based on the ignition temperature.\"\"\"\n        max_T = self.solve_single_chi_st(chi_st)\n        return max_T >= self.params['T_ign']\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "我们最后的实践将连接理想层流火焰与复杂的湍流燃烧。在真实火焰中，热释放导致显著的密度变化，这使得我们如何定义平均量变得复杂。本练习通过一个数值算例，展示了对标量耗散率进行常规（雷诺）平均和密度加权（Favre）平均之间的关键区别，这是正确建模和解释湍流反应流的一个至关重要的概念。",
            "id": "4060194",
            "problem": "考虑一个恒压环境中带放热的一维混合层，该混合层在区间 $[0,L]$ 上建模，其中 $L$ 是以米为单位的域长度。守恒混合分数场由双曲正切剖面 $Z(x) = \\frac{1}{2}\\left(1+\\tanh\\left(\\frac{x-x_0}{\\delta}\\right)\\right)$ 定义，其中 $x_0$ 是火焰面中心的位置（以米为单位），$\\delta$ 是特征厚度（以米为单位）。假设分子扩散系数 $D$ 为常数，单位为平方米/秒。混合分数的瞬时标量耗散率定义为 $\\chi_Z(x) = 2 D \\left(\\frac{dZ}{dx}\\right)^2$，单位为秒的倒数。热量释放通过理想气体定律在恒定压力 $p$ 和气体常数 $R$ 下改变密度，温度场由 $T(x) = T_u + \\Delta T \\left(Z(x)\\right)^{\\beta}$ 给出，其中 $T_u$ 是未燃气体温度（以开尔文为单位），$\\Delta T$ 是由热量释放引起的温升（以开尔文为单位），$\\beta$ 是一个正的形状参数。在这些假设下，密度为 $\\rho(x) = \\frac{p}{R\\,T(x)}$，单位为千克/立方米。\n\n计算域 $[0,L]$ 上的 Favre 平均标量耗散率 $\\tilde{\\chi_Z}$ 和非 Favre 空间平均值 $\\bar{\\chi_Z}$。使用以下定义\n$$\n\\tilde{\\chi_Z} = \\frac{\\int_{0}^{L} \\rho(x)\\,\\chi_Z(x)\\,dx}{\\int_{0}^{L} \\rho(x)\\,dx}, \\quad\n\\bar{\\chi_Z} = \\frac{1}{L}\\int_{0}^{L} \\chi_Z(x)\\,dx.\n$$\n通过分数差量化在密度不均匀时使用非 Favre 平均引入的误差\n$$\ne = \\frac{\\bar{\\chi_Z} - \\tilde{\\chi_Z}}{\\tilde{\\chi_Z}}.\n$$\n您的程序必须构建规定的场，对积分进行数值计算，并返回每个测试用例的 $\\tilde{\\chi_Z}$、$\\bar{\\chi_Z}$ 和 $e$。量 $\\tilde{\\chi_Z}$ 和 $\\bar{\\chi_Z}$ 必须以秒的倒数 (s$^{-1}$) 表示，$e$ 必须表示为小数（无单位）。\n\n对测试套件使用以下物理上一致的参数：\n$L = 1.0\\times 10^{-2}$ 米, $x_0 = \\frac{L}{2}$ 米, $p = 1.01325\\times 10^{5}$ 帕, $R = 287$ 焦耳/(千克$\\cdot$开尔文), $T_u = 300$ 开尔文, $D = 1.5\\times 10^{-5}$ 米$^2$/秒。在四个案例中改变 $\\delta$、$\\Delta T$ 和 $\\beta$ 以测试不同条件：\n$1.$ 理想情况: $\\delta = 2.0\\times 10^{-4}$ 米, $\\Delta T = 9.0\\times 10^{2}$ 开尔文, $\\beta = 2$。\n$2.$ 边界情况（均匀密度）: $\\delta = 2.0\\times 10^{-4}$ 米, $\\Delta T = 0$ 开尔文, $\\beta = 2$。\n$3.$ 边缘情况（强放热，薄层）: $\\delta = 1.5\\times 10^{-4}$ 米, $\\Delta T = 1.5\\times 10^{3}$ 开尔文, $\\beta = 3$。\n$4.$ 较宽层: $\\delta = 8.0\\times 10^{-4}$ 米, $\\Delta T = 1.2\\times 10^{3}$ 开尔文, $\\beta = 1$。\n\n您的程序必须：\n$1.$ 构建 $Z(x)$ 并根据双曲正切的解析导数精确计算 $\\frac{dZ}{dx}$。\n$2.$ 使用给定的关系式构建 $T(x)$ 和 $\\rho(x)$。\n$3.$ 计算 $\\chi_Z(x)=2D\\left(\\frac{dZ}{dx}\\right)^2$，然后通过在 $x\\in[0,L]$ 上的数值积分计算 $\\tilde{\\chi_Z}$、$\\bar{\\chi_Z}$ 和 $e$。\n$4.$ 在 $[0,L]$ 上使用足够精细的均匀网格以确保数值准确性。\n\n最终输出格式规范：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个三项列表 $[\\tilde{\\chi_Z},\\bar{\\chi_Z},e]$。该行不得有空格，每个浮点数应格式化为六位小数。例如，输出形式应为 $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3],[a_4,b_4,c_4]]$，其中 $a_i$ 和 $b_i$ 的单位是 s$^{-1}$，$c_i$ 是一个小数。",
            "solution": "该问题要求计算和比较一维、变密度混合层中的 Favre 平均和非 Favre（雷诺平均）标量耗散率。这是燃烧理论中的一个典型问题，其中由热释放引起的密度变化会显著影响湍流输运和反应速率。这两种平均方法之间的差异凸显了在可压缩或反应流中进行密度加权（Favre 平均）的重要性。\n\n首先，我们根据所提供的定义，构建必要的解析表达式。混合分数场 $Z(x)$ 由双曲正切剖面给出，这是一维混合层的标准模型：\n$$\nZ(x) = \\frac{1}{2}\\left(1+\\tanh\\left(\\frac{x-x_0}{\\delta}\\right)\\right)\n$$\n其中 $x \\in [0, L]$。这里，$x_0$ 是混合层的中心，$\\delta$ 是其特征厚度。\n\n瞬时标量耗散率 $\\chi_Z(x)$ 定义为 $\\chi_Z(x) = 2 D (\\nabla Z \\cdot \\nabla Z)$。在一维情况下，这简化为：\n$$\n\\chi_Z(x) = 2 D \\left(\\frac{dZ}{dx}\\right)^2\n$$\n为计算此值，我们首先计算 $Z(x)$ 的解析导数。使用链式法则和恒等式 $\\frac{d}{du}\\tanh(u) = \\text{sech}^2(u)$，我们得到：\n$$\n\\frac{dZ}{dx} = \\frac{1}{2} \\cdot \\text{sech}^2\\left(\\frac{x-x_0}{\\delta}\\right) \\cdot \\frac{1}{\\delta} = \\frac{1}{2\\delta} \\text{sech}^2\\left(\\frac{x-x_0}{\\delta}\\right)\n$$\n将此导数代入 $\\chi_Z(x)$ 的表达式中，得到：\n$$\n\\chi_Z(x) = 2 D \\left(\\frac{1}{2\\delta} \\text{sech}^2\\left(\\frac{x-x_0}{\\delta}\\right)\\right)^2 = \\frac{D}{2\\delta^2} \\text{sech}^4\\left(\\frac{x-x_0}{\\delta}\\right)\n$$\n该表达式表明 $\\chi_Z(x)$ 是一个正定函数，在 $x=x_0$ 处有尖锐的峰值，并随着远离混合层中心而迅速衰减。\n\n热释放通过温度场 $T(x)$ 来建模，该温度场是混合分数 $Z(x)$ 的函数：\n$$\nT(x) = T_u + \\Delta T \\left(Z(x)\\right)^{\\beta}\n$$\n这里，$T_u$ 是未燃气体温度，$\\Delta T$ 是总温升，$\\beta$ 是一个形状参数。假设在恒定压力 $p$ 下满足理想气体定律，密度场 $\\rho(x)$ 与温度成反比：\n$$\n\\rho(x) = \\frac{p}{R\\,T(x)} = \\frac{p}{R \\left(T_u + \\Delta T \\left(Z(x)\\right)^{\\beta}\\right)}\n$$\n其中 $R$ 是比气体常数。当 $\\Delta T > 0$ 时，在 $Z(x) > 0$ 的区域温度升高，导致密度 $\\rho(x)$ 降低。\n\n该问题要求计算 $\\chi_Z(x)$ 在域 $[0,L]$ 上的两种不同空间平均值。\n第一种是非 Favre 平均，或称常规空间平均（类似于雷诺平均），定义为：\n$$\n\\bar{\\chi_Z} = \\frac{1}{L}\\int_{0}^{L} \\chi_Z(x)\\,dx\n$$\n第二种是 Favre 平均标量耗散率，它是一种密度加权平均：\n$$\n\\tilde{\\chi_Z} = \\frac{\\int_{0}^{L} \\rho(x)\\,\\chi_Z(x)\\,dx}{\\int_{0}^{L} \\rho(x)\\,dx}\n$$\nFavre 平均考虑了局部密度变化。如果密度是恒定的，即 $\\rho(x) = \\rho_0$，那么 $\\tilde{\\chi_Z}$ 就简化为 $\\bar{\\chi_Z}$。这在 $\\Delta T = 0$ 的特殊情况下发生。\n\n最后，我们通过计算分数差来量化忽略密度变化所引入的误差：\n$$\ne = \\frac{\\bar{\\chi_Z} - \\tilde{\\chi_Z}}{\\tilde{\\chi_Z}}\n$$\n在物理上，$\\chi_Z(x)$ 集中在 $x_0$ 周围的薄混合层中。在该区域，如果存在热释放（$\\Delta T > 0$），温度会升高，密度会低于未燃烧区域。因此，与非加权平均 $\\bar{\\chi_Z}$ 相比，Favre 平均 $\\tilde{\\chi_Z}$ 中的密度加权会减弱这个高耗散、低密度区域的贡献。因此，我们预期当 $\\Delta T > 0$ 时，$\\tilde{\\chi_Z}  \\bar{\\chi_Z}$，从而产生一个正误差 $e$。\n\n计算 $\\bar{\\chi_Z}$ 和 $\\tilde{\\chi_Z}$ 所需的积分没有简单的解析解，必须进行数值计算。实施策略包括以下步骤：\n$1.$ 将空间域 $[0,L]$ 离散化为一个由点 $x_i$ 组成的精细均匀网格。选择大量的点以确保薄混合层结构得到良好解析。\n$2.$ 在每个网格点 $x_i$ 上，使用上面推导的解析公式计算函数 $Z(x_i)$、$\\frac{dZ}{dx}(x_i)$、$\\chi_Z(x_i)$、$T(x_i)$ 和 $\\rho(x_i)$。\n$3.$ 使用数值积分方法（如梯形法则）来近似三个定积分：$\\int \\chi_Z(x) dx$、$\\int \\rho(x) \\chi_Z(x) dx$ 和 $\\int \\rho(x) dx$。\n$4.$ 根据定义组合积分结果，计算 $\\bar{\\chi_Z}$、$\\tilde{\\chi_Z}$ 和 $e$。\n$5.$ 对提供的四个测试用例重复此过程，通过改变层厚度 $\\delta$、温升 $\\Delta T$ 和剖面形状 $\\beta$ 来探索不同的物理状态。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares Favre-averaged and non-Favre-averaged scalar dissipation rates\n    for a one-dimensional, variable-density mixing layer.\n    \"\"\"\n\n    # Define physical constants\n    L = 1.0e-2       # Domain length [m]\n    x0 = L / 2.0     # Flame sheet center [m]\n    p = 1.01325e5    # Pressure [Pa]\n    R = 287.0        # Gas constant for air [J/(kg.K)]\n    Tu = 300.0       # Unburned temperature [K]\n    D = 1.5e-5       # Molecular diffusivity [m^2/s]\n    N = 20001        # Number of grid points for numerical integration\n\n    # Define the four test cases\n    test_cases = [\n        # (delta, Delta_T, beta)\n        (2.0e-4, 9.0e2, 2.0),  # 1. Happy path\n        (2.0e-4, 0.0, 2.0),   # 2. Boundary (uniform density)\n        (1.5e-4, 1.5e3, 3.0),  # 3. Edge (strong heat release, thin layer)\n        (8.0e-4, 1.2e3, 1.0),  # 4. Broader layer\n    ]\n\n    # Create the spatial grid\n    x = np.linspace(0, L, N)\n\n    results = []\n    for case in test_cases:\n        delta, Delta_T, beta = case\n\n        # 1. Construct Z(x) and its analytical derivative dZ/dx\n        arg = (x - x0) / delta\n        Z_x = 0.5 * (1.0 + np.tanh(arg))\n        \n        # dZ/dx = 1/(2*delta) * sech^2((x-x0)/delta)\n        dZ_dx = (1.0 / (2.0 * delta)) * (1.0 / np.cosh(arg))**2\n\n        # 2. Compute the scalar dissipation rate chi_Z(x)\n        chi_Z_x = 2.0 * D * (dZ_dx**2)\n\n        # 3. Construct the temperature T(x) and density rho(x) fields\n        T_x = Tu + Delta_T * (Z_x**beta)\n        rho_x = p / (R * T_x)\n        \n        # 4. Compute the non-Favre average scalar dissipation rate\n        integral_chi_Z = np.trapz(chi_Z_x, x)\n        bar_chi_Z = integral_chi_Z / L\n\n        # 5. Compute the Favre-averaged scalar dissipation rate\n        # Denominator in the Favre average definition\n        integral_rho = np.trapz(rho_x, x)\n        \n        # Numerator in the Favre average definition\n        integral_rho_chi_Z = np.trapz(rho_x * chi_Z_x, x)\n\n        # Handle the case of uniform density to avoid division by zero\n        # although integral_rho will always be positive here.\n        if integral_rho > 0:\n            tilde_chi_Z = integral_rho_chi_Z / integral_rho\n        else: # Should not be reached in this problem\n            tilde_chi_Z = 0.0\n\n        # 6. Compute the fractional error\n        # Handle the case tilde_chi_Z = 0 (e.g., if D=0)\n        if abs(tilde_chi_Z) > 1e-12:\n            error = (bar_chi_Z - tilde_chi_Z) / tilde_chi_Z\n        else:\n            # If tilde_chi_Z is zero, bar_chi_Z must also be zero (for D>0).\n            # The only way they differ slightly is due to numerics in the\n            # uniform density case.\n            error = 0.0\n\n        results.append([tilde_chi_Z, bar_chi_Z, error])\n\n    # Format the final output string as specified\n    formatted_cases = []\n    for res in results:\n        tilde_chi, bar_chi, err = res\n        formatted_cases.append(f\"[{tilde_chi:.6f},{bar_chi:.6f},{err:.6f}]\")\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(formatted_cases)}]\")\n\nsolve()\n```"
        }
    ]
}