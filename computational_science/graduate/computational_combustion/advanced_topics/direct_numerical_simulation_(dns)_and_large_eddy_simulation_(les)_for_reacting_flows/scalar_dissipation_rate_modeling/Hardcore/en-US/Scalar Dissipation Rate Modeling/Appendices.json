{
    "hands_on_practices": [
        {
            "introduction": "To build a strong foundation, it is essential to connect the abstract concept of the scalar dissipation rate to tangible flow properties. This exercise guides you through a classic analytical derivation for a laminar opposed-jet configuration, a canonical flow in combustion research. By solving the mixture fraction transport equation, you will uncover the direct relationship between the externally imposed strain rate, $a$, and the resulting stoichiometric scalar dissipation rate, $\\chi_{st}$, providing a concrete physical meaning to this crucial parameter.",
            "id": "4041998",
            "problem": "Consider a steady, planar opposed-jet flow creating a stagnation-point mixing layer. Let the mixture fraction $Z$ be a conserved scalar that obeys the steady advectionâ€“diffusion equation for incompressible flow,\n$$\n\\boldsymbol{u}\\cdot\\nabla Z = D_Z \\nabla^{2} Z,\n$$\nwhere $D_Z$ is the mixture-fraction diffusivity. Assume the velocity field in a thin neighborhood of the stagnation plane has the one-dimensional linear strain form normal to the mixing layer,\n$$\nu_y(y) = - a\\, y,\n$$\nwhere $a$ is the strain rate and $y$ is the coordinate normal to the mixing layer. In this one-dimensional setting, the mixture fraction satisfies\n$$\n- a\\, y\\, \\frac{d Z}{d y} = D_Z \\frac{d^{2} Z}{d y^{2}},\n$$\nwith physically consistent far-field boundary conditions $Z(y\\to -\\infty)=1$ (fuel stream) and $Z(y\\to +\\infty)=0$ (oxidizer stream).\n\nDefine the conditional scalar dissipation rate at the stoichiometric mixture fraction $Z_{st}$ as\n$$\n\\chi_{st} \\equiv 2\\,D_Z\\,\\big|\\nabla Z\\big|^{2}\\Big|_{Z=Z_{st}},\n$$\nwhere the gradient is taken normal to the $Z=Z_{st}$ iso-surface. Using a similarity analysis of the mixture-fraction transport equation, derive an expression for $\\chi_{st}$ in terms of $a$, $D_Z$, and the normal gradient of $Z$ at the stoichiometric surface, $\\left|\\frac{\\partial Z}{\\partial n}\\right|_{st}$. Then, specialize to the symmetric opposed-jet case where $Z_{st}=\\frac{1}{2}$, for which the stoichiometric surface coincides with the stagnation plane at $y=0$, and obtain a closed-form expression for $\\chi_{st}$ in this symmetric case.\n\nExpress the final answer for the symmetric case as a single closed-form analytic expression. No numerical approximation is required. Express the final conditional scalar dissipation rate $\\chi_{st}$ in $\\mathrm{s}^{-1}$.",
            "solution": "The problem asks for the derivation of an expression for the conditional scalar dissipation rate, $\\chi_{st}$, first in a general context and then for a specific symmetric case.\n\nThe one-dimensional transport equation for the mixture fraction $Z(y)$ is given as:\n$$\nD_Z \\frac{d^{2} Z}{d y^{2}} + a\\, y\\, \\frac{d Z}{d y} = 0\n$$\nwhere $a$ is the strain rate and $D_Z$ is the diffusivity. This is a second-order linear ordinary differential equation. We can solve it by letting $W(y) = \\frac{dZ}{dy}$. The equation becomes a first-order separable ODE for $W$:\n$$\nD_Z \\frac{dW}{dy} = -a\\, y\\, W\n$$\nSeparating variables, we get:\n$$\n\\frac{dW}{W} = -\\frac{a}{D_Z} y\\, dy\n$$\nIntegrating both sides yields:\n$$\n\\int \\frac{dW}{W} = \\int -\\frac{a}{D_Z} y\\, dy \\implies \\ln|W| = -\\frac{a}{2D_Z} y^2 + C_1\n$$\nwhere $C_1$ is a constant of integration. Exponentiating both sides gives:\n$$\nW(y) = C_2 \\exp\\left(-\\frac{a y^2}{2D_Z}\\right)\n$$\nwhere $C_2$ is another constant. Since $W(y) = \\frac{dZ}{dy}$, we now integrate this expression to find $Z(y)$:\n$$\nZ(y) = \\int C_2 \\exp\\left(-\\frac{a y^2}{2D_Z}\\right) dy + C_3\n$$\nThis integral involves the Gaussian function. The solution can be expressed in terms of the error function, $\\text{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_0^x \\exp(-t^2) dt$. Let's introduce a similarity variable $\\eta = y \\sqrt{\\frac{a}{2D_Z}}$. Then $d\\eta = \\sqrt{\\frac{a}{2D_Z}} dy$.\nThe integral for $Z(y)$ becomes:\n$$\nZ(y) = C_2 \\int \\exp(-\\eta^2) \\sqrt{\\frac{2D_Z}{a}} d\\eta + C_3 = C_2 \\sqrt{\\frac{2D_Z}{a}} \\left(\\frac{\\sqrt{\\pi}}{2} \\text{erf}(\\eta)\\right) + C_3\n$$\nCombining the constants, we can write the general solution as:\n$$\nZ(y) = C_4 \\text{erf}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right) + C_3\n$$\nWe determine the constants $C_3$ and $C_4$ using the far-field boundary conditions: $Z(y\\to\\infty)=0$ and $Z(y\\to-\\infty)=1$. We use the limits of the error function: $\\lim_{x\\to\\infty} \\text{erf}(x) = 1$ and $\\lim_{x\\to-\\infty} \\text{erf}(x) = -1$.\nFor $y \\to \\infty$:\n$$\nZ(\\infty) = C_4(1) + C_3 = 0\n$$\nFor $y \\to -\\infty$:\n$$\nZ(-\\infty) = C_4(-1) + C_3 = 1\n$$\nWe have a system of two linear equations:\n1. $C_4 + C_3 = 0 \\implies C_3 = -C_4$\n2. $-C_4 + C_3 = 1$\n\nSubstituting (1) into (2) gives $-C_4 - C_4 = 1 \\implies -2C_4 = 1 \\implies C_4 = -\\frac{1}{2}$.\nThen $C_3 = -(-\\frac{1}{2}) = \\frac{1}{2}$.\nThe solution for the mixture fraction profile is:\n$$\nZ(y) = \\frac{1}{2} - \\frac{1}{2} \\text{erf}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right) = \\frac{1}{2} \\text{erfc}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right)\n$$\nwhere $\\text{erfc}(x) = 1 - \\text{erf}(x)$ is the complementary error function.\n\nNow, we address the conditional scalar dissipation rate, $\\chi_{st}$. The problem defines it as:\n$$\n\\chi_{st} \\equiv 2\\,D_Z\\,\\big|\\nabla Z\\big|^{2}\\Big|_{Z=Z_{st}}\n$$\nIn our one-dimensional setting, the gradient $\\nabla Z$ is simply $\\frac{dZ}{dy}\\boldsymbol{e}_y$, so its magnitude squared is $|\\nabla Z|^2 = \\left(\\frac{dZ}{dy}\\right)^2$. The expression becomes:\n$$\n\\chi_{st} = 2\\,D_Z\\,\\left(\\frac{dZ}{dy}\\right)^2\\Big|_{y=y_{st}}\n$$\nwhere $y_{st}$ is the coordinate where $Z(y_{st}) = Z_{st}$.\n\nThe problem now asks to specialize to the symmetric case where $Z_{st} = \\frac{1}{2}$. We find the location $y_{st}$ of this surface:\n$$\nZ(y_{st}) = \\frac{1}{2} \\implies \\frac{1}{2} \\text{erfc}\\left(y_{st} \\sqrt{\\frac{a}{2D_Z}}\\right) = \\frac{1}{2} \\implies \\text{erfc}\\left(y_{st} \\sqrt{\\frac{a}{2D_Z}}\\right) = 1\n$$\nSince $\\text{erfc}(x) = 1$ only at $x=0$, we must have $y_{st} \\sqrt{\\frac{a}{2D_Z}} = 0$, which implies $y_{st}=0$. The stoichiometric surface is at the stagnation plane, as stated in the problem.\n\nNext, we need to compute the gradient $\\frac{dZ}{dy}$ and evaluate it at $y_{st}=0$.\n$$\n\\frac{dZ}{dy} = \\frac{d}{dy}\\left[ \\frac{1}{2} - \\frac{1}{2} \\text{erf}\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right) \\right]\n$$\nUsing the chain rule and the derivative of the error function, $\\frac{d}{dx}\\text{erf}(u) = \\frac{2}{\\sqrt{\\pi}} \\exp(-u^2) \\frac{du}{dx}$:\n$$\n\\frac{dZ}{dy} = -\\frac{1}{2} \\left[ \\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\left(y \\sqrt{\\frac{a}{2D_Z}}\\right)^2\\right) \\cdot \\sqrt{\\frac{a}{2D_Z}} \\right]\n$$\n$$\n\\frac{dZ}{dy} = -\\frac{1}{\\sqrt{\\pi}} \\exp\\left(-\\frac{a y^2}{2D_Z}\\right) \\sqrt{\\frac{a}{2D_Z}} = -\\sqrt{\\frac{a}{2\\pi D_Z}} \\exp\\left(-\\frac{a y^2}{2D_Z}\\right)\n$$\nNow, we evaluate this gradient at the stoichiometric surface $y_{st}=0$:\n$$\n\\left.\\frac{dZ}{dy}\\right|_{y=0} = -\\sqrt{\\frac{a}{2\\pi D_Z}} \\exp(0) = -\\sqrt{\\frac{a}{2\\pi D_Z}}\n$$\nFinally, we substitute this gradient into the expression for $\\chi_{st}$:\n$$\n\\chi_{st} = 2D_Z \\left(\\left.\\frac{dZ}{dy}\\right|_{y=0}\\right)^2 = 2D_Z \\left(-\\sqrt{\\frac{a}{2\\pi D_Z}}\\right)^2\n$$\n$$\n\\chi_{st} = 2D_Z \\left(\\frac{a}{2\\pi D_Z}\\right) = \\frac{2D_Z a}{2\\pi D_Z}\n$$\nThis simplifies to the final closed-form expression:\n$$\n\\chi_{st} = \\frac{a}{\\pi}\n$$\nThe strain rate $a$ has units of $\\mathrm{s}^{-1}$, and $\\pi$ is dimensionless, so $\\chi_{st}$ has units of $\\mathrm{s}^{-1}$ as requested. This is the celebrated result for the scalar dissipation rate in a symmetric counterflow configuration.",
            "answer": "$$ \\boxed{\\frac{a}{\\pi}} $$"
        },
        {
            "introduction": "The scalar dissipation rate is the central parameter governing the structure and stability of non-premixed flames in the flamelet regime. This computational practice immerses you in the flamelet model by tasking you with solving the 1D flamelet equations in mixture fraction space. By systematically increasing the stoichiometric scalar dissipation rate, $\\chi_{st}$, you will simulate the flame's response and identify the critical value at which mixing overwhelms chemistry, leading to extinction.",
            "id": "4041973",
            "problem": "You are asked to model conditional scalar dissipation rates within a canonical steady non-premixed flamelet framework and to identify extinction as the stoichiometric conditional scalar dissipation rate increases. Build a program that, for a given set of physically meaningful parameters, formulates and solves the steady one-dimensional flamelet boundary value problem in mixture fraction space and numerically determines the critical stoichiometric conditional scalar dissipation rate at which the reactive solution ceases to exist.\n\nStart from the following established base for non-premixed steady flamelets:\n- The mixture fraction coordinate $z \\in [0,1]$ indexes the oxidizer stream at $z=0$ and the fuel stream at $z=1$.\n- The scalar dissipation rate (conditional on mixture fraction) is modeled as a prescribed function $\\,\\chi(z)\\,$ with a peak at the stoichiometric mixture fraction $\\,z_{st}\\,$. The control parameter is the stoichiometric conditional scalar dissipation rate $\\,\\chi_{st}\\,$.\n- Under unity Lewis number and constant density approximations, the steady species and energy balance equations in mixture fraction space are second-order boundary value problems, where diffusion is represented by $\\,\\chi(z)\\,$ multiplying curvature and reaction appears as a source term. Consider a single irreversible one-step reaction with Arrhenius kinetics, $\\,F + s\\,O \\to P\\,$, where $\\,s\\,$ is the stoichiometric coefficient in mass units.\n\nLet the unknowns be the fuel mass fraction $\\,Y_F(z)\\,$, the oxidizer mass fraction $\\,Y_O(z)\\,$, and the temperature $\\,T(z)\\,$. The governing equations are\n$$\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_F}{dz^2} = -\\,\\omega(T, Y_F, Y_O), \\quad\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 Y_O}{dz^2} = -\\,s\\,\\omega(T, Y_F, Y_O), \\quad\n\\frac{\\chi(z)}{2}\\,\\frac{d^2 T}{dz^2} = -\\,\\frac{q}{c_p}\\,\\omega(T, Y_F, Y_O),\n$$\nwhere the reaction rate is modeled as\n$$\n\\omega(T, Y_F, Y_O) = A\\,\\exp\\!\\left(-\\frac{E}{R\\,T}\\right)\\,Y_F\\,Y_O,\n$$\nand $\\,q\\,$ is the specific heat release (in $\\mathrm{J}/\\mathrm{kg}$), $\\,c_p\\,$ is the specific heat at constant pressure (in $\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$), $\\,A\\,$ is a pre-exponential factor (in $\\mathrm{s}^{-1}$), $\\,E\\,$ is an activation energy (in $\\mathrm{J}/\\mathrm{mol}$), and $\\,R\\,$ is the universal gas constant (in $\\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$). Impose Dirichlet boundary conditions representing the fuel and oxidizer streams:\n$$\nY_F(0) = 0, \\quad Y_O(0) = Y_{O,\\infty}, \\quad T(0) = T_{O,\\infty},\n$$\n$$\nY_F(1) = Y_{F,\\infty}, \\quad Y_O(1) = 0, \\quad T(1) = T_{F,\\infty}.\n$$\n\nCompute the stoichiometric mixture fraction $\\,z_{st}\\,$ from the streams and stoichiometry. For unity molecular weights and a single-step reaction $\\,F + s\\,O \\to P\\,$, under standard non-premixed assumptions, use\n$$\nz_{st} = \\frac{Y_{F,\\infty}}{Y_{F,\\infty} + s\\,Y_{O,\\infty}}.\n$$\nModel the conditional scalar dissipation rate profile as a Gaussian centered at $\\,z_{st}\\,$ with width parameter $\\,\\sigma\\,$:\n$$\n\\chi(z) = \\chi_{st}\\,\\exp\\!\\left(-\\frac{(z - z_{st})^2}{2\\,\\sigma^2}\\right),\n$$\nwhere $\\,\\chi_{st}\\,$ is the stoichiometric conditional scalar dissipation rate (in $\\mathrm{s}^{-1}$).\n\nDefine extinction by the failure of the reactive solution to reach an ignition threshold temperature $\\,T_{\\mathrm{ign}}\\,$. Specifically, classify a solution as reactive if the maximum temperature $\\,\\max_z T(z)\\,$ is greater than or equal to $\\,T_{\\mathrm{ign}}\\,$, and non-reactive otherwise. For a given parameter set and a scan range $\\,\\chi_{st} \\in [\\chi_{\\min}, \\chi_{\\max}]\\,$, identify the largest $\\,\\chi_{st}\\,$ within the range for which the solution is reactive. If no reactive solution exists even at $\\,\\chi_{st} = \\chi_{\\min}\\,$, report $\\,0.0\\,$. If the solution remains reactive up to $\\,\\chi_{st} = \\chi_{\\max}\\,$, report $\\,\\chi_{\\max}\\,$.\n\nYour program must:\n- Formulate the above boundary value problem, convert it to a first-order system, and solve it using a robust boundary value problem solver suitable for nonlinear problems.\n- Use physically plausible parameters and enforce positivity constraints in the reaction rate evaluation to ensure scientific realism.\n- Implement a bisection search over $\\,\\chi_{st}\\,$ in the provided range to determine the extinction limit according to the ignition criterion.\n\nPhysical units:\n- Return $\\,\\chi_{st}\\,$ values in $\\mathrm{s}^{-1}$.\n- Temperatures $\\,T\\,$ are in $\\mathrm{K}$.\n- Specific heat $\\,c_p\\,$ is in $\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$.\n- Heat release $\\,q\\,$ is in $\\mathrm{J}/\\mathrm{kg}$.\n- The universal gas constant $\\,R\\,$ is in $\\mathrm{J}/\\mathrm{mol}\\cdot\\mathrm{K}$.\n\nTest Suite:\nProvide three test cases to exercise different regimes. For each case, you must use the following parameters.\n\n- Case $\\,1\\,$ (nominal cold streams, moderate chemistry):\n  - $\\,A = 4.0\\times 10^6\\,\\mathrm{s}^{-1}$,\n  - $\\,E/R = 1.5\\times 10^4\\,\\mathrm{K}$,\n  - $\\,q = 3.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$,\n  - $\\,c_p = 1.0\\times 10^3\\,\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$,\n  - $\\,Y_{F,\\infty} = 0.80$, $\\,Y_{O,\\infty} = 0.23$, $\\,s = 0.50$,\n  - $\\,T_{F,\\infty} = 300\\,\\mathrm{K}$, $\\,T_{O,\\infty} = 300\\,\\mathrm{K}$,\n  - $\\,\\sigma = 0.08$,\n  - $\\,\\chi_{\\min} = 1.0\\,\\mathrm{s}^{-1}$, $\\,\\chi_{\\max} = 500.0\\,\\mathrm{s}^{-1}$,\n  - $\\,T_{\\mathrm{ign}} = 1400\\,\\mathrm{K}$.\n\n- Case $\\,2\\,$ (preheated oxidizer, robust ignition, potential extinction beyond upper bound):\n  - $\\,A = 4.0\\times 10^6\\,\\mathrm{s}^{-1}$,\n  - $\\,E/R = 1.5\\times 10^4\\,\\mathrm{K}$,\n  - $\\,q = 3.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$,\n  - $\\,c_p = 1.0\\times 10^3\\,\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$,\n  - $\\,Y_{F,\\infty} = 0.80$, $\\,Y_{O,\\infty} = 0.23$, $\\,s = 0.50$,\n  - $\\,T_{F,\\infty} = 300\\,\\mathrm{K}$, $\\,T_{O,\\infty} = 600\\,\\mathrm{K}$,\n  - $\\,\\sigma = 0.08$,\n  - $\\,\\chi_{\\min} = 1.0\\,\\mathrm{s}^{-1}$, $\\,\\chi_{\\max} = 500.0\\,\\mathrm{s}^{-1}$,\n  - $\\,T_{\\mathrm{ign}} = 1400\\,\\mathrm{K}$.\n\n- Case $\\,3\\,$ (high activation energy, weak chemistry, likely no ignition):\n  - $\\,A = 1.0\\times 10^6\\,\\mathrm{s}^{-1}$,\n  - $\\,E/R = 2.0\\times 10^4\\,\\mathrm{K}$,\n  - $\\,q = 2.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$,\n  - $\\,c_p = 1.0\\times 10^3\\,\\mathrm{J}/\\mathrm{kg}\\cdot\\mathrm{K}$,\n  - $\\,Y_{F,\\infty} = 0.80$, $\\,Y_{O,\\infty} = 0.23$, $\\,s = 0.50$,\n  - $\\,T_{F,\\infty} = 300\\,\\mathrm{K}$, $\\,T_{O,\\infty} = 300\\,\\mathrm{K}$,\n  - $\\,\\sigma = 0.08$,\n  - $\\,\\chi_{\\min} = 1.0\\,\\mathrm{s}^{-1}$, $\\,\\chi_{\\max} = 500.0\\,\\mathrm{s}^{-1}$,\n  - $\\,T_{\\mathrm{ign}} = 1400\\,\\mathrm{K}$.\n\nAlgorithmic requirements:\n- Solve the boundary value problem for given $\\,\\chi_{st}\\,$ using a numerical boundary value problem solver appropriate for nonlinear systems.\n- For each case, implement a bisection search over $\\,\\chi_{st} \\in [\\chi_{\\min}, \\chi_{\\max}]\\,$ to estimate the critical extinction value to within a small tolerance.\n- Enforce non-negativity in $\\,Y_F\\,$ and $\\,Y_O\\,$ when evaluating $\\,\\omega\\,$.\n- Use a smooth initial guess that respects boundary conditions and places a small temperature bump near $\\,z_{st}\\,$ to aid convergence.\n\nFinal output specification:\n- Your program must produce a single line of output containing the results for the three test cases as a comma-separated list of floats enclosed in square brackets.\n- Each float must be the estimated critical $\\,\\chi_{st}\\,$ (in $\\mathrm{s}^{-1}$) for the corresponding test case, rounded to three decimals.\n- For cases where no reactive solution exists within $\\,\\chi_{st} \\in [\\chi_{\\min}, \\chi_{\\max}]\\,$, return $\\,0.000\\,$. For cases where reactive solutions persist up to $\\,\\chi_{\\max}\\,$, return $\\,\\chi_{\\max}\\,$ rounded accordingly.\n\nExample of required output format: $\\,\\left[ \\chi_{crit,1}, \\chi_{crit,2}, \\chi_{crit,3} \\right]\\,$ printed exactly as $\\,\\left[\\chi_{crit,1},\\chi_{crit,2},\\chi_{crit,3}\\right]\\,$.",
            "solution": "The solution methodology proceeds in three stages:\n1.  Mathematical simplification of the governing partial differential equations.\n2.  Formulation of a numerical boundary value problem (BVP).\n3.  Implementation of a search algorithm to find the extinction limit.\n\n**1. Mathematical Formulation and Simplification**\n\nThe provided system consists of three coupled, second-order, nonlinear ordinary differential equations for the fuel mass fraction $Y_F(z)$, oxidizer mass fraction $Y_O(z)$, and temperature $T(z)$. The system can be simplified by introducing conserved scalars (Schvab-Zeldovich variables).\n\nBy creating linear combinations of the governing equations, we can find quantities with a zero source term. Define $\\beta_1(z) = Y_O(z) - s\\,Y_F(z)$. Differentiating twice and substituting the governing equations shows $\\frac{d^2 \\beta_1}{dz^2} = 0$. Similarly, from the governing equations we can deduce that $\\frac{d^2 T}{dz^2} = \\frac{q}{c_p}\\frac{d^2 Y_F}{dz^2}$, which implies that another conserved scalar is $\\beta_2(z) = T(z) - \\frac{q}{c_p} Y_F(z)$, for which $\\frac{d^2 \\beta_2}{dz^2}=0$.\n\nSince $\\beta_1(z)$ and $\\beta_2(z)$ have zero second derivatives, they must be linear functions of $z$. By applying the boundary conditions at $z=0$ (oxidizer stream) and $z=1$ (fuel stream), we can derive explicit coupling relations:\n$$\nY_O(z) = s\\,Y_F(z) - (s\\,Y_{F,\\infty} + Y_{O,\\infty})z + Y_{O,\\infty}\n$$\n$$\nT(z) = \\frac{q}{c_p}\\,Y_F(z) + \\left( T_{F,\\infty} - T_{O,\\infty} - \\frac{q}{c_p}Y_{F,\\infty} \\right)z + T_{O,\\infty}\n$$\nWith these relations, $Y_O$ and $T$ are uniquely determined by $Y_F$ and $z$. The system reduces to a single second-order ODE for $Y_F(z)$:\n$$\n\\frac{d^2 Y_F}{dz^2} = -\\frac{2}{\\chi(z;\\chi_{st})} \\omega(T(Y_F, z), Y_F, Y_O(Y_F, z))\n$$\nwith boundary conditions $Y_F(0) = 0$ and $Y_F(1) = Y_{F,\\infty}$.\n\n**2. Numerical Boundary Value Problem Formulation**\n\nTo solve this nonlinear BVP numerically, we use a collocation-based solver, `scipy.integrate.solve_bvp`, which requires a system of first-order ODEs. We define a state vector $\\mathbf{y}(z) = [y_0(z), y_1(z)]^T = [Y_F(z), \\frac{dY_F}{dz}(z)]^T$. The second-order ODE is then converted into the following system:\n$$\n\\frac{d\\mathbf{y}}{dz} =\n\\begin{pmatrix}\ny_1 \\\\\n-\\frac{2}{\\chi(z;\\chi_{st})} \\omega(T(y_0, z), y_0, Y_O(y_0, z))\n\\end{pmatrix}\n$$\nThe boundary conditions are specified on $\\mathbf{y}$ at $z=0$ and $z=1$:\n$$\ny_0(0) = 0, \\quad y_0(1) = Y_{F,\\infty}\n$$\nThis forms a complete BVP formulation. A small regularization term $\\epsilon$ (e.g., $10^{-20}$) is added to $\\chi(z)$ in the denominator to prevent division by zero at the domain boundaries where the reaction rate $\\omega$ is also zero.\n\nA crucial element for solving such a nonlinear system is the initial guess provided to the solver. To favor convergence to the physically interesting \"ignited\" solution branch, we construct a guess that has a super-adiabatic temperature peak. First, a non-reacting temperature profile is calculated: $T_{\\text{nr}}(z) = (T_{F,\\infty} - T_{O,\\infty})z + T_{O,\\infty}$. A Gaussian bump is added to this profile near the stoichiometric mixture fraction $z_{st}$, creating $T_{\\text{guess}}(z)$. Finally, the Schvab-Zeldovich relation is used to invert this to an initial guess for $Y_F(z)$.\n\n**3. Bisection Search for Extinction Limit**\n\nThe core of the problem is to find the extinction limit, defined as the maximum value of the stoichiometric scalar dissipation rate, $\\chi_{st}$, for which a reactive solution exists. A solution is deemed \"reactive\" if its maximum temperature $\\max_z T(z)$ exceeds a given ignition threshold $T_{\\mathrm{ign}}$.\n\nWe define a boolean function, `is_reactive(chi_st)`, which solves the BVP for the given $\\chi_{st}$ and returns `True` if $\\max T(z) \\ge T_{\\mathrm{ign}}$ (and the solver converged), and `False` otherwise.\n\nA bisection search is implemented over the specified range $[\\chi_{\\min}, \\chi_{\\max}]$ to find the critical value, $\\chi_{crit}$. The algorithm proceeds as follows:\n1.  Check `is_reactive(chi_min)`. If `False`, no reactive solution exists in the range. Per the problem, the result is $0.0$.\n2.  Check `is_reactive(chi_max)`. If `True`, the flame remains stable up to the maximum search value. The result is $\\chi_{\\max}$.\n3.  If `is_reactive(chi_min)` is `True` and `is_reactive(chi_max)` is `False`, the extinction limit lies within the interval. The bisection search iteratively narrows this interval:\n    - Set `low = chi_min`, `high = chi_max`.\n    - Repeat for a fixed number of iterations (e.g., $30$ for sufficient precision):\n        - Calculate `mid = (low + high) / 2`.\n        - If `is_reactive(mid)` is `True`, the critical value is at least `mid`, so we set `low = mid`.\n        - If `is_reactive(mid)` is `False`, the flame is extinguished, so the critical value is at most `mid`. We set `high = mid`.\n4.  The final result is `low`, which represents the highest value of $\\chi_{st}$ found to sustain a reactive flame.\n\nThis procedure is applied to each of the three test cases provided to determine their respective extinction limits.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_bvp\n\ndef solve():\n    \"\"\"\n    Main function to solve the flamelet extinction problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (nominal cold streams, moderate chemistry)\n        {\n            \"A\": 4.0e6, \"E_over_R\": 1.5e4, \"q\": 3.0e6, \"cp\": 1.0e3,\n            \"YF_inf\": 0.80, \"YO_inf\": 0.23, \"s\": 0.50,\n            \"TF_inf\": 300.0, \"TO_inf\": 300.0, \"sigma\": 0.08,\n            \"chi_min\": 1.0, \"chi_max\": 500.0, \"T_ign\": 1400.0\n        },\n        # Case 2 (preheated oxidizer, robust ignition)\n        {\n            \"A\": 4.0e6, \"E_over_R\": 1.5e4, \"q\": 3.0e6, \"cp\": 1.0e3,\n            \"YF_inf\": 0.80, \"YO_inf\": 0.23, \"s\": 0.50,\n            \"TF_inf\": 300.0, \"TO_inf\": 600.0, \"sigma\": 0.08,\n            \"chi_min\": 1.0, \"chi_max\": 500.0, \"T_ign\": 1400.0\n        },\n        # Case 3 (high activation energy, weak chemistry)\n        {\n            \"A\": 1.0e6, \"E_over_R\": 2.0e4, \"q\": 2.0e6, \"cp\": 1.0e3,\n            \"YF_inf\": 0.80, \"YO_inf\": 0.23, \"s\": 0.50,\n            \"TF_inf\": 300.0, \"TO_inf\": 300.0, \"sigma\": 0.08,\n            \"chi_min\": 1.0, \"chi_max\": 500.0, \"T_ign\": 1400.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        critical_chi = find_extinction_chi_st(params)\n        results.append(f\"{critical_chi:.3f}\")\n    \n    print(f\"[{','.join(results)}]\")\n\ndef find_extinction_chi_st(params):\n    \"\"\"\n    Performs a bisection search to find the critical stoichiometric scalar dissipation rate\n    for extinction.\n    \"\"\"\n    flamelet_problem = FlameletProblem(params)\n\n    # Check boundaries of the search range first\n    if not flamelet_problem.is_reactive(params['chi_min']):\n        return 0.0\n    if flamelet_problem.is_reactive(params['chi_max']):\n        return params['chi_max']\n\n    low = params['chi_min']\n    high = params['chi_max']\n    \n    # Bisection search\n    for _ in range(30):  # 30 iterations give high precision\n        mid = (low + high) / 2.0\n        if flamelet_problem.is_reactive(mid):\n            low = mid\n        else:\n            high = mid\n            \n    return low\n\nclass FlameletProblem:\n    \"\"\"\n    Encapsulates the physics and numerical setup for a single flamelet problem.\n    \"\"\"\n    def __init__(self, params):\n        self.params = params\n        self.z_st = params['YF_inf'] / (params['YF_inf'] + params['s'] * params['YO_inf'])\n        self.C1_T = (params['TF_inf'] - params['TO_inf'] - \n                     params['q'] / params['cp'] * params['YF_inf'])\n        self.C2_T = params['TO_inf']\n        self.C1_YO = -(params['s'] * params['YF_inf'] + params['YO_inf'])\n        self.C2_YO = params['YO_inf']\n\n    def T_from_YF(self, YF, z):\n        \"\"\"Calculates temperature T from fuel mass fraction YF and position z.\"\"\"\n        return self.params['q'] / self.params['cp'] * YF + self.C1_T * z + self.C2_T\n\n    def YO_from_YF(self, YF, z):\n        \"\"\"Calculates oxidizer mass fraction YO from YF and z.\"\"\"\n        return self.params['s'] * YF + self.C1_YO * z + self.C2_YO\n\n    def reaction_rate(self, T, YF, YO):\n        \"\"\"Calculates the Arrhenius reaction rate.\"\"\"\n        # Enforce non-negativity for mass fractions\n        YF_pos = np.maximum(0.0, YF)\n        YO_pos = np.maximum(0.0, YO)\n        # Avoid overflow in exp for very low T\n        if np.any(T < 250): return 0.0 \n        return self.params['A'] * np.exp(-self.params['E_over_R'] / T) * YF_pos * YO_pos\n\n    def chi(self, z, chi_st):\n        \"\"\"Calculates the scalar dissipation rate profile.\"\"\"\n        return chi_st * np.exp(-(z - self.z_st)**2 / (2 * self.params['sigma']**2))\n\n    def ode_system(self, z, y, chi_st):\n        \"\"\"Defines the system of first-order ODEs for the BVP solver.\"\"\"\n        # y[0] = YF, y[1] = dYF/dz\n        YF = y[0]\n        \n        # Calculate T and YO from YF using Schvab-Zeldovich relations\n        T = self.T_from_YF(YF, z)\n        YO = self.YO_from_YF(YF, z)\n        \n        # Calculate reaction rate\n        omega = self.reaction_rate(T, YF, YO)\n        \n        # Calculate d2YF/dz2\n        # Add a small epsilon to chi to avoid division by zero\n        chi_val = self.chi(z, chi_st)\n        d2YF_dz2 = -2.0 * omega / (chi_val + 1e-20)\n        \n        return np.vstack((y[1], d2YF_dz2))\n\n    def bc(self, ya, yb):\n        \"\"\"Defines the boundary conditions for the BVP solver.\"\"\"\n        # ya: solution at z=0, yb: solution at z=1\n        # y[0] = YF\n        return np.array([ya[0] - 0.0, yb[0] - self.params['YF_inf']])\n\n    def make_initial_guess(self, z_mesh):\n        \"\"\"Creates a physically-informed initial guess to aid convergence.\"\"\"\n        YF_guess = np.zeros_like(z_mesh)\n        \n        # Non-reacting T profile + bump\n        T_nr = (self.params['TF_inf'] - self.params['TO_inf']) * z_mesh + self.params['TO_inf']\n        T_bump = 800.0 * np.exp(-(z_mesh - self.z_st)**2 / (2 * 0.05**2))\n        T_guess = T_nr + T_bump\n        \n        # Invert T_guess to get YF_guess via S-Z relation\n        YF_guess = (self.params['cp'] / self.params['q']) * (T_guess - (self.C1_T * z_mesh + self.C2_T))\n        \n        # The derivative can be approximated from the linear profile\n        dYF_dz_guess = np.full_like(z_mesh, self.params['YF_inf'])\n        \n        return np.vstack((YF_guess, dYF_dz_guess))\n\n    def solve_single_chi_st(self, chi_st):\n        \"\"\"Solves the flamelet BVP for a given chi_st.\"\"\"\n        z_mesh = np.linspace(0, 1, 150)\n        y_guess = self.make_initial_guess(z_mesh)\n\n        sol = solve_bvp(lambda z, y: self.ode_system(z, y, chi_st),\n                        self.bc, z_mesh, y_guess, tol=1e-4, max_nodes=2000)\n\n        if sol.success:\n            # Re-interpolate on a fine mesh to find a more accurate max temperature\n            z_fine = np.linspace(0, 1, 500)\n            YF_sol = sol.sol(z_fine)[0]\n            T_sol = self.T_from_YF(YF_sol, z_fine)\n            return np.max(T_sol)\n        else:\n            return 0.0  # Solver failure implies non-reactive\n\n    def is_reactive(self, chi_st):\n        \"\"\"Checks if a solution is reactive based on the ignition temperature.\"\"\"\n        max_T = self.solve_single_chi_st(chi_st)\n        return max_T >= self.params['T_ign']\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "In real flames, large heat release causes significant density variations, a complication that must be handled carefully in turbulent combustion modeling. This exercise highlights the critical distinction between unweighted (Reynolds) and density-weighted (Favre) averaging. By constructing a model mixing layer with variable density, you will quantify the error introduced by neglecting density effects and gain a deeper appreciation for why Favre averaging is the standard approach for quantities like the scalar dissipation rate in reacting flows.",
            "id": "4060194",
            "problem": "Consider a one-dimensional mixing layer in a constant-pressure environment with heat release, modeled on the interval $[0,L]$ where $L$ is the domain length in meters. The conserved mixture fraction field is defined by the hyperbolic tangent profile $Z(x) = \\frac{1}{2}\\left(1+\\tanh\\left(\\frac{x-x_0}{\\delta}\\right)\\right)$, where $x_0$ is the location of the flame sheet center in meters and $\\delta$ is the characteristic thickness in meters. Assume a constant molecular diffusivity $D$ in square meters per second. The instantaneous scalar dissipation rate of the mixture fraction is defined as $\\chi_Z(x) = 2 D \\left(\\frac{dZ}{dx}\\right)^2$, with units of inverse seconds. Heat release modifies the density through the ideal gas law at constant pressure $p$ and gas constant $R$, with a temperature field given by $T(x) = T_u + \\Delta T \\left(Z(x)\\right)^{\\beta}$ where $T_u$ is the unburned gas temperature in Kelvins, $\\Delta T$ is the temperature rise in Kelvins due to heat release, and $\\beta$ is a positive shape parameter. Under these assumptions, density is $\\rho(x) = \\frac{p}{R\\,T(x)}$ with units of kilograms per cubic meter.\n\nCompute the Favre-averaged scalar dissipation rate $\\tilde{\\chi_Z}$ and the non-Favre spatial average $\\bar{\\chi_Z}$ over the domain $[0,L]$. Use the definitions\n$$\n\\tilde{\\chi_Z} = \\frac{\\int_{0}^{L} \\rho(x)\\,\\chi_Z(x)\\,dx}{\\int_{0}^{L} \\rho(x)\\,dx}, \\quad\n\\bar{\\chi_Z} = \\frac{1}{L}\\int_{0}^{L} \\chi_Z(x)\\,dx.\n$$\nQuantify the error introduced by using the non-Favre average when density is nonuniform via the fractional difference\n$$\ne = \\frac{\\bar{\\chi_Z} - \\tilde{\\chi_Z}}{\\tilde{\\chi_Z}}.\n$$\nYour program must construct the prescribed fields, evaluate the integrals numerically, and return $\\tilde{\\chi_Z}$, $\\bar{\\chi_Z}$, and $e$ for each test case. The quantities $\\tilde{\\chi_Z}$ and $\\bar{\\chi_Z}$ must be expressed in inverse seconds (s$^{-1}$), and $e$ must be expressed as a decimal (unitless).\n\nUse the following physically consistent parameters for the test suite:\n$L = 1.0\\times 10^{-2}$ m, $x_0 = \\frac{L}{2}$ m, $p = 1.01325\\times 10^{5}$ Pa, $R = 287$ J/(kg$\\cdot$K), $T_u = 300$ K, $D = 1.5\\times 10^{-5}$ m$^2$/s. Vary $\\delta$, $\\Delta T$, and $\\beta$ across four cases to test different conditions:\n$1.$ Happy path: $\\delta = 2.0\\times 10^{-4}$ m, $\\Delta T = 9.0\\times 10^{2}$ K, $\\beta = 2$.\n$2.$ Boundary (uniform density): $\\delta = 2.0\\times 10^{-4}$ m, $\\Delta T = 0$ K, $\\beta = 2$.\n$3.$ Edge (strong heat release, thin layer): $\\delta = 1.5\\times 10^{-4}$ m, $\\Delta T = 1.5\\times 10^{3}$ K, $\\beta = 3$.\n$4.$ Broader layer: $\\delta = 8.0\\times 10^{-4}$ m, $\\Delta T = 1.2\\times 10^{3}$ K, $\\beta = 1$.\n\nYour program must:\n$1.$ Construct $Z(x)$ and compute $\\frac{dZ}{dx}$ exactly from the analytic derivative of the hyperbolic tangent.\n$2.$ Construct $T(x)$ and $\\rho(x)$ using the provided relations.\n$3.$ Compute $\\chi_Z(x)=2D\\left(\\frac{dZ}{dx}\\right)^2$ and then $\\tilde{\\chi_Z}$, $\\bar{\\chi_Z}$, and $e$ via numerical quadrature over $x\\in[0,L]$.\n$4.$ Use a sufficiently fine uniform grid over $[0,L]$ to ensure numerical accuracy.\n\nFinal output format specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a three-item list $[\\tilde{\\chi_Z},\\bar{\\chi_Z},e]$. The line must have no spaces and each floating-point number should be formatted to six decimal places. For example, the output should be of the form $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3],[a_4,b_4,c_4]]$, where $a_i$ and $b_i$ are in s$^{-1}$ and $c_i$ is a decimal.",
            "solution": "The problem requires the computation and comparison of the Favre-averaged and non-Favre (Reynolds-averaged) scalar dissipation rate in a one-dimensional, variable-density mixing layer. This is a canonical problem in combustion theory, where density variations due to heat release significantly impact turbulent transport and reaction rates. The difference between these two averaging methods highlights the importance of density-weighting (Favre averaging) in compressible or reacting flows.\n\nFirst, we formulate the necessary analytical expressions based on the provided definitions. The mixture fraction field, $Z(x)$, is given by a hyperbolic tangent profile, a standard model for a one-dimensional mixing layer:\n$$\nZ(x) = \\frac{1}{2}\\left(1+\\tanh\\left(\\frac{x-x_0}{\\delta}\\right)\\right)\n$$\nwhere $x \\in [0, L]$. Here, $x_0$ is the center of the mixing layer and $\\delta$ is its characteristic thickness.\n\nThe instantaneous scalar dissipation rate, $\\chi_Z(x)$, is defined as $\\chi_Z(x) = 2 D (\\nabla Z \\cdot \\nabla Z)$. In our one-dimensional case, this simplifies to:\n$$\n\\chi_Z(x) = 2 D \\left(\\frac{dZ}{dx}\\right)^2\n$$\nTo evaluate this, we first compute the analytical derivative of $Z(x)$. Using the chain rule and the identity $\\frac{d}{du}\\tanh(u) = \\text{sech}^2(u)$, we find:\n$$\n\\frac{dZ}{dx} = \\frac{1}{2} \\cdot \\text{sech}^2\\left(\\frac{x-x_0}{\\delta}\\right) \\cdot \\frac{1}{\\delta} = \\frac{1}{2\\delta} \\text{sech}^2\\left(\\frac{x-x_0}{\\delta}\\right)\n$$\nSubstituting this derivative into the expression for $\\chi_Z(x)$ yields:\n$$\n\\chi_Z(x) = 2 D \\left(\\frac{1}{2\\delta} \\text{sech}^2\\left(\\frac{x-x_0}{\\delta}\\right)\\right)^2 = \\frac{D}{2\\delta^2} \\text{sech}^4\\left(\\frac{x-x_0}{\\delta}\\right)\n$$\nThis expression shows that $\\chi_Z(x)$ is a positive definite function, sharply peaked at $x=x_0$ and decaying rapidly away from the center of the mixing layer.\n\nHeat release is modeled through a temperature field, $T(x)$, which is a function of the mixture fraction $Z(x)$:\n$$\nT(x) = T_u + \\Delta T \\left(Z(x)\\right)^{\\beta}\n$$\nHere, $T_u$ is the unburned gas temperature, $\\Delta T$ is the total temperature rise, and $\\beta$ is a shape parameter. Assuming the ideal gas law at constant pressure $p$, the density field $\\rho(x)$ is inversely proportional to temperature:\n$$\n\\rho(x) = \\frac{p}{R\\,T(x)} = \\frac{p}{R \\left(T_u + \\Delta T \\left(Z(x)\\right)^{\\beta}\\right)}\n$$\nwhere $R$ is the specific gas constant. When $\\Delta T > 0$, the temperature increases where $Z(x) > 0$, causing the density $\\rho(x)$ to decrease.\n\nThe problem requires the computation of two different spatial averages of $\\chi_Z(x)$ over the domain $[0,L]$.\nThe first is the non-Favre, or conventional spatial average (analogous to a Reynolds average), defined as:\n$$\n\\bar{\\chi_Z} = \\frac{1}{L}\\int_{0}^{L} \\chi_Z(x)\\,dx\n$$\nThe second is the Favre-averaged scalar dissipation rate, which is a density-weighted average:\n$$\n\\tilde{\\chi_Z} = \\frac{\\int_{0}^{L} \\rho(x)\\,\\chi_Z(x)\\,dx}{\\int_{0}^{L} \\rho(x)\\,dx}\n$$\nThe Favre average accounts for local density variations. If density is constant, i.e., $\\rho(x) = \\rho_0$, then $\\tilde{\\chi_Z}$ simplifies to $\\bar{\\chi_Z}$. This occurs in the special case where $\\Delta T = 0$.\n\nFinally, we quantify the error introduced by neglecting density variations by computing the fractional difference:\n$$\ne = \\frac{\\bar{\\chi_Z} - \\tilde{\\chi_Z}}{\\tilde{\\chi_Z}}\n$$\nPhysically, $\\chi_Z(x)$ is concentrated in the thin mixing layer around $x_0$. In this region, if there is heat release ($\\Delta T > 0$), the temperature is elevated and the density is lower than in the unburned regions. The density-weighting in the Favre average, $\\tilde{\\chi_Z}$, therefore de-emphasizes the contribution from this high-dissipation, low-density region compared to the unweighted average, $\\bar{\\chi_Z}$. Consequently, we expect $\\tilde{\\chi_Z} < \\bar{\\chi_Z}$ and thus a positive error $e$ whenever $\\Delta T > 0$.\n\nThe integrals required for $\\bar{\\chi_Z}$ and $\\tilde{\\chi_Z}$ do not have simple analytical solutions and must be computed numerically. The implementation strategy involves the following steps:\n$1.$ Discretize the spatial domain $[0,L]$ into a fine uniform grid of points $x_i$. A large number of points is chosen to ensure the thin mixing layer structure is well-resolved.\n$2.$ At each grid point $x_i$, evaluate the functions $Z(x_i)$, $\\frac{dZ}{dx}(x_i)$, $\\chi_Z(x_i)$, $T(x_i)$, and $\\rho(x_i)$ using the analytical formulas derived above.\n$3.$ Use numerical quadrature, such as the trapezoidal rule, to approximate the four definite integrals: $\\int \\chi_Z(x) dx$, $\\int \\rho(x) \\chi_Z(x) dx$, and $\\int \\rho(x) dx$.\n$4.$ Combine the results of the integrals according to the definitions to calculate $\\bar{\\chi_Z}$, $\\tilde{\\chi_Z}$, and $e$.\n$5.$ Repeat this procedure for each of the four test cases provided, which explore different physical regimes by varying the layer thickness $\\delta$, temperature rise $\\Delta T$, and profile shape $\\beta$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares Favre-averaged and non-Favre-averaged scalar dissipation rates\n    for a one-dimensional, variable-density mixing layer.\n    \"\"\"\n\n    # Define physical constants\n    L = 1.0e-2       # Domain length [m]\n    x0 = L / 2.0     # Flame sheet center [m]\n    p = 1.01325e5    # Pressure [Pa]\n    R = 287.0        # Gas constant for air [J/(kg.K)]\n    Tu = 300.0       # Unburned temperature [K]\n    D = 1.5e-5       # Molecular diffusivity [m^2/s]\n    N = 20001        # Number of grid points for numerical integration\n\n    # Define the four test cases\n    test_cases = [\n        # (delta, Delta_T, beta)\n        (2.0e-4, 9.0e2, 2.0),  # 1. Happy path\n        (2.0e-4, 0.0, 2.0),   # 2. Boundary (uniform density)\n        (1.5e-4, 1.5e3, 3.0),  # 3. Edge (strong heat release, thin layer)\n        (8.0e-4, 1.2e3, 1.0),  # 4. Broader layer\n    ]\n\n    # Create the spatial grid\n    x = np.linspace(0, L, N)\n\n    results = []\n    for case in test_cases:\n        delta, Delta_T, beta = case\n\n        # 1. Construct Z(x) and its analytical derivative dZ/dx\n        arg = (x - x0) / delta\n        Z_x = 0.5 * (1.0 + np.tanh(arg))\n        \n        # dZ/dx = 1/(2*delta) * sech^2((x-x0)/delta)\n        dZ_dx = (1.0 / (2.0 * delta)) * (1.0 / np.cosh(arg))**2\n\n        # 2. Compute the scalar dissipation rate chi_Z(x)\n        chi_Z_x = 2.0 * D * (dZ_dx**2)\n\n        # 3. Construct the temperature T(x) and density rho(x) fields\n        T_x = Tu + Delta_T * (Z_x**beta)\n        rho_x = p / (R * T_x)\n        \n        # 4. Compute the non-Favre average scalar dissipation rate\n        integral_chi_Z = np.trapz(chi_Z_x, x)\n        bar_chi_Z = integral_chi_Z / L\n\n        # 5. Compute the Favre-averaged scalar dissipation rate\n        # Denominator in the Favre average definition\n        integral_rho = np.trapz(rho_x, x)\n        \n        # Numerator in the Favre average definition\n        integral_rho_chi_Z = np.trapz(rho_x * chi_Z_x, x)\n\n        # Handle the case of uniform density to avoid division by zero\n        # although integral_rho will always be positive here.\n        if integral_rho > 0:\n            tilde_chi_Z = integral_rho_chi_Z / integral_rho\n        else: # Should not be reached in this problem\n            tilde_chi_Z = 0.0\n\n        # 6. Compute the fractional error\n        # Handle the case tilde_chi_Z = 0 (e.g., if D=0)\n        if abs(tilde_chi_Z) > 1e-12:\n            error = (bar_chi_Z - tilde_chi_Z) / tilde_chi_Z\n        else:\n            # If tilde_chi_Z is zero, bar_chi_Z must also be zero (for D>0).\n            # The only way they differ slightly is due to numerics in the\n            # uniform density case.\n            error = 0.0\n\n        results.append([tilde_chi_Z, bar_chi_Z, error])\n\n    # Format the final output string as specified\n    formatted_cases = []\n    for res in results:\n        tilde_chi, bar_chi, err = res\n        formatted_cases.append(f\"[{tilde_chi:.6f},{bar_chi:.6f},{err:.6f}]\")\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(formatted_cases)}]\")\n\nsolve()\n```"
        }
    ]
}