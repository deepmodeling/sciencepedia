{
    "hands_on_practices": [
        {
            "introduction": "在FDF方法中，我们使用有限数量的计算粒子来表示亚网格尺度的标量分布。这必然会引入统计采样误差，其大小直接影响模拟的精度。本练习将引导您应用中心极限定理来量化这一误差，并推导出为达到特定精度目标所需的最小粒子数，这是设置任何FDF模拟时都必须考虑的关键问题 。",
            "id": "4024881",
            "problem": "在湍流反应流的大涡模拟（LES）中，采用基于粒子的滤波密度函数（FDF）方法来估计Favre滤波标量场。Favre滤波标量定义为 $\\tilde{\\phi} = \\overline{\\rho \\phi}/\\overline{\\rho}$，其中 $\\rho$ 是密度，$\\phi$ 是一个标量（例如，混合分数），上划线表示空间滤波。在给定时间的单个LES控制体积内，您从滤波密度函数中抽取 $N$ 个独立的粒子实现 $\\{\\phi_{i}\\}_{i=1}^{N}$，每个粒子代表相等的质量，因此在估计量中具有相等的粒子权重。对于相等质量的情况，$\\tilde{\\phi}$ 的蒙特卡洛估计量简化为简单的样本均值 $\\hat{\\tilde{\\phi}} = \\frac{1}{N}\\sum_{i=1}^{N}\\phi_{i}$。\n\n假设以下科学上合理的条件：\n- 粒子样本是独立同分布的，具有有限方差，因此中心极限定理适用于 $\\hat{\\tilde{\\phi}}$。\n- 在此控制体积中，从上一步估计的亚格子标量方差为 $\\operatorname{Var}(\\phi) = 2.5 \\times 10^{-3}$（无量纲）。\n- 您需要一个置信水平为 $0.95$ 的 $\\tilde{\\phi}$ 的对称双侧置信区间，其半宽不超过 $\\Delta = 1.0 \\times 10^{-3}$（无量纲）。\n\n从Favre滤波定义和中心极限定理出发，推导 $\\hat{\\tilde{\\phi}}$ 的统计误差如何随 $N$ 变化，并构建相应的正态近似置信区间。然后，确定最小整数 $N$，使得在置信水平 $0.95$ 时，该区间的半宽至多为 $\\Delta$。将您的最终答案表示为单个整数 $N$。",
            "solution": "该问题要求确定蒙特卡洛估计Favre滤波标量 $\\tilde{\\phi}$ 所需的最小粒子数 $N$，以达到指定的统计精度。我们首先验证问题陈述。\n\n### 步骤1：提取已知条件\n-   Favre滤波标量定义：$\\tilde{\\phi} = \\overline{\\rho \\phi}/\\overline{\\rho}$。\n-   $\\tilde{\\phi}$ 的蒙特卡洛估计量：$\\hat{\\tilde{\\phi}} = \\frac{1}{N}\\sum_{i=1}^{N}\\phi_{i}$，其中 $\\{\\phi_{i}\\}_{i=1}^{N}$ 是独立同分布（i.i.d.）样本。\n-   中心极限定理（CLT）适用于 $\\hat{\\tilde{\\phi}}$。\n-   亚格子标量方差：$\\operatorname{Var}(\\phi) = 2.5 \\times 10^{-3}$。\n-   对称双侧区间的置信水平：$0.95$。\n-   置信区间的最大允许半宽：$\\Delta = 1.0 \\times 10^{-3}$。\n\n### 步骤2：使用已知条件进行验证\n该问题在科学上基于大涡模拟（LES）和滤波密度函数（FDF）方法的理论，这是计算燃烧学中的一种标准方法。蒙特卡洛估计量的使用和中心极限定理的应用是在此背景下正确应用的基本统计学原理。该问题是适定的，提供了所有必要信息——基础分布的方差、期望的置信水平和要求的精度——以唯一确定样本大小 $N$。其语言客观且无歧义。因此，该问题被认为是有效的。\n\n### 步骤3：推导与求解\nFavre滤波标量 $\\tilde{\\phi}$ 的蒙特卡洛估计量由 $N$ 个独立同分布的粒子实现 $\\{\\phi_i\\}$ 的样本均值给出：\n$$ \\hat{\\tilde{\\phi}} = \\frac{1}{N}\\sum_{i=1}^{N}\\phi_{i} $$\n样本 $\\phi_i$ 从一个分布中抽取，该分布的均值为真实的Favre滤波标量 $E[\\phi_i] = \\tilde{\\phi}$，方差为亚格子标量方差 $\\sigma^2 = \\operatorname{Var}(\\phi)$。\n\n该估计量的期望值为：\n$$ E[\\hat{\\tilde{\\phi}}] = E\\left[\\frac{1}{N}\\sum_{i=1}^{N}\\phi_{i}\\right] = \\frac{1}{N}\\sum_{i=1}^{N}E[\\phi_{i}] = \\frac{1}{N}(N\\tilde{\\phi}) = \\tilde{\\phi} $$\n这证实了该估计量是无偏的。\n\n由于样本的独立性，该估计量的方差为：\n$$ \\operatorname{Var}(\\hat{\\tilde{\\phi}}) = \\operatorname{Var}\\left(\\frac{1}{N}\\sum_{i=1}^{N}\\phi_{i}\\right) = \\frac{1}{N^2}\\sum_{i=1}^{N}\\operatorname{Var}(\\phi_{i}) = \\frac{1}{N^2}(N\\sigma^2) = \\frac{\\sigma^2}{N} $$\n该估计量的标准差，即标准误，为 $\\sigma_{\\hat{\\tilde{\\phi}}} = \\frac{\\sigma}{\\sqrt{N}}$。这表明估计量的统计误差与 $N^{-1/2}$ 成比例。\n\n根据中心极限定理，对于足够大的 $N$，样本均值 $\\hat{\\tilde{\\phi}}$ 的分布近似为均值为 $\\tilde{\\phi}$、方差为 $\\frac{\\sigma^2}{N}$ 的正态分布：\n$$ \\hat{\\tilde{\\phi}} \\sim \\mathcal{N}\\left(\\tilde{\\phi}, \\frac{\\sigma^2}{N}\\right) $$\n为构建置信区间，我们对估计量进行标准化以获得标准正态变量 $Z$：\n$$ Z = \\frac{\\hat{\\tilde{\\phi}} - \\tilde{\\phi}}{\\sigma/\\sqrt{N}} \\sim \\mathcal{N}(0, 1) $$\n我们寻求一个置信水平为 $1-\\alpha = 0.95$ 的 $\\tilde{\\phi}$ 的对称双侧置信区间。这意味着显著性水平为 $\\alpha = 0.05$。该区间定义为：\n$$ P(-z_{\\alpha/2} \\le Z \\le z_{\\alpha/2}) = 1 - \\alpha $$\n其中 $z_{\\alpha/2}$ 是标准正态分布的临界值，其尾部概率为 $\\alpha/2$。在我们的例子中，$\\alpha/2 = 0.025$。对应的临界值是 $z_{0.025}$，它对应于 $1 - 0.025 = 0.975$ 的累积概率。该值为 $z_{0.025} \\approx 1.96$。\n\n代入 $Z$ 的表达式并重排不等式以分离出 $\\tilde{\\phi}$：\n$$ P\\left(\\hat{\\tilde{\\phi}} - z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\le \\tilde{\\phi} \\le \\hat{\\tilde{\\phi}} + z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{N}}\\right) = 1 - \\alpha $$\n该置信区间的半宽是在估计值 $\\hat{\\tilde{\\phi}}$ 上加减的量：\n$$ \\text{Half-width} = z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} $$\n问题要求该半宽至多为 $\\Delta = 1.0 \\times 10^{-3}$：\n$$ z_{\\alpha/2} \\frac{\\sigma}{\\sqrt{N}} \\le \\Delta $$\n我们现在可以解此不等式以求得最小整数 $N$。已知条件如下：\n-   $\\operatorname{Var}(\\phi) = \\sigma^2 = 2.5 \\times 10^{-3}$\n-   $\\Delta = 1.0 \\times 10^{-3}$\n-   $z_{0.025} \\approx 1.96$\n\n首先，我们求标准差 $\\sigma$：\n$$ \\sigma = \\sqrt{\\sigma^2} = \\sqrt{2.5 \\times 10^{-3}} = \\sqrt{25 \\times 10^{-4}} = 5 \\times 10^{-2} = 0.05 $$\n将已知值代入不等式：\n$$ 1.96 \\times \\frac{0.05}{\\sqrt{N}} \\le 1.0 \\times 10^{-3} $$\n重新整理以求解 $\\sqrt{N}$：\n$$ \\sqrt{N} \\ge \\frac{1.96 \\times 0.05}{1.0 \\times 10^{-3}} $$\n$$ \\sqrt{N} \\ge \\frac{0.098}{10^{-3}} $$\n$$ \\sqrt{N} \\ge 98 $$\n两边平方以求得关于 $N$ 的条件：\n$$ N \\ge 98^2 $$\n$$ N \\ge 9604 $$\n由于 $N$ 必须是整数，因此所需的最小粒子数为 $9604$。",
            "answer": "$$\\boxed{9604}$$"
        },
        {
            "introduction": "理解了粒子的统计表示后，我们需模拟粒子属性因混合而发生的演化，这便是微观混合模型的用途。本练习将从经典的“与平均值交换”（IEM）模型入手，揭示其在数值离散化后可能产生非物理标量值的问题 。您将通过分析，推导出导致这种“可实现性”违背的条件，并学习如何通过一种称为“裁剪”的实用技术来强制保证物理边界。",
            "id": "4024972",
            "problem": "您的任务是构建并分析一个数学上严谨的测试，以证明在大涡模拟 (LES) 的过滤密度函数 (FDF) 方法中使用的与平均值交换相互作用 (IEM) 微混合模型可能违反有界标量的可实现性，然后展示如何通过带截断的修正 IEM 更新来强制实现有界性。我们关注的标量，记为 $\\,\\xi\\,$，在物理上被限制在区间 $\\,\\xi\\in[0,1]\\,$ 内（例如，混合分数或归一化进程变量）。分析和计算必须纯粹以数学术语进行，并且必须易于理解和在软件中实现。所有物理参数在适用时必须以秒为单位给出。\n\n从以下基础开始：\n\n- 大涡模拟 (LES) 过滤密度函数 (FDF) 框架通过一个拉格朗日粒子系综来表示标量的亚格子统计，这些粒子的状态在组分空间中对过滤密度函数进行采样。\n- 对于被动有界标量 $\\,\\xi\\,$，与平均值交换相互作用 (IEM) 微混合模型规定了每个拉格朗日样本的连续时间演化为\n$$\n\\frac{d\\xi}{dt}=-\\frac{\\xi-\\tilde{\\xi}}{\\tau_{\\text{mix}}},\n$$\n其中 $\\,\\tilde{\\xi}\\,$ 是 $\\,\\xi\\,$ 的过滤（条件）平均值，$\\,\\tau_{\\text{mix}}\\,$ 是以秒为单位的微混合时间尺度。\n\n您的任务：\n\n1) 推导应用于单个前向欧拉步、时间增量为 $\\,\\Delta t\\,$（单位为秒）的 IEM 模型的显式一阶时间离散更新。使用 $\\,\\alpha=\\Delta t/\\tau_{\\text{mix}}\\,$ 来表示该更新，并确定在该条件下，此离散更新保持为当前样本值和过滤平均值的凸组合，从而对于所有初始在 $\\, [0,1]\\,$ 内的样本和 $\\,\\tilde{\\xi}\\in[0,1]\\,$，都满足可实现性 $\\,\\xi\\in[0,1]\\,$。\n\n2) 仅使用逻辑和代数，假设初始粒子系综的 $\\,\\xi\\,$ 在 $\\, [0,1]\\,$ 上均匀分布，并且过滤平均值 $\\,\\tilde{\\xi}=m\\in[0,1]\\,$ 在时间步长内是恒定的，推导当 $\\,\\alpha>1\\,$ 时，经过一次显式欧拉 IEM 更新后，位于 $\\, [0,1]\\,$ 外部的样本分数的闭式表达式。您的表达式必须分别计算低于 $\\,0\\,$ 和高于 $\\,1\\,$ 的样本测度，然后将它们组合以产生总分数。在此推导中，不得使用数值积分或随机抽样。\n\n3) 定义一个修正的 IEM 更新，其中欧拉更新后的任何样本值都被截断到允许区间 $\\, [0,1]\\,$ 内，即替换为 $\\,\\max(0,\\min(1,\\xi^{\\text{new}}))\\,$. 解释为什么在此修正下，对于任何 $\\,\\alpha>0\\,$ 和 $\\,m\\in[0,1]\\,$，即使未修正的显式欧拉更新在 $\\,\\alpha>1\\,$ 时可能违反可实现性，可实现性也得到了强制执行。\n\n4) 实现一个程序，对于下面指定的每个测试用例，计算并输出两个量：\n   - 经过一次未修正的显式欧拉 IEM 步骤后，违反 $\\, [0,1]\\,$ 的样本的解析推导分数（以小数表示）。\n   - 经过一次带截断的修正 IEM 步骤后，违反 $\\, [0,1]\\,$ 的样本分数（以小数表示）。\n\n在所有情况下，使用以秒为单位的 $\\,\\tau_{\\text{mix}}\\,$ 和 $\\,\\Delta t\\,$，并将最终分数表示为小数。\n\n测试套件（每个用例提供 $\\,(\\tau_{\\text{mix}},\\Delta t,m)\\,$）：\n- 用例 1 (正常情况): $\\,\\tau_{\\text{mix}}=0.1\\,$ s, $\\,\\Delta t=0.01\\,$ s, $\\,m=0.5\\,$.\n- 用例 2 (边界条件): $\\,\\tau_{\\text{mix}}=0.02\\,$ s, $\\,\\Delta t=0.02\\,$ s, $\\,m=0.2\\,$.\n- 用例 3 (下限违规): $\\,\\tau_{\\text{mix}}=0.1\\,$ s, $\\,\\Delta t=0.2\\,$ s, $\\,m=0.3\\,$.\n- 用例 4 (上限违规): $\\,\\tau_{\\text{mix}}=0.05\\,$ s, $\\,\\Delta t=0.1\\,$ s, $\\,m=0.8\\,$.\n- 用例 5 (双边违规): $\\,\\tau_{\\text{mix}}=0.1\\,$ s, $\\,\\Delta t=0.3\\,$ s, $\\,m=0.5\\,$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。该列表必须按顺序包含每个案例的两个分数 $\\,[\\text{未修正},\\text{修正}]\\,$，并将五个案例展平为\n$$\n[\\text{C1 未修正},\\text{C1 修正},\\text{C2 未修正},\\text{C2 修正},\\text{C3 未修正},\\text{C3 修正},\\text{C4 未修正},\\text{C4 修正},\\text{C5 未修正},\\text{C5 修正}].\n$$\n所有数值输出必须是小数。不应打印其他任何文本。",
            "solution": "本分析探讨了当与显式一阶欧拉格式结合使用时，与平均值交换相互作用 (IEM) 微混合模型的可实现性问题。标量 $\\xi$ 被限制在区间 $[$0$,$1$]$ 内。拉格朗日样本 $\\xi$ 的连续演化由以下常微分方程给出：\n$$\n\\frac{d\\xi}{dt}=-\\frac{\\xi-\\tilde{\\xi}}{\\tau_{\\text{mix}}}\n$$\n其中 $\\tilde{\\xi}$ 是过滤平均值，$\\tau_{\\text{mix}}$ 是微混合时间尺度。\n\n### 1. 离散化与可实现性条件\n\n为了离散化 IEM 方程，我们在一个时间步长 $\\Delta t$ 上应用前向欧拉格式。令 $\\xi^n$ 为标量在时间 $t_n$ 的值，$\\xi^{n+1}$ 为在时间 $t_{n+1} = t_n + \\Delta t$ 的值。时间导数近似为 $\\frac{d\\xi}{dt} \\approx \\frac{\\xi^{n+1} - \\xi^n}{\\Delta t}$。将此代入 IEM 方程得到：\n$$\n\\frac{\\xi^{n+1} - \\xi^n}{\\Delta t} = -\\frac{\\xi^n - \\tilde{\\xi}}{\\tau_{\\text{mix}}}\n$$\n求解 $\\xi^{n+1}$，我们得到显式一阶更新法则：\n$$\n\\xi^{n+1} = \\xi^n - \\frac{\\Delta t}{\\tau_{\\text{mix}}}(\\xi^n - \\tilde{\\xi})\n$$\n我们定义无量纲时间步长参数 $\\alpha = \\frac{\\Delta t}{\\tau_{\\text{mix}}}$。更新法则可以写成：\n$$\n\\xi^{n+1} = \\xi^n - \\alpha(\\xi^n - \\tilde{\\xi})\n$$\n重新整理各项，将 $\\xi^{n+1}$ 表示为 $\\xi^n$ 和 $\\tilde{\\xi}$ 的线性组合：\n$$\n\\xi^{n+1} = (1-\\alpha)\\xi^n + \\alpha\\tilde{\\xi}\n$$\n如果系数 $(1-\\alpha)$ 和 $\\alpha$ 是非负的且它们的和为 $1$，则此更新表示一个凸组合。它们的和是 $(1-\\alpha) + \\alpha = 1$。非负条件是 $\\alpha \\ge 0$ 和 $1-\\alpha \\ge 0$。由于 $\\Delta t$ 和 $\\tau_{\\text{mix}}$ 都是正的物理量，$\\alpha \\ge 0$ 总是满足的。凸组合的剩余条件是：\n$$\n1-\\alpha \\ge 0 \\implies \\alpha \\le 1\n$$\n如果这个条件成立，即 $\\Delta t \\le \\tau_{\\text{mix}}$，并且如果当前样本值 $\\xi^n$ 和过滤平均值 $\\tilde{\\xi}$ 都在可实现区间 $[$0$,$1$]$ 内，那么新的样本值 $\\xi^{n+1}$ 也保证在 $[$0$,$1$]$ 内。这是凸组合的一个基本属性：它们将一个凸集（如区间 $[$0$,$1$]$）映射到其自身。因此，条件 $\\alpha \\le 1$ 足以确保离散更新满足可实现性。\n\n### 2. 非可实现样本的解析分数\n\n我们现在推导当 $\\alpha > 1$ 时违反界限 $[$0$,$1$]$ 的样本分数。我们假设初始粒子系综的标量值 $\\xi_0$ 在 $[$0$,$1$]$ 上均匀分布。其概率密度函数为 $p(\\xi_0) = 1$ 对 $\\xi_0 \\in [0,1]$，否则 $p(\\xi_0) = 0$。过滤平均值是常数，$\\tilde{\\xi} = m \\in [0,1]$。\n更新后的值为 $\\xi_1 = (1-\\alpha)\\xi_0 + \\alpha m$。由于 $\\alpha > 1$，系数 $(1-\\alpha)$ 是负的。\n\n如果 $\\xi_1  0$ 或 $\\xi_1 > 1$，样本就变得不可实现。\n违反界限的样本分数是使得 $\\xi_1 \\notin [0,1]$ 的 $\\xi_0 \\in [0,1]$ 集合的测度。\n\n**低于 $0$ 的违规**：\n条件是 $\\xi_1  0$，这转化为：\n$$\n(1-\\alpha)\\xi_0 + \\alpha m  0 \\implies (1-\\alpha)\\xi_0  -\\alpha m\n$$\n由于 $(1-\\alpha)$ 是负数，除以它会反转不等式：\n$$\n\\xi_0 > \\frac{-\\alpha m}{1-\\alpha} = \\frac{\\alpha m}{\\alpha-1}\n$$\n初始范围 $[$0$,$1$]$ 中导致此违规的 $\\xi_0$ 值位于区间 $(\\frac{\\alpha m}{\\alpha-1}, 1]$。这类样本的分数（即此区间的长度，因为 $p(\\xi_0)=1$），仅在 $\\frac{\\alpha m}{\\alpha-1}  1$ 时非零。这个分数 $F_{0}$ 是：\n$$\nF_{0} = \\max\\left(0, 1 - \\frac{\\alpha m}{\\alpha-1}\\right)\n$$\n\n**高于 $1$ 的违规**：\n条件是 $\\xi_1 > 1$，这转化为：\n$$\n(1-\\alpha)\\xi_0 + \\alpha m > 1 \\implies (1-\\alpha)\\xi_0 > 1 - \\alpha m\n$$\n再次，除以负数 $(1-\\alpha)$ 反转不等式：\n$$\n\\xi_0  \\frac{1-\\alpha m}{1-\\alpha} = \\frac{\\alpha m-1}{\\alpha-1}\n$$\n在 $[$0$,$1$]$ 中导致此违规的 $\\xi_0$ 值位于区间 $[0, \\frac{\\alpha m-1}{\\alpha-1})$。这类样本的分数 $F_{>1}$，仅在 $\\frac{\\alpha m-1}{\\alpha-1} > 0$ 时非零。这个分数是：\n$$\nF_{>1} = \\max\\left(0, \\frac{\\alpha m-1}{\\alpha-1}\\right)\n$$\n\n关于 $\\xi_0$ 的这两个条件是互斥的，因为 $\\frac{\\alpha m}{\\alpha-1} > \\frac{\\alpha m-1}{\\alpha-1}$。因此，非可实现样本的总分数 $F_{\\text{total}}$ 是这两种情况分数的和：\n$$\nF_{\\text{total}}(\\alpha, m) = \\begin{cases} 0  \\text{if } \\alpha \\le 1 \\\\ \\max\\left(0, 1 - \\frac{\\alpha m}{\\alpha-1}\\right) + \\max\\left(0, \\frac{\\alpha m - 1}{\\alpha-1}\\right)  \\text{if } \\alpha  1 \\end{cases}\n$$\n\n### 3. 带截断的修正IEM更新\n\n为了无论 $\\alpha$ 的值如何都强制实现可实现性，可以通过应用截断操作来修改 IEM 更新。在使用显式欧拉步骤计算出新值 $\\xi^{\\text{new}} = (1-\\alpha)\\xi^n + \\alpha \\tilde{\\xi}$ 后，将其强制其回到允许区间 $[$0$,$1$]$。修正后的更新是：\n$$\n\\xi^{\\text{new}}_{\\text{clipped}} = \\max(0, \\min(1, \\xi^{\\text{new}}))\n$$\n此操作分两步进行：\n1. 内部函数 $\\min(1, \\xi^{\\text{new}})$ 确保任何大于 $1$ 的值都被替换为 $1$。此步骤的结果总是小于或等于 $1$。\n2. 外部函数 $\\max(0, \\dots)$ 确保任何小于 $0$ 的值都被替换为 $0$。此步骤的结果总是大于或等于 $0$。\n\n综合起来，截断函数将任何实数 $\\xi^{\\text{new}}$ 映射到区间 $[$0$,$1$]$。因此，对于任何正的 $\\alpha$ 以及任何初始的 $\\xi^n \\in [0,1]$ 和 $\\tilde{\\xi}=m \\in [0,1]$，得到的标量值 $\\xi^{\\text{new}}_{\\text{clipped}}$ 都保证是可实现的。经过此修正步骤后，违反可实现性的样本分数，根据定义，总是 $0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_violation_fractions(tau_mix: float, delta_t: float, m: float) -> tuple[float, float]:\n    \"\"\"\n    Calculates the fraction of samples violating realizability for IEM model.\n\n    Args:\n        tau_mix: The micromixing time scale in seconds.\n        delta_t: The time step size in seconds.\n        m: The constant filtered mean, m = tilde{xi}.\n\n    Returns:\n        A tuple containing:\n        - The analytically derived fraction for the unmodified explicit Euler update.\n        - The fraction for the modified update with clipping.\n    \"\"\"\n    if tau_mix == 0:\n        # Avoid division by zero, though problem constraints imply tau_mix > 0.\n        return 0.0, 0.0\n\n    alpha = delta_t / tau_mix\n    unmodified_fraction = 0.0\n\n    # The unmodified Euler step violates realizability only if alpha > 1.\n    if alpha > 1.0:\n        # Denominator for the violation expressions\n        denom = alpha - 1.0\n\n        # Fraction of samples that fall below 0\n        # This corresponds to initial xi_0 > (alpha * m) / (alpha - 1)\n        # The fraction is max(0, 1 - (alpha * m) / (alpha - 1))\n        frac_below_zero = np.maximum(0.0, 1.0 - (alpha * m) / denom)\n\n        # Fraction of samples that fall above 1\n        # This corresponds to initial xi_0  (alpha * m - 1) / (alpha - 1)\n        # The fraction is max(0, (alpha * m - 1.0) / (alpha - 1))\n        frac_above_one = np.maximum(0.0, (alpha * m - 1.0) / denom)\n\n        # The two violation regions for initial xi_0 are disjoint,\n        # so the total fraction is their sum.\n        unmodified_fraction = frac_below_zero + frac_above_one\n\n    # The modified IEM update with clipping enforces realizability by construction.\n    # Therefore, the fraction of samples violating the bounds is always 0.\n    modified_fraction = 0.0\n\n    return unmodified_fraction, modified_fraction\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite and prints the results.\n    \"\"\"\n    # Test suite from the problem statement: (tau_mix, delta_t, m)\n    test_cases = [\n        (0.1, 0.01, 0.5),   # Case 1 (happy path, alpha  1)\n        (0.02, 0.02, 0.2),   # Case 2 (boundary condition, alpha = 1)\n        (0.1, 0.2, 0.3),    # Case 3 (lower-bound violation, alpha > 1)\n        (0.05, 0.1, 0.8),   # Case 4 (upper-bound violation, alpha > 1)\n        (0.1, 0.3, 0.5),    # Case 5 (both-side violation, alpha > 1)\n    ]\n\n    results = []\n    for case in test_cases:\n        tau_mix, delta_t, m = case\n        unmod_frac, mod_frac = calculate_violation_fractions(tau_mix, delta_t, m)\n        results.append(unmod_frac)\n        results.append(mod_frac)\n\n    # Format the output as a single comma-separated list in brackets.\n    # Expected output: [0.0,0.0,0.0,0.0,0.4,0.0,0.6,0.0,0.5,0.0]\n    output_str = f\"[{','.join(map(str, np.round(results, 8)))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "为了更真实地捕捉湍流混合的随机特性，高级微观混合模型通常采用随机微分方程（SDEs）来描述。本练习将带您处理一个典型的SDE混合模型，并使用欧拉-丸山格式对其进行数值积分 。您的核心任务是推导保证该数值格式“均方稳定”所需的时间步长限制，这是确保FDF模拟稳健运行的一项关键技能。",
            "id": "4024999",
            "problem": "考虑一个用于计算燃烧学中湍流反应流大涡模拟（LES）的滤波密度函数（FDF）方法中的微混合模型。设无量纲标量表示为 $\\xi(t)$，其大涡滤波平均值为 $\\tilde{\\xi}$。该微混合过程被建模为一个具有线性松弛和加性噪声的 Itô 随机微分方程（SDE），\n$$\nd\\xi(t) = -\\frac{\\xi(t)-\\tilde{\\xi}}{\\tau}\\,dt + \\sqrt{2D}\\,dW(t),\n$$\n其中 $\\tau$ 是以秒（$\\mathrm{s}$）为单位的松弛时间，$D$ 是一个单位为 $\\mathrm{s}^{-1}$ 的非负系数，确保 $\\sqrt{2D}$ 的单位为 $\\mathrm{s}^{-1/2}$，从而使得 $\\sqrt{2D}\\,dW(t)$ 无量纲，而 $W(t)$ 是一个标准维纳过程。假设在所关注的时间步长内，$\\tilde{\\xi}$、$\\tau$ 和 $D$ 不随时间变化，并视 $\\xi(0)$ 为给定值。\n\n任务：\n- 对此 SDE 实现 Euler–Maruyama 时间离散化，以将 $\\xi$ 向前推进一个大小为 $\\Delta t$ 的步长，\n- 从第一性原理出发，推导在常系数条件下，保证该具有加性噪声的线性松弛数值格式均方稳定性的时间步长限制。\n\n本问题中均方稳定性的定义：在固定 $\\Delta t$ 下重复应用数值更新时，当 $n\\to\\infty$ 时，与 $\\tilde{\\xi}$ 的偏差的二阶矩，即 $\\mathbb{E}\\big[(\\xi_n-\\tilde{\\xi})^2\\big]$，保持有界。\n\n物理单位要求：所有时间都必须以秒（$\\mathrm{s}$）为单位处理。您必须确定对 $\\Delta t$（以秒为单位）的限制，并表示为包含 $\\tau$ 的不等式。\n\n您将实现一个程序，对于下面的每个测试用例，该程序既执行一次 Euler–Maruyama 更新（以演示离散化），又检查时间步长 $\\Delta t$ 是否满足所推导的均方稳定性条件。您的程序的最终输出应该是一行包含逗号分隔的 Python 布尔值列表，按指定顺序指示每个测试用例的稳定性。输出格式必须与以下形式完全一致：\n$$\n[\\text{result}_1,\\text{result}_2,\\dots,\\text{result}_N],\n$$\n其中每个 $\\text{result}_i$ 为 $\\text{True}$ 或 $\\text{False}$。\n\n测试套件（所有时间单位为秒）：\n- 用例 1：$\\tau = 0.01$, $\\Delta t = 0.005$, $D = 50$, $\\xi_0 = 0.8$, $\\tilde{\\xi} = 0.6$。\n- 用例 2：$\\tau = 0.01$, $\\Delta t = 0.02$, $D = 50$, $\\xi_0 = 0.8$, $\\tilde{\\xi} = 0.6$。\n- 用例 3：$\\tau = 0.01$, $\\Delta t = 0.0199$, $D = 50$, $\\xi_0 = 0.8$, $\\tilde{\\xi} = 0.6$。\n- 用例 4：$\\tau = 0.1$, $\\Delta t = 0.0001$, $D = 0$, $\\xi_0 = 0.3$, $\\tilde{\\xi} = 0.25$。\n- 用例 5：$\\tau = 0.001$, $\\Delta t = 0.0021$, $D = 1000$, $\\xi_0 = 0.1$, $\\tilde{\\xi} = 0.0$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[\\text{True},\\text{False},\\dots]$）。",
            "solution": "该问题要求推导一个用于模拟微混合过程的随机微分方程（SDE）的 Euler-Maruyama 离散化的均方稳定性条件。无量纲标量 $\\xi(t)$ 的 SDE 由下式给出：\n$$\nd\\xi(t) = -\\frac{\\xi(t)-\\tilde{\\xi}}{\\tau}\\,dt + \\sqrt{2D}\\,dW(t)\n$$\n其中 $\\tilde{\\xi}$、$\\tau$ 和 $D$ 是常数，$W(t)$ 是一个标准维纳过程。\n\n推导从第一性原理出发，过程如下。\n\n首先，我们通过考虑标量与其滤波平均值之间的偏差 $\\phi(t) = \\xi(t) - \\tilde{\\xi}$ 来简化分析。由于 $\\tilde{\\xi}$ 是常数，其微分为零，$d\\tilde{\\xi} = 0$。因此，$d\\phi(t) = d\\xi(t)$。将 $\\xi(t) = \\phi(t) + \\tilde{\\xi}$ 代入 SDE，得到关于偏差 $\\phi(t)$ 的方程：\n$$\nd\\phi(t) = -\\frac{\\phi(t)}{\\tau}\\,dt + \\sqrt{2D}\\,dW(t)\n$$\n这是一个标准的 Ornstein-Uhlenbeck 过程。原始过程 $\\xi(t)$ 的稳定性等价于此过程 $\\phi(t)$ 的稳定性，因为它们仅相差一个常数偏移。\n\nEuler-Maruyama 方法用于在时间上对此 SDE 进行离散化。对于时间步长 $\\Delta t$，在时间 $t_n = n\\Delta t$ 的数值解 $\\phi_n \\approx \\phi(t_n)$ 通过以下规则推进到 $t_{n+1}$：\n$$\n\\phi_{n+1} = \\phi_n + \\left(-\\frac{\\phi_n}{\\tau}\\right)\\Delta t + \\sqrt{2D}\\,\\Delta W_n\n$$\n其中 $\\Delta W_n = W(t_{n+1}) - W(t_n)$ 是维纳过程的一个增量。这些增量是独立同分布的随机变量，服从正态分布，其均值为 $\\mathbb{E}[\\Delta W_n] = 0$，方差为 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$。\n\n重新整理离散化方程，我们得到 $\\phi_n$ 的一个递推关系：\n$$\n\\phi_{n+1} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)\\phi_n + \\sqrt{2D}\\,\\Delta W_n\n$$\n问题将均方稳定性定义为偏差的二阶矩 $M_n = \\mathbb{E}[(\\xi_n-\\tilde{\\xi})^2] = \\mathbb{E}[\\phi_n^2]$ 在步数 $n \\to \\infty$ 时保持有界的条件。我们通过将 $\\phi_{n+1}$ 的方程平方并取期望来推导 $M_n$ 的递推关系：\n$$\n\\phi_{n+1}^2 = \\left[ \\left(1 - \\frac{\\Delta t}{\\tau}\\right)\\phi_n + \\sqrt{2D}\\,\\Delta W_n \\right]^2 = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2\\phi_n^2 + 2\\left(1 - \\frac{\\Delta t}{\\tau}\\right)\\phi_n\\sqrt{2D}\\,\\Delta W_n + 2D(\\Delta W_n)^2\n$$\n对两边取期望，我们得到：\n$$\n\\mathbb{E}[\\phi_{n+1}^2] = \\mathbb{E}\\left[ \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2\\phi_n^2 \\right] + \\mathbb{E}\\left[ 2\\left(1 - \\frac{\\Delta t}{\\tau}\\right)\\phi_n\\sqrt{2D}\\,\\Delta W_n \\right] + \\mathbb{E}\\left[ 2D(\\Delta W_n)^2 \\right]\n$$\n根据期望的线性性质，并注意到项 $(1 - \\Delta t/\\tau)^2$ 是确定性的：\n$$\nM_{n+1} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2 M_n + 2\\left(1 - \\frac{\\Delta t}{\\tau}\\right)\\sqrt{2D}\\,\\mathbb{E}[\\phi_n\\Delta W_n] + 2D\\,\\mathbb{E}[(\\Delta W_n)^2]\n$$\n在第 $n$ 步，值 $\\phi_n$ 由截至 $\\Delta W_{n-1}$ 的维纳增量历史所确定，使其与未来的增量 $\\Delta W_n$ 独立。因此，它们乘积的期望可以分离：$\\mathbb{E}[\\phi_n\\Delta W_n] = \\mathbb{E}[\\phi_n]\\mathbb{E}[\\Delta W_n] = \\mathbb{E}[\\phi_n] \\cdot 0 = 0$。\n将此结果和 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$ 代入，二阶矩的递推关系简化为：\n$$\nM_{n+1} = \\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2 M_n + 2D\\Delta t\n$$\n这是一个形如 $M_{n+1} = A M_n + B$ 的线性递推关系，其中放大因子为 $A = (1 - \\Delta t/\\tau)^2$，加性项为 $B = 2D\\Delta t$。序列 $M_n$ 在 $n \\to \\infty$ 时的有界性取决于 $A$ 和 $B$ 的值。鉴于 $\\tau  0$ 和 $\\Delta t  0$，$A$ 是一个非负实数。系数 $D$ 是非负的，所以 $B \\ge 0$。\n\n我们必须根据 $D$ 的值考虑两种情况：\n情况 1：$D  0$。在这种情况下，加性项 $B = 2D\\Delta t$ 严格为正。该递推关系的解为 $M_n = A^n M_0 + B \\sum_{k=0}^{n-1} A^k$。为使 $M_n$ 在 $n \\to \\infty$ 时保持有界，放大因子 $A$ 必须严格小于 1。如果 $A=1$，和将随 $n$ 线性增长，导致 $M_n$ 无界。如果 $A1$，$M_n$ 将指数增长。因此，我们要求 $A  1$。\n$$\n\\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2  1 \\implies \\left|1 - \\frac{\\Delta t}{\\tau}\\right|  1\n$$\n这个不等式展开为：\n$$\n-1  1 - \\frac{\\Delta t}{\\tau}  1\n$$\n右侧不等式 $1 - \\Delta t/\\tau  1$ 意味着 $-\\Delta t/\\tau  0$，对于正的 $\\Delta t$ 和 $\\tau$ 这总是成立的。左侧不等式是：\n$$\n-1  1 - \\frac{\\Delta t}{\\tau} \\implies \\frac{\\Delta t}{\\tau}  2 \\implies \\Delta t  2\\tau\n$$\n因此，对于 $D  0$，均方稳定性条件是 $\\Delta t  2\\tau$。\n\n情况 2：$D = 0$。在这种情况下，SDE 变为一个确定性常微分方程（ODE）。加性项 $B = 0$，二阶矩的递推关系为 $M_{n+1} = A M_n$。该序列保持有界的充要条件是 $A \\le 1$。\n$$\n\\left(1 - \\frac{\\Delta t}{\\tau}\\right)^2 \\le 1 \\implies \\left|1 - \\frac{\\Delta t}{\\tau}\\right| \\le 1\n$$\n这个不等式展开为：\n$$\n-1 \\le 1 - \\frac{\\Delta t}{\\tau} \\le 1\n$$\n这得到 $0 \\le \\Delta t/\\tau \\le 2$，可简化为 $\\Delta t \\le 2\\tau$。\n\n总之，应用于给定 SDE 的 Euler-Maruyama 格式的均方稳定性条件是：\n- 若 $D  0$：$\\Delta t  2\\tau$\n- 若 $D = 0$：$\\Delta t \\le 2\\tau$\n\n这个完整的条件将被实现，用以评估每个测试用例的稳定性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates the mean-square stability of the Euler-Maruyama scheme for a\n    given micromixing SDE based on provided test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (tau, dt, D, xi_0, xi_tilde)\n    test_cases = [\n        (0.01, 0.005, 50, 0.8, 0.6),   # Case 1\n        (0.01, 0.02, 50, 0.8, 0.6),    # Case 2\n        (0.01, 0.0199, 50, 0.8, 0.6),  # Case 3\n        (0.1, 0.0001, 0, 0.3, 0.25),   # Case 4\n        (0.001, 0.0021, 1000, 0.1, 0.0), # Case 5\n    ]\n\n    # Initialize a random number generator for the stochastic step.\n    # While the result of the stochastic step is not part of the final\n    # output, its calculation is required by the problem statement to\n    # demonstrate the implementation of the discretization.\n    rng = np.random.default_rng()\n\n    stability_results = []\n    for case in test_cases:\n        tau, dt, D, xi0, xi_tilde = case\n\n        # Task 1: Perform one Euler–Maruyama update (for demonstration).\n        # The Wiener process increment dW_n has a normal distribution with\n        # mean 0 and variance dt.\n        dW = rng.normal(loc=0.0, scale=np.sqrt(dt))\n        \n        # SDE: d(xi) = -((xi - xi_tilde)/tau)dt + sqrt(2D)dW(t)\n        # Numerical step: xi_{n+1} = xi_n - ((xi_n - xi_tilde)/tau)*dt + sqrt(2D)*dW_n\n        xi_next = xi0 - (xi0 - xi_tilde) / tau * dt + np.sqrt(2 * D) * dW\n        # The value 'xi_next' is calculated as required but not used in the output.\n\n        # Task 2: Check for mean-square stability based on the derived condition.\n        # The second moment of deviations, E[(xi_n - xi_tilde)^2], remains\n        # bounded as n -> infinity.\n        \n        # The stability condition is derived as:\n        # - dt  2*tau  if D > 0 (stochastic case)\n        # - dt = 2*tau if D == 0 (deterministic case)\n        \n        is_stable = False\n        limit = 2 * tau\n        \n        if D > 0:\n            is_stable = dt  limit\n        else:  # D is non-negative, so this branch is for D == 0.\n            is_stable = dt = limit\n        \n        stability_results.append(is_stable)\n\n    # Final print statement in the exact required format.\n    # Example: [True,False,True,True,False]\n    capitalized_booleans = [str(b) for b in stability_results]\n    print(f\"[{','.join(capitalized_booleans)}]\")\n\nsolve()\n```"
        }
    ]
}