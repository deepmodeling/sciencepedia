## Introduction
Modeling premixed [turbulent combustion](@entry_id:756233) is a central challenge in computational fluid dynamics, particularly within the Large Eddy Simulation (LES) framework. The primary difficulty lies in accurately representing the effects of the thin, unresolved flame front. The chemical reaction rate is a highly non-linear term that is significantly enhanced by subgrid-scale turbulent wrinkling, creating a critical closure problem that directly impacts the predictive accuracy of simulations.

This article provides a comprehensive exploration of the Artificially Thickened Flame (ATF) model, a widely adopted strategy for addressing this closure problem. By artificially resolving the [flame structure](@entry_id:1125069) on the computational grid, the ATF model offers a tractable way to handle the [chemical source term](@entry_id:747323). We will focus on its modern implementation featuring a dynamic efficiency function, which accounts for the unresolved physics of turbulence-flame interaction.

Across the following chapters, you will gain a deep understanding of this powerful technique. **"Principles and Mechanisms"** will lay the theoretical groundwork, explaining the Favre filtering context, the scaling laws behind flame thickening, and the crucial role of the efficiency function in recovering the correct burning rate. **"Applications and Interdisciplinary Connections"** will demonstrate the model's versatility, covering its implementation in practical CFD codes, its coupling with complex chemistry and turbulence models, and its adaptation to challenging scenarios like [flame-wall interaction](@entry_id:1125049) and stratified combustion. Finally, **"Hands-On Practices"** will provide practical exercises for verifying code implementation and calibrating model constants, bridging the gap between theory and application.

## Principles and Mechanisms

In the context of Large Eddy Simulation (LES) for premixed turbulent combustion, the primary challenge lies in the closure of unclosed terms that arise from the filtering process. The transport of a reactive scalar, such as a reaction [progress variable](@entry_id:1130223) $c$, is fundamental to describing the flame's propagation. This chapter elucidates the principles and mechanisms of the Artificially Thickened Flame (ATF) model, a widely used closure strategy, with a particular focus on its modern implementation featuring a dynamic efficiency function.

### The Closure Problem in Variable-Density Premixed Flames

The transport equation for a reactive scalar in a [variable-density flow](@entry_id:1133709) contains convective, diffusive, and reactive source terms. When a spatial filter is applied to this equation for LES, several unclosed terms emerge. The choice of filtering technique is critical. For [variable-density flows](@entry_id:1133710), characterized by significant density changes across the flame front, **Favre filtering** (or density-weighted filtering) is strongly preferred over conventional Reynolds filtering. A Favre-filtered quantity $\tilde{\phi}$ is defined as $\tilde{\phi} = \overline{\rho \phi} / \bar{\rho}$, where $\rho$ is the density and the overbar denotes the spatial filter.

The principal advantage of Favre filtering is the structural simplification it brings to the filtered convective term, $\overline{\nabla \cdot (\rho \mathbf{u} \phi)}$. Using Favre-filtered velocity $\tilde{\mathbf{u}}$ and scalar $\tilde{\phi}$, this term can be decomposed into a resolved part, $\nabla \cdot (\bar{\rho} \tilde{\mathbf{u}} \tilde{\phi})$, and an unclosed subfilter scalar flux, $\nabla \cdot (\overline{\rho \mathbf{u} c} - \bar{\rho} \tilde{\mathbf{u}} \tilde{c})$. While this subfilter flux still requires a model—often a [gradient-diffusion hypothesis](@entry_id:156064)—Favre filtering elegantly avoids the proliferation of complex correlation terms involving [density fluctuations](@entry_id:143540) that would arise with Reynolds filtering. This makes the closure problem more tractable .

However, the most formidable closure challenge in [premixed combustion](@entry_id:1130127) is the filtered chemical source term, $\overline{\rho \dot{\omega}_c}$. The reaction rate $\dot{\omega}_c$ is a highly non-linear function of temperature and species concentrations. Consequently, the filtered reaction rate is not equal to the reaction rate evaluated at the filtered quantities: $\overline{\rho \dot{\omega}_c} \neq \bar{\rho} \dot{\omega}_c(\tilde{T}, \tilde{\mathbf{Y}})$. In the [flamelet regime](@entry_id:1125055), where the flame thickness is smaller than the LES grid size, turbulence wrinkles the unresolved flame front, significantly increasing its surface area and thus enhancing the total consumption rate within a filter volume. Any successful closure model must account for this subgrid-scale enhancement . The Artificially Thickened Flame model is one such approach designed to resolve the flame structure on the grid and systematically model the turbulent enhancement.

### The Artificially Thickened Flame (ATF) Formulation

The fundamental idea of the ATF model is to artificially increase the thickness of the flame, $\delta_L$, so that it can be resolved on the computational grid. This is achieved by introducing a **thickening factor** $F > 1$, chosen such that the thickened flame thickness, $\delta_L^{\text{ATF}}$, is larger than the local LES filter width $\Delta$.

A crucial constraint is that this artificial modification must not alter the physical **[laminar flame speed](@entry_id:202145)**, $S_L$, which is a fundamental property of the chemical mixture. From classical [combustion theory](@entry_id:141685), the laminar flame speed and thickness have the following scaling relationships with a characteristic molecular diffusivity $D$ and reaction rate $\omega$:
$$ S_L \propto \sqrt{D \omega} $$
$$ \delta_L \propto \frac{D}{S_L} \propto \sqrt{\frac{D}{\omega}} $$

To achieve a thickened flame, $\delta_L^{\text{ATF}} = F \delta_L$, while keeping the flame speed constant, $S_L^{\text{ATF}} = S_L$, the [transport coefficients](@entry_id:136790) and the reaction rate must be scaled consistently. Substituting the target thickened flame properties into the scaling laws reveals the necessary modifications. From $S_L \propto \delta_L \omega$, preserving $S_L$ while scaling $\delta_L$ by $F$ implies that the reaction rate must be scaled by $1/F$. Following this, from $\delta_L \propto D/S_L$, scaling $\delta_L$ by $F$ while preserving $S_L$ dictates that the diffusivity must be scaled by $F$.

Therefore, the core ATF modifications are:
*   **Molecular Diffusivity**: $D \rightarrow D^{\text{ATF}} = F D$
*   **Chemical Source Term**: $\omega \rightarrow \omega^{\text{ATF}} = \omega / F$

This ensures that $S_L^{\text{ATF}} \propto \sqrt{D^{\text{ATF}} \omega^{\text{ATF}}} = \sqrt{(F D) (\omega / F)} = \sqrt{D \omega} \propto S_L$. Similarly, the thermal conductivity $\lambda$ is scaled to $\lambda^{\text{ATF}} = F \lambda$. If all species diffusivities and the thermal conductivity are scaled by the same factor $F$, the Lewis number, $\mathrm{Le} = \alpha / D = \lambda / (\rho c_p D)$, remains unchanged, which is an important feature for preserving [flame dynamics](@entry_id:199340) .

It is important to recognize that this scaling is exact only in the limit of infinitely large activation energy (i.e., Zeldovich number $\beta \to \infty$). For realistic flames with finite activation energy, these modifications introduce small residual errors. The modeled [laminar flame speed](@entry_id:202145) can exhibit a slight deviation from the physical value, typically on the order of $O(\beta^{-1})$, and the flame's response to stretch and curvature, characterized by the Markstein length, is altered, typically increasing with $F$ .

### The Efficiency Function and Subgrid Wrinkling

While the ATF formulation allows the flame to be resolved on the LES grid, the thickening process itself introduces a modeling problem. By making the flame thicker and "stiffer," its response to wrinkling by turbulent eddies is artificially reduced. The enhancement of the burning rate due to wrinkling by subgrid-scale eddies is lost. To compensate for this, an **efficiency function**, often denoted as $E$ or $\Xi$, is introduced.

To understand its role, we consider the turbulent flame in terms of its **[flame surface density](@entry_id:1125071) (FSD)**, $\Sigma$, which is the flame area per unit volume. The total mean consumption rate can be expressed as $\langle \dot{m}_c \rangle = \rho_u S_L A_T$, where $A_T$ is the total flame surface area. In LES, we can only compute the resolved flame surface area, $A_{res}$, corresponding to the resolved FSD, $\Sigma_{res}$. The total (true) FSD can be related to the resolved FSD via a **subgrid [wrinkling factor](@entry_id:1134139)**, $\Xi = \Sigma_{true} / \Sigma_{res}$, where $\Xi \ge 1$. This factor quantifies the amount of flame area hidden in the unresolved subgrid scales .

The final modeled source term is written as:
$$ \dot{\omega}_{\text{model}} = E \cdot \frac{\omega}{F} $$
Here, the efficiency function $E$ models the subgrid [wrinkling factor](@entry_id:1134139) $\Xi$. It represents the physical enhancement of flame surface area by unresolved turbulence and must be formulated to satisfy key physical limits .

For the overall model to be consistent, the efficiency function $E$ must satisfy two fundamental limits :
1.  **Laminar Limit**: In the absence of turbulence ($u' \to 0$), there is no subgrid wrinkling, so $\Xi \to 1$. To ensure the ATF model correctly reproduces the physical [laminar flame speed](@entry_id:202145), the source term must reduce to $\omega/F$. This requires that the model for the efficiency function satisfies $E \to 1$ in this limit.
2.  **Unthickened Limit**: As the thickening factor approaches unity ($F \to 1$), the ATF model must smoothly revert to a non-thickened LES model where the source correction is simply $\Xi \omega$. This requires that $E \to \Xi$ in this limit. A dynamic procedure for $E$ must be constructed to respect these two constraints.

### The Dynamic Procedure

In a simulation, the subgrid [wrinkling factor](@entry_id:1134139) $\Xi$, and thus the efficiency function $E$, is not a constant. It varies in space and time depending on the local balance between turbulent strain and [flame propagation](@entry_id:1125066). A **dynamic procedure**, analogous to that used for [subgrid-scale stress](@entry_id:185085) models, can be employed to compute $E$ locally from the resolved flow field.

The procedure is based on the **Germano identity**, which exploits the consistency of the model across different filter scales. A test filter, with a width $\hat{\Delta}$ larger than the grid filter width $\Delta$ (e.g., $\hat{\Delta} = 2\Delta$), is applied to the filtered equations. The core idea is that the unresolved physics at the sub-test-filter scale can be related to the unresolved physics at the sub-grid-filter scale, which can be computed directly from the resolved field.

The dynamic procedure for $E$ typically involves the following steps :
1.  **Formulate an Identity**: An identity is constructed for the filtered reaction source term. The difference between the test-filtered grid-scale source term and the source term filtered directly at the test scale, known as the Leonard term $L$, is defined: $L = \widehat{\tilde{\dot{\omega}}}_\Delta - \tilde{\dot{\omega}}_{\hat{\Delta}}$.
2.  **Substitute the Model**: The model for the source term, $\tilde{\dot{\omega}} \approx E \cdot G$ (where $G = \omega/F$ is the base ATF source), is substituted at both the grid and test filter levels. Assuming $E$ is approximately [scale-invariant](@entry_id:178566) between $\Delta$ and $\hat{\Delta}$, the identity becomes $L \approx E (\hat{G}_\Delta - G_{\hat{\Delta}})$.
3.  **Solve for E**: This equation contains the unknown $E$. The term $L$ is unclosed, but it can be estimated using an *a priori* model based on resolved quantities, for instance, from the [flame surface density](@entry_id:1125071) estimated as $|\nabla \tilde{c}|$. This leads to an algebraic equation for $E$ at each point. To avoid numerical instabilities caused by division by zero, a robust solution is obtained by minimizing the error in a [least-squares](@entry_id:173916) sense over a local averaging stencil $\mathcal{V}$:
    $$ E = \frac{\langle L M \rangle_{\mathcal{V}}}{\langle M^2 \rangle_{\mathcal{V}}} $$
    where $M = \hat{G}_\Delta - G_{\hat{\Delta}}$.

The "raw" value of $E$ obtained from this procedure can be noisy. Therefore, additional stabilization techniques are essential for a robust implementation . These include:
*   **Averaging**: The raw values are averaged in space and/or time. For statistically planar flames, **plane averaging** in the homogeneous directions is effective. For more complex geometries, **Lagrangian surface averaging** along a flame isosurface provides a physically consistent way to smooth the efficiency function.
*   **Clipping**: The resulting value of $E$ must be constrained to a physical range, $E_{min} \le E \le E_{max}$. **Clipping** (e.g., $E \leftarrow \min(\max(E, E_{min}), E_{max})$) is applied to ensure the source term remains positive and to prevent unphysical, runaway amplification.

### Domain of Applicability

Like all [closure models](@entry_id:1122505), the ATF model with a dynamic efficiency function has a specific domain of applicability, which can be understood using the **Borghi-Peters diagram** of premixed turbulent combustion. This diagram classifies [combustion regimes](@entry_id:1122679) based on dimensionless numbers, primarily the Karlovitz number ($\mathrm{Ka}$) and the Damköhler number ($\mathrm{Da}$).

The ATF model is fundamentally a **flamelet model**. It assumes that the flame, although wrinkled and strained by turbulence, retains a locally one-dimensional, quasi-laminar internal structure. This assumption holds in the **corrugated flamelets regime** ($\mathrm{Ka}  1$) and the **[thin reaction zones](@entry_id:1133103) regime** ($1  \mathrm{Ka} \lesssim 100$). In these regimes, even the smallest turbulent eddies (at the Kolmogorov scale) are larger than the flame's inner reaction layer, so they can wrinkle the flame but not disrupt its chemistry.

The model is expected to fail in the **broken reaction zones regime** ($\mathrm{Ka} \gg 100$). Here, the smallest turbulent eddies are smaller and faster than the reaction layer. They can penetrate the [flame structure](@entry_id:1125069), locally extinguishing and re-igniting the mixture and destroying the coherent flamelet structure. In this regime, the very concept of a continuous "flame surface" and its wrinkling becomes ill-defined. Since the efficiency function $E$ is designed to model the enhancement of flame surface area, its physical basis dissolves, and the ATF+DEF approach is no longer valid . Therefore, applying this model requires an a priori assessment that the combustion process resides within the appropriate flamelet-based regimes.