{
    "hands_on_practices": [
        {
            "introduction": "The rate of molecular mixing is a crucial factor in determining reaction rates in turbulent combustion, and it is quantified by the scalar dissipation rate, $\\chi$. This practice provides a foundational understanding of $\\chi$ by examining an idealized one-dimensional mixing layer subjected to a constant strain rate, a canonical problem in combustion theory. By deriving and solving the steady-state transport equation for a mixture fraction $Z$, you will gain hands-on experience with the fundamental balance between convection and diffusion that establishes scalar gradients. ",
            "id": "4046540",
            "problem": "Consider one-dimensional reactive mixing modeled by a conserved mixture fraction $Z(x,t)$ in a counterflow mixing layer within computational combustion. Assume constant density and Fickian diffusion with constant molecular diffusivity $D$, and a steady, incompressible stagnation-point flow along the normal coordinate $x$ characterized by a uniform strain rate $S0$ producing a velocity field $u(x)=-Sx$. Starting from the conservation law for a passive scalar and using only the stated physical assumptions, do the following: (i) derive the steady ordinary differential equation for $Z(x)$, (ii) solve for $Z(x)$ subject to the boundary conditions $Z(-\\infty)=1$ and $Z(\\infty)=0$, and (iii) from the scalar variance budget, derive the local scalar dissipation rate $\\chi(x)$ in one spatial dimension with constant $D$ in terms of $Z(x)$. Then, using your derived expressions, evaluate the scalar dissipation rate at the mixing layer centerline $x=0$. Use the parameter values $S=120\\,\\text{s}^{-1}$ and $D=2.0\\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$. Express the final scalar dissipation rate at $x=0$ in $\\text{s}^{-1}$ and round your answer to four significant figures.",
            "solution": "The problem statement will first be validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **System**: One-dimensional reactive mixing in a counterflow mixing layer.\n- **Variable**: Conserved mixture fraction $Z(x,t)$.\n- **Physics**: Constant density, Fickian diffusion with constant molecular diffusivity $D$.\n- **Flow Field**: Steady, incompressible stagnation-point flow along the normal coordinate $x$.\n- **Velocity**: $u(x)=-Sx$, where $S  0$ is a uniform strain rate.\n- **Boundary Conditions**: $Z(-\\infty)=1$ and $Z(\\infty)=0$.\n- **Tasks**:\n  1. Derive the steady ordinary differential equation (ODE) for $Z(x)$.\n  2. Solve for $Z(x)$ subject to the given boundary conditions.\n  3. Derive the local scalar dissipation rate $\\chi(x)$ in one spatial dimension with constant $D$ from the scalar variance budget in terms of $Z(x)$.\n  4. Evaluate $\\chi(x)$ at the mixing layer centerline $x=0$.\n- **Parameters**: $S=120\\,\\text{s}^{-1}$ and $D=2.0\\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$.\n- **Output Specification**: The final answer for $\\chi(0)$ should be in units of $\\text{s}^{-1}$ and rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a canonical model in computational combustion and fluid dynamics, often used to study laminar diffusion flames or mixing layers. The assumptions and setup are standard for deriving an analytical solution.\n\n- **Scientifically Grounded**: The problem is based on the fundamental conservation law for a scalar quantity, incorporating Fickian diffusion and convection in a specified velocity field. The stagnation-point flow model is a well-established approximation for counterflow configurations. All aspects are firmly rooted in transport phenomena and combustion theory.\n- **Well-Posed**: The problem specifies a second-order ordinary differential equation with two boundary conditions, which constitutes a well-posed boundary value problem that admits a unique, stable solution.\n- **Objective**: The problem is stated using precise, standard scientific terminology and is free of any ambiguity or subjective claims.\n\nA potential point of confusion is the statement of an \"incompressible\" flow with a one-dimensional velocity field $u(x)=-Sx$, for which the divergence $du/dx = -S \\neq 0$. This apparent contradiction is resolved by recognizing that this 1D model is a simplification of a higher-dimensional flow, such as a 2D planar flow $\\mathbf{v} = (-Sx, Sy)$, for which the divergence $\\nabla \\cdot \\mathbf{v} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = -S + S = 0$. The model assumes that gradients of $Z$ in the transverse directions are negligible, a standard boundary-layer type approximation. The problem is therefore internally consistent and scientifically sound.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### (i) Derivation of the Steady ODE for $Z(x)$\n\nThe conservation law for a scalar quantity $Z$ in a one-dimensional domain is given by the advection-diffusion equation. For a constant-density (incompressible) flow, this equation is:\n$$ \\frac{\\partial Z}{\\partial t} + u \\frac{\\partial Z}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( D \\frac{\\partial Z}{\\partial x} \\right) $$\nThe problem specifies a steady-state condition, so the time derivative term is zero: $\\frac{\\partial Z}{\\partial t} = 0$. The equation becomes an ordinary differential equation in $x$:\n$$ u \\frac{dZ}{dx} = \\frac{d}{dx} \\left( D \\frac{dZ}{dx} \\right) $$\nWe are given a constant molecular diffusivity $D$ and a velocity field $u(x) = -Sx$. Substituting these into the equation yields:\n$$ (-Sx) \\frac{dZ}{dx} = D \\frac{d^2Z}{dx^2} $$\nRearranging the terms to the standard form for a linear second-order ODE, we get:\n$$ D \\frac{d^2Z}{dx^2} + Sx \\frac{dZ}{dx} = 0 $$\nThis is the required steady ordinary differential equation for the mixture fraction $Z(x)$.\n\n### (ii) Solution of the ODE for $Z(x)$\n\nThe ODE derived in part (i) is a second-order linear homogeneous equation with a variable coefficient. We can solve it by reduction of order. Let $Y(x) = \\frac{dZ}{dx}$. The ODE becomes a first-order equation for $Y$:\n$$ D \\frac{dY}{dx} + Sx Y = 0 $$\nThis is a separable equation:\n$$ D \\frac{dY}{dx} = -Sx Y $$\n$$ \\frac{dY}{Y} = -\\frac{S}{D} x \\, dx $$\nIntegrating both sides:\n$$ \\int \\frac{dY}{Y} = \\int -\\frac{S}{D} x \\, dx $$\n$$ \\ln(Y) = -\\frac{S}{D} \\frac{x^2}{2} + C_0 $$\nwhere $C_0$ is the constant of integration. Exponentiating both sides gives $Y(x)$:\n$$ Y(x) = \\exp\\left(-\\frac{S x^2}{2D} + C_0\\right) = C_1 \\exp\\left(-\\frac{S x^2}{2D}\\right) $$\nwhere $C_1 = \\exp(C_0)$ is a new constant. Now, we substitute back $Y(x) = \\frac{dZ}{dx}$ and integrate with respect to $x$ to find $Z(x)$:\n$$ \\frac{dZ}{dx} = C_1 \\exp\\left(-\\frac{S x^2}{2D}\\right) $$\n$$ Z(x) = \\int C_1 \\exp\\left(-\\frac{S x^2}{2D}\\right) dx + C_2 $$\nThe integral is related to the error function, $\\text{erf}(z) \\equiv \\frac{2}{\\sqrt{\\pi}} \\int_0^z \\exp(-t^2) dt$. Let the argument of the exponential be $-t^2$, so $t = x \\sqrt{\\frac{S}{2D}}$. Then $dx = \\sqrt{\\frac{2D}{S}} dt$. The integral becomes:\n$$ \\int \\exp\\left(-\\frac{S x^2}{2D}\\right) dx = \\sqrt{\\frac{2D}{S}} \\int \\exp(-t^2) dt = \\sqrt{\\frac{2D}{S}} \\left( \\frac{\\sqrt{\\pi}}{2} \\text{erf}(t) \\right) = \\sqrt{\\frac{D\\pi}{2S}} \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) $$\nSo, the general solution for $Z(x)$ is:\n$$ Z(x) = C_1 \\sqrt{\\frac{D\\pi}{2S}} \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) + C_2 $$\nLet's define new constants $A = C_1 \\sqrt{D\\pi/(2S)}$ and $B=C_2$ for simplicity:\n$$ Z(x) = A \\, \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) + B $$\nWe now apply the boundary conditions $Z(-\\infty)=1$ and $Z(\\infty)=0$, using the properties $\\text{erf}(\\infty)=1$ and $\\text{erf}(-\\infty)=-1$.\nFor $x \\rightarrow \\infty$:\n$$ Z(\\infty) = A(1) + B = 0 \\implies B = -A $$\nFor $x \\rightarrow -\\infty$:\n$$ Z(-\\infty) = A(-1) + B = 1 \\implies -A + B = 1 $$\nSubstituting $B = -A$ into the second equation:\n$$ -A + (-A) = 1 \\implies -2A = 1 \\implies A = -\\frac{1}{2} $$\nThis gives $B = -A = \\frac{1}{2}$.\nSubstituting the constants $A$ and $B$ back into the solution for $Z(x)$:\n$$ Z(x) = -\\frac{1}{2} \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) + \\frac{1}{2} = \\frac{1}{2} \\left[1 - \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right)\\right] $$\nThis solution can be expressed more compactly using the complementary error function, $\\text{erfc}(z) = 1 - \\text{erf}(z)$:\n$$ Z(x) = \\frac{1}{2} \\text{erfc}\\left(x \\sqrt{\\frac{S}{2D}}\\right) $$\n\n### (iii) Derivation of the Scalar Dissipation Rate $\\chi(x)$\n\nThe scalar dissipation rate, $\\chi$, is a measure of the rate at which scalar fluctuations are dissipated by molecular diffusion. For a one-dimensional system with constant diffusivity $D$, it is defined as:\n$$ \\chi(x) = 2D \\left(\\frac{dZ}{dx}\\right)^2 $$\nTo find $\\chi(x)$, we must first compute the derivative of $Z(x)$. Using the solution from part (ii) and the property $\\frac{d}{dz}(\\text{erfc}(z)) = -\\frac{2}{\\sqrt{\\pi}}\\exp(-z^2)$:\n$$ \\frac{dZ}{dx} = \\frac{d}{dx} \\left[ \\frac{1}{2} \\text{erfc}\\left(x \\sqrt{\\frac{S}{2D}}\\right) \\right] $$\nApplying the chain rule with the inner function $w(x) = x \\sqrt{\\frac{S}{2D}}$ and $\\frac{dw}{dx} = \\sqrt{\\frac{S}{2D}}$:\n$$ \\frac{dZ}{dx} = \\frac{1}{2} \\left[ -\\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\left(x\\sqrt{\\frac{S}{2D}}\\right)^2\\right) \\right] \\left( \\sqrt{\\frac{S}{2D}} \\right) $$\n$$ \\frac{dZ}{dx} = -\\frac{1}{\\sqrt{\\pi}} \\exp\\left(-\\frac{S x^2}{2D}\\right) \\sqrt{\\frac{S}{2D}} = -\\sqrt{\\frac{S}{2D\\pi}} \\exp\\left(-\\frac{S x^2}{2D}\\right) $$\nNow, we substitute this derivative into the definition of $\\chi(x)$:\n$$ \\chi(x) = 2D \\left[ -\\sqrt{\\frac{S}{2D\\pi}} \\exp\\left(-\\frac{S x^2}{2D}\\right) \\right]^2 $$\n$$ \\chi(x) = 2D \\left[ \\frac{S}{2D\\pi} \\exp\\left(-2 \\cdot \\frac{S x^2}{2D}\\right) \\right] $$\n$$ \\chi(x) = \\frac{S}{\\pi} \\exp\\left(-\\frac{S x^2}{D}\\right) $$\nThis expression gives the local scalar dissipation rate as a function of position $x$.\n\n### Evaluation of $\\chi(0)$\n\nThe problem asks for the scalar dissipation rate at the mixing layer centerline, which is located at $x=0$. At this point, $Z(0) = \\frac{1}{2}\\text{erfc}(0) = \\frac{1}{2}$. We evaluate $\\chi(x)$ at $x=0$:\n$$ \\chi(0) = \\frac{S}{\\pi} \\exp\\left(-\\frac{S (0)^2}{D}\\right) = \\frac{S}{\\pi} \\exp(0) = \\frac{S}{\\pi} $$\nNote that the value of $\\chi(0)$ depends only on the strain rate $S$, not on the diffusivity $D$.\nWe are given $S=120\\,\\text{s}^{-1}$. Substituting this value into the expression for $\\chi(0)$:\n$$ \\chi(0) = \\frac{120}{\\pi} \\, \\text{s}^{-1} $$\nNow, we compute the numerical value and round it to four significant figures:\n$$ \\chi(0) \\approx 38.197186... \\, \\text{s}^{-1} $$\nRounding to four significant figures gives:\n$$ \\chi(0) \\approx 38.20 \\, \\text{s}^{-1} $$",
            "answer": "$$\\boxed{38.20}$$"
        },
        {
            "introduction": "The One-dimensional Turbulence (ODT) model simulates a suite of physical processes, including diffusion and chemical reaction, which often occur on vastly different time scales. A common numerical strategy to handle this complexity is operator splitting, where the governing equations are split into more manageable subproblems. This exercise delves into the heart of this technique by asking you to derive the leading-order local error associated with Lie splitting, which arises because the diffusion and reaction operators do not commute.  Quantifying this error for a discretized system will provide crucial insight into the fidelity of operator-split simulations.",
            "id": "4046415",
            "problem": "Consider a single-species, isothermal reactive mixing problem in one spatial dimension representative of the One-Dimensional Turbulence (ODT) modeling framework in computational combustion. The species mass fraction $Y(x,t)$ evolves under the semilinear reaction–diffusion equation\n$$\n\\frac{\\partial Y}{\\partial t} \\;=\\; \\kappa\\,\\frac{\\partial^{2}Y}{\\partial x^{2}} \\;+\\; \\omega(Y),\n$$\nwhere $\\kappa0$ is the molecular diffusivity and $\\omega(Y)$ is the reaction source term. In regimes where the characteristic chemical time scale $\\tau_{\\text{chem}}$ is much smaller than the diffusive time scale $\\tau_{\\text{diff}}$ (i.e., $\\tau_{\\text{chem}}\\ll\\tau_{\\text{diff}}$), an operator-splitting integrator with reaction subcycling is employed over a macro-step of size $\\Delta t$: the reaction subproblem is advanced in $N$ substeps of size $\\delta t=\\Delta t/N$ (assume the reaction substeps are integrated exactly), while the diffusion subproblem is advanced once per macro-step. The Lie-split macro-step is\n$$\n\\text{Lie}(\\Delta t):\\quad Y^{n+1}\\;=\\;\\Phi_{\\mathcal{D}}(\\Delta t)\\,\\Phi_{\\mathcal{R}}(\\Delta t)\\,Y^{n},\n$$\nwhere $\\Phi_{\\mathcal{D}}(\\Delta t)$ and $\\Phi_{\\mathcal{R}}(\\Delta t)$ denote the exact solution operators of the diffusion and reaction subproblems over $\\Delta t$, respectively. The exact unsplit evolution over the same interval is denoted by $\\Phi_{\\mathcal{L}}(\\Delta t)$ for the full generator $\\mathcal{L}=\\mathcal{D}+\\mathcal{R}$.\n\nStarting from the fundamental reaction–diffusion equation and the definition of the Lie product, derive the leading-order local splitting error over one macro-step in terms of the commutator $[\\mathcal{D},\\mathcal{R}]$ and an operator norm. Explicitly justify why reaction subcycling (with exact reaction integration in each substep) in the limit $\\tau_{\\text{chem}}\\ll\\tau_{\\text{diff}}$ does not change the leading-order splitting error term.\n\nThen, quantify this bound in a concrete discretized setting as follows. Let the spatial domain be periodic with length $L$ and discretized into $M$ equally spaced nodes. Use a second-order centered finite-difference Laplacian to define the discrete diffusion operator $\\mathbf{D}=\\kappa \\mathbf{L}$ acting on the vector of nodal mass fractions $\\mathbf{Y}$. Linearize the reaction source term around the current state $\\mathbf{Y}^{n}$ to define the diagonal Jacobian operator $\\mathbf{R}=\\mathrm{diag}\\left(\\omega'(Y_{1}^{n}),\\dots,\\omega'(Y_{M}^{n})\\right)$, and use the matrix commutator $[\\mathbf{D},\\mathbf{R}]=\\mathbf{D}\\mathbf{R}-\\mathbf{R}\\mathbf{D}$ to bound the local splitting error operator.\n\nCompute the Frobenius norm of the commutator and the corresponding leading-order bound on the local splitting error operator for the following scientifically consistent parameter set:\n- $L=0.03$ (meters), $M=3$ so that $h=L/M$,\n- $\\kappa=1.0\\times 10^{-4}$ (square meters per second),\n- $\\omega(Y)=k\\,Y\\,(1-Y)$ with $k=1.0\\times 10^{3}$ (inverse seconds),\n- $\\mathbf{Y}^{n}=\\bigl[0.2,\\;0.5,\\;0.8\\bigr]^{\\mathsf{T}}$,\n- $\\Delta t=0.01$ (seconds),\n- periodic boundary conditions so that the discrete Laplacian is $\\mathbf{L}=\\frac{1}{h^{2}}\\begin{pmatrix}-2  1  1 \\\\ 1  -2  1 \\\\ 1  1  -2\\end{pmatrix}$.\n\nUse the Frobenius norm to produce a conservative upper bound on the operator error after one Lie-split macro-step,\n$$\n\\left\\|\\Phi_{\\mathcal{D}}(\\Delta t)\\,\\Phi_{\\mathcal{R}}(\\Delta t)-\\Phi_{\\mathcal{L}}(\\Delta t)\\right\\| \\;\\lesssim\\; \\frac{1}{2}\\,\\Delta t^{2}\\,\\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F},\n$$\nand provide the final numerical value of the right-hand side for the given parameters. Round your final answer to four significant figures and express it as a mass fraction (dimensionless).",
            "solution": "The problem asks for two tasks: first, to derive the leading-order local splitting error for a Lie-split integrator and justify the role of reaction subcycling; second, to quantify this error for a specific discretized reaction-diffusion system.\n\nFirst, we address the theoretical derivation of the local splitting error. The governing semilinear reaction–diffusion equation is given by\n$$ \\frac{\\partial Y}{\\partial t} \\;=\\; \\kappa\\,\\frac{\\partial^{2}Y}{\\partial x^{2}} \\;+\\; \\omega(Y) \\;=\\; (\\mathcal{D} + \\mathcal{R})Y \\;=\\; \\mathcal{L}Y $$\nwhere $\\mathcal{D} = \\kappa \\frac{\\partial^2}{\\partial x^2}$ and $\\mathcal{R}$ is the operator corresponding to multiplication by the reaction source term $\\omega(\\cdot)$. The exact solution over a time step of size $\\Delta t$ can be formally written using the solution operator $\\Phi_{\\mathcal{L}}(\\Delta t) = \\exp(\\mathcal{L}\\Delta t)$.\n\nA Taylor series expansion of the exact operator in $\\Delta t$ yields:\n$$ \\Phi_{\\mathcal{L}}(\\Delta t) = \\exp((\\mathcal{D}+\\mathcal{R})\\Delta t) = I + (\\mathcal{D}+\\mathcal{R})\\Delta t + \\frac{1}{2}(\\mathcal{D}+\\mathcal{R})^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\nExpanding the second-order term gives:\n$$ \\Phi_{\\mathcal{L}}(\\Delta t) = I + (\\mathcal{D}+\\mathcal{R})\\Delta t + \\frac{1}{2}(\\mathcal{D}^{2} + \\mathcal{D}\\mathcal{R} + \\mathcal{R}\\mathcal{D} + \\mathcal{R}^{2})\\Delta t^{2} + O(\\Delta t^{3}) $$\nThe Lie-split approximation is given by the product of the individual exact solution operators, $\\Phi_{\\mathcal{D}}(\\Delta t)\\Phi_{\\mathcal{R}}(\\Delta t) = \\exp(\\mathcal{D}\\Delta t)\\exp(\\mathcal{R}\\Delta t)$. Expanding each exponential operator separately:\n$$ \\exp(\\mathcal{D}\\Delta t) = I + \\mathcal{D}\\Delta t + \\frac{1}{2}\\mathcal{D}^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\n$$ \\exp(\\mathcal{R}\\Delta t) = I + \\mathcal{R}\\Delta t + \\frac{1}{2}\\mathcal{R}^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\nMultiplying these two series and retaining terms up to order $\\Delta t^2$:\n$$ \\Phi_{\\mathcal{D}}(\\Delta t)\\Phi_{\\mathcal{R}}(\\Delta t) = \\left(I + \\mathcal{D}\\Delta t + \\frac{1}{2}\\mathcal{D}^{2}\\Delta t^{2}\\right) \\left(I + \\mathcal{R}\\Delta t + \\frac{1}{2}\\mathcal{R}^{2}\\Delta t^{2}\\right) + O(\\Delta t^{3}) $$\n$$ = I + \\mathcal{R}\\Delta t + \\frac{1}{2}\\mathcal{R}^{2}\\Delta t^{2} + \\mathcal{D}\\Delta t + \\mathcal{D}\\mathcal{R}\\Delta t^{2} + \\frac{1}{2}\\mathcal{D}^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\n$$ = I + (\\mathcal{D}+\\mathcal{R})\\Delta t + \\frac{1}{2}(\\mathcal{D}^{2} + 2\\mathcal{D}\\mathcal{R} + \\mathcal{R}^{2})\\Delta t^{2} + O(\\Delta t^{3}) $$\nThe local splitting error operator, $E(\\Delta t)$, is the difference between the split and exact solution operators:\n$$ E(\\Delta t) = \\Phi_{\\mathcal{D}}(\\Delta t)\\Phi_{\\mathcal{R}}(\\Delta t) - \\Phi_{\\mathcal{L}}(\\Delta t) $$\n$$ = \\left[\\frac{1}{2}(\\mathcal{D}^{2} + 2\\mathcal{D}\\mathcal{R} + \\mathcal{R}^{2})\\right]\\Delta t^{2} - \\left[\\frac{1}{2}(\\mathcal{D}^{2} + \\mathcal{D}\\mathcal{R} + \\mathcal{R}\\mathcal{D} + \\mathcal{R}^{2})\\right]\\Delta t^{2} + O(\\Delta t^{3})$$\n$$ = \\frac{1}{2}(2\\mathcal{D}\\mathcal{R} - \\mathcal{D}\\mathcal{R} - \\mathcal{R}\\mathcal{D})\\Delta t^{2} + O(\\Delta t^{3}) $$\n$$ = \\frac{1}{2}(\\mathcal{D}\\mathcal{R} - \\mathcal{R}\\mathcal{D})\\Delta t^{2} + O(\\Delta t^{3}) = \\frac{1}{2}[\\mathcal{D},\\mathcal{R}]\\Delta t^{2} + O(\\Delta t^{3}) $$\nThe leading-order local splitting error is thus proportional to the commutator of the operators, $[\\mathcal{D},\\mathcal{R}]$, and is of second order in $\\Delta t$.\n\nRegarding reaction subcycling, the problem states that the reaction subproblem is integrated exactly in each of the $N$ substeps of size $\\delta t = \\Delta t/N$. The operator for the full reaction step, $\\Phi_{\\mathcal{R}}(\\Delta t)$, represents the exact solution of the ODE subproblem $\\frac{dY}{dt}=\\omega(Y)$ over $\\Delta t$. Because this ODE is autonomous in time, its exact solution operator possesses the semigroup property: $\\Phi_{\\mathcal{R}}(t_1 + t_2) = \\Phi_{\\mathcal{R}}(t_1)\\Phi_{\\mathcal{R}}(t_2)$. Therefore, the composition of $N$ exact integrations over $\\delta t$ yields:\n$$ \\underbrace{\\Phi_{\\mathcal{R}}(\\delta t) \\circ \\dots \\circ \\Phi_{\\mathcal{R}}(\\delta t)}_{N \\text{ times}} = \\Phi_{\\mathcal{R}}(N\\delta t) = \\Phi_{\\mathcal{R}}(\\Delta t) $$\nSince the subcycling procedure, under the assumption of exactness in each substep, reconstructs the identical exact operator $\\Phi_{\\mathcal{R}}(\\Delta t)$, it does not alter the derivation of the splitting error. The splitting error is an inherent consequence of the non-commutativity of the continuous operators $\\mathcal{D}$ and $\\mathcal{R}$, not the method used to implement their respective sub-integrations (provided they are exact).\n\nNext, we quantify the leading-order error bound for the given discretized system.\nThe parameters are:\n- $L = 0.03$ m\n- $M = 3$ nodes\n- Grid spacing $h = L/M = 0.03/3 = 0.01$ m\n- Diffusivity $\\kappa = 1.0 \\times 10^{-4}$ m$^2$/s\n- Reaction $\\omega(Y) = k\\,Y\\,(1-Y)$ with $k = 1.0 \\times 10^3$ s$^{-1}$\n- State vector $\\mathbf{Y}^{n} = [0.2, 0.5, 0.8]^{\\mathsf{T}}$\n- Time step $\\Delta t = 0.01$ s\n\nThe discrete diffusion operator is $\\mathbf{D} = \\kappa \\mathbf{L}$, where $\\mathbf{L} = \\frac{1}{h^2}\\begin{pmatrix}-2  1  1\\\\ 1  -2  1\\\\ 1  1  -2\\end{pmatrix}$.\nThe prefactor is $\\frac{\\kappa}{h^2} = \\frac{1.0 \\times 10^{-4} \\text{ m}^2/\\text{s}}{(0.01 \\text{ m})^2} = \\frac{1.0 \\times 10^{-4}}{1.0 \\times 10^{-4}}$ s$^{-1} = 1.0$ s$^{-1}$.\nThus, the diffusion matrix is:\n$$ \\mathbf{D} = 1.0 \\times \\begin{pmatrix}-2  1  1\\\\ 1  -2  1\\\\ 1  1  -2\\end{pmatrix} = \\begin{pmatrix}-2  1  1\\\\ 1  -2  1\\\\ 1  1  -2\\end{pmatrix} \\text{ s}^{-1} $$\nThe discrete reaction operator is the Jacobian $\\mathbf{R} = \\mathrm{diag}(\\omega'(Y_{1}^{n}), \\omega'(Y_{2}^{n}), \\omega'(Y_{3}^{n}))$.\nFirst, we find the derivative $\\omega'(Y) = \\frac{d}{dY}(kY - kY^2) = k - 2kY = k(1-2Y)$.\nWe evaluate this at the nodal values of $\\mathbf{Y}^{n}$ with $k=1000$ s$^{-1}$:\n- $\\omega'(Y_{1}^{n}) = \\omega'(0.2) = 1000(1 - 2 \\times 0.2) = 1000(0.6) = 600$ s$^{-1}$\n- $\\omega'(Y_{2}^{n}) = \\omega'(0.5) = 1000(1 - 2 \\times 0.5) = 1000(0) = 0$ s$^{-1}$\n- $\\omega'(Y_{3}^{n}) = \\omega'(0.8) = 1000(1 - 2 \\times 0.8) = 1000(-0.6) = -600$ s$^{-1}$\nThe reaction matrix is:\n$$ \\mathbf{R} = \\begin{pmatrix} 600  0  0 \\\\ 0  0  0 \\\\ 0  0  -600 \\end{pmatrix} \\text{ s}^{-1} $$\nNow we compute the commutator $[\\mathbf{D}, \\mathbf{R}] = \\mathbf{D}\\mathbf{R} - \\mathbf{R}\\mathbf{D}$.\n$$ \\mathbf{D}\\mathbf{R} = \\begin{pmatrix}-2  1  1\\\\ 1  -2  1\\\\ 1  1  -2\\end{pmatrix} \\begin{pmatrix} 600  0  0 \\\\ 0  0  0 \\\\ 0  0  -600 \\end{pmatrix} = \\begin{pmatrix} -1200  0  -600 \\\\ 600  0  -600 \\\\ 600  0  1200 \\end{pmatrix} $$\n$$ \\mathbf{R}\\mathbf{D} = \\begin{pmatrix} 600  0  0 \\\\ 0  0  0 \\\\ 0  0  -600 \\end{pmatrix} \\begin{pmatrix}-2  1  1\\\\ 1  -2  1\\\\ 1  1  -2\\end{pmatrix} = \\begin{pmatrix} -1200  600  600 \\\\ 0  0  0 \\\\ -600  -600  1200 \\end{pmatrix} $$\n$$ [\\mathbf{D}, \\mathbf{R}] = \\begin{pmatrix} -1200  0  -600 \\\\ 600  0  -600 \\\\ 600  0  1200 \\end{pmatrix} - \\begin{pmatrix} -1200  600  600 \\\\ 0  0  0 \\\\ -600  -600  1200 \\end{pmatrix} = \\begin{pmatrix} 0  -600  -1200 \\\\ 600  0  -600 \\\\ 1200  600  0 \\end{pmatrix} \\text{ s}^{-2} $$\nNext, we compute the Frobenius norm of the commutator, $\\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F} = \\sqrt{\\sum_{i,j} |c_{ij}|^2}$.\n$$ \\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F}^2 = 0^2 + (-600)^2 + (-1200)^2 + 600^2 + 0^2 + (-600)^2 + 1200^2 + 600^2 + 0^2 $$\n$$ = 2 \\times (600^2 + 1200^2 + 600^2) = 4 \\times 600^2 + 2 \\times 1200^2 $$\n$$ = 4 \\times (3.6 \\times 10^5) + 2 \\times (1.44 \\times 10^6) = 1.44 \\times 10^6 + 2.88 \\times 10^6 = 4.32 \\times 10^6 \\text{ s}^{-4} $$\n$$ \\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F} = \\sqrt{4.32 \\times 10^6} = \\sqrt{432} \\times 10^2 = \\sqrt{144 \\times 3} \\times 10^2 = 12\\sqrt{3} \\times 10^2 = 1200\\sqrt{3} \\text{ s}^{-2} $$\nFinally, we compute the numerical value of the leading-order error bound:\n$$ \\text{Error Bound} = \\frac{1}{2}\\,\\Delta t^{2}\\,\\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F} $$\n$$ = \\frac{1}{2}(0.01 \\text{ s})^2 (1200\\sqrt{3} \\text{ s}^{-2}) = \\frac{1}{2}(10^{-4} \\text{ s}^2) (1200\\sqrt{3} \\text{ s}^{-2}) $$\n$$ = 600 \\times 10^{-4} \\sqrt{3} = 0.06\\sqrt{3} $$\nThis quantity is dimensionless, as expected for an operator acting on the dimensionless mass fraction vector.\nNumerically evaluating and rounding to four significant figures:\n$$ 0.06\\sqrt{3} \\approx 0.06 \\times 1.7320508 \\approx 0.103923048 \\approx 0.1039 $$",
            "answer": "$$\n\\boxed{0.1039}\n$$"
        },
        {
            "introduction": "A key goal of turbulence modeling is to predict how flow dynamics alter flame structure and behavior. This practice connects the micro-scale parameters of an ODT-like model to the macro-scale phenomena described by the classic turbulent premixed combustion regime diagram. You will use fundamental time-scale analysis to compute the Damköhler ($Da$) and Karlovitz ($Ka$) numbers from a given set of eddy and mixture properties.  This exercise provides a tangible link between the abstract parameters of the model and the physical classification of flame behavior, from stable flamelets to distributed reaction zones.",
            "id": "4046519",
            "problem": "You are to implement a computational parametric study, suitable for advanced graduate-level work in computational combustion, that uses a simplified One-Dimensional Turbulence (ODT) eddy-kernel parameterization to traverse the Damköhler number–Karlovitz number ($Da$–$Ka$) space and predict transitions in premixed flame regime behaviors for reactive mixing. The study shall be framed from first principles using well-tested scaling laws and definitions, and must produce a single-line output aggregating all test-case results.\n\nStart from fundamental bases and core definitions, including:\n- The definition of a laminar premixed flame time scale given by the ratio of thickness to speed, namely the flame time scale $t_{\\mathrm{chem}}$ defined as $t_{\\mathrm{chem}} = \\delta_L / s_L$, where $\\delta_L$ is the laminar flame thickness and $s_L$ is the laminar flame speed. These are treated as known properties of the mixture at a given thermochemical state.\n- The Kolmogorov micro-scale time scale $t_{\\eta}$ from the theory of turbulence, given by $t_{\\eta} = \\sqrt{\\nu / \\varepsilon}$, where $\\nu$ is the kinematic viscosity and $\\varepsilon$ is the turbulent kinetic energy dissipation rate per unit mass.\n- The inertial-subrange eddy time scale $t_{\\ell}$ derived from scaling of the eddy velocity at scale $\\ell$ as $u_{\\ell} \\sim (\\varepsilon \\ell)^{1/3}$, so that $t_{\\ell} = \\ell / u_{\\ell} = \\ell^{2/3}\\,\\varepsilon^{-1/3}$.\n\nUse these to define the central dimensionless numbers governing reactive mixing:\n- The Damköhler number $Da$ comparing an eddy mixing time to the chemical (flame) time scale: $Da = t_{\\ell} / t_{\\mathrm{chem}}$.\n- The Karlovitz number $Ka$ comparing the flame time scale to the Kolmogorov time: $Ka = t_{\\mathrm{chem}} / t_{\\eta}$.\n\nYou will implement a parametric study over an ODT-like eddy kernel represented by $(\\ell, \\varepsilon)$ pairs, together with $(s_L, \\delta_L, \\nu)$, to compute $(Da, Ka)$ and predict flame regimes using logical rules grounded in time-scale comparisons. The classification must map to integer codes to ensure a quantifiable output:\n- Code $0$ (Flamelet): $Da \\ge 3$ and $Ka  1$.\n- Code $1$ (Thin Reaction Zones): $Da \\ge 3$ and $Ka \\ge 1$.\n- Code $2$ (Broken Reaction Zones): $0.7 \\le Da  3$ and $Ka \\ge 1$.\n- Code $3$ (Distributed Reaction): $Da  0.7$ and $Ka \\ge 1$.\n- Code $4$ (Well-Stirred Reactor): $Da  0.7$ and $Ka  1$, or $0.7 \\le Da  3$ and $Ka  1$.\n\nTie-breaking convention must be applied exactly as follows: treat $Ka = 1$ as belonging to the $Ka \\ge 1$ side; treat $Da = 0.7$ and $Da = 3$ as belonging to the higher-$Da$ side of each boundary.\n\nAll quantities must be handled in International System of Units (SI): $s_L$ in $\\mathrm{m/s}$, $\\delta_L$ in $\\mathrm{m}$, $\\nu$ in $\\mathrm{m^2/s}$, $\\varepsilon$ in $\\mathrm{m^2/s^3}$, and $\\ell$ in $\\mathrm{m}$.\n\nImplement your program to compute the classification code for each test case. The test suite consists of the following parameter sets $(s_L, \\delta_L, \\nu, \\varepsilon, \\ell)$:\n- Case $1$ (Flamelet regime, happy path): $(0.4, 5\\times 10^{-4}, 1.5\\times 10^{-5}, 1, 1\\times 10^{-2})$.\n- Case $2$ (Thin reaction zones, higher $Ka$ with large $Da$): $(0.4, 5\\times 10^{-4}, 1.5\\times 10^{-5}, 100, 1\\times 10^{-2})$.\n- Case $3$ (Broken reaction zones, intermediate $Da$ and $Ka \\ge 1$): $(0.4, 5\\times 10^{-4}, 1.5\\times 10^{-5}, 500, 3\\times 10^{-3})$.\n- Case $4$ (Distributed reaction, low $Da$ with large $Ka$): $(0.4, 5\\times 10^{-4}, 1.5\\times 10^{-5}, 10^{4}, 1\\times 10^{-3})$.\n- Case $5$ (Well-stirred reactor, both $Da$ and $Ka$ low via micro-eddy): $(0.4, 5\\times 10^{-4}, 1.5\\times 10^{-5}, 0.1, 1\\times 10^{-6})$.\n- Case $6$ (Boundary test, $Ka = 1$ exactly by construction): $(0.4, 5\\times 10^{-4}, 1.5\\times 10^{-5}, 9.6, 1\\times 10^{-2})$, where $9.6 = \\nu / t_{\\mathrm{chem}}^2$ for $t_{\\mathrm{chem}} = \\delta_L/s_L$ specified above.\n- Case $7$ (Boundary test, $Da = 0.7$ with $Ka \\ge 1$): $(0.4, 5\\times 10^{-4}, 1.5\\times 10^{-5}, 100, 2.5908\\times 10^{-4})$, where $\\ell$ is chosen to satisfy $t_{\\ell} = 0.7\\,t_{\\mathrm{chem}}$ for the given $\\varepsilon$.\n\nYour program should produce a single line of output containing the integer regime classification codes for the cases, in order, as a comma-separated list enclosed in square brackets (for example, $[0,1,2]$). No other text should be printed. The outputs are integers without units. Ensure numerical computations are robust and follow the tie-breaking conventions precisely.",
            "solution": "The problem has been validated and is determined to be sound. It is scientifically grounded in the principles of turbulent combustion, self-contained with all necessary data and definitions, and well-posed, admitting a unique solution for each test case.\n\nThe task is to perform a parametric study classifying premixed flame regimes based on a simplified one-dimensional turbulence (ODT) model. The classification is determined by the values of two key dimensionless parameters: the Damköhler number ($Da$) and the Karlovitz number ($Ka$). These numbers are derived from a set of fundamental physical quantities.\n\nFirst, we define the relevant physical time scales.\nThe chemical time scale, $t_{\\mathrm{chem}}$, represents the time required for a laminar flame front to propagate across its own thickness. It is given by the ratio of the laminar flame thickness, $\\delta_L$, to the laminar flame speed, $s_L$:\n$$\nt_{\\mathrm{chem}} = \\frac{\\delta_L}{s_L}\n$$\nThe Kolmogorov time scale, $t_{\\eta}$, represents the turnover time of the smallest eddies in a turbulent flow, at which scale energy is dissipated into heat by viscosity. It is defined using the kinematic viscosity, $\\nu$, and the turbulent kinetic energy dissipation rate per unit mass, $\\varepsilon$:\n$$\nt_{\\eta} = \\sqrt{\\frac{\\nu}{\\varepsilon}}\n$$\nThe eddy turnover time, $t_{\\ell}$, represents the characteristic time for an eddy of size $\\ell$ within the inertial subrange of turbulence. It is defined as the ratio of the eddy size $\\ell$ to its characteristic velocity $u_{\\ell}$. Using Kolmogorov's scaling for the inertial subrange, $u_{\\ell} \\sim (\\varepsilon \\ell)^{1/3}$, the time scale is:\n$$\nt_{\\ell} = \\frac{\\ell}{u_{\\ell}} = \\frac{\\ell}{(\\varepsilon \\ell)^{1/3}} = \\ell^{2/3}\\varepsilon^{-1/3}\n$$\n\nUsing these time scales, we define the dimensionless numbers that govern the flame regime.\nThe Damköhler number, $Da$, is the ratio of the eddy turnover time to the chemical time scale. It compares the rate of turbulent mixing to the rate of chemical reaction.\n$$\nDa = \\frac{t_{\\ell}}{t_{\\mathrm{chem}}}\n$$\nThe Karlovitz number, $Ka$, is the ratio of the chemical time scale to the Kolmogorov time scale. It compares the flame thickness to the smallest turbulence scale, indicating whether the smallest eddies can penetrate and disrupt the flame's internal structure.\n$$\nKa = \\frac{t_{\\mathrm{chem}}}{t_{\\eta}}\n$$\n\nThe core of the problem is to implement a classification algorithm based on a set of rules applied to the computed $Da$ and $Ka$ values for each given parameter set $(s_L, \\delta_L, \\nu, \\varepsilon, \\ell)$. The classification rules and corresponding integer codes are:\n-   **Code $0$ (Flamelet):** Assigned if $Da \\ge 3$ and $Ka  1$. This regime corresponds to slow turbulence where the flame structure is largely undisturbed.\n-   **Code $1$ (Thin Reaction Zones):** Assigned if $Da \\ge 3$ and $Ka \\ge 1$. Here, turbulence is intense enough to broaden the preheat zone, but the thin inner reaction layer remains intact.\n-   **Code $2$ (Broken Reaction Zones):** Assigned if $0.7 \\le Da  3$ and $Ka \\ge 1$. The eddies are now fast enough to disrupt the reaction zone locally and temporarily.\n-   **Code $3$ (Distributed Reaction):** Assigned if $Da  0.7$ and $Ka \\ge 1$. Intense turbulence overwhelms the flame structure, leading to reactions occurring in a distributed volume.\n-   **Code $4$ (Well-Stirred Reactor):** Assigned if ($Da  0.7$ and $Ka  1$) or ($0.7 \\le Da  3$ and $Ka  1$). This is equivalent to the condition $Da  3$ and $Ka  1$. In this case, mixing is fast relative to reaction, but the turbulence scales are larger than the flame thickness, leading to a volumetrically uniform reaction state.\n\nThe tie-breaking rules are handled by implementing the inequalities precisely as stated: $Da \\ge 3$ includes $Da=3$, $0.7 \\le Da$ includes $Da=0.7$, and $Ka \\ge 1$ includes $Ka=1$.\n\nThe overall algorithm proceeds as follows for each test case:\n1.  Receive the input parameters $(s_L, \\delta_L, \\nu, \\varepsilon, \\ell)$, ensuring all are in SI units.\n2.  Calculate $t_{\\mathrm{chem}} = \\delta_L / s_L$.\n3.  Calculate $t_{\\eta} = \\sqrt{\\nu / \\varepsilon}$.\n4.  Calculate $t_{\\ell} = \\ell^{2/3}\\varepsilon^{-1/3}$.\n5.  Compute $Da = t_{\\ell} / t_{\\mathrm{chem}}$.\n6.  Compute $Ka = t_{\\mathrm{chem}} / t_{\\eta}$.\n7.  Apply a sequence of conditional statements (if-elif-else logic) that mirrors the classification rules to determine the integer code.\n8.  Collect the code for each test case and format the final output as specified.\n\nLet's illustrate with Case 1: $(s_L, \\delta_L, \\nu, \\varepsilon, \\ell) = (0.4, 5\\times 10^{-4}, 1.5\\times 10^{-5}, 1, 1\\times 10^{-2})$.\n-   $t_{\\mathrm{chem}} = (5 \\times 10^{-4}\\,\\mathrm{m}) / (0.4\\,\\mathrm{m/s}) = 1.25 \\times 10^{-3}\\,\\mathrm{s}$.\n-   $t_{\\eta} = \\sqrt{(1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}) / (1\\,\\mathrm{m^2/s^3})} \\approx 3.873 \\times 10^{-3}\\,\\mathrm{s}$.\n-   $t_{\\ell} = (1 \\times 10^{-2}\\,\\mathrm{m})^{2/3} \\times (1\\,\\mathrm{m^2/s^3})^{-1/3} \\approx 4.642 \\times 10^{-2}\\,\\mathrm{s}$.\n-   $Da = (4.642 \\times 10^{-2}\\,\\mathrm{s}) / (1.25 \\times 10^{-3}\\,\\mathrm{s}) \\approx 37.13$.\n-   $Ka = (1.25 \\times 10^{-3}\\,\\mathrm{s}) / (3.873 \\times 10^{-3}\\,\\mathrm{s}) \\approx 0.323$.\n-   Since $Da \\ge 3$ and $Ka  1$, the classification is Code $0$.\n\nThis procedure is systematically applied to all provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational parametric study for premixed flame regime classification.\n    \"\"\"\n\n    # Define the test cases from the problem statement as a list of tuples.\n    # Each tuple contains (s_L, delta_L, nu, epsilon, l) in SI units.\n    test_cases = [\n        # Case 1 (Flamelet regime, happy path)\n        (0.4, 5e-4, 1.5e-5, 1, 1e-2),\n        # Case 2 (Thin reaction zones, higher Ka with large Da)\n        (0.4, 5e-4, 1.5e-5, 100, 1e-2),\n        # Case 3 (Broken reaction zones, intermediate Da and Ka = 1)\n        (0.4, 5e-4, 1.5e-5, 500, 3e-3),\n        # Case 4 (Distributed reaction, low Da with large Ka)\n        (0.4, 5e-4, 1.5e-5, 1e4, 1e-3),\n        # Case 5 (Well-stirred reactor, both Da and Ka low via micro-eddy)\n        (0.4, 5e-4, 1.5e-5, 0.1, 1e-6),\n        # Case 6 (Boundary test, Ka = 1 exactly)\n        (0.4, 5e-4, 1.5e-5, 9.6, 1e-2),\n        # Case 7 (Boundary test, Da = 0.7 with Ka = 1)\n        (0.4, 5e-4, 1.5e-5, 100, 2.5908e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        result_code = classify_flame_regime(case)\n        results.append(result_code)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef classify_flame_regime(params):\n    \"\"\"\n    Calculates Da and Ka and returns the integer classification code for a single case.\n\n    Args:\n        params (tuple): A tuple of physical parameters (s_L, delta_L, nu, epsilon, l).\n\n    Returns:\n        int: The integer code representing the flame regime.\n    \"\"\"\n    s_L, delta_L, nu, epsilon, l = params\n\n    # 1. Calculate fundamental time scales\n    # Chemical time scale (laminar flame)\n    t_chem = delta_L / s_L\n    # Kolmogorov time scale (smallest eddies)\n    t_eta = np.sqrt(nu / epsilon)\n    # Eddy turnover time scale (inertial subrange)\n    t_l = np.power(l, 2/3) * np.power(epsilon, -1/3)\n\n    # 2. Calculate dimensionless numbers\n    # Damköhler number\n    Da = t_l / t_chem\n    # Karlovitz number\n    Ka = t_chem / t_eta\n\n    # 3. Apply classification rules with specified tie-breaking\n    # The rules are implemented to partition the Da-Ka space exhaustively.\n    # Tie-breaking: Ka=1 is treated as Ka=1; Da=3 as Da=3; Da=0.7 as Da=0.7.\n\n    if Ka  1:\n        if Da = 3:\n            # Code 0: Flamelet regime\n            return 0\n        else: # This covers Da  3\n            # Code 4: Well-Stirred Reactor regime\n            # This 'else' correctly implements the rule for Code 4 which is\n            # (Da  0.7 and Ka  1) OR (0.7 = Da  3 and Ka  1),\n            # which simplifies to (Da  3 and Ka  1).\n            return 4\n    else:  # This block handles Ka = 1\n        if Da = 3:\n            # Code 1: Thin Reaction Zones regime\n            return 1\n        elif Da = 0.7:  # This covers 0.7 = Da  3 due to the previous check\n            # Code 2: Broken Reaction Zones regime\n            return 2\n        else:  # This covers Da  0.7\n            # Code 3: Distributed Reaction regime\n            return 3\n\n# Execute the main function to run the parametric study and print the results.\nsolve()\n```"
        }
    ]
}