{
    "hands_on_practices": [
        {
            "introduction": "Understanding reactive mixing begins with mastering the interplay of convection and diffusion. This first exercise  tasks you with deriving the steady-state profile of a conserved scalar in a canonical one-dimensional mixing layer, a building block for many combustion models. By then calculating the scalar dissipation rate, $\\chi$, you will gain hands-on experience with a critical parameter that governs the rate of molecular mixing at the smallest scales.",
            "id": "4046540",
            "problem": "Consider one-dimensional reactive mixing modeled by a conserved mixture fraction $Z(x,t)$ in a counterflow mixing layer within computational combustion. Assume constant density and Fickian diffusion with constant molecular diffusivity $D$, and a steady, incompressible stagnation-point flow along the normal coordinate $x$ characterized by a uniform strain rate $S0$ producing a velocity field $u(x)=-Sx$. Starting from the conservation law for a passive scalar and using only the stated physical assumptions, do the following: (i) derive the steady ordinary differential equation for $Z(x)$, (ii) solve for $Z(x)$ subject to the boundary conditions $Z(-\\infty)=1$ and $Z(\\infty)=0$, and (iii) from the scalar variance budget, derive the local scalar dissipation rate $\\chi(x)$ in one spatial dimension with constant $D$ in terms of $Z(x)$. Then, using your derived expressions, evaluate the scalar dissipation rate at the mixing layer centerline $x=0$. Use the parameter values $S=120\\,\\text{s}^{-1}$ and $D=2.0\\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$. Express the final scalar dissipation rate at $x=0$ in $\\text{s}^{-1}$ and round your answer to four significant figures.",
            "solution": "The problem statement will first be validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **System**: One-dimensional reactive mixing in a counterflow mixing layer.\n- **Variable**: Conserved mixture fraction $Z(x,t)$.\n- **Physics**: Constant density, Fickian diffusion with constant molecular diffusivity $D$.\n- **Flow Field**: Steady, incompressible stagnation-point flow along the normal coordinate $x$.\n- **Velocity**: $u(x)=-Sx$, where $S  0$ is a uniform strain rate.\n- **Boundary Conditions**: $Z(-\\infty)=1$ and $Z(\\infty)=0$.\n- **Tasks**:\n  1. Derive the steady ordinary differential equation (ODE) for $Z(x)$.\n  2. Solve for $Z(x)$ subject to the given boundary conditions.\n  3. Derive the local scalar dissipation rate $\\chi(x)$ in one spatial dimension with constant $D$ from the scalar variance budget in terms of $Z(x)$.\n  4. Evaluate $\\chi(x)$ at the mixing layer centerline $x=0$.\n- **Parameters**: $S=120\\,\\text{s}^{-1}$ and $D=2.0\\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$.\n- **Output Specification**: The final answer for $\\chi(0)$ should be in units of $\\text{s}^{-1}$ and rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a canonical model in computational combustion and fluid dynamics, often used to study laminar diffusion flames or mixing layers. The assumptions and setup are standard for deriving an analytical solution.\n\n- **Scientifically Grounded**: The problem is based on the fundamental conservation law for a scalar quantity, incorporating Fickian diffusion and convection in a specified velocity field. The stagnation-point flow model is a well-established approximation for counterflow configurations. All aspects are firmly rooted in transport phenomena and combustion theory.\n- **Well-Posed**: The problem specifies a second-order ordinary differential equation with two boundary conditions, which constitutes a well-posed boundary value problem that admits a unique, stable solution.\n- **Objective**: The problem is stated using precise, standard scientific terminology and is free of any ambiguity or subjective claims.\n\nA potential point of confusion is the statement of an \"incompressible\" flow with a one-dimensional velocity field $u(x)=-Sx$, for which the divergence $du/dx = -S \\neq 0$. This apparent contradiction is resolved by recognizing that this 1D model is a simplification of a higher-dimensional flow, such as a 2D planar flow $\\mathbf{v} = (-Sx, Sy)$, for which the divergence $\\nabla \\cdot \\mathbf{v} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = -S + S = 0$. The model assumes that gradients of $Z$ in the transverse directions are negligible, a standard boundary-layer type approximation. The problem is therefore internally consistent and scientifically sound.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### (i) Derivation of the Steady ODE for $Z(x)$\n\nThe conservation law for a scalar quantity $Z$ in a one-dimensional domain is given by the advection-diffusion equation. For a constant-density (incompressible) flow, this equation is:\n$$ \\frac{\\partial Z}{\\partial t} + u \\frac{\\partial Z}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( D \\frac{\\partial Z}{\\partial x} \\right) $$\nThe problem specifies a steady-state condition, so the time derivative term is zero: $\\frac{\\partial Z}{\\partial t} = 0$. The equation becomes an ordinary differential equation in $x$:\n$$ u \\frac{dZ}{dx} = \\frac{d}{dx} \\left( D \\frac{dZ}{dx} \\right) $$\nWe are given a constant molecular diffusivity $D$ and a velocity field $u(x) = -Sx$. Substituting these into the equation yields:\n$$ (-Sx) \\frac{dZ}{dx} = D \\frac{d^2Z}{dx^2} $$\nRearranging the terms to the standard form for a linear second-order ODE, we get:\n$$ D \\frac{d^2Z}{dx^2} + Sx \\frac{dZ}{dx} = 0 $$\nThis is the required steady ordinary differential equation for the mixture fraction $Z(x)$.\n\n### (ii) Solution of the ODE for $Z(x)$\n\nThe ODE derived in part (i) is a second-order linear homogeneous equation with a variable coefficient. We can solve it by reduction of order. Let $Y(x) = \\frac{dZ}{dx}$. The ODE becomes a first-order equation for $Y$:\n$$ D \\frac{dY}{dx} + Sx Y = 0 $$\nThis is a separable equation:\n$$ D \\frac{dY}{dx} = -Sx Y $$\n$$ \\frac{dY}{Y} = -\\frac{S}{D} x \\, dx $$\nIntegrating both sides:\n$$ \\int \\frac{dY}{Y} = \\int -\\frac{S}{D} x \\, dx $$\n$$ \\ln(Y) = -\\frac{S}{D} \\frac{x^2}{2} + C_0 $$\nwhere $C_0$ is the constant of integration. Exponentiating both sides gives $Y(x)$:\n$$ Y(x) = \\exp\\left(-\\frac{S x^2}{2D} + C_0\\right) = C_1 \\exp\\left(-\\frac{S x^2}{2D}\\right) $$\nwhere $C_1 = \\exp(C_0)$ is a new constant. Now, we substitute back $Y(x) = \\frac{dZ}{dx}$ and integrate with respect to $x$ to find $Z(x)$:\n$$ \\frac{dZ}{dx} = C_1 \\exp\\left(-\\frac{S x^2}{2D}\\right) $$\n$$ Z(x) = \\int C_1 \\exp\\left(-\\frac{S x^2}{2D}\\right) dx + C_2 $$\nThe integral is related to the error function, $\\text{erf}(z) \\equiv \\frac{2}{\\sqrt{\\pi}} \\int_0^z \\exp(-t^2) dt$. Let the argument of the exponential be $-t^2$, so $t = x \\sqrt{\\frac{S}{2D}}$. Then $dx = \\sqrt{\\frac{2D}{S}} dt$. The integral becomes:\n$$ \\int \\exp\\left(-\\frac{S x^2}{2D}\\right) dx = \\sqrt{\\frac{2D}{S}} \\int \\exp(-t^2) dt = \\sqrt{\\frac{2D}{S}} \\left( \\frac{\\sqrt{\\pi}}{2} \\text{erf}(t) \\right) = \\sqrt{\\frac{D\\pi}{2S}} \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) $$\nSo, the general solution for $Z(x)$ is:\n$$ Z(x) = C_1 \\sqrt{\\frac{D\\pi}{2S}} \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) + C_2 $$\nLet's define new constants $A = C_1 \\sqrt{D\\pi/(2S)}$ and $B=C_2$ for simplicity:\n$$ Z(x) = A \\, \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) + B $$\nWe now apply the boundary conditions $Z(-\\infty)=1$ and $Z(\\infty)=0$, using the properties $\\text{erf}(\\infty)=1$ and $\\text{erf}(-\\infty)=-1$.\nFor $x \\rightarrow \\infty$:\n$$ Z(\\infty) = A(1) + B = 0 \\implies B = -A $$\nFor $x \\rightarrow -\\infty$:\n$$ Z(-\\infty) = A(-1) + B = 1 \\implies -A + B = 1 $$\nSubstituting $B = -A$ into the second equation:\n$$ -A + (-A) = 1 \\implies -2A = 1 \\implies A = -\\frac{1}{2} $$\nThis gives $B = -A = \\frac{1}{2}$.\nSubstituting the constants $A$ and $B$ back into the solution for $Z(x)$:\n$$ Z(x) = -\\frac{1}{2} \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right) + \\frac{1}{2} = \\frac{1}{2} \\left[1 - \\text{erf}\\left(x \\sqrt{\\frac{S}{2D}}\\right)\\right] $$\nThis solution can be expressed more compactly using the complementary error function, $\\text{erfc}(z) = 1 - \\text{erf}(z)$:\n$$ Z(x) = \\frac{1}{2} \\text{erfc}\\left(x \\sqrt{\\frac{S}{2D}}\\right) $$\n\n### (iii) Derivation of the Scalar Dissipation Rate $\\chi(x)$\n\nThe scalar dissipation rate, $\\chi$, is a measure of the rate at which scalar fluctuations are dissipated by molecular diffusion. For a one-dimensional system with constant diffusivity $D$, it is defined as:\n$$ \\chi(x) = 2D \\left(\\frac{dZ}{dx}\\right)^2 $$\nTo find $\\chi(x)$, we must first compute the derivative of $Z(x)$. Using the solution from part (ii) and the property $\\frac{d}{dz}(\\text{erfc}(z)) = -\\frac{2}{\\sqrt{\\pi}}\\exp(-z^2)$:\n$$ \\frac{dZ}{dx} = \\frac{d}{dx} \\left[ \\frac{1}{2} \\text{erfc}\\left(x \\sqrt{\\frac{S}{2D}}\\right) \\right] $$\nApplying the chain rule with the inner function $w(x) = x \\sqrt{\\frac{S}{2D}}$ and $\\frac{dw}{dx} = \\sqrt{\\frac{S}{2D}}$:\n$$ \\frac{dZ}{dx} = \\frac{1}{2} \\left[ -\\frac{2}{\\sqrt{\\pi}} \\exp\\left(-\\left(x\\sqrt{\\frac{S}{2D}}\\right)^2\\right) \\right] \\left( \\sqrt{\\frac{S}{2D}} \\right) $$\n$$ \\frac{dZ}{dx} = -\\frac{1}{\\sqrt{\\pi}} \\exp\\left(-\\frac{S x^2}{2D}\\right) \\sqrt{\\frac{S}{2D}} = -\\sqrt{\\frac{S}{2D\\pi}} \\exp\\left(-\\frac{S x^2}{2D}\\right) $$\nNow, we substitute this derivative into the definition of $\\chi(x)$:\n$$ \\chi(x) = 2D \\left[ -\\sqrt{\\frac{S}{2D\\pi}} \\exp\\left(-\\frac{S x^2}{2D}\\right) \\right]^2 $$\n$$ \\chi(x) = 2D \\left[ \\frac{S}{2D\\pi} \\exp\\left(-2 \\cdot \\frac{S x^2}{2D}\\right) \\right] $$\n$$ \\chi(x) = \\frac{S}{\\pi} \\exp\\left(-\\frac{S x^2}{D}\\right) $$\nThis expression gives the local scalar dissipation rate as a function of position $x$.\n\n### Evaluation of $\\chi(0)$\n\nThe problem asks for the scalar dissipation rate at the mixing layer centerline, which is located at $x=0$. At this point, $Z(0) = \\frac{1}{2}\\text{erfc}(0) = \\frac{1}{2}$. We evaluate $\\chi(x)$ at $x=0$:\n$$ \\chi(0) = \\frac{S}{\\pi} \\exp\\left(-\\frac{S (0)^2}{D}\\right) = \\frac{S}{\\pi} \\exp(0) = \\frac{S}{\\pi} $$\nNote that the value of $\\chi(0)$ depends only on the strain rate $S$, not on the diffusivity $D$.\nWe are given $S=120\\,\\text{s}^{-1}$. Substituting this value into the expression for $\\chi(0)$:\n$$ \\chi(0) = \\frac{120}{\\pi} \\, \\text{s}^{-1} $$\nNow, we compute the numerical value and round it to four significant figures:\n$$ \\chi(0) \\approx 38.197186... \\, \\text{s}^{-1} $$\nRounding to four significant figures gives:\n$$ \\chi(0) \\approx 38.20 \\, \\text{s}^{-1} $$",
            "answer": "$$\\boxed{38.20}$$"
        },
        {
            "introduction": "In operator-split schemes, the evolution due to chemical reactions is solved independently from transport processes. This practice  isolates such a reaction substep, modeling it as a homogeneous micro-reactor to explore the implications of stiff chemistry, where chemical timescales are vastly different from transport timescales. By solving a simple Arrhenius-rate ordinary differential equation and analyzing the stability of common numerical integrators, you will uncover the profound challenges that stiff source terms pose for numerical accuracy and stability.",
            "id": "4046527",
            "problem": "In the One-Dimensional Turbulence (ODT) model for reactive mixing in computational combustion, the reaction step in a small, well-mixed subdomain is often approximated as a spatially homogeneous, isothermal micro-reactor over a short time interval during which mixing and temperature remain approximately constant. Consider a single species mass fraction $Y(t)$ governed by an Arrhenius-type source term of the form $\\omega(Y,T)=A k \\exp\\!\\left(-\\frac{E}{R T}\\right) Y$, where $A$ and $k$ are positive lumped kinetic prefactors, $E$ is an activation energy, $R$ is the universal gas constant, and $T$ is the (assumed constant) temperature during the reaction substep. The temporal evolution during the reaction substep is modeled by the initial value problem\n$$\n\\frac{\\partial Y}{\\partial t}=\\omega(Y,T), \\quad Y(0)=Y_0,\n$$\nwith the understanding that $0\\leq Y_0 \\leq 1$ is the initial mass fraction prior to reaction and that the source term represents an autocatalytic production channel for $Y$ operative over the substep.\n\nStarting only from first principles of ordinary differential equations and the definition of the Arrhenius rate given above, derive the exact closed-form solution $Y(t)$ valid for all $t \\geq 0$ at fixed $T$. Then, using the scalar linear test equation framework applied to this problem, briefly discuss the stability behavior of forward Euler and backward Euler discretizations for a uniform time step $\\Delta t$ in terms of the real scalar $\\lambda \\equiv A k \\exp\\!\\left(-\\frac{E}{R T}\\right)$, and interpret the implications for stiffness handling in operator-split ODT reaction substeps.\n\nYour final answer should be the exact analytic expression for $Y(t)$ as a function of $Y_0$, $A$, $k$, $E$, $R$, $T$, and $t$. No rounding is required. Express the final answer without units.",
            "solution": "The problem requires the derivation of the exact solution to an initial value problem modeling autocatalytic production in a simplified chemical system, followed by an analysis of the numerical stability of common time-stepping schemes.\n\nFirst, we validate the problem statement.\nThe givens are:\n- The governing equation for the species mass fraction $Y(t)$: $\\frac{\\partial Y}{\\partial t}=\\omega(Y,T)$. Since $Y$ is a function of time only in this model, this is an ordinary differential equation, $\\frac{dY}{dt}=\\omega(Y,T)$.\n- The reaction source term: $\\omega(Y,T)=A k \\exp\\!\\left(-\\frac{E}{R T}\\right) Y$.\n- The initial condition: $Y(0)=Y_0$, with the constraint $0\\leq Y_0 \\leq 1$.\n- The parameters $A$, $k$, $E$, $R$, and $T$ are all positive constants, with $T$ being the fixed temperature of the micro-reactor.\nThe problem is scientifically grounded, employing a standard first-order Arrhenius kinetics model. It is a well-posed initial value problem for a linear ordinary differential equation, which guarantees a unique solution. The language is objective and the setup is complete and consistent. The problem is therefore deemed valid.\n\nWe now proceed to derive the solution. The governing equation is:\n$$\n\\frac{dY}{dt} = A k \\exp\\left(-\\frac{E}{R T}\\right) Y\n$$\nTo simplify the notation, we define a constant rate coefficient $\\lambda$, as all quantities on the right-hand side, except for $Y$, are constant for the duration of the reaction substep.\n$$\n\\lambda \\equiv A k \\exp\\left(-\\frac{E}{R T}\\right)\n$$\nSince $A  0$, $k  0$, and the exponential function yields a positive value for real arguments, it follows that $\\lambda$ is a positive real constant, $\\lambda  0$. The initial value problem can now be written in its canonical form:\n$$\n\\frac{dY}{dt} = \\lambda Y, \\quad Y(0) = Y_0\n$$\nThis is a first-order linear homogeneous ordinary differential equation. We solve it using the method of separation of variables. If $Y_0 = 0$, the trivial solution is $Y(t) = 0$ for all $t \\geq 0$. If $Y_0  0$, we can divide by $Y$:\n$$\n\\frac{1}{Y} dY = \\lambda dt\n$$\nWe integrate both sides of the equation from the initial state at $t=0$ to an arbitrary time $t$:\n$$\n\\int_{Y_0}^{Y(t)} \\frac{1}{y} dy = \\int_0^t \\lambda d\\tau\n$$\nEvaluating the integrals yields:\n$$\n[\\ln|y|]_{Y_0}^{Y(t)} = [\\lambda\\tau]_0^t\n$$\n$$\n\\ln|Y(t)| - \\ln|Y_0| = \\lambda t\n$$\nSince the mass fraction $Y$ is a non-negative quantity, and given that $Y_0  0$ and $\\lambda  0$ (which implies $dY/dt  0$), $Y(t)$ will remain positive for all $t \\geq 0$. Therefore, the absolute value signs can be removed.\n$$\n\\ln(Y(t)) - \\ln(Y_0) = \\lambda t\n$$\nUsing the property of logarithms, $\\ln(a) - \\ln(b) = \\ln(a/b)$, we have:\n$$\n\\ln\\left(\\frac{Y(t)}{Y_0}\\right) = \\lambda t\n$$\nTo solve for $Y(t)$, we exponentiate both sides:\n$$\n\\frac{Y(t)}{Y_0} = \\exp(\\lambda t)\n$$\nThis gives the final form of the solution:\n$$\nY(t) = Y_0 \\exp(\\lambda t)\n$$\nSubstituting the definition of $\\lambda$ back into the equation, we obtain the exact closed-form solution in terms of the original parameters:\n$$\nY(t) = Y_0 \\exp\\left(A k t \\exp\\left(-\\frac{E}{R T}\\right)\\right)\n$$\nThis solution shows exponential growth, which is characteristic of the modeled autocatalytic production process.\n\nNext, we briefly discuss the stability of the forward Euler and backward Euler methods for this problem. The governing ODE, $Y' = \\lambda Y$ with $\\lambda  0$, serves as the test equation. The stability of a numerical scheme is assessed by its amplification factor $G$, where $Y_{n+1} = G Y_n$. The standard analysis of absolute stability, which requires $|G| \\leq 1$, is designed for problems where the true solution decays (i.e., $\\text{Re}(\\lambda)0$). For our problem where the solution grows, this criterion must be interpreted with caution.\n\nFor the forward Euler (explicit) method, the numerical scheme is $Y_{n+1} = Y_n + \\Delta t (\\lambda Y_n)$. The amplification factor is:\n$$\nG_{FE} = 1 + \\lambda \\Delta t\n$$\nSince $\\lambda  0$ and $\\Delta t  0$, we have $G_{FE}  1$. The method is unconditionally unstable in the formal sense (the stability region $|1 + z| \\leq 1$ for $z=\\lambda\\Delta t$ does not include any part of the positive real axis). While the numerical solution grows, which is qualitatively correct, the numerical error also grows exponentially.\n\nFor the backward Euler (implicit) method, the scheme is $Y_{n+1} = Y_n + \\Delta t (\\lambda Y_{n+1})$, which rearranges to $Y_{n+1} = (1 - \\lambda \\Delta t)^{-1} Y_n$. The amplification factor is:\n$$\nG_{BE} = \\frac{1}{1 - \\lambda \\Delta t}\n$$\nThe behavior of this method is highly sensitive to the dimensionless time step $\\lambda \\Delta t$:\n\\begin{itemize}\n    \\item For $0  \\lambda \\Delta t  1$, $G_{BE}  1$, and the numerical solution grows monotonically, which is physically correct.\n    \\item At $\\lambda \\Delta t = 1$, the denominator vanishes and the method fails.\n    \\item For $1  \\lambda \\Delta t  2$, $G_{BE}  -1$, leading to unphysical oscillatory growth.\n    \\item For $\\lambda \\Delta t \\ge 2$, $|G_{BE}| \\le 1$. The method is \"stable\" in the absolute stability sense, but yields a physically incorrect decaying or non-growing oscillatory solution while the true solution grows exponentially.\n\\end{itemize}\n\nThe implication for stiffness in ODT reaction substeps is profound. Stiff chemistry is characterized by very large rate coefficients, meaning $\\lambda$ can be very large. The analysis reveals that for such problems with stiff *production* chemistry, neither simple method is robust for large time steps. Forward Euler is unstable. Backward Euler, despite being A-stable (a property for decaying systems), gives qualitatively wrong physical predictions for $\\lambda\\Delta t \\geq 1$. Therefore, operator-split reaction substeps must use time steps that resolve the chemical dynamics (i.e., satisfy $\\lambda \\Delta t  1$), even when using an implicit integrator. This highlights the severe challenge posed by stiff source terms and shows that the unconditional stability of implicit methods for decaying problems does not translate to physical correctness for growing solutions.",
            "answer": "$$\n\\boxed{Y_0 \\exp\\left(A k t \\exp\\left(-\\frac{E}{R T}\\right)\\right)}\n$$"
        },
        {
            "introduction": "Having examined mixing and reaction in isolation, we now address the error inherent in coupling them via operator splitting. The accuracy of this powerful technique depends on the non-commutativity of the diffusion and reaction operators, represented by the commutator $[\\mathcal{D},\\mathcal{R}]$. This final exercise  provides a direct method to quantify this splitting error, guiding you from the abstract theory of operator commutators to a concrete numerical estimate for a discretized reaction-diffusion system.",
            "id": "4046415",
            "problem": "Consider a single-species, isothermal reactive mixing problem in one spatial dimension representative of the One-Dimensional Turbulence (ODT) modeling framework in computational combustion. The species mass fraction $Y(x,t)$ evolves under the semilinear reaction–diffusion equation\n$$\n\\frac{\\partial Y}{\\partial t} \\;=\\; \\kappa\\,\\frac{\\partial^{2}Y}{\\partial x^{2}} \\;+\\; \\omega(Y),\n$$\nwhere $\\kappa0$ is the molecular diffusivity and $\\omega(Y)$ is the reaction source term. In regimes where the characteristic chemical time scale $\\tau_{\\text{chem}}$ is much smaller than the diffusive time scale $\\tau_{\\text{diff}}$ (i.e., $\\tau_{\\text{chem}}\\ll\\tau_{\\text{diff}}$), an operator-splitting integrator with reaction subcycling is employed over a macro-step of size $\\Delta t$: the reaction subproblem is advanced in $N$ substeps of size $\\delta t=\\Delta t/N$ (assume the reaction substeps are integrated exactly), while the diffusion subproblem is advanced once per macro-step. The Lie-split macro-step is\n$$\n\\text{Lie}(\\Delta t):\\quad Y^{n+1}\\;=\\;\\Phi_{\\mathcal{D}}(\\Delta t)\\,\\Phi_{\\mathcal{R}}(\\Delta t)\\,Y^{n},\n$$\nwhere $\\Phi_{\\mathcal{D}}(\\Delta t)$ and $\\Phi_{\\mathcal{R}}(\\Delta t)$ denote the exact solution operators of the diffusion and reaction subproblems over $\\Delta t$, respectively. The exact unsplit evolution over the same interval is denoted by $\\Phi_{\\mathcal{L}}(\\Delta t)$ for the full generator $\\mathcal{L}=\\mathcal{D}+\\mathcal{R}$.\n\nStarting from the fundamental reaction–diffusion equation and the definition of the Lie product, derive the leading-order local splitting error over one macro-step in terms of the commutator $[\\mathcal{D},\\mathcal{R}]$ and an operator norm. Explicitly justify why reaction subcycling (with exact reaction integration in each substep) in the limit $\\tau_{\\text{chem}}\\ll\\tau_{\\text{diff}}$ does not change the leading-order splitting error term.\n\nThen, quantify this bound in a concrete discretized setting as follows. Let the spatial domain be periodic with length $L$ and discretized into $M$ equally spaced nodes. Use a second-order centered finite-difference Laplacian to define the discrete diffusion operator $\\mathbf{D}=\\kappa \\mathbf{L}$ acting on the vector of nodal mass fractions $\\mathbf{Y}$. Linearize the reaction source term around the current state $\\mathbf{Y}^{n}$ to define the diagonal Jacobian operator $\\mathbf{R}=\\mathrm{diag}\\left(\\omega'(Y_{1}^{n}),\\dots,\\omega'(Y_{M}^{n})\\right)$, and use the matrix commutator $[\\mathbf{D},\\mathbf{R}]=\\mathbf{D}\\mathbf{R}-\\mathbf{R}\\mathbf{D}$ to bound the local splitting error operator.\n\nCompute the Frobenius norm of the commutator and the corresponding leading-order bound on the local splitting error operator for the following scientifically consistent parameter set:\n- $L=0.03$ (meters), $M=3$ so that $h=L/M$,\n- $\\kappa=1.0\\times 10^{-4}$ (square meters per second),\n- $\\omega(Y)=k\\,Y\\,(1-Y)$ with $k=1.0\\times 10^{3}$ (inverse seconds),\n- $\\mathbf{Y}^{n}=\\bigl[0.2,\\;0.5,\\;0.8\\bigr]^{\\mathsf{T}}$,\n- $\\Delta t=0.01$ (seconds),\n- periodic boundary conditions so that the discrete Laplacian is $\\mathbf{L}=\\frac{1}{h^{2}}\\begin{pmatrix}-2  1  1 \\\\ 1  -2  1 \\\\ 1  1  -2\\end{pmatrix}$.\n\nUse the Frobenius norm to produce a conservative upper bound on the operator error after one Lie-split macro-step,\n$$\n\\left\\|\\Phi_{\\mathcal{D}}(\\Delta t)\\,\\Phi_{\\mathcal{R}}(\\Delta t)-\\Phi_{\\mathcal{L}}(\\Delta t)\\right\\| \\;\\lesssim\\; \\frac{1}{2}\\,\\Delta t^{2}\\,\\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F},\n$$\nand provide the final numerical value of the right-hand side for the given parameters. Round your final answer to four significant figures and express it as a mass fraction (dimensionless).",
            "solution": "The problem asks for two tasks: first, to derive the leading-order local splitting error for a Lie-split integrator and justify the role of reaction subcycling; second, to quantify this error for a specific discretized reaction-diffusion system.\n\nFirst, we address the theoretical derivation of the local splitting error. The governing semilinear reaction–diffusion equation is given by\n$$ \\frac{\\partial Y}{\\partial t} \\;=\\; \\kappa\\,\\frac{\\partial^{2}Y}{\\partial x^{2}} \\;+\\; \\omega(Y) \\;=\\; (\\mathcal{D} + \\mathcal{R})Y \\;=\\; \\mathcal{L}Y $$\nwhere $\\mathcal{D} = \\kappa \\frac{\\partial^2}{\\partial x^2}$ and $\\mathcal{R}$ is the operator corresponding to multiplication by the reaction source term $\\omega(\\cdot)$. The exact solution over a time step of size $\\Delta t$ can be formally written using the solution operator $\\Phi_{\\mathcal{L}}(\\Delta t) = \\exp(\\mathcal{L}\\Delta t)$.\n\nA Taylor series expansion of the exact operator in $\\Delta t$ yields:\n$$ \\Phi_{\\mathcal{L}}(\\Delta t) = \\exp((\\mathcal{D}+\\mathcal{R})\\Delta t) = I + (\\mathcal{D}+\\mathcal{R})\\Delta t + \\frac{1}{2}(\\mathcal{D}+\\mathcal{R})^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\nExpanding the second-order term gives:\n$$ \\Phi_{\\mathcal{L}}(\\Delta t) = I + (\\mathcal{D}+\\mathcal{R})\\Delta t + \\frac{1}{2}(\\mathcal{D}^{2} + \\mathcal{D}\\mathcal{R} + \\mathcal{R}\\mathcal{D} + \\mathcal{R}^{2})\\Delta t^{2} + O(\\Delta t^{3}) $$\nThe Lie-split approximation is given by the product of the individual exact solution operators, $\\Phi_{\\mathcal{D}}(\\Delta t)\\Phi_{\\mathcal{R}}(\\Delta t) = \\exp(\\mathcal{D}\\Delta t)\\exp(\\mathcal{R}\\Delta t)$. Expanding each exponential operator separately:\n$$ \\exp(\\mathcal{D}\\Delta t) = I + \\mathcal{D}\\Delta t + \\frac{1}{2}\\mathcal{D}^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\n$$ \\exp(\\mathcal{R}\\Delta t) = I + \\mathcal{R}\\Delta t + \\frac{1}{2}\\mathcal{R}^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\nMultiplying these two series and retaining terms up to order $\\Delta t^2$:\n$$ \\Phi_{\\mathcal{D}}(\\Delta t)\\Phi_{\\mathcal{R}}(\\Delta t) = \\left(I + \\mathcal{D}\\Delta t + \\frac{1}{2}\\mathcal{D}^{2}\\Delta t^{2}\\right) \\left(I + \\mathcal{R}\\Delta t + \\frac{1}{2}\\mathcal{R}^{2}\\Delta t^{2}\\right) + O(\\Delta t^{3}) $$\n$$ = I + \\mathcal{R}\\Delta t + \\frac{1}{2}\\mathcal{R}^{2}\\Delta t^{2} + \\mathcal{D}\\Delta t + \\mathcal{D}\\mathcal{R}\\Delta t^{2} + \\frac{1}{2}\\mathcal{D}^{2}\\Delta t^{2} + O(\\Delta t^{3}) $$\n$$ = I + (\\mathcal{D}+\\mathcal{R})\\Delta t + \\frac{1}{2}(\\mathcal{D}^{2} + 2\\mathcal{D}\\mathcal{R} + \\mathcal{R}^{2})\\Delta t^{2} + O(\\Delta t^{3}) $$\nThe local splitting error operator, $E(\\Delta t)$, is the difference between the split and exact solution operators:\n$$ E(\\Delta t) = \\Phi_{\\mathcal{D}}(\\Delta t)\\Phi_{\\mathcal{R}}(\\Delta t) - \\Phi_{\\mathcal{L}}(\\Delta t) $$\n$$ = \\left[\\frac{1}{2}(\\mathcal{D}^{2} + 2\\mathcal{D}\\mathcal{R} + \\mathcal{R}^{2})\\right]\\Delta t^{2} - \\left[\\frac{1}{2}(\\mathcal{D}^{2} + \\mathcal{D}\\mathcal{R} + \\mathcal{R}\\mathcal{D} + \\mathcal{R}^{2})\\right]\\Delta t^{2} + O(\\Delta t^{3})$$\n$$ = \\frac{1}{2}(2\\mathcal{D}\\mathcal{R} - \\mathcal{D}\\mathcal{R} - \\mathcal{R}\\mathcal{D})\\Delta t^{2} + O(\\Delta t^{3}) $$\n$$ = \\frac{1}{2}(\\mathcal{D}\\mathcal{R} - \\mathcal{R}\\mathcal{D})\\Delta t^{2} + O(\\Delta t^{3}) = \\frac{1}{2}[\\mathcal{D},\\mathcal{R}]\\Delta t^{2} + O(\\Delta t^{3}) $$\nThe leading-order local splitting error is thus proportional to the commutator of the operators, $[\\mathcal{D},\\mathcal{R}]$, and is of second order in $\\Delta t$.\n\nRegarding reaction subcycling, the problem states that the reaction subproblem is integrated exactly in each of the $N$ substeps of size $\\delta t = \\Delta t/N$. The operator for the full reaction step, $\\Phi_{\\mathcal{R}}(\\Delta t)$, represents the exact solution of the ODE subproblem $\\frac{dY}{dt}=\\omega(Y)$ over $\\Delta t$. Because this ODE is autonomous in time, its exact solution operator possesses the semigroup property: $\\Phi_{\\mathcal{R}}(t_1 + t_2) = \\Phi_{\\mathcal{R}}(t_1)\\Phi_{\\mathcal{R}}(t_2)$. Therefore, the composition of $N$ exact integrations over $\\delta t$ yields:\n$$ \\underbrace{\\Phi_{\\mathcal{R}}(\\delta t) \\circ \\dots \\circ \\Phi_{\\mathcal{R}}(\\delta t)}_{N \\text{ times}} = \\Phi_{\\mathcal{R}}(N\\delta t) = \\Phi_{\\mathcal{R}}(\\Delta t) $$\nSince the subcycling procedure, under the assumption of exactness in each substep, reconstructs the identical exact operator $\\Phi_{\\mathcal{R}}(\\Delta t)$, it does not alter the derivation of the splitting error. The splitting error is an inherent consequence of the non-commutativity of the continuous operators $\\mathcal{D}$ and $\\mathcal{R}$, not the method used to implement their respective sub-integrations (provided they are exact).\n\nNext, we quantify the leading-order error bound for the given discretized system.\nThe parameters are:\n- $L = 0.03$ m\n- $M = 3$ nodes\n- Grid spacing $h = L/M = 0.03/3 = 0.01$ m\n- Diffusivity $\\kappa = 1.0 \\times 10^{-4}$ m$^2$/s\n- Reaction $\\omega(Y) = k\\,Y\\,(1-Y)$ with $k = 1.0 \\times 10^3$ s$^{-1}$\n- State vector $\\mathbf{Y}^{n} = [0.2, 0.5, 0.8]^{\\mathsf{T}}$\n- Time step $\\Delta t = 0.01$ s\n\nThe discrete diffusion operator is $\\mathbf{D} = \\kappa \\mathbf{L}$, where $\\mathbf{L} = \\frac{1}{h^2}\\begin{pmatrix}-2  1  1\\\\ 1  -2  1\\\\ 1  1  -2\\end{pmatrix}$.\nThe prefactor is $\\frac{\\kappa}{h^2} = \\frac{1.0 \\times 10^{-4} \\text{ m}^2/\\text{s}}{(0.01 \\text{ m})^2} = \\frac{1.0 \\times 10^{-4}}{1.0 \\times 10^{-4}}$ s$^{-1} = 1.0$ s$^{-1}$.\nThus, the diffusion matrix is:\n$$ \\mathbf{D} = 1.0 \\times \\begin{pmatrix}-2  1  1\\\\ 1  -2  1\\\\ 1  1  -2\\end{pmatrix} = \\begin{pmatrix}-2  1  1\\\\ 1  -2  1\\\\ 1  1  -2\\end{pmatrix} \\text{ s}^{-1} $$\nThe discrete reaction operator is the Jacobian $\\mathbf{R} = \\mathrm{diag}(\\omega'(Y_{1}^{n}), \\omega'(Y_{2}^{n}), \\omega'(Y_{3}^{n}))$.\nFirst, we find the derivative $\\omega'(Y) = \\frac{d}{dY}(kY - kY^2) = k - 2kY = k(1-2Y)$.\nWe evaluate this at the nodal values of $\\mathbf{Y}^{n}$ with $k=1000$ s$^{-1}$:\n- $\\omega'(Y_{1}^{n}) = \\omega'(0.2) = 1000(1 - 2 \\times 0.2) = 1000(0.6) = 600$ s$^{-1}$\n- $\\omega'(Y_{2}^{n}) = \\omega'(0.5) = 1000(1 - 2 \\times 0.5) = 1000(0) = 0$ s$^{-1}$\n- $\\omega'(Y_{3}^{n}) = \\omega'(0.8) = 1000(1 - 2 \\times 0.8) = 1000(-0.6) = -600$ s$^{-1}$\nThe reaction matrix is:\n$$ \\mathbf{R} = \\begin{pmatrix} 600  0  0 \\\\ 0  0  0 \\\\ 0  0  -600 \\end{pmatrix} \\text{ s}^{-1} $$\nNow we compute the commutator $[\\mathbf{D}, \\mathbf{R}] = \\mathbf{D}\\mathbf{R} - \\mathbf{R}\\mathbf{D}$.\n$$ \\mathbf{D}\\mathbf{R} = \\begin{pmatrix}-2  1  1\\\\ 1  -2  1\\\\ 1  1  -2\\end{pmatrix} \\begin{pmatrix} 600  0  0 \\\\ 0  0  0 \\\\ 0  0  -600 \\end{pmatrix} = \\begin{pmatrix} -1200  0  -600 \\\\ 600  0  -600 \\\\ 600  0  1200 \\end{pmatrix} $$\n$$ \\mathbf{R}\\mathbf{D} = \\begin{pmatrix} 600  0  0 \\\\ 0  0  0 \\\\ 0  0  -600 \\end{pmatrix} \\begin{pmatrix}-2  1  1\\\\ 1  -2  1\\\\ 1  1  -2\\end{pmatrix} = \\begin{pmatrix} -1200  600  600 \\\\ 0  0  0 \\\\ -600  -600  1200 \\end{pmatrix} $$\n$$ [\\mathbf{D}, \\mathbf{R}] = \\begin{pmatrix} -1200  0  -600 \\\\ 600  0  -600 \\\\ 600  0  1200 \\end{pmatrix} - \\begin{pmatrix} -1200  600  600 \\\\ 0  0  0 \\\\ -600  -600  1200 \\end{pmatrix} = \\begin{pmatrix} 0  -600  -1200 \\\\ 600  0  -600 \\\\ 1200  600  0 \\end{pmatrix} \\text{ s}^{-2} $$\nNext, we compute the Frobenius norm of the commutator, $\\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F} = \\sqrt{\\sum_{i,j} |c_{ij}|^2}$.\n$$ \\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F}^2 = 0^2 + (-600)^2 + (-1200)^2 + 600^2 + 0^2 + (-600)^2 + 1200^2 + 600^2 + 0^2 $$\n$$ = 2 \\times (600^2 + 1200^2 + 600^2) = 4 \\times 600^2 + 2 \\times 1200^2 $$\n$$ = 4 \\times (3.6 \\times 10^5) + 2 \\times (1.44 \\times 10^6) = 1.44 \\times 10^6 + 2.88 \\times 10^6 = 4.32 \\times 10^6 \\text{ s}^{-4} $$\n$$ \\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F} = \\sqrt{4.32 \\times 10^6} = \\sqrt{432} \\times 10^2 = \\sqrt{144 \\times 3} \\times 10^2 = 12\\sqrt{3} \\times 10^2 = 1200\\sqrt{3} \\text{ s}^{-2} $$\nFinally, we compute the numerical value of the leading-order error bound:\n$$ \\text{Error Bound} = \\frac{1}{2}\\,\\Delta t^{2}\\,\\bigl\\|[\\mathbf{D},\\mathbf{R}]\\bigr\\|_{F} $$\n$$ = \\frac{1}{2}(0.01 \\text{ s})^2 (1200\\sqrt{3} \\text{ s}^{-2}) = \\frac{1}{2}(10^{-4} \\text{ s}^2) (1200\\sqrt{3} \\text{ s}^{-2}) $$\n$$ = 600 \\times 10^{-4} \\sqrt{3} = 0.06\\sqrt{3} $$\nThis quantity is dimensionless, as expected for an operator acting on the dimensionless mass fraction vector.\nNumerically evaluating and rounding to four significant figures:\n$$ 0.06\\sqrt{3} \\approx 0.06 \\times 1.7320508 \\approx 0.103923048 \\approx 0.1039 $$",
            "answer": "$$\n\\boxed{0.1039}\n$$"
        }
    ]
}