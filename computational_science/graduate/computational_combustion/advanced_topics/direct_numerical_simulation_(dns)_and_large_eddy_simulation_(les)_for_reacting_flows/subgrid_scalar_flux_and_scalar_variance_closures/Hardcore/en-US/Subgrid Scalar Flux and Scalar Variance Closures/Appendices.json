{
    "hands_on_practices": [
        {
            "introduction": "In Large-Eddy Simulation (LES) of turbulent reacting flows, the subgrid scalar variance, $\\widetilde{Z'^2}$, is a critical quantity that requires a closure model. This foundational exercise guides you through the derivation of a simple yet powerful algebraic model for this variance . By working through the hypothetical scenario of a local equilibrium between the production and dissipation of $\\widetilde{Z'^2}$, you will see how this quantity can be directly related to the resolved scalar gradients, providing a practical and computationally inexpensive closure.",
            "id": "4068908",
            "problem": "Consider a high-Reynolds-number, axisymmetric, non-premixed jet flame simulated using Large-Eddy Simulation (LES; Large-Eddy Simulation). Let the conserved mixture fraction be denoted by $Z(\\boldsymbol{x},t)$, its spatially filtered counterpart by $\\tilde{Z}(\\boldsymbol{x},t)$, and the corresponding subgrid-scale variance by $\\widetilde{Z'^2}(\\boldsymbol{x},t) \\equiv \\widetilde{(Z - \\tilde{Z})^2}$. Assume a statistically steady, locally homogeneous region of the jet in which the filtered scalar variance transport simplifies to a balance between production and dissipation. Use the following foundational elements:\n- Conservation of a passive scalar in a turbulent flow and its filtered (LES) form.\n- The gradient-diffusion hypothesis for subgrid scalar flux, $\\widetilde{u_i' Z'} = - D_t \\,\\partial_i \\tilde{Z}$, where $D_t$ is the turbulent diffusivity and $\\partial_i$ denotes $\\partial / \\partial x_i$.\n- The standard eddy-viscosity-based closure for subgrid-scale dissipation of scalar variance, $\\epsilon_Z = C_{\\epsilon,Z}\\,\\dfrac{D_t}{\\Delta^2}\\,\\widetilde{Z'^2}$, where $C_{\\epsilon,Z}$ is a dimensionless model constant and $\\Delta$ is the LES filter width.\n\nStarting from these bases and assuming a steady balance $P_Z = \\epsilon_Z$ between production $P_Z$ and dissipation $\\epsilon_Z$ of $\\widetilde{Z'^2}$, derive the steady-state approximation for $\\widetilde{Z'^2}$ in terms of $D_t$, $\\Delta$, and $|\\nabla \\tilde{Z}|$, where $|\\nabla \\tilde{Z}| \\equiv \\sqrt{\\partial_i \\tilde{Z}\\,\\partial_i \\tilde{Z}}$. Express your final answer as a single closed-form analytic expression. No numerical evaluation is required.",
            "solution": "The posed problem requires the derivation of an algebraic expression for the subgrid-scale (SGS) scalar variance, denoted by $\\widetilde{Z'^2}$, from first principles within the context of Large-Eddy Simulation (LES). The derivation will be based on the provided models and the key assumption of a local equilibrium between the production and dissipation of this variance.\n\nThe problem is validated as scientifically grounded, well-posed, and objective. All provided information consists of standard definitions and models from the field of turbulent combustion modeling, forming a self-contained and logical basis for a derivation.\n\nThe central premise is the steady-state balance in the transport equation for the filtered scalar variance, where production equals dissipation:\n$$\nP_Z = \\epsilon_Z\n$$\nHere, $P_Z$ is the rate of production of SGS scalar variance, and $\\epsilon_Z$ is its rate of dissipation. Our task is to find expressions for $P_Z$ and $\\epsilon_Z$ based on the given information and then solve for $\\widetilde{Z'^2}$.\n\nFirst, we establish the expression for the production term, $P_Z$. The transport equation for the SGS scalar variance, $\\widetilde{Z'^2}$, can be rigorously derived from the filtered transport equation of the scalar $Z$. The term responsible for the production of $\\widetilde{Z'^2}$ arises from the interaction of the SGS scalar flux, $\\widetilde{u_i'Z'}$, with the resolved scalar gradient, $\\partial_i \\tilde{Z}$. The standard form of this production term is:\n$$\nP_Z = -2 \\widetilde{u_i' Z'} \\frac{\\partial \\tilde{Z}}{\\partial x_i}\n$$\nHere, the summation convention over the repeated index $i$ is implied. This term represents the transfer of scalar variance from the resolved scales (characterized by $\\nabla \\tilde{Z}$) to the subgrid scales.\n\nThe problem provides the gradient-diffusion hypothesis to model the SGS scalar flux:\n$$\n\\widetilde{u_i' Z'} = - D_t \\frac{\\partial \\tilde{Z}}{\\partial x_i}\n$$\nwhere $D_t$ is the turbulent (or eddy) diffusivity. Substituting this closure model into the expression for $P_Z$ yields:\n$$\nP_Z = -2 \\left( -D_t \\frac{\\partial \\tilde{Z}}{\\partial x_i} \\right) \\frac{\\partial \\tilde{Z}}{\\partial x_i}\n$$\nThis simplifies to:\n$$\nP_Z = 2 D_t \\left( \\frac{\\partial \\tilde{Z}}{\\partial x_i} \\frac{\\partial \\tilde{Z}}{\\partial x_i} \\right)\n$$\nThe term in parentheses is the squared magnitude of the resolved scalar gradient. Using the notation provided in the problem statement, $|\\nabla \\tilde{Z}| \\equiv \\sqrt{\\partial_i \\tilde{Z}\\,\\partial_i \\tilde{Z}}$, we can write its square as $|\\nabla \\tilde{Z}|^2 = \\partial_i \\tilde{Z}\\,\\partial_i \\tilde{Z}$. The final expression for the production term is therefore:\n$$\nP_Z = 2 D_t |\\nabla \\tilde{Z}|^2\n$$\n\nNext, we consider the dissipation term, $\\epsilon_Z$. The problem explicitly provides a standard eddy-viscosity-based closure for the SGS scalar variance dissipation:\n$$\n\\epsilon_Z = C_{\\epsilon,Z}\\,\\frac{D_t}{\\Delta^2}\\,\\widetilde{Z'^2}\n$$\nwhere $C_{\\epsilon,Z}$ is a dimensionless model constant and $\\Delta$ is the LES filter width. This model posits that the dissipation rate is proportional to the SGS variance itself and inversely proportional to a characteristic time scale of the subgrid eddies, $\\tau_{sgs} \\sim \\Delta^2 / D_t$.\n\nNow, we enforce the local equilibrium assumption, $P_Z = \\epsilon_Z$, by equating the derived expression for production and the given expression for dissipation:\n$$\n2 D_t |\\nabla \\tilde{Z}|^2 = C_{\\epsilon,Z}\\,\\frac{D_t}{\\Delta^2}\\,\\widetilde{Z'^2}\n$$\nOur goal is to solve this equation for $\\widetilde{Z'^2}$. We can observe that the turbulent diffusivity, $D_t$, appears on both sides of the equation. Assuming a turbulent flow where $D_t \\neq 0$, we can divide both sides by $D_t$:\n$$\n2 |\\nabla \\tilde{Z}|^2 = \\frac{C_{\\epsilon,Z}}{\\Delta^2}\\,\\widetilde{Z'^2}\n$$\nIt is a crucial outcome of this derivation that the dependency on the turbulent diffusivity $D_t$ cancels. This implies that under the assumption of local equilibrium, the SGS variance can be determined algebraically from the resolved scalar field and the filter scale, without explicit knowledge of the SGS transport coefficient $D_t$.\n\nFinally, we rearrange the equation algebraically to isolate $\\widetilde{Z'^2}$:\n$$\n\\widetilde{Z'^2} = \\frac{2 \\Delta^2}{C_{\\epsilon,Z}} |\\nabla \\tilde{Z}|^2\n$$\nThis expression provides a closed-form algebraic model for the subgrid-scale scalar variance. It is expressed entirely in terms of the LES filter width $\\Delta$, the model constant $C_{\\epsilon,Z}$, and the magnitude of the resolved scalar gradient $|\\nabla \\tilde{Z}|$, as required. This type of algebraic model is fundamental in many advanced LES closure strategies, including dynamic procedures.",
            "answer": "$$\n\\boxed{\\frac{2 \\Delta^2}{C_{\\epsilon,Z}} |\\nabla \\tilde{Z}|^2}\n$$"
        },
        {
            "introduction": "While simple closures for subgrid fluxes are instructive, their predictive power hinges on the turbulent transport coefficients, namely the eddy viscosity $\\nu_t$ and turbulent diffusivity $D_t$. This practice moves beyond fixed coefficients by having you implement the dynamic Smagorinsky procedure from first principles . You will use the Germano identity, a fundamental relation in LES, to dynamically determine the model coefficient from the resolved velocity field, a technique that provides a more physically robust basis for modeling subgrid-scale transport.",
            "id": "4068962",
            "problem": "Consider a three-dimensional, periodic, incompressible flow field filtered for Large-Eddy Simulation (LES) on a uniform Cartesian grid with grid spacing $\\Delta$ (in meters). The goal is to implement the dynamic procedure for the Smagorinsky eddy-viscosity model and use it to compute the turbulent diffusivity $D_t = \\nu_t / Sc_t$, then assess the robustness of the dynamically computed coefficient with respect to the choice of test-filter. The implementation must be from first principles starting from the filtered equations and basic definitions.\n\nFundamental base and definitions required:\n- The filtered velocity field $\\tilde{u}_i(x)$ yields the resolved strain-rate tensor $S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\tilde{u}_i}{\\partial x_j} + \\frac{\\partial \\tilde{u}_j}{\\partial x_i}\\right)$ and the strain-rate magnitude $|S| = \\sqrt{2 S_{ij} S_{ij}}$ where repeated indices imply summation.\n- The anisotropic subgrid stress (trace removed) at the grid-filter scale satisfies $\\tau_{ij}^* = \\tau_{ij} - \\frac{1}{3}\\tau_{kk}\\delta_{ij}$.\n- The Germano identity for test filtering (denoted by a hat $\\hat{(\\cdot)}$ and a test filter width $\\hat{\\Delta} = \\alpha \\Delta$) relates the Leonard stress to the modeled stress difference across scales.\n- The Smagorinsky closure uses an eddy viscosity $\\nu_t$ to model the subgrid stress via $\\tau_{ij}^* \\approx -2 \\nu_t S_{ij}$, with $\\nu_t$ depending on the local strain-rate magnitude.\n- The scalar flux is modeled by a gradient-diffusion closure, $q_i = - D_t \\frac{\\partial \\tilde{z}}{\\partial x_i}$, for a resolved scalar $\\tilde{z}$ taken to be dimensionless (e.g., a mixture fraction).\n- The scalar dissipation rate closure for the resolved scalar becomes $\\varepsilon_z = 2 D_t \\left|\\nabla \\tilde{z}\\right|^2$.\n\nTasks:\n1. Construct a synthetic, periodic, incompressible-like velocity field $\\tilde{\\boldsymbol{u}}(x)$ with physically plausible spatial variability on a cubic domain of side length $L$ (in meters) discretized on $N^3$ points. Use central differences with periodic boundary conditions to compute $\\nabla \\tilde{\\boldsymbol{u}}$ and the strain-rate tensor components $S_{ij}$ and magnitude $|S|$.\n2. Implement two test filters on the same grid:\n   - A box (top-hat) filter with an integer kernel size $\\alpha$ (in grid cells) applied separably in three dimensions.\n   - A Gaussian filter with standard deviation $\\sigma$ (in grid cells) chosen such that the full width at half maximum (FWHM) approximately matches $\\alpha$ grid cells; i.e., use $\\sigma = \\alpha / 2.355$.\n   Both filters must operate in a periodic fashion.\n3. Starting from the Germano identity and the Smagorinsky framework, derive and implement the least-squares dynamic procedure to compute a single, domain-averaged coefficient $C$ such that the modeled identity is satisfied in the least-squares sense. Use this $C$ to define the eddy viscosity as $\\nu_t = C \\Delta^2 |S|$. Enforce $\\nu_t \\ge 0$ by clamping $C$ at zero if the least-squares estimate is negative.\n4. For a resolved, dimensionless scalar field $\\tilde{z}(x)$ constructed on the same grid, compute the modeled subgrid scalar flux magnitude $\\| \\boldsymbol{q} \\| = \\sqrt{q_i q_i}$ and the scalar dissipation rate $\\varepsilon_z$ using the gradient-diffusion closure with $D_t = \\nu_t / Sc_t$, where $Sc_t$ is the turbulent Schmidt number.\n5. Assess robustness to test-filter choice by computing the coefficient of variation (standard deviation divided by mean) of the dynamically computed $C$ across a set of filter choices.\n\nUnits and outputs:\n- Express $\\nu_t$ and $D_t$ in $\\mathrm{m^2/s}$, the scalar flux magnitude $\\|\\boldsymbol{q}\\|$ in $\\mathrm{m/s}$, and the scalar dissipation $\\varepsilon_z$ in $\\mathrm{s^{-1}}$.\n- Round all reported floats to six decimal places.\n\nTest suite:\nUse a periodic domain with $L = 0.1$ meters and $N = 32$ grid points in each direction. Let the base grid-filter width be $\\Delta = L/N$. Define the resolved scalar field $\\tilde{z}$ by a trigonometric superposition scaled by an amplitude parameter $A$; set $A=0$ for the uniform-scalar edge case. Evaluate the following six cases:\n- Case 1 (happy path): filter type box, $\\alpha = 2$, $Sc_t = 0.7$, $A = 1.0$.\n- Case 2: filter type gaussian, $\\alpha = 2$, $Sc_t = 0.7$, $A = 1.0$.\n- Case 3: filter type box, $\\alpha = 3$, $Sc_t = 0.7$, $A = 1.0$.\n- Case 4: filter type gaussian, $\\alpha = 3$, $Sc_t = 1.0$, $A = 1.0$.\n- Case 5: filter type box, $\\alpha = 2$, $Sc_t = 0.2$, $A = 1.0$.\n- Case 6 (boundary case): filter type box, $\\alpha = 2$, $Sc_t = 0.7$, $A = 0.0$.\n\nFor each case, compute and report the following five floats:\n- The domain-averaged dynamic coefficient $C$ (dimensionless).\n- The domain-averaged eddy viscosity $\\nu_t$ in $\\mathrm{m^2/s}$.\n- The domain-averaged turbulent diffusivity $D_t$ in $\\mathrm{m^2/s}$.\n- The domain-averaged scalar flux magnitude $\\|\\boldsymbol{q}\\|$ in $\\mathrm{m/s}$.\n- The domain-averaged scalar dissipation rate $\\varepsilon_z$ in $\\mathrm{s^{-1}}$.\n\nAdditionally, compute a robustness index defined as the coefficient of variation of $C$ across Cases 1–5 (exclude Case 6 where the scalar amplitude is zero but, as $C$ depends only on velocity and filters, its inclusion would not affect $C$; still, use Cases 1–5 to focus on the intended filter robustness spectrum).\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case contributes a list of five floats in the order above, followed by the single robustness index float at the end. For example:\n[[C1,nu1,D1,q1,eps1],[C2,nu2,D2,q2,eps2],...,[C6,nu6,D6,q6,eps6],robustness_index]\nAll floats must be rounded to six decimal places and expressed in the units specified.",
            "solution": "The user has provided a well-defined and scientifically sound problem in the field of computational fluid dynamics, specifically concerning Large-Eddy Simulation (LES) turbulence modeling. The problem is to implement the dynamic Smagorinsky model from first principles, apply it to synthetic velocity and scalar fields, and analyze the results. The problem is valid, self-contained, and objective. I will proceed with a full solution.\n\nThe solution is structured as follows: First, the theoretical principles underlying the dynamic procedure are detailed. Second, the construction of the synthetic velocity and scalar fields is specified. Third, the numerical methods for gradient calculation and filtering are described. Fourth, the step-by-step procedure for computing the dynamic coefficient and related turbulence quantities is laid out.\n\n**1. Theoretical Foundation of the Dynamic Smagorinsky Model**\n\nThe core of the problem lies in determining the coefficient for a subgrid-scale (SGS) model dynamically from the resolved flow field itself. This bypasses the need for prescribing a universal constant, which is a known limitation of the standard Smagorinsky model. The procedure is based on the Germano identity, which relates stresses at two different filter scales.\n\nLet the grid filter, with characteristic width $\\Delta$, be denoted by $\\tilde{(\\cdot)}$. The resolved velocity field is $\\tilde{u}_i$. Let a second, coarser 'test' filter with width $\\hat{\\Delta} = \\alpha\\Delta$ (where $\\alpha  1$) be denoted by $\\hat{(\\cdot)}$.\n\nThe SGS stress tensor at the grid scale $\\Delta$ is defined as $\\tau_{ij} = \\widetilde{u_i u_j} - \\tilde{u}_i \\tilde{u}_j$.\nThe analogous stress at the test-filter scale $\\hat{\\Delta}$ is $T_{ij} = \\widehat{u_i u_j} - \\hat{u}_i \\hat{u}_j$.\n\nThe Germano identity is an exact relation derived by applying the test filter to the definition of $\\tau_{ij}$ and rearranging terms:\n$$L_{ij} = T_{ij} - \\hat{\\tau}_{ij}$$\nwhere $L_{ij} = \\widehat{\\tilde{u}_i \\tilde{u}_j} - \\hat{\\tilde{u}}_i \\hat{\\tilde{u}}_j$ is the Leonard stress tensor. $L_{ij}$ is crucial because it is computable entirely from the resolved velocity field $\\tilde{u}_i$.\n\nThe Smagorinsky model provides an algebraic closure for the deviatoric (anisotropic) part of the SGS stress tensor, $\\tau_{ij}^* = \\tau_{ij} - \\frac{1}{3}\\tau_{kk}\\delta_{ij}$. The model is:\n$$\\tau_{ij}^* \\approx -2 \\nu_t S_{ij} = -2 (C \\Delta^2 |S|) S_{ij}$$\nHere, $S_{ij} = \\frac{1}{2}(\\partial \\tilde{u}_i / \\partial x_j + \\partial \\tilde{u}_j / \\partial x_i)$ is the resolved strain-rate tensor, $|S| = \\sqrt{2 S_{ij} S_{ij}}$ is its magnitude, and $\\nu_t$ is the eddy viscosity, which we define using a coefficient $C$ instead of the traditional $C_S^2$.\n\nAssuming the same model form holds at the test-filter scale (with the same coefficient $C$), the stress $T_{ij}^*$ is modeled as:\n$$T_{ij}^* \\approx -2 (C \\hat{\\Delta}^2 |\\hat{S}|) \\hat{S}_{ij}$$\nwhere $\\hat{S}_{ij}$ and $|\\hat{S}|$ are computed from the test-filtered velocity field $\\hat{\\tilde{u}}_i$.\n\nSubstituting these models into the deviatoric form of the Germano identity, $L_{ij}^* = T_{ij}^* - \\hat{\\tau}_{ij}^*$, yields:\n$$L_{ij}^* \\approx -2 C \\hat{\\Delta}^2 |\\hat{S}| \\hat{S}_{ij} - \\widehat{(-2 C \\Delta^2 |S| S_{ij})}$$\nA key assumption is that the coefficient $C$ varies slowly in space, allowing it to be moved outside the filter operation: $\\widehat{C (\\cdot)} \\approx C \\widehat{(\\cdot)}$. This leads to:\n$$L_{ij}^* \\approx C \\left( 2 \\Delta^2 \\widehat{|S| S_{ij}} - 2 \\hat{\\Delta}^2 |\\hat{S}| \\hat{S}_{ij} \\right)$$\nLet us define the model tensor $M_{ij} = 2 \\Delta^2 \\widehat{|S| S_{ij}} - 2 \\hat{\\Delta}^2 |\\hat{S}| \\hat{S}_{ij}$. The identity becomes an algebraic equation for $C$ at every point: $L_{ij}^* \\approx C M_{ij}$. To obtain a single, robust, domain-wide value for $C$, we solve this system in a least-squares sense by minimizing the integrated squared error $E = \\langle(L_{ij}^* - C M_{ij})(L_{ij}^* - C M_{ij})\\rangle$, where $\\langle \\cdot \\rangle$ denotes a volume average. The solution is:\n$$C = \\frac{\\langle L_{ij}^* M_{ij} \\rangle}{\\langle M_{ij} M_{ij} \\rangle} = \\frac{\\sum_{i,j} \\int_V L_{ij}^* M_{ij} \\, dV}{\\sum_{i,j} \\int_V M_{ij} M_{ij} \\, dV}$$\nIn a discrete setting, the integrals become sums over all grid points. Should the calculation yield $C  0$, it is clamped to $C=0$ to ensure the eddy viscosity $\\nu_t$ is non-negative, a physical requirement for dissipative processes.\n\n**2. Synthetic Field Construction**\n\nThe problem takes place on a periodic cubic domain of side length $L=0.1$ m, discretized by $N^3=32^3$ points. The grid spacing is $\\Delta = L/N$.\nA synthetic, periodic, and divergence-free velocity field $\\tilde{\\boldsymbol{u}}(\\boldsymbol{x})$ is constructed to mimic turbulent structures. A suitable choice is a variation of the Taylor-Green vortex:\n$$ \\tilde{u}_1(x,y,z) = U_0 \\sin(k_0 x) \\cos(k_0 y) \\cos(k_0 z) $$\n$$ \\tilde{u}_2(x,y,z) = -U_0 \\cos(k_0 x) \\sin(k_0 y) \\cos(k_0 z) $$\n$$ \\tilde{u}_3(x,y,z) = 0 $$\nwhere $k_0 = 2\\pi/L$ is the fundamental wavenumber and $U_0 = 1.0 \\, \\text{m/s}$ is a characteristic velocity. This field satisfies $\\nabla \\cdot \\tilde{\\boldsymbol{u}} = 0$.\n\nThe resolved scalar field $\\tilde{z}(\\boldsymbol{x})$ is a dimensionless trigonometric superposition:\n$$ \\tilde{z}(x,y,z) = 0.5 + A \\left[ \\sin(2k_0 x) \\cos(k_0 y) + \\cos(k_0 y) \\sin(k_0 z) \\right] $$\nThe amplitude $A$ is given by the test cases. $A=0$ yields a uniform scalar field, $\\tilde{z}=0.5$.\n\n**3. Numerical Implementation**\n\n- **Gradient Calculation**: All spatial derivatives, e.g., $\\partial f / \\partial x_j$, are computed using second-order central differences on the periodic grid. For a function $f$ on grid nodes $i$, the derivative is $(\\,f_{i+1} - f_{i-1}\\,) / (2\\Delta)$. Periodicity is handled by wrapping indices, equivalent to using `numpy.roll`.\n\n- **Filtering**:\n  - **Box Filter**: A 3D separable top-hat filter is implemented using `scipy.ndimage.uniform_filter` with `mode='wrap'`. The kernel size is set to the integer $\\alpha$.\n  - **Gaussian Filter**: A 3D Gaussian filter is implemented using `scipy.ndimage.gaussian_filter` with `mode='wrap'`. The standard deviation is set to $\\sigma = \\alpha / 2.355$ grid cells.\n\n**4. Quantities to be Computed**\n\nOnce the dynamic coefficient $C$ is found, the following quantities are calculated at each grid point:\n- **Eddy Viscosity**: $\\nu_t = C \\Delta^2 |S|$ in $\\text{m}^2/\\text{s}$.\n- **Turbulent Diffusivity**: $D_t = \\nu_t / Sc_t$ in $\\text{m}^2/\\text{s}$, where $Sc_t$ is the turbulent Schmidt number.\n- **Scalar Flux Magnitude**: The scalar flux vector is modeled as $\\boldsymbol{q} = -D_t \\nabla \\tilde{z}$. Its magnitude is $\\|\\boldsymbol{q}\\| = \\sqrt{q_i q_i}$ in $\\text{m/s}$.\n- **Scalar Dissipation Rate**: The resolved scalar dissipation rate is modeled as $\\varepsilon_z = 2 D_t |\\nabla \\tilde{z}|^2$ in $\\text{s}^{-1}$.\n\nThe final reported values for these four quantities are their domain averages.\n\n**5. Robustness Metric**\n\nTo assess the model's robustness with respect to the test-filter choice, the coefficient of variation (CV) of the computed $C$ values from the first five test cases is calculated:\n$$ \\text{CV} = \\frac{\\text{std}(C_1, \\dots, C_5)}{\\text{mean}(C_1, \\dots, C_5)} $$\nA lower CV indicates that the dynamically computed coefficient is less sensitive to the arbitrary choice of the test filter, which is a desirable property.\n\nThe procedure will now be executed for each case specified in the problem statement, and the results compiled into the required output format.",
            "answer": "```python\nimport numpy as np\nfrom scipy import ndimage\n\ndef solve():\n    \"\"\"\n    Implements the dynamic Smagorinsky model procedure to compute turbulence quantities\n    for a set of test cases and assesses robustness.\n    \"\"\"\n\n    # --- Problem Constants and Test Suite ---\n    L = 0.1  # Domain side length [m]\n    N = 32   # Grid points per dimension\n    U0 = 1.0 # Velocity scale [m/s]\n    Delta = L / N\n\n    test_cases = [\n        # (filter_type, alpha, Sc_t, A)\n        ('box', 2, 0.7, 1.0),\n        ('gaussian', 2, 0.7, 1.0),\n        ('box', 3, 0.7, 1.0),\n        ('gaussian', 3, 1.0, 1.0),\n        ('box', 2, 0.2, 1.0),\n        ('box', 2, 0.7, 0.0),\n    ]\n\n    # --- Grid and Field Generation ---\n    grid_coords = np.linspace(0, L, N, endpoint=False)\n    x, y, z_coords = np.meshgrid(grid_coords, grid_coords, grid_coords, indexing='ij')\n\n    k0 = 2 * np.pi / L\n    # Resolved velocity field (divergence-free)\n    u_tilde = np.zeros((3, N, N, N))\n    u_tilde[0] = U0 * np.sin(k0 * x) * np.cos(k0 * y) * np.cos(k0 * z_coords)\n    u_tilde[1] = -U0 * np.cos(k0 * x) * np.sin(k0 * y) * np.cos(k0 * z_coords)\n    u_tilde[2] = 0.0\n\n    # --- Helper Functions ---\n    def gradient_periodic(field_3d, h):\n        grad = np.zeros((3, *field_3d.shape))\n        dims = len(field_3d.shape)\n        for i in range(dims):\n            grad[i] = (np.roll(field_3d, -1, axis=i) - np.roll(field_3d, 1, axis=i)) / (2 * h)\n        return grad\n\n    def apply_filter(field, filter_type, alpha_param):\n        if filter_type == 'box':\n            return ndimage.uniform_filter(field, size=int(alpha_param), mode='wrap')\n        elif filter_type == 'gaussian':\n            sigma = alpha_param / 2.355\n            return ndimage.gaussian_filter(field, sigma=sigma, mode='wrap')\n        else:\n            raise ValueError(f\"Unknown filter type: {filter_type}\")\n\n    # --- Main Calculation Loop ---\n    all_results = []\n    c_values_for_robustness = []\n\n    for i, (filter_type, alpha, Sc_t, A) in enumerate(test_cases):\n        # --- Strain-Rate Tensor at Grid Scale ---\n        grad_u_tilde = np.array([gradient_periodic(u_tilde[i], Delta) for i in range(3)])\n        S_ij = 0.5 * (grad_u_tilde + np.transpose(grad_u_tilde, (1, 0, 2, 3, 4)))\n        S_mag = np.sqrt(2 * np.sum(S_ij**2, axis=(0, 1)))\n\n        # --- Test Filtering and Associated Quantities ---\n        Delta_hat = alpha * Delta\n        u_tilde_hat = apply_filter(u_tilde, filter_type, alpha)\n\n        grad_u_tilde_hat = np.array([gradient_periodic(u_tilde_hat[i], Delta) for i in range(3)])\n        S_hat_ij = 0.5 * (grad_u_tilde_hat + np.transpose(grad_u_tilde_hat, (1, 0, 2, 3, 4)))\n        S_hat_mag = np.sqrt(2 * np.sum(S_hat_ij**2, axis=(0, 1)))\n\n        # --- Leonard Stress Tensor ---\n        uu_prod = np.einsum('i...,j...-ij...', u_tilde, u_tilde)\n        uu_prod_hat = apply_filter(uu_prod, filter_type, alpha)\n        u_hat_u_hat_prod = np.einsum('i...,j...-ij...', u_tilde_hat, u_tilde_hat)\n        L_ij = uu_prod_hat - u_hat_u_hat_prod\n        \n        # Deviatoric part of Leonard stress L_ij^*\n        L_trace = np.einsum('ii...-...', L_ij)\n        L_star_ij = L_ij - (1/3) * np.eye(3)[:, :, None, None, None] * L_trace[None, None, :, :, :]\n\n        # --- Model Tensor M_ij for Dynamic Procedure ---\n        # M_ij = 2*Delta^2 * widehat(|S|S_ij) - 2*Delta_hat^2 * |hat(S)|hat(S)_ij\n        term1_base = S_ij * S_mag[None, None, :, :, :]\n        term1_filtered = apply_filter(term1_base, filter_type, alpha)\n        \n        term2_base = S_hat_ij * S_hat_mag[None, None, :, :, :]\n\n        M_ij = 2 * Delta**2 * term1_filtered - 2 * Delta_hat**2 * term2_base\n        \n        # --- Compute Dynamic Coefficient C ---\n        numerator = np.sum(L_star_ij * M_ij)\n        denominator = np.sum(M_ij * M_ij)\n        \n        if denominator  1e-16: # Avoid division by zero\n            C = 0.0\n        else:\n            C = numerator / denominator\n        \n        C = max(0.0, C) # Enforce non-negative viscosity\n\n        # --- Scalar Field and its Gradients ---\n        z_tilde = 0.5 + A * (np.sin(2 * k0 * x) * np.cos(k0 * y) + np.cos(k0 * y) * np.sin(k0 * z_coords))\n        grad_z_tilde = gradient_periodic(z_tilde, Delta)\n        grad_z_mag_sq = np.sum(grad_z_tilde**2, axis=0)\n\n        # --- Compute Turbulence Quantities ---\n        nu_t = C * (Delta**2) * S_mag\n        D_t = nu_t / Sc_t\n        q_vec = -D_t[None, :, :, :] * grad_z_tilde\n        q_mag = np.sqrt(np.sum(q_vec**2, axis=0))\n        eps_z = 2 * D_t * grad_z_mag_sq\n\n        # --- Domain-Averaged Results for this case ---\n        case_results = [\n            round(C, 6),\n            round(np.mean(nu_t), 6),\n            round(np.mean(D_t), 6),\n            round(np.mean(q_mag), 6),\n            round(np.mean(eps_z), 6)\n        ]\n        all_results.append(case_results)\n        \n        if i  5: # Cases 1-5 are used for robustness\n            c_values_for_robustness.append(C)\n\n    # --- Robustness Index Calculation ---\n    c_array = np.array(c_values_for_robustness)\n    mean_c = np.mean(c_array)\n    std_c = np.std(c_array)\n    robustness_index = std_c / mean_c if mean_c != 0 else 0.0\n    robustness_index = round(robustness_index, 6)\n\n    # --- Final Output Formatting ---\n    output_str_parts = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    print(f\"[{','.join(output_str_parts)},{robustness_index}]\")\n    \nsolve()\n```"
        },
        {
            "introduction": "The relationship between eddy viscosity and turbulent diffusivity is governed by the turbulent Schmidt number, $Sc_t$. In practice, a constant value is often assumed for all species, but is this always justified? This exercise challenges you to investigate the consequences of this simplification in a reacting flow context . You will derive the error introduced by a constant-$Sc_t$ assumption and develop a criterion, based on the Damköhler number, to determine when species-specific transport properties are crucial for correctly predicting the combustion regime.",
            "id": "4068964",
            "problem": "Consider a statistically steady, axisymmetric reacting jet simulated using Large Eddy Simulation (LES). In LES, a spatial filter of width $\\Delta$ separates the resolved scales from the subgrid scales. For each chemical species $i$, the filtered mass fraction is denoted by $\\tilde{Y}_i$, the fluid density by $\\rho$, and the resolved velocity by $\\tilde{\\boldsymbol{u}}$. The filtered scalar transport equation introduces a subgrid-scale (SGS) scalar flux that requires closure. In many computational combustion models, this SGS scalar flux is closed using the gradient diffusion hypothesis with an eddy diffusivity related to the turbulent viscosity via a turbulent Schmidt number.\n\nStarting from the filtered scalar transport equation for species $i$,\n$$\n\\frac{\\partial (\\rho \\tilde{Y}_i)}{\\partial t} + \\nabla \\cdot (\\rho \\tilde{\\boldsymbol{u}} \\tilde{Y}_i) = - \\nabla \\cdot \\boldsymbol{q}_i + \\tilde{\\dot{\\omega}}_i,\n$$\nwhere $\\boldsymbol{q}_i$ is the SGS scalar flux and $\\tilde{\\dot{\\omega}}_i$ is the filtered reaction source, adopt the standard SGS gradient diffusion hypothesis\n$$\n\\boldsymbol{q}_i = - \\rho D_{t,i} \\nabla \\tilde{Y}_i,\\quad D_{t,i} = \\frac{\\nu_t}{Sc_{t,i}},\n$$\nwith $\\nu_t$ the eddy (turbulent) viscosity and $Sc_{t,i}$ the species-specific turbulent Schmidt number. Many codes use a single, species-independent turbulent Schmidt number $Sc_t^0$ for all scalars, so that $D_t^0 = \\nu_t / Sc_t^0$ is imposed for every species.\n\nYour tasks are:\n\n1. Derive, from first principles and the above closure, an expression for the relative error in the magnitude of the SGS scalar flux for species $i$ incurred by using a single $Sc_t^0$ instead of the true $Sc_{t,i}$. Express this relative error as a dimensionless number in terms of $Sc_{t,i}$ and $Sc_t^0$ only.\n\n2. Using the definition of SGS scalar variance dissipation rate for species $i$,\n$$\n\\chi_{\\mathrm{sgs},i} = 2 D_{t,i} \\left\\lvert \\nabla \\tilde{Y}_i \\right\\rvert^2,\n$$\nderive the relative error in $\\chi_{\\mathrm{sgs},i}$ due to using $Sc_t^0$ instead of $Sc_{t,i}$, and demonstrate its relationship to the flux error.\n\n3. Define the subgrid mixing timescale for species $i$ as\n$$\n\\tau_{\\mathrm{mix},i} = \\frac{\\Delta^2}{D_{t,i}} = \\Delta^2 \\frac{Sc_{t,i}}{\\nu_t}.\n$$\nGiven a chemical timescale $\\tau_{\\mathrm{chem},i}$, define the Damköhler number (Da) for species $i$ as\n$$\nDa_i = \\frac{\\tau_{\\mathrm{mix},i}}{\\tau_{\\mathrm{chem},i}}.\n$$\nSimilarly, define $Da_i^0$ using $Sc_t^0$ in place of $Sc_{t,i}$.\n\n4. Propose and implement a scientifically justified necessity criterion for when species-specific $Sc_{t,i}$ must be used instead of a single $Sc_t^0$ in a reacting jet. Your criterion must be based on:\n   - The relative error in the SGS scalar flux magnitude (or equivalently in $\\chi_{\\mathrm{sgs},i}$), compared against a user-specified tolerance $\\epsilon$ given as a decimal; and\n   - Whether the classification of the regime for species $i$ changes when using $Sc_t^0$ instead of $Sc_{t,i}$, where the regime is defined by whether $Da_i \\ge 1$ (mixing-controlled) or $Da_i  1$ (chemistry-controlled).\n\nA species-specific $Sc_{t,i}$ is deemed necessary for a given case if, for any species in that case, either the relative flux error exceeds $\\epsilon$ or the regime classification changes between $Da_i$ and $Da_i^0$.\n\nAll physical quantities must be handled using the following units:\n- $\\nu_t$ in $\\mathrm{m}^2/\\mathrm{s}$,\n- $\\Delta$ in $\\mathrm{m}$,\n- $\\tau_{\\mathrm{chem},i}$ in $\\mathrm{s}$,\n- Timescales and Damköhler numbers are dimensionless or in $\\mathrm{s}$ as defined, and you must treat $\\epsilon$ as a decimal number (not a percentage sign).\n\nImplement a program that, for each test case provided below, evaluates the necessity criterion and returns a single boolean for the case: $\\mathrm{True}$ if species-specific $Sc_{t,i}$ is necessary, $\\mathrm{False}$ otherwise.\n\nTest suite (each case lists $(Sc_t^0, \\{Sc_{t,i}\\}_{i=1}^N, \\nu_t, \\Delta, \\{\\tau_{\\mathrm{chem},i}\\}_{i=1}^N, \\epsilon)$):\n\n- Case $1$ (baseline equality): $\\left( 0.7, \\{0.7, 0.7, 0.7\\}, 1.0 \\times 10^{-3}\\ \\mathrm{m}^2/\\mathrm{s}, 1.0 \\times 10^{-2}\\ \\mathrm{m}, \\{0.05, 0.05, 0.05\\}\\ \\mathrm{s}, 0.2 \\right)$.\n- Case $2$ (differential diffusion with regime flip): $\\left( 0.7, \\{0.3, 0.7, 1.4\\}, 1.0 \\times 10^{-3}\\ \\mathrm{m}^2/\\mathrm{s}, 1.0 \\times 10^{-2}\\ \\mathrm{m}, \\{0.04, 0.08, 0.2\\}\\ \\mathrm{s}, 0.2 \\right)$.\n- Case $3$ (small deviations below tolerance): $\\left( 0.7, \\{0.64, 0.7, 0.77\\}, 3.0 \\times 10^{-3}\\ \\mathrm{m}^2/\\mathrm{s}, 5.0 \\times 10^{-3}\\ \\mathrm{m}, \\{0.03, 0.06, 0.09\\}\\ \\mathrm{s}, 0.2 \\right)$.\n- Case $4$ (strong disparity with fast chemistry): $\\left( 0.5, \\{0.2, 0.5, 1.8\\}, 5.0 \\times 10^{-4}\\ \\mathrm{m}^2/\\mathrm{s}, 2.0 \\times 10^{-2}\\ \\mathrm{m}, \\{0.01, 0.02, 0.07\\}\\ \\mathrm{s}, 0.15 \\right)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $\\left[ \\mathrm{True}, \\mathrm{False}, \\mathrm{True}, \\mathrm{False} \\right]$). The outputs must be booleans following the necessity criterion above, in the same order as the test suite cases.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in the principles of computational combustion and Large Eddy Simulation (LES), well-posed with a clear objective and sufficient data, and free from ambiguity or contradiction. We may therefore proceed with a formal solution.\n\nThe problem asks us to evaluate the impact of a common simplification in LES of reacting flows: using a single, species-independent turbulent Schmidt number, $Sc_t^0$, instead of species-specific values, $Sc_{t,i}$. We will address the tasks sequentially.\n\n### 1. Relative Error in the Subgrid-Scale (SGS) Scalar Flux Magnitude\n\nThe SGS scalar flux for species $i$, $\\boldsymbol{q}_i$, is modeled using the gradient diffusion hypothesis. The \"true\" flux uses the species-specific turbulent diffusivity $D_{t,i}$:\n$$\n\\boldsymbol{q}_i = - \\rho D_{t,i} \\nabla \\tilde{Y}_i = - \\rho \\left( \\frac{\\nu_t}{Sc_{t,i}} \\right) \\nabla \\tilde{Y}_i\n$$\nThe magnitude of this flux vector is:\n$$\n\\lvert \\boldsymbol{q}_i \\rvert = \\rho \\frac{\\nu_t}{Sc_{t,i}} \\lvert \\nabla \\tilde{Y}_i \\rvert\n$$\nThe approximated flux, $\\boldsymbol{q}_i^0$, uses the single turbulent diffusivity $D_t^0$:\n$$\n\\boldsymbol{q}_i^0 = - \\rho D_t^0 \\nabla \\tilde{Y}_i = - \\rho \\left( \\frac{\\nu_t}{Sc_t^0} \\right) \\nabla \\tilde{Y}_i\n$$\nThe magnitude of the approximated flux vector is:\n$$\n\\lvert \\boldsymbol{q}_i^0 \\rvert = \\rho \\frac{\\nu_t}{Sc_t^0} \\lvert \\nabla \\tilde{Y}_i \\rvert\n$$\nThe relative error in the magnitude of the SGS scalar flux, which we denote $\\epsilon_{\\boldsymbol{q},i}$, is defined as the difference between the approximated and true magnitudes, normalized by the true magnitude. We consider the absolute value of this error for comparison against the tolerance $\\epsilon$.\n$$\n\\epsilon_{\\boldsymbol{q},i} = \\left\\lvert \\frac{\\lvert \\boldsymbol{q}_i^0 \\rvert - \\lvert \\boldsymbol{q}_i \\rvert}{\\lvert \\boldsymbol{q}_i \\rvert} \\right\\rvert\n$$\nSubstituting the expressions for the magnitudes:\n$$\n\\epsilon_{\\boldsymbol{q},i} = \\left\\lvert \\frac{\\rho \\frac{\\nu_t}{Sc_t^0} \\lvert \\nabla \\tilde{Y}_i \\rvert - \\rho \\frac{\\nu_t}{Sc_{t,i}} \\lvert \\nabla \\tilde{Y}_i \\rvert}{\\rho \\frac{\\nu_t}{Sc_{t,i}} \\lvert \\nabla \\tilde{Y}_i \\rvert} \\right\\rvert\n$$\nThe terms $\\rho$, $\\nu_t$, and $\\lvert \\nabla \\tilde{Y}_i \\rvert$ are common to all terms and cancel, provided $|\\nabla \\tilde{Y}_i| \\neq 0$. This is a reasonable assumption, as regions with zero scalar gradient have zero SGS flux, making the error analysis trivial there.\n$$\n\\epsilon_{\\boldsymbol{q},i} = \\left\\lvert \\frac{1/Sc_t^0 - 1/Sc_{t,i}}{1/Sc_{t,i}} \\right\\rvert = \\left\\lvert \\frac{1/Sc_t^0}{1/Sc_{t,i}} - 1 \\right\\rvert = \\left\\lvert \\frac{Sc_{t,i}}{Sc_t^0} - 1 \\right\\rvert\n$$\nThis expression can also be written as:\n$$\n\\epsilon_{\\boldsymbol{q},i} = \\left\\lvert \\frac{Sc_{t,i} - Sc_t^0}{Sc_t^0} \\right\\rvert\n$$\nThis is the desired expression for the relative error in the SGS scalar flux magnitude. It is a dimensionless number dependent only on $Sc_{t,i}$ and $Sc_t^0$.\n\n### 2. Relative Error in the SGS Scalar Variance Dissipation Rate\n\nThe SGS scalar variance dissipation rate for species $i$, $\\chi_{\\mathrm{sgs},i}$, is defined as:\n$$\n\\chi_{\\mathrm{sgs},i} = 2 D_{t,i} \\lvert \\nabla \\tilde{Y}_i \\rvert^2 = 2 \\left( \\frac{\\nu_t}{Sc_{t,i}} \\right) \\lvert \\nabla \\tilde{Y}_i \\rvert^2\n$$\nThe approximated dissipation rate, $\\chi_{\\mathrm{sgs},i}^0$, using $D_t^0$ is:\n$$\n\\chi_{\\mathrm{sgs},i}^0 = 2 D_t^0 \\lvert \\nabla \\tilde{Y}_i \\rvert^2 = 2 \\left( \\frac{\\nu_t}{Sc_t^0} \\right) \\lvert \\nabla \\tilde{Y}_i \\rvert^2\n$$\nThe absolute relative error, which we denote $\\epsilon_{\\chi,i}$, is:\n$$\n\\epsilon_{\\chi,i} = \\left\\lvert \\frac{\\chi_{\\mathrm{sgs},i}^0 - \\chi_{\\mathrm{sgs},i}}{\\chi_{\\mathrm{sgs},i}} \\right\\rvert = \\left\\lvert \\frac{2 \\frac{\\nu_t}{Sc_t^0} \\lvert \\nabla \\tilde{Y}_i \\rvert^2 - 2 \\frac{\\nu_t}{Sc_{t,i}} \\lvert \\nabla \\tilde{Y}_i \\rvert^2}{2 \\frac{\\nu_t}{Sc_{t,i}} \\lvert \\nabla \\tilde{Y}_i \\rvert^2} \\right\\rvert\n$$\nCanceling the common terms $2$, $\\nu_t$, and $\\lvert \\nabla \\tilde{Y}_i \\rvert^2$:\n$$\n\\epsilon_{\\chi,i} = \\left\\lvert \\frac{1/Sc_t^0 - 1/Sc_{t,i}}{1/Sc_{t,i}} \\right\\rvert = \\left\\lvert \\frac{Sc_{t,i}}{Sc_t^0} - 1 \\right\\rvert\n$$\nThis demonstrates that the relative error in the SGS scalar variance dissipation rate is identical to the relative error in the SGS scalar flux magnitude:\n$$\n\\epsilon_{\\chi,i} = \\epsilon_{\\boldsymbol{q},i}\n$$\nTherefore, a criterion based on the flux error is equivalent to one based on the dissipation rate error.\n\n### 3. Damköhler Number Definitions\n\nThe Damköhler number, $Da$, is a dimensionless quantity that relates a characteristic mixing timescale to a characteristic chemical timescale. The subgrid mixing timescale for species $i$, $\\tau_{\\mathrm{mix},i}$, is defined based on the filter width $\\Delta$ and the turbulent diffusivity $D_{t,i}$.\n\nThe \"true\" mixing timescale is:\n$$\n\\tau_{\\mathrm{mix},i} = \\frac{\\Delta^2}{D_{t,i}} = \\frac{\\Delta^2 Sc_{t,i}}{\\nu_t}\n$$\nThe \"true\" Damköhler number for species $i$, $Da_i$, is the ratio of this timescale to the chemical timescale $\\tau_{\\mathrm{chem},i}$:\n$$\nDa_i = \\frac{\\tau_{\\mathrm{mix},i}}{\\tau_{\\mathrm{chem},i}} = \\frac{\\Delta^2 Sc_{t,i}}{\\nu_t \\tau_{\\mathrm{chem},i}}\n$$\nWhen using the single Schmidt number $Sc_t^0$, we obtain an approximated mixing timescale $\\tau_{\\mathrm{mix},i}^0$ and an approximated Damköhler number $Da_i^0$:\n$$\n\\tau_{\\mathrm{mix},i}^0 = \\frac{\\Delta^2}{D_t^0} = \\frac{\\Delta^2 Sc_t^0}{\\nu_t}\n$$\n$$\nDa_i^0 = \\frac{\\tau_{\\mathrm{mix},i}^0}{\\tau_{\\mathrm{chem},i}} = \\frac{\\Delta^2 Sc_t^0}{\\nu_t \\tau_{\\mathrm{chem},i}}\n$$\n\n### 4. Necessity Criterion and Implementation\n\nThe problem requires a criterion to decide if species-specific Schmidt numbers $Sc_{t,i}$ are necessary. This is judged on a per-case basis. For a given set of parameters, the use of species-specific values is deemed necessary if, for **any** species $i$, one or both of the following conditions are met:\n\n1.  **Flux Error Condition**: The absolute relative error in the SGS scalar flux magnitude, $\\epsilon_{\\boldsymbol{q},i}$, exceeds a specified tolerance $\\epsilon$.\n    $$\n    \\left\\lvert \\frac{Sc_{t,i} - Sc_t^0}{Sc_t^0} \\right\\rvert  \\epsilon\n    $$\n2.  **Regime Change Condition**: The classification of the combustion regime changes when moving from $Da_i$ to $Da_i^0$. The regime is defined as mixing-controlled if $Da \\ge 1$ and chemistry-controlled if $Da  1$. A change occurs if one of the Damköhler numbers is greater than or equal to $1$ while the other is less than $1$. This can be expressed logically as:\n    $$\n    (Da_i \\ge 1 \\text{ and } Da_i^0  1) \\quad \\text{OR} \\quad (Da_i  1 \\text{ and } Da_i^0 \\ge 1)\n    $$\n\nThe implementation will iterate through each species within a test case. For each species, it will first check the flux error condition. If this condition is met, the criterion for the entire case is satisfied (`True`), and no further checks are needed. If it is not met, the implementation proceeds to check the regime change condition. If this second condition is met, the criterion is satisfied (`True`). If neither condition is met for a given species, the algorithm proceeds to the next species. If all species in a case are checked and neither condition is triggered, the criterion for the case is not met (`False`).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef evaluate_necessity(case_params):\n    \"\"\"\n    Evaluates if species-specific turbulent Schmidt numbers are necessary for a given case.\n\n    A species-specific Sc_t is necessary if, for any species in the case:\n    1. The relative error in the SGS scalar flux magnitude exceeds a tolerance epsilon.\n    2. The combustion regime classification (mixing- vs. chemistry-controlled) changes\n       when using the approximated Sc_t0 instead of the true Sc_ti.\n\n    Args:\n        case_params (tuple): A tuple containing the parameters for the case:\n            (Sc_t0, Sc_ti_list, nu_t, delta, tau_chem_i_list, epsilon)\n\n    Returns:\n        bool: True if species-specific Sc_t is necessary, False otherwise.\n    \"\"\"\n    Sc_t0, Sc_ti_list, nu_t, delta, tau_chem_i_list, epsilon = case_params\n\n    # Combine the species-specific properties for synchronized iteration.\n    species_properties = zip(Sc_ti_list, tau_chem_i_list)\n\n    for sc_ti, tau_chem_i in species_properties:\n        # --- Condition 1: Check relative error in SGS scalar flux magnitude ---\n        # The absolute relative error is derived as |(Sc_ti - Sc_t0) / Sc_t0|.\n        rel_flux_error = abs((sc_ti - Sc_t0) / Sc_t0)\n        \n        if rel_flux_error  epsilon:\n            return True  # Necessity criterion met, no need to check further.\n\n        # --- Condition 2: Check for change in combustion regime ---\n        # The Damköhler number is Da = (delta^2 * Sc_t) / (nu_t * tau_chem).\n        # We pre-calculate the common factor to avoid redundant computation.\n        da_common_factor = (delta**2) / (nu_t * tau_chem_i)\n        \n        # Calculate true and approximated Damköhler numbers.\n        da_i = da_common_factor * sc_ti\n        da_i0 = da_common_factor * Sc_t0\n\n        # A regime is mixing-controlled if Da = 1, and chemistry-controlled if Da  1.\n        # We check if this boolean classification changes.\n        regime_true = (da_i = 1)\n        regime_approx = (da_i0 = 1)\n\n        if regime_true != regime_approx:\n            return True  # Necessity criterion met.\n\n    # If the loop completes, neither criterion was met for any species.\n    return False\n\ndef solve():\n    \"\"\"\n    Defines the test suite, evaluates each case, and prints the results\n    in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Sc_t0, {Sc_ti}, nu_t, delta, {tau_chem_i}, epsilon)\n    test_cases = [\n        (0.7, [0.7, 0.7, 0.7], 1.0e-3, 1.0e-2, [0.05, 0.05, 0.05], 0.2),\n        (0.7, [0.3, 0.7, 1.4], 1.0e-3, 1.0e-2, [0.04, 0.08, 0.2], 0.2),\n        (0.7, [0.64, 0.7, 0.77], 3.0e-3, 5.0e-3, [0.03, 0.06, 0.09], 0.2),\n        (0.5, [0.2, 0.5, 1.8], 5.0e-4, 2.0e-2, [0.01, 0.02, 0.07], 0.15),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = evaluate_necessity(case)\n        results.append(result)\n\n    # Final print statement in the exact required format: [result1,result2,...]\n    # The str() of a bool is 'True' or 'False' with a capital letter, as required.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}