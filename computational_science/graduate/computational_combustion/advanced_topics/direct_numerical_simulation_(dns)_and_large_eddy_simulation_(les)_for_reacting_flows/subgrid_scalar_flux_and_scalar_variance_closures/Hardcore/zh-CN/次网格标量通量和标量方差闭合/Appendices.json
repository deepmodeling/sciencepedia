{
    "hands_on_practices": [
        {
            "introduction": "在大涡模拟中，直接求解亚格子尺度（SGS）的标量方差输运方程计算成本高昂。本练习将引导你推导一个基于“局部平衡”假设的代数闭包模型 。这个重要的假设认为亚格子标量方差的生成与耗散局部达到平衡，从而允许我们将无法解析的SGS方差 $\\widetilde{Z'^2}$ 与可解的标量梯度 $|\\nabla \\tilde{Z}|$ 直接关联起来，为许多燃烧模型提供了理论基础。",
            "id": "4068908",
            "problem": "考虑一个使用大涡模拟（LES；Large-Eddy Simulation）模拟的高雷诺数、轴对称、非预混射流火焰。令守恒混合分数表示为 $Z(\\boldsymbol{x},t)$，其空间滤波后的对应量表示为 $\\tilde{Z}(\\boldsymbol{x},t)$，相应的亚格子尺度方差表示为 $\\widetilde{Z'^2}(\\boldsymbol{x},t) \\equiv \\widetilde{(Z - \\tilde{Z})^2}$。假设射流中存在一个统计定常、局部均匀的区域，在此区域内，滤波后的标量方差输运简化为产生项与耗散项之间的平衡。使用以下基本要素：\n- 湍流中被动标量的守恒及其滤波（LES）形式。\n- 亚格子标量通量的梯度扩散假设，$\\widetilde{u_i' Z'} = - D_t \\,\\partial_i \\tilde{Z}$，其中 $D_t$ 是湍流扩散系数，$\\partial_i$ 表示 $\\partial / \\partial x_i$。\n- 标量方差的亚格子尺度耗散的标准涡粘性封闭模型，$\\epsilon_Z = C_{\\epsilon,Z}\\,\\dfrac{D_t}{\\Delta^2}\\,\\widetilde{Z'^2}$，其中 $C_{\\epsilon,Z}$ 是一个无量纲模型常数，$\\Delta$ 是 LES 滤波宽度。\n\n从这些基础出发，并假设 $\\widetilde{Z'^2}$ 的产生项 $P_Z$ 和耗散项 $\\epsilon_Z$ 之间存在稳态平衡 $P_Z = \\epsilon_Z$，推导 $\\widetilde{Z'^2}$ 关于 $D_t$、$\\Delta$ 和 $|\\nabla \\tilde{Z}|$ 的稳态近似表达式，其中 $|\\nabla \\tilde{Z}| \\equiv \\sqrt{\\partial_i \\tilde{Z}\\,\\partial_i \\tilde{Z}}$。将您的最终答案表示为单个闭式解析表达式。无需进行数值计算。",
            "solution": "所提出的问题要求在大涡模拟（LES）的框架内，从第一性原理出发，推导亚格子尺度（SGS）标量方差（表示为 $\\widetilde{Z'^2}$）的代数表达式。该推导将基于所提供的模型以及此方差的产生与耗散之间存在局部平衡的关键假设。\n\n该问题被验证为具有科学依据、提法恰当且客观。所有提供的信息均包含湍流燃烧模拟领域的标准定义和模型，为推导构成了一个自洽且逻辑性强的基础。\n\n核心前提是滤波后标量方差输运方程中的稳态平衡，即产生项等于耗散项：\n$$\nP_Z = \\epsilon_Z\n$$\n此处，$P_Z$ 是 SGS 标量方差的产生率，$\\epsilon_Z$ 是其耗散率。我们的任务是根据给定信息找到 $P_Z$ 和 $\\epsilon_Z$ 的表达式，然后求解 $\\widetilde{Z'^2}$。\n\n首先，我们建立产生项 $P_Z$ 的表达式。SGS 标量方差 $\\widetilde{Z'^2}$ 的输运方程可以从标量 $Z$ 的滤波输运方程严格推导得出。负责产生 $\\widetilde{Z'^2}$ 的项源于 SGS 标量通量 $\\widetilde{u_i'Z'}$ 与已解标量梯度 $\\partial_i \\tilde{Z}$ 之间的相互作用。该产生项的标准形式为：\n$$\nP_Z = -2 \\widetilde{u_i' Z'} \\frac{\\partial \\tilde{Z}}{\\partial x_i}\n$$\n此处，隐含了对重复指标 $i$ 的求和约定。该项表示标量方差从已解尺度（由 $\\nabla \\tilde{Z}$ 表征）向亚格子尺度的传递。\n\n问题中提供了用于模拟 SGS 标量通量的梯度扩散假设：\n$$\n\\widetilde{u_i' Z'} = - D_t \\frac{\\partial \\tilde{Z}}{\\partial x_i}\n$$\n其中 $D_t$ 是湍流（或涡）扩散系数。将此封闭模型代入 $P_Z$ 的表达式，得到：\n$$\nP_Z = -2 \\left( -D_t \\frac{\\partial \\tilde{Z}}{\\partial x_i} \\right) \\frac{\\partial \\tilde{Z}}{\\partial x_i}\n$$\n简化后得到：\n$$\nP_Z = 2 D_t \\left( \\frac{\\partial \\tilde{Z}}{\\partial x_i} \\frac{\\partial \\tilde{Z}}{\\partial x_i} \\right)\n$$\n括号中的项是已解标量梯度的模的平方。使用问题陈述中提供的记法 $|\\nabla \\tilde{Z}| \\equiv \\sqrt{\\partial_i \\tilde{Z}\\,\\partial_i \\tilde{Z}}$，我们可以将其平方写为 $|\\nabla \\tilde{Z}|^2 = \\partial_i \\tilde{Z}\\,\\partial_i \\tilde{Z}$。因此，产生项的最终表达式为：\n$$\nP_Z = 2 D_t |\\nabla \\tilde{Z}|^2\n$$\n\n接下来，我们考虑耗散项 $\\epsilon_Z$。问题中明确提供了一个标准的、基于涡粘性的 SGS 标量方差耗散封闭模型：\n$$\n\\epsilon_Z = C_{\\epsilon,Z}\\,\\frac{D_t}{\\Delta^2}\\,\\widetilde{Z'^2}\n$$\n其中 $C_{\\epsilon,Z}$ 是一个无量纲模型常数，$\\Delta$ 是 LES 滤波宽度。该模型假设耗散率与 SGS 方差本身成正比，并与亚格子涡的特征时间尺度 $\\tau_{sgs} \\sim \\Delta^2 / D_t$ 成反比。\n\n现在，我们通过令推导出的产生项表达式与给定的耗散项表达式相等，来施加局部平衡假设 $P_Z = \\epsilon_Z$：\n$$\n2 D_t |\\nabla \\tilde{Z}|^2 = C_{\\epsilon,Z}\\,\\frac{D_t}{\\Delta^2}\\,\\widetilde{Z'^2}\n$$\n我们的目标是求解此方程以得到 $\\widetilde{Z'^2}$。我们可以观察到，湍流扩散系数 $D_t$ 出现在方程的两边。假设在湍流中 $D_t \\neq 0$，我们可以将方程两边同时除以 $D_t$：\n$$\n2 |\\nabla \\tilde{Z}|^2 = \\frac{C_{\\epsilon,Z}}{\\Delta^2}\\,\\widetilde{Z'^2}\n$$\n此推导的一个关键结果是，对湍流扩散系数 $D_t$ 的依赖性被消除了。这意味着，在局部平衡的假设下，SGS 方差可以从已解标量场和滤波尺度代数地确定，而无需明确知道 SGS 输运系数 $D_t$。\n\n最后，我们对该方程进行代数重排，以分离出 $\\widetilde{Z'^2}$：\n$$\n\\widetilde{Z'^2} = \\frac{2 \\Delta^2}{C_{\\epsilon,Z}} |\\nabla \\tilde{Z}|^2\n$$\n此表达式为亚格子尺度标量方差提供了一个闭式代数模型。如要求所述，它完全用 LES 滤波宽度 $\\Delta$、模型常数 $C_{\\epsilon,Z}$ 和已解标量梯度的模 $|\\nabla \\tilde{Z}|$ 来表示。这类代数模型在许多先进的 LES 封闭策略（包括动态程序）中是基础性的。",
            "answer": "$$\n\\boxed{\\frac{2 \\Delta^2}{C_{\\epsilon,Z}} |\\nabla \\tilde{Z}|^2}\n$$"
        },
        {
            "introduction": "传统的亚格子模型通常依赖于普适的常数，但这在复杂的湍流场中往往不够精确。动态程序是一种先进的方法，它能够利用已解析的流场信息来动态地计算模型系数，从而提高模型的适应性和准确性。在本练习中 ，你将从第一性原理出发，实现动态Smagorinsky程序，以确定涡黏性系数 $\\nu_t$ 和湍流扩散系数 $D_t$，这是构建精确亚格子通量模型的关键一步。",
            "id": "4068962",
            "problem": "考虑一个三维、周期性、不可压缩的流场，该流场在均匀的笛卡尔网格上为大涡模拟（LES）进行了滤波，网格间距为 $\\Delta$（单位：米）。目标是实现 Smagorinsky 涡粘性模型的动态程序，并用其计算湍流扩散率 $D_t = \\nu_t / Sc_t$，然后评估动态计算出的系数相对于测试滤波器选择的鲁棒性。该实现必须从滤波后的方程和基本定义出发，基于第一性原理进行。\n\n所需的基本原理和定义：\n- 滤波后的速度场 $\\tilde{u}_i(x)$ 产生已解析的应变率张量 $S_{ij} = \\frac{1}{2}\\left(\\frac{\\partial \\tilde{u}_i}{\\partial x_j} + \\frac{\\partial \\tilde{u}_j}{\\partial x_i}\\right)$ 和应变率大小 $|S| = \\sqrt{2 S_{ij} S_{ij}}$，其中重复的指标表示求和。\n- 网格滤波尺度上的各向异性亚格子应力（去迹）满足 $\\tau_{ij}^* = \\tau_{ij} - \\frac{1}{3}\\tau_{kk}\\delta_{ij}$。\n- 用于测试滤波（由帽子符号 $\\hat{(\\cdot)}$ 和测试滤波器宽度 $\\hat{\\Delta} = \\alpha \\Delta$ 表示）的 Germano 恒等式将 Leonard 应力与跨尺度的模化应力差联系起来。\n- Smagorinsky 闭合模型使用涡粘性 $\\nu_t$ 通过 $\\tau_{ij}^* \\approx -2 \\nu_t S_{ij}$ 来模拟亚格子应力，其中 $\\nu_t$ 取决于局部应变率的大小。\n- 标量通量通过梯度扩散闭合模型进行建模，$q_i = - D_t \\frac{\\partial \\tilde{z}}{\\partial x_i}$，其中已解析的标量 $\\tilde{z}$ 被视为无量纲的（例如，混合分数）。\n- 已解析标量的标量耗散率闭合模型为 $\\varepsilon_z = 2 D_t \\left|\\nabla \\tilde{z}\\right|^2$。\n\n任务：\n1. 在边长为 $L$（单位：米）的立方体域上，该域被离散化为 $N^3$ 个点，构造一个具有物理上合理空间变化的人工、周期性、类不可压缩速度场 $\\tilde{\\boldsymbol{u}}(x)$。使用带有周期性边界条件的中心差分来计算 $\\nabla \\tilde{\\boldsymbol{u}}$ 以及应变率张量分量 $S_{ij}$ 和大小 $|S|$。\n2. 在同一网格上实现两种测试滤波器：\n   - 一个箱式（顶帽）滤波器，其整数核大小为 $\\alpha$（单位：网格单元），在三个维度上可分离地应用。\n   - 一个高斯滤波器，其标准差为 $\\sigma$（单位：网格单元），选择该值以使半峰全宽（FWHM）约等于 $\\alpha$ 个网格单元；即，使用 $\\sigma = \\alpha / 2.355$。\n   两种滤波器都必须以周期性方式运行。\n3. 从 Germano 恒等式和 Smagorinsky 框架出发，推导并实现最小二乘动态程序，以计算单个域平均系数 $C$，使得模化恒等式在最小二乘意义上得到满足。使用此 $C$ 将涡粘性定义为 $\\nu_t = C \\Delta^2 |S|$。如果最小二乘估计值为负，则通过将 $C$ 截断为零来强制 $\\nu_t \\ge 0$。\n4. 对于在同一网格上构造的已解析的无量纲标量场 $\\tilde{z}(x)$，使用梯度扩散闭合模型计算模化的亚格子标量通量大小 $\\| \\boldsymbol{q} \\| = \\sqrt{q_i q_i}$ 和标量耗散率 $\\varepsilon_z$，其中 $D_t = \\nu_t / Sc_t$，$Sc_t$ 是湍流 Schmidt 数。\n5. 通过计算一组滤波器选择下动态计算出的 $C$ 的变异系数（标准差除以平均值），评估对测试滤波器选择的鲁棒性。\n\n单位和输出：\n- 将 $\\nu_t$ 和 $D_t$ 以 $\\mathrm{m^2/s}$ 表示，标量通量大小 $\\|\\boldsymbol{q}\\|$ 以 $\\mathrm{m/s}$ 表示，标量耗散 $\\varepsilon_z$ 以 $\\mathrm{s^{-1}}$ 表示。\n- 将所有报告的浮点数四舍五入到六位小数。\n\n测试套件：\n使用一个周期性域，其中 $L = 0.1$ 米，每个方向有 $N = 32$ 个网格点。设基础网格滤波器宽度为 $\\Delta = L/N$。通过一个由振幅参数 $A$ 缩放的三角函数叠加来定义已解析的标量场 $\\tilde{z}$；对于均匀标量的边界情况，设置 $A=0$。评估以下六种情况：\n- 情况 1 (理想情况): 滤波器类型 box, $\\alpha = 2$, $Sc_t = 0.7$, $A = 1.0$。\n- 情况 2: 滤波器类型 gaussian, $\\alpha = 2$, $Sc_t = 0.7$, $A = 1.0$。\n- 情况 3: 滤波器类型 box, $\\alpha = 3$, $Sc_t = 0.7$, $A = 1.0$。\n- 情况 4: 滤波器类型 gaussian, $\\alpha = 3$, $Sc_t = 1.0$, $A = 1.0$。\n- 情况 5: 滤波器类型 box, $\\alpha = 2$, $Sc_t = 0.2$, $A = 1.0$。\n- 情况 6 (边界情况): 滤波器类型 box, $\\alpha = 2$, $Sc_t = 0.7$, $A = 0.0$。\n\n对于每种情况，计算并报告以下五个浮点数：\n- 域平均动态系数 $C$ (无量纲)。\n- 域平均涡粘性 $\\nu_t$ (单位: $\\mathrm{m^2/s}$)。\n- 域平均湍流扩散率 $D_t$ (单位: $\\mathrm{m^2/s}$)。\n- 域平均标量通量大小 $\\|\\boldsymbol{q}\\|$ (单位: $\\mathrm{m/s}$)。\n- 域平均标量耗散率 $\\varepsilon_z$ (单位: $\\mathrm{s^{-1}}$)。\n\n此外，计算一个鲁棒性指数，定义为情况 1–5 中 $C$ 的变异系数（排除情况 6，其中标量振幅为零，但由于 $C$ 仅取决于速度和滤波器，其包含不会影响 $C$；仍然使用情况 1–5 以关注预期的滤波器鲁棒性范围）。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每种情况贡献一个包含上述顺序的五个浮点数的列表，最后是单个鲁棒性指数浮点数。例如：\n[[C1,nu1,D1,q1,eps1],[C2,nu2,D2,q2,eps2],...,[C6,nu6,D6,q6,eps6],robustness_index]\n所有浮点数必须四舍五入到六位小数，并以指定的单位表示。",
            "solution": "用户在计算流体力学领域提供了一个定义明确且科学合理的问题，具体涉及大涡模拟（LES）湍流建模。问题要求从第一性原理出发实现动态 Smagorinsky 模型，将其应用于人工合成的速度场和标量场，并分析结果。该问题有效、自洽且客观。我将提供完整的解决方案。\n\n解决方案的结构如下：首先，详细阐述动态程序背后的理论原理。其次，说明人工合成速度场和标量场的构造方法。第三，描述用于梯度计算和滤波的数值方法。第四，列出计算动态系数及相关湍流物理量的分步过程。\n\n**1. 动态 Smagorinsky 模型的理论基础**\n\n问题的核心在于如何从已解析的流场本身动态地确定亚格子尺度（SGS）模型的系数。这避免了预设一个普适常数的需要，而后者是标准 Smagorinsky 模型的一个已知局限。该过程基于 Germano 恒等式，它关联了两个不同滤波尺度下的应力。\n\n设网格滤波器，其特征宽度为 $\\Delta$，用 $\\tilde{(\\cdot)}$ 表示。已解析的速度场为 $\\tilde{u}_i$。再设一个更粗的“测试”滤波器，其宽度为 $\\hat{\\Delta} = \\alpha\\Delta$（其中 $\\alpha  1$），用 $\\hat{(\\cdot)}$ 表示。\n\n在网格尺度 $\\Delta$ 上的 SGS 应力张量定义为 $\\tau_{ij} = \\widetilde{u_i u_j} - \\tilde{u}_i \\tilde{u}_j$。在测试滤波尺度 $\\hat{\\Delta}$ 上的类似应力为 $T_{ij} = \\widehat{u_i u_j} - \\hat{u}_i \\hat{u}_j$。\n\nGermano 恒等式是通过将测试滤波器应用于 $\\tau_{ij}$ 的定义并重新排列各项而导出的一个精确关系式：\n$$L_{ij} = T_{ij} - \\hat{\\tau}_{ij}$$\n其中 $L_{ij} = \\widehat{\\tilde{u}_i \\tilde{u}_j} - \\hat{\\tilde{u}}_i \\hat{\\tilde{u}}_j$ 是 Leonard 应力张量。$L_{ij}$ 至关重要，因为它完全可以从已解析的速度场 $\\tilde{u}_i$ 计算得出。\n\nSmagorinsky 模型为 SGS 应力张量的偏张量（各向异性）部分 $\\tau_{ij}^* = \\tau_{ij} - \\frac{1}{3}\\tau_{kk}\\delta_{ij}$ 提供了一个代数闭合。该模型为：\n$$\\tau_{ij}^* \\approx -2 \\nu_t S_{ij} = -2 (C \\Delta^2 |S|) S_{ij}$$\n此处，$S_{ij} = \\frac{1}{2}(\\partial \\tilde{u}_i / \\partial x_j + \\partial \\tilde{u}_j / \\partial x_i)$ 是已解析的应变率张量， $|S| = \\sqrt{2 S_{ij} S_{ij}}$ 是其大小，$\\nu_t$ 是涡粘性，我们使用系数 $C$ 而不是传统的 $C_S^2$ 来定义它。\n\n假设相同的模型形式在测试滤波尺度上仍然成立（使用相同的系数 $C$），则应力 $T_{ij}^*$ 被建模为：\n$$T_{ij}^* \\approx -2 (C \\hat{\\Delta}^2 |\\hat{S}|) \\hat{S}_{ij}$$\n其中 $\\hat{S}_{ij}$ 和 $|\\hat{S}|$ 是从经过测试滤波的速度场 $\\hat{\\tilde{u}}_i$ 计算得出的。\n\n将这些模型代入 Germano 恒等式的偏张量形式 $L_{ij}^* = T_{ij}^* - \\hat{\\tau}_{ij}^*$，得到：\n$$L_{ij}^* \\approx -2 C \\hat{\\Delta}^2 |\\hat{S}| \\hat{S}_{ij} - \\widehat{(-2 C \\Delta^2 |S| S_{ij})}$$\n一个关键的假设是系数 $C$ 在空间上变化缓慢，因此可以将其移出滤波操作：$\\widehat{C (\\cdot)} \\approx C \\widehat{(\\cdot)}$。这导致：\n$$L_{ij}^* \\approx C \\left( 2 \\Delta^2 \\widehat{|S| S_{ij}} - 2 \\hat{\\Delta}^2 |\\hat{S}| \\hat{S}_{ij} \\right)$$\n让我们定义模型张量 $M_{ij} = 2 \\Delta^2 \\widehat{|S| S_{ij}} - 2 \\hat{\\Delta}^2 |\\hat{S}| \\hat{S}_{ij}$。该恒等式在每个点都变成了关于 $C$ 的代数方程：$L_{ij}^* \\approx C M_{ij}$。为了获得一个单一、鲁棒、全域的 $C$ 值，我们通过最小化积分平方误差 $E = \\langle(L_{ij}^* - C M_{ij})(L_{ij}^* - C M_{ij})\\rangle$ 来以最小二乘法求解该系统，其中 $\\langle \\cdot \\rangle$ 表示体积平均。解为：\n$$C = \\frac{\\langle L_{ij}^* M_{ij} \\rangle}{\\langle M_{ij} M_{ij} \\rangle} = \\frac{\\sum_{i,j} \\int_V L_{ij}^* M_{ij} \\, dV}{\\sum_{i,j} \\int_V M_{ij} M_{ij} \\, dV}$$\n在离散设置中，积分变为对所有网格点的求和。如果计算得出 $C  0$，则将其截断为 $C=0$，以确保涡粘性 $\\nu_t$ 非负，这是耗散过程的物理要求。\n\n**2. 人工场的构造**\n\n问题设定在一个周期性的立方体域中，边长 $L=0.1$ 米，由 $N^3=32^3$ 个点离散化。网格间距为 $\\Delta = L/N$。构造一个人工的、周期性的、无散度的速度场 $\\tilde{\\boldsymbol{u}}(\\boldsymbol{x})$ 来模拟湍流结构。一个合适的选择是 Taylor-Green 涡的一种变体：\n$$ \\tilde{u}_1(x,y,z) = U_0 \\sin(k_0 x) \\cos(k_0 y) \\cos(k_0 z) $$\n$$ \\tilde{u}_2(x,y,z) = -U_0 \\cos(k_0 x) \\sin(k_0 y) \\cos(k_0 z) $$\n$$ \\tilde{u}_3(x,y,z) = 0 $$\n其中 $k_0 = 2\\pi/L$ 是基波波数，$U_0 = 1.0 \\, \\text{m/s}$ 是一个特征速度。该场满足 $\\nabla \\cdot \\tilde{\\boldsymbol{u}} = 0$。\n\n已解析的标量场 $\\tilde{z}(\\boldsymbol{x})$ 是一个无量纲的三角函数叠加：\n$$ \\tilde{z}(x,y,z) = 0.5 + A \\left[ \\sin(2k_0 x) \\cos(k_0 y) + \\cos(k_0 y) \\sin(k_0 z) \\right] $$\n振幅 $A$ 由测试用例给出。$A=0$ 产生一个均匀标量场，$\\tilde{z}=0.5$。\n\n**3. 数值实现**\n\n- **梯度计算**：所有空间导数，例如 $\\partial f / \\partial x_j$，均在周期性网格上使用二阶中心差分计算。对于网格节点 $i$ 上的函数 $f$，其导数为 $(\\,f_{i+1} - f_{i-1}\\,) / (2\\Delta)$。周期性通过环绕索引来处理，这等效于使用 `numpy.roll`。\n\n- **滤波**：\n  - **箱式滤波器**：使用 `scipy.ndimage.uniform_filter` 并设置 `mode='wrap'` 来实现一个三维可分离的顶帽滤波器。核大小设为整数 $\\alpha$。\n  - **高斯滤波器**：使用 `scipy.ndimage.gaussian_filter` 并设置 `mode='wrap'` 来实现一个三维高斯滤波器。标准差设为 $\\sigma = \\alpha / 2.355$ 网格单元。\n\n**4. 待计算的物理量**\n\n一旦找到动态系数 $C$，就在每个网格点上计算以下物理量：\n- **涡粘性**：$\\nu_t = C \\Delta^2 |S|$，单位为 $\\text{m}^2/\\text{s}$。\n- **湍流扩散率**：$D_t = \\nu_t / Sc_t$，单位为 $\\text{m}^2/\\text{s}$，其中 $Sc_t$ 是湍流 Schmidt 数。\n- **标量通量大小**：标量通量矢量被建模为 $\\boldsymbol{q} = -D_t \\nabla \\tilde{z}$。其大小为 $\\|\\boldsymbol{q}\\| = \\sqrt{q_i q_i}$，单位为 $\\text{m/s}$。\n- **标量耗散率**：已解析的标量耗散率被建模为 $\\varepsilon_z = 2 D_t |\\nabla \\tilde{z}|^2$，单位为 $\\text{s}^{-1}$。\n\n这四个物理量的最终报告值是它们的域平均值。\n\n**5. 鲁棒性度量**\n\n为了评估模型对测试滤波器选择的鲁棒性，计算了前五个测试用例计算出的 $C$ 值的变异系数（CV）：\n$$ \\text{CV} = \\frac{\\text{std}(C_1, \\dots, C_5)}{\\text{mean}(C_1, \\dots, C_5)} $$\n较低的 CV 表示动态计算的系数对测试滤波器的任意选择不那么敏感，这是一个理想的特性。\n\n现在将对问题陈述中指定的每种情况执行该过程，并将结果编译成所需的输出格式。",
            "answer": "```python\nimport numpy as np\nfrom scipy import ndimage\n\ndef solve():\n    \"\"\"\n    Implements the dynamic Smagorinsky model procedure to compute turbulence quantities\n    for a set of test cases and assesses robustness.\n    \"\"\"\n\n    # --- Problem Constants and Test Suite ---\n    L = 0.1  # Domain side length [m]\n    N = 32   # Grid points per dimension\n    U0 = 1.0 # Velocity scale [m/s]\n    Delta = L / N\n\n    test_cases = [\n        # (filter_type, alpha, Sc_t, A)\n        ('box', 2, 0.7, 1.0),\n        ('gaussian', 2, 0.7, 1.0),\n        ('box', 3, 0.7, 1.0),\n        ('gaussian', 3, 1.0, 1.0),\n        ('box', 2, 0.2, 1.0),\n        ('box', 2, 0.7, 0.0),\n    ]\n\n    # --- Grid and Field Generation ---\n    grid_coords = np.linspace(0, L, N, endpoint=False)\n    x, y, z_coords = np.meshgrid(grid_coords, grid_coords, grid_coords, indexing='ij')\n\n    k0 = 2 * np.pi / L\n    # Resolved velocity field (divergence-free)\n    u_tilde = np.zeros((3, N, N, N))\n    u_tilde[0] = U0 * np.sin(k0 * x) * np.cos(k0 * y) * np.cos(k0 * z_coords)\n    u_tilde[1] = -U0 * np.cos(k0 * x) * np.sin(k0 * y) * np.cos(k0 * z_coords)\n    u_tilde[2] = 0.0\n\n    # --- Helper Functions ---\n    def gradient_periodic(field_3d, h):\n        grad = np.zeros((3, *field_3d.shape))\n        dims = len(field_3d.shape)\n        for i in range(dims):\n            grad[i] = (np.roll(field_3d, -1, axis=i) - np.roll(field_3d, 1, axis=i)) / (2 * h)\n        return grad\n\n    def apply_filter(field, filter_type, alpha_param):\n        if filter_type == 'box':\n            return ndimage.uniform_filter(field, size=int(alpha_param), mode='wrap')\n        elif filter_type == 'gaussian':\n            sigma = alpha_param / 2.355\n            return ndimage.gaussian_filter(field, sigma=sigma, mode='wrap')\n        else:\n            raise ValueError(f\"Unknown filter type: {filter_type}\")\n\n    # --- Main Calculation Loop ---\n    all_results = []\n    c_values_for_robustness = []\n\n    for i, (filter_type, alpha, Sc_t, A) in enumerate(test_cases):\n        # --- Strain-Rate Tensor at Grid Scale ---\n        grad_u_tilde = np.array([gradient_periodic(u_tilde[i], Delta) for i in range(3)])\n        S_ij = 0.5 * (grad_u_tilde + np.transpose(grad_u_tilde, (1, 0, 2, 3, 4)))\n        S_mag = np.sqrt(2 * np.sum(S_ij**2, axis=(0, 1)))\n\n        # --- Test Filtering and Associated Quantities ---\n        Delta_hat = alpha * Delta\n        u_tilde_hat = apply_filter(u_tilde, filter_type, alpha)\n\n        grad_u_tilde_hat = np.array([gradient_periodic(u_tilde_hat[i], Delta) for i in range(3)])\n        S_hat_ij = 0.5 * (grad_u_tilde_hat + np.transpose(grad_u_tilde_hat, (1, 0, 2, 3, 4)))\n        S_hat_mag = np.sqrt(2 * np.sum(S_hat_ij**2, axis=(0, 1)))\n\n        # --- Leonard Stress Tensor ---\n        uu_prod = np.einsum('i...,j...-ij...', u_tilde, u_tilde)\n        uu_prod_hat = apply_filter(uu_prod, filter_type, alpha)\n        u_hat_u_hat_prod = np.einsum('i...,j...-ij...', u_tilde_hat, u_tilde_hat)\n        L_ij = uu_prod_hat - u_hat_u_hat_prod\n        \n        # Deviatoric part of Leonard stress L_ij^*\n        L_trace = np.einsum('ii...-...', L_ij)\n        L_star_ij = L_ij - (1/3) * np.eye(3)[:, :, None, None, None] * L_trace[None, None, :, :, :]\n\n        # --- Model Tensor M_ij for Dynamic Procedure ---\n        # M_ij = 2*Delta^2 * widehat(|S|S_ij) - 2*Delta_hat^2 * |hat(S)|hat(S)_ij\n        term1_base = S_ij * S_mag[None, None, :, :, :]\n        term1_filtered = apply_filter(term1_base, filter_type, alpha)\n        \n        term2_base = S_hat_ij * S_hat_mag[None, None, :, :, :]\n\n        M_ij = 2 * Delta**2 * term1_filtered - 2 * Delta_hat**2 * term2_base\n        \n        # --- Compute Dynamic Coefficient C ---\n        numerator = np.sum(L_star_ij * M_ij)\n        denominator = np.sum(M_ij * M_ij)\n        \n        if denominator  1e-16: # Avoid division by zero\n            C = 0.0\n        else:\n            C = numerator / denominator\n        \n        C = max(0.0, C) # Enforce non-negative viscosity\n\n        # --- Scalar Field and its Gradients ---\n        z_tilde = 0.5 + A * (np.sin(2 * k0 * x) * np.cos(k0 * y) + np.cos(k0 * y) * np.sin(k0 * z_coords))\n        grad_z_tilde = gradient_periodic(z_tilde, Delta)\n        grad_z_mag_sq = np.sum(grad_z_tilde**2, axis=0)\n\n        # --- Compute Turbulence Quantities ---\n        nu_t = C * (Delta**2) * S_mag\n        D_t = nu_t / Sc_t\n        q_vec = -D_t[None, :, :, :] * grad_z_tilde\n        q_mag = np.sqrt(np.sum(q_vec**2, axis=0))\n        eps_z = 2 * D_t * grad_z_mag_sq\n\n        # --- Domain-Averaged Results for this case ---\n        case_results = [\n            round(C, 6),\n            round(np.mean(nu_t), 6),\n            round(np.mean(D_t), 6),\n            round(np.mean(q_mag), 6),\n            round(np.mean(eps_z), 6)\n        ]\n        all_results.append(case_results)\n        \n        if i  5: # Cases 1-5 are used for robustness\n            c_values_for_robustness.append(C)\n\n    # --- Robustness Index Calculation ---\n    c_array = np.array(c_values_for_robustness)\n    mean_c = np.mean(c_array)\n    std_c = np.std(c_array)\n    robustness_index = std_c / mean_c if mean_c != 0 else 0.0\n    robustness_index = round(robustness_index, 6)\n\n    # --- Final Output Formatting ---\n    output_str_parts = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    print(f\"[{','.join(output_str_parts)},{robustness_index}]\")\n    \nsolve()\n```"
        },
        {
            "introduction": "在反应流模拟中，一个常见的简化是为所有化学物种使用单一的湍流施密特数 $Sc_t$。然而，不同物种（如轻质的氢气和重质的碳氢燃料）的扩散特性差异显著，这种简化可能引入显著误差。本练习  提供了一个量化框架，用于评估何时必须采用物种相关的 $Sc_{t,i}$，它结合了对亚格子通量误差和燃烧区域（由Damköhler数定义）变化的分析，帮助你做出更合理的建模选择。",
            "id": "4068964",
            "problem": "考虑一个使用大涡模拟 (LES) 进行模拟的统计定常、轴对称反应射流。在 LES 中，宽度为 $\\Delta$ 的空间滤波器将解析尺度与亚格子尺度分离开来。对于每种化学组分 $i$，滤波质量分数表示为 $\\tilde{Y}_i$，流体密度为 $\\rho$，解析速度为 $\\tilde{\\boldsymbol{u}}$。滤波标量输运方程引入了一个需要封闭的亚格子尺度 (SGS) 标量通量。在许多计算燃烧模型中，这个 SGS 标量通量通过梯度扩散假设进行封闭，其中涡扩散率通过湍流施密特数与湍流粘度相关联。\n\n从组分 $i$ 的滤波标量输运方程出发，\n$$\n\\frac{\\partial (\\rho \\tilde{Y}_i)}{\\partial t} + \\nabla \\cdot (\\rho \\tilde{\\boldsymbol{u}} \\tilde{Y}_i) = - \\nabla \\cdot \\boldsymbol{q}_i + \\tilde{\\dot{\\omega}}_i,\n$$\n其中 $\\boldsymbol{q}_i$ 是 SGS 标量通量，$\\tilde{\\dot{\\omega}}_i$ 是滤波反应源项，采用标准的 SGS 梯度扩散假设\n$$\n\\boldsymbol{q}_i = - \\rho D_{t,i} \\nabla \\tilde{Y}_i,\\quad D_{t,i} = \\frac{\\nu_t}{Sc_{t,i}},\n$$\n其中 $\\nu_t$ 是涡（湍流）粘度，$Sc_{t,i}$ 是特定组分的湍流施密特数。许多程序对所有标量使用单一的、与组分无关的湍流施密特数 $Sc_t^0$，因此对每个组分都强制使用 $D_t^0 = \\nu_t / Sc_t^0$。\n\n您的任务是：\n\n1. 从第一性原理和上述封闭模型出发，推导因使用单一 $Sc_t^0$ 而非真实 $Sc_{t,i}$ 所导致的组分 $i$ 的 SGS 标量通量大小的相对误差表达式。请将此相对误差表示为仅含 $Sc_{t,i}$ 和 $Sc_t^0$ 的无量纲数。\n\n2. 使用组分 $i$ 的 SGS 标量方差耗散率的定义，\n$$\n\\chi_{\\mathrm{sgs},i} = 2 D_{t,i} \\left\\lvert \\nabla \\tilde{Y}_i \\right\\rvert^2,\n$$\n推导因使用 $Sc_t^0$ 代替 $Sc_{t,i}$ 而引起的 $\\chi_{\\mathrm{sgs},i}$ 的相对误差，并证明其与通量误差的关系。\n\n3. 将组分 $i$ 的亚格子混合时间尺度定义为\n$$\n\\tau_{\\mathrm{mix},i} = \\frac{\\Delta^2}{D_{t,i}} = \\Delta^2 \\frac{Sc_{t,i}}{\\nu_t}.\n$$\n给定化学时间尺度 $\\tau_{\\mathrm{chem},i}$，将组分 $i$ 的丹姆科勒数 (Da) 定义为\n$$\nDa_i = \\frac{\\tau_{\\mathrm{mix},i}}{\\tau_{\\mathrm{chem},i}}.\n$$\n类似地，使用 $Sc_t^0$ 代替 $Sc_{t,i}$ 来定义 $Da_i^0$。\n\n4. 在反应射流中，针对何时必须使用特定组分的 $Sc_{t,i}$ 而非单一 $Sc_t^0$ 的情况，提出并实施一个具有科学依据的必要性准则。您的准则必须基于：\n   - SGS 标量通量大小的相对误差（或等效地，$\\chi_{\\mathrm{sgs},i}$ 的相对误差），与用户指定的小数形式的容差 $\\epsilon$ 进行比较；以及\n   - 当使用 $Sc_t^0$ 代替 $Sc_{t,i}$ 时，组分 $i$ 的状态分类是否发生改变，其中状态由 $Da_i \\ge 1$（混合控制）或 $Da_i  1$（化学反应控制）来定义。\n\n对于一个给定的算例，如果其中任何组分满足相对通量误差超过 $\\epsilon$ 或 $Da_i$ 和 $Da_i^0$ 之间的状态分类发生改变，则认为该算例必须使用特定组分的 $Sc_{t,i}$。\n\n所有物理量必须使用以下单位进行处理：\n- $\\nu_t$ 单位为 $\\mathrm{m}^2/\\mathrm{s}$，\n- $\\Delta$ 单位为 $\\mathrm{m}$，\n- $\\tau_{\\mathrm{chem},i}$ 单位为 $\\mathrm{s}$，\n- 时间尺度和丹姆科勒数如定义所示为无量纲或单位为 $\\mathrm{s}$，并且您必须将 $\\epsilon$ 视为一个十进制数（而非百分号）。\n\n请实现一个程序，对下面提供的每个测试算例，评估此必要性准则，并为该算例返回一个布尔值：如果必须使用特定组分的 $Sc_{t,i}$，则为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n\n测试套件（每个算例列出 $(Sc_t^0, \\{Sc_{t,i}\\}_{i=1}^N, \\nu_t, \\Delta, \\{\\tau_{\\mathrm{chem},i}\\}_{i=1}^N, \\epsilon)$）：\n\n- 算例 1（基准相等情况）：$\\left( 0.7, \\{0.7, 0.7, 0.7\\}, 1.0 \\times 10^{-3}\\ \\mathrm{m}^2/\\mathrm{s}, 1.0 \\times 10^{-2}\\ \\mathrm{m}, \\{0.05, 0.05, 0.05\\}\\ \\mathrm{s}, 0.2 \\right)$。\n- 算例 2（差异扩散伴随状态翻转）：$\\left( 0.7, \\{0.3, 0.7, 1.4\\}, 1.0 \\times 10^{-3}\\ \\mathrm{m}^2/\\mathrm{s}, 1.0 \\times 10^{-2}\\ \\mathrm{m}, \\{0.04, 0.08, 0.2\\}\\ \\mathrm{s}, 0.2 \\right)$。\n- 算例 3（低于容差的微小偏差）：$\\left( 0.7, \\{0.64, 0.7, 0.77\\}, 3.0 \\times 10^{-3}\\ \\mathrm{m}^2/\\mathrm{s}, 5.0 \\times 10^{-3}\\ \\mathrm{m}, \\{0.03, 0.06, 0.09\\}\\ \\mathrm{s}, 0.2 \\right)$。\n- 算例 4（快速化学反应下的强烈差异）：$\\left( 0.5, \\{0.2, 0.5, 1.8\\}, 5.0 \\times 10^{-4}\\ \\mathrm{m}^2/\\mathrm{s}, 2.0 \\times 10^{-2}\\ \\mathrm{m}, \\{0.01, 0.02, 0.07\\}\\ \\mathrm{s}, 0.15 \\right)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $\\left[ \\mathrm{True}, \\mathrm{False}, \\mathrm{True}, \\mathrm{False} \\right]$）。输出必须是遵循上述必要性准则的布尔值，顺序与测试套件算例的顺序相同。",
            "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于计算燃烧学和大涡模拟 (LES) 的原理，问题设定良好，目标明确，数据充分，并且没有歧义或矛盾。因此，我们可以进行正式求解。\n\n该问题要求我们评估在反应流 LES 中一个常见简化方法所带来的影响：即使用单一的、与组分无关的湍流施密特数 $Sc_t^0$ 来代替特定于组分的值 $Sc_{t,i}$。我们将按顺序解决这些任务。\n\n### 1. 亚格子尺度 (SGS) 标量通量大小的相对误差\n\n组分 $i$ 的 SGS 标量通量 $\\boldsymbol{q}_i$ 是使用梯度扩散假设建模的。“真实”通量使用特定组分的湍流扩散率 $D_{t,i}$：\n$$\n\\boldsymbol{q}_i = - \\rho D_{t,i} \\nabla \\tilde{Y}_i = - \\rho \\left( \\frac{\\nu_t}{Sc_{t,i}} \\right) \\nabla \\tilde{Y}_i\n$$\n该通量矢量的大小为：\n$$\n\\lvert \\boldsymbol{q}_i \\rvert = \\rho \\frac{\\nu_t}{Sc_{t,i}} \\lvert \\nabla \\tilde{Y}_i \\rvert\n$$\n近似通量 $\\boldsymbol{q}_i^0$ 使用单一的湍流扩散率 $D_t^0$：\n$$\n\\boldsymbol{q}_i^0 = - \\rho D_t^0 \\nabla \\tilde{Y}_i = - \\rho \\left( \\frac{\\nu_t}{Sc_t^0} \\right) \\nabla \\tilde{Y}_i\n$$\n近似通量矢量的大小为：\n$$\n\\lvert \\boldsymbol{q}_i^0 \\rvert = \\rho \\frac{\\nu_t}{Sc_t^0} \\lvert \\nabla \\tilde{Y}_i \\rvert\n$$\nSGS 标量通量大小的相对误差，我们记为 $\\epsilon_{\\boldsymbol{q},i}$，定义为近似大小与真实大小之差，并用真实大小进行归一化。我们考虑此误差的绝对值，以便与容差 $\\epsilon$ 进行比较。\n$$\n\\epsilon_{\\boldsymbol{q},i} = \\left\\lvert \\frac{\\lvert \\boldsymbol{q}_i^0 \\rvert - \\lvert \\boldsymbol{q}_i \\rvert}{\\lvert \\boldsymbol{q}_i \\rvert} \\right\\rvert\n$$\n代入大小的表达式：\n$$\n\\epsilon_{\\boldsymbol{q},i} = \\left\\lvert \\frac{\\rho \\frac{\\nu_t}{Sc_t^0} \\lvert \\nabla \\tilde{Y}_i \\rvert - \\rho \\frac{\\nu_t}{Sc_{t,i}} \\lvert \\nabla \\tilde{Y}_i \\rvert}{\\rho \\frac{\\nu_t}{Sc_{t,i}} \\lvert \\nabla \\tilde{Y}_i \\rvert} \\right\\rvert\n$$\n项 $\\rho$、$\\nu_t$ 和 $\\lvert \\nabla \\tilde{Y}_i \\rvert$ 是所有项的公因式，可以消去，前提是 $\\lvert \\nabla \\tilde{Y}_i \\rvert_ \\neq 0$。这是一个合理的假设，因为标量梯度为零的区域 SGS 通量也为零，在那里进行误差分析是无意义的。\n$$\n\\epsilon_{\\boldsymbol{q},i} = \\left\\lvert \\frac{1/Sc_t^0 - 1/Sc_{t,i}}{1/Sc_{t,i}} \\right\\rvert = \\left\\lvert \\frac{1/Sc_t^0}{1/Sc_{t,i}} - 1 \\right\\rvert = \\left\\lvert \\frac{Sc_{t,i}}{Sc_t^0} - 1 \\right\\rvert\n$$\n该表达式也可以写为：\n$$\n\\epsilon_{\\boldsymbol{q},i} = \\left\\lvert \\frac{Sc_{t,i} - Sc_t^0}{Sc_t^0} \\right\\rvert\n$$\n这就是 SGS 标量通量大小相对误差的所求表达式。它是一个仅取决于 $Sc_{t,i}$ 和 $Sc_t^0$ 的无量纲数。\n\n### 2. SGS 标量方差耗散率的相对误差\n\n组分 $i$ 的 SGS 标量方差耗散率 $\\chi_{\\mathrm{sgs},i}$ 定义为：\n$$\n\\chi_{\\mathrm{sgs},i} = 2 D_{t,i} \\lvert \\nabla \\tilde{Y}_i \\rvert^2 = 2 \\left( \\frac{\\nu_t}{Sc_{t,i}} \\right) \\lvert \\nabla \\tilde{Y}_i \\rvert^2\n$$\n使用 $D_t^0$ 的近似耗散率 $\\chi_{\\mathrm{sgs},i}^0$ 为：\n$$\n\\chi_{\\mathrm{sgs},i}^0 = 2 D_t^0 \\lvert \\nabla \\tilde{Y}_i \\rvert^2 = 2 \\left( \\frac{\\nu_t}{Sc_t^0} \\right) \\lvert \\nabla \\tilde{Y}_i \\rvert^2\n$$\n绝对相对误差，我们记为 $\\epsilon_{\\chi,i}$，是：\n$$\n\\epsilon_{\\chi,i} = \\left\\lvert \\frac{\\chi_{\\mathrm{sgs},i}^0 - \\chi_{\\mathrm{sgs},i}}{\\chi_{\\mathrm{sgs},i}} \\right\\rvert = \\left\\lvert \\frac{2 \\frac{\\nu_t}{Sc_t^0} \\lvert \\nabla \\tilde{Y}_i \\rvert^2 - 2 \\frac{\\nu_t}{Sc_{t,i}} \\lvert \\nabla \\tilde{Y}_i \\rvert^2}{2 \\frac{\\nu_t}{Sc_{t,i}} \\lvert \\nabla \\tilde{Y}_i \\rvert^2} \\right\\rvert\n$$\n消去公因项 $2$、$\\nu_t$ 和 $\\lvert \\nabla \\tilde{Y}_i \\rvert^2$：\n$$\n\\epsilon_{\\chi,i} = \\left\\lvert \\frac{1/Sc_t^0 - 1/Sc_{t,i}}{1/Sc_{t,i}} \\right\\rvert = \\left\\lvert \\frac{Sc_{t,i}}{Sc_t^0} - 1 \\right\\rvert\n$$\n这证明了 SGS 标量方差耗散率的相对误差与 SGS 标量通量大小的相对误差是相同的：\n$$\n\\epsilon_{\\chi,i} = \\epsilon_{\\boldsymbol{q},i}\n$$\n因此，基于通量误差的准则等效于基于耗散率误差的准则。\n\n### 3. 丹姆科勒数的定义\n\n丹姆科勒数 $Da$ 是一个无量纲量，它关联了特征混合时间尺度和特征化学时间尺度。组分 $i$ 的亚格子混合时间尺度 $\\tau_{\\mathrm{mix},i}$ 是基于滤波器宽度 $\\Delta$ 和湍流扩散率 $D_{t,i}$ 定义的。\n\n“真实”的混合时间尺度是：\n$$\n\\tau_{\\mathrm{mix},i} = \\frac{\\Delta^2}{D_{t,i}} = \\frac{\\Delta^2 Sc_{t,i}}{\\nu_t}\n$$\n组分 $i$ 的“真实”丹姆科勒数 $Da_i$ 是该时间尺度与化学时间尺度 $\\tau_{\\mathrm{chem},i}$ 的比值：\n$$\nDa_i = \\frac{\\tau_{\\mathrm{mix},i}}{\\tau_{\\mathrm{chem},i}} = \\frac{\\Delta^2 Sc_{t,i}}{\\nu_t \\tau_{\\mathrm{chem},i}}\n$$\n当使用单一施密特数 $Sc_t^0$ 时，我们得到一个近似的混合时间尺度 $\\tau_{\\mathrm{mix},i}^0$ 和一个近似的丹姆科勒数 $Da_i^0$：\n$$\n\\tau_{\\mathrm{mix},i}^0 = \\frac{\\Delta^2}{D_t^0} = \\frac{\\Delta^2 Sc_t^0}{\\nu_t}\n$$\n$$\nDa_i^0 = \\frac{\\tau_{\\mathrm{mix},i}^0}{\\tau_{\\mathrm{chem},i}} = \\frac{\\Delta^2 Sc_t^0}{\\nu_t \\tau_{\\mathrm{chem},i}}\n$$\n\n### 4. 必要性准则及实现\n\n该问题要求一个准则来判断是否必须使用特定于组分的施密特数 $Sc_{t,i}$。这是按算例逐个判断的。对于给定的一组参数，如果对**任何**组分 $i$ 满足以下一个或两个条件，则认为必须使用特定组分的值：\n\n1.  **通量误差条件**：SGS 标量通量大小的绝对相对误差 $\\epsilon_{\\boldsymbol{q},i}$ 超过指定的容差 $\\epsilon$。\n    $$\n    \\left\\lvert \\frac{Sc_{t,i} - Sc_t^0}{Sc_t^0} \\right\\rvert > \\epsilon\n    $$\n2.  **状态改变条件**：从 $Da_i$ 变为 $Da_i^0$ 时，燃烧状态的分类发生改变。状态定义为：如果 $Da \\ge 1$ 则为混合控制，如果 $Da  1$ 则为化学反应控制。如果一个丹姆科勒数大于或等于 $1$ 而另一个小于 $1$，则发生改变。这在逻辑上可以表示为：\n    $$\n    (Da_i \\ge 1 \\text{ and } Da_i^0  1) \\quad \\text{OR} \\quad (Da_i  1 \\text{ and } Da_i^0 \\ge 1)\n    $$\n\n实现过程将遍历测试算例中的每个组分。对于每个组分，它将首先检查通量误差条件。如果满足此条件，则整个算例的准则即被满足 (`True`)，无需进一步检查。如果不满足，则继续检查状态改变条件。如果满足第二个条件，准则即被满足 (`True`)。如果给定组分两个条件都不满足，算法将处理下一个组分。如果一个算例中的所有组分都检查完毕且两个条件均未被触发，则该算例的准则未被满足 (`False`)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef evaluate_necessity(case_params):\n    \"\"\"\n    Evaluates if species-specific turbulent Schmidt numbers are necessary for a given case.\n\n    A species-specific Sc_t is necessary if, for any species in the case:\n    1. The relative error in the SGS scalar flux magnitude exceeds a tolerance epsilon.\n    2. The combustion regime classification (mixing- vs. chemistry-controlled) changes\n       when using the approximated Sc_t0 instead of the true Sc_ti.\n\n    Args:\n        case_params (tuple): A tuple containing the parameters for the case:\n            (Sc_t0, Sc_ti_list, nu_t, delta, tau_chem_i_list, epsilon)\n\n    Returns:\n        bool: True if species-specific Sc_t is necessary, False otherwise.\n    \"\"\"\n    Sc_t0, Sc_ti_list, nu_t, delta, tau_chem_i_list, epsilon = case_params\n\n    # Combine the species-specific properties for synchronized iteration.\n    species_properties = zip(Sc_ti_list, tau_chem_i_list)\n\n    for sc_ti, tau_chem_i in species_properties:\n        # --- Condition 1: Check relative error in SGS scalar flux magnitude ---\n        # The absolute relative error is derived as |(Sc_ti - Sc_t0) / Sc_t0|.\n        rel_flux_error = abs((sc_ti - Sc_t0) / Sc_t0)\n        \n        if rel_flux_error  epsilon:\n            return True  # Necessity criterion met, no need to check further.\n\n        # --- Condition 2: Check for change in combustion regime ---\n        # The Damköhler number is Da = (delta^2 * Sc_t) / (nu_t * tau_chem).\n        # We pre-calculate the common factor to avoid redundant computation.\n        da_common_factor = (delta**2) / (nu_t * tau_chem_i)\n        \n        # Calculate true and approximated Damköhler numbers.\n        da_i = da_common_factor * sc_ti\n        da_i0 = da_common_factor * Sc_t0\n\n        # A regime is mixing-controlled if Da = 1, and chemistry-controlled if Da  1.\n        # We check if this boolean classification changes.\n        regime_true = (da_i = 1)\n        regime_approx = (da_i0 = 1)\n\n        if regime_true != regime_approx:\n            return True  # Necessity criterion met.\n\n    # If the loop completes, neither criterion was met for any species.\n    return False\n\ndef solve():\n    \"\"\"\n    Defines the test suite, evaluates each case, and prints the results\n    in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Sc_t0, {Sc_ti}, nu_t, delta, {tau_chem_i}, epsilon)\n    test_cases = [\n        (0.7, [0.7, 0.7, 0.7], 1.0e-3, 1.0e-2, [0.05, 0.05, 0.05], 0.2),\n        (0.7, [0.3, 0.7, 1.4], 1.0e-3, 1.0e-2, [0.04, 0.08, 0.2], 0.2),\n        (0.7, [0.64, 0.7, 0.77], 3.0e-3, 5.0e-3, [0.03, 0.06, 0.09], 0.2),\n        (0.5, [0.2, 0.5, 1.8], 5.0e-4, 2.0e-2, [0.01, 0.02, 0.07], 0.15),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = evaluate_necessity(case)\n        results.append(result)\n\n    # Final print statement in the exact required format: [result1,result2,...]\n    # The str() of a bool is 'True' or 'False' with a capital letter, as required.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}