## 引言
反应流，特别是燃烧，是自然界和工程应用中普遍存在的核心现象，其特征在于[湍流](@entry_id:151300)、[分子输运](@entry_id:195239)和化学反应之间复杂的多尺度相互作用。准确预测和理解这些过程对于提升能源效率、减少污染物排放和保障安全至关重要。然而，这种复杂性给[数值模拟](@entry_id:146043)带来了巨大挑战，传统的工程模型往往依赖于大量简化假设，限制了我们对基础物理的深入洞察。[直接数值模拟](@entry_id:149543)（DNS）作为一种“第一性原理”的计算方法应运而生，它通过直接求解完整的控制方程，为我们提供了一个无与伦比的“数值显微镜”，以探究湍流燃烧的奥秘。

本文旨在为读者提供一个关于[反应流](@entry_id:190741)DNS的全面指南。我们将首先在“原理与机制”一章中，深入探讨支撑DNS的基石，从质量、动量、能量和组分的守恒定律出发，构建完整的数学框架，并阐明实现模拟所需的解析度标准。随后，在“应用与跨学科联系”一章中，我们将展示DNS如何作为一个强大的研究工具，被用于揭示基础燃烧现象、研究[湍流](@entry_id:151300)与化学的相互作用，并为开发更经济的工程模型提供宝贵的“[真值](@entry_id:636547)”数据。最后，通过“动手实践”部分，读者将有机会将理论知识转化为实际的编程技能，解决模拟中的关键技术问题。通过这一系列的学习，读者将能够全面掌握[反应流](@entry_id:190741)DNS的核心思想、应用价值和实践方法。

## 原理与机制

直接数值模拟（DNS）代表了反应流研究中的一种终极计算方法，其核心思想是直接求解描述流体运动和化学反应的所有相关时空尺度上的控制方程，而不依赖于任何模型来近似[湍流](@entry_id:151300)或[湍流-化学相互作用](@entry_id:756223)。本章旨在深入阐述执行[反应流](@entry_id:190741)DNS所需的基本原理和核心机制。我们将从最基本的守恒定律出发，构建完整的控制方程组；随后，我们将探讨封闭这些方程所必需的热物理、输运和化学模型；接着，通过尺度分析，我们将揭示主导系统行为的关键[无量纲数](@entry_id:260863)；最后，我们将阐明DNS的根本要求——即空间和时间上的解析度标准，并简要讨论实现这些标准的[数值离散化](@entry_id:752782)策略。

### 反应流的控制方程

任何连续介质中的流动，无论是反应性的还是非反应性的，都受到质量、动量和能量守恒定律的支配。对于一个包含 $N_s$ 个化学组分的可压缩、多组分、反应性气体混合物，我们必须额外考虑每个组分的质量守恒。在DNS中，这些守恒定律被表达为一组[偏微分](@entry_id:194612)方程，通常写成守恒形式，因为这种形式在数值上具有优越的性质，并且直接源于对有限控制体的积分平衡分析。

描述该系统的完整控制方程组，即反应性的[可压缩Navier-Stokes](@entry_id:747591)方程组，由以下几个部分组成 ：

**1. 总体[质量守恒](@entry_id:204015)（[连续性方程](@entry_id:195013)）**

该方程描述了混合物密度的变化，其守恒形式为：
$$
\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \boldsymbol{u}) = 0
$$
这里，$\rho$ 是混合物的密度，$\boldsymbol{u}$ 是[质量平均速度](@entry_id:149575)矢量。左侧第一项是密度随时间的变化率（时间项），第二项是质量通量的散度（对流项）。该方程表明，在一个没有源或汇的系统中，密度的局部变化完全由质量的流入或流出决定。

**2. 组分质量守恒**

对于混合物中的每一个组分 $k$（$k=1, \dots, N_s$），其[质量守恒](@entry_id:204015)方程描述了该组分[质量分数](@entry_id:161575) $Y_k$ 的时空演化：
$$
\frac{\partial (\rho Y_k)}{\partial t} + \nabla \cdot (\rho Y_k \boldsymbol{u}) = - \nabla \cdot \boldsymbol{J}_k + \dot{\omega}_k
$$
或者，更常见的守恒形式为：
$$
\frac{\partial (\rho Y_k)}{\partial t} + \nabla \cdot (\rho Y_k \boldsymbol{u} + \boldsymbol{J}_k) = \dot{\omega}_k
$$
其中，$\rho Y_k$ 是组分 $k$ 的质量浓度。方程左侧代表组分 $k$ 质量浓度的变化，它由对流输运（$\nabla \cdot (\rho Y_k \boldsymbol{u})$）引起。右侧包含两个关键的物理过程：分子扩散（由扩散质量通量 $\boldsymbol{J}_k$ 的散度表示）和化学反应（由[质量生成](@entry_id:161427)率 $\dot{\omega}_k$ 表示）。$\boldsymbol{J}_k$ 代表了由于浓度、温度或压力梯度导致的组分 $k$ 相对于[质量平均速度](@entry_id:149575)的运动。$\dot{\omega}_k$ 是单位体积内化学反应生成或消耗组分 $k$ 的净速率。[质量守恒](@entry_id:204015)要求所有组分的扩散通量之和为零（$\sum_{k=1}^{N_s} \boldsymbol{J}_k = \boldsymbol{0}$），并且化学反应中总[质量守恒](@entry_id:204015)（$\sum_{k=1}^{N_s} \dot{\omega}_k = 0$）。

**3. 动量守恒**

动量守恒方程描述了流体动量 $\rho \boldsymbol{u}$ 的变化，其[守恒形式](@entry_id:1122899)为：
$$
\frac{\partial (\rho \boldsymbol{u})}{\partial t} + \nabla \cdot (\rho \boldsymbol{u} \boldsymbol{u} + p \boldsymbol{I}) = \nabla \cdot \boldsymbol{\tau}
$$
这里，$\rho \boldsymbol{u} \boldsymbol{u}$ 是动量因对流产生的通量（一个[二阶张量](@entry_id:199780)），$p$ 是[热力学压力](@entry_id:1133073)，$\boldsymbol{I}$ 是单位张量。左侧的 $\nabla \cdot (p \boldsymbol{I})$（等价于 $\nabla p$）代[表压力](@entry_id:147760)[梯度力](@entry_id:166847)，它是驱动流体运动的主要作用力之一。右侧的 $\nabla \cdot \boldsymbol{\tau}$ 代表由粘性力引起的动量输运，其中 $\boldsymbol{\tau}$ 是粘性应力张量。该方程是在忽略体积力（如重力）的情况下给出的。

**4. 总能量守恒**

总能量守恒方程描述了单位体积总能量 $\rho E$ 的变化。总能量是内能 $e$ 和宏观动能 $\frac{1}{2} \boldsymbol{u} \cdot \boldsymbol{u}$ 的和，即 $E = e + \frac{1}{2} \boldsymbol{u} \cdot \boldsymbol{u}$。其守恒形式为：
$$
\frac{\partial (\rho E)}{\partial t} + \nabla \cdot \left(\boldsymbol{u} (\rho E + p)\right) = \nabla \cdot \left( \boldsymbol{\tau} \cdot \boldsymbol{u} - \boldsymbol{q} - \sum_{k=1}^{N_s} h_k \boldsymbol{J}_k \right)
$$
方程左侧描述了总能量的局部变化和对流输运。[对流通量](@entry_id:158187)项 $\boldsymbol{u} (\rho E + p)$ 不仅包括总能量本身的对流 $\boldsymbol{u} \rho E$，还包括压力 $p$ 在流体运动时所做的功（流功），即 $p \boldsymbol{u}$。

方程右侧的各项代表了能量的扩散和源/汇：
- $\nabla \cdot (\boldsymbol{\tau} \cdot \boldsymbol{u})$：粘性应力对流体微团所做的功，这部分功会转化为内能（粘性耗散）。
- $-\nabla \cdot \boldsymbol{q}$：通过[热传导](@entry_id:143509)增加的能量，其中 $\boldsymbol{q}$ 是热流矢量，通常指向温度降低的方向。
- $-\nabla \cdot (\sum_{k=1}^{N_s} h_k \boldsymbol{J}_k)$：由于组分扩散引起的[能量输运](@entry_id:183081)。每个扩散的组分 $k$ 都携带着其自身的比焓 $h_k$，因此[扩散通量](@entry_id:748422) $\boldsymbol{J}_k$ 伴随着焓的输运。

值得注意的是，在[总能量方程](@entry_id:1133263)的这种形式中，没有显式的化学反应源项。化学能的释放或吸收被巧妙地包含在方程组中：化学反应通过源项 $\dot{\omega}_k$ 改变了组分[质量分数](@entry_id:161575) $Y_k$；而混合物的内能 $e$（以及焓 $h_k$）是温度 $T$ 和所有 $Y_k$ 的函数。因此，当 $Y_k$ 改变时，$e$ 也会随之改变，从而将化学能的转换隐式地计入总能量的平衡中。

### 热物理与化学[封闭模型](@entry_id:1122505)

上述控制方程组包含的未知量多于方程数量，因此不是一个封闭的系统。为了求解这组方程，我们必须提供额外的关系式，即**封闭模型**，来定义状态变量、输运通量和化学源项。

#### 状态方程

我们需要一个状态方程（Equation of State, EoS）来关联[热力学变量](@entry_id:160587)，如压力、密度和温度。对于许多燃烧应用中常见的高温、中低压条件，[理想气体混合物](@entry_id:149212)模型是一个非常好的近似 。

根据[道尔顿分压定律](@entry_id:140483)，混合物的总压力 $p$ 是各组分[分压](@entry_id:168927) $p_k$ 的和。对于每个[理想气体](@entry_id:200096)组分，$p_k V = n_k R_u T$，其中 $n_k$ 是摩尔数，$R_u$ 是[通用气体常数](@entry_id:136843)。这导出了混合物的[理想气体状态方程](@entry_id:137803)：
$$
p = \rho R_m T
$$
其中 $R_m$ 是混合物的比气体常数。这个常数不是一个普适常量，而是依赖于混合物的化学组成。通过基本推导可以证明，$R_m$ 是各组分比气体常数 $R_k = R_u / W_k$（其中 $W_k$ 是组分 $k$ 的[摩尔质量](@entry_id:146110)）的**[质量分数](@entry_id:161575)加权平均**：
$$
R_m = \sum_{k=1}^{N_s} Y_k R_k = R_u \sum_{k=1}^{N_s} \frac{Y_k}{W_k}
$$
这个关系表明，当混合物中轻组分（$W_k$ 较小，$R_k$ 较大）的质量分数增加时，混合物的比气体常数 $R_m$ 会增大。在[低马赫数流动](@entry_id:751506)中，压力和温度变化不大，密度的变化主要由 $R_m$ 的变化驱动。例如，当反应从轻的反应物生成重的产物时，$R_m$ 减小，导致密度 $\rho = p/(R_m T)$ 相应增加 。

#### 输运性质

控制方程中的通量项 $\boldsymbol{\tau}$、$\boldsymbol{q}$ 和 $\boldsymbol{J}_k$ 必须通过[本构关系](@entry_id:186508)与流场的基本变量（速度、温度、组分分数）相关联。

**[粘性应力](@entry_id:261328)张量 $\boldsymbol{\tau}$**：对于[牛顿流体](@entry_id:263796)，[粘性应力](@entry_id:261328)与[速度梯度](@entry_id:261686)成线性关系。对于[可压缩流体](@entry_id:164617)，其形式为：
$$
\boldsymbol{\tau} = \mu \left( \nabla\boldsymbol{u} + (\nabla\boldsymbol{u})^\top \right) - \frac{2}{3} \mu (\nabla \cdot \boldsymbol{u}) \boldsymbol{I}
$$
这里假设了[斯托克斯假设](@entry_id:195909)（[体积粘度](@entry_id:187773)为零）。该模型引入了混合物的**[动力粘度](@entry_id:268228)** $\mu$，它本身是温度和组成的函数。

**热流矢量 $\boldsymbol{q}$**：傅里叶定律描述了由温度梯度引起的[热传导](@entry_id:143509)：
$$
\boldsymbol{q} = -\lambda \nabla T
$$
这引入了混合物的**导热系数** $\lambda$，它也依赖于温度和组成。

**扩散质量通量 $\boldsymbol{J}_k$**：组分扩散的建模是反应流DNS中最复杂的部分之一。主要有两种方法 ：

1.  **混合物平均（Mixture-Averaged）模型**：这是一种简化模型，假设每个组分独立地扩散到一个“平均”的混合物中。其基本形式是菲克定律的推广，但必须进行修正以确保所有扩散通量之和为零。一个满足此约束的正确形式是：
    $$
    \boldsymbol{J}_k = -\rho D_{k,m} \nabla Y_k + Y_k \sum_{l=1}^{N_s} \rho D_{l,m} \nabla Y_l
    $$
    其中 $D_{k,m}$ 是组分 $k$ 的混合物平均扩散系数。第二项是一个修正项，它将由初始菲克通量（第一项）产生的净[质量流](@entry_id:143424)重新分配给所有组分。

2.  **多组分（Multicomponent）模型**：这是一个更精确、更昂贵的模型，它基于气体动理论，并考虑了所有组分对之间的相互作用。其基础是**[Stefan-Maxwell方程](@entry_id:192069)**，它将[扩散驱动力](@entry_id:173813)（[摩尔分数](@entry_id:145460)梯度 $\nabla X_k$）与组分间的摩擦力联系起来：
    $$
    \sum_{j \neq k} \frac{X_j (\boldsymbol{V}_k - \boldsymbol{V}_j)}{D_{kj}} = -\nabla X_k
    $$
    这里，$X_j$ 是组分 $j$ 的摩尔分数，$\boldsymbol{V}_k$ 和 $\boldsymbol{V}_j$ 是组分 $k$ 和 $j$ 的扩散速度（$\boldsymbol{J}_k = \rho Y_k \boldsymbol{V}_k$），$D_{kj}$ 是组分对 $(k,j)$ 的[二元扩散系数](@entry_id:1121572)。这是一个关于[扩散速度](@entry_id:1123720)的[隐式方程](@entry_id:177636)组，求解它比混合物平均模型要复杂得多。

**混合物[输运系数](@entry_id:136790)的计算**：[混合物粘度](@entry_id:1127976) $\mu$ 和导热系数 $\lambda$ 通常使用基于气体动理论的半经验混合法则来计算，例如**Wilke法则**用于粘度，以及类似的Wassiljewa类型法则用于导热系数 。这些法则使用各纯组分的输运性质（$\mu_k, \lambda_k$）和摩尔分数 $X_k$ 来计算混合物的值：
$$
\mu = \sum_{i=1}^{N_s} \frac{X_i \mu_i}{\sum_{j=1}^{N_s} X_j \phi_{ij}} \quad \text{, } \quad \lambda = \sum_{i=1}^{N_s} \frac{X_i \lambda_i}{\sum_{j=1}^{N_s} X_j \psi_{ij}}
$$
其中 $\phi_{ij}$ 和 $\psi_{ij}$ 是考虑了[分子质量](@entry_id:152926)和输运性质差异的相互作用系数。纯组分的导热系数 $\lambda_k$ 本身也需要模型，例如修正的**Eucken关系**，它将导热系数与粘度、比热和气体常数联系起来：$\lambda_k = \mu_k(c_{p,k} + \frac{5}{4}R_k)$。

#### 热化学与反应源项

化学反应通过两个途径影响流动：改变组分（通过 $\dot{\omega}_k$）和释放/吸收能量。能量的转换由[热化学](@entry_id:137688)原理决定 。

对于一个单一的化学计量反应 $\sum_k \nu'_k X_k \leftrightarrows \sum_k \nu''_k X_k$，其净[化学计量系数](@entry_id:204082)为 $\nu_k = \nu''_k - \nu'_k$。单位体积内组分 $k$ 的摩尔生成率 $\dot{\omega}_k^{(m)}$ 与该反应的[反应速率](@entry_id:185114) $R$ 成正比：$\dot{\omega}_k^{(m)} = \nu_k R$。

**反应热** $\Delta h_r(T)$ 定义为按照化学计量消耗反应物并生成产物时系统的焓变。根据[赫斯定律](@entry_id:147875)，它等于产物的总焓减去反应物的[总焓](@entry_id:197863)：
$$
\Delta h_r(T) = \sum_{k=1}^{N_s} \nu_k h_k(T)
$$
其中 $h_k(T)$ 是组分 $k$ 的摩尔焓。由于 $h_k(T)$ 是温度的函数（$h_k(T) = h_k^f + \int_{T_{ref}}^T c_{p,k}(\tau) d\tau$，其中 $h_k^f$ 是[标准生成焓](@entry_id:144770)），所以[反应热](@entry_id:140993)本身也依赖于温度。

在能量方程中，化学能的释放表现为一个源项。在以感焓或温度为变量的能量方程形式中，这个[化学热释放](@entry_id:1122340)率源项 $q_{chem}$ 为：
$$
q_{chem} = -\sum_{k=1}^{N_s} h_k \dot{\omega}_k
$$
（这里使用[质量比](@entry_id:167674)焓和[质量生成](@entry_id:161427)率）。利用上述关系，这个和可以被简化为与[反应热](@entry_id:140993)直接相关：
$$
\sum_{k=1}^{N_s} h_k \dot{\omega}_k = R \cdot \Delta h_r(T)
$$
（这里使用摩尔量）。因此，$q_{chem} = -R \cdot \Delta h_r(T)$。负号的约定确保了对于[放热反应](@entry_id:199674)（$\Delta h_r  0$）和正向进行的反应（$R > 0$），热释放率 $q_{chem}$ 为正，从而增加了系统的热能。

### 特征尺度与[无量纲数](@entry_id:260863)

为了理解和比较反应流中不同物理过程的相对重要性，进行[尺度分析](@entry_id:1131264)和无量纲化是至关重要的。

#### 控制方程的[无量纲化](@entry_id:136704)

通过引入参考长度 $L_{ref}$、速度 $U_{ref}$、密度 $\rho_{ref}$、温度 $T_{ref}$ 等，我们可以将控制方程转化为无量纲形式。这个过程会自然地产生一组[无量纲数](@entry_id:260863)，它们是描述系统行为的关键参数 。例如，[无量纲化](@entry_id:136704)的[动量方程](@entry_id:197225)和能量方程（温度形式）可能呈现如下形式：

$$
\frac{\partial (\rho^* \boldsymbol{u}^*)}{\partial t^*} + \dots = - \frac{1}{\gamma Ma^2} \nabla^* p^* + \frac{1}{Re} \nabla^* \cdot \boldsymbol{\tau}^*
$$
$$
\rho^* \left( \frac{\partial T^*}{\partial t^*} + \dots \right) = \frac{1}{Re \cdot Pr} \nabla^{*2} T^* + \dots
$$
这里，带星号的变量是无量纲的。出现的[无量纲数](@entry_id:260863)包括：

- **雷诺数 (Reynolds Number, $Re = \frac{\rho_{ref} U_{ref} L_{ref}}{\mu_{ref}}$)**：惯性力与粘性力之比，表征流动的[湍流](@entry_id:151300)程度。
- **马赫数 (Mach Number, $Ma = \frac{U_{ref}}{a_{ref}}$)**：流速与声速之比，表征流动的[可压缩性](@entry_id:144559)。
- **普朗特数 (Prandtl Number, $Pr = \frac{\mu_{ref} c_{p,ref}}{\lambda_{ref}}$)**：动量扩散率（[运动粘度](@entry_id:275614)）与[热扩散率](@entry_id:144337)之比，表征动量边界层和热边界层的相对厚度。
- **[施密特数](@entry_id:141441) (Schmidt Number, $Sc_k = \frac{\mu_{ref}}{\rho_{ref} D_{k,ref}}$)**：[动量扩散率](@entry_id:275614)与质量扩散率之比，表征动量边界层和组分[浓度边界层](@entry_id:151238)的相对厚度。
- **丹柯勒数 (Damköhler Number, $Da = \frac{\tau_{flow}}{\tau_{chem}}$)**：流动特征时间与化学反应特征时间之比。例如，$Da = \frac{L_{ref}/U_{ref}}{\rho_{ref}Y_{ref}/\dot{\omega}_{ref}}$。它衡量化学反应相对于流动输运的快慢。

#### [湍流反应流](@entry_id:1133520)的特征尺度

在[湍流反应流](@entry_id:1133520)中，存在一个宽广的尺度范围，从最大的[能量尺度](@entry_id:196201)到最小的耗散尺度。DNS必须解析所有这些尺度。

- **[湍流](@entry_id:151300)尺度**：根据Kolmogorov的理论，[湍流](@entry_id:151300)中存在一个最小的尺度，即**[Kolmogorov长度尺度](@entry_id:262467) $\eta$**，在该尺度上，[粘性耗散](@entry_id:143708)变得重要。它由运动粘度 $\nu$ 和湍[动能耗散](@entry_id:751026)率 $\varepsilon$ 决定：
  $$
  \eta = (\nu^3 / \varepsilon)^{1/4}
  $$

- **标量尺度**：如果一个标量（如温度或[组分浓度](@entry_id:197022)）的扩散率与动量扩散率不同（即$Pr \neq 1$或$Sc \neq 1$），那么标量的最小尺度将不同于[Kolmogorov尺度](@entry_id:270763)。对于气体中常见的$Sc > 1$的情况，标量扩散更慢，其梯度会存在于比$\eta$更小的尺度上。这个最小的标量尺度被称为**[Batchelor尺度](@entry_id:150497) $\lambda_B$**：
  $$
  \lambda_B = \eta \cdot Sc^{-1/2} = (\nu D^2 / \varepsilon)^{1/4}
  $$

- **火焰尺度**：对于预混燃烧，火焰自身具有内部结构，其特征尺度为**层流火焰厚度 $\delta_L$**，通常定义为 $\delta_L = (\lambda/c_p)/(\rho s_L)$。相应的特征时间是**化学时间 $\tau_c = \delta_L / s_L$**，其中$s_L$是[层流火焰速度](@entry_id:202145)。

#### [燃烧分区](@entry_id:1122679)判据数

通过比较这些不同的特征尺度或时间尺度，我们可以定义两个关键的[无量纲数](@entry_id:260863)来对[湍流](@entry_id:151300)预混燃烧进行分类 ：

1.  **丹柯勒数 ($Da$)**：如前所述，它比较了流动时间与化学时间。在湍流燃烧中，通常使用大涡的[周转时间](@entry_id:756237) $\tau_t = L/u'$ 作为流动时间，其中$L$是积分长度尺度，$u'$是[湍流](@entry_id:151300)脉动速度。因此：
    $$
    Da = \frac{\tau_t}{\tau_c} = \frac{L/u'}{\delta_L/s_L}
    $$
    当$Da \gg 1$时，化学反应比大尺度混合快，火焰倾向于保持为一个被[湍流](@entry_id:151300)褶皱的薄层结构（火焰面模型适用）。当$Da \ll 1$时，反应非常慢，在混合完成之前几乎不发生，[湍流](@entry_id:151300)可以完全破坏火焰结构。

2.  **[卡洛维茨数](@entry_id:750984) ($Ka$)**：它比较了化学时间与最小[湍流](@entry_id:151300)涡（Kolmogorov涡）的时间尺度 $\tau_k = (\nu/\varepsilon)^{1/2}$。或者等价地，它比较了火焰厚度 $\delta_L$ 与[Kolmogorov尺度](@entry_id:270763) $\eta$。其定义通常是时间尺度的平方比：
    $$
    Ka = \left(\frac{\tau_c}{\tau_k}\right)^2 = \left(\frac{\delta_L/s_L}{\sqrt{\nu/\varepsilon}}\right)^2 = \frac{\delta_L^2}{\eta^2}
    $$
    当$Ka \ll 1$时，火焰厚度远小于最小的[湍流](@entry_id:151300)涡，[湍流](@entry_id:151300)只能使火焰面褶皱，而不能影响其内部结构。当$Ka > 1$时，最小的[湍流](@entry_id:151300)涡能够侵入火焰的预热区，使其增厚。当$Ka \gg 1$（例如  100）时，[湍流](@entry_id:151300)甚至可以渗透到火焰的反应层，可能导致火焰的局部熄火或进入所谓的“破碎反应区”或“分布式燃烧”状态。

### DNS的核心原则：解析度要求

“直接”[数值模拟](@entry_id:146043)的精髓在于其对物理过程的“完全解析”，这意味着计算网格和时间步长必须足够小，以捕捉到系统中所有相关的物理尺度。

#### 空间解析度

为了确保所有动力学和标量场结构都被准确捕捉，网格间距 $\Delta x$ 必须小于所有相关的最小物理长度尺度。这形成了一个严格的DNS解析度判据 ：
$$
\Delta x \lesssim \min(\eta, \lambda_B, \Delta x_{flame})
$$
其中：
- $\eta$ 是[Kolmogorov尺度](@entry_id:270763)，用于解析最小的速度梯度。
- $\lambda_B$ 是[Batchelor尺度](@entry_id:150497)，用于解析最小的标量梯度。
- $\Delta x_{flame} = \delta_L / N$ 是解析火焰内部结构的要求，其中$N$是要求在层流火焰厚度 $\delta_L$ 内布置的网格点数（通常$N$在10到20之间）。

在实际操作中，必须首先估计或测量出流场中的 $\varepsilon$ 和其他物性参数，计算出这三个尺度，然后取其中的最小值作为确定网格尺寸的依据。例如，对于一个典型的甲烷-空气[湍流](@entry_id:151300)预混火焰，其层流火焰厚度 $\delta_L$ 约为 0.3 mm。若要求用20个点解析，则 $\Delta x_{flame} = 1.5 \times 10^{-5}$ m。而根据典型的[湍流强度](@entry_id:1133493)，[Kolmogorov尺度](@entry_id:270763) $\eta$ 和[Batchelor尺度](@entry_id:150497) $\lambda_B$ 可能在 $10^{-4}$ m 的量级。在这种情况下，火焰解析度要求（$\Delta x_{flame}$）成为最严格的限制，决定了最终的网格尺寸 。

#### 时间解析度

时间步长 $\Delta t$ 同样受到多个物理过程的限制 。对于显式时间积分格式，$\Delta t$ 必须满足：

1.  **扩散稳定性约束**：由[显式格式](@entry_id:1124773)求解扩散项（如[热传导](@entry_id:143509)或[质量扩散](@entry_id:149532)）的稳定性所决定。对于一个简单的向前欧拉/中心差分格式，这导致了一个类似CFL的条件：
    $$
    \Delta t_{diffusion} \le \frac{(\Delta x)^2}{2\kappa_{max}}
    $$
    其中 $\kappa_{max}$ 是系统中最大的扩散系数（包括[热扩散率](@entry_id:144337)和所有组分的质量扩散率）。这个约束表明，随着网格加密，时间步长必须以 $\Delta x^2$ 的速度急剧减小，这使得高分辨率DNS的计算成本非常高。

2.  **反应精度/稳定性约束**：化学反应的速率可能非常快，其时间尺度可以比流动或扩散的时间尺度小得多。这种“刚性”（stiffness）对时间积分提出了严峻挑战。对于显式积分，时间步长必须小于最快的化学反应时间尺度，以保持稳定性和精度。例如，若要求反应项积分的相对[局部截断误差](@entry_id:147703)不超过 $\varepsilon_r$，对于一个一阶反应 $\omega = -k Y$，这可能导致如下约束：
    $$
    \Delta t_{reaction} \le \frac{\sqrt{2\varepsilon_r}}{k}
    $$
    其中 $k$ 是[反应速率常数](@entry_id:187887)。在火焰的高温区域，$k$ 可能非常大，使得 $\Delta t_{reaction}$ 成为主导约束。

最终，模拟所能使用的最大时间步长是所有这些约束中的最小值：$\Delta t = \min(\Delta t_{CFL}, \Delta t_{diffusion}, \Delta t_{reaction}, \dots)$。

### 关于[数值离散化](@entry_id:752782)的说明

实现上述严格的解析度要求，离不开高精度和高保真度的数值方法。DNS中常用的空间离散化方法主要有[有限差分法](@entry_id:1124968)、[有限体积法](@entry_id:141374)和谱方法 。

一个核心的要求是**[离散守恒](@entry_id:1123819)性**。控制方程本身是守恒定律的表达，一个优秀的数值方法应在离散层面精确地保持这种守恒性。

- **[有限体积法](@entry_id:141374)（Finite Volume, FV）** 通过在每个网格单元上[积分控制](@entry_id:270104)方程来构建，其天然的“[通量形式](@entry_id:273811)”确保了只要正确计算单元间的通量，离散质量、动量和能量（在无源项时）就是精确守恒的。这是因为离开一个单元的通量就是进入相邻单元的通量，在对整个区域求和时，内部通量会相互抵消。

- **[有限差分法](@entry_id:1124968)（Finite Difference, FD）** 通过近似[微分算子](@entry_id:140145)来工作。为了实现[离散守恒](@entry_id:1123819)，差分格式必须写成“守恒形式”，并具有特定的代数性质（如“求和为零”特性）。现代高阶守恒[有限差分法](@entry_id:1124968)通常使用**[分部求和](@entry_id:755630)（Summation-by-Parts, SBP）**算子，它在离散层面模拟了分部积分，从而能够精确地处理边界通量并保证全局守恒。

- **谱方法（Spectral Methods）** 利用[全局基函数](@entry_id:749917)（如傅里叶级数）来表示解，具有极高的精度（[指数收敛](@entry_id:142080)）。对于周期性问题，傅里葉谱方法在无源项和扩散项时，可以精确地保持总质量、动量和能量守恒。这是因为在傅里葉空间中，[散度算子](@entry_id:265975)对应于乘以波数矢量 $i\boldsymbol{k}$，对于零波数（均值）模式，其贡献恒为零。然而，谱方法中的[非线性](@entry_id:637147)项（如对流项）在物理[空间计算](@entry_id:905865)时会引入**混淆误差（Aliasing Error）**。必须采用特殊的去混淆技术（如2/3规则）来消除这种非物理的误差，以确保模拟的稳定性和物理保真度。

综上所述，DNS的原理与机制是一个多层次的体系，它始于基本的物理守恒定律，通过一系列数学上严谨的[封闭模型](@entry_id:1122505)和数值上精确的离散化方法，最终实现了对复杂反应流现象的[第一性原理模拟](@entry_id:1125020)。