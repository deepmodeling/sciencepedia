{
    "hands_on_practices": [
        {
            "introduction": "The mechanical heart of the Linear Eddy Model is the \"triplet map,\" an idealized mathematical representation of a turbulent eddy's stirring action. Before diving into complex simulations, it is crucial to understand its fundamental effect on a scalar field. This exercise provides a clean, analytical look at how a single triplet map event amplifies scalar gradients, a key mechanism that precedes and enhances molecular mixing.",
            "id": "4036475",
            "problem": "Consider the Linear Eddy Model (LEM), where subgrid stirring is represented by the triplet map acting on an interval of length $l$. Let the scalar field be defined on the interval $[0,l]$ and initially be linear, $\\phi_{0}(x) = a x + b$ with $a \\neq 0$, and assume no molecular diffusion. The triplet map $s:[0,l]\\to[0,l]$ is the standard piecewise-linear rearrangement given by\n$$\ns(x) = \n\\begin{cases}\n3x, & 0 \\le x < \\frac{l}{3}, \\\\\n2l - 3x, & \\frac{l}{3} \\le x < \\frac{2l}{3}, \\\\\n3x - 2l, & \\frac{2l}{3} \\le x \\le l,\n\\end{cases}\n$$\nwhich compresses the interval by a factor of $3$ into three layers and reverses the middle layer. Under incompressible rearrangement with no diffusion, the post-map scalar is $\\phi_{1}(x) = \\phi_{0}(s(x))$.\n\nStarting from the definitions of the $L^{2}$ norm and the chain rule, compute the effect of a single triplet map on the $L^{2}$ norm of the scalar gradient over $[0,l]$, namely the ratio\n$$\nR \\equiv \\frac{\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}}{\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}}.\n$$\nGive your final answer as a single exact, dimensionless number. Do not round.",
            "solution": "The user wants to compute the ratio of the $L^2$ norms of the scalar gradient before and after the application of a single triplet map.\n\nThe problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   **Domain**: Interval $[0,l]$ of length $l > 0$.\n-   **Initial scalar field**: $\\phi_{0}(x) = a x + b$, where $a \\neq 0$ and $b$ are constants.\n-   **Triplet map**: $s:[0,l]\\to[0,l]$ is defined as\n    $$\n    s(x) =\n    \\begin{cases}\n    3x, & 0 \\le x < \\frac{l}{3} \\\\\n    2l - 3x, & \\frac{l}{3} \\le x < \\frac{2l}{3} \\\\\n    3x - 2l, & \\frac{2l}{3} \\le x \\le l\n    \\end{cases}\n    $$\n-   **Post-map scalar field**: $\\phi_{1}(x) = \\phi_{0}(s(x))$.\n-   **Assumption**: No molecular diffusion.\n-   **Objective**: Compute the ratio $R \\equiv \\frac{\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}}{\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}}$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem uses the standard triplet map from the Linear Eddy Model (LEM), a recognized model in computational combustion and turbulence theory. The mathematical tools ($L^2$ norm, chain rule) are standard. The problem is a valid application of mathematical analysis to a physics-based model.\n-   **Well-Posedness**: All necessary components are defined. The initial condition $\\phi_0(x)$ is specified, the transformation $s(x)$ is explicitly given, and the target quantity $R$ is a well-defined ratio of norms. The condition $a \\neq 0$ ensures the denominator is non-zero. A unique, meaningful solution exists.\n-   **Objectivity**: The problem is stated using precise mathematical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution\n\nThe objective is to compute the ratio $R \\equiv \\frac{\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}}{\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}}$. This requires computing the $L^2$ norm of the gradient for both the initial scalar field, $\\phi_0(x)$, and the mapped scalar field, $\\phi_1(x)$, over the interval $[0,l]$. The $L^2$ norm of a function $f(x)$ on this interval is defined as $\\|f\\|_{L^2(0,l)} = \\sqrt{\\int_0^l (f(x))^2 dx}$.\n\n**1. Denominator Calculation: $\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}$**\n\nFirst, we find the gradient of the initial scalar field $\\phi_{0}(x) = ax + b$.\n$$\n\\partial_x \\phi_0(x) = \\frac{d}{dx}(ax+b) = a\n$$\nNext, we compute the square of its $L^2$ norm:\n$$\n\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}^{2} = \\int_{0}^{l} (\\partial_x \\phi_0(x))^2 dx = \\int_{0}^{l} a^2 dx\n$$\nSince $a$ is a constant, the integral becomes:\n$$\n\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}^{2} = a^2 \\int_{0}^{l} dx = a^2 [x]_{0}^{l} = a^2 l\n$$\nTaking the square root gives the norm:\n$$\n\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)} = \\sqrt{a^2 l} = |a|\\sqrt{l}\n$$\nThe problem specifies $a \\neq 0$, so this norm is non-zero.\n\n**2. Numerator Calculation: $\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}$**\n\nThe mapped scalar field is $\\phi_{1}(x) = \\phi_{0}(s(x))$. We compute its gradient, $\\partial_x \\phi_1(x)$, using the chain rule:\n$$\n\\partial_x \\phi_1(x) = \\frac{d}{dx} \\phi_0(s(x)) = (\\phi_0' \\circ s)(x) \\cdot s'(x) = \\phi_0'(s(x)) \\cdot s'(x)\n$$\nSince $\\phi_0(y) = ay+b$, its derivative is $\\phi_0'(y) = a$. Therefore, $\\phi_0'(s(x)) = a$ for any $x$. The gradient simplifies to:\n$$\n\\partial_x \\phi_1(x) = a \\cdot s'(x)\n$$\nNext, we find the derivative of the piecewise-linear triplet map, $s'(x)$:\n$$\ns'(x) = \\frac{d}{dx} s(x) =\n\\begin{cases}\n3, & 0 < x < \\frac{l}{3} \\\\\n-3, & \\frac{l}{3} < x < \\frac{2l}{3} \\\\\n3, & \\frac{2l}{3} < x < l\n\\end{cases}\n$$\nThe derivative is undefined at $x=l/3$ and $x=2l/3$, but these points have measure zero and do not affect the value of the integral for the $L^2$ norm.\n\nNow we can write the expression for $\\partial_x \\phi_1(x)$:\n$$\n\\partial_x \\phi_1(x) =\n\\begin{cases}\n3a, & 0 < x < \\frac{l}{3} \\\\\n-3a, & \\frac{l}{3} < x < \\frac{2l}{3} \\\\\n3a, & \\frac{2l}{3} < x < l\n\\end{cases}\n$$\nTo compute $\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}$, we first find its square:\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}^{2} = \\int_{0}^{l} (\\partial_x \\phi_1(x))^2 dx\n$$\nWe split the integral over the three subintervals:\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}^{2} = \\int_{0}^{l/3} (3a)^2 dx + \\int_{l/3}^{2l/3} (-3a)^2 dx + \\int_{2l/3}^{l} (3a)^2 dx\n$$\nThe integrand in all three cases is $(3a)^2 = (-3a)^2 = 9a^2$:\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}^{2} = \\int_{0}^{l/3} 9a^2 dx + \\int_{l/3}^{2l/3} 9a^2 dx + \\int_{2l/3}^{l} 9a^2 dx\n$$\nAn alternative way to see this is that $(\\partial_x\\phi_1(x))^2 = (a \\cdot s'(x))^2 = a^2 (s'(x))^2$, and $(s'(x))^2 = 9$ almost everywhere on $[0,l]$. Thus:\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}^{2} = \\int_{0}^{l} a^2 (s'(x))^2 dx = \\int_{0}^{l} 9a^2 dx\n$$\nEvaluating this integral:\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}^{2} = 9a^2 \\int_{0}^{l} dx = 9a^2 [x]_{0}^{l} = 9a^2l\n$$\nTaking the square root gives the norm:\n$$\n\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)} = \\sqrt{9a^2l} = 3|a|\\sqrt{l}\n$$\n\n**3. Final Ratio Calculation**\n\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{\\|\\partial_{x}\\phi_{1}\\|_{L^{2}(0,l)}}{\\|\\partial_{x}\\phi_{0}\\|_{L^{2}(0,l)}} = \\frac{3|a|\\sqrt{l}}{|a|\\sqrt{l}}\n$$\nSince $a \\neq 0$ and $l > 0$, the terms $|a|$ and $\\sqrt{l}$ are non-zero and cancel out.\n$$\nR = 3\n$$\nThe result is a dimensionless number, as expected. The application of a single triplet map to a linear scalar field amplifies the $L^2$ norm of its gradient by a factor of $3$.",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "Building on the model's mechanics, we now apply the LEM framework to a central question in turbulent combustion: is a reaction limited by the speed of mixing or the speed of chemistry? This problem guides you through the process of defining a characteristic subgrid mixing timescale, using scaling laws consistent with the LEM, and comparing it to a chemical time derived from Arrhenius kinetics. The resulting Damköhler number is a powerful diagnostic tool for characterizing the subgrid combustion regime.",
            "id": "4036524",
            "problem": "A central task in modeling combustion with Large Eddy Simulation (LES) is to quantify whether subgrid-scale combustion is limited by mixing or by chemical reaction kinetics. Within the Linear Eddy Model (LEM) for subgrid mixing, the characteristic subgrid mixing timescale at the filter width is governed by the competition between inertial-range turbulent straining and molecular diffusion. Using first-principles scaling for each mechanism and first-order Arrhenius kinetics for chemistry, determine the subgrid combustion regime by evaluating the dimensionless ratio of the characteristic subgrid mixing time to the characteristic chemical time.\n\nAssume a single-step, first-order reaction in an isothermal, statistically stationary turbulent flow. The LES filter width is $\\,\\Delta = 1.5\\,\\mathrm{mm}\\,$, the turbulent kinetic energy dissipation rate is $\\,\\epsilon = 0.50\\,\\mathrm{m^{2}\\,s^{-3}}\\,$, and the mixture molecular diffusivity is $\\,D = 2.0 \\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}}\\,$. The temperature is $\\,T = 1500\\,\\mathrm{K}\\,$. The reaction rate constant obeys the Arrhenius law with pre-exponential factor $\\,A = 2.0 \\times 10^{7}\\,\\mathrm{s^{-1}}\\,$ and activation energy $\\,E_{a} = 8.0 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}\\,$. Use the universal gas constant $\\,R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,$.\n\nStarting from inertial-range Kolmogorov scaling to obtain a characteristic turbulent eddy-turnover time at scale $\\,\\Delta\\,$ and from Fickian diffusion to obtain a characteristic diffusive time at the same scale, define the subgrid mixing time as the dominant (shorter) of these two timescales. For chemistry, start from first-order kinetics and the Arrhenius law to obtain the characteristic chemical time. Evaluate the resulting dimensionless ratio using the provided parameters.\n\nRound your final numerical answer to three significant figures. No units are to be included in the final answer. After computing the ratio, briefly state whether subgrid combustion is mixing-limited or kinetically limited based on its magnitude.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Model: Linear Eddy Model (LEM) for subgrid mixing in Large Eddy Simulation (LES).\n- Task: Evaluate the dimensionless ratio of characteristic subgrid mixing time to characteristic chemical time.\n- LES filter width: $\\Delta = 1.5\\,\\mathrm{mm}$\n- Turbulent kinetic energy dissipation rate: $\\epsilon = 0.50\\,\\mathrm{m^{2}\\,s^{-3}}$\n- Mixture molecular diffusivity: $D = 2.0 \\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}}$\n- Temperature: $T = 1500\\,\\mathrm{K}$\n- Reaction kinetics: First-order Arrhenius law.\n- Pre-exponential factor: $A = 2.0 \\times 10^{7}\\,\\mathrm{s^{-1}}$\n- Activation energy: $E_{a} = 8.0 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}$\n- Universal gas constant: $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n- Definition of subgrid mixing time ($\\tau_{mix}$): The shorter of the turbulent eddy-turnover time ($\\tau_{turb}$) and the diffusive time ($\\tau_{diff}$) at scale $\\Delta$. $\\tau_{mix} = \\min(\\tau_{turb}, \\tau_{diff})$.\n- Definition of turbulent time ($\\tau_{turb}$): From inertial-range Kolmogorov scaling.\n- Definition of diffusive time ($\\tau_{diff}$): From Fickian diffusion.\n- Definition of chemical time ($\\tau_{chem}$): From first-order kinetics and the Arrhenius law.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, drawing upon established principles from turbulence theory (Kolmogorov scaling), molecular transport (Fickian diffusion), and chemical kinetics (Arrhenius law). These concepts are standard in the field of computational combustion. The problem is well-posed, providing all necessary parameters and clear instructions for deriving the required timescales, leading to a unique numerical solution. The language is objective and precise. The provided physical values are consistent and realistic for a combustion scenario. For instance, the filter width $\\Delta$ is a typical scale for LES of flames, and the kinetic and transport properties are of plausible orders of magnitude. The problem structure is logical and does not contain any contradictions, ambiguities, or unmet dependencies.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe problem requires the evaluation of a dimensionless ratio, which is a form of the Damköhler number, to determine the controlling regime for subgrid-scale combustion. This ratio is defined as $\\mathcal{D} = \\frac{\\tau_{mix}}{\\tau_{chem}}$, where $\\tau_{mix}$ is the characteristic subgrid mixing time and $\\tau_{chem}$ is the characteristic chemical time.\n\n**1. Characteristic Subgrid Mixing Time ($\\tau_{mix}$)**\n\nThe mixing time is determined by the faster of two processes at the LES filter scale $\\Delta$: turbulent stirring and molecular diffusion.\n\nFirst, we determine the characteristic turbulent eddy-turnover time, $\\tau_{turb}$. According to Kolmogorov's theory for the inertial subrange of turbulence, the time required for an eddy of size $l$ to turn over is related to the turbulent kinetic energy dissipation rate, $\\epsilon$. At the scale $\\Delta$, this time is given by:\n$$\n\\tau_{turb} = \\left(\\frac{\\Delta^2}{\\epsilon}\\right)^{1/3}\n$$\n\nSecond, we determine the characteristic time for molecular diffusion, $\\tau_{diff}$. Based on Fick's law, the time required for a species to diffuse across a length scale $\\Delta$ with a diffusivity $D$ is:\n$$\n\\tau_{diff} = \\frac{\\Delta^2}{D}\n$$\n\nThe problem states that the characteristic subgrid mixing time, $\\tau_{mix}$, is the shorter (dominant) of these two timescales:\n$$\n\\tau_{mix} = \\min(\\tau_{turb}, \\tau_{diff})\n$$\n\nWe now substitute the given values, ensuring all units are in the SI system.\n$\\Delta = 1.5\\,\\mathrm{mm} = 1.5 \\times 10^{-3}\\,\\mathrm{m}$\n$\\epsilon = 0.50\\,\\mathrm{m^{2}\\,s^{-3}}$\n$D = 2.0 \\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}}$\n\nCalculating $\\tau_{turb}$:\n$$\n\\tau_{turb} = \\left(\\frac{(1.5 \\times 10^{-3}\\,\\mathrm{m})^2}{0.50\\,\\mathrm{m^{2}\\,s^{-3}}}\\right)^{1/3} = \\left(\\frac{2.25 \\times 10^{-6}\\,\\mathrm{m^2}}{0.50\\,\\mathrm{m^{2}\\,s^{-3}}}\\right)^{1/3} = (4.5 \\times 10^{-6}\\,\\mathrm{s^3})^{1/3} \\approx 1.651 \\times 10^{-2}\\,\\mathrm{s}\n$$\n\nCalculating $\\tau_{diff}$:\n$$\n\\tau_{diff} = \\frac{(1.5 \\times 10^{-3}\\,\\mathrm{m})^2}{2.0 \\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}}} = \\frac{2.25 \\times 10^{-6}\\,\\mathrm{m^2}}{2.0 \\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}}} = 1.125 \\times 10^{-1}\\,\\mathrm{s} = 0.1125\\,\\mathrm{s}\n$$\n\nComparing the two timescales:\n$1.651 \\times 10^{-2}\\,\\mathrm{s} < 0.1125\\,\\mathrm{s}$. Thus, the turbulent turnover is the faster process.\nTherefore, the characteristic mixing time is:\n$$\n\\tau_{mix} = \\tau_{turb} \\approx 1.651 \\times 10^{-2}\\,\\mathrm{s}\n$$\n\n**2. Characteristic Chemical Time ($\\tau_{chem}$)**\n\nThe problem specifies a single-step, first-order reaction. The characteristic time for such a reaction is the inverse of the reaction rate constant, $k$:\n$$\n\\tau_{chem} = \\frac{1}{k}\n$$\nThe rate constant $k$ follows the Arrhenius law:\n$$\nk = A \\exp\\left(-\\frac{E_a}{RT}\\right)\n$$\nwhere $A$ is the pre-exponential factor, $E_a$ is the activation energy, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n\nCombining these, the chemical timescale is:\n$$\n\\tau_{chem} = \\frac{1}{A} \\exp\\left(\\frac{E_a}{RT}\\right)\n$$\n\nWe substitute the given values:\n$A = 2.0 \\times 10^{7}\\,\\mathrm{s^{-1}}$\n$E_{a} = 8.0 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}$\n$R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n$T = 1500\\,\\mathrm{K}$\n\nFirst, we calculate the dimensionless term in the exponent:\n$$\n\\frac{E_a}{RT} = \\frac{8.0 \\times 10^{4}\\,\\mathrm{J\\,mol^{-1}}}{(8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(1500\\,\\mathrm{K})} = \\frac{8.0 \\times 10^{4}}{12471} \\approx 6.415\n$$\n\nNow, we calculate $\\tau_{chem}$:\n$$\n\\tau_{chem} = \\frac{1}{2.0 \\times 10^{7}\\,\\mathrm{s^{-1}}} \\exp(6.415) \\approx (0.5 \\times 10^{-7}\\,\\mathrm{s}) \\times (610.9) \\approx 3.055 \\times 10^{-5}\\,\\mathrm{s}\n$$\n\n**3. Dimensionless Ratio and Regime Identification**\n\nFinally, we compute the dimensionless ratio $\\mathcal{D}$:\n$$\n\\mathcal{D} = \\frac{\\tau_{mix}}{\\tau_{chem}} \\approx \\frac{1.651 \\times 10^{-2}\\,\\mathrm{s}}{3.055 \\times 10^{-5}\\,\\mathrm{s}} \\approx 540.59\n$$\n\nRounding the result to three significant figures gives $541$.\n\nThis ratio, the Damköhler number ($Da$), compares the timescale of mixing to the timescale of chemical reaction.\n- If $Da \\gg 1$, then $\\tau_{mix} \\gg \\tau_{chem}$. This means chemistry is much faster than mixing. The overall process is limited by the slower step, which is mixing. This is the **mixing-limited** regime.\n- If $Da \\ll 1$, then $\\tau_{mix} \\ll \\tau_{chem}$. This means mixing is much faster than chemistry. The process is limited by the slower chemical reaction. This is the **kinetically limited** regime.\n\nSince our calculated value is $\\mathcal{D} \\approx 541$, which is significantly greater than $1$, the subgrid combustion process is **mixing-limited**.",
            "answer": "$$\n\\boxed{541}\n$$"
        },
        {
            "introduction": "The true power of the LEM lies in its ability to model the continuous interplay between turbulent stirring and molecular diffusion. This final practice moves from static analysis to a dynamic simulation, where you will implement the characteristic sequence of LEM events: diffusion followed by stirring. By tracking the evolution of scalar variance, you will directly observe the mixing process and investigate how the balance between momentum and scalar transport, quantified by the Schmidt number $Sc$, governs the rate of mixing at the subgrid scale.",
            "id": "4036493",
            "problem": "You are asked to implement a one-dimensional Linear Eddy Model (LEM) for subgrid mixing appropriate for computational combustion, in which a passive scalar undergoes alternating periods of molecular diffusion and measure-preserving stirring via a triplet map. The goal is to compute the evolution of the scalar variance and quantify how it depends on the Schmidt number (the ratio of kinematic viscosity to molecular diffusivity).\n\nStarting point and modeling assumptions:\n- Consider a one-dimensional periodic domain of length $L$ with spatial coordinate $x \\in [0,L)$ and a computational grid of $N$ uniformly spaced points.\n- The passive scalar field $Y(x,t)$ evolves according to the advection-diffusion equation\n$$\n\\frac{\\partial Y}{\\partial t} + u(x,t)\\frac{\\partial Y}{\\partial x} = D \\frac{\\partial^2 Y}{\\partial x^2},\n$$\nwhere $D$ is the molecular diffusivity and $u(x,t)$ is a turbulent velocity field. In the Linear Eddy Model, the effect of $u(x,t)$ is modeled as an instantaneous measure-preserving rearrangement called a triplet map applied on an interval, while between such rearrangements the scalar evolves by pure diffusion.\n\n- The kinematic viscosity is prescribed as $\\nu$ (in $\\mathrm{m^2/s}$), and the molecular diffusivity is determined by the Schmidt number $Sc = \\nu/D$. Hence $D = \\nu/Sc$.\n\nInitial condition and evolution protocol:\n- Let the initial scalar be a step function:\n$$\nY(x,0) = \\begin{cases}\n1, & 0 \\le x < L/2,\\\\\n0, & L/2 \\le x < L,\n\\end{cases}\n$$\ni.e., a discontinuity at $x = L/2$.\n- Evolve the scalar by alternating $M$ cycles of:\n  1. A pure diffusion period of duration $\\Delta t$ with periodic boundary conditions. Implement this diffusion step exactly in spectral space by updating each Fourier mode $\\hat{Y}_k$ according to:\n  $$\n  \\hat{Y}_k(t+\\Delta t) = \\hat{Y}_k(t)\\,\\exp\\!\\left(-D\\,k^2\\,\\Delta t\\right),\n  $$\n  where $k = 2\\pi n/L$ with integer $n$ indexing the Fourier modes.\n  2. A triplet map applied deterministically to a central interval $[a,b]$ of length $f L$, where $f \\in (0,1]$ is the eddy-length fraction. The triplet map replaces the content of $[a,b]$ by three compressed copies of itself of equal length, with the middle copy reversed, and leaves the scalar outside $[a,b]$ unchanged. The mapping must be implemented as a piecewise-linear, measure-preserving rearrangement on $[a,b]$ using linear interpolation on the computational grid. The interval should be placed centrally so that $a = (L - fL)/2$ and $b = a + fL$.\n\nQuantities of interest:\n- The domain-averaged mean is\n$$\n\\overline{Y}(t) = \\frac{1}{L}\\int_0^L Y(x,t)\\,\\mathrm{d}x,\n$$\nand the scalar variance is\n$$\n\\sigma^2(t) = \\frac{1}{L}\\int_0^L \\left(Y(x,t) - \\overline{Y}(t)\\right)^2 \\mathrm{d}x.\n$$\nOn a uniform grid, compute the discrete approximation of $\\sigma^2(t)$ at the final time $t = M\\Delta t$.\n\nPhysical units and numerical specifications:\n- Use $L = 1\\,\\mathrm{m}$, $N = 2048$, $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $M = 40$, and $\\Delta t = 0.02\\,\\mathrm{s}$. The scalar $Y$ is dimensionless. Report the final scalar variance as a dimensionless quantity.\n\nTest suite:\nFor each test case, set the Schmidt number $Sc$ and eddy-length fraction $f$, compute $D=\\nu/Sc$, perform the evolution protocol above, and return the final scalar variance $\\sigma^2(M\\Delta t)$ as a decimal float. Use the following five test cases:\n- Case $1$: $Sc = 0.7$, $f = 0.6$.\n- Case $2$: $Sc = 1.0$, $f = 0.3$.\n- Case $3$: $Sc = 10.0$, $f = 0.6$.\n- Case $4$: $Sc = 100.0$, $f = 0.6$.\n- Case $5$: $Sc = 1.0$, $f = 1.0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the final scalar variances for the five test cases in order as a comma-separated list enclosed in square brackets, with each value formatted to exactly $8$ digits after the decimal point, for example, $[v_1,v_2,v_3,v_4,v_5]$.",
            "solution": "The problem statement is evaluated as scientifically and mathematically sound. It provides a complete and self-contained description of a numerical task rooted in the established principles of computational fluid dynamics and turbulence modeling. Specifically, it details the implementation of a one-dimensional Linear Eddy Model (LEM) for passive scalar mixing, a recognized subgrid-scale model in combustion science. The parameters, initial/boundary conditions, and evolution protocol are unambiguously specified, ensuring the problem is well-posed. The model combines the analytical solution to the diffusion equation in spectral space with the application of a measure-preserving triplet map, both of which are standard and formalizable techniques. There are no contradictions, missing data, or violations of physical principles. Therefore, the problem is deemed valid and a reasoned solution can be constructed.\n\nThe solution requires a numerical simulation of the evolution of a scalar field $Y(x,t)$ on a one-dimensional periodic domain of length $L$, discretized by $N$ grid points. The simulation proceeds for a total of $M$ cycles, where each cycle consists of a molecular diffusion step followed by a turbulent stirring step modeled by a triplet map.\n\n**1. System Initialization**\n\n- The spatial domain is the interval $x \\in [0, L)$, with the length specified as $L = 1\\,\\mathrm{m}$.\n- A uniform computational grid is defined with $N=2048$ points, $x_j = j \\frac{L}{N}$ for $j = 0, 1, \\dots, N-1$.\n- The initial scalar field $Y(x,0)$ is a step function described by:\n$$\nY(x_j, 0) = \\begin{cases} 1 & \\text{for } x_j < L/2 \\\\ 0 & \\text{for } x_j \\ge L/2 \\end{cases}\n$$\n- The angular wavenumbers $k$ corresponding to the discrete grid are required for the spectral diffusion step. For a domain of length $L$ with $N$ points, the spatial frequencies are $\\nu_n = n/L$. The corresponding angular wavenumbers are $k_n = 2\\pi\\nu_n$. These are computed efficiently using the `numpy.fft.fftfreq` function, which returns the frequencies $\\nu_n$ in an order compatible with the Fast Fourier Transform (FFT) algorithm.\n- For each test case defined by a Schmidt number $Sc$ and an eddy-length fraction $f$, the molecular diffusivity $D$ is calculated from the given kinematic viscosity $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$ using the definition $Sc=\\nu/D$, which gives $D = \\nu/Sc$.\n\n**2. Time Evolution Protocol**\n\nThe system is evolved over $M=40$ cycles, with each cycle representing a time interval of $\\Delta t=0.02\\,\\mathrm{s}$. For each cycle, from time $t$ to $t+\\Delta t$, the following two steps are performed in sequence.\n\n**2.1. Diffusion Step**\nThis step models the effect of molecular diffusion. The scalar field $Y(x,t)$ is advanced by solving the pure diffusion equation, $\\frac{\\partial Y}{\\partial t} = D \\frac{\\partial^2 Y}{\\partial x^2}$, over the period $\\Delta t$ with periodic boundary conditions.\n- The field $Y(x,t)$ is transformed into Fourier space using the FFT to obtain its spectral representation, $\\hat{Y}(k,t)$.\n- In Fourier space, the diffusion equation becomes an ordinary differential equation for each mode $k$, with the exact solution:\n$$\n\\hat{Y}(k, t+\\Delta t) = \\hat{Y}(k, t) \\exp(-D k^2 \\Delta t)\n$$\n- The factor $\\exp(-Dk^2\\Delta t)$ is a spectral transfer function that damps high-wavenumber modes more strongly, representing viscous dissipation of scalar gradients.\n- The updated spectral field $\\hat{Y}(k, t+\\Delta t)$ is transformed back to physical space using an inverse FFT (IFFT). The result, which we can denote $Y^*(x, t+\\Delta t)$, is the diffused scalar field. The real part of the IFFT output is taken, as the initial field is real and any imaginary component is due to numerical floating-point inaccuracies.\n\n**2.2. Triplet Map (Stirring) Step**\nThis step models the scrambling effect of a turbulent eddy. It is implemented as an instantaneous, measure-preserving rearrangement of the scalar field within a specified interval.\n- The triplet map is applied to the diffused field $Y^*(x, t+\\Delta t)$ to produce the final field for the cycle, $Y(x, t+\\Delta t)$.\n- The map is applied to a central interval $[a,b]$ of length $L_{eddy} = fL$, where $a = (L - L_{eddy})/2$ and $b = a + L_{eddy}$. Scalar values outside this interval are unaffected.\n- For grid points $x_j$ located within $[a,b]$, the new scalar value $Y(x_j, t+\\Delta t)$ is determined by interpolating the pre-map field $Y^*(x, t+\\Delta t)$ at a set of source coordinates $x_{source, j}$. The function $T: x_j \\mapsto x_{source, j}$ defines the mapping. For the triplet map, it is:\n$$\nT(x) = \\begin{cases}\na + 3(x - a) & \\text{if } a \\le x \\le a + L_{eddy}/3, \\\\\nb - 3(x - [a + L_{eddy}/3]) & \\text{if } a + L_{eddy}/3 < x \\le a + 2L_{eddy}/3, \\\\\na + 3(x - [a + 2L_{eddy}/3]) & \\text{if } a + 2L_{eddy}/3 < x \\le b.\n\\end{cases}\n$$\nThis map takes the scalar field on the interval $[a,b]$, compresses it three-fold, and places three copies back into $[a,b]$, with the middle copy being inverted.\n- Since a source coordinate $x_{source, j} = T(x_j)$ will not, in general, lie on a grid point, linear interpolation is required, as specified. The value $Y^*(x_{source, j}, t+\\Delta t)$ is computed using `numpy.interp` with the `period=L` option to correctly handle the periodic nature of the domain.\n\n**3. Final Variance Calculation**\n\n- After completing all $M$ cycles, the simulation concludes at the final time $t_{final} = M\\Delta t$.\n- The final scalar variance, $\\sigma^2(t_{final})$, is computed from the final scalar field $Y(x, t_{final})$. On the discrete grid, this is an average over all grid points.\n- First, the domain-averaged mean scalar value is computed:\n$$\n\\overline{Y} = \\frac{1}{N} \\sum_{j=0}^{N-1} Y(x_j, t_{final})\n$$\n- The variance is then the mean of the squared deviations from the mean:\n$$\n\\sigma^2 = \\frac{1}{N} \\sum_{j=0}^{N-1} (Y(x_j, t_{final}) - \\overline{Y})^2\n$$\n- This entire procedure is repeated for each of the five $(Sc, f)$ test cases provided. The resulting five variance values are formatted and presented as the final answer.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Linear Eddy Model simulation for all test cases\n    and print the results in the specified format.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.7, 0.6),   # Case 1: Sc = 0.7, f = 0.6\n        (1.0, 0.3),   # Case 2: Sc = 1.0, f = 0.3\n        (10.0, 0.6),  # Case 3: Sc = 10.0, f = 0.6\n        (100.0, 0.6), # Case 4: Sc = 100.0, f = 0.6\n        (1.0, 1.0)    # Case 5: Sc = 1.0, f = 1.0\n    ]\n\n    results = []\n    for sc, f in test_cases:\n        # Run the simulation for one case.\n        variance = run_lem_simulation(sc, f)\n        results.append(variance)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\n\ndef run_lem_simulation(sc: float, f: float) -> float:\n    \"\"\"\n    Performs a one-dimensional Linear Eddy Model simulation for a passive scalar.\n\n    Args:\n        sc: The Schmidt number (Sc = nu/D).\n        f: The eddy-length fraction for the triplet map.\n\n    Returns:\n        The final scalar variance after M cycles.\n    \"\"\"\n    # Physical and numerical specifications from the problem statement\n    L = 1.0            # Domain length [m]\n    N = 2048           # Number of grid points\n    nu = 1.5e-5        # Kinematic viscosity [m^2/s]\n    M = 40             # Number of evolution cycles\n    dt = 0.02          # Time step duration [s]\n\n    # Derived parameters\n    D = nu / sc        # Molecular diffusivity [m^2/s]\n\n    # Set up computational grids\n    # Spatial grid\n    x = np.linspace(0, L, N, endpoint=False)\n    # Wavenumber grid for FFT\n    dx = L / N\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Initial condition: step function\n    Y = np.zeros(N, dtype=np.float64)\n    Y[x < L / 2] = 1.0\n\n    # Pre-calculate the spectral diffusion operator for efficiency\n    diffusion_operator = np.exp(-D * k**2 * dt)\n\n    # Main evolution loop\n    for _ in range(M):\n        # --- Step 1: Diffusion in spectral space ---\n        Y_hat = np.fft.fft(Y)\n        Y_hat *= diffusion_operator\n        Y = np.real(np.fft.ifft(Y_hat))\n\n        # --- Step 2: Triplet map stirring in physical space ---\n        Y_old = Y.copy()\n        \n        L_eddy = f * L\n        a = (L - L_eddy) / 2\n        b = a + L_eddy\n\n        # Identify grid points within the mapping interval [a, b)\n        map_indices = np.where((x >= a) & (x < b))[0]\n        \n        if map_indices.size > 0:\n            x_target = x[map_indices]\n            x_source = np.zeros_like(x_target)\n            \n            # Define boundaries of the three sub-regions for the map\n            b1 = a + L_eddy / 3\n            b2 = a + 2 * L_eddy / 3\n            \n            # Create boolean masks for each sub-region\n            mask1 = x_target <= b1\n            mask2 = (x_target > b1) & (x_target <= b2)\n            mask3 = x_target > b2\n            \n            # Apply the piecewise-linear triplet map to get source coordinates\n            x_source[mask1] = a + 3 * (x_target[mask1] - a)\n            x_source[mask2] = b - 3 * (x_target[mask2] - b1)\n            x_source[mask3] = a + 3 * (x_target[mask3] - b2)\n\n            # Interpolate values from the old field at source coordinates\n            # Use period=L for correct handling of periodic boundary conditions\n            Y[map_indices] = np.interp(x_source, x, Y_old, period=L)\n\n    # Calculate final scalar variance\n    mean_Y = np.mean(Y)\n    variance = np.mean((Y - mean_Y)**2)\n    \n    return variance\n\nsolve()\n```",
            "answer": "[0.05388710,0.11306385,0.00511853,0.00051125,0.03874312]"
        }
    ]
}