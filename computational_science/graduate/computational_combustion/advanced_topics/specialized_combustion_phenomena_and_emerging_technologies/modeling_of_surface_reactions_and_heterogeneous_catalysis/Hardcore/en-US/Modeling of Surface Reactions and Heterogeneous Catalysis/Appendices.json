{
    "hands_on_practices": [
        {
            "introduction": "An essential skill in catalysis is the ability to extract fundamental kinetic parameters from experimental data. Temperature Programmed Desorption (TPD) is a cornerstone technique in surface science used to study the interaction between adsorbates and surfaces. This exercise demonstrates how to analyze a TPD spectrum by deriving the celebrated Redhead equation from the first-order Polanyi–Wigner rate law, providing a direct link between an experimental observable—the peak desorption temperature—and the activation energy for desorption, $E_{\\text{des}}$. ",
            "id": "4042357",
            "problem": "A catalytic carbon monoxide desorption experiment relevant to computational combustion is performed on a platinum surface using Temperature Programmed Desorption (TPD), where the temperature is ramped linearly in time. Assume first-order desorption kinetics with no readsorption and negligible lateral interactions. The desorption rate follows the Polanyi–Wigner form and the desorption activation barrier is independent of coverage.\n\nGiven the following TPD observables and kinetic prefactor: peak temperature $T_{\\text{p}} = 540\\,\\mathrm{K}$, constant heating rate $\\beta = 2.0\\,\\mathrm{K\\,s^{-1}}$, and a temperature-independent pre-exponential (attempt frequency) $\\nu = 1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$, derive from first principles a closed-form analytic expression for the desorption activation energy $E_{\\text{des}}$ in terms of $T_{\\text{p}}$, $\\beta$, and $\\nu$, and then evaluate it numerically. Use the universal gas constant $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. Express the final energy in $\\mathrm{kJ\\,mol^{-1}}$ and round your answer to four significant figures.",
            "solution": "The user wants me to act as a meticulous STEM professor to solve a problem related to Temperature Programmed Desorption (TPD). The first step is to validate the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Physical System:** Carbon monoxide desorption from a platinum surface.\n- **Experiment:** Temperature Programmed Desorption (TPD).\n- **Temperature Program:** Linear ramp, constant heating rate $\\beta = 2.0\\,\\mathrm{K\\,s^{-1}}$.\n- **Kinetic Model:** First-order desorption kinetics ($n=1$), described by the Polanyi–Wigner equation.\n- **Assumptions:** No readsorption, negligible lateral interactions between adsorbates, and the desorption activation energy $E_{\\text{des}}$ and pre-exponential factor $\\nu$ are independent of coverage.\n- **Observable:** Peak desorption temperature $T_{\\text{p}} = 540\\,\\mathrm{K}$.\n- **Constants:** Pre-exponential factor $\\nu = 1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$, universal gas constant $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- **Task:**\n    1. Derive a closed-form analytic expression for the desorption activation energy $E_{\\text{des}}$ from first principles.\n    2. Evaluate $E_{\\text{des}}$ numerically, expressing the result in $\\mathrm{kJ\\,mol^{-1}}$ and rounding to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes a standard surface science experiment (TPD) and is based on fundamental principles of chemical kinetics and heterogeneous catalysis. The Polanyi-Wigner equation is a cornerstone of TPD analysis. The provided values are physically realistic for the CO/Pt system. The problem is scientifically sound.\n- **Well-Posed:** The problem is clearly defined and provides all necessary information to derive a unique relationship between the given parameters and the unknown $E_{\\text{des}}$. The derivation leads to a specific analytical expression whose value can be uniquely determined.\n- **Objective:** The problem is phrased using precise, standard scientific terminology. There is no ambiguity, subjectivity, or bias.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically grounded, well-posed, objective, and contains no internal contradictions or missing information. The solution process may proceed.\n\n### Solution\n\nThe desorption process is described by the Polanyi–Wigner equation, which gives the rate of change of surface coverage $\\theta$ with time $t$:\n$$ r_{\\text{des}} = -\\frac{d\\theta}{dt} = \\nu \\theta^n \\exp\\left(-\\frac{E_{\\text{des}}}{RT}\\right) $$\nHere, $n$ is the order of the desorption reaction, $\\nu$ is the pre-exponential factor, $E_{\\text{des}}$ is the activation energy for desorption, $R$ is the universal gas constant, and $T$ is the absolute temperature.\n\nThe problem states that the desorption is a first-order process, so we set $n=1$:\n$$ -\\frac{d\\theta}{dt} = \\nu \\theta \\exp\\left(-\\frac{E_{\\text{des}}}{RT}\\right) $$\nIn a TPD experiment, the temperature is increased linearly with time, $T(t) = T_0 + \\beta t$, where $\\beta$ is the constant heating rate. This implies $\\frac{dT}{dt} = \\beta$, or $dt = \\frac{dT}{\\beta}$.\n\nThe desorption rate, which is the quantity measured in a TPD spectrum, is at its maximum at the peak temperature $T_{\\text{p}}$. To find this maximum, we must set the derivative of the rate with respect to time (or temperature) to zero. Let's differentiate the rate equation with respect to time $t$:\n$$ \\frac{d}{dt}\\left(-\\frac{d\\theta}{dt}\\right) = \\frac{d}{dt}\\left[\\nu \\theta \\exp\\left(-\\frac{E_{\\text{des}}}{RT}\\right)\\right] = 0 \\quad \\text{at} \\quad T = T_{\\text{p}} $$\nApplying the product rule to the right-hand side gives:\n$$ \\nu \\left[ \\frac{d\\theta}{dt} \\exp\\left(-\\frac{E_{\\text{des}}}{RT}\\right) + \\theta \\frac{d}{dt}\\left(\\exp\\left(-\\frac{E_{\\text{des}}}{RT}\\right)\\right) \\right]_{T=T_{\\text{p}}} = 0 $$\nWe evaluate the terms at the peak temperature $T_{\\text{p}}$.\nThe first term inside the bracket contains $\\frac{d\\theta}{dt}$, which we substitute from the rate equation itself:\n$$ \\frac{d\\theta}{dt} = -\\nu \\theta \\exp\\left(-\\frac{E_{\\text{des}}}{RT_{\\text{p}}}\\right) $$\nThe second term contains the time derivative of the exponential factor, which we evaluate using the chain rule:\n$$ \\frac{d}{dt}\\left(\\exp\\left(-\\frac{E_{\\text{des}}}{RT}\\right)\\right) = \\exp\\left(-\\frac{E_{\\text{des}}}{RT}\\right) \\cdot \\left(\\frac{E_{\\text{des}}}{RT^2}\\right) \\cdot \\frac{dT}{dt} = \\exp\\left(-\\frac{E_{\\text{des}}}{RT}\\right) \\cdot \\frac{E_{\\text{des}}\\beta}{RT^2} $$\nSubstituting these expressions back into the condition for the maximum rate, evaluated at $T=T_{\\text{p}}$, and dividing by the non-zero quantity $\\nu$:\n$$ \\left[ \\left(-\\nu \\theta \\exp\\left(-\\frac{E_{\\text{des}}}{RT_{\\text{p}}}\\right)\\right) \\exp\\left(-\\frac{E_{\\text{des}}}{RT_{\\text{p}}}\\right) + \\theta \\left(\\exp\\left(-\\frac{E_{\\text{des}}}{RT_{\\text{p}}}\\right) \\frac{E_{\\text{des}}\\beta}{RT_{\\text{p}}^2}\\right) \\right] = 0 $$\nWe can factor out the common term $\\theta(T_{\\text{p}}) \\exp\\left(-\\frac{E_{\\text{des}}}{RT_{\\text{p}}}\\right)$, which is non-zero at the peak:\n$$ -\\nu \\exp\\left(-\\frac{E_{\\text{des}}}{RT_{\\text{p}}}\\right) + \\frac{E_{\\text{des}}\\beta}{RT_{\\text{p}}^2} = 0 $$\nRearranging this equation gives the well-known Redhead equation, which implicitly relates $E_{\\text{des}}$ to the experimental observables:\n$$ \\frac{E_{\\text{des}}}{RT_{\\text{p}}^2} = \\frac{\\nu}{\\beta} \\exp\\left(-\\frac{E_{\\text{des}}}{RT_{\\text{p}}}\\right) $$\nTo find a closed-form analytic expression for $E_{\\text{des}}$, we rearrange this transcendental equation. Let $x = \\frac{E_{\\text{des}}}{RT_{\\text{p}}}$. The equation becomes:\n$$ \\frac{x RT_{\\text{p}}}{RT_{\\text{p}}^2} = \\frac{\\nu}{\\beta} \\exp(-x) $$\n$$ \\frac{x}{T_{\\text{p}}} = \\frac{\\nu}{\\beta} \\exp(-x) $$\nMultiplying by $T_{\\text{p}} \\exp(x)$, we get:\n$$ x \\exp(x) = \\frac{\\nu T_{\\text{p}}}{\\beta} $$\nThis equation is in the canonical form $z \\exp(z) = y$, where the solution for $z$ is given by the Lambert W function, $z = W(y)$. In our case, $z=x$ and $y = \\frac{\\nu T_{\\text{p}}}{\\beta}$.\nTherefore, the solution for $x$ is:\n$$ x = W\\left(\\frac{\\nu T_{\\text{p}}}{\\beta}\\right) $$\nSubstituting back $x = \\frac{E_{\\text{des}}}{RT_{\\text{p}}}$, we obtain the closed-form analytic expression for the desorption activation energy:\n$$ E_{\\text{des}} = RT_{\\text{p}} W\\left(\\frac{\\nu T_{\\text{p}}}{\\beta}\\right) $$\nNow, we evaluate this expression numerically using the given values:\n$T_{\\text{p}} = 540\\,\\mathrm{K}$\n$\\beta = 2.0\\,\\mathrm{K\\,s^{-1}}$\n$\\nu = 1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$\n$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\nFirst, we calculate the argument of the Lambert W function:\n$$ \\frac{\\nu T_{\\text{p}}}{\\beta} = \\frac{(1.0 \\times 10^{13}\\,\\mathrm{s^{-1}}) \\times (540\\,\\mathrm{K})}{2.0\\,\\mathrm{K\\,s^{-1}}} = 2.7 \\times 10^{15} $$\nNext, we evaluate the Lambert W function for this argument. For large arguments $y$, $W(y) \\approx \\ln(y) - \\ln(\\ln(y))$.\n$$ W(2.7 \\times 10^{15}) \\approx 32.064299 $$\nNow, we substitute this value back into the expression for $E_{\\text{des}}$:\n$$ E_{\\text{des}} = (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (540\\,\\mathrm{K}) \\times (32.064299) $$\n$$ E_{\\text{des}} \\approx 143969.8\\,\\mathrm{J\\,mol^{-1}} $$\nThe problem asks for the answer in units of $\\mathrm{kJ\\,mol^{-1}}$, rounded to four significant figures.\n$$ E_{\\text{des}} = 143.9698\\,\\mathrm{kJ\\,mol^{-1}} $$\nRounding to four significant figures gives:\n$$ E_{\\text{des}} = 144.0\\,\\mathrm{kJ\\,mol^{-1}} $$",
            "answer": "$$\n\\boxed{144.0}\n$$"
        },
        {
            "introduction": "High-fidelity models in computational combustion must accurately couple surface chemistry with gas-phase transport phenomena. This requires formulating boundary conditions that rigorously enforce species conservation at the catalytic interface. This practice focuses on deriving the boundary condition for the Maxwell–Stefan diffusive fluxes, $\\boldsymbol{J}$, based on a specified vector of surface reaction rates, $\\boldsymbol{\\sigma}$. By applying the principle of mass conservation to an interfacial control volume, you will learn to translate the microscopic events of surface reaction into a consistent continuum-level boundary condition essential for multicomponent CFD simulations. ",
            "id": "4042420",
            "problem": "Consider a steady, isothermal, isobaric, multicomponent ideal-gas mixture of $N$ species adjacent to a planar catalytic wall in a computational combustion system. Let the unit normal vector $\\boldsymbol{n}$ point from the wall into the gas. Denote by $\\boldsymbol{N} \\in \\mathbb{R}^{N}$ the vector of species molar fluxes relative to the stationary laboratory frame, by $\\boldsymbol{J} \\in \\mathbb{R}^{N}$ the vector of Maxwell–Stefan diffusive molar fluxes defined relative to the molar-average velocity, and by $\\boldsymbol{x} \\in \\mathbb{R}^{N}$ the vector of gas-phase mole fractions. These satisfy the fundamental decomposition $\\boldsymbol{N} = \\boldsymbol{J} + (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{N})\\,\\boldsymbol{x}$ with the constraint $\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{J} = 0$, where $\\mathbf{1} \\in \\mathbb{R}^{N}$ is the vector of ones. The wall hosts heterogeneous reactions that impose a specified surface consumption vector $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{N}$ with components $\\sigma_{i}$ in $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$, defined such that $\\sigma_{i} > 0$ indicates net consumption of gas-phase species $i$ by the surface, and $\\sigma_{i} < 0$ indicates net production of species $i$ from the surface into the gas.\n\nAssume no interfacial storage and that all interfacial source/sink terms are represented by $\\boldsymbol{\\sigma}$. Denote by $\\boldsymbol{x}_{w}$ the mole-fraction vector evaluated on the gas side at the wall. Using only species conservation at an infinitesimal interfacial control volume and the above flux decomposition, derive the boundary condition that relates the normal component of the Maxwell–Stefan diffusive molar flux at the wall, $\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}$, to the specified surface consumption vector $\\boldsymbol{\\sigma}$ and the wall-adjacent mole fractions $\\boldsymbol{x}_{w}$. Express your final answer as a single compact analytic expression in vector form involving $\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}$, $\\boldsymbol{\\sigma}$, $\\boldsymbol{x}_{w}$, and $\\mathbf{1}$. No numerical evaluation is required, and no rounding is needed. Do not include units in your final expression.",
            "solution": "The user wants me to first validate and then solve a problem concerning the derivation of a boundary condition for species transport at a catalytic surface.\n\n### Problem Validation\n\nI will begin by performing the mandatory validation of the problem statement.\n\n#### Step 1: Extract Givens\n\nThe givens are extracted verbatim from the problem statement:\n*   **System**: A steady, isothermal, isobaric, multicomponent ideal-gas mixture of $N$ species adjacent to a planar catalytic wall.\n*   **Geometry**: A planar catalytic wall. The unit normal vector $\\boldsymbol{n}$ points from the wall into the gas.\n*   **Variables**:\n    *   $\\boldsymbol{N} \\in \\mathbb{R}^{N}$: Vector of species molar fluxes relative to the stationary laboratory frame.\n    *   $\\boldsymbol{J} \\in \\mathbb{R}^{N}$: Vector of Maxwell–Stefan diffusive molar fluxes defined relative to the molar-average velocity.\n    *   $\\boldsymbol{x} \\in \\mathbb{R}^{N}$: Vector of gas-phase mole fractions.\n    *   $\\boldsymbol{x}_{w}$: The mole-fraction vector evaluated on the gas side at the wall.\n    *   $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{N}$: The specified surface consumption vector, with components $\\sigma_{i}$ in units of $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$.\n*   **Definitions and Constraints**:\n    *   Flux decomposition: $\\boldsymbol{N} = \\boldsymbol{J} + (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{N})\\,\\boldsymbol{x}$.\n    *   Diffusive flux constraint: $\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{J} = 0$.\n    *   Vector of ones: $\\mathbf{1} \\in \\mathbb{R}^{N}$.\n    *   Interpretation of $\\sigma_{i}$: $\\sigma_{i} > 0$ indicates net consumption of gas-phase species $i$ by the surface; $\\sigma_{i} < 0$ indicates net production of species $i$ from the surface.\n*   **Assumptions**:\n    *   No interfacial storage.\n    *   All interfacial source/sink terms are represented by $\\boldsymbol{\\sigma}$.\n*   **Objective**: Derive the boundary condition that relates the normal component of the Maxwell–Stefan diffusive molar flux at the wall, $\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}$, to the specified surface consumption vector $\\boldsymbol{\\sigma}$ and the wall-adjacent mole fractions $\\boldsymbol{x}_{w}$.\n\n#### Step 2: Validate Using Extracted Givens\n\n*   **Scientific Grounding**: The problem is well-grounded in the principles of continuum mechanics, transport phenomena, and chemical kinetics, specifically within the field of heterogeneous catalysis and combustion modeling. The flux decomposition and the Maxwell–Stefan formulation are standard and fundamental concepts in multicomponent transport theory.\n*   **Well-Posedness**: The problem is well-posed. It provides a clear objective, all necessary equations and definitions ($\\boldsymbol{N} = \\boldsymbol{J} + (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{N})\\,\\boldsymbol{x}$), variables ($\\boldsymbol{\\sigma}$, $\\boldsymbol{x}_w$), and physical principles (species conservation at an interface) required to derive a unique relationship.\n*   **Objectivity**: The language is precise, technical, and free of any subjectivity or ambiguity. The definitions and notation, while compact, are standard in the specialized literature.\n*   **Flaw Analysis**:\n    1.  **Scientific/Factual Unsoundness**: None. The model presented is a standard, scientifically valid simplification used in computational fluid dynamics and combustion.\n    2.  **Non-Formalizable/Irrelevant**: None. The problem is a formal and relevant exercise in transport theory.\n    3.  **Incomplete/Contradictory Setup**: The problem is self-contained. The provided information is sufficient and consistent. The notation $\\boldsymbol{n} \\cdot \\boldsymbol{J}_w$, where $\\boldsymbol{J} \\in \\mathbb{R}^N$, is a slight abuse of notation common in the field, which is consistently interpreted as the vector of normal components of the species fluxes. This does not represent a contradiction but a standard convention.\n    4.  **Unrealistic/Infeasible**: None. The assumptions are standard idealizations for building a tractable model.\n    5.  **Ill-Posed/Poorly Structured**: None. The problem leads to a unique and stable mathematical relationship.\n    6.  **Pseudo-Profound/Trivial**: None. The derivation, while straightforward for an expert, requires a correct application of physical principles and algebraic manipulation, making it a substantive and non-trivial problem.\n    7.  **Outside Scientific Verifiability**: None. The derivation is a mathematical procedure based on established physical laws.\n\n#### Step 3: Verdict and Action\nThe problem is **valid**. I will now proceed with the derivation of the solution.\n\n### Derivation of the Boundary Condition\n\nThe derivation is based on the principle of species conservation at the gas-surface interface.\n\nFirst, we establish the mass balance for each species $i$ at the interface. The system is at steady state, and there is no storage of species at the interface. Therefore, for each species $i$, the molar flux of that species from the gas phase to the wall must be equal to the net rate at which it is consumed by surface reactions.\n\nThe molar flux of species $i$ is a vector quantity, which we shall denote $\\boldsymbol{N}_i$. The component of this flux normal to the wall and pointing into the gas is given by $\\boldsymbol{n} \\cdot \\boldsymbol{N}_i$. The problem uses a compact vector notation where $\\boldsymbol{N} \\in \\mathbb{R}^N$ is the vector of these normal flux components, such that the $i$-th component of a vector like $\\boldsymbol{N}$ is the scalar normal flux of species $i$. Let's denote the vector of normal components of the total molar flux at the wall as $\\boldsymbol{N}_{n,w}$.\n\nThe problem states that $\\sigma_i$ is the surface consumption rate of species $i$. Therefore, the surface *production* rate for species $i$ is $-\\sigma_i$. The species conservation law dictates that the flux of species $i$ leaving the surface and entering the gas, $(\\boldsymbol{N}_{n,w})_i$, must equal its production rate at the surface. In vector form, this conservation law is:\n$$\n\\boldsymbol{N}_{n,w} = -\\boldsymbol{\\sigma}\n$$\nHere, $\\boldsymbol{N}_{n,w}$ is the vector of molar fluxes normal to the wall, evaluated at the wall.\n\nThe problem provides the fundamental decomposition of the total molar flux into a diffusive part and a convective part. In our notation for normal components, this is:\n$$\n\\boldsymbol{N}_{n} = \\boldsymbol{J}_{n} + (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{N}_{n})\\,\\boldsymbol{x}\n$$\nwhere $\\boldsymbol{J}_{n}$ is the vector of normal components of the Maxwell-Stefan diffusive fluxes. The problem denotes this quantity as $\\boldsymbol{n} \\cdot \\boldsymbol{J}$. Let us adopt this notation for the remainder of the derivation. Evaluated at the wall, the decomposition is:\n$$\n\\boldsymbol{N}_{n,w} = (\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}) + (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{N}_{n,w})\\,\\boldsymbol{x}_{w}\n$$\n\nOur goal is to find an expression for $\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}$. We can rearrange the equation above to isolate this term:\n$$\n\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w} = \\boldsymbol{N}_{n,w} - (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{N}_{n,w})\\,\\boldsymbol{x}_{w}\n$$\n\nNow, we substitute the species conservation relationship, $\\boldsymbol{N}_{n,w} = -\\boldsymbol{\\sigma}$, into this equation:\n$$\n\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w} = (-\\boldsymbol{\\sigma}) - (\\mathbf{1}^{\\mathsf{T}} (-\\boldsymbol{\\sigma}))\\,\\boldsymbol{x}_{w}\n$$\n\nThis expression can be simplified. The scalar product $\\mathbf{1}^{\\mathsf{T}} (-\\boldsymbol{\\sigma})$ is equal to $-(\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma})$.\n$$\n\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w} = -\\boldsymbol{\\sigma} - (-(\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma}))\\,\\boldsymbol{x}_{w}\n$$\n$$\n\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w} = -\\boldsymbol{\\sigma} + (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma})\\,\\boldsymbol{x}_{w}\n$$\nThis is the desired boundary condition. It relates the diffusive flux at the wall to the surface reaction rates and the local mole fractions.\n\nTo verify the consistency of this result, we can check if it satisfies the given constraint $\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{J} = 0$. Applying the operator $\\mathbf{1}^{\\mathsf{T}}$ to our derived expression for $\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}$:\n$$\n\\mathbf{1}^{\\mathsf{T}} (\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}) = \\mathbf{1}^{\\mathsf{T}} \\left( -\\boldsymbol{\\sigma} + (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma})\\,\\boldsymbol{x}_{w} \\right)\n$$\nDistributing the transpose:\n$$\n\\mathbf{1}^{\\mathsf{T}} (\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}) = -\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma} + \\mathbf{1}^{\\mathsf{T}} \\left( (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma})\\,\\boldsymbol{x}_{w} \\right)\n$$\nThe term $(\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma})$ is a scalar, representing the total molar rate of consumption at the surface. It can be factored out of the second term:\n$$\n\\mathbf{1}^{\\mathsf{T}} (\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}) = -\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma} + (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma}) (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{x}_{w})\n$$\nBy definition, the sum of mole fractions is unity: $\\mathbf{1}^{\\mathsf{T}}\\boldsymbol{x}_{w} = \\sum_{i=1}^{N} x_{i,w} = 1$. Substituting this into the equation:\n$$\n\\mathbf{1}^{\\mathsf{T}} (\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}) = -\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma} + (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma})(1) = -\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma} + \\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma} = 0\n$$\nThe derived expression is indeed consistent with the fundamental constraint on the Maxwell-Stefan diffusive fluxes.\n\nThe final expression for the boundary condition is therefore:\n$$\n\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w} = -\\boldsymbol{\\sigma} + (\\mathbf{1}^{\\mathsf{T}} \\boldsymbol{\\sigma})\\,\\boldsymbol{x}_{w}\n$$\nThe problem asks for the single compact analytic expression that $\\boldsymbol{n} \\cdot \\boldsymbol{J}_{w}$ is related to. This is the right-hand side of the derived equation.",
            "answer": "$$\n\\boxed{-\\boldsymbol{\\sigma} + (\\mathbf{1}^{\\mathsf{T}}\\boldsymbol{\\sigma})\\boldsymbol{x}_{w}}\n$$"
        },
        {
            "introduction": "The interplay between reaction kinetics and transport processes in catalytic reactors often leads to complex nonlinear dynamics, including multiple steady states (ignition/extinction) and self-sustaining oscillations. Predicting these behaviors is critical for reactor design, optimization, and safety. This advanced practice introduces pseudo-arclength continuation, a powerful numerical method for tracing the full steady-state solution curve of a system, and shows how to use linear stability analysis of the Jacobian matrix to detect the onset of oscillatory behavior at a Hopf bifurcation. ",
            "id": "4042372",
            "problem": "You are tasked with constructing and implementing a numerical continuation and stability detection method for a reduced catalytic wall reactor model relevant to computational combustion with surface reactions and heterogeneous catalysis. Begin from fundamental conservation laws and well-tested principles: a near-wall control volume with a single first-order exothermic surface reaction of a reactant. The gas-phase reactant concentration and wall temperature are modeled by two coupled Ordinary Differential Equations (ODEs), derived from mass and energy balances with linear exchange to the bulk and to a thermal bath, and an Arrhenius-type surface reaction. The state vector is $x = [c, T]$, where $c$ is the dimensionless near-wall reactant concentration normalized by its inlet value, and $T$ is the dimensionless wall temperature normalized by the bath temperature. The control parameter is the Damköhler number (Da), denoted $D_a$, representing the ratio of characteristic reaction to transport time scales. The activation parameter is $\\beta > 0$, and the exothermicity parameter is $\\gamma > 0$. The time scales for mass and heat exchange are $\\tau_m > 0$ and $\\tau_h > 0$, respectively. The dimensionless dynamical system is:\n$$\n\\frac{dc}{dt} = \\frac{1 - c}{\\tau_m} - D_a \\exp\\!\\left(-\\frac{\\beta}{T}\\right) c,\n$$\n$$\n\\frac{dT}{dt} = \\frac{1 - T}{\\tau_h} + \\gamma D_a \\exp\\!\\left(-\\frac{\\beta}{T}\\right) c.\n$$\nSteady states $(c^\\ast, T^\\ast)$ satisfy $F(x, D_a) = 0$ with\n$$\nF(x, D_a) =\n\\begin{bmatrix}\n\\frac{1 - c}{\\tau_m} - D_a \\exp\\!\\left(-\\frac{\\beta}{T}\\right) c \\\\\n\\frac{1 - T}{\\tau_h} + \\gamma D_a \\exp\\!\\left(-\\frac{\\beta}{T}\\right) c\n\\end{bmatrix}.\n$$\nLinear stability is governed by the Jacobian matrix $J(x^\\ast, D_a) = \\left.\\frac{\\partial F}{\\partial x}\\right|_{(x^\\ast, D_a)}$, whose $2 \\times 2$ entries are:\n$$\n\\frac{\\partial f_1}{\\partial c} = -\\frac{1}{\\tau_m} - D_a \\exp\\!\\left(-\\frac{\\beta}{T}\\right), \\quad\n\\frac{\\partial f_1}{\\partial T} = - D_a c \\exp\\!\\left(-\\frac{\\beta}{T}\\right) \\frac{\\beta}{T^2},\n$$\n$$\n\\frac{\\partial f_2}{\\partial c} = \\gamma D_a \\exp\\!\\left(-\\frac{\\beta}{T}\\right), \\quad\n\\frac{\\partial f_2}{\\partial T} = -\\frac{1}{\\tau_h} + \\gamma D_a c \\exp\\!\\left(-\\frac{\\beta}{T}\\right) \\frac{\\beta}{T^2}.\n$$\nA Hopf bifurcation is detected when the eigenvalues of $J$ cross the imaginary axis as a complex conjugate pair. For a $2 \\times 2$ Jacobian, this is detected by the conditions: the determinant $\\det(J) > 0$, the discriminant $\\Delta = \\operatorname{tr}(J)^2 - 4 \\det(J) < 0$ on both sides of the crossing, and the trace $\\operatorname{tr}(J)$ changes sign between consecutive continuation points. Use these criteria to detect the first Hopf bifurcation along the continuation path.\n\nImplement a Pseudo-Arclength Continuation (PAC) scheme to trace the steady-state solution branch $x^\\ast(D_a)$ as $D_a$ varies. Your algorithm must:\n- Initialize at $D_a = 0$ with the steady state $x^\\ast = [1, 1]$.\n- Compute the initial tangent by solving $J(x^\\ast, 0) \\frac{dx^\\ast}{d D_a} = - \\frac{\\partial F}{\\partial D_a}(x^\\ast, 0)$, where\n$$\n\\frac{\\partial F}{\\partial D_a}(x, D_a) =\n\\begin{bmatrix}\n- \\exp\\!\\left(-\\frac{\\beta}{T}\\right) c \\\\\n\\gamma \\exp\\!\\left(-\\frac{\\beta}{T}\\right) c\n\\end{bmatrix}.\n$$\n- Use a predictor step along the tangent with arc-length increment $\\Delta s$, forming the predicted $(x_{\\text{pred}}, D_{a,\\text{pred}})$.\n- Apply a Newton corrector to solve the augmented system\n$$\nG(x, D_a) =\n\\begin{bmatrix}\nF(x, D_a) \\\\\nt_x^\\top (x - x_{\\text{prev}}) + t_{D_a} (D_a - D_{a,\\text{prev}}) - \\Delta s\n\\end{bmatrix} = 0,\n$$\nwhere $t = [t_x, t_{D_a}]$ is the previous tangent and $(x_{\\text{prev}}, D_{a,\\text{prev}})$ is the prior corrected solution. Use the augmented Jacobian\n$$\n\\frac{\\partial G}{\\partial (x, D_a)} =\n\\begin{bmatrix}\nJ(x, D_a) & \\frac{\\partial F}{\\partial D_a}(x, D_a) \\\\\nt_x^\\top & t_{D_a}\n\\end{bmatrix}.\n$$\n- After each corrected solution, update the tangent by recomputing $\\frac{dx^\\ast}{d D_a}$ via solving $J \\frac{dx^\\ast}{d D_a} = - \\frac{\\partial F}{\\partial D_a}$ and normalizing $[t_x, t_{D_a}] = \\left[\\frac{dx^\\ast}{d D_a}, 1\\right]$.\n- Detect Hopf bifurcation using the conditions above; approximate the crossing $D_a$ by linear interpolation of $\\operatorname{tr}(J)$ between consecutive points where the sign change occurs and the discriminant is negative on both sides.\n\nAll variables and parameters are dimensionless. Use robust numerical safeguards to avoid division by zero, such as replacing any evaluation of $\\exp(-\\beta/T)$ by $\\exp(-\\beta/\\max(T, \\epsilon))$ with a small positive $\\epsilon$. Use Newton tolerance $\\varepsilon$ and a maximum number of iterations for the corrector. If the corrector fails to converge at any step, terminate the continuation for that test case.\n\nTest Suite:\nRun your program for the following $3$ parameter sets, each given as $(\\tau_m, \\tau_h, \\beta, \\gamma, D_{a,\\max}, \\Delta s, N_{\\text{steps}}, \\varepsilon)$, where $N_{\\text{steps}}$ is the maximum number of continuation steps. For each case, start at $D_a = 0$, continue until either $D_a \\ge D_{a,\\max}$ or $N_{\\text{steps}}$ is reached, and report the first detected Hopf bifurcation $D_a$ as a floating-point value. If no Hopf bifurcation is detected, output $-1.0$ for that test case.\n- Case $1$: $(0.5, 5.0, 12.0, 8.0, 6.0, 0.02, 400, 10^{-10})$.\n- Case $2$ (edge, likely no Hopf): $(2.0, 2.0, 8.0, 2.0, 10.0, 0.02, 500, 10^{-10})$.\n- Case $3$ (boundary, higher activation and exothermicity): $(0.1, 10.0, 15.0, 10.0, 3.0, 0.01, 500, 10^{-10})$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the $3$ floating-point results (one per test case) as a comma-separated list enclosed in square brackets, for example $[r_1,r_2,r_3]$. No physical units are involved; all outputs are dimensionless.",
            "solution": "The problem requires the implementation of a numerical continuation and stability analysis method to trace the steady-state solutions of a catalytic wall reactor model and detect Hopf bifurcations. The method specified is a Pseudo-Arclength Continuation (PAC) scheme combined with linear stability analysis based on the system's Jacobian matrix. The problem is validated as scientifically sound, well-posed, and containing all necessary information for a unique numerical solution.\n\nThe physical system is described by a pair of coupled ordinary differential equations for the dimensionless near-wall reactant concentration, $c$, and the dimensionless wall temperature, $T$. The state vector is $x = [c, T]^\\top$. The evolution of the system is governed by:\n$$\n\\frac{d c}{dt} = f_1(c, T, D_a) = \\frac{1 - c}{\\tau_m} - D_a \\exp\\!\\left(-\\frac{\\beta}{T}\\right) c\n$$\n$$\n\\frac{d T}{dt} = f_2(c, T, D_a) = \\frac{1 - T}{\\tau_h} + \\gamma D_a \\exp\\!\\left(-\\frac{\\beta}{T}\\right) c\n$$\nwhere $\\tau_m$ and $\\tau_h$ are mass and heat transport timescales, $\\beta$ is the activation parameter, $\\gamma$ is the exothermicity parameter, and $D_a$ is the Damköhler number, which serves as the continuation parameter.\n\nSteady states $(c^\\ast, T^\\ast)$ are solutions to the algebraic system $F(x, D_a) = [f_1, f_2]^\\top = 0$. The core of the task is to trace the solution curve $x^\\ast(D_a)$ in the state-parameter space $(x, D_a)$.\n\nThe implementation proceeds as follows:\n\n**1. Pseudo-Arclength Continuation (PAC)**\nThe PAC method is employed to follow the solution branch, including through turning points (folds) where standard continuation with the parameter $D_a$ as the independent variable would fail.\n\n**1.1. Initialization**\nThe continuation starts from a known solution. At $D_a = 0$, the system simplifies to $\\frac{1-c}{\\tau_m} = 0$ and $\\frac{1-T}{\\tau_h} = 0$, yielding the trivial steady state $x^\\ast = [c^\\ast, T^\\ast] = [1, 1]$. This is the first point on our solution branch.\n\n**1.2. Tangent Vector Calculation**\nThe tangent vector to the solution curve provides the direction for the predictor step. It is obtained by differentiating the steady-state equation $F(x(D_a), D_a) = 0$ with respect to the arclength parameter $s$. A more direct approach, as specified, involves computing the derivative with respect to $D_a$. Let the tangent vector be $t = [\\frac{dx^\\ast}{ds}, \\frac{dD_a}{ds}]$. By the chain rule, $\\frac{\\partial F}{\\partial x} \\frac{dx^\\ast}{dD_a} + \\frac{\\partial F}{\\partial D_a} = 0$. This gives the linear system for the state-space component of the tangent:\n$$\nJ(x^\\ast, D_a) \\frac{dx^\\ast}{dD_a} = - \\frac{\\partial F}{\\partial D_a}(x^\\ast, D_a)\n$$\nwhere $J$ is the Jacobian matrix, and $\\frac{\\partial F}{\\partial D_a}$ is the partial derivative of the system function with respect to the parameter. The problem specifies constructing the unnormalized tangent as $[\\frac{dx^\\ast}{dD_a}, 1]$ and then normalizing it to unit length, $t = [t_x, t_{D_a}]$. This procedure is valid away from fold bifurcations.\nThe partial derivatives required are:\n$$\nJ = \\begin{bmatrix} -\\frac{1}{\\tau_m} - R & -R \\frac{\\beta c}{T^2} \\\\ \\gamma R & -\\frac{1}{\\tau_h} + \\gamma R \\frac{\\beta c}{T^2} \\end{bmatrix}, \\quad \\frac{\\partial F}{\\partial D_a} = \\begin{bmatrix} -R/D_a \\\\ \\gamma R/D_a \\end{bmatrix}\n$$\nwhere the reaction rate term is $R = D_a \\exp(-\\beta/T) c$. The initial tangent at $(x, D_a) = ([1,1], 0)$ is calculated using this system. A numerical safeguard, $T_{\\text{safe}} = \\max(T, \\epsilon)$ for a small $\\epsilon>0$, is used in the exponential to prevent division by zero or floating-point overflow if $T$ approaches zero.\n\n**1.3. Predictor-Corrector Steps**\nThe continuation proceeds iteratively. From a known solution point $(x_{\\text{prev}}, D_{a,\\text{prev}})$ with tangent $t$, a new point is predicted and then corrected.\n\n*   **Predictor**: An Euler step is taken along the tangent direction with a fixed arclength step $\\Delta s$:\n    $$\n    (x_{\\text{pred}}, D_{a,\\text{pred}}) = (x_{\\text{prev}}, D_{a,\\text{prev}}) + \\Delta s \\cdot t\n    $$\n*   **Corrector**: The predicted point is refined by solving an augmented system using Newton's method. The system consists of the original steady-state equations and a constraint that forces the correction step to be orthogonal to the tangent plane, pinning the solution to a specific point on the solution curve at the desired arclength. The system to solve for the corrected point $(x, D_a)$ is $G(x, D_a) = 0$:\n    $$\n    G(x, D_a) =\n    \\begin{bmatrix}\n    F(x, D_a) \\\\\n    t_x^\\top (x - x_{\\text{prev}}) + t_{D_a} (D_a - D_{a,\\text{prev}}) - \\Delta s\n    \\end{bmatrix} = 0\n    $$\n    Newton's method iteratively solves the linear system $\\frac{\\partial G}{\\partial (x, D_a)} \\Delta z = -G(z)$ for the update $\\Delta z = [\\Delta x, \\Delta D_a]^\\top$, where the augmented Jacobian is:\n    $$\n    \\frac{\\partial G}{\\partial (x, D_a)} =\n    \\begin{bmatrix}\n    J(x, D_a) & \\frac{\\partial F}{\\partial D_a}(x, D_a) \\\\\n    t_x^\\top & t_{D_a}\n    \\end{bmatrix}\n    $$\n\n**2. Stability Analysis and Hopf Bifurcation Detection**\nAfter each successful corrector step, the stability of the new steady-state solution $(x^\\ast, D_{a}^\\ast)$ is assessed. The linear stability is determined by the eigenvalues $\\lambda_{1,2}$ of the Jacobian matrix $J(x^\\ast, D_{a}^\\ast)$.\n\nFor a $2 \\times 2$ system, the eigenvalues are given by $\\lambda_{1,2} = \\frac{\\operatorname{tr}(J) \\pm \\sqrt{\\operatorname{tr}(J)^2 - 4\\det(J)}}{2}$. A Hopf bifurcation occurs when a pair of complex conjugate eigenvalues crosses the imaginary axis. This corresponds to the following conditions:\n1.  The real part of the eigenvalues changes sign: $\\operatorname{Re}(\\lambda) = \\frac{\\operatorname{tr}(J)}{2}$ crosses zero. This means we must detect a sign change in the trace, $\\operatorname{tr}(J)$.\n2.  The eigenvalues are complex at the crossing point: The discriminant must be negative, $\\Delta = \\operatorname{tr}(J)^2 - 4\\det(J) < 0$. Since $\\operatorname{tr}(J) = 0$ at the bifurcation, this simplifies to requiring $\\det(J) > 0$.\n\nNumerically, a Hopf bifurcation is detected between two consecutive continuation points, indexed $i$ and $i+1$, if:\n*   $\\operatorname{tr}(J_i) \\cdot \\operatorname{tr}(J_{i+1}) < 0$ (sign change).\n*   $\\det(J_i) > 0$ and $\\det(J_{i+1}) > 0$.\n*   $\\operatorname{tr}(J_i)^2 - 4\\det(J_i) < 0$ and $\\operatorname{tr}(J_{i+1})^2 - 4\\det(J_{i+1}) < 0$.\n\nOnce a pair of points bracketing the bifurcation is found, the value of $D_a$ at the bifurcation point, $D_{a,Hopf}$, is estimated by linear interpolation, finding the root of the line segment connecting $(\\operatorname{tr}(J_i), D_{a,i})$ and $(\\operatorname{tr}(J_{i+1}), D_{a,i+1})$:\n$$\nD_{a,Hopf} = D_{a,i} - \\operatorname{tr}(J_i) \\frac{D_{a,i+1} - D_{a,i}}{\\operatorname{tr}(J_{i+1}) - \\operatorname{tr}(J_i)}\n$$\nThe first such detected point is reported. If the continuation completes without satisfying these conditions, no Hopf bifurcation is found. The process for a given parameter set terminates upon detecting the first Hopf point, reaching the maximum number of steps $N_{\\text{steps}}$, exceeding the maximum parameter value $D_{a,\\max}$, or if the Newton corrector fails to converge.",
            "answer": "```python\nimport numpy as np\n\n# Global constants for numerical stability and convergence\nSAFEGUARD_EPSILON = 1e-12\nNEWTON_MAX_ITER = 20\n\ndef eval_F(x, Da, params):\n    \"\"\"Evaluates the steady-state system function F(x, Da).\"\"\"\n    c, T = x\n    tau_m, tau_h, beta, gamma, _, _, _, _ = params\n    \n    T_safe = np.maximum(T, SAFEGUARD_EPSILON)\n    \n    try:\n        exp_term = np.exp(-beta / T_safe)\n    except FloatingPointError:\n        exp_term = 0.0 # Effectively handles large beta/T\n\n    reaction_term = Da * exp_term * c\n    \n    f1 = (1.0 - c) / tau_m - reaction_term\n    f2 = (1.0 - T) / tau_h + gamma * reaction_term\n    \n    return np.array([f1, f2])\n\ndef eval_Jacobian(x, Da, params):\n    \"\"\"Evaluates the Jacobian matrix J = dF/dx.\"\"\"\n    c, T = x\n    tau_m, tau_h, beta, gamma, _, _, _, _ = params\n    \n    T_safe = np.maximum(T, SAFEGUARD_EPSILON)\n    \n    try:\n        exp_term = np.exp(-beta / T_safe)\n    except FloatingPointError:\n        exp_term = 0.0\n\n    R = Da * exp_term\n    R_prime_T = R * beta / (T_safe**2)\n\n    j11 = -1.0 / tau_m - R\n    j12 = -c * R_prime_T\n    j21 = gamma * R\n    j22 = -1.0 / tau_h + gamma * c * R_prime_T\n    \n    return np.array([[j11, j12], [j21, j22]])\n\ndef eval_F_Da(x, Da, params):\n    \"\"\"Evaluates the partial derivative dF/dDa.\"\"\"\n    c, T = x\n    _, _, beta, gamma, _, _, _, _ = params\n\n    T_safe = np.maximum(T, SAFEGUARD_EPSILON)\n\n    try:\n        exp_term = np.exp(-beta / T_safe)\n    except FloatingPointError:\n        exp_term = 0.0\n\n    f1_Da = -exp_term * c\n    f2_Da = gamma * exp_term * c\n    \n    return np.array([f1_Da, f2_Da])\n\ndef run_continuation(params):\n    \"\"\"\n    Performs pseudo-arclength continuation and Hopf bifurcation detection.\n    \"\"\"\n    _, _, _, _, Da_max, ds, N_steps, newton_tol = params\n    \n    # Initialization\n    x_curr = np.array([1.0, 1.0])\n    Da_curr = 0.0\n    \n    history_stability = []\n\n    # Initial tangent calculation\n    try:\n        J0 = eval_Jacobian(x_curr, Da_curr, params)\n        F_Da0 = eval_F_Da(x_curr, Da_curr, params)\n        dx_dDa = np.linalg.solve(J0, -F_Da0)\n    except np.linalg.LinAlgError:\n        return -1.0 \n\n    # Form and normalize tangent\n    t_unnorm = np.append(dx_dDa, 1.0)\n    t_curr = t_unnorm / np.linalg.norm(t_unnorm)\n\n    # Initial stability\n    tr = np.trace(J0)\n    det = np.linalg.det(J0)\n    history_stability.append({'trace': tr, 'det': det})\n\n    for _ in range(N_steps):\n        # Store previous state for corrector and interpolation\n        x_prev, Da_prev = x_curr, Da_curr\n        t_prev = t_curr\n        \n        # Predictor step\n        x_pred = x_prev + ds * t_prev[:2]\n        Da_pred = Da_prev + ds * t_prev[2]\n\n        # Corrector (Newton's method)\n        x_new, Da_new = x_pred, Da_pred\n        \n        converged = False\n        for _ in range(NEWTON_MAX_ITER):\n            try:\n                # Build augmented system\n                F_val = eval_F(x_new, Da_new, params)\n                N_val = np.dot(t_prev[:2], x_new - x_prev) + t_prev[2] * (Da_new - Da_prev) - ds\n                G = np.append(F_val, N_val)\n\n                if np.linalg.norm(G) < newton_tol:\n                    converged = True\n                    break\n\n                J_new = eval_Jacobian(x_new, Da_new, params)\n                F_Da_new = eval_F_Da(x_new, Da_new, params)\n                \n                aug_J = np.zeros((3, 3))\n                aug_J[:2, :2] = J_new\n                aug_J[:2, 2] = F_Da_new\n                aug_J[2, :2] = t_prev[:2]\n                aug_J[2, 2] = t_prev[2]\n                \n                delta = np.linalg.solve(aug_J, -G)\n                x_new += delta[:2]\n                Da_new += delta[2]\n            except (np.linalg.LinAlgError, FloatingPointError):\n                return -1.0 # Corrector failed\n\n        if not converged:\n            return -1.0 # Corrector failed to converge\n\n        x_curr, Da_curr = x_new, Da_new\n        \n        # Check termination conditions\n        if Da_curr >= Da_max or Da_curr < 0:\n            break\n\n        # Stability analysis and Hopf detection\n        J_curr = eval_Jacobian(x_curr, Da_curr, params)\n        tr_curr = np.trace(J_curr)\n        det_curr = np.linalg.det(J_curr)\n        \n        prev_stability = history_stability[-1]\n        tr_prev = prev_stability['trace']\n        det_prev = prev_stability['det']\n        \n        if tr_curr * tr_prev < 0:\n            if det_curr > 0 and det_prev > 0:\n                disc_curr = tr_curr**2 - 4 * det_curr\n                disc_prev = tr_prev**2 - 4 * det_prev\n                if disc_curr < 0 and disc_prev < 0:\n                    Da_hopf = Da_prev - tr_prev * (Da_curr - Da_prev) / (tr_curr - tr_prev)\n                    return Da_hopf\n\n        history_stability.append({'trace': tr_curr, 'det': det_curr})\n\n        # Update tangent\n        try:\n            dx_dDa = np.linalg.solve(J_curr, -eval_F_Da(x_curr, Da_curr, params))\n            t_unnorm = np.append(dx_dDa, 1.0)\n            \n            t_new = t_unnorm / np.linalg.norm(t_unnorm)\n\n            if np.dot(t_new, t_prev) < 0:\n                t_new = -t_new\n\n            t_curr = t_new\n\n        except np.linalg.LinAlgError:\n            # At a fold, dx/dDa is singular. We can construct tangent differently.\n            # However, for this problem, we can just stop or let it fail.\n            return -1.0\n\n    return -1.0\n\ndef main():\n    test_cases = [\n        (0.5, 5.0, 12.0, 8.0, 6.0, 0.02, 400, 1e-10),\n        (2.0, 2.0, 8.0, 2.0, 10.0, 0.02, 500, 1e-10),\n        (0.1, 10.0, 15.0, 10.0, 3.0, 0.01, 500, 1e-10),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_continuation(params)\n        results.append(result)\n    \n    # Expected output format: [r1,r2,r3] with 8 decimal places for floats\n    formatted_results = [f\"{r:.8f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == '__main__':\n    main()\n```"
        }
    ]
}