{
    "hands_on_practices": [
        {
            "introduction": "我们将从索雷效应最直接的表现形式开始。在存在温度梯度的混合物中，热扩散会驱动一种组分产生通量。本练习  要求您计算需要多大的浓度梯度，才能产生一个恰好能抵消该索雷通量的菲克扩散通量，从而使得净扩散为零。这是量化索雷效应大小并理解其与常规扩散之间相互作用的关键第一步。",
            "id": "4015533",
            "problem": "在一维、稳态、低马赫数、等压、预混燃烧模拟中，考虑一个稀疏组分 $A$ 在平面火焰的预热区中扩散于一种惰性背景气体 $B$ 中。假设为理想气体混合物，并忽略体积力。该混合物在局部可以很好地描述为二元混合物 $A$–$B$，且 $A$ 相对于摩尔平均速度的扩散输运由增加了热扩散（索雷特）驱动力的二元 Stefan–Maxwell 框架控制。索雷特系数 $S_T$ 被定义为 $A$–$B$ 对在局部热力学状态下的比例常数，该常数关联了在 $A$ 的扩散摩尔通量为零的条件下，热梯度与诱导的组分梯度。\n\n在预热区中的某一点，已知以下数据：$A$ 的局部摩尔分数为 $x_A = 5.00 \\times 10^{-5}$，索雷特系数为 $S_T = 1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}$，温度在正 $x$ 方向上增加，其梯度为 $\\partial T/\\partial x = 2.40 \\times 10^{6}\\ \\mathrm{K/m}$。忽略能量方程中的杜福尔效应，确定稳态摩尔分数梯度 $\\partial x_A/\\partial x$，该梯度需要精确抵消热扩散的贡献，从而使 $A$ 的净扩散摩尔通量在此位置消失。\n\n请以 $\\mathrm{m}^{-1}$ 为单位表示您的最终答案，并四舍五入至三位有效数字。",
            "solution": "## 问题验证\n\n### 第1步：提取已知条件\n- 系统：一维（$x$ 方向）、稳态、低马赫数、等压、预混燃烧。\n- 混合物：稀疏组分 $A$ 在惰性背景气体 $B$ 中，表现为理想气体。\n- 输运框架：带有热扩散（索雷特效应）的二元 Stefan–Maxwell 框架。\n- 索雷特系数定义：当 $A$ 的扩散摩尔通量为零时，$S_T$ 是热梯度（$\\nabla T$）与诱导的组分梯度（$\\nabla x_A$）之间的比例常数。\n- 组分 $A$ 的局部摩尔分数：$x_A = 5.00 \\times 10^{-5}$。\n- $A$–$B$ 对的索雷特系数：$S_T = 1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}$。\n- 局部温度梯度：$\\frac{\\partial T}{\\partial x} = 2.40 \\times 10^{6}\\ \\mathrm{K/m}$。\n- 条件：组分 $A$ 的净扩散摩尔通量为零。\n- 简化：忽略杜福尔效应。\n- 目标：确定摩尔分数梯度 $\\frac{\\partial x_A}{\\partial x}$。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学基础**：该问题在非平衡热力学和输运现象的原理方面有充分的依据，特别是这些原理在燃烧科学中的应用。索雷特效应（热扩散）是一种已知的交叉扩散现象，由既定理论描述。使用 Stefan-Maxwell 方程是标准做法。给定的数值，虽然温度梯度很大，但在火焰的预热区内是物理上合理的。\n- **适定性**：该问题是适定的。它提供了足够的信息来确定唯一的解。目标是找到导致净扩散通量为零的摩尔分数梯度，这是一个数学上明确定义的条件。索雷特系数的定义和值，以及其他局部属性，是必要的输入。\n- **客观性**：该问题使用精确、客观和定量的语言陈述，不含任何主观因素。\n\n### 第3步：结论与行动\n该问题科学上合理、适定且客观。判定为**有效**。\n\n## 解答\n\n该问题要求找到导致组分 $A$ 的净扩散摩尔通量为零的摩尔分数梯度 $\\frac{\\partial x_A}{\\partial x}$。在同时受浓度和温度梯度影响的二元混合物中，总扩散通量 $\\mathbf{J}_A$ 是菲克扩散通量（由浓度梯度驱动）和索雷特扩散通量（由温度梯度驱动）之和。\n\n在一维情况下，组分 $A$ 相对于摩尔平均速度的摩尔扩散通量可以用一个从 Stefan-Maxwell 方程导出的组合形式表示：\n$$J_{A,x} = -c \\mathcal{D}_{AB} \\left( \\frac{\\partial x_A}{\\partial x} + \\frac{k_{TA}}{T} \\frac{\\partial T}{\\partial x} \\right)$$\n其中 $c$ 是总摩尔浓度，$\\mathcal{D}_{AB}$ 是二元扩散系数，$T$ 是绝对温度，$k_{TA}$ 是组分 $A$ 的热扩散比。\n\n热扩散比 $k_{TA}$ 与无量纲热扩散因子 $\\alpha_T$ 和各组分的摩尔分数相关：\n$$k_{TA} = \\alpha_T x_A x_B$$\n其中 $x_A$ 和 $x_B$ 分别是组分 $A$ 和 $B$ 的摩尔分数，且 $x_A + x_B = 1$。\n\n索雷特系数 $S_T$ 通常定义为与热扩散因子 $\\alpha_T$ 和温度 $T$ 的关系：\n$$S_T = \\frac{\\alpha_T}{T}$$\n这个定义与给定的 $S_T$ 单位 $\\mathrm{K}^{-1}$ 一致，因为 $\\alpha_T$ 是无量纲的。\n\n将这些关系代入通量方程，我们可以使用索雷特系数 $S_T$ 来表示涉及温度梯度的项：\n$$\\frac{k_{TA}}{T} = \\frac{\\alpha_T x_A x_B}{T} = \\left(\\frac{\\alpha_T}{T}\\right) x_A x_B = S_T x_A x_B$$\n组分 $A$ 的扩散通量的完整表达式变为：\n$$J_{A,x} = -c \\mathcal{D}_{AB} \\left( \\frac{\\partial x_A}{\\partial x} + S_T x_A x_B \\frac{\\partial T}{\\partial x} \\right)$$\n问题陈述 $A$ 的净扩散摩尔通量为零，即 $J_{A,x} = 0$。\n$$0 = -c \\mathcal{D}_{AB} \\left( \\frac{\\partial x_A}{\\partial x} + S_T x_A x_B \\frac{\\partial T}{\\partial x} \\right)$$\n由于总浓度 $c$ 和扩散系数 $\\mathcal{D}_{AB}$ 均不为零，因此括号中的项必须为零：\n$$\\frac{\\partial x_A}{\\partial x} + S_T x_A x_B \\frac{\\partial T}{\\partial x} = 0$$\n该方程表示由浓度梯度驱动的扩散正好抵消热扩散（索雷特效应）的平衡状态。我们现在可以求解所需的摩尔分数梯度 $\\frac{\\partial x_A}{\\partial x}$：\n$$\\frac{\\partial x_A}{\\partial x} = -S_T x_A x_B \\frac{\\partial T}{\\partial x}$$\n由于混合物是二元的，$x_B = 1 - x_A$。将其代入方程得到：\n$$\\frac{\\partial x_A}{\\partial x} = -S_T x_A (1 - x_A) \\frac{\\partial T}{\\partial x}$$\n我们已知以下数值：\n- 组分 $A$ 的摩尔分数：$x_A = 5.00 \\times 10^{-5}$\n- 索雷特系数：$S_T = 1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}$\n- 温度梯度：$\\frac{\\partial T}{\\partial x} = 2.40 \\times 10^{6}\\ \\mathrm{K/m}$\n\n将这些值代入导出的方程：\n$$\\frac{\\partial x_A}{\\partial x} = -(1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}) \\times (5.00 \\times 10^{-5}) \\times (1 - 5.00 \\times 10^{-5}) \\times (2.40 \\times 10^{6}\\ \\mathrm{K/m})$$\n首先，计算主要数值因子和 $10$ 的幂的乘积：\n$$(1.10) \\times (5.00) \\times (2.40) = 13.2$$\n$$10^{-3} \\times 10^{-5} \\times 10^{6} = 10^{-2}$$\n现在，包含项 $(1 - x_A)$：\n$$(1 - 5.00 \\times 10^{-5}) = 0.99995$$\n合并所有部分：\n$$\\frac{\\partial x_A}{\\partial x} = -13.2 \\times 10^{-2} \\times 0.99995 \\ \\mathrm{m}^{-1}$$\n$$\\frac{\\partial x_A}{\\partial x} = -0.132 \\times 0.99995 \\ \\mathrm{m}^{-1}$$\n$$\\frac{\\partial x_A}{\\partial x} = -0.1319934 \\ \\mathrm{m}^{-1}$$\n问题要求答案四舍五入至三位有效数字。\n$$\\frac{\\partial x_A}{\\partial x} \\approx -0.132 \\ \\mathrm{m}^{-1}$$\n负号表示，为了使净通量为零，组分 $A$ 的摩尔分数必须在温度增加的方向上减小。这会在正 $x$ 方向上产生一个菲克扩散通量，以抵消索雷特通量。对于正的 $S_T$，索雷特通量会将组分 $A$ 推向较冷的区域（负 $x$ 方向）。",
            "answer": "$$\\boxed{-0.132}$$"
        },
        {
            "introduction": "在理解了局部通量平衡后，我们来探讨其在宏观系统中的稳态结果。本练习  探究了当一个二元气体混合物被置于一个存在持续温差的封闭容器中时会发生什么。您将需要推导并计算由此产生的非均匀组分分布，即组分分离现象，这是索雷效应的一个直接且可观测的后果。这项练习将解析推导与数值方法相结合，以求解系统的最终平衡状态。",
            "id": "4015507",
            "problem": "考虑一个长度为 $L$ 的一维封闭静态空腔，其中包含一种处于均匀压力 $p$ 下的理想二元气体混合物，无宏观流动，也无物质的源或汇。位于 $x=0$ 和 $x=L$ 处的左右壁面分别保持在恒定温度 $T_0$ 和 $T_1$。假设热导率恒定，因此稳态温度场是线性的，$T(x) = T_0 + (T_1 - T_0)\\,x/L$。该混合物表现出热扩散（Soret 效应），但忽略由物质浓度梯度引起的任何热通量贡献（Dufour 效应）以及任何外部体积力。设物质 $\\mathrm{A}$ 的摩尔分数为 $x_{\\mathrm{A}}(x)$。\n\n从适用于二元混合物的包含热扩散的多组分扩散的 Maxwell–Stefan 描述以及物质 $\\mathrm{A}$ 的 Soret 系数 $S_T$ 的定义出发，在封闭空腔内对物质 $\\mathrm{A}$ 施加稳态摩尔通量为零的条件，并满足总物质守恒。在均匀压力下的理想气体假设下，局部总摩尔浓度满足 $c(x) = p/(R\\,T(x))$，其中 $R$ 是普适气体常数。物质 $\\mathrm{A}$ 的全局摩尔分数是守恒的，等于下面提供的初始均匀摩尔分数 $x_{\\mathrm{A},\\mathrm{avg}}$。使用这些原理计算仅由 Soret 效应引起的稳态摩尔分数分布 $x_{\\mathrm{A}}(x)$。\n\n实现一个程序，该程序：\n- 仅使用 Maxwell–Stefan 框架和 Soret 系数定义，从零通量条件推导出 $x_{\\mathrm{A}}(x)$ 的控制关系式，而不调用任何预先推导的目标公式。\n- 通过施加全局物质守恒约束来确定积分常数\n$$\nx_{\\mathrm{A},\\mathrm{avg}} \\;=\\; \\frac{\\displaystyle \\int_0^L c(x)\\,x_{\\mathrm{A}}(x)\\,dx}{\\displaystyle \\int_0^L c(x)\\,dx} \\;=\\; \\frac{\\displaystyle \\int_0^L \\frac{x_{\\mathrm{A}}(x)}{T(x)}\\,dx}{\\displaystyle \\int_0^L \\frac{1}{T(x)}\\,dx},\n$$\n其中 $c(x)=p/(R\\,T(x))$ 消去了未知压力和常数 $R$。\n- 计算并报告在 $x \\in \\{0,\\,L/4,\\,L/2,\\,3L/4,\\,L\\}$ 这五个位置上的稳态摩尔分数的值。\n\n物理单位和常数：\n- 长度 $L$ 的单位是米 (m)。\n- 温度 $T_0$ 和 $T_1$ 的单位是开尔文 (K)。\n- Soret 系数 $S_T$ 的单位是逆开尔文 ($\\mathrm{K}^{-1}$)。\n- 摩尔分数是无量纲的。\n\n测试组：\n为以下参数集提供结果，每个参数集指定为 $(L,\\,T_0,\\,T_1,\\,S_T,\\,x_{\\mathrm{A},\\mathrm{avg}})$：\n1. $(L=\\;0.10,\\;T_0=\\;1400,\\;T_1=\\;1000,\\;S_T=\\;0.002,\\;x_{\\mathrm{A},\\mathrm{avg}}=\\;0.35)$\n2. $(L=\\;0.20,\\;T_0=\\;1400,\\;T_1=\\;900,\\;S_T=\\;0.000,\\;x_{\\mathrm{A},\\mathrm{avg}}=\\;0.50)$\n3. $(L=\\;0.05,\\;T_0=\\;1200,\\;T_1=\\;1200,\\;S_T=\\;0.003,\\;x_{\\mathrm{A},\\mathrm{avg}}=\\;0.40)$\n4. $(L=\\;0.10,\\;T_0=\\;1000,\\;T_1=\\;1500,\\;S_T=\\;-0.0015,\\;x_{\\mathrm{A},\\mathrm{avg}}=\\;0.25)$\n5. $(L=\\;0.30,\\;T_0=\\;800,\\;T_1=\\;1800,\\;S_T=\\;0.004,\\;x_{\\mathrm{A},\\mathrm{avg}}=\\;0.90)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且本身是按顺序排列的 $x \\in \\{0,\\,L/4,\\,L/2,\\,3L/4,\\,L\\}$ 处 $x_{\\mathrm{A}}(x)$ 的五个浮点值的列表。例如，输出格式必须是\n$$\n[\\,[x_{\\mathrm{A}}(0),x_{\\mathrm{A}}(L/4),x_{\\mathrm{A}}(L/2),x_{\\mathrm{A}}(3L/4),x_{\\mathrm{A}}(L)]_{\\text{case 1}},\\;\\ldots,\\;[\\cdots]_{\\text{case 5}}\\,].\n$$",
            "solution": "该问题要求推导和计算在温度梯度作用下，理想二元气体混合物中某物质的稳态摩尔分数分布。这种现象被称为 Soret 效应或热扩散，是一种交叉扩散效应，即温度梯度会引起物质通量。我们将从问题陈述中列出的基本原理出发。\n\n系统是一个长度为 $L$ 的一维封闭静态空腔，其壁面温度固定为 $T(x=0) = T_0$ 和 $T(x=L) = T_1$。压力 $p$ 是均匀的。没有宏观流动，也没有化学反应发生。温度分布被给定为线性：\n$$\nT(x) = T_0 + (T_1 - T_0) \\frac{x}{L}\n$$\n这与恒定热导率的假设是一致的。混合物是理想气体，因此总摩尔浓度 $c$ 随温度变化，关系为 $c(x) = p/(R T(x))$，其中 $R$ 是普适气体常数。\n\n在二元混合物中，物质 $\\mathrm{A}$ 的摩尔通量（表示为 $J_{\\mathrm{A}}^*$）源于普通扩散（由摩尔分数梯度驱动）和热扩散（由温度梯度驱动）。在 Maxwell-Stefan 框架内，对于二元体系，该通量可以表示为一种类 Fick 形式。热扩散的贡献由 Soret 系数 $S_T$ 表征。组合的摩尔通量由下式给出：\n$$\nJ_{\\mathrm{A}}^* = -c D_{\\mathrm{AB}} \\frac{dx_{\\mathrm{A}}}{dx} - c D_{\\mathrm{AB}} S_T x_{\\mathrm{A}} (1-x_{\\mathrm{A}}) \\frac{1}{T} \\frac{dT}{dx}\n$$\n其中 $c(x)$ 是总摩尔浓度，$D_{\\mathrm{AB}}$ 是二元扩散系数，$x_{\\mathrm{A}}(x)$ 是物质 $\\mathrm{A}$ 的摩尔分数，$T(x)$ 是温度。项 $x_{\\mathrm{A}}(1-x_{\\mathrm{A}})$ 来自于 $x_{\\mathrm{A}}x_{\\mathrm{B}}$，其中 $x_{\\mathrm{B}} = 1 - x_{\\mathrm{A}}$ 是另一种物质 B 的摩尔分数。\n\n对于一个在稳态下无源或汇的封闭系统，每种物质的净摩尔通量必须处处为零。因此，我们施加条件 $J_{\\mathrm{A}}^* = 0$：\n$$\n0 = -c D_{\\mathrm{AB}} \\frac{dx_{\\mathrm{A}}}{dx} - c D_{\\mathrm{AB}} S_T x_{\\mathrm{A}} (1-x_{\\mathrm{A}}) \\frac{1}{T} \\frac{dT}{dx}\n$$\n假设浓度 $c$ 和扩散系数 $D_{\\mathrm{AB}}$ 非零，我们可以简化此方程：\n$$\n\\frac{dx_{\\mathrm{A}}}{dx} = -S_T x_{\\mathrm{A}}(1 - x_{\\mathrm{A}}) \\frac{1}{T} \\frac{dT}{dx}\n$$\n这是一个可分离的一阶常微分方程。我们可以重排它来分离变量 $x_{\\mathrm{A}}$ 和 $T$：\n$$\n\\frac{dx_{\\mathrm{A}}}{x_{\\mathrm{A}}(1 - x_{\\mathrm{A}})} = -S_T \\frac{d(\\ln T)}{dx} dx = -S_T d(\\ln T)\n$$\n我们对这个方程进行积分。左侧使用部分分式分解进行积分，$\\frac{1}{x_{\\mathrm{A}}(1 - x_{\\mathrm{A}})} = \\frac{1}{x_{\\mathrm{A}}} + \\frac{1}{1 - x_{\\mathrm{A}}}$。\n$$\n\\int \\left( \\frac{1}{x_{\\mathrm{A}}} + \\frac{1}{1 - x_{\\mathrm{A}}} \\right) dx_{\\mathrm{A}} = \\int -S_T d(\\ln T)\n$$\n假设 Soret 系数 $S_T$ 是常数，积分得出：\n$$\n\\ln(x_{\\mathrm{A}}) - \\ln(1 - x_{\\mathrm{A}}) = -S_T \\ln(T) + C_1\n$$\n其中 $C_1$ 是积分常数。合并对数项：\n$$\n\\ln\\left(\\frac{x_{\\mathrm{A}}}{1 - x_{\\mathrm{A}}}\\right) = \\ln(T^{-S_T}) + C_1\n$$\n对两边取指数，得到摩尔分数和温度之间的关系：\n$$\n\\frac{x_{\\mathrm{A}}(x)}{1 - x_{\\mathrm{A}}(x)} = e^{C_1} T(x)^{-S_T} = C T(x)^{-S_T}\n$$\n其中 $C = e^{C_1}$ 是一个新的正常数。解出 $x_{\\mathrm{A}}(x)$，我们得到摩尔分数分布的函数形式：\n$$\nx_{\\mathrm{A}}(x) = \\frac{C T(x)^{-S_T}}{1 + C T(x)^{-S_T}} = \\frac{C}{T(x)^{S_T} + C}\n$$\n积分常数 $C$ 通过施加空腔中物质 $\\mathrm{A}$ 的总摩尔数守恒来确定。全局平均摩尔分数 $x_{\\mathrm{A},\\mathrm{avg}}$ 必须等于稳态分布中的平均摩尔分数，并由局部摩尔浓度 $c(x)$ 加权：\n$$\nx_{\\mathrm{A},\\mathrm{avg}} = \\frac{\\displaystyle \\int_0^L c(x)\\,x_{\\mathrm{A}}(x)\\,dx}{\\displaystyle \\int_0^L c(x)\\,dx}\n$$\n代入 $c(x) = p/(RT(x))$ 并消去常数因子 $p/R$：\n$$\nx_{\\mathrm{A},\\mathrm{avg}} = \\frac{\\displaystyle \\int_0^L \\frac{x_{\\mathrm{A}}(x)}{T(x)}\\,dx}{\\displaystyle \\int_0^L \\frac{1}{T(x)}\\,dx}\n$$\n代入推导出的 $x_{\\mathrm{A}}(x)$ 表达式：\n$$\nx_{\\mathrm{A},\\mathrm{avg}} = \\frac{\\displaystyle \\int_0^L \\frac{1}{T(x)} \\frac{C}{T(x)^{S_T} + C} \\,dx}{\\displaystyle \\int_0^L \\frac{1}{T(x)}\\,dx}\n$$\n这是一个关于常数 $C$ 的隐式方程。对于一般的非整数值 $S_T$，该积分没有简单的闭式解析解。因此，需要采用数值方法。我们必须找到函数 $f(C) = 0$ 的根 $C$，其中：\n$$\nf(C) = \\frac{\\displaystyle \\int_0^L \\frac{C}{T(x)(T(x)^{S_T} + C)} \\,dx}{\\displaystyle \\int_0^L \\frac{1}{T(x)}\\,dx} - x_{\\mathrm{A},\\mathrm{avg}}\n$$\n这构成了一个数值求根问题。积分使用数值积分法计算，并使用求根算法（例如 Brent-Dekker 方法）来求解 $C$。\n\n两种特殊情况可以直接求解：\n1.  如果 $S_T = 0$，热扩散项为零。微分方程简化为 $dx_{\\mathrm{A}}/dx = 0$，这意味着 $x_{\\mathrm{A}}(x)$ 是一个常数。守恒约束立即意味着对于所有 $x$，$x_{\\mathrm{A}}(x) = x_{\\mathrm{A},\\mathrm{avg}}$。\n2.  如果 $T_1 = T_0$，温度是均匀的，$T(x) = T_0$，因此 $dT/dx = 0$。这也导致 $dx_{\\mathrm{A}}/dx = 0$，从而 $x_{\\mathrm{A}}(x) = x_{\\mathrm{A},\\mathrm{avg}}$。\n\n对于一般情况，数值计算步骤如下：\n1.  对于给定的一组参数 $(L, T_0, T_1, S_T, x_{\\mathrm{A},\\mathrm{avg}})$，检查是否存在上述特殊情况。\n2.  如果是一般情况，定义目标函数 $f(C)$。\n3.  $f(C)$ 中的积分通过数值方法计算。\n4.  找到满足 $f(C)=0$ 的根 $C$。由于 $x_{\\mathrm{A}}$ 必须在 $0$ 和 $1$ 之间，且 $T(x)$ 是正的，因此常数 $C$ 必须是正的。\n5.  一旦找到唯一的正根 $C$，摩尔分数分布就由 $x_{\\mathrm{A}}(x) = C / (T(x)^{S_T} + C)$ 完全确定。\n6.  在指定位置 $x \\in \\{0, L/4, L/2, 3L/4, L\\}$ 计算该函数的值。\n\n对每个测试用例实施此程序，以获得所需的摩尔分数数值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, optimize\n\ndef solve():\n    \"\"\"\n    Main solver function that processes test cases and prints the results.\n    \"\"\"\n    # Test suite from the problem statement\n    # Each case is (L, T0, T1, ST, xA_avg)\n    test_cases = [\n        (0.10, 1400., 1000., 0.002, 0.35),\n        (0.20, 1400., 900., 0.000, 0.50),\n        (0.05, 1200., 1200., 0.003, 0.40),\n        (0.10, 1000., 1500., -0.0015, 0.25),\n        (0.30, 800., 1800., 0.004, 0.90)\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = calculate_profile(*case)\n        results.append(case_results)\n\n    # Manually construct the string to match the no-space example in the problem description.\n    results_str_list = []\n    for res_list in results:\n        # Format each list of floats into a string like \"[v1,v2,v3,v4,v5]\"\n        formatted_list = f\"[{','.join(f'{v:.7f}' for v in res_list)}]\"\n        results_str_list.append(formatted_list)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str_list)}]\")\n\n\ndef calculate_profile(L, T0, T1, ST, xA_avg):\n    \"\"\"\n    Calculates the steady-state mole fraction profile for a single case.\n\n    Args:\n        L (float): Length of the cavity (m).\n        T0 (float): Temperature at x=0 (K).\n        T1 (float): Temperature at x=L (K).\n        ST (float): Soret coefficient (1/K).\n        xA_avg (float): Average mole fraction of species A.\n\n    Returns:\n        list: A list of 5 float values for x_A at x = 0, L/4, L/2, 3L/4, L.\n    \"\"\"\n    # Define the temperature profile T(x)\n    def T(x):\n        return T0 + (T1 - T0) * x / L\n\n    # Handle special cases first: no Soret effect or no temperature gradient\n    if ST == 0.0 or abs(T0 - T1)  1e-9:\n        return [xA_avg] * 5\n\n    # General case: needs numerical solution for the integration constant C\n    \n    # Denominator of the conservation equation: integral of 1/T(x) from 0 to L.\n    # This can be solved analytically, which is more robust than numerical integration.\n    I_den = (L / (T1 - T0)) * np.log(T1 / T0)\n\n    # Integrand for the numerator of the conservation equation\n    def numerator_integrand(x, C_val):\n        temp = T(x)\n        # Use np.power for fractional exponents\n        return (1.0 / temp) * (C_val / (np.power(temp, ST) + C_val))\n\n    # Define the function for which we need to find the root C.\n    # f(C) = calculated_xA_avg(C) - given_xA_avg\n    def f_C(C_val):\n        # C must be positive\n        if C_val = 0: return -xA_avg\n        I_num, _ = integrate.quad(numerator_integrand, 0, L, args=(C_val,))\n        return (I_num / I_den) - xA_avg\n\n    # Find the root C using a root-finding algorithm (Brent's method)\n    try:\n        # A wide bracket should be sufficient for the given test cases.\n        C_sol = optimize.brentq(f_C, 1e-12, 1e12)\n    except ValueError:\n        # This occurs if f(a) and f(b) have the same sign.\n        # This can happen if xA_avg is very close to an extremum.\n        # A more robust implementation might check the limits.\n        return [np.nan] * 5  # Return NaN as an error indicator\n\n    # With the found C, calculate the mole fraction profile at the required points\n    x_points = np.array([0, L/4, L/2, 3*L/4, L])\n    T_points = T(x_points)\n    xA_profile = C_sol / (np.power(T_points, ST) + C_sol)\n\n    return xA_profile.tolist()\n```"
        },
        {
            "introduction": "最后，我们将把目光投向真实的燃烧系统，这些系统通常涉及多种化学组分，其扩散过程也更为复杂。这项高级练习  深入探讨了计算建模的核心问题，将严谨但计算成本高昂的 Maxwell-Stefan 方程与广泛使用的混合平均模型进行对比。您将通过实现这两种模型，来量化近似模型所引入的误差，从而对模拟包含交叉扩散效应的反应流时，如何在精度和计算成本之间进行权衡获得关键的洞见。",
            "id": "4015561",
            "problem": "考虑一个一维、等压、理想气体混合物，其中包含 $N$ 种化学非反应物种，其摩尔分数为 $x_i$，总摩尔浓度为 $c$，温度为 $T$，压力为 $p$。设 $x_i$ 满足 $\\sum_{i=1}^N x_i = 1$，并定义沿坐标 $x$ 的空间梯度 $\\partial x_i / \\partial x$ 和 $\\partial T / \\partial x$。假设没有外部体力，并忽略压力扩散。总摩尔浓度遵循理想气体定律，$c = p/(R T)$，其中 $R$ 是普适气体常数。\n\n物种速度的完全多组分扩散输运由包含热扩散（Soret 效应）的 Maxwell–Stefan 方程控制。在一维和摩尔平均参考系中，这些方程可以表示为一个包含 $N$ 个方程的线性系统和一个单一的参考系约束：\n- 对每个物种 $i$，物种扩散速度 $v_i$ 之间的耦合关系为\n$$\n\\sum_{j \\neq i} \\frac{x_j}{D_{ij}} \\left(v_i - v_j \\right) = - \\frac{\\partial x_i}{\\partial x} - x_i S_i \\frac{\\partial \\ln T}{\\partial x},\n$$\n其中 $D_{ij}$ 是二元扩散系数（对称，即 $D_{ij} = D_{ji}$，单位为 $\\mathrm{m^2/s}$），$S_i$ 是无量纲的热扩散比。速度满足摩尔平均参考系约束\n$$\n\\sum_{i=1}^N x_i v_i = 0.\n$$\n摩尔扩散通量则为 $J_i^{\\mathrm{MC}} = c x_i v_i$，单位为 $\\mathrm{mol/(m^2 \\cdot s)}$。\n\n混合物平均近似用一个由下式定义的有效物种扩散系数替代了多组分耦合：\n$$\n\\frac{1}{D_i^{\\mathrm{m}}} = \\sum_{j \\neq i} \\frac{x_j}{D_{ij}},\n$$\n并用以下方式对解耦的物种摩尔通量进行建模：\n$$\nJ_i^{\\mathrm{MA,uncorr}} = - c D_i^{\\mathrm{m}} \\frac{\\partial x_i}{\\partial x} - c x_i D_i^{\\mathrm{m}} S_i \\frac{\\partial \\ln T}{\\partial x}.\n$$\n为强制执行摩尔平均参考系条件 $\\sum_i J_i^{\\mathrm{MA}} = 0$，引入校正速度\n$$\nV_{\\mathrm{c}} = \\frac{\\sum_{i=1}^N J_i^{\\mathrm{MA,uncorr}}}{c},\n$$\n并定义校正后的混合物平均通量\n$$\nJ_i^{\\mathrm{MA}} = J_i^{\\mathrm{MA,uncorr}} - c x_i V_{\\mathrm{c}}.\n$$\n\n你的任务是：\n1. 从上述给出的 Maxwell–Stefan 方程出发，推导出如上文所写的包含热扩散项的混合物平均近似，并清楚地解释为从多组分框架中获得 $J_i^{\\mathrm{MA}}$ 所引用的近似。\n2. 对 $N=4$ 个物种，用数值方法实现这两种输运模型，并使用相对 $L^2$-范数来量化混合物平均模型相对于完全多组分模型的误差\n$$\n\\varepsilon = \\frac{\\left\\| \\mathbf{J}^{\\mathrm{MA}} - \\mathbf{J}^{\\mathrm{MC}} \\right\\|_2}{\\left\\| \\mathbf{J}^{\\mathrm{MC}} \\right\\|_2},\n$$\n其中 $\\mathbf{J}$ 表示物种通量向量。所有通量必须以 $\\mathrm{mol/(m^2 \\cdot s)}$ 为单位进行报告和计算。\n\n使用普适气体常数 $R = 8.314462618 \\ \\mathrm{J/(mol \\cdot K)}$ 和以下四个测试用例集。在每个案例中，二元扩散系数 $D_{ij}$ 以对称矩阵的形式给出，其中 $D_{ii}$ 未使用。热扩散比 $S_i$ 是无量纲的，并在指定处保持不变。梯度 $\\partial x_i / \\partial x$ 的单位为 $\\mathrm{m^{-1}}$，温度 $T$ 的单位为 $\\mathrm{K}$，温度梯度 $\\partial T/\\partial x$ 的单位为 $\\mathrm{K/m}$，压力 $p$ 的单位为 $\\mathrm{Pa}$。\n\n测试用例 1（均衡混合物，中等热梯度）：\n- $N = 4$\n- $x = [0.25, 0.25, 0.25, 0.25]$\n- $\\partial x / \\partial x = [0.01, -0.005, -0.003, -0.002] \\ \\mathrm{m^{-1}}$\n- $T = 1800 \\ \\mathrm{K}$，$\\partial T/\\partial x = 5000 \\ \\mathrm{K/m}$，$p = 101325 \\ \\mathrm{Pa}$\n- $D_{ij}$ （单位 $\\mathrm{m^2/s}$）：\n$$\n\\begin{bmatrix}\n\\infty  1.2 \\times 10^{-4}  1.0 \\times 10^{-4}  1.1 \\times 10^{-4} \\\\\n1.2 \\times 10^{-4}  \\infty  7.0 \\times 10^{-5}  8.0 \\times 10^{-5} \\\\\n1.0 \\times 10^{-4}  7.0 \\times 10^{-5}  \\infty  9.0 \\times 10^{-5} \\\\\n1.1 \\times 10^{-4}  8.0 \\times 10^{-5}  9.0 \\times 10^{-5}  \\infty\n\\end{bmatrix}\n$$\n- $S = [0.30, -0.02, -0.01, 0.06]$\n\n测试用例 2（一种物种稀释，弱负热梯度）：\n- $N = 4$\n- $x = [0.02, 0.48, 0.48, 0.02]$\n- $\\partial x / \\partial x = [-0.015, 0.007, 0.007, 0.001] \\ \\mathrm{m^{-1}}$\n- $T = 2200 \\ \\mathrm{K}$，$\\partial T/\\partial x = -2000 \\ \\mathrm{K/m}$，$p = 101325 \\ \\mathrm{Pa}$\n- $D_{ij}$ 与测试用例 1 相同\n- $S$ 与测试用例 1 相同\n\n测试用例 3（强热梯度，小组成梯度）：\n- $N = 4$\n- $x = [0.40, 0.10, 0.40, 0.10]$\n- $\\partial x / \\partial x = [0.001, -0.0005, 0.0002, -0.0007] \\ \\mathrm{m^{-1}}$\n- $T = 1500 \\ \\mathrm{K}$，$\\partial T/\\partial x = 20000 \\ \\mathrm{K/m}$，$p = 101325 \\ \\mathrm{Pa}$\n- $D_{ij}$ 与测试用例 1 相同\n- $S$ 与测试用例 1 相同\n\n测试用例 4（相等的二元扩散系数，无热梯度）：\n- $N = 4$\n- $x = [0.25, 0.35, 0.20, 0.20]$\n- $\\partial x / \\partial x = [-0.02, 0.01, 0.005, 0.005] \\ \\mathrm{m^{-1}}$\n- $T = 2000 \\ \\mathrm{K}$，$\\partial T/\\partial x = 0 \\ \\mathrm{K/m}$，$p = 101325 \\ \\mathrm{Pa}$\n- $D_{ij}$ （单位 $\\mathrm{m^2/s}$）：\n$$\n\\begin{bmatrix}\n\\infty  1.0 \\times 10^{-4}  1.0 \\times 10^{-4}  1.0 \\times 10^{-4} \\\\\n1.0 \\times 10^{-4}  \\infty  1.0 \\times 10^{-4}  1.0 \\times 10^{-4} \\\\\n1.0 \\times 10^{-4}  1.0 \\times 10^{-4}  \\infty  1.0 \\times 10^{-4} \\\\\n1.0 \\times 10^{-4}  1.0 \\times 10^{-4}  1.0 \\times 10^{-4}  \\infty\n\\end{bmatrix}\n$$\n- $S$ 与测试用例 1 相同\n\n你的程序必须：\n- 通过构建 Maxwell–Stefan 矩阵 $L$（其元素为 $L_{ii} = \\sum_{j \\neq i} x_j / D_{ij}$ 和 $L_{ij} = - x_j / D_{ij}$（当 $i \\neq j$ 时）），形成驱动向量 $b_i = \\partial x_i / \\partial x + x_i S_i \\partial \\ln T / \\partial x$，并求解增广系统\n$$\n\\begin{bmatrix}\nL  \\mathbf{x} \\\\\n\\mathbf{x}^\\top  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{v} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n- \\mathbf{b} \\\\\n0\n\\end{bmatrix}\n$$\n来实现多组分解决方案，以获得满足参考系约束的 $\\mathbf{v}$，然后计算 $\\mathbf{J}^{\\mathrm{MC}} = c \\, \\mathbf{x} \\odot \\mathbf{v}$，其中 $\\odot$ 表示逐元素相乘。\n- 使用如上定义的 $D_i^{\\mathrm{m}}$ 和校正速度 $V_{\\mathrm{c}}$ 实现混合物平均通量 $\\mathbf{J}^{\\mathrm{MA}}$。\n- 计算每个测试用例的相对误差 $\\varepsilon$。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3,result4]”），每个结果是对应测试用例的 $\\varepsilon$ 的浮点值。",
            "solution": "用户提供了一个问题陈述，要求包含两个主要部分：首先，从更基础的 Maxwell–Stefan 方程中对混合物平均扩散模型进行理论推导；其次，通过数值实现来比较这两种模型，并针对一组测试用例量化该近似的误差。\n\n问题验证证实，该陈述具有科学依据、适定、客观且内部一致。所提供的参数和条件对于高温气体混合物而言是物理上现实的，其数学框架在输运现象和计算燃烧领域是标准的。未检测到任何缺陷。因此，我们可以继续进行解答。\n\n### 第1部分：混合物平均模型的推导\n\n目标是从多组分 Maxwell–Stefan 方程出发，推导出混合物平均通量表达式：\n$$\nJ_i^{\\mathrm{MA}} = J_i^{\\mathrm{MA,uncorr}} - c x_i V_{\\mathrm{c}},\n$$\n该推导涉及两个关键步骤：首先，通过一个近似来解耦物种通量，从而得到未校正的通量 $J_i^{\\mathrm{MA,uncorr}}$；其次，引入一个校正项，以确保通量满足摩尔平均参考系约束。\n\n出发点是 N 个物种混合物中物种 $i$ 的 Maxwell–Stefan 方程，该方程包括 Soret 效应（热扩散）并忽略了压力和外力梯度：\n$$\n\\sum_{j \\neq i} \\frac{x_j}{D_{ij}} \\left(v_i - v_j \\right) = - \\frac{\\partial x_i}{\\partial x} - x_i S_i \\frac{\\partial \\ln T}{\\partial x}\n$$\n此处，$x_i$ 是摩尔分数，$v_i$ 是扩散速度，$D_{ij}$ 是二元扩散系数，$S_i$ 是热扩散比，$T$ 是温度，$x$ 是空间坐标。\n\n我们用摩尔通量 $J_k = c x_k v_k$ 来表示 Maxwell-Stefan 方程。该方程可写为：\n$$\n\\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} = \\sum_{j \\neq i} \\frac{x_i J_j - x_j J_i}{c D_{ij}}\n$$\n重新排列右侧的求和项：\n$$\n\\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} = \\frac{x_i}{c} \\sum_{j \\neq i} \\frac{J_j}{D_{ij}} - \\frac{J_i}{c} \\sum_{j \\neq i} \\frac{x_j}{D_{ij}}\n$$\n现在我们引入问题陈述中给出的混合物平均扩散系数 $D_i^{\\mathrm{m}}$ 的定义：\n$$\n\\frac{1}{D_i^{\\mathrm{m}}} = \\sum_{j \\neq i} \\frac{x_j}{D_{ij}}\n$$\n将其代入我们重新排列的方程中可得：\n$$\n\\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} = \\frac{x_i}{c} \\sum_{j \\neq i} \\frac{J_j}{D_{ij}} - \\frac{J_i}{c D_i^{\\mathrm{m}}}\n$$\n这个方程仍然是多组分系统的精确表示，它将物种 $i$ 的通量与驱动力以及所有其他物种的通量联系起来。为了获得混合物平均模型，我们做出了一个关键的近似：忽略来自其他物种通量的贡献。具体来说，我们近似为：\n$$\n\\frac{x_i}{c} \\sum_{j \\neq i} \\frac{J_j}{D_{ij}} \\approx 0\n$$\n这是将物种彼此解耦的核心近似，它将问题从一个耦合方程组简化为一组独立的方程，每个物种一个。在此近似下，多组分通量 $J_i$ 被替换为未校正的混合物平均通量 $J_i^{\\mathrm{MA,uncorr}}$：\n$$\n\\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} \\approx - \\frac{J_i^{\\mathrm{MA,uncorr}}}{c D_i^{\\mathrm{m}}}\n$$\n求解 $J_i^{\\mathrm{MA,uncorr}}$：\n$$\nJ_i^{\\mathrm{MA,uncorr}} = - c D_i^{\\mathrm{m}} \\left( \\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} \\right)\n$$\n分配各项，我们得到问题陈述中给出的未校正通量的表达式：\n$$\nJ_i^{\\mathrm{MA,uncorr}} = - c D_i^{\\mathrm{m}} \\frac{\\partial x_i}{\\partial x} - c x_i D_i^{\\mathrm{m}} S_i \\frac{\\partial \\ln T}{\\partial x}\n$$\n第一项代表由浓度梯度驱动的 Fickian 扩散，而第二项代表由温度梯度驱动的热扩散（Soret 效应）。\n\n然而，用这个简化模型计算出的通量通常不满足摩尔平均参考系约束，即要求所有摩尔通量之和为零：$\\sum_{i=1}^N J_i = 0$。这是因为该近似破坏了 Maxwell–Stefan 公式的内在一致性。为了恢复这个物理约束，引入了一个校正速度 $V_{\\mathrm{c}}$。这个速度代表一个叠加在系统上的整体的、非扩散性的摩尔流，以确保净摩尔通量为零。物种 $i$ 的校正后混合物平均通量，记为 $J_i^{\\mathrm{MA}}$，定义为：\n$$\nJ_i^{\\mathrm{MA}} = J_i^{\\mathrm{MA,uncorr}} - c x_i V_{\\mathrm{c}}\n$$\n其中 $c x_i V_{\\mathrm{c}}$ 是校正对流通量。$V_{\\mathrm{c}}$ 的值是通过对校正后的通量强制施加零和约束来确定的：\n$$\n\\sum_{i=1}^N J_i^{\\mathrm{MA}} = \\sum_{i=1}^N \\left( J_i^{\\mathrm{MA,uncorr}} - c x_i V_{\\mathrm{c}} \\right) = 0\n$$\n$$\n\\sum_{i=1}^N J_i^{\\mathrm{MA,uncorr}} - V_{\\mathrm{c}} \\sum_{i=1}^N c x_i = 0\n$$\n因为 $\\sum_{i=1}^N x_i = 1$，第二项简化为 $c V_{\\mathrm{c}}$。求解 $V_{\\mathrm{c}}$ 可得：\n$$\nV_{\\mathrm{c}} = \\frac{\\sum_{i=1}^N J_i^{\\mathrm{MA,uncorr}}}{c}\n$$\n推导至此完成。最终的混合物平均通量 $J_i^{\\mathrm{MA}}$ 是通过首先使用解耦的类 Fickian 公式计算未校正的通量 $J_i^{\\mathrm{MA,uncorr}}$，然后应用基于 $V_{\\mathrm{c}}$ 的校正，以确保与所选参考系的一致性来获得的。\n\n### 第2部分：数值实现与比较\n\n下面的程序实现了针对提供的四个测试用例的完全多组分 (MC) 模型和混合物平均 (MA) 模型。\n\n对于 MC 模型，它按照问题陈述中的规定构建增广线性系统，并使用 `numpy.linalg.solve` 求解扩散速度 $\\mathbf{v}$。然后计算 MC 通量为 $\\mathbf{J}^{\\mathrm{MC}} = c \\, \\mathbf{x} \\odot \\mathbf{v}$。\n\n对于 MA 模型，它首先计算混合物平均扩散系数 $D_i^{\\mathrm{m}}$，然后计算未校正的通量 $J_i^{\\mathrm{MA,uncorr}}$、校正速度 $V_{\\mathrm{c}}$，最后计算校正后的通量 $J_i^{\\mathrm{MA}}$。\n\n对每个案例计算相对 $L^2$-范数误差 $\\varepsilon$，以量化近似 MA 模型和完全 MC 模型之间的差异。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the multicomponent and mixture-averaged diffusion models for four\n    test cases and computes the relative error of the approximation.\n    \"\"\"\n    R = 8.314462618  # Universal gas constant in J/(mol.K)\n    N = 4\n\n    # Binary diffusion coefficients for cases 1, 2, 3\n    D_ij_123 = np.array([\n        [np.inf, 1.2e-4, 1.0e-4, 1.1e-4],\n        [1.2e-4, np.inf, 7.0e-5, 8.0e-5],\n        [1.0e-4, 7.0e-5, np.inf, 9.0e-5],\n        [1.1e-4, 8.0e-5, 9.0e-5, np.inf]\n    ])\n\n    # Binary diffusion coefficients for case 4\n    D_ij_4 = np.full((4, 4), 1.0e-4)\n    np.fill_diagonal(D_ij_4, np.inf)\n\n    # Thermal diffusion ratios for all cases\n    S_i_all = np.array([0.30, -0.02, -0.01, 0.06])\n\n    test_cases = [\n        {\n            'x': np.array([0.25, 0.25, 0.25, 0.25]),\n            'grad_x': np.array([0.01, -0.005, -0.003, -0.002]),\n            'T': 1800.0,\n            'grad_T': 5000.0,\n            'p': 101325.0,\n            'D_ij': D_ij_123,\n            'S_i': S_i_all\n        },\n        {\n            'x': np.array([0.02, 0.48, 0.48, 0.02]),\n            'grad_x': np.array([-0.015, 0.007, 0.007, 0.001]),\n            'T': 2200.0,\n            'grad_T': -2000.0,\n            'p': 101325.0,\n            'D_ij': D_ij_123,\n            'S_i': S_i_all\n        },\n        {\n            'x': np.array([0.40, 0.10, 0.40, 0.10]),\n            'grad_x': np.array([0.001, -0.0005, 0.0002, -0.0007]),\n            'T': 1500.0,\n            'grad_T': 20000.0,\n            'p': 101325.0,\n            'D_ij': D_ij_123,\n            'S_i': S_i_all\n        },\n        {\n            'x': np.array([0.25, 0.35, 0.20, 0.20]),\n            'grad_x': np.array([-0.02, 0.01, 0.005, 0.005]),\n            'T': 2000.0,\n            'grad_T': 0.0,\n            'p': 101325.0,\n            'D_ij': D_ij_4,\n            'S_i': S_i_all\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        x, grad_x = case['x'], case['grad_x']\n        T, grad_T, p = case['T'], case['grad_T'], case['p']\n        D_ij, S_i = case['D_ij'], case['S_i']\n\n        # --- Common Calculations ---\n        c = p / (R * T)\n        grad_ln_T = (1.0 / T) * grad_T if T > 0 else 0.0\n\n        # --- Multicomponent (MC) Model ---\n        # 1. Build Maxwell-Stefan matrix L\n        L = np.zeros((N, N))\n        for i in range(N):\n            L[i, i] = np.sum([x[k] / D_ij[i, k] for k in range(N) if k != i])\n            for j in range(N):\n                if i != j:\n                    L[i, j] = -x[j] / D_ij[i, j]\n\n        # 2. Build driving force vector b\n        b = grad_x + x * S_i * grad_ln_T\n\n        # 3. Build and solve the augmented linear system\n        A = np.zeros((N + 1, N + 1))\n        A[:N, :N] = L\n        A[:N, N] = x\n        A[N, :N] = x.T\n        \n        rhs = np.zeros(N + 1)\n        rhs[:N] = -b\n        \n        sol = np.linalg.solve(A, rhs)\n        v_mc = sol[:N]\n\n        # 4. Compute multicomponent fluxes J_mc\n        J_mc = c * x * v_mc\n\n        # --- Mixture-Averaged (MA) Model ---\n        # 1. Calculate mixture-averaged diffusivities D_m\n        D_m = np.zeros(N)\n        for i in range(N):\n            inv_Dm_i = np.sum([x[j] / D_ij[i, j] for j in range(N) if j != i])\n            D_m[i] = 1.0 / inv_Dm_i\n\n        # 2. Calculate uncorrected fluxes J_ma_uncorr\n        term1 = -c * D_m * grad_x\n        term2 = -c * x * D_m * S_i * grad_ln_T\n        J_ma_uncorr = term1 + term2\n        \n        # 3. Calculate correction velocity V_c\n        V_c = np.sum(J_ma_uncorr) / c\n\n        # 4. Calculate corrected fluxes J_ma\n        J_ma = J_ma_uncorr - c * x * V_c\n\n        # --- Error Calculation ---\n        norm_J_mc = np.linalg.norm(J_mc)\n        if norm_J_mc == 0:\n            # Should not happen with given test cases.\n            # If J_mc is the zero vector, error is 0 only if J_ma is also zero.\n            epsilon = 0.0 if np.linalg.norm(J_ma) == 0 else np.inf\n        else:\n            diff_J = J_ma - J_mc\n            norm_diff_J = np.linalg.norm(diff_J)\n            epsilon = norm_diff_J / norm_J_mc\n        \n        results.append(epsilon)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}