{
    "hands_on_practices": [
        {
            "introduction": "This first exercise establishes the fundamental principle of the Soret effect. We explore a hypothetical scenario where the diffusive flux driven by a temperature gradient is perfectly balanced by the flux from a concentration gradient, resulting in zero net diffusion. This calculation is crucial for isolating the Soret effect and understanding the conditions required to counteract it. ",
            "id": "4015533",
            "problem": "In a one-dimensional, steady, low-Mach-number, isobaric, premixed combustion simulation, consider a dilute species $A$ diffusing in an otherwise inert bath gas $B$ across the preheat zone of a planar flame. Assume an ideal gas mixture and neglect body forces. The mixture is well described locally as a binary mixture $A$–$B$, and the diffusive transport of $A$ relative to the molar-averaged velocity is governed by the binary Stefan–Maxwell framework augmented with the thermal diffusion (Soret) driving force. The Soret coefficient $S_T$ is defined for the $A$–$B$ pair at the local thermodynamic state as the proportionality constant between the thermal gradient and the induced composition gradient under the condition of zero diffusive molar flux of $A$.\n\nAt a point in the preheat zone, the following data are known: the local mole fraction of $A$ is $x_A = 5.00 \\times 10^{-5}$, the Soret coefficient is $S_T = 1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}$, and the temperature increases in the positive $x$-direction with gradient $\\partial T/\\partial x = 2.40 \\times 10^{6}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$. Ignoring the Dufour effect in the energy equation, determine the steady-state mole fraction gradient $\\partial x_A/\\partial x$ required to exactly cancel the thermal diffusion contribution so that the net diffusive molar flux of $A$ vanishes at this location.\n\nExpress your final answer in $\\mathrm{m}^{-1}$ and round to three significant figures.",
            "solution": "## PROBLEM VALIDATION\n\n### Step 1: Extract Givens\n- System: One-dimensional ($x$-direction), steady, low-Mach-number, isobaric, premixed combustion.\n- Mixture: Dilute species $A$ in an inert bath gas $B$, behaving as an ideal gas.\n- Transport framework: Binary Stefan–Maxwell with thermal diffusion (Soret effect).\n- Soret coefficient definition: $S_T$ is the proportionality constant between the thermal gradient ($\\nabla T$) and the induced composition gradient ($\\nabla x_A$) when the diffusive molar flux of $A$ is zero.\n- Local mole fraction of species $A$: $x_A = 5.00 \\times 10^{-5}$.\n- Soret coefficient for the $A$–$B$ pair: $S_T = 1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}$.\n- Local temperature gradient: $\\frac{\\partial T}{\\partial x} = 2.40 \\times 10^{6}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$.\n- Condition: The net diffusive molar flux of species $A$ vanishes.\n- Simplification: The Dufour effect is neglected.\n- Objective: Determine the mole fraction gradient $\\frac{\\partial x_A}{\\partial x}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in the principles of non-equilibrium thermodynamics and transport phenomena, specifically as applied to combustion science. The Soret effect (thermal diffusion) is a known cross-diffusion phenomenon described by established theories. The use of the Stefan-Maxwell equations is standard. The given numerical values, while large for the temperature gradient, are physically plausible within the preheat zone of a flame.\n- **Well-Posed**: The problem is well-posed. It provides sufficient information to determine a unique solution. The goal is to find the mole fraction gradient that results in zero net diffusive flux, a condition that is mathematically well-defined. The definition and value of the Soret coefficient, combined with the other local properties, are the necessary inputs.\n- **Objective**: The problem is stated using precise, objective, and quantitative language, free from any subjective elements.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and objective. It is deemed **VALID**.\n\n## SOLUTION\n\nThe problem requires finding the mole fraction gradient, $\\frac{\\partial x_A}{\\partial x}$, that leads to a zero net diffusive molar flux for species $A$. The total diffusive flux, $\\mathbf{J}_A$, in a binary mixture under the influence of both concentration and temperature gradients is the sum of the Fickian diffusion flux (driven by concentration gradient) and the Soret diffusion flux (driven by temperature gradient).\n\nIn one dimension, the molar diffusive flux of species $A$ relative to the molar-averaged velocity can be expressed using a combined form derived from the Stefan-Maxwell equations:\n$$J_{A,x} = -c \\mathcal{D}_{AB} \\left( \\frac{\\partial x_A}{\\partial x} + \\frac{k_{TA}}{T} \\frac{\\partial T}{\\partial x} \\right)$$\nwhere $c$ is the total molar concentration, $\\mathcal{D}_{AB}$ is the binary diffusion coefficient, $T$ is the absolute temperature, and $k_{TA}$ is the thermal diffusion ratio for species $A$.\n\nThe thermal diffusion ratio $k_{TA}$ is related to the dimensionless thermal diffusion factor $\\alpha_T$ and the mole fractions of the species:\n$$k_{TA} = \\alpha_T x_A x_B$$\nwhere $x_A$ and $x_B$ are the mole fractions of species $A$ and $B$, respectively, and $x_A + x_B = 1$.\n\nThe Soret coefficient, $S_T$, is commonly defined in relation to the thermal diffusion factor $\\alpha_T$ and temperature $T$ as:\n$$S_T = \\frac{\\alpha_T}{T}$$\nThis definition is consistent with the given units of $S_T$, which are $\\mathrm{K}^{-1}$, since $\\alpha_T$ is dimensionless.\n\nSubstituting these relations into the flux equation, we can express the term involving the temperature gradient using the Soret coefficient $S_T$:\n$$\\frac{k_{TA}}{T} = \\frac{\\alpha_T x_A x_B}{T} = \\left(\\frac{\\alpha_T}{T}\\right) x_A x_B = S_T x_A x_B$$\nThe complete expression for the diffusive flux of species $A$ becomes:\n$$J_{A,x} = -c \\mathcal{D}_{AB} \\left( \\frac{\\partial x_A}{\\partial x} + S_T x_A x_B \\frac{\\partial T}{\\partial x} \\right)$$\nThe problem states that the net diffusive molar flux of $A$ vanishes, which means $J_{A,x} = 0$.\n$$0 = -c \\mathcal{D}_{AB} \\left( \\frac{\\partial x_A}{\\partial x} + S_T x_A x_B \\frac{\\partial T}{\\partial x} \\right)$$\nSince the total concentration $c$ and the diffusion coefficient $\\mathcal{D}_{AB}$ are non-zero, the term in the parentheses must be zero:\n$$\\frac{\\partial x_A}{\\partial x} + S_T x_A x_B \\frac{\\partial T}{\\partial x} = 0$$\nThis equation represents the balance where the diffusion driven by the concentration gradient exactly cancels the thermal diffusion (Soret effect). We can now solve for the required mole fraction gradient $\\frac{\\partial x_A}{\\partial x}$:\n$$\\frac{\\partial x_A}{\\partial x} = -S_T x_A x_B \\frac{\\partial T}{\\partial x}$$\nSince the mixture is binary, $x_B = 1 - x_A$. Substituting this into the equation gives:\n$$\\frac{\\partial x_A}{\\partial x} = -S_T x_A (1 - x_A) \\frac{\\partial T}{\\partial x}$$\nWe are given the following values:\n- Mole fraction of species $A$: $x_A = 5.00 \\times 10^{-5}$\n- Soret coefficient: $S_T = 1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}$\n- Temperature gradient: $\\frac{\\partial T}{\\partial x} = 2.40 \\times 10^{6}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$\n\nSubstituting these values into the derived equation:\n$$\\frac{\\partial x_A}{\\partial x} = -(1.10 \\times 10^{-3}\\ \\mathrm{K}^{-1}) \\times (5.00 \\times 10^{-5}) \\times (1 - 5.00 \\times 10^{-5}) \\times (2.40 \\times 10^{6}\\ \\mathrm{K}\\ \\mathrm{m}^{-1})$$\nFirst, calculate the product of the main numerical factors and the powers of $10$:\n$$(1.10) \\times (5.00) \\times (2.40) = 13.2$$\n$$10^{-3} \\times 10^{-5} \\times 10^{6} = 10^{-2}$$\nNow, include the term $(1 - x_A)$:\n$$(1 - 5.00 \\times 10^{-5}) = 0.99995$$\nCombining all parts:\n$$\\frac{\\partial x_A}{\\partial x} = -13.2 \\times 10^{-2} \\times 0.99995 \\ \\mathrm{m}^{-1}$$\n$$\\frac{\\partial x_A}{\\partial x} = -0.132 \\times 0.99995 \\ \\mathrm{m}^{-1}$$\n$$\\frac{\\partial x_A}{\\partial x} = -0.1319934 \\ \\mathrm{m}^{-1}$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\\frac{\\partial x_A}{\\partial x} \\approx -0.132 \\ \\mathrm{m}^{-1}$$\nThe negative sign indicates that for the net flux to be zero, the mole fraction of species $A$ must decrease in the direction of increasing temperature. This generates a Fickian diffusion flux in the positive $x$-direction that counteracts the Soret flux, which, for a positive $S_T$, drives species $A$ toward the colder region (negative $x$-direction).",
            "answer": "$$\\boxed{-0.132}$$"
        },
        {
            "introduction": "Real-world combustion simulations often involve trade-offs between accuracy and computational cost, especially in modeling transport phenomena. This practice delves into this issue by contrasting the rigorous Maxwell-Stefan equations with the widely used mixture-averaged approximation for diffusive fluxes. You will derive this common approximation and then implement both models to quantify the error, providing critical insight into the validity of simplified transport models. ",
            "id": "4015561",
            "problem": "Consider a one-dimensional, isobaric, ideal-gas mixture of $N$ chemically nonreacting species with mole fractions $x_i$, total molar concentration $c$, temperature $T$, and pressure $p$. Let $x_i$ satisfy $\\sum_{i=1}^N x_i = 1$, and define the spatial gradients $\\partial x_i / \\partial x$ and $\\partial T / \\partial x$ along the coordinate $x$. Assume no external body forces and neglect barodiffusion. The total molar concentration obeys the Ideal Gas Law, $c = p/(R T)$, where $R$ is the universal gas constant.\n\nThe full multicomponent diffusive transport of species velocities is governed by the Maxwell–Stefan equations with thermal diffusion (Soret effect). In one dimension and the molar-average reference frame, these equations can be expressed as a linear system of $N$ equations with a single frame constraint:\n- For each species $i$, the coupling between species diffusion velocities $v_i$ is\n$$\n\\sum_{j \\neq i} \\frac{x_j}{D_{ij}} \\left(v_i - v_j \\right) = - \\frac{\\partial x_i}{\\partial x} - x_i S_i \\frac{\\partial \\ln T}{\\partial x},\n$$\nwhere $D_{ij}$ are the binary diffusion coefficients (symmetric with $D_{ij} = D_{ji}$, units $\\mathrm{m^2/s}$) and $S_i$ are dimensionless thermal diffusion ratios. The velocities satisfy the molar-average frame constraint\n$$\n\\sum_{i=1}^N x_i v_i = 0.\n$$\nThe molar diffusive fluxes are then $J_i^{\\mathrm{MC}} = c x_i v_i$ with units $\\mathrm{mol/(m^2 \\cdot s)}$.\n\nThe mixture-averaged approximation replaces the multicomponent coupling with an effective species diffusion coefficient defined by\n$$\n\\frac{1}{D_i^{\\mathrm{m}}} = \\sum_{j \\neq i} \\frac{x_j}{D_{ij}},\n$$\nand models the uncoupled species molar fluxes by\n$$\nJ_i^{\\mathrm{MA,uncorr}} = - c D_i^{\\mathrm{m}} \\frac{\\partial x_i}{\\partial x} - c x_i D_i^{\\mathrm{m}} S_i \\frac{\\partial \\ln T}{\\partial x}.\n$$\nTo enforce the molar-average frame condition $\\sum_i J_i^{\\mathrm{MA}} = 0$, introduce the correction velocity\n$$\nV_{\\mathrm{c}} = \\frac{\\sum_{i=1}^N J_i^{\\mathrm{MA,uncorr}}}{c},\n$$\nand define the corrected mixture-averaged fluxes\n$$\nJ_i^{\\mathrm{MA}} = J_i^{\\mathrm{MA,uncorr}} - c x_i V_{\\mathrm{c}}.\n$$\n\nYour task is to:\n1. Derive, from the Maxwell–Stefan equations given above, the mixture-averaged approximation with the thermal diffusion term as written, clearly explaining the approximations invoked to obtain $J_i^{\\mathrm{MA}}$ from the multicomponent framework.\n2. Implement both transport models numerically for $N=4$ species and quantify the error of the mixture-averaged model relative to the full multicomponent model using the relative $L^2$-norm\n$$\n\\varepsilon = \\frac{\\left\\| \\mathbf{J}^{\\mathrm{MA}} - \\mathbf{J}^{\\mathrm{MC}} \\right\\|_2}{\\left\\| \\mathbf{J}^{\\mathrm{MC}} \\right\\|_2},\n$$\nwhere $\\mathbf{J}$ denotes the vector of species fluxes. All fluxes must be reported and computed in $\\mathrm{mol/(m^2 \\cdot s)}$. Angles are not part of this problem and need not be specified.\n\nUse the universal gas constant $R = 8.314462618 \\ \\mathrm{J/(mol \\cdot K)}$ and the following four-test-case suite. In each case, binary diffusion coefficients $D_{ij}$ are given as a symmetric matrix with $D_{ii}$ unused. Thermal diffusion ratios $S_i$ are dimensionless and held fixed where specified. Gradients $\\partial x_i / \\partial x$ are in $\\mathrm{m^{-1}}$, temperature $T$ in $\\mathrm{K}$, temperature gradient $\\partial T/\\partial x$ in $\\mathrm{K/m}$, pressure $p$ in $\\mathrm{Pa}$.\n\nTest case 1 (balanced mixture, moderate thermal gradient):\n- $N = 4$\n- $x = [0.25, 0.25, 0.25, 0.25]$\n- $\\partial x / \\partial x = [0.01, -0.005, -0.003, -0.002] \\ \\mathrm{m^{-1}}$\n- $T = 1800 \\ \\mathrm{K}$, $\\partial T/\\partial x = 5000 \\ \\mathrm{K/m}$, $p = 101325 \\ \\mathrm{Pa}$\n- $D_{ij}$ (in $\\mathrm{m^2/s}$):\n$$\n\\begin{bmatrix}\n\\infty & 1.2 \\times 10^{-4} & 1.0 \\times 10^{-4} & 1.1 \\times 10^{-4} \\\\\n1.2 \\times 10^{-4} & \\infty & 7.0 \\times 10^{-5} & 8.0 \\times 10^{-5} \\\\\n1.0 \\times 10^{-4} & 7.0 \\times 10^{-5} & \\infty & 9.0 \\times 10^{-5} \\\\\n1.1 \\times 10^{-4} & 8.0 \\times 10^{-5} & 9.0 \\times 10^{-5} & \\infty\n\\end{bmatrix}\n$$\n- $S = [0.30, -0.02, -0.01, 0.06]$\n\nTest case 2 (one species dilute, weak negative thermal gradient):\n- $N = 4$\n- $x = [0.02, 0.48, 0.48, 0.02]$\n- $\\partial x / \\partial x = [-0.015, 0.007, 0.007, 0.001] \\ \\mathrm{m^{-1}}$\n- $T = 2200 \\ \\mathrm{K}$, $\\partial T/\\partial x = -2000 \\ \\mathrm{K/m}$, $p = 101325 \\ \\mathrm{Pa}$\n- $D_{ij}$ same as Test case 1\n- $S$ same as Test case 1\n\nTest case 3 (strong thermal gradient, small composition gradients):\n- $N = 4$\n- $x = [0.40, 0.10, 0.40, 0.10]$\n- $\\partial x / \\partial x = [0.001, -0.0005, 0.0002, -0.0007] \\ \\mathrm{m^{-1}}$\n- $T = 1500 \\ \\mathrm{K}$, $\\partial T/\\partial x = 20000 \\ \\mathrm{K/m}$, $p = 101325 \\ \\mathrm{Pa}$\n- $D_{ij}$ same as Test case 1\n- $S$ same as Test case 1\n\nTest case 4 (equal binary diffusivities, no thermal gradient):\n- $N = 4$\n- $x = [0.25, 0.35, 0.20, 0.20]$\n- $\\partial x / \\partial x = [-0.02, 0.01, 0.005, 0.005] \\ \\mathrm{m^{-1}}$\n- $T = 2000 \\ \\mathrm{K}$, $\\partial T/\\partial x = 0 \\ \\mathrm{K/m}$, $p = 101325 \\ \\mathrm{Pa}$\n- $D_{ij}$ (in $\\mathrm{m^2/s}$):\n$$\n\\begin{bmatrix}\n\\infty & 1.0 \\times 10^{-4} & 1.0 \\times 10^{-4} & 1.0 \\times 10^{-4} \\\\\n1.0 \\times 10^{-4} & \\infty & 1.0 \\times 10^{-4} & 1.0 \\times 10^{-4} \\\\\n1.0 \\times 10^{-4} & 1.0 \\times 10^{-4} & \\infty & 1.0 \\times 10^{-4} \\\\\n1.0 \\times 10^{-4} & 1.0 \\times 10^{-4} & 1.0 \\times 10^{-4} & \\infty\n\\end{bmatrix}\n$$\n- $S$ same as Test case 1\n\nYour program must:\n- Implement the multicomponent solution by assembling the Maxwell–Stefan matrix $L$ with entries $L_{ii} = \\sum_{j \\neq i} x_j / D_{ij}$ and $L_{ij} = - x_j / D_{ij}$ for $i \\neq j$, forming the driving vector $b_i = \\partial x_i / \\partial x + x_i S_i \\partial \\ln T / \\partial x$, and solving the augmented system\n$$\n\\begin{bmatrix}\nL & \\mathbf{x} \\\\\n\\mathbf{x}^\\top & 0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{v} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n- \\mathbf{b} \\\\\n0\n\\end{bmatrix}\n$$\nto obtain $\\mathbf{v}$ satisfying the frame constraint, and then compute $\\mathbf{J}^{\\mathrm{MC}} = c \\, \\mathbf{x} \\odot \\mathbf{v}$, where $\\odot$ denotes element-wise multiplication.\n- Implement the mixture-averaged fluxes $\\mathbf{J}^{\\mathrm{MA}}$ using $D_i^{\\mathrm{m}}$ as defined above and the correction velocity $V_{\\mathrm{c}}$.\n- Compute the relative error $\\varepsilon$ for each test case.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), where each result is the floating-point value of $\\varepsilon$ for the corresponding test case.",
            "solution": "The user has provided a problem statement that requires two main components: first, a theoretical derivation of the mixture-averaged diffusion model from the more fundamental Maxwell–Stefan equations; second, a numerical implementation to compare the two models and quantify the error of the approximation for a set of test cases.\n\nThe problem validation confirms that the statement is scientifically grounded, well-posed, objective, and internally consistent. The parameters and conditions provided are physically realistic for a high-temperature gas mixture, and the mathematical framework is standard in the field of transport phenomena and computational combustion. No flaws were detected. We may therefore proceed with the solution.\n\n### Part 1: Derivation of the Mixture-Averaged Model\n\nThe objective is to derive the mixture-averaged flux expression,\n$$\nJ_i^{\\mathrm{MA}} = J_i^{\\mathrm{MA,uncorr}} - c x_i V_{\\mathrm{c}},\n$$\nstarting from the multicomponent Maxwell–Stefan equations. This derivation involves two key steps: first, an approximation to decouple the species fluxes, yielding an uncorrected flux $J_i^{\\mathrm{MA,uncorr}}$; second, the introduction of a correction to ensure the fluxes satisfy the molar-average frame constraint.\n\nThe starting point is the Maxwell–Stefan equation for species $i$ in a mixture of $N$ species, including the Soret effect (thermal diffusion) and neglecting pressure and external force gradients:\n$$\n\\sum_{j \\neq i} \\frac{x_j}{D_{ij}} \\left(v_i - v_j \\right) = - \\frac{\\partial x_i}{\\partial x} - x_i S_i \\frac{\\partial \\ln T}{\\partial x}\n$$\nHere, $x_i$ is the mole fraction, $v_i$ is the diffusion velocity, $D_{ij}$ is the binary diffusion coefficient, $S_i$ is the thermal diffusion ratio, $T$ is the temperature, and $x$ is the spatial coordinate.\n\nWe can express the diffusion velocities $v_i$ and $v_j$ in terms of the molar fluxes $J_i = c x_i v_i$, where $c$ is the total molar concentration. Thus, $v_i = J_i / (c x_i)$. Substituting this into the Maxwell–Stefan equation gives:\n$$\n\\sum_{j \\neq i} \\frac{x_j}{D_{ij}} \\left(\\frac{J_i}{c x_i} - \\frac{J_j}{c x_j} \\right) = - \\frac{\\partial x_i}{\\partial x} - x_i S_i \\frac{\\partial \\ln T}{\\partial x}\n$$\nMultiplying by $c x_i$ and distributing the sum gives:\n$$\n\\sum_{j \\neq i} \\frac{x_j}{D_{ij}} J_i - \\sum_{j \\neq i} \\frac{c x_i x_j}{c D_{ij} x_j} J_j = - c x_i \\frac{\\partial x_i}{\\partial x} - c x_i^2 S_i \\frac{\\partial \\ln T}{\\partial x}\n$$\nThis is incorrect. A more direct path is to rearrange the equation to solve for one flux, $J_i$.\nLet's express the Maxwell-Stefan equations in terms of fluxes directly from the start:\n$$\n\\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} = \\sum_{j \\neq i} \\frac{x_i v_j - x_j v_i}{D_{ij}}\n$$\nSubstituting $v_k = J_k / (c x_k)$:\n$$\n\\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} = \\sum_{j \\neq i} \\frac{x_i \\frac{J_j}{c x_j} - x_j \\frac{J_i}{c x_i}}{D_{ij}} = \\sum_{j \\neq i} \\frac{x_i J_j - x_j J_i}{c D_{ij}}\n$$\nRearranging the sum on the right-hand side:\n$$\n\\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} = \\frac{x_i}{c} \\sum_{j \\neq i} \\frac{J_j}{D_{ij}} - \\frac{J_i}{c} \\sum_{j \\neq i} \\frac{x_j}{D_{ij}}\n$$\nWe now introduce the definition of the mixture-averaged diffusion coefficient, $D_i^{\\mathrm{m}}$, as given in the problem statement:\n$$\n\\frac{1}{D_i^{\\mathrm{m}}} = \\sum_{j \\neq i} \\frac{x_j}{D_{ij}}\n$$\nSubstituting this into our rearranged equation yields:\n$$\n\\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} = \\frac{x_i}{c} \\sum_{j \\neq i} \\frac{J_j}{D_{ij}} - \\frac{J_i}{c D_i^{\\mathrm{m}}}\n$$\nThis equation is still an exact representation of the multicomponent system, relating the flux of species $i$ to the driving forces and the fluxes of all other species. To obtain the mixture-averaged model, a crucial approximation is made: the contribution from the other species' fluxes is neglected. Specifically, we approximate:\n$$\n\\frac{x_i}{c} \\sum_{j \\neq i} \\frac{J_j}{D_{ij}} \\approx 0\n$$\nThis is the central approximation that decouples the species from each other, simplifying the problem from a coupled system of equations to a set of independent equations, one for each species. Under this approximation, the multicomponent flux $J_i$ is replaced by the uncorrected mixture-averaged flux, $J_i^{\\mathrm{MA,uncorr}}$:\n$$\n\\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} \\approx - \\frac{J_i^{\\mathrm{MA,uncorr}}}{c D_i^{\\mathrm{m}}}\n$$\nSolving for $J_i^{\\mathrm{MA,uncorr}}$:\n$$\nJ_i^{\\mathrm{MA,uncorr}} = - c D_i^{\\mathrm{m}} \\left( \\frac{\\partial x_i}{\\partial x} + x_i S_i \\frac{\\partial \\ln T}{\\partial x} \\right)\n$$\nDistributing the terms, we arrive at the expression for the uncorrected flux given in the problem statement:\n$$\nJ_i^{\\mathrm{MA,uncorr}} = - c D_i^{\\mathrm{m}} \\frac{\\partial x_i}{\\partial x} - c x_i D_i^{\\mathrm{m}} S_i \\frac{\\partial \\ln T}{\\partial x}\n$$\nThe first term represents Fickian diffusion driven by the concentration gradient, while the second term represents thermal diffusion (Soret effect) driven by the temperature gradient.\n\nHowever, the fluxes computed with this simplified model do not generally satisfy the molar-average frame constraint, which requires the sum of all molar fluxes to be zero: $\\sum_{i=1}^N J_i = 0$. This is because the approximation disrupts the inherent consistency of the Maxwell–Stefan formulation. To restore this physical constraint, a correction velocity, $V_{\\mathrm{c}}$, is introduced. This velocity represents a bulk, non-diffusive molar flow that is superimposed on the system to ensure the net molar flux is zero. The corrected mixture-averaged flux for species $i$, denoted $J_i^{\\mathrm{MA}}$, is defined as:\n$$\nJ_i^{\\mathrm{MA}} = J_i^{\\mathrm{MA,uncorr}} - c x_i V_{\\mathrm{c}}\n$$\nwhere $c x_i V_{\\mathrm{c}}$ is the corrective convective flux. The value of $V_{\\mathrm{c}}$ is determined by enforcing the zero-sum constraint on the corrected fluxes:\n$$\n\\sum_{i=1}^N J_i^{\\mathrm{MA}} = \\sum_{i=1}^N \\left( J_i^{\\mathrm{MA,uncorr}} - c x_i V_{\\mathrm{c}} \\right) = 0\n$$\n$$\n\\sum_{i=1}^N J_i^{\\mathrm{MA,uncorr}} - V_{\\mathrm{c}} \\sum_{i=1}^N c x_i = 0\n$$\nSince $\\sum_{i=1}^N x_i = 1$, the second term simplifies to $c V_{\\mathrm{c}}$. Solving for $V_{\\mathrm{c}}$ gives:\n$$\nV_{\\mathrm{c}} = \\frac{\\sum_{i=1}^N J_i^{\\mathrm{MA,uncorr}}}{c}\n$$\nThis completes the derivation. The final mixture-averaged fluxes, $J_i^{\\mathrm{MA}}$, are obtained by first calculating the uncorrected fluxes $J_i^{\\mathrm{MA,uncorr}}$ using the decoupled Fickian-like formula and then applying the correction based on $V_{\\mathrm{c}}$ to ensure consistency with the chosen reference frame.\n\n### Part 2: Numerical Implementation and Comparison\n\nThe following program implements both the full multicomponent (MC) and the mixture-averaged (MA) models for the four supplied test cases.\n\nFor the MC model, it constructs the augmented linear system as specified in the problem statement and solves it for the diffusion velocities $\\mathbf{v}$ using `numpy.linalg.solve`. The MC fluxes are then computed as $\\mathbf{J}^{\\mathrm{MC}} = c \\, \\mathbf{x} \\odot \\mathbf{v}$.\n\nFor the MA model, it first calculates the mixture-averaged diffusivities $D_i^{\\mathrm{m}}$, then the uncorrected fluxes $J_i^{\\mathrm{MA,uncorr}}$, the correction velocity $V_{\\mathrm{c}}$, and finally the corrected fluxes $J_i^{\\mathrm{MA}}$.\n\nThe relative $L^2$-norm error, $\\varepsilon$, is computed for each case to quantify the discrepancy between the approximate MA model and the full MC model.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the multicomponent and mixture-averaged diffusion models for four\n    test cases and computes the relative error of the approximation.\n    \"\"\"\n    R = 8.314462618  # Universal gas constant in J/(mol.K)\n    N = 4\n\n    # Binary diffusion coefficients for cases 1, 2, 3\n    D_ij_123 = np.array([\n        [np.inf, 1.2e-4, 1.0e-4, 1.1e-4],\n        [1.2e-4, np.inf, 7.0e-5, 8.0e-5],\n        [1.0e-4, 7.0e-5, np.inf, 9.0e-5],\n        [1.1e-4, 8.0e-5, 9.0e-5, np.inf]\n    ])\n\n    # Binary diffusion coefficients for case 4\n    D_ij_4 = np.full((4, 4), 1.0e-4)\n    np.fill_diagonal(D_ij_4, np.inf)\n\n    # Thermal diffusion ratios for all cases\n    S_i_all = np.array([0.30, -0.02, -0.01, 0.06])\n\n    test_cases = [\n        {\n            'x': np.array([0.25, 0.25, 0.25, 0.25]),\n            'grad_x': np.array([0.01, -0.005, -0.003, -0.002]),\n            'T': 1800.0,\n            'grad_T': 5000.0,\n            'p': 101325.0,\n            'D_ij': D_ij_123,\n            'S_i': S_i_all\n        },\n        {\n            'x': np.array([0.02, 0.48, 0.48, 0.02]),\n            'grad_x': np.array([-0.015, 0.007, 0.007, 0.001]),\n            'T': 2200.0,\n            'grad_T': -2000.0,\n            'p': 101325.0,\n            'D_ij': D_ij_123,\n            'S_i': S_i_all\n        },\n        {\n            'x': np.array([0.40, 0.10, 0.40, 0.10]),\n            'grad_x': np.array([0.001, -0.0005, 0.0002, -0.0007]),\n            'T': 1500.0,\n            'grad_T': 20000.0,\n            'p': 101325.0,\n            'D_ij': D_ij_123,\n            'S_i': S_i_all\n        },\n        {\n            'x': np.array([0.25, 0.35, 0.20, 0.20]),\n            'grad_x': np.array([-0.02, 0.01, 0.005, 0.005]),\n            'T': 2000.0,\n            'grad_T': 0.0,\n            'p': 101325.0,\n            'D_ij': D_ij_4,\n            'S_i': S_i_all\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        x, grad_x = case['x'], case['grad_x']\n        T, grad_T, p = case['T'], case['grad_T'], case['p']\n        D_ij, S_i = case['D_ij'], case['S_i']\n\n        # --- Common Calculations ---\n        c = p / (R * T)\n        grad_ln_T = (1.0 / T) * grad_T if T > 0 else 0.0\n\n        # --- Multicomponent (MC) Model ---\n        # 1. Build Maxwell-Stefan matrix L\n        L = np.zeros((N, N))\n        for i in range(N):\n            L[i, i] = np.sum([x[k] / D_ij[i, k] for k in range(N) if k != i])\n            for j in range(N):\n                if i != j:\n                    L[i, j] = -x[j] / D_ij[i, j]\n\n        # 2. Build driving force vector b\n        b = grad_x + x * S_i * grad_ln_T\n\n        # 3. Build and solve the augmented linear system\n        A = np.zeros((N + 1, N + 1))\n        A[:N, :N] = L\n        A[:N, N] = x\n        A[N, :N] = x.T\n        \n        rhs = np.zeros(N + 1)\n        rhs[:N] = -b\n        \n        sol = np.linalg.solve(A, rhs)\n        v_mc = sol[:N]\n\n        # 4. Compute multicomponent fluxes J_mc\n        J_mc = c * x * v_mc\n\n        # --- Mixture-Averaged (MA) Model ---\n        # 1. Calculate mixture-averaged diffusivities D_m\n        D_m = np.zeros(N)\n        for i in range(N):\n            inv_Dm_i = np.sum([x[j] / D_ij[i, j] for j in range(N) if j != i])\n            D_m[i] = 1.0 / inv_Dm_i\n\n        # 2. Calculate uncorrected fluxes J_ma_uncorr\n        term1 = -c * D_m * grad_x\n        term2 = -c * x * D_m * S_i * grad_ln_T\n        J_ma_uncorr = term1 + term2\n        \n        # 3. Calculate correction velocity V_c\n        V_c = np.sum(J_ma_uncorr) / c\n\n        # 4. Calculate corrected fluxes J_ma\n        J_ma = J_ma_uncorr - c * x * V_c\n\n        # --- Error Calculation ---\n        norm_J_mc = np.linalg.norm(J_mc)\n        if norm_J_mc == 0:\n            # Should not happen with given test cases.\n            # If J_mc is the zero vector, error is 0 only if J_ma is also zero.\n            epsilon = 0.0 if np.linalg.norm(J_ma) == 0 else np.inf\n        else:\n            diff_J = J_ma - J_mc\n            norm_diff_J = np.linalg.norm(diff_J)\n            epsilon = norm_diff_J / norm_J_mc\n        \n        results.append(epsilon)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having explored the fundamental physics and modeling approaches, this final practice connects the Soret effect to a key observable in combustion: the laminar flame speed, $S$. Using a simplified but physically representative model for a premixed flame, you will perform a numerical sensitivity analysis to quantify how changes in the thermal diffusion coefficients, $k_{T,i}$, of different species impact flame propagation. This exercise demonstrates a powerful technique for identifying the most influential transport parameters in a complex reactive system. ",
            "id": "4015514",
            "problem": "Consider a one-dimensional, steady, planar premixed flame propagating with speed $S$ into a quiescent, uniform unburnt mixture along the $x$-axis. The mixture contains $N$ key species indexed by $i \\in \\{1,\\dots,N\\}$ with mass fractions $Y_i(x)$ and temperature $T(x)$. The mass conservation for species $i$ in the reference frame attached to the flame front is given by the steady one-dimensional species balance, which is a consequence of the conservation of mass and the transport of species:\n$$\n- S \\,\\frac{d Y_i}{d x} \\;=\\; \\frac{d J_i}{d x} \\;+\\; \\omega_i,\n$$\nwhere $J_i$ is the diffusive mass flux of species $i$ and $\\omega_i$ is the net production rate of species $i$ due to chemical reactions. In a mixture-averaged description with thermal diffusion (the Soret phenomenon), the species flux is modeled as\n$$\nJ_i \\;=\\; - \\rho\\, D_i \\,\\frac{d Y_i}{d x} \\;-\\; \\rho\\, D_{T,i}\\, Y_i(1-Y_i)\\, \\frac{d(\\ln T)}{d x},\n$$\nwhere $\\rho$ is the density, $D_i$ is the mixture-averaged mass diffusion coefficient of species $i$, and $D_{T,i}$ is the thermal diffusion coefficient given by $D_{T,i} = k_{T,i} D_i$, with $k_{T,i}$ the thermal diffusion ratio for species $i$. The energy equation, which includes the Dufour phenomenon (cross-heat flux driven by species gradients), can be written as a steady one-dimensional balance of convection, conduction, cross-heat flux, and reaction heat release. For the purposes of local sensitivity with respect to the thermal diffusion ratios $k_{T,i}$, treat the temperature jump across the flame, characterized by the dimensionless quantity\n$$\n\\Delta \\ln T \\;=\\; \\ln\\!\\left(\\frac{T_b}{T_u}\\right),\n$$\nas a fixed input determined by upstream and burned conditions, where $T_u$ is the unburnt upstream temperature and $T_b$ is the burnt downstream temperature (both in $\\mathrm{K}$). This assumption makes the influence of the Dufour phenomenon implicit through the fixed temperature jump, while the explicit sensitivity target is the Soret coupling via $k_{T,i}$.\n\nIntroduce a scalar progress variable $c(x)$ that increases monotonically from upstream to downstream and is constructed as a weighted sum of species changes, with weights $w_i$ representing stoichiometric and reactivity importance. Under a leading-edge linearization of the reaction term with an effective growth rate $r_{\\mathrm{eff}}$ (in $\\mathrm{s}^{-1}$), the coupled system can be reduced to a scalar advection–diffusion–reaction equation for $c(x)$ in the flame-attached frame. The diffusion of the progress variable inherits mixture-averaged and thermal diffusion contributions from the species fluxes. From this reduced description and fundamental conservation laws, one can compute a physically meaningful flame speed $S$ (in $\\mathrm{m/s}$) that depends on the effective diffusion coefficient and the effective growth rate.\n\nYour task is to implement a local sensitivity analysis of the computed flame speed $S$ with respect to the thermal diffusion ratios $k_{T,i}$ for the key species using the symmetric finite-difference definition of a partial derivative. For a small perturbation $\\varepsilon$, the local sensitivity for species $i$ is defined as\n$$\n\\frac{\\partial S}{\\partial k_{T,i}} \\;\\approx\\; \\frac{S\\!\\left(k_{T,i} + \\varepsilon\\right) \\;-\\; S\\!\\left(k_{T,i} - \\varepsilon\\right)}{2\\,\\varepsilon},\n$$\ncomputed with all other parameters held fixed. The perturbation $\\varepsilon$ must be chosen sufficiently small to capture local behavior but not so small as to cause numerical cancellation; use $\\varepsilon = 10^{-6}$.\n\nUse the following modeling framework for computing $S$ from given parameters, which is derived from the leading-edge linearization of the coupled conservation equations described above: treat the effective diffusion coefficient of the progress variable as a mixture-averaged sum with thermal diffusion contributions proportional to the temperature jump,\n$$\nD_{\\mathrm{eff}} \\;=\\; \\sum_{i=1}^{N} w_i \\, D_i \\, \\left( 1 + k_{T,i}\\, \\Delta \\ln T \\right),\n$$\nand compute the flame speed from the scalar advection–diffusion–reaction leading-edge analysis as\n$$\nS \\;=\\; 2 \\,\\sqrt{D_{\\mathrm{eff}} \\, r_{\\mathrm{eff}}}.\n$$\nHere $D_i$ are in $\\mathrm{m^2/s}$, $r_{\\mathrm{eff}}$ is in $\\mathrm{s^{-1}}$, and $S$ is in $\\mathrm{m/s}$. The density $\\rho$ does not explicitly appear after nondimensionalization of the scalar reduction; the Dufour contribution is embedded implicitly in the temperature jump $\\Delta \\ln T$. Ensure $D_{\\mathrm{eff}} > 0$ for physical consistency.\n\nImplement a program that, for each specified test case, computes the local sensitivities $\\partial S / \\partial k_{T,i}$ for all species $i$ using the symmetric finite-difference formula above. Express all sensitivity values in $\\mathrm{m/s}$.\n\nUse the following test suite. In all cases, the species order is [$\\text{H}_2$, $\\text{CO}$, $\\text{H}_2\\text{O}$], and all diffusion coefficients $D_i$ are given in $\\mathrm{m^2/s}$, temperatures in $\\mathrm{K}$, and $r_{\\mathrm{eff}}$ in $\\mathrm{s^{-1}}$.\n\n- Test Case $1$ (general case):\n  - $N = 3$\n  - $D_i = [1.0\\times 10^{-4},\\; 7.0\\times 10^{-5},\\; 5.0\\times 10^{-5}]$\n  - $w_i = [0.5,\\; 0.3,\\; 0.2]$\n  - $k_{T,i} = [0.35,\\; 0.05,\\; -0.02]$\n  - $T_u = 300$\n  - $T_b = 2100$\n  - $r_{\\mathrm{eff}} = 500$\n\n- Test Case $2$ (boundary case with zero thermal diffusion ratios):\n  - $N = 3$\n  - $D_i = [1.0\\times 10^{-4},\\; 7.0\\times 10^{-5},\\; 5.0\\times 10^{-5}]$\n  - $w_i = [0.5,\\; 0.3,\\; 0.2]$\n  - $k_{T,i} = [0.0,\\; 0.0,\\; 0.0]$\n  - $T_u = 300$\n  - $T_b = 2100$\n  - $r_{\\mathrm{eff}} = 500$\n\n- Test Case $3$ (edge case with small temperature jump):\n  - $N = 3$\n  - $D_i = [1.0\\times 10^{-4},\\; 7.0\\times 10^{-5},\\; 5.0\\times 10^{-5}]$\n  - $w_i = [0.5,\\; 0.3,\\; 0.2]$\n  - $k_{T,i} = [0.35,\\; 0.05,\\; -0.02]$\n  - $T_u = 300$\n  - $T_b = 330$\n  - $r_{\\mathrm{eff}} = 500$\n\n- Test Case $4$ (edge case with negative dominant thermal diffusion ratio and altered weights and rate):\n  - $N = 3$\n  - $D_i = [1.0\\times 10^{-4},\\; 7.0\\times 10^{-5},\\; 5.0\\times 10^{-5}]$\n  - $w_i = [0.6,\\; 0.25,\\; 0.15]$\n  - $k_{T,i} = [-0.40,\\; 0.10,\\; 0.05]$\n  - $T_u = 290$\n  - $T_b = 2200$\n  - $r_{\\mathrm{eff}} = 100$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be flattened in test-case-major order and species-minor order. That is, the output should be\n$$\n\\big[ s_{1,1},\\; s_{1,2},\\; s_{1,3},\\; s_{2,1},\\; s_{2,2},\\; s_{2,3},\\; s_{3,1},\\; s_{3,2},\\; s_{3,3},\\; s_{4,1},\\; s_{4,2},\\; s_{4,3} \\big],\n$$\nwhere $s_{j,i}$ denotes the sensitivity $\\partial S/\\partial k_{T,i}$ for species $i$ in test case $j$, expressed in $\\mathrm{m/s}$. No additional text should be printed.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, objective, and self-contained. The model presented for the flame speed, while simplified, is based on established principles of combustion theory, specifically the asymptotic analysis of premixed flame structures. The parameters provided are physically realistic, and the task is a standard numerical sensitivity analysis. There are no contradictions, ambiguities, or logical flaws. We may therefore proceed with the solution.\n\nThe objective is to compute the local sensitivity of the planar premixed flame speed, $S$, with respect to the thermal diffusion ratio, $k_{T,i}$, for each key species $i$. The sensitivity is a partial derivative, $\\partial S / \\partial k_{T,i}$, which quantifies how the flame speed changes in response to an infinitesimal change in a given thermal diffusion ratio, while all other parameters are held constant. This analysis is crucial for understanding the impact of Soret diffusion on flame propagation.\n\nThe problem provides a complete model to calculate the flame speed $S$ from a set of fundamental parameters. This model can be expressed as a composite function. The calculation proceeds through the following sequence of steps:\n\n1.  **Dimensionless Temperature Jump**: First, the characteristic temperature jump across the flame is quantified by the dimensionless parameter $\\Delta \\ln T$. This is calculated from the unburnt ($T_u$) and burnt ($T_b$) gas temperatures:\n    $$\n    \\Delta \\ln T = \\ln\\left(\\frac{T_b}{T_u}\\right)\n    $$\n    This quantity represents the strength of the temperature gradient that drives thermal diffusion.\n\n2.  **Effective Diffusion Coefficient**: The model uses a progress variable approach, where the complex multicomponent diffusion is condensed into a single effective diffusion coefficient, $D_{\\mathrm{eff}}$. This coefficient is a weighted sum of the contributions from each of the $N$ species, incorporating both ordinary mass diffusion (via $D_i$) and thermal diffusion (via $k_{T,i}$). The formula is given as:\n    $$\n    D_{\\mathrm{eff}}(k_{T,1}, \\dots, k_{T,N}) = \\sum_{i=1}^{N} w_i D_i \\left( 1 + k_{T,i} \\Delta \\ln T \\right)\n    $$\n    Here, $w_i$ are weights, $D_i$ are the mixture-averaged diffusion coefficients, and $k_{T,i}$ are the thermal diffusion ratios that we will be analyzing. For physical consistency, we must have $D_{\\mathrm{eff}} > 0$.\n\n3.  **Flame Speed**: The flame speed $S$ is then calculated using a classic result from leading-edge flame theory, which relates the speed to the balance between diffusion and reaction:\n    $$\n    S = 2 \\sqrt{D_{\\mathrm{eff}} r_{\\mathrm{eff}}}\n    $$\n    where $r_{\\mathrm{eff}}$ is an effective reaction rate. Combining these steps, the flame speed $S$ is a function of the vector of thermal diffusion ratios, $\\mathbf{k_T} = (k_{T,1}, \\dots, k_{T,N})$, and other fixed parameters.\n\nTo compute the sensitivity $\\partial S / \\partial k_{T,i}$, we will use the symmetric finite-difference formula provided in the problem statement. This is a numerical approximation of the partial derivative:\n$$\n\\frac{\\partial S}{\\partial k_{T,i}} \\approx \\frac{S(\\mathbf{k_T} + \\varepsilon \\mathbf{e}_i) - S(\\mathbf{k_T} - \\varepsilon \\mathbf{e}_i)}{2\\varepsilon}\n$$\nHere, $\\mathbf{e}_i$ is the standard basis vector with a $1$ in the $i$-th position and zeros elsewhere. $S(\\mathbf{k_T} + \\varepsilon \\mathbf{e}_i)$ represents the flame speed computed with the $i$-th thermal diffusion ratio perturbed to $k_{T,i} + \\varepsilon$, and $S(\\mathbf{k_T} - \\varepsilon \\mathbf{e}_i)$ is the speed with $k_{T,i}$ perturbed to $k_{T,i} - \\varepsilon$. The perturbation value is specified as $\\varepsilon = 10^{-6}$, which is small enough to approximate the local derivative accurately while being large enough to avoid catastrophic cancellation (round-off errors) in floating-point arithmetic.\n\nThe overall algorithm to solve the problem is as follows:\n1.  For each of the four test cases provided:\n    a. Extract the parameters: number of species $N$, diffusion coefficients $D_i$, weights $w_i$, baseline thermal diffusion ratios $k_{T,i}$, temperatures $T_u$ and $T_b$, and the effective reaction rate $r_{\\mathrm{eff}}$.\n    b. Define a function that computes the flame speed $S$ for a given vector of thermal diffusion ratios $\\mathbf{k_T}$ and the fixed parameters of the current test case, following the three-step model described above.\n    c. For each species $i$ from $1$ to $N$:\n        i. Create the forward-perturbed vector of thermal diffusion ratios, $\\mathbf{k_T}^{+}$, where the $i$-th element is $k_{T,i} + \\varepsilon$.\n        ii. Create the backward-perturbed vector, $\\mathbf{k_T}^{-}$, where the $i$-th element is $k_{T,i} - \\varepsilon$.\n        iii. Calculate the corresponding flame speeds, $S_{\\text{plus}} = S(\\mathbf{k_T}^{+})$ and $S_{\\text{minus}} = S(\\mathbf{k_T}^{-})$, using the function from step 1b.\n        iv. Compute the sensitivity for species $i$ in the current test case $j$ as $s_{j,i} = (S_{\\text{plus}} - S_{\\text{minus}}) / (2\\varepsilon)$.\n        v. Store this value.\n2.  After computing the sensitivities for all species across all test cases, compile the results into a single flattened list in test-case-major, species-minor order.\n3.  Format and print the final list as specified.\nThis procedure will be implemented for each test case to generate the required output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the local sensitivity of flame speed with respect to thermal\n    diffusion ratios for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            # Test Case 1 (general case)\n            \"D\": np.array([1.0e-4, 7.0e-5, 5.0e-5]),\n            \"w\": np.array([0.5, 0.3, 0.2]),\n            \"k_T\": np.array([0.35, 0.05, -0.02]),\n            \"T_u\": 300.0,\n            \"T_b\": 2100.0,\n            \"r_eff\": 500.0,\n        },\n        {\n            # Test Case 2 (boundary case with zero thermal diffusion ratios)\n            \"D\": np.array([1.0e-4, 7.0e-5, 5.0e-5]),\n            \"w\": np.array([0.5, 0.3, 0.2]),\n            \"k_T\": np.array([0.0, 0.0, 0.0]),\n            \"T_u\": 300.0,\n            \"T_b\": 2100.0,\n            \"r_eff\": 500.0,\n        },\n        {\n            # Test Case 3 (edge case with small temperature jump)\n            \"D\": np.array([1.0e-4, 7.0e-5, 5.0e-5]),\n            \"w\": np.array([0.5, 0.3, 0.2]),\n            \"k_T\": np.array([0.35, 0.05, -0.02]),\n            \"T_u\": 300.0,\n            \"T_b\": 330.0,\n            \"r_eff\": 500.0,\n        },\n        {\n            # Test Case 4 (edge case with negative dominant ratio and altered params)\n            \"D\": np.array([1.0e-4, 7.0e-5, 5.0e-5]),\n            \"w\": np.array([0.6, 0.25, 0.15]),\n            \"k_T\": np.array([-0.40, 0.10, 0.05]),\n            \"T_u\": 290.0,\n            \"T_b\": 2200.0,\n            \"r_eff\": 100.0,\n        },\n    ]\n\n    all_sensitivities = []\n    epsilon = 1e-6\n\n    def compute_s(k_T_vec, params):\n        \"\"\"\n        Computes the flame speed S based on the provided model.\n        \n        Args:\n            k_T_vec (np.ndarray): Vector of thermal diffusion ratios [k_T1, k_T2, ...].\n            params (dict): Dictionary containing the fixed parameters for the case.\n            \n        Returns:\n            float: The computed flame speed S.\n        \"\"\"\n        delta_ln_T = np.log(params[\"T_b\"] / params[\"T_u\"])\n        \n        # Calculate effective diffusion coefficient D_eff\n        d_eff_terms = params[\"w\"] * params[\"D\"] * (1.0 + k_T_vec * delta_ln_T)\n        d_eff = np.sum(d_eff_terms)\n        \n        if d_eff = 0:\n            # This case should not be reached with the given test data,\n            # but it is a necessary check for physical consistency.\n            raise ValueError(\"Effective diffusion coefficient must be positive.\")\n            \n        # Calculate flame speed S\n        s = 2.0 * np.sqrt(d_eff * params[\"r_eff\"])\n        \n        return s\n\n    for case in test_cases:\n        num_species = len(case[\"D\"])\n        base_k_T = case[\"k_T\"]\n        \n        for i in range(num_species):\n            # Perturb k_T for species i (forward step)\n            k_T_plus = base_k_T.copy()\n            k_T_plus[i] += epsilon\n            s_plus = compute_s(k_T_plus, case)\n            \n            # Perturb k_T for species i (backward step)\n            k_T_minus = base_k_T.copy()\n            k_T_minus[i] -= epsilon\n            s_minus = compute_s(k_T_minus, case)\n            \n            # Compute sensitivity using symmetric finite difference\n            sensitivity = (s_plus - s_minus) / (2.0 * epsilon)\n            all_sensitivities.append(sensitivity)\n\n    # Format the output as a comma-separated list in brackets\n    # Note: Using a general formatter to avoid floating point representation issues\n    # and ensure consistent output.\n    formatted_results = [f\"{val:.10f}\".rstrip('0').rstrip('.') for val in all_sensitivities]\n    \n    # The problem asks for a plain string representation of floats.\n    # The default `str()` representation is sufficient.\n    print(f\"[{','.join(map(str, all_sensitivities))}]\")\n\nsolve()\n```"
        }
    ]
}