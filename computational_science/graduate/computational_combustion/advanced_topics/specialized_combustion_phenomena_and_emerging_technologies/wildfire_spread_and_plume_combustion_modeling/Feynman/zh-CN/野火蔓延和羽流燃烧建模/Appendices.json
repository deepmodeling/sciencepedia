{
    "hands_on_practices": [
        {
            "introduction": "在野火科学中，拜拉姆（Byram）火线强度（$I$）是量化火灾行为和影响的核心指标。此练习将从能量守恒的基本原理出发，推导火线强度的表达式，它综合了燃料特性（$H$）、燃料载量（$W$）和蔓延速率（$R$）这三个关键因素。通过计算总能量释放率并将其分解为辐射和对流部分，本练习旨在加深对驱动野火蔓延的能量释放过程的理解，这对于任何野火蔓延模型的参数化和验证都是至关重要的一步。",
            "id": "4077321",
            "problem": "一个平面的、准稳态的野火火锋在一个均匀的燃料床中推进。设燃烧热（低热值）为 $H=16\\ \\mathrm{MJ/kg}$，单位地面面积消耗的燃料质量为 $W=0.5\\ \\mathrm{kg/m^2}$，蔓延速率（ROS）为 $R=0.4\\ \\mathrm{m/s}$。将火线强度 $I$ 定义为火线单位长度释放到火焰和羽流中的热量速率。从能量守恒以及单位质量燃烧热和移动火锋的单位面积消耗率的定义出发，推导 $I$ 关于 $H$、$W$ 和 $R$ 的表达式。然后，假设释放的热量中辐射分数 $f_{\\mathrm{rad}}=0.3$ 以热辐射形式离开火焰（其余部分以显热和潜热形式在对流羽流中平流），将 $I$ 分解为辐射分量 $I_{\\mathrm{rad}}$ 和对流分量 $I_{\\mathrm{conv}}$。以 $\\mathrm{kW/m}$ 为单位表示 $I$、$I_{\\mathrm{rad}}$ 和 $I_{\\mathrm{conv}}$，并将最终数值结果四舍五入至四位有效数字。按 $\\left(I,\\ I_{\\mathrm{rad}},\\ I_{\\mathrm{conv}}\\right)$ 的顺序列出这三个量。",
            "solution": "该问题被验证为具有科学依据、提法恰当、客观，并符合可解科学问题的所有标准。燃烧热、燃料载量、蔓延速率和火线强度的概念是林火科学的基础，给定的数值在物理上是现实的。该问题是自洽的，没有矛盾。\n\n第一步是从基本原理推导火线强度 $I$ 的表达式。火线强度定义为火线单位长度的热释放速率。让我们考虑一段长度为 $\\Delta L$ 的火线。火锋以蔓延速率 $R$ 推进。\n\n在时间间隔 $\\Delta t$ 内，火锋扫过的距离为 $\\Delta x = R \\Delta t$。\n在此时间间隔内消耗的燃料床面积是火线段长度与火锋推进距离的乘积：\n$$ \\Delta A = \\Delta L \\cdot \\Delta x = \\Delta L \\cdot (R \\Delta t) $$\n单位地面面积消耗的燃料质量给定为 $W$。因此，在面积 $\\Delta A$ 内消耗的总燃料质量为：\n$$ \\Delta m = W \\cdot \\Delta A = W \\cdot (\\Delta L R \\Delta t) $$\n燃烧热 $H$ 是单位质量燃料消耗释放的能量。消耗质量 $\\Delta m$ 所释放的总热能 $\\Delta Q$ 为：\n$$ \\Delta Q = H \\cdot \\Delta m = H \\cdot (W \\Delta L R \\Delta t) $$\n热释放速率 $\\dot{Q}$ 是单位时间释放的热量：\n$$ \\dot{Q} = \\frac{\\Delta Q}{\\Delta t} = \\frac{H W \\Delta L R \\Delta t}{\\Delta t} = H W R \\Delta L $$\n根据定义，火线强度 $I$ 是火线单位长度的热释放速率。因此，我们将总热释放速率 $\\dot{Q}$ 除以火线段的长度 $\\Delta L$：\n$$ I = \\frac{\\dot{Q}}{\\Delta L} = \\frac{H W R \\Delta L}{\\Delta L} = HWR $$\n这就得到了火线强度的推导表达式，也称为 Byram 火线强度。\n\n接下来，我们使用给定的数据计算 $I$ 的数值：\n燃烧热, $H = 16\\ \\mathrm{MJ/kg} = 16 \\times 10^6\\ \\mathrm{J/kg}$。\n单位面积燃料质量, $W = 0.5\\ \\mathrm{kg/m^2}$。\n蔓延速率, $R = 0.4\\ \\mathrm{m/s}$。\n\n将这些值代入 $I$ 的表达式中：\n$$ I = (16 \\times 10^6\\ \\mathrm{J/kg}) \\cdot (0.5\\ \\mathrm{kg/m^2}) \\cdot (0.4\\ \\mathrm{m/s}) $$\n$$ I = (16 \\cdot 0.5 \\cdot 0.4) \\times 10^6\\ \\mathrm{J/(s \\cdot m)} $$\n$$ I = 3.2 \\times 10^6\\ \\mathrm{W/m} $$\n问题要求结果以千瓦每米（$\\mathrm{kW/m}$）为单位。因为 $1\\ \\mathrm{kW} = 1000\\ \\mathrm{W} = 10^3\\ \\mathrm{W}$：\n$$ I = \\frac{3.2 \\times 10^6\\ \\mathrm{W/m}}{10^3\\ \\mathrm{W/kW}} = 3.2 \\times 10^3\\ \\mathrm{kW/m} = 3200\\ \\mathrm{kW/m} $$\n按要求四舍五入到四位有效数字，$I = 3200.\\ \\mathrm{kW/m}$。\n\n总强度 $I$ 被分解为辐射分量 $I_{\\mathrm{rad}}$ 和对流分量 $I_{\\mathrm{conv}}$。给定的辐射分数为 $f_{\\mathrm{rad}} = 0.3$。\n辐射分量为：\n$$ I_{\\mathrm{rad}} = f_{\\mathrm{rad}} \\cdot I $$\n$$ I_{\\mathrm{rad}} = 0.3 \\cdot (3200\\ \\mathrm{kW/m}) = 960\\ \\mathrm{kW/m} $$\n四舍五入到四位有效数字，$I_{\\mathrm{rad}} = 960.0\\ \\mathrm{kW/m}$。\n\n对流分量是总强度的剩余部分：\n$$ I_{\\mathrm{conv}} = I - I_{\\mathrm{rad}} = I \\cdot (1 - f_{\\mathrm{rad}}) $$\n$$ I_{\\mathrm{conv}} = 3200\\ \\mathrm{kW/m} - 960.0\\ \\mathrm{kW/m} = 2240\\ \\mathrm{kW/m} $$\n或者，使用分数计算：\n$$ I_{\\mathrm{conv}} = (1 - 0.3) \\cdot (3200\\ \\mathrm{kW/m}) = 0.7 \\cdot (3200\\ \\mathrm{kW/m}) = 2240\\ \\mathrm{kW/m} $$\n这个值 $2240$ 已经有四位有效数字，如果末尾的零被视为有效数字，这一点由计算过程所暗示。为明确起见，我们写作 $2240.\\ \\mathrm{kW/m}$。\n\n按要求四舍五入到四位有效数字的最终值为：\n$I_1 = I = 3200\\ \\mathrm{kW/m}$\n$I_2 = I_{\\mathrm{rad}} = 960.0\\ \\mathrm{kW/m}$\n$I_3 = I_{\\mathrm{conv}} = 2240\\ \\mathrm{kW/m}$\n\n根据最终答案框的格式化规则，最终答案应以科学记数法提供。\n$I = 3200 = 3.200 \\times 10^3$\n$I_{\\mathrm{rad}} = 960.0 = 9.600 \\times 10^2$\n$I_{\\mathrm{conv}} = 2240 = 2.240 \\times 10^3$\n这些量按 ($I, I_{\\mathrm{rad}}, I_{\\mathrm{conv}}$) 的顺序列出。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 3.200 \\times 10^3  9.600 \\times 10^2  2.240 \\times 10^3 \\end{pmatrix} } $$"
        },
        {
            "introduction": "从物理原理转向计算建模，我们需要掌握确保数值模拟稳定性的基本准则。此练习探讨了显式平流方程离散化的核心——库朗-弗里德里希斯-路维（Courant-Friedrichs-Lewy, CFL）条件，它是在计算流体动力学中模拟烟雾和热量输运的基础。通过分析物理依赖域和数值依赖域之间的关系，你将推导出控制时间步长（$\\Delta t$）、网格尺寸（$\\Delta x$）和最大速度（$u_{\\max}$）之间关系的不等式。掌握CFL条件对于任何计算科学家而言都是一项必不可少的实践技能，以防止模拟结果出现非物理发散，确保模型的鲁棒性和可靠性。",
            "id": "4077298",
            "problem": "在一次野火烟羽在大气表面层中传输的计算燃烧模拟中，一个被动标量（例如，烟雾混合分数）的顺风传输由一维线性平流方程建模\n$$\n\\frac{\\partial \\phi}{\\partial t} + u(x,t)\\,\\frac{\\partial \\phi}{\\partial x} = 0,\n$$\n其中 $\\phi(x,t)$ 是一个被传输的标量，$u(x,t)$ 是解析的水平风速。空间离散化采用间距为 $\\Delta x$ 的均匀网格，时间推进采用时间步长为 $\\Delta t$ 的显式一阶迎风有限体积法。假设在整个区域内风向与 $x$ 轴正方向一致，并且必须保证在最坏情况下的解析速度 $u_{\\max}$ 下的稳定性。\n\n从双曲守恒律的数值依赖域必须包含物理依赖域的原理出发，推导对此显式迎风格式约束 $\\Delta t$ 的稳定性要求（用 $\\Delta x$ 和 $u_{\\max}$ 表示）。然后，使用 $u_{\\max} = 12\\ \\mathrm{m/s}$、$\\Delta x = 20\\ \\mathrm{m}$ 和一个建议步长 $\\Delta t = 1\\ \\mathrm{s}$，判断建议的 $\\Delta t$ 是否满足稳定性要求，并计算为保证稳定性所允许的最大 $\\Delta t$。\n\n最终答案仅报告所允许的最大 $\\Delta t$。将答案四舍五入到三位有效数字，并以秒为单位表示。",
            "solution": "该问题要求基于依赖域原理，推导应用于一维线性平流方程的一阶迎风格式的稳定性条件。随后，必须使用此条件来评估一个建议的时间步长，并为给定的一组参数计算允许的最大时间步长。\n\n被动标量 $\\phi(x,t)$ 传输的控制偏微分方程 (PDE) 是线性平流方程：\n$$\n\\frac{\\partial \\phi}{\\partial t} + u(x,t)\\,\\frac{\\partial \\phi}{\\partial x} = 0\n$$\n这是一个双曲型偏微分方程，信息沿着由 $\\frac{dx}{dt} = u(x,t)$ 定义的特征线传播。\n\n问题指定了在间距为 $\\Delta x$ 的均匀网格上和时间步长为 $\\Delta t$ 的显式一阶迎风有限体积法。设 $\\phi_i^n$ 表示在时间层 $n$ 时第 $i$ 个网格单元中标量的值。$\\phi_i^{n+1}$ 的更新格式由守恒律的积分形式推导而来。对于速度 $u$ 为正（沿 $x$ 轴正方向）的一阶迎风离散化，单元交界面上的值取自“迎风”单元，即左侧的单元。半离散形式为：\n$$\n\\frac{d\\phi_i}{dt} + \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x} = 0\n$$\n其中 $F$ 是通量，$F = u\\phi$。通过迎风近似，单元交界面上的通量为 $F_{i-1/2} = u_{i-1/2} \\phi_{i-1}$ 和 $F_{i+1/2} = u_{i+1/2} \\phi_{i}$。使用显式欧拉时间积分，并假设在推导过程中 $u$ 是常数，完全离散化的方程变为：\n$$\n\\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} + u \\frac{\\phi_i^n - \\phi_{i-1}^n}{\\Delta x} = 0\n$$\n这个方程可以重排，用来表示新时间步 $\\phi_i^{n+1}$ 的解（用前一个时间步 $n$ 的值表示）：\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{u \\Delta t}{\\Delta x} (\\phi_i^n - \\phi_{i-1}^n)\n$$\n$$\n\\phi_i^{n+1} = \\left(1 - \\frac{u \\Delta t}{\\Delta x}\\right) \\phi_i^n + \\left(\\frac{u \\Delta t}{\\Delta x}\\right) \\phi_{i-1}^n\n$$\n这种显式格式的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定，该条件可以从数值依赖域必须包含物理依赖域的原理推导出来。\n\n1.  **数值依赖域**：离散方程表明，网格点 $x_i$ 和时间 $t_{n+1}$ 处的值 $\\phi_i^{n+1}$ 是由前一个时间步 $t_n$ 时网格点 $x_i$ 和 $x_{i-1}$ 的值决定的。因此，点 $(x_i, t_{n+1})$ 的数值依赖域是在时间 $t_n$ 时的空间区间 $[x_{i-1}, x_i]$。\n\n2.  **物理依赖域**：穿过点 $(x_i, t_{n+1})$ 的物理特征线是信息传播的路径。其轨迹由 $\\frac{dx}{dt} = u$ 给出。从 $(x_i, t_{n+1})$ 开始，沿时间向后积分一个时间步 $\\Delta t$ 以找到出发点 $(x_p, t_n)$，可得：\n    $$\n    \\int_{x_p}^{x_i} dx' = \\int_{t_n}^{t_{n+1}} u(t') dt'\n    $$\n    假设在一个时间步内 $u$ 是常数，则 $x_i - x_p = u(t_{n+1} - t_n) = u \\Delta t$。出发点是 $x_p = x_i - u \\Delta t$。点 $(x_i, t_{n+1})$ 的物理依赖域是在时间 $t_n$ 时的单个点 $x_p$。\n\n3.  **应用原理**：为了得到稳定且一致的数值解，数值格式必须能够获取计算更新所需的物理信息。这意味着物理依赖域必须位于数值依赖域之内。数学上表示为：\n    $$\n    x_p \\in [x_{i-1}, x_i]\n    $$\n    代入 $x_p = x_i - u \\Delta t$ 和 $x_{i-1} = x_i - \\Delta x$，我们得到：\n    $$\n    x_i - \\Delta x \\le x_i - u \\Delta t \\le x_i\n    $$\n    这个表达式意味着两个条件：\n    a) $x_i - u \\Delta t \\le x_i \\implies -u \\Delta t \\le 0 \\implies u \\Delta t \\ge 0$。因为 $u>0$ 且 $\\Delta t>0$，这个条件总是满足的。\n    b) $x_i - \\Delta x \\le x_i - u \\Delta t \\implies -\\Delta x \\le -u \\Delta t$。两边乘以 $-1$ 会反转不等号：$\\Delta x \\ge u \\Delta t$。\n\n因此，稳定性条件是 $u \\Delta t \\le \\Delta x$，可以写成 Courant 数 $C = \\frac{u \\Delta t}{\\Delta x}$ 的形式：\n$$\nC \\le 1\n$$\n对于可变速度场 $u(x,t)$，显式格式的稳定性必须在域内任何地方的最坏情况（最快）速度 $u_{\\max}$ 下得到保证。因此，最终的稳定性要求是：\n$$\n\\frac{u_{\\max} \\Delta t}{\\Delta x} \\le 1\n$$\n现在，我们将此要求应用于给定的参数：$u_{\\max} = 12\\ \\mathrm{m/s}$，$\\Delta x = 20\\ \\mathrm{m}$，以及建议的 $\\Delta t_{prop} = 1\\ \\mathrm{s}$。\n首先，我们通过计算其对应的 Courant 数来检查建议的时间步长是否稳定：\n$$\nC_{prop} = \\frac{u_{\\max} \\Delta t_{prop}}{\\Delta x} = \\frac{(12\\ \\mathrm{m/s}) (1\\ \\mathrm{s})}{20\\ \\mathrm{m}} = \\frac{12}{20} = 0.6\n$$\n由于 $C_{prop} = 0.6 \\le 1$，建议的时间步长 $\\Delta t = 1\\ \\mathrm{s}$ 满足稳定性要求。\n\n最后，我们计算允许的最大时间步长 $\\Delta t_{\\max}$，它对应于稳定性的极限，即 $C=1$：\n$$\n\\frac{u_{\\max} \\Delta t_{\\max}}{\\Delta x} = 1\n$$\n求解 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{u_{\\max}} = \\frac{20\\ \\mathrm{m}}{12\\ \\mathrm{m/s}} = \\frac{20}{12}\\ \\mathrm{s} = \\frac{5}{3}\\ \\mathrm{s}\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\n\\Delta t_{\\max} \\approx 1.6666... \\ \\mathrm{s}\n$$\n四舍五入到三位有效数字，得到：\n$$\n\\Delta t_{\\max} \\approx 1.67\\ \\mathrm{s}\n$$\n这是在保证数值格式稳定性的前提下可以使用的最大时间步长。",
            "answer": "$$\\boxed{1.67}$$"
        },
        {
            "introduction": "耦合火灾-大气模型是现代野火预报的前沿，而准确地模拟地表向大气的能量输送是其关键挑战之一。本练习将能量守恒定律应用于一个离散的大气网格单元，以研究地表热通量如何转化为近地表空气的温度变化。通过推导温度倾向方程并分析其对垂直和水平网格分辨率的敏感性，你将亲身体验计算建模中的一个核心问题：网格依赖性。这项实践不仅揭示了模型离散化选择如何显著影响模拟结果，还教会我们如何定量评估这种影响，这对于在计算成本和模型精度之间做出明智权衡至关重要。",
            "id": "4077316",
            "problem": "您正在使用一个代表大气网格单元的控制体积中的能量守恒来模拟野火引起的近地面大气加热。一个均匀的表面热通量 $\\dot{q}_s$（单位 $\\mathrm{W/m^2}$）从地表映射到水平面积为 $A$（单位 $\\mathrm{m^2}$）、垂直厚度为 $\\Delta z$（单位 $\\mathrm{m}$）的矩形单元底部。假设干燥空气的密度 $\\rho$（单位 $\\mathrm{kg/m^3}$）和定压比热容 $c_p$（单位 $\\mathrm{J/(kg\\cdot K)}$）恒定，并忽略单元内的平流、扩散、相变和辐射，因此温度变化仅由施加的表面热量增加引起。\n\n从控制体积的能量守恒和标准热力学定义出发，推导温度倾向 $\\partial T / \\partial t$（单位 $\\mathrm{K/s}$）如何依赖于 $\\dot{q}_s$、$A$、$\\Delta z$、$\\rho$ 和 $c_p$。然后，实现推导出的关系式，为一组测试用例计算温度倾向，并评估其对网格分辨率的敏感性。\n\n使用以下常数，这些常数在所有测试用例中均保持不变：\n- 表面热通量 $\\dot{q}_s = 200{,}000\\ \\mathrm{W/m^2}$（等效于 $200\\ \\mathrm{kW/m^2}$）。\n- 空气密度 $\\rho = 1.2\\ \\mathrm{kg/m^3}$。\n- 定压比热容 $c_p = 1005\\ \\mathrm{J/(kg\\cdot K)}$。\n\n定义当空气被加热时，温度倾向 $\\partial T / \\partial t$ 为正。\n\n对于敏感性，使用对数-对数斜率来量化网格分辨率效应：\n- 垂直分辨率敏感性指数 $n_{\\Delta z}$ 定义为，在 $A$ 相同但 $\\Delta z$ 变化的案例子集中，$\\ln\\!\\left(\\partial T / \\partial t\\right)$ 相对于 $\\ln\\!\\left(\\Delta z\\right)$ 的最佳拟合斜率。\n- 水平分辨率敏感性指数 $n_{A}$ 定义为，在 $\\Delta z$ 相同但 $A$ 变化的案例子集中，$\\ln\\!\\left(\\partial T / \\partial t\\right)$ 相对于 $\\ln\\!\\left(A\\right)$ 的最佳拟合斜率。\n\n所有温度倾向以 $\\mathrm{K/s}$ 表示，敏感性指数为无量纲量。\n\n测试套件（每个项目是一个由 $(A,\\Delta z)$ 指定的案例）：\n- 案例 1：$A = 400\\ \\mathrm{m^2}$，$\\Delta z = 10\\ \\mathrm{m}$。\n- 案例 2：$A = 400\\ \\mathrm{m^2}$，$\\Delta z = 50\\ \\mathrm{m}$。\n- 案例 3：$A = 400\\ \\mathrm{m^2}$，$\\Delta z = 100\\ \\mathrm{m}$。\n- 案例 4：$A = 160{,}000\\ \\mathrm{m^2}$，$\\Delta z = 10\\ \\mathrm{m}$。\n- 案例 5（边缘案例：非常浅的单元）：$A = 400\\ \\mathrm{m^2}$，$\\Delta z = 1\\ \\mathrm{m}$。\n- 案例 6（边缘案例：非常深的单元）：$A = 400\\ \\mathrm{m^2}$，$\\Delta z = 500\\ \\mathrm{m}$。\n\n您的程序应：\n- 根据所述假设，从第一性原理推导计算给定 $(\\dot{q}_s, A, \\Delta z, \\rho, c_p)$ 时 $\\partial T / \\partial t$ 所需的表达式，然后直接实现它。\n- 计算每个测试用例的温度倾向。\n- 使用案例 1、2、3、5 和 6（所有案例中 $A = 400\\ \\mathrm{m^2}$）计算 $n_{\\Delta z}$。\n- 使用案例 1 和 4（两个案例中 $\\Delta z = 10\\ \\mathrm{m}$）计算 $n_A$。\n\n最终输出格式：\n- 您的程序应生成一个单行，其中包含一个用方括号括起来的逗号分隔列表。\n- 前六个条目必须是案例 1 到 6 的温度倾向（单位 $\\mathrm{K/s}$），按顺序排列。\n- 第七个条目必须是 $n_{\\Delta z}$（无量纲）。\n- 第八个条目必须是 $n_A$（无量纲）。\n例如，输出必须类似于 $[\\text{case1},\\text{case2},\\text{case3},\\text{case4},\\text{case5},\\text{case6},\\text{n\\_dz},\\text{n\\_A}]$，其中每个占位符都是一个浮点数。",
            "solution": "该问题要求推导一个从下方加热的概念性大气网格单元内的温度倾向 $\\frac{\\partial T}{\\partial t}$，并随后进行数值计算。推导将基于热力学第一定律。\n\n控制温度变化的基本原理是能量守恒。对于一个热力学系统，第一定律将内能的变化与增加的热量和所做的功联系起来。然而，对于涉及流体流动和近似恒定压力的气体的过程，使用焓 $H$ 更为方便。问题指定了定压比热 $c_p$，这强烈表明适当的物理模型是等压（恒压）加热模型。在此模型中，我们考虑固定质量的空气被加热，并假设其可以膨胀或收缩以与周围环境保持压力平衡。假设其他能量传递机制可以忽略，控制体积中空气质量的焓变率等于净热量增加率。\n\n因此，能量平衡方程为：\n$$ \\frac{dH}{dt} = \\dot{Q}_{\\text{net}} $$\n其中 $H$ 是体积内空气的总焓，$\\dot{Q}_{\\text{net}}$ 是进入该体积的净热传递率。\n\n让我们根据所提供的参数来定义每一项。\n\n控制体积是一个水平面积为 $A$、垂直厚度为 $\\Delta z$ 的矩形单元。单元的体积为 $V = A \\Delta z$。\n该体积内所含干燥空气的质量 $m$ 由其恒定密度 $\\rho$ 和体积 $V$ 的乘积给出：\n$$ m = \\rho V = \\rho A \\Delta z $$\n\n这部分空气的总焓 $H$ 与其温度 $T$ 和定压比热容 $c_p$ 的关系为 $H = m c_p T$。焓变率则为：\n$$ \\frac{dH}{dt} = \\frac{d}{dt}(m c_p T) $$\n由于质量 $m$ 和比热容 $c_p$ 是常数，我们有：\n$$ \\frac{dH}{dt} = m c_p \\frac{dT}{dt} $$\n代入质量 $m$ 的表达式：\n$$ \\frac{dH}{dt} = (\\rho A \\Delta z) c_p \\frac{dT}{dt} $$\n我们使用偏导数符号 $\\frac{\\partial T}{\\partial t}$ 来表示体积内固定点温度的局部时间变化率，这是场方程中的标准做法。\n\n净热量增加率 $\\dot{Q}_{\\text{net}}$ 仅来自指定的表面热通量 $\\dot{q}_s$，其单位为单位面积的功率（$\\mathrm{W/m^2}$）。该通量施加在单元的整个底面上，其面积为 $A$。因此，输入到单元的总功率为：\n$$ \\dot{Q}_{\\text{net}} = \\dot{q}_s A $$\n\n现在，我们将焓变率与净热量增加率相等：\n$$ (\\rho A \\Delta z) c_p \\frac{\\partial T}{\\partial t} = \\dot{q}_s A $$\n\n为了求出温度倾向 $\\frac{\\partial T}{\\partial t}$ 的表达式，我们求解这一项。我们可以将两边同时除以 $(\\rho A \\Delta z) c_p$：\n$$ \\frac{\\partial T}{\\partial t} = \\frac{\\dot{q}_s A}{\\rho c_p A \\Delta z} $$\n水平面积 $A$ 同时出现在分子（因为它决定了总热量输入）和分母（因为它决定了被加热的总质量）中，因此可以消掉。这是一个关键的见解：对于均匀的表面通量，加热速率与网格单元的水平面积无关。最终推导出的关系式为：\n$$ \\frac{\\partial T}{\\partial t} = \\frac{\\dot{q}_s}{\\rho c_p \\Delta z} $$\n这个方程在物理上是直观的：温度升高率与热通量 $\\dot{q}_s$ 成正比，与空气密度 $\\rho$、比热容 $c_p$ 以及热量分布所及的大气层厚度 $\\Delta z$ 成反比。\n\n敏感性分析需要从对数-对数图的最佳拟合斜率计算指数 $n_{\\Delta z}$ 和 $n_A$。如果变量 $y$ 对 $x$ 具有 $y = C x^n$ 形式的幂律依赖关系，两边取自然对数可得 $\\ln(y) = \\ln(C) + n \\ln(x)$。这是 $\\ln(y)$ 相对于 $\\ln(x)$ 的图中的一条直线方程，其斜率即为指数 $n$。\n\n对于垂直分辨率敏感性，我们将 $\\frac{\\partial T}{\\partial t}$ 分析为 $\\Delta z$ 的函数。我们推导出的方程可以写成 $\\frac{\\partial T}{\\partial t} = \\left(\\frac{\\dot{q}_s}{\\rho c_p}\\right) (\\Delta z)^{-1}$。这是一个指数恰好为 $-1$ 的幂律。因此，我们预期敏感性指数为 $n_{\\Delta z} = -1$。\n\n对于水平分辨率敏感性，我们将 $\\frac{\\partial T}{\\partial t}$ 分析为 $A$ 的函数。我们推导出的方程显示出与 $A$ 无关。这可以表示为 $\\frac{\\partial T}{\\partial t} \\propto A^0$ 形式的幂律。因此，我们预期敏感性指数为 $n_A = 0$。\n\n该实现将使用推导出的公式和常数 $\\dot{q}_s = 200000\\ \\mathrm{W/m^2}$、$\\rho = 1.2\\ \\mathrm{kg/m^3}$ 以及 $c_p = 1005\\ \\mathrm{J/(kg\\cdot K)}$，为每个测试用例计算 $\\frac{\\partial T}{\\partial t}$。然后，它将对结果的对数与相应几何参数的对数进行线性回归，以找到指数 $n_{\\Delta z}$ 和 $n_A$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy is not required for this solution.\n\ndef solve():\n    \"\"\"\n    Computes atmospheric temperature tendency from surface heating and\n    analyzes its sensitivity to grid resolution.\n    \"\"\"\n    # Define constants given in the problem statement.\n    q_s = 200000.0  # Surface heat flux in W/m^2\n    rho = 1.2       # Air density in kg/m^3\n    c_p = 1005.0    # Specific heat capacity at constant pressure in J/(kg*K)\n\n    # Define the test cases (A in m^2, delta_z in m).\n    test_cases = [\n        (400.0, 10.0),    # Case 1\n        (400.0, 50.0),    # Case 2\n        (400.0, 100.0),   # Case 3\n        (160000.0, 10.0), # Case 4\n        (400.0, 1.0),     # Case 5\n        (400.0, 500.0),   # Case 6\n    ]\n\n    tendencies = []\n    \n    # The derived relation for temperature tendency is:\n    # dT/dt = q_s / (rho * c_p * delta_z)\n    \n    for _, delta_z in test_cases:\n        # Note: Horizontal area 'A' cancels out and is not needed for tendency calculation.\n        dT_dt = q_s / (rho * c_p * delta_z)\n        tendencies.append(dT_dt)\n\n    # --- Sensitivity Analysis ---\n\n    # 1. Vertical-resolution sensitivity exponent (n_dz)\n    # Uses Cases 1, 2, 3, 5, 6, all of which have A = 400 m^2.\n    dz_indices = [0, 1, 2, 4, 5]  # Case indices: 1, 2, 3, 5, 6\n    dz_values = np.array([test_cases[i][1] for i in dz_indices])\n    tendencies_for_dz = np.array([tendencies[i] for i in dz_indices])\n    \n    # Perform linear regression on log-transformed data: log(dT/dt) vs log(delta_z)\n    log_dz = np.log(dz_values)\n    log_tendencies_dz = np.log(tendencies_for_dz)\n    \n    # np.polyfit(x, y, 1) returns [slope, intercept] for the best-fit line.\n    # The slope is the sensitivity exponent n_dz.\n    n_dz = np.polyfit(log_dz, log_tendencies_dz, 1)[0]\n\n    # 2. Horizontal-resolution sensitivity exponent (n_A)\n    # Uses Cases 1 and 4, both of which have delta_z = 10 m.\n    A_indices = [0, 3] # Case indices: 1, 4\n    A_values = np.array([test_cases[i][0] for i in A_indices])\n    tendencies_for_A = np.array([tendencies[i] for i in A_indices])\n    \n    # Perform linear regression on log-transformed data: log(dT/dt) vs log(A)\n    log_A = np.log(A_values)\n    log_tendencies_A = np.log(tendencies_for_A)\n\n    # The slope is the sensitivity exponent n_A.\n    # Because tendencies are identical, the slope will be 0.\n    # Using np.polyfit on data with no variance in y can lead to numerical instability\n    # or return NaN depending on the numpy version. Since we know from the physics\n    # and the calculated tendencies that the slope must be 0, we can set it directly.\n    if np.allclose(log_tendencies_A, log_tendencies_A[0]):\n        n_A = 0.0\n    else:\n        n_A = np.polyfit(log_A, log_tendencies_A, 1)[0]\n\n\n    # Combine all results for final output\n    final_results = tendencies + [n_dz, n_A]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in final_results)}]\")\n\n# Execute the solver.\nsolve()\n```"
        }
    ]
}