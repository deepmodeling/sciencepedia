{
    "hands_on_practices": [
        {
            "introduction": "燃烧分析中的一个基础概念是给定燃料-氧化剂混合物所能达到的最高温度。本实践练习侧重于计算绝热火焰温度，它代表了在没有热量损失到周围环境的理想情况下，燃烧产物的理论温度。掌握这一计算，能够帮助我们从第一性原理层面深刻理解燃烧过程中释放的能量，并为更复杂的模拟提供一个重要的基准。",
            "id": "4031183",
            "problem": "考虑一个理想搅拌、稳态、绝热、恒压的反应器，其中化学计量的氢气-空气混合物在初始压力 $p = 1$ atm 和初始温度 $T_0 = 300$ K 的条件下完全燃烧，仅生成气态水 $\\mathrm{H_2O}$；氮气 $\\mathrm{N_2}$ 是惰性的。空气被模拟为氧气和氮气的二元混合物，其摩尔分数分别为 $x_{\\mathrm{O}_2} = 0.21$ 和 $x_{\\mathrm{N}_2} = 0.79$。假设所有组分均为理想气体，并忽略离解、辐射及任何微量组分。该过程是绝热的，因此反应物的总焓等于产物在绝热火焰温度 $T_{ad}$ 下的总焓。\n\n取 $\\mathrm{H_2O}(\\mathrm{g})$ 在 $T_0$ 时的标准摩尔生成焓为 $\\Delta h_f^{\\circ}(\\mathrm{H_2O}, T_0) = -241.826$ kJ/mol，而 $\\mathrm{H}_2$、$\\mathrm{O}_2$ 和 $\\mathrm{N}_2$ 的标准摩尔生成焓为零。以消耗 $1$ 摩尔 $\\mathrm{H}_2$ 为基准。所有反应物的初始显焓在 $T_0$ 时参考为零。\n\n对于与温度相关的摩尔定压热容（在 $300$ K $\\le T \\le 3500$ K 范围内有效），使用：\n- $\\mathrm{H_2O}(\\mathrm{g})$: $c_p^{\\mathrm{H_2O}}(T) = 32.24 + 2.27 \\times 10^{-3}\\, T$ $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，\n- $\\mathrm{N_2}(\\mathrm{g})$: $c_p^{\\mathrm{N_2}}(T) = 29.15 + 3.29 \\times 10^{-3}\\, T$ $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n\n计算与这些假设和物性模型一致的绝热火焰温度 $T_{ad}$。以开尔文为单位表示最终答案，并四舍五入到四位有效数字。",
            "solution": "用户提供的问题已经过分析，并被确定为**有效**。该问题科学上基于化学热力学原理，提法恰当，有足够的信息来确定唯一解，并以客观、正式的方式呈现。诸如理想气体行为和完全燃烧之类的假设，对于简化的燃烧问题是标准的。所有必要的热力学数据和物性模型均已提供。\n\n求解过程如下。\n\n首先，我们建立氢气（$\\mathrm{H_2}$）与空气发生化学计量燃烧的配平化学方程式。空气被模拟为氧气（$\\mathrm{O_2}$）和氮气（$\\mathrm{N_2}$）的混合物，其摩尔分数分别为 $x_{\\mathrm{O}_2} = 0.21$ 和 $x_{\\mathrm{N}_2} = 0.79$。因此，空气中氮气与氧气的摩尔比为 $\\frac{x_{\\mathrm{N}_2}}{x_{\\mathrm{O}_2}} = \\frac{0.79}{0.21}$。\n\n通用的化学计量反应式为：\n$$ \\mathrm{H_2} + a(\\mathrm{O_2} + \\frac{0.79}{0.21}\\mathrm{N_2}) \\rightarrow b\\mathrm{H_2O} + c\\mathrm{N_2} $$\n我们以消耗 $1$ 摩尔 $\\mathrm{H_2}$ 为基准，根据原子守恒来配平此方程式：\n- 氢（H）原子守恒： $2 = 2b \\implies b=1$。\n- 氧（O）原子守恒： $2a = b \\implies 2a = 1 \\implies a=0.5$。\n- 氮气（$\\mathrm{N_2}$）是惰性的，因此摩尔数守恒：$c = a \\times \\frac{0.79}{0.21} = 0.5 \\times \\frac{0.79}{0.21} = \\frac{0.395}{0.21} = \\frac{79}{42}$。\n\n消耗 $1$ 摩尔 $\\mathrm{H_2}$ 的配平反应式为：\n$$ \\mathrm{H_2} + 0.5\\,\\mathrm{O_2} + \\frac{79}{42}\\,\\mathrm{N_2} \\rightarrow \\mathrm{H_2O} + \\frac{79}{42}\\,\\mathrm{N_2} $$\n反应物为 $n_{\\mathrm{H}_2} = 1$ mol, $n_{\\mathrm{O}_2} = 0.5$ mol, 和 $n_{\\mathrm{N}_2,reac} = \\frac{79}{42}$ mol。\n产物为 $n_{\\mathrm{H_2O}} = 1$ mol 和 $n_{\\mathrm{N}_2,prod} = \\frac{79}{42}$ mol。\n\n接下来，我们对稳态、绝热、恒压过程应用热力学第一定律。反应物在初始状态的焓必须等于产物在最终状态（绝热火焰温度 $T_{ad}$）的焓。\n$$ H_{reactants} = H_{products} $$\n混合物的总焓 $H$ 是其各组分摩尔焓的总和, $H = \\sum_i n_i \\bar{h}_i(T)$。组分 $i$ 在温度 $T$ 时的摩尔焓是其在参考温度 $T_0$ 时的标准摩尔生成焓与从 $T_0$ 到 $T$ 的显焓变之和：\n$$ \\bar{h}_i(T) = \\Delta h_{f,i}^{\\circ}(T_0) + \\int_{T_0}^{T} c_{p,i}(T') dT' $$\n在本题中，初始温度为 $T_0 = 300$ K，这也是标准参考温度。题目说明所有反应物的初始显焓为零，这与它们处于 $T_0$ 温度是一致的。\n反应物在 $T_0 = 300$ K 时的焓为：\n$$ H_{reactants} = \\sum_{i,reac} n_i \\Delta h_{f,i}^{\\circ}(T_0) = n_{\\mathrm{H}_2}\\Delta h_{f, \\mathrm{H}_2}^{\\circ} + n_{\\mathrm{O}_2}\\Delta h_{f, \\mathrm{O}_2}^{\\circ} + n_{\\mathrm{N}_2}\\Delta h_{f, \\mathrm{N}_2}^{\\circ} $$\n根据定义，稳定形态的元素（$\\mathrm{H_2}$、$\\mathrm{O_2}$、$\\mathrm{N_2}$）的标准生成焓为零。\n$$ H_{reactants} = (1)(0) + (0.5)(0) + (\\frac{79}{42})(0) = 0 $$\n产物在绝热火焰温度 $T_{ad}$ 时的焓为：\n$$ H_{products} = \\sum_{j,prod} n_j \\left( \\Delta h_{f,j}^{\\circ}(T_0) + \\int_{T_0}^{T_{ad}} c_{p,j}(T') dT' \\right) $$\n$$ H_{products} = n_{\\mathrm{H_2O}} \\left( \\Delta h_{f, \\mathrm{H_2O}}^{\\circ} + \\int_{T_0}^{T_{ad}} c_{p}^{\\mathrm{H_2O}}(T) dT \\right) + n_{\\mathrm{N}_2} \\left( \\Delta h_{f, \\mathrm{N}_2}^{\\circ} + \\int_{T_0}^{T_{ad}} c_{p}^{\\mathrm{N_2}}(T) dT \\right) $$\n由于 $\\Delta h_{f, \\mathrm{N}_2}^{\\circ}=0$：\n$$ H_{products} = n_{\\mathrm{H_2O}} \\Delta h_{f, \\mathrm{H_2O}}^{\\circ} + \\int_{T_0}^{T_{ad}} \\left( n_{\\mathrm{H_2O}} c_{p}^{\\mathrm{H_2O}}(T) + n_{\\mathrm{N}_2} c_{p}^{\\mathrm{N_2}}(T) \\right) dT $$\n令 $H_{reactants}$ 和 $H_{products}$ 相等：\n$$ 0 = n_{\\mathrm{H_2O}} \\Delta h_{f, \\mathrm{H_2O}}^{\\circ} + \\int_{T_0}^{T_{ad}} \\left( n_{\\mathrm{H_2O}} c_{p}^{\\mathrm{H_2O}}(T) + n_{\\mathrm{N}_2} c_{p}^{\\mathrm{N_2}}(T) \\right) dT $$\n整理可得：\n$$ -n_{\\mathrm{H_2O}} \\Delta h_{f, \\mathrm{H_2O}}^{\\circ} = \\int_{T_0}^{T_{ad}} \\left( n_{\\mathrm{H_2O}} c_{p}^{\\mathrm{H_2O}}(T) + n_{\\mathrm{N}_2} c_{p}^{\\mathrm{N_2}}(T) \\right) dT $$\n代入已知值：$n_{\\mathrm{H_2O}}=1$ mol, $n_{\\mathrm{N}_2}=\\frac{79}{42}$ mol, 以及 $\\Delta h_{f, \\mathrm{H_2O}}^{\\circ} = -241.826$ kJ/mol $= -241826$ J/mol。\n$$ - (1) (-241826) = \\int_{300}^{T_{ad}} \\left( (1) c_{p}^{\\mathrm{H_2O}}(T) + \\frac{79}{42} c_{p}^{\\mathrm{N_2}}(T) \\right) dT $$\n被积函数是产物混合物的总热容 $C_{p,prod}(T)$。热容公式为 $c_p(T) = A + BT$：\n$c_p^{\\mathrm{H_2O}}(T) = 32.24 + 2.27 \\times 10^{-3}\\, T$\n$c_p^{\\mathrm{N_2}}(T) = 29.15 + 3.29 \\times 10^{-3}\\, T$\n$C_{p,prod}(T) = (32.24 + 2.27 \\times 10^{-3}\\, T) + \\frac{79}{42}(29.15 + 3.29 \\times 10^{-3}\\, T)$\n按 $T$ 的幂次合并各项：\n$C_{p,prod}(T) = \\left(32.24 + \\frac{79}{42} \\times 29.15\\right) + \\left(2.27 \\times 10^{-3} + \\frac{79}{42} \\times 3.29 \\times 10^{-3}\\right)T$\n我们将系数称为 $A_{prod}$ 和 $B_{prod}$：\n$A_{prod} = 32.24 + \\frac{2302.85}{42} = \\frac{1354.08 + 2302.85}{42} = \\frac{3656.93}{42} \\approx 87.07976$ J mol$^{-1}$ K$^{-1}$\n$B_{prod} = \\left(2.27 + \\frac{259.91}{42}\\right) \\times 10^{-3} = \\frac{95.34 + 259.91}{42} \\times 10^{-3} = \\frac{355.25}{42} \\times 10^{-3} \\approx 8.45833 \\times 10^{-3}$ J mol$^{-1}$ K$^{-2}$\n现在，我们进行积分：\n$$ \\int_{300}^{T_{ad}} (A_{prod} + B_{prod}T) dT = \\left[ A_{prod}T + \\frac{1}{2}B_{prod}T^2 \\right]_{300}^{T_{ad}} $$\n$$ = (A_{prod}T_{ad} + \\frac{1}{2}B_{prod}T_{ad}^2) - (A_{prod}(300) + \\frac{1}{2}B_{prod}(300)^2) $$\n其值等于 $241826$。因此，我们得到一个关于 $T_{ad}$ 的二次方程：\n$$ \\frac{1}{2}B_{prod}T_{ad}^2 + A_{prod}T_{ad} - \\left( 241826 + 300A_{prod} + \\frac{1}{2}B_{prod}(300)^2 \\right) = 0 $$\n我们来计算标准二次方程形式 $aT_{ad}^2 + bT_{ad} + c = 0$ 的系数：\n$a = \\frac{1}{2}B_{prod} = \\frac{1}{2} \\left(\\frac{355.25}{42} \\times 10^{-3}\\right) = \\frac{177.625}{42} \\times 10^{-3} \\approx 4.229167 \\times 10^{-3}$\n$b = A_{prod} = \\frac{3656.93}{42} \\approx 87.07976$\n$c = -(241826 + 300(\\frac{3656.93}{42}) + \\frac{1}{2}(\\frac{355.25}{42} \\times 10^{-3})(90000))$\n$c = -(241826 + 26123.928... + 380.625) = -268330.553...$\n二次方程为：\n$$ (4.229167 \\times 10^{-3})T_{ad}^2 + 87.07976 T_{ad} - 268330.553 = 0 $$\n我们使用求根公式 $T_{ad} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $T_{ad}$。我们预期温度会很高，因此取正根。\n$T_{ad} = \\frac{-87.07976 + \\sqrt{(87.07976)^2 - 4(4.229167 \\times 10^{-3})(-268330.553)}}{2(4.229167 \\times 10^{-3})}$\n$T_{ad} = \\frac{-87.07976 + \\sqrt{7582.885 + 4539.309}}{8.458333 \\times 10^{-3}}$\n$T_{ad} = \\frac{-87.07976 + \\sqrt{12122.194}}{8.458333 \\times 10^{-3}}$\n$T_{ad} = \\frac{-87.07976 + 110.09993}{8.458333 \\times 10^{-3}}$\n$T_{ad} = \\frac{23.02017}{8.458333 \\times 10^{-3}} \\approx 2721.57$ K\n题目要求答案四舍五入到四位有效数字。\n$T_{ad} = 2721.57$ K 变为 $2722$ K。",
            "answer": "$$\\boxed{2722}$$"
        },
        {
            "introduction": "在火焰中，除了浓度梯度，温度梯度同样会驱动物质传输，这一现象被称为热泳效应或索雷效应 (Soret effect)。对于像氢分子 ($\\mathrm{H_2}$) 这样的轻质组分，该效应尤为显著，它会促使这些组分向温度更高的区域扩散，从而显著改变火焰结构。通过本实践，您将定量计算这一热泳速度，并将其与整体火焰速度进行比较，从而理解为何在精确的氢气燃烧模型中考虑索雷效应是至关重要的。",
            "id": "4031173",
            "problem": "考虑常压下氨和氢在空气中的一维、稳定、平面、预混火焰。关注火焰预热区内的一个位置，在该位置温度沿正空间坐标 $x$ 单调增加。在此位置，已知以下数据，并且除温度梯度外，可假定其在局部是均匀的：\n- 局部温度 $T = 1500 \\,\\mathrm{K}$。\n- 温度梯度 $\\frac{dT}{dx} = 1.2 \\times 10^{7} \\,\\mathrm{K}\\,\\mathrm{m}^{-1}$，方向沿 $+x$。\n- 氢气的混合物平均热扩散系数，$D_{T,\\mathrm{H_2}} = 2.5 \\times 10^{-5} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。\n- 在这些条件下，氨-氢-空气混合物的层流火焰速度，$S_{L} = 0.82 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n\n从理想气体混合物的多组分 Stefan–Maxwell 描述和热扩散（Soret 效应）对扩散驱动力的贡献的定义出发，推导热扩散对氢相对于混合物质均速度的扩散速度的贡献，并用热扩散系数和温度场表示。然后，使用所提供的数据，计算指定位置沿 $x$ 方向的氢气热扩散速度分量。最后，定义无量纲比值\n$$\nR \\equiv \\frac{\\left|v_{T,\\mathrm{H_2}}\\right|}{S_{L}},\n$$\n并计算其数值。需要时使用恒等式 $\\nabla \\ln T = \\frac{1}{T}\\nabla T$。将 $R$ 作为最终答案报告，并四舍五入至三位有效数字。中间的热扩散速度应以 $\\mathrm{m}\\,\\mathrm{s}^{-1}$ 为单位进行计算，而最终报告的比值 $R$ 是无量纲的。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、提法明确且完整。\n\n已知条件如下：\n-   一维、稳定、平面、预混火焰。\n-   位置：预热区中的一点。\n-   局部温度：$T = 1500 \\,\\mathrm{K}$。\n-   温度梯度：$\\frac{dT}{dx} = 1.2 \\times 10^{7} \\,\\mathrm{K}\\,\\mathrm{m}^{-1}$。\n-   氢气的混合物平均热扩散系数：$D_{T,\\mathrm{H_2}} = 2.5 \\times 10^{-5} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。\n-   层流火焰速度：$S_{L} = 0.82 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n-   所需恒等式：$\\nabla \\ln T = \\frac{1}{T}\\nabla T$。\n-   待计算比值的定义：$R \\equiv \\frac{\\left|v_{T,\\mathrm{H_2}}\\right|}{S_{L}}$。\n\n该问题在科学上是有效的。它涉及可燃气体混合物中的 Soret 效应（热扩散），这是燃烧物理学和输运现象中的一个标准课题。所提供的数据对于富氢火焰是物理上现实的。例如，大的温度梯度是火焰极薄预热区的特征，其厚度通常为亚毫米级。热扩散系数和层流火焰速度的值也在该类混合物的预期范围内。该问题提法明确，提供了所有必要信息和清晰的目标。因此，可以进行求解。\n\n任务是推导和评估氢的热扩散速度 $v_{T,\\mathrm{H_2}}$，然后计算无量纲比值 $R$。\n\n对扩散速度的热扩散贡献，通常称为 Soret 效应，描述了混合物中各组分因响应温度梯度而扩散的趋势。对于组分 $k$，其热扩散速度 $\\mathbf{v}_{T,k}$ 与温度对数的梯度成正比：\n$$\n\\mathbf{v}_{T,k} \\propto \\nabla \\ln T\n$$\n在多组分混合物中，组分 $k$ 的扩散速度的完整表达式是复杂的。然而，在燃烧模型中通常使用简化模型。组分 $k$ 的扩散质量通量 $\\mathbf{j}_k$ 的一个常用公式包括普通（浓度驱动）扩散项和热扩散项：\n$$\n\\mathbf{j}_k = \\mathbf{j}_{c,k} + \\mathbf{j}_{T,k}\n$$\n热扩散通量 $\\mathbf{j}_{T,k}$ 通常写为：\n$$\n\\mathbf{j}_{T,k} = -D_k^T \\nabla \\ln T\n$$\n其中 $D_k^T$ 是热扩散系数，单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}$。扩散速度 $\\mathbf{v}_k$ 与扩散质量通量 $\\mathbf{j}_k$ 通过 $\\mathbf{j}_k = \\rho_k \\mathbf{v}_k = \\rho Y_k \\mathbf{v}_k$ 相关联，其中 $\\rho_k$ 和 $Y_k$ 分别是组分 $k$ 的分密度和质量分数，$\\rho$ 是混合物的总密度。因此，对扩散速度的热贡献为：\n$$\n\\mathbf{v}_{T,k} = \\frac{\\mathbf{j}_{T,k}}{\\rho_k} = -\\frac{D_k^T}{\\rho_k} \\nabla \\ln T\n$$\n一个已知的物理现象是，像氢 ($\\mathrm{H_2}$) 这样的轻组分会向较热的区域扩散。由于温度梯度在 $+x$ 方向上为正，$\\mathrm{H_2}$ 的扩散速度必须为正。这意味着对于氢，项 $-\\frac{D_k^T}{\\rho_k}$ 必须为正。由于 $\\rho_k > 0$，系数 $D_k^T$ 对于氢必须为负，这是燃烧文献中的标准惯例。\n\n问题提供了一个氢的“混合物平均热扩散系数” $D_{T,\\mathrm{H_2}}$，其单位为 $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。让我们检查我们推导的速度方程中前置因子的单位：$\\left[-\\frac{D_k^T}{\\rho_k}\\right] = \\frac{\\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}}{\\mathrm{kg}\\,\\mathrm{m}^{-3}} = \\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$。这与给定系数 $D_{T,\\mathrm{H_2}}$ 的单位相匹配。这强烈暗示问题将所提供的系数定义为：\n$$\nD_{T,\\mathrm{H_2}} \\equiv -\\frac{D_{\\mathrm{H_2}}^T}{\\rho_{\\mathrm{H_2}}}\n$$\n由于氢的 $D_{\\mathrm{H_2}}^T$ 为负，这个定义使得 $D_{T,\\mathrm{H_2}}$ 成为一个正量，这与给定的值 $2.5 \\times 10^{-5} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$ 一致。\n\n将此定义代入热扩散速度的表达式中，得到要使用的具体关系：\n$$\n\\mathbf{v}_{T,\\mathrm{H_2}} = D_{T,\\mathrm{H_2}} \\nabla \\ln T\n$$\n使用问题中提供的恒等式 $\\nabla \\ln T = \\frac{1}{T}\\nabla T$，我们得到推导的最终形式：\n$$\n\\mathbf{v}_{T,\\mathrm{H_2}} = \\frac{D_{T,\\mathrm{H_2}}}{T} \\nabla T\n$$\n这个方程直接将热扩散速度与给定的系数和温度场联系起来。\n\n接下来，我们计算这个速度沿 $x$ 轴的分量，我们将其表示为 $v_{T,\\mathrm{H_2},x}$。由于问题是一维的，梯度 $\\nabla T$ 变为 $\\frac{dT}{dx}\\mathbf{i}$，其中 $\\mathbf{i}$ 是 $+x$ 方向的单位向量。标量分量是：\n$$\nv_{T,\\mathrm{H_2},x} = \\frac{D_{T,\\mathrm{H_2}}}{T} \\frac{dT}{dx}\n$$\n代入所提供的数值：\n$$\nv_{T,\\mathrm{H_2},x} = \\frac{2.5 \\times 10^{-5} \\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}}{1500 \\,\\mathrm{K}} \\left(1.2 \\times 10^{7} \\,\\mathrm{K}\\,\\mathrm{m}^{-1}\\right)\n$$\n$$\nv_{T,\\mathrm{H_2},x} = \\frac{(2.5 \\times 1.2) \\times (10^{-5} \\times 10^{7})}{1500} \\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\nv_{T,\\mathrm{H_2},x} = \\frac{3.0 \\times 10^{2}}{1500} \\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\nv_{T,\\mathrm{H_2},x} = \\frac{300}{1500} \\,\\mathrm{m}\\,\\mathrm{s}^{-1} = \\frac{1}{5} \\,\\mathrm{m}\\,\\mathrm{s}^{-1} = 0.2 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n因此，氢热扩散速度的大小为 $|v_{T,\\mathrm{H_2}}| = 0.2 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。正号证实了氢如预期那样向温度升高的方向扩散。\n\n最后，我们计算无量纲比值 $R$：\n$$\nR \\equiv \\frac{\\left|v_{T,\\mathrm{H_2}}\\right|}{S_{L}}\n$$\n代入 $|v_{T,\\mathrm{H_2}}|$ 的计算值和 $S_{L}$ 的给定值：\n$$\nR = \\frac{0.2 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{0.82 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}} = \\frac{20}{82} = \\frac{10}{41}\n$$\n$$\nR \\approx 0.2439024...\n$$\n按要求四舍五入到三位有效数字，我们得到 $R = 0.244$。这个结果表明，在这种特定的火焰条件下，氢的热扩散贡献的速度大约是层流火焰速度的 $24.4\\%$，这凸显了在模拟含氢火焰时 Soret 效应的重要性。",
            "answer": "$$\n\\boxed{0.244}\n$$"
        },
        {
            "introduction": "计算燃烧模拟的一个关键目标是解析火焰复杂的内部结构，将化学动力学与温度和组分的空间分布联系起来。本实践模拟了计算科学家的日常工作，要求您分析一维预混火焰的结构。通过编写一个简单的程序来处理给定的综合火焰数据，您将确定关键自由基组分（如 $\\mathrm{OH}$ 和 $\\mathrm{HO}_2$）相对于主反应区的位置，从而深入了解构成火焰的一系列化学事件在空间上的发生顺序。",
            "id": "4031178",
            "problem": "在一个计算燃烧环境中，我们考虑一个氢气和氨气的一维（1D）稳态预混火焰。目标是通过确定羟基自由基（$\\mathrm{OH}$）、氢过氧自由基（$\\mathrm{HO_2}$）和一氧化氮（$\\mathrm{NO}$）的摩尔分数峰值位置来分析火焰结构，并将这些位置与最大温度梯度相关联。在一维稳态预混火焰中，最大温度梯度是反应区的代表。该分析必须使用旨在模拟氢-氨火焰定性行为的、物理上合理的合成剖面来进行。程序必须输出从最大温度梯度位置到每个物种峰值的有符号距离，正值表示下游（温度更高，$x$ 更大），负值表示上游（温度更低，$x$ 更小）。所有距离必须以毫米（mm）表示。\n\n从以下适用于计算燃烧的基本和核心定义开始：\n- 稳态一维能量守恒意味着对流输运和化学放热之间的平衡，在预混火焰中，反应区与陡峭的温度梯度位于同一位置。温度 $T(x)$ 是一个在火焰中从非燃温度 $T_u$ 单调递增到已燃温度 $T_b$ 的函数。\n- 物种摩尔分数场 $\\chi_{\\mathrm{OH}}(x)$、$\\chi_{\\mathrm{HO_2}}(x)$ 和 $\\chi_{\\mathrm{NO}}(x)$ 由于链分支和链终止过程，在相对于反应区的特征位置上出现峰值。羟基自由基（$\\mathrm{OH}$）通常在反应锋面附近达到峰值，氢过氧自由基（$\\mathrm{HO_2}$）倾向于在温度较低的上游达到峰值，而一氧化氮（$\\mathrm{NO}$）在温度较高的下游达到峰值（由于瞬发和热力机制，可能存在双峰性）。\n- 连续导数由 $\\frac{dT}{dx}$ 定义，其在网格上的离散近似由有限差分给出。一个函数在离散网格上的局部最大值对应于其采样值达到最大值的索引。\n\n该合成测试套件通过解析函数和参数，在均匀网格上定义了 $T(x)$ 和物种剖面，从而产生科学上合理的场。在所有情况下，设网格点在闭区间 $[0, L]$ 上定义为 $x_i = 0 + i \\Delta x$，其中 $i \\in \\{0,1,\\dots,N-1\\}$ 且 $\\Delta x = \\dfrac{L}{N-1}$。温度场定义为\n$$\nT(x) = T_u + \\left(T_b - T_u\\right) \\cdot s(x), \\quad s(x) = \\dfrac{1}{2}\\left(1 + \\tanh\\left(\\dfrac{x - x_0}{\\delta}\\right)\\right),\n$$\n这产生一个单调递增的 $T(x)$，其反应锋面中心在 $x_0$ 附近，厚度由 $\\delta$ 控制。物种摩尔分数剖面被建模为相对于反应锋面定位的高斯函数，其幅值和宽度被选择为合理的：\n$$\n\\chi_{\\mathrm{OH}}(x) = A_{\\mathrm{OH}} \\exp\\left(-\\dfrac{\\left(x - \\left(x_{\\mathrm{g}} + \\Delta_{\\mathrm{OH}}\\right)\\right)^2}{2 \\sigma_{\\mathrm{OH}}^2}\\right),\n$$\n$$\n\\chi_{\\mathrm{HO}_2}(x) = A_{\\mathrm{HO}_2} \\exp\\left(-\\dfrac{\\left(x - \\left(x_{\\mathrm{g}} + \\Delta_{\\mathrm{HO}_2}\\right)\\right)^2}{2 \\sigma_{\\mathrm{HO}_2}^2}\\right),\n$$\n$$\n\\chi_{\\mathrm{NO}}(x) = \\begin{cases}\nA_{\\mathrm{NO}} \\exp\\left(-\\dfrac{\\left(x - \\left(x_{\\mathrm{g}} + \\Delta_{\\mathrm{NO}}\\right)\\right)^2}{2 \\sigma_{\\mathrm{NO}}^2}\\right),  & \\text{单峰情况},\\\\[6pt]\nA_1 \\exp\\left(-\\dfrac{\\left(x - \\left(x_{\\mathrm{g}} + \\Delta_1\\right)\\right)^2}{2 \\sigma_1^2}\\right) + A_2 \\exp\\left(-\\dfrac{\\left(x - \\left(x_{\\mathrm{g}} + \\Delta_2\\right)\\right)^2}{2 \\sigma_2^2}\\right),  & \\text{双峰情况}.\n\\end{cases}\n$$\n此处，$x_{\\mathrm{g}}$ 表示 $|\\frac{dT}{dx}|$ 最大值的位置，应通过有限差分从离散化的温度场计算得出。偏移量 $\\Delta_{\\mathrm{OH}}$、$\\Delta_{\\mathrm{HO}_2}$ 和 $\\Delta_{\\mathrm{NO}}$ 将物种峰值相对于反应锋面定位，上游偏移量为负，下游偏移量为正。\n\n对每个测试用例，执行以下操作：\n1. 构建网格 $\\{x_i\\}$ 并计算 $T(x)$。\n2. 使用以下格式计算离散温度梯度 $\\frac{dT}{dx}$：在左边界使用前向差分，在右边界使用后向差分，在内部点使用中心差分，\n$$\n\\left.\\dfrac{dT}{dx}\\right|_{x_0} \\approx \\dfrac{T(x_1) - T(x_0)}{x_1 - x_0}, \\quad \n\\left.\\dfrac{dT}{dx}\\right|_{x_{N-1}} \\approx \\dfrac{T(x_{N-1}) - T(x_{N-2})}{x_{N-1} - x_{N-2}},\n$$\n$$\n\\left.\\dfrac{dT}{dx}\\right|_{x_i} \\approx \\dfrac{T(x_{i+1}) - T(x_{i-1})}{x_{i+1} - x_{i-1}}, \\quad i \\in \\{1,2,\\dots,N-2\\}.\n$$\n3. 确定 $x_{\\mathrm{g}}$ 为 $|\\frac{dT}{dx}|$ 取得最大值的网格点。\n4. 根据下文的用例定义，构建 $\\chi_{\\mathrm{OH}}(x)$、$\\chi_{\\mathrm{HO_2}}(x)$ 和 $\\chi_{\\mathrm{NO}}(x)$。\n5. 对于每种物种，找到其全局最大值的网格点，并计算有符号距离 $d_{\\mathrm{species}} = x_{\\mathrm{peak}} - x_{\\mathrm{g}}$。\n6. 通过乘以 $1000$ 将 $d_{\\mathrm{species}}$ 表示为毫米（mm）。\n7. 对于每个测试用例，生成一个三元组 $[d_{\\mathrm{OH}}, d_{\\mathrm{HO_2}}, d_{\\mathrm{NO}}]$（单位为毫米(mm)），格式化为小数点后六位的浮点数。\n\n测试套件（参数采用国际单位制）：\n- 用例 1（典型的薄反应区）：\n    - $L = 0.01$ 米 (m), $N = 501$, $T_u = 300$ 开尔文 (K), $T_b = 2200$ 开尔文 (K),\n    - $x_0 = 0.0030$ 米 (m), $\\delta = 0.0004$ 米 (m),\n    - $A_{\\mathrm{OH}} = 2.0 \\times 10^{-3}$, $\\sigma_{\\mathrm{OH}} = 0.00025$ 米 (m), $\\Delta_{\\mathrm{OH}} = +0.00005$ 米 (m),\n    - $A_{\\mathrm{HO_2}} = 6.0 \\times 10^{-4}$, $\\sigma_{\\mathrm{HO_2}} = 0.00035$ 米 (m), $\\Delta_{\\mathrm{HO_2}} = -0.00030$ 米 (m),\n    - $A_{\\mathrm{NO}} = 1.0 \\times 10^{-4}$, $\\sigma_{\\mathrm{NO}} = 0.00060$ 米 (m), $\\Delta_{\\mathrm{NO}} = +0.00070$ 米 (m).\n- 用例 2（更宽的反应区，由于瞬发和热力贡献导致的双峰NO）：\n    - $L = 0.015$ 米 (m), $N = 601$, $T_u = 320$ 开尔文 (K), $T_b = 2100$ 开尔文 (K),\n    - $x_0 = 0.0060$ 米 (m), $\\delta = 0.0006$ 米 (m),\n    - $A_{\\mathrm{OH}} = 1.6 \\times 10^{-3}$, $\\sigma_{\\mathrm{OH}} = 0.00030$ 米 (m), $\\Delta_{\\mathrm{OH}} = +0.00000$ 米 (m),\n    - $A_{\\mathrm{HO_2}} = 8.0 \\times 10^{-4}$, $\\sigma_{\\mathrm{HO_2}} = 0.00045$ 米 (m), $\\Delta_{\\mathrm{HO_2}} = -0.00040$ 米 (m),\n    - NO 由两个峰定义：$A_1 = 0.8 \\times 10^{-4}$, $\\sigma_1 = 0.00080$ 米 (m), $\\Delta_1 = +0.00100$ 米 (m); 和 $A_2 = 0.5 \\times 10^{-4}$, $\\sigma_2 = 0.00025$ 米 (m), $\\Delta_2 = +0.00010$ 米 (m)。\n- 用例 3（反应区靠近入口，上游HO$_2$峰值偏向边界）：\n    - $L = 0.008$ 米 (m), $N = 401$, $T_u = 290$ 开尔文 (K), $T_b = 2000$ 开尔文 (K),\n    - $x_0 = 0.00120$ 米 (m), $\\delta = 0.00030$ 米 (m),\n    - $A_{\\mathrm{OH}} = 1.8 \\times 10^{-3}$, $\\sigma_{\\mathrm{OH}} = 0.00020$ 米 (m), $\\Delta_{\\mathrm{OH}} = +0.00002$ 米 (m),\n    - $A_{\\mathrm{HO_2}} = 7.0 \\times 10^{-4}$, $\\sigma_{\\mathrm{HO_2}} = 0.00035$ 米 (m), $\\Delta_{\\mathrm{HO_2}} = -0.00100$ 米 (m),\n    - $A_{\\mathrm{NO}} = 0.7 \\times 10^{-4}$, $\\sigma_{\\mathrm{NO}} = 0.00070$ 米 (m), $\\Delta_{\\mathrm{NO}} = +0.00050$ 米 (m).\n\n算法要求：\n- 使用上述指定的离散梯度格式计算 $\\dfrac{dT}{dx}$。\n- 确定 $x_{\\mathrm{g}}$ 为 $|\\dfrac{dT}{dx}|$ 最大值所在的网格位置。\n- 通过每个物种剖面在网格上的全局最大值的索引来确定峰值位置。在双峰NO的情况下，这是总的全局最大值的索引。\n- 计算有符号距离 $d_{\\mathrm{species}} = x_{\\mathrm{peak}} - x_{\\mathrm{g}}$ 并将其转换为毫米（mm）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例产生一个三元组列表 $[d_{\\mathrm{OH}}, d_{\\mathrm{HO_2}}, d_{\\mathrm{NO}}]$（单位为毫米(mm)）。将每个浮点数格式化为小数点后六位。输出中不得有空格。例如，输出应如下所示\n$$\n\\left[ \\left[d_{\\mathrm{OH},1}, d_{\\mathrm{HO}_2,1}, d_{\\mathrm{NO},1}\\right], \\left[d_{\\mathrm{OH},2}, d_{\\mathrm{HO}_2,2}, d_{\\mathrm{NO},2}\\right], \\left[d_{\\mathrm{OH},3}, d_{\\mathrm{HO}_2,3}, d_{\\mathrm{NO},3}\\right] \\right],\n$$\n精确地打印为类似于 $[ [\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot] ]$ 的单行字符串，不含空格。",
            "solution": "问题陈述经评估有效。它科学地基于燃烧理论的原理，使用已建立的简化模型进行火焰结构分析。该问题是适定的，提供了所有必要的数学定义、参数以及清晰明确的算法流程。所有数据都是自洽且物理上合理的。该任务是计算科学中的一个标准数值练习，需要在网格上仔细实现离散化和分析。\n\n目标是在模拟的一维预混火焰中，确定关键化学物种（$\\mathrm{OH}$、$\\mathrm{HO_2}$ 和 $\\mathrm{NO}$）的峰值摩尔分数与主反应区之间的空间关系。反应区的位置通过最大温度梯度的点来识别。该分析通过一系列明确定义的数值步骤进行。\n\n首先，将长度为 $L$ 的一维空间域离散化为一个由 $N$ 个点组成的均匀网格 $\\{x_i\\}$，其中 $x_i = i \\cdot \\Delta x$，对于 $i = 0, 1, \\dots, N-1$，网格间距为 $\\Delta x = L / (N-1)$。\n\n其次，在每个网格点 $x_i$ 上计算温度场 $T(x)$。提供的解析形式为\n$$\nT(x) = T_u + (T_b - T_u) \\cdot \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{x - x_0}{\\delta}\\right)\\right)\n$$\n其中 $T_u$ 是未燃气体温度，$T_b$ 是最终已燃气体温度，$x_0$ 是火焰的名义中心，$\\delta$ 表征火焰厚度。该函数产生一个单调递增的温度，模拟从反应物到产物的过程。\n\n第三，在离散网格上计算温度梯度 $\\frac{dT}{dx}$。问题指定了一个混合有限差分格式来近似导数。在内部网格点 $i \\in \\{1, 2, \\dots, N-2\\}$，采用二阶精确的中心差分：\n$$\n\\left.\\frac{dT}{dx}\\right|_{x_i} \\approx \\frac{T(x_{i+1}) - T(x_{i-1})}{x_{i+1} - x_{i-1}} = \\frac{T_{i+1} - T_{i-1}}{2\\Delta x}\n$$\n在边界处，使用一阶精确的单边差分来避免引用不存在的点。在左边界（$i=0$），使用前向差分：\n$$\n\\left.\\frac{dT}{dx}\\right|_{x_0} \\approx \\frac{T(x_1) - T(x_0)}{x_1 - x_0} = \\frac{T_1 - T_0}{\\Delta x}\n$$\n在右边界（$i=N-1$），使用后向差分：\n$$\n\\left.\\frac{dT}{dx}\\right|_{x_{N-1}} \\approx \\frac{T(x_{N-1}) - T(x_{N-2})}{x_{N-1} - x_{N-2}} = \\frac{T_{N-1} - T_{N-2}}{\\Delta x}\n$$\n然后，主反应区的位置，表示为 $x_g$，被确定为对应于绝对温度梯度 $|\\frac{dT}{dx}|$ 最大值的网格坐标。这是通过确定索引 $i_g$ 使得 $|\\frac{dT}{dx}|_{x_{i_g}}|$ 最大，并设置 $x_g = x_{i_g}$ 来找到的。\n\n第四，在确定 $x_g$ 后，在网格上构建目标物种（$\\mathrm{OH}$、$\\mathrm{HO_2}$ 和 $\\mathrm{NO}$）的摩尔分数剖面。这些剖面被建模为高斯函数或高斯函数之和，其中心位于从 $x_g$ 偏移的位置。对于单峰物种 $\\mathrm{Y}$，其剖面由以下公式给出：\n$$\n\\chi_{\\mathrm{Y}}(x) = A_{\\mathrm{Y}} \\exp\\left(-\\frac{(x - (x_g + \\Delta_{\\mathrm{Y}}))^2}{2 \\sigma_{\\mathrm{Y}}^2}\\right)\n$$\n对于第二个测试场景中 $\\mathrm{NO}$ 的双峰情况，剖面是两个此类函数的和。这些剖面在每个网格点 $x_i$ 上进行评估。\n\n第五，通过识别相应的摩尔分数数组 $\\chi(x_i)$ 达到其全局最大值的网格点，找到每个物种的峰值摩尔分数位置 $x_{\\mathrm{peak}}$。这是通过找到数组中最大值的索引并检索相应的空间坐标来完成的。\n\n最后，对于每个物种，从反应区参考点 $x_g$ 到物种峰值位置 $x_{\\mathrm{peak}}$ 的有符号距离 $d_{\\mathrm{species}}$ 计算如下：\n$$\nd_{\\mathrm{species}} = x_{\\mathrm{peak}} - x_g\n$$\n该距离通过乘以因子 $1000$ 从米转换为毫米。每个测试用例的结果被编译成一个三元组 $[d_{\\mathrm{OH}}, d_{\\mathrm{HO_2}}, d_{\\mathrm{NO}}]$，并根据规范进行格式化。此程序系统地应用于所有提供的测试用例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational combustion problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            \"L\": 0.01, \"N\": 501, \"Tu\": 300, \"Tb\": 2200, \"x0\": 0.0030, \"delta\": 0.0004,\n            \"OH\": {\"A\": 2.0e-3, \"sigma\": 0.00025, \"Delta\": 0.00005},\n            \"HO2\": {\"A\": 6.0e-4, \"sigma\": 0.00035, \"Delta\": -0.00030},\n            \"NO\": {\"type\": \"single\", \"A\": 1.0e-4, \"sigma\": 0.00060, \"Delta\": 0.00070}\n        },\n        # Case 2\n        {\n            \"L\": 0.015, \"N\": 601, \"Tu\": 320, \"Tb\": 2100, \"x0\": 0.0060, \"delta\": 0.0006,\n            \"OH\": {\"A\": 1.6e-3, \"sigma\": 0.00030, \"Delta\": 0.00000},\n            \"HO2\": {\"A\": 8.0e-4, \"sigma\": 0.00045, \"Delta\": -0.00040},\n            \"NO\": {\"type\": \"bimodal\", \n                   \"peak1\": {\"A\": 0.8e-4, \"sigma\": 0.00080, \"Delta\": 0.00100},\n                   \"peak2\": {\"A\": 0.5e-4, \"sigma\": 0.00025, \"Delta\": 0.00010}}\n        },\n        # Case 3\n        {\n            \"L\": 0.008, \"N\": 401, \"Tu\": 290, \"Tb\": 2000, \"x0\": 0.00120, \"delta\": 0.00030,\n            \"OH\": {\"A\": 1.8e-3, \"sigma\": 0.00020, \"Delta\": 0.00002},\n            \"HO2\": {\"A\": 7.0e-4, \"sigma\": 0.00035, \"Delta\": -0.00100},\n            \"NO\": {\"type\": \"single\", \"A\": 0.7e-4, \"sigma\": 0.00070, \"Delta\": 0.00050}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Step 1: Construct grid and compute temperature profile\n        L, N = case[\"L\"], case[\"N\"]\n        Tu, Tb = case[\"Tu\"], case[\"Tb\"]\n        x0, delta = case[\"x0\"], case[\"delta\"]\n        \n        x = np.linspace(0, L, N)\n        dx = L / (N - 1)\n        \n        s_x = 0.5 * (1 + np.tanh((x - x0) / delta))\n        T = Tu + (Tb - Tu) * s_x\n\n        # Step 2: Compute discrete temperature gradient\n        dTdx = np.zeros_like(x)\n        # Forward difference at the left boundary\n        dTdx[0] = (T[1] - T[0]) / dx\n        # Backward difference at the right boundary\n        dTdx[-1] = (T[-1] - T[-2]) / dx\n        # Centered difference for interior points\n        dTdx[1:-1] = (T[2:] - T[:-2]) / (2 * dx)\n\n        # Step 3: Determine x_g\n        idx_g = np.argmax(np.abs(dTdx))\n        x_g = x[idx_g]\n\n        # Step 4-6: Construct species profiles, find peaks, and compute distances\n        case_distances = []\n        \n        def gaussian(x_grid, A, mu, sigma):\n            return A * np.exp(-((x_grid - mu)**2) / (2 * sigma**2))\n\n        # OH\n        oh_params = case[\"OH\"]\n        chi_OH = gaussian(x, oh_params[\"A\"], x_g + oh_params[\"Delta\"], oh_params[\"sigma\"])\n        idx_peak_OH = np.argmax(chi_OH)\n        x_peak_OH = x[idx_peak_OH]\n        d_OH = (x_peak_OH - x_g) * 1000\n        case_distances.append(d_OH)\n        \n        # HO2\n        ho2_params = case[\"HO2\"]\n        chi_HO2 = gaussian(x, ho2_params[\"A\"], x_g + ho2_params[\"Delta\"], ho2_params[\"sigma\"])\n        idx_peak_HO2 = np.argmax(chi_HO2)\n        x_peak_HO2 = x[idx_peak_HO2]\n        d_HO2 = (x_peak_HO2 - x_g) * 1000\n        case_distances.append(d_HO2)\n\n        # NO\n        no_params = case[\"NO\"]\n        if no_params[\"type\"] == \"single\":\n            chi_NO = gaussian(x, no_params[\"A\"], x_g + no_params[\"Delta\"], no_params[\"sigma\"])\n        else: # bimodal\n            p1 = no_params[\"peak1\"]\n            p2 = no_params[\"peak2\"]\n            chi_NO = (gaussian(x, p1[\"A\"], x_g + p1[\"Delta\"], p1[\"sigma\"]) +\n                      gaussian(x, p2[\"A\"], x_g + p2[\"Delta\"], p2[\"sigma\"]))\n\n        idx_peak_NO = np.argmax(chi_NO)\n        x_peak_NO = x[idx_peak_NO]\n        d_NO = (x_peak_NO - x_g) * 1000\n        case_distances.append(d_NO)\n\n        all_results.append(case_distances)\n\n    # Format the final output string\n    case_strings = [f\"[{','.join(f'{d:.6f}' for d in res)}]\" for res in all_results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}