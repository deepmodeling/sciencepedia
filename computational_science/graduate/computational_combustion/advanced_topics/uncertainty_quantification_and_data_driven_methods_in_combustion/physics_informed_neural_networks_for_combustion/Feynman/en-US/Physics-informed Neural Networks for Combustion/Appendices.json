{
    "hands_on_practices": [
        {
            "introduction": "Before we can ask a neural network to obey the laws of physics, we must have a firm grasp of those laws ourselves. This first exercise reinforces a fundamental principle of thermochemistry—the ideal-gas equation of state—which is a cornerstone constraint in nearly all combustion models. By manually calculating the pressure field in a simplified flame, you will practice applying the same physical logic that a Physics-Informed Neural Network (PINN) must learn to enforce .",
            "id": "4049991",
            "problem": "A Physics-Informed Neural Network (PINN) is trained to approximate the thermochemical fields of a one-dimensional, steady, stoichiometric, premixed methane–air flame at low Mach number, in the isobaric regime. The spatial coordinate is $x \\in [0,L]$ with $L = 5.0 \\times 10^{-3}\\ \\mathrm{m}$. The PINN predicts the temperature field $T(x)$ and species mass fractions $Y_k(x)$ for the species set $\\mathcal{S} = \\{\\mathrm{CH_4}, \\mathrm{O_2}, \\mathrm{N_2}, \\mathrm{CO_2}, \\mathrm{H_2O}\\}$, and enforces the ideal-gas mixture equation of state $p(x) = \\rho(x)\\,R(T)\\,T(x)$ together with the isobaric constraint $\\partial p/\\partial x = 0$ as soft physics constraints in its loss. The universal gas constant is $R_u = 8.314462618\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}$, and the species molar masses (in $\\mathrm{kg}\\ \\mathrm{mol}^{-1}$) are $W_{\\mathrm{CH_4}} = 0.01604276$, $W_{\\mathrm{O_2}} = 0.0319988$, $W_{\\mathrm{N_2}} = 0.0280134$, $W_{\\mathrm{CO_2}} = 0.0440098$, and $W_{\\mathrm{H_2O}} = 0.01801528$. The PINN-predicted temperature is modeled as $T(x) = T_u + \\left(T_b - T_u\\right)s(x)$, where $T_u = 300\\ \\mathrm{K}$, $T_b = 2200\\ \\mathrm{K}$, and the smooth progress variable is $s(x) = \\tfrac{1}{2}\\left(1 + \\tanh\\left((x - x_f)/\\delta\\right)\\right)$ with $x_f = 2.5 \\times 10^{-3}\\ \\mathrm{m}$ and $\\delta = 5.0 \\times 10^{-4}\\ \\mathrm{m}$. The species mass fractions are\n$$\nY_{\\mathrm{N_2}}(x) = Y_{\\mathrm{N_2},u},\\quad\nY_{\\mathrm{CH_4}}(x) = Y_{\\mathrm{CH_4},u}\\left(1 - s(x)\\right),\\quad\nY_{\\mathrm{O_2}}(x) = Y_{\\mathrm{O_2},u}\\left(1 - s(x)\\right),\n$$\n$$\nY_{\\mathrm{CO_2}}(x) = Y_{\\mathrm{CO_2},b}\\,s(x),\\quad\nY_{\\mathrm{H_2O}}(x) = Y_{\\mathrm{H_2O},b}\\,s(x),\n$$\nwith stoichiometric methane–air values\n$$\nY_{\\mathrm{CH_4},u} = \\frac{16.04276}{290.70116},\\quad\nY_{\\mathrm{O_2},u} = \\frac{63.9976}{290.70116},\\quad\nY_{\\mathrm{N_2},u} = \\frac{210.6608}{290.70116},\n$$\n$$\nY_{\\mathrm{CO_2},b} = \\frac{44.0098}{290.70116},\\quad\nY_{\\mathrm{H_2O},b} = \\frac{36.03056}{290.70116}.\n$$\nThese choices ensure $Y_{\\mathrm{CH_4}}(x) + Y_{\\mathrm{O_2}}(x) + Y_{\\mathrm{CO_2}}(x) + Y_{\\mathrm{H_2O}}(x) + Y_{\\mathrm{N_2}}(x) = 1$ for all $x$. The local mixture gas constant is defined by the ideal-gas mixture relation $R(T) = \\sum_{k \\in \\mathcal{S}} Y_k(x)\\,R_k$, where $R_k = R_u/W_k$.\n\nAt the cold inflow boundary $x = 0$, an independent measurement provides the density $ \\rho(0) = 1.122\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$. Using only the fundamental ideal-gas mixture law, the definition of mixture gas constant in terms of species mass fractions, and the isobaric constraint, derive an expression for $R(T)$ in terms of $\\{Y_k\\}$ and $\\{R_k\\}$, demonstrate why $p(x)$ must be spatially uniform, and compute the uniform pressure $p$. Express the final pressure in $\\mathrm{kPa}$ and round your answer to four significant figures. The final answer must be a single real number.",
            "solution": "The problem is valid as it is scientifically grounded in thermodynamics and combustion theory, well-posed, and all necessary data for a unique solution are provided.\n\nThe problem asks for three things: first, to derive an expression for the mixture gas constant $R(T)$; second, to demonstrate why the pressure $p(x)$ is spatially uniform; and third, to compute this uniform pressure.\n\nFirst, let's address the mixture gas constant, $R$. The problem statement defines it as $R(T) = \\sum_{k \\in \\mathcal{S}} Y_k(x)\\,R_k$, where $Y_k(x)$ is the mass fraction of species $k$ and $R_k = R_u/W_k$ is its specific gas constant, with $R_u$ being the universal gas constant and $W_k$ the molar mass of species $k$. The notation $R(T)$ is used because the mass fractions $Y_k(x)$ are themselves functions of a progress variable $s(x)$, which is coupled to the temperature $T(x)$. To show this definition is consistent, we recall the fundamental definition of the mixture gas constant, $R = R_u/W_{\\text{mix}}$, where $W_{\\text{mix}}$ is the mean molar mass of the mixture. The mean molar mass can be defined in terms of mass fractions as $1/W_{\\text{mix}} = \\sum_k Y_k/W_k$. Substituting this into the problem's given expression:\n$$\n\\sum_{k \\in \\mathcal{S}} Y_k(x) R_k = \\sum_{k \\in \\mathcal{S}} Y_k(x) \\frac{R_u}{W_k} = R_u \\sum_{k \\in \\mathcal{S}} \\frac{Y_k(x)}{W_k} = R_u \\left(\\frac{1}{W_{\\text{mix}}(x)}\\right) = R(x)\n$$\nThis confirms the validity of the provided expression for the mixture gas constant, which is a function of the local mixture composition.\n\nSecond, the problem states that the system is modeled in the \"isobaric regime\" and that a soft constraint $\\partial p/\\partial x = 0$ is enforced. A function whose derivative is zero over its domain must be constant. Integrating this condition with respect to the spatial coordinate $x$ from a reference point (e.g., $x=0$) to an arbitrary point $x$ gives:\n$$\n\\int_0^x \\frac{\\mathrm{d}p}{\\mathrm{d}x'} \\mathrm{d}x' = \\int_0^x 0 \\, \\mathrm{d}x' \\implies p(x) - p(0) = 0 \\implies p(x) = p(0)\n$$\nThis demonstrates that the pressure $p$ is spatially uniform, i.e., $p(x) = p = \\text{const}$. This is a standard and highly accurate approximation for low-speed, non-enclosed combustion phenomena where pressure changes due to fluid motion are negligible compared to the absolute thermodynamic pressure.\n\nThird, we compute the value of this uniform pressure. According to the ideal-gas mixture equation of state, $p = \\rho(x) R(x) T(x)$. Since $p$ is constant, we can evaluate it at any convenient point. The problem provides the density at the cold boundary, $\\rho(0) = 1.122\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$, so we will evaluate all quantities at $x=0$.\n$$\np = \\rho(0) R(0) T(0)\n$$\nWe need to calculate the mixture gas constant $R(0)$ and the temperature $T(0)$.\nThe mixture gas constant at $x=0$, denoted $R(0)$, depends on the local mass fractions $Y_k(0)$. The mass fractions are functions of the progress variable $s(x)$ evaluated at $x=0$.\n$s(0) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{0 - x_f}{\\delta}\\right)\\right) = \\frac{1}{2}\\left(1 - \\tanh\\left(\\frac{x_f}{\\delta}\\right)\\right)$.\nWith $x_f = 2.5 \\times 10^{-3}\\ \\mathrm{m}$ and $\\delta = 5.0 \\times 10^{-4}\\ \\mathrm{m}$, the ratio is $x_f/\\delta = 5$.\n$s(0) = \\frac{1}{2}\\left(1 - \\tanh(5)\\right)$.\n\nThe gas constant is $R(x) = R_u / W_{\\text{mix}}(x)$, where $1/W_{\\text{mix}}(x) = \\sum_k Y_k(x)/W_k$. Let's analyze this term:\n$$\n\\frac{1}{W_{\\text{mix}}(x)} = \\frac{Y_{\\mathrm{N_2}}(x)}{W_{\\mathrm{N_2}}} + \\frac{Y_{\\mathrm{CH_4}}(x)}{W_{\\mathrm{CH_4}}} + \\frac{Y_{\\mathrm{O_2}}(x)}{W_{\\mathrm{O_2}}} + \\frac{Y_{\\mathrm{CO_2}}(x)}{W_{\\mathrm{CO_2}}} + \\frac{Y_{\\mathrm{H_2O}}(x)}{W_{\\mathrm{H_2O}}}\n$$\nSubstituting the given expressions for $Y_k(x)$:\n$$\n\\frac{1}{W_{\\text{mix}}(x)} = \\frac{Y_{\\mathrm{N_2},u}}{W_{\\mathrm{N_2}}} + (1-s(x))\\frac{Y_{\\mathrm{CH_4},u}}{W_{\\mathrm{CH_4}}} + (1-s(x))\\frac{Y_{\\mathrm{O_2},u}}{W_{\\mathrm{O_2}}} + s(x)\\frac{Y_{\\mathrm{CO_2},b}}{W_{\\mathrm{CO_2}}} + s(x)\\frac{Y_{\\mathrm{H_2O},b}}{W_{\\mathrm{H_2O}}}\n$$\nLet's evaluate the terms $Y_k/W_k$:\n$Y_{\\mathrm{CH_4},u}/W_{\\mathrm{CH_4}} = \\frac{16.04276/290.70116}{0.01604276} = \\frac{1000}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$\n$Y_{\\mathrm{O_2},u}/W_{\\mathrm{O_2}} = \\frac{63.9976/290.70116}{0.0319988} = \\frac{2000}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$\n$Y_{\\mathrm{N_2},u}/W_{\\mathrm{N_2}} = \\frac{210.6608/290.70116}{0.0280134} = \\frac{7520}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$\n$Y_{\\mathrm{CO_2},b}/W_{\\mathrm{CO_2}} = \\frac{44.0098/290.70116}{0.0440098} = \\frac{1000}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$\n$Y_{\\mathrm{H_2O},b}/W_{\\mathrm{H_2O}} = \\frac{36.03056/290.70116}{0.01801528} = \\frac{2000}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}$\nThe sum of reacting species terms for the unburnt side is $\\frac{1000+2000}{290.70116} = \\frac{3000}{290.70116}$. The sum for the burnt side is $\\frac{1000+2000}{290.70116} = \\frac{3000}{290.70116}$. These are equal due to the conservation of total moles for this specific stoichiometry. Let $S_{\\text{react}} = \\frac{3000}{290.70116}$.\nThen,\n$$\n\\frac{1}{W_{\\text{mix}}(x)} = \\frac{Y_{\\mathrm{N_2},u}}{W_{\\mathrm{N_2}}} + (1-s(x))S_{\\text{react}} + s(x)S_{\\text{react}} = \\frac{Y_{\\mathrm{N_2},u}}{W_{\\mathrm{N_2}}} + S_{\\text{react}}\n$$\nThis proves that $W_{\\text{mix}}$ and consequently $R = R_u/W_{\\text{mix}}$ are constant throughout the flame, independent of $x$. We can calculate the value of $R$:\n$$\n\\frac{1}{W_{\\text{mix}}} = \\frac{7520}{290.70116} + \\frac{3000}{290.70116} = \\frac{10520}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}\n$$\n$$\nR = R_u \\left(\\frac{10520}{290.70116}\\right) = (8.314462618\\ \\mathrm{J}\\ \\mathrm{mol}^{-1}\\ \\mathrm{K}^{-1}) \\left(\\frac{10520}{290.70116}\\ \\mathrm{mol}\\ \\mathrm{kg}^{-1}\\right) \\approx 300.933\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}\n$$\nNext, we calculate the temperature at $x=0$:\n$$\nT(0) = T_u + (T_b - T_u)s(0) = 300\\ \\mathrm{K} + (2200 - 300)\\ \\mathrm{K} \\cdot \\frac{1}{2}\\left(1 - \\tanh(5)\\right)\n$$\n$$\nT(0) = 300 + 1900 \\cdot \\frac{1}{2}\\left(1 - \\tanh(5)\\right) = 300 + 950 \\left(1 - \\frac{\\exp(10)-1}{\\exp(10)+1}\\right) = 300 + 950 \\left(\\frac{2}{\\exp(10)+1}\\right)\n$$\nUsing a calculator, $\\tanh(5) \\approx 0.999909204$.\n$T(0) \\approx 300 + 950(1 - 0.999909204) \\approx 300 + 950(0.000090796) \\approx 300 + 0.086256 \\approx 300.086\\ \\mathrm{K}$.\n\nFinally, we compute the pressure $p$:\n$$\np = \\rho(0) R T(0)\n$$\n$$\np = (1.122\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}) \\times \\left(8.314462618 \\cdot \\frac{10520}{290.70116}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}\\right) \\times \\left(300 + 950(1 - \\tanh(5))\\ \\mathrm{K}\\right)\n$$\nPerforming the numerical calculation:\n$R \\approx 300.93297\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$\n$T(0) \\approx 300.08626\\ \\mathrm{K}$\n$p \\approx 1.122 \\times 300.93297 \\times 300.08626 \\approx 101324.9\\ \\mathrm{Pa}$\n\nTo express this in kilopascals, we divide by $1000$:\n$p \\approx 101.3249\\ \\mathrm{kPa}$\nRounding to four significant figures gives $101.3\\ \\mathrm{kPa}$.",
            "answer": "$$\\boxed{101.3}$$"
        },
        {
            "introduction": "At the core of a PINN is, of course, a neural network, and its architecture dictates its expressive power and computational cost. This practice problem moves from the physics to the model itself, asking you to perform a fundamental calculation: determining the number of trainable parameters in a typical PINN architecture used for combustion problems. Understanding how to quantify a model's size is a critical first step in designing efficient networks and anticipating training requirements .",
            "id": "4049974",
            "problem": "Consider a Physics-Informed Neural Network (PINN) designed to approximate reacting-flow fields in computational combustion under a low-Mach, constant-pressure assumption. The network receives as inputs the spatial coordinates, time, pressure, and equivalence ratio, assembled into the feature vector $\\mathbf{x} = (x, y, z, t, p, \\phi)$ of dimension $d_{\\mathrm{in}} = 6$. The outputs are the temperature field $T(\\mathbf{x})$ and the species mass fractions $\\{Y_i(\\mathbf{x})\\}_{i=1}^{N_s}$ for $N_s = 9$ chemical species. The network uses a shared trunk with species-specific heads and a distinct head for temperature. The architecture is specified as follows:\n\n- Shared trunk: a fully connected Multi-Layer Perceptron (MLP) with three hidden layers of widths $64$, $64$, and $64$, followed by a latent output layer of width $128$. Thus the trunk consists of linear mappings $6 \\to 64$, $64 \\to 64$, $64 \\to 64$, and $64 \\to 128$ in sequence. All linear layers include biases, and the activation functions are parameter-free.\n- Temperature head: a fully connected head mapping the trunk latent vector of width $128$ to the scalar $T$, with two hidden layers of widths $64$ and $32$, followed by an output layer. Thus the temperature head consists of linear mappings $128 \\to 64$, $64 \\to 32$, and $32 \\to 1$, with biases in every linear layer.\n- Species heads: there are $N_s = 9$ species-specific heads, each mapping the trunk latent vector of width $128$ to a scalar $Y_i$ with one hidden layer of width $32$, followed by an output layer. Each species head consists of linear mappings $128 \\to 32$ and $32 \\to 1$, with biases in every linear layer. All $N_s$ heads have identical architectures but distinct parameters.\n\nAssume there are no additional parameterized layers (for example, no batch normalization or residual parameterizations), and that activation functions and any physics operators used in the loss (governing equation residuals, boundary conditions, and integral constraints) introduce no trainable parameters. Compute the total number of trainable parameters in this PINN, counting all weights and biases across the shared trunk and all heads.\n\nExpress your final answer as a single integer. No rounding is required, and no physical units apply.",
            "solution": "The problem requires the calculation of the total number of trainable parameters in a specified Physics-Informed Neural Network (PINN). Trainable parameters in a standard Multi-Layer Perceptron (MLP) consist of weights and biases. For a fully connected linear layer that maps an input of dimension $n_{\\text{in}}$ to an output of dimension $n_{\\text{out}}$, the number of weights is given by the product $n_{\\text{in}} \\times n_{\\text{out}}$, and the number of biases is $n_{\\text{out}}$, as each output neuron has a single bias term. Thus, the total number of parameters for such a layer is $(n_{\\text{in}} \\times n_{\\text{out}}) + n_{\\text{out}}$.\n\nThe network architecture is comprised of three distinct components: a shared trunk, a single temperature head, and $N_s = 9$ species-specific heads. We will calculate the number of parameters for each component sequentially and then sum them to find the total.\n\nLet $N_{\\text{params}}$ denote the number of trainable parameters.\n\n1.  **Shared Trunk Parameters**\n    The shared trunk processes the input vector $\\mathbf{x}$ of dimension $d_{\\text{in}} = 6$. It consists of four sequential fully connected layers.\n    -   Layer $1$: Maps from an input dimension of $n_{\\text{in}} = 6$ to an output dimension of $n_{\\text{out}} = 64$.\n        $N_{\\text{trunk},1} = (6 \\times 64) + 64 = 384 + 64 = 448$.\n    -   Layer $2$: Maps from an input dimension of $n_{\\text{in}} = 64$ to an output dimension of $n_{\\text{out}} = 64$.\n        $N_{\\text{trunk},2} = (64 \\times 64) + 64 = 4096 + 64 = 4160$.\n    -   Layer $3$: Maps from an input dimension of $n_{\\text{in}} = 64$ to an output dimension of $n_{\\text{out}} = 64$.\n        $N_{\\text{trunk},3} = (64 \\times 64) + 64 = 4096 + 64 = 4160$.\n    -   Layer $4$ (latent output layer): Maps from an input dimension of $n_{\\text{in}} = 64$ to an output dimension of $n_{\\text{out}} = 128$.\n        $N_{\\text{trunk},4} = (64 \\times 128) + 128 = 8192 + 128 = 8320$.\n\n    The total number of parameters in the shared trunk, $N_{\\text{trunk}}$, is the sum of the parameters in its layers:\n    $$N_{\\text{trunk}} = N_{\\text{trunk},1} + N_{\\text{trunk},2} + N_{\\text{trunk},3} + N_{\\text{trunk},4} = 448 + 4160 + 4160 + 8320 = 17088$$\n\n2.  **Temperature Head Parameters**\n    The temperature head takes the $128$-dimensional latent vector from the trunk as its input. It has three fully connected layers.\n    -   Layer $1$: Maps from an input dimension of $n_{\\text{in}} = 128$ to an output dimension of $n_{\\text{out}} = 64$.\n        $N_{T,1} = (128 \\times 64) + 64 = 8192 + 64 = 8256$.\n    -   Layer $2$: Maps from an input dimension of $n_{\\text{in}} = 64$ to an output dimension of $n_{\\text{out}} = 32$.\n        $N_{T,2} = (64 \\times 32) + 32 = 2048 + 32 = 2080$.\n    -   Layer $3$ (output layer): Maps from an input dimension of $n_{\\text{in}} = 32$ to a scalar output of dimension $n_{\\text{out}} = 1$.\n        $N_{T,3} = (32 \\times 1) + 1 = 32 + 1 = 33$.\n\n    The total number of parameters in the temperature head, $N_{T}$, is the sum:\n    $$N_{T} = N_{T,1} + N_{T,2} + N_{T,3} = 8256 + 2080 + 33 = 10369$$\n\n3.  **Species Heads Parameters**\n    There are $N_s = 9$ species-specific heads. Each head has an identical architecture but distinct parameters. Each head takes the $128$-dimensional latent vector from the trunk as its input and consists of two fully connected layers. We first find the parameters for a single species head, $N_{Y_i}$.\n    -   Layer $1$: Maps from an input dimension of $n_{\\text{in}} = 128$ to an output dimension of $n_{\\text{out}} = 32$.\n        $N_{Y_i,1} = (128 \\times 32) + 32 = 4096 + 32 = 4128$.\n    -   Layer $2$ (output layer): Maps from an input dimension of $n_{\\text{in}} = 32$ to a scalar output of dimension $n_{\\text{out}} = 1$.\n        $N_{Y_i,2} = (32 \\times 1) + 1 = 32 + 1 = 33$.\n\n    The total number of parameters for a single species head is:\n    $$N_{Y_i} = N_{Y_i,1} + N_{Y_i,2} = 4128 + 33 = 4161$$\n    Since there are $N_s = 9$ such heads, the total number of parameters for all species heads, $N_{\\text{species}}$, is:\n    $$N_{\\text{species}} = N_s \\times N_{Y_i} = 9 \\times 4161 = 37449$$\n\n4.  **Total Network Parameters**\n    The total number of trainable parameters in the entire PINN, $N_{\\text{total}}$, is the sum of the parameters from the trunk, the temperature head, and all species heads.\n    $$N_{\\text{total}} = N_{\\text{trunk}} + N_{T} + N_{\\text{species}}$$\n    $$N_{\\text{total}} = 17088 + 10369 + 37449$$\n    $$N_{\\text{total}} = 64906$$",
            "answer": "$$\\boxed{64906}$$"
        },
        {
            "introduction": "Once a PINN is trained, how can we be sure it has correctly learned to solve the governing equations? This final exercise introduces a powerful and standard technique for code verification known as the Method of Manufactured Solutions (MMS). By implementing an MMS test, you will learn how to systematically create a benchmark problem to rigorously check if a model's predictions satisfy the physics, providing a crucial tool for debugging, validation, and building confidence in your PINN solvers .",
            "id": "4050020",
            "problem": "Consider the one-dimensional, steady, constant-property conservation equations for temperature and species mass fractions appropriate to computational combustion. Let $x \\in [0,1]$ be the spatial coordinate in meters. Assume constant density $\\rho$ (kilograms per cubic meter), constant thermal conductivity $k_t$ (watts per meter-kelvin), constant species diffusivities $D_k$ (square meters per second), and constant species specific enthalpies $h_k$ (joules per kilogram). The governing equations are:\n\nEnergy conservation:\n$$ k_t \\frac{d^2 T}{dx^2} + \\sum_{k=1}^K h_k \\, \\omega_k(x) + q_{\\text{ext}}(x) = 0, $$\n\nSpecies conservation for each species $k \\in \\{1,\\dots,K\\}$:\n$$ \\rho D_k \\frac{d^2 Y_k}{dx^2} + \\omega_k(x) = 0. $$\n\nHere, $T(x)$ is the temperature in kelvin, $Y_k(x)$ are species mass fractions (dimensionless), $\\omega_k(x)$ are reaction source terms in kilograms per cubic meter per second, and $q_{\\text{ext}}(x)$ is an external heat source in watts per cubic meter. Boundary conditions are Dirichlet at $x=0$ and $x=1$ for both $T$ and $Y_k$.\n\nThe Method of Manufactured Solutions (MMS) prescribes analytic fields $T_{\\text{true}}(x)$ and $Y_{k,\\text{true}}(x)$ and then computes source terms so that these fields exactly satisfy the governing equations. Specifically, define\n$$ \\omega_k(x) = - \\rho D_k \\frac{d^2 Y_{k,\\text{true}}}{dx^2}, \\qquad q_{\\text{ext}}(x) = - k_t \\frac{d^2 T_{\\text{true}}}{dx^2} - \\sum_{k=1}^K h_k \\, \\omega_k(x). $$\nA Physics-Informed Neural Network (PINN) is expected to recover the manufactured fields by minimizing residuals of the governing equations and boundary conditions. To verify, validate, and estimate error, we define predicted fields as $T_{\\text{pred}}(x)$ and $Y_{k,\\text{pred}}(x)$, compute residuals, and quantify error norms.\n\nDefine the Physics-Informed Neural Network (PINN) residuals for the energy and species equations, evaluated at $N$ uniformly spaced collocation points $\\{x_i\\}_{i=1}^N$ in $[0,1]$, as\n$$ r_T(x_i) = k_t \\frac{d^2 T_{\\text{pred}}}{dx^2}(x_i) + \\sum_{k=1}^K h_k \\, \\omega_k(x_i) + q_{\\text{ext}}(x_i), $$\n$$ r_{Y_k}(x_i) = \\rho D_k \\frac{d^2 Y_{k,\\text{pred}}}{dx^2}(x_i) + \\omega_k(x_i). $$\nDefine the normalized $L_2$ residual norms:\n$$ \\| r_T \\|_{L_2} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left[r_T(x_i)\\right]^2}, \\qquad \\| r_{Y_k} \\|_{L_2} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} \\left[r_{Y_k}(x_i)\\right]^2}. $$\nDefine boundary condition mismatch norms using the values at the endpoints:\n$$ \\mathrm{BC}_T = \\sqrt{\\frac{1}{2} \\left( \\left[T_{\\text{pred}}(0) - T_{\\text{true}}(0)\\right]^2 + \\left[T_{\\text{pred}}(1) - T_{\\text{true}}(1)\\right]^2 \\right)}, $$\n$$ \\mathrm{BC}_{Y_k} = \\sqrt{\\frac{1}{2} \\left( \\left[Y_{k,\\text{pred}}(0) - Y_{k,\\text{true}}(0)\\right]^2 + \\left[Y_{k,\\text{pred}}(1) - Y_{k,\\text{true}}(1)\\right]^2 \\right)}. $$\n\nYour task is to implement a self-contained program that performs manufactured solution tests by prescribing analytic $T_{\\text{true}}(x)$ and $Y_{k,\\text{true}}(x)$, constructing $\\omega_k(x)$ and $q_{\\text{ext}}(x)$ accordingly, and then quantifying the Physics-Informed Neural Network (PINN) residual norms and boundary mismatch norms for a set of test cases. The PINN \"predicted\" fields will be taken as the manufactured fields plus known analytic perturbations that emulate approximation error.\n\nUnits:\n- Report $\\| r_T \\|_{L_2}$ in watts per cubic meter.\n- Report each $\\| r_{Y_k} \\|_{L_2}$ in kilograms per cubic meter per second.\n- Report $\\mathrm{BC}_T$ in kelvin.\n- Report each $\\mathrm{BC}_{Y_k}$ as dimensionless.\n\nUse $N=200$ collocation points uniformly spaced in $[0,1]$ for all test cases.\n\nTest Suite:\n- Test Case 1 (Happy path, no perturbations, single species):\n  - $K=1$,\n  - $\\rho = 1.0 \\, \\mathrm{kg} \\, \\mathrm{m}^{-3}$, $k_t = 0.1 \\, \\mathrm{W} \\, \\mathrm{m}^{-1} \\, \\mathrm{K}^{-1}$,\n  - $D_1 = 1.0 \\times 10^{-5} \\, \\mathrm{m}^2 \\, \\mathrm{s}^{-1}$, $h_1 = -1.0 \\times 10^{6} \\, \\mathrm{J} \\, \\mathrm{kg}^{-1}$,\n  - $T_{\\text{true}}(x) = 300 + 10 x + 5 \\sin(2 \\pi x)$, $Y_{1,\\text{true}}(x) = 0.2 + 0.1 x + 0.05 \\cos(\\pi x)$,\n  - Predicted fields equal manufactured fields: $T_{\\text{pred}} = T_{\\text{true}}$, $Y_{1,\\text{pred}} = Y_{1,\\text{true}}$.\n- Test Case 2 (Perturbed interior, boundary preserved, single species):\n  - $K=1$,\n  - $\\rho = 1.2 \\, \\mathrm{kg} \\, \\mathrm{m}^{-3}$, $k_t = 0.08 \\, \\mathrm{W} \\, \\mathrm{m}^{-1} \\, \\mathrm{K}^{-1}$,\n  - $D_1 = 2.0 \\times 10^{-5} \\, \\mathrm{m}^2 \\, \\mathrm{s}^{-1}$, $h_1 = -8.0 \\times 10^{5} \\, \\mathrm{J} \\, \\mathrm{kg}^{-1}$,\n  - $T_{\\text{true}}(x) = 290 + 15 x + 3 \\sin(2 \\pi x)$, $Y_{1,\\text{true}}(x) = 0.25 + 0.05 x + 0.02 \\cos(2 \\pi x)$,\n  - Predicted perturbations: $T_{\\text{pred}}(x) = T_{\\text{true}}(x) + \\epsilon_T \\sin(13 \\pi x)$ with $\\epsilon_T = 0.1$ (kelvin), $Y_{1,\\text{pred}}(x) = Y_{1,\\text{true}}(x) + \\epsilon_{Y_1} \\sin(11 \\pi x)$ with $\\epsilon_{Y_1} = 1.0 \\times 10^{-4}$ (dimensionless). These perturbations vanish at $x=0$ and $x=1$, so boundary conditions are preserved.\n- Test Case 3 (Boundary-mismatched perturbations, two species):\n  - $K=2$,\n  - $\\rho = 0.9 \\, \\mathrm{kg} \\, \\mathrm{m}^{-3}$, $k_t = 0.12 \\, \\mathrm{W} \\, \\mathrm{m}^{-1} \\, \\mathrm{K}^{-1}$,\n  - $D_1 = 1.0 \\times 10^{-5} \\, \\mathrm{m}^2 \\, \\mathrm{s}^{-1}$, $D_2 = 5.0 \\times 10^{-6} \\, \\mathrm{m}^2 \\, \\mathrm{s}^{-1}$,\n  - $h_1 = -8.0 \\times 10^{5} \\, \\mathrm{J} \\, \\mathrm{kg}^{-1}$, $h_2 = -1.2 \\times 10^{6} \\, \\mathrm{J} \\, \\mathrm{kg}^{-1}$,\n  - $T_{\\text{true}}(x) = 1200 + 100 x - 20 x^2$, $Y_{1,\\text{true}}(x) = 0.7 - 0.1 x + 0.02 \\sin(2 \\pi x)$, $Y_{2,\\text{true}}(x) = 0.3 + 0.05 x + 0.01 \\sin(\\pi x)$,\n  - Predicted perturbations: $T_{\\text{pred}}(x) = T_{\\text{true}}(x) + \\epsilon_T \\cos(\\pi x)$ with $\\epsilon_T = 0.5$ (kelvin), $Y_{1,\\text{pred}}(x) = Y_{1,\\text{true}}(x) + \\epsilon_{Y_1} \\cos(\\pi x)$ with $\\epsilon_{Y_1} = 1.0 \\times 10^{-3}$, $Y_{2,\\text{pred}}(x) = Y_{2,\\text{true}}(x) + \\epsilon_{Y_2} \\cos(\\pi x)$ with $\\epsilon_{Y_2} = 5.0 \\times 10^{-4}$. These perturbations do not vanish at $x=0$ and $x=1$, so boundary conditions are violated.\n\nYour program must:\n1. For each test case, construct $\\omega_k(x)$ and $q_{\\text{ext}}(x)$ from the manufactured fields $T_{\\text{true}}$ and $Y_{k,\\text{true}}$ using the equations above.\n2. Evaluate residuals $r_T(x_i)$ and $r_{Y_k}(x_i)$ at $N=200$ collocation points and compute the normalized $L_2$ norms. Report $\\| r_T \\|_{L_2}$ in watts per cubic meter and each $\\| r_{Y_k} \\|_{L_2}$ in kilograms per cubic meter per second.\n3. Compute boundary mismatch norms $\\mathrm{BC}_T$ (kelvin) and each $\\mathrm{BC}_{Y_k}$ (dimensionless).\n4. Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a list of the form $[ \\| r_T \\|_{L_2}, [\\| r_{Y_1} \\|_{L_2}, \\dots], \\mathrm{BC}_T, [\\mathrm{BC}_{Y_1}, \\dots] ]$. The final output should therefore be a single list containing three elements (one per test case), for example: \"[[rT1,[rY11],bcT1,[bcY11]],[[rT2,[rY21],bcT2,[bcY21]],[[rT3,[rY31,rY32],bcT3,[bcY31,bcY32]]]\". Ensure no spaces appear in the printed output.\n\nAll quantities must be handled in their specified units. Angles inside trigonometric functions are radians. The program must be self-contained and require no input.",
            "solution": "The user has provided a problem that requires the computation of residuals and boundary condition mismatches for a Physics-Informed Neural Network (PINN) verification test using the Method of Manufactured Solutions (MMS) in the context of one-dimensional, steady-state combustion. The problem is well-defined, scientifically sound, and internally consistent.\n\nThe core of the problem involves substituting manufactured analytical solutions into the governing differential equations to define source terms, and then computing the residuals that arise when a perturbed \"predicted\" solution is used instead.\n\nThe governing equations are:\nEnergy: $k_t \\frac{d^2 T}{dx^2} + \\sum_{k=1}^K h_k \\omega_k(x) + q_{\\text{ext}}(x) = 0$\nSpecies: $\\rho D_k \\frac{d^2 Y_k}{dx^2} + \\omega_k(x) = 0$\n\nThe MMS defines the source terms $\\omega_k(x)$ and $q_{\\text{ext}}(x)$ such that the \"true\" manufactured fields, $T_{\\text{true}}(x)$ and $Y_{k,\\text{true}}(x)$, are exact solutions.\nFrom the species equation:\n$$ \\omega_k(x) = - \\rho D_k \\frac{d^2 Y_{k,\\text{true}}}{dx^2} $$\nFrom the energy equation:\n$$ q_{\\text{ext}}(x) = - k_t \\frac{d^2 T_{\\text{true}}}{dx^2} - \\sum_{k=1}^K h_k \\omega_k(x) $$\n\nThe PINN residuals are calculated using the \"predicted\" fields, $T_{\\text{pred}}(x)$ and $Y_{k,\\text{pred}}(x)$, along with the manufactured source terms:\n$$ r_T(x) = k_t \\frac{d^2 T_{\\text{pred}}}{dx^2} + \\sum_{k=1}^K h_k \\omega_k(x) + q_{\\text{ext}}(x) $$\n$$ r_{Y_k}(x) = \\rho D_k \\frac{d^2 Y_{k,\\text{pred}}}{dx^2} + \\omega_k(x) $$\nA crucial step is to substitute the expressions for the manufactured source terms into the residual equations. This simplification reveals the underlying structure of the MMS test.\n\nFor the species residual $r_{Y_k}(x)$:\n$$ r_{Y_k}(x) = \\rho D_k \\frac{d^2 Y_{k,\\text{pred}}}{dx^2} + \\left( - \\rho D_k \\frac{d^2 Y_{k,\\text{true}}}{dx^2} \\right) = \\rho D_k \\left( \\frac{d^2 Y_{k,\\text{pred}}}{dx^2} - \\frac{d^2 Y_{k,\\text{true}}}{dx^2} \\right) $$\nLet the prediction error be $\\delta Y_k(x) = Y_{k,\\text{pred}}(x) - Y_{k,\\text{true}}(x)$. The residual simplifies to:\n$$ r_{Y_k}(x) = \\rho D_k \\frac{d^2 (\\delta Y_k)}{dx^2} $$\n\nFor the energy residual $r_T(x)$:\n$$ r_T(x) = k_t \\frac{d^2 T_{\\text{pred}}}{dx^2} + \\sum_{k=1}^K h_k \\omega_k(x) + \\left( - k_t \\frac{d^2 T_{\\text{true}}}{dx^2} - \\sum_{k=1}^K h_k \\omega_k(x) \\right) = k_t \\left( \\frac{d^2 T_{\\text{pred}}}{dx^2} - \\frac{d^2 T_{\\text{true}}}{dx^2} \\right) $$\nLet the prediction error be $\\delta T(x) = T_{\\text{pred}}(x) - T_{\\text{true}}(x)$. The residual simplifies to:\n$$ r_T(x) = k_t \\frac{d^2 (\\delta T)}{dx^2} $$\n\nThe implementation will proceed by calculating the analytical second derivatives of the error functions ($\\delta T$, $\\delta Y_k$) for each test case, evaluating the residuals at $N=200$ collocation points, and then computing the specified $L_2$ norms. The boundary condition mismatches are computed directly from the error functions at $x=0$ and $x=1$.\n\nThe analytical derivatives of the error functions are:\n**Test Case 1:**\n- $\\delta T(x) = 0$, $\\delta Y_1(x) = 0$.\n- $\\frac{d^2(\\delta T)}{dx^2} = 0$, $\\frac{d^2(\\delta Y_1)}{dx^2} = 0$.\n- Thus, all residuals and boundary mismatches are $0$.\n\n**Test Case 2:**\n- $\\delta T(x) = \\epsilon_T \\sin(13 \\pi x)$, with $\\epsilon_T = 0.1$.\n- $\\frac{d^2(\\delta T)}{dx^2} = - \\epsilon_T (13\\pi)^2 \\sin(13 \\pi x) = -169 \\pi^2 \\epsilon_T \\sin(13 \\pi x)$.\n- $\\delta Y_1(x) = \\epsilon_{Y_1} \\sin(11 \\pi x)$, with $\\epsilon_{Y_1} = 10^{-4}$.\n- $\\frac{d^2(\\delta Y_1)}{dx^2} = - \\epsilon_{Y_1} (11\\pi)^2 \\sin(11 \\pi x) = -121 \\pi^2 \\epsilon_{Y_1} \\sin(11 \\pi x)$.\n- At the boundaries, $\\sin(n\\pi x)$ for integer $n$ is $0$ at $x=0$ and $x=1$. Thus, boundary mismatches $\\mathrm{BC}_T$ and $\\mathrm{BC}_{Y_1}$ are $0$.\n\n**Test Case 3:**\n- $\\delta T(x) = \\epsilon_T \\cos(\\pi x)$, with $\\epsilon_T = 0.5$.\n- $\\frac{d^2(\\delta T)}{dx^2} = - \\epsilon_T \\pi^2 \\cos(\\pi x)$.\n- $\\delta Y_1(x) = \\epsilon_{Y_1} \\cos(\\pi x)$, with $\\epsilon_{Y_1} = 10^{-3}$.\n- $\\frac{d^2(\\delta Y_1)}{dx^2} = - \\epsilon_{Y_1} \\pi^2 \\cos(\\pi x)$.\n- $\\delta Y_2(x) = \\epsilon_{Y_2} \\cos(\\pi x)$, with $\\epsilon_{Y_2} = 5 \\times 10^{-4}$.\n- $\\frac{d^2(\\delta Y_2)}{dx^2} = - \\epsilon_{Y_2} \\pi^2 \\cos(\\pi x)$.\n- At the boundaries, $\\delta(x) = \\epsilon \\cos(\\pi x)$ gives $\\delta(0) = \\epsilon$ and $\\delta(1) = -\\epsilon$.\n- The boundary mismatch norm is $\\sqrt{\\frac{1}{2}(\\epsilon^2 + (-\\epsilon)^2)} = |\\epsilon|$.\n- Thus, $\\mathrm{BC}_T = |\\epsilon_T| = 0.5$, $\\mathrm{BC}_{Y_1} = |\\epsilon_{Y_1}| = 0.001$, and $\\mathrm{BC}_{Y_2} = |\\epsilon_{Y_2}| = 0.0005$.\n\nThe program will implement these calculations for each test case, assemble the results in the specified list-of-lists structure, and print the final formatted string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_case_1(x_grid, pi):\n    \"\"\"\n    Calculates results for Test Case 1.\n    \"\"\"\n    # Parameters\n    # K = 1\n    # rho = 1.0\n    # kt = 0.1\n    # D1 = 1.0e-5\n    # h1 = -1.0e6\n\n    # Perturbations are zero\n    # delta_T(x) = 0, delta_Y1(x) = 0\n    # The derivatives are also zero.\n    \n    # Residuals are zero\n    rT_L2 = 0.0\n    rY1_L2 = 0.0\n    \n    # Boundary mismatches are zero\n    bcT = 0.0\n    bcY1 = 0.0\n    \n    return [rT_L2, [rY1_L2], bcT, [bcY1]]\n\ndef calculate_case_2(x_grid, pi):\n    \"\"\"\n    Calculates results for Test Case 2.\n    \"\"\"\n    # Parameters\n    # K = 1\n    rho = 1.2\n    kt = 0.08\n    D1 = 2.0e-5\n    # h1 = -8.0e5\n    eps_T = 0.1\n    eps_Y1 = 1.0e-4\n\n    # Calculate residuals\n    # r_T(x) = kt * d^2(delta_T)/dx^2\n    # delta_T(x) = eps_T * sin(13*pi*x)\n    # d^2(delta_T)/dx^2 = -eps_T * (13*pi)^2 * sin(13*pi*x)\n    d2_delta_T_dx2 = -eps_T * (13 * pi)**2 * np.sin(13 * pi * x_grid)\n    rT_values = kt * d2_delta_T_dx2\n    rT_L2 = np.sqrt(np.mean(rT_values**2))\n\n    # r_Y1(x) = rho * D1 * d^2(delta_Y1)/dx^2\n    # delta_Y1(x) = eps_Y1 * sin(11*pi*x)\n    # d^2(delta_Y1)/dx^2 = -eps_Y1 * (11*pi)^2 * sin(11*pi*x)\n    d2_delta_Y1_dx2 = -eps_Y1 * (11 * pi)**2 * np.sin(11 * pi * x_grid)\n    rY1_values = rho * D1 * d2_delta_Y1_dx2\n    rY1_L2 = np.sqrt(np.mean(rY1_values**2))\n    \n    # Calculate boundary mismatches\n    # delta_T(x) = eps_T * sin(13*pi*x)\n    delta_T_at_0 = 0.0  # sin(0)\n    delta_T_at_1 = 0.0  # sin(13*pi)\n    bcT = np.sqrt(0.5 * (delta_T_at_0**2 + delta_T_at_1**2))\n    \n    # delta_Y1(x) = eps_Y1 * sin(11*pi*x)\n    delta_Y1_at_0 = 0.0  # sin(0)\n    delta_Y1_at_1 = 0.0  # sin(11*pi)\n    bcY1 = np.sqrt(0.5 * (delta_Y1_at_0**2 + delta_Y1_at_1**2))\n    \n    return [rT_L2, [rY1_L2], bcT, [bcY1]]\n    \ndef calculate_case_3(x_grid, pi):\n    \"\"\"\n    Calculates results for Test Case 3.\n    \"\"\"\n    # Parameters\n    # K = 2\n    rho = 0.9\n    kt = 0.12\n    D = [1.0e-5, 5.0e-6]\n    # h = [-8.0e5, -1.2e6]\n    eps_T = 0.5\n    eps_Y = [1.0e-3, 5.0e-4]\n\n    # Calculate temperature residual\n    # delta_T(x) = eps_T * cos(pi*x)\n    # d^2(delta_T)/dx^2 = -eps_T * pi^2 * cos(pi*x)\n    d2_delta_T_dx2 = -eps_T * pi**2 * np.cos(pi * x_grid)\n    rT_values = kt * d2_delta_T_dx2\n    rT_L2 = np.sqrt(np.mean(rT_values**2))\n\n    # Calculate species residuals\n    rY_L2_list = []\n    # All species have same perturbation form: delta_Y_k(x) = eps_Yk * cos(pi*x)\n    d2_delta_Y_common_part_dx2 = -pi**2 * np.cos(pi * x_grid)\n    for k in range(2):\n        d2_delta_Yk_dx2 = eps_Y[k] * d2_delta_Y_common_part_dx2\n        rYk_values = rho * D[k] * d2_delta_Yk_dx2\n        rYk_L2 = np.sqrt(np.mean(rYk_values**2))\n        rY_L2_list.append(rYk_L2)\n\n    # Calculate boundary mismatches\n    # For a perturbation delta(x) = epsilon * cos(pi*x), the BC norm is |epsilon|\n    bcT = np.abs(eps_T)\n    bcY_list = [np.abs(eps_Y[k]) for k in range(2)]\n    \n    return [rT_L2, rY_L2_list, bcT, bcY_list]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define common parameters\n    N = 200\n    x_grid = np.linspace(0.0, 1.0, N)\n    pi = np.pi\n\n    # Run all test cases\n    results = [\n        calculate_case_1(x_grid, pi),\n        calculate_case_2(x_grid, pi),\n        calculate_case_3(x_grid, pi)\n    ]\n\n    # Format the output string as specified\n    # Convert list of lists to string, then remove spaces\n    output_str = ','.join(map(str, results))\n    final_output_str = f\"[{output_str}]\".replace(\" \", \"\")\n\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}