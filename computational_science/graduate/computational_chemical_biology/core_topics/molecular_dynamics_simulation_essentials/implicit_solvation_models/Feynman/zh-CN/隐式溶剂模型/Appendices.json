{
    "hands_on_practices": [
        {
            "introduction": "掌握隐式溶剂模型的第一步是理解其物理基础。本练习将引导你从第一性原理出发，推导Born模型——连续介质静电学理论的基石。通过这个推导过程，你将亲身体验溶剂的介电特性如何稳定离子，并深刻理解Born半径这一关键参数的物理意义。",
            "id": "2778777",
            "problem": "在一个相对介电常数（介电常数）为 $\\epsilon$ 的原本均匀、各向同性、线性的电介质连续体中，挖出一个半径为 $R$ 的球形空腔。一个电荷为 $q$ 的点离子被放置在空腔的中心。假设空腔内部是类真空的，其相对介电常数为 $\\epsilon_{\\mathrm{in}} = 1$，而外部介质的相对介电常数为 $\\epsilon_{\\mathrm{out}} = \\epsilon$。在高斯静电单位制（也称为厘米-克-秒静电单位制）下进行计算，在该单位制中，库仑定律为 $F = q_{1} q_{2} / r^{2}$，电位移场满足 $\\nabla \\cdot \\mathbf{D} = 4 \\pi \\rho_{\\mathrm{free}}$，线性电介质的能量密度为 $u = \\mathbf{E} \\cdot \\mathbf{D} / (8 \\pi)$。\n\n仅从这些静电学定律以及将平面界面上的标准边界条件（在没有自由表面电荷的情况下，电场的切向分量连续和电位移场的法向分量连续）局域地应用于球面的条件出发，推导在电介质环境中将离子从 0 充电到 $q$ 所做的可逆功，减去在真空中相应的可逆功。将所得结果解释为隐式溶剂化模型中的溶剂化（极化）自由能。\n\n你的推导必须：\n- 使用高斯定律和 $r=R$ 处的边界条件，求解空腔内外的球对称电场。\n- 通过对空间积分相应的能量密度，计算电介质系统和真空参考系统的总静电能，并以一种在 $r=0$ 处不引入任何人为截断而能得到有限结果的方式，计算它们的差值。\n- 将最终的溶剂化自由能 $\\Delta G_{\\mathrm{solv}}$ 表示为用 $q$、$\\epsilon$ 和 $R$ 表示的、在高斯静电单位制下的闭式解析表达式。\n\n最后，根据你的推导，在隐式溶剂化模型的背景下，简要解释表达式中出现的参数 $R$ 的物理解释。\n\n将你的最终答案报告为 $\\Delta G_{\\mathrm{solv}}$ 的单个闭式解析表达式。不要在最终答案框中包含任何单位。",
            "solution": "该系统是径向对称的，在原点有一个点电荷 $q$，内部区域 $0 < r < R$ 的相对介电常数为 $\\epsilon_{\\mathrm{in}} = 1$，外部区域 $r > R$ 的相对介电常数为 $\\epsilon_{\\mathrm{out}} = \\epsilon$。在高斯静电单位制中，电位移场 $\\mathbf{D}$ 和电场 $\\mathbf{E}$ 的关系为 $\\mathbf{D} = \\epsilon \\mathbf{E}$，高斯定律为 $\\nabla \\cdot \\mathbf{D} = 4 \\pi \\rho_{\\mathrm{free}}$。\n\n首先，确定每个区域的电场。根据球对称性，应用高斯定律于一个半径为 $r$ 的球面，得到电位移场在所有 $r>0$ 处的大小为 $D(r) = q/r^2$。因此，电场为：\n-   空腔内部 ($r < R$): $\\epsilon_{\\mathrm{in}}=1$, $E_{\\mathrm{in}}(r) = D(r) / \\epsilon_{\\mathrm{in}} = q/r^2$。\n-   介质外部 ($r > R$): $\\epsilon_{\\mathrm{out}}=\\epsilon$, $E_{\\mathrm{out}}(r) = D(r) / \\epsilon_{\\mathrm{out}} = q/(\\epsilon r^2)$。\n\n溶剂化自由能 $\\Delta G_{\\mathrm{solv}}$ 是离子在电介质中与在真空中的总静电能之差。在真空中，电场在所有地方都是 $E_0(r) = q/r^2$。\n$$\n\\Delta G_{\\mathrm{solv}} = U(\\epsilon) - U(1)\n$$\n总能量是通过对能量密度 $u = \\mathbf{E} \\cdot \\mathbf{D} / (8 \\pi)$ 在整个空间积分得到的。虽然总能量是发散的，但其差值是有限的。在空腔内部（$r < R$），电介质系统和真空参考系统的电场完全相同（$E = q/r^2$），因此它们对能量的贡献在相减时会抵消。我们只需计算空腔外部（$r > R$）的能量差：\n$$\n\\Delta G_{\\mathrm{solv}} = \\int_{r>R} \\left( u(\\epsilon) - u(1) \\right) dV = \\int_{R}^{\\infty} \\left( \\frac{\\mathbf{E}_{\\mathrm{out}} \\cdot \\mathbf{D}_{\\mathrm{out}}}{8\\pi} - \\frac{\\mathbf{E}_{0} \\cdot \\mathbf{D}_{0}}{8\\pi} \\right) 4\\pi r^2 dr\n$$\n代入相应的场表达式，其中 $\\mathbf{D}_{0} = \\mathbf{E}_{0}$：\n$$\n\\begin{aligned}\n\\Delta G_{\\mathrm{solv}} = \\int_{R}^{\\infty} \\frac{1}{2} \\left( E_{\\mathrm{out}}(r) D(r) - E_{0}(r) D_{0}(r) \\right) r^2 dr \\\\\n= \\frac{1}{2} \\int_{R}^{\\infty} \\left( \\left(\\frac{q}{\\epsilon r^2}\\right)\\left(\\frac{q}{r^2}\\right) - \\left(\\frac{q}{r^2}\\right)\\left(\\frac{q}{r^2}\\right) \\right) r^2 dr \\\\\n= \\frac{q^2}{2} \\int_{R}^{\\infty} \\left( \\frac{1}{\\epsilon r^4} - \\frac{1}{r^4} \\right) r^2 dr \\\\\n= \\frac{q^2}{2} \\left( \\frac{1}{\\epsilon} - 1 \\right) \\int_{R}^{\\infty} \\frac{1}{r^2} dr \\\\\n= \\frac{q^2}{2} \\left( \\frac{1}{\\epsilon} - 1 \\right) \\left[ -\\frac{1}{r} \\right]_{R}^{\\infty} \\\\\n= \\frac{q^2}{2} \\left( \\frac{1}{\\epsilon} - 1 \\right) \\left( \\frac{1}{R} \\right) = -\\frac{1}{2} \\left( 1 - \\frac{1}{\\epsilon} \\right) \\frac{q^2}{R}\n\\end{aligned}\n$$\n这就是玻恩模型的溶剂化自由能。在此模型中，$R$ 是“玻恩半径”，它代表了离子的有效半径，溶剂分子无法进入这个半径之内。",
            "answer": "$$\\boxed{-\\frac{1}{2}\\left(1-\\epsilon^{-1}\\right)\\frac{q^{2}}{R}}$$"
        },
        {
            "introduction": "Born模型为单个球形离子提供了精确解，但真实分子由多个原子构成。为了处理这种复杂性，广义Born (GB)模型应运而生，它是一种强大且高效的近似方法。本练习将让你动手计算一个三原子分子的GB溶剂化能，从而具体了解该模型是如何结合自身能与原子间相互作用项来估算总静电溶剂化自由能的。",
            "id": "3850165",
            "problem": "在连续介质静电学中，一个嵌入在低介电常数空腔中并被高介电常数溶剂包围的固定点电荷集合的静电溶剂化自由能可以用反应势来表示。对于球形空腔中电荷为 $q$ 的单个离子，经过充分检验的 Born 模型给出的自能为 $\\Delta G_{\\mathrm{Born}} = -\\frac{1}{2}\\left(1 - \\frac{1}{\\varepsilon}\\right) C \\frac{q^{2}}{\\alpha}$，其中 $\\varepsilon$ 是溶剂介电常数，$\\alpha$ 是有效 Born 半径，而 $C$ 是分子力学单位中的单位转换库仑常数。对于多体系统，广义 Born (GB) 近似通过用一个逐对相加的有效相互作用来代替精确的反应势，从而扩展了这一思想，该相互作用能正确地再现原子间距趋近于零和无穷大时的极限行为。\n\n考虑一个三原子溶质，其三个原子标记为 $i \\in \\{1,2,3\\}$，携带的固定点电荷分别为 $q_{1} = +0.5$、$q_{2} = -0.3$ 和 $q_{3} = +0.2$，均以基本电荷为单位。这些原子的有效 Born 半径分别为 $\\alpha_{1} = 1.6$ $\\mathrm{\\AA}$、$\\alpha_{2} = 1.4$ $\\mathrm{\\AA}$ 和 $\\alpha_{3} = 1.8$ $\\mathrm{\\AA}$。原子中心间距为 $r_{12} = 3.0$ $\\mathrm{\\AA}$、$r_{13} = 4.5$ $\\mathrm{\\AA}$ 和 $r_{23} = 2.8$ $\\mathrm{\\AA}$。假设溶质内部介电常数为 $\\varepsilon_{\\mathrm{in}} = 1.0$，溶剂介电常数为 $\\varepsilon = 78.3$（环境条件下的液态水）。使用标准的分子力学转换常数 $C = 332.0636$，单位为千卡/摩尔、埃和基本电荷，这样当 $r_{ij}$ 以埃为单位，$q_{i}$、$q_{j}$ 以基本电荷为单位时，计算出的库仑能量 $C \\frac{q_{i} q_{j}}{r_{ij}}$ 的单位为千卡/摩尔。\n\n使用指定的广义 Born 逐对泛函形式\n$$\nf_{\\mathrm{GB}}(r_{ij}, \\alpha_{i}, \\alpha_{j}) \\equiv \\sqrt{r_{ij}^{2} + \\alpha_{i}\\alpha_{j}\\,\\exp\\!\\left(-\\frac{r_{ij}^{2}}{4\\,\\alpha_{i}\\alpha_{j}}\\right)},\n$$\n并对于自能项取 $f_{\\mathrm{GB}}(0, \\alpha_{i}, \\alpha_{i}) = \\alpha_{i}$，计算溶剂化自由能的静电分量\n$$\n\\Delta G_{\\mathrm{elec}} = -\\frac{1}{2}\\left(1 - \\frac{1}{\\varepsilon}\\right) \\sum_{i=1}^{3}\\sum_{j=1}^{3} C\\,\\frac{q_{i} q_{j}}{f_{\\mathrm{GB}}(r_{ij}, \\alpha_{i}, \\alpha_{j})},\n$$\n其中当 $i=j$ 时，设 $r_{ii} = 0$。请将您的最终答案以千卡/摩尔为单位表示，并四舍五入到四位有效数字。",
            "solution": "溶剂化自由能的静电分量 $\\Delta G_{\\mathrm{elec}}$ 由下式给出：\n$$\n\\Delta G_{\\mathrm{elec}} = -\\frac{1}{2}\\left(1 - \\frac{1}{\\varepsilon}\\right) \\sum_{i=1}^{3}\\sum_{j=1}^{3} C\\,\\frac{q_{i} q_{j}}{f_{\\mathrm{GB}}(r_{ij}, \\alpha_{i}, \\alpha_{j})}\n$$\n计算可以分解为三个部分：计算有效相互作用距离 $f_{\\mathrm{GB}}$，计算求和，然后乘以预因子。\n\n**1. 计算有效距离 $f_{\\mathrm{GB}}(r_{ij}, \\alpha_{i}, \\alpha_{j})$**\n\n对于自能项（$i=j$），问题指定 $f_{\\mathrm{GB}}(0, \\alpha_i, \\alpha_i) = \\alpha_i$。\n$$\nf_{11} = \\alpha_1 = 1.6 \\, \\mathrm{\\AA} \\\\\nf_{22} = \\alpha_2 = 1.4 \\, \\mathrm{\\AA} \\\\\nf_{33} = \\alpha_3 = 1.8 \\, \\mathrm{\\AA}\n$$\n对于交叉项（$i \\neq j$），我们使用给定的泛函形式 $f_{\\mathrm{GB}}(r_{ij}, \\alpha_{i}, \\alpha_{j}) = \\sqrt{r_{ij}^{2} + \\alpha_{i}\\alpha_{j}\\,\\exp(-r_{ij}^{2}/(4\\,\\alpha_{i}\\alpha_{j}))}$。\n\n-   **原子对 (1,2)**: $r_{12}=3.0$, $\\alpha_1=1.6$, $\\alpha_2=1.4$。\n    $$\n    f_{12} = \\sqrt{(3.0)^2 + (1.6)(1.4)\\exp\\left(-\\frac{(3.0)^2}{4(1.6)(1.4)}\\right)} = \\sqrt{9.0 + 2.24\\exp\\left(-\\frac{9.0}{8.96}\\right)} \\approx 3.1337518 \\, \\mathrm{\\AA}\n    $$\n-   **原子对 (1,3)**: $r_{13}=4.5$, $\\alpha_1=1.6$, $\\alpha_3=1.8$。\n    $$\n    f_{13} = \\sqrt{(4.5)^2 + (1.6)(1.8)\\exp\\left(-\\frac{(4.5)^2}{4(1.6)(1.8)}\\right)} = \\sqrt{20.25 + 2.88\\exp\\left(-\\frac{20.25}{11.52}\\right)} \\approx 4.5548403 \\, \\mathrm{\\AA}\n    $$\n-   **原子对 (2,3)**: $r_{23}=2.8$, $\\alpha_2=1.4$, $\\alpha_3=1.8$。\n    $$\n    f_{23} = \\sqrt{(2.8)^2 + (1.4)(1.8)\\exp\\left(-\\frac{(2.8)^2}{4(1.4)(1.8)}\\right)} = \\sqrt{7.84 + 2.52\\exp\\left(-\\frac{7.84}{10.08}\\right)} \\approx 2.9996400 \\, \\mathrm{\\AA}\n    $$\n\n**2. 计算求和**\n\n设 $S' = \\sum_{i,j} \\frac{q_i q_j}{f_{ij}}$。由于对称性（$f_{ij}=f_{ji}$），我们可以将和写为：\n$$\nS' = \\frac{q_1^2}{f_{11}} + \\frac{q_2^2}{f_{22}} + \\frac{q_3^2}{f_{33}} + 2\\left(\\frac{q_1 q_2}{f_{12}} + \\frac{q_1 q_3}{f_{13}} + \\frac{q_2 q_3}{f_{23}}\\right)\n$$\n-   **自能项**:\n    $$\n    \\frac{q_1^2}{f_{11}} = \\frac{(0.5)^2}{1.6} = \\frac{0.25}{1.6} = 0.15625 \\\\\n    \\frac{q_2^2}{f_{22}} = \\frac{(-0.3)^2}{1.4} = \\frac{0.09}{1.4} \\approx 0.0642857 \\\\\n    \\frac{q_3^2}{f_{33}} = \\frac{(0.2)^2}{1.8} = \\frac{0.04}{1.8} \\approx 0.0222222\n    $$\n    自能项之和 $\\approx 0.15625 + 0.0642857 + 0.0222222 = 0.2427579$。\n-   **交叉项**:\n    $$\n    \\frac{q_1 q_2}{f_{12}} = \\frac{(0.5)(-0.3)}{3.1337518} = \\frac{-0.15}{3.1337518} \\approx -0.0478644 \\\\\n    \\frac{q_1 q_3}{f_{13}} = \\frac{(0.5)(0.2)}{4.5548403} = \\frac{0.10}{4.5548403} \\approx 0.0219545 \\\\\n    \\frac{q_2 q_3}{f_{23}} = \\frac{(-0.3)(0.2)}{2.9996400} = \\frac{-0.06}{2.9996400} \\approx -0.0200024\n    $$\n    当 $i   j$ 时交叉项之和为 $\\approx -0.0478644 + 0.0219545 - 0.0200024 = -0.0459123$。\n-   **总和 $S'$**:\n    $$\n    S' \\approx 0.2427579 + 2(-0.0459123) = 0.2427579 - 0.0918246 = 0.1509333 \\, e^2/\\mathrm{\\AA}\n    $$\n\n**3. $\\Delta G_{\\mathrm{elec}}$ 的最终计算**\n\n现在我们将所有部分组合起来：\n$$\n\\Delta G_{\\mathrm{elec}} = -\\frac{1}{2}\\left(1 - \\frac{1}{\\varepsilon}\\right) C S'\n$$\n代入数值：\n$$\n\\Delta G_{\\mathrm{elec}} = -\\frac{1}{2}\\left(1 - \\frac{1}{78.3}\\right) (332.0636 \\, \\text{kcal mol}^{-1} \\mathrm{\\AA} e^{-2}) (0.1509333 \\, e^2/\\mathrm{\\AA})\n$$\n$$\n\\Delta G_{\\mathrm{elec}} = -\\frac{1}{2}\\left(\\frac{77.3}{78.3}\\right) (332.0636) (0.1509333) \\, \\text{kcal/mol}\n$$\n$$\n\\Delta G_{\\mathrm{elec}} \\approx - (0.4936143) (50.11962) \\, \\text{kcal/mol}\n$$\n$$\n\\Delta G_{\\mathrm{elec}} \\approx -24.74395 \\, \\text{kcal/mol}\n$$\n题目要求将答案四舍五入到四位有效数字。\n$$\n\\Delta G_{\\mathrm{elec}} \\approx -24.74 \\, \\text{kcal/mol}\n$$",
            "answer": "$$\n\\boxed{-24.74}\n$$"
        },
        {
            "introduction": "虽然GB模型十分高效，但它终究是对更严格的Poisson-Boltzmann (PB)方程的近似。本练习将带你深入隐式溶剂模型的数值核心，通过编写一个简单的PB方程求解器来研究数值收敛性。完成这个练习后，你将能更好地理解离散化误差如何影响计算结果的准确性，这是评估和开发计算工具的一项关键技能。",
            "id": "3850091",
            "problem": "设计并实现一个数值收敛性研究，该研究针对一维空间中的线性化泊松-玻尔兹曼（PB）方程的隐式溶剂模型。从以下经过充分检验的基础开始：在静电学中，具有移动离子的介质中的电势 $\\phi$ 由线性化泊松-玻尔兹曼方程建模，其在有界域上的无量纲形式为 $- \\dfrac{d^2 \\phi}{dx^2} + \\kappa^2 \\phi = \\rho(x)$，其中 $\\kappa$ 是无量纲的逆德拜长度，$\\rho(x)$ 是无量纲的固定电荷密度。在区间 $x \\in [0,1]$ 上施加齐次 Dirichlet 边界条件 $\\phi(0) = 0$ 和 $\\phi(1) = 0$。考虑一个光滑的源项 $\\rho(x)$，它代表生物分子系统中的分布电荷；使用 $\\rho(x) = \\sin(\\pi x)$ 以确保物理真实性和数学光滑性。\n\n您的任务是：\n- 推导、实现并求解边界值问题 $- \\dfrac{d^2 \\phi}{dx^2} + \\kappa^2 \\phi = \\rho(x)$ 的有限差分格式。该求解在具有 $N$ 个等距区间的均匀网格（网格间距 $h = 1/N$）上进行，并施加齐次 Dirichlet 边界条件。离散系统应为三对角矩阵，并通过利用此结构的适当算法求解。\n- 随着 $N$ 的细化，为收敛性研究定义以下精度指标：\n  1. 最大范数误差 $L_{\\infty}$，计算为离散电势 $\\phi_N(x_i)$ 与高分辨率参考解 $\\phi_{\\text{ref}}(x_i)$ 之间的最大绝对差。两者均在粗网格点 $x_i$ 上求值，其中参考解通过插值得到。\n  2. $L_2$ 误差范数，计算为 $\\left(\\int_{0}^{1} |\\phi_N(x) - \\phi_{\\text{ref}}(x)|^2 \\, dx\\right)^{1/2}$，使用复合梯形法则在粗网格上进行近似。\n  3. 绝对溶剂化能差 $\\Delta E = \\left| E_N - E_{\\text{ref}} \\right|$，其中离散溶剂化能定义为 $E_N = \\dfrac{1}{2} \\int_{0}^{1} \\rho(x)\\,\\phi_N(x)\\,dx$，并使用复合梯形法则进行近似。所有量均为无量纲。\n- 使用通过求解具有 $N_{\\text{ref}}$ 个子区间的相同离散问题而获得的高分辨率参考解 $\\phi_{\\text{ref}}$，其中 $N_{\\text{ref}}$ 足够大，可作为连续解的代理。为实现插值，在精细网格上使用线性插值法，在粗网格点上计算 $\\phi_{\\text{ref}}$ 的值。\n\n实现程序，在一组指定的 $(N, \\kappa)$ 对测试套件上执行收敛性研究。对于每种情况，计算并报告上述三个指标。使用以下测试套件：\n- 情况1（正常路径）：$N = 16$, $\\kappa = 5.0$。\n- 情况2（细化网格）：$N = 64$, $\\kappa = 5.0$。\n- 情况3（粗网格边界）：$N = 8$, $\\kappa = 5.0$。\n- 情况4（无屏蔽效应边缘情况）：$N = 32$, $\\kappa = 0.0$。\n- 情况5（最少内部点边缘情况）：$N = 2$, $\\kappa = 5.0$。\n\n您的程序必须：\n- 使用源项 $\\rho(x) = \\sin(\\pi x)$、区间 $[0,1]$ 和齐次 Dirichlet 边界条件。\n- 使用专为三对角矩阵设计的数值稳定算法，构建并求解离散电势的三对角线性系统。\n- 对测试套件中每个不同的 $\\kappa$ 值，使用 $N_{\\text{ref}} = 8192$ 计算参考解。\n- 对于每个测试用例，将三个指标 $[L_{\\infty}, L_2, \\Delta E]$ 作为无量纲浮点数输出，并四舍五入到八位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身是按上述顺序排列的三个指标的列表。例如，输出必须类似于：“[[m11,m12,m13],[m21,m22,m23],...]”，其中每个 $m_{ij}$ 都是四舍五入到八位小数的浮点数。\n\n不使用角度，也不需要物理单位；所有量均为无量纲。确保实现是自包含的，无需任何外部输入或文件即可运行。",
            "solution": "所提出的问题是一个有效的边界值问题，源于计算化学生物学领域，特别是关于隐式溶剂模型。它在数学上是适定的，在科学上基于电解质理论，并为数值收敛性研究提供了一套完整而明确的规范。因此，我将着手提供一个完整的解决方案。\n\n问题的核心是求解一维线性化泊松-玻尔兹曼方程，这是一个二阶常微分方程，形式如下：\n$$\n- \\frac{d^2\\phi}{dx^2} + \\kappa^2 \\phi(x) = \\rho(x)\n$$\n在域 $x \\in [0, 1]$ 上。电势 $\\phi(x)$ 受齐次 Dirichlet 边界条件 $\\phi(0) = 0$ 和 $\\phi(1) = 0$ 的约束。代表固定电荷分布的源项被指定为 $\\rho(x) = \\sin(\\pi x)$。参数 $\\kappa$ 是无量纲的逆德拜长度，它表征了溶剂中移动离子的屏蔽效应。\n\n我们的目标是将这个连续问题离散化，数值求解所得到的线性方程组，并评估解在不同网格分辨率和物理参数下的精度。\n\n**1. 有限差分法离散化**\n\n为了数值求解该微分方程，我们采用有限差分法。我们首先将连续域 $[0, 1]$ 离散化为一个包含 $N$ 个子区间的均匀网格。这将产生 $N+1$ 个网格点 $x_i = i \\cdot h$（其中 $i = 0, 1, \\dots, N$），$h = 1/N$ 是网格间距。我们将电势 $\\phi(x_i)$ 的数值近似值记为 $\\phi_i$。\n\n边界条件直接给出了端点处的值：\n$$\n\\phi_0 = \\phi(x_0) = \\phi(0) = 0\n$$\n$$\n\\phi_N = \\phi(x_N) = \\phi(1) = 0\n$$\n我们需要求解 $N-1$ 个内部点处的电势值，即对于 $i = 1, 2, \\dots, N-1$。\n\n二阶导数项 $\\frac{d^2\\phi}{dx^2}$ 在每个内部网格点 $x_i$ 处使用二阶精度的中心差分公式进行近似：\n$$\n\\frac{d^2\\phi}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{\\phi(x_{i+1}) - 2\\phi(x_i) + \\phi(x_{i-1})}{h^2} = \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2}\n$$\n将此近似代入原始的泊松-玻尔兹曼方程在点 $x_i$ 处，得到一个代数方程组：\n$$\n- \\left(\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^2}\\right) + \\kappa^2 \\phi_i = \\rho(x_i) \\quad \\text{for } i = 1, 2, \\dots, N-1\n$$\n两边乘以 $h^2$ 并重新整理各项，将未知电势 $\\phi_i$ 组合在左侧，我们得到：\n$$\n- \\phi_{i-1} + (2 + \\kappa^2 h^2) \\phi_i - \\phi_{i+1} = h^2 \\rho(x_i)\n$$\n\n**2. 三对角线性系统**\n\n这组关于 $N-1$ 个未知电势 $(\\phi_1, \\phi_2, \\dots, \\phi_{N-1})$ 的 $N-1$ 个线性方程构成一个矩阵系统 $A\\vec{\\phi} = \\vec{b}$。\n\n对于 $i=1$：$-\\phi_0 + (2 + \\kappa^2 h^2) \\phi_1 - \\phi_2 = h^2 \\rho(x_1)$。由于 $\\phi_0 = 0$，方程变为 $(2 + \\kappa^2 h^2) \\phi_1 - \\phi_2 = h^2 \\rho(x_1)$。\n\n对于 $i=N-1$：$-\\phi_{N-2} + (2 + \\kappa^2 h^2) \\phi_{N-1} - \\phi_N = h^2 \\rho(x_{N-1})$。由于 $\\phi_N = 0$，方程变为 $-\\phi_{N-2} + (2 + \\kappa^2 h^2) \\phi_{N-1} = h^2 \\rho(x_{N-1})$。\n\n最终得到的 $(N-1) \\times (N-1)$ 系数矩阵 $A$ 是对称三对角矩阵：\n$$\nA = \\begin{pmatrix}\nd  -1  0  \\dots  0 \\\\\n-1  d  -1  \\dots  0 \\\\\n0  -1  \\ddots  \\ddots  \\vdots \\\\\n\\vdots  \\ddots  \\ddots  d  -1 \\\\\n0  \\dots  0  -1  d\n\\end{pmatrix}\n$$\n其中对角线元素为 $d = 2 + \\kappa^2 h^2$。未知数向量为 $\\vec{\\phi} = [\\phi_1, \\phi_2, \\dots, \\phi_{N-1}]^T$，右侧向量为 $\\vec{b}$，其分量为 $b_i = h^2 \\rho(x_i) = h^2 \\sin(\\pi x_i)$，其中 $i=1, \\dots, N-1$。\n\n这个三对角系统可以使用 Thomas 算法高效且稳定地求解，该算法在像 SciPy 这样的数值库中可用。\n\n**3. 参考解和误差指标**\n\n收敛性研究需要一个用于比较的基准。问题指定使用一个高分辨率的数值解 $\\phi_{\\text{ref}}$ 作为精确解析解的代理。该参考解通过求解具有极大子区间数 $N_{\\text{ref}} = 8192$ 的相同离散系统来计算。必须为测试套件中每个不同的 $\\kappa$ 值计算一个单独的参考解。\n\n为了将粗网格（具有 $N$ 个子区间）上的解 $\\phi_N$ 与 $\\phi_{\\text{ref}}$ 进行比较，我们必须在同一组点上对两者进行求值。我们通过在精细参考网格上使用线性插值，在粗网格点 $x_i$ 上计算 $\\phi_{\\text{ref}}$ 的值。\n\n指定的精度指标如下：\n\n1.  **最大范数误差 ($L_{\\infty}$)**：该指标量化了数值解与参考解之间的最大逐点偏差。\n    $$\n    L_{\\infty} = \\max_{i=0, \\dots, N} |\\phi_N(x_i) - \\phi_{\\text{ref}}(x_i)|\n    $$\n    此处，$\\phi_N(x_i)$ 是粗网格解的值，$\\phi_{\\text{ref}}(x_i)$ 是参考解插值到粗网格点 $x_i$ 上的值。\n\n2.  **$L_2$ 误差范数**：该指标衡量的是整体的、积分的误差。\n    $$\n    L_2 = \\left( \\int_{0}^{1} |\\phi_N(x) - \\phi_{\\text{ref}}(x)|^2 \\, dx \\right)^{1/2}\n    $$\n    我们使用复合梯形法则在具有点 $x_i$ 的粗网格上近似该积分。设 $e_i = \\phi_N(x_i) - \\phi_{\\text{ref}}(x_i)$。该积分则近似为：\n    $$\n    \\int_{0}^{1} e(x)^2 \\, dx \\approx h \\left( \\frac{e_0^2 + e_N^2}{2} + \\sum_{i=1}^{N-1} e_i^2 \\right)\n    $$\n    $L_2$ 范数是该值的平方根。\n\n3.  **绝对溶剂化能差 ($\\Delta E$)**：在此模型中，溶剂化能为 $E = \\frac{1}{2} \\int_0^1 \\rho(x)\\phi(x)dx$。我们为粗糙解 ($E_N$) 和参考解 ($E_{\\text{ref}}$) 计算此能量，并求其绝对差。\n    $$\n    E_N = \\frac{1}{2} \\int_0^1 \\rho(x)\\phi_N(x)dx \\approx \\frac{1}{2} \\cdot h \\left( \\sum_{i=1}^{N-1} \\rho(x_i)\\phi_N(x_i) \\right)\n    $$\n    $$\n    E_{\\text{ref}} = \\frac{1}{2} \\int_0^1 \\rho(x)\\phi_{\\text{ref}}(x)dx \\approx \\frac{1}{2} \\cdot h_{\\text{ref}} \\left( \\sum_{j=1}^{N_{\\text{ref}}-1} \\rho(x_j^{\\text{ref}})\\phi_{\\text{ref}}(x_j^{\\text{ref}}) \\right)\n    $$\n    在这些梯形法则近似中，端点项为零，因为 $\\rho(0)=\\phi(0)=0$ 且 $\\rho(1)=\\phi(1)=0$。能量差则为：\n    $$\n    \\Delta E = |E_N - E_{\\text{ref}}|\n    $$\n\n该实现将为每个测试用例构建并求解三对角系统，检索相应的预计算参考解，对其进行插值，并最终计算这三个指标。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Performs a numerical convergence study for the 1D linearized Poisson-Boltzmann equation.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (16, 5.0),  # Case 1 (happy path)\n        (64, 5.0),  # Case 2 (refined grid)\n        (8, 5.0),   # Case 3 (coarse grid boundary)\n        (32, 0.0),  # Case 4 (no screening edge case)\n        (2, 5.0),   # Case 5 (minimal interior edge case)\n    ]\n\n    N_ref = 8192\n\n    def get_potential(N, kappa):\n        \"\"\"\n        Solves the discretized 1D Poisson-Boltzmann equation for a given grid size N and kappa.\n\n        Args:\n            N (int): Number of subintervals in the grid.\n            kappa (float): Dimensionless inverse Debye length.\n\n        Returns:\n            tuple: A tuple containing:\n                - x (np.ndarray): Grid points from 0 to 1.\n                - phi (np.ndarray): Solved potential at grid points.\n        \"\"\"\n        if N  2:\n            # Handle the edge case with no interior points.\n            # The only points are boundaries, where phi is 0.\n            x = np.linspace(0, 1, N + 1)\n            phi = np.zeros(N + 1)\n            return x, phi\n\n        h = 1.0 / N\n        num_interior_points = N - 1\n\n        # Set up the tridiagonal system A*phi = b\n        # Main diagonal of matrix A\n        d = (2.0 + kappa**2 * h**2) * np.ones(num_interior_points)\n        \n        # Off-diagonal elements are all -1\n        ud = -1.0 * np.ones(num_interior_points - 1)\n        ld = -1.0 * np.ones(num_interior_points - 1)\n\n        # SciPy's solve_banded requires the matrix in a special format (ab)\n        # where l is the number of lower diagonals and u is the number of upper diagonals.\n        # For a tridiagonal matrix, l=1, u=1.\n        ab = np.zeros((3, num_interior_points))\n        ab[0, 1:] = ud  # Upper diagonal\n        ab[1, :] = d      # Main diagonal\n        ab[2, :-1] = ld # Lower diagonal\n\n        # Set up the right-hand side vector b\n        x_interior = np.linspace(h, 1.0 - h, num_interior_points)\n        rho_interior = np.sin(np.pi * x_interior)\n        b = h**2 * rho_interior\n\n        # Solve the linear system for interior points\n        phi_interior = solve_banded((1, 1), ab, b)\n        \n        # Construct full grid and solution including boundaries\n        x = np.linspace(0, 1, N + 1)\n        phi = np.concatenate(([0.0], phi_interior, [0.0]))\n        \n        return x, phi\n\n    # Pre-compute reference solutions for each unique kappa value\n    ref_solutions = {}\n    unique_kappas = sorted(list(set(case[1] for case in test_cases)))\n    \n    for k_val in unique_kappas:\n        x_ref, phi_ref = get_potential(N_ref, k_val)\n        ref_solutions[k_val] = (x_ref, phi_ref)\n\n    results = []\n    for N, kappa in test_cases:\n        # 1. Get the numerical solution for the current (N, kappa) case\n        x_N, phi_N = get_potential(N, kappa)\n\n        # 2. Get the pre-computed reference solution for the current kappa\n        x_ref, phi_ref = ref_solutions[kappa]\n\n        # 3. Interpolate the reference solution onto the coarse grid\n        phi_ref_interp = np.interp(x_N, x_ref, phi_ref)\n\n        # 4. Compute the three error metrics\n        # Metric 1: L-infinity error\n        l_inf_error = np.max(np.abs(phi_N - phi_ref_interp))\n\n        # Metric 2: L2 error\n        l2_integrand = (phi_N - phi_ref_interp)**2\n        l2_integral = np.trapz(l2_integrand, x_N)\n        l2_error = np.sqrt(l2_integral)\n\n        # Metric 3: Absolute solvation energy difference\n        # Energy on the coarse grid\n        rho_N = np.sin(np.pi * x_N)\n        energy_integrand_N = 0.5 * rho_N * phi_N\n        E_N = np.trapz(energy_integrand_N, x_N)\n\n        # Energy on the reference grid\n        rho_ref = np.sin(np.pi * x_ref)\n        energy_integrand_ref = 0.5 * rho_ref * phi_ref\n        E_ref = np.trapz(energy_integrand_ref, x_ref)\n\n        delta_E = np.abs(E_N - E_ref)\n        \n        # Store results rounded to 8 decimal places\n        case_results = [\n            round(l_inf_error, 8),\n            round(l2_error, 8),\n            round(delta_E, 8)\n        ]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # Convert each inner list to a string representation without spaces\n    result_strings = [f\"[{','.join(map(str, res))}]\" for res in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}