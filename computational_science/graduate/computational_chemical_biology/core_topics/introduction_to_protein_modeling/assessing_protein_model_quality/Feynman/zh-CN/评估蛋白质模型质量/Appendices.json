{
    "hands_on_practices": [
        {
            "introduction": "均方根偏差（RMSD）是评估蛋白质模型与参考结构之间几何相似性的基石。本练习旨在通过第一性原理计算，让您亲手实践 RMSD 的计算过程。更重要的是，通过移除一个异常原子并重新计算，本练习将揭示 RMSD 的一个关键特性：它对大的、局部的结构偏差高度敏感，这有助于您更批判性地理解和使用这一常用指标。",
            "id": "3836349",
            "problem": "在评估蛋白质模型质量时，一个核心问题是预测结构与可信参考结构的匹配程度。考虑一个小肽片段，其参考构象和预测模型已通过最优刚体叠加进行预对齐，该叠加最小化了原子间距离的平方和（仅考虑旋转和平移）。假设原子一一对应。使用以下坐标（单位为埃），其中 $\\mathbf{r}_i^{(R)}$ 表示原子 $i$ 的参考坐标，$\\mathbf{r}_i^{(M)}$ 表示其模型坐标：\n- 原子 $1$：$\\mathbf{r}_1^{(R)} = (0.0, 0.0, 0.0)$；$\\mathbf{r}_1^{(M)} = (0.1, -0.1, 0.0)$\n- 原子 $2$：$\\mathbf{r}_2^{(R)} = (1.0, 0.0, 0.0)$；$\\mathbf{r}_2^{(M)} = (1.2, -0.2, 0.1)$\n- 原子 $3$：$\\mathbf{r}_3^{(R)} = (2.0, 0.5, 0.0)$；$\\mathbf{r}_3^{(M)} = (1.8, 0.6, -0.1)$\n- 原子 $4$：$\\mathbf{r}_4^{(R)} = (3.0, 1.0, 0.5)$；$\\mathbf{r}_4^{(M)} = (8.0, 1.0, 0.5)$\n- 原子 $5$：$\\mathbf{r}_5^{(R)} = (4.0, 1.5, 1.0)$；$\\mathbf{r}_5^{(M)} = (4.1, 1.6, 1.2)$\n- 原子 $6$：$\\mathbf{r}_6^{(R)} = (5.0, 2.0, 1.5)$；$\\mathbf{r}_6^{(M)} = (5.2, 2.1, 1.4)$\n\n从第一性原理出发：三维空间中两点之间的欧几里得距离定义为其差向量的大小。令 $\\Delta x_i = x_i^{(M)} - x_i^{(R)}$，$\\Delta y_i = y_i^{(M)} - y_i^{(R)}$ 和 $\\Delta z_i = z_i^{(M)} - z_i^{(R)}$ 表示原子 $i$ 各分量的差值，原子间距离是由该差向量长度给出的非负量。\n\n任务：\n1. 使用上述定义，计算模型和参考结构在所有 $N = 6$ 个原子上的均方根偏差 (RMSD)。\n2. 移除单个最不协调的原子（即其单个距离最大的原子）后，使用剩余的 $N = 5$ 个原子重新计算 RMSD。\n\n将每个 RMSD 值四舍五入到四位有效数字。以埃为单位表示您的答案。将两个值作为一个最终答案提供，第一个是 $N = 6$ 时的值，第二个是 $N = 5$ 时的值。",
            "solution": "该问题被评估为有效，因为它具有科学依据、问题明确且客观。它为计算化学生物学中的一个标准计算提供了完整且一致的数据集。\n\n均方根偏差 (RMSD) 是衡量两个叠加的分子结构中一组对应原子之间平均距离的指标。它定义为原子间欧几里得距离平方的均值的平方根。\n\n令 $\\mathbf{r}_i^{(R)}$ 为参考结构中原子 $i$ 的坐标向量，$\\mathbf{r}_i^{(M)}$ 为模型结构中对应原子 $i$ 的坐标向量。原子数为 $N$。原子 $i$ 的欧几里得距离平方 $d_i^2$ 由下式给出：\n$$d_i^2 = ||\\mathbf{r}_i^{(M)} - \\mathbf{r}_i^{(R)}||^2 = (x_i^{(M)} - x_i^{(R)})^2 + (y_i^{(M)} - y_i^{(R)})^2 + (z_i^{(M)} - z_i^{(R)})^2$$\nRMSD 的计算公式如下：\n$$\\text{RMSD} = \\sqrt{\\frac{1}{N} \\sum_{i=1}^{N} d_i^2}$$\n\n首先，我们计算每个原子（共 $N=6$ 个）的距离平方 $d_i^2$，所有坐标单位均为埃（$\\text{Å}$）。\n\n对于原子 $i=1$：\n$\\Delta\\mathbf{r}_1 = \\mathbf{r}_1^{(M)} - \\mathbf{r}_1^{(R)} = (0.1, -0.1, 0.0) - (0.0, 0.0, 0.0) = (0.1, -0.1, 0.0)$\n$d_1^2 = (0.1)^2 + (-0.1)^2 + (0.0)^2 = 0.01 + 0.01 + 0 = 0.02$\n\n对于原子 $i=2$：\n$\\Delta\\mathbf{r}_2 = \\mathbf{r}_2^{(M)} - \\mathbf{r}_2^{(R)} = (1.2, -0.2, 0.1) - (1.0, 0.0, 0.0) = (0.2, -0.2, 0.1)$\n$d_2^2 = (0.2)^2 + (-0.2)^2 + (0.1)^2 = 0.04 + 0.04 + 0.01 = 0.09$\n\n对于原子 $i=3$：\n$\\Delta\\mathbf{r}_3 = \\mathbf{r}_3^{(M)} - \\mathbf{r}_3^{(R)} = (1.8, 0.6, -0.1) - (2.0, 0.5, 0.0) = (-0.2, 0.1, -0.1)$\n$d_3^2 = (-0.2)^2 + (0.1)^2 + (-0.1)^2 = 0.04 + 0.01 + 0.01 = 0.06$\n\n对于原子 $i=4$：\n$\\Delta\\mathbf{r}_4 = \\mathbf{r}_4^{(M)} - \\mathbf{r}_4^{(R)} = (8.0, 1.0, 0.5) - (3.0, 1.0, 0.5) = (5.0, 0.0, 0.0)$\n$d_4^2 = (5.0)^2 + (0.0)^2 + (0.0)^2 = 25.0$\n\n对于原子 $i=5$：\n$\\Delta\\mathbf{r}_5 = \\mathbf{r}_5^{(M)} - \\mathbf{r}_5^{(R)} = (4.1, 1.6, 1.2) - (4.0, 1.5, 1.0) = (0.1, 0.1, 0.2)$\n$d_5^2 = (0.1)^2 + (0.1)^2 + (0.2)^2 = 0.01 + 0.01 + 0.04 = 0.06$\n\n对于原子 $i=6$：\n$\\Delta\\mathbf{r}_6 = \\mathbf{r}_6^{(M)} - \\mathbf{r}_6^{(R)} = (5.2, 2.1, 1.4) - (5.0, 2.0, 1.5) = (0.2, 0.1, -0.1)$\n$d_6^2 = (0.2)^2 + (0.1)^2 + (-0.1)^2 = 0.04 + 0.01 + 0.01 = 0.06$\n\n所有距离平方的单位均为 $\\text{Å}^2$。其值为：$d_1^2 = 0.02$, $d_2^2 = 0.09$, $d_3^2 = 0.06$, $d_4^2 = 25.0$, $d_5^2 = 0.06$, $d_6^2 = 0.06$。\n\n**任务 1：计算所有 $N=6$ 个原子的 RMSD。**\n距离平方的总和为：\n$$\\sum_{i=1}^{6} d_i^2 = 0.02 + 0.09 + 0.06 + 25.0 + 0.06 + 0.06 = 25.29\\,\\text{Å}^2$$\n均方距离为：\n$$\\frac{1}{6} \\sum_{i=1}^{6} d_i^2 = \\frac{25.29}{6} = 4.215\\,\\text{Å}^2$$\n$N=6$ 个原子的 RMSD 为：\n$$\\text{RMSD}_{N=6} = \\sqrt{4.215} \\approx 2.0530465... \\text{ Å}$$\n四舍五入到四位有效数字，我们得到 $\\text{RMSD}_{N=6} = 2.053 \\text{ Å}$。\n\n**任务 2：移除最不协调的原子后重新计算 RMSD。**\n“最不协调的原子”是具有最大个体距离 $d_i$ 的原子，这对应于最大的距离平方 $d_i^2$。比较计算出的值，$d_4^2 = 25.0\\,\\text{Å}^2$ 是目前为止最大的。因此，原子 4 是最不协调的原子。\n\n我们为剩余的 $N = 5$ 个原子（原子 1、2、3、5 和 6）重新计算 RMSD。\n新的距离平方总和为：\n$$\\sum_{i \\in \\{1,2,3,5,6\\}} d_i^2 = d_1^2 + d_2^2 + d_3^2 + d_5^2 + d_6^2 = 0.02 + 0.09 + 0.06 + 0.06 + 0.06 = 0.29\\,\\text{Å}^2$$\n当 $N=5$ 时，新的均方距离为：\n$$\\frac{1}{5} \\sum_{i \\in \\{1,2,3,5,6\\}} d_i^2 = \\frac{0.29}{5} = 0.058\\,\\text{Å}^2$$\n$N=5$ 个原子的 RMSD 为：\n$$\\text{RMSD}_{N=5} = \\sqrt{0.058} \\approx 0.2408318... \\text{ Å}$$\n四舍五入到四位有效数字，我们得到 $\\text{RMSD}_{N=5} = 0.2408 \\text{ Å}$。\n\n要求的两个值是 $N=6$ 个原子的 RMSD 和移除主要离群值后 $N=5$ 个原子的 RMSD。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.053 & 0.2408\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在评估模型质量时，除了将其与参考结构进行比较，评估其自身的物理真实性也至关重要。碰撞分数（Clash Score）是衡量模型局部立体化学质量的核心指标，用于识别空间上过于拥挤的原子。本练习将引导您基于范德华半径这一基本物理原理，编写程序来计算碰撞分数，从而将理论概念转化为实用的生物信息学评估工具。",
            "id": "3836346",
            "problem": "您的任务是实现一个程序，通过计算一组原子的冲突分数来评估蛋白质模型的质量。冲突分数定义为每 $1000$ 个原子中严重空间重叠的数量。评估必须基于物理原理，且必须避免使用启发式的简化公式。请从以下基础开始：(i) 由兰纳-琼斯 (LJ) 势建模的非键合空间排斥的定义，以及 (ii) 将范德华 (vdW) 半径解释为编码非键合原子接触距离的有效硬球半径。\n\n推导起点：两个相互作用的中性原子的兰纳-琼斯势能函数由 $U(r) = 4 \\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]$ 给出，其中 $r$ 是中心间距，$\\varepsilon$ 是势阱深度参数，$\\sigma$ 设定了势能为零时的长度尺度。势能最小值出现在排斥力与吸引力平衡的间距处。对于原子对，一个广泛使用的空间尺寸表示是范德华半径 $r_{\\mathrm{vdW}}$，它近似于相同物种平衡间距的一半，更一般地，不同物种的接触距离可以近似为其范德华半径之和。严重空间重叠通过一个超出接触距离的阈值来操作性地定义：如果两个非键合原子的距离小于接触距离减去一个固定的容差，则它们的空间重叠被认为是严重的。\n\n定义以下要素：\n- 所使用的范德华半径（单位：埃）为常数，由 Bondi 集给出：氢 $\\mathrm{H}$：$1.20$，碳 $\\mathrm{C}$：$1.70$，氮 $\\mathrm{N}$：$1.55$，氧 $\\mathrm{O}$：$1.52$，硫 $\\mathrm{S}$：$1.80$。\n- 严重重叠容差 $\\tau$（单位：埃）为 $0.40$。\n- 仅当一对原子既非直接键合，也非 $1$-$3$ 对（在键合图中沿路径相隔两个键）时，才考虑这对原子。计数必须对唯一的无序对进行。\n- 严重空间重叠的数量必须按原子数进行归一化，并报告为冲突分数，其定义为严重空间重叠的数量除以原子数，再乘以 $1000$。\n\n您的程序必须：\n- 根据兰纳-琼斯势的接触距离逻辑和范德华半径的定义，推导出基于距离的严重空间重叠操作准则。基于此推导，实现每个测试用例的冲突分数计算。\n- 使用欧几里得度量计算原子中心之间的距离。所有坐标均以埃为单位提供，所有距离和半径也以埃为单位。\n- 根据每个测试用例提供的键合列表，从重叠考虑中排除直接键合对和 $1$-$3$ 对。\n- 将每个结果表示为四舍五入到 $3$ 位小数的浮点数。\n\n测试套件规范：\n- 使用以下范德华半径映射（单位：埃）：$\\mathrm{H}=1.20$, $\\mathrm{C}=1.70$, $\\mathrm{N}=1.55$, $\\mathrm{O}=1.52$, $\\mathrm{S}=1.80$。\n- 严重重叠容差使用 $\\tau = 0.40$ 埃。\n- 坐标单位为埃。键合以基于零的索引对形式给出。\n\n在您的程序中提供以下测试用例作为硬编码输入：\n\n- 测试用例 $1$（一般情况）：原子\n  - $\\mathrm{C}$ 位于 $(0.0, 0.0, 0.0)$，\n  - $\\mathrm{N}$ 位于 $(1.0, 0.0, 0.0)$，\n  - $\\mathrm{O}$ 位于 $(2.9, 0.0, 0.0)$，\n  - $\\mathrm{H}$ 位于 $(10.0, 0.0, 0.0)$；\n  键合：无。\n- 测试用例 $2$（在容差处的边界相等情况）：原子\n  - $\\mathrm{C}$ 位于 $(0.0, 0.0, 0.0)$，\n  - $\\mathrm{C}$ 位于 $(3.0, 0.0, 0.0)$；\n  键合：无。\n- 测试用例 $3$（包含重合原子和远处原子的边缘情况）：原子\n  - $\\mathrm{H}$ 位于 $(0.0, 0.0, 0.0)$，\n  - $\\mathrm{H}$ 位于 $(0.0, 0.0, 0.0)$，\n  - $\\mathrm{O}$ 位于 $(5.0, 5.0, 5.0)$；\n  键合：无。\n- 测试用例 $4$（排除键合对和 $1$-$3$ 对）：原子\n  - 索引 $0$：$\\mathrm{C}$ 位于 $(0.0, 0.0, 0.0)$，\n  - 索引 $1$：$\\mathrm{N}$ 位于 $(3.0, 0.0, 0.0)$，\n  - 索引 $2$：$\\mathrm{C}$ 位于 $(7.0, 0.0, 0.0)$，\n  - 索引 $3$：$\\mathrm{O}$ 位于 $(3.2, 0.0, 0.0)$；\n  键合：$(0,1)$ 和 $(1,2)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试用例的冲突分数，格式为用方括号括起来的逗号分隔列表，每个值四舍五入到 $3$ 位小数（例如，$[x_1,x_2,x_3,x_4]$）。",
            "solution": "该问题要求实现一个程序来计算给定原子集的冲突分数。冲突分数用于量化分子结构中空间重叠的严重程度。其推导和计算必须基于原子间相互作用的物理原理，特别是兰纳-琼斯势和范德华半径的概念。\n\n### 1. 空间冲突准则的推导\n\n非键合原子相互作用的基础是兰纳-琼斯 (LJ) 势，它描述了势能 $U$ 作为两个中性原子间分离距离 $r$ 的函数：\n$$U(r) = 4 \\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]$$\n此处，与 $r^{-12}$ 成正比的项代表由电子轨道重叠引起的强短程泡利排斥力，而与 $r^{-6}$ 成正比的项代表较弱的长程伦敦色散吸引力。参数 $\\varepsilon$ 是势阱的深度，而 $\\sigma$ 是势能为零时的有限距离。\n\n两个原子间的平衡距离 $r_{min}$ 出现在该势能的最小值处，此时净力为零。此距离对应于理想的接触距离。在实践中，范德华半径 $r_{\\mathrm{vdW}}$ 被用作原子的有效硬球半径。对于一对非键合原子 $i$ 和 $j$，其范德华半径之和 $r_{\\mathrm{vdW},i} + r_{\\mathrm{vdW},j}$ 为其平衡分离距离或接触距离 $d_{\\mathrm{contact}, ij}$ 提供了一个可靠的近似值。\n$$d_{\\mathrm{contact}, ij} = r_{\\mathrm{vdW}, i} + r_{\\mathrm{vdW}, j}$$\n\n“严重空间重叠”或冲突，被定义为两个原子被强迫靠得比该接触距离近得多的情况。问题为此事件指定了一个操作性定义：如果测量的中心间距 $d_{ij}$ 小于接触距离减去一个固定容差 $\\tau$，则发生冲突。这给出了原子 $i$ 和 $j$ 之间冲突的量化准则：\n$$d_{ij}  (r_{\\mathrm{vdW}, i} + r_{\\mathrm{vdW}, j} - \\tau)$$\n对于本问题，给定的容差为 $\\tau = 0.40$ 埃。\n\n### 2. 冲突分数计算的算法流程\n\n冲突分数定义为每 $1000$ 个原子中的严重空间重叠数。计算给定分子系统的此分数的算法如下：\n\n1.  **输入数据表示**：对于每个测试用例，我们都获得一个原子列表，指定其元素类型和笛卡尔坐标 $(x, y, z)$，以及一个原子对之间的键合列表，通过其基于零的索引来标识。相关元素（$\\mathrm{H}$、$\\mathrm{C}$、$\\mathrm{N}$、$\\mathrm{O}$、$\\mathrm{S}$）的范德华半径作为常数提供。\n\n2.  **排除共价键连接的原子对**：空间冲突仅在因共价键结构而不紧密邻近的原子之间考虑。按照规定，标准做法是排除直接键合的原子对（$1$-$2$ 关系）和相隔两个键的原子对（$1$-$3$ 或偕关关系）。\n    -   首先通过从输入键合列表中添加所有直接键合的对来构建一个排除对集合。\n    -   接下来，识别 $1$-$3$ 对。对于每个原子 $i$，我们找到其键合邻居 $j$。对于每个邻居 $j$，我们找到其邻居 $k$。任何满足 $i \\neq k$ 的对 $(i, k)$ 都是一个 $1$-$3$ 对，并被添加到排除集中。为了一致地处理无序对，原子对以规范形式存储，例如 `(min(i, j), max(i, j))`。\n\n3.  **迭代成对分析**：该算法遍历系统中所有唯一的、无序的原子对 $(i, j)$，其中 $i  j$。\n    -   对于每一对，它首先检查该对 $(i, j)$ 是否在排除集中。如果是，则跳过该对。\n\n4.  **冲突检测**：对于每个未被排除的对 $(i, j)$：\n    -   使用它们的坐标 $(x_i, y_i, z_i)$ 和 $(x_j, y_j, z_j)$ 计算其中心之间的欧几里得距离 $d_{ij}$：\n        $$d_{ij} = \\sqrt{(x_i - x_j)^2 + (y_i - y_j)^2 + (z_i - z_j)^2}$$\n    -   检索与原子 $i$ 和 $j$ 的元素类型相对应的范德华半径 $r_{\\mathrm{vdW}, i}$ 和 $r_{\\mathrm{vdW}, j}$。\n    -   应用冲突准则：如果 $d_{ij}  r_{\\mathrm{vdW}, i} + r_{\\mathrm{vdW}, j} - \\tau$，则将总冲突计数器 $N_{\\text{clashes}}$ 加一。\n\n5.  **冲突分数归一化**：在检查完所有有效原子对后，计算最终的冲突分数。设 $N_{\\text{atoms}}$ 为系统中的原子总数。分数由以下公式给出：\n    $$\\text{冲突分数} = \\frac{N_{\\text{clashes}}}{N_{\\text{atoms}}} \\times 1000$$\n    然后按要求将结果四舍五入到 $3$ 位小数。此过程独立应用于每个测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the clash score problem for a series of pre-defined test cases.\n    \"\"\"\n\n    # --- Problem Constants ---\n    VDW_RADII = {\n        'H': 1.20,\n        'C': 1.70,\n        'N': 1.55,\n        'O': 1.52,\n        'S': 1.80,\n    }\n    TOLERANCE = 0.40\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        {\n            \"atoms\": [\n                {'type': 'C', 'coords': (0.0, 0.0, 0.0)},\n                {'type': 'N', 'coords': (1.0, 0.0, 0.0)},\n                {'type': 'O', 'coords': (2.9, 0.0, 0.0)},\n                {'type': 'H', 'coords': (10.0, 0.0, 0.0)},\n            ],\n            \"bonds\": []\n        },\n        {\n            \"atoms\": [\n                {'type': 'C', 'coords': (0.0, 0.0, 0.0)},\n                {'type': 'C', 'coords': (3.0, 0.0, 0.0)},\n            ],\n            \"bonds\": []\n        },\n        {\n            \"atoms\": [\n                {'type': 'H', 'coords': (0.0, 0.0, 0.0)},\n                {'type': 'H', 'coords': (0.0, 0.0, 0.0)},\n                {'type': 'O', 'coords': (5.0, 5.0, 5.0)},\n            ],\n            \"bonds\": []\n        },\n        {\n            \"atoms\": [\n                {'type': 'C', 'coords': (0.0, 0.0, 0.0)},  # index 0\n                {'type': 'N', 'coords': (3.0, 0.0, 0.0)},  # index 1\n                {'type': 'C', 'coords': (7.0, 0.0, 0.0)},  # index 2\n                {'type': 'O', 'coords': (3.2, 0.0, 0.0)},  # index 3\n            ],\n            \"bonds\": [(0, 1), (1, 2)]\n        }\n    ]\n\n    def calculate_clash_score(atoms, bonds):\n        \"\"\"\n        Calculates the clash score for a single molecular system.\n        \"\"\"\n        n_atoms = len(atoms)\n        if n_atoms  2:\n            return 0.0\n\n        # Build adjacency list to represent the bond graph\n        adj = {i: [] for i in range(n_atoms)}\n        for u, v in bonds:\n            adj[u].append(v)\n            adj[v].append(u)\n\n        # Build a set of excluded pairs (1-2 and 1-3 relationships)\n        # Pairs are stored as sorted tuples for canonical representation.\n        excluded_pairs = set()\n\n        # Add 1-2 pairs (direct bonds)\n        for u, v in bonds:\n            excluded_pairs.add(tuple(sorted((u, v))))\n\n        # Add 1-3 pairs (geminal)\n        for i in range(n_atoms):\n            # For each neighbor j of i\n            for j in adj[i]:\n                # For each neighbor k of j\n                for k in adj[j]:\n                    if i != k:\n                        excluded_pairs.add(tuple(sorted((i, k))))\n\n        clash_count = 0\n        atom_data = [{'type': atom['type'], 'pos': np.array(atom['coords'])} for atom in atoms]\n\n        # Iterate over all unique, unordered pairs of atoms\n        for i in range(n_atoms):\n            for j in range(i + 1, n_atoms):\n                # Skip if the pair is excluded\n                if tuple(sorted((i, j))) in excluded_pairs:\n                    continue\n\n                atom_i = atom_data[i]\n                atom_j = atom_data[j]\n\n                # Calculate Euclidean distance\n                distance = np.linalg.norm(atom_i['pos'] - atom_j['pos'])\n                \n                # Get van der Waals radii\n                r_vdw_i = VDW_RADII[atom_i['type']]\n                r_vdw_j = VDW_RADII[atom_j['type']]\n                \n                # Define clash threshold based on the sum of radii and tolerance\n                clash_threshold = r_vdw_i + r_vdw_j - TOLERANCE\n\n                # Check for clash\n                if distance  clash_threshold:\n                    clash_count += 1\n        \n        # Normalize and calculate final score\n        clash_score = (clash_count / n_atoms) * 1000\n        return clash_score\n\n    results = []\n    for case in test_cases:\n        score = calculate_clash_score(case[\"atoms\"], case[\"bonds\"])\n        # Format to 3 decimal places\n        results.append(f\"{score:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在实际研究中，我们常常面临一个复杂的抉择：当不同的质量评估指标给出相互矛盾的排序时，如何选出“最佳”模型？本练习通过一个涉及全局折叠相似性（TM-score）和局部立体化学质量（clash score）的场景，展现了这种权衡。通过分析这一案例，您将深入理解在不同研究背景下“模型质量”的含义，并接触到多标准决策策略和帕累托最优等高级概念。",
            "id": "3836319",
            "problem": "计算化学生物学中的一个核心任务是使用互补的标准来评估蛋白质模型的质量，这些标准既能捕捉全局折叠的保真度，又能反映局部立体化学的合理性。考虑对于同一个长度为 $N=100$ 个残基的蛋白质的两个候选模型，记为 $M_1$ 和 $M_2$，它们是根据一个实验参考结构进行评估的。全局相似性通过模板建模分数（TM-score）来量化，对于 $N$ 个残基的比对，其定义为\n$$\nS \\equiv \\frac{1}{N}\\sum_{i=1}^{N}\\frac{1}{1+\\left(\\frac{d_i}{d_0}\\right)^2},\n$$\n其中 $d_i$ 是模型中比对上的残基 $i$ 与参考结构中对应残基之间的距离（单位为 $\\text{\\AA}$），而 $d_0$ 是一个归一化因子，由一个公认的、与长度相关的公式给出\n$$\nd_0 = 1.24\\,(N-15)^{1/3} - 1.8.\n$$\n局部立体化学质量通过一个 MolProbity 风格的碰撞分数来量化，\n$$\nCS \\equiv \\frac{1000}{A}\\,C,\n$$\n其中 $A$ 是模型中的原子总数，$C$ 是严重重叠（超过标准阈值）的非键合原子对的数量。\n\n假设存在以下科学上合理的情景：\n- 该蛋白质在 $M_1$ 和 $M_2$ 两个模型中均有 $N=100$ 个残基和 $A=800$ 个原子。\n- 在 $M_1$ 中，与参考结构的距离在结构域内是均匀的：对于残基 $i=1,\\dots,80$，$d_i=1.0\\,\\text{\\AA}$；对于残基 $i=81,\\dots,100$，$d_i=3.0\\,\\text{\\AA}$。然而，$M_1$ 在一个环-侧链区域局部包含 $C=20$ 个严重碰撞。\n- 在 $M_2$ 中，一次局部重构通过类似铰链的松弛作用缓解了空间位阻重叠，这轻微地重新定位了一个结构域：对于残基 $i=1,\\dots,80$，$d_i=1.0\\,\\text{\\AA}$（未改变）；对于残基 $i=81,\\dots,100$，$d_i=6.0\\,\\text{\\AA}$；此外，严重碰撞的数量减少到 $C=5$。\n\n任务：\n1. 根据上述定义，计算 $N=100$ 时的 $d_0$，然后计算 $M_1$ 和 $M_2$ 的 $S$ 值。\n2. 计算 $M_1$ 和 $M_2$ 的碰撞分数 $CS$。\n3. 基于这些计算出的量，选择正确的陈述：\n\nA. 碰撞分数的任何降低必然会增加模板建模分数 $S$。\n\nB. 考虑到计算出的值，如果全局折叠准确性是首要任务，且局部几何结构可以在稍后进行优化，那么选择具有更高 $S$ 值的模型（模型 $M_1$）是合理的。\n\nC. 在这种情况下，一个综合分数 $Q \\equiv S - 0.001 \\times CS$ 会选择模型 $M_2$。\n\nD. 在帕累托排序下，两个模型都不能支配对方；因此，有必要采用多标准选择策略。\n\n通过选择正确的选项来回答。对于所有数值和表达式，请使用提供的公式和标准算术；假设距离 $d_i$ 的单位是 $\\text{\\AA}$，并且 TM-score 和碰撞分数的定义按给定方式应用。",
            "solution": "用户请求对一个关于评估蛋白质结构模型的问题进行严谨的验证和解答。该问题被认为是有效的，因为它科学地基于计算化学生物学的既定原则，信息完备、问题明確，并且表述客观。\n\n解答过程首先计算两个模型 $M_1$ 和 $M_2$ 所需的质量指标，然后评估每个给定的陈述。\n\n### 步骤1：主要指标的计算\n\n首先，我们计算长度为 $N=100$ 个残基的蛋白质的归一化因子 $d_0$。公式为：\n$$\nd_0 = 1.24\\,(N-15)^{1/3} - 1.8\n$$\n代入 $N=100$：\n$$\nd_0 = 1.24\\,(100-15)^{1/3} - 1.8 = 1.24\\,(85)^{1/3} - 1.8\n$$\n计算其值：\n$$\nd_0 \\approx 1.24 \\times (4.3968) - 1.8 \\approx 5.4520 - 1.8 = 3.6520\\,\\text{\\AA}\n$$\n\n接下来，我们计算每个模型的模板建模分数（$S$）。通用公式为：\n$$\nS \\equiv \\frac{1}{N}\\sum_{i=1}^{N}\\frac{1}{1+\\left(\\frac{d_i}{d_0}\\right)^2}\n$$\n\n对于模型 $M_1$，有 $80$ 个残基的 $d_i=1.0\\,\\text{\\AA}$ 和 $20$ 个残基的 $d_i=3.0\\,\\text{\\AA}$。当 $N=100$ 且 $d_0 \\approx 3.6520$ 时：\n$$\nS_1 = \\frac{1}{100} \\left( 80 \\times \\frac{1}{1+\\left(\\frac{1.0}{3.6520}\\right)^2} + 20 \\times \\frac{1}{1+\\left(\\frac{3.0}{3.6520}\\right)^2} \\right)\n$$\n$$\nS_1 \\approx \\frac{1}{100} \\left( 80 \\times \\frac{1}{1+0.0750} + 20 \\times \\frac{1}{1+0.6748} \\right)\n$$\n$$\nS_1 \\approx \\frac{1}{100} \\left( 80 \\times 0.9302 + 20 \\times 0.5971 \\right) \\approx \\frac{74.416 + 11.942}{100} \\approx 0.8636\n$$\n\n对于模型 $M_2$，有 $80$ 个残基的 $d_i=1.0\\,\\text{\\AA}$ 和 $20$ 个残基的 $d_i=6.0\\,\\text{\\AA}$。\n$$\nS_2 = \\frac{1}{100} \\left( 80 \\times \\frac{1}{1+\\left(\\frac{1.0}{3.6520}\\right)^2} + 20 \\times \\frac{1}{1+\\left(\\frac{6.0}{3.6520}\\right)^2} \\right)\n$$\n$$\nS_2 \\approx \\frac{1}{100} \\left( 80 \\times 0.9302 + 20 \\times \\frac{1}{1+2.6993} \\right)\n$$\n$$\nS_2 \\approx \\frac{1}{100} \\left( 74.416 + 20 \\times 0.2703 \\right) \\approx \\frac{74.416 + 5.406}{100} \\approx 0.7982\n$$\n\n接下来，我们计算每个模型的碰撞分数（$CS$）。公式为：\n$$\nCS \\equiv \\frac{1000}{A}\\,C\n$$\n两个模型的原子数均为 $A=800$。\n\n对于模型 $M_1$，严重碰撞数为 $C_1=20$。\n$$\nCS_1 = \\frac{1000}{800} \\times 20 = 1.25 \\times 20 = 25.0\n$$\n\n对于模型 $M_2$，严重碰撞数为 $C_2=5$。\n$$\nCS_2 = \\frac{1000}{800} \\times 5 = 1.25 \\times 5 = 6.25\n$$\n\n**计算值摘要：**\n- 模型 $M_1$：$S_1 \\approx 0.864$, $CS_1 = 25.0$\n- 模型 $M_2$：$S_2 \\approx 0.798$, $CS_2 = 6.25$\n\n### 步骤2：评估选项\n\n**A. 碰撞分数的任何降低必然会增加模板建模分数 $S$。**\n该陈述提出了 $CS$ 和 $S$ 之间的一种必然关系。让我们考察从模型 $M_1$ 到模型 $M_2$ 的变化。碰撞分数从 $CS_1 = 25.0$ 降低到 $CS_2 = 6.25$。然而，TM-score 也从 $S_1 \\approx 0.864$ 降低到 $S_2 \\approx 0.798$。这个特定的案例是一个直接的反例。这两个分数衡量的是模型质量的不同方面——局部立体化学与全局折叠与参考结构的相似性——并且它们之间并没有像陈述中所说的那样直接耦合。通常情况下，改善碰撞的局部优化会轻微降低全局分数。\n**结论：不正确。**\n\n**B. 考虑到计算出的值，如果全局折叠准确性是首要任务，且局部几何结构可以在稍后进行优化，那么选择具有更高 $S$ 值的模型（模型 $M_1$）是合理的。**\n这个陈述涉及蛋白质结构建模中一种常见的决策策略。我们已经发现 $S_1 > S_2$，意味着 $M_1$ 具有更高的全局折叠准确性。我们还发现 $CS_1 > CS_2$，意味着 $M_1$ 的局部立体化学性质更差。TM-score $S$ 是折叠拓扑正确性的主要指标。$S_1 \\approx 0.864$ 的分数表明这是一个高度准确的模型，而 $CS_1=25.0$ 表明存在显著但可能可以修复的局部缺陷。在许多建模流程中，通常认为在一个全局正确的模板（高 $S$）上修正局部空间碰撞，比修正大规模折叠错误（低 $S$）更为可行。因此，在指定的条件下，优先选择 $M_1$ 的更高 $S$ 分数是一种标准且合理的策略。\n**结论：正确。**\n\n**C. 在这种情况下，一个综合分数 $Q \\equiv S - 0.001 \\times CS$ 会选择模型 $M_2$。**\n为了评估这一说法，我们为两个模型计算综合分数 $Q$。分数越高表示模型越好。\n对于模型 $M_1$：\n$$\nQ_1 = S_1 - 0.001 \\times CS_1 \\approx 0.8636 - 0.001 \\times 25.0 = 0.8636 - 0.025 = 0.8386\n$$\n对于模型 $M_2$：\n$$\nQ_2 = S_2 - 0.001 \\times CS_2 \\approx 0.7982 - 0.001 \\times 6.25 = 0.7982 - 0.00625 = 0.7920\n$$\n由于 $Q_1 > Q_2$，这个综合分数会选择模型 $M_1$，而不是 $M_2$。根据我们的计算，该陈述在事实上是不正确的。\n**结论：不正确。**\n\n**D. 在帕累托排序下，两个模型都不能支配对方；因此，有必要采用多标准选择策略。**\n帕累托支配是多目标优化中的一个概念。如果一个解在至少一个目标上更优，并且在其他目标上不劣于另一个解，则称其为帕累托占优。我们的目标是最大化 $S$ 和最小化 $CS$。\n让我们比较 $M_1$（分数为 $(S_1, CS_1) \\approx (0.864, 25.0)$）和 $M_2$（分数为 $(S_2, CS_2) \\approx (0.798, 6.25)$）。\n- $M_1$ vs $M_2$：$S_1 > S_2$（更好），但 $CS_1 > CS_2$（更差，因为值越低越好）。因此，$M_1$ 不帕累托支配 $M_2$。\n- $M_2$ vs $M_1$：$CS_2  CS_1$（更好），但 $S_2  S_1$（更差）。因此，$M_2$ 不帕累托支配 $M_1$。\n\n由于没有一个模型支配另一个模型，它们代表了两个目标之间的权衡，并且可以说它们位于帕累托前沿上。这种情况正是单一“最佳”模型不存在的场景，必须采用多标准选择策略（例如选项B中描述的策略，或选项C中制定但应用不当的策略）来根据任务的具体优先级做出选择。该陈述是这一原则的正确应用。\n**结论：正确。**",
            "answer": "$$\\boxed{BD}$$"
        }
    ]
}