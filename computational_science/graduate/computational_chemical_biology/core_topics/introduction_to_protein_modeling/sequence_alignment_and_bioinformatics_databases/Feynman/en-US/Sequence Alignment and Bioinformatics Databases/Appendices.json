{
    "hands_on_practices": [
        {
            "introduction": "Before we can meaningfully align sequences from bioinformatics databases, we must first understand the quality and inherent uncertainty of our input data. This practice focuses on Phred quality scores, which provide a standardized, logarithmic scale to represent the error probability of base calls from sequencing instruments. This exercise  will guide you through deriving the fundamental relationship between error probability $p$ and the quality score $Q$, and then apply it to the crucial pre-processing task of quality trimming a sequence read.",
            "id": "3863083",
            "problem": "A Next-Generation Sequencing (NGS) instrument outputs base calls with associated Phred quality scores, intended to quantify the probability of an incorrect base call. Consider a single-end DNA read destined for alignment to a reference genome retrieved from a curated bioinformatics database. You will derive the mapping from the error probability to the quality score from first principles and then use this mapping to compute the expected number of base-calling errors before and after suffix quality trimming.\n\nStart from the following foundational premises:\n- The Phred quality score $Q$ is a monotonic transformation of the base-calling error probability $p \\in (0,1]$, chosen to reflect the empirical observation that multiplicative changes in $p$ correspond to additive changes in $Q$ on a base-$10$ logarithmic scale. Specifically, decreasing $p$ by a factor of $10$ increases $Q$ by $10$.\n- The mapping is continuous, strictly decreasing in $p$, and normalized such that a base-call that is certain to be wrong has $p=1$ and maps to $Q=0$.\n- Individual base-call errors along a read can be modeled as independent Bernoulli trials with position-specific error probabilities $\\{p_i\\}$, and the expected total number of errors is the sum $\\sum_i p_i$ by linearity of expectation.\n\nTasks:\n1. Derive the functional relation between the Phred quality score $Q$ and the error probability $p$ consistent with the premises above.\n2. Consider a read of length $20$ bases whose Phred quality scores along the read (from $5'$ to $3'$) are given by the vector \n$$\n(35,\\,35,\\,30,\\,30,\\,28,\\,28,\\,25,\\,25,\\,22,\\,22,\\,20,\\,18,\\,18,\\,15,\\,15,\\,12,\\,12,\\,10,\\,10,\\,8).\n$$\nUsing your derived relation, compute the expected number of base-calling errors for the full read, denoted $E_{\\mathrm{full}}$.\n3. Define suffix quality trimming at threshold $Q_{\\mathrm{thr}}$ as removing bases from the $3'$ end until the last retained base satisfies $Q \\ge Q_{\\mathrm{thr}}$. For threshold $Q_{\\mathrm{thr}}=20$, compute the expected number of base-calling errors for the trimmed read, denoted $E_{\\mathrm{trim}}$.\n4. Report the reduction in expected errors due to trimming, $\\Delta E = E_{\\mathrm{full}} - E_{\\mathrm{trim}}$. Round your answer to four significant figures. Express the final value of $\\Delta E$ as a decimal.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is based on standard principles of bioinformatics (Phred quality scores) and probability theory. All necessary information is provided, and the questions are unambiguous.\n\nThe solution proceeds in four parts as requested by the problem statement.\n\n**1. Derivation of the Phred Quality Score Relation**\n\nThe Phred quality score, $Q$, is defined as a function of the base-calling error probability, $p \\in (0,1]$. Let this function be $Q(p)$. The problem specifies three properties for this function:\n- A. A multiplicative change in $p$ corresponds to an additive change in $Q$. Specifically, $Q(p/10) = Q(p) + 10$.\n- B. The function is normalized such that $Q(1) = 0$.\n- C. The function is continuous and strictly decreasing for $p \\in (0,1]$.\n\nProperty A suggests a logarithmic relationship. Let us propose a general form based on the base-10 logarithm, $Q(p) = A \\log_{10}(p) + B$, where $A$ and $B$ are constants to be determined.\n\nUsing property A:\n$$\nQ(p/10) = A \\log_{10}(p/10) + B\n$$\nUsing the properties of logarithms, $\\log_{10}(p/10) = \\log_{10}(p) - \\log_{10}(10) = \\log_{10}(p) - 1$.\n$$\nQ(p/10) = A (\\log_{10}(p) - 1) + B = A \\log_{10}(p) - A + B\n$$\nWe are given that $Q(p/10) = Q(p) + 10$. Substituting the proposed functional form:\n$$\nA \\log_{10}(p) - A + B = (A \\log_{10}(p) + B) + 10\n$$\n$$\n-A = 10 \\implies A = -10\n$$\nSo, the function has the form $Q(p) = -10 \\log_{10}(p) + B$.\n\nNext, we use the normalization condition (Property B), $Q(1) = 0$.\n$$\nQ(1) = -10 \\log_{10}(1) + B = 0\n$$\nSince $\\log_{10}(1) = 0$, this simplifies to $B = 0$.\n\nThus, the functional relation between $Q$ and $p$ is:\n$$\nQ(p) = -10 \\log_{10}(p)\n$$\nThis relation also satisfies Property C. The function is continuous for $p \\in (0,1]$. Its derivative, $\\frac{dQ}{dp} = \\frac{-10}{p \\ln(10)}$, is negative for all $p > 0$, confirming that $Q(p)$ is a strictly decreasing function of $p$.\n\nFor the subsequent calculations, it is necessary to express the error probability $p$ as a function of the quality score $Q$. Rearranging the equation:\n$$\n-\\frac{Q}{10} = \\log_{10}(p)\n$$\n$$\np(Q) = 10^{-Q/10}\n$$\n\n**2. Expected Errors in the Full Read ($E_{\\mathrm{full}}$)**\n\nThe expected number of errors in a read is the sum of the individual error probabilities for each base, $E = \\sum_i p_i$. The read has a length of $L=20$ bases, with quality scores given by the vector:\n$$\n\\mathbf{Q} = (35, 35, 30, 30, 28, 28, 25, 25, 22, 22, 20, 18, 18, 15, 15, 12, 12, 10, 10, 8)\n$$\nThe expected number of errors for the full read, $E_{\\mathrm{full}}$, is the sum of the error probabilities corresponding to each quality score:\n$$\nE_{\\mathrm{full}} = \\sum_{i=1}^{20} p_i = \\sum_{i=1}^{20} 10^{-Q_i/10}\n$$\nThe sum can be computed by grouping identical quality scores:\n$$\nE_{\\mathrm{full}} = 2 \\times 10^{-35/10} + 2 \\times 10^{-30/10} + 2 \\times 10^{-28/10} + 2 \\times 10^{-25/10} + 2 \\times 10^{-22/10} + 1 \\times 10^{-20/10} + 2 \\times 10^{-18/10} + 2 \\times 10^{-15/10} + 2 \\times 10^{-12/10} + 2 \\times 10^{-10/10} + 1 \\times 10^{-8/10}\n$$\n$$\nE_{\\mathrm{full}} = 2 \\times 10^{-3.5} + 2 \\times 10^{-3.0} + 2 \\times 10^{-2.8} + 2 \\times 10^{-2.5} + 2 \\times 10^{-2.2} + 10^{-2.0} + 2 \\times 10^{-1.8} + 2 \\times 10^{-1.5} + 2 \\times 10^{-1.2} + 2 \\times 10^{-1.0} + 10^{-0.8}\n$$\nCalculating the terms and summing them gives:\n$$\nE_{\\mathrm{full}} \\approx 0.00063246 + 0.002 + 0.00316228 + 0.00630957 + 0.01258925 + 0.01 + 0.03162278 + 0.06309573 + 0.12589254 + 0.2 + 0.15848932 \\approx 0.61379393\n$$\n\n**3. Expected Errors in the Trimmed Read ($E_{\\mathrm{trim}}$)**\n\nSuffix quality trimming is performed with a threshold $Q_{\\mathrm{thr}} = 20$. The procedure is to remove bases from the $3'$ end until the last retained base has a quality score $Q \\ge Q_{\\mathrm{thr}}$.\nWe inspect the quality score vector $\\mathbf{Q}$ from right to left (from index $20$ down to $1$).\n- $Q_{20}=8  20$\n- $Q_{19}=10  20$\n- $Q_{18}=10  20$\n- ...\n- $Q_{12}=18  20$\n- $Q_{11}=20 \\ge 20$\n\nThe last base that satisfies the condition is at index $11$. Therefore, all bases from index $12$ to $20$ are trimmed off. The trimmed read consists of the first $11$ bases, with quality scores:\n$$\n\\mathbf{Q}_{\\mathrm{trim}} = (35, 35, 30, 30, 28, 28, 25, 25, 22, 22, 20)\n$$\nThe expected number of errors for the trimmed read, $E_{\\mathrm{trim}}$, is the sum of the error probabilities for these $11$ bases:\n$$\nE_{\\mathrm{trim}} = \\sum_{i=1}^{11} 10^{-Q_i/10}\n$$\n$$\nE_{\\mathrm{trim}} = 2 \\times 10^{-3.5} + 2 \\times 10^{-3.0} + 2 \\times 10^{-2.8} + 2 \\times 10^{-2.5} + 2 \\times 10^{-2.2} + 10^{-2.0}\n$$\nCalculating this sum:\n$$\nE_{\\mathrm{trim}} \\approx 0.00063246 + 0.002 + 0.00316228 + 0.00630957 + 0.01258925 + 0.01 \\approx 0.03469356\n$$\n\n**4. Reduction in Expected Errors ($\\Delta E$)**\n\nThe reduction in expected errors due to trimming is the difference between the expected errors of the full read and the trimmed read:\n$$\n\\Delta E = E_{\\mathrm{full}} - E_{\\mathrm{trim}}\n$$\nThis value is equivalent to the sum of the error probabilities of the bases that were trimmed. The trimmed bases are those from index $12$ to $20$, with quality scores $(18, 18, 15, 15, 12, 12, 10, 10, 8)$.\n$$\n\\Delta E = \\sum_{i=12}^{20} 10^{-Q_i/10} = 2 \\times 10^{-1.8} + 2 \\times 10^{-1.5} + 2 \\times 10^{-1.2} + 2 \\times 10^{-1.0} + 10^{-0.8}\n$$\nUsing the values from the previous calculations:\n$$\n\\Delta E = E_{\\mathrm{full}} - E_{\\mathrm{trim}} \\approx 0.61379393 - 0.03469356 \\approx 0.57910037\n$$\nThe problem requires this value to be rounded to four significant figures. The first four significant figures are $5, 7, 9, 1$. The fifth digit is $0$, so we round down.\n$$\n\\Delta E \\approx 0.5791\n$$\nThis is the reduction in the expected number of sequencing errors achieved by trimming the low-quality tail of the read.",
            "answer": "$$\n\\boxed{0.5791}\n$$"
        },
        {
            "introduction": "Once sequence data quality is assessed, a core task is to find regions of significant similarity between sequences, a cornerstone of database searching. This exercise delves into the Smith-Waterman algorithm, the classic dynamic programming method for finding optimal local alignments. By working through this hands-on calculation , you will build the dynamic programming matrix and see how a biologically motivated scoring scheme and the critical \"zero-reset\" feature work together to identify high-scoring subsequences, ignoring low-scoring flanking regions.",
            "id": "3863057",
            "problem": "In computational chemical biology, local sequence alignment underpins search and retrieval tasks in bioinformatics databases such as the National Center for Biotechnology Information (NCBI) and the Universal Protein Resource (UniProt). Local alignment identifies the highest-scoring subsequences between two biological polymers based on a biologically informed scoring scheme, and its dynamic programming implementation uses a zero-reset to prevent low-scoring regions from degrading otherwise meaningful local matches.\n\nConsider two short Deoxyribonucleic Acid (DNA) sequences encoded as nucleotides:\n$$\nX = (\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A}, \\mathrm{G}, \\mathrm{T}),\n\\quad\nY = (\\mathrm{G}, \\mathrm{A}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A}, \\mathrm{C}, \\mathrm{T}).\n$$\nUse a biologically motivated scoring function based on chemical classes of nucleotides: adenine and guanine are purines, cytosine and thymine are pyrimidines. Define a substitution score $s(\\alpha,\\beta)$ for any $\\alpha,\\beta \\in \\{\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}\\}$ by\n- identical nucleotides: $s(\\alpha,\\alpha) = +3$,\n- transitions (purine $\\leftrightarrow$ purine, $\\mathrm{A} \\leftrightarrow \\mathrm{G}$; pyrimidine $\\leftrightarrow$ pyrimidine, $\\mathrm{C} \\leftrightarrow \\mathrm{T}$): $s(\\alpha,\\beta) = -1$ for $\\alpha \\neq \\beta$,\n- transversions (purine $\\leftrightarrow$ pyrimidine, all other mismatches): $s(\\alpha,\\beta) = -3$,\nand use a linear gap penalty $d = -2$ for insertions or deletions.\n\nApply the principles of local alignment with dynamic programming and zero-reset to compute an explicit example of a high-scoring local alignment between $X$ and $Y$, and explain where and why a zero-reset occurs in the computation to enable detection of high-scoring subsequences that would otherwise be obscured by low-scoring flanking regions. Report, as your final answer, the maximal local alignment score under this scoring scheme. No rounding is required. Express the final answer as a real number without units.",
            "solution": "The problem requires the computation of the maximal local alignment score between two Deoxyribonucleic Acid (DNA) sequences, $X$ and $Y$, using the Smith-Waterman dynamic programming algorithm. This algorithm is fundamental to bioinformatics for finding regions of similarity between sequences.\n\nFirst, we establish the given parameters. The two sequences are:\n$$\nX = (\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A}, \\mathrm{G}, \\mathrm{T}) \\quad \\text{of length } m=7\n$$\n$$\nY = (\\mathrm{G}, \\mathrm{A}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A}, \\mathrm{C}, \\mathrm{T}) \\quad \\text{of length } n=7\n$$\nThe scoring scheme is based on the chemical classes of nucleotides. Adenine (A) and Guanine (G) are purines. Cytosine (C) and Thymine (T) are pyrimidines. The substitution score $s(\\alpha, \\beta)$ is defined as:\n- $s(\\alpha, \\alpha) = +3$ for identical nucleotides.\n- $s(\\alpha, \\beta) = -1$ for transitions (purine $\\leftrightarrow$ purine, pyrimidine $\\leftrightarrow$ pyrimidine), where $\\alpha \\neq \\beta$.\n- $s(\\alpha, \\beta) = -3$ for transversions (purine $\\leftrightarrow$ pyrimidine).\nThe linear gap penalty is $d = -2$.\n\nBased on these rules, we can construct the substitution scoring matrix, which we will denote as $S$:\n$$\nS =\n\\bordermatrix{  \\mathrm{A}  \\mathrm{C}  \\mathrm{G}  \\mathrm{T} \\cr\n\\mathrm{A}  +3  -3  -1  -3 \\cr\n\\mathrm{C}  -3  +3  -3  -1 \\cr\n\\mathrm{G}  -1  -3  +3  -3 \\cr\n\\mathrm{T}  -3  -1  -3  +3 \\cr\n}\n$$\n\nThe Smith-Waterman algorithm uses a dynamic programming matrix, let's call it $H$, of size $(n+1) \\times (m+1)$, which is $8 \\times 8$ in this case. The entry $H_{i,j}$ stores the maximum score of any alignment ending at position $i$ of sequence $Y$ and position $j$ of sequence $X$. The matrix is initialized with $H_{i,0} = 0$ for $i \\in [0, n]$ and $H_{0,j} = 0$ for $j \\in [0, m]$.\n\nEach cell $H_{i,j}$ for $i > 0$ and $j > 0$ is computed using the following recurrence relation, which includes the crucial zero-reset:\n$$\nH_{i,j} = \\max\n\\begin{cases}\n    0  \\text{(start of a new alignment)} \\\\\n    H_{i-1, j-1} + s(Y_i, X_j)  \\text{(match/mismatch)} \\\\\n    H_{i-1, j} + d  \\text{(deletion in } X, \\text{ gap in } X) \\\\\n    H_{i, j-1} + d  \\text{(insertion in } X, \\text{ gap in } Y)\n\\end{cases}\n$$\nwhere $X_j$ is the $j$-th nucleotide of $X$ and $Y_i$ is the $i$-th nucleotide of $Y$.\n\nWe now populate the matrix $H$. The columns correspond to sequence $X$ and the rows to sequence $Y$.\n\n$$\nH =\n\\bordermatrix{\n \\emptyset  \\mathrm{A}_{1}  \\mathrm{C}_{2}  \\mathrm{G}_{3}  \\mathrm{T}_{4}  \\mathrm{A}_{5}  \\mathrm{G}_{6}  \\mathrm{T}_{7} \\cr\n\\emptyset  0  0  0  0  0  0  0  0 \\cr\n\\mathrm{G}_{1}  0  0  0  3  1  0  3  1 \\cr\n\\mathrm{A}_{2}  0  3  1  1  0  4  2  0 \\cr\n\\mathrm{G}_{3}  0  1  0  4  2  2  7  5 \\cr\n\\mathrm{T}_{4}  0  0  0  2  7  5  5  10 \\cr\n\\mathrm{A}_{5}  0  3  1  0  5  10  8  8 \\cr\n\\mathrm{C}_{6}  0  1  6  4  3  8  7  7 \\cr\n\\mathrm{T}_{7}  0  0  4  3  7  6  5  10 \\cr\n}\n$$\n\nThe maximal score in the matrix $H$ is the maximal local alignment score. Inspecting the matrix, we find the maximum value is $10$. This score appears at three locations: $H_{4,7}$, $H_{5,5}$, and $H_{7,7}$. This indicates that there are at least three distinct local alignments that achieve this maximal score.\n\nThe problem requires an explicit example of a high-scoring local alignment. We can find one by performing a traceback from one of the maximal score cells, for instance $H_{5,5} = 10$.\n1.  Start at $H_{5,5} = 10$. This score was obtained from $H_{4,4} + s(Y_5, X_5) = H_{4,4} + s(\\mathrm{A}, \\mathrm{A}) = 7 + 3 = 10$. This corresponds to a diagonal move, aligning $Y_5=\\mathrm{A}$ with $X_5=\\mathrm{A}$. We move to $H_{4,4}$.\n2.  From $H_{4,4} = 7$. This score came from $H_{3,3} + s(Y_4, X_4) = H_{3,3} + s(\\mathrm{T}, \\mathrm{T}) = 4 + 3 = 7$. This is a diagonal move, aligning $Y_4=\\mathrm{T}$ with $X_4=\\mathrm{T}$. We move to $H_{3,3}$.\n3.  From $H_{3,3} = 4$. This score came from $H_{2,2} + s(Y_3, X_3) = H_{2,2} + s(\\mathrm{G}, \\mathrm{G}) = 1 + 3 = 4$. This is a diagonal move, aligning $Y_3=\\mathrm{G}$ with $X_3=\\mathrm{G}$. We move to $H_{2,2}$.\n4.  From $H_{2,2} = 1$. This score was from $H_{2,1} + d = 3 - 2 = 1$. This is a left move, which corresponds to aligning $X_2=\\mathrm{C}$ with a gap in sequence $Y$. We move to $H_{2,1}$.\n5.  From $H_{2,1} = 3$. This score came from $H_{1,0} + s(Y_2, X_1) = H_{1,0} + s(\\mathrm{A}, \\mathrm{A}) = 0 + 3 = 3$. This is a diagonal move, aligning $Y_2=\\mathrm{A}$ with $X_1=\\mathrm{A}$. We move to $H_{1,0}$.\n6.  The traceback terminates at $H_{1,0} = 0$.\n\nReconstructing the alignment from the traceback (in reverse order):\n$$\n\\begin{array}{cccccc}\n\\text{X:}  \\mathrm{A}  \\mathrm{C}  \\mathrm{G}  \\mathrm{T}  \\mathrm{A} \\\\\n\\text{Y:}  \\mathrm{A}  -  \\mathrm{G}  \\mathrm{T}  \\mathrm{A}\n\\end{array}\n$$\nThe score of this alignment is $s(\\mathrm{A},\\mathrm{A}) + d + s(\\mathrm{G},\\mathrm{G}) + s(\\mathrm{T},\\mathrm{T}) + s(\\mathrm{A},\\mathrm{A}) = 3 + (-2) + 3 + 3 + 3 = 10$, which confirms our calculation. This alignment involves the subsequences $X[1..5] = (\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A})$ and $Y[2..5] = (\\mathrm{A}, \\mathrm{G}, \\mathrm{T}, \\mathrm{A})$.\n\nThe zero-reset is the key feature that distinguishes local from global alignment. A zero-reset occurs whenever the scores from extending a previous alignment (diagonally, from above, or from the left) are all negative. In such a case, the algorithm \"forgets\" the low-scoring extensions and starts a new potential local alignment from that point with a score of $0$.\n\nAn example of a zero-reset can be observed at cell $H_{1,1}$.\n$$\nH_{1,1} = \\max \\begin{cases}\n    0 \\\\\n    H_{0,0} + s(Y_1, X_1) = 0 + s(\\mathrm{G}, \\mathrm{A}) = -1 \\\\\n    H_{0,1} + d = 0 - 2 = -2 \\\\\n    H_{1,0} + d = 0 - 2 = -2\n\\end{cases}\n= \\max\\{0, -1, -2, -2\\} = 0\n$$\nHere, aligning the prefixes $X[1]=\\mathrm{A}$ and $Y[1]=\\mathrm{G}$ results in a negative score ($s(\\mathrm{A},\\mathrm{G}) = -1$), as does starting with a gap ($d=-2$). Because all possibilities for extending an alignment into this cell result in a negative cumulative score, the algorithm resets the score to $0$. This mechanism prevents low-scoring initial regions (like the A/G mismatch at the start of the sequences) from penalizing and thus obscuring a high-scoring local alignment that might occur later in the sequences, which is precisely the alignment we found starting at $X_1$ and $Y_2$.\n\nThe maximal local alignment score is the highest value found in the matrix $H$.\n$$\nS_{\\text{max}} = \\max_{i,j} H_{i,j} = 10\n$$",
            "answer": "$$\n\\boxed{10}\n$$"
        },
        {
            "introduction": "Beyond comparing two simple sequences, bioinformatics often requires aligning sequences that reflect complex biological processes. This practice explores spliced alignment, a specialized method for mapping a mature transcript sequence (as a cDNA) back to its original genomic locus, which includes non-coding introns. In this problem , you will justify and apply a sophisticated scoring scheme that distinguishes between a common biological event (splicing) and a rare, deleterious mutation (a frameshift), providing insight into how alignment algorithms are tailored to reflect biological reality.",
            "id": "3863059",
            "problem": "A complementary DNA (cDNA) sequence derived from a mature messenger RNA is aligned to its genomic locus that contains one intron between two exons. The alignment should reflect that cDNA lacks introns, while the genomic region contains them, and that single-nucleotide insertions or deletions in coding sequence cause frameshifts that are much rarer than canonical splicing. Start from the Central Dogma of Molecular Biology (DNA transcribed to RNA and translated in codons of length $3$) and the definition of a spliced alignment (cDNA aligns to exon segments of genomic DNA with intronic segments skipped as a single event), and use these principles to justify a biologically plausible scoring scheme that treats introns and frameshifts differently. Then compute the optimal spliced alignment score under the specified scheme.\n\nGenomic region $G$ (exon–intron–exon, written $5'$ to $3'$):\n- Exon $1$: ATGGAA\n- Intron: GTACCAAG\n- Exon $2$: CTTTAA\n\nThus $G = \\text{ATGGAA}\\,\\text{GTACCAAG}\\,\\text{CTTTAA}$.\n\ncDNA sequence $C$ (exon $1$ followed by exon $2$ with a single-nucleotide insertion in exon $2$):\n- $C = \\text{ATGGAACCTTTAA}$\n\nAdopt the following scoring regime for a spliced alignment of $C$ to $G$:\n- Exonic letter–letter alignment: match $+2$, mismatch $-1$.\n- Gaps within exonic regions (indels relative to coding sequence):\n  - If the gap length $L$ satisfies $L \\equiv 0 \\pmod{3}$ (codon-respecting), the penalty is gap-open $-5$ plus gap-extend $-2$ per gap nucleotide.\n  - If $L \\not\\equiv 0 \\pmod{3}$ (frameshift), the penalty is gap-open $-9$ plus gap-extend $-2$ per gap nucleotide.\n- Intron skip (aligning a cDNA gap across a contiguous intron in $G$): intron-open $-3$, intron-extend $0$ per intronic nucleotide, and a splice-site bonus $+3$ if and only if the intron is canonical “GT…AG” (beginning with GT and ending with AG); otherwise $0$ bonus.\n\nJustify briefly, based on the codon structure and prevalence of splicing, why the intron skip should be less penalized than a frameshift. Then, compute the optimal spliced alignment score between $C$ and $G$ using the above scheme. Report only the optimal total alignment score as an exact integer (unitless).",
            "solution": "The problem is valid as it is scientifically grounded in the principles of molecular biology and bioinformatics, is well-posed with a clear objective and a complete set of rules, and free of contradictions or ambiguities.\n\nThe solution consists of two parts: a justification for the scoring scheme and the calculation of the optimal alignment score.\n\n**Justification of the Scoring Scheme**\n\nThe Central Dogma of Molecular Biology states that genetic information flows from DNA to RNA to protein. In eukaryotes, this process involves several key steps relevant to this problem.\n$1$. **Transcription**: A gene in the genomic DNA, composed of exons (coding regions) and introns (non-coding regions), is transcribed into a pre-messenger RNA (pre-mRNA) molecule that is a copy of the entire gene, including introns.\n$2$. **Splicing**: The pre-mRNA undergoes a crucial processing step called splicing, where the introns are precisely excised, and the exons are ligated together to form a mature messenger RNA (mRNA). This process is a fundamental and highly prevalent part of gene expression in eukaryotes. The resulting mRNA contains a continuous coding sequence.\n$3$. **Translation**: The mature mRNA is then translated into a protein. The ribosome reads the mRNA sequence in successive, non-overlapping groups of three nucleotides called codons. Each codon specifies a particular amino acid. The sequence of codons thus dictates the sequence of amino acids in the resulting protein, which in turn determines the protein's structure and function.\n\nAn alignment of a complementary DNA (cDNA) sequence, which is a DNA copy of a mature mRNA, to its corresponding genomic DNA locus must account for the introns. The alignment model achieves this by allowing a \"skip\" over the intronic region in the genomic sequence. This skip is not a mutation but a representation of the biological splicing event. Because splicing is a common and essential process for producing a functional protein, a biologically plausible scoring scheme should assign a relatively low penalty to this event. The given scheme with an intron-open penalty of $-3$ and an intron-extend penalty of $0$ reflects this. The bonus of $+3$ for canonical \"GT...AG\" splice sites further refines this model, as these signal sequences are highly conserved and facilitate correct splicing.\n\nIn contrast, a frameshift mutation is an insertion or deletion (indel) of a number of nucleotides in the coding sequence that is not divisible by three. Such a mutation shifts the triplet reading frame for all downstream codons. For example, if a sequence `AUG|GAA|CUU|...` has a single nucleotide `C` inserted after the first codon, it becomes `AUG|CGA|ACU|U...`. This alters every subsequent codon, leading to a drastically different amino acid sequence and typically resulting in a premature stop codon, yielding a truncated and non-functional protein. Frameshift mutations are rare stochastic events and are almost always highly deleterious to the organism. Consequently, a scoring scheme should penalize them very heavily to reflect their low biological probability and severe functional impact. The given scheme correctly implements this by assigning a large gap-open penalty of $-9$ for frameshift indels (where length $L \\not\\equiv 0 \\pmod 3$), which is significantly harsher than the penalty for codon-respecting indels ($L \\equiv 0 \\pmod 3$) or for intron skips.\n\nIn summary, the differential penalization of intron skips versus frameshifts is justified because the former represents a common, necessary biological process (splicing), while the latter represents a rare, catastrophic mutational event.\n\n**Calculation of the Optimal Spliced Alignment Score**\n\nThe alignment is between the genomic sequence $G$ and the cDNA sequence $C$.\n$G = \\text{ATGGAA}\\,\\text{GTACCAAG}\\,\\text{CTTTAA}$\n$C = \\text{ATGGAACCTTTAA}$\n\nThe structure of a spliced alignment assumes that exonic parts of $C$ align to exonic parts of $G$, and introns in $G$ are skipped. We calculate the score for the optimal alignment that follows this exon-intron-exon structure.\n\n$1$. **Alignment of Exon 1:**\nThe first part of $C$ is `ATGGAA`, and Exon $1$ of $G$ is `ATGGAA`. They are identical.\nThe alignment is a perfect match of $6$ nucleotides.\n`G: A T G G A A`\n`C: A T G G A A`\nScore for this part: $6 \\text{ matches} \\times (+2 \\text{ per match}) = +12$.\n\n$2$. **Intron Skip:**\nThe intron in $G$ is `GTACCAAG`. Its length is $8$ nucleotides. The cDNA, being derived from mature mRNA, does not contain this sequence. The alignment must therefore \"skip\" this region in $G$.\nThe scoring rule for an intron skip is: intron-open penalty of $-3$, plus an intron-extend penalty of $0$ per nucleotide.\nBase penalty = $-3 + (8 \\times 0) = -3$.\nThe problem specifies a bonus of $+3$ if the intron is canonical, i.e., begins with `GT` and ends with `AG`. The intron `GTACCAAG` satisfies this condition.\nBonus = $+3$.\nTotal score for the intron skip = (Base penalty) + (Bonus) = $-3 + 3 = 0$.\n\n$3$. **Alignment of Exon 2:**\nThe second part of $C$ is `CCTTTAA`, and Exon $2$ of $G$ is `CTTTAA`. We need to find the optimal alignment between these two sequences. The problem states that $C$ contains a single-nucleotide insertion in Exon $2$, which is consistent with the sequences. The alignment must therefore contain a gap of length $1$ in the genomic sequence segment.\nThe optimal alignment is:\n`C: C C T T T A A`\n`G: - C T T T A A`\nThis alignment consists of one gap and $6$ matches. Let's score it.\n- **Gap Score**: The gap has length $L=1$. Since $1 \\not\\equiv 0 \\pmod 3$, this is a frameshift indel.\nThe penalty is: gap-open $-9$ plus gap-extend $-2$ per nucleotide.\nGap penalty = $-9 + (-2 \\times 1) = -11$.\n- **Match Score**: There are $6$ matches (`C`-`C`, `T`-`T`, `T`-`T`, `T`-`T`, `A`-`A`, `A`-`A`).\nMatch score = $6 \\times (+2) = +12$.\nTotal score for the Exon $2$ alignment = (Gap penalty) + (Match score) = $-11 + 12 = +1$.\n\n**Total Optimal Alignment Score:**\nThe total score is the sum of the scores from the three parts.\nTotal Score = (Score Exon $1$) + (Score Intron Skip) + (Score Exon $2$)\nTotal Score = $12 + 0 + 1 = 13$.",
            "answer": "$$\\boxed{13}$$"
        }
    ]
}