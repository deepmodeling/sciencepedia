{
    "hands_on_practices": [
        {
            "introduction": "At the heart of template identification is sequence alignment, which relies on a scoring system to evaluate how well two sequences match. This exercise delves into the affine gap penalty model, a sophisticated method that distinguishes between the cost of opening a new gap, $g$, and extending an existing one, $e$. By calculating the exact gap penalty value that makes two different alignments equally likely, you will gain a quantitative understanding of the critical trade-off between residue mismatches and insertions or deletions .",
            "id": "3848787",
            "problem": "A computational chemical biology workflow for homology modeling begins with identifying an appropriate structural template via sequence homology and then constructing a reliable sequence alignment between the query and the candidate template. In template identification, alignments are scored using an amino acid substitution matrix and affine gap penalties. Consider the query sequence $Q =$ \"M A D K G\" and a candidate template sequence $T =$ \"M A K D G\". Two plausible global alignments are proposed by a dynamic programming algorithm:\n- Ungapped alignment $U$: positions aligned as $(\\mathrm{M}/\\mathrm{M}), (\\mathrm{A}/\\mathrm{A}), (\\mathrm{D}/\\mathrm{K}), (\\mathrm{K}/\\mathrm{D}), (\\mathrm{G}/\\mathrm{G})$.\n- Gapped alignment $V$: positions aligned as $(\\mathrm{M}/\\mathrm{M}), (\\mathrm{A}/\\mathrm{A}), (-/\\mathrm{K}), (\\mathrm{D}/-), (\\mathrm{K}/\\mathrm{D}), (\\mathrm{G}/\\mathrm{G})$, where $-$ denotes a gap character. The gap pattern in $V$ contains two separate single-residue gap segments (one in $Q$, one in $T$), each of length $L=1$.\n\nUse the Blocks Substitution Matrix (BLOSUM62) entries restricted to the following pairs:\n$s(\\mathrm{M},\\mathrm{M})=5$, $s(\\mathrm{A},\\mathrm{A})=4$, $s(\\mathrm{G},\\mathrm{G})=6$, $s(\\mathrm{K},\\mathrm{K})=5$, and $s(\\mathrm{D},\\mathrm{K})=s(\\mathrm{K},\\mathrm{D})=-1$.\nAssume affine gap penalties, where the cost of a single contiguous gap segment of length $L$ is $g+(L-1)e$, with $g>0$ the gap-open penalty and $e \\ge 0$ the gap-extend penalty. The total alignment score is the sum of substitution scores over aligned residue pairs minus the sum of gap costs over all gap segments.\n\nTask:\n1. Compute the alignment score for $U$ and for $V$ as functions of $g$ and $e$ using the specified BLOSUM62 entries and the affine gap penalty definition.\n2. Determine the exact value $g^{*}$ (a single real number) such that the two alignments $U$ and $V$ have equal total score for any choice of $e$ consistent with the given definition. No rounding is required.\n\nProvide only the final numeric value $g^{*}$ in your final answer.",
            "solution": "The problem requires the determination of a specific value for the gap-opening penalty, denoted as $g^{*}$, at which two different alignments, one ungapped ($U$) and one gapped ($V$), of two protein sequences obtain the same total score. The total score is calculated using a substitution matrix and an affine gap penalty model.\n\nFirst, we shall calculate the total alignment score for the ungapped alignment, $S_U$.\nThe alignment $U$ is given as the sequence of aligned pairs: $(\\mathrm{M}/\\mathrm{M}), (\\mathrm{A}/\\mathrm{A}), (\\mathrm{D}/\\mathrm{K}), (\\mathrm{K}/\\mathrm{D}), (\\mathrm{G}/\\mathrm{G})$.\nSince there are no gaps in this alignment, the total score is purely the sum of the substitution scores for each pair. The provided BLOSUM62 substitution scores are $s(\\mathrm{M},\\mathrm{M})=5$, $s(\\mathrm{A},\\mathrm{A})=4$, $s(\\mathrm{D},\\mathrm{K})=-1$, $s(\\mathrm{K},\\mathrm{D})=-1$, and $s(\\mathrm{G},\\mathrm{G})=6$.\nThe score $S_U$ is therefore:\n$$S_U = s(\\mathrm{M},\\mathrm{M}) + s(\\mathrm{A},\\mathrm{A}) + s(\\mathrm{D},\\mathrm{K}) + s(\\mathrm{K},\\mathrm{D}) + s(\\mathrm{G},\\mathrm{G})$$\nSubstituting the given values:\n$$S_U = 5 + 4 + (-1) + (-1) + 6 = 13$$\nThe score $S_U$ is a constant value of $13$.\n\nNext, we calculate the total alignment score for the gapped alignment, $S_V$.\nThe alignment $V$ is given as: $(\\mathrm{M}/\\mathrm{M}), (\\mathrm{A}/\\mathrm{A}), (-/\\mathrm{K}), (\\mathrm{D}/-), (\\mathrm{K}/\\mathrm{D}), (\\mathrm{G}/\\mathrm{G})$.\nThe total score $S_V$ is the sum of substitution scores for aligned residues minus the total cost of the gaps.\n\nThe substitution score component of $S_V$ is the sum of scores for the non-gap pairs: $(\\mathrm{M}/\\mathrm{M})$, $(\\mathrm{A}/\\mathrm{A})$, $(\\mathrm{K}/\\mathrm{D})$, and $(\\mathrm{G}/\\mathrm{G})$.\n$$S_{V, \\text{subst}} = s(\\mathrm{M},\\mathrm{M}) + s(\\mathrm{A},\\mathrm{A}) + s(\\mathrm{K},\\mathrm{D}) + s(\\mathrm{G},\\mathrm{G})$$\nSubstituting the given values:\n$$S_{V, \\text{subst}} = 5 + 4 + (-1) + 6 = 14$$\n\nThe gap penalty component must be calculated based on the affine gap penalty model, where the cost of a single contiguous gap of length $L$ is $g + (L-1)e$. The alignment $V$ contains two separate gap segments:\n1. One gap in the query sequence $Q$, corresponding to $(-/\\mathrm{K})$. This is a gap segment of length $L_1 = 1$.\n2. One gap in the template sequence $T$, corresponding to $(\\mathrm{D}/-)$. This is a gap segment of length $L_2 = 1$.\n\nThe cost for the first gap of length $L_1=1$ is:\n$$C_1 = g + (L_1 - 1)e = g + (1-1)e = g$$\nThe cost for the second gap of length $L_2=1$ is:\n$$C_2 = g + (L_2 - 1)e = g + (1-1)e = g$$\nThe total gap penalty for alignment $V$, $P_V$, is the sum of the costs of these two individual gap segments:\n$$P_V = C_1 + C_2 = g + g = 2g$$\n\nThe total score for alignment $V$ is the substitution score minus the total gap penalty:\n$$S_V = S_{V, \\text{subst}} - P_V = 14 - 2g$$\nNotably, the score $S_V$ depends only on $g$ and is independent of $e$, because both gaps are of length $L=1$, making the $e$-dependent term zero.\n\nThe final step is to find the value $g=g^{*}$ for which $S_U = S_V$. The problem requires this equality to hold for any valid choice of the gap extension penalty $e \\ge 0$. Since we have shown that neither $S_U$ nor $S_V$ depends on $e$, this condition is satisfied if we can find a value for $g$ that equates the scores.\nSetting the two scores equal:\n$$S_U = S_V$$\n$$13 = 14 - 2g$$\nWe now solve this linear equation for $g$:\n$$2g = 14 - 13$$\n$$2g = 1$$\n$$g = \\frac{1}{2} = 0.5$$\nThe value $g=0.5$ satisfies the given constraint $g>0$. Therefore, the value $g^{*}$ is $0.5$.",
            "answer": "$$\\boxed{0.5}$$"
        },
        {
            "introduction": "While sequence scoring matrices are powerful, the most biologically accurate alignments often incorporate external knowledge about protein function. This practice explores how to enforce the conservation of a critical functional motif, such as the HRD motif in protein kinases, by introducing a scoring bonus or \"prior\" . You will determine the minimum weight this prior must have to favor a gapped, but functionally correct, alignment over a higher-scoring but misaligned alternative, illustrating a key principle in creating meaningful homology models.",
            "id": "3848800",
            "problem": "A hallmark of Ser/Thr protein kinases is the conserved histidine–arginine–aspartate motif (“HRD”) in the catalytic loop. In homology modeling, preserving the registry of such catalytic motifs in template-based alignments is a strong structural prior that can outweigh local score differences elsewhere. Consider a global alignment between a kinase-like query sequence and a kinase template in which the template has its HRD motif at positions $7$–$9$ and the query has an insertion immediately before the motif that shifts the HRD to positions $8$–$10$.\n\nYou are given the following sequences (one-letter amino acid codes):\n- Template $T$: V A I K V L H R D L K P E N G (positions $1$ to $15$; HRD at $7$–$9$)\n- Query $Q$: V A I K V L Q H R D L K P E N (positions $1$ to $15$; HRD at $8$–$10$)\n\nAssume the following alignment scoring, consistent with log-odds–based substitution scoring used in sequence alignment:\n- Substitution score $s(a,b)$: $+1$ if $a=b$ (identity), $0$ if $a \\neq b$ (mismatch).\n- Gap penalty: each gap symbol contributes a score of $-10$.\n- Motif registry prior: an additional weight $W$ is added once to the total alignment score if and only if the HRD motif in the query is aligned in-register to the HRD motif in the template (i.e., $H$ aligns to $H$, $R$ to $R$, and $D$ to $D$ at the template motif positions $7$–$9$), otherwise no motif prior is added.\n\nConsider two specific global alignments:\n- Alignment $\\mathcal{A}$: insert one gap just before the template motif (between template positions $6$ and $7$) so that $Q$’s extra residue at position $7$ aligns to a gap and the query HRD at positions $8$–$10$ aligns in-register to the template HRD at positions $7$–$9$. Because both sequences have equal length, completing the global alignment requires a balancing terminal gap at the end of the query to consume the final template residue.\n- Alignment $\\mathcal{B}$: perform a direct position-wise global alignment with no gaps, which misregisters the query’s HRD (positions $8$–$10$) relative to the template’s HRD (positions $7$–$9$).\n\nStarting from the fundamental definitions of sequence alignment scoring and the rationale that conserved catalytic motifs encode strong evolutionary constraints used in homology modeling, derive an expression for the critical motif weight $W^{*}$ at which the total score of $\\mathcal{A}$ equals the total score of $\\mathcal{B}$, and compute its exact value for the sequences and scoring scheme above. Report $W^{*}$ as a single real number. No rounding is required. Express the final answer without units.",
            "solution": "The problem requires the determination of a critical motif weight, denoted $W^{*}$, for which the total alignment scores of two different global alignments, $\\mathcal{A}$ and $\\mathcal{B}$, are equal. We are given two protein sequences, a template $T$ and a query $Q$, and a specific scoring system.\n\nThe sequences are:\nTemplate $T$: $\\text{V A I K V L H R D L K P E N G}$\nQuery $Q$: $\\text{V A I K V L Q H R D L K P E N}$\nBoth sequences have a length of $15$ residues. The conserved HRD motif is at positions $7$–$9$ in $T$ and $8$–$10$ in $Q$.\n\nThe scoring function is defined by:\n- A substitution score $s(a, b)$ which is $+1$ for an identity ($a=b$) and $0$ for a mismatch ($a \\neq b$).\n- A gap penalty of $-10$ for each gap symbol.\n- A motif registry prior of $W$, which is added to the score if and only if the HRD motif of $Q$ aligns in-register with the HRD motif of $T$.\n\nFirst, we will calculate the score for Alignment $\\mathcal{A}$, denoted $S(\\mathcal{A})$. This alignment is constructed to keep the HRD motifs in-register. This requires introducing a gap in the template sequence to accommodate the extra residue 'Q' in the query sequence at its position $7$. As both sequences are of equal length, a balancing gap is introduced at the end of the query sequence.\n\nAlignment $\\mathcal{A}$ is as follows:\n$T$: V A I K V L - H R D L K P E N G\n$Q$: V A I K V L Q H R D L K P E N -\n\nThe score $S(\\mathcal{A})$ is the sum of the substitution scores, gap penalties, and the motif prior.\n1.  **Substitution Score**: We sum the scores for each aligned pair of residues.\n    -   The pairs at alignment columns $1$–$6$ are all identities ($\\text{V/V, A/A, I/I, K/K, V/V, L/L}$). This contributes $6 \\times (+1) = 6$.\n    -   The pairs at columns $8$–$10$ align the HRD motifs ($\\text{H/H, R/R, D/D}$). These are $3$ identities, contributing $3 \\times (+1) = 3$.\n    -   The pairs at columns $11$–$15$ are also identities ($\\text{L/L, K/K, P/P, E/E, N/N}$). These are $5$ identities, contributing $5 \\times (+1) = 5$.\n    -   The total number of identities is $6 + 3 + 5 = 14$. The substitution score is $14 \\times (+1) = 14$.\n\n2.  **Gap Penalty**: There are two gaps in the alignment.\n    -   One gap in sequence $T$ at column $7$.\n    -   One gap in sequence $Q$ at column $16$.\n    -   The total gap penalty is $2 \\times (-10) = -20$.\n\n3.  **Motif Registry Prior**: By construction, the HRD motifs are aligned in-register. Therefore, the weight $W$ is added to the total score.\n\nThe total score for Alignment $\\mathcal{A}$ is:\n$$S(\\mathcal{A}) = 14 + (-20) + W = W - 6$$\n\nNext, we calculate the score for Alignment $\\mathcal{B}$, denoted $S(\\mathcal{B})$. This is a direct position-wise alignment with no gaps.\n\nAlignment $\\mathcal{B}$ is as follows:\n$T$: V A I K V L H R D L K P E N G\n$Q$: V A I K V L Q H R D L K P E N\n\nThe score $S(\\mathcal{B})$ is calculated as:\n1.  **Substitution Score**: We compare residues at each position $i=1, \\dots, 15$.\n    -   The pairs at positions $1$–$6$ are identities, contributing $6 \\times (+1) = 6$.\n    -   All other pairs from position $7$ to $15$ are mismatches: $\\text{H/Q, R/H, D/R, L/D, K/L, P/K, E/P, N/E, G/N}$. There are $9$ mismatches, each contributing a score of $0$.\n    -   The total substitution score is $6 + (9 \\times 0) = 6$.\n\n2.  **Gap Penalty**: There are no gaps in this alignment. The contribution is $0$.\n\n3.  **Motif Registry Prior**: The HRD motif in $Q$ (positions $8$–$10$) is aligned against residues at positions $8$–$10$ in $T$ ($\\text{R, D, L}$). This is not an in-register alignment with $T$'s HRD motif at positions $7$–$9$. Thus, the motif prior $W$ is not added. The contribution is $0$.\n\nThe total score for Alignment $\\mathcal{B}$ is:\n$$S(\\mathcal{B}) = 6 + 0 + 0 = 6$$\n\nThe problem asks for the critical weight $W^{*}$ where the two scores are equal. We set $S(\\mathcal{A}) = S(\\mathcal{B})$ and solve for $W=W^{*}$:\n$$W^{*} - 6 = 6$$\n$$W^{*} = 12$$\n\nThus, the critical motif weight at which the score of the motif-registered alignment equals the score of the gapless, misregistered alignment is $12$.",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "Real-world structural templates are rarely perfect and often contain unresolved regions like flexible loops where atomic coordinates are missing. This exercise simulates a common challenge in homology modeling: how to create a reliable alignment when the template itself is incomplete . By using a modified scoring scheme where gaps corresponding to missing template residues incur no penalty, you will learn the correct strategy for handling such data imperfections and produce a structurally coherent alignment.",
            "id": "3848814",
            "problem": "You are modeling a homologous enzyme active-site segment by aligning a query sequence to a Protein Data Bank (PDB) template chain that contains a chain break and an unresolved loop. The template chain has known residue identities for all sequence positions, but atomic coordinates are missing for the unresolved loop positions and hence those positions cannot be used to place the query residues structurally. The query segment is of length $7$ with residues $(A, E, K, T, W, Y, D)$ from positions $1$ through $7$. The template segment is of length $9$ with residues $(A, E, K, G, S, T, W, Y, D)$ from positions $1$ through $9$, where positions $4$ and $5$ are unresolved (missing coordinates) and cause the chain break between positions $3$ and $6$.\n\nAssume a position-specific alignment scoring scheme defined as follows: for any aligned pair of residues $(x, y)$ at resolved template positions, the substitution score is $s(x,y)$ with $s(x,y)=+4$ if $x=y$ and $s(x,y)=-1$ otherwise. If the template position is unresolved (missing coordinates), then aligning any query residue to that template position contributes a substitution score of $s_{\\mathrm{miss}}=0$. A gap is a contiguous run of positions in one sequence aligned to residues in the other sequence. For gaps aligned opposite resolved template positions, use an affine gap cost with gap-open penalty $g_o=3$ and gap-extension penalty $g_e=1$ per additional position in the same gap segment. For gaps that align opposite the unresolved template positions $4$ and $5$, set both the gap-open and gap-extension penalties to $0$ (the physically realistic policy for missing coordinates in homology modeling). All other aspects of the alignment are standard, and you must perform a global alignment of the query to the template sequence under these rules.\n\nStarting from first principles, derive the optimal alignment strategy and compute the maximum achievable total alignment score under the described scoring scheme and structural constraints. Express your final answer as a single real number with no units. No rounding is required.",
            "solution": "The problem asks for the maximum alignment score between a query sequence and a template sequence, under a specific and partially position-dependent scoring scheme. This is a global alignment problem that can be solved by considering the principles of dynamic programming.\n\nLet the query sequence be $Q$ of length $L_q = 7$, and the template sequence be $T$ of length $L_t = 9$.\nThe sequences are:\n$Q = (Q_1, ..., Q_7) = \\text{(A, E, K, T, W, Y, D)}$\n$T = (T_1, ..., T_9) = \\text{(A, E, K, G, S, T, W, Y, D)}$\n\nThe total score of an alignment is the sum of substitution scores for all aligned residue pairs and the sum of penalties for all gaps. The objective is to find an alignment that maximizes this total score.\n\nFirst, let us analyze the scoring function and the sequences.\nThe substitution score $s(x,y)$ for aligning residue $x$ with $y$ depends on the template position.\n1.  For resolved template positions $j \\in \\{1, 2, 3, 6, 7, 8, 9\\}$:\n    $s(x,y) = +4$ if $x=y$ (match)\n    $s(x,y) = -1$ if $x \\neq y$ (mismatch)\n2.  For unresolved template positions $j \\in \\{4, 5\\}$:\n    $s(x,y) = s_{\\text{miss}} = 0$ for any pair $(x,y)$.\n\nThe gap penalties also depend on the template positions opposite which the gap is placed. The problem specifies rules for gaps in the query sequence (deletions from the query).\n1.  For a gap in the query opposite a resolved template position, the affine gap cost is defined by a gap-open penalty $g_o = 3$ and a gap-extension penalty $g_e = 1$. The cost for a gap of length $k$ is thus $k+2$.\n2.  For a gap in the query opposite the unresolved template positions $T_4$ and $T_5$, both gap-open and gap-extension penalties are $0$.\n\nThe penalties for gaps in the template sequence (insertions into the query) are not explicitly specified. A scientifically consistent interpretation is that insertions of novel residues, not supported by the template, should incur a standard penalty. We will assume the standard affine penalties ($g_o=3, g_e=1$) apply to all insertions. However, we will demonstrate that any alignment with insertions is suboptimal.\n\nThe fundamental strategy is to maximize the number of high-scoring matches while minimizing penalties. The highest possible substitution score is $+4$ for a match. The query sequence has $L_q = 7$ residues. Therefore, the theoretical maximum for the sum of substitution scores is $7 \\times 4 = 28$. This score would be achieved if and only if every residue in the query sequence is aligned with an identical residue in the template sequence.\n\nLet's examine if such an alignment is possible. By inspecting the sequences:\n$Q = (\\underline{A, E, K}, \\underline{T, W, Y, D})$\n$T = (\\underline{A, E, K}, G, S, \\underline{T, W, Y, D})$\nWe observe that the query sequence $Q$ is identical to the template sequence $T$ if the residues at positions $T_4$ and $T_5$ are removed. This indicates a very high degree of homology and suggests a candidate for the optimal alignment.\n\nLet us construct an alignment based on this observation. We align all matching residues:\n$Q_1$ with $T_1$ (A-A)\n$Q_2$ with $T_2$ (E-E)\n$Q_3$ with $T_3$ (K-K)\n$Q_4$ with $T_6$ (T-T)\n$Q_5$ with $T_7$ (W-W)\n$Q_6$ with $T_8$ (Y-Y)\n$Q_7$ with $T_9$ (D-D)\n\nThis structure requires that the template residues $T_4$ and $T_5$ are aligned with gaps in the query. The resulting alignment is:\nQuery:   $A \\quad E \\quad K \\quad - \\quad - \\quad T \\quad W \\quad Y \\quad D$\nTemplate: $A \\quad E \\quad K \\quad G \\quad S \\quad T \\quad W \\quad Y \\quad D$\n\nNow, we must calculate the total score for this alignment according to the given rules.\nThe score is the sum of scores for the $7$ matched pairs and the cost of the gap in the query.\n\nThe matched pairs are:\n- $(Q_1, T_1)$: $s(A,A)=+4$. $T_1$ is a resolved position.\n- $(Q_2, T_2)$: $s(E,E)=+4$. $T_2$ is a resolved position.\n- $(Q_3, T_3)$: $s(K,K)=+4$. $T_3$ is a resolved position.\n- $(Q_4, T_6)$: $s(T,T)=+4$. $T_6$ is a resolved position.\n- $(Q_5, T_7)$: $s(W,W)=+4$. $T_7$ is a resolved position.\n- $(Q_6, T_8)$: $s(Y,Y)=+4$. $T_8$ is a resolved position.\n- $(Q_7, T_9)$: $s(D,D)=+4$. $T_9$ is a resolved position.\nThe sum of substitution scores is $7 \\times (+4) = 28$.\n\nThe gap is a contiguous segment of length $k=2$ in the query, aligned opposite to $T_4$ and $T_5$.\n- The gap opens opposite $T_4$. Since $T_4$ is an unresolved position, the gap-open penalty is $0$.\n- The gap extends opposite $T_5$. Since $T_5$ is an unresolved position, the gap-extension penalty is $0$.\nThe total cost for this gap is $0$.\n\nThe total alignment score is the sum of substitution scores plus the gap penalty, which is $28 + 0 = 28$.\n\nThis score is equal to the theoretical maximum possible substitution score. Any other alignment must deviate in at least one position, resulting in a lower score:\n- **Introducing a mismatch:** If a query residue $Q_i$ is aligned with a non-identical template residue $T_j$ at a resolved position, the score for this pair is $-1$. This is a loss of $4 - (-1) = 5$ points compared to a match.\n- **Aligning with the unresolved region:** If a query residue $Q_i$ is aligned with $T_4$ or $T_5$, the score is $s_{\\text{miss}} = 0$. This is a loss of $4 - 0 = 4$ points compared to a match.\n- **Introducing a costly gap:** If a gap is introduced in the query opposite a resolved template position, or if a gap is introduced in the template (an insertion), a penalty of at least $g_o = 3$ is incurred. This represents a loss of at least $4 - (-3) = 7$ points relative to a match.\n\nSince the proposed alignment achieves the maximum possible substitution score of $28$ and incurs a total gap penalty of $0$, no other alignment can produce a higher score. Any deviation from this alignment will necessarily introduce either a mismatch or a costly gap, both of which reduce the total score.\n\nTherefore, the optimal alignment strategy is to align the homologous segments on both sides of the unresolved loop ($Q_{1..3}$ with $T_{1..3}$, and $Q_{4..7}$ with $T_{6..9}$) and to bridge the unresolved template region ($T_4, T_5$) by introducing a zero-cost gap in the query. The maximum achievable total alignment score is $28$.",
            "answer": "$$\\boxed{28}$$"
        }
    ]
}