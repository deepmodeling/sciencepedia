{
    "hands_on_practices": [
        {
            "introduction": "在基于配体的虚拟筛选中，一个核心思想是“相似的分子具有相似的生物活性”。这个练习将帮助你掌握一种量化分子相似性的基本方法。我们将使用二进制指纹来表示分子结构，并计算它们之间的Tanimoto系数，这是化学信息学中最常用的相似性度量之一。通过这个实践，你将不仅学会计算，还能深入理解该系数如何权衡共享与独有特征，从而影响化合物的排序。",
            "id": "3869931",
            "problem": "在基于配体的虚拟筛选中，一个核心操作是使用二进制结构指纹，根据与查询分子的相似性对候选分子进行排序。考虑两个分子，它们的长度为$64$位的哈希圆形指纹由比特值为$1$的索引集合表示。设查询分子的指纹为\n$$A=\\{1,3,5,7,8,12,15,16,18,21,26,27,32,33,34,38,44,48,53,57,60\\},$$\n候选分子的指纹为\n$$B=\\{3,5,7,9,12,15,16,18,20,21,24,26,27,30,33,34,35,38,41,44,47,48,57,60,61\\}.$$\n从用于计算虚拟筛选中二进制指纹的Tanimoto系数（也称为Jaccard指数）的常用相似性度量的集合论定义出发，推导将相似性与共享比特数以及每个分子独有的比特数相关联的表达式，然后计算$A$和$B$之间的相似性。最后，解释这种依赖关系如何影响邻域排序，特别是在增加共享比特数与增加独有比特数方面。将最终的数值相似性表示为一个无单位的小数，并四舍五入到四位有效数字。",
            "solution": "在对其前提和目标进行全面审查后，该问题仍然有效。它在科学上基于化学信息学的原理，特别是使用指纹和Tanimoto系数的基于配体的虚拟筛选。该问题提法明确，提供了计算唯一且有意义答案所需的所有数据（代表指纹的两个集合）。其语言客观，定义为该领域的标准定义。\n\n该问题要求分三部分作答：推导Tanimoto系数的一种特定形式，根据给定数据进行计算，并解释其在邻域排序背景下的性质。\n\n首先，我们进行推导。对于两个集合$A$和$B$，Tanimoto系数$T_c$定义为其交集的大小（基数）与并集大小的比值：\n$$T_c(A, B) = \\frac{|A \\cap B|}{|A \\cup B|}$$\n这个定义是基础。根据容斥原理，两个集合的并集的基数可以用它们各自的基数和它们交集的基数来表示：\n$$|A \\cup B| = |A| + |B| - |A \\cap B|$$\n将此式代入Tanimoto系数的定义中，得到：\n$$T_c(A, B) = \\frac{|A \\cap B|}{|A| + |B| - |A \\cap B|}$$\n现在，我们引入问题陈述中指定的术语。设$c$为共享比特数，对应于交集的基数：\n$$c = |A \\cap B|$$\n设$a$为分子$A$独有的比特数，$b$为分子$B$独有的比特数。这些是集合差集的基数：\n$$a = |A \\setminus B| = |A| - |A \\cap B|$$\n$$b = |B \\setminus A| = |B| - |A \\cap B|$$\n根据这些定义，我们可以将$|A|$和$|B|$表示为：\n$$|A| = a + c$$\n$$|B| = b + c$$\n将$|A|$和$|B|$的这些表达式以及$c$的定义代入$T_c(A, B)$的展开公式中：\n$$T_c(A, B) = \\frac{c}{(a+c) + (b+c) - c} = \\frac{c}{a + b + c}$$\n这就是所求的表达式，它将相似性与共享比特数（$c$）以及每个分子独有的比特数（$a$和$b$）关联起来。\n\n其次，我们计算给定指纹$A$和$B$的相似性。\n查询分子的指纹由集合给出：\n$$A=\\{1,3,5,7,8,12,15,16,18,21,26,27,32,33,34,38,44,48,53,57,60\\}$$\n候选分子的指纹由集合给出：\n$$B=\\{3,5,7,9,12,15,16,18,20,21,24,26,27,30,33,34,35,38,41,44,47,48,57,60,61\\}$$\n我们首先确定这些集合的基数。通过计算元素个数，我们得到：\n$$|A| = 21$$\n$$|B| = 25$$\n接下来，我们确定它们的交集$A \\cap B$，其中包含两个集合中都存在的元素：\n$$A \\cap B = \\{3, 5, 7, 12, 15, 16, 18, 21, 26, 27, 33, 34, 38, 44, 48, 57, 60\\}$$\n交集的基数为：\n$$c = |A \\cap B| = 17$$\n现在我们可以使用标准公式计算Tanimoto系数。并集的基数为：\n$$|A \\cup B| = |A| + |B| - |A \\cap B| = 21 + 25 - 17 = 29$$\n因此，Tanimoto系数为：\n$$T_c(A, B) = \\frac{|A \\cap B|}{|A \\cup B|} = \\frac{17}{29}$$\n为了提供数值答案，我们进行除法运算并四舍五入到四位有效数字：\n$$T_c(A, B) = \\frac{17}{29} \\approx 0.58620689... \\approx 0.5862$$\n\n第三，我们解释这种依赖关系如何影响邻域排序。推导出的表达式 $T_c = \\frac{c}{a+b+c}$ 很有启发性。在虚拟筛选中，候选分子根据其与查询分子的相似性进行排序。较高的$T_c$值表示较高的排名。\n该公式表明，相似性得分有两个依赖关系：\n1.  它与共享特征数$c$成正比。\n2.  它与非共享特征数$a$和$b$成反比。\n\n考虑$T_c$相对于每个变量的变化。其偏导数为：\n$$\\frac{\\partial T_c}{\\partial c} = \\frac{(a+b)}{(a+b+c)^2} > 0 \\quad (\\text{for } a+b > 0)$$\n$$\\frac{\\partial T_c}{\\partial a} = \\frac{-c}{(a+b+c)^2}  0 \\quad (\\text{for } c > 0)$$\n$$\\frac{\\partial T_c}{\\partial b} = \\frac{-c}{(a+b+c)^2}  0 \\quad (\\text{for } c > 0)$$\n该分析正式确认了增加共享比特数（$c$）总会增加相似性，而增加任一分子中独有的比特数（$a$或$b$）总会降低相似性。这种结构惩罚了不相似性。对于邻域排序而言，这意味着理想的邻居不仅是那些与查询分子共享许多特征的分子，还包括那些不引入许多新的、非共享特征的分子。Tanimoto系数含蓄地偏好那些在大小或复杂性（就其指纹中置位比特数而言）上与查询分子相似的候选分子。一个非常大的分子可能与查询分子共享中等数量的特征，但其大量的独有特征将导致$b$值很大，从而显著降低其$T_c$得分和排名。相反，一个具有高重叠百分比较小的分子可以获得非常高的$T_c$得分。本质上，使用Tanimoto系数的邻域排序优先考虑的是在比例意义上结构相似的候选分子，而不仅仅是共享子结构绝对数量多的分子。",
            "answer": "$$\\boxed{0.5862}$$"
        },
        {
            "introduction": "转向基于结构的筛选后，我们面临着如何精确预测结合亲和力的挑战，其中一个关键问题是如何处理结合位点中的晶体学水分子。这些水分子可以作为桥梁介导配体与蛋白之间的氢键网络，对结合至关重要，但将它们纳入模型也增加了复杂性。本练习将指导你构建一个基于统计力学原理的物理模型，来量化包含或排除关键水分子对分子对接打分的影响，从而让你体验到高级打分函数的设计思想。",
            "id": "3869902",
            "problem": "您的任务是构建一个基于物理原理的有原则的程序，用于量化在对接模型中包含与排除关键晶体学水分子对计算出的配体与蛋白质结合的对接分数的影响。您必须对水介导的氢键网络进行建模，并使用基于统计力学和物理驱动的氢键几何评分的热力学一致方法来评估其贡献。结果应为单行输出，汇总一组不同测试场景下计算出的差异。\n\n使用的基本原理：\n- 热力学和统计力学：具有离散状态的系统的亥姆霍兹自由能基于配分函数，其一般关系为 $$\\Delta G = -k_B T \\ln Z,$$ 其中 $k_B$ 是 Boltzmann 常数。当能量以每摩尔表示时，摩尔气体常数 $R$ 取代 Boltzmann 常数，得到 $$\\Delta G = -R T \\ln Z.$$ 这是统计热力学中一个经过充分检验的关系。\n- 氢键的几何依赖性：氢键的强度取决于供体-受体之间的距离和角度。一种物理驱动的、依赖于几何的相互作用能可以通过结合距离衰减因子和角度方向性因子来建模。模型必须是明确的，并与典型的氢键物理学相一致，但未经论证不得使用任何临时的简化方法。\n\n定义和建模要求：\n- 定义每个氢键分支（无论是直接的配体-蛋白质键还是水介导的连接）的距离 $r$（单位为埃，记作 $\\text{\\AA}$）和角度 $\\theta$（单位为度）。每个分支的氢键能必须按如下公式计算\n$$E_{\\mathrm{leg}}(r,\\theta) = -\\varepsilon \\cdot \\exp\\!\\big(-\\alpha \\cdot |r - r_0|\\big) \\cdot \\cos^2\\!\\Big(\\frac{\\pi}{180} \\cdot (\\theta - 180)\\Big),$$\n其中 $\\varepsilon$ 是特征氢键强度（单位 $\\mathrm{kJ \\cdot mol^{-1}}$），$\\alpha$ 是距离敏感度（单位 $\\text{\\AA}^{-1}$），$r_0$ 是理想的重原子间距（单位 $\\text{\\AA}$）。该形式捕捉了最佳氢键具有接近 $r_0$ 的 $r$ 和接近 $180^\\circ$ 的 $\\theta$（线性几何）的特点。您必须使用下面提供的数值参数。\n- 一个水介导的氢键网络表示为一系列分支，形成一条从配体经过 $m$ 个水分子到蛋白质的路径：配体 $\\rightarrow$ 水分子 1 $\\rightarrow$ 水分子 2 $\\rightarrow \\cdots \\rightarrow$ 水分子 $m$ $\\rightarrow$ 蛋白质，产生 $m+1$ 个分支。整个网络的存在由各个水分子的占据概率的乘积决定。约束网络中的每个水分子都会带来每个水分子的自由能惩罚，该惩罚必须加到存在状态的能量中。\n- 对于一个给定的具有 $m_j$ 个水分子的网络 $j$，其分支为 $\\{(r_\\ell,\\theta_\\ell)\\}_{\\ell=1}^{m_j+1}$，每个水分子的惩罚为 $\\{\\Delta G_{\\mathrm{pen},i}\\}_{i=1}^{m_j}$（单位 $\\mathrm{kJ \\cdot mol^{-1}}$），水分子存在概率为 $\\{p_i\\}_{i=1}^{m_j}$，定义网络存在概率为 $$p_{\\mathrm{net},j} = \\prod_{i=1}^{m_j} p_i.$$ 定义存在状态的能量为 $$E_{\\mathrm{present},j} = \\sum_{\\ell=1}^{m_j+1} E_{\\mathrm{leg}}(r_\\ell,\\theta_\\ell) + \\sum_{i=1}^{m_j} \\Delta G_{\\mathrm{pen},i}.$$ 不存在状态的能量为 $0$。那么网络 $j$ 的有效自由能贡献为\n$$\\Delta G_{\\mathrm{net},j} = -R T \\cdot \\ln\\!\\Big(p_{\\mathrm{net},j} \\cdot e^{-E_{\\mathrm{present},j}/(R T)} + (1 - p_{\\mathrm{net},j}) \\cdot e^{-0/(R T)}\\Big) = -R T \\cdot \\ln\\!\\Big(p_{\\mathrm{net},j} \\cdot e^{-E_{\\mathrm{present},j}/(R T)} + 1 - p_{\\mathrm{net},j}\\Big).$$\n- 始终在几何上可及的直接配体-蛋白质氢键，其贡献是确定性的，为 $$E_{\\mathrm{direct,base}} = \\sum_{d \\in D_0} E_{\\mathrm{leg}}(r_d,\\theta_d).$$ 由于空间位阻或竞争性相互作用，一些直接的配体-蛋白质键可能仅在排除水分子时才可及。将此类贡献定义为 $$E_{\\mathrm{direct,excl}} = \\sum_{d \\in D_{\\mathrm{excl}}} E_{\\mathrm{leg}}(r_d,\\theta_d),$$ 它们只在排除水分子的情况下加入。\n- 包含水分子模型的对接分数为 $$S_{\\mathrm{incl}} = E_{\\mathrm{direct,base}} + \\sum_{j} \\Delta G_{\\mathrm{net},j},$$ 而排除水分子模型的对接分数为 $$S_{\\mathrm{excl}} = E_{\\mathrm{direct,base}} + E_{\\mathrm{direct,excl}}.$$ 包含水分子的影响是二者之差 $$\\Delta S = S_{\\mathrm{incl}} - S_{\\mathrm{excl}},$$ 以 $\\mathrm{kJ \\cdot mol^{-1}}$ 为单位报告。\n\n使用的常数：\n- 使用摩尔气体常数 $$R = 0.008314462618 \\ \\mathrm{kJ \\cdot mol^{-1} \\cdot K^{-1}}.$$\n- 使用特征氢键参数 $$\\varepsilon = 8.0 \\ \\mathrm{kJ \\cdot mol^{-1}}, \\quad \\alpha = 2.0 \\ \\text{\\AA}^{-1}, \\quad r_0 = 2.8 \\ \\text{\\AA}.$$\n\n角度单位：\n- 所有输入角度 $\\theta$ 均以度为单位。在内部，需要时通过乘以 $$\\frac{\\pi}{180}$$ 将度转换为弧度。\n\n温度单位：\n- 使用温度 $T$，单位为开尔文。\n\n能量单位：\n- 所有能量和最终报告的分数差异必须以 $\\mathrm{kJ \\cdot mol^{-1}}$ 为单位。\n\n程序要求：\n- 精确实现上述基于物理的定义。\n- 为每个测试用例计算 $S_{\\mathrm{incl}}$、$S_{\\mathrm{excl}}$ 和 $\\Delta S$。\n- 生成单行输出，包含所有测试用例的差异 $\\Delta S$，格式为方括号内以逗号分隔的列表（例如 $$[\\delta_1,\\delta_2,\\delta_3,\\delta_4]$$）。每个 $\\delta_i$ 必须是浮点数，单位为 $\\mathrm{kJ \\cdot mol^{-1}}$。\n\n测试套件：\n您必须评估以下四个测试用例，它们探究了不同的机制。请使用所提供的确切值。\n\n- 测试用例 1 (单个强桥接水分子；理想情况):\n    - 温度：$T = 300.0 \\ \\mathrm{K}$。\n    - 基础直接氢键 $D_0$：无 (空集)。\n    - 水网络：一个网络，含 $m_1 = 1$ 个水分子。\n        - 分支：$(r,\\theta)$ 对为 $\\big(2.80, 170.0\\big)$ 和 $\\big(2.80, 170.0\\big)$。\n        - 每个水分子的惩罚：$\\{\\Delta G_{\\mathrm{pen},1}\\} = \\{2.0\\}$。\n        - 水分子占据率：$\\{p_1\\} = \\{0.85\\}$。\n    - 仅在排除水分子时存在的直接键 $D_{\\mathrm{excl}}$：无。\n\n- 测试用例 2 (单个弱桥接水分子；边界角度):\n    - 温度：$T = 300.0 \\ \\mathrm{K}$。\n    - 基础直接氢键 $D_0$：无。\n    - 水网络：一个网络，含 $m_2 = 1$ 个水分子。\n        - 分支：$(r,\\theta)$ 对为 $\\big(2.90, 120.0\\big)$ 和 $\\big(2.90, 125.0\\big)$。\n        - 每个水分子的惩罚：$\\{\\Delta G_{\\mathrm{pen},1}\\} = \\{2.5\\}$。\n        - 水分子占据率：$\\{p_1\\} = \\{0.90\\}$。\n    - 仅在排除水分子时存在的直接键 $D_{\\mathrm{excl}}$：无。\n\n- 测试用例 3 (双水分子链；概率性存在):\n    - 温度：$T = 300.0 \\ \\mathrm{K}$。\n    - 基础直接氢键 $D_0$：无。\n    - 水网络：一个网络，含 $m_3 = 2$ 个水分子。\n        - 分支：$(r,\\theta)$ 对为 $\\big(2.75, 165.0\\big)$、$\\big(2.85, 160.0\\big)$ 和 $\\big(2.80, 170.0\\big)$。\n        - 每个水分子的惩罚：$\\{\\Delta G_{\\mathrm{pen},1}, \\Delta G_{\\mathrm{pen},2}\\} = \\{1.5, 1.8\\}$。\n        - 水分子占据率：$\\{p_1, p_2\\} = \\{0.70, 0.60\\}$。\n    - 仅在排除水分子时存在的直接键 $D_{\\mathrm{excl}}$：无。\n\n- 测试用例 4 (排除水分子时出现竞争性直接键):\n    - 温度：$T = 300.0 \\ \\mathrm{K}$。\n    - 基础直接氢键 $D_0$：一个弱键，其 $(r,\\theta) = \\big(3.40, 130.0\\big)$。\n    - 水网络：一个网络，含 $m_4 = 1$ 个水分子。\n        - 分支：$(r,\\theta)$ 对为 $\\big(3.10, 150.0\\big)$ 和 $\\big(3.00, 140.0\\big)$。\n        - 每个水分子的惩罚：$\\{\\Delta G_{\\mathrm{pen},1}\\} = \\{2.0\\}$。\n        - 水分子占据率：$\\{p_1\\} = \\{0.50\\}$。\n    - 仅在排除水分子时存在的直接键 $D_{\\mathrm{excl}}$：一个强键，其 $(r,\\theta) = \\big(2.70, 175.0\\big)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，格式为方括号内以逗号分隔的列表，严格按照测试用例 1 到 4 的顺序，例如 $$[\\Delta S_1,\\Delta S_2,\\Delta S_3,\\Delta S_4].$$ 这些值必须以 $\\mathrm{kJ \\cdot mol^{-1}}$ 为单位，并使用上述定义和常数计算。",
            "solution": "该问题要求开发一个计算模型，以量化在分子对接计算中包含水分子所产生的影响。这是通过计算包含水分子的模型 $S_{\\mathrm{incl}}$ 和排除水分子的模型 $S_{\\mathrm{excl}}$ 之间的对接分数差异 $\\Delta S$ 来实现的。该模型基于统计力学原理，并使用一种物理驱动的氢键评分函数。整个计算针对四个不同的测试用例进行。\n\n模型的核心是计算相互作用能及其对总分的热力学贡献。我们将首先定义能量和热力学组分，然后将它们组合成最终分数。所有计算均使用提供的常数：摩尔气体常数 $R = 0.008314462618 \\ \\mathrm{kJ \\cdot mol^{-1} \\cdot K^{-1}}$，特征氢键强度 $\\varepsilon = 8.0 \\ \\mathrm{kJ \\cdot mol^{-1}}$，距离敏感度 $\\alpha = 2.0 \\ \\text{\\AA}^{-1}$，以及理想氢键距离 $r_0 = 2.8 \\ \\text{\\AA}$。\n\n首先，我们定义单个氢键“分支”的能量 $E_{\\mathrm{leg}}$，它取决于其几何构型：供体-受体距离 $r$ (单位 $\\text{\\AA}$) 和供体-氢-受体角度 $\\theta$ (单位度)。能量由以下函数给出：\n$$E_{\\mathrm{leg}}(r,\\theta) = -\\varepsilon \\cdot \\exp\\!\\big(-\\alpha \\cdot |r - r_0|\\big) \\cdot \\cos^2\\!\\Big(\\frac{\\pi}{180} \\cdot (\\theta - 180)\\Big)$$\n该方程将理想氢键建模为具有线性几何构型 ($\\theta = 180^\\circ$) 和最佳距离 ($r = r_0$)，此时其能量贡献最大，值为 $-\\varepsilon$。对此理想几何构型的偏离分别由指数项和余弦平方项进行惩罚。$\\frac{\\pi}{180}$ 项将角度从度转换为弧度，以便在余弦函数中使用。\n\n接下来，我们定义对两个对接分数 $S_{\\mathrm{incl}}$ 和 $S_{\\mathrm{excl}}$ 的贡献。两个分数共享一个共同的基线能量 $E_{\\mathrm{direct,base}}$，该能量来自始终存在的直接配体-蛋白质氢键：\n$$E_{\\mathrm{direct,base}} = \\sum_{d \\in D_0} E_{\\mathrm{leg}}(r_d,\\theta_d)$$\n其中 $D_0$ 是这些基础相互作用的集合。\n\n排除水分子的分数 $S_{\\mathrm{excl}}$ 可能包含只有在水不存在时才能形成的额外直接氢键。这些键的能量为 $E_{\\mathrm{direct,excl}}$：\n$$E_{\\mathrm{direct,excl}} = \\sum_{d \\in D_{\\mathrm{excl}}} E_{\\mathrm{leg}}(r_d,\\theta_d)$$\n排除水分子模型的总分是这些能量项的总和：\n$$S_{\\mathrm{excl}} = E_{\\mathrm{direct,base}} + E_{\\mathrm{direct,excl}}$$\n\n包含水分子的分数 $S_{\\mathrm{incl}}$ 不包括 $E_{\\mathrm{direct,excl}}$，而是考虑了水介导的氢键网络。对于每个网络 $j$，我们必须计算其有效自由能贡献 $\\Delta G_{\\mathrm{net},j}$。这被建模为一个双态系统：网络要么“存在”，要么“不存在”。\n\n“存在”状态的能量 $E_{\\mathrm{present},j}$ 是其所有氢键分支的能量之和，再加上固定每个水分子所带来的自由能惩罚：\n$$E_{\\mathrm{present},j} = \\sum_{\\ell=1}^{m_j+1} E_{\\mathrm{leg}}(r_\\ell,\\theta_\\ell) + \\sum_{i=1}^{m_j} \\Delta G_{\\mathrm{pen},i}$$\n这里，$m_j$ 是网络 $j$ 中的水分子数量。“不存在”状态的能量定义为零。\n\n网络的形成还受一个概率项 $p_{\\mathrm{net},j}$ 控制，该项是网络中每个水分子的个体占据概率 $p_i$ 的乘积：\n$$p_{\\mathrm{net},j} = \\prod_{i=1}^{m_j} p_i$$\n\n网络 $j$ 的有效自由能贡献是基于双态系统的统计力学公式定义的，其中各个状态由网络存在概率进行预加权。广义的类配分函数项是 $Z_j = p_{\\mathrm{net},j} \\cdot e^{-E_{\\mathrm{present},j}/(R T)} + (1 - p_{\\mathrm{net},j})$，自由能为：\n$$\\Delta G_{\\mathrm{net},j} = -R T \\cdot \\ln\\!\\Big(p_{\\mathrm{net},j} \\cdot e^{-E_{\\mathrm{present},j}/(R T)} + 1 - p_{\\mathrm{net},j}\\Big)$$\n这个公式将网络的能量有利性 (通过 Boltzmann 因子 $e^{-E_{\\mathrm{present},j}/(R T)}$) 与其内在的存在概率 ($p_{\\mathrm{net},j}$) 结合起来。\n\n包含水分子模型的总对接分数是基础能量与所有水网络自由能贡献的总和：\n$$S_{\\mathrm{incl}} = E_{\\mathrm{direct,base}} + \\sum_{j} \\Delta G_{\\mathrm{net},j}$$\n\n最后，包含水分子的影响是两个分数之差：\n$$\\Delta S = S_{\\mathrm{incl}} - S_{\\mathrm{excl}} = \\Big( E_{\\mathrm{direct,base}} + \\sum_{j} \\Delta G_{\\mathrm{net},j} \\Big) - \\Big( E_{\\mathrm{direct,base}} + E_{\\mathrm{direct,excl}} \\Big) = \\sum_{j} \\Delta G_{\\mathrm{net},j} - E_{\\mathrm{direct,excl}}$$\n\n算法通过迭代四个测试用例中的每一个来执行。对于每个用例，它将：\n1.  通过对 $D_{\\mathrm{excl}}$ 中所有键的 $E_{\\mathrm{leg}}$ 求和来计算 $E_{\\mathrm{direct,excl}}$。\n2.  初始化 $\\sum_{j} \\Delta G_{\\mathrm{net},j}$ 的和。\n3.  对于每个水网络 $j$:\n    a. 计算分支能量的总和 $\\sum E_{\\mathrm{leg}}$。\n    b. 计算总惩罚 $\\sum \\Delta G_{\\mathrm{pen},i}$。\n    c. 计算 $E_{\\mathrm{present},j}$。\n    d. 计算网络概率 $p_{\\mathrm{net},j}$。\n    e. 使用该测试用例的温度 $T$ 计算自由能贡献 $\\Delta G_{\\mathrm{net},j}$。\n    f. 将 $\\Delta G_{\\mathrm{net},j}$ 加到运行总和中。\n4.  计算最终差异 $\\Delta S = \\sum_{j} \\Delta G_{\\mathrm{net},j} - E_{\\mathrm{direct,excl}}$。\n将此过程应用于每个测试用例，以生成最终结果列表。",
            "answer": "[-13.113337402633095,-3.692398242478465,-12.378902509378058,3.90306385257121]"
        },
        {
            "introduction": "任何虚拟筛选活动结束后，都必须对其效果进行评估，以判断其是否优于随机挑选。富集因子（Enrichment Factor, EF）是衡量筛选方法“早期识别”能力的一个黄金标准。它量化了在数据库的顶端部分，活性化合物被富集的程度。通过完成这个练习，你将学会从头推导并计算富集因子，这是评估和比较不同筛选策略性能的一项关键技能。",
            "id": "3869870",
            "problem": "一场虚拟筛选（VS）活动通过一个打分函数对一个化合物库进行排序，以优先筛选出用于实验测试的化合物。考虑一个大小为 $N$ 的库，其中包含 $A$ 个已知的活性化合物和 $N-A$ 个非活性化合物。该排序列表中排名最高的比例 $\\alpha$ 部分包含 $N_{\\alpha}=\\lfloor \\alpha N \\rfloor$ 个化合物，其中有 $a_{\\alpha}$ 个是活性化合物。从丰度和命中率的核心定义，以及从混合总体中抽样的随机选择期望出发，推导在比例 $\\alpha$ 处的富集因子（EF）的公式，记为 $\\mathrm{EF}_{\\alpha}$。该因子量化了早期排序子集的表现相对于随机选择的好坏程度。\n\n然后，对于一个针对激酶靶点的虚拟筛选，其化合物库有 $N=12000$ 个化合物和 $A=240$ 个活性化合物，排名最高的 $N_{0.01}=\\lfloor 0.01 \\times 12000 \\rfloor$ 个化合物中包含 $a_{0.01}=30$ 个活性化合物。计算 $\\mathrm{EF}_{0.01}$，并将最终值以小数形式表示，四舍五入到四位有效数字。在您的推导过程中，请就早期识别性能提供简要解释，但最终答案必须仅为 $\\mathrm{EF}_{0.01}$ 的值。",
            "solution": "该问题陈述经核实具有科学依据、良定且内部一致。它展示了评估虚拟筛选方法中的一个标准任务，使用了源于化学信息学中常见统计学原理的清晰客观定义。因此，我们可以进行正式的推导和计算。\n\n主要目标是推导富集因子（$\\mathrm{EF}_{\\alpha}$）的公式，然后用它来计算一个具体的值。\n\n富集因子通过比较排序列表中顶部部分的命中率与随机选择所期望的命中率，来量化排序方法的性能。让我们来定义必要的组成部分。\n\n设 $N$ 为库中化合物的总数。\n设 $A$ 为此库中活性化合物的总数。\n设 $\\alpha$ 为所考虑的排名靠前的化合物的比例，其中 $0  \\alpha \\le 1$。\n这个顶部部分的化合物数量由 $N_{\\alpha} = \\lfloor \\alpha N \\rfloor$ 给出。\n在这个排名靠前的子集中找到的活性化合物数量为 $a_{\\alpha}$。\n\n$1$. **顶部部分的命中率**：命中率，我们可以表示为 $H_{\\alpha}$，是排名靠前的子集中活性化合物的比例。它的计算方法是找到的活性化合物数量 $a_{\\alpha}$ 除以该子集中的化合物总数 $N_{\\alpha}$。\n$$H_{\\alpha} = \\frac{a_{\\alpha}}{N_{\\alpha}}$$\n\n$2$. **随机命中率**：随机命中率 $H_{\\text{random}}$ 代表了如果从库中随机选择一个化合物子集时期望的命中率。在一个足够大的随机样本中，活性化合物的比例预计与整个库中活性化合物的总体丰度相同。这个丰度是活性化合物总数 $A$ 除以库的总大小 $N$。\n$$H_{\\text{random}} = \\frac{A}{N}$$\n\n$3$. **富集因子 (EF)**：如问题所述，$\\mathrm{EF}_{\\alpha}$ 量化了早期排序子集的表现相对于随机选择的好坏程度。因此，它被定义为顶部部分观察到的命中率（$H_{\\alpha}$）与随机命中率（$H_{\\text{random}}$）的比值。\n$$\\mathrm{EF}_{\\alpha} = \\frac{H_{\\alpha}}{H_{\\text{random}}}$$\n将 $H_{\\alpha}$ 和 $H_{\\text{random}}$ 的表达式代入，得到富集因子的公式：\n$$\\mathrm{EF}_{\\alpha} = \\frac{a_{\\alpha} / N_{\\alpha}}{A / N}$$\n通过代入 $N_{\\alpha} = \\lfloor \\alpha N \\rfloor$，我们得到完全显式的公式：\n$$\\mathrm{EF}_{\\alpha} = \\frac{a_{\\alpha} \\cdot N}{A \\cdot \\lfloor \\alpha N \\rfloor}$$\n$\\mathrm{EF}_{\\alpha}$ 值为 $1$ 表示该排序方法的表现不优于随机猜测。大于 $1$ 的值表明该方法成功地将活性化合物集中或“富集”到库中排名最高的部分，这标志着有效的早期识别性能。更高的值对应于更有效的筛选方案。\n\n现在，我们为给定的针对激酶靶点的虚拟筛选活动计算具体值 $\\mathrm{EF}_{0.01}$。\n\n提供的数据如下：\n库总大小, $N = 12000$。\n活性化合物总数, $A = 240$。\n考虑的库的比例为 $\\alpha = 0.01$。\n在此顶部部分中找到的活性化合物数量为 $a_{0.01} = 30$。\n\n首先，我们确定排序列表中前 $1\\%$ 的化合物数量 $N_{0.01}$：\n$$N_{0.01} = \\lfloor \\alpha N \\rfloor = \\lfloor 0.01 \\times 12000 \\rfloor = \\lfloor 120 \\rfloor = 120$$\n接下来，我们使用推导出的 $\\mathrm{EF}_{0.01}$ 公式：\n$$\\mathrm{EF}_{0.01} = \\frac{a_{0.01} / N_{0.01}}{A / N}$$\n我们将数值代入此表达式：\n$$\\mathrm{EF}_{0.01} = \\frac{30 / 120}{240 / 12000}$$\n让我们分别计算分子和分母。\n前 $1\\%$ 的命中率是 $H_{0.01} = \\frac{30}{120} = \\frac{1}{4} = 0.25$。\n随机命中率（整体丰度）是 $H_{\\text{random}} = \\frac{240}{12000} = \\frac{24}{1200} = \\frac{1}{50} = 0.02$。\n富集因子是这些率的比值：\n$$\\mathrm{EF}_{0.01} = \\frac{0.25}{0.02} = \\frac{25}{2} = 12.5$$\n问题要求最终值以小数形式表示，并四舍五入到四位有效数字。精确值 $12.5$ 有三位有效数字。为了用四位有效数字表示，我们在末尾追加一个零。\n$$\\mathrm{EF}_{0.01} = 12.50$$",
            "answer": "$$\\boxed{12.50}$$"
        }
    ]
}