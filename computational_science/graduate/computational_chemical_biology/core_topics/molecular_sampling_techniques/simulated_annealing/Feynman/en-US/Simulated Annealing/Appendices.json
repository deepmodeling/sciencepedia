{
    "hands_on_practices": [
        {
            "introduction": "At the heart of Simulated Annealing lies the probabilistic decision to accept or reject a proposed move, which is governed by the Metropolis criterion. This mechanism, rooted in the principles of statistical mechanics, allows the algorithm to occasionally accept \"uphill\" moves to higher energy states, a crucial feature for escaping local minima. This first exercise provides direct practice in calculating this fundamental acceptance probability for a non-favorable move, reinforcing the connection between the energy change $\\Delta E$ and the system temperature $T$ .",
            "id": "3863444",
            "problem": "In computational chemical biology, simulated annealing (SA) is often used to explore conformational states of biomolecular systems while approximately sampling from the canonical ensemble at temperature $T$. Consider a Metropolis-type update within Simulated Annealing (SA) viewed as a special case of Markov Chain Monte Carlo (MCMC), where trial moves are proposed from a symmetric generator (the probability of proposing $x \\to x'$ equals that of $x' \\to x$). Assume the equilibrium distribution over conformations is the Boltzmann distribution, proportional to $\\exp(-E/(k_B T))$, where $E$ is the potential energy, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature.\n\nA single proposed move changes the energy from $E=12.4$ kcal/mol to $E' = 13.1$ kcal/mol at $T = 600$ K. Use $k_B = 0.001987$ kcal/mol/K. Starting only from the canonical ensemble and the requirement of detailed balance, determine the correct acceptance probability for this uphill move. Express your final answer as a pure number (unitless), and round your answer to four significant figures.",
            "solution": "The fundamental base is the canonical ensemble and the detailed balance condition for Markov Chain Monte Carlo (MCMC). At fixed temperature $T$, the canonical distribution assigns to a microstate $x$ with energy $E(x)$ the probability\n$$\n\\pi(x) \\propto \\exp\\!\\left(-\\frac{E(x)}{k_B T}\\right).\n$$\nIn a Metropolis-type MCMC with a symmetric proposal kernel $q(x \\to x') = q(x' \\to x)$, the transition probability factorizes as $P(x \\to x') = q(x \\to x')\\, a(x \\to x')$, where $a(x \\to x')$ is the acceptance probability. Detailed balance requires\n$$\n\\pi(x)\\, P(x \\to x') = \\pi(x')\\, P(x' \\to x),\n$$\nwhich, with symmetry of $q$, reduces to\n$$\n\\pi(x)\\, a(x \\to x') = \\pi(x')\\, a(x' \\to x).\n$$\nTaking the ratio yields\n$$\n\\frac{a(x \\to x')}{a(x' \\to x)} = \\frac{\\pi(x')}{\\pi(x)} = \\exp\\!\\left(-\\frac{E(x') - E(x)}{k_B T}\\right).\n$$\nA standard choice that satisfies this ratio and keeps $0 \\leq a \\leq 1$ is the Metropolis acceptance rule\n$$\na(x \\to x') = \\min\\!\\left(1, \\exp\\!\\left(-\\frac{E(x') - E(x)}{k_B T}\\right)\\right).\n$$\nFor an uphill move, where $E' > E$, the acceptance probability becomes\n$$\na = \\exp\\!\\left(-\\frac{E' - E}{k_B T}\\right).\n$$\n\nFor the given move, compute the energy difference\n$$\n\\Delta E = E' - E = 13.1 - 12.4 = 0.7 \\text{ kcal/mol}.\n$$\nCompute the product $k_B T$:\n$$\nk_B T = (0.001987) \\times (600) = 1.1922 \\text{ kcal/mol}.\n$$\nThus the dimensionless exponent is\n$$\n\\frac{\\Delta E}{k_B T} = \\frac{0.7}{1.1922} = 0.58714978\\ldots\n$$\nand the acceptance probability is\n$$\na = \\exp\\!\\left(-0.58714978\\ldots\\right) \\approx 0.5559094928\\ldots\n$$\nRounded to four significant figures, the acceptance probability is\n$$\n0.5559.\n$$\nThis value is unitless, as required.",
            "answer": "$$\\boxed{0.5559}$$"
        },
        {
            "introduction": "While calculating the acceptance probability is a key skill, understanding the strategic role of the temperature parameter $T$ is what separates a novice from an expert practitioner. The temperature governs the algorithm's willingness to explore the solution space by accepting energetically unfavorable states. This conceptual problem explores the critical consequences of setting the initial temperature incorrectly, forcing you to reason about how this choice transforms the algorithm's behavior and its ability to find a global optimum .",
            "id": "2202486",
            "problem": "A junior robotics engineer is tasked with optimizing the path for a robotic arm in a warehouse to pick up a series of items from specified locations. The goal is to find the sequence of pickups that minimizes the total travel distance of the arm's end-effector. This is a variation of the Traveling Salesperson Problem. The engineer decides to use the Simulated Annealing (SA) algorithm for this optimization task.\n\nIn the SA algorithm, a \"state\" is a specific sequence of pickups, and the \"energy\" or \"cost\" of a state is the total travel distance for that sequence. The algorithm starts from a random sequence and iteratively proposes a small change (e.g., swapping two items in the sequence). If the new sequence has a shorter total distance (lower energy), the change is always accepted. If the new sequence has a longer total distance (higher energy, $\\Delta E > 0$), it is accepted with a probability $P = \\exp(-\\Delta E / T)$, where $T$ is the current \"temperature\" of the system. The temperature starts high and is gradually decreased according to a cooling schedule.\n\nThe engineer, hoping to accelerate the search for a good solution, sets the initial temperature, $T_0$, to a very small positive value, close to zero. Which of the following statements best describes the most immediate and significant consequence of this choice on the algorithm's behavior?\n\nA. The algorithm will behave like a greedy descent (or hill-climbing) method, likely getting trapped in a local minimum close to the initial state.\n\nB. The algorithm will explore the solution space in a highly random fashion, taking a very long time to converge to any stable solution.\n\nC. The algorithm will have a higher probability of accepting moves that increase the travel distance compared to a run with a high initial temperature.\n\nD. The algorithm will find the globally optimal path more efficiently because it will waste no time exploring suboptimal paths.",
            "solution": "In simulated annealing, given a proposed move with energy change $\\Delta E$, the Metropolis acceptance rule is\n$$\nP_{\\text{accept}}(\\Delta E,T)=\n\\begin{cases}\n1, & \\Delta E \\le 0,\\\\\n\\exp\\!\\left(-\\frac{\\Delta E}{T}\\right), & \\Delta E > 0.\n\\end{cases}\n$$\nConsider the immediate effect of setting the initial temperature $T_{0}$ to a very small positive value. For any fixed $\\Delta E>0$,\n$$\n\\lim_{T \\to 0^{+}} \\exp\\!\\left(-\\frac{\\Delta E}{T}\\right)=\\exp\\!\\left(-\\lim_{T \\to 0^{+}}\\frac{\\Delta E}{T}\\right)=\\exp(-\\infty)=0.\n$$\nTherefore, at $T_{0}\\approx 0^{+}$ the probability of accepting any uphill move ($\\Delta E>0$) is essentially zero, while all downhill moves ($\\Delta E\\le 0$) are accepted with probability $1$. Equivalently, the algorithm reduces to a greedy descent (hill-climbing) procedure with respect to the proposed local move operator.\n\nMoreover, for $\\Delta E>0$ the acceptance probability is strictly increasing in $T$ since\n$$\n\\frac{\\partial}{\\partial T}\\exp\\!\\left(-\\frac{\\Delta E}{T}\\right)=\\exp\\!\\left(-\\frac{\\Delta E}{T}\\right)\\frac{\\Delta E}{T^{2}}>0,\n$$\nso choosing a very small $T_{0}$ minimizes the chance of accepting uphill moves and thus minimizes exploratory behavior. Consequently, the most immediate and significant consequence is that the algorithm will likely become trapped in a local minimum near the initial state, matching option A. Options B and C contradict the monotone increase of uphill acceptance with $T$, and option D is false because the lack of uphill acceptance undermines escape from local minima and thus global optimization.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}