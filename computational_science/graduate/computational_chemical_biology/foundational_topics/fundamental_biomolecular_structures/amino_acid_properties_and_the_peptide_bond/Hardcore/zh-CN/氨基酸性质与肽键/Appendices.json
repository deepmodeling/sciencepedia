{
    "hands_on_practices": [
        {
            "introduction": "本章的实践练习将从最基本的原理开始。在计算化学和生物化学中，Henderson–Hasselbalch 方程是描述酸碱平衡和计算可滴定残基质子化状态的核心工具。通过从质量作用定律出发，亲手推导这个方程，你将深刻理解其背后的物理化学基础，以及它在连接宏观 $pH$ 值与微观分子状态时的关键作用 。这个练习不仅是理论的重温，更是确保你能在更复杂的情境中正确运用此工具的必要一步。",
            "id": "3835956",
            "problem": "肽中的一个单质子、可电离的氨基酸基团可以用平衡式 $\\mathrm{HA} \\rightleftharpoons \\mathrm{A}^{-} + \\mathrm{H}^{+}$ 来建模，其中 $\\mathrm{HA}$ 表示该基团的质子化形式，$\\mathrm{A}^{-}$ 表示去质子化形式。在计算化学生物学中，这类基团的状态布居通常是使用活度而非浓度，从平衡热力学中推断出来的。从以活度 $a_{X}$ 书写的质量作用定律以及氢离子浓度指数（$\\mathrm{pH}$）和酸解离常数（$K_{a}$）的定义，即 $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}})$ 和 $\\mathrm{p}K_{a} = -\\log_{10}(K_{a})$ 出发，推导出一个关联该单质子基团的 $\\mathrm{pH}$、$\\mathrm{p}K_{a}$ 以及去质子化与质子化形式活度比值的表达式。然后，利用此关系和以物种布居表示的质子化分数 $f$ 的明确定义，在共轭对的活度系数在缓冲介质中相等的假设下，获得一个用 $\\mathrm{pH}$ 和 $\\mathrm{p}K_{a}$ 表示 $f$ 的闭式表达式。最后，在 $\\mathrm{HA}$ 和 $\\mathrm{A}^{-}$ 的活度系数可视为相等的情况下，计算一个在 $25\\,^\\circ\\text{C}$ 和 $\\mathrm{pH} = 7.00$ 的缓冲水溶液中，$\\mathrm{p}K_{a} = 8.00$ 的N-末端氨基的质子化分数。将最终数值答案四舍五入至五位有效数字。",
            "solution": "这个问题是有效的，因为它在科学上基于化学平衡原理，问题提出得当，信息充分，且表述客观。我们将逐步进行推导和计算。\n\n题目描述了肽中一个单质子基团的酸碱平衡，由反应式表示：\n$$\n\\mathrm{HA} \\rightleftharpoons \\mathrm{A}^{-} + \\mathrm{H}^{+}\n$$\n其中 $\\mathrm{HA}$ 是质子化形式，$\\mathrm{A}^{-}$ 是去质子化形式。\n\n第一个任务是推导 $\\mathrm{pH}$、$\\mathrm{p}K_{a}$ 以及去质子化与质子化形式活度比值之间的关系。质量作用定律用平衡时各物种的活度（$a$）定义了酸解离常数 $K_a$：\n$$\nK_a = \\frac{a_{\\mathrm{A}^{-}} a_{\\mathrm{H}^{+}}}{a_{\\mathrm{HA}}}\n$$\n为了引入 $\\mathrm{pH}$ 和 $\\mathrm{p}K_{a}$，我们对该方程两边取以10为底的负对数：\n$$\n-\\log_{10}(K_a) = -\\log_{10}\\left( \\frac{a_{\\mathrm{A}^{-}} a_{\\mathrm{H}^{+}}}{a_{\\mathrm{HA}}} \\right)\n$$\n使用对数的性质 $\\log(xy) = \\log(x) + \\log(y)$ 和 $\\log(x/y) = \\log(x) - \\log(y)$，我们可以展开右边：\n$$\n-\\log_{10}(K_a) = -\\log_{10}(a_{\\mathrm{H}^{+}}) - \\log_{10}\\left( \\frac{a_{\\mathrm{A}^{-}}}{a_{\\mathrm{HA}}} \\right)\n$$\n根据定义，$\\mathrm{p}K_a = -\\log_{10}(K_a)$ 且 $\\mathrm{pH} = -\\log_{10}(a_{\\mathrm{H}^{+}})$。将这些定义代入方程得到：\n$$\n\\mathrm{p}K_a = \\mathrm{pH} - \\log_{10}\\left( \\frac{a_{\\mathrm{A}^{-}}}{a_{\\mathrm{HA}}} \\right)\n$$\n重新整理这个方程以解出 $\\mathrm{pH}$，就得到了所需的关系，这是用活度表示的Henderson-Hasselbalch方程的一种形式：\n$$\n\\mathrm{pH} = \\mathrm{p}K_a + \\log_{10}\\left( \\frac{a_{\\mathrm{A}^{-}}}{a_{\\mathrm{HA}}} \\right)\n$$\n第二个任务是推导质子化分数 $f$ 的闭式表达式。质子化分数定义为质子化物质的布居数除以质子化和去质子化物质的总布居数。在溶液中，布居数与摩尔浓度（$[\\cdot]$）成正比，所以我们可以写出：\n$$\nf = \\frac{[\\mathrm{HA}]}{[\\mathrm{HA}] + [\\mathrm{A}^{-}]}\n$$\n物种 $X$ 的活度 $a_X$ 与其浓度 $[X]$ 通过其活度系数 $\\gamma_X$ 相关联，方程为 $a_X = \\gamma_X [X]$。题目提供了一个关键假设，即共轭酸碱对的活度系数相等，即 $\\gamma_{\\mathrm{HA}} = \\gamma_{\\mathrm{A}^{-}}$。这使我们能将活度比等同于浓度比：\n$$\n\\frac{a_{\\mathrm{A}^{-}}}{a_{\\mathrm{HA}}} = \\frac{\\gamma_{\\mathrm{A}^{-}}[\\mathrm{A}^{-}]}{\\gamma_{\\mathrm{HA}}[\\mathrm{HA}]} = \\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]}\n$$\n现在我们可以将这个浓度比代入前面推导的基于活度的关系式中：\n$$\n\\mathrm{pH} = \\mathrm{p}K_a + \\log_{10}\\left( \\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]} \\right)\n$$\n为了求 $f$，我们首先从这个方程中解出浓度比 $\\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]}$：\n$$\n\\mathrm{pH} - \\mathrm{p}K_a = \\log_{10}\\left( \\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]} \\right)\n$$\n两边取以10为底的幂，得到：\n$$\n10^{(\\mathrm{pH} - \\mathrm{p}K_a)} = \\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]}\n$$\n现在，我们回到 $f$ 的定义，并将分子和分母同时除以 $[\\mathrm{HA}]$：\n$$\nf = \\frac{\\frac{[\\mathrm{HA}]}{[\\mathrm{HA}]}}{\\frac{[\\mathrm{HA}]}{[\\mathrm{HA}]} + \\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]}} = \\frac{1}{1 + \\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]}}\n$$\n代入浓度比的表达式，得到用 $\\mathrm{pH}$ 和 $\\mathrm{p}K_a$ 表示质子化分数 $f$ 的最终闭式表达式：\n$$\nf = \\frac{1}{1 + 10^{(\\mathrm{pH} - \\mathrm{p}K_a)}}\n$$\n最后一个任务是计算一个在 $\\mathrm{pH}$ 为 $7.00$ 的缓冲溶液中，$\\mathrm{p}K_a$ 为 $8.00$ 的N-末端氨基的 $f$ 值。$25\\,^\\circ\\text{C}$ 的温度是报告 $\\mathrm{p}K_a$ 值的标准条件，与题目设置一致，但不进入最终计算。\n将给定值代入 $f$ 的表达式中：\n$$\nf = \\frac{1}{1 + 10^{(7.00 - 8.00)}} = \\frac{1}{1 + 10^{(-1.00)}}\n$$\n计算 $10^{-1.00}$ 的值：\n$$\n10^{-1.00} = 0.1\n$$\n因此，质子化分数为：\n$$\nf = \\frac{1}{1 + 0.1} = \\frac{1}{1.1}\n$$\n进行除法运算得到：\n$$\nf \\approx 0.90909090...\n$$\n按要求将此结果四舍五入到五位有效数字，得到：\n$$\nf = 0.90909\n$$\n这个结果表明，在 $\\mathrm{pH}$ 值比 $\\mathrm{p}K_a$ 值低一个单位时，该基团大约有 $90.9\\%$ 是质子化的。",
            "answer": "$$\\boxed{0.90909}$$"
        },
        {
            "introduction": "掌握了基本原理之后，下一步是将其应用于具体的生物分子系统。这个练习将理论与实际计算相结合，要求你计算在生理 $pH$ 条件下赖氨酸的净电荷 。在生物分子模拟中，准确参数化静电相互作用至关重要，而氨基酸的净电荷是这一过程中的一个基本物理量，直接影响着蛋白质的结构、稳定性与功能。",
            "id": "3836005",
            "problem": "在生物分子的粗粒化隐式溶剂模型中，会为可滴定残基分配一个有效的、系综平均的电荷，以参数化静电相互作用。考虑在氢离子浓度指数（pH）为 $\\mathrm{pH}=7.4$ 的稀水溶液中的自由L-赖氨酸。将三个可滴定基团视为独立且不相互作用的：α-羧基（形式状态为 $\\mathrm{COOH}/\\mathrm{COO}^{-}$）、α-铵基（形式状态为 $\\mathrm{NH_{3}^{+}}/\\mathrm{NH_{2}}$）以及ε-铵基侧链（形式状态为 $\\mathrm{NH_{3}^{+}}/\\mathrm{NH_{2}}$）。给定以下酸解离常数对数值（pK$_a$值）：$pK_{a}(\\text{COOH})=2.2$，$pK_{a}(\\text{NH}_3^{+})=9.0$，以及 $pK_{a}(\\text{side chain})=10.5$。\n\n仅从质子结合平衡的质量作用定律、酸解离常数 $K_{a}$ 的定义，以及氢离子浓度指数（pH）和酸解离常数对数值（pK$_a$）的定义出发，通过将各个基团的电荷按其在该 pH 下的平衡质子化分数加权求和，计算赖氨酸在 $\\mathrm{pH}=7.4$ 时的期望净电荷。假设基团之间没有耦合，并忽略活度系数和离子强度效应。将最终结果四舍五入至四位有效数字。以纯数（无量纲）形式表示你的答案。",
            "solution": "该问题要求计算在指定氢离子浓度指数（$\\mathrm{pH}$）的水溶液中自由L-赖氨酸的期望净电荷。这可以通过确定其三个可滴定基团中每个基团的质子化状态分数并对它们的平均电荷求和来完成。问题规定推导必须从基本原理开始。\n\n让我们考虑一个通用的一元酸 $HA$，它在水中根据以下平衡进行解离：\n$$\nHA \\rightleftharpoons H^{+} + A^{-}\n$$\n此平衡的质量作用定律给出了酸解离常数 $K_a$：\n$$\nK_a = \\frac{[H^{+}][A^{-}]}{[HA]}\n$$\n其中 $[H^{+}]$、$[A^{-}]$ 和 $[HA]$ 分别代表质子、去质子化形式（共轭碱）和质子化形式（酸）的摩尔浓度。\n\n$\\mathrm{pH}$ 和 $pK_a$ 的定义如下：\n$$\n\\mathrm{pH} = -\\log_{10}([H^{+}])\n$$\n$$\npK_a = -\\log_{10}(K_a)\n$$\n从这些定义可以得出 $[H^{+}] = 10^{-\\mathrm{pH}}$ 和 $K_a = 10^{-pK_a}$。\n\n我们可以重新整理 $K_a$ 的表达式，以找到去质子化物质与质子化物质的比例：\n$$\n\\frac{[A^{-}]}{[HA]} = \\frac{K_a}{[H^{+}]} = \\frac{10^{-pK_a}}{10^{-\\mathrm{pH}}} = 10^{\\mathrm{pH} - pK_a}\n$$\n这个关系是Henderson-Hasselbalch方程的前身。为了找到处于给定质子化状态的分子分数，我们定义了分数布居。酸的质子化形式 $HA$ 的分数表示为 $f_{HA}$，其去质子化形式 $A^{-}$ 的分数表示为 $f_{A^{-}}$。\n$$\nf_{HA} = \\frac{[HA]}{[HA] + [A^{-}]}\n$$\n$$\nf_{A^{-}} = \\frac{[A^{-}]}{[HA] + [A^{-}]}\n$$\n将 $f_{HA}$ 表达式的分子和分母同除以 $[HA]$，我们得到：\n$$\nf_{HA} = \\frac{1}{1 + \\frac{[A^{-}]}{[HA]}} = \\frac{1}{1 + 10^{\\mathrm{pH} - pK_a}}\n$$\n由于物质必须处于这两种状态之一，所以 $f_{HA} + f_{A^{-}} = 1$。因此，去质子化形式的分数为：\n$$\nf_{A^{-}} = 1 - f_{HA} = 1 - \\frac{1}{1 + 10^{\\mathrm{pH} - pK_a}} = \\frac{10^{\\mathrm{pH} - pK_a}}{1 + 10^{\\mathrm{pH} - pK_a}}\n$$\n单个可滴定基团的期望电荷 $\\langle q \\rangle$ 是其可能状态电荷的加权平均值，其中权重是分数布居：\n$$\n\\langle q \\rangle = q_{HA} \\cdot f_{HA} + q_{A^{-}} \\cdot f_{A^{-}}\n$$\n其中 $q_{HA}$ 和 $q_{A^{-}}$ 分别是质子化和去质子化状态的整数电荷。\n\nL-赖氨酸有三个独立的可滴定基团：α-羧基、α-铵基和ε-铵基。总期望净电荷 $\\langle Q_{net} \\rangle$ 是这三个基团期望电荷的总和。\n$\\langle Q_{net} \\rangle = \\langle q_{\\mathrm{carboxyl}} \\rangle + \\langle q_{\\alpha\\mathrm{-ammonium}} \\rangle + \\langle q_{\\varepsilon\\mathrm{-ammonium}} \\rangle$。\n\n1. α-羧基 ($\\mathrm{COOH}/\\mathrm{COO}^{-}$)：\n平衡为 $\\mathrm{COOH} \\rightleftharpoons H^{+} + \\mathrm{COO}^{-}$。\n质子化状态 $\\mathrm{COOH}$ 的电荷为 $q_{prot} = 0$。\n去质子化状态 $\\mathrm{COO}^{-}$ 的电荷为 $q_{deprot} = -1$。\n给定的 $pK_a$ 为 $2.2$，$\\mathrm{pH}$ 为 $7.4$。\n期望电荷为 $\\langle q_{\\mathrm{carboxyl}} \\rangle = (0) \\cdot f_{\\mathrm{COOH}} + (-1) \\cdot f_{\\mathrm{COO}^{-}} = -f_{\\mathrm{COO}^{-}}$。\n$$\n\\langle q_{\\mathrm{carboxyl}} \\rangle = -\\frac{10^{\\mathrm{pH} - pK_a}}{1 + 10^{\\mathrm{pH} - pK_a}} = -\\frac{10^{7.4 - 2.2}}{1 + 10^{7.4 - 2.2}} = -\\frac{10^{5.2}}{1 + 10^{5.2}}\n$$\n\n2. α-铵基 ($\\mathrm{NH_{3}^{+}}/\\mathrm{NH_{2}}$)：\n平衡为 $\\mathrm{NH}_{3}^{+} \\rightleftharpoons H^{+} + \\mathrm{NH}_{2}$。\n质子化状态 $\\mathrm{NH}_{3}^{+}$ 的电荷为 $q_{prot} = +1$。\n去质子化状态 $\\mathrm{NH}_{2}$ 的电荷为 $q_{deprot} = 0$。\n给定的 $pK_a$ 为 $9.0$，$\\mathrm{pH}$ 为 $7.4$。\n期望电荷为 $\\langle q_{\\alpha\\mathrm{-ammonium}} \\rangle = (+1) \\cdot f_{\\mathrm{NH_{3}^{+}}} + (0) \\cdot f_{\\mathrm{NH_{2}}} = f_{\\mathrm{NH_{3}^{+}}}$。\n$$\n\\langle q_{\\alpha\\mathrm{-ammonium}} \\rangle = \\frac{1}{1 + 10^{\\mathrm{pH} - pK_a}} = \\frac{1}{1 + 10^{7.4 - 9.0}} = \\frac{1}{1 + 10^{-1.6}}\n$$\n\n3. ε-铵基侧链 ($\\mathrm{NH_{3}^{+}}/\\mathrm{NH_{2}}$)：\n平衡为 $\\mathrm{NH}_{3}^{+} \\rightleftharpoons H^{+} + \\mathrm{NH}_{2}$。\n质子化状态 $\\mathrm{NH}_{3}^{+}$ 的电荷为 $q_{prot} = +1$。\n去质子化状态 $\\mathrm{NH}_{2}$ 的电荷为 $q_{deprot} = 0$。\n给定的 $pK_a$ 为 $10.5$，$\\mathrm{pH}$ 为 $7.4$。\n期望电荷为 $\\langle q_{\\varepsilon\\mathrm{-ammonium}} \\rangle = (+1) \\cdot f_{\\mathrm{NH_{3}^{+}}} + (0) \\cdot f_{\\mathrm{NH_{2}}} = f_{\\mathrm{NH_{3}^{+}}}$。\n$$\n\\langle q_{\\varepsilon\\mathrm{-ammonium}} \\rangle = \\frac{1}{1 + 10^{\\mathrm{pH} - pK_a}} = \\frac{1}{1 + 10^{7.4 - 10.5}} = \\frac{1}{1 + 10^{-3.1}}\n$$\n\n总期望净电荷是这三部分贡献的总和：\n$$\n\\langle Q_{net} \\rangle = -\\frac{10^{5.2}}{1 + 10^{5.2}} + \\frac{1}{1 + 10^{-1.6}} + \\frac{1}{1 + 10^{-3.1}}\n$$\n现在，我们计算数值：\n对于羧基： $\\langle q_{\\mathrm{carboxyl}} \\rangle = -\\frac{10^{5.2}}{1 + 10^{5.2}} \\approx -\\frac{158489.3}{1 + 158489.3} \\approx -0.99999369$\n对于α-铵基： $\\langle q_{\\alpha\\mathrm{-ammonium}} \\rangle = \\frac{1}{1 + 10^{-1.6}} \\approx \\frac{1}{1 + 0.02511886} \\approx 0.97549603$\n对于ε-铵基： $\\langle q_{\\varepsilon\\mathrm{-ammonium}} \\rangle = \\frac{1}{1 + 10^{-3.1}} \\approx \\frac{1}{1 + 0.00079433} \\approx 0.99920630$\n\n将这些值相加：\n$$\n\\langle Q_{net} \\rangle \\approx -0.99999369 + 0.97549603 + 0.99920630 \\approx 0.97470864\n$$\n将最终结果四舍五入到四位有效数字，我们得到 $0.9747$。",
            "answer": "$$\n\\boxed{0.9747}\n$$"
        },
        {
            "introduction": "前面的练习中我们使用了给定的 $pK_a$ 值进行正向计算，但在实际的计算生物学研究中，我们常常需要反向操作：即从模拟或实验数据中确定未知的 $pK_a$ 值。这个高级练习将引导你完成一个典型的计算化学工作流程 。你将通过对恒定 $pH$ 分子动力学模拟产生的滴定曲线进行非线性最小二乘法拟合，来提取组氨酸侧链的 $pK_a$ 值，从而掌握从模拟数据中挖掘关键生物物理参数的实用技能。",
            "id": "3836002",
            "problem": "对肽中的组氨酸侧链进行恒定pH值的分子动力学（MD）模拟，得到一条滴定曲线，即一系列样本点 $(\\mathrm{pH}_i, \\theta_i)$，其中 $\\theta_i$ 表示在 $\\mathrm{pH}_i$ 时质子化物质的比例。根据酸碱平衡的第一性原理，酸解离常数 $K_a$ 由质量作用定律定义，而 $pK_a$ 定义为 $pK_a = -\\log_{10}(K_a)$。Henderson–Hasselbalch (HH) 关系式连接了 $pK_a$ 和质子化比例，而一个类 Hill 泛化模型引入了一个唯象的协同性参数。您的任务是基于这些原理推导出一个用于 $\\theta(\\mathrm{pH})$ 的拟合模型，并实现一个程序，根据提供的滴定曲线估算肽中组氨酸的 $pK_a$。\n\n从质量作用定律出发，解析地推导一个双参数模型，该模型用未知的 $pK_a$ 和（在适用时）协同性参数 $n_{\\mathrm{H}}$ 来关联质子化比例 $\\theta$ 与 $\\mathrm{pH}$。然后，设计一个算法，给定一组 $(\\mathrm{pH}_i, \\theta_i)$ 值，计算：\n- 通过拟合 Henderson–Hasselbalch 模型（固定 $n_{\\mathrm{H}} = 1$）估算的 $pK_a$。\n- 通过拟合类 Hill 泛化模型（$n_{\\mathrm{H}}$ 为自由变量）估算的 $pK_a$ 和 $n_{\\mathrm{H}}$。\n\n您必须使用非线性最小二乘法将您推导的模型拟合到数据，通过最小化观测值 $\\theta_i$ 与预测值之间的残差平方和。由于 $\\mathrm{pH}$ 和 $pK_a$ 是无量纲的量，报告所有数值结果时无需带物理单位。最终输出必须是一行，包含所提供测试套件的所有估算参数，以一个扁平列表的形式，按以下顺序排列：对于每个测试用例，输出 Henderson–Hasselbalch 的 $pK_a$、类 Hill 模型的 $pK_a$ 和类 Hill 模型的 $n_{\\mathrm{H}}$，所有数值均四舍五入到三位小数。输出应为一行文本，格式为方括号内的逗号分隔列表，例如 $[\\dots]$。\n\n使用以下滴定曲线测试套件，以 $\\mathrm{pH}$ 样本点和相应的观测质子化比例 $\\theta$ 给出：\n\n- 测试用例 1（典型的类组氨酸行为，宽范围）：\n  - $\\mathrm{pH}$ 点：$[3.0, 4.0, 5.0, 5.5, 6.0, 6.5, 7.0, 8.0, 9.0]$\n  - $\\theta$ 点：$[0.999001, 0.990099, 0.909091, 0.759746, 0.500000, 0.240253, 0.090909, 0.009901, 0.000999]$\n- 测试用例 2（类协同的陡峭度，中点偏移）：\n  - $\\mathrm{pH}$ 点：$[4.5, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0]$\n  - $\\theta$ 点：$[0.997488, 0.952269, 0.816271, 0.500000, 0.182993, 0.047744, 0.011095]$\n- 测试用例 3（过渡区域附近点稀疏）：\n  - $\\mathrm{pH}$ 点：$[6.0, 6.1, 6.2, 6.3, 6.4]$\n  - $\\theta$ 点：$[0.613813, 0.557521, 0.500000, 0.442479, 0.386186]$\n- 测试用例 4（中点大部分在采样范围之外）：\n  - $\\mathrm{pH}$ 点：$[5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0]$\n  - $\\theta$ 点：$[0.999900, 0.999001, 0.990099, 0.909091, 0.500000, 0.090909, 0.009901]$\n\n算法和数值要求：\n- 从质量作用定律和 $pK_a$ 的定义推导模型方程。\n- 为 Henderson–Hasselbalch 模型和类 Hill 模型实现非线性最小二乘拟合。将参数约束在物理上合理的范围内，例如 $pK_a \\in [-2, 14]$ 和 $n_{\\mathrm{H}} \\in [0.1, 5.0]$。\n- 使用稳健的初始猜测值，不假定对真实参数有先验知识，并且能够处理可能在大部分范围内接近饱和（例如 $\\theta \\approx 0$ 或 $\\theta \\approx 1$）的数据集。如果您使用任何变换，请根据推导的模型证明其合理性。\n- 您的程序应生成一行输出，其中包含一个逗号分隔的列表，用方括号括起来。对于每个测试用例，输出三个浮点数：Henderson–Hasselbalch 的 $pK_a$、类 Hill 模型的 $pK_a$ 和类 Hill 模型的 $n_{\\mathrm{H}}$，所有数值均四舍五入到三位小数。\n\n覆盖性设计：\n- 测试套件包括一个通用的宽范围用例（测试用例 1）、一个类协同的陡峭用例（测试用例 2）、一个在过渡区域附近点稀疏的边界用例（测试用例 3）以及一个中点部分位于采样范围之外的用例（测试用例 4）。这确保了您的算法能够处理不同的陡峭度、采样密度和饱和行为。\n\n您的最终程序必须是自包含的，不需要用户输入，并严格遵守指定的输出格式。",
            "solution": "该问题要求推导滴定曲线的数学模型，并实现一个数值拟合程序，从实验数据中估算参数 $pK_a$ 和协同系数 $n_{\\mathrm{H}}$。推导过程从酸碱化学平衡的基本原理开始。\n\n### 模型推导\n\n让我们考虑一个通用单质子酸的可逆解离，对于组氨酸侧链（咪唑），这可以表示为其质子化形式（$\\mathrm{HisH}^+$）和其去质子化形式（$\\mathrm{His}$）之间的平衡：\n$$\n\\mathrm{HisH}^+ \\rightleftharpoons \\mathrm{His} + \\mathrm{H}^+\n$$\n根据质量作用定律，酸解离常数 $K_a$ 定义为：\n$$\nK_a = \\frac{[\\mathrm{His}][\\mathrm{H}^+]}{[\\mathrm{HisH}^+]}\n$$\n其中 $[\\cdot]$ 表示物质的摩尔浓度。问题将 $\\theta$ 定义为质子化物质的比例。这表示为质子化形式的浓度与该物质总浓度的比值：\n$$\n\\theta = \\frac{[\\mathrm{HisH}^+]}{[\\mathrm{His}]_{\\text{total}}} = \\frac{[\\mathrm{HisH}^+]}{[\\mathrm{HisH}^+] + [\\mathrm{His}]}\n$$\n为了将 $\\theta$ 表示为 $[\\mathrm{H}^+]$ 和 $K_a$ 的函数，我们首先重新整理 $K_a$ 的表达式以求出 $[\\mathrm{His}]$：\n$$\n[\\mathrm{His}] = K_a \\frac{[\\mathrm{HisH}^+]}{[\\mathrm{H}^+]}\n$$\n将此代入 $\\theta$ 的方程中：\n$$\n\\theta = \\frac{[\\mathrm{HisH}^+]}{[\\mathrm{HisH}^+] + K_a \\frac{[\\mathrm{HisH}^+]}{[\\mathrm{H}^+]}}\n$$\n假设质子化物质的浓度不为零，我们可以将分子和分母同时除以 $[\\mathrm{HisH}^+]$：\n$$\n\\theta = \\frac{1}{1 + \\frac{K_a}{[\\mathrm{H}^+]}} = \\frac{[\\mathrm{H}^+]}{[\\mathrm{H}^+] + K_a}\n$$\n根据定义，$\\mathrm{pH} = -\\log_{10}([\\mathrm{H}^+])$ 且 $pK_a = -\\log_{10}(K_a)$，这意味着 $[\\mathrm{H}^+] = 10^{-\\mathrm{pH}}$ 且 $K_a = 10^{-pK_a}$。将这些对数形式代入 $\\theta$ 的方程，得到质子化比例的 Henderson-Hasselbalch 模型：\n$$\n\\theta(\\mathrm{pH}, pK_a) = \\frac{10^{-\\mathrm{pH}}}{10^{-\\mathrm{pH}} + 10^{-pK_a}}\n$$\n将分子和分母乘以 $10^{\\mathrm{pH}}$ 得到一个更方便的形式：\n$$\n\\theta(\\mathrm{pH}, pK_a) = \\frac{1}{1 + 10^{\\mathrm{pH}} \\cdot 10^{-pK_a}} = \\frac{1}{1 + 10^{\\mathrm{pH} - pK_a}}\n$$\n这个方程代表了标准的、非协同的滴定模型，对应于 Hill 系数 $n_{\\mathrm{H}} = 1$ 的情况。\n\n问题要求一个包含协同性参数 $n_{\\mathrm{H}}$ 的泛化双参数模型。这通过泛化推导出的模型来实现，该模型在数学上等同于配体结合的 Hill 方程。指数中的项 $(\\mathrm{pH} - pK_a)$ 乘以 Hill 系数 $n_{\\mathrm{H}}$：\n$$\n\\theta(\\mathrm{pH}, pK_a, n_{\\mathrm{H}}) = \\frac{1}{1 + 10^{n_{\\mathrm{H}}(\\mathrm{pH} - pK_a)}}\n$$\n这就是通用的拟合模型。当 $n_{\\mathrm{H}}=1$ 时，它简化为标准的 Henderson-Hasselbalch 模型。当 $n_{\\mathrm{H}}>1$ 时，从质子化状态到去质子化状态的转变更加陡峭（协同性），而当 $n_{\\mathrm{H}}<1$ 时，转变则更平缓（反协同性）。\n\n### 参数拟合的算法设计\n\n目标是通过将推导出的模型拟合到所提供的 $(\\mathrm{pH}_i, \\theta_i)$ 数据点来估算参数（第一个模型是 $pK_a$，第二个模型是 $pK_a$ 和 $n_{\\mathrm{H}}$）。指定的方法是非线性最小二乘法，这涉及最小化观测数据 $\\theta_i^{\\text{obs}}$ 与模型预测值 $\\theta(\\mathrm{pH}_i, \\text{params})$ 之间的残差平方和（SSR）：\n$$\n\\mathrm{SSR}(\\text{params}) = \\sum_{i=1}^{N} \\left( \\theta_i^{\\text{obs}} - \\theta(\\mathrm{pH}_i, \\text{params}) \\right)^2\n$$\n`scipy.optimize.curve_fit` 函数是完成此任务的合适工具。它实现了用于非线性最小二乘优化的 Levenberg-Marquardt 算法。\n\n对每个测试用例，实现将按以下步骤进行：\n1.  **定义模型函数**：将定义两个 Python 函数，对应两个模型：\n    -   Henderson-Hasselbalch 模型：`hh_model(ph, pka)`，它使用 $n_{\\mathrm{H}}=1$ 的公式计算 $\\theta$。\n    -   类 Hill 模型：`hill_model(ph, pka, n_h)`，它使用通用公式计算 $\\theta$。\n\n2.  **初始猜测值**：稳健的初始参数猜测对于优化算法的收敛至关重要。\n    -   对于 $pK_a$，一个逻辑上的初始猜测值是系统半质子化时的 $\\mathrm{pH}$ 值，即 $\\theta=0.5$。我们可以通过从输入数据中找到与最接近 $0.5$ 的 $\\theta_i$ 值对应的 $\\mathrm{pH}_i$ 来估算它。\n    -   对于 $n_{\\mathrm{H}}$，一个中性的初始猜测值是 $1.0$，即假设没有协同性。\n\n3.  **参数约束**：问题指定了对参数的物理和数值约束，将使用 `curve_fit` 中的 `bounds` 参数来强制执行。\n    -   对于 Henderson-Hasselbalch 拟合：$pK_a \\in [-2, 14]$。界限元组将是 `([-2], [14])`。\n    -   对于类 Hill 拟合：$pK_a \\in [-2, 14]$ 和 $n_{\\mathrm{H}} \\in [0.1, 5.0]$。界限元组将是 `([-2, 0.1], [14, 5.0])`。\n\n4.  **拟合过程**：对于每个测试用例的数据：\n    -   首先，将使用 `hh_model` 函数、数据、$pK_a$ 的初始猜测值以及相应的界限调用 `curve_fit`。提取优化后的 $pK_a$。\n    -   其次，将使用 `hill_model` 函数、数据、$pK_a$ 和 $n_{\\mathrm{H}}$ 的初始猜测值以及双参数界限调用 `curve_fit`。提取优化后的 $pK_a$ 和 $n_{\\mathrm{H}}$。\n\n5.  **输出格式化**：每个测试用例的三个结果参数（HH $pK_a$、Hill $pK_a$、Hill $n_{\\mathrm{H}}$）将被四舍五入到三位小数，并收集到一个列表中，然后格式化为所需的字符串输出。对套件中提供的所有测试用例重复此过程。",
            "answer": "[6.000,6.000,1.000,6.500,6.500,1.500,6.200,6.200,1.000,9.000,9.000,1.000]"
        }
    ]
}