{
    "hands_on_practices": [
        {
            "introduction": "计算热力学的基础是配分函数，它将系统的微观能量状态与其宏观热力学势联系起来。本练习提供了实现这一基本联系的实践机会，即直接从可以由模拟得出的分子能级的简化表示中计算吉布斯自由能。这项实践将帮助你掌握从第一性原理出发，将微观信息转化为宏观热力学参数的核心技能。()",
            "id": "3867873",
            "problem": "需要一个计算任务来基于第一性原理对生物分子结合的温度依赖性进行建模。考虑一个受体和配体之间形成复合物的双分子结合过程。假设理想溶液行为，并且相关的热力学函数源于应用于在分子动力学 (MD) 和蒙特卡罗 (MC) 等模拟中采样的离散微观态的正则系综。必须严格使用基本依据：玻尔兹曼分布、正则配分函数和热力学势的定义。不得先验地假设任何简化公式。\n\n从一个标记为 $m \\in \\{\\mathrm{AB}, \\mathrm{A}, \\mathrm{B}\\}$ 的宏观态的正则系综开始，其离散微观态由 $i$ 索引，具有摩尔能量 $E_{m,i}$ 和整数简并度 $g_{m,i}$。宏观态 $m$ 的正则配分函数是玻尔兹曼因子经简并度加权后对所有微观态的求和。逆热能定义为 $\\beta = 1/(\\mathcal{R} T)$，其中 $\\mathcal{R}$ 是摩尔气体常数。将能量视为摩尔量，并使用化学平衡统计力学所蕴含的自由能、平衡常数和配分函数之间的关系，通过标准浓度 $C^\\circ$（$1$ $\\mathrm{mol}\\,\\mathrm{L}^{-1}$）使平衡常数无量纲化。纯粹基于这些基础，仔细论证每一步。由此，推导反应 $\\mathrm{A} + \\mathrm{B} \\rightleftharpoons \\mathrm{AB}$ 的依赖于温度的标准吉布斯结合自由能 $\\,\\Delta G^\\circ(T)\\,$，并推导计算每个宏观态的系综平均摩尔焓 $H_m(T)$ 的表达式，然后推导标准焓变 $\\,\\Delta H^\\circ(T)\\,$ 和熵变 $\\,\\Delta S^\\circ(T)\\,$。最后，提供一个算法，在给定列表 $\\{E_{m,i}\\}$ 和 $\\{g_{m,i}\\}$ 以及温度 $T$ 的情况下，计算以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示的 $\\,\\Delta G^\\circ(T)\\,$。\n\n您的程序必须实现推导出的表达式，以计算以下测试套件的 $\\,\\Delta G^\\circ(T)\\,$。对于所有计算，使用 $\\mathcal{R} = 8.314462618$ $\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，并将下面给出的每个 $E_{m,i}$ 解释为以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位。在转换为玻尔兹曼因子时，请将 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 精确地转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$。标准浓度 $C^\\circ$ 为 $1$ $\\mathrm{mol}\\,\\mathrm{L}^{-1}$，仅用于使平衡常数无量纲化。您的程序必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位输出 $\\,\\Delta G^\\circ(T)\\,$，并四舍五入到三位小数。\n\n测试套件（每个案例是针对 $\\mathrm{AB}$、$\\mathrm{A}$ 和 $\\mathrm{B}$ 的温度、能量和简并度的元组）：\n- 案例 1：$T = 298$ $\\mathrm{K}$；$\\mathrm{AB}$ 能量 $[-40.0, -35.0]$，简并度 $[2, 6]$；$\\mathrm{A}$ 能量 $[0.0, 1.0, 2.0]$，简并度 $[10, 5, 1]$；$\\mathrm{B}$ 能量 $[0.0, 1.0]$，简并度 $[10, 2]$。\n- 案例 2：$T = 250$ $\\mathrm{K}$；能量和简并度与案例 1 相同。\n- 案例 3：$T = 350$ $\\mathrm{K}$；能量和简并度与案例 1 相同。\n- 案例 4：$T = 298$ $\\mathrm{K}$；$\\mathrm{AB}$ 能量 $[-10.0, -9.0, -8.0]$，简并度 $[1, 1, 1]$；$\\mathrm{A}$ 能量 $[0.0, 0.5, 1.0]$，简并度 $[50, 20, 5]$；$\\mathrm{B}$ 能量 $[0.0, 0.5]$，简并度 $[50, 20]$。\n- 案例 5：$T = 298$ $\\mathrm{K}$；$\\mathrm{AB}$ 能量 $[-25.0]$，简并度 $[50]$；$\\mathrm{A}$ 能量 $[0.0]$，简并度 $[1]$；$\\mathrm{B}$ 能量 $[0.0]$，简并度 $[1]$。\n\n科学真实性要求：\n- 正则系综和理想溶液假设适用；对于稀溶液，压强-体积贡献可忽略不计，从而允许在当前的离散态模型中将焓与摩尔能量的系综平均值等同起来。\n- 简并度和能级代表了可从模拟中获得的粗粒化微观态。\n\n您的程序必须精确产生一行输出，其中包含五个案例的结果，形式为一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含案例1到5对应的五个 $\\,\\Delta G^\\circ(T)\\,$ 值，每个值都以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示，并四舍五入到三位小数；例如，输出格式为 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_i$ 是一个四舍五入到三位小数的浮点数，并使用小数或分数表示法，不带任何百分号。",
            "solution": "该问题陈述是计算统计热力学中一个基于基本原理的适定性练习。它要求从正则系综出发，推导生物分子结合反应的关键热力学量，并实现一个算法来计算标准吉布斯结合自由能 $\\Delta G^\\circ(T)$。该问题是自洽的、科学上合理的，并为获得唯一解提供了所有必要的数据和常数。\n\n推导和算法设计从第一性原理出发，过程如下。\n\n问题的核心在于正则系综。对于一个处于恒定温度 $T$、体积 $V$ 和粒子数 $N$ 的系统，在能量为 $E_i$ 的微观态 $i$ 中找到该系统的概率由玻尔兹曼分布给出。正则配分函数 $Q$ 是对所有可能微观态的玻尔兹曼因子求和，并且是连接微观态与宏观热力学性质的核心量。\n\n对于给定的分子种类（宏观态）$m \\in \\{\\mathrm{A}, \\mathrm{B}, \\mathrm{AB}\\}$，配分函数定义为对其离散微观态 $i$ 的求和，这些微观态具有摩尔能量 $E_{m,i}$ 和简并度 $g_{m,i}$：\n$$Q_m(T) = \\sum_i g_{m,i} e^{-\\beta E_{m,i}}$$\n此处，$\\beta = 1/(\\mathcal{R}T)$ 是逆热能，$\\mathcal{R}$ 是摩尔气体常数。能量 $E_{m,i}$ 以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位提供，在使用国际单位制的 $\\mathcal{R}$ 时必须转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n\n从配分函数到热力学的基本联系是亥姆霍兹自由能 $A$。对于标准态下的1摩尔物质 $m$，摩尔亥姆霍兹自由能为 $A_m^\\circ(T) = -\\mathcal{R}T \\ln Q_m(T)$。吉布斯自由能为 $G_m^\\circ = A_m^\\circ + P V_m^\\circ$。正如问题中所述，对于稀溶液中的溶质，压强-体积贡献被认为是可忽略的。因此，我们可以将物质 $m$ 的标准摩尔吉布斯自由能近似为：\n$$G_m^\\circ(T) \\approx A_m^\\circ(T) = -\\mathcal{R}T \\ln Q_m(T)$$\n\n结合反应为 $\\mathrm{A} + \\mathrm{B} \\rightleftharpoons \\mathrm{AB}$。标准吉布斯结合自由能 $\\Delta G^\\circ(T)$ 是此反应在标准条件下的吉布斯自由能变化：\n$$\\Delta G^\\circ(T) = G_{\\mathrm{AB}}^\\circ(T) - \\left( G_{\\mathrm{A}}^\\circ(T) + G_{\\mathrm{B}}^\\circ(T) \\right)$$\n将用配分函数表示的 $G_m^\\circ(T)$ 表达式代入，我们得到用于计算的主要方程：\n$$\\Delta G^\\circ(T) = \\left(-\\mathcal{R}T \\ln Q_{\\mathrm{AB}}(T)\\right) - \\left(-\\mathcal{R}T \\ln Q_{\\mathrm{A}}(T) - \\mathcal{R}T \\ln Q_{\\mathrm{B}}(T)\\right)$$\n$$\\Delta G^\\circ(T) = -\\mathcal{R}T \\left( \\ln Q_{\\mathrm{AB}}(T) - \\ln Q_{\\mathrm{A}}(T) - \\ln Q_{\\mathrm{B}}(T) \\right)$$\n这可以使用定义 $\\Delta G^\\circ = -\\mathcal{R}T \\ln K^\\circ$ 紧凑地写出，其中 $K^\\circ$ 是无量纲标准平衡常数：\n$$K^\\circ = \\frac{Q_{\\mathrm{AB}}(T)}{Q_{\\mathrm{A}}(T) Q_{\\mathrm{B}}(T)}$$\n问题中提到的标准浓度 $C^\\circ=1 \\, \\mathrm{mol}\\,\\mathrm{L}^{-1}$ 是一个标准惯例，以确保平衡常数是无量纲的，从而有效地解释了在这个专注于内能态的简化模型中被忽略的体积/浓度依赖性。\n\n该问题还要求推导焓变和熵变的表达式。物质 $m$ 的系综平均摩尔能量 $U_m$ 由下式给出：\n$$U_m(T) = \\langle E_m \\rangle = \\frac{\\sum_i g_{m,i} E_{m,i} e^{-\\beta E_{m,i}}}{\\sum_i g_{m,i} e^{-\\beta E_{m,i}}} = \\frac{1}{Q_m(T)} \\sum_i g_{m,i} E_{m,i} e^{-\\beta E_{m,i}}$$\n这也可以表示为配分函数的导数：$U_m(T) = -\\left(\\frac{\\partial \\ln Q_m}{\\partial \\beta}\\right)_V$。在给定的可忽略 $PV$ 功的假设下，摩尔焓 $H_m$ 与摩尔内能 $U_m$ 等同，因此 $H_m(T) \\approx U_m(T)$。\n于是，标准结合焓 $\\Delta H^\\circ(T)$ 为：\n$$\\Delta H^\\circ(T) = H_{\\mathrm{AB}}(T) - \\left( H_{\\mathrm{A}}(T) + H_{\\mathrm{B}}(T) \\right)$$\n最后，标准结合熵 $\\Delta S^\\circ(T)$ 从基本热力学关系 $\\Delta G^\\circ = \\Delta H^\\circ - T\\Delta S^\\circ$ 获得：\n$$\\Delta S^\\circ(T) = \\frac{\\Delta H^\\circ(T) - \\Delta G^\\circ(T)}{T}$$\n\n用于求解 $\\Delta G^\\circ(T)$ 的计算算法必须解决一个关键的数值问题。直接计算 $Q_m(T)$ 涉及像 $e^{-\\beta E_{m,i}}$ 这样的项。如果能量 $E_{m,i}$ 是大的正数，指数项可能会下溢为零。更严重的是，如果 $E_{m,i}$ 是大的负数（强结合），指数会变为大的正数，导致数值上溢。为确保稳定性，我们直接计算配分函数的自然对数 $\\ln Q_m$。我们为给定物质选择最小能量 $E_{m, \\text{min}}$，并通过提出其玻尔兹曼因子来重写配分函数：\n$$Q_m(T) = \\sum_i g_{m,i} e^{-\\beta (E_{m,i} - E_{m, \\text{min}} + E_{m, \\text{min}})} = e^{-\\beta E_{m, \\text{min}}} \\sum_i g_{m,i} e^{-\\beta (E_{m,i} - E_{m, \\text{min}})}$$\n取自然对数可以得到一个数值稳定的表达式：\n$$\\ln Q_m(T) = -\\beta E_{m, \\text{min}} + \\ln\\left( \\sum_i g_{m,i} e^{-\\beta (E_{m,i} - E_{m, \\text{min}})} \\right)$$\n在这种形式下，指数的参数总为非正数，从而防止了上溢。首项 $-\\beta E_{m, \\text{min}}$ 处理了整体的能量标度。\n\n因此，算法如下：\n1. 对于每种物质 $m \\in \\{\\mathrm{A}, \\mathrm{B}, \\mathrm{AB}\\}$，获取以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位的摩尔能量列表 $\\{E_{m,i}\\}$ 和简并度列表 $\\{g_{m,i}\\}$。\n2. 将所有能量乘以 $1000$，转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$。\n3. 给定温度 $T$，计算 $\\beta = 1/(\\mathcal{R}T)$。\n4. 对于每种物质，使用上面推导的数值稳定公式计算 $\\ln Q_m(T)$。\n5. 使用 $\\Delta G^\\circ(T) = -\\mathcal{R}T (\\ln Q_{\\mathrm{AB}} - \\ln Q_{\\mathrm{A}} - \\ln Q_{\\mathrm{B}})$ 计算以 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 为单位的 $\\Delta G^\\circ(T)$。\n6. 将最终的 $\\Delta G^\\circ(T)$ 除以 $1000$ 转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，并四舍五入到指定的精度。\n\n此过程在以下代码中实现，以计算所提供测试套件的结果。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the temperature-dependent standard Gibbs free energy of binding\n    for a bimolecular reaction from first principles of statistical mechanics.\n    \"\"\"\n\n    # Define constants as specified in the problem statement.\n    # Molar gas constant in J mol^-1 K^-1.\n    R_GAS_CONSTANT = 8.314462618\n\n    def calculate_log_q(T, energies_kj, degeneracies):\n        \"\"\"\n        Calculates the natural logarithm of the canonical partition function, ln(Q),\n        for a given species at temperature T. This function uses a numerically stable\n        method by shifting energies to prevent overflow/underflow.\n\n        Args:\n            T (float): Temperature in Kelvin.\n            energies_kj (list of float): Molar energies of microstates in kJ/mol.\n            degeneracies (list of int): Degeneracies of the microstates.\n\n        Returns:\n            float: The value of ln(Q), which is dimensionless.\n        \"\"\"\n        # Handle the case of no microstates, although not expected for this problem.\n        if not energies_kj:\n            return -np.inf\n\n        # Convert energies from kJ/mol to J/mol for calculations with R.\n        energies_j = np.array(energies_kj) * 1000.0\n        degen_arr = np.array(degeneracies)\n\n        # Calculate the inverse thermal energy, beta.\n        beta = 1.0 / (R_GAS_CONSTANT * T)\n\n        # For numerical stability, find the minimum energy and shift all energies\n        # relative to it. This ensures that exponents in the Boltzmann factors\n        # are non-positive, preventing overflow.\n        min_energy_j = np.min(energies_j)\n        shifted_energies_j = energies_j - min_energy_j\n\n        # Calculate the sum of Boltzmann factors for the shifted energies.\n        sum_of_factors = np.sum(degen_arr * np.exp(-beta * shifted_energies_j))\n\n        # Calculate ln(Q) using the identity:\n        # ln(Q) = ln(exp(-beta * E_min) * sum(g_i * exp(-beta * (E_i - E_min))))\n        #       = -beta * E_min + ln(sum(g_i * exp(-beta * (E_i - E_min))))\n        log_q = -beta * min_energy_j + np.log(sum_of_factors)\n\n        return log_q\n\n    # The test suite as provided in the problem statement.\n    # Each entry is a tuple: (T, E_AB, g_AB, E_A, g_A, E_B, g_B)\n    test_cases = [\n        (298, [-40.0, -35.0], [2, 6], [0.0, 1.0, 2.0], [10, 5, 1], [0.0, 1.0], [10, 2]),\n        (250, [-40.0, -35.0], [2, 6], [0.0, 1.0, 2.0], [10, 5, 1], [0.0, 1.0], [10, 2]),\n        (350, [-40.0, -35.0], [2, 6], [0.0, 1.0, 2.0], [10, 5, 1], [0.0, 1.0], [10, 2]),\n        (298, [-10.0, -9.0, -8.0], [1, 1, 1], [0.0, 0.5, 1.0], [50, 20, 5], [0.0, 0.5], [50, 20]),\n        (298, [-25.0], [50], [0.0], [1], [0.0], [1]),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, e_ab, g_ab, e_a, g_a, e_b, g_b = case\n\n        # Calculate the natural logarithm of the partition function for each species.\n        log_q_ab = calculate_log_q(T, e_ab, g_ab)\n        log_q_a = calculate_log_q(T, e_a, g_a)\n        log_q_b = calculate_log_q(T, e_b, g_b)\n\n        # Calculate the standard Gibbs free energy of binding, Delta G^o.\n        # Delta_G_std = -RT * ln(K_eq)\n        # where K_eq = Q_ab / (Q_a * Q_b)\n        # Thus, ln(K_eq) = ln(Q_ab) - ln(Q_a) - ln(Q_b)\n        delta_log_q = log_q_ab - (log_q_a + log_q_b)\n        delta_g_j_mol = -R_GAS_CONSTANT * T * delta_log_q\n\n        # Convert the result from J/mol to kJ/mol for the final output.\n        delta_g_kj_mol = delta_g_j_mol / 1000.0\n\n        results.append(delta_g_kj_mol)\n\n    # Format the results to three decimal places and create the final output string.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了基本原理后，我们可以将配分函数的概念应用于一个具体且重要的生物学现象：协同结合。这项实践要求从头开始构建一个模型，枚举所有可能的结合状态，并计算希尔系数——一个实验中经常观测到的衡量协同性的关键指标。此练习将提升你在统计力学建模和数值分析两方面的技能。()",
            "id": "3867863",
            "problem": "考虑一个大分子，其上有 $N$ 个线性排列的相同配体结合位点（无周期性环绕）。处于本体浓度 $c$（单位：摩尔/升）的配体可以与每个位点结合，其固有解离常数为 $K_{\\mathrm{d}}$（单位：摩尔/升）。协同相互作用通过最近邻耦合产生：每当有一对相邻的位点被占据，系统的自由能就会增加一个相互作用自由能 $\\Delta \\epsilon_{\\mathrm{coop}}$（单位：千焦/摩尔）。温度为 $T$（单位：开尔文），普适气体常数为 $R = 8.314$（单位：焦耳/摩尔·开尔文）。假设一个巨正则系综描述，其中本体浓度决定了每个位点的有效结合权重，并将配体视为理想且混合均匀的。\n\n从正则系综的统计力学和结合多项式（配分函数）的定义出发，根据第一性原理构建一个计算半饱和时操作性 Hill 系数的计算程序，如下所示：\n\n- 枚举 $N$ 位点线性链的所有微观状态，其中每个位点要么被占据 $(1)$，要么未被占据 $(0)$。对于一个给定的微观状态，令 $n_{\\mathrm{b}}$ 为被占据的位点数，令 $n_{\\mathrm{pairs}}$ 为相邻的被占据位点对的数量。\n- 令 $w = c / K_{\\mathrm{d}}$ 为每个位点的无量纲结合权重，令 $\\omega = \\exp\\!\\left(-\\Delta \\epsilon_{\\mathrm{coop}} \\times 10^{3} \\, / \\, (R \\, T)\\right)$ 为每对相邻被占据位点的无量纲协同因子，其中 $\\Delta \\epsilon_{\\mathrm{coop}}$ 在指数函数内已从千焦/摩尔转换为焦耳/摩尔。\n- 定义配分函数\n$$\nZ(c) = \\sum_{\\text{microstates}} w^{n_{\\mathrm{b}}} \\, \\omega^{n_{\\mathrm{pairs}}}.\n$$\n- 定义分数占据率\n$$\n\\theta(c) = \\frac{1}{N} \\, \\frac{\\sum_{\\text{microstates}} n_{\\mathrm{b}} \\, w^{n_{\\mathrm{b}}} \\, \\omega^{n_{\\mathrm{pairs}}}}{\\sum_{\\text{microstates}} w^{n_{\\mathrm{b}}} \\, \\omega^{n_{\\mathrm{pairs}}}}.\n$$\n\n半饱和时的操作性 Hill 系数 $n_{\\mathrm{H}}$ 由 Hill 变换在 $\\theta = 1/2$ 处的斜率定义：\n$$\nn_{\\mathrm{H}} = \\left. \\frac{\\mathrm{d}}{\\mathrm{d} \\ln c} \\ln\\!\\left(\\frac{\\theta(c)}{1 - \\theta(c)}\\right) \\right|_{\\theta(c) = 1/2}.\n$$\n你的程序必须：\n- 数值求解 $c_{1/2}$，使得 $\\theta(c_{1/2}) = 1/2$。\n- 在 $c_{1/2}$ 处数值计算 $n_{\\mathrm{H}}$，使用 $\\ln c$ 的一个小的对称增量来近似导数，确保在下述所有情况下数值稳定。\n- 使用数值稳定的算法计算所有需要的 $c$ 值对应的 $Z(c)$ 和 $\\theta(c)$，避免上溢或下溢。\n\n物理单位说明：\n- 温度 $T$ 必须以开尔文为单位处理。\n- 解离常数 $K_{\\mathrm{d}}$ 和浓度 $c$ 必须以摩尔/升为单位处理。\n- 相互作用自由能 $\\Delta \\epsilon_{\\mathrm{coop}}$ 必须以千焦/摩尔为单位处理，并在内部转换为焦耳/摩尔以便与 $R$ 一同使用。\n\n测试集：\n计算以下四组参数的 $n_{\\mathrm{H}}$，每组参数指定为一个元组 $(N, K_{\\mathrm{d}}, \\Delta \\epsilon_{\\mathrm{coop}}, T)$：\n\n1. $(4, 10^{-6}, -2, 298)$: 具有中等稳定作用的正协同性。\n2. $(4, 10^{-6}, 0, 298)$: 无协同性（独立位点）。\n3. $(4, 10^{-6}, +4, 298)$: 具有中等去稳定作用的负协同性。\n4. $(1, 10^{-6}, -10, 298)$: 单位点极限，相互作用无关。\n\n答案规格与最终输出格式：\n- 对于每个测试用例，将计算出的 $n_{\\mathrm{H}}$ 作为浮点数输出，并四舍五入到三位小数。\n- 你的程序应生成单行输出，其中包含四个测试用例的结果，形式为用方括号括起来的逗号分隔列表，例如 $[\\dots]$。\n- 最终输出是无量纲的；输出中不应出现任何单位符号。\n\n科学真实性约束：\n- 所有计算必须遵循上述基本定义，不得引入经验性简化公式。\n- 确保用于获取 $c_{1/2}$ 的求根过程遵守 $\\theta(c)$ 相对于 $c$ 的单调性。",
            "solution": "问题要求计算一个由 $N$ 个相同配体结合位点组成的一维链在半饱和（$\\theta = 1/2$）时的操作性 Hill 系数 $n_{\\mathrm{H}}$。其理论框架是统计力学，具体而言是应用于晶格模型的巨正则系综，在此背景下通常称为一维伊辛模型（1D Ising model）。将按照规定从第一性原理构建解决方案。\n\n系统的状态由所有可能的结合构型（即微观状态）的集合定义。对于一个包含 $N$ 个位点的线性链，其中每个位点可以处于未占据（状态 0）或已占据（状态 1）状态，存在 $2^N$ 个不同的微观状态。在巨正则系综中，每个微观状态的统计权重由被占据的位点数 $n_{\\mathrm{b}}$ 和被占据位点之间的最近邻相互作用数 $n_{\\mathrm{pairs}}$ 决定。\n\n结合单个配体的无量纲统计权重由配体浓度 $c$ 与固有解离常数 $K_{\\mathrm{d}}$ 的比值给出：\n$$\nw = \\frac{c}{K_{\\mathrm{d}}}\n$$\n无量纲协同因子 $\\omega$ 用于说明相邻被占据位点之间的相互作用自由能 $\\Delta \\epsilon_{\\mathrm{coop}}$。该因子源于相互作用能的 Boltzmann 权重：\n$$\n\\omega = \\exp\\!\\left(-\\frac{\\Delta \\epsilon_{\\mathrm{coop}} \\times 10^3}{RT}\\right)\n$$\n其中因子 $10^3$ 将 $\\Delta \\epsilon_{\\mathrm{coop}}$ 从千焦/摩尔转换为国际单位制（SI）中的焦耳/摩尔，以与普适气体常数 $R = 8.314 \\, \\mathrm{J} \\, \\mathrm{mol}^{-1} \\, \\mathrm{K}^{-1}$ 保持一致。$\\Delta \\epsilon_{\\mathrm{coop}} < 0$ 的值对应于稳定化相互作用（正协同性，$\\omega > 1$），而 $\\Delta \\epsilon_{\\mathrm{coop}} > 0$ 对应于去稳定化相互作用（负协同性，$\\omega < 1$）。如果 $\\Delta \\epsilon_{\\mathrm{coop}} = 0$，则位点是独立的（$\\omega = 1$）。\n\n配分函数（或称结合多项式）$Z(c)$ 是所有可能微观状态的统计权重之和：\n$$\nZ(c) = \\sum_{i=1}^{2^N} w^{n_{\\mathrm{b},i}} \\, \\omega^{n_{\\mathrm{pairs},i}}\n$$\n其中，总和是针对所有微观状态 $i$，$n_{\\mathrm{b},i}$ 和 $n_{\\mathrm{pairs},i}$ 分别是该微观状态下结合的配体数和相邻被占据位点对的数量。\n\n分数饱和度 $\\theta(c)$ 是平均被占据位点数 $\\langle n_{\\mathrm{b}} \\rangle$ 除以总位点数 $N$。该平均值使用配分函数计算：\n$$\n\\theta(c) = \\frac{\\langle n_{\\mathrm{b}} \\rangle}{N} = \\frac{1}{N} \\frac{\\sum_{i} n_{\\mathrm{b},i} \\, w^{n_{\\mathrm{b},i}} \\, \\omega^{n_{\\mathrm{pairs},i}}}{\\sum_{i} w^{n_{\\mathrm{b},i}} \\, \\omega^{n_{\\mathrm{pairs},i}}}\n$$\n该表达式也可以紧凑地写为配分函数对数的导数形式：\n$$\n\\theta(c) = \\frac{1}{N} w \\frac{\\partial \\ln Z(c)}{\\partial w} = \\frac{1}{N} \\frac{\\partial \\ln Z(c)}{\\partial \\ln w}\n$$\n\n确定 Hill 系数 $n_{\\mathrm{H}}$ 的计算过程包括三个主要步骤。\n\n**步骤 1：热力学函数的评估**\n根据问题描述，我们将通过直接枚举所有 $2^N$ 个微观状态来计算 $Z(c)$ 和 $\\theta(c)$ 的分子项。对于测试集中指定的小 $N$ 值，这种方法是数值精确且可行的。从 $0$ 到 $2^N - 1$ 的每个整数通过其二进制表示唯一地代表一个微观状态。对于每个微观状态：\n1.  被占据的位点数 $n_{\\mathrm{b}}$ 是其二进制表示中置位（set bits）的数量（Hamming 权重）。\n2.  相邻被占据位点对的数量 $n_{\\mathrm{pairs}}$ 通过检查二进制字符串中的相邻比特位，并计数模式 `11` 的出现次数来找到。\n利用每个微观状态的这些值，可以为任意给定浓度 $c$ 计算 $Z(c)$ 的和以及 $\\theta(c)$ 的分子项。\n\n**步骤 2：半饱和浓度 $c_{1/2}$ 的确定**\n半饱和时的浓度 $c_{1/2}$ 由条件 $\\theta(c_{1/2}) = 1/2$ 定义。为了找到 $c_{1/2}$，我们必须求解以下关于 $c$ 的方程：\n$$\nf(c) = \\theta(c) - \\frac{1}{2} = 0\n$$\n函数 $\\theta(c)$ 是 $c$ 的单调递增函数，范围从 $\\theta(0)=0$ 到 $\\theta(\\infty)=1$。这保证了唯一根 $c_{1/2}$ 的存在。一个鲁棒的数值求根算法，例如 Brent 方法，适合此任务。需要一个合适的搜索区间；考虑到在非协同情况下 $c_{1/2} = K_{\\mathrm{d}}$，一个以 $K_{\\mathrm{d}}$ 为中心进行对数对称的搜索范围（例如 $[10^{-3} K_{\\mathrm{d}}, 10^3 K_{\\mathrm{d}}]$）是一个可靠的选择。\n\n**步骤 3：Hill 系数 $n_{\\mathrm{H}}$ 的计算**\n操作性 Hill 系数在半饱和点定义为 Hill 图在该点的斜率：\n$$\nn_{\\mathrm{H}} = \\left. \\frac{\\mathrm{d}}{\\mathrm{d} \\ln c} \\ln\\!\\left(\\frac{\\theta(c)}{1 - \\theta(c)}\\right) \\right|_{c = c_{1/2}}\n$$\n我们将使用二阶对称有限差分格式来数值近似这个导数。令 $Y(c) = \\ln(\\theta(c)/(1 - \\theta(c)))$ 和 $x = \\ln c$。则导数近似为：\n$$\nn_{\\mathrm{H}} \\approx \\frac{Y(c_+) - Y(c_-)}{x_+ - x_-}\n$$\n其中 $x_{\\pm} = \\ln(c_{1/2}) \\pm h$，$h$ 是一个小的步长（例如 $h=10^{-6}$）。这可转化为在浓度 $c_+ = c_{1/2} e^h$ 和 $c_- = c_{1/2} e^{-h}$ 处计算 Hill 变换 $Y(c)$。完整的表达式为：\n$$\nn_{\\mathrm{H}} \\approx \\frac{Y(c_{1/2} e^h) - Y(c_{1/2} e^{-h})}{2h}\n$$\n该方法提供了对导数的稳定且准确的估计。\n\n每个测试用例的总体算法如下：\n1.  给定 $(N, K_{\\mathrm{d}}, \\Delta \\epsilon_{\\mathrm{coop}}, T)$，计算协同因子 $\\omega$。\n2.  对所有 $2^N$ 个微观状态，预先计算并存储其属性（$n_{\\mathrm{b}}$, $n_{\\mathrm{pairs}}$）。\n3.  基于微观状态枚举定义函数 $\\theta(c)$。\n4.  数值求解 $\\theta(c) - 1/2 = 0$ 以找到 $c_{1/2}$。\n5.  使用计算出的 $c_{1/2}$ 应用对称有限差分公式以找到 $n_{\\mathrm{H}}$。\n6.  按要求将结果四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the operational Hill coefficient at half-saturation for a 1D cooperative binding model.\n    \"\"\"\n    R = 8.314  # Universal gas constant in J/(mol·K)\n\n    # Test suite: (N, K_d, dE_coop, T)\n    # N: number of sites\n    # K_d: intrinsic dissociation constant (mol/L)\n    # dE_coop: interaction free energy (kJ/mol)\n    # T: temperature (K)\n    test_cases = [\n        (4, 1e-6, -2.0, 298.0),  # Positive cooperativity\n        (4, 1e-6, 0.0, 298.0),   # No cooperativity (independent sites)\n        (4, 1e-6, 4.0, 298.0),   # Negative cooperativity\n        (1, 1e-6, -10.0, 298.0)  # Single site (cooperativity irrelevant)\n    ]\n\n    results = []\n    for case in test_cases:\n        n_H = compute_hill_coefficient(case, R)\n        results.append(f\"{n_H:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef get_microstate_properties(N):\n    \"\"\"\n    Enumerates all 2^N microstates and computes their properties.\n    For each microstate, it calculates the number of occupied sites (n_b)\n    and the number of adjacent occupied pairs (n_pairs).\n\n    Args:\n        N (int): The number of binding sites.\n\n    Returns:\n        list: A list of tuples, where each tuple is (n_b, n_pairs).\n    \"\"\"\n    properties = []\n    for i in range(2**N):\n        # n_b is the number of set bits (Hamming weight)\n        n_b = bin(i).count('1')\n        \n        # n_pairs is the number of adjacent '11' patterns\n        n_pairs = 0\n        temp_i = i\n        while temp_i > 0:\n            # Check if the last two bits are '11'\n            if (temp_i & 3) == 3:\n                n_pairs += 1\n            temp_i >>= 1\n        \n        properties.append((n_b, n_pairs))\n    return properties\n\ndef compute_hill_coefficient(params, R):\n    \"\"\"\n    Computes the Hill coefficient for a single set of parameters.\n\n    Args:\n        params (tuple): A tuple containing (N, K_d, dE_coop, T).\n        R (float): The universal gas constant.\n\n    Returns:\n        float: The calculated Hill coefficient.\n    \"\"\"\n    N, Kd, dE_coop, T = params\n    \n    # Calculate dimensionless cooperativity factor omega\n    # dE_coop is converted from kJ/mol to J/mol\n    omega = np.exp(-dE_coop * 1000.0 / (R * T))\n    \n    # Pre-compute properties of all microstates to speed up calculations\n    microstate_props = get_microstate_properties(N)\n\n    def theta_fn(c):\n        \"\"\"\n        Calculates the fractional occupancy theta for a given concentration c.\n        \"\"\"\n        if c == 0:\n            return 0.0\n        \n        w = c / Kd  # Dimensionless binding weight\n        \n        Z_sum = 0.0\n        numerator_sum = 0.0\n        \n        for n_b, n_pairs in microstate_props:\n            # The calculation of w**n_b can be unstable for large n_b and extreme w.\n            # Using logarithms can improve stability, but for N=4, direct power is fine.\n            # term = np.exp(n_b * np.log(w) + n_pairs * np.log(omega)) if w > 0 else 0\n            term = (w**n_b) * (omega**n_pairs)\n            Z_sum += term\n            numerator_sum += n_b * term\n            \n        if Z_sum == 0.0:\n            return 0.0 # Should not occur for c > 0\n            \n        return (1.0 / N) * numerator_sum / Z_sum\n\n    # Step 2: Find the concentration c_1/2 where theta(c) = 1/2\n    # Define the function whose root we want to find\n    root_fn = lambda c: theta_fn(c) - 0.5\n    \n    # Set a safe search bracket around Kd\n    # Cooperativity shifts c_1/2, so a wide range is robust.\n    bracket = [Kd * 1e-4, Kd * 1e4]\n    \n    # Use Brent's method to find the root\n    sol = root_scalar(root_fn, bracket=bracket, method='brentq')\n    c_half = sol.root\n\n    # Step 3: Calculate the Hill coefficient n_H using a symmetric finite difference\n    h = 1e-6  # Small step for numerical derivative in log space\n    \n    # Concentrations for symmetric difference\n    c_plus = c_half * np.exp(h)\n    c_minus = c_half * np.exp(-h)\n    \n    # Calculate theta at these concentrations\n    theta_plus = theta_fn(c_plus)\n    theta_minus = theta_fn(c_minus)\n    \n    # Hill transform Y = log(theta / (1 - theta))\n    # Add small epsilon to avoid log(0) or division by zero, though unlikely here.\n    eps = 1e-12\n    Y_plus = np.log((theta_plus + eps) / (1.0 - theta_plus + eps))\n    Y_minus = np.log((theta_minus + eps) / (1.0 - theta_minus + eps))\n    \n    # n_H = d(Y) / d(log c)\n    n_H = (Y_plus - Y_minus) / (2.0 * h)\n    \n    return n_H\n\nsolve()\n```"
        },
        {
            "introduction": "本练习旨在将我们的理论和计算模型与真实世界的实验数据联系起来。范特霍夫分析是测定结合焓和熵的一种经典实验方法。通过编程实现这一分析，你将学习如何从平衡常数的温度依赖性测量中提取这些关键的热力学驱动力，从而为验证计算模型提供有力工具。()",
            "id": "3867869",
            "problem": "您的任务是实现一个完整的、可运行的程序，该程序基于第一性原理，使用适用于范特霍夫分析的数据，对生物分子结合热力学进行严谨的分析。程序必须根据不同温度下的平衡结合数据推导并估算标准结合焓和熵，然后在指定的参考温度下计算标准吉布斯自由能。您的推导必须从标准吉布斯自由能及其与平衡常数关系的基本热力学恒等式，以及标准焓和熵的定义出发，不得调用任何简化公式。该分析必须既能适用于直接提供的结合平衡常数，也适用于必须首先转换为结合常数的解离常数。程序必须在没有任何外部输入的情况下确定性地运行，必须执行其自身的计算，并以指定格式输出结果。\n\n科学假设与约束条件：\n- 适用标准吉布斯自由能，溶质的摩尔标准态为 $1$ 摩尔每升 (M)，这与生物化学惯例一致。\n- 在所提供的温度范围内，可以近似地认为标准结合焓和熵与温度无关。\n- 所有与平衡常数相关的对数量均使用自然对数。\n- 使用 $1$ 摩尔每升的标准态，平衡常数被视为无量纲；数值可以以名义单位为 $\\mathrm{M}^{-1}$ 的结合常数形式提供，或以名义单位为 $\\mathrm{M}$ 的解离常数形式提供，必要时必须通过转换进行一致处理。\n- 温度为绝对温度，以开尔文 (Kelvin) 为单位。\n\n您的程序必须对测试套件中的每个数据集执行以下操作：\n1. 仅使用基本定义将任何解离常数数据转换为结合常数。\n2. 从第一性原理出发构建适当的变量，以获得一个适用于普通最小二乘法拟合的线性关系，从而估算标准结合焓和熵。\n3. 使用拟合得到的热力学参数，计算参考温度 $T_0$ 下的标准吉布斯自由能。\n4. 标准焓以千焦每摩尔表示，标准熵以焦耳每摩尔每开尔文表示，标准吉布斯自由能以千焦每摩尔表示。\n5. 将所有数值输出四舍五入到三位小数。\n\n物理常数和单位：\n- 使用普适气体常数 $R = 8.314462618$ $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 标准焓以 $\\mathrm{kJ\\,mol^{-1}}$ 表示，标准熵以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 表示，标准吉布斯自由能以 $\\mathrm{kJ\\,mol^{-1}}$ 表示。\n- 使用参考温度 $T_0 = 298.000$ $\\mathrm{K}$。\n\n测试套件：\n每个测试用例包含一个开尔文温度列表、一个相应的平衡常数值列表，以及一个指示所提供常数是否为解离常数的标志。除非另有说明，所有温度和常数均无噪声。以下所有数值均以实际的有效数字位数给出。\n\n- 测试用例 1 (结合常数，类放热结合)：\n  - 温度 $T$: $[283.000, 293.000, 303.000, 313.000]$ $\\mathrm{K}$。\n  - 结合常数 $K_\\mathrm{a}$: $[80000.000, 60000.000, 45000.000, 34000.000]$ (以 $1$ 摩尔每升为标准态，无量纲)。\n  - 是否为解离常数标志：$False$。\n\n- 测试用例 2 (解离常数，伴有测量变化的弱吸热)：\n  - 温度 $T$: $[283.000, 293.000, 303.000, 313.000]$ $\\mathrm{K}$。\n  - 解离常数 $K_\\mathrm{d}$: $[0.000009000, 0.000007000, 0.000005800, 0.000005000]$ $\\mathrm{M}$。\n  - 是否为解离常数标志：$True$。\n\n- 测试用例 3 (结合常数，接近零焓边界；弱温度依赖性)：\n  - 温度 $T$: $[283.000, 293.000, 303.000, 313.000]$ $\\mathrm{K}$。\n  - 结合常数 $K_\\mathrm{a}$: $[50000.000, 50050.000, 49950.000, 50020.000]$ (以 $1$ 摩尔每升为标准态，无量纲)。\n  - 是否为解离常数标志：$False$。\n\n- 测试用例 4 (结合常数，类吸热结合；更强的温度依赖性)：\n  - 温度 $T$: $[283.000, 293.000, 303.000, 313.000]$ $\\mathrm{K}$。\n  - 结合常数 $K_\\mathrm{a}$: $[20000.000, 25000.000, 33000.000, 44000.000]$ (以 $1$ 摩尔每升为标准态，无量纲)。\n  - 是否为解离常数标志：$False$。\n\n输出规范：\n- 对于每个测试用例，计算并输出一个列表 $[\\Delta H^\\circ, \\Delta S^\\circ, \\Delta G^\\circ(T_0)]$，其中的值按上述指定单位四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个由这些列表组成的、以逗号分隔的列表，并用方括号括起来，不含空格。例如：$\"[[h_1,s_1,g_1],[h_2,s_2,g_2],...]\"$，其中每个 $h_i$、$s_i$ 和 $g_i$ 都是四舍五入后的浮点数。\n\n需要实现的内容：\n- 为热力学恒等式所蕴含的相应线性化变量，从第一性原理出发实现普通最小二乘线性回归。您可以使用编程环境提供的标准数值例程。确保数值稳定性和量纲一致性。\n- 确保所有计算都使用自然对数和指定常数 $R$。\n- 确保最终输出严格遵守指定的单行格式。\n\n请使用指定的精确单位和描述的格式作答。如果相关，角度计算请使用弧度；本任务不要求角度计算。",
            "solution": "我们从基本的热力学定义出发。标准结合吉布斯自由能（记为 $\\Delta G^\\circ$）通过平衡常数由以下恒等式定义：\n$$\n\\Delta G^\\circ = - R T \\ln K,\n$$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度，$K$ 是以 $1$ 摩尔每升为标准态的无量纲平衡常数。在溶液生物化学中，当结合常数的数值以名义单位 $\\mathrm{M}^{-1}$ 给出时，它被理解为在乘以标准浓度 $c^\\circ = 1\\,\\mathrm{M}$ 后是无量纲的，这样就可以一致地应用自然对数。当解离常数 $K_\\mathrm{d}$ 以 $\\mathrm{M}$ 为单位提供时，结合常数可根据平衡的基本定义由 $K_\\mathrm{a} = 1/K_\\mathrm{d}$ 得出，并且在相同的标准态约定下，同样可以视为无量纲。\n\n关于标准吉布斯自由能的另一个基本恒等式将其与标准焓 $\\Delta H^\\circ$ 和标准熵 $\\Delta S^\\circ$ 联系起来：\n$$\n\\Delta G^\\circ = \\Delta H^\\circ - T \\Delta S^\\circ.\n$$\n在所研究的温度范围内，假设 $\\Delta H^\\circ$ 和 $\\Delta S^\\circ$ 近似不依赖于温度（这是生物化学结合中对于适度温度区间广泛使用的近似），我们可以通过代数方法结合这两个恒等式，得到平衡常数与温度之间的关系。将 $\\Delta G^\\circ$ 的表达式代入将其与 $\\ln K$ 联系起来的恒等式，得到\n$$\n- R T \\ln K = \\Delta H^\\circ - T \\Delta S^\\circ.\n$$\n两边同除以 $-R T$ 并重新整理各项，得到\n$$\n\\ln K = -\\frac{\\Delta H^\\circ}{R} \\left(\\frac{1}{T}\\right) + \\frac{\\Delta S^\\circ}{R}.\n$$\n这表明，平衡结合常数的自然对数 $\\ln K$ 随温度的倒数 $1/T$ 线性变化，其斜率为 $m = -\\Delta H^\\circ / R$，截距为 $b = \\Delta S^\\circ / R$。因此，给定多个温度下的平衡常数测量值，我们可以对 $y = \\ln K$ 与 $x = 1/T$ 进行普通最小二乘线性回归，以估计斜率 $m$ 和截距 $b$。由此，热力学参数可通过以下方式恢复：\n$$\n\\Delta H^\\circ = - m R \\quad\\text{和}\\quad \\Delta S^\\circ = b R.\n$$\n\n基于上述原理的算法设计：\n1. 对于每个数据集，确定结合常数值。如果数据集提供解离常数 $K_\\mathrm{d}$（标志为真），则通过 $K_\\mathrm{a} = 1/K_\\mathrm{d}$ 计算结合常数。如果提供的是结合常数（标志为假），则直接使用它们。在 $1$ 摩尔每升的标准态下，将这些数值视为无量纲以进行对数运算。\n2. 分别使用自然对数，构建预测变量和响应变量，即 $x_i = 1/T_i$ (单位为 $\\mathrm{K}^{-1}$) 和 $y_i = \\ln K_{\\mathrm{a},i}$ (无量纲)。\n3. 使用普通最小二乘法将直线 $y = m x + b$ 拟合到这些点。其闭合形式由正规方程给出：\n   $$\n   m = \\frac{N \\sum x_i y_i - \\sum x_i \\sum y_i}{N \\sum x_i^2 - \\left(\\sum x_i\\right)^2}, \\qquad\n   b = \\frac{\\sum y_i - m \\sum x_i}{N},\n   $$\n   其中 $N$ 是数据点的数量。等效地，可以使用一个数值稳定的 1 次多项式拟合程序来获得 $m$ 和 $b$。\n4. 使用恒等式 $\\Delta H^\\circ = - m R$ 和 $\\Delta S^\\circ = b R$ 计算热力学参数。将 $\\Delta H^\\circ$ 除以 $1000$ 转换为 $\\mathrm{kJ\\,mol^{-1}}$，$\\Delta S^\\circ$ 保留单位 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n5. 使用 $\\Delta G^\\circ(T_0) = \\Delta H^\\circ - T_0 \\Delta S^\\circ$ 计算参考温度 $T_0$ 下的标准吉布斯自由能。将结果除以 $1000$ 转换为 $\\mathrm{kJ\\,mol^{-1}}$。\n6. 将 $\\Delta H^\\circ$ (单位 $\\mathrm{kJ\\,mol^{-1}}$)、$\\Delta S^\\circ$ (单位 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$) 和 $\\Delta G^\\circ(T_0)$ (单位 $\\mathrm{kJ\\,mol^{-1}}$) 各自四舍五入到三位小数。\n7. 将所有测试用例的结果聚合到一个列表的列表中，形式为 $[[\\Delta H^\\circ,\\Delta S^\\circ,\\Delta G^\\circ(T_0)],\\ldots]$，并打印包含此列表的单行，条目间以逗号分隔且无空格。\n\n测试套件中的科学真实性和边缘情况：\n- 测试用例 1 提供了随温度升高而减小的结合常数，这是典型的放热结合（$\\Delta H^\\circ < 0$），会产生负斜率 $m$ 和负的 $\\Delta H^\\circ$。\n- 测试用例 2 提供了离解常数，取倒数后得到的结合常数随温度升高而增加，这与吸热结合（$\\Delta H^\\circ > 0$）一致。微小的测量变化用于测试数值稳定性。\n- 测试用例 3 提供的结合常数几乎不随温度变化，用于探究 $\\Delta H^\\circ \\approx 0$ 且斜率接近零的边界情况。\n- 测试用例 4 提供的结合常数随温度升高而更显著地增加，这与更强的吸热过程和更大的正熵变一致。\n\n程序将实现上述步骤，使用普适气体常数 $R = 8.314462618$ $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$、自然对数以及参考温度 $T_0 = 298.000$ $\\mathrm{K}$。最终输出将严格遵守指定的格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef vanthoff_fit(temperatures_K, constants, is_dissociation, R=8.314462618, T0=298.0):\n    \"\"\"\n    Perform van't Hoff analysis:\n    - temperatures_K: list or array of temperatures in Kelvin.\n    - constants: list or array of equilibrium constants (association or dissociation).\n    - is_dissociation: bool, True if 'constants' are dissociation constants (Kd), False if association (Ka).\n    - R: universal gas constant in J/mol/K.\n    - T0: reference temperature in Kelvin.\n    Returns: (DeltaH_kJ_per_mol, DeltaS_J_per_mol_K, DeltaG_kJ_per_mol_at_T0)\n    \"\"\"\n    T = np.array(temperatures_K, dtype=float)\n    vals = np.array(constants, dtype=float)\n\n    # Convert dissociation constants to association constants if necessary.\n    if is_dissociation:\n        # Association constant Ka = 1 / Kd\n        Ka = 1.0 / vals\n    else:\n        Ka = vals\n\n    # Prepare variables for linear regression: y = ln(Ka), x = 1/T\n    x = 1.0 / T\n    y = np.log(Ka)\n\n    # Fit y = m*x + b using ordinary least squares.\n    # Use numpy.polyfit degree 1 for numerical stability.\n    m, b = np.polyfit(x, y, 1)\n\n    # Recover thermodynamic parameters from slope and intercept.\n    # m = -DeltaH/R  => DeltaH = -m*R (J/mol)\n    # b = DeltaS/R   => DeltaS = b*R (J/mol/K)\n    deltaH_J_per_mol = -m * R\n    deltaS_J_per_mol_K = b * R\n\n    # Convert DeltaH to kJ/mol\n    deltaH_kJ_per_mol = deltaH_J_per_mol / 1000.0\n\n    # Compute DeltaG at T0: DeltaG = DeltaH - T0*DeltaS (J/mol), then to kJ/mol\n    deltaG_J_per_mol_T0 = deltaH_J_per_mol - T0 * deltaS_J_per_mol_K\n    deltaG_kJ_per_mol_T0 = deltaG_J_per_mol_T0 / 1000.0\n\n    # Round to three decimal places\n    return (\n        round(deltaH_kJ_per_mol, 3),\n        round(deltaS_J_per_mol_K, 3),\n        round(deltaG_kJ_per_mol_T0, 3),\n    )\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case: (temperatures_K_list, constants_list, is_dissociation_flag)\n        ([283.000, 293.000, 303.000, 313.000], [80000.000, 60000.000, 45000.000, 34000.000], False),\n        ([283.000, 293.000, 303.000, 313.000], [0.000009000, 0.000007000, 0.000005800, 0.000005000], True),\n        ([283.000, 293.000, 303.000, 313.000], [50000.000, 50050.000, 49950.000, 50020.000], False),\n        ([283.000, 293.000, 303.000, 313.000], [20000.000, 25000.000, 33000.000, 44000.000], False),\n    ]\n\n    results = []\n    for temps, consts, is_kd in test_cases:\n        h_kj, s_jk, g_kj = vanthoff_fit(temps, consts, is_kd)\n        results.append([h_kj, s_jk, g_kj])\n\n    # Build the exact required single-line output: comma-separated lists, no spaces.\n    # Format each inner list with numbers joined by commas.\n    inner_strs = []\n    for triple in results:\n        inner_strs.append(f\"[{triple[0]},{triple[1]},{triple[2]}]\")\n    output = f\"[{','.join(inner_strs)}]\"\n    print(output)\n\nsolve()\n```"
        }
    ]
}