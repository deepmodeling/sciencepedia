{
    "hands_on_practices": [
        {
            "introduction": "The energy components in Density Functional Theory, such as the non-interacting kinetic energy $T_s$ and the exchange-correlation energy $E_{xc}$, can often seem abstract. This exercise grounds these concepts in a tangible example by using an exactly solvable two-electron system known as the Moshinsky atom . By deriving and calculating each energy component exactly, you will demystify the formal DFT energy decomposition and gain a clear, quantitative understanding of how the total energy is partitioned, particularly the nature of the elusive exchange-correlation term.",
            "id": "2384996",
            "problem": "Consider a one-dimensional, spin-compensated, two-electron system in atomic units (Hartree atomic units where the electron mass, elementary charge, and reduced Planck constant are set to unity). The external potential is harmonic, and the electron-electron interaction is a harmonic repulsion. The Hamiltonian is\n$$\n\\hat{H} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} - \\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2} + \\frac{1}{2}\\omega^2 \\left(x_1^2 + x_2^2\\right) + \\frac{k}{2}\\left(x_1 - x_2\\right)^2,\n$$\nwith parameters $\\omega \\gt 0$ and $k \\ge 0$. Work in the framework of Density Functional Theory (DFT) and decompose the exact ground-state total energy into the following terms:\n- The non-interacting Kohn–Sham (KS) kinetic energy $T_s$.\n- The external potential energy $E_{ext}$.\n- The Hartree energy $E_H$ for the given electron-electron interaction.\n- The exchange–correlation energy $E_{xc}$.\n\nYour task is to derive, from first principles, how to compute each energy contribution exactly for this model and implement it as a program.\n\nUse only the following fundamental starting points and definitions:\n- Separation of the two-body Hamiltonian into center-of-mass and relative coordinates to obtain the exact ground-state energy $E_{tot}$ and the exact one-electron density $n(x)$.\n- For a spin-compensated two-electron system occupying a single spatial orbital, the exact Kohn–Sham kinetic energy equals the Weizsäcker kinetic energy functional\n$$\nT_s[n] = \\frac{1}{8}\\int_{-\\infty}^{\\infty} \\frac{\\left(\\frac{dn}{dx}\\right)^2}{n(x)}\\,dx.\n$$\n- The external potential energy is\n$$\nE_{ext}[n] = \\int_{-\\infty}^{\\infty} n(x)\\, v_{ext}(x)\\, dx, \\quad v_{ext}(x) = \\frac{1}{2}\\omega^2 x^2.\n$$\n- The Hartree energy for the given pair potential is\n$$\nE_H[n] = \\frac{1}{2}\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} n(x)\\, n(x')\\, w(x-x')\\, dx\\, dx', \\quad w(x-x') = \\frac{k}{2}(x-x')^2.\n$$\n- The exchange–correlation energy is defined residually by\n$$\nE_{xc} = E_{tot} - T_s - E_{ext} - E_H,\n$$\nwhere $E_{tot}$ is the exact ground-state energy of $\\hat{H}$.\n\nExpress all energies in Hartree. Report each energy rounded to eight decimal places.\n\nTest suite:\n- Case 1 (happy path, noninteracting limit): $\\omega = 1.0$, $k = 0.0$.\n- Case 2 (moderate interaction): $\\omega = 1.0$, $k = 0.5$.\n- Case 3 (weak trap, strong interaction): $\\omega = 0.5$, $k = 2.0$.\n- Case 4 (strong trap, strong interaction): $\\omega = 2.0$, $k = 5.0$.\n\nYour program must, for each test case, compute and return a list of five floats\n$$\n\\left[ T_s,\\; E_{ext},\\; E_H,\\; E_{xc},\\; E_{tot} \\right]\n$$\neach rounded to eight decimal places, in Hartree. The final output must be a single line containing a top-level list of the four per-case lists, with no spaces. For example, the format must be\n$$\n\\left[\\left[T_s^{(1)},E_{ext}^{(1)},E_H^{(1)},E_{xc}^{(1)},E_{tot}^{(1)}\\right],\\ldots,\\left[T_s^{(4)},E_{ext}^{(4)},E_H^{(4)},E_{xc}^{(4)},E_{tot}^{(4)}\\right]\\right]\n$$\nbut with the actual numerical values in place of the symbols and with no whitespace. No user input should be read; the program must run as-is and print only this single line.",
            "solution": "The problem requires the calculation of density functional theory (DFT) energy components for a one-dimensional two-electron system with harmonic confinement and harmonic electron-electron repulsion. The solution must be derived from first principles.\n\nThe starting point is the Hamiltonian in atomic units ($\\hbar=m_e=e=1$):\n$$\n\\hat{H} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x_1^2} - \\frac{1}{2}\\frac{\\partial^2}{\\partial x_2^2} + \\frac{1}{2}\\omega^2 \\left(x_1^2 + x_2^2\\right) + \\frac{k}{2}\\left(x_1 - x_2\\right)^2\n$$\n\n**Step 1: Exact Solution of the Schrödinger Equation**\n\nTo find the exact ground-state energy $E_{tot}$ and the one-electron density $n(x)$, we solve the two-body Schrödinger equation $\\hat{H}\\Psi(x_1, x_2) = E\\Psi(x_1, x_2)$. This is achieved by transforming to center-of-mass ($R$) and relative ($r$) coordinates:\n$$\nR = \\frac{x_1 + x_2}{2}, \\quad r = x_1 - x_2\n$$\nThe kinetic energy operator transforms to:\n$$\n-\\frac{1}{2}\\left(\\frac{\\partial^2}{\\partial x_1^2} + \\frac{\\partial^2}{\\partial x_2^2}\\right) = -\\frac{1}{2}\\left(\\frac{1}{2}\\frac{\\partial^2}{\\partial R^2} + 2\\frac{\\partial^2}{\\partial r^2}\\right) = -\\frac{1}{2(2)}\\frac{\\partial^2}{\\partial R^2} - \\frac{1}{2(1/2)}\\frac{\\partial^2}{\\partial r^2}\n$$\nThis represents two particles: a center-of-mass particle with mass $M=2$ and a relative particle with reduced mass $\\mu=1/2$. The potential energy terms transform to:\n$$\n\\frac{1}{2}\\omega^2(x_1^2 + x_2^2) = \\frac{1}{2}\\omega^2 \\left(2R^2 + \\frac{r^2}{2}\\right) = \\omega^2 R^2 + \\frac{\\omega^2}{4}r^2\n$$\nThe interaction potential is simply $\\frac{k}{2}r^2$. The Hamiltonian separates into two independent parts, $\\hat{H} = \\hat{H}_R + \\hat{H}_r$:\n$$\n\\hat{H}_R = -\\frac{1}{4}\\frac{\\partial^2}{\\partial R^2} + \\omega^2 R^2 = -\\frac{1}{2(2)}\\frac{\\partial^2}{\\partial R^2} + \\frac{1}{2}(2)\\omega^2 R^2\n$$\n$$\n\\hat{H}_r = -\\frac{\\partial^2}{\\partial r^2} + \\frac{\\omega^2}{4}r^2 + \\frac{k}{2}r^2 = -\\frac{1}{2(1/2)}\\frac{\\partial^2}{\\partial r^2} + \\frac{1}{2}\\left(\\frac{1}{2}\\right)(\\omega^2+2k)r^2\n$$\nBoth $\\hat{H}_R$ and $\\hat{H}_r$ are standard quantum harmonic oscillator (QHO) Hamiltonians.\nFor the center-of-mass motion, the mass is $M=2$ and the frequency is $\\Omega_R=\\omega$. The ground-state energy is $E_R^{(0)} = \\frac{1}{2}\\Omega_R = \\frac{1}{2}\\omega$.\nFor the relative motion, the mass is $\\mu=1/2$ and the frequency is $\\Omega_r=\\sqrt{\\omega^2+2k}$. The ground-state energy is $E_r^{(0)} = \\frac{1}{2}\\Omega_r = \\frac{1}{2}\\sqrt{\\omega^2+2k}$.\n\nThe exact total ground-state energy is the sum of these two energies:\n$$\nE_{tot} = E_R^{(0)} + E_r^{(0)} = \\frac{1}{2}\\omega + \\frac{1}{2}\\sqrt{\\omega^2+2k}\n$$\n\n**Step 2: Derivation of the Exact One-Electron Density**\n\nThe ground-state wavefunction is the product of the QHO ground-state wavefunctions for each mode: $\\Psi_0(R, r) = \\Phi_R^{(0)}(R) \\Phi_r^{(0)}(r)$. The one-electron density $n(x)$ is found by integrating the two-electron probability density over the coordinates of one electron, multiplied by the number of electrons ($N=2$):\n$$\nn(x_1) = 2 \\int_{-\\infty}^{\\infty} |\\Psi_0(\\frac{x_1+x_2}{2}, x_1-x_2)|^2 dx_2\n$$\nThe ground-state probability densities are Gaussians: $|\\Phi_R^{(0)}(R)|^2 \\propto e^{-2\\omega R^2}$ and $|\\Phi_r^{(0)}(r)|^2 \\propto e^{-\\frac{1}{2}\\sqrt{\\omega^2+2k} r^2}$. Performing the Gaussian integral over $x_2$ yields the one-electron density $n(x)$, which is also a Gaussian:\n$$\nn(x) = C e^{-\\alpha x^2}\n$$\nwhere the decay constant $\\alpha$ is found to be:\n$$\n\\alpha = \\frac{2\\omega\\sqrt{\\omega^2+2k}}{\\omega+\\sqrt{\\omega^2+2k}}\n$$\nThe normalization constant $C$ is determined by the condition $\\int_{-\\infty}^{\\infty} n(x)dx=2$, which gives $C = 2\\sqrt{\\alpha/\\pi}$.\n\n**Step 3: Calculation of DFT Energy Components**\n\nWith the exact density $n(x)$, we can now compute the DFT energy components using the provided definitions.\n\n**Kohn-Sham Kinetic Energy ($T_s$)**: For this two-electron system, $T_s$ is given by the Weizsäcker functional.\n$$\nT_s[n] = \\frac{1}{8}\\int_{-\\infty}^{\\infty} \\frac{\\left(\\frac{dn}{dx}\\right)^2}{n(x)}\\,dx\n$$\nWe have $\\frac{dn}{dx} = -2\\alpha x \\cdot n(x)$. Substituting this into the integral:\n$$\nT_s = \\frac{1}{8}\\int \\frac{4\\alpha^2 x^2 (n(x))^2}{n(x)} dx = \\frac{\\alpha^2}{2}\\int x^2 n(x) dx\n$$\nThe second moment of the density is $\\int x^2 n(x)dx = 1/\\alpha$.\n$$\nT_s = \\frac{\\alpha^2}{2} \\left(\\frac{1}{\\alpha}\\right) = \\frac{\\alpha}{2}\n$$\n\n**External Potential Energy ($E_{ext}$)**:\n$$\nE_{ext}[n] = \\int_{-\\infty}^{\\infty} n(x) v_{ext}(x) dx = \\int_{-\\infty}^{\\infty} n(x)\\left(\\frac{1}{2}\\omega^2 x^2\\right) dx = \\frac{\\omega^2}{2}\\int x^2 n(x) dx\n$$\nUsing $\\int x^2 n(x)dx = 1/\\alpha$ again:\n$$\nE_{ext} = \\frac{\\omega^2}{2\\alpha}\n$$\n\n**Hartree Energy ($E_H$)**: The definition for the specified interaction $w(x-x') = \\frac{k}{2}(x-x')^2$ is:\n$$\nE_H[n] = \\frac{1}{2}\\iint n(x)n(x') \\frac{k}{2}(x-x')^2 dx dx' = \\frac{k}{4} \\iint n(x)n(x')(x^2 - 2xx' + x'^2) dx dx'\n$$\nExpanding and using moments of the density: $\\int n(x)dx = 2$, $\\int xn(x)dx = 0$ (by symmetry), and $\\int x^2 n(x)dx = 1/\\alpha$:\n$$\nE_H = \\frac{k}{4} \\left[ \\left(\\int n(x')dx'\\right)\\left(\\int x^2n(x)dx\\right) - 2\\left(\\int xn(x)dx\\right)^2 + \\left(\\int n(x)dx\\right)\\left(\\int x'^2n(x')dx'\\right) \\right]\n$$\n$$\nE_H = \\frac{k}{4} \\left[ (2)\\left(\\frac{1}{\\alpha}\\right) - 2(0)^2 + (2)\\left(\\frac{1}{\\alpha}\\right) \\right] = \\frac{k}{4}\\left(\\frac{4}{\\alpha}\\right) = \\frac{k}{\\alpha}\n$$\n\n**Exchange-Correlation Energy ($E_{xc}$)**: This is defined as the remaining portion of the total energy:\n$$\nE_{xc} = E_{tot} - T_s - E_{ext} - E_H\n$$\nSubstituting the derived expressions for each term allows for its numerical computation.\n\n**Summary of Formulas**:\nFor a given pair of parameters $(\\omega, k)$:\n1. Define a helper frequency: $\\Omega_r = \\sqrt{\\omega^2 + 2k}$.\n2. Define the density parameter: $\\alpha = \\frac{2\\omega\\Omega_r}{\\omega+\\Omega_r}$.\n3. The total energy is: $E_{tot} = \\frac{1}{2}(\\omega + \\Omega_r)$.\n4. The KS kinetic energy is: $T_s = \\frac{\\alpha}{2}$.\n5. The external potential energy is: $E_{ext} = \\frac{\\omega^2}{2\\alpha}$.\n6. The Hartree energy is: $E_H = \\frac{k}{\\alpha}$.\n7. The exchange-correlation energy is: $E_{xc} = E_{tot} - T_s - E_{ext} - E_H$.\nThese formulas are implemented in the provided program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for a 1D two-electron system with harmonic confinement and interaction.\n\n    The problem asks to calculate DFT energy components (Ts, Eext, EH, Exc) and the\n    exact total energy (Etot) for a model system described by the Hamiltonian:\n    H = -1/2 * d^2/dx1^2 - 1/2 * d^2/dx2^2 + 1/2*w^2*(x1^2+x2^2) + k/2*(x1-x2)^2\n\n    The derivations in the solution lead to the following analytical formulas:\n    1. Helper frequency for relative motion: Omega_r = sqrt(w^2 + 2k)\n    2. Density decay parameter: alpha = (2 * w * Omega_r) / (w + Omega_r)\n    3. Total energy: Etot = 1/2 * (w + Omega_r)\n    4. KS kinetic energy: Ts = alpha / 2\n    5. External potential energy: Eext = w^2 / (2 * alpha)\n    6. Hartree energy: EH = k / alpha\n    7. Exchange-correlation energy: Exc = Etot - Ts - Eext - EH\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    test_cases = [\n        (1.0, 0.0),  # Case 1: noninteracting limit\n        (1.0, 0.5),  # Case 2: moderate interaction\n        (0.5, 2.0),  # Case 3: weak trap, strong interaction\n        (2.0, 5.0),  # Case 4: strong trap, strong interaction\n    ]\n\n    all_results = []\n    \n    for omega, k in test_cases:\n        # Step 1: Calculate the helper frequency for the relative coordinate.\n        # Omega_r = sqrt(omega^2 + 2*k)\n        omega_r = np.sqrt(omega**2 + 2 * k)\n\n        # Step 2: Calculate the density parameter alpha.\n        # This parameter defines the Gaussian shape of the one-electron density n(x).\n        # alpha = (2 * omega * omega_r) / (omega + omega_r)\n        alpha = (2 * omega * omega_r) / (omega + omega_r)\n\n        # Step 3: Calculate the total ground-state energy E_tot.\n        # E_tot is the sum of the ground-state energies of the center-of-mass and relative oscillators.\n        e_tot = 0.5 * (omega + omega_r)\n\n        # Step 4: Calculate the non-interacting Kohn-Sham kinetic energy T_s.\n        # For this 2-electron system, T_s is exactly the Weizsäcker kinetic energy.\n        t_s = alpha / 2.0\n\n        # Step 5: Calculate the external potential energy E_ext.\n        e_ext = (omega**2) / (2.0 * alpha)\n\n        # Step 6: Calculate the Hartree energy E_H for the harmonic repulsion.\n        # For k=0, alpha  0, so EH is 0. If k  0, EH is positive.\n        e_h = k / alpha\n\n        # Step 7: Calculate the exchange-correlation energy E_xc residually.\n        # E_xc is defined as what's left after subtracting the other components from the exact total energy.\n        e_xc = e_tot - t_s - e_ext - e_h\n\n        # Collect the results for the current case, rounded to 8 decimal places.\n        case_results = [\n            round(t_s, 8),\n            round(e_ext, 8),\n            round(e_h, 8),\n            round(e_xc, 8),\n            round(e_tot, 8),\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as a list of lists, without any spaces.\n    # e.g., [[-1.0,-1.0],[-2.0,-2.0]]\n    result_str_list = []\n    for res_list in all_results:\n        # Format each number to 8 decimal places\n        formatted_nums = [f\"{x:.8f}\" for x in res_list]\n        result_str_list.append(f\"[{','.join(formatted_nums)}]\")\n    \n    final_output = f\"[{','.join(result_str_list)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "The first Hohenberg-Kohn theorem establishes the foundation of DFT, stating a unique mapping between the ground-state density and the external potential. However, the standard proof contains a crucial assumption: a non-degenerate ground state. In this practice , you will computationally explore the consequences of violating this assumption using a simple two-site Hubbard model, constructing an explicit counterexample where different potentials produce the same density.",
            "id": "2384997",
            "problem": "You will implement a complete, runnable program that constructs and exactly diagonalizes a two-site fermionic lattice model with two electrons to algorithmically investigate the uniqueness claim of the first Hohenberg-Kohn theorem under ground-state degeneracy. The work must be purely mathematical and algorithmic, framed in terms of a finite-dimensional Hilbert space model. All energies are to be treated in arbitrary but consistent energy units; no physical units need to be printed in the final output. Angles are not used.\n\nThe fundamental base you must use consists of: the Rayleigh-Ritz variational principle, the definition of the lattice Hamiltonian for the two-site, spinful Hubbard dimer, the fermionic anticommutation relations, and the definition of a ground-state density as an expectation value of the number operator. The first Hohenberg-Kohn theorem states, under a non-degenerate ground state assumption, that the ground-state density $n(\\mathbf{r})$ determines the external potential $v(\\mathbf{r})$ up to an additive constant. You will provide a counter-analysis by explicitly searching for two distinct external potentials that generate the same ground-state density for a system you design to have a degenerate ground state. Your program will certify a breakdown of uniqueness when it finds at least two different external potentials that do not differ by a global constant and produce the same ensemble ground-state density, with both corresponding ground states being degenerate.\n\nConsider the two-site Hubbard dimer with two electrons and spin-$\\frac{1}{2}$ fermions. Label the spin-orbitals as $\\{1\\uparrow, 1\\downarrow, 2\\uparrow, 2\\downarrow\\}$. The Hamiltonian acting on the $N=2$ electron sector is\n$$\n\\hat{H} = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left(\\hat{c}^{\\dagger}_{1\\sigma}\\hat{c}_{2\\sigma} + \\hat{c}^{\\dagger}_{2\\sigma}\\hat{c}_{1\\sigma}\\right)\n+ U \\sum_{i \\in \\{1,2\\}} \\hat{n}_{i\\uparrow}\\hat{n}_{i\\downarrow}\n+ v_1 \\sum_{\\sigma}\\hat{n}_{1\\sigma}\n+ v_2 \\sum_{\\sigma}\\hat{n}_{2\\sigma},\n$$\nwhere $t \\ge 0$ is the hopping amplitude, $U \\ge 0$ is the on-site interaction, $\\hat{n}_{i\\sigma}=\\hat{c}^{\\dagger}_{i\\sigma}\\hat{c}_{i\\sigma}$, and $v_1, v_2$ are the site potentials representing the external potential. The external potentials to be scanned are parameterized by a site-energy difference $\\Delta v$ via $v_1 = \\Delta v/2$ and $v_2 = -\\Delta v/2$. Different values of $\\Delta v$ correspond to different external potentials that are not related by a global constant when $\\Delta v$ differs.\n\nDefinitions to use:\n- The ground-state energy $E_0$ is the minimum eigenvalue of $\\hat{H}$ (by the Rayleigh-Ritz variational principle).\n- The ground-state subspace is the eigenspace associated with $E_0$. Its dimension is the degeneracy $g \\in \\mathbb{N}$.\n- The ensemble ground-state one-body density on site $i \\in \\{1,2\\}$ is defined as the equal-weight average over the ground-state subspace:\n$$\nn_i = \\frac{1}{g}\\operatorname{Tr}\\left(\\hat{P}_0 \\hat{n}_i\\right), \\quad \\hat{n}_1=\\hat{n}_{1\\uparrow}+\\hat{n}_{1\\downarrow}, \\ \\hat{n}_2=\\hat{n}_{2\\uparrow}+\\hat{n}_{2\\downarrow},\n$$\nwhere $\\hat{P}_0$ is the projector onto the ground-state subspace. This definition is basis-independent within the subspace.\n\nYour program must:\n1. Construct the $N=2$ sector of Fock space from the four spin-orbitals, implement fermionic creation and annihilation operators obeying canonical anticommutation relations, and assemble the Hamiltonian matrix $\\hat{H}$ for the given parameters $(t,U,\\Delta v)$ with $v_1=\\Delta v/2$ and $v_2=-\\Delta v/2$.\n2. Exactly diagonalize $\\hat{H}$ to obtain the ground-state energy $E_0$, its degeneracy $g$, the projector $\\hat{P}_0$, and the ensemble density vector $\\mathbf{n}=(n_1,n_2)$.\n3. For a given set of scanned values $\\{\\Delta v_k\\}$, detect a breakdown of the uniqueness claim of the first Hohenberg-Kohn theorem in the following algorithmic sense: there exist two distinct $\\Delta v_i \\ne \\Delta v_j$ such that the corresponding ensemble ground-state density vectors are equal within a numerical tolerance $\\varepsilon_n$, and both corresponding ground states are degenerate with degeneracy $g_i1$ and $g_j1$. If such a pair exists, output a boolean value true for that test case; otherwise false.\n\nUse the following numerical tolerances:\n- Energy degeneracy tolerance: two energies $E$ and $E'$ are equal if $|E-E'| \\le \\varepsilon_E$ with $\\varepsilon_E = 10^{-10}$.\n- Density equality tolerance: two densities $\\mathbf{n}$ and $\\mathbf{n}'$ are equal if $\\max(|n_1-n_1'|,|n_2-n_2'|) \\le \\varepsilon_n$ with $\\varepsilon_n = 10^{-10}$.\n\nTest suite:\nFor each test case, you are given $(t,U,\\{\\Delta v_k\\})$. Your program must return one boolean per test case as specified above.\n\n- Test 1 (happy path, clear degeneracy plateau): $t=0.0$, $U=4.0$, $\\{\\Delta v_k\\}=\\{-3,-2,-1,0,1,2,3\\}$.\n- Test 2 (hopping lifts degeneracy): $t=0.5$, $U=4.0$, $\\{\\Delta v_k\\}=\\{-3,-2,-1,0,1,2,3\\}$.\n- Test 3 (smaller interaction, narrower plateau): $t=0.0$, $U=2.0$, $\\{\\Delta v_k\\}=\\{-3,-1,0,1,3\\}$.\n- Test 4 (boundary and far-from-plateau edge cases): $t=0.0$, $U=4.0$, $\\{\\Delta v_k\\}=\\{-5,-4,4,5\\}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of Python boolean literals enclosed in square brackets, in the same order as the test cases, for example, \"[True,False,True,False]\".",
            "solution": "The problem requires an algorithmic investigation into a potential breakdown of the uniqueness aspect of the first Hohenberg-Kohn theorem for a system with a degenerate ground state. We will model a two-site, two-electron Hubbard dimer, construct its Hamiltonian matrix, find its ground states via exact diagonalization, and compute the ensemble-averaged ground-state density.\n\nThe analysis is performed in the $N=2$ electron sector of the Fock space built from four spin-orbitals, which we label as $\\{ (1,\\uparrow), (1,\\downarrow), (2,\\uparrow), (2,\\downarrow) \\}$. A basis for this sector can be formed by choosing two distinct spin-orbitals out of the four available. The dimension of this Hilbert space is $\\binom{4}{2} = 6$. A convenient and orthonormal basis, often called the occupation number basis, consists of the following states (Slater determinants), where each state specifies which spin-orbitals are occupied:\n\\begin{itemize}\n    \\item $|\\phi_1\\rangle = \\hat{c}^{\\dagger}_{1\\uparrow}\\hat{c}^{\\dagger}_{1\\downarrow}|0\\rangle$: Site $1$ is doubly occupied.\n    \\item $|\\phi_2\\rangle = \\hat{c}^{\\dagger}_{2\\uparrow}\\hat{c}^{\\dagger}_{2\\downarrow}|0\\rangle$: Site $2$ is doubly occupied.\n    \\item $|\\phi_3\\rangle = \\hat{c}^{\\dagger}_{1\\uparrow}\\hat{c}^{\\dagger}_{2\\uparrow}|0\\rangle$: Electrons on sites $1, 2$ with spin up.\n    \\item $|\\phi_4\\rangle = \\hat{c}^{\\dagger}_{1\\uparrow}\\hat{c}^{\\dagger}_{2\\downarrow}|0\\rangle$: Electrons on sites $1, 2$ with opposite spins.\n    \\item $|\\phi_5\\rangle = \\hat{c}^{\\dagger}_{1\\downarrow}\\hat{c}^{\\dagger}_{2\\uparrow}|0\\rangle$: Electrons on sites $1, 2$ with opposite spins.\n    \\item $|\\phi_6\\rangle = \\hat{c}^{\\dagger}_{1\\downarrow}\\hat{c}^{\\dagger}_{2\\downarrow}|0\\rangle$: Electrons on sites $1, 2$ with spin down.\n\\end{itemize}\nThese six states form our basis, and we can represent them as standard basis vectors in $\\mathbb{C}^6$, e.g., $|\\phi_1\\rangle \\to (1,0,0,0,0,0)^T$.\n\nThe Hamiltonian of the system is given by:\n$$\n\\hat{H} = \\hat{H}_t + \\hat{H}_U + \\hat{H}_v\n$$\nwhere\n$$\n\\hat{H}_t = -t \\sum_{\\sigma \\in \\{\\uparrow,\\downarrow\\}} \\left(\\hat{c}^{\\dagger}_{1\\sigma}\\hat{c}_{2\\sigma} + \\hat{c}^{\\dagger}_{2\\sigma}\\hat{c}_{1\\sigma}\\right) \\quad (\\text{Hopping})\n$$\n$$\n\\hat{H}_U = U \\sum_{i \\in \\{1,2\\}} \\hat{n}_{i\\uparrow}\\hat{n}_{i\\downarrow} \\quad (\\text{On-site Interaction})\n$$\n$$\n\\hat{H}_v = v_1 \\sum_{\\sigma}\\hat{n}_{1\\sigma} + v_2 \\sum_{\\sigma}\\hat{n}_{2\\sigma} \\quad (\\text{External Potential})\n$$\nThe external potential is parameterized by $v_1 = \\Delta v/2$ and $v_2 = -\\Delta v/2$.\n\nTo construct the Hamiltonian matrix $H_{ij} = \\langle \\phi_i | \\hat{H} | \\phi_j \\rangle$, we determine the action of each term on the basis states. The operators $\\hat{H}_U$ and $\\hat{H}_v$ are diagonal in this basis, as their constituent number operators $\\hat{n}_{i\\sigma}$ simply count electrons in spin-orbitals. The hopping term $\\hat{H}_t$ is off-diagonal, as it moves electrons between sites.\n\nThe diagonal elements of the Hamiltonian matrix are:\n\\begin{itemize}\n    \\item $H_{11} = \\langle \\phi_1|\\hat{H}|\\phi_1\\rangle = U(1) + v_1(2) + v_2(0) = U + \\Delta v$.\n    \\item $H_{22} = \\langle \\phi_2|\\hat{H}|\\phi_2\\rangle = U(1) + v_1(0) + v_2(2) = U - \\Delta v$.\n    \\item $H_{33} = \\langle \\phi_3|\\hat{H}|\\phi_3\\rangle = U(0) + v_1(1) + v_2(1) = v_1+v_2 = 0$.\n    \\item $H_{44} = \\langle \\phi_4|\\hat{H}|\\phi_4\\rangle = U(0) + v_1(1) + v_2(1) = 0$.\n    \\item $H_{55} = \\langle \\phi_5|\\hat{H}|\\phi_5\\rangle = U(0) + v_1(1) + v_2(1) = 0$.\n    \\item $H_{66} = \\langle \\phi_6|\\hat{H}|\\phi_6\\rangle = U(0) + v_1(1) + v_2(1) = 0$.\n\\end{itemize}\n\nThe off-diagonal elements arise solely from $\\hat{H}_t$. Notice that the total spin projection $\\hat{S}_z$ is conserved by $\\hat{H}$. The basis states $|\\phi_3\\rangle$ ($S_z=1$) and $|\\phi_6\\rangle$ ($S_z=-1$) do not mix with any other states. The hopping term annihilates them, so they are always eigenstates with eigenvalue $0$. The remaining four states, $|\\phi_1\\rangle, |\\phi_2\\rangle, |\\phi_4\\rangle, |\\phi_5\\rangle$, all have $S_z=0$ and form a $4 \\times 4$ block. By carefully applying fermionic anticommutation rules, we find the action of $\\hat{H}_t$:\n\\begin{itemize}\n    \\item $\\hat{H}_t|\\phi_1\\rangle = -t(|\\phi_4\\rangle - |\\phi_5\\rangle)$\n    \\item $\\hat{H}_t|\\phi_2\\rangle = -t(|\\phi_4\\rangle - |\\phi_5\\rangle)$\n    \\item $\\hat{H}_t|\\phi_4\\rangle = -t(|\\phi_1\\rangle + |\\phi_2\\rangle)$\n    \\item $\\hat{H}_t|\\phi_5\\rangle = t(|\\phi_1\\rangle + |\\phi_2\\rangle)$\n\\end{itemize}\nUsing these, the full $6 \\times 6$ Hamiltonian matrix $H$ is constructed.\n\nOnce the Hamiltonian matrix $H$ is assembled for a given set of parameters $(t, U, \\Delta v)$, we perform exact diagonalization using a numerical linear algebra library. This yields the eigenvalues (energies) $\\{E_k\\}$ and corresponding eigenvectors $\\{|\\psi_k\\rangle\\}$.\n\nThe ground-state energy $E_0$ is the minimum eigenvalue, $E_0 = \\min_k E_k$. The ground-state degeneracy, $g$, is the number of eigenvalues equal to $E_0$ within a numerical tolerance $\\varepsilon_E = 10^{-10}$.\n\nThe ensemble ground-state density on site $i \\in \\{1,2\\}$ is given by $n_i = \\frac{1}{g} \\operatorname{Tr}(\\hat{P}_0 \\hat{n}_i)$, where $\\hat{P}_0$ is the projector onto the ground-state subspace, $\\hat{P}_0 = \\sum_{j=1}^{g} |\\psi_{0,j}\\rangle\\langle \\psi_{0,j}|$, and $\\{|\\psi_{0,j}\\rangle\\}$ is an orthonormal basis for the ground-state eigenspace. The total number operator for site $i$ is $\\hat{n}_i = \\sum_{\\sigma} \\hat{n}_{i\\sigma}$. Using the cyclic property of the trace, this simplifies to $n_i = \\frac{1}{g} \\sum_{j=1}^{g} \\langle \\psi_{0,j} |\\hat{n}_i| \\psi_{0,j} \\rangle$. The matrices for the site number operators $\\hat{n}_1$ and $\\hat{n}_2$ are diagonal in our chosen basis:\n$$\n\\hat{n}_1 = \\text{diag}(2, 0, 1, 1, 1, 1), \\quad \\hat{n}_2 = \\text{diag}(0, 2, 1, 1, 1, 1)\n$$\n\nThe overall algorithm for each test case $(t, U, \\{\\Delta v_k\\})$ is as follows:\n1. For each $\\Delta v$ in the provided list $\\{\\Delta v_k\\}$:\n    a. Construct the $6 \\times 6$ Hamiltonian matrix $H$.\n    b. Diagonalize $H$ to find all eigenvalues and eigenvectors.\n    c. Determine the ground-state energy $E_0$, its degeneracy $g$, and the corresponding set of eigenvectors.\n    d. Compute the ensemble ground-state density vector $\\mathbf{n} = (n_1, n_2)$.\n    e. Store the tuple $(\\Delta v, g, \\mathbf{n})$ for later comparison.\n2. After processing all $\\Delta v$ values, iterate through all unique pairs of stored results, $(\\Delta v_i, g_i, \\mathbf{n}_i)$ and $(\\Delta v_j, g_j, \\mathbf{n}_j)$.\n3. If a pair is found such that $g_i  1$, $g_j  1$, and $\\|\\mathbf{n}_i - \\mathbf{n}_j\\|_{\\infty} \\le \\varepsilon_n = 10^{-10}$, then a breakdown of uniqueness is certified, and the result for the test case is `True`.\n4. If no such pair is found after checking all combinations, the result is `False`.\nThis procedure is implemented in the following Python program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases specified.\n    \"\"\"\n\n    test_cases = [\n        # (t, U, list_of_delta_v)\n        (0.0, 4.0, [-3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0]),\n        (0.5, 4.0, [-3.0, -2.0, -1.0, 0.0, 1.0, 2.0, 3.0]),\n        (0.0, 2.0, [-3.0, -1.0, 0.0, 1.0, 3.0]),\n        (0.0, 4.0, [-5.0, -4.0, 4.0, 5.0]),\n    ]\n\n    final_results = []\n    for t, U, delta_v_list in test_cases:\n        final_results.append(process_case(t, U, delta_v_list))\n\n    print(f\"[{','.join(map(str, final_results))}]\")\n\ndef process_case(t, U, delta_v_list):\n    \"\"\"\n    Processes a single test case.\n\n    Args:\n        t (float): Hopping amplitude.\n        U (float): On-site interaction strength.\n        delta_v_list (list of float): List of site energy differences to scan.\n\n    Returns:\n        bool: True if a breakdown is found, False otherwise.\n    \"\"\"\n    energy_tolerance = 1e-10\n    density_tolerance = 1e-10\n\n    # The 6 basis states are ordered as:\n    # 0:|1u,1d, 1:|2u,2d, 2:|1u,2u, 3:|1u,2d, 4:|1d,2u, 5:|1d,2d\n    # where 'u' is up-spin and 'd' is down-spin.\n    n1_op = np.diag([2.0, 0.0, 1.0, 1.0, 1.0, 1.0])\n    n2_op = np.diag([0.0, 2.0, 1.0, 1.0, 1.0, 1.0])\n\n    computed_results = []\n    for delta_v in delta_v_list:\n        v1 = delta_v / 2.0\n        v2 = -delta_v / 2.0\n\n        # Construct the Hamiltonian matrix\n        H = np.zeros((6, 6), dtype=np.float64)\n\n        # Diagonal part (U and v)\n        H[0, 0] = U + 2 * v1\n        H[1, 1] = U + 2 * v2\n        H[2, 2] = v1 + v2\n        H[3, 3] = v1 + v2\n        H[4, 4] = v1 + v2\n        H[5, 5] = v1 + v2\n\n        # Off-diagonal part (hopping term t)\n        if t != 0:\n            # Action of H_t on basis states:\n            # H_t|phi_1 = -t(|phi_4 - |phi_5) = H[3,0]=-t, H[4,0]=t\n            # H_t|phi_2 = -t(|phi_4 - |phi_5) = H[3,1]=-t, H[4,1]=t\n            # H_t|phi_3 = 0\n            # H_t|phi_4 = -t(|phi_1 + |phi_2) = H[0,3]=-t, H[1,3]=-t\n            # H_t|phi_5 =  t(|phi_1 + |phi_2) = H[0,4]=t, H[1,4]=t\n            # H_t|phi_6 = 0\n            \n            # Populate hopping elements based on derived actions, ensuring Hermiticity\n            H[0, 3] = H[3, 0] = -t\n            H[0, 4] = H[4, 0] = t\n            H[1, 3] = H[3, 1] = -t\n            H[1, 4] = H[4, 1] = t\n\n        # Diagonalize the Hamiltonian\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n        \n        # Find ground state energy and degeneracy\n        e_ground = np.min(eigenvalues)\n        ground_state_indices = np.where(np.abs(eigenvalues - e_ground) = energy_tolerance)[0]\n        degeneracy = len(ground_state_indices)\n        \n        # Get ground state eigenvectors\n        gs_vectors = eigenvectors[:, ground_state_indices]\n\n        # Calculate ensemble ground-state density\n        if degeneracy  0:\n            n1 = np.sum([np.vdot(vec, n1_op @ vec) for vec in gs_vectors.T]) / degeneracy\n            n2 = np.sum([np.vdot(vec, n2_op @ vec) for vec in gs_vectors.T]) / degeneracy\n        else:\n            # This case should not happen\n            n1, n2 = np.nan, np.nan\n        \n        computed_results.append({\n            \"delta_v\": delta_v,\n            \"degeneracy\": degeneracy,\n            \"density\": np.array([n1, n2])\n        })\n    \n    # Check for breakdown of uniqueness\n    num_results = len(computed_results)\n    for i in range(num_results):\n        for j in range(i + 1, num_results):\n            res_i = computed_results[i]\n            res_j = computed_results[j]\n\n            # Condition 1: Ground states are degenerate\n            if res_i[\"degeneracy\"] = 1 or res_j[\"degeneracy\"] = 1:\n                continue\n\n            # Condition 2: Densities are equal within tolerance\n            density_diff = np.max(np.abs(res_i[\"density\"] - res_j[\"density\"]))\n            if density_diff  density_tolerance:\n                continue\n            \n            # If both conditions met for distinct delta_v, a breakdown is found.\n            # Distinctness of delta_v is guaranteed by the loop structure.\n            return True\n\n    return False\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Calculating forces on nuclei is essential for predicting molecular geometries, a core task in computational chemical biology. The force is not simply the expectation value of the potential gradient; when using atom-centered basis sets, an additional correction known as the Pulay force arises. This hands-on problem  walks you through the derivation of the complete analytical force, allowing you to distinguish and compute both the Hellmann-Feynman and Pulay contributions in a model system.",
            "id": "3842529",
            "problem": "Consider the force on nucleus $A$ along the internuclear axis in a two-center one-electron model that serves as a minimal illustrative fragment relevant to computational chemical biology (for example, a small ligand bound to a proton-like site), treated within Kohn–Sham Density Functional Theory (DFT) under the Born–Oppenheimer approximation. The electronic structure is represented in a finite Gaussian-Type Orbital (GTO) basis $\\{\\phi_{A},\\phi_{B}\\}$ that depends parametrically on the nuclear positions, so the basis overlap matrix $S$ and Hamiltonian matrix $H$ depend on the nuclear coordinate $R_{A}$. The occupied Kohn–Sham orbital is expanded as $\\psi = c_{A} \\phi_{A} + c_{B} \\phi_{B}$ with column coefficient vector $c = \\begin{pmatrix} c_{A} \\\\ c_{B} \\end{pmatrix}$ constrained by the generalized normalization $c^{\\top} S c = 1$. The total energy for this one-electron pure-external-potential case is $E_{\\text{tot}}(R_{A}) = \\varepsilon(R_{A}) + E_{\\text{nn}}(R)$, where $\\varepsilon$ is the occupied Kohn–Sham eigenvalue, $E_{\\text{nn}}(R)=Z_{A} Z_{B}/R$ is the Coulomb repulsion between nuclei with charges $Z_{A}$ and $Z_{B}$, and $R = |R_{A}-R_{B}|$.\n\nStarting from first principles—namely, the variational stationarity of the Kohn–Sham energy with respect to orbital coefficients under the normalization constraint and the definition of the force as the negative gradient of the energy with respect to nuclear coordinates—derive the expression for the total force on nucleus $A$ along the internuclear axis that combines the explicit derivative of the electronic Hamiltonian (Hellmann–Feynman contribution), the term arising from the parametric dependence of the basis (Pulay contribution), and the nucleus–nucleus contribution. Then evaluate the numerical value of this force using the data below. Finally, assess the additive error in the force introduced by incomplete Self-Consistent Field (SCF) convergence by quantifying the correction incurred when, in the generalized eigenproblem constraint, the Lagrange multiplier $\\lambda$ differs from the converged eigenvalue $\\varepsilon$.\n\nAll quantities are given in atomic units. Use the following data at the geometry of interest:\n- Nuclear charges: $Z_{A} = 1$, $Z_{B} = 1$.\n- Internuclear separation: $R = 1.4$.\n- Basis overlap matrix $S$ is symmetric with elements $S_{AA} = 1$, $S_{BB} = 1$, and $S_{AB} = S_{BA} = s$, with $s = 0.4$. Its derivative with respect to $R_{A}$ is nonzero only for the off-diagonal elements: $\\frac{\\partial S_{AB}}{\\partial R_{A}} = \\frac{\\partial S_{BA}}{\\partial R_{A}} = ds$, with $ds = -0.25$; $\\frac{\\partial S_{AA}}{\\partial R_{A}} = \\frac{\\partial S_{BB}}{\\partial R_{A}} = 0$.\n- The derivative of the electronic Hamiltonian matrix with respect to $R_{A}$ has elements $\\frac{\\partial H_{AA}}{\\partial R_{A}} = -0.30$, $\\frac{\\partial H_{AB}}{\\partial R_{A}} = -0.10$, and $\\frac{\\partial H_{BB}}{\\partial R_{A}} = -0.02$.\n- The occupied orbital coefficients are $c_{A} = 0.8$, $c_{B} = 0.36$, and satisfy $c^{\\top} S c = 1$ at the given geometry.\n- The occupied Kohn–Sham eigenvalue is $\\varepsilon = -0.6$.\n- The Lagrange multiplier associated with the generalized normalization constraint at the last SCF micro-iteration (not fully converged) is $\\lambda = -0.58$.\n\nCompute:\n1. The total force $F_{\\text{tot}}$ on nucleus $A$ combining the electronic Hellmann–Feynman and Pulay terms with the nucleus–nucleus contribution.\n2. The additive SCF-incompleteness correction $\\delta F_{\\text{SCF}}$ to the force that arises solely from using $\\lambda$ instead of $\\varepsilon$ in the Pulay-type term.\n\nExpress the final answer as a row vector $\\begin{pmatrix} F_{\\text{tot}}  \\delta F_{\\text{SCF}} \\end{pmatrix}$ in Hartree per Bohr, rounded to four significant figures. Do not include units in the final boxed answer.",
            "solution": "The problem is found to be scientifically grounded, well-posed, objective, and self-contained. It is a valid problem of computational chemistry, dealing with the fundamental concepts of forces in quantum mechanical calculations.\n\nThe total force on nucleus $A$, $F_{\\text{tot}}$, is the negative gradient of the total energy $E_{\\text{tot}}$ with respect to the nuclear coordinate $R_{A}$. As the problem is defined along the internuclear axis, this is a one-dimensional derivative:\n$$F_{\\text{tot}} = -\\frac{d E_{\\text{tot}}}{d R_{A}}$$\nThe total energy is given by $E_{\\text{tot}}(R_{A}) = \\varepsilon(R_{A}) + E_{\\text{nn}}(R)$, where $\\varepsilon$ is the occupied Kohn-Sham eigenvalue and $E_{\\text{nn}}(R)$ is the nuclear-nuclear repulsion energy. The force is therefore the sum of the electronic force and the nuclear-nuclear force:\n$$F_{\\text{tot}} = -\\frac{d\\varepsilon}{dR_{A}} - \\frac{dE_{\\text{nn}}}{dR_{A}}$$\n\nLet's analyze each term.\n\nFirst, the nuclear-nuclear repulsion term. The energy is $E_{\\text{nn}}(R) = \\frac{Z_{A} Z_{B}}{R}$. Assuming nucleus $B$ is at the origin and nucleus $A$ is at a distance $R$ along the axis, we have $R_{A} = R$. The derivative is:\n$$\\frac{dE_{\\text{nn}}}{dR_{A}} = \\frac{d}{dR}\\left(\\frac{Z_{A} Z_{B}}{R}\\right) = -\\frac{Z_{A} Z_{B}}{R^2}$$\nThe corresponding force contribution is $F_{\\text{nn}} = - \\frac{dE_{\\text{nn}}}{dR_{A}} = \\frac{Z_{A} Z_{B}}{R^2}$.\n\nSecond, the electronic term, which depends on the derivative of the Kohn-Sham eigenvalue $\\varepsilon$. The eigenvalue is obtained from the generalized eigenvalue equation $H c = \\varepsilon S c$. It can be expressed as a Rayleigh quotient:\n$$\\varepsilon = \\frac{c^{\\top} H c}{c^{\\top} S c}$$\nSince the orbital is normalized, $c^{\\top} S c = 1$, which simplifies the expression to $\\varepsilon = c^{\\top} H c$. To find the derivative of $\\varepsilon$ with respect to $R_A$, we apply the chain rule, acknowledging that $c$, $H$, and $S$ all depend on $R_A$:\n$$\\frac{d\\varepsilon}{dR_{A}} = \\frac{d}{dR_{A}}(c^{\\top} H c) = \\frac{dc^{\\top}}{dR_{A}} H c + c^{\\top} \\frac{dH}{dR_{A}} c + c^{\\top} H \\frac{dc}{dR_{A}}$$\nThe coefficients $c$ are determined variationally by minimizing the energy, which at convergence leads to the Kohn-Sham equations $H c = \\varepsilon S c$. Since $H$ and $S$ are symmetric matrices, the transpose relation $c^{\\top} H = \\varepsilon c^{\\top} S$ also holds. Substituting this into the derivative expression:\n$$\\frac{d\\varepsilon}{dR_{A}} = \\frac{dc^{\\top}}{dR_{A}} (\\varepsilon S c) + c^{\\top} \\frac{dH}{dR_{A}} c + (\\varepsilon c^{\\top} S) \\frac{dc}{dR_{A}}$$\n$$\\frac{d\\varepsilon}{dR_{A}} = c^{\\top} \\frac{dH}{dR_{A}} c + \\varepsilon \\left( \\frac{dc^{\\top}}{dR_{A}} S c + c^{\\top} S \\frac{dc}{dR_{A}} \\right)$$\nThe term in the parenthesis can be found by differentiating the normalization condition $c^{\\top} S c = 1$:\n$$\\frac{d}{dR_{A}}(c^{\\top} S c) = \\frac{dc^{\\top}}{dR_{A}} S c + c^{\\top} \\frac{dS}{dR_{A}} c + c^{\\top} S \\frac{dc}{dR_{A}} = \\frac{d(1)}{dR_{A}} = 0$$\nRearranging gives:\n$$\\frac{dc^{\\top}}{dR_{A}} S c + c^{\\top} S \\frac{dc}{dR_{A}} = -c^{\\top} \\frac{dS}{dR_{A}} c$$\nSubstituting this back into the expression for $\\frac{d\\varepsilon}{dR_A}$:\n$$\\frac{d\\varepsilon}{dR_{A}} = c^{\\top} \\frac{dH}{dR_{A}} c - \\varepsilon \\left( c^{\\top} \\frac{dS}{dR_{A}} c \\right)$$\nThe total force on nucleus $A$ is then:\n$$F_{\\text{tot}} = -\\frac{d\\varepsilon}{dR_{A}} + F_{\\text{nn}} = - \\left( c^{\\top} \\frac{dH}{dR_{A}} c - \\varepsilon c^{\\top} \\frac{dS}{dR_{A}} c \\right) + \\frac{Z_{A} Z_{B}}{R^2}$$\n$$F_{\\text{tot}} = \\underbrace{-c^{\\top} \\frac{dH}{dR_{A}} c}_{\\text{Hellmann-Feynman force}} + \\underbrace{\\varepsilon c^{\\top} \\frac{dS}{dR_{A}} c}_{\\text{Pulay force}} + \\underbrace{\\frac{Z_{A} Z_{B}}{R^2}}_{\\text{Nuclear force}}$$\n\nNow, we compute the numerical value of $F_{\\text{tot}}$ using the provided data in atomic units.\nThe data is: $Z_{A} = 1$, $Z_{B} = 1$, $R = 1.4$.\n$c = \\begin{pmatrix} 0.8 \\\\ 0.36 \\end{pmatrix}$, $\\varepsilon = -0.6$.\nThe derivative matrices are:\n$\\frac{dH}{dR_{A}} = \\begin{pmatrix} -0.30  -0.10 \\\\ -0.10  -0.02 \\end{pmatrix}$, $\\frac{dS}{dR_{A}} = \\begin{pmatrix} 0  -0.25 \\\\ -0.25  0 \\end{pmatrix}$.\n\n1.  Nuclear force:\n    $F_{\\text{nn}} = \\frac{1 \\times 1}{(1.4)^2} = \\frac{1}{1.96} \\approx 0.510204$ a.u.\n\n2.  Hellmann-Feynman term: $-c^{\\top} \\frac{dH}{dR_{A}} c$\n    $c^{\\top} \\frac{dH}{dR_{A}} c = \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} -0.30  -0.10 \\\\ -0.10  -0.02 \\end{pmatrix} \\begin{pmatrix} 0.8 \\\\ 0.36 \\end{pmatrix}$\n    $= \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} (-0.30)(0.8) + (-0.10)(0.36) \\\\ (-0.10)(0.8) + (-0.02)(0.36) \\end{pmatrix}$\n    $= \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} -0.24 - 0.036 \\\\ -0.08 - 0.0072 \\end{pmatrix} = \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} -0.276 \\\\ -0.0872 \\end{pmatrix}$\n    $= (0.8)(-0.276) + (0.36)(-0.0872) = -0.2208 - 0.031392 = -0.252192$\n    The Hellmann-Feynman force is $-(-0.252192) = 0.252192$ a.u.\n\n3.  Pulay term: $\\varepsilon c^{\\top} \\frac{dS}{dR_{A}} c$\n    $c^{\\top} \\frac{dS}{dR_{A}} c = \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} 0  -0.25 \\\\ -0.25  0 \\end{pmatrix} \\begin{pmatrix} 0.8 \\\\ 0.36 \\end{pmatrix}$\n    $= \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} (0)(0.8) + (-0.25)(0.36) \\\\ (-0.25)(0.8) + (0)(0.36) \\end{pmatrix} = \\begin{pmatrix} 0.8  0.36 \\end{pmatrix} \\begin{pmatrix} -0.09 \\\\ -0.20 \\end{pmatrix}$\n    $= (0.8)(-0.09) + (0.36)(-0.20) = -0.072 - 0.072 = -0.144$\n    The Pulay force is $\\varepsilon(-0.144) = (-0.6)(-0.144) = 0.0864$ a.u.\n\nTotal force:\n$F_{\\text{tot}} = 0.252192 + 0.0864 + 0.510204 = 0.848796$ a.u.\nRounding to four significant figures, $F_{\\text{tot}} = 0.8488$ a.u.\n\nNext, we evaluate the additive SCF-incompleteness correction, $\\delta F_{\\text{SCF}}$. This correction arises because the Self-Consistent Field (SCF) procedure is not fully converged, meaning the Lagrange multiplier $\\lambda$ from the variational procedure is not equal to the final eigenvalue $\\varepsilon$. The variational condition that holds at the last iteration is $Hc = \\lambda Sc$, not $Hc = \\varepsilon Sc$.\nThe force expression derived under this unconverged condition, $F_{\\text{unconv}}$, uses $\\lambda$ in place of $\\varepsilon$ in the Pulay term:\n$$F_{\\text{unconv}} = -c^{\\top} \\frac{dH}{dR_{A}} c + \\lambda c^{\\top} \\frac{dS}{dR_{A}} c + \\frac{Z_{A} Z_{B}}{R^2}$$\nThe converged force, $F_{\\text{conv}}$, is the one we calculated previously, which we now denote $F_{\\text{tot}}$ for clarity.\n$$F_{\\text{conv}} = -c^{\\top} \\frac{dH}{dR_{A}} c + \\varepsilon c^{\\top} \\frac{dS}{dR_{A}} c + \\frac{Z_{A} Z_{B}}{R^2}$$\nThe additive correction $\\delta F_{\\text{SCF}}$ is the difference between the force calculated with the unconverged Lagrange multiplier and the force calculated with the true eigenvalue:\n$$\\delta F_{\\text{SCF}} = F_{\\text{unconv}} - F_{\\text{conv}}$$\n$$\\delta F_{\\text{SCF}} = \\left( -c^{\\top} \\frac{dH}{dR_{A}} c + \\lambda c^{\\top} \\frac{dS}{dR_{A}} c + F_{\\text{nn}} \\right) - \\left( -c^{\\top} \\frac{dH}{dR_{A}} c + \\varepsilon c^{\\top} \\frac{dS}{dR_{A}} c + F_{\\text{nn}} \\right)$$\n$$\\delta F_{\\text{SCF}} = (\\lambda - \\varepsilon) c^{\\top} \\frac{dS}{dR_{A}} c$$\nUsing the provided data: $\\lambda = -0.58$, $\\varepsilon = -0.6$, and the previously computed value $c^{\\top} \\frac{dS}{dR_{A}} c = -0.144$.\n$$\\delta F_{\\text{SCF}} = ((-0.58) - (-0.6)) \\times (-0.144) = (0.02) \\times (-0.144) = -0.00288$$\nRounding to four significant figures, $\\delta F_{\\text{SCF}} = -0.002880$ a.u.\n\nThe required values are $F_{\\text{tot}} \\approx 0.8488$ and $\\delta F_{\\text{SCF}} = -0.002880$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8488  -0.002880\n\\end{pmatrix}\n}\n$$"
        }
    ]
}