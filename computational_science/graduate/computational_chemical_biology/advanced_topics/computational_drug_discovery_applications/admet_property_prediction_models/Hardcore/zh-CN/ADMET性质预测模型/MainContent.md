## 引言
在药物研发的漫长而昂贵的旅程中，一个候选分子的成功不仅取决于其对靶点的效力，更取决于其在人体内的吸收、分布、代谢、[排泄](@entry_id:138819)和毒性（ADMET）特性。大量有希望的化合物因不良的[药代动力学](@entry_id:136480)或未预见的毒性而在临床前或临床阶段失败，造成了巨大的资源浪费。因此，在[药物发现](@entry_id:261243)的早期阶段准确预测并优化ADMET性质，已成为提高研发效率、降低失败风险的关键策略。计算[ADMET预测模型](@entry_id:1120826)应运而生，它利用计算机模拟和机器学习技术，在化合物尚未合成之前就对其体内行为进行评估，从而指导[药物化学](@entry_id:178806)家设计出更安全的候选药物。

本文旨在系统性地介绍ADMET性质预测模型的理论基础、构建方法及其在现代药物发现中的核心应用。我们将深入探讨这些模型背后的科学原理，揭示它们如何将抽象的[分子结构](@entry_id:140109)与复杂的生物学过程联系起来。读者将了解到当前最前沿的建模技术，以及如何将这些预测工具整合到实际的[药物发现](@entry_id:261243)工作流程中，以做出更明智的决策。

本文章将分为三个核心章节。第一章**“原理与机制”**将深入探讨构建ADMET模型所依据的科学基础，包括区分不同类型的ADMET终点、机理与经验建模的哲学、ADME各环节的关键物理化学过程，以及现代分[子表示](@entry_id:141094)和[概率建模](@entry_id:168598)方法。第二章**“应用与交叉学科联系”**将展示这些模型在[药物发现](@entry_id:261243)流程中的实际效用，如何用于指导[先导化合物优化](@entry_id:911789)、进行系统级的PBPK模拟，以及它们与药理基因组学、可解释AI等前沿领域的交叉融合。最后，第三章**“动手实践”**将通过一系列具体的计算问题，帮助读者将理论知识应用于解决实际的[药代动力学参数](@entry_id:917544)计算和模型适用性评估。

## 原理与机制

在[药物发现与开发](@entry_id:912192)中，准确预测候选分子的吸收、分布、代谢、[排泄](@entry_id:138819)和毒性（ADMET）特性是至关重要的。本章旨在深入阐述构建这些预测模型所依据的核心科学原理与机制。我们将从一个形式化的框架出发，区分分子的内源性属性与依赖于生物学背景的结局，然后探讨两种主要的建模哲学——机理模型与经验模型。随后，我们将详细剖析 ADME 各个环节的关键[物理化学](@entry_id:145220)与生理学过程，并讨论如何将这些过程的复杂性提炼为可用于建模的参数。最后，我们将转向现代建模实践，探讨如何表示分子结构以及为何必须采用概率论方法来处理实验数据中固有的不确定性。

### ADMET 预测的基本框架

从计算的角度看，ADMET 预测的根本任务是建立一个从分子结构及其所处环境到一组[药代动力学](@entry_id:136480)和毒性终点的映射。我们可以将此过程形式化地表达为一个函数 $F$ 。设[分子结构](@entry_id:140109)由变量 $S$ 表示，其取值于一个标记分子图空间 $\mathcal{M}$。同时，设一个背景向量 $C$ 在空间 $\mathcal{C}$ 中取值，该向量编码了生物体（如物种）、组织、[给药途径](@entry_id:926413)、剂型、剂量、合并用药、生理状态以及体外实验条件等信息。那么，预测的终点 $Y$ 是一个在空间 $\mathcal{Y}$ 中取值的向量。因此，ADMET 模型旨在学习一个函数：

$$ F: \mathcal{M} \times \mathcal{C} \to \mathcal{Y} $$

在这个框架下，区分两类性质至关重要。如果一个终点 $Y_k$ 的值仅由分子结构 $S$ 决定，而与任何背景 $C$ 无关，我们称之为**内源性属性（intrinsic property）**。形式上，对于任何结构 $s \in \mathcal{M}$ 和任意两个背景 $c, c' \in \mathcal{C}$，都有 $Y_k(s, c) = Y_k(s, c')$。在概率论的语言中，这等价于[条件独立性](@entry_id:262650) $Y_k \perp\!\!\!\perp C \mid S$。这类属性是分子固有不变的特征，例如，仅从[分子连接性](@entry_id:182740)即可计算出的**分子量**或**拓扑[极性表面](@entry_id:753555)积（Topological Polar Surface Area, T[PSA](@entry_id:912720)）**。

与此相对，如果一个终点的值在[分子结构](@entry_id:140109) $S$ 固定的情况下，仍然会随着背景 $C$ 的变化而改变，我们称之为**背景依赖性结局（context-dependent outcome）**。形式上，这意味着 $Y_k \not\perp\!\!\!\perp C \mid S$。绝大多数具有生理学意义的 ADMET 终点都属于此类。例如，**[血浆蛋白](@entry_id:149188)非结合分数（fraction unbound in plasma, $f_u$）**不仅取决于药物与[血浆蛋白](@entry_id:149188)（如白蛋白）的亲和力（与 $S$ 相关），还取决于血浆中这些蛋白的浓度（$C$ 的一部分，因物种、疾病状态而异）。同样，**[全身清除率](@entry_id:910948)（systemic clearance, $CL$）**、**全身暴露量（systemic exposure, AUC）**以及由 hERG 通道阻断介导的**临床致[尖端扭转型室性心动过速](@entry_id:904824)风险（torsadogenic risk）**等，都深刻地依赖于剂量、[给药途径](@entry_id:926413)、物种生理以及患者个体差异等背景因素 。混淆这两类属性是建模中的一个常见错误，一个成功的 ADMET 模型必须清晰地界定其预测目标是分子的内源性属性还是特定背景下的复杂结局。

### 建模哲学：机理模型与经验模型

为了学习上述映射关系，计算化学与[药理学](@entry_id:142411)领域发展出两种主要的建模哲学：基于[物理化学](@entry_id:145220)第一性原理的机理模型，以及基于数据统计规律的经验模型，后者在当代最常见的形式是**[定量构效关系](@entry_id:1130377)（Quantitative Structure-Activity Relationship, QSAR）**模型 。

**机理[药代动力学](@entry_id:136480)（Mechanistic Pharmacokinetic, PK）模型**，特别是[生理药代动力学](@entry_id:922323)（PBPK）模型，其基础是[质量守恒定律](@entry_id:147377)与输运现象。这类模型将生物体描绘为一个由多个生理学相关的隔室（如器官、组织）组成的系统。在一个充分混合的隔室中，药物浓度的变化遵循质量平衡方程，其通用形式可写作一个[常微分方程](@entry_id:147024)（ODE）：

$$ \frac{d}{dt}\big(V \cdot C(t)\big) = \text{流入速率}(t) - \text{流出速率}(t) - \text{代谢速率}(t) $$

其中 $V$ 是隔室体积，$C(t)$ 是随时间变化的药物浓度。在药物浓度远低于代谢[酶饱和](@entry_id:263091)浓度的[线性动力学](@entry_id:177848)假设下，该方程可简化为：

$$ \frac{dC(t)}{dt} = \frac{1}{V}\cdot\text{流入速率}(t) - \frac{CL}{V}\cdot C(t) $$

其中 $CL$ 是清除率。通过构建一个由这类 ODE 组成的系统，机理模型能够模拟药物在体内的完整浓度-时间曲线 $C(t)$。诸如最大浓度（$C_{\max}$）或[曲线下面积](@entry_id:169174)（[AUC](@entry_id:1121102)）等药代动力学终点，是从模拟出的 $C(t)$ 曲线中推导出的泛函。这些模型的参数，如器官血流量 $Q$、隔室体积 $V$、[酶动力学](@entry_id:145769)常数等，都具有明确的生理学或生物化学意义。其核心优势在于强大的外推能力，能够预测新剂量、新[给药途径](@entry_id:926413)乃至不同物种中的药物行为，因为模型编码了底层的因果动力学过程 。

**[定量构效关系](@entry_id:1130377)（QSAR）模型**则采用一种截然不同的、更偏向[统计学习](@entry_id:269475)的思路。它首先将[分子结构](@entry_id:140109) $S$ 编码为一个数值向量，称为**描述符（descriptors）**，记为 $\mathbf{x} \in \mathbb{R}^d$。这些描述符可以是从分[子图](@entry_id:273342)计算的拓扑指数、物理化学属性（如 LogP）或量子[化学计算](@entry_id:155220)得到的能量。QSAR 模型直接学习一个从描述符空间到特定终点 $y$（如溶解度、IC50值或是否具有毒性）的映射函数 $g: \mathbb{R}^d \to \mathbb{R}$ 或 $g: \mathbb{R}^d \to \{0,1\}$。这个函数 $g$ 的形式可以是线性回归、[随机森林](@entry_id:146665)或深度神经网络，其参数通过在观测数据集 $\{(\mathbf{x}_i, y_i)\}$ 上最小化某个[损失函数](@entry_id:634569)来学习得到。QSAR 的本质是一个经验性的、关联性的模型。它不直接模拟时间演化过程或内部器官的动态，而是捕捉分子特征与某个特定、静态终点之间的相关性 。

简而言之，机理模型通过模拟过程来推导终点，而 QSAR 模型直接从结构特征预测终点。在实践中，两者常常结合使用：例如，用 QSAR 模型预测机理模型所需的内源性参数（如酶清除率或[膜通透性](@entry_id:137893)），然后将这些参数输入 PBPK 模型进行全身动态模拟。

### ADME 过程的机理基础

无论是构建复杂的 PBPK 模型，还是为 QSAR 模型寻找具有因果意义的描述符，都离不开对 ADME 各个环节 underlying 机理的深刻理解。

#### 吸收（Absorption）

口服药物的吸收主要取决于其在胃肠道中的溶解和跨越[肠上皮](@entry_id:895582)[细胞膜](@entry_id:146704)的通透能力。这两个因素共同构成了一个复杂的**[溶解度](@entry_id:147610)-通透性权衡（solubility-permeability tradeoff）**。

**有效通透性（Effective Permeability, $P_{\text{eff}}$）**是衡量药物穿膜速率的核心参数。在单向肠道灌流等实验中，通过测量药物在流经一段长度为 $L$、半径为 $R$ 的肠段时浓度的变化，可以计算出 $P_{\text{eff}}$。基于质量守恒的[稳态模型](@entry_id:157508)，可以推导出其计算公式 ：

$$ P_{\mathrm{eff}} = \frac{Q}{2 \pi R L} \ln\left(\frac{C_{\mathrm{in}}}{C_{\mathrm{out}}}\right) $$

其中 $Q$ 是灌流液的流速，$C_{in}$ 和 $C_{out}$ 分别是入口和出口的药物浓度。这个公式的推导假设药物浓度沿肠段呈指数衰减。

药物跨膜的微观过程包括多种机制：
1.  **[被动扩散](@entry_id:925273)（Passive Diffusion）**：亲脂性小分子直接溶解于[细胞膜](@entry_id:146704)的脂质双分子层并穿过的过程。其通量（flux）遵循菲克定律，与浓度梯度成正比，不会饱和。
2.  **载体介导的摄取（Carrier-mediated Uptake）**：药物与膜上的摄取[转运蛋白](@entry_id:176617)结合，被转运入细胞。此过程类似于酶-底物反应，遵循 [Michaelis-Menten](@entry_id:145978) 动力学，表现出饱和性和[竞争性抑制](@entry_id:142204)的特征。
3.  **主动外排（Active Efflux）**：药物进入细胞后，被 [P-糖蛋白](@entry_id:169028)（P-gp）等外排[转运蛋白](@entry_id:176617)主动泵出细胞，回到肠腔。这是一个消耗 ATP 的逆浓度梯度过程，同样具有饱和性和方向性。强大的[外排作用](@entry_id:141864)会显著降低药物的净吸收，从而减小表观的 $P_{\text{eff}}$。

这些机理为我们理解药物的结构特征如何影响吸收提供了物理化学基础。著名的**里宾斯基五规则（Lipinski's rule-of-five）**虽然是经验总结，但其背后有深刻的[物理化学](@entry_id:145220)原理 。例如：
*   **分子量（$M \lesssim 500 \text{ Da}$）**：根据 Stokes-Einstein 关系，分子在介质中的扩散系数 $D$ 与其 hydrodynamic 半径 $R$ 成反比（$D \propto R^{-1}$），而半径约与分子量的立方根成正比（$R \propto M^{1/3}$）。因此，分子量越大，扩散越慢，通透性越低。
*   **亲脂性（$\log P_{\text{o/w}} \lesssim 5$）**：药物的膜-水分配系数 $K_{\text{mw}}$ 与其油水[分配系数](@entry_id:177413) $P_{\text{o/w}}$ 近似成正比。通透性 $P$ 也与 $K_{\text{mw}}$ 正相关。然而，过高的亲脂性会导致药物在水相中的[溶解度](@entry_id:147610) $S$ 急剧下降。由于吸收通量正比于 $P \times S$（在溶解度受限的情况下），存在一个最佳的 $\log P_{\text{o/w}}$ 值，过高或过低都会损害总吸收通量。上限为 5 是为了避免因溶解度过低而导致的“brick dust”问题。
*   **氢键[供体与受体](@entry_id:137311)（$N_{HBD} \lesssim 5, N_{HBA} \lesssim 10$）**：药物穿过疏水性的[细胞膜](@entry_id:146704)核心时，必须脱去其周围的[水合壳](@entry_id:269646)层。每个[氢键](@entry_id:136659)基团的去溶剂化都需要付出能量代价，构成一个能垒 $\Delta G^{\ddagger}$。过多的[氢键供体和受体](@entry_id:193635)会使这个能垒过高，导致穿膜过程的动力学极其缓慢。因此，[对氢](@entry_id:753096)键基[团数](@entry_id:272714)量的限制本质上是为了控制去[溶剂化能](@entry_id:178842)垒，保证足够的被动通透速率。

#### 分布（Distribution）

药物被吸收进入[血液循环](@entry_id:147237)后，会分布到全身的组织和器官中。药物在不同组织中的蓄积程度由**组织-血浆分配系数（Tissue-Plasma Partition Coefficient, $K_p$）**来量化，定义为[稳态](@entry_id:139253)时组织中总药物浓度 $C_t$与血浆中总药物浓度 $C_p$ 之比，$K_p = C_t / C_p$。

$K_p$ 的值由两个主要机理共同决定：**离子捕获（ion trapping）**和**与组织及血浆成分的结合（binding）**。基于“自由药物假说”（即只有未结合的非离子型药物能够自由穿透[细胞膜](@entry_id:146704)），我们可以推导出一个机理性的 $K_p$ 方程 。对于一个[弱碱](@entry_id:143319)性药物，其 $K_p$ 表达式为：

$$ K_p = \frac{1 + 10^{(pK_a - pH_t)} + \beta_t}{1 + 10^{(pK_a - pH_p)} + \beta_p} $$

其中，$pK_a$ 是药物的[酸解离常数](@entry_id:140898)，$pH_t$ 和 $pH_p$ 分别是组织细胞内和血浆的 pH 值，$\beta_t$ 和 $\beta_p$ 是描述药物与组织和血浆中大分子（如蛋白质和脂质）结合强度的线性结合系数。

这个方程揭示了几个重要原理 ：
*   **离子捕获**：对于[弱碱](@entry_id:143319)（$pK_a > 7$），当它们进入比血浆更酸性的组织细胞内部时（例如，多数细胞内 $pH \approx 7.0-7.2$，而血浆 $pH_p \approx 7.4$），它们会更多地被质子化形成带电离子。由于带电离子不易穿透[细胞膜](@entry_id:146704)，它们被“捕获”在细胞内，导致该组织的总药物浓度升高，$K_p$ 值增大。对于[弱酸](@entry_id:140358)性药物，情况正好相反，它们倾向于在更碱性的环境中（$pH > pK_a$）被捕获。
*   **蛋白结合**：药物与[血浆蛋白](@entry_id:149188)的强结合（即大的 $\beta_p$）会增加分母，从而降低药物向所有组织的 $K_p$ 值，使药物更多地滞留在[血液循环](@entry_id:147237)中。这会减小药物的**[稳态分布容积](@entry_id:912353)（steady-state volume of distribution, $V_{ss}$）**。反之，与组织成分的强结合（大的 $\beta_t$）会增加特定组织的 $K_p$ 值。

#### 代谢（Metabolism）与[排泄](@entry_id:138819)（Excretion）

**代谢**主要是指药物在酶（特别是肝脏中的[细胞色素](@entry_id:156723) P450 酶系）催化下发生的化学转化，通常使其更具极性以便于[排泄](@entry_id:138819)。评估[药物代谢](@entry_id:151432)速率的一个关键体外实验是**[代谢稳定性](@entry_id:907463)（metabolic stability）**测定。在该实验中，药物与肝微粒体（富含代谢酶的亚细胞组分）一同孵育。在[底物浓度](@entry_id:143093)远低于[米氏常数](@entry_id:265734) $K_M$ 的条件下，母体药物的浓度随时间呈[一级动力学](@entry_id:183701)衰减，$C(t) = C_0 \exp(-k_{\text{dep}}t)$。从这个衰减过程中可以得到两个关键的动力学参数 ：
*   **[半衰期](@entry_id:144843)（half-life, $t_{1/2}$）**：$t_{1/2} = (\ln 2) / k_{\text{dep}}$。
*   **内源性清除率（intrinsic clearance, $CL_{int}$）**：$CL_{int}$ 是指单位质量的酶在不受血流等生理因素限制下的最大代谢能力，其值与衰减[速率常数](@entry_id:140362) $k_{\text{dep}}$ 成正比。

**[排泄](@entry_id:138819)**是指将药物及其代谢物从体内清除出去的过程，主要通过肾脏（尿液）和肝脏（胆汁）进行。**肾脏清除率（renal clearance, $CL_r$）**是描述肾脏排泄效率的参数，它由三个基本过程的净效应决定：[肾小球滤过](@entry_id:151362)、肾小管主动分泌和[肾小管重吸收](@entry_id:152030)。其总和可以表示为 ：

$$ CL_r = f_{u,p} \cdot GFR + CL_{sec} - CL_{reabs} $$

这里的各项代表：
1.  **[肾小球滤过](@entry_id:151362)（Glomerular Filtration）**：血液流经肾小球时，只有未与[血浆蛋白结合](@entry_id:906951)的药物（浓度为 $f_{u,p} \cdot C_p$）能被被动滤过进入原尿。因此，滤过清除率等于**[肾小球滤过率](@entry_id:164274)（Glomerular Filtration Rate, GFR）**乘以**血浆非结合分数（$f_{u,p}$）**。
2.  **主动分泌（Active Secretion, $CL_{sec}$）**：肾小管细胞上的转运蛋白可将药物从血液中主动泵入管腔，这是一个增加净排泄的过程，因此其清除率贡献为正。
3.  **重吸收（Reabsorption, $CL_{reabs}$）**：药物（特别是亲脂性、非离子型药物）可从管腔中[被动扩散](@entry_id:925273)或主动转运回血液，这是一个减少净排泄的过程，因此其清除率贡献为负。

这个方程表明，$CL_r$ 的值可以用来判断主要的[排泄](@entry_id:138819)机制。例如，若 $CL_r > f_{u,p} \cdot GFR$，则必定存在主动分泌。此外，肾脏的总清除能力受限于流向肾脏的血流量，具体而言，是**肾血浆流量（Renal Plasma Flow, RPF）**，任何情况下 $CL_r$ 都不能超过 $RPF$ 。

最后，值得注意的是，上述许多关键参数（如通透性 $P_{app}$、代谢清除率 $CL_{int}$、hERG [抑制常数](@entry_id:189001) $IC_{50}$）的测量方法本身也决定了它们是**动力学（kinetic）**参数还是**[平衡态](@entry_id:270364)（equilibrium）**参数。例如，通透性 $P_{app}$ 和内源性清除率 $CL_{int}$ 都是从物质随时间变化的速率中导出的，因此是动力学参数。而[热力学](@entry_id:172368)溶解度 $S_{eq}$ 和药物与靶点的[结合亲和力](@entry_id:261722)（如 $IC_{50}$），则是在系统达到平衡状态时测量的，属于[平衡态](@entry_id:270364)参数 。在构建模型时，必须清楚地区分这两者。

### 用于预测模型的分子结构表示

无论是机理模型中的参数预测，还是端到端的 QSAR 建模，都要求我们将分子结构 $S$ 转化为计算机可以处理的[数值表示](@entry_id:138287)。这一步是整个预测流程的基石，表示方法的选择直接决定了模型能够捕捉到何种类型的化学信息 。

**环形指纹（Circular Fingerprints）**，如扩展连接性指纹（Extended-Connectivity Fingerprint, ECFP），是一种广泛应用的表示方法。ECFP 通过一个[迭代算法](@entry_id:160288)为分子中的每个原子生成一个特征标识符。在每次迭代中，一个原子的标识符会聚合其自身信息以及其邻近原子的上一轮标识符。这个过程重复 $r$ 次（$r$ 是指纹的“半径”），最终每个原子都编码了其半径为 $r$ 的拓扑邻域内的所有子结构信息。然后，所有这些原子环境标识符被哈希（hashed）到一个固定长度的二[进制](@entry_id:634389)向量（[位向量](@entry_id:746852)）中，向量的每一位代表某个特定子结构是否存在。ECFP 的优点在于其计算速度快，且对原子编号不敏感（即同构不变）。然而，它的局限性也很明显：它是一种固定的、非自适应的[特征提取器](@entry_id:637338)，仅捕捉局部拓扑信息，完全忽略了分子的三维空间构象 。

**图神经网络（Graph Neural Networks, GNNs）**代表了更现代、更强大的分[子表示](@entry_id:141094)方法。GNN 将分子自然地视为一个图（原子为节点，[化学键](@entry_id:145092)为边），并通过一种称为“[消息传递](@entry_id:751915)”的机制学习节点（原子）的表示。在 $T$ 轮消息传递中，每个原子会聚合来自其邻居原子的信息来更新自身的[特征向量](@entry_id:151813)（hidden state）。经过多轮更新后，每个原子的[特征向量](@entry_id:151813)就包含了其在图中更广范围内的连接性信息。与 ECFP 不同，GNN 的消息聚合与[更新函数](@entry_id:275392)是可学习的[参数化](@entry_id:265163)函数，它们会在模型训练过程中针对特定任务进行优化，从而产生**任务自适应的（task-adaptive）**、**连续的（continuous）**分[子表示](@entry_id:141094)。更重要的是，GNN 框架可以灵活地整合更丰富的化学信息。例如，通过将原子的三维坐标 $\mathbf{r}_v$ 或原子间距离 $d_{uv}$ 作为输入，GNN 能够学习到依赖于分子**构象（conformation）**的特征。这对于 ADMET 预测至关重要，因为诸如溶剂可及[极性表面](@entry_id:753555)积、[分子形状](@entry_id:142029)、[分子内氢键](@entry_id:750785)等性质都与分子的三维结构密切相关，而这些性质又深刻影响着[溶解度](@entry_id:147610)、通透性和靶点结合等过程 。

### 稳健建模的[概率论基础](@entry_id:158925)

ADMET 属性的实验测量值本质上不是一个确定的数字，而是充满了随机性。这种随机性源于多方面，包括实验操作中的微小差异、仪器噪声以及生物系统本身的内在变异（如不同批次的细胞或不同个体的[酶活性](@entry_id:143847)差异）。因此，将 ADMET 终点 $Y$ 视为一个确定性函数 $f(X,A)$ 的输出是过于简化的，一种更严谨、更贴近现实的做法是将其建模为一个**条件[随机变量](@entry_id:195330)（conditional random variable）**，并致力于学习其[条件概率分布](@entry_id:163069) $p(Y|X,A)$ 。

采用[概率建模](@entry_id:168598)的视角，不仅是哲学上的严谨，更是解决实际问题的必需。首先，真实世界的实验数据常常包含**[删失数据](@entry_id:173222)（censored data）**。例如，当一个化合物的活性低于仪器的最低[定量限](@entry_id:195270)（Lower Limit of Quantification, $L(A)$）时，我们得到的结果不是一个具体数值，而是一个如“<10 nM”的删失值。