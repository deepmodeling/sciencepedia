{
    "hands_on_practices": [
        {
            "introduction": "掌握蛋白质质子化平衡的第一步是理解最基本的情形：一个孤立的可滴定位点。这个练习将引导你从化学平衡的基本原理出发，推导描述质子化分数随 $pH$ 变化的经典方程。通过分析该曲线在 $pH=pK_a$ 处的斜率，你将深入理解该位点质子化状态对 $pH$ 变化的敏感性，以及它在蛋白质局部微环境中作为缓冲剂的关键作用。",
            "id": "3860091",
            "problem": "蛋白质中嵌入的单个质子结合位点发生化学平衡 $\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{A}^{-}$，其酸解离常数 $K_{a}$ 由活度定义为 $K_{a} = \\frac{a_{\\mathrm{A}^{-}} a_{\\mathrm{H}^{+}}}{a_{\\mathrm{HA}}}$。酸解离常数 $K_{a}$ 通过 $pK_{a} = -\\log_{10}(K_{a})$ 与酸强度相关，而氢离子活度通过 $pH = -\\log_{10}(a_{\\mathrm{H}^{+}})$ 定义了 $pH$。假设该位点是孤立的（不与其他可电离基团耦合），溶液是理想的，因此活度比遵循质量作用定律，且温度和离子强度是固定的。\n\n仅使用这些定义和质量作用定律，推导该位点的质子化分数 $\\theta(pH)$（即处于 $\\mathrm{HA}$ 状态的分数）作为 $pH$ 和 $pK_{a}$ 的函数的解析表达式。然后，将此 $\\theta(pH)$ 对 $pH$ 求导，并计算在 $pH = pK_{a}$ 处的斜率 $\\frac{d\\theta}{d(pH)}$。解释在 $pH = pK_{a}$ 处该斜率的物理意义，涉及该位点质子化状态对 $pH$ 变化的敏感性及其在蛋白质微环境局部缓冲中的作用。\n\n将最终答案表示为精确的解析表达式。无需四舍五入，最终答案中不应包含单位。",
            "solution": "问题要求推导单个可电离位点的质子化分数 $\\theta(pH)$，计算该函数在 $pH = pK_{a}$ 点对 $pH$ 的斜率，并解释该斜率的物理意义。\n\n首先，对问题进行验证。\n**第一步：提取已知条件**\n- 化学平衡：$\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{A}^{-}$\n- 酸解离常数：$K_{a} = \\frac{a_{\\mathrm{A}^{-}} a_{\\mathrm{H}^{+}}}{a_{\\mathrm{HA}}}$\n- $pK_{a}$ 定义：$pK_{a} = -\\log_{10}(K_{a})$\n- $pH$ 定义：$pH = -\\log_{10}(a_{\\mathrm{H}^{+}})$\n- 质子化分数 $\\theta(pH)$：位点处于质子化状态 $\\mathrm{HA}$ 的分数。\n- 假设：该位点是孤立的，溶液是理想的（根据质量作用定律，活度比可以用浓度比表示），温度和离子强度是恒定的。\n\n**第二步：使用提取的已知条件进行验证**\n- 该问题具有科学依据，因为它基于酸碱化学的基本原理，特别是 Henderson-Hasselbalch 关系式。\n- 该问题提法恰当。所提供的定义和假设是自洽且充分的，足以推导出唯一、有意义的解析解。\n- 该问题是客观的，使用了清晰和标准的科学术语。\n- 该问题不违反任何无效标准。它是化学生物学中一个标准、可形式化的问题。\n\n**第三步：结论与行动**\n问题有效。将继续进行求解过程。\n\n**质子化分数 $\\theta(pH)$ 的推导**\n\n质子化分数 $\\theta$ 定义为处于质子化状态 ($\\mathrm{HA}$) 的位点占总位点的分数。位点的总浓度是质子化形式 $[\\mathrm{HA}]$ 和去质子化形式 $[\\mathrm{A}^{-}]$ 的浓度之和。因此，$\\theta$ 由下式给出：\n$$\n\\theta = \\frac{[\\mathrm{HA}]}{[\\mathrm{HA}] + [\\mathrm{A}^{-}]}\n$$\n为了将 $\\theta$ 表示为 $pH$ 和 $pK_{a}$ 的函数，我们可以对该表达式进行变换。将分子和分母同时除以 $[\\mathrm{HA}]$，得到：\n$$\n\\theta = \\frac{1}{1 + \\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]}}\n$$\n浓度之间的关系由酸解离常数 $K_{a}$ 决定。问题中用活度定义了 $K_{a}$：$K_{a} = \\frac{a_{\\mathrm{A}^{-}} a_{\\mathrm{H}^{+}}}{a_{\\mathrm{HA}}}$。在理想溶液的假设下，酸及其共轭碱的活度比等于它们的摩尔浓度比。因此，我们可以写出：\n$$\nK_{a} = \\frac{[\\mathrm{A}^{-}] a_{\\mathrm{H}^{+}}}{[\\mathrm{HA}]}\n$$\n重排该方程以求解比值 $\\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]}$，得到：\n$$\n\\frac{[\\mathrm{A}^{-}]}{[\\mathrm{HA}]} = \\frac{K_{a}}{a_{\\mathrm{H}^{+}}}\n$$\n现在，将此比值代回到 $\\theta$ 的表达式中：\n$$\n\\theta = \\frac{1}{1 + \\frac{K_{a}}{a_{\\mathrm{H}^{+}}}}\n$$\n为了引入 $pH$ 和 $pK_{a}$，我们使用给定的定义：$pH = -\\log_{10}(a_{\\mathrm{H}^{+}})$ 和 $pK_{a} = -\\log_{10}(K_{a})$。这些可以重写为指数形式 $a_{\\mathrm{H}^{+}} = 10^{-pH}$ 和 $K_{a} = 10^{-pK_{a}}$。将这些代入 $\\theta$ 的表达式中：\n$$\n\\frac{K_{a}}{a_{\\mathrm{H}^{+}}} = \\frac{10^{-pK_{a}}}{10^{-pH}} = 10^{pH - pK_{a}}\n$$\n因此，质子化分数 $\\theta$ 作为 $pH$ 和 $pK_{a}$ 函数的最终表达式是：\n$$\n\\theta(pH) = \\frac{1}{1 + 10^{pH - pK_{a}}}\n$$\n\n**求导与斜率计算**\n\n接下来，我们必须求 $\\theta(pH)$ 对 $pH$ 的导数，我们记为 $\\frac{d\\theta}{d(pH)}$。令 $x = pH$ 且 $c = pK_{a}$（一个常数）。函数为 $\\theta(x) = (1 + 10^{x-c})^{-1}$。我们使用链式法则进行求导。\n$$\n\\frac{d\\theta}{d(pH)} = \\frac{d}{d(pH)} \\left( (1 + 10^{pH - pK_{a}})^{-1} \\right)\n$$\n应用幂法则和链式法则：\n$$\n\\frac{d\\theta}{d(pH)} = -1 \\cdot (1 + 10^{pH - pK_{a}})^{-2} \\cdot \\frac{d}{d(pH)} (1 + 10^{pH - pK_{a}})\n$$\n内层函数的导数是：\n$$\n\\frac{d}{d(pH)} (1 + 10^{pH - pK_{a}}) = \\frac{d}{d(pH)} (10^{pH - pK_{a}})\n$$\n使用指数函数的求导法则 $\\frac{d}{dz}(b^z) = b^z \\ln(b)$，我们得到：\n$$\n\\frac{d}{d(pH)} (10^{pH - pK_{a}}) = 10^{pH - pK_{a}} \\ln(10) \\cdot \\frac{d}{d(pH)}(pH - pK_{a}) = 10^{pH - pK_{a}} \\ln(10) \\cdot 1\n$$\n结合这些结果，$\\theta(pH)$ 的导数是：\n$$\n\\frac{d\\theta}{d(pH)} = - \\frac{10^{pH - pK_{a}} \\ln(10)}{(1 + 10^{pH - pK_{a}})^2}\n$$\n问题要求计算在 $pH = pK_{a}$ 这一特定点的斜率。在这一点，指数变为 $pH - pK_{a} = 0$。\n$$\n\\left. \\frac{d\\theta}{d(pH)} \\right|_{pH = pK_{a}} = - \\frac{10^{0} \\ln(10)}{(1 + 10^{0})^2}\n$$\n由于 $10^0 = 1$，表达式简化为：\n$$\n\\left. \\frac{d\\theta}{d(pH)} \\right|_{pH = pK_{a}} = - \\frac{1 \\cdot \\ln(10)}{(1 + 1)^2} = - \\frac{\\ln(10)}{2^2} = - \\frac{\\ln(10)}{4}\n$$\n\n**物理意义解释**\n\n斜率 $\\frac{d\\theta}{d(pH)}$ 量化了位点质子化状态对溶液 $pH$ 变化的敏感性。\n在 $pH = pK_{a}$ 处计算出的斜率值为 $-\\frac{\\ln(10)}{4} \\approx -0.5756$。\n1.  **负号**：负号表示随着 $pH$ 的增加（即溶液变得更碱性），质子化分数 $\\theta$ 会减小。这在化学上是直观的：环境中质子浓度降低会使平衡 $\\mathrm{HA} \\rightleftharpoons \\mathrm{H}^{+} + \\mathrm{A}^{-}$ 向右移动，从而有利于去质子化状态 $\\mathrm{A}^{-}$ 的形成。\n2.  **$pH=pK_a$ 时的幅值**：在 $pH = pK_{a}$ 时，该位点恰好是半质子化的 ($\\theta = 0.5$)。此时，斜率 $\\frac{d\\theta}{d(pH)}$ 的绝对值达到最大。这意味着当 $pH$ 等于其 $pK_{a}$ 时，该基团的质子化状态对 $pH$ 的波动最为敏感。$pK_{a}$ 附近的局部 $pH$ 的微小变化将引起质子化物种与去质子化物种比例的最大可能变化。\n3.  **在缓冲中的作用**：这种最大的敏感性与最大的缓冲能力是同义的。缓冲液通过吸收或释放质子来抵抗 $pH$ 的变化。在 $pH = pK_{a}$ 时，质子给体 ($\\mathrm{HA}$) 和质子受体 ($\\mathrm{A}^{-}$) 的浓度相等，使得系统能够有效地吸收加入的酸（通过反应 $\\mathrm{A}^{-} + \\mathrm{H}^{+} \\rightarrow \\mathrm{HA}$）或加入的碱（通过反应 $\\mathrm{HA} + \\mathrm{OH}^{-} \\rightarrow \\mathrm{A}^{-} + \\mathrm{H}_{2}\\mathrm{O}$），而整体 $pH$ 的变化最小。因此，数值 $-\\frac{\\ln(10)}{4}$ 代表了质子化状态的最大变化率，这对应于可滴定基团对其局部微环境发挥最大缓冲作用的点。",
            "answer": "$$\\boxed{-\\frac{\\ln(10)}{4}}$$"
        },
        {
            "introduction": "在真实的蛋白质中，可滴定的残基很少是完全孤立的；它们常常通过静电或构象相互作用而耦合。这个练习将模型从单个位点扩展到两个相互作用的位点，引入了微观状态、统计权重和协同性等核心概念。通过解决这个基于统计热力学的假设性问题，你将学会如何量化耦合效应对宏观滴定行为的影响，这是精确模拟蛋白质静电特性的关键一步。",
            "id": "3860122",
            "problem": "考虑一个蛋白质微环境，其中有两个耦合的可滴定基团，记为基团 $A$ 和基团 $B$，它们各自可以从溶液中结合一个质子。假设溶液为理想溶液，因此氢离子活度为 $a_{H} = 10^{-\\mathrm{pH}}$。当另一个基团处于去质子化状态时，质子与这些基团结合的微观结合常数分别设为 $K_{A}^{(0)}$ 和 $K_{B}^{(0)}$。基团之间的耦合由一个正协同因子 $\\omega > 0$ 描述，该因子使得双质子化状态的统计权重相对于单质子化权重乘积被乘以 $\\omega$；等效地，根据热力学循环闭合原理，任一基团的第二步结合常数是其第一步常数的 $\\omega$ 倍。所有结合常数均以 $1\\,\\mathrm{M}$ 标准态为参考，因此是无量纲的。\n\n从质量作用定律、质子化微观状态的统计权重以及统计热力学中配体结合的结合多项式定义出发，推导平均结合质子数 $n(\\mathrm{pH})$ 的表达式，用 $a_{H}$、$K_{A}^{(0)}$、$K_{B}^{(0)}$ 和 $\\omega$ 表示。然后，确定宏观滴定中点，其定义为总预期质子摄取量等于1（即 $n = 1$）时的氢离子活度 $a_{H}^{\\ast}$。最后，计算相应的表观酸解离常数（$\\mathrm{p}K_{a,\\mathrm{app}}$），此处定义为 $\\mathrm{p}K_{a,\\mathrm{app}} = -\\log_{10}(a_{H}^{\\ast})$。\n\n使用以下假设的微观参数，这些参数对于蛋白质内部基团是科学上合理的：$K_{A}^{(0)} = 3.16227766 \\times 10^{6}$，$K_{B}^{(0)} = 1.00000000 \\times 10^{5}$，以及 $\\omega = 10.00000000$。给出 $a_{H}^{\\ast}$ 和 $\\mathrm{p}K_{a,\\mathrm{app}}$ 的最终数值，并四舍五入到四位有效数字。将您的答案表示为行矩阵 $\\left(a_{H}^{\\ast} \\text{ , } \\mathrm{p}K_{a,\\mathrm{app}}\\right)$。",
            "solution": "问题陈述经过严格验证，确认有效。它在科学上基于应用于蛋白质生物物理学的统计热力学和化学平衡原理。该问题表述清晰、客观、自洽，且无矛盾或歧义。\n\n该系统由两个可滴定基团 $A$ 和 $B$ 组成，它们既可以去质子化（例如 $A$），也可以质子化（例如 $AH$）。这产生了 $2^2 = 4$ 种可能的质子化微观状态：$(A, B)$、$(AH, B)$、$(A, BH)$ 和 $(AH, BH)$。蛋白质上结合的平均质子数 $n(\\mathrm{pH})$ 可以通过统计力学方法，基于在给定氢离子活度 $a_{H} = 10^{-\\mathrm{pH}}$ 下这些微观状态的相对布居数来确定。\n\n首先，我们定义每个微观状态的统计权重（$W$）。按照惯例，完全去质子化的参考状态 $(A, B)$ 的权重设为 $1$。\n$$W_{00} = [A, B] / [A, B] = 1$$\n其他状态的权重由连接它们与参考状态的质子结合平衡的质量作用定律确定。令 $x = a_{H}$ 表示氢离子活度。\n\n单质子化状态 $(AH, B)$ 是通过反应 $(A, B) + H^{+} \\rightleftharpoons (AH, B)$ 形成的。问题将此步骤的微观结合常数定义为 $K_{A}^{(0)}$。\n$$K_{A}^{(0)} = \\frac{[AH, B]}{[A, B] \\cdot a_{H}}$$\n因此，在基团 $A$ 上有一个质子而在基团 $B$ 上没有质子的 $(AH, B)$ 状态的统计权重为：\n$$W_{10} = \\frac{[AH, B]}{[A, B]} = K_{A}^{(0)} a_{H}$$\n类似地，对于通过 $(A, B) + H^{+} \\rightleftharpoons (A, BH)$ 形成、结合常数为 $K_{B}^{(0)}$ 的状态 $(A, BH)$：\n$$K_{B}^{(0)} = \\frac{[A, BH]}{[A, B] \\cdot a_{H}}$$\n在基团 $A$ 上没有质子而在基团 $B$ 上有一个质子的 $(A, BH)$ 状态的统计权重为：\n$$W_{01} = \\frac{[A, BH]}{[A, B]} = K_{B}^{(0)} a_{H}$$\n双质子化状态 $(AH, BH)$ 可以从任一单质子化状态形成。我们考虑它从 $(AH, B)$ 形成的过程：$(AH, B) + H^{+} \\rightleftharpoons (AH, BH)$。其结合常数为 $K_{B}^{(A)}$。问题指出，第二步结合常数是第一步常数的 $\\omega$ 倍，所以 $K_{B}^{(A)} = \\omega K_{B}^{(0)}$。\n$$K_{B}^{(A)} = \\frac{[AH, BH]}{[AH, B] \\cdot a_{H}} = \\omega K_{B}^{(0)}$$\n$(AH, BH)$ 状态的权重可以相对于参考状态表示为：\n$$W_{11} = \\frac{[AH, BH]}{[A, B]} = \\frac{[AH, BH]}{[AH, B]} \\frac{[AH, B]}{[A, B]} = (K_{B}^{(A)} a_{H}) (K_{A}^{(0)} a_{H}) = (\\omega K_{B}^{(0)} a_{H}) (K_{A}^{(0)} a_{H}) = \\omega K_{A}^{(0)} K_{B}^{(0)} a_{H}^{2}$$\n此结果与热力学循环闭合条件 $K_{A}^{(0)} K_{B}^{(A)} = K_{B}^{(0)} K_{A}^{(B)}$ 以及协同性 $\\omega$ 的定义相符。\n\n结合多项式 $\\Xi(a_{H})$ 是所有可能微观状态的统计权重之和。它充当系统的配分函数。\n$$\\Xi(a_{H}) = W_{00} + W_{10} + W_{01} + W_{11}$$\n$$\\Xi(a_{H}) = 1 + K_{A}^{(0)} a_{H} + K_{B}^{(0)} a_{H} + \\omega K_{A}^{(0)} K_{B}^{(0)} a_{H}^{2}$$\n$$\\Xi(a_{H}) = 1 + (K_{A}^{(0)} + K_{B}^{(0)}) a_{H} + \\omega K_{A}^{(0)} K_{B}^{(0)} a_{H}^{2}$$\n平均结合质子数 $n(a_{H})$ 是使用标准统计力学公式从结合多项式推导出来的：\n$$n(a_{H}) = a_{H} \\frac{d}{d a_{H}} \\ln(\\Xi(a_{H})) = \\frac{a_{H}}{\\Xi(a_{H})} \\frac{d\\Xi(a_{H})}{d a_{H}}$$\n首先，我们求 $\\Xi(a_{H})$ 对 $a_{H}$ 的导数：\n$$\\frac{d\\Xi(a_{H})}{d a_{H}} = K_{A}^{(0)} + K_{B}^{(0)} + 2 \\omega K_{A}^{(0)} K_{B}^{(0)} a_{H}$$\n将此代入 $n(a_{H})$ 的表达式中：\n$$n(a_{H}) = \\frac{a_{H} \\left( K_{A}^{(0)} + K_{B}^{(0)} + 2 \\omega K_{A}^{(0)} K_{B}^{(0)} a_{H} \\right)}{1 + (K_{A}^{(0)} + K_{B}^{(0)}) a_{H} + \\omega K_{A}^{(0)} K_{B}^{(0)} a_{H}^{2}}$$\n$$n(a_{H}) = \\frac{(K_{A}^{(0)} + K_{B}^{(0)}) a_{H} + 2 \\omega K_{A}^{(0)} K_{B}^{(0)} a_{H}^{2}}{1 + (K_{A}^{(0)} + K_{B}^{(0)}) a_{H} + \\omega K_{A}^{(0)} K_{B}^{(0)} a_{H}^{2}}$$\n这就是推导出的平均结合质子数的表达式。\n\n宏观滴定中点定义为平均结合质子数恰好为1（即 $n(a_{H}^{\\ast}) = 1$）时的氢离子活度 $a_{H}^{\\ast}$。\n$$1 = \\frac{(K_{A}^{(0)} + K_{B}^{(0)}) a_{H}^{\\ast} + 2 \\omega K_{A}^{(0)} K_{B}^{(0)} (a_{H}^{\\ast})^{2}}{1 + (K_{A}^{(0)} + K_{B}^{(0)}) a_{H}^{\\ast} + \\omega K_{A}^{(0)} K_{B}^{(0)} (a_{H}^{\\ast})^{2}}$$\n两边同乘以分母得到：\n$$1 + (K_{A}^{(0)} + K_{B}^{(0)}) a_{H}^{\\ast} + \\omega K_{A}^{(0)} K_{B}^{(0)} (a_{H}^{\\ast})^{2} = (K_{A}^{(0)} + K_{B}^{(0)}) a_{H}^{\\ast} + 2 \\omega K_{A}^{(0)} K_{B}^{(0)} (a_{H}^{\\ast})^{2}$$\n项 $(K_{A}^{(0)} + K_{B}^{(0)}) a_{H}^{\\ast}$ 在两边消去，得到一个简化方程：\n$$1 + \\omega K_{A}^{(0)} K_{B}^{(0)} (a_{H}^{\\ast})^{2} = 2 \\omega K_{A}^{(0)} K_{B}^{(0)} (a_{H}^{\\ast})^{2}$$\n两边同减去 $\\omega K_{A}^{(0)} K_{B}^{(0)} (a_{H}^{\\ast})^{2}$ 得到：\n$$1 = \\omega K_{A}^{(0)} K_{B}^{(0)} (a_{H}^{\\ast})^{2}$$\n求解 $a_{H}^{\\ast}$，由于活度必须为正，我们取正根：\n$$(a_{H}^{\\ast})^{2} = \\frac{1}{\\omega K_{A}^{(0)} K_{B}^{(0)}}$$\n$$a_{H}^{\\ast} = \\frac{1}{\\sqrt{\\omega K_{A}^{(0)} K_{B}^{(0)}}}$$\n表观酸解离常数定义为 $\\mathrm{p}K_{a,\\mathrm{app}} = -\\log_{10}(a_{H}^{\\ast})$。\n$$\\mathrm{p}K_{a,\\mathrm{app}} = -\\log_{10}\\left( (\\omega K_{A}^{(0)} K_{B}^{(0)})^{-1/2} \\right) = \\frac{1}{2} \\log_{10}(\\omega K_{A}^{(0)} K_{B}^{(0)})$$\n$$\\mathrm{p}K_{a,\\mathrm{app}} = \\frac{1}{2} (\\log_{10}(\\omega) + \\log_{10}(K_{A}^{(0)}) + \\log_{10}(K_{B}^{(0)}))$$\n现在我们代入给定的数值：\n$K_{A}^{(0)} = 3.16227766 \\times 10^{6}$。我们注意到 $3.16227766$ 是 $\\sqrt{10}$ 的高精度数值，所以我们可以写成 $K_{A}^{(0)} = 10^{0.5} \\times 10^{6} = 10^{6.5}$。\n$K_{B}^{(0)} = 1.00000000 \\times 10^{5} = 10^{5}$。\n$\\omega = 10.00000000 = 10^{1}$。\n\n首先，我们计算 $a_{H}^{\\ast}$ 分母中的乘积：\n$$\\omega K_{A}^{(0)} K_{B}^{(0)} = (10^{1}) \\cdot (10^{6.5}) \\cdot (10^{5}) = 10^{(1 + 6.5 + 5)} = 10^{12.5}$$\n现在，我们求 $a_{H}^{\\ast}$：\n$$a_{H}^{\\ast} = \\frac{1}{\\sqrt{10^{12.5}}} = \\frac{1}{10^{12.5/2}} = \\frac{1}{10^{6.25}} = 10^{-6.25}$$\n为了用标准科学记数法表示，我们计算 $10^{-6.25} = 10^{0.75} \\times 10^{-7}$。\n$10^{0.75} \\approx 5.62341325$。\n所以，$a_{H}^{\\ast} \\approx 5.62341325 \\times 10^{-7}$。\n四舍五入到4位有效数字，我们得到 $a_{H}^{\\ast} = 5.623 \\times 10^{-7}$。\n\n接下来，我们计算表观 $\\mathrm{p}K_{a}$：\n$$\\mathrm{p}K_{a,\\mathrm{app}} = -\\log_{10}(a_{H}^{\\ast}) = -\\log_{10}(10^{-6.25}) = 6.25$$\n问题要求此值四舍五入到4位有效数字，所以我们写成 $6.250$。\n\n最终结果是 $a_{H}^{\\ast} = 5.623 \\times 10^{-7}$ 和 $\\mathrm{p}K_{a,\\mathrm{app}} = 6.250$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.623 \\times 10^{-7}  6.250\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "将理论模型应用于实际的生物分子通常需要计算方法，尤其是在处理像组氨酸这样具有多种质子化状态和互变异构体的复杂残基时。这个动手实践将指导你编写一个程序，以严格的统计力学方法枚举组氨酸的所有相关微观状态。通过这个练习，你将掌握如何避免重复计数并正确计算不同化学物种的玻尔兹曼权重，从而能够预测这个在酶催化和蛋白质稳定性中起着至关重要作用的氨基酸的完整滴定行为。",
            "id": "3860065",
            "problem": "蛋白质中嵌入的单个组氨酸侧链，由于酸碱化学和咪唑环的互变异构，可以占据多种化学上不同的微观态。中性咪唑以两种互变异构体的形式存在，其区别在于质子在环氮上的结合位置不同；而阳离子态在环上有两个结合的质子。溶液的pH值（氢离子电位）通过质子化学势控制每个微观态的热力学权重，而质子化学势与结合的质子数量相关联。您的任务是推导、实现并测试一种统计上严谨的微观态枚举方法，该方法包括组氨酸的互变异构和多种质子化状态且无重复计数，然后计算其滴定行为。\n\n从以下基本原理开始：\n- 统计力学中的玻尔兹曼分布：能量为 $G$ 的微观态的概率与 $\\exp(-\\beta G)$ 成正比，其中 $\\beta = 1/(R T)$，$R$ 是气体常数，$T$ 是绝对温度。\n- 溶液中物种的化学势：对于质子，$\\mu_{\\mathrm{H}^+} = \\mu_{\\mathrm{H}^+}^{\\circ} + R T \\ln a_{\\mathrm{H}^+}$，在稀溶液中活度 $a_{\\mathrm{H}^+} \\approx 10^{-\\mathrm{pH}}$。因此，$\\mu_{\\mathrm{H}^+} = \\mu_{\\mathrm{H}^+}^{\\circ} - R T \\ln(10)\\,\\mathrm{pH}$。\n- 酸解离常数的负常用对数（pKa）定义了特征pH值，在这些值下，简单的两态系统中的酸碱转换达到半布居状态。\n\n将组氨酸微观态定义为独特的、化学上可区分的物种：\n- 阴离子咪唑盐（$A_0$），环上结合了 $n=0$ 个质子。\n- 中性互变异构体，质子在 $\\mathrm{N}\\delta$ 上（$N_{1\\delta}$），结合了 $n=1$ 个质子。\n- 中性互变异构体，质子在 $\\mathrm{N}\\epsilon$ 上（$N_{1\\epsilon}$），结合了 $n=1$ 个质子。\n- 阳离子咪唑鎓（$C_2$），结合了 $n=2$ 个质子。\n通过对每个化学上不同的微观态进行一次枚举来避免重复计数。特别是，不要为不同的质子化路径引入多个 $C_2$ 微观态；$C_2$ 是一个单一的化学物种。\n\n设每个微观态 $i$ 都有一个内在标准态自由能 $G_i^{\\mathrm{intr}}$（单位为 $\\mathrm{kcal/mol}$），它捕捉了与pH无关的环境稳定化作用，并设 $n_i$ 为环上结合的质子整数。依赖于pH的有效自由能应处理为 $G_i(\\mathrm{pH}) = G_i^{\\mathrm{intr}} - n_i\\,\\mu_{\\mathrm{H}^+}(\\mathrm{pH})$，并且可观测概率由温度 $T$ 下的玻尔兹曼权重计算得出。\n\n实现一个程序，该程序：\n1. 对四个微观态 $\\{A_0, N_{1\\delta}, N_{1\\epsilon}, C_2\\}$ 及其各自的 $n_i$ 值 $\\{0,1,1,2\\}$ 进行精确一次的枚举，并使用 $G_i(\\mathrm{pH})$ 和 $\\beta = 1/(R T)$ 计算它们在指定pH下的玻尔兹曼概率。\n2. 计算阳离子微观态的分数 $f_{C_2}(\\mathrm{pH})$，即 $C_2$ 的玻尔兹曼概率除以对所有四个微观态求和的配分函数。\n3. 使用气体常数 $R = 0.0019872041$ $\\mathrm{kcal/(mol\\cdot K)}$，温度 $T = 298.15$ $\\mathrm{K}$，能量单位为 $\\mathrm{kcal/mol}$。\n4. 接受三组不同的参数集（见下方的测试套件），每组参数集通过定义将 $G_{N_{1\\delta}}^{\\mathrm{intr}}$ 指定为 $0$ $\\mathrm{kcal/mol}$，并指定一个互变异构体能量偏移 $\\Delta_{\\mathrm{taut}}$（它设定 $G_{N_{1\\epsilon}}^{\\mathrm{intr}} = \\Delta_{\\mathrm{taut}}$）、一个阳离子内在能量 $G_{C_2}^{\\mathrm{intr}}$ 和一个阴离子内在能量 $G_{A_0}^{\\mathrm{intr}}$。阳离子和阴离子的内在能量被选择用来反映在没有互变异构体不平衡情况下的目标宏观转变。具体来说，对于参考中性能量 $G_{N_{1\\delta}}^{\\mathrm{intr}} = 0$，使用 $G_{C_2}^{\\mathrm{intr}} = - R T \\ln(10) \\cdot \\mathrm{p}K_{a}^{\\mathrm{cat}}$ 将中性到阳离子的转变中心置于 $\\mathrm{p}K_{a}^{\\mathrm{cat}}$ 附近，并使用 $G_{A_0}^{\\mathrm{intr}} = + R T \\ln(10) \\cdot \\mathrm{p}K_{a}^{\\mathrm{ani}}$ 将中性到阴离子的转变中心置于 $\\mathrm{p}K_{a}^{\\mathrm{ani}}$ 附近。这些选择确保了科学真实性，但在 $\\Delta_{\\mathrm{taut}} \\neq 0$ 的情况下，仍需要正确的微观态枚举和玻尔兹曼统计来获得正确的滴定行为。\n\n使用以下参数集和pH值的测试套件：\n- 测试用例1（中性互变异构体对称）：$\\Delta_{\\mathrm{taut}} = 0.0$ $\\mathrm{kcal/mol}$，$\\mathrm{p}K_{a}^{\\mathrm{cat}} = 6.0$，$\\mathrm{p}K_{a}^{\\mathrm{ani}} = 14.0$。设置 $G_{C_2}^{\\mathrm{intr}} = - R T \\ln(10)\\cdot 6.0$，$G_{A_0}^{\\mathrm{intr}} = + R T \\ln(10)\\cdot 14.0$。\n- 测试用例2（环境稳定化一种互变异构体）：$\\Delta_{\\mathrm{taut}} = -2.0$ $\\mathrm{kcal/mol}$，$\\mathrm{p}K_{a}^{\\mathrm{cat}} = 6.0$，$\\mathrm{p}K_{a}^{\\mathrm{ani}} = 14.0$。$G_{C_2}^{\\mathrm{intr}}$ 和 $G_{A_0}^{\\mathrm{intr}}$ 的设置与测试用例1相同。\n- 测试用例3（阴离子转变点移近）：$\\Delta_{\\mathrm{taut}} = 0.0$ $\\mathrm{kcal/mol}$，$\\mathrm{p}K_{a}^{\\mathrm{cat}} = 6.0$，$\\mathrm{p}K_{a}^{\\mathrm{ani}} = 12.0$。设置 $G_{C_2}^{\\mathrm{intr}} = - R T \\ln(10)\\cdot 6.0$，$G_{A_0}^{\\mathrm{intr}} = + R T \\ln(10)\\cdot 12.0$。\n\n为每个测试用例计算在pH值为 $\\mathrm{pH} \\in \\{4.0, 6.0, 8.0\\}$ 时的 $f_{C_2}(\\mathrm{pH})$。所有能量以 $\\mathrm{kcal/mol}$ 为单位，温度以 $\\mathrm{K}$ 为单位表示。最终程序输出必须是单行，包含一个用方括号括起来的逗号分隔列表，其结果按以下顺序排列：\n$[f_{C_2}^{\\text{TC1}}(4.0), f_{C_2}^{\\text{TC1}}(6.0), f_{C_2}^{\\text{TC1}}(8.0), f_{C_2}^{\\text{TC2}}(4.0), f_{C_2}^{\\text{TC2}}(6.0), f_{C_2}^{\\text{TC2}}(8.0), f_{C_2}^{\\text{TC3}}(4.0), f_{C_2}^{\\text{TC3}}(6.0), f_{C_2}^{\\text{TC3}}(8.0)]$。\n\n您的实现必须是自包含、通用的，并通过对每个微观态进行精确一次的枚举并将其玻尔兹曼权重计入配分函数来避免重复计数。不允许额外的用户输入或文件。",
            "solution": "该问题已经过验证，并被确定为计算化学生物学领域中一个定义明确、具有科学依据的问题。以下解决方案提供了详细的推导和实施计划。\n\n### 理论框架\n\n目标是计算组氨酸侧链的阳离子微观态的分数布居，记为 $f_{C_2}(\\mathrm{pH})$，作为溶液pH值（氢离子电位）的函数。该模型考虑了四种不同的化学微观态：一个阴离子形式（$A_0$）、两种中性互变异构体（$N_{1\\delta}$ 和 $N_{1\\epsilon}$）以及一个阳离子形式（$C_2$）。\n\n首先，我们枚举各个微观态及其对应的结合质子数 $n_i$：\n-   阴离子咪唑盐，$A_0$，具有 $n_{A_0} = 0$ 个质子。\n-   中性互变异构体，$N_{1\\delta}$，质子在 $\\delta$-氮上，$n_{N_{1\\delta}} = 1$。这是我们的参考态。\n-   中性互变异构体，$N_{1\\epsilon}$，质子在 $\\epsilon$-氮上，$n_{N_{1\\epsilon}} = 1$。\n-   阳离子咪唑鎓，$C_2$，具有 $n_{C_2} = 2$ 个质子。\n\n观测到微观态 $i$ 的概率由玻尔兹曼分布给出，其中概率 $P_i$ 与其玻尔兹曼权重 $w_i = \\exp(-\\beta G_i)$ 成正比，其中 $\\beta = 1/(RT)$。$R$ 为气体常数（$0.0019872041$ $\\mathrm{kcal/(mol\\cdot K)}$），$T$ 为温度（$298.15$ $\\mathrm{K}$）。\n\n由于与溶液交换质子，每个微观态的自由能 $G_i$ 依赖于 $\\mathrm{pH}$。问题将依赖于pH的有效自由能指定为 $G_i(\\mathrm{pH}) = G_i^{\\mathrm{intr}} - n_i\\,\\mu_{\\mathrm{H}^+}(\\mathrm{pH})$，其中 $G_i^{\\mathrm{intr}}$ 是内在标准态自由能，$\\mu_{\\mathrm{H}^+}(\\mathrm{pH}) = \\mu_{\\mathrm{H}^+}^{\\circ} - R T \\ln(10)\\,\\mathrm{pH}$ 是质子的化学势。这个公式引入了对标准化学势 $\\mu_{\\mathrm{H}^+}^{\\circ}$ 的依赖。然而，根据 $\\mathrm{p}K_a$ 值对内在能量的定义意味着标准化学势项已经被包含在内。一个与问题定义一致的标准、等效的pH依赖自由能公式是：\n$$G_i(\\mathrm{pH}) = G_i^{\\mathrm{intr}} + n_i R T \\ln(10) \\cdot \\mathrm{pH}$$\n在这里，$G_i^{\\mathrm{intr}}$ 代表微观态在参考pH为0时的标准自由能。我们将采用这个物理上一致的公式继续进行。\n\n每个微观态的内在自由能是相对于 $N_{1\\delta}$ 互变异构体定义的：\n-   $G_{N_{1\\delta}}^{\\mathrm{intr}} = 0$ $\\mathrm{kcal/mol}$（根据参考态的定义）。\n-   $G_{N_{1\\epsilon}}^{\\mathrm{intr}} = \\Delta_{\\mathrm{taut}}$。\n-   $G_{C_2}^{\\mathrm{intr}} = - R T \\ln(10) \\cdot \\mathrm{p}K_{a}^{\\mathrm{cat}}$。这对应于反应 $N_{1\\delta} + \\mathrm{H}^+ \\rightarrow C_2$ 的标准自由能变化。\n-   $G_{A_0}^{\\mathrm{intr}} = + R T \\ln(10) \\cdot \\mathrm{p}K_{a}^{\\mathrm{ani}}$。这对应于反应 $N_{1\\delta} \\rightarrow A_0 + \\mathrm{H}^+$ 的标准自由能变化。\n\n### 配分函数与状态概率\n\n每个微观态 $i$ 的玻尔兹曼权重 $w_i(\\mathrm{pH})$ 计算如下：\n$$w_i(\\mathrm{pH}) = \\exp(-\\beta G_i(\\mathrm{pH})) = \\exp\\left(-\\frac{G_i^{\\mathrm{intr}} + n_i R T \\ln(10) \\cdot \\mathrm{pH}}{RT}\\right)$$\n这可以简化为：\n$$w_i(\\mathrm{pH}) = \\exp\\left(-\\frac{G_i^{\\mathrm{intr}}}{RT}\\right) \\exp(-n_i \\ln(10) \\cdot \\mathrm{pH}) = \\exp\\left(-\\frac{G_i^{\\mathrm{intr}}}{RT}\\right) 10^{-n_i \\cdot \\mathrm{pH}}$$\n\n将此应用于四个微观态中的每一个：\n-   $w_{A_0}(\\mathrm{pH}) = \\exp\\left(-\\frac{+RT\\ln(10)\\mathrm{p}K_a^{\\mathrm{ani}}}{RT}\\right) \\cdot 10^{-0 \\cdot \\mathrm{pH}} = 10^{-\\mathrm{p}K_a^{\\mathrm{ani}}}$\n-   $w_{N_{1\\delta}}(\\mathrm{pH}) = \\exp\\left(-\\frac{0}{RT}\\right) \\cdot 10^{-1 \\cdot \\mathrm{pH}} = 10^{-\\mathrm{pH}}$\n-   $w_{N_{1\\epsilon}}(\\mathrm{pH}) = \\exp\\left(-\\frac{\\Delta_{\\mathrm{taut}}}{RT}\\right) \\cdot 10^{-1 \\cdot \\mathrm{pH}}$\n-   $w_{C_2}(\\mathrm{pH}) = \\exp\\left(-\\frac{-RT\\ln(10)\\mathrm{p}K_a^{\\mathrm{cat}}}{RT}\\right) \\cdot 10^{-2 \\cdot \\mathrm{pH}} = 10^{\\mathrm{p}K_a^{\\mathrm{cat}}} \\cdot 10^{-2 \\cdot \\mathrm{pH}} = 10^{\\mathrm{p}K_a^{\\mathrm{cat}} - 2 \\cdot \\mathrm{pH}}$$\n\n配分函数 $Z(\\mathrm{pH})$ 是所有可能微观态的玻尔兹曼权重之和：\n$$Z(\\mathrm{pH}) = w_{A_0}(\\mathrm{pH}) + w_{N_{1\\delta}}(\\mathrm{pH}) + w_{N_{1\\epsilon}}(\\mathrm{pH}) + w_{C_2}(\\mathrm{pH})$$\n$$Z(\\mathrm{pH}) = 10^{-\\mathrm{p}K_a^{\\mathrm{ani}}} + \\left(1 + \\exp\\left(-\\frac{\\Delta_{\\mathrm{taut}}}{RT}\\right)\\right)10^{-\\mathrm{pH}} + 10^{\\mathrm{p}K_a^{\\mathrm{cat}} - 2 \\cdot \\mathrm{pH}}$$\n\n阳离子态的分数布居 $f_{C_2}(\\mathrm{pH})$ 是其玻尔兹曼权重与配分函数的比值：\n$$f_{C_2}(\\mathrm{pH}) = \\frac{w_{C_2}(\\mathrm{pH})}{Z(\\mathrm{pH})} = \\frac{10^{\\mathrm{p}K_a^{\\mathrm{cat}} - 2 \\cdot \\mathrm{pH}}}{10^{-\\mathrm{p}K_a^{\\mathrm{ani}}} + \\left(1 + \\exp\\left(-\\frac{\\Delta_{\\mathrm{taut}}}{RT}\\right)\\right)10^{-\\mathrm{pH}} + 10^{\\mathrm{p}K_a^{\\mathrm{cat}} - 2 \\cdot \\mathrm{pH}}}$$\n\n### 算法实现\n\n解决该问题的算法如下：\n1.  定义常数 $R = 0.0019872041$ $\\mathrm{kcal/(mol\\cdot K)}$ 和 $T=298.15$ $\\mathrm{K}$。预先计算乘积 $RT$。\n2.  定义三个测试用例，每个用例都具有 $\\Delta_{\\mathrm{taut}}$、$\\mathrm{p}K_a^{\\mathrm{cat}}$ 和 $\\mathrm{p}K_a^{\\mathrm{ani}}$ 的特定值。\n3.  定义待测试的pH值列表：$\\{4.0, 6.0, 8.0\\}$。\n4.  遍历每个测试用例，并对每个用例遍历pH值列表。\n5.  在每次迭代中，使用上面推导的公式计算四个微观态（$w_{A_0}$、$w_{N_{1\\delta}}$、$w_{N_{1\\epsilon}}$、$w_{C_2}$）各自的玻尔兹曼权重。\n6.  将权重求和以计算配分函数 $Z(\\mathrm{pH})$。\n7.  计算分数布居 $f_{C_2}(\\mathrm{pH}) = w_{C_2}(\\mathrm{pH})/Z(\\mathrm{pH})$。\n8.  将所有九个结果收集到一个列表中，并按照问题陈述中指定的顺序排列。\n9.  将列表格式化为最终的输出字符串。\n\n此过程确保每个微观态都被精确地枚举一次，遵守了问题中关于禁止重复计数的约束，并且计算是根据统计力学原理进行的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the histidine titration problem by calculating the fractional population\n    of the cationic state for different parameter sets and pH values.\n    \"\"\"\n    \n    # Define physical constants\n    R = 0.0019872041  # gas constant in kcal/(mol·K)\n    T = 298.15        # temperature in K\n    RT = R * T        # Product RT in kcal/mol\n\n    # Define the test suite of parameter sets\n    # Each tuple is (delta_taut [kcal/mol], pKa_cat, pKa_ani)\n    test_cases = [\n        (0.0, 6.0, 14.0),   # Test Case 1\n        (-2.0, 6.0, 14.0),  # Test Case 2\n        (0.0, 6.0, 12.0),   # Test Case 3\n    ]\n    \n    # pH values to test for each case\n    ph_values = [4.0, 6.0, 8.0]\n    \n    results = []\n\n    for delta_taut, pka_cat, pka_ani in test_cases:\n        for ph in ph_values:\n            # Calculate the Boltzmann weights for each of the four microstates.\n            # The derivation in the solution text simplifies the weight expressions\n            # to be based on powers of 10.\n            \n            # Weight of the anionic state (A0, n=0)\n            # w_A0 = exp(-G_A0_intr / RT) * 10**(-0 * pH)\n            # G_A0_intr = RT * ln(10) * pKa_ani\n            # w_A0 = exp(-RT * ln(10) * pKa_ani / RT) = exp(-ln(10)*pKa_ani) = 10**(-pKa_ani)\n            w_a0 = 10**(-pka_ani)\n            \n            # Weights of the neutral tautomers (N1d and N1e, n=1)\n            # w_n1d = exp(-G_n1d_intr / RT) * 10**(-1 * pH)\n            # G_n1d_intr = 0 (reference)\n            w_n1d = 1.0 * (10**(-ph))\n            \n            # w_n1e = exp(-G_n1e_intr / RT) * 10**(-1 * pH)\n            # G_n1e_intr = delta_taut\n            w_n1e = np.exp(-delta_taut / RT) * (10**(-ph))\n            \n            # Weight of the cationic state (C2, n=2)\n            # w_c2 = exp(-G_c2_intr / RT) * 10**(-2 * pH)\n            # G_c2_intr = -RT * ln(10) * pKa_cat\n            # w_c2 = exp(RT * ln(10) * pKa_cat / RT) * 10**(-2*pH) = 10**pKa_cat * 10**(-2*pH)\n            w_c2 = 10**(pka_cat - 2 * ph)\n            \n            # The partition function is the sum of all weights\n            partition_function = w_a0 + w_n1d + w_n1e + w_c2\n            \n            # The fractional population of the cationic state is its weight divided by the partition function\n            f_c2 = w_c2 / partition_function\n            \n            results.append(f_c2)\n\n    # Format the final output string exactly as required.\n    # The default string conversion for floats provides sufficient precision.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}