{
    "hands_on_practices": [
        {
            "introduction": "The success of an umbrella sampling study hinges on the choice of the reaction coordinate (RC). An ideal RC should capture the slowest, most important motions of the process, progressing monotonically from reactant to product. This exercise  challenges you to think critically about the suitability of a common but potentially problematic RC, the root-mean-square deviation (RMSD), by evaluating scenarios where it excels and where it fails catastrophically.",
            "id": "2466503",
            "problem": "You plan to use umbrella sampling to compute a one-dimensional potential of mean force along a reaction coordinate for a protein conformational process. The proposed reaction coordinate is the root-mean-square deviation (RMSD) from a given native structure, defined after optimal rigid-body superposition of the configuration $\\mathbf{x}$ onto the native coordinates $\\{\\mathbf{r}_i^\\mathrm{nat}\\}_{i=1}^N$ as\n$$\n\\mathrm{RMSD}(\\mathbf{x}) \\equiv \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left\\|\\mathbf{r}_i(\\mathbf{x})-\\mathbf{r}_i^\\mathrm{nat}\\right\\|^2},\n$$\nwhere $N$ is the number of atoms chosen for alignment. Umbrella sampling will apply a harmonic bias $U_\\mathrm{bias}(q)=\\tfrac{1}{2}k\\,(q-q_0)^2$ to windows centered at values $q_0$ of $q=\\mathrm{RMSD}$. Which option correctly pairs a scenario where using $\\mathrm{RMSD}$ is an excellent reaction coordinate with a scenario where using $\\mathrm{RMSD}$ is a terrible reaction coordinate?\n\nA. Excellent: Folding of a small, designed, $2$-state miniprotein in aqueous solvent, where folding progress is dominated by formation of native backbone hydrogen bonds and native contacts, and non-native side-chain rearrangements equilibrate rapidly at fixed $\\mathrm{RMSD}$. Terrible: An allosteric open$\\leftrightarrow$closed transition in a large $2$-domain enzyme involving multiple quasi-rigid-body hinge rotations and loop-gating, where distinct intermediates share similar $\\mathrm{RMSD}$ to the native state and loop opening/closing is slow.\n\nB. Excellent: Ligand binding to a deep pocket in a globular protein, using the protein backbone $\\mathrm{RMSD}$ to the holo structure as the reaction coordinate. Terrible: Unfolding of an isolated $\\alpha$-helical peptide in implicit solvent, using backbone $C_\\alpha$ $\\mathrm{RMSD}$ to the native helix.\n\nC. Excellent: Folding of a $\\beta$-hairpin where registry shifts and misregistered hairpins are common along the pathway in water. Terrible: Isomerization of a buried side-chain rotamer between two $\\chi_1$ states in a tightly packed core, with negligible backbone motion.\n\nD. Excellent: Rigid-body ligand binding in which the protein remains essentially native-like and only the ligand translates and rotates into the pocket, using the protein $\\mathrm{RMSD}$ to the holo protein as the coordinate. Terrible: A $1$-dihedral isomerization in a small peptide where a single backbone dihedral angle flips between two minima while other degrees of freedom relax quickly.",
            "solution": "The problem statement will first be validated for scientific soundness, clarity, and completeness.\n\n**Step 1: Extract Givens**\n\n*   **Methodology:** Umbrella sampling is to be used to compute a one-dimensional potential of mean force (PMF).\n*   **Process:** A protein conformational process.\n*   **Reaction Coordinate ($q$):** The root-mean-square deviation (RMSD) from a given native structure, $q = \\mathrm{RMSD}$.\n*   **RMSD Definition:** $\\mathrm{RMSD}(\\mathbf{x}) \\equiv \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left\\|\\mathbf{r}_i(\\mathbf{x})-\\mathbf{r}_i^\\mathrm{nat}\\right\\|^2}$, calculated after optimal rigid-body superposition of a configuration $\\mathbf{x}$ onto a reference structure $\\{\\mathbf{r}_i^\\mathrm{nat}\\}$.\n*   **Umbrella Bias Potential:** A harmonic function of the reaction coordinate, $U_\\mathrm{bias}(q)=\\tfrac{1}{2}k\\,(q-q_0)^2$.\n*   **Objective:** To identify the option that correctly pairs a scenario where RMSD is an \"excellent\" reaction coordinate with a scenario where it is a \"terrible\" one.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientific Grounding:** The problem is firmly located within the domain of computational chemistry and biophysics. Umbrella sampling, potential of mean force, reaction coordinates, and root-mean-square deviation are all standard, well-defined concepts. The mathematical formula for RMSD is correct. The proposed bias potential is the most common form used in umbrella sampling. The problem is scientifically sound.\n2.  **Well-Posedness:** The quality of a reaction coordinate is a central topic in the study of rare events. A \"good\" or \"excellent\" reaction coordinate is generally understood to be one that captures the slow, rate-limiting motions of the process, progresses monotonically from reactant to product, and has a unique value for the transition state ensemble. A \"bad\" or \"terrible\" coordinate is one that fails these criteria, for example, by being degenerate (multiple distinct states mapping to the same coordinate value) or by being orthogonal to the actual slow dynamics. The question is therefore well-posed, asking for an expert judgment based on these established principles.\n3.  **Objectivity:** While the terms \"excellent\" and \"terrible\" are qualitative, they have precise, objective meanings within the context of reaction coordinate analysis in enhanced sampling simulations. The problem does not contain subjective or opinion-based claims.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. It is scientifically grounded, well-posed, objective, and contains sufficient information to proceed with a rigorous analysis.\n\n**Derivation of Principles for Reaction Coordinate Quality**\n\nThe goal of computing a potential of mean force, $W(q)$, along a reaction coordinate $q$ is to understand the free energy landscape of a conformational transition. The validity of $W(q)$ depends critically on the choice of $q$. An ideal reaction coordinate, as described by the transition state theory, should be the coordinate that passes through the transition state saddle point on the potential energy surface and is orthogonal to all other degrees of freedom at that point. In practice, for complex systems, a \"good\" reaction coordinate $q$ must satisfy several criteria:\n\n1.  **State Discrimination:** It must clearly distinguish between the reactant, transition, and product states. These states should correspond to distinct ranges of values of $q$.\n2.  **Monotonicity:** The coordinate should, on average, progress monotonically throughout the transition.\n3.  **Dynamical Relevance:** The coordinate must capture the slowest, rate-limiting degree(s) of freedom of the process. All other degrees of freedom orthogonal to $q$ must relax on a much faster timescale. If there are other slow motions not described by $q$, sampling will be inefficient, and the simulation will exhibit hysteresis, meaning the forward and backward PMF profiles will not agree. This is a sign of a poor reaction coordinate.\n\nA common failure mode for a proposed reaction coordinate is **degeneracy**, where structurally and mechanistically distinct states correspond to the same value of the coordinate $q$. This leads to an artificial averaging over these states in the PMF, obscuring the true reaction pathway and barriers.\n\nThe RMSD, as defined, is a global measure of structural similarity to a single reference state. Its suitability as a reaction coordinate is highly context-dependent. It is effective when the process is a simple, concerted departure from (or approach to) the reference structure. It fails when the process is complex, involves motions of sub-parts not well-captured by a global metric, or when distinct intermediates can have similar RMSD values.\n\n**Option-by-Option Analysis**\n\n**A. Excellent: Folding of a small, designed, $2$-state miniprotein in aqueous solvent, where folding progress is dominated by formation of native backbone hydrogen bonds and native contacts, and non-native side-chain rearrangements equilibrate rapidly at fixed $\\mathrm{RMSD}$. Terrible: An allosteric open$\\leftrightarrow$closed transition in a large $2$-domain enzyme involving multiple quasi-rigid-body hinge rotations and loop-gating, where distinct intermediates share similar $\\mathrm{RMSD}$ to the native state and loop opening/closing is slow.**\n\n*   **Analysis of \"Excellent\" Scenario:** A small, $2$-state protein by definition folds without significant, long-lived intermediate states. The process can be idealized as a direct transition from an unfolded ensemble to the native state. The progressive formation of native contacts is directly and monotonically measured by a decreasing RMSD to the native structure. The explicit condition that other degrees of freedom (\"non-native side-chain rearrangements\") equilibrate rapidly at a fixed RMSD value is precisely the requirement for a good reaction coordinate. Therefore, in this idealized scenario, RMSD is an excellent choice.\n*   **Analysis of \"Terrible\" Scenario:** An allosteric transition involving hinge rotations is a classic example where a global RMSD fails. The essential motion is a change in the relative orientation of two quasi-rigid domains, which may not cause a large change in global RMSD. Furthermore, the problem states that \"distinct intermediates share similar RMSD,\" which is a fatal degeneracy. It also states that \"loop opening/closing is slow,\" meaning there is at least one other slow degree of freedom that is not being controlled by the umbrella potential. This will lead to severe sampling problems (hysteresis). Global RMSD is a terrible coordinate for this process.\n*   **Verdict:** This option correctly identifies an ideal use case and a classic failure case for RMSD as a reaction coordinate. **Correct**.\n\n**B. Excellent: Ligand binding to a deep pocket in a globular protein, using the protein backbone $\\mathrm{RMSD}$ to the holo structure as the reaction coordinate. Terrible: Unfolding of an isolated $\\alpha$-helical peptide in implicit solvent, using backbone $C_\\alpha$ $\\mathrm{RMSD}$ to the native helix.**\n\n*   **Analysis of \"Excellent\" Scenario:** The primary process in ligand binding is the change in position and orientation of the ligand relative to the protein. While the protein may undergo conformational changes (induced fit), using the protein backbone RMSD as the sole reaction coordinate is indirect and inefficient. The crucial slow coordinate is the ligand's approach to the binding site. The protein's RMSD does not control this. This is a poor choice of coordinate, not an excellent one.\n*   **Analysis of \"Terrible\" Scenario:** For the unfolding of a simple structural element like an $\\alpha$-helix, the RMSD from the native helical state is often a reasonable, albeit imperfect, reaction coordinate. The process of unfolding (e.g., fraying from the ends) is typically correlated with an increasing RMSD. While other coordinates like the number of native hydrogen bonds might be better, RMSD is not a \"terrible\" choice and is frequently used in such studies.\n*   **Verdict:** The \"excellent\" scenario is poorly conceived, and the \"terrible\" scenario is not necessarily terrible. **Incorrect**.\n\n**C. Excellent: Folding of a $\\beta$-hairpin where registry shifts and misregistered hairpins are common along the pathway in water. Terrible: Isomerization of a buried side-chain rotamer between two $\\chi_1$ states in a tightly packed core, with negligible backbone motion.**\n\n*   **Analysis of \"Excellent\" Scenario:** A $\\beta$-hairpin that can form misregistered structures is a classic example where RMSD fails. A misregistered hairpin can be compact and have a low RMSD value that is similar to a partially formed, correctly registered hairpin. This degeneracy makes RMSD a poor coordinate, as it cannot distinguish between on-pathway and trapped off-pathway states. This scenario is terrible for using RMSD, not excellent.\n*   **Analysis of \"Terrible\" Scenario:** The isomerization of a single side-chain dihedral ($\\chi_1$) is a highly localized event. The change in global RMSD of the protein due to this single flip would be extremely small, likely smaller than the thermal fluctuations of the backbone. Driving such a process with a global RMSD coordinate would be exceptionally inefficient and have a very low signal-to-noise ratio. The dihedral angle itself is the obvious and correct coordinate. Using RMSD is indeed a terrible choice.\n*   **Verdict:** The \"excellent\" scenario described is, in fact, a terrible one. **Incorrect**.\n\n**D. Excellent: Rigid-body ligand binding in which the protein remains essentially native-like and only the ligand translates and rotates into the pocket, using the protein $\\mathrm{RMSD}$ to the holo protein as the coordinate. Terrible: A $1$-dihedral isomerization in a small peptide where a single backbone dihedral angle flips between two minima while other degrees of freedom relax quickly.**\n\n*   **Analysis of \"Excellent\" Scenario:** This scenario is nonsensical. If the protein remains \"essentially native-like,\" its RMSD to the native (holo) structure will remain close to zero and will not change throughout the binding process. A coordinate that does not change cannot describe a process. It possesses no dynamic range and cannot be used to drive the system from the unbound to the bound state. This is an impossible and terrible choice, not an excellent one.\n*   **Analysis of \"Terrible\" Scenario:** Similar to the case in option C, a single dihedral flip is a localized event. A global RMSD coordinate is poorly coupled to this local motion and would be a very inefficient way to sample the transition. The dihedral angle itself would be the proper coordinate. Using global RMSD here is a terrible choice.\n*   **Verdict:** The \"excellent\" scenario is fundamentally flawed and describes a non-functional reaction coordinate. **Incorrect**.\n\n**Conclusion**\n\nOnly option A correctly pairs a situation where RMSD is an appropriate and effective reaction coordinate with a situation where it is fundamentally flawed due to degeneracy and the existence of orthogonal slow degrees of freedom.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once a reaction coordinate is chosen, the next practical step is to design the series of umbrella potentials that will be used to bias the sampling. This involves selecting the harmonic force constant, $k$, and the spacing between adjacent window centers, $\\Delta\\xi$. This problem  guides you through a fundamental calculation to determine these parameters based on the local curvature of the free energy surface and the desired statistical properties of your sampling, such as sampling width and inter-window overlap.",
            "id": "3827385",
            "problem": "In one-dimensional Umbrella Sampling (US) of a reaction coordinate $\\xi$, a harmonic bias $U_{b}(\\xi;\\xi_{0})=\\frac{1}{2}\\,k\\,(\\xi-\\xi_{0})^{2}$ is applied around a window center $\\xi_{0}$ to facilitate sampling of the Potential of Mean Force (PMF). Assume a canonical ensemble at temperature $T$ and that the unbiased PMF near $\\xi_{0}$ is locally quadratic: $F(\\xi)\\approx F(\\xi_{0})+\\frac{1}{2}\\,\\kappa\\,(\\xi-\\xi_{0})^{2}$, where $\\kappa$ is the local curvature (second derivative) of the PMF with respect to $\\xi$. Neglect higher-than-quadratic terms and any spatial variation of $\\kappa$ across the window. Treat $\\xi$ as a one-dimensional Cartesian-like coordinate with units of nanometers. \n\nYou are tasked with designing the harmonic bias to achieve a prescribed within-window sampling width (standard deviation) $\\sigma$ for $\\xi$. Specifically:\n- Choose the force constant $k$ so that the steady-state distribution of $\\xi$ under the biased potential has standard deviation $\\sigma$ around $\\xi_{0}$.\n- To ensure adequate inter-window overlap, select the spacing $\\Delta \\xi$ between neighboring window centers so that the ratio of the biased probability density at the neighborâ€™s center, $\\xi=\\xi_{0}+\\Delta\\xi$, to that at the current center, $\\xi=\\xi_{0}$, equals a prescribed threshold $r^{\\ast}$.\n\nUse the following data:\n- Temperature $T=300\\,\\mathrm{K}$,\n- Target width $\\sigma=0.10\\,\\mathrm{nm}$,\n- Local PMF curvature $\\kappa=100\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$,\n- Overlap threshold $r^{\\ast}=0.30$.\n\nWork in molar energetic units. Use the gas constant $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$, and convert as needed to $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. Express the final $k$ in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$ and $\\Delta\\xi$ in $\\mathrm{nm}$. Round your final answers to three significant figures. Provide your final answers as a pair $\\big(k,\\Delta\\xi\\big)$.",
            "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a unique solution. It describes a standard procedure in computational statistical mechanics for designing Umbrella Sampling simulations. Therefore, we may proceed with the solution.\n\nThe objective is to determine the harmonic bias force constant $k$ and the spacing between adjacent umbrella windows $\\Delta\\xi$.\n\nFirst, we determine the force constant $k$. The total Potential of Mean Force (PMF) experienced by the system within a given sampling window is the sum of the intrinsic, unbiased PMF, $F(\\xi)$, and the applied harmonic bias potential, $U_b(\\xi;\\xi_0)$. The problem provides the following local quadratic forms:\n$$F(\\xi) \\approx F(\\xi_{0}) + \\frac{1}{2}\\,\\kappa\\,(\\xi-\\xi_{0})^{2}$$\n$$U_{b}(\\xi;\\xi_{0}) = \\frac{1}{2}\\,k\\,(\\xi-\\xi_{0})^{2}$$\nThe biased PMF, $F_b(\\xi)$, is their sum:\n$$F_b(\\xi) = F(\\xi) + U_b(\\xi;\\xi_{0}) \\approx \\left( F(\\xi_{0}) + \\frac{1}{2}\\,\\kappa\\,(\\xi-\\xi_{0})^{2} \\right) + \\frac{1}{2}\\,k\\,(\\xi-\\xi_{0})^{2}$$\n$$F_b(\\xi) \\approx F(\\xi_{0}) + \\frac{1}{2}\\,(\\kappa+k)\\,(\\xi-\\xi_{0})^{2}$$\nThis shows that under the local quadratic approximation, the biased system also has a quadratic PMF centered at $\\xi_0$, with an effective spring constant $k_{\\text{eff}} = \\kappa+k$.\n\nIn a canonical ensemble at temperature $T$, the probability distribution of the coordinate $\\xi$ is given by the Boltzmann factor of the PMF. For the biased ensemble, this is:\n$$P_b(\\xi) \\propto \\exp\\left(-\\frac{F_b(\\xi)}{RT}\\right)$$\nwhere $R$ is the molar gas constant. Substituting the expression for $F_b(\\xi)$:\n$$P_b(\\xi) \\propto \\exp\\left(-\\frac{F(\\xi_{0}) + \\frac{1}{2}\\,(\\kappa+k)\\,(\\xi-\\xi_{0})^{2}}{RT}\\right)$$\nThe term $\\exp(-F(\\xi_0)/(RT))$ is a constant and can be absorbed into the normalization constant. Thus, the shape of the distribution is determined by:\n$$P_b(\\xi) \\propto \\exp\\left(-\\frac{(\\kappa+k)(\\xi-\\xi_{0})^{2}}{2RT}\\right)$$\nThis is the functional form of a Gaussian (Normal) distribution, $P(x) \\propto \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma_{\\text{dist}}^2}\\right)$, with mean $\\mu=\\xi_0$ and variance $\\sigma_{\\text{dist}}^2$. By comparing the exponents, we can identify the variance of the biased distribution:\n$$\\frac{1}{2\\sigma_{\\text{dist}}^2} = \\frac{\\kappa+k}{2RT}$$\nThis gives the variance:\n$$\\sigma_{\\text{dist}}^2 = \\frac{RT}{\\kappa+k}$$\nThe problem requires that the standard deviation of this distribution, $\\sigma_{\\text{dist}}$, be equal to the specified target width $\\sigma$. Therefore, $\\sigma_{\\text{dist}}^2 = \\sigma^2$.\n$$\\sigma^2 = \\frac{RT}{\\kappa+k}$$\nWe solve this equation for the unknown bias force constant, $k$:\n$$\\kappa+k = \\frac{RT}{\\sigma^2}$$\n$$k = \\frac{RT}{\\sigma^2} - \\kappa$$\nWe are given the following values: $T=300\\,\\mathrm{K}$, $\\sigma=0.10\\,\\mathrm{nm}$, $\\kappa=100\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$, and $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$. We first convert $R$ to the required energetic units: $R = 0.008314462618\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\nThe thermal energy is:\n$$RT = (0.008314462618\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (300\\,\\mathrm{K}) \\approx 2.49434\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\nNow, we can calculate $k$:\n$$k = \\frac{2.49434\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}}{(0.10\\,\\mathrm{nm})^2} - 100\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$$\n$$k = \\frac{2.49434\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}}{0.010\\,\\mathrm{nm}^2} - 100\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$$\n$$k = 249.434\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2} - 100\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2} = 149.434\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$$\nRounding to three significant figures, we get $k = 149\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}$.\n\nNext, we determine the window spacing $\\Delta\\xi$. This spacing is set by the condition that the ratio of the biased probability density at a neighbor's center, $\\xi=\\xi_{0}+\\Delta\\xi$, to the density at the current window's center, $\\xi=\\xi_{0}$, equals the threshold $r^{\\ast}$.\n$$\\frac{P_b(\\xi_0 + \\Delta\\xi)}{P_b(\\xi_0)} = r^{\\ast}$$\nUsing our expression for $P_b(\\xi)$:\n$$P_b(\\xi_0) \\propto \\exp\\left(-\\frac{(\\kappa+k)(\\xi_0-\\xi_0)^2}{2RT}\\right) = \\exp(0) = 1$$\n$$P_b(\\xi_0 + \\Delta\\xi) \\propto \\exp\\left(-\\frac{(\\kappa+k)((\\xi_0+\\Delta\\xi)-\\xi_0)^2}{2RT}\\right) = \\exp\\left(-\\frac{(\\kappa+k)(\\Delta\\xi)^2}{2RT}\\right)$$\nThe ratio is therefore:\n$$\\exp\\left(-\\frac{(\\kappa+k)(\\Delta\\xi)^2}{2RT}\\right) = r^{\\ast}$$\nFrom our previous derivation, we know that $\\frac{\\kappa+k}{RT} = \\frac{1}{\\sigma^2}$. Substituting this into the equation simplifies it considerably:\n$$\\exp\\left(-\\frac{(\\Delta\\xi)^2}{2\\sigma^2}\\right) = r^{\\ast}$$\nWe now solve for $\\Delta\\xi$. Taking the natural logarithm of both sides:\n$$-\\frac{(\\Delta\\xi)^2}{2\\sigma^2} = \\ln(r^{\\ast})$$\n$$(\\Delta\\xi)^2 = -2\\sigma^2 \\ln(r^{\\ast})$$\nSince $\\Delta\\xi$ is a spacing, we take the positive square root:\n$$\\Delta\\xi = \\sqrt{-2\\sigma^2 \\ln(r^{\\ast})} = \\sigma \\sqrt{-2 \\ln(r^{\\ast})}$$\nSubstituting the given numerical values, $\\sigma = 0.10\\,\\mathrm{nm}$ and $r^{\\ast}=0.30$:\n$$\\Delta\\xi = (0.10\\,\\mathrm{nm}) \\sqrt{-2 \\ln(0.30)}$$\n$$\\Delta\\xi \\approx (0.10\\,\\mathrm{nm}) \\sqrt{-2 \\times (-1.20397)}$$\n$$\\Delta\\xi \\approx (0.10\\,\\mathrm{nm}) \\sqrt{2.40794}$$\n$$\\Delta\\xi \\approx (0.10\\,\\mathrm{nm}) \\times 1.55175 \\approx 0.155175\\,\\mathrm{nm}$$\nRounding to three significant figures gives $\\Delta\\xi = 0.155\\,\\mathrm{nm}$.\n\nThe final requested pair of values $(k, \\Delta\\xi)$ is $(149\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{nm}^{-2}, 0.155\\,\\mathrm{nm})$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 149 & 0.155 \\end{pmatrix}}$$"
        },
        {
            "introduction": "After running a set of umbrella sampling simulations, a critical quality control step is to verify that the sampled distributions from adjacent windows overlap sufficiently. Without adequate overlap, methods like WHAM or MBAR cannot reliably reconstruct the underlying free energy profile. This computational exercise  tasks you with implementing a standard algorithm to quantify histogram overlap, a core skill for validating simulation data and diagnosing potential issues with window placement or sampling time.",
            "id": "2466495",
            "problem": "Consider umbrella sampling along a one-dimensional reaction coordinate discretized into a fixed set of bins shared by all windows. For window index $i \\in \\{0,1,\\dots,N-1\\}$ and bin index $k \\in \\{0,1,\\dots,B-1\\}$, let $c_{i,k} \\ge 0$ denote the observed count in bin $k$ for window $i$. Define the total count for window $i$ as $s_i = \\sum_{k=0}^{B-1} c_{i,k}$. Define the normalized histogram $p_{i,k}$ by\n$$p_{i,k} = \\begin{cases}\n\\dfrac{c_{i,k}}{s_i}, & \\text{if } s_i > 0,\\\\\n0, & \\text{if } s_i = 0.\n\\end{cases}$$\nFor each adjacent pair of windows $(i,i+1)$, define the histogram overlap $O_i$ as\n$$O_i = \\sum_{k=0}^{B-1} \\min\\!\\big(p_{i,k},\\,p_{i+1,k}\\big).$$\nGiven a threshold $\\tau \\in [0,1]$, an adjacent pair $(i,i+1)$ is considered sufficiently overlapping if and only if $O_i \\ge \\tau$. A problematic adjacent region is any pair $(i,i+1)$ with $O_i < \\tau$.\n\nYour task is to write a program that, for each test case below, returns the list of starting indices $i$ for which the adjacent pair $(i,i+1)$ is problematic. If $N < 2$, the list is empty. All windows in a test case share identical binning. The final output must aggregate the lists for all test cases on a single line.\n\nTest suite:\n- Test case $1$:\n  - Windows $N = 4$, bins $B = 5$.\n  - Counts per window (each inner list is $[c_{i,0},c_{i,1},c_{i,2},c_{i,3},c_{i,4}]$):\n    - $i=0$: $[10,20,50,20,0]$\n    - $i=1$: $[0,10,40,40,10]$\n    - $i=2$: $[0,0,5,25,70]$\n    - $i=3$: $[0,0,0,10,90]$\n  - Threshold $\\tau = 0.5$.\n- Test case $2$:\n  - Windows $N = 2$, bins $B = 4$.\n  - Counts:\n    - $i=0$: $[50,50,0,0]$\n    - $i=1$: $[50,0,50,0]$\n  - Threshold $\\tau = 0.5$.\n- Test case $3$:\n  - Windows $N = 3$, bins $B = 3$.\n  - Counts:\n    - $i=0$: $[1,1,1]$\n    - $i=1$: $[0,0,0]$\n    - $i=2$: $[0,5,5]$\n  - Threshold $\\tau = 0.2$.\n- Test case $4$:\n  - Windows $N = 5$, bins $B = 5$.\n  - Counts:\n    - $i=0$: $[100,0,0,0,0]$\n    - $i=1$: $[0,100,0,0,0]$\n    - $i=2$: $[0,0,100,0,0]$\n    - $i=3$: $[0,0,0,100,0]$\n    - $i=4$: $[0,0,0,0,100]$\n  - Threshold $\\tau = 0.01$.\n\nFinal output format:\nYour program should produce a single line of output containing a JSON-like list of the results for the $4$ test cases, in order. Each result must be a list of integers (the starting indices $i$ of problematic adjacent pairs). The single printed line must contain no whitespace characters. For example, a valid format would be $[[1],[0,2],[]]$.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded in the principles of computational statistical mechanics, specifically the analysis of umbrella sampling simulations. It is well-posed, with all necessary data and definitions provided to compute a unique solution. The terminology is objective and formal. We may therefore proceed with the solution.\n\nThe objective is to identify problematic adjacent window pairs in a set of umbrella sampling simulations. A pair is deemed \"problematic\" if the overlap of their sampled distributions along a reaction coordinate is below a specified threshold $\\tau$. This analysis is crucial for ensuring the quality and reliability of a reconstructed potential of mean force.\n\nThe procedure is as follows, for a system of $N$ windows and $B$ bins along the reaction coordinate.\n\nFirst, for each window $i$, where $i \\in \\{0, 1, \\dots, N-1\\}$, we are given the raw counts $c_{i,k}$ for each bin $k \\in \\{0, 1, \\dots, B-1\\}$. These counts represent the frequency with which the system was observed in a particular segment of the reaction coordinate within that specific simulation window.\n\nSecond, we normalize these raw counts to obtain a probability distribution for each window. This requires calculating the total number of samples, $s_i$, for each window $i$:\n$$s_i = \\sum_{k=0}^{B-1} c_{i,k}$$\nThe normalized probability distribution, or histogram, $p_{i,k}$ for window $i$ in bin $k$ is then calculated as the ratio of the bin count to the total count:\n$$p_{i,k} = \\frac{c_{i,k}}{s_i}$$\nA special case must be handled: if a window $i$ has zero total samples, meaning $s_i = 0$, its distribution $p_{i,k}$ is defined as $0$ for all bins $k$. This is a logical necessity to avoid division by zero and correctly represents a window with no data as having zero probability density everywhere.\n\nThird, we quantify the similarity between the distributions of adjacent windows. For each adjacent pair of windows $(i, i+1)$, where $i$ ranges from $0$ to $N-2$, we compute the histogram overlap, $O_i$. This metric is defined as the sum of the minimum probability values across all bins:\n$$O_i = \\sum_{k=0}^{B-1} \\min\\!\\big(p_{i,k},\\,p_{i+1,k}\\big)$$\nThis value, $O_i$, represents the area of intersection between the two normalized histograms and is bounded on the interval $[0, 1]$. A value of $O_i = 1$ indicates identical distributions, while $O_i = 0$ indicates completely non-overlapping distributions.\n\nFinally, we apply the specified criterion to identify problematic regions. An adjacent pair of windows $(i, i+1)$ is classified as problematic if its overlap $O_i$ is less than a given threshold $\\tau \\in [0, 1]$:\n$$O_i < \\tau$$\nThe final output for a given test case is a list of all indices $i$ that satisfy this condition. If the total number of windows $N$ is less than $2$, no adjacent pairs exist, and the list of problematic indices is consequently empty.\n\nThis systematic procedure is applied to each test case to generate the required results. The entire process is a direct computational implementation of the provided definitions.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the umbrella sampling overlap problem for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"counts\": [\n                [10, 20, 50, 20, 0],\n                [0, 10, 40, 40, 10],\n                [0, 0, 5, 25, 70],\n                [0, 0, 0, 10, 90]\n            ],\n            \"tau\": 0.5\n        },\n        {\n            \"counts\": [\n                [50, 50, 0, 0],\n                [50, 0, 50, 0]\n            ],\n            \"tau\": 0.5\n        },\n        {\n            \"counts\": [\n                [1, 1, 1],\n                [0, 0, 0],\n                [0, 5, 5]\n            ],\n            \"tau\": 0.2\n        },\n        {\n            \"counts\": [\n                [100, 0, 0, 0, 0],\n                [0, 100, 0, 0, 0],\n                [0, 0, 100, 0, 0],\n                [0, 0, 0, 100, 0],\n                [0, 0, 0, 0, 100]\n            ],\n            \"tau\": 0.01\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        counts = np.array(case[\"counts\"], dtype=float)\n        tau = case[\"tau\"]\n        N = counts.shape[0]\n\n        if N < 2:\n            results.append([])\n            continue\n\n        # Calculate total counts s_i for each window i\n        s = np.sum(counts, axis=1)\n\n        # Normalize histograms p_i,k\n        # Initialize p with zeros to handle s_i = 0 case\n        p = np.zeros_like(counts)\n        # Find windows where s_i > 0\n        non_zero_s_indices = np.where(s > 0)[0]\n        # Perform normalization only for these windows\n        # s[non_zero_s_indices, np.newaxis] ensures correct broadcasting for division\n        p[non_zero_s_indices] = counts[non_zero_s_indices] / s[non_zero_s_indices, np.newaxis]\n\n        problematic_indices = []\n        # Iterate through adjacent pairs (i, i+1)\n        for i in range(N - 1):\n            p_i = p[i]\n            p_i_plus_1 = p[i+1]\n            \n            # Calculate overlap O_i\n            overlap = np.sum(np.minimum(p_i, p_i_plus_1))\n            \n            # Check if the pair is problematic\n            if overlap < tau:\n                problematic_indices.append(i)\n        \n        results.append(problematic_indices)\n\n    # Format the final output string to exactly match the requirement (no whitespace)\n    result_strings = []\n    for res_list in results:\n        res_str = f\"[{','.join(map(str, res_list))}]\"\n        result_strings.append(res_str)\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}