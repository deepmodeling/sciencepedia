{
    "hands_on_practices": [
        {
            "introduction": "分子识别是一个微妙的平衡过程。一个强大的直接静电吸引，如盐桥，看起来是有利的。然而，这种相互作用发生在蛋白质环境中，这意味着带电基团必须首先从高极性的水溶剂中脱离出来。这种“去溶剂化”过程伴随着巨大的能量代价。本练习使用简化但物理上合理的模型——用于溶剂化的波恩模型和库仑定律——来量化这种权衡，并揭示一个看似强大的相互作用何时实际上可能总体上是不利的。这项练习对于培养对结合过程中各种作用力相互作用的直觉至-关键。",
            "id": "3836686",
            "problem": "您将为一个在结合时形成接触的单一残基，实现一个严格的、单位一致的逐残基结合自由能分解模型。该模型必须基于第一性原理构建，并具有物理基础，使用以下基本要素：\n\n1) 库仑定律，用于计算均匀介电介质中两个点电荷的相互作用能。对于两个点电荷 $q_i$ 和 $q_j$（以基本电荷为单位），在相对介电常数为 $\\varepsilon_\\mathrm{contact}$ 的介质中相隔固定距离 $r$（以纳米为单位），其相互作用能由库仑表达式给出，其中能量单位转换常数为 $k_\\mathrm{c}$：\n$$\nU_\\mathrm{Coulomb} = \\frac{k_\\mathrm{c}\\, q_i q_j}{\\varepsilon_\\mathrm{contact}\\, r}.\n$$\n使用 $k_\\mathrm{c} = 138.935456 \\text{ kJ mol}^{-1} \\text{ nm e}^{-2}$，这样计算出的能量单位直接为 kJ/mol。\n\n2) 玻恩模型，用于计算电荷为 $q$、有效玻恩半径为 $R$ 的单个离子在相对介电常数为 $\\varepsilon$ 的介质中的极性溶剂化自由能。在介质 $\\varepsilon$ 中的极性溶剂化自由能为：\n$$\nG_\\mathrm{polar}(\\varepsilon) = -\\frac{1}{2}\\, k_\\mathrm{c}\\, \\frac{q^2}{R} \\left(1 - \\frac{1}{\\varepsilon}\\right).\n$$\n将一个残基的电荷从水（相对介电常数 $\\varepsilon_\\mathrm{w}$）转移到类蛋白质内部（相对介电常数 $\\varepsilon_\\mathrm{p}$）的极性溶剂化自由能变化，可通过热力学循环的差值获得：\n$$\n\\Delta G_\\mathrm{polar}^{\\mathrm{desolv}} = G_\\mathrm{polar}(\\varepsilon_\\mathrm{p}) - G_\\mathrm{polar}(\\varepsilon_\\mathrm{w}) = \\frac{1}{2}\\, k_\\mathrm{c}\\, \\frac{q^2}{R} \\left(\\frac{1}{\\varepsilon_\\mathrm{p}} - \\frac{1}{\\varepsilon_\\mathrm{w}}\\right).\n$$\n\n3) 一个与埋藏的溶剂可及表面积成正比的线性非极性项。设 $\\Delta A_\\mathrm{buried}$ 为结合时埋藏的面积（以平方埃为单位），假定为非负值。非极性贡献建模为\n$$\n\\Delta G_\\mathrm{nonpolar} = - \\gamma\\, \\Delta A_\\mathrm{buried},\n$$\n表面张力系数 $\\gamma$ 在下文指定。\n\n那么，逐残基结合自由能贡献是直接接触获得的能量与从水转移到蛋白质内部时溶剂化变化的能量之和：\n$$\n\\Delta G_\\mathrm{bind}^{(i)} = U_\\mathrm{Coulomb}^{(i)} + \\Delta G_\\mathrm{polar,\\,desolv}^{(i)} + \\Delta G_\\mathrm{nonpolar}^{(i)}.\n$$\n\n您的任务是构建一个程序，为一组测试用例计算 $\\Delta G_\\mathrm{bind}^{(i)}$。这些测试用例展示了有利的直接相互作用被不利的溶剂化变化所抵消的情景，并量化每种情况下的净贡献。所有距离 $r$ 和半径 $R$ 的单位为纳米，面积 $\\Delta A_\\mathrm{buried}$ 的单位为 Å$^2$，最终能量必须以 kJ/mol 报告。\n\n在所有计算中使用以下常量：\n- 库仑能量前置因子：$k_c = 138.935456 \\text{ kJ mol}^{-1} \\text{ nm e}^{-2}$。\n- 水的相对介电常数：$\\varepsilon_\\mathrm{w} = 80.0$。\n- 蛋白质内部有效相对介电常数：$\\varepsilon_\\mathrm{p} = 4.0$。\n- 非极性表面张力：$\\gamma = 0.022 \\text{ kJ mol}^{-1} \\text{ Å}^{-2}$。\n\n测试套件。对于每个案例，参数以元组 $(q_i, q_j, r, \\varepsilon_\\mathrm{contact}, R, \\Delta A_\\mathrm{buried})$ 的形式给出：\n- 案例1（强接触，低介电常数接触区域）：$(+1.0, -1.0, 0.30, 4.0, 0.16, 50.0)$。\n- 案例2（相同的电荷和半径，接触区域更水合，介电常数更高）：$(+1.0, -1.0, 0.35, 20.0, 0.16, 30.0)$。\n- 案例3（中性残基；测试只有非极性埋藏起作用的边界情况）：$(0.0, 0.0, 0.35, 4.0, 0.20, 120.0)$。\n\n程序要求：\n- 完全按照所述实现上述物理模型。\n- 对每个测试用例，计算 $\\Delta G_\\mathrm{bind}^{(i)}$，单位为 kJ/mol。\n- 将每个结果四舍五入到三位小数。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果，例如 $[\\text{result1},\\text{result2},\\text{result3}]$。\n\n科学真实性约束：\n- 确保没有遗漏单位换算。使用单位为纳米的 $r$ 和 $R$，单位为 Å$^2$ 的 $\\Delta A_\\mathrm{buried}$，以及给定的常量。\n- 角度单位在此不适用。\n- 所有最终数值输出均以 kJ/mol 表示，并按要求四舍五入到三位小数。",
            "solution": "问题陈述已经过严格评估，被认为是有效的。它在科学上基于已建立的（尽管是简化的）物理模型（库仑定律、玻恩模型和基于表面积的非极性模型），对于每组给定的参数，问题都定义良好且有唯一解，并且没有歧义或矛盾。所有必要的常数和参数都已提供。因此，我们可以着手求解。\n\n目标是为三个不同的案例计算逐残基结合自由能贡献 $\\Delta G_\\mathrm{bind}^{(i)}$。该量被定义为三个组分的总和：接触时直接的静电相互作用能（$U_\\mathrm{Coulomb}^{(i)}$）、残基从高介电常数的溶剂转移到低介电常数的蛋白质环境所引起的极性溶剂化自由能变化（$\\Delta G_\\mathrm{polar,\\,desolv}^{(i)}$），以及埋藏溶剂可及表面积所产生的非极性贡献（$\\Delta G_\\mathrm{nonpolar}^{(i)}$）。\n\n控制方程为：\n$$\n\\Delta G_\\mathrm{bind}^{(i)} = U_\\mathrm{Coulomb}^{(i)} + \\Delta G_\\mathrm{polar,\\,desolv}^{(i)} + \\Delta G_\\mathrm{nonpolar}^{(i)}\n$$\n\n各项的模型提供如下：\n1.  库仑能量：$U_\\mathrm{Coulomb}^{(i)} = \\frac{k_\\mathrm{c}\\, q_i q_j}{\\varepsilon_\\mathrm{contact}\\, r}$\n2.  极性去溶剂化能：$\\Delta G_\\mathrm{polar,\\,desolv}^{(i)} = \\frac{1}{2}\\, k_\\mathrm{c}\\, \\frac{q_i^2}{R} \\left(\\frac{1}{\\varepsilon_\\mathrm{p}} - \\frac{1}{\\varepsilon_\\mathrm{w}}\\right)$\n3.  非极性能力：$\\Delta G_\\mathrm{nonpolar}^{(i)} = - \\gamma\\, \\Delta A_\\mathrm{buried}$\n\n我们使用以下物理常数：\n- 库仑能量前置因子：$k_\\mathrm{c} = 138.935456 \\text{ kJ mol}^{-1} \\text{ nm e}^{-2}$\n- 水的相对介电常数：$\\varepsilon_\\mathrm{w} = 80.0$\n- 蛋白质内部相对介电常数：$\\varepsilon_\\mathrm{p} = 4.0$\n- 非极性表面张力系数：$\\gamma = 0.022 \\text{ kJ mol}^{-1} \\text{ Å}^{-2}$\n\n我们现在为每个测试用例计算 $\\Delta G_\\mathrm{bind}^{(i)}$。\n\n**案例1：强接触，低介电常数接触区域**\n参数为 $(q_i, q_j, r, \\varepsilon_\\mathrm{contact}, R, \\Delta A_\\mathrm{buried}) = (+1.0, -1.0, 0.30, 4.0, 0.16, 50.0)$。\n\n- 直接静电相互作用能为：\n$$\nU_\\mathrm{Coulomb}^{(1)} = \\frac{(138.935456) \\cdot (+1.0) \\cdot (-1.0)}{4.0 \\cdot 0.30} = \\frac{-138.935456}{1.2} \\approx -115.77955 \\text{ kJ/mol}\n$$\n由于在低介电环境中，相反的电荷距离很近，该项非常有利。\n\n- 极性去溶剂化能是为电荷 $q_i = +1.0 \\,e$ 计算的。该项代表将电荷从高极性的水环境移动到极性较低的蛋白质内部的惩罚。\n$$\n\\Delta G_\\mathrm{polar,\\,desolv}^{(1)} = \\frac{1}{2}\\,(138.935456)\\,\\frac{(+1.0)^2}{0.16} \\left(\\frac{1}{4.0} - \\frac{1}{80.0}\\right)\n$$\n$$\n= \\frac{138.935456}{0.32} (0.25 - 0.0125) = 434.1733 \\cdot (0.2375) \\approx +103.11827 \\text{ kJ/mol}\n$$\n正如对一个完整基本电荷进行去溶剂化所预期的那样，该项非常不利。\n\n- 埋藏表面积的非极性贡献为：\n$$\n\\Delta G_\\mathrm{nonpolar}^{(1)} = -(0.022) \\cdot (50.0) = -1.1 \\text{ kJ/mol}\n$$\n这是一个小的、有利的贡献。\n\n- 在此案例中，残基 $i$ 的总结合自由能是各项之和：\n$$\n\\Delta G_\\mathrm{bind}^{(1)} = -115.77955 + 103.11827 - 1.1 = -13.76128 \\text{ kJ/mol}\n$$\n四舍五入到三位小数后，结果为 $-13.761$ kJ/mol。有利的直接接触能足以补偿巨大的去溶剂化惩罚。\n\n**案例2：更水合的接触，介电常数更高**\n参数为 $(q_i, q_j, r, \\varepsilon_\\mathrm{contact}, R, \\Delta A_\\mathrm{buried}) = (+1.0, -1.0, 0.35, 20.0, 0.16, 30.0)$。\n\n- 由于距离增加（$r = 0.35$ nm）和接触区域介电常数更高（$\\varepsilon_\\mathrm{contact} = 20.0$），直接静电相互作用减弱。\n$$\nU_\\mathrm{Coulomb}^{(2)} = \\frac{(138.935456) \\cdot (+1.0) \\cdot (-1.0)}{20.0 \\cdot 0.35} = \\frac{-138.935456}{7.0} \\approx -19.84792 \\text{ kJ/mol}\n$$\n- 极性去溶剂化惩罚取决于 $q_i$ 和 $R$，它们与案例1中的值（$q_i = +1.0 \\,e, R = 0.16$ nm）相同。因此，该值是相同的：\n$$\n\\Delta G_\\mathrm{polar,\\,desolv}^{(2)} \\approx +103.11827 \\text{ kJ/mol}\n$$\n- 由于埋藏面积较小，非极性贡献也较小：\n$$\n\\Delta G_\\mathrm{nonpolar}^{(2)} = -(0.022) \\cdot (30.0) = -0.66 \\text{ kJ/mol}\n$$\n- 总结合自由能贡献为：\n$$\n\\Delta G_\\mathrm{bind}^{(2)} = -19.84792 + 103.11827 - 0.66 = +82.61035 \\text{ kJ/mol}\n$$\n四舍五入到三位小数后，结果为 $+82.610$ kJ/mol。在这种情况下，减弱的直接相互作用不足以克服巨大的去溶剂化惩罚，导致一个非常不利的净贡献。\n\n**案例3：中性残基**\n参数为 $(q_i, q_j, r, \\varepsilon_\\mathrm{contact}, R, \\Delta A_\\mathrm{buried}) = (0.0, 0.0, 0.35, 4.0, 0.20, 120.0)$。\n\n- 对于中性残基，$q_i = 0.0 \\,e$。两个静电项均为零。\n$$\nU_\\mathrm{Coulomb}^{(3)} = \\frac{k_\\mathrm{c}\\,(0.0)\\,(0.0)}{\\varepsilon_\\mathrm{contact}\\,r} = 0.0 \\text{ kJ/mol}\n$$\n$$\n\\Delta G_\\mathrm{polar,\\,desolv}^{(3)} = \\frac{1}{2}\\,k_\\mathrm{c}\\,\\frac{(0.0)^2}{R}\\left(\\frac{1}{\\varepsilon_\\mathrm{p}} - \\frac{1}{\\varepsilon_\\mathrm{w}}\\right) = 0.0 \\text{ kJ/mol}\n$$\n- 唯一的贡献来自非极性项，由于埋藏了相当大的表面积。\n$$\n\\Delta G_\\mathrm{nonpolar}^{(3)} = -(0.022) \\cdot (120.0) = -2.64 \\text{ kJ/mol}\n$$\n- 总结合自由能贡献为：\n$$\n\\Delta G_\\mathrm{bind}^{(3)} = 0.0 + 0.0 - 2.64 = -2.64 \\text{ kJ/mol}\n$$\n四舍五入到三位小数后，结果为 $-2.640$ kJ/mol。该相互作用完全由疏水效应驱动。\n\n三个案例的最终计算值，四舍五入到三位小数后，分别为：$-13.761$、$82.610$ 和 $-2.640$ kJ/mol。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes per-residue binding free energy contributions based on a simplified\n    physical model incorporating Coulomb, Born (polar solvation), and nonpolar terms.\n    \"\"\"\n\n    # Define physical constants as provided in the problem statement.\n    K_C = 138.935456  # Coulomb constant in kJ/mol * nm / e^2\n    EPSILON_W = 80.0    # Relative permittivity of water\n    EPSILON_P = 4.0     # Relative permittivity of protein interior\n    GAMMA = 0.022       # Nonpolar surface tension in kJ/mol / Angstrom^2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (q_i, q_j, r, epsilon_contact, R, delta_A_buried)\n    test_cases = [\n        (1.0, -1.0, 0.30, 4.0, 0.16, 50.0),   # Case 1\n        (1.0, -1.0, 0.35, 20.0, 0.16, 30.0),  # Case 2\n        (0.0, 0.0, 0.35, 4.0, 0.20, 120.0),   # Case 3\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        q_i, q_j, r, epsilon_contact, R, delta_A_buried = case\n\n        # 1. Calculate the Coulomb interaction energy term\n        # This term is non-zero only if both charges and the distance are non-zero.\n        # The equation holds as long as r is not zero.\n        if r > 0 and epsilon_contact > 0:\n            u_coulomb = (K_C * q_i * q_j) / (epsilon_contact * r)\n        else:\n            # Handle potential division by zero, although not expected in test cases.\n            u_coulomb = 0.0\n\n        # 2. Calculate the polar desolvation free energy term\n        # This term is non-zero only if the charge q_i and its Born radius R are non-zero.\n        if R > 0:\n            delta_g_polar = 0.5 * K_C * (q_i**2 / R) * (1/EPSILON_P - 1/EPSILON_W)\n        else:\n            delta_g_polar = 0.0\n\n        # 3. Calculate the nonpolar free energy term\n        delta_g_nonpolar = -GAMMA * delta_A_buried\n\n        # 4. Sum the components to get the total binding free energy contribution\n        delta_g_bind = u_coulomb + delta_g_polar + delta_g_nonpolar\n\n        # Round the final result to three decimal places as required.\n        results.append(round(delta_g_bind, 3))\n\n    # Format the final output string exactly as specified.\n    # Using np.format_float_positional to ensure trailing zeros are included for rounding.\n    formatted_results = [np.format_float_positional(res, precision=3, fractional=True, pad_right=3) for res in results]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "除了极性相互作用外，非极性效应，通常统称为“疏水效应”，也是结合的主要驱动力。本练习深入探讨了结合自由能的非极性贡献，并将其分解为两种不同的物理现象。我们将使用溶剂可及表面积（$SASA$）来模拟在溶剂中形成空腔的能量成本，并利用源自统计力学的线性响应模型来探索溶质与溶剂之间有利的色散相互作用。这项练习提供了一种实用的方法来计算这些经常被忽视但至关重要的能量项。",
            "id": "3836702",
            "problem": "给定一个基于统计力学和物理化学的任务，要求计算受体和配体结合时非极性溶剂化自由能的变化。结合时非极性溶剂化自由能的变化定义为复合物的非极性溶剂化自由能与分离的受体和配体的非极性溶剂化自由能之和的差值。请从以下基本依据出发：\n\n- 将溶质耦合到溶剂中相关的自由能变化可以用一个耦合参数 $\\lambda$ 来表示，该参数将溶质和溶剂之间的相互作用哈密顿量从 $\\lambda = 0$（无相互作用）缩放到 $\\lambda = 1$（完全相互作用）。可逆功（自由能变化）由哈密顿量对 $\\lambda$ 的导数的系综平均值的积分给出。\n- 非极性溶剂化自由能被分解为空腔形成贡献和色散（范德华）贡献。空腔项使用溶剂可及表面积（SASA）和一个宏观表面张力系数进行建模。\n- 溶质与溶剂在完全耦合时的色散相互作用能可作为系综平均值获得，并可在线性响应近似内处理，其中在中间 $\\lambda$ 处的系综平均值随 $\\lambda$ 线性变化。\n\n仅使用这些依据，推导一个关于结合时非极性溶剂化自由能变化的明确、可计算的表达式，该表达式用以下各项表示：\n- 受体、配体和复合物的溶剂可及表面积。\n- 一个表面张力系数。\n- 受体、配体和复合物在完全耦合时的系综平均溶质-溶剂色散相互作用能。\n\n假设计算采用以下建模选择和数据约定：\n- 溶质的空腔形成自由能与其溶剂可及表面积成正比，比例系数等于一个单位相同的表面张力参数，且无常数偏移项。\n- 在线性响应模型下，溶质的色散贡献使用耦合参数积分和系综平均值随耦合参数线性缩放来计算。\n- 结合时的变化计算为复合物的自由能减去分离的受体和配体的自由能之和。\n\n所有能量必须以千焦耳/摩尔（kJ/mol）表示。所有表面积必须以平方纳米（nm$^2$）表示。表面张力系数必须以 kJ mol$^{-1}$ nm$^{-2}$ 表示。每个测试用例最终报告的结合时非极性溶剂化自由能变化必须以 kJ/mol 为单位，并四舍五入到三位小数。\n\n在程序中实现您的推导，以处理以下测试套件。每个测试用例是一个元组，包含：\n- 表面张力系数 $\\gamma$（单位：kJ mol$^{-1}$ nm$^{-2}$）。\n- 溶剂可及表面积：$\\mathrm{SASA}_\\mathrm{R}$、$\\mathrm{SASA}_\\mathrm{L}$、$\\mathrm{SASA}_\\mathrm{C}$（单位：nm$^2$）。\n- 完全耦合时的系综平均溶质-溶剂色散相互作用能：$U_\\mathrm{R}$、$U_\\mathrm{L}$、$U_\\mathrm{C}$（单位：kJ/mol）。\n\n使用以下具有科学合理值的测试套件：\n- 用例 $1$：$\\gamma = 2.20$, $\\mathrm{SASA}_\\mathrm{R} = 120.0$, $\\mathrm{SASA}_\\mathrm{L} = 15.0$, $\\mathrm{SASA}_\\mathrm{C} = 125.0$, $U_\\mathrm{R} = -800.0$, $U_\\mathrm{L} = -140.0$, $U_\\mathrm{C} = -870.0$。\n- 用例 $2$：$\\gamma = 2.20$, $\\mathrm{SASA}_\\mathrm{R} = 100.0$, $\\mathrm{SASA}_\\mathrm{L} = 20.0$, $\\mathrm{SASA}_\\mathrm{C} = 105.0$, $U_\\mathrm{R} = -600.0$, $U_\\mathrm{L} = -150.0$, $U_\\mathrm{C} = -710.0$。\n- 用例 $3$：$\\gamma = 2.20$, $\\mathrm{SASA}_\\mathrm{R} = 80.0$, $\\mathrm{SASA}_\\mathrm{L} = 10.0$, $\\mathrm{SASA}_\\mathrm{C} = 90.0$, $U_\\mathrm{R} = -500.0$, $U_\\mathrm{L} = -80.0$, $U_\\mathrm{C} = -560.0$。\n- 用例 $4$：$\\gamma = 0.00$, $\\mathrm{SASA}_\\mathrm{R} = 110.0$, $\\mathrm{SASA}_\\mathrm{L} = 12.0$, $\\mathrm{SASA}_\\mathrm{C} = 118.0$, $U_\\mathrm{R} = -700.0$, $U_\\mathrm{L} = -100.0$, $U_\\mathrm{C} = -790.0$。\n- 用例 $5$：$\\gamma = 2.20$, $\\mathrm{SASA}_\\mathrm{R} = 90.0$, $\\mathrm{SASA}_\\mathrm{L} = 15.0$, $\\mathrm{SASA}_\\mathrm{C} = 105.0$, $U_\\mathrm{R} = -650.0$, $U_\\mathrm{L} = -120.0$, $U_\\mathrm{C} = -770.0$。\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表形式的结果（例如，$[x_1,x_2,x_3,x_4,x_5]$），其中每个 $x_i$ 是按上述顺序列出的相应测试用例计算出的结合时非极性溶剂化自由能变化（单位：kJ/mol，四舍五入到三位小数）。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上植根于应用于物理化学的统计力学原理，特别是在分子模拟和自由能计算的背景下。该问题是良构、客观且内部一致的，为得出唯一解提供了所有必要的定义、变量和数据。推导过程从所提供的基本原理开始。\n\n主要目标是推导结合时非极性溶剂化自由能变化 $\\Delta\\Delta G_{\\mathrm{np}}$ 的表达式。该量定义为受体-配体复合物（$\\mathrm{C}$）的非极性溶剂化自由能与单个受体（$\\mathrm{R}$）和配体（$\\mathrm{L}$）的非极性溶剂化自由能之和的差值。\n$$\n\\Delta\\Delta G_{\\mathrm{np}} = \\Delta G_{\\mathrm{np}}(\\mathrm{C}) - \\left( \\Delta G_{\\mathrm{np}}(\\mathrm{R}) + \\Delta G_{\\mathrm{np}}(\\mathrm{L}) \\right)\n$$\n\n对于任何给定的溶质 $X$（其中 $X$ 可以是 $\\mathrm{R}$、$\\mathrm{L}$ 或 $\\mathrm{C}$），其非极性溶剂化自由能 $\\Delta G_{\\mathrm{np}}$ 分解为两个贡献：空腔形成项 $\\Delta G_{\\mathrm{cav}}$ 和色散相互作用项 $\\Delta G_{\\mathrm{disp}}$。\n$$\n\\Delta G_{\\mathrm{np}}(X) = \\Delta G_{\\mathrm{cav}}(X) + \\Delta G_{\\mathrm{disp}}(X)\n$$\n\n首先，我们推导空腔形成项 $\\Delta G_{\\mathrm{cav}}(X)$ 的表达式。问题陈述指出，该项与溶质的溶剂可及表面积（$\\mathrm{SASA}_X$）成正比，比例系数等于表面张力 $\\gamma$。\n$$\n\\Delta G_{\\mathrm{cav}}(X) = \\gamma \\cdot \\mathrm{SASA}_X\n$$\n\n接下来，我们推导色散项 $\\Delta G_{\\mathrm{disp}}(X)$ 的表达式。问题提供了关于耦合参数 $\\lambda$ 的自由能变化的基本热力学积分公式：\n$$\n\\Delta G_{\\mathrm{disp}}(X) = \\int_0^1 \\left\\langle \\frac{\\partial H(\\lambda)}{\\partial \\lambda} \\right\\rangle_\\lambda d\\lambda\n$$\n这里，$H(\\lambda)$ 是体系的哈密顿量，$\\lambda$ 耦合了溶质-溶剂的色散相互作用，将其从 $\\lambda=0$ 时的 $0$（无相互作用）缩放到 $\\lambda=1$ 时的 $1$（完全相互作用）。项 $\\frac{\\partial H(\\lambda)}{\\partial \\lambda}$ 代表溶质-溶剂色散相互作用势。其在给定 $\\lambda$ 下的系综平均值表示为 $\\langle U_{\\mathrm{disp},X}(\\lambda) \\rangle$。因此，表达式变为：\n$$\n\\Delta G_{\\mathrm{disp}}(X) = \\int_0^1 \\langle U_{\\mathrm{disp},X}(\\lambda) \\rangle d\\lambda\n$$\n问题指定使用线性响应近似（LRA），该近似假设系综平均相互作用能随耦合参数 $\\lambda$ 线性变化。设 $U_X$ 为完全耦合（$\\lambda=1$）时的系综平均溶质-溶剂色散相互作用能。因此，LRA 模型为：\n$$\n\\langle U_{\\mathrm{disp},X}(\\lambda) \\rangle = \\lambda \\cdot \\langle U_{\\mathrm{disp},X}(\\lambda=1) \\rangle = \\lambda U_X\n$$\n这种线性关系成立，因为在 $\\lambda=0$ 时相互作用能为零。将 LRA 代入积分中得到：\n$$\n\\Delta G_{\\mathrm{disp}}(X) = \\int_0^1 (\\lambda U_X) d\\lambda = U_X \\int_0^1 \\lambda d\\lambda = U_X \\left[ \\frac{\\lambda^2}{2} \\right]_0^1 = U_X \\left( \\frac{1^2}{2} - \\frac{0^2}{2} \\right) = \\frac{1}{2} U_X\n$$\n\n现在，我们可以写出单个溶质 $X$ 的非极性溶剂化自由能的完整表达式：\n$$\n\\Delta G_{\\mathrm{np}}(X) = \\gamma \\cdot \\mathrm{SASA}_X + \\frac{1}{2} U_X\n$$\n\n最后，我们将此表达式代入结合时变化 $\\Delta\\Delta G_{\\mathrm{np}}$ 的定义中：\n$$\n\\Delta\\Delta G_{\\mathrm{np}} = \\left(\\gamma \\cdot \\mathrm{SASA}_{\\mathrm{C}} + \\frac{1}{2} U_{\\mathrm{C}}\\right) - \\left[ \\left(\\gamma \\cdot \\mathrm{SASA}_{\\mathrm{R}} + \\frac{1}{2} U_{\\mathrm{R}}\\right) + \\left(\\gamma \\cdot \\mathrm{SASA}_{\\mathrm{L}} + \\frac{1}{2} U_{\\mathrm{L}}\\right) \\right]\n$$\n按表面张力系数 $\\gamma$ 和色散能 $U_X$ 对各项进行分组，得到最终的可计算表达式：\n$$\n\\Delta\\Delta G_{\\mathrm{np}} = \\gamma \\left( \\mathrm{SASA}_{\\mathrm{C}} - \\mathrm{SASA}_{\\mathrm{R}} - \\mathrm{SASA}_{\\mathrm{L}} \\right) + \\frac{1}{2} \\left( U_{\\mathrm{C}} - U_{\\mathrm{R}} - U_{\\mathrm{L}} \\right)\n$$\n此方程被用于计算所提供测试套件所需的值。表面积的变化 $\\Delta\\mathrm{SASA} = \\mathrm{SASA}_{\\mathrm{C}} - \\mathrm{SASA}_{\\mathrm{R}} - \\mathrm{SASA}_{\\mathrm{L}}$ 通常为负值，表示在复合物形成时被掩埋的表面积。色散相互作用能的变化 $\\Delta U = U_{\\mathrm{C}} - U_{\\mathrm{R}} - U_{\\mathrm{L}}$ 反映了溶质与溶剂之间范德华相互作用的净变化。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the change in nonpolar solvation free energy upon binding\n    for a series of test cases based on a derived formula.\n    \"\"\"\n    \n    # Test suite from the problem statement.\n    # Each tuple contains:\n    # (gamma, sasa_r, sasa_l, sasa_c, u_r, u_l, u_c)\n    # gamma: surface tension coefficient (kJ mol^-1 nm^-2)\n    # sasa_x: solvent-accessible surface area (nm^2) for Receptor, Ligand, Complex\n    # u_x: ensemble-avg dispersion energy (kJ/mol) for Receptor, Ligand, Complex\n    test_cases = [\n        (2.20, 120.0, 15.0, 125.0, -800.0, -140.0, -870.0),\n        (2.20, 100.0, 20.0, 105.0, -600.0, -150.0, -710.0),\n        (2.20, 80.0, 10.0, 90.0, -500.0, -80.0, -560.0),\n        (0.00, 110.0, 12.0, 118.0, -700.0, -100.0, -790.0),\n        (2.20, 90.0, 15.0, 105.0, -650.0, -120.0, -770.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, sasa_r, sasa_l, sasa_c, u_r, u_l, u_c = case\n\n        # Calculate the change in solvent-accessible surface area upon binding.\n        # This is the surface area of the complex minus the sum for the separate molecules.\n        delta_sasa = sasa_c - (sasa_r + sasa_l)\n\n        # Calculate the change in the solute-solvent dispersion interaction energy.\n        delta_u = u_c - (u_r + u_l)\n\n        # The final formula for the change in nonpolar solvation free energy is:\n        # delta_delta_G_np = gamma * delta_sasa + 0.5 * delta_u\n        delta_delta_g_np = gamma * delta_sasa + 0.5 * delta_u\n        \n        # Format the result to three decimal places and add to the list.\n        results.append(f\"{delta_delta_g_np:.3f}\")\n\n    # Print the final results in the specified comma-separated list format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在分别考察了极性和非极性组分之后，我们现在将它们整合到一个完整的、基于残基的分解方法中，这是一种识别结合“热点”的核心技术。在本练习中，您将实施一个完整的MM/GBSA风格的分解，计算结合界面上每个残基的范德华、静电、极性溶剂化和非极性溶剂化贡献。这种计算模型的最终检验标准是其预测实验结果的能力；因此，您将把自己计算的残基贡献与突变后结合亲和力变化的实验数据进行关联。这项练习弥合了理论计算与实验验证之间的鸿沟。",
            "id": "3836709",
            "problem": "您的任务是在分子力学/广义波恩表面积 (MM/GBSA) 框架内，实现一种基于原理的逐残基结合自由能分解方法，并根据实验测定的突变自由能变化来评估其预测能力。目标是基于对加和力场和连续介质溶剂化近似，从第一性原理出发显式地构建逐残基结合贡献，然后量化这些分解的能量预测与实验测量的突变所致结合自由能变化之间的相关性。\n\n基本和建模假设：\n- 根据平衡统计力学，受体与配体之间的结合自由能由亥姆霍兹自由能的差值定义，并通过 $ \\Delta G_{\\text{bind}} = - k_{\\mathrm{B}} T \\ln K_{\\mathrm{a}} $ 与平衡结合常数相关，其中 $ k_{\\mathrm{B}} $ 是玻尔兹曼常数，$ T $ 是温度。在具有对加和势的经典分子力学中，势能是分配给原子和残基的相互作用项的总和。在连续介质静电学中，极性溶剂化贡献由广义波恩理论建模，非极性项近似为与溶剂可及表面积成正比。\n- 在 MM/GBSA（分子力学/广义波恩表面积）的逐残基分解中，残基 $ i $ 的结合贡献近似为其在结合态的能量分量与在分离（未结合）态的能量分量之差。此处考虑的分量是分子力学范德华力、库仑静电、广义波恩极性溶剂化以及基于表面积的非极性溶剂化。此分解中不包括残基水平的熵项，所报告的能量是以千卡/摩尔 (kcal/mol) 表示的焓分量。\n\n程序要求：\n- 对于每个残基 $ i $，将其逐残基结合贡献定义为结合态中四个能量分量（范德华力、库仑、极性溶剂化、非极性溶剂化）的总和减去分离态中相应分量的总和。每个残基的结果必须以千卡/摩尔 (kcal/mol) 为单位返回。\n- 通过假设突变为丙氨酸或突变为一个移除特定侧链相互作用的残基，会近似地移除该残基的结合贡献，来预测每个残基由突变引起的结合自由能变化。在此近似下，残基 $ i $ 的预测实验突变自由能变化为 $ \\widehat{\\Delta \\Delta G}_i = - \\Delta G^{\\text{res}}_i $，以千卡/摩尔 (kcal/mol) 表示。\n- 对于每个测试用例，评估所有残基的预测值 $ \\widehat{\\Delta \\Delta G}_i $ 与实验测量值 $ \\Delta \\Delta G^{\\text{exp}}_i $ 之间的皮尔逊相关系数。皮尔逊相关系数是无量纲的。本任务中不涉及角度（如有）。\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素是按下方顺序排列的一个测试用例的皮尔逊相关系数（浮点数），共三个值。不应打印任何其他文本。\n\n测试套件（每个残基和分量的能量单位为千卡/摩尔；数组按索引对齐；所有数值均为每个残基的数据）：\n\n测试用例 $1$（理想情况；预期有强正相关）：\n- 结合态范德华：$[-1.8, -0.5, -2.2, -0.9, -0.2, -1.0]$\n- 结合态库仑：$[-1.2, 0.4, -0.8, -0.1, 0.3, -0.5]$\n- 结合态广义波恩（极性）：$[0.9, -0.2, 0.6, 0.1, -0.1, 0.4]$\n- 结合态表面积（非极性）：$[-0.2, -0.05, -0.15, -0.08, -0.02, -0.1]$\n- 分离态范德华：$[-0.6, -0.2, -0.8, -0.4, -0.1, -0.3]$\n- 分离态库仑：$[-0.5, 0.1, -0.2, 0.0, 0.1, -0.1]$\n- 分离态广义波恩（极性）：$[0.4, -0.1, 0.3, 0.05, -0.05, 0.2]$\n- 分离态表面积（非极性）：$[-0.08, -0.02, -0.05, -0.03, -0.01, -0.04]$\n- 实验 $ \\Delta \\Delta G $：$[1.6, 0.2, 1.7, 0.5, -0.1, 0.9]$\n\n测试用例 $2$（反相关；预期有大的负相关）：\n- 结合态范德华：$[-0.7, -1.5, -0.3, -1.1, -0.4]$\n- 结合态库仑：$[0.2, -0.6, 0.1, -0.3, -0.2]$\n- 结合态广义波恩（极性）：$[-0.1, 0.5, -0.05, 0.2, 0.1]$\n- 结合态表面积（非极性）：$[-0.05, -0.12, -0.02, -0.08, -0.03]$\n- 分离态范德华：$[-0.5, -0.9, -0.2, -0.6, -0.3]$\n- 分离态库仑：$[0.1, -0.3, 0.0, -0.1, -0.1]$\n- 分离态广义波恩（极性）：$[-0.05, 0.2, -0.02, 0.1, 0.05]$\n- 分离态表面积（非极性）：$[-0.02, -0.06, -0.01, -0.04, -0.02]$\n- 实验 $ \\Delta \\Delta G $：$[-0.15, -0.7, -0.05, -0.6, -0.2]$\n\n测试用例 $3$（边界情况；预期相关性接近于零）：\n- 结合态范德华：$[-0.6, -0.2, -1.1, -0.05, -0.8, -0.3, -0.9]$\n- 结合态库仑：$[-0.3, 0.05, -0.2, 0.0, -0.4, 0.1, -0.1]$\n- 结合态广义波恩（极性）：$[0.25, -0.02, 0.3, 0.01, 0.35, -0.01, 0.2]$\n- 结合态表面积（非极性）：$[-0.06, -0.01, -0.09, -0.005, -0.07, -0.02, -0.08]$\n- 分离态范德华：$[-0.4, -0.1, -0.5, -0.02, -0.6, -0.2, -0.7]$\n- 分离态库仑：$[-0.2, 0.02, -0.1, 0.0, -0.3, 0.05, -0.05]$\n- 分离态广义波恩（极性）：$[0.1, -0.01, 0.15, 0.005, 0.2, -0.005, 0.1]$\n- 分离态表面积（非极性）：$[-0.03, -0.005, -0.04, -0.002, -0.035, -0.01, -0.04]$\n- 实验 $ \\Delta \\Delta G $：$[0.3, -0.1, 0.2, 0.05, -0.05, 0.12, -0.08]$\n\n答案规格：\n- 最终输出必须是单行：一个用方括号括起来的逗号分隔列表，按顺序包含测试用例 $1$、测试用例 $2$ 和测试用例 $3$ 的皮尔逊相关系数（浮点数），无多余的空白字符或文本。相关系数是无量纲的。所有能量计算必须以千卡/摩尔 (kcal/mol) 为单位进行。",
            "solution": "该问题要求基于分子力学/广义波恩表面积 (MM/GBSA) 框架实现一种逐残基结合自由能分解方法。该方法的预测准确性将通过使用皮尔逊相关系数，比较其对突变自由能变化的预测与实验数据来进行评估。该问题具有科学依据，定义明确（良定），并为获得唯一解提供了所有必要的数据和定义。\n\n任务的核心是计算给定系统中每个残基 $i$ 对结合自由能的贡献，然后将这些计算出的贡献与实验测量的突变后结合亲和力变化进行关联。\n\n逐残基结合贡献，记为 $\\Delta G^{\\text{res}}_i$，定义为残基 $i$ 在结合（复合物）态的总能量与其在分离（未结合）态的总能量之差。一个残基的总能量是四个分量的总和：范德华 ($E^{\\text{vdW}}$)、库仑 ($E^{\\text{Coul}}$)、源自广义波恩理论的极性溶剂化 ($E^{\\text{GB}}$) 和源自表面积模型的非极性溶剂化 ($E^{\\text{SA}}$)。所有能量均以千卡/摩尔 (kcal/mol) 为单位表示。\n\n首先，对于每个残基 $i$，我们通过对所提供的分量求和来计算其在结合态的总能量 $E^{\\text{bound}}_i$：\n$$ E^{\\text{bound}}_i = E^{\\text{vdW}}_{\\text{bound}, i} + E^{\\text{Coul}}_{\\text{bound}, i} + E^{\\text{GB}}_{\\text{bound}, i} + E^{\\text{SA}}_{\\text{bound}, i} $$\n\n类似地，我们计算其在分离态的总能量 $E^{\\text{sep}}_i$：\n$$ E^{\\text{sep}}_i = E^{\\text{vdW}}_{\\text{sep}, i} + E^{\\text{Coul}}_{\\text{sep}, i} + E^{\\text{GB}}_{\\text{sep}, i} + E^{\\text{SA}}_{\\text{sep}, i} $$\n\n逐残基结合贡献 $\\Delta G^{\\text{res}}_i$ 便是这两个量之差。它代表了残基 $i$ 在结合过程中的净能量变化。\n$$ \\Delta G^{\\text{res}}_i = E^{\\text{bound}}_i - E^{\\text{sep}}_i $$\n\n该问题提出了计算突变研究中常用的一种近似：将残基 $i$ 突变为丙氨酸等较小残基（$\\Delta \\Delta G_i$）所引起的结合自由能变化，可以估算为该残基结合贡献的负值。这假设了突变有效地“移除”了侧链的贡献，而没有引入其他显著的微扰。因此，预测的突变自由能变化 $\\widehat{\\Delta \\Delta G}_i$ 为：\n$$ \\widehat{\\Delta \\Delta G}_i = - \\Delta G^{\\text{res}}_i $$\n\n最后，为了评估这些预测的质量，我们计算预测值向量 $\\widehat{\\mathbf{\\Delta \\Delta G}} = (\\widehat{\\Delta \\Delta G}_1, \\dots, \\widehat{\\Delta \\Delta G}_n)$ 与实验测量值向量 $\\mathbf{\\Delta \\Delta G}^{\\text{exp}} = (\\Delta \\Delta G^{\\text{exp}}_1, \\dots, \\Delta \\Delta G^{\\text{exp}}_n)$ 之间的皮尔逊相关系数 $r$。皮尔逊相关系数的公式是：\n$$ r = \\frac{\\sum_{i=1}^{n} (\\widehat{\\Delta \\Delta G}_i - \\overline{\\widehat{\\Delta \\Delta G}}) (\\Delta \\Delta G^{\\text{exp}}_i - \\overline{\\Delta \\Delta G^{\\text{exp}}})}{\\sqrt{\\sum_{i=1}^{n} (\\widehat{\\Delta \\Delta G}_i - \\overline{\\widehat{\\Delta \\Delta G}})^2} \\sqrt{\\sum_{i=1}^{n} (\\Delta \\Delta G^{\\text{exp}}_i - \\overline{\\Delta \\Delta G^{\\text{exp}}})^2}} $$\n其中 $n$ 是残基的数量，上划线表示向量元素的算术平均值。\n\n对所提供的三个测试用例中的每一个都重复此计算。实现将利用 `numpy` 库进行高效的数组操作。对于每个测试用例，将组合输入数据向量以计算 $\\widehat{\\mathbf{\\Delta \\Delta G}}$ 向量，然后使用 `numpy.corrcoef` 计算与相应 $\\mathbf{\\Delta \\Delta G}^{\\text{exp}}$ 向量的相关系数。将三个测试用例得到的相关系数收集并格式化为所需的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Pearson correlation coefficient between predicted and experimental\n    mutational free energy changes based on MM/GBSA per-residue energy decomposition.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        {\n            \"vdW_bound\": np.array([-1.8, -0.5, -2.2, -0.9, -0.2, -1.0]),\n            \"coul_bound\": np.array([-1.2, 0.4, -0.8, -0.1, 0.3, -0.5]),\n            \"gb_bound\": np.array([0.9, -0.2, 0.6, 0.1, -0.1, 0.4]),\n            \"sa_bound\": np.array([-0.2, -0.05, -0.15, -0.08, -0.02, -0.1]),\n            \"vdW_sep\": np.array([-0.6, -0.2, -0.8, -0.4, -0.1, -0.3]),\n            \"coul_sep\": np.array([-0.5, 0.1, -0.2, 0.0, 0.1, -0.1]),\n            \"gb_sep\": np.array([0.4, -0.1, 0.3, 0.05, -0.05, 0.2]),\n            \"sa_sep\": np.array([-0.08, -0.02, -0.05, -0.03, -0.01, -0.04]),\n            \"exp_ddG\": np.array([1.6, 0.2, 1.7, 0.5, -0.1, 0.9])\n        },\n        # Test Case 2\n        {\n            \"vdW_bound\": np.array([-0.7, -1.5, -0.3, -1.1, -0.4]),\n            \"coul_bound\": np.array([0.2, -0.6, 0.1, -0.3, -0.2]),\n            \"gb_bound\": np.array([-0.1, 0.5, -0.05, 0.2, 0.1]),\n            \"sa_bound\": np.array([-0.05, -0.12, -0.02, -0.08, -0.03]),\n            \"vdW_sep\": np.array([-0.5, -0.9, -0.2, -0.6, -0.3]),\n            \"coul_sep\": np.array([0.1, -0.3, 0.0, -0.1, -0.1]),\n            \"gb_sep\": np.array([-0.05, 0.2, -0.02, 0.1, 0.05]),\n            \"sa_sep\": np.array([-0.02, -0.06, -0.01, -0.04, -0.02]),\n            \"exp_ddG\": np.array([-0.15, -0.7, -0.05, -0.6, -0.2])\n        },\n        # Test Case 3\n        {\n            \"vdW_bound\": np.array([-0.6, -0.2, -1.1, -0.05, -0.8, -0.3, -0.9]),\n            \"coul_bound\": np.array([-0.3, 0.05, -0.2, 0.0, -0.4, 0.1, -0.1]),\n            \"gb_bound\": np.array([0.25, -0.02, 0.3, 0.01, 0.35, -0.01, 0.2]),\n            \"sa_bound\": np.array([-0.06, -0.01, -0.09, -0.005, -0.07, -0.02, -0.08]),\n            \"vdW_sep\": np.array([-0.4, -0.1, -0.5, -0.02, -0.6, -0.2, -0.7]),\n            \"coul_sep\": np.array([-0.2, 0.02, -0.1, 0.0, -0.3, 0.05, -0.05]),\n            \"gb_sep\": np.array([0.1, -0.01, 0.15, 0.005, 0.2, -0.005, 0.1]),\n            \"sa_sep\": np.array([-0.03, -0.005, -0.04, -0.002, -0.035, -0.01, -0.04]),\n            \"exp_ddG\": np.array([0.3, -0.1, 0.2, 0.05, -0.05, 0.12, -0.08])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Calculate total energy per residue in the bound state\n        E_bound = (case[\"vdW_bound\"] + case[\"coul_bound\"] + \n                   case[\"gb_bound\"] + case[\"sa_bound\"])\n\n        # Calculate total energy per residue in the separated state\n        E_sep = (case[\"vdW_sep\"] + case[\"coul_sep\"] + \n                 case[\"gb_sep\"] + case[\"sa_sep\"])\n        \n        # Calculate per-residue binding contribution\n        # delta_G_res = E_bound - E_sep\n        delta_G_res = E_bound - E_sep\n        \n        # Calculate predicted mutational free energy change\n        # predicted_ddG = -delta_G_res\n        predicted_ddG = -delta_G_res\n        \n        # Calculate Pearson correlation coefficient between predicted and experimental ddG\n        # np.corrcoef returns a 2x2 matrix, the correlation is at [0, 1] or [1, 0]\n        correlation_matrix = np.corrcoef(predicted_ddG, case[\"exp_ddG\"])\n        correlation = correlation_matrix[0, 1]\n        \n        results.append(correlation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}