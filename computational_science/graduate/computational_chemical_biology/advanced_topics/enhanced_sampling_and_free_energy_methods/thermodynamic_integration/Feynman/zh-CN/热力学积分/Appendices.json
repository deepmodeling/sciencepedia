{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的生物分子系统之前，将热力学积分应用于一个简单的、可精确求解的模型是非常有价值的。这个关于谐振子的练习让我们能够清晰地看到热力学积分的整个工作机制——从定义炼金术路径到执行积分，并用已知的解析解来验证我们的结果。通过这种方式，我们为更复杂的应用打下坚实的理论基础。",
            "id": "2465950",
            "problem": "一个质量为 $m$ 的经典粒子在一维空间中运动，并处于一个谐振子势中。在状态 $A$ 中，势为 $U_{A}(x) = \\frac{1}{2} k_{A} x^{2}$，在状态 $B$ 中，势为 $U_{B}(x) = \\frac{1}{2} k_{B} x^{2}$，其中 $k_{A} > 0$ 和 $k_{B} > 0$ 是力常数。系统处于绝对温度 $T$ 下，并属于正则系综。定义一个炼金耦合参数 $\\lambda \\in [0,1]$ 和一个势的路径 $U_{\\lambda}(x) = (1-\\lambda) U_{A}(x) + \\lambda U_{B}(x)$。使用热力学积分 (TI)，确定亥姆霍兹自由能差 $\\Delta F_{A \\to B} = F_{B} - F_{A}$ 的精确解析表达式。假设使用经典统计，并注意动能贡献在状态 $A$ 和 $B$ 中是相同的，因此在自由能差中相互抵消。用 $k_{A}$、$k_{B}$、玻尔兹曼常数 $k_{\\mathrm{B}}$ 和 $T$ 以单个闭合形式表达式符号化地表示你的最终答案。",
            "solution": "系统是经典的，并处于温度为 $T$ 的正则系综中。亥姆霍兹自由能的定义为 $F = - k_{\\mathrm{B}} T \\ln Z$，其中 $Z$ 是配分函数。在热力学积分 (TI) 中，引入一个耦合参数 $\\lambda \\in [0,1]$，通过 $U_{\\lambda}(x) = (1-\\lambda) U_{A}(x) + \\lambda U_{B}(x)$ 将势从 $U_{A}$ 连续地变换到 $U_{B}$。正则系综中的基本 TI 关系是\n$$\n\\Delta F_{A \\to B} \\equiv F_{B} - F_{A} = \\int_{0}^{1} \\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\, d\\lambda,\n$$\n其中 $\\langle \\cdot \\rangle_{\\lambda}$ 表示相对于与 $U_{\\lambda}$ 对应的正则分布的系综平均。\n\n对于给定的路径，\n$$\nU_{\\lambda}(x) = \\frac{1}{2}\\left[(1-\\lambda)k_{A} + \\lambda k_{B}\\right] x^{2} \\equiv \\frac{1}{2} k(\\lambda) x^{2},\n$$\n其中 $k(\\lambda) = (1-\\lambda)k_{A} + \\lambda k_{B}$。将 $U_{\\lambda}$ 对 $\\lambda$ 求导得出\n$$\n\\frac{\\partial U_{\\lambda}}{\\partial \\lambda} = \\frac{1}{2}\\left(k_{B} - k_{A}\\right) x^{2}.\n$$\n因此，TI 的被积函数是\n$$\n\\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda} \\right\\rangle_{\\lambda} = \\frac{1}{2}\\left(k_{B} - k_{A}\\right) \\langle x^{2} \\rangle_{\\lambda}.\n$$\n\n我们现在计算力常数为 $k(\\lambda)$ 的一维谐振子势的 $\\langle x^{2} \\rangle_{\\lambda}$。在正则系综中，\n$$\n\\langle x^{2} \\rangle_{\\lambda} = \\frac{\\int_{-\\infty}^{\\infty} x^{2} \\exp\\!\\left[-\\beta \\frac{1}{2} k(\\lambda) x^{2}\\right] dx}{\\int_{-\\infty}^{\\infty} \\exp\\!\\left[-\\beta \\frac{1}{2} k(\\lambda) x^{2}\\right] dx},\n$$\n其中 $\\beta = \\frac{1}{k_{\\mathrm{B}} T}$。分子和分母都是高斯积分。使用此类矩的标准结果，可以得到\n$$\n\\langle x^{2} \\rangle_{\\lambda} = \\frac{1}{\\beta k(\\lambda)} = \\frac{k_{\\mathrm{B}} T}{k(\\lambda)}.\n$$\n因此，\n$$\n\\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda} \\right\\rangle_{\\lambda} = \\frac{1}{2}\\left(k_{B} - k_{A}\\right) \\frac{k_{\\mathrm{B}} T}{k(\\lambda)}.\n$$\n\n代入 TI 积分得到\n$$\n\\Delta F_{A \\to B} = \\int_{0}^{1} \\frac{1}{2}\\left(k_{B} - k_{A}\\right) \\frac{k_{\\mathrm{B}} T}{(1-\\lambda)k_{A} + \\lambda k_{B}} \\, d\\lambda.\n$$\n这是一个初等积分。令 $a = k_{A}$ 且 $b = k_{B}$。那么\n$$\n\\Delta F_{A \\to B} = \\frac{1}{2} k_{\\mathrm{B}} T (b - a) \\int_{0}^{1} \\frac{d\\lambda}{a + \\lambda (b - a)}.\n$$\n计算该积分，\n$$\n\\int_{0}^{1} \\frac{d\\lambda}{a + \\lambda (b - a)} = \\frac{1}{b - a} \\left[ \\ln\\!\\left(a + \\lambda (b - a)\\right) \\right]_{0}^{1} = \\frac{1}{b - a} \\left( \\ln b - \\ln a \\right).\n$$\n因此，\n$$\n\\Delta F_{A \\to B} = \\frac{1}{2} k_{\\mathrm{B}} T \\left( \\ln b - \\ln a \\right) = \\frac{1}{2} k_{\\mathrm{B}} T \\ln\\!\\left(\\frac{k_{B}}{k_{A}}\\right).\n$$\n\n此表达式是两个一维谐振子态之间沿指定线性耦合路径的精确经典构型自由能差，并且与直接的配分函数计算结果一致，注意到动能贡献在差值中相互抵消。",
            "answer": "$$\\boxed{\\frac{1}{2}\\,k_{\\mathrm{B}}\\,T\\,\\ln\\!\\left(\\frac{k_{B}}{k_{A}}\\right)}$$"
        },
        {
            "introduction": "从解析的世界过渡到计算化学的实际应用，我们通常无法得到一个解析的$\\langle \\partial U / \\partial \\lambda \\rangle$函数。相反，我们通过在离散的$\\lambda$点上进行模拟，获得一系列广义力的系综平均值。本练习将演示一项至关重要的技能：如何使用数值积分方法（如辛普森法则）根据这些离散数据点来近似计算热力学积分，从而将模拟输出转化为最终的自由能差值。",
            "id": "3867550",
            "problem": "在一项与计算化学生物学相关的炼金术自由能计算中，一个配体在恒定温度 $T$ 下通过与一个参数 $\\lambda \\in [0,1]$ 耦合而被转化为一个参考态。该系统在正则系综中进行模拟。对于 $\\lambda$ 的每个离散值，广义力的系综平均值 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$ 通过足够长的平衡分子动力学模拟进行估计，其中 $U(\\mathbf{x};\\lambda)$ 是在耦合参数 $\\lambda$ 下构型 $\\mathbf{x}$ 的势能。在一个均匀间隔的网格上获得了以下数值（为本练习之目的，假设这些数值已统计收敛）：\n- $\\lambda = 0.0$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 1.000\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.1$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 1.229\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.2$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 1.512\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.3$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 1.843\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.4$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 2.216\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.5$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 2.625\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.6$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 3.064\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.7$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 3.527\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.8$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 4.008\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 0.9$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 4.501\\ \\mathrm{kJ\\,mol^{-1}}$\n- $\\lambda = 1.0$: $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda} = 5.000\\ \\mathrm{kJ\\,mol^{-1}}$\n\n仅使用平衡统计力学的基本定义和数值积分，推导连接Helmholtz自由能差 $\\Delta F$ 与所提供广义力数据的表达式，然后使用适用于均匀间隔网格的复合Newton–Cotes法则，计算在 $\\lambda \\in [0,1]$ 上的近似 $\\Delta F$。在你的计算中，展示你所使用的明确积分权重。最后，简要地定性讨论对于你所选择的积分方法，离散化误差将如何随网格间距变化，以及 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$ 潜在的对 $\\lambda$ 的依赖关系的哪些特征控制着这个误差。\n\n将 $\\Delta F$ 的最终数值以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导基本的热力学积分（TI）公式，使用数值积分将其应用于给定的数据集，并讨论数值误差。\n\n首先，我们验证问题陈述的有效性。\n已知条件：\n- 该系统在恒定温度 $T$ 下于正则系综中进行模拟。\n- 一个耦合参数 $\\lambda$ 从0变化到1。\n- 为 $\\lambda = 0.0, 0.1, \\dots, 1.0$ 提供了一组11个均匀间隔的广义力系综平均值 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$ 的数据点。这些值以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位给出。\n- 任务是推导Helmholtz自由能差 $\\Delta F$ 的表达式，计算其值，并分析所选数值方法的误差。\n\n验证：\n该问题具有科学依据，因为热力学积分是计算统计力学中用于自由能计算的基石方法。问题设定是适定的，为数值积分提供了所有必要的数据。语言是客观的，数据是一致的。该问题是应用基本理论和数值方法的标准练习。因此，该问题是有效的。\n\n我们现在开始解答。\n\n**1. 热力学积分公式的推导**\n\nHelmholtz自由能 $F$ 是根据正则配分函数 $Z$ 定义的：\n$$F(\\lambda) = -k_\\mathrm{B} T \\ln Z(\\lambda)$$\n其中 $k_\\mathrm{B}$ 是Boltzmann常数， $T$ 是温度， $\\lambda$ 是耦合参数。对于一个由 $N$ 个全同粒子组成的系统，其正则配分函数 $Z$ 由对所有可能的相空间坐标（位置 $\\mathbf{x}$ 和动量 $\\mathbf{p}$）的积分给出：\n$$Z(\\lambda) = \\frac{1}{N!h^{3N}} \\int \\int \\exp(-\\beta H(\\mathbf{x}, \\mathbf{p}; \\lambda)) \\,d\\mathbf{x}\\,d\\mathbf{p}$$\n此处，$\\beta = (k_\\mathrm{B} T)^{-1}$，$h$ 是Planck常数，$H(\\mathbf{x}, \\mathbf{p}; \\lambda)$ 是系统的哈密顿量。哈密顿量是动能 $K(\\mathbf{p})$ 和势能 $U(\\mathbf{x}; \\lambda)$ 的和：$H(\\mathbf{x}, \\mathbf{p}; \\lambda) = K(\\mathbf{p}) + U(\\mathbf{x}; \\lambda)$。由于动能与 $\\lambda$ 无关，对动量的积分可以被因子化分离出来。这导出了一个依赖于构型配分函数 $Q(\\lambda)$ 的自由能简化表达式：\n$$F(\\lambda) = -k_\\mathrm{B} T \\ln Q(\\lambda) + C$$\n其中 $C$ 是一个与 $\\lambda$ 无关的常数，$Q(\\lambda)$ 由下式给出：\n$$Q(\\lambda) = \\int \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x}$$\n为了找到 $F$ 与给定数据之间的关系，我们将 $F(\\lambda)$ 对 $\\lambda$ 求导：\n$$\\frac{\\partial F}{\\partial \\lambda} = -k_\\mathrm{B} T \\frac{1}{Q(\\lambda)} \\frac{\\partial Q(\\lambda)}{\\partial \\lambda}$$\n构型配分函数的导数是：\n$$\\frac{\\partial Q(\\lambda)}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\int \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x} = \\int \\left(-\\beta \\frac{\\partial U(\\mathbf{x}; \\lambda)}{\\partial \\lambda}\\right) \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x}$$\n将此代回 $\\partial F / \\partial \\lambda$ 的表达式中：\n$$\\frac{\\partial F}{\\partial \\lambda} = -k_\\mathrm{B} T \\frac{1}{Q(\\lambda)} \\int \\left(-\\beta \\frac{\\partial U(\\mathbf{x}; \\lambda)}{\\partial \\lambda}\\right) \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x}$$\n使用 $\\beta = (k_\\mathrm{B} T)^{-1}$，上式简化为：\n$$\\frac{\\partial F}{\\partial \\lambda} = \\frac{\\int \\frac{\\partial U(\\mathbf{x}; \\lambda)}{\\partial \\lambda} \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x}}{\\int \\exp(-\\beta U(\\mathbf{x}; \\lambda)) \\,d\\mathbf{x}}$$\n根据定义，右侧是在固定值 $\\lambda$ 下，正则系综中物理量 $\\partial U / \\partial \\lambda$ 的系综平均值。这被记为 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$。因此，我们得到了核心关系式：\n$$\\frac{\\partial F}{\\partial \\lambda} = \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda}$$\n为了求得总自由能差 $\\Delta F = F(\\lambda=1) - F(\\lambda=0)$，我们对该表达式从 $\\lambda=0$ 到 $\\lambda=1$ 进行路径积分：\n$$\\int_0^1 \\frac{\\partial F}{\\partial \\lambda} \\,d\\lambda = \\int_0^1 \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\,d\\lambda$$\n根据微积分基本定理，左侧是 $F(1) - F(0) = \\Delta F$。因此，最终的表达式是：\n$$\\Delta F = \\int_0^1 \\left\\langle \\frac{\\partial U}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\,d\\lambda$$\n这就是所要求的表达式。\n\n**2. $\\Delta F$ 的数值计算**\n\n问题在具有11个点的均匀间隔网格上提供了被积函数 $g(\\lambda) = \\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$ 的数据，这对应于 $n=10$ 个区间。由于 $n$ 是偶数，复合Simpson法则是适用且高精度的Newton-Cotes方法。对于宽度为 $h$ 的 $n$ 个区间（$n$ 为偶数），复合Simpson法则的公式为：\n$$\\int_a^b g(\\lambda) \\,d\\lambda \\approx \\frac{h}{3} \\left[ g(\\lambda_0) + 4g(\\lambda_1) + 2g(\\lambda_2) + \\dots + 2g(\\lambda_{n-2}) + 4g(\\lambda_{n-1}) + g(\\lambda_n) \\right]$$\n在我们的例子中，积分区间是 $[0, 1]$，所以 $a=0$ 且 $b=1$。区间数量为 $n=10$，所以网格间距为 $h = (1-0)/10 = 0.1$。令 $g_i = \\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda_i}$，其中 $\\lambda_i = i \\times h$。\n数据点如下：\n$g_0 = 1.000$; $g_1 = 1.229$; $g_2 = 1.512$; $g_3 = 1.843$; $g_4 = 2.216$; $g_5 = 2.625$; $g_6 = 3.064$; $g_7 = 3.527$; $g_8 = 4.008$; $g_9 = 4.501$; $g_{10} = 5.000$。（所有单位均为 $\\mathrm{kJ\\,mol^{-1}}$）。\n\n每个数据点 $g_i$ 的积分权重由 $w_i$ 给出。积分为 $\\sum_{i=0}^{10} w_i g_i$。对于Simpson法则，权重为：\n$w_0 = \\frac{h}{3}(1) = \\frac{0.1}{3}$; $w_1 = \\frac{h}{3}(4) = \\frac{0.4}{3}$; $w_2 = \\frac{h}{3}(2) = \\frac{0.2}{3}$; $w_3 = \\frac{h}{3}(4) = \\frac{0.4}{3}$; $w_4 = \\frac{h}{3}(2) = \\frac{0.2}{3}$; $w_5 = \\frac{h}{3}(4) = \\frac{0.4}{3}$; $w_6 = \\frac{h}{3}(2) = \\frac{0.2}{3}$; $w_7 = \\frac{h}{3}(4) = \\frac{0.4}{3}$; $w_8 = \\frac{h}{3}(2) = \\frac{0.2}{3}$; $w_9 = \\frac{h}{3}(4) = \\frac{0.4}{3}$; $w_{10} = \\frac{h}{3}(1) = \\frac{0.1}{3}$。\n\n应用该法则：\n$\\Delta F \\approx \\frac{0.1}{3} [g_0 + 4g_1 + 2g_2 + 4g_3 + 2g_4 + 4g_5 + 2g_6 + 4g_7 + 2g_8 + 4g_9 + g_{10}]$\n$\\Delta F \\approx \\frac{0.1}{3} [1.000 + 4(1.229) + 2(1.512) + 4(1.843) + 2(2.216) + 4(2.625) + 2(3.064) + 4(3.527) + 2(4.008) + 4(4.501) + 5.000]$\n$\\Delta F \\approx \\frac{0.1}{3} [1.000 + 4.916 + 3.024 + 7.372 + 4.432 + 10.500 + 6.128 + 14.108 + 8.016 + 18.004 + 5.000]$\n$\\Delta F \\approx \\frac{0.1}{3} [82.500]$\n$\\Delta F \\approx \\frac{8.250}{3} = 2.750 \\, \\mathrm{kJ\\,mol^{-1}}$\n\n**3. 离散化误差的讨论**\n\n使用复合Simpson法则在区间 $[a,b]$ 上对函数 $g(\\lambda)$ 进行积分时，其离散化误差 $E$（网格间距为 $h = (b-a)/n$）由下式给出：\n$$E = -\\frac{(b-a)h^4}{180} g^{(4)}(\\xi)$$\n其中 $\\xi \\in (a, b)$， $g^{(4)}(\\lambda)$ 是被积函数的四阶导数。\n\n从这个公式中，我们可以得出两个关键的观察结果：\n1.  **随网格间距的变化关系**：误差随网格间距的四次方变化，即 $E \\propto h^4$。这是一个高阶精度。如果网格间距 $h$ 减半，误差预计会减少 $2^4 = 16$ 倍。\n2.  **控制误差的特征**：误差的大小与被积函数 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$ 的四阶导数的量值成正比。如果该函数平滑且能被低阶多项式很好地近似，则误差很小。如果函数表现出高频振荡或曲率急剧变化，这对应于一个大的四阶导数，则误差会很大。\n\n在这个具体问题中，可以验证所提供的数据点完全符合三次多项式 $g(\\lambda) = -\\lambda^3 + 3\\lambda^2 + 2\\lambda + 1$。对于一个3次或更低次的多项式，其四阶导数恒等于零：\n$$g^{(4)}(\\lambda) = \\frac{d^4}{d\\lambda^4}(-\\lambda^3 + 3\\lambda^2 + 2\\lambda + 1) = 0$$\n因此，对于这个特定的数据集，复合Simpson法则的截断误差为零。计算出的值 $2.750 \\, \\mathrm{kJ\\,mol^{-1}}$ 不是一个近似值，而是生成这些数据点的潜在函数积分的精确值。最终结果应按要求报告为四位有效数字。\n\n计算值为 $\\Delta F = 2.750 \\, \\mathrm{kJ\\,mol^{-1}}$。",
            "answer": "$$\\boxed{2.750}$$"
        },
        {
            "introduction": "任何没有不确定性估计的自由能计算值都是不完整的。这个高级练习探讨了如何通过从每个模拟窗口传播方差来量化热力学积分计算中的统计误差。更重要的是，它揭示了一个强大的原则：通过分析哪些窗口对总误差的贡献最大，我们可以战略性地重新分配计算资源，从而最有效地提高我们结果的精度。",
            "id": "3867578",
            "problem": "在炼金术热力学积分中，状态 $\\mathcal{A}$（耦合参数 $\\lambda=0$）和状态 $\\mathcal{B}$（$\\lambda=1$）之间的亥姆霍兹自由能差 $\\Delta F$ 在正则系综中表示为沿可逆路径的系综平均值的积分，其中 $\\lambda \\in [0,1]$ 通过一个可微方案将两个状态之间的哈密顿量 $U(\\mathbf{x};\\lambda)$ 耦合起来。在固定的 $\\lambda$ 和温度下，广义力 $g(\\mathbf{x};\\lambda) \\equiv \\partial U(\\mathbf{x};\\lambda)/\\partial \\lambda$ 的系综平均是基于玻尔兹曼分布计算的。在实践中，我们将 $\\lambda$ 离散化为多个窗口，并使用从每个窗口的分子动力学或蒙特卡洛采样中获得的时间序列 $g(\\mathbf{x};\\lambda)$，通过数值积分来估计该积分。\n\n考虑一个蛋白质-配体体系，在固定温度下，在 $\\lambda \\in \\{0.0, 0.2, 0.4, 0.6, 0.8, 1.0\\}$ 的 $6$ 个等间距窗口中进行模拟，间距为 $\\Delta \\lambda = 0.2$。您使用梯形法则，根据在窗口索引 $i$ 处表示为 $\\mu_i$ 的 $g(\\mathbf{x};\\lambda)$ 的各窗口样本均值来近似 $\\Delta F$，权重为 $w_0 = w_5 = \\Delta \\lambda/2$ 和 $w_1=w_2=w_3=w_4=\\Delta \\lambda$。对于每个窗口，您已经从 $g(\\mathbf{x};\\lambda)$ 的时间序列中估计出：样本均值 $\\mu_i$（单位为 $\\mathrm{kJ\\,mol^{-1}}$），样本方差 $\\sigma_i^2$（单位为 $\\mathrm{(kJ\\,mol^{-1})^2}$），以及根据时间序列的积分自相关时间计算出的有效样本量 $N_{\\mathrm{eff},i}$。假设不同的 $\\lambda$ 窗口是独立采样的，因此样本均值之间的窗口间协方差可以忽略不计。\n\n数据如下：\n- $\\lambda=0.0$: $\\mu_0 = 12.0$, $\\sigma_0^2 = 64.0$, $N_{\\mathrm{eff},0} = 400$。\n- $\\lambda=0.2$: $\\mu_1 = 8.5$, $\\sigma_1^2 = 81.0$, $N_{\\mathrm{eff},1} = 300$。\n- $\\lambda=0.4$: $\\mu_2 = 5.0$, $\\sigma_2^2 = 49.0$, $N_{\\mathrm{eff},2} = 200$。\n- $\\lambda=0.6$: $\\mu_3 = 2.0$, $\\sigma_3^2 = 100.0$, $N_{\\mathrm{eff},3} = 150$。\n- $\\lambda=0.8$: $\\mu_4 = 0.5$, $\\sigma_4^2 = 36.0$, $N_{\\mathrm{eff},4} = 300$。\n- $\\lambda=1.0$: $\\mu_5 = 0.0$, $\\sigma_5^2 = 25.0$, $N_{\\mathrm{eff},5} = 400$。\n\n从正则系综平均、使用梯形法则的积分求积近似以及通过有效样本量对时间相关样本应用中心极限定理的定义出发，根据所述的独立性假设，推导梯形热力学积分估计量 $\\widehat{\\Delta F}$ 的方差表达式，该表达式应以求积权重 $w_i$、窗口方差 $\\sigma_i^2$ 和有效样本量 $N_{\\mathrm{eff},i}$ 表示。然后，使用所提供的数据，计算 $\\widehat{\\Delta F}$ 的估计标准误差，单位为 $\\mathrm{kJ\\,mol^{-1}}$。\n\n此外，基于您推导的表达式，定性（但精确地）解释您将如何重新分配额外的计算资源到各个窗口，以便最有效地减少不确定性，假设每个窗口中每个有效独立样本的计算成本大致相同。\n\n仅报告估计标准误差的数值，以 $\\mathrm{kJ\\,mol^{-1}}$ 表示，并四舍五入到三位有效数字。",
            "solution": "该问题要求推导亥姆霍兹自由能差 $\\Delta F$ 的热力学积分 (TI) 估计量的方差表达式，根据给定数据计算其标准误差，并对计算资源的最优分配进行定性解释。\n\n状态 $\\mathcal{A}$ ($\\lambda=0$) 和状态 $\\mathcal{B}$ ($\\lambda=1$) 之间的亥姆霍兹自由能差 $\\Delta F$ 由以下精确的热力学积分公式给出：\n$$ \\Delta F = F(\\lambda=1) - F(\\lambda=0) = \\int_{0}^{1} \\left\\langle \\frac{\\partial U(\\mathbf{x}; \\lambda)}{\\partial \\lambda} \\right\\rangle_{\\lambda} \\,d\\lambda $$\n其中 $\\langle \\cdot \\rangle_{\\lambda}$ 表示在固定耦合参数 $\\lambda$ 和温度下的正则系综中的系综平均。量 $g(\\mathbf{x};\\lambda) \\equiv \\partial U(\\mathbf{x};\\lambda)/\\partial \\lambda$ 是广义力。\n\n在实践中，这个积分是数值估计的。问题指定将路径离散化为从 $\\lambda_0=0.0$ 到 $\\lambda_5=1.0$ 的 $n+1=6$ 个等间距点 $\\lambda_i$，间距为 $\\Delta \\lambda = 0.2$。该积分使用梯形法则进行近似。$\\Delta F$ 的估计量，记作 $\\widehat{\\Delta F}$，是在每个 $\\lambda_i$ 处估计的平均广义力 $\\mu_i$ 的加权和：\n$$ \\widehat{\\Delta F} = \\sum_{i=0}^{5} w_i \\mu_i $$\n此处，$\\mu_i$ 是在 $\\lambda_i$ 处通过模拟获得的广义力的样本均值。梯形法则的权重由 $w_0 = w_5 = \\Delta \\lambda/2$ 和 $w_i = \\Delta \\lambda$（对于 $i=1, 2, 3, 4$）给出。\n\n我们需要推导这个估计量 $\\widehat{\\Delta F}$ 的方差 $\\mathrm{Var}(\\widehat{\\Delta F})$。估计量 $\\widehat{\\Delta F}$ 是随机变量 $\\mu_i$ 的线性组合。这种线性组合的方差由下式给出：\n$$ \\mathrm{Var}(\\widehat{\\Delta F}) = \\mathrm{Var}\\left(\\sum_{i=0}^{5} w_i \\mu_i\\right) = \\sum_{i=0}^{5} \\sum_{j=0}^{5} w_i w_j \\mathrm{Cov}(\\mu_i, \\mu_j) $$\n问题指出，不同 $\\lambda$ 窗口中的模拟是独立的，这意味着对于 $i \\neq j$ 的样本均值 $\\mu_i$ 和 $\\mu_j$ 是不相关的。因此，它们的协方差为零：$\\mathrm{Cov}(\\mu_i, \\mu_j) = 0$（对于 $i \\neq j$）。方差的表达式简化为：\n$$ \\mathrm{Var}(\\widehat{\\Delta F}) = \\sum_{i=0}^{5} w_i^2 \\mathrm{Var}(\\mu_i) $$\n接下来，我们需要单个窗口 $i$ 的样本均值方差 $\\mathrm{Var}(\\mu_i)$ 的表达式。每个窗口的数据是来自自分子模拟的时间序列，这些序列通常是自相关的。对于时间相关数据的中心极限定理指出，样本均值 $\\mu_i$ 的方差可以使用数据点的样本方差 $\\sigma_i^2$ 和考虑了相关性的有效样本量 $N_{\\mathrm{eff},i}$ 来估计。公式为：\n$$ \\mathrm{Var}(\\mu_i) = \\frac{\\sigma_i^2}{N_{\\mathrm{eff},i}} $$\n其中 $\\sigma_i^2$ 是 $g(\\mathbf{x};\\lambda_i)$ 分布的方差。\n\n将此代入我们的总方差表达式，我们得到所需的梯形 TI 估计量方差的表达式：\n$$ \\mathrm{Var}(\\widehat{\\Delta F}) = \\sum_{i=0}^{5} w_i^2 \\frac{\\sigma_i^2}{N_{\\mathrm{eff},i}} $$\n这是按要求从第一性原理推导出的通用表达式。\n\n现在，我们使用所提供的数据来计算方差和标准误差的数值。标准误差是 $\\mathrm{SE}(\\widehat{\\Delta F}) = \\sqrt{\\mathrm{Var}(\\widehat{\\Delta F})}$。\n间距为 $\\Delta \\lambda = 0.2$。权重为：\n$w_0 = w_5 = \\Delta \\lambda/2 = 0.2/2 = 0.1$。\n$w_1 = w_2 = w_3 = w_4 = \\Delta \\lambda = 0.2$。\n\n我们计算每个窗口对总方差的贡献，$V_i = w_i^2 \\frac{\\sigma_i^2}{N_{\\mathrm{eff},i}}$：\n对于 $i=0$： $V_0 = (0.1)^2 \\times \\frac{64.0}{400} = 0.01 \\times 0.16 = 0.0016$。\n对于 $i=1$： $V_1 = (0.2)^2 \\times \\frac{81.0}{300} = 0.04 \\times 0.27 = 0.0108$。\n对于 $i=2$： $V_2 = (0.2)^2 \\times \\frac{49.0}{200} = 0.04 \\times 0.245 = 0.0098$。\n对于 $i=3$： $V_3 = (0.2)^2 \\times \\frac{100.0}{150} = 0.04 \\times \\frac{2}{3} = \\frac{0.08}{3} \\approx 0.026667$。\n对于 $i=4$： $V_4 = (0.2)^2 \\times \\frac{36.0}{300} = 0.04 \\times 0.12 = 0.0048$。\n对于 $i=5$： $V_5 = (0.1)^2 \\times \\frac{25.0}{400} = 0.01 \\times 0.0625 = 0.000625$。\n\n总方差是这些贡献的总和：\n$$ \\mathrm{Var}(\\widehat{\\Delta F}) = V_0 + V_1 + V_2 + V_3 + V_4 + V_5 $$\n$$ \\mathrm{Var}(\\widehat{\\Delta F}) = 0.0016 + 0.0108 + 0.0098 + 0.026667 + 0.0048 + 0.000625 = 0.054292 $$\n方差的单位是 $(\\mathrm{kJ\\,mol^{-1}})^2$。\n\n估计的标准误差是方差的平方根：\n$$ \\mathrm{SE}(\\widehat{\\Delta F}) = \\sqrt{0.054292} \\approx 0.233006 $$\n四舍五入到三位有效数字，标准误差为 $0.233 \\, \\mathrm{kJ\\,mol^{-1}}$。\n\n最后，我们讨论如何重新分配计算资源以最有效地减少不确定性。目标是在给定的总计算成本下，最小化总方差 $\\mathrm{Var}(\\widehat{\\Delta F}) = \\sum_i w_i^2 \\frac{\\sigma_i^2}{N_{\\mathrm{eff},i}}$。假设成本与有效样本的总数 $\\sum_i N_{\\mathrm{eff},i}$ 成正比，样本的最优分配方案是使所有窗口 $i$ 的量 $w_i \\sigma_i / N_{\\mathrm{eff},i}$ 相等。\n这意味着要最有效地减少总方差，任何额外的计算资源都应投入到当前对总方差贡献最大的窗口，即项 $V_i = w_i^2 \\sigma_i^2/N_{\\mathrm{eff},i}$ 最大的窗口。通过增加该特定窗口的 $N_{\\mathrm{eff},i}$，我们可以在总方差上实现最速下降。\n根据我们上面的计算，对总方差贡献最大的是来自窗口 $i=3$（$\\lambda=0.6$），其中 $V_3 \\approx 0.0267 \\, (\\mathrm{kJ\\,mol^{-1}})^2$。这个贡献是第二大贡献（$V_1 = 0.0108 \\, (\\mathrm{kJ\\,mol^{-1}})^2$）的两倍多。这是由于广义力的内在方差大（$\\sigma_3^2=100.0$）、求积权重大（$w_3=0.2$）和有效样本量相对较小（$N_{\\mathrm{eff},3}=150$）共同作用的结果。因此，为了最有效地减少总误差，应优先将额外的采样分配给 $\\lambda=0.6$ 的窗口。",
            "answer": "$$\n\\boxed{0.233}\n$$"
        }
    ]
}