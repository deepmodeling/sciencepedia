{
    "hands_on_practices": [
        {
            "introduction": "为了奠定坚实的理论基础，我们从一个可精确求解的模型入手。该练习通过一个简单的谐振子系统，对比了自由能微扰（FEP）和热力学积分（TI）的统计效率。通过推导两种方法的解析方差，您将清晰地、定量地理解两个态之间的微扰程度如何直接影响自由能估算的收敛性。",
            "id": "3838810",
            "problem": "考虑一个一维经典构型坐标 $x \\in \\mathbb{R}$，其处于逆温度 $\\beta = 1/(k_{B} T)$ 下，并受到两个谐波势 $U_{0}(x) = \\frac{k_{0}}{2} x^{2}$ 和 $U_{1}(x) = \\frac{k_{1}}{2} x^{2}$ 的作用，其中 $k_{0} > 0$ 且 $k_{1} > 0$。令 $\\Delta k = k_{1} - k_{0}$ 且 $r = k_{1}/k_{0}$。对于一个势 $U(x)$，其正则配分函数为 $Z = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U(x)) \\, dx$，亥姆霍兹自由能为 $F = -\\beta^{-1} \\ln Z$。\n\n从这些定义和正则系综出发，完成以下任务：\n\n1. 推导该模型的精确解析自由能差 $\\Delta F = F_{1} - F_{0}$。\n2. 使用自由能微扰（FEP）恒等式，即在 $U_{0}$ 下采样并通过 $-\\beta^{-1} \\ln \\langle \\exp[-\\beta (U_{1}(x) - U_{0}(x))] \\rangle_{0}$ 来估计 $\\Delta F$，推导当 $x$ 根据 $U_{0}$ 的正则分布进行分布时，随机变量 $Y = \\exp[-\\beta (U_{1}(x) - U_{0}(x))]$ 的期望和方差的闭式表达式。然后，通过 delta 方法，得到基于 $N$ 个独立样本的 $\\Delta F$ 的 FEP 估计量的大样本渐近方差。\n3. 使用热力学积分（TI），对于 $\\lambda \\in [0,1]$，采用线性耦合路径 $U_{\\lambda}(x) = \\frac{1}{2} \\big(k_{0} + \\lambda \\Delta k\\big) x^{2}$，推导该模型的 TI 表达式 $\\Delta F = \\int_{0}^{1} \\langle \\partial U_{\\lambda} / \\partial \\lambda \\rangle_{\\lambda} \\, d\\lambda$。然后，在连续 $\\lambda$ 极限下，假设在每个 $\\lambda$ 处进行独立采样且求积误差可忽略不计，推导当在每个 $\\lambda$ 处收集 $N$ 个独立样本时，$\\Delta F$ 的 TI 估计量的大样本渐近方差的闭式表达式。\n4. 最后，给出一个关于 $r = k_{1}/k_{0}$ 的 FEP 渐近方差与 TI 渐近方差之比 $R(r)$ 的单一闭式解析表达式，该表达式在两种方差均为有限的范围内有效。\n\n你的最终答案必须仅为 $R(r)$ 的表达式。不需要进行数值计算。如果进行任何中间数值简化，除非最终表达式另有要求，否则请以符号形式保留常数。最终答案是无量纲的。",
            "solution": "该问题被验证为具有科学依据、适定且客观。它提出了一个统计力学中标准、可解析求解的问题，用于比较自由能微扰（FEP）和热力学积分（TI）的统计效率。\n\n求解过程按要求分为四个阶段：\n1.  推导精确解析自由能差 $\\Delta F$。\n2.  推导 FEP 估计量的渐近方差。\n3.  推导 TI 估计量的渐近方差。\n4.  推导这些方差的比率 $R(r)$。\n\n**1. 精确解析自由能差**\n\n状态 $i$（其中 $i \\in \\{0, 1\\}$）的势能由 $U_i(x) = \\frac{k_i}{2} x^2$ 给出。正则配分函数 $Z_i$ 是通过对所有可能的构型 $x$ 上的玻尔兹曼因子进行积分来计算的。这是一个标准的高斯积分。\n$$Z_i = \\int_{-\\infty}^{\\infty} \\exp(-\\beta U_i(x)) \\, dx = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_i}{2} x^2\\right) \\, dx$$\n使用高斯积分的已知结果 $\\int_{-\\infty}^{\\infty} \\exp(-a x^2) \\, dx = \\sqrt{\\frac{\\pi}{a}}$，我们令 $a = \\frac{\\beta k_i}{2}$ 得到：\n$$Z_i = \\sqrt{\\frac{2\\pi}{\\beta k_i}}$$\n亥姆霍兹自由能 $F_i$ 通过 $F_i = -\\beta^{-1} \\ln Z_i$ 与配分函数相关联。\n$$F_i = -\\beta^{-1} \\ln\\left(\\sqrt{\\frac{2\\pi}{\\beta k_i}}\\right) = -\\frac{1}{2\\beta} \\ln\\left(\\frac{2\\pi}{\\beta k_i}\\right) = \\frac{1}{2\\beta} \\ln\\left(\\frac{\\beta k_i}{2\\pi}\\right)$$\n因此，自由能差 $\\Delta F = F_1 - F_0$ 为：\n$$\\Delta F = F_1 - F_0 = \\frac{1}{2\\beta} \\ln\\left(\\frac{\\beta k_1}{2\\pi}\\right) - \\frac{1}{2\\beta} \\ln\\left(\\frac{\\beta k_0}{2\\pi}\\right) = \\frac{1}{2\\beta} \\left[ \\ln(\\beta k_1) - \\ln(\\beta k_0) \\right]$$\n$$\\Delta F = \\frac{1}{2\\beta} \\ln\\left(\\frac{k_1}{k_0}\\right) = \\frac{1}{2\\beta} \\ln(r)$$\n其中 $r = k_1/k_0$。\n\n**2. 自由能微扰（FEP）方差**\n\n$\\Delta F$ 的 FEP 估计量由 $\\hat{F}_{\\text{FEP}} = -\\beta^{-1} \\ln(\\bar{Y})$ 给出，其中 $\\bar{Y}$ 是从状态 0 的正则分布中抽取的 $N$ 个样本上随机变量 $Y = \\exp[-\\beta (U_1(x) - U_0(x))]$ 的样本平均值。状态 0 的概率密度为 $p_0(x) = Z_0^{-1} \\exp(-\\beta U_0(x))$。\n势能差为 $\\Delta U(x) = U_1(x) - U_0(x) = \\frac{1}{2}(k_1 - k_0)x^2 = \\frac{\\Delta k}{2} x^2$。所以，$Y = \\exp\\left(-\\frac{\\beta \\Delta k}{2} x^2\\right)$。\n\n$Y$ 在系综 0 中的期望为：\n$$\\langle Y \\rangle_0 = \\int_{-\\infty}^{\\infty} Y p_0(x) \\, dx = \\frac{1}{Z_0} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta \\Delta k}{2} x^2\\right) \\exp\\left(-\\frac{\\beta k_0}{2} x^2\\right) \\, dx$$\n$$\\langle Y \\rangle_0 = \\frac{1}{Z_0} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta (k_0 + \\Delta k)}{2} x^2\\right) \\, dx = \\frac{1}{Z_0} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_1}{2} x^2\\right) \\, dx = \\frac{Z_1}{Z_0}$$\n使用 $Z_i$ 的表达式：\n$$\\langle Y \\rangle_0 = \\frac{\\sqrt{2\\pi/(\\beta k_1)}}{\\sqrt{2\\pi/(\\beta k_0)}} = \\sqrt{\\frac{k_0}{k_1}} = \\frac{1}{\\sqrt{r}}$$\n为了求 $Y$ 的方差，我们首先需要二阶矩 $\\langle Y^2 \\rangle_0$。\n$$Y^2 = \\exp\\left(-2 \\cdot \\frac{\\beta \\Delta k}{2} x^2\\right) = \\exp\\left(-\\beta \\Delta k x^2\\right)$$\n$$\\langle Y^2 \\rangle_0 = \\frac{1}{Z_0} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\Delta k x^2\\right) \\exp\\left(-\\frac{\\beta k_0}{2} x^2\\right) \\, dx = \\frac{1}{Z_0} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta (k_0 + 2\\Delta k)}{2} x^2\\right) \\, dx$$\n这个积分是 $\\sqrt{2\\pi/(\\beta(k_0+2\\Delta k))}$。该积分仅在 $k_0 + 2\\Delta k > 0$ 时收敛。\n$k_0 + 2(k_1 - k_0) > 0 \\implies 2k_1 - k_0 > 0 \\implies k_1/k_0 > 1/2 \\implies r > 1/2$。这是方差有限的条件。\n$$\\langle Y^2 \\rangle_0 = \\frac{\\sqrt{2\\pi/(\\beta(k_0+2\\Delta k))}}{\\sqrt{2\\pi/(\\beta k_0)}} = \\sqrt{\\frac{k_0}{k_0+2\\Delta k}} = \\sqrt{\\frac{k_0}{2k_1 - k_0}} = \\sqrt{\\frac{1}{2r-1}}$$\n对于大的 $N$，估计量 $\\hat{F}_{\\text{FEP}} = -\\beta^{-1}\\ln(\\bar{Y})$ 的方差使用 delta 方法求得：\n$$\\sigma^2_{\\text{FEP}} = \\text{Var}(\\hat{F}_{\\text{FEP}}) \\approx \\left( \\frac{\\partial (-\\beta^{-1} \\ln \\bar{Y})}{\\partial \\bar{Y}} \\bigg|_{\\bar{Y}=\\langle Y \\rangle_0} \\right)^2 \\text{Var}(\\bar{Y})$$\n当 $\\text{Var}(\\bar{Y}) = \\frac{1}{N}\\text{Var}_0(Y)$，且导数为 $-\\frac{1}{\\beta \\bar{Y}}$ 时，上式变为：\n$$\\sigma^2_{\\text{FEP}} = \\left(-\\frac{1}{\\beta \\langle Y \\rangle_0}\\right)^2 \\frac{\\text{Var}_0(Y)}{N} = \\frac{1}{N\\beta^2} \\frac{\\langle Y^2 \\rangle_0 - (\\langle Y \\rangle_0)^2}{(\\langle Y \\rangle_0)^2} = \\frac{1}{N\\beta^2} \\left( \\frac{\\langle Y^2 \\rangle_0}{(\\langle Y \\rangle_0)^2} - 1 \\right)$$\n代入我们的结果：\n$$\\frac{\\langle Y^2 \\rangle_0}{(\\langle Y \\rangle_0)^2} = \\frac{1/\\sqrt{2r-1}}{(1/\\sqrt{r})^2} = \\frac{r}{\\sqrt{2r-1}}$$\nFEP 估计量的大样本渐近方差为：\n$$\\sigma^2_{\\text{FEP}} = \\frac{1}{N\\beta^2} \\left( \\frac{r}{\\sqrt{2r-1}} - 1 \\right)$$\n\n**3. 热力学积分（TI）方差**\n\n在 TI 中，$\\Delta F$ 是一个系综平均的积分：$\\Delta F = \\int_0^1 \\langle \\frac{\\partial U_\\lambda}{\\partial \\lambda} \\rangle_\\lambda \\, d\\lambda$。\n路径为 $U_\\lambda(x) = \\frac{1}{2} k_\\lambda x^2$，其中 $k_\\lambda = k_0 + \\lambda \\Delta k$。\n导数为 $\\frac{\\partial U_\\lambda}{\\partial \\lambda} = \\frac{1}{2} \\frac{d k_\\lambda}{d\\lambda} x^2 = \\frac{\\Delta k}{2} x^2$。\nTI 被积函数为 $I(\\lambda) = \\langle \\frac{\\partial U_\\lambda}{\\partial \\lambda} \\rangle_\\lambda = \\frac{\\Delta k}{2} \\langle x^2 \\rangle_\\lambda$。\n系综平均 $\\langle x^2 \\rangle_\\lambda$ 是坐标 $x$ 在势 $U_\\lambda$ 下的方差，这是一个方差为 $(\\beta k_\\lambda)^{-1}$ 的高斯分布。因此，$\\langle x^2 \\rangle_\\lambda = \\frac{1}{\\beta k_\\lambda}$。\n$$I(\\lambda) = \\frac{\\Delta k}{2\\beta k_\\lambda}$$\nTI 估计量为 $\\hat{F}_{\\text{TI}} = \\int_0^1 \\hat{I}(\\lambda) d\\lambda$，其中 $\\hat{I}(\\lambda)$ 是在每个 $\\lambda$ 处 $\\frac{\\partial U_\\lambda}{\\partial \\lambda}$ 的 $N$ 个样本的均值。\n该估计量的方差为 $\\sigma^2_{\\text{TI}} = \\text{Var}(\\int_0^1 \\hat{I}(\\lambda) d\\lambda)$。假设在每个 $\\lambda$ 处进行独立采样且求积误差可忽略不计，则该式变为 $\\int_0^1 \\text{Var}(\\hat{I}(\\lambda)) d\\lambda$。\n$$\\text{Var}(\\hat{I}(\\lambda)) = \\frac{1}{N} \\text{Var}_\\lambda\\left(\\frac{\\partial U_\\lambda}{\\partial \\lambda}\\right) = \\frac{1}{N} \\left(\\frac{\\Delta k}{2}\\right)^2 \\text{Var}_\\lambda(x^2)$$\n对于均值为 0、方差为 $\\sigma_x^2 = (\\beta k_\\lambda)^{-1}$ 的高斯分布，$x^2$ 的方差为 $\\text{Var}(x^2) = \\langle x^4 \\rangle - (\\langle x^2 \\rangle)^2 = 3(\\sigma_x^2)^2 - (\\sigma_x^2)^2 = 2(\\sigma_x^2)^2$。\n所以，$\\text{Var}_\\lambda(x^2) = 2/(\\beta k_\\lambda)^2$。\n$$\\text{Var}(\\hat{I}(\\lambda)) = \\frac{1}{N} \\left(\\frac{\\Delta k}{2}\\right)^2 \\frac{2}{(\\beta k_\\lambda)^2} = \\frac{(\\Delta k)^2}{2N\\beta^2 k_\\lambda^2}$$\nTI 估计量的渐近方差是该量对 $\\lambda$ 的积分：\n$$\\sigma^2_{\\text{TI}} = \\int_0^1 \\frac{(\\Delta k)^2}{2N\\beta^2 k_\\lambda^2} \\, d\\lambda = \\frac{(\\Delta k)^2}{2N\\beta^2} \\int_0^1 \\frac{1}{(k_0 + \\lambda \\Delta k)^2} \\, d\\lambda$$\n该积分为：\n$$\\int_0^1 (k_0 + \\lambda \\Delta k)^{-2} \\, d\\lambda = \\left[ -\\frac{1}{\\Delta k} (k_0 + \\lambda \\Delta k)^{-1} \\right]_0^1 = -\\frac{1}{\\Delta k} \\left( \\frac{1}{k_1} - \\frac{1}{k_0} \\right) = -\\frac{1}{\\Delta k} \\frac{k_0-k_1}{k_0 k_1} = \\frac{k_1-k_0}{\\Delta k \\cdot k_0 k_1} = \\frac{1}{k_0 k_1}$$\n将此结果代回，我们得到：\n$$\\sigma^2_{\\text{TI}} = \\frac{(\\Delta k)^2}{2N\\beta^2} \\frac{1}{k_0 k_1} = \\frac{(k_1-k_0)^2}{2N\\beta^2 k_0 k_1}$$\n用 $r = k_1/k_0$ 表示：\n$$\\sigma^2_{\\text{TI}} = \\frac{(k_0 r - k_0)^2}{2N\\beta^2 k_0 (k_0 r)} = \\frac{k_0^2(r-1)^2}{2N\\beta^2 k_0^2 r} = \\frac{(r-1)^2}{2N\\beta^2 r}$$\n\n**4. 方差比 $R(r)$**\n\n问题要求 FEP 渐近方差与 TI 渐近方差的比率。即 $\\sigma^2_{\\text{FEP}}$ 与 $\\sigma^2_{\\text{TI}}$ 的比率。公共因子 $1/N$ 和 $1/\\beta^2$ 将会抵消。\n$$R(r) = \\frac{\\sigma^2_{\\text{FEP}}}{\\sigma^2_{\\text{TI}}} = \\frac{\\frac{1}{N\\beta^2} \\left( \\frac{r}{\\sqrt{2r-1}} - 1 \\right)}{\\frac{1}{N\\beta^2} \\frac{(r-1)^2}{2r}} = \\frac{\\frac{r - \\sqrt{2r-1}}{\\sqrt{2r-1}}}{\\frac{(r-1)^2}{2r}}$$\n$$R(r) = \\frac{2r(r - \\sqrt{2r-1})}{(r-1)^2 \\sqrt{2r-1}}$$\n该表达式在 $r > 1/2$ 且 $r \\neq 1$ 时有效。在 $r=1$ 处的奇点是可去的，并且 $\\lim_{r\\to 1} R(r) = 1$。此最终表达式即为所要求的方差比的闭式解析结果。",
            "answer": "$$\n\\boxed{\\frac{2r(r - \\sqrt{2r-1})}{(r-1)^{2} \\sqrt{2r-1}}}\n$$"
        },
        {
            "introduction": "在真实的炼金术自由能计算中，体系常常会遭遇“端点灾难”，即标准势函数会在原子出现或消失时导致波动的发散。本练习通过分析单个溶质原子与溶剂解耦合过程中势能导数的短程行为，深入探讨了这一关键问题。通过比较标准势和软核势下方法方差的标度关系，您将理解这个问题的数学根源，以及为何使用软核函数是确保计算稳健性的关键。",
            "id": "3838836",
            "problem": "在炼金术自由能计算中，自由能微扰 (FEP) 和热力学积分 (TI) 中估计量的收敛性关键取决于 TI 被积函数的统计行为。考虑在正则系综中，在温度 $T$ 下，单个溶质原子 $X$ 从均匀溶剂中解耦。溶质-溶剂间的非键相互作用由 Lennard-Jones $12$–$6$ 势和库仑势组成。对于标准（非软核）耦合方案，沿着炼金术路径的非键势能为 $U_{\\mathrm{nb}}(\\lambda) = \\lambda U_{\\mathrm{LJ}} + \\lambda U_{\\mathrm{C}}$，其中 $\\lambda \\in [0,1]$ 是耦合参数，$U_{\\mathrm{LJ}}$ 和 $U_{\\mathrm{C}}$ 分别是完整的 Lennard-Jones 能量和库仑能量。对于软核方案（使用常见的 Beutler 型软核），Lennard-Jones 部分被修改为\n$$\nU_{\\mathrm{LJ}}^{\\mathrm{sc}}(r;\\lambda) = 4\\varepsilon \\left[ \\lambda \\frac{\\sigma^{12}}{\\left(r^{6} + \\alpha (1-\\lambda)\\sigma^{6}\\right)^{2}} - \\lambda \\frac{\\sigma^{6}}{r^{6} + \\alpha (1-\\lambda)\\sigma^{6}} \\right],\n$$\n其中 $\\varepsilon$ 和 $\\sigma$ 是 Lennard-Jones 参数，$\\alpha > 0$ 是一个无量纲软核参数。库仑项像非软核情况一样进行线性缩放。\n\n令 $\\beta = 1/(k_{B}T)$，其中 $k_{B}$ 是玻尔兹曼常数。TI 估计量由系综平均 $\\langle \\partial U / \\partial \\lambda \\rangle_{\\lambda}$ 决定，其涨落由方差 $\\mathrm{Var}_{\\lambda}[\\partial U/\\partial \\lambda]$ 表征。假设溶剂数密度 $\\rho$ 是均匀的，并且当相互作用消失时（$\\lambda \\to 0$），对分布函数在短距离处趋近于 1。通过具有径向坐标 $r$ 和与 $4\\pi \\rho r^{2}\\mathrm{d}r$ 成正比的测度的最近邻溶剂自由度来模拟对涨落的主要短程贡献。\n\n使用第一性原理统计力学，并专注于领头阶短程行为，计算由下式定义的幂律标度指数 $\\alpha_{\\mathrm{no\\_sc}}$ 和 $\\alpha_{\\mathrm{sc}}$\n$$\n\\mathrm{Var}_{\\lambda}\\!\\left[\\frac{\\partial U}{\\partial \\lambda}\\right] \\sim C_{\\mathrm{no\\_sc}} \\lambda^{\\alpha_{\\mathrm{no\\_sc}}} \\quad \\text{对于非软核方案，以及} \\quad \\mathrm{Var}_{\\lambda}\\!\\left[\\frac{\\partial U}{\\partial \\lambda}\\right] \\sim C_{\\mathrm{sc}} \\lambda^{\\alpha_{\\mathrm{sc}}} \\quad \\text{对于软核方案，}\n$$\n在 $\\lambda \\to 0$ 时，其中 $C_{\\mathrm{no\\_sc}}$ 和 $C_{\\mathrm{sc}}$ 是不依赖于 $\\lambda$ 的正常数，它们取决于 $\\beta$、$\\varepsilon$、$\\sigma$、$\\alpha$ 和 $\\rho$。在发散性分析中将库仑贡献视为次领头项，并论证其对标度的影响。你的最终答案必须是使用 $\\mathrm{pmatrix}$ 环境表示为行矩阵的有序对 $(\\alpha_{\\mathrm{no\\_sc}}, \\alpha_{\\mathrm{sc}})$。无需四舍五入，最终的方框答案中不应报告任何单位。",
            "solution": "该问题要求确定当耦合参数 $\\lambda$ 趋近于零时，热力学积分 (TI) 被积函数 $\\frac{\\partial U}{\\partial \\lambda}$ 的方差的幂律标度指数。该方差 $\\mathrm{Var}_{\\lambda}\\!\\left[\\frac{\\partial U}{\\partial \\lambda}\\right]$ 是炼金术自由能计算收敛行为的一个关键指标。将对两种势方案进行分析：标准非软核方案和软核方案。\n\n在正则系综中，给定 $\\lambda$ 时，一个可观测量 $A$ 的方差定义为 $\\mathrm{Var}_{\\lambda}[A] = \\langle A^2 \\rangle_{\\lambda} - \\langle A \\rangle_{\\lambda}^2$。在我们的例子中，可观测量是 $A = \\frac{\\partial U}{\\partial \\lambda}$。系综平均 $\\langle \\cdot \\rangle_{\\lambda}$ 由下式给出\n$$\n\\langle F \\rangle_{\\lambda} = \\frac{\\int F(\\mathbf{r}) \\exp(-\\beta U(\\mathbf{r};\\lambda)) \\, d\\mathbf{r}}{\\int \\exp(-\\beta U(\\mathbf{r};\\lambda)) \\, d\\mathbf{r}}\n$$\n其中 $\\mathbf{r}$ 代表溶剂粒子的坐标。问题陈述我们可以通过考虑一个径向距离为 $r$、测度与 $4\\pi \\rho r^2 dr$ 成正比的单个最近邻溶剂粒子来模拟主要的短程贡献。这种简化，结合当 $\\lambda \\to 0$ 时对分布函数 $g(r) \\to 1$ 的假设，使我们能够将相关平均值写为关于 $r$ 的积分。\n\n当 $\\lambda \\to 0$ 时，势能 $U(\\lambda) \\to 0$，系统趋近于理想气体状态，其中玻尔兹曼因子 $\\exp(-\\beta U(\\lambda)) \\to 1$。在此极限下，方差主要由二阶矩 $\\langle (\\frac{\\partial U}{\\partial \\lambda})^2 \\rangle_{\\lambda}$ 决定。用于方差标度分析的控制积分是\n$$\nI(\\lambda) = \\int_0^\\infty \\left(\\frac{\\partial U(r;\\lambda)}{\\partial \\lambda}\\right)^2 \\exp(-\\beta U(r;\\lambda)) r^2 \\, dr\n$$\n当 $\\lambda \\to 0$ 时，该积分的发散性源于被积函数在小 $r$ 处的行为，在那里势可能是奇异的。\n\n首先，我们分析非软核方案。势能为 $U_{\\mathrm{nb}}(r;\\lambda) = \\lambda (U_{\\mathrm{LJ}}(r) + U_{\\mathrm{C}}(r))$。其对 $\\lambda$ 的导数为 $\\frac{\\partial U_{\\mathrm{nb}}}{\\partial \\lambda} = U_{\\mathrm{LJ}}(r) + U_{\\mathrm{C}}(r)$。\nLennard-Jones 势为 $U_{\\mathrm{LJ}}(r) = 4\\varepsilon [(\\frac{\\sigma}{r})^{12} - (\\frac{\\sigma}{r})^6]$，库仑势为 $U_{\\mathrm{C}}(r) \\propto r^{-1}$。在短距离处 ($r \\to 0$)，LJ 势的排斥项 $r^{-12}$ 主导 $r^{-6}$ 项和 $r^{-1}$ 的库仑项。因此，为了分析发散性，我们可以对小 $r$ 作出以下近似：\n$$\nU_{\\mathrm{nb}}(r;\\lambda) \\approx \\lambda \\cdot 4\\varepsilon \\sigma^{12} r^{-12}\n$$\n$$\n\\frac{\\partial U_{\\mathrm{nb}}}{\\partial \\lambda} \\approx 4\\varepsilon \\sigma^{12} r^{-12}\n$$\n这证明了在该方案中，将库仑贡献视为发散性分析的次领头项是合理的。令 $K = 4\\varepsilon \\sigma^{12}$。积分 $I(\\lambda)$ 的标度关系为\n$$\nI_{\\mathrm{no\\_sc}}(\\lambda) \\propto \\int_0^\\infty (K r^{-12})^2 \\exp(-\\beta \\lambda K r^{-12}) r^2 \\, dr = K^2 \\int_0^\\infty r^{-22} \\exp(-\\beta \\lambda K r^{-12}) \\, dr\n$$\n为了确定随 $\\lambda$ 的标度关系，我们进行变量替换。令 $u = \\beta \\lambda K r^{-12}$。则 $r^{-12} = u/(\\beta \\lambda K)$ 且 $r = (u/(\\beta \\lambda K))^{-1/12}$。微分为 $dr = -\\frac{1}{12}(\\beta \\lambda K)^{1/12} u^{-13/12} du$。\n将这些代入包括 $r^2 dr$ 测度的完整积分中：\n$$\nI_{\\mathrm{no\\_sc}}(\\lambda) \\propto \\int_\\infty^0 \\left(\\frac{u}{\\beta \\lambda K}\\right)^{22/12} \\exp(-u) \\left(\\frac{u}{\\beta \\lambda K}\\right)^{-2/12} \\left(-\\frac{1}{12}\\frac{dr}{du}\\right) \\, du\n$$\n$$\n\\propto (\\beta \\lambda K)^{-(22-2+1)/12} \\int_0^\\infty u^{(22-2-13)/12} \\exp(-u) \\, du = (\\lambda)^{-21/12} \\int_0^\\infty u^{7/12} \\exp(-u) \\, du\n$$\n该积分是一个不依赖于 $\\lambda$ 的常数（Γ函数）。因此，标度关系由前置因子决定：\n$$\nI_{\\mathrm{no\\_sc}}(\\lambda) \\propto \\lambda^{-21/12} = \\lambda^{-7/4}\n$$\n由于 $\\mathrm{Var}_{\\lambda}[\\frac{\\partial U}{\\partial \\lambda}] \\propto I_{\\mathrm{no\\_sc}}(\\lambda)$，我们发现 $\\mathrm{Var}_{\\lambda}[\\frac{\\partial U}{\\partial \\lambda}] \\sim C_{\\mathrm{no\\_sc}} \\lambda^{-7/4}$。将此与给定的形式 $\\lambda^{\\alpha_{\\mathrm{no\\_sc}}}$ 进行比较，我们确定指数为 $\\alpha_{\\mathrm{no\\_sc}} = -7/4$。\n\n接下来，我们分析软核方案。势能为 $U(r;\\lambda) = U_{\\mathrm{LJ}}^{\\mathrm{sc}}(r;\\lambda) + \\lambda U_{\\mathrm{C}}(r)$。软核势的关键特征是它对 $r=0$ 处奇点的正则化。当 $r \\to 0$ 时，软核势 $U_{\\mathrm{LJ}}^{\\mathrm{sc}}(r;\\lambda)$ 趋近于一个有限值：\n$$\n\\lim_{r\\to 0} U_{\\mathrm{LJ}}^{\\mathrm{sc}}(r;\\lambda) = 4\\varepsilon \\left[ \\lambda \\frac{\\sigma^{12}}{(\\alpha(1-\\lambda)\\sigma^6)^2} - \\lambda \\frac{\\sigma^6}{\\alpha(1-\\lambda)\\sigma^6} \\right] = \\frac{4\\varepsilon\\lambda}{\\alpha(1-\\lambda)} \\left( \\frac{1}{\\alpha(1-\\lambda)} - 1 \\right)\n$$\n对于 $\\lambda \\in [0, 1)$，该值是有限的，并且当 $\\lambda \\to 0$ 时趋于 $0$。硬核奇点被移除了。TI 被积函数是 $\\frac{\\partial U}{\\partial \\lambda} = \\frac{\\partial U_{\\mathrm{LJ}}^{\\mathrm{sc}}}{\\partial \\lambda} + U_{\\mathrm{C}}(r)$。\n为分析方差，我们考虑其在 $\\lambda \\to 0$ 时的行为。在此极限下，系统趋近于理想气体状态，如果其矩的积分收敛，则方差趋近于一个良定义的极限。\n$$\n\\lim_{\\lambda \\to 0} \\mathrm{Var}_{\\lambda}\\!\\left[\\frac{\\partial U}{\\partial \\lambda}\\right] = \\mathrm{Var}_{0}\\!\\left[\\lim_{\\lambda \\to 0} \\frac{\\partial U}{\\partial \\lambda}\\right]\n$$\n我们需要导数的极限。令 $D(r, \\lambda) = r^6 + \\alpha (1-\\lambda)\\sigma^6$。当 $\\lambda \\to 0$ 时，$D \\to r^6 + \\alpha \\sigma^6$。软核 LJ 项的导数是\n$$\n\\frac{\\partial U_{\\mathrm{LJ}}^{\\mathrm{sc}}}{\\partial \\lambda} = U_{\\mathrm{LJ}}^{\\mathrm{sc}}/\\lambda + \\lambda \\frac{\\partial (U_{\\mathrm{LJ}}^{\\mathrm{sc}}/\\lambda)}{\\partial \\lambda} = 4\\varepsilon \\left[ \\frac{\\sigma^{12}}{D^2} - \\frac{\\sigma^6}{D} \\right] + \\lambda \\left(\\dots\\right)\n$$\n在 $\\lambda \\to 0$ 的极限下，第二项消失，我们剩下\n$$\n\\lim_{\\lambda \\to 0} \\frac{\\partial U_{\\mathrm{LJ}}^{\\mathrm{sc}}}{\\partial \\lambda} = 4\\varepsilon \\left[ \\frac{\\sigma^{12}}{(r^6 + \\alpha\\sigma^6)^2} - \\frac{\\sigma^6}{r^6 + \\alpha\\sigma^6} \\right]\n$$\n这个函数对所有 $r \\ge 0$ 都是有限的。极限下的完整导数是\n$$\n\\lim_{\\lambda \\to 0} \\frac{\\partial U}{\\partial \\lambda} = 4\\varepsilon \\left[ \\frac{\\sigma^{12}}{(r^6 + \\alpha\\sigma^6)^2} - \\frac{\\sigma^6}{r^6 + \\alpha\\sigma^6} \\right] + U_{\\mathrm{C}}(r)\n$$\n在这种软核情况下，$\\lim_{\\lambda \\to 0} \\frac{\\partial U}{\\partial \\lambda}$ 的短程行为现在由库仑项 $U_{\\mathrm{C}}(r) \\propto r^{-1}$ 主导，因为软核 LJ 部分在 $r=0$ 处是正则的。在 $\\lambda=0$ 处的方差涉及一个形式为 $\\int_0^\\infty (\\lim_{\\lambda \\to 0} \\frac{\\partial U}{\\partial \\lambda})^2 r^2 \\, dr$ 的积分。被积函数在 $r=0$ 附近的行为由库仑项决定：\n$$\n\\text{被积函数} \\sim (U_{\\mathrm{C}}(r))^2 r^2 \\propto (r^{-1})^2 r^2 = 1\n$$\n由于被积函数在 $r \\to 0$ 时趋于一个常数，积分 $\\int_0^{\\delta} 1 \\, dr$ 是收敛的。在整个范围 $[0, \\infty)$ 上的积分也是收敛的，因为 $\\frac{\\partial U}{\\partial \\lambda}$ 在大 $r$ 处衰减得足够快。因此，$\\lim_{\\lambda \\to 0} \\mathrm{Var}_{\\lambda}[\\frac{\\partial U}{\\partial \\lambda}]$ 是一个有限的非零常数。一个在 $\\lambda \\to 0$ 时趋于非零常数的量，其幂律标度为 $\\lambda^0$。因此，$\\mathrm{Var}_{\\lambda}[\\frac{\\partial U}{\\partial \\lambda}] \\sim C_{\\mathrm{sc}} \\lambda^0$，这意味着指数是 $\\alpha_{\\mathrm{sc}} = 0$。\n\n标度指数对为 $(\\alpha_{\\mathrm{no\\_sc}}, \\alpha_{\\mathrm{sc}}) = (-7/4, 0)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{7}{4}  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "除了势能奇点，热力学态之间不良的相空间重叠是阻碍收敛的另一个主要障碍，对FEP方法尤其如此。本练习通过一个简单的二能级系统，生动地展示了当一个热力学上至关重要的构象被极少采样到时，FEP如何产生灾难性的失败。通过接着分析贝内特接受率（BAR）方法在同一系统中的表现，您将领会到为何利用双向数据的估算方法在根本上更为稳定和准确。",
            "id": "3838881",
            "problem": "考虑一个逆温为 $\\beta$ 的正则系综，其中两个热力学态 $A$ 和 $B$ 定义在一个共享的、离散的双构型空间 $x \\in \\{L,H\\}$（一个双能级系统）上。令势能差为 $\\Delta U(x) \\equiv U_B(x) - U_A(x)$。假设从状态 $A$ 采样得到以下已知的能量差分布：构型为 $L$ 的概率为 $P_A(L) = \\varepsilon$，此时 $\\Delta U(L) = 0$；构型为 $H$ 的概率为 $P_A(H) = 1 - \\varepsilon$，此时 $\\Delta U(H) = \\Delta$。使用无量纲能量单位，使得 $\\beta = 1$（即能量以 $k_B T$ 为单位）。取 $\\varepsilon = 10^{-3}$ 和 $\\Delta = 10$。\n\n仅使用平衡统计力学的基本原理（玻尔兹曼权重、配分函数和细致平衡），并且不引用特定估计量的公式，完成以下任务：\n\n1. 从配分函数之比和玻尔兹曼分布出发，推导平衡自由能差 $\\Delta F \\equiv F_B - F_A$ 关于状态 $A$ 下能量差分布的精确表达式，并针对给定的 $\\varepsilon$ 和 $\\Delta$ 计算其值。\n\n2. 为了分析前向自由能微扰（FEP）在重叠性差的情况下的失效模式，假设您从状态 $A$ 中抽取 $N_A = 500$ 个独立样本。计算这 $N_A$ 个样本中没有一个落在构型 $L$ 中的概率。在该事件发生的条件下，确定仅根据这些数据得出的前向 FEP 点估计值，并将其与第 1 部分中得到的精确 $\\Delta F$ 值进行定性比较。\n\n3. 为了评估 Bennett 接受率（BAR）方法的稳定性，考虑大样本、等样本数（$N_A = N_B$）且无偏置常数的极限情况。仅从由细致平衡和 $\\Delta F$ 定义所蕴含的 $P_B(x)$ 和 $P_A(x)$ 之间的正则系综关系出发，将此双能级系统的 BAR 自洽条件简化为一个关于 $\\Delta F$ 的标量方程，并进行求解。解释为什么即使在 $\\varepsilon \\ll 1$ 的情况下，该解仍然是稳定的。\n\n将自由能差 $\\Delta F$ 的最终数值答案以 $k_B T$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "本问题使用不同的计算方法，分析了一个简单的双能级系统中两个热力学态 $A$ 和 $B$ 之间自由能差 $\\Delta F$ 的计算。该分析是基于统计力学的第一性原理进行的。给定一个逆温为 $\\beta=1$ 的正则系综，其中能量以 $k_B T$ 为单位。该系统可以存在于两种构型中，$x \\in \\{L, H\\}$。两态之间的势能差为 $\\Delta U(x) \\equiv U_B(x) - U_A(x)$。当从状态 $A$ 采样时，系统以概率 $P_A(L) = \\varepsilon$ 处于构型 $L$，能量差为 $\\Delta U(L) = 0$。系统以概率 $P_A(H) = 1 - \\varepsilon$ 处于构型 $H$，能量差为 $\\Delta U(H) = \\Delta$。给定的数值为 $\\varepsilon = 10^{-3}$，$\\Delta = 10$，以及从状态 $A$ 的样本数为 $N_A = 500$。\n\n1. 精确自由能差 $\\Delta F$ 的推导。\n\n一个状态的亥姆霍兹自由能 $F$ 与其正则配分函数 $Z$ 的关系为 $F = -k_B T \\ln Z = -\\frac{1}{\\beta} \\ln Z$。对于具有离散构型 $x$ 的系统，其配分函数为 $Z = \\sum_x \\exp(-\\beta U(x))$。\n\n态 $B$ 和 $A$ 之间的自由能差 $\\Delta F$ 为：\n$$\n\\Delta F = F_B - F_A = -\\frac{1}{\\beta} \\ln Z_B - \\left(-\\frac{1}{\\beta} \\ln Z_A\\right) = -\\frac{1}{\\beta} \\ln\\left(\\frac{Z_B}{Z_A}\\right)\n$$\n配分函数之比可以表示为：\n$$\n\\frac{Z_B}{Z_A} = \\frac{\\sum_x \\exp(-\\beta U_B(x))}{\\sum_x \\exp(-\\beta U_A(x))}\n$$\n我们可以将 $U_B(x)$ 重写为 $U_A(x) + \\Delta U(x)$。将其代入分子得到：\n$$\n\\frac{Z_B}{Z_A} = \\frac{\\sum_x \\exp(-\\beta (U_A(x) + \\Delta U(x)))}{\\sum_x \\exp(-\\beta U_A(x))} = \\frac{\\sum_x \\exp(-\\beta U_A(x)) \\exp(-\\beta \\Delta U(x))}{\\sum_x \\exp(-\\beta U_A(x))}\n$$\n该表达式是系综 $A$ 上的热力学平均。在系综 $A$ 中观察到构型 $x$ 的概率是 $P_A(x) = \\frac{\\exp(-\\beta U_A(x))}{Z_A}$。因此表达式简化为：\n$$\n\\frac{Z_B}{Z_A} = \\sum_x \\frac{\\exp(-\\beta U_A(x))}{Z_A} \\exp(-\\beta \\Delta U(x)) = \\sum_x P_A(x) \\exp(-\\beta \\Delta U(x)) = \\left\\langle \\exp(-\\beta \\Delta U) \\right\\rangle_A\n$$\n这就得到了被称为 Zwanzig 公式或前向自由能微扰（FEP）恒等式的基本关系：\n$$\n\\Delta F = -\\frac{1}{\\beta} \\ln \\left\\langle \\exp(-\\beta \\Delta U) \\right\\rangle_A\n$$\n对于给定的双能级系统，该平均值是两个构型 $L$ 和 $H$ 上的和：\n$$\n\\left\\langle \\exp(-\\beta \\Delta U) \\right\\rangle_A = P_A(L) \\exp(-\\beta \\Delta U(L)) + P_A(H) \\exp(-\\beta \\Delta U(H))\n$$\n代入给定值 $\\beta=1$，$P_A(L)=\\varepsilon$，$P_A(H)=1-\\varepsilon$，$\\Delta U(L)=0$ 和 $\\Delta U(H)=\\Delta$：\n$$\n\\left\\langle \\exp(-\\Delta U) \\right\\rangle_A = \\varepsilon \\cdot \\exp(-0) + (1-\\varepsilon) \\cdot \\exp(-\\Delta) = \\varepsilon + (1-\\varepsilon)\\exp(-\\Delta)\n$$\n因此，精确的自由能差为：\n$$\n\\Delta F = -\\ln\\left( \\varepsilon + (1-\\varepsilon)\\exp(-\\Delta) \\right)\n$$\n使用数值 $\\varepsilon = 10^{-3}$ 和 $\\Delta = 10$：\n$$\n\\Delta F = -\\ln\\left( 10^{-3} + (1-10^{-3})\\exp(-10) \\right) = -\\ln\\left( 0.001 + 0.999 \\exp(-10) \\right)\n$$\n计算其值：\n$$\n\\Delta F \\approx -\\ln(0.001 + 0.999 \\times 4.53999 \\times 10^{-5}) = -\\ln(0.00104535) \\approx 6.86345\n$$\n四舍五入到四位有效数字，精确自由能差为 $6.863$ $k_B T$。\n\n2. 前向 FEP 失效模式分析。\n\n我们考虑从状态 $A$ 抽取 $N_A = 500$ 个独立样本。采样到构型 $L$ 的概率是 $P_A(L) = \\varepsilon = 10^{-3}$，采样到构型 $H$ 的概率是 $P_A(H) = 1-\\varepsilon = 0.999$。\n\n单个样本*不是*构型 $L$ 的概率是 $P_A(H) = 1-\\varepsilon$。由于这 $N_A$ 个样本是独立的，它们中*没有一个*是构型 $L$ 的概率是：\n$$\nP(\\text{在 } N_A \\text{ 次试验中没有L样本}) = (P_A(H))^{N_A} = (1-\\varepsilon)^{N_A} = (1-10^{-3})^{500} = (0.999)^{500} \\approx 0.6064\n$$\n这是一个很高的概率，意味着对于这个样本数量，错过稀有构型 $L$ 是一个非常可能发生的结果。\n\n在此事件发生的条件下，从状态 $A$ 抽出的所有 $N_A = 500$ 个样本（记为 $\\{x_i\\}$）都处于构型 $H$。对于有限样本，前向 FEP 估计量为：\n$$\n\\Delta F_{\\text{FEP}} = -\\frac{1}{\\beta} \\ln\\left( \\frac{1}{N_A} \\sum_{i=1}^{N_A} \\exp(-\\beta \\Delta U(x_i)) \\right)\n$$\n由于每个样本 $x_i$ 都是构型 $H$，我们有对所有 $i=1, \\dots, N_A$ 都有 $\\Delta U(x_i) = \\Delta$。当 $\\beta=1$ 时：\n$$\n\\Delta F_{\\text{FEP}} = -\\ln\\left( \\frac{1}{N_A} \\sum_{i=1}^{N_A} \\exp(-\\Delta) \\right) = -\\ln\\left( \\frac{1}{N_A} \\cdot N_A \\exp(-\\Delta) \\right) = -\\ln(\\exp(-\\Delta)) = \\Delta\n$$\n对于给定的值 $\\Delta=10$，FEP 点估计值为 $\\Delta F_{\\text{FEP}} = 10$。\n\n定性来看，这个 $10$ $k_B T$ 的估计值与约 $6.863$ $k_B T$ 的精确值有显著差异。该估计值存在灾难性的偏差。失败的原因在于 FEP 平均值 $\\langle \\exp(-\\Delta U) \\rangle_A$ 主要由稀有态 $L$ 的贡献所主导，对于该状态 $\\exp(-\\Delta U(L)) = \\exp(0) = 1$。而常见态 $H$ 的贡献是 $\\exp(-\\Delta) = \\exp(-10)$，可以忽略不计。由于未能采样到稀有但极其重要的状态 $L$，估计量只观察到高能量差的状态 $H$，导致对自由能差的巨大高估。\n\n3. Bennett 接受率（BAR）稳定性分析。\n\nBAR 方法结合了前向（$A$）和反向（$B$）两种模拟的数据。在大样本、等样本数极限下（$N_A = N_B$），BAR 对自由能差的估计值（我们记为 $C$）的自洽条件是：\n$$\n\\left\\langle f(\\beta(\\Delta U - C)) \\right\\rangle_A = \\left\\langle f(\\beta(C - \\Delta U)) \\right\\rangle_B\n$$\n其中 $f(u) = (1+\\exp(u))^{-1}$ 是费米函数。题目要求我们证明精确自由能差 $\\Delta F$ 是此方程的解。我们从两个系综中概率分布之间的关系开始：\n$$\nP_B(x) = \\frac{\\exp(-\\beta U_B(x))}{Z_B} = \\frac{\\exp(-\\beta (U_A(x)+\\Delta U(x)))}{Z_A \\exp(-\\beta \\Delta F)} = P_A(x) \\exp(\\beta(\\Delta F - \\Delta U(x)))\n$$\n利用这个关系，我们可以将系综 $B$ 上的平均值表示为系综 $A$ 上的平均值：\n$$\n\\left\\langle g(x) \\right\\rangle_B = \\sum_x P_B(x) g(x) = \\sum_x P_A(x) \\exp(\\beta(\\Delta F - \\Delta U(x))) g(x) = \\left\\langle g(x) \\exp(\\beta(\\Delta F - \\Delta U(x))) \\right\\rangle_A\n$$\nBAR 方程的右侧变为：\n$$\n\\left\\langle f(\\beta(C - \\Delta U)) \\right\\rangle_B = \\left\\langle f(\\beta(C - \\Delta U)) \\exp(\\beta(\\Delta F - \\Delta U)) \\right\\rangle_A\n$$\n因此，用于求解 $C$ 的 BAR 方程为：\n$$\n\\left\\langle f(\\beta(\\Delta U - C)) \\right\\rangle_A = \\left\\langle f(\\beta(C - \\Delta U)) \\exp(\\beta(\\Delta F - \\Delta U)) \\right\\rangle_A\n$$\n我们现在验证 $C=\\Delta F$ 是解。令 $C = \\Delta F$ 并定义简写 $W(x) = \\beta(\\Delta U(x) - \\Delta F)$。方程变为：\n$$\n\\left\\langle f(W(x)) \\right\\rangle_A = \\left\\langle f(-W(x)) \\exp(-W(x)) \\right\\rangle_A\n$$\n让我们检查一下右侧平均值内的项：\n$$\nf(-W(x)) \\exp(-W(x)) = \\frac{1}{1+\\exp(-W(x))} \\exp(-W(x)) = \\frac{\\exp(-W(x))}{1+\\exp(-W(x))}\n$$\n分子和分母同乘以 $\\exp(W(x))$：\n$$\n\\frac{\\exp(-W(x))\\exp(W(x))}{(1+\\exp(-W(x)))\\exp(W(x))} = \\frac{1}{\\exp(W(x))+1} = f(W(x))\n$$\n因此，该方程简化为 $\\langle f(W(x)) \\rangle_A = \\langle f(W(x)) \\rangle_A$，这是一个恒等式。这证明了在大样本极限下，精确自由能差 $\\Delta F$ 是 BAR 自洽方程的解。题目所要求的标量方程就是 BAR 方程本身，解析求解表明其解为 $\\Delta F$。因此，其值与第 1 部分计算出的值相同。\n\n即使在 $\\varepsilon \\ll 1$ 的情况下，BAR 方法仍然稳定，主要有两个原因。首先，被平均的函数，即费米函数 $f(u)$，是有界的（介于 0 和 1 之间）。这“压制”了在 FEP 中导致不稳定的有问题的指数项，防止任何单个稀有事件主导平均值。其次，BAR 对称地使用来自两个系综的信息。在我们的问题中，状态 $L$ 在系综 $A$ 中是稀有的（概率 $\\varepsilon=10^{-3}$），但在系综 $B$ 中是占主导地位的（概率 $P_B(L) \\approx 0.957$）。相反，状态 $H$ 在系综 $A$ 中占主导地位（概率 $1-\\varepsilon = 0.999$），但在系综 $B$ 中是稀有的。来自模拟 $A$ 的 FEP 会失败，因为它很可能会错过关键的状态 $L$。而在 BAR 中，即使从 $A$ 的采样错过了状态 $L$，从 $B$ 的采样也会稳健地捕获它。BAR 方程有效地平衡了统计信息，使用来自模拟 $A$ 的数据来约束状态 $H$ 的性质，并使用来自模拟 $B$ 的数据来约束状态 $L$ 的性质。这种对称地使用来自两个模拟的信息，结合估计量的有界性，确保了即使在重叠性差、FEP 会灾难性失败的情况下，也能得到稳定和准确的结果。",
            "answer": "$$\\boxed{6.863}$$"
        }
    ]
}