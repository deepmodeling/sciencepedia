{
    "hands_on_practices": [
        {
            "introduction": "The central challenge in ab initio protein structure prediction is navigating the astronomically vast conformational space to find the single, native structure. This thought experiment  provides a tangible sense of this scale, often referred to as Levinthal's paradox, by using a simplified lattice model. By calculating the number of possible conformations for a short peptide on two different lattices, you will discover how quickly the search space explodes and gain insight into why local geometry, captured by the coordination number $z$, is a crucial determinant.",
            "id": "2369923",
            "problem": "In ab initio protein structure prediction, simplified lattice models are often used to estimate the size of the conformational search space. Consider a homopolymeric chain of length $12$ (a $12$-mer), represented on discrete lattices. Model the chain as a non-reversing nearest-neighbor walk: starting from an initial monomer anchored at the origin, each subsequent monomer occupies a site that is a nearest neighbor of the previous monomer, with the only steric constraint that immediate backtracking to the site just visited is disallowed. To remove redundancy due to global translations and rotations, the first bond vector (from monomer $1$ to monomer $2$) is fixed along a reference lattice direction.\n\nLet the number of bonds be $m$, where a $12$-mer has $m=11$. Let the coordination number (number of nearest neighbors per lattice site) be $z$. For the two lattices considered here, the two-dimensional triangular lattice has $z_{\\mathrm{tri}}=6$, and the three-dimensional simple cubic lattice has $z_{\\mathrm{sc}}=6$.\n\nUnder these assumptions, determine the total number of distinct conformations available to the chain on each lattice, and report as your final answer the ratio of the conformational space sizes (triangular to cubic) as a single real number. No rounding is required, and no units are needed.",
            "solution": "The chain comprises $12$ monomers, so there are $m=11$ bonds (or steps) in the walk. The first monomer is anchored at the origin, and the first bond vector is fixed along a reference direction to eliminate degeneracy due to global translations and rotations. Therefore, the number of choices begins with the second bond.\n\nAt each step after the first bond, the non-reversing constraint allows all nearest-neighbor directions except the one that returns to the immediately previous site. If the lattice coordination number is $z$, then at each such step there are $z-1$ allowed directions.\n\nBecause the first bond direction is fixed, the number of distinct conformations is determined by the sequence of choices for the remaining $m-1$ bonds. Thus, for a lattice with coordination number $z$, the total number of conformations under these assumptions is\n$$\n(z-1)^{m-1}.\n$$\nFor the two lattices:\n- Two-dimensional triangular lattice: $z_{\\mathrm{tri}}=6$, yielding\n$$\n\\text{triangular count}=(6-1)^{11-1}=5^{10}.\n$$\n- Three-dimensional simple cubic lattice: $z_{\\mathrm{sc}}=6$, yielding\n$$\n\\text{cubic count}=(6-1)^{11-1}=5^{10}.\n$$\nTherefore, the ratio of the conformational space sizes (triangular to cubic) is\n$$\n\\frac{5^{10}}{5^{10}}=1.\n$$\nThis is a direct consequence of the two lattices having the same coordination number $z=6$ under the non-reversing walk model with the first bond direction fixed.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "If the conformational space is a vast landscape, the potential energy function is the map that guides us to the lowest point. This exercise  delves into a critical component of this map: the torsional potential governing the peptide bond dihedral angle, $\\omega$. You will use a standard Fourier series model to quantify the energy difference between the cis and trans states, and then apply this framework to rationalize the unique conformational preferences of proline, a common exception in protein structures.",
            "id": "3834586",
            "problem": "In ab initio protein structure prediction within computational chemical biology, conformational energetics are derived from first principles grounded in the Born–Oppenheimer approximation and the periodicity of torsional degrees of freedom in covalent frameworks. The peptide bond dihedral angle, denoted by $\\omega$, is constrained near planarity due to partial double-bond character resulting from resonance, leading to favored trans and disfavored cis configurations. Consider a peptide backbone torsional potential modeled as a truncated Fourier series,\n$$\nV(\\omega) \\;=\\; \\sum_{n=1}^{3} k_n \\left[\\, 1 + \\cos(n\\,\\omega - \\delta_n) \\,\\right],\n$$\nwhere $\\omega$ is measured in radians, $k_n$ are energy coefficients expressed in kilocalories per mole, and $\\delta_n$ are phase offsets. Use the following physically plausible parameters consistent with a non-proline peptide:\n- $k_1 = 1.6$ (kilocalories per mole), $\\delta_1 = 0$,\n- $k_2 = 1.2$ (kilocalories per mole), $\\delta_2 = 0$,\n- $k_3 = 0.25$ (kilocalories per mole), $\\delta_3 = \\pi$.\n\nDefine the cis state by $\\omega_{\\mathrm{cis}} = 0$ and the trans state by $\\omega_{\\mathrm{trans}} = \\pi$. Starting from the physical meaning of $V(\\omega)$ as a torsional energy penalty due to electronic and steric interactions and the periodicity implied by rotational symmetry, compute the energy difference\n$$\n\\Delta E \\;=\\; V(\\omega_{\\mathrm{cis}})\\;-\\;V(\\omega_{\\mathrm{trans}}).\n$$\nExpress the final energy difference in kilocalories per mole and round your answer to four significant figures. Finally, rationalize—without introducing any new numerical parameters—why the special case of proline typically exhibits a smaller $\\Delta E$ between cis and trans than other amino acids, using the same Fourier-based representation to explain the effect of ring constraints on the odd-$n$ harmonics.",
            "solution": "The torsional potential energy $V(\\omega)$ of a peptide bond is given by the truncated Fourier series:\n$$\nV(\\omega) \\;=\\; \\sum_{n=1}^{3} k_n \\left[\\, 1 + \\cos(n\\,\\omega - \\delta_n) \\,\\right]\n$$\nThe parameters for a non-proline peptide are provided as:\n- $n=1$: $k_1 = 1.6 \\, \\text{kcal/mol}$, $\\delta_1 = 0$\n- $n=2$: $k_2 = 1.2 \\, \\text{kcal/mol}$, $\\delta_2 = 0$\n- $n=3$: $k_3 = 0.25 \\, \\text{kcal/mol}$, $\\delta_3 = \\pi$\n\nFirst, we write out the explicit form of the potential energy function by substituting these parameters.\n$$\nV(\\omega) = k_1 [1 + \\cos(1 \\cdot \\omega - \\delta_1)] + k_2 [1 + \\cos(2 \\cdot \\omega - \\delta_2)] + k_3 [1 + \\cos(3 \\cdot \\omega - \\delta_3)]\n$$\n$$\nV(\\omega) = 1.6 [1 + \\cos(\\omega - 0)] + 1.2 [1 + \\cos(2\\omega - 0)] + 0.25 [1 + \\cos(3\\omega - \\pi)]\n$$\nUsing the trigonometric identity $\\cos(x - \\pi) = -\\cos(x)$, the third term becomes $0.25[1 - \\cos(3\\omega)]$. The full expression is:\n$$\nV(\\omega) = 1.6 [1 + \\cos(\\omega)] + 1.2 [1 + \\cos(2\\omega)] + 0.25 [1 - \\cos(3\\omega)]\n$$\nThe problem requires the computation of the energy difference $\\Delta E = V(\\omega_{\\mathrm{cis}}) - V(\\omega_{\\mathrm{trans}})$, where the cis state is at $\\omega_{\\mathrm{cis}} = 0$ radians and the trans state is at $\\omega_{\\mathrm{trans}} = \\pi$ radians.\n\nWe evaluate the potential at $\\omega_{\\mathrm{cis}} = 0$:\n$$\nV(\\omega_{\\mathrm{cis}}) = V(0) = 1.6 [1 + \\cos(0)] + 1.2 [1 + \\cos(0)] + 0.25 [1 - \\cos(0)]\n$$\nSince $\\cos(0) = 1$:\n$$\nV(0) = 1.6 [1 + 1] + 1.2 [1 + 1] + 0.25 [1 - 1]\n$$\n$$\nV(0) = 1.6(2) + 1.2(2) + 0.25(0) = 3.2 + 2.4 + 0 = 5.6 \\, \\text{kcal/mol}\n$$\nNext, we evaluate the potential at $\\omega_{\\mathrm{trans}} = \\pi$:\n$$\nV(\\omega_{\\mathrm{trans}}) = V(\\pi) = 1.6 [1 + \\cos(\\pi)] + 1.2 [1 + \\cos(2\\pi)] + 0.25 [1 - \\cos(3\\pi)]\n$$\nUsing the values $\\cos(\\pi) = -1$, $\\cos(2\\pi) = 1$, and $\\cos(3\\pi) = -1$:\n$$\nV(\\pi) = 1.6 [1 + (-1)] + 1.2 [1 + 1] + 0.25 [1 - (-1)]\n$$\n$$\nV(\\pi) = 1.6(0) + 1.2(2) + 0.25(2) = 0 + 2.4 + 0.5 = 2.9 \\, \\text{kcal/mol}\n$$\nThe energy difference $\\Delta E$ is then:\n$$\n\\Delta E = V(0) - V(\\pi) = 5.6 - 2.9 = 2.7 \\, \\text{kcal/mol}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\Delta E = 2.700 \\, \\text{kcal/mol}\n$$\n\nFor the second part, we must rationalize why proline exhibits a smaller $\\Delta E$. To do this rigorously using the Fourier representation, we first derive a general expression for $\\Delta E$.\n$$\n\\Delta E = V(0) - V(\\pi) = \\sum_{n=1}^{3} k_n [1 + \\cos(0 - \\delta_n)] - \\sum_{n=1}^{3} k_n [1 + \\cos(n\\pi - \\delta_n)]\n$$\n$$\n\\Delta E = \\sum_{n=1}^{3} k_n \\left\\{ [1 + \\cos(-\\delta_n)] - [1 + \\cos(n\\pi - \\delta_n)] \\right\\}\n$$\nUsing $\\cos(-x) = \\cos(x)$ and $\\cos(n\\pi - x) = \\cos(n\\pi)\\cos(x) = (-1)^n \\cos(x)$:\n$$\n\\Delta E = \\sum_{n=1}^{3} k_n [\\cos(\\delta_n) - (-1)^n\\cos(\\delta_n)] = \\sum_{n=1}^{3} k_n \\cos(\\delta_n) [1 - (-1)^n]\n$$\nThe term $[1 - (-1)^n]$ is $0$ for even $n$ and $2$ for odd $n$. This proves that the energy difference between the perfect cis and trans states is determined exclusively by the odd-$n$ harmonics of the potential. For $n=1, 2, 3$:\n$$\n\\Delta E = 2k_1\\cos(\\delta_1) + 0 \\cdot k_2\\cos(\\delta_2) + 2k_3\\cos(\\delta_3) = 2k_1\\cos(\\delta_1) + 2k_3\\cos(\\delta_3)\n$$\nThese odd harmonics, particularly the $n=1$ term, represent the energetic asymmetry between the cis and trans states. Physically, this asymmetry arises primarily from steric repulsion between the C$_{\\alpha}$ carbons and their substituents on adjacent residues. For a non-proline peptide, the trans arrangement ($\\omega = \\pi$) minimizes this repulsion, while the cis arrangement ($\\omega = 0$) results in a severe steric clash, leading to a large, positive $\\Delta E$. The large value of $k_1$ in the given parameters reflects this strong preference.\n\nIn proline, the side chain is cyclized and bonded to the backbone nitrogen atom, forming a rigid pyrrolidine ring. This unique structure alters the steric landscape:\n1. The bulk of the proline ring itself introduces steric clashes. In the trans conformation of an X-Pro peptide bond (where X is any amino acid), there is a clash between the C$_{\\alpha}$ of residue X and the C$_{\\delta}$ of the proline ring.\n2. In the cis conformation, the clash is between the C$_{\\alpha}$ of residue X and the C$_{\\alpha}$ of proline.\nCritically, the steric penalties in cis and trans prolyl-peptides are of more comparable magnitude than in non-proline peptides. The trans state is destabilized (its energy is raised) relative to a typical peptide bond, while the cis state is relatively less unfavorable. This reduces the overall energy difference between the two states.\n\nConnecting this physical reasoning back to the Fourier model, a reduced energetic asymmetry between the cis and trans states implies that the amplitudes of the odd harmonics, which mathematically encode this asymmetry, must be smaller. The dominant odd term is the $n=1$ harmonic, with amplitude governed by $k_1$. Therefore, for a proline residue, the parameter $k_1$ is expected to be significantly smaller than for a non-proline residue. According to the derived expression $\\Delta E = 2k_1\\cos(\\delta_1) + 2k_3\\cos(\\delta_3)$, a smaller $k_1$ directly leads to a smaller value for $\\Delta E$, which is consistent with the experimental observation that the cis-trans energy gap is smaller for proline.",
            "answer": "$$\\boxed{2.700}$$"
        },
        {
            "introduction": "This practice moves from analyzing individual energy terms to building a complete, albeit simplified, structure prediction engine from first principles . You will implement a four-letter (Hydrophobic, Polar, Negative, Cationic) lattice model, which incorporates both the hydrophobic effect and basic electrostatics through salt bridges. By performing an exhaustive search for a short peptide, you will directly confront the interplay between sequence, conformation, and energy to find an optimal structure, gaining practical skills in computational modeling.",
            "id": "2369976",
            "problem": "You are asked to formalize and implement an extension of the two-dimensional ($2$D) Hydrophobic-Polar (HP) lattice protein model to a four-letter alphabet model that includes charged residues, denoted Hydrophobic, Polar, Negative, Cationic (HPNC). The goal is to search for a short polypeptide sequence and a self-avoiding $2$D conformation on a square lattice that together achieve a minimal additive contact energy while containing at least one salt bridge. A salt bridge is defined here as a non-consecutive nearest-neighbor lattice contact between a Negative and a Cationic residue.\n\nStart from first principles that are appropriate for lattice protein models used in ab initio protein structure prediction. The fundamental base must be the following facts, without using any shortcut formulas:\n- Proteins can be abstracted as self-avoiding walks on a lattice, where each residue occupies one lattice site and consecutive residues are adjacent on the lattice. Only non-consecutive nearest-neighbor residue pairs are considered as contact interactions.\n- The hydrophobic effect motivates a favorable attraction between hydrophobic residues when they are in contact, modeled by a negative contact energy contribution for hydrophobic-hydrophobic contacts.\n- Electrostatic interactions between charged residues motivate favorable energy for opposite-charge contacts and unfavorable energy for like-charge contacts. In a coarse-grained lattice model at lattice spacing as the unit length, one can approximate this with a constant negative contribution for unlike charges and a constant positive contribution for like charges, applied only to nearest-neighbor non-consecutive contacts.\n- Additivity assumption: the total energy is the sum over pairwise contact energies across all non-consecutive contacting residue pairs.\n\nYour program must implement the following precise model and search protocol.\n- Residue types are an alphabet of size $4$: Hydrophobic ($\\mathrm{H}$), Polar ($\\mathrm{P}$), Negative ($\\mathrm{N}$), and Cationic ($\\mathrm{C}$). A sequence is a string of length $L$ over this alphabet.\n- A conformation is a self-avoiding walk of length $L$ on the $2$D square lattice with coordinates in $\\mathbb{Z}^2$, specified as a list of lattice coordinates $\\left[(x_0,y_0),(x_1,y_1),\\dots,(x_{L-1},y_{L-1})\\right]$ with unit steps and no repeated coordinates. To avoid redundant symmetries, fix $(x_0,y_0)=(0,0)$ and $(x_1,y_1)=(1,0)$.\n- Define the contact set $\\mathcal{C}$ for a conformation as all unordered index pairs $(i,j)$ with $0 \\le i  j \\le L-1$, such that $|i-j| \\ge 2$ and the Manhattan distance between $(x_i,y_i)$ and $(x_j,y_j)$ equals $1$.\n- Define the pairwise contact energy function $\\varepsilon(a,b)$ for residue types $a$ and $b$ as follows, using parameters $e_{\\mathrm{HH}}$, $e_{\\mathrm{NC}}$, and $e_{\\mathrm{like}}$ supplied per test case. Let $\\mathrm{H}=0$, $\\mathrm{P}=1$, $\\mathrm{N}=2$, $\\mathrm{C}=3$ for encoding. Then:\n  - $\\varepsilon(\\text{H},\\text{H})=\\varepsilon(0,0)=e_{\\mathrm{HH}}$.\n  - $\\varepsilon(\\text{N},\\text{C})=\\varepsilon(2,3)=\\varepsilon(\\text{C},\\text{N})=\\varepsilon(3,2)=e_{\\mathrm{NC}}$.\n  - $\\varepsilon(\\text{N},\\text{N})=\\varepsilon(2,2)=e_{\\mathrm{like}}$ and $\\varepsilon(\\text{C},\\text{C})=\\varepsilon(3,3)=e_{\\mathrm{like}}$.\n  - All other residue pairs have $\\varepsilon(a,b)=0$.\n- For a sequence $\\{t_i\\}_{i=0}^{L-1}$ and a conformation with contact set $\\mathcal{C}$, the total energy is\n  $$E=\\sum_{(i,j)\\in\\mathcal{C}}\\varepsilon\\left(t_i,t_j\\right).$$\n- The salt bridge count is\n  $$S=\\left|\\left\\{(i,j)\\in\\mathcal{C}\\;:\\;\\{t_i,t_j\\}=\\{\\mathrm{N},\\mathrm{C}\\}\\right\\}\\right|.$$\n- A solution must have at least one salt bridge, i.e., $S \\ge 1$.\n\nSearch objective and tie-breaking:\n- Among all sequences of length $L$ over the HPNC alphabet and all valid conformations as defined above, find the pair that minimizes $E$ subject to $S \\ge 1$.\n- If multiple pairs achieve the same minimal $E$, choose the one with the largest $S$.\n- If there is still a tie, choose the lexicographically smallest sequence under the encoding $\\mathrm{H}=0$, $\\mathrm{P}=1$, $\\mathrm{N}=2$, $\\mathrm{C}=3$, comparing the integer lists from left to right.\n- If there is still a tie, choose the conformation whose flattened coordinate list $\\left[x_0,y_0,x_1,y_1,\\dots,x_{L-1},y_{L-1}\\right]$ is lexicographically smallest.\n\nSequence encoding and output representation:\n- Encode a sequence as a list of $L$ integers in $\\{0,1,2,3\\}$ corresponding to $\\mathrm{H},\\mathrm{P},\\mathrm{N},\\mathrm{C}$ respectively.\n- Encode a conformation as a list of $L$ coordinate pairs, each coordinate pair being a list of two integers $\\left[x_i,y_i\\right]$.\n\nYour program must perform an exhaustive search that is guaranteed to find the exact optimum for the small test cases below by:\n- Enumerating all self-avoiding walks of length $L$ on the square lattice with the above anchoring.\n- Enumerating all sequences of length $L$ over the alphabet of size $4$.\n- Computing $E$ and $S$ exactly for each pair and applying the objective and tie-breaking rules.\n\nTest suite:\n- Case A (happy path): $L=6$, $e_{\\mathrm{HH}}=-1.0$, $e_{\\mathrm{NC}}=-2.0$, $e_{\\mathrm{like}}=+0.5$.\n- Case B (salt-bridge-dominant): $L=7$, $e_{\\mathrm{HH}}=0.0$, $e_{\\mathrm{NC}}=-2.5$, $e_{\\mathrm{like}}=+0.5$.\n- Case C (strong like-charge repulsion): $L=6$, $e_{\\mathrm{HH}}=-0.5$, $e_{\\mathrm{NC}}=-1.0$, $e_{\\mathrm{like}}=+1.0$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each result corresponds to one test case, in the same order as listed above.\n- Each result must be a list of the form $[E_{\\min},S_{\\mathrm{best}},\\mathrm{seq},\\mathrm{coords}]$ where $E_{\\min}$ is the minimal energy rounded to three decimal places (as a real number), $S_{\\mathrm{best}}$ is the salt bridge count of the selected solution (as an integer), $\\mathrm{seq}$ is the chosen sequence encoded as a list of integers in $\\{0,1,2,3\\}$, and $\\mathrm{coords}$ is the chosen conformation encoded as a list of coordinate pairs as specified.\n- The final output must therefore be a single line containing something like $[\\mathrm{r}_\\mathrm{A},\\mathrm{r}_\\mathrm{B},\\mathrm{r}_\\mathrm{C}]$, where each $\\mathrm{r}_\\mathrm{X}$ is a list in the above format for the corresponding case. Do not print any other text.",
            "solution": "The solution is designed as an exhaustive search algorithm that systematically explores all valid sequence-conformation pairs, evaluates them, and identifies the optimal pair according to the specified criteria. The algorithm proceeds as follows:\n\nFirst, we must generate the entire space of possible molecular entities. This space is the Cartesian product of the set of all unique, valid conformations and the set of all possible sequences of length $L$.\n\nA conformation is a self-avoiding walk of length $L$ on a $2$D square lattice. To generate all such conformations, we employ a recursive backtracking (depth-first search) algorithm. The walk is anchored with the first two residues at coordinates $(x_0,y_0)=(0,0)$ and $(x_1,y_1)=(1,0)$ to eliminate trivial rotational and translational symmetries. The recursion extends the walk one residue at a time, exploring all four cardinal directions, ensuring that the new lattice site is not already occupied. When a walk of length $L$ is completed, it is added to our list of valid conformations.\n\nA sequence is a string of length $L$ over the alphabet $\\{\\mathrm{H}, \\mathrm{P}, \\mathrm{N}, \\mathrm{C}\\}$, which we encode as integers $\\{0, 1, 2, 3\\}$. The total number of sequences is $4^L$. These are generated systematically, ensuring every possible sequence is considered. This can be achieved by iterating through all $L$-digit numbers in base $4$.\n\nFor each pair of a conformation and a sequence, we must calculate its total energy $E$ and its salt bridge count $S$. This evaluation is performed in two steps.\n1. Given a conformation, we first determine its set of contacts, $\\mathcal{C}$. A contact is an unordered pair of residue indices $(i,j)$ such that the residues are non-adjacent in the sequence ($|i-j| \\ge 2$) but occupy adjacent sites on the lattice. The adjacency is determined by checking if the Manhattan distance between their coordinates is equal to $1$.\n2. With the contact set $\\mathcal{C}$ and the sequence $\\{t_i\\}_{i=0}^{L-1}$, we calculate the total energy $E$ and salt bridge count $S$. The total energy is the sum of pairwise interaction energies, $E = \\sum_{(i,j)\\in\\mathcal{C}}\\varepsilon(t_i, t_j)$. The energy function $\\varepsilon(a,b)$ is defined by the problem parameters $e_{\\mathrm{HH}}$, $e_{\\mathrm{NC}}$, and $e_{\\mathrm{like}}$, and is non-zero only for $\\mathrm{H}-\\mathrm{H}$, $\\mathrm{N}-\\mathrm{C}$, $\\mathrm{N}-\\mathrm{N}$, and $\\mathrm{C}-\\mathrm{C}$ contacts. The salt bridge count $S$ is the number of contacts in $\\mathcal{C}$ where the residue types are $\\{\\mathrm{N}, \\mathrm{C}\\}$.\n\nFinally, we identify the optimal solution. The search must adhere to a strict, four-level tie-breaking rule. We seek to:\n1. Minimize the total energy $E$.\n2. For a given minimal $E$, maximize the salt bridge count $S$.\n3. For a given $E$ and $S$, choose the lexicographically smallest sequence (using the integer encoding).\n4. As a final tie-breaker, choose the conformation whose flattened coordinate list is lexicographically smallest.\n\nThis hierarchical optimization is implemented by maintaining a single \"best-so-far\" solution throughout the exhaustive search. Each new valid candidate solution (i.e., where $S \\ge 1$) is compared to the current best. A candidate is deemed \"better\" if its corresponding objective tuple is lexicographically smaller than that of the current best. The objective tuple for a candidate consisting of a sequence $\\mathbf{t}$ and conformation $\\mathbf{x}$ is constructed as $(E, -S, \\mathbf{t}, \\mathbf{x}_{\\text{flat}})$, where $\\mathbf{t}$ is the tuple of integer-encoded residue types and $\\mathbf{x}_{\\text{flat}}$ is the flattened tuple of coordinates. The negation of $S$ correctly transforms the maximization of $S$ into a minimization problem, fitting the lexicographical comparison framework. By iterating through all sequence-conformation pairs and applying this comparison, the algorithm is guaranteed to converge on the unique optimal solution defined by the problem statement.",
            "answer": "```python\nimport numpy as np\nimport itertools\n\ndef generate_conformations(L):\n    \"\"\"\n    Generates all self-avoiding walks of length L on a 2D square lattice,\n    anchored at (0,0) and (1,0).\n    \"\"\"\n    if L  2:\n        return []\n\n    # Anchored start as specified\n    path = [(0, 0), (1, 0)]\n    if L == 2:\n        return [tuple(path)]\n    \n    visited = set(path)\n    conformations = []\n    \n    def extend_walk(current_path, visited_sites):\n        if len(current_path) == L:\n            conformations.append(tuple(current_path))\n            return\n            \n        last_x, last_y = current_path[-1]\n        # Possible moves: North, South, East, West\n        moves = [(last_x, last_y + 1), (last_x, last_y - 1), (last_x + 1, last_y), (last_x - 1, last_y)]\n        \n        for next_pos in moves:\n            if next_pos not in visited_sites:\n                current_path.append(next_pos)\n                visited_sites.add(next_pos)\n                extend_walk(current_path, visited_sites)\n                visited_sites.remove(next_pos) # Backtrack\n                current_path.pop()\n\n    extend_walk(path, visited)\n    return conformations\n\ndef find_contacts(conf, L):\n    \"\"\"\n    Finds all non-consecutive nearest-neighbor contacts for a given conformation.\n    \"\"\"\n    contacts = []\n    for i in range(L - 1):\n        for j in range(i + 2, L):\n            xi, yi = conf[i]\n            xj, yj = conf[j]\n            if abs(xi - xj) + abs(yi - yj) == 1:\n                contacts.append((i, j))\n    return contacts\n\ndef make_energy_matrix(e_HH, e_NC, e_like):\n    \"\"\"\n    Creates the 4x4 pairwise energy matrix.\n    Encoding: H=0, P=1, N=2, C=3\n    \"\"\"\n    energy_matrix = np.zeros((4, 4), dtype=float)\n    energy_matrix[0, 0] = e_HH\n    energy_matrix[2, 3] = e_NC\n    energy_matrix[3, 2] = e_NC\n    energy_matrix[2, 2] = e_like\n    energy_matrix[3, 3] = e_like\n    return energy_matrix\n\ndef evaluate(seq, contacts, energy_matrix):\n    \"\"\"\n    Calculates total energy E and salt bridge count S for a sequence and its contacts.\n    \"\"\"\n    E = 0.0\n    S = 0\n    N_type, C_type = 2, 3\n    \n    for i, j in contacts:\n        type1, type2 = seq[i], seq[j]\n        E += energy_matrix[type1, type2]\n        if (type1 == N_type and type2 == C_type) or (type1 == C_type and type2 == N_type):\n            S += 1\n    return E, S\n\ndef find_optimal_structure(L, e_HH, e_NC, e_like):\n    \"\"\"\n    Performs the exhaustive search for the optimal sequence and conformation.\n    \"\"\"\n    energy_matrix = make_energy_matrix(e_HH, e_NC, e_like)\n    \n    all_conformations = generate_conformations(L)\n    \n    best_result_tuple = (float('inf'),)\n    best_solution_details = None\n\n    # Pre-calculate contacts for each conformation\n    conf_contacts = {conf: find_contacts(conf, L) for conf in all_conformations}\n    \n    # Iterate through all sequences and conformations to find the optimum\n    for seq in itertools.product(range(4), repeat=L):\n        seq_tuple = tuple(seq)\n        for conf in all_conformations:\n            contacts = conf_contacts[conf]\n            E, S = evaluate(seq_tuple, contacts, energy_matrix)\n\n            if S  1:\n                continue\n\n            conf_flat_tuple = tuple(coord for pair in conf for coord in pair)\n            current_result_tuple = (E, -S, seq_tuple, conf_flat_tuple)\n\n            if best_solution_details is None or current_result_tuple  best_result_tuple:\n                best_result_tuple = current_result_tuple\n                best_solution_details = (E, S, seq_tuple, conf)\n    \n    E, S, seq, conf = best_solution_details\n    return E, S, list(seq), [list(c) for c in conf]\n\ndef format_result_list(res_list):\n    \"\"\"\n    Formats the final result list for one test case into the required string format.\n    \"\"\"\n    E, S, seq, coords = res_list\n    E_str = f\"{E:.3f}\"\n    seq_str = str(seq).replace(\" \", \"\")\n    coords_str = str(coords).replace(\" \", \"\")\n    return f\"[{E_str},{S},{seq_str},{coords_str}]\"\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # (L, e_HH, e_NC, e_like)\n        (6, -1.0, -2.0, 0.5),  # Case A\n        (7, 0.0, -2.5, 0.5),  # Case B\n        (6, -0.5, -1.0, 1.0),  # Case C\n    ]\n    \n    results = []\n    for L, e_HH, e_NC, e_like in test_cases:\n        E_min, S_best, seq, coords = find_optimal_structure(L, e_HH, e_NC, e_like)\n        results.append([E_min, S_best, seq, coords])\n    \n    final_output_str_parts = [format_result_list(res) for res in results]\n    final_output = f\"[{','.join(final_output_str_parts)}]\"\n    print(final_output)\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}