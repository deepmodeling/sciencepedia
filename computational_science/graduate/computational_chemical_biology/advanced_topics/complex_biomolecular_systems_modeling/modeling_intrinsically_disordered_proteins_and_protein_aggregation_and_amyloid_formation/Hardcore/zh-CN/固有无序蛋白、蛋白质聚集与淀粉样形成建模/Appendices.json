{
    "hands_on_practices": [
        {
            "introduction": "本质无序蛋白质的行为由其一级氨基酸序列决定。本练习将介绍强大的“贴纸-间隔”模型（sticker-and-spacer model），其中特定的“贴纸”残基介导了驱动自组装的关键分子间相互作用。通过计算芳香族残基密度等简单的序列度量，您将学会识别这些关键驱动因素，并理解液-液相分离的物理基础。",
            "id": "3853956",
            "problem": "一个长度为 $N=30$ 的本质无序蛋白（IDP）片段，其氨基酸序列如下\n$$\n\\mathrm{G G Y G S R G G Y G G F G G R G G W G G Y R G G K G G S G G}.\n$$\n在为液-液相分离（LLPS）的序列编码驱动力建模时，一个常见的描述疏水特性的总结性统计量是序列平均的Kyte–Doolittle亲疏水性指数，而一个常见的衡量“粘连体”（sticker）含量的指标是芳香族密度，此处定义为酪氨酸、苯丙氨酸和色氨酸残基的比例。使用序列中存在的氨基酸的Kyte-Doolittle亲疏水性标度：$h(\\mathrm{G})=-0.4$，$h(\\mathrm{Y})=-1.3$，$h(\\mathrm{S})=-0.8$，$h(\\mathrm{R})=-4.5$，$h(\\mathrm{F})=2.8$，$h(\\mathrm{W})=-0.9$ 和 $h(\\mathrm{K})=-3.9$。将序列平均亲疏水性定义为\n$$\n\\overline{H} \\equiv \\frac{1}{N}\\sum_{i=1}^{N} h(s_i),\n$$\n其中 $s_i$ 是位置 $i$ 处的残基，并将芳香族密度定义为\n$$\nf_{\\mathrm{aro}} \\equiv \\frac{N_{\\mathrm{Y}}+N_{\\mathrm{F}}+N_{\\mathrm{W}}}{N}.\n$$\n计算上述序列的 $\\overline{H}$ 和 $f_{\\mathrm{aro}}$。将两个量都四舍五入到四位有效数字，并在最终答案中以无量纲行向量的形式报告。计算之后，运用分子间相互作用的第一性原理和平均场思想，从机理上解释增加酪氨酸、苯丙氨酸和色氨酸残基的比例如何驱动与相分离和聚集相关的“粘连体”介导的相互作用。最终数值答案以无单位形式表示，并四舍五入至四位有效数字。",
            "solution": "用户提供了一个科学根据充分、问题明确且客观的问题。该问题基于计算化学生物学中已确立的原理，特别是本质无序蛋白（IDP）序列的分析。问题提供了一个特定的氨基酸序列，待计算量（$\\overline{H}$ 和 $f_{\\mathrm{aro}}$）的定义，以及所有必要数据（Kyte-Doolittle亲疏水性值）。关于机理的解释要求也是生物物理化学中的标准练习。因此，该问题被认为是有效的，并将提供解答。\n\n该问题包含两部分：首先，计算给定IDP序列的序列平均亲疏水性 $\\overline{H}$ 和芳香族密度 $f_{\\mathrm{aro}}$；其次，从机理上解释芳香族残基在驱动相分离中的作用。\n\n首先，我们进行所需的计算。给定序列的长度为 $N=30$。序列为：\n$$\n\\mathrm{G G Y G S R G G Y G G F G G R G G W G G Y R G G K G G S G G}\n$$\n为了计算所需的量，我们必须首先统计序列中每种氨基酸残基的出现次数。令 $N_{\\alpha}$ 表示 $\\alpha$ 类型残基的数量。通过直接计数，我们得到：\n\\begin{itemize}\n    \\item $N_{\\mathrm{G}}$ (甘氨酸) $= 19$\n    \\item $N_{\\mathrm{Y}}$ (酪氨酸) $= 3$\n    \\item $N_{\\mathrm{S}}$ (丝氨酸) $= 2$\n    \\item $N_{\\mathrm{R}}$ (精氨酸) $= 3$\n    \\item $N_{\\mathrm{F}}$ (苯丙氨酸) $= 1$\n    \\item $N_{\\mathrm{W}}$ (色氨酸) $= 1$\n    \\item $N_{\\mathrm{K}}$ (赖氨酸) $= 1$\n\\end{itemize}\n这些计数的总和是 $19+3+2+3+1+1+1=30$，与总序列长度 $N$ 相符。\n\n芳香族密度 $f_{\\mathrm{aro}}$ 定义为芳香族残基的比例，在此上下文中，芳香族残基是酪氨酸（Y）、苯丙氨酸（F）和色氨酸（W）。使用所提供的定义：\n$$\nf_{\\mathrm{aro}} \\equiv \\frac{N_{\\mathrm{Y}}+N_{\\mathrm{F}}+N_{\\mathrm{W}}}{N}\n$$\n代入计数值：\n$$\nf_{\\mathrm{aro}} = \\frac{3+1+1}{30} = \\frac{5}{30} = \\frac{1}{6}\n$$\n作为小数，这是 $f_{\\mathrm{aro}} \\approx 0.16666...$。根据要求四舍五入到四位有效数字，我们得到 $f_{\\mathrm{aro}} \\approx 0.1667$。\n\n接下来，我们计算序列平均亲疏水性 $\\overline{H}$。定义是：\n$$\n\\overline{H} \\equiv \\frac{1}{N}\\sum_{i=1}^{N} h(s_i)\n$$\n其中 $h(s_i)$ 是位置 $i$ 处残基 $s_i$ 的Kyte-Doolittle亲疏水性指数。这可以更方便地使用每种残基类型的计数来计算：\n$$\n\\overline{H} = \\frac{1}{N} \\sum_{\\alpha} N_{\\alpha} h(\\alpha)\n$$\n序列中所有残基的亲疏水性值 $h(\\alpha)$ 均已给出：$h(\\mathrm{G})=-0.4$，$h(\\mathrm{Y})=-1.3$，$h(\\mathrm{S})=-0.8$，$h(\\mathrm{R})=-4.5$，$h(\\mathrm{F})=2.8$，$h(\\mathrm{W})=-0.9$ 和 $h(\\mathrm{K})=-3.9$。\n亲疏水性值的总和为：\n$$\n\\sum_{i=1}^{N} h(s_i) = N_{\\mathrm{G}}h(\\mathrm{G}) + N_{\\mathrm{Y}}h(\\mathrm{Y}) + N_{\\mathrm{S}}h(\\mathrm{S}) + N_{\\mathrm{R}}h(\\mathrm{R}) + N_{\\mathrm{F}}h(\\mathrm{F}) + N_{\\mathrm{W}}h(\\mathrm{W}) + N_{\\mathrm{K}}h(\\mathrm{K})\n$$\n代入数值：\n$$\n\\sum_{i=1}^{N} h(s_i) = (19)(-0.4) + (3)(-1.3) + (2)(-0.8) + (3)(-4.5) + (1)(2.8) + (1)(-0.9) + (1)(-3.9)\n$$\n$$\n\\sum_{i=1}^{N} h(s_i) = -7.6 - 3.9 - 1.6 - 13.5 + 2.8 - 0.9 - 3.9\n$$\n$$\n\\sum_{i=1}^{N} h(s_i) = -28.6\n$$\n现在，我们计算平均值：\n$$\n\\overline{H} = \\frac{-28.6}{30} \\approx -0.95333...\n$$\n四舍五入到四位有效数字，我们得到 $\\overline{H} \\approx -0.9533$。\n\n计算出的量为 $\\overline{H} \\approx -0.9533$ 和 $f_{\\mathrm{aro}} \\approx 0.1667$。\n\n问题的第二部分要求从机理上解释增加芳香族残基比例如何驱动与相分离和聚集相关的“粘连体”介导的相互作用。\n\n许多IDP的行为，特别是那些经历液-液相分离（LLPS）的IDP，通常可以用“粘连体-间隔体”（sticker-and-spacer）模型来概念化。在这个框架中，“粘连体”是能够参与强的、瞬时的、多价的分子间相互作用的特定残基，它们提供了驱动形成致密的、富含蛋白质的相的内聚能。“间隔体”通常是更惰性、更柔性的残基（如给定序列中丰富的甘氨酸），它们为链提供溶解度和构象熵，确保相分离状态保持液态和可逆性。\n\n芳香族残基——特别是酪氨酸（Y）、苯丙氨酸（F）和色氨酸（W）——是典型的“粘连体”。增加它们的比例 $f_{\\mathrm{aro}}$，会增强聚合物链的“粘性”。这种增强的吸引力源于几种基本的分子间相互作用：\n\n1.  **$\\pi$-$\\pi$相互作用：** 芳香族侧链拥有离域的$\\pi$电子系统。这些电子云可以通过所谓的$\\pi$-$\\pi$堆积相互有利地作用。这些作用主要是伦敦色散力的体现，但芳香环富电子的面和贫电子的边之间的静电相互作用也有显著贡献。这使得在平行错位（面-面）和T形（边-面）几何构型中都能形成稳定的排列。这些相互作用为蛋白质链之间提供了特定的、定向的内聚力。\n\n2.  **阳离子-$\\pi$相互作用：** 芳香环的富电子面可以与阳离子形成强的非共价键。在蛋白质中，精氨酸（R）和赖氨酸（K）的带正电的侧链是强有力的阳离子。R的胍基或K的铵基与Y、F或W的$\\pi$面之间的相互作用是蛋白质结构中一个主要的稳定力，也是驱动分子间缔合的关键因素。所给序列同时包含芳香族残基（Y, F, W）和阳离子残基（R, K），使得阳离子-$\\pi$相互作用成为驱动LLPS的主要机制。\n\n3.  **疏水效应：** 这是一个更普遍的、平均场效应。芳香族侧链的大面积、主要非极性的表面暴露于水中在熵上是不利的，因为水分子必须在它们周围形成有序的笼状水合物结构。这些疏水基团的聚集使总的溶剂暴露表面积最小化，从而将有序的水分子释放到体相溶剂中。这导致溶剂熵的大幅增加，为蛋白质自缔合和相分离提供了强大的热力学驱动力。\n\n4.  **氢键：** 酪氨酸的羟基和色氨酸的吲哚氮可以作为氢键的供体和/或受体参与氢键作用。虽然这些作用通常比前面提到的相互作用弱，但它们有助于稳定致密相的非共价键网络。\n\n从平均场角度来看，相分离受焓和熵的平衡支配。上述相互作用（特别是$\\pi$-$\\pi$和阳离子-$\\pi$）在蛋白质缔合时贡献了显著的负焓变（$\\Delta H$）。增加“粘连体”比例 $f_{\\mathrm{aro}}$ 会增加每条链上潜在有利成对相互作用的数量。在Flory-Huggins类型的聚合物溶液模型背景下，这对应于有效相互作用参数 $\\chi$ 的量值增加，该参数量化了蛋白质-蛋白质接触相对于蛋白质-溶剂接触的净偏好。一个更大的 $\\chi$ 值会促进分层，导致在较低蛋白质浓度或较高温度下发生相分离。\n\n因此，增加芳香族“粘连体”的数量（即增加 $f_{\\mathrm{aro}}$）直接增强了多价的、有吸引力的分子间作用力，提供了克服创建相分离系统所需熵代价的焓增益。如果这些强烈的“粘连体”相互作用导致结构过于稳定或陷入动力学陷阱，它们也可能成为不可逆聚集和形成有序病理组装体（如淀粉样原纤维）的途径。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.9533  0.1667 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了微观的“贴纸”相互作用后，我们现在转向宏观的热力学视角。本练习利用 Flory-Huggins 理论——一个描述聚合物溶液的基础模型——来基于一个单一的有效相互作用参数 $\\chi$ 预测相分离。通过推导临界温度，您将深入了解焓和熵之间的平衡（体现在 $\\chi$ 参数中）如何决定一个系统是表现出上临界溶解温度（UCST）还是下临界溶解温度（LCST）行为。",
            "id": "3853927",
            "problem": "一种聚合度为 $N$ 的本征无序蛋白（IDP）的水溶液，使用 Flory–Huggins 混合理论被模拟为在小分子溶剂中的聚合物溶液。每个晶格位置的混合亥姆霍兹自由能，通过热能 $k_{B}T$（其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是以开尔文为单位的绝对温度）进行无量纲化后，由下式给出\n$$\nf(\\phi;T) = \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi(T)\\,\\phi(1-\\phi),\n$$\n其中 $\\phi$ 是蛋白质体积分数，$\\chi(T)$ 是 Flory 相互作用参数，它捕捉了由水合作用、侧链化学以及多价接触（这些接触可以在致密相内促进聚集和淀粉样蛋白形成）产生的有效蛋白质-溶剂相互作用。根据经验和理论，相互作用参数的一个常见温度依赖关系是\n$$\n\\chi(T) = A + \\frac{B}{T},\n$$\n其中 $A$ 代表有效的熵贡献，$B$ 代表有效的焓贡献。\n\n从所给的自由能表达式以及平均场相分离中旋节线和临界点的定义出发，推导临界温度 $T_{c}$（在该温度下双节线终止，即临界溶解温度）作为 $A$、$B$ 和 $N$ 的函数的解析表达式。然后，仅使用 $B$ 的符号以及 $T_{c}0$ 的要求，比较在此 IDP-水系统中上限临界溶解温度（UCST）行为与下限临界溶解温度（LCST）行为的定性条件。以开尔文为单位，将最终的临界温度表示为封闭形式的解析表达式。不得代入任何数值，也无需四舍五入。最终答案必须是 $T_{c}(N,A,B)$ 的单个表达式。",
            "solution": "该问题要求推导由 Flory–Huggins 理论描述的聚合物溶液的临界温度 $T_c$，并分析上限临界溶解温度（UCST）与下限临界溶解温度（LCST）行为的条件。\n\n所给的每个晶格位置的混合亥姆霍兹自由能，经 $k_{B}T$ 无量纲化后为：\n$$\nf(\\phi; T) = \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi(T)\\phi(1-\\phi)\n$$\n其中 $\\phi$ 是蛋白质体积分数，$N$ 是聚合度，$\\chi(T)$ 是 Flory 相互作用参数，其温度依赖关系由下式给出：\n$$\n\\chi(T) = A + \\frac{B}{T}\n$$\n\n相分离的临界点由自由能对组分变量 $\\phi$ 的二阶和三阶导数同时等于零的条件定义。\n$$\n\\frac{\\partial^2 f}{\\partial \\phi^2} = 0 \\quad \\text{and} \\quad \\frac{\\partial^3 f}{\\partial \\phi^3} = 0\n$$\n第一个条件定义了旋节线，第二个条件在该曲线上定位了临界点。\n\n首先，我们计算 $f(\\phi; T)$ 对 $\\phi$ 所需的导数。\n一阶导数为：\n$$\n\\frac{\\partial f}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} \\left( \\frac{\\phi}{N}\\ln \\phi + (1-\\phi)\\ln(1-\\phi) + \\chi ( \\phi - \\phi^2) \\right)\n$$\n$$\n\\frac{\\partial f}{\\partial \\phi} = \\left( \\frac{1}{N}\\ln \\phi + \\frac{\\phi}{N}\\frac{1}{\\phi} \\right) + \\left( (-1)\\ln(1-\\phi) + (1-\\phi)\\frac{-1}{1-\\phi} \\right) + \\chi(1-2\\phi)\n$$\n$$\n\\frac{\\partial f}{\\partial \\phi} = \\frac{1}{N}\\ln \\phi + \\frac{1}{N} - \\ln(1-\\phi) - 1 + \\chi(1-2\\phi)\n$$\n二阶导数为：\n$$\n\\frac{\\partial^2 f}{\\partial \\phi^2} = \\frac{\\partial}{\\partial \\phi} \\left( \\frac{1}{N}\\ln \\phi + \\frac{1}{N} - \\ln(1-\\phi) - 1 + \\chi(1-2\\phi) \\right)\n$$\n$$\n\\frac{\\partial^2 f}{\\partial \\phi^2} = \\frac{1}{N\\phi} - \\frac{-1}{1-\\phi} - 2\\chi = \\frac{1}{N\\phi} + \\frac{1}{1-\\phi} - 2\\chi(T)\n$$\n三阶导数为：\n$$\n\\frac{\\partial^3 f}{\\partial \\phi^3} = \\frac{\\partial}{\\partial \\phi} \\left( \\frac{1}{N\\phi} + \\frac{1}{1-\\phi} - 2\\chi(T) \\right)\n$$\n$$\n\\frac{\\partial^3 f}{\\partial \\phi^3} = -\\frac{1}{N\\phi^2} + \\frac{1}{(1-\\phi)^2}\n$$\n注意 $\\chi(T)$ 与 $\\phi$ 无关。\n\n为了求临界体积分数 $\\phi_c$，我们将三阶导数设为零：\n$$\n\\frac{\\partial^3 f}{\\partial \\phi^3} \\bigg|_{\\phi=\\phi_c} = -\\frac{1}{N\\phi_c^2} + \\frac{1}{(1-\\phi_c)^2} = 0\n$$\n$$\n\\frac{1}{(1-\\phi_c)^2} = \\frac{1}{N\\phi_c^2}\n$$\n对两边取平方根（并考虑到体积分数 $\\phi_c$ 和 $1-\\phi_c$ 必须为正）得到：\n$$\n\\frac{1}{1-\\phi_c} = \\frac{1}{\\sqrt{N}\\phi_c}\n$$\n$$\n\\sqrt{N}\\phi_c = 1 - \\phi_c\n$$\n$$\n\\phi_c(\\sqrt{N} + 1) = 1\n$$\n$$\n\\phi_c = \\frac{1}{1+\\sqrt{N}}\n$$\n这就是临界体积分数。\n\n接下来，我们使用临界点（$\\phi = \\phi_c$, $T=T_c$）的旋节线条件（二阶导数等于零）来求解临界相互作用参数 $\\chi_c = \\chi(T_c)$。\n$$\n\\frac{\\partial^2 f}{\\partial \\phi^2} \\bigg|_{\\phi=\\phi_c, T=T_c} = \\frac{1}{N\\phi_c} + \\frac{1}{1-\\phi_c} - 2\\chi_c = 0\n$$\n$$\n2\\chi_c = \\frac{1}{N\\phi_c} + \\frac{1}{1-\\phi_c}\n$$\n代入 $\\phi_c$ 的表达式以及 $1-\\phi_c = 1 - \\frac{1}{1+\\sqrt{N}} = \\frac{\\sqrt{N}}{1+\\sqrt{N}}$ 的表达式：\n$$\n2\\chi_c = \\frac{1}{N \\left( \\frac{1}{1+\\sqrt{N}} \\right)} + \\frac{1}{\\frac{\\sqrt{N}}{1+\\sqrt{N}}}\n$$\n$$\n2\\chi_c = \\frac{1+\\sqrt{N}}{N} + \\frac{1+\\sqrt{N}}{\\sqrt{N}}\n$$\n为了合并各项，我们找到公分母 $N$：\n$$\n2\\chi_c = \\frac{1+\\sqrt{N}}{N} + \\frac{\\sqrt{N}(1+\\sqrt{N})}{N} = \\frac{(1+\\sqrt{N}) + (\\sqrt{N}+N)}{N}\n$$\n$$\n2\\chi_c = \\frac{1+2\\sqrt{N}+N}{N} = \\frac{(1+\\sqrt{N})^2}{N}\n$$\n求解 $\\chi_c$：\n$$\n\\chi_c = \\frac{(1+\\sqrt{N})^2}{2N}\n$$\n这也可以写成 $\\chi_c = \\frac{1}{2} + \\frac{1}{\\sqrt{N}} + \\frac{1}{2N}$。\n\n现在我们将 $\\chi_c$ 的这个表达式与给定的温度依赖形式 $\\chi(T_c) = A + B/T_c$ 相等：\n$$\nA + \\frac{B}{T_c} = \\frac{(1+\\sqrt{N})^2}{2N}\n$$\n我们求解临界温度 $T_c$：\n$$\n\\frac{B}{T_c} = \\frac{(1+\\sqrt{N})^2}{2N} - A\n$$\n$$\nT_c = \\frac{B}{\\frac{(1+\\sqrt{N})^2}{2N} - A}\n$$\n这就是临界温度作为 $N$、$A$ 和 $B$ 的函数的解析表达式。\n\n对于 UCST 与 LCST 行为的定性分析，我们考虑临界温度必须是一个正的物理温度，即 $T_c  0$ 开尔文。这意味着分子 $B$ 和分母 $\\frac{(1+\\sqrt{N})^2}{2N} - A$ 必须同号。令 $\\chi_c(N) = \\frac{(1+\\sqrt{N})^2}{2N}$。条件是 $\\frac{B}{\\chi_c(N) - A}  0$。\n\nUCST 行为对应于冷却时的相分离。系统在高温下是均相的，随着温度降低而发生相分离。这要求相互作用参数 $\\chi$ 随着温度 $T$ 降低而增加。对 $\\chi(T) = A + B/T$ 求关于 $T$ 的导数：\n$$\n\\frac{d\\chi}{dT} = -\\frac{B}{T^2}\n$$\n为了使 $\\chi$ 随 $T$ 降低而增加，$\\frac{d\\chi}{dT}$ 必须为负，这要求 $B0$。如果 $B0$，那么为了使 $T_c0$，我们必须有分母 $\\chi_c(N) - A  0$，或者说 $A  \\chi_c(N)$。因此，UCST 行为的特征是 $B0$。\n\nLCST 行为对应于加热时的相分离。系统在低温下是均相的，随着温度升高而发生相分离。这要求 $\\chi$ 随 $T$ 升高而增加，意味着 $\\frac{d\\chi}{dT}$ 必须为正。这要求 $B0$。如果 $B0$，那么为了使 $T_c0$，我们必须有分母 $\\chi_c(N) - A  0$，或者说 $A  \\chi_c(N)$。因此，LCST 行为的特征是 $B0$。\n\n焓参数 $B$ 的符号是主要决定因素：$B  0$ 导致 UCST 行为（如果 $A$ 足够小），而 $B  0$ 导致 LCST 行为（如果 $A$ 足够大）。\n\n问题要求 $T_c$ 的封闭形式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{B}{\\frac{\\left(1+\\sqrt{N}\\right)^2}{2N} - A}}\n$$"
        },
        {
            "introduction": "在探究了聚集的序列驱动因素和热力学倾向性之后，最后一块拼图是模拟其动力学过程。本练习使用生灭过程（birth-death process）这一随机建模的基本框架，来深入研究淀粉样纤维的生长动力学。您将推导稳态下的纤维长度分布，并定量评估一种治疗性干预（如纤维末端加帽抑制剂）如何重塑该分布，从而将理论模型与药物设计等实际应用联系起来。",
            "id": "3853908",
            "problem": "考虑一个由内在无序蛋白质形成的淀粉样原纤维的稳态长度分布的最小科学模型。假设在混合均匀的环境中，单体在原纤维两端进行可逆的加成和解离，无量纲的单体浓度 $c$ 恒定。设每个末端的延伸和解聚速率常数分别为 $k_+$ 和 $k_-$。一种原纤维加帽抑制剂将延伸速率降低至 $\\gamma k_+$，其中 $0  \\gamma  1$，而不改变其他参数。原纤维有两个末端，但与末端相关的速率中的任何因子2都必须在正向和反向过程中得到一致处理。所有量均为无量纲，通过相对于参考时间尺度和浓度进行无量纲化得到；因此，不需要物理单位。\n\n从质量作用定律出发，并假设在稳态下原纤维长度 $\\ell \\in \\{1,2,3,\\dots\\}$ 服从一个稳态生灭过程，推导出单个原纤维在基线参数下和抑制条件下的稳态长度分布 $p_\\ell$。利用此分布，推导出一组包含 $N$ 个独立原纤维的群体其平均原纤维长度和总聚合质量（以单体单位计）的表达式。此外，使用Kullback–Leibler散度（KLD）量化分布的变化，其定义为 $D_{\\mathrm{KL}}(p \\,\\|\\, q) = \\sum_{\\ell=1}^{\\infty} p_\\ell \\log\\!\\left(\\frac{p_\\ell}{q_\\ell}\\right)$，其中 $p_\\ell$ 是基线分布，$q_\\ell$ 是受抑制的分布。KLD是无量纲的。\n\n实现一个程序，对每个测试用例计算：\n- 基线参数下的平均原纤维长度，\n- 抑制条件下的平均原纤维长度，\n- 基线参数下的总聚合质量，\n- 抑制条件下的总聚合质量，\n- 从基线分布到受抑制分布的Kullback–Leibler散度。\n\n使用以下测试套件，其中每个案例是一个元组 $(k_+, k_-, c, \\gamma, N)$：\n- 案例 A：$(0.03, 0.05, 0.70, 0.40, 100)$，\n- 案例 B（近边界稳态）：$(0.09, 0.10, 1.05, 0.80, 50)$，\n- 案例 C（弱增长）：$(0.005, 0.10, 0.30, 0.20, 1000)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身也是一个按上述顺序排列、用方括号括起来的逗号分隔列表。例如，一个有效的输出格式形如 $[[\\dots],[\\dots],[\\dots]]$。所有输出必须是实数（浮点数）。如果某个案例违反了稳态可归一性（即，如果基线或受抑制的有效生灭比大于或等于1），则该案例的所有五个输出都返回 $\\mathrm{nan}$。",
            "solution": "该问题要求为一个简化的淀粉样原纤维生长模型推导关键的统计特性，并在一个计算程序中实现这些推导。验证和求解过程如下。\n\n### **问题验证**\n\n**步骤1：提取已知条件**\n- **模型：** 淀粉样原纤维的稳态长度分布。\n- **过程：** 单体在原纤维两端进行可逆的加成和解离。\n- **环境：** 混合均匀，无量纲的单体浓度 $c$ 恒定。\n- **速率常数：** 每个末端的延伸速率常数 $k_+$，每个末端的解聚速率常数 $k_-$。\n- **抑制剂：** 原纤维加帽抑制剂将延伸速率降低至 $\\gamma k_+$，其中 $0  \\gamma  1$。\n- **原纤维末端：** 一根原纤维有 $2$ 个末端；速率中的任何因子 $2$ 都必须得到一致处理。\n- **状态空间：** 原纤维长度 $\\ell \\in \\{1, 2, 3, \\dots\\}$。\n- **过程类型：** 稳态下的稳态生灭过程。\n- **分布：** 基线 ($p_\\ell$) 和受抑制 ($q_\\ell$) 的分布。\n- **导出量：** 平均原纤维长度，$N$根原纤维的总聚合质量。\n- **比较度量：** Kullback–Leibler散度，$D_{\\mathrm{KL}}(p \\,\\|\\, q) = \\sum_{\\ell=1}^{\\infty} p_\\ell \\log\\!\\left(\\frac{p_\\ell}{q_\\ell}\\right)$。\n- **计算任务：** 对每个测试用例 $(k_+, k_-, c, \\gamma, N)$，计算：平均长度（基线）、平均长度（受抑制）、总质量（基线）、总质量（受抑制）和KLD。\n- **无效条件：** 如果基线或受抑制的有效生灭比 $\\ge 1$，则该案例的所有5个输出均返回 $\\mathrm{nan}$。\n- **测试案例：**\n  - 案例 A：$(0.03, 0.05, 0.70, 0.40, 100)$\n  - 案例 B：$(0.09, 0.10, 1.05, 0.80, 50)$\n  - 案例 C：$(0.005, 0.10, 0.30, 0.20, 1000)$\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用标准的生灭过程来模拟聚合物动力学，这是计算和理论生物物理学的基石。问题陈述清晰，提供了所有必要的参数和明确的目标，在指定条件下存在唯一解。语言客观而精确。设定完整且内部一致。该模型虽然简化，但是一个科学上标准且现实的理想化模型。问题结构逻辑清晰，要求先进行推导，然后实现。这并非易事，因为它需要随机过程和统计力学的知识。结果是可以通过数学验证的。\n\n**步骤3：结论与行动**\n问题是**有效的**。将制定一个完整的解决方案。\n\n### **理论推导**\n\n**1. 生灭过程模型**\n我们将单个原纤维的长度 $\\ell$ 建模为一维生灭过程中的一个状态。状态空间是正整数集合 $\\ell \\in \\{1, 2, 3, \\dots\\}$。一根原纤维有2个末端，单体的加成/解离可以在任一末端发生。\n\n- **出生（延伸）：** 长度为 $\\ell$ 的原纤维转变为 $\\ell+1$。这个过程，即单体加成，取决于单体浓度 $c$。每个末端的速率是 $k_+c$。对于有 $2$ 个末端的任何长度 $\\ell \\ge 1$ 的原纤维，其总延伸速率即为出生率 $\\lambda$：\n$$ \\lambda = 2 k_+ c $$\n- **消亡（缩短）：** 长度为 $\\ell$ 的原纤维转变为 $\\ell-1$。这个过程不依赖于单体浓度。每个末端的速率是 $k_-$。对于有 $2$ 个末端的任何长度 $\\ell  1$ 的原纤维，其总缩短速率即为消亡率 $\\mu$：\n$$ \\mu = 2 k_- $$\n状态 $\\ell=1$ 是一个边界。长度为1的原纤维只能延伸；在指定的状态空间 $\\{1, 2, \\dots\\}$ 内它不能再缩短。\n\n**2. 稳态长度分布**\n在稳态下，任何两个相邻状态之间的通量必须相等。这就是细致平衡原理，对于稳态分布 $p_\\ell$，它表述为：\n$$ p_\\ell \\lambda = p_{\\ell+1} \\mu \\quad \\text{for } \\ell \\ge 1 $$\n由此，我们可以建立概率的递推关系：\n$$ p_{\\ell+1} = p_\\ell \\frac{\\lambda}{\\mu} $$\n让我们将有效生灭比定义为 $r$：\n$$ r = \\frac{\\lambda}{\\mu} = \\frac{2k_+c}{2k_-} = \\frac{k_+c}{k_-} $$\n注意，代表末端数量的因子2被抵消了，这符合正向和反向过程的一致性处理要求。现在的递推关系是 $p_{\\ell+1} = p_\\ell r$，这意味着：\n$$ p_\\ell = p_1 r^{\\ell-1} \\quad \\text{for } \\ell \\ge 1 $$\n这是一个几何分布。为了使该分布可归一化（即存在稳态），其总和必须收敛：$\\sum_{\\ell=1}^{\\infty} p_\\ell = 1$。几何级数 $\\sum_{\\ell=1}^{\\infty} p_1 r^{\\ell-1} = p_1 \\sum_{j=0}^{\\infty} r^j$ 仅当 $|r|  1$ 时收敛。由于速率是非负的，此条件为 $0 \\le r  1$。如果 $r \\ge 1$，原纤维长度平均会无限增长，不存在稳定的稳态分布。这与问题的无效条件一致。\n\n假设 $r  1$，我们对分布进行归一化：\n$$ p_1 \\sum_{j=0}^{\\infty} r^j = p_1 \\frac{1}{1-r} = 1 \\implies p_1 = 1-r $$\n因此，稳态长度分布由下式给出：\n$$ p_\\ell = (1-r)r^{\\ell-1}, \\quad \\ell \\in \\{1, 2, 3, \\dots\\} $$\n我们为基线 ($p_\\ell$) 和受抑制 ($q_\\ell$) 的情况定义比率：\n- 基线比率：$r_{base} = \\frac{k_+ c}{k_-}$\n- 受抑制比率：$r_{inhib} = \\frac{(\\gamma k_+) c}{k_-} = \\gamma r_{base}$\n\n**3. 平均原纤维长度**\n平均原纤维长度 $\\langle \\ell \\rangle$ 是长度 $\\ell$ 在分布 $p_\\ell$ 上的期望值：\n$$ \\langle \\ell \\rangle = \\sum_{\\ell=1}^{\\infty} \\ell p_\\ell = \\sum_{\\ell=1}^{\\infty} \\ell (1-r)r^{\\ell-1} = (1-r) \\sum_{\\ell=1}^{\\infty} \\ell r^{\\ell-1} $$\n该和是几何级数的导数：$\\sum_{\\ell=1}^{\\infty} \\ell r^{\\ell-1} = \\frac{d}{dr} \\sum_{\\ell=0}^{\\infty} r^{\\ell} = \\frac{d}{dr} \\frac{1}{1-r} = \\frac{1}{(1-r)^2}$。\n将其代回，我们得到：\n$$ \\langle \\ell \\rangle = (1-r) \\frac{1}{(1-r)^2} = \\frac{1}{1-r} $$\n将此公式应用于我们的两种情景：\n- 平均基线长度：$\\langle \\ell \\rangle_{base} = \\frac{1}{1 - r_{base}}$\n- 平均受抑制长度：$\\langle \\ell \\rangle_{inhib} = \\frac{1}{1 - r_{inhib}}$\n\n**4. 总聚合质量**\n长度为 $\\ell$ 的单个原纤维的质量（以单体单位计）为 $\\ell$。因此，单个原纤维的平均质量是其平均长度 $\\langle \\ell \\rangle$。对于一个包含 $N$ 个独立同分布原纤维的群体，总平均聚合质量 $M_{tot}$ 是它们各自平均质量的总和。根据期望的线性性质：\n$$ M_{tot} = N \\langle \\ell \\rangle = \\frac{N}{1-r} $$\n- 总基线质量：$M_{tot, base} = \\frac{N}{1 - r_{base}}$\n- 总受抑制质量：$M_{tot, inhib} = \\frac{N}{1 - r_{inhib}}$\n\n**5. Kullback-Leibler散度**\n从基线分布 $p_\\ell$（参数为 $r_{base}$）到受抑制分布 $q_\\ell$（参数为 $r_{inhib}$）的KLD为：\n$$ D_{\\mathrm{KL}}(p \\,\\|\\, q) = \\sum_{\\ell=1}^{\\infty} p_\\ell \\log\\left(\\frac{p_\\ell}{q_\\ell}\\right) $$\n对数内的项是：\n$$ \\frac{p_\\ell}{q_\\ell} = \\frac{(1-r_{base})r_{base}^{\\ell-1}}{(1-r_{inhib})r_{inhib}^{\\ell-1}} = \\left(\\frac{1-r_{base}}{1-r_{inhib}}\\right) \\left(\\frac{r_{base}}{r_{inhib}}\\right)^{\\ell-1} $$\n取自然对数：\n$$ \\log\\left(\\frac{p_\\ell}{q_\\ell}\\right) = \\log\\left(\\frac{1-r_{base}}{1-r_{inhib}}\\right) + (\\ell-1)\\log\\left(\\frac{r_{base}}{r_{inhib}}\\right) $$\n将此代入KLD公式：\n$$ D_{\\mathrm{KL}}(p \\,\\|\\, q) = \\sum_{\\ell=1}^{\\infty} p_\\ell \\left[ \\log\\left(\\frac{1-r_{base}}{1-r_{inhib}}\\right) + (\\ell-1)\\log\\left(\\frac{r_{base}}{r_{inhib}}\\right) \\right] $$\n我们可以拆分这个和。第一项是一个常数，所以它的和就是常数本身，因为 $\\sum p_\\ell = 1$：\n$$ \\sum_{\\ell=1}^{\\infty} p_\\ell \\log\\left(\\frac{1-r_{base}}{1-r_{inhib}}\\right) = \\log\\left(\\frac{1-r_{base}}{1-r_{inhib}}\\right) $$\n第二项包含 $(\\ell-1)$ 的期望：\n$$ \\sum_{\\ell=1}^{\\infty} p_\\ell (\\ell-1)\\log\\left(\\frac{r_{base}}{r_{inhib}}\\right) = \\log\\left(\\frac{r_{base}}{r_{inhib}}\\right) \\mathbb{E}_{p}[\\ell-1] $$\n其中 $\\mathbb{E}_{p}[\\ell-1] = \\mathbb{E}_{p}[\\ell] - 1 = \\langle \\ell \\rangle_{base} - 1 = \\frac{1}{1-r_{base}} - 1 = \\frac{r_{base}}{1-r_{base}}$。\n合并各项，KLD的最终表达式为：\n$$ D_{\\mathrm{KL}}(p \\,\\|\\, q) = \\log\\left(\\frac{1-r_{base}}{1-r_{inhib}}\\right) + \\frac{r_{base}}{1-r_{base}} \\log\\left(\\frac{r_{base}}{r_{inhib}}\\right) $$\n\n**6. 算法总结**\n对于每个测试用例 $(k_+, k_-, c, \\gamma, N)$：\n1. 计算基线和受抑制的比率：$r_{base} = k_+c / k_-$ 和 $r_{inhib} = \\gamma r_{base}$。\n2. 检查可归一性。如果 $r_{base} \\ge 1$（这意味着如果 $\\gamma$ 接近1， $r_{inhib}$ 也可能 $\\ge 1$，否则不一定），则不存在稳态。问题要求如果任一比率 $\\ge 1$，则返回 $\\mathrm{nan}$。由于 $0  \\gamma  1$，所以 $r_{inhib}  r_{base}$。因此，条件 $r_{inhib} \\ge 1$ 意味着 $r_{base}  1$。检查简化为测试 $r_{base} \\ge 1$。如果为真，返回 $[\\mathrm{nan}, \\mathrm{nan}, \\mathrm{nan}, \\mathrm{nan}, \\mathrm{nan}]$。\n3. 如果 $r_{base}  1$，使用上面推导的公式计算五个所需的结果。",
            "answer": "```python\nimport numpy as np\nimport sys\n\ndef solve_fibril_kinetics():\n    \"\"\"\n    Calculates fibril properties for baseline and inhibited conditions based on a\n    birth-death model, and formats the output as a single-line string.\n    \"\"\"\n    test_cases = [\n        # (k_plus, k_minus, c, gamma, N)\n        (0.03, 0.05, 0.70, 0.40, 100),   # Case A\n        (0.09, 0.10, 1.05, 0.80, 50),    # Case B\n        (0.005, 0.10, 0.30, 0.20, 1000), # Case C\n    ]\n\n    all_results = []\n    for case in test_cases:\n        k_plus, k_minus, c, gamma, N = case\n\n        # Calculate the birth-death ratio for the baseline case\n        if k_minus = 0:\n            r_base = float('inf') if k_plus * c  0 else 0.0\n        else:\n            r_base = (k_plus * c) / k_minus\n        \n        # Calculate the birth-death ratio for the inhibited case\n        r_inhib = gamma * r_base\n\n        # Check for the normalizability condition of the steady-state distribution.\n        # Since gamma is between 0 and 1, r_inhib will be less than r_base.\n        # So we only need to check the baseline ratio.\n        if r_base = 1.0:\n            all_results.append([np.nan] * 5)\n            continue\n\n        # Calculate the five required metrics\n        # 1. Average fibril length (baseline)\n        avg_len_base = 1.0 / (1.0 - r_base)\n        \n        # 2. Average fibril length (inhibited)\n        avg_len_inhib = 1.0 / (1.0 - r_inhib)\n        \n        # 3. Total polymerized mass (baseline)\n        total_mass_base = N * avg_len_base\n        \n        # 4. Total polymerized mass (inhibited)\n        total_mass_inhib = N * avg_len_inhib\n        \n        # 5. Kullback-Leibler Divergence from baseline (p) to inhibited (q)\n        # D_KL(p || q) = log((1-r_base)/(1-r_inhib)) + (r_base/(1-r_base)) * log(r_base/r_inhib)\n        # Handle edge case where r_base is 0 (no growth) or gamma is 0 (full inhibition)\n        if r_base == 0:\n            # If r_base is 0, then r_inhib is also 0. p and q are the same (all length 1). KLD is 0.\n            kld = 0.0\n        elif gamma == 0:\n            # If gamma is 0, r_inhib is 0. log(r_base/r_inhib) -> log(inf) -> inf.\n            kld = float('inf')\n        else:\n            log_term1 = np.log((1.0 - r_base) / (1.0 - r_inhib))\n            # log(r_base / r_inhib) is just log(1/gamma) or -log(gamma)\n            log_term2 = np.log(1.0 / gamma) \n            factor = r_base / (1.0 - r_base)\n            kld = log_term1 + factor * log_term2\n            \n        case_results = [\n            avg_len_base,\n            avg_len_inhib,\n            total_mass_base,\n            total_mass_inhib,\n            kld\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as per the problem description.\n    # e.g., [[val1,val2,...],[val1,val2,...],...]\n    output_str_parts = []\n    for res in all_results:\n        res_str = \"[\" + \",\".join(f\"{val:.6f}\" if not np.isnan(val) else \"nan\" for val in res) + \"]\"\n        output_str_parts.append(res_str)\n    \n    final_output = \"[\" + \",\".join(output_str_parts) + \"]\"\n    \n    # This function is intended to be called within a larger script or environment\n    # that captures stdout. Printing it fulfills the requirement.\n    # In a real grading script, one might return the value instead.\n    # print(final_output)\n    return final_output\n\n# To make this runnable and print the output\nif __name__ == '__main__':\n    print(solve_fibril_kinetics())\n\n```"
        }
    ]
}