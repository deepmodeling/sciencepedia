{
    "hands_on_practices": [
        {
            "introduction": "The behavior of intrinsically disordered proteins is exquisitely sensitive to their solution environment, particularly the pH. As polyelectrolytes, their net charge dictates the balance between repulsive electrostatic forces that favor an expanded state and attractive forces that can drive collapse or aggregation. This first practice exercise  guides you through the fundamental calculation of a protein's net charge as a function of pH and how to determine its isoelectric point ($pI$), the pH at which the net charge is zero, using the Henderson-Hasselbalch equation. Mastering this skill is essential for understanding how charge-charge interactions shape the conformational landscape of IDPs.",
            "id": "3853949",
            "problem": "Consider an intrinsically disordered protein (IDP) modeled as a single polyelectrolyte chain of length $N = 100$ residues, containing $n_{\\mathrm{Asp}} = 12$ aspartate, $n_{\\mathrm{Glu}} = 10$ glutamate, $n_{\\mathrm{Lys}} = 8$ lysine, and $n_{\\mathrm{Arg}} = 6$ arginine residues. The chain has a free amino terminus (N-terminus) and a free carboxyl terminus (C-terminus). Assume that side-chain and terminal group acid-base dissociation constants are given by $pK_{a,\\mathrm{Asp}} = 3.9$, $pK_{a,\\mathrm{Glu}} = 4.3$, $pK_{a,\\mathrm{Lys}} = 10.5$, $pK_{a,\\mathrm{Arg}} = 12.5$, $pK_{a,\\mathrm{N\\text{-}term}} = 8.0$, and $pK_{a,\\mathrm{C\\text{-}term}} = 3.1$. Use the Henderson–Hasselbalch relation, together with the definitions of protonated and deprotonated fractions for acids and bases, to derive the net charge $Q(pH)$ of the chain as a function of $pH$ and then compute the isoelectric point $pI$, defined as the value of $pH$ at which $Q(pH) = 0$. In the context of computational chemical biology modeling of intrinsically disordered proteins and protein aggregation and amyloid formation, the sign and magnitude of the net charge per residue modulates the conformational ensemble; the $pI$ therefore marks a transition in the effective charge-driven forces shaping the ensemble. Round your final numerical answer to four significant figures and express it in dimensionless $pH$ units.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n- Intrinsically disordered protein (IDP) model: single polyelectrolyte chain\n- Chain length: $N = 100$ residues\n- Number of aspartate residues: $n_{\\mathrm{Asp}} = 12$\n- Number of glutamate residues: $n_{\\mathrm{Glu}} = 10$\n- Number of lysine residues: $n_{\\mathrm{Lys}} = 8$\n- Number of arginine residues: $n_{\\mathrm{Arg}} = 6$\n- Termini: one free amino terminus (N-terminus) and one free carboxyl terminus (C-terminus)\n- Acid-base dissociation constants:\n  - $pK_{a,\\mathrm{Asp}} = 3.9$\n  - $pK_{a,\\mathrm{Glu}} = 4.3$\n  - $pK_{a,\\mathrm{Lys}} = 10.5$\n  - $pK_{a,\\mathrm{Arg}} = 12.5$\n  - $pK_{a,\\mathrm{N\\text{-}term}} = 8.0$\n  - $pK_{a,\\mathrm{C\\text{-}term}} = 3.1$\n- Task: Derive the net charge function $Q(pH)$ and compute the isoelectric point $pI$, defined as the $pH$ at which $Q(pH) = 0$.\n- Rounding: The final answer must be rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is based on the Henderson-Hasselbalch equation, a fundamental principle in acid-base chemistry, and applies it to calculate the isoelectric point of a polypeptide, a standard procedure in biochemistry. The provided $pK_a$ values are within the expected range for amino acid residues in a protein.\n- **Well-Posed**: The problem provides all necessary data (number of each ionizable residue and their respective $pK_a$ values) to define the net charge function $Q(pH)$. Since the function $Q(pH)$ is a monotonically decreasing function of $pH$, a unique root exists, ensuring a unique and stable solution for the isoelectric point $pI$.\n- **Objective**: The problem is stated using precise, quantitative language, free of subjective or ambiguous terminology.\n- **Completeness and Consistency**: The problem is self-contained and consistent. No essential data are missing, and there are no contradictions in the provided information. It implicitly makes the standard simplifying assumption that the $pK_a$ of a given group is independent of the protonation state of other groups on the chain.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid** as it satisfies all validation criteria. The solution process may proceed.\n\n**Solution Derivation**\nThe net charge of the protein, $Q(pH)$, is the sum of the average charges of all its ionizable groups at a given $pH$. The ionizable groups are the acidic side chains (Aspartate, Glutamate), the basic side chains (Lysine, Arginine), the N-terminus, and the C-terminus.\n\nFor an acidic group, represented by the equilibrium $HA \\rightleftharpoons H^+ + A^-$, its charge is determined by the fraction of the deprotonated (negatively charged) species, $f_{A^-}$. The Henderson-Hasselbalch equation is $pH = pK_a + \\log_{10} \\left( \\frac{[A^-]}{[HA]} \\right)$. The fraction $f_{A^-} = \\frac{[A^-]}{[HA] + [A^-]}$ can be derived as:\n$$10^{pH - pK_a} = \\frac{f_{A^-}}{1 - f_{A^-}} \\implies f_{A^-} = \\frac{10^{pH - pK_a}}{1 + 10^{pH - pK_a}} = \\frac{1}{1 + 10^{pK_a - pH}}$$\nThe charge contribution from one such acidic group is $-1 \\times f_{A^-} = -\\frac{1}{1 + 10^{pK_a - pH}}$.\n\nFor a basic group, represented by the equilibrium $BH^+ \\rightleftharpoons H^+ + B$, its charge is determined by the fraction of the protonated (positively charged) species, $f_{BH^+}$. The Henderson-Hasselbalch equation applied to the conjugate acid $BH^+$ is $pH = pK_a + \\log_{10} \\left( \\frac{[B]}{[BH^+]} \\right)$. The fraction $f_{BH^+} = \\frac{[BH^+]}{[B] + [BH^+]}$ can be derived as:\n$$10^{pH - pK_a} = \\frac{1 - f_{BH^+}}{f_{BH^+}} \\implies f_{BH^+} = \\frac{1}{1 + 10^{pH - pK_a}} = \\frac{10^{pK_a - pH}}{1 + 10^{pK_a - pH}}$$\nThe charge contribution from one such basic group is $+1 \\times f_{BH^+} = \\frac{10^{pK_a - pH}}{1 + 10^{pK_a - pH}}$.\n\nThe total net charge $Q(pH)$ is the sum of contributions from all groups:\n$$Q(pH) = \\sum_{\\text{basic groups}} \\frac{10^{pK_{a,i} - pH}}{1 + 10^{pK_{a,i} - pH}} - \\sum_{\\text{acidic groups}} \\frac{1}{1 + 10^{pK_{a,i} - pH}}$$\n\nThe basic groups are Lysine ($n_{\\mathrm{Lys}}=8$), Arginine ($n_{\\mathrm{Arg}}=6$), and the N-terminus ($1$).\nThe acidic groups are Aspartate ($n_{\\mathrm{Asp}}=12$), Glutamate ($n_{\\mathrm{Glu}}=10$), and the C-terminus ($1$).\n\nSubstituting the given values, the function for the net charge is:\n$$Q(pH) = 8 \\left( \\frac{10^{10.5 - pH}}{1 + 10^{10.5 - pH}} \\right) + 6 \\left( \\frac{10^{12.5 - pH}}{1 + 10^{12.5 - pH}} \\right) + 1 \\left( \\frac{10^{8.0 - pH}}{1 + 10^{8.0 - pH}} \\right) - 12 \\left( \\frac{1}{1 + 10^{3.9 - pH}} \\right) - 10 \\left( \\frac{1}{1 + 10^{4.3 - pH}} \\right) - 1 \\left( \\frac{1}{1 + 10^{3.1 - pH}} \\right)$$\n\nThe isoelectric point, $pI$, is the value of $pH$ for which $Q(pH) = 0$. We must therefore solve the following equation for $pH$:\n$$8 \\frac{10^{10.5 - pH}}{1 + 10^{10.5 - pH}} + 6 \\frac{10^{12.5 - pH}}{1 + 10^{12.5 - pH}} + \\frac{10^{8.0 - pH}}{1 + 10^{8.0 - pH}} = 12 \\frac{1}{1 + 10^{3.9 - pH}} + 10 \\frac{1}{1 + 10^{4.3 - pH}} + \\frac{1}{1 + 10^{3.1 - pH}}$$\nThis is a non-linear equation that does not have a simple analytical solution and must be solved numerically. We can use an iterative root-finding algorithm, such as the bisection method or a Newton-Raphson solver.\n\nLet's test the sign of $Q(pH)$ to establish a search interval.\nAt a low $pH$ (e.g., $pH = 1$), all groups are protonated. Net charge $\\approx (8+6+1) - 0 = +15$.\nAt a high $pH$ (e.g., $pH = 14$), all groups are deprotonated. Net charge $\\approx 0 - (12+10+1) = -23$.\nSince the charge changes from positive to negative, a root must exist between $pH=1$ and $pH=14$.\n\nA more refined estimation:\n- At $pH=4$, $Q(4) \\approx (8+6+1) - \\left( 12 \\frac{1}{1+10^{-0.1}} + 10 \\frac{1}{1+10^{0.3}} + 1 \\frac{1}{1+10^{-0.9}} \\right) \\approx 15 - (6.68+3.34+0.89) = 15 - 10.91 = +4.09$.\n- At $pH=5$, $Q(5) \\approx (8+6+1) - \\left( 12 \\frac{1}{1+10^{-1.1}} + 10 \\frac{1}{1+10^{-0.7}} + 1 \\frac{1}{1+10^{-1.9}} \\right) \\approx 15 - (11.12+8.33+0.99) = 15 - 20.44 = -5.44$.\nThe $pI$ lies between $pH=4$ and $pH=5$.\n\nUsing a numerical solver on the equation $Q(pH)=0$ yields the root:\n$pH = pI \\approx 4.3418296...$\n\nThe problem requires the answer to be rounded to four significant figures.\n$pI \\approx 4.342$.\nThis value represents the $pH$ at which the net statistical charge of the IDP molecule is zero, a critical parameter influencing its electrostatic interactions and conformational behavior.",
            "answer": "$$ \\boxed{4.342} $$"
        },
        {
            "introduction": "Beyond global electrostatic effects, the specific sequence of an IDP encodes the short-range interactions that drive self-assembly. The \"sticker-and-spacer\" model provides a powerful conceptual framework, where \"sticker\" residues mediate strong, cohesive interactions. This exercise  focuses on calculating key sequence metrics, such as average hydropathy and aromatic residue density, which serve as simple proxies for the \"stickiness\" that underpins liquid-liquid phase separation and aggregation. This analysis connects the primary amino acid sequence directly to the physical driving forces for mesoscale assembly.",
            "id": "3853956",
            "problem": "An intrinsically disordered protein (IDP) segment with length $N=30$ is given by the amino acid sequence\n$$\n\\mathrm{G G Y G S R G G Y G G F G G R G G W G G Y R G G K G G S G G}.\n$$\nIn modeling sequence-encoded driving forces for Liquid-Liquid Phase Separation (LLPS), a common summary statistic for the hydrophobic character is the sequence-averaged Kyte–Doolittle hydropathy index, and a common measure of sticker content is the aromatic density, defined here as the fraction of tyrosine, phenylalanine, and tryptophan residues. Use the Kyte–Doolittle hydropathy scale for the amino acids present in the sequence: $h(\\mathrm{G})=-0.4$, $h(\\mathrm{Y})=-1.3$, $h(\\mathrm{S})=-0.8$, $h(\\mathrm{R})=-4.5$, $h(\\mathrm{F})=2.8$, $h(\\mathrm{W})=-0.9$, and $h(\\mathrm{K})=-3.9$. Define the sequence-averaged hydropathy as\n$$\n\\overline{H} \\equiv \\frac{1}{N}\\sum_{i=1}^{N} h(s_i),\n$$\nwhere $s_i$ is the residue at position $i$, and define the aromatic density as\n$$\nf_{\\mathrm{aro}} \\equiv \\frac{N_{\\mathrm{Y}}+N_{\\mathrm{F}}+N_{\\mathrm{W}}}{N}.\n$$\nCompute $\\overline{H}$ and $f_{\\mathrm{aro}}$ for the sequence above. Round both quantities to four significant figures and report them as a dimensionless row vector in the final answer. After the calculation, explain mechanistically, using first principles of intermolecular interactions and mean-field thinking, how increasing the fraction of tyrosine, phenylalanine, and tryptophan residues can drive sticker-mediated interactions that are relevant to phase separation and aggregation. Express the final numerical answers with no units and round to four significant figures.",
            "solution": "The user has provided a problem that is scientifically grounded, well-posed, and objective. It is based on established principles in computational chemical biology, specifically the analysis of intrinsically disordered protein (IDP) sequences. The problem supplies a specific amino acid sequence, definitions for the quantities to be calculated ($\\overline{H}$ and $f_{\\mathrm{aro}}$), and all necessary data (Kyte-Doolittle hydropathy values). The request for a mechanistic explanation is also a standard exercise in biophysical chemistry. The problem is therefore deemed valid and a solution will be provided.\n\nThe problem consists of two parts: first, a calculation of the sequence-averaged hydropathy, $\\overline{H}$, and the aromatic density, $f_{\\mathrm{aro}}$, for a given IDP sequence; and second, a mechanistic explanation of the role of aromatic residues in driving phase separation.\n\nFirst, we perform the required calculations. The length of the sequence is given as $N=30$. The sequence is:\n$$\n\\mathrm{G G Y G S R G G Y G G F G G R G G W G G Y R G G K G G S G G}\n$$\nTo compute the required quantities, we must first enumerate the occurrences of each amino acid residue in the sequence. Let $N_{\\alpha}$ denote the number of residues of type $\\alpha$. By direct counting, we find:\n\\begin{itemize}\n    \\item $N_{\\mathrm{G}}$ (Glycine) $= 19$\n    \\item $N_{\\mathrm{Y}}$ (Tyrosine) $= 3$\n    \\item $N_{\\mathrm{S}}$ (Serine) $= 2$\n    \\item $N_{\\mathrm{R}}$ (Arginine) $= 3$\n    \\item $N_{\\mathrm{F}}$ (Phenylalanine) $= 1$\n    \\item $N_{\\mathrm{W}}$ (Tryptophan) $= 1$\n    \\item $N_{\\mathrm{K}}$ (Lysine) $= 1$\n\\end{itemize}\nThe sum of these counts is $19+3+2+3+1+1+1=30$, which correctly matches the total sequence length $N$.\n\nThe aromatic density, $f_{\\mathrm{aro}}$, is defined as the fraction of aromatic residues, which in this context are Tyrosine ($Y$), Phenylalanine ($F$), and Tryptophan ($W$). Using the definition provided:\n$$\nf_{\\mathrm{aro}} \\equiv \\frac{N_{\\mathrm{Y}}+N_{\\mathrm{F}}+N_{\\mathrm{W}}}{N}\n$$\nSubstituting the counted values:\n$$\nf_{\\mathrm{aro}} = \\frac{3+1+1}{30} = \\frac{5}{30} = \\frac{1}{6}\n$$\nAs a decimal, this is $f_{\\mathrm{aro}} \\approx 0.16666...$. Rounding to four significant figures as requested, we obtain $f_{\\mathrm{aro}} \\approx 0.1667$.\n\nNext, we compute the sequence-averaged hydropathy, $\\overline{H}$. The definition is:\n$$\n\\overline{H} \\equiv \\frac{1}{N}\\sum_{i=1}^{N} h(s_i)\n$$\nwhere $h(s_i)$ is the Kyte-Doolittle hydropathy index of the residue $s_i$ at position $i$. This can be more conveniently calculated using the counts of each residue type:\n$$\n\\overline{H} = \\frac{1}{N} \\sum_{\\alpha} N_{\\alpha} h(\\alpha)\n$$\nThe hydropathy values $h(\\alpha)$ are given for all residues present in the sequence: $h(\\mathrm{G})=-0.4$, $h(\\mathrm{Y})=-1.3$, $h(\\mathrm{S})=-0.8$, $h(\\mathrm{R})=-4.5$, $h(\\mathrm{F})=2.8$, $h(\\mathrm{W})=-0.9$, and $h(\\mathrm{K})=-3.9$.\nThe total sum of hydropathies is:\n$$\n\\sum_{i=1}^{N} h(s_i) = N_{\\mathrm{G}}h(\\mathrm{G}) + N_{\\mathrm{Y}}h(\\mathrm{Y}) + N_{\\mathrm{S}}h(\\mathrm{S}) + N_{\\mathrm{R}}h(\\mathrm{R}) + N_{\\mathrm{F}}h(\\mathrm{F}) + N_{\\mathrm{W}}h(\\mathrm{W}) + N_{\\mathrm{K}}h(\\mathrm{K})\n$$\nSubstituting the numerical values:\n$$\n\\sum_{i=1}^{N} h(s_i) = (19)(-0.4) + (3)(-1.3) + (2)(-0.8) + (3)(-4.5) + (1)(2.8) + (1)(-0.9) + (1)(-3.9)\n$$\n$$\n\\sum_{i=1}^{N} h(s_i) = -7.6 - 3.9 - 1.6 - 13.5 + 2.8 - 0.9 - 3.9\n$$\n$$\n\\sum_{i=1}^{N} h(s_i) = -28.6\n$$\nNow, we compute the average:\n$$\n\\overline{H} = \\frac{-28.6}{30} \\approx -0.95333...\n$$\nRounding to four significant figures, we get $\\overline{H} \\approx -0.9533$.\n\nThe calculated quantities are $\\overline{H} \\approx -0.9533$ and $f_{\\mathrm{aro}} \\approx 0.1667$.\n\nThe second part of the problem asks for a mechanistic explanation of how increasing the fraction of aromatic residues drives sticker-mediated interactions relevant to phase separation and aggregation.\n\nThe behavior of many IDPs, particularly those that undergo Liquid-Liquid Phase Separation (LLPS), is often conceptualized using a \"sticker-and-spacer\" model. In this framework, \"stickers\" are specific residues that engage in strong, transient, multivalent intermolecular interactions, providing the cohesive energy that drives the formation of a dense, protein-rich phase. \"Spacers\" are typically more inert, flexible residues (like Glycine, which is abundant in the given sequence) that provide solubility and conformational entropy to the chain, ensuring the phase-separated state remains liquid-like and reversible.\n\nAromatic residues—specifically Tyrosine ($Y$), Phenylalanine ($F$), and Tryptophan ($W$)—are archetypal stickers. Increasing their fraction, $f_{\\mathrm{aro}}$, enhances the \"stickiness\" of the polymer chain. This enhanced attraction arises from several fundamental intermolecular interactions:\n\n1.  **$\\pi$-$\\pi$ Interactions:** The aromatic side chains possess delocalized $\\pi$-electron systems. These electron clouds can interact favorably with each other through so-called $\\pi$-$\\pi$ stacking. These are primarily a manifestation of London dispersion forces, but with a significant contribution from electrostatic interactions between the electron-rich faces and electron-poor edges of the aromatic rings. This allows for stable arrangements in both parallel-displaced (face-to-face) and T-shaped (edge-to-face) geometries. These interactions provide a specific, directional cohesive force between protein chains.\n\n2.  **Cation-$\\pi$ Interactions:** The electron-rich face of an aromatic ring can form a strong, non-covalent bond with a cation. In proteins, the positively charged side chains of Arginine ($R$) and Lysine ($K$) are potent cations. The interaction between the guanidinium group of $R$ or the ammonium group of $K$ and the $\\pi$ face of $Y$, $F$, or $W$ is a major stabilizing force in protein structure and a key driver of intermolecular association. The sequence provided contains both aromatic ($Y$, $F$, $W$) and cationic ($R$, $K$) residues, making cation-$\\pi$ interactions a primary mechanism for driving LLPS.\n\n3.  **Hydrophobic Effect:** This is a more general, mean-field effect. The large, predominantly nonpolar surface areas of aromatic side chains are entropically unfavorable to expose to water, which must form ordered clathrate-like cages around them. The aggregation of these hydrophobic groups minimizes the total solvent-exposed surface area, releasing the ordered water molecules into the bulk solvent. This results in a large increase in solvent entropy, providing a powerful thermodynamic driving force for protein self-association and phase separation.\n\n4.  **Hydrogen Bonding:** The hydroxyl group of Tyrosine and the indole nitrogen of Tryptophan can participate in hydrogen bonding, acting as donors and/or acceptors. While typically weaker than the aforementioned interactions, they contribute to the network of non-covalent bonds that stabilize the dense phase.\n\nFrom a mean-field perspective, phase separation is governed by the balance of enthalpy and entropy. The interactions described above (especially $\\pi$-$\\pi$ and cation-$\\pi$) contribute a significant negative enthalpy change ($\\Delta H$) when proteins associate. Increasing the sticker fraction $f_{\\mathrm{aro}}$ increases the number of potential favorable pairwise interactions per chain. In the context of a Flory-Huggins type model of polymer solutions, this corresponds to an increase in the magnitude of the effective interaction parameter, $\\chi$, which quantifies the net preference for protein-protein contacts over protein-solvent contacts. A larger $\\chi$ value promotes demixing, leading to phase separation at lower protein concentrations or higher temperatures.\n\nTherefore, increasing the number of aromatic stickers (increasing $f_{\\mathrm{aro}}$) directly enhances the multivalent, attractive intermolecular forces, providing the enthalpic gain necessary to overcome the entropic cost of creating a phase-separated system. These same strong sticker interactions, if they lead to structures that are too stable or kinetically trapped, can also serve as a gateway to irreversible aggregation and the formation of ordered pathological assemblies like amyloid fibrils.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.9533  0.1667 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Having explored sequence-level predictors of aggregation, we now turn to modeling the resulting structure itself. The hallmark of many amyloid fibrils is the \"steric zipper,\" a tight, dry interface formed by the interdigitation of side chains from complementary $\\beta$-sheets. In this advanced practice , you will implement a coarse-grained computational model to build a steric zipper and calculate its stabilization energy. This hands-on coding exercise provides concrete, quantitative insight into how van der Waals forces and hydrogen bonding conspire to create the highly stable architecture of an amyloid fibril.",
            "id": "3853924",
            "problem": "You are to write a complete, runnable program that builds a coarse-grained steric zipper model formed by two complementary beta sheets of residues and computes the interface energy contributions from van der Waals interactions and hydrogen bonding under specified packing parameters. The program must implement a physically sound model derived from standard molecular interaction potentials. All distances must be expressed in nanometers (nm), all energies in kilojoule per mole (kJ/mol), and all angles in radians. The final output must be a single line containing a list of per-case results, where each case result is the list [$E_{\\mathrm{vdW}}$, $E_{\\mathrm{HB}}$, $E_{\\mathrm{total}}$] rounded to six decimal places, aggregated as a single comma-separated list enclosed in square brackets.\n\nFundamental base and model definitions:\n- Use the Lennard-Jones potential for van der Waals interactions, with the form\n  $$V_{\\mathrm{LJ}}(r) = 4 \\, \\varepsilon_{ij} \\left[ \\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^6 \\right],$$\n  where $r$ is the inter-pseudoatom distance, $\\sigma_{ij}$ is the mixed collision diameter, and $\\varepsilon_{ij}$ is the mixed well depth. Use Lorentz-Berthelot mixing rules\n  $$\\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2}, \\quad \\varepsilon_{ij} = \\sqrt{\\varepsilon_i \\varepsilon_j}.$$\n- Use a directional hydrogen bond potential defined as\n  $$V_{\\mathrm{HB}}(r, \\theta_D, \\theta_A) = -E_{\\mathrm{hb0}} \\, f(\\theta_D, \\theta_A) \\, \\exp\\left( -\\frac{(r - r_0)^2}{2 s^2} \\right),$$\n  with\n  $$f(\\theta_D, \\theta_A) = \\max(0, \\cos\\theta_D)^2 \\, \\max(0, \\cos\\theta_A)^2.$$\n  The angles $\\theta_D$ and $\\theta_A$ are defined by the donor direction vector and the acceptor direction vector relative to the donor-acceptor line of centers. Specifically, if $\\mathbf{r}$ is the vector from the donor to the acceptor and $\\hat{\\mathbf{r}} = \\mathbf{r}/\\|\\mathbf{r}\\|$, then $\\cos\\theta_D = \\hat{\\mathbf{v}}_D \\cdot \\hat{\\mathbf{r}}$, and $\\cos\\theta_A = \\hat{\\mathbf{v}}_A \\cdot (-\\hat{\\mathbf{r}})$, where $\\hat{\\mathbf{v}}_D$ and $\\hat{\\mathbf{v}}_A$ are unit orientation vectors for donor and acceptor sites, respectively. Only donor-acceptor pairs contribute hydrogen bonding energy. If both residues have donor and acceptor capability (for example, amide-sidechain residues), evaluate both donor-acceptor directions and use the more stabilizing (the minimum) of the two $V_{\\mathrm{HB}}$ values for that pair.\n\nSheet geometry and packing:\n- Construct two one-dimensional beta sheet strands (Sheet A and Sheet B) along the $x$-axis, each with $n = 8$ residues. Sidechain pseudoatoms for each residue are placed at positions\n  $$x_i^A = i \\, p,\\quad y_i^A = 0,\\quad z_i^A = 0,$$\n  $$x_j^B = j \\, p + s,\\quad y_j^B = d,\\quad z_j^B = 0,$$\n  for $i, j \\in \\{0, 1, 2, \\ldots, 7\\}$, where $p$ is the residue spacing along the strand, $d$ is the inter-sheet separation, and $s$ is the registry shift along $x$.\n- Only residues whose sidechains face the interface are included in the interaction calculation: for Sheet A, residues with even index $i$ face the interface ($+y$) and are included; for Sheet B, residues with odd index $j$ face the interface ($-y$) and are included.\n- Orientation vectors for donors and acceptors:\n  - For Sheet A, both donor and acceptor orientation vectors are $\\hat{\\mathbf{v}}^A = (0, +1, 0)$.\n  - For Sheet B, both donor and acceptor orientation vectors start as $(0, -1, 0)$ and are rotated by an in-plane rotation angle $\\phi$ about the $z$-axis:\n    $$\\hat{\\mathbf{v}}^B(\\phi) = R_z(\\phi) \\, (0, -1, 0),\\quad R_z(\\phi) = \\begin{pmatrix} \\cos\\phi  -\\sin\\phi  0 \\\\ \\sin\\phi  \\cos\\phi  0 \\\\ 0  0  1 \\end{pmatrix}.$$\n\nResidue model and parameters:\n- Each residue is represented by a single sidechain pseudoatom characterized by $(\\sigma, \\varepsilon)$ and donor/acceptor flags. Allowed residue types and parameters:\n  - Valine ($\\mathrm{V}$): $\\sigma = 0.40$ nm, $\\varepsilon = 0.35$ kJ/mol, donor $=$ false, acceptor $=$ false.\n  - Serine ($\\mathrm{S}$): $\\sigma = 0.36$ nm, $\\varepsilon = 0.25$ kJ/mol, donor $=$ true, acceptor $=$ false.\n  - Asparagine ($\\mathrm{N}$): $\\sigma = 0.36$ nm, $\\varepsilon = 0.30$ kJ/mol, donor $=$ true, acceptor $=$ true.\n  - Aspartate ($\\mathrm{D}$): $\\sigma = 0.35$ nm, $\\varepsilon = 0.22$ kJ/mol, donor $=$ false, acceptor $=$ true.\n- Global constants:\n  - Residue spacing along strand: $p = 0.47$ nm.\n  - Lennard-Jones cutoff: $r_c = 1.2$ nm (interactions with $r  r_c$ are neglected).\n  - Hydrogen bond parameters: $E_{\\mathrm{hb0}} = 8.0$ kJ/mol, $r_0 = 0.29$ nm, $s = 0.04$ nm.\n\nComputation steps your program must implement:\n- Build Sheet A and Sheet B positions for the interface-facing residues only, using the specified sequences and packing parameters $(d, s, \\phi)$.\n- For every cross-sheet pair $(i, j)$ of interface-facing residues, compute the distance $r_{ij}$ and, if $r_{ij} \\le r_c$, accumulate:\n  - The van der Waals energy contribution $V_{\\mathrm{LJ}}(r_{ij})$ using the mixed $(\\sigma_{ij}, \\varepsilon_{ij})$.\n  - The hydrogen bond energy $V_{\\mathrm{HB}}$ only if the residue pair is donor-acceptor compatible (either $i$ is donor and $j$ is acceptor, or $i$ is acceptor and $j$ is donor), using the angular factor $f(\\theta_D, \\theta_A)$ defined above. If both residues have both donor and acceptor capability, evaluate both directions and choose the minimum energy for the pair’s hydrogen bond contribution.\n- Sum all contributions to obtain $E_{\\mathrm{vdW}}$, $E_{\\mathrm{HB}}$, and $E_{\\mathrm{total}} = E_{\\mathrm{vdW}} + E_{\\mathrm{HB}}$.\n\nTest suite:\n- Use the following four test cases. For each, Sheet A and Sheet B sequences are given as strings of length $8$ over the residue set $\\{\\mathrm{V}, \\mathrm{S}, \\mathrm{N}, \\mathrm{D}\\}$, and packing parameters $(d, s, \\phi)$ are provided. Angles must be interpreted in radians.\n  1. Case 1 (happy path): Sheet A sequence $\\mathrm{\"NSVDNSVD\"}$, Sheet B sequence $\\mathrm{\"DNSVNSVD\"}$, with $d = 0.50$ nm, $s = 0.00$ nm, $\\phi = 0.00$.\n  2. Case 2 (large separation boundary): same sequences as Case 1, with $d = 0.80$ nm, $s = 0.00$ nm, $\\phi = 0.00$.\n  3. Case 3 (misregistry): same sequences as Case 1, with $d = 0.50$ nm, $s = 0.235$ nm (half $p$), $\\phi = 0.00$.\n  4. Case 4 (rotational misalignment): same sequences as Case 1, with $d = 0.50$ nm, $s = 0.00$ nm, $\\phi = \\frac{\\pi}{2}$.\n\nAnswer specification and output format:\n- For each test case, your program must compute the three floats $E_{\\mathrm{vdW}}$, $E_{\\mathrm{HB}}$, and $E_{\\mathrm{total}}$ in kJ/mol, each rounded to six decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list of case results, where each case result is a list of the three numbers. For example, a valid output format is\n  $$\\mathrm{[[E^{(1)}_{\\mathrm{vdW}},E^{(1)}_{\\mathrm{HB}},E^{(1)}_{\\mathrm{total}}],[E^{(2)}_{\\mathrm{vdW}},E^{(2)}_{\\mathrm{HB}},E^{(2)}_{\\mathrm{total}}],\\ldots]}$$\n  with no spaces in the printed string and with all numeric entries rounded to six decimal places.",
            "solution": "The user-provided problem statement is deemed valid. It is scientifically grounded in standard coarse-grained molecular modeling principles, well-posed with all necessary parameters and equations, and objective in its formulation. The task is to compute the interface energy of a steric zipper model based on Lennard-Jones and directional hydrogen bond potentials.\n\nThe solution will be implemented as a Python program that systematically follows the computational steps outlined in the problem.\n\n1.  **Model and Parameter Definition**: First, all physical parameters are defined as constants. These include residue-specific parameters $(\\sigma, \\varepsilon, \\text{donor/acceptor status})$ stored in a dictionary for easy look-up, and global constants such as the residue spacing $p$, interaction cutoff $r_c$, and hydrogen bond potential parameters ($E_{\\mathrm{hb0}}$, $r_0$, and the Gaussian width, which is explicitly named `S_HB_WIDTH` to avoid confusion with the registry shift $s$).\n\n2.  **Geometric Construction**: For each test case defined by packing parameters $(d, s, \\phi)$, the three-dimensional coordinates of the sidechain pseudoatoms are generated. The problem specifies that only residues at even indices on Sheet A and odd indices on Sheet B are at the interface.\n    -   Sheet A residues $(i=0, 2, 4, 6)$ are placed at positions $\\mathbf{r}_i^A = (i \\cdot p, 0, 0)$.\n    -   Sheet B residues $(j=1, 3, 5, 7)$ are placed at positions $\\mathbf{r}_j^B = (j \\cdot p + s, d, 0)$.\n    The orientation vectors for hydrogen bonding sites are also defined. For Sheet A, this is a fixed vector $\\hat{\\mathbf{v}}^A = (0, 1, 0)$. For Sheet B, the base vector $(0, -1, 0)$ is rotated around the $z$-axis by the angle $\\phi$, yielding $\\hat{\\mathbf{v}}^B(\\phi) = (\\sin\\phi, -\\cos\\phi, 0)$.\n\n3.  **Potential Energy Calculation**: The program iterates through all unique pairs of interface-facing residues, with one residue from Sheet A ($i$) and one from Sheet B ($j$). For each pair $(i, j)$:\n    -   The inter-pseudoatom distance $r_{ij} = \\|\\mathbf{r}_j^B - \\mathbf{r}_i^A\\|$ is calculated. If $r_{ij}$ exceeds the cutoff distance $r_c$, the pair does not contribute to the energy.\n    -   **Van der Waals Energy ($E_{\\mathrm{vdW}}$)**: The Lennard-Jones potential $V_{\\mathrm{LJ}}(r_{ij})$ is computed. The required mixed parameters $\\sigma_{ij}$ and $\\varepsilon_{ij}$ are determined using the Lorentz-Berthelot mixing rules: $\\sigma_{ij} = (\\sigma_i + \\sigma_j)/2$ and $\\varepsilon_{ij} = \\sqrt{\\varepsilon_i \\varepsilon_j}$. This energy is added to a running total for $E_{\\mathrm{vdW}}$.\n    -   **Hydrogen Bond Energy ($E_{\\mathrm{HB}}$)**: The hydrogen bond contribution is calculated only for donor-acceptor compatible pairs. The potential $V_{\\mathrm{HB}}$ is a function of distance $r_{ij}$ and two orientation angles, $\\theta_D$ and $\\theta_A$. These angles are computed via dot products involving the residue-to-residue vector $\\hat{\\mathbf{r}}_{ij}$ and the site orientation vectors $(\\hat{\\mathbf{v}}_D, \\hat{\\mathbf{v}}_A)$.\n        -   $\\cos\\theta_D = \\hat{\\mathbf{v}}_D \\cdot \\hat{\\mathbf{r}}_{ij}$\n        -   $\\cos\\theta_A = \\hat{\\mathbf{v}}_A \\cdot (-\\hat{\\mathbf{r}}_{ij})$, where $\\hat{\\mathbf{r}}_{ij}$ points from the donor to the acceptor.\n        The full calculation checks two possibilities for each pair: residue $i$ as donor and $j$ as acceptor, and vice-versa. As per the problem specification, if a pair allows for both (e.g., Asparagine-Asparagine), both potential energies are calculated, and the more stabilizing (minimum) value is taken as the pair's contribution. This value is added to a running total for $E_{\\mathrm{HB}}$.\n\n4.  **Aggregation and Output**: After summing the contributions over all pairs, the total energies $E_{\\mathrm{vdW}}$, $E_{\\mathrm{HB}}$, and $E_{\\mathrm{total}} = E_{\\mathrm{vdW}} + E_{\\mathrm{HB}}$ are computed. Each value is rounded to six decimal places. This process is repeated for all test cases provided. Finally, the results are formatted into a single string representing a list of lists, with no whitespace, as specified in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the steric zipper energy calculation problem.\n    \"\"\"\n    # Define residue properties and global constants as per the problem statement\n    RESIDUE_PARAMS = {\n        'V': {'sigma': 0.40, 'eps': 0.35, 'is_donor': False, 'is_acceptor': False},\n        'S': {'sigma': 0.36, 'eps': 0.25, 'is_donor': True, 'is_acceptor': False},\n        'N': {'sigma': 0.36, 'eps': 0.30, 'is_donor': True, 'is_acceptor': True},\n        'D': {'sigma': 0.35, 'eps': 0.22, 'is_donor': False, 'is_acceptor': True},\n    }\n\n    P_SPACING = 0.47      # nm, residue spacing along strand\n    RC_CUTOFF = 1.2       # nm, Lennard-Jones cutoff\n    E_HB0 = 8.0           # kJ/mol, hydrogen bond energy scale\n    R0_HB = 0.29          # nm, ideal hydrogen bond distance\n    S_HB_WIDTH = 0.04     # nm, width of the hydrogen bond radial function\n\n    def lennard_jones(r, sigma_ij, epsilon_ij):\n        \"\"\"Calculates the Lennard-Jones potential.\"\"\"\n        if r == 0:\n            return np.inf  # Physically unlikely\n        sr6 = (sigma_ij / r)**6\n        sr12 = sr6**2\n        return 4.0 * epsilon_ij * (sr12 - sr6)\n\n    def hydrogen_bond(r, r_vec_donor_acceptor, v_D, v_A):\n        \"\"\"Calculates the directional hydrogen bond potential.\"\"\"\n        # Radial part\n        exp_term = np.exp(-((r - R0_HB)**2) / (2.0 * S_HB_WIDTH**2))\n        \n        # Angular part\n        r_hat = r_vec_donor_acceptor / r\n        cos_theta_D = np.dot(v_D, r_hat)\n        cos_theta_A = np.dot(v_A, -r_hat)\n        \n        f_angular = (max(0.0, cos_theta_D)**2) * (max(0.0, cos_theta_A)**2)\n        \n        return -E_HB0 * f_angular * exp_term\n\n    def calculate_energies(seq_A, seq_B, d, s, phi):\n        \"\"\"\n        Calculates vdW, HB, and total energies for a given steric zipper configuration.\n        \"\"\"\n        # 1. Build sheet geometries for interface-facing residues\n        interface_A = []\n        for i, res_type in enumerate(seq_A):\n            if i % 2 == 0:\n                pos = np.array([i * P_SPACING, 0.0, 0.0])\n                interface_A.append({'type': res_type, 'pos': pos})\n\n        interface_B = []\n        for j, res_type in enumerate(seq_B):\n            if j % 2 != 0:\n                pos = np.array([j * P_SPACING + s, d, 0.0])\n                interface_B.append({'type': res_type, 'pos': pos})\n\n        # 2. Define orientation vectors\n        v_A_orient = np.array([0.0, 1.0, 0.0])\n        \n        cos_phi, sin_phi = np.cos(phi), np.sin(phi)\n        v_B_orient = np.array([sin_phi, -cos_phi, 0.0])\n\n        # 3. Calculate energies by iterating over all inter-sheet pairs\n        E_vdw_total = 0.0\n        E_hb_total = 0.0\n\n        for res_i in interface_A:\n            params_i = RESIDUE_PARAMS[res_i['type']]\n            pos_i = res_i['pos']\n            \n            for res_j in interface_B:\n                params_j = RESIDUE_PARAMS[res_j['type']]\n                pos_j = res_j['pos']\n                \n                r_vec_ij = pos_j - pos_i\n                r = np.linalg.norm(r_vec_ij)\n\n                if r > RC_CUTOFF or r == 0:\n                    continue\n\n                # a. van der Waals energy\n                sigma_i, eps_i = params_i['sigma'], params_i['eps']\n                sigma_j, eps_j = params_j['sigma'], params_j['eps']\n                sigma_ij = (sigma_i + sigma_j) / 2.0\n                epsilon_ij = np.sqrt(eps_i * eps_j)\n                E_vdw_total += lennard_jones(r, sigma_ij, epsilon_ij)\n                \n                # b. Hydrogen bond energy\n                # Contribution from i(Donor) -> j(Acceptor)\n                hb_i_to_j = 0.0\n                if params_i['is_donor'] and params_j['is_acceptor']:\n                    hb_i_to_j = hydrogen_bond(r, r_vec_ij, v_A_orient, v_B_orient)\n                \n                # Contribution from j(Donor) -> i(Acceptor)\n                hb_j_to_i = 0.0\n                if params_j['is_donor'] and params_i['is_acceptor']:\n                    # r_vec is from Donor (j) to Acceptor (i)\n                    r_vec_ji = pos_i - pos_j\n                    hb_j_to_i = hydrogen_bond(r, r_vec_ji, v_B_orient, v_A_orient)\n\n                # Use the most stabilizing (minimum) energy for the pair\n                E_hb_total += min(hb_i_to_j, hb_j_to_i)\n\n        E_total = E_vdw_total + E_hb_total\n\n        return [round(E_vdw_total, 6), round(E_hb_total, 6), round(E_total, 6)]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\"seq_A\": \"NSVDNSVD\", \"seq_B\": \"DNSVNSVD\", \"d\": 0.50, \"s\": 0.00, \"phi\": 0.00},\n        {\"seq_A\": \"NSVDNSVD\", \"seq_B\": \"DNSVNSVD\", \"d\": 0.80, \"s\": 0.00, \"phi\": 0.00},\n        {\"seq_A\": \"NSVDNSVD\", \"seq_B\": \"DNSVNSVD\", \"d\": 0.50, \"s\": 0.235, \"phi\": 0.00},\n        {\"seq_A\": \"NSVDNSVD\", \"seq_B\": \"DNSVNSVD\", \"d\": 0.50, \"s\": 0.00, \"phi\": np.pi / 2.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        energies = calculate_energies(case[\"seq_A\"], case[\"seq_B\"], case[\"d\"], case[\"s\"], case[\"phi\"])\n        results.append(energies)\n\n    # Final print statement in the exact required format.\n    case_strings = [f\"[{e[0]},{e[1]},{e[2]}]\" for e in results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}