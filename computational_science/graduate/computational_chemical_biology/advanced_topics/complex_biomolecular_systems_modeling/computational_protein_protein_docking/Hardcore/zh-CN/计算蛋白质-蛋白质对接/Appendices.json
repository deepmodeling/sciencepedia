{
    "hands_on_practices": [
        {
            "introduction": "计算对接算法通常会生成大量可能的复合物结构（构象），而评分（scoring）是从中筛选出最接近天然结构的关键步骤。这个练习将带你亲手应用一个简化的评分函数，它量化了界面处极性与非极性相互作用之间的平衡，这正是评估蛋白质结合稳定性的核心物理化学原理。通过计算，你将直观地理解为何一个良好的界面不仅需要最大化有利的接触，还必须最小化不利的惩罚项。",
            "id": "2131872",
            "problem": "在计算结构生物学领域，蛋白质-蛋白质对接算法被用于预测蛋白质复合物的三维结构。这些算法通常会生成多个候选结构，称为对接姿态（poses），然后必须对这些姿态进行评估或“打分”，以识别最可能的近天然复合物。\n\n一位研究人员正在研究两种蛋白质 Kinase A 和 Substrate B 之间的相互作用。在进行对接模拟后，生成了五个排名最高的对接姿态（标记为 A、B、C、D、E）。为了区分这些姿态，采用一个简化的打分函数 $S$ 来评估结合界面的相对稳定性。较低的分数表示更有利（即更稳定）的相互作用。\n\n该打分函数定义如下：\n$$S = P_{H} \\cdot (N_{uD} + N_{uA}) - G_{np} \\cdot A_{np}$$\n其中：\n- $S$ 是最终得分，单位为任意能量单位 (AEU)。\n- $N_{uD}$ 是界面上未满足的氢键供体数量。\n- $N_{uA}$ 是界面上未满足的氢键受体数量。\n- $A_{np}$ 是界面上埋藏的非极性表面积，单位为平方埃 ($\\text{Å}^2$)。\n- $P_{H}$ 是界面上每个未满足的极性基团的经验性能量罚分，其值为 $1.5$ AEU。\n- $G_{np}$ 是埋藏非极性表面的经验性能量增益因子，其值为 $0.02$ AEU/$\\text{Å}^2$。\n\n下表给出了五种姿态计算出的界面属性：\n\n| 姿态 | $N_{uD}$ | $N_{uA}$ | $A_{np}$ ($\\text{Å}^2$) |\n|:----:|:--------:|:--------:|:----------------------:|\n|   A  |     4    |     3    |          1150          |\n|   B  |     1    |     0    |          850           |\n|   C  |     2    |     1    |          1200          |\n|   D  |     7    |     6    |          1500          |\n|   E  |     0    |     1    |          700           |\n\n根据此打分模型，哪种姿态代表了 Kinase A - Substrate B 复合物最可能的结合结构？\n\nA. 姿态 A\n\nB. 姿态 B\n\nC. 姿态 C\n\nD. 姿态 D\n\nE. 姿态 E",
            "solution": "该打分函数结合了对未满足的极性基团的罚分和对埋藏非极性表面的增益，较低的 $S$ 值表示更有利的界面。该模型为\n$$S=P_{H}\\cdot(N_{uD}+N_{uA})-G_{np}\\cdot A_{np},$$\n其中 $P_{H}=1.5$ 且 $G_{np}=0.02$。对每种姿态，计算 $N_{uD}+N_{uA}$，代入公式并求值。\n\n对于姿态 A：$N_{uD}+N_{uA}=4+3=7$，\n$$S_{A}=1.5\\cdot 7-0.02\\cdot 1150=10.5-23=-12.5.$$\n\n对于姿态 B：$N_{uD}+N_{uA}=1+0=1$，\n$$S_{B}=1.5\\cdot 1-0.02\\cdot 850=1.5-17=-15.5.$$\n\n对于姿态 C：$N_{uD}+N_{uA}=2+1=3$，\n$$S_{C}=1.5\\cdot 3-0.02\\cdot 1200=4.5-24=-19.5.$$\n\n对于姿态 D：$N_{uD}+N_{uA}=7+6=13$，\n$$S_{D}=1.5\\cdot 13-0.02\\cdot 1500=19.5-30=-10.5.$$\n\n对于姿态 E：$N_{uD}+N_{uA}=0+1=1$，\n$$S_{E}=1.5\\cdot 1-0.02\\cdot 700=1.5-14=-12.5.$$\n\n比较这些分数，$S_{C}=-19.5$ 是最低的（最有利的）。因此，姿态 C 是最可能的结合结构。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "超越刚体对接的范畴，柔性对接和界面优化是提高预测准确性的前沿领域。该练习模拟了界面优化的核心环节——“侧链重构-能量最小化”（repack-minimize）循环。你将通过计算来确定最稳定的侧链构象组合，这不仅能加深对旋转异构体库和能量最小化在结构预测中应用的理解，还能揭示能量函数如何引导构象搜索，从而优化蛋白质-蛋白质界面的接触模式。",
            "id": "3839941",
            "problem": "您正在计算蛋白质-蛋白质对接的局部优化阶段对一个蛋白质-蛋白质界面进行建模。该方案使用一个依赖于骨架的旋转异构体库进行离散的侧链重排，然后进行有限的基于梯度的能量最小化。考虑一个简化为两个相互作用残基对的界面：伴侣P上的一个 arginine 与伴侣Q上的一个 aspartate 接触（将此对记为 P1–Q1），以及伴侣P上的一个 tyrosine 与伴侣Q上的一个 phenylalanine 接触（将此对记为 P2–Q2）。在当前的骨架几何构型下，P1–Q2 和 P2–Q1 之间的交叉相互作用可以忽略不计。\n\n假设以下基本前提：\n- 总势能近似为残基自身能量（残基内加上与骨架的相容性能量）和界面上成对的残基间相互作用能量之和，这与标准的基于物理的加性力场一致，其中包括静电、范德华（Lennard-Jones）项和氢键。设总能量为这些给定项的总和，不包含额外的耦合项。\n- 一个残基-残基接触定义为界面上至少存在一对重原子，其间距小于或等于 $4.0 \\,\\text{\\AA}$ 的阈值。\n- 给定了初始的旋转异构体分配，重排步骤在所提供的旋转异构体中进行搜索以最小化总能量。随后的局部最小化仅将特定成对相互作用能量中包含的正值排斥分量减少一个因子 $\\alpha = 0.5$，所有其他项保持不变，这反映了一个小的弛豫过程，该过程在保持定性几何构型的情况下缓解了空间位阻重叠。\n\n对于 P1–Q1 (arginine–aspartate)，每个残基有 $2$ 个旋转异构体：P1 有 $r \\in \\{1,2\\}$，其自身能量为 $E_{\\text{self}}^{\\text{P1}}(1) = 0.5 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 和 $E_{\\text{self}}^{\\text{P1}}(2) = 0.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$；Q1 有 $s \\in \\{1,2\\}$，其自身能量为 $E_{\\text{self}}^{\\text{Q1}}(1) = 0.3 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 和 $E_{\\text{self}}^{\\text{Q1}}(2) = 0.8 \\,\\text{kcal}\\,\\text{mol}^{-1}$。成对相互作用能量（在适用时包括静电、氢键几何构型和范德华力）和最小重原子距离如下：\n- $(r,s) = (1,1)$: $E_{\\text{pair}}^{\\text{P1-Q1}}(1,1) = -3.5 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(1,1) = 2.7 \\,\\text{\\AA}$；此净能量包含一个 $+0.6 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 的小排斥分量，源于近距离接触。\n- $(r,s) = (1,2)$: $E_{\\text{pair}}^{\\text{P1-Q1}}(1,2) = -1.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(1,2) = 3.8 \\,\\text{\\AA}$；排斥可忽略不计。\n- $(r,s) = (2,1)$: $E_{\\text{pair}}^{\\text{P1-Q1}}(2,1) = -0.5 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(2,1) = 3.6 \\,\\text{\\AA}$；排斥可忽略不计。\n- $(r,s) = (2,2)$: $E_{\\text{pair}}^{\\text{P1-Q1}}(2,2) = -2.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(2,2) = 3.0 \\,\\text{\\AA}$；此净能量包含一个 $+0.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 的小排斥分量。\n\n对于 P2–Q2 (tyrosine–phenylalanine)，每个残基有 $2$ 个旋转异构体：P2 有 $t \\in \\{1,2\\}$，其自身能量为 $E_{\\text{self}}^{\\text{P2}}(1) = 0.4 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 和 $E_{\\text{self}}^{\\text{P2}}(2) = 0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$；Q2 有 $u \\in \\{1,2\\}$，其自身能量为 $E_{\\text{self}}^{\\text{Q2}}(1) = 0.5 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 和 $E_{\\text{self}}^{\\text{Q2}}(2) = 0.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$。成对相互作用能量和最小距离如下：\n- $(t,u) = (1,1)$: $E_{\\text{pair}}^{\\text{P2-Q2}}(1,1) = -1.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(1,1) = 3.5 \\,\\text{\\AA}$；排斥可忽略不计。\n- $(t,u) = (1,2)$: $E_{\\text{pair}}^{\\text{P2-Q2}}(1,2) = -0.6 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(1,2) = 4.2 \\,\\text{\\AA}$；无接触。\n- $(t,u) = (2,1)$: $E_{\\text{pair}}^{\\text{P2-Q2}}(2,1) = -0.7 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(2,1) = 4.0 \\,\\text{\\AA}$；接触阈值。\n- $(t,u) = (2,2)$: $E_{\\text{pair}}^{\\text{P2-Q2}}(2,2) = -1.4 \\,\\text{kcal}\\,\\text{mol}^{-1}$，其中 $d_{\\min}(2,2) = 3.6 \\,\\text{\\AA}$；此净能量包含一个 $+0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 的小排斥分量。\n\n假设交叉对相互作用 P1–Q2 和 P2–Q1 为 $0.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 并且不产生接触。初始旋转异构体为 P1 $r=2$，Q1 $s=1$，P2 $t=1$，Q2 $u=2$。\n\n任务：\n- 使用加性模型，计算初始状态的总能量，然后独立地确定每个残基对在侧链重排后能量最低的旋转异构体，并计算新的总能量。使用 $4.0 \\,\\text{\\AA}$ 阈值，确定重排前后的界面接触集（哪些残基对处于接触状态）。\n- 对选定的旋转异构体对，应用局部最小化规则，将识别出的正值排斥分量乘以因子 $\\alpha = 0.5$ 进行缩放，重新计算总能量，并说明接触集是否发生变化。\n- 基于迭代式重排-最小化循环的第一性原理，选择最能描述接触模式演变并提供基于能量景观优化和界面接触图稳定性的严格收敛标准的选项。\n\n哪个选项与这些计算和原理最一致？\n\nA. 重排后，P1–Q1 保持接触，P2–Q2 成为新的接触；最小化后，接触集不变。当总能量变化的绝对值满足 $\\lvert \\Delta E \\rvert  0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 并且接触图与前一次迭代的 Jaccard 指数 $J = 1$ 至少连续2个重排-最小化循环，并且侧链二面角的能量梯度最大范数低于 $10^{-3} \\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{rad}^{-1}$ 时，达到收敛。\n\nB. 重排后，相对于初始状态，接触不变，因为成对能量不能克服自身能量；最小化引入了一个新的 P1–Q2 接触。当单次迭代中总能量的绝对变化低于 $1.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 时，无论接触是否变化，即达到收敛。\n\nC. 重排后，由于排斥弛豫，P1–Q1 的接触丢失，但 P2–Q2 仍然不接触；最小化后，两对都成为接触。当迭代间的侧链均方根偏差（RMSD）低于 $2.0 \\,\\text{\\AA}$ 时，即使能量仍在下降且接触仍在变化，也达到收敛。\n\nD. 重排后，P1–Q1 转变为非接触几何构型，而 P2–Q2 仍然不接触；最小化后，P2–Q2 成为唯一的接触。当氢键数量连续1次迭代不增加时，无论总能量和非键接触如何，即达到收敛。",
            "solution": "该问题陈述是计算蛋白质-蛋白质对接领域一个有效且定义明确的练习。它提供了一个简化但有科学依据的重排-最小化循环模型，包含了所有必要的数据和清晰的计算规则。该问题是自洽、一致且客观的。\n\n解答过程分三个阶段进行：\n1.  初始状态分析。\n2.  侧链重排后状态分析。\n3.  局部能量最小化后状态分析。\n最后，基于这些结果和能量景观优化的原理，对每个选项进行评估。\n\n系统的总能量 $E_{\\text{total}}$ 是四个残基的自身能量与两个非共价相互作用对 P1–Q1 和 P2–Q2 的成对相互作用能量之和。\n$$E_{\\text{total}} = E_{\\text{self}}^{\\text{P1}}(r) + E_{\\text{self}}^{\\text{Q1}}(s) + E_{\\text{self}}^{\\text{P2}}(t) + E_{\\text{self}}^{\\text{Q2}}(u) + E_{\\text{pair}}^{\\text{P1-Q1}}(r,s) + E_{\\text{pair}}^{\\text{P2-Q2}}(t,u)$$\n如果最小重原子距离 $d_{\\min}$ 小于或等于 $4.0 \\,\\text{\\AA}$，则一个残基-残基对处于接触状态。\n\n**1. 初始状态分析**\n\n给定的初始旋转异构体为 P1($r=2$)、Q1($s=1$)、P2($t=1$) 和 Q2($u=2$)。\n\n总的初始能量 $E_{\\text{init}}$ 为：\n$$E_{\\text{init}} = E_{\\text{self}}^{\\text{P1}}(2) + E_{\\text{self}}^{\\text{Q1}}(1) + E_{\\text{self}}^{\\text{P2}}(1) + E_{\\text{self}}^{\\text{Q2}}(2) + E_{\\text{pair}}^{\\text{P1-Q1}}(2,1) + E_{\\text{pair}}^{\\text{P2-Q2}}(1,2)$$\n代入给定值：\n$$E_{\\text{init}} = (0.2 + 0.3 + 0.4 + 0.2) + (-0.5) + (-0.6) \\,\\text{kcal}\\,\\text{mol}^{-1}$$\n$$E_{\\text{init}} = 1.1 - 1.1 = 0.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$$\n\n初始接触集由所选旋转异构体对的最小距离决定：\n- 对于 P1–Q1，旋转异构体对为 $(r,s)=(2,1)$，其 $d_{\\min}(2,1) = 3.6 \\,\\text{\\AA}$。由于 $3.6 \\le 4.0$，P1–Q1 处于接触状态。\n- 对于 P2–Q2，旋转异构体对为 $(t,u)=(1,2)$，其 $d_{\\min}(1,2) = 4.2 \\,\\text{\\AA}$。由于 $4.2 > 4.0$，P2–Q2 不处于接触状态。\n初始接触集为 {P1–Q1}。\n\n**2. 侧链重排分析**\n\n侧链重排旨在找到使总能量最小化的旋转异构体组合。由于 P1–Q1 和 P2–Q2 这两对在能量上是独立的（交叉相互作用为零），我们可以分别为每一对最小化能量。\n\n对于 P1–Q1 对 (Arginine–Aspartate)：\n每个旋转异构体组合 $(r,s)$ 的能量为 $E^{\\text{P1-Q1}}(r,s) = E_{\\text{self}}^{\\text{P1}}(r) + E_{\\text{self}}^{\\text{Q1}}(s) + E_{\\text{pair}}^{\\text{P1-Q1}}(r,s)$。\n- $E(1,1) = 0.5 + 0.3 + (-3.5) = -2.7 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(1,2) = 0.5 + 0.8 + (-1.0) = 0.3 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(2,1) = 0.2 + 0.3 + (-0.5) = 0.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(2,2) = 0.2 + 0.8 + (-2.2) = -1.2 \\,\\text{kcal}\\,\\text{mol}^{-1}$\nP1–Q1 对的最小能量为 $-2.7 \\,\\text{kcal}\\,\\text{mol}^{-1}$，对应于旋转异构体 $(r,s)=(1,1)$。\n\n对于 P2–Q2 对 (Tyrosine–Phenylalanine)：\n每个旋转异构体组合 $(t,u)$ 的能量为 $E^{\\text{P2-Q2}}(t,u) = E_{\\text{self}}^{\\text{P2}}(t) + E_{\\text{self}}^{\\text{Q2}}(u) + E_{\\text{pair}}^{\\text{P2-Q2}}(t,u)$。\n- $E(1,1) = 0.4 + 0.5 + (-1.2) = -0.3 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(1,2) = 0.4 + 0.2 + (-0.6) = 0.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(2,1) = 0.1 + 0.5 + (-0.7) = -0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$\n- $E(2,2) = 0.1 + 0.2 + (-1.4) = -1.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$\nP2–Q2 对的最小能量为 $-1.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$，对应于旋转异构体 $(t,u)=(2,2)$。\n\n重排后的总能量 $E_{\\text{repack}}$ 是每一对最小能量的总和：\n$$E_{\\text{repack}} = -2.7 + (-1.1) = -3.8 \\,\\text{kcal}\\,\\text{mol}^{-1}$$\n\n重排后的接触集由新的最优旋转异构体决定：\n- 对于 P1–Q1，新的对是 $(r,s)=(1,1)$，其 $d_{\\min}(1,1) = 2.7 \\,\\text{\\AA}$。由于 $2.7 \\le 4.0$，P1–Q1 保持接触状态。\n- 对于 P2–Q2，新的对是 $(t,u)=(2,2)$，其 $d_{\\min}(2,2) = 3.6 \\,\\text{\\AA}$。由于 $3.6 \\le 4.0$，P2–Q2 成为一个接触。\n重排后的接触集为 {P1–Q1, P2–Q2}。相对于初始状态，P1–Q1 保持接触，而 P2–Q2 成为一个新的接触。\n\n**3. 能量最小化分析**\n\n此步骤应用于重排后找到的状态：旋转异构体 P1-Q1: $(1,1)$ 和 P2-Q2: $(2,2)$。规则是将任何正值的排斥能量分量减少一个因子 $\\alpha=0.5$。总能量将减少 $(1-\\alpha)$ 乘以排斥能量的量。\n\n对于状态为 $(1,1)$ 的 P1–Q1 对，给定的排斥能量为 $E_{\\text{rep}} = +0.6 \\,\\text{kcal}\\,\\text{mol}^{-1}$。\n能量减少量为 $\\Delta E_{\\text{min,1}} = -(1-\\alpha) \\times E_{\\text{rep}} = -(1-0.5) \\times 0.6 = -0.3 \\,\\text{kcal}\\,\\text{mol}^{-1}$。\n\n对于状态为 $(2,2)$ 的 P2–Q2 对，给定的排斥能量为 $E_{\\text{rep}} = +0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$。\n能量减少量为 $\\Delta E_{\\text{min,2}} = -(1-\\alpha) \\times E_{\\text{rep}} = -(1-0.5) \\times 0.1 = -0.05 \\,\\text{kcal}\\,\\text{mol}^{-1}$。\n\n最小化后的总能量 $E_{\\text{final}}$ 为：\n$$E_{\\text{final}} = E_{\\text{repack}} + \\Delta E_{\\text{min,1}} + \\Delta E_{\\text{min,2}}$$\n$$E_{\\text{final}} = -3.8 - 0.3 - 0.05 = -4.15 \\,\\text{kcal}\\,\\text{mol}^{-1}$$\n\n问题陈述中提到，最小化是一个“小的弛豫过程...保持定性几何构型”，这意味着旋转异构体的身份和最小距离，因此接触集，在此步骤中不会改变。\n最小化后的接触集是 {P1–Q1, P2–Q2}，与重排后的状态相比没有变化。\n\n**结果总结与选项评估**\n\n- **重排**：P1–Q1 保持接触，P2–Q2 成为接触。\n- **最小化**：接触集保持为 {P1–Q1, P2–Q2}。\n\n我们现在来评估各个选项：\n\n**A. 重排后，P1–Q1 保持接触，P2–Q2 成为新的接触；最小化后，接触集不变。当总能量变化的绝对值满足 $\\lvert \\Delta E \\rvert   0.1 \\,\\text{kcal}\\,\\text{mol}^{-1}$ 并且接触图与前一次迭代的 Jaccard 指数 $J = 1$ 至少连续2个重排-最小化循环，并且侧链二面角的能量梯度最大范数低于 $10^{-3} \\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{rad}^{-1}$ 时，达到收敛。**\n该陈述的第一部分与我们的计算结果完全匹配。第二部分描述了一个稳健的、多方面的收敛标准，这是该领域的标准做法。它要求能量的稳定性（$\\lvert \\Delta E \\rvert$）、结构的稳定性（接触图 Jaccard 指数 $J=1$ 连续两个循环），以及达到局部能量最小值（低梯度范数）。这是一套全面且科学合理的标准。\n**结论：正确**\n\n**B. 重排后，相对于初始状态，接触不变，因为成对能量不能克服自身能量；最小化引入了一个新的 P1–Q2 接触。**\n第一个论断“接触不变”是错误的；P2-Q2 成为了一个接触。其推理也是错误的；有利的成对能量确实克服了不太有利的自身能量。第二个论断“最小化引入了一个新的 P1–Q2 接触”是错误的，因为在此模型中最小化不改变接触集，且 P1-Q2 相互作用可以忽略不计。仅基于一个宽松的能量阈值（$\\lvert \\Delta E \\rvert  1.0 \\,\\text{kcal}\\,\\text{mol}^{-1}$）的收敛标准是不充分的。\n**结论：错误**\n\n**C. 重排后，由于排斥弛豫，P1–Q1 的接触丢失，但 P2–Q2 仍然不接触；最小化后，两对都成为接触。**\n论断“P1–Q1 的接触丢失”是错误的。论断“P2–Q2 仍然不接触”是错误的。论断“最小化后，两对都成为接触”是错误的，因为它们在重排后已经是接触了。基于 RMSD 的收敛标准过于宽松（$2.0 \\,\\text{\\AA}$）并且不恰当地忽略了能量。\n**结论：错误**\n\n**D. 重排后，P1–Q1 转变为非接触几何构型，而 P2–Q2 仍然不接触；最小化后，P2–Q2 成为唯一的接触。**\n关于重排后状态的两个论断都是错误的。关于最小化后接触集的论断是错误的。仅基于氢键的收敛标准过于简单，忽略了其他关键的能量项和整体结构稳定性。\n**结论：错误**\n\n唯一与计算结果一致并提出一套科学严谨原则的选项是A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "开发或使用任何计算方法的最后一步，也是至关重要的一步，是性能评估。我们如何客观地衡量一个对接评分函数的优劣？此练习将指导你通过编程实践，从头开始构建评估二元分类器性能的两个黄金标准：受试者工作特征（ROC）曲线和精确率-召回率（PR）曲线。掌握这些工具不仅是发表高质量计算研究所必需的技能，更能让你批判性地解读文献中报道的各种对接方法的性能。",
            "id": "3839980",
            "problem": "给定一个实值对接打分函数，它为每个蛋白质-蛋白质构象分配一个标量分数，以及一个二元标签，指示该构象是近天然构象（$1$）还是诱饵构象（$0$）。仅使用二元分类的基本定义，推导作为分数阈值函数的受试者工作特征（ROC）曲线和精确率-召回率（PR）曲线，并使用离散梯形积分计算它们的曲线下面积。实现一个完整的程序，对于测试套件中提供的每个数据集，计算ROC曲线下面积（ROC-AUC）和PR曲线下面积（PR-AUC），两者均四舍五入到$6$位小数。\n\n基本原理与推导目标：\n- 将对接打分函数视为构象的单调排序，其中较高的分数表示其为近天然构象的置信度更强。对于任何阈值$t$，通过以下规则定义预测类别$\\hat{y}$：如果分数$s \\ge t$，则$\\hat{y} = 1$，否则$\\hat{y} = 0$。\n- 对于固定的阈值$t$和带有标签$y \\in \\{0,1\\}$的数据集，定义计数：真阳性$\\mathrm{TP}(t)$、假阳性$\\mathrm{FP}(t)$、真阴性$\\mathrm{TN}(t)$、假阴性$\\mathrm{FN}(t)$。令阳性样本总数为$P = \\sum_i y_i$，阴性样本总数为$N = \\sum_i (1 - y_i)$，其中$P \\ge 1$且$N \\ge 1$。\n- 定义真阳性率（TPR）$=\\mathrm{TP}(t)/P$、假阳性率（FPR）$=\\mathrm{FP}(t)/N$、精确率$=\\mathrm{TP}(t)/(\\mathrm{TP}(t)+\\mathrm{FP}(t))$（约定当$\\mathrm{TP}(t)+\\mathrm{FP}(t)=0$时，精确率等于$1$），以及召回率$=\\mathrm{TP}(t)/P$。\n- ROC曲线是当$t$从$+\\infty$扫描到$-\\infty$时，遍历所有唯一分数水平的点集$(\\mathrm{FPR}(t), \\mathrm{TPR}(t))$，包括端点$(0,0)$和$(1,1)$。PR曲线是在相同扫描范围内的点集$(\\mathrm{Recall}(t), \\mathrm{Precision}(t))$，包括端点$(0,1)$和$(1,\\mathrm{TP}(t_{\\min})/(\\mathrm{TP}(t_{\\min})+\\mathrm{FP}(t_{\\min})))$，其中$t_{\\min}$低于最低分数，使得所有样本都被预测为阳性。\n- 每条曲线下的面积由有序曲线点的离散梯形积分定义：对于一个有序点序列$(x_k, y_k)$，其中$k = 0,1,\\dots,K$，面积为$$\\sum_{k=0}^{K-1} \\frac{(x_{k+1}-x_k)}{2}\\,(y_{k+1}+y_k)$$\n\n程序要求：\n- 对于测试套件中的每个测试用例，使用上述定义计算ROC-AUC和PR-AUC。通过在按降序排序的唯一分数值上设置阈值，并对平局值进行分组，从而仅在分数变化时添加点，来构建离散的ROC和PR曲线。确保包含ROC的初始点$(0,0)$和PR的初始点$(0,1)$。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须按顺序包含每个测试用例的ROC-AUC和PR-AUC，两者均四舍五入到$6$位小数。例如，对于$M$个测试用例，输出列表将有$2M$个条目：$[\\mathrm{ROC}\\text{-}\\mathrm{AUC}_1,\\mathrm{PR}\\text{-}\\mathrm{AUC}_1,\\dots,\\mathrm{ROC}\\text{-}\\mathrm{AUC}_M,\\mathrm{PR}\\text{-}\\mathrm{AUC}_M]$。\n\n测试套件：\n- 案例1（平衡，近乎完美分离）：\n  - 分数：$[0.95, 0.92, 0.88, 0.85, 0.83, 0.80, 0.45, 0.40, 0.35, 0.30, 0.25, 0.15]$\n  - 标签：$[1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0]$\n- 案例2（分离效果差，大量高分诱饵构象）：\n  - 分数：$[0.90, 0.85, 0.80, 0.75, 0.70, 0.65, 0.60, 0.55, 0.50, 0.45]$\n  - 标签：$[0, 0, 0, 0, 0, 1, 1, 1, 0, 1]$\n- 案例3（多个分数水平上存在平局值）：\n  - 分数：$[0.70, 0.70, 0.70, 0.50, 0.50, 0.50, 0.30, 0.30]$\n  - 标签：$[1, 0, 1, 0, 1, 0, 1, 0]$\n- 案例4（高度不平衡，分数重叠）：\n  - 分数：$[0.95, 0.90, 0.85, 0.80, 0.75, 0.70, 0.65, 0.60, 0.55, 0.50, 0.45, 0.40, 0.35, 0.30, 0.25, 0.20, 0.15, 0.10, 0.05, 0.01]$\n  - 标签：$[0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]$\n- 案例5（所有分数相同）：\n  - 分数：$[0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50]$\n  - 标签：$[1, 1, 1, 1, 1, 0, 0, 0, 0, 0]$\n\n角度单位不适用。无需物理单位。最终输出必须是所有案例的面积的扁平化列表，按顺序排列，每个值均四舍五入到$6$位小数，如上所述。",
            "solution": "该问题有效。它提出了一个定义明确的任务，即使用标准指标评估二元分类器，其基础是统计学和机器学习的基本原理。所有数据和定义都已提供，问题是自洽的，目标清晰且可形式化。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n- **打分函数**：一个实值函数$s$为每个蛋白质-蛋白质构象分配一个分数。分数越高表示其为近天然构象的置信度越强。\n- **标签**：为每个构象提供一个二元标签$y \\in \\{0, 1\\}$，其中$y=1$为近天然构象，$y=0$为诱饵构象。\n- **分类规则**：对于阈值$t$，如果$s \\ge t$，预测类别$\\hat{y}$为$1$，否则为$0$。\n- **计数**：对于阈值$t$，计数定义为真阳性$\\mathrm{TP}(t)$、假阳性$\\mathrm{FP}(t)$、真阴性$\\mathrm{TN}(t)$和假阴性$\\mathrm{FN}(t)$。\n- **数据集总量**：$P = \\sum_i y_i$是阳性样本总数，$N = \\sum_i (1 - y_i)$是阴性样本总数。给定$P \\ge 1$和$N \\ge 1$。\n- **指标定义**：\n    - 真阳性率（TPR）/ 召回率：$\\mathrm{TPR}(t) = \\mathrm{Recall}(t) = \\mathrm{TP}(t)/P$。\n    - 假阳性率（FPR）：$\\mathrm{FPR}(t) = \\mathrm{FP}(t)/N$。\n    - 精确率：$\\mathrm{Precision}(t) = \\mathrm{TP}(t)/(\\mathrm{TP}(t)+\\mathrm{FP}(t))$，约定如果分母为$0$，则精确率为$1$。\n- **曲线定义**：\n    - ROC曲线：当$t$从$+\\infty$扫描到$-\\infty$时，点集$(\\mathrm{FPR}(t), \\mathrm{TPR}(t))$。它必须包括端点$(0,0)$和$(1,1)$。\n    - PR曲线：在相同扫描范围内的点集$(\\mathrm{Recall}(t), \\mathrm{Precision}(t))$。它必须包括端点$(0,1)$和对应于将所有样本分类为阳性的最终点。\n- **曲线下面积（AUC）计算**：面积由离散梯形积分定义：对于一个有序点序列$(x_k, y_k)$，面积为$\\sum_{k=0}^{K-1} \\frac{(x_{k+1}-x_k)}{2}\\,(y_{k+1}+y_k)$。\n- **测试套件**：提供了五个不同的测试用例，每个用例都有一列分数和相应的标签。\n- **输出要求**：对于每个测试用例，计算ROC-AUC和PR-AUC，四舍五入到$6$位小数，并以扁平化的逗号分隔列表形式输出。\n\n**步骤2：使用提取的已知条件进行验证**\n\n该问题具有科学依据，定义良好且客观。\n- **科学依据**：TP、FP、TPR、FPR、精确率、召回率、ROC曲线和PR曲线的定义在统计学和机器学习中是评估二元分类器的标准和基本概念。\n- **定义良好**：问题结构清晰。输入（分数、标签）已定义，期望的输出（ROC-AUC、PR-AUC）已明确指定。计算方法（梯形法则）已明确给出，确保每个测试用例都有唯一的解。\n- **客观性**：问题使用精确的数学和算法定义，没有主观解释的余地。\n- **完整性**：问题提供了所有必要的数据和定义。约束条件$P \\ge 1$和$N \\ge 1$防止了在TPR和FPR定义中出现除以零的错误。\n- **可行性**：数据集很小，在计算上是可行的。\n\n**步骤3：结论与行动**\n\n问题有效。将提供一个完整的解决方案。\n\n### 推导与算法设计\n\n问题的核心是根据一组带分数和标签的数据点构建受试者工作特征（ROC）曲线和精确率-召回率（PR）曲线，然后计算这些曲线下的面积。\n\n**1. 曲线构建策略**\n\n曲线是通过将分数阈值$t$从$+\\infty$变化到$-\\infty$来定义的。随着阈值$t$的降低，更多的样本被分类为阳性。真阳性率（TPR）、假阳性率（FPR）、精确率和召回率的值仅在阈值$t$穿过数据中存在的分数值时才会改变。因此，我们可以通过将唯一的分数值作为阈值来构建曲线。\n\n最高效的算法包括以下步骤：\n- 将分数$s_i$和标签$y_i$组合成对$(s_i, y_i)$。\n- 根据分数$s_i$对这些数据对进行降序排序。在分数相同的情况下，标签的相对顺序不影响最终曲线，因为所有具有相同分数的样本都作为一个整体进行处理。\n- 预先计算阳性实例总数$P = \\sum y_i$和阴性实例总数$N = \\sum (1-y_i)$。\n- 初始化真阳性（$\\mathrm{TP}$）和假阳性（$\\mathrm{FP}$）的计数为$0$。\n- ROC曲线始于点$(0,0)$，这对应于一个高于所有分数的阈值$t$。在此阈值下，$\\mathrm{TP}=0$且$\\mathrm{FP}=0$，因此$\\mathrm{FPR} = 0/N = 0$且$\\mathrm{TPR} = 0/P = 0$。\n- PR曲线始于点$(0,1)$。在最高阈值下，$\\mathrm{Recall} = \\mathrm{TP}/P = 0$。精确率的分母$\\mathrm{TP}+\\mathrm{FP}$为$0$。根据给定的约定，精确率为$1$。\n\n**2. 迭代生成点**\n\n我们遍历已排序的数据。为了正确处理分数平局的情况，我们同时处理所有具有相同分数值的数据点。\n设已排序的唯一分数为$t_1  t_2  \\dots  t_m$。\n- 对于每个唯一分数$t_j$：\n    - 识别所有满足$s_i = t_j$的样本$(s_i, y_i)$。\n    - 计算这些样本中的阳性（$\\Delta \\mathrm{TP}$）和阴性（$\\Delta \\mathrm{FP}$）数量。\n    - 更新累积计数：$\\mathrm{TP} \\leftarrow \\mathrm{TP} + \\Delta \\mathrm{TP}$ 和 $\\mathrm{FP} \\leftarrow \\mathrm{FP} + \\Delta \\mathrm{FP}$。\n    - 更新计数后，每条曲线上都会生成一个新点：\n        - **ROC点**：$(\\mathrm{FPR}, \\mathrm{TPR}) = (\\mathrm{FP}/N, \\mathrm{TP}/P)$。\n        - **PR点**：$(\\mathrm{Recall}, \\mathrm{Precision}) = (\\mathrm{TP}/P, \\mathrm{TP}/(\\mathrm{TP}+\\mathrm{FP}))$。\n\n这个过程为每条曲线生成一个点序列。在处理完所有样本后生成最后一个点，此时$\\mathrm{TP}=P$和$\\mathrm{FP}=N$，得到ROC点$(1,1)$和PR点$(1, P/(P+N))$。\n\n**3. 面积计算**\n\n曲线下面积是按规定使用梯形法则计算的。对于由有序点序列$(x_0, y_0), (x_1, y_1), \\dots, (x_K, y_K)$定义的曲线，其中x坐标非递减，面积由以下公式给出：\n$$\n\\mathrm{Area} = \\sum_{k=0}^{K-1} \\frac{(x_{k+1}-x_k)}{2}\\,(y_k + y_{k+1})\n$$\n此公式分别应用于为ROC曲线和PR曲线生成的点序列。对于ROC曲线，$x_k = \\mathrm{FPR}_k$，$y_k = \\mathrm{TPR}_k$。对于PR曲线，$x_k = \\mathrm{Recall}_k$，$y_k = \\mathrm{Precision}_k$。此计算得出ROC-AUC和PR-AUC。\n\n这一完整的方法论，从排序到点生成再到面积积分，为解决给定测试用例的问题提供了一种稳健且正确的方法。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_aucs(scores, labels):\n    \"\"\"\n    Computes the ROC-AUC and PR-AUC for a given set of scores and labels.\n\n    The function follows the derivation from first principles:\n    1. Sorts samples by score in descending order.\n    2. Iterates through unique score thresholds to generate points on the ROC and PR curves.\n       Ties in scores are handled by processing all tied samples as a single block.\n    3. Calculates the area under each curve using the trapezoidal rule.\n\n    Args:\n        scores (list of float): The predicted scores for each sample.\n        labels (list of int): The true binary labels (1 for positive, 0 for negative).\n\n    Returns:\n        tuple[float, float]: A tuple containing the ROC-AUC and PR-AUC.\n    \"\"\"\n    labels = np.array(labels)\n    P = np.sum(labels)\n    N = len(labels) - P\n\n    # According to the problem statement, P >= 1 and N >= 1, so no need for explicit checks.\n\n    # Combine scores and labels, then sort by score in descending order.\n    data = sorted(zip(scores, labels), key=lambda x: x[0], reverse=True)\n    \n    # Initialize counts and point lists for the curves.\n    tp, fp = 0.0, 0.0\n    # ROC curve starts at (0,0).\n    roc_points = [(0.0, 0.0)]\n    # PR curve starts at (Recall=0, Precision=1).\n    pr_points = [(0.0, 1.0)]\n\n    i = 0\n    while i  len(data):\n        current_score = data[i][0]\n        tp_step, fp_step = 0.0, 0.0\n\n        # Process all samples with the same score (handling ties).\n        j = i\n        while j  len(data) and data[j][0] == current_score:\n            if data[j][1] == 1:\n                tp_step += 1\n            else:\n                fp_step += 1\n            j += 1\n        \n        tp += tp_step\n        fp += fp_step\n        i = j # Move index to the next unique score block\n\n        # Calculate metrics for the new point on both curves.\n        # Add new ROC point: (FPR, TPR)\n        roc_points.append((fp / N, tp / P))\n        \n        # Add new PR point: (Recall, Precision)\n        recall = tp / P\n        # Handle the case where TP + FP = 0, though it only happens at the start.\n        precision = tp / (tp + fp) if (tp + fp) > 0 else 1.0\n        pr_points.append((recall, precision))\n\n    # Extract x and y coordinates from the point lists.\n    roc_x = np.array([p[0] for p in roc_points])\n    roc_y = np.array([p[1] for p in roc_points])\n    \n    pr_x = np.array([p[0] for p in pr_points])\n    pr_y = np.array([p[1] for p in pr_points])\n\n    # Calculate the area under each curve using the trapezoidal rule.\n    # np.trapz(y, x) implements the formula specified in the problem.\n    roc_auc = np.trapz(roc_y, roc_x)\n    pr_auc = np.trapz(pr_y, pr_x)\n    \n    return roc_auc, pr_auc\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results in the specified format.\n    \"\"\"\n    test_cases = [\n        # Case 1 (balanced, near-perfect separation)\n        (\n            [0.95, 0.92, 0.88, 0.85, 0.83, 0.80, 0.45, 0.40, 0.35, 0.30, 0.25, 0.15],\n            [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0]\n        ),\n        # Case 2 (poor separation, many high-scoring decoys)\n        (\n            [0.90, 0.85, 0.80, 0.75, 0.70, 0.65, 0.60, 0.55, 0.50, 0.45],\n            [0, 0, 0, 0, 0, 1, 1, 1, 0, 1]\n        ),\n        # Case 3 (ties at multiple score levels)\n        (\n            [0.70, 0.70, 0.70, 0.50, 0.50, 0.50, 0.30, 0.30],\n            [1, 0, 1, 0, 1, 0, 1, 0]\n        ),\n        # Case 4 (highly imbalanced with overlapping scores)\n        (\n            [0.95, 0.90, 0.85, 0.80, 0.75, 0.70, 0.65, 0.60, 0.55, 0.50, 0.45, 0.40, 0.35, 0.30, 0.25, 0.20, 0.15, 0.10, 0.05, 0.01],\n            [0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]\n        ),\n        # Case 5 (all scores identical)\n        (\n            [0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50, 0.50],\n            [1, 1, 1, 1, 1, 0, 0, 0, 0, 0]\n        )\n    ]\n\n    results = []\n    for scores, labels in test_cases:\n        roc_auc, pr_auc = calculate_aucs(scores, labels)\n        results.append(f\"{roc_auc:.6f}\")\n        results.append(f\"{pr_auc:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}