{
    "hands_on_practices": [
        {
            "introduction": "A single minimum free energy structure provides an incomplete picture of an RNA's conformational landscape. To understand RNA dynamics and its potential for tertiary folding, we must consider the entire thermodynamic ensemble of probable structures. This practice challenges you to implement a simplified version of the McCaskill algorithm, which calculates the partition function and base-pairing probabilities, providing a quantitative map of the secondary structure ensemble from first principles of statistical mechanics .",
            "id": "3862545",
            "problem": "You are asked to implement a complete, runnable program that computes ensemble properties of an Ribonucleic Acid (RNA) sequence under a simplified but scientifically plausible thermodynamic model, using principles from the McCaskill algorithm. The goal is to derive and compute the partition function, base pairing probabilities, and to extract the centroid structure under specified temperature conditions. The setting is pseudoknot-free and emphasizes tertiary structure implications via thermodynamic ensembles grounded in secondary structure constraints.\n\nBegin with the fundamental statistical mechanics concept that the Boltzmann weight of a microstate with free energy $G$ at absolute temperature $T$ (in Kelvin) is $\\exp(-\\beta G)$, where $\\beta = 1/(k_{\\mathrm{B}} T)$ and $k_{\\mathrm{B}}$ is the Boltzmann constant. The partition function $Z$ is the sum of Boltzmann weights over the ensemble of allowed RNA structures, and base pairing probabilities $p_{ij}$ arise from marginalization over microstates where nucleotides at positions $i$ and $j$ are paired.\n\nThe ensemble is defined over non-crossing (pseudoknot-free) base pairs with a minimal hairpin loop length constraint. Biophysically, only canonical Watson–Crick pairs and wobble pairs are permitted: Guanine–Cytosine (GC), Adenine–Uracil (AU), and Guanine–Uracil (GU), with complements (CG, UA, UG) also allowed. Let $n$ be the sequence length. A base pair between positions $i$ and $j$ is allowed only if $j - i - 1 \\ge m$, where the minimal hairpin loop length $m$ is specified.\n\nEnergy model and constants:\n- All energies are in kilocalories per mole (kcal/mol).\n- Boltzmann constant: $k_{\\mathrm{B}} = 0.0019872041$ kcal/(mol·K).\n- Base pair formation energies: $G_{\\mathrm{bp}}(\\mathrm{GC}) = -3.0$, $G_{\\mathrm{bp}}(\\mathrm{AU}) = -2.0$, $G_{\\mathrm{bp}}(\\mathrm{GU}) = -1.0$ (and the same for the reversed complements CG, UA, UG).\n- Stacking energy for a pair stacked on an adjacent inner pair: $G_{\\mathrm{stack}} = -0.5$.\n- Hairpin loop penalty as a function of loop length $\\ell$: $G_{\\mathrm{hairpin}}(\\ell) = 3.0 + 0.2\\,\\ell + 0.5 \\ln(\\ell)$ for $\\ell \\ge m$.\n- Minimal hairpin loop length: $m = 3$.\n\nModeling constraints:\n- The sequence positions are indexed $1,2,\\dots,n$.\n- The allowed structures are pseudoknot-free and constructed from stems that are possibly extended by stacking; hairpins close stems and must satisfy the minimal loop length constraint.\n- This simplified thermodynamic model excludes bulges, internal loops, and multibranch loops. It supports stems closed by hairpins and extended by stacking, consistent with a coarse-grained ensemble relevant for tertiary context inference by ensemble averages.\n\nUsing this model and the statistical mechanics foundation, implement a dynamic programming algorithm that:\n1. Computes the partition function $Z$ (dimensionless) of the entire ensemble for a given RNA sequence and temperature $T$.\n2. Computes the base pairing probability matrix entries $p_{ij}$ for all $1 \\le i < j \\le n$.\n3. Computes the centroid structure under the base pair distance metric, defined as the structure that minimizes the expected base-pair distance to the ensemble. Use the decision-theoretic equivalence that the centroid structure maximizes $\\sum_{(i,j)\\in S} (2\\,p_{ij} - 1)$ over all valid non-crossing structures $S$, with the understanding that pairs with $p_{ij} \\le 0.5$ contribute non-positively and should be excluded from the optimal structure. Represent the centroid structure as a list of $n$ integers, using $1$-based partner indices for paired positions and $-1$ for unpaired positions.\n\nRequired numerical and output specifications:\n- Temperatures are given in Kelvin (K). Energies are in kcal/mol. Partition functions are dimensionless.\n- Report each partition function $Z$ rounded to six decimal places.\n- Report, for each test case, the maximum base pairing probability across all $i<j$ as $p_{\\max}$ rounded to six decimal places.\n- The centroid structure must be reported as a list of $n$ integers using $1$-based indices and $-1$ for unpaired positions.\n\nTest suite:\nUse the following four test cases, each defined by a sequence and a temperature:\n- Test 1: Sequence $S_1 = \\mathrm{GCAAUUGC}$, temperature $T_1 = 310.15$ K.\n- Test 2: Sequence $S_2 = \\mathrm{GGGGCCCC}$, temperature $T_2 = 295.00$ K.\n- Test 3: Sequence $S_3 = \\mathrm{ACGUACGU}$, temperature $T_3 = 400.00$ K.\n- Test 4: Sequence $S_4 = \\mathrm{AAAAAAA}$, temperature $T_4 = 310.15$ K.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces. Each element corresponds to a test case and must itself be a list of the form $[Z,p_{\\max},\\text{centroid}]$, where $Z$ and $p_{\\max}$ are decimal numbers with six places, and $\\text{centroid}$ is the list of partner indices. For example, a line with two cases would look like:\n\"[[Z1,Pmax1,[c11,c12,...,c1n1]],[Z2,Pmax2,[c21,c22,...,c2n2]],...]\"",
            "solution": "The user has provided a problem in computational chemical biology, requiring the implementation of a dynamic programming algorithm to compute thermodynamic ensemble properties of an RNA sequence. The model is a specified simplification of established RNA secondary structure prediction frameworks.\n\n### Step 1: Problem Validation\n\nFirst, the givens of the problem are extracted and analyzed to ensure the problem is scientifically sound, well-posed, and objective.\n\n**Extracting Givens:**\n\n*   **Physical Model**: Statistical mechanics of RNA folding, using Boltzmann weights $w = \\exp(-G / (k_{\\mathrm{B}} T))$ for a structure with free energy $G$ at temperature $T$.\n*   **Ensemble Definition**: The ensemble consists of all pseudoknot-free secondary structures.\n*   **Structural Constraints**:\n    *   Allowed pairs: Guanine–Cytosine (GC), Adenine–Uracil (AU), Guanine–Uracil (GU), and their complements (CG, UA, UG).\n    *   Minimal hairpin loop length $m=3$, meaning a pair $(i, j)$ requires $j-i-1 \\ge 3$.\n*   **Energy Model (kcal/mol)**:\n    *   Base pair formation: $G_{\\mathrm{bp}}(\\mathrm{GC}) = -3.0$, $G_{\\mathrm{bp}}(\\mathrm{AU}) = -2.0$, $G_{\\mathrm{bp}}(\\mathrm{GU}) = -1.0$.\n    *   Stacking of adjacent pairs: $G_{\\mathrm{stack}} = -0.5$.\n    *   Hairpin loop of length $\\ell$: $G_{\\mathrm{hairpin}}(\\ell) = 3.0 + 0.2\\ell + 0.5 \\ln(\\ell)$.\n    *   Explicit exclusion of energy terms for bulges, internal loops, and multibranch loops.\n*   **Constants**: $k_{\\mathrm{B}} = 0.0019872041$ kcal/(mol·K).\n*   **Indexing**: Sequence indices are $1$-based.\n*   **Computational Tasks**:\n    1.  Compute the partition function, $Z$.\n    2.  Compute the base pairing probability matrix, $p_{ij}$.\n    3.  Compute the centroid structure, defined as the valid non-crossing structure $S$ that maximizes the sum $\\sum_{(i,j)\\in S} (2p_{ij} - 1)$.\n*   **Output Specifications**:\n    *   $Z$ and $p_{\\max}$ to be rounded to six decimal places.\n    *   Centroid structure as a list of $1$-based partner indices (or $-1$ for unpaired).\n*   **Test Cases**: Four specific RNA sequences and temperatures are provided.\n\n**Validation Analysis:**\n\n1.  **Scientific Grounding**: The problem is well-grounded in the principles of statistical mechanics and biophysical chemistry as applied to RNA folding. The use of a partition function, Boltzmann weights, and dynamic programming (as implied by the reference to McCaskill) is standard methodology in the field. The energy model is a simplification, but it is explicitly stated as such and its components are physically plausible. The exclusion of certain loop types is a common simplification in introductory treatments or specialized models.\n2.  **Ambiguity of \"Excludes Multibranch Loops\"**: The statement \"excludes bulges, internal loops, and multibranch loops\" is the primary source of potential ambiguity. In the context of a full energy model like ViennaRNA's, this would mean these loops are forbidden. However, in the context of defining the *energy contributions*, it can also mean that these structural motifs are permitted but have a free-energy contribution of $0$ (i.e., their formation is not penalized or rewarded). Given the reference to McCaskill and the goal of computing ensemble properties, a complete prohibition of these structures would lead to a highly restrictive and non-standard ensemble (e.g., only single stem-loops). A more plausible interpretation, which preserves the problem's non-trivial nature, is that the free energy of a structure is determined *only* by the specified terms (base-pairing, stacking, hairpins), and that other loop formations (internal, bulge, multi) have zero free energy cost.\n3.  **Well-Posedness**: Even with the ambiguity, there exists a consistent and solvable interpretation. A particularly coherent reading, which aligns with the \"simplified model\" framing, is to define the ensemble as consisting only of the open (unstructured) chain and all possible single stem-loop structures. This interpretation strictly adheres to the exclusion of multibranch loops, as it does not allow for multiple disjoint or branching stems. This model, while simple, is self-contained and allows for a complete solution.\n4.  **Completeness**: All necessary constants, formulas, and constraints are provided to implement a solution under the chosen interpretation.\n5.  **Objectivity**: The problem is stated in objective, formalizable terms.\n\n**Verdict**: The problem is **valid**. The ambiguity regarding the structural ensemble can be resolved by adopting a strict interpretation of the \"no multiloops\" rule, leading to a well-defined, albeit simplified, model. This interpretation is that the ensemble is limited to the single unstructured state and all possible single stem-loop structures.\n\n### Step 2: Algorithmic Design\n\nThe solution will be implemented via a series of dynamic programming steps. We will use $0$-based indexing internally for convenience, converting to $1$-based for the final output. Let $n$ be the sequence length.\n\n**1. Partition Function of a Single Stem-Loop ($Z_{\\mathrm{bp}}$)**\n\nWe first compute $Z_{\\mathrm{bp}}[i,j]$, the partition function of a single stem-loop structure on the subsequence $i...j$, conditional on $i$ and $j$ forming the outermost pair. This matrix is computed by iterating over increasing subsequence lengths (`diag` = $j-i$).\n\nFor a pair $(i,j)$ to form, $j-i-1 \\ge m$.\nThe value $Z_{\\mathrm{bp}}[i,j]$ is the sum of Boltzmann weights for two cases:\na.  The pair $(i, j)$ closes a hairpin loop. The weight is $W_{\\mathrm{hairpin}} = \\exp(-\\beta(G_{\\mathrm{bp}}(S_i, S_j) + G_{\\mathrm{hairpin}}(j-i-1)))$.\nb.  The pair $(i, j)$ is stacked on an inner pair $(i+1, j-1)$. The weight is $W_{\\mathrm{stack}} = \\exp(-\\beta(G_{\\mathrm{bp}}(S_i, S_j) + G_{\\mathrm{stack}})) \\times Z_{\\mathrm{bp}}[i+1, j-1]$.\n\nThe recursion is: $Z_{\\mathrm{bp}}[i,j] = W_{\\mathrm{hairpin}} + W_{\\mathrm{stack}}$.\n\n**2. Total Partition Function ($Z$)**\n\nUnder our interpretation, the total ensemble consists of the unstructured state (weight $1$) and all possible single stem-loops. The total partition function $Z$ is the sum of weights of all these structures.\n$$Z = 1 + \\sum_{0 \\le i < j < n} Z_{\\mathrm{bp}}[i,j]$$\n\n**3. Base Pairing Probabilities ($p_{ij}$)**\n\nThe probability of a pair $(k,l)$, $p_{kl}$, is the sum of probabilities of all structures in the ensemble that contain this pair, divided by $Z$. In our simplified ensemble, a pair $(k,l)$ can exist either as the outermost pair of a stem-loop, or as an inner pair stacked within a larger stem-loop.\n\nLet $P'_{kl}$ be the sum of Boltzmann weights of all structures in the ensemble containing the pair $(k,l)$.\n$p_{kl} = P'_{kl} / Z$.\n\n$P'_{kl}$ can itself be calculated with DP.\n$P'_{kl} = Z_{\\mathrm{bp}}[k,l] \\times (1 + \\text{contribution from being an inner pair})$\nLet $Z_{\\mathrm{out\\_stack}}[k,l]$ be a factor representing the sum of weights of all ways to form a stack of pairs *above* the pair $(k,l)$.\n$Z_{\\mathrm{out\\_stack}}[k,l] = 1 + W_{S}(k-1, l+1) \\times Z_{\\mathrm{out\\_stack}}[k-1, l+1]$, where $W_{S}$ is the Boltzmann weight of forming the outer stack.\nThe term of $1$ accounts for when $(k,l)$ is the outermost pair.\nThen, $P'_{kl} = Z_{\\mathrm{bp}}[k,l] \\times Z_{\\mathrm{out\\_stack}}[k,l]$. This can be computed with a DP iterating from small to large subsequence lengths.\n\n**4. Centroid Structure**\n\nThe centroid structure is the valid non-crossing structure $S$ that maximizes the score $\\sum_{(i,j)\\in S} \\gamma_{ij}$, where $\\gamma_{ij} = 2p_{ij} - 1$. This is a classic folding problem solvable with a Zuker-style dynamic programming algorithm. The key is that while the probabilities $p_{ij}$ are derived from our simplified ensemble, the search space for the centroid is the set of all standard (pseudoknot-free) secondary structures, including multiloops.\n\nLet $C[i,j]$ be the maximum score for a structure on the subsequence $i...j$.\nThe recursion is:\n$$C[i,j] = \\max \\begin{cases} C[i, j-1] & (\\text{base } j \\text{ is unpaired}) \\\\ \\max_{i \\le k < j-m} (C[i, k-1] + \\gamma_{kj} + C[k+1, j-1]) & (\\text{base } j \\text{ pairs with } k)\\end{cases}$$\nBase cases are $C[i,j]=0$ if $j-i < m+1$. The terms $C[i,k-1]$ and $C[k+1,j-1]$ are set to $0$ if their indices define an empty or invalid subsequence.\nA traceback through the DP matrix $C$ allows for reconstruction of the pairs in the optimal centroid structure.\n\nThis comprehensive plan addresses all requirements of the problem.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes RNA ensemble properties (partition function, pairing probabilities,\n    and centroid structure) based on a simplified thermodynamic model.\n    \"\"\"\n    # ------------------- GIVENS AND SETUP -------------------\n    KB = 0.0019872041  # Boltzmann constant in kcal/(mol·K)\n    G_BP = {\n        'AU': -2.0, 'UA': -2.0,\n        'GC': -3.0, 'CG': -3.0,\n        'GU': -1.0, 'UG': -1.0\n    }\n    G_STACK = -0.5\n    MIN_LOOP_LEN = 3\n\n    test_cases = [\n        (\"GCAAUUGC\", 310.15),\n        (\"GGGGCCCC\", 295.00),\n        (\"ACGUACGU\", 400.00),\n        (\"AAAAAAA\", 310.15)\n    ]\n\n    # ------------------- HELPER FUNCTIONS -------------------\n    def is_valid_pair(seq, i, j):\n        \"\"\"Checks if bases at i and j can form a canonical pair.\"\"\"\n        if i < 0 or i >= len(seq) or j < 0 or j >= len(seq):\n            return False\n        return seq[i] + seq[j] in G_BP\n\n    def hairpin_energy(length):\n        \"\"\"Calculates hairpin loop energy.\"\"\"\n        if length < MIN_LOOP_LEN:\n            return float('inf')\n        return 3.0 + 0.2 * length + 0.5 * math.log(length)\n\n    # ------------------- MAIN PROCESSING LOOP -------------------\n    all_results = []\n    for seq, temp in test_cases:\n        n = len(seq)\n        if n == 0:\n            all_results.append([1.0, 0.0, []])\n            continue\n        \n        beta = 1.0 / (KB * temp)\n\n        # -------- 1. DP for Z_bp (Partition function of a single stem-loop) --------\n        z_bp = np.zeros((n, n))\n        for diag in range(MIN_LOOP_LEN + 1, n):\n            for i in range(n - diag):\n                j = i + diag\n                \n                if not is_valid_pair(seq, i, j):\n                    continue\n\n                g_bp_val = G_BP[seq[i] + seq[j]]\n                \n                # Hairpin contribution\n                loop_len = j - i - 1\n                g_hairpin = hairpin_energy(loop_len)\n                w_hairpin = math.exp(-beta * (g_bp_val + g_hairpin))\n                z_bp[i, j] += w_hairpin\n\n                # Stacking contribution\n                if j - i - 3 >= MIN_LOOP_LEN and is_valid_pair(seq, i + 1, j - 1):\n                    w_stack = math.exp(-beta * (g_bp_val + G_STACK))\n                    z_bp[i, j] += w_stack * z_bp[i + 1, j - 1]\n\n        # -------- 2. Total Partition Function Z --------\n        total_z = 1.0 + np.sum(z_bp)\n\n        # -------- 3. Base Pairing Probabilities p_ij --------\n        z_out_stack = np.zeros((n, n))\n        for diag in range(MIN_LOOP_LEN + 1, n):\n            for i in range(n - diag):\n                j = i + diag\n                z_out_stack[i, j] = 1.0\n                \n                if i > 0 and j < n - 1 and is_valid_pair(seq, i - 1, j + 1):\n                    g_bp_outer = G_BP[seq[i - 1] + seq[j + 1]]\n                    w_s_outer = math.exp(-beta * (g_bp_outer + G_STACK))\n                    z_out_stack[i, j] += w_s_outer * z_out_stack[i - 1, j + 1]\n\n        probs = np.zeros((n, n))\n        if total_z > 1e-12:\n            probs = (z_bp * z_out_stack) / total_z\n        \n        p_max = np.max(probs) if probs.size > 0 else 0.0\n\n        # -------- 4. Centroid Structure Calculation (Zuker-style DP) --------\n        gamma = 2.0 * probs - 1.0\n        c = np.zeros((n, n))\n        trace = {}\n\n        for l in range(1, n + 1):\n            for i in range(n - l + 1):\n                j = i + l - 1\n                if j - i < MIN_LOOP_LEN + 1:\n                    continue\n                \n                score_unpaired = c[i, j - 1]\n                \n                max_k_score = -float('inf')\n                best_k = -1\n                for k in range(i, j - MIN_LOOP_LEN):\n                    score_k = gamma[k, j]\n                    if k > i: score_k += c[i, k - 1]\n                    if k + 1 <= j - 1: score_k += c[k + 1, j - 1]\n\n                    if score_k > max_k_score:\n                        max_k_score = score_k\n                        best_k = k\n                \n                if score_unpaired >= max_k_score:\n                    c[i, j] = score_unpaired\n                    trace[(i, j)] = -1\n                else:\n                    c[i, j] = max_k_score\n                    trace[(i, j)] = best_k\n        \n        # -------- 5. Traceback for Centroid Structure --------\n        centroid_struct = [-1] * n\n        pair_list = []\n        q = [(0, n - 1)]\n        \n        while q:\n            i, j = q.pop()\n            if j - i < MIN_LOOP_LEN + 1: continue\n\n            decision = trace.get((i, j))\n            if decision is None:\n                continue\n\n            if decision == -1:\n                q.append((i, j - 1))\n            else:\n                k = decision\n                pair_list.append((k, j))\n                if k > i: q.append((i, k - 1))\n                if k + 1 <= j - 1: q.append((k + 1, j - 1))\n        \n        for p1, p2 in pair_list:\n            centroid_struct[p1] = p2 + 1\n            centroid_struct[p2] = p1 + 1\n\n        all_results.append(\n            [round(total_z, 6), round(p_max, 6), centroid_struct]\n        )\n\n    # -------- 6. Final Formatting --------\n    result_strings = []\n    for z, p, c_list in all_results:\n        c_str = '[' + ','.join(map(str, c_list)) + ']'\n        result_strings.append(f\"[{z},{p},{c_str}]\")\n    \n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The intricate three-dimensional architectures of RNA are stabilized by a rich vocabulary of non-canonical interactions, many of which leverage the unique chemistry of the ribose $2^{\\prime}$-hydroxyl group. The ribose zipper is a quintessential example of such a tertiary motif. This exercise asks you to use a simple but physically-grounded harmonic model to quantify the energetic trade-off between a canonical Watson-Crick interaction and a competing ribose zipper contact, offering insight into the delicate balance of forces that governs RNA's structural fate .",
            "id": "3862590",
            "problem": "In ribonucleic acid (RNA) tertiary motifs, the ribose zipper leverages the ribose $2^{\\prime}$-hydroxyl ($2^{\\prime}$-OH) group as a hydrogen bond donor to form inter-strand contacts that compete with canonical Watson–Crick (WC) base pairing. Consider a local structural rearrangement where a single donor–acceptor contact in a canonical WC adenine–uracil environment is replaced by a $2^{\\prime}$-OH-mediated ribose zipper contact. In an atomistic molecular dynamics ensemble, the donor–acceptor heavy-atom distances are observed to be $r_{\\mathrm{WC,obs}} = 2.95\\,\\text{\\AA}$ for the WC contact and $r_{\\mathrm{RZ,obs}} = 2.80\\,\\text{\\AA}$ for the ribose-zipper contact.\n\nAssume the free energy along the donor–acceptor distance coordinate can be approximated near its minimum by the harmonic expansion of the potential of mean force (PMF),\n$$\n\\Delta G_{i}(r) \\approx \\Delta G_{i,\\min} + \\frac{1}{2}\\,k_{i}\\,\\bigl(r - r_{i,\\mathrm{eq}}\\bigr)^{2},\n$$\nwhere $i \\in \\{\\mathrm{WC}, \\mathrm{RZ}\\}$, $\\Delta G_{i,\\min}$ is the well depth at the equilibrium distance $r_{i,\\mathrm{eq}}$, and $k_{i}$ is the curvature (effective stiffness) at the minimum. Use the following physically plausible parameters consistent with spectroscopic and computational characterizations of hydrogen bonds in nucleic acids:\n- For the WC contact: $\\Delta G_{\\mathrm{WC,\\min}} = -2.5\\,\\mathrm{kcal/mol}$, $r_{\\mathrm{WC,eq}} = 2.90\\,\\text{\\AA}$, $k_{\\mathrm{WC}} = 30\\,\\mathrm{kcal/(mol\\cdot\\text{\\AA}^{2})}$.\n- For the ribose zipper (RZ) contact: $\\Delta G_{\\mathrm{RZ,\\min}} = -1.8\\,\\mathrm{kcal/mol}$, $r_{\\mathrm{RZ,eq}} = 2.75\\,\\text{\\AA}$, $k_{\\mathrm{RZ}} = 20\\,\\mathrm{kcal/(mol\\cdot\\text{\\AA}^{2})}$.\n\nTasks:\n- Compute the geometric change in donor–acceptor distance, $\\Delta r = r_{\\mathrm{RZ,obs}} - r_{\\mathrm{WC,obs}}$, and use it to qualitatively rationalize how $2^{\\prime}$-OH participation alters local geometry.\n- Quantitatively evaluate the impact on local stability by computing the free energy difference\n$$\n\\Delta\\Delta G \\equiv \\Delta G_{\\mathrm{RZ}}(r_{\\mathrm{RZ,obs}}) - \\Delta G_{\\mathrm{WC}}(r_{\\mathrm{WC,obs}}).\n$$\n\nReport only the final value of $\\Delta\\Delta G$ as your answer. Round your answer to three significant figures. Express the free energy in kilocalories per mole (kcal/mol).",
            "solution": "The problem requires the calculation of the change in free energy, $\\Delta\\Delta G$, associated with a local structural rearrangement in an RNA molecule. This rearrangement involves replacing a canonical Watson–Crick (WC) hydrogen bond with a ribose zipper (RZ) hydrogen bond. The free energy for each state is modeled using a harmonic approximation of the potential of mean force (PMF) near the energy minimum.\n\nFirst, we address the qualitative task of evaluating the geometric change. The change in the donor–acceptor distance is given by $\\Delta r = r_{\\mathrm{RZ,obs}} - r_{\\mathrm{WC,obs}}$. Substituting the observed values:\n$$\n\\Delta r = 2.80\\,\\text{\\AA} - 2.95\\,\\text{\\AA} = -0.15\\,\\text{\\AA}\n$$\nThis negative value indicates that the ribose zipper contact is shorter than the Watson–Crick contact. This structural compaction is consistent with the distinct stereochemical nature of hydrogen bonds involving the ribose $2^{\\prime}$-hydroxyl group compared to those in standard base pairs.\n\nThe primary objective is to compute the free energy difference $\\Delta\\Delta G \\equiv \\Delta G_{\\mathrm{RZ}}(r_{\\mathrm{RZ,obs}}) - \\Delta G_{\\mathrm{WC}}(r_{\\mathrm{WC,obs}})$. We separately calculate the free energy for each state at its observed donor–acceptor distance using the provided harmonic model:\n$$\n\\Delta G_{i}(r) = \\Delta G_{i,\\min} + \\frac{1}{2}\\,k_{i}\\,\\bigl(r - r_{i,\\mathrm{eq}}\\bigr)^{2}\n$$\n\nFor the Watson–Crick contact, the free energy at the observed distance $r_{\\mathrm{WC,obs}} = 2.95\\,\\text{\\AA}$ is calculated using the parameters $\\Delta G_{\\mathrm{WC,\\min}} = -2.5\\,\\mathrm{kcal/mol}$, $r_{\\mathrm{WC,eq}} = 2.90\\,\\text{\\AA}$, and $k_{\\mathrm{WC}} = 30\\,\\mathrm{kcal/(mol\\cdot\\text{\\AA}^{2})}$.\n$$\n\\Delta G_{\\mathrm{WC}}(r_{\\mathrm{WC,obs}}) = \\Delta G_{\\mathrm{WC,\\min}} + \\frac{1}{2}\\,k_{\\mathrm{WC}}\\,(r_{\\mathrm{WC,obs}} - r_{\\mathrm{WC,eq}})^{2}\n$$\n$$\n\\Delta G_{\\mathrm{WC}}(2.95\\,\\text{\\AA}) = -2.5\\,\\mathrm{kcal/mol} + \\frac{1}{2}\\,\\left(30\\,\\mathrm{kcal/(mol\\cdot\\text{\\AA}^{2})}\\right)\\,(2.95\\,\\text{\\AA} - 2.90\\,\\text{\\AA})^{2}\n$$\n$$\n\\Delta G_{\\mathrm{WC}}(2.95\\,\\text{\\AA}) = -2.5 + 15\\,(0.05)^{2}\\,\\mathrm{kcal/mol}\n$$\n$$\n\\Delta G_{\\mathrm{WC}}(2.95\\,\\text{\\AA}) = -2.5 + 15\\,(0.0025)\\,\\mathrm{kcal/mol}\n$$\n$$\n\\Delta G_{\\mathrm{WC}}(2.95\\,\\text{\\AA}) = -2.5 + 0.0375\\,\\mathrm{kcal/mol}\n$$\n$$\n\\Delta G_{\\mathrm{WC}}(2.95\\,\\text{\\AA}) = -2.4625\\,\\mathrm{kcal/mol}\n$$\n\nFor the ribose zipper contact, the free energy at the observed distance $r_{\\mathrm{RZ,obs}} = 2.80\\,\\text{\\AA}$ is calculated using the parameters $\\Delta G_{\\mathrm{RZ,\\min}} = -1.8\\,\\mathrm{kcal/mol}$, $r_{\\mathrm{RZ,eq}} = 2.75\\,\\text{\\AA}$, and $k_{\\mathrm{RZ}} = 20\\,\\mathrm{kcal/(mol\\cdot\\text{\\AA}^{2})}$.\n$$\n\\Delta G_{\\mathrm{RZ}}(r_{\\mathrm{RZ,obs}}) = \\Delta G_{\\mathrm{RZ,\\min}} + \\frac{1}{2}\\,k_{\\mathrm{RZ}}\\,(r_{\\mathrm{RZ,obs}} - r_{\\mathrm{RZ,eq}})^{2}\n$$\n$$\n\\Delta G_{\\mathrm{RZ}}(2.80\\,\\text{\\AA}) = -1.8\\,\\mathrm{kcal/mol} + \\frac{1}{2}\\,\\left(20\\,\\mathrm{kcal/(mol\\cdot\\text{\\AA}^{2})}\\right)\\,(2.80\\,\\text{\\AA} - 2.75\\,\\text{\\AA})^{2}\n$$\n$$\n\\Delta G_{\\mathrm{RZ}}(2.80\\,\\text{\\AA}) = -1.8 + 10\\,(0.05)^{2}\\,\\mathrm{kcal/mol}\n$$\n$$\n\\Delta G_{\\mathrm{RZ}}(2.80\\,\\text{\\AA}) = -1.8 + 10\\,(0.0025)\\,\\mathrm{kcal/mol}\n$$\n$$\n\\Delta G_{\\mathrm{RZ}}(2.80\\,\\text{\\AA}) = -1.8 + 0.025\\,\\mathrm{kcal/mol}\n$$\n$$\n\\Delta G_{\\mathrm{RZ}}(2.80\\,\\text{\\AA}) = -1.775\\,\\mathrm{kcal/mol}\n$$\n\nNow, we compute the free energy difference $\\Delta\\Delta G$ by subtracting the free energy of the initial WC state from the final RZ state.\n$$\n\\Delta\\Delta G = \\Delta G_{\\mathrm{RZ}}(r_{\\mathrm{RZ,obs}}) - \\Delta G_{\\mathrm{WC}}(r_{\\mathrm{WC,obs}})\n$$\n$$\n\\Delta\\Delta G = (-1.775\\,\\mathrm{kcal/mol}) - (-2.4625\\,\\mathrm{kcal/mol})\n$$\n$$\n\\Delta\\Delta G = -1.775 + 2.4625\\,\\mathrm{kcal/mol}\n$$\n$$\n\\Delta\\Delta G = 0.6875\\,\\mathrm{kcal/mol}\n$$\nThe problem requires the final answer to be rounded to three significant figures.\n$$\n\\Delta\\Delta G \\approx 0.688\\,\\mathrm{kcal/mol}\n$$\nThe positive value of $\\Delta\\Delta G$ indicates that, under the observed conditions and within the given model, the replacement of the WC contact with the RZ contact corresponds to a local destabilization of the structure by approximately $0.688\\,\\mathrm{kcal/mol}$.",
            "answer": "$$\n\\boxed{0.688}\n$$"
        },
        {
            "introduction": "Beyond predicting the structure of a given RNA, a central goal of synthetic biology is the inverse problem: designing a sequence that will fold into a desired three-dimensional shape. This practice introduces this design challenge through a coarse-grained model where the target topology is represented as a set of required contacts. You will devise an optimization strategy to find a sequence that maximizes the folding probability into this target state, a task that requires both minimizing the target's energy and destabilizing competing conformations within the thermodynamic ensemble .",
            "id": "3862520",
            "problem": "You are given a coarse-grained thermodynamic model to design Ribonucleic Acid (RNA) sequences that maximize the probability of folding into a prescribed tertiary contact topology. The topology is encoded as a set of binary contacts on sequence positions, and the model assigns an energy to each realized contact based on the nucleotide pair identity while allowing contacts to be skipped with a penalty. The prediction framework relies on the Boltzmann distribution, which states that the probability of a configuration with energy $E$ at absolute temperature $T$ is proportional to $\\exp(-\\beta E)$, where $\\beta = 1/(k_{\\mathrm{B}} T)$ and $k_{\\mathrm{B}}$ is the Boltzmann constant. The task is to formulate the folding probability of the specific topology via a partition function over feasible contact-realization states, derive an algorithm to design sequences that maximize the target topology probability, and implement it as a deterministic program.\n\nFundamental base:\n- Thermodynamic ensembles and the Boltzmann distribution: the probability of a microstate with energy $E$ is $p \\propto \\exp(-\\beta E)$.\n- Free energy additivity for independent interactions and feasibility constraints: the total energy equals the sum of contributions when interactions are allowed and pairwise conflicts are respected.\n\nModel definitions:\n- Alphabet $\\{\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{U}\\}$ for RNA nucleotides indexed on positions $i \\in \\{1,\\dots,N\\}$.\n- Target tertiary topology defined by an undirected set of contacts $E = \\{(i,j)\\}$ with $1 \\le i &lt; j \\le N$. Each contact represents a potential long-range tertiary interaction.\n- Each contact $(i,j)$ can be either realized or skipped. Let $x_{(i,j)} \\in \\{0,1\\}$ denote the realization state, with $x_{(i,j)} = 1$ indicating realization and $x_{(i,j)} = 0$ indicating skipping.\n- Feasibility constraint: at most one realized contact per position. Formally, for any set $\\{(i,j)\\}$ with $x_{(i,j)} = 1$, no index $i$ or $j$ appears in more than one realized contact.\n- Pairwise contact energy function $E_{\\mathrm{pair}}(b_i,b_j)$ given in kilocalories per mole, where $b_i, b_j \\in \\{\\mathrm{A}, \\mathrm{C}, \\mathrm{G}, \\mathrm{U}\\}$ are the nucleotides at positions $i$ and $j$. Allowed base pairs and their energies are:\n  - Watson–Crick: $(\\mathrm{A},\\mathrm{U})$ and $(\\mathrm{U},\\mathrm{A})$ have $E_{\\mathrm{pair}} = -2.0$,\n  - Watson–Crick: $(\\mathrm{G},\\mathrm{C})$ and $(\\mathrm{C},\\mathrm{G})$ have $E_{\\mathrm{pair}} = -3.0$,\n  - Wobble: $(\\mathrm{G},\\mathrm{U})$ and $(\\mathrm{U},\\mathrm{G})$ have $E_{\\mathrm{pair}} = -1.0$.\n  - All other nucleotide pairs have $E_{\\mathrm{pair}} = +4.0$ to strongly disfavor noncanonical contacts.\n- Skipping energy penalty per contact $E_{\\mathrm{skip}}$ (in kilocalories per mole) is a given scalar per test instance.\n- Total energy of a configuration $x$ for a sequence $s$ is $E(s,x) = \\sum_{(i,j) \\in E} \\left[ x_{(i,j)} \\, E_{\\mathrm{pair}}(b_i,b_j) + (1 - x_{(i,j)}) \\, E_{\\mathrm{skip}} \\right]$, calculated in kilocalories per mole.\n- The partition function $Z(s) = \\sum_{x \\in \\mathcal{X}} \\exp\\left(-\\beta E(s,x)\\right)$ sums over the set $\\mathcal{X}$ of all feasible $x$ satisfying the one-contact-per-position constraint.\n- The probability that the desired topology is fully realized (that is, $x_{(i,j)} = 1$ for all $(i,j) \\in E$) is $p_{\\mathrm{topo}}(s) = \\frac{\\exp\\left(-\\beta E_{\\mathrm{all}}(s)\\right)}{Z(s)}$, where $E_{\\mathrm{all}}(s)$ is the energy with all contacts realized. If the full realization violates feasibility (for example, two contacts share a position), then $p_{\\mathrm{topo}}(s) = 0$.\n\nOptimization directive:\n- For each test instance, you must propose an RNA sequence $s$ of specified length $N$ that maximizes $p_{\\mathrm{topo}}(s)$ under the above model using a logically sound optimization strategy (for example, deterministic greedy assignment followed by local search). You must then compute $p_{\\mathrm{topo}}(s)$ by exact enumeration of $\\mathcal{X}$ to evaluate the partition function and the probability for the designed sequence.\n- Use $k_{\\mathrm{B}} = 0.0019872041$ in units of kilocalories per mole per Kelvin, and absolute temperature $T$ in Kelvin.\n- Express probabilities as unitless decimal numbers. Do not use the percentage sign.\n\nTest suite:\n- Case $1$: $N = 12$, $E = \\{(1,12),(2,11),(4,9)\\}$, $T = 310$ Kelvin, $E_{\\mathrm{skip}} = 0.5$ kilocalories per mole.\n- Case $2$: $N = 4$, $E = \\{(2,3)\\}$, $T = 298$ Kelvin, $E_{\\mathrm{skip}} = 0.0$ kilocalories per mole.\n- Case $3$: $N = 12$, $E = \\{(1,12),(2,11),(4,9)\\}$, $T = 1000$ Kelvin, $E_{\\mathrm{skip}} = 0.5$ kilocalories per mole.\n- Case $4$: $N = 6$, $E = \\{(2,5),(2,6)\\}$, $T = 310$ Kelvin, $E_{\\mathrm{skip}} = 0.2$ kilocalories per mole.\n- Case $5$: $N = 8$, $E = \\{(1,8),(3,6)\\}$, $T = 310$ Kelvin, $E_{\\mathrm{skip}} = 0.2$ kilocalories per mole.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each probability must be rounded to six decimal places, for example, $[\\;0.123456,0.234567,0.345678\\;]$.",
            "solution": "The objective is to design RNA sequences that maximize the probability that a specific contact topology is fully realized under a thermodynamic ensemble consistent with basic statistical mechanics. The fundamental principle is the Boltzmann distribution, which states that at absolute temperature $T$ the probability of a microstate with energy $E$ is proportional to $\\exp(-\\beta E)$, where $\\beta = 1/(k_{\\mathrm{B}} T)$ and $k_{\\mathrm{B}}$ is the Boltzmann constant. The canonical partition function $Z = \\sum_{\\text{microstates}} \\exp(-\\beta E)$ normalizes these probabilities.\n\nIn this problem, the microstates are defined by binary realization variables $x_{(i,j)} \\in \\{0,1\\}$ for each contact $(i,j) \\in E$, subject to the feasibility constraint that no position participates in more than one realized contact. The energy function is additive across contacts: $E(s,x) = \\sum_{(i,j) \\in E} \\left[ x_{(i,j)} E_{\\mathrm{pair}}(b_i,b_j) + (1-x_{(i,j)}) E_{\\mathrm{skip}} \\right]$, where $E_{\\mathrm{pair}}$ is determined by the nucleotide identities at the contact positions, and $E_{\\mathrm{skip}}$ is a penalty for not realizing a contact.\n\nThe targeted outcome is the fully realized topology where $x_{(i,j)} = 1$ for all $(i,j) \\in E$. If the topology itself violates feasibility (for example, two edges share a position), then there is no feasible microstate with all contacts realized, and the probability of the topology is $p_{\\mathrm{topo}}(s) = 0$. If the topology is feasible, the energy for the fully realized configuration is $E_{\\mathrm{all}}(s) = \\sum_{(i,j) \\in E} E_{\\mathrm{pair}}(b_i,b_j)$, and the partition function is\n$$\nZ(s) = \\sum_{x \\in \\mathcal{X}} \\exp\\big(-\\beta E(s,x)\\big),\n$$\nwhere $\\mathcal{X}$ denotes the set of all feasible $x$ satisfying the one-contact-per-position constraint. The desired probability is then\n$$\np_{\\mathrm{topo}}(s) = \\frac{\\exp\\left(-\\beta E_{\\mathrm{all}}(s)\\right)}{Z(s)}.\n$$\nWhen contacts are disjoint, the feasibility constraint factorizes across contacts, and the partition function factorizes: each contact contributes $\\exp(-\\beta E_{\\mathrm{pair}})$ for realized and $\\exp(-\\beta E_{\\mathrm{skip}})$ for skipped, leading to a product of per-contact partition terms. However, to maintain generality and exactness when there are conflicts, we enumerate all $2^{|E|}$ realization patterns and discard those violating feasibility, computing $Z(s)$ by summation over the feasible set $\\mathcal{X}$.\n\nThe design strategy must increase $p_{\\mathrm{topo}}(s)$. From the expression above, increasing $p_{\\mathrm{topo}}(s)$ requires decreasing $E_{\\mathrm{all}}(s)$ (more stabilizing contacts) and also relatively decreasing the statistical weight of alternatives in $Z(s)$. The energy model provides $E_{\\mathrm{pair}}(\\mathrm{G},\\mathrm{C}) = -3.0$, $E_{\\mathrm{pair}}(\\mathrm{A},\\mathrm{U}) = -2.0$, and $E_{\\mathrm{pair}}(\\mathrm{G},\\mathrm{U}) = -1.0$, with all other pairs set to $+4.0$. Therefore, a rational initial design is to assign nucleotides for each contact to achieve the most stabilizing canonical base pair, typically $\\mathrm{G}$–$\\mathrm{C}$, subject to positional constraints. This greedy choice minimizes $E_{\\mathrm{all}}(s)$ directly for disjoint contacts. To refine and verify the design, a lightweight local search (for example, random single-position mutations accepted if they increase $p_{\\mathrm{topo}}(s)$) can be applied.\n\nAlgorithm description:\n- For each test case $(N, E, T, E_{\\mathrm{skip}})$, initialize the sequence $s$ of length $N$ with a default nucleotide (for example, $\\mathrm{A}$).\n- For each contact $(i,j) \\in E$, choose the nucleotide pair $(b_i,b_j)$ that minimizes $E_{\\mathrm{pair}}(b_i,b_j)$ from the allowed set $\\{(\\mathrm{A},\\mathrm{U}),(\\mathrm{U},\\mathrm{A}),(\\mathrm{G},\\mathrm{C}),(\\mathrm{C},\\mathrm{G}),(\\mathrm{G},\\mathrm{U}),(\\mathrm{U},\\mathrm{G})\\}$; this is a deterministic greedy assignment.\n- Compute $\\beta = 1/(k_{\\mathrm{B}} T)$ using $k_{\\mathrm{B}} = 0.0019872041$ in kilocalories per mole per Kelvin.\n- Enumerate all realization vectors $x \\in \\{0,1\\}^{|E|}$, filter those that are feasible (no shared positions among contacts with $x_{(i,j)} = 1$), and sum the Boltzmann weights $\\exp(-\\beta E(s,x))$ to obtain $Z(s)$.\n- If the fully realized topology violates feasibility, report $p_{\\mathrm{topo}}(s) = 0$. Otherwise, compute $E_{\\mathrm{all}}(s)$ and return $p_{\\mathrm{topo}}(s) = \\exp(-\\beta E_{\\mathrm{all}}(s))/Z(s)$.\n\nThis approach adheres to the thermodynamic principle for equilibrium probabilities, enforces physical constraints on contact incompatibility, and yields exact probabilities via enumeration due to the modest contact set sizes. The greedy assignment is justified by the energy model and serves as a principled optimizer for the given contact topology, while the exact computation of $Z(s)$ ensures accurate evaluation of the designed sequence.\n\nImplementation details:\n- The program encodes the energy table for $E_{\\mathrm{pair}}$.\n- The partition function calculator enumerates feasible $x$ by checking that no index appears in more than one realized contact.\n- Results are computed for the specified test suite:\n  - Case $1$ tests a general disjoint-contact topology at physiological temperature $T = 310$ Kelvin with nonzero skipping penalty.\n  - Case $2$ tests a single-contact boundary with zero skipping penalty at $T = 298$ Kelvin.\n  - Case $3$ tests high temperature $T = 1000$ Kelvin to probe entropic dominance.\n  - Case $4$ tests an infeasible full realization due to shared positions, yielding zero probability.\n  - Case $5$ tests another disjoint-contact topology with mild skipping penalty.\n- The final output is a single line representing the list of probabilities rounded to six decimal places, free of units and percentage signs.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Thermodynamic constant: Boltzmann constant in kcal/mol/K\nK_B = 0.0019872041\n\n# Pair energy table (kcal/mol)\nPAIR_ENERGY = {\n    ('A', 'U'): -2.0,\n    ('U', 'A'): -2.0,\n    ('G', 'C'): -3.0,\n    ('C', 'G'): -3.0,\n    ('G', 'U'): -1.0,\n    ('U', 'G'): -1.0,\n}\n\n# Disallowed pairs penalty (strongly unfavorable contact)\nDISALLOWED_ENERGY = 4.0\n\nNUCLEOTIDES = np.array(['A', 'C', 'G', 'U'])\n\ndef energy_pair(b1: str, b2: str) -> float:\n    \"\"\"Return the pair energy for nucleotides b1-b2.\"\"\"\n    return PAIR_ENERGY.get((b1, b2), DISALLOWED_ENERGY)\n\ndef is_full_realization_feasible(edges):\n    \"\"\"Check if realizing all contacts is feasible (no shared positions).\"\"\"\n    used = set()\n    for i, j in edges:\n        if i in used or j in used:\n            return False\n        used.add(i)\n        used.add(j)\n    return True\n\ndef feasible_mask(mask: int, edges):\n    \"\"\"Check feasibility of a realization bitmask: no position used by multiple realized edges.\"\"\"\n    used = set()\n    for k, (i, j) in enumerate(edges):\n        if (mask >> k) & 1:\n            if (i in used) or (j in used):\n                return False\n            used.add(i)\n            used.add(j)\n    return True\n\ndef configuration_energy(seq, edges, mask, e_skip):\n    \"\"\"Compute energy for a given realization mask.\"\"\"\n    E = 0.0\n    for k, (i, j) in enumerate(edges):\n        if (mask >> k) & 1:\n            E += energy_pair(seq[i-1], seq[j-1])\n        else:\n            E += e_skip\n    return E\n\ndef partition_function(seq, edges, T, e_skip):\n    \"\"\"Compute partition function Z by exact enumeration of feasible masks.\"\"\"\n    beta = 1.0 / (K_B * T)\n    M = len(edges)\n    Z = 0.0\n    E_all = None\n    # Compute energy of fully realized topology if feasible\n    if is_full_realization_feasible(edges):\n        mask_all = (1 << M) - 1\n        E_all = configuration_energy(seq, edges, mask_all, e_skip)\n    # Enumerate all masks\n    for mask in range(1 << M):\n        if feasible_mask(mask, edges):\n            E = configuration_energy(seq, edges, mask, e_skip)\n            Z += np.exp(-beta * E)\n    return Z, E_all, beta\n\ndef design_initial_sequence(N, edges):\n    \"\"\"Greedy design: pick best base pair for each edge; fill others with 'A'.\"\"\"\n    seq = np.array(['A'] * N)\n    # For each edge, select the base pair with minimum energy\n    allowed_pairs = [('A', 'U'), ('U', 'A'), ('G', 'C'), ('C', 'G'), ('G', 'U'), ('U', 'G')]\n    for (i, j) in edges:\n        # Choose the best pair\n        best_pair = min(allowed_pairs, key=lambda p: energy_pair(p[0], p[1]))\n        seq[i-1] = best_pair[0]\n        seq[j-1] = best_pair[1]\n    return seq\n\ndef local_search(seq, edges, T, e_skip, steps=400, seed=42):\n    \"\"\"Simple hill-climbing: mutate random positions if probability improves.\"\"\"\n    rng = np.random.default_rng(seed)\n    # Compute current probability\n    Z, E_all, beta = partition_function(seq, edges, T, e_skip)\n    if E_all is None:\n        # Full realization infeasible; probability is zero; nothing to improve\n        return seq, 0.0\n    p_best = float(np.exp(-beta * E_all) / Z)\n    best_seq = seq.copy()\n    N = len(seq)\n    for _ in range(steps):\n        pos = int(rng.integers(0, N))\n        old = best_seq[pos]\n        # Propose a mutant different from current\n        choices = NUCLEOTIDES[NUCLEOTIDES != old]\n        new_nt = str(choices[int(rng.integers(0, len(choices)))])\n        best_seq[pos] = new_nt\n        Z_new, E_all_new, beta_new = partition_function(best_seq, edges, T, e_skip)\n        if E_all_new is None:\n            # Infeasible; reject\n            best_seq[pos] = old\n            continue\n        p_new = float(np.exp(-beta_new * E_all_new) / Z_new)\n        if p_new >= p_best:\n            p_best = p_new\n            # keep mutation\n        else:\n            # reject mutation\n            best_seq[pos] = old\n    return best_seq, p_best\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, edges, T, E_skip)\n    test_cases = [\n        (12, [(1,12),(2,11),(4,9)], 310.0, 0.5),\n        (4,  [(2,3)],                298.0, 0.0),\n        (12, [(1,12),(2,11),(4,9)],  1000.0, 0.5),\n        (6,  [(2,5),(2,6)],          310.0, 0.2),\n        (8,  [(1,8),(3,6)],          310.0, 0.2),\n    ]\n\n    results = []\n    for N, edges, T, e_skip in test_cases:\n        # Greedy initialization\n        seq0 = design_initial_sequence(N, edges)\n        # Local search refinement\n        seq_opt, p = local_search(seq0, edges, T, e_skip, steps=400, seed=123)\n        # Ensure probability computed exactly for final sequence (for consistency)\n        Z, E_all, beta = partition_function(seq_opt, edges, T, e_skip)\n        if E_all is None:\n            p_topo = 0.0\n        else:\n            p_topo = float(np.exp(-beta * E_all) / Z)\n        # Round to six decimals\n        results.append(f\"{p_topo:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}