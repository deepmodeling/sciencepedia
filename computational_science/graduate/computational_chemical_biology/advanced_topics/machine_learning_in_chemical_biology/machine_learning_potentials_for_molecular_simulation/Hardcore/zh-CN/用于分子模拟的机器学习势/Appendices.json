{
    "hands_on_practices": [
        {
            "introduction": "为了掌握机器学习势，我们首先需要揭开其核心部件——神经网络的神秘面纱。此练习通过一个简化的原子神经网络模型，引导您手动计算一个小型三原子体系的总能量，从而直观地理解能量是如何作为原子贡献的总和来计算的。通过这个过程，您将亲身体验并验证机器学习势的一个关键设计原则：总能量对原子指数的排列具有不变性，这是确保物理一致性的基石。",
            "id": "3851774",
            "problem": "在计算化学生物学中使用的原子级机器学习原子间势中，预测的 Born–Oppenheimer 势能被设计成一个标量，通过将总能量分解为原子能量贡献之和，使其对原子指数的排列保持不变，并且相对于原子数量具有广延性。考虑一个玩具三原子系统，其中每个原子的环境由一个固定的描述子向量 $\\mathbf{x}_{i} \\in \\mathbb{R}^{3}$ 编码，该向量以旋转和平移不变的方式总结了局部几何结构，以及一个原子级神经网络，该网络使用带有修正线性单元（ReLU）激活函数的双层架构，将 $\\mathbf{x}_{i}$ 映射到一个标量原子能量贡献 $\\varepsilon_{i}$。预测的总能量为 $E = \\sum_{i=1}^{3} \\varepsilon_{i}$。对于每个原子 $i$，该网络计算隐藏层预激活值 $\\mathbf{a}_{i} = \\mathbf{W}_{1}\\mathbf{x}_{i} + \\mathbf{b}_{1}$，隐藏层激活值 $\\mathbf{h}_{i} = \\max(\\mathbf{0}, \\mathbf{a}_{i})$（逐元素应用），以及原子能量 $\\varepsilon_{i} = \\mathbf{w}_{2}^{\\top}\\mathbf{h}_{i} + b_{2}$，其中 $\\mathbf{W}_{1} \\in \\mathbb{R}^{2 \\times 3}$、$\\mathbf{b}_{1} \\in \\mathbb{R}^{2}$、$\\mathbf{w}_{2} \\in \\mathbb{R}^{2}$ 和 $b_{2} \\in \\mathbb{R}$ 是固定的权重。使用以下参数和描述子：\n$$\n\\mathbf{W}_{1} = \\begin{pmatrix}\n0.5  -0.2  0.1 \\\\\n-0.3  0.4  0.2\n\\end{pmatrix},\\quad\n\\mathbf{b}_{1} = \\begin{pmatrix}\n0.05 \\\\\n-0.10\n\\end{pmatrix},\\quad\n\\mathbf{w}_{2} = \\begin{pmatrix}\n0.8 \\\\\n-0.5\n\\end{pmatrix},\\quad\nb_{2} = 0.02,\n$$\n和\n$$\n\\mathbf{x}_{1} = \\begin{pmatrix} 1.2 \\\\ 0.7 \\\\ -0.3 \\end{pmatrix},\\quad\n\\mathbf{x}_{2} = \\begin{pmatrix} 0.5 \\\\ -0.1 \\\\ 0.6 \\end{pmatrix},\\quad\n\\mathbf{x}_{3} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 0.2 \\end{pmatrix}.\n$$\n从势能是一个对原子指数排列不变的标量，并且在没有相互作用的情况下能量对子系统是可加的这一物理要求出发，并仅使用上述关于网络映射和 ReLU 非线性的定义，计算给定顺序 $\\left( \\mathbf{x}_{1}, \\mathbf{x}_{2}, \\mathbf{x}_{3} \\right)$ 的预测总能量 $E$（单位为电子伏特），并通过明确考虑排列后的顺序 $\\left( \\mathbf{x}_{3}, \\mathbf{x}_{1}, \\mathbf{x}_{2} \\right)$ 来验证其对原子指数排列的不变性。将您最终报告的总能量四舍五入到四位有效数字，并以 $\\mathrm{eV}$ 表示。最终报告的答案必须是单一数值。",
            "solution": "该问题提法恰当，具有科学依据，并提供了使用指定的神经网络势模型计算三原子系统总势能所需的所有信息。所有参数和输入数据都定义清晰且维度一致。因此，该问题是有效的，可以推导出解决方案。\n\n总势能 $E$ 定义为各原子能量贡献 $\\varepsilon_{i}$ 的总和：\n$$E = \\sum_{i=1}^{3} \\varepsilon_{i}$$\n每个原子能量 $\\varepsilon_{i}$ 是通过将原子的描述子向量 $\\mathbf{x}_{i}$ 输入一个双层神经网络来计算的。该网络的计算过程如下：\n1. 计算隐藏层预激活向量 $\\mathbf{a}_{i} \\in \\mathbb{R}^{2}$：\n$$\\mathbf{a}_{i} = \\mathbf{W}_{1}\\mathbf{x}_{i} + \\mathbf{b}_{1}$$\n2. 通过逐元素应用修正线性单元（ReLU）函数 $\\max(\\mathbf{0}, \\cdot)$ 来计算隐藏层激活向量 $\\mathbf{h}_{i} \\in \\mathbb{R}^{2}$：\n$$\\mathbf{h}_{i} = \\max(\\mathbf{0}, \\mathbf{a}_{i})$$\n3. 计算标量原子能量贡献 $\\varepsilon_{i} \\in \\mathbb{R}$：\n$$\\varepsilon_{i} = \\mathbf{w}_{2}^{\\top}\\mathbf{h}_{i} + b_{2}$$\n给定的参数是：\n$$\n\\mathbf{W}_{1} = \\begin{pmatrix}\n0.5  -0.2  0.1 \\\\\n-0.3  0.4  0.2\n\\end{pmatrix},\\quad\n\\mathbf{b}_{1} = \\begin{pmatrix}\n0.05 \\\\\n-0.10\n\\end{pmatrix},\\quad\n\\mathbf{w}_{2} = \\begin{pmatrix}\n0.8 \\\\\n-0.5\n\\end{pmatrix},\\quad\nb_{2} = 0.02\n$$\n输入的描述子向量是：\n$$\n\\mathbf{x}_{1} = \\begin{pmatrix} 1.2 \\\\ 0.7 \\\\ -0.3 \\end{pmatrix},\\quad\n\\mathbf{x}_{2} = \\begin{pmatrix} 0.5 \\\\ -0.1 \\\\ 0.6 \\end{pmatrix},\\quad\n\\mathbf{x}_{3} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 0.2 \\end{pmatrix}\n$$\n我们现在将为每个原子 $i \\in \\{1, 2, 3\\}$ 计算原子能量 $\\varepsilon_{i}$。\n\n**原子1的计算：**\n首先，我们计算预激活向量 $\\mathbf{a}_{1}$：\n$$\n\\mathbf{a}_{1} = \\begin{pmatrix} 0.5  -0.2  0.1 \\\\ -0.3  0.4  0.2 \\end{pmatrix} \\begin{pmatrix} 1.2 \\\\ 0.7 \\\\ -0.3 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbf{a}_{1} = \\begin{pmatrix} (0.5)(1.2) + (-0.2)(0.7) + (0.1)(-0.3) \\\\ (-0.3)(1.2) + (0.4)(0.7) + (0.2)(-0.3) \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbf{a}_{1} = \\begin{pmatrix} 0.6 - 0.14 - 0.03 \\\\ -0.36 + 0.28 - 0.06 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.43 \\\\ -0.14 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.48 \\\\ -0.24 \\end{pmatrix}\n$$\n接下来，我们应用 ReLU 激活函数得到 $\\mathbf{h}_{1}$：\n$$ \\mathbf{h}_{1} = \\max(\\mathbf{0}, \\mathbf{a}_{1}) = \\begin{pmatrix} \\max(0, 0.48) \\\\ \\max(0, -0.24) \\end{pmatrix} = \\begin{pmatrix} 0.48 \\\\ 0 \\end{pmatrix} $$\n最后，我们计算原子能量 $\\varepsilon_{1}$：\n$$\n\\varepsilon_{1} = \\mathbf{w}_{2}^{\\top}\\mathbf{h}_{1} + b_{2} = \\begin{pmatrix} 0.8  -0.5 \\end{pmatrix} \\begin{pmatrix} 0.48 \\\\ 0 \\end{pmatrix} + 0.02\n$$\n$$\n\\varepsilon_{1} = (0.8)(0.48) + (-0.5)(0) + 0.02 = 0.384 + 0 + 0.02 = 0.404\n$$\n\n**原子2的计算：**\n我们对 $\\mathbf{x}_{2}$ 遵循相同的步骤。首先，计算预激活向量 $\\mathbf{a}_{2}$：\n$$\n\\mathbf{a}_{2} = \\begin{pmatrix} 0.5  -0.2  0.1 \\\\ -0.3  0.4  0.2 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ -0.1 \\\\ 0.6 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbf{a}_{2} = \\begin{pmatrix} (0.5)(0.5) + (-0.2)(-0.1) + (0.1)(0.6) \\\\ (-0.3)(0.5) + (0.4)(-0.1) + (0.2)(0.6) \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbf{a}_{2} = \\begin{pmatrix} 0.25 + 0.02 + 0.06 \\\\ -0.15 - 0.04 + 0.12 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.33 \\\\ -0.07 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.38 \\\\ -0.17 \\end{pmatrix}\n$$\n接下来，应用 ReLU 激活函数得到 $\\mathbf{h}_{2}$：\n$$ \\mathbf{h}_{2} = \\max(\\mathbf{0}, \\mathbf{a}_{2}) = \\begin{pmatrix} \\max(0, 0.38) \\\\ \\max(0, -0.17) \\end{pmatrix} = \\begin{pmatrix} 0.38 \\\\ 0 \\end{pmatrix} $$\n最后，计算原子能量 $\\varepsilon_{2}$：\n$$\n\\varepsilon_{2} = \\mathbf{w}_{2}^{\\top}\\mathbf{h}_{2} + b_{2} = \\begin{pmatrix} 0.8  -0.5 \\end{pmatrix} \\begin{pmatrix} 0.38 \\\\ 0 \\end{pmatrix} + 0.02\n$$\n$$\n\\varepsilon_{2} = (0.8)(0.38) + (-0.5)(0) + 0.02 = 0.304 + 0 + 0.02 = 0.324\n$$\n\n**原子3的计算：**\n我们对 $\\mathbf{x}_{3}$ 重复此过程。首先，计算预激活向量 $\\mathbf{a}_{3}$：\n$$\n\\mathbf{a}_{3} = \\begin{pmatrix} 0.5  -0.2  0.1 \\\\ -0.3  0.4  0.2 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 0.2 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbfa_{3} = \\begin{pmatrix} (0.5)(1.0) + (-0.2)(0.0) + (0.1)(0.2) \\\\ (-0.3)(1.0) + (0.4)(0.0) + (0.2)(0.2) \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix}\n$$\n$$\n\\mathbf{a}_{3} = \\begin{pmatrix} 0.5 + 0 + 0.02 \\\\ -0.3 + 0 + 0.04 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.52 \\\\ -0.26 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.10 \\end{pmatrix} = \\begin{pmatrix} 0.57 \\\\ -0.36 \\end{pmatrix}\n$$\n接下来，应用 ReLU 激活函数得到 $\\mathbf{h}_{3}$：\n$$ \\mathbf{h}_{3} = \\max(\\mathbf{0}, \\mathbf{a}_{3}) = \\begin{pmatrix} \\max(0, 0.57) \\\\ \\max(0, -0.36) \\end{pmatrix} = \\begin{pmatrix} 0.57 \\\\ 0 \\end{pmatrix} $$\n最后，计算原子能量 $\\varepsilon_{3}$：\n$$\n\\varepsilon_{3} = \\mathbf{w}_{2}^{\\top}\\mathbf{h}_{3} + b_{2} = \\begin{pmatrix} 0.8  -0.5 \\end{pmatrix} \\begin{pmatrix} 0.57 \\\\ 0 \\end{pmatrix} + 0.02\n$$\n$$\n\\varepsilon_{3} = (0.8)(0.57) + (-0.5)(0) + 0.02 = 0.456 + 0 + 0.02 = 0.476\n$$\n\n**总能量计算：**\n顺序为 $(\\mathbf{x}_{1}, \\mathbf{x}_{2}, \\mathbf{x}_{3})$ 的总能量是原子能量的总和：\n$$ E = \\varepsilon_{1} + \\varepsilon_{2} + \\varepsilon_{3} = 0.404 + 0.324 + 0.476 = 1.204 $$\n\n**排列不变性的验证：**\n问题要求验证总能量相对于原子指数排列的不变性，具体方法是考虑顺序 $(\\mathbf{x}_{3}, \\mathbf{x}_{1}, \\mathbf{x}_{2})$。\n这个排列后的顺序的总能量，我们称之为 $E'$，将按如下方式计算：\n$$ E' = \\varepsilon(\\mathbf{x}_{3}) + \\varepsilon(\\mathbf{x}_{1}) + \\varepsilon(\\mathbf{x}_{2}) $$\n其中 $\\varepsilon(\\mathbf{x}_{i})$ 是描述子为 $\\mathbf{x}_{i}$ 的原子的能量贡献。由于神经网络函数 $\\varepsilon(\\cdot)$ 是独立应用于每个原子的描述子，因此 $\\varepsilon_{1}$、$\\varepsilon_{2}$ 和 $\\varepsilon_{3}$ 的值与它们在列表中的位置无关。总能量是这些贡献的总和。根据加法的交换律：\n$$ E' = \\varepsilon_{3} + \\varepsilon_{1} + \\varepsilon_{2} = \\varepsilon_{1} + \\varepsilon_{2} + \\varepsilon_{3} = E $$\n使用我们已经计算出的值：\n$$ E' = 0.476 + 0.404 + 0.324 = 1.204 $$\n这明确地证明了 $E' = E$，从而验证了总能量对原子指数的排列是不变的。这个性质是能量被定义为原子贡献之和的直接结果，其中每个贡献仅取决于该原子的局部环境（编码在 $\\mathbf{x}_{i}$ 中），而不取决于系统中原子的任意标记或排序。描述子 $\\mathbf{x}_i$ 本身对旋转和平移不变的要求确保了整体的几何不变性，而求和则确保了排列不变性。\n\n最终总能量是 $1.204\\,\\mathrm{eV}$。问题要求答案四舍五入到四位有效数字。计算值 $1.204$ 已经有四位有效数字。",
            "answer": "$$\n\\boxed{1.204}\n$$"
        },
        {
            "introduction": "一个机器学习势的预测能力在很大程度上取决于它如何感知和编码原子环境。这一步是通过“描述符”或“对称函数”来完成的，它们是神经网络的输入。本练习将理论与实际应用相结合，向您展示如何利用已知的物理结构信息（如此处给出的液态水的径向分布函数）来理性地设计这些描述符的超参数。掌握这一技能对于为特定化学体系构建高精度、高效率的机器学习势至关重要。",
            "id": "3851748",
            "problem": "您的任务是为机器学习（ML）原子间势设计原子中心描述符，以解析液态水中的氢键几何构型。考虑一个对称函数框架，其中径向特征由超参数 $(\\eta, r_s, r_c)$ 参数化，而角向特征由控制方向敏感度的形状和锐度项参数化。您的设计必须基于液态水的物理结构统计数据和窗函数的基本性质来证明其合理性。\n\n假设关于环境条件下液态水有以下经由实验和计算充分证实的结构事实：\n- 氧-氧径向分布函数（RDF），$g_{OO}(r)$，在 $r \\approx 2.8\\,\\mathrm{\\AA}$ 处有一个显著的第一峰，其峰宽（一西格玛尺度）约为 $0.25\\,\\mathrm{\\AA}$，并在 $r \\approx 4.5\\,\\mathrm{\\AA}$ 处有一个第二近邻峰，其宽度约为 $0.30\\,\\mathrm{\\AA}$。\n- 氧-氢径向分布函数，$g_{OH}(r)$，在 $r \\approx 0.97\\,\\mathrm{\\AA}$ 处有一个非常尖锐的分子内峰，宽度约为 $0.05\\,\\mathrm{\\AA}$，并在 $r \\approx 1.8\\,\\mathrm{\\AA}$ 附近有一个较弱的分子间肩峰，宽度约为 $0.20\\,\\mathrm{\\AA}$。\n- 氢键给体的几何构型特征是给体氧-氢矢量与给体氧-受体氧矢量的对齐。将给体氧上的角相关函数 $C_{OHO}(\\theta)$ 定义为 $\\vec{r}_{OH}$（分子内）和 $\\vec{r}_{OO}$（指向第一壳层近邻）之间的夹角 $\\theta$ 的分布。该相关性在 $\\theta \\approx 0^\\circ$ 处呈强峰，典型扩展约为 $20^\\circ$，反映了强氢键中近乎共线的特性。\n\n您将使用以下通用设计原则：\n- RDF $g_{\\alpha\\beta}(r)$ 编码了在距离类型为 $\\alpha$ 的参考原子 $r$ 处找到类型为 $\\beta$ 的近邻的概率密度。在数密度为 $\\rho_\\beta$ 的各向同性系统中，$g_{\\alpha\\beta}(r)$ 可以通过 $g_{\\alpha\\beta}(r) = \\frac{1}{4\\pi r^2 \\rho_\\beta} \\frac{dN_{\\alpha\\beta}(r)}{dr}$ 与期望的近邻数相关联，并且 $g_{\\alpha\\beta}(r)$ 中的峰识别了配位壳层。\n- 一个以 $r_s$ 为中心、超参数为 $\\eta$ 的类高斯径向窗会衰减远离 $r_s$ 的贡献。对于形式为 $\\exp\\!\\left[-\\eta (r - r_s)^2\\right]$ 的窗函数，其振幅相对于峰值下降到 $e^{-1}$ 处的距离为 $\\Delta r = 1/\\sqrt{\\eta}$，这可作为 $r_s$ 附近的有效分辨率尺度。\n- 一个以给体氧为中心的三体角向项应增加 $\\vec{r}_{OH}$ 和 $\\vec{r}_{OO}$ 之间小角度的权重，以表示沿给体 O–H 方向的近线性氢键。应使用可调的锐度参数来匹配在 $\\theta \\approx 0^\\circ$ 附近观察到的角度扩展。\n\n您的目标是为氧-氧和氧-氢径向通道选择 $(\\eta, r_s, r_c)$，以及合适的角向参数，使得描述符能够同时区分：\n- 第一和第二氧配位壳层，\n- 分子内氧-氢共价键，\n- 氢键特有的近共线给体 O–H 到 O–O 的排列。\n\n下面哪个选项在保持与所提供结构统计数据物理上一致的同时，最能满足这些要求？\n\nA. 选择 $r_c = 5.5\\,\\mathrm{\\AA}$。使用两个氧-氧径向窗，参数分别为 $(\\eta, r_s) = \\left(16\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$ 和 $\\left(11\\,\\mathrm{\\AA}^{-2}, 4.5\\,\\mathrm{\\AA}\\right)$，以及一个氧-氢分子内窗，参数为 $(\\eta, r_s) = \\left(100\\,\\mathrm{\\AA}^{-2}, 0.97\\,\\mathrm{\\AA}\\right)$。包含一个以氧为中心的、作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 三元组的角向项，该项使用“余弦位移幂”形式，其参数对应于在 $\\theta \\approx 0^\\circ$ 处的偏好，锐度参数为 $\\zeta = 10$，从而强调 $\\vec{r}_{OH}$ 和 $\\vec{r}_{OO}$ 之间的小角度。\n\nB. 选择 $r_c = 3.0\\,\\mathrm{\\AA}$。使用一个氧-氧径向窗，参数为 $(\\eta, r_s) = \\left(8\\,\\mathrm{\\AA}^{-2}, 3.5\\,\\mathrm{\\AA}\\right)$，以及一个氧-氢分子间窗，参数为 $(\\eta, r_s) = \\left(5\\,\\mathrm{\\AA}^{-2}, 1.8\\,\\mathrm{\\AA}\\right)$。包含一个以氧为中心的、作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的角向项，其参数对应于在 $\\theta \\approx 180^\\circ$ 处的偏好，锐度参数为 $\\zeta = 4$。\n\nC. 选择 $r_c = 8.0\\,\\mathrm{\\AA}$。使用宽窗函数，氧-氧参数为 $(\\eta, r_s) = \\left(1\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$，氧-氢参数为 $(\\eta, r_s) = \\left(2\\,\\mathrm{\\AA}^{-2}, 1.0\\,\\mathrm{\\AA}\\right)$。包含一个以氧为中心的、作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的角向项，该项不强烈偏好任何角度，使用一个非常平缓的锐度参数 $\\zeta = 1$。\n\nD. 选择 $r_c = 5.5\\,\\mathrm{\\AA}$。使用氧-氧参数 $(\\eta, r_s) = \\left(16\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$ 和氧-氢参数 $(\\eta, r_s) = \\left(100\\,\\mathrm{\\AA}^{-2}, 0.97\\,\\mathrm{\\AA}\\right)$。包含一个以氧为中心的、作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的角向项，其参数对应于在 $\\theta \\approx 180^\\circ$ 处的偏好，锐度参数为 $\\zeta = 10$。\n\n选择唯一的最佳选项。",
            "solution": "用户提供了一个问题，要求为原子中心描述符集设计和选择最优的超参数，特别是针对用于液态水模拟的机器学习势。该问题需要在对称函数框架内解决。所做的选择必须基于提供的液态水结构统计数据来证明其合理性。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤1：提取给定条件**\n\n- **系统**：液态水。\n- **目标**：为机器学习（ML）原子间势设计原子中心描述符，以解析氢键几何构型。\n- **框架**：对称函数框架。\n- **径向特征**：由超参数 $(\\eta, r_s, r_c)$ 参数化。\n- **角向特征**：由形状和锐度项参数化。\n- **设计目标**：描述符必须能区分：\n    1.  第一和第二氧配位壳层。\n    2.  分子内氧-氢共价键。\n    3.  近共线的给体 O–H 到 O–O 排列。\n- **结构数据**：\n    - **$g_{OO}(r)$**：第一峰位于 $r \\approx 2.8\\,\\mathrm{\\AA}$（宽度 $\\approx 0.25\\,\\mathrm{\\AA}$）；第二峰位于 $r \\approx 4.5\\,\\mathrm{\\AA}$（宽度 $\\approx 0.30\\,\\mathrm{\\AA}$）。\n    - **$g_{OH}(r)$**：分子内峰位于 $r \\approx 0.97\\,\\mathrm{\\AA}$（宽度 $\\approx 0.05\\,\\mathrm{\\AA}$）；分子间肩峰位于 $r \\approx 1.8\\,\\mathrm{\\AA}$ 附近（宽度 $\\approx 0.20\\,\\mathrm{\\AA}$）。\n    - **氢键角**：分子内矢量 $\\vec{r}_{OH}$ 与分子间矢量 $\\vec{r}_{OO}$（从给体O到受体O）之间的夹角 $\\theta$ 在 $\\theta \\approx 0^\\circ$ 处呈强峰，扩展约 $20^\\circ$。\n- **设计原则**：\n    - RDFs ($g_{\\alpha\\beta}(r)$) 中的峰对应配位壳层。\n    - 径向窗函数形式：$\\exp\\!\\left[-\\eta (r - r_s)^2\\right]$。\n    - 径向窗的有效分辨率：$\\Delta r = 1/\\sqrt{\\eta}$（振幅下降到 $e^{-1}$ 处的距离）。\n    - 给体氢键的角向项应增加小角度 $\\theta \\approx 0^\\circ$ 的权重。\n\n**步骤2：使用提取的给定条件进行验证**\n\n- **科学依据**：该问题基于统计力学（径向分布函数）、计算化学（机器学习势、对称函数）的公认原理以及液态水的已知结构。提供的键长、峰位置和宽度的数值是标准的且符合事实。高斯参数 $\\eta$ 与其宽度之间的数学关系是正确的。该问题在科学上是合理的。\n- **适定性**：该问题要求根据从物理数据中导出的一套清晰全面的标准，从一组选项中选出最佳选项。目标定义明确，通过逻辑应用所提供的原则，可以在选项中确定唯一的最佳解。\n- **客观性**：该问题以精确、技术性的语言陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n\n问题陈述是有效的。它具有科学依据、适定性、客观性，并包含所有必要信息。我将继续推导解决方案并评估各个选项。\n\n### 最优参数的推导\n\n根据问题陈述，可以推导出一组理想的参数。\n\n1.  **截断半径 ($r_c$)**：描述符必须捕获氧原子的第一和第二配位壳层内的相互作用。第二壳层峰位于 $r \\approx 4.5\\,\\mathrm{\\AA}$。因此，截断半径 $r_c$ 必须显著大于 $4.5\\,\\mathrm{\\AA}$ 才能完全包含该壳层。一个在 $5.5\\,\\mathrm{\\AA}$ 到 $6.0\\,\\mathrm{\\AA}$ 左右的值是合适的，它在准确性和计算效率之间取得了平衡。\n\n2.  **氧-氧（O-O）径向特征**：为了“区分第一和第二氧配位壳层”，至少需要两个独立的径向函数。\n    - **第一壳层**：峰位于 $r \\approx 2.8\\,\\mathrm{\\AA}$，宽度 $\\sigma \\approx 0.25\\,\\mathrm{\\AA}$。相应的径向函数应具有 $r_s = 2.8\\,\\mathrm{\\AA}$。锐度参数 $\\eta$ 的选择应使得分辨率 $\\Delta r = 1/\\sqrt{\\eta}$ 与峰宽匹配。因此，$\\eta \\approx (1/0.25\\,\\mathrm{\\AA})^2 = 16\\,\\mathrm{\\AA}^{-2}$。\n    - **第二壳层**：峰位于 $r \\approx 4.5\\,\\mathrm{\\AA}$，宽度 $\\sigma \\approx 0.30\\,\\mathrm{\\AA}$。相应的径向函数应具有 $r_s = 4.5\\,\\mathrm{\\AA}$。锐度应为 $\\eta \\approx (1/0.30\\,\\mathrm{\\AA})^2 \\approx 11.1\\,\\mathrm{\\AA}^{-2}$。$\\eta \\approx 11\\,\\mathrm{\\AA}^{-2}$ 的值是一个合适的近似。\n\n3.  **氧-氢（O-H）径向特征**：为了描述“分子内氧-氢共价键”，必须有一个径向函数针对此特征。\n    - **分子内键**：峰位于 $r \\approx 0.97\\,\\mathrm{\\AA}$，宽度非常尖锐，$\\sigma \\approx 0.05\\,\\mathrm{\\AA}$。该函数应具有 $r_s = 0.97\\,\\mathrm{\\AA}$。锐度应为 $\\eta \\approx (1/0.05\\,\\mathrm{\\AA})^2 = 400\\,\\mathrm{\\AA}^{-2}$。这是一个非常高的值。在实践中，通常使用稍小的值以避免极端敏感性。像 $\\eta = 100\\,\\mathrm{\\AA}^{-2}$（$\\Delta r = 0.1\\,\\mathrm{\\AA}$）这样的值仍然可以创建一个非常尖锐的特征，足以分离出共价键。\n\n4.  **角向特征**：为了表示近线性的氢键，角向项必须捕获给体 O-H 键和 O-O 矢量之间的相关性。\n    - **角度偏好**：问题陈述指出，对于一个给体氢键，$\\vec{r}_{OH}$（分子内）和 $\\vec{r}_{OO}$ 之间的夹角 $\\theta$ 在 $\\theta \\approx 0^\\circ$ 处呈强峰。因此，角函数必须被构造成在 $\\theta = 0^\\circ$（或 $\\cos\\theta = 1$）处有最大值。\n    - **锐度**：角度分布被描述为“呈强峰”，且“扩展约 $20^\\circ$”。这意味着需要一个相对较高的锐度参数 $\\zeta$。像 $\\zeta=1$ 这样的低值会太宽泛，而像 $\\zeta=10$ 这样的高值则适合创建一个清晰的峰。\n\n### 逐项分析\n\n现在，我将根据这些推导出的要求来评估每个选项。\n\n**A. 选择 $r_c = 5.5\\,\\mathrm{\\AA}$。使用两个氧-氧径向窗，参数分别为 $(\\eta, r_s) = \\left(16\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$ 和 $\\left(11\\,\\mathrm{\\AA}^{-2}, 4.5\\,\\mathrm{\\AA}\\right)$，以及一个氧-氢分子内窗，参数为 $(\\eta, r_s) = \\left(100\\,\\mathrm{\\AA}^{-2}, 0.97\\,\\mathrm{\\AA}\\right)$。包含一个以氧为中心的、作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 三元组的角向项，该项使用“余弦位移幂”形式，其参数对应于在 $\\theta \\approx 0^\\circ$ 处的偏好，锐度参数为 $\\zeta = 10$。**\n- **$r_c$**：$5.5\\,\\mathrm{\\AA}$ 是一个绝佳的选择，因为它包含了第一和第二 O-O 壳层。\n- **O-O 径向**：使用两个窗是正确的。第一个窗 $(\\eta, r_s) = (16\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA})$，完美匹配我们为第一壳层推导的参数。第二个窗 $(\\eta, r_s) = (11\\,\\mathrm{\\AA}^{-2}, 4.5\\,\\mathrm{\\AA})$，完美匹配我们为第二壳层推导的参数。这个设置成功地区分了两个壳层。\n- **O-H 径向**：窗 $(\\eta, r_s) = (100\\,\\mathrm{\\AA}^{-2}, 0.97\\,\\mathrm{\\AA})$ 的选择是恰当的。中心 $r_s$ 是正确的，锐度 $\\eta$ 很大，正确反映了 O-H 共价键的刚性。\n- **角向**：该项正确地描述了以氧为中心，涉及氢和另一个氧的三元组。它正确地偏好 $\\theta \\approx 0^\\circ$ 并使用了高锐度参数 $\\zeta=10$，这与氢键角分布的“呈强峰”特性一致。\n**结论：正确。**此选项的参数具有物理合理性，并系统地满足了所有设计目标。\n\n**B. 选择 $r_c = 3.0\\,\\mathrm{\\AA}$。使用一个氧-氧径向窗，参数为 $(\\eta, r_s) = \\left(8\\,\\mathrm{\\AA}^{-2}, 3.5\\,\\mathrm{\\AA}\\right)$，以及一个氧-氢分子间窗，参数为 $(\\eta, r_s) = \\left(5\\,\\mathrm{\\AA}^{-2}, 1.8\\,\\mathrm{\\AA}\\right)$。包含一个以氧为中心的、作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的角向项，其参数对应于在 $\\theta \\approx 180^\\circ$ 处的偏好，锐度参数为 $\\zeta = 4$。**\n- **$r_c$**：$3.0\\,\\mathrm{\\AA}$ 太小了。它排除了位于 $4.5\\,\\mathrm{\\AA}$ 的第二 O-O 壳层，并截断了第一壳层的一部分，使其无法满足一个关键的设计目标。\n- **O-O 径向**：只使用一个窗函数无法区分两个壳层。中心 $r_s = 3.5\\,\\mathrm{\\AA}$ 位于 $g_{OO}(r)$ 函数的极小值处，这是一个物理上没有意义的位置来设置描述符中心。\n- **O-H 径向**：此选项关注分子间肩峰，完全忽略了分子内共价键的描述符，这是另一个关键设计目标。\n- **角向**：对于所定义的角度，偏好 $\\theta \\approx 180^\\circ$ 在几何上是错误的，对于给体氢键，该角度应接近 $0^\\circ$。\n**结论：错误。**此选项在每个主要设计点上都失败了。\n\n**C. 选择 $r_c = 8.0\\,\\mathrm{\\AA}$。使用宽窗函数，氧-氧参数为 $(\\eta, r_s) = \\left(1\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$，氧-氢参数为 $(\\eta, r_s) = \\left(2\\,\\mathrm{\\AA}^{-2}, 1.0\\,\\mathrm{\\AA}\\right)$。包含一个以氧为中心的、作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的角向项，该项不强烈偏好任何角度，使用一个非常平缓的锐度参数 $\\zeta = 1$。**\n- **$r_c$**：$8.0\\,\\mathrm{\\AA}$ 是一个有效但偏大的截断半径。\n- **O-O 径向**：它只使用一个 O-O 窗，未能区分两个壳层。锐度 $\\eta=1\\,\\mathrm{\\AA}^{-2}$ 创建了一个非常宽的函数（$\\Delta r = 1\\,\\mathrm{\\AA}$），这会把第一和第二壳层模糊在一起，无法解析它们。\n- **O-H 径向**：锐度 $\\eta=2\\,\\mathrm{\\AA}^{-2}$ 对于非常尖锐的分子内峰（宽度 $\\approx 0.05\\,\\mathrm{\\AA}$）来说也太小了，导致分辨率差。\n- **角向**：$\\zeta=1$ 的锐度创建了一个几乎均匀的角度分布，未能捕捉到氢键的强方向性。\n**结论：错误。**参数过于宽泛（$\\eta$ 值低）且数量不足，无法解析指定的结构特征。\n\n**D. 选择 $r_c = 5.5\\,\\mathrm{\\AA}$。使用氧-氧参数 $(\\eta, r_s) = \\left(16\\,\\mathrm{\\AA}^{-2}, 2.8\\,\\mathrm{\\AA}\\right)$ 和氧-氢参数 $(\\eta, r_s) = \\left(100\\,\\mathrm{\\AA}^{-2}, 0.97\\,\\mathrm{\\AA}\\right)$。包含一个以氧为中心的、作用于 $(\\mathrm{O},\\mathrm{H},\\mathrm{O})$ 的角向项，其参数对应于在 $\\theta \\approx 180^\\circ$ 处的偏好，锐度参数为 $\\zeta = 10$。**\n- **$r_c$**：$5.5\\,\\mathrm{\\AA}$ 是一个不错的选择。\n- **O-O 径向**：它只使用一个 O-O 径向函数。虽然这个函数对于第一壳层来说选择得很好，但缺少针对 $4.5\\,\\mathrm{\\AA}$ 处壳层的第二个函数，意味着它未能达到区分第一和第二壳层的目标。\n- **O-H 径向**：O-H 键的参数是合适的。\n- **角向**：偏好 $\\theta \\approx 180^\\circ$ 是一个关键错误，因为它与提供的给体氢键角结构数据相矛盾。\n**结论：错误。**此选项未能区分 O-O 壳层，并使用了不正确的角度偏好。\n\n基于详细分析，选项 A 是唯一正确且全面满足问题陈述中所有要求的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "即使机器学习模型能够准确预测训练数据，它也必须遵守基本的物理定律，其中能量守恒是最重要的一条。一个力场如果可以从一个标量势能函数 $U$ 导出（即 $\\mathbf{F} = -\\nabla U$），则称其为保守力场。本练习介绍了一个强有力的解析工具——旋度（curl），用于检验一个给定的力场是否满足这一条件。通过计算一个假设的机器学习力场的旋度，您将学会如何诊断和识别可能导致能量在分子动力学模拟中不守恒的非物理行为。",
            "id": "3851711",
            "problem": "一个机器学习（ML）模型被训练用于预测生物分子构象景观的二维慢流形上的粗粒化力，其中坐标 $x$ 和 $y$ 被视为无量纲反应坐标。在此流形的一个局部区域，该模型输出以下力场 $\\mathbf{F}(x,y)$：\n$$\n\\mathbf{F}(x,y) \\;=\\; \\big(F_x(x,y),\\,F_y(x,y)\\big) \\;=\\; \\big(-k\\,x \\,-\\,\\lambda\\,y\\,+\\,\\alpha\\,x\\,y^{2},\\;\\; -k\\,y \\,-\\,\\lambda\\,x\\,+\\,\\beta\\,x^{2}\\,y\\big),\n$$\n其中 $k$、$\\lambda$、$\\alpha$ 和 $\\beta$ 是常数。在由光滑标量势 $U(x,y)$ 驱动的保守动力学中，力在单连通域上满足 $\\mathbf{F}(x,y)=-\\nabla U(x,y)$。\n\n仅使用基本定义，计算该二维场的旋度 $\\nabla\\times\\mathbf{F}$ 的平面外分量，将其表示为 $x$、$y$、$k$、$\\lambda$、$\\alpha$ 和 $\\beta$ 的解析函数。然后，基于第一性原理，解释该量的非零值如何证明其与在 $(x,y)$ 域上存在单值标量势（假定所需的光滑性）不一致。您最终报告的量必须是 $\\nabla\\times\\mathbf{F}$ 平面外分量的解析表达式；不需要数值取整，也不需要物理单位。",
            "solution": "对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- 一个二维力场 $\\mathbf{F}(x,y) = \\big(F_x(x,y),\\,F_y(x,y)\\big)$ 定义在一个具有无量纲坐标 $x$ 和 $y$ 的流形上。\n- 力场的分量由以下公式给出：\n  $$F_x(x,y) = -k\\,x \\,-\\,\\lambda\\,y\\,+\\,\\alpha\\,x\\,y^{2}$$\n  $$F_y(x,y) = -k\\,y \\,-\\,\\lambda\\,x\\,+\\,\\beta\\,x^{2}\\,y$$\n- $k$、$\\lambda$、$\\alpha$ 和 $\\beta$ 被指定为常数。\n- 保守力场的条件被表述为 $\\mathbf{F}(x,y)=-\\nabla U(x,y)$，其中 $U(x,y)$ 是单连通域上的光滑标量势。\n- 任务是计算旋度 $\\nabla\\times\\mathbf{F}$ 的平面外分量，并解释其对于势 $U(x,y)$ 存在性的意义。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学或事实不健全性**：该问题在科学上是健全的。它探讨了力场为保守场的基本条件，这是经典力学和矢量微积分的基石。非零旋度与非保守场之间的联系是一个标准结果（与亥姆霍兹定理和斯托克斯定理相关）。其背景涉及用于分子力的机器学习模型，这是一个合理且当前的研究领域，在该领域中确保学习到的力是保守的是一个关键挑战。\n- **非形式化或不相关**：该问题完全可以在矢量微积分的框架内形式化，并且与开发物理一致的机器学习势的主题直接相关。\n- **不完整或矛盾的设置**：该问题是自洽的。力场函数形式已明确给出，这足以计算其旋度。没有矛盾之处。\n- **不切实际或不可行**：描述力分量的函数是多项式，它们是良态的，并且作为更复杂力场的局部近似在物理上是合理的。计算过程直接明了。\n- **不适定或结构不良**：该问题是适定的。计算给定矢量场的旋度是一个标准操作，会产生唯一的结果。其解释基于已建立的数学定理。\n- **伪深刻、琐碎或同义反复**：该问题既不琐碎也不伪深刻。它测试了对学习力场中物理真实性的数学条件的核心概念理解。\n- **超出科学可验证性**：这些主张在数学上是可验证的。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n该问题要求计算一个二维矢量场旋度的平面外分量，并在保守动力学的背景下对结果进行解释。\n\n设给定的二维力场为 $\\mathbf{F}(x,y) = F_x(x,y)\\,\\mathbf{\\hat{i}} + F_y(x,y)\\,\\mathbf{\\hat{j}}$。为计算其旋度，我们可以将其视为一个三维场 $\\mathbf{F}(x,y,z) = F_x(x,y)\\,\\mathbf{\\hat{i}} + F_y(x,y)\\,\\mathbf{\\hat{j}} + 0\\,\\mathbf{\\hat{k}}$，其中各分量与 $z$ 坐标无关。\n\n$\\mathbf{F}$ 的旋度由以下矩阵的行列式定义：\n$$\n\\nabla \\times \\mathbf{F} = \n\\begin{vmatrix}\n\\mathbf{\\hat{i}}  \\mathbf{\\hat{j}}  \\mathbf{\\hat{k}} \\\\\n\\frac{\\partial}{\\partial x}  \\frac{\\partial}{\\partial y}  \\frac{\\partial}{\\partial z} \\\\\nF_x(x,y)  F_y(x,y)  0\n\\end{vmatrix}\n$$\n展开行列式，我们得到：\n$$\n\\nabla \\times \\mathbf{F} = \\left(\\frac{\\partial (0)}{\\partial y} - \\frac{\\partial F_y}{\\partial z}\\right)\\mathbf{\\hat{i}} - \\left(\\frac{\\partial (0)}{\\partial x} - \\frac{\\partial F_x}{\\partial z}\\right)\\mathbf{\\hat{j}} + \\left(\\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y}\\right)\\mathbf{\\hat{k}}\n$$\n由于 $F_x$ 和 $F_y$ 仅是 $x$ 和 $y$ 的函数，它们关于 $z$ 的偏导数为零。因此，旋度的 $\\mathbf{\\hat{i}}$ 和 $\\mathbf{\\hat{j}}$ 分量均为零。唯一不平凡的分量是平面外分量，即 $\\mathbf{\\hat{k}}$ 分量：\n$$ (\\nabla \\times \\mathbf{F})_z = \\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y} $$\n\n我们已知力场的分量：\n$$ F_x(x,y) = -k\\,x \\,-\\,\\lambda\\,y\\,+\\,\\alpha\\,x\\,y^{2} $$\n$$ F_y(x,y) = -k\\,y \\,-\\,\\lambda\\,x\\,+\\,\\beta\\,x^{2}\\,y $$\n\n首先，我们计算 $F_y$ 关于 $x$ 的偏导数：\n$$\n\\frac{\\partial F_y}{\\partial x} = \\frac{\\partial}{\\partial x} \\left(-k\\,y \\,-\\,\\lambda\\,x\\,+\\,\\beta\\,x^{2}\\,y\\right) = 0 - \\lambda + 2\\,\\beta\\,x\\,y = -\\lambda + 2\\,\\beta\\,x\\,y\n$$\n接着，我们计算 $F_x$ 关于 $y$ 的偏导数：\n$$\n\\frac{\\partial F_x}{\\partial y} = \\frac{\\partial}{\\partial y} \\left(-k\\,x \\,-\\,\\lambda\\,y\\,+\\,\\alpha\\,x\\,y^{2}\\right) = 0 - \\lambda + 2\\,\\alpha\\,x\\,y = -\\lambda + 2\\,\\alpha\\,x\\,y\n$$\n\n现在，我们将这些表达式代入旋度的平面外分量公式中：\n$$\n(\\nabla \\times \\mathbf{F})_z = \\left(-\\lambda + 2\\,\\beta\\,x\\,y\\right) - \\left(-\\lambda + 2\\,\\alpha\\,x\\,y\\right)\n$$\n$$\n(\\nabla \\times \\mathbf{F})_z = -\\lambda + 2\\,\\beta\\,x\\,y + \\lambda - 2\\,\\alpha\\,x\\,y\n$$\n$$\n(\\nabla \\times \\mathbf{F})_z = 2\\,\\beta\\,x\\,y - 2\\,\\alpha\\,x\\,y = 2\\,x\\,y\\,(\\beta - \\alpha)\n$$\n这就是旋度平面外分量的解析表达式。\n\n对于解释部分，我们考虑力场为保守场的条件。如果一个力场 $\\mathbf{F}$ 可以表示为标量势 $U$ 的负梯度，即 $\\mathbf{F} = -\\nabla U$，则该力场是保守的。在单连通域上，这个条件等价于力场是无旋的，即其旋度为零：$\\nabla \\times \\mathbf{F} = \\mathbf{0}$。\n\n这可以从第一性原理出发，利用混合偏导数的相等性（克莱罗定理）来证明。如果存在一个光滑的单值势 $U(x,y)$，那么它的二阶混合偏导数必须相等：\n$$ \\frac{\\partial^2 U}{\\partial y \\partial x} = \\frac{\\partial^2 U}{\\partial x \\partial y} $$\n根据势与力的关系，我们有 $F_x = -\\frac{\\partial U}{\\partial x}$ 和 $F_y = -\\frac{\\partial U}{\\partial y}$。进一步求导：\n$$ \\frac{\\partial F_x}{\\partial y} = \\frac{\\partial}{\\partial y} \\left(-\\frac{\\partial U}{\\partial x}\\right) = -\\frac{\\partial^2 U}{\\partial y \\partial x} $$\n$$ \\frac{\\partial F_y}{\\partial x} = \\frac{\\partial}{\\partial x} \\left(-\\frac{\\partial U}{\\partial y}\\right) = -\\frac{\\partial^2 U}{\\partial x \\partial y} $$\n因此，混合偏导数的相等性意味着 $\\frac{\\partial F_x}{\\partial y} = \\frac{\\partial F_y}{\\partial x}$，这可以重排为 $\\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y} = 0$。这恰好是旋度的平面外分量为零的条件。\n\n因此，$(\\nabla \\times \\mathbf{F})_z$ 的非零值直接证明了与单值标量势 $U(x,y)$ 的存在性不一致。如果 $(\\nabla \\times \\mathbf{F})_z = 2\\,x\\,y\\,(\\beta - \\alpha) \\neq 0$，这意味着机器学习模型产生了一个非保守的（或称有旋的）力场。这样的力场在描述平衡动力学方面是不符合物理现实的，因为力对沿闭合路径运动的粒子所做的功不为零，这违反了能量守恒原理。当 $\\beta \\neq \\alpha$ 时，就会出现这种不一致性，在这种情况下，除了在坐标轴 $x=0$ 或 $y=0$ 上，旋度处处非零。",
            "answer": "$$\n\\boxed{2\\,x\\,y\\,(\\beta - \\alpha)}\n$$"
        }
    ]
}