{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp objective time derivatives, we must move from abstract definitions to concrete calculations. This first practice challenges you to compute the upper- and lower-convected derivatives for a symmetric tensor in a steady simple shear flow . This canonical flow is fundamental in rheology, and performing this calculation will clarify how the velocity gradient couples with tensor components to produce a frame-indifferent rate of change.",
            "id": "4097761",
            "problem": "Consider a three-dimensional incompressible continuum undergoing a steady simple shear flow with velocity field $\\mathbf{v}(\\mathbf{x}) = (\\gamma x_2, 0, 0)$, where $\\gamma$ is a constant shear rate. The spatial velocity gradient tensor is\n$$L = \\nabla \\mathbf{v} = \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\nLet $A(t)$ be a general symmetric, spatially homogeneous (no spatial gradients) second-order tensor field carried with the material, with Cartesian components\n$$A(t) = \\begin{pmatrix} a_{11}(t) & a_{12}(t) & a_{13}(t) \\\\ a_{12}(t) & a_{22}(t) & a_{23}(t) \\\\ a_{13}(t) & a_{23}(t) & a_{33}(t) \\end{pmatrix}$$\n\nStarting from the definition of the material time derivative for tensor fields, the kinematics of material line elements, and the requirement of frame-indifference (objectivity) under superposed rigid-body motions, derive the forms of the upper-convected and lower-convected objective time derivatives of $A(t)$ for this flow. Then, evaluate these derivatives component-wise in terms of $\\dot{a}_{ij}(t)$, $a_{ij}(t)$, and $\\gamma$. Explicitly compute $\\stackrel{\\nabla}{A}$ and $\\stackrel{\\triangle}{A}$ and identify which components are directly affected by the shear rate $\\gamma$ through coupling with specific components of $A$.\n\nProvide your final answer as a pair of analytical $3 \\times 3$ matrix expressions for $\\stackrel{\\nabla}{A}$ and $\\stackrel{\\triangle}{A}$, respectively, placed side-by-side as a single row matrix. No units are required. No rounding is required.",
            "solution": "The problem requires the derivation and evaluation of the upper-convected and lower-convected time derivatives of a symmetric, spatially homogeneous second-order tensor field $A(t)$ in a steady simple shear flow. The solution is constructed from fundamental principles of continuum mechanics.\n\nFirst, we establish the definitions of the objective time derivatives. An objective time derivative is a rate of change of a tensor field that is independent of any superposed rigid-body motion of the observer's reference frame. The material time derivative, $D/Dt$, is not objective by itself.\n\nThe material time derivative of a tensor field $A(\\mathbf{x}, t)$ is defined as:\n$$ \\frac{DA}{Dt} = \\frac{\\partial A}{\\partial t} + (\\mathbf{v} \\cdot \\nabla)A $$\nIn this problem, the tensor field $A(t)$ is given as spatially homogeneous, meaning it does not depend on the spatial coordinates $\\mathbf{x}$. Therefore, its spatial gradient is zero: $\\nabla A = 0$. The material derivative simplifies to the partial time derivative:\n$$ \\frac{DA}{Dt} = \\frac{\\partial A}{\\partial t} = \\dot{A}(t) $$\nThe components of $\\dot{A}(t)$ are simply the time derivatives of the components of $A(t)$, i.e., $\\dot{a}_{ij}(t)$.\n\nThe upper- and lower-convected derivatives can be derived by considering how geometric quantities associated with the continuum deform. The upper-convected derivative arises from considering a contravariant tensor, which transforms like the product of two material line elements. The lower-convected derivative is associated with a covariant tensor, which transforms like the product of two material surface normals.\n\nLet $d\\mathbf{x}$ be a material line element vector connecting two neighboring particles. Its evolution in time is governed by the velocity gradient $L$:\n$$ \\frac{d}{dt}(d\\mathbf{x}) = L \\cdot d\\mathbf{x} $$\nLet $d\\mathbf{a}$ be a material surface element vector. Its evolution is governed by:\n$$ \\frac{d}{dt}(d\\mathbf{a}) = -L^T \\cdot d\\mathbf{a} $$\nThe upper-convected derivative of a tensor $A$, denoted $\\stackrel{\\nabla}{A}$, is defined such that the scalar quantity $d\\mathbf{a} \\cdot A \\cdot d\\mathbf{a}$ is constant in time if $\\stackrel{\\nabla}{A} = 0$. By applying the product rule:\n$$ \\frac{d}{dt}(d\\mathbf{a} \\cdot A \\cdot d\\mathbf{a}) = \\frac{d(d\\mathbf{a})}{dt} \\cdot A \\cdot d\\mathbf{a} + d\\mathbf{a} \\cdot \\frac{dA}{dt} \\cdot d\\mathbf{a} + d\\mathbf{a} \\cdot A \\cdot \\frac{d(d\\mathbf{a})}{dt} = 0 $$\nSubstituting the evolution equations for $d\\mathbf{a}$ and $dA/dt = \\dot{A}$:\n$$ (-L^T \\cdot d\\mathbf{a}) \\cdot A \\cdot d\\mathbf{a} + d\\mathbf{a} \\cdot \\dot{A} \\cdot d\\mathbf{a} + d\\mathbf{a} \\cdot A \\cdot (-L^T \\cdot d\\mathbf{a}) = 0 $$\nUsing the property $(M \\cdot \\mathbf{u}) \\cdot \\mathbf{v}=\\mathbf{u} \\cdot (M^T \\cdot \\mathbf{v})$, the first term becomes $d\\mathbf{a} \\cdot (-L \\cdot A) \\cdot d\\mathbf{a}$ and the third term becomes $d\\mathbf{a} \\cdot (-A \\cdot L^T) \\cdot d\\mathbf{a}$. Factoring out $d\\mathbf{a}$:\n$$ d\\mathbf{a} \\cdot (\\dot{A} - L \\cdot A - A \\cdot L^T) \\cdot d\\mathbf{a} = 0 $$\nSince this must hold for any arbitrary surface element $d\\mathbf{a}$, the expression in the parenthesis must be the zero tensor. This defines the upper-convected derivative:\n$$ \\stackrel{\\nabla}{A} = \\dot{A} - L \\cdot A - A \\cdot L^T $$\nSimilarly, the lower-convected derivative of a tensor $A$, denoted $\\stackrel{\\triangle}{A}$, is defined such that the scalar quantity $d\\mathbf{x} \\cdot A \\cdot d\\mathbf{x}$ is constant if $\\stackrel{\\triangle}{A} = 0$.\n$$ \\frac{d}{dt}(d\\mathbf{x} \\cdot A \\cdot d\\mathbf{x}) = \\frac{d(d\\mathbf{x})}{dt} \\cdot A \\cdot d\\mathbf{x} + d\\mathbf{x} \\cdot \\frac{dA}{dt} \\cdot d\\mathbf{x} + d\\mathbf{x} \\cdot A \\cdot \\frac{d(d\\mathbf{x})}{dt} = 0 $$\n$$ (L \\cdot d\\mathbf{x}) \\cdot A \\cdot d\\mathbf{x} + d\\mathbf{x} \\cdot \\dot{A} \\cdot d\\mathbf{x} + d\\mathbf{x} \\cdot A \\cdot (L \\cdot d\\mathbf{x}) = 0 $$\n$$ d\\mathbf{x} \\cdot (L^T \\cdot A + \\dot{A} + A \\cdot L) \\cdot d\\mathbf{x} = 0 $$\nThis must hold for any arbitrary line element $d\\mathbf{x}$, which defines the lower-convected derivative:\n$$ \\stackrel{\\triangle}{A} = \\dot{A} + L^T \\cdot A + A \\cdot L $$\nNow we evaluate these expressions for the given simple shear flow. The velocity field is $\\mathbf{v} = (\\gamma x_2, 0, 0)$, where $\\gamma$ is the constant shear rate.\nThe velocity gradient tensor $L$ and its transpose $L^T$ are:\n$$ L = \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}, \\quad L^T = \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nThe tensor $A(t)$ and its time derivative $\\dot{A}(t)$ are symmetric:\n$$ A = \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{12} & a_{22} & a_{23} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix}, \\quad \\dot{A} = \\begin{pmatrix} \\dot{a}_{11} & \\dot{a}_{12} & \\dot{a}_{13} \\\\ \\dot{a}_{12} & \\dot{a}_{22} & \\dot{a}_{23} \\\\ \\dot{a}_{13} & \\dot{a}_{23} & \\dot{a}_{33} \\end{pmatrix} $$\nwhere the argument $(t)$ is omitted for brevity.\n\nEvaluation of the upper-convected derivative $\\stackrel{\\nabla}{A}$:\nWe first compute the products $L \\cdot A$ and $A \\cdot L^T$.\n$$ L \\cdot A = \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{12} & a_{22} & a_{23} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix} = \\begin{pmatrix} \\gamma a_{12} & \\gamma a_{22} & \\gamma a_{23} \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n$$ A \\cdot L^T = \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{12} & a_{22} & a_{23} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix} \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} \\gamma a_{12} & 0 & 0 \\\\ \\gamma a_{22} & 0 & 0 \\\\ \\gamma a_{23} & 0 & 0 \\end{pmatrix} $$\nSumming these two terms:\n$$ L \\cdot A + A \\cdot L^T = \\begin{pmatrix} 2\\gamma a_{12} & \\gamma a_{22} & \\gamma a_{23} \\\\ \\gamma a_{22} & 0 & 0 \\\\ \\gamma a_{23} & 0 & 0 \\end{pmatrix} $$\nFinally, we subtract this from $\\dot{A}$:\n$$ \\stackrel{\\nabla}{A} = \\dot{A} - (L \\cdot A + A \\cdot L^T) = \\begin{pmatrix} \\dot{a}_{11} - 2\\gamma a_{12} & \\dot{a}_{12} - \\gamma a_{22} & \\dot{a}_{13} - \\gamma a_{23} \\\\ \\dot{a}_{12} - \\gamma a_{22} & \\dot{a}_{22} & \\dot{a}_{23} \\\\ \\dot{a}_{13} - \\gamma a_{23} & \\dot{a}_{23} & \\dot{a}_{33} \\end{pmatrix} $$\n\nEvaluation of the lower-convected derivative $\\stackrel{\\triangle}{A}$:\nWe compute the products $L^T \\cdot A$ and $A \\cdot L$.\n$$ L^T \\cdot A = \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{12} & a_{22} & a_{23} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma a_{11} & \\gamma a_{12} & \\gamma a_{13} \\\\ 0 & 0 & 0 \\end{pmatrix} $$\n$$ A \\cdot L = \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{12} & a_{22} & a_{23} \\\\ a_{13} & a_{23} & a_{33} \\end{pmatrix} \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\gamma a_{11} & 0 \\\\ 0 & \\gamma a_{12} & 0 \\\\ 0 & \\gamma a_{13} & 0 \\end{pmatrix} $$\nSumming these two terms:\n$$ L^T \\cdot A + A \\cdot L = \\begin{pmatrix} 0 & \\gamma a_{11} & 0 \\\\ \\gamma a_{11} & 2\\gamma a_{12} & \\gamma a_{13} \\\\ 0 & \\gamma a_{13} & 0 \\end{pmatrix} $$\nFinally, we add this to $\\dot{A}$:\n$$ \\stackrel{\\triangle}{A} = \\dot{A} + (L^T \\cdot A + A \\cdot L) = \\begin{pmatrix} \\dot{a}_{11} & \\dot{a}_{12} + \\gamma a_{11} & \\dot{a}_{13} \\\\ \\dot{a}_{12} + \\gamma a_{11} & \\dot{a}_{22} + 2\\gamma a_{12} & \\dot{a}_{23} + \\gamma a_{13} \\\\ \\dot{a}_{13} & \\dot{a}_{23} + \\gamma a_{13} & \\dot{a}_{33} \\end{pmatrix} $$\n\nFor the upper-convected derivative $\\stackrel{\\nabla}{A}$, the shear rate $\\gamma$ directly affects the components $(\\stackrel{\\nabla}{A})_{11}$, $(\\stackrel{\\nabla}{A})_{12}$ (and its symmetric counterpart $(\\stackrel{\\nabla}{A})_{21}$), and $(\\stackrel{\\nabla}{A})_{13}$ (and $(\\stackrel{\\nabla}{A})_{31}$). Specifically, the shear flow couples the shear component $a_{12}$ to the normal component $(\\stackrel{\\nabla}{A})_{11}$, the normal component $a_{22}$ to the shear component $(\\stackrel{\\nabla}{A})_{12}$, and the component $a_{23}$ to the shear component $(\\stackrel{\\nabla}{A})_{13}$.\n\nFor the lower-convected derivative $\\stackrel{\\triangle}{A}$, the shear rate $\\gamma$ directly affects the components $(\\stackrel{\\triangle}{A})_{12}$ (and $(\\stackrel{\\triangle}{A})_{21}$), $(\\stackrel{\\triangle}{A})_{22}$, and $(\\stackrel{\\triangle}{A})_{23}$ (and $(\\stackrel{\\triangle}{A})_{32}$). Specifically, the flow couples the normal component $a_{11}$ to the shear component $(\\stackrel{\\triangle}{A})_{12}$, the shear component $a_{12}$ to the normal component $(\\stackrel{\\triangle}{A})_{22}$, and the component $a_{13}$ to the shear component $(\\stackrel{\\triangle}{A})_{23}$.\n\nThe final expressions for the two objective derivatives are the matrices derived above.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} \\dot{a}_{11} - 2\\gamma a_{12} & \\dot{a}_{12} - \\gamma a_{22} & \\dot{a}_{13} - \\gamma a_{23} \\\\ \\dot{a}_{12} - \\gamma a_{22} & \\dot{a}_{22} & \\dot{a}_{23} \\\\ \\dot{a}_{13} - \\gamma a_{23} & \\dot{a}_{23} & \\dot{a}_{33} \\end{pmatrix}\n&\n\\begin{pmatrix} \\dot{a}_{11} & \\dot{a}_{12} + \\gamma a_{11} & \\dot{a}_{13} \\\\ \\dot{a}_{12} + \\gamma a_{11} & \\dot{a}_{22} + 2\\gamma a_{12} & \\dot{a}_{23} + \\gamma a_{13} \\\\ \\dot{a}_{13} & \\dot{a}_{23} + \\gamma a_{13} & \\dot{a}_{33} \\end{pmatrix}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Now, let's test our conceptual understanding of objectivity with a special case: steady solid-body rotation . This flow involves pure rotation without any deformation. By analyzing how objective derivatives behave for a tensor that is co-rotating with the fluid, we can isolate the role of the spin correction terms and build a deeper intuition for why these derivatives are \"objective.\"",
            "id": "4097786",
            "problem": "Consider a three-dimensional incompressible flow in which a rigid body undergoes steady solid-body rotation with velocity field $\\mathbf{v}(\\mathbf{x}) = \\boldsymbol{\\omega} \\times \\mathbf{x}$, where the angular velocity vector $\\boldsymbol{\\omega}$ is a nonzero constant in time and space, and $\\mathbf{x}$ is the position vector. Begin from the definitions $L = \\nabla \\mathbf{v}$ for the velocity gradient and $D$ as the symmetric part of $L$. Using only these definitions and standard vector/calculus identities, compute $D$ for this flow. Next, let $R(t)$ denote the rotation tensor generated by $\\boldsymbol{\\omega}$, with $R(t)$ orthogonal and evolving such that $\\dot{R}(t)$ is determined by the instantaneous spin of the flow. Consider a spatially uniform contravariant second-order tensor field $A(t)$ and a spatially uniform covariant second-order tensor field $B(t)$ that rotate with the body according to $A(t) = R(t) A_{0} R(t)^T$ and $B(t) = R(t)^T B_{0} R(t)$, where $A_{0}$ and $B_{0}$ are constant second-order tensors independent of $\\mathbf{x}$ and $t$, and the superscript ${T}$ denotes matrix transpose. Starting from the definition of the material time derivative and fundamental invariance requirements under superposed rigid motions (objectivity), derive the forms of the upper-convected and lower-convected time derivatives suitable for, respectively, $A(t)$ (contravariant) and $B(t)$ (covariant). Evaluate these objective time derivatives for the given steady solid-body rotation and the specified $A(t)$ and $B(t)$. Provide your final answer as a single row matrix containing, in order, the upper-convected derivative of $A(t)$ and the lower-convected derivative of $B(t)$, simplified to a closed-form analytic expression. No rounding is required, and no units should be included in the final numerical or symbolic expression.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of continuum mechanics, specifically the kinematics of deformable bodies and the theory of objective tensor rates. It is well-posed, with all necessary information provided for a unique solution. The language is objective and precise.\n\nThe solution proceeds in three parts as requested: computation of the rate-of-deformation tensor $D$, derivation of the objective time derivatives, and evaluation of these derivatives for the specified tensors and flow.\n\nFirst, we compute the rate-of-deformation tensor $D$ for the given steady solid-body rotation. The velocity field is given by $\\mathbf{v}(\\mathbf{x}) = \\boldsymbol{\\omega} \\times \\mathbf{x}$, where $\\boldsymbol{\\omega}$ is a constant, non-zero vector and $\\mathbf{x}$ is the position vector. In Cartesian tensor notation, this is $v_i = \\epsilon_{ijk} \\omega_j x_k$, where $\\epsilon_{ijk}$ is the Levi-Civita symbol.\n\nThe velocity gradient tensor $L$ is defined as $L = \\nabla \\mathbf{v}$, with components $L_{ik} = \\frac{\\partial v_i}{\\partial x_k}$.\n$$L_{ik} = \\frac{\\partial}{\\partial x_k} (\\epsilon_{ijm} \\omega_j x_m)$$\nSince $\\boldsymbol{\\omega}$ is constant and the components of the position vector $x_m$ are independent variables, we have $\\frac{\\partial x_m}{\\partial x_k} = \\delta_{mk}$, where $\\delta_{mk}$ is the Kronecker delta.\n$$L_{ik} = \\epsilon_{ijm} \\omega_j \\delta_{mk} = \\epsilon_{ijk} \\omega_j$$\nThe tensor $L$ is the spin tensor, often denoted by $W$. A tensor is skew-symmetric if $L^T = -L$, or in components, $L_{ki} = -L_{ik}$. Let's check this property for our $L$:\n$$L_{ki} = \\epsilon_{kji} \\omega_j = -\\epsilon_{ikj} \\omega_j = -L_{ik}$$\nThus, $L$ is a purely skew-symmetric tensor. The rate-of-deformation tensor $D$ is the symmetric part of $L$, defined as $D = \\frac{1}{2}(L + L^T)$.\n$$D = \\frac{1}{2}(L + (-L)) = \\frac{1}{2}(L - L) = 0$$\nFor a steady solid-body rotation, the rate-of-deformation tensor is zero, which is physically expected as there is no stretching or change of angles within the rigidly rotating body. The velocity gradient is equal to the spin tensor, $L=W$.\n\nSecond, we address the forms of the upper-convected and lower-convected time derivatives. For a tensor field A(x, t), the material time derivative is $\\frac{DA}{Dt} = \\frac{\\partial A}{\\partial t} + \\mathbf{v} \\cdot \\nabla A$. Since the tensors $A(t)$ and $B(t)$ in this problem are specified as spatially uniform, their gradient is zero ($\\nabla A = 0$, $\\nabla B = 0$), so the material derivative simplifies to the partial time derivative, $\\frac{DA}{Dt} = \\frac{\\partial A}{\\partial t} = \\dot{A}$ and $\\frac{DB}{Dt} = \\dot{B}$.\n\nThe material derivative itself is not objective. Objective time derivatives are constructed by adding correction terms involving the velocity gradient $L$. The upper-convected derivative, suitable for contravariant tensors, is defined as:\n$$\\stackrel{\\nabla}{A} = \\frac{DA}{Dt} - L A - A L^T$$\nThe lower-convected derivative, suitable for covariant tensors, is defined as:\n$$\\stackrel{\\triangle}{B} = \\frac{DB}{Dt} + L^T B + B L$$\nThese forms can be derived by requiring that the derivative transforms objectively under a superposed rigid body motion (change of observer frame). For this problem's flow, we have $L=W$ and $L^T=-W$. The derivatives become:\n$$\\stackrel{\\nabla}{A} = \\dot{A} - W A + A W$$\n$$\\stackrel{\\triangle}{B} = \\dot{B} - W B + B W$$\n\nThird, we evaluate these derivatives for the given tensors.\nFor the solid-body rotation, the rotation tensor $R(t)$ that describes the orientation of the body evolves according to $\\dot{R}(t) = W R(t)$, where $W$ is the constant spin tensor. This has the solution $R(t)=\\exp(Wt)$, assuming $R(0)=I$. A key property is that $W$ commutes with $R(t)=\\exp(Wt)$ and its transpose $R(t)^T=\\exp(-Wt)$.\n\nWe evaluate the upper-convected derivative of $A(t) = R(t) A_{0} R(t)^T$.\nFirst, we find its time derivative $\\dot{A}$:\n$$\\dot{A} = \\frac{d}{dt}(R A_0 R^T) = \\dot{R} A_0 R^T + R A_0 \\dot{R}^T$$\nUsing $\\dot{R}=WR$ and $\\dot{R}^T = (WR)^T = R^T W^T = -R^T W$, we substitute:\n$$\\dot{A} = (WR) A_0 R^T + R A_0 (-R^T W) = W(R A_0 R^T) - (R A_0 R^T)W$$\nRecognizing $A = R A_0 R^T$, we get:\n$$\\dot{A} = WA - AW$$\nNow, we substitute this into the expression for the upper-convected derivative:\n$$\\stackrel{\\nabla}{A} = \\dot{A} - WA + AW = (WA - AW) - WA + AW = 0$$\nThe upper-convected derivative of $A(t)$ is the zero tensor.\n\nNext, we evaluate the lower-convected derivative of $B(t) = R(t)^T B_{0} R(t)$.\nFirst, we find its time derivative $\\dot{B}$:\n$$\\dot{B} = \\frac{d}{dt}(R^T B_0 R) = \\dot{R}^T B_0 R + R^T B_0 \\dot{R}$$\nSubstitute $\\dot{R}=WR$ and $\\dot{R}^T=-R^T W$:\n$$\\dot{B} = (-R^T W) B_0 R + R^T B_0 (WR) = -R^T W B_0 R + R^T B_0 W R$$\nNow, we substitute this into the expression for the lower-convected derivative, $\\stackrel{\\triangle}{B} = \\dot{B} - W B + B W$:\n$$\\stackrel{\\triangle}{B} = (-R^T W B_0 R + R^T B_0 W R) - W B + B W$$\nSubstitute $B=R^T B_0 R$:\n$$\\stackrel{\\triangle}{B} = -R^T W B_0 R + R^T B_0 W R - W(R^T B_0 R) + (R^T B_0 R)W$$\nUsing the commutation properties $WR^T=R^T W$ and $RW=WR$:\n$$\\stackrel{\\triangle}{B} = -R^T W B_0 R + R^T B_0 W R - R^T W B_0 R + R^T B_0 W R$$\nCombining terms, we find:\n$$\\stackrel{\\triangle}{B} = 2(R^T B_0 W R - R^T W B_0 R) = 2R^T (B_0 W - W B_0) R$$\nThis can be written using the commutator bracket $[B_0, W] = B_0 W - W B_0$:\n$$\\stackrel{\\triangle}{B} = 2 R(t)^T [B_0, W] R(t)$$\n\nThe final result is a row matrix containing the upper-convected derivative of $A(t)$ and the lower-convected derivative of $B(t)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 2 R(t)^T (B_0 W - W B_0) R(t)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The principles of continuum mechanics must ultimately be translated into robust numerical algorithms. This final practice bridges the gap between theory and computation by asking you to design a numerical test for objectivity . You will implement a time-marching scheme and verify whether it correctly preserves the transformation properties of a tensor under a superposed rotation, a critical validation step for any complex fluid simulation code.",
            "id": "4097745",
            "problem": "Consider a computational test of material frame-indifference (objectivity) for second-order tensor evolution in complex fluids. Start from the principle of objectivity: superposed rigid body motions must not alter the physical predictions. Let a proper orthogonal rotation be represented by a time-dependent matrix $Q(t)$ that satisfies $Q(t) Q^T(t) = I$ and has angular velocity $W(t) = \\dot{Q}(t) Q^T(t)$, where $W(t)$ is skew-symmetric. Under a superposed rotation $Q(t)$, a second-order tensor $A(t)$ transforms as $A'(t) = Q(t) A(t) Q^T(t)$. The velocity gradient $L(t)$ transforms as $L'(t) = Q(t) L(t) Q^T(t) + W(t)$.\n\nYour task is to design a discrete, first-order accurate time-marching scheme and a numerical test that verifies objectivity for two objective time derivatives used in complex fluids: the upper-convected derivative and the lower-convected derivative. Begin from the principle of objectivity and the transformation rules above, and derive discrete update equations consistent with these objective derivatives in the special case where the convected derivative is set to zero. Use these derived discrete updates to propagate $A(t)$ forward in time for a given constant velocity gradient $L$ and a time-dependent rigid rotation $Q(t)$. Independently propagate $A'(t)$ forward using the rotated inputs $L'(t)$ and compare against $Q(t) A(t) Q^T(t)$.\n\nImplement the following in a complete, runnable program:\n- Assume a rotation about the $z$-axis with angle $\\theta(t) = \\omega t$ so that $Q(t)$ is the standard rotation matrix about $z$ and $W$ is constant. Use the angle unit radians.\n- Use a first-order explicit Euler time-marching scheme over $N$ uniform steps of size $\\Delta t$ to propagate $A(t)$ and $A'(t)$.\n- For the upper-convected derivative case, use the discrete update that is consistent with setting the upper-convected derivative to zero. For the lower-convected derivative case, use the discrete update consistent with setting the lower-convected derivative to zero.\n- At the final time $T = N \\Delta t$, compute the Frobenius-norm error $e = \\lVert A'_{\\text{num}}(T) - Q(T) A_{\\text{num}}(T) Q^T(T) \\rVert_{F}$, and report the normalized error $e / \\max(\\lVert Q(T) A_{\\text{num}}(T) Q^T(T) \\rVert_{F}, \\varepsilon)$ with $\\varepsilon = 10^{-15}$ to avoid division by zero.\n- Express rates (entries of $L$ and $\\omega$) in $\\text{s}^{-1}$ and time in $\\text{s}$. The normalized error is dimensionless.\n\nTest suite:\n- Case 1 (happy path, upper-convected): $A(0) = I$, $$L = \\begin{pmatrix} 0 & \\dot{\\gamma} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$ with $\\dot{\\gamma} = 1.0\\,\\text{s}^{-1}$, $\\omega = 0.5\\,\\text{s}^{-1}$, $\\Delta t = 0.01\\,\\text{s}$, $N = 100$.\n- Case 2 (happy path, lower-convected): same $A(0)$, $L$, $\\omega$, $\\Delta t$, $N$ as Case 1, but using the lower-convected discrete update.\n- Case 3 (boundary, zero rotation): upper-convected with $A(0) = I$, $L$ as in Case 1, $\\omega = 0.0\\,\\text{s}^{-1}$, $\\Delta t = 0.01\\,\\text{s}$, $N = 100$.\n- Case 4 (edge, zero flow): upper-convected with $A(0) = \\operatorname{diag}(2,1,0.5)$, $L = 0$, $\\omega = 1.0\\,\\text{s}^{-1}$, $\\Delta t = 0.005\\,\\text{s}$, $N = 200$.\n- Case 5 (large step, truncation stress-test): upper-convected with $A(0) = I$, $L$ as in Case 1, $\\omega = 0.5\\,\\text{s}^{-1}$, $\\Delta t = 0.1\\,\\text{s}$, $N = 10$.\n\nYour program should produce a single line of output containing the normalized errors for the five cases as a comma-separated list enclosed in square brackets (e.g., $[e_1,e_2,e_3,e_4,e_5]$), where each $e_i$ is a floating-point number.",
            "solution": "The problem requires designing and implementing a numerical test to verify the material frame-indifference (objectivity) of discrete time-marching schemes for two common objective time derivatives: the upper-convected derivative and the lower-convected derivative.\n\n**1. Principle of Objectivity and Transformation Rules**\n\nThe principle of material frame-indifference, or objectivity, states that the constitutive equations describing a material's behavior must be independent of the observer's frame of reference. Specifically, the equations must be invariant under a superposed time-dependent rigid-body motion. Such a motion can be described by a proper orthogonal rotation matrix $Q(t)$ ($Q Q^T = I$, $\\det(Q) = 1$).\n\nAs given in the problem statement, under such a rotation, a second-order tensor $A$ (e.g., a stress or conformation tensor) in the original frame transforms to $A'$ in the rotated frame according to:\n$$ A'(t) = Q(t) A(t) Q^T(t) $$\nThe velocity gradient tensor $L$ transforms as:\n$$ L'(t) = Q(t) L(t) Q^T(t) + W(t) $$\nwhere $W(t) = \\dot{Q}(t) Q^T(t)$ is the skew-symmetric angular velocity tensor of the superposed rotation. The dot denotes a time derivative, $\\dot{Q}(t) = dQ/dt$.\n\n**2. Objective Time Derivatives and Evolution Equations**\n\nAn objective time derivative of a tensor is a derivative that transforms covariantly with the tensor itself. That is, if $\\stackrel{\\nabla}{A}$ is an objective derivative of $A$, then its transformation must follow $(\\stackrel{\\nabla}{A})' = Q (\\stackrel{\\nabla}{A}) Q^T$.\n\nThe problem specifies two such derivatives:\n- **Upper-Convected Derivative (UCD)**: For a spatially homogeneous flow, the UCD of a tensor $A$ is defined as:\n  $$ \\stackrel{\\nabla}{A}_{UCD} = \\frac{dA}{dt} - L A - A L^T $$\n- **Lower-Convected Derivative (LCD)**: Similarly, the LCD is defined as:\n  $$ \\stackrel{\\triangle}{A}_{LCD} = \\frac{dA}{dt} + A L + L^T A $$\n\nThe task is to derive discrete updates for the special case where the objective derivative is set to zero. This is a common scenario in models like the Oldroyd-B model, where the objective rate of the elastic stress is balanced by other terms which we are effectively setting to zero for this test.\n\nSetting $\\stackrel{\\nabla}{A}_{UCD} = 0$ gives the evolution equation:\n$$ \\frac{dA}{dt} = L A + A L^T \\quad (\\text{for UCD}) $$\nSetting $\\stackrel{\\triangle}{A}_{LCD} = 0$ gives the evolution equation:\n$$ \\frac{dA}{dt} = -A L - L^T A \\quad (\\text{for LCD}) $$\n\n**3. Discretization: First-Order Explicit Euler Scheme**\n\nWe are instructed to use a first-order explicit Euler time-marching scheme. Applying this to the evolution equations above yields the discrete update rules. For a time step $\\Delta t$, we approximate $dA/dt \\approx (A(t+\\Delta t) - A(t)) / \\Delta t$.\n\n- **UCD Discrete Update**:\n  $$ \\frac{A(t+\\Delta t) - A(t)}{\\Delta t} \\approx L(t) A(t) + A(t) L^T(t) $$\n  $$ A(t+\\Delta t) = A(t) + \\Delta t (L(t) A(t) + A(t) L^T(t)) $$\n\n- **LCD Discrete Update**:\n  $$ \\frac{A(t+\\Delta t) - A(t)}{\\Delta t} \\approx -A(t) L(t) - L^T(t) A(t) $$\n  $$ A(t+\\Delta t) = A(t) - \\Delta t (A(t) L(t) + L^T(t) A(t)) $$\n\nThese explicit, first-order update rules will be used to propagate the tensor $A$ forward in time.\n\n**4. The Numerical Objectivity Test**\n\nThe test involves two parallel simulations over a time interval from $t=0$ to $T=N\\Delta t$:\n\n1.  **Unrotated (Lab) Frame Simulation**: We start with an initial tensor $A(0)$ and a constant velocity gradient $L$. We integrate forward in time using the appropriate discrete update rule (UCD or LCD) to find the numerical approximation $A_{\\text{num}}(T)$.\n    $$ A_{\\text{num}}(t_{n+1}) = \\text{update}(A_{\\text{num}}(t_n), L) $$\n\n2.  **Rotated Frame Simulation**: We start with the same initial tensor, $A'(0) = Q(0)A(0)Q^T(0) = A(0)$ since $Q(0)=I$. For each time step, we must use the transformed velocity gradient $L'(t_n) = Q(t_n) L Q^T(t_n) + W$. We then integrate forward using the same discrete update rule but with the transformed inputs to find $A'_{\\text{num}}(T)$.\n    $$ A'_{\\text{num}}(t_{n+1}) = \\text{update}(A'_{\\text{num}}(t_n), L'(t_n)) $$\n\nThe problem specifies a constant rotation rate $\\omega$ about the $z$-axis, so $\\theta(t) = \\omega t$.\n$$ Q(t) = \\begin{pmatrix} \\cos(\\omega t) & -\\sin(\\omega t) & 0 \\\\ \\sin(\\omega t) & \\cos(\\omega t) & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad W(t) = \\dot{Q}Q^T = \\begin{pmatrix} 0 & -\\omega & 0 \\\\ \\omega & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} $$\nNote that $W$ is constant for this specific rotation.\n\n**5. Error Evaluation**\n\nIf the numerical scheme were perfectly objective, the result from the rotated simulation, $A'_{\\text{num}}(T)$, would be exactly equal to the rotated result from the lab frame simulation, $Q(T) A_{\\text{num}}(T) Q^T(T)$. Since the explicit Euler scheme is not perfectly objective (it is only first-order accurate), there will be a discrepancy. This discrepancy is the numerical error due to the scheme's lack of perfect objectivity.\n\nWe compute this error at the final time $T$ using the Frobenius norm:\n$$ A'_{\\text{target}}(T) = Q(T) A_{\\text{num}}(T) Q^T(T) $$\n$$ e = \\lVert A'_{\\text{num}}(T) - A'_{\\text{target}}(T) \\rVert_F $$\nThe normalized error is then calculated as:\n$$ e_{\\text{norm}} = \\frac{e}{\\max(\\lVert A'_{\\text{target}}(T) \\rVert_F, \\varepsilon)} $$\nwhere $\\varepsilon = 10^{-15}$ is a small number to prevent division by zero. The expected error for this first-order scheme should be proportional to $\\Delta t$. The numerical implementation will execute this procedure for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the objectivity test problem for UCD and LCD schemes.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (happy path, upper-convected)\n        {'type': 'upper', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.5, 'dt': 0.01, 'N': 100, 'A0_diag': None},\n        # Case 2 (happy path, lower-convected)\n        {'type': 'lower', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.5, 'dt': 0.01, 'N': 100, 'A0_diag': None},\n        # Case 3 (boundary, zero rotation)\n        {'type': 'upper', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.0, 'dt': 0.01, 'N': 100, 'A0_diag': None},\n        # Case 4 (edge, zero flow)\n        {'type': 'upper', 'A0': None, 'L_val': 0.0, 'omega': 1.0, 'dt': 0.005, 'N': 200, 'A0_diag': [2.0, 1.0, 0.5]},\n        # Case 5 (large step, truncation stress-test)\n        {'type': 'upper', 'A0': np.identity(3), 'L_val': 1.0, 'omega': 0.5, 'dt': 0.1, 'N': 10}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        error = run_case(case)\n        results.append(f\"{error:.15e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_case(params):\n    \"\"\"\n    Runs a single objectivity test case.\n    \"\"\"\n    derivative_type = params['type']\n    omega = params['omega']\n    dt = params['dt']\n    N = params['N']\n    L_val = params.get('L_val', 0.0)\n    eps = 1e-15\n\n    # Initialize A0\n    if params.get('A0_diag') is not None:\n        A0 = np.diag(params['A0_diag'])\n    else:\n        A0 = params['A0']\n\n    # Initialize matrices\n    A_num = A0.copy()\n    A_prime_num = A0.copy()  # A'(0) = Q(0)A(0)Q(0)^T = A(0) since Q(0) = I\n\n    # Define constant tensors\n    L = np.array([[0.0, L_val, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n    L_T = L.T\n    W = omega * np.array([[0.0, -1.0, 0.0], [1.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n\n    # Time-marching loop\n    for n in range(N):\n        t_n = n * dt\n        \n        # Calculate rotated quantities at time t_n\n        c, s = np.cos(omega * t_n), np.sin(omega * t_n)\n        Q_n = np.array([[c, -s, 0.0], [s, c, 0.0], [0.0, 0.0, 1.0]])\n        \n        L_prime_n = Q_n @ L @ Q_n.T + W\n        L_prime_n_T = L_prime_n.T\n\n        # Update A_num (unrotated frame)\n        if derivative_type == 'upper':\n            A_num += dt * (L @ A_num + A_num @ L_T)\n        else: # lower-convected\n            A_num -= dt * (A_num @ L + L_T @ A_num)\n\n        # Update A_prime_num (rotated frame)\n        if derivative_type == 'upper':\n            A_prime_num += dt * (L_prime_n @ A_prime_num + A_prime_num @ L_prime_n_T)\n        else: # lower-convected\n            A_prime_num -= dt * (A_prime_num @ L_prime_n + L_prime_n_T @ A_prime_num)\n\n    # Final calculations after loop\n    T = N * dt\n    \n    # Final rotation matrix Q(T)\n    c, s = np.cos(omega * T), np.sin(omega * T)\n    Q_T = np.array([[c, -s, 0.0], [s, c, 0.0], [0.0, 0.0, 1.0]])\n\n    # Target transformed tensor\n    A_prime_target = Q_T @ A_num @ Q_T.T\n\n    # Error calculation\n    error_norm = np.linalg.norm(A_prime_num - A_prime_target, 'fro')\n    target_norm = np.linalg.norm(A_prime_target, 'fro')\n    \n    normalized_error = error_norm / max(target_norm, eps)\n    \n    return normalized_error\n\nsolve()\n```"
        }
    ]
}