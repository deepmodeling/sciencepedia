{
    "hands_on_practices": [
        {
            "introduction": "计算聚合物的平均尺寸是聚合物物理学中的一项基本任务。自由连接链（FJC）模型作为最简单的理想链模型，为此提供了理想的起点。通过从第一性原理出发，推导均方端到端距离（$\\langle R^2 \\rangle$）和均方回转半径（$\\langle R_g^2 \\rangle$），你将掌握衡量聚合物尺寸的核心统计方法 。这个推导过程是理解高分子统计性质的基石。",
            "id": "4090276",
            "problem": "考虑一个二维（2D）理想聚合物，其模型为自由连接链（Freely-Jointed Chain, FJC），这意味着该聚合物由 $N$ 个统计独立的键矢量组成，每个键矢量长度固定为 $b$，并且其取向在单位圆上均匀分布。设珠子的位置为 $\\{\\mathbf{r}_k\\}_{k=0}^{N}$，其中 $\\mathbf{r}_0=\\mathbf{0}$ 且 $\\mathbf{r}_k=\\sum_{i=1}^{k}\\mathbf{t}_i$，$\\mathbf{t}_i$ 为键矢量。定义末端距矢量 $\\mathbf{R}=\\mathbf{r}_N-\\mathbf{r}_0=\\sum_{i=1}^{N}\\mathbf{t}_i$。回旋半径的平方定义为\n$$\nR_g^2=\\frac{1}{N+1}\\sum_{k=0}^{N}\\left|\\mathbf{r}_k-\\mathbf{r}_{\\mathrm{cm}}\\right|^2, \\quad \\text{with} \\quad \\mathbf{r}_{\\mathrm{cm}}=\\frac{1}{N+1}\\sum_{k=0}^{N}\\mathbf{r}_k.\n$$\n从这些定义以及 FJC 模型中键矢量的统计独立性和各向同性出发，推导系综平均 $\\langle R^2\\rangle$ 和 $\\langle R_g^2\\rangle$ 关于 $N$ 和 $b$ 的闭式表达式，不使用任何简化关系。然后，对于 $N=200$ 和 $b=1\\,\\mathrm{nm}$，计算这些表达式的值。以 $\\mathrm{nm}^2$ 为单位表示您的最终数值。以精确有理数形式给出结果，不要四舍五入。",
            "solution": "该问题是有效的。这是一个统计聚合物物理学中标准的、适定的问题，基于既定的科学原理。所有定义和参数均已提供且自洽。\n\n该问题要求推导二维自由连接链（FJC）的均方末端距 $\\langle R^2 \\rangle$ 和均方回旋半径 $\\langle R_g^2 \\rangle$ 的系综平均值，然后进行数值计算。\n\n首先，我们确定 FJC 的键矢量 $\\mathbf{t}_i$ 的统计特性。键的长度固定为 $b$，因此对所有 $i \\in \\{1,...,N\\}$ 都有 $|\\mathbf{t}_i| = b$。它们是统计独立的且各向同性取向的。这意味着它们的系综平均具有两个关键性质：\n1.  由于各向同性取向，任何单个键矢量的平均值为零：$\\langle \\mathbf{t}_i \\rangle = \\mathbf{0}$。\n2.  两个键矢量点积的平均值取决于它们是否是同一个矢量。\n    - 如果 $i=j$：$\\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = \\langle \\mathbf{t}_i \\cdot \\mathbf{t}_i \\rangle = \\langle |\\mathbf{t}_i|^2 \\rangle = \\langle b^2 \\rangle = b^2$。\n    - 如果 $i \\neq j$：这些矢量是统计独立的，所以它们乘积的平均值是它们平均值的乘积：$\\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = \\langle \\mathbf{t}_i \\rangle \\cdot \\langle \\mathbf{t}_j \\rangle = \\mathbf{0} \\cdot \\mathbf{0} = 0$。\n这些可以紧凑地写成使用克罗内克 δ (Kronecker delta)，$\\delta_{ij}$ 的形式：$\\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = b^2 \\delta_{ij}$。\n\n**1. 均方末端距 $\\langle R^2 \\rangle$ 的推导**\n\n末端距矢量 $\\mathbf{R}$ 定义为所有键矢量的总和：\n$$\n\\mathbf{R} = \\sum_{i=1}^{N} \\mathbf{t}_i\n$$\n均方末端距为 $R^2 = \\mathbf{R} \\cdot \\mathbf{R}$。代入 $\\mathbf{R}$ 的定义：\n$$\nR^2 = \\left(\\sum_{i=1}^{N} \\mathbf{t}_i\\right) \\cdot \\left(\\sum_{j=1}^{N} \\mathbf{t}_j\\right) = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\mathbf{t}_i \\cdot \\mathbf{t}_j\n$$\n为了求系综平均 $\\langle R^2 \\rangle$，我们对这个表达式取平均。由于期望算符的线性性质，我们可以将平均运算移到求和号内部：\n$$\n\\langle R^2 \\rangle = \\left\\langle \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\mathbf{t}_i \\cdot \\mathbf{t}_j \\right\\rangle = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle\n$$\n利用统计性质 $\\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = b^2 \\delta_{ij}$：\n$$\n\\langle R^2 \\rangle = \\sum_{i=1}^{N} \\sum_{j=1}^{N} b^2 \\delta_{ij}\n$$\n克罗内克 δ $\\delta_{ij}$ 仅在 $i=j$ 时非零（等于 $1$）。因此，双重求和简化为对角线项的单个求和：\n$$\n\\langle R^2 \\rangle = \\sum_{i=1}^{N} b^2 = N b^2\n$$\n\n**2. 均方回旋半径 $\\langle R_g^2 \\rangle$ 的推导**\n\n均方回旋半径定义为：\n$$\nR_g^2 = \\frac{1}{N+1} \\sum_{k=0}^{N} |\\mathbf{r}_k - \\mathbf{r}_{\\mathrm{cm}}|^2\n$$\n其中 $\\mathbf{r}_{\\mathrm{cm}} = \\frac{1}{N+1} \\sum_{j=0}^{N} \\mathbf{r}_j$。我们首先展开平方并简化表达式：\n$$\nR_g^2 = \\frac{1}{N+1} \\sum_{k=0}^{N} (\\mathbf{r}_k \\cdot \\mathbf{r}_k - 2\\mathbf{r}_k \\cdot \\mathbf{r}_{\\mathrm{cm}} + \\mathbf{r}_{\\mathrm{cm}} \\cdot \\mathbf{r}_{\\mathrm{cm}}) = \\frac{1}{N+1} \\left( \\sum_{k=0}^{N} \\mathbf{r}_k^2 - 2\\mathbf{r}_{\\mathrm{cm}} \\cdot \\sum_{k=0}^{N} \\mathbf{r}_k + \\sum_{k=0}^{N} \\mathbf{r}_{\\mathrm{cm}}^2 \\right)\n$$\n使用 $\\mathbf{r}_{\\mathrm{cm}}$ 的定义，我们有 $\\sum_{k=0}^{N} \\mathbf{r}_k = (N+1)\\mathbf{r}_{\\mathrm{cm}}$。最后一项是对 $N+1$ 个相同项的求和，所以 $\\sum_{k=0}^{N} \\mathbf{r}_{\\mathrm{cm}}^2 = (N+1)\\mathbf{r}_{\\mathrm{cm}}^2$。将这些代入：\n$$\nR_g^2 = \\frac{1}{N+1} \\left( \\sum_{k=0}^{N} \\mathbf{r}_k^2 - 2\\mathbf{r}_{\\mathrm{cm}} \\cdot (N+1)\\mathbf{r}_{\\mathrm{cm}} + (N+1)\\mathbf{r}_{\\mathrm{cm}}^2 \\right) = \\frac{1}{N+1} \\left( \\sum_{k=0}^{N} \\mathbf{r}_k^2 - (N+1)\\mathbf{r}_{\\mathrm{cm}}^2 \\right)\n$$\n这给出了一个方便的形式 $R_g^2 = \\frac{1}{N+1} \\sum_{k=0}^{N} \\mathbf{r}_k^2 - \\mathbf{r}_{\\mathrm{cm}}^2$。取系综平均，我们得到：\n$$\n\\langle R_g^2 \\rangle = \\frac{1}{N+1} \\sum_{k=0}^{N} \\langle \\mathbf{r}_k^2 \\rangle - \\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle\n$$\n我们分别计算这两项。\n\n第一项：$\\langle \\mathbf{r}_k^2 \\rangle$。位置矢量 $\\mathbf{r}_k = \\sum_{i=1}^{k} \\mathbf{t}_i$（其中 $\\mathbf{r}_0 = \\mathbf{0}$）。\n$$\n\\langle \\mathbf{r}_k^2 \\rangle = \\left\\langle \\left( \\sum_{i=1}^{k} \\mathbf{t}_i \\right) \\cdot \\left( \\sum_{j=1}^{k} \\mathbf{t}_j \\right) \\right\\rangle = \\sum_{i=1}^{k} \\sum_{j=1}^{k} \\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = \\sum_{i=1}^{k} \\sum_{j=1}^{k} b^2 \\delta_{ij} = \\sum_{i=1}^{k} b^2 = k b^2\n$$\n现在我们计算关于 $k$ 的和：\n$$\n\\frac{1}{N+1} \\sum_{k=0}^{N} \\langle \\mathbf{r}_k^2 \\rangle = \\frac{1}{N+1} \\sum_{k=0}^{N} k b^2 = \\frac{b^2}{N+1} \\left( \\sum_{k=1}^{N} k \\right) = \\frac{b^2}{N+1} \\frac{N(N+1)}{2} = \\frac{N b^2}{2}\n$$\n\n第二项：$\\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle$。首先，我们用键矢量 $\\mathbf{t}_i$ 表示 $\\mathbf{r}_{\\mathrm{cm}}$：\n$$\n\\mathbf{r}_{\\mathrm{cm}} = \\frac{1}{N+1} \\sum_{k=0}^{N} \\mathbf{r}_k = \\frac{1}{N+1} \\sum_{k=0}^{N} \\sum_{i=1}^{k} \\mathbf{t}_i\n$$\n我们改变求和的顺序。一个矢量 $\\mathbf{t}_i$ 出现在 $k \\ge i$ 的 $\\mathbf{r}_k$ 的求和中。因此，对于一个固定的 $i$，关于 $k$ 的求和从 $i$ 到 $N$：\n$$\n\\sum_{k=0}^{N} \\sum_{i=1}^{k} \\mathbf{t}_i = \\sum_{i=1}^{N} \\sum_{k=i}^{N} \\mathbf{t}_i = \\sum_{i=1}^{N} (N-i+1) \\mathbf{t}_i\n$$\n所以，$\\mathbf{r}_{\\mathrm{cm}} = \\frac{1}{N+1} \\sum_{i=1}^{N} (N-i+1) \\mathbf{t}_i$。现在我们计算其均方值：\n$$\n\\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle = \\left\\langle \\left( \\frac{1}{N+1} \\sum_{i=1}^{N} (N-i+1) \\mathbf{t}_i \\right) \\cdot \\left( \\frac{1}{N+1} \\sum_{j=1}^{N} (N-j+1) \\mathbf{t}_j \\right) \\right\\rangle\n$$\n$$\n\\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle = \\frac{1}{(N+1)^2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} (N-i+1)(N-j+1) \\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle\n$$\n利用 $\\langle \\mathbf{t}_i \\cdot \\mathbf{t}_j \\rangle = b^2 \\delta_{ij}$：\n$$\n\\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle = \\frac{b^2}{(N+1)^2} \\sum_{i=1}^{N} (N-i+1)^2\n$$\n我们来计算这个和。令 $m = N-i+1$。当 $i$ 从 $1$ 变为 $N$ 时，$m$ 从 $N$ 变为 $1$。\n$$\n\\sum_{i=1}^{N} (N-i+1)^2 = \\sum_{m=1}^{N} m^2 = \\frac{N(N+1)(2N+1)}{6}\n$$\n将其代回：\n$$\n\\langle \\mathbf{r}_{\\mathrm{cm}}^2 \\rangle = \\frac{b^2}{(N+1)^2} \\frac{N(N+1)(2N+1)}{6} = \\frac{N(2N+1)}{6(N+1)} b^2\n$$\n最后，我们合并这两项得到 $\\langle R_g^2 \\rangle$：\n$$\n\\langle R_g^2 \\rangle = \\frac{N b^2}{2} - \\frac{N(2N+1)}{6(N+1)} b^2 = N b^2 \\left( \\frac{1}{2} - \\frac{2N+1}{6(N+1)} \\right)\n$$\n$$\n\\langle R_g^2 \\rangle = N b^2 \\left( \\frac{3(N+1) - (2N+1)}{6(N+1)} \\right) = N b^2 \\left( \\frac{3N+3-2N-1}{6(N+1)} \\right) = N b^2 \\left( \\frac{N+2}{6(N+1)} \\right)\n$$\n所以，最终的表达式是：\n$$\n\\langle R_g^2 \\rangle = \\frac{N(N+2)}{6(N+1)} b^2\n$$\n\n**3. 数值计算**\n\n给定 $N=200$ 和 $b=1\\,\\mathrm{nm}$。我们计算推导出的表达式，最终值的单位为 $\\mathrm{nm}^2$。\n\n对于均方末端距：\n$$\n\\langle R^2 \\rangle = N b^2 = 200 \\times (1)^2 = 200\n$$\n\n对于均方回旋半径：\n$$\n\\langle R_g^2 \\rangle = \\frac{N(N+2)}{6(N+1)} b^2 = \\frac{200(200+2)}{6(200+1)} (1)^2 = \\frac{200 \\times 202}{6 \\times 201}\n$$\n我们化简这个有理数：\n$$\n\\langle R_g^2 \\rangle = \\frac{40400}{1206} = \\frac{20200}{603}\n$$\n为了检查该分数是否可以进一步化简，我们求出分母的质因数分解：$603 = 3 \\times 201 = 3 \\times 3 \\times 67 = 3^2 \\times 67$。分子是 $20200 = 202 \\times 100 = 2 \\times 101 \\times 10^2$。由于 $20200$ 不能被 $3$ 整除（各位数字之和为 $4$），也不能被质数 $67$ 整除，所以该分数已是最简形式。\n\n最终的数值为 $\\langle R^2 \\rangle = 200\\,\\mathrm{nm}^2$ 和 $\\langle R_g^2 \\rangle = \\frac{20200}{603}\\,\\mathrm{nm}^2$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 200  \\frac{20200}{603} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了FJC模型后，探索具有局部约束的模型，如键角固定的自由旋转链（FRC），能加深我们对模型参数的物理理解。本练习  通过考察两种几何极限情况——完全伸直的刚性棒（$\\theta=0$）和规则折叠的链（$\\theta=\\pi$）——来训练你对于局部结构如何决定链的全局构象的物理直觉。理解这些极限行为有助于更好地把握键角相关性对聚合物统计性质的影响。",
            "id": "4090219",
            "problem": "考虑一个理想聚合物，其模型为自由旋转链：由 $N$ 个长度固定为 $b$ 的键组成，相邻键之间的键角 $\\theta$ 固定，每个键的扭转角独立且均匀分布。该链嵌入三维空间，且忽略排除体积和能量相互作用。设首末两端矢量为 $\\mathbf{R} = \\sum_{i=1}^{N} \\mathbf{b}_i$，其中 $\\mathbf{b}_i$ 是第 $i$ 个键矢量，并设均方首末两端距离为 $\\langle R^2 \\rangle$。\n\n从 $\\mathbf{R}$ 的定义和自由旋转模型所蕴含的统计结构（固定的 $b$ 和固定的 $\\theta$ 以及自由的扭转角）出发，根据第一性原理推导键矢量相关性，并得出在极限情况 $\\theta = 0$ 和 $\\theta = \\pi$ 下的精确结论。解释这些极限如何影响作为 $N$ 和 $b$ 的函数的 $\\langle R^2 \\rangle$，包括可能出现的对 $N$ 的奇偶性的任何依赖关系。选择唯一一个最准确地总结了两种极限情况下正确结论的选项。\n\nA. 当 $\\theta = 0$ 时，$\\langle R^2 \\rangle = (N b)^2$。当 $\\theta = \\pi$ 时，如果 $N$ 为偶数，则 $\\langle R^2 \\rangle = 0$；如果 $N$ 为奇数，则 $\\langle R^2 \\rangle = b^2$。\n\nB. 当 $\\theta = 0$ 时，$\\langle R^2 \\rangle = N b^2$。当 $\\theta = \\pi$ 时，对于所有 $N$，$\\langle R^2 \\rangle = N b^2$。\n\nC. 当 $\\theta = 0$ 时，对于任何有限的 $N$，$\\langle R^2 \\rangle$ 发散到无穷大。当 $\\theta = \\pi$ 时，对于所有 $N$，$\\langle R^2 \\rangle = 0$。\n\nD. 当 $\\theta = 0$ 时，$\\langle R^2 \\rangle$ 饱和于 $b^2$，与 $N$ 无关。当 $\\theta = \\pi$ 时，$\\langle R^2 \\rangle = (N b)^2$。",
            "solution": "问题要求分析自由旋转链模型在两种特定极限情况下的均方首末两端距离 $\\langle R^2 \\rangle$：键角 $\\theta = 0$ 和键角 $\\theta = \\pi$。我们将根据这些极限下链的几何结构，从第一性原理出发推导结果。\n\n一条由 $N$ 个键组成的链的首末两端矢量 $\\mathbf{R}$ 定义为各个键矢量 $\\mathbf{b}_i$ 的和：\n$$ \\mathbf{R} = \\sum_{i=1}^{N} \\mathbf{b}_i $$\n均方首末两端距离是该矢量模长平方的系综平均：\n$$ \\langle R^2 \\rangle = \\langle \\mathbf{R} \\cdot \\mathbf{R} \\rangle = \\left\\langle \\left( \\sum_{i=1}^{N} \\mathbf{b}_i \\right) \\cdot \\left( \\sum_{j=1}^{N} \\mathbf{b}_j \\right) \\right\\rangle = \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\langle \\mathbf{b}_i \\cdot \\mathbf{b}_j \\rangle $$\n每个键的长度固定为 $b$，因此对于所有的 $i$，都有 $|\\mathbf{b}_i| = b$，且 $\\mathbf{b}_i \\cdot \\mathbf{b}_i = b^2$。\n\n在指定的极限 $\\theta = 0$ 和 $\\theta = \\pi$ 下，键角被固定在一个使链在几何上呈刚性的值。关于键的扭转角与后续键的方向无关，因为旋转轴与键本身是共线的。因此，对于第一个键 $\\mathbf{b}_1$ 的给定取向，整条链的构象是唯一确定的。没有内部的统计涨落需要进行平均，因此 $\\langle R^2 \\rangle$ 的计算简化为计算这单个刚性构象的 $R^2$。$R^2$ 的结果是一个标量，并且与链在空间中的整体取向无关。\n\n**情况 1：键角 $\\theta = 0$**\n\n相邻键之间的键角为 $\\theta = 0$ 决定了每个键矢量都与前一个键矢量完全对齐。\n$$ \\mathbf{b}_{i+1} \\text{ 平行于 } \\mathbf{b}_i \\text{ 且 } |\\mathbf{b}_{i+1}| = |\\mathbf{b}_i| = b $$\n这意味着所有键矢量都是相同的：\n$$ \\mathbf{b}_i = \\mathbf{b}_1 \\quad \\text{对于所有 } i \\in \\{1, 2, \\dots, N\\} $$\n因此，该链是一根完全笔直的刚性杆。首末两端矢量是 $N$ 个相同矢量的和：\n$$ \\mathbf{R} = \\sum_{i=1}^{N} \\mathbf{b}_1 = N \\mathbf{b}_1 $$\n因此，首末两端距离的平方为：\n$$ R^2 = \\mathbf{R} \\cdot \\mathbf{R} = (N \\mathbf{b}_1) \\cdot (N \\mathbf{b}_1) = N^2 (\\mathbf{b}_1 \\cdot \\mathbf{b}_1) = N^2 b^2 $$\n由于链的构象是固定的，均方首末两端距离等于此值：\n$$ \\langle R^2 \\rangle = (Nb)^2 $$\n\n**情况 2：键角 $\\theta = \\pi$**\n\n键角为 $\\theta = \\pi$ 决定了每个相继的键都与前一个键完全反平行。\n$$ \\mathbf{b}_{i+1} = -\\mathbf{b}_i \\quad \\text{对于所有 } i \\in \\{1, 2, \\dots, N-1\\} $$\n这描述了一条在每一段都折返回自身的链。键矢量遵循以下模式：\n$\\mathbf{b}_2 = -\\mathbf{b}_1$\n$\\mathbf{b}_3 = -\\mathbf{b}_2 = -(-\\mathbf{b}_1) = \\mathbf{b}_1$\n$\\mathbf{b}_4 = -\\mathbf{b}_3 = -\\mathbf{b}_1$\n一般地，第 $i$ 个键矢量由下式给出：\n$$ \\mathbf{b}_i = (-1)^{i-1} \\mathbf{b}_1 $$\n首末两端矢量是以下总和：\n$$ \\mathbf{R} = \\sum_{i=1}^{N} \\mathbf{b}_i = \\sum_{i=1}^{N} (-1)^{i-1} \\mathbf{b}_1 = \\left( \\sum_{i=1}^{N} (-1)^{i-1} \\right) \\mathbf{b}_1 $$\n标量和的值取决于 $N$ 的奇偶性。\n\n*   **如果 $N$ 是偶数**（例如，$N=2, 4, 6, \\dots$）：该和是一个具有偶数项的交错级数。\n    $$ \\sum_{i=1}^{N} (-1)^{i-1} = 1 - 1 + 1 - 1 + \\dots + 1 - 1 = 0 $$\n    在这种情况下，首末两端矢量是零矢量，$\\mathbf{R} = \\mathbf{0}$。链的终点恰好在其起点处。均方首末两端距离为：\n    $$ \\langle R^2 \\rangle = 0 $$\n\n*   **如果 $N$ 是奇数**（例如，$N=1, 3, 5, \\dots$）：该和是一个具有奇数项的交错级数。\n    $$ \\sum_{i=1}^{N} (-1)^{i-1} = 1 - 1 + 1 - 1 + \\dots - 1 + 1 = 1 $$\n    在这种情况下，首末两端矢量等于第一个键矢量，$\\mathbf{R} = \\mathbf{b}_1$。链的末端相对于起点位移了一个键长。均方首末两端距离为：\n    $$ \\langle R^2 \\rangle = \\mathbf{b}_1 \\cdot \\mathbf{b}_1 = b^2 $$\n\n**结论总结：**\n1.  当 $\\theta = 0$ 时，链表现为一根刚性杆，且 $\\langle R^2 \\rangle = (N b)^2$。\n2.  当 $\\theta = \\pi$ 时，链完全折返回自身。结果取决于 $N$ 的奇偶性：\n    *   如果 $N$ 是偶数，则 $\\langle R^2 \\rangle = 0$。\n    *   如果 $N$ 是奇数，则 $\\langle R^2 \\rangle = b^2$。\n\n**选项评估：**\n\n*   **A. 当 $\\theta = 0$ 时，$\\langle R^2 \\rangle = (N b)^2$。当 $\\theta = \\pi$ 时，如果 $N$ 为偶数，则 $\\langle R^2 \\rangle = 0$；如果 $N$ 为奇数，则 $\\langle R^2 \\rangle = b^2$。**\n    该陈述与从第一性原理推导出的两种极限情况的结果完全吻合，包括在 $\\theta = \\pi$ 情况下对 $N$ 的奇偶性的关键依赖性。\n    **结论：正确**\n\n*   **B. 当 $\\theta = 0$ 时，$\\langle R^2 \\rangle = N b^2$。当 $\\theta = \\pi$ 时，对于所有 $N$，$\\langle R^2 \\rangle = N b^2$。**\n    这个陈述在两种情况下都是不正确的。对于 $\\theta = 0$，$\\langle R^2 \\rangle$ 应该是 $(Nb)^2$，而不是 $Nb^2$。值 $Nb^2$ 是自由连接链的结果，这是一个不同的模型，其中所有键-键相关性平均为零。对于 $\\theta = \\pi$，结果不是 $Nb^2$，而是 $0$ 或 $b^2$。\n    **结论：不正确**\n\n*   **C. 当 $\\theta = 0$ 时，对于任何有限的 $N$，$\\langle R^2 \\rangle$ 发散到无穷大。当 $\\theta = \\pi$ 时，对于所有 $N$，$\\langle R^2 \\rangle = 0$。**\n    这个陈述是不正确的。对于有限数量的键 $N$，$\\langle R^2 \\rangle = (Nb)^2$ 是一个有限值，不是发散的。关于 $\\theta = \\pi$ 的说法也是不正确的，因为它没有考虑到当 $N$ 是奇数时非零结果（$\\langle R^2 \\rangle=b^2$）的情况。\n    **结论：不正确**\n\n*   **D. 当 $\\theta = 0$ 时，$\\langle R^2 \\rangle$ 饱和于 $b^2$，与 $N$ 无关。当 $\\theta = \\pi$ 时，$\\langle R^2 \\rangle = (N b)^2$。**\n    这个陈述的两部分都是不正确的。对于 $\\theta = 0$，$\\langle R^2 \\rangle$ 随 $N$ 呈二次方增长，它不会饱和。对于 $\\theta = \\pi$，$\\langle R^2 \\rangle$ 是 $0$ 或 $b^2$，而不是 $(Nb)^2$。这个选项似乎混淆了不同极限或模型的结果。\n    **结论：不正确**\n\n唯一准确描述自由旋转链在两种指定极限下行为的选项是 A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "现在，我们从描述聚合物的静态尺寸转向其对外力的动态响应，即熵弹性。这个练习  的核心是著名的朗之万函数（Langevin function），它精确描述了自由连接链的力-伸长关系。你的任务是编写一个数值程序来反转该函数，以从测量的链伸长量估算作用力，这在分析单分子实验数据时是一个非常常见的实际问题，它将理论统计力学与实用的计算数据分析联系了起来。",
            "id": "4090284",
            "problem": "您正在计算复杂流体背景下研究聚合物弹性的理想自由连接链模型。考虑一个理想聚合物，它由 $N$ 个长度固定为 $b$ 的独立链段组成，在绝对温度 $T$ 下，沿 $z$ 轴受到一个恒定力 $f$ 的作用。该系统在正则系综中进行建模，其逆热能为 $\\beta = 1/(k_{\\mathrm{B}} T)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。沿拉伸轴的平衡平均端到端投影（记为 $\\langle z \\rangle$）通过一个涉及约化力 $x = \\beta f b$ 的单调函数的无量纲方程与 $f$ 相关联。您的任务是构建一个稳健的数值程序来反演该关系，并从观测到的 $\\langle z \\rangle$ 以及已知参数 $N$、$b$ 和 $T$ 来估算 $f$。\n\n要求：\n- 从正则系综的基本统计力学定义以及均匀外场下链段的取向分布出发，并使用理想自由连接链的成熟结果，包括朗之万函数 $\\mathcal{L}(x)$ 的定义，其中 $x = \\beta f b$ 且\n  $$\\mathcal{L}(x) = \\coth(x) - \\frac{1}{x}。$$\n- 使用由下式定义的约化伸长量\n  $$\\rho = \\frac{\\langle z \\rangle}{N b}，$$\n  并求解满足\n  $$\\mathcal{L}(x) = \\rho$$\n  的唯一 $x \\ge 0$，其中 $0 \\le \\rho  1$。\n- 使用一种具有可证明根区间的区间求根方法，对朗之万函数进行数值反演。您的数值程序必须：\n  - 使用 $\\mathcal{L}(x)$ 的级数展开来处理小 $x$ 的情况，以避免当 $x$ 接近 0 时出现有效位数损失。\n  - 对大 $x$ 的情况，使用稳定的双曲函数求值方法。\n  - 保证对所有 $0 \\le \\rho  1$ 的输入都能收敛。\n- 使用公式\n  $$f = \\frac{x}{\\beta b} = \\frac{k_{\\mathrm{B}} T}{b} x，$$\n  计算力 $f$，并在输出中报告以牛顿为单位的 $f$ 值，不带单位标签。\n\n常数和单位：\n- 使用国际单位制 (SI)。取玻尔兹曼常数为 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$。\n- 所有长度单位为米，力为牛顿，温度为开尔文。在双曲函数的定义中，角度是无量纲的，请勿进行转换。\n\n测试套件：\n实现您的程序以评估以下五个测试用例。每个测试用例是一个元组 $(N, b, T, \\langle z \\rangle)$：\n- 用例 1：$(N, b, T, \\langle z \\rangle) = \\left(100,\\ 1.0\\times 10^{-9}\\ \\mathrm{m},\\ 300\\ \\mathrm{K},\\ 10.0\\times 10^{-9}\\ \\mathrm{m}\\right)$。\n- 用例 2：$(N, b, T, \\langle z \\rangle) = \\left(200,\\ 0.5\\times 10^{-9}\\ \\mathrm{m},\\ 300\\ \\mathrm{K},\\ 0.0\\times 10^{0}\\ \\mathrm{m}\\right)$。\n- 用例 3：$(N, b, T, \\langle z \\rangle) = \\left(50,\\ 1.5\\times 10^{-9}\\ \\mathrm{m},\\ 310\\ \\mathrm{K},\\ 0.75\\times 10^{-9}\\ \\mathrm{m}\\right)$。\n- 用例 4：$(N, b, T, \\langle z \\rangle) = \\left(1000,\\ 0.7\\times 10^{-9}\\ \\mathrm{m},\\ 298\\ \\mathrm{K},\\ 6.65\\times 10^{-7}\\ \\mathrm{m}\\right)$。\n- 用例 5：$(N, b, T, \\langle z \\rangle) = \\left(120,\\ 1.2\\times 10^{-9}\\ \\mathrm{m},\\ 350\\ \\mathrm{K},\\ 72.0\\times 10^{-9}\\ \\mathrm{m}\\right)$。\n\n输出规范：\n- 对于每个测试用例，计算估算的力 $f$（以牛顿为单位）作为一个浮点数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个数字都采用科学记数法，并精确到六位有效数字，例如\n  $$[\\text{f1},\\text{f2},\\text{f3},\\text{f4},\\text{f5}]$$\n  其中每个 $\\text{f}i$ 是以牛顿为单位的小数值，输出中不包含单位字符串。",
            "solution": "该问题要求在给定理想自由连接聚合物链的平均端到端投影 $\\langle z \\rangle$ 的情况下，确定施加在其上的拉伸力 $f$。该链由 $N$ 个链段组成，每个链段长度为 $b$，处于恒定的绝对温度 $T$ 下。此任务涉及对从统计力学推导出的力-伸长关系进行数值反演。\n\n首先，我们建立理论基础。在正则系综中，单个聚合物链段具有由立体角 $d\\Omega$ 描述的特定取向的概率，与其玻尔兹曼因子 $e^{-\\beta E}$ 成正比，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$ 是逆热能， $E$ 是链段在外力场中的势能。力 $f$ 沿 $z$ 轴施加，因此与该轴成 $\\theta$ 角的链段的能量为 $E = -f b \\cos\\theta$。\n\n单个链段的正则配分函数 $Z_1$ 是通过对所有可能的取向积分玻尔兹曼因子得到的：\n$$Z_1 = \\int e^{-\\beta E} d\\Omega = \\int_0^{2\\pi} d\\phi \\int_0^\\pi d\\theta \\sin\\theta \\, e^{\\beta f b \\cos\\theta}$$\n令 $x = \\beta f b$ 为无量纲的约化力。积分变为：\n$$Z_1 = 2\\pi \\int_0^\\pi \\sin\\theta \\, e^{x \\cos\\theta} d\\theta$$\n使用换元法 $u = \\cos\\theta$，$du = -\\sin\\theta d\\theta$：\n$$Z_1 = 2\\pi \\int_{-1}^1 e^{xu} du = 2\\pi \\left[ \\frac{e^{xu}}{x} \\right]_{-1}^1 = 2\\pi \\frac{e^x - e^{-x}}{x} = 4\\pi \\frac{\\sinh(x)}{x}$$\n单个链段沿力轴的平均投影 $\\langle z_1 \\rangle$ 由热力学关系给出：\n$$\\langle z_1 \\rangle = \\frac{1}{\\beta} \\frac{\\partial \\ln Z_1}{\\partial f} = k_{\\mathrm{B}} T \\frac{\\partial}{\\partial f} \\ln\\left(4\\pi \\frac{\\sinh(\\beta f b)}{\\beta f b}\\right)$$\n由于 $\\frac{\\partial}{\\partial f} = \\beta b \\frac{\\partial}{\\partial x}$，我们有：\n$$\\langle z_1 \\rangle = b \\frac{\\partial}{\\partial x} (\\ln(\\sinh(x)) - \\ln(x)) = b \\left(\\frac{\\cosh(x)}{\\sinh(x)} - \\frac{1}{x}\\right) = b \\left(\\coth(x) - \\frac{1}{x}\\right)$$\n括号中的项是朗之万函数 $\\mathcal{L}(x)$。因此，$\\langle z_1 \\rangle = b \\mathcal{L}(x)$。\n\n对于理想自由连接链， $N$ 个链段是独立的。总的平均端到端投影是各个平均投影之和：\n$$\\langle z \\rangle = \\sum_{i=1}^N \\langle z_i \\rangle = N \\langle z_1 \\rangle = N b \\mathcal{L}(x)$$\n问题将约化伸长量定义为 $\\rho = \\frac{\\langle z \\rangle}{N b}$。将其代入上式，得到需要求解的核心关系：\n$$\\rho = \\mathcal{L}(x)$$\n我们的目标是对于给定的 $\\rho \\in [0, 1)$，找到满足此方程的唯一非负解 $x = \\mathcal{L}^{-1}(\\rho)$，并根据 $x$ 计算力 $f = x / (\\beta b) = \\frac{k_{\\mathrm{B}} T}{b} x$。\n\n朗之万函数 $\\mathcal{L}(x)$ 具有以下性质：\n1.  $\\lim_{x\\to 0^+} \\mathcal{L}(x) = 0$。\n2.  $\\lim_{x\\to \\infty} \\mathcal{L}(x) = 1$。\n3.  导数 $\\mathcal{L}'(x) = \\frac{1}{x^2} - \\text{csch}^2(x)$，对于 $x > 0$ 严格为正。\n这些性质确保了 $\\mathcal{L}(x)$ 在定义域 $x \\in [0, \\infty)$ 上是一个从 0 到 1 的严格单调递增函数。因此，对于任何给定的 $\\rho \\in [0, 1)$ 值，都存在一个唯一的非负解 $x = \\mathcal{L}^{-1}(\\rho)$。\n\n寻找 $x$ 的数值过程必须是稳健的。我们定义一个函数 $g(x) = \\mathcal{L}(x) - \\rho$ 并寻找它的根。一种区间求根方法，例如 Brent 方法，是理想的选择，因为它只要找到一个有效的根区间 $[a, b]$（其中 $g(a)$ 和 $g(b)$ 异号），就能保证收敛。\n\n算法流程如下：\n1.  对于每个测试用例 $(N, b, T, \\langle z \\rangle)$，计算约化伸长量 $\\rho = \\frac{\\langle z \\rangle}{N b}$。问题约束确保了 $0 \\le \\rho  1$。\n2.  如果 $\\rho=0$，则解显然为 $x=0$，这意味着 $f=0$。\n3.  如果 $\\rho > 0$，我们寻找 $g(x) = \\mathcal{L}(x) - \\rho = 0$ 的根。\n    a.  **寻找根区间 $[a, b]$**：我们需要 $a$ 和 $b$ 使得 $g(a)g(b)  0$。我们可以选择 $a=0$，此时 $g(0) = \\mathcal{L}(0) - \\rho = -\\rho  0$。为了找到一个上界 $b$ 使得 $g(b) > 0$，我们从一个初始猜测（例如 $b=1$）开始，并迭代地将其加倍（$b \\leftarrow 2b$），直到满足条件 $\\mathcal{L}(b) > \\rho$。由于 $\\lim_{x\\to\\infty}\\mathcal{L}(x)=1$，这个搜索过程保证会终止。\n    b.  **求解 $x$**：利用已确定的根区间 $[a, b]$，使用像 `scipy.optimize.brentq` 这样的标准数值求解器来高精度地找到唯一的根 $x$。\n\n一个关键方面是 $\\mathcal{L}(x)$ 本身的数值实现。\n-   **小 $x$ 情况**：对于小的 $x$，$\\coth(x) \\approx 1/x$，导致在计算 $\\coth(x) - 1/x$ 时发生灾难性抵消。为避免此问题，我们对低于某个阈值（例如 $10^{-5}$）的 $|x|$ 使用 $\\mathcal{L}(x)$ 的泰勒级数展开：\n    $$\\mathcal{L}(x) = \\frac{x}{3} - \\frac{x^3}{45} + \\frac{2x^5}{945} - \\dots$$\n-   **大 $x$ 情况**：对于大的 $x$，$e^x$ 可能导致溢出。函数 $\\coth(x) = \\frac{e^x + e^{-x}}{e^x - e^{-x}}$可以重写为 $\\frac{1 + e^{-2x}}{1 - e^{-2x}}$，这种形式在数值上是稳定的。另外，使用 `1.0 / numpy.tanh(x)` 也很稳定，因为对于大的 $x$ 值，`tanh(x)` 会趋近于 1 而不会溢出。\n\n4.  最后，在获得无量纲的根 $x$ 之后，使用以下公式以国际单位制（牛顿）计算力 $f$：\n    $$f = \\frac{k_{\\mathrm{B}} T}{b} x$$\n其中 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$。\n\n此方法论为解决所述问题提供了一个完整、稳健且有科学依据的程序。实现将针对每个提供的测试用例遵循这些步骤。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the force on a freely-jointed chain given its extension.\n    \"\"\"\n\n    # Use the specified value for the Boltzmann constant.\n    KB = 1.380649e-23  # J/K\n\n    def langevin_function(x):\n        \"\"\"\n        Computes the Langevin function L(x) = coth(x) - 1/x.\n\n        This implementation is designed to be numerically stable across the\n        full range of x >= 0.\n        \"\"\"\n        # Handle the trivial case x=0.\n        if x == 0.0:\n            return 0.0\n\n        # For small x, use the Taylor series expansion to avoid catastrophic\n        # cancellation between coth(x) and 1/x.\n        if abs(x)  1e-5:\n            x2 = x * x\n            # Series: x/3 - x^3/45 + 2x^5/945 - ...\n            return x / 3.0 - x * x2 / 45.0 + 2.0 * x * x2 * x2 / 945.0\n        \n        # For larger x, the standard definition is used.\n        # numpy.tanh is numerically stable for a wide range of inputs.\n        # 1/tanh(x) is a stable way to compute coth(x).\n        return 1.0 / np.tanh(x) - 1.0 / x\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, b, T,\n```"
        }
    ]
}