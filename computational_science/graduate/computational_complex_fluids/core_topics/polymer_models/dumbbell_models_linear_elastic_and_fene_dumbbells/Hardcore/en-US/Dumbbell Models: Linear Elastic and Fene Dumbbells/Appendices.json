{
    "hands_on_practices": [
        {
            "introduction": "Our hands-on exploration begins with the most fundamental scenario: a polymer dumbbell at thermodynamic equilibrium. Before we can understand how flow deforms polymers, we must first characterize their resting state using the principles of statistical mechanics. This practice  grounds our understanding by having you derive the equilibrium probability distribution and the average conformation for a Hookean dumbbell, connecting the microscopic spring potential to a macroscopic tensor quantity.",
            "id": "4084428",
            "problem": "Consider the Hookean (linear elastic) dumbbell model in three spatial dimensions, where the end-to-end connector vector is denoted by $\\mathbf{Q} \\in \\mathbb{R}^{3}$ and the spring potential is $U(\\mathbf{Q}) = \\frac{H}{2}|\\mathbf{Q}|^{2}$ with $H0$ the spring constant. In thermal equilibrium at absolute temperature $T0$, the canonical probability density of $\\mathbf{Q}$ is given by the Boltzmann distribution $\\psi_{\\text{eq}}(\\mathbf{Q}) \\propto \\exp\\!\\left(-\\frac{U(\\mathbf{Q})}{k_{B}T}\\right)$, where $k_{B}$ is the Boltzmann constant. Therefore, the equilibrium density can be written as $\\psi_{\\text{eq}}(\\mathbf{Q}) = C \\exp\\!\\left(-\\frac{H}{2k_{B}T}|\\mathbf{Q}|^{2}\\right)$ for some normalization constant $C0$. \n\nStarting from the canonical ensemble definition and first principles of probability normalization, determine the constant $C$ by enforcing $\\int_{\\mathbb{R}^{3}} \\psi_{\\text{eq}}(\\mathbf{Q}) \\,\\mathrm{d}\\mathbf{Q} = 1$. Then, using the normalized density, verify that the equilibrium second-moment tensor of the connector vector satisfies $\\langle \\mathbf{Q}\\mathbf{Q}^T\\rangle = \\frac{k_{B}T}{H}\\mathbf{I}$, where $\\mathbf{I}$ is the identity tensor in three dimensions and $\\langle \\cdot \\rangle$ denotes the ensemble average with respect to $\\psi_{\\text{eq}}$.\n\nProvide your final answer as a single closed-form analytic expression for the normalization constant $C$ in terms of $H$, $k_{B}$, $T$, and $\\pi$. You do not need to include units. No numerical rounding is required.",
            "solution": "The problem requires the determination of the normalization constant $C$ for the equilibrium probability density function of a Hookean dumbbell and the subsequent verification of the expression for the equilibrium second-moment tensor.\n\n**Part 1: Determination of the Normalization Constant $C$**\n\nThe equilibrium probability density function for the connector vector $\\mathbf{Q} \\in \\mathbb{R}^{3}$ is given by:\n$$\n\\psi_{\\text{eq}}(\\mathbf{Q}) = C \\exp\\left(-\\frac{H}{2k_{B}T}|\\mathbf{Q}|^{2}\\right)\n$$\nwhere $C$ is a normalization constant, $H$ is the spring constant, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature. For $\\psi_{\\text{eq}}(\\mathbf{Q})$ to be a valid probability density function, its integral over the entire configuration space must be equal to $1$. This is the normalization condition:\n$$\n\\int_{\\mathbb{R}^{3}} \\psi_{\\text{eq}}(\\mathbf{Q}) \\,\\mathrm{d}\\mathbf{Q} = 1\n$$\nSubstituting the expression for $\\psi_{\\text{eq}}(\\mathbf{Q})$, we get:\n$$\nC \\int_{\\mathbb{R}^{3}} \\exp\\left(-\\frac{H}{2k_{B}T}|\\mathbf{Q}|^{2}\\right) \\,\\mathrm{d}\\mathbf{Q} = 1\n$$\nTo simplify the notation, let us define a constant $\\alpha = \\frac{H}{2k_{B}T}$. Since $H  0$ and $T  0$, we have $\\alpha  0$. The equation becomes:\n$$\nC \\int_{\\mathbb{R}^{3}} \\exp(-\\alpha |\\mathbf{Q}|^{2}) \\,\\mathrm{d}\\mathbf{Q} = 1\n$$\nFrom this, the normalization constant $C$ can be expressed as the reciprocal of the integral:\n$$\nC = \\left( \\int_{\\mathbb{R}^{3}} \\exp(-\\alpha |\\mathbf{Q}|^{2}) \\,\\mathrm{d}\\mathbf{Q} \\right)^{-1}\n$$\nThe vector $\\mathbf{Q}$ has components $(Q_x, Q_y, Q_z)$, so its squared magnitude is $|\\mathbf{Q}|^{2} = Q_x^2 + Q_y^2 + Q_z^2$. The volume element in Cartesian coordinates is $\\mathrm{d}\\mathbf{Q} = \\mathrm{d}Q_x \\mathrm{d}Q_y \\mathrm{d}Q_z$. The integral is a three-dimensional Gaussian integral:\n$$\nI = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp(-\\alpha (Q_x^2 + Q_y^2 + Q_z^2)) \\,\\mathrm{d}Q_x \\mathrm{d}Q_y \\mathrm{d}Q_z\n$$\nDue to the exponential form, this integral is separable into a product of three identical one-dimensional integrals:\n$$\nI = \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha Q_x^2) \\,\\mathrm{d}Q_x\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha Q_y^2) \\,\\mathrm{d}Q_y\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha Q_z^2) \\,\\mathrm{d}Q_z\\right)\n$$\nEach of these integrals is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) \\,\\mathrm{d}x = \\sqrt{\\frac{\\pi}{a}}$. In our case, the parameter is $\\alpha$. Thus, each integral evaluates to $\\sqrt{\\frac{\\pi}{\\alpha}}$. The total integral $I$ is then:\n$$\nI = \\left(\\sqrt{\\frac{\\pi}{\\alpha}}\\right)^3 = \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2}\n$$\nThe normalization constant $C$ is the reciprocal of $I$:\n$$\nC = I^{-1} = \\left(\\left(\\frac{\\pi}{\\alpha}\\right)^{3/2}\\right)^{-1} = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}\n$$\nSubstituting back the definition of $\\alpha = \\frac{H}{2k_{B}T}$, we find the expression for $C$:\n$$\nC = \\left(\\frac{H}{2\\pi k_{B}T}\\right)^{3/2}\n$$\n\n**Part 2: Verification of the Second-Moment Tensor $\\langle\\mathbf{Q}\\mathbf{Q}^T\\rangle$**\n\nThe second-moment tensor is defined as the dyadic product $\\mathbf{Q}\\mathbf{Q}^T$, and its ensemble average is given by:\n$$\n\\langle \\mathbf{Q}\\mathbf{Q}^T\\rangle = \\int_{\\mathbb{R}^{3}} (\\mathbf{Q}\\mathbf{Q}^T) \\psi_{\\text{eq}}(\\mathbf{Q}) \\,\\mathrm{d}\\mathbf{Q}\n$$\nThe components of this tensor are $\\langle Q_i Q_j \\rangle$ for $i, j \\in \\{x, y, z\\}$.\n\nFirst, let's consider the off-diagonal components, where $i \\neq j$. For instance, we compute $\\langle Q_x Q_y \\rangle$:\n$$\n\\langle Q_x Q_y \\rangle = \\int_{\\mathbb{R}^{3}} Q_x Q_y \\, C \\exp(-\\alpha(Q_x^2 + Q_y^2 + Q_z^2)) \\,\\mathrm{d}Q_x \\mathrm{d}Q_y \\mathrm{d}Q_z\n$$\nThis integral can be separated:\n$$\n\\langle Q_x Q_y \\rangle = C \\left(\\int_{-\\infty}^{\\infty} Q_x \\exp(-\\alpha Q_x^2)\\,\\mathrm{d}Q_x\\right) \\left(\\int_{-\\infty}^{\\infty} Q_y \\exp(-\\alpha Q_y^2)\\,\\mathrm{d}Q_y\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha Q_z^2)\\,\\mathrm{d}Q_z\\right)\n$$\nThe integrand of the first integral, $f(Q_x) = Q_x \\exp(-\\alpha Q_x^2)$, is an odd function, since $f(-Q_x) = -f(Q_x)$. The integral of any odd function over a symmetric interval, such as $(-\\infty, \\infty)$, is zero.\n$$\n\\int_{-\\infty}^{\\infty} Q_x \\exp(-\\alpha Q_x^2)\\,\\mathrm{d}Q_x = 0\n$$\nTherefore, $\\langle Q_x Q_y \\rangle = 0$. By identical reasoning, all off-diagonal components $\\langle Q_i Q_j \\rangle$ for $i \\neq j$ are zero. This establishes that the tensor $\\langle \\mathbf{Q}\\mathbf{Q}^T\\rangle$ must be diagonal.\n\nNext, we consider the diagonal components, $\\langle Q_i^2 \\rangle$. Due to the spherical symmetry of the probability density $\\psi_{\\text{eq}}(\\mathbf{Q})$ (it depends only on $|\\mathbf{Q}|$), the choice of coordinate axes is arbitrary. Therefore, we must have $\\langle Q_x^2 \\rangle = \\langle Q_y^2 \\rangle = \\langle Q_z^2 \\rangle$. Let's compute one of them, $\\langle Q_x^2 \\rangle$:\n$$\n\\langle Q_x^2 \\rangle = \\int_{\\mathbb{R}^{3}} Q_x^2 \\, \\psi_{\\text{eq}}(\\mathbf{Q}) \\,\\mathrm{d}\\mathbf{Q} = C \\int_{\\mathbb{R}^{3}} Q_x^2 \\exp(-\\alpha (Q_x^2 + Q_y^2 + Q_z^2)) \\,\\mathrm{d}\\mathbf{Q}\n$$\nSeparating the integral:\n$$\n\\langle Q_x^2 \\rangle = C \\left(\\int_{-\\infty}^{\\infty} Q_x^2 \\exp(-\\alpha Q_x^2)\\,\\mathrm{d}Q_x\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha Q_y^2)\\,\\mathrm{d}Q_y\\right) \\left(\\int_{-\\infty}^{\\infty} \\exp(-\\alpha Q_z^2)\\,\\mathrm{d}Q_z\\right)\n$$\nWe know that $\\int_{-\\infty}^{\\infty} \\exp(-\\alpha y^2)\\,\\mathrm{d}y = \\sqrt{\\pi/\\alpha}$. The integral involving $Q_x^2$ is a known result, which can be obtained by differentiating the basic Gaussian integral with respect to the parameter $\\alpha$:\n$$\n\\int_{-\\infty}^{\\infty} x^2 \\exp(-\\alpha x^2)\\,\\mathrm{d}x = -\\frac{\\mathrm{d}}{\\mathrm{d}\\alpha} \\int_{-\\infty}^{\\infty} \\exp(-\\alpha x^2)\\,\\mathrm{d}x = -\\frac{\\mathrm{d}}{\\mathrm{d}\\alpha} \\left(\\sqrt{\\frac{\\pi}{\\alpha}}\\right) = -\\sqrt{\\pi} \\left(-\\frac{1}{2} \\alpha^{-3/2}\\right) = \\frac{\\sqrt{\\pi}}{2\\alpha^{3/2}} = \\frac{1}{2\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}}\n$$\nSubstituting these results back into the expression for $\\langle Q_x^2 \\rangle$:\n$$\n\\langle Q_x^2 \\rangle = C \\left(\\frac{1}{2\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}}\\right) \\left(\\sqrt{\\frac{\\pi}{\\alpha}}\\right) \\left(\\sqrt{\\frac{\\pi}{\\alpha}}\\right) = C \\frac{1}{2\\alpha} \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2}\n$$\nNow, we use the expression for the normalization constant $C = (\\alpha/\\pi)^{3/2}$ derived in the first part:\n$$\n\\langle Q_x^2 \\rangle = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\frac{1}{2\\alpha} \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} = \\frac{1}{2\\alpha}\n$$\nFinally, we substitute back the definition of $\\alpha = \\frac{H}{2k_{B}T}$:\n$$\n\\langle Q_x^2 \\rangle = \\frac{1}{2\\left(\\frac{H}{2k_{B}T}\\right)} = \\frac{2k_{B}T}{2H} = \\frac{k_{B}T}{H}\n$$\nSince all diagonal components are equal and the off-diagonal components are zero, the second-moment tensor is:\n$$\n\\langle \\mathbf{Q}\\mathbf{Q}^T\\rangle = \n\\begin{pmatrix}\n\\frac{k_{B}T}{H}  0  0 \\\\\n0  \\frac{k_{B}T}{H}  0 \\\\\n0  0  \\frac{k_{B}T}{H}\n\\end{pmatrix}\n= \\frac{k_{B}T}{H}\n\\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n= \\frac{k_{B}T}{H}\\mathbf{I}\n$$\nThis completes the verification as required by the problem statement. The primary result requested for the final answer is the expression for $C$.",
            "answer": "$$\n\\boxed{\\left(\\frac{H}{2\\pi k_{B}T}\\right)^{3/2}}\n$$"
        },
        {
            "introduction": "Having characterized the equilibrium state, we now investigate how a Hookean dumbbell responds to a steady shear flow. This is where we move from static statistical mechanics to dynamic response, a core theme in rheology. In this exercise , you will solve the constitutive equation for the Oldroyd-B model to determine the average polymer stretch as a function of the Weissenberg number, $\\mathrm{Wi}$. The result starkly reveals a critical, unphysical limitation of the linear spring model, demonstrating why more realistic nonlinear models are necessary.",
            "id": "4084433",
            "problem": "Consider a dilute solution of Hookean (linearly elastic) dumbbells whose ensemble-averaged conformation is described by the second moment tensor $ \\mathbf{A} = \\langle \\mathbf{q} \\mathbf{q}^T \\rangle / \\langle \\mathbf{q}^2 \\rangle_{\\mathrm{eq}} $, where $ \\mathbf{q} $ is the end-to-end vector of a dumbbell and $ \\langle \\cdot \\rangle $ denotes an ensemble average. For the Oldroyd-B model arising from this linear elastic dumbbell description, the conformation tensor $ \\mathbf{A} $ evolves according to the upper-convected Maxwell-type equation\n$$\n\\overset{\\triangledown}{\\mathbf{A}} = -\\frac{1}{\\lambda}\\left( \\mathbf{A} - \\mathbf{I} \\right),\n$$\nwhere $ \\overset{\\triangledown}{(\\cdot)} $ is the upper-convected derivative, $ \\lambda $ is the single-mode relaxation time, and $ \\mathbf{I} $ is the identity tensor. The upper-convected derivative is defined by\n$$\n\\overset{\\triangledown}{\\mathbf{A}} = \\frac{\\mathrm{D} \\mathbf{A}}{\\mathrm{D} t} - \\mathbf{\\kappa} \\cdot \\mathbf{A} - \\mathbf{A} \\cdot \\mathbf{\\kappa}^{\\top},\n$$\nwith $ \\mathbf{\\kappa} = \\nabla \\mathbf{u} $ the velocity gradient tensor and $ \\mathbf{u} $ the fluid velocity field.\n\nIn a spatially homogeneous, steady simple shear flow, the velocity field is $ \\mathbf{u}(\\mathbf{x}) = (\\dot{\\gamma} y, 0, 0) $, where $ \\dot{\\gamma} $ is the constant shear rate, so that the velocity gradient is\n$$\n\\mathbf{\\kappa} = \\nabla \\mathbf{u} = \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n\nStarting strictly from these definitions and evolution laws, derive the steady-state, spatially uniform conformation tensor $ \\mathbf{A} $ for this simple shear flow. Then compute $ \\mathrm{tr}\\,\\mathbf{A} $ and express it as a closed-form analytic function of the Weissenberg number (defined on first use) $ \\mathrm{Wi} = \\lambda \\dot{\\gamma} $. Express the final result for $ \\mathrm{tr}\\,\\mathbf{A} $ as a dimensionless analytic expression in terms of $ \\mathrm{Wi} $. No numerical evaluation is required.",
            "solution": "The problem requires finding the steady-state, spatially uniform conformation tensor $\\mathbf{A}$ for a Hookean dumbbell solution in simple shear flow, and then computing its trace, $\\mathrm{tr}\\,\\mathbf{A}$, as a function of the Weissenberg number, $\\mathrm{Wi}$.\n\nThe validation of the problem statement is performed first.\n\n**Step 1: Extract Givens**\n- The conformation tensor is defined as $\\mathbf{A} = \\langle \\mathbf{q} \\mathbf{q}^T \\rangle / \\langle \\mathbf{q}^2 \\rangle_{\\mathrm{eq}}$.\n- The evolution equation for $\\mathbf{A}$ is given by the upper-convected Maxwell model: $\\overset{\\triangledown}{\\mathbf{A}} = -\\frac{1}{\\lambda}\\left( \\mathbf{A} - \\mathbf{I} \\right)$.\n- The upper-convected derivative is defined as: $\\overset{\\triangledown}{\\mathbf{A}} = \\frac{\\mathrm{D} \\mathbf{A}}{\\mathrm{D} t} - \\mathbf{\\kappa} \\cdot \\mathbf{A} - \\mathbf{A} \\cdot \\mathbf{\\kappa}^{\\top}$.\n- The velocity gradient tensor is $\\mathbf{\\kappa} = \\nabla \\mathbf{u}$.\n- The flow is a steady simple shear flow, with velocity field $\\mathbf{u}(\\mathbf{x}) = (\\dot{\\gamma} y, 0, 0)$.\n- The corresponding velocity gradient tensor is $\\mathbf{\\kappa} = \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}$.\n- The problem specifies conditions of \"spatially homogeneous\" and \"steady\" flow.\n- The Weissenberg number is defined as $\\mathrm{Wi} = \\lambda \\dot{\\gamma}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it uses the standard Oldroyd-B model (equivalent to the upper-convected Maxwell model for the polymer contribution to stress) derived from Hookean dumbbell kinetic theory, which is a cornerstone of polymer rheology. The equations are well-established. The problem is well-posed, providing all necessary information (equations of motion, flow kinematics, and simplifying conditions) to derive a unique solution. The language is objective and precise. The problem is fully formalizable and directly relevant to the topic of dumbbell models. There are no contradictions, missing information, or scientifically implausible conditions.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be derived.\n\nThe starting point is the evolution equation for the conformation tensor $\\mathbf{A}$:\n$$\n\\overset{\\triangledown}{\\mathbf{A}} = -\\frac{1}{\\lambda}\\left( \\mathbf{A} - \\mathbf{I} \\right)\n$$\nSubstituting the definition of the upper-convected derivative, $\\overset{\\triangledown}{\\mathbf{A}}$, we get:\n$$\n\\frac{\\mathrm{D} \\mathbf{A}}{\\mathrm{D} t} - \\mathbf{\\kappa} \\cdot \\mathbf{A} - \\mathbf{A} \\cdot \\mathbf{\\kappa}^{\\top} = -\\frac{1}{\\lambda}\\left( \\mathbf{A} - \\mathbf{I} \\right)\n$$\nThe material derivative $\\frac{\\mathrm{D} \\mathbf{A}}{\\mathrm{D} t}$ is defined as $\\frac{\\partial \\mathbf{A}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{A}$.\nThe problem states that the solution is \"steady,\" which implies that the partial derivative with respect to time is zero: $\\frac{\\partial \\mathbf{A}}{\\partial t} = \\mathbf{0}$.\nIt also states that the solution is \"spatially uniform,\" which implies that the gradient of the tensor is zero: $\\nabla \\mathbf{A} = \\mathbf{0}$.\nConsequently, the material derivative vanishes: $\\frac{\\mathrm{D} \\mathbf{A}}{\\mathrm{D} t} = \\mathbf{0}$.\n\nThe evolution equation simplifies to an algebraic equation for the tensor $\\mathbf{A}$:\n$$\n- \\mathbf{\\kappa} \\cdot \\mathbf{A} - \\mathbf{A} \\cdot \\mathbf{\\kappa}^{\\top} = -\\frac{1}{\\lambda}\\left( \\mathbf{A} - \\mathbf{I} \\right)\n$$\nRearranging this equation to solve for $\\mathbf{A}$:\n$$\n\\mathbf{A} - \\mathbf{I} = \\lambda \\left( \\mathbf{\\kappa} \\cdot \\mathbf{A} + \\mathbf{A} \\cdot \\mathbf{\\kappa}^{\\top} \\right)\n$$\nThe conformation tensor $\\mathbf{A}$ is symmetric by its definition $\\mathbf{A} = \\langle \\mathbf{q} \\mathbf{q}^T \\rangle / \\langle \\mathbf{q}^2 \\rangle_{\\mathrm{eq}}$, so we can write it as:\n$$\n\\mathbf{A} = \\begin{pmatrix} A_{xx}  A_{xy}  A_{xz} \\\\ A_{xy}  A_{yy}  A_{yz} \\\\ A_{xz}  A_{yz}  A_{zz} \\end{pmatrix}\n$$\nThe velocity gradient tensor $\\mathbf{\\kappa}$ and its transpose $\\mathbf{\\kappa}^{\\top}$ are:\n$$\n\\mathbf{\\kappa} = \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}, \\quad \\mathbf{\\kappa}^{\\top} = \\begin{pmatrix} 0  0  0 \\\\ \\dot{\\gamma}  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nNow, we compute the products $\\mathbf{\\kappa} \\cdot \\mathbf{A}$ and $\\mathbf{A} \\cdot \\mathbf{\\kappa}^{\\top}$:\n$$\n\\mathbf{\\kappa} \\cdot \\mathbf{A} = \\begin{pmatrix} 0  \\dot{\\gamma}  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} A_{xx}  A_{xy}  A_{xz} \\\\ A_{xy}  A_{yy}  A_{yz} \\\\ A_{xz}  A_{yz}  A_{zz} \\end{pmatrix} = \\begin{pmatrix} \\dot{\\gamma} A_{xy}  \\dot{\\gamma} A_{yy}  \\dot{\\gamma} A_{yz} \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n$$\n\\mathbf{A} \\cdot \\mathbf{\\kappa}^{\\top} = \\begin{pmatrix} A_{xx}  A_{xy}  A_{xz} \\\\ A_{xy}  A_{yy}  A_{yz} \\\\ A_{xz}  A_{yz}  A_{zz} \\end{pmatrix} \\begin{pmatrix} 0  0  0 \\\\ \\dot{\\gamma}  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\dot{\\gamma} A_{xy}  0  0 \\\\ \\dot{\\gamma} A_{yy}  0  0 \\\\ \\dot{\\gamma} A_{yz}  0  0 \\end{pmatrix}\n$$\nThe sum of these two products is:\n$$\n\\mathbf{\\kappa} \\cdot \\mathbf{A} + \\mathbf{A} \\cdot \\mathbf{\\kappa}^{\\top} = \\begin{pmatrix} 2\\dot{\\gamma} A_{xy}  \\dot{\\gamma} A_{yy}  \\dot{\\gamma} A_{yz} \\\\ \\dot{\\gamma} A_{yy}  0  0 \\\\ \\dot{\\gamma} A_{yz}  0  0 \\end{pmatrix}\n$$\nSubstituting this back into the rearranged evolution equation:\n$$\n\\begin{pmatrix} A_{xx} - 1  A_{xy}  A_{xz} \\\\ A_{xy}  A_{yy} - 1  A_{yz} \\\\ A_{xz}  A_{yz}  A_{zz} - 1 \\end{pmatrix} = \\lambda \\begin{pmatrix} 2\\dot{\\gamma} A_{xy}  \\dot{\\gamma} A_{yy}  \\dot{\\gamma} A_{yz} \\\\ \\dot{\\gamma} A_{yy}  0  0 \\\\ \\dot{\\gamma} A_{yz}  0  0 \\end{pmatrix}\n$$\nWe introduce the dimensionless Weissenberg number, $\\mathrm{Wi} = \\lambda \\dot{\\gamma}$. The equation becomes:\n$$\n\\begin{pmatrix} A_{xx} - 1  A_{xy}  A_{xz} \\\\ A_{xy}  A_{yy} - 1  A_{yz} \\\\ A_{xz}  A_{yz}  A_{zz} - 1 \\end{pmatrix} = \\begin{pmatrix} 2\\mathrm{Wi} A_{xy}  \\mathrm{Wi} A_{yy}  \\mathrm{Wi} A_{yz} \\\\ \\mathrm{Wi} A_{yy}  0  0 \\\\ \\mathrm{Wi} A_{yz}  0  0 \\end{pmatrix}\n$$\nBy equating the components of the matrices on both sides, we obtain a system of linear algebraic equations for the components of $\\mathbf{A}$:\nFrom the $(3,3)$ component: $A_{zz} - 1 = 0 \\implies A_{zz} = 1$.\nFrom the $(2,3)$ component (or $(3,2)$): $A_{yz} = 0$.\nFrom the $(1,3)$ component (or $(3,1)$): $A_{xz} = \\mathrm{Wi} A_{yz}$. Since $A_{yz} = 0$, we have $A_{xz} = 0$.\nFrom the $(2,2)$ component: $A_{yy} - 1 = 0 \\implies A_{yy} = 1$.\nFrom the $(1,2)$ component (or $(2,1)$): $A_{xy} = \\mathrm{Wi} A_{yy}$. Since $A_{yy} = 1$, we have $A_{xy} = \\mathrm{Wi}$.\nFrom the $(1,1)$ component: $A_{xx} - 1 = 2\\mathrm{Wi} A_{xy}$. Substituting $A_{xy} = \\mathrm{Wi}$, we get $A_{xx} - 1 = 2\\mathrm{Wi}(\\mathrm{Wi}) = 2\\mathrm{Wi}^{2}$, which gives $A_{xx} = 1 + 2\\mathrm{Wi}^{2}$.\n\nCollecting these components, the steady-state conformation tensor is:\n$$\n\\mathbf{A} = \\begin{pmatrix} 1 + 2\\mathrm{Wi}^{2}  \\mathrm{Wi}  0 \\\\ \\mathrm{Wi}  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThe final step is to compute the trace of $\\mathbf{A}$, which is the sum of its diagonal elements:\n$$\n\\mathrm{tr}\\,\\mathbf{A} = A_{xx} + A_{yy} + A_{zz}\n$$\n$$\n\\mathrm{tr}\\,\\mathbf{A} = (1 + 2\\mathrm{Wi}^{2}) + 1 + 1\n$$\n$$\n\\mathrm{tr}\\,\\mathbf{A} = 3 + 2\\mathrm{Wi}^{2}\n$$\nThis expression gives the trace of the conformation tensor as a dimensionless analytic function of the Weissenberg number $\\mathrm{Wi}$. This trace is physically related to the average squared end-to-end distance of the polymer chains, normalized by its equilibrium value. The result indicates that the polymer chains stretch under shear, and the extent of stretching grows quadratically with the Weissenberg number.",
            "answer": "$$\n\\boxed{3 + 2\\mathrm{Wi}^{2}}\n$$"
        },
        {
            "introduction": "The Finitely Extensible Nonlinear Elastic (FENE) model resolves the unphysical infinite stretch of its Hookean counterpart, but this realism introduces a significant numerical challenge known as stiffness. This computational practice  tackles this issue head-on, moving from analytical theory to practical implementation. You will derive a semi-implicit time-stepping scheme, a crucial technique for developing stable and efficient simulations of the deterministic drift in FENE dumbbell dynamics.",
            "id": "4084431",
            "problem": "Consider a single-beadâ€“spring dumbbell model in a homogeneous linear flow with velocity gradient tensor $\\boldsymbol{\\kappa}(t)$, where the connector vector is $\\mathbf{Q}(t) \\in \\mathbb{R}^3$. In the overdamped regime, the deterministic drift of the connector vector is governed by the balance of hydrodynamic stretching and spring contraction. Denoting the friction coefficient by $\\zeta$ and the spring potential by $U(\\mathbf{Q})$, the deterministic part of the dynamics is\n$$\n\\zeta \\,\\frac{d\\mathbf{Q}}{dt} \\;=\\; \\zeta\\,\\boldsymbol{\\kappa}(t)\\cdot \\mathbf{Q} \\;-\\; \\nabla_{\\mathbf{Q}} U(\\mathbf{Q}).\n$$\nFor a Finite Extensible Nonlinear Elastic (FENE) spring with elastic modulus $H$ and maximum extension $Q_0$, the potential energy is\n$$\nU(\\mathbf{Q}) \\;=\\; -\\frac{1}{2} H Q_0^2 \\,\\ln\\!\\left(1-\\frac{\\|\\mathbf{Q}\\|^2}{Q_0^2}\\right),\n$$\nso that the spring force is\n$$\n-\\nabla_{\\mathbf{Q}} U(\\mathbf{Q}) \\;=\\; -H\\,\\frac{1}{1 - \\|\\mathbf{Q}\\|^2/Q_0^2}\\,\\mathbf{Q}.\n$$\nWe neglect thermal fluctuations and focus only on the deterministic drift. Introduce the characteristic time scale $\\tau = \\zeta/H$ and, unless otherwise stated, work with nondimensional variables where time is scaled by $\\tau$ and length by $Q_0$ (so that $Q_0$ becomes $1$ in nondimensional form). In these units, the drift equation becomes of the form\n$$\n\\frac{d\\mathbf{Q}}{dt} \\;=\\; \\boldsymbol{\\kappa}(t)\\cdot \\mathbf{Q} \\;-\\; \\frac{1}{1-\\|\\mathbf{Q}\\|^2}\\,\\mathbf{Q}.\n$$\nA well-known numerical challenge is the stiffness introduced by the nonlinear spring term near the maximum extension. Your task is to construct a first-order semi-implicit time-stepping method for the deterministic drift that improves stability for FENE springs by treating the spring contraction term in a manner that is implicit in $\\mathbf{Q}^{n+1}$ but uses only information available at time level $n$ for the nonlinearity. Do not assume any form of linearization that would require evaluating Jacobians at $\\mathbf{Q}^{n+1}$. Start from the drift equation above and use a single-step method with time step $\\Delta t$, applied between times $t^n$ and $t^{n+1}=t^n+\\Delta t$. You may treat $\\boldsymbol{\\kappa}$ implicitly at level $n+1$.\n\nTasks:\n1. Derive a semi-implicit update for the deterministic drift that treats the scalar nonlinearity associated with the FENE spring using only $\\mathbf{Q}^n$, while multiplying $\\mathbf{Q}^{n+1}$, and treats $\\boldsymbol{\\kappa}$ implicitly at level $n+1$. Your derivation must start from the drift equation and elementary time discretization principles, and it must not invoke any pre-assembled or shortcut formulas.\n2. From your update, derive the resulting linear system for $\\mathbf{Q}^{n+1}$ in the form\n$$\n\\mathbf{A}^n\\,\\mathbf{Q}^{n+1} \\;=\\; \\mathbf{b}^n,\n$$\nby writing explicit expressions for $\\mathbf{A}^n$ and $\\mathbf{b}^n$ in terms of $\\Delta t$, $\\mathbf{Q}^n$, $\\boldsymbol{\\kappa}^{n+1}$, and model parameters in the nondimensional formulation described above.\n3. Implement a program that, for each test case below, assembles $\\mathbf{A}^n$ and $\\mathbf{b}^n$, solves for $\\mathbf{Q}^{n+1}$, and reports the updated connector vector.\n\nTest suite (nondimensional; use $Q_0 = 1$ and $\\tau = 1$ so that the spring prefactor simplifies accordingly):\n- Case 1 (happy path, simple shear): $\\Delta t = 0.1$; $\\boldsymbol{\\kappa} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}$; $\\mathbf{Q}^n = (0.2,\\,0.1,\\,0.0)$.\n- Case 2 (near-maximum extension, planar extension): $\\Delta t = 0.1$; $\\boldsymbol{\\kappa} = \\operatorname{diag}(1,\\,-1,\\,0)$; $\\mathbf{Q}^n = (0.99,\\,0.0,\\,0.0)$.\n- Case 3 (zero flow): $\\Delta t = 0.1$; $\\boldsymbol{\\kappa} = \\mathbf{0}$; $\\mathbf{Q}^n = (0.7,\\,-0.2,\\,0.1)$.\n- Case 4 (strong planar extension): $\\Delta t = 0.05$; $\\boldsymbol{\\kappa} = \\operatorname{diag}(3,\\,-3,\\,0)$; $\\mathbf{Q}^n = (0.05,\\,0.02,\\,0.0)$.\n- Case 5 (large time step, zero flow, strong spring): $\\Delta t = 1.0$; $\\boldsymbol{\\kappa} = \\mathbf{0}$; $\\mathbf{Q}^n = (0.95,\\,0.0,\\,0.0)$.\n\nNumerical requirements:\n- Use the nondimensional formulation with $Q_0=1$ and $\\tau=1$.\n- Solve the $3\\times 3$ linear system for each case exactly (up to standard floating-point precision).\n- For each case, output the components of $\\mathbf{Q}^{n+1}$ rounded to eight decimal places.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of three-component lists, enclosed in square brackets, with no spaces, and each component rounded to eight decimal places. For example, the format must be like\n$$\n\\texttt{[[x\\_1,y\\_1,z\\_1],[x\\_2,y\\_2,z\\_2],\\ldots]}\n$$\nwith no spaces anywhere in the line.",
            "solution": "The problem is valid as it presents a well-posed, scientifically grounded task in computational complex fluids, providing all necessary information without contradictions or ambiguities.\n\nHere we derive the semi-implicit numerical scheme, identify the resulting linear system, and outline the implementation logic.\n\n### Part 1: Derivation of the Semi-Implicit Update\n\nWe begin with the provided nondimensional deterministic drift equation for the connector vector $\\mathbf{Q}(t) \\in \\mathbb{R}^3$:\n$$\n\\frac{d\\mathbf{Q}}{dt} \\;=\\; \\boldsymbol{\\kappa}(t)\\cdot \\mathbf{Q} \\;-\\; f(\\|\\mathbf{Q}\\|)\\,\\mathbf{Q}\n$$\nwhere $\\boldsymbol{\\kappa}(t)$ is the velocity gradient tensor and the nonlinear spring function $f(\\|\\mathbf{Q}\\|)$ for the FENE model is:\n$$\nf(\\|\\mathbf{Q}\\|) = \\frac{1}{1-\\|\\mathbf{Q}\\|^2}\n$$\nThe term involving $f(\\|\\mathbf{Q}\\|)$ becomes very large as $\\|\\mathbf{Q}\\|$ approaches its maximum extension of $1$, leading to a stiff ordinary differential equation (ODE). A fully explicit time-stepping method (like forward Euler) would require an prohibitively small time step $\\Delta t$ to remain stable. The problem asks for a semi-implicit method to mitigate this stiffness.\n\nWe will apply a first-order time discretization from time $t^n$ to $t^{n+1} = t^n + \\Delta t$. The time derivative on the left-hand side is approximated using a forward difference:\n$$\n\\frac{d\\mathbf{Q}}{dt} \\approx \\frac{\\mathbf{Q}^{n+1} - \\mathbf{Q}^n}{\\Delta t}\n$$\nwhere $\\mathbf{Q}^n$ is the known vector at time $t^n$ and $\\mathbf{Q}^{n+1}$ is the unknown vector at $t^{n+1}$.\n\nThe right-hand side of the ODE consists of two terms: the hydrodynamic drag term $\\boldsymbol{\\kappa}(t)\\cdot \\mathbf{Q}$ and the spring force term $-f(\\|\\mathbf{Q}\\|)\\,\\mathbf{Q}$. Following the problem's instructions for the semi-implicit scheme:\n\n1.  The hydrodynamic term, $\\boldsymbol{\\kappa}(t)\\cdot \\mathbf{Q}$, is treated implicitly. This means both $\\boldsymbol{\\kappa}$ and $\\mathbf{Q}$ are evaluated at the future time level $t^{n+1}$. The term becomes $\\boldsymbol{\\kappa}^{n+1} \\cdot \\mathbf{Q}^{n+1}$, where $\\boldsymbol{\\kappa}^{n+1} = \\boldsymbol{\\kappa}(t^{n+1})$.\n\n2.  The nonlinear spring term, $-f(\\|\\mathbf{Q}\\|)\\,\\mathbf{Q}$, is treated in a semi-implicit manner. The scalar nonlinear part, $f(\\|\\mathbf{Q}\\|)$, is evaluated using the known state $\\mathbf{Q}^n$, while the vector part $\\mathbf{Q}$ is evaluated implicitly at $t^{n+1}$. This avoids solving a nonlinear equation for $\\mathbf{Q}^{n+1}$. The term becomes:\n    $$\n    -f(\\|\\mathbf{Q}^n\\|)\\,\\mathbf{Q}^{n+1} = -\\left(\\frac{1}{1-\\|\\mathbf{Q}^n\\|^2}\\right)\\mathbf{Q}^{n+1}\n    $$\n\nCombining these discretizations, we form the complete update rule:\n$$\n\\frac{\\mathbf{Q}^{n+1} - \\mathbf{Q}^n}{\\Delta t} \\;=\\; \\boldsymbol{\\kappa}^{n+1} \\cdot \\mathbf{Q}^{n+1} \\;-\\; \\frac{1}{1-\\|\\mathbf{Q}^n\\|^2}\\,\\mathbf{Q}^{n+1}\n$$\nThis equation is linear in the unknown $\\mathbf{Q}^{n+1}$ and can be solved at each time step.\n\n### Part 2: The Linear System $\\mathbf{A}^n\\,\\mathbf{Q}^{n+1} = \\mathbf{b}^n$\n\nOur next task is to rearrange the derived update rule into the standard linear system form $\\mathbf{A}^n\\,\\mathbf{Q}^{n+1} = \\mathbf{b}^n$. We start by multiplying the equation by $\\Delta t$:\n$$\n\\mathbf{Q}^{n+1} - \\mathbf{Q}^n \\;=\\; \\Delta t\\,(\\boldsymbol{\\kappa}^{n+1} \\cdot \\mathbf{Q}^{n+1}) \\;-\\; \\Delta t \\left(\\frac{1}{1-\\|\\mathbf{Q}^n\\|^2}\\right)\\mathbf{Q}^{n+1}\n$$\nNow, we group all terms containing the unknown vector $\\mathbf{Q}^{n+1}$ on the left-hand side and all known quantities on the right-hand side.\n$$\n\\mathbf{Q}^{n+1} - \\Delta t\\,(\\boldsymbol{\\kappa}^{n+1} \\cdot \\mathbf{Q}^{n+1}) + \\Delta t \\left(\\frac{1}{1-\\|\\mathbf{Q}^n\\|^2}\\right)\\mathbf{Q}^{n+1} \\;=\\; \\mathbf{Q}^n\n$$\nTo write this in matrix-vector notation, we introduce the $3 \\times 3$ identity matrix, $\\mathbf{I}$. The operation $\\boldsymbol{\\kappa}^{n+1} \\cdot \\mathbf{Q}^{n+1}$ is equivalent to matrix-vector multiplication.\n$$\n\\mathbf{I}\\,\\mathbf{Q}^{n+1} - \\Delta t\\,\\boldsymbol{\\kappa}^{n+1}\\,\\mathbf{Q}^{n+1} + \\Delta t \\left(\\frac{1}{1-\\|\\mathbf{Q}^n\\|^2}\\right)\\mathbf{I}\\,\\mathbf{Q}^{n+1} \\;=\\; \\mathbf{Q}^n\n$$\nFactoring out the common vector $\\mathbf{Q}^{n+1}$ on the left-hand side yields:\n$$\n\\left[ \\mathbf{I} - \\Delta t\\,\\boldsymbol{\\kappa}^{n+1} + \\frac{\\Delta t}{1-\\|\\mathbf{Q}^n\\|^2}\\,\\mathbf{I} \\right] \\mathbf{Q}^{n+1} \\;=\\; \\mathbf{Q}^n\n$$\nThis equation has the form $\\mathbf{A}^n\\,\\mathbf{Q}^{n+1} = \\mathbf{b}^n$. By comparing the terms, we can identify the explicit expressions for the matrix $\\mathbf{A}^n$ and the vector $\\mathbf{b}^n$:\n\nThe right-hand side vector $\\mathbf{b}^n$ is simply the known connector vector at time $t^n$:\n$$\n\\mathbf{b}^n \\;=\\; \\mathbf{Q}^n\n$$\n\nThe left-hand side matrix $\\mathbf{A}^n$ can be expressed by grouping the terms multiplying the identity matrix $\\mathbf{I}$:\n$$\n\\mathbf{A}^n \\;=\\; \\left(1 + \\frac{\\Delta t}{1-\\|\\mathbf{Q}^n\\|^2}\\right)\\mathbf{I} - \\Delta t\\,\\boldsymbol{\\kappa}^{n+1}\n$$\n\nWith these expressions for $\\mathbf{A}^n$ and $\\mathbf{b}^n$, one can assemble the $3 \\times 3$ linear system at each time step $n$ and solve for $\\mathbf{Q}^{n+1}$. This constitutes the complete algorithm for one step of the simulation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the updated connector vector Q^{n+1} for a FENE dumbbell\n    using a semi-implicit method for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (delta_t, kappa_matrix, Q_n_vector)\n    test_cases = [\n        (0.1, np.array([[0, 1, 0], [0, 0, 0], [0, 0, 0]], dtype=float), np.array([0.2, 0.1, 0.0], dtype=float)),\n        (0.1, np.array([[1, 0, 0], [0, -1, 0], [0, 0, 0]], dtype=float), np.array([0.99, 0.0, 0.0], dtype=float)),\n        (0.1, np.array([[0, 0, 0], [0, 0, 0], [0, 0, 0]], dtype=float), np.array([0.7, -0.2, 0.1], dtype=float)),\n        (0.05, np.array([[3, 0, 0], [0, -3, 0], [0, 0, 0]], dtype=float), np.array([0.05, 0.02, 0.0], dtype=float)),\n        (1.0, np.array([[0, 0, 0], [0, 0, 0], [0, 0, 0]], dtype=float), np.array([0.95, 0.0, 0.0], dtype=float)),\n    ]\n\n    results = []\n    \n    # Identity matrix in 3D\n    I = np.identity(3)\n\n    for dt, kappa, Qn in test_cases:\n        # Calculate the squared norm of Q^n. The maximum extension Q_0 is 1.\n        Qn_sq_norm = np.dot(Qn, Qn)\n\n        # Handle the case where ||Q^n||^2 = 1, which is physically unallowed\n        # and would make the spring force term singular.\n        if Qn_sq_norm = 1.0:\n            # This case should not occur with valid inputs but is a safeguard.\n            # For this problem's context, we know inputs are valid.\n            pass\n\n        # Calculate the scalar coefficient for the spring term, S^n\n        Sn = 1.0 / (1.0 - Qn_sq_norm)\n\n        # Assemble the matrix A^n for the linear system A^n * Q^{n+1} = b^n\n        # A^n = (1 + dt * S^n) * I - dt * kappa^{n+1}\n        # kappa is assumed constant over the time step, so kappa^{n+1} = kappa.\n        A_n = (1.0 + dt * Sn) * I - dt * kappa\n\n        # The vector b^n is simply Q^n\n        b_n = Qn\n\n        # Solve the linear system for Q^{n+1}\n        Q_n_plus_1 = np.linalg.solve(A_n, b_n)\n        \n        results.append(Q_n_plus_1)\n\n    # Format the final output according to the specified format.\n    # \"[[x_1,y_1,z_1],[x_2,y_2,z_2],...]\" with no spaces.\n    output_parts = []\n    for res in results:\n        component_strs = [f\"{c:.8f}\" for c in res]\n        inner_content = \",\".join(component_strs)\n        output_parts.append(f\"[{inner_content}]\")\n    \n    all_results_str = \",\".join(output_parts)\n    final_output = f\"[{all_results_str}]\"\n\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}