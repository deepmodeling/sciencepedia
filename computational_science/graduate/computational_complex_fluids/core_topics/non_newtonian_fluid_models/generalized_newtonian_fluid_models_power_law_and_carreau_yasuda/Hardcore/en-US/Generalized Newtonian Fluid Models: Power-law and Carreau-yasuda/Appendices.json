{
    "hands_on_practices": [
        {
            "introduction": "Before we can confidently use a physical model, we must confirm that it is dimensionally consistent. This fundamental practice guides you through the use of dimensional analysis to determine the physical dimensions of the parameters in both the power-law and Carreau-Yasuda models. This exercise will solidify your understanding of how these parameters are defined and ensures that the equations make physical sense, a crucial first step in any modeling endeavor.",
            "id": "4089113",
            "problem": "Consider a generalized Newtonian fluid (GNF) under steady simple shear. The Cauchy stress splits into an isotropic pressure and a deviatoric part, and the deviatoric stress in a GNF is proportional to the rate-of-deformation tensor. In simple shear at rate $\\dot{\\gamma}$, the shear stress $\\tau$ is proportional to $\\dot{\\gamma}$. In the power-law model, the effective viscosity is assumed to follow a shear-rate dependence, and the Carreau–Yasuda (CY) model gives a widely used parametrization for the viscosity as a function of $\\dot{\\gamma}$. Work from these bases to determine the dimensional constraints on the model parameters.\n\nUsing dimensional analysis and starting from the facts that shear stress has International System of Units (SI) units of pascals, shear rate has SI units of inverse seconds, and viscosity has SI units of pascal-seconds, do the following:\n\n1. Starting from the proportionality of shear stress to viscosity and shear rate in simple shear, deduce the SI units of viscosity.\n2. For the power-law relation between shear stress and shear rate, deduce the dimensions of the consistency index $K$ and assess whether the flow behavior index $n$ carries any dimensions.\n3. For the Carreau–Yasuda viscosity function\n$$\n\\eta(\\dot{\\gamma}) = \\eta_{\\infty} + \\big(\\eta_{0} - \\eta_{\\infty}\\big)\\left[1 + \\big(\\lambda\\,\\dot{\\gamma}\\big)^{a}\\right]^{\\frac{n-1}{a}},\n$$\nuse dimensional consistency to infer the dimensions of $\\lambda$ and whether $a$ and $n$ carry any dimensions. Confirm that your conclusions are consistent with part 2.\n\nReport your final result as the three base-dimension exponents on mass $M$, length $L$, and time $T$ for $K$, followed by the three base-dimension exponents on $M$, $L$, and $T$ for $n$, in a single row matrix. No numerical rounding is required. Do not include units in your final answer; only report the exponents as symbolic integers or expressions.",
            "solution": "We begin from fundamental kinematics and constitutive structure. In a simple shear flow with velocity field $u_{x}(y) = \\dot{\\gamma}\\,y$, the symmetric rate-of-deformation tensor $D$ has a single nonzero component $D_{xy} = D_{yx} = \\frac{1}{2}\\,\\dot{\\gamma}$. The generalized Newtonian fluid (GNF) assumes a deviatoric stress proportional to $D$ with an effective viscosity $\\eta(\\dot{\\gamma})$:\n$$\n\\tau_{xy} = 2\\,\\eta(\\dot{\\gamma})\\,D_{xy} = \\eta(\\dot{\\gamma})\\,\\dot{\\gamma}.\n$$\nThis relationship is the foundational base linking shear stress, viscosity, and shear rate.\n\n1. Units of viscosity. Shear stress $\\tau$ has SI units of pascals, and shear rate $\\dot{\\gamma}$ has SI units of inverse seconds:\n$$\n[\\tau] = \\mathrm{Pa}, \\qquad [\\dot{\\gamma}] = \\mathrm{s}^{-1}.\n$$\nFrom $\\tau = \\eta\\,\\dot{\\gamma}$, the units of viscosity follow:\n$$\n[\\eta] = \\frac{[\\tau]}{[\\dot{\\gamma}]} = \\frac{\\mathrm{Pa}}{\\mathrm{s}^{-1}} = \\mathrm{Pa}\\cdot\\mathrm{s}.\n$$\nIn base dimensions, $\\mathrm{Pa} = \\mathrm{N}\\,\\mathrm{m}^{-2} = \\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-2}$, so\n$$\n[\\eta] = \\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1} = M\\,L^{-1}\\,T^{-1}.\n$$\n\n2. Power-law relation and dimensions of $K$ and $n$. In the power-law model, the effective viscosity is a function of shear rate of the form\n$$\n\\eta_{\\mathrm{eff}}(\\dot{\\gamma}) = K\\,\\dot{\\gamma}^{\\,n-1},\n$$\nwhich, when substituted into $\\tau = \\eta_{\\mathrm{eff}}\\,\\dot{\\gamma}$, yields the commonly used shear stress relation\n$$\n\\tau = K\\,\\dot{\\gamma}^{\\,n}.\n$$\nDimensional consistency requires\n$$\n[\\tau] = [K]\\,[\\dot{\\gamma}]^{n}.\n$$\nUsing $[\\tau] = \\mathrm{Pa}$ and $[\\dot{\\gamma}] = \\mathrm{s}^{-1}$, we obtain\n$$\n\\mathrm{Pa} = [K]\\left(\\mathrm{s}^{-1}\\right)^{n} \\quad\\Rightarrow\\quad [K] = \\mathrm{Pa}\\cdot\\mathrm{s}^{\\,n}.\n$$\nTranslating to base dimensions, since $\\mathrm{Pa} = M\\,L^{-1}\\,T^{-2}$,\n$$\n[K] = M\\,L^{-1}\\,T^{-2}\\cdot T^{\\,n} = M\\,L^{-1}\\,T^{\\,n-2}.\n$$\nFor $\\tau$ to maintain fixed physical units independent of the choice of time unit scaling, the exponent $n$ cannot carry any dimensions; otherwise, the exponentiation of $\\mathrm{s}^{-1}$ by a dimensional quantity would be ill-posed. Therefore, $n$ must be dimensionless, which we denote as\n$$\n[n] = 1 \\quad\\text{(dimensionless)} \\quad\\text{or equivalently}\\quad M^{0}\\,L^{0}\\,T^{0}.\n$$\n\n3. Carreau–Yasuda model and dimensions of $\\lambda$, $a$, and $n$. The Carreau–Yasuda (CY) model is\n$$\n\\eta(\\dot{\\gamma}) = \\eta_{\\infty} + \\big(\\eta_{0} - \\eta_{\\infty}\\big)\\left[1 + \\big(\\lambda\\,\\dot{\\gamma}\\big)^{a}\\right]^{\\frac{n-1}{a}},\n$$\nwhere $\\eta(\\dot{\\gamma})$ must have units of viscosity. The bracketed term is added to $1$, so it must be dimensionless:\n$$\n\\big(\\lambda\\,\\dot{\\gamma}\\big)^{a} \\quad\\text{dimensionless}.\n$$\nSince $[\\dot{\\gamma}] = \\mathrm{s}^{-1}$, the factor $\\lambda\\,\\dot{\\gamma}$ must be dimensionless, implying\n$$\n[\\lambda] = \\mathrm{s}, \\qquad [a] = 1 \\quad\\text{(dimensionless)}.\n$$\nThe outer exponent $\\frac{n-1}{a}$ must also be dimensionless to keep the bracketed quantity dimensionless. Because $a$ is dimensionless, it follows that $n-1$ is dimensionless and hence $n$ is dimensionless:\n$$\n[n] = 1 \\quad\\text{(dimensionless)}.\n$$\nThis is consistent with the power-law conclusion. With $n$ dimensionless, the earlier result for $[K]$ in base dimensions, $M\\,L^{-1}\\,T^{\\,n-2}$, is well-defined.\n\nCollecting the requested exponents, we report the base-dimension exponents $(\\alpha_{M}, \\alpha_{L}, \\alpha_{T})$ for $K$ as\n$$\n(\\alpha_{M}, \\alpha_{L}, \\alpha_{T}) = \\big(1,\\,-1,\\,n-2\\big),\n$$\nand for $n$ as\n$$\n(0,\\,0,\\,0).\n$$\nWe present these six exponents in a single row matrix in the order specified: the three for $K$ followed by the three for $n$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1  -1  n-2  0  0  0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "A primary application of constitutive models is to predict fluid behavior in practical scenarios, such as flow through a pipe. In this exercise, you will start from a basic force balance and the power-law model to derive the velocity profile, a classic problem in non-Newtonian fluid mechanics. This practice demonstrates a powerful link between a fluid's microscopic properties, encapsulated by the index $n$, and its macroscopic flow characteristics. ",
            "id": "4089162",
            "problem": "Consider steady, fully developed, axisymmetric, incompressible, laminar flow of a generalized Newtonian fluid in a straight circular pipe of radius $R$ and length $L$ driven by a constant pressure drop $\\Delta p$. Assume no slip at the wall, negligible inertia, and that the fluid obeys the Ostwald–de Waele power-law constitutive equation $\\tau = K \\,\\dot{\\gamma}^{\\,n}$, where $\\tau$ is the shear stress, $\\dot{\\gamma}$ is the magnitude of the shear rate, $K$ is the consistency index, and $n$ is the power-law index. Starting from the mechanical balance for fully developed pipe flow and the constitutive relation, derive the axial velocity field $u(r)$ and use it to compute the mean axial velocity $U_{\\text{mean}}$. Then, express the ratio of the centerline (maximum) velocity to the mean velocity, $u(0)/U_{\\text{mean}}$, purely as a function of the power-law index $n$. Your final answer must be a single closed-form analytic expression and is dimensionless; do not round.\n\nBriefly interpret how this ratio reflects the bluntness of the velocity profile as $n$ varies. In your derivation, begin only from the radial shear stress distribution implied by force balance in fully developed pipe flow and the given constitutive law. Do not use any pre-derived velocity profile formulas. For context, the Carreau–Yasuda model reduces to an effective power-law over an intermediate shear-rate range; your expression therefore characterizes the bluntness in that regime via the effective index $n$.",
            "solution": "The problem is well-posed and scientifically grounded in the principles of non-Newtonian fluid mechanics. We can proceed with the derivation.\n\nThe starting point is the mechanical (force) balance for steady, fully developed, axisymmetric flow in a cylindrical pipe. Consider a cylindrical fluid element of radius $r$ and length $L$. The flow is driven by a constant pressure drop $\\Delta p$ over the length $L$. For steady flow, the net force on this element is zero. The pressure force acting in the direction of flow is $\\Delta p (\\pi r^2)$. This is balanced by the shear force exerted by the surrounding fluid on the cylindrical surface, which acts in the opposite direction. The magnitude of this shear force is $\\tau \\cdot (2\\pi r L)$, where $\\tau$ is the magnitude of the shear stress at radius $r$.\n\nThe force balance equation is:\n$$\n\\Delta p \\cdot \\pi r^2 = \\tau \\cdot 2\\pi r L\n$$\nSolving for the shear stress magnitude $\\tau$ as a function of the radial position $r$ yields the linear shear stress distribution:\n$$\n\\tau(r) = \\frac{\\Delta p}{2L} r\n$$\nThis shows that the shear stress is zero at the centerline ($r=0$) and maximum at the pipe wall ($r=R$).\n\nNext, we introduce the constitutive equation for the Ostwald–de Waele power-law fluid, which relates the shear stress magnitude $\\tau$ to the shear rate magnitude $\\dot{\\gamma}$:\n$$\n\\tau = K \\dot{\\gamma}^n\n$$\nwhere $K$ is the consistency index and $n$ is the power-law index.\n\nFor unidirectional flow in a pipe, the velocity vector is $\\mathbf{u} = u(r) \\mathbf{\\hat{e}}_z$, and the only non-zero component of the velocity gradient is $\\frac{du}{dr}$. The magnitude of the rate of deformation tensor, or the shear rate $\\dot{\\gamma}$, is given by:\n$$\n\\dot{\\gamma} = \\left| \\frac{du}{dr} \\right|\n$$\nSince the velocity is maximum at the centerline ($r=0$) and zero at the wall ($r=R$) due to the no-slip condition, the velocity gradient $\\frac{du}{dr}$ must be non-positive for $r \\in [0, R]$. Therefore, we can write:\n$$\n\\dot{\\gamma} = -\\frac{du}{dr}\n$$\nNow, we equate the expression for shear stress from the force balance with the constitutive equation:\n$$\n\\frac{\\Delta p}{2L} r = K \\left(-\\frac{du}{dr}\\right)^n\n$$\nWe can solve for the velocity gradient $\\frac{du}{dr}$:\n$$\n-\\frac{du}{dr} = \\left( \\frac{\\Delta p}{2LK} r \\right)^{1/n} = \\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} r^{1/n}\n$$\n$$\n\\frac{du}{dr} = - \\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} r^{1/n}\n$$\nTo find the velocity profile $u(r)$, we integrate this expression with respect to $r$:\n$$\nu(r) = \\int -\\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} r^{1/n} \\, dr = -\\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\frac{r^{1/n + 1}}{1/n + 1} + C\n$$\n$$\nu(r) = -\\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\left(\\frac{n}{n+1}\\right) r^{(n+1)/n} + C\n$$\nwhere $C$ is the constant of integration. We determine $C$ by applying the no-slip boundary condition at the pipe wall, $u(R)=0$:\n$$\n0 = -\\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\left(\\frac{n}{n+1}\\right) R^{(n+1)/n} + C\n$$\n$$\nC = \\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\left(\\frac{n}{n+1}\\right) R^{(n+1)/n}\n$$\nSubstituting this back into the expression for $u(r)$, we obtain the axial velocity profile:\n$$\nu(r) = \\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\left(\\frac{n}{n+1}\\right) \\left( R^{(n+1)/n} - r^{(n+1)/n} \\right)\n$$\nThe centerline velocity, $u(0)$, is the maximum velocity, obtained by setting $r=0$:\n$$\nu(0) = u_{\\text{max}} = \\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\left(\\frac{n}{n+1}\\right) R^{(n+1)/n}\n$$\nNow, we compute the mean axial velocity, $U_{\\text{mean}}$. It is defined as the volumetric flow rate $Q$ divided by the cross-sectional area $A = \\pi R^2$. The flow rate $Q$ is found by integrating the velocity profile over the cross-sectional area:\n$$\nQ = \\int_{A} u(r) \\, dA = \\int_0^R u(r) (2\\pi r) \\, dr\n$$\nIt is convenient to express $u(r)$ in terms of $u(0)$:\n$$\nu(r) = u(0) \\left( 1 - \\left(\\frac{r}{R}\\right)^{(n+1)/n} \\right)\n$$\nSubstituting this into the integral for $Q$:\n$$\nQ = 2\\pi \\int_0^R u(0) \\left( 1 - \\frac{r^{(n+1)/n}}{R^{(n+1)/n}} \\right) r \\, dr = 2\\pi u(0) \\int_0^R \\left( r - \\frac{r^{1+(n+1)/n}}{R^{(n+1)/n}} \\right) \\, dr\n$$\nThe exponent in the second term is $1 + \\frac{n+1}{n} = \\frac{2n+1}{n}$.\n$$\nQ = 2\\pi u(0) \\left[ \\frac{r^2}{2} - \\frac{1}{R^{(n+1)/n}} \\frac{r^{(2n+1)/n + 1}}{(2n+1)/n + 1} \\right]_0^R\n$$\nThe exponent in the denominator is $\\frac{2n+1}{n}+1 = \\frac{3n+1}{n}$.\n$$\nQ = 2\\pi u(0) \\left( \\frac{R^2}{2} - \\frac{1}{R^{(n+1)/n}} \\frac{R^{(3n+1)/n}}{(\\frac{3n+1}{n})} \\right) = 2\\pi u(0) \\left( \\frac{R^2}{2} - \\frac{n}{3n+1} R^2 \\right)\n$$\n$$\nQ = 2\\pi u(0) R^2 \\left( \\frac{1}{2} - \\frac{n}{3n+1} \\right) = 2\\pi u(0) R^2 \\left( \\frac{(3n+1) - 2n}{2(3n+1)} \\right) = 2\\pi u(0) R^2 \\left( \\frac{n+1}{2(3n+1)} \\right)\n$$\nThe mean velocity is $U_{\\text{mean}} = \\frac{Q}{A} = \\frac{Q}{\\pi R^2}$:\n$$\nU_{\\text{mean}} = \\frac{2\\pi u(0) R^2 \\left( \\frac{n+1}{2(3n+1)} \\right)}{\\pi R^2} = u(0) \\frac{n+1}{3n+1}\n$$\nFinally, we compute the ratio of the centerline velocity to the mean velocity:\n$$\n\\frac{u(0)}{U_{\\text{mean}}} = \\frac{u(0)}{u(0) \\frac{n+1}{3n+1}} = \\frac{3n+1}{n+1}\n$$\nThis ratio provides a measure of the bluntness of the velocity profile.\nFor a Newtonian fluid, $n=1$, and the ratio is $\\frac{3(1)+1}{1+1} = \\frac{4}{2}=2$, which is the classic result for a parabolic profile in Hagen-Poiseuille flow.\nFor a shear-thinning fluid ($n1$), the velocity profile becomes blunter (flatter). As $n \\rightarrow 0$, the ratio $\\frac{u(0)}{U_{\\text{mean}}} \\rightarrow 1$, which corresponds to the limit of plug flow, where the velocity is uniform across the pipe cross-section except for a very thin layer at the wall.\nFor a shear-thickening fluid ($n1$), the velocity profile becomes sharper (more peaked) than a parabola. As $n \\rightarrow \\infty$, the ratio $\\frac{u(0)}{U_{\\text{mean}}} \\rightarrow \\frac{3n}{n} = 3$.\nTherefore, a smaller value of $n$ corresponds to a blunter velocity profile, as is characteristic of the power-law regime for many complex fluids like those described by the Carreau-Yasuda model.",
            "answer": "$$\n\\boxed{\\frac{3n+1}{n+1}}\n$$"
        },
        {
            "introduction": "The predictive power of models like the power-law relies on accurately determining their parameters, which are material-specific properties found through experiments. This computational exercise walks you through the standard rheological practice of fitting the consistency index $K$ and power-law index $n$ to experimental data. By transforming the nonlinear model into a linear one suitable for regression, you will learn a core skill for bridging theoretical models with real-world measurements. ",
            "id": "4089183",
            "problem": "You are tasked with designing and implementing a robust estimation method for the parameters of a generalized Newtonian fluid that exhibits power-law behavior over specified shear-rate windows. Begin from the base constitutive representation for generalized Newtonian fluids in simple shear, where the shear stress magnitude satisfies $|\\tau| = \\eta(\\dot{\\gamma})\\,|\\dot{\\gamma}|$, with $|\\cdot|$ denoting magnitude and $\\eta(\\dot{\\gamma})$ the apparent viscosity. Assume that, in certain regimes, the apparent viscosity scales with shear rate such that its logarithm is an affine function of $\\log |\\dot{\\gamma}|$. You must derive an algorithm that transforms the problem into a linear regression in logarithmic variables and then estimate a coefficient and an exponent that characterize the fluid’s power-law behavior. Your algorithm must:\n- Use the natural logarithm,\n- Operate on magnitudes $|\\tau|$ and $|\\dot{\\gamma}|$,\n- Exclude any pairs where $|\\tau| \\le 0$ or $|\\dot{\\gamma}| \\le 0$ prior to taking logarithms,\n- Solve the resulting linear least-squares problem to obtain an intercept and a slope,\n- Recover the coefficient and exponent from the intercept and slope,\n- Interpret the recovered coefficient as having units of Pascal times second raised to the exponent (Pa·s$^n$), and the exponent as dimensionless.\n\nYou are given the following test suite of data sets. Each data set is a list of measured pairs $(\\tau_i,\\dot{\\gamma}_i)$ with shear stress in Pascal (Pa) and shear rate in reciprocal seconds ($\\mathrm{s}^{-1}$). Your program must estimate, for each data set, the pair $(K,n)$ where $K$ has units Pa·s$^n$ and $n$ is dimensionless, by performing ordinary least squares on the transformed variables. Use the following five data sets:\n\n- Case A (boundary case, nearly Newtonian behavior): shear rates $[1,2,4,8]$ $\\mathrm{s}^{-1}$ and measured stresses $[5,10,20,40]$ $\\mathrm{Pa}$.\n- Case B (shear-thinning power-law, noiseless): shear rates $[0.1,0.2,0.5,1,2,5,10]$ $\\mathrm{s}^{-1}$ and measured stresses $[0.632455532,0.894427191,1.414213562,2.0,2.828427125,4.472135955,6.32455532]$ $\\mathrm{Pa}$.\n- Case C (shear-thickening power-law, moderate rates): shear rates $[0.2,0.5,1,2,5]$ $\\mathrm{s}^{-1}$ and measured stresses $[0.1086,0.3265,0.75,1.7230,5.1739]$ $\\mathrm{Pa}$.\n- Case D (signed rates and stresses, including zeros; fit must be performed using magnitudes and excluding nonpositive values): shear rates $[0,-1,1,2,-3,4]$ $\\mathrm{s}^{-1}$ and measured stresses $[0,-1.5,1.5,2.610,-3.612,4.546]$ $\\mathrm{Pa}$.\n- Case E (Carreau–Yasuda behavior in an intermediate shear-rate window, to be approximated by a local power-law): use the Carreau–Yasuda viscosity model\n$$\n\\eta(\\dot{\\gamma}) = \\eta_{\\infty} + \\left(\\eta_0 - \\eta_{\\infty}\\right)\\left[1 + (\\lambda\\,\\dot{\\gamma})^{a}\\right]^{\\frac{n-1}{a}},\n$$\nwith parameters $\\eta_0 = 50$ $\\mathrm{Pa\\cdot s}$, $\\eta_{\\infty} = 1$ $\\mathrm{Pa\\cdot s}$, $\\lambda = 0.3$ $\\mathrm{s}$, $a = 2$, $n = 0.3$, and shear rates $[2,3,5,8,12]$ $\\mathrm{s}^{-1}$. Compute the corresponding stresses as $\\tau_i = \\eta(\\dot{\\gamma}_i)\\,\\dot{\\gamma}_i$ (in $\\mathrm{Pa}$), and then fit the effective $(K,n)$ over this window via the same log-linear method.\n\nYour program must implement the regression method and produce estimates $(K,n)$ for each case. Express $K$ in $\\mathrm{Pa\\cdot s}^n$ and $n$ as dimensionless floating-point numbers. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with the flattened ordering $[K_A,n_A,K_B,n_B,K_C,n_C,K_D,n_D,K_E,n_E]$, where each $K_{\\cdot}$ and $n_{\\cdot}$ is a float.\n\nAngles do not appear in this problem. There are physical units; you must respect them and output $K$ in $\\mathrm{Pa\\cdot s}^n$ and $n$ dimensionless, as specified. No percentages are involved in this problem, and no random numbers are to be used.",
            "solution": "The problem requires the estimation of power-law fluid model parameters, the consistency index $K$ and the flow behavior index $n$, from sets of shear stress ($\\tau$) and shear rate ($\\dot{\\gamma}$) data. This is achieved by transforming the governing constitutive equation into a linear form and applying the method of ordinary least squares.\n\nThe power-law model, a specific instance of a generalized Newtonian fluid model, relates the magnitudes of shear stress and shear rate as follows:\n$$|\\tau| = K |\\dot{\\gamma}|^n$$\nwhere $K$ is the consistency index with units of $\\mathrm{Pa \\cdot s^n}$, and $n$ is the dimensionless flow behavior index. A fluid is categorized as shear-thinning if $n  1$, Newtonian if $n = 1$, and shear-thickening if $n  1$.\n\nTo estimate $K$ and $n$ from a set of discrete data points $(\\tau_i, \\dot{\\gamma}_i)$, we first linearize the model equation. The problem specifies the use of the natural logarithm. Taking the natural logarithm of both sides of the equation yields:\n$$ \\ln(|\\tau|) = \\ln(K |\\dot{\\gamma}|^n) $$\nUsing the properties of logarithms, specifically $\\ln(ab) = \\ln(a) + \\ln(b)$ and $\\ln(x^p) = p \\ln(x)$, we can expand the right-hand side:\n$$ \\ln(|\\tau|) = \\ln(K) + n \\ln(|\\dot{\\gamma}|) $$\nThis equation is in the form of a linear equation, $y = c + mx$, where the variables are identified as:\n- $y = \\ln(|\\tau|)$\n- $x = \\ln(|\\dot{\\gamma}|)$\n- $c = \\ln(K)$ (the intercept of the line)\n- $m = n$ (the slope of the line)\n\nThe task thus reduces to performing a linear regression on the transformed data points $(x_i, y_i) = (\\ln(|\\dot{\\gamma}_i|), \\ln(|\\tau_i|))$ to determine the optimal slope $m$ and intercept $c$. Prior to this transformation, any data pairs $(\\tau_i, \\dot{\\gamma}_i)$ for which $|\\tau_i| \\le 0$ or $|\\dot{\\gamma}_i| \\le 0$ must be excluded, as the natural logarithm is undefined for non-positive arguments.\n\nFor a set of $N$ valid, transformed data points $(x_i, y_i)$, the ordinary least-squares method finds the parameters $m$ and $c$ that minimize the sum of the squared residuals, $S$:\n$$ S(m, c) = \\sum_{i=1}^{N} (y_i - (m x_i + c))^2 $$\nThe values of $m$ and $c$ that minimize $S$ can be found by solving the system of normal equations, $\\partial S / \\partial m = 0$ and $\\partial S / \\partial c = 0$. The solutions are:\n$$ m = \\frac{N \\sum(x_i y_i) - (\\sum x_i)(\\sum y_i)}{N \\sum(x_i^2) - (\\sum x_i)^2} $$\n$$ c = \\bar{y} - m\\bar{x} = \\frac{1}{N}\\sum y_i - m \\frac{1}{N}\\sum x_i $$\nNumerically, these values are efficiently computed using standard library functions, such as `numpy.polyfit` in Python, which fits a polynomial of a specified degree to the data; for a line, the degree is $1$.\n\nOnce the slope $m$ and intercept $c$ are obtained from the regression, the physical parameters of the power-law model are recovered:\n- The flow behavior index $n$ is equal to the slope:\n  $$ n = m $$\n- The consistency index $K$ is obtained by exponentiating the intercept:\n  $$ c = \\ln(K) \\implies K = e^c $$\n\nThis procedure is applied to each of the five data sets provided. For Case E, the shear stress values $\\tau_i$ are not given directly but must first be calculated from the provided Carreau-Yasuda model with the given parameters ($\\eta_0$, $\\eta_{\\infty}$, $\\lambda$, $a$, and a model-specific exponent, here denoted $n_{model}$ to avoid confusion with the fitted power-law exponent $n$). The viscosity $\\eta(\\dot{\\gamma}_i)$ is calculated for each shear rate $\\dot{\\gamma}_i$, and the corresponding stress is found using the fundamental relation $\\tau_i = \\eta(\\dot{\\gamma}_i) \\dot{\\gamma}_i$. The resulting $(\\tau_i, \\dot{\\gamma}_i)$ pairs are then used as input for the power-law fitting procedure described above.\nThe algorithmic steps are summarized as:\n1.  For each data set, take the absolute values of all $\\tau_i$ and $\\dot{\\gamma}_i$.\n2.  Filter the data, retaining only pairs where both $|\\tau_i|  0$ and $|\\dot{\\gamma}_i|  0$.\n3.  Apply the natural logarithm to the filtered data to obtain transformed coordinates $x_i = \\ln(|\\dot{\\gamma}_i|)$ and $y_i = \\ln(|\\tau_i|)$.\n4.  Perform a linear least-squares regression on $(x_i, y_i)$ to find the slope $m$ and intercept $c$.\n5.  Compute the power-law parameters as $n = m$ and $K = e^c$.\n6.  Collect the resulting $(K, n)$ pairs for all cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for power-law fluid parameters (K, n) for five different test cases\n    using log-linear regression.\n    \"\"\"\n\n    def estimate_power_law_params(gamma_dot, tau):\n        \"\"\"\n        Estimates power-law parameters K and n from shear rate and shear stress data.\n        \n        Args:\n            gamma_dot (np.ndarray): Array of shear rates (s^-1).\n            tau (np.ndarray): Array of shear stresses (Pa).\n            \n        Returns:\n            tuple: A tuple (K, n) containing the estimated consistency index\n                   (in Pa.s^n) and flow behavior index (dimensionless).\n        \"\"\"\n        gamma_dot = np.asarray(gamma_dot, dtype=float)\n        tau = np.asarray(tau, dtype=float)\n\n        # Work with magnitudes and filter out non-positive values\n        gamma_dot_abs = np.abs(gamma_dot)\n        tau_abs = np.abs(tau)\n\n        valid_mask = (gamma_dot_abs  0)  (tau_abs  0)\n        \n        gamma_dot_filtered = gamma_dot_abs[valid_mask]\n        tau_filtered = tau_abs[valid_mask]\n\n        if len(gamma_dot_filtered)  2:\n            # Not enough data for a linear fit\n            return (np.nan, np.nan)\n\n        # Transform data to log-log scale\n        log_gamma_dot = np.log(gamma_dot_filtered)\n        log_tau = np.log(tau_filtered)\n        \n        # Perform linear regression: log(tau) = n*log(gamma_dot) + log(K)\n        # np.polyfit returns [slope, intercept] for degree 1\n        # slope = n, intercept = log(K)\n        slope, intercept = np.polyfit(log_gamma_dot, log_tau, 1)\n\n        n = slope\n        K = np.exp(intercept)\n\n        return K, n\n    \n    # --- Define Test Cases ---\n\n    # Case A: Nearly Newtonian behavior\n    case_A_gamma_dot = [1, 2, 4, 8]\n    case_A_tau = [5, 10, 20, 40]\n\n    # Case B: Shear-thinning power-law, noiseless\n    case_B_gamma_dot = [0.1, 0.2, 0.5, 1, 2, 5, 10]\n    case_B_tau = [0.632455532, 0.894427191, 1.414213562, 2.0, 2.828427125, 4.472135955, 6.32455532]\n\n    # Case C: Shear-thickening power-law\n    case_C_gamma_dot = [0.2, 0.5, 1, 2, 5]\n    case_C_tau = [0.1086, 0.3265, 0.75, 1.7230, 5.1739]\n\n    # Case D: Signed rates and stresses, with zeros\n    case_D_gamma_dot = [0, -1, 1, 2, -3, 4]\n    case_D_tau = [0, -1.5, 1.5, 2.610, -3.612, 4.546]\n    \n    # Case E: Carreau-Yasuda model approximation\n    eta_0 = 50.0      # Pa.s\n    eta_inf = 1.0     # Pa.s\n    lambda_cy = 0.3   # s\n    a = 2.0           # dimensionless\n    n_cy = 0.3        # dimensionless\n    case_E_gamma_dot = np.array([2, 3, 5, 8, 12], dtype=float)\n    \n    # Calculate stresses for Case E\n    viscosity_cy = eta_inf + (eta_0 - eta_inf) * (1 + (lambda_cy * case_E_gamma_dot)**a)**((n_cy - 1) / a)\n    case_E_tau = viscosity_cy * case_E_gamma_dot\n\n    test_cases = [\n        (case_A_gamma_dot, case_A_tau),\n        (case_B_gamma_dot, case_B_tau),\n        (case_C_gamma_dot, case_C_tau),\n        (case_D_gamma_dot, case_D_tau),\n        (case_E_gamma_dot, case_E_tau),\n    ]\n\n    results = []\n    for gamma_dot_data, tau_data in test_cases:\n        K, n = estimate_power_law_params(gamma_dot_data, tau_data)\n        results.extend([K, n])\n    \n    # Format the output string as required\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}