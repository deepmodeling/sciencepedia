{
    "hands_on_practices": [
        {
            "introduction": "在应用任何物理模型之前，一个关键的初始步骤是验证其量纲一致性。本练习通过量纲分析，旨在巩固您对幂律模型和Carreau-Yasuda模型中参数基本含义的理解。完成此练习将确保您明白这些参数如何与质量、长度和时间等基本物理量相关联，这对于模型的正确实施和结果解读至关重要。",
            "id": "4089113",
            "problem": "考虑处于稳态简单剪切下的广义牛顿流体 (GNF)。柯西应力可分解为各向同性压力和偏应力部分，在 GNF 中，偏应力与形变率张量成正比。在剪切率为 $\\dot{\\gamma}$ 的简单剪切中，剪切应力 $\\tau$ 与 $\\dot{\\gamma}$ 成正比。在幂律模型中，假定有效粘度遵循剪切率依赖性，而 Carreau–Yasuda (CY) 模型为粘度作为 $\\dot{\\gamma}$ 的函数提供了一个广泛使用的参数化形式。基于这些基础，确定模型参数的量纲约束。\n\n使用量纲分析，并从剪切应力的国际单位制 (SI) 单位为帕斯卡，剪切率的 SI 单位为秒的倒数，粘度的 SI 单位为帕斯卡·秒这些事实出发，完成以下任务：\n\n1. 从简单剪切中剪切应力与粘度和剪切率的比例关系出发，推导粘度的 SI 单位。\n2. 对于剪切应力与剪切率之间的幂律关系，推导稠度指数 $K$ 的量纲，并评估流动行为指数 $n$ 是否带有任何量纲。\n3. 对于 Carreau–Yasuda 粘度函数\n$$\n\\eta(\\dot{\\gamma}) = \\eta_{\\infty} + \\big(\\eta_{0} - \\eta_{\\infty}\\big)\\left[1 + \\big(\\lambda\\,\\dot{\\gamma}\\big)^{a}\\right]^{\\frac{n-1}{a}},\n$$\n使用量纲一致性来推断 $\\lambda$ 的量纲，以及 $a$ 和 $n$ 是否带有任何量纲。确认你的结论与第 2 部分一致。\n\n将你的最终结果表示为一个单行矩阵，其中包含 $K$ 的质量 $M$、长度 $L$ 和时间 $T$ 的三个基本量纲指数，后跟 $n$ 的质量 $M$、长度 $L$ 和时间 $T$ 的三个基本量纲指数。无需进行数值四舍五入。最终答案中不要包含单位；仅以符号整数或表达式报告指数。",
            "solution": "我们从基本运动学和本构结构开始。在速度场为 $u_{x}(y) = \\dot{\\gamma}\\,y$ 的简单剪切流中，对称形变率张量 $D$ 只有一个非零分量 $D_{xy} = D_{yx} = \\frac{1}{2}\\,\\dot{\\gamma}$。广义牛顿流体 (GNF) 假定偏应力与 $D$ 成正比，比例系数为有效粘度 $\\eta(\\dot{\\gamma})$：\n$$\n\\tau_{xy} = 2\\,\\eta(\\dot{\\gamma})\\,D_{xy} = \\eta(\\dot{\\gamma})\\,\\dot{\\gamma}.\n$$\n这个关系式是连接剪切应力、粘度和剪切率的基础。\n\n1. 粘度的单位。剪切应力 $\\tau$ 的 SI 单位是帕斯卡，剪切率 $\\dot{\\gamma}$ 的 SI 单位是秒的倒数：\n$$\n[\\tau] = \\mathrm{Pa}, \\qquad [\\dot{\\gamma}] = \\mathrm{s}^{-1}.\n$$\n从 $\\tau = \\eta\\,\\dot{\\gamma}$，可得出粘度的单位：\n$$\n[\\eta] = \\frac{[\\tau]}{[\\dot{\\gamma}]} = \\frac{\\mathrm{Pa}}{\\mathrm{s}^{-1}} = \\mathrm{Pa}\\cdot\\mathrm{s}.\n$$\n用基本量纲表示，$\\mathrm{Pa} = \\mathrm{N}\\,\\mathrm{m}^{-2} = \\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-2}$，因此\n$$\n[\\eta] = \\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1} = M\\,L^{-1}\\,T^{-1}.\n$$\n\n2. 幂律关系及 $K$ 和 $n$ 的量纲。在幂律模型中，有效粘度是剪切率的函数，形式为\n$$\n\\eta_{\\mathrm{eff}}(\\dot{\\gamma}) = K\\,\\dot{\\gamma}^{\\,n-1},\n$$\n将其代入 $\\tau = \\eta_{\\mathrm{eff}}\\,\\dot{\\gamma}$，得到常用的剪切应力关系式\n$$\n\\tau = K\\,\\dot{\\gamma}^{\\,n}.\n$$\n量纲一致性要求\n$$\n[\\tau] = [K]\\,[\\dot{\\gamma}]^{n}.\n$$\n使用 $[\\tau] = \\mathrm{Pa}$ 和 $[\\dot{\\gamma}] = \\mathrm{s}^{-1}$，我们得到\n$$\n\\mathrm{Pa} = [K]\\left(\\mathrm{s}^{-1}\\right)^{n} \\quad\\Rightarrow\\quad [K] = \\mathrm{Pa}\\cdot\\mathrm{s}^{\\,n}.\n$$\n转换为基本量纲，由于 $\\mathrm{Pa} = M\\,L^{-1}\\,T^{-2}$，\n$$\n[K] = M\\,L^{-1}\\,T^{-2}\\cdot T^{\\,n} = M\\,L^{-1}\\,T^{\\,n-2}.\n$$\n为了使 $\\tau$ 保持固定的物理单位，不随时间单位尺度的选择而改变，指数 $n$ 不能带有任何量纲；否则，对 $\\mathrm{s}^{-1}$ 进行有量纲量的幂运算将是不适定的。因此， $n$ 必须是无量纲的，我们记为\n$$\n[n] = 1 \\quad\\text{(无量纲)} \\quad\\text{或等效地}\\quad M^{0}\\,L^{0}\\,T^{0}.\n$$\n\n3. Carreau–Yasuda 模型及 $\\lambda$、$a$ 和 $n$ 的量纲。Carreau–Yasuda (CY) 模型为\n$$\n\\eta(\\dot{\\gamma}) = \\eta_{\\infty} + \\big(\\eta_{0} - \\eta_{\\infty}\\big)\\left[1 + \\big(\\lambda\\,\\dot{\\gamma}\\big)^{a}\\right]^{\\frac{n-1}{a}},\n$$\n其中 $\\eta(\\dot{\\gamma})$ 必须具有粘度的单位。方括号中的项与 1 相加，因此它必须是无量纲的：\n$$\n\\big(\\lambda\\,\\dot{\\gamma}\\big)^{a} \\quad\\text{无量纲}.\n$$\n由于 $[\\dot{\\gamma}] = \\mathrm{s}^{-1}$，因子 $\\lambda\\,\\dot{\\gamma}$ 必须是无量纲的，这意味着\n$$\n[\\lambda] = \\mathrm{s}, \\qquad [a] = 1 \\quad\\text{(无量纲)}.\n$$\n为了保持方括号内的量为无量纲，外层指数 $\\frac{n-1}{a}$ 也必须是无量纲的。因为 $a$ 是无量纲的，所以 $n-1$ 也是无量纲的，因此 $n$ 是无量纲的：\n$$\n[n] = 1 \\quad\\text{(无量纲)}.\n$$\n这与幂律模型的结论一致。当 $n$ 无量纲时，前面得到的 $[K]$ 的基本量纲结果 $M\\,L^{-1}\\,T^{\\,n-2}$ 是良定义的。\n\n收集所要求的指数，我们将 $K$ 的基本量纲指数 $(\\alpha_{M}, \\alpha_{L}, \\alpha_{T})$ 报告为\n$$\n(\\alpha_{M}, \\alpha_{L}, \\alpha_{T}) = \\big(1,\\,-1,\\,n-2\\big),\n$$\n以及 $n$ 的指数为\n$$\n(0,\\,0,\\,0).\n$$\n我们按指定顺序将这六个指数呈现在一个单行矩阵中：先是 $K$ 的三个指数，然后是 $n$ 的三个指数。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1  -1  n-2  0  0  0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "理解本构模型的一个有效方法是观察其在经典流动场景中的预测行为。本练习要求您推导幂律流体在圆管中的速度分布，这是非牛顿流体力学中的一个典型问题。通过计算中心最大速度与平均速度之比，您将对幂律指数$n$如何量化流速剖面的“钝化”程度获得具体而定量的理解，从而将模型参数与可观测的物理效应直接联系起来。",
            "id": "4089162",
            "problem": "考虑在半径为 $R$、长度为 $L$ 的直圆管中，由恒定压降 $\\Delta p$ 驱动的广义牛顿流体的稳态、完全发展、轴对称、不可压缩的层流。假设壁面无滑移，惯性可忽略，且流体遵循 Ostwald–de Waele 幂律本构方程 $\\tau = K \\,\\dot{\\gamma}^{\\,n}$，其中 $\\tau$ 为剪切应力，$\\dot{\\gamma}$ 为剪切速率的大小，$K$ 为稠度系数，$n$ 为幂律指数。从完全发展管流的力学平衡和本构关系出发，推导轴向速度场 $u(r)$，并用它计算平均轴向速度 $U_{\\text{mean}}$。然后，将中心线（最大）速度与平均速度之比 $u(0)/U_{\\text{mean}}$ 表示为仅与幂律指数 $n$ 相关的函数。你的最终答案必须是一个单一的闭式解析表达式，并且是无量纲的；不要进行四舍五入。\n\n简要解释当 $n$ 变化时，该比率如何反映速度剖面的钝化程度。在你的推导中，仅从完全发展管流中的力平衡所隐含的径向剪切应力分布和给定的本构定律出发。不要使用任何预先推导的速度剖面公式。作为背景，Carreau–Yasuda 模型在一个中等剪切速率范围内可简化为一个有效的幂律模型；因此，你的表达式通过有效指数 $n$ 来表征该区间内速度剖面的钝化程度。",
            "solution": "该问题是适定的，并且在非牛顿流体力学原理上具有坚实的科学基础。我们可以开始进行推导。\n\n出发点是圆柱管内稳态、完全发展、轴对称流动的力学（力）平衡。考虑一个半径为 $r$、长度为 $L$ 的圆柱形流体元。流动是由长度 $L$ 上的恒定压降 $\\Delta p$ 驱动的。对于稳态流动，作用在该流体元上的合力为零。沿流动方向作用的压力是 $\\Delta p (\\pi r^2)$。这个力与周围流体施加在圆柱表面上的剪切力相平衡，剪切力沿相反方向作用。该剪切力的大小为 $\\tau \\cdot (2\\pi r L)$，其中 $\\tau$ 是半径 $r$ 处的剪切应力大小。\n\n力平衡方程为：\n$$\n\\Delta p \\cdot \\pi r^2 = \\tau \\cdot 2\\pi r L\n$$\n将剪切应力大小 $\\tau$ 解出为径向位置 $r$ 的函数，得到线性的剪切应力分布：\n$$\n\\tau(r) = \\frac{\\Delta p}{2L} r\n$$\n这表明剪切应力在中心线（$r=0$）处为零，在管壁（$r=R$）处达到最大值。\n\n接下来，我们引入 Ostwald–de Waele 幂律流体的本构方程，它将剪切应力大小 $\\tau$ 与剪切速率大小 $\\dot{\\gamma}$ 联系起来：\n$$\n\\tau = K \\dot{\\gamma}^n\n$$\n其中 $K$ 是稠度系数，$n$ 是幂律指数。\n\n对于管内的单向流，速度矢量为 $\\mathbf{u} = u(r) \\mathbf{\\hat{e}}_z$，速度梯度的唯一非零分量是 $\\frac{du}{dr}$。形变率张量的大小，即剪切速率 $\\dot{\\gamma}$，由下式给出：\n$$\n\\dot{\\gamma} = \\left| \\frac{du}{dr} \\right|\n$$\n由于无滑移条件，速度在中心线（$r=0$）处最大，在壁面（$r=R$）处为零，因此对于 $r \\in [0, R]$，速度梯度 $\\frac{du}{dr}$ 必须是非正的。因此，我们可以写出：\n$$\n\\dot{\\gamma} = -\\frac{du}{dr}\n$$\n现在，我们将力平衡得到的剪切应力表达式与本构方程相等：\n$$\n\\frac{\\Delta p}{2L} r = K \\left(-\\frac{du}{dr}\\right)^n\n$$\n我们可以解出速度梯度 $\\frac{du}{dr}$：\n$$\n-\\frac{du}{dr} = \\left( \\frac{\\Delta p}{2LK} r \\right)^{1/n} = \\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} r^{1/n}\n$$\n$$\n\\frac{du}{dr} = - \\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} r^{1/n}\n$$\n为了求得速度剖面 $u(r)$，我们将此表达式对 $r$ 积分：\n$$\nu(r) = \\int -\\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} r^{1/n} \\, dr = -\\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\frac{r^{1/n + 1}}{1/n + 1} + C\n$$\n$$\nu(r) = -\\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\left(\\frac{n}{n+1}\\right) r^{(n+1)/n} + C\n$$\n其中 $C$ 是积分常数。我们通过应用管壁处的无滑移边界条件 $u(R)=0$ 来确定 $C$：\n$$\n0 = -\\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\left(\\frac{n}{n+1}\\right) R^{(n+1)/n} + C\n$$\n$$\nC = \\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\left(\\frac{n}{n+1}\\right) R^{(n+1)/n}\n$$\n将此代回 $u(r)$ 的表达式，我们得到轴向速度剖面：\n$$\nu(r) = \\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\left(\\frac{n}{n+1}\\right) \\left( R^{(n+1)/n} - r^{(n+1)/n} \\right)\n$$\n中心线速度 $u(0)$ 是最大速度，通过令 $r=0$ 得到：\n$$\nu(0) = u_{\\text{max}} = \\left( \\frac{\\Delta p}{2LK} \\right)^{1/n} \\left(\\frac{n}{n+1}\\right) R^{(n+1)/n}\n$$\n现在，我们计算平均轴向速度 $U_{\\text{mean}}$。它定义为体积流量 $Q$ 除以横截面积 $A = \\pi R^2$。流量 $Q$ 通过对横截面积积分速度剖面得到：\n$$\nQ = \\int_{A} u(r) \\, dA = \\int_0^R u(r) (2\\pi r) \\, dr\n$$\n为了方便计算，我们将 $u(r)$ 用 $u(0)$ 表示：\n$$\nu(r) = u(0) \\left( 1 - \\left(\\frac{r}{R}\\right)^{(n+1)/n} \\right)\n$$\n将此代入 $Q$ 的积分式中：\n$$\nQ = 2\\pi \\int_0^R u(0) \\left( 1 - \\frac{r^{(n+1)/n}}{R^{(n+1)/n}} \\right) r \\, dr = 2\\pi u(0) \\int_0^R \\left( r - \\frac{r^{1+(n+1)/n}}{R^{(n+1)/n}} \\right) \\, dr\n$$\n第二项中的指数是 $1 + \\frac{n+1}{n} = \\frac{2n+1}{n}$。\n$$\nQ = 2\\pi u(0) \\left[ \\frac{r^2}{2} - \\frac{1}{R^{(n+1)/n}} \\frac{r^{(2n+1)/n + 1}}{(2n+1)/n + 1} \\right]_0^R\n$$\n分母中的指数是 $\\frac{2n+1}{n}+1 = \\frac{3n+1}{n}$。\n$$\nQ = 2\\pi u(0) \\left( \\frac{R^2}{2} - \\frac{1}{R^{(n+1)/n}} \\frac{R^{(3n+1)/n}}{(\\frac{3n+1}{n})} \\right) = 2\\pi u(0) \\left( \\frac{R^2}{2} - \\frac{n}{3n+1} R^2 \\right)\n$$\n$$\nQ = 2\\pi u(0) R^2 \\left( \\frac{1}{2} - \\frac{n}{3n+1} \\right) = 2\\pi u(0) R^2 \\left( \\frac{(3n+1) - 2n}{2(3n+1)} \\right) = 2\\pi u(0) R^2 \\left( \\frac{n+1}{2(3n+1)} \\right)\n$$\n平均速度为 $U_{\\text{mean}} = \\frac{Q}{A} = \\frac{Q}{\\pi R^2}$：\n$$\nU_{\\text{mean}} = \\frac{2\\pi u(0) R^2 \\left( \\frac{n+1}{2(3n+1)} \\right)}{\\pi R^2} = u(0) \\frac{n+1}{3n+1}\n$$\n最后，我们计算中心线速度与平均速度的比值：\n$$\n\\frac{u(0)}{U_{\\text{mean}}} = \\frac{u(0)}{u(0) \\frac{n+1}{3n+1}} = \\frac{3n+1}{n+1}\n$$\n这个比率提供了速度剖面钝化程度的度量。\n对于牛顿流体，$n=1$，该比率为 $\\frac{3(1)+1}{1+1} = \\frac{4}{2}=2$，这是 Hagen-Poiseuille 流中抛物线剖面的经典结果。\n对于剪切稀化流体（$n1$），速度剖面变得更钝（更平坦）。当 $n \\rightarrow 0$ 时，比率 $\\frac{u(0)}{U_{\\text{mean}}} \\rightarrow 1$，这对应于平推流的极限情况，此时除了壁面处一个非常薄的层外，整个管道横截面上的速度是均匀的。\n对于剪切增稠流体（$n>1$），速度剖面比抛物线更尖锐（更陡峭）。当 $n \\rightarrow \\infty$ 时，比率 $\\frac{u(0)}{U_{\\text{mean}}} \\rightarrow \\frac{3n}{n} = 3$。\n因此，较小的 $n$ 值对应于更钝的速度剖面，这正是许多复杂流体（如 Carreau-Yasuda 模型所描述的那些）在幂律区的特征。",
            "answer": "$$\n\\boxed{\\frac{3n+1}{n+1}}\n$$"
        },
        {
            "introduction": "理论模型的优劣取决于其描述真实世界现象的能力，而这需要从实验数据中确定模型参数。本计算实践将指导您使用对数-对数线性回归，一种材料表征中的标准技术，将幂律模型与流变数据进行拟合。通过实施该方法，您将学到一项连接理论流体动力学与实际工程应用的关键技能。",
            "id": "4089183",
            "problem": "您的任务是设计并实现一种稳健的方法，用于估计在指定剪切速率窗口内表现出幂律行为的广义牛顿流体的参数。从简单剪切条件下广义牛顿流体的基本本构表达式开始，其中剪切应力大小满足 $|\\tau| = \\eta(\\dot{\\gamma})\\,|\\dot{\\gamma}|$，$|\\cdot|$ 表示大小，$\\eta(\\dot{\\gamma})$ 为表观粘度。假设在某些流态下，表观粘度随剪切速率变化，其对数是 $\\log |\\dot{\\gamma}|$ 的仿射函数。您必须推导一种算法，将问题转化为对数变量的线性回归问题，然后估计一个系数和一个指数来表征流体的幂律行为。您的算法必须：\n- 使用自然对数，\n- 对大小 $|\\tau|$ 和 $|\\dot{\\gamma}|$ 进行操作，\n- 在取对数之前，排除任何 $|\\tau| \\le 0$ 或 $|\\dot{\\gamma}| \\le 0$ 的数据对，\n- 求解得到的线性最小二乘问题以获得截距和斜率，\n- 从截距和斜率中恢复系数和指数，\n- 将恢复的系数解释为单位为帕斯卡乘以秒的指数次方 (Pa·sⁿ)，指数为无量纲。\n\n给定以下测试数据集套件。每个数据集是一个测量数据对 $(\\tau_i,\\dot{\\gamma}_i)$ 的列表，其中剪切应力的单位为帕斯卡 (Pa)，剪切速率的单位为倒数秒 ($\\mathrm{s}^{-1}$)。您的程序必须通过对变换后的变量执行普通最小二乘法，为每个数据集估计数据对 $(K,n)$，其中 $K$ 的单位为 Pa·sⁿ，$n$ 为无量纲。请使用以下五个数据集：\n\n- 情况 A（边界情况，近似牛顿行为）：剪切速率为 $[1,2,4,8]$ $\\mathrm{s}^{-1}$，测量应力为 $[5,10,20,40]$ $\\mathrm{Pa}$。\n- 情况 B（剪切变稀幂律，无噪声）：剪切速率为 $[0.1,0.2,0.5,1,2,5,10]$ $\\mathrm{s}^{-1}$，测量应力为 $[0.632455532,0.894427191,1.414213562,2.0,2.828427125,4.472135955,6.32455532]$ $\\mathrm{Pa}$。\n- 情况 C（剪切增稠幂律，中等速率）：剪切速率为 $[0.2,0.5,1,2,5]$ $\\mathrm{s}^{-1}$，测量应力为 $[0.1086,0.3265,0.75,1.7230,5.1739]$ $\\mathrm{Pa}$。\n- 情况 D（带符号的速率和应力，包含零值；拟合必须使用大小并排除非正值）：剪切速率为 $[0,-1,1,2,-3,4]$ $\\mathrm{s}^{-1}$，测量应力为 $[0,-1.5,1.5,2.610,-3.612,4.546]$ $\\mathrm{Pa}$。\n- 情况 E（在中间剪切速率窗口内的 Carreau–Yasuda 行为，将通过局部幂律进行近似）：使用 Carreau–Yasuda 粘度模型\n$$\n\\eta(\\dot{\\gamma}) = \\eta_{\\infty} + \\left(\\eta_0 - \\eta_{\\infty}\\right)\\left[1 + (\\lambda\\,\\dot{\\gamma})^{a}\\right]^{\\frac{n-1}{a}},\n$$\n参数为 $\\eta_0 = 50$ $\\mathrm{Pa\\cdot s}$，$\\eta_{\\infty} = 1$ $\\mathrm{Pa\\cdot s}$，$\\lambda = 0.3$ $\\mathrm{s}$，$a = 2$，$n = 0.3$，剪切速率为 $[2,3,5,8,12]$ $\\mathrm{s}^{-1}$。计算相应的应力为 $\\tau_i = \\eta(\\dot{\\gamma}_i)\\,\\dot{\\gamma}_i$（单位为 $\\mathrm{Pa}$），然后通过相同的对数线性方法拟合该窗口内的有效 $(K,n)$。\n\n您的程序必须实现回归方法并为每种情况生成估计值 $(K,n)$。将 $K$ 表示为 $\\mathrm{Pa\\cdot s}^n$ 单位，将 $n$ 表示为无量纲浮点数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，其展开顺序为 $[K_A,n_A,K_B,n_B,K_C,n_C,K_D,n_D,K_E,n_E]$，其中每个 $K_{\\cdot}$ 和 $n_{\\cdot}$ 都是浮点数。\n\n此问题不涉及角度。存在物理单位；您必须遵循这些单位，并按规定输出 $K$（单位为 $\\mathrm{Pa\\cdot s}^n$）和无量纲的 $n$。此问题不涉及百分比，也不得使用随机数。",
            "solution": "该问题要求从剪切应力 ($\\tau$) 和剪切速率 ($\\dot{\\gamma}$) 数据集来估计幂律流体模型的参数，即稠度指数 $K$ 和流动行为指数 $n$。这可以通过将控制本构方程转换为线性形式并应用普通最小二乘法来实现。\n\n幂律模型是广义牛顿流体模型的一个特例，它将剪切应力大小和剪切速率大小关联如下：\n$$|\\tau| = K |\\dot{\\gamma}|^n$$\n其中 $K$ 是稠度指数，单位为 $\\mathrm{Pa \\cdot s^n}$，$n$ 是无量纲的流动行为指数。如果 $n  1$，流体被归类为剪切变稀流体；如果 $n = 1$，则为牛顿流体；如果 $n > 1$，则为剪切增稠流体。\n\n为了从一组离散数据点 $(\\tau_i, \\dot{\\gamma}_i)$ 估计 $K$ 和 $n$，我们首先对模型方程进行线性化。问题指定使用自然对数。对等式两边取自然对数，得到：\n$$ \\ln(|\\tau|) = \\ln(K |\\dot{\\gamma}|^n) $$\n利用对数的性质，特别是 $\\ln(ab) = \\ln(a) + \\ln(b)$ 和 $\\ln(x^p) = p \\ln(x)$，我们可以展开右侧：\n$$ \\ln(|\\tau|) = \\ln(K) + n \\ln(|\\dot{\\gamma}|) $$\n该方程具有线性方程 $y = c + mx$ 的形式，其中变量可确定如下：\n- $y = \\ln(|\\tau|)$\n- $x = \\ln(|\\dot{\\gamma}|)$\n- $c = \\ln(K)$（直线的截距）\n- $m = n$（直线的斜率）\n\n因此，任务简化为对变换后的数据点 $(x_i, y_i) = (\\ln(|\\dot{\\gamma}_i|), \\ln(|\\tau_i|))$ 执行线性回归，以确定最佳斜率 $m$ 和截距 $c$。在此变换之前，任何满足 $|\\tau_i| \\le 0$ 或 $|\\dot{\\gamma}_i| \\le 0$ 的数据对 $(\\tau_i, \\dot{\\gamma}_i)$ 都必须排除，因为自然对数对非正参数没有定义。\n\n对于一组 $N$ 个有效的、变换后的数据点 $(x_i, y_i)$，普通最小二乘法找到使残差平方和 $S$ 最小化的参数 $m$ 和 $c$：\n$$ S(m, c) = \\sum_{i=1}^{N} (y_i - (m x_i + c))^2 $$\n使 $S$ 最小化的 $m$ 和 $c$ 的值可以通过求解正规方程组 $\\partial S / \\partial m = 0$ 和 $\\partial S / \\partial c = 0$ 得到。解为：\n$$ m = \\frac{N \\sum(x_i y_i) - (\\sum x_i)(\\sum y_i)}{N \\sum(x_i^2) - (\\sum x_i)^2} $$\n$$ c = \\bar{y} - m\\bar{x} = \\frac{1}{N}\\sum y_i - m \\frac{1}{N}\\sum x_i $$\n在数值计算上，这些值可以使用标准库函数（例如 Python 中的 `numpy.polyfit`）高效地计算，该函数将指定次数的多项式拟合到数据；对于直线，次数为 1。\n\n一旦从回归中获得斜率 $m$ 和截距 $c$，就可以恢复幂律模型的物理参数：\n- 流动行为指数 $n$ 等于斜率：\n  $$ n = m $$\n- 稠度指数 $K$ 通过对截距取指数得到：\n  $$ c = \\ln(K) \\implies K = e^c $$\n\n将此过程应用于所提供的五个数据集中的每一个。对于情况 E，剪切应力值 $\\tau_i$ 不是直接给出的，而是必须首先使用给定的参数（$\\eta_0$、$\\eta_{\\infty}$、$\\lambda$、$a$ 和一个模型特定的指数，此处记为 $n_{model}$ 以避免与拟合的幂律指数 $n$ 混淆）从提供的 Carreau-Yasuda 模型中计算得出。对于每个剪切速率 $\\dot{\\gamma}_i$，计算其粘度 $\\eta(\\dot{\\gamma}_i)$，并使用基本关系 $\\tau_i = \\eta(\\dot{\\gamma}_i) \\dot{\\gamma}_i$ 找到相应的应力。然后将得到的 $(\\tau_i, \\dot{\\gamma}_i)$ 数据对用作上述幂律拟合过程的输入。\n算法步骤总结如下：\n1.  对于每个数据集，取所有 $\\tau_i$ 和 $\\dot{\\gamma}_i$ 的绝对值。\n2.  筛选数据，只保留 $|\\tau_i| > 0$ 和 $|\\dot{\\gamma}_i| > 0$ 的数据对。\n3.  对筛选后的数据应用自然对数，以获得变换后的坐标 $x_i = \\ln(|\\dot{\\gamma}_i|)$ 和 $y_i = \\ln(|\\tau_i|)$。\n4.  对 $(x_i, y_i)$ 执行线性最小二乘回归，以找到斜率 $m$ 和截距 $c$。\n5.  计算幂律参数为 $n = m$ 和 $K = e^c$。\n6.  收集所有情况下的结果 $(K, n)$ 对。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for power-law fluid parameters (K, n) for five different test cases\n    using log-linear regression.\n    \"\"\"\n\n    def estimate_power_law_params(gamma_dot, tau):\n        \"\"\"\n        Estimates power-law parameters K and n from shear rate and shear stress data.\n        \n        Args:\n            gamma_dot (np.ndarray): Array of shear rates (s^-1).\n            tau (np.ndarray): Array of shear stresses (Pa).\n            \n        Returns:\n            tuple: A tuple (K, n) containing the estimated consistency index\n                   (in Pa.s^n) and flow behavior index (dimensionless).\n        \"\"\"\n        gamma_dot = np.asarray(gamma_dot, dtype=float)\n        tau = np.asarray(tau, dtype=float)\n\n        # Work with magnitudes and filter out non-positive values\n        gamma_dot_abs = np.abs(gamma_dot)\n        tau_abs = np.abs(tau)\n\n        valid_mask = (gamma_dot_abs > 0)  (tau_abs > 0)\n        \n        gamma_dot_filtered = gamma_dot_abs[valid_mask]\n        tau_filtered = tau_abs[valid_mask]\n\n        if len(gamma_dot_filtered)  2:\n            # Not enough data for a linear fit\n            return (np.nan, np.nan)\n\n        # Transform data to log-log scale\n        log_gamma_dot = np.log(gamma_dot_filtered)\n        log_tau = np.log(tau_filtered)\n        \n        # Perform linear regression: log(tau) = n*log(gamma_dot) + log(K)\n        # np.polyfit returns [slope, intercept] for degree 1\n        # slope = n, intercept = log(K)\n        slope, intercept = np.polyfit(log_gamma_dot, log_tau, 1)\n\n        n = slope\n        K = np.exp(intercept)\n\n        return K, n\n    \n    # --- Define Test Cases ---\n\n    # Case A: Nearly Newtonian behavior\n    case_A_gamma_dot = [1, 2, 4, 8]\n    case_A_tau = [5, 10, 20, 40]\n\n    # Case B: Shear-thinning power-law, noiseless\n    case_B_gamma_dot = [0.1, 0.2, 0.5, 1, 2, 5, 10]\n    case_B_tau = [0.632455532, 0.894427191, 1.414213562, 2.0, 2.828427125, 4.472135955, 6.32455532]\n\n    # Case C: Shear-thickening power-law\n    case_C_gamma_dot = [0.2, 0.5, 1, 2, 5]\n    case_C_tau = [0.1086, 0.3265, 0.75, 1.7230, 5.1739]\n\n    # Case D: Signed rates and stresses, with zeros\n    case_D_gamma_dot = [0, -1, 1, 2, -3, 4]\n    case_D_tau = [0, -1.5, 1.5, 2.610, -3.612, 4.546]\n    \n    # Case E: Carreau-Yasuda model approximation\n    eta_0 = 50.0      # Pa.s\n    eta_inf = 1.0     # Pa.s\n    lambda_cy = 0.3   # s\n    a = 2.0           # dimensionless\n    n_cy = 0.3        # dimensionless\n    case_E_gamma_dot = np.array([2, 3, 5, 8, 12], dtype=float)\n    \n    # Calculate stresses for Case E\n    viscosity_cy = eta_inf + (eta_0 - eta_inf) * (1 + (lambda_cy * case_E_gamma_dot)**a)**((n_cy - 1) / a)\n    case_E_tau = viscosity_cy * case_E_gamma_dot\n\n    test_cases = [\n        (case_A_gamma_dot, case_A_tau),\n        (case_B_gamma_dot, case_B_tau),\n        (case_C_gamma_dot, case_C_tau),\n        (case_D_gamma_dot, case_D_tau),\n        (case_E_gamma_dot, case_E_tau),\n    ]\n\n    results = []\n    for gamma_dot_data, tau_data in test_cases:\n        K, n = estimate_power_law_params(gamma_dot_data, tau_data)\n        results.extend([K, n])\n    \n    # Format the output string as required\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}