{
    "hands_on_practices": [
        {
            "introduction": "VOF方法的核心在于精确追踪相界面的运动，这本质上是一个求解平流方程的问题。本练习将引导你从最基本的一维纯平流问题入手，理解如何将控制体积分形式的守恒律转化为离散的代数方程。通过这个练习，你将亲手实现一个简单的一阶迎风格式，并验证其在周期性边界条件下能够精确地保持流体体积的守恒性，这是所有VOF方法必须满足的基本要求。",
            "id": "4111784",
            "problem": "考虑一个长度为 $L=1$ m 的一维周期性域，其横截面积均匀为 $A=1$ m$^{2}$，被离散为 $N=4$ 个等宽 $\\Delta x = L/N$ 的控制体积（单元）。使用流体体积（VOF）方法追踪一个被动界面，其中单元平均体积分数 $\\alpha_{i}$ 满足纯平流守恒定律。给定的速度场为常数 $u(x,t) = U = 0.75$ m/s，对所有 $x$ 和所有 $t$ 均成立，并且是无散的。在时间 $t^{n}$，初始体积分数场是每个单元上的分段常数，其中 $\\alpha_{1}^{n} = 1$，$\\alpha_{2}^{n} = 1$，$\\alpha_{3}^{n} = 0$，$\\alpha_{4}^{n} = 0$，并应用周期性索引（因此 $\\alpha_{0}^{n} \\equiv \\alpha_{4}^{n}$ 且 $\\alpha_{5}^{n} \\equiv \\alpha_{1}^{n}$）。在一个时间步长 $\\Delta t = 0.1$ s 内，通过在面上使用分段常数重构和上游选择来评估面积分平流通量（即，由于 $u>0$，面上的平流 $\\alpha$ 等于上游侧的单元值），计算单元 $i=1$ 中体积分数的更新。从守恒定律的积分形式出发，并应用散度定理，推导出产生更新后 $\\alpha_{1}^{n+1}$ 的离散平衡方程，并证明在周期性边界条件和所述通量评估下，离散总量 $\\sum_{i=1}^{N} \\alpha_{i}$ 是精确守恒的。以无量纲数（无单位）的形式报告最终更新的体积分数 $\\alpha_{1}^{n+1}$。无需四舍五入；请提供精确值。",
            "solution": "在尝试求解之前，将对问题进行验证。\n\n### 步骤 1：提取给定条件\n- 域长度：$L=1$ m\n- 横截面积：$A=1$ m$^{2}$\n- 控制体积（单元）数量：$N=4$\n- 单元宽度：$\\Delta x = L/N$\n- 流体属性：通过流体体积（VOF）方法追踪的被动界面\n- VOF 变量：单元平均体积分数 $\\alpha_{i}$\n- 控制方程：纯平流守恒定律\n- 速度场：$u(x,t) = U = 0.75$ m/s（常数）\n- 速度场散度：$\\nabla \\cdot \\mathbf{u} = 0$\n- 时间 $t^{n}$ 的初始条件：$\\alpha_{1}^{n} = 1$，$\\alpha_{2}^{n} = 1$，$\\alpha_{3}^{n} = 0$，$\\alpha_{4}^{n} = 0$\n- 边界条件：周期性，$\\alpha_{0}^{n} \\equiv \\alpha_{4}^{n}$ 且 $\\alpha_{5}^{n} \\equiv \\alpha_{1}^{n}$\n- 时间步长：$\\Delta t = 0.1$ s\n- 数值方法：用于平流通量的分段常数重构和上游选择\n- 任务 1：从积分守恒定律出发，推导 $\\alpha_{1}^{n+1}$ 的离散平衡方程。\n- 任务 2：证明总离散体积分数 $\\sum_{i=1}^{N} \\alpha_{i}$ 是守恒的。\n- 任务 3：计算 $\\alpha_{1}^{n+1}$ 的值。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题是计算流体动力学中一个定义明确的练习，特别关注使用有限体积法对一维线性平流方程进行数值求解。\n- **科学依据：** 该问题基于质量守恒的基本原理，表示为平流方程，这是流体动力学的基石。VOF 方法和一阶迎风格式（分段常数重构与上游选择）是标准且广泛使用的数值技术。\n- **适定性：** 所有必要的参数（$L$, $N$, $A$, $U$, $\\Delta t$）、初始条件、边界条件和数值格式都已明确给出。该设置允许一个唯一的、稳定的解。库朗数 $C = U \\Delta t / \\Delta x = 0.3$ 小于 1，满足该显式格式的稳定性条件。\n- **客观性：** 语言精确且定量，没有主观或含糊的陈述。\n\n该问题不包含科学谬误、矛盾或缺失信息。它代表了偏微分方程数值方法中一个标准的、可形式化的问题。\n\n### 步骤 3：结论与行动\n问题 **有效**。将提供解答。\n\n对于不可压缩流（由无散速度场 $\\nabla \\cdot \\mathbf{u} = 0$ 所暗示），体积分数 $\\alpha$ 受纯平流守恒定律控制：\n$$ \\frac{\\partial \\alpha}{\\partial t} + \\nabla \\cdot (\\mathbf{u} \\alpha) = 0 $$\n在一维情况下，当速度 $U$ 为常数时，该方程简化为：\n$$ \\frac{\\partial \\alpha}{\\partial t} + U \\frac{\\partial \\alpha}{\\partial x} = 0 $$\n为按要求推导离散平衡方程，我们从守恒定律在控制体积 $V_i = A \\Delta x$（从面 $i-1/2$ 处的 $x_{i-1/2}$ 到面 $i+1/2$ 处的 $x_{i+1/2}$）上和时间间隔从 $t^n$ 到 $t^{n+1}$ 上的积分形式开始。\n$$ \\int_{t^n}^{t^{n+1}} \\int_{V_i} \\left( \\frac{\\partial \\alpha}{\\partial t} + \\frac{\\partial (U\\alpha)}{\\partial x} \\right) dV dt = 0 $$\n其中 $dV = A dx$。由于 $A$ 是常数，我们可以写出：\n$$ \\int_{t^n}^{t^{n+1}} \\int_{x_{i-1/2}}^{x_{i+1/2}} A \\left( \\frac{\\partial \\alpha}{\\partial t} + \\frac{\\partial (U\\alpha)}{\\partial x} \\right) dx dt = 0 $$\n对平流项的空间积分应用散度定理（或一维中的微积分基本定理），并交换时间导数项的积分顺序：\n$$ A \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\int_{t^n}^{t^{n+1}} \\frac{\\partial \\alpha}{\\partial t} dt \\right) dx + A \\int_{t^n}^{t^{n+1}} \\left[ (U\\alpha)_{x_{i+1/2}} - (U\\alpha)_{x_{i-1/2}} \\right] dt = 0 $$\n单元平均体积分数定义为 $\\alpha_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\alpha(x,t) dx$。第一项变为：\n$$ A \\int_{x_{i-1/2}}^{x_{i+1/2}} [\\alpha(x, t^{n+1}) - \\alpha(x, t^n)] dx = A \\Delta x (\\alpha_i^{n+1} - \\alpha_i^n) $$\n我们对通量项使用显式欧拉时间积分，在时间 $t^n$ 处评估通量：\n$$ A \\int_{t^n}^{t^{n+1}} \\left[ (U\\alpha)_{i+1/2} - (U\\alpha)_{i-1/2} \\right] dt \\approx A \\Delta t \\left[ (U\\alpha)_{i+1/2}^n - (U\\alpha)_{i-1/2}^n \\right] $$\n结合这些项，得到离散平衡方程：\n$$ A \\Delta x (\\alpha_i^{n+1} - \\alpha_i^n) + A \\Delta t \\left[ (U\\alpha)_{i+1/2}^n - (U\\alpha)_{i-1/2}^n \\right] = 0 $$\n除以常数体积 $V_i = A \\Delta x$：\n$$ \\frac{\\alpha_i^{n+1} - \\alpha_i^n}{\\Delta t} + \\frac{(U\\alpha)_{i+1/2}^n - (U\\alpha)_{i-1/2}^n}{\\Delta x} = 0 $$\n这可以重排以求解 $\\alpha_i^{n+1}$：\n$$ \\alpha_i^{n+1} = \\alpha_i^n - \\frac{\\Delta t}{\\Delta x} \\left[ (U\\alpha)_{i+1/2}^n - (U\\alpha)_{i-1/2}^n \\right] $$\n问题指定了“分段常数重构和上游选择”。由于速度 $U = 0.75$ m/s 为正，所以“上游”方向总是来自索引较小的单元。因此，任何面上的 $\\alpha$ 值都取自其左侧的单元：\n- 在面 $i-1/2$ 处：$\\alpha_{i-1/2}^n = \\alpha_{i-1}^n$\n- 在面 $i+1/2$ 处：$\\alpha_{i+1/2}^n = \\alpha_{i}^n$\n将这些代入通量项中：\n$$ \\alpha_i^{n+1} = \\alpha_i^n - \\frac{\\Delta t}{\\Delta x} \\left[ U\\alpha_{i}^n - U\\alpha_{i-1}^n \\right] $$\n$$ \\alpha_i^{n+1} = \\alpha_i^n - \\frac{U \\Delta t}{\\Delta x} \\left( \\alpha_{i}^n - \\alpha_{i-1}^n \\right) $$\n这就是按要求推导出的离散更新方程（一阶迎风格式）。\n\n接下来，我们证明总离散体积分数是守恒的。我们将更新方程对所有单元从 $i=1$ 到 $N=4$ 求和：\n$$ \\sum_{i=1}^{N} \\alpha_i^{n+1} = \\sum_{i=1}^{N} \\left[ \\alpha_i^n - \\frac{U \\Delta t}{\\Delta x} \\left( \\alpha_{i}^n - \\alpha_{i-1}^n \\right) \\right] $$\n$$ \\sum_{i=1}^{N} \\alpha_i^{n+1} = \\sum_{i=1}^{N} \\alpha_i^n - \\frac{U \\Delta t}{\\Delta x} \\sum_{i=1}^{N} \\left( \\alpha_{i}^n - \\alpha_{i-1}^n \\right) $$\n右边的第二项求和是一个伸缩级数：\n$$ \\sum_{i=1}^{N} \\left( \\alpha_{i}^n - \\alpha_{i-1}^n \\right) = (\\alpha_1^n - \\alpha_0^n) + (\\alpha_2^n - \\alpha_1^n) + \\dots + (\\alpha_N^n - \\alpha_{N-1}^n) = \\alpha_N^n - \\alpha_0^n $$\n应用周期性边界条件 $\\alpha_0^n \\equiv \\alpha_N^n$：\n$$ \\alpha_N^n - \\alpha_0^n = \\alpha_N^n - \\alpha_N^n = 0 $$\n因此，通量差之和为零。守恒方程变为：\n$$ \\sum_{i=1}^{N} \\alpha_i^{n+1} = \\sum_{i=1}^{N} \\alpha_i^n - \\frac{U \\Delta t}{\\Delta x} (0) = \\sum_{i=1}^{N} \\alpha_i^n $$\n这证明了对于周期性边界条件，$\\alpha$ 的总量是精确守恒的。\n\n最后，我们计算 $\\alpha_{1}^{n+1}$ 的值。首先，我们计算所需的参数：\n- 单元宽度：$\\Delta x = \\frac{L}{N} = \\frac{1 \\text{ m}}{4} = 0.25$ m\n- 无量纲库朗数：$C = \\frac{U \\Delta t}{\\Delta x} = \\frac{(0.75 \\text{ m/s})(0.1 \\text{ s})}{0.25 \\text{ m}} = \\frac{0.075}{0.25} = 0.3$\n\n单元 $i=1$ 的更新方程是：\n$$ \\alpha_{1}^{n+1} = \\alpha_{1}^n - C (\\alpha_{1}^n - \\alpha_{0}^n) $$\n使用周期性边界条件，$\\alpha_{0}^n = \\alpha_{4}^n$。代入给定的初始值：\n- $\\alpha_{1}^n = 1$\n- $\\alpha_{0}^n = \\alpha_{4}^n = 0$\n- $C = 0.3$\n我们现在可以计算 $\\alpha_{1}^{n+1}$：\n$$ \\alpha_{1}^{n+1} = 1 - 0.3 \\times (1 - 0) $$\n$$ \\alpha_{1}^{n+1} = 1 - 0.3 $$\n$$ \\alpha_{1}^{n+1} = 0.7 $$",
            "answer": "$$\\boxed{0.7}$$"
        },
        {
            "introduction": "在掌握了VOF场的基本输运后，下一步是在模型中引入关键的物理效应，其中最重要的就是表面张力。在VOF框架中，表面张力通常通过连续表面力（CSF）模型来计算，该模型的核心挑战在于如何从离散的VOF场中准确估计界面曲率 $\\kappa$。本练习旨在通过一个实际的编码任务，让你实现一个基于CSF思想的曲率估计算法，并用它来数值验证静态液滴的杨-拉普拉斯定律 $\\Delta p = \\sigma \\kappa$，从而将抽象的数值方法与真实的物理规律联系起来。",
            "id": "4111830",
            "problem": "考虑一个在二维空间中建模的静态圆形液滴，其气液界面通过流体体积（VOF）方法（Volume of Fluid (VOF)）表示。其主导的界面物理学原理是由表面张力引起的、跨越弯曲界面的法向应力平衡。从流体界面处线性动量守恒推导出的标准跳跃条件以及曲率的定义出发，推导在二维情况下半径为 $R$ 的静态圆形液滴所预期的均匀压力跳跃，然后设计一个数值实验，使用与VOF一致的曲率估计，在指定的容差范围内对其进行验证。\n\n推导必须从以下基本依据开始：\n- 关于跨界面压力跳跃的杨-拉普拉斯关系指出，法向应力的跳跃等于表面张力系数乘以总曲率。在二维空间中，这可以表示为 $\\Delta p = \\sigma \\kappa$，其中 $\\sigma$ 是表面张力系数，$\\kappa$ 是界面的标量曲率。\n- 对于二维平面中的一个圆，其标量曲率为 $\\kappa = \\frac{1}{R}$，其中 $R$ 是液滴的半径。\n\n数值实验必须按如下方式设计：\n- 构建一个边长为 $L_x = L_y$ 的方形域，并用 $N_x \\times N_y$ 个单元的均匀笛卡尔网格进行离散化。将一个半径为 $R$ 的圆形液滴放置在域的中心。将VOF指示函数 $C(x,y)$ 视为液滴相的特征函数，在网格上进行近似。通过对 $C$ 应用局部平滑算子来计算平滑后的VOF场 $C_s$，以模拟实际的VOF曲率计算。\n- 使用连续表面力（CSF）方法（Continuum Surface Force (CSF)），通过在均匀网格上使用一致的中心有限差分计算 $\\kappa \\approx -\\nabla \\cdot \\left( \\frac{\\nabla C_s}{\\lVert \\nabla C_s \\rVert} \\right)$ 来估计曲率。将 $\\kappa$ 的评估限制在由 $C_s$ 上的阈值确定的界面单元上，特别是那些对于指定边界 $c_{\\min}$ 和 $c_{\\max}$ 满足 $C_s \\in (c_{\\min}, c_{\\max})$ 的单元。\n- 对每个界面单元 $i$ 形成数值压力跳跃 $\\Delta p_i = \\sigma \\kappa_i$。在二维中，预期的解析压力跳跃为 $\\Delta p_{\\text{exact}} = \\frac{\\sigma}{R}$。计算界面单元上的最大绝对误差 $E_{\\max} = \\max_i \\lvert \\Delta p_i - \\Delta p_{\\text{exact}} \\rvert$，并将其与给定的容差 $\\tau$ 进行比较。\n- 您的程序必须为每个测试用例返回一个布尔值，指示是否满足 $E_{\\max} \\le \\tau$。所有压力必须以帕斯卡（国际单位制单位）表示，所有距离必须以米表示。曲率的单位必须是 $\\text{m}^{-1}$，因此其与 $\\sigma$ 的乘积单位为帕斯卡。\n\n为以下涵盖一般情况和边界条件的测试套件实现上述过程：\n- 情况 1（正常情况）：$R = 0.25$ $\\text{m}$，$\\sigma = 0.072$ $\\text{N}/\\text{m}$，$N_x = N_y = 256$，$L_x = L_y = 1.0$ $\\text{m}$，容差 $\\tau = 0.10$ $\\text{Pa}$，平滑标准差 $\\varsigma = 1.0$（以网格单元为单位），界面界限 $(c_{\\min}, c_{\\max}) = (0.1, 0.9)$。\n- 情况 2（接近分辨率极限的小液滴）：$R = 0.02$ $\\text{m}$，$\\sigma = 0.072$ $\\text{N}/\\text{m}$，$N_x = N_y = 256$，$L_x = L_y = 1.0$ $\\text{m}$，容差 $\\tau = 1.00$ $\\text{Pa}$，$\\varsigma = 1.0$，$(c_{\\min}, c_{\\max}) = (0.1, 0.9)$。\n- 情况 3（较粗的网格）：$R = 0.25$ $\\text{m}$，$\\sigma = 0.072$ $\\text{N}/\\text{m}$，$N_x = N_y = 64$，$L_x = L_y = 1.0$ $\\text{m}$，容差 $\\tau = 0.20$ $\\text{Pa}$，$\\varsigma = 1.0$，$(c_{\\min}, c_{\\max}) = (0.1, 0.9)$。\n- 情况 4（较大的液滴）：$R = 0.40$ $\\text{m}$，$\\sigma = 0.072$ $\\text{N}/\\text{m}$，$N_x = N_y = 128$，$L_x = L_y = 1.0$ $\\text{m}$，容差 $\\tau = 0.10$ $\\text{Pa}$，$\\varsigma = 1.0$，$(c_{\\min}, c_{\\max}) = (0.1, 0.9)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4]$），其中每个 $result_k$ 是一个布尔值（$\\text{True}$ 或 $\\text{False}$），指示情况 $k$ 的数值实验是否在指定容差内验证了预期的压力跳跃。不允许有其他输出。",
            "solution": "该问题要求推导静态二维圆形界面上的压力跳跃，并设计和实现一个数值实验，以使用基于流体体积（VOF）方法论来验证此结果。\n\n### 理论推导\n\n分析始于流体-流体界面处的动量守恒基本原理。对于静态流体，作用在界面上的力必须处于平衡状态。这种平衡由杨-拉普拉斯方程表示，该方程将跨界面的压力差与表面张力和界面曲率联系起来。\n\n问题给出了二维界面的杨-拉普拉斯关系的具体形式：\n$$\n\\Delta p = \\sigma \\kappa\n$$\n在此，$\\Delta p = p_{\\text{in}} - p_{\\text{out}}$ 是跨界面的压力跳跃（液滴内部压力减去外部压力），$\\sigma$ 是表面张力系数（一种材料属性，单位为力/单位长度，例如 $\\text{N}/\\text{m}$），$\\kappa$ 是界面的局部曲率（单位为长度的倒数，例如 $\\text{m}^{-1}$）。\n\n对于二维平面中半径为 $R$ 的圆，其圆周上所有点的曲率 $\\kappa$ 都是恒定的，并由半径的倒数给出：\n$$\n\\kappa = \\frac{1}{R}\n$$\n将圆的曲率的这个几何定义代入杨-拉普拉斯方程，得到静态二维圆形液滴的预期恒定压力跳跃：\n$$\n\\Delta p_{\\text{exact}} = \\sigma \\left( \\frac{1}{R} \\right) = \\frac{\\sigma}{R}\n$$\n该方程提供了用于与数值结果进行比较的解析基准。它确立了对于静态圆形液滴，其内部压力比外部压力均匀地高出一个量，该量与其半径成反比。\n\n### 数值验证程序\n\n数值实验旨在离散计算网格上复现物理场景，并使用多相流模拟中常用的方法计算压力跳跃。程序如下：\n\n1.  **域和网格离散化**：定义一个物理尺寸为 $L_x \\times L_y$ 的方形计算域。该域被离散化为 $N_x \\times N_y$ 个计算单元的均匀笛卡尔网格。因此，每个方向的网格间距为 $\\Delta x = L_x / N_x$ 和 $\\Delta y = L_y / N_y$。单元中心位于坐标 $(x_i, y_j) = (i\\Delta x, j\\Delta y)$，其中 $i=0, \\dots, N_x-1$，$j=0, \\dots, N_y-1$（对于单元中心格式，有适当的偏移量）。\n\n2.  **VOF场初始化**：界面通过VOF指示函数 $C$ 隐式表示。对于两相系统，$C$ 定义为一个相（例如液滴）占据计算单元体积的比例。对于本问题，我们根据液滴的几何形状将 $C$ 初始化为一个尖锐的特征函数。一个半径为 $R$、中心位于 $(x_c, y_c)$ 的圆形液滴被放置在网格上。每个单元中心 $(x_i, y_j)$ 处的 $C$ 值，如果单元在液滴内部则设为1，如果在外部则设为0：\n    $$\n    C_{i,j} = \\begin{cases} 1  \\text{if } \\sqrt{(x_i - x_c)^2 + (y_j - y_c)^2} \\le R \\\\ 0  \\text{otherwise} \\end{cases}\n    $$\n\n3.  **VOF场平滑**：连续表面力（CSF）方法需要一个平滑的场来计算导数。尖锐的VOF场 $C$ 与一个平滑核（通常是高斯核）进行卷积，以产生一个平滑场 $C_s$。这个过程模拟了界面在几个网格单元上被涂抹（或模糊化）的现象，这是许多VOF平流方案的共同特征。平滑的程度由核的标准差 $\\varsigma$ 控制，其单位为网格单元。\n\n4.  **曲率估计**：曲率 $\\kappa$ 是从平滑后的VOF场 $C_s$ 估计的。首先计算界面法向量 $\\mathbf{n}$，即 $C_s$ 的归一化梯度：\n    $$\n    \\mathbf{n} = \\frac{\\nabla C_s}{\\lVert \\nabla C_s \\rVert}\n    $$\n    然后，曲率被计算为该法向量场的负散度：\n    $$\n    \\kappa \\approx -\\nabla \\cdot \\mathbf{n}\n    $$\n    梯度（$\\nabla$）和散度（$\\nabla \\cdot$）运算都在离散网格上使用二阶中心有限差分格式进行数值计算。对于一个单元 $(i,j)$，梯度分量近似为：\n    $$\n    (\\nabla C_s)_x_ {i,j} \\approx \\frac{(C_s)_{i+1,j} - (C_s)_{i-1,j}}{2 \\Delta x}, \\quad (\\nabla C_s)_y_ {i,j} \\approx \\frac{(C_s)_{i,j+1} - (C_s)_{i,j-1}}{2 \\Delta y}\n    $$\n    类似地，使用中心差分格式计算 $\\mathbf{n}$ 的散度。在分母 $\\lVert \\nabla C_s \\rVert$ 中加入一个小的正则化参数，以防止在 $C_s$ 为常数的区域出现除以零的情况。\n\n5.  **误差分析**：在每个网格单元 $i$ 处，使用估计的曲率计算数值压力跳跃：$\\Delta p_i = \\sigma \\kappa_i$。为了进行有意义的比较，此计算被限制在“界面区域”内，该区域被定义为平滑VOF场 $C_s$ 值位于指定范围 $(c_{\\min}, c_{\\max})$ 内的单元集合。对于该区域中的每个单元 $i$，绝对误差计算为 $| \\Delta p_i - \\Delta p_{\\text{exact}} |$。所有界面单元上这些误差的最大值是用于验证的主要度量：\n    $$\n    E_{\\max} = \\max_{i \\in \\text{interface}} \\lvert \\Delta p_i - \\Delta p_{\\text{exact}} \\rvert\n    $$\n\n6.  **验证**：对于给定的一组参数，如果最大误差 $E_{\\max}$ 不超过规定的容差 $\\tau$，则认为数值方案通过了验证测试：\n    $$\n    E_{\\max} \\le \\tau\n    $$\n该实现将把此程序应用于四个指定的测试用例中的每一个，为每个用例生成一个布尔结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import ndimage\n\ndef solve():\n    \"\"\"\n    Main function to run the VOF curvature verification experiment for all test cases.\n    \"\"\"\n    # (R, sigma, Nx, Ny, Lx, Ly, tau, varsigma, c_min, c_max)\n    test_cases = [\n        # Case 1 (happy path)\n        (0.25, 0.072, 256, 256, 1.0, 1.0, 0.10, 1.0, 0.1, 0.9),\n        # Case 2 (small droplet near resolution limit)\n        (0.02, 0.072, 256, 256, 1.0, 1.0, 1.00, 1.0, 0.1, 0.9),\n        # Case 3 (coarser grid)\n        (0.25, 0.072, 64, 64, 1.0, 1.0, 0.20, 1.0, 0.1, 0.9),\n        # Case 4 (larger droplet)\n        (0.40, 0.072, 128, 128, 1.0, 1.0, 0.10, 1.0, 0.1, 0.9),\n    ]\n\n    results = []\n    for R, sigma, Nx, Ny, Lx, Ly, tau, varsigma, c_min, c_max in test_cases:\n        # Calculate grid spacing\n        dx = Lx / Nx\n        dy = Ly / Ny\n\n        # Create coordinate grid\n        x_coords = np.linspace(dx / 2, Lx - dx / 2, Nx)\n        y_coords = np.linspace(dy / 2, Ly - dy / 2, Ny)\n        x, y = np.meshgrid(x_coords, y_coords)\n\n        # Center of the domain\n        cx, cy = Lx / 2.0, Ly / 2.0\n\n        # 1. Construct the sharp VOF indicator function C\n        C = np.zeros((Ny, Nx))\n        radius_sq = (x - cx)**2 + (y - cy)**2\n        C[radius_sq = R**2] = 1.0\n\n        # 2. Compute the smoothed VOF field Cs\n        # varsigma is given in grid-cell units, which is the expected format for ndimage.gaussian_filter\n        Cs = ndimage.gaussian_filter(C, sigma=varsigma)\n\n        # 3. Estimate curvature using the CSF method\n        \n        # Calculate gradient of Cs\n        # np.gradient returns [d/dy, d/dx] for a 2D array indexed by (y, x)\n        grad_y, grad_x = np.gradient(Cs, dy, dx)\n\n        # Calculate magnitude of the gradient\n        # Add a small epsilon to avoid division by zero\n        grad_mag = np.sqrt(grad_x**2 + grad_y**2)\n        epsilon = 1e-12\n\n        # Calculate the normal vector field n = grad(Cs) / |grad(Cs)|\n        nx = grad_x / (grad_mag + epsilon)\n        ny = grad_y / (grad_mag + epsilon)\n\n        # Calculate the divergence of the normal vector field\n        # div(n) = d(nx)/dx + d(ny)/dy\n        grad_ny_y, _ = np.gradient(ny, dy, dx)\n        _, grad_nx_x = np.gradient(nx, dy, dx)\n        div_n = grad_nx_x + grad_ny_y\n\n        # Curvature is the negative of the divergence\n        kappa = -div_n\n\n        # 4. Form the numerical pressure jump and compute error\n        \n        # Identify interface cells\n        interface_mask = (Cs > c_min)  (Cs  c_max)\n\n        # If no interface cells are found (e.g., in an extreme case), treat as failure.\n        if not np.any(interface_mask):\n            # This indicates an error, likely the droplet is too small or too large\n            # for the interface mask criteria to be met.\n            # An infinite error will always fail the tolerance check unless tau is also inf.\n            E_max = np.inf\n        else:\n            # Calculate numerical pressure jump only at interface cells\n            delta_p_numerical = sigma * kappa[interface_mask]\n            \n            # Calculate the exact analytic pressure jump\n            delta_p_exact = sigma / R\n            \n            # Compute the maximum absolute error\n            E_max = np.max(np.abs(delta_p_numerical - delta_p_exact))\n\n        # 5. Compare against tolerance\n        result = E_max = tau\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在VOF模拟中，将流体输运、粘性效应和表面张力等多种物理机制耦合求解时，数值稳定性成为一个至关重要的问题。对于显式时间积分方案，时间步长 $\\Delta t$ 的选择受到多个条件的严格限制，这些条件分别源于对流、粘性扩散和毛细波的传播。本练习将引导你从第一性原理出发，推导这些关键的稳定性约束，并计算在不同网格尺度下允许的最大时间步长，从而学会判断在特定模拟条件下，哪种物理机制是决定计算效率的瓶颈。",
            "id": "4111814",
            "problem": "一个两相界面通过流体体积（VOF）法进行追踪，其中体积分数场 $f(\\mathbf{x},t)$ 满足运动输运方程 $\\,\\partial f/\\partial t + \\mathbf{u}\\cdot\\nabla f = 0\\,$，并且每个相的不可压缩动量方程是带有用于毛细作用的连续表面力（CSF）模型的纳维-斯托克斯方程。这两个相分别是液体和气体，其密度为 $\\rho_{\\ell}$ 和 $\\rho_{g}$，动力粘度为 $\\mu_{\\ell}$ 和 $\\mu_{g}$，表面张力系数为 $\\sigma$。重力加速度为 $g$。数值格式对所有项均使用显式前向欧拉时间积分，对 $f$ 使用一阶迎风对流，对表面张力使用平衡的CSF离散格式。网格在三维空间中是均匀且各向同性的，由边长为 $\\Delta x$ 的立方单元构成。\n\n给定以下材料属性和数值参数：\n- 液体密度 $\\rho_{\\ell} = 1100$ (SI单位)，气体密度 $\\rho_{g} = 1.2$ (SI单位)，液体粘度 $\\mu_{\\ell} = 3.5\\times 10^{-3}$ (SI单位)，气体粘度 $\\mu_{g} = 1.8\\times 10^{-5}$ (SI单位)，表面张力 $\\sigma = 0.055$ (SI单位)，重力 $g = 9.81$ (SI单位)。\n- 最大解析速度 $\\|\\mathbf{u}\\|_{\\infty} = U_{\\max} = 0.3$ (SI单位)。\n- 两个目标网格：工况 A 的网格尺寸为 $\\Delta x_{A} = 1.0\\times 10^{-4}$ (SI单位)；工况 B 的网格尺寸为 $\\Delta x_{B} = 1.0\\times 10^{-5}$ (SI单位)。\n- 显式对流的稳定性策略：库朗-弗里德里希-路维（CFL）数（定义为 $C = U_{\\max}\\Delta t/\\Delta x$）必须满足 $C \\leq C_{a}$，其中 $C_{a}=0.5$。\n- 波的时间分辨率策略：解析最快的重力-毛细波（在网格的奈奎斯特波数处），每个周期至少使用 $m=4$ 个时间步长。\n\n从第一性原理出发，推导由以下因素引起的限制显式时间步长 $\\Delta t$ 的稳定性约束：\n1. 界面对流。\n2. 动量的粘性扩散。\n3. 两流体界面上的重力-毛细波，使用深水界面色散关系和网格上可解析的最高空间频率。\n\n使用以下基本原理：\n- 带有用于毛细作用的CSF模型的不可压缩纳维-斯托克斯方程。\n- 用于 $f$ 的VOF输运方程。\n- 显式对流的CFL条件。\n- 显式扩散的冯·诺依曼稳定性分析。\n- 两种叠加的深水流体的重力-毛细波色散关系。\n\n计算每种工况（A和B）下，最大稳定显式时间步长 $\\Delta t_{\\max}$，其值为所有导出约束中的最小值。对于每种工况，指出哪种物理机制是速率限制因素。将最终的 $\\Delta t_{\\max}$ 数值以微秒表示，并四舍五入到三位有效数字。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、适定且客观的。所有必要数据均已提供，并且前提与计算流体力学中多相流的既定原则一致。因此，我们可以着手求解。\n\n对于显式数值格式，最大稳定时间步长 $\\Delta t_{\\max}$ 必须同时满足所有稳定性约束。我们将推导由界面对流、粘性扩散和重力-毛细波传播引起的约束。有效的最大时间步长是这些单个约束的最小值：\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{adv}, \\Delta t_{visc}, \\Delta t_{cap})\n$$\n\n给定以下参数：\n液体密度 $\\rho_{\\ell} = 1100\\,\\mathrm{kg/m^3}$\n气体密度 $\\rho_{g} = 1.2\\,\\mathrm{kg/m^3}$\n液体粘度 $\\mu_{\\ell} = 3.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\n气体粘度 $\\mu_{g} = 1.8\\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$\n表面张力系数 $\\sigma = 0.055\\,\\mathrm{N/m}$\n重力加速度 $g = 9.81\\,\\mathrm{m/s^2}$\n最大速度 $U_{\\max} = 0.3\\,\\mathrm{m/s}$\n对流CFL限制 $C_{a} = 0.5$\n波分辨率因子 $m = 4$\n\n工况 A 单元尺寸 $\\Delta x_{A} = 1.0\\times 10^{-4}\\,\\mathrm{m}$\n工况 B 单元尺寸 $\\Delta x_{B} = 1.0\\times 10^{-5}\\,\\mathrm{m}$\n\n**1. 对流约束 ($\\Delta t_{adv}$)**\n体积分数场 $f$ 的对流由输运方程 $\\partial f/\\partial t + \\mathbf{u}\\cdot\\nabla f = 0$ 控制。对于一个显式一阶迎风格式，库朗-弗里德里希-路维（CFL）条件规定了确保稳定性的最大时间步长。问题将CFL数定义为 $C = U_{\\max}\\Delta t/\\Delta x$，并要求 $C \\le C_{a}$。这给出了对流时间步长约束：\n$$\n\\Delta t_{adv} \\le \\frac{C_{a} \\Delta x}{U_{\\max}}\n$$\n代入给定值 $C_a = 0.5$ 和 $U_{\\max} = 0.3$，我们得到：\n$$\n\\Delta t_{adv} \\le \\frac{0.5 \\Delta x}{0.3} = \\frac{5}{3} \\Delta x\n$$\n\n**2. 粘性扩散约束 ($\\Delta t_{visc}$)**\n动量输运（纳维-斯托克斯）方程包含一个粘性扩散项，对于运动粘度为 $\\nu$ 的流体，其形式为 $\\nu \\nabla^2 \\mathbf{u}$。对于此项在三维笛卡尔网格上的显式前向欧拉离散，冯·诺依曼稳定性分析得出以下约束：\n$$\n\\Delta t_{visc} \\le \\frac{(\\Delta x)^2}{2d\\nu} = \\frac{(\\Delta x)^2}{6\\nu}\n$$\n其中 $d=3$ 是空间维度数。在两相系统中，这个条件必须对两种流体都成立。最严格的情况对应于较大的运动粘度，$\\nu_{\\max} = \\max(\\nu_{\\ell}, \\nu_{g})$，其中 $\\nu = \\mu/\\rho$。\n我们来计算运动粘度：\n$$\n\\nu_{\\ell} = \\frac{\\mu_{\\ell}}{\\rho_{\\ell}} = \\frac{3.5\\times 10^{-3}}{1100} \\approx 3.1818 \\times 10^{-6}\\,\\mathrm{m^2/s}\n$$\n$$\n\\nu_{g} = \\frac{\\mu_{g}}{\\rho_{g}} = \\frac{1.8\\times 10^{-5}}{1.2} = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}\n$$\n气体的运动粘度更大，所以 $\\nu_{\\max} = \\nu_{g} = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$。因此，粘性时间步长约束为：\n$$\n\\Delta t_{visc} \\le \\frac{(\\Delta x)^2}{6\\nu_{g}} = \\frac{(\\Delta x)^2}{6 \\times (1.5 \\times 10^{-5})} = \\frac{(\\Delta x)^2}{9 \\times 10^{-5}}\n$$\n\n**3. 重力-毛细波约束 ($\\Delta t_{cap}$)**\n表面张力力的显式处理可能导致与毛细波传播相关的数值不稳定性。问题要求我们将时间步长基于解析最快的界面波。两种深水流体界面上的重力-毛细波的色散关系为：\n$$\n\\omega^2(k) = \\frac{(\\rho_{\\ell} - \\rho_{g}) g k + \\sigma k^3}{\\rho_{\\ell} + \\rho_{g}}\n$$\n其中 $\\omega$ 是角频率，k 是波数。最快的波对应于最高频率，这发生在网格上可解析的最高波数处。这是奈奎斯特波数，$k_{\\max} = \\pi/\\Delta x$。\n最大角频率是：\n$$\n\\omega_{\\max} = \\sqrt{\\frac{(\\rho_{\\ell} - \\rho_{g}) g k_{\\max} + \\sigma k_{\\max}^3}{\\rho_{\\ell} + \\rho_{g}}} = \\sqrt{\\frac{(\\rho_{\\ell} - \\rho_{g}) g (\\pi/\\Delta x) + \\sigma (\\pi/\\Delta x)^3}{\\rho_{\\ell} + \\rho_{g}}}\n$$\n这个最快波的周期是 $T_{\\min} = 2\\pi/\\omega_{\\max}$。策略是用至少 m=4 个时间步长来解析这个周期，所以 $\\Delta t \\le T_{\\min}/m$。\n$$\n\\Delta t_{cap} \\le \\frac{T_{\\min}}{m} = \\frac{2\\pi}{m \\omega_{\\max}} = \\frac{2\\pi}{m} \\sqrt{\\frac{\\rho_{\\ell} + \\rho_{g}}{(\\rho_{\\ell} - \\rho_{g}) g (\\pi/\\Delta x) + \\sigma (\\pi/\\Delta x)^3}}\n$$\n我们使用数值 $\\rho_{\\ell} + \\rho_{g} = 1101.2$ 和 $\\rho_{\\ell} - \\rho_{g} = 1098.8$。\n\n现在我们为每种工况计算这些约束。\n\n**工况 A: $\\Delta x_{A} = 1.0\\times 10^{-4}\\,\\mathrm{m}$**\n\n*   **对流：**\n    $$\n    \\Delta t_{adv, A} \\le \\frac{5}{3} (1.0 \\times 10^{-4}) \\approx 1.667 \\times 10^{-4}\\,\\mathrm{s}\n    $$\n*   **粘性：**\n    $$\n    \\Delta t_{visc, A} \\le \\frac{(1.0 \\times 10^{-4})^2}{9 \\times 10^{-5}} = \\frac{1.0 \\times 10^{-8}}{9 \\times 10^{-5}} \\approx 1.111 \\times 10^{-4}\\,\\mathrm{s}\n    $$\n*   **毛细作用：**\n    $k_{\\max, A} = \\pi / (1.0\\times 10^{-4}) = \\pi \\times 10^4\\,\\mathrm{rad/m}$。\n    $\\omega_{\\max, A}^2$ 分子中的各项为：\n    重力项： $(1098.8)(9.81)(\\pi \\times 10^4) \\approx 3.383 \\times 10^8$\n    毛细项： $(0.055)(\\pi \\times 10^4)^3 \\approx 1.705 \\times 10^{12}$\n    毛细项占主导地位。\n    $$\n    \\omega_{\\max, A}^2 \\approx \\frac{1.705 \\times 10^{12}}{1101.2} \\approx 1.548 \\times 10^9\\,\\mathrm{rad^2/s^2}\n    $$\n    $$\n    \\omega_{\\max, A} \\approx \\sqrt{1.548 \\times 10^9} \\approx 39350\\,\\mathrm{rad/s}\n    $$\n    $$\n    \\Delta t_{cap, A} \\le \\frac{2\\pi}{4 \\times 39350} \\approx 3.991 \\times 10^{-5}\\,\\mathrm{s}\n    $$\n*   **工况 A 的最大时间步长：**\n    $$\n    \\Delta t_{\\max, A} = \\min(1.667 \\times 10^{-4}, 1.111 \\times 10^{-4}, 3.991 \\times 10^{-5}) = 3.991 \\times 10^{-5}\\,\\mathrm{s}\n    $$\n    转换为微秒并四舍五入到三位有效数字，$\\Delta t_{\\max, A} \\approx 39.9\\,\\mathrm{\\mu s}$。\n    对于工况 A，速率限制机制是短波长**毛细波**的传播。\n\n**工况 B: $\\Delta x_{B} = 1.0\\times 10^{-5}\\,\\mathrm{m}$**\n\n*   **对流：**\n    $$\n    \\Delta t_{adv, B} \\le \\frac{5}{3} (1.0 \\times 10^{-5}) \\approx 1.667 \\times 10^{-5}\\,\\mathrm{s}\n    $$\n*   **粘性：**\n    $$\n    \\Delta t_{visc, B} \\le \\frac{(1.0 \\times 10^{-5})^2}{9 \\times 10^{-5}} = \\frac{1.0 \\times 10^{-10}}{9 \\times 10^{-5}} \\approx 1.111 \\times 10^{-6}\\,\\mathrm{s}\n    $$\n*   **毛细作用：**\n    $k_{\\max, B} = \\pi / (1.0\\times 10^{-5}) = \\pi \\times 10^5\\,\\mathrm{rad/m}$。\n    毛细项与 $k^3$ 成比例，而粘性时间步长与 $(\\Delta x)^2 \\propto k^{-2}$ 成比例，毛细时间步长与 $k^{-3/2}$ 成比例。随着网格细化（k 增大），粘性约束相对于毛细约束变得更加严格。\n    $$\n    \\omega_{\\max, B}^2 \\approx \\frac{(0.055)(\\pi \\times 10^5)^3}{1101.2} \\approx 1.548 \\times 10^{12}\\,\\mathrm{rad^2/s^2}\n    $$\n    $$\n    \\omega_{\\max, B} \\approx \\sqrt{1.548 \\times 10^{12}} \\approx 1.244 \\times 10^6\\,\\mathrm{rad/s}\n    $$\n    $$\n    \\Delta t_{cap, B} \\le \\frac{2\\pi}{4 \\times (1.244 \\times 10^6)} \\approx 1.262 \\times 10^{-6}\\,\\mathrm{s}\n    $$\n*   **工况 B 的最大时间步长：**\n    $$\n    \\Delta t_{\\max, B} = \\min(1.667 \\times 10^{-5}, 1.111 \\times 10^{-6}, 1.262 \\times 10^{-6}) = 1.111 \\times 10^{-6}\\,\\mathrm{s}\n    $$\n    转换为微秒并四舍五入到三位有效数字，$\\Delta t_{\\max, B} \\approx 1.11\\,\\mathrm{\\mu s}$。\n    对于工况 B，速率限制机制是**粘性扩散**。与 $(\\Delta x)^2$ 成比例的粘性约束，变得比与 $(\\Delta x)^{3/2}$ 成比例的毛细约束更为严格。\n\n工况 A 和工况 B 的最大稳定时间步长（单位：微秒）的最终答案分别为 $39.9$ 和 $1.11$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 39.9  1.11 \\end{pmatrix}}\n$$"
        }
    ]
}