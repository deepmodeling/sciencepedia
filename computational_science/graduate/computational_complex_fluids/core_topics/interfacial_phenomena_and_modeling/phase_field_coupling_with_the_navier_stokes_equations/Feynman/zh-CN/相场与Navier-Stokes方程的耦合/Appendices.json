{
    "hands_on_practices": [
        {
            "introduction": "在深入研究相场与纳维-斯托克斯方程耦合的数值模拟之前，首要的一步是理解其内在的物理尺度和控制参数。通过对控制方程进行无量纲化，我们可以揭示出决定系统行为的关键物理平衡，例如惯性力与粘性力、粘性力与表面张力之间的竞争。这项实践将引导你完成这一基本分析过程，推导出雷诺数（$Re$）、毛细数（$Ca$）等重要的无量纲数，并理解它们所定义的各种物理机制。",
            "id": "4099031",
            "problem": "考虑一个二元不可压缩流体混合物的等温扩散界面公式（通常称为H模型），该模型由不可压缩Navier–Stokes动量平衡方程和守恒序参数的Cahn–Hilliard方程耦合而成。设 $x \\in \\mathbb{R}^d$, $t \\ge 0$，速度场为 $u(x,t)$，压力为 $p(x,t)$，序参数为 $\\phi(x,t)$，其体相在 $\\phi \\approx \\pm 1$ 附近。控制量纲方程为\n$$\n\\nabla \\cdot u = 0,\n$$\n$$\n\\rho \\left( \\partial_t u + u \\cdot \\nabla u \\right) = - \\nabla p + \\eta \\nabla^2 u - \\phi \\nabla \\mu,\n$$\n$$\n\\partial_t \\phi + u \\cdot \\nabla \\phi = M \\nabla^2 \\mu,\n$$\n其化学势由Ginzburg–Landau自由能密度的变分导数给出\n$$\nf(\\phi, \\nabla \\phi) = \\frac{\\beta}{4}\\left(\\phi^2 - 1\\right)^2 + \\frac{\\kappa}{2} |\\nabla \\phi|^2,\n$$\n因此\n$$\n\\mu = \\frac{\\partial f}{\\partial \\phi} - \\nabla \\cdot \\frac{\\partial f}{\\partial (\\nabla \\phi)} = \\beta \\left(\\phi^3 - \\phi \\right) - \\kappa \\nabla^2 \\phi.\n$$\n此处，$\\rho$ 是密度，$\\eta$ 是动力粘度，$M$ 是迁移率，$\\beta$ 和 $\\kappa$ 分别是体相和梯度自由能系数。扩散界面厚度标度为 $\\ell = \\sqrt{\\kappa/\\beta}$，此双阱势的平衡表面张力为 $\\sigma = c_{\\sigma} \\sqrt{\\kappa \\beta}$，其中 $c_{\\sigma} = \\frac{2\\sqrt{2}}{3}$。\n\n通过选择特征长度 $L$、特征速度 $U$、特征时间 $L/U$、特征压力标度 $\\eta U/L$ 对该系统进行无量纲化，并用 $\\beta$ 对化学势进行标度，用单位1对序参数进行标度。写出无量纲方程，并通过识别系数，确定雷诺数 $Re$、毛细数 $Ca$、相场佩克莱数 $Pe_{\\phi}$ 和蔡恩数 $Cn = \\ell/L$。简要解释每个数所量化的物理平衡，以及 $Re \\ll 1$、$Ca \\ll 1$ 与 $Ca \\gg 1$、$Pe_{\\phi} \\ll 1$ 与 $Pe_{\\phi} \\gg 1$ 和 $Cn \\ll 1$ 这些渐近状态。\n\n将最终答案表示为一个单行矩阵，其中包含按 $\\left(Re, Ca, Pe_{\\phi}, Cn\\right)$ 顺序排列的四个无量纲群，每个都用量纲参数 $\\rho$、$\\eta$、$U$、$L$、$M$、$\\beta$ 和 $\\kappa$（以及常数 $c_{\\sigma}$）明确给出。不需要数值近似，最终答案中不应包含任何单位。",
            "solution": "首先验证问题陈述。给定方程构成了模拟二元不可压缩流体的著名“H模型”。其参数和标度选择在计算流体力学领域是标准的。该问题具有科学依据、提法恰当、客观，并且不包含矛盾或缺失信息。因此，我们可以着手求解。\n\n任务是对此偏微分方程组进行无量纲化，并识别出得到的无量纲数。给定以下针对位置 $x$、时间 $t$、速度 $u$、压力 $p$ 和化学势 $\\mu$ 的标度关系。序参数 $\\phi$ 本身已经是无量纲的。\n\n设无量纲变量用撇号表示：\n$x = L x'$\n$t = \\frac{L}{U} t'$\n$u = U u'$\n$p = \\frac{\\eta U}{L} p'$\n$\\mu = \\beta \\mu'$\n$\\phi = \\phi'$\n\n由此，我们推导出微分算子的变换关系：\n$\\nabla = \\frac{1}{L} \\nabla'$\n$\\nabla^2 = \\frac{1}{L^2} \\nabla'^2$\n$\\partial_t = \\frac{U}{L} \\partial_{t'}$\n\n现在我们将这些代入每个控制方程中。\n\n**1. 不可压缩性条件**\n连续性方程为：\n$$\n\\nabla \\cdot u = 0\n$$\n代入标度化变量：\n$$\n\\left(\\frac{1}{L} \\nabla'\\right) \\cdot (U u') = 0\n$$\n$$\n\\frac{U}{L} (\\nabla' \\cdot u') = 0 \\implies \\nabla' \\cdot u' = 0\n$$\n不可压缩性条件在无量纲变量中保持其形式。\n\n**2. 化学势**\n化学势的表达式为：\n$$\n\\mu = \\beta \\left(\\phi^3 - \\phi \\right) - \\kappa \\nabla^2 \\phi\n$$\n代入标度化变量：\n$$\n\\beta \\mu' = \\beta \\left((\\phi')^3 - \\phi' \\right) - \\kappa \\left(\\frac{1}{L^2} \\nabla'^2\\right) \\phi'\n$$\n将整个方程除以 $\\beta$：\n$$\n\\mu' = (\\phi')^3 - \\phi' - \\frac{\\kappa}{\\beta L^2} \\nabla'^2 \\phi'\n$$\n无量纲系数被识别为蔡恩数 $Cn = \\ell/L = \\sqrt{\\kappa/\\beta} / L$ 的平方。因此，$Cn^2 = \\frac{\\kappa}{\\beta L^2}$。无量纲化学势为：\n$$\n\\mu' = (\\phi')^3 - \\phi' - Cn^2 \\nabla'^2 \\phi'\n$$\n这将蔡恩数定义为 $Cn = \\frac{\\sqrt{\\kappa/\\beta}}{L}$。\n\n**3. Cahn–Hilliard 方程**\n序参数的输运方程为：\n$$\n\\partial_t \\phi + u \\cdot \\nabla \\phi = M \\nabla^2 \\mu\n$$\n代入标度化变量：\n$$\n\\left(\\frac{U}{L} \\partial_{t'}\\right) \\phi' + (U u') \\cdot \\left(\\frac{1}{L} \\nabla'\\right) \\phi' = M \\left(\\frac{1}{L^2} \\nabla'^2\\right) (\\beta \\mu')\n$$\n提出公因子：\n$$\n\\frac{U}{L} \\left( \\partial_{t'} \\phi' + u' \\cdot \\nabla' \\phi' \\right) = \\frac{M\\beta}{L^2} \\nabla'^2 \\mu'\n$$\n乘以 $L/U$ 使左侧无量纲化：\n$$\n\\partial_{t'} \\phi' + u' \\cdot \\nabla' \\phi' = \\frac{M\\beta}{LU} \\nabla'^2 \\mu'\n$$\n此无量纲群是相场佩克莱数 $Pe_{\\phi}$ 的倒数。佩克莱数比较的是对流输运速率与扩散输运速率。此处，$Pe_{\\phi} = \\frac{UL}{M\\beta}$。方程变为：\n$$\n\\partial_{t'} \\phi' + u' \\cdot \\nabla' \\phi' = \\frac{1}{Pe_{\\phi}} \\nabla'^2 \\mu'\n$$\n\n**4. Navier–Stokes 方程**\n动量平衡方程为：\n$$\n\\rho \\left( \\partial_t u + u \\cdot \\nabla u \\right) = - \\nabla p + \\eta \\nabla^2 u - \\phi \\nabla \\mu\n$$\n将标度化变量代入每一项：\n$$\n\\rho \\left( \\left(\\frac{U}{L}\\partial_{t'}\\right) (Uu') + (Uu') \\cdot \\left(\\frac{1}{L} \\nabla'\\right) (Uu') \\right) = - \\left(\\frac{1}{L} \\nabla'\\right) \\left(\\frac{\\eta U}{L} p'\\right) + \\eta \\left(\\frac{1}{L^2} \\nabla'^2\\right) (Uu') - \\phi' \\left(\\frac{1}{L} \\nabla'\\right) (\\beta \\mu')\n$$\n简化每一项的系数：\n$$\n\\frac{\\rho U^2}{L} \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\frac{\\eta U}{L^2} \\nabla' p' + \\frac{\\eta U}{L^2} \\nabla'^2 u' - \\frac{\\beta}{L} \\phi' \\nabla' \\mu'\n$$\n为得到无量纲群，我们将整个方程除以一个特征力标度。使用粘性力标度，由粘性项的系数 $\\frac{\\eta U}{L^2}$ 表示：\n$$\n\\frac{\\rho U^2/L}{\\eta U/L^2} \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\nabla' p' + \\nabla'^2 u' - \\frac{\\beta/L}{\\eta U/L^2} \\phi' \\nabla' \\mu'\n$$\n简化系数可得：\n$$\n\\frac{\\rho U L}{\\eta} \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\nabla' p' + \\nabla'^2 u' - \\frac{\\beta L}{\\eta U} \\phi' \\nabla' \\mu'\n$$\n惯性项的系数是雷诺数，$Re = \\frac{\\rho U L}{\\eta}$。\n\n化学势强迫项的系数 $\\frac{\\beta L}{\\eta U}$ 与毛细数 $Ca$ 有关。毛细数的标准定义是粘性力与表面张力之比，$Ca = \\frac{\\eta U}{\\sigma}$。使用给定的表面张力表达式 $\\sigma = c_{\\sigma} \\sqrt{\\kappa \\beta}$：\n$$\nCa = \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}}\n$$\n我们可以验证系数 $\\frac{\\beta L}{\\eta U}$ 与标准无量纲数 $Ca$ 和 $Cn$ 之间的关系。我们有 $Cn = \\frac{\\sqrt{\\kappa/\\beta}}{L}$，所以 $\\sqrt{\\kappa} = Cn L \\sqrt{\\beta}$。将此代入 $Ca$ 的表达式中：\n$$\nCa = \\frac{\\eta U}{c_{\\sigma} (Cn L \\sqrt{\\beta}) \\sqrt{\\beta}} = \\frac{\\eta U}{c_{\\sigma} Cn L \\beta}\n$$\n对动量方程中的系数进行整理可得：\n$$\n\\frac{\\beta L}{\\eta U} = \\frac{1}{c_{\\sigma} Cn Ca}\n$$\n因此，无量纲动量方程为：\n$$\nRe \\left( \\partial_{t'} u' + u' \\cdot \\nabla' u' \\right) = - \\nabla' p' + \\nabla'^2 u' - \\frac{1}{c_{\\sigma} Cn Ca} \\phi' \\nabla' \\mu'\n$$\n\n**无量纲系统总结**\n为记法清晰，省略撇号，无量纲系统为：\n$$\n\\nabla \\cdot u = 0\n$$\n$$\nRe \\left( \\partial_t u + u \\cdot \\nabla u \\right) = - \\nabla p + \\nabla^2 u - \\frac{1}{c_{\\sigma} Cn Ca} \\phi \\nabla \\mu\n$$\n$$\n\\partial_t \\phi + u \\cdot \\nabla \\phi = \\frac{1}{Pe_{\\phi}} \\nabla^2 \\mu\n$$\n$$\n\\mu = \\phi^3 - \\phi - Cn^2 \\nabla^2 \\phi\n$$\n\n**无量纲数的物理解释**\n\n*   **雷诺数, $Re = \\frac{\\rho U L}{\\eta}$**: 该数用于量化惯性力与粘性力之比。\n    *   $Re \\ll 1$: 这是蠕动流（或斯托克斯流）状态，此时粘性力占主导地位。流动平滑、有序，无湍流。\n    *   $Re \\gg 1$: 惯性力占主导地位，导致复杂、混沌甚至可能是湍流的流动模式。\n\n*   **毛细数, $Ca = \\frac{\\eta U}{\\sigma} = \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}}$**: 该数用于量化导致流体界面变形的粘性力与恢复界面的表面张力之比。\n    *   $Ca \\ll 1$: 表面张力占主导地位。流体液滴或界面强烈抵抗变形，并倾向于最小化其表面积（例如，保持球形）。\n    *   $Ca \\gg 1$: 粘性力占主导地位，能够显著地使界面变形、拉伸甚至破裂，如乳化现象中所见。\n\n*   **佩克莱数, $Pe_{\\phi} = \\frac{UL}{M\\beta}$**: 该数用于量化序参数 $\\phi$ 由流场引起的对流输运速率与其由化学势梯度驱动的扩散输运速率之比。\n    *   $Pe_{\\phi} \\ll 1$: 扩散是 $\\phi$ 的主要输运机制。浓度场倾向于快速均匀化。\n    *   $Pe_{\\phi} \\gg 1$: 对流占主导地位。序参数场实际上被“冻结”并随流体流动。\n\n*   **蔡恩数, $Cn = \\frac{\\ell}{L} = \\frac{\\sqrt{\\kappa/\\beta}}{L}$**: 该数用于量化扩散界面的特征厚度 $\\ell = \\sqrt{\\kappa/\\beta}$ 与系统的宏观特征长度 $L$ 之比。\n    *   $Cn \\ll 1$: 这是锐利界面极限。两种流体组分之间的界面比整个系统尺寸薄几个数量级。在此极限下，扩散界面模型收敛于经典的锐利界面模型，其中表面张力在界面处是一个真正的奇点。\n\n**无量纲群的最终表达式**\n根据推导，四个无量纲群用给定的量纲参数表示的表达式为：\n- 雷诺数: $Re = \\frac{\\rho U L}{\\eta}$\n- 毛细数: $Ca = \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}}$\n- 佩克莱数: $Pe_{\\phi} = \\frac{UL}{M\\beta}$\n- 蔡恩数: $Cn = \\frac{\\sqrt{\\kappa/\\beta}}{L}$\n\n将这些汇总成一个单行矩阵作为最终答案。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\rho U L}{\\eta} & \\frac{\\eta U}{c_{\\sigma} \\sqrt{\\kappa \\beta}} & \\frac{U L}{M \\beta} & \\frac{\\sqrt{\\frac{\\kappa}{\\beta}}}{L} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从连续的控制方程过渡到离散的数值求解，首要的挑战之一便是保证算法的稳定性。对于显式时间积分格式，时间步长的选择受到物理过程的严格限制，这通常表现为柯朗-弗里德里希斯-路维（Courant–Friedrichs–Lewy, CFL）条件。本练习将带你分析由对流和粘性扩散项共同施加的稳定性约束，并计算出在给定物理参数和网格尺寸下的最大允许时间步长，这是编写稳定高效模拟程序的关键一步。",
            "id": "4099038",
            "problem": "考虑一个二维不可压缩二元流体模型，其中相场 $\\phi(x,y,t)$ 被满足不可压缩Navier–Stokes方程的速度场 $\\mathbf{u}(x,y,t)$ 平流。相场平流由守恒律 $\\partial_t \\phi + \\mathbf{u}\\cdot\\nabla \\phi = 0$ 控制，动量方程包含粘性项 $\\nu \\nabla^2 \\mathbf{u}$，其中 $\\nu$ 是运动粘度。假设密度和粘度恒定，且速度场不可压缩（$\\nabla\\cdot\\mathbf{u}=0$）。您需要分析相场平流和动量方程中粘性项的显式时间积分的Courant–Friedrichs–Lewy (CFL) 型稳定性约束。\n\n在间距为 $\\Delta x = \\Delta y = h$ 的均匀笛卡尔网格上离散化方程，并使用前向欧拉时间积分器。对于相场更新，使用一阶迎风（donor-cell）格式离散化 $\\mathbf{u}\\cdot\\nabla \\phi$。对于动量方程中的粘性项，使用标准的二阶中心差分格式的离散拉普拉斯算子。\n\n从基本稳定性原理（针对线性常系数算子的Fourier或von Neumann分析以及迎风平流的单调性要求）出发，确定由以下两项共同施加的最严格的显式时间步长约束：\n- 速度场 $\\mathbf{u}$ 对相场 $\\phi$ 的平流，以及\n- 由粘性引起的速度场扩散。\n\n使用以下代表微流体配置的参数值：\n- 均匀网格间距 $h = 2.5 \\times 10^{-6}\\,\\mathrm{m}$，\n- 速度分量边界 $|u| \\leq 6.0 \\times 10^{-2}\\,\\mathrm{m/s}$ 和 $|v| \\leq 2.0 \\times 10^{-2}\\,\\mathrm{m/s}$，\n- 运动粘度 $\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^2/s}$。\n\n假设稳定性约束应在离散谱上的最坏情况Fourier模式和与上述边界一致的最坏情况速度大小下得到满足。计算由联合约束施加的最大稳定时间步长 $\\Delta t_{\\max}$。以秒为单位表示您的最终答案，并将结果四舍五入到四位有效数字。最终答案必须是单个实数。",
            "solution": "该问题要求确定一个模拟二维不可压缩二元流体的显式数值格式的最大稳定时间步长 $\\Delta t_{\\max}$。稳定性由两个用不同方法离散化的不同物理过程控制：相场 $\\phi$ 的平流和动量（粘性）的扩散。我们将分别分析每个过程施加的稳定性约束，然后确定最严格的总体约束。\n\n该分析将基于偏微分方程数值稳定性的标准原理。对于用一阶迎风格式离散化的平流项，其稳定性约束源于对前向欧拉时间步进格式的单调性要求。对于用二阶中心差分格式离散化的粘性扩散项，其稳定性使用von Neumann（或Fourier）方法进行分析。\n\n首先，让我们分析相场平流方程的稳定性。其控制方程为：\n$$\n\\partial_t \\phi + \\mathbf{u}\\cdot\\nabla \\phi = 0\n$$\n在二维情况下，该方程为 $\\partial_t \\phi + u \\partial_x \\phi + v \\partial_y \\phi = 0$。该格式在时间上使用前向欧拉更新，在空间导数上对间距为 $\\Delta x = \\Delta y = h$ 的均匀笛卡尔网格使用一阶迎风（donor-cell）格式。令 $\\phi_{i,j}^n$ 表示在网格点 $(i,j)$ 和时间步 $n$ 处的相场值。离散化的方程为：\n$$\n\\frac{\\phi_{i,j}^{n+1} - \\phi_{i,j}^n}{\\Delta t} + u_{i,j} \\left( \\frac{\\phi_{i,j}^n - \\phi_{i-1,j}^n}{h} \\right) + v_{i,j} \\left( \\frac{\\phi_{i,j}^n - \\phi_{i,j-1}^n}{h} \\right) = 0\n$$\n此形式假设速度 $u_{i,j} > 0$ 和 $v_{i,j} > 0$ 为正。迎风格式的一般形式，考虑了速度分量的符号，为：\n$$\n\\phi_{i,j}^{n+1} = \\phi_{i,j}^n - \\frac{\\Delta t}{h} \\left( u^+(\\phi_{i,j}^n - \\phi_{i-1,j}^n) + u^-(\\phi_{i+1,j}^n - \\phi_{i,j}^n) + v^+(\\phi_{i,j}^n - \\phi_{i,j-1}^n) + v^-(\\phi_{i,j+1}^n - \\phi_{i,j}^n) \\right)\n$$\n其中 $u^+ = \\max(u, 0)$，$u^- = \\min(u, 0)$，$v$ 的情况类似。为确保稳定性（和单调性，以防止非物理振荡），$\\phi_{i,j}^{n+1}$ 表达式中中心节点值 $\\phi_{i,j}^n$ 的系数必须为非负。收集乘以 $\\phi_{i,j}^n$ 的项：\n$$\n\\phi_{i,j}^{n+1} = \\left[ 1 - \\frac{\\Delta t}{h} (u^+ - u^- + v^+ - v^-) \\right] \\phi_{i,j}^n + \\dots\n$$\n注意到 $u^+-u^- = |u|$ 和 $v^+-v^- = |v|$，该系数为 $1 - \\frac{\\Delta t}{h}(|u| + |v|)$。稳定性要求是：\n$$\n1 - \\frac{\\Delta t}{h}(|u| + |v|) \\geq 0\n$$\n这就得出了平流时间步长约束，通常称之为该格式的Courant-Friedrichs-Lewy (CFL) 条件：\n$$\n\\Delta t \\leq \\frac{h}{|u| + |v|}\n$$\n为了在定义域中的所有点都满足此条件，我们必须考虑最坏情况下的速度。问题指定了边界 $|u| \\leq U_{\\max} = 6.0 \\times 10^{-2}\\,\\mathrm{m/s}$ 和 $|v| \\leq V_{\\max} = 2.0 \\times 10^{-2}\\,\\mathrm{m/s}$。最严格的条件发生在和 $|u| + |v|$ 最大化时，即 $U_{\\max} + V_{\\max}$。因此，平流稳定性极限为：\n$$\n\\Delta t_{\\text{adv}} \\leq \\frac{h}{U_{\\max} + V_{\\max}}\n$$\n\n接下来，我们分析动量方程中粘性扩散项的稳定性。我们考虑速度的一个分量，比如 $u$，它由二维扩散方程控制：\n$$\n\\partial_t u = \\nu (\\partial_x^2 u + \\partial_y^2 u)\n$$\n其中 $\\nu$ 是运动粘度。这在时间上使用前向欧拉法，在同一网格上对拉普拉斯算子使用标准的二阶中心差分进行离散化：\n$$\n\\frac{u_{i,j}^{n+1} - u_{i,j}^n}{\\Delta t} = \\nu \\left( \\frac{u_{i+1,j}^n - 2u_{i,j}^n + u_{i-1,j}^n}{h^2} + \\frac{u_{i,j+1}^n - 2u_{i,j}^n + u_{i,j-1}^n}{h^2} \\right)\n$$\n使用von Neumann稳定性分析，我们代入单个Fourier模式 $u_{i,j}^n = A^n e^{I(k_x i h + k_y j h)}$，其中 $I$ 是虚数单位，$(k_x, k_y)$ 是波矢量。放大因子为 $G = A^{n+1}/A^n$。稳定性要求对所有波矢量都有 $|G| \\leq 1$。\n将Fourier模式代入离散化方程中得到：\n$$\nG - 1 = \\frac{\\nu \\Delta t}{h^2} \\left[ (e^{I k_x h} - 2 + e^{-I k_x h}) + (e^{I k_y h} - 2 + e^{-I k_y h}) \\right]\n$$\n使用恒等式 $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$，我们得到：\n$$\nG - 1 = \\frac{2\\nu \\Delta t}{h^2} \\left[ (\\cos(k_x h) - 1) + (\\cos(k_y h) - 1) \\right]\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\nG - 1 = -\\frac{4\\nu \\Delta t}{h^2} \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right]\n$$\n因此，放大因子为：\n$$\nG = 1 - \\frac{4\\nu \\Delta t}{h^2} \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right]\n$$\n由于从1中减去的项总是非负的，所以 $G \\leq 1$ 总是满足的。非平凡的约束来自 $G \\geq -1$：\n$$\n1 - \\frac{4\\nu \\Delta t}{h^2} \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right] \\geq -1\n$$\n$$\n\\frac{4\\nu \\Delta t}{h^2} \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right] \\leq 2\n$$\n$$\n\\Delta t \\leq \\frac{h^2}{2\\nu \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right]}\n$$\n最严格的条件对应于使分母最大化的Fourier模式。项 $\\sin^2(k h/2)$ 在网格上可表示的最高频率（Nyquist）模式下最大化，此时 $k_x h = \\pi$ 且 $k_y h = \\pi$。对于此模式：\n$$\n\\sin^2\\left(\\frac{\\pi}{2}\\right) + \\sin^2\\left(\\frac{\\pi}{2}\\right) = 1^2 + 1^2 = 2\n$$\n将此最大值代入不等式，得到扩散稳定性极限：\n$$\n\\Delta t_{\\text{diff}} \\leq \\frac{h^2}{2\\nu (2)} = \\frac{h^2}{4\\nu}\n$$\n显式格式的总体时间步长必须同时满足两个约束条件。因此，最大允许时间步长是两个单独极限的最小值：\n$$\n\\Delta t_{\\max} = \\min\\left(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff}}\\right) = \\min\\left(\\frac{h}{U_{\\max} + V_{\\max}}, \\frac{h^2}{4\\nu}\\right)\n$$\n现在，我们代入给定的数值：\n$h = 2.5 \\times 10^{-6}\\,\\mathrm{m}$\n$U_{\\max} = 6.0 \\times 10^{-2}\\,\\mathrm{m/s}$\n$V_{\\max} = 2.0 \\times 10^{-2}\\,\\mathrm{m/s}$\n$\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^2/s}$\n\n计算平流时间步长极限：\n$$\n\\Delta t_{\\text{adv}} = \\frac{2.5 \\times 10^{-6}\\,\\mathrm{m}}{(6.0 \\times 10^{-2} + 2.0 \\times 10^{-2})\\,\\mathrm{m/s}} = \\frac{2.5 \\times 10^{-6}}{8.0 \\times 10^{-2}}\\,\\mathrm{s} = 0.3125 \\times 10^{-4}\\,\\mathrm{s} = 3.125 \\times 10^{-5}\\,\\mathrm{s}\n$$\n计算扩散时间步长极限：\n$$\n\\Delta t_{\\text{diff}} = \\frac{(2.5 \\times 10^{-6}\\,\\mathrm{m})^2}{4 \\times (1.0 \\times 10^{-6}\\,\\mathrm{m^2/s})} = \\frac{6.25 \\times 10^{-12}\\,\\mathrm{m^2}}{4.0 \\times 10^{-6}\\,\\mathrm{m^2/s}} = 1.5625 \\times 10^{-6}\\,\\mathrm{s}\n$$\n比较这两个极限：\n$$\n\\Delta t_{\\text{adv}} = 3.125 \\times 10^{-5}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{\\text{diff}} = 1.5625 \\times 10^{-6}\\,\\mathrm{s}\n$$\n扩散约束更严格，因为 $1.5625 \\times 10^{-6}  3.125 \\times 10^{-5}$。因此，组合系统的最大稳定时间步长由粘性扩散项决定。\n$$\n\\Delta t_{\\max} = 1.5625 \\times 10^{-6}\\,\\mathrm{s}\n$$\n问题要求结果四舍五入到四位有效数字。\n$$\n\\Delta t_{\\max} \\approx 1.563 \\times 10^{-6}\\,\\mathrm{s}\n$$\n该值表示在指定离散化和参数体系下，确保对流和扩散算子的前向欧拉积分的数值稳定性的时间步长上限。对于这种特定的微流体配置，就其显式时间步长而言，该模拟显然是“扩散受限”的。",
            "answer": "$$\\boxed{1.563 \\times 10^{-6}}$$"
        },
        {
            "introduction": "在不可压缩流体的数值模拟中，如何高效地处理速度-压力耦合和不可压缩性约束（$\\nabla\\cdot\\boldsymbol{u}=0$）是核心难题。压力修正法（pressure-correction method）是解决这一问题的经典而强大的工具。这项实践将指导你为耦合了相场模型的纳维-斯托克斯系统构建一个压力修正方案，并推导出离散的压力泊松方程（Pressure Poisson Equation），该方程是速度场投影和压力更新步骤的计算核心。",
            "id": "4099087",
            "problem": "考虑一个定义在周期性方形区域上的二维二元流体混合物的不可压缩 Cahn–Hilliard–Navier–Stokes (CH–NS) 系统，该流体具有恒定的密度 $\\,\\rho\\,$ 和动力粘度 $\\,\\eta\\,$。其流体动力学由不可压缩 Navier–Stokes 方程控制：\n$$\n\\rho\\left(\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u}\\right) \\;=\\; -\\nabla p \\;+\\; \\eta \\nabla^{2}\\boldsymbol{u} \\;-\\; \\phi \\,\\nabla \\mu,\\qquad \\nabla\\cdot\\boldsymbol{u}=0,\n$$\n其中 $\\boldsymbol{u}$ 是速度，$p$ 是压力，$\\phi$ 是相场，$\\mu$ 是化学势（由一个热力学一致的 Cahn–Hilliard 模型给出）。假设毛细（Korteweg）力为 $-\\phi \\nabla \\mu$，并利用分解式 $-\\phi \\nabla \\mu \\,=\\, -\\nabla(\\phi \\mu) \\,+\\, \\mu \\nabla \\phi$。\n\n在间距为 $\\,h\\,$、带有周期性边界条件的均匀 Marker-And-Cell (MAC) 交错网格上，采用一种旋转增量压力修正投影法。标量未知数 $\\,p\\,$, $\\,\\phi\\,$ 和 $\\,\\mu\\,$ 存储在单元中心 $\\,\\{(i,j)\\}\\,$，速度分量存储在单元面上：水平分量位于 $\\,\\{(i+\\tfrac{1}{2},j)\\}\\,$，垂直分量位于 $\\,\\{(i,j+\\tfrac{1}{2})\\}\\,$。设 $\\,\\Delta t\\,$ 为时间步长，并假设在稳定的 Cahn–Hilliard 更新后，$\\,\\phi^{n+1/2}\\,$ 和 $\\,\\mu^{n+1/2}\\,$ 在时间层 $\\,n+\\tfrac{1}{2}\\,$ 是已知的。通过在 $[t^{n},t^{n+1}]$ 上推进动量方程来定义中间速度 $\\,\\boldsymbol{u}^{\\star}\\,$，其中所有非压力项都采用半隐式处理，并且毛细力的梯度部分 $-\\nabla(\\phi \\mu)$ 在此步骤中暂不计算：\n$$\n\\rho \\frac{\\boldsymbol{u}^{\\star} - \\boldsymbol{u}^{n}}{\\Delta t} \\;+\\; \\text{(对 } \\rho\\,\\boldsymbol{u}\\cdot\\nabla\\boldsymbol{u} \\text{ 的一致离散化)} \\;-\\; \\eta \\nabla^{2}\\boldsymbol{u}^{\\star}\n\\;=\\; -\\nabla p^{n} \\;+\\; \\mu^{n+1/2}\\,\\nabla \\phi^{n+1/2}.\n$$\n然后执行投影：\n$$\n\\boldsymbol{u}^{n+1} \\;=\\; \\boldsymbol{u}^{\\star} \\;-\\; \\frac{\\Delta t}{\\rho}\\,\\nabla\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big),\n$$\n该步骤强制满足 $\\,\\nabla\\cdot\\boldsymbol{u}^{n+1}=0\\,$。对所有空间导数使用二阶中心差分。令 $\\,D\\cdot\\,\\boldsymbol{v}\\,$ 表示将面心速度映射到单元中心的标准 MAC 散度，令 $\\,L\\,$ 表示在单元中心上的标准五点拉普拉斯算子。离散投影步骤在单元中心产生一个形式如下的压力泊松方程：\n$$\nL\\,p^{n+1} \\;=\\; \\frac{\\rho}{\\Delta t}\\,D\\cdot \\boldsymbol{u}^{\\star} \\;+\\; L\\,p^{n} \\;-\\; L\\!\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right).\n$$\n\n使用上述设定和算子，推导以单元为中心的离散压力泊松方程，并为一个通用内部单元中心 $\\, (i,j)\\,$ 显式地组合其右侧项。使用均匀网格间距 $\\,h\\,$，并用 $\\,u^{\\star}_{i+1/2,j}\\,$ 和 $\\,v^{\\star}_{i,j+1/2}\\,$ 表示与单元 $\\, (i,j)\\,$ 相邻面上的中间速度分量。您的推导必须从连续方程和投影方法出发，论证在压力更新中对毛细力进行分裂的合理性，并清晰地构建 MAC 网格上的离散算子。\n\n答案规格：\n- 您的最终答案必须是在单元 $\\, (i,j)\\,$ 处组合得到的右侧项的单个闭合形式代数表达式，仅用 $\\,\\rho\\,$, $\\,\\Delta t\\,$, $\\,h\\,$, $\\,\\boldsymbol{u}^{\\star}\\,$ 的相邻面心分量，以及 $\\,p^{n}\\,$ 和 $\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right)$ 的相邻单元中心值来表示。\n- 最终答案中不应包含任何等号或不等号。\n- 无需进行数值计算。",
            "solution": "目标是为给定的 Cahn–Hilliard–Navier–Stokes 系统推导离散压力泊松方程 (PPE)，并在 MAC 网格上的一个通用单元中心 $(i,j)$ 处显式地组合其右侧 (RHS) 的表达式。\n\n首先，我们建立 PPE 的空间连续形式。该数值格式是一种增量压力修正投影法。两个关键步骤是计算中间速度 $\\boldsymbol{u}^{\\star}$，以及将此速度投影到无散度场空间以获得最终速度 $\\boldsymbol{u}^{n+1}$。\n\n投影步骤由下式给出：\n$$\n\\boldsymbol{u}^{n+1} \\;=\\; \\boldsymbol{u}^{\\star} \\;-\\; \\frac{\\Delta t}{\\rho}\\,\\nabla\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big)\n$$\n此步骤必须在新时间层 $t^{n+1}$ 强制满足不可压缩性约束：\n$$\n\\nabla\\cdot\\boldsymbol{u}^{n+1} = 0\n$$\n为推导 PPE，我们对投影方程取散度：\n$$\n\\nabla\\cdot\\boldsymbol{u}^{n+1} \\;=\\; \\nabla\\cdot\\boldsymbol{u}^{\\star} \\;-\\; \\nabla\\cdot\\left(\\frac{\\Delta t}{\\rho}\\,\\nabla\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big)\\right)\n$$\n代入不可压缩性约束 $\\nabla\\cdot\\boldsymbol{u}^{n+1}=0$ 并整理各项，我们得到一个关于有效压力修正项的泊松方程：\n$$\n\\frac{\\Delta t}{\\rho}\\,\\nabla^{2}\\Big(p^{n+1} - p^{n} + \\phi^{n+1/2}\\mu^{n+1/2}\\Big) \\;=\\; \\nabla\\cdot\\boldsymbol{u}^{\\star}\n$$\n其中 $\\nabla^{2} \\equiv \\nabla \\cdot \\nabla$ 是拉普拉斯算子。假设拉普拉斯算子是线性算子，我们可以展开左侧：\n$$\n\\nabla^{2}p^{n+1} - \\nabla^{2}p^{n} + \\nabla^{2}\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right) \\;=\\; \\frac{\\rho}{\\Delta t}\\,\\nabla\\cdot\\boldsymbol{u}^{\\star}\n$$\n分离出包含新压力 $p^{n+1}$ 的项，得到 $p^{n+1}$ 的 PPE 的连续形式：\n$$\n\\nabla^{2}p^{n+1} \\;=\\; \\frac{\\rho}{\\Delta t}\\,\\nabla\\cdot\\boldsymbol{u}^{\\star} \\;+\\; \\nabla^{2}p^{n} \\;-\\; \\nabla^{2}\\left(\\phi^{n+1/2}\\mu^{n+1/2}\\right)\n$$\n此方程与问题描述中提供的符号形式相匹配，其中连续算子 $\\nabla^2$ 和 $\\nabla\\cdot$ 分别对应于离散算子 $L$ 和 $D\\cdot$。\n\n问题要求对毛细力 $-\\phi\\nabla\\mu$ 的分裂进行合理解释。利用矢量微积分恒等式 $\\nabla(\\phi\\mu) = \\phi\\nabla\\mu + \\mu\\nabla\\phi$，毛细力可分解为 $-\\phi\\nabla\\mu = \\mu\\nabla\\phi - \\nabla(\\phi\\mu)$。该时间步进格式利用了这种分解：\n1. 在中间速度步骤中，$\\mu\\nabla\\phi$ 项被显式处理。$\\boldsymbol{u}^{\\star}$ 的方程包含 $\\mu^{n+1/2}\\nabla\\phi^{n+1/2}$ 项，这是一个由时间 $t^{n+1/2}$ 的已知值计算出的显式强迫项。\n2. $-\\nabla(\\phi\\mu)$ 项是一个保守力，因为它可以表示为标量势的梯度。在此格式中，它与压力梯度项结合，并在投影步骤中被隐式处理。投影步骤涉及 $p^{n+1} - p^n + \\phi^{n+1/2}\\mu^{n+1/2}$ 的梯度，有效地将 $\\phi^{n+1/2}\\mu^{n+1/2}$ 视为强制不可压缩性的压力势的一部分。这确保了速度修正是纯梯度场，不会改变流场的涡度（这是旋转格式的一个特性），并稳健地强制满足 $\\nabla\\cdot\\boldsymbol{u}^{n+1}=0$ 约束。\n\n现在，我们在间距为 $h$ 的均匀 MAC 网格上离散化 PPE。像 $p$、$\\phi$ 和 $\\mu$ 这样的标量定义在单元中心 $(i,j)$。离散算子基于二阶中心差分。\n\n在单元中心 $(i,j)$ 处，中间速度 $\\boldsymbol{u}^{\\star} = (u^{\\star}, v^{\\star})$ 的离散散度为：\n$$\n(D\\cdot \\boldsymbol{u}^{\\star})_{i,j} \\;=\\; \\frac{u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j}}{h} \\;+\\; \\frac{v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}}{h}\n$$\n应用于任意单元中心标量场 $\\psi$ 于 $(i,j)$ 的拉普拉斯算子 $L$ 的五点模板为：\n$$\n(L\\,\\psi)_{i,j} \\;=\\; \\frac{\\psi_{i+1,j} - 2\\psi_{i,j} + \\psi_{i-1,j}}{h^2} \\;+\\; \\frac{\\psi_{i,j+1} - 2\\psi_{i,j} + \\psi_{i,j-1}}{h^2}\n$$\n离散 PPE 写为 $L\\,p^{n+1}_{i,j} = (\\text{RHS})_{i,j}$。问题要求显式组合右侧项，其由下式给出：\n$$\n(\\text{RHS})_{i,j} \\;=\\; \\frac{\\rho}{\\Delta t}\\,(D\\cdot \\boldsymbol{u}^{\\star})_{i,j} \\;+\\; (L\\,p^n)_{i,j} \\;-\\; (L(\\phi^{n+1/2}\\mu^{n+1/2}))_{i,j}\n$$\n我们使用离散算子定义来组合 RHS 上的每一项：\n第一项是中间速度的散度：\n$$\n\\frac{\\rho}{\\Delta t}\\,(D\\cdot \\boldsymbol{u}^{\\star})_{i,j} \\;=\\; \\frac{\\rho}{\\Delta t} \\left(\\frac{u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j}}{h} + \\frac{v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}}{h}\\right) \\;=\\; \\frac{\\rho}{\\Delta t h} (u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j} + v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2})\n$$\n第二项是旧压力 $p^n$ 的拉普拉斯算子：\n$$\n(L\\,p^n)_{i,j} \\;=\\; \\frac{p^n_{i+1,j} + p^n_{i-1,j} + p^n_{i,j+1} + p^n_{i,j-1} - 4p^n_{i,j}}{h^2}\n$$\n第三项是乘积 $\\phi^{n+1/2}\\mu^{n+1/2}$ 的负拉普拉斯算子：\n$$\n-(L(\\phi^{n+1/2}\\mu^{n+1/2}))_{i,j} \\;=\\; -\\frac{(\\phi^{n+1/2}\\mu^{n+1/2})_{i+1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i-1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j+1} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j-1} - 4(\\phi^{n+1/2}\\mu^{n+1/2})_{i,j}}{h^2}\n$$\n将这三个表达式组合起来，得到在单元 $(i,j)$ 处 RHS 的完整代数形式。\n$$\n(\\text{RHS})_{i,j} = \\frac{\\rho}{\\Delta t h} (u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j} + v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}) + \\frac{1}{h^2}(p^n_{i+1,j} + p^n_{i-1,j} + p^n_{i,j+1} + p^n_{i,j-1} - 4p^n_{i,j}) - \\frac{1}{h^2}((\\phi^{n+1/2}\\mu^{n+1/2})_{i+1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i-1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j+1} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j-1} - 4(\\phi^{n+1/2}\\mu^{n+1/2})_{i,j})\n$$\n这就是所需的最终表达式。",
            "answer": "$$\n\\boxed{\\frac{\\rho}{\\Delta t h} (u^{\\star}_{i+1/2,j} - u^{\\star}_{i-1/2,j} + v^{\\star}_{i,j+1/2} - v^{\\star}_{i,j-1/2}) + \\frac{1}{h^2}(p^n_{i+1,j} + p^n_{i-1,j} + p^n_{i,j+1} + p^n_{i,j-1} - 4p^n_{i,j}) - \\frac{1}{h^2}((\\phi^{n+1/2}\\mu^{n+1/2})_{i+1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i-1,j} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j+1} + (\\phi^{n+1/2}\\mu^{n+1/2})_{i,j-1} - 4(\\phi^{n+1/2}\\mu^{n+1/2})_{i,j})}\n$$"
        }
    ]
}