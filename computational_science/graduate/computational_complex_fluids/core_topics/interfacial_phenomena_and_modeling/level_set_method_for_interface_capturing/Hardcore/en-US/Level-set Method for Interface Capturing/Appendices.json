{
    "hands_on_practices": [
        {
            "introduction": "A robust level-set method begins with a well-behaved representation of the interface. The ideal choice is a Signed Distance Function (SDF), where the value of the field at any point gives its closest distance to the interface, and the sign indicates whether the point is inside or outside the enclosed region. This practice  grounds this fundamental concept by tasking you with analytically constructing the SDF for a simple circular interface and verifying its defining property, $|\\nabla \\phi|=1$.",
            "id": "4092664",
            "problem": "Consider a two-dimensional immiscible interface in a quiescent incompressible complex fluid, represented in the level-set method by a scalar function $\\phi(\\mathbf{x},t)$ whose zero level set $\\{\\mathbf{x}:\\phi(\\mathbf{x},t)=0\\}$ coincides with the material interface. At initial time $t=0$, the interface $\\Gamma$ is the circle of radius $R>0$ centered at the origin in $\\mathbb{R}^{2}$. Adopt the standard sign convention in level-set methods: $\\phi(\\mathbf{x},t)0$ inside the region bounded by $\\Gamma$ and $\\phi(\\mathbf{x},t)>0$ outside.\n\nStarting from the definition of the signed distance to a set in Euclidean space, construct an explicit analytic expression for $\\phi(\\mathbf{x},0)$ in terms of the Cartesian coordinates $\\mathbf{x}=(x,y)$ and $R$, such that $\\phi(\\mathbf{x},0)$ is a signed distance function to $\\Gamma$ with the above sign convention. Then, by direct differentiation from first principles, verify that the signed distance property $|\\nabla \\phi(\\mathbf{x},0)|=1$ holds for all $\\mathbf{x}\\neq\\mathbf{0}$, and identify any points where differentiability fails. Finally, confirm that the outward unit normal $\\mathbf{n}$ to $\\Gamma$ computed as $\\nabla \\phi/|\\nabla \\phi|$ on $\\Gamma$ is consistent with the geometric normal.\n\nProvide only the explicit analytic expression for $\\phi(\\mathbf{x},0)$ as your final answer. No rounding is required. Do not include units in your final answer.",
            "solution": "The problem statement is evaluated for validity before proceeding to a solution.\n\n### Step 1: Extract Givens\n-   The system is a two-dimensional immiscible interface in a quiescent incompressible complex fluid.\n-   The interface is represented by the zero level set of a scalar function $\\phi(\\mathbf{x},t)$, i.e., $\\{\\mathbf{x} : \\phi(\\mathbf{x},t)=0\\}$.\n-   At initial time $t=0$, the interface $\\Gamma$ is a circle of radius $R>0$ centered at the origin in $\\mathbb{R}^{2}$.\n-   The position vector is $\\mathbf{x}=(x,y)$.\n-   The sign convention for the level-set function is $\\phi(\\mathbf{x},t)0$ inside the region bounded by $\\Gamma$ and $\\phi(\\mathbf{x},t)>0$ outside.\n-   The tasks are:\n    1.  Construct an explicit analytic expression for $\\phi(\\mathbf{x},0)$ as a signed distance function to $\\Gamma$.\n    2.  Verify that the signed distance property $|\\nabla \\phi(\\mathbf{x},0)|=1$ holds for all $\\mathbf{x}\\neq\\mathbf{0}$ by direct differentiation.\n    3.  Identify points where differentiability of $\\phi(\\mathbf{x},0)$ fails.\n    4.  Confirm that the outward unit normal $\\mathbf{n} = \\nabla \\phi/|\\nabla \\phi|$ on $\\Gamma$ is consistent with the geometric normal.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is a standard exercise in the level-set method, a widely used technique in computational fluid dynamics and materials science. The concepts of signed distance functions, the Eikonal equation ($|\\nabla \\phi|=1$), and the geometric interpretation of the gradient are fundamental and well-established in differential geometry and numerical analysis. The physical context is realistic and serves as a valid premise for the mathematical task.\n-   **Well-Posed:** The problem is clearly defined and self-contained. The geometry (a circle) is specified, the sign convention is unambiguous, and the tasks are explicit. The provided information is sufficient to derive a unique analytical expression for the signed distance function and to perform the required verifications.\n-   **Objective:** The problem is stated in precise, formal mathematical language, free of any subjectivity or ambiguity.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or infeasibility. It is a well-posed, objective, and scientifically grounded problem within the field of computational complex fluids and applied mathematics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full, reasoned solution will be provided.\n\n### Solution Derivation\nThe solution proceeds by first constructing the signed distance function from its definition, then verifying its properties through differentiation. For clarity, the time dependence is suppressed, and $\\phi(\\mathbf{x})$ is used to denote $\\phi(\\mathbf{x},0)$.\n\n**1. Construction of the Signed Distance Function $\\phi(\\mathbf{x})$**\n\nBy definition, a signed distance function $\\phi(\\mathbf{x})$ to an interface $\\Gamma$ provides the shortest Euclidean distance from a point $\\mathbf{x}$ to $\\Gamma$, with the sign determined by whether $\\mathbf{x}$ is inside or outside the region enclosed by $\\Gamma$.\nThe distance from a point $\\mathbf{x}$ to the set $\\Gamma$ is given by $\\text{dist}(\\mathbf{x}, \\Gamma) = \\inf_{\\mathbf{p} \\in \\Gamma} \\|\\mathbf{x} - \\mathbf{p}\\|$, where $\\|\\cdot\\|$ denotes the Euclidean norm.\n\nIn this problem, the interface $\\Gamma$ at $t=0$ is a circle of radius $R$ centered at the origin, described by the set of points $\\mathbf{p}$ such that $\\|\\mathbf{p}\\| = R$. For any point $\\mathbf{x} \\in \\mathbb{R}^{2}$, the point $\\mathbf{p}^*$ on the circle that is closest to $\\mathbf{x}$ lies on the line segment connecting the origin and $\\mathbf{x}$. This closest point is given by the projection of $\\mathbf{x}$ onto the circle, which is $\\mathbf{p}^* = R \\frac{\\mathbf{x}}{\\|\\mathbf{x}\\|}$ for $\\mathbf{x} \\neq \\mathbf{0}$.\n\nThe distance from $\\mathbf{x}$ to $\\Gamma$ is then:\n$$ \\text{dist}(\\mathbf{x}, \\Gamma) = \\|\\mathbf{x} - \\mathbf{p}^*\\| = \\left\\| \\mathbf{x} - R \\frac{\\mathbf{x}}{\\|\\mathbf{x}\\|} \\right\\| = \\left\\| \\left(1 - \\frac{R}{\\|\\mathbf{x}\\|}\\right) \\mathbf{x} \\right\\| $$\n$$ = \\left| 1 - \\frac{R}{\\|\\mathbf{x}\\|} \\right| \\|\\mathbf{x}\\| = \\left| \\frac{\\|\\mathbf{x}\\| - R}{\\|\\mathbf{x}\\|} \\right| \\|\\mathbf{x}\\| = |\\|\\mathbf{x}\\| - R| $$\nThis gives the unsigned distance. Now, we apply the sign convention: $\\phi(\\mathbf{x})  0$ inside the circle and $\\phi(\\mathbf{x}) > 0$ outside.\n-   If $\\mathbf{x}$ is inside the circle, $\\|\\mathbf{x}\\|  R$, so $\\|\\mathbf{x}\\| - R  0$. This matches the required sign.\n-   If $\\mathbf{x}$ is outside the circle, $\\|\\mathbf{x}\\| > R$, so $\\|\\mathbf{x}\\| - R > 0$. This also matches the required sign.\n-   If $\\mathbf{x}$ is on the circle, $\\|\\mathbf{x}\\| = R$, so $\\|\\mathbf{x}\\| - R = 0$. This correctly identifies the interface.\n\nTherefore, the signed distance function is $\\phi(\\mathbf{x}) = \\|\\mathbf{x}\\| - R$. In Cartesian coordinates $\\mathbf{x}=(x,y)$, this is:\n$$ \\phi(x,y) = \\sqrt{x^{2} + y^{2}} - R $$\n\n**2. Verification of the Signed Distance Property $|\\nabla \\phi|=1$**\n\nWe compute the gradient of $\\phi(x,y) = (x^{2} + y^{2})^{1/2} - R$ with respect to $\\mathbf{x}=(x,y)$.\nThe partial derivative with respect to $x$ is:\n$$ \\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x} \\left((x^{2} + y^{2})^{1/2} - R\\right) = \\frac{1}{2}(x^{2} + y^{2})^{-1/2} (2x) = \\frac{x}{\\sqrt{x^{2} + y^{2}}} $$\nThe partial derivative with respect to $y$ is:\n$$ \\frac{\\partial \\phi}{\\partial y} = \\frac{\\partial}{\\partial y} \\left((x^{2} + y^{2})^{1/2} - R\\right) = \\frac{1}{2}(x^{2} + y^{2})^{-1/2} (2y) = \\frac{y}{\\sqrt{x^{2} + y^{2}}} $$\nThese expressions are well-defined for all $(x,y) \\neq (0,0)$, i.e., for all $\\mathbf{x} \\neq \\mathbf{0}$.\nThe gradient vector is $\\nabla \\phi = \\left( \\frac{x}{\\sqrt{x^{2}+y^{2}}}, \\frac{y}{\\sqrt{x^{2}+y^{2}}} \\right) = \\frac{(x,y)}{\\sqrt{x^{2}+y^{2}}} = \\frac{\\mathbf{x}}{\\|\\mathbf{x}\\|}$.\n\nNow, we compute the magnitude of the gradient, $\\|\\nabla \\phi\\|$:\n$$ \\|\\nabla \\phi\\| = \\sqrt{\\left(\\frac{\\partial \\phi}{\\partial x}\\right)^{2} + \\left(\\frac{\\partial \\phi}{\\partial y}\\right)^{2}} = \\sqrt{\\left(\\frac{x}{\\sqrt{x^{2}+y^{2}}}\\right)^{2} + \\left(\\frac{y}{\\sqrt{x^{2}+y^{2}}}\\right)^{2}} $$\n$$ = \\sqrt{\\frac{x^{2}}{x^{2}+y^{2}} + \\frac{y^{2}}{x^{2}+y^{2}}} = \\sqrt{\\frac{x^{2}+y^{2}}{x^{2}+y^{2}}} = \\sqrt{1} = 1 $$\nThis holds for all $\\mathbf{x} \\neq \\mathbf{0}$, thus verifying the signed distance property, also known as the Eikonal equation.\n\n**3. Points of Non-Differentiability**\n\nThe function $\\phi(x,y) = \\sqrt{x^{2}+y^{2}} - R$ is composed of the Euclidean norm function and a constant. The Euclidean norm $\\|\\mathbf{x}\\| = \\sqrt{x^{2}+y^{2}}$ is not differentiable at the origin $\\mathbf{x}=\\mathbf{0}$. The partial derivatives $\\frac{\\partial \\phi}{\\partial x} = x/\\|\\mathbf{x}\\|$ and $\\frac{\\partial \\phi}{\\partial y} = y/\\|\\mathbf{x}\\|$ are undefined at $(x,y)=(0,0)$ because their denominator is zero. The function has a conical singularity at the origin. Since $R>0$ is given, the origin is a point inside the circle. Thus, $\\phi(\\mathbf{x},0)$ is not differentiable at $\\mathbf{x}=\\mathbf{0}$.\n\n**4. Confirmation of the Normal Vector**\n\nThe outward unit normal vector $\\mathbf{n}$ to the interface $\\Gamma$ can be computed from the level-set function as $\\mathbf{n} = \\frac{\\nabla \\phi}{\\|\\nabla \\phi\\|}$. We evaluate this on $\\Gamma$, where $\\|\\mathbf{x}\\| = R$.\nOn $\\Gamma$, since $R>0$, we have $\\mathbf{x} \\neq \\mathbf{0}$, so the gradient is well-defined.\n$$ \\mathbf{n}|_{\\Gamma} = \\frac{\\nabla \\phi}{\\|\\nabla \\phi\\|} \\bigg|_{\\|\\mathbf{x}\\|=R} = \\frac{\\mathbf{x}/\\|\\mathbf{x}\\|}{1} \\bigg|_{\\|\\mathbf{x}\\|=R} = \\frac{\\mathbf{x}}{R} $$\nFor a circle of radius $R$ centered at the origin, the geometric outward unit normal at a point $\\mathbf{x}$ on its circumference is the vector pointing from the center to $\\mathbf{x}$, normalized to unit length. This is given by $\\frac{\\mathbf{x}}{\\|\\mathbf{x}\\|}$, which equals $\\frac{\\mathbf{x}}{R}$ for points on the circle. The direction is outward, consistent with the sign convention that $\\phi$ increases from negative inside to positive outside the circle, and the gradient points in the direction of increasing $\\phi$. The calculation is therefore consistent with the geometric normal.\n\nThe primary requirement of the problem is to provide the explicit analytic expression for $\\phi(\\mathbf{x},0)$.\nBased on the derivation in part 1, this expression is $\\sqrt{x^{2} + y^{2}} - R$.",
            "answer": "$$\n\\boxed{\\sqrt{x^{2} + y^{2}} - R}\n$$"
        },
        {
            "introduction": "Once the interface is implicitly defined by a level-set function $\\phi$, we can compute essential geometric properties directly from its derivatives. This exercise  focuses on calculating the interface normal vector $\\mathbf{n}$ and curvature $\\kappa$, quantities that are critical for modeling physical phenomena like surface tension. By deriving them for a simple circular interface, you will confirm that the level-set formulation correctly recovers the known geometric curvature.",
            "id": "4092745",
            "problem": "Consider a two-dimensional incompressible complex fluid in a quiescent state whose material interface is captured by a level-set function $\\phi(\\mathbf{x})$ in $\\mathbb{R}^{2}$. The interface $\\Gamma$ is the zero-level set $\\{\\mathbf{x}\\in\\mathbb{R}^{2}:\\phi(\\mathbf{x})=0\\}$. In a local neighborhood of $\\Gamma$, let the level-set function be the signed distance $\\phi(\\mathbf{x})=r-R$ with $r=\\sqrt{x^{2}+y^{2}}$ and $R>0$ a constant radius, so that $\\phi>0$ outside the circle of radius $R$ and $\\phi0$ inside. Adopt the conventional orientation in level-set formulations that the unit normal $\\mathbf{n}$ points in the direction of increasing $\\phi$. Starting from the fundamental definitions of the unit normal and the mean curvature in the level-set formulation and from multivariable calculus identities, analytically derive $\\mathbf{n}(\\mathbf{x})$ in a neighborhood of $\\Gamma$ and the mean curvature $\\kappa$ evaluated on $\\Gamma$. Then, verify the sign of $\\kappa$ under the stated convention and show that, for this geometry, the curvature is spatially uniform along $\\Gamma$.\n\nProvide the closed-form analytic expression for the curvature $\\kappa$ evaluated on the interface $\\Gamma$ as your final answer. No numerical approximation or rounding is required.",
            "solution": "The user has provided a valid problem statement. The task is to derive the unit normal vector and the mean curvature for a circular interface described by a level-set function and to verify its properties.\n\nThe fundamental definitions for the unit normal vector $\\mathbf{n}$ and the mean curvature $\\kappa$ in the context of the level-set method are:\n$$\n\\mathbf{n} = \\frac{\\nabla\\phi}{|\\nabla\\phi|}\n$$\n$$\n\\kappa = \\nabla \\cdot \\mathbf{n}\n$$\nThe problem specifies the level-set function in a two-dimensional Cartesian coordinate system $(x, y)$ as a signed distance function for a circle of radius $R$ centered at the origin:\n$$\n\\phi(x, y) = r - R\n$$\nwhere $r = \\sqrt{x^2 + y^2}$. The interface $\\Gamma$ is the zero-level set, where $\\phi(x, y)=0$, which corresponds to $r=R$. The convention is that the unit normal $\\mathbf{n}$ points in the direction of increasing $\\phi$.\n\nFirst, we derive the unit normal vector $\\mathbf{n}(\\mathbf{x})$. This requires computing the gradient of $\\phi$, denoted $\\nabla\\phi$.\nThe partial derivatives of $\\phi$ with respect to $x$ and $y$ are:\n$$\n\\frac{\\partial\\phi}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sqrt{x^2 + y^2} - R \\right) = \\frac{1}{2\\sqrt{x^2 + y^2}} (2x) = \\frac{x}{\\sqrt{x^2 + y^2}} = \\frac{x}{r}\n$$\n$$\n\\frac{\\partial\\phi}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sqrt{x^2 + y^2} - R \\right) = \\frac{1}{2\\sqrt{x^2 + y^2}} (2y) = \\frac{y}{\\sqrt{x^2 + y^2}} = \\frac{y}{r}\n$$\nThe gradient vector is therefore:\n$$\n\\nabla\\phi = \\frac{x}{r}\\mathbf{i} + \\frac{y}{r}\\mathbf{j}\n$$\nwhere $\\mathbf{i}$ and $\\mathbf{j}$ are the standard basis vectors.\n\nNext, we compute the magnitude of the gradient, $|\\nabla\\phi|$:\n$$\n|\\nabla\\phi| = \\sqrt{\\left(\\frac{\\partial\\phi}{\\partial x}\\right)^2 + \\left(\\frac{\\partial\\phi}{\\partial y}\\right)^2} = \\sqrt{\\left(\\frac{x}{r}\\right)^2 + \\left(\\frac{y}{r}\\right)^2} = \\sqrt{\\frac{x^2 + y^2}{r^2}} = \\sqrt{\\frac{r^2}{r^2}} = 1\n$$\nThis result, $|\\nabla\\phi|=1$, is a defining property of a signed distance function.\n\nNow, we can find the unit normal vector $\\mathbf{n}$:\n$$\n\\mathbf{n} = \\frac{\\nabla\\phi}{|\\nabla\\phi|} = \\frac{\\frac{x}{r}\\mathbf{i} + \\frac{y}{r}\\mathbf{j}}{1} = \\frac{x}{r}\\mathbf{i} + \\frac{y}{r}\\mathbf{j}\n$$\nThis vector represents the outward-pointing radial unit vector. Since $\\phi = r-R$ increases as $r$ increases, this vector correctly points in the direction of increasing $\\phi$, consistent with the stated convention.\n\nSecond, we derive the mean curvature $\\kappa$ by taking the divergence of the unit normal vector $\\mathbf{n}$:\n$$\n\\kappa = \\nabla \\cdot \\mathbf{n} = \\frac{\\partial}{\\partial x}(n_x) + \\frac{\\partial}{\\partial y}(n_y)\n$$\nwhere $n_x = x/r = x(x^2+y^2)^{-1/2}$ and $n_y = y/r = y(x^2+y^2)^{-1/2}$.\n\nWe compute the partial derivatives:\n$$\n\\frac{\\partial n_x}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{x}{\\sqrt{x^2+y^2}} \\right) = \\frac{1 \\cdot \\sqrt{x^2+y^2} - x \\cdot \\frac{x}{\\sqrt{x^2+y^2}}}{x^2+y^2} = \\frac{\\frac{(x^2+y^2) - x^2}{\\sqrt{x^2+y^2}}}{x^2+y^2} = \\frac{y^2}{(x^2+y^2)^{3/2}} = \\frac{y^2}{r^3}\n$$\n$$\n\\frac{\\partial n_y}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\frac{y}{\\sqrt{x^2+y^2}} \\right) = \\frac{1 \\cdot \\sqrt{x^2+y^2} - y \\cdot \\frac{y}{\\sqrt{x^2+y^2}}}{x^2+y^2} = \\frac{\\frac{(x^2+y^2) - y^2}{\\sqrt{x^2+y^2}}}{x^2+y^2} = \\frac{x^2}{(x^2+y^2)^{3/2}} = \\frac{x^2}{r^3}\n$$\nSumming these gives the curvature $\\kappa$ as a function of position:\n$$\n\\kappa(x,y) = \\frac{y^2}{r^3} + \\frac{x^2}{r^3} = \\frac{x^2+y^2}{r^3} = \\frac{r^2}{r^3} = \\frac{1}{r}\n$$\n\nThe problem asks for the curvature evaluated on the interface $\\Gamma$. On $\\Gamma$, we have $r=R$. Substituting this into the expression for $\\kappa$ yields:\n$$\n\\kappa|_{\\Gamma} = \\frac{1}{R}\n$$\n\nFinally, we verify the properties of this result.\n1.  **Sign of $\\kappa$**: The problem provides that $R>0$. Therefore, the curvature $\\kappa = 1/R$ is positive. This is consistent with the common convention where the curvature of an interface is positive if it is convex as viewed from the region with negative $\\phi$ values. Here, $\\phi  0$ is the interior of the circle, which is a convex domain, and its boundary has positive curvature.\n2.  **Uniformity of $\\kappa$**: The derived curvature on the interface, $\\kappa = 1/R$, is a constant value because $R$ is a constant. The curvature does not depend on the specific coordinates $(x, y)$ along the circular path of $\\Gamma$. Thus, the curvature is spatially uniform along the interface, as expected for a perfect circle.\n\nThe closed-form analytic expression for the curvature $\\kappa$ evaluated on the interface $\\Gamma$ is $1/R$.",
            "answer": "$$\\boxed{\\frac{1}{R}}$$"
        },
        {
            "introduction": "With the ability to represent an interface and compute its curvature, we can simulate complex interfacial physics like surface tension. This practice  presents a classic benchmark: a static droplet at equilibrium, where surface tension should be perfectly balanced by a pressure jump. By designing and implementing a numerical experiment, you will investigate a key challenge in multiphase simulations—the emergence of non-physical 'spurious currents'—and learn how to quantify their magnitude as a function of grid resolution.",
            "id": "4092627",
            "problem": "Consider a two-dimensional, incompressible, Newtonian fluid containing a single circular droplet at mechanical equilibrium. The droplet occupies the interior of a circle of radius $R$ centered at $(x_0,y_0)$ in a square periodic domain of side length $L$. The interface is represented by a level-set function $\\phi(x,y)$ that is the signed-distance to the interface, negative inside the droplet and positive outside. The surface tension coefficient is constant and equal to $\\sigma$, the dynamic viscosity is $\\mu$, and the density is $\\rho$. The pressure field is piecewise constant inside and outside the droplet, and the jump in normal stress is balanced by capillarity. Starting from the continuum definitions of incompressibility, momentum balance, and capillary stress balance, derive the exact equilibrium pressure field and explain under what assumptions it reduces to a pressure jump that is proportional to the interfacial curvature and surface tension. Then, design and implement a numerical experiment, using a level-set formulation, to quantify spurious currents—non-zero velocities arising from discretization errors—in the absence of any external forcing.\n\nUse only the following fundamental bases:\n- The incompressible Navier–Stokes equations for a Newtonian fluid: $\\rho\\,\\partial_t \\mathbf{u} + \\rho\\,(\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\mathbf{f}$ and $\\nabla\\cdot\\mathbf{u} = 0$.\n- The capillary stress balance at a smooth interface: the jump in normal stress is proportional to interfacial curvature and surface tension.\n- The level-set method definition of curvature $\\kappa$ and unit normal $\\mathbf{n}$: $\\mathbf{n} = \\nabla \\phi / \\|\\nabla \\phi\\|$ and $\\kappa = \\nabla \\cdot \\mathbf{n}$.\n\nScientific realism requirements:\n- Work in two spatial dimensions so that the equilibrium curvature of a circle is $\\kappa = 1/R$.\n- Assume the droplet is static, so that the physical velocity field is the zero field at equilibrium, and the pressure field is piecewise constant with an interfacial jump.\n- Use a Regularized Dirac Delta to spread the capillary force over a finite thickness proportional to the grid spacing.\n\nNumerical experiment specification:\n- Discretize the square periodic domain $[0,L]\\times[0,L]$ using a uniform grid with $N \\times N$ points and spacing $h = L/N$.\n- Define the level-set field $\\phi(x,y) = \\sqrt{(x-x_0)^2 + (y-y_0)^2} - R$ on the grid.\n- Compute the unit normal $\\mathbf{n} = \\nabla \\phi / \\|\\nabla \\phi\\|$ and curvature $\\kappa = \\nabla \\cdot \\mathbf{n}$ using centered finite differences with periodic boundary conditions.\n- Use a Regularized Dirac Delta $\\delta_\\epsilon(\\phi)$ supported on $|\\phi| \\le \\epsilon$ with $\\epsilon = \\alpha h$ and $\\alpha$ a positive constant, for example $\\delta_\\epsilon(\\phi) = \\frac{1}{2\\epsilon}\\left(1+\\cos\\left(\\pi \\phi/\\epsilon\\right)\\right)$ when $|\\phi| \\le \\epsilon$, and $0$ otherwise.\n- Construct the Continuum Surface Force density $\\mathbf{f}_{\\sigma} = \\sigma\\,\\kappa\\,\\delta_\\epsilon(\\phi)\\,\\mathbf{n}$.\n- Advance the velocity by one explicit time step $\\Delta t$ under $\\mathbf{f}_{\\sigma}$ from rest and then perform an incompressible projection using a periodic Fast Fourier Transform (FFT) to enforce $\\nabla\\cdot \\mathbf{u}^{n+1} = 0$. Specifically, compute the intermediate velocity $\\mathbf{u}^* = \\mathbf{0} + (\\Delta t/\\rho)\\,\\mathbf{f}_{\\sigma}$ and then solve the Poisson equation for the pressure increment to project $\\mathbf{u}^*$ onto a divergence-free field.\n- Measure spurious currents by computing the maximum speed $\\max_{x,y}\\|\\mathbf{u}^{n+1}(x,y)\\|$ after the projection.\n\nPhysical and numerical units:\n- Express the pressure in pascals (Pa) and the velocity in meters per second (m/s).\n- Use radians for any trigonometric evaluations.\n- Report the spurious current magnitudes in meters per second (m/s) as decimal numbers in scientific notation.\n\nTest suite:\n- Fix $L = 1\\,\\mathrm{m}$, $(x_0,y_0) = (L/2,L/2)$, $R = 0.25\\,\\mathrm{m}$, $\\rho = 1000\\,\\mathrm{kg/m^3}$, $\\mu = 1\\,\\mathrm{Pa\\cdot s}$, $\\sigma = 0.072\\,\\mathrm{N/m}$, $\\Delta t = 10^{-5}\\,\\mathrm{s}$, and $\\alpha = 1.5$.\n- Define four grid resolutions $N \\in \\{16, 32, 64, 128\\}$ to assess resolution effects on spurious currents.\n- Include one edge case with $N = 64$ and $\\sigma = 0$ to verify that spurious currents vanish when surface tension is absent.\n- Therefore, the parameter sets are:\n  - Case $1$: $N = 16$, $\\sigma = 0.072\\,\\mathrm{N/m}$.\n  - Case $2$: $N = 32$, $\\sigma = 0.072\\,\\mathrm{N/m}$.\n  - Case $3$: $N = 64$, $\\sigma = 0.072\\,\\mathrm{N/m}$.\n  - Case $4$: $N = 128$, $\\sigma = 0.072\\,\\mathrm{N/m}$.\n  - Case $5$: $N = 64$, $\\sigma = 0\\,\\mathrm{N/m}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each floating-point value formatted in scientific notation with six significant figures, ordered according to the above five cases; for example, \"[a1,a2,a3,a4,a5]\".",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of continuum mechanics and computational fluid dynamics, specifically the level-set method for multiphase flows. The problem is well-posed, objective, self-contained, and describes a standard, non-trivial numerical benchmark for quantifying spurious currents. All required physical and numerical parameters are provided, and the methodology is specified in sufficient detail to permit a unique and verifiable solution.\n\n### Part 1: Theoretical Derivation of the Equilibrium Pressure Field\n\nWe begin with the fundamental equations for an incompressible Newtonian fluid at mechanical equilibrium. At equilibrium, the velocity field $\\mathbf{u}$ is identically zero, $\\mathbf{u} = \\mathbf{0}$, and all time derivatives vanish, $\\partial_t(\\cdot) = 0$.\n\nThe incompressible Navier-Stokes momentum equation is given as:\n$$\n\\rho\\,\\partial_t \\mathbf{u} + \\rho\\,(\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\mathbf{f}\n$$\nUnder equilibrium conditions ($\\mathbf{u} = \\mathbf{0}$), the inertial terms $(\\rho\\,\\partial_t \\mathbf{u}, \\rho\\,(\\mathbf{u}\\cdot\\nabla)\\mathbf{u})$ and the viscous term $(\\mu \\nabla^2 \\mathbf{u})$ are all zero. The momentum equation simplifies to a balance between the pressure gradient and the body force $\\mathbf{f}$:\n$$\n\\mathbf{0} = -\\nabla p + \\mathbf{f}\n$$\nIn this problem, the only force acting on the fluid is the surface tension force, which is confined to the interface between the droplet and the surrounding fluid. Thus, $\\mathbf{f}$ represents the surface tension force density. Away from the interface, in the bulk fluid (both inside and outside the droplet), $\\mathbf{f} = \\mathbf{0}$. In these regions, the momentum equation becomes:\n$$\n\\nabla p = \\mathbf{0}\n$$\nThis implies that the pressure $p$ must be spatially constant within each phase. We can denote the pressure inside the droplet as $p_{in}$ and outside as $p_{out}$. The pressure field is therefore piecewise constant.\n\nThe jump in pressure across the interface is determined by the capillary stress balance. The stress tensor $\\mathbf{T}$ for an incompressible Newtonian fluid is:\n$$\n\\mathbf{T} = -p\\mathbf{I} + \\mu(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)\n$$\nwhere $\\mathbf{I}$ is the identity tensor. At equilibrium, since $\\mathbf{u}=\\mathbf{0}$, the viscous stress component vanishes, and the stress tensor simplifies to the isotropic pressure:\n$$\n\\mathbf{T} = -p\\mathbf{I}\n$$\nThe stress balance condition at the interface states that the jump in the normal traction across the interface is balanced by the surface tension force per unit area. Let $\\mathbf{n}$ be the unit normal vector pointing from the inside to the outside of the droplet. The condition is:\n$$\n[[\\mathbf{T} \\cdot \\mathbf{n}]] = \\sigma \\kappa \\mathbf{n}\n$$\nwhere $[[A]] = A_{out} - A_{in}$ denotes the jump in a quantity $A$ across the interface, $\\sigma$ is the surface tension coefficient, and $\\kappa$ is the local curvature of the interface.\n\nWe evaluate the jump in the stress traction:\n$$\n[[\\mathbf{T} \\cdot \\mathbf{n}]] = (\\mathbf{T}_{out} \\cdot \\mathbf{n}) - (\\mathbf{T}_{in} \\cdot \\mathbf{n}) = (-p_{out}\\mathbf{I} \\cdot \\mathbf{n}) - (-p_{in}\\mathbf{I} \\cdot \\mathbf{n}) = (-p_{out}\\mathbf{n}) - (-p_{in}\\mathbf{n}) = (p_{in} - p_{out})\\mathbf{n}\n$$\nSubstituting this back into the balance equation:\n$$\n(p_{in} - p_{out})\\mathbf{n} = \\sigma \\kappa \\mathbf{n}\n$$\nThis yields the celebrated Young-Laplace equation for the pressure jump $\\Delta p$:\n$$\n\\Delta p = p_{in} - p_{out} = \\sigma \\kappa\n$$\nFor the specific case of a two-dimensional circular droplet of radius $R$, the curvature is constant everywhere on the interface, $\\kappa = 1/R$. The equilibrium pressure jump is therefore:\n$$\n\\Delta p = \\frac{\\sigma}{R}\n$$\nThe equilibrium pressure field is piecewise constant, with $p(x,y) = p_{in}$ inside the droplet and $p(x,y) = p_{out}$ outside, satisfying $p_{in} = p_{out} + \\sigma/R$.\n\nThis reduction to a simple pressure jump proportional to curvature and surface tension is contingent on the crucial assumption that the fluid is at **mechanical equilibrium** ($\\mathbf{u}=\\mathbf{0}$). If the fluid were in motion, the viscous stress term $\\mu(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$ would be non-zero, and the stress balance at the interface would include contributions from velocity gradients, leading to a more complex relationship.\n\n### Part 2: Numerical Experiment for Spurious Currents\n\nSpurious currents are a well-known numerical artifact in simulations of multiphase flows using interface-capturing methods like the level-set method combined with a Continuum Surface Force (CSF) model. Analytically, the equilibrium state requires a perfect balance between the pressure gradient and the surface tension force, i.e., $\\nabla p = \\mathbf{f}_{\\sigma}$. Numerically, this balance is difficult to achieve perfectly due to discretization errors.\n\nThe CSF model approximates the singular surface tension force (which exists only on the infinitesimally thin interface) as a continuous body force spread over a narrow band around the interface. This is achieved using a regularized Dirac delta function, $\\delta_\\epsilon(\\phi)$. The discrete operators for the gradient ($\\nabla_h$), divergence ($\\nabla_h \\cdot$), and the calculation of geometric properties like curvature ($\\kappa_h$) do not perfectly satisfy the identities of vector calculus. Consequently, the discrete pressure gradient $\\nabla_h p_h$ does not exactly cancel the discrete surface tension force $\\mathbf{f}_{\\sigma, h}$. This imbalance creates a net residual force, $\\mathbf{f}_{residual} = \\mathbf{f}_{\\sigma, h} - \\nabla_h p_h \\neq \\mathbf{0}$, which drives unphysical, parasitic flows known as spurious currents.\n\nThe numerical experiment is designed to quantify these currents. The procedure is as follows:\n\n1.  **Initialization**: A uniform Cartesian grid of size $N \\times N$ is defined over the periodic domain $[0,L]\\times[0,L]$. The interface of the circular droplet is implicitly defined by the signed distance function $\\phi(x,y) = \\sqrt{(x-x_0)^2 + (y-y_0)^2} - R$, which is evaluated at each grid node.\n\n2.  **Geometric Calculations**: The unit normal vector $\\mathbf{n} = \\nabla\\phi / \\|\\nabla\\phi\\|$ and the curvature $\\kappa = \\nabla \\cdot \\mathbf{n}$ are computed using second-order centered finite differences with periodic boundary conditions. A small regularization is applied to the denominator $\\|\\nabla\\phi\\|$ to prevent division by zero away from the interface where its value is not needed.\n\n3.  **Surface Tension Force**: The CSF body force density $\\mathbf{f}_{\\sigma}$ is computed using the formula $\\mathbf{f}_{\\sigma} = \\sigma \\kappa \\delta_\\epsilon(\\phi) \\mathbf{n}$. The regularized delta function $\\delta_\\epsilon(\\phi)$ localizes the force to a region of thickness $2\\epsilon$ around the interface ($\\phi=0$), where $\\epsilon = \\alpha h$.\n\n4.  **Time Advancement (Predictor Step)**: Starting from a fluid at rest ($\\mathbf{u}^n = \\mathbf{0}$), an intermediate velocity field $\\mathbf{u}^*$ is computed by applying the surface tension force for one time step $\\Delta t$. Following the problem description, this explicit step is:\n    $$\n    \\mathbf{u}^* = \\mathbf{u}^n + \\frac{\\Delta t}{\\rho}\\mathbf{f}_{\\sigma} = \\frac{\\Delta t}{\\rho}\\mathbf{f}_{\\sigma}\n    $$\n    This field $\\mathbf{u}^*$ does not, in general, satisfy the incompressibility constraint $\\nabla \\cdot \\mathbf{u}^*=0$.\n\n5.  **Projection Step**: A projection method is used to enforce incompressibility. This involves finding a pressure-like scalar field $\\psi$ such that the final velocity $\\mathbf{u}^{n+1} = \\mathbf{u}^* - \\frac{\\Delta t}{\\rho}\\nabla\\psi$ is divergence-free, i.e., $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$. Taking the divergence of the update equation yields a Poisson equation for $\\psi$:\n    $$\n    \\nabla^2 \\psi = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\mathbf{u}^*\n    $$\n    For a periodic domain, this equation is efficiently solved using Fast Fourier Transforms (FFTs). The equation is transformed into Fourier space, solved algebraically for the Fourier coefficients of $\\psi$, and then transformed back to real space. The gradient $\\nabla\\psi$ is then computed (also efficiently in Fourier space) and used to correct the intermediate velocity to obtain the final, divergence-free velocity field $\\mathbf{u}^{n+1}$.\n\n6.  **Measurement**: The magnitude of the spurious currents is quantified by computing the maximum of the velocity norm, $\\max_{x,y} \\|\\mathbf{u}^{n+1}(x,y)\\|$, over the entire computational domain. This value is reported for each test case. The experiment investigates how this magnitude changes with grid resolution $N$ and the surface tension coefficient $\\sigma$. The expectation is that spurious currents will decrease as $N$ increases (i.e., as the grid is refined) and will be zero when $\\sigma = 0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the spurious currents problem for a static droplet using a level-set method.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, sigma)\n        (16, 0.072),  # Case 1\n        (32, 0.072),  # Case 2\n        (64, 0.072),  # Case 3\n        (128, 0.072), # Case 4\n        (64, 0.0),    # Case 5\n    ]\n    \n    # Fixed physical and numerical parameters\n    L = 1.0          # m\n    x0, y0 = L / 2, L / 2 # m\n    R = 0.25         # m\n    rho = 1000.0     # kg/m^3\n    mu = 1.0         # Pa*s (given, but not used in the specified one-step algorithm)\n    dt = 1e-5        # s\n    alpha = 1.5      # dimensionless\n    \n    results = []\n\n    for N, sigma in test_cases:\n        # If sigma is zero, the force is zero, thus spurious currents are zero.\n        if sigma == 0:\n            results.append(f\"{0.0:.5e}\")\n            continue\n\n        # Grid setup\n        h = L / N\n        x = np.linspace(0, L, N, endpoint=False)\n        xx, yy = np.meshgrid(x, x, indexing='xy')\n\n        # Level-set function: signed distance to the circle\n        phi = np.sqrt((xx - x0)**2 + (yy - y0)**2) - R\n\n        # Helper function for periodic centered differences\n        def periodic_gradient_component(field, spacing, axis):\n            return (np.roll(field, -1, axis=axis) - np.roll(field, 1, axis=axis)) / (2 * spacing)\n\n        # Compute gradient of phi\n        grad_phi_x = periodic_gradient_component(phi, h, axis=1)\n        grad_phi_y = periodic_gradient_component(phi, h, axis=0)\n\n        # Compute norm of the gradient, with regularization to avoid division by zero\n        norm_grad_phi = np.sqrt(grad_phi_x**2 + grad_phi_y**2)\n        # The small epsilon is critical. The normal is only well-defined where grad(phi) != 0.\n        # Away from the interface, the force is zero anyway due to the delta function.\n        epsilon_denom = 1e-12 \n        norm_grad_phi[norm_grad_phi  epsilon_denom] = epsilon_denom\n\n        # Compute unit normal vector field\n        nx = grad_phi_x / norm_grad_phi\n        ny = grad_phi_y / norm_grad_phi\n\n        # Compute curvature kappa = div(n)\n        d_nx_dx = periodic_gradient_component(nx, h, axis=1)\n        d_ny_dy = periodic_gradient_component(ny, h, axis=0)\n        kappa = d_nx_dx + d_ny_dy\n\n        # Compute regularized Dirac delta function\n        epsilon_delta = alpha * h\n        delta = np.zeros_like(phi)\n        mask = np.abs(phi) = epsilon_delta\n        delta[mask] = (1 / (2 * epsilon_delta)) * (1 + np.cos(np.pi * phi[mask] / epsilon_delta))\n\n        # Compute Continuum Surface Force (CSF) density\n        fx = sigma * kappa * delta * nx\n        fy = sigma * kappa * delta * ny\n\n        # Predictor step: compute intermediate velocity u* from rest\n        u_star = (dt / rho) * fx\n        v_star = (dt / rho) * fy\n        \n        # Projection step using FFT\n        \n        # Wavenumbers for the Fourier transform\n        k_freq = np.fft.fftfreq(N, d=h) * 2 * np.pi\n        kx, ky = np.meshgrid(k_freq, k_freq, indexing='xy')\n        k_sq = kx**2 + ky**2\n\n        # FFT of intermediate velocity components\n        fft_u_star = np.fft.fft2(u_star)\n        fft_v_star = np.fft.fft2(v_star)\n\n        # FFT of divergence of u*\n        # div_u_star_hat = 1j * kx * fft_u_star + 1j * ky * fft_v_star\n        # The Poisson equation is nabla^2(psi) = (rho/dt) * div(u*).\n        # In Fourier space: -k_sq * psi_hat = (rho/dt) * div_u_star_hat\n        # So, psi_hat = - (rho/dt) * div_u_star_hat / k_sq\n        \n        # We need grad(psi) for the velocity correction. Let's compute its FFT directly.\n        # grad_psi_x_hat = 1j * kx * psi_hat\n        # grad_psi_y_hat = 1j * ky * psi_hat\n        # Combining these:\n        # grad_psi_x_hat = - (rho/dt) * (1j * kx * div_u_star_hat) / k_sq\n        #               = - (rho/dt) * (1j * kx * (1j * kx * fft_u_star + 1j * ky * fft_v_star)) / k_sq\n        #               =   (rho/dt) * (kx**2 * fft_u_star + kx * ky * fft_v_star) / k_sq\n\n        # To avoid numerical issues, handle the k_sq=0 case (DC component)\n        k_sq_reg = np.copy(k_sq)\n        k_sq_reg[0, 0] = 1.0 # The numerator should be zero here anyway\n\n        fft_grad_psi_x = (rho / dt) * (kx**2 * fft_u_star + kx * ky * fft_v_star) / k_sq_reg\n        fft_grad_psi_y = (rho / dt) * (kx * ky * fft_u_star + ky**2 * fft_v_star) / k_sq_reg\n        \n        # The DC component of the pressure gradient must be zero\n        fft_grad_psi_x[0, 0] = 0.0\n        fft_grad_psi_y[0, 0] = 0.0\n\n        # Transform pressure gradient back to real space\n        grad_psi_x = np.fft.ifft2(fft_grad_psi_x).real\n        grad_psi_y = np.fft.ifft2(fft_grad_psi_y).real\n\n        # Corrector step: compute final divergence-free velocity\n        u_final = u_star - (dt / rho) * grad_psi_x\n        v_final = v_star - (dt / rho) * grad_psi_y\n\n        # Calculate the magnitude of spurious currents\n        spurious_current_mag = np.sqrt(u_final**2 + v_final**2)\n        \n        # Find the maximum magnitude over the domain\n        max_spurious_current = np.max(spurious_current_mag)\n        \n        # Append result formatted to 6 significant figures in scientific notation\n        results.append(f\"{max_spurious_current:.5e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}