{
    "hands_on_practices": [
        {
            "introduction": "水平集方法的核心思想是使用一个连续的标量场 $\\phi$ 来隐式地表示界面。一个特别理想的选择是符号距离函数（Signed Distance Function, SDF），因为它具有优良的数学性质，例如其梯度范数恒为1。这项基础练习将引导您为一个简单而又至关重要的几何形状——圆形——构建其符号距离函数，从而巩固您对几何形状与其隐式场表示之间联系的理解。",
            "id": "4092664",
            "problem": "考虑一个静止不可压缩复杂流体中的二维不相容界面，在水平集方法中由一个标量函数 $\\phi(\\mathbf{x},t)$ 表示，其零水平集 $\\{\\mathbf{x}:\\phi(\\mathbf{x},t)=0\\}$ 与物质界面重合。在初始时刻 $t=0$，界面 $\\Gamma$ 是 $\\mathbb{R}^{2}$ 中以原点为中心、半径为 $R>0$ 的圆。采用水平集方法中的标准符号约定：在由 $\\Gamma$ 界定的区域内部 $\\phi(\\mathbf{x},t)<0$，在外部 $\\phi(\\mathbf{x},t)>0$。\n\n从欧几里得空间中集合的符号距离定义出发，构造一个用笛卡尔坐标 $\\mathbf{x}=(x,y)$ 和 $R$ 表示的 $\\phi(\\mathbf{x},0)$ 的显式解析表达式，使得 $\\phi(\\mathbf{x},0)$ 是一个满足上述符号约定的到 $\\Gamma$ 的符号距离函数。然后，通过第一性原理直接求导，验证对于所有 $\\mathbf{x}\\neq\\mathbf{0}$，符号距离属性 $|\\nabla \\phi(\\mathbf{x},0)|=1$ 成立，并找出可微性失效的任何点。最后，确认在 $\\Gamma$ 上计算出的外向单位法向量 $\\mathbf{n}$（作为 $\\nabla \\phi/|\\nabla \\phi|$）与几何法向量一致。\n\n最终答案仅需提供 $\\phi(\\mathbf{x},0)$ 的显式解析表达式。无需四舍五入。最终答案中不要包含单位。",
            "solution": "在进行求解之前，对问题陈述的有效性进行评估。\n\n### 第1步：提取已知条件\n-   系统是一个静止不可压缩复杂流体中的二维不相容界面。\n-   界面由标量函数 $\\phi(\\mathbf{x},t)$ 的零水平集表示，即 $\\{\\mathbf{x} : \\phi(\\mathbf{x},t)=0\\}$。\n-   在初始时刻 $t=0$，界面 $\\Gamma$ 是 $\\mathbb{R}^{2}$ 中以原点为中心、半径为 $R>0$ 的圆。\n-   位置向量为 $\\mathbf{x}=(x,y)$。\n-   水平集函数的符号约定为：在由 $\\Gamma$ 界定的区域内部 $\\phi(\\mathbf{x},t)<0$，在外部 $\\phi(\\mathbf{x},t)>0$。\n-   任务是：\n    1.  构造一个作为到 $\\Gamma$ 的符号距离函数的 $\\phi(\\mathbf{x},0)$ 的显式解析表达式。\n    2.  通过直接求导，验证对于所有 $\\mathbf{x}\\neq\\mathbf{0}$，符号距离属性 $|\\nabla \\phi(\\mathbf{x},0)|=1$ 成立。\n    3.  找出 $\\phi(\\mathbf{x},0)$ 的可微性失效的点。\n    4.  确认在 $\\Gamma$ 上的外向单位法向量 $\\mathbf{n} = \\nabla \\phi/|\\nabla \\phi|$ 与几何法向量一致。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据：** 该问题是水平集方法中的一个标准练习，这是计算流体力学和材料科学中广泛使用的技术。符号距离函数、程函方程（$|\\nabla \\phi|=1$）以及梯度的几何解释等概念，在微分几何和数值分析中是基础且成熟的概念。物理背景是现实的，并为该数学任务提供了有效的前提。\n-   **适定性：** 该问题定义清晰且自洽。几何形状（一个圆）已指定，符号约定明确，任务具体。所提供的信息足以推导符号距离函数的唯一解析表达式并执行所需的验证。\n-   **客观性：** 问题以精确、形式化的数学语言陈述，没有任何主观性或模糊性。\n\n该问题没有表现出任何诸如科学上不健全、不完整、矛盾或不可行之类的缺陷。它是计算复杂流体和应用数学领域内一个适定、客观且有科学依据的问题。\n\n### 第3步：结论与行动\n问题是有效的。将提供一个完整的、有理有据的解答。\n\n### 解题推导\n求解过程首先从定义出发构造符号距离函数，然后通过微分验证其性质。为清晰起见，省略了时间依赖性，并使用 $\\phi(\\mathbf{x})$ 来表示 $\\phi(\\mathbf{x},0)$。\n\n**1. 构造符号距离函数 $\\phi(\\mathbf{x})$**\n\n根据定义，到界面 $\\Gamma$ 的符号距离函数 $\\phi(\\mathbf{x})$ 提供了从点 $\\mathbf{x}$ 到 $\\Gamma$ 的最短欧几里得距离，其符号由点 $\\mathbf{x}$ 是在 $\\Gamma$ 包围的区域内部还是外部决定。\n从点 $\\mathbf{x}$ 到集合 $\\Gamma$ 的距离由 $\\text{dist}(\\mathbf{x}, \\Gamma) = \\inf_{\\mathbf{p} \\in \\Gamma} \\|\\mathbf{x} - \\mathbf{p}\\|$ 给出，其中 $\\|\\cdot\\|$ 表示欧几里得范数。\n\n在这个问题中，$t=0$ 时的界面 $\\Gamma$ 是一个以原点为中心、半径为 $R$ 的圆，由满足 $\\|\\mathbf{p}\\| = R$ 的点集 $\\mathbf{p}$ 描述。对于任意点 $\\mathbf{x} \\in \\mathbb{R}^{2}$，圆上离 $\\mathbf{x}$ 最近的点 $\\mathbf{p}^*$ 位于连接原点和 $\\mathbf{x}$ 的线段上。对于 $\\mathbf{x} \\neq \\mathbf{0}$，这个最近点由 $\\mathbf{x}$ 在圆上的投影给出，即 $\\mathbf{p}^* = R \\frac{\\mathbf{x}}{\\|\\mathbf{x}\\|}$。\n\n$\\mathbf{x}$ 到 $\\Gamma$ 的距离为：\n$$ \\text{dist}(\\mathbf{x}, \\Gamma) = \\|\\mathbf{x} - \\mathbf{p}^*\\| = \\left\\| \\mathbf{x} - R \\frac{\\mathbf{x}}{\\|\\mathbf{x}\\|} \\right\\| = \\left\\| \\left(1 - \\frac{R}{\\|\\mathbf{x}\\|}\\right) \\mathbf{x} \\right\\| $$\n$$ = \\left| 1 - \\frac{R}{\\|\\mathbf{x}\\|} \\right| \\|\\mathbf{x}\\| = \\left| \\frac{\\|\\mathbf{x}\\| - R}{\\|\\mathbf{x}\\|} \\right| \\|\\mathbf{x}\\| = |\\|\\mathbf{x}\\| - R| $$\n这就得到了无符号距离。现在，我们应用符号约定：在圆内 $\\phi(\\mathbf{x})  0$，在圆外 $\\phi(\\mathbf{x})  0$。\n-   如果 $\\mathbf{x}$ 在圆内，则 $\\|\\mathbf{x}\\|  R$，所以 $\\|\\mathbf{x}\\| - R  0$。这与要求的符号相符。\n-   如果 $\\mathbf{x}$ 在圆外，则 $\\|\\mathbf{x}\\|  R$，所以 $\\|\\mathbf{x}\\| - R  0$。这也与要求的符号相符。\n-   如果 $\\mathbf{x}$ 在圆上，则 $\\|\\mathbf{x}\\| = R$，所以 $\\|\\mathbf{x}\\| - R = 0$。这正确定位了界面。\n\n因此，符号距离函数为 $\\phi(\\mathbf{x}) = \\|\\mathbf{x}\\| - R$。在笛卡尔坐标 $\\mathbf{x}=(x,y)$ 中，表达式为：\n$$ \\phi(x,y) = \\sqrt{x^{2} + y^{2}} - R $$\n\n**2. 验证符号距离属性 $|\\nabla \\phi|=1$**\n\n我们计算 $\\phi(x,y) = (x^{2} + y^{2})^{1/2} - R$ 关于 $\\mathbf{x}=(x,y)$ 的梯度。\n关于 $x$ 的偏导数是：\n$$ \\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x} \\left((x^{2} + y^{2})^{1/2} - R\\right) = \\frac{1}{2}(x^{2} + y^{2})^{-1/2} (2x) = \\frac{x}{\\sqrt{x^{2} + y^{2}}} $$\n关于 $y$ 的偏导数是：\n$$ \\frac{\\partial \\phi}{\\partial y} = \\frac{\\partial}{\\partial y} \\left((x^{2} + y^{2})^{1/2} - R\\right) = \\frac{1}{2}(x^{2} + y^{2})^{-1/2} (2y) = \\frac{y}{\\sqrt{x^{2} + y^{2}}} $$\n这些表达式对于所有 $(x,y) \\neq (0,0)$，即对于所有 $\\mathbf{x} \\neq \\mathbf{0}$ 都是良定义的。\n梯度向量为 $\\nabla \\phi = \\left( \\frac{x}{\\sqrt{x^{2}+y^{2}}}, \\frac{y}{\\sqrt{x^{2}+y^{2}}} \\right) = \\frac{(x,y)}{\\sqrt{x^{2}+y^{2}}} = \\frac{\\mathbf{x}}{\\|\\mathbf{x}\\|}$。\n\n现在，我们计算梯度的模，$\\|\\nabla \\phi\\|$：\n$$ \\|\\nabla \\phi\\| = \\sqrt{\\left(\\frac{\\partial \\phi}{\\partial x}\\right)^{2} + \\left(\\frac{\\partial \\phi}{\\partial y}\\right)^{2}} = \\sqrt{\\left(\\frac{x}{\\sqrt{x^{2}+y^{2}}}\\right)^{2} + \\left(\\frac{y}{\\sqrt{x^{2}+y^{2}}}\\right)^{2}} $$\n$$ = \\sqrt{\\frac{x^{2}}{x^{2}+y^{2}} + \\frac{y^{2}}{x^{2}+y^{2}}} = \\sqrt{\\frac{x^{2}+y^{2}}{x^{2}+y^{2}}} = \\sqrt{1} = 1 $$\n这对所有 $\\mathbf{x} \\neq \\mathbf{0}$ 成立，从而验证了符号距离属性，也称为程函方程。\n\n**3. 不可微点**\n\n函数 $\\phi(x,y) = \\sqrt{x^{2}+y^{2}} - R$ 由欧几里得范数函数和一个常数组成。欧几里得范数 $\\|\\mathbf{x}\\| = \\sqrt{x^{2}+y^{2}}$ 在原点 $\\mathbf{x}=\\mathbf{0}$ 处不可微。偏导数 $\\frac{\\partial \\phi}{\\partial x} = x/\\|\\mathbf{x}\\|$ 和 $\\frac{\\partial \\phi}{\\partial y} = y/\\|\\mathbf{x}\\|$ 在 $(x,y)=(0,0)$ 处未定义，因为它们的分母为零。函数在原点处有一个锥形奇点。由于给定 $R0$，原点是圆内的一个点。因此，$\\phi(\\mathbf{x},0)$ 在 $\\mathbf{x}=\\mathbf{0}$ 处不可微。\n\n**4. 法向量的确认**\n\n到界面 $\\Gamma$ 的外向单位法向量 $\\mathbf{n}$ 可以从水平集函数计算得出，即 $\\mathbf{n} = \\frac{\\nabla \\phi}{\\|\\nabla \\phi\\|}$。我们在 $\\Gamma$ 上（其中 $\\|\\mathbf{x}\\| = R$）计算该值。\n在 $\\Gamma$ 上，由于 $R0$，我们有 $\\mathbf{x} \\neq \\mathbf{0}$，因此梯度是良定义的。\n$$ \\mathbf{n}|_{\\Gamma} = \\frac{\\nabla \\phi}{\\|\\nabla \\phi\\|} \\bigg|_{\\|\\mathbf{x}\\|=R} = \\frac{\\mathbf{x}/\\|\\mathbf{x}\\|}{1} \\bigg|_{\\|\\mathbf{x}\\|=R} = \\frac{\\mathbf{x}}{R} $$\n对于以原点为中心、半径为 $R$ 的圆，其圆周上一点 $\\mathbf{x}$ 的几何外向单位法向量是指向从中心到 $\\mathbf{x}$ 的向量，并归一化为单位长度。这由 $\\frac{\\mathbf{x}}{\\|\\mathbf{x}\\|}$ 给出，对于圆上的点，它等于 $\\frac{\\mathbf{x}}{R}$。方向是向外的，这与符号约定（即 $\\phi$ 从圆内负值增加到圆外正值）一致，并且梯度指向 $\\phi$ 增加的方向。因此，计算结果与几何法向量一致。\n\n问题的首要要求是提供 $\\phi(\\mathbf{x},0)$ 的显式解析表达式。\n根据第1部分的推导，该表达式为 $\\sqrt{x^{2} + y^{2}} - R$。",
            "answer": "$$\n\\boxed{\\sqrt{x^{2} + y^{2}} - R}\n$$"
        },
        {
            "introduction": "一旦我们用水平集函数 $\\phi$ 表示了界面，我们就可以利用它来提取关键的物理信息。对于多相流模拟至关重要的界面法向量 $\\mathbf{n}$ 和曲率 $\\kappa$ 等几何量，可以通过对 $\\phi$ 场进行微分运算直接计算得出。这项练习将指导您完成这些量的解析推导，它不仅能加深您对连接 $\\phi$ 与几何的核心公式的理解，还能通过得到已知的圆形曲率来验证计算的正确性。",
            "id": "4092745",
            "problem": "考虑一个处于静止状态的二维不可压缩复杂流体，其物质界面由 $\\,\\mathbb{R}^{2}\\,$ 中的水平集函数 $\\,\\phi(\\mathbf{x})\\,$ 描述。界面 $\\,\\Gamma\\,$ 是零水平集 $\\,\\{\\mathbf{x}\\in\\mathbb{R}^{2}:\\phi(\\mathbf{x})=0\\}\\,$。在 $\\,\\Gamma\\,$ 的一个局部邻域内，设水平集函数为符号距离 $\\,\\phi(\\mathbf{x})=r-R\\,$，其中 $\\,r=\\sqrt{x^{2}+y^{2}}\\,$ 且 $\\,R0\\,$ 是一个恒定半径，因此在半径为 $\\,R\\,$ 的圆外 $\\,\\phi0\\,$，在圆内 $\\,\\phi0\\,$。采用水平集公式中的常规方向，即单位法向量 $\\,\\mathbf{n}\\,$ 指向 $\\,\\phi\\,$ 增加的方向。从水平集公式中单位法向量和平均曲率的基本定义以及多变量微积分恒等式出发，解析推导在 $\\,\\Gamma\\,$ 邻域内的 $\\,\\mathbf{n}(\\mathbf{x})\\,$ 和在 $\\,\\Gamma\\,$ 上求值的平均曲率 $\\,\\kappa\\,$。然后，在所述约定下验证 $\\,\\kappa\\,$ 的符号，并证明对于此几何形状，曲率沿 $\\,\\Gamma\\,$ 是空间均匀的。\n\n请提供在界面 $\\,\\Gamma\\,$ 上求值的曲率 $\\,\\kappa\\,$ 的闭式解析表达式作为最终答案。无需进行数值近似或四舍五入。",
            "solution": "用户提供了一个有效的问题陈述。任务是为一个由水平集函数描述的圆形界面推导单位法向量和平均曲率，并验证其性质。\n\n在水平集方法的背景下，单位法向量 $\\,\\mathbf{n}\\,$ 和平均曲率 $\\,\\kappa\\,$ 的基本定义是：\n$$\n\\mathbf{n} = \\frac{\\nabla\\phi}{|\\nabla\\phi|}\n$$\n$$\n\\kappa = \\nabla \\cdot \\mathbf{n}\n$$\n问题在一个二维笛卡尔坐标系 $\\,(x, y)\\,$ 中将水平集函数指定为以原点为中心、半径为 $\\,R\\,$ 的圆的符号距离函数：\n$$\n\\phi(x, y) = r - R\n$$\n其中 $\\,r = \\sqrt{x^2 + y^2}\\,$。界面 $\\,\\Gamma\\,$ 是零水平集，其中 $\\,\\phi(x, y)=0\\,$，对应于 $\\,r=R\\,$。约定单位法向量 $\\,\\mathbf{n}\\,$ 指向 $\\,\\phi\\,$ 增加的方向。\n\n首先，我们推导单位法向量 $\\,\\mathbf{n}(\\mathbf{x})\\,$。这需要计算 $\\,\\phi\\,$ 的梯度，记为 $\\,\\nabla\\phi\\,$。\n$\\,\\phi\\,$ 关于 $\\,x\\,$ 和 $\\,y\\,$ 的偏导数是：\n$$\n\\frac{\\partial\\phi}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sqrt{x^2 + y^2} - R \\right) = \\frac{1}{2\\sqrt{x^2 + y^2}} (2x) = \\frac{x}{\\sqrt{x^2 + y^2}} = \\frac{x}{r}\n$$\n$$\n\\frac{\\partial\\phi}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sqrt{x^2 + y^2} - R \\right) = \\frac{1}{2\\sqrt{x^2 + y^2}} (2y) = \\frac{y}{\\sqrt{x^2 + y^2}} = \\frac{y}{r}\n$$\n因此，梯度向量是：\n$$\n\\nabla\\phi = \\frac{x}{r}\\mathbf{i} + \\frac{y}{r}\\mathbf{j}\n$$\n其中 $\\,\\mathbf{i}\\,$ 和 $\\,\\mathbf{j}\\,$ 是标准基向量。\n\n接下来，我们计算梯度的模 $\\,|\\nabla\\phi|\\,$：\n$$\n|\\nabla\\phi| = \\sqrt{\\left(\\frac{\\partial\\phi}{\\partial x}\\right)^2 + \\left(\\frac{\\partial\\phi}{\\partial y}\\right)^2} = \\sqrt{\\left(\\frac{x}{r}\\right)^2 + \\left(\\frac{y}{r}\\right)^2} = \\sqrt{\\frac{x^2 + y^2}{r^2}} = \\sqrt{\\frac{r^2}{r^2}} = 1\n$$\n这个结果 $\\,|\\nabla\\phi|=1\\,$ 是符号距离函数的一个定义性属性。\n\n现在，我们可以求出单位法向量 $\\,\\mathbf{n}\\,$：\n$$\n\\mathbf{n} = \\frac{\\nabla\\phi}{|\\nabla\\phi|} = \\frac{\\frac{x}{r}\\mathbf{i} + \\frac{y}{r}\\mathbf{j}}{1} = \\frac{x}{r}\\mathbf{i} + \\frac{y}{r}\\mathbf{j}\n$$\n这个向量表示向外的径向单位向量。由于 $\\,\\phi = r-R\\,$ 随着 $\\,r\\,$ 的增加而增加，这个向量正确地指向 $\\,\\phi\\,$ 增加的方向，与所述约定一致。\n\n其次，我们通过取单位法向量 $\\,\\mathbf{n}\\,$ 的散度来推导平均曲率 $\\,\\kappa\\,$：\n$$\n\\kappa = \\nabla \\cdot \\mathbf{n} = \\frac{\\partial}{\\partial x}(n_x) + \\frac{\\partial}{\\partial y}(n_y)\n$$\n其中 $\\,n_x = x/r = x(x^2+y^2)^{-1/2}\\,$ 且 $\\,n_y = y/r = y(x^2+y^2)^{-1/2}\\,$。\n\n我们计算偏导数：\n$$\n\\frac{\\partial n_x}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{x}{\\sqrt{x^2+y^2}} \\right) = \\frac{1 \\cdot \\sqrt{x^2+y^2} - x \\cdot \\frac{x}{\\sqrt{x^2+y^2}}}{x^2+y^2} = \\frac{\\frac{(x^2+y^2) - x^2}{\\sqrt{x^2+y^2}}}{x^2+y^2} = \\frac{y^2}{(x^2+y^2)^{3/2}} = \\frac{y^2}{r^3}\n$$\n$$\n\\frac{\\partial n_y}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\frac{y}{\\sqrt{x^2+y^2}} \\right) = \\frac{1 \\cdot \\sqrt{x^2+y^2} - y \\cdot \\frac{y}{\\sqrt{x^2+y^2}}}{x^2+y^2} = \\frac{\\frac{(x^2+y^2) - y^2}{\\sqrt{x^2+y^2}}}{x^2+y^2} = \\frac{x^2}{(x^2+y^2)^{3/2}} = \\frac{x^2}{r^3}\n$$\n将这些相加得到曲率 $\\,\\kappa\\,$ 作为位置的函数：\n$$\n\\kappa(x,y) = \\frac{y^2}{r^3} + \\frac{x^2}{r^3} = \\frac{x^2+y^2}{r^3} = \\frac{r^2}{r^3} = \\frac{1}{r}\n$$\n\n问题要求在界面 $\\,\\Gamma\\,$ 上求值的曲率。在 $\\,\\Gamma\\,$ 上，我们有 $\\,r=R\\,$。将此代入 $\\,\\kappa\\,$ 的表达式中得到：\n$$\n\\kappa|_{\\Gamma} = \\frac{1}{R}\n$$\n\n最后，我们验证此结果的性质。\n1.  **$\\,\\kappa\\,$ 的符号**：问题规定 $\\,R0\\,$。因此，曲率 $\\,\\kappa = 1/R\\,$ 是正的。这与通用约定一致，即如果从 $\\,\\phi\\,$ 值为负的区域看，界面的曲率为正，则该界面是凸的。此处，$\\,\\phi  0\\,$ 是圆的内部，这是一个凸域，其边界具有正曲率。\n2.  **$\\,\\kappa\\,$ 的均匀性**：在界面上推导出的曲率 $\\,\\kappa = 1/R\\,$ 是一个常数值，因为 $\\,R\\,$ 是一个常数。曲率不依赖于沿 $\\,\\Gamma\\,$ 的圆形路径的具体坐标 $\\,(x, y)\\,$。因此，曲率沿界面是空间均匀的，这与一个正圆的情况相符。\n\n在界面 $\\,\\Gamma\\,$ 上求值的曲率 $\\,\\kappa\\,$ 的闭式解析表达式是 $\\,1/R\\,$。",
            "answer": "$$\\boxed{\\frac{1}{R}}$$"
        },
        {
            "introduction": "本练习将前面的概念应用于一个完整的计算流体动力学问题中，即一个在表面张力作用下达到平衡的静态液滴。在数值模拟中，表面张力通常通过连续表面力（Continuum Surface Force, CSF）模型来施加，该模型依赖于从水平集函数计算出的曲率 $\\kappa$。然而，计算曲率和施加作用力时的离散误差会破坏精密的力学平衡，从而产生非物理的“伪电流”（spurious currents）。这项经典基准测试可让您亲手实现这一物理模型，并量化这一每个从业者都必须理解和控制的关键数值伪影。",
            "id": "4092627",
            "problem": "考虑一种二维不可压缩牛顿流体，其中包含一个处于力学平衡状态的圆形液滴。该液滴占据一个边长为 $L$ 的方形周期性域内，以 $(x_0,y_0)$ 为中心、半径为 $R$ 的圆形区域。界面由水平集函数 $\\phi(x,y)$ 表示，该函数是到界面的有符号距离，液滴内部为负，外部为正。表面张力系数为常数 $\\sigma$，动力粘度为 $\\mu$，密度为 $\\rho$。压力场在液滴内外是分段常数，法向应力的跳跃由毛细作用力平衡。从不可压缩性、动量平衡和毛细应力平衡的连续介质定义出发，推导精确的平衡压力场，并解释在何种假设下，它简化为与界面曲率和表面张力成正比的压力跳跃。然后，设计并实现一个使用水平集公式的数值实验，以量化在没有任何外力作用的情况下由离散化误差产生的伪电流——即非零速度。\n\n仅使用以下基本依据：\n- 牛顿流体的不可压缩Navier–Stokes方程：$\\rho\\,\\partial_t \\boldsymbol{u} + \\rho\\,(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} = -\\nabla p + \\mu \\nabla^2 \\boldsymbol{u} + \\boldsymbol{f}$ 和 $\\nabla\\cdot\\boldsymbol{u} = 0$。\n- 光滑界面上的毛细应力平衡：法向应力的跳跃与界面曲率和表面张力成正比。\n- 水平集方法中曲率 $\\kappa$ 和单位法向量 $\\boldsymbol{n}$ 的定义：$\\boldsymbol{n} = \\nabla \\phi / \\lVert \\nabla \\phi \\rVert$ 和 $\\kappa = \\nabla \\cdot \\boldsymbol{n}$。\n\n科学真实性要求：\n- 在二维空间中进行，因此圆的平衡曲率为 $\\kappa = 1/R$。\n- 假设液滴是静态的，因此在平衡状态下，物理速度场为零场，压力场为分段常数，并在界面处有跳跃。\n- 使用正则化的狄拉克δ函数（Regularized Dirac Delta）将毛细作用力分布在与网格间距成比例的有限厚度上。\n\n数值实验规范：\n- 使用具有 $N \\times N$ 个点和间距 $h = L/N$ 的均匀网格对方形周期性域 $[0,L]\\times[0,L]$ 进行离散化。\n- 在网格上定义水平集场 $\\phi(x,y) = \\sqrt{(x-x_0)^2 + (y-y_0)^2} - R$。\n- 使用带有周期性边界条件的中心有限差分法计算单位法向量 $\\boldsymbol{n} = \\nabla \\phi / \\lVert \\nabla \\phi \\rVert$ 和曲率 $\\kappa = \\nabla \\cdot \\boldsymbol{n}$。\n- 使用一个正则化的狄拉克δ函数 $\\delta_\\epsilon(\\phi)$，其支撑集在 $|\\phi| \\le \\epsilon$ 上，其中 $\\epsilon = \\alpha h$，$\\alpha$ 是一个正常数，例如当 $|\\phi| \\le \\epsilon$ 时 $\\delta_\\epsilon(\\phi) = \\frac{1}{2\\epsilon}\\left(1+\\cos\\left(\\pi \\phi/\\epsilon\\right)\\right)$，否则为 $0$。\n- 构建连续表面力（Continuum Surface Force）密度 $\\boldsymbol{f}_{\\sigma} = \\sigma\\,\\kappa\\,\\delta_\\epsilon(\\phi)\\,\\boldsymbol{n}$。\n- 在 $\\boldsymbol{f}_{\\sigma}$ 作用下，将速度从静止状态显式推进一个时间步长 $\\Delta t$，然后使用周期性快速傅里叶变换（FFT）进行不可压缩投影，以强制 $\\nabla\\cdot \\boldsymbol{u}^{n+1} = 0$。具体来说，计算中间速度 $\\boldsymbol{u}^* = \\boldsymbol{0} + (\\Delta t/\\rho)\\,\\boldsymbol{f}_{\\sigma}$，然后求解压力增量的泊松方程，将 $\\boldsymbol{u}^*$ 投影到无散度场上。\n- 通过计算投影后的最大速度 $\\max_{x,y}\\lVert \\boldsymbol{u}^{n+1}(x,y)\\rVert$ 来测量伪电流。\n\n物理和数值单位：\n- 压力以帕斯卡（Pa）表示，速度以米/秒（m/s）表示。\n- 任何三角函数求值均使用弧度。\n- 以科学记数法的小数形式报告伪电流的大小，单位为米/秒（m/s）。\n\n测试套件：\n- 固定 $L = 1\\,\\mathrm{m}$，$(x_0,y_0) = (L/2,L/2)$，$R = 0.25\\,\\mathrm{m}$，$\\rho = 1000\\,\\mathrm{kg/m^3}$，$\\mu = 1\\,\\mathrm{Pa\\cdot s}$，$\\sigma = 0.072\\,\\mathrm{N/m}$，$\\Delta t = 10^{-5}\\,\\mathrm{s}$ 和 $\\alpha = 1.5$。\n- 定义四种网格分辨率 $N \\in \\{16, 32, 64, 128\\}$，以评估分辨率对伪电流的影响。\n- 包含一个 $N = 64$ 且 $\\sigma = 0$ 的边缘案例，以验证在没有表面张力时伪电流消失。\n- 因此，参数集为：\n  - 案例 1：$N = 16$，$\\sigma = 0.072\\,\\mathrm{N/m}$。\n  - 案例 2：$N = 32$，$\\sigma = 0.072\\,\\mathrm{N/m}$。\n  - 案例 3：$N = 64$，$\\sigma = 0.072\\,\\mathrm{N/m}$。\n  - 案例 4：$N = 128$，$\\sigma = 0.072\\,\\mathrm{N/m}$。\n  - 案例 5：$N = 64$，$\\sigma = 0\\,\\mathrm{N/m}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个浮点值都以科学记数法格式化，保留六位有效数字，并按上述五个案例的顺序排列；例如，“[a1,a2,a3,a4,a5]”。",
            "solution": "问题陈述经评估有效。它在科学上基于连续介质力学和计算流体动力学的原理，特别是用于多相流的水平集方法。该问题是适定的、客观的、自洽的，并描述了一个用于量化伪电流的标准的、非平凡的数值基准。所有必需的物理和数值参数都已提供，并且方法的详尽程度足以获得唯一且可验证的解。\n\n### 第一部分：平衡压力场的理论推导\n\n我们从不可压缩牛顿流体在力学平衡状态下的基本方程开始。在平衡状态下，速度场 $\\boldsymbol{u}$ 恒为零，即 $\\boldsymbol{u} = \\boldsymbol{0}$，并且所有时间导数都消失，$\\partial_t(\\cdot) = 0$。\n\n不可压缩Navier-Stokes动量方程为：\n$$\n\\rho\\,\\partial_t \\boldsymbol{u} + \\rho\\,(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} = -\\nabla p + \\mu \\nabla^2 \\boldsymbol{u} + \\boldsymbol{f}\n$$\n在平衡条件下（$\\boldsymbol{u} = \\boldsymbol{0}$），惯性项 $(\\rho\\,\\partial_t \\boldsymbol{u}, \\rho\\,(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u})$ 和粘性项 $(\\mu \\nabla^2 \\boldsymbol{u})$ 均为零。动量方程简化为压力梯度和体力 $\\boldsymbol{f}$ 之间的平衡：\n$$\n\\boldsymbol{0} = -\\nabla p + \\boldsymbol{f}\n$$\n在这个问题中，作用在流体上的唯一力是表面张力，它被限制在液滴和周围流体之间的界面上。因此，$\\boldsymbol{f}$ 代表表面张力密度。在远离界面的流体本体区域（液滴内部和外部），$\\boldsymbol{f} = \\boldsymbol{0}$。在这些区域，动量方程变为：\n$$\n\\nabla p = \\boldsymbol{0}\n$$\n这意味着压力 $p$ 在每个相内必须是空间常数。我们可以将液滴内部的压力表示为 $p_{in}$，外部的压力表示为 $p_{out}$。因此，压力场是分段常数。\n\n跨界面的压力跳跃由毛细应力平衡决定。不可压缩牛顿流体的应力张量 $\\boldsymbol{T}$ 为：\n$$\n\\boldsymbol{T} = -p\\boldsymbol{I} + \\mu(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^T)\n$$\n其中 $\\boldsymbol{I}$ 是单位张量。在平衡状态下，由于 $\\boldsymbol{u}=\\boldsymbol{0}$，粘性应力分量消失，应力张量简化为各向同性的压力：\n$$\n\\boldsymbol{T} = -p\\boldsymbol{I}\n$$\n界面上的应力平衡条件指出，跨界面的法向牵引力跳跃由单位面积的表面张力平衡。设 $\\boldsymbol{n}$ 为从液滴内部指向外部的单位法向量。该条件为：\n$$\n[[\\boldsymbol{T} \\cdot \\boldsymbol{n}]] = \\sigma \\kappa \\boldsymbol{n}\n$$\n其中 $[[A]] = A_{out} - A_{in}$ 表示量 $A$ 跨界面的跳跃，$\\sigma$ 是表面张力系数，$\\kappa$ 是界面的局部曲率。\n\n我们计算应力牵引力的跳跃：\n$$\n[[\\boldsymbol{T} \\cdot \\boldsymbol{n}]] = (\\boldsymbol{T}_{out} \\cdot \\boldsymbol{n}) - (\\boldsymbol{T}_{in} \\cdot \\boldsymbol{n}) = (-p_{out}\\boldsymbol{I} \\cdot \\boldsymbol{n}) - (-p_{in}\\boldsymbol{I} \\cdot \\boldsymbol{n}) = (-p_{out}\\boldsymbol{n}) - (-p_{in}\\boldsymbol{n}) = (p_{in} - p_{out})\\boldsymbol{n}\n$$\n将其代回平衡方程：\n$$\n(p_{in} - p_{out})\\boldsymbol{n} = \\sigma \\kappa \\boldsymbol{n}\n$$\n这就得到了著名的Young-Laplace方程，用于计算压力跳跃 $\\Delta p$：\n$$\n\\Delta p = p_{in} - p_{out} = \\sigma \\kappa\n$$\n对于半径为 $R$ 的二维圆形液滴的特定情况，界面上各处的曲率都是恒定的，$\\kappa = 1/R$。因此，平衡压力跳跃为：\n$$\n\\Delta p = \\frac{\\sigma}{R}\n$$\n平衡压力场是分段常数，液滴内部 $p(x,y) = p_{in}$，外部 $p(x,y) = p_{out}$，满足 $p_{in} = p_{out} + \\sigma/R$。\n\n这种简化为与曲率和表面张力成正比的简单压力跳跃，取决于一个关键假设，即流体处于**力学平衡**状态（$\\boldsymbol{u}=\\boldsymbol{0}$）。如果流体在运动，粘性应力项 $\\mu(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^T)$ 将不为零，界面上的应力平衡将包含速度梯度的贡献，从而导致更复杂的关系。\n\n### 第二部分：伪电流的数值实验\n\n在使用界面捕捉方法（如水平集方法结合连续表面力（CSF）模型）进行多相流模拟时，伪电流是一个众所周知的数值伪影。从解析上看，平衡状态要求压力梯度和表面张力之间达到完美平衡，即 $\\nabla p = \\boldsymbol{f}_{\\sigma}$。在数值上，由于离散化误差，这种平衡很难完美实现。\n\nCSF模型将奇异的表面张力（仅存在于无限薄的界面上）近似为一个分布在界面周围窄带上的连续体力。这是通过使用正则化的狄拉克δ函数 $\\delta_\\epsilon(\\phi)$ 实现的。用于梯度（$\\nabla_h$）、散度（$\\nabla_h \\cdot$）和几何属性（如曲率 $\\kappa_h$）计算的离散算子不能完美满足矢量微积分的恒等式。因此，离散的压力梯度 $\\nabla_h p_h$ 不能完全抵消离散的表面张力 $\\boldsymbol{f}_{\\sigma, h}$。这种不平衡产生了一个净残余力 $\\boldsymbol{f}_{residual} = \\boldsymbol{f}_{\\sigma, h} - \\nabla_h p_h \\neq \\boldsymbol{0}$，从而驱动了被称为伪电流的非物理寄生流。\n\n该数值实验旨在量化这些电流。步骤如下：\n\n1.  **初始化**：在周期性域 $[0,L]\\times[0,L]$ 上定义一个大小为 $N \\times N$ 的均匀笛卡尔网格。圆形液滴的界面由有符号距离函数 $\\phi(x,y) = \\sqrt{(x-x_0)^2 + (y-y_0)^2} - R$ 隐式定义，该函数在每个网格节点上求值。\n\n2.  **几何计算**：使用带有周期性边界条件的二阶中心有限差分法计算单位法向量 $\\boldsymbol{n} = \\nabla\\phi / \\lVert\\nabla\\phi\\rVert$ 和曲率 $\\kappa = \\nabla \\cdot \\boldsymbol{n}$。对分母 $\\lVert\\nabla\\phi\\rVert$ 应用一个小的正则化，以防止在远离界面（其值不需要）的地方发生除零错误。\n\n3.  **表面张力**：使用公式 $\\boldsymbol{f}_{\\sigma} = \\sigma \\kappa \\delta_\\epsilon(\\phi) \\boldsymbol{n}$ 计算CSF体力密度 $\\boldsymbol{f}_{\\sigma}$。正则化的δ函数 $\\delta_\\epsilon(\\phi)$ 将力局限在界面（$\\phi=0$）周围厚度为 $2\\epsilon$ 的区域内，其中 $\\epsilon = \\alpha h$。\n\n4.  **时间推进（预测步）**：从静止流体（$\\boldsymbol{u}^n = \\boldsymbol{0}$）开始，通过施加一个时间步长 $\\Delta t$ 的表面张力，计算出中间速度场 $\\boldsymbol{u}^*$。根据问题描述，这个显式步骤是：\n    $$\n    \\boldsymbol{u}^* = \\boldsymbol{u}^n + \\frac{\\Delta t}{\\rho}\\boldsymbol{f}_{\\sigma} = \\frac{\\Delta t}{\\rho}\\boldsymbol{f}_{\\sigma}\n    $$\n    通常情况下，该场 $\\boldsymbol{u}^*$ 不满足不可压缩性约束 $\\nabla \\cdot \\boldsymbol{u}^*=0$。\n\n5.  **投影步**：使用投影法来强制实现不可压缩性。这包括找到一个类压力标量场 $\\psi$，使得最终速度 $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\frac{\\Delta t}{\\rho}\\nabla\\psi$ 是无散度的，即 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$。对更新方程求散度，得到关于 $\\psi$ 的泊松方程：\n    $$\n    \\nabla^2 \\psi = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^*\n    $$\n    对于周期性域，该方程可使用快速傅里叶变换（FFT）高效求解。将方程变换到傅里叶空间，代数求解 $\\psi$ 的傅里叶系数，然后变换回实空间。接着计算梯度 $\\nabla\\psi$（在傅里叶空间中同样可以高效计算），并用它来校正中间速度，以获得最终的无散度速度场 $\\boldsymbol{u}^{n+1}$。\n\n6.  **测量**：通过计算整个计算域上速度范数的最大值 $\\max_{x,y} \\lVert\\boldsymbol{u}^{n+1}(x,y)\\rVert$ 来量化伪电流的大小。为每个测试案例报告此值。该实验研究此大小如何随网格分辨率 $N$ 和表面张力系数 $\\sigma$ 变化。预期是，随着 $N$ 的增加（即网格细化），伪电流将减小，并且当 $\\sigma = 0$ 时将为零。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the spurious currents problem for a static droplet using a level-set method.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, sigma)\n        (16, 0.072),  # Case 1\n        (32, 0.072),  # Case 2\n        (64, 0.072),  # Case 3\n        (128, 0.072), # Case 4\n        (64, 0.0),    # Case 5\n    ]\n    \n    # Fixed physical and numerical parameters\n    L = 1.0          # m\n    x0, y0 = L / 2, L / 2 # m\n    R = 0.25         # m\n    rho = 1000.0     # kg/m^3\n    mu = 1.0         # Pa*s (given, but not used in the specified one-step algorithm)\n    dt = 1e-5        # s\n    alpha = 1.5      # dimensionless\n    \n    results = []\n\n    for N, sigma in test_cases:\n        # If sigma is zero, the force is zero, thus spurious currents are zero.\n        if sigma == 0:\n            results.append(f\"{0.0:.5e}\")\n            continue\n\n        # Grid setup\n        h = L / N\n        x = np.linspace(0, L, N, endpoint=False)\n        xx, yy = np.meshgrid(x, x, indexing='xy')\n\n        # Level-set function: signed distance to the circle\n        phi = np.sqrt((xx - x0)**2 + (yy - y0)**2) - R\n\n        # Helper function for periodic centered differences\n        def periodic_gradient_component(field, spacing, axis):\n            return (np.roll(field, -1, axis=axis) - np.roll(field, 1, axis=axis)) / (2 * spacing)\n\n        # Compute gradient of phi\n        grad_phi_x = periodic_gradient_component(phi, h, axis=1)\n        grad_phi_y = periodic_gradient_component(phi, h, axis=0)\n\n        # Compute norm of the gradient, with regularization to avoid division by zero\n        norm_grad_phi = np.sqrt(grad_phi_x**2 + grad_phi_y**2)\n        # The small epsilon is critical. The normal is only well-defined where grad(phi) != 0.\n        # Away from the interface, the force is zero anyway due to the delta function.\n        epsilon_denom = 1e-12 \n        norm_grad_phi[norm_grad_phi  epsilon_denom] = epsilon_denom\n\n        # Compute unit normal vector field\n        nx = grad_phi_x / norm_grad_phi\n        ny = grad_phi_y / norm_grad_phi\n\n        # Compute curvature kappa = div(n)\n        d_nx_dx = periodic_gradient_component(nx, h, axis=1)\n        d_ny_dy = periodic_gradient_component(ny, h, axis=0)\n        kappa = d_nx_dx + d_ny_dy\n\n        # Compute regularized Dirac delta function\n        epsilon_delta = alpha * h\n        delta = np.zeros_like(phi)\n        mask = np.abs(phi) = epsilon_delta\n        delta[mask] = (1 / (2 * epsilon_delta)) * (1 + np.cos(np.pi * phi[mask] / epsilon_delta))\n\n        # Compute Continuum Surface Force (CSF) density\n        fx = sigma * kappa * delta * nx\n        fy = sigma * kappa * delta * ny\n\n        # Predictor step: compute intermediate velocity u* from rest\n        u_star = (dt / rho) * fx\n        v_star = (dt / rho) * fy\n        \n        # Projection step using FFT\n        \n        # Wavenumbers for the Fourier transform\n        k_freq = np.fft.fftfreq(N, d=h) * 2 * np.pi\n        kx, ky = np.meshgrid(k_freq, k_freq, indexing='xy')\n        k_sq = kx**2 + ky**2\n\n        # FFT of intermediate velocity components\n        fft_u_star = np.fft.fft2(u_star)\n        fft_v_star = np.fft.fft2(v_star)\n\n        # FFT of divergence of u*\n        # div_u_star_hat = 1j * kx * fft_u_star + 1j * ky * fft_v_star\n        # The Poisson equation is nabla^2(psi) = (rho/dt) * div(u*).\n        # In Fourier space: -k_sq * psi_hat = (rho/dt) * div_u_star_hat\n        # So, psi_hat = - (rho/dt) * div_u_star_hat / k_sq\n        \n        # We need grad(psi) for the velocity correction. Let's compute its FFT directly.\n        # grad_psi_x_hat = 1j * kx * psi_hat\n        # grad_psi_y_hat = 1j * ky * psi_hat\n        # Combining these:\n        # grad_psi_x_hat = - (rho/dt) * (1j * kx * div_u_star_hat) / k_sq\n        #               = - (rho/dt) * (1j * kx * (1j * kx * fft_u_star + 1j * ky * fft_v_star)) / k_sq\n        #               =   (rho/dt) * (kx**2 * fft_u_star + kx * ky * fft_v_star) / k_sq\n\n        # To avoid numerical issues, handle the k_sq=0 case (DC component)\n        k_sq_reg = np.copy(k_sq)\n        k_sq_reg[0, 0] = 1.0 # The numerator should be zero here anyway\n\n        fft_grad_psi_x = (rho / dt) * (kx**2 * fft_u_star + kx * ky * fft_v_star) / k_sq_reg\n        fft_grad_psi_y = (rho / dt) * (kx * ky * fft_u_star + ky**2 * fft_v_star) / k_sq_reg\n        \n        # The DC component of the pressure gradient must be zero\n        fft_grad_psi_x[0, 0] = 0.0\n        fft_grad_psi_y[0, 0] = 0.0\n\n        # Transform pressure gradient back to real space\n        grad_psi_x = np.fft.ifft2(fft_grad_psi_x).real\n        grad_psi_y = np.fft.ifft2(fft_grad_psi_y).real\n\n        # Corrector step: compute final divergence-free velocity\n        u_final = u_star - (dt / rho) * grad_psi_x\n        v_final = v_star - (dt / rho) * grad_psi_y\n\n        # Calculate the magnitude of spurious currents\n        spurious_current_mag = np.sqrt(u_final**2 + v_final**2)\n        \n        # Find the maximum magnitude over the domain\n        max_spurious_current = np.max(spurious_current_mag)\n        \n        # Append result formatted to 6 significant figures in scientific notation\n        results.append(f\"{max_spurious_current:.5e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}