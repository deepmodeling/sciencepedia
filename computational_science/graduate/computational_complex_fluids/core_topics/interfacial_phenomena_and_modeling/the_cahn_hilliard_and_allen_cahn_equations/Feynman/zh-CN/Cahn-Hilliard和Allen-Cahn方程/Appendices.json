{
    "hands_on_practices": [
        {
            "introduction": "相场模型的核心在于通过最小化系统的总自由能来描述其平衡态。第一个动手实践将引导你从经典的 Ginzburg-Landau 自由能泛函出发，通过求解其对应的 Euler-Lagrange 方程，来推导出连接两个相的一维界面所具有的特定数学形态。这个练习是理解相场理论的基石，它揭示了著名的双曲正切函数（$\\tanh$）形式的界面剖面，为我们提供了相分离系统中界面结构的直观物理图像。",
            "id": "4105764",
            "problem": "考虑一个二元流体混合物中的守恒标量序参量 $c(x)$ 的一维扩散界面模型，其中平衡剖面使粗粒化自由能泛函\n$$\n\\mathcal{F}[c] \\;=\\; \\int_{-\\infty}^{\\infty} \\left( \\frac{\\kappa}{2} \\left(\\frac{dc}{dx}\\right)^{2} + f(c) \\right) \\, dx,\n$$\n最小化，其中 $\\kappa0$ 且体自由能密度为对称双阱形式\n$$\nf(c) \\;=\\; \\frac{\\lambda}{4}\\,\\big(c^{2}-1\\big)^{2}, \\quad \\lambda0.\n$$\n假设一个以 $x=0$ 为中心的单调平面界面连接着两个体相，边界条件为 $c(-\\infty)=-1$、$c(+\\infty)=+1$、$c'( \\pm \\infty)=0$，以及为固定平移不变性而设的 $c(0)=0$。从 $\\mathcal{F}[c]$ 的驻定作用量原理及相应的一维欧拉-拉格朗日方程出发，求解满足这些边界条件的唯一异宿剖面 $c(x)$，并用 $\\kappa$ 和 $\\lambda$ 以闭合形式表示。通过将其直接代入稳态欧拉-拉格朗日方程并检查无穷远处的边界条件，来验证你的解是正确的。\n\n你的最终答案必须是 $c(x)$ 关于 $\\kappa$、$\\lambda$ 和 $x$ 的单个闭合形式解析表达式（无单位）。",
            "solution": "该问题要求解由自由能泛函描述的一维二元流体混合物的平衡剖面 $c(x)$\n$$\n\\mathcal{F}[c] \\;=\\; \\int_{-\\infty}^{\\infty} \\left( \\frac{\\kappa}{2} \\left(\\frac{dc}{dx}\\right)^{2} + f(c) \\right) \\, dx,\n$$\n其中参数 $\\kappa0$、$\\lambda0$，体自由能密度由下式给出\n$$\nf(c) \\;=\\; \\frac{\\lambda}{4}\\,\\big(c^{2}-1\\big)^{2}.\n$$\n该剖面必须满足边界条件 $c(-\\infty)=-1$、$c(+\\infty)=+1$、$c'(\\pm\\infty)=0$ 和对称性条件 $c(0)=0$。\n\n首先，对问题陈述进行验证。\n已知条件：\n1.  自由能泛函：$\\mathcal{F}[c] = \\int_{-\\infty}^{\\infty} \\mathcal{L}(c, c') dx$，拉格朗日密度为 $\\mathcal{L}(c, c') = \\frac{\\kappa}{2} (c')^2 + f(c)$。\n2.  梯度能量系数：$\\kappa  0$。\n3.  体自由能密度：$f(c) = \\frac{\\lambda}{4}(c^2 - 1)^2$，其中 $\\lambda  0$。\n4.  边界条件：$c(-\\infty) = -1$，$c(+\\infty) = +1$，$c'(\\pm\\infty) = 0$。\n5.  对称性条件：$c(0) = 0$。\n\n验证：\n该问题具有科学依据，描述了关于稳态界面的完善的 Cahn-Hilliard 理论。该泛函是标准的 Ginzburg-Landau 自由能，双阱势是相分离模型的典型形式。该问题是适定的，因为寻找平衡剖面是变分法中的一个经典问题。边界条件与势能 $f(c)$ 的极小值点 $c=\\pm 1$ 一致。该问题客观、完整、一致，且无歧义。该问题是有效的。\n\n平衡剖面 $c(x)$ 使泛函 $\\mathcal{F}[c]$ 取极值。根据变分法，这样的剖面必须满足欧拉-拉格朗日方程。拉格朗日密度为 $\\mathcal{L}(c, c') = \\frac{\\kappa}{2} (c')^2 + f(c)$，其中 $c' = dc/dx$。欧拉-拉格朗日方程为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial c} - \\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial c'}\\right) = 0.\n$$\n我们计算其偏导数：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial c} = \\frac{df}{dc} = f'(c)\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial c'} = \\kappa c'\n$$\n将这些代入欧拉-拉格朗日方程，得到：\n$$\nf'(c) - \\frac{d}{dx}(\\kappa c') = 0 \\quad \\implies \\quad \\kappa \\frac{d^2c}{dx^2} = f'(c).\n$$\n接下来，我们计算体自由能密度 $f(c)$ 的导数：\n$$\nf(c) = \\frac{\\lambda}{4}(c^4 - 2c^2 + 1)\n$$\n$$\nf'(c) = \\frac{df}{dc} = \\frac{\\lambda}{4}(4c^3 - 4c) = \\lambda(c^3 - c).\n$$\n因此，平衡剖面的微分方程为：\n$$\n\\kappa \\frac{d^2c}{dx^2} = \\lambda(c^3 - c).\n$$\n这是一个二阶非线性常微分方程。我们可以通过两边同乘以 $c' = dc/dx$ 并对 $x$ 积分来找到一个第一积分：\n$$\n\\kappa c'' c' = \\lambda(c^3 - c)c'\n$$\n$$\n\\int \\kappa \\frac{dc'}{dx} c' \\, dx = \\int \\lambda(c^3 - c)\\frac{dc}{dx} \\, dx\n$$\n$$\n\\int \\kappa c' \\, dc' = \\int \\lambda(c^3 - c) \\, dc\n$$\n$$\n\\frac{\\kappa}{2} (c')^2 = \\lambda \\left(\\frac{c^4}{4} - \\frac{c^2}{2}\\right) + C_{1},\n$$\n其中 $C_1$ 是一个积分常数。我们利用 $x \\to \\pm \\infty$ 时的边界条件来确定 $C_1$，此时 $c \\to \\pm 1$ 且 $c' \\to 0$。使用 $c=1$ 和 $c'=0$：\n$$\n\\frac{\\kappa}{2} (0)^2 = \\lambda \\left(\\frac{1^4}{4} - \\frac{1^2}{2}\\right) + C_1 \\quad \\implies \\quad 0 = -\\frac{\\lambda}{4} + C_1 \\quad \\implies \\quad C_1 = \\frac{\\lambda}{4}.\n$$\n将 $C_1$ 代回，我们得到第一积分：\n$$\n\\frac{\\kappa}{2} (c')^2 = \\lambda \\left(\\frac{c^4}{4} - \\frac{c^2}{2}\\right) + \\frac{\\lambda}{4} = \\frac{\\lambda}{4}(c^4 - 2c^2 + 1) = \\frac{\\lambda}{4}(c^2 - 1)^2.\n$$\n化简为：\n$$\n(c')^2 = \\frac{\\lambda}{2\\kappa}(c^2 - 1)^2.\n$$\n两边取平方根：\n$$\n\\frac{dc}{dx} = \\pm \\sqrt{\\frac{\\lambda}{2\\kappa}} (c^2 - 1).\n$$\n问题指定了一个连接 $c(-\\infty)=-1$ 和 $c(+\\infty)=+1$ 的单调递增剖面。这意味着 $dc/dx  0$。在界面区域，即 $-1  c  1$ 时，项 $(c^2 - 1)$ 为负。为了使 $dc/dx$ 为正，我们必须选择负号：\n$$\n\\frac{dc}{dx} = - \\sqrt{\\frac{\\lambda}{2\\kappa}} (c^2 - 1) = \\sqrt{\\frac{\\lambda}{2\\kappa}} (1 - c^2).\n$$\n这是一个一阶可分离变量微分方程。我们分离变量并积分：\n$$\n\\frac{dc}{1 - c^2} = \\sqrt{\\frac{\\lambda}{2\\kappa}} \\, dx\n$$\n$$\n\\int \\frac{dc}{1 - c^2} = \\int \\sqrt{\\frac{\\lambda}{2\\kappa}} \\, dx.\n$$\n左边的积分是标准形式，$\\int \\frac{du}{1-u^2} = \\arctanh(u)$。因此：\n$$\n\\arctanh(c) = \\sqrt{\\frac{\\lambda}{2\\kappa}} x + C_2,\n$$\n其中 $C_2$ 是第二个积分常数。我们使用对称性条件 $c(0)=0$ 来求出 $C_2$：\n$$\n\\arctanh(0) = \\sqrt{\\frac{\\lambda}{2\\kappa}}(0) + C_2 \\quad \\implies \\quad 0 = C_2.\n$$\n当 $C_2=0$ 时，我们得到隐式解 $\\arctanh(c) = \\sqrt{\\frac{\\lambda}{2\\kappa}} x$。求解 $c(x)$ 得到显式闭合形式解：\n$$\nc(x) = \\tanh\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right).\n$$\n最后，我们验证这个解。\n1.  检查边界条件：\n    - $c(0) = \\tanh(0) = 0$。（正确）\n    - $\\lim_{x\\to\\infty} c(x) = \\lim_{x\\to\\infty} \\tanh\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right) = 1$。（正确）\n    - $\\lim_{x\\to-\\infty} c(x) = \\lim_{x\\to-\\infty} \\tanh\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right) = -1$。（正确）\n    - 其导数为 $c'(x) = \\sqrt{\\frac{\\lambda}{2\\kappa}} \\text{sech}^2\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right)$。当 $x \\to \\pm \\infty$ 时，双曲正割的自变量趋于 $\\pm\\infty$，且 $\\text{sech}^2(u) \\to 0$。因此，$c'(\\pm\\infty) = 0$。（正确）\n2.  检查欧拉-拉格朗日方程：$\\kappa c'' = \\lambda(c^3-c)$。\n    令 $a = \\sqrt{\\frac{\\lambda}{2\\kappa}}$，则 $c = \\tanh(ax)$。\n    - $c' = a\\,\\text{sech}^2(ax)$。\n    - $c'' = a \\frac{d}{dx}(\\text{sech}^2(ax)) = a \\left(2\\,\\text{sech}(ax)\\right) \\left(-\\text{sech}(ax)\\tanh(ax)\\right) (a) = -2a^2\\,\\text{sech}^2(ax)\\tanh(ax)$。\n    - 左边 (LHS)：$\\kappa c'' = \\kappa \\left(-2a^2\\,\\text{sech}^2(ax)\\tanh(ax)\\right)$。代入 $a^2 = \\frac{\\lambda}{2\\kappa}$：\n      LHS $= \\kappa \\left(-2 \\frac{\\lambda}{2\\kappa}\\,\\text{sech}^2(ax)\\tanh(ax)\\right) = -\\lambda\\,\\text{sech}^2(ax)\\tanh(ax)$。\n    - 右边 (RHS)：$\\lambda(c^3 - c) = \\lambda(\\tanh^3(ax) - \\tanh(ax)) = \\lambda\\tanh(ax)(\\tanh^2(ax)-1)$。\n    - 使用恒等式 $\\tanh^2(u) - 1 = -\\text{sech}^2(u)$：\n      RHS $= \\lambda\\tanh(ax)(-\\text{sech}^2(ax)) = -\\lambda\\,\\text{sech}^2(ax)\\tanh(ax)$。\n    - 由于 LHS = RHS，该解是正确的。\n\n满足给定条件的唯一异宿剖面是 $c(x) = \\tanh\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right)$。",
            "answer": "$$\n\\boxed{\\tanh\\left(\\sqrt{\\frac{\\lambda}{2\\kappa}} x\\right)}\n$$"
        },
        {
            "introduction": "在两相共存的体系中，界面的存在本身就意味着能量的耗散，我们称之为界面张力。这个实践在前一个练习的基础上更进一步，展示了如何直接从模型的自由能泛函中计算出这个关键的物理参数。掌握模型参数（如梯度能系数 $\\kappa$ 和势能参数 $A$）与可测量的物理量（如界面张力 $\\sigma$）之间的联系，对于用实验数据校准相场模型至关重要。",
            "id": "4105736",
            "problem": "考虑一个由自由能泛函导出的Cahn-Hilliard方程（CH）或Allen-Cahn方程（AC）所模拟的二元流体中的一维平面平衡界面。设标量组分场为 $c(x)$，并假设已经进行了无量纲化，使得所有量均为无量纲，且均匀自由能密度的体相最小值取零。总自由能为\n$$\n\\mathcal{F}[c]=\\int_{\\mathbb{R}}\\left(f_{0}(c)+\\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^{2}\\right)\\,dx,\n$$\n其中 $f_{0}(c)$ 是一个平滑的体相自由能密度，在 $c=c_{-}$ 和 $c=c_{+}$ 处有两个相等的最小值，而 $\\kappa0$ 是一个常数梯度能系数。单位面积的界面张力定义为\n$$\n\\sigma=\\int_{-\\infty}^{\\infty}\\kappa\\left(\\frac{dc}{dx}\\right)^{2}\\,dx,\n$$\n对于连接 $c(-\\infty)=c_{-}$ 和 $c(+\\infty)=c_{+}$ 的稳态界面剖面。\n\n从第一性原理出发，即在给定边界条件下 $\\mathcal{F}[c]$ 的变分平稳性，推导出一个用 $\\kappa$ 和 $f_{0}(c)$ 表示一维平衡界面 $\\sigma$ 的普适关系。然后，对于四次对称双阱体相自由能密度\n$$\nf_{0}(c)=\\frac{A}{4}\\left(c^{2}-1\\right)^{2},\\quad A0,\n$$\n其最小值位于 $c_{-}=-1$ 和 $c_{+}=+1$，精确计算 $\\sigma$。请用一个包含 $A$ 和 $\\kappa$ 的单一闭合形式解析表达式给出最终答案。不需要进行数值计算。",
            "solution": "该问题要求推导界面张力 $\\sigma$ 的一个普适关系，并针对给定的自由能密度进行具体计算。出发点是平衡界面剖面下自由能泛函的平稳性。\n\n该一维系统的总自由能由以下泛函给出\n$$\n\\mathcal{F}[c]=\\int_{-\\infty}^{\\infty}\\left(f_{0}(c)+\\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^{2}\\right)\\,dx\n$$\n一个平衡（或稳态）的界面剖面 $c(x)$ 是使该泛函取极值的剖面。这是一个经典的变分法问题。被积函数 $L(c, c') = f_0(c) + \\frac{\\kappa}{2}(c')^2$ (其中 $c' \\equiv \\frac{dc}{dx}$) 可被视作拉格朗日密度。剖面 $c(x)$ 必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\partial L}{\\partial c} - \\frac{d}{dx}\\left(\\frac{\\partial L}{\\partial c'}\\right) = 0\n$$\n计算偏导数：\n$$\n\\frac{\\partial L}{\\partial c} = \\frac{df_0}{dc}\n$$\n$$\n\\frac{\\partial L}{\\partial c'} = \\kappa c' = \\kappa \\frac{dc}{dx}\n$$\n将这些代入欧拉-拉格朗日方程，得到稳态剖面的控制方程：\n$$\n\\frac{df_0}{dc} - \\kappa \\frac{d^2c}{dx^2} = 0 \\quad \\implies \\quad \\kappa \\frac{d^2c}{dx^2} = \\frac{df_0}{dc}\n$$\n这个二阶常微分方程描述了平衡界面。它代表了在指定边界条件下，Allen-Cahn（非守恒序参量）和Cahn-Hilliard（守恒序参量）动力学的稳态解（$\\mu = \\frac{\\delta\\mathcal{F}}{\\delta c} = 0$），因为平衡要求化学势在空间上均匀，且必须为零以匹配体相。\n\n为了找到 $\\sigma$ 的关系式，我们可以求出此方程的一个首次积分。由于拉格朗日量 $L(c, c')$ 不显式依赖于自变量 $x$，由贝尔特拉米恒等式给出的量是守恒的：\n$$\nc' \\frac{\\partial L}{\\partial c'} - L = \\text{constant}\n$$\n代入 $L$ 及其导数的表达式：\n$$\n\\left(\\frac{dc}{dx}\\right)\\left(\\kappa \\frac{dc}{dx}\\right) - \\left(f_0(c) + \\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^2\\right) = \\text{constant}\n$$\n$$\n\\kappa\\left(\\frac{dc}{dx}\\right)^2 - f_0(c) - \\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^2 = \\text{constant}\n$$\n$$\n\\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^2 - f_0(c) = \\text{constant}\n$$\n该常数的值由 $x \\to \\pm\\infty$ 处的边界条件决定。我们已知当 $x \\to \\pm\\infty$ 时，$c \\to c_{\\pm}$。在这些体相区域，剖面是平坦的，因此 $\\frac{dc}{dx} \\to 0$。我们还已知体相自由能密度在其最小值处为零，即 $f_0(c_{\\pm}) = 0$。应用这些条件：\n$$\n\\frac{\\kappa}{2}(0)^2 - f_0(c_{\\pm}) = 0 - 0 = 0\n$$\n因此，该常数为零，我们得到了一个对整个平衡剖面都成立的关键关系式：\n$$\n\\frac{\\kappa}{2}\\left(\\frac{dc}{dx}\\right)^2 = f_0(c)\n$$\n该方程陈述了稳态解的能量均分：在每一点 $x$ 处，梯度能密度等于体相自由能密度。\n\n现在，我们可以找到界面张力 $\\sigma$ 的普适表达式。其定义为：\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\kappa\\left(\\frac{dc}{dx}\\right)^2 dx\n$$\n使用我们刚刚导出的关系式 $\\kappa\\left(\\frac{dc}{dx}\\right)^2 = 2f_0(c)$，我们可以写出 $\\sigma = \\int_{-\\infty}^{\\infty} 2f_0(c(x))dx$。然而，通过将积分变量从 $x$ 更改为 $c$，可以获得一个更便于计算的形式。从我们的首次积分，假设 $c$ 从 $c_{-}$ 增加到 $c_{+}$，我们有 $\\frac{dc}{dx} = \\sqrt{\\frac{2f_0(c)}{\\kappa}}$。我们可以写出：\n$$\n\\sigma = \\int_{-\\infty}^{\\infty} \\kappa \\left(\\frac{dc}{dx}\\right) \\left(\\frac{dc}{dx} dx\\right) = \\int_{c(-\\infty)}^{c(+\\infty)} \\kappa \\left(\\frac{dc}{dx}\\right) dc\n$$\n将 $\\frac{dc}{dx} = \\sqrt{\\frac{2f_0(c)}{\\kappa}}$ 代入此积分：\n$$\n\\sigma = \\int_{c_{-}}^{c_{+}} \\kappa \\sqrt{\\frac{2f_0(c)}{\\kappa}} dc = \\int_{c_{-}}^{c_{+}} \\sqrt{2\\kappa f_0(c)} dc\n$$\n这就是所求的用 $\\kappa$ 和 $f_0(c)$ 表示的界面张力 $\\sigma$ 的普适关系。\n\n接下来，我们将此普适关系应用于四次双阱势的具体情况：\n$$\nf_{0}(c)=\\frac{A}{4}\\left(c^{2}-1\\right)^{2}, \\quad A0\n$$\n其最小值在 $c_{-} = -1$ 和 $c_{+} = +1$。\n将这种形式的 $f_0(c)$ 代入 $\\sigma$ 的表达式中：\n$$\n\\sigma = \\int_{-1}^{1} \\sqrt{2\\kappa \\left(\\frac{A}{4}(c^2-1)^2\\right)} dc\n$$\n$$\n\\sigma = \\int_{-1}^{1} \\sqrt{\\frac{A\\kappa}{2}(c^2-1)^2} dc = \\sqrt{\\frac{A\\kappa}{2}} \\int_{-1}^{1} \\sqrt{(c^2-1)^2} dc\n$$\n项 $\\sqrt{(c^2-1)^2}$ 等于绝对值 $|c^2-1|$。对于积分范围 $c \\in [-1, 1]$，表达式 $c^2-1$ 是非正的。因此， $|c^2-1| = -(c^2-1) = 1-c^2$。积分变为：\n$$\n\\sigma = \\sqrt{\\frac{A\\kappa}{2}} \\int_{-1}^{1} (1-c^2) dc\n$$\n我们现在计算这个初等积分：\n$$\n\\int_{-1}^{1} (1-c^2) dc = \\left[c - \\frac{c^3}{3}\\right]_{-1}^{1} = \\left(1 - \\frac{1^3}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right)\n$$\n$$\n= \\left(1 - \\frac{1}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n将此结果代回 $\\sigma$ 的表达式：\n$$\n\\sigma = \\sqrt{\\frac{A\\kappa}{2}} \\cdot \\frac{4}{3} = \\frac{4}{3\\sqrt{2}} \\sqrt{A\\kappa} = \\frac{4\\sqrt{2}}{3 \\cdot 2} \\sqrt{A\\kappa} = \\frac{2\\sqrt{2}}{3} \\sqrt{A\\kappa}\n$$\n此表达式可以改写为：\n$$\n\\sigma = \\frac{2}{3}\\sqrt{2A\\kappa}\n$$\n这就是界面张力的最终闭合形式解析表达式。",
            "answer": "$$ \\boxed{\\frac{2}{3}\\sqrt{2A\\kappa}} $$"
        },
        {
            "introduction": "为了研究相分离的动力学过程（如粗化现象），我们必须对 Cahn-Hilliard 方程进行数值求解。最后一个实践将带你深入计算相场模型的核心：构建一个有限体积格式。我们的目标是设计一个数值通量，它不仅能精确地近似物理过程，还能严格遵守质量守恒和自由能耗散这两个基本定律，从而确保模拟结果的稳定性和真实性。",
            "id": "4105720",
            "problem": "考虑一个长度为 $L$ 的一维周期性区域，该区域被一个包含 $N$ 个单元的均匀网格离散化，网格间距为 $h = L/N$。设 $\\{\\phi_i(t)\\}_{i=0}^{N-1}$ 表示单元平均的序参量，其演化遵循 Cahn–Hilliard 方程，该方程在每个节点上以守恒型平衡律的形式给出：\n$$\n\\frac{d \\phi_i}{d t} \\;=\\; -\\,\\frac{J_{i+1/2} \\;-\\; J_{i-1/2}}{h},\n$$\n其中 $J_{i+1/2}$ 是单元 $i$ 和 $i+1$ 之间的单值界面通量，且由于周期性，下标按模 $N$ 计算。自由能离散化为：\n$$\n\\mathcal{F}_h(\\phi) \\;=\\; \\sum_{i=0}^{N-1} h \\left[ f(\\phi_i) \\;+\\; \\frac{\\kappa}{2}\\left(\\frac{\\phi_{i+1}-\\phi_i}{h}\\right)^{2} \\right],\n$$\n其中 $f(\\cdot)$ 是一个光滑的体自由能密度，$\\kappa0$ 是梯度能量系数。通过与 $\\mathcal{F}_h$ 一致的离散变分导数，在单元中心定义离散化学势：\n$$\n\\mu_i \\;=\\; f'(\\phi_i) \\;-\\; \\kappa\\,\\Delta_h \\phi_i,\n\\qquad\n\\Delta_h \\phi_i \\;=\\; \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^{2}}.\n$$\n设 $M(\\phi)$ 表示一个正的迁移率，并通过算术平均定义一个对称的界面迁移率：\n$$\nM_{i+1/2} \\;=\\; \\frac{M(\\phi_{i+1}) + M(\\phi_i)}{2}.\n$$\n构建一个二阶精确、中心的有限体积界面通量 $J_{i+1/2}$，该通量用 $\\{\\phi_{i-1},\\phi_i,\\phi_{i+1},\\phi_{i+2}\\}$、$h$、$\\kappa$、$f'(\\cdot)$ 和 $M(\\cdot)$ 显式表达，并使其同时满足以下两个性质：\n- 离散质量守恒，与离散散度定理（分部求和恒等式）一致：在周期性边界条件下，节点源的全局总和为零，即：\n$$\n\\sum_{i=0}^{N-1} \\left(J_{i+1/2} - J_{i-1/2}\\right) \\;=\\; 0,\n$$\n因此 $\\sum_{i=0}^{N-1} h\\,\\phi_i(t)$ 不随时间变化。\n- 离散自由能耗散，与 $L^2$ 梯度流结构相容：对于上述 $\\mu_i$，半离散动力学系统满足\n$$\n\\frac{d\\mathcal{F}_h}{dt} \\;\\le\\; 0\n$$\n对所有状态成立，前提是 $M(\\phi)0$。\n\n请以单个闭式解析表达式的形式，给出你最终的界面通量公式 $J_{i+1/2}$。不需要任何数值。你的答案必须是单个表达式；请勿在答案框中包含推导过程。",
            "solution": "该问题是有效的，因为它代表了偏微分方程数值分析中的一个适定且标准的任务，具体而言，就是为 Cahn-Hilliard 方程构建一个能量稳定、守恒且二阶精确的有限体积格式。所有给定的定义和约束在科学上是合理的，在数学上是一致的。\n\n目标是找到满足指定性质的界面通量 $J_{i+1/2}$ 的表达式。\n\n首先，我们来处理质量守恒性质。演化方程以守恒型有限体积形式给出：\n$$\n\\frac{d \\phi_i}{d t} = -\\,\\frac{J_{i+1/2} - J_{i-1/2}}{h}\n$$\n总质量（或序参量的总和）为 $m(t) = \\sum_{i=0}^{N-1} h\\,\\phi_i(t)$。其时间导数为：\n$$\n\\frac{dm}{dt} = \\sum_{i=0}^{N-1} h \\frac{d\\phi_i}{dt} = \\sum_{i=0}^{N-1} h \\left( -\\,\\frac{J_{i+1/2} - J_{i-1/2}}{h} \\right) = -\\sum_{i=0}^{N-1} (J_{i+1/2} - J_{i-1/2})\n$$\n这是一个伸缩求和。由于周期性边界条件（其中下标按模 $N$ 计算，因此 $J_{-1/2} \\equiv J_{N-1/2}$ 且 $J_{N+1/2} \\equiv J_{1/2}$），该和为零：\n$$\n-\\sum_{i=0}^{N-1} (J_{i+1/2} - J_{i-1/2}) = -(J_{1/2}-J_{-1/2}) - (J_{3/2}-J_{1/2}) - \\dots - (J_{N-1/2}-J_{N-3/2}) - (J_{1/2}-J_{N-1/2}) = 0\n$$\n因此，$\\frac{dm}{dt}=0$，对于任何单值通量 $J_{i+1/2}$，总质量都是守恒的。这个性质是周期性区域上有限体积结构的内禀性质，并没有对 $J_{i+1/2}$ 的形式施加额外的约束。\n\n其次，我们处理自由能耗散性质，即 $\\frac{d\\mathcal{F}_h}{dt} \\le 0$。我们使用链式法则计算离散自由能 $\\mathcal{F}_h$ 的时间导数：\n$$\n\\frac{d\\mathcal{F}_h}{dt} = \\sum_{i=0}^{N-1} \\frac{\\partial \\mathcal{F}_h}{\\partial \\phi_i} \\frac{d\\phi_i}{dt}\n$$\n问题将离散化学势 $\\mu_i$ 定义为变分导数 $\\mu_i = \\frac{1}{h} \\frac{\\delta \\mathcal{F}_h}{\\delta \\phi_i}$。问题陈述中提供的 $\\mu_i$ 定义与 $\\mu_i = \\frac{1}{h} \\frac{\\partial \\mathcal{F}_h}{\\partial \\phi_i}$ 一致。因此，$\\frac{\\partial \\mathcal{F}_h}{\\partial \\phi_i} = h \\mu_i$。将此式和 $\\phi_i$ 的演化方程代入可得：\n$$\n\\frac{d\\mathcal{F}_h}{dt} = \\sum_{i=0}^{N-1} (h \\mu_i) \\left( -\\,\\frac{J_{i+1/2} - J_{i-1/2}}{h} \\right) = - \\sum_{i=0}^{N-1} \\mu_i (J_{i+1/2} - J_{i-1/2})\n$$\n我们对周期序列应用分部求和恒等式 $\\sum_{i=0}^{N-1} a_i (b_{i+1/2} - b_{i-1/2}) = - \\sum_{i=0}^{N-1} (a_{i+1} - a_i) b_{i+1/2}$。令 $a_i = \\mu_i$ 和 $b_{i+1/2} = J_{i+1/2}$，我们得到：\n$$\n\\frac{d\\mathcal{F}_h}{dt} = - \\left( - \\sum_{i=0}^{N-1} (\\mu_{i+1} - \\mu_i) J_{i+1/2} \\right) = \\sum_{i=0}^{N-1} (\\mu_{i+1} - \\mu_i) J_{i+1/2}\n$$\n为保证对任何状态都有 $\\frac{d\\mathcal{F}_h}{dt} \\le 0$，我们可以要求和中的每一项都是非正的。这可以通过设计一个与化学势差 $(\\mu_{i+1} - \\mu_i)$ 的负值直接相关的通量 $J_{i+1/2}$ 来实现。让我们提出以下形式的通量：\n$$\nJ_{i+1/2} = - \\Gamma_{i+1/2} (\\mu_{i+1} - \\mu_i)\n$$\n其中 $\\Gamma_{i+1/2}$ 是一个正系数。采用这种选择，能量耗散率变为：\n$$\n\\frac{d\\mathcal{F}_h}{dt} = - \\sum_{i=0}^{N-1} \\Gamma_{i+1/2} (\\mu_{i+1} - \\mu_i)^2\n$$\n由于 $\\Gamma_{i+1/2}  0$ 且 $(\\mu_{i+1} - \\mu_i)^2 \\ge 0$，条件 $\\frac{d\\mathcal{F}_h}{dt} \\le 0$ 得以满足。\n\n连续的 Cahn-Hilliard 通量为 $J = - M(\\phi) \\nabla \\mu$。此通量在界面 $i+1/2$ 处的二阶精确中心离散格式为 $J_{i+1/2} = - M_{i+1/2} (\\nabla_h \\mu)_{i+1/2}$，其中 $M_{i+1/2}$ 是界面上的迁移率，$(\\nabla_h \\mu)_{i+1/2}$ 是梯度 $\\frac{\\partial \\mu}{\\partial x}$ 的中心近似。我们使用给定的迁移率算术平均 $M_{i+1/2} = \\frac{M(\\phi_i) + M(\\phi_{i+1})}{2}$，以及标准的梯度中心差分 $(\\nabla_h \\mu)_{i+1/2} = \\frac{\\mu_{i+1} - \\mu_i}{h}$。这给出的通量为：\n$$\nJ_{i+1/2} = - M_{i+1/2} \\frac{\\mu_{i+1} - \\mu_i}{h}\n$$\n这个形式与我们之前的结构相对应，其中 $\\Gamma_{i+1/2} = \\frac{M_{i+1/2}}{h}$。由于 $M(\\phi)0$，我们有 $M_{i+1/2}0$，并且因为 $h0$，$\\Gamma_{i+1/2}0$ 得到保证。所有算子都是中心的，确保了二阶空间精度。\n\n最后，我们通过代入 $\\mu_i$ 的定义来构建 $J_{i+1/2}$ 的显式表达式。首先，我们计算差值 $\\mu_{i+1} - \\mu_i$：\n$$\n\\mu_{i+1} = f'(\\phi_{i+1}) - \\kappa\\,\\frac{\\phi_{i+2} - 2\\phi_{i+1} + \\phi_{i}}{h^{2}}\n$$\n$$\n\\mu_{i} = f'(\\phi_i) - \\kappa\\,\\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{h^{2}}\n$$\n$$\n\\mu_{i+1} - \\mu_i = \\left( f'(\\phi_{i+1}) - f'(\\phi_i) \\right) - \\frac{\\kappa}{h^2} \\left[ (\\phi_{i+2} - 2\\phi_{i+1} + \\phi_{i}) - (\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}) \\right]\n$$\n化简方括号中的项：\n$$\n\\phi_{i+2} - 2\\phi_{i+1} + \\phi_{i} - \\phi_{i+1} + 2\\phi_i - \\phi_{i-1} = \\phi_{i+2} - 3\\phi_{i+1} + 3\\phi_i - \\phi_{i-1}\n$$\n所以，化学势差为：\n$$\n\\mu_{i+1} - \\mu_i = f'(\\phi_{i+1}) - f'(\\phi_i) - \\frac{\\kappa}{h^2} \\left( \\phi_{i+2} - 3\\phi_{i+1} + 3\\phi_i - \\phi_{i-1} \\right)\n$$\n将此式代入 $J_{i+1/2}$ 的表达式中：\n$$\nJ_{i+1/2} = - \\frac{M_{i+1/2}}{h} (\\mu_{i+1} - \\mu_i) = - \\frac{M(\\phi_{i+1}) + M(\\phi_i)}{2h} \\left[ f'(\\phi_{i+1}) - f'(\\phi_i) - \\frac{\\kappa}{h^2} \\left( \\phi_{i+2} - 3\\phi_{i+1} + 3\\phi_i - \\phi_{i-1} \\right) \\right]\n$$\n这个表达式代表了通量的最终形式，它依赖于模板 $\\{\\phi_{i-1}, \\phi_i, \\phi_{i+1}, \\phi_{i+2}\\}$，并满足所有要求的性质。",
            "answer": "$$\n\\boxed{- \\frac{M(\\phi_{i+1}) + M(\\phi_i)}{2h} \\left( f'(\\phi_{i+1}) - f'(\\phi_i) - \\frac{\\kappa}{h^{2}} \\left( \\phi_{i+2} - 3\\phi_{i+1} + 3\\phi_i - \\phi_{i-1} \\right) \\right)}\n$$"
        }
    ]
}