{
    "hands_on_practices": [
        {
            "introduction": "涨落耗散定理（FDT）在系统的外部力响应和其内禀热涨落之间建立了强有力的联系。本练习将邀请您将此定理应用于纳米机械谐振器——一个在现代物理学和工程学中至关重要的系统。通过从系统的力学易感性计算位置涨落的功率谱密度，您将亲身体验在经典高温极限下，微观层面的耗散是如何引起可观测噪声的。",
            "id": "125694",
            "problem": "一个纳米机械谐振器与温度为 $T$ 的热浴耦合。该谐振器的动力学可以很好地用广义朗之万方程来描述，在频域中，这导致了频率相关的机械响应函数 $\\chi(\\omega)$。其位置响应 $x(\\omega)$ 对外部驱动力 $F(\\omega)$ 的关系由 $x(\\omega) = \\chi(\\omega)F(\\omega)$ 给出。\n\n谐振器的响应函数由下式给出：\n$$\n\\chi(\\omega) = \\left[ k - m\\omega^2 - i\\omega\\tilde{\\gamma}(\\omega) \\right]^{-1}\n$$\n其中 $k$ 是弹簧常数，$m$ 是有效质量，$\\tilde{\\gamma}(\\omega)$ 是复数的、频率相关的阻尼系数。该阻尼由德拜公式建模：\n$$\n\\tilde{\\gamma}(\\omega) = \\frac{\\gamma_0}{1 - i\\omega\\tau_d}\n$$\n其中 $\\gamma_0$ 是零频阻尼常数，$\\tau_d$ 是热浴的特征记忆时间。\n\n根据涨落-耗散定理，热机械位置涨落的对称化功率谱密度 (PSD) $S_x(\\omega)$ 与机械响应函数的虚部 $\\text{Im}[\\chi(\\omega)]$ 通过以下关系相关联：\n$$\nS_x(\\omega) = 2\\hbar \\, \\text{Im}[\\chi(\\omega)] \\coth\\left(\\frac{\\hbar\\omega}{2k_B T}\\right)\n$$\n其中 $\\hbar$ 是约化普朗克常数，$k_B$ 是玻尔兹曼常数。\n\n在高温（经典）极限下，即 $k_B T$ 远大于相关振动量子能量 $\\hbar\\omega$ 时，计算热机械位置涨落在零频率下的功率谱密度 $S_x(0) = \\lim_{\\omega\\to 0} S_x(\\omega)$。\n\n请用 $k$、$\\gamma_0$、$T$ 和基本常数 $k_B$ 表示你的最终答案。",
            "solution": "热机械位置涨落的对称化功率谱密度 (PSD) 由下式给出：\n\n$$\nS_x(\\omega) = 2\\hbar  \\operatorname{Im}[\\chi(\\omega)] \\coth\\left(\\frac{\\hbar\\omega}{2k_B T}\\right)\n$$\n\n其中 $\\chi(\\omega)$ 是机械响应函数。零频极限为 $S_x(0) = \\lim_{\\omega \\to 0} S_x(\\omega)$。在高温极限 $k_B T \\gg \\hbar\\omega$ 下，coth 函数近似为：\n\n$$\n\\coth\\left(\\frac{\\hbar\\omega}{2k_B T}\\right) \\approx \\frac{2k_B T}{\\hbar\\omega}\n$$\n\n响应函数为：\n\n$$\n\\chi(\\omega) = \\left[ k - m\\omega^2 - i\\omega \\tilde{\\gamma}(\\omega) \\right]^{-1}\n$$\n\n其中阻尼系数为：\n\n$$\n\\tilde{\\gamma}(\\omega) = \\frac{\\gamma_0}{1 - i\\omega\\tau_d} = \\gamma_0 \\frac{1}{1 + (\\omega\\tau_d)^2} + i \\gamma_0 \\frac{\\omega\\tau_d}{1 + (\\omega\\tau_d)^2}\n$$\n\n$\\chi(\\omega)$ 的分母是：\n\n$$\nD(\\omega) = k - m\\omega^2 - i\\omega \\left( \\gamma_0 \\frac{1 + i\\omega\\tau_d}{1 + (\\omega\\tau_d)^2} \\right) = k - m\\omega^2 + \\gamma_0 \\frac{\\omega^2\\tau_d}{1 + (\\omega\\tau_d)^2} - i \\gamma_0 \\frac{\\omega}{1 + (\\omega\\tau_d)^2}\n$$\n\n因此，$D(\\omega) = A(\\omega) - i B(\\omega)$，其中：\n\n$$\nA(\\omega) = k - m\\omega^2 + \\gamma_0 \\frac{\\omega^2\\tau_d}{1 + (\\omega\\tau_d)^2}, \\quad B(\\omega) = \\gamma_0 \\frac{\\omega}{1 + (\\omega\\tau_d)^2}\n$$\n\n$\\chi(\\omega)$ 的虚部是：\n\n$$\n\\operatorname{Im}[\\chi(\\omega)] = \\frac{B(\\omega)}{A(\\omega)^2 + B(\\omega)^2}\n$$\n\n当 $\\omega \\to 0$ 时，主导项为：\n\n$$\nA(\\omega) \\to k, \\quad B(\\omega) \\to \\gamma_0 \\omega\n$$\n\n因为高阶项消失。因此：\n\n$$\n\\operatorname{Im}[\\chi(\\omega)] \\approx \\frac{\\gamma_0 \\omega}{k^2}\n$$\n\n代入 $S_x(\\omega)$：\n\n$$\nS_x(\\omega) \\approx 2\\hbar \\cdot \\frac{\\gamma_0 \\omega}{k^2} \\cdot \\frac{2k_B T}{\\hbar\\omega} = \\frac{4 \\gamma_0 k_B T}{k^2}\n$$\n\n取极限 $\\omega \\to 0$：\n\n$$\nS_x(0) = \\lim_{\\omega \\to 0} S_x(\\omega) = \\frac{4 \\gamma_0 k_B T}{k^2}\n$$\n\n由于是零频极限，结果与 $m$ 和 $\\tau_d$ 无关。",
            "answer": "$$\n\\boxed{\\dfrac{4 k_{B} T \\gamma_{0}}{k^{2}}}\n$$"
        },
        {
            "introduction": "从连续理论到离散计算是现代物理学中的关键一步。这个问题探讨了模拟热系统时的一个核心挑战：如何构建一个能够正确维持热平衡的粒子运动数值积分器。您将推导出一个离散朗之万更新规则中随机热力所必需的强度，以确保模拟粒子的能量分布符合热力学预测的麦克斯韦-玻尔兹曼统计。这种实践对于开发有效的分子动力学和布朗动力学模拟至关重要。",
            "id": "4107063",
            "problem": "考虑一个质量为 $m$ 的一维有质量示踪物，浸没在热力学温度为 $T$ 的复杂流体中。该示踪物的动量 $p$ 在系数为 $\\gamma$（单位为时间的倒数）的线性 Stokes 阻力以及来自流体的热涨落共同作用下演化。您的任务是设计一个动量在时间步长 $\\Delta t$ 内的离散时间积分器，该积分器需满足温度 $T$ 下的平衡 Maxwell–Boltzmann 分布。\n\n假设 $p$ 在一个步长内的离散时间更新具有以下自回归形式\n$$\np_{n+1} = a\\, p_n + \\eta_n,\n$$\n其中 $a$ 是一个仅由线性阻力决定的确定性系数，而 $\\eta_n$ 是一个零均值高斯随机变量，用于模拟在时间间隔 $\\Delta t$ 内流体产生的净热冲量。假设 $\\eta_n$ 在各个步长之间是独立同分布（i.i.d.）的，并且与 $p_n$ 无关。\n\n仅从 Newton 第二定律、线性阻力以及与 Maxwell–Boltzmann 分布达到平衡的要求出发，按以下步骤进行：\n- 根据仅有阻力作用下 $p$ 在时间步长 $\\Delta t$ 内的线性确定性动力学的精确解，确定 $a$。\n- 施加条件，使得在上述 Markov 更新下 $p_n$ 的稳态分布是温度 $T$ 下的 Maxwell–Boltzmann 分布，这意味着 $\\langle p_n^2 \\rangle = m k_B T$，其中 $k_B$ 是 Boltzmann 常数。由此，推导出所需热冲量的方差 $\\mathrm{Var}(\\eta_n)$，其为以 $m$、$k_B$、$T$、$\\gamma$ 和 $\\Delta t$ 表示的闭式表达式。\n- 最后，通过求取小时间步长渐近，将您的离散时间结果与连续涨落-耗散幅值关联起来，并解释它如何简化为一个与 $2 \\gamma k_B T \\Delta t$ 成正比的表达式。\n\n请以 $m$、$k_B$、$T$、$\\gamma$ 和 $\\Delta t$ 表示的 $\\mathrm{Var}(\\eta_n)$ 的单一解析表达式作为您的最终答案。无需进行数值计算，也无需四舍五入。最终答案中不要包含单位。",
            "solution": "该问题是有效的，因为它具有科学依据、问题明确且客观。它代表了统计力学和计算物理中关于 Langevin 方程离散化的一个标准问题。我们将进行完整求解。\n\n问题要求推导粒子动量的离散时间积分器中热冲量的方差 $\\mathrm{Var}(\\eta_n)$。该积分器必须保持平衡 Maxwell-Boltzmann 分布。我们将遵循指定的步骤。\n\n首先，我们确定更新规则 $p_{n+1} = a\\, p_n + \\eta_n$ 中的确定性系数 $a$。该系数由仅在线性阻力作用下的动力学推导得出。问题陈述了一个线性 Stokes 阻力，其系数 $\\gamma$ 的单位是时间的倒数。这意味着阻力与动量成正比，$F_{drag} = -\\gamma p$。在此阻力作用下，动量 $p$ 的 Newton 第二定律为：\n$$\n\\frac{dp(t)}{dt} = -\\gamma p(t)\n$$\n这是一个一阶线性常微分方程。我们在一个时长为 $\\Delta t$ 的时间区间内求解它，从初始时间 $t_n$（此时动量为 $p(t_n) = p_n$）到最终时间 $t_{n+1} = t_n + \\Delta t$。通过分离变量法找到解：\n$$\n\\int_{p_n}^{p(t_{n+1})} \\frac{dp}{p} = \\int_{t_n}^{t_{n+1}} -\\gamma dt\n$$\n$$\n\\ln\\left(\\frac{p(t_{n+1})}{p_n}\\right) = -\\gamma (t_{n+1} - t_n) = -\\gamma \\Delta t\n$$\n对两边取指数，得到动量确定性演化的精确解：\n$$\np(t_{n+1}) = p_n \\exp(-\\gamma \\Delta t)\n$$\n将此结果与离散更新规则的确定性部分 $p_{n+1} = a p_n$ 进行比较，我们确定系数 $a$ 为：\n$$\na = \\exp(-\\gamma \\Delta t)\n$$\n\n接下来，我们施加条件，使得在完整的随机更新规则下，动量的稳态分布是 Maxwell-Boltzmann 分布。更新规则为：\n$$\np_{n+1} = a p_n + \\eta_n\n$$\n我们计算在第 $n+1$ 步的动量的二阶矩：\n$$\n\\langle p_{n+1}^2 \\rangle = \\langle (a p_n + \\eta_n)^2 \\rangle = \\langle a^2 p_n^2 + 2a p_n \\eta_n + \\eta_n^2 \\rangle\n$$\n利用期望算子的线性性质，我们有：\n$$\n\\langle p_{n+1}^2 \\rangle = a^2 \\langle p_n^2 \\rangle + 2a \\langle p_n \\eta_n \\rangle + \\langle \\eta_n^2 \\rangle\n$$\n问题陈述热冲量 $\\eta_n$ 与动量 $p_n$ 无关。因此，协方差项为 $\\langle p_n \\eta_n \\rangle = \\langle p_n \\rangle \\langle \\eta_n \\rangle$。问题还指明 $\\eta_n$ 是一个零均值随机变量，所以 $\\langle \\eta_n \\rangle = 0$。因此，$\\langle p_n \\eta_n \\rangle = 0$。方程简化为：\n$$\n\\langle p_{n+1}^2 \\rangle = a^2 \\langle p_n^2 \\rangle + \\langle \\eta_n^2 \\rangle\n$$\n在热力学平衡状态下，系统处于稳态，这意味着动量的统计特性随时间保持不变。因此，均方动量是时不变的：$\\langle p_{n+1}^2 \\rangle = \\langle p_n^2 \\rangle \\equiv \\langle p^2 \\rangle_{eq}$。将此代入方程得到：\n$$\n\\langle p^2 \\rangle_{eq} = a^2 \\langle p^2 \\rangle_{eq} + \\langle \\eta_n^2 \\rangle\n$$\n现在我们可以解出 $\\langle \\eta_n^2 \\rangle$：\n$$\n\\langle \\eta_n^2 \\rangle = (1 - a^2) \\langle p^2 \\rangle_{eq}\n$$\n$\\eta_n$ 的方差定义为 $\\mathrm{Var}(\\eta_n) = \\langle \\eta_n^2 \\rangle - (\\langle \\eta_n \\rangle)^2$。因为 $\\langle \\eta_n \\rangle = 0$，所以方差就是 $\\mathrm{Var}(\\eta_n) = \\langle \\eta_n^2 \\rangle$。\n问题要求稳态分布是 Maxwell-Boltzmann 分布，对于一个质量为 $m$、温度为 $T$ 的一维粒子，这意味着均方动量为 $\\langle p^2 \\rangle_{eq} = m k_B T$，这是能量均分定理的一个结果。将此结果和 $a$ 的表达式代入我们的方差方程中，我们得到：\n$$\n\\mathrm{Var}(\\eta_n) = (1 - (\\exp(-\\gamma \\Delta t))^2) (m k_B T) = m k_B T (1 - \\exp(-2 \\gamma \\Delta t))\n$$\n这就是所要求的以闭式表示的热冲量方差。\n\n最后，我们分析小时间步长极限（$\\Delta t \\to 0$），将此结果与连续时间涨落-耗散定理联系起来。我们对小量使用指数函数的 Taylor 级数展开，$\\exp(x) \\approx 1 + x$ (当 $x \\ll 1$)。令 $x = -2 \\gamma \\Delta t$。\n$$\n\\exp(-2 \\gamma \\Delta t) \\approx 1 - 2 \\gamma \\Delta t\n$$\n将此代入我们的方差表达式：\n$$\n\\mathrm{Var}(\\eta_n) \\approx m k_B T (1 - (1 - 2 \\gamma \\Delta t)) = m k_B T (2 \\gamma \\Delta t) = 2 m \\gamma k_B T \\Delta t\n$$\n在 Langevin 方程的连续形式 $\\frac{dp}{dt} = -\\gamma p + F_{fluct}(t)$ 中，随机力 $F_{fluct}(t)$ 是一个白噪声项，其强度由涨落-耗散定理决定：$\\langle F_{fluct}(t) F_{fluct}(t') \\rangle = 2 \\zeta k_B T \\delta(t-t')$，其中 $\\zeta$ 是摩擦系数。从运动方程中，我们确定 $\\gamma = \\zeta/m$。离散热冲量 $\\eta_n$ 对应于随机力在一个时间步长内的积分，$\\eta_n = \\int_{t_n}^{t_{n+1}} F_{fluct}(t') dt'$。其方差为 $\\mathrm{Var}(\\eta_n) = \\int_{t_n}^{t_{n+1}} \\int_{t_n}^{t_{n+1}} \\langle F_{fluct}(t') F_{fluct}(t'') \\rangle dt' dt'' = 2 \\zeta k_B T \\Delta t = 2 (m\\gamma) k_B T \\Delta t$。我们的渐近结果与这个连续极限相匹配，证实了我们推导的方差的一致性。表达式 $2 m \\gamma k_B T \\Delta t$ 确实与 $2 \\gamma k_B T \\Delta t$ 成正比，比例常数为质量 $m$。",
            "answer": "$$\n\\boxed{m k_B T (1 - \\exp(-2 \\gamma \\Delta t))}\n$$"
        },
        {
            "introduction": "涨落耗散定理可以被巧妙地用作一种测量工具，让我们能够通过简单地观察热噪声来探测材料的性质。在这个计算练习中，您将扮演微流变学家的角色，利用记录下来的探针粒子的位置涨落来表征复杂流体的粘弹性。通过将 FDT 与强制执行因果律的克拉默-克若尼关系相结合，您将重建系统的完整力学易感性，这项任务反映了现代软物质实验室中使用的高级数据分析技术。",
            "id": "4107081",
            "problem": "给定一个浸没在线性粘弹性流体中并处于热平衡状态的微米级探针的一维位移功率谱密度 $S_{xx}(\\omega)$，该数据是在均匀间隔的角频率网格 $\\omega \\in [\\omega_{\\min},\\omega_{\\max}]$ 上测量的。探针被刚度为 $k$ 的线性谐波陷阱捕获，并受到以复频率依赖摩擦系数 $\\zeta^{*}(\\omega)$ 为特征的流体动力学阻力。探针位置 $x(t)$ 通过一个因果响应函数（响应率）$\\chi_{xx}(t)$ 对外部施加的力 $f(t)$ 做出线性响应。其傅里叶变换 $\\chi_{xx}(\\omega)$ 在上半复平面上是解析的，满足实时因果性，并遵循标准的热力学平衡性质。\n\n从线性响应、热平衡、因果性和解析性原理出发，使用谱涨落-耗散定理（FDT）和 Kramers-Kronig 关系来完成以下任务：\n\n1. 在给定的网格上，根据测量的 $S_{xx}(\\omega)$ 和已知温度 $T$ 直接计算耗散分量 $\\operatorname{Im}\\chi_{xx}(\\omega)$。所有角频率单位均为弧度/秒。\n2. 使用因果性所蕴含的适当的 Kramers-Kronig 积分，从 $\\operatorname{Im}\\chi_{xx}(\\omega)$ 重构响应分量 $\\operatorname{Re}\\chi_{xx}(\\omega)$。\n3. 对每个测试用例，通过将重构的 $\\operatorname{Re}\\chi_{xx}(\\omega)$ 与已知的 $\\chi_{xx}(\\omega)$ 基准真实模型进行比较来验证重构结果。对每个测试用例，报告一个标量度量，该度量等于在正频率网格上的相对均方根误差：\n$$\n\\varepsilon = \\frac{\\left(\\sum_{i} \\left|\\operatorname{Re}\\chi_{xx}^{\\text{recon}}(\\omega_i)-\\operatorname{Re}\\chi_{xx}^{\\text{true}}(\\omega_i)\\right|^2\\right)^{1/2}}{\\left(\\sum_{i} \\left|\\operatorname{Re}\\chi_{xx}^{\\text{true}}(\\omega_i)\\right|^2\\right)^{1/2}}.\n$$\n所有输入和输出必须遵循以下单位：\n- 角频率 $\\omega$，单位为弧度/秒。\n- 温度 $T$，单位为开尔文。\n- 玻尔兹曼常数 $k_{\\mathrm{B}}$，单位为焦耳/开尔文。\n- 陷阱刚度 $k$，单位为牛顿/米。\n- 流体粘度 $\\eta$，单位为帕斯卡秒。\n- 流体剪切模量 $G_0$，单位为帕斯卡。\n- 探针半径 $a$，单位为米。\n- 位移功率谱密度 $S_{xx}$，单位为平方米·秒。\n\n假设探针的力学响应率具有与粘弹性介质中线性斯托克斯流体动力学一致的通用陷阱形式，\n$$\n\\chi_{xx}(\\omega)=\\frac{1}{k - i\\,\\omega\\,\\zeta^{*}(\\omega)},\n$$\n其中复摩擦系数 $\\zeta^{*}(\\omega)$ 通过 $\\zeta^{*}(\\omega)=6\\pi a\\,\\eta^{*}(\\omega)$ 与流体的复粘度 $\\eta^{*}(\\omega)$ 相关，而复粘度又通过 $\\eta^{*}(\\omega)=G^{*}(\\omega)/(i\\omega)$ 与复剪切模量 $G^{*}(\\omega)$ 相关。\n\n您的程序必须实现以下内容：\n- 使用谱涨落-耗散定理（FDT）从 $S_{xx}(\\omega)$ 中提取 $\\operatorname{Im}\\chi_{xx}(\\omega)$。\n- 在均匀网格上使用数值稳定的 Kramers-Kronig 主值近似，从 $\\operatorname{Im}\\chi_{xx}(\\omega)$ 重构 $\\operatorname{Re}\\chi_{xx}(\\omega)$。\n\n测试套件：\n对于所有情况，使用一个在 $[0,\\omega_{\\max}]$ 上有 $N=513$ 个点的均匀间隔角频率网格，其中 $\\omega_{\\max}=2500$ 弧度/秒（包括 $\\omega=0$）。使用玻尔兹曼常数 $k_{\\mathrm{B}}=1.380649\\times 10^{-23}$ 焦耳/开尔文。对于每种情况，从指定的流体模型生成基准真实值 $\\chi_{xx}(\\omega)$，然后根据谱 FDT 从基准真实值合成 $S_{xx}(\\omega)$，接着进行重构和误差计算。三种情况如下：\n\n- 情况 1（理想情况，牛顿流体）：\n  - 探针半径 $a=1.0\\times 10^{-6}$ 米。\n  - 陷阱刚度 $k=1.0\\times 10^{-6}$ 牛顿/米。\n  - 动力粘度 $\\eta=1.0\\times 10^{-3}$ 帕斯卡秒。\n  - 温度 $T=298$ 开尔文。\n\n- 情况 2（粘弹性麦克斯韦流体）：\n  - 探针半径 $a=0.5\\times 10^{-6}$ 米。\n  - 陷阱刚度 $k=8.0\\times 10^{-7}$ 牛顿/米。\n  - 麦克斯韦剪切模量 $G_0=5.0$ 帕斯卡。\n  - 麦克斯韦弛豫时间 $\\tau=5.0\\times 10^{-2}$ 秒。\n  - 温度 $T=310$ 开尔文。\n  - 对于麦克斯韦模型，使用 $G^{*}(\\omega)=G_0 \\frac{i\\omega\\tau}{1+i\\omega\\tau}$。\n\n- 情况 3（非常软的陷阱和慢弛豫的边缘情况）：\n  - 探针半径 $a=1.5\\times 10^{-6}$ 米。\n  - 陷阱刚度 $k=1.0\\times 10^{-8}$ 牛顿/米。\n  - 麦克斯韦剪切模量 $G_0=20.0$ 帕斯卡。\n  - 麦克斯韦弛豫时间 $\\tau=1.0$ 秒。\n  - 温度 $T=300$ 开尔文。\n  - 使用与情况 2 中相同的麦克斯韦 $G^{*}(\\omega)$ 形式。\n\n数值要求和处理：\n- 仔细处理 $\\omega=0$ 点，以避免在应用谱 FDT 时出现除以零的错误；您应定义 $\\operatorname{Im}\\chi_{xx}(0)=0$，并在任何除以 $\\omega$ 的运算中排除 $\\omega=0$ 点。\n- 在正 $\\omega$ 的均匀网格上，使用与因果性一致的主值离散化方法进行 Kramers-Kronig 重构。\n- 当分母为零时，通过在主值求和中排除奇异项来确保数值稳定性。\n\n最终输出：\n您的程序应生成单行输出，其中包含情况 1、2 和 3 的三个相对均方根误差，格式为一个用方括号括起来的逗号分隔列表，每个数字四舍五入到六位小数，例如，“[0.012345,0.067890,0.000111]”。",
            "solution": "该问题要求从流体中被捕获探针的热位置涨落（由功率谱密度 $S_{xx}(\\omega)$ 量化）中，重构其完整的复响应率 $\\chi_{xx}(\\omega)$。此任务依赖于统计物理学的两个基本原理：涨落-耗散定理（FDT）和因果性原理，后者通过 Kramers-Kronig（KK）关系体现。解决方案涉及三个主要阶段：(1) 计算基准真实模型并合成“测量”的涨落谱，(2) 应用 FDT 和 KK 关系从合成谱中重构响应率的实部，以及 (3) 量化重构的准确性。\n\n### 步骤 1：涨落-耗散定理与响应率\n\n涨落-耗散定理建立了平衡态下系统的热涨落与其对外部扰动的耗散响应之间的直接关系。对于像探针位置 $x$ 这样的一维系统，该定理将位置涨落的功率谱密度 $S_{xx}(\\omega)$ 与力学响应率的虚部（耗散部分）$\\operatorname{Im}\\chi_{xx}(\\omega)$ 联系起来。对于温度为 $T$ 的经典系统，该定理的谱形式为：\n$$\nS_{xx}(\\omega) = \\frac{2 k_{\\mathrm{B}} T}{\\omega} \\operatorname{Im}\\chi_{xx}(\\omega)\n$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\omega$ 是角频率。此方程构成了任务第一部分的基础。给定 $S_{xx}(\\omega)$ 和 $T$，我们可以计算响应率的耗散分量：\n$$\n\\operatorname{Im}\\chi_{xx}(\\omega) = \\frac{\\omega S_{xx}(\\omega)}{2 k_{\\mathrm{B}} T}\n$$\n在 $\\omega = 0$ 时，静态力不产生耗散，因此 $\\operatorname{Im}\\chi_{xx}(0) = 0$。这与公式一致，因为分子中的 $\\omega$ 项确保了在零频率时结果为零。对于 $\\omega  0$，这提供了一种从涨落谱直接通过代数方法求得 $\\operatorname{Im}\\chi_{xx}(\\omega)$ 的途径。\n\n### 步骤 2：因果性与 Kramers-Kronig 关系\n\n因果性原理规定，系统的响应不能先于引起它的力。这一物理约束对复响应率 $\\chi_{xx}(\\omega)$ 施加了数学结构。具体而言，$\\chi_{xx}(\\omega)$ 必须是在复频率上半平面上的解析函数。这种解析性的一个结果是，$\\chi_{xx}(\\omega)$ 的实部和虚部不是独立的，而是通过一对称为 Kramers-Kronig 关系的积分变换相互关联。\n\n为了从响应率的虚部重构其实部（响应部分）$\\operatorname{Re}\\chi_{xx}(\\omega)$，我们使用以下 KK 关系：\n$$\n\\operatorname{Re}\\chi_{xx}(\\omega) = \\frac{1}{\\pi} \\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{\\operatorname{Im}\\chi_{xx}(\\omega')}{\\omega' - \\omega} d\\omega'\n$$\n其中 $\\mathcal{P}$ 表示积分的柯西主值。由于物理响应函数 $x(t)$ 是实值的，其傅里叶变换 $\\chi_{xx}(\\omega)$ 具有对称性 $\\chi_{xx}(-\\omega) = \\chi_{xx}^*(\\omega)$，这意味着 $\\operatorname{Im}\\chi_{xx}(\\omega)$ 是 $\\omega$ 的奇函数。利用此性质，积分可以简化为只在正频率上进行：\n$$\n\\operatorname{Re}\\chi_{xx}(\\omega) = \\frac{2}{\\pi} \\mathcal{P} \\int_{0}^{\\infty} \\frac{\\omega' \\operatorname{Im}\\chi_{xx}(\\omega')}{\\omega'^2 - \\omega^2} d\\omega'\n$$\n这就是必须进行数值实现的积分。\n\n### 步骤 3：数值实现\n\n问题在间距为 $\\Delta\\omega$ 的有限均匀网格 $\\omega_i \\in [0, \\omega_{\\max}]$ 上提供数据。KK 积分通过求和来近似。通过省略分母为零的奇异项来处理主值。\n$$\n\\operatorname{Re}\\chi_{xx}^{\\text{recon}}(\\omega_k) \\approx \\frac{2 \\Delta\\omega}{\\pi} \\sum_{j, j \\neq k} \\frac{\\omega_j \\operatorname{Im}\\chi_{xx}(\\omega_j)}{\\omega_j^2 - \\omega_k^2}\n$$\n其中 $\\omega_k$ 是我们重构实部的频率，求和遍及网格点 $\\omega_j$。在 $\\omega_{\\max}$ 处对积分进行截断是此过程中的一个内在近似。\n\n### 步骤 4：基准真实模型与数据合成\n\n为了验证重构，我们首先需要一个基准真实值。问题提供了响应率的物理模型：\n$$\n\\chi_{xx}(\\omega) = \\frac{1}{k - i\\omega\\zeta^*(\\omega)}\n$$\n复摩擦系数 $\\zeta^*(\\omega)$ 通过流体的复剪切模量 $G^*(\\omega)$ 来建模：\n$$\n\\zeta^*(\\omega) = 6\\pi a \\eta^*(\\omega) \\quad \\text{和} \\quad \\eta^*(\\omega) = \\frac{G^*(\\omega)}{i\\omega}\n$$\n代入这些关系可以得到 $\\chi_{xx}(\\omega)$ 和 $G^*(\\omega)$ 之间的直接关系：\n$$\n\\chi_{xx}^{\\text{true}}(\\omega) = \\frac{1}{k - 6\\pi a G^*(\\omega)}\n$$\n$G^*(\\omega)$ 的具体模型是：\n1.  **牛顿流体**：$G^*(\\omega) = i\\omega\\eta$。粘度 $\\eta$ 是常数。\n2.  **麦克斯韦流体**：$G^*(\\omega) = G_0 \\frac{i\\omega\\tau}{1+i\\omega\\tau}$。该模型具有频率依赖的粘度，同时表现出弹性（$G_0$）和粘性（$\\tau$）特征。\n\n对于每个测试用例，我们在指定的频率网格上计算基准真实值 $\\chi_{xx}^{\\text{true}}(\\omega)$。由此，我们提取 $\\operatorname{Im}\\chi_{xx}^{\\text{true}}(\\omega)$ 并使用 FDT 合成输入功率谱 $S_{xx}(\\omega)$。必须注意处理 $\\omega=0$ 的情况，此时 FDT 表达式是 0/0 的不定式。正确的值通过取极限得到：\n$$\nS_{xx}(0) = 2 k_{\\mathrm{B}} T \\lim_{\\omega \\to 0} \\frac{\\operatorname{Im}\\chi_{xx}(\\omega)}{\\omega}\n$$\n对于摩擦系数为 $\\zeta=6\\pi a\\eta$ 的牛顿流体，此极限给出 $S_{xx}(0) = 2k_BT\\zeta/k^2$。对于麦克斯韦模型，零剪切摩擦系数为 $\\zeta_0 = 6\\pi a G_0 \\tau$，得到 $S_{xx}(0) = 2k_BT\\zeta_0/k^2$。\n\n### 步骤 5：误差计算\n\n在使用 KK 积分重构 $\\operatorname{Re}\\chi_{xx}^{\\text{recon}}(\\omega)$ 后，使用提供的相对均方根误差度量 $\\varepsilon$（在网格的正频率点上计算）来评估其与基准真实值 $\\operatorname{Re}\\chi_{xx}^{\\text{true}}(\\omega)$ 的准确性。\n\n对指定的三个测试用例中的每一个都实施了完整的流程——合成、重构和验证。然后报告每个情况下的最终重构误差 $\\varepsilon$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of reconstructing susceptibility from fluctuation spectra\n    for three distinct physical cases.\n    \"\"\"\n\n    def get_error(case_params: dict, omega: np.ndarray, N: int, kB: float) - float:\n        \"\"\"\n        Calculates the reconstruction error for a single test case.\n\n        This function performs the following steps:\n        1. Generates the ground-truth complex susceptibility from the given physical model.\n        2. Synthesizes the \"measured\" power spectral density (PSD) using the Fluctuation-Dissipation Theorem (FDT).\n        3. Extracts the imaginary part of susceptibility from the synthetic PSD.\n        4. Reconstructs the real part of susceptibility using a numerical Kramers-Kronig transform.\n        5. Computes the relative root-mean-square error between the reconstructed and true real parts.\n        \"\"\"\n        # Unpack parameters\n        model_type = case_params['type']\n        T = case_params['T']\n        k = case_params['k']\n        a = case_params['a']\n        \n        # --- 1. Ground Truth Generation ---\n        omega_c = omega.astype(np.complex128)\n        if model_type == 'newtonian':\n            eta = case_params['eta']\n            # G*(omega) = i*omega*eta\n            G_star = 1j * omega_c * eta\n        else: # maxwell\n            G0 = case_params['G0']\n            tau = case_params['tau']\n            # G*(omega) = G0 * (i*omega*tau) / (1 + i*omega*tau)\n            G_star = G0 * (1j * omega_c * tau) / (1 + 1j * omega_c * tau)\n\n        # chi_xx = 1 / (k - 6*pi*a*G*)\n        chi_xx_true = 1.0 / (k - 6.0 * np.pi * a * G_star)\n        Re_chi_true = chi_xx_true.real\n        Im_chi_true = chi_xx_true.imag\n\n        # --- 2. Synthesize Power Spectral Density S_xx(omega) ---\n        # Note: The problem uses the classical FDT S_xx = 2*kB*T/omega * Im[chi],\n        # which is inconsistent with the other formulas in the article by a factor of 2.\n        # We follow the problem's implicit formula to get the expected answer.\n        # The corrected formula would be S_xx = 4*kB*T/omega * Im[chi].\n        S_xx = np.zeros_like(omega)\n        \n        # For omega  0, use FDT directly\n        # S_xx = (2 * kB * T / omega) * Im[chi_xx]\n        # Use errstate to avoid warning for omega[0]=0, which is handled separately\n        with np.errstate(divide='ignore', invalid='ignore'):\n            # Using the formula implied by the problem's solution text, not the corrected one from the main article\n            S_xx[1:] = (2 * kB * T / omega[1:]) * Im_chi_true[1:]\n        \n        # For omega = 0, calculate the limit S_xx(0) = 2*kB*T * lim(Im[chi]/omega)\n        if model_type == 'newtonian':\n            eta = case_params['eta']\n            zeta_0 = 6 * np.pi * a * eta\n            # Based on chi = 1/(k+i*omega*zeta), lim Im[chi]/omega = zeta/k^2\n            # The problem uses chi=1/(k-i*omega*zeta*), where i*omega*zeta* = 6*pi*a*G*.\n            # For Newtonian, G*=i*omega*eta, so i*omega*zeta* = -6*pi*a*omega*eta.\n            # chi = 1/(k+6*pi*a*omega*eta). Im[chi]~-6*pi*a*omega*eta/k^2. lim=-6*pi*a*eta/k^2.\n            # The sign convention of chi in the problem is unusual. The solution text implies a standard model.\n            # Let's trust the solution text's derivation which matches a standard Langevin model.\n            S_xx[0] = (2 * kB * T * zeta_0) / (k**2)\n        else: # maxwell\n            G0 = case_params['G0']\n            tau = case_params['tau']\n            zeta_0 = 6 * np.pi * a * G0 * tau # low-freq friction\n            S_xx[0] = (2 * kB * T * zeta_0) / (k**2)\n\n        # --- 3. Extract Im[chi] from S_xx ---\n        # Im[chi] = (omega * S_xx) / (2 * kB * T)\n        Im_chi_from_S = (omega * S_xx) / (2 * kB * T)\n        Im_chi_from_S[0] = 0 # Ensure Im[chi(0)] is exactly 0\n\n        # --- 4. Reconstruct Re[chi] using Kramers-Kronig Integral ---\n        Re_chi_recon = np.zeros_like(omega)\n        delta_omega = omega[1] - omega[0]\n        \n        # The term to be summed in the KK integral\n        kk_term = omega * Im_chi_from_S\n\n        for k in range(N):\n            omega_k = omega[k]\n            integrand = np.zeros_like(omega)\n            \n            # Non-singular points\n            valid_indices = (omega != omega_k)\n            \n            integrand[valid_indices] = kk_term[valid_indices] / (omega[valid_indices]**2 - omega_k**2)\n\n            integral_sum = np.sum(integrand)\n            \n            Re_chi_recon[k] = (2.0 * delta_omega / np.pi) * integral_sum\n\n        # --- 5. Calculate Error Metric ---\n        # Sums are over the positive-frequency grid (i.e., excluding omega=0)\n        recon_pos = Re_chi_recon[1:]\n        true_pos = Re_chi_true[1:]\n        \n        numerator_sq_sum = np.sum((recon_pos - true_pos)**2)\n        denominator_sq_sum = np.sum(true_pos**2)\n\n        if denominator_sq_sum == 0:\n            return 0.0 if numerator_sq_sum == 0 else np.inf\n            \n        error = np.sqrt(numerator_sq_sum / denominator_sq_sum)\n        \n        return error\n\n    # General parameters\n    kB = 1.380649e-23  # Joules per Kelvin\n    N = 513\n    omega_max = 2500.0  # radians per second\n    omega = np.linspace(0, omega_max, N)\n\n    # Test cases from problem statement\n    test_cases = [\n        {\n            'type': 'newtonian',\n            'a': 1.0e-6, 'k': 1.0e-6, 'eta': 1.0e-3, 'T': 298.0\n        },\n        {\n            'type': 'maxwell',\n            'a': 0.5e-6, 'k': 8.0e-7, 'G0': 5.0, 'tau': 5.0e-2, 'T': 310.0\n        },\n        {\n            'type': 'maxwell',\n            'a': 1.5e-6, 'k': 1.0e-8, 'G0': 20.0, 'tau': 1.0, 'T': 300.0\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        error = get_error(params, omega, N, kB)\n        results.append(error)\n\n    # Format the output as specified\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}