{
    "hands_on_practices": [
        {
            "introduction": "The linear advection equation is a cornerstone of transport phenomena modeling. This first exercise applies Von Neumann analysis to the classic Lax–Friedrichs scheme, a method that introduces numerical diffusion to ensure stability. By working through this problem , you will derive the amplification factor for a fundamental explicit scheme and determine its stability bound, the famous Courant–Friedrichs–Lewy (CFL) condition.",
            "id": "4097362",
            "problem": "Consider the linear advection of a conserved scalar in a complex fluid microstructure governed by the partial differential equation $u_{t} + a\\,u_{x} = 0$, where $u(x,t)$ is the scalar field and $a$ is a constant advection speed. On a uniform spatial grid with spacing $\\Delta x$ and time step $\\Delta t$, consider the Lax–Friedrichs finite difference method defined by the explicit update\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\big(u_{j+1}^{n} + u_{j-1}^{n}\\big) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\big(u_{j+1}^{n} - u_{j-1}^{n}\\big),\n$$\nwhere $u_{j}^{n}$ approximates $u(x_{j},t^{n})$ at grid index $j$ and time level $n$. Using the von Neumann (Fourier) stability analysis, assume a single Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)$ for nondimensional wavenumber $\\kappa$ measured in radians. Define the Courant–Friedrichs–Lewy (CFL) number by $\\text{CFL} = a\\,\\Delta t/\\Delta x$. \n\nStarting from these definitions, derive the amplification factor $G(\\kappa)$ satisfying $\\hat{u}^{n+1} = G(\\kappa)\\,\\hat{u}^{n}$, and then determine the exact upper bound on the magnitude of the Courant–Friedrichs–Lewy number required for absolute stability over all $\\kappa \\in [-\\pi,\\pi]$ (in radians). \n\nProvide your final answer as a row matrix containing:\n- the closed-form expression for $G(\\kappa)$, and\n- the maximum allowable magnitude of $\\text{CFL}$ for stability (a single real number).",
            "solution": "The user-provided problem is validated as self-contained, scientifically grounded, and well-posed. All necessary information for a unique solution is provided, and the problem adheres to established principles of numerical analysis for partial differential equations. The process proceeds to a complete solution.\n\nThe problem requires the derivation of the amplification factor for the Lax–Friedrichs finite difference scheme and the subsequent determination of the stability condition based on this factor. The analysis will be performed using the von Neumann (or Fourier) stability analysis method.\n\nThe governing partial differential equation is the linear advection equation:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nThe Lax–Friedrichs scheme discretizes this equation as:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\big(u_{j+1}^{n} + u_{j-1}^{n}\\big) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\big(u_{j+1}^{n} - u_{j-1}^{n}\\big)\n$$\nwhere $u_{j}^{n}$ is the numerical approximation of $u(x_j, t_n)$, with $x_j = j\\,\\Delta x$ and $t_n = n\\,\\Delta t$.\n\nThe Courant–Friedrichs–Lewy (CFL) number is defined as $\\text{CFL} = \\frac{a\\,\\Delta t}{\\Delta x}$. Substituting this definition into the scheme gives:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\big(u_{j+1}^{n} + u_{j-1}^{n}\\big) - \\frac{\\text{CFL}}{2}\\big(u_{j+1}^{n} - u_{j-1}^{n}\\big)\n$$\n\nFor the von Neumann stability analysis, we substitute a single Fourier mode of the form $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)$ into the difference equation. Here, $\\hat{u}^{n}$ is the amplitude of the mode at time level $n$, $i = \\sqrt{-1}$ is the imaginary unit, and $\\kappa = k\\,\\Delta x$ is the dimensionless wavenumber, where $k$ is the physical wavenumber.\n\nThe terms in the scheme at grid point $j$ and time level $n$ can be expressed as:\n- $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)$\n- $u_{j+1}^{n} = \\hat{u}^{n}\\,\\exp(i\\,(j+1)\\,\\kappa) = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)\\,\\exp(i\\,\\kappa)$\n- $u_{j-1}^{n} = \\hat{u}^{n}\\,\\exp(i\\,(j-1)\\,\\kappa) = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)\\,\\exp(-i\\,\\kappa)$\n\nAt the next time level, $n+1$, the solution is given by $u_{j}^{n+1} = \\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\kappa)$. The amplification factor, $G(\\kappa)$, is defined by the relation $\\hat{u}^{n+1} = G(\\kappa)\\,\\hat{u}^{n}$.\n\nSubstituting these modal forms into the finite difference scheme:\n$$\n\\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\kappa) = \\frac{1}{2}\\left(\\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)\\,\\exp(i\\,\\kappa) + \\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)\\,\\exp(-i\\,\\kappa)\\right) - \\frac{\\text{CFL}}{2}\\left(\\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)\\,\\exp(i\\,\\kappa) - \\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)\\,\\exp(-i\\,\\kappa)\\right)\n$$\nWe can divide the entire equation by the common factor $\\hat{u}^{n}\\,\\exp(i\\,j\\,\\kappa)$, which is non-zero for a non-trivial solution. This yields an expression for the ratio $\\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$, which is the amplification factor $G(\\kappa)$:\n$$\nG(\\kappa) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}} = \\frac{1}{2}\\left(\\exp(i\\,\\kappa) + \\exp(-i\\,\\kappa)\\right) - \\frac{\\text{CFL}}{2}\\left(\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa)\\right)\n$$\nUsing Euler's formulas, $\\cos(\\kappa) = \\frac{\\exp(i\\,\\kappa) + \\exp(-i\\,\\kappa)}{2}$ and $\\sin(\\kappa) = \\frac{\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa)}{2i}$, we can simplify the expression for $G(\\kappa)$:\n$$\nG(\\kappa) = \\cos(\\kappa) - \\frac{\\text{CFL}}{2}\\left(2i\\,\\sin(\\kappa)\\right)\n$$\n$$\nG(\\kappa) = \\cos(\\kappa) - i\\,\\text{CFL}\\,\\sin(\\kappa)\n$$\nThis is the closed-form expression for the amplification factor.\n\nNext, we determine the condition for numerical stability. The scheme is stable if the magnitude of the amplification factor is less than or equal to $1$ for all possible wavenumbers $\\kappa$. The range of unique wavenumbers on a discrete grid is $\\kappa \\in [-\\pi, \\pi]$. The stability condition is $|G(\\kappa)| \\le 1$.\n\nWe compute the magnitude squared of $G(\\kappa)$:\n$$\n|G(\\kappa)|^{2} = |\\cos(\\kappa) - i\\,\\text{CFL}\\,\\sin(\\kappa)|^{2}\n$$\nFor a complex number $z = x + iy$, its magnitude squared is $|z|^2 = x^2 + y^2$. Here, the real part is $\\cos(\\kappa)$ and the imaginary part is $-\\text{CFL}\\,\\sin(\\kappa)$.\n$$\n|G(\\kappa)|^{2} = (\\cos(\\kappa))^{2} + (-\\text{CFL}\\,\\sin(\\kappa))^{2} = \\cos^{2}(\\kappa) + (\\text{CFL})^{2}\\,\\sin^{2}(\\kappa)\n$$\nThe stability condition is $|G(\\kappa)|^2 \\le 1$:\n$$\n\\cos^{2}(\\kappa) + (\\text{CFL})^{2}\\,\\sin^{2}(\\kappa) \\le 1\n$$\nUsing the trigonometric identity $\\cos^{2}(\\kappa) = 1 - \\sin^{2}(\\kappa)$, we substitute it into the inequality:\n$$\n1 - \\sin^{2}(\\kappa) + (\\text{CFL})^{2}\\,\\sin^{2}(\\kappa) \\le 1\n$$\nSubtracting $1$ from both sides gives:\n$$\n(\\text{CFL})^{2}\\,\\sin^{2}(\\kappa) - \\sin^{2}(\\kappa) \\le 0\n$$\nFactoring out the $\\sin^{2}(\\kappa)$ term:\n$$\n\\sin^{2}(\\kappa) \\left((\\text{CFL})^{2} - 1\\right) \\le 0\n$$\nThis inequality must hold for all wavenumbers $\\kappa \\in [-\\pi, \\pi]$. The term $\\sin^{2}(\\kappa)$ is always non-negative, i.e., $\\sin^{2}(\\kappa) \\ge 0$. For the product of two numbers to be non-positive, if one is non-negative, the other must be non-positive.\nTherefore, the stability of the scheme requires:\n$$\n(\\text{CFL})^{2} - 1 \\le 0\n$$\n$$\n(\\text{CFL})^{2} \\le 1\n$$\nTaking the square root of both sides yields the condition on the magnitude of the CFL number:\n$$\n|\\text{CFL}| \\le 1\n$$\nThis condition is independent of the wavenumber $\\kappa$. The exact upper bound on the magnitude of the CFL number for which the scheme is stable is $1$.\n\nThe final answer consists of two parts: the expression for $G(\\kappa)$ and the maximum allowable magnitude of $\\text{CFL}$.\n1. $G(\\kappa) = \\cos(\\kappa) - i\\,\\text{CFL}\\,\\sin(\\kappa)$\n2. The maximum allowable magnitude of $\\text{CFL}$ is $1$.\nThese are presented as a row matrix as requested.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\cos(\\kappa) - i\\,\\text{CFL}\\,\\sin(\\kappa) & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Complex fluid dynamics typically involves the interaction of multiple physical fields, requiring the solution of coupled systems of partial differential equations. This practice extends the scalar analysis to such a system, where variables like concentration and velocity are intertwined . You will discover that the scalar amplification factor is replaced by an amplification matrix, $\\Phi$, and stability is now governed by its spectral radius, $\\rho(\\Phi)$.",
            "id": "4097410",
            "problem": "Consider small-amplitude, one-dimensional perturbations in a complex fluid mixture, linearized into a two-variable system governed by conservation laws. Let the state vector be $q(x,t) \\in \\mathbb{R}^{2}$ with components $q = (c,u)^{\\mathsf{T}}$, where $c$ represents a dimensionless concentration perturbation and $u$ a dimensionless axial velocity perturbation. The linearized evolution equation is\n$$\n\\frac{\\partial q}{\\partial t} \\;=\\; A \\,\\frac{\\partial q}{\\partial x} \\;+\\; B \\,\\frac{\\partial^{2} q}{\\partial x^{2}},\n$$\nwhere $A \\in \\mathbb{R}^{2 \\times 2}$ and $B \\in \\mathbb{R}^{2 \\times 2}$ are constant coefficient matrices. Assume a uniform spatial grid with spacing $\\Delta x$ and discretize the spatial derivatives using central differences, namely\n$$\n\\frac{\\partial q}{\\partial x}\\Big|_{x_j} \\approx \\frac{q_{j+1} - q_{j-1}}{2\\,\\Delta x}, \n\\qquad\n\\frac{\\partial^{2} q}{\\partial x^{2}}\\Big|_{x_j} \\approx \\frac{q_{j+1} - 2\\,q_j + q_{j-1}}{\\Delta x^{2}}.\n$$\nAdvance in time using the forward Euler method with time step $\\Delta t$, so that\n$$\nq^{n+1}_j \\;=\\; q^n_j \\;+\\; \\Delta t \\left( A \\,\\frac{q^n_{j+1} - q^n_{j-1}}{2\\,\\Delta x} \\;+\\; B \\,\\frac{q^n_{j+1} - 2\\,q^n_j + q^n_{j-1}}{\\Delta x^{2}} \\right).\n$$\n\nFor the purpose of von Neumann stability analysis, consider a discrete Fourier mode $q^n_j = \\hat{q}^n \\,\\exp(i \\kappa x_j)$, with wavenumber $\\kappa$ and $x_j = j\\,\\Delta x$. Define the nondimensional phase $\\theta = \\kappa\\,\\Delta x$ and the amplification matrix $\\Phi(\\Delta t\\,M(\\kappa))$ associated with one time step, where $M(\\kappa)$ is the $2 \\times 2$ Fourier symbol of the semi-discrete spatial operator.\n\nUse the following parameterization, intended to mimic coupled advection–diffusion in complex fluids with cross-diffusion:\n$A = U_0\\,I$, $U_0 = 0.5$, and $B = \\begin{pmatrix} 0.02 & 0.01 \\\\ 0.01 & 0.05 \\end{pmatrix},$\nwith grid spacing $\\Delta x = 0.1$ and time step $\\Delta t = 0.01$. Derive $M(\\kappa)$ explicitly and compute the von Neumann amplification factor given by the spectral radius of $\\Phi(\\Delta t\\,M(\\kappa))$ under forward Euler, that is $\\Phi(Z) = I + Z$. Evaluate the amplification factor at the Fourier mode with $\\theta = \\kappa \\Delta x = \\pi/3$ (radians). Round your answer to four significant figures and express it as a dimensionless number.",
            "solution": "The problem asks for the von Neumann amplification factor for a given finite difference scheme applied to a system of linearized partial differential equations. The process involves validating the problem, deriving the amplification matrix, computing its eigenvalues, and finding the spectral radius.\n\n### Step 1: Problem Validation\nThe problem statement provides a complete set of equations, parameters, and discretization methods.\n- **Givens**:\n  - The evolution equation: $\\frac{\\partial q}{\\partial t} = A \\,\\frac{\\partial q}{\\partial x} + B \\,\\frac{\\partial^{2} q}{\\partial x^{2}}$.\n  - The state vector: $q = (c,u)^{\\mathsf{T}} \\in \\mathbb{R}^2$.\n  - The coefficient matrices: $A = U_0\\,I$ with $U_0 = 0.5$, and $B = \\begin{pmatrix} 0.02 & 0.01 \\\\ 0.01 & 0.05 \\end{pmatrix}$.\n  - The spatial discretization: Central differences for first and second derivatives.\n  - The temporal discretization: Forward Euler method.\n  - The full discrete scheme: $q^{n+1}_j = q^n_j + \\Delta t \\left( A \\,\\frac{q^n_{j+1} - q^n_{j-1}}{2\\,\\Delta x} + B \\,\\frac{q^n_{j+1} - 2\\,q^n_j + q^n_{j-1}}{\\Delta x^{2}} \\right)$.\n  - Grid parameters: $\\Delta x = 0.1$, $\\Delta t = 0.01$.\n  - Fourier mode for analysis: $q^n_j = \\hat{q}^n \\,\\exp(i \\kappa x_j)$, with phase $\\theta = \\kappa \\Delta x = \\pi/3$.\n  - Amplification matrix form: $\\Phi(Z) = I + Z$ for the Forward Euler method, where $Z = \\Delta t M(\\kappa)$ and $M(\\kappa)$ is the Fourier symbol of the spatial operator.\n\n- **Validation**:\n  The problem is a standard application of von Neumann stability analysis to a linear system of PDEs. It is scientifically grounded in numerical analysis for computational fluid dynamics. The problem is well-posed, with all necessary data provided and no contradictions. The values are physically reasonable for a non-dimensionalized system. The language is objective and precise. Therefore, the problem is valid.\n\n### Step 2: Derivation of the Amplification Matrix\nThe von Neumann analysis proceeds by substituting a single Fourier mode $q_j^n = \\hat{q}^n \\exp(i\\kappa x_j)$ into the discrete scheme. Let $\\theta = \\kappa \\Delta x$. The spatial neighbors are related by:\n$q_{j+1}^n = \\hat{q}^n \\exp(i\\kappa(j+1)\\Delta x) = q_j^n \\exp(i\\theta)$\n$q_{j-1}^n = \\hat{q}^n \\exp(i\\kappa(j-1)\\Delta x) = q_j^n \\exp(-i\\theta)$\n\nSubstitute these into the finite difference operators:\n- First-order derivative term:\n$$\nA \\,\\frac{q^n_{j+1} - q^n_{j-1}}{2\\,\\Delta x} = A \\,\\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2\\,\\Delta x} q_j^n = A \\,\\frac{2i\\sin(\\theta)}{2\\,\\Delta x} q_j^n = A \\frac{i\\sin(\\theta)}{\\Delta x} q_j^n\n$$\n- Second-order derivative term:\n$$\nB \\,\\frac{q^n_{j+1} - 2\\,q^n_j + q^n_{j-1}}{\\Delta x^{2}} = B \\,\\frac{\\exp(i\\theta) - 2 + \\exp(-i\\theta)}{\\Delta x^2} q_j^n = B \\,\\frac{2\\cos(\\theta) - 2}{\\Delta x^2} q_j^n\n$$\nThe semi-discretized equation in Fourier space is $\\frac{d\\hat{q}^n}{dt} = M(\\kappa)\\hat{q}^n$, where $M(\\kappa)$ is the Fourier symbol of the spatial operator:\n$$\nM(\\kappa) = A \\frac{i\\sin(\\theta)}{\\Delta x} + B \\frac{2(\\cos(\\theta)-1)}{\\Delta x^2}\n$$\nThe forward Euler time-stepping gives the relation $\\hat{q}^{n+1} = \\hat{q}^{n} + \\Delta t M(\\kappa) \\hat{q}^{n}$.\nThe amplification matrix $\\Phi$ is defined by $\\hat{q}^{n+1} = \\Phi \\hat{q}^{n}$. Thus,\n$$\n\\Phi = I + \\Delta t M(\\kappa) = I + \\Delta t \\left( A \\frac{i\\sin(\\theta)}{\\Delta x} + B \\frac{2(\\cos(\\theta)-1)}{\\Delta x^2} \\right)\n$$\nThis is of the form $\\Phi = I+Z$ given in the problem statement.\n\n### Step 3: Numerical Calculation of the Amplification Matrix\nWe are given the following values:\n- $A = 0.5\\,I = \\begin{pmatrix} 0.5 & 0 \\\\ 0 & 0.5 \\end{pmatrix}$\n- $B = \\begin{pmatrix} 0.02 & 0.01 \\\\ 0.01 & 0.05 \\end{pmatrix}$\n- $\\Delta x = 0.1$, $\\Delta t = 0.01$\n- $\\theta = \\pi/3$, so $\\sin(\\theta) = \\sqrt{3}/2$ and $\\cos(\\theta) = 1/2$.\n\nLet's compute the coefficients for the matrices $A$ and $B$:\n$$\n\\frac{\\Delta t}{\\Delta x} i \\sin(\\theta) = \\frac{0.01}{0.1} i \\frac{\\sqrt{3}}{2} = 0.1 \\cdot i \\frac{\\sqrt{3}}{2} = i \\frac{\\sqrt{3}}{20}\n$$\n$$\n\\frac{2\\Delta t}{\\Delta x^2} (\\cos(\\theta)-1) = \\frac{2 \\cdot 0.01}{(0.1)^2} \\left(\\frac{1}{2}-1\\right) = \\frac{0.02}{0.01} \\left(-\\frac{1}{2}\\right) = 2 \\left(-\\frac{1}{2}\\right) = -1\n$$\nNow, assemble the matrix $Z = \\Delta t M(\\kappa)$:\n$$\nZ = \\left(i \\frac{\\sqrt{3}}{20}\\right) A + (-1) B = i \\frac{\\sqrt{3}}{20} \\begin{pmatrix} 0.5 & 0 \\\\ 0 & 0.5 \\end{pmatrix} - \\begin{pmatrix} 0.02 & 0.01 \\\\ 0.01 & 0.05 \\end{pmatrix}\n$$\n$$\nZ = i \\frac{\\sqrt{3}}{40} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 0.02 & 0.01 \\\\ 0.01 & 0.05 \\end{pmatrix} = \\begin{pmatrix} -0.02 + i\\frac{\\sqrt{3}}{40} & -0.01 \\\\ -0.01 & -0.05 + i\\frac{\\sqrt{3}}{40} \\end{pmatrix}\n$$\nThe amplification matrix is $\\Phi = I + Z$:\n$$\n\\Phi = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} + Z = \\begin{pmatrix} 0.98 + i\\frac{\\sqrt{3}}{40} & -0.01 \\\\ -0.01 & 0.95 + i\\frac{\\sqrt{3}}{40} \\end{pmatrix}\n$$\n\n### Step 4: Eigenvalue Calculation\nThe amplification factor is the spectral radius of $\\Phi$, $\\rho(\\Phi) = \\max_k |\\lambda_k|$, where $\\lambda_k$ are the eigenvalues of $\\Phi$. The eigenvalues are the roots of the characteristic equation $\\det(\\Phi - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix} 0.98 + i\\frac{\\sqrt{3}}{40} - \\lambda & -0.01 \\\\ -0.01 & 0.95 + i\\frac{\\sqrt{3}}{40} - \\lambda \\end{pmatrix} = 0\n$$\nFor a $2 \\times 2$ matrix of the form $\\begin{pmatrix} z_1 & d \\\\ d & z_2 \\end{pmatrix}$, the eigenvalues are given by $\\lambda = \\frac{z_1+z_2}{2} \\pm \\sqrt{\\left(\\frac{z_1-z_2}{2}\\right)^2 + d^2}$.\nHere, $z_1 = 0.98 + i\\frac{\\sqrt{3}}{40}$, $z_2 = 0.95 + i\\frac{\\sqrt{3}}{40}$, and $d = -0.01$.\n\nFirst, compute the average of the diagonal elements:\n$$\n\\frac{z_1+z_2}{2} = \\frac{(0.98 + i\\frac{\\sqrt{3}}{40}) + (0.95 + i\\frac{\\sqrt{3}}{40})}{2} = \\frac{1.93 + i\\frac{2\\sqrt{3}}{40}}{2} = 0.965 + i\\frac{\\sqrt{3}}{40}\n$$\nNext, compute half the difference of the diagonal elements:\n$$\n\\frac{z_1-z_2}{2} = \\frac{0.98 - 0.95}{2} = \\frac{0.03}{2} = 0.015\n$$\nNow, compute the term under the square root:\n$$\n\\sqrt{\\left(\\frac{z_1-z_2}{2}\\right)^2 + d^2} = \\sqrt{(0.015)^2 + (-0.01)^2} = \\sqrt{0.000225 + 0.0001} = \\sqrt{0.000325}\n$$\nWe can simplify $\\sqrt{0.000325} = \\sqrt{3.25 \\times 10^{-4}} = 10^{-2}\\sqrt{3.25} = 0.01\\sqrt{\\frac{13}{4}} = 0.01\\frac{\\sqrt{13}}{2} = 0.005\\sqrt{13}$.\n\nThe eigenvalues are:\n$$\n\\lambda = 0.965 + i\\frac{\\sqrt{3}}{40} \\pm 0.005\\sqrt{13}\n$$\nThe two eigenvalues are:\n$$\n\\lambda_1 = (0.965 + 0.005\\sqrt{13}) + i\\frac{\\sqrt{3}}{40}\n$$\n$$\n\\lambda_2 = (0.965 - 0.005\\sqrt{13}) + i\\frac{\\sqrt{3}}{40}\n$$\n\n### Step 5: Calculation of the Spectral Radius\nThe spectral radius is the maximum of the moduli of the eigenvalues.\n$|\\lambda_1|^2 = (\\text{Re}(\\lambda_1))^2 + (\\text{Im}(\\lambda_1))^2 = (0.965 + 0.005\\sqrt{13})^2 + (\\frac{\\sqrt{3}}{40})^2$\n$|\\lambda_2|^2 = (\\text{Re}(\\lambda_2))^2 + (\\text{Im}(\\lambda_2))^2 = (0.965 - 0.005\\sqrt{13})^2 + (\\frac{\\sqrt{3}}{40})^2$\nSince $0.965 > 0.005\\sqrt{13}$ (as $0.965^2=0.931225$ and $(0.005\\sqrt{13})^2 = 0.000325$), both real parts are positive. As $\\text{Re}(\\lambda_1) > \\text{Re}(\\lambda_2)$, it follows that $|\\lambda_1| > |\\lambda_2|$. The amplification factor is therefore $|\\lambda_1|$.\n\nLet's calculate $|\\lambda_1|^2$:\n$|\\lambda_1|^2 = (0.965 + 0.005\\sqrt{13})^2 + (\\frac{\\sqrt{3}}{40})^2$\n$= 0.965^2 + 2(0.965)(0.005\\sqrt{13}) + (0.005\\sqrt{13})^2 + \\frac{3}{1600}$\n$= 0.931225 + 0.00965\\sqrt{13} + 0.000325 + 0.001875$\n$= 0.933425 + 0.00965\\sqrt{13}$\n\nUsing numerical values $\\sqrt{13} \\approx 3.605551$:\n$|\\lambda_1|^2 \\approx 0.933425 + 0.00965 \\times 3.605551 \\approx 0.933425 + 0.03479357 = 0.96821857$\nThe amplification factor is the square root:\n$\\rho(\\Phi) = |\\lambda_1| = \\sqrt{0.96821857} \\approx 0.98398098$\n\nRounding to four significant figures, the result is $0.9840$.",
            "answer": "$$\\boxed{0.9840}$$"
        },
        {
            "introduction": "Stiffness, arising from phenomena with vastly different time scales like rapid polymer relaxation, is a major challenge in simulating complex fluids. This exercise investigates the stability of implicit methods when faced with stiff terms, using the advection-diffusion-relaxation equation as a model . You will analyze why the popular Crank–Nicolson scheme, despite being unconditionally stable, can permit unphysical oscillations and how the more general $\\theta$-method can provide the necessary high-frequency damping, illustrating the vital distinction between A-stability and L-stability.",
            "id": "4097324",
            "problem": "Consider a one-dimensional periodic domain with uniform grid spacing $h$ and grid points indexed by $j \\in \\mathbb{Z}$. A single mode of a complex fluid’s polymeric stress component is modeled, after linearization, by the scalar advection–diffusion–relaxation law\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2} - \\alpha u,\n$$\nwhere $c$ is a constant advection speed, $\\nu \\ge 0$ is an effective diffusivity, and $\\alpha > 0$ is a relaxation rate representing stiff complex fluid physics (e.g., rapid elastic relaxation). Space is discretized by centered differences on the uniform grid:\n$$\nD_0 u_j := \\frac{u_{j+1} - u_{j-1}}{2h}, \\qquad D_2 u_j := \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2},\n$$\nand time is discretized first by the Crank–Nicolson method with time step $\\Delta t$, yielding the semi-implicit scheme for the semi-discrete operator $L := -c D_0 + \\nu D_2 - \\alpha I$:\n$$\n\\frac{u^{n+1} - u^n}{\\Delta t} = \\frac{1}{2} \\left( L u^{n+1} + L u^n \\right).\n$$\nUse a von Neumann (Fourier) stability analysis: assume a mode $u_j^n = \\hat{u}^n e^{i \\kappa j h}$, where $\\kappa$ is the wavenumber, and derive the corresponding Crank–Nicolson amplification factor $G_{\\mathrm{CN}}(\\kappa)$ for one time step. Starting from the governing law and the centered-difference symbols, show explicitly how the discrete spatial operator acting on a Fourier mode yields a discrete eigenvalue $\\lambda(\\kappa)$, and then derive $G_{\\mathrm{CN}}(\\kappa)$ from the Crank–Nicolson update. Analyze $|G_{\\mathrm{CN}}(\\kappa)|$ for:\n- purely advective contributions, where $\\lambda(\\kappa)$ is purely imaginary;\n- stiff relaxation contributions, where $\\lambda(\\kappa)$ is large and negative real;\n- high wavenumber modes $\\kappa h$ near $\\pi$ (grid-scale content).\n\nExplain why the non-dissipative nature of Crank–Nicolson can permit parasitic oscillations in the presence of stiff complex fluid terms and high wavenumbers.\n\nNext, consider the $\\theta$-method time discretization applied to the same semi-discrete operator $L$,\n$$\n\\frac{u^{n+1} - u^n}{\\Delta t} = \\theta \\, L u^{n+1} + (1 - \\theta) \\, L u^n, \\quad \\theta \\in \\left[\\frac{1}{2}, 1\\right],\n$$\nwhich introduces implicit numerical damping for $\\theta > \\tfrac{1}{2}$. Derive the amplification factor $G_{\\theta}(\\kappa)$ and determine conditions on $\\theta$ under which $|G_{\\theta}(\\kappa)| < 1$ for high wavenumbers, even when $\\alpha \\Delta t \\gg 1$ (stiff relaxation) or when the advective Courant–Friedrichs–Lewy (CFL) number $c \\Delta t / h$ is large. Based on these derivations, address the claim that adding a small implicit damping can ensure $|G(\\kappa)| < 1$ for high wavenumbers.\n\nSelect all correct statements:\n\nA. Crank–Nicolson is $A$-stable but not $L$-stable; for eigenvalues with large negative real part due to stiff relaxation, its amplification factor satisfies $|G_{\\mathrm{CN}}| \\to 1$, which can lead to parasitic time oscillations.\n\nB. For the $\\theta$-method with $\\theta > \\tfrac{1}{2}$ applied implicitly to the stiff linear part, one has $|G_{\\theta}| \\to (1 - \\theta)/\\theta < 1$ as $|\\lambda(\\kappa)| \\to \\infty$ (both for purely imaginary and large negative real $\\lambda$), ensuring damping of high-wavenumber content.\n\nC. Adding a small implicit diffusion term $\\varepsilon D_2$ with $\\varepsilon > 0$ while keeping $\\theta = \\tfrac{1}{2}$ necessarily guarantees $|G(\\kappa)| < 1$ for all wavenumbers and any time step $\\Delta t$.\n\nD. Setting $\\theta = 1$ (backward Euler) yields $|G_{\\theta}| < 1$ for all eigenvalues and fully suppresses parasitic oscillations, at the expense of reducing the temporal order of accuracy to one.\n\nE. Choosing $\\theta = \\tfrac{1}{2} + \\delta$ with any $\\delta > 0$ retains second-order accuracy in time while introducing high-wavenumber damping via $|G_{\\theta}(\\kappa)| < 1$.",
            "solution": "The user wants a detailed validation and solution for a numerical analysis problem concerning the stability of time-integration schemes for a linearized model of complex fluid stress.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n1.  **Governing Law:** A one-dimensional advection–diffusion–relaxation partial differential equation (PDE):\n    $$\n    \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2} - \\alpha u\n    $$\n2.  **Constants:**\n    -   $c$: constant advection speed.\n    -   $\\nu \\ge 0$: effective diffusivity.\n    -   $\\alpha > 0$: relaxation rate, representing stiff physics.\n3.  **Domain:** One-dimensional periodic domain with uniform grid spacing $h$ and points $j \\in \\mathbb{Z}$.\n4.  **Spatial Discretization:** Centered finite differences.\n    -   First derivative: $D_0 u_j := \\frac{u_{j+1} - u_{j-1}}{2h}$\n    -   Second derivative: $D_2 u_j := \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}$\n5.  **Semi-Discrete Operator:** $L := -c D_0 + \\nu D_2 - \\alpha I$.\n6.  **Time Discretization Scheme 1 (Crank-Nicolson):**\n    $$\n    \\frac{u^{n+1} - u^n}{\\Delta t} = \\frac{1}{2} \\left( L u^{n+1} + L u^n \\right)\n    $$\n7.  **Time Discretization Scheme 2 ($\\theta$-method):**\n    $$\n    \\frac{u^{n+1} - u^n}{\\Delta t} = \\theta \\, L u^{n+1} + (1 - \\theta) \\, L u^n, \\quad \\theta \\in \\left[\\frac{1}{2}, 1\\right]\n    $$\n8.  **Analysis Task:** Use von Neumann stability analysis assuming a Fourier mode $u_j^n = \\hat{u}^n e^{i \\kappa j h}$ to derive and analyze the amplification factors $G_{\\mathrm{CN}}(\\kappa)$ and $G_{\\theta}(\\kappa)$. Based on this, evaluate the provided statements.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded:** The problem is based on a standard linear PDE (an advection-diffusion-reaction equation) frequently used in physics and engineering. The numerical methods—centered differences, Crank-Nicolson, and the generalized $\\theta$-method—are canonical techniques in computational science. The von Neumann stability analysis is the standard method for analyzing linear, constant-coefficient schemes on uniform grids. All elements are firmly rooted in established mathematical and computational principles. The problem is scientifically sound.\n-   **Well-Posed:** The tasks are clearly defined: derive the symbol of the discrete operator, derive the amplification factors, and analyze their properties in specific limits. These are standard, solvable procedures in numerical analysis. The setup is self-contained and consistent.\n-   **Objective:** The problem is stated in precise, unambiguous mathematical language. There are no subjective or opinion-based elements.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. It is a standard, well-posed problem in the field of numerical analysis for partial differential equations. The solution process can proceed.\n\n### Derivation and Analysis\n\n**1. Symbol of the Semi-Discrete Operator $L$**\n\nTo perform a von Neumann analysis, we analyze the action of the discrete spatial operator $L$ on a single Fourier mode $u_j = e^{i \\kappa j h}$, where $\\kappa$ is the wavenumber and $i = \\sqrt{-1}$. The operator $L$ acts as a multiplication by a complex number $\\lambda(\\kappa)$, which is the symbol or discrete eigenvalue of the operator.\nLet $\\phi = \\kappa h$ be the dimensionless wavenumber.\n\nThe symbol of the centered difference operator for the first derivative, $D_0$, is:\n$$\nD_0 e^{i \\kappa j h} = \\frac{e^{i \\kappa (j+1) h} - e^{i \\kappa (j-1) h}}{2h} = \\frac{e^{i\\phi} - e^{-i\\phi}}{2h} e^{i \\kappa j h} = \\frac{2i\\sin(\\phi)}{2h} e^{i \\kappa j h} = \\frac{i\\sin(\\phi)}{h} e^{i \\kappa j h}\n$$\nSo the symbol is $\\hat{D}_0(\\phi) = \\frac{i\\sin(\\phi)}{h}$.\n\nThe symbol of the centered difference operator for the second derivative, $D_2$, is:\n$$\nD_2 e^{i \\kappa j h} = \\frac{e^{i \\kappa (j+1) h} - 2e^{i \\kappa j h} + e^{i \\kappa (j-1) h}}{h^2} = \\frac{e^{i\\phi} - 2 + e^{-i\\phi}}{h^2} e^{i \\kappa j h} = \\frac{2\\cos(\\phi) - 2}{h^2} e^{i \\kappa j h}\n$$\nUsing the identity $1 - \\cos(\\phi) = 2\\sin^2(\\phi/2)$, this becomes:\n$$\nD_2 e^{i \\kappa j h} = \\frac{-4\\sin^2(\\phi/2)}{h^2} e^{i \\kappa j h}\n$$\nSo the symbol is $\\hat{D}_2(\\phi) = -\\frac{4\\sin^2(\\phi/2)}{h^2}$.\n\nThe symbol of the identity operator $I$ is $1$.\nThe symbol $\\lambda(\\kappa)$ of the full operator $L = -c D_0 + \\nu D_2 - \\alpha I$ is therefore:\n$$\n\\lambda(\\kappa) = -c \\left( \\frac{i\\sin(\\kappa h)}{h} \\right) + \\nu \\left( -\\frac{4\\sin^2(\\kappa h/2)}{h^2} \\right) - \\alpha (1)\n$$\n$$\n\\lambda(\\kappa) = -\\left( \\alpha + \\frac{4\\nu}{h^2}\\sin^2(\\frac{\\kappa h}{2}) \\right) - i \\frac{c}{h}\\sin(\\kappa h)\n$$\nThe real part of $\\lambda(\\kappa)$ is $\\text{Re}(\\lambda) = -(\\alpha + \\frac{4\\nu}{h^2}\\sin^2(\\frac{\\kappa h}{2}))$. Since $\\alpha > 0$ and $\\nu \\ge 0$, we have $\\text{Re}(\\lambda) \\le -\\alpha < 0$ for all $\\kappa$. The discrete spectrum of the operator $L$ lies strictly in the left half of the complex plane.\n\n**2. Amplification Factor for the $\\theta$-method**\nThe semi-discrete equation is $\\frac{du}{dt} = Lu$. Applying the $\\theta$-method gives:\n$$\n\\frac{u^{n+1} - u^n}{\\Delta t} = \\theta L u^{n+1} + (1-\\theta) L u^n\n$$\nSubstituting $u^n_j = G^n \\hat{u}_0 e^{i\\kappa j h}$ and using $Lu^n = \\lambda(\\kappa)u^n$, we get:\n$$\n\\frac{G - 1}{\\Delta t} \\hat{u}^n = \\theta \\lambda(\\kappa) G \\hat{u}^n + (1-\\theta) \\lambda(\\kappa) \\hat{u}^n\n$$\nDividing by $\\hat{u}^n$ and letting $z = \\lambda(\\kappa)\\Delta t$:\n$$\nG - 1 = \\theta z G + (1-\\theta)z \\implies G(1 - \\theta z) = 1 + (1-\\theta)z\n$$\nThus, the amplification factor for the $\\theta$-method is:\n$$\nG_{\\theta}(z) = \\frac{1 + (1-\\theta)z}{1 - \\theta z}\n$$\n\n**3. Analysis of Crank-Nicolson ($\\theta = 1/2$)**\nFor the Crank-Nicolson method, $\\theta = 1/2$, and the amplification factor is:\n$$\nG_{\\mathrm{CN}}(z) = \\frac{1 + z/2}{1 - z/2}\n$$\nA scheme is stable if $|G| \\le 1$. For $G_{\\mathrm{CN}}$, this condition is equivalent to $\\text{Re}(z) \\le 0$. Since we found $\\text{Re}(\\lambda(\\kappa)) < 0$, we have $\\text{Re}(z) = \\text{Re}(\\lambda(\\kappa))\\Delta t < 0$ for all $\\kappa$ and $\\Delta t>0$. Thus, Crank-Nicolson is unconditionally stable for this problem. This property is known as A-stability.\n\nHowever, consider the behavior for stiff components, where $|z|$ is large. This occurs for stiff relaxation ($\\alpha\\Delta t \\gg 1$), stiff diffusion ($\\nu\\Delta t/h^2 \\gg 1$), or high wavenumbers ($\\kappa h \\approx \\pi$). In the limit where the real part of $z$ becomes large and negative, $\\text{Re}(z) \\to -\\infty$:\n$$\n\\lim_{\\text{Re}(z) \\to -\\infty} G_{\\mathrm{CN}}(z) = \\lim_{\\text{Re}(z) \\to -\\infty} \\frac{1 + z/2}{1 - z/2} = \\lim_{\\text{Re}(z) \\to -\\infty} \\frac{z/2}{-z/2} = -1\n$$\nSo, $\\lim_{\\text{Re}(z) \\to -\\infty} |G_{\\mathrm{CN}}(z)| = 1$. The scheme does not damp stiff components. Instead, it flips their sign at each time step ($u^{n+1} \\approx -u^n$), leading to persistent, high-frequency parasitic oscillations. This failure to damp at infinity means that Crank-Nicolson is A-stable but not L-stable. L-stability requires that $\\lim_{|z|\\to\\infty, \\text{Re}(z)<0} |G(z)| = 0$.\n\nFor purely advective contributions, if we set $\\nu=0$ and $\\alpha=0$, then $z$ is purely imaginary. For any purely imaginary $z=iy$, $|G_{\\mathrm{CN}}(iy)| = |(1+iy/2)/(1-iy/2)| = 1$. The scheme is non-dissipative for pure advection.\n\n**4. Analysis of the general $\\theta$-method ($\\theta \\in (1/2, 1]$)**\nFor $\\theta > 1/2$, the scheme is also A-stable. We examine its behavior for stiff components by taking the same limit:\n$$\n\\lim_{|z| \\to \\infty, \\text{Re}(z) < 0} G_{\\theta}(z) = \\lim_{|z| \\to \\infty} \\frac{1 + (1-\\theta)z}{1 - \\theta z} = \\lim_{|z| \\to \\infty} \\frac{(1-\\theta)z}{-\\theta z} = -\\frac{1-\\theta}{\\theta} = \\frac{\\theta-1}{\\theta}\n$$\nLet's analyze the magnitude of this limit:\n$$\n\\left| \\frac{\\theta-1}{\\theta} \\right| = \\frac{1-\\theta}{\\theta} \\quad (\\text{since } \\theta \\le 1)\n$$\nFor $\\theta \\in (1/2, 1]$, we have $1-\\theta < \\theta$, so $\\frac{1-\\theta}{\\theta} < 1$. This means that for any $\\theta > 1/2$, the scheme damps stiff components, in contrast to Crank-Nicolson. The magnitude of the damping increases as $\\theta$ increases. For $\\theta=1$ (Backward Euler), the limit is $0$, which corresponds to L-stability. For $\\theta \\in (1/2, 1)$, the scheme is not strictly L-stable but provides damping at infinity, which is often sufficient to control stiffness-induced oscillations.\n\n### Option-by-Option Analysis\n\n**A. Crank–Nicolson is $A$-stable but not $L$-stable; for eigenvalues with large negative real part due to stiff relaxation, its amplification factor satisfies $|G_{\\mathrm{CN}}| \\to 1$, which can lead to parasitic time oscillations.**\n- Our analysis shows Crank-Nicolson is A-stable because $|G_{\\mathrm{CN}}| \\le 1$ for all eigenvalues $\\lambda$ with $\\text{Re}(\\lambda) \\le 0$.\n- Our analysis shows it is not L-stable because $\\lim_{|z|\\to\\infty, \\text{Re}(z)<0} |G_{\\mathrm{CN}}(z)| = 1 \\ne 0$.\n- Eigenvalues with a large negative real part correspond to stiff relaxation ($\\alpha \\gg 1$) or high-wavenumber diffusion. For such eigenvalues, $z=\\lambda\\Delta t$ has a large negative real part, and $|G_{\\mathrm{CN}}| \\to 1$. A value of $G \\approx -1$ results in $u^{n+1} \\approx -u^n$, which is a parasitic oscillation in time.\n- **Verdict:** Correct.\n\n**B. For the $\\theta$-method with $\\theta > \\tfrac{1}{2}$ applied implicitly to the stiff linear part, one has $|G_{\\theta}| \\to (1 - \\theta)/\\theta < 1$ as $|\\lambda(\\kappa)| \\to \\infty$ (both for purely imaginary and large negative real $\\lambda$), ensuring damping of high-wavenumber content.**\n- Our derivation for the $\\theta$-method with $\\theta > 1/2$ confirms that as $|z| = |\\lambda(\\kappa)\\Delta t| \\to \\infty$ in the left-half complex plane, the magnitude of the amplification factor approaches $|G_{\\theta}| \\to \\frac{1-\\theta}{\\theta}$.\n- As $\\theta > 1/2$, it follows that $1 < 2\\theta$, so $1-\\theta < \\theta$, which makes $\\frac{1-\\theta}{\\theta} < 1$.\n- The limit holds for any path to infinity in the left-half plane, including along the imaginary axis (purely imaginary $\\lambda$, if they existed) and the negative real axis (large negative real $\\lambda$).\n- This property ensures that modes for which $|\\lambda(\\kappa)|$ is very large (such as high-wavenumber modes where the dissipative terms dominate) are numerically damped, preventing parasitic oscillations.\n- **Verdict:** Correct.\n\n**C. Adding a small implicit diffusion term $\\varepsilon D_2$ with $\\varepsilon > 0$ while keeping $\\theta = \\tfrac{1}{2}$ necessarily guarantees $|G(\\kappa)| < 1$ for all wavenumbers and any time step $\\Delta t$.**\n- For Crank-Nicolson ($\\theta=1/2$), the stability condition is $|G| \\le 1$, with $|G|=1$ if and only if $\\text{Re}(z)=0$.\n- In the original problem, $z = \\lambda(\\kappa)\\Delta t$, and $\\text{Re}(z) = -\\Delta t(\\alpha + \\frac{4\\nu}{h^2}\\sin^2(\\frac{\\kappa h}{2}))$. Since the problem states $\\alpha > 0$, we have $\\text{Re}(z) \\le -\\alpha\\Delta t < 0$. Therefore, strict inequality $|G(\\kappa)| < 1$ already holds for all $\\kappa$ and $\\Delta t>0$.\n- Adding a term $\\varepsilon D_2$ with $\\varepsilon>0$ makes the real part of the eigenvalue even more negative. It does not change the fact that the inequality was already strict.\n- Most importantly, this does not solve the fundamental problem of Crank-Nicolson: its lack of L-stability. For stiff modes, $|G|$ will still approach $1$, just from a value that is slightly more less than $1$ to begin with. This approach fails to address the core issue of parasitic oscillations.\n- **Verdict:** Incorrect.\n\n**D. Setting $\\theta = 1$ (backward Euler) yields $|G_{\\theta}| < 1$ for all eigenvalues and fully suppresses parasitic oscillations, at the expense of reducing the temporal order of accuracy to one.**\n- For $\\theta=1$, $G_1(z) = \\frac{1}{1-z}$. Since $\\text{Re}(z) < 0$, we have $|1-z| > 1$, which implies $|G_1(z)| < 1$ for all eigenvalues.\n- In the stiff limit, $\\lim_{|z|\\to\\infty, \\text{Re}(z)<0} |G_1(z)| = 0$. This is the definition of L-stability. It strongly damps stiff components, fully suppressing parasitic oscillations from stiffness.\n- The temporal accuracy of the $\\theta$-method is generally first-order, $O(\\Delta t)$, unless $\\theta=1/2$, where it becomes second-order, $O(\\Delta t^2)$. Setting $\\theta=1$ reduces the accuracy to first order.\n- **Verdict:** Correct.\n\n**E. Choosing $\\theta = \\tfrac{1}{2} + \\delta$ with any $\\delta > 0$ retains second-order accuracy in time while introducing high-wavenumber damping via $|G_{\\theta}(\\kappa)| < 1$.**\n- The local truncation error of the $\\theta$-method is proportional to $(\\frac{1}{2} - \\theta)\\Delta t$. For the scheme to be second-order accurate in time, this leading error term must vanish, which requires $\\theta=1/2$.\n- If we choose $\\theta = 1/2 + \\delta$ with $\\delta > 0$, then $\\theta \\ne 1/2$, and the method becomes first-order accurate in time. The statement that it \"retains second-order accuracy\" is false.\n- While it is true that this choice introduces high-wavenumber damping (as established in the analysis of option B), the entire statement is invalidated by the false claim about accuracy.\n- **Verdict:** Incorrect.",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}