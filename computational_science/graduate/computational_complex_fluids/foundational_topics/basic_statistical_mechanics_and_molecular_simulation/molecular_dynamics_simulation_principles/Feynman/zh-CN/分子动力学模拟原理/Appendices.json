{
    "hands_on_practices": [
        {
            "introduction": "在分子动力学模拟中，尤其是在周期性边界条件下，保持系统的总动量为零是一个基本要求。由于数值积分误差或恒温器伪影的累积，系统质心可能会产生非物理性的漂移，这被称为“飞冰块”效应的简化形式。本练习  将指导您推导并应用一种标准校正技术——移除质心运动，以确保模拟在物理上保持静止，这对于准确计算输运性质和维持系综统计至关重要。",
            "id": "4096096",
            "problem": "对一个复杂流体在具有周期性边界条件（PBC）的立方域中进行分子动力学（MD）模拟。在经过一个速度-Verlet时间步后，微小的数值误差或恒温器伪影可能会引起质心（COM）的均匀漂移，导致总动量不为零。为了在保持内禀动力学的同时防止模拟单元的伪平移，你必须在每个时间步结束时对每个粒子施加相同的速度修正，以移除质心运动，从而使总动量变为零，且不改变任何粒子对的相对速度。\n\n从牛顿定律、动量的定义以及周期性边界条件下的平移不变性要求出发，推导对所有粒子施加的均匀速度修正的表达式，以在给定的时间步后精确地使总动量为零。解释为什么这个修正不改变任何粒子间的相对运动。然后，对于从流体中提取的一个特定的三粒子子系统，计算粒子 $2$ 的修正后速度。\n\n该子系统有三个粒子，质量分别为 $m_1=3.0\\times 10^{-26}\\,\\mathrm{kg}$，$m_2=6.0\\times 10^{-26}\\,\\mathrm{kg}$ 和 $m_3=9.0\\times 10^{-26}\\,\\mathrm{kg}$。在时间步之后，它们的速度分别为\n$$\n\\mathbf{v}_1=\\left(150,\\,-200,\\,50\\right)\\,\\mathrm{m/s},\\quad\n\\mathbf{v}_2=\\left(300,\\,100,\\,-100\\right)\\,\\mathrm{m/s},\\quad\n\\mathbf{v}_3=\\left(-250,\\,50,\\,200\\right)\\,\\mathrm{m/s}.\n$$\n假设没有外力作用于该系统，并且PBC仅通过环绕（wrapping）影响位置，而不影响瞬时速度。使用你推导的表达式，计算移除质心运动后粒子 $2$ 的修正后速度 $\\mathbf{v}_2'$。用 $\\mathrm{m/s}$ 单位表示你的最终数值答案。如果需要四舍五入，保留四位有效数字；否则提供精确值。",
            "solution": "该问题要求推导一个用于消除分子动力学模拟中粒子系统总动量的均匀速度修正，解释为什么该修正能保持相对运动不变，并将此修正应用于一个特定的三粒子子系统。\n\n**第一部分：速度修正的推导**\n\n设系统由 $N$ 个粒子组成，在给定的时间步后，第 $i$ 个粒子的质量为 $m_i$，速度为 $\\mathbf{v}_i$。系统的总动量 $\\mathbf{P}_{\\text{total}}$ 是各个粒子动量的矢量和：\n$$\n\\mathbf{P}_{\\text{total}} = \\sum_{i=1}^{N} \\mathbf{p}_i = \\sum_{i=1}^{N} m_i \\mathbf{v}_i\n$$\n问题陈述，由于数值伪影，$\\mathbf{P}_{\\text{total}}$ 可能不为零。为了修正这一点，对每个粒子施加一个均匀的速度修正 $\\Delta\\mathbf{v}$。第 $i$ 个粒子的新速度 $\\mathbf{v}_i'$ 由下式给出：\n$$\n\\mathbf{v}_i' = \\mathbf{v}_i + \\Delta\\mathbf{v}\n$$\n目标是选择 $\\Delta\\mathbf{v}$，使得新的总动量 $\\mathbf{P}_{\\text{total}}'$ 变为零。\n$$\n\\mathbf{P}_{\\text{total}}' = \\sum_{i=1}^{N} m_i \\mathbf{v}_i' = \\mathbf{0}\n$$\n将 $\\mathbf{v}_i'$ 的表达式代入此方程：\n$$\n\\sum_{i=1}^{N} m_i (\\mathbf{v}_i + \\Delta\\mathbf{v}) = \\mathbf{0}\n$$\n我们可以分配质量 $m_i$ 并将求和式分开：\n$$\n\\sum_{i=1}^{N} m_i \\mathbf{v}_i + \\sum_{i=1}^{N} m_i \\Delta\\mathbf{v} = \\mathbf{0}\n$$\n第一项是原始的总动量 $\\mathbf{P}_{\\text{total}}$。在第二项中，$\\Delta\\mathbf{v}$ 是一个常数矢量，可以从求和中提取出来：\n$$\n\\mathbf{P}_{\\text{total}} + \\left(\\sum_{i=1}^{N} m_i\\right) \\Delta\\mathbf{v} = \\mathbf{0}\n$$\n设 $M_{\\text{total}} = \\sum_{i=1}^{N} m_i$ 为系统的总质量。方程变为：\n$$\n\\mathbf{P}_{\\text{total}} + M_{\\text{total}} \\Delta\\mathbf{v} = \\mathbf{0}\n$$\n求解速度修正 $\\Delta\\mathbf{v}$：\n$$\nM_{\\text{total}} \\Delta\\mathbf{v} = -\\mathbf{P}_{\\text{total}}\n$$\n$$\n\\Delta\\mathbf{v} = -\\frac{\\mathbf{P}_{\\text{total}}}{M_{\\text{total}}}\n$$\n系统的质心（COM）速度定义为 $\\mathbf{v}_{\\text{COM}} = \\frac{\\sum m_i \\mathbf{v}_i}{\\sum m_i} = \\frac{\\mathbf{P}_{\\text{total}}}{M_{\\text{total}}}$。因此，所需的速度修正即为质心速度的负值：\n$$\n\\Delta\\mathbf{v} = -\\mathbf{v}_{\\text{COM}}\n$$\n这个修正有效地将粒子速度转换到一个质心静止的参考系中，从而使总动量为零。周期性边界条件下的平移不变性前提意味着系统的物理性质应独立于整个系统的均匀平移速度，而这个过程正是移除了该速度。\n\n**第二部分：相对运动的不变性**\n\n任意两个粒子（例如粒子 $i$ 和粒子 $j$）之间的相对速度定义为 $\\mathbf{v}_{ij} = \\mathbf{v}_i - \\mathbf{v}_j$。施加修正后，新的相对速度 $\\mathbf{v}_{ij}'$ 为：\n$$\n\\mathbf{v}_{ij}' = \\mathbf{v}_i' - \\mathbf{v}_j'\n$$\n代入修正后速度的表达式：\n$$\n\\mathbf{v}_{ij}' = (\\mathbf{v}_i + \\Delta\\mathbf{v}) - (\\mathbf{v}_j + \\Delta\\mathbf{v})\n$$\n$$\n\\mathbf{v}_{ij}' = \\mathbf{v}_i + \\Delta\\mathbf{v} - \\mathbf{v}_j - \\Delta\\mathbf{v}\n$$\n均匀修正项 $\\Delta\\mathbf{v}$ 被消去：\n$$\n\\mathbf{v}_{ij}' = \\mathbf{v}_i - \\mathbf{v}_j = \\mathbf{v}_{ij}\n$$\n因此，任意粒子对之间的相对速度不受均匀速度修正的影响。由于系统中的内力（例如，来自对势）取决于粒子的相对位置和速度，因此内禀动力学、粒子间碰撞以及流体的结构演化均不受影响。该修正仅移除了整个系统作为一个刚体的非物理性、均匀平移。\n\n**第三部分：数值计算**\n\n我们将推导出的表达式应用于给定的三粒子子系统。质量和速度如下：\n$m_1=3.0\\times 10^{-26}\\,\\mathrm{kg}$, $m_2=6.0\\times 10^{-26}\\,\\mathrm{kg}$, $m_3=9.0\\times 10^{-26}\\,\\mathrm{kg}$。\n$\\mathbf{v}_1=\\begin{pmatrix} 150  -200  50 \\end{pmatrix}\\,\\mathrm{m/s}$\n$\\mathbf{v}_2=\\begin{pmatrix} 300  100  -100 \\end{pmatrix}\\,\\mathrm{m/s}$\n$\\mathbf{v}_3=\\begin{pmatrix} -250  50  200 \\end{pmatrix}\\,\\mathrm{m/s}$\n\n首先，我们计算总质量 $M_{\\text{total}}$：\n$$\nM_{\\text{total}} = m_1 + m_2 + m_3 = (3.0 + 6.0 + 9.0) \\times 10^{-26}\\,\\mathrm{kg} = 18.0 \\times 10^{-26}\\,\\mathrm{kg}\n$$\n接下来，我们计算总动量 $\\mathbf{P}_{\\text{total}} = m_1\\mathbf{v}_1 + m_2\\mathbf{v}_2 + m_3\\mathbf{v}_3$。\n我们来计算动量的每个分量，用下标 $x, y, z$ 表示。\n$$\nP_{\\text{total},x} = m_1 v_{1,x} + m_2 v_{2,x} + m_3 v_{3,x} \\\\\n= (3.0 \\times 10^{-26})(150) + (6.0 \\times 10^{-26})(300) + (9.0 \\times 10^{-26})(-250) \\\\\n= (450 + 1800 - 2250) \\times 10^{-26} = 0\\,\\mathrm{kg\\cdot m/s}\n$$\n$$\nP_{\\text{total},y} = m_1 v_{1,y} + m_2 v_{2,y} + m_3 v_{3,y} \\\\\n= (3.0 \\times 10^{-26})(-200) + (6.0 \\times 10^{-26})(100) + (9.0 \\times 10^{-26})(50) \\\\\n= (-600 + 600 + 450) \\times 10^{-26} = 450 \\times 10^{-26}\\,\\mathrm{kg\\cdot m/s}\n$$\n$$\nP_{\\text{total},z} = m_1 v_{1,z} + m_2 v_{2,z} + m_3 v_{3,z} \\\\\n= (3.0 \\times 10^{-26})(50) + (6.0 \\times 10^{-26})(-100) + (9.0 \\times 10^{-26})(200) \\\\\n= (150 - 600 + 1800) \\times 10^{-26} = 1350 \\times 10^{-26}\\,\\mathrm{kg\\cdot m/s}\n$$\n所以，总动量矢量为 $\\mathbf{P}_{\\text{total}} = \\begin{pmatrix} 0  450  1350 \\end{pmatrix} \\times 10^{-26}\\,\\mathrm{kg\\cdot m/s}$。\n\n现在，我们计算速度修正 $\\Delta\\mathbf{v}$：\n$$\n\\Delta\\mathbf{v} = -\\frac{\\mathbf{P}_{\\text{total}}}{M_{\\text{total}}} = -\\frac{\\begin{pmatrix} 0  450  1350 \\end{pmatrix} \\times 10^{-26}}{18.0 \\times 10^{-26}}\n$$\n因子 $10^{-26}$ 消掉了。\n$$\n\\Delta\\mathbf{v} = -\\frac{1}{18.0} \\begin{pmatrix} 0  450  1350 \\end{pmatrix} = -\\begin{pmatrix} \\frac{0}{18.0}  \\frac{450}{18.0}  \\frac{1350}{18.0} \\end{pmatrix}\n$$\n$$\n\\Delta\\mathbf{v} = -\\begin{pmatrix} 0  25  75 \\end{pmatrix} = \\begin{pmatrix} 0  -25  -75 \\end{pmatrix}\\,\\mathrm{m/s}\n$$\n最后，我们计算粒子 $2$ 的修正后速度 $\\mathbf{v}_2'$：\n$$\n\\mathbf{v}_2' = \\mathbf{v}_2 + \\Delta\\mathbf{v}\n$$\n$$\n\\mathbf{v}_2' = \\begin{pmatrix} 300  100  -100 \\end{pmatrix} + \\begin{pmatrix} 0  -25  -75 \\end{pmatrix}\n$$\n$$\n\\mathbf{v}_2' = \\begin{pmatrix} 300+0  100-25  -100-75 \\end{pmatrix}\n$$\n$$\n\\mathbf{v}_2' = \\begin{pmatrix} 300  75  -175 \\end{pmatrix}\\,\\mathrm{m/s}\n$$\n所有计算均得到精确的整数值，因此无需四舍五入。粒子 $2$ 的修正后速度为 $\\begin{pmatrix} 300  75  -175 \\end{pmatrix}\\,\\mathrm{m/s}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n300  75  -175\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论上，微正则系综（$NVE$）模拟的总能量应该严格守恒，这使其成为检验模拟数值稳定性的黄金标准。然而，在实践中，总能量经常会观察到微小但系统的漂移，这表明模拟方案中存在潜在问题。本练习  模拟了一个真实的诊断场景，要求您像一名侦探一样，从多个可能的“嫌疑犯”（如时间步长、截断方案或约束算法）中找出导致能量不守恒的根本原因，从而培养解决实际模拟问题的关键能力。",
            "id": "2417125",
            "problem": "您进行了一次长时间的微正则 (NVE) 分子动力学 (MD) 模拟，模拟对象是显式水中的全原子蛋白质，力场采用成对相加的 Lennard-Jones (LJ) 和库仑相互作用。积分器是速度 Verlet 算法，时间步长 $\\Delta t = 2\\,\\mathrm{fs}$，并通过约束求解器对连接氢原子的共价键施加刚性约束。非键相互作用使用带有球形截断的实空间截断和 Verlet 邻居列表。您仔细禁用了任何恒温器或恒压器。在 $100\\,\\mathrm{ns}$ 后，报告的总能量 $E_{\\text{tot}}(t) = K(t) + U(t)$ 显示出约 $+0.5\\,\\mathrm{kJ\\,mol^{-1}\\,ns^{-1}}$ 的缓慢但系统的向上漂移。\n\n从第一性原理回顾，对于遵循牛顿第二定律 $m_i\\,\\mathbf{a}_i = \\mathbf{F}_i = -\\nabla_i U(\\mathbf{r}^N)$ 的经典点粒子，以及对于时间无关的势 $U$ 和完全保守的力，连续时间动力学会精确地守恒总能量 $E_{\\text{tot}} = K + U$。在离散化的 MD 中，数值误差、对力的非保守近似或约束不精确都可能引入长期的能量漂移。\n\n在所述条件下，以下哪些是对 $E_{\\text{tot}}$ 系统性向上漂移的合理解释？哪些实用的诊断方法能最直接地确定其来源？选择所有适用项。\n\nA. 积分时间步长 $\\Delta t$ 对于约束了与氢原子相连的化学键后剩余的最快运动来说太大了，因此离散化误差会注入能量。诊断方法：使用减小的 $\\Delta t$（例如，减小到 $\\Delta t = 1\\,\\mathrm{fs}$）重新运行一小段模拟，并比较漂移速率；如果较小的 $\\Delta t$ 导致漂移显著减少，则表明存在时间积分误差。\n\nB. 邻居列表的缓冲区域太小和/或邻居列表在硬实空间截断下的更新频率太低，导致当粒子对进入截断区域时产生不连续的力，从而对系统做虚功。诊断方法：增加邻居列表的“皮层”厚度和更新频率，并检查 $U(t)$ 的时间序列中是否与邻居列表重建相关的小跳跃；跳跃和漂移的减少意味着截断/列表伪影是原因。\n\nC. 在周期性边界中质心 (COM) 平移的累积导致内部模式的“加热”，从而提高了 $E_{\\text{tot}}$。诊断方法：周期性地移除质心速度以消除 $E_{\\text{tot}}$ 的漂移。\n\nD. 约束求解器的容差太宽松或迭代次数太少，导致每一步的约束都未完全满足，从而允许求解器对系统做净正功。诊断方法：将约束容差收紧几个数量级和/或增加最大迭代次数，并监测最大约束违反值和漂移；两者都减少表明漂移是由约束引起的。\n\nE. 有限精度算术（例如，单精度）会使舍入误差的累积产生偏差，导致长期的能量增加。诊断方法：在双精度下完全相同地重新运行并比较漂移；漂移的显著减少表明其与精度有关。",
            "solution": "首先将对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 模拟系综：微正则 (NVE)，粒子数 ($N$)、体积 ($V$) 和总能量 ($E$) 恒定。\n- 体系：显式水中的全原子蛋白质。\n- 力场：成对相加，包含 Lennard-Jones (LJ) 和库仑相互作用。势能 $U$ 与时间无关。\n- 积分器：速度 Verlet。\n- 时间步长：$\\Delta t = 2\\,\\mathrm{fs}$。\n- 约束：所有与氢原子相连的共价键都是刚性的，由约束求解器强制执行。\n- 非键方案：使用球形截断的实空间截断和 Verlet 邻居列表。\n- 恒温器/恒压器：禁用。\n- 模拟时长：$100\\,\\mathrm{ns}$。\n- 观察结果：总能量 $E_{\\text{tot}}(t) = K(t) + U(t)$ 表现出约 $+0.5\\,\\mathrm{kJ\\,mol^{-1}\\,ns^{-1}}$ 的系统性向上漂移。\n- 理论背景：对于从时间无关的势 $U$ 导出的保守力，$m_i\\,\\mathbf{a}_i = \\mathbf{F}_i = -\\nabla_i U(\\mathbf{r}^N)$，总能量 $E_{\\text{tot}}$ 在连续时间内是精确的运动守恒量。离散时间 MD 中的数值伪影可能导致能量漂移。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题描述了分子生物物理学中一个标准的计算实验。\n- **科学依据充分**：该情景是一次典型的全原子分子动力学模拟。NVE系综、速度 Verlet 积分器、用于氢键的约束算法（例如 SHAKE、LINCS）以及带邻居列表的截断非键相互作用都是标准方法。观察到的能量漂移是此类模拟中一个众所周知且至关重要的数值伪影。对于给定参数的模拟，所描述的漂移率是现实的。该问题牢固地植根于应用于分子模拟的经典力学和数值分析原理。\n- **问题定义良好**：问题陈述清晰。它在明确的模拟条件下提供了一个具体的观察结果（能量向上漂移），并要求从给定列表中评估可能的物理和数值原因。基于该领域的既定知识，存在一组确定的正确答案。\n- **客观性**：问题使用计算化学和物理领域通用的精确技术语言进行陈述。它不含主观或模棱两可的术语。\n\n### 步骤3：结论和行动\n问题陈述有效。它科学合理，定义良好且客观。将基于分子动力学的第一性原理分析每个选项来推导解决方案。\n\n### 解决方案推导和选项分析\n\n在 NVE 模拟中，系统的总能量应该是守恒的。系统性漂移（与有界涨落相对）表明理论上保守的动力学在数值实现上存在缺陷。这种缺陷源于破坏积分算法的时间反演对称性和辛性，或引入非保守力的近似。我们将评估每个选项作为这种能量不守恒的潜在来源。\n\n**A. 积分时间步长 $\\Delta t$ 对于约束了与氢原子相连的化学键后剩余的最快运动来说太大了，因此离散化误差会注入能量。诊断方法：使用减小的 $\\Delta t$（例如，减小到 $\\Delta t = 1\\,\\mathrm{fs}$）重新运行一小段模拟，并比较漂移速率；如果较小的 $\\Delta t$ 导致漂移显著减少，则表明存在时间积分误差。**\n\n速度 Verlet 算法是一种二阶数值积分器。每步的局部误差为 $\\mathcal{O}(\\Delta t^3)$ 阶，在固定时间间隔 $T$ 内轨迹的全局误差为 $\\mathcal{O}(\\Delta t^2)$ 阶。虽然该算法对于保守力是辛的，并且应该表现出有界的能量涨落，但如果时间步长太大而无法解析系统中最快的特征运动，就会导致共振伪影。这些共振可能导致能量系统性地转移到高频模式中，这种现象通常被称为数值加热。即使在约束了最快的自由度（氢键振动）之后，蛋白质中其他运动（如键角振动）的周期也可能在 $10-20\\,\\mathrm{fs}$ 的量级。$\\Delta t = 2\\,\\mathrm{fs}$ 的时间步长是比较激进的，对于稳定积分这些模式可能太大了，从而导致离散化误差的累积和总能量的长期向上漂移。所提出的诊断方法是一个标准程序；如果漂移是由于 $\\Delta t$ 的大小引起的，其幅度应该随着时间步长的减小而显著减小，通常与 $\\Delta t$ 的某个幂成比例。\n\n结论：**正确**。\n\n**B. 邻居列表的缓冲区域太小和/或邻居列表在硬实空间截断下的更新频率太低，导致当粒子对进入截断区域时产生不连续的力，从而对系统做虚功。诊断方法：增加邻居列表的“皮层”厚度和更新频率，并检查 $U(t)$ 的时间序列中是否与邻居列表重建相关的小跳跃；跳跃和漂移的减少意味着截断/列表伪影是原因。**\n\n在截断半径 $r_c$ 处对势能进行简单截断，会使势能函数不可微，并且相应的力 $\\mathbf{F} = -\\nabla U$ 在 $r = r_c$ 处不连续。不连续的力是非保守的，在此类力下对粒子运动进行积分不会使能量守恒。为了提高效率，使用了 Verlet 邻居列表，其中只计算半径 $r_{list}  r_c$ 内的粒子对之间的相互作用。该列表在多个时间步内保持不变。如果更新频率太低或“皮层”厚度（$r_{list} - r_c$）太小，一对粒子可能会在邻居列表更新之间穿过截断边界 $r_c$。在穿过后进行下一次力计算时，这对粒子上的力会突然出现或消失，产生一个冲量。这导致势能的不连续和虚功的产生。这些事件很少能平均为零，通常会导致动能的净增加，从而使系统升温。所提出的诊断方法通过使邻居列表管理更加保守（更厚的皮层，更频繁的更新）来直接检验这一假设，这应该能使有效力更平滑并减少能量漂移。\n\n结论：**正确**。\n\n**C. 在周期性边界中质心 (COM) 平移的累积导致内部模式的“加热”，从而提高了 $E_{\\text{tot}}$。诊断方法：周期性地移除质心速度以消除 $E_{\\text{tot}}$ 的漂移。**\n\n在没有外力的模拟中，系统的总动量，因而其质心速度，应该是守恒的。然而，在有限精度算术中对力求和可能导致一个小的净力，从而使质心速度从零开始漂移。总动能 $K$ 是质心动能 $K_{\\text{COM}} = \\frac{1}{2} M_{\\text{tot}} \\mathbf{V}_{\\text{COM}}^2$ 和内动能 $K_{\\text{internal}}$ 的和。$\\mathbf{V}_{\\text{COM}}$ 的增加直接增加了 $K_{\\text{COM}}$，从而增加了 $E_{\\text{tot}} = U + K_{\\text{internal}} + K_{\\text{COM}}$。因此，质心速度漂移是*报告的总能量*上升的一个合理解释。然而，该选项解释说这“导致内部模式的‘加热’”在物理上是不正确的。质心运动在一阶近似下与内部自由度是解耦的。$K_{\\text{COM}}$ 的增加不会将能量转移到内部模式；事实上，在长时间的 NVE 模拟中一个被称为“飞行冰块”效应的已知伪影，涉及能量*从*内部模式转移*到*质心运动，导致分子内部冷却。该物理机制的描述是有缺陷的。其诊断方法，即移除质心速度，对于解决由质心运动引起的 $E_{\\text{tot}}$ 漂移是正确的，但它解决的是 $K_{COM}$ 的上升，而不是虚构的内部模式加热。由于物理推理不正确，该选项作为陈述的解释是无效的。\n\n结论：**不正确**。\n\n**D. 约束求解器的容差太宽松或迭代次数太少，导致每一步的约束都未完全满足，从而允许求解器对系统做净正功。诊断方法：将约束容差收紧几个数量级和/或增加最大迭代次数，并监测最大约束违反值和漂移；两者都减少表明漂移是由约束引起的。**\n\n像 SHAKE 及其速度层面的对应算法 RATTLE（与速度 Verlet 一起使用）这样的约束算法是迭代的。它们通过施加校正冲量来满足几何约束。如果收敛容差太宽松或最大迭代次数不足，约束在时间步结束时将不会被完美满足。施加约束校正的过程可以对系统做功。虽然对于一个完美收敛的求解器，这个功的平均值应该为零，但不精确的解可能会引入系统偏差。满足约束的误差意味着约束力并不完全与粒子速度正交，导致在许多步骤中产生净正功或负功。这是一个众所周知的系统性能量漂移来源。所提出的诊断方法是验证这一点的标准且正确的方法：提高约束求解器的精度应该会减少误差和相关的能量漂移。\n\n结论：**正确**。\n\n**E. 有限精度算术（例如，单精度）会使舍入误差的累积产生偏差，导致长期的能量增加。诊断方法：在双精度下完全相同地重新运行并比较漂移；漂移的显著减少表明其与精度有关。**\n\n分子动力学模拟在每个时间步都涉及大量的浮点运算。虽然双精度算术（64位）是科学计算的标准，并且通常足以使舍入误差保持随机且不累积，但单精度（32位）算术可能会有问题。较低的精度可能导致显著的准确性损失，尤其是在对许多小数（力）求和或对大数（在动能计算中）求差时。这些舍入误差可能不是随机的，并且可能引入系统偏差，实际上就像一个小的、非物理的力，随着时间的推移对系统做功，导致能量漂移。向上漂移是一个非常可能的结果。该诊断方法是决定性的：如果使用双精度算术运行完全相同的模拟显著减少或消除了能量漂移，那么有限精度效应就是主要原因。\n\n结论：**正确**。",
            "answer": "$$\\boxed{ABDE}$$"
        },
        {
            "introduction": "除了确保物理真实性和数值稳定性，计算效率是分子动力学模拟的另一个核心考量。Verlet邻域列表是提高计算效率的关键算法，但其性能高度依赖于“缓冲”或“皮层”距离 $\\delta$ 的选择。本练习  引导您建立一个分析模型，以量化力计算成本与邻域列表重建成本之间的权衡，并推导出能最小化总计算时间的最优皮层距离 $\\delta^{\\star}$。这展示了如何通过理论建模来指导高性能计算实践，是计算科学家必备的一项高级技能。",
            "id": "4096094",
            "problem": "使用分子动力学（MD）模拟一种均匀的复杂流体，该模拟使用截断半径为 $r_c$ 的截断对势，以及蒙皮距离为 $\\delta$ 的 Verlet 邻居列表，因此邻居列表的半径为 $r_{\\ell} = r_c + \\delta$。假设一个大的、均匀的三维系统，其数密度为 $\\rho$，时间步长为常数 $\\Delta t$。每对粒子、每步的力评估壁钟时间为 $t_p$，而每个粒子的邻居列表重建壁钟时间为 $t_b$。在长时间尺度上，粒子位移是扩散性的，扩散系数为 $D$，使得均方位移满足 $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 6 D t$。在实践中，每当自上次重建以来的均方根位移达到 $\\delta/2$ 时，就会重建邻居列表。对于长时间范围下的大型系统，将每个粒子的邻居数量建模为与体积 $V_{\\ell} = \\frac{4\\pi}{3} (r_c + \\delta)^3$ 成正比，并将总计算成本率（单位物理时间内的壁钟时间）建模为 (i) 每步力评估成本率和 (ii) 邻居列表重建成本率之和。\n\n仅从上述物理输入和定义出发，不借助任何其他预制的性能模型，推导在渐近区域 $\\delta \\ll r_c$ 下使总计算成本率最小化的最优蒙皮距离 $\\delta^{\\star}$ 的解析表达式（保留力评估成本中 $\\delta$ 的首个非平凡贡献项）。将最终答案表示为 $D$、$\\rho$、$r_c$、$\\Delta t$、$t_p$ 和 $t_b$ 的封闭形式函数。最终表达式中不要包含单位。无需进行数值计算；仅提供一个解析表达式。",
            "solution": "问题要求推导分子动力学模拟中使总计算成本率 $C$ 最小化的最优蒙皮距离 $\\delta^{\\star}$。总成本率是力评估成本率 $C_f$ 和邻居列表重建成本率 $C_b$ 的和：\n$$\nC(\\delta) = C_f(\\delta) + C_b(\\delta)\n$$\n我们将推导 $C_f$ 和 $C_b$ 作为蒙皮距离 $\\delta$ 及其他给定参数的函数表达式。\n\n首先，我们确定邻居列表重建成本率 $C_b$。每当自上次重建以来粒子的均方根位移（RMSD）等于 $\\delta/2$ 时，邻居列表就会被重建。时间间隔 $t$ 内的均方位移（MSD）由公式 $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 6 D t$ 给出。RMSD 是 MSD 的平方根。设 $T_b$ 为两次连续重建之间的物理时间。重建条件是：\n$$\n\\sqrt{\\langle |\\Delta \\mathbf{r}(T_b)|^2 \\rangle} = \\frac{\\delta}{2}\n$$\n代入给定的 MSD 表达式：\n$$\n\\sqrt{6 D T_b} = \\frac{\\delta}{2}\n$$\n方程两边平方得到 $6 D T_b = \\frac{\\delta^2}{4}$。解出 $T_b$，我们得到两次重建之间的物理时间：\n$$\nT_b = \\frac{\\delta^2}{24 D}\n$$\n对于一个包含 $N$ 个粒子的系统，单次邻居列表重建的壁钟时间是粒子数与每个粒子的重建时间 $t_b$ 的乘积，即 $N t_b$。成本率 $C_b$ 定义为一次重建的壁钟时间除以两次重建之间经过的物理时间：\n$$\nC_b(\\delta) = \\frac{N t_b}{T_b} = \\frac{N t_b}{\\frac{\\delta^2}{24 D}} = \\frac{24 D N t_b}{\\delta^2}\n$$\n接下来，我们确定力评估成本率 $C_f$。这个成本发生在每个持续时间为 $\\Delta t$ 的时间步中。每步的力计算成本与相互作用的粒子对数量成正比。邻居列表半径由 $r_{\\ell} = r_c + \\delta$ 给出。问题陈述，单个粒子的邻居数量 $N_{neigh}$ 与邻居列表球体的体积 $V_{\\ell} = \\frac{4\\pi}{3} r_{\\ell}^3$ 成正比。遵循标准物理模型，我们将邻居数量取为数密度 $\\rho$ 与该体积的乘积：\n$$\nN_{neigh} = \\rho V_{\\ell} = \\rho \\frac{4\\pi}{3} (r_c + \\delta)^3\n$$\n对于一个包含 $N$ 个粒子的系统，相互作用的总对数为 $\\frac{1}{2} N \\cdot N_{neigh}$，其中因子 $\\frac{1}{2}$ 用于校正双重计数。在单个时间步中力评估的壁钟时间 $W_{step}$ 是总对数乘以每对评估时间 $t_p$：\n$$\nW_{step} = \\frac{1}{2} N \\cdot N_{neigh} \\cdot t_p = \\frac{1}{2} N \\left( \\rho \\frac{4\\pi}{3} (r_c + \\delta)^3 \\right) t_p = \\frac{2\\pi N \\rho t_p}{3} (r_c + \\delta)^3\n$$\n力评估成本率 $C_f$ 是每步的壁钟时间除以该步的持续时间 $\\Delta t$：\n$$\nC_f(\\delta) = \\frac{W_{step}}{\\Delta t} = \\frac{2\\pi N \\rho t_p}{3 \\Delta t} (r_c + \\delta)^3\n$$\n问题要求在 $\\delta \\ll r_c$ 的渐近区域进行分析。我们展开 $(r_c + \\delta)^3$ 项，并保留 $\\delta$ 的首个非平凡贡献项。对于小的 $x$，使用二项式近似 $(1+x)^n \\approx 1+nx$：\n$$\n(r_c + \\delta)^3 = r_c^3 \\left(1 + \\frac{\\delta}{r_c}\\right)^3 \\approx r_c^3 \\left(1 + 3\\frac{\\delta}{r_c}\\right) = r_c^3 + 3r_c^2\\delta\n$$\n将此近似代入 $C_f(\\delta)$ 的表达式中：\n$$\nC_f(\\delta) \\approx \\frac{2\\pi N \\rho t_p}{3 \\Delta t} (r_c^3 + 3r_c^2\\delta) = \\frac{2\\pi N \\rho t_p r_c^3}{3 \\Delta t} + \\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} \\delta\n$$\n在此渐近区域中，总计算成本率 $C(\\delta)$ 是近似的 $C_f(\\delta)$ 和 $C_b(\\delta)$ 的和：\n$$\nC(\\delta) \\approx \\left( \\frac{2\\pi N \\rho t_p r_c^3}{3 \\Delta t} + \\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} \\delta \\right) + \\frac{24 D N t_b}{\\delta^2}\n$$\n为了找到使 $C(\\delta)$ 最小化的最优蒙皮距离 $\\delta^{\\star}$，我们计算 $C(\\delta)$ 关于 $\\delta$ 的导数并将其设为零。$C(\\delta)$ 表达式中的第一项是关于 $\\delta$ 的常数。\n$$\n\\frac{dC}{d\\delta} = \\frac{d}{d\\delta} \\left( \\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} \\delta + \\frac{24 D N t_b}{\\delta^2} \\right) = \\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} - 2 \\frac{24 D N t_b}{\\delta^3}\n$$\n将导数设为零以找到极值点 $\\delta^{\\star}$：\n$$\n\\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} - \\frac{48 D N t_b}{(\\delta^{\\star})^3} = 0\n$$\n$$\n\\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} = \\frac{48 D N t_b}{(\\delta^{\\star})^3}\n$$\n解出 $(\\delta^{\\star})^3$：\n$$\n(\\delta^{\\star})^3 = \\frac{48 D N t_b \\Delta t}{2\\pi N \\rho t_p r_c^2} = \\frac{24 D t_b \\Delta t}{\\pi \\rho t_p r_c^2}\n$$\n总粒子数 $N$ 被约去，这对于大型系统中的一个强度参数是符合预期的。取立方根得到最优蒙皮距离：\n$$\n\\delta^{\\star} = \\left( \\frac{24 D t_b \\Delta t}{\\pi \\rho t_p r_c^2} \\right)^{1/3}\n$$\n为了确认这对应于一个最小值，我们检查成本函数的二阶导数，$\\frac{d^2C}{d\\delta^2} = 3 \\cdot \\frac{48 D N t_b}{\\delta^4} = \\frac{144 D N t_b}{\\delta^4}$。由于所有参数（$D$、$N$、$t_b$）均为正，二阶导数为正，这证实了 $\\delta^{\\star}$ 使总成本率最小化。",
            "answer": "$$\n\\boxed{\\left( \\frac{24 D t_b \\Delta t}{\\pi \\rho t_p r_c^2} \\right)^{1/3}}\n$$"
        }
    ]
}