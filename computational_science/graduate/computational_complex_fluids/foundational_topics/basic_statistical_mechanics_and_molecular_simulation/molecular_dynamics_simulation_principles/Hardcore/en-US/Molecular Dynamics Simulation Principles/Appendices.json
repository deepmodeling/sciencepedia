{
    "hands_on_practices": [
        {
            "introduction": "In molecular dynamics, adherence to fundamental conservation laws is a primary indicator of a simulation's physical validity. While energy conservation is often the main focus, the conservation of total linear momentum is equally crucial. This exercise addresses the common issue of center-of-mass (COM) drift, a numerical artifact where the system as a whole acquires a spurious translational velocity. By working through this problem, you will derive the velocity correction needed to nullify this drift, a vital technique for maintaining the integrity of the simulation's reference frame and ensuring that the observed dynamics are purely internal .",
            "id": "4096096",
            "problem": "A molecular dynamics (MD) simulation of a complex fluid is performed in a cubic domain with periodic boundary conditions (PBC). After a velocity-Verlet timestep, small numerical errors or thermostat artifacts can induce a uniform drift of the center-of-mass (COM), resulting in nonzero total momentum. To prevent spurious translation of the simulation cell while preserving internal dynamics, you must remove the COM motion by applying the same velocity correction to every particle at the end of each timestep so that the total momentum becomes zero without altering any pairwise relative velocity.\n\nStarting from Newton’s laws, the definition of momentum, and the requirement of translational invariance under PBC, derive the expression for the uniform velocity correction to be applied to all particles to exactly nullify the total momentum after a given timestep. Explain why this correction does not change any relative motion between particles. Then, for a specific three-particle subsystem extracted from the fluid, compute the corrected velocity of particle $2$.\n\nThe subsystem has three particles with masses $m_1=3.0\\times 10^{-26}\\,\\mathrm{kg}$, $m_2=6.0\\times 10^{-26}\\,\\mathrm{kg}$, and $m_3=9.0\\times 10^{-26}\\,\\mathrm{kg}$. Immediately after the timestep, their velocities are\n$$\n\\mathbf{v}_1=\\left(150,\\,-200,\\,50\\right)\\,\\mathrm{m/s},\\quad\n\\mathbf{v}_2=\\left(300,\\,100,\\,-100\\right)\\,\\mathrm{m/s},\\quad\n\\mathbf{v}_3=\\left(-250,\\,50,\\,200\\right)\\,\\mathrm{m/s}.\n$$\nAssume no external forces act on the system and that PBC only affects the positions through wrapping, not the instantaneous velocities. Using your derived expression, compute the corrected velocity $\\mathbf{v}_2'$ of particle $2$ after COM removal. Express your final numerical answer in $\\mathrm{m/s}$. If any rounding is required, round to four significant figures; otherwise provide exact values.",
            "solution": "The problem asks for the derivation of a uniform velocity correction to nullify the total momentum of a system of particles in a molecular dynamics simulation, an explanation of why this correction preserves relative motion, and the application of this correction to a specific three-particle subsystem.\n\n**Part 1: Derivation of the Velocity Correction**\n\nLet the system consist of $N$ particles, with the $i$-th particle having mass $m_i$ and velocity $\\mathbf{v}_i$ after a given timestep. The total momentum of the system, $\\mathbf{P}_{\\text{total}}$, is the vector sum of the individual momenta:\n$$\n\\mathbf{P}_{\\text{total}} = \\sum_{i=1}^{N} \\mathbf{p}_i = \\sum_{i=1}^{N} m_i \\mathbf{v}_i\n$$\nThe problem states that due to numerical artifacts, $\\mathbf{P}_{\\text{total}}$ may be non-zero. To correct this, a uniform velocity correction, $\\Delta\\mathbf{v}$, is applied to every particle. The new velocity of the $i$-th particle, $\\mathbf{v}_i'$, is given by:\n$$\n\\mathbf{v}_i' = \\mathbf{v}_i + \\Delta\\mathbf{v}\n$$\nThe objective is to choose $\\Delta\\mathbf{v}$ such that the new total momentum, $\\mathbf{P}_{\\text{total}}'$, becomes zero.\n$$\n\\mathbf{P}_{\\text{total}}' = \\sum_{i=1}^{N} m_i \\mathbf{v}_i' = \\mathbf{0}\n$$\nSubstituting the expression for $\\mathbf{v}_i'$ into this equation:\n$$\n\\sum_{i=1}^{N} m_i (\\mathbf{v}_i + \\Delta\\mathbf{v}) = \\mathbf{0}\n$$\nWe can distribute the mass $m_i$ and separate the sum:\n$$\n\\sum_{i=1}^{N} m_i \\mathbf{v}_i + \\sum_{i=1}^{N} m_i \\Delta\\mathbf{v} = \\mathbf{0}\n$$\nThe first term is the original total momentum, $\\mathbf{P}_{\\text{total}}$. In the second term, $\\Delta\\mathbf{v}$ is a constant vector and can be factored out of the summation:\n$$\n\\mathbf{P}_{\\text{total}} + \\left(\\sum_{i=1}^{N} m_i\\right) \\Delta\\mathbf{v} = \\mathbf{0}\n$$\nLet $M_{\\text{total}} = \\sum_{i=1}^{N} m_i$ be the total mass of the system. The equation becomes:\n$$\n\\mathbf{P}_{\\text{total}} + M_{\\text{total}} \\Delta\\mathbf{v} = \\mathbf{0}\n$$\nSolving for the velocity correction $\\Delta\\mathbf{v}$:\n$$\nM_{\\text{total}} \\Delta\\mathbf{v} = -\\mathbf{P}_{\\text{total}}\n$$\n$$\n\\Delta\\mathbf{v} = -\\frac{\\mathbf{P}_{\\text{total}}}{M_{\\text{total}}}\n$$\nThe velocity of the center-of-mass (COM) of the system is defined as $\\mathbf{v}_{\\text{COM}} = \\frac{\\sum m_i \\mathbf{v}_i}{\\sum m_i} = \\frac{\\mathbf{P}_{\\text{total}}}{M_{\\text{total}}}$. Therefore, the required velocity correction is the negative of the COM velocity:\n$$\n\\Delta\\mathbf{v} = -\\mathbf{v}_{\\text{COM}}\n$$\nThis correction effectively transforms the particle velocities into a reference frame where the center-of-mass is stationary, thus nullifying the total momentum. The premise of translational invariance under PBC implies that the physics of the system should be independent of a uniform translational velocity of the whole system, which is precisely what this procedure removes.\n\n**Part 2: Invariance of Relative Motion**\n\nThe relative velocity between any two particles, say particle $i$ and particle $j$, is defined as $\\mathbf{v}_{ij} = \\mathbf{v}_i - \\mathbf{v}_j$. After the correction is applied, the new relative velocity, $\\mathbf{v}_{ij}'$, is:\n$$\n\\mathbf{v}_{ij}' = \\mathbf{v}_i' - \\mathbf{v}_j'\n$$\nSubstituting the expressions for the corrected velocities:\n$$\n\\mathbf{v}_{ij}' = (\\mathbf{v}_i + \\Delta\\mathbf{v}) - (\\mathbf{v}_j + \\Delta\\mathbf{v})\n$$\n$$\n\\mathbf{v}_{ij}' = \\mathbf{v}_i + \\Delta\\mathbf{v} - \\mathbf{v}_j - \\Delta\\mathbf{v}\n$$\nThe uniform correction term $\\Delta\\mathbf{v}$ cancels out:\n$$\n\\mathbf{v}_{ij}' = \\mathbf{v}_i - \\mathbf{v}_j = \\mathbf{v}_{ij}\n$$\nThus, the relative velocity between any pair of particles is unchanged by the uniform velocity correction. Since the internal forces in the system (e.g., from a pairwise potential) depend on the relative positions and velocities of the particles, the internal dynamics, particle-particle collisions, and structural evolution of the fluid are unaffected. The correction only removes the non-physical, uniform translation of the entire system as a rigid body.\n\n**Part 3: Numerical Calculation**\n\nWe apply the derived expression to the given three-particle subsystem. The masses and velocities are:\n$m_1=3.0\\times 10^{-26}\\,\\mathrm{kg}$, $m_2=6.0\\times 10^{-26}\\,\\mathrm{kg}$, $m_3=9.0\\times 10^{-26}\\,\\mathrm{kg}$.\n$\\mathbf{v}_1=\\begin{pmatrix} 150 & -200 & 50 \\end{pmatrix}\\,\\mathrm{m/s}$\n$\\mathbf{v}_2=\\begin{pmatrix} 300 & 100 & -100 \\end{pmatrix}\\,\\mathrm{m/s}$\n$\\mathbf{v}_3=\\begin{pmatrix} -250 & 50 & 200 \\end{pmatrix}\\,\\mathrm{m/s}$\n\nFirst, we calculate the total mass $M_{\\text{total}}$:\n$$\nM_{\\text{total}} = m_1 + m_2 + m_3 = (3.0 + 6.0 + 9.0) \\times 10^{-26}\\,\\mathrm{kg} = 18.0 \\times 10^{-26}\\,\\mathrm{kg}\n$$\nNext, we calculate the total momentum $\\mathbf{P}_{\\text{total}} = m_1\\mathbf{v}_1 + m_2\\mathbf{v}_2 + m_3\\mathbf{v}_3$.\nLet's compute each component of the momentum, denoted by subscripts $x, y, z$.\n$$\nP_{\\text{total},x} = m_1 v_{1,x} + m_2 v_{2,x} + m_3 v_{3,x} \\\\\n= (3.0 \\times 10^{-26})(150) + (6.0 \\times 10^{-26})(300) + (9.0 \\times 10^{-26})(-250) \\\\\n= (450 + 1800 - 2250) \\times 10^{-26} = 0\\,\\mathrm{kg\\cdot m/s}\n$$\n$$\nP_{\\text{total},y} = m_1 v_{1,y} + m_2 v_{2,y} + m_3 v_{3,y} \\\\\n= (3.0 \\times 10^{-26})(-200) + (6.0 \\times 10^{-26})(100) + (9.0 \\times 10^{-26})(50) \\\\\n= (-600 + 600 + 450) \\times 10^{-26} = 450 \\times 10^{-26}\\,\\mathrm{kg\\cdot m/s}\n$$\n$$\nP_{\\text{total},z} = m_1 v_{1,z} + m_2 v_{2,z} + m_3 v_{3,z} \\\\\n= (3.0 \\times 10^{-26})(50) + (6.0 \\times 10^{-26})(-100) + (9.0 \\times 10^{-26})(200) \\\\\n= (150 - 600 + 1800) \\times 10^{-26} = 1350 \\times 10^{-26}\\,\\mathrm{kg\\cdot m/s}\n$$\nSo, the total momentum vector is $\\mathbf{P}_{\\text{total}} = \\begin{pmatrix} 0 & 450 & 1350 \\end{pmatrix} \\times 10^{-26}\\,\\mathrm{kg\\cdot m/s}$.\n\nNow, we compute the velocity correction $\\Delta\\mathbf{v}$:\n$$\n\\Delta\\mathbf{v} = -\\frac{\\mathbf{P}_{\\text{total}}}{M_{\\text{total}}} = -\\frac{\\begin{pmatrix} 0 & 450 & 1350 \\end{pmatrix} \\times 10^{-26}}{18.0 \\times 10^{-26}}\n$$\nThe factor of $10^{-26}$ cancels.\n$$\n\\Delta\\mathbf{v} = -\\frac{1}{18.0} \\begin{pmatrix} 0 & 450 & 1350 \\end{pmatrix} = -\\begin{pmatrix} \\frac{0}{18.0} & \\frac{450}{18.0} & \\frac{1350}{18.0} \\end{pmatrix}\n$$\n$$\n\\Delta\\mathbf{v} = -\\begin{pmatrix} 0 & 25 & 75 \\end{pmatrix} = \\begin{pmatrix} 0 & -25 & -75 \\end{pmatrix}\\,\\mathrm{m/s}\n$$\nFinally, we compute the corrected velocity of particle $2$, $\\mathbf{v}_2'$:\n$$\n\\mathbf{v}_2' = \\mathbf{v}_2 + \\Delta\\mathbf{v}\n$$\n$$\n\\mathbf{v}_2' = \\begin{pmatrix} 300 & 100 & -100 \\end{pmatrix} + \\begin{pmatrix} 0 & -25 & -75 \\end{pmatrix}\n$$\n$$\n\\mathbf{v}_2' = \\begin{pmatrix} 300+0 & 100-25 & -100-75 \\end{pmatrix}\n$$\n$$\n\\mathbf{v}_2' = \\begin{pmatrix} 300 & 75 & -175 \\end{pmatrix}\\,\\mathrm{m/s}\n$$\nAll calculations resulted in exact integer values, so no rounding is necessary. The corrected velocity of particle $2$ is $\\begin{pmatrix} 300 & 75 & -175 \\end{pmatrix}\\,\\mathrm{m/s}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n300 & 75 & -175\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The gold standard for validating the core stability of a molecular dynamics engine is to run a simulation in the microcanonical ($NVE$) ensemble and monitor the total energy. In theory, this energy should be perfectly conserved; in practice, a variety of numerical approximations can introduce a systematic \"drift.\" This hands-on problem puts you in the role of a computational detective, tasked with diagnosing the potential sources of such an energy leak. Evaluating these plausible causes—from an excessive integration timestep to flaws in neighbor listing or constraint handling—is a critical skill for ensuring your simulations are both stable and physically meaningful .",
            "id": "2417125",
            "problem": "You run a long microcanonical (NVE) molecular dynamics (MD) simulation of an all-atom protein in explicit water using a pairwise-additive force field with Lennard-Jones (LJ) and Coulomb interactions. The integrator is velocity Verlet with time step $\\Delta t = 2\\,\\mathrm{fs}$ and rigid covalent bonds to hydrogens enforced by a constraint solver. Nonbonded interactions use a real-space truncation with a spherical cutoff and a Verlet neighbor list. You carefully disable any thermostat or barostat. After $100\\,\\mathrm{ns}$, the reported total energy $E_{\\text{tot}}(t) = K(t) + U(t)$ shows a slow but systematic upward drift of about $+0.5\\,\\mathrm{kJ\\,mol^{-1}\\,ns^{-1}}$. \n\nFrom first principles, recall that for classical point particles obeying Newton’s second law, $m_i\\,\\mathbf{a}_i = \\mathbf{F}_i = -\\nabla_i U(\\mathbf{r}^N)$, and for a time-independent potential $U$ and perfectly conservative forces, the continuous-time dynamics conserve the total energy $E_{\\text{tot}} = K + U$ exactly. In discretized MD, numerical errors, non-conservative approximations to forces, or constraint inaccuracies can introduce secular energy drift. \n\nWhich of the following are plausible explanations for a systematic upward drift in $E_{\\text{tot}}$ under the stated conditions, and which practical diagnostics would most directly identify the source? Select all that apply.\n\nA. The integration time step $\\Delta t$ is too large for the fastest motions remaining after constraining bonds to hydrogens, so discretization error injects energy. Diagnostic: rerun short segments with $\\Delta t$ reduced (e.g., to $\\Delta t = 1\\,\\mathrm{fs}$) and compare the drift rate; a substantial reduction in drift with smaller $\\Delta t$ indicates time-integration error.\n\nB. The neighbor list buffer is too small and/or neighbor lists are updated too infrequently with a hard real-space cutoff, producing discontinuous forces when pairs enter the cutoff region, doing spurious work on the system. Diagnostic: increase the neighbor-list skin and update frequency and inspect time series of $U(t)$ for small jumps correlated with neighbor-list rebuilds; reduced jumps and drift implicate cutoff/list artifacts.\n\nC. Accumulation of center-of-mass (COM) translation in periodic boundaries causes “heating” of internal modes, raising $E_{\\text{tot}}$. Diagnostic: periodically remove COM velocity to eliminate drift in $E_{\\text{tot}}$.\n\nD. The constraint solver tolerance is too loose or the iteration count too low, so constraints are not fully satisfied each step, allowing the solver to do net positive work on the system. Diagnostic: tighten the constraint tolerance by orders of magnitude and/or increase the maximum iterations, and monitor the maximum constraint violation and the drift; a decrease in both indicates constraint-induced drift.\n\nE. Finite-precision arithmetic (e.g., single precision) biases accumulation of round-off errors into a secular energy increase. Diagnostic: rerun identically in double precision and compare drift; a marked reduction indicates precision-related drift.",
            "solution": "The problem statement will first be validated.\n\n### Step 1: Extract Givens\n- Simulation ensemble: Microcanonical (NVE), constant number of particles ($N$), volume ($V$), and total energy ($E$).\n- System: All-atom protein in explicit water.\n- Force Field: Pairwise-additive with Lennard-Jones (LJ) and Coulomb interactions. Potential $U$ is time-independent.\n- Integrator: Velocity Verlet.\n- Time step: $\\Delta t = 2\\,\\mathrm{fs}$.\n- Constraints: Covalent bonds to all hydrogen atoms are rigid, enforced by a constraint solver.\n- Nonbonded scheme: Real-space truncation with a spherical cutoff and a Verlet neighbor list.\n- Thermostat/Barostat: Disabled.\n- Simulation duration: $100\\,\\mathrm{ns}$.\n- Observation: Total energy $E_{\\text{tot}}(t) = K(t) + U(t)$ exhibits a systematic upward drift of approximately $+0.5\\,\\mathrm{kJ\\,mol^{-1}\\,ns^{-1}}$.\n- Theoretical context: For conservative forces derived from a time-independent potential $U$, $m_i\\,\\mathbf{a}_i = \\mathbf{F}_i = -\\nabla_i U(\\mathbf{r}^N)$, the total energy $E_{\\text{tot}}$ is an exact constant of motion in continuous time. Numerical artifacts in discrete-time MD can cause energy drift.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a standard computational experiment in molecular biophysics.\n- **Scientifically Grounded**: The scenario is a typical all-atom molecular dynamics simulation. The NVE ensemble, velocity Verlet integrator, constraint algorithms for hydrogen bonds (e.g., SHAKE, LINCS), and truncated nonbonded interactions with neighbor lists are all standard methodologies. The observed energy drift is a well-known and critically important numerical artifact in such simulations. The described drift rate is realistic for a simulation with the given parameters. The problem is firmly rooted in the principles of classical mechanics and numerical analysis as applied to molecular simulation.\n- **Well-Posed**: The problem is clearly stated. It provides a specific observation (upward energy drift) under a defined set of simulation conditions and asks for an evaluation of plausible physical and numerical causes from a given list. A definite set of correct answers exists based on established knowledge in the field.\n- **Objective**: The problem is stated using precise, technical language common to the field of computational chemistry and physics. It is free from subjective or ambiguous terminology.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is scientifically sound, well-posed, and objective. A solution will be derived by analyzing each option based on the first principles of molecular dynamics.\n\n### Solution Derivation and Option Analysis\n\nThe total energy of a system in an NVE simulation should be conserved. A systematic drift, as opposed to bounded fluctuations, indicates a flaw in the numerical implementation of the theoretically conservative dynamics. This flaw arises from approximations that break the time-reversal symmetry and symplecticity of the integration algorithm or that introduce non-conservative forces. We evaluate each option as a potential source of this energy non-conservation.\n\n**A. The integration time step $\\Delta t$ is too large for the fastest motions remaining after constraining bonds to hydrogens, so discretization error injects energy. Diagnostic: rerun short segments with $\\Delta t$ reduced (e.g., to $\\Delta t = 1\\,\\mathrm{fs}$) and compare the drift rate; a substantial reduction in drift with smaller $\\Delta t$ indicates time-integration error.**\n\nThe velocity Verlet algorithm is a second-order numerical integrator. The local error per step is of order $\\mathcal{O}(\\Delta t^3)$, and the global error in trajectories over a fixed time interval $T$ is of order $\\mathcal{O}(\\Delta t^2)$. While the algorithm is symplectic for conservative forces and should exhibit bounded energy fluctuations, a time step that is too large to resolve the fastest characteristic motions of the system leads to resonance artifacts. These resonances can cause a systematic transfer of energy into high-frequency modes, a phenomenon often called numerical heating. Even after constraining the fastest degrees of freedom (H-bond vibrations), other motions like bond-angle vibrations in a protein can have periods on the order of $10-20\\,\\mathrm{fs}$. A time step of $\\Delta t = 2\\,\\mathrm{fs}$ is aggressive and may be too large for stable integration of these modes, thus leading to the accumulation of discretization error and a secular upward drift in total energy. The proposed diagnostic is a standard procedure; if the drift is due to the size of $\\Delta t$, its magnitude should decrease significantly with a smaller time step, typically scaling with a power of $\\Delta t$.\n\nVerdict: **Correct**.\n\n**B. The neighbor list buffer is too small and/or neighbor lists are updated too infrequently with a hard real-space cutoff, producing discontinuous forces when pairs enter the cutoff region, doing spurious work on the system. Diagnostic: increase the neighbor-list skin and update frequency and inspect time series of $U(t)$ for small jumps correlated with neighbor-list rebuilds; reduced jumps and drift implicate cutoff/list artifacts.**\n\nA simple truncation of the potential at a cutoff radius $r_c$ makes the potential energy function non-differentiable and the corresponding force $\\mathbf{F} = -\\nabla U$ discontinuous at $r = r_c$. A discontinuous force is non-conservative, and integrating particle motion under such a force does not conserve energy. A Verlet neighbor list is used for efficiency, where interactions are computed only for pairs within a radius $r_{list} > r_c$. The list is held constant for several time steps. If the update frequency is too low or the \"skin\" thickness ($r_{list} - r_c$) is too small, a pair of particles may cross the cutoff boundary $r_c$ between neighbor list updates. At the next force calculation after crossing, the force on this pair will abruptly appear or disappear, creating an impulse. This leads to a discontinuity in the potential energy and spurious work being done. These events rarely average to zero and typically result in a net increase in kinetic energy, causing the system to heat up. The proposed diagnostic directly tests this hypothesis by making the neighbor list management more conservative (thicker skin, more frequent updates), which should smoothen the effective forces and reduce the energy drift.\n\nVerdict: **Correct**.\n\n**C. Accumulation of center-of-mass (COM) translation in periodic boundaries causes “heating” of internal modes, raising $E_{\\text{tot}}$. Diagnostic: periodically remove COM velocity to eliminate drift in $E_{\\text{tot}}$.**\n\nIn a simulation with no external forces, the total momentum of the system, and thus its COM velocity, should be conserved. However, the summation of forces in finite-precision arithmetic can lead to a small net force, causing the COM velocity to drift from zero. The total kinetic energy $K$ is the sum of the kinetic energy of the COM, $K_{\\text{COM}} = \\frac{1}{2} M_{\\text{tot}} \\mathbf{V}_{\\text{COM}}^2$, and the internal kinetic energy, $K_{\\text{internal}}$. An increase in $\\mathbf{V}_{\\text{COM}}$ directly increases $K_{\\text{COM}}$ and thus $E_{\\text{tot}} = U + K_{\\text{internal}} + K_{\\text{COM}}$. So, COM velocity drift is a plausible cause for a rise in the *reported total energy*. However, the option's explanation that this \"causes 'heating' of internal modes\" is physically incorrect. The COM motion is, to first order, decoupled from the internal degrees of freedom. An increase in $K_{\\text{COM}}$ does not transfer energy to internal modes; in fact, a known artifact in long NVE simulations called the \"flying ice cube\" effect involves the transfer of energy *from* internal modes *to* COM motion, causing the molecule to cool internally. The description of the physical mechanism is flawed. The diagnostic, removing COM velocity, is correct for addressing the drift in $E_{\\text{tot}}$ caused by COM motion, but it addresses the rise in $K_{COM}$, not a fictitious heating of internal modes. Due to the incorrect physical reasoning, this option is not a valid explanation as stated.\n\nVerdict: **Incorrect**.\n\n**D. The constraint solver tolerance is too loose or the iteration count too low, so constraints are not fully satisfied each step, allowing the solver to do net positive work on the system. Diagnostic: tighten the constraint tolerance by orders of magnitude and/or increase the maximum iterations, and monitor the maximum constraint violation and the drift; a decrease in both indicates constraint-induced drift.**\n\nConstraint algorithms like SHAKE and its velocity-level counterpart RATTLE (which is used with velocity Verlet) are iterative. They apply corrective impulses to satisfy geometric constraints. If the convergence tolerance is too loose or the maximum number of iterations is insufficient, the constraints will not be perfectly satisfied at the end of a time step. The process of applying constraint corrections can do work on the system. While for a perfectly converged solver this work should average to zero, an inaccurate solution can introduce a systematic bias. The errors in satisfying the constraints mean that the constraint forces are not perfectly orthogonal to the particle velocities, leading to net positive or negative work over many steps. This is a well-known source of systematic energy drift. The proposed diagnostic is the standard and correct way to verify this: increasing the accuracy of the constraint solver should reduce the error and the associated energy drift.\n\nVerdict: **Correct**.\n\n**E. Finite-precision arithmetic (e.g., single precision) biases accumulation of round-off errors into a secular energy increase. Diagnostic: rerun identically in double precision and compare drift; a marked reduction indicates precision-related drift.**\n\nMolecular dynamics simulations involve a massive number of floating-point operations at each time step. While double-precision arithmetic (64-bit) is standard for scientific computing and typically sufficient to keep round-off errors random and non-accumulating, single-precision (32-bit) arithmetic can be problematic. The lower precision can lead to significant loss of accuracy, especially when summing many small numbers (forces) or taking differences of large numbers (in kinetic energy calculation). These round-off errors may not be random and can introduce a systematic bias, effectively acting as a small, non-physical force that does work on the system over time, leading to energy drift. An upward drift is a very possible outcome. The diagnostic is definitive: if running the identical simulation using double-precision arithmetic significantly reduces or eliminates the energy drift, then finite-precision effects were a primary cause.\n\nVerdict: **Correct**.",
            "answer": "$$ \\boxed{ABDE} $$"
        },
        {
            "introduction": "Performing large-scale molecular dynamics simulations is a constant exercise in balancing physical accuracy with computational efficiency. The use of a Verlet neighbor list with a skin distance $\\delta$ is a classic example of this trade-off: a larger skin reduces the frequency of expensive list rebuilds, but increases the per-step cost of force calculations. This advanced practice challenges you to move beyond simple heuristics and develop a first-principles model to find the optimal skin distance $\\delta^{\\star}$. By deriving an analytical expression that connects algorithmic parameters to the system's physical properties, such as its diffusion coefficient $D$, you will engage with the type of performance optimization that is essential for state-of-the-art computational research .",
            "id": "4096094",
            "problem": "A homogeneous complex fluid is simulated using Molecular Dynamics (MD) with a truncated pair potential of cutoff radius $r_c$ and a Verlet neighbor list with a skin distance $\\delta$, so that the neighbor-list radius is $r_{\\ell} = r_c + \\delta$. Assume a large, uniform system of number density $\\rho$ in three dimensions and a constant time step $\\Delta t$. The per-pair, per-step force-evaluation wall time is $t_p$, and the neighbor-list rebuild wall time per particle is $t_b$. Over long times, particle displacements are diffusive with diffusion coefficient $D$, such that the mean-square displacement obeys $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 6 D t$. In practice, the neighbor list is rebuilt whenever the root-mean-square displacement since the last rebuild reaches $\\delta/2$. For a large system in the long-time regime, model the neighbor count per particle as proportional to the volume $V_{\\ell} = \\frac{4\\pi}{3} (r_c + \\delta)^3$, and model the total computational cost rate (wall time per unit physical time) as the sum of (i) the per-step force-evaluation cost rate and (ii) the neighbor-list rebuild cost rate.\n\nStarting from the above physical inputs and definitions only, and without invoking any other pre-fabricated performance models, derive the analytic expression for the optimal skin $\\delta^{\\star}$ that minimizes the total computational cost rate in the asymptotic regime $\\delta \\ll r_c$ (retain the leading nontrivial contribution in $\\delta$ to the force-evaluation cost). Express your final answer as a closed-form function of $D$, $\\rho$, $r_c$, $\\Delta t$, $t_p$, and $t_b$. Do not include units in your final expression. No numerical evaluation is required; provide a single analytic expression only.",
            "solution": "The problem requires the derivation of the optimal skin distance, $\\delta^{\\star}$, that minimizes the total computational cost rate, $C$, for a Molecular Dynamics simulation. The total cost rate is the sum of the force-evaluation cost rate, $C_f$, and the neighbor-list rebuild cost rate, $C_b$:\n$$\nC(\\delta) = C_f(\\delta) + C_b(\\delta)\n$$\nWe will derive expressions for $C_f$ and $C_b$ as functions of the skin distance $\\delta$ and the other provided parameters.\n\nFirst, we determine the neighbor-list rebuild cost rate, $C_b$. The neighbor list is rebuilt whenever the root-mean-square displacement (RMSD) of particles since the last rebuild equals $\\delta/2$. The mean-square displacement (MSD) over a time interval $t$ is given as $\\langle |\\Delta \\mathbf{r}(t)|^2 \\rangle = 6 D t$. The RMSD is the square root of the MSD. Let $T_b$ be the physical time between two consecutive rebuilds. The rebuild condition is:\n$$\n\\sqrt{\\langle |\\Delta \\mathbf{r}(T_b)|^2 \\rangle} = \\frac{\\delta}{2}\n$$\nSubstituting the given expression for the MSD:\n$$\n\\sqrt{6 D T_b} = \\frac{\\delta}{2}\n$$\nSquaring both sides of the equation gives $6 D T_b = \\frac{\\delta^2}{4}$. Solving for $T_b$, we find the physical time between rebuilds:\n$$\nT_b = \\frac{\\delta^2}{24 D}\n$$\nThe wall time for a single neighbor-list rebuild for a system with $N$ particles is the product of the number of particles and the rebuild time per particle, $t_b$, which is $N t_b$. The cost rate $C_b$ is defined as the wall time for one rebuild divided by the physical time elapsed between rebuilds:\n$$\nC_b(\\delta) = \\frac{N t_b}{T_b} = \\frac{N t_b}{\\frac{\\delta^2}{24 D}} = \\frac{24 D N t_b}{\\delta^2}\n$$\nNext, we determine the force-evaluation cost rate, $C_f$. This cost occurs at every time step of duration $\\Delta t$. The cost of force calculation per step is proportional to the number of interacting particle pairs. The neighbor-list radius is given by $r_{\\ell} = r_c + \\delta$. The problem states that the number of neighbors for a single particle, $N_{neigh}$, is proportional to the volume of the neighbor-list sphere, $V_{\\ell} = \\frac{4\\pi}{3} r_{\\ell}^3$. Following the standard physical model, we take the number of neighbors to be the product of the number density $\\rho$ and this volume:\n$$\nN_{neigh} = \\rho V_{\\ell} = \\rho \\frac{4\\pi}{3} (r_c + \\delta)^3\n$$\nFor a system of $N$ particles, the total number of interacting pairs is $\\frac{1}{2} N \\cdot N_{neigh}$, where the factor of $\\frac{1}{2}$ corrects for double counting. The wall time for force evaluation in a single time step, $W_{step}$, is the total number of pairs multiplied by the per-pair evaluation time, $t_p$:\n$$\nW_{step} = \\frac{1}{2} N \\cdot N_{neigh} \\cdot t_p = \\frac{1}{2} N \\left( \\rho \\frac{4\\pi}{3} (r_c + \\delta)^3 \\right) t_p = \\frac{2\\pi N \\rho t_p}{3} (r_c + \\delta)^3\n$$\nThe force-evaluation cost rate, $C_f$, is the wall time per step divided by the duration of that step, $\\Delta t$:\n$$\nC_f(\\delta) = \\frac{W_{step}}{\\Delta t} = \\frac{2\\pi N \\rho t_p}{3 \\Delta t} (r_c + \\delta)^3\n$$\nThe problem requires an analysis in the asymptotic regime where $\\delta \\ll r_c$. We expand the term $(r_c + \\delta)^3$ and retain the leading nontrivial contribution in $\\delta$. Using the binomial approximation $(1+x)^n \\approx 1+nx$ for small $x$:\n$$\n(r_c + \\delta)^3 = r_c^3 \\left(1 + \\frac{\\delta}{r_c}\\right)^3 \\approx r_c^3 \\left(1 + 3\\frac{\\delta}{r_c}\\right) = r_c^3 + 3r_c^2\\delta\n$$\nSubstituting this approximation into the expression for $C_f(\\delta)$:\n$$\nC_f(\\delta) \\approx \\frac{2\\pi N \\rho t_p}{3 \\Delta t} (r_c^3 + 3r_c^2\\delta) = \\frac{2\\pi N \\rho t_p r_c^3}{3 \\Delta t} + \\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} \\delta\n$$\nThe total computational cost rate $C(\\delta)$ in this asymptotic regime is the sum of the approximated $C_f(\\delta)$ and $C_b(\\delta)$:\n$$\nC(\\delta) \\approx \\left( \\frac{2\\pi N \\rho t_p r_c^3}{3 \\Delta t} + \\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} \\delta \\right) + \\frac{24 D N t_b}{\\delta^2}\n$$\nTo find the optimal skin distance $\\delta^{\\star}$ that minimizes $C(\\delta)$, we compute the derivative of $C(\\delta)$ with respect to $\\delta$ and set it to zero. The first term in the expression for $C(\\delta)$ is a constant with respect to $\\delta$.\n$$\n\\frac{dC}{d\\delta} = \\frac{d}{d\\delta} \\left( \\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} \\delta + \\frac{24 D N t_b}{\\delta^2} \\right) = \\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} - 2 \\frac{24 D N t_b}{\\delta^3}\n$$\nSetting the derivative to zero to find the extremum $\\delta^{\\star}$:\n$$\n\\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} - \\frac{48 D N t_b}{(\\delta^{\\star})^3} = 0\n$$\n$$\n\\frac{2\\pi N \\rho t_p r_c^2}{\\Delta t} = \\frac{48 D N t_b}{(\\delta^{\\star})^3}\n$$\nSolving for $(\\delta^{\\star})^3$:\n$$\n(\\delta^{\\star})^3 = \\frac{48 D N t_b \\Delta t}{2\\pi N \\rho t_p r_c^2} = \\frac{24 D t_b \\Delta t}{\\pi \\rho t_p r_c^2}\n$$\nThe total number of particles, $N$, cancels, as expected for an intensive parameter in a large system. Taking the cube root gives the optimal skin distance:\n$$\n\\delta^{\\star} = \\left( \\frac{24 D t_b \\Delta t}{\\pi \\rho t_p r_c^2} \\right)^{1/3}\n$$\nTo confirm that this corresponds to a minimum, we examine the second derivative of the cost function, $\\frac{d^2C}{d\\delta^2} = 3 \\cdot \\frac{48 D N t_b}{\\delta^4} = \\frac{144 D N t_b}{\\delta^4}$. Since all parameters ($D$, $N$, $t_b$) are positive, the second derivative is positive, confirming that $\\delta^{\\star}$ minimizes the total cost rate.",
            "answer": "$$\n\\boxed{\\left( \\frac{24 D t_b \\Delta t}{\\pi \\rho t_p r_c^2} \\right)^{1/3}}\n$$"
        }
    ]
}