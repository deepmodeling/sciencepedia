{
    "hands_on_practices": [
        {
            "introduction": "在将任何数值积分器应用于分子动力学模拟之前，我们必须首先确定它在何种时间步长下能够产生稳定且不会发散的解。这个练习将引导你通过简谐振子这一模型系统，对位置Verlet方法进行基本的线性稳定性分析。通过推导其递推关系的放大矩阵，你将能够确定该算法保持稳定的临界时间步长，这是评估任何积分方案可行性的基础步骤 。",
            "id": "4090835",
            "problem": "在计算复杂流体中线性化模式的分子动力学（MD）模拟背景下，考虑一个简正模，该简正模被建模为一个由牛顿第二定律支配的一维谐振子，其运动方程为 $\\ddot{x}(t)=-\\omega^{2}x(t)$，其中 $\\omega>0$ 是模式频率。我们将时间离散化为 $t_{n}=n\\,\\Delta t$，其中时间步长 $\\Delta t>0$ 为常数，并使用位置Verlet算法来积分动力学。\n\n仅从微分方程 $\\ddot{x}(t)=-\\omega^{2}x(t)$ 和标准的中心差分一致性近似出发，完成以下任务：\n\n1. 推导与位置Verlet算法一致的、用 $x_{n}$ 和 $x_{n-1}$ 表示 $x_{n+1}$ 的显式两步递推关系。\n2. 引入状态向量 $\\mathbf{y}_{n}=\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}$ 并推导 $2\\times 2$ 放大矩阵 $\\mathbf{A}$，使得 $\\mathbf{y}_{n+1}=\\mathbf{A}\\,\\mathbf{y}_{n}$，其中 $\\mathbf{A}$ 仅用无量纲参数 $q=\\Delta t\\,\\omega$ 表示。\n3. 使用线性常系数递推的线性稳定性第一性原理，确定在该谐振子上位置Verlet方法保持线性稳定的关于 $q$ 的条件。然后，提取单个最大无量纲步长 $q_{\\max}$，使得对于所有 $0\\leq q\\leq q_{\\max}$ 稳定性都成立。\n\n最终答案仅提供单个数字 $q_{\\max}$，不带单位。无需四舍五入；请提供精确值。",
            "solution": "我们从一维谐振子的牛顿第二定律开始，\n$$\n\\ddot{x}(t)=-\\omega^{2}x(t),\n$$\n其中 $\\omega>0$ 且时间步长 $\\Delta t>0$ 为常数。位置Verlet算法可以通过对二阶导数使用中心差分来获得，这是一种标准的、对称的、二阶精度的近似。具体来说，将 $x(t)$ 在 $t_{n}$ 处进行泰勒级数展开：\n$$\nx(t_{n}\\pm \\Delta t)=x_{n}\\pm \\Delta t\\,\\dot{x}_{n}+\\frac{\\Delta t^{2}}{2}\\,\\ddot{x}_{n}\\pm \\frac{\\Delta t^{3}}{6}\\,\\dddot{x}_{n}+\\frac{\\Delta t^{4}}{24}\\,x^{(4)}_{n}+\\cdots,\n$$\n其中 $x_{n}=x(t_{n})$，$\\dot{x}_{n}=\\dot{x}(t_{n})$，依此类推。将 $t_{n}+\\Delta t$ 和 $t_{n}-\\Delta t$ 处的展开式相加，可以消去奇数阶导数，得到中心差分恒等式\n$$\nx_{n+1}-2x_{n}+x_{n-1}=\\Delta t^{2}\\,\\ddot{x}_{n}+\\mathcal{O}(\\Delta t^{4}).\n$$\n将运动方程 $\\ddot{x}_{n}=-\\omega^{2}x_{n}$ 代入此恒等式，得到标准的位置Verlet两步递推关系\n$$\nx_{n+1}=2x_{n}-x_{n-1}-\\omega^{2}\\Delta t^{2}\\,x_{n}.\n$$\n引入无量纲参数 $q=\\Delta t\\,\\omega$。那么更新关系可以写为\n$$\nx_{n+1}=(2-q^{2})\\,x_{n}-x_{n-1}.\n$$\n定义状态向量\n$$\n\\mathbf{y}_{n}=\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}.\n$$\n那么\n$$\n\\mathbf{y}_{n+1}=\\begin{pmatrix}x_{n+1}\\\\ x_{n}\\end{pmatrix}=\\begin{pmatrix}(2-q^{2})\\,x_{n}-x_{n-1}\\\\ x_{n}\\end{pmatrix}=\\underbrace{\\begin{pmatrix}2-q^{2} & -1\\\\ 1 & 0\\end{pmatrix}}_{\\mathbf{A}(q)}\\begin{pmatrix}x_{n}\\\\ x_{n-1}\\end{pmatrix}.\n$$\n因此，放大矩阵为\n$$\n\\mathbf{A}(q)=\\begin{pmatrix}2-q^{2} & -1\\\\ 1 & 0\\end{pmatrix}.\n$$\n为了分析线性稳定性，我们考虑 $\\mathbf{A}(q)$ 的特征值。其特征多项式为\n$$\n\\chi(\\lambda)=\\det\\!\\left(\\mathbf{A}-\\lambda\\mathbf{I}\\right)=\\det\\!\\begin{pmatrix}2-q^{2}-\\lambda & -1\\\\ 1 & -\\lambda\\end{pmatrix}=(-\\lambda)(2-q^{2}-\\lambda)+1.\n$$\n展开后，\n$$\n\\chi(\\lambda)=\\lambda^{2}-(2-q^{2})\\,\\lambda+1.\n$$\n特征值 $\\lambda_{\\pm}$ 是以下方程的解\n$$\n\\lambda^{2}-(2-q^{2})\\,\\lambda+1=0.\n$$\n$\\mathbf{A}$ 的行列式是\n$$\n\\det\\mathbf{A}=1,\n$$\n这是该线性系统辛性的一个标志。递推关系的线性稳定性（对所有 $n$ 解都有界）要求两个特征值都位于复平面的单位圆上或其内部。由于 $\\lambda_{+}\\lambda_{-}=1$，两个特征值的模都为 $1$ 的充要条件是矩阵的迹满足\n$$\n\\left|\\frac{\\operatorname{tr}\\mathbf{A}}{2}\\right|\\leq 1.\n$$\n这里，\n$$\n\\operatorname{tr}\\mathbf{A}=2-q^{2}.\n$$\n因此稳定性条件是\n$$\n\\left|\\frac{2-q^{2}}{2}\\right|\\leq 1.\n$$\n这个不等式可简化为\n$$\n-1\\leq \\frac{2-q^{2}}{2}\\leq 1\\quad\\Longleftrightarrow\\quad -2\\leq 2-q^{2}\\leq 2\\quad\\Longleftrightarrow\\quad 0\\leq q^{2}\\leq 4.\n$$\n根据定义 $q\\geq 0$，所以稳定区间是\n$$\n0\\leq q\\leq 2.\n$$\n因此，确保线性稳定的最大无量纲时间步长是\n$$\nq_{\\max}=2.\n$$\n因为这个值是精确的，所以不需要四舍五入。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "一个稳定的积分器是必要的，但还不足够；我们同样要求它具有足够的精度。对于振荡系统，精度的关键在于数值模拟能在多大程度上复现真实的物理频率。这个问题  将指导你推导“色散关系”，它量化了由速度Verlet算法产生的数值频率误差，让你深入理解即使是稳定的积分器也会如何引入相位误差。",
            "id": "4090847",
            "problem": "考虑一个一维谐振子，用作复杂流体中粗粒化珠子的局部模型，其质量为 $m$，位置为 $x(t)$，势能为 $U(x) = \\frac{1}{2} m \\omega^{2} x^{2}$，其中 $\\omega$ 是物理角频率。其运动遵循牛顿第二定律 $m \\ddot{x}(t) = - \\frac{dU}{dx} = - m \\omega^{2} x(t)$，即 $\\ddot{x}(t) + \\omega^{2} x(t) = 0$。在分子动力学 (MD) 中，时间步长为 $\\Delta t$ 的速度Verlet算法通过以下方式更新位置和速度：\n$$x_{n+1} = x_{n} + \\Delta t \\, v_{n} + \\frac{\\Delta t^{2}}{2} \\, a_{n}, \\qquad v_{n+1} = v_{n} + \\frac{\\Delta t}{2} \\left(a_{n} + a_{n+1}\\right),$$\n其中 $a_{n} = \\ddot{x}(t_{n})$ 且 $t_{n} = n \\Delta t$。对于谐振子，有 $a_{n} = - \\omega^{2} x_{n}$。\n\n从这些原理和定义出发，并假设存在一个当 $n \\to \\infty$ 时非平凡且有界的离散时间振荡解 $x_{n}$，请推导连接离散时间振荡的数值角频率 $\\tilde{\\omega}$ 与 $\\omega$ 和 $\\Delta t$ 的色散关系，然后计算出 $\\tilde{\\omega}$ 关于 $\\omega$ 和 $\\Delta t$ 的显式解析表达式。假设 $0  \\omega \\Delta t  2$，以保证离散动力学是稳定且振荡的。将最终的 $\\tilde{\\omega}$ 以弧度/单位时间表示。您的最终答案必须是关于 $\\tilde{\\omega}$ 的一个单一闭式解析表达式。",
            "solution": "我们的目标是找到由速度Verlet算法生成的离散解的数值频率 $\\tilde{\\omega}$。这可以通过推导位置 $x_n$ 的递推关系并找到其特征频率来实现。\n\n速度Verlet算法由以下两个耦合方程给出：\n$$x_{n+1} = x_{n} + \\Delta t \\, v_{n} + \\frac{\\Delta t^{2}}{2} \\, a_{n} \\quad (1)$$\n$$v_{n+1} = v_{n} + \\frac{\\Delta t}{2} \\left(a_{n} + a_{n+1}\\right) \\quad (2)$$\n对于谐振子，加速度为 $a_{n} = -\\omega^{2}x_{n}$。将此代入方程 $(1)$ 和 $(2)$：\n$$x_{n+1} = x_{n} + \\Delta t \\, v_{n} - \\frac{(\\omega \\Delta t)^{2}}{2} x_{n} \\quad (3)$$\n$$v_{n+1} = v_{n} - \\frac{\\omega^{2} \\Delta t}{2} (x_{n} + x_{n+1}) \\quad (4)$$\n\n为了得到一个只涉及位置 $x_n$ 的关系，我们必须消去速度 $v_n$。首先，从方程 $(3)$ 中解出 $v_n$：\n$$v_{n} = \\frac{x_{n+1} - x_n}{\\Delta t} + \\frac{\\omega^2 \\Delta t}{2} x_n \\quad (5)$$\n对方程 $(4)$ 的时间步索引进行移位，得到 $v_n$ 和 $v_{n-1}$ 之间的关系：\n$$v_{n} = v_{n-1} - \\frac{\\omega^2 \\Delta t}{2} (x_{n-1} + x_n) \\quad (6)$$\n现在，我们将方程 $(5)$ 以及它移位一个时间步后的形式（即 $v_{n-1}$ 的表达式）代入方程 $(6)$：\n$$ \\left( \\frac{x_{n+1} - x_n}{\\Delta t} + \\frac{\\omega^2 \\Delta t}{2} x_n \\right) = \\left( \\frac{x_{n} - x_{n-1}}{\\Delta t} + \\frac{\\omega^2 \\Delta t}{2} x_{n-1} \\right) - \\frac{\\omega^2 \\Delta t}{2} (x_{n-1} + x_n) $$\n将整个方程乘以 $\\Delta t$ 并化简：\n$$ (x_{n+1} - x_n) + \\frac{(\\omega \\Delta t)^2}{2} x_n = (x_{n} - x_{n-1}) + \\frac{(\\omega \\Delta t)^2}{2} x_{n-1} - \\frac{(\\omega \\Delta t)^2}{2} (x_{n-1} + x_n) $$\n$$ x_{n+1} - x_n + \\frac{(\\omega \\Delta t)^2}{2} x_n = x_{n} - x_{n-1} - \\frac{(\\omega \\Delta t)^2}{2} x_n $$\n整理各项，我们得到关于位置的三项线性递推关系：\n$$ x_{n+1} - \\left(2 - (\\omega \\Delta t)^2\\right) x_n + x_{n-1} = 0 \\quad (7) $$\n\n为了求出这个离散振荡的频率，我们代入一个形式为 $x_n = C e^{i n \\tilde{\\omega} \\Delta t}$ 的试探解（ansatz）。对于非平凡解（$C \\neq 0$），我们得到特征方程：\n$$ e^{i\\tilde{\\omega}\\Delta t} - \\left(2 - (\\omega \\Delta t)^2\\right) + e^{-i\\tilde{\\omega}\\Delta t} = 0 $$\n使用欧拉恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们得到色散关系：\n$$ 2\\cos(\\tilde{\\omega}\\Delta t) = 2 - (\\omega \\Delta t)^2 \\quad \\implies \\quad \\cos(\\tilde{\\omega}\\Delta t) = 1 - \\frac{(\\omega \\Delta t)^2}{2} $$\n最后，通过对两边取反余弦来求解 $\\tilde{\\omega}$。利用三角恒等式 $\\arccos(1 - 2z^2) = 2\\arcsin(z)$（其中 $z = \\frac{\\omega\\Delta t}{2}$），我们得到：\n$$ \\tilde{\\omega}\\Delta t = 2\\arcsin\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n因此，数值角频率的显式解析表达式为：\n$$ \\tilde{\\omega} = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n给定的稳定性条件 $0  \\omega \\Delta t  2$ 保证了反正弦函数的自变量在 $(-1, 1)$ 区间内，从而得到一个实值的 $\\tilde{\\omega}$，这对应于一个稳定的振荡轨道。",
            "answer": "$$\\boxed{\\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\omega \\Delta t}{2}\\right)}$$"
        },
        {
            "introduction": "在分子动力学领域，存在多种不同但相关的积分器，例如蛙跳（leapfrog）法和速度Verlet法。这个练习  提供了一个绝佳的机会，让你证明对于基本的简谐振子模型，这两种方案在代数上是等价的。这一探索不仅将巩固你对稳定性和频率分析的理解，还将揭示这些重要算法之间更深层次的联系。",
            "id": "4090815",
            "problem": "考虑一个由牛顿第二定律支配的一维谐振子，其位置 $x(t)$ 满足 $m\\,\\ddot{x}(t)=-kx(t)$，其中 $m0$, $k0$, 且 $\\omega=\\sqrt{k/m}$。令 $\\Delta t0$ 为一个固定的时间步长，并定义无量纲步长 $h=\\omega\\,\\Delta t$。在复杂流体的分子动力学 (MD) 中广泛使用的两种辛二阶积分器是蛙跳格式和速度Verlet格式。将这两种格式应用于该振子，其中：\n- 蛙跳格式使用交错更新\n$$\nv_{n+\\frac{1}{2}}=v_{n-\\frac{1}{2}}-\\omega^{2}x_{n}\\,\\Delta t,\\quad\nx_{n+1}=x_{n}+v_{n+\\frac{1}{2}}\\,\\Delta t.\n$$\n- 速度Verlet格式使用以下更新\n$$\nv_{n+\\frac{1}{2}}=v_{n}-\\frac{1}{2}\\,\\omega^{2}x_{n}\\,\\Delta t,\\quad\nx_{n+1}=x_{n}+v_{n+\\frac{1}{2}}\\,\\Delta t,\\quad\nv_{n+1}=v_{n+\\frac{1}{2}}-\\frac{1}{2}\\,\\omega^{2}x_{n+1}\\,\\Delta t.\n$$\n仅从这些定义和振子方程 $\\,\\ddot{x}=-\\omega^{2}x\\,$ 出发，执行以下步骤：\n- 对每种格式，推导出一个仅关于 $x_{n}$ 的封闭线性齐次递推关系，其形式为 $x_{n+1}=a(h)\\,x_{n}-x_{n-1}$，其中 $a(h)$ 是某个标量函数。\n- 从此递推关系中，确定以 $h$ 表示的线性稳定性条件，该条件定义为当 $n\\to\\infty$ 时所有解保持有界的 $h$ 的集合。\n- 当方法线性稳定时，通过设 $x_{n}=A\\cos(n\\,\\omega_{\\text{num}}\\Delta t+\\phi)$ 来定义数值角频率 $\\omega_{\\text{num}}$，并获得频率比的小 $h$ 展开式\n$$\n\\frac{\\omega_{\\text{num}}}{\\omega}=1+\\alpha\\,h^{2}+\\mathcal{O}(h^{4}).\n$$\n证明对于蛙跳格式和速度Verlet格式，其稳定性条件和系数 $\\alpha$ 是相同的。\n\n将您的最终答案以行向量 $\\bigl[h_{\\max}\\ \\ \\alpha\\bigr]$ 的形式报告，其中 $h_{\\max}$ 是线性稳定性的最大允许无量纲步长，$\\alpha$ 是频率展开式中的公共系数。无需四舍五入，也无需报告单位。",
            "solution": "该问题要求分析应用于一维谐振子的两种数值积分格式——蛙跳格式和速度Verlet格式。该谐振子的运动方程为 $\\ddot{x}(t) = -\\omega^2 x(t)$，其中 $\\omega = \\sqrt{k/m}$。对于每种格式，我们必须首先推导位置变量 $x_n$ 的线性递推关系，然后确定线性稳定性条件，最后求出数值频率的主阶误差项。\n\n第一部分：推导 $x_n$ 的递推关系。\n\n对于蛙跳格式，更新由下式给出：\n$$\nv_{n+\\frac{1}{2}} = v_{n-\\frac{1}{2}} - \\omega^{2}x_{n}\\,\\Delta t \\quad (1)\n$$\n$$\nx_{n+1}=x_{n}+v_{n+\\frac{1}{2}}\\,\\Delta t \\quad (2)\n$$\n从方程 $(2)$，我们可以用位置来表示半步速度 $v_{n+\\frac{1}{2}}$：\n$$\nv_{n+\\frac{1}{2}} = \\frac{x_{n+1} - x_n}{\\Delta t}\n$$\n为了找到 $v_{n-\\frac{1}{2}}$ 的表达式，我们可以将方程 $(2)$ 中的索引 $n$ 移位到 $n-1$：\n$$\nx_{n} = x_{n-1} + v_{n-\\frac{1}{2}}\\,\\Delta t\n$$\n这给出：\n$$\nv_{n-\\frac{1}{2}} = \\frac{x_n - x_{n-1}}{\\Delta t}\n$$\n将这两个速度表达式代入方程 $(1)$：\n$$\n\\frac{x_{n+1} - x_n}{\\Delta t} = \\frac{x_n - x_{n-1}}{\\Delta t} - \\omega^2 x_n \\Delta t\n$$\n将整个方程乘以 $\\Delta t$ 得：\n$$\nx_{n+1} - x_n = x_n - x_{n-1} - \\omega^2 (\\Delta t)^2 x_n\n$$\n整理各项以分离出 $x_{n+1}$，我们得到所需的递推关系：\n$$\nx_{n+1} = 2x_n - x_{n-1} - (\\omega \\Delta t)^2 x_n\n$$\n使用无量纲步长 $h = \\omega \\Delta t$ 的定义，上式变为：\n$$\nx_{n+1} = (2 - h^2)x_n - x_{n-1}\n$$\n其形式为 $x_{n+1} = a(h)x_n - x_{n-1}$，其中 $a(h) = 2 - h^2$。\n\n对于速度Verlet格式，更新如下：\n$$\nv_{n+\\frac{1}{2}} = v_{n} - \\frac{1}{2}\\,\\omega^{2}x_{n}\\,\\Delta t \\quad (3)\n$$\n$$\nx_{n+1} = x_{n} + v_{n+\\frac{1}{2}}\\,\\Delta t \\quad (4)\n$$\n$$\nv_{n+1} = v_{n+\\frac{1}{2}} - \\frac{1}{2}\\,\\omega^{2}x_{n+1}\\,\\Delta t \\quad (5)\n$$\n我们的目标是找到一个只涉及位置变量 $x_n$ 的递推关系。首先，我们可以用位置来表示 $v_n$ 和 $v_{n-1}$。从方程 $(4)$，我们有 $v_{n+\\frac{1}{2}} = (x_{n+1}-x_n)/\\Delta t$。将其代入 $(3)$：\n$$\n\\frac{x_{n+1}-x_n}{\\Delta t} = v_n - \\frac{1}{2}\\omega^2 x_n \\Delta t \\implies v_n = \\frac{x_{n+1}-x_n}{\\Delta t} + \\frac{1}{2}\\omega^2 x_n \\Delta t\n$$\n现在我们需要第二个涉及速度的关系。通过组合方程 $(3)$ 和 $(5)$，我们可以写出整步速度 $v_n$ 的更新规则：\n$$\nv_{n+1} = \\left(v_n - \\frac{1}{2}\\omega^2 x_n \\Delta t\\right) - \\frac{1}{2}\\omega^2 x_{n+1} \\Delta t = v_n - \\frac{1}{2}\\omega^2 \\Delta t (x_n + x_{n+1})\n$$\n将索引 $n$ 移位到 $n-1$ 给出 $v_n$ 与 $v_{n-1}$ 的关系：\n$$\nv_n = v_{n-1} - \\frac{1}{2}\\omega^2 \\Delta t (x_{n-1} + x_n)\n$$\n现在，我们可以将 $v_n$ 和 $v_{n-1}$ 的表达式（通过对我们第一个速度表达式的索引进行移位得到）代入此方程：\n$$\n\\frac{x_{n+1}-x_n}{\\Delta t} + \\frac{1}{2}\\omega^2 x_n \\Delta t = \\left( \\frac{x_n-x_{n-1}}{\\Delta t} + \\frac{1}{2}\\omega^2 x_{n-1} \\Delta t \\right) - \\frac{1}{2}\\omega^2 \\Delta t (x_{n-1} + x_n)\n$$\n乘以 $\\Delta t$ 并使用 $h = \\omega \\Delta t$：\n$$\n(x_{n+1}-x_n) + \\frac{h^2}{2} x_n = (x_n-x_{n-1}) + \\frac{h^2}{2} x_{n-1} - \\frac{h^2}{2} (x_{n-1} + x_n)\n$$\n化简右侧：\n$$\nx_{n+1}-x_n + \\frac{h^2}{2} x_n = x_n-x_{n-1} + \\frac{h^2}{2} x_{n-1} - \\frac{h^2}{2} x_{n-1} - \\frac{h^2}{2} x_n\n$$\n$$\nx_{n+1}-x_n + \\frac{h^2}{2} x_n = x_n-x_{n-1} - \\frac{h^2}{2} x_n\n$$\n重新整理以解出 $x_{n+1}$：\n$$\nx_{n+1} = 2x_n - x_{n-1} - h^2 x_n = (2 - h^2)x_n - x_{n-1}\n$$\n这与为蛙跳格式找到的递推关系完全相同。因此，对于速度Verlet格式，我们同样有 $a(h) = 2 - h^2$。\n\n第二部分：线性稳定性分析。\n由于两种格式都得到相同的递推关系 $x_{n+1} - (2-h^2)x_n + x_{n-1} = 0$，它们的稳定性是相同的。为了分析稳定性，我们考虑与此线性递推相关的特征方程。假设解的形式为 $x_n = \\lambda^n$，我们得到：\n$$\n\\lambda^2 - (2-h^2)\\lambda + 1 = 0\n$$\n这个二次方程的根为：\n$$\n\\lambda_{\\pm} = \\frac{(2-h^2) \\pm \\sqrt{(2-h^2)^2 - 4}}{2} = \\frac{(2-h^2) \\pm \\sqrt{h^4 - 4h^2}}{2} = \\frac{(2-h^2) \\pm h\\sqrt{h^2 - 4}}{2}\n$$\n为了使解 $x_n$ 在 $n \\to \\infty$ 时保持有界，根的模必须满足 $|\\lambda| \\le 1$。如果存在两个不同的根，并且由于它们的乘积 $\\lambda_+\\lambda_-$ 为 $1$，如果它们是实数，其中一个根的模将大于 $1$，导致指数增长。这对应于判别式为正的情况。只有当根是模为 $1$ 的共轭复数时，解才可能是有界的。\n此条件要求判别式为负或零：\n$$\nh^2(h^2-4) \\le 0\n$$\n由于 $h = \\omega \\Delta t  0$，所以 $h^2  0$。该条件简化为：\n$$\nh^2 - 4 \\le 0 \\implies h^2 \\le 4 \\implies h \\le 2\n$$\n（因为 $h0$）。\n因此，两种格式的线性稳定性条件都是 $0  h \\le 2$。最大允许步长为 $h_{\\max} = 2$。\n\n第三部分：数值频率误差。\n在稳定区域（$0  h \\le 2$），解是振荡的。我们将试探解 $x_n = A \\cos(n \\omega_{\\text{num}} \\Delta t + \\phi)$ 代入递推关系。令 $\\psi = \\omega_{\\text{num}} \\Delta t$。我们有：\n$$\nx_{n+1} + x_{n-1} = A\\cos((n+1)\\psi+\\phi) + A\\cos((n-1)\\psi+\\phi)\n$$\n使用恒等式 $\\cos(A+B) + \\cos(A-B) = 2\\cos A \\cos B$，其中 $A=n\\psi+\\phi$ 且 $B=\\psi$：\n$$\nx_{n+1} + x_{n-1} = 2A\\cos(n\\psi+\\phi)\\cos\\psi = 2x_n\\cos\\psi\n$$\n递推关系可以写成 $x_{n+1}+x_{n-1} = (2-h^2)x_n$。比较这两个表达式，我们发现：\n$$\n2\\cos\\psi = 2 - h^2 \\implies \\cos\\psi = 1 - \\frac{h^2}{2}\n$$\n这给出了数值频率相移步长 $\\psi = \\omega_{\\text{num}}\\Delta t$ 和无量纲时间步长 $h = \\omega \\Delta t$ 之间的关系。我们对小 $h$ 情况下的比率 $\\omega_{\\text{num}}/\\omega = \\psi/h$ 感兴趣。\n对于小的 $\\psi$，我们将 $\\cos\\psi$ 展开成泰勒级数：\n$$\n\\cos\\psi = 1 - \\frac{\\psi^2}{2!} + \\frac{\\psi^4}{4!} - \\mathcal{O}(\\psi^6)\n$$\n将此与我们的结果相等：\n$$\n1 - \\frac{\\psi^2}{2} + \\frac{\\psi^4}{24} - \\dots = 1 - \\frac{h^2}{2}\n$$\n$$\n\\frac{\\psi^2}{2} - \\frac{\\psi^4}{24} + \\dots = \\frac{h^2}{2} \\implies \\psi^2 \\left(1 - \\frac{\\psi^2}{12} + \\dots\\right) = h^2\n$$\n对于小 $h$，$\\psi$ 也很小，且 $\\psi \\approx h$。我们可以将 $\\psi$ 写成 $h$ 的幂级数：$\\psi = c_1 h + c_3 h^3 + \\dots$。首项是 $c_1=1$。所以，$\\psi = h + c_3 h^3 + \\mathcal{O}(h^5)$。\n将此代入方程中：\n$$\n(h + c_3 h^3 + \\dots)^2 \\left(1 - \\frac{(h + \\dots)^2}{12} + \\dots\\right) = h^2\n$$\n$$\n(h^2 + 2c_3 h^4 + \\dots)\\left(1 - \\frac{h^2}{12} + \\dots\\right) = h^2\n$$\n$$\nh^2 - \\frac{h^4}{12} + 2c_3 h^4 + \\dots = h^2\n$$\n比较 $h^4$ 的系数：\n$$\n2c_3 - \\frac{1}{12} = 0 \\implies c_3 = \\frac{1}{24}\n$$\n所以，$\\psi = h + \\frac{1}{24}h^3 + \\mathcal{O}(h^5)$。\n频率比为：\n$$\n\\frac{\\omega_{\\text{num}}}{\\omega} = \\frac{\\psi}{h} = \\frac{h + \\frac{1}{24}h^3 + \\mathcal{O}(h^5)}{h} = 1 + \\frac{1}{24}h^2 + \\mathcal{O}(h^4)\n$$\n其形式为 $1 + \\alpha h^2 + \\mathcal{O}(h^4)$，系数 $\\alpha = \\frac{1}{24}$。这个结果对于两种格式也是相同的。\n\n总之，对于线性谐振子，蛙跳格式和速度Verlet格式在代数上是等价的，它们有相同的稳定性极限 $h_{\\max}=2$ 和相同的频率误差系数 $\\alpha = 1/24$。最终答案是行向量 $[h_{\\max} \\ \\ \\alpha]$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  \\frac{1}{24}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}