{
    "hands_on_practices": [
        {
            "introduction": "教科书中常使用简谐振子模型，但真实世界中的原子间相互作用势往往是非对称的。这种非谐性是热膨胀等重要物理现象的微观根源。本练习将引导你运用玻尔兹曼分布，通过微扰方法处理一个非谐势，计算粒子平均位移与温度的关系，从而将微观势能与宏观可观测量联系起来 。",
            "id": "1894692",
            "problem": "一个用于描述一维晶格热膨胀的简单模型考虑了单个原子在非谐势中的运动。原子势能 $U(x)$ 作为其偏离平衡位置的位移 $x$ 的函数，由 $U(x) = \\frac{1}{2}kx^2 - \\frac{1}{3}\\gamma x^3$ 给出。其中，$k$ 是晶格键的有效弹性系数，$\\gamma$ 是一个小的正非谐性参数，用于解释原子间作用力的不对称性。原子与其周围环境处于热平衡状态，绝对温度为 $T$。由于非谐项的存在，原子的平均位置将不为零。\n\n假设非谐性很弱（即 $\\gamma$ 很小），计算原子的平均位移 $\\langle x \\rangle$。你的最终答案应为一个关于 $k$、$\\gamma$、$T$ 和玻尔兹曼常数 $k_B$ 的表达式，精确到 $\\gamma$ 的一阶。",
            "solution": "在温度 $T$ 下处于热平衡的原子具有玻尔兹曼加权的位置分布，其概率密度正比于 $\\exp(-\\beta U(x))$，其中 $\\beta = 1/(k_B T)$。热平均位移为\n$$\n\\langle x \\rangle = \\frac{\\int_{-\\infty}^{\\infty} x \\exp\\!\\left(-\\beta U(x)\\right)\\,\\mathrm{d}x}{\\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\beta U(x)\\right)\\,\\mathrm{d}x}, \\quad U(x) = \\frac{1}{2}k x^{2} - \\frac{1}{3}\\gamma x^{3}.\n$$\n引入缩写 $a = \\frac{1}{2}\\beta k$ 和 $b = \\frac{1}{3}\\beta \\gamma$。则\n$$\n-\\beta U(x) = -a x^{2} + b x^{3},\n$$\n对于弱非谐性（小 $\\gamma$），我们展开到 $\\gamma$ 的一阶：\n$$\n\\exp\\!\\left(-\\beta U(x)\\right) = \\exp(-a x^{2})\\exp(b x^{3}) \\approx \\exp(-a x^{2})\\left(1 + b x^{3}\\right) + \\mathcal{O}(\\gamma^{2}).\n$$\n到 $\\gamma$ 的一阶，分子和分母变为\n$$\nN \\equiv \\int_{-\\infty}^{\\infty} x \\exp\\!\\left(-\\beta U(x)\\right)\\,\\mathrm{d}x \\approx \\int_{-\\infty}^{\\infty} x \\exp(-a x^{2})\\,\\mathrm{d}x + b \\int_{-\\infty}^{\\infty} x^{4} \\exp(-a x^{2})\\,\\mathrm{d}x,\n$$\n$$\nZ \\equiv \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\beta U(x)\\right)\\,\\mathrm{d}x \\approx \\int_{-\\infty}^{\\infty} \\exp(-a x^{2})\\,\\mathrm{d}x + b \\int_{-\\infty}^{\\infty} x^{3} \\exp(-a x^{2})\\,\\mathrm{d}x.\n$$\n被积函数为奇函数的积分消失，所以\n$$\nN \\approx b \\int_{-\\infty}^{\\infty} x^{4} \\exp(-a x^{2})\\,\\mathrm{d}x, \\quad Z \\approx \\int_{-\\infty}^{\\infty} \\exp(-a x^{2})\\,\\mathrm{d}x.\n$$\n定义 $I(a) = \\int_{-\\infty}^{\\infty} \\exp(-a x^{2})\\,\\mathrm{d}x = \\sqrt{\\frac{\\pi}{a}}$。使用积分号下求导法，\n$$\nI'(a) = \\frac{\\mathrm{d}}{\\mathrm{d}a} \\int_{-\\infty}^{\\infty} \\exp(-a x^{2})\\,\\mathrm{d}x = -\\int_{-\\infty}^{\\infty} x^{2} \\exp(-a x^{2})\\,\\mathrm{d}x,\n$$\n$$\nI''(a) = \\int_{-\\infty}^{\\infty} x^{4} \\exp(-a x^{2})\\,\\mathrm{d}x.\n$$\n由 $I(a) = \\sqrt{\\pi}\\,a^{-1/2}$，我们得到\n$$\nI''(a) = \\frac{3\\sqrt{\\pi}}{4}a^{-5/2}, \\quad I(a) = \\sqrt{\\pi}\\,a^{-1/2}.\n$$\n因此，\n$$\n\\langle x \\rangle \\approx \\frac{N}{Z} = \\frac{b\\,I''(a)}{I(a)} = b \\cdot \\frac{\\frac{3\\sqrt{\\pi}}{4}a^{-5/2}}{\\sqrt{\\pi}\\,a^{-1/2}} = \\frac{3b}{4a^{2}}.\n$$\n代入 $a = \\frac{1}{2}\\beta k$ 和 $b = \\frac{1}{3}\\beta \\gamma$，\n$$\n\\langle x \\rangle = \\frac{3 \\left(\\frac{1}{3}\\beta \\gamma\\right)}{4 \\left(\\frac{1}{2}\\beta k\\right)^{2}} = \\frac{\\beta \\gamma}{\\beta^{2} k^{2}} = \\frac{\\gamma}{\\beta k^{2}} = \\frac{\\gamma k_B T}{k^{2}} + \\mathcal{O}(\\gamma^{2}).\n$$\n这是关于 $\\gamma$ 的一阶结果。",
            "answer": "$$\\boxed{\\frac{\\gamma k_B T}{k^{2}}}$$"
        },
        {
            "introduction": "在量子体系中，能量最低的基态并非在任何温度下都是布居数最多的能级。本练习将探讨分子转动能级的布居问题，揭示了倾向于低能级的玻尔兹曼因子与随着量子数 $J$ 增大的能级简并度 $(2J+1)$ 之间的竞争。通过推导最概然布居转动能级，你将深入理解温度如何调控分子谱带的结构 。",
            "id": "2811223",
            "problem": "一个异核双原子分子可以被建模为一个刚性转子，其转动能级由整数量子数 $J \\in \\{0,1,2,\\dots\\}$ 索引，能量为 $E_J = B\\,h\\,c\\,J(J+1)$，其中 $B$ 是以反厘米表示的转动常数，$h$ 是普朗克常数，$c$ 是光速。每个能级的转动简并度为 $g_J = 2J+1$。考虑一个处于绝对温度 $T$ 的正则系综，其玻尔兹曼常数为 $k_B$。\n\n仅从离散微观态的正则概率分配和简并度的存在出发，使用一个在高温区（此时布居数最多的 $J$ 很大）有效的可控连续近似，推导使能级布居数达到最大的转动量子数 $J^{\\ast}(T)$ 的渐近表达式。你的推导必须明确地考虑简并度因子 $g_J$，并且不得假定任何目标公式。最后，阐述与假设的非简并谱相比，包含 $g_J$ 如何改变了最大值位置对温度的依赖性。\n\n以 $B$、$h$、$c$、$k_B$ 和 $T$ 表示的单个闭合形式表达式给出 $J^{\\ast}(T)$ 的最终答案。不需要进行数值计算或四舍五入。由于 $J$ 是无量纲的，最终答案中不应报告单位。",
            "solution": "在温度为 $T$ 的正则系综中，转动能级 $J$ 的布居数（记为 $N_J$）与占据该能级的概率成正比。根据玻尔兹曼分布，此概率由能级的简并度 $g_J$ 和玻尔兹曼因子 $\\exp(-E_J / (k_B T))$ 的乘积给出。配分函数作为归一化常数，不影响最大值的位置，因此我们可以处理正比关系。\n因此，布居数 $N_J$ 正比于：\n$$\nN_J \\propto g_J \\exp\\left(-\\frac{E_J}{k_B T}\\right)\n$$\n问题给出了刚性转子的能级及其简并度的表达式：\n$$\nE_J = B\\,h\\,c\\,J(J+1)\n$$\n$$\ng_J = 2J+1\n$$\n其中 $J \\in \\{0, 1, 2, \\dots\\}$。将这些代入布居数表达式，得到：\n$$\nN_J \\propto (2J+1) \\exp\\left(-\\frac{B\\,h\\,c\\,J(J+1)}{k_B T}\\right)\n$$\n此表达式表示离散转动能级的相对布居数。为了找到使该布居数最大化的量子数 $J^{\\ast}$，我们遵循指令使用连续近似。这在高温极限下是有效的，此时热能 $k_B T$ 远大于转动能级间距，导致许多能级被布居，并且布居数最多的能级 $J^{\\ast}$ 也很大。因此，我们将 $J$ 视为一个连续的非负变量，并求函数 $N(J)$ 的最大值。\n\n为了简化微分过程，求 $N(J)$ 的自然对数的最大值是更方便的，因为对数是一个严格单调函数，其最大值将在相同的 $J$ 值处取得。令 $f(J) = \\ln(N(J))$。\n$$\nf(J) = \\ln\\left( (2J+1) \\exp\\left(-\\frac{B\\,h\\,c\\,J(J+1)}{k_B T}\\right) \\right) + C\n$$\n其中 $C$ 是一个比例常数。利用对数的性质：\n$$\nf(J) = \\ln(2J+1) - \\frac{B\\,h\\,c\\,J(J+1)}{k_B T} + C\n$$\n展开 $J$ 的二次项：\n$$\nf(J) = \\ln(2J+1) - \\frac{B\\,h\\,c}{k_B T}(J^2 + J) + C\n$$\n为了找到使该函数最大化的 $J$ 值（记为 $J^{\\ast}$），我们计算其关于 $J$ 的一阶导数并令其为零。\n$$\n\\frac{df(J)}{dJ} = \\frac{d}{dJ}\\left[ \\ln(2J+1) - \\frac{B\\,h\\,c}{k_B T}(J^2 + J) \\right]\n$$\n$$\n\\frac{df(J)}{dJ} = \\frac{2}{2J+1} - \\frac{B\\,h\\,c}{k_B T}(2J+1)\n$$\n令 $J = J^{\\ast}$ 处的导数为零：\n$$\n\\frac{2}{2J^{\\ast}+1} - \\frac{B\\,h\\,c}{k_B T}(2J^{\\ast}+1) = 0\n$$\n整理各项以求解 $J^{\\ast}$：\n$$\n\\frac{2}{2J^{\\ast}+1} = \\frac{B\\,h\\,c}{k_B T}(2J^{\\ast}+1)\n$$\n$$\n2 = \\frac{B\\,h\\,c}{k_B T}(2J^{\\ast}+1)^2\n$$\n$$\n(2J^{\\ast}+1)^2 = \\frac{2k_B T}{B\\,h\\,c}\n$$\n取正平方根，因为 $J$ 必须是非负的，因此 $2J^{\\ast}+1 > 0$：\n$$\n2J^{\\ast}+1 = \\sqrt{\\frac{2k_B T}{B\\,h\\,c}}\n$$\n最后，分离出 $J^{\\ast}$ 得到所需的表达式：\n$$\n2J^{\\ast} = \\sqrt{\\frac{2k_B T}{B\\,h\\,c}} - 1\n$$\n$$\nJ^{\\ast}(T) = \\frac{1}{2}\\sqrt{\\frac{2k_B T}{B\\,h\\,c}} - \\frac{1}{2}\n$$\n这也可以写成：\n$$\nJ^{\\ast}(T) = \\sqrt{\\frac{k_B T}{2B\\,h\\,c}} - \\frac{1}{2}\n$$\n这就是在高温连续近似下，对应于布居数最多能级的转动量子数的渐近表达式。\n\n问题还要求与假设的非简并谱进行比较。在这种情况下，简并度因子 $g_J$ 将是一个常数，在不失一般性的前提下，我们可以将其设为 1。那么布居函数将是：\n$$\nN_J' \\propto \\exp\\left(-\\frac{E_J}{k_B T}\\right) = \\exp\\left(-\\frac{B\\,h\\,c\\,J(J+1)}{k_B T}\\right)\n$$\n对于 $J \\ge 0$，指数的宗量是一个负的且单调递减的函数。因此，对于所有 $J \\ge 0$，$N_J'$ 是 $J$ 的一个严格递减函数。因此，最大布居数必然出现在可能的最低量子数，即 $J=0$ 处。因此，对于非简谱，布居数最多的能级始终是 $J^{\\ast}_{nd} = 0$，与温度无关。\n\n总而言之，正是因为包含了简并度因子 $g_J = 2J+1$，才导致存在一个量子数不为零的布居数最大能级。简并度随 $J$ 的增加而增加，有利于高能级，而玻尔兹曼因子则指数级下降，有利于低能级。这两个相反因素之间的竞争在 $J^{\\ast}(T) > 0$ 处产生一个最大值。因此，简并度因子将布居数最多能级的温度依赖性从一个常数（$J=0$）改变为一个在高温极限下随温度平方根增长的函数，$J^{\\ast}(T) \\propto \\sqrt{T}$。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{k_B T}{2B\\,h\\,c}} - \\frac{1}{2}}\n$$"
        },
        {
            "introduction": "理论与现代计算科学在此交汇。分子模拟在特定温度下能产生海量数据，但为每个新温度重新进行模拟是低效的。本练习介绍一种强大的技术——直方图重加权法（或称重要性采样），它展示了如何基于玻尔兹曼分布原理，对一个温度下的数据进行重加权，从而精确预测邻近温度下的物理性质，极大地节约了计算资源 。",
            "id": "4105407",
            "problem": "一种由自组装胶束团簇组成的复杂流体，使用分子动力学 (MD) 在温度 $T_1$ 的正则系综中进行模拟。从在 $T_1$ 下采样的 $M=8$ 个独立微观态中，您记录了每个微观态的能量 $\\{E_i\\}_{i=1}^{8}$ 和一个无量纲的结构可观测量 $A$，即 $\\{A_i\\}_{i=1}^{8}$。能量是相对于参考零点报告的，单位为玻尔兹曼常数 $k_B$ 乘以参考温度 $T_{\\mathrm{ref}}$，即对于给定的无量纲系数 $\\{c_i\\}$，有 $E_i = c_i k_B T_{\\mathrm{ref}}$。模拟条件和数据如下：\n- $T_1 = 300\\,\\mathrm{K}$，\n- $T_2 = 330\\,\\mathrm{K}$，\n- $T_{\\mathrm{ref}} = 300\\,\\mathrm{K}$，\n- $\\{c_i\\}_{i=1}^{8} = \\{0.5,\\,1.2,\\,-0.3,\\,0.8,\\,1.5,\\,0.0,\\,2.0,\\,-1.0\\}$，\n- $\\{A_i\\}_{i=1}^{8} = \\{0.62,\\,0.58,\\,0.80,\\,0.60,\\,0.55,\\,0.75,\\,0.50,\\,0.88\\}$。\n\n仅使用适用于复杂流体平衡统计力学和玻尔兹曼分布的第一性原理，推导一个解析表达式，说明如何通过重要性加权从在 $T_1$ 抽取的样本中估算正则期望值 $\\langle A \\rangle_{T_2}$。然后，应用您推导的表达式，为所提供的数据集计算 $\\langle A \\rangle_{T_2}$ 的数值估计。\n\n假设：在 $T_1$ 的采样是严格正则的，微观态是独立的，并且态密度在重要性重加权下适当地抵消。将最终答案表示为无量纲数，并将结果四舍五入至四位有效数字。",
            "solution": "该问题是有效的。它在科学上基于平衡统计力学的原理，特别是正则系综和使用重要性加权来重新分析模拟数据。该问题提法明确，为得到唯一解提供了所有必要的数据和假设。\n\n目标是使用从在不同温度 $T_1$ 下的正则模拟中采样的一组微观态，计算结构可观测量 $A$ 在目标温度 $T_2$ 下的正则期望值。这种技术被称为直方图重加权或重要性采样。\n\n首先，我们推导一般的解析表达式。在温度 $T$ 下，可观测量 $A$ 的正则期望值由相空间积分给出：\n$$\n\\langle A \\rangle_T = \\frac{\\int A(\\mathbf{x}) \\exp(-\\beta E(\\mathbf{x})) \\, d\\mathbf{x}}{\\int \\exp(-\\beta E(\\mathbf{x})) \\, d\\mathbf{x}}\n$$\n其中 $\\mathbf{x}$ 代表相空间中微观态的坐标，$E(\\mathbf{x})$ 是该微观态的能量，$\\beta = 1/(k_B T)$ 是逆温度，其中 $k_B$ 是玻尔兹曼常数。分母是配分函数 $Z(T)$。\n\n在计算模拟中，该积分通过对在给定温度下从平衡分布中采样的有限数量 $M$ 个微观态求和来近似。如果微观态 $\\{ \\mathbf{x}_i \\}_{i=1}^M$ 是根据温度 $T_1$（其中 $\\beta_1 = 1/(k_B T_1)$）下的玻尔兹曼概率分布 $P_1(\\mathbf{x}) \\propto \\exp(-\\beta_1 E(\\mathbf{x}))$ 采样的，那么在 $T_1$ 下的期望值是一个简单的算术平均值：\n$$\n\\langle A \\rangle_{T_1} \\approx \\frac{1}{M} \\sum_{i=1}^M A(\\mathbf{x}_i)\n$$\n为了估计在不同温度 $T_2$（其中 $\\beta_2 = 1/(k_B T_2)$）下的期望值 $\\langle A \\rangle_{T_2}$，我们不能使用简单的平均值，因为样本不是从概率分布 $P_2(\\mathbf{x}) \\propto \\exp(-\\beta_2 E(\\mathbf{x}))$ 生成的。相反，我们必须对每个样本进行重新加权以解释这种差异。我们可以通过在被积函数上同乘同除 $\\exp(-\\beta_1 E(\\mathbf{x}))$ 来重写 $\\langle A \\rangle_{T_2}$ 的表达式：\n$$\n\\langle A \\rangle_{T_2} = \\frac{\\int A(\\mathbf{x}) \\exp(-(\\beta_2 - \\beta_1)E(\\mathbf{x})) \\exp(-\\beta_1 E(\\mathbf{x})) \\, d\\mathbf{x}}{\\int \\exp(-(\\beta_2 - \\beta_1)E(\\mathbf{x})) \\exp(-\\beta_1 E(\\mathbf{x})) \\, d\\mathbf{x}}\n$$\n认识到项 $\\exp(-\\beta_1 E(\\mathbf{x})) \\, d\\mathbf{x}$ 对应于从 $T_1$ 的分布中采样，我们可以将积分近似为对 $M$ 个可用微观态的求和：\n$$\n\\langle A \\rangle_{T_2} \\approx \\frac{\\sum_{i=1}^M A_i \\exp(-(\\beta_2 - \\beta_1)E_i)}{\\sum_{i=1}^M \\exp(-(\\beta_2 - \\beta_1)E_i)}\n$$\n这就是所要求的解析表达式。项 $w_i = \\exp(-(\\beta_2 - \\beta_1)E_i)$ 是第 $i$ 个微观态的重要性权重。\n\n现在，我们将此表达式应用于所提供的数据集。给定的参数是：\n- $T_1 = 300\\,\\mathrm{K}$\n- $T_2 = 330\\,\\mathrm{K}$\n- $T_{\\mathrm{ref}} = 300\\,\\mathrm{K}$\n- 能量由 $E_i = c_i k_B T_{\\mathrm{ref}}$ 给出，其中 $\\{c_i\\}$ 是无量纲系数。\n\n让我们计算指数的参数 $-(\\beta_2 - \\beta_1)E_i$：\n$$\n-(\\beta_2 - \\beta_1)E_i = -\\left(\\frac{1}{k_B T_2} - \\frac{1}{k_B T_1}\\right) (c_i k_B T_{\\mathrm{ref}})\n$$\n玻尔兹曼常数 $k_B$ 被消掉了：\n$$\n-(\\beta_2 - \\beta_1)E_i = -c_i T_{\\mathrm{ref}}\\left(\\frac{1}{T_2} - \\frac{1}{T_1}\\right) = c_i T_{\\mathrm{ref}}\\left(\\frac{1}{T_1} - \\frac{1}{T_2}\\right) = c_i T_{\\mathrm{ref}}\\left(\\frac{T_2 - T_1}{T_1 T_2}\\right)\n$$\n代入温度的数值：\n$$\nT_{\\mathrm{ref}}\\left(\\frac{T_2 - T_1}{T_1 T_2}\\right) = 300\\,\\mathrm{K} \\left(\\frac{330\\,\\mathrm{K} - 300\\,\\mathrm{K}}{(300\\,\\mathrm{K})(330\\,\\mathrm{K})}\\right) = 300 \\left(\\frac{30}{99000}\\right) = \\frac{9000}{99000} = \\frac{1}{11}\n$$\n因此，每个微观态 $i$ 的加权因子是 $w_i = \\exp(c_i/11)$。期望值的估计变为：\n$$\n\\langle A \\rangle_{T_2} \\approx \\frac{\\sum_{i=1}^{8} A_i \\exp\\left(\\frac{c_i}{11}\\right)}{\\sum_{i=1}^{8} \\exp\\left(\\frac{c_i}{11}\\right)}\n$$\n我们现在使用给定的 $M=8$ 个微观态的数据来计算分子和分母：\n- $\\{c_i\\}_{i=1}^{8} = \\{0.5,\\,1.2,\\,-0.3,\\,0.8,\\,1.5,\\,0.0,\\,2.0,\\,-1.0\\}$\n- $\\{A_i\\}_{i=1}^{8} = \\{0.62,\\,0.58,\\,0.80,\\,0.60,\\,0.55,\\,0.75,\\,0.50,\\,0.88\\}$\n\n首先，我们计算权重 $w_i = \\exp(c_i/11)$：\n- $w_1 = \\exp(0.5/11) \\approx 1.046500$\n- $w_2 = \\exp(1.2/11) \\approx 1.115273$\n- $w_3 = \\exp(-0.3/11) \\approx 0.973094$\n- $w_4 = \\exp(0.8/11) \\approx 1.075440$\n- $w_5 = \\exp(1.5/11) \\approx 1.146101$\n- $w_6 = \\exp(0.0/11) = 1.0$\n- $w_7 = \\exp(2.0/11) \\approx 1.199399$\n- $w_8 = \\exp(-1.0/11) \\approx 0.913101$\n\n分母是这些权重的总和：\n$$\n\\sum_{i=1}^{8} w_i \\approx 1.046500 + 1.115273 + 0.973094 + 1.075440 + 1.146101 + 1.0 + 1.199399 + 0.913101 \\approx 8.468908\n$$\n接下来，我们为分子计算各项 $A_i w_i$：\n- $A_1 w_1 \\approx 0.62 \\times 1.046500 = 0.648830$\n- $A_2 w_2 \\approx 0.58 \\times 1.115273 = 0.646858$\n- $A_3 w_3 \\approx 0.80 \\times 0.973094 = 0.778475$\n- $A_4 w_4 \\approx 0.60 \\times 1.075440 = 0.645264$\n- $A_5 w_5 \\approx 0.55 \\times 1.146101 = 0.630356$\n- $A_6 w_6 = 0.75 \\times 1.0 = 0.750000$\n- $A_7 w_7 \\approx 0.50 \\times 1.199399 = 0.599700$\n- $A_8 w_8 \\approx 0.88 \\times 0.913101 = 0.803529$\n\n分子是这些项的总和：\n$$\n\\sum_{i=1}^{8} A_i w_i \\approx 0.648830 + 0.646858 + 0.778475 + 0.645264 + 0.630356 + 0.750000 + 0.599700 + 0.803529 \\approx 5.503012\n$$\n最后，我们计算比率以找到 $\\langle A \\rangle_{T_2}$ 的估计值：\n$$\n\\langle A \\rangle_{T_2} \\approx \\frac{5.503012}{8.468908} \\approx 0.649796\n$$\n按照要求将结果四舍五入到四位有效数字，我们得到 $0.6498$。",
            "answer": "$$\\boxed{0.6498}$$"
        }
    ]
}