{
    "hands_on_practices": [
        {
            "introduction": "进行布朗动力学模拟的第一步是将连续的朗之万方程转化为计算机可以执行的离散更新规则。这个练习将向您介绍最基础的数值积分方案——欧拉-丸山（Euler-Maruyama）方法。通过这个练习，您将掌握该方法的基本形式，并理解其作为数值方案的准确性，这通常通过其强收敛和弱收敛阶来衡量 。",
            "id": "4080292",
            "problem": "考虑一个浸没在复杂流体中的胶体粒子，在过阻尼假设下，其布朗动力学 (BD) 由以下伊東（Itô）意义下的随机微分方程建模：\n$$\n\\mathrm{d}\\mathbf{r}(t) = \\mu\\,\\mathbf{F}(\\mathbf{r}(t))\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}\\mathbf{W}(t),\n$$\n其中 $\\mathbf{r}(t)$ 是位置，$\\mu$ 是一个恒定的迁移率，$\\mathbf{F}(\\mathbf{r})$ 是确定性力，$D$ 是扩散系数，通过爱因斯坦关系 $D = k_B T\\,\\mu$ 与迁移率相关，$\\mathbf{W}(t)$ 是一个具有独立笛卡尔分量的维纳过程。给定一个均匀时间步长 $\\Delta t > 0$，并定义 $\\Delta \\mathbf{W}_n = \\mathbf{W}(t_{n+1}) - \\mathbf{W}(t_n)$，其中 $t_n = n\\,\\Delta t$；$\\Delta \\mathbf{W}_n$ 的每个分量都服从 $\\mathcal{N}(0,\\Delta t)$ 分布，并且可以写成 $\\Delta \\mathbf{W}_n = \\sqrt{\\Delta t}\\,\\boldsymbol{\\eta}_n$，其中 $\\boldsymbol{\\eta}_n$ 的分量是独立同分布的标准正态随机变量 $\\mathcal{N}(0,1)$。\n\n在 $\\mathbf{F}$ 满足标准光滑性和 Lipschitz 条件下，哪个选项正确地给出了此过阻尼朗之万方程的单步 Euler-Maruyama (EM) 更新格式，并同时正确地指出了该格式的强收敛阶和弱收敛阶？\n\nA. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$；强收敛阶 $1/2$，弱收敛阶 $1$。\n\nB. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D}\\,\\boldsymbol{\\eta}_n$；强收敛阶 $1$，弱收敛阶 $1$。\n\nC. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_{n+1})\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$；强收敛阶 $1/2$，弱收敛阶 $1$。\n\nD. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D}\\,\\Delta t\\,\\boldsymbol{\\eta}_n$；强收敛阶 $1/2$，弱收敛阶 $1$。\n\nE. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$；强收敛阶 $1$，弱收敛阶 $1$。",
            "solution": "用户要求对问题陈述进行严格验证，然后推导解决方案并评估所提供的选项。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- 控制方程是伊東（Itô）意义下的过阻尼朗之万方程：\n$$\n\\mathrm{d}\\mathbf{r}(t) = \\mu\\,\\mathbf{F}(\\mathbf{r}(t))\\,\\mathrm{d}t + \\sqrt{2D}\\,\\mathrm{d}\\mathbf{W}(t)\n$$\n- $\\mathbf{r}(t)$：粒子位置矢量。\n- $\\mu$：一个恒定的迁移率。\n- $\\mathbf{F}(\\mathbf{r})$：一个确定性力。\n- $D$：一个扩散系数。\n- $\\mathbf{W}(t)$：一个具有独立笛卡尔分量的维纳过程。\n- 爱因斯坦关系成立：$D = k_B T\\,\\mu$。\n- 时间步长是均匀的，$\\Delta t > 0$。\n- 时间离散化为 $t_n = n\\,\\Delta t$。\n- 维纳过程增量为 $\\Delta \\mathbf{W}_n = \\mathbf{W}(t_{n+1}) - \\mathbf{W}(t_n)$。\n- $\\Delta \\mathbf{W}_n$ 的每个分量都是一个正态随机变量 $\\mathcal{N}(0,\\Delta t)$。\n- 该增量可以表示为 $\\Delta \\mathbf{W}_n = \\sqrt{\\Delta t}\\,\\boldsymbol{\\eta}_n$，其中 $\\boldsymbol{\\eta}_n$ 的分量是独立同分布的标准正态随机变量 $\\mathcal{N}(0,1)$。\n- 问题要求给出正确的 Euler-Maruyama (EM) 更新规则及其强收敛阶和弱收敛阶。\n- 为了进行收敛性分析，问题假设 $\\mathbf{F}$ 满足“标准光滑性和 Lipschitz 条件”。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题提出了标准的过阻尼朗之万方程，这是统计力学中描述粒子布朗运动的一个基本模型。所有定义，包括维纳过程的性质和爱因斯坦关系，在计算物理和计算化学领域都是科学正确和标准的。\n- **良定性**：该问题是良定的。它要求针对一个给定的随机微分方程（SDE）给出一个特定的标准数值积分格式（Euler-Maruyama），并说明其已知的收敛性质。这是一个在数值 SDE 既定理论中没有歧义且有唯一正确答案的问题。\n- **客观性**：该问题以精确、客观的数学语言陈述。\n- **一致性和完整性**：该问题是自洽的。它提供了 SDE、所有术语的定义、随机过程的性质以及背景（数值积分）。提及“标准光滑性和 Lipschitz 条件”是讨论收敛阶的正确且必要的背景。\n\n**步骤3：结论与行动**\n问题陈述是有效的。它在科学上是合理的、良定的、客观且完整的。我将继续推导解决方案。\n\n**解的推导**\n\n该问题要求给出给定 SDE 的 Euler-Maruyama (EM) 离散化格式以及相应的收敛阶。\n\n**1. Euler-Maruyama 格式的推导**\n\n过阻尼朗之万方程是一种一般形式的伊東 SDE：\n$$\n\\mathrm{d}\\mathbf{X}(t) = \\mathbf{a}(\\mathbf{X}(t), t)\\,\\mathrm{d}t + \\mathbf{b}(\\mathbf{X}(t), t)\\,\\mathrm{d}\\mathbf{W}(t)\n$$\n在我们特定的情况下，$\\mathbf{X}(t) = \\mathbf{r}(t)$，漂移系数为 $\\mathbf{a}(\\mathbf{r}) = \\mu\\,\\mathbf{F}(\\mathbf{r})$，扩散系数为一个常数矩阵 $\\mathbf{b} = \\sqrt{2D}\\,\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位矩阵。\n\nSDE 在时间区间 $[t_n, t_{n+1}]$ 上的积分形式为：\n$$\n\\mathbf{r}(t_{n+1}) - \\mathbf{r}(t_n) = \\int_{t_n}^{t_{n+1}} \\mu\\,\\mathbf{F}(\\mathbf{r}(s))\\,\\mathrm{d}s + \\int_{t_n}^{t_{n+1}} \\sqrt{2D}\\,\\mathrm{d}\\mathbf{W}(s)\n$$\nEuler-Maruyama 方法通过近似这些积分来逼近解 $\\mathbf{r}(t_{n+1})$（记为 $\\mathbf{r}_{n+1}$）。\n- 确定性（黎曼）积分通过在区间起点 $t_n$ 处计算被积函数的值来近似：\n$$\n\\int_{t_n}^{t_{n+1}} \\mu\\,\\mathbf{F}(\\mathbf{r}(s))\\,\\mathrm{d}s \\approx \\mu\\,\\mathbf{F}(\\mathbf{r}(t_n))\\,(t_{n+1} - t_n) = \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t\n$$\n- 随机（伊東）积分有一个精确值：\n$$\n\\int_{t_n}^{t_{n+1}} \\sqrt{2D}\\,\\mathrm{d}\\mathbf{W}(s) = \\sqrt{2D}\\,(\\mathbf{W}(t_{n+1}) - \\mathbf{W}(t_n)) = \\sqrt{2D}\\,\\Delta \\mathbf{W}_n\n$$\n结合这些近似，得到 EM 更新规则：\n$$\n\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D}\\,\\Delta \\mathbf{W}_n\n$$\n使用给定的关系 $\\Delta \\mathbf{W}_n = \\sqrt{\\Delta t}\\,\\boldsymbol{\\eta}_n$，我们可以重写随机项：\n$$\n\\sqrt{2D}\\,\\Delta \\mathbf{W}_n = \\sqrt{2D}\\,\\sqrt{\\Delta t}\\,\\boldsymbol{\\eta}_n = \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n\n$$\n因此，Euler-Maruyama 更新规则的最终形式是：\n$$\n\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n\n$$\n\n**2. 收敛阶**\n\n对于一个 SDE 数值格式，有两个主要的收敛概念：\n- **强收敛**：这衡量了路径近似的误差。如果一个格式在固定时间 $T$ 的平均绝对误差有界于 $C\\,(\\Delta t)^p$，即 $E[|\\mathbf{r}(T) - \\mathbf{r}_N|] \\le C\\,(\\Delta t)^p$，其中 $N = T/\\Delta t$，则该格式的强收敛阶为 $p$。对于 Euler-Maruyama 格式，在漂移和扩散系数满足标准的 Lipschitz 和线性增长条件下，其强收敛阶为 $p=1/2$。\n- **弱收敛**：这衡量了在近似解的函数期望时的误差。如果对于一类足够光滑的检验函数 $g$，期望的误差有界于 $C\\,(\\Delta t)^q$，即 $|E[g(\\mathbf{r}(T))] - E[g(\\mathbf{r}_N)]| \\le C\\,(\\Delta t)^q$，则该格式的弱收敛阶为 $q$。对于 Euler-Maruyama 格式，在系数和检验函数满足额外光滑性条件下，其弱收敛阶为 $q=1$。\n\n因此，给定 SDE 的 EM 格式具有 $1/2$ 的强收敛阶和 $1$ 的弱收敛阶。\n\n**逐项分析**\n\n- **A. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$；强收敛阶 $1/2$，弱收敛阶 $1$。**\n  - 更新规则与我们为 Euler-Maruyama 格式推导的表达式相匹配。\n  - 所述的强收敛阶（$1/2$）和弱收敛阶（$1$）是 EM 格式的正确标准值。\n  - **结论**：正确。\n\n- **B. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D}\\,\\boldsymbol{\\eta}_n$；强收敛阶 $1$，弱收敛阶 $1$。**\n  - 更新规则不正确。随机项 $\\sqrt{2D}\\,\\boldsymbol{\\eta}_n$ 缺少因子 $\\sqrt{\\Delta t}$。正确的项是 $\\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$。这也使得方程在量纲上不一致。\n  - 所述的强收敛阶 $1$ 对于 EM 格式是不正确的。\n  - **结论**：不正确。\n\n- **C. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_{n+1})\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$；强收敛阶 $1/2$，弱收敛阶 $1$。**\n  - 更新规则不正确。它代表一个*隐式*格式，因为 $\\mathbf{r}_{n+1}$ 出现在方程的两边（在 $\\mathbf{F}$ 的参数中）。标准的 Euler-Maruyama 格式是一个*显式*（或前向）格式，其右侧仅依赖于 $\\mathbf{r}_n$。\n  - **结论**：不正确。\n\n- **D. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D}\\,\\Delta t\\,\\boldsymbol{\\eta}_n$；强收敛阶 $1/2$，弱收敛阶 $1$。**\n  - 更新规则不正确。随机项是 $\\sqrt{2D}\\,\\Delta t\\,\\boldsymbol{\\eta}_n$。时间步长应以 $\\sqrt{\\Delta t}$ 出现，而不是 $\\Delta t$。正确的缩放是 $\\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$。该项在量纲上也不一致。\n  - **结论**：不正确。\n\n- **E. $\\mathbf{r}_{n+1} = \\mathbf{r}_n + \\mu\\,\\mathbf{F}(\\mathbf{r}_n)\\,\\Delta t + \\sqrt{2D\\,\\Delta t}\\,\\boldsymbol{\\eta}_n$；强收敛阶 $1$，弱收敛阶 $1$。**\n  - 如在对选项 A 的分析中所确定的，更新规则是正确的。\n  - 然而，所述的强收敛阶 $1$ 是不正确的。EM 格式的强收敛阶是 $1/2$。\n  - **结论**：不正确。\n\n根据分析，只有选项 A 同时提供了 Euler-Maruyama 更新规则的正确形式以及正确的强、弱收敛阶。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在拥有数值积分方案后，我们必须确保模拟是稳定的，不会产生无意义的、发散的结果。这个练习通过分析一个在物理学中无处不在的基础模型——谐振子势中的粒子，来探讨数值稳定性的关键概念。我们将推导出在模拟“爆炸”之前可以使用的最大允许时间步长，这是在任何模拟中都至关重要的实践技能 。",
            "id": "4080331",
            "problem": "考虑一个在一维谐波势阱（劲度系数为 $k$）中，温度为 $T$ 的胶体粒子，其运动由过阻尼布朗动力学（BD）模型描述。其过阻尼朗之万方程为\n$$\n\\gamma \\,\\frac{dx}{dt} \\,=\\, -k\\,x \\,+\\, \\sqrt{2\\,\\gamma\\,k_{B}\\,T}\\,\\eta(t),\n$$\n其中 $\\gamma$ 是摩擦系数，$k_{B}$ 是玻尔兹曼常数，而 $\\eta(t)$ 是具有零均值和单位狄拉克δ相关性的高斯白噪声。使用步长为 $\\Delta t$ 的欧拉-丸山（EM）时间步进法对 $x(t)$ 进行离散化。从给定的随机微分方程和欧拉-丸山离散化的定义出发，通过线性均方稳定性分析，推导出保证当 $n \\to \\infty$ 时数值解的二阶矩 $\\mathbb{E}[x_{n}^{2}]$ 保持有界的关于 $\\Delta t$ 的充分必要条件。然后，对于一个摩擦系数为 $\\gamma = 9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}}$、在劲度系数为 $k = 0.05\\,\\mathrm{N\\,m^{-1}}$ 的势阱中的胶体粒子，根据此稳定性条件估算欧拉-丸山法的最大稳定时间步长 $\\Delta t_{\\max}$。\n\n请将 $\\Delta t_{\\max}$ 的最终数值答案以秒为单位表示，并四舍五入到 $3$ 位有效数字。",
            "solution": "用户想要解决这个问题。我需要先验证它。\n\n### 步骤 1：提取已知条件\n-   **系统**：一个一维过阻尼布朗动力学（BD）模型。\n-   **势能**：劲度系数为 $k$ 的谐波势，$U(x) = \\frac{1}{2}kx^2$。\n-   **温度**：$T$。\n-   **控制方程**：给定的过阻尼朗之万方程为\n    $$\n    \\gamma \\,\\frac{dx}{dt} \\,=\\, -k\\,x \\,+\\, \\sqrt{2\\,\\gamma\\,k_{B}\\,T}\\,\\eta(t)\n    $$\n-   **参数**：\n    -   $\\gamma$ 是摩擦系数。\n    -   $k_B$ 是玻尔兹曼常数。\n    -   $\\eta(t)$ 是高斯白噪声，其均值为零（$\\langle\\eta(t)\\rangle = 0$），且具有狄拉克δ相关性（$\\langle\\eta(t)\\eta(t')\\rangle = \\delta(t-t')$）。\n-   **数值方法**：时间步长为 $\\Delta t$ 的欧拉-丸山（EM）法。\n-   **任务 1**：推导一个关于 $\\Delta t$ 的充分必要条件，以保证当 $n \\to \\infty$ 时数值解的二阶矩 $\\mathbb{E}[x_{n}^{2}]$ 保持有界。这是一个线性均方稳定性分析。\n-   **任务 2**：对于一个摩擦系数为 $\\gamma = 9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}}$、劲度系数为 $k = 0.05\\,\\mathrm{N\\,m^{-1}}$ 的胶体粒子，估算最大稳定时间步长 $\\Delta t_{\\max}$。\n-   **取整**：$\\Delta t_{\\max}$ 的最终数值答案应四舍五入到 $3$ 位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它用适当的随机微分方程（SDE）描述了一个标准的物理系统（谐波势阱中的胶体粒子）。任务涉及一个标准的数值稳定性分析（欧拉-丸山法的均方稳定性），这是一个定义明确的数学过程。所有参数都有明确定义，给定的数值在物理上是合理的。没有矛盾、歧义或违反科学原理的地方。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。我将继续进行解答。\n\n给定的过阻尼朗之万方程是：\n$$\n\\gamma \\frac{dx}{dt} = -kx + \\sqrt{2\\gamma k_B T} \\eta(t)\n$$\n其中 $\\eta(t)$ 表示高斯白噪声。该方程可以改写为标准的伊藤（Itô）随机微分方程（SDE）形式：\n$$\ndx(t) = -\\frac{k}{\\gamma} x(t) dt + \\sqrt{\\frac{2k_B T}{\\gamma}} dW(t)\n$$\n这里，$dW(t) = \\eta(t) dt$ 表示维纳过程 $W(t)$ 的增量，其性质为 $\\mathbb{E}[dW(t)] = 0$ 和 $(dW(t))^2 = dt$。对于离散时间步长 $\\Delta t$，维纳增量 $\\Delta W_n = W(t_{n+1}) - W(t_n)$ 是一个高斯随机变量，其均值为 $\\mathbb{E}[\\Delta W_n] = 0$，方差为 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$。\n\n此 SDE 的欧拉-丸山（EM）离散化给出了将粒子位置从时间步 $n$ 更新到 $n+1$ 的规则：\n$$\nx_{n+1} = x_n + \\left(-\\frac{k}{\\gamma} x_n\\right) \\Delta t + \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n\n$$\n其中 $x_n = x(n\\Delta t)$。重新整理各项，我们得到：\n$$\nx_{n+1} = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) x_n + \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n\n$$\n我们关心的是二阶矩 $\\mathbb{E}[x_n^2]$ 的稳定性。让我们计算 $x_{n+1}$ 平方的期望值：\n$$\n\\mathbb{E}[x_{n+1}^2] = \\mathbb{E}\\left[ \\left( \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) x_n + \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n \\right)^2 \\right]\n$$\n展开平方项得到：\n$$\n\\mathbb{E}[x_{n+1}^2] = \\mathbb{E}\\left[ \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2 x_n^2 + 2\\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) x_n \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n + \\left(\\frac{2k_B T}{\\gamma}\\right) (\\Delta W_n)^2 \\right]\n$$\n利用期望算子的线性性质：\n$$\n\\mathbb{E}[x_{n+1}^2] = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2 \\mathbb{E}[x_n^2] + 2\\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) \\sqrt{\\frac{2k_B T}{\\gamma}} \\mathbb{E}[x_n \\Delta W_n] + \\frac{2k_B T}{\\gamma} \\mathbb{E}[(\\Delta W_n)^2]\n$$\n系统在时间 $n\\Delta t$ 的状态 $x_n$ 取决于该时刻之前的随机力历史。维纳增量 $\\Delta W_n$ 对应于区间 $[n\\Delta t, (n+1)\\Delta t]$，并且与 $x_n$ 在统计上是独立的。因此，交叉项的期望可以分离：\n$$\n\\mathbb{E}[x_n \\Delta W_n] = \\mathbb{E}[x_n] \\mathbb{E}[\\Delta W_n]\n$$\n由于 $\\mathbb{E}[\\Delta W_n] = 0$，交叉项为零：$\\mathbb{E}[x_n \\Delta W_n] = 0$。\n此外，我们有 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$。将这些结果代回，我们得到关于二阶矩的递推关系，记为 $y_n = \\mathbb{E}[x_n^2]$：\n$$\ny_{n+1} = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2 y_n + \\frac{2k_B T \\Delta t}{\\gamma}\n$$\n这是一个形如 $y_{n+1} = A y_n + B$ 的线性递推关系，其中放大因子为 $A = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2$，常数项为 $B = \\frac{2k_B T \\Delta t}{\\gamma}$。为了使序列 $\\{y_n\\}$ 在 $n \\to \\infty$ 时对于任何初始条件都保持有界，放大因子的绝对值必须严格小于 $1$：\n$$\n|A|  1\n$$\n由于 $A$ 是一个平方项，它总是非负的（$A \\ge 0$），因此条件简化为 $A  1$：\n$$\n\\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2  1\n$$\n两边取平方根，得到：\n$$\n\\left|1 - \\frac{k\\Delta t}{\\gamma}\\right|  1\n$$\n这个绝对值不等式等价于复合不等式：\n$$\n-1  1 - \\frac{k\\Delta t}{\\gamma}  1\n$$\n我们分别求解这两个不等式。\n$1$. $1 - \\frac{k\\Delta t}{\\gamma}  1 \\implies -\\frac{k\\Delta t}{\\gamma}  0$。由于 $k$、$\\gamma$ 和 $\\Delta t$ 都是内禀的正物理量，这部分不等式总是成立的。\n$2$. $-1  1 - \\frac{k\\Delta t}{\\gamma} \\implies \\frac{k\\Delta t}{\\gamma}  2$。\n\n结合两部分，二阶矩保持有界的充分必要条件是：\n$$\n\\frac{k\\Delta t}{\\gamma}  2\n$$\n这可以表示为关于时间步长 $\\Delta t$ 的条件：\n$$\n\\Delta t  \\frac{2\\gamma}{k}\n$$\n这就是推导出的稳定性条件。最大稳定时间步长 $\\Delta t_{\\max}$ 是这个区间的上确界：\n$$\n\\Delta t_{\\max} = \\frac{2\\gamma}{k}\n$$\n现在，我们代入给定的数值：$\\gamma = 9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}}$ 和 $k = 0.05\\,\\mathrm{N\\,m^{-1}}$。$k$ 的单位等价于 $\\mathrm{kg\\,s^{-2}}$。\n$$\n\\Delta t_{\\max} = \\frac{2 \\times (9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}})}{0.05\\,\\mathrm{kg\\,s^{-2}}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{1.884 \\times 10^{-9}}{0.05}\\,\\mathrm{s} = \\frac{1.884 \\times 10^{-9}}{5 \\times 10^{-2}}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = 0.3768 \\times 10^{-7}\\,\\mathrm{s} = 3.768 \\times 10^{-8}\\,\\mathrm{s}\n$$\n问题要求将答案四舍五入到 $3$ 位有效数字。\n$$\n\\Delta t_{\\max} \\approx 3.77 \\times 10^{-8}\\,\\mathrm{s}\n$$",
            "answer": "$$\\boxed{3.77 \\times 10^{-8}}$$"
        },
        {
            "introduction": "为了使我们的模拟具有真正的预测能力，其参数必须植根于物理现实。最后的这个练习旨在连接模拟与实验，指导您完成一个专业的科学工作流程来校准扩散系数。您将学习如何结合来自粒子追踪数据和物理参数测量（如温度和粘度）的信息，从而获得一个稳健的估计值，并对其不确定性进行量化 。",
            "id": "4080280",
            "problem": "考虑介观粒子在静态流体中的过阻尼运动，该运动通过一种称为布朗动力学（BD）的随机动力学模型进行建模。BD描述基于郎之万方程，其中摩擦阻力与随机热力及任何确定性力相平衡。在过阻尼极限下，速度瞬时弛豫，因此观测到的构型增量直接由热涨落驱动。实验性的单粒子追踪技术以均匀的采样间隔，提供粒子在一维、二维或三维空间中位置的离散时间观测数据。计算性的BD模拟必须选择一个扩散系数，以使模拟的均方位移与实验值相匹配，同时要考虑到实验估计量和物理参数中的不确定性。你的任务是从与计算复杂流体相关的基本定律和定义出发，推导出一个有原则的估计和不确定性传播方案，该方案应：\n\n1. 使用离散时间增量，构建一个与在采样间隔$\\Delta t$下$d$维自由扩散的BD模型兼容的平移扩散系数的统计最优估计量。\n2. 根据爱因斯坦关系式，使用具有不确定性的温度、粘度和粒径测量值，提供一个物理上合理的独立扩散系数估计，并将其不确定性传播至扩散系数。\n3. 将这两个独立的信息来源组合成一个用于BD模拟的校准扩散系数，并附带一个$95\\%$的覆盖区间，用以量化校准中的不确定性。\n\n推导过程必须从第一性原理和经过充分检验的事实出发，不预设目标公式。最终的程序必须实现你的方案，并为指定的测试集生成数值输出，所有扩散系数结果均以$\\mathrm{m}^2/\\mathrm{s}$为单位表示。不涉及任何角度。程序应使用固定的种子生成其自身用于不确定性传播的随机样本，并且不应要求用户任何输入。\n\n假设使用以下测试集。每个测试案例提供空间维度$d$、增量数量$N$（等于时间步数）、采样间隔$\\Delta t$（单位：秒），以及在所有分量和时间步上观测到的平方增量总和$S$（单位：$\\mathrm{m}^2$）。此外，每个案例还指定了球形颗粒的物理参数：温度$T$（单位：开尔文）、动态粘度$\\eta$（单位：帕斯卡·秒）和半径$a$（单位：米），每个参数都带有由均值和标准差表征的高斯测量不确定性。玻尔兹曼常数$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}/\\mathrm{K}$。为确保物理上的正值，将任何$T$、$\\eta$和$a$的高斯样本在一个小的正阈值处截断（例如，$\\eta$和$a$为$10^{-12}$，$T$为$1$）。\n\n测试案例：\n\n- 案例A（通用，二维，长轨迹）：\n  - $d = 2$\n  - $N = 1000$\n  - $\\Delta t = 0.01\\ \\mathrm{s}$\n  - $S = 1.65 \\times 10^{-11}\\ \\mathrm{m}^2$\n  - $T$ 均值 $= 298\\ \\mathrm{K}$，$T$ 标准差 $= 1.0\\ \\mathrm{K}$\n  - $\\eta$ 均值 $= 1.0 \\times 10^{-3}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$，$\\eta$ 标准差 $= 5.0 \\times 10^{-5}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$\n  - $a$ 均值 $= 5.0 \\times 10^{-7}\\ \\mathrm{m}$，$a$ 标准差 $= 5.0 \\times 10^{-8}\\ \\mathrm{m}$\n\n- 案例B（三维，中等长度轨迹）：\n  - $d = 3$\n  - $N = 300$\n  - $\\Delta t = 0.05\\ \\mathrm{s}$\n  - $S = 8.7 \\times 10^{-12}\\ \\mathrm{m}^2$\n  - $T$ 均值 $= 310\\ \\mathrm{K}$，$T$ 标准差 $= 2.0\\ \\mathrm{K}$\n  - $\\eta$ 均值 $= 2.0 \\times 10^{-3}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$，$\\eta$ 标准差 $= 1.0 \\times 10^{-4}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$\n  - $a$ 均值 $= 1.2 \\times 10^{-6}\\ \\mathrm{m}$，$a$ 标准差 $= 1.0 \\times 10^{-7}\\ \\mathrm{m}$\n\n- 案例C（二维，短轨迹，高物理参数不确定性）：\n  - $d = 2$\n  - $N = 20$\n  - $\\Delta t = 0.1\\ \\mathrm{s}$\n  - $S = 1.4 \\times 10^{-11}\\ \\mathrm{m}^2$\n  - $T$ 均值 $= 295\\ \\mathrm{K}$，$T$ 标准差 $= 3.0\\ \\mathrm{K}$\n  - $\\eta$ 均值 $= 8.0 \\times 10^{-4}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$，$\\eta$ 标准差 $= 2.0 \\times 10^{-4}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$\n  - $a$ 均值 $= 3.0 \\times 10^{-7}\\ \\mathrm{m}$，$a$ 标准差 $= 5.0 \\times 10^{-8}\\ \\mathrm{m}$\n\n基于你的推导，实现以下内容：\n\n- 根据增量数据$(d, N, \\Delta t, S)$，构建一个扩散系数的估计量，并关联一个不确定性度量，用于量化该估计量在有限$N$下的方差。\n- 根据带有明确不确定性的$(T, \\eta, a)$，生成一个大小至少为$100{,}000$的物理上合理的参数三元组的蒙特卡洛样本，并使用球形颗粒的爱因斯坦关系式计算相应的扩散系数。通过计算扩散系数的样本均值和标准差来传播不确定性。\n- 假设两个估计在统计上是独立的且近似服从高斯分布，将它们组合成一个单一的校准扩散系数，并附带一个表示为$[\\text{lower}, \\text{upper}]$（单位：$\\mathrm{m}^2/\\mathrm{s}$）的$95\\%$覆盖区间。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试案例的结果是一个包含三个浮点数的列表$[\\widehat{D}_{\\mathrm{BD}}, \\text{lower}, \\text{upper}]$，单位为$\\mathrm{m}^2/\\mathrm{s}$。例如：[[valueA1,valueA2,valueA3],[valueB1,valueB2,valueB3],[valueC1,valueC2,valueC3]]。",
            "solution": "该问题要求推导并实现一个协议，用于确定布朗动力学（BD）模拟的校准扩散系数。这涉及将来自实验轨迹数据的估计与源自物理参数的独立估计相结合，同时恰当地考虑和传播不确定性。推导过程分三个阶段进行。\n\n### 1. 从轨迹数据估计扩散系数\n\n在过阻尼极限下，一个进行自由布朗运动的粒子的运动由郎之万方程描述。在没有外部确定性力的情况下，该方程简化为 $\\zeta \\frac{d\\mathbf{r}}{dt} = \\mathbf{F}_{\\text{rand}}(t)$，其中$\\mathbf{r}(t)$是粒子在$d$维空间中的位置矢量，$\\zeta$是摩擦系数，$\\mathbf{F}_{\\text{rand}}(t)$是代表周围流体随机热力的高斯白噪声项。随机力的均值为零，$\\langle \\mathbf{F}_{\\text{rand}}(t) \\rangle = \\mathbf{0}$，其分量在时间和空间上不相关，其幅度由涨落-耗散定理设定：$\\langle F_{\\text{rand},i}(t) F_{\\text{rand},j}(t') \\rangle = 2k_{\\mathrm{B}}T\\zeta \\delta_{ij} \\delta(t-t')$，其中$k_{\\mathrm{B}}$是玻尔兹曼常数，$T$是绝对温度，$\\delta_{ij}$和$\\delta(t-t')$分别是克罗内克δ函数和狄拉克δ函数。\n\n在一个小的离散时间步$\\Delta t$上进行一阶数值积分（欧拉-丸山格式），得到位置增量：\n$$ \\Delta \\mathbf{r}_k = \\mathbf{r}((k+1)\\Delta t) - \\mathbf{r}(k\\Delta t) = \\frac{1}{\\zeta} \\int_{k\\Delta t}^{(k+1)\\Delta t} \\mathbf{F}_{\\text{rand}}(t') dt' $$\n对于每个空间分量$i \\in \\{1, \\dots, d\\}$，增量$\\Delta r_{k,i}$是一个高斯随机变量。其均值为$\\langle \\Delta r_{k,i} \\rangle = 0$。其方差为：\n$$ \\langle (\\Delta r_{k,i})^2 \\rangle = \\frac{1}{\\zeta^2} \\int_{k\\Delta t}^{(k+1)\\Delta t} \\int_{k\\Delta t}^{(k+1)\\Delta t} \\langle F_{\\text{rand},i}(t') F_{\\text{rand},i}(t'') \\rangle dt' dt'' = \\frac{2k_{\\mathrm{B}}T}{\\zeta} \\int_{k\\Delta t}^{(k+1)\\Delta t} dt' = \\frac{2k_{\\mathrm{B}}T}{\\zeta} \\Delta t $$\n使用平移扩散系数的定义 $D = k_{\\mathrm{B}}T / \\zeta$，方差简化为：\n$$ \\langle (\\Delta r_{k,i})^2 \\rangle = 2D\\Delta t $$\n给定$N$个独立的时间步，我们观测到$dN$个独立的标量增量$\\Delta r_{k,i}$，每个都从正态分布$\\mathcal{N}(0, 2D\\Delta t)$中抽取。单个增量的概率密度为 $p(\\Delta r_{k,i} | D) = (4\\pi D \\Delta t)^{-1/2} \\exp\\left(-\\frac{(\\Delta r_{k,i})^2}{4D\\Delta t}\\right)$。整个观测数据集的似然函数是这些密度的乘积。对数似然函数$\\ln L(D)$为：\n$$ \\ln L(D) = \\sum_{k=1}^N \\sum_{i=1}^d \\ln p(\\Delta r_{k,i} | D) = -\\frac{dN}{2} \\ln(4\\pi D \\Delta t) - \\frac{1}{4D\\Delta t} \\sum_{k=1}^N \\sum_{i=1}^d (\\Delta r_{k,i})^2 $$\n令$S = \\sum_{k=1}^N \\sum_{i=1}^d (\\Delta r_{k,i})^2$为平方增量之和，这是作为输入提供的。\n$$ \\ln L(D) = -\\frac{dN}{2}\\ln(D) - \\frac{S}{4D\\Delta t} + \\text{const.} $$\n为找到$D$的最大似然估计（MLE），我们对$D$求导并令结果为零：\n$$ \\frac{\\partial \\ln L}{\\partial D} = -\\frac{dN}{2D} + \\frac{S}{4D^2\\Delta t} = 0 \\implies \\widehat{D}_{\\text{BD}} = \\frac{S}{2dN\\Delta t} $$\n这是我们从轨迹数据中得到的$D$的估计量。为了找到其不确定性，我们计算其方差。量$S/(2D\\Delta t)$服从自由度为$dN$的卡方分布，即$S/(2D\\Delta t) \\sim \\chi^2_{dN}$。一个$\\chi^2_{k}$分布的均值是$k$，方差是$2k$。\n我们的估计量的期望是 $E[\\widehat{D}_{\\text{BD}}] = E\\left[\\frac{S}{2dN\\Delta t}\\right] = \\frac{2D\\Delta t}{2dN\\Delta t} E[\\chi^2_{dN}] = \\frac{D}{dN} (dN) = D$，因此该估计量是无偏的。\n估计量的方差是：\n$$ \\text{Var}(\\widehat{D}_{\\text{BD}}) = \\text{Var}\\left(\\frac{S}{2dN\\Delta t}\\right) = \\left(\\frac{2D\\Delta t}{2dN\\Delta t}\\right)^2 \\text{Var}(\\chi^2_{dN}) = \\left(\\frac{D}{dN}\\right)^2 (2dN) = \\frac{2D^2}{dN} $$\n由于真实的$D$是未知的，我们通过用我们的估计值$\\widehat{D}_{\\text{BD}}$代替$D$来近似方差。因此，该估计的不确定性度量是其标准差，我们估计为：\n$$ \\sigma_{\\text{BD}}^2 = \\text{Var}(\\widehat{D}_{\\text{BD}}) \\approx \\frac{2\\widehat{D}_{\\text{BD}}^2}{dN} $$\n\n### 2. 从物理参数估计扩散系数\n\n$D$的一个独立估计可以从爱因斯坦关系式获得，对于半径为$a$的球形颗粒在动态粘度为$\\eta$、温度为$T$的流体中，该关系式为：\n$$ D = \\frac{k_{\\mathrm{B}} T}{6\\pi \\eta a} $$\n参数$T$、$\\eta$和$a$是带有高斯不确定性的测量值：$T \\sim \\mathcal{N}(\\mu_T, \\sigma_T^2)$、$\\eta \\sim \\mathcal{N}(\\mu_\\eta, \\sigma_\\eta^2)$和$a \\sim \\mathcal{N}(\\mu_a, \\sigma_a^2)$。为了将这些不确定性传播到$D$，我们按要求使用蒙特卡洛方法。\n从它们各自的分布中抽取大量的样本值$(T_j, \\eta_j, a_j)$，数量为$M$。为确保物理有效性，任何非正样本都在一个小的正阈值处被截断。对于每个样本三元组，计算一个扩散系数值$D_j$：\n$$ D_j = \\frac{k_{\\mathrm{B}} T_j}{6\\pi \\eta_j a_j} $$\n集合$\\{D_j\\}_{j=1}^M$构成了由物理参数不确定性所隐含的$D$的概率分布的一个样本。用这种方法得到的$D$的估计值$\\widehat{D}_{\\text{phys}}$是样本均值：\n$$ \\widehat{D}_{\\text{phys}} = \\frac{1}{M}\\sum_{j=1}^M D_j $$\n相关的方差$\\sigma_{\\text{phys}}^2$是$D_j$值的样本方差，它量化了由于输入参数不确定性而导致的$D$的不确定性：\n$$ \\sigma_{\\text{phys}}^2 = \\frac{1}{M-1}\\sum_{j=1}^M (D_j - \\widehat{D}_{\\text{phys}})^2 $$\n\n### 3. 独立估计的组合\n\n我们现在有两个独立的$D$的估计值：$\\widehat{D}_{\\text{BD}}$（方差为$\\sigma_{\\text{BD}}^2$）和$\\widehat{D}_{\\text{phys}}$（方差为$\\sigma_{\\text{phys}}^2$）。假设两个估计量都近似服从高斯分布，最优的组合估计是使方差最小化的逆方差加权平均。设权重为$w_1 = 1/\\sigma_{\\text{BD}}^2$和$w_2 = 1/\\sigma_{\\text{phys}}^2$。\n校准后的扩散系数$\\widehat{D}_{\\text{calib}}$为：\n$$ \\widehat{D}_{\\text{calib}} = \\frac{w_1 \\widehat{D}_{\\text{BD}} + w_2 \\widehat{D}_{\\text{phys}}}{w_1 + w_2} = \\frac{\\widehat{D}_{\\text{BD}}/\\sigma_{\\text{BD}}^2 + \\widehat{D}_{\\text{phys}}/\\sigma_{\\text{phys}}^2}{1/\\sigma_{\\text{BD}}^2 + 1/\\sigma_{\\text{phys}}^2} $$\n这个组合估计量的方差$\\sigma_{\\text{calib}}^2$由下式给出：\n$$ \\sigma_{\\text{calib}}^2 = \\frac{1}{w_1 + w_2} = \\frac{1}{1/\\sigma_{\\text{BD}}^2 + 1/\\sigma_{\\text{phys}}^2} = \\frac{\\sigma_{\\text{BD}}^2 \\sigma_{\\text{phys}}^2}{\\sigma_{\\text{BD}}^2 + \\sigma_{\\text{phys}}^2} $$\n这个组合估计$\\widehat{D}_{\\text{calib}}$是用于BD模拟的最有原则的值，因为它包含了所有可用的信息。该值的不确定性通过一个$95\\%$的覆盖区间来量化。假设组合估计量也服从高斯分布，该区间为$[\\text{lower}, \\text{upper}]$，其中：\n$$ \\text{lower} = \\widehat{D}_{\\text{calib}} - z \\cdot \\sigma_{\\text{calib}} \\quad \\text{和} \\quad \\text{upper} = \\widehat{D}_{\\text{calib}} + z \\cdot \\sigma_{\\text{calib}} $$\n这里，$\\sigma_{\\text{calib}} = \\sqrt{\\sigma_{\\text{calib}}^2}$，$z$是标准正态分布中对应$95\\%$覆盖率的临界值，即$0.975$分位数。该值约为$z \\approx 1.95996$。\n每个测试案例的最终输出将是列表$[\\widehat{D}_{\\text{calib}}, \\text{lower}, \\text{upper}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Derives and implements a protocol to calculate a calibrated diffusion coefficient\n    by combining estimates from Brownian trajectory data and physical parameters.\n    \"\"\"\n    # Define physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {'d': 2, 'N': 1000, 'dt': 0.01, 'S': 1.65e-11,\n         'T_mean': 298.0, 'T_std': 1.0,\n         'eta_mean': 1.0e-3, 'eta_std': 5.0e-5,\n         'a_mean': 5.0e-7, 'a_std': 5.0e-8},\n        # Case B\n        {'d': 3, 'N': 300, 'dt': 0.05, 'S': 8.7e-12,\n         'T_mean': 310.0, 'T_std': 2.0,\n         'eta_mean': 2.0e-3, 'eta_std': 1.0e-4,\n         'a_mean': 1.2e-6, 'a_std': 1.0e-7},\n        # Case C\n        {'d': 2, 'N': 20, 'dt': 0.1, 'S': 1.4e-11,\n         'T_mean': 295.0, 'T_std': 3.0,\n         'eta_mean': 8.0e-4, 'eta_std': 2.0e-4,\n         'a_mean': 3.0e-7, 'a_std': 5.0e-8},\n    ]\n\n    # Set up Monte Carlo simulation parameters\n    MC_SAMPLES = 200000\n    # Set a fixed seed for reproducibility. The problem requires this.\n    np.random.seed(42)\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters\n        d, N, dt, S = case['d'], case['N'], case['dt'], case['S']\n        T_mean, T_std = case['T_mean'], case['T_std']\n        eta_mean, eta_std = case['eta_mean'], case['eta_std']\n        a_mean, a_std = case['a_mean'], case['a_std']\n\n        # --- Step 1: Estimate D from trajectory data (BD model) ---\n        d_BD = S / (2 * d * N * dt)\n        var_d_BD = (2 * d_BD**2) / (d * N)\n\n        # --- Step 2: Estimate D from physical parameters (Einstein relation) ---\n        # Generate random samples for T, eta, a\n        T_samples = np.random.normal(T_mean, T_std, MC_SAMPLES)\n        eta_samples = np.random.normal(eta_mean, eta_std, MC_SAMPLES)\n        a_samples = np.random.normal(a_mean, a_std, MC_SAMPLES)\n\n        # Truncate samples to ensure positivity\n        T_samples = np.maximum(1.0, T_samples)\n        eta_samples = np.maximum(1.0e-12, eta_samples)\n        a_samples = np.maximum(1.0e-12, a_samples)\n\n        # Calculate D for each sample set\n        D_phys_samples = (K_B * T_samples) / (6 * np.pi * eta_samples * a_samples)\n\n        # Compute mean and variance from the Monte Carlo samples\n        d_phys = np.mean(D_phys_samples)\n        var_d_phys = np.var(D_phys_samples, ddof=1) # Use ddof=1 for sample variance\n\n        # --- Step 3: Combine the two estimates ---\n        # Use inverse-variance weighting\n        w_BD = 1 / var_d_BD\n        w_phys = 1 / var_d_phys\n\n        # Combined (calibrated) estimate for D\n        d_calib = (d_BD * w_BD + d_phys * w_phys) / (w_BD + w_phys)\n        \n        # Variance of the combined estimate\n        var_d_calib = 1 / (w_BD + w_phys)\n        std_d_calib = np.sqrt(var_d_calib)\n\n        # Calculate the 95% coverage interval\n        z_95 = norm.ppf(0.975) # z-score for 95% confidence\n        lower_bound = d_calib - z_95 * std_d_calib\n        upper_bound = d_calib + z_95 * std_d_calib\n\n        results.append([d_calib, lower_bound, upper_bound])\n    \n    # Format the final output string exactly as required\n    formatted_results = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in results]\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}