{
    "hands_on_practices": [
        {
            "introduction": "任何时间步进模拟的首要问题都是数值稳定性。如果时间步长 $ \\Delta t $ 过大，数值解可能会出现不切实际的发散。本练习将指导你对一个简单但重要的模型系统——谐波势阱中的粒子——进行均方稳定性分析，演示如何推导最大稳定时间步长。这项技能是建立可靠模拟的基础。",
            "id": "4080331",
            "problem": "考虑一个一维过阻尼布朗动力学（BD）模型，描述一个胶体粒子在温度为 $T$、刚度为 $k$ 的谐波势中的运动。其过阻尼朗之万方程为\n$$\n\\gamma \\,\\frac{dx}{dt} \\,=\\, -k\\,x \\,+\\, \\sqrt{2\\,\\gamma\\,k_{B}\\,T}\\,\\eta(t),\n$$\n其中 $\\gamma$ 是摩擦系数，$k_{B}$ 是玻尔兹曼常数，$\\eta(t)$ 是零均值和单位δ相关的高斯白噪声。设 $x(t)$ 通过步长为 $\\Delta t$ 的欧拉-丸山（EM）时间步进法进行离散化。从给定的随机微分方程和欧拉-丸山离散化的定义出发，使用线性均方稳定性分析，推导出一个关于 $\\Delta t$ 的充分必要条件，以保证数值解的二阶矩 $\\mathbb{E}[x_{n}^{2}]$ 在 $n \\to \\infty$ 时保持有界。然后，对于一个摩擦系数为 $\\gamma = 9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}}$、处在刚度为 $k = 0.05\\,\\mathrm{N\\,m^{-1}}$ 陷阱中的胶体，根据此稳定性条件估算欧拉-丸山法的最大稳定时间步长 $\\Delta t_{\\max}$。\n\n将 $\\Delta t_{\\max}$ 的最终数值答案以秒为单位表示，并四舍五入到 $3$ 位有效数字。",
            "solution": "用户想要解决这个问题。我需要先验证它。\n\n### 步骤1：提取给定条件\n-   **系统**：一维过阻尼布朗动力学（BD）模型。\n-   **势能**：刚度为 $k$ 的谐波势，$U(x) = \\frac{1}{2}kx^2$。\n-   **温度**：$T$。\n-   **控制方程**：给定的过阻尼朗之万方程为\n    $$\n    \\gamma \\,\\frac{dx}{dt} \\,=\\, -k\\,x \\,+\\, \\sqrt{2\\,\\gamma\\,k_{B}\\,T}\\,\\eta(t)\n    $$\n-   **参数**：\n    -   $\\gamma$ 是摩擦系数。\n    -   $k_B$ 是玻尔兹曼常数。\n    -   $\\eta(t)$ 是零均值（$\\langle\\eta(t)\\rangle = 0$）和δ相关（$\\langle\\eta(t)\\eta(t')\\rangle = \\delta(t-t')$）的高斯白噪声。\n-   **数值方法**：欧拉-丸山（EM）法，时间步长为 $\\Delta t$。\n-   **任务1**：推导关于 $\\Delta t$ 的充分必要条件，以保证数值解的二阶矩 $\\mathbb{E}[x_{n}^{2}]$ 在 $n \\to \\infty$ 时保持有界。这是一个线性均方稳定性分析。\n-   **任务2**：对于一个摩擦系数为 $\\gamma = 9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}}$、刚度为 $k = 0.05\\,\\mathrm{N\\,m^{-1}}$ 的胶体，估算最大稳定时间步长 $\\Delta t_{\\max}$。\n-   **取整**：$\\Delta t_{\\max}$ 的最终数值答案应四舍五入到 $3$ 位有效数字。\n\n### 步骤2：使用提取的给定条件进行验证\n该问题具有科学依据，表述清晰且客观。它描述了一个标准的物理系统（谐波陷阱中的胶体粒子），并使用了适当的随机微分方程（SDE）。任务涉及一个标准的数值稳定性分析（欧拉-丸山方法的均方稳定性），这是一个明确定义的数学过程。所有参数都定义清晰，给定的数值在物理上是合理的。不存在矛盾、歧义或违反科学原理的情况。\n\n### 步骤3：结论与行动\n该问题是 **有效的**。我将继续进行解答。\n\n给定的过阻尼朗之万方程为：\n$$\n\\gamma \\frac{dx}{dt} = -kx + \\sqrt{2\\gamma k_B T} \\eta(t)\n$$\n其中 $\\eta(t)$ 代表高斯白噪声。该方程可以改写为伊藤随机微分方程（SDE）的标准形式：\n$$\ndx(t) = -\\frac{k}{\\gamma} x(t) dt + \\sqrt{\\frac{2k_B T}{\\gamma}} dW(t)\n$$\n这里，$dW(t) = \\eta(t) dt$ 表示维纳过程 $W(t)$ 的增量，其性质为 $\\mathbb{E}[dW(t)] = 0$ 和 $(dW(t))^2 = dt$。对于离散时间步长 $\\Delta t$，维纳增量 $\\Delta W_n = W(t_{n+1}) - W(t_n)$ 是一个高斯随机变量，其均值为 $\\mathbb{E}[\\Delta W_n] = 0$，方差为 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$。\n\n该SDE的欧拉-丸山（EM）离散化给出了从时间步 $n$ 更新到 $n+1$ 的粒子位置的规则：\n$$\nx_{n+1} = x_n + \\left(-\\frac{k}{\\gamma} x_n\\right) \\Delta t + \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n\n$$\n其中 $x_n = x(n\\Delta t)$。整理各项，我们得到：\n$$\nx_{n+1} = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) x_n + \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n\n$$\n我们关心的是二阶矩 $\\mathbb{E}[x_n^2]$ 的稳定性。让我们计算 $x_{n+1}$ 平方的期望：\n$$\n\\mathbb{E}[x_{n+1}^2] = \\mathbb{E}\\left[ \\left( \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) x_n + \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n \\right)^2 \\right]\n$$\n展开平方项得到：\n$$\n\\mathbb{E}[x_{n+1}^2] = \\mathbb{E}\\left[ \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2 x_n^2 + 2\\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) x_n \\sqrt{\\frac{2k_B T}{\\gamma}} \\Delta W_n + \\left(\\frac{2k_B T}{\\gamma}\\right) (\\Delta W_n)^2 \\right]\n$$\n利用期望算子的线性性：\n$$\n\\mathbb{E}[x_{n+1}^2] = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2 \\mathbb{E}[x_n^2] + 2\\left(1 - \\frac{k\\Delta t}{\\gamma}\\right) \\sqrt{\\frac{2k_B T}{\\gamma}} \\mathbb{E}[x_n \\Delta W_n] + \\frac{2k_B T}{\\gamma} \\mathbb{E}[(\\Delta W_n)^2]\n$$\n系统在时间 $n\\Delta t$ 的状态 $x_n$ 取决于到该时间为止的随机力历史。维纳增量 $\\Delta W_n$ 是针对区间 $[n\\Delta t, (n+1)\\Delta t]$ 的，并且与 $x_n$ 统计独立。因此，交叉项的期望可以分离：\n$$\n\\mathbb{E}[x_n \\Delta W_n] = \\mathbb{E}[x_n] \\mathbb{E}[\\Delta W_n]\n$$\n由于 $\\mathbb{E}[\\Delta W_n] = 0$，交叉项消失：$\\mathbb{E}[x_n \\Delta W_n] = 0$。\n此外，我们有 $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$。将这些结果代回，我们得到二阶矩的递推关系，记为 $y_n = \\mathbb{E}[x_n^2]$：\n$$\ny_{n+1} = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2 y_n + \\frac{2k_B T \\Delta t}{\\gamma}\n$$\n这是一个形如 $y_{n+1} = A y_n + B$ 的线性递推关系，其中放大因子为 $A = \\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2$，常数项为 $B = \\frac{2k_B T \\Delta t}{\\gamma}$。为使序列 $\\{y_n\\}$ 对于任何初始条件在 $n \\to \\infty$ 时保持有界，放大因子的绝对值必须严格小于 1：\n$$\n|A|  1\n$$\n由于 $A$ 是一个平方数，它总是非负的（$A \\ge 0$），因此条件简化为 $A  1$：\n$$\n\\left(1 - \\frac{k\\Delta t}{\\gamma}\\right)^2  1\n$$\n两边取平方根得到：\n$$\n\\left|1 - \\frac{k\\Delta t}{\\gamma}\\right|  1\n$$\n这个绝对值不等式等价于复合不等式：\n$$\n-1  1 - \\frac{k\\Delta t}{\\gamma}  1\n$$\n我们分别求解这两个不等式。\n$1$. $1 - \\frac{k\\Delta t}{\\gamma}  1 \\implies -\\frac{k\\Delta t}{\\gamma}  0$。由于 $k$、$\\gamma$ 和 $\\Delta t$ 都是内禀的正物理量，这部分不等式总是成立的。\n$2$. $-1  1 - \\frac{k\\Delta t}{\\gamma} \\implies \\frac{k\\Delta t}{\\gamma}  2$。\n\n综合两部分，二阶矩保持有界的充分必要条件是：\n$$\n\\frac{k\\Delta t}{\\gamma}  2\n$$\n这可以表示为关于时间步长 $\\Delta t$ 的条件：\n$$\n\\Delta t  \\frac{2\\gamma}{k}\n$$\n这就是推导出的稳定性条件。最大稳定时间步长 $\\Delta t_{\\max}$ 是这个区间的上确界：\n$$\n\\Delta t_{\\max} = \\frac{2\\gamma}{k}\n$$\n现在，我们代入给定的数值：$\\gamma = 9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}}$ 和 $k = 0.05\\,\\mathrm{N\\,m^{-1}}$。$k$ 的单位等价于 $\\mathrm{kg\\,s^{-2}}$。\n$$\n\\Delta t_{\\max} = \\frac{2 \\times (9.42 \\times 10^{-10}\\,\\mathrm{kg\\,s^{-1}})}{0.05\\,\\mathrm{kg\\,s^{-2}}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{1.884 \\times 10^{-9}}{0.05}\\,\\mathrm{s} = \\frac{1.884 \\times 10^{-9}}{5 \\times 10^{-2}}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = 0.3768 \\times 10^{-7}\\,\\mathrm{s} = 3.768 \\times 10^{-8}\\,\\mathrm{s}\n$$\n问题要求将答案四舍五入到 3 位有效数字。\n$$\n\\Delta t_{\\max} \\approx 3.77 \\times 10^{-8}\\,\\mathrm{s}\n$$",
            "answer": "$$\\boxed{3.77 \\times 10^{-8}}$$"
        },
        {
            "introduction": "在确保稳定性之后，我们进而关注准确性。即使是稳定的模拟也会引入误差，特别是在计算统计平均值时（即弱误差）。本练习深入探讨了粒子在更真实的非线性势阱中的这一问题。通过分析常用的欧拉-丸山（Euler-Maruyama）格式引入的偏差，你不仅将学会如何量化此误差，还将学习如何构建一个修正的估计量，这是一种在不使用更小、计算成本更高的步长的情况下提高模拟准确性的强大技术。",
            "id": "4080268",
            "problem": "考虑一维过阻尼布朗动力学（BD），研究一个粒子在约束性非线性势中的运动，该过程通过朗之万方程来表述。设位形坐标为 $x(t)$，摩擦系数为 $\\gamma>0$，绝对温度为 $T>0$，玻尔兹曼常数为 $k_B>0$。过阻尼朗之万方程为\n$$\n\\gamma\\,\\frac{dx(t)}{dt} \\;=\\; -\\,U'(x(t)) \\;+\\; \\sqrt{2\\,\\gamma\\,k_B\\,T}\\;\\xi(t),\n$$\n其中 $U(x)$ 是势能，$U'(x)$ 是其对 $x$ 的导数，$\\xi(t)$ 是高斯白噪声，其性质为 $\\langle \\xi(t) \\rangle = 0$ 和 $\\langle \\xi(t)\\,\\xi(t') \\rangle = \\delta(t-t')$。在此随机微分方程下，$x$ 的精确平衡分布是玻尔兹曼分布 $p_{\\mathrm{eq}}(x) \\propto \\exp\\!\\big(-U(x)/(k_B T)\\big)$。\n\n假设势是四次方的，\n$$\nU(x) \\;=\\; \\frac{k}{2}\\,x^{2} \\;+\\; \\frac{\\lambda}{4}\\,x^{4},\n$$\n其中 $k>0$ 和 $\\lambda>0$ 确保了约束性。考虑时间步长 $\\Delta t>0$ 的一阶欧拉-丸山离散化，\n$$\nx_{n+1} \\;=\\; x_n \\;-\\; \\frac{\\Delta t}{\\gamma}\\,U'(x_n) \\;+\\; \\sqrt{\\frac{2\\,k_B\\,T\\,\\Delta t}{\\gamma}}\\;\\eta_n,\n$$\n其中 $\\eta_n \\sim \\mathcal{N}(0,1)$ 是独立同分布的标准正态随机变量。令 $\\langle \\cdot \\rangle_{\\Delta t}$ 表示该离散时间马尔可夫链下的稳态平均值，令 $\\langle \\cdot \\rangle_{\\mathrm{eq}}$ 表示相对于 $p_{\\mathrm{eq}}(x)$ 的精确平衡平均值。\n\n仅从朗之万方程、其内含的涨落-耗散关系以及上述离散化出发，推导由欧拉-丸山格式对给定的四次势 $U(x)$ 所引入的平衡平均值 $\\langle x\\,U'(x) \\rangle_{\\Delta t}$ 的前导阶偏差。您的推导必须从第一性原理出发，通过写出由稳态性所蕴含的离散时间矩平衡，并仔细地按 $\\Delta t$ 的幂次整理各项。\n\n然后，为 $\\langle x\\,U'(x) \\rangle$ 的估计量提出一个更高阶的修正，该修正能够使用从 BD 模拟本身可获得的量来消除 $\\mathcal{O}(\\Delta t)$ 偏差，并通过渐近展开证明修正后的估计量精确到 $\\mathcal{O}(\\Delta t^{2})$。\n\n将您的前导阶偏差系数的结果表示为用 $k$、$\\lambda$、$\\gamma$、$k_B T$ 以及与 $U(x)$ 相关的精确平衡矩 $\\langle x^{2} \\rangle_{\\mathrm{eq}}$、$\\langle x^{4} \\rangle_{\\mathrm{eq}}$、$\\langle x^{6} \\rangle_{\\mathrm{eq}}$ 表示的封闭形式解析表达式。同时，使用 $\\langle \\cdot \\rangle_{\\Delta t}$ 将您提出的修正估计量写成封闭的解析形式。最终答案必须是单个解析表达式或解析表达式的行矩阵。在您最终的方框答案中不要包含单位。",
            "solution": "用户希望分析一个计算复杂流体课程中的问题，具体是关于使用朗之万方程的布朗动力学（BD）模拟这一主题。任务是验证问题陈述的有效性，如果有效，则解决它。\n\n### 步骤1：提取给定条件\n- **过阻尼朗之万方程**：$\\gamma\\,\\frac{dx(t)}{dt} = -\\,U'(x(t)) + \\sqrt{2\\,\\gamma\\,k_B\\,T}\\;\\xi(t)$\n- **粒子与环境属性**：摩擦系数 $\\gamma>0$，绝对温度 $T>0$，玻尔兹曼常数 $k_B>0$。\n- **随机力**：$\\xi(t)$ 是高斯白噪声，其性质为 $\\langle \\xi(t) \\rangle = 0$ 和 $\\langle \\xi(t)\\,\\xi(t') \\rangle = \\delta(t-t')$。\n- **精确平衡分布**：$p_{\\mathrm{eq}}(x) \\propto \\exp(-U(x)/(k_B T))$。\n- **势能**：$U(x) = \\frac{k}{2}\\,x^{2} + \\frac{\\lambda}{4}\\,x^{4}$，其中常数 $k>0$ 且 $\\lambda>0$。\n- **数值格式 (欧拉-丸山)**：$x_{n+1} = x_n - \\frac{\\Delta t}{\\gamma}\\,U'(x_n) + \\sqrt{\\frac{2\\,k_B\\,T\\,\\Delta t}{\\gamma}}\\;\\eta_n$，时间步长为 $\\Delta t>0$。\n- **格式中的噪声**：$\\eta_n \\sim \\mathcal{N}(0,1)$ 是独立同分布的标准正态随机变量。\n- **平均值记法**：$\\langle \\cdot \\rangle_{\\Delta t}$ 是离散时间马尔可夫链下的稳态平均，$\\langle \\cdot \\rangle_{\\mathrm{eq}}$ 是精确平衡平均。\n\n### 步骤2：使用提取的给定条件进行验证\n1.  **科学依据**：问题陈述牢固地植根于计算统计物理学中的一个标准且关键的主题：随机微分方程的数值积分格式分析。朗之万方程、涨落-耗散关系（噪声项的具体形式）、玻尔兹曼分布和欧拉-丸山离散化都是基本且陈述正确的概念。量化和校正数值偏差（弱误差）的问题是 BD 模拟中的一个核心且实际的挑战。\n2.  **良构性**：该问题是良构的。它要求推导一个特定的量（前导阶偏差系数）以及一个相关的修正估计量。势的约束性（$k>0, \\lambda>0$）确保了稳态分布和有限矩的存在，使得所要求的平均值是良定义的。解决方案的路径清晰地勾勒出来，要求基于矩平衡方程进行第一性原理推导，这是一种用于此类分析的标准且严谨的技术。\n3.  **客观性**：问题以精确、技术性和无偏见的语言陈述。没有主观或基于意见的元素。\n4.  **完整性与一致性**：问题提供了所有必要的定义、方程和约束。给定的信息是自洽的，足以进行所要求的推导。\n5.  **结论**：该问题在科学上是合理的、良构的，并且没有任何指出的缺陷。它代表了计算复杂流体领域中一个有效且相关的练习。\n\n### 步骤3：裁定与行动\n问题有效。现在开始求解过程。\n\n### 解题推导\n\n分析始于过阻尼朗之万方程的欧拉-丸山离散化：\n$$\nx_{n+1} = x_n - \\frac{\\Delta t}{\\gamma}\\,U'(x_n) + \\sqrt{\\frac{2\\,k_B\\,T\\,\\Delta t}{\\gamma}}\\;\\eta_n\n$$\n设 $\\delta x_n = x_{n+1} - x_n$ 为粒子位置在一个时间步长 $\\Delta t$ 内的变化。我们可以将其写作：\n$$\n\\delta x_n = -\\frac{U'(x_n)}{\\gamma}\\Delta t + \\sqrt{2D\\Delta t}\\,\\eta_n\n$$\n其中 $D = \\frac{k_B T}{\\gamma}$ 是扩散系数。\n\n为了找到稳态平均值，我们利用对于任何平滑函数 $f(x)$，其期望值在稳态下必须是常数这一性质：$\\langle f(x_{n+1}) \\rangle_{\\Delta t} = \\langle f(x_n) \\rangle_{\\Delta t}$。这意味着 $\\langle f(x_{n+1}) - f(x_n) \\rangle_{\\Delta t} = 0$。\n\n让我们将 $f(x_{n+1})$ 在 $x_n$ 附近进行泰勒展开：\n$$\nf(x_{n+1}) = f(x_n) + f'(x_n)\\,\\delta x_n + \\frac{1}{2} f''(x_n)\\,(\\delta x_n)^2 + \\mathcal{O}((\\delta x_n)^3)\n$$\n我们取此表达式的期望值。这涉及对 $x_n$ 的稳态分布和噪声 $\\eta_n$ 的分布进行平均。首先，我们对固定的 $x_n$ 对噪声 $\\eta_n$ 进行平均：\n$$\n\\langle \\delta x_n \\rangle_{\\eta} = \\left\\langle -\\frac{U'(x_n)}{\\gamma}\\Delta t + \\sqrt{2D\\Delta t}\\,\\eta_n \\right\\rangle_{\\eta} = -\\frac{U'(x_n)}{\\gamma}\\Delta t\n$$\n$$\n\\langle (\\delta x_n)^2 \\rangle_{\\eta} = \\left\\langle \\left(-\\frac{U'(x_n)}{\\gamma}\\Delta t + \\sqrt{2D\\Delta t}\\,\\eta_n\\right)^2 \\right\\rangle_{\\eta} = \\left(\\frac{U'(x_n)}{\\gamma}\\right)^2 (\\Delta t)^2 + 2D\\Delta t\n$$\n在第二行中，我们使用了 $\\langle \\eta_n \\rangle = 0$ 和 $\\langle \\eta_n^2 \\rangle = 1$。交叉项消失。\n\n现在，我们取完整的稳态平均 $\\langle \\cdot \\rangle_{\\Delta t}$ 并施加稳态条件，保留至 $\\mathcal{O}(\\Delta t)$ 阶的项：\n$$\n0 = \\langle f(x_{n+1}) - f(x_n) \\rangle_{\\Delta t} = \\langle f'(x) \\langle \\delta x \\rangle_{\\eta} \\rangle_{\\Delta t} + \\frac{1}{2} \\langle f''(x) \\langle (\\delta x)^2 \\rangle_{\\eta} \\rangle_{\\Delta t} + \\dots\n$$\n$$\n0 = \\left\\langle -f'(x) \\frac{U'(x)}{\\gamma}\\Delta t \\right\\rangle_{\\Delta t} + \\frac{1}{2} \\left\\langle f''(x) \\left( \\left(\\frac{U'(x)}{\\gamma}\\right)^2 (\\Delta t)^2 + 2D\\Delta t \\right) \\right\\rangle_{\\Delta t} + \\mathcal{O}((\\Delta t)^2)\n$$\n两边同除以 $\\Delta t$ 并重新整理，得到离散时间矩平衡方程：\n$$\n\\left\\langle f'(x)U'(x) \\right\\rangle_{\\Delta t} = \\gamma D \\left\\langle f''(x) \\right\\rangle_{\\Delta t} + \\frac{\\Delta t}{2\\gamma} \\left\\langle f''(x) (U'(x))^2 \\right\\rangle_{\\Delta t} + \\mathcal{O}((\\Delta t)^2)\n$$\n代入 $D = k_B T / \\gamma$：\n$$\n\\left\\langle f'(x)U'(x) \\right\\rangle_{\\Delta t} = k_B T \\left\\langle f''(x) \\right\\rangle_{\\Delta t} + \\frac{\\Delta t}{2\\gamma} \\left\\langle f''(x) (U'(x))^2 \\right\\rangle_{\\Delta t} + \\mathcal{O}((\\Delta t)^2)\n$$\n这是一个关于离散过程稳态平均的普适关系。\n\n为了找到 $\\langle x\\,U'(x) \\rangle_{\\Delta t}$ 的表达式，我们选择一个测试函数 $f(x)$ 使得 $f'(x) = x$。最简单的选择是 $f(x) = \\frac{1}{2}x^2$。对于这个函数，$f''(x)=1$。代入矩平衡方程得到：\n$$\n\\langle x\\,U'(x) \\rangle_{\\Delta t} = k_B T \\langle 1 \\rangle_{\\Delta t} + \\frac{\\Delta t}{2\\gamma} \\langle 1 \\cdot (U'(x))^2 \\rangle_{\\Delta t} + \\mathcal{O}((\\Delta t)^2)\n$$\n$$\n\\langle x\\,U'(x) \\rangle_{\\Delta t} = k_B T + \\frac{\\Delta t}{2\\gamma} \\langle (U'(x))^2 \\rangle_{\\Delta t} + \\mathcal{O}((\\Delta t)^2)\n$$\n\n现在，我们将其与精确平衡平均值 $\\langle x\\,U'(x) \\rangle_{\\mathrm{eq}}$ 进行比较。这是一种统计力学维里定理的形式。我们使用分部积分从第一性原理推导它。\n$$\n\\langle x\\,U'(x) \\rangle_{\\mathrm{eq}} = \\int_{-\\infty}^{\\infty} x\\,U'(x)\\,p_{\\mathrm{eq}}(x)\\,dx\n$$\n其中 $p_{\\mathrm{eq}}(x) = Z^{-1} \\exp(-U(x)/(k_B T))$，$Z$ 是配分函数，我们有：\n$$\n\\langle x\\,U'(x) \\rangle_{\\mathrm{eq}} = \\frac{1}{Z} \\int_{-\\infty}^{\\infty} x\\, \\left( U'(x)\\,\\exp\\left(-\\frac{U(x)}{k_B T}\\right) \\right) \\,dx\n$$\n我们可以写出 $U'(x)\\,\\exp(-U(x)/(k_B T)) = -k_B T \\frac{d}{dx}\\exp(-U(x)/(k_B T))$。使用分部积分，令 $u=x$，$dv = -k_B T \\frac{d}{dx}\\exp(...) dx$：\n$$\n\\langle x\\,U'(x) \\rangle_{\\mathrm{eq}} = \\frac{1}{Z} \\left[ -x\\,k_B T\\,\\exp\\left(-\\frac{U(x)}{k_B T}\\right) \\right]_{-\\infty}^{\\infty} - \\frac{1}{Z} \\int_{-\\infty}^{\\infty} (1) \\left( -k_B T\\,\\exp\\left(-\\frac{U(x)}{k_B T}\\right) \\right) \\,dx\n$$\n边界项因势 $U(x)$ 是约束性的（当 $|x| \\to \\infty$ 时 $U(x) \\to \\infty$）而消失。剩余的积分为：\n$$\n\\langle x\\,U'(x) \\rangle_{\\mathrm{eq}} = k_B T \\frac{1}{Z} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{U(x)}{k_B T}\\right) \\,dx = k_B T \\frac{Z}{Z} = k_B T\n$$\n\n估计量的偏差是数值平均与精确平均之差：\n$$\n\\mathrm{Bias} = \\langle x\\,U'(x) \\rangle_{\\Delta t} - \\langle x\\,U'(x) \\rangle_{\\mathrm{eq}} = \\left( k_B T + \\frac{\\Delta t}{2\\gamma} \\langle (U'(x))^2 \\rangle_{\\Delta t} + \\mathcal{O}((\\Delta t)^2) \\right) - k_B T\n$$\n$$\n\\mathrm{Bias} = \\frac{\\Delta t}{2\\gamma} \\langle (U'(x))^2 \\rangle_{\\Delta t} + \\mathcal{O}((\\Delta t)^2)\n$$\n前导阶偏差是与 $\\Delta t$ 成正比的项。为了用精确平衡矩来表示其系数，我们可以将 $\\langle (U'(x))^2 \\rangle_{\\Delta t}$ 替换为 $\\langle (U'(x))^2 \\rangle_{\\mathrm{eq}}$，因为它们的差是 $\\mathcal{O}(\\Delta t)$ 阶的，这只会影响偏差的 $\\mathcal{O}((\\Delta t)^2)$ 项。\n$$\n\\text{前导阶偏差} = \\frac{\\Delta t}{2\\gamma} \\langle (U'(x))^2 \\rangle_{\\mathrm{eq}}\n$$\n问题要求的是这个前导阶偏差的*系数*。对于给定的势 $U(x) = \\frac{k}{2}x^2 + \\frac{\\lambda}{4}x^4$，我们有 $U'(x) = kx + \\lambda x^3$。因此，$(U'(x))^2 = (kx + \\lambda x^3)^2 = k^2 x^2 + 2k\\lambda x^4 + \\lambda^2 x^6$。其期望值为：\n$$\n\\langle (U'(x))^2 \\rangle_{\\mathrm{eq}} = k^2 \\langle x^2 \\rangle_{\\mathrm{eq}} + 2k\\lambda \\langle x^4 \\rangle_{\\mathrm{eq}} + \\lambda^2 \\langle x^6 \\rangle_{\\mathrm{eq}}\n$$\n所以，前导阶偏差系数为：\n$$\nC_{\\mathrm{bias}} = \\frac{1}{2\\gamma} \\left( k^2 \\langle x^2 \\rangle_{\\mathrm{eq}} + 2k\\lambda \\langle x^4 \\rangle_{\\mathrm{eq}} + \\lambda^2 \\langle x^6 \\rangle_{\\mathrm{eq}} \\right)\n$$\n这是第一个要求的结果。\n\n对于第二部分，我们需要为 $\\langle x\\,U'(x) \\rangle_{\\mathrm{eq}} = k_B T$ 提出一个修正估计量。从我们推导的关系式中：\n$$\n\\langle x\\,U'(x) \\rangle_{\\Delta t} = k_B T + \\frac{\\Delta t}{2\\gamma} \\langle (U'(x))^2 \\rangle_{\\Delta t} + \\mathcal{O}((\\Delta t)^2)\n$$\n这个方程可以重新整理以分离出 $k_B T$：\n$$\nk_B T = \\langle x\\,U'(x) \\rangle_{\\Delta t} - \\frac{\\Delta t}{2\\gamma} \\langle (U'(x))^2 \\rangle_{\\Delta t} - \\mathcal{O}((\\Delta t)^2)\n$$\n这表明右侧的表达式（不含误差项）是 $k_B T$ 的一个更好的估计量。让我们将 $\\langle x\\,U'(x) \\rangle_{\\mathrm{eq}}$ 的修正估计量定义为：\n$$\nA_{\\mathrm{corr}} = \\langle x\\,U'(x) \\rangle_{\\Delta t} - \\frac{\\Delta t}{2\\gamma} \\langle (U'(x))^2 \\rangle_{\\Delta t}\n$$\n这个估计量是使用 BD 模拟中可获得的量构建的：时间步长 $\\Delta t$、摩擦系数 $\\gamma$ 以及稳态平均值 $\\langle x\\,U'(x) \\rangle_{\\Delta t}$ 和 $\\langle (U'(x))^2 \\rangle_{\\Delta t}$。\n该估计量精确到 $\\mathcal{O}((\\Delta t)^2)$ 的理由直接源于前面的方程。我们提出的估计量的误差是：\n$$\nA_{\\mathrm{corr}} - \\langle x\\,U'(x) \\rangle_{\\mathrm{eq}} = A_{\\mathrm{corr}} - k_B T = -\\mathcal{O}((\\Delta t)^2) = \\mathcal{O}((\\Delta t)^2)\n$$\n这证实了估计量 $A_{\\mathrm{corr}}$ 的偏差为 $\\mathcal{O}((\\Delta t)^2)$ 阶，相较于 $\\langle x\\,U'(x) \\rangle_{\\Delta t}$ 原有的 $\\mathcal{O}(\\Delta t)$ 偏差有所改进。修正估计量用矩表示的完整表达式为：\n$$\nA_{\\mathrm{corr}} = \\langle kx^2 + \\lambda x^4 \\rangle_{\\Delta t} - \\frac{\\Delta t}{2\\gamma} \\langle k^2 x^2 + 2k\\lambda x^4 + \\lambda^2 x^6 \\rangle_{\\Delta t}\n$$\n然而，使用 $U'(x)$ 的更紧凑形式已经足够且更具普适性。\n\n问题要求两个结果：偏差系数和修正估计量。这些将以行矩阵格式提供。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2\\gamma} \\left( k^2 \\langle x^2 \\rangle_{\\mathrm{eq}} + 2k\\lambda \\langle x^4 \\rangle_{\\mathrm{eq}} + \\lambda^2 \\langle x^6 \\rangle_{\\mathrm{eq}} \\right)  \\langle x U'(x) \\rangle_{\\Delta t} - \\frac{\\Delta t}{2\\gamma} \\langle (U'(x))^2 \\rangle_{\\Delta t} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "本章最后，我们将探讨如何连接模拟与真实世界。模拟的预测能力取决于使用物理上准确的参数。这个实践问题提出了一个用于校准扩散系数的综合方案，而扩散系数是布朗动力学中的一个关键参数。你将学习如何使用统计方法，结合实验粒子追踪数据和不确定的物理测量值（如温度和粘度），以获得一个带有量化置信区间的、稳健的参数估计。",
            "id": "4080280",
            "problem": "考虑介观粒子在静态流体中的过阻尼运动，该运动可通过称为布朗动力学（BD）的随机动力学模型进行建模。BD 的描述基于朗之万方程，其中摩擦阻力与随机热力和任何确定性力相平衡。在过阻尼极限下，速度瞬时弛豫，因此观测到的构型增量直接由热涨落驱动。实验性单粒子追踪以均匀的采样间隔提供一、二或三维空间中位置的离散时间观测值。计算性 BD 模拟必须选择一个扩散系数，以使模拟的均方位移与实验值相匹配，同时要考虑到实验估计量和物理参数中的不确定性。你的任务是，从与计算复杂流体相关的基本定律和定义出发，推导出一个有原则的估计和不确定性传播协议，该协议能够：\n\n1. 利用离散时间增量，构建一个与在采样间隔 $\\Delta t$ 下 $d$ 维自由扩散的 BD 模型相兼容的平移扩散系数的统计最优估计量。\n2. 根据爱因斯坦关系，使用不确定的温度、粘度和粒径测量值，提供一个有物理基础的独立扩散系数估计，并将其不确定性传播到扩散系数中。\n3. 将这两个独立的信息来源合并为一个用于 BD 模拟的校准扩散系数，并附上一个量化校准不确定性的 $95\\%$ 覆盖区间。\n\n推导必须从第一性原理和经过检验的事实出发，不能预先假设目标公式。最终的程序必须实现你的协议，并为指定的测试套件生成数值输出，所有扩散系数结果均以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位表示。不涉及角度。程序应使用固定的种子自行生成用于不确定性传播的随机样本，并且不应要求用户提供任何输入。\n\n假设使用以下测试套件。每个测试用例提供空间维度 $d$、增量数 $N$（等于时间步数）、采样间隔 $\\Delta t$（秒），以及在所有分量和时间步上观测到的平方增量总和 $S$（$\\mathrm{m}^2$）。此外，每个案例都指定了球形颗粒的物理参数：温度 $T$（开尔文）、动力粘度 $\\eta$（帕斯卡-秒）和半径 $a$（米），每个参数都带有以均值和标准差为特征的高斯测量不确定性。玻尔兹曼常数为 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}/\\mathrm{K}$。将 $T$、$\\eta$ 和 $a$ 的任何高斯样本在一个小的正阈值处截断，以确保物理上的正性（例如，对 $\\eta$ 和 $a$ 取 $10^{-12}$，对 $T$ 取 $1$）。\n\n测试用例：\n\n- 案例 A（一般情况，二维，长轨迹）：\n  - $d = 2$\n  - $N = 1000$\n  - $\\Delta t = 0.01\\ \\mathrm{s}$\n  - $S = 1.65 \\times 10^{-11}\\ \\mathrm{m}^2$\n  - $T$ 均值 $= 298\\ \\mathrm{K}$，$T$ 标准差 $= 1.0\\ \\mathrm{K}$\n  - $\\eta$ 均值 $= 1.0 \\times 10^{-3}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$，$\\eta$ 标准差 $= 5.0 \\times 10^{-5}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$\n  - $a$ 均值 $= 5.0 \\times 10^{-7}\\ \\mathrm{m}$，$a$ 标准差 $= 5.0 \\times 10^{-8}\\ \\mathrm{m}$\n\n- 案例 B（三维，中等长度轨迹）：\n  - $d = 3$\n  - $N = 300$\n  - $\\Delta t = 0.05\\ \\mathrm{s}$\n  - $S = 8.7 \\times 10^{-12}\\ \\mathrm{m}^2$\n  - $T$ 均值 $= 310\\ \\mathrm{K}$，$T$ 标准差 $= 2.0\\ \\mathrm{K}$\n  - $\\eta$ 均值 $= 2.0 \\times 10^{-3}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$，$\\eta$ 标准差 $= 1.0 \\times 10^{-4}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$\n  - $a$ 均值 $= 1.2 \\times 10^{-6}\\ \\mathrm{m}$，$a$ 标准差 $= 1.0 \\times 10^{-7}\\ \\mathrm{m}$\n\n- 案例 C（二维，短轨迹，高物理参数不确定性）：\n  - $d = 2$\n  - $N = 20$\n  - $\\Delta t = 0.1\\ \\mathrm{s}$\n  - $S = 1.4 \\times 10^{-11}\\ \\mathrm{m}^2$\n  - $T$ 均值 $= 295\\ \\mathrm{K}$，$T$ 标准差 $= 3.0\\ \\mathrm{K}$\n  - $\\eta$ 均值 $= 8.0 \\times 10^{-4}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$，$\\eta$ 标准差 $= 2.0 \\times 10^{-4}\\ \\mathrm{Pa}\\cdot\\mathrm{s}$\n  - $a$ 均值 $= 3.0 \\times 10^{-7}\\ \\mathrm{m}$，$a$ 标准差 $= 5.0 \\times 10^{-8}\\ \\mathrm{m}$\n\n根据你的推导，实现以下内容：\n\n- 根据增量数据 $(d, N, \\Delta t, S)$，构建扩散系数的估计量及一个相关的、量化有限 $N$ 下估计量方差的不确定性度量。\n- 根据具有给定不确定性的 $(T, \\eta, a)$，生成一个大小至少为 $100{,}000$ 的物理上合理的参数三元组的蒙特卡洛样本，并使用球形颗粒的爱因斯坦关系计算相应的扩散系数。通过计算扩散系数的样本均值和标准差来传播不确定性。\n- 在两个估计是统计独立且近似高斯的假设下，将它们合并为一个单一的校准扩散系数，并给出一个表示为 $[\\text{lower}, \\text{upper}]$（单位为 $\\mathrm{m}^2/\\mathrm{s}$）的 $95\\%$ 覆盖区间。\n\n你的程序应该生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果，其中每个测试用例的结果是一个包含三个浮点数的列表 $[\\widehat{D}_{\\mathrm{BD}}, \\text{lower}, \\text{upper}]$，单位为 $\\mathrm{m}^2/\\mathrm{s}$。例如：[[valueA1,valueA2,valueA3],[valueB1,valueB2,valueB3],[valueC1,valueC2,valueC3]]。",
            "solution": "该问题要求推导并实现一个协议，用以确定用于布朗动力学（BD）模拟的校准扩散系数。这涉及将来自实验轨迹数据的估计与源自物理参数的独立估计相结合，同时恰当地考虑并传播不确定性。推导过程分三个阶段进行。\n\n### 1. 从轨迹数据估计扩散系数\n\n在过阻尼极限下，一个进行自由布朗运动的粒子的运动由朗之万方程描述。在没有外部确定性力的情况下，它简化为 $\\zeta \\frac{d\\mathbf{r}}{dt} = \\mathbf{F}_{\\text{rand}}(t)$，其中 $\\mathbf{r}(t)$ 是粒子在 $d$ 维空间中的位置矢量，$\\zeta$ 是摩擦系数，$\\mathbf{F}_{\\text{rand}}(t)$ 是一个高斯白噪声项，代表来自周围流体的随机热力。随机力的均值为零，$\\langle \\mathbf{F}_{\\text{rand}}(t) \\rangle = \\mathbf{0}$，其分量在时间和空间上不相关，其大小由涨落-耗散定理确定：$\\langle F_{\\text{rand},i}(t) F_{\\text{rand},j}(t') \\rangle = 2k_{\\mathrm{B}}T\\zeta \\delta_{ij} \\delta(t-t')$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\delta_{ij}$ 和 $\\delta(t-t')$ 分别是克罗内克 δ 和狄拉克 δ。\n\n在一个小的离散时间步长 $\\Delta t$ 上进行一阶数值积分（欧拉-丸山格式）得到位置增量：\n$$ \\Delta \\mathbf{r}_k = \\mathbf{r}((k+1)\\Delta t) - \\mathbf{r}(k\\Delta t) = \\frac{1}{\\zeta} \\int_{k\\Delta t}^{(k+1)\\Delta t} \\mathbf{F}_{\\text{rand}}(t') dt' $$\n对于每个空间分量 $i \\in \\{1, \\dots, d\\}$，增量 $\\Delta r_{k,i}$ 是一个高斯随机变量。其均值为 $\\langle \\Delta r_{k,i} \\rangle = 0$。其方差为：\n$$ \\langle (\\Delta r_{k,i})^2 \\rangle = \\frac{1}{\\zeta^2} \\int_{k\\Delta t}^{(k+1)\\Delta t} \\int_{k\\Delta t}^{(k+1)\\Delta t} \\langle F_{\\text{rand},i}(t') F_{\\text{rand},i}(t'') \\rangle dt' dt'' = \\frac{2k_{\\mathrm{B}}T}{\\zeta} \\int_{k\\Delta t}^{(k+1)\\Delta t} dt' = \\frac{2k_{\\mathrm{B}}T}{\\zeta} \\Delta t $$\n使用平移扩散系数的定义 $D = k_{\\mathrm{B}}T / \\zeta$，方差简化为：\n$$ \\langle (\\Delta r_{k,i})^2 \\rangle = 2D\\Delta t $$\n给定 $N$ 个独立的时间步，我们观测到 $dN$ 个独立的标量增量 $\\Delta r_{k,i}$，每个都从正态分布 $\\mathcal{N}(0, 2D\\Delta t)$ 中抽取。单个增量的概率密度为 $p(\\Delta r_{k,i} | D) = (4\\pi D \\Delta t)^{-1/2} \\exp\\left(-\\frac{(\\Delta r_{k,i})^2}{4D\\Delta t}\\right)$。整个观测集的似然函数是这些密度的乘积。对数似然 $\\ln L(D)$ 为：\n$$ \\ln L(D) = \\sum_{k=1}^N \\sum_{i=1}^d \\ln p(\\Delta r_{k,i} | D) = -\\frac{dN}{2} \\ln(4\\pi D \\Delta t) - \\frac{1}{4D\\Delta t} \\sum_{k=1}^N \\sum_{i=1}^d (\\Delta r_{k,i})^2 $$\n令 $S = \\sum_{k=1}^N \\sum_{i=1}^d (\\Delta r_{k,i})^2$ 为平方增量之和，这是作为输入提供的。\n$$ \\ln L(D) = -\\frac{dN}{2}\\ln(D) - \\frac{S}{4D\\Delta t} + \\text{const.} $$\n为了找到 $D$ 的最大似然估计量（MLE），我们对 $D$ 求导并令其结果为零：\n$$ \\frac{\\partial \\ln L}{\\partial D} = -\\frac{dN}{2D} + \\frac{S}{4D^2\\Delta t} = 0 \\implies \\widehat{D}_{\\text{BD}} = \\frac{S}{2dN\\Delta t} $$\n这就是我们从轨迹数据中得到的 $D$ 的估计量。为了找到其不确定性，我们计算其方差。量 $S/(2D\\Delta t)$ 服从自由度为 $dN$ 的卡方分布，$S/(2D\\Delta t) \\sim \\chi^2_{dN}$。一个 $\\chi^2_{k}$ 分布的均值是 $k$，方差是 $2k$。\n我们的估计量的期望是 $E[\\widehat{D}_{\\text{BD}}] = E\\left[\\frac{S}{2dN\\Delta t}\\right] = \\frac{2D\\Delta t}{2dN\\Delta t} E[\\chi^2_{dN}] = \\frac{D}{dN} (dN) = D$，因此该估计量是无偏的。\n估计量的方差为：\n$$ \\text{Var}(\\widehat{D}_{\\text{BD}}) = \\text{Var}\\left(\\frac{S}{2dN\\Delta t}\\right) = \\left(\\frac{2D\\Delta t}{2dN\\Delta t}\\right)^2 \\text{Var}(\\chi^2_{dN}) = \\left(\\frac{D}{dN}\\right)^2 (2dN) = \\frac{2D^2}{dN} $$\n由于真实的 $D$ 是未知的，我们通过用我们的估计 $\\widehat{D}_{\\text{BD}}$ 替代 $D$ 来近似方差。因此，该估计的不确定性度量是其标准差，我们估计为：\n$$ \\sigma_{\\text{BD}}^2 = \\text{Var}(\\widehat{D}_{\\text{BD}}) \\approx \\frac{2\\widehat{D}_{\\text{BD}}^2}{dN} $$\n\n### 2. 从物理参数估计扩散系数\n\n一个独立的 $D$ 的估计值可以从爱因斯坦关系得到，对于一个半径为 $a$ 的球形颗粒，在动力粘度为 $\\eta$、温度为 $T$ 的流体中，该关系为：\n$$ D = \\frac{k_{\\mathrm{B}} T}{6\\pi \\eta a} $$\n参数 $T$、$\\eta$ 和 $a$ 以带有高斯不确定性的测量值的形式给出：$T \\sim \\mathcal{N}(\\mu_T, \\sigma_T^2)$，$\\eta \\sim \\mathcal{N}(\\mu_\\eta, \\sigma_\\eta^2)$，以及 $a \\sim \\mathcal{N}(\\mu_a, \\sigma_a^2)$。为了将这些不确定性传播到 $D$，我们按要求使用蒙特卡洛方法。\n从它们各自的分布中抽取大量的样本值 $(T_j, \\eta_j, a_j)$（数量为 $M$）。为了确保物理有效性，任何非正值的样本都会在一个小的正阈值处被截断。对于每个样本三元组，计算一个扩散系数值 $D_j$：\n$$ D_j = \\frac{k_{\\mathrm{B}} T_j}{6\\pi \\eta_j a_j} $$\n集合 $\\{D_j\\}_{j=1}^M$ 构成了一个由物理参数不确定性所隐含的 $D$ 的概率分布的样本。通过此方法得到的 $D$ 的估计值 $\\widehat{D}_{\\text{phys}}$ 是样本均值：\n$$ \\widehat{D}_{\\text{phys}} = \\frac{1}{M}\\sum_{j=1}^M D_j $$\n相关的方差 $\\sigma_{\\text{phys}}^2$ 是 $D_j$ 值的样本方差，它量化了由于输入参数不确定性而导致的 $D$ 的不确定性：\n$$ \\sigma_{\\text{phys}}^2 = \\frac{1}{M-1}\\sum_{j=1}^M (D_j - \\widehat{D}_{\\text{phys}})^2 $$\n\n### 3. 独立估计的组合\n\n我们现在有两个对 $D$ 的独立估计：$\\widehat{D}_{\\text{BD}}$（方差为 $\\sigma_{\\text{BD}}^2$）和 $\\widehat{D}_{\\text{phys}}$（方差为 $\\sigma_{\\text{phys}}^2$）。假设两个估计量都近似服从高斯分布，那么最小化方差的最优组合估计是逆方差加权平均。设权重为 $w_1 = 1/\\sigma_{\\text{BD}}^2$ 和 $w_2 = 1/\\sigma_{\\text{phys}}^2$。\n校准后的扩散系数 $\\widehat{D}_{\\text{calib}}$ 为：\n$$ \\widehat{D}_{\\text{calib}} = \\frac{w_1 \\widehat{D}_{\\text{BD}} + w_2 \\widehat{D}_{\\text{phys}}}{w_1 + w_2} = \\frac{\\widehat{D}_{\\text{BD}}/\\sigma_{\\text{BD}}^2 + \\widehat{D}_{\\text{phys}}/\\sigma_{\\text{phys}}^2}{1/\\sigma_{\\text{BD}}^2 + 1/\\sigma_{\\text{phys}}^2} $$\n这个组合估计量的方差 $\\sigma_{\\text{calib}}^2$ 由下式给出：\n$$ \\sigma_{\\text{calib}}^2 = \\frac{1}{w_1 + w_2} = \\frac{1}{1/\\sigma_{\\text{BD}}^2 + 1/\\sigma_{\\text{phys}}^2} = \\frac{\\sigma_{\\text{BD}}^2 \\sigma_{\\text{phys}}^2}{\\sigma_{\\text{BD}}^2 + \\sigma_{\\text{phys}}^2} $$\n这个组合估计 $\\widehat{D}_{\\text{calib}}$ 是在 BD 模拟中使用的最符合原理的值，因为它整合了所有可用的信息。该值的不确定性由一个 $95\\%$ 的覆盖区间来量化。假设组合估计量也服从高斯分布，则该区间为 $[\\text{lower}, \\text{upper}]$，其中：\n$$ \\text{lower} = \\widehat{D}_{\\text{calib}} - z \\cdot \\sigma_{\\text{calib}} \\quad \\text{and} \\quad \\text{upper} = \\widehat{D}_{\\text{calib}} + z \\cdot \\sigma_{\\text{calib}} $$\n这里，$\\sigma_{\\text{calib}} = \\sqrt{\\sigma_{\\text{calib}}^2}$，$z$ 是对应于 $95\\%$ 覆盖率的标准正态分布的临界值，它对应于 $0.975$ 分位数。该值为 $z \\approx 1.95996$。\n每个测试用例的最终输出将是列表 $[\\widehat{D}_{\\text{calib}}, \\text{lower}, \\text{upper}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Derives and implements a protocol to calculate a calibrated diffusion coefficient\n    by combining estimates from Brownian trajectory data and physical parameters.\n    \"\"\"\n    # Define physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {'d': 2, 'N': 1000, 'dt': 0.01, 'S': 1.65e-11,\n         'T_mean': 298.0, 'T_std': 1.0,\n         'eta_mean': 1.0e-3, 'eta_std': 5.0e-5,\n         'a_mean': 5.0e-7, 'a_std': 5.0e-8},\n        # Case B\n        {'d': 3, 'N': 300, 'dt': 0.05, 'S': 8.7e-12,\n         'T_mean': 310.0, 'T_std': 2.0,\n         'eta_mean': 2.0e-3, 'eta_std': 1.0e-4,\n         'a_mean': 1.2e-6, 'a_std': 1.0e-7},\n        # Case C\n        {'d': 2, 'N': 20, 'dt': 0.1, 'S': 1.4e-11,\n         'T_mean': 295.0, 'T_std': 3.0,\n         'eta_mean': 8.0e-4, 'eta_std': 2.0e-4,\n         'a_mean': 3.0e-7, 'a_std': 5.0e-8},\n    ]\n\n    # Set up Monte Carlo simulation parameters\n    MC_SAMPLES = 200000\n    # Set a fixed seed for reproducibility. The problem requires this.\n    np.random.seed(42)\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters\n        d, N, dt, S = case['d'], case['N'], case['dt'], case['S']\n        T_mean, T_std = case['T_mean'], case['T_std']\n        eta_mean, eta_std = case['eta_mean'], case['eta_std']\n        a_mean, a_std = case['a_mean'], case['a_std']\n\n        # --- Step 1: Estimate D from trajectory data (BD model) ---\n        d_BD = S / (2 * d * N * dt)\n        var_d_BD = (2 * d_BD**2) / (d * N)\n\n        # --- Step 2: Estimate D from physical parameters (Einstein relation) ---\n        # Generate random samples for T, eta, a\n        T_samples = np.random.normal(T_mean, T_std, MC_SAMPLES)\n        eta_samples = np.random.normal(eta_mean, eta_std, MC_SAMPLES)\n        a_samples = np.random.normal(a_mean, a_std, MC_SAMPLES)\n\n        # Truncate samples to ensure positivity\n        T_samples = np.maximum(1.0, T_samples)\n        eta_samples = np.maximum(1.0e-12, eta_samples)\n        a_samples = np.maximum(1.0e-12, a_samples)\n\n        # Calculate D for each sample set\n        D_phys_samples = (K_B * T_samples) / (6 * np.pi * eta_samples * a_samples)\n\n        # Compute mean and variance from the Monte Carlo samples\n        d_phys = np.mean(D_phys_samples)\n        var_d_phys = np.var(D_phys_samples, ddof=1) # Use ddof=1 for sample variance\n\n        # --- Step 3: Combine the two estimates ---\n        # Use inverse-variance weighting\n        w_BD = 1 / var_d_BD\n        w_phys = 1 / var_d_phys\n\n        # Combined (calibrated) estimate for D\n        d_calib = (d_BD * w_BD + d_phys * w_phys) / (w_BD + w_phys)\n        \n        # Variance of the combined estimate\n        var_d_calib = 1 / (w_BD + w_phys)\n        std_d_calib = np.sqrt(var_d_calib)\n\n        # Calculate the 95% coverage interval\n        z_95 = norm.ppf(0.975) # z-score for 95% confidence\n        lower_bound = d_calib - z_95 * std_d_calib\n        upper_bound = d_calib + z_95 * std_d_calib\n\n        results.append([d_calib, lower_bound, upper_bound])\n    \n    # Format the final output string exactly as required\n    formatted_results = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in results]\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}