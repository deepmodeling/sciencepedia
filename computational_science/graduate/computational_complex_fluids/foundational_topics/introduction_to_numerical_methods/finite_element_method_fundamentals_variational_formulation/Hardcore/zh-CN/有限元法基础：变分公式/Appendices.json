{
    "hands_on_practices": [
        {
            "introduction": "本节实践将从有限元方法的最基本原理入手。我们将亲手为一个最简单的单元类型——线性三角形单元，计算其局部质量矩阵和刚度矩阵。这项练习至关重要，因为它揭示了如何将变分公式中的抽象双线性形式转化为具体的数值数组，而这些数组正是构成全局方程组的基本构件。",
            "id": "4087582",
            "problem": "在计算复杂流体的背景下，考虑一个标量输运量，其半离散有限元近似源于一个标准的 Galerkin 变分形式。离散算子涉及局部质量矩阵和刚度矩阵，它们分别由双线性形式 $m(u,v)=\\int_{K}uv\\,dx$ 和 $a(u,v)=\\int_{K}\\nabla u\\cdot\\nabla v\\,dx$ 定义。设 $K$ 为平面上顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的参考三角形，并设 $\\{\\phi_{i}\\}_{i=1}^{3}$ 为与这些顶点相关联的标准线性 Lagrange 节点基（有时称为 $P1$），在笛卡尔坐标 $x$ 和 $y$ 下表示为 $\\phi_{1}(x,y)=1-x-y$，$\\phi_{2}(x,y)=x$ 和 $\\phi_{3}(x,y)=y$。从双线性形式的定义出发，计算参考单元 $K$ 上对于 $i,j\\in\\{1,2,3\\}$ 的局部质量矩阵元 $M_{ij}=\\int_{K}\\phi_{i}\\phi_{j}\\,dx$ 和局部刚度矩阵元 $A_{ij}=\\int_{K}\\nabla\\phi_{i}\\cdot\\nabla\\phi_{j}\\,dx$。您必须直接从上述基本定义推导这些量，而不使用任何预先记下的单元级公式。将您的最终答案表示为一个复合解析表达式，其中包含两个并排排列在单个行矩阵中的矩阵。请使用精确有理数，无需四舍五入。不需要物理单位。",
            "solution": "出发点是计算复杂流体中扩散型算子的 Galerkin 变分形式，其中离散质量矩阵和刚度矩阵分别由双线性形式 $m(u,v)=\\int_{K}uv\\,dx$ 和 $a(u,v)=\\int_{K}\\nabla u\\cdot\\nabla v\\,dx$ 定义。在顶点为 $(0,0)$、$(1,0)$、$(0,1)$ 的参考三角形 $K=\\{(x,y)\\in\\mathbb{R}^{2}:\\,x\\ge 0,\\ y\\ge 0,\\ x+y\\le 1\\}$ 上，其面积为 $|K|=\\frac{1}{2}$。线性 Lagrange 基函数为 $\\phi_{1}(x,y)=1-x-y$，$\\phi_{2}(x,y)=x$ 和 $\\phi_{3}(x,y)=y$，它们的梯度是常数向量：\n$$\n\\nabla\\phi_{1}=\\begin{pmatrix}-1\\\\-1\\end{pmatrix},\\quad\n\\nabla\\phi_{2}=\\begin{pmatrix}1\\\\0\\end{pmatrix},\\quad\n\\nabla\\phi_{3}=\\begin{pmatrix}0\\\\1\\end{pmatrix}.\n$$\n我们首先计算刚度矩阵的元素。由于梯度在 $K$ 上是常数，每个元素都是常数点积乘以 $K$ 的面积：\n$$\nA_{ij}=\\int_{K}\\nabla\\phi_{i}\\cdot\\nabla\\phi_{j}\\,dx = \\left(\\nabla\\phi_{i}\\cdot\\nabla\\phi_{j}\\right)|K|.\n$$\n点积为\n$$\n\\nabla\\phi_{1}\\cdot\\nabla\\phi_{1}=(-1)(-1)+(-1)(-1)=2,\\quad\n\\nabla\\phi_{2}\\cdot\\nabla\\phi_{2}=1,\\quad\n\\nabla\\phi_{3}\\cdot\\nabla\\phi_{3}=1,\n$$\n$$\n\\nabla\\phi_{1}\\cdot\\nabla\\phi_{2}=(-1)(1)+(-1)(0)=-1,\\quad\n\\nabla\\phi_{1}\\cdot\\nabla\\phi_{3}=(-1)(0)+(-1)(1)=-1,\\quad\n\\nabla\\phi_{2}\\cdot\\nabla\\phi_{3}=(1)(0)+(0)(1)=0.\n$$\n乘以 $|K|=\\frac{1}{2}$ 可得\n$$\nA_{11}=2\\cdot\\frac{1}{2}=1,\\quad A_{22}=1\\cdot\\frac{1}{2}=\\frac{1}{2},\\quad A_{33}=1\\cdot\\frac{1}{2}=\\frac{1}{2},\n$$\n$$\nA_{12}=A_{21}=-1\\cdot\\frac{1}{2}=-\\frac{1}{2},\\quad\nA_{13}=A_{31}=-1\\cdot\\frac{1}{2}=-\\frac{1}{2},\\quad\nA_{23}=A_{32}=0\\cdot\\frac{1}{2}=0.\n$$\n因此，\n$$\nA=\\begin{pmatrix}\n1  -\\frac{1}{2}  -\\frac{1}{2} \\\\\n-\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  0  \\frac{1}{2}\n\\end{pmatrix}.\n$$\n接下来我们计算质量矩阵元 $M_{ij}=\\int_{K}\\phi_{i}\\phi_{j}\\,dx$。我们将积分域参数化为 $0\\le x\\le 1$，$0\\le y\\le 1-x$，因此\n$$\n\\int_{K} f(x,y)\\,dx=\\int_{x=0}^{1}\\int_{y=0}^{1-x} f(x,y)\\,dy\\,dx.\n$$\n我们计算一组代表性的积分，并在适当的地方利用对称性。\n\n对于对角元素：\n1. $M_{22}=\\int_{K}x^{2}\\,dx=\\int_{0}^{1}\\int_{0}^{1-x} x^{2}\\,dy\\,dx=\\int_{0}^{1} x^{2}(1-x)\\,dx=\\int_{0}^{1}(x^{2}-x^{3})\\,dx=\\frac{1}{3}-\\frac{1}{4}=\\frac{1}{12}.$\n2. $M_{33}=\\int_{K}y^{2}\\,dx$ 根据对称性等于 $M_{22}$，因此 $M_{33}=\\frac{1}{12}.$\n3. $M_{11}=\\int_{K}(1-x-y)^{2}\\,dx=\\int_{0}^{1}\\int_{0}^{1-x}(1-2x-2y+x^{2}+2xy+y^{2})\\,dy\\,dx.$\n逐项计算内层积分：\n$$\n\\int_{0}^{1-x}1\\,dy=1-x,\\quad \\int_{0}^{1-x}y\\,dy=\\frac{(1-x)^{2}}{2},\\quad \\int_{0}^{1-x}y^{2}\\,dy=\\frac{(1-x)^{3}}{3},\\quad \\int_{0}^{1-x}xy\\,dy=x\\frac{(1-x)^{2}}{2}.\n$$\n因此\n$$\nM_{11}=\\int_{0}^{1}\\Big[(1-x)-2x(1-x)-2\\cdot\\frac{(1-x)^{2}}{2}+x^{2}(1-x)+2x\\cdot\\frac{(1-x)^{2}}{2}+\\frac{(1-x)^{3}}{3}\\Big]\\,dx.\n$$\n简化内部：\n$$\n(1-x)-2x(1-x)-(1-x)^{2}+x^{2}(1-x)+x(1-x)^{2}+\\frac{(1-x)^{3}}{3}.\n$$\n为简洁起见，令 $t=1-x$；则 $x=1-t$，被积函数变为\n$$\nt-2(1-t)t - t^{2} + (1-t)^{2}t + (1-t)t^{2} + \\frac{t^{3}}{3}.\n$$\n展开：\n$$\nt - 2t + 2t^{2} - t^{2} + (1 - 2t + t^{2})t + t^{2} - t^{3} + \\frac{t^{3}}{3}\n= (-t) + (2t^{2}-t^{2}+t^{2}) + (t - 2t^{2} + t^{3}) + (- t^{3}) + \\frac{t^{3}}{3}.\n$$\n合并同类项：\n- $t$ 的一次项：$-t + t = 0$。\n- $t$ 的二次项：$2t^{2}-t^{2}+t^{2}-2t^{2} = 0$。\n- $t$ 的三次项：$t^{3} - t^{3} + \\frac{t^{3}}{3} = \\frac{t^{3}}{3}$。\n因此被积函数简化为 $\\frac{t^{3}}{3}=\\frac{(1-x)^{3}}{3}$。所以\n$$\nM_{11}=\\int_{0}^{1}\\frac{(1-x)^{3}}{3}\\,dx=\\frac{1}{3}\\int_{0}^{1}(1-3x+3x^{2}-x^{3})\\,dx=\\frac{1}{3}\\left[1 - \\frac{3}{2} + 1 - \\frac{1}{4}\\right]=\\frac{1}{3}\\cdot\\frac{1}{4}=\\frac{1}{12}.\n$$\n对于非对角元素：\n4. $M_{23}=\\int_{K}xy\\,dx=\\int_{0}^{1}\\int_{0}^{1-x} x y\\,dy\\,dx=\\int_{0}^{1} x\\cdot \\frac{(1-x)^{2}}{2}\\,dx=\\frac{1}{2}\\int_{0}^{1}\\left(x - 2x^{2} + x^{3}\\right)\\,dx=\\frac{1}{2}\\left(\\frac{1}{2}-\\frac{2}{3}+\\frac{1}{4}\\right)=\\frac{1}{24}.$\n5. $M_{12}=\\int_{K}x(1-x-y)\\,dx=\\int_{0}^{1}\\int_{0}^{1-x}(x - x^{2} - xy)\\,dy\\,dx=\\int_{0}^{1}\\left[x(1-x) - x^{2}(1-x) - x\\frac{(1-x)^{2}}{2}\\right]dx.$\n逐项计算：\n$$\n\\int_{0}^{1}x(1-x)\\,dx=\\int_{0}^{1}(x - x^{2})\\,dx=\\frac{1}{2}-\\frac{1}{3}=\\frac{1}{6},\n$$\n$$\n\\int_{0}^{1}x^{2}(1-x)\\,dx=\\int_{0}^{1}(x^{2}-x^{3})\\,dx=\\frac{1}{3}-\\frac{1}{4}=\\frac{1}{12},\n$$\n$$\n\\int_{0}^{1}x\\frac{(1-x)^{2}}{2}\\,dx=\\frac{1}{2}\\int_{0}^{1}(x - 2x^{2} + x^{3})\\,dx=\\frac{1}{2}\\left(\\frac{1}{2}-\\frac{2}{3}+\\frac{1}{4}\\right)=\\frac{1}{24}.\n$$\n因此 $M_{12}=\\frac{1}{6}-\\frac{1}{12}-\\frac{1}{24}=\\frac{4-2-1}{24}=\\frac{1}{24}.$\n6. 根据对称性，$M_{13}=\\frac{1}{24}$。\n\n汇总这些结果，\n$$\nM=\\begin{pmatrix}\n\\frac{1}{12}  \\frac{1}{24}  \\frac{1}{24} \\\\\n\\frac{1}{24}  \\frac{1}{12}  \\frac{1}{24} \\\\\n\\frac{1}{24}  \\frac{1}{24}  \\frac{1}{12}\n\\end{pmatrix}=\\frac{1}{24}\\begin{pmatrix}\n2  1  1 \\\\\n1  2  1 \\\\\n1  1  2\n\\end{pmatrix}.\n$$\n将两个矩阵并排放置在一个行矩阵中得到的最终复合解析表达式，是通过将 $M$ 和 $A$ 作为外部行矩阵的元素来获得的。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{24}\\begin{pmatrix}2  1  1 \\\\ 1  2  1 \\\\ 1  1  2\\end{pmatrix}  \\begin{pmatrix}1  -\\frac{1}{2}  -\\frac{1}{2} \\\\ -\\frac{1}{2}  \\frac{1}{2}  0 \\\\ -\\frac{1}{2}  0  \\frac{1}{2}\\end{pmatrix}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在定义了单元矩阵的积分表达式之后，下一个实际挑战是如何计算这些积分。虽然对于最简单的情况，解析积分是可行的，但对于更复杂的单元，则必须依赖数值求积。本练习探讨了基函数的 polynomial 次数与所选求积法则所需精度之间的联系，这是确保有限元解的准确性和稳定性的一个关键考量。",
            "id": "4087531",
            "problem": "考虑一个代表不可压缩复杂流体中粘性耗散项的稳态扩散模型：在一个多边形域中，求解 $u$ 使得 $-\\nabla \\cdot (\\mu \\nabla u) = f$，其中 $\\mu$ 是一个正的粘度参数。在有限元法（FEM）中，在一个协调的三角形网格上使用二次拉格朗日多项式（$P2$）基函数，单个三角形 $K$ 上的单元刚度矩阵的元素为 $A_{ij} = \\int_{K} \\mu \\, \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\, \\mathrm{d}x$，其中 $\\{\\varphi_{i}\\}$ 是 $K$ 上的局部 $P2$ 基函数。假设在每个单元 $K$ 上，从参考三角形 $\\hat{K}$ 的映射是仿射的，即 $F(\\hat{x}) = B \\hat{x} + b$，其中雅可比矩阵 $B$ 为常数，并且 $\\mu$ 在每个单元上是常数（分片常数）。\n\n从弱形式以及仿射映射下梯度的变换法则出发，确定每个局部刚度矩阵元素 $A_{ij}$ 中被积函数的总多项式次数，作为三角形上拉格朗日基多项式次数 $k$ 的函数。然后，将其特化为 $k = 2$ 的情况，并推导出为在每个单元 $K$ 上精确积分所有这些元素，三角形求积法则所需的最小精确度 $q$。最后，在对称高斯型三角形求积法则中，选择一个尺寸最小且能对所有次数最高为 $q$ 的多项式达到精确积分的法则，并报告所需的最小求积点数 $N$。\n\n最终答案请提供单个整数 $N$。无需四舍五入。",
            "solution": "任务是确定在有限元法（FEM）的背景下，为精确计算单元刚度矩阵的元素所需的最小求积点数 $N$。该问题由稳态扩散方程 $-\\nabla \\cdot (\\mu \\nabla u) = f$ 定义，并使用二次拉格朗日（$P2$）基函数在三角形网格上进行离散。\n\n在单个三角形单元 $K$ 上的单元刚度矩阵的元素由以下积分给出：\n$$\nA_{ij} = \\int_{K} \\mu \\, \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\, \\mathrm{d}x\n$$\n在这里，$\\mu$ 在单元 $K$ 上是一个常数，且 $\\{\\varphi_i\\}$ 是局部 $P2$ 基函数。\n\n为了确定所需的求积精度，我们必须首先求出被积函数的多项式次数。这通常通过将积分从物理单元 $K$ 变换到规范的参考单元 $\\hat{K}$ 来完成。\n\n问题陈述，从参考单元 $\\hat{K}$ 到物理单元 $K$ 的映射是仿射的：\n$$\nx = F(\\hat{x}) = B \\hat{x} + b\n$$\n其中 $B$ 是变换的常数雅可比矩阵，$b$ 是一个常数向量。积分中的变量替换会引入雅可比行列式 $|\\det(B)|$，对于这种仿射映射，它是一个常数。\n\n物理单元上的基函数 $\\varphi_i$ 是次数为 $k$ 的多项式，它们通过 $\\varphi_i(x) = \\hat{\\varphi}_i(F^{-1}(x))$ 与参考单元上的基函数 $\\hat{\\varphi}_i$ 相关联。函数 $\\hat{\\varphi}_i(\\hat{x})$ 是参考坐标 $\\hat{x}$ 中次数为 $k$ 的多项式。\n\n基函数 $\\varphi_i$ 在物理坐标 $x$ 中的梯度通过链式法则与 $\\hat{\\varphi}_i$ 在参考坐标 $\\hat{x}$ 中的梯度相关联：\n$$\n\\nabla_x \\varphi_i = (B^{-1})^T \\nabla_{\\hat{x}} \\hat{\\varphi}_i\n$$\n由于 $\\hat{\\varphi}_i$ 是一个次数为 $k$ 的多项式，它的梯度 $\\nabla_{\\hat{x}} \\hat{\\varphi}_i$ 是一个向量，其分量是参考坐标 $\\hat{x}$ 中次数为 $k-1$ 的多项式。由于矩阵 $(B^{-1})^T$ 是常数，向量 $\\nabla_x \\varphi_i$ 由 $\\hat{x}$ 中次数为 $k-1$ 的多项式组成。\n\n接下来，我们分析点积项 $\\nabla \\varphi_i \\cdot \\nabla \\varphi_j$。这是两个向量的标量积，其分量是次数为 $k-1$ 的多项式。得到的标量函数是一个次数最多为 $(k-1) + (k-1) = 2k-2$ 的多项式。\n$$\n\\text{degree}(\\nabla \\varphi_i \\cdot \\nabla \\varphi_j) = 2k-2\n$$\n刚度矩阵元素的完整被积函数，在参考坐标系中表示为：\n$$\n\\text{Integrand}(\\hat{x}) = \\mu \\, (\\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j}) \\, |\\det(B)|\n$$\n参数 $\\mu$ 被设定为分片常数，所以它在单元 $K$ 上是一个常数（0次多项式）。雅可比行列式 $|\\det(B)|$ 也是一个常数。因此，要在参考单元 $\\hat{K}$ 上积分的函数的总多项式次数完全由点积项决定，即 $2k-2$。\n\n问题指定使用二次拉格朗日（$P2$）基函数。对于这些函数，多项式次数为 $k=2$。将这个值代入我们的被积函数次数公式，得到：\n$$\n\\text{Degree of integrand} = 2(2) - 2 = 2\n$$\n因此，被积函数是一个2次多项式。数值求积法则必须能够精确积分所有次数最高为该次数的多项式。因此，求积法则所需的最小精确度为 $q=2$。\n\n最后一步是找到具有最小点数 $N$ 的对称三角形求积法则，它对所有次数最高为 $q=2$ 的多项式都是精确的。我们考虑标准的三角形对称求积法则：\n\\begin{itemize}\n    \\item 1点法则（$N=1$），使用单元的形心，对次数最高为 $q=1$ 的多项式是精确的。这不满足要求。\n    \\item 对称的3点法则（$N=3$），使用三条边的中点作为求积点，对次数最高为 $q=2$ 的多项式是精确的。这满足要求。\n    \\item 更高阶的法则，例如4点法则（$q=3$），也能用，但不是尺寸最小的。\n\\end{itemize}\n对于三角形，不存在 $N=2$ 个点的对称法则。因此，要使对称法则对2次多项式达到精确积分，所需的最小点数为 $N=3$。\n\n所需的最小求积点数是 3。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "复杂流体领域中许多实际问题，例如由 Navier-Stokes 方程控制的问题，本质上是非线性的。这种非线性特性要求使用像牛顿法这样的迭代求解器，而牛顿法的应用又依赖于系统的雅可比矩阵。这项高级实践将演示如何运用变分框架，直接从控制方程的弱形式中推导出这个雅可比矩阵，即所谓的“一致切线算子”。",
            "id": "4087561",
            "problem": "考虑在有界域 $\\Omega \\subset \\mathbb{R}^{d}$（$d \\in \\{2,3\\}$）内一种牛顿流体的稳态不可压缩流动，其边界 $\\partial \\Omega$ 上的外单位法向量为 $\\boldsymbol{n}$。控制偏微分方程 (PDE) 模型为稳态不可压缩 Navier–Stokes 方程，具有恒定密度 $\\rho > 0$ 和动力粘度 $\\mu > 0$，并服从于边界 $\\partial \\Omega$ 上的齐次 Dirichlet 边界条件 $\\boldsymbol{u} = \\boldsymbol{0}$：\n$$\n\\rho (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u},p) = \\boldsymbol{f} \\quad \\text{in } \\Omega, \\qquad \\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega,\n$$\n其中 $\\boldsymbol{u}:\\Omega \\to \\mathbb{R}^{d}$ 是速度，$p:\\Omega \\to \\mathbb{R}$ 是压力，$\\boldsymbol{f}:\\Omega \\to \\mathbb{R}^{d}$ 是体积力，牛顿流体的 Cauchy 应力张量由下式给出\n$$\n\\boldsymbol{\\sigma}(\\boldsymbol{u},p) = -p \\boldsymbol{I} + 2\\mu \\boldsymbol{D}(\\boldsymbol{u}), \\quad \\text{with } \\boldsymbol{D}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right).\n$$\n令试探空间为 $\\boldsymbol{V} := \\{\\boldsymbol{v} \\in [H^{1}_{0}(\\Omega)]^{d}\\}$ 和 $Q := \\{q \\in L^{2}_{0}(\\Omega)\\}$，并令相应的测试空间与之一致。对于计算流体力学 (CFD) 中的有限元法 (FEM)，其弱形式残差算子对于给定的对 $(\\boldsymbol{u},p) \\in \\boldsymbol{V} \\times Q$ 和测试对 $(\\boldsymbol{w},q) \\in \\boldsymbol{V} \\times Q$ 定义为：\n$$\n\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q) := \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} p \\, \\nabla \\cdot \\boldsymbol{w} \\, \\mathrm{d}x + \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{u} \\, \\mathrm{d}x - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x.\n$$\n将 $\\mathcal{R}$ 关于 $(\\boldsymbol{u},p)$ 沿方向 $(\\delta \\boldsymbol{u}, \\delta p) \\in \\boldsymbol{V} \\times Q$ 的 Gateaux 导数定义为\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] := \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}\\, \\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u},\\, p + \\varepsilon \\delta p;\\, \\boldsymbol{w},q)\\right|_{\\varepsilon = 0}.\n$$\n仅从上述定义以及张量微积分和弱形式的基本定律与性质出发，推导 $\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p]$ 的显式解析表达式，该表达式构成了弱形式牛顿法所需的一致切线算子。你的最终答案应该是该 Gateaux 导数的闭式积分表达式，该表达式是关于 $(\\delta \\boldsymbol{u}, \\delta p)$ 和测试函数 $(\\boldsymbol{w},q)$ 的双线性形式，并用当前迭代解 $(\\boldsymbol{u},p)$、参数 $\\rho$ 和 $\\mu$ 以及上面定义的算子来表示。如果引入任何中间符号，请明确定义它们。无需进行四舍五入。最终结果请勿包含物理单位。",
            "solution": "该问题陈述是计算流体力学领域中一个有效、适定且有科学依据的问题。它要求推导稳态不可压缩 Navier–Stokes 方程弱形式的一致切线算子。该算子是弱形式残差的 Gateaux 导数，是使用牛顿法求解由有限元法 (FEM) 离散化产生的非线性代数系统的基本组成部分。我将进行严格的推导。\n\n我们的目标是计算弱形式残差算子 $\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)$ 关于状态变量 $(\\boldsymbol{u},p) \\in \\boldsymbol{V} \\times Q$ 沿任意增量 $(\\delta \\boldsymbol{u}, \\delta p) \\in \\boldsymbol{V} \\times Q$ 方向的 Gateaux 导数。所提供的定义是：\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] := \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}\\, \\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u},\\, p + \\varepsilon \\delta p;\\, \\boldsymbol{w},q)\\right|_{\\varepsilon = 0}\n$$\n其中 $\\boldsymbol{V} := \\{\\boldsymbol{v} \\in [H^{1}_{0}(\\Omega)]^{d}\\}$ 且 $Q := \\{q \\in L^{2}_{0}(\\Omega)\\}$。\n\n弱形式残差算子由下式给出：\n$$\n\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q) := \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} p \\, \\nabla \\cdot \\boldsymbol{w} \\, \\mathrm{d}x + \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{u} \\, \\mathrm{d}x - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x\n$$\n为计算导数，我们首先将微扰状态 $(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}, p + \\varepsilon \\delta p)$ 代入 $\\mathcal{R}$ 的表达式中：\n\\begin{align*}\n\\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}, p + \\varepsilon \\delta p; \\boldsymbol{w},q) =  \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left(((\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\cdot \\nabla)(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u})\\right) \\, \\mathrm{d}x \\\\\n + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x \\\\\n - \\int_{\\Omega} (p + \\varepsilon \\delta p) \\, \\nabla \\cdot \\boldsymbol{w} \\, \\mathrm{d}x \\\\\n + \\int_{\\Omega} q \\, \\nabla \\cdot (\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\, \\mathrm{d}x \\\\\n - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x\n\\end{align*}\n我们可以通过检查每一项对参数 $\\varepsilon$ 的依赖性来分析该导数。我们记 $\\mathcal{R}_{\\varepsilon} = \\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}, p + \\varepsilon \\delta p; \\boldsymbol{w},q)$。通过对 $\\mathcal{R}_{\\varepsilon}$ 关于 $\\varepsilon$ 求导并令 $\\varepsilon = 0$ 即可得到该导数。由于关于 $\\varepsilon$ 的积分和微分是可交换的（根据 Leibniz 积分法则，因为域 $\\Omega$ 是固定的），我们可以对每一项的被积函数进行微分。\n\n1.  **对流项：**\n    令 $I_1(\\varepsilon) = \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left(((\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\cdot \\nabla)(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u})\\right) \\, \\mathrm{d}x$。\n    积分内的项是关于 $\\varepsilon$ 的二次项：\n    $$\n    ((\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\cdot \\nabla)(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) = (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} + \\varepsilon (\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + \\varepsilon (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} + \\varepsilon^2 (\\delta \\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u}\n    $$\n    对此表达式关于 $\\varepsilon$ 求导并在 $\\varepsilon = 0$ 处取值，得到：\n    $$\n    \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon} \\left[ (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} + \\varepsilon ((\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}) + \\varepsilon^2 (\\delta \\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} \\right]\\right|_{\\varepsilon=0} = (\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\n    $$\n    因此，第一个积分项的导数为：\n    $$\n    \\left.\\frac{\\mathrm{d}I_1}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left( (\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} \\right) \\, \\mathrm{d}x\n    $$\n\n2.  **扩散项：**\n    令 $I_2(\\varepsilon) = \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x$。\n    应变率张量算子 $\\boldsymbol{D}$ 是线性的。因此：\n    $$\n    \\boldsymbol{D}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) = \\boldsymbol{D}(\\boldsymbol{u}) + \\varepsilon \\boldsymbol{D}(\\delta \\boldsymbol{u})\n    $$\n    项 $I_2(\\varepsilon)$ 是关于 $\\varepsilon$ 的线性项。其导数即为 $\\varepsilon$ 的系数：\n    $$\n    \\left.\\frac{\\mathrm{d}I_2}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x\n    $$\n\n3.  **压力项：**\n    令 $I_3(\\varepsilon) = - \\int_{\\Omega} (p + \\varepsilon \\delta p) \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x$。\n    此项也是关于 $\\varepsilon$ 的线性项。其导数就是 $\\varepsilon$ 的系数：\n    $$\n    \\left.\\frac{\\mathrm{d}I_3}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = - \\int_{\\Omega} \\delta p \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x\n    $$\n\n4.  **连续性项：**\n    令 $I_4(\\varepsilon) = \\int_{\\Omega} q \\, \\nabla \\cdot (\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\, \\mathrm{d}x$。\n    散度算子 $\\nabla \\cdot$ 是线性的。因此：\n    $$\n    \\nabla \\cdot (\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) = \\nabla \\cdot \\boldsymbol{u} + \\varepsilon (\\nabla \\cdot \\delta \\boldsymbol{u})\n    $$\n    项 $I_4(\\varepsilon)$ 是关于 $\\varepsilon$ 的线性项，其导数是 $\\varepsilon$ 的系数：\n    $$\n    \\left.\\frac{\\mathrm{d}I_4}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\int_{\\Omega} q \\, (\\nabla \\cdot \\delta \\boldsymbol{u}) \\, \\mathrm{d}x\n    $$\n\n5.  **强迫项：**\n    令 $I_5(\\varepsilon) = - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x$。\n    此项与 $\\varepsilon$ 无关，因此其导数为零：\n    $$\n    \\left.\\frac{\\mathrm{d}I_5}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = 0\n    $$\n\n将所有项的导数相加，得到 Gateaux 导数的最终表达式：\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] = \\left.\\frac{\\mathrm{d}I_1}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_2}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_3}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_4}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_5}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0}\n$$\n代入推导出的表达式，得到一致切线算子：\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] = \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} \\delta p \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x + \\int_{\\Omega} q \\, (\\nabla \\cdot \\delta \\boldsymbol{u}) \\, \\mathrm{d}x\n$$\n此表达式是关于增量 $(\\delta \\boldsymbol{u}, \\delta p)$ 和测试函数 $(\\boldsymbol{w},q)$ 的双线性形式，并且它依赖于当前的解迭代值 $\\boldsymbol{u}$，这与应用于此非线性问题的牛顿法中的雅可比矩阵的预期相符。",
            "answer": "$$\n\\boxed{\\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} \\delta p \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x + \\int_{\\Omega} q \\, (\\nabla \\cdot \\delta \\boldsymbol{u}) \\, \\mathrm{d}x}\n$$"
        }
    ]
}