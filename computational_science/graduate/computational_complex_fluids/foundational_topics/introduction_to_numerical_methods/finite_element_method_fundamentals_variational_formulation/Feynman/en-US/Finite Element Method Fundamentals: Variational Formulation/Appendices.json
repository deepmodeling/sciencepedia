{
    "hands_on_practices": [
        {
            "introduction": "The heart of the Finite Element Method lies in breaking down a complex problem into simpler parts, solved on canonical \"reference\" elements. This first exercise provides fundamental practice by having you derive the local mass and stiffness matrices for the linear triangular ($P1$) element directly from their integral definitions. Mastering this foundational calculation  is the essential first step toward understanding how the global system of equations in any FEM solver is constructed.",
            "id": "4087582",
            "problem": "In the context of computational complex fluids, consider a scalar transport quantity whose semi-discrete finite element approximation arises from a standard Galerkin variational formulation. The discrete operators involve the local mass and stiffness matrices defined by the bilinear forms $m(u,v)=\\int_{K}uv\\,dx$ and $a(u,v)=\\int_{K}\\nabla u\\cdot\\nabla v\\,dx$, respectively. Let $K$ be the reference triangle with vertices at $(0,0)$, $(1,0)$, and $(0,1)$ in the plane, and let $\\{\\phi_{i}\\}_{i=1}^{3}$ be the standard linear Lagrange nodal basis (sometimes called $P1$) associated to these vertices, represented in Cartesian coordinates by $x$ and $y$ as $\\phi_{1}(x,y)=1-x-y$, $\\phi_{2}(x,y)=x$, and $\\phi_{3}(x,y)=y$. Starting from the definitions of the bilinear forms, compute the local mass matrix entries $M_{ij}=\\int_{K}\\phi_{i}\\phi_{j}\\,dx$ and the local stiffness matrix entries $A_{ij}=\\int_{K}\\nabla\\phi_{i}\\cdot\\nabla\\phi_{j}\\,dx$ for $i,j\\in\\{1,2,3\\}$ on the reference element $K$. You must derive these quantities directly from the fundamental definitions above, without invoking pre-memorized element-level formulas. Express your final answer as a single composite analytical expression containing both matrices grouped side-by-side in a single row matrix. Use exact rational numbers; no rounding is required. No physical units are needed.",
            "solution": "The starting point is the Galerkin variational formulation for diffusion-type operators in computational complex fluids, where the discrete mass and stiffness matrices are defined by the bilinear forms $m(u,v)=\\int_{K}u\\,v\\,dx$ and $a(u,v)=\\int_{K}\\nabla u\\cdot\\nabla v\\,dx$, respectively. On the reference triangle $K=\\{(x,y)\\in\\mathbb{R}^{2}:\\,x\\ge 0,\\ y\\ge 0,\\ x+y\\le 1\\}$ with vertices $(0,0)$, $(1,0)$, $(0,1)$, the area is $|K|=\\frac{1}{2}$. The linear Lagrange basis functions are $\\phi_{1}(x,y)=1-x-y$, $\\phi_{2}(x,y)=x$, and $\\phi_{3}(x,y)=y$, and their gradients are constant vectors:\n$$\n\\nabla\\phi_{1}=\\begin{pmatrix}-1\\\\-1\\end{pmatrix},\\quad\n\\nabla\\phi_{2}=\\begin{pmatrix}1\\\\0\\end{pmatrix},\\quad\n\\nabla\\phi_{3}=\\begin{pmatrix}0\\\\1\\end{pmatrix}.\n$$\nWe compute the stiffness matrix entries first. Since the gradients are constant on $K$, each entry is the constant dot product multiplied by the area of $K$:\n$$\nA_{ij}=\\int_{K}\\nabla\\phi_{i}\\cdot\\nabla\\phi_{j}\\,dx = \\left(\\nabla\\phi_{i}\\cdot\\nabla\\phi_{j}\\right)|K|.\n$$\nThe dot products are\n$$\n\\nabla\\phi_{1}\\cdot\\nabla\\phi_{1}=(-1)(-1)+(-1)(-1)=2,\\quad\n\\nabla\\phi_{2}\\cdot\\nabla\\phi_{2}=1,\\quad\n\\nabla\\phi_{3}\\cdot\\nabla\\phi_{3}=1,\n$$\n$$\n\\nabla\\phi_{1}\\cdot\\nabla\\phi_{2}=(-1)(1)+(-1)(0)=-1,\\quad\n\\nabla\\phi_{1}\\cdot\\nabla\\phi_{3}=(-1)(0)+(-1)(1)=-1,\\quad\n\\nabla\\phi_{2}\\cdot\\nabla\\phi_{3}=(1)(0)+(0)(1)=0.\n$$\nMultiplying by $|K|=\\frac{1}{2}$ yields\n$$\nA_{11}=2\\cdot\\frac{1}{2}=1,\\quad A_{22}=1\\cdot\\frac{1}{2}=\\frac{1}{2},\\quad A_{33}=1\\cdot\\frac{1}{2}=\\frac{1}{2},\n$$\n$$\nA_{12}=A_{21}=-1\\cdot\\frac{1}{2}=-\\frac{1}{2},\\quad\nA_{13}=A_{31}=-1\\cdot\\frac{1}{2}=-\\frac{1}{2},\\quad\nA_{23}=A_{32}=0\\cdot\\frac{1}{2}=0.\n$$\nTherefore,\n$$\nA=\\begin{pmatrix}\n1 & -\\frac{1}{2} & -\\frac{1}{2} \\\\\n-\\frac{1}{2} & \\frac{1}{2} & 0 \\\\\n-\\frac{1}{2} & 0 & \\frac{1}{2}\n\\end{pmatrix}.\n$$\nNext we compute the mass matrix entries $M_{ij}=\\int_{K}\\phi_{i}\\phi_{j}\\,dx$. We parameterize the integration domain as $0\\le x\\le 1$, $0\\le y\\le 1-x$, so that\n$$\n\\int_{K} f(x,y)\\,dx=\\int_{x=0}^{1}\\int_{y=0}^{1-x} f(x,y)\\,dy\\,dx.\n$$\nWe evaluate a representative set of integrals and use symmetry where appropriate.\n\nFor diagonal entries:\n1. $M_{22}=\\int_{K}x^{2}\\,dx=\\int_{0}^{1}\\int_{0}^{1-x} x^{2}\\,dy\\,dx=\\int_{0}^{1} x^{2}(1-x)\\,dx=\\int_{0}^{1}(x^{2}-x^{3})\\,dx=\\frac{1}{3}-\\frac{1}{4}=\\frac{1}{12}.$\n2. $M_{33}=\\int_{K}y^{2}\\,dx$ by symmetry equals $M_{22}$, hence $M_{33}=\\frac{1}{12}.$\n3. $M_{11}=\\int_{K}(1-x-y)^{2}\\,dx=\\int_{0}^{1}\\int_{0}^{1-x}(1-2x-2y+x^{2}+2xy+y^{2})\\,dy\\,dx.$\nCompute inner integral term-by-term:\n$$\n\\int_{0}^{1-x}1\\,dy=1-x,\\quad \\int_{0}^{1-x}y\\,dy=\\frac{(1-x)^{2}}{2},\\quad \\int_{0}^{1-x}y^{2}\\,dy=\\frac{(1-x)^{3}}{3},\\quad \\int_{0}^{1-x}xy\\,dy=x\\frac{(1-x)^{2}}{2}.\n$$\nThus\n$$\nM_{11}=\\int_{0}^{1}\\Big[(1-x)-2x(1-x)-2\\cdot\\frac{(1-x)^{2}}{2}+x^{2}(1-x)+2x\\cdot\\frac{(1-x)^{2}}{2}+\\frac{(1-x)^{3}}{3}\\Big]\\,dx.\n$$\nSimplify inside:\n$$\n(1-x)-2x(1-x)-(1-x)^{2}+x^{2}(1-x)+x(1-x)^{2}+\\frac{(1-x)^{3}}{3}.\n$$\nLet $t=1-x$ for brevity; then $x=1-t$ and the integrand becomes\n$$\nt-2(1-t)t - t^{2} + (1-t)^{2}t + (1-t)t^{2} + \\frac{t^{3}}{3}.\n$$\nExpand:\n$$\nt - 2t + 2t^{2} - t^{2} + (1 - 2t + t^{2})t + t^{2} - t^{3} + \\frac{t^{3}}{3}\n= (-t) + (2t^{2}-t^{2}+t^{2}) + (t - 2t^{2} + t^{3}) + (- t^{3} + \\frac{t^{3}}{3}).\n$$\nCollecting like terms:\n- Linear in $t$: $-t + t = 0$.\n- Quadratic in $t$: $2t^{2}-t^{2}+t^{2}-2t^{2} = 0$.\n- Cubic in $t$: $t^{3} - t^{3} + \\frac{t^{3}}{3} = \\frac{t^{3}}{3}$.\nHence the integrand simplifies to $\\frac{t^{3}}{3}=\\frac{(1-x)^{3}}{3}$. Therefore\n$$\nM_{11}=\\int_{0}^{1}\\frac{(1-x)^{3}}{3}\\,dx=\\frac{1}{3}\\int_{0}^{1}(1-3x+3x^{2}-x^{3})\\,dx=\\frac{1}{3}\\left[1 - \\frac{3}{2} + 1 - \\frac{1}{4}\\right]=\\frac{1}{3}\\cdot\\frac{1}{4}=\\frac{1}{12}.\n$$\nFor off-diagonal entries:\n4. $M_{23}=\\int_{K}xy\\,dx=\\int_{0}^{1}\\int_{0}^{1-x} x y\\,dy\\,dx=\\int_{0}^{1} x\\cdot \\frac{(1-x)^{2}}{2}\\,dx=\\frac{1}{2}\\int_{0}^{1}\\left(x - 2x^{2} + x^{3}\\right)\\,dx=\\frac{1}{2}\\left(\\frac{1}{2}-\\frac{2}{3}+\\frac{1}{4}\\right)=\\frac{1}{24}.$\n5. $M_{12}=\\int_{K}x(1-x-y)\\,dx=\\int_{0}^{1}\\int_{0}^{1-x}(x - x^{2} - xy)\\,dy\\,dx=\\int_{0}^{1}\\left[x(1-x) - x^{2}(1-x) - x\\frac{(1-x)^{2}}{2}\\right]dx.$\nCompute term-by-term:\n$$\n\\int_{0}^{1}x(1-x)\\,dx=\\int_{0}^{1}(x - x^{2})\\,dx=\\frac{1}{2}-\\frac{1}{3}=\\frac{1}{6},\n$$\n$$\n\\int_{0}^{1}x^{2}(1-x)\\,dx=\\int_{0}^{1}(x^{2}-x^{3})\\,dx=\\frac{1}{3}-\\frac{1}{4}=\\frac{1}{12},\n$$\n$$\n\\int_{0}^{1}x\\frac{(1-x)^{2}}{2}\\,dx=\\frac{1}{2}\\int_{0}^{1}(x - 2x^{2} + x^{3})\\,dx=\\frac{1}{2}\\left(\\frac{1}{2}-\\frac{2}{3}+\\frac{1}{4}\\right)=\\frac{1}{24}.\n$$\nThus $M_{12}=\\frac{1}{6}-\\frac{1}{12}-\\frac{1}{24}=\\frac{4-2-1}{24}=\\frac{1}{24}.$\n6. By symmetry, $M_{13}=\\frac{1}{24}$.\n\nCollecting these results,\n$$\nM=\\begin{pmatrix}\n\\frac{1}{12} & \\frac{1}{24} & \\frac{1}{24} \\\\\n\\frac{1}{24} & \\frac{1}{12} & \\frac{1}{24} \\\\\n\\frac{1}{24} & \\frac{1}{24} & \\frac{1}{12}\n\\end{pmatrix}=\\frac{1}{24}\\begin{pmatrix}\n2 & 1 & 1 \\\\\n1 & 2 & 1 \\\\\n1 & 1 & 2\n\\end{pmatrix}.\n$$\nThe final composite analytical expression that groups both matrices side-by-side in a single row matrix is obtained by placing $M$ and $A$ as entries of an outer row matrix.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{24}\\begin{pmatrix}2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2\\end{pmatrix} & \\begin{pmatrix}1 & -\\frac{1}{2} & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{1}{2} & 0 \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2}\\end{pmatrix}\\end{pmatrix}}$$"
        },
        {
            "introduction": "While the integrals defining element matrices can sometimes be solved by hand, practical FEM codes almost universally rely on numerical quadrature for efficiency and generality. This practice explores the crucial link between the choice of basis functions and the required precision of the integration scheme . Determining the minimal quadrature rule to exactly integrate the stiffness matrix for quadratic ($P2$) elements demonstrates a key principle for ensuring the accuracy of a simulation without unnecessary computational cost.",
            "id": "4087531",
            "problem": "Consider the stationary diffusion model representative of the viscous dissipation term in incompressible complex fluids: find $u$ such that $-\\nabla \\cdot (\\mu \\nabla u) = f$ in a polygonal domain, where $\\mu$ is a positive viscosity parameter. In the Finite Element Method (FEM), using quadratic Lagrange polynomial ($P2$) basis functions on a conforming triangular mesh, the element stiffness matrix on a single triangle $K$ has entries $A_{ij} = \\int_{K} \\mu \\, \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\, \\mathrm{d}x$, where $\\{\\varphi_{i}\\}$ are the local $P2$ basis functions on $K$. Assume that on each element $K$ the mapping from the reference triangle $\\hat{K}$ is affine, i.e., $F(\\hat{x}) = B \\hat{x} + b$ with constant Jacobian matrix $B$, and that $\\mu$ is constant on each element (piecewise constant).\n\nStarting from the weak formulation and the transformation law for gradients under affine mappings, determine the total polynomial degree of the integrand in each local stiffness matrix entry $A_{ij}$ as a function of the polynomial degree $k$ of the Lagrange basis on triangles. Then specialize to $k = 2$ and deduce the minimal exactness degree $q$ required of a triangle quadrature rule to integrate all such entries exactly on each element $K$. Finally, among symmetric Gaussian-type triangle rules, choose one of minimal size that achieves exactness for all polynomials up to degree $q$, and report the minimal number $N$ of quadrature points required.\n\nProvide as your final answer the single integer $N$. No rounding is needed.",
            "solution": "The task is to determine the minimal number of quadrature points, $N$, required to exactly compute the entries of the element stiffness matrix in a Finite Element Method (FEM) context. The problem is defined by the stationary diffusion equation $-\\nabla \\cdot (\\mu \\nabla u) = f$, discretized using quadratic Lagrange ($P2$) basis functions on a triangular mesh.\n\nThe entries of the element stiffness matrix on a single triangle $K$ are given by the integral:\n$$\nA_{ij} = \\int_{K} \\mu \\, \\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j} \\, \\mathrm{d}x\n$$\nHere, $\\mu$ is a constant on the element $K$, and $\\{\\varphi_i\\}$ are the local $P2$ basis functions.\n\nTo determine the required quadrature accuracy, we must first find the polynomial degree of the integrand. This is typically done by transforming the integral from the physical element $K$ to a canonical reference element $\\hat{K}$.\n\nThe problem states that the mapping from the reference element $\\hat{K}$ to the physical element $K$ is affine:\n$$\nx = F(\\hat{x}) = B \\hat{x} + b\n$$\nwhere $B$ is the constant Jacobian matrix of the transformation and $b$ is a constant vector. The change of variables in integration introduces the determinant of the Jacobian, $|\\det(B)|$, which is a constant for this affine mapping.\n\nThe basis functions $\\varphi_i$ on the physical element are polynomials of degree $k$, which are related to the basis functions $\\hat{\\varphi}_i$ on the reference element by $\\varphi_i(x) = \\hat{\\varphi}_i(F^{-1}(x))$. The functions $\\hat{\\varphi}_i(\\hat{x})$ are polynomials of degree $k$ in the reference coordinates $\\hat{x}$.\n\nThe gradient of a basis function $\\varphi_i$ in physical coordinates $x$ is related to the gradient of $\\hat{\\varphi}_i$ in reference coordinates $\\hat{x}$ via the chain rule:\n$$\n\\nabla_x \\varphi_i = (B^{-1})^T \\nabla_{\\hat{x}} \\hat{\\varphi}_i\n$$\nSince $\\hat{\\varphi}_i$ is a polynomial of degree $k$, its gradient, $\\nabla_{\\hat{x}} \\hat{\\varphi}_i$, is a vector quantity whose components are polynomials of degree $k-1$ in the reference coordinates $\\hat{x}$. As the matrix $(B^{-1})^T$ is constant, the vector $\\nabla_x \\varphi_i$ is composed of polynomials of degree $k-1$ in $\\hat{x}$.\n\nNext, we analyze the dot product term $\\nabla \\varphi_i \\cdot \\nabla \\varphi_j$. This is the scalar product of two vectors whose components are polynomials of degree $k-1$. The resulting scalar function is a polynomial of degree at most $(k-1) + (k-1) = 2k-2$.\n$$\n\\text{degree}(\\nabla \\varphi_i \\cdot \\nabla \\varphi_j) = 2k-2\n$$\nThe full integrand for the stiffness matrix entry, when expressed in reference coordinates, is:\n$$\n\\text{Integrand}(\\hat{x}) = \\mu \\, (\\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j}) \\, |\\det(B)|\n$$\nThe parameter $\\mu$ is given as piecewise constant, so it is a constant (polynomial of degree $0$) on element $K$. The Jacobian determinant $|\\det(B)|$ is also a constant. Therefore, the total polynomial degree of the function to be integrated over the reference element $\\hat{K}$ is determined solely by the dot product term, which is $2k-2$.\n\nThe problem specifies the use of quadratic Lagrange ($P2$) basis functions. For these functions, the polynomial degree is $k=2$. Substituting this value into our formula for the integrand's degree yields:\n$$\n\\text{Degree of integrand} = 2(2) - 2 = 2\n$$\nThus, the integrand is a polynomial of degree $2$. A numerical quadrature rule must be able to integrate all polynomials up to this degree exactly. The minimal required degree of exactness for the quadrature rule is therefore $q=2$.\n\nThe final step is to find the symmetric triangle quadrature rule with the minimal number of points, $N$, that is exact for all polynomials of degree up to $q=2$. We consider standard symmetric rules for triangles:\n\\begin{itemize}\n    \\item A $1$-point rule ($N=1$), using the element's centroid, is exact for polynomials up to degree $q=1$. This is insufficient.\n    \\item A symmetric $3$-point rule ($N=3$), which uses the midpoints of the three edges as quadrature points, is exact for polynomials up to degree $q=2$. This meets the requirement.\n    \\item Higher-order rules, such as a $4$-point rule ($q=3$), would also work but are not minimal in size.\n\\end{itemize}\nA symmetric rule with $N=2$ points does not exist for a triangle. Therefore, the minimal number of points required for a symmetric rule to achieve exactness for polynomials of degree $2$ is $N=3$.\n\nThe minimal number of quadrature points required is $3$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "The true power of the variational framework is revealed when tackling the non-linear equations that govern most complex fluid flows. This exercise advances from linear problems to the full steady incompressible Navier-Stokes equations, a cornerstone of computational fluid dynamics . By deriving the Gateaux derivative of the weak residual, you will construct the \"consistent tangent operator,\" the Jacobian essential for the robust and rapid convergence of Newton's method.",
            "id": "4087561",
            "problem": "Consider a steady, incompressible flow of a Newtonian complex fluid in a bounded domain $\\Omega \\subset \\mathbb{R}^{d}$, $d \\in \\{2,3\\}$, with outward unit normal $\\boldsymbol{n}$ on the boundary $\\partial \\Omega$. The governing Partial Differential Equation (PDE) model is the steady incompressible Navier–Stokes equations with constant density $\\rho > 0$ and dynamic viscosity $\\mu > 0$, subject to homogeneous Dirichlet boundary conditions $\\boldsymbol{u} = \\boldsymbol{0}$ on $\\partial \\Omega$:\n$$\n\\rho (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u},p) = \\boldsymbol{f} \\quad \\text{in } \\Omega, \\qquad \\nabla \\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega,\n$$\nwhere $\\boldsymbol{u}:\\Omega \\to \\mathbb{R}^{d}$ is the velocity, $p:\\Omega \\to \\mathbb{R}$ is the pressure, $\\boldsymbol{f}:\\Omega \\to \\mathbb{R}^{d}$ is the body force, and the Cauchy stress for a Newtonian fluid is given by\n$$\n\\boldsymbol{\\sigma}(\\boldsymbol{u},p) = -p \\boldsymbol{I} + 2\\mu \\boldsymbol{D}(\\boldsymbol{u}), \\quad \\text{with } \\boldsymbol{D}(\\boldsymbol{u}) = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top}\\right).\n$$\nLet the trial spaces be $\\boldsymbol{V} := \\{\\boldsymbol{v} \\in [H^{1}_{0}(\\Omega)]^{d}\\}$ and $Q := \\{q \\in L^{2}_{0}(\\Omega)\\}$, and let the corresponding test spaces be the same. The weak residual operator of the Finite Element Method (FEM) for Computational Fluid Dynamics (CFD) is defined, for a given pair $(\\boldsymbol{u},p) \\in \\boldsymbol{V} \\times Q$ and test pair $(\\boldsymbol{w},q) \\in \\boldsymbol{V} \\times Q$, by\n$$\n\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q) := \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} p \\, \\nabla \\cdot \\boldsymbol{w} \\, \\mathrm{d}x + \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{u} \\, \\mathrm{d}x - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x.\n$$\nDefine the Gateaux derivative of $\\mathcal{R}$ with respect to $(\\boldsymbol{u},p)$ in the direction $(\\delta \\boldsymbol{u}, \\delta p) \\in \\boldsymbol{V} \\times Q$ as\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] := \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}\\, \\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u},\\, p + \\varepsilon \\delta p;\\, \\boldsymbol{w},q)\\right|_{\\varepsilon = 0}.\n$$\nStarting only from the definitions above and the fundamental laws and properties of tensor calculus and weak formulations, derive the explicit analytical expression for $\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p]$ that constitutes the consistent tangent operator required for Newton’s method in the weak form. Your final answer should be the closed-form integral expression of the Gateaux derivative as a bilinear form in $(\\delta \\boldsymbol{u}, \\delta p)$ with the test functions $(\\boldsymbol{w},q)$, written in terms of the current iterate $(\\boldsymbol{u},p)$, the parameters $\\rho$ and $\\mu$, and the operators defined above. If you introduce any intermediate symbols, define them clearly. No rounding is required. Express your final result without physical units.",
            "solution": "Our objective is to compute the Gateaux derivative of the weak residual operator $\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)$ with respect to the state variables $(\\boldsymbol{u},p) \\in \\boldsymbol{V} \\times Q$ in the direction of an arbitrary increment $(\\delta \\boldsymbol{u}, \\delta p) \\in \\boldsymbol{V} \\times Q$. The definition provided is:\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] := \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon}\\, \\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u},\\, p + \\varepsilon \\delta p;\\, \\boldsymbol{w},q)\\right|_{\\varepsilon = 0}\n$$\nwhere $\\boldsymbol{V} := \\{\\boldsymbol{v} \\in [H^{1}_{0}(\\Omega)]^{d}\\}$ and $Q := \\{q \\in L^{2}_{0}(\\Omega)\\}$.\n\nThe weak residual operator is given as:\n$$\n\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q) := \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} p \\, \\nabla \\cdot \\boldsymbol{w} \\, \\mathrm{d}x + \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{u} \\, \\mathrm{d}x - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x\n$$\nTo compute the derivative, we first substitute the perturbed state $(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}, p + \\varepsilon \\delta p)$ into the expression for $\\mathcal{R}$:\n\\begin{align*}\n\\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}, p + \\varepsilon \\delta p; \\boldsymbol{w},q) = & \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left(((\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\cdot \\nabla)(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u})\\right) \\, \\mathrm{d}x \\\\\n& + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x \\\\\n& - \\int_{\\Omega} (p + \\varepsilon \\delta p) \\, \\nabla \\cdot \\boldsymbol{w} \\, \\mathrm{d}x \\\\\n& + \\int_{\\Omega} q \\, \\nabla \\cdot (\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\, \\mathrm{d}x \\\\\n& - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x\n\\end{align*}\nWe can analyze the derivative by examining each term's dependence on the parameter $\\varepsilon$. Let us denote $\\mathcal{R}_{\\varepsilon} = \\mathcal{R}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}, p + \\varepsilon \\delta p; \\boldsymbol{w},q)$. The derivative is found by differentiating $\\mathcal{R}_{\\varepsilon}$ with respect to $\\varepsilon$ and setting $\\varepsilon = 0$. Since integration and differentiation with respect to $\\varepsilon$ are interchangeable (by the Leibniz integral rule, as the domain $\\Omega$ is fixed), we can differentiate the integrands of each term.\n\n1.  **Convective Term:**\n    Let $I_1(\\varepsilon) = \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left(((\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\cdot \\nabla)(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u})\\right) \\, \\mathrm{d}x$.\n    The term inside the integral is quadratic in $\\varepsilon$:\n    $$\n    ((\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\cdot \\nabla)(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) = (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} + \\varepsilon (\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + \\varepsilon (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} + \\varepsilon^2 (\\delta \\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u}\n    $$\n    Differentiating this expression with respect to $\\varepsilon$ and evaluating at $\\varepsilon = 0$ yields:\n    $$\n    \\left.\\frac{\\mathrm{d}}{\\mathrm{d}\\varepsilon} \\left[ (\\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} + \\varepsilon ((\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}) + \\varepsilon^2 (\\delta \\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} \\right]\\right|_{\\varepsilon=0} = (\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\n    $$\n    Therefore, the derivative of the first integral term is:\n    $$\n    \\left.\\frac{\\mathrm{d}I_1}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left( (\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u} \\right) \\, \\mathrm{d}x\n    $$\n\n2.  **Diffusive Term:**\n    Let $I_2(\\varepsilon) = \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x$.\n    The rate of strain tensor operator $\\boldsymbol{D}$ is linear. Thus:\n    $$\n    \\boldsymbol{D}(\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) = \\boldsymbol{D}(\\boldsymbol{u}) + \\varepsilon \\boldsymbol{D}(\\delta \\boldsymbol{u})\n    $$\n    The term $I_2(\\varepsilon)$ is linear in $\\varepsilon$. Its derivative is the coefficient of $\\varepsilon$:\n    $$\n    \\left.\\frac{\\mathrm{d}I_2}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x\n    $$\n\n3.  **Pressure Term:**\n    Let $I_3(\\varepsilon) = - \\int_{\\Omega} (p + \\varepsilon \\delta p) \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x$.\n    This term is also linear in $\\varepsilon$. Its derivative is simply the coefficient of $\\varepsilon$:\n    $$\n    \\left.\\frac{\\mathrm{d}I_3}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = - \\int_{\\Omega} \\delta p \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x\n    $$\n\n4.  **Continuity Term:**\n    Let $I_4(\\varepsilon) = \\int_{\\Omega} q \\, \\nabla \\cdot (\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) \\, \\mathrm{d}x$.\n    The divergence operator $\\nabla \\cdot$ is linear. Hence:\n    $$\n    \\nabla \\cdot (\\boldsymbol{u} + \\varepsilon \\delta \\boldsymbol{u}) = \\nabla \\cdot \\boldsymbol{u} + \\varepsilon (\\nabla \\cdot \\delta \\boldsymbol{u})\n    $$\n    The term $I_4(\\varepsilon)$ is linear in $\\varepsilon$, and its derivative is the coefficient of $\\varepsilon$:\n    $$\n    \\left.\\frac{\\mathrm{d}I_4}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = \\int_{\\Omega} q \\, (\\nabla \\cdot \\delta \\boldsymbol{u}) \\, \\mathrm{d}x\n    $$\n\n5.  **Forcing Term:**\n    Let $I_5(\\varepsilon) = - \\int_{\\Omega} \\boldsymbol{w} \\cdot \\boldsymbol{f} \\, \\mathrm{d}x$.\n    This term is independent of $\\varepsilon$, so its derivative is zero:\n    $$\n    \\left.\\frac{\\mathrm{d}I_5}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} = 0\n    $$\n\nSumming the derivatives of all terms gives the final expression for the Gateaux derivative:\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] = \\left.\\frac{\\mathrm{d}I_1}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_2}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_3}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_4}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0} + \\left.\\frac{\\mathrm{d}I_5}{\\mathrm{d}\\varepsilon}\\right|_{\\varepsilon=0}\n$$\nSubstituting the derived expressions yields the consistent tangent operator:\n$$\n\\mathrm{D}\\mathcal{R}(\\boldsymbol{u},p; \\boldsymbol{w},q)[\\delta \\boldsymbol{u}, \\delta p] = \\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} \\delta p \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x + \\int_{\\Omega} q \\, (\\nabla \\cdot \\delta \\boldsymbol{u}) \\, \\mathrm{d}x\n$$\nThis expression is a bilinear form with respect to the increment $(\\delta \\boldsymbol{u}, \\delta p)$ and the test functions $(\\boldsymbol{w},q)$, and it depends on the current solution iterate $\\boldsymbol{u}$, as expected for the Jacobian of the Newton method applied to this non-linear problem.",
            "answer": "$$\n\\boxed{\\int_{\\Omega} \\rho \\, \\boldsymbol{w} \\cdot \\left((\\boldsymbol{u} \\cdot \\nabla)\\delta \\boldsymbol{u} + (\\delta \\boldsymbol{u} \\cdot \\nabla)\\boldsymbol{u}\\right) \\, \\mathrm{d}x + \\int_{\\Omega} 2\\mu \\, \\boldsymbol{D}(\\delta \\boldsymbol{u}) : \\boldsymbol{D}(\\boldsymbol{w}) \\, \\mathrm{d}x - \\int_{\\Omega} \\delta p \\, (\\nabla \\cdot \\boldsymbol{w}) \\, \\mathrm{d}x + \\int_{\\Omega} q \\, (\\nabla \\cdot \\delta \\boldsymbol{u}) \\, \\mathrm{d}x}\n$$"
        }
    ]
}