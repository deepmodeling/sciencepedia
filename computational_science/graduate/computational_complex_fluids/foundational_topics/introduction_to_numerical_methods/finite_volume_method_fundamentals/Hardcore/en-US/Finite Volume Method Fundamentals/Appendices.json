{
    "hands_on_practices": [
        {
            "introduction": "The finite volume method is built upon the principle of enforcing conservation laws over discrete control volumes. This is achieved by carefully balancing the fluxes of conserved quantities across the faces of each volume. This first practice brings you to the heart of this process: the calculation of flux across a single, arbitrarily oriented face, considering both advective and diffusive transport mechanisms. By working through this exercise, you will gain hands-on experience applying fundamental discretization schemes—such as first-order upwinding for advection and a two-point approximation for diffusion—that form the essential building blocks of any comprehensive FVM code.",
            "id": "4087700",
            "problem": "Consider a passive scalar field $\\phi$ representing a micellar mass fraction (dimensionless) transported in a steady, incompressible complex fluid with constant density $\\rho$. Two adjacent finite volumes share a planar face $f$ of area $A_f$ with outward unit normal $\\boldsymbol{n}_f$ taken with respect to the left cell $L$. The face area vector is $\\boldsymbol{S}_f = A_f \\boldsymbol{n}_f$. The left and right cell centroids are at positions $\\boldsymbol{x}_L$ and $\\boldsymbol{x}_R$, and the face-centered velocity is $\\boldsymbol{u}_f$. The material diffusivity is $D$ (Fickian diffusion), so that the diffusive transport coefficient in the conservative form $\\nabla \\cdot (\\Gamma \\nabla \\phi)$ is $\\Gamma = \\rho D$.\n\nYou are given:\n- $\\rho = 1050\\,\\mathrm{kg\\,m^{-3}}$,\n- $\\boldsymbol{u}_f = (0.6,\\,0.2,\\,0.1)\\,\\mathrm{m\\,s^{-1}}$,\n- $A_f = 0.010\\,\\mathrm{m^2}$,\n- $\\boldsymbol{n}_f = \\frac{1}{\\sqrt{11}}(3,\\,1,\\,1)$,\n- $\\boldsymbol{x}_L = (0.010,\\,0.020,\\,0.000)\\,\\mathrm{m}$,\n- $\\boldsymbol{x}_R = (0.022,\\,0.025,\\,0.003)\\,\\mathrm{m}$,\n- $\\phi_L = 0.24$, $\\phi_R = 0.18$,\n- $D = 2.0 \\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$.\n\nStarting from the integral conservation law for $\\phi$ over the left control volume and the constitutive statement for diffusive flux (Fick’s law), derive the facewise advective-diffusive flux leaving cell $L$ through face $f$ as the sum of an advective contribution and a diffusive contribution. Adopt the following modeling and discretization assumptions that are standard in the Finite Volume Method (FVM):\n- The advective face value $\\phi_f$ is obtained by first-order upwinding based on the sign of the mass flow rate across the face.\n- The face-normal diffusive flux uses a two-point approximation based on linear variation of $\\phi$ between $\\boldsymbol{x}_L$ and $\\boldsymbol{x}_R$ and the projection of the centroid-to-centroid vector onto the face normal.\n- Neglect any non-orthogonal correction beyond this projection.\n\nDefine the left-cell residual contribution from face $f$ as the net outward flux leaving cell $L$ through face $f$. Compute this single numerical value. Round your final numerical answer to four significant figures and express it in $\\mathrm{kg\\,s^{-1}}$.",
            "solution": "The problem is first validated against the specified criteria.\nGivens are extracted verbatim:\n- Density: $\\rho = 1050\\,\\mathrm{kg\\,m^{-3}}$\n- Face-centered velocity: $\\boldsymbol{u}_f = (0.6,\\,0.2,\\,0.1)\\,\\mathrm{m\\,s^{-1}}$\n- Face area: $A_f = 0.010\\,\\mathrm{m^2}$\n- Face outward unit normal (from cell $L$): $\\boldsymbol{n}_f = \\frac{1}{\\sqrt{11}}(3,\\,1,\\,1)$\n- Left cell centroid position: $\\boldsymbol{x}_L = (0.010,\\,0.020,\\,0.000)\\,\\mathrm{m}$\n- Right cell centroid position: $\\boldsymbol{x}_R = (0.022,\\,0.025,\\,0.003)\\,\\mathrm{m}$\n- Left and right cell scalar values: $\\phi_L = 0.24$, $\\phi_R = 0.18$\n- Material diffusivity: $D = 2.0 \\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}$\n- Diffusive transport coefficient: $\\Gamma = \\rho D$\n- Advective flux discretization: First-order upwinding.\n- Diffusive flux discretization: Two-point approximation using projection of the centroid-to-centroid vector onto the face normal.\n\nValidation:\nThe problem is scientifically grounded, describing a standard transport phenomenon (advection-diffusion) using the finite volume method, a cornerstone of computational fluid dynamics. All terms are defined, and the physical principles (Fick's law, mass conservation) are standard. The problem is well-posed, as all necessary data and discretization schemes are provided to compute a unique numerical answer. The language is objective and precise. No violations of the validation criteria are found. The problem is deemed valid.\n\nThe steady-state integral conservation law for a passive scalar $\\phi$ over a control volume $V$ is given by:\n$$ \\oint_{\\partial V} (\\rho \\phi \\boldsymbol{u} - \\Gamma \\nabla\\phi) \\cdot d\\boldsymbol{S} = 0 $$\nThe term inside the integral is the total flux vector, $\\boldsymbol{F} = \\rho \\phi \\boldsymbol{u} - \\Gamma \\nabla\\phi$. The problem asks for the \"residual contribution\" from face $f$ for the left cell $L$, which is defined as the net outward flux leaving cell $L$ through face $f$. This quantity, which we denote $F_f$, is the surface integral of the flux vector over the face area $A_f$. Using standard finite volume approximations, this integral is approximated as:\n$$ F_f \\approx \\boldsymbol{F}_f \\cdot \\boldsymbol{S}_f = (\\rho \\phi \\boldsymbol{u})_f \\cdot \\boldsymbol{S}_f - (\\Gamma \\nabla\\phi)_f \\cdot \\boldsymbol{S}_f $$\nwhere $\\boldsymbol{S}_f = A_f \\boldsymbol{n}_f$ is the face area vector, and the subscript $f$ denotes values evaluated at the face center. We can separate this into an advective contribution, $F_{f, \\text{adv}}$, and a diffusive contribution, $F_{f, \\text{diff}}$. Note that the diffusive flux vector is $\\boldsymbol{j}_d = -\\Gamma \\nabla\\phi$, so the diffusive contribution to the outward flux is $(-\\Gamma\\nabla\\phi)_f \\cdot \\boldsymbol{S}_f$.\n$$ F_f = F_{f, \\text{adv}} + F_{f, \\text{diff}} $$\nwhere\n$$ F_{f, \\text{adv}} = (\\rho \\boldsymbol{u})_f \\cdot \\boldsymbol{S}_f \\phi_f $$\n$$ F_{f, \\text{diff}} = -(\\Gamma \\nabla\\phi)_f \\cdot \\boldsymbol{S}_f $$\n\nFirst, we compute the advective flux, $F_{f, \\text{adv}}$. This requires the mass flow rate through the face, $\\dot{m}_f$, and the face value of the scalar, $\\phi_f$.\nThe mass flow rate is $\\dot{m}_f = \\rho \\boldsymbol{u}_f \\cdot \\boldsymbol{S}_f = \\rho A_f (\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f)$.\nLet's compute the dot product $\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f$:\n$$ \\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f = (0.6, 0.2, 0.1) \\cdot \\frac{1}{\\sqrt{11}}(3, 1, 1) = \\frac{1}{\\sqrt{11}}(0.6 \\times 3 + 0.2 \\times 1 + 0.1 \\times 1) = \\frac{1}{\\sqrt{11}}(1.8 + 0.2 + 0.1) = \\frac{2.1}{\\sqrt{11}} \\,\\mathrm{m\\,s^{-1}} $$\nNow, we calculate $\\dot{m}_f$:\n$$ \\dot{m}_f = \\rho A_f (\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f) = (1050\\,\\mathrm{kg\\,m^{-3}}) \\times (0.010\\,\\mathrm{m^2}) \\times \\left(\\frac{2.1}{\\sqrt{11}}\\,\\mathrm{m\\,s^{-1}}\\right) = \\frac{10.5 \\times 2.1}{\\sqrt{11}} = \\frac{22.05}{\\sqrt{11}}\\,\\mathrm{kg\\,s^{-1}} $$\nSince $\\dot{m}_f > 0$, the mass flow is directed out of cell $L$. The first-order upwind scheme dictates that the advected scalar value at the face, $\\phi_f$, is taken from the upstream cell, which is cell $L$.\n$$ \\phi_f = \\phi_L = 0.24 $$\nThe advective flux is then:\n$$ F_{f, \\text{adv}} = \\dot{m}_f \\phi_f = \\left(\\frac{22.05}{\\sqrt{11}}\\right) \\times 0.24 = \\frac{5.292}{\\sqrt{11}}\\,\\mathrm{kg\\,s^{-1}} $$\n\nNext, we compute the diffusive flux, $F_{f, \\text{diff}} = -(\\Gamma \\nabla\\phi)_f \\cdot \\boldsymbol{S}_f = -\\Gamma A_f ((\\nabla\\phi)_f \\cdot \\boldsymbol{n}_f)$. The problem specifies approximating the face-normal gradient $(\\nabla\\phi)_f \\cdot \\boldsymbol{n}_f$ using a two-point stencil and the projection of the vector connecting cell centroids onto the face normal.\nThe vector connecting the cell centroids is $\\boldsymbol{d}_{LR} = \\boldsymbol{x}_R - \\boldsymbol{x}_L$:\n$$ \\boldsymbol{d}_{LR} = (0.022 - 0.010, 0.025 - 0.020, 0.003 - 0.000) = (0.012, 0.005, 0.003)\\,\\mathrm{m} $$\nThe effective distance for the gradient approximation is the projection of $\\boldsymbol{d}_{LR}$ onto $\\boldsymbol{n}_f$, which we denote $d_n$:\n$$ d_n = \\boldsymbol{d}_{LR} \\cdot \\boldsymbol{n}_f = (0.012, 0.005, 0.003) \\cdot \\frac{1}{\\sqrt{11}}(3, 1, 1) = \\frac{1}{\\sqrt{11}}(0.012 \\times 3 + 0.005 \\times 1 + 0.003 \\times 1) = \\frac{0.036 + 0.005 + 0.003}{\\sqrt{11}} = \\frac{0.044}{\\sqrt{11}}\\,\\mathrm{m} $$\nThe face-normal gradient is approximated as:\n$$ (\\nabla\\phi)_f \\cdot \\boldsymbol{n}_f \\approx \\frac{\\phi_R - \\phi_L}{d_n} = \\frac{0.18 - 0.24}{0.044/\\sqrt{11}} = \\frac{-0.06\\sqrt{11}}{0.044}\\,\\mathrm{m^{-1}} $$\nThe diffusive transport coefficient is $\\Gamma = \\rho D$:\n$$ \\Gamma = (1050\\,\\mathrm{kg\\,m^{-3}}) \\times (2.0 \\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}}) = 2100 \\times 10^{-9} = 2.1 \\times 10^{-6}\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}} $$\nThe diffusive flux is now computed:\n$$ F_{f, \\text{diff}} = -\\Gamma A_f \\left(\\frac{\\phi_R - \\phi_L}{d_n}\\right) = -(2.1 \\times 10^{-6}\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}}) \\times (0.010\\,\\mathrm{m^2}) \\times \\left(\\frac{-0.06\\sqrt{11}}{0.044}\\,\\mathrm{m^{-1}}\\right) $$\n$$ F_{f, \\text{diff}} = (2.1 \\times 10^{-8}) \\times \\frac{0.06\\sqrt{11}}{0.044}\\,\\mathrm{kg\\,s^{-1}} = \\frac{0.126\\sqrt{11}}{0.044} \\times 10^{-8}\\,\\mathrm{kg\\,s^{-1}} $$\n\nThe total net outward flux from cell $L$ through face $f$ is the sum of the advective and diffusive fluxes:\n$$ F_f = F_{f, \\text{adv}} + F_{f, \\text{diff}} = \\frac{5.292}{\\sqrt{11}} + \\frac{0.126\\sqrt{11}}{0.044} \\times 10^{-8}\\,\\mathrm{kg\\,s^{-1}} $$\nNow, we evaluate this expression numerically:\n$$ \\sqrt{11} \\approx 3.31662479 $$\n$$ F_{f, \\text{adv}} \\approx \\frac{5.292}{3.31662479} \\approx 1.59554709\\,\\mathrm{kg\\,s^{-1}} $$\n$$ F_{f, \\text{diff}} \\approx \\frac{0.126 \\times 3.31662479}{0.044} \\times 10^{-8} \\approx \\frac{0.4178947}{0.044} \\times 10^{-8} \\approx 9.497607 \\times 10^{-8}\\,\\mathrm{kg\\,s^{-1}} $$\n$$ F_f \\approx 1.59554709 + 0.00000009497607 = 1.595547185\\,\\mathrm{kg\\,s^{-1}} $$\nThe problem requires the final answer to be rounded to four significant figures.\n$$ F_f \\approx 1.596\\,\\mathrm{kg\\,s^{-1}} $$",
            "answer": "$$ \\boxed{1.596} $$"
        },
        {
            "introduction": "Moving from a single face to a complete simulation, we now explore the collective behavior of these flux calculations over time. This exercise tasks you with building a simple one-dimensional solver for the linear advection equation using the first-order upwind scheme you encountered previously. The true learning objective, however, lies in analyzing the simulation's output. By tracking the evolution of a sharp interface, you will quantify the scheme's inherent numerical diffusion and directly observe how this error depends on the Courant number, $\\nu$. This practice provides a tangible link between the abstract concept of truncation error and its visible, and often detrimental, effects on a numerical solution.",
            "id": "2394306",
            "problem": "Consider the linear advection equation in one spatial dimension,\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0,\n$$\non a periodic domain of length $L$, that is $x \\in [0,L)$ with periodic boundary conditions. The advection speed $a$ is a positive constant. Starting from the integral conservation law and the definition of finite volume averages on a uniform grid, derive a first-order, explicit, conservative finite volume method that is consistent with the physics of information propagation for $a>0$.\n\nYou will investigate numerical diffusion by simulating the advection of a block step function and quantifying the smearing of the interface over time. Use a uniform mesh of $N$ cells with spatial step $\\Delta x = L/N$ and cell centers $x_i = (i+\\tfrac{1}{2})\\Delta x$, for $i=0,1,\\dots,N-1$. Let the initial condition be the block\n$$\nu(x,0) = \\begin{cases}\n1, & x \\in [x_L, x_R),\\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\nwith $x_L = 0.2\\,L$ and $x_R = 0.7\\,L$. Evolve the solution using a first-order finite volume scheme with an explicit time step $\\Delta t$ chosen to satisfy a prescribed Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$. Use the same constant $\\nu$ for all time steps of a given simulation. Let the simulation run for a prescribed final time $T$; use an integer number of time steps $n = \\text{round}(T/\\Delta t)$ so that the simulated time is $t_n = n\\,\\Delta t$.\n\nDefine the \"smearing width\" of a descending interface at time $t_n$ as the minimal spatial distance (measured along the periodic domain) from the point where the cell-centered profile crosses the level $\\theta_{\\text{hi}} = 0.9$ downward to the subsequent point where it crosses the level $\\theta_{\\text{lo}} = 0.1$ downward. Compute these crossing points using linear interpolation of the cell-centered values between neighboring cell centers. In the presence of multiple descending interfaces (due to periodicity), compute the smearing width around each descending interface and report the minimal width. Express the width in the same dimensionless length units as $L$.\n\nImplement the simulation and the width measurement in a single program. For each test case below, output the measured smearing width at time $t_n$, rounded to $8$ decimal places.\n\nUse the following test suite, with parameters $(N,\\ \\nu,\\ T,\\ a,\\ L)$:\n- Case $1$: $(200,\\ 0.5,\\ 0.2,\\ 1.0,\\ 1.0)$.\n- Case $2$: $(200,\\ 0.9,\\ 0.2,\\ 1.0,\\ 1.0)$.\n- Case $3$: $(200,\\ 0.2,\\ 0.2,\\ 1.0,\\ 1.0)$.\n- Case $4$: $(50,\\ 0.5,\\ 0.2,\\ 1.0,\\ 1.0)$.\n- Case $5$: $(200,\\ 1.0,\\ 0.2,\\ 1.0,\\ 1.0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For example, it should look like\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5],\n$$\nwhere each $\\text{result}_k$ is the smearing width for case $k$ rounded to $8$ decimal places. No other output is permitted.",
            "solution": "We start from the integral conservation form of the advection equation,\n$$\n\\partial_t u(x,t) + \\partial_x f(u) = 0,\\quad f(u) = a u,\\quad a>0.\n$$\nLet $\\mathcal{C}_i = [x_{i-\\tfrac{1}{2}}, x_{i+\\tfrac{1}{2}}]$ be a control volume of uniform width $\\Delta x = x_{i+\\tfrac{1}{2}} - x_{i-\\tfrac{1}{2}}$, with cell center $x_i = (i+\\tfrac{1}{2})\\Delta x$ and periodic indexing. Define the cell average\n$$\n\\bar{u}_i(t) = \\frac{1}{\\Delta x}\\int_{\\mathcal{C}_i} u(x,t)\\,dx.\n$$\nIntegrating the conservation law over $\\mathcal{C}_i$ gives\n$$\n\\frac{d}{dt}\\left( \\int_{\\mathcal{C}_i} u(x,t)\\,dx \\right) + \\left[ f(u(x_{i+\\tfrac{1}{2}},t)) - f(u(x_{i-\\tfrac{1}{2}},t)) \\right] = 0,\n$$\nor equivalently,\n$$\n\\frac{d\\bar{u}_i}{dt} = -\\frac{1}{\\Delta x}\\left( f_{i+\\tfrac{1}{2}} - f_{i-\\tfrac{1}{2}} \\right),\n$$\nwhere $f_{i\\pm \\tfrac{1}{2}}$ are the fluxes through the cell faces. A first-order explicit time discretization with time step $\\Delta t$ yields\n$$\n\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\frac{\\Delta t}{\\Delta x}\\left( \\hat{f}_{i+\\tfrac{1}{2}}^n - \\hat{f}_{i-\\tfrac{1}{2}}^n \\right),\n$$\nwith a numerical flux $\\hat{f}_{i+\\tfrac{1}{2}}^n$ consistent with the physics. For linear advection with $a>0$, information propagates from left to right, and the exact Riemann solution at each interface depends only on the left state. The Godunov upwind numerical flux is therefore\n$$\n\\hat{f}_{i+\\tfrac{1}{2}}^n = a\\,\\bar{u}_i^n\\quad\\text{for }a>0.\n$$\nIntroducing the Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$, the update simplifies to the first-order upwind scheme\n$$\n\\bar{u}_i^{n+1} = \\bar{u}_i^n - \\nu\\left(\\bar{u}_i^n - \\bar{u}_{i-1}^n\\right),\\quad a>0,\n$$\nwith periodic indexing on $i$.\n\nTo relate this discrete method to a continuous process and expose numerical diffusion, we perform a modified equation analysis. Denote $\\bar{u}_i^n \\approx u(x_i,t^n)$ with $t^n = n\\Delta t$. A Taylor expansion in time gives\n$$\n\\bar{u}_i^{n+1} - \\bar{u}_i^n = \\Delta t\\,u_t(x_i,t^n) + \\mathcal{O}(\\Delta t^2).\n$$\nA Taylor expansion in space for the backward difference yields\n$$\n\\bar{u}_i^n - \\bar{u}_{i-1}^n = \\Delta x\\,u_x(x_i,t^n) - \\frac{\\Delta x^2}{2}u_{xx}(x_i,t^n) + \\frac{\\Delta x^3}{6}u_{xxx}(x_i,t^n) + \\mathcal{O}(\\Delta x^4).\n$$\nSubstituting into the scheme gives\n$$\n\\Delta t\\,u_t = -\\nu\\left[ \\Delta x\\,u_x - \\frac{\\Delta x^2}{2}u_{xx} + \\frac{\\Delta x^3}{6}u_{xxx} + \\cdots \\right] + \\mathcal{O}(\\Delta t^2).\n$$\nDividing by $\\Delta t$ and recalling $\\nu = a\\Delta t/\\Delta x$,\n$$\nu_t + a\\,u_x = \\frac{a\\,\\Delta x}{2}(1 - \\nu)\\,u_{xx} - \\frac{a\\,\\Delta x^2}{6}\\left(1 - 3\\nu + 2\\nu^2\\right)u_{xxx} + \\cdots.\n$$\nThe leading correction is a diffusion term with an effective (artificial) diffusion coefficient\n$$\nD_{\\text{num}} = \\frac{a\\,\\Delta x}{2}(1 - \\nu).\n$$\nThus for $0<\\nu<1$, the first-order upwind method introduces numerical diffusion that smears discontinuities over a width that grows like $\\sqrt{D_{\\text{num}}\\,t}$, whereas for $\\nu=1$ the leading diffusive term vanishes and the method reduces to a pure shift operator on the grid.\n\nTo quantify smearing for a step, we define the $10$–$90$ thickness. Consider a descending interface where $u$ drops from values near $1$ to values near $0$. Let $\\theta_{\\text{hi}} = 0.9$ and $\\theta_{\\text{lo}} = 0.1$. On the piecewise-constant cell-centered profile $\\{\\bar{u}_i^n\\}$, we determine the approximate positions where $u=\\theta$ by linear interpolation between neighboring cell centers. Specifically, for a pair of neighboring indices $(i,i+1)$ on a descending front with $\\bar{u}_i^n \\ge \\theta > \\bar{u}_{i+1}^n$,\n$$\nx(\\theta) \\approx x_i + \\Delta x \\frac{\\bar{u}_i^n - \\theta}{\\bar{u}_i^n - \\bar{u}_{i+1}^n}.\n$$\nWe collect all downward $\\theta_{\\text{hi}}$ crossings and all downward $\\theta_{\\text{lo}}$ crossings across the domain (with periodic wrap), and for each $\\theta_{\\text{hi}}$ crossing we determine the distance along the periodic coordinate to the subsequent $\\theta_{\\text{lo}}$ crossing. The minimal such distance, denoted $w_{10\\text{–}90}$, is the measured smearing width. This width is reported in the same length units as $L$.\n\nAlgorithmic design:\n- Spatial discretization: uniform cells, periodic boundary conditions, first-order upwind flux $\\hat{f}_{i+\\tfrac{1}{2}}^n = a\\,\\bar{u}_i^n$ for $a>0$.\n- Time stepping: forward Euler with fixed $\\Delta t$ satisfying a prescribed $\\nu = a\\,\\Delta t/\\Delta x$; advance for $n=\\text{round}(T/\\Delta t)$ steps.\n- Initialization: block $u(x,0)=1$ on $[0.2L, 0.7L)$ and $0$ elsewhere on $[0,L)$, sampled at cell centers.\n- Width measurement: compute $w_{10\\text{–}90}$ using linear interpolation of cell-centered values and minimal downstream distance between $\\theta_{\\text{hi}}$ and $\\theta_{\\text{lo}}$ crossings along descending interfaces; use periodic unwrapping to handle interfaces near $x=0$.\n\nQualitative expectations based on $D_{\\text{num}}$: for fixed $a$, $L$, and $T$, finer grids (smaller $\\Delta x$) reduce $D_{\\text{num}}$ and thus reduce smearing; larger $\\nu$ (closer to $1$) also reduces $D_{\\text{num}}$, yielding narrower interfaces; at $\\nu=1$, the leading diffusive term vanishes and the interface is limited essentially to a grid-scale thickness. The program implements the scheme and measurement precisely and outputs, for each specified test case $(N,\\nu,T,a,L)$, the smearing width $w_{10\\text{–}90}(t_n)$ rounded to $8$ decimal places, aggregated as a single list on one line as required.\n\n```python\nimport numpy as np\n\ndef upwind_fvm_step(u, nu):\n    \"\"\"\n    First-order upwind finite volume update for a > 0:\n    u_i^{n+1} = u_i^n - nu * (u_i^n - u_{i-1}^n), with periodic indexing.\n    \"\"\"\n    return u - nu * (u - np.roll(u, 1))\n\ndef initialize_block(N, L, xL_frac=0.2, xR_frac=0.7):\n    \"\"\"\n    Initialize u(x,0) = 1 on [x_L, x_R) and 0 elsewhere on [0,L), sampled at cell centers.\n    x_L = xL_frac * L, x_R = xR_frac * L.\n    \"\"\"\n    dx = L / N\n    x = (np.arange(N) + 0.5) * dx\n    xL = xL_frac * L\n    xR = xR_frac * L\n    u0 = np.where((x >= xL)  (x  xR), 1.0, 0.0)\n    return x, u0\n\ndef interpolate_crossing_pos(x_i, x_ip1, u_i, u_ip1, theta, L):\n    \"\"\"\n    Linear interpolation between (x_i, u_i) and (x_ip1, u_ip1) to find x where u=theta.\n    The positions x_i and x_ip1 are assumed to be neighbors on a uniform periodic grid.\n    Returns position wrapped into [0, L).\n    \"\"\"\n    denom = (u_i - u_ip1)\n    if denom == 0.0:\n        return None\n    frac = (u_i - theta) / denom\n    # x along the straight line between centers\n    xi = x_i + (x_ip1 - x_i) * frac\n    # Wrap into [0, L)\n    xi_wrapped = xi % L\n    return xi_wrapped\n\ndef measure_smearing_width(u, x, L, theta_hi=0.9, theta_lo=0.1):\n    \"\"\"\n    Measure the 10-90 smearing width on descending interfaces using linear interpolation\n    between neighboring cell centers. Returns the minimal width among all descending interfaces.\n    \"\"\"\n    N = len(u)\n    dx = L / N\n    hi_positions = []\n    lo_positions = []\n    for i in range(N):\n        ip1 = (i + 1) % N\n        u_i = u[i]\n        u_ip1 = u[ip1]\n        if u_i > u_ip1:\n            if (u_i >= theta_hi) and (u_ip1  theta_hi):\n                xi = interpolate_crossing_pos(x[i], x[ip1], u_i, u_ip1, theta_hi, L)\n                if xi is not None:\n                    hi_positions.append(xi)\n            if (u_i >= theta_lo) and (u_ip1  theta_lo):\n                xl = interpolate_crossing_pos(x[i], x[ip1], u_i, u_ip1, theta_lo, L)\n                if xl is not None:\n                    lo_positions.append(xl)\n\n    hi_positions = np.sort(np.array(hi_positions, dtype=float)) if len(hi_positions) > 0 else np.array([], dtype=float)\n    lo_positions = np.sort(np.array(lo_positions, dtype=float)) if len(lo_positions) > 0 else np.array([], dtype=float)\n\n    if hi_positions.size == 0 or lo_positions.size == 0:\n        return 0.0\n\n    widths = []\n    for h in hi_positions:\n        dists = []\n        for l in lo_positions:\n            d = l - h\n            if d  0:\n                d += L\n            dists.append(d)\n        if len(dists) > 0:\n            widths.append(min(dists))\n    if len(widths) == 0:\n        return 0.0\n    return float(min(widths))\n\ndef simulate_and_measure(N, nu, T, a, L):\n    \"\"\"\n    Run the first-order upwind FVM for linear advection with given parameters and\n    measure the 10-90 smearing width at time ~ T.\n    \"\"\"\n    dx = L / N\n    dt = nu * dx / a\n    nsteps = int(np.round(T / dt))\n    x, u = initialize_block(N, L, xL_frac=0.2, xR_frac=0.7)\n    for _ in range(nsteps):\n        u = upwind_fvm_step(u, nu)\n    width = measure_smearing_width(u, x, L, theta_hi=0.9, theta_lo=0.1)\n    return width\n```",
            "answer": "[0.08051754,0.03597379,0.12740449,0.32207018,0.00500000]"
        },
        {
            "introduction": "The previous exercise demonstrated the significant smearing effect of the first-order upwind scheme. A natural instinct for improving accuracy is to employ a higher-order spatial reconstruction. This practice investigates that impulse by comparing the first-order method to a second-order linear reconstruction scheme for both smooth and discontinuous initial data. You will discover a crucial trade-off inherent to numerical methods for conservation laws: while the second-order scheme is far more accurate for smooth profiles, its performance degrades near discontinuities, where it can introduce spurious oscillations that may lead to a larger overall error. This experience provides the essential motivation for the development of more sophisticated, non-linear schemes using slope limiters, a cornerstone of modern shock-capturing methods.",
            "id": "2394314",
            "problem": "You are to compare two conservative finite volume discretizations for the linear advection equation and quantify when a second-order linear reconstruction performs worse than a first-order method due to spurious oscillations near a discontinuity.\n\nConsider the linear advection equation\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0,\n$$\non a periodic domain $[0,1)$ with constant advection speed $a0$. Let a uniform partition into $N$ cells be given by interfaces $x_{i\\pm \\frac{1}{2}}$ with $x_{i+\\frac{1}{2}}-x_{i-\\frac{1}{2}}=\\Delta x$ and cell centers $x_i = \\frac{1}{2}\\left(x_{i-\\frac{1}{2}}+x_{i+\\frac{1}{2}}\\right)$. Let the cell average be\n$$\nu_i^n \\equiv \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(x,t^n)\\,dx.\n$$\nThe conservative update is\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right),\n$$\nwhere the upwind numerical flux for $a0$ is $F_{i+\\frac{1}{2}}^n = a\\,u_{i+\\frac{1}{2}}^{-,n}$, with $u_{i+\\frac{1}{2}}^{-,n}$ the left-sided trace at $x_{i+\\frac{1}{2}}$ reconstructed from cell $i$. Assume periodic indexing so that $u_{i+N}^n = u_i^n$ and $u_{i-N}^n = u_i^n$.\n\nYou must implement and compare:\n- A first-order reconstruction (piecewise constant), defined by $u_{i+\\frac{1}{2}}^{-,n} = u_i^n$.\n- A second-order linear reconstruction without any limiter, defined by slopes $s_i^n = \\frac{1}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right)$ and $u_{i+\\frac{1}{2}}^{-,n} = u_i^n + \\frac{1}{2}s_i^n$.\n\nUse a fixed Courant-Friedrichs-Lewy (CFL) number $\\nu \\in (0,1)$ to set the time step via\n$$\n\\Delta t = \\nu \\frac{\\Delta x}{a}.\n$$\nIf the final time $T$ is not an exact multiple of $\\Delta t$, take the last step with a reduced $\\Delta t$ so that the total integration time equals $T$ exactly.\n\nFor each test case below, compute the numerical solution at time $T$ by each method, and then compute the cell-average exact solution at time $T$ given by\n$$\nu(x,T) = u_0\\big((x - a T) \\bmod 1\\big),\n$$\nand its cell averages\n$$\n\\bar{u}_i^{\\text{exact}}(T) = \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(y,T)\\,dy.\n$$\nQuantify the error using the discrete $L^1$ norm of cell averages:\n$$\nE_1 = \\Delta x \\sum_{i=0}^{N-1} \\left| u_i(T) - \\bar{u}_i^{\\text{exact}}(T) \\right|.\n$$\n\nUse $a = 1$ and $\\nu = 0.9$ for all cases. The domain is $[0,1)$ with periodic boundary conditions for all cases. The initial conditions $u_0(x)$, the number of cells $N$, and the final time $T$ for the test suite are:\n\n- Test case $1$ (discontinuous top-hat, non-aligned): $N=200$, $T=0.25$, and\n  $$\n  u_0(x) = \\begin{cases}\n  1,  x \\in [0.2, 0.4),\\\\\n  0,  \\text{otherwise,}\n  \\end{cases}\n  $$\n  interpreted on $[0,1)$ periodically.\n\n- Test case $2$ (smooth wave): $N=80$, $T=0.5$, and\n  $$\n  u_0(x) = \\sin(2\\pi x).\n  $$\n\n- Test case $3$ (narrow top-hat tied to grid spacing): $N=80$, $T=0.3$, and\n  $$\n  u_0(x) = \\begin{cases}\n  1,  x \\in [x_0, x_0 + 3\\Delta x),\\\\\n  0,  \\text{otherwise,}\n  \\end{cases}\n  $$\n  with $x_0 = 0.33$ and $\\Delta x = 1/N$; interpret $[x_0, x_0+3\\Delta x)$ modulo $1$.\n\nFor each test case, compute $E_1^{(1)}$ for the first-order method and $E_1^{(2)}$ for the second-order linear reconstruction without any limiter. For each test case, return the integer $1$ if $E_1^{(2)}  E_1^{(1)}$ and the integer $0$ otherwise.\n\nYour program should produce a single line of output containing the three integers for the test cases in order, as a comma-separated list enclosed in square brackets (e.g., $[1,0,1]$). No additional output should be produced.",
            "solution": "The problem presented requires a comparative analysis of two finite volume method discretizations for the one-dimensional linear advection equation, $\\partial_t u + a\\,\\partial_x u = 0$. The comparison is based on the discrete $L^1$ error norm against the exact solution for both a smooth initial profile and discontinuous initial profiles. The analysis serves to illustrate a fundamental trade-off in numerical methods for conservation laws: the accuracy of high-order schemes on smooth solutions versus their tendency to produce spurious oscillations near discontinuities when not equipped with slope limiters.\n\nFirst, we establish the discrete framework. The spatial domain $[0,1)$ is partitioned into $N$ uniform cells, each of width $\\Delta x = 1/N$. The cell $i$ spans the interval $[x_{i-1/2}, x_{i+1/2}]$, where $x_{i+1/2} = (i+1)\\Delta x$ for $i=-1, \\dots, N-1$. The cell center is $x_i = (i+1/2)\\Delta x$. The cell average of a function $f(x)$ over cell $i$ is denoted $f_i = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} f(x) \\, dx$.\n\nThe finite volume method evolves the cell averages $u_i^n$ at time $t^n$ to $t^{n+1}=t^n+\\Delta t$ via the conservative formula:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2}^n - F_{i-1/2}^n \\right)\n$$\nHere, $F_{i+1/2}^n$ is the numerical flux at the interface $x_{i+1/2}$. For the linear advection equation with speed $a0$, the flux is purely upwind, meaning it depends only on the state to the left of the interface. This gives $F_{i+1/2}^n = a \\cdot u_{i+1/2}^{-,n}$, where $u_{i+1/2}^{-,n}$ is the value of the solution reconstructed at the left-side of the interface $x_{i+1/2}$ from data in cell $i$. The time step $\\Delta t$ is determined by the fixed CFL number $\\nu = a \\Delta t / \\Delta x$, so $\\Delta t = \\nu \\Delta x / a$. The problem specifies $a=1$ and $\\nu=0.9$. The update equation simplifies to:\n$$\nu_i^{n+1} = u_i^n - \\nu \\left( u_{i+1/2}^{-,n} - u_{i-1/2}^{-,n} \\right)\n$$\nPeriodic boundary conditions are imposed, so indices are handled modulo $N$.\n\nWe examine two reconstruction methods for $u_{i+1/2}^{-,n}$:\n\n1.  **First-Order Upwind Method**: This method uses a piecewise constant reconstruction within each cell, $u(x) = u_i^n$ for $x \\in [x_{i-1/2}, x_{i+1/2}]$. The value at the left of the interface $x_{i+1/2}$ is simply the cell average from cell $i$:\n    $$\n    u_{i+1/2}^{-,n} = u_i^n\n    $$\n    Substituting this into the update formula yields the classic first-order upwind scheme:\n    $$\n    u_i^{n+1} = u_i^n - \\nu \\left( u_i^n - u_{i-1}^n \\right)\n    $$\n    This scheme is known to be total variation diminishing (TVD) for $\\nu \\in [0,1]$, which prevents the formation of new oscillations. However, its accuracy is only first-order, leading to significant numerical diffusion, which smears sharp features.\n\n2.  **Second-Order Linear Reconstruction (Unlimited)**: This method uses a piecewise linear reconstruction in each cell, $u(x) = u_i^n + s_i^n(x - x_i)$. The problem defines the reconstruction at the interface based on a specified formula for the slope, which we interpret as a dimensionless slope. The reconstructed value is given as $u_{i+1/2}^{-,n} = u_i^n + \\frac{1}{2}s_i^n$, with $s_i^n = \\frac{1}{2}(u_{i+1}^n - u_{i-1}^n)$. Combining these gives:\n    $$\n    u_{i+1/2}^{-,n} = u_i^n + \\frac{1}{4}\\left( u_{i+1}^n - u_{i-1}^n \\right)\n    $$\n    This reconstruction approximates the point value $u(x_{i+1/2})$ to second-order accuracy in space for smooth solutions. The update formula becomes:\n    $$\n    u_i^{n+1} = u_i^n - \\nu \\left[ \\left( u_i^n + \\frac{1}{4}(u_{i+1}^n - u_{i-1}^n) \\right) - \\left( u_{i-1}^n + \\frac{1}{4}(u_i^n - u_{i-2}^n) \\right) \\right]\n    $$\n    $$\n    u_i^{n+1} = u_i^n - \\nu \\left( \\frac{3}{4}u_i^n - \\frac{5}{4}u_{i-1}^n + \\frac{1}{4}u_{i+1}^n + \\frac{1}{4}u_{i-2}^n \\right)\n    $$\n    This is a linear scheme with a four-point stencil involving cells $i-2, i-1, i, i+1$. While it achieves second-order accuracy on smooth solutions, it is not TVD and is known to be dispersive, producing spurious oscillations (Gibbs phenomenon) near discontinuities. The purpose of the exercise is to quantify when these oscillations lead to a larger error than the diffusive first-order scheme.\n\nTo conduct the analysis, we first compute the initial cell averages $u_i^0$ by integrating the initial condition $u_0(x)$ over each cell.\n- For a top-hat function $u_0(x) = 1$ on an interval $[b_1, b_2)$ and $0$ otherwise, the cell average is $u_i^0 = \\frac{1}{\\Delta x} \\text{length}([x_{i-1/2}, x_{i+1/2}] \\cap [b_1, b_2))$.\n- For the smooth function $u_0(x) = \\sin(2\\pi x)$, the integral can be computed analytically:\n  $$\n  u_i^0 = \\frac{1}{\\Delta x} \\int_{i\\Delta x}^{(i+1)\\Delta x} \\sin(2\\pi x) dx = \\frac{\\cos(2\\pi i\\Delta x) - \\cos(2\\pi(i+1)\\Delta x)}{2\\pi\\Delta x} = \\frac{\\sin(\\pi\\Delta x)}{\\pi\\Delta x}\\sin(2\\pi x_i)\n  $$\n\nThe exact solution to the advection equation is $u(x,T) = u_0((x-aT)\\pmod 1)$. The exact cell averages at the final time $T$ are computed by integrating this exact solution over each cell:\n$$\n\\bar{u}_i^{\\text{exact}}(T) = \\frac{1}{\\Delta x}\\int_{x_{i-1/2}}^{x_{i+1/2}} u_0((x-aT)\\pmod 1) \\,dx\n$$\nThis calculation is analogous to finding the initial cell averages, but with the initial profile shifted by $aT$.\n\nThe time integration proceeds for a number of full steps $N_{\\text{steps}} = \\lfloor T/\\Delta t \\rfloor$ using the fixed time step $\\Delta t = \\nu \\Delta x / a$. If there is a remaining time $\\Delta t_{\\text{final}} = T - N_{\\text{steps}}\\Delta t  0$, a final, smaller time step is taken to reach exactly time $T$.\n\nFinally, the error for each method is quantified using the discrete $L^1$ norm:\n$$\nE_1 = \\Delta x \\sum_{i=0}^{N-1} \\left| u_i(T) - \\bar{u}_i^{\\text{exact}}(T) \\right|\n$$\nFor each test case, we compute the error $E_1^{(1)}$ for the first-order method and $E_1^{(2)}$ for the second-order method. We then determine if $E_1^{(2)}  E_1^{(1)}$.\n\n- **Test Case 1 (Discontinuous top-hat)**: The initial condition is discontinuous. The second-order method will produce significant over- and undershoots at the edges of the top-hat. The first-order method will smear the edges. The large, non-decaying oscillations from the second-order scheme are expected to result in a larger $L^1$ error compared to the diffusive but non-oscillatory first-order scheme. Thus, we expect $E_1^{(2)}  E_1^{(1)}$.\n- **Test Case 2 (Smooth wave)**: The initial condition is $C^\\infty$. For such solutions, the second-order method's superior accuracy will be clearly evident. It will approximate the sine wave with much smaller error than the highly diffusive first-order method. We expect $E_1^{(2)}  E_1^{(1)}$.\n- **Test Case 3 (Narrow top-hat)**: This is another discontinuous case, made more challenging by the feature's width being only a few grid cells ($3\\Delta x$). This accentuates the flaw of the unlimited linear reconstruction, as the stencil for the slope calculation spans a significant portion of the feature. We again expect large oscillations and $E_1^{(2)}  E_1^{(1)}$.\n\nThe implementation will proceed by creating a general finite volume solver that can be configured for either method. This solver will be applied to each test case, the errors computed, and the comparison made as required.\n\n```python\nimport numpy as np\n\ndef get_box_averages(N, box_start, box_end):\n    \"\"\"\n    Computes cell averages for a function that is 1 on [box_start, box_end)\n    and 0 otherwise, on a periodic domain [0,1).\n    \"\"\"\n    dx = 1.0 / N\n    cell_starts = np.arange(N) * dx\n    cell_ends = (np.arange(N) + 1) * dx\n    u_avg = np.zeros(N)\n\n    # Handle multiple integer wrappings of the interval\n    num_wraps = np.floor(box_end) - np.floor(box_start)\n    s_mod = box_start % 1.0\n    e_mod = box_end % 1.0\n\n    if num_wraps == 0: # Interval does not cross an integer\n        s, e = s_mod, e_mod\n        if e = s:\n            return u_avg\n        overlap = np.maximum(0, np.minimum(cell_ends, e) - np.maximum(cell_starts, s))\n        u_avg += overlap\n    else: # Interval crosses at least one integer\n        # Part from start to 1.0\n        overlap1 = np.maximum(0, np.minimum(cell_ends, 1.0) - np.maximum(cell_starts, s_mod))\n        u_avg += overlap1\n        # Part from 0.0 to end\n        overlap2 = np.maximum(0, np.minimum(cell_ends, e_mod) - np.maximum(cell_starts, 0.0))\n        u_avg += overlap2\n        # Full wraps\n        if num_wraps > 1:\n            u_avg += (num_wraps - 1) * dx\n\n    return u_avg / dx\n\ndef run_fvm(u_initial, N, T, a, nu_fixed, method):\n    \"\"\"\n    Solves the linear advection equation using the finite volume method.\n    \"\"\"\n    u = u_initial.copy()\n    dx = 1.0 / N\n    \n    dt_fixed = nu_fixed * dx / a\n    if dt_fixed = 0:\n        return u\n        \n    num_steps = int(T / dt_fixed) if T > 0 else 0\n    t = 0.0\n\n    for _ in range(num_steps):\n        nu = nu_fixed\n        if method == 'first':\n            u = u - nu * (u - np.roll(u, 1))\n        elif method == 'second':\n            u_p1 = np.roll(u, -1)\n            u_m1 = np.roll(u, 1)\n            s = 0.5 * (u_p1 - u_m1)\n            u_interface = u + 0.5 * s\n            flux_diff = u_interface - np.roll(u_interface, 1)\n            u = u - nu * flux_diff\n        t += dt_fixed\n    \n    dt_final = T - t\n    if dt_final > 1e-12:\n        nu_final = a * dt_final / dx\n        if method == 'first':\n            u = u - nu_final * (u - np.roll(u, 1))\n        elif method == 'second':\n            u_p1 = np.roll(u, -1)\n            u_m1 = np.roll(u, 1)\n            s = 0.5 * (u_p1 - u_m1)\n            u_interface = u + 0.5 * s\n            flux_diff = u_interface - np.roll(u_interface, 1)\n            u = u - nu_final * flux_diff\n            \n    return u\n\ndef solve_and_compare():\n    \"\"\"\n    Main function to run test cases and produce the final output.\n    \"\"\"\n    test_cases = [\n        (200, 0.25, 'top-hat', {'start': 0.2, 'end': 0.4}),\n        (80, 0.5, 'sine-wave', {}),\n        (80, 0.3, 'narrow-top-hat', {'x0': 0.33}),\n    ]\n\n    a = 1.0\n    nu_fixed = 0.9\n    results = []\n\n    for N, T, u0_type, params in test_cases:\n        dx = 1.0 / N\n        x_centers = (np.arange(N) + 0.5) * dx\n\n        if u0_type == 'top-hat':\n            start, end = params['start'], params['end']\n            u_initial = get_box_averages(N, start, end)\n        elif u0_type == 'sine-wave':\n            factor = np.sinc(dx)\n            u_initial = factor * np.sin(2 * np.pi * x_centers)\n        elif u0_type == 'narrow-top-hat':\n            x0 = params['x0']\n            start, end = x0, x0 + 3 * dx\n            u_initial = get_box_averages(N, start, end)\n\n        u_final_1st = run_fvm(u_initial, N, T, a, nu_fixed, 'first')\n        u_final_2nd = run_fvm(u_initial, N, T, a, nu_fixed, 'second')\n        \n        shift = (a * T) % 1.0\n        if u0_type == 'top-hat':\n            start, end = params['start'], params['end']\n            u_exact = get_box_averages(N, start + shift, end + shift)\n        elif u0_type == 'sine-wave':\n            factor = np.sinc(dx)\n            # Exact solution for u(x,T)=sin(2pi(x-aT))\n            u_exact = factor * np.sin(2 * np.pi * (x_centers - a*T))\n        elif u0_type == 'narrow-top-hat':\n            x0 = params['x0']\n            start, end = x0, x0 + 3 * dx\n            u_exact = get_box_averages(N, start + shift, end + shift)\n\n        e1_1st = dx * np.sum(np.abs(u_final_1st - u_exact))\n        e1_2nd = dx * np.sum(np.abs(u_final_2nd - u_exact))\n        \n        results.append(1 if e1_2nd > e1_1st else 0)\n\n    return results\n```",
            "answer": "[1,0,1]"
        }
    ]
}