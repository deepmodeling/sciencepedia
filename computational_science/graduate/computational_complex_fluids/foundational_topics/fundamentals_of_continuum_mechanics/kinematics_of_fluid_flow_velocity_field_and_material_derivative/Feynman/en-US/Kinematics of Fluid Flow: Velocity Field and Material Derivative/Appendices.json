{
    "hands_on_practices": [
        {
            "introduction": "This first exercise serves as a foundational drill in calculating and interpreting the material derivative. By applying the definition to a simple, analytically tractable rotational flow, you will explicitly decompose the total change of a scalar field into its local (temporal) and advective (convective) components. This practice is designed to solidify your understanding of how a property of a fluid particle can change both because the field itself is evolving in time and because the particle is moving to a new location where the field has a different value .",
            "id": "4091900",
            "problem": "Consider a two-dimensional flow representative of rigid-body rotation in Computational Fluid Dynamics (CFD). Let the velocity field be $\\mathbf{v}(\\mathbf{x},t)=\\left(y,-x\\right)$ in the plane, where $\\mathbf{x}=(x,y)$, and let a nondimensional scalar field be $\\phi(\\mathbf{x},t)=x^{2}+y^{2}+t$. The material derivative is defined as the time rate of change of a scalar field experienced by a fluid particle as it moves with the flow. Starting only from the definition of a fluid particle trajectory $\\mathbf{X}(t)$ governed by $\\mathrm{d}\\mathbf{X}/\\mathrm{d}t=\\mathbf{v}(\\mathbf{X}(t),t)$, and the definition of the material derivative as the total derivative $\\mathrm{d}\\phi(\\mathbf{X}(t),t)/\\mathrm{d}t$ along that trajectory, derive an explicit expression for $D\\phi/Dt$ in terms of $x$, $y$, and $t$, and evaluate it. Then, interpret the result geometrically in terms of rotation, explaining why any advective contribution does or does not appear for this particular $\\phi$ and $\\mathbf{v}$. Treat $\\phi$ as nondimensional; no units are required. Provide the final value of $D\\phi/Dt$ as a single exact number or closed-form expression. No rounding is needed.",
            "solution": "The problem requires the derivation and evaluation of the material derivative, $\\frac{D\\phi}{Dt}$, for a given two-dimensional velocity field $\\mathbf{v}(\\mathbf{x}, t) = (y, -x)$ and a scalar field $\\phi(\\mathbf{x}, t) = x^2 + y^2 + t$. The position vector is $\\mathbf{x}=(x,y)$. The derivation must proceed from the fundamental definitions of a fluid particle trajectory and the material derivative as a total derivative along this trajectory.\n\nA fluid particle's trajectory, denoted by the vector function $\\mathbf{X}(t) = (X(t), Y(t))$, is determined by the velocity field. The particle's velocity at any time $t$ is equal to the fluid velocity at the particle's location $\\mathbf{X}(t)$. This relationship is expressed by the ordinary differential equation:\n$$\n\\frac{\\mathrm{d}\\mathbf{X}}{\\mathrm{d}t} = \\mathbf{v}(\\mathbf{X}(t), t)\n$$\nThe material derivative of the scalar field $\\phi$, denoted $\\frac{D\\phi}{Dt}$, is defined as the time rate of change of $\\phi$ as experienced by an observer moving with a fluid particle. Mathematically, this is the total derivative of the composite function $\\phi(\\mathbf{X}(t), t)$ with respect to time $t$:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\phi(\\mathbf{X}(t), t)\n$$\nTo find this total derivative, we apply the multivariate chain rule. The function $\\phi$ depends on time $t$ explicitly, and also implicitly through the particle coordinates $X(t)$ and $Y(t)$, which are themselves functions of $t$. The chain rule yields:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial\\phi}{\\partial X}\\frac{\\mathrm{d}X}{\\mathrm{d}t} + \\frac{\\partial\\phi}{\\partial Y}\\frac{\\mathrm{d}Y}{\\mathrm{d}t} + \\frac{\\partial\\phi}{\\partial t}\\frac{\\mathrm{d}t}{\\mathrm{d}t}\n$$\nFrom the definition of the particle trajectory, the components of its velocity are given by the components of the fluid velocity field, $\\mathbf{v} = (u,v)$, evaluated at the particle's position:\n$$\n\\frac{\\mathrm{d}X}{\\mathrm{d}t} = u(X(t), Y(t), t) \\quad \\text{and} \\quad \\frac{\\mathrm{d}Y}{\\mathrm{d}t} = v(X(t), Y(t), t)\n$$\nSubstituting these expressions into the chain rule equation, and recognizing that $\\frac{\\mathrm{d}t}{\\mathrm{d}t} = 1$, we obtain the expression for the material derivative in terms of the field variables:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial\\phi}{\\partial t} + u\\frac{\\partial\\phi}{\\partial X} + v\\frac{\\partial\\phi}{\\partial Y}\n$$\nThis expression is typically written in the Eulerian frame of reference, using the spatial coordinates $(x,y)$ rather than the Lagrangian particle coordinates $(X,Y)$. In vector notation, this is:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial\\phi}{\\partial t} + \\mathbf{v} \\cdot \\nabla\\phi\n$$\nThis is the general expression for the material derivative, which was derived as required. It consists of two parts: the local rate of change, $\\frac{\\partial\\phi}{\\partial t}$, which is the change observed at a fixed point in space, and the advective (or convective) rate of change, $\\mathbf{v} \\cdot \\nabla\\phi$, which is the change due to the particle's motion into a region with a different value of $\\phi$.\n\nWe now evaluate this expression for the specific fields given in the problem:\n- Velocity field: $\\mathbf{v}(x,y) = (y, -x)$, so the components are $u=y$ and $v=-x$.\n- Scalar field: $\\phi(x,y,t) = x^2 + y^2 + t$.\n\nFirst, we calculate the local rate of change of $\\phi$:\n$$\n\\frac{\\partial\\phi}{\\partial t} = \\frac{\\partial}{\\partial t}(x^2 + y^2 + t) = 1\n$$\nNext, we calculate the gradient of $\\phi$, $\\nabla\\phi$:\n$$\n\\nabla\\phi = \\left(\\frac{\\partial\\phi}{\\partial x}, \\frac{\\partial\\phi}{\\partial y}\\right) = \\left(\\frac{\\partial}{\\partial x}(x^2 + y^2 + t), \\frac{\\partial}{\\partial y}(x^2 + y^2 + t)\\right) = (2x, 2y)\n$$\nNow, we compute the advective term, $\\mathbf{v} \\cdot \\nabla\\phi$:\n$$\n\\mathbf{v} \\cdot \\nabla\\phi = (u, v) \\cdot \\left(\\frac{\\partial\\phi}{\\partial x}, \\frac{\\partial\\phi}{\\partial y}\\right) = (y, -x) \\cdot (2x, 2y) = y(2x) + (-x)(2y) = 2xy - 2xy = 0\n$$\nFinally, we combine the local and advective terms to find the material derivative:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial\\phi}{\\partial t} + \\mathbf{v} \\cdot \\nabla\\phi = 1 + 0 = 1\n$$\nThe value of the material derivative is $1$.\n\nFor the geometric interpretation, we must explain why the advective contribution, $\\mathbf{v} \\cdot \\nabla\\phi$, vanishes. The advective term being zero implies that the velocity vector $\\mathbf{v}$ is orthogonal to the gradient vector $\\nabla\\phi$ at every point in the flow.\n\nLet's analyze the geometry of these vector fields.\nThe scalar field at any fixed time $t_0$ is $\\phi(x,y,t_0) = x^2 + y^2 + t_0$. The spatial variation is given by $f(x,y) = x^2 + y^2$. The level sets of this function, where $f(x,y)$ is constant, are circles centered at the origin, described by the equation $x^2 + y^2 = C$ for some constant $C$.\nThe gradient of $\\phi$, $\\nabla\\phi = (2x, 2y)$, is a vector that is always directed radially outward from the origin. The gradient vector is always perpendicular to the level sets of the function.\n\nThe velocity field, $\\mathbf{v} = (y, -x)$, describes a rigid-body rotation around the origin. We can verify that the velocity vector at any point $\\mathbf{r}=(x,y)$ is tangent to the circle passing through that point. The position vector $\\mathbf{r}=(x,y)$ is radial. The dot product of the position vector and the velocity vector is:\n$$\n\\mathbf{r} \\cdot \\mathbf{v} = (x,y) \\cdot (y, -x) = xy - yx = 0\n$$\nSince their dot product is zero, the velocity vector $\\mathbf{v}$ is always orthogonal to the position vector $\\mathbf{r}$.\nWe have established that $\\nabla\\phi$ is parallel to $\\mathbf{r}$, and $\\mathbf{v}$ is orthogonal to $\\mathbf{r}$. It follows directly that $\\mathbf{v}$ is orthogonal to $\\nabla\\phi$.\n\nThis orthogonality has a clear physical meaning. The fluid particles, which follow the velocity vectors $\\mathbf{v}$, move along trajectories that are tangent to the level sets of the spatial part of $\\phi$. In this case, the particles move in circles, and on any given circle, the value of $x^2+y^2$ is constant. Because a particle's motion does not transport it to a location with a different value of $x^2+y^2$, there is no change in $\\phi$ due to advection. The particle experiences change in $\\phi$ only because $\\phi$ itself is explicitly changing with time.\n\nTherefore, the total change observed by the particle, $\\frac{D\\phi}{Dt}$, is solely due to the local rate of change, $\\frac{\\partial\\phi}{\\partial t} = 1$. The advective contribution is zero because the flow is directed purely along the isosurfaces of the spatial component of the scalar field.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "This practice explores the powerful connection between the material derivative and the fundamental kinematic descriptors of a flow: streamlines and pathlines. You will first derive these curves from their geometric and kinematic definitions for a steady rotational flow. Then, by using the material derivative to show that a particle's squared distance from the origin, $r^2$, is a conserved quantity, you will uncover why pathlines must coincide with streamlines in this steady flow, providing a concrete example of a more general principle .",
            "id": "4091837",
            "problem": "Consider a two-dimensional, time-independent velocity field $\\mathbf{v}(\\mathbf{x})$ defined on $\\mathbb{R}^{2}$ by $\\mathbf{v}(x,y) = \\big(y,-x\\big)$, which models a rigid-body rotation of an incompressible complex fluid. Use only the following foundational definitions: (i) a streamline at a fixed time is a curve whose tangent vector at each point is parallel to the instantaneous velocity vector at that point; (ii) a pathline is the trajectory of a material particle, satisfying $\\mathrm{d}\\mathbf{x}/\\mathrm{d}t = \\mathbf{v}(\\mathbf{x},t)$ with an initial condition; and (iii) the material derivative of a scalar field $\\phi(\\mathbf{x},t)$ is $D\\phi/Dt = \\partial \\phi/\\partial t + \\mathbf{v}\\cdot\\nabla\\phi$.\n\nTasks:\n1. From the streamline definition, derive the implicit family of streamline curves by identifying an invariant $S(x,y)$ that remains constant along each such curve. Express your answer as a single analytic function $S(x,y)$.\n2. From the pathline definition, derive the parametric trajectory $t \\mapsto \\big(x(t),y(t)\\big)$ of a fluid particle that starts at $\\big(x(0),y(0)\\big) = (1,0)$ at time $t=0$.\n3. Using the material derivative, compute $D\\big(r^{2}\\big)/Dt$ for the scalar field $r^{2}(x,y) = x^{2}+y^{2}$, and interpret the result to explain the geometric relation between the pathline from part 2 and the streamline family from part 1. Your explanation must be based on first principles, without invoking pre-derived shortcut formulas.\n\nProvide as your final answer the row matrix containing the invariant $S(x,y)$ from part 1 and the two parametric components $x(t)$ and $y(t)$ from part 2, in that order. No rounding is required. No units are required.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution without any contradictions.\n\nThe problem is addressed in three parts as specified.\n\n**Part 1: Derivation of the Streamline Invariant**\n\nBy definition (i), a streamline is a curve $\\mathbf{x}(s) = (x(s), y(s))$ in the plane, parameterized by a variable $s$, such that its tangent vector $\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}s}$ is everywhere parallel to the velocity field $\\mathbf{v}(x,y)$. This condition of parallelism can be expressed via the differential equation:\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}x} = \\frac{v_y(x,y)}{v_x(x,y)}\n$$\nThe given velocity field is $\\mathbf{v}(x,y) = (y, -x)$, with components $v_x = y$ and $v_y = -x$. Substituting these into the differential equation gives:\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}x} = \\frac{-x}{y}\n$$\nThis is a separable first-order ordinary differential equation. We can rearrange the terms to separate the variables $x$ and $y$:\n$$\ny \\, \\mathrm{d}y = -x \\, \\mathrm{d}x\n$$\nIntegrating both sides of the equation yields:\n$$\n\\int y \\, \\mathrm{d}y = \\int -x \\, \\mathrm{d}x\n$$\n$$\n\\frac{1}{2}y^{2} = -\\frac{1}{2}x^{2} + C'\n$$\nwhere $C'$ is an arbitrary constant of integration. To simplify, we can multiply by $2$ and rearrange the equation to place all variables on one side:\n$$\nx^{2} + y^{2} = 2C'\n$$\nLetting $C = 2C'$, we find that the family of streamlines is described by the equation $x^{2} + y^{2} = C$, where each value of the constant $C > 0$ defines a specific streamline, which is a circle centered at the origin.\n\nAn invariant $S(x,y)$ is a function that remains constant along each streamline. From the equation of the family of streamlines, we can directly identify this invariant as:\n$$\nS(x,y) = x^{2} + y^{2}\n$$\n\n**Part 2: Derivation of the Pathline**\n\nBy definition (ii), a pathline is the trajectory $\\mathbf{x}(t) = (x(t), y(t))$ of a fluid particle over time $t$. It is governed by the system of differential equations $\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}t} = \\mathbf{v}(\\mathbf{x}(t), t)$. Since the flow is time-independent (steady), this becomes $\\frac{\\mathrm{d}\\mathbf{x}}{\\mathrm{d}t} = \\mathbf{v}(\\mathbf{x}(t))$.\n\nFor the given velocity field $\\mathbf{v} = (y, -x)$, the system of ordinary differential equations for the pathline components is:\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} = y(t) \\quad (1)\n$$\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} = -x(t) \\quad (2)\n$$\nTo solve this coupled system, we can differentiate equation (1) with respect to time $t$:\n$$\n\\frac{\\mathrm{d}^{2}x}{\\mathrm{d}t^{2}} = \\frac{\\mathrm{d}y}{\\mathrm{d}t}\n$$\nSubstituting equation (2) into this result eliminates $y$:\n$$\n\\frac{\\mathrm{d}^{2}x}{\\mathrm{d}t^{2}} = -x(t)\n$$\nThis gives a second-order linear homogeneous differential equation with constant coefficients:\n$$\n\\frac{\\mathrm{d}^{2}x}{\\mathrm{d}t^{2}} + x(t) = 0\n$$\nThe general solution for this simple harmonic oscillator equation is:\n$$\nx(t) = A \\cos(t) + B \\sin(t)\n$$\nwhere $A$ and $B$ are constants to be determined by the initial conditions. We can find $y(t)$ by substituting this solution for $x(t)$ back into equation (1):\n$$\ny(t) = \\frac{\\mathrm{d}x}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\big( A \\cos(t) + B \\sin(t) \\big) = -A \\sin(t) + B \\cos(t)\n$$\nThe problem specifies the initial condition at $t=0$ as $(x(0), y(0)) = (1, 0)$. We apply these conditions:\nFor $x(0)$:\n$$\n1 = x(0) = A \\cos(0) + B \\sin(0) = A(1) + B(0) = A\n$$\nSo, $A=1$.\nFor $y(0)$:\n$$\n0 = y(0) = -A \\sin(0) + B \\cos(0) = -A(0) + B(1) = B\n$$\nSo, $B=0$.\nSubstituting $A=1$ and $B=0$ into the general solutions for $x(t)$ and $y(t)$, we obtain the specific pathline:\n$$\nx(t) = \\cos(t)\n$$\n$$\ny(t) = -\\sin(t)\n$$\nThe parametric trajectory is thus $\\mathbf{x}(t) = (\\cos(t), -\\sin(t))$.\n\n**Part 3: Material Derivative and Interpretation**\n\nWe are asked to compute the material derivative of the scalar field $\\phi(x,y) = r^{2}(x,y) = x^{2}+y^{2}$. By definition (iii), the material derivative is:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\mathbf{v} \\cdot \\nabla\\phi\n$$\nThe field $\\phi = x^{2}+y^{2}$ has no explicit dependence on time $t$, so the local time derivative term is zero:\n$$\n\\frac{\\partial \\phi}{\\partial t} = 0\n$$\nNext, we compute the gradient of $\\phi$:\n$$\n\\nabla\\phi = \\left( \\frac{\\partial \\phi}{\\partial x}, \\frac{\\partial \\phi}{\\partial y} \\right) = \\left( \\frac{\\partial}{\\partial x}(x^{2}+y^{2}), \\frac{\\partial}{\\partial y}(x^{2}+y^{2}) \\right) = (2x, 2y)\n$$\nThe advective term, $\\mathbf{v} \\cdot \\nabla\\phi$, is the dot product of the velocity field $\\mathbf{v} = (y, -x)$ and the gradient $\\nabla\\phi$:\n$$\n\\mathbf{v} \\cdot \\nabla\\phi = (y, -x) \\cdot (2x, 2y) = (y)(2x) + (-x)(2y) = 2xy - 2xy = 0\n$$\nCombining the terms, the material derivative is:\n$$\n\\frac{D(r^{2})}{Dt} = 0 + 0 = 0\n$$\n**Interpretation:** The material derivative $\\frac{D\\phi}{Dt}$ represents the total rate of change of a property $\\phi$ experienced by a fluid particle as it moves along its pathline. In this case, $\\phi = r^{2} = x^{2}+y^{2}$ is the square of the particle's distance from the origin.\n\nThe result $\\frac{D(r^{2})}{Dt} = 0$ signifies that for any fluid particle, its squared distance from the origin is a conserved quantity; it does not change with time. This forces every particle to travel along a path of constant radius, i.e., a circle centered at the origin.\n\nThe geometric relationship is now clear. In Part 1, we found that the streamlines are the family of curves $S(x,y) = x^{2}+y^{2} = \\text{constant}$, which are circles centered at the origin. In Part 3, we have shown from first principles that the quantity $x^{2}+y^{2}$ is conserved along any pathline. This means that pathlines are constrained to lie on the very same family of curves that define the streamlines.\n\nFor this steady (time-independent) flow, the pathlines and streamlines are therefore identical. The specific pathline found in Part 2, $(x(t), y(t)) = (\\cos(t), -\\sin(t))$, satisfies $x^{2}+y^{2} = \\cos^{2}(t) + (-\\sin(t))^{2} = 1$, which corresponds to the streamline $S(x,y)=1$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} x^{2}+y^{2} & \\cos(t) & -\\sin(t) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Our final practice takes the concept of the material derivative from the realm of analytical mechanics into the world of computational fluid dynamics (CFD). The advection equation, $\\frac{\\partial \\phi}{\\partial t} + (\\mathbf{v} \\cdot \\nabla)\\phi = 0$, states that the material derivative of $\\phi$ is zero. This exercise challenges you to numerically solve this equation and directly confront the consequences of approximating the advective term $(\\mathbf{v} \\cdot \\nabla)\\phi$, which is a core task in CFD . By comparing different numerical schemes, you will gain practical insight into critical issues like numerical diffusion and dispersion that every computational fluid dynamicist must manage.",
            "id": "4091866",
            "problem": "Consider the pure advection of a scalar field in a one-dimensional periodic domain. The material derivative of a scalar field $\\phi(\\mathbf{x},t)$ in a velocity field $\\mathbf{v}(\\mathbf{x},t)$ is defined by $\\dfrac{D\\phi}{Dt}=\\dfrac{\\partial\\phi}{\\partial t}+(\\mathbf{v}\\cdot\\nabla)\\phi$. For a constant velocity field $\\mathbf{v}(\\mathbf{x},t)=u\\hat{\\mathbf{e}}_x$, the advection equation reduces to $\\dfrac{\\partial\\phi}{\\partial t}+u\\dfrac{\\partial\\phi}{\\partial x}=0$ on a periodic domain of length $L=1$.\n\nYour task is to implement a program that numerically advances $\\phi(x,t)$ from $t=0$ to $t=T$ using the method of lines with a three-stage explicit Strong Stability Preserving Runge–Kutta method (SSP-RK3) and approximates the convective term $(\\mathbf{v}\\cdot\\nabla)\\phi=u\\dfrac{\\partial\\phi}{\\partial x}$ using three different spatial schemes:\n- a first-order upwind (donor-cell) scheme,\n- a second-order central difference scheme,\n- a high-resolution Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) scheme with the Monotonized Central (MC) limiter.\n\nAll schemes must be implemented under periodic boundary conditions. Do not use any artificial smoothing or filtering beyond the discretization itself.\n\nInitial condition: for a given interface location $x_0\\in(0,1)$ and sharpness parameter $\\varepsilon>0$, set\n$$\n\\phi(x,0)=\\frac{1}{2}\\left(1+\\tanh\\left(\\frac{x-x_0}{\\varepsilon}\\right)\\right).\n$$\nThe exact solution at time $T$ is the translation\n$$\n\\phi_{\\text{exact}}(x,T)=\\frac{1}{2}\\left(1+\\tanh\\left(\\frac{(x-uT)\\bmod L - x_0}{\\varepsilon}\\right)\\right).\n$$\nAll quantities in this problem are dimensionless; no physical units are required.\n\nTime stepping: use a uniform time step defined by the Courant–Friedrichs–Lewy number $\\text{CFL}$ via $\\Delta t=\\text{CFL}\\dfrac{\\Delta x}{|u|}$, where $\\Delta x=L/N$ and $N$ is the number of grid points. Integrate until $t=T$, using the final step size adjusted if necessary so that the final time is exactly $T$.\n\nFor each scheme, after reaching $t=T$, quantify the impact on advecting the sharp gradient using the following metrics:\n- the discrete $L^1$ error with respect to the exact solution,\n$$\nE=\\Delta x\\sum_{i=0}^{N-1}\\left|\\phi_i(T)-\\phi_{\\text{exact}}(x_i,T)\\right|,\n$$\n- the maximum bound violation (overshoot) relative to the physically plausible range $\\phi\\in[0,1]$,\n$$\nO=\\max\\left(\\max_i\\left(\\phi_i(T)-1\\right),\\ \\max_i\\left(0-\\phi_i(T)\\right),\\ 0\\right).\n$$\n\nTest suite: run your program for the following parameter sets, all with $L=1$, $u=1$, and $x_0=0.35$,\n1. $N=128$, $\\text{CFL}=0.4$, $T=0.25$, $\\varepsilon=0.01$,\n2. $N=64$, $\\text{CFL}=0.6$, $T=0.5$, $\\varepsilon=0.005$,\n3. $N=256$, $\\text{CFL}=0.7$, $T=1.0$, $\\varepsilon=0.02$.\n\nOutput specification: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result must be a list of six floats in the order\n$$\n\\left[E_{\\text{upwind}},E_{\\text{central}},E_{\\text{high}},O_{\\text{upwind}},O_{\\text{central}},O_{\\text{high}}\\right],\n$$\nwhere “high” denotes the high-resolution MUSCL–MC scheme. Therefore the final output must be a single line of the form\n$$\n\\big[\\,[E_{\\text{up}},E_{\\text{cen}},E_{\\text{hi}},O_{\\text{up}},O_{\\text{cen}},O_{\\text{hi}}],\\ [\\cdots],\\ [\\cdots]\\big],\n$$\nwith no spaces in the printed list.",
            "solution": "The problem requires the numerical solution of the one-dimensional linear advection equation, $\\dfrac{\\partial\\phi}{\\partial t}+u\\,\\dfrac{\\partial\\phi}{\\partial x}=0$, on a periodic domain of length $L=1$. The solution is to be advanced in time from $t=0$ to a final time $t=T$ using the method of lines. This method involves discretizing the spatial derivatives to convert the partial differential equation (PDE) into a system of ordinary differential equations (ODEs), which is then solved using a numerical time integrator.\n\nThe semi-discrete form of the advection equation at a grid point $x_i$ is given by:\n$$\n\\frac{d\\phi_i}{dt} = -u \\left(\\frac{\\partial\\phi}{\\partial x}\\right)_i \\equiv \\mathcal{L}(\\phi)_i\n$$\nwhere $(\\partial\\phi/\\partial x)_i$ represents the numerical approximation of the spatial derivative at grid point $i$, and $\\mathcal{L}$ is the spatial discretization operator. The grid consists of $N$ points $x_i = i \\Delta x$ for $i=0, 1, \\dots, N-1$, with a uniform grid spacing of $\\Delta x = L/N$.\n\nThe problem specifies three different schemes for approximating the spatial derivative term $u\\,\\partial\\phi/\\partial x$:\n\n1.  **First-Order Upwind Scheme**: This scheme is chosen based on the sign of the advection velocity $u$. Since the problem specifies $u=1 > 0$, the information travels from left to right. The \"donor cell\" is the cell to the left ($i-1$). The derivative is approximated using a backward difference:\n    $$\n    u \\left(\\frac{\\partial\\phi}{\\partial x}\\right)_i \\approx u \\frac{\\phi_i - \\phi_{i-1}}{\\Delta x}\n    $$\n    This scheme is known to be very dissipative, smearing out sharp gradients.\n\n2.  **Second-Order Central Difference Scheme**: This scheme uses a symmetric stencil around the point $x_i$ and provides a second-order accurate approximation to the derivative:\n    $$\n    u \\left(\\frac{\\partial\\phi}{\\partial x}\\right)_i \\approx u \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x}\n    $$\n    While more accurate for smooth solutions, this scheme is dispersive and can introduce non-physical oscillations (Gibbs phenomenon) near sharp gradients, violating the bounds of the initial data.\n\n3.  **High-Resolution MUSCL Scheme with MC Limiter**: The Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) approach achieves higher order accuracy in smooth regions while preventing oscillations at discontinuities by using a flux limiter. This is a finite volume-inspired method. The semi-discrete equation is written in conservation form:\n    $$\n    \\frac{d\\phi_i}{dt} = -\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}\n    $$\n    where $F_{i+1/2}$ is the numerical flux at the interface between cells $i$ and $i+1$. For linear advection, the physical flux is $F(\\phi) = u\\phi$. For $u > 0$, the numerical flux is determined by the reconstructed state on the left side of the interface, $\\phi_{i,R}$:\n    $$\n    F_{i+1/2} = u \\phi_{i,R}\n    $$\n    The state $\\phi_{i,R}$ is reconstructed by assuming a linear profile within cell $i$, $\\phi(x) = \\phi_i + s_i(x-x_i)$, and evaluating it at the right cell boundary $x_{i+1/2} = x_i + \\Delta x / 2$. The slope $s_i$ is limited to prevent oscillations. A more convenient formulation uses the change across the cell, $\\Delta\\phi_i$:\n    $$\n    \\phi_{i,R} = \\phi_i + \\frac{1}{2}\\Delta\\phi_i\n    $$\n    The Monotonized Central (MC) limiter defines this change as:\n    $$\n    \\Delta\\phi_i = \\text{minmod}\\left(2(\\phi_i - \\phi_{i-1}), \\frac{\\phi_{i+1} - \\phi_{i-1}}{2}, 2(\\phi_{i+1} - \\phi_i)\\right)\n    $$\n    The multi-argument minmod function is defined as:\n    $$\n    \\text{minmod}(a_1, a_2, \\dots, a_k) = \n    \\begin{cases} \n    \\min(a_1, a_2, \\dots, a_k) & \\text{if } a_j > 0 \\text{ for all } j \\\\\n    \\max(a_1, a_2, \\dots, a_k) & \\text{if } a_j < 0 \\text{ for all } j \\\\\n    0 & \\text{otherwise}\n    \\end{cases}\n    $$\n    The spatial operator for the MUSCL scheme is then:\n    $$\n    \\mathcal{L}(\\phi)_i = -\\frac{u}{\\Delta x}\\left[ \\left(\\phi_i + \\frac{1}{2}\\Delta\\phi_i\\right) - \\left(\\phi_{i-1} + \\frac{1}{2}\\Delta\\phi_{i-1}\\right) \\right]\n    $$\n    For all schemes, periodic boundary conditions are enforced, meaning that indices are taken modulo $N$. For instance, $\\phi_{-1} \\equiv \\phi_{N-1}$ and $\\phi_N \\equiv \\phi_0$.\n\nFor time integration, the problem specifies the three-stage, third-order, explicit Strong Stability Preserving Runge–Kutta (SSP-RK3) method. Given the ODE system $\\frac{d\\phi}{dt} = \\mathcal{L}(\\phi)$, the update from time $t_n$ to $t_{n+1}=t_n+\\Delta t$ is:\n\\begin{align*}\n\\phi^{(1)} &= \\phi^n + \\Delta t \\, \\mathcal{L}(\\phi^n) \\\\\n\\phi^{(2)} &= \\frac{3}{4}\\phi^n + \\frac{1}{4}\\phi^{(1)} + \\frac{1}{4}\\Delta t \\, \\mathcal{L}(\\phi^{(1)}) \\\\\n\\phi^{n+1} &= \\frac{1}{3}\\phi^n + \\frac{2}{3}\\phi^{(2)} + \\frac{2}{3}\\Delta t \\, \\mathcal{L}(\\phi^{(2)})\n\\end{align*}\nThis process is applied at each time step for each of the three spatial schemes independently. The time step $\\Delta t$ is determined by the Courant–Friedrichs–Lewy (CFL) condition, $\\Delta t = \\text{CFL} \\frac{\\Delta x}{|u|}$. To ensure the integration stops exactly at $t=T$, the final time step is adjusted if necessary.\n\nThe initial condition is a smoothed step function centered at $x_0$:\n$$\n\\phi(x,0)=\\frac{1}{2}\\left(1+\\tanh\\left(\\frac{x-x_0}{\\varepsilon}\\right)\\right)\n$$\nFor the linear advection equation with constant velocity $u$ and periodic boundary conditions on a domain of length $L$, the exact solution is a simple translation of the initial profile:\n$$\n\\phi_{\\text{exact}}(x,T)=\\phi((x-uT)\\bmod L, 0) = \\frac{1}{2}\\left(1+\\tanh\\left(\\frac{(x-uT)\\bmod L - x_0}{\\varepsilon}\\right)\\right).\n$$\nThe program will simulate the advection for each test case, applying all three spatial schemes. After reaching the final time $T$, it will compute two metrics for each scheme: the discrete $L^1$ error, $E$, and the maximum bound violation (overshoot/undershoot), $O$.\n$$\nE=\\Delta x\\sum_{i=0}^{N-1}\\left|\\phi_i(T)-\\phi_{\\text{exact}}(x_i,T)\\right|\n$$\n$$\nO=\\max\\left(\\max_i\\left(\\phi_i(T)-1\\right),\\ \\max_i\\left(0-\\phi_i(T)\\right),\\ 0\\right)\n$$\nThe results for all test cases are then collected and formatted into a single output line as specified. Vectorized operations using `numpy`, particularly `numpy.roll` for handling periodic boundaries, are essential for an efficient implementation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the simulation for all test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'N': 128, 'CFL': 0.4, 'T': 0.25, 'epsilon': 0.01, 'L': 1.0, 'u': 1.0, 'x0': 0.35},\n        {'N': 64, 'CFL': 0.6, 'T': 0.5, 'epsilon': 0.005, 'L': 1.0, 'u': 1.0, 'x0': 0.35},\n        {'N': 256, 'CFL': 0.7, 'T': 1.0, 'epsilon': 0.02, 'L': 1.0, 'u': 1.0, 'x0': 0.35},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_simulation(**params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # repr() gives a string representation, and .replace(' ', '') removes spaces.\n    print(repr(results).replace(\" \", \"\"))\n\ndef vectorized_minmod(args):\n    \"\"\"\n    Vectorized minmod function for multiple arguments.\n    args: A list/tuple of numpy arrays.\n    \"\"\"\n    arr = np.array(args)\n    s = np.sign(arr)\n    all_pos = np.all(s >= 0, axis=0)\n    all_neg = np.all(s <= 0, axis=0)\n    \n    result = np.zeros_like(arr[0])\n    \n    # Where all are positive, take the minimum\n    if np.any(all_pos):\n        result[all_pos] = np.min(arr[:, all_pos], axis=0)\n    \n    # Where all are negative, take the maximum\n    if np.any(all_neg):\n        result[all_neg] = np.max(arr[:, all_neg], axis=0)\n        \n    return result\n\ndef rhs_upwind(phi, u, dx):\n    \"\"\"Computes the RHS for the first-order upwind scheme.\"\"\"\n    phi_im1 = np.roll(phi, 1)\n    # Assumes u > 0\n    return -u * (phi - phi_im1) / dx\n\ndef rhs_central(phi, u, dx):\n    \"\"\"Computes the RHS for the second-order central difference scheme.\"\"\"\n    phi_im1 = np.roll(phi, 1)\n    phi_ip1 = np.roll(phi, -1)\n    return -u * (phi_ip1 - phi_im1) / (2 * dx)\n\ndef rhs_muscl_mc(phi, u, dx):\n    \"\"\"Computes the RHS for the MUSCL scheme with MC limiter.\"\"\"\n    phi_im1 = np.roll(phi, 1)\n    phi_ip1 = np.roll(phi, -1)\n    \n    # Calculate limited differences delta_phi_i\n    # delta_phi_i = minmod(2*(phi_i - phi_{i-1}), (phi_{i+1} - phi_{i-1})/2, 2*(phi_{i+1} - phi_i))\n    dphi_L = phi - phi_im1\n    dphi_R = phi_ip1 - phi\n    dphi_C = (phi_ip1 - phi_im1) / 2.0\n    \n    delta_phi = vectorized_minmod([2*dphi_L, dphi_C, 2*dphi_R])\n    delta_phi_im1 = np.roll(delta_phi, 1)\n    \n    # Reconstructed values at interfaces (u > 0)\n    # F_{i-1/2} = u * (phi_{i-1} + 0.5 * delta_phi_{i-1})\n    # F_{i+1/2} = u * (phi_i + 0.5 * delta_phi_i)\n    flux_im1_2 = u * (phi_im1 + 0.5 * delta_phi_im1)\n    flux_ip1_2 = u * (phi + 0.5 * delta_phi)\n\n    return -(flux_ip1_2 - flux_im1_2) / dx\n\n\ndef run_simulation(N, CFL, T, epsilon, L, u, x0):\n    \"\"\"\n    Runs a single simulation case for all three schemes.\n    \"\"\"\n    dx = L / N\n    x = np.linspace(0, L, N, endpoint=False)\n    \n    # Initial condition\n    phi0 = 0.5 * (1 + np.tanh((x - x0) / epsilon))\n    \n    # Initialize solutions for each scheme\n    phi_upwind = phi0.copy()\n    phi_central = phi0.copy()\n    phi_muscl = phi0.copy()\n    \n    t = 0.0\n    dt_cfl = CFL * dx / abs(u)\n\n    while t < T:\n        dt = dt_cfl\n        if t + dt > T:\n            dt = T - t\n        \n        # --- SSP-RK3 for Upwind Scheme ---\n        L_n_upwind = rhs_upwind(phi_upwind, u, dx)\n        phi1_upwind = phi_upwind + dt * L_n_upwind\n        \n        L_1_upwind = rhs_upwind(phi1_upwind, u, dx)\n        phi2_upwind = 0.75 * phi_upwind + 0.25 * phi1_upwind + 0.25 * dt * L_1_upwind\n        \n        L_2_upwind = rhs_upwind(phi2_upwind, u, dx)\n        phi_upwind = (1/3) * phi_upwind + (2/3) * phi2_upwind + (2/3) * dt * L_2_upwind\n\n        # --- SSP-RK3 for Central Scheme ---\n        L_n_central = rhs_central(phi_central, u, dx)\n        phi1_central = phi_central + dt * L_n_central\n        \n        L_1_central = rhs_central(phi1_central, u, dx)\n        phi2_central = 0.75 * phi_central + 0.25 * phi1_central + 0.25 * dt * L_1_central\n        \n        L_2_central = rhs_central(phi2_central, u, dx)\n        phi_central = (1/3) * phi_central + (2/3) * phi2_central + (2/3) * dt * L_2_central\n        \n        # --- SSP-RK3 for MUSCL Scheme ---\n        L_n_muscl = rhs_muscl_mc(phi_muscl, u, dx)\n        phi1_muscl = phi_muscl + dt * L_n_muscl\n        \n        L_1_muscl = rhs_muscl_mc(phi1_muscl, u, dx)\n        phi2_muscl = 0.75 * phi_muscl + 0.25 * phi1_muscl + 0.25 * dt * L_1_muscl\n        \n        L_2_muscl = rhs_muscl_mc(phi2_muscl, u, dx)\n        phi_muscl = (1/3) * phi_muscl + (2/3) * phi2_muscl + (2/3) * dt * L_2_muscl\n\n        t += dt\n\n    # Exact solution\n    x_shifted = (x - u * T) % L\n    phi_exact = 0.5 * (1 + np.tanh((x_shifted - x0) / epsilon))\n\n    # Calculate metrics\n    def calculate_metrics(phi_num):\n        # L1 Error\n        error_L1 = dx * np.sum(np.abs(phi_num - phi_exact))\n        # Overshoot\n        overshoot = np.max(phi_num - 1.0)\n        undershoot = np.max(0.0 - phi_num)\n        bound_violation = np.max([overshoot, undershoot, 0.0])\n        return error_L1, bound_violation\n    \n    E_upwind, O_upwind = calculate_metrics(phi_upwind)\n    E_central, O_central = calculate_metrics(phi_central)\n    E_muscl, O_muscl = calculate_metrics(phi_muscl)\n    \n    return [E_upwind, E_central, E_muscl, O_upwind, O_central, O_muscl]\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}