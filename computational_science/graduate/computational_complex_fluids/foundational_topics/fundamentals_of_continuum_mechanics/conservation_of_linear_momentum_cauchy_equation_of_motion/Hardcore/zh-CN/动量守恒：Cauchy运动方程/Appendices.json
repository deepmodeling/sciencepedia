{
    "hands_on_practices": [
        {
            "introduction": "在我们开始数值求解柯西方程之前，我们必须能够熟练地进行解析推导。第一个练习将通过一个经典的剪切流场，来验证动量方程是否满足，从而为您打下坚实的解析基础。通过逐项计算，您将加深对物质导数、牛顿流体应力张量以及动量守恒概念的理解。",
            "id": "4081964",
            "problem": "考虑一个用作计算复杂流体建模基准测试的三维连续介质流体。应用局部形式的线性动量守恒，其中包含粘度恒定的牛顿流体的柯西应力，以及物质（随体）导数的定义。设速度场为定常简单剪切流 $\\mathbf{v}(\\mathbf{x})=(\\gamma y,0,0)$，其中 $\\gamma$ 为恒定的剪切速率，质量密度 $\\rho$ 为常数，粘度 $\\mu$ 为常数，且单位质量的体力不存在，因此 $\\mathbf{b}=\\mathbf{0}$。为进行此一致性检验，假设机械压力 $p$ 在空间上是均匀的。逐分量地计算局部线性动量平衡中的每一项，即 $\\rho \\dot{\\mathbf{v}}$、$\\nabla\\cdot\\boldsymbol{\\sigma}$ 和 $\\rho\\mathbf{b}$，然后构成残差向量 $\\rho \\dot{\\mathbf{v}}-\\nabla\\cdot\\boldsymbol{\\sigma}-\\rho\\mathbf{b}$。以单行矩阵的形式提供最终残差。无需四舍五入。最终的行矩阵中不应包含单位。",
            "solution": "经评估，问题陈述有效。它在科学上基于连续介质力学的原理，是适定的、客观的，并包含足够的信息以获得唯一解。我们开始求解。\n\n该问题要求计算局部线性动量平衡方程的残差，该方程即为柯西第一运动定律。方程如下：\n$$\n\\rho \\frac{D\\mathbf{v}}{Dt} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\mathbf{b}\n$$\n在本问题中，物质导数 $\\frac{D\\mathbf{v}}{Dt}$ 记为 $\\dot{\\mathbf{v}}$。我们被要求计算残差向量 $\\mathbf{R}$，其定义为：\n$$\n\\mathbf{R} = \\rho \\dot{\\mathbf{v}} - \\nabla \\cdot \\boldsymbol{\\sigma} - \\rho \\mathbf{b}\n$$\n我们将逐分量地计算残差向量中的每一项。给定信息包括：\n- 速度场：$\\mathbf{v}(\\mathbf{x}) = (\\gamma y, 0, 0)$，其中 $\\gamma$ 是一个常数。其分量形式为 $v_x = \\gamma y$，$v_y = 0$，$v_z = 0$。\n- 质量密度 $\\rho$ 为常数。\n- 动力粘度 $\\mu$ 为常数。\n- 单位质量的体力 $\\mathbf{b} = \\mathbf{0}$。\n- 机械压力 $p$ 在空间上是均匀的（常数）。\n\n首先，我们计算体力项 $\\rho \\mathbf{b}$。由于 $\\mathbf{b} = \\mathbf{0}$，该项即为：\n$$\n\\rho \\mathbf{b} = \\rho (0, 0, 0) = (0, 0, 0) = \\mathbf{0}\n$$\n\n接下来，我们计算惯性项 $\\rho \\dot{\\mathbf{v}}$。物质导数 $\\dot{\\mathbf{v}}$ 定义为：\n$$\n\\dot{\\mathbf{v}} = \\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v}\n$$\n问题指定了定常流，这意味着速度场不随时间变化，因此 $\\frac{\\partial \\mathbf{v}}{\\partial t} = \\mathbf{0}$。\n对流加速度项 $(\\mathbf{v} \\cdot \\nabla) \\mathbf{v}$ 的计算如下：\n$$\n(\\mathbf{v} \\cdot \\nabla) \\mathbf{v} = \\left( v_x \\frac{\\partial}{\\partial x} + v_y \\frac{\\partial}{\\partial y} + v_z \\frac{\\partial}{\\partial z} \\right) \\mathbf{v} = \\left( (\\gamma y) \\frac{\\partial}{\\partial x} + (0) \\frac{\\partial}{\\partial y} + (0) \\frac{\\partial}{\\partial z} \\right) \\mathbf{v} = (\\gamma y) \\frac{\\partial \\mathbf{v}}{\\partial x}\n$$\n速度向量对 $x$ 的偏导数为：\n$$\n\\frac{\\partial \\mathbf{v}}{\\partial x} = \\left( \\frac{\\partial(\\gamma y)}{\\partial x}, \\frac{\\partial(0)}{\\partial x}, \\frac{\\partial(0)}{\\partial x} \\right) = (0, 0, 0)\n$$\n因此，对流加速度为：\n$$\n(\\mathbf{v} \\cdot \\nabla) \\mathbf{v} = (\\gamma y) (0, 0, 0) = (0, 0, 0) = \\mathbf{0}\n$$\n合并各项，物质导数为 $\\dot{\\mathbf{v}} = \\mathbf{0} + \\mathbf{0} = \\mathbf{0}$。因此，惯性项为：\n$$\n\\rho \\dot{\\mathbf{v}} = \\rho \\mathbf{0} = \\mathbf{0}\n$$\n\n最后，我们计算柯西应力张量 $\\boldsymbol{\\sigma}$ 的散度 $\\nabla \\cdot \\boldsymbol{\\sigma}$。对于牛顿流体，柯西应力张量 $\\boldsymbol{\\sigma}$ 由下式给出：\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + \\boldsymbol{\\tau}\n$$\n其中 $p$ 是压力，$\\mathbf{I}$ 是单位张量，$\\boldsymbol{\\tau}$ 是粘性应力张量。对于不可压缩流，粘性应力为：\n$$\n\\boldsymbol{\\tau} = \\mu (\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^T)\n$$\n我们首先通过计算速度场的散度来验证流动是不可压缩的：\n$$\n\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} + \\frac{\\partial v_z}{\\partial z} = \\frac{\\partial(\\gamma y)}{\\partial x} + \\frac{\\partial(0)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = 0 + 0 + 0 = 0\n$$\n由于 $\\nabla \\cdot \\mathbf{v} = 0$，该流动确实是不可压缩的。现在我们计算速度梯度张量 $\\nabla \\mathbf{v}$：\n$$\n\\nabla \\mathbf{v} =\n\\begin{pmatrix}\n\\frac{\\partial v_x}{\\partial x} & \\frac{\\partial v_x}{\\partial y} & \\frac{\\partial v_x}{\\partial z} \\\\\n\\frac{\\partial v_y}{\\partial x} & \\frac{\\partial v_y}{\\partial y} & \\frac{\\partial v_y}{\\partial z} \\\\\n\\frac{\\partial v_z}{\\partial x} & \\frac{\\partial v_z}{\\partial y} & \\frac{\\partial v_z}{\\partial z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & \\gamma & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n其转置为：\n$$\n(\\nabla \\mathbf{v})^T =\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n\\gamma & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n那么，粘性应力张量 $\\boldsymbol{\\tau}$ 为：\n$$\n\\boldsymbol{\\tau} = \\mu \\left(\n\\begin{pmatrix}\n0 & \\gamma & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n\\gamma & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix} \\right) = \\mu\n\\begin{pmatrix}\n0 & \\gamma & 0 \\\\\n\\gamma & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & \\mu\\gamma & 0 \\\\\n\\mu\\gamma & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n完整的柯西应力张量 $\\boldsymbol{\\sigma}$ 为：\n$$\n\\boldsymbol{\\sigma} = -p\\mathbf{I} + \\boldsymbol{\\tau} =\n\\begin{pmatrix}\n-p & 0 & 0 \\\\\n0 & -p & 0 \\\\\n0 & 0 & -p\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n0 & \\mu\\gamma & 0 \\\\\n\\mu\\gamma & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-p & \\mu\\gamma & 0 \\\\\n\\mu\\gamma & -p & 0 \\\\\n0 & 0 & -p\n\\end{pmatrix}\n$$\n现在我们计算 $\\boldsymbol{\\sigma}$ 的散度。其第 $i$ 个分量为 $(\\nabla \\cdot \\boldsymbol{\\sigma})_i = \\sum_j \\frac{\\partial \\sigma_{ij}}{\\partial x_j}$。\n$x$ 分量为：\n$$\n(\\nabla \\cdot \\boldsymbol{\\sigma})_x = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} + \\frac{\\partial \\sigma_{xz}}{\\partial z} = \\frac{\\partial(-p)}{\\partial x} + \\frac{\\partial(\\mu\\gamma)}{\\partial y} + \\frac{\\partial(0)}{\\partial z}\n$$\n由于 $p$、$\\mu$ 和 $\\gamma$ 都是常数，它们的偏导数为零。因此：\n$$\n(\\nabla \\cdot \\boldsymbol{\\sigma})_x = 0 + 0 + 0 = 0\n$$\n$y$ 分量为：\n$$\n(\\nabla \\cdot \\boldsymbol{\\sigma})_y = \\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} + \\frac{\\partial \\sigma_{yz}}{\\partial z} = \\frac{\\partial(\\mu\\gamma)}{\\partial x} + \\frac{\\partial(-p)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = 0 + 0 + 0 = 0\n$$\n$z$ 分量为：\n$$\n(\\nabla \\cdot \\boldsymbol{\\sigma})_z = \\frac{\\partial \\sigma_{zx}}{\\partial x} + \\frac{\\partial \\sigma_{zy}}{\\partial y} + \\frac{\\partial \\sigma_{zz}}{\\partial z} = \\frac{\\partial(0)}{\\partial x} + \\frac{\\partial(0)}{\\partial y} + \\frac{\\partial(-p)}{\\partial z} = 0 + 0 + 0 = 0\n$$\n因此，应力张量的散度为 $\\nabla \\cdot \\boldsymbol{\\sigma} = (0, 0, 0) = \\mathbf{0}$。\n\n最后，我们组装残差向量 $\\mathbf{R}$：\n$$\n\\mathbf{R} = \\rho \\dot{\\mathbf{v}} - \\nabla \\cdot \\boldsymbol{\\sigma} - \\rho \\mathbf{b} = \\mathbf{0} - \\mathbf{0} - \\mathbf{0} = \\mathbf{0}\n$$\n残差向量为 $(0, 0, 0)$。以所要求的行矩阵格式表示，即为 $\\begin{pmatrix} 0 & 0 & 0 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "将连续介质力学方程转化为计算机可处理的离散形式，会带来一些在连续理论中并不明显的独特挑战。本问题探讨了计算流体动力学中一个最典型的问题：同位网格上的压力-速度解耦。通过分析不同的离散化策略，您将深入理解为何必须精心设计数值格式，以保持动量方程和不可压缩约束之间的物理耦合。",
            "id": "4081934",
            "problem": "考虑一个矩形域中密度为 $\\rho$、动力粘度为 $\\mu$ 的稳态、不可压缩、等温牛顿流体，无体力作用。其连续介质动量平衡由柯西运动方程给出，在此设定下简化为\n$$\n\\rho\\,\\left(\\mathbf{v}\\cdot\\nabla\\right)\\mathbf{v} \\;=\\; \\nabla\\cdot\\boldsymbol{\\sigma}, \\quad \\boldsymbol{\\sigma} \\;=\\; -\\,p\\,\\mathbf{I} \\;+\\; 2\\,\\mu\\,\\mathbf{D}, \\quad \\mathbf{D} \\;=\\; \\tfrac{1}{2}\\left(\\nabla\\mathbf{v} + \\nabla\\mathbf{v}^{\\top}\\right),\n$$\n以及不可压缩性约束\n$$\n\\nabla\\cdot\\mathbf{v} \\;=\\; 0.\n$$\n假设您在一个均匀的笛卡尔网格上对低雷诺数流动问题进行离散化。在同位网格（collocated arrangement）布置中，速度分量和压力都存储在单元中心。在给定单元中心的离散动量平衡方程使用中心差分近似梯度和扩散通量。为明确起见，在一维空间维度 $x$ 方向上，进入单元中心动量平衡方程的离散压力梯度使用中心差分\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i} \\;\\approx\\; \\frac{p_{i+1} - p_{i-1}}{2\\,\\Delta x},\n$$\n而离散连续性方程使用通过相邻单元中心速度的线性插值构造的面法向质量通量，即\n$$\nu_{i+\\tfrac{1}{2}} \\;\\approx\\; \\frac{u_{i} + u_{i+1}}{2}, \\quad u_{i-\\tfrac{1}{2}} \\;\\approx\\; \\frac{u_{i-1} + u_{i}}{2}.\n$$\n相比之下，在交错网格（staggered arrangement）布置中，压力存储在单元中心，而速度分量 $u$ 存储在位于 $x_{i+\\tfrac{1}{2}}$ 的垂直单元面上，进入 $u$-动量方程的离散压力梯度在面上近似为\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\tfrac{1}{2}} \\;\\approx\\; \\frac{p_{i+1} - p_{i}}{\\Delta x}.\n$$\n最后，考虑同位网格上的 Rhie–Chow 插值方法，其中用于连续性方程的面法向速度不是相邻单元中心速度的简单线性插值，而是根据相邻的离散动量方程构造的，使得一个压力差的贡献项出现在面上，该项由局部离散动量算子的对角线元素进行缩放，并且当 $\\Delta x \\to 0$ 时，对于线性变化的压力场，该项会消失。\n\n仅使用上述基础和近似，回答以下问题。您可以将对流项设置为零，以关注稳态斯托克斯（Stokes）极限下的压力-扩散平衡，并可以假设周期性边界条件，以使末端效应不占主导。下列哪些陈述是正确的？\n\nA. 在同位网格上，若单元中心的压力梯度使用中心差分，面速度使用线性插值，则形式为 $p_{i} \\,=\\, \\hat{p} \\,+\\, (-1)^{i}\\,\\delta$ 的交替单元中心压力场在每个单元中心产生一个消失的离散压力梯度，因此离散动量方程对压力不敏感，速度-压力耦合可能瓦解，从而允许伪棋盘状压力模式的出现。\n\nB. 在交错网格上，由于 $u$-速度存储在 $x$-方向的面上，并且 $u$-动量方程中的离散压力梯度在这些面上被计算为 $(p_{i+1}-p_{i})/\\Delta x$，因此相同的交替压力场 $p_{i} \\,=\\, \\hat{p} \\,+\\, (-1)^{i}\\,\\delta$ 不会使离散梯度为零，从而维持了一种耦合关系，抑制了动量-压力系统中的棋盘状零空间。\n\nC. 在同位网格上，Rhie–Chow 插值从相邻的离散动量方程构造用于连续性方程的面法向速度，使得一个与局部动量算子对角线逆的近似值成比例的压力差项乘以一个面中心的压力跳跃。这消除了奇偶解耦，并且是相容的，因为当 $\\Delta x \\to 0$ 时，对于线性变化的压力，该附加项会消失。\n\nD. 在同位网格上，向动量方程添加均匀的人工粘度 $\\nu_{\\text{art}}$ 可以消除压力棋盘格现象，而当 $\\Delta x \\to 0$ 时不会影响压力梯度项的精度，即使在对流项可忽略不计的情况下也是如此。\n\nE. 在同位网格上，对对流通量使用迎风离散格式可以保证在所有雷诺数下消除压力棋盘格现象，包括对流项可忽略不计的斯托克斯（Stokes）极限。\n\n选择所有适用项。您的选择中不需提供推导过程；您的推理应从柯西运动方程、不可压缩性约束和所述的离散化方法出发。",
            "solution": "该问题要求评估关于稳态、不可压缩、等温牛顿流体流动的数值解的几个陈述，特别关注压力-速度耦合和伪压力模式的问题。控制连续介质方程是柯西运动方程和不可压缩性约束。对于低雷诺数流动（斯托克斯流），这些方程简化为压力和粘性力之间的平衡，以及连续性方程：\n$$\n\\mathbf{0} \\;=\\; -\\nabla p \\;+\\; \\mu\\,\\nabla^2\\mathbf{v}\n$$\n$$\n\\nabla\\cdot\\mathbf{v} \\;=\\; 0\n$$\n探讨的核心问题是笛卡尔网格上的不同空间离散格式如何处理压力 $p$ 和速度 $\\mathbf{v}$ 之间的耦合。在某些网格上，一个常见的数值伪影是出现非物理的、高频的“棋盘状”压力场，而离散方程无法对其进行适当的抑制。我们根据所描述的离散格式分析每个陈述。\n\n### 选项 A 分析\n\n该选项涉及同位网格布置，其中速度和压力都存储在单元中心 ($i$)。离散压力梯度使用中心差分近似：$(\\frac{\\partial p}{\\partial x})_{i} \\approx \\frac{p_{i+1} - p_{i-1}}{2\\,\\Delta x}$。该陈述假设形式为 $p_i = \\hat{p} + (-1)^i\\,\\delta$ 的棋盘状压力场在每个单元产生一个消失的离散压力梯度。\n\n我们将此压力场代入单元中心 $i$ 的离散梯度公式中：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i} \\;\\approx\\; \\frac{p_{i+1} - p_{i-1}}{2\\,\\Delta x} \\;=\\; \\frac{\\left[\\hat{p} + (-1)^{i+1}\\,\\delta\\right] - \\left[\\hat{p} + (-1)^{i-1}\\,\\delta\\right]}{2\\,\\Delta x}\n$$\n我们可以提出因子 $(-1)^i$：\n$$\n(-1)^{i+1} \\;=\\; (-1)(-1)^i \\;=\\; -(-1)^i\n$$\n$$\n(-1)^{i-1} \\;=\\; (-1)^{-1}(-1)^i \\;=\\; -(-1)^i\n$$\n因此，$p_{i+1} = \\hat{p} - (-1)^i\\,\\delta$ 且 $p_{i-1} = \\hat{p} - (-1)^i\\,\\delta$。\n差值为：\n$$\np_{i+1} - p_{i-1} \\;=\\; \\left(\\hat{p} - (-1)^i\\,\\delta\\right) - \\left(\\hat{p} - (-1)^i\\,\\delta\\right) \\;=\\; 0\n$$\n因此，在每个单元中心 $i$，离散压力梯度都为零。结果，依赖于此梯度的离散动量方程对棋盘状压力分量完全不敏感。速度场由粘性项和边界条件决定，并且必须满足连续性方程，但该系统允许任意的棋盘状压力模式作为解的一部分存在而不会受到惩罚。这被称为奇偶解耦或压力棋盘格现象。\n\n该陈述正确描述了这种特定同位网格离散化的根本缺陷。\n\n**结论：正确。**\n\n### 选项 B 分析\n\n该选项描述了一种交错网格，其中压力位于单元中心 ($i$)，但速度的 $x$ 分量 $u$ 存储在垂直单元面 ($i+\\frac{1}{2}$) 上。进入 $u$-动量方程的离散压力梯度在这些面上使用更紧凑的差分进行评估：$(\\frac{\\partial p}{\\partial x})_{i+\\frac{1}{2}} \\approx \\frac{p_{i+1} - p_{i}}{\\Delta x}$。该陈述声称这种布置抑制了棋盘状模式。\n\n让我们将相同的棋盘状压力场 $p_i = \\hat{p} + (-1)^i\\,\\delta$ 代入这个交错网格的压力梯度公式中：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2}} \\;\\approx\\; \\frac{p_{i+1} - p_{i}}{\\Delta x} \\;=\\; \\frac{\\left[\\hat{p} + (-1)^{i+1}\\,\\delta\\right] - \\left[\\hat{p} + (-1)^{i}\\,\\delta\\right]}{\\Delta x}\n$$\n使用恒等式 $(-1)^{i+1} = -(-1)^i$，分子变为：\n$$\np_{i+1} - p_i \\;=\\; -(-1)^i\\,\\delta - (-1)^i\\,\\delta \\;=\\; -2(-1)^i\\,\\delta\n$$\n因此，离散压力梯度为：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2}} \\;\\approx\\; \\frac{-2(-1)^i\\,\\delta}{\\Delta x}\n$$\n这个结果非零。棋盘状压力场在速度所在的单元面上产生一个强烈的、振荡的压力梯度。这确保了速度场与相邻单元之间的压力差强耦合。因此，任何伪棋盘状压力模式都会立即被动量方程“感知”到，并被旨在同时满足动量和连续性方程的求解算法排除。交错网格布置自然地防止了在同位网格上看到的解耦现象。\n\n该陈述准确地描述了交错网格的修正行为。\n\n**结论：正确。**\n\n### 选项 C 分析\n\n该选项描述了同位网格上的 Rhie–Chow 插值方法。Rhie-Chow 的核心思想是在不采用完全交错网格的情况下解决选项 A 中的解耦问题。它修改了用于离散连续性方程的面速度的计算方式。面速度不是通过单元中心速度的简单线性插值（例如，$u_{i+\\frac{1}{2}} \\approx (u_i + u_{i+1})/2$）得到，而是利用相邻单元中心 $i$ 和 $i+1$ 的离散动量方程信息进行重构。\n\n这种重构引入了一个压力耗散项。面速度插值被修改为对高阶（解耦）压力梯度插值和低阶（耦合）压力梯度插值之间的差异敏感。具体来说，增加了一个项，该项与面上的紧凑压力梯度 $\\frac{p_{i+1}-p_i}{\\Delta x}$ 和插值的单元中心压力梯度 $\\frac{1}{2}\\left( (\\frac{\\partial p}{\\partial x})_i + (\\frac{\\partial p}{\\partial x})_{i+1} \\right)$ 之间的差值成正比。如选项 A 和 B 的分析所示，对于棋盘状模式，插值的单元中心梯度为零，而紧凑的面梯度非零。因此，对于棋盘状模式，Rhie-Chow 修正项非零，从而将相邻压力之间必要的耦合引入连续性方程（通过面通量），并消除了伪模式。\n\n该陈述也讨论了相容性。对于光滑解，附加项的构造使其在网格间距 $\\Delta x$ 上是更高阶的，或者更精确地说，对于完全线性的压力场，该项恰好为零。对于线性场 $p(x) = ax+b$，我们有 $(\\frac{\\partial p}{\\partial x})_i = a$ 和 $\\frac{p_{i+1}-p_i}{\\Delta x}=a$。修正项恒等于零。因此，该方法不会引入低阶误差，并且当 $\\Delta x \\to 0$ 时与原始方程相容。选项中的描述是对该方法目的和性质的忠实（尽管是定性的）总结。\n\n该陈述正确总结了 Rhie–Chow 插值的功能和相容性。\n\n**结论：正确。**\n\n### 选项 D 分析\n\n该陈述表明，在同位网格上添加均匀的人工粘度 $\\nu_{\\text{art}}$ 可以消除压力棋盘格现象。在斯托克斯极限下，添加这样一个项会将动量方程修改为 $0 = -\\nabla p + \\nabla\\cdot(2(\\mu+\\rho\\nu_{\\text{art}})\\mathbf{D})$。这改变了扩散项的系数。\n\n然而，棋盘格问题的根源不在于扩散项，而在于离散梯度算子 $(\\frac{\\partial p}{\\partial x})_i \\approx \\frac{p_{i+1} - p_{i-1}}{2\\,\\Delta x}$，其模板“跳过”相邻节点，使其对奇偶振荡不敏感。修改粘度不会改变压力梯度算子或其与速度的耦合方式。棋盘状压力场 $p_i = \\hat{p} + (-1)^i\\,\\delta$ 在每个单元中心的离散动量方程中仍然产生零压力梯度。根本的解耦问题完全不受影响。虽然人工粘度可以通过增加耗散来抑制其他类型的数值不稳定性，但它不能解决离散算子的这个特定结构性问题。\n\n该陈述对人工粘度在此问题上的效果做出了错误的断言。\n\n**结论：不正确。**\n\n### 选项 E 分析\n\n该陈述声称，对对流项 $\\rho(\\mathbf{v}\\cdot\\nabla)\\mathbf{v}$ 使用迎风离散格式可以消除压力棋盘格现象，即使在斯托克斯极限下也是如此。迎风格式是一种用于稳定对流项离散化的技术，通常通过引入数值扩散来实现。\n\n该陈述的关键部分是包含了斯托克斯极限，问题明确允许我们考虑这种情况。在斯托克斯极限下，雷诺数非常低，与压力项和粘性项相比，对流项可以忽略不计。它通常被完全设置为零，如我们最初的简化方程 $0 = -\\nabla p + \\mu\\nabla^2\\mathbf{v}$。如果对流项为零，那么其离散格式的选择（迎风、中心差分等）与最终的离散方程组完全无关。压力-速度解耦问题依然存在，因为它源于压力梯度和连续性方程的离散化，而这些不受对流格式选择的影响。\n\n即使对于非零但小的雷诺数，迎风格式的影响也非常小，而压力梯度算子中的结构性缺陷仍然占主导地位。因此，该陈述的主张是没有根据的。\n\n**结论：不正确。**",
            "answer": "$$\\boxed{ABC}$$"
        },
        {
            "introduction": "最后的动手实践将理论、数值方法和代码实现融为一体。您将从基本的柯西方程出发，首先推导出两种可混溶流体在不同粘度下并流的简化一维模型。接着，您将对该方程进行离散化，并编写代码求解速度剖面，从而将您的理论和数值知识付诸实践。",
            "id": "4081923",
            "problem": "考虑在高度为 $H$ 的平面通道中，由恒定的流向压力梯度 $\\frac{\\mathrm{d}p}{\\mathrm{d}x}$ 驱动的两种可混溶牛顿流体的稳定、完全发展的层流协同流动。设坐标 $y$ 从下壁面的 $y=0$ 到上壁面的 $y=H$。将流向速度表示为 $u(y)$，粘度分布表示为 $\\mu(y)$，由于流体是可混溶的，该粘度在界面混合区域内平滑变化。假设流体不可压缩、无体力、惯性可忽略，因此混合物的动量平衡直接遵循线性动量守恒（柯西运动方程），并采用点态的牛顿本构关系来描述应力。\n\n从基本原理出发，使用连续介质的线性动量守恒（由柯西运动方程表达），\n$$\n\\rho \\frac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\mathbf{b},\n$$\n以及牛顿流体的柯西应力张量，\n$$\n\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\mu \\mathbf{D}, \\quad \\mathbf{D} = \\frac{1}{2}\\left(\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^{\\top}\\right),\n$$\n来推导在所述假设和边界条件下 $u(y)$ 所满足的一维边值问题。在两个壁面上施加无滑移边界条件，$u(0)=0$ 和 $u(H)=0$，并且由于流体的可混溶性，速度在整个区域内是连续的。不要假设任何超出基本原理的已知或简化公式；相反，应展示从基本定律到待数值求解的常微分控制方程的逻辑一致的推导路径。\n\n使用一个以界面位置 $y_0$ 为中心、混合厚度为 $\\delta>0$ 的平滑 S 型函数 $s(y)$ 作为组分代理，来模拟可混溶流体对的粘度，\n$$\ns(y) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{y - y_0}{\\delta}\\right)\\right),\n$$\n并将粘度场定义为组分粘度 $\\mu_A$ 和 $\\mu_B$ 的线性混合，\n$$\n\\mu(y) = \\mu_A \\left(1 - s(y)\\right) + \\mu_B s(y).\n$$\n\n您的任务是：为微分算子\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left(\\mu(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right)\n$$\n在均匀网格 $y\\in[0,H]$ 上，根据上述 Dirichlet 边界条件，实现一个守恒的、二阶的有限体积或有限差分离散化；求解所得到的线性系统以获得 $u(y)$；并计算每个测试案例的面积平均速度\n$$\nU_{\\text{avg}} \\equiv \\frac{1}{H}\\int_0^H u(y)\\,\\mathrm{d}y\n$$\n（单位为 $\\mathrm{m/s}$）。为保证数值分辨率，在 $y$ 方向上使用至少 $N=401$ 个均匀分布的网格点。将最终答案以 $\\mathrm{m/s}$ 为单位，表示为浮点数。\n\n测试套件：\n- 案例 1 (正常情况): $H = 10^{-3}\\,\\mathrm{m}$, $\\frac{\\mathrm{d}p}{\\mathrm{d}x} = -10^{3}\\,\\mathrm{Pa/m}$, $\\mu_A = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\mu_B = 5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $y_0 = 0.6 H$, $\\delta = 2\\times 10^{-2} H$, $N=1001$。\n- 案例 2 (恒定粘度参考): $H = 10^{-3}\\,\\mathrm{m}$, $\\frac{\\mathrm{d}p}{\\mathrm{d}x} = -10^{3}\\,\\mathrm{Pa/m}$, $\\mu_A = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\mu_B = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $y_0 = 0.5 H$, $\\delta = 5\\times 10^{-2} H$, $N=801$。\n- 案例 3 (零压力梯度边界条件): $H = 10^{-3}\\,\\mathrm{m}$, $\\frac{\\mathrm{d}p}{\\mathrm{d}x} = 0\\,\\mathrm{Pa/m}$, $\\mu_A = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\mu_B = 5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $y_0 = 0.4 H$, $\\delta = 1\\times 10^{-2} H$, $N=601$。\n- 案例 4 (尖锐界面边缘情况): $H = 10^{-3}\\,\\mathrm{m}$, $\\frac{\\mathrm{d}p}{\\mathrm{d}x} = -10^{3}\\,\\mathrm{Pa/m}$, $\\mu_A = 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\mu_B = 2\\times 10^{-2}\\,\\mathrm{Pa\\cdot s}$, $y_0 = 0.7 H$, $\\delta = 10^{-6}\\,\\mathrm{m}$, $N=2001$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含 $\\left[U_{\\text{avg}}^{(1)}, U_{\\text{avg}}^{(2)}, U_{\\text{avg}}^{(3)}, U_{\\text{avg}}^{(4)}\\right]$ 的四个结果，形式为用方括号括起来的逗号分隔列表，例如 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$，其中每个 $\\text{result}_i$ 是一个以 $\\mathrm{m/s}$ 为单位的浮点数。",
            "solution": "用户提供的问题是计算流体动力学中一个适定的问题，要求推导并数值求解通道内压力驱动流的一维边值问题。该问题具有科学依据、内容完整且客观。我们将着手进行求解。\n\n解决方案包含两个主要部分：首先，从连续介质力学的基本原理推导特定的常微分控制方程（ODE）；其次，开发并实现一个数值方案来求解此 ODE 并计算所需的量。\n\n### 1. 控制方程的推导\n\n我们从连续介质的线性动量守恒定律（由柯西第一运动定律表达）开始：\n$$\n\\rho \\frac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\mathbf{b}\n$$\n此处，$\\rho$ 是流体密度，$\\mathbf{v}$ 是速度矢量，$\\frac{\\mathrm{D}}{\\mathrm{D}t} = \\frac{\\partial}{\\partial t} + \\mathbf{v} \\cdot \\nabla$ 是物质导数，$\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\mathbf{b}$ 是单位质量的体力。\n\n问题陈述了几个简化此通用方程的假设：\n- **稳定流**：所有时间导数均为零，因此 $\\frac{\\partial}{\\partial t} = 0$。\n- **忽略惯性**：左侧的整个惯性项被认为是可忽略的，即 $\\rho \\frac{\\mathrm{D}\\mathbf{v}}{\\mathrm{D}t} = \\mathbf{0}$。这是雷诺数非常低的流动（蠕动流或 Stokes 流）的特征。\n- **无体力**：$\\mathbf{b} = \\mathbf{0}$。\n\n应用这些假设，动量方程简化为应力平衡的表述：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}\n$$\n\n流体是牛顿流体，因此应力张量 $\\boldsymbol{\\sigma}$ 由下式给出：\n$$\n\\boldsymbol{\\sigma} = -p \\mathbf{I} + \\boldsymbol{\\tau} = -p \\mathbf{I} + 2 \\mu \\mathbf{D}\n$$\n其中 $p$ 是热力学压力，$\\mathbf{I}$ 是单位张量，$\\boldsymbol{\\tau}$ 是偏（或粘性）应力张量，$\\mu$ 是动力粘度，$\\mathbf{D}$ 是形变率张量（速度梯度的对称部分）：\n$$\n\\mathbf{D} = \\frac{1}{2}\\left(\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^{\\top}\\right)\n$$\n将应力张量表达式代入平衡方程得到：\n$$\n\\nabla \\cdot (-p \\mathbf{I} + 2 \\mu \\mathbf{D}) = -\\nabla p + \\nabla \\cdot (2 \\mu \\mathbf{D}) = \\mathbf{0}\n$$\n\n该流动是稳定、完全发展、单向的通道流。设流向为 $x$ 方向，壁面法向为 $y$ 方向。速度矢量为：\n$$\n\\mathbf{v} = (u(y), 0, 0)\n$$\n完全发展的假设意味着速度剖面在流向上不发生变化，因此 $u$ 仅是 $y$ 的函数。速度梯度张量 $\\nabla \\mathbf{v}$ 为：\n$$\n\\nabla \\mathbf{v} = \\begin{pmatrix} \\frac{\\partial u}{\\partial x} & \\frac{\\partial u}{\\partial y} & \\frac{\\partial u}{\\partial z} \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n形变率张量 $\\mathbf{D}$ 变为：\n$$\n\\mathbf{D} = \\frac{1}{2} \\left( \\begin{pmatrix} 0 & \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 \\\\ \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 \\\\ \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n粘性应力张量 $\\boldsymbol{\\tau} = 2 \\mu \\mathbf{D}$ 为：\n$$\n\\boldsymbol{\\tau} = \\mu(y) \\begin{pmatrix} 0 & \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 \\\\ \\frac{\\mathrm{d}u}{\\mathrm{d}y} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n唯一非零的分量是 $\\tau_{xy} = \\tau_{yx} = \\mu(y) \\frac{\\mathrm{d}u}{\\mathrm{d}y}$。\n\n现在我们以分量形式计算平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$：\n- **x-分量**：$\\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} + \\frac{\\partial \\sigma_{xz}}{\\partial z} = 0$\n  $$\n  -\\frac{\\partial p}{\\partial x} + \\frac{\\partial}{\\partial y} \\left(\\mu(y) \\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right) + 0 = 0 \\implies \\frac{\\mathrm{d}}{\\mathrm{d}y}\\left(\\mu(y) \\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right) = \\frac{\\partial p}{\\partial x}\n  $$\n- **y-分量**：$\\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} + \\frac{\\partial \\sigma_{yz}}{\\partial z} = 0$\n  $$\n  \\frac{\\partial}{\\partial x}\\left(\\mu(y) \\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right) - \\frac{\\partial p}{\\partial y} + 0 = 0\n  $$\n  由于 $u=u(y)$ 且 $\\mu=\\mu(y)$，项 $\\mu(y) \\frac{\\mathrm{d}u}{\\mathrm{d}y}$ 仅是 $y$ 的函数，因此其对 $x$ 的偏导数为零。这简化为 $\\frac{\\partial p}{\\partial y} = 0$。\n- **z-分量**：$\\frac{\\partial \\sigma_{zx}}{\\partial x} + \\frac{\\partial \\sigma_{zy}}{\\partial y} + \\frac{\\partial \\sigma_{zz}}{\\partial z} = 0 \\implies 0 + 0 - \\frac{\\partial p}{\\partial z} = 0 \\implies \\frac{\\partial p}{\\partial z} = 0$。\n\n从 y-分量和 z-分量方程中，我们发现压力 $p$ 不依赖于 $y$ 或 $z$。因此，$p$ 仅是 $x$ 的函数，$p = p(x)$。于是，x-分量方程中的偏导数 $\\frac{\\partial p}{\\partial x}$ 可以写成全导数 $\\frac{\\mathrm{d}p}{\\mathrm{d}x}$。问题陈述此为一个常数。令 $G = \\frac{\\mathrm{d}p}{\\mathrm{d}x}$。\n\n速度剖面 $u(y)$ 的最终一维常微分控制方程为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}y}\\left(\\mu(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right) = G\n$$\n该方程受制于壁面上的无滑移边界条件：\n$$\nu(0) = 0 \\quad \\text{和} \\quad u(H) = 0\n$$\n\n### 2. 数值方法\n\n我们将使用守恒的有限体积法在均匀网格上求解该边值问题。区域 $y \\in [0, H]$ 被离散化为 $N$ 个点，$y_i = i \\Delta y$，其中 $i = 0, 1, \\dots, N-1$，网格间距为 $\\Delta y = H/(N-1)$。令 $u_i = u(y_i)$ 为节点 $i$ 处的速度。\n\n我们将控制方程在一个以内节点 $y_i$ 为中心的控制体积（或单元）上进行积分，该控制体积从 $y_{i-1/2} = y_i - \\Delta y/2$ 延伸到 $y_{i+1/2} = y_i + \\Delta y/2$。\n$$\n\\int_{y_{i-1/2}}^{y_{i+1/2}} \\frac{\\mathrm{d}}{\\mathrm{d}y}\\left(\\mu(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right) \\mathrm{d}y = \\int_{y_{i-1/2}}^{y_{i+1/2}} G \\, \\mathrm{d}y\n$$\n对左侧应用微积分基本定理，并计算右侧常数 $G$ 的积分，得到：\n$$\n\\left[\\mu(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right]_{y_{i+1/2}} - \\left[\\mu(y)\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right]_{y_{i-1/2}} = G \\Delta y\n$$\n这个表达式是精确的，并确保了动量通量的守恒。我们现在使用二阶中心差分来近似导数，并使用算术平均值来近似粘度，以计算单元面（半点）上的项：\n- 在面 $y_{i+1/2}$ 处：$\\left[\\mu\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right]_{i+1/2} \\approx \\mu_{i+1/2} \\left(\\frac{u_{i+1} - u_i}{\\Delta y}\\right)$，其中 $\\mu_{i+1/2} = \\frac{\\mu(y_i) + \\mu(y_{i+1})}{2} = \\frac{\\mu_i + \\mu_{i+1}}{2}$。\n- 在面 $y_{i-1/2}$ 处：$\\left[\\mu\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\right]_{i-1/2} \\approx \\mu_{i-1/2} \\left(\\frac{u_i - u_{i-1}}{\\Delta y}\\right)$，其中 $\\mu_{i-1/2} = \\frac{\\mu(y_{i-1}) + \\mu(y_i)}{2} = \\frac{\\mu_{i-1} + \\mu_i}{2}$。\n\n将这些近似值代回积分方程，得到每个内节点 $i = 1, 2, \\ldots, N-2$ 的线性代数方程：\n$$\n\\mu_{i+1/2} \\left(\\frac{u_{i+1} - u_i}{\\Delta y}\\right) - \\mu_{i-1/2} \\left(\\frac{u_i - u_{i-1}}{\\Delta y}\\right) = G \\Delta y\n$$\n重新排列各项，将未知数 $u_{i-1}, u_i, u_{i+1}$ 组合在一起：\n$$\n\\mu_{i-1/2} u_{i-1} - (\\mu_{i-1/2} + \\mu_{i+1/2}) u_i + \\mu_{i+1/2} u_{i+1} = G (\\Delta y)^2\n$$\n这组包含 $N-2$ 个线性方程和 $N-2$ 个未知内部速度（$u_1, \\dots, u_{N-2}$）的方程组构成了一个三对角系统 $A\\mathbf{u} = \\mathbf{b}$。边界条件 $u_0=0$ 和 $u_{N-1}=0$ 通过修改 $i=1$ 和 $i=N-2$ 的方程来并入，其中涉及 $u_0$ 和 $u_{N-1}$ 的项被移到右侧（在此情况下为零）。这个系统可以使用三对角矩阵算法高效求解。\n\n### 3. 平均速度的计算\n\n在求解线性系统得到内部速度 $u_i$ 后，我们得到了完整的离散速度剖面 $[u_0, u_1, \\dots, u_{N-1}]$。面积平均速度 $U_{\\text{avg}}$ 定义为：\n$$\nU_{\\text{avg}} = \\frac{1}{H}\\int_0^H u(y)\\,\\mathrm{d}y\n$$\n我们使用梯形法则对该积分进行数值近似，该方法是二阶精确的，并与我们的离散化方案一致：\n$$\n\\int_0^H u(y)\\,\\mathrm{d}y \\approx \\Delta y \\left( \\frac{u_0 + u_{N-1}}{2} + \\sum_{i=1}^{N-2} u_i \\right)\n$$\n由于 $u_0 = u_{N-1} = 0$，这可以简化为：\n$$\nU_{\\text{avg}} \\approx \\frac{\\Delta y}{H} \\sum_{i=1}^{N-2} u_i\n$$\n实现将使用 `numpy.trapz` 以确保稳健性和清晰性。代码将遍历提供的测试案例，对每个案例执行这些计算，然后按要求格式化结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Derives and solves the 1D BVP for pressure-driven co-flow of two miscible fluids\n    in a planar channel, then computes the area-averaged velocity.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1: normal case\n        {'H': 1e-3, 'dpdx': -1e3, 'mu_A': 1e-3, 'mu_B': 5e-3, 'y0_factor': 0.6, 'delta_factor': 2e-2, 'N': 1001},\n        # Case 2: constant viscosity reference\n        {'H': 1e-3, 'dpdx': -1e3, 'mu_A': 1e-3, 'mu_B': 1e-3, 'y0_factor': 0.5, 'delta_factor': 5e-2, 'N': 801},\n        # Case 3: zero pressure gradient\n        {'H': 1e-3, 'dpdx': 0,    'mu_A': 1e-3, 'mu_B': 5e-3, 'y0_factor': 0.4, 'delta_factor': 1e-2, 'N': 601},\n        # Case 4: sharp interface edge case\n        {'H': 1e-3, 'dpdx': -1e3, 'mu_A': 1e-3, 'mu_B': 2e-2, 'y0_factor': 0.7, 'delta': 1e-6, 'N': 2001},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        H = case['H']\n        G = case['dpdx']\n        mu_A = case['mu_A']\n        mu_B = case['mu_B']\n        N = case['N']\n        y0 = case['y0_factor'] * H if 'y0_factor' in case else case['y0']\n        delta = case['delta_factor'] * H if 'delta_factor' in case else case['delta']\n\n        # 1. Set up the grid\n        y = np.linspace(0, H, N)\n        dy = H / (N - 1)\n\n        # 2. Define the viscosity profile mu(y)\n        s_y = 0.5 * (1 + np.tanh((y - y0) / delta))\n        mu_y = mu_A * (1 - s_y) + mu_B * s_y\n\n        # Handle the trivial case of zero pressure gradient\n        if G == 0:\n            results.append(0.0)\n            continue\n            \n        # 3. Set up the tridiagonal linear system Au = b for interior points\n        # The number of interior points (and unknowns) is M = N - 2.\n        M = N - 2\n        \n        # Calculate viscosity at cell faces (half-points) using arithmetic mean\n        mu_half = (mu_y[:-1] + mu_y[1:]) / 2.0\n        \n        # Main diagonal of matrix A\n        d_main = -(mu_half[:-1] + mu_half[1:])\n        \n        # Lower diagonal of matrix A\n        d_lower = mu_half[:-2] \n        \n        # Upper diagonal of matrix A\n        d_upper = mu_half[1:-1]\n        \n        # Assemble the matrix `ab` for `solve_banded`\n        # ab[0,:] = upper diagonal (padded at start)\n        # ab[1,:] = main diagonal\n        # ab[2,:] = lower diagonal (padded at end)\n        ab = np.zeros((3, M))\n        ab[0, 1:] = d_upper\n        ab[1, :] = d_main\n        ab[2, :-1] = d_lower\n\n        # Right-hand side vector b\n        b_rhs = np.full(M, G * dy**2)\n        \n        # 4. Solve the linear system for interior velocities\n        u_interior = solve_banded((1, 1), ab, b_rhs)\n        \n        # Reconstruct the full velocity profile with boundary conditions u(0)=0, u(H)=0\n        u_full = np.concatenate(([0.0], u_interior, [0.0]))\n        \n        # 5. Compute the area-averaged velocity using the trapezoidal rule\n        U_avg = np.trapz(u_full, y) / H\n        results.append(U_avg)\n        \n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}