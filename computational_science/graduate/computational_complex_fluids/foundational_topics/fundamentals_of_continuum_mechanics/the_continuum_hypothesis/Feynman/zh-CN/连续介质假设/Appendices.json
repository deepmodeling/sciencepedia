{
    "hands_on_practices": [
        {
            "introduction": "连续介质假设假定物质是无限可分的，这一假设在系统尺寸远大于微观长度尺度时是有效的。本练习将探讨该假设在气体动力学中的适用边界。通过计算努森数（$Kn$），即气体分子平均自由程与系统特征长度之比，你将学会如何定量判断气体流动是否可以被视为连续介质，以及何时必须考虑稀薄效应（如速度滑移）。",
            "id": "3951254",
            "problem": "一项航空航天微流控实验研究了在 $T=300\\,\\mathrm{K}$ 和 $p=1\\,\\mathrm{atm}$ 条件下，空气通过一个特征长度为 $L=1\\,\\mathrm{mm}$ 的长矩形微通道的稳态等温流动，其排列方式使得流动在远离入口处达到充分发展。在这些条件下，空气的分子平均自由程估计为 $\\lambda \\approx 65\\,\\mathrm{nm}$。在计算流体力学 (CFD) 中使用的连续介质假设框架下，无滑移边界条件的适用性以及滑移流修正的潜在需求，是通过使用克努森数来评估的，该数比较了分子平均自由程与宏观长度尺度。\n\n从克努森数的核心定义以及气体动力学和分子动理论中使用的流态分类出发，计算此配置下的克努森数，并基于第一性原理，确定是否需要滑移流边界条件修正。在你的推导中，通过引用基于分子动理论的标准阈值来证明你的流态评估。\n\n说明：\n- 使用给定数据计算克努森数。\n- 在你的论证中提供流态评估及其对滑移流修正的意义。\n- 为便于评分，请仅在最终答案框中提供克努森数的数值。\n- 将你的克努森数四舍五入到四位有效数字。\n- 将最终答案表示为无量纲量（无单位）。",
            "solution": "该问题要求计算特定微流控流动配置的克努森数，并随后评估流态以确定是否需要滑移流边界条件。对问题陈述的验证证实了其具有科学依据、问题提法恰当，并包含获得唯一解所需的所有信息。\n\n分析始于克努森数的基本定义，记为 $Kn$。克努森数是一个无量纲量，用于量化气体的稀薄程度。它被定义为分子平均自由程 $\\lambda$ 与物理系统的宏观特征长度尺度 $L$ 之比。数学上，这表示为：\n$$Kn = \\frac{\\lambda}{L}$$\n在此方程中，$\\lambda$ 代表分子在与其他分子连续碰撞之间行进的平均距离，而 $L$ 代表表征流动区域几何形状（如通道高度或直径）的长度尺度。\n\n问题提供了以下数值：\n- 在给定条件下空气的分子平均自由程：$\\lambda \\approx 65\\,\\mathrm{nm}$。\n- 微通道的特征长度：$L = 1\\,\\mathrm{mm}$。\n\n为了计算克努森数，两个长度尺度必须用一致的单位表示。我们将两者都转换为米 ($\\mathrm{m}$)。\n平均自由程为 $\\lambda = 65\\,\\mathrm{nm}$。由于 $1\\,\\mathrm{nm} = 10^{-9}\\,\\mathrm{m}$，我们有：\n$$\\lambda = 65 \\times 10^{-9}\\,\\mathrm{m}$$\n特征长度为 $L = 1\\,\\mathrm{mm}$。由于 $1\\,\\mathrm{mm} = 10^{-3}\\,\\mathrm{m}$，我们有：\n$$L = 1 \\times 10^{-3}\\,\\mathrm{m}$$\n\n将这些值代入克努森数的定义中，得到：\n$$Kn = \\frac{65 \\times 10^{-9}\\,\\mathrm{m}}{1 \\times 10^{-3}\\,\\mathrm{m}} = 65 \\times 10^{-6} = 0.000065$$\n问题要求结果四舍五入到四位有效数字。因此，计算出的克努森数为：\n$$Kn = 0.00006500 = 6.500 \\times 10^{-5}$$\n正如预期的，该值为无量纲量。\n\n下一步是基于此 $Kn$ 值评估流态。在气体动力学和分子动理论中，克努森数的值用于对流动进行分类并确定适当的物理模型。标准分类如下：\n- **连续流区** ($Kn \\lesssim 0.001$)：在此流区，分子间碰撞的频率远高于分子与表面的碰撞。气体表现为连续介质，其运动可以通过带有无滑移边界条件的纳维-斯托克斯方程精确描述。无滑移条件假设紧邻固体表面的流体层相对于该表面的速度为零。\n- **滑移流区** ($0.001 \\lesssim Kn \\lesssim 0.1$)：当平均自由程成为特征长度不可忽略的一部分时，连续介质假设在固体边界附近开始失效。气体不再“粘附”于表面，并发生速度滑移。纳维-斯托克斯方程仍然可用，但必须补充滑移流边界条件以考虑此效应。\n- **过渡流区** ($0.1 \\lesssim Kn \\lesssim 10$)：在此流区，分子间碰撞和分子与表面碰撞的频率相当。纳维-斯托克斯方程不再有效，需要更复杂的模型，如玻尔兹曼方程或直接模拟蒙特卡洛 (DSMC) 方法。\n- **自由分子流区** ($Kn \\gtrsim 10$)：与分子与表面碰撞相比，分子间碰撞可以忽略不计。分子在与区域边界相互作用之间沿直线运动。\n\n我们计算出的克努森数为 $Kn = 6.500 \\times 10^{-5}$。将此值与既定阈值进行比较：\n$$6.500 \\times 10^{-5}  0.001$$\n该克努森数显著小于滑移流区的下限。因此，流动深处于连续流区内。\n\n**结论：**\n基于计算出的克努森数 $Kn = 6.500 \\times 10^{-5}$，该流动被分类为连续流区。在此流区中，将流体视为连续介质的基本假设是有效的。因此，在计算流体力学 (CFD) 模拟中，标准的无滑移边界条件适用于对此流动进行建模。无需进行滑移流边界条件修正。关于流动的稳态、等温和充分发展性质的附加信息，以及温度 ($T=300\\,\\mathrm{K}$) 和压力 ($p=1\\,\\mathrm{atm}$)，是为了为给定的平均自由程值建立一个现实的物理背景，但并不改变核心计算和流态评估。",
            "answer": "$$\\boxed{6.500 \\times 10^{-5}}$$"
        },
        {
            "introduction": "连续介质假设依赖于在“代表性单元体积”（Representative Elementary Volume, REV）上对微观属性进行平均，从而定义宏观场。但一个体积怎样才算“具有代表性”？本练习将深入探讨REV的统计力学基础，要求你推导出一个最小体积，以确保测量的物理量（如粒子数密度）的涨落保持在预设的容差之下。 通过这个练习，你将深刻理解连续介质场不仅仅是简单的平均值，更是具有内在涨落的统计构造，而这种涨落必须得到有效控制。",
            "id": "4106329",
            "problem": "一种单分散胶体悬浮液由悬浮在牛顿溶剂中的半径为 $a$ 的球形颗粒组成。通过空间平均来定义局部场时，我们援引了连续介质假设。考虑微观粒子数密度场 $\\hat{n}(\\boldsymbol{x})=\\sum_{i}\\delta(\\boldsymbol{x}-\\boldsymbol{x}_{i})$，其中 $\\boldsymbol{x}_{i}$ 是粒子中心的位置。将紧致区域 $\\Omega$（体积为 $V$）上的空间平均数密度定义为 $\\bar{n}_{V}=\\frac{1}{V}\\int_{\\Omega}\\hat{n}(\\boldsymbol{x})\\,\\mathrm{d}^{3}\\boldsymbol{x}=\\frac{N_{V}}{V}$，其中 $N_{V}$ 是 $\\Omega$ 内的粒子中心数量。假设粒子中心的点过程是平稳遍历的，平均数密度为 $n$，且存在一个对相关函数 $g(r)$，其相关长度 $\\ell_{c}$ 有限，使得积分 $V_{c}=\\int_{\\mathbb{R}^{3}}\\left[g(r)-1\\right]\\,\\mathrm{d}^{3}\\boldsymbol{r}$ 存在并满足 $ \\frac{1}{n}+V_{c}0$。对于大的平均体积 $V\\gg \\ell_{c}^{3}$，代表性单元体积 (REV) 定义为能使 $\\bar{n}_{V}$ 的相对标准差被一给定容差 $\\epsilon$ 所限制的最小体积 $V$，即 $\\frac{\\sqrt{\\mathrm{Var}(\\bar{n}_{V})}}{n}\\le \\epsilon$。\n\n仅从上述定义、点过程的平稳性以及平稳点过程的标准二阶统计特性出发，推导在 $V\\gg \\ell_{c}^{3}$ 条件下，为满足 $\\frac{\\sqrt{\\mathrm{Var}(\\bar{n}_{V})}}{n}\\le \\epsilon$ 所需的最小 REV 尺寸 $V_{\\min}$ 的显式渐近表达式。请用一个包含 $n$、$V_{c}$ 和 $\\epsilon$ 的单解析闭式表达式来表示 $V_{\\min}$ 的最终答案，单位为立方米。除 $V_{c}$ 存在外，不要对 $g(r)$ 的任何具体形式做出假设。最终答案必须是一个单一的解析表达式。",
            "solution": "所述问题具有科学依据，内容自洽，且提法恰当。所有定义和条件在无序系统的统计力学和均匀化理论中都是标准的。因此，该问题是有效的，我们可以进行推导。\n\n目标是求出满足空间平均数密度 $\\bar{n}_{V}$ 相对标准差容差条件的最小代表性单元体积，记为 $V_{\\min}$。该条件为：\n$$\n\\frac{\\sqrt{\\mathrm{Var}(\\bar{n}_{V})}}{n} \\le \\epsilon\n$$\n其中 $n$ 是平均数密度，$\\epsilon$ 是给定的容差。最小体积 $V_{\\min}$ 将对应于等式成立的情况：\n$$\n\\frac{\\mathrm{Var}(\\bar{n}_{V_{\\min}})}{n^2} = \\epsilon^2\n$$\n\n我们的第一步是推导空间平均数密度方差 $\\mathrm{Var}(\\bar{n}_{V})$ 的表达式。空间平均数密度 $\\bar{n}_{V}$ 定义为体积为 $V$ 的紧致区域 $\\Omega$ 内的粒子中心总数 $N_{V}$ 除以体积 $V$：\n$$\n\\bar{n}_{V} = \\frac{N_{V}}{V}\n$$\n因此，$\\bar{n}_{V}$ 的方差与 $N_{V}$ 的方差关系如下：\n$$\n\\mathrm{Var}(\\bar{n}_{V}) = \\mathrm{Var}\\left(\\frac{N_{V}}{V}\\right) = \\frac{1}{V^2}\\mathrm{Var}(N_{V})\n$$\n根据定义，$N_V$ 的方差为 $\\mathrm{Var}(N_V) = \\langle N_V^2 \\rangle - \\langle N_V \\rangle^2$，其中 $\\langle \\cdot \\rangle$ 表示系综平均。\n\n体积 $V$ 内的粒子数 $N_V$ 可以表示为微观粒子数密度场 $\\hat{n}(\\boldsymbol{x}) = \\sum_{i}\\delta(\\boldsymbol{x}-\\boldsymbol{x}_{i})$ 在区域 $\\Omega$ 上的积分：\n$$\nN_V = \\int_{\\Omega} \\hat{n}(\\boldsymbol{x})\\,\\mathrm{d}^{3}\\boldsymbol{x}\n$$\n平均粒子数 $\\langle N_V \\rangle$ 可通过对此积分取期望得到。由于点过程是平稳的，平均密度为常数，$\\langle \\hat{n}(\\boldsymbol{x}) \\rangle = n$。\n$$\n\\langle N_V \\rangle = \\left\\langle \\int_{\\Omega} \\hat{n}(\\boldsymbol{x})\\,\\mathrm{d}^{3}\\boldsymbol{x} \\right\\rangle = \\int_{\\Omega} \\langle \\hat{n}(\\boldsymbol{x}) \\rangle \\,\\mathrm{d}^{3}\\boldsymbol{x} = \\int_{\\Omega} n \\,\\mathrm{d}^{3}\\boldsymbol{x} = nV\n$$\n\n接下来，我们计算二阶矩 $\\langle N_V^2 \\rangle$：\n$$\n\\langle N_V^2 \\rangle = \\left\\langle \\left( \\int_{\\Omega} \\hat{n}(\\boldsymbol{x})\\,\\mathrm{d}^{3}\\boldsymbol{x} \\right) \\left( \\int_{\\Omega} \\hat{n}(\\boldsymbol{x}')\\,\\mathrm{d}^{3}\\boldsymbol{x}' \\right) \\right\\rangle = \\int_{\\Omega} \\int_{\\Omega} \\langle \\hat{n}(\\boldsymbol{x})\\hat{n}(\\boldsymbol{x}') \\rangle \\,\\mathrm{d}^{3}\\boldsymbol{x}\\,\\mathrm{d}^{3}\\boldsymbol{x}'\n$$\n对于一个平稳点过程，两点相关函数 $\\langle \\hat{n}(\\boldsymbol{x})\\hat{n}(\\boldsymbol{x}') \\rangle$ 仅依赖于分离矢量 $\\boldsymbol{r} = \\boldsymbol{x} - \\boldsymbol{x}'$。它通过以下标准关系式与对相关函数 $g(r)$ 相关联，其中 $r=|\\boldsymbol{r}|$：\n$$\n\\langle \\hat{n}(\\boldsymbol{x})\\hat{n}(\\boldsymbol{x}') \\rangle = n\\delta(\\boldsymbol{x}-\\boldsymbol{x}') + n^2 g(|\\boldsymbol{x}-\\boldsymbol{x}'|)\n$$\n第一项 $n\\delta(\\boldsymbol{x}-\\boldsymbol{x}')$ 解释了自相关（当 $\\boldsymbol{x}$ 和 $\\boldsymbol{x}'$ 探测到同一个粒子时），第二项 $n^2 g(|\\boldsymbol{x}-\\boldsymbol{x}'|)$ 解释了不同粒子之间的相关性。\n\n将此式代入 $\\langle N_V^2 \\rangle$ 的表达式中：\n$$\n\\langle N_V^2 \\rangle = \\int_{\\Omega} \\int_{\\Omega} \\left[ n\\delta(\\boldsymbol{x}-\\boldsymbol{x}') + n^2 g(|\\boldsymbol{x}-\\boldsymbol{x}'|) \\right] \\,\\mathrm{d}^{3}\\boldsymbol{x}\\,\\mathrm{d}^{3}\\boldsymbol{x}'\n$$\n我们分别计算这两项。第一项得出：\n$$\n\\int_{\\Omega} \\int_{\\Omega} n\\delta(\\boldsymbol{x}-\\boldsymbol{x}') \\,\\mathrm{d}^{3}\\boldsymbol{x}\\,\\mathrm{d}^{3}\\boldsymbol{x}' = \\int_{\\Omega} n \\,\\mathrm{d}^{3}\\boldsymbol{x} = nV\n$$\n第二项是 $n^2 \\int_{\\Omega} \\int_{\\Omega} g(|\\boldsymbol{x}-\\boldsymbol{x}'|) \\,\\mathrm{d}^{3}\\boldsymbol{x}\\,\\mathrm{d}^{3}\\boldsymbol{x}'$。因此，我们有：\n$$\n\\langle N_V^2 \\rangle = nV + n^2 \\int_{\\Omega} \\int_{\\Omega} g(|\\boldsymbol{x}-\\boldsymbol{x}'|) \\,\\mathrm{d}^{3}\\boldsymbol{x}\\,\\mathrm{d}^{3}\\boldsymbol{x}'\n$$\n\n现在我们可以写出 $N_V$ 的方差：\n$$\n\\mathrm{Var}(N_V) = \\langle N_V^2 \\rangle - \\langle N_V \\rangle^2 = \\left( nV + n^2 \\int_{\\Omega} \\int_{\\Omega} g(|\\boldsymbol{x}-\\boldsymbol{x}'|) \\,\\mathrm{d}^{3}\\boldsymbol{x}\\,\\mathrm{d}^{3}\\boldsymbol{x}' \\right) - (nV)^2\n$$\n由于 $(nV)^2 = n^2 V^2 = n^2 \\int_{\\Omega} \\int_{\\Omega} 1 \\,\\mathrm{d}^{3}\\boldsymbol{x}\\,\\mathrm{d}^{3}\\boldsymbol{x}'$，我们可以合并积分：\n$$\n\\mathrm{Var}(N_V) = nV + n^2 \\int_{\\Omega} \\int_{\\Omega} \\left[ g(|\\boldsymbol{x}-\\boldsymbol{x}'|) - 1 \\right] \\,\\mathrm{d}^{3}\\boldsymbol{x}\\,\\mathrm{d}^{3}\\boldsymbol{x}'\n$$\n问题陈述中我们处于大平均体积极限下，$V \\gg \\ell_c^3$，其中 $\\ell_c$ 是相关长度。当 $r > \\ell_c$ 时，项 $g(r)-1$ 衰减至零。我们可以通过变量替换 $\\boldsymbol{r} = \\boldsymbol{x}-\\boldsymbol{x}'$ 和 $\\boldsymbol{R} = \\boldsymbol{x}'$ 来简化二重积分。对于一个深处于体积 $\\Omega$ 内部的点 $\\boldsymbol{x}'$（即其到边界 $\\partial\\Omega$ 的距离远大于 $\\ell_c$），对 $\\boldsymbol{x}$ 的积分实际上是对整个空间的积分，因为在 $\\boldsymbol{x}$ 到达 $\\Omega$ 边界之前，$g(|\\boldsymbol{x}-\\boldsymbol{x}'|) - 1$ 已经消失。\n因此，在渐近极限 $V \\to \\infty$ 下，积分简化为：\n$$\n\\int_{\\Omega} \\int_{\\Omega} \\left[ g(|\\boldsymbol{x}-\\boldsymbol{x}'|) - 1 \\right] \\,\\mathrm{d}^{3}\\boldsymbol{x}\\,\\mathrm{d}^{3}\\boldsymbol{x}' \\approx \\int_{\\Omega} \\left( \\int_{\\mathbb{R}^3} [g(r)-1] \\,\\mathrm{d}^{3}\\boldsymbol{r} \\right) \\,\\mathrm{d}^{3}\\boldsymbol{x}'\n$$\n内部积分恰好是问题陈述中给出的 $V_c$ 的定义。\n$$\n\\int_{\\mathbb{R}^3} [g(r)-1] \\,\\mathrm{d}^{3}\\boldsymbol{r} = V_c\n$$\n那么，剩下的积分是：\n$$\n\\int_{\\Omega} V_c \\,\\mathrm{d}^{3}\\boldsymbol{x}' = V_c \\int_{\\Omega} \\,\\mathrm{d}^{3}\\boldsymbol{x}' = V_c V\n$$\n这个近似忽略了边界效应，它在 $V$ 中是低阶项。$N_V$ 方差的渐近表达式为：\n$$\n\\mathrm{Var}(N_V) \\approx nV + n^2 (V_c V) = nV(1 + nV_c)\n$$\n给定的条件 $\\frac{1}{n}+V_c > 0$ 确保了 $1+nV_c > 0$，从而保证方差为正，这是物理稳定系统所要求的。\n\n现在我们可以求出平均数密度 $\\bar{n}_V$ 的方差：\n$$\n\\mathrm{Var}(\\bar{n}_V) = \\frac{\\mathrm{Var}(N_V)}{V^2} \\approx \\frac{nV(1 + nV_c)}{V^2} = \\frac{n(1 + nV_c)}{V}\n$$\n我们将其代入 REV 容差条件：\n$$\n\\frac{\\mathrm{Var}(\\bar{n}_{V})}{n^2} \\le \\epsilon^2\n$$\n$$\n\\frac{n(1 + nV_c)}{V n^2} \\le \\epsilon^2 \\implies \\frac{1 + nV_c}{nV} \\le \\epsilon^2\n$$\n为了找到满足此条件的最小体积 $V_{\\min}$，我们求解等式成立时的 $V$：\n$$\n\\frac{1 + nV_c}{nV_{\\min}} = \\epsilon^2\n$$\n解出 $V_{\\min}$ 得到最终表达式：\n$$\nV_{\\min} = \\frac{1 + nV_c}{n\\epsilon^2}\n$$\n此表达式给出了所需的最小 REV 尺寸，它是平均密度 $n$、积分相关体积 $V_c$ 和容差 $\\epsilon$ 的函数。表达式的量纲是一致的：$n$ 的量纲是 $[\\text{长度}]^{-3}$，$V_c$ 的量纲是 $[\\text{长度}]^{3}$，而 $\\epsilon$ 是无量纲的。因此，$V_{\\min}$ 的量纲是 $[\\text{长度}]^{3}$，即一个体积。如果输入使用国际单位制基本单位，则结果的单位将是立方米。",
            "answer": "$$\n\\boxed{\\frac{1 + nV_{c}}{n\\epsilon^{2}}}\n$$"
        },
        {
            "introduction": "在实践中，我们如何从离散的、基于粒子的物质描述过渡到光滑的连续场描述？这个编程练习将使“粗粒化”这一抽象概念变得具体可感。你将亲手实现一个基本过程：通过将离散粒子数据与一个平滑核函数进行卷积，来生成连续的密度场和动量场。 通过改变核函数的宽度，你将直接观察并量化平均长度尺度如何控制最终连续场的平滑度，从而架起抽象理论与计算实践之间的桥梁。",
            "id": "2922844",
            "problem": "给定一个二维域中的离散点粒子集合，该集合符合材料力学中的连续介质假设：宏观场是通过平滑核函数对微观组分进行粗粒化平均得到的。您必须从基本守恒原理和定义出发，通过将离散粒子数据与宽度参数为 $\\eta$ 的归一化高斯核函数进行卷积，在均匀网格上构建粗粒化质量密度场和粗粒化线动量密度场，然后量化这些场在 $\\eta$ 变化时的光滑度。\n\n定义与建模假设：\n- 空间域为单位正方形 $\\Omega = [0,1]\\times[0,1]$，作无量纲处理，因此所有量均为无量纲。\n- 对于核函数宽度 $\\eta0$，在位置 $\\mathbf{x}\\in \\Omega$ 处的粗粒化质量密度场定义为\n$$\n\\rho_{\\eta}(\\mathbf{x}) \\equiv \\sum_{p=1}^{P} m_p \\, W_{\\eta}(\\mathbf{x}-\\mathbf{x}_p),\n$$\n其中 $m_p$ 和 $\\mathbf{x}_p$ 分别是粒子 $p$ 的质量和位置，而 $W_{\\eta}$ 是二维空间中的归一化高斯核函数，\n$$\nW_{\\eta}(\\mathbf{r}) \\equiv \\frac{1}{2\\pi \\eta^2}\\,\\exp\\!\\left(-\\frac{\\|\\mathbf{r}\\|^2}{2\\eta^2}\\right).\n$$\n- 粗粒化线动量密度场定义为\n$$\n\\mathbf{g}_{\\eta}(\\mathbf{x}) \\equiv \\sum_{p=1}^{P} m_p \\,\\mathbf{v}_p \\, W_{\\eta}(\\mathbf{x}-\\mathbf{x}_p),\n$$\n其中 $\\mathbf{v}_p$ 是粒子速度。注意 $\\mathbf{g}_{\\eta}$ 是一个在平面内具有两个分量的矢量场。\n\n为使计算显式、可测试和可复现而进行的离散化：\n- 在 $\\Omega$ 上使用一个每个方向有 $N$ 个点的均匀笛卡尔网格，坐标为 $x_i = i\\,h$ 和 $y_j = j\\,h$，其中 $i,j\\in\\{0,1,\\dots,N-1\\}$，$h\\equiv 1/(N-1)$。\n- 使用所述的 $W_{\\eta}$，通过对所有粒子直接求和，在所有网格节点 $(x_i,y_j)$ 上计算 $\\rho_{\\eta}$ 和 $\\mathbf{g}_{\\eta}$。\n- 对于标量网格场 $f$，通过量纲一致、归一化的离散狄利克雷-能量比来定义离散粗糙度（光滑度的倒数）\n$$\n\\mathcal{R}[f] \\equiv \\frac{\\sqrt{\\sum_{i=0}^{N-2}\\sum_{j=0}^{N-1}\\left(\\frac{f_{i+1,j}-f_{i,j}}{h}\\right)^2 h^2 \\;+\\; \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-2}\\left(\\frac{f_{i,j+1}-f_{i,j}}{h}\\right)^2 h^2}}{\\sqrt{\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} f_{i,j}^2 \\, h^2}}.\n$$\n- 矢量场 $\\mathbf{g}_{\\eta}=(g^{(x)}_{\\eta},g^{(y)}_{\\eta})$ 的粗糙度定义为\n$$\n\\mathcal{R}[\\mathbf{g}_{\\eta}] \\equiv \\frac{\\sqrt{\\sum_{i,j}\\left(\\left\\|\\nabla_h g^{(x)}_{\\eta}\\right\\|^2 + \\left\\|\\nabla_h g^{(y)}_{\\eta}\\right\\|^2\\right) h^2}}{\\sqrt{\\sum_{i,j}\\left(\\left(g^{(x)}_{\\eta}\\right)^2 + \\left(g^{(y)}_{\\eta}\\right)^2\\right) h^2}},\n$$\n其中 $\\|\\nabla_h f\\|^2$ 的近似采用与 $\\mathcal{R}[f]$ 中相同的向前差分格式，对 x 方向的差分，求和范围为 $i\\in\\{0,\\dots,N-2\\}$ 和 $j\\in\\{0,\\dots,N-1\\}$；对 y 方向的差分，求和范围为 $i\\in\\{0,\\dots,N-1\\}$ 和 $j\\in\\{0,\\dots,N-2\\}$。\n\n用于可复现测试的数据：\n- 网格分辨率：$N=81$，因此 $h=1/(81-1)$。\n- 粒子数量：$P=6$，具有以下属性：\n  - 粒子 1：位置 $(0.20,\\,0.20)$，质量 $0.50$，速度 $(0.80,\\,0.10)$。\n  - 粒子 2：位置 $(0.80,\\,0.20)$，质量 $0.30$，速度 $(-0.20,\\,0.50)$。\n  - 粒子 3：位置 $(0.50,\\,0.50)$，质量 $0.70$，速度 $(0.00,\\,-0.60)$。\n  - 粒子 4：位置 $(0.10,\\,0.90)$，质量 $0.40$，速度 $(0.30,\\,0.30)$。\n  - 粒子 5：位置 $(0.90,\\,0.90)$，质量 $0.60$，速度 $(-0.40,\\,0.20)$。\n  - 粒子 6：位置 $(0.05,\\,0.05)$，质量 $0.20$，速度 $(0.00,\\,0.00)$。\n- 核函数宽度（测试集）：$\\eta\\in\\{0.02,\\;0.05,\\;0.10,\\;0.25\\}$。\n\n任务：\n- 仅从上述定义和连续介质假设出发，为每个核函数宽度 $\\eta$ 计算网格上的离散场 $\\rho_{\\eta}$ 和 $\\mathbf{g}_{\\eta}$，然后计算两个粗糙度度量 $\\mathcal{R}[\\rho_{\\eta}]$ 和 $\\mathcal{R}[\\mathbf{g}_{\\eta}]$。\n- 通过报告指定测试集中每个 $\\eta$ 对应的序对 $\\left(\\mathcal{R}[\\rho_{\\eta}],\\,\\mathcal{R}[\\mathbf{g}_{\\eta}]\\right)$，研究 $\\eta$ 如何影响光滑度。\n\n答案规格与输出格式：\n- 对于按 $\\eta=0.02$、$\\eta=0.05$、$\\eta=0.10$、$\\eta=0.25$ 顺序排列的每个 $\\eta$，计算两个标量 $\\mathcal{R}[\\rho_{\\eta}]$ 和 $\\mathcal{R}[\\mathbf{g}_{\\eta}]$。\n- 使用标准四舍五入将每个标量保留 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序展开\n$$\n\\left[\\mathcal{R}[\\rho_{0.02}],\\;\\mathcal{R}[\\mathbf{g}_{0.02}],\\;\\mathcal{R}[\\rho_{0.05}],\\;\\mathcal{R}[\\mathbf{g}_{0.05}],\\;\\mathcal{R}[\\rho_{0.10}],\\;\\mathcal{R}[\\mathbf{g}_{0.10}],\\;\\mathcal{R}[\\rho_{0.25}],\\;\\mathcal{R}[\\mathbf{g}_{0.25}]\\right].\n$$\n- 输出必须只有一行，不含任何额外文本，例如，形式为 $\\left[r_1,r_2,r_3,r_4,r_5,r_6,r_7,r_8\\right]$，其中每个 $r_k$ 是一个保留6位小数的浮点数。\n\n您的最终答案必须是一个完整、可运行的程序，该程序执行这些步骤并打印所需的单行输出。",
            "solution": "问题陈述经过验证，被认为是有效的。这是一个良定的计算问题，其基础是连续介质力学原理，特别是将离散粒子描述与连续场描述联系起来的粗粒化过程。所有定义、数据和要求的计算都得到了明确无误的说明，没有歧义或矛盾。\n\n任务是从一组离散粒子计算质量密度和线动量密度的粗粒化场，然后量化这些场的光滑度。步骤如下：\n\n1.  **离散化域**：将连续域 $\\Omega = [0,1]\\times[0,1]$ 离散化为一个 $N \\times N$ 点的均匀笛卡尔网格，其中 $N=81$。网格点为 $\\mathbf{x}_{ij} = (i h, j h)$，其中 $i,j \\in \\{0, 1, \\dots, N-1\\}$，网格间距为 $h=1/(N-1)$。\n\n2.  **构建连续场**：对于给定的核函数宽度 $\\eta$，在每个网格点 $\\mathbf{x}_{ij}$ 处构建质量密度场 $\\rho_{\\eta}$ 和线动量密度场 $\\mathbf{g}_{\\eta}$。这些场是 $P=6$ 个粒子各自贡献的叠加，并通过归一化的二维高斯核函数 $W_{\\eta}$进行加权。\n    质量密度，一个标量场，由下式给出：\n    $$\n    \\rho_{\\eta}(\\mathbf{x}_{ij}) = \\sum_{p=1}^{P} m_p \\, W_{\\eta}(\\mathbf{x}_{ij}-\\mathbf{x}_p)\n    $$\n    线动量密度，一个矢量场 $\\mathbf{g}_{\\eta} = (g^{(x)}_{\\eta}, g^{(y)}_{\\eta})$，由下式给出：\n    $$\n    \\mathbf{g}_{\\eta}(\\mathbf{x}_{ij}) = \\sum_{p=1}^{P} m_p \\,\\mathbf{v}_p \\, W_{\\eta}(\\mathbf{x}_{ij}-\\mathbf{x}_p)\n    $$\n    核函数定义为：\n    $$\n    W_{\\eta}(\\mathbf{r}) = \\frac{1}{2\\pi \\eta^2}\\,\\exp\\!\\left(-\\frac{\\|\\mathbf{r}\\|^2}{2\\eta^2}\\right)\n    $$\n    其中 $\\mathbf{r} = \\mathbf{x}_{ij} - \\mathbf{x}_p$ 是从粒子 $p$ 到网格点 $(i,j)$ 的向量。\n\n3.  **量化场的光滑度**：计算出的场的光滑度通过离散粗糙度度量 $\\mathcal{R}$ 来量化。该度量是一个归一化的比率。分子是场梯度 $L^2$-范数的离散近似，代表场空间变化的总变差或“能量”。分母是场本身的离散 $L^2$-范数，用于提供归一化。\n    对于网格上的标量场 $f$，其粗糙度为：\n    $$\n    \\mathcal{R}[f] = \\frac{\\sqrt{\\sum_{i,j} \\|\\nabla_h f_{ij}\\|^2 h^2}}{\\sqrt{\\sum_{i,j} f_{ij}^2 h^2}} = \\frac{\\sqrt{ \\sum_{i=0}^{N-2}\\sum_{j=0}^{N-1} (f_{i+1,j}-f_{i,j})^2 + \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-2} (f_{i,j+1}-f_{i,j})^2 }}{h \\sqrt{\\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} f_{i,j}^2}}\n    $$\n    项 $\\|\\nabla_h f_{ij}\\|^2 h^2$ 使用梯度分量的前向差分进行计算。在消去 $h$ 后，公式得到简化。\n    对于矢量场 $\\mathbf{g}_{\\eta} = (g^{(x)}_{\\eta}, g^{(y)}_{\\eta})$，粗糙度推广了这一概念：分子结合了两个分量的梯度能量，分母是矢量场的 $L^2$-范数。\n    $$\n    \\mathcal{R}[\\mathbf{g}_{\\eta}] = \\frac{\\sqrt{ \\left(\\text{NumSq}[g^{(x)}_{\\eta}]\\right) + \\left(\\text{NumSq}[g^{(y)}_{\\eta}]\\right) }}{h \\sqrt{\\sum_{i,j} \\left( (g^{(x)}_{\\eta,ij})^2 + (g^{(y)}_{\\eta,ij})^2\\right)}}\n    $$\n    其中 $\\text{NumSq}[f]$ 表示从标量粗糙度计算中得到的分子平方项。\n\n对每个指定的核函数宽度 $\\eta \\in \\{0.02, 0.05, 0.10, 0.25\\}$ 都实施了这一完整过程。随着 $\\eta$ 的增大，高斯核函数变得更宽，导致更大的重叠和更光滑的宏观场。因此，粗糙度度量 $\\mathcal{R}[\\rho_{\\eta}]$ 和 $\\mathcal{R}[\\mathbf{g}_{\\eta}]$ 预计会减小，这证实了粗粒化过程的平滑效应。最终结果按要求进行了四舍五入和格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes coarse-grained mass and momentum density fields from discrete particle data\n    and calculates their roughness for various Gaussian kernel widths.\n    \"\"\"\n    # Define the test cases and parameters from the problem statement.\n    test_cases = [\n        # Particle data: [pos_x, pos_y, mass, vel_x, vel_y]\n        (np.array([\n            [0.20, 0.20, 0.50,  0.80,  0.10],\n            [0.80, 0.20, 0.30, -0.20,  0.50],\n            [0.50, 0.50, 0.70,  0.00, -0.60],\n            [0.10, 0.90, 0.40,  0.30,  0.30],\n            [0.90, 0.90, 0.60, -0.40,  0.20],\n            [0.05, 0.05, 0.20,  0.00,  0.00],\n        ]),\n        [0.02, 0.05, 0.10, 0.25])\n    ]\n\n    N = 81\n    h = 1.0 / (N - 1)\n    \n    # Generate grid coordinates\n    grid_coords = np.linspace(0, 1, N)\n    xx, yy = np.meshgrid(grid_coords, grid_coords)\n\n    results = []\n\n    for particles, eta_values in test_cases:\n        for eta in eta_values:\n            # Initialize fields for the current eta\n            rho = np.zeros((N, N))\n            g_x = np.zeros((N, N))\n            g_y = np.zeros((N, N))\n            \n            eta_sq = eta**2\n            kernel_norm = 1.0 / (2.0 * np.pi * eta_sq)\n            \n            # Sum contributions from all particles to construct the fields\n            for p_data in particles:\n                pos_x, pos_y, mass, vel_x, vel_y = p_data\n                \n                # Calculate squared distance from particle to all grid points\n                dist_sq = (xx - pos_x)**2 + (yy - pos_y)**2\n                \n                # Evaluate the Gaussian kernel over the grid\n                W = kernel_norm * np.exp(-dist_sq / (2.0 * eta_sq))\n                \n                # Accumulate weighted contributions to fields\n                rho += mass * W\n                g_x += mass * vel_x * W\n                g_y += mass * vel_y * W\n\n            # --- Calculate roughness for the scalar field rho ---\n            # Numerator: sqrt of sum of squared differences\n            diff_rho_x = rho[1:, :] - rho[:-1, :]\n            diff_rho_y = rho[:, 1:] - rho[:, :-1]\n            num_rho_sq = np.sum(diff_rho_x**2) + np.sum(diff_rho_y**2)\n            \n            # Denominator: h * sqrt of sum of squared field values\n            den_rho_sq_sum = np.sum(rho**2)\n            \n            if num_rho_sq == 0 or den_rho_sq_sum == 0:\n                R_rho = 0.0\n            else:\n                R_rho = np.sqrt(num_rho_sq) / (h * np.sqrt(den_rho_sq_sum))\n\n            # --- Calculate roughness for the vector field g ---\n            # Numerator: sqrt of the sum of squared gradient energies for each component\n            diff_gx_x = g_x[1:, :] - g_x[:-1, :]\n            diff_gx_y = g_x[:, 1:] - g_x[:, :-1]\n            num_gx_sq = np.sum(diff_gx_x**2) + np.sum(diff_gx_y**2)\n            \n            diff_gy_x = g_y[1:, :] - g_y[:-1, :]\n            diff_gy_y = g_y[:, 1:] - g_y[:, :-1]\n            num_gy_sq = np.sum(diff_gy_x**2) + np.sum(diff_gy_y**2)\n\n            num_g_sq = num_gx_sq + num_gy_sq\n\n            # Denominator: h * sqrt of sum of squared vector magnitudes\n            den_g_sq_sum = np.sum(g_x**2 + g_y**2)\n\n            if num_g_sq == 0 or den_g_sq_sum == 0:\n                R_g = 0.0\n            else:\n                 R_g = np.sqrt(num_g_sq) / (h * np.sqrt(den_g_sq_sum))\n\n            # Append rounded results to the list\n            results.append(round(R_rho, 6))\n            results.append(round(R_g, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}