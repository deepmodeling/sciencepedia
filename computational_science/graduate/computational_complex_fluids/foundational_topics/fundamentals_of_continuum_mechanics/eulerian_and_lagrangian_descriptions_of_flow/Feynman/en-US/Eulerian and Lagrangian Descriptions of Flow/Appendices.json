{
    "hands_on_practices": [
        {
            "introduction": "The deformation gradient, denoted by $\\mathbf{F}$, is the cornerstone of continuum mechanics, providing the fundamental mathematical link between the Lagrangian (material) and Eulerian (spatial) descriptions of motion. This practice will solidify your understanding of how $\\mathbf{F}$ quantitatively describes the local deformation of a material. By deriving the transformations for infinitesimal line and area elements and applying them to the case of simple shear flow, you will gain a concrete intuition for how material stretches and reorients in a flow .",
            "id": "4086874",
            "problem": "Consider a three-dimensional continuum with a motion described by the flow map $\\boldsymbol{\\chi}(\\mathbf{X},t)$ that takes a material point from a reference configuration with position $\\mathbf{X}$ to its current configuration position $\\mathbf{x}=\\boldsymbol{\\chi}(\\mathbf{X},t)$ at time $t$. The Eulerian description provides the velocity field $\\mathbf{v}(\\mathbf{x},t)$ at a spatial location in the current configuration, while the Lagrangian description provides the trajectory via $\\boldsymbol{\\chi}(\\mathbf{X},t)$. Let the deformation gradient be defined by the fundamental kinematic relation\n$$\n\\mathbf{F}(\\mathbf{X},t) = \\frac{\\partial \\boldsymbol{\\chi}(\\mathbf{X},t)}{\\partial \\mathbf{X}},\n$$\nand let the Jacobian determinant be $J(\\mathbf{X},t) = \\det \\mathbf{F}(\\mathbf{X},t)$.\n\nStarting from the definitions of the flow map and the deformation gradient, derive the mapping of a material line element and a material area element from the reference configuration to the current configuration. Specifically, show how a differential material fiber maps as\n$$\n\\mathrm{d}\\mathbf{x} = \\mathbf{F}\\,\\mathrm{d}\\mathbf{X},\n$$\nand how a differential material area vector maps as\n$$\n\\mathrm{d}\\mathbf{a} = J\\,\\mathbf{F}^{-T}\\,\\mathrm{d}\\mathbf{A}.\n$$\nHere, $\\mathrm{d}\\mathbf{X}$ is a differential line element in the reference configuration, and $\\mathrm{d}\\mathbf{A}$ is the oriented area vector in the reference configuration.\n\nThen, consider the simple shear flow with constant shear rate $\\gamma$ described in Eulerian form by\n$$\n\\mathbf{v}(\\mathbf{x},t) = (\\gamma\\,y,\\,0,\\,0),\n$$\nwhere $y$ is the current $y$-coordinate and $\\gamma$ is a constant with units of inverse time. Assume the reference configuration at $t=0$ is such that $\\boldsymbol{\\chi}(\\mathbf{X},0)=\\mathbf{X}$. Compute $\\mathbf{F}(\\mathbf{X},t)$ and $J(\\mathbf{X},t)$ for this motion.\n\nFinally, for a unit reference fiber $\\mathrm{d}\\mathbf{X}$ lying in the $x$-$y$ plane and oriented along $\\mathbf{M}_{0}=(\\cos\\theta,\\sin\\theta,0)$, and a unit reference area vector $\\mathrm{d}\\mathbf{A}$ lying in the $x$-$y$ plane and oriented along $\\mathbf{N}_{0}=(\\cos\\phi,\\sin\\phi,0)$, use the derived mappings to obtain explicit formulas for the magnitudes of the current line element $|\\mathrm{d}\\mathbf{x}|$ and the current area vector magnitude $|\\mathrm{d}\\mathbf{a}|$ as functions of $\\gamma$, $t$, $\\theta$, and $\\phi$. Express your final answer as a single row matrix using the $\\mathrm{pmatrix}$ environment with two entries, the first being $|\\mathrm{d}\\mathbf{x}|$ and the second being $|\\mathrm{d}\\mathbf{a}|$. No rounding is required. Since the reference magnitudes are unity, both results are dimensionless by construction.",
            "solution": "The motion of a continuum is described by the flow map $\\boldsymbol{\\chi}(\\mathbf{X},t)$ that assigns to each material point labeled by its reference position $\\mathbf{X}$ its current position $\\mathbf{x}=\\boldsymbol{\\chi}(\\mathbf{X},t)$ at time $t$. The deformation gradient is the spatial derivative of the flow map with respect to the reference coordinates,\n$$\n\\mathbf{F}(\\mathbf{X},t)=\\frac{\\partial \\boldsymbol{\\chi}(\\mathbf{X},t)}{\\partial \\mathbf{X}}.\n$$\nThis definition is the fundamental base for mapping differential geometric objects from the reference configuration to the current configuration.\n\nMapping of a material line element: Consider a differential material fiber $\\mathrm{d}\\mathbf{X}$ attached to the material in the reference configuration. Under the motion, its image in the current configuration is the difference of positions $\\mathrm{d}\\mathbf{x}=\\boldsymbol{\\chi}(\\mathbf{X}+\\mathrm{d}\\mathbf{X},t)-\\boldsymbol{\\chi}(\\mathbf{X},t)$. For infinitesimal $\\mathrm{d}\\mathbf{X}$, we use the first-order Taylor expansion of the flow map,\n$$\n\\boldsymbol{\\chi}(\\mathbf{X}+\\mathrm{d}\\mathbf{X},t)\\approx \\boldsymbol{\\chi}(\\mathbf{X},t)+\\frac{\\partial \\boldsymbol{\\chi}}{\\partial \\mathbf{X}}(\\mathbf{X},t)\\,\\mathrm{d}\\mathbf{X}=\\boldsymbol{\\chi}(\\mathbf{X},t)+\\mathbf{F}(\\mathbf{X},t)\\,\\mathrm{d}\\mathbf{X}.\n$$\nHence,\n$$\n\\mathrm{d}\\mathbf{x}=\\mathbf{F}(\\mathbf{X},t)\\,\\mathrm{d}\\mathbf{X}.\n$$\n\nMapping of a material area element (Nanson’s formula): Let a small oriented surface patch in the reference configuration be spanned by two independent differential material line elements $\\mathrm{d}\\mathbf{X}_{1}$ and $\\mathrm{d}\\mathbf{X}_{2}$, so that its oriented area vector is\n$$\n\\mathrm{d}\\mathbf{A}=\\mathrm{d}\\mathbf{X}_{1}\\times \\mathrm{d}\\mathbf{X}_{2}.\n$$\nUnder the motion, these spanning fibers map to $\\mathrm{d}\\mathbf{x}_{1}=\\mathbf{F}\\,\\mathrm{d}\\mathbf{X}_{1}$ and $\\mathrm{d}\\mathbf{x}_{2}=\\mathbf{F}\\,\\mathrm{d}\\mathbf{X}_{2}$. The oriented area vector of the current patch is then\n$$\n\\mathrm{d}\\mathbf{a}=\\mathrm{d}\\mathbf{x}_{1}\\times \\mathrm{d}\\mathbf{x}_{2}=(\\mathbf{F}\\,\\mathrm{d}\\mathbf{X}_{1})\\times (\\mathbf{F}\\,\\mathrm{d}\\mathbf{X}_{2}).\n$$\nUsing the identity that the cross product of two vectors transformed by a linear map $\\mathbf{F}$ equals the cofactor of $\\mathbf{F}$ acting on the original cross product, we have\n$$\n(\\mathbf{F}\\,\\mathbf{u})\\times (\\mathbf{F}\\,\\mathbf{v})=\\operatorname{cof}(\\mathbf{F})\\,(\\mathbf{u}\\times \\mathbf{v}),\n$$\nwhere $\\operatorname{cof}(\\mathbf{F})$ is the cofactor matrix of $\\mathbf{F}$. Therefore,\n$$\n\\mathrm{d}\\mathbf{a}=\\operatorname{cof}(\\mathbf{F})\\,\\mathrm{d}\\mathbf{A}.\n$$\nBy a well-tested identity from linear algebra and continuum mechanics, $\\operatorname{cof}(\\mathbf{F})=J\\,\\mathbf{F}^{-T}$, where $J=\\det \\mathbf{F}$. Thus,\n$$\n\\mathrm{d}\\mathbf{a}=J\\,\\mathbf{F}^{-T}\\,\\mathrm{d}\\mathbf{A}.\n$$\nThis is Nanson’s formula, derived from the fundamental definitions of the flow map and deformation gradient.\n\nSimple shear kinematics from an Eulerian velocity field: We are given the Eulerian velocity field\n$$\n\\mathbf{v}(\\mathbf{x},t)=(\\gamma\\,y,\\,0,\\,0),\n$$\nwith constant shear rate $\\gamma$. The Lagrangian trajectories satisfy the ordinary differential equations\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t}=\\gamma\\,y,\\qquad \\frac{\\mathrm{d}y}{\\mathrm{d}t}=0,\\qquad \\frac{\\mathrm{d}z}{\\mathrm{d}t}=0,\n$$\nwith initial conditions at $t=0$ given by $x(0)=X$, $y(0)=Y$, $z(0)=Z$. Since $\\mathrm{d}y/\\mathrm{d}t=0$, we have $y(t)=Y$ for all $t$. Then,\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t}=\\gamma\\,Y\\quad\\Rightarrow\\quad x(t)=X+\\gamma\\,t\\,Y.\n$$\nSimilarly, $z(t)=Z$. Thus, the flow map is\n$$\n\\boldsymbol{\\chi}(\\mathbf{X},t)=\\begin{pmatrix} X+\\gamma\\,t\\,Y \\\\ Y \\\\ Z\\end{pmatrix}.\n$$\nThe deformation gradient is the Jacobian of $\\boldsymbol{\\chi}$ with respect to $\\mathbf{X}$,\n$$\n\\mathbf{F}(\\mathbf{X},t)=\\frac{\\partial \\boldsymbol{\\chi}}{\\partial \\mathbf{X}}=\\begin{pmatrix}\n\\frac{\\partial x}{\\partial X} & \\frac{\\partial x}{\\partial Y} & \\frac{\\partial x}{\\partial Z} \\\\\n\\frac{\\partial y}{\\partial X} & \\frac{\\partial y}{\\partial Y} & \\frac{\\partial y}{\\partial Z} \\\\\n\\frac{\\partial z}{\\partial X} & \\frac{\\partial z}{\\partial Y} & \\frac{\\partial z}{\\partial Z}\n\\end{pmatrix}=\\begin{pmatrix}\n1 & \\gamma\\,t & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\nThe Jacobian determinant is\n$$\nJ(\\mathbf{X},t)=\\det \\mathbf{F}=1,\n$$\nconsistent with incompressibility of simple shear. The inverse of $\\mathbf{F}$ is\n$$\n\\mathbf{F}^{-1}=\\begin{pmatrix}\n1 & -\\gamma\\,t & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix},\n$$\nand hence\n$$\n\\mathbf{F}^{-T}=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n-\\gamma\\,t & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n\nMapping and magnitudes for specified reference elements: Let the unit reference fiber be $\\mathrm{d}\\mathbf{X}=\\mathbf{M}_{0}$ with\n$$\n\\mathbf{M}_{0}=(\\cos\\theta,\\sin\\theta,0).\n$$\nIts current image is\n$$\n\\mathrm{d}\\mathbf{x}=\\mathbf{F}\\,\\mathbf{M}_{0}=\\begin{pmatrix}\n1 & \\gamma\\,t & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\\begin{pmatrix}\\cos\\theta \\\\ \\sin\\theta \\\\ 0\\end{pmatrix}=\\begin{pmatrix}\n\\cos\\theta+\\gamma\\,t\\,\\sin\\theta \\\\ \\sin\\theta \\\\ 0\n\\end{pmatrix}.\n$$\nThe magnitude of the current fiber is\n$$\n|\\mathrm{d}\\mathbf{x}|=\\sqrt{\\left(\\cos\\theta+\\gamma\\,t\\,\\sin\\theta\\right)^{2}+\\left(\\sin\\theta\\right)^{2}}=\\sqrt{1+2\\,\\gamma\\,t\\,\\sin\\theta\\,\\cos\\theta+\\gamma^{2}\\,t^{2}\\,\\sin^{2}\\theta}.\n$$\n\nLet the unit reference area vector be $\\mathrm{d}\\mathbf{A}=\\mathbf{N}_{0}$ with\n$$\n\\mathbf{N}_{0}=(\\cos\\phi,\\sin\\phi,0).\n$$\nIts current image is, by Nanson’s formula with $J=1$,\n$$\n\\mathrm{d}\\mathbf{a}=\\mathbf{F}^{-T}\\,\\mathbf{N}_{0}=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n-\\gamma\\,t & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\\begin{pmatrix}\\cos\\phi \\\\ \\sin\\phi \\\\ 0\\end{pmatrix}=\\begin{pmatrix}\n\\cos\\phi \\\\ -\\gamma\\,t\\,\\cos\\phi+\\sin\\phi \\\\ 0\n\\end{pmatrix}.\n$$\nThe magnitude of the current area vector is\n$$\n|\\mathrm{d}\\mathbf{a}|=\\sqrt{\\left(\\cos\\phi\\right)^{2}+\\left(-\\gamma\\,t\\,\\cos\\phi+\\sin\\phi\\right)^{2}}=\\sqrt{1-\\;2\\,\\gamma\\,t\\,\\sin\\phi\\,\\cos\\phi+\\gamma^{2}\\,t^{2}\\,\\cos^{2}\\phi}.\n$$\n\nTherefore, the requested magnitudes as functions of $\\gamma$, $t$, $\\theta$, and $\\phi$ are\n$$\n|\\mathrm{d}\\mathbf{x}|=\\sqrt{1+2\\,\\gamma\\,t\\,\\sin\\theta\\,\\cos\\theta+\\gamma^{2}\\,t^{2}\\,\\sin^{2}\\theta},\\qquad\n|\\mathrm{d}\\mathbf{a}|=\\sqrt{1-2\\,\\gamma\\,t\\,\\sin\\phi\\,\\cos\\phi+\\gamma^{2}\\,t^{2}\\,\\cos^{2}\\phi}.\n$$\nNo rounding is required, and because the reference magnitudes are unity, these are dimensionless expressions.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\sqrt{1+2\\,\\gamma\\,t\\,\\sin\\theta\\,\\cos\\theta+\\gamma^{2}\\,t^{2}\\,\\sin^{2}\\theta} & \\sqrt{1-2\\,\\gamma\\,t\\,\\sin\\phi\\,\\cos\\phi+\\gamma^{2}\\,t^{2}\\,\\cos^{2}\\phi}\\end{pmatrix}}$$"
        },
        {
            "introduction": "While the laws of transport are often expressed in an Eulerian frame using fluxes through fixed control volumes, understanding the changes experienced by a moving fluid particle requires a Lagrangian perspective. This exercise bridges that gap by tasking you with deriving the material derivative of a species mass fraction, $\\frac{DY}{Dt}$, directly from the general Eulerian conservation equation. This process reveals the deep connection between the Lagrangian rate of change and the Eulerian concepts of convective transport, diffusive flux divergence, and local sources .",
            "id": "3957488",
            "problem": "Consider a compressible, reacting, multicomponent flow relevant to Computational Fluid Dynamics (CFD) in aerospace applications, described in the Eulerian frame by the mixture density field $\\rho(\\mathbf{x}, t)$, mass-averaged velocity field $\\mathbf{u}(\\mathbf{x}, t)$, and a single species mass fraction field $Y(\\mathbf{x}, t)$. The species experiences molecular diffusion relative to the mass-averaged velocity and net volumetric production by chemical reactions. The diffusive flux relative to the mass-averaged velocity is modeled by Fick’s law with spatially and temporally varying binary diffusivity $D(\\mathbf{x}, t)$, so that the diffusive flux is $\\mathbf{J}(\\mathbf{x}, t) = -\\rho(\\mathbf{x}, t)\\,D(\\mathbf{x}, t)\\,\\nabla Y(\\mathbf{x}, t)$. The chemical source term per unit volume is $\\dot{\\omega}(\\mathbf{x}, t)$. The material derivative follows a Lagrangian description along a pathline, and is defined by $D(\\cdot)/Dt$ acting on scalar fields.\n\nStarting only from the following fundamental bases:\n- The Reynolds Transport Theorem for a material volume.\n- The definition of material derivative $D(\\cdot)/Dt$.\n- Conservation of total mass for the mixture.\n- Species conservation with fluxes and sources.\n\nDerive a closed-form local expression for the material derivative $D Y/D t$ at an arbitrary point, explicitly incorporating the diffusive flux modeled by Fick’s law and the chemical source term $\\dot{\\omega}$, and show its connection to the divergence of Eulerian fluxes. Express your final answer as a single analytic expression in terms of $\\rho$, $D$, $Y$, $\\nabla$, and $\\dot{\\omega}$. Do not provide intermediate steps in the final answer; only the final expression is required. No numerical evaluation is needed.",
            "solution": "The problem requires the derivation of a local expression for the material derivative of a species mass fraction, $\\frac{D Y}{D t}$, starting from fundamental conservation principles. The derivation proceeds by first establishing the differential form of the species conservation equation from its integral form and then manipulating it using the definition of the material derivative and the continuity equation for the mixture.\n\nThe fundamental principle for species conservation states that for a fixed (Eulerian) control volume $V$ with boundary surface $S$, the time rate of change of the total mass of the species within $V$ is equal to the net rate at which the species is transported into $V$ across $S$ plus the net rate at which the species is produced by chemical reactions within $V$.\n\nThe total mass of the species within the control volume $V$ is given by the integral of the species density, $\\rho Y$, over the volume: $\\int_V \\rho(\\mathbf{x}, t) Y(\\mathbf{x}, t) \\, dV$. Its time rate of change is $\\frac{d}{dt} \\int_V \\rho Y \\, dV$. Since the volume $V$ is fixed in space, the time derivative can be brought inside the integral: $\\int_V \\frac{\\partial (\\rho Y)}{\\partial t} \\, dV$.\n\nThe total flux of the species consists of two parts: the convective flux, which is the mass of the species carried along with the mass-averaged velocity $\\mathbf{u}$, given by $\\rho Y \\mathbf{u}$, and the diffusive flux $\\mathbf{J}$ relative to the mass-averaged velocity. The net rate of species transport into the volume across the surface $S$ is the negative of the integral of the total flux vector dotted with the outward-pointing normal vector $\\mathbf{n}$, represented as $-\\oint_S (\\rho Y \\mathbf{u} + \\mathbf{J}) \\cdot \\mathbf{n} \\, dS$.\n\nThe net rate of species production within the volume $V$ is the integral of the volumetric source term $\\dot{\\omega}$: $\\int_V \\dot{\\omega} \\, dV$.\n\nEquating the rate of accumulation with the sum of net transport and production gives the integral form of the species conservation equation:\n$$\n\\frac{d}{dt} \\int_V \\rho Y \\, dV = \\int_V \\frac{\\partial (\\rho Y)}{\\partial t} \\, dV = -\\oint_S (\\rho Y \\mathbf{u} + \\mathbf{J}) \\cdot \\mathbf{n} \\, dS + \\int_V \\dot{\\omega} \\, dV\n$$\nThis equation is a direct application of the Reynolds Transport Theorem to the species mass. To obtain a local, differential equation, we apply the Gauss's divergence theorem to the surface integral term, converting it into a volume integral:\n$$\n\\oint_S (\\rho Y \\mathbf{u} + \\mathbf{J}) \\cdot \\mathbf{n} \\, dS = \\int_V \\nabla \\cdot (\\rho Y \\mathbf{u} + \\mathbf{J}) \\, dV\n$$\nSubstituting this back into the integral conservation law yields:\n$$\n\\int_V \\frac{\\partial (\\rho Y)}{\\partial t} \\, dV = -\\int_V \\nabla \\cdot (\\rho Y \\mathbf{u} + \\mathbf{J}) \\, dV + \\int_V \\dot{\\omega} \\, dV\n$$\nCombining all terms under a single volume integral gives:\n$$\n\\int_V \\left[ \\frac{\\partial (\\rho Y)}{\\partial t} + \\nabla \\cdot (\\rho Y \\mathbf{u} + \\mathbf{J}) - \\dot{\\omega} \\right] dV = 0\n$$\nSince this integral must be zero for any arbitrary control volume $V$, the integrand itself must be identically zero everywhere. This provides the local, differential form of the species conservation equation, also known as the species transport equation in conservative form:\n$$\n\\frac{\\partial (\\rho Y)}{\\partial t} + \\nabla \\cdot (\\rho Y \\mathbf{u} + \\mathbf{J}) = \\dot{\\omega}\n$$\nThe term $\\nabla \\cdot (\\rho Y \\mathbf{u} + \\mathbf{J})$ represents the divergence of the total Eulerian species flux.\n\nTo find an expression for the material derivative $\\frac{DY}{Dt}$, we expand the terms on the left-hand side of this equation using the product rule for derivatives:\n$$\n\\frac{\\partial (\\rho Y)}{\\partial t} = Y \\frac{\\partial \\rho}{\\partial t} + \\rho \\frac{\\partial Y}{\\partial t}\n$$\n$$\n\\nabla \\cdot (\\rho Y \\mathbf{u}) = Y (\\nabla \\cdot (\\rho \\mathbf{u})) + (\\rho \\mathbf{u}) \\cdot (\\nabla Y)\n$$\nSubstituting these expansions into the species transport equation gives:\n$$\n\\left( Y \\frac{\\partial \\rho}{\\partial t} + \\rho \\frac{\\partial Y}{\\partial t} \\right) + \\left( Y (\\nabla \\cdot (\\rho \\mathbf{u})) + (\\rho \\mathbf{u}) \\cdot (\\nabla Y) \\right) + \\nabla \\cdot \\mathbf{J} = \\dot{\\omega}\n$$\nWe can rearrange this equation by grouping terms multiplying $Y$ and $\\rho$:\n$$\n\\rho \\left( \\frac{\\partial Y}{\\partial t} + \\mathbf{u} \\cdot \\nabla Y \\right) + Y \\left( \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) \\right) + \\nabla \\cdot \\mathbf{J} = \\dot{\\omega}\n$$\nOne of the fundamental bases provided is the conservation of total mass for the mixture. This is expressed by the continuity equation, which states:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\nSubstituting this into the rearranged species equation, the term multiplied by $Y$ vanishes:\n$$\n\\rho \\left( \\frac{\\partial Y}{\\partial t} + \\mathbf{u} \\cdot \\nabla Y \\right) + Y(0) + \\nabla \\cdot \\mathbf{J} = \\dot{\\omega}\n$$\nThe expression in the parenthesis is, by definition, the material derivative of the scalar field $Y$ following a fluid particle in a Lagrangian description:\n$$\n\\frac{D Y}{D t} \\equiv \\frac{\\partial Y}{\\partial t} + \\mathbf{u} \\cdot \\nabla Y\n$$\nThus, the species conservation equation simplifies to:\n$$\n\\rho \\frac{D Y}{D t} + \\nabla \\cdot \\mathbf{J} = \\dot{\\omega}\n$$\nNow we can solve for $\\frac{DY}{Dt}$:\n$$\n\\frac{D Y}{D t} = \\frac{1}{\\rho} (\\dot{\\omega} - \\nabla \\cdot \\mathbf{J})\n$$\nThe final step is to incorporate the specific model for the diffusive flux, which is given by Fick's law:\n$$\n\\mathbf{J}(\\mathbf{x}, t) = -\\rho(\\mathbf{x}, t) D(\\mathbf{x}, t) \\nabla Y(\\mathbf{x}, t)\n$$\nSubstituting this expression for $\\mathbf{J}$ into the equation for $\\frac{DY}{Dt}$ gives the final result:\n$$\n\\frac{D Y}{D t} = \\frac{1}{\\rho} \\left( \\dot{\\omega} - \\nabla \\cdot (-\\rho D \\nabla Y) \\right)\n$$\n$$\n\\frac{D Y}{D t} = \\frac{1}{\\rho} \\left( \\dot{\\omega} + \\nabla \\cdot (\\rho D \\nabla Y) \\right)\n$$\nThis expression gives the rate of change of the species mass fraction for an observer moving with the flow (Lagrangian description) in terms of the local chemical production, $\\dot{\\omega}$, and the divergence of the diffusive flux, which are fields defined in the Eulerian frame.",
            "answer": "$$\n\\boxed{\\frac{1}{\\rho} \\left( \\dot{\\omega} + \\nabla \\cdot \\left(\\rho D \\nabla Y\\right) \\right)}\n$$"
        },
        {
            "introduction": "The theoretical distinction between Eulerian and Lagrangian viewpoints has profound consequences for the design of numerical algorithms in computational fluid dynamics. This hands-on computational practice brings that distinction to life by having you implement and compare two fundamentally different schemes for solving the advection equation. By contrasting a fixed-grid Eulerian method with a particle-tracking semi-Lagrangian method, you will directly investigate their practical differences in accuracy, stability, and implementation for the same transport problem .",
            "id": "4086856",
            "problem": "Consider passive scalar advection in a one-dimensional periodic domain of length $L=1$ in dimensionless units. Let the scalar field be $\\phi(x,t)$ defined for $x \\in [0,1)$ and $t \\ge 0$, and let the velocity field be a uniform constant $u=1$ in dimensionless units. The governing equation is the linear advection equation\n$$\n\\partial_t \\phi + u \\,\\partial_x \\phi = 0,\n$$\nwith periodic boundary conditions and an initial condition $\\phi(x,0)=\\phi_0(x)$ given by\n$$\n\\phi_0(x) = \\sin(2\\pi x) + 0.3 \\cos(6\\pi x) + 0.05 \\sin(10\\pi x).\n$$\nThe Eulerian description evaluates $\\phi$ at fixed spatial locations, while the Lagrangian description follows characteristics along particle paths. You are to implement and compare an Eulerian conservative scheme of second order accuracy and a semi-Lagrangian scheme that computes the same advective transport by characteristic backtracking with interpolation. Use the following fundamental bases: conservation of advected quantity, the definition of velocity $u=\\mathrm{d}x/\\mathrm{d}t$, and the method of characteristics. Ensure the Eulerian scheme is consistent with the linear advection equation, expresses transport in conservative form, and is second-order accurate in both space and time under a stability constraint consistent with the Courant-Friedrichs-Lewy (CFL) condition. The semi-Lagrangian scheme should trace the departure point for each grid location backward along characteristics by one time step and reconstruct $\\phi$ at that location using periodic linear interpolation.\n\nImplement both schemes on a uniform grid with $N$ points and spacing $\\Delta x = L/N$, with time step $\\Delta t$, up to a specified final time $T$. Compute the exact solution at time $T$ using the characteristic shift:\n$$\n\\phi_{\\text{exact}}(x,T) = \\phi_0(x - uT \\bmod 1).\n$$\nFor each numerical method and each test case, quantify the errors at $t=T$ using the following norms:\n- The discrete $L^2$ norm error:\n$$\nE_2 = \\left(\\sum_{i=0}^{N-1} \\left(\\phi_i - \\phi_{\\text{exact},i}\\right)^2 \\Delta x\\right)^{1/2},\n$$\n- The discrete $L^\\infty$ norm error:\n$$\nE_\\infty = \\max_{0 \\le i \\le N-1} \\left|\\phi_i - \\phi_{\\text{exact},i}\\right|.\n$$\n\nAll quantities are dimensionless and must be treated consistently in dimensionless units. Angles embedded in trigonometric functions are in radians. Your program must produce numerical results (floating point numbers). No percentages are involved.\n\nTest suite:\nUse the following set of parameter values $(N, \\Delta t, n_t)$, where $n_t$ is the number of time steps and $T = n_t \\,\\Delta t$:\n1. Case A (happy path): $N=128$, $\\Delta t=0.002$, $n_t=250$ so $T=0.5$.\n2. Case B (near-CFL boundary): $N=128$, $\\Delta t=0.007421875$, $n_t=67$ so $T=0.497265625$, with $\\lambda = u\\,\\Delta t/\\Delta x \\approx 0.947265625$.\n3. Case C (coarse grid): $N=64$, $\\Delta t=0.0078125$, $n_t=64$ so $T=0.5$, with $\\lambda = 0.5$.\n4. Case D (edge case CFL equal to one): $N=100$, $\\Delta t=0.01$, $n_t=50$ so $T=0.5$, with $\\lambda = 1.0$.\n\nFor each case, compute $(E_2,E_\\infty)$ for the Eulerian method and $(E_2,E_\\infty)$ for the semi-Lagrangian method. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by case and by method, with four numbers per case in the order $[E_{2,\\text{Eulerian}},E_{2,\\text{Semi-Lagrangian}},E_{\\infty,\\text{Eulerian}},E_{\\infty,\\text{Semi-Lagrangian}}]$. Across the four cases, the final output must therefore be a list of $16$ floating point numbers in the specified order.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Governing Equation**: The one-dimensional linear advection equation, $\\partial_t \\phi + u \\,\\partial_x \\phi = 0$.\n*   **Domain**: A periodic domain of length $L=1$, for $x \\in [0,1)$ and $t \\ge 0$.\n*   **Velocity Field**: A uniform constant velocity, $u=1$.\n*   **Initial Condition**: $\\phi(x,0)=\\phi_0(x) = \\sin(2\\pi x) + 0.3 \\cos(6\\pi x) + 0.05 \\sin(10\\pi x)$.\n*   **Numerical Methods**:\n    1.  An Eulerian conservative scheme of second-order accuracy in space and time.\n    2.  A semi-Lagrangian scheme using characteristic backtracking and periodic linear interpolation.\n*   **Discretization**: A uniform grid with $N$ points and spacing $\\Delta x = L/N$. The time step is $\\Delta t$, and the simulation runs for $n_t$ steps up to final time $T=n_t \\Delta t$.\n*   **Exact Solution**: $\\phi_{\\text{exact}}(x,T) = \\phi_0(x - uT \\bmod 1)$.\n*   **Error Metrics**:\n    *   $L^2$ norm error: $E_2 = \\left(\\sum_{i=0}^{N-1} \\left(\\phi_i - \\phi_{\\text{exact},i}\\right)^2 \\Delta x\\right)^{1/2}$.\n    *   $L^\\infty$ norm error: $E_\\infty = \\max_{0 \\le i \\le N-1} \\left|\\phi_i - \\phi_{\\text{exact},i}\\right|$.\n*   **Test Cases**:\n    1.  Case A: $N=128$, $\\Delta t=0.002$, $n_t=250$.\n    2.  Case B: $N=128$, $\\Delta t=0.007421875$, $n_t=67$.\n    3.  Case C: $N=64$, $\\Delta t=0.0078125$, $n_t=64$.\n    4.  Case D: $N=100$, $\\Delta t=0.01$, $n_t=50$.\n*   **Output Specification**: A single line containing a comma-separated list of $16$ floating-point numbers enclosed in square brackets, ordered as $[E_{2,\\text{Eulerian}}, E_{2,\\text{Semi-Lagrangian}}, E_{\\infty,\\text{Eulerian}}, E_{\\infty,\\text{Semi-Lagrangian}}]$ for each case from A to D.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientific Grounding**: The problem is fundamentally sound. It addresses the linear advection equation, a cornerstone of transport phenomena in physics and engineering. The Eulerian and semi-Lagrangian methods are standard, well-established numerical techniques for its solution.\n*   **Well-Posedness**: The initial-boundary value problem for the linear advection equation is well-posed, guaranteeing a unique and stable solution. The numerical problem is specified with all necessary parameters to construct a solution.\n*   **Objectivity**: The problem is stated using precise mathematical language, free from ambiguity or subjective interpretation.\n*   **Flaw Analysis**:\n    1.  The problem is scientifically and mathematically sound.\n    2.  The problem is directly relevant to the specified topic of computational methods for fluid dynamics.\n    3.  The problem is self-contained. There is a minor inconsistency in the descriptive text for Case B, which states \"$\\lambda = u\\,\\Delta t/\\Delta x \\approx 0.947265625$\". However, a direct calculation using the provided parameters $(N=128, \\Delta t=0.007421875, u=1, L=1)$ yields $\\lambda = 1 \\cdot 0.007421875 / (1/128) = 0.95$. As the specific parameter values $(N, \\Delta t, n_t)$ are the primary givens for computation, we proceed by using the derived value $\\lambda=0.95$. This minor descriptive error does not invalidate the problem itself.\n    4.  The conditions and parameters are physically and computationally realistic for a benchmark test.\n    5.  The problem is well-structured and leads to a unique numerical result.\n    6.  The problem is not trivial; it requires correct implementation of two distinct numerical schemes and error analysis.\n    7.  The results are numerically verifiable.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid**. A solution will be provided.\n\n### Solution Derivation and Implementation\n\nThe problem requires the numerical solution of the one-dimensional linear advection equation, $\\partial_t \\phi + u\\,\\partial_x \\phi = 0$, using two distinct methods on a periodic domain of length $L=1$ with velocity $u=1$.\n\nThe fundamental principle underlying the equation is that the scalar quantity $\\phi$ is conserved along characteristic curves. These curves are defined by the ordinary differential equation $\\frac{dx}{dt} = u$. For a constant velocity $u$, the characteristic passing through $(x, t)$ originates from the point $(x_d, t_0)$ where $x = x_d + u(t-t_0)$. Consequently, the exact solution is a simple translation of the initial profile: $\\phi(x,t) = \\phi(x-ut, 0) = \\phi_0(x-ut)$. On a periodic domain of length $L=1$, this becomes $\\phi_{\\text{exact}}(x,T) = \\phi_0((x - uT) \\pmod 1)$.\n\nWe will now detail the two numerical schemes.\n\n**1. Eulerian Method: Lax-Wendroff Scheme**\n\nThe problem requires a second-order accurate, conservative Eulerian scheme. The Lax-Wendroff scheme fulfills these criteria. We begin with a Taylor series expansion of $\\phi$ in time:\n$$\n\\phi(x, t+\\Delta t) = \\phi(x,t) + \\Delta t \\, \\partial_t \\phi(x,t) + \\frac{(\\Delta t)^2}{2} \\, \\partial_{tt} \\phi(x,t) + \\mathcal{O}((\\Delta t)^3)\n$$\nFrom the governing equation, we have $\\partial_t \\phi = -u \\, \\partial_x \\phi$. Differentiating this with respect to time gives $\\partial_{tt} \\phi = -u \\, \\partial_{tx} \\phi$. Assuming sufficient smoothness, we can swap the order of differentiation, $\\partial_{tx} \\phi = \\partial_{xt} \\phi$. Differentiating the governing equation with respect to space yields $\\partial_{xt} \\phi = -u \\, \\partial_{xx} \\phi$. Combining these, we find $\\partial_{tt} \\phi = u^2 \\, \\partial_{xx} \\phi$. Substituting these time derivatives back into the Taylor expansion results in a purely spatial representation:\n$$\n\\phi(x, t+\\Delta t) = \\phi(x,t) - u \\Delta t \\, \\partial_x \\phi(x,t) + \\frac{(u \\Delta t)^2}{2} \\, \\partial_{xx} \\phi(x,t) + \\mathcal{O}((\\Delta t)^3)\n$$\nWe now discretize this equation on a uniform grid $x_i = i \\Delta x$ for $i=0, \\ldots, N-1$, with time levels $t_n = n \\Delta t$. Let $\\phi_i^n \\approx \\phi(x_i, t_n)$. We use second-order central finite differences for the spatial derivatives:\n$$\n\\partial_x \\phi \\bigg|_{x_i} \\approx \\frac{\\phi_{i+1}^n - \\phi_{i-1}^n}{2 \\Delta x}, \\quad \\partial_{xx} \\phi \\bigg|_{x_i} \\approx \\frac{\\phi_{i+1}^n - 2\\phi_i^n + \\phi_{i-1}^n}{(\\Delta x)^2}\n$$\nSubstituting these into the time-expanded equation yields the semi-discrete scheme:\n$$\n\\phi_i^{n+1} = \\phi_i^n - u \\Delta t \\left(\\frac{\\phi_{i+1}^n - \\phi_{i-1}^n}{2 \\Delta x}\\right) + \\frac{(u \\Delta t)^2}{2} \\left(\\frac{\\phi_{i+1}^n - 2\\phi_i^n + \\phi_{i-1}^n}{(\\Delta x)^2}\\right)\n$$\nIntroducing the Courant number, $\\lambda = u \\Delta t / \\Delta x$, we can write the update formula as:\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{\\lambda}{2}(\\phi_{i+1}^n - \\phi_{i-1}^n) + \\frac{\\lambda^2}{2}(\\phi_{i+1}^n - 2\\phi_i^n + \\phi_{i-1}^n)\n$$\nBy grouping terms by their spatial index, we obtain the computational stencil:\n$$\n\\phi_i^{n+1} = \\left(\\frac{\\lambda^2 - \\lambda}{2}\\right)\\phi_{i+1}^n + (1 - \\lambda^2)\\phi_i^n + \\left(\\frac{\\lambda^2 + \\lambda}{2}\\right)\\phi_{i-1}^n\n$$\nThis explicit scheme is second-order accurate in both space and time and is stable under the CFL condition $|\\lambda| \\le 1$. Periodicity is handled by applying modulo arithmetic to the indices, e.g., $\\phi_{-1}^n = \\phi_{N-1}^n$ and $\\phi_N^n = \\phi_0^n$.\n\n**2. Semi-Lagrangian Method**\n\nThis method directly utilizes the method of characteristics. To find the value of the scalar field at a grid point $x_i$ at the new time $t_{n+1}$, we trace the characteristic path backward in time by $\\Delta t$. The departure point, $x_d$, is the location from which a fluid particle originated at time $t_n$ to arrive at $x_i$ at $t_{n+1}$.\n$$\nx_i = x_d + u \\Delta t \\implies x_d = x_i - u \\Delta t\n$$\nSince $\\phi$ is constant along characteristics, we have $\\phi(x_i, t_{n+1}) = \\phi(x_d, t_n)$. The departure point $x_d$ does not generally coincide with a grid point. Therefore, its value must be reconstructed by interpolating from the known grid values at time $t_n$. The problem specifies periodic linear interpolation.\n\nThe discrete update rule for each grid point $i$ is:\n$$\n\\phi_i^{n+1} = \\text{Interpolate}(\\{\\phi_j^n\\}, x_d = x_i - u \\Delta t)\n$$\nThe interpolation must respect the domain's periodicity. If a departure point $x_d$ lies outside $[0, L)$, it is mapped back into the domain, i.e., $x_d' = x_d \\pmod L$. A computationally efficient way to implement this for all grid points simultaneously is to use a numerical library function that supports periodic interpolation. Given the grid points $x_j=j\\Delta x$ and the values $\\phi_j^n$, we need to find the values at the array of departure points $x_{d,i} = x_i - u \\Delta t$.\n\nFor implementation, we can use `numpy.interp`, which supports periodic domains. For a set of query points `xq`, data points `xp`, and function values `fp`, `numpy.interp(xq, xp, fp, period=L)` performs linear interpolation, correctly handling `xq` values outside the range of `xp` by wrapping them around the periodic length `L`. At each time step, the new scalar field is computed as:\n$$\n\\vec{\\phi}^{n+1} = \\text{interp}(\\vec{x} - u\\Delta t, \\vec{x}, \\vec{\\phi}^n, \\text{period}=L)\n$$\nwhere $\\vec{x}$ is the vector of grid point coordinates and $\\vec{\\phi}^n$ is the vector of scalar values at time $t_n$. This scheme is unconditionally stable, as interpolation is a bounded operation. Its accuracy is determined by the order of the interpolation; for linear interpolation, it is first-order in space, though it exhibits much lower numerical diffusion than a standard first-order Eulerian (upwind) scheme.\n\n**Error Calculation**\n\nAfter simulating up to the final time $T=n_t\\Delta t$ with each method, the numerical solution $\\phi_i$ is compared against the exact solution $\\phi_{\\text{exact},i} = \\phi_0((x_i - uT) \\pmod 1)$. The errors are quantified using the specified discrete $L^2$ and $L^\\infty$ norms.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D linear advection equation using two numerical schemes\n    and computes their errors against the exact solution for a suite of test cases.\n    \"\"\"\n\n    def phi_initial(x):\n        \"\"\"\n        Defines the initial condition phi_0(x).\n        \"\"\"\n        return (np.sin(2 * np.pi * x) +\n                0.3 * np.cos(6 * np.pi * x) +\n                0.05 * np.sin(10 * np.pi * x))\n\n    def run_simulation(N, dt, nt):\n        \"\"\"\n        Runs one simulation case for both Eulerian and Semi-Lagrangian methods.\n        \n        Args:\n            N (int): Number of grid points.\n            dt (float): Time step size.\n            nt (int): Number of time steps.\n\n        Returns:\n            tuple: A tuple containing four error metrics:\n                   (E2_eulerian, E2_semi_lagrangian,\n                    E_inf_eulerian, E_inf_semi_lagrangian).\n        \"\"\"\n        # --- Setup ---\n        L = 1.0\n        u = 1.0\n        dx = L / N\n        T = nt * dt\n        lambda_cfl = u * dt / dx\n\n        # Spatial grid (cell centers)\n        x = np.arange(N) * dx\n\n        # --- Initial conditions for both methods ---\n        phi_eul = phi_initial(x)\n        phi_sl = phi_initial(x)\n\n        # --- Time-stepping for Eulerian (Lax-Wendroff) method ---\n        # Coefficients for the Lax-Wendroff scheme\n        c1 = 0.5 * (lambda_cfl**2 - lambda_cfl)\n        c2 = 1.0 - lambda_cfl**2\n        c3 = 0.5 * (lambda_cfl**2 + lambda_cfl)\n\n        for _ in range(nt):\n            phi_eul_ip1 = np.roll(phi_eul, -1)  # phi_{i+1}\n            phi_eul_im1 = np.roll(phi_eul, 1)   # phi_{i-1}\n            phi_eul_new = (c1 * phi_eul_ip1 +\n                           c2 * phi_eul +\n                           c3 * phi_eul_im1)\n            phi_eul = phi_eul_new\n\n        # --- Time-stepping for Semi-Lagrangian method ---\n        for _ in range(nt):\n            # Departure points for all grid locations\n            x_departure = x - u * dt\n            # Interpolate to find values at departure points, with periodic handling\n            phi_sl = np.interp(x_departure, x, phi_sl, period=L)\n\n        # --- Error Calculation ---\n        # Exact solution at time T\n        x_shifted = (x - u * T)\n        phi_exact = phi_initial(x_shifted)\n        \n        # Note: The problem statement uses x mod 1. For x<0, x mod 1 can be negative in some languages.\n        # Python's % operator behaves as a proper modulo for floats,\n        # e.g., -0.2 % 1.0 = 0.8. However, phi_initial is periodic with period 1, so this is robust.\n\n        # Calculate errors for Eulerian method\n        error_eul = phi_eul - phi_exact\n        E2_eul = np.sqrt(np.sum(error_eul**2) * dx)\n        E_inf_eul = np.max(np.abs(error_eul))\n\n        # Calculate errors for Semi-Lagrangian method\n        error_sl = phi_sl - phi_exact\n        E2_sl = np.sqrt(np.sum(error_sl**2) * dx)\n        E_inf_sl = np.max(np.abs(error_sl))\n\n        return E2_eul, E2_sl, E_inf_eul, E_inf_sl\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case A (happy path)\n        (128, 0.002, 250),\n        # Case B (near-CFL boundary)\n        (128, 0.007421875, 67),\n        # Case C (coarse grid)\n        (64, 0.0078125, 64),\n        # Case D (edge case CFL=1)\n        (100, 0.01, 50),\n    ]\n\n    # --- Run all cases and collect results ---\n    results = []\n    for case in test_cases:\n        N, dt, nt = case\n        e2_eul, e2_sl, einf_eul, einf_sl = run_simulation(N, dt, nt)\n        results.extend([e2_eul, e2_sl, einf_eul, einf_sl])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}