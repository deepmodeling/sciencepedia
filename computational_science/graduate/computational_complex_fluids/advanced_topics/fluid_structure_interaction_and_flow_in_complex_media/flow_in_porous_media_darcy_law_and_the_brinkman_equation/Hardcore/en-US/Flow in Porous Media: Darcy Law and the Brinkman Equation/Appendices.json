{
    "hands_on_practices": [
        {
            "introduction": "In idealized models, permeability is often treated as a simple scalar quantity. However, many real porous materials, from geological formations to biological tissues, exhibit direction-dependent properties. This practice introduces the concept of the permeability tensor, $\\boldsymbol{\\kappa}$, to describe such anisotropic media. By working through this problem , you will discover the crucial and often counter-intuitive consequence of anisotropy: the fluid flux vector is generally not aligned with the driving pressure gradient, a fundamental concept for accurately modeling flow in complex structures.",
            "id": "4088095",
            "problem": "A two-dimensional, homogeneous porous medium saturated with a Newtonian, incompressible fluid is subjected to a uniform macroscopic pressure gradient. The medium has a constant, symmetric, positive-definite permeability tensor $\\boldsymbol{\\kappa}$ and the fluid has constant dynamic viscosity $\\mu$. Assume steady, inertia-less flow (creeping flow) and constant porosity, so that upscaling leads to a linear relation between volumetric flux (Darcy velocity) $\\boldsymbol{q}$ and the pressure gradient. For completeness, recall that the Brinkman momentum balance augments Darcy’s linear drag with a viscous diffusion term, but for uniform flows its Laplacian vanishes, reducing to a purely linear drag relation between $\\boldsymbol{q}$ and $\\nabla p$.\n\nConsider an imposed uniform pressure gradient $\\nabla p$ of constant magnitude $G0$. Define the unit driving direction as the direction of $-\\nabla p$, namely $\\boldsymbol{s} = -\\nabla p/\\|\\nabla p\\|$. In a Cartesian basis $\\{\\hat{\\boldsymbol{e}}_{x},\\hat{\\boldsymbol{e}}_{y}\\}$, let $\\boldsymbol{s} = (\\cos\\psi,\\sin\\psi)$ where $\\psi \\in \\mathbb{R}$ is the angle measured counterclockwise from the $x$-axis to the direction of $-\\nabla p$. Let the permeability tensor be\n$$\n\\boldsymbol{\\kappa} \\;=\\; \\begin{pmatrix}\n\\kappa_{xx}  \\kappa_{xy} \\\\\n\\kappa_{xy}  \\kappa_{yy}\n\\end{pmatrix},\n$$\nwith $\\kappa_{xx}0$, $\\kappa_{yy}0$, and $\\kappa_{xx}\\kappa_{yy} - \\kappa_{xy}^{2}  0$.\n\nTasks:\n- Starting from conservation of mass and momentum balance for creeping flow, explain why a uniform pressure gradient produces a uniform Darcy flux and why the Brinkman equation reduces to a Darcy-type linear relation under these conditions.\n- In the isotropic case, where $\\boldsymbol{\\kappa} = \\kappa\\,\\boldsymbol{I}$ with $\\kappa0$, determine whether the volumetric flux $\\boldsymbol{q}$ is aligned with $-\\nabla p$.\n- In the anisotropic case, where $\\boldsymbol{\\kappa}$ is not a scalar multiple of the identity, the flux direction generally deviates from the driving direction. Define the signed deviation angle $\\delta$ as the counterclockwise angle from $\\boldsymbol{s}$ to the flux direction. Derive a closed-form analytic expression for $\\delta$ in terms of $\\kappa_{xx}$, $\\kappa_{xy}$, $\\kappa_{yy}$, and $\\psi$ only. \n\nAnswer specification:\n- Your final answer must be a single closed-form analytic expression for $\\delta$ in terms of $\\kappa_{xx}$, $\\kappa_{xy}$, $\\kappa_{yy}$, and $\\psi$.\n- Express the angle in radians.\n- Do not substitute numerical values or provide intermediate equations in the final answer.",
            "solution": "The problem presents three tasks related to fluid flow in a porous medium, governed by Darcy's law. We shall address each task systematically.\n\nThe first task is to explain the physical and mathematical reasoning behind two key statements: a uniform pressure gradient produces a uniform Darcy flux, and under such conditions, the Brinkman equation reduces to Darcy's law.\nFor an incompressible fluid, conservation of mass is expressed by the continuity equation, which states that the divergence of the volumetric flux $\\boldsymbol{q}$ must be zero:\n$$ \\nabla \\cdot \\boldsymbol{q} = 0 $$\nThe momentum balance for steady, inertia-less (creeping) flow in a homogeneous porous medium is given by Darcy's law, which establishes a linear relationship between the flux $\\boldsymbol{q}$ and the pressure gradient $\\nabla p$:\n$$ \\boldsymbol{q} = -\\frac{1}{\\mu} \\boldsymbol{\\kappa} \\cdot \\nabla p $$\nHere, $\\mu$ is the constant fluid viscosity and $\\boldsymbol{\\kappa}$ is the constant permeability tensor of the medium. The problem states that the pressure gradient $\\nabla p$ is uniform, which means it is a constant vector throughout the domain. Since $\\mu$ and $\\boldsymbol{\\kappa}$ are also constants, the right-hand side of the equation, $-\\frac{1}{\\mu} \\boldsymbol{\\kappa} \\cdot \\nabla p$, evaluates to a constant vector. Consequently, the volumetric flux $\\boldsymbol{q}$ must also be a uniform (constant) vector. A uniform vector field has zero divergence, $\\nabla \\cdot \\boldsymbol{q} = 0$, thus automatically satisfying the continuity equation.\n\nThe steady-state Brinkman equation for momentum conservation augments the Darcy drag term with a macroscopic viscous shear term:\n$$ \\boldsymbol{0} = -\\nabla p - \\mu \\boldsymbol{\\kappa}^{-1} \\cdot \\boldsymbol{q} + \\mu_{\\text{eff}} \\nabla^2 \\boldsymbol{q} $$\nwhere $\\mu_{\\text{eff}}$ is an effective viscosity. As we have established, a uniform pressure gradient in a homogeneous medium leads to a uniform flux $\\boldsymbol{q}$. For a uniform vector field $\\boldsymbol{q}$, its Laplacian, $\\nabla^2 \\boldsymbol{q}$, is identically zero. The Brinkman equation thus simplifies to:\n$$ \\boldsymbol{0} = -\\nabla p - \\mu \\boldsymbol{\\kappa}^{-1} \\cdot \\boldsymbol{q} $$\nRearranging this equation for $\\boldsymbol{q}$ yields $\\mu \\boldsymbol{\\kappa}^{-1} \\cdot \\boldsymbol{q} = -\\nabla p$, which upon left-multiplication by $\\frac{1}{\\mu}\\boldsymbol{\\kappa}$ gives $\\boldsymbol{q} = -\\frac{1}{\\mu} \\boldsymbol{\\kappa} \\cdot \\nabla p$. This is precisely Darcy's law.\n\nThe second task is to analyze the alignment of flux and pressure gradient in the isotropic case.\nIn an isotropic medium, the permeability tensor is a scalar multiple of the identity tensor $\\boldsymbol{I}$:\n$$ \\boldsymbol{\\kappa} = \\kappa \\boldsymbol{I} = \\begin{pmatrix} \\kappa  0 \\\\ 0  \\kappa \\end{pmatrix} $$\nwhere $\\kappa>0$ is the scalar permeability. Substituting this into Darcy's law:\n$$ \\boldsymbol{q} = -\\frac{1}{\\mu} (\\kappa \\boldsymbol{I}) \\cdot \\nabla p = -\\frac{\\kappa}{\\mu} (\\boldsymbol{I} \\cdot \\nabla p) $$\nThe action of the identity tensor on any vector leaves the vector unchanged, so $\\boldsymbol{I} \\cdot \\nabla p = \\nabla p$. The expression for the flux becomes:\n$$ \\boldsymbol{q} = -\\frac{\\kappa}{\\mu} \\nabla p $$\nSince $\\kappa$ and $\\mu$ are positive scalars, the factor $\\frac{\\kappa}{\\mu}$ is positive. This shows that the flux vector $\\boldsymbol{q}$ is a positive scalar multiple of the vector $-\\nabla p$. Therefore, $\\boldsymbol{q}$ is collinear with and points in the same direction as $-\\nabla p$, which is the driving direction $\\boldsymbol{s}$. In the isotropic case, the volumetric flux is always aligned with the driving direction.\n\nThe third task is to derive an expression for the signed deviation angle $\\delta$ between the flux direction and the driving direction in the general anisotropic case.\nThe driving direction is the unit vector $\\boldsymbol{s} = -\\frac{\\nabla p}{\\|\\nabla p\\|} = -\\frac{\\nabla p}{G}$. This gives $\\nabla p = -G \\boldsymbol{s}$. In the Cartesian basis, $\\boldsymbol{s}$ is given by $\\boldsymbol{s} = (\\cos\\psi, \\sin\\psi)$.\nSubstituting $\\nabla p$ into Darcy's law:\n$$ \\boldsymbol{q} = -\\frac{1}{\\mu} \\boldsymbol{\\kappa} \\cdot (-G \\boldsymbol{s}) = \\frac{G}{\\mu} (\\boldsymbol{\\kappa} \\cdot \\boldsymbol{s}) $$\nLet $C = \\frac{G}{\\mu}$ be a positive constant. The flux vector is $\\boldsymbol{q} = C (\\boldsymbol{\\kappa} \\cdot \\boldsymbol{s})$. Let's compute the components of $\\boldsymbol{q}$:\n$$ \\boldsymbol{q} = C \\begin{pmatrix} \\kappa_{xx}  \\kappa_{xy} \\\\ \\kappa_{xy}  \\kappa_{yy} \\end{pmatrix} \\begin{pmatrix} \\cos\\psi \\\\ \\sin\\psi \\end{pmatrix} = C \\begin{pmatrix} \\kappa_{xx}\\cos\\psi + \\kappa_{xy}\\sin\\psi \\\\ \\kappa_{xy}\\cos\\psi + \\kappa_{yy}\\sin\\psi \\end{pmatrix} $$\nThe components are $q_x = C(\\kappa_{xx}\\cos\\psi + \\kappa_{xy}\\sin\\psi)$ and $q_y = C(\\kappa_{xy}\\cos\\psi + \\kappa_{yy}\\sin\\psi)$.\nThe signed deviation angle $\\delta$ is the angle from $\\boldsymbol{s}$ to $\\boldsymbol{q}$. Let $\\theta_q$ be the angle of $\\boldsymbol{q}$ with the $x$-axis. Then $\\delta = \\theta_q - \\psi$. Using the angle subtraction formula for the tangent function:\n$$ \\tan\\delta = \\tan(\\theta_q - \\psi) = \\frac{\\tan\\theta_q - \\tan\\psi}{1 + \\tan\\theta_q \\tan\\psi} $$\nWe have $\\tan\\theta_q = \\frac{q_y}{q_x} = \\frac{\\kappa_{xy}\\cos\\psi + \\kappa_{yy}\\sin\\psi}{\\kappa_{xx}\\cos\\psi + \\kappa_{xy}\\sin\\psi}$ and $\\tan\\psi = \\frac{\\sin\\psi}{\\cos\\psi}$. Substituting these into the formula for $\\tan\\delta$:\n$$ \\tan\\delta = \\frac{\\frac{\\kappa_{xy}\\cos\\psi + \\kappa_{yy}\\sin\\psi}{\\kappa_{xx}\\cos\\psi + \\kappa_{xy}\\sin\\psi} - \\frac{\\sin\\psi}{\\cos\\psi}}{1 + \\left(\\frac{\\kappa_{xy}\\cos\\psi + \\kappa_{yy}\\sin\\psi}{\\kappa_{xx}\\cos\\psi + \\kappa_{xy}\\sin\\psi}\\right)\\left(\\frac{\\sin\\psi}{\\cos\\psi}\\right)} $$\nTo simplify, we multiply the numerator and denominator by $\\cos\\psi (\\kappa_{xx}\\cos\\psi + \\kappa_{xy}\\sin\\psi)$:\nThe numerator becomes:\n$$ (\\cos\\psi)(\\kappa_{xy}\\cos\\psi + \\kappa_{yy}\\sin\\psi) - (\\sin\\psi)(\\kappa_{xx}\\cos\\psi + \\kappa_{xy}\\sin\\psi) \\\\ = \\kappa_{xy}\\cos^2\\psi + \\kappa_{yy}\\sin\\psi\\cos\\psi - \\kappa_{xx}\\sin\\psi\\cos\\psi - \\kappa_{xy}\\sin^2\\psi \\\\ = \\kappa_{xy}(\\cos^2\\psi - \\sin^2\\psi) + (\\kappa_{yy} - \\kappa_{xx})\\sin\\psi\\cos\\psi $$\nUsing the double-angle identities $\\cos(2\\psi) = \\cos^2\\psi - \\sin^2\\psi$ and $\\sin(2\\psi) = 2\\sin\\psi\\cos\\psi$:\n$$ \\text{Numerator} = \\kappa_{xy}\\cos(2\\psi) + \\frac{1}{2}(\\kappa_{yy} - \\kappa_{xx})\\sin(2\\psi) $$\nThe denominator becomes:\n$$ (\\cos\\psi)(\\kappa_{xx}\\cos\\psi + \\kappa_{xy}\\sin\\psi) + (\\sin\\psi)(\\kappa_{xy}\\cos\\psi + \\kappa_{yy}\\sin\\psi) \\\\ = \\kappa_{xx}\\cos^2\\psi + 2\\kappa_{xy}\\sin\\psi\\cos\\psi + \\kappa_{yy}\\sin^2\\psi $$\nUsing the double-angle identities $\\cos^2\\psi = \\frac{1+\\cos(2\\psi)}{2}$, $\\sin^2\\psi = \\frac{1-\\cos(2\\psi)}{2}$, and $\\sin(2\\psi) = 2\\sin\\psi\\cos\\psi$:\n$$ \\text{Denominator} = \\kappa_{xx}\\left(\\frac{1+\\cos(2\\psi)}{2}\\right) + \\kappa_{xy}\\sin(2\\psi) + \\kappa_{yy}\\left(\\frac{1-\\cos(2\\psi)}{2}\\right) \\\\ = \\frac{1}{2}(\\kappa_{xx}+\\kappa_{yy}) + \\frac{1}{2}(\\kappa_{xx}-\\kappa_{yy})\\cos(2\\psi) + \\kappa_{xy}\\sin(2\\psi) $$\nThus, the expression for $\\tan\\delta$ is the ratio of these two results. Multiplying the numerator and denominator by $2$ to clear the fractions gives:\n$$ \\tan\\delta = \\frac{2\\kappa_{xy}\\cos(2\\psi) + (\\kappa_{yy} - \\kappa_{xx})\\sin(2\\psi)}{(\\kappa_{xx} + \\kappa_{yy}) + (\\kappa_{xx} - \\kappa_{yy})\\cos(2\\psi) + 2\\kappa_{xy}\\sin(2\\psi)} $$\nThe signed angle $\\delta$ is the arctangent of this expression.\n\nThe final expression for $\\delta$ is:\n$$ \\delta = \\arctan\\left(\\frac{2\\kappa_{xy}\\cos(2\\psi) + (\\kappa_{yy} - \\kappa_{xx})\\sin(2\\psi)}{(\\kappa_{xx} + \\kappa_{yy}) + (\\kappa_{xx} - \\kappa_{yy})\\cos(2\\psi) + 2\\kappa_{xy}\\sin(2\\psi)}\\right) $$",
            "answer": "$$\n\\boxed{\\arctan\\left(\\frac{2\\kappa_{xy}\\cos(2\\psi) + (\\kappa_{yy} - \\kappa_{xx})\\sin(2\\psi)}{(\\kappa_{xx} + \\kappa_{yy}) + (\\kappa_{xx} - \\kappa_{yy})\\cos(2\\psi) + 2\\kappa_{xy}\\sin(2\\psi)}\\right)}\n$$"
        },
        {
            "introduction": "Beyond anisotropy, another common feature of porous media is heterogeneity, where material properties like permeability vary from point to point. This exercise explores the impact of a spatially varying permeability, $\\kappa(x)$, on a simple one-dimensional flow. By deriving the analytical solution for the pressure field , you will see how heterogeneity transforms the familiar linear pressure profile of homogeneous media into a non-linear one, providing a foundational understanding for flows in functionally graded materials or naturally varying substrates.",
            "id": "4088053",
            "problem": "A one-dimensional porous slab of length $L$ and uniform cross-sectional area is saturated by a steady, incompressible, Newtonian fluid of dynamic viscosity $\\mu$. The macroscopic flow is well-described by Darcy’s law under the assumption that the momentum diffusion term appearing in the Brinkman extension is negligible at the pore scale. The permeability is spatially heterogeneous and varies exponentially along the flow direction: $\\kappa(x) = \\kappa_{0} \\exp\\!\\left(\\gamma \\frac{x}{L}\\right)$, where $\\kappa_{0}  0$ and $\\gamma$ is a dimensionless heterogeneity parameter. The pressure boundary conditions are $p(0) = p_{\\mathrm{in}}$ and $p(L) = p_{\\mathrm{out}}$, with $p_{\\mathrm{in}}  p_{\\mathrm{out}}$. Starting from the one-dimensional form of mass conservation and Darcy’s law as the fundamental base, derive the governing equation for the pressure gradient, integrate it, and impose the boundary conditions to obtain the pressure field. Then, define the dimensionless pressure profile \n$$\\Pi(x) := \\frac{p(x) - p(L)}{p(0) - p(L)}$$ \nand provide a single closed-form analytic expression for $\\Pi(x)$ in terms of $x$, $L$, and $\\gamma$. No numerical substitution is required, and no rounding is necessary. Express the final result symbolically.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in the study of fluid flow through porous media with heterogeneous properties. All necessary information is provided, and the objective is clearly defined.\n\nThe derivation begins with the fundamental principles for steady, one-dimensional, incompressible flow in a porous medium.\n\nThe equation for mass conservation for an incompressible fluid is $\\nabla \\cdot \\mathbf{v} = 0$. In one dimension, this simplifies to:\n$$\n\\frac{d v_x}{dx} = 0\n$$\nwhere $v_x$ is the Darcy velocity (or superficial velocity) in the $x$-direction. This equation implies that $v_x$ must be a constant along the flow path. Let us denote this constant Darcy flux as $q_0$.\n$$\nv_x = q_0\n$$\n\nThe flow is described by Darcy's law, which in one dimension is:\n$$\nv_x = -\\frac{\\kappa(x)}{\\mu} \\frac{dp}{dx}\n$$\nwhere $\\kappa(x)$ is the spatially varying permeability, $\\mu$ is the dynamic viscosity of the fluid, and $\\frac{dp}{dx}$ is the pressure gradient.\n\nCombining the continuity equation and Darcy's law, we have:\n$$\nq_0 = -\\frac{\\kappa(x)}{\\mu} \\frac{dp}{dx}\n$$\nThis can be rearranged to express the pressure gradient:\n$$\n\\frac{dp}{dx} = -\\frac{q_0 \\mu}{\\kappa(x)}\n$$\nThis is the governing equation for the pressure gradient, where $q_0$ is an unknown constant. The problem provides the functional form of the permeability:\n$$\n\\kappa(x) = \\kappa_{0} \\exp\\left(\\gamma \\frac{x}{L}\\right)\n$$\nSubstituting this into the equation for the pressure gradient gives:\n$$\n\\frac{dp}{dx} = -\\frac{q_0 \\mu}{\\kappa_{0} \\exp\\left(\\gamma \\frac{x}{L}\\right)} = -\\frac{q_0 \\mu}{\\kappa_{0}} \\exp\\left(-\\gamma \\frac{x}{L}\\right)\n$$\nTo find the pressure field $p(x)$, we integrate this ordinary differential equation with respect to $x$. We must consider two cases for the parameter $\\gamma$.\n\nCase 1: $\\gamma \\neq 0$.\nIntegration yields:\n$$\np(x) = \\int \\left(-\\frac{q_0 \\mu}{\\kappa_{0}}\\right) \\exp\\left(-\\gamma \\frac{x}{L}\\right) dx = \\left(-\\frac{q_0 \\mu}{\\kappa_{0}}\\right) \\frac{1}{-\\gamma/L} \\exp\\left(-\\gamma \\frac{x}{L}\\right) + C\n$$\n$$\np(x) = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp\\left(-\\gamma \\frac{x}{L}\\right) + C\n$$\nwhere $C$ is the constant of integration. We have two unknown constants, $q_0$ and $C$, which can be determined from the two pressure boundary conditions: $p(0) = p_{\\mathrm{in}}$ and $p(L) = p_{\\mathrm{out}}$.\n\nApplying the boundary condition at $x=0$:\n$$\np(0) = p_{\\mathrm{in}} = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp(0) + C = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} + C\n$$\n\nApplying the boundary condition at $x=L$:\n$$\np(L) = p_{\\mathrm{out}} = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp\\left(-\\gamma \\frac{L}{L}\\right) + C = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp(-\\gamma) + C\n$$\n\nWe now have a system of two linear equations for the two unknowns. Subtracting the second equation from the first eliminates $C$:\n$$\np_{\\mathrm{in}} - p_{\\mathrm{out}} = \\left(\\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} + C\\right) - \\left(\\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp(-\\gamma) + C\\right)\n$$\n$$\np_{\\mathrm{in}} - p_{\\mathrm{out}} = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\left(1 - \\exp(-\\gamma)\\right)\n$$\nWe can solve for the constant group $\\frac{q_0 \\mu L}{\\kappa_{0} \\gamma}$:\n$$\n\\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} = \\frac{p_{\\mathrm{in}} - p_{\\mathrm{out}}}{1 - \\exp(-\\gamma)}\n$$\nNow, we can find $C$ by substituting this result back into the equation for $p_{\\mathrm{in}}$:\n$$\nC = p_{\\mathrm{in}} - \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} = p_{\\mathrm{in}} - \\frac{p_{\\mathrm{in}} - p_{\\mathrm{out}}}{1 - \\exp(-\\gamma)}\n$$\nSubstituting the expressions for the constant group and $C$ back into the equation for $p(x)$:\n$$\np(x) = \\left(\\frac{p_{\\mathrm{in}} - p_{\\mathrm{out}}}{1 - \\exp(-\\gamma)}\\right)\\exp\\left(-\\gamma \\frac{x}{L}\\right) + p_{\\mathrm{in}} - \\frac{p_{\\mathrm{in}} - p_{\\mathrm{out}}}{1 - \\exp(-\\gamma)}\n$$\nThe problem asks for the dimensionless pressure profile $\\Pi(x)$, defined as:\n$$\n\\Pi(x) := \\frac{p(x) - p(L)}{p(0) - p(L)} = \\frac{p(x) - p_{\\mathrm{out}}}{p_{\\mathrm{in}} - p_{\\mathrm{out}}}\n$$\nTo find this, let's rearrange our expression for $p(x)$. A simpler path is to use the intermediate expression for $p(x)$ and solve for $p(x) - p_{\\mathrm{out}}$.\nFrom the boundary condition at $x=L$, we have $C = p_{\\mathrm{out}} - \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp(-\\gamma)$.\nSubstituting this for $C$ in the general solution for $p(x)$:\n$$\np(x) = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp\\left(-\\gamma \\frac{x}{L}\\right) + p_{\\mathrm{out}} - \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp(-\\gamma)\n$$\n$$\np(x) - p_{\\mathrm{out}} = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\left(\\exp\\left(-\\gamma \\frac{x}{L}\\right) - \\exp(-\\gamma)\\right)\n$$\nNow substitute the expression we found for the constant group $\\frac{q_0 \\mu L}{\\kappa_{0} \\gamma}$:\n$$\np(x) - p_{\\mathrm{out}} = \\left(\\frac{p_{\\mathrm{in}} - p_{\\mathrm{out}}}{1 - \\exp(-\\gamma)}\\right) \\left(\\exp\\left(-\\gamma \\frac{x}{L}\\right) - \\exp(-\\gamma)\\right)\n$$\nDividing by $(p_{\\mathrm{in}} - p_{\\mathrm{out}})$ gives the dimensionless pressure profile $\\Pi(x)$:\n$$\n\\Pi(x) = \\frac{p(x) - p_{\\mathrm{out}}}{p_{\\mathrm{in}} - p_{\\mathrm{out}}} = \\frac{\\exp\\left(-\\gamma \\frac{x}{L}\\right) - \\exp(-\\gamma)}{1 - \\exp(-\\gamma)}\n$$\nThis expression can be algebraically simplified by multiplying the numerator and denominator by $\\exp(\\gamma)$:\n$$\n\\Pi(x) = \\frac{\\exp\\left(-\\gamma \\frac{x}{L}\\right)\\exp(\\gamma) - \\exp(-\\gamma)\\exp(\\gamma)}{1 \\cdot \\exp(\\gamma) - \\exp(-\\gamma)\\exp(\\gamma)} = \\frac{\\exp\\left(\\gamma - \\gamma\\frac{x}{L}\\right) - \\exp(0)}{\\exp(\\gamma) - \\exp(0)}\n$$\n$$\n\\Pi(x) = \\frac{\\exp\\left(\\gamma\\left(1 - \\frac{x}{L}\\right)\\right) - 1}{\\exp(\\gamma) - 1}\n$$\n\nCase 2: $\\gamma = 0$.\nIn this case, the permeability is constant, $\\kappa(x) = \\kappa_0$. The pressure gradient is constant:\n$$\n\\frac{dp}{dx} = -\\frac{q_0 \\mu}{\\kappa_0}\n$$\nThe pressure profile is linear: $p(x) = -\\frac{q_0 \\mu}{\\kappa_0} x + p_{\\mathrm{in}}$.\nUsing $p(L) = p_{\\mathrm{out}}$, we get $p_{\\mathrm{out}} = -\\frac{q_0 \\mu L}{\\kappa_0} + p_{\\mathrm{in}}$, which gives $\\frac{q_0 \\mu}{\\kappa_0} = \\frac{p_{\\mathrm{in}}-p_{\\mathrm{out}}}{L}$.\nSo, $p(x) = -\\frac{p_{\\mathrm{in}}-p_{\\mathrm{out}}}{L}x + p_{\\mathrm{in}}$.\nThe dimensionless pressure is:\n$$\n\\Pi(x) = \\frac{p(x) - p_{\\mathrm{out}}}{p_{\\mathrm{in}} - p_{\\mathrm{out}}} = \\frac{(-\\frac{p_{\\mathrm{in}}-p_{\\mathrm{out}}}{L}x + p_{\\mathrm{in}}) - p_{\\mathrm{out}}}{p_{\\mathrm{in}} - p_{\\mathrm{out}}} = \\frac{(p_{\\mathrm{in}}-p_{\\mathrm{out}})(1-\\frac{x}{L})}{p_{\\mathrm{in}} - p_{\\mathrm{out}}} = 1 - \\frac{x}{L}\n$$\nThis result can be recovered from our general expression for $\\Pi(x)$ by taking the limit as $\\gamma \\to 0$ using L'Hôpital's rule:\n$$\n\\lim_{\\gamma \\to 0} \\Pi(x) = \\lim_{\\gamma \\to 0} \\frac{\\frac{d}{d\\gamma}\\left(\\exp\\left(\\gamma\\left(1 - \\frac{x}{L}\\right)\\right) - 1\\right)}{\\frac{d}{d\\gamma}(\\exp(\\gamma) - 1)} = \\lim_{\\gamma \\to 0} \\frac{\\left(1 - \\frac{x}{L}\\right)\\exp\\left(\\gamma\\left(1 - \\frac{x}{L}\\right)\\right)}{\\exp(\\gamma)} = 1 - \\frac{x}{L}\n$$\nThus, the expression derived for $\\gamma \\neq 0$ is general, as its limit at $\\gamma=0$ gives the correct result for the homogeneous case. The single closed-form expression is valid for all $\\gamma$.\nThe final expression for $\\Pi(x)$ is therefore:\n$$\n\\Pi(x) = \\frac{\\exp\\left(\\gamma\\left(1 - \\frac{x}{L}\\right)\\right) - 1}{\\exp(\\gamma) - 1}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\exp\\left(\\gamma\\left(1 - \\frac{x}{L}\\right)\\right) - 1}{\\exp(\\gamma) - 1}}\n$$"
        },
        {
            "introduction": "The transition from analytical models to computational simulation is a cornerstone of modern engineering and science, but it demands rigorous code verification. The Method of Manufactured Solutions (MMS) is an indispensable technique for this, allowing us to create a benchmark problem with a known analytical solution to test the accuracy of a numerical solver. This practice  will guide you through the process of designing a manufactured solution for the Brinkman equations, equipping you with a critical skill for developing and validating reliable computational fluid dynamics codes for porous media.",
            "id": "4088060",
            "problem": "Consider a two-dimensional, steady, incompressible flow of a Newtonian fluid through a homogeneous porous medium on the nondimensional unit square domain $\\Omega = (0,1) \\times (0,1)$. Starting from the following fundamental bases:\n\n- Linear momentum conservation for very low Reynolds number flow (neglecting inertia), with the stress divergence, a linear volumetric drag proportional to velocity, and a pressure gradient driving term.\n- Incompressibility, i.e., the continuity constraint enforcing solenoidality of the velocity field.\n- For a Newtonian fluid with constant effective viscosity $\\mu_{e}  0$, the Cauchy stress reduces to a pressure term and a viscous term proportional to the rate-of-strain tensor.\n\nUse the idea of the Method of Manufactured Solutions (MMS) to construct a smooth, divergence-free velocity and a pressure field on $\\Omega$, then determine the volumetric body force $\\mathbf{f}$ that makes the chosen fields satisfy the governing equations with the above physics. Take the nondimensional Brinkman operator to be the sum of the viscous term and the linear Darcy drag term, and assume that the porous drag coefficient is $\\kappa^{-1}$ with $\\kappa  0$ given. You must:\n\n- Choose a twice-continuously differentiable exact velocity field $\\mathbf{u}^{\\star}(x,y)$ that is exactly divergence-free, and a smooth pressure field $p^{\\star}(x,y)$ whose spatial mean over $\\Omega$ is zero.\n- Derive the forcing $\\mathbf{f}(x,y)$ implied by your choice, starting from the stated physical principles.\n- State the boundary conditions on $\\partial \\Omega$ that render your manufactured fields an exact solution.\n- Assume nondimensional variables throughout; no physical units are required in the final expressions.\n\nFor reproducibility, use the specific exact solution ansatz\n$\\mathbf{u}^{\\star}(x,y) = \\big(u_{x}(x,y), u_{y}(x,y)\\big)$ with $u_{x}(x,y) = \\pi \\cos(\\pi y)\\,\\sin(\\pi x)$ and $u_{y}(x,y) = -\\pi \\cos(\\pi x)\\,\\sin(\\pi y)$, and $p^{\\star}(x,y) = \\sin(2\\pi x)\\,\\cos(\\pi y)$ on $\\Omega$. Here $\\pi$ is the circular constant. Treat $\\mu_{e}  0$ and $\\kappa  0$ as given constants.\n\nProvide the final answer as a single closed-form analytic expression collecting, in order, the components $u_{x}(x,y)$, $u_{y}(x,y)$, $p^{\\star}(x,y)$, $f_{x}(x,y)$, and $f_{y}(x,y)$ in one row matrix. No numerical evaluation is required. Round nothing. No units should be included in the final expression. State the boundary conditions in your derivation, but do not include them in the final boxed expression.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded, well-posed, objective, and complete. It constitutes a standard application of the Method of Manufactured Solutions (MMS) to the steady-state Brinkman equations for flow in a porous medium.\n\nThe physical principles stated in the problem lead to the steady, incompressible Brinkman equations. The linear momentum conservation equation for a Newtonian fluid at very low Reynolds numbers, including pressure gradient, viscous stresses, a linear drag term, and a body force, is given by:\n$$-\\nabla p + \\nabla \\cdot (\\mu_e (\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)) - \\kappa^{-1} \\mathbf{u} + \\mathbf{f} = \\mathbf{0}$$\nwhere $\\mathbf{u}$ is the velocity field, $p$ is the pressure, $\\mu_e  0$ is the constant effective viscosity, $\\kappa^{-1}  0$ is the porous drag coefficient, and $\\mathbf{f}$ is the volumetric body force. The continuity equation for an incompressible fluid is:\n$$\\nabla \\cdot \\mathbf{u} = 0$$\nUsing the identity $\\nabla \\cdot (\\nabla \\mathbf{u})^T = \\nabla(\\nabla \\cdot \\mathbf{u})$ and the incompressibility condition $\\nabla \\cdot \\mathbf{u} = 0$, the viscous term simplifies to $\\mu_e \\nabla \\cdot (\\nabla \\mathbf{u}) = \\mu_e \\nabla^2 \\mathbf{u}$. The momentum equation thus becomes:\n$$-\\nabla p + \\mu_e \\nabla^2 \\mathbf{u} - \\kappa^{-1} \\mathbf{u} + \\mathbf{f} = \\mathbf{0}$$\nThe objective of the Method of Manufactured Solutions is to find the forcing term $\\mathbf{f}(x,y)$ that makes a chosen set of fields, $\\mathbf{u}^{\\star}(x,y)$ and $p^{\\star}(x,y)$, an exact solution to these governing equations. By substituting the manufactured solution into the momentum equation, we can solve for $\\mathbf{f}$:\n$$\\mathbf{f} = \\nabla p^{\\star} - \\mu_e \\nabla^2 \\mathbf{u}^{\\star} + \\kappa^{-1} \\mathbf{u}^{\\star}$$\nThe problem provides the specific ansatz for the velocity and pressure fields on the domain $\\Omega = (0,1) \\times (0,1)$:\n$$u_{x}^{\\star}(x,y) = \\pi \\cos(\\pi y)\\,\\sin(\\pi x)$$\n$$u_{y}^{\\star}(x,y) = -\\pi \\cos(\\pi x)\\,\\sin(\\pi y)$$\n$$p^{\\star}(x,y) = \\sin(2\\pi x)\\,\\cos(\\pi y)$$\nWe must first verify that the given fields satisfy the stated prerequisites.\n\nFirst, we check if the velocity field $\\mathbf{u}^{\\star} = (u_x^{\\star}, u_y^{\\star})$ is divergence-free:\n$$\\frac{\\partial u_{x}^{\\star}}{\\partial x} = \\frac{\\partial}{\\partial x} (\\pi \\cos(\\pi y)\\,\\sin(\\pi x)) = \\pi^2 \\cos(\\pi y)\\,\\cos(\\pi x)$$\n$$\\frac{\\partial u_{y}^{\\star}}{\\partial y} = \\frac{\\partial}{\\partial y} (-\\pi \\cos(\\pi x)\\,\\sin(\\pi y)) = -\\pi^2 \\cos(\\pi x)\\,\\cos(\\pi y)$$\nThe divergence is:\n$$\\nabla \\cdot \\mathbf{u}^{\\star} = \\frac{\\partial u_{x}^{\\star}}{\\partial x} + \\frac{\\partial u_{y}^{\\star}}{\\partial y} = \\pi^2 \\cos(\\pi y)\\,\\cos(\\pi x) - \\pi^2 \\cos(\\pi x)\\,\\cos(\\pi y) = 0$$\nThe velocity field is indeed solenoidal.\n\nSecond, we check if the pressure field $p^{\\star}$ has a zero spatial mean over $\\Omega$:\n$$\\bar{p}^{\\star} = \\int_{0}^{1}\\int_{0}^{1} p^{\\star}(x,y) \\,dx\\,dy = \\int_{0}^{1}\\int_{0}^{1} \\sin(2\\pi x)\\cos(\\pi y) \\,dx\\,dy$$\n$$\\bar{p}^{\\star} = \\left(\\int_{0}^{1} \\sin(2\\pi x) \\,dx\\right) \\left(\\int_{0}^{1} \\cos(\\pi y) \\,dy\\right)$$\nThe integral with respect to $x$ is:\n$$\\int_{0}^{1} \\sin(2\\pi x) \\,dx = \\left[-\\frac{\\cos(2\\pi x)}{2\\pi}\\right]_0^1 = -\\frac{1}{2\\pi}(\\cos(2\\pi) - \\cos(0)) = -\\frac{1}{2\\pi}(1-1) = 0$$\nSince one of the factors is $0$, the total integral is $0$. The pressure field has a zero spatial mean.\n\nNow, we compute the terms required for the forcing function $\\mathbf{f} = (f_x, f_y)$.\n\nThe pressure gradient $\\nabla p^{\\star}$ is:\n$$\\frac{\\partial p^{\\star}}{\\partial x} = \\frac{\\partial}{\\partial x}(\\sin(2\\pi x)\\cos(\\pi y)) = 2\\pi \\cos(2\\pi x)\\cos(\\pi y)$$\n$$\\frac{\\partial p^{\\star}}{\\partial y} = \\frac{\\partial}{\\partial y}(\\sin(2\\pi x)\\cos(\\pi y)) = -\\pi \\sin(2\\pi x)\\sin(\\pi y)$$\n\nThe Laplacian of the velocity field, $\\nabla^2 \\mathbf{u}^{\\star} = (\\nabla^2 u_x^{\\star}, \\nabla^2 u_y^{\\star})$, is computed next.\nFor the $x$-component, $u_x^{\\star}$:\n$$\\frac{\\partial^2 u_x^{\\star}}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2}(\\pi \\cos(\\pi y)\\sin(\\pi x)) = -\\pi^3 \\cos(\\pi y)\\sin(\\pi x)$$\n$$\\frac{\\partial^2 u_x^{\\star}}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2}(\\pi \\cos(\\pi y)\\sin(\\pi x)) = -\\pi^3 \\cos(\\pi y)\\sin(\\pi x)$$\n$$\\nabla^2 u_x^{\\star} = \\frac{\\partial^2 u_x^{\\star}}{\\partial x^2} + \\frac{\\partial^2 u_x^{\\star}}{\\partial y^2} = -2\\pi^3 \\cos(\\pi y)\\sin(\\pi x) = -2\\pi^2 u_x^{\\star}$$\nFor the $y$-component, $u_y^{\\star}$:\n$$\\frac{\\partial^2 u_y^{\\star}}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2}(-\\pi \\cos(\\pi x)\\sin(\\pi y)) = \\pi^3 \\cos(\\pi x)\\sin(\\pi y)$$\n$$\\frac{\\partial^2 u_y^{\\star}}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2}(-\\pi \\cos(\\pi x)\\sin(\\pi y)) = \\pi^3 \\cos(\\pi x)\\sin(\\pi y)$$\n$$\\nabla^2 u_y^{\\star} = \\frac{\\partial^2 u_y^{\\star}}{\\partial x^2} + \\frac{\\partial^2 u_y^{\\star}}{\\partial y^2} = 2\\pi^3 \\cos(\\pi x)\\sin(\\pi y) = -2\\pi^2 u_y^{\\star}$$\n\nNow we assemble the components of the forcing term $\\mathbf{f}$:\n$$f_x = \\frac{\\partial p^{\\star}}{\\partial x} - \\mu_e \\nabla^2 u_x^{\\star} + \\kappa^{-1} u_x^{\\star}$$\n$$f_x(x,y) = 2\\pi \\cos(2\\pi x)\\cos(\\pi y) - \\mu_e(-2\\pi^2 u_x^{\\star}) + \\kappa^{-1} u_x^{\\star}$$\n$$f_x(x,y) = 2\\pi \\cos(2\\pi x)\\cos(\\pi y) + (2\\pi^2 \\mu_e + \\kappa^{-1})u_x^{\\star}$$\nSubstituting the expression for $u_x^{\\star}$:\n$$f_x(x,y) = 2\\pi \\cos(2\\pi x)\\cos(\\pi y) + (2\\pi^2 \\mu_e + \\kappa^{-1})\\pi \\cos(\\pi y)\\sin(\\pi x)$$\n\n$$f_y = \\frac{\\partial p^{\\star}}{\\partial y} - \\mu_e \\nabla^2 u_y^{\\star} + \\kappa^{-1} u_y^{\\star}$$\n$$f_y(x,y) = -\\pi \\sin(2\\pi x)\\sin(\\pi y) - \\mu_e(-2\\pi^2 u_y^{\\star}) + \\kappa^{-1} u_y^{\\star}$$\n$$f_y(x,y) = -\\pi \\sin(2\\pi x)\\sin(\\pi y) + (2\\pi^2 \\mu_e + \\kappa^{-1})u_y^{\\star}$$\nSubstituting the expression for $u_y^{\\star}$:\n$$f_y(x,y) = -\\pi \\sin(2\\pi x)\\sin(\\pi y) + (2\\pi^2 \\mu_e + \\kappa^{-1})(-\\pi \\cos(\\pi x)\\sin(\\pi y))$$\n$$f_y(x,y) = -\\pi \\sin(2\\pi x)\\sin(\\pi y) - (2\\pi^2 \\mu_e + \\kappa^{-1})\\pi \\cos(\\pi x)\\sin(\\pi y)$$\n\nFinally, to ensure that $\\mathbf{u}^{\\star}$ and $p^{\\star}$ constitute an exact solution, we must impose boundary conditions on $\\partial \\Omega$ that are satisfied by these fields. The appropriate conditions are Dirichlet boundary conditions:\n$$\\mathbf{u}(x,y) = \\mathbf{u}^{\\star}(x,y) \\quad \\forall (x,y) \\in \\partial\\Omega$$\n$$p(x,y) = p^{\\star}(x,y) \\quad \\forall (x,y) \\in \\partial\\Omega$$\nSpecifically, for $x, y \\in [0,1]$:\n- On $y=0$: $\\mathbf{u}(x,0) = (\\pi\\sin(\\pi x), 0)$, $p(x,0) = \\sin(2\\pi x)$\n- On $y=1$: $\\mathbf{u}(x,1) = (-\\pi\\sin(\\pi x), 0)$, $p(x,1) = -\\sin(2\\pi x)$\n- On $x=0$: $\\mathbf{u}(0,y) = (0, -\\pi\\sin(\\pi y))$, $p(0,y) = 0$\n- On $x=1$: $\\mathbf{u}(1,y) = (0, \\pi\\sin(\\pi y))$, $p(1,y) = 0$\n\nThe final answer requires the components $u_x(x,y)$, $u_y(x,y)$, $p^{\\star}(x,y)$, $f_x(x,y)$, and $f_y(x,y)$ collected in a row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\pi \\cos(\\pi y)\\sin(\\pi x)  -\\pi \\cos(\\pi x)\\sin(\\pi y)  \\sin(2\\pi x)\\cos(\\pi y)  2\\pi \\cos(2\\pi x)\\cos(\\pi y) + \\pi(2\\pi^2 \\mu_e + \\kappa^{-1}) \\cos(\\pi y)\\sin(\\pi x)  -\\pi \\sin(2\\pi x)\\sin(\\pi y) - \\pi(2\\pi^2 \\mu_e + \\kappa^{-1}) \\cos(\\pi x)\\sin(\\pi y)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}