{
    "hands_on_practices": [
        {
            "introduction": "Understanding fluid flow in porous media often begins with Darcy's law, which predicts a linear pressure drop in homogeneous materials. This exercise  challenges you to explore a more realistic scenario where the permeability $\\kappa(x)$ varies spatially. By analytically solving for the pressure field in a medium with exponentially varying permeability, you will gain a deeper intuition for how material heterogeneity governs the flow and pressure distribution.",
            "id": "4088053",
            "problem": "A one-dimensional porous slab of length $L$ and uniform cross-sectional area is saturated by a steady, incompressible, Newtonian fluid of dynamic viscosity $\\mu$. The macroscopic flow is well-described by Darcy’s law under the assumption that the momentum diffusion term appearing in the Brinkman extension is negligible at the pore scale. The permeability is spatially heterogeneous and varies exponentially along the flow direction: $\\kappa(x) = \\kappa_{0} \\exp\\!\\left(\\gamma \\frac{x}{L}\\right)$, where $\\kappa_{0} > 0$ and $\\gamma$ is a dimensionless heterogeneity parameter. The pressure boundary conditions are $p(0) = p_{\\mathrm{in}}$ and $p(L) = p_{\\mathrm{out}}$, with $p_{\\mathrm{in}} > p_{\\mathrm{out}}$. Starting from the one-dimensional form of mass conservation and Darcy’s law as the fundamental base, derive the governing equation for the pressure gradient, integrate it, and impose the boundary conditions to obtain the pressure field. Then, define the dimensionless pressure profile \n$$\\Pi(x) := \\frac{p(x) - p(L)}{p(0) - p(L)}$$ \nand provide a single closed-form analytic expression for $\\Pi(x)$ in terms of $x$, $L$, and $\\gamma$. No numerical substitution is required, and no rounding is necessary. Express the final result symbolically.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in the study of fluid flow through porous media with heterogeneous properties. All necessary information is provided, and the objective is clearly defined.\n\nThe derivation begins with the fundamental principles for steady, one-dimensional, incompressible flow in a porous medium.\n\nThe equation for mass conservation for an incompressible fluid is $\\nabla \\cdot \\mathbf{v} = 0$. In one dimension, this simplifies to:\n$$\n\\frac{d v_x}{dx} = 0\n$$\nwhere $v_x$ is the Darcy velocity (or superficial velocity) in the $x$-direction. This equation implies that $v_x$ must be a constant along the flow path. Let us denote this constant Darcy flux as $q_0$.\n$$\nv_x = q_0\n$$\n\nThe flow is described by Darcy's law, which in one dimension is:\n$$\nv_x = -\\frac{\\kappa(x)}{\\mu} \\frac{dp}{dx}\n$$\nwhere $\\kappa(x)$ is the spatially varying permeability, $\\mu$ is the dynamic viscosity of the fluid, and $\\frac{dp}{dx}$ is the pressure gradient.\n\nCombining the continuity equation and Darcy's law, we have:\n$$\nq_0 = -\\frac{\\kappa(x)}{\\mu} \\frac{dp}{dx}\n$$\nThis can be rearranged to express the pressure gradient:\n$$\n\\frac{dp}{dx} = -\\frac{q_0 \\mu}{\\kappa(x)}\n$$\nThis is the governing equation for the pressure gradient, where $q_0$ is an unknown constant. The problem provides the functional form of the permeability:\n$$\n\\kappa(x) = \\kappa_{0} \\exp\\left(\\gamma \\frac{x}{L}\\right)\n$$\nSubstituting this into the equation for the pressure gradient gives:\n$$\n\\frac{dp}{dx} = -\\frac{q_0 \\mu}{\\kappa_{0} \\exp\\left(\\gamma \\frac{x}{L}\\right)} = -\\frac{q_0 \\mu}{\\kappa_{0}} \\exp\\left(-\\gamma \\frac{x}{L}\\right)\n$$\nTo find the pressure field $p(x)$, we integrate this ordinary differential equation with respect to $x$. We must consider two cases for the parameter $\\gamma$.\n\nCase 1: $\\gamma \\neq 0$.\nIntegration yields:\n$$\np(x) = \\int \\left(-\\frac{q_0 \\mu}{\\kappa_{0}}\\right) \\exp\\left(-\\gamma \\frac{x}{L}\\right) dx = \\left(-\\frac{q_0 \\mu}{\\kappa_{0}}\\right) \\frac{1}{-\\gamma/L} \\exp\\left(-\\gamma \\frac{x}{L}\\right) + C\n$$\n$$\np(x) = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp\\left(-\\gamma \\frac{x}{L}\\right) + C\n$$\nwhere $C$ is the constant of integration. We have two unknown constants, $q_0$ and $C$, which can be determined from the two pressure boundary conditions: $p(0) = p_{\\mathrm{in}}$ and $p(L) = p_{\\mathrm{out}}$.\n\nApplying the boundary condition at $x=0$:\n$$\np(0) = p_{\\mathrm{in}} = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp(0) + C = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} + C\n$$\n\nApplying the boundary condition at $x=L$:\n$$\np(L) = p_{\\mathrm{out}} = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp\\left(-\\gamma \\frac{L}{L}\\right) + C = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp(-\\gamma) + C\n$$\n\nWe now have a system of two linear equations for the two unknowns. Subtracting the second equation from the first eliminates $C$:\n$$\np_{\\mathrm{in}} - p_{\\mathrm{out}} = \\left(\\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} + C\\right) - \\left(\\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp(-\\gamma) + C\\right)\n$$\n$$\np_{\\mathrm{in}} - p_{\\mathrm{out}} = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\left(1 - \\exp(-\\gamma)\\right)\n$$\nWe can solve for the constant group $\\frac{q_0 \\mu L}{\\kappa_{0} \\gamma}$:\n$$\n\\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} = \\frac{p_{\\mathrm{in}} - p_{\\mathrm{out}}}{1 - \\exp(-\\gamma)}\n$$\nNow, we can find $C$ by substituting this result back into the equation for $p_{\\mathrm{in}}$:\n$$\nC = p_{\\mathrm{in}} - \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} = p_{\\mathrm{in}} - \\frac{p_{\\mathrm{in}} - p_{\\mathrm{out}}}{1 - \\exp(-\\gamma)}\n$$\nSubstituting the expressions for the constant group and $C$ back into the equation for $p(x)$:\n$$\np(x) = \\left(\\frac{p_{\\mathrm{in}} - p_{\\mathrm{out}}}{1 - \\exp(-\\gamma)}\\right)\\exp\\left(-\\gamma \\frac{x}{L}\\right) + p_{\\mathrm{in}} - \\frac{p_{\\mathrm{in}} - p_{\\mathrm{out}}}{1 - \\exp(-\\gamma)}\n$$\nThe problem asks for the dimensionless pressure profile $\\Pi(x)$, defined as:\n$$\n\\Pi(x) := \\frac{p(x) - p(L)}{p(0) - p(L)} = \\frac{p(x) - p_{\\mathrm{out}}}{p_{\\mathrm{in}} - p_{\\mathrm{out}}}\n$$\nTo find this, let's rearrange our expression for $p(x)$. A simpler path is to use the intermediate expression for $p(x)$ and solve for $p(x) - p_{\\mathrm{out}}$.\nFrom the boundary condition at $x=L$, we have $C = p_{\\mathrm{out}} - \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp(-\\gamma)$.\nSubstituting this for $C$ in the general solution for $p(x)$:\n$$\np(x) = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp\\left(-\\gamma \\frac{x}{L}\\right) + p_{\\mathrm{out}} - \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\exp(-\\gamma)\n$$\n$$\np(x) - p_{\\mathrm{out}} = \\frac{q_0 \\mu L}{\\kappa_{0} \\gamma} \\left(\\exp\\left(-\\gamma \\frac{x}{L}\\right) - \\exp(-\\gamma)\\right)\n$$\nNow substitute the expression we found for the constant group $\\frac{q_0 \\mu L}{\\kappa_{0} \\gamma}$:\n$$\np(x) - p_{\\mathrm{out}} = \\left(\\frac{p_{\\mathrm{in}} - p_{\\mathrm{out}}}{1 - \\exp(-\\gamma)}\\right) \\left(\\exp\\left(-\\gamma \\frac{x}{L}\\right) - \\exp(-\\gamma)\\right)\n$$\nDividing by $(p_{\\mathrm{in}} - p_{\\mathrm{out}})$ gives the dimensionless pressure profile $\\Pi(x)$:\n$$\n\\Pi(x) = \\frac{p(x) - p_{\\mathrm{out}}}{p_{\\mathrm{in}} - p_{\\mathrm{out}}} = \\frac{\\exp\\left(-\\gamma \\frac{x}{L}\\right) - \\exp(-\\gamma)}{1 - \\exp(-\\gamma)}\n$$\nThis expression can be algebraically simplified by multiplying the numerator and denominator by $\\exp(\\gamma)$:\n$$\n\\Pi(x) = \\frac{\\exp\\left(-\\gamma \\frac{x}{L}\\right)\\exp(\\gamma) - \\exp(-\\gamma)\\exp(\\gamma)}{1 \\cdot \\exp(\\gamma) - \\exp(-\\gamma)\\exp(\\gamma)} = \\frac{\\exp\\left(\\gamma - \\gamma\\frac{x}{L}\\right) - \\exp(0)}{\\exp(\\gamma) - \\exp(0)}\n$$\n$$\n\\Pi(x) = \\frac{\\exp\\left(\\gamma\\left(1 - \\frac{x}{L}\\right)\\right) - 1}{\\exp(\\gamma) - 1}\n$$\n\nCase 2: $\\gamma = 0$.\nIn this case, the permeability is constant, $\\kappa(x) = \\kappa_0$. The pressure gradient is constant:\n$$\n\\frac{dp}{dx} = -\\frac{q_0 \\mu}{\\kappa_0}\n$$\nThe pressure profile is linear: $p(x) = -\\frac{q_0 \\mu}{\\kappa_0} x + p_{\\mathrm{in}}$.\nUsing $p(L) = p_{\\mathrm{out}}$, we get $p_{\\mathrm{out}} = -\\frac{q_0 \\mu L}{\\kappa_0} + p_{\\mathrm{in}}$, which gives $\\frac{q_0 \\mu}{\\kappa_0} = \\frac{p_{\\mathrm{in}}-p_{\\mathrm{out}}}{L}$.\nSo, $p(x) = -\\frac{p_{\\mathrm{in}}-p_{\\mathrm{out}}}{L}x + p_{\\mathrm{in}}$.\nThe dimensionless pressure is:\n$$\n\\Pi(x) = \\frac{p(x) - p_{\\mathrm{out}}}{p_{\\mathrm{in}} - p_{\\mathrm{out}}} = \\frac{(-\\frac{p_{\\mathrm{in}}-p_{\\mathrm{out}}}{L}x + p_{\\mathrm{in}}) - p_{\\mathrm{out}}}{p_{\\mathrm{in}} - p_{\\mathrm{out}}} = \\frac{(p_{\\mathrm{in}}-p_{\\mathrm{out}})(1-\\frac{x}{L})}{p_{\\mathrm{in}} - p_{\\mathrm{out}}} = 1 - \\frac{x}{L}\n$$\nThis result can be recovered from our general expression for $\\Pi(x)$ by taking the limit as $\\gamma \\to 0$ using L'Hôpital's rule:\n$$\n\\lim_{\\gamma \\to 0} \\Pi(x) = \\lim_{\\gamma \\to 0} \\frac{\\frac{d}{d\\gamma}\\left(\\exp\\left(\\gamma\\left(1 - \\frac{x}{L}\\right)\\right) - 1\\right)}{\\frac{d}{d\\gamma}(\\exp(\\gamma) - 1)} = \\lim_{\\gamma \\to 0} \\frac{\\left(1 - \\frac{x}{L}\\right)\\exp\\left(\\gamma\\left(1 - \\frac{x}{L}\\right)\\right)}{\\exp(\\gamma)} = 1 - \\frac{x}{L}\n$$\nThus, the expression derived for $\\gamma \\neq 0$ is general, as its limit at $\\gamma=0$ gives the correct result for the homogeneous case. The single closed-form expression is valid for all $\\gamma$.\nThe final expression for $\\Pi(x)$ is therefore:\n$$\n\\Pi(x) = \\frac{\\exp\\left(\\gamma\\left(1 - \\frac{x}{L}\\right)\\right) - 1}{\\exp(\\gamma) - 1}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\exp\\left(\\gamma\\left(1 - \\frac{x}{L}\\right)\\right) - 1}{\\exp(\\gamma) - 1}}\n$$"
        },
        {
            "introduction": "Before trusting a numerical simulation, we must verify that the code correctly solves the intended equations. This practice  introduces a powerful verification technique known as the Method of Manufactured Solutions (MMS) for the Brinkman equations. You will start with a chosen \"manufactured\" solution for velocity $\\mathbf{u}^{\\star}$ and pressure $p^{\\star}$ and work backwards to derive the necessary body force $\\mathbf{f}$ and boundary conditions, creating a problem with a known, exact solution for code validation.",
            "id": "4088060",
            "problem": "Consider a two-dimensional, steady, incompressible flow of a Newtonian fluid through a homogeneous porous medium on the nondimensional unit square domain $\\Omega = (0,1) \\times (0,1)$. Starting from the following fundamental bases:\n\n- Linear momentum conservation for very low Reynolds number flow (neglecting inertia), with the stress divergence, a linear volumetric drag proportional to velocity, and a pressure gradient driving term.\n- Incompressibility, i.e., the continuity constraint enforcing solenoidality of the velocity field.\n- For a Newtonian fluid with constant effective viscosity $\\mu_{e} > 0$, the Cauchy stress reduces to a pressure term and a viscous term proportional to the rate-of-strain tensor.\n\nUse the idea of the Method of Manufactured Solutions (MMS) to construct a smooth, divergence-free velocity and a pressure field on $\\Omega$, then determine the volumetric body force $\\mathbf{f}$ that makes the chosen fields satisfy the governing equations with the above physics. Take the nondimensional Brinkman operator to be the sum of the viscous term and the linear Darcy drag term, and assume that the porous drag coefficient is $\\kappa^{-1}$ with $\\kappa > 0$ given. You must:\n\n- Choose a twice-continuously differentiable exact velocity field $\\mathbf{u}^{\\star}(x,y)$ that is exactly divergence-free, and a smooth pressure field $p^{\\star}(x,y)$ whose spatial mean over $\\Omega$ is zero.\n- Derive the forcing $\\mathbf{f}(x,y)$ implied by your choice, starting from the stated physical principles.\n- State the boundary conditions on $\\partial \\Omega$ that render your manufactured fields an exact solution.\n- Assume nondimensional variables throughout; no physical units are required in the final expressions.\n\nFor reproducibility, use the specific exact solution ansatz\n$\\mathbf{u}^{\\star}(x,y) = \\big(u_{x}(x,y), u_{y}(x,y)\\big)$ with $u_{x}(x,y) = \\pi \\cos(\\pi y)\\,\\sin(\\pi x)$ and $u_{y}(x,y) = -\\pi \\cos(\\pi x)\\,\\sin(\\pi y)$, and $p^{\\star}(x,y) = \\sin(2\\pi x)\\,\\cos(\\pi y)$ on $\\Omega$. Here $\\pi$ is the circular constant. Treat $\\mu_{e} > 0$ and $\\kappa > 0$ as given constants.\n\nProvide the final answer as a single closed-form analytic expression collecting, in order, the components $u_{x}(x,y)$, $u_{y}(x,y)$, $p^{\\star}(x,y)$, $f_{x}(x,y)$, and $f_{y}(x,y)$ in one row matrix. No numerical evaluation is required. Round nothing. No units should be included in the final expression. State the boundary conditions in your derivation, but do not include them in the final boxed expression.",
            "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded, well-posed, objective, and complete. It constitutes a standard application of the Method of Manufactured Solutions (MMS) to the steady-state Brinkman equations for flow in a porous medium.\n\nThe physical principles stated in the problem lead to the steady, incompressible Brinkman equations. The linear momentum conservation equation for a Newtonian fluid at very low Reynolds numbers, including pressure gradient, viscous stresses, a linear drag term, and a body force, is given by:\n$$-\\nabla p + \\nabla \\cdot (\\mu_e (\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)) - \\kappa^{-1} \\mathbf{u} + \\mathbf{f} = \\mathbf{0}$$\nwhere $\\mathbf{u}$ is the velocity field, $p$ is the pressure, $\\mu_e > 0$ is the constant effective viscosity, $\\kappa^{-1} > 0$ is the porous drag coefficient, and $\\mathbf{f}$ is the volumetric body force. The continuity equation for an incompressible fluid is:\n$$\\nabla \\cdot \\mathbf{u} = 0$$\nUsing the identity $\\nabla \\cdot (\\nabla \\mathbf{u})^T = \\nabla(\\nabla \\cdot \\mathbf{u})$ and the incompressibility condition $\\nabla \\cdot \\mathbf{u} = 0$, the viscous term simplifies to $\\mu_e \\nabla \\cdot (\\nabla \\mathbf{u}) = \\mu_e \\nabla^2 \\mathbf{u}$. The momentum equation thus becomes:\n$$-\\nabla p + \\mu_e \\nabla^2 \\mathbf{u} - \\kappa^{-1} \\mathbf{u} + \\mathbf{f} = \\mathbf{0}$$\nThe objective of the Method of Manufactured Solutions is to find the forcing term $\\mathbf{f}(x,y)$ that makes a chosen set of fields, $\\mathbf{u}^{\\star}(x,y)$ and $p^{\\star}(x,y)$, an exact solution to these governing equations. By substituting the manufactured solution into the momentum equation, we can solve for $\\mathbf{f}$:\n$$\\mathbf{f} = \\nabla p^{\\star} - \\mu_e \\nabla^2 \\mathbf{u}^{\\star} + \\kappa^{-1} \\mathbf{u}^{\\star}$$\nThe problem provides the specific ansatz for the velocity and pressure fields on the domain $\\Omega = (0,1) \\times (0,1)$:\n$$u_{x}^{\\star}(x,y) = \\pi \\cos(\\pi y)\\,\\sin(\\pi x)$$\n$$u_{y}^{\\star}(x,y) = -\\pi \\cos(\\pi x)\\,\\sin(\\pi y)$$\n$$p^{\\star}(x,y) = \\sin(2\\pi x)\\,\\cos(\\pi y)$$\nWe must first verify that the given fields satisfy the stated prerequisites.\n\nFirst, we check if the velocity field $\\mathbf{u}^{\\star} = (u_x^{\\star}, u_y^{\\star})$ is divergence-free:\n$$\\frac{\\partial u_{x}^{\\star}}{\\partial x} = \\frac{\\partial}{\\partial x} (\\pi \\cos(\\pi y)\\,\\sin(\\pi x)) = \\pi^2 \\cos(\\pi y)\\,\\cos(\\pi x)$$\n$$\\frac{\\partial u_{y}^{\\star}}{\\partial y} = \\frac{\\partial}{\\partial y} (-\\pi \\cos(\\pi x)\\,\\sin(\\pi y)) = -\\pi^2 \\cos(\\pi x)\\,\\cos(\\pi y)$$\nThe divergence is:\n$$\\nabla \\cdot \\mathbf{u}^{\\star} = \\frac{\\partial u_{x}^{\\star}}{\\partial x} + \\frac{\\partial u_{y}^{\\star}}{\\partial y} = \\pi^2 \\cos(\\pi y)\\,\\cos(\\pi x) - \\pi^2 \\cos(\\pi x)\\,\\cos(\\pi y) = 0$$\nThe velocity field is indeed solenoidal.\n\nSecond, we check if the pressure field $p^{\\star}$ has a zero spatial mean over $\\Omega$:\n$$\\bar{p}^{\\star} = \\int_{0}^{1}\\int_{0}^{1} p^{\\star}(x,y) \\,dx\\,dy = \\int_{0}^{1}\\int_{0}^{1} \\sin(2\\pi x)\\cos(\\pi y) \\,dx\\,dy$$\n$$\\bar{p}^{\\star} = \\left(\\int_{0}^{1} \\sin(2\\pi x) \\,dx\\right) \\left(\\int_{0}^{1} \\cos(\\pi y) \\,dy\\right)$$\nThe integral with respect to $x$ is:\n$$\\int_{0}^{1} \\sin(2\\pi x) \\,dx = \\left[-\\frac{\\cos(2\\pi x)}{2\\pi}\\right]_0^1 = -\\frac{1}{2\\pi}(\\cos(2\\pi) - \\cos(0)) = -\\frac{1}{2\\pi}(1-1) = 0$$\nSince one of the factors is $0$, the total integral is $0$. The pressure field has a zero spatial mean.\n\nNow, we compute the terms required for the forcing function $\\mathbf{f} = (f_x, f_y)$.\n\nThe pressure gradient $\\nabla p^{\\star}$ is:\n$$\\frac{\\partial p^{\\star}}{\\partial x} = \\frac{\\partial}{\\partial x}(\\sin(2\\pi x)\\cos(\\pi y)) = 2\\pi \\cos(2\\pi x)\\cos(\\pi y)$$\n$$\\frac{\\partial p^{\\star}}{\\partial y} = \\frac{\\partial}{\\partial y}(\\sin(2\\pi x)\\cos(\\pi y)) = -\\pi \\sin(2\\pi x)\\sin(\\pi y)$$\n\nThe Laplacian of the velocity field, $\\nabla^2 \\mathbf{u}^{\\star} = (\\nabla^2 u_x^{\\star}, \\nabla^2 u_y^{\\star})$, is computed next.\nFor the $x$-component, $u_x^{\\star}$:\n$$\\frac{\\partial^2 u_x^{\\star}}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2}(\\pi \\cos(\\pi y)\\sin(\\pi x)) = -\\pi^3 \\cos(\\pi y)\\sin(\\pi x)$$\n$$\\frac{\\partial^2 u_x^{\\star}}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2}(\\pi \\cos(\\pi y)\\sin(\\pi x)) = -\\pi^3 \\cos(\\pi y)\\sin(\\pi x)$$\n$$\\nabla^2 u_x^{\\star} = \\frac{\\partial^2 u_x^{\\star}}{\\partial x^2} + \\frac{\\partial^2 u_x^{\\star}}{\\partial y^2} = -2\\pi^3 \\cos(\\pi y)\\sin(\\pi x) = -2\\pi^2 u_x^{\\star}$$\nFor the $y$-component, $u_y^{\\star}$:\n$$\\frac{\\partial^2 u_y^{\\star}}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2}(-\\pi \\cos(\\pi x)\\sin(\\pi y)) = \\pi^3 \\cos(\\pi x)\\sin(\\pi y)$$\n$$\\frac{\\partial^2 u_y^{\\star}}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2}(-\\pi \\cos(\\pi x)\\sin(\\pi y)) = \\pi^3 \\cos(\\pi x)\\sin(\\pi y)$$\n$$\\nabla^2 u_y^{\\star} = \\frac{\\partial^2 u_y^{\\star}}{\\partial x^2} + \\frac{\\partial^2 u_y^{\\star}}{\\partial y^2} = 2\\pi^3 \\cos(\\pi x)\\sin(\\pi y) = -2\\pi^2 u_y^{\\star}$$\n\nNow we assemble the components of the forcing term $\\mathbf{f}$:\n$$f_x = \\frac{\\partial p^{\\star}}{\\partial x} - \\mu_e \\nabla^2 u_x^{\\star} + \\kappa^{-1} u_x^{\\star}$$\n$$f_x(x,y) = 2\\pi \\cos(2\\pi x)\\cos(\\pi y) - \\mu_e(-2\\pi^2 u_x^{\\star}) + \\kappa^{-1} u_x^{\\star}$$\n$$f_x(x,y) = 2\\pi \\cos(2\\pi x)\\cos(\\pi y) + (2\\pi^2 \\mu_e + \\kappa^{-1})u_x^{\\star}$$\nSubstituting the expression for $u_x^{\\star}$:\n$$f_x(x,y) = 2\\pi \\cos(2\\pi x)\\cos(\\pi y) + (2\\pi^2 \\mu_e + \\kappa^{-1})\\pi \\cos(\\pi y)\\sin(\\pi x)$$\n\n$$f_y = \\frac{\\partial p^{\\star}}{\\partial y} - \\mu_e \\nabla^2 u_y^{\\star} + \\kappa^{-1} u_y^{\\star}$$\n$$f_y(x,y) = -\\pi \\sin(2\\pi x)\\sin(\\pi y) - \\mu_e(-2\\pi^2 u_y^{\\star}) + \\kappa^{-1} u_y^{\\star}$$\n$$f_y(x,y) = -\\pi \\sin(2\\pi x)\\sin(\\pi y) + (2\\pi^2 \\mu_e + \\kappa^{-1})u_y^{\\star}$$\nSubstituting the expression for $u_y^{\\star}$:\n$$f_y(x,y) = -\\pi \\sin(2\\pi x)\\sin(\\pi y) + (2\\pi^2 \\mu_e + \\kappa^{-1})(-\\pi \\cos(\\pi x)\\sin(\\pi y))$$\n$$f_y(x,y) = -\\pi \\sin(2\\pi x)\\sin(\\pi y) - (2\\pi^2 \\mu_e + \\kappa^{-1})\\pi \\cos(\\pi x)\\sin(\\pi y)$$\n\nFinally, to ensure that $\\mathbf{u}^{\\star}$ and $p^{\\star}$ constitute an exact solution, we must impose boundary conditions on $\\partial \\Omega$ that are satisfied by these fields. The appropriate conditions are Dirichlet boundary conditions:\n$$\\mathbf{u}(x,y) = \\mathbf{u}^{\\star}(x,y) \\quad \\forall (x,y) \\in \\partial\\Omega$$\n$$p(x,y) = p^{\\star}(x,y) \\quad \\forall (x,y) \\in \\partial\\Omega$$\nSpecifically, for $x, y \\in [0,1]$:\n- On $y=0$: $\\mathbf{u}(x,0) = (\\pi\\sin(\\pi x), 0)$, $p(x,0) = \\sin(2\\pi x)$\n- On $y=1$: $\\mathbf{u}(x,1) = (-\\pi\\sin(\\pi x), 0)$, $p(x,1) = -\\sin(2\\pi x)$\n- On $x=0$: $\\mathbf{u}(0,y) = (0, -\\pi\\sin(\\pi y))$, $p(0,y) = 0$\n- On $x=1$: $\\mathbf{u}(1,y) = (0, \\pi\\sin(\\pi y))$, $p(1,y) = 0$\n\nThe final answer requires the components $u_x(x,y)$, $u_y(x,y)$, $p^{\\star}(x,y)$, $f_x(x,y)$, and $f_y(x,y)$ collected in a row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\pi \\cos(\\pi y)\\sin(\\pi x) & -\\pi \\cos(\\pi x)\\sin(\\pi y) & \\sin(2\\pi x)\\cos(\\pi y) & 2\\pi \\cos(2\\pi x)\\cos(\\pi y) + \\pi(2\\pi^2 \\mu_e + \\kappa^{-1}) \\cos(\\pi y)\\sin(\\pi x) & -\\pi \\sin(2\\pi x)\\sin(\\pi y) - \\pi(2\\pi^2 \\mu_e + \\kappa^{-1}) \\cos(\\pi x)\\sin(\\pi y)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Permeability $\\kappa$ is a critical macroscopic parameter that is notoriously difficult to measure directly, often requiring estimation from underlying physics. This computational exercise  bridges the gap between pore-scale modeling and macroscopic properties by tasking you with estimating $\\kappa$ from a numerical solution of the Brinkman equation. By implementing a finite difference solver and analyzing the effect of different boundary conditions, you will gain hands-on experience in how computational models are used to determine effective transport coefficients.",
            "id": "4088077",
            "problem": "Consider a two-dimensional porous channel that is macroscopically homogeneous and isotropic in the flow direction. At the pore scale, the steady, incompressible flow of a Newtonian fluid is modeled by a linear momentum balance with viscous and drag contributions, and a constant pressure gradient is imposed in the streamwise direction. Your task is to derive, implement, and verify a method to estimate the intrinsic permeability $ \\kappa $ from simulated pore-scale velocities by relating the volumetric flux to the applied pressure gradient, and to assess the sensitivity of the estimated $ \\kappa $ to different boundary conditions at the channel walls.\n\nStart from the following fundamental base:\n- The steady incompressible continuity equation $ \\nabla \\cdot \\mathbf{u} = 0 $, where $ \\mathbf{u} $ is the velocity field.\n- The steady incompressible momentum balance for a Newtonian fluid with Brinkman drag (the Brinkman equation): $ -\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\alpha \\mathbf{u} = \\mathbf{0} $, where $ p $ is pressure, $ \\mu $ is dynamic viscosity, and $ \\alpha $ is a linear drag coefficient representing momentum exchange with the porous skeleton.\n- The relation between the drag coefficient and permeability for Brinkman media: $ \\alpha = \\mu / \\kappa $, with $ \\kappa $ as the intrinsic permeability.\n- The macroscopic Darcy relation between area-averaged flux and pressure gradient at low Reynolds number: $ \\mathbf{q} = -(\\kappa/\\mu) \\nabla p $, where $ \\mathbf{q} $ is the volumetric flux per unit cross-sectional area.\n\nIn your derivation, restrict attention to fully developed planar flow where the velocity field is unidirectional and varies only in the cross-stream direction. Concretely, set the channel height to $ H $ in the cross-stream direction $ y $, set the streamwise length to $ L $, impose a constant pressure drop $ \\Delta p $ in the streamwise direction, and assume the velocity field takes the form $ \\mathbf{u}(y) = u(y)\\,\\hat{\\mathbf{x}} $ with $ \\partial/\\partial x = 0 $. From the fundamental base above, derive the one-dimensional boundary value problem that $ u(y) $ must satisfy and a mathematically consistent procedure to compute the area-averaged volumetric flux per unit width $ q = \\frac{1}{1}\\int_0^H u(y)\\,dy $ from the numerical solution $ u(y) $. Use this derivation to obtain an expression to estimate $ \\kappa $ in terms of the numerically computed flux and the imposed pressure gradient; do not introduce any additional empirical relations.\n\nImplement your method in a program that:\n- Discretizes the derived one-dimensional boundary value problem on a uniform grid in $ y $ using second-order central finite differences for the second derivative and appropriate linear boundary conditions at the walls.\n- Solves the resulting linear system for $ u(y) $ under three distinct boundary condition models:\n  1. No-slip walls: $ u(0) = 0 $ and $ u(H) = 0 $.\n  2. Navier slip walls with slip length $ b $: $ u(0) - b\\,u'(0) = 0 $ and $ u(H) + b\\,u'(H) = 0 $.\n  3. Periodic in $ y $: $ u(0) = u(H) $ and $ u'(0) = u'(H) $.\n- Computes the area-averaged volumetric flux per unit width $ q $ by numerical quadrature and returns the estimated $ \\kappa $ using your derived expression that connects $ q $ and $ \\nabla p $ through fundamental laws. All physical quantities must be expressed in the International System of Units (SI units). Report the estimated $ \\kappa $ in $ \\mathrm{m}^2 $, and ensure the program outputs floating-point numbers.\n\nUse the following test suite of parameter values, which is designed to probe a typical case, boundary-condition-induced deviations, and sensitivity to permeability magnitude:\n\n- Test case $ 1 $ (happy path): $ \\kappa_{\\text{true}} = 10^{-12}\\,\\mathrm{m}^2 $, $ H = 10^{-3}\\,\\mathrm{m} $, $ L = 10^{-2}\\,\\mathrm{m} $, $ \\Delta p = 10^{2}\\,\\mathrm{Pa} $, $ \\mu = 10^{-3}\\,\\mathrm{Pa\\,s} $, boundary condition: periodic, slip length $ b $ ignored.\n- Test case $ 2 $ (no-slip walls): $ \\kappa_{\\text{true}} = 10^{-12}\\,\\mathrm{m}^2 $, $ H = 10^{-3}\\,\\mathrm{m} $, $ L = 10^{-2}\\,\\mathrm{m} $, $ \\Delta p = 10^{2}\\,\\mathrm{Pa} $, $ \\mu = 10^{-3}\\,\\mathrm{Pa\\,s} $, boundary condition: no-slip.\n- Test case $ 3 $ (moderate Navier slip): $ \\kappa_{\\text{true}} = 10^{-12}\\,\\mathrm{m}^2 $, $ H = 10^{-3}\\,\\mathrm{m} $, $ L = 10^{-2}\\,\\mathrm{m} $, $ \\Delta p = 10^{2}\\,\\mathrm{Pa} $, $ \\mu = 10^{-3}\\,\\mathrm{Pa\\,s} $, boundary condition: Navier slip with $ b = 0.2\\,H $.\n- Test case $ 4 $ (low permeability sensitivity with no-slip): $ \\kappa_{\\text{true}} = 10^{-14}\\,\\mathrm{m}^2 $, $ H = 10^{-3}\\,\\mathrm{m} $, $ L = 10^{-2}\\,\\mathrm{m} $, $ \\Delta p = 10^{2}\\,\\mathrm{Pa} $, $ \\mu = 10^{-3}\\,\\mathrm{Pa\\,s} $, boundary condition: no-slip.\n- Test case $ 5 $ (high Navier slip): $ \\kappa_{\\text{true}} = 5\\times 10^{-13}\\,\\mathrm{m}^2 $, $ H = 10^{-3}\\,\\mathrm{m} $, $ L = 10^{-2}\\,\\mathrm{m} $, $ \\Delta p = 10^{2}\\,\\mathrm{Pa} $, $ \\mu = 10^{-3}\\,\\mathrm{Pa\\,s} $, boundary condition: Navier slip with $ b = 1.0\\,H $.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact order of the test cases above, with each entry being the estimated $ \\kappa $ for that test case in $ \\mathrm{m}^2 $. For example, an output in the correct format would look like $ [\\kappa_1,\\kappa_2,\\kappa_3,\\kappa_4,\\kappa_5] $ where each $ \\kappa_i $ is a floating-point number in $ \\mathrm{m}^2 $.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard exercise in computational transport phenomena, requiring the derivation and numerical solution of a boundary value problem based on the Brinkman equation. All provided parameters are physically consistent and the task is clearly defined. Therefore, the problem is deemed valid and a full solution can be provided.\n\n### 1. Derivation of the Governing Equation\n\nThe starting point is the steady, incompressible Brinkman equation for a Newtonian fluid in a porous medium:\n$$ -\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\alpha \\mathbf{u} = \\mathbf{0} $$\nand the relation between the drag coefficient $ \\alpha $ and the intrinsic permeability $ \\kappa_{\\text{true}} $:\n$$ \\alpha = \\frac{\\mu}{\\kappa_{\\text{true}}} $$\nWe consider a fully developed planar flow in a channel of height $ H $ along the $y$-axis, with the flow driven by a constant pressure drop $ \\Delta p $ over a length $ L $ in the $x$-direction. The velocity field is assumed to be unidirectional and vary only in the cross-stream direction, $ \\mathbf{u}(y) = u(y)\\,\\hat{\\mathbf{x}} $. The pressure gradient is constant and is given by $ \\nabla p = -\\frac{\\Delta p}{L}\\hat{\\mathbf{x}} $.\n\nUnder these assumptions, we can simplify the vector components of the Brinkman equation.\nThe continuity equation $ \\nabla \\cdot \\mathbf{u} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial u(y)}{\\partial x} = 0 $ is automatically satisfied.\nThe Laplacian of the velocity field simplifies to $ \\nabla^2 \\mathbf{u} = \\frac{d^2 u}{dy^2}\\hat{\\mathbf{x}} $.\n\nSubstituting these into the $x$-component of the Brinkman equation yields:\n$$ -(-\\frac{\\Delta p}{L}) + \\mu \\frac{d^2 u}{dy^2} - \\alpha u(y) = 0 $$\nThe $y$-component vanishes identically ($ 0=0 $). Rearranging the $x$-component equation gives:\n$$ \\mu \\frac{d^2 u}{dy^2} - \\alpha u = -\\frac{\\Delta p}{L} $$\nSubstituting $ \\alpha = \\mu/\\kappa_{\\text{true}} $ and dividing by the dynamic viscosity $ \\mu $, we obtain the one-dimensional, second-order, linear ordinary differential equation (ODE) for the velocity profile $ u(y) $:\n$$ \\frac{d^2 u}{dy^2} - \\frac{1}{\\kappa_{\\text{true}}} u = -\\frac{\\Delta p}{\\mu L} $$\nThis equation forms a boundary value problem (BVP) when supplemented with two boundary conditions at the channel walls, $ y=0 $ and $ y=H $.\n\n### 2. Derivation of the Permeability Estimation Formula\n\nThe problem requires estimating the permeability $ \\kappa_{est} $ by relating the volumetric flux to the applied pressure gradient via the macroscopic Darcy's law:\n$$ \\mathbf{q} = -\\frac{\\kappa}{\\mu} \\nabla p $$\nHere, $ \\mathbf{q} $ is the Darcy flux, which represents the volume-averaged velocity. For our one-dimensional channel flow, this is the area-averaged velocity:\n$$ q_x = \\frac{1}{H} \\int_0^H u(y)\\,dy $$\nThe scalar form of Darcy's law in the $x$-direction is:\n$$ q_x = -\\frac{\\kappa_{est}}{\\mu} \\left(-\\frac{\\Delta p}{L}\\right) = \\frac{\\kappa_{est}}{\\mu} \\frac{\\Delta p}{L} $$\nBy solving the BVP for the velocity profile $ u(y) $, we can compute the Darcy flux $ q_x $. Then, by rearranging the Darcy relation, we can solve for the estimated permeability $ \\kappa_{est} $:\n$$ \\kappa_{est} = q_x \\frac{\\mu L}{\\Delta p} = \\left(\\frac{1}{H} \\int_0^H u(y)\\,dy\\right) \\frac{\\mu L}{\\Delta p} $$\nThis is the central formula for our computation. The integral is evaluated numerically using the solution of the BVP.\n\n### 3. Numerical Scheme: Finite Difference Method\n\nTo solve the BVP, we discretize the domain $ y \\in [0, H] $ using a uniform grid of $ N+1 $ points, $ y_j = j \\Delta y $ for $ j = 0, 1, \\ldots, N $, where $ \\Delta y = H/N $. Let $ u_j \\equiv u(y_j) $. The second derivative is approximated using a second-order central difference stencil:\n$$ \\frac{d^2 u}{dy^2}\\bigg|_{y_j} \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{(\\Delta y)^2} $$\nSubstituting this into the ODE for the interior points ($ j=1, \\ldots, N-1 $) gives a system of linear algebraic equations:\n$$ \\frac{u_{j+1} - 2u_j + u_{j-1}}{(\\Delta y)^2} - \\frac{1}{\\kappa_{\\text{true}}} u_j = -G $$\nwhere $ G = \\frac{\\Delta p}{\\mu L} $. Rearranging, we get:\n$$ u_{j-1} + \\left(-2 - \\frac{(\\Delta y)^2}{\\kappa_{\\text{true}}}\\right) u_j + u_{j+1} = -G (\\Delta y)^2 $$\nThese equations, combined with discretized boundary conditions, form a linear system $ \\mathbf{A} \\mathbf{u} = \\mathbf{b} $ which can be solved for the unknown velocity values $ u_j $.\n\n### 4. Implementation of Boundary Conditions\n\nThe specific form of the linear system depends on the boundary conditions at $ y=0 $ and $ y=H $.\n\n**1. No-slip Walls:** $ u(0)=0 $ and $ u(H)=0 $.\nThis implies $ u_0 = 0 $ and $ u_N = 0 $. The system is solved for the $ N-1 $ interior unknowns $ u_1, \\ldots, u_{N-1} $. The resulting system matrix is tridiagonal.\n\n**2. Periodic:** $ u(0)=u(H) $ and $ u'(0)=u'(H) $.\nThis condition implies $ u_0 = u_N $ and is discretized by extending the grid periodically, such that $ u_{-1}=u_{N-1} $ and $ u_{N+1}=u_1 $. The system is solved for $ N $ unknowns $ u_0, \\ldots, u_{N-1} $. The resulting matrix is circulant tridiagonal. The equation for $ j=0 $ becomes $ u_{N-1} + (-2 - C)u_0 + u_1 = -G(\\Delta y)^2 $, and for $ j=N-1 $ it becomes $ u_{N-2} + (-2 - C)u_{N-1} + u_0 = -G(\\Delta y)^2 $, where $ C = (\\Delta y)^2 / \\kappa_{\\text{true}} $.\n\n**3. Navier Slip Walls:** $ u(0) - b\\,u'(0) = 0 $ and $ u(H) + b\\,u'(H) = 0 $.\nWe use ghost points and a central difference to discretize the derivative with second-order accuracy.\nAt $ y=0 $: $ u'(0) \\approx \\frac{u_1 - u_{-1}}{2\\Delta y} $. The BC gives $ u_{-1} = u_1 - \\frac{2\\Delta y}{b}u_0 $. Substituting this into the discretized ODE at $ j=0 $ gives the first equation of the system:\n$$ \\left(-2 - C - \\frac{2\\Delta y}{b}\\right)u_0 + 2u_1 = -G(\\Delta y)^2 $$\nAt $ y=H $: $ u'(H) \\approx \\frac{u_{N+1}-u_{N-1}}{2\\Delta y} $. The BC gives $ u_{N+1} = u_{N-1} - \\frac{2\\Delta y}{b}u_N $. Substituting this into the ODE at $ j=N $ gives the last equation:\n$$ 2u_{N-1} + \\left(-2 - C - \\frac{2\\Delta y}{b}\\right)u_N = -G(\\Delta y)^2 $$\nThe system is solved for the $ N+1 $ unknowns $ u_0, \\ldots, u_N $.\n\n### 5. Final Computation\n\nOnce the linear system is solved for the discrete velocity profile $ \\mathbf{u} $, the integral in the permeability estimation formula is computed using the trapezoidal rule:\n$$ \\int_0^H u(y)\\,dy \\approx \\sum_{j=0}^{N-1} \\frac{u_j + u_{j+1}}{2} \\Delta y $$\nThe estimated permeability $ \\kappa_{est} $ is then calculated using the derived formula. In the case of periodic boundary conditions, theory predicts $ \\kappa_{est} = \\kappa_{\\text{true}} $, which provides a valuable verification for the implementation. For other boundary conditions, deviations are expected due to boundary layer effects not captured by the macroscopic Darcy model.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# The problem statement allows for scipy, but numpy is sufficient.\n# from scipy.linalg import solve\n\ndef compute_kappa_est(k_true, H, L, dp, mu, bc_type, b=None, N=2000):\n    \"\"\"\n    Solves the 1D Brinkman equation and estimates the intrinsic permeability.\n\n    Args:\n        k_true (float): The true intrinsic permeability (m^2).\n        H (float): Channel height (m).\n        L (float): Channel length (m).\n        dp (float): Pressure drop (Pa).\n        mu (float): Dynamic viscosity (Pa*s).\n        bc_type (str): Boundary condition type ('periodic', 'no_slip', 'navier_slip').\n        b (float, optional): Slip length for Navier slip (m). Defaults to None.\n        N (int, optional): Number of grid intervals. Defaults to 2000.\n\n    Returns:\n        float: The estimated intrinsic permeability kappa_est (m^2).\n    \"\"\"\n\n    dy = H / N\n    y_grid = np.linspace(0, H, N + 1)\n    \n    # Constant terms in the discretized ODE\n    C = dy**2 / k_true\n    G = dp / (mu * L)\n    RHS_val = -G * dy**2\n    DIAG_val = -2 - C\n    \n    if bc_type == 'periodic':\n        # System size is N x N for unknowns u_0, ..., u_{N-1}\n        N_sys = N\n        A = np.zeros((N_sys, N_sys))\n        \n        # Main diagonal\n        A += np.diag(np.full(N_sys, DIAG_val))\n        # Off-diagonals\n        A += np.diag(np.ones(N_sys - 1), k=1)\n        A += np.diag(np.ones(N_sys - 1), k=-1)\n        # Corner elements for periodicity\n        A[0, N_sys - 1] = 1.0\n        A[N_sys - 1, 0] = 1.0\n        \n        rhs = np.full(N_sys, RHS_val)\n        \n        u_solved = np.linalg.solve(A, rhs)\n        # Full velocity profile for integration (u_N = u_0)\n        u_profile = np.concatenate((u_solved, [u_solved[0]]))\n\n    elif bc_type == 'no_slip':\n        # System size is (N-1) x (N-1) for unknowns u_1, ..., u_{N-1}\n        N_sys = N - 1\n        A = np.zeros((N_sys, N_sys))\n\n        # Main diagonal\n        A += np.diag(np.full(N_sys, DIAG_val))\n        # Off-diagonals\n        A += np.diag(np.ones(N_sys - 1), k=1)\n        A += np.diag(np.ones(N_sys - 1), k=-1)\n\n        rhs = np.full(N_sys, RHS_val)\n        \n        u_solved = np.linalg.solve(A, rhs)\n        # Full velocity profile with u_0=0 and u_N=0\n        u_profile = np.concatenate(([0.0], u_solved, [0.0]))\n\n    elif bc_type == 'navier_slip':\n        # System size is (N+1) x (N+1) for unknowns u_0, ..., u_N\n        N_sys = N + 1\n        A = np.zeros((N_sys, N_sys))\n        \n        # Interior points form a tridiagonal structure\n        # Main diagonal\n        A += np.diag(np.full(N_sys, DIAG_val))\n        # Off-diagonals\n        A += np.diag(np.ones(N_sys - 1), k=1)\n        A += np.diag(np.ones(N_sys - 1), k=-1)\n\n        # Modify first and last rows for Navier-slip BCs\n        slip_term = -2 * dy / b\n        # First row: (-2 - C - 2*dy/b) u_0 + 2 u_1 = RHS\n        A[0, 0] = DIAG_val + slip_term\n        A[0, 1] = 2.0\n        # Last row: 2 u_{N-1} + (-2 - C - 2*dy/b) u_N = RHS\n        A[N, N - 1] = 2.0\n        A[N, N] = DIAG_val + slip_term\n\n        rhs = np.full(N_sys, RHS_val)\n        \n        u_profile = np.linalg.solve(A, rhs)\n\n    else:\n        raise ValueError(\"Invalid boundary condition type.\")\n\n    # Compute integral using trapezoidal rule\n    integral_u = np.trapz(u_profile, y_grid)\n    \n    # Compute Darcy velocity (average velocity)\n    q_x = integral_u / H\n    \n    # Estimate permeability from Darcy's law\n    kappa_est = q_x * (mu * L) / dp\n    \n    return kappa_est\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # k_true, H, L, dp, mu, bc_type, b_ratio\n        (1e-12, 1e-3, 1e-2, 1e2, 1e-3, 'periodic', None),\n        (1e-12, 1e-3, 1e-2, 1e2, 1e-3, 'no_slip', None),\n        (1e-12, 1e-3, 1e-2, 1e2, 1e-3, 'navier_slip', 0.2),\n        (1e-14, 1e-3, 1e-2, 1e2, 1e-3, 'no_slip', None),\n        (5e-13, 1e-3, 1e-2, 1e2, 1e-3, 'navier_slip', 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        k_true, H, L, dp, mu, bc_type, b_ratio = case\n        b = b_ratio * H if b_ratio is not None else None\n        \n        kappa_estimated = compute_kappa_est(k_true, H, L, dp, mu, bc_type, b)\n        results.append(kappa_estimated)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}