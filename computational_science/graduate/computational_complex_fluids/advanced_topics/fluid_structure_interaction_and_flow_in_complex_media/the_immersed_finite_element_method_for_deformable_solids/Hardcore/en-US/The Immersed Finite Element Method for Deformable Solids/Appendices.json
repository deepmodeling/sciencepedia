{
    "hands_on_practices": [
        {
            "introduction": "The heart of simulating any deformable solid lies in quantifying its internal resistance to deformation. This practice guides you through the essential steps of translating a continuum-level description of stress, derived from a hyperelastic model, into discrete nodal forces within a finite element framework. By implementing the calculation for a simple triangular element, you will gain hands-on experience with the core computational machinery that drives the solid's dynamics in an IFEM simulation.",
            "id": "4108443",
            "problem": "Consider a two-dimensional deformable solid discretized by linear triangular finite elements in the reference configuration, embedded in a fluid following the immersed methodology. The immersed finite element method computes elastic force density at solid quadrature points and assembles nodal forces that are later spread to the fluid. You are to derive and implement the computation of the elastic force density at solid quadrature points and assemble the nodal internal force vector using the first Piola–Kirchhoff stress tensor and the gradients of the shape functions in the reference configuration.\n\nStart from the principle of virtual work in the reference configuration for a hyperelastic solid and the definition of the first Piola–Kirchhoff stress. Let the reference domain be denoted by $\\Omega_0 \\subset \\mathbb{R}^2$, and let the placement map be $\\boldsymbol{x}(\\boldsymbol{X})$ with deformation gradient $\\boldsymbol{F} = \\nabla_{\\boldsymbol{X}} \\boldsymbol{x}$. For a variation $\\delta \\boldsymbol{u}$, the internal virtual work is given by the well-tested formula\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_0} \\boldsymbol{P} : \\nabla_{\\boldsymbol{X}} \\delta \\boldsymbol{u} \\, \\mathrm{d}\\Omega_0,\n$$\nwhere $\\boldsymbol{P}$ is the first Piola–Kirchhoff stress tensor. Represent the virtual displacement using finite element shape functions $N_a(\\boldsymbol{X})$ as $\\delta \\boldsymbol{u}(\\boldsymbol{X}) = \\sum_a \\delta \\boldsymbol{d}_a N_a(\\boldsymbol{X})$, where $\\delta \\boldsymbol{d}_a$ are the nodal variations. This leads to an internal nodal force vector $\\{\\boldsymbol{F}_a\\}$ satisfying\n$$\n\\delta W_{\\text{int}} = \\sum_a \\delta \\boldsymbol{d}_a \\cdot \\boldsymbol{F}_a, \\quad \\text{with} \\quad \\boldsymbol{F}_a = \\int_{\\Omega_0} \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a \\, \\mathrm{d}\\Omega_0.\n$$\nDefine the elastic force density contribution at a solid quadrature point $\\boldsymbol{X}_q$ associated with node $a$ as the vector\n$$\n\\boldsymbol{g}_a(\\boldsymbol{X}_q) = \\boldsymbol{P}(\\boldsymbol{X}_q) \\, \\nabla_{\\boldsymbol{X}} N_a(\\boldsymbol{X}_q),\n$$\nwhich has units of $\\mathrm{N}/\\mathrm{m}^3$ (force per reference volume). Using numerical quadrature with weights $w_q$ (in $\\mathrm{m}^2$ for two-dimensional reference domains under the assumption of out-of-plane unit thickness), the nodal force is assembled as\n$$\n\\boldsymbol{F}_a \\approx \\sum_q w_q \\, \\boldsymbol{g}_a(\\boldsymbol{X}_q),\n$$\nwhich has units of $\\mathrm{N}$.\n\nFor a linear triangular element, the shape function gradients $\\nabla_{\\boldsymbol{X}} N_a$ are constant over the element and can be computed directly from the reference nodal coordinates. The deformation gradient for a linear triangle is constant in the element and can be computed as\n$$\n\\boldsymbol{F} = \\sum_{a=1}^3 \\boldsymbol{x}_a \\otimes \\nabla_{\\boldsymbol{X}} N_a,\n$$\nwhere $\\boldsymbol{x}_a$ are the current coordinates of the nodes and $\\otimes$ denotes the tensor (outer) product.\n\nFor the constitutive model, consider a compressible Neo–Hookean hyperelastic solid with strain energy density\n$$\n\\Psi(\\boldsymbol{F}) = \\frac{\\mu}{2} \\left( \\boldsymbol{F} : \\boldsymbol{F} - 2 \\right) - \\mu \\ln J + \\frac{\\lambda}{2} (\\ln J)^2,\n$$\nwhere $J = \\det \\boldsymbol{F}$, and the Lamé parameters are $\\mu = \\frac{E}{2(1+\\nu)}$ and $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ expressed in terms of Young’s modulus $E$ and Poisson’s ratio $\\nu$. The corresponding first Piola–Kirchhoff stress is\n$$\n\\boldsymbol{P} = \\mu \\left( \\boldsymbol{F} - \\boldsymbol{F}^{-T} \\right) + \\lambda \\, \\ln J \\, \\boldsymbol{F}^{-T}.\n$$\n\nImplement a program that, for each specified test case, computes:\n1. The shape function gradients $\\nabla_{\\boldsymbol{X}} N_a$ for $a=1,2,3$.\n2. The deformation gradient $\\boldsymbol{F}$ at the centroid quadrature point using the linear triangle formula.\n3. The first Piola–Kirchhoff stress $\\boldsymbol{P}$ using the compressible Neo–Hookean law.\n4. The elastic force density vectors $\\boldsymbol{g}_a(\\boldsymbol{X}_q) = \\boldsymbol{P} \\nabla_{\\boldsymbol{X}} N_a$ at the centroid.\n5. The nodal forces $\\boldsymbol{F}_a = w \\, \\boldsymbol{g}_a(\\boldsymbol{X}_q)$ using one-point centroid quadrature with weight $w = A$, the element area, assuming unit out-of-plane thickness.\n\nExpress the final nodal forces in Newtons (N). The angle unit is not applicable. The outputs must be floats.\n\nTest Suite:\n- Case 1 (general deformation, moderate compressibility): Reference triangle nodes $\\boldsymbol{X}_1=(0,0)$, $\\boldsymbol{X}_2=(1,0)$, $\\boldsymbol{X}_3=(0,1)$, current nodes $\\boldsymbol{x}_1=(0.00,0.00)$, $\\boldsymbol{x}_2=(1.05,0.02)$, $\\boldsymbol{x}_3=(-0.01,1.10)$, material parameters $E=1.0\\times 10^6 \\, \\mathrm{Pa}$, $\\nu=0.35$.\n- Case 2 (uniform dilation): Same reference triangle, current nodes given by uniform scaling $\\boldsymbol{x}_a = \\alpha \\boldsymbol{X}_a$ with $\\alpha = 1.02$, material parameters $E=1.0\\times 10^6 \\, \\mathrm{Pa}$, $\\nu=0.35$.\n- Case 3 (near-incompressible material): Same geometry and current nodes as Case 1, material parameters $E=1.0\\times 10^6 \\, \\mathrm{Pa}$, $\\nu=0.49$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must itself be a comma-separated list, enclosed in square brackets, containing the nodal force components for nodes $1,2,3$ in the order $[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}]$ in Newtons, with each float formatted with six decimal places. For example, the output must look like:\n$$\n[\\,[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}],\\,[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}],\\,[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}]\\,].\n$$",
            "solution": "The problem statement is critically validated and found to be valid. It is scientifically grounded in the principles of continuum mechanics and the finite element method, is well-posed, objective, and provides a complete and consistent set of information required for a unique solution. The task is to compute nodal elastic forces for a 2D linear triangular element under specified deformations and material properties.\n\nThe core of the problem lies in the application of the principle of virtual work in a finite element context. The internal virtual work, $\\delta W_{\\text{int}}$, is equated to the work done by nodal forces $\\boldsymbol{F}_a$ under virtual nodal displacements $\\delta \\boldsymbol{d}_a$:\n$$\n\\delta W_{\\text{int}} = \\sum_a \\delta \\boldsymbol{d}_a \\cdot \\boldsymbol{F}_a\n$$\nThe problem provides the continuum mechanics expression for internal virtual work using the first Piola-Kirchhoff stress tensor $\\boldsymbol{P}$:\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_0} \\boldsymbol{P} : \\nabla_{\\boldsymbol{X}} \\delta \\boldsymbol{u} \\, \\mathrm{d}\\Omega_0\n$$\nwhere $\\Omega_0$ is the reference domain. By substituting the finite element approximation for the virtual displacement, $\\delta \\boldsymbol{u}(\\boldsymbol{X}) = \\sum_b N_b(\\boldsymbol{X}) \\delta \\boldsymbol{d}_b$, into the integral, we find the expression for the nodal force at node $a$:\n$$\n\\boldsymbol{F}_a = \\int_{\\Omega_0} \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a \\, \\mathrm{d}\\Omega_0\n$$\nFor a 2D problem analyzed under the common assumption of a unit out-of-plane thickness, $t=1$, the reference volume element $\\mathrm{d}\\Omega_0$ becomes $t \\cdot \\mathrm{d}A_0 = \\mathrm{d}A_0$, where $\\mathrm{d}A_0$ is the reference area element. The integral is evaluated over the element's area $A_e$. For a linear triangular element, the quantities $\\boldsymbol{P}$ and $\\nabla_{\\boldsymbol{X}} N_a$ are constant within the element. A single-point quadrature at the centroid is therefore exact:\n$$\n\\boldsymbol{F}_a = \\left( \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a \\right) \\int_{A_e} \\mathrm{d}A_0 = A_e \\cdot \\boldsymbol{P} \\cdot \\nabla_{\\boldsymbol{X}} N_a\n$$\nwhere $A_e$ is the area of the element in the reference configuration. The problem defines the force density as $\\boldsymbol{g}_a = \\boldsymbol{P} \\nabla_{\\boldsymbol{X}} N_a$ and the quadrature weight as $w = A_e$, which is consistent with this formulation.\n\nThe solution proceeds by implementing the five specified computational steps for each test case.\n\n**Step 1: Shape Function Gradients**\nFor a 2D linear triangular element with vertices $\\boldsymbol{X}_1, \\boldsymbol{X}_2, \\boldsymbol{X}_3$ in the reference configuration, the gradients of the barycentric shape functions $N_a(\\boldsymbol{X})$ are constant vectors given by:\n$$\n\\nabla_{\\boldsymbol{X}} N_1 = \\frac{1}{2A_e} \\begin{pmatrix} Y_2 - Y_3 \\\\ X_3 - X_2 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_2 = \\frac{1}{2A_e} \\begin{pmatrix} Y_3 - Y_1 \\\\ X_1 - X_3 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_3 = \\frac{1}{2A_e} \\begin{pmatrix} Y_1 - Y_2 \\\\ X_2 - X_1 \\end{pmatrix}\n$$\nwhere $A_e$ is the area of the reference triangle:\n$$\nA_e = \\frac{1}{2} \\det \\begin{pmatrix} X_2 - X_1  Y_2 - Y_1 \\\\ X_3 - X_1  Y_3 - Y_1 \\end{pmatrix} = \\frac{1}{2} |(X_2-X_1)(Y_3-Y_1) - (X_3-X_1)(Y_2-Y_1)|\n$$\nFor the specific reference triangle given in all test cases, with $\\boldsymbol{X}_1 = (0,0)$, $\\boldsymbol{X}_2 = (1,0)$, and $\\boldsymbol{X}_3 = (0,1)$, the area is $A_e = 0.5$. The gradients are:\n$$\n\\nabla_{\\boldsymbol{X}} N_1 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n\n**Step 2: Deformation Gradient**\nThe deformation gradient $\\boldsymbol{F}$ is constant for a linear element and is given by the formula:\n$$\n\\boldsymbol{F} = \\sum_{a=1}^3 \\boldsymbol{x}_a \\otimes \\nabla_{\\boldsymbol{X}} N_a\n$$\nwhere $\\boldsymbol{x}_a$ are the current nodal coordinates. For the specific reference triangle geometry, this sum simplifies to:\n$$\n\\boldsymbol{F} = \\boldsymbol{x}_1 \\otimes \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} + \\boldsymbol{x}_2 \\otimes \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\boldsymbol{x}_3 \\otimes \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n= \\begin{pmatrix} x_{2x} - x_{1x}  x_{3x} - x_{1x} \\\\ x_{2y} - x_{1y}  x_{3y} - x_{1y} \\end{pmatrix}\n$$\nThis matrix will be computed for the current nodal coordinates $\\{\\boldsymbol{x}_a\\}$ specified in each test case.\n\n**Step 3: First Piola–Kirchhoff Stress**\nThe constitutive law for the compressible Neo-Hookean material is:\n$$\n\\boldsymbol{P} = \\mu \\left( \\boldsymbol{F} - \\boldsymbol{F}^{-T} \\right) + \\lambda \\, \\ln J \\, \\boldsymbol{F}^{-T}\n$$\nFirst, the Lamé parameters, $\\mu$ and $\\lambda$, are calculated from the Young's modulus $E$ and Poisson's ratio $\\nu$:\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\quad \\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}\n$$\nNext, the kinematic quantities $J = \\det \\boldsymbol{F}$ and the inverse transpose $\\boldsymbol{F}^{-T}$ are computed from the deformation gradient $\\boldsymbol{F}$ obtained in Step 2. These values are then substituted into the constitutive equation to find the stress tensor $\\boldsymbol{P}$.\n\n**Step 4: Elastic Force Density**\nThe elastic force density contribution for each node $a$ is computed by the matrix-vector product:\n$$\n\\boldsymbol{g}_a = \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a\n$$\nThis calculation is performed for each node $a \\in \\{1,2,3\\}$, yielding three force density vectors $\\boldsymbol{g}_1, \\boldsymbol{g}_2, \\boldsymbol{g}_3$.\n\n**Step 5: Nodal Forces**\nThe final nodal force for each node $a$ is assembled using one-point quadrature, which simplifies to a scalar multiplication:\n$$\n\\boldsymbol{F}_a = A_e \\cdot \\boldsymbol{g}_a = A_e \\cdot \\boldsymbol{P} \\cdot \\nabla_{\\boldsymbol{X}} N_a\n$$\nWith $A_e = 0.5$ for the given reference element, the forces are calculated as $\\boldsymbol{F}_a = 0.5 \\cdot \\boldsymbol{g}_a$. A fundamental property of internal forces is that they must be in equilibrium, meaning their sum over the element is zero: $\\sum_{a=1}^3 \\boldsymbol{F}_a = \\boldsymbol{0}$. This property serves as a valuable verification of the implementation, as $\\sum_a \\nabla_{\\boldsymbol{X}} N_a = \\boldsymbol{0}$. The resulting components of $\\boldsymbol{F}_1, \\boldsymbol{F}_2, \\boldsymbol{F}_3$ form the output for each case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes nodal elastic forces for a 2D linear triangular finite element\n    using a compressible Neo-Hookean model.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"X_nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"x_nodes\": np.array([[0.00, 0.00], [1.05, 0.02], [-0.01, 1.10]]),\n            \"E\": 1.0e6,\n            \"nu\": 0.35,\n        },\n        {\n            \"X_nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"x_nodes\": 1.02 * np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"E\": 1.0e6,\n            \"nu\": 0.35,\n        },\n        {\n            \"X_nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"x_nodes\": np.array([[0.00, 0.00], [1.05, 0.02], [-0.01, 1.10]]),\n            \"E\": 1.0e6,\n            \"nu\": 0.49,\n        },\n    ]\n\n    results_all_cases = []\n\n    for case in test_cases:\n        X_nodes = case[\"X_nodes\"]\n        x_nodes = case[\"x_nodes\"]\n        E = case[\"E\"]\n        nu = case[\"nu\"]\n\n        X1, X2, X3 = X_nodes[0, :], X_nodes[1, :], X_nodes[2, :]\n        x1, x2, x3 = x_nodes[0, :], x_nodes[1, :], x_nodes[2, :]\n\n        # Step 1: Calculate reference area and shape function gradients\n        # Area of the reference triangle\n        A_e = 0.5 * np.linalg.det(\n            np.array([[X2[0] - X1[0], X2[1] - X1[1]], [X3[0] - X1[0], X3[1] - X1[1]]])\n        )\n\n        # Gradients of shape functions\n        grad_N1 = (0.5 / A_e) * np.array([X2[1] - X3[1], X3[0] - X2[0]])\n        grad_N2 = (0.5 / A_e) * np.array([X3[1] - X1[1], X1[0] - X3[0]])\n        grad_N3 = (0.5 / A_e) * np.array([X1[1] - X2[1], X2[0] - X1[0]])\n        \n        grads_N = [grad_N1, grad_N2, grad_N3]\n\n        # Step 2: Calculate the deformation gradient F\n        F = np.zeros((2, 2))\n        for i in range(3):\n            F += np.outer(x_nodes[i], grads_N[i])\n        \n        # Step 3: Calculate the first Piola-Kirchhoff stress P\n        # Lamé parameters\n        mu = E / (2 * (1 + nu))\n        lmbda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n\n        # Kinematic quantities\n        J = np.linalg.det(F)\n        if J = 0:\n            raise ValueError(\"Element inverted: J = 0\")\n        \n        F_inv_T = np.linalg.inv(F).T\n\n        # First Piola-Kirchhoff stress tensor\n        P = mu * (F - F_inv_T) + lmbda * np.log(J) * F_inv_T\n\n        # Steps 4  5: Calculate force densities and nodal forces\n        nodal_forces = []\n        for i in range(3):\n            # Elastic force density g_a = P * grad_N_a\n            g_a = P @ grads_N[i]\n            # Nodal force F_a = A_e * g_a\n            F_a = A_e * g_a\n            nodal_forces.extend(F_a)\n\n        results_all_cases.append(nodal_forces)\n\n    # Format output string\n    formatted_cases = []\n    for forces in results_all_cases:\n        case_str = \",\".join([f\"{f:.6f}\" for f in forces])\n        formatted_cases.append(f\"[{case_str}]\")\n    \n    final_output = f\"[{','.join(formatted_cases)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "The \"immersed\" nature of IFEM hinges on the seamless communication between the Lagrangian solid mesh and the background Eulerian fluid grid. This practice delves into the mathematical core of this coupling: the regularized delta function, or kernel. You will work with a specific 4-point kernel to compute interpolation weights and verify the fundamental properties of partition of unity and first-moment conservation, which are crucial for ensuring accuracy and physical consistency in the transfer of information between the two domains.",
            "id": "4108474",
            "problem": "In the Immersed Finite Element Method (IFEM) for deformable solids interacting with complex fluids, the coupling between the Lagrangian solid mesh and the Eulerian fluid grid is commonly realized by a separable, regularized delta kernel. Consider a uniform Cartesian Eulerian grid with spacing $h$, and let a Lagrangian point be located at $(x,y,z)$ with normalized coordinates $(x/h,y/h,z/h)=(1.3,2.7,3.1)$. The interpolation weights used to sample Eulerian fields at the Lagrangian point are constructed from the one-dimensional $4$-point kernel $\\phi(r)$, defined for $r \\geq 0$ by\n$$\n\\phi(r)=\n\\begin{cases}\n\\frac{1}{8}\\left(3-2r+\\sqrt{1+4r-4r^{2}}\\right),  0\\leq r\\leq 1, \\\\\n\\frac{1}{8}\\left(5-2r-\\sqrt{-7+12r-4r^{2}}\\right),  1\\leq r\\leq 2, \\\\\n0,  r\\geq 2.\n\\end{cases}\n$$\nThe three-dimensional interpolation weights are separable products\n$$\nw_{i,j,k}=\\phi\\!\\left(|i-x/h|\\right)\\,\\phi\\!\\left(|j-y/h|\\right)\\,\\phi\\!\\left(|k-z/h|\\right),\n$$\nwhere $(i,j,k)\\in\\mathbb{Z}^{3}$ are the Eulerian grid indices in each coordinate direction. For the given $(x/h,y/h,z/h)$, identify the four contributing indices in each direction, compute the corresponding one-dimensional weights $\\{w^{x}_{i}\\}$, $\\{w^{y}_{j}\\}$, and $\\{w^{z}_{k}\\}$, and use them to specify the nonzero three-dimensional weights $w_{i,j,k}$ as products. Then, verify the partition of unity and first-moment conditions:\n$$\n\\sum_{i,j,k} w_{i,j,k}=1,\\quad\n\\sum_{i,j,k} i\\,w_{i,j,k}=\\frac{x}{h},\\quad\n\\sum_{i,j,k} j\\,w_{i,j,k}=\\frac{y}{h},\\quad\n\\sum_{i,j,k} k\\,w_{i,j,k}=\\frac{z}{h}.\n$$\nReport the final tuple $\\left(S,M_{x},M_{y},M_{z}\\right)$ of the partition sum $S$ and the three first moments $M_{x}$, $M_{y}$, $M_{z}$. Express the final tuple in dimensionless form. No rounding is required.",
            "solution": "The user wants to solve the problem by following these steps:\n1.  **Problem Validation:** The problem is first validated for scientific soundness, completeness, and objectivity.\n    -   **Givens:** The problem provides the normalized coordinates of a Lagrangian point $(x/h, y/h, z/h) = (1.3, 2.7, 3.1)$, a specific 4-point kernel $\\phi(r)$, the definition of separable 3D weights $w_{i,j,k}$, and the partition of unity and first-moment conditions to be verified.\n    -   **Validation:** The problem is scientifically grounded, describing a standard interpolation scheme in computational mechanics (Immersed Finite Element Method). The kernel function $\\phi(r)$ is a well-defined, continuous, piecewise function with compact support, typical for such applications. The problem is well-posed, objective, and contains all necessary information for a unique solution.\n    -   **Verdict:** The problem is valid.\n\n2.  **Solution Strategy:** The core of the problem is to compute the one-dimensional (1D) weights for each coordinate direction and then use the separability of the 3D weights to verify the required properties.\n    -   The 3D sums for the partition of unity $(S)$ and first moments $(M_x, M_y, M_z)$ can be factored into products of 1D sums.\n    -   For each coordinate, we identify the contributing integer grid indices based on the compact support of $\\phi(r)$.\n    -   We then compute the 1D weights for each direction and verify the 1D partition of unity and first-moment properties.\n    -   Finally, we assemble the 3D results from the 1D results.\n\n### Step 1: Preliminary Setup\nLet the normalized coordinates of the Lagrangian point be $x' = x/h = 1.3$, $y' = y/h = 2.7$, and $z' = z/h = 3.1$. The 3D interpolation weight is given as a separable product of 1D kernels:\n$$\nw_{i,j,k} = \\phi\\left(|i - x'|\\right) \\, \\phi\\left(|j - y'|\\right) \\, \\phi\\left(|k - z'|\\right)\n$$\nWe define the 1D weights for each direction as:\n$$\nw^{x}_{i} = \\phi(|i-x'|), \\quad w^{y}_{j} = \\phi(|j-y'|), \\quad w^{z}_{k} = \\phi(|k-z'|)\n$$\nThe kernel $\\phi(r)$ is non-zero only for $0 \\le r  2$. Therefore, the weights $w^x_i$, $w^y_j$, and $w^z_k$ are non-zero only for grid indices $i, j, k$ that satisfy $|i-x'|  2$, $|j-y'|  2$, and $|k-z'|  2$, respectively.\n\n### Step 2: Calculation of 1D Weights and Properties\n\n**For the x-direction ($x' = 1.3$):**\nThe contributing indices $i$ must satisfy $|i - 1.3|  2$, which implies $-0.7  i  3.3$. The integer indices are $i \\in \\{0, 1, 2, 3\\}$.\nThe arguments to the kernel function are:\n-   $i=0$: $r = |0 - 1.3| = 1.3$. This is in the range $[1, 2]$.\n-   $i=1$: $r = |1 - 1.3| = 0.3$. This is in the range $[0, 1]$.\n-   $i=2$: $r = |2 - 1.3| = 0.7$. This is in the range $[0, 1]$.\n-   $i=3$: $r = |3 - 1.3| = 1.7$. This is in the range $[1, 2]$.\n\nWe compute the weights using the given definition of $\\phi(r)$:\n-   $w^{x}_{0} = \\phi(1.3) = \\frac{1}{8}\\left(5 - 2(1.3) - \\sqrt{-7 + 12(1.3) - 4(1.3)^2}\\right) = \\frac{1}{8}\\left(2.4 - \\sqrt{1.84}\\right) = \\frac{1}{8}\\left(\\frac{12}{5} - \\frac{\\sqrt{46}}{5}\\right) = \\frac{12 - \\sqrt{46}}{40}$.\n-   $w^{x}_{1} = \\phi(0.3) = \\frac{1}{8}\\left(3 - 2(0.3) + \\sqrt{1 + 4(0.3) - 4(0.3)^2}\\right) = \\frac{1}{8}\\left(2.4 + \\sqrt{1.84}\\right) = \\frac{12 + \\sqrt{46}}{40}$.\n-   $w^{x}_{2} = \\phi(0.7) = \\frac{1}{8}\\left(3 - 2(0.7) + \\sqrt{1 + 4(0.7) - 4(0.7)^2}\\right) = \\frac{1}{8}\\left(1.6 + \\sqrt{1.84}\\right) = \\frac{8 + \\sqrt{46}}{40}$.\n-   $w^{x}_{3} = \\phi(1.7) = \\frac{1}{8}\\left(5 - 2(1.7) - \\sqrt{-7 + 12(1.7) - 4(1.7)^2}\\right) = \\frac{1}{8}\\left(1.6 - \\sqrt{1.84}\\right) = \\frac{8 - \\sqrt{46}}{40}$.\n\nThe 1D partition of unity for the x-direction is:\n$$\n\\sum_{i} w^{x}_{i} = \\frac{(12 - \\sqrt{46}) + (12 + \\sqrt{46}) + (8 + \\sqrt{46}) + (8 - \\sqrt{46})}{40} = \\frac{12+12+8+8}{40} = \\frac{40}{40} = 1\n$$\nThe 1D first moment for the x-direction is:\n$$\n\\sum_{i} i \\, w^{x}_{i} = \\frac{0(12 - \\sqrt{46}) + 1(12 + \\sqrt{46}) + 2(8 + \\sqrt{46}) + 3(8 - \\sqrt{46})}{40} = \\frac{12+\\sqrt{46} + 16+2\\sqrt{46} + 24-3\\sqrt{46}}{40} = \\frac{52}{40} = \\frac{13}{10} = 1.3\n$$\nThis matches $x'$.\n\n**For the y-direction ($y' = 2.7$):**\nThe contributing indices $j$ must satisfy $|j - 2.7|  2$, which implies $0.7  j  4.7$. The integer indices are $j \\in \\{1, 2, 3, 4\\}$.\nThe arguments are $r \\in \\{|1-2.7|, |2-2.7|, |3-2.7|, |4-2.7|\\} = \\{1.7, 0.7, 0.3, 1.3\\}$. This is the same set of arguments as for the x-direction.\n-   $w^{y}_{1} = \\phi(1.7) = \\frac{8 - \\sqrt{46}}{40}$.\n-   $w^{y}_{2} = \\phi(0.7) = \\frac{8 + \\sqrt{46}}{40}$.\n-   $w^{y}_{3} = \\phi(0.3) = \\frac{12 + \\sqrt{46}}{40}$.\n-   $w^{y}_{4} = \\phi(1.3) = \\frac{12 - \\sqrt{46}}{40}$.\n\nThe 1D partition of unity is $\\sum_{j} w^{y}_{j} = 1$. The 1D first moment is:\n$$\n\\sum_{j} j \\, w^{y}_{j} = \\frac{1(8 - \\sqrt{46}) + 2(8 + \\sqrt{46}) + 3(12 + \\sqrt{46}) + 4(12 - \\sqrt{46})}{40} = \\frac{8- \\sqrt{46} + 16+2\\sqrt{46} + 36+3\\sqrt{46} + 48-4\\sqrt{46}}{40} = \\frac{108}{40} = \\frac{27}{10} = 2.7\n$$\nThis matches $y'$.\n\n**For the z-direction ($z' = 3.1$):**\nThe contributing indices $k$ must satisfy $|k - 3.1|  2$, which implies $1.1  k  5.1$. The integer indices are $k \\in \\{2, 3, 4, 5\\}$.\nThe arguments are $r \\in \\{|2-3.1|, |3-3.1|, |4-3.1|, |5-3.1|\\} = \\{1.1, 0.1, 0.9, 1.9\\}$.\n-   $w^{z}_{2} = \\phi(1.1) = \\frac{1}{8}\\left(5-2.2-\\sqrt{-7+13.2-4(1.21)}\\right) = \\frac{1}{8}\\left(2.8-\\sqrt{1.36}\\right) = \\frac{14-\\sqrt{34}}{40}$.\n-   $w^{z}_{3} = \\phi(0.1) = \\frac{1}{8}\\left(3-0.2+\\sqrt{1+0.4-4(0.01)}\\right) = \\frac{1}{8}\\left(2.8+\\sqrt{1.36}\\right) = \\frac{14+\\sqrt{34}}{40}$.\n-   $w^{z}_{4} = \\phi(0.9) = \\frac{1}{8}\\left(3-1.8+\\sqrt{1+3.6-4(0.81)}\\right) = \\frac{1}{8}\\left(1.2+\\sqrt{1.36}\\right) = \\frac{6+\\sqrt{34}}{40}$.\n-   $w^{z}_{5} = \\phi(1.9) = \\frac{1}{8}\\left(5-3.8-\\sqrt{-7+22.8-4(3.61)}\\right) = \\frac{1}{8}\\left(1.2-\\sqrt{1.36}\\right) = \\frac{6-\\sqrt{34}}{40}$.\n\nThe 1D partition of unity is $\\sum_{k} w^{z}_{k} = 1$. The 1D first moment is:\n$$\n\\sum_{k} k \\, w^{z}_{k} = \\frac{2(14-\\sqrt{34}) + 3(14+\\sqrt{34}) + 4(6+\\sqrt{34}) + 5(6-\\sqrt{34})}{40} = \\frac{28-2\\sqrt{34} + 42+3\\sqrt{34} + 24+4\\sqrt{34} + 30-5\\sqrt{34}}{40} = \\frac{124}{40} = \\frac{31}{10} = 3.1\n$$\nThis matches $z'$.\n\n### Step 3: Verification of 3D Conditions\nThe problem asks to report the tuple $(S, M_x, M_y, M_z)$ where these quantities are the 3D sums. Due to the separable nature of the weights, we can factor the sums:\n$$\nS = \\sum_{i,j,k} w_{i,j,k} = \\sum_{i,j,k} w^{x}_{i} w^{y}_{j} w^{z}_{k} = \\left(\\sum_{i} w^{x}_{i}\\right) \\left(\\sum_{j} w^{y}_{j}\\right) \\left(\\sum_{k} w^{z}_{k}\\right)\n$$\n$$\nM_{x} = \\sum_{i,j,k} i \\, w_{i,j,k} = \\left(\\sum_{i} i \\, w^{x}_{i}\\right) \\left(\\sum_{j} w^{y}_{j}\\right) \\left(\\sum_{k} w^{z}_{k}\\right)\n$$\n$$\nM_{y} = \\sum_{i,j,k} j \\, w_{i,j,k} = \\left(\\sum_{i} w^{x}_{i}\\right) \\left(\\sum_{j} j \\, w^{y}_{j}\\right) \\left(\\sum_{k} w^{z}_{k}\\right)\n$$\n$$\nM_{z} = \\sum_{i,j,k} k \\, w_{i,j,k} = \\left(\\sum_{i} w^{x}_{i}\\right) \\left(\\sum_{j} w^{y}_{j}\\right) \\left(\\sum_{k} k \\, w^{z}_{k}\\right)\n$$\nSubstituting the 1D results:\n-   $S = (1) \\cdot (1) \\cdot (1) = 1$.\n-   $M_{x} = (1.3) \\cdot (1) \\cdot (1) = 1.3 = \\frac{13}{10}$.\n-   $M_{y} = (1) \\cdot (2.7) \\cdot (1) = 2.7 = \\frac{27}{10}$.\n-   $M_{z} = (1) \\cdot (1) \\cdot (3.1) = 3.1 = \\frac{31}{10}$.\n\nThe partition of unity and first-moment conditions are satisfied. The final tuple is $(S, M_x, M_y, M_z)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{13}{10}  \\frac{27}{10}  \\frac{31}{10} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "One of the most significant numerical hurdles in explicit fluid-structure interaction simulations is the \"added-mass\" effect, which can lead to violent instabilities when a light solid is coupled to a dense fluid. This practice uses a simplified two-degree-of-freedom model to illuminate this critical phenomenon. By deriving the analytical stability limit for the coupled system and validating it with numerical experiments, you will develop an essential understanding of the stability constraints that govern explicit FSI simulations and learn how to choose a stable time step.",
            "id": "4108437",
            "problem": "Consider a minimal linear model of an Immersed Finite Element Method (IFEM) explicit partitioned coupling between a deformable solid and a surrounding fluid, idealized in one spatial dimension. The deformable solid is represented by a single Lagrangian degree of freedom with displacement $u_s(t)$ and mass $m_s$ attached to a linear spring of stiffness $k_s$. The fluid is represented by a single Eulerian degree of freedom with displacement $u_f(t)$ and mass $m_f$ attached to a linear spring of stiffness $k_f$ that models the discrete fluid response. The solid-fluid interface is enforced by a penalty coupling with coefficient $\\alpha$, producing equal and opposite interface forces proportional to the displacement mismatch. Neglect any damping and external forces. The coupled equations of motion follow from Newton’s Second Law of Motion:\n$$\nm_s \\, \\ddot{u}_s(t) + k_s \\, u_s(t) = \\alpha \\left(u_f(t) - u_s(t)\\right),\n$$\n$$\nm_f \\, \\ddot{u}_f(t) + k_f \\, u_f(t) = -\\alpha \\left(u_f(t) - u_s(t)\\right).\n$$\nDefine the mass matrix $M = \\mathrm{diag}(m_s, m_f)$ and the stiffness matrix\n$$\nK = \\begin{bmatrix}\nk_s + \\alpha  -\\alpha \\\\\n-\\alpha  k_f + \\alpha\n\\end{bmatrix}.\n$$\nA standard explicit second-order central-difference time integration scheme for the undamped linear system $M \\, \\ddot{\\mathbf{u}}(t) + K \\, \\mathbf{u}(t) = \\mathbf{0}$ (with $\\mathbf{u}(t) = [u_s(t), u_f(t)]^\\top$) uses the recurrence\n$$\n\\mathbf{u}_{n+1} = 2 \\mathbf{u}_n - \\mathbf{u}_{n-1} - \\Delta t^2 \\, M^{-1} K \\, \\mathbf{u}_n,\n$$\nwith discrete time step $\\Delta t  0$. The critical time step $\\Delta t_{\\mathrm{crit}}$ is the largest $\\Delta t$ for which the scheme remains stable for all initial conditions.\n\nYour task is to:\n- Derive, from first principles, the stability condition for the central-difference method applied to the above two-degree-of-freedom coupled system.\n- Compute the critical time step $\\Delta t_{\\mathrm{crit}}$ in seconds for a set of given parameter values by analyzing the eigenstructure of the linear update.\n- Validate the prediction by running numerical experiments of the central-difference scheme with an initial condition $\\mathbf{u}_0$ and $\\dot{\\mathbf{u}}_0 = \\mathbf{0}$, using $\\Delta t_{\\mathrm{below}} = 0.95 \\, \\Delta t_{\\mathrm{crit}}$ and $\\Delta t_{\\mathrm{above}} = 1.05 \\, \\Delta t_{\\mathrm{crit}}$. Classify a run as \"stable\" if the maximum displacement norm over the simulation does not exceed $100$ times the initial displacement norm, and \"unstable\" otherwise.\n\nUse the following test suite of parameter values, where masses are in kilograms (kg), stiffnesses are in Newtons per meter (N/m), and the penalty coefficient is in Newtons per meter (N/m):\n1. Light solid embedded in dense fluid (high coupling): $(m_s, k_s, m_f, k_f, \\alpha) = (0.01, 100, 1.0, 0.0, 2000)$.\n2. Balanced masses and stiffnesses (moderate coupling): $(m_s, k_s, m_f, k_f, \\alpha) = (1.0, 100, 1.0, 100, 1000)$.\n3. Heavy solid embedded in light fluid (moderate coupling): $(m_s, k_s, m_f, k_f, \\alpha) = (10.0, 100, 0.1, 0.0, 500)$.\n4. Decoupled limit (no coupling): $(m_s, k_s, m_f, k_f, \\alpha) = (0.5, 100, 2.0, 50, 0)$.\n\nImplementation requirements:\n- For each test case, compute $\\Delta t_{\\mathrm{crit}}$ in seconds, rounded to six decimal places.\n- For validation, perform central-difference simulations with initial displacement $\\mathbf{u}_0 = [10^{-2}, -10^{-2}]^\\top$ and initial velocity $\\dot{\\mathbf{u}}_0 = [0, 0]^\\top$, for a fixed number of discrete steps sufficient to robustly classify stability.\n- Produce a single line of output containing the results as a comma-separated list of per-case triples, each triple being a list of the form $[\\Delta t_{\\mathrm{crit}}, \\mathrm{stable\\_below}, \\mathrm{unstable\\_above}]$, where $\\Delta t_{\\mathrm{crit}}$ is a float in seconds, and $\\mathrm{stable\\_below}$ and $\\mathrm{unstable\\_above}$ are booleans.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated Python-style list of lists, for example: $[[t_1,s_1,u_1],[t_2,s_2,u_2],\\dots]$, where each $t_i$ is expressed in seconds as a float rounded to six decimal places, and $s_i$, $u_i$ are booleans.",
            "solution": "We start from Newton’s Second Law of Motion, which states that the sum of forces equals mass times acceleration. For the solid and fluid degrees of freedom, the interface penalty force is modeled as a linear spring connecting $u_s(t)$ and $u_f(t)$ with stiffness $\\alpha$. With no damping or external forces, we obtain the coupled equations\n$$\nm_s \\, \\ddot{u}_s(t) + k_s \\, u_s(t) = \\alpha \\left(u_f(t) - u_s(t)\\right),\n\\qquad\nm_f \\, \\ddot{u}_f(t) + k_f \\, u_f(t) = -\\alpha \\left(u_f(t) - u_s(t)\\right).\n$$\nCollecting in vector form with $\\mathbf{u}(t) = [u_s(t), u_f(t)]^\\top$, we write\n$$\nM \\, \\ddot{\\mathbf{u}}(t) + K \\, \\mathbf{u}(t) = \\mathbf{0},\n$$\nwhere\n$$\nM = \\begin{bmatrix} m_s  0 \\\\ 0  m_f \\end{bmatrix}, \\quad\nK = \\begin{bmatrix} k_s + \\alpha  -\\alpha \\\\ -\\alpha  k_f + \\alpha \\end{bmatrix}.\n$$\nThis is a linear, undamped, constant-coefficient second-order system. Its modal properties are governed by the generalized eigenproblem\n$$\nK \\, \\boldsymbol{\\phi} = \\lambda \\, M \\, \\boldsymbol{\\phi},\n$$\nwhere $\\lambda \\ge 0$ are the squared natural frequencies, i.e., $\\omega^2 = \\lambda$, and $\\boldsymbol{\\phi}$ are mode shapes. Equivalently, $\\lambda$ are the eigenvalues of $A = M^{-1} K$.\n\nFor time integration, we consider the explicit central-difference (also known as Störmer–Verlet) method for second-order systems, which for constant $M$ and $K$ reads\n$$\n\\mathbf{u}_{n+1} = 2 \\mathbf{u}_n - \\mathbf{u}_{n-1} - \\Delta t^2 \\, M^{-1} K \\, \\mathbf{u}_n,\n$$\nwith $\\Delta t$ the time step and $n$ an integer time index. Given initial conditions $\\mathbf{u}_0$ and $\\dot{\\mathbf{u}}_0$, the first step is constructed as\n$$\n\\mathbf{u}_1 = \\mathbf{u}_0 + \\Delta t \\, \\dot{\\mathbf{u}}_0 - \\frac{1}{2} \\Delta t^2 \\, M^{-1} K \\, \\mathbf{u}_0.\n$$\nTo assess stability, we analyze the recurrence in modal coordinates. Let $\\boldsymbol{\\phi}$ be an eigenvector of $A = M^{-1} K$ with eigenvalue $\\lambda$. Projecting $\\mathbf{u}_n$ onto this mode yields a scalar recurrence\n$$\nq_{n+1} = 2 q_n - q_{n-1} - \\Delta t^2 \\lambda \\, q_n,\n$$\nwhere $q_n$ is the modal amplitude. Seeking solutions of the form $q_n = r^n$ gives the characteristic polynomial\n$$\nr^2 - (2 - \\Delta t^2 \\lambda) r + 1 = 0.\n$$\nThe roots are\n$$\nr_{\\pm} = \\frac{2 - \\Delta t^2 \\lambda \\pm \\sqrt{(2 - \\Delta t^2 \\lambda)^2 - 4}}{2}.\n$$\nStability of the central-difference scheme requires that $|r_{\\pm}| \\le 1$ for every mode, which is guaranteed when the discriminant is non-positive and the roots lie on the unit circle. The condition is\n$$\n(2 - \\Delta t^2 \\lambda)^2 - 4 \\le 0 \\quad \\Longleftrightarrow \\quad 0 \\le \\Delta t^2 \\lambda \\le 4.\n$$\nTherefore, for the largest eigenvalue $\\lambda_{\\max}$ of $A = M^{-1} K$, the necessary and sufficient stability condition is\n$$\n\\Delta t \\le \\Delta t_{\\mathrm{crit}} := \\frac{2}{\\sqrt{\\lambda_{\\max}}}.\n$$\nThis expresses the explicit stability limit as a Courant–Friedrichs–Lewy-type constraint determined by the highest natural frequency of the coupled system. It captures the added-mass effect: when the solid is light ($m_s$ small) and the fluid is heavy ($m_f$ large), the largest eigenvalue increases because the coupling shifts the highest frequency toward the solid’s displacement constrained by the fluid, thereby shrinking $\\Delta t_{\\mathrm{crit}}$.\n\nAlgorithmic design:\n1. For each test case, construct $M$ and $K$ using the given $(m_s, k_s, m_f, k_f, \\alpha)$.\n2. Compute $A = M^{-1} K$ and obtain its eigenvalues $\\{\\lambda_i\\}$; set $\\lambda_{\\max} = \\max_i \\lambda_i$.\n3. Compute the critical time step as $\\Delta t_{\\mathrm{crit}} = 2 / \\sqrt{\\lambda_{\\max}}$ in seconds and round to six decimal places.\n4. Validate via numerical experiments:\n   - Choose initial displacement $\\mathbf{u}_0 = [10^{-2}, -10^{-2}]^\\top$ and initial velocity $\\dot{\\mathbf{u}}_0 = \\mathbf{0}$.\n   - Compute $\\mathbf{u}_1$ using the central-difference first step formula.\n   - Iterate the recurrence $\\mathbf{u}_{n+1} = 2 \\mathbf{u}_n - \\mathbf{u}_{n-1} - \\Delta t^2 \\, A \\, \\mathbf{u}_n$ for a fixed number of steps (e.g., several thousand).\n   - Track the maximum Euclidean norm $\\|\\mathbf{u}_n\\|_2$ over the simulation. Classify the run as stable if $\\max_n \\|\\mathbf{u}_n\\|_2 \\le 100 \\, \\|\\mathbf{u}_0\\|_2$, and unstable otherwise.\n   - Perform runs for $\\Delta t_{\\mathrm{below}} = 0.95 \\, \\Delta t_{\\mathrm{crit}}$ and $\\Delta t_{\\mathrm{above}} = 1.05 \\, \\Delta t_{\\mathrm{crit}}$.\n5. Aggregate results: for each test case, produce the triple $[\\Delta t_{\\mathrm{crit}}, \\mathrm{stable\\_below}, \\mathrm{unstable\\_above}]$.\n\nNumerical considerations:\n- Since $M$ is diagonal with strictly positive entries, $M^{-1}$ exists and $A$ is well-defined.\n- For physically meaningful parameters with $k_s \\ge 0$, $k_f \\ge 0$, and $\\alpha \\ge 0$, $K$ is symmetric and positive semidefinite, ensuring non-negative eigenvalues $\\lambda_i$.\n- The central-difference scheme is conditionally stable under the derived limit; near the critical step, growth may be slow, so sufficient simulation length is necessary to observe instability when $\\Delta t  \\Delta t_{\\mathrm{crit}}$.\n\nThe final program implements these steps using numerical linear algebra to compute $\\lambda_{\\max}$ and simulates the explicit scheme to validate stability classifications. It outputs a single line containing the list of triples for the test suite as required. All time quantities are expressed in seconds.",
            "answer": "```python\nimport numpy as np\n\ndef compute_dt_crit(ms, ks, mf, kf, alpha):\n    # Construct mass and stiffness matrices\n    M = np.array([[ms, 0.0],\n                  [0.0, mf]], dtype=float)\n    K = np.array([[ks + alpha, -alpha],\n                  [-alpha, kf + alpha]], dtype=float)\n    # Compute A = M^{-1} K\n    Minv = np.array([[1.0/ms, 0.0],\n                     [0.0, 1.0/mf]], dtype=float)\n    A = Minv @ K\n    # Eigenvalues of A\n    lam = np.linalg.eigvals(A)\n    # Largest eigenvalue (real, non-negative for physical parameters)\n    lam_max = float(np.max(np.real(lam)))\n    # Critical time step\n    dtcrit = 2.0 / np.sqrt(lam_max) if lam_max  0 else float('inf')\n    return dtcrit\n\ndef simulate_central_difference(ms, ks, mf, kf, alpha, dt, steps, u0, v0):\n    # Setup matrices\n    M = np.array([[ms, 0.0],\n                  [0.0, mf]], dtype=float)\n    K = np.array([[ks + alpha, -alpha],\n                  [-alpha, kf + alpha]], dtype=float)\n    Minv = np.array([[1.0/ms, 0.0],\n                     [0.0, 1.0/mf]], dtype=float)\n    A = Minv @ K  # M^{-1} K\n\n    # Initial displacement and velocity\n    u_prev = np.array(u0, dtype=float)\n    v0_vec = np.array(v0, dtype=float)\n\n    # First step: u1 = u0 + dt*v0 - 0.5*dt^2*A*u0\n    u_curr = u_prev + dt * v0_vec - 0.5 * (dt ** 2) * (A @ u_prev)\n\n    # Track norms\n    init_norm = np.linalg.norm(u_prev)\n    max_norm = max(np.linalg.norm(u_prev), np.linalg.norm(u_curr))\n\n    # Iterate recurrence: u_{n+1} = 2 u_n - u_{n-1} - dt^2 A u_n\n    for _ in range(2, steps + 1):\n        u_next = 2.0 * u_curr - u_prev - (dt ** 2) * (A @ u_curr)\n        max_norm = max(max_norm, np.linalg.norm(u_next))\n        u_prev, u_curr = u_curr, u_next\n\n    # Stability classification\n    threshold = 100.0 * init_norm\n    stable = max_norm = threshold\n    return stable\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (ms, ks, mf, kf, alpha)\n    test_cases = [\n        (0.01, 100.0, 1.0, 0.0, 2000.0),  # Light solid, dense fluid, high coupling\n        (1.0, 100.0, 1.0, 100.0, 1000.0), # Balanced case\n        (10.0, 100.0, 0.1, 0.0, 500.0),   # Heavy solid, light fluid\n        (0.5, 100.0, 2.0, 50.0, 0.0),     # Decoupled limit (alpha=0)\n    ]\n\n    results = []\n    # Simulation parameters\n    steps = 6000\n    u0 = [1e-2, -1e-2]\n    v0 = [0.0, 0.0]\n\n    for case in test_cases:\n        ms, ks, mf, kf, alpha = case\n        dtcrit = compute_dt_crit(ms, ks, mf, kf, alpha)\n        # Guard against infinite/NaN dtcrit (should not occur with provided tests)\n        if not np.isfinite(dtcrit):\n            dtcrit_val = float('inf')\n            stable_below = True\n            unstable_above = False\n        else:\n            # Round to six decimals for output\n            dtcrit_val = round(dtcrit, 6)\n            dt_below = 0.95 * dtcrit\n            dt_above = 1.05 * dtcrit\n            stable_below = simulate_central_difference(ms, ks, mf, kf, alpha, dt_below, steps, u0, v0)\n            unstable_above = not simulate_central_difference(ms, ks, mf, kf, alpha, dt_above, steps, u0, v0)\n        results.append([dtcrit_val, stable_below, unstable_above])\n\n    # Final print statement in the exact required format.\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}