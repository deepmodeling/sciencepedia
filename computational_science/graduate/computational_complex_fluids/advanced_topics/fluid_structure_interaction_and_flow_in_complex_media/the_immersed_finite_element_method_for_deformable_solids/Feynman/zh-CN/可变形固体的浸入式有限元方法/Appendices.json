{
    "hands_on_practices": [
        {
            "introduction": "在任何沉浸式有限元（IFEM）模拟中，第一步都是精确地模拟可变形固体的弹性响应，这涉及到计算抵抗变形的内力。本练习  提供了一个直接的编程实践机会，将连续介质力学理论转化为具体的计算算法。它将指导您完成从变形梯度到驱动固体运动的最终节点力的完整计算过程。",
            "id": "4108443",
            "problem": "考虑一个二维可变形固体，在参考构形中通过线性三角形有限元进行离散，并采用浸入式方法嵌入流体中。浸入式有限元法在固体求积点处计算弹性力密度，并组装节点力，然后将节点力分布到流体上。你需要推导并实现固体求积点处弹性力密度的计算，并利用第一 Piola–Kirchhoff 应力张量和参考构形中形函数的梯度来组装节点内力向量。\n\n从超弹性固体的参考构形中的虚功原理以及第一 Piola–Kirchhoff 应力的定义出发。设参考域为 $\\Omega_0 \\subset \\mathbb{R}^2$，位形映射为 $\\boldsymbol{x}(\\boldsymbol{X})$，变形梯度为 $\\boldsymbol{F} = \\nabla_{\\boldsymbol{X}} \\boldsymbol{x}$。对于一个变分 $\\delta \\boldsymbol{u}$，内虚功由经过充分检验的公式给出\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_0} \\boldsymbol{P} : \\nabla_{\\boldsymbol{X}} \\delta \\boldsymbol{u} \\, \\mathrm{d}\\Omega_0,\n$$\n其中 $\\boldsymbol{P}$ 是第一 Piola–Kirchhoff 应力张量。使用有限元形函数 $N_a(\\boldsymbol{X})$ 将虚位移表示为 $\\delta \\boldsymbol{u}(\\boldsymbol{X}) = \\sum_a \\delta \\boldsymbol{d}_a N_a(\\boldsymbol{X})$，其中 $\\delta \\boldsymbol{d}_a$ 是节点变分。这导出了满足以下条件的内节点力向量 $\\{\\boldsymbol{F}_a\\}$\n$$\n\\delta W_{\\text{int}} = \\sum_a \\delta \\boldsymbol{d}_a \\cdot \\boldsymbol{F}_a, \\quad \\text{其中} \\quad \\boldsymbol{F}_a = \\int_{\\Omega_0} \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a \\, \\mathrm{d}\\Omega_0.\n$$\n将与节点 $a$ 相关联的固体求积点 $\\boldsymbol{X}_q$ 处的弹性力密度贡献定义为向量\n$$\n\\boldsymbol{g}_a(\\boldsymbol{X}_q) = \\boldsymbol{P}(\\boldsymbol{X}_q) \\, \\nabla_{\\boldsymbol{X}} N_a(\\boldsymbol{X}_q),\n$$\n其单位为 $\\mathrm{N}/\\mathrm{m}^3$（单位参考体积的力）。使用带有权重 $w_q$（在平面外单位厚度的假设下，对于二维参考域，单位为 $\\mathrm{m}^2$）的数值求积，节点力可组装为\n$$\n\\boldsymbol{F}_a \\approx \\sum_q w_q \\, \\boldsymbol{g}_a(\\boldsymbol{X}_q),\n$$\n其单位为 $\\mathrm{N}$。\n\n对于线性三角形单元，形函数梯度 $\\nabla_{\\boldsymbol{X}} N_a$ 在整个单元上是恒定的，可以直接从参考节点坐标计算得出。对于线性三角形单元，变形梯度在单元内是恒定的，可计算为\n$$\n\\boldsymbol{F} = \\sum_{a=1}^3 \\boldsymbol{x}_a \\otimes \\nabla_{\\boldsymbol{X}} N_a,\n$$\n其中 $\\boldsymbol{x}_a$ 是节点的当前坐标，$\\otimes$ 表示张量（外）积。\n\n对于本构模型，考虑一个可压缩的 Neo–Hookean 超弹性固体，其应变能密度为\n$$\n\\Psi(\\boldsymbol{F}) = \\frac{\\mu}{2} \\left( \\boldsymbol{F} : \\boldsymbol{F} - 2 \\right) - \\mu \\ln J + \\frac{\\lambda}{2} (\\ln J)^2,\n$$\n其中 $J = \\det \\boldsymbol{F}$，Lamé 参数 $\\mu = \\frac{E}{2(1+\\nu)}$ 和 $\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 用杨氏模量 $E$ 和泊松比 $\\nu$ 表示。相应的第一 Piola–Kirchhoff 应力为\n$$\n\\boldsymbol{P} = \\mu \\left( \\boldsymbol{F} - \\boldsymbol{F}^{-T} \\right) + \\lambda \\, \\ln J \\, \\boldsymbol{F}^{-T}.\n$$\n\n实现一个程序，针对每个指定的测试用例，计算：\n1. $a=1,2,3$ 对应的形函数梯度 $\\nabla_{\\boldsymbol{X}} N_a$。\n2. 使用线性三角形公式计算质心求积点处的变形梯度 $\\boldsymbol{F}$。\n3. 使用可压缩 Neo–Hookean 定律计算第一 Piola–Kirchhoff 应力 $\\boldsymbol{P}$。\n4. 质心处的弹性力密度向量 $\\boldsymbol{g}_a(\\boldsymbol{X}_q) = \\boldsymbol{P} \\nabla_{\\boldsymbol{X}} N_a$。\n5. 使用单点质心求积法计算节点力 $\\boldsymbol{F}_a = w \\, \\boldsymbol{g}_a(\\boldsymbol{X}_q)$，其中权重 $w = A$（单元面积），并假设平面外单位厚度。\n\n最终的节点力以牛顿（N）为单位表示。角度单位不适用。输出必须是浮点数。\n\n测试套件：\n- 用例 1（一般变形，中等可压缩性）：参考三角形节点 $\\boldsymbol{X}_1=(0,0)$、$\\boldsymbol{X}_2=(1,0)$、$\\boldsymbol{X}_3=(0,1)$，当前节点 $\\boldsymbol{x}_1=(0.00,0.00)$、$\\boldsymbol{x}_2=(1.05,0.02)$、$\\boldsymbol{x}_3=(-0.01,1.10)$，材料参数 $E=1.0\\times 10^6 \\, \\mathrm{Pa}$、$\\nu=0.35$。\n- 用例 2（均匀膨胀）：参考三角形相同，当前节点由均匀缩放 $\\boldsymbol{x}_a = \\alpha \\boldsymbol{X}_a$ 给出，其中 $\\alpha = 1.02$，材料参数 $E=1.0\\times 10^6 \\, \\mathrm{Pa}$、$\\nu=0.35$。\n- 用例 3（近不可压缩材料）：几何形状和当前节点与用例 1 相同，材料参数 $E=1.0\\times 10^6 \\, \\mathrm{Pa}$、$\\nu=0.49$。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。每个测试用例的结果本身必须是一个用方括号括起来的逗号分隔列表，按 $[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}]$ 的顺序包含节点 1、2、3 的节点力分量（单位为牛顿），每个浮点数格式化为六位小数。例如，输出必须如下所示：\n$$\n[\\,[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}],\\,[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}],\\,[F_{1x},F_{1y},F_{2x},F_{2y},F_{3x},F_{3y}]\\,].\n$$",
            "solution": "问题陈述经过严格验证，确认有效。它在科学上基于连续介质力学和有限元方法的原理，问题提法适定、客观，并为获得唯一解提供了完整且一致的信息集。任务是计算在指定的变形和材料属性下，一个二维线性三角形单元的节点弹性力。\n\n问题的核心在于有限元背景下虚功原理的应用。内虚功 $\\delta W_{\\text{int}}$ 等于节点力 $\\boldsymbol{F}_a$ 在虚节点位移 $\\delta \\boldsymbol{d}_a$ 下所做的功：\n$$\n\\delta W_{\\text{int}} = \\sum_a \\delta \\boldsymbol{d}_a \\cdot \\boldsymbol{F}_a\n$$\n问题给出了使用第一 Piola-Kirchhoff 应力张量 $\\boldsymbol{P}$ 的连续介质力学内虚功表达式：\n$$\n\\delta W_{\\text{int}} = \\int_{\\Omega_0} \\boldsymbol{P} : \\nabla_{\\boldsymbol{X}} \\delta \\boldsymbol{u} \\, \\mathrm{d}\\Omega_0\n$$\n其中 $\\Omega_0$ 是参考域。通过将虚位移的有限元近似 $\\delta \\boldsymbol{u}(\\boldsymbol{X}) = \\sum_b N_b(\\boldsymbol{X}) \\delta \\boldsymbol{d}_b$ 代入积分中，我们得到节点 $a$ 处的节点力表达式：\n$$\n\\boldsymbol{F}_a = \\int_{\\Omega_0} \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a \\, \\mathrm{d}\\Omega_0\n$$\n对于一个在平面外单位厚度 $t=1$ 的普遍假设下分析的二维问题，参考体积元 $\\mathrm{d}\\Omega_0$ 变为 $t \\cdot \\mathrm{d}A_0 = \\mathrm{d}A_0$，其中 $\\mathrm{d}A_0$ 是参考面积元。该积分在单元面积 $A_e$ 上进行计算。对于线性三角形单元，量 $\\boldsymbol{P}$ 和 $\\nabla_{\\boldsymbol{X}} N_a$ 在单元内部是恒定的。因此，在质心处的单点求积是精确的：\n$$\n\\boldsymbol{F}_a = \\left( \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a \\right) \\int_{A_e} \\mathrm{d}A_0 = A_e \\cdot \\boldsymbol{P} \\cdot \\nabla_{\\boldsymbol{X}} N_a\n$$\n其中 $A_e$ 是单元在参考构形中的面积。问题将力密度定义为 $\\boldsymbol{g}_a = \\boldsymbol{P} \\nabla_{\\boldsymbol{X}} N_a$，求积权重定义为 $w = A_e$，这与该公式是一致的。\n\n求解过程通过为每个测试用例实现五个指定的计算步骤来进行。\n\n**第 1 步：形函数梯度**\n对于在参考构形中具有顶点 $\\boldsymbol{X}_1, \\boldsymbol{X}_2, \\boldsymbol{X}_3$ 的二维线性三角形单元，其重心形函数 $N_a(\\boldsymbol{X})$ 的梯度为恒定向量，由以下公式给出：\n$$\n\\nabla_{\\boldsymbol{X}} N_1 = \\frac{1}{2A_e} \\begin{pmatrix} Y_2 - Y_3 \\\\ X_3 - X_2 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_2 = \\frac{1}{2A_e} \\begin{pmatrix} Y_3 - Y_1 \\\\ X_1 - X_3 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_3 = \\frac{1}{2A_e} \\begin{pmatrix} Y_1 - Y_2 \\\\ X_2 - X_1 \\end{pmatrix}\n$$\n其中 $A_e$ 是参考三角形的面积：\n$$\nA_e = \\frac{1}{2} \\det \\begin{pmatrix} X_2 - X_1  Y_2 - Y_1 \\\\ X_3 - X_1  Y_3 - Y_1 \\end{pmatrix} = \\frac{1}{2} |(X_2-X_1)(Y_3-Y_1) - (X_3-X_1)(Y_2-Y_1)|\n$$\n对于所有测试用例中给定的特定参考三角形，其顶点为 $\\boldsymbol{X}_1 = (0,0)$、$\\boldsymbol{X}_2 = (1,0)$ 和 $\\boldsymbol{X}_3 = (0,1)$，面积为 $A_e = 0.5$。梯度为：\n$$\n\\nabla_{\\boldsymbol{X}} N_1 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\nabla_{\\boldsymbol{X}} N_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n\n**第 2 步：变形梯度**\n对于线性单元，变形梯度 $\\boldsymbol{F}$ 是恒定的，由以下公式给出：\n$$\n\\boldsymbol{F} = \\sum_{a=1}^3 \\boldsymbol{x}_a \\otimes \\nabla_{\\boldsymbol{X}} N_a\n$$\n其中 $\\boldsymbol{x}_a$ 是当前的节点坐标。对于特定的参考三角形几何形状，此和简化为：\n$$\n\\boldsymbol{F} = \\boldsymbol{x}_1 \\otimes \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} + \\boldsymbol{x}_2 \\otimes \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\boldsymbol{x}_3 \\otimes \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n= \\begin{pmatrix} x_{2x} - x_{1x}  x_{3x} - x_{1x} \\\\ x_{2y} - x_{1y}  x_{3y} - x_{1y} \\end{pmatrix}\n$$\n该矩阵将根据每个测试用例中指定的当前节点坐标 $\\{\\boldsymbol{x}_a\\}$ 进行计算。\n\n**第 3 步：第一 Piola–Kirchhoff 应力**\n可压缩 Neo-Hookean 材料的本构定律为：\n$$\n\\boldsymbol{P} = \\mu \\left( \\boldsymbol{F} - \\boldsymbol{F}^{-T} \\right) + \\lambda \\, \\ln J \\, \\boldsymbol{F}^{-T}\n$$\n首先，根据杨氏模量 $E$ 和泊松比 $\\nu$ 计算 Lamé 参数 $\\mu$ 和 $\\lambda$：\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\quad \\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)}\n$$\n接着，从第 2 步中获得的变形梯度 $\\boldsymbol{F}$ 计算运动学量 $J = \\det \\boldsymbol{F}$ 和逆转置 $\\boldsymbol{F}^{-T}$。然后将这些值代入本构方程，求得应力张量 $\\boldsymbol{P}$。\n\n**第 4 步：弹性力密度**\n每个节点 $a$ 的弹性力密度贡献通过矩阵-向量乘积计算：\n$$\n\\boldsymbol{g}_a = \\boldsymbol{P} \\, \\nabla_{\\boldsymbol{X}} N_a\n$$\n对每个节点 $a \\in \\{1,2,3\\}$ 执行此计算，得到三个力密度向量 $\\boldsymbol{g}_1, \\boldsymbol{g}_2, \\boldsymbol{g}_3$。\n\n**第 5 步：节点力**\n每个节点 $a$ 的最终节点力使用单点求积法组装，该方法可简化为标量乘法：\n$$\n\\boldsymbol{F}_a = A_e \\cdot \\boldsymbol{g}_a = A_e \\cdot \\boldsymbol{P} \\cdot \\nabla_{\\boldsymbol{X}} N_a\n$$\n对于给定的参考单元，$A_e = 0.5$，因此力的计算公式为 $\\boldsymbol{F}_a = 0.5 \\cdot \\boldsymbol{g}_a$。内力的一个基本性质是它们必须处于平衡状态，即它们在单元上的总和为零：$\\sum_{a=1}^3 \\boldsymbol{F}_a = \\boldsymbol{0}$。由于 $\\sum_a \\nabla_{\\boldsymbol{X}} N_a = \\boldsymbol{0}$，该性质可作为对实现过程的一个有价值的验证。$\\boldsymbol{F}_1, \\boldsymbol{F}_2, \\boldsymbol{F}_3$ 的计算结果分量构成了每个用例的输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes nodal elastic forces for a 2D linear triangular finite element\n    using a compressible Neo-Hookean model.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"X_nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"x_nodes\": np.array([[0.00, 0.00], [1.05, 0.02], [-0.01, 1.10]]),\n            \"E\": 1.0e6,\n            \"nu\": 0.35,\n        },\n        {\n            \"X_nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"x_nodes\": 1.02 * np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"E\": 1.0e6,\n            \"nu\": 0.35,\n        },\n        {\n            \"X_nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"x_nodes\": np.array([[0.00, 0.00], [1.05, 0.02], [-0.01, 1.10]]),\n            \"E\": 1.0e6,\n            \"nu\": 0.49,\n        },\n    ]\n\n    results_all_cases = []\n\n    for case in test_cases:\n        X_nodes = case[\"X_nodes\"]\n        x_nodes = case[\"x_nodes\"]\n        E = case[\"E\"]\n        nu = case[\"nu\"]\n\n        X1, X2, X3 = X_nodes[0, :], X_nodes[1, :], X_nodes[2, :]\n        x1, x2, x3 = x_nodes[0, :], x_nodes[1, :], x_nodes[2, :]\n\n        # Step 1: Calculate reference area and shape function gradients\n        # Area of the reference triangle\n        A_e = 0.5 * np.linalg.det(\n            np.array([[X2[0] - X1[0], X2[1] - X1[1]], [X3[0] - X1[0], X3[1] - X1[1]]])\n        )\n\n        # Gradients of shape functions\n        grad_N1 = (0.5 / A_e) * np.array([X2[1] - X3[1], X3[0] - X2[0]])\n        grad_N2 = (0.5 / A_e) * np.array([X3[1] - X1[1], X1[0] - X3[0]])\n        grad_N3 = (0.5 / A_e) * np.array([X1[1] - X2[1], X2[0] - X1[0]])\n        \n        grads_N = [grad_N1, grad_N2, grad_N3]\n\n        # Step 2: Calculate the deformation gradient F\n        F = np.zeros((2, 2))\n        for i in range(3):\n            F += np.outer(x_nodes[i], grads_N[i])\n        \n        # Step 3: Calculate the first Piola-Kirchhoff stress P\n        # Lamé parameters\n        mu = E / (2 * (1 + nu))\n        lmbda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n\n        # Kinematic quantities\n        J = np.linalg.det(F)\n        if J == 0:\n            raise ValueError(\"Element inverted: J = 0\")\n        \n        F_inv_T = np.linalg.inv(F).T\n\n        # First Piola-Kirchhoff stress tensor\n        P = mu * (F - F_inv_T) + lmbda * np.log(J) * F_inv_T\n\n        # Steps 4  5: Calculate force densities and nodal forces\n        nodal_forces = []\n        for i in range(3):\n            # Elastic force density g_a = P * grad_N_a\n            g_a = P @ grads_N[i]\n            # Nodal force F_a = A_e * g_a\n            F_a = A_e * g_a\n            nodal_forces.extend(F_a)\n\n        results_all_cases.append(nodal_forces)\n\n    # Format output string\n    formatted_cases = []\n    for forces in results_all_cases:\n        case_str = \",\".join([f\"{f:.6f}\" for f in forces])\n        formatted_cases.append(f\"[{case_str}]\")\n    \n    final_output = f\"[{','.join(formatted_cases)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "IFEM 的“沉浸”特性依赖于一种数学工具，在固体的拉格朗日网格和流体的欧拉网格之间交换信息。本练习  通过检验一个离散的 delta 函数（或称为核函数），深入探讨了这种耦合机制的核心。通过计算插值权重并验证如“单位分解”等关键数学性质，您将更深刻地理解是什么保证了耦合方案的准确性和鲁棒性。",
            "id": "4108474",
            "problem": "在用于可变形固体与复杂流体相互作用的浸入式有限元法 (IFEM) 中，拉格朗日固体网格和欧拉流体网格之间的耦合通常通过一个可分离的、正则化的 delta 核函数来实现。考虑一个间距为 $h$ 的均匀笛卡尔欧拉网格，并设一个拉格朗日点位于 $(x,y,z)$，其归一化坐标为 $(x/h,y/h,z/h)=(1.3,2.7,3.1)$。用于在拉格朗日点上对欧拉场进行采样的插值权重由一维 $4$ 点核函数 $\\phi(r)$ 构建，对于 $r \\geq 0$ 其定义如下\n$$\n\\phi(r)=\n\\begin{cases}\n\\frac{1}{8}\\left(3-2r+\\sqrt{1+4r-4r^{2}}\\right),   0\\leq r\\leq 1,\\\\[6pt]\n\\frac{1}{8}\\left(5-2r-\\sqrt{-7+12r-4r^{2}}\\right),   1\\leq r\\leq 2,\\\\[6pt]\n0,   r\\geq 2.\n\\end{cases}\n$$\n三维插值权重是可分离的乘积\n$$\nw_{i,j,k}=\\phi\\!\\left(|i-x/h|\\right)\\,\\phi\\!\\left(|j-y/h|\\right)\\,\\phi\\!\\left(|k-z/h|\\right),\n$$\n其中 $(i,j,k)\\in\\mathbb{Z}^{3}$ 是每个坐标方向上的欧拉网格索引。对于给定的 $(x/h,y/h,z/h)$，识别出每个方向上起作用的四个索引，计算相应的一维权重 $\\{w^{x}_{i}\\}$、$\\{w^{y}_{j}\\}$ 和 $\\{w^{z}_{k}\\}$，并用它们以乘积形式指定非零的三维权重 $w_{i,j,k}$。然后，验证单位分解和一阶矩条件：\n$$\n\\sum_{i,j,k} w_{i,j,k}=1,\\quad\n\\sum_{i,j,k} i\\,w_{i,j,k}=\\frac{x}{h},\\quad\n\\sum_{i,j,k} j\\,w_{i,j,k}=\\frac{y}{h},\\quad\n\\sum_{i,j,k} k\\,w_{i,j,k}=\\frac{z}{h}.\n$$\n报告由单位分解和 $S$ 与三个一阶矩 $M_{x}$、$M_{y}$、$M_{z}$ 组成的最终元组 $\\left(S,M_{x},M_{y},M_{z}\\right)$。以无量纲形式表示最终元组。无需四舍五入。",
            "solution": "用户希望通过以下步骤解决问题：\n1.  **问题验证：** 首先对问题的科学性、完整性和客观性进行验证。\n    -   **已知条件：** 问题给出了拉格朗日点的归一化坐标 $(x/h, y/h, z/h) = (1.3, 2.7, 3.1)$、一个特定的 4 点核函数 $\\phi(r)$、可分离的三维权重 $w_{i,j,k}$ 的定义，以及需要验证的单位分解和一阶矩条件。\n    -   **验证：** 该问题具有科学依据，描述了计算力学（浸入式有限元法）中的一种标准插值方案。核函数 $\\phi(r)$ 是一个定义良好、连续、具有紧支集的逐段函数，是此类应用的典型特征。该问题是适定的、客观的，并包含唯一解所需的所有必要信息。\n    -   **结论：** 该问题有效。\n\n2.  **求解策略：** 问题的核心是计算每个坐标方向上的一维 (1D) 权重，然后利用三维权重的可分离性来验证所需的性质。\n    -   单位分解 $(S)$ 和一阶矩 $(M_x, M_y, M_z)$ 的三维求和可以分解为一维求和的乘积。\n    -   对于每个坐标，我们根据 $\\phi(r)$ 的紧支集确定起作用的整数网格索引。\n    -   然后我们计算每个方向的一维权重，并验证一维单位分解和一阶矩性质。\n    -   最后，我们从一维结果组装出三维结果。\n\n### 步骤 1：初步设置\n设拉格朗日点的归一化坐标为 $x' = x/h = 1.3$，$y' = y/h = 2.7$，以及 $z' = z/h = 3.1$。三维插值权重由一维核函数的可分离乘积给出：\n$$\nw_{i,j,k} = \\phi\\left(|i - x'|\\right) \\, \\phi\\left(|j - y'|\\right) \\, \\phi\\left(|k - z'|\\right)\n$$\n我们定义每个方向的一维权重如下：\n$$\nw^{x}_{i} = \\phi(|i-x'|), \\quad w^{y}_{j} = \\phi(|j-y'|), \\quad w^{z}_{k} = \\phi(|k-z'|)\n$$\n核函数 $\\phi(r)$ 仅在 $0 \\le r  2$ 时非零。因此，权重 $w^x_i$、$w^y_j$ 和 $w^z_k$ 仅在网格索引 $i, j, k$ 分别满足 $|i-x'|  2$、$|j-y'|  2$ 和 $|k-z'|  2$ 时非零。\n\n### 步骤 2：一维权重的计算与性质验证\n\n**对于 x 方向 ($x' = 1.3$):**\n起作用的索引 $i$ 必须满足 $|i - 1.3|  2$，即 $-0.7  i  3.3$。整数索引为 $i \\in \\{0, 1, 2, 3\\}$。\n核函数的自变量为：\n-   $i=0$: $r = |0 - 1.3| = 1.3$。这在区间 $[1, 2]$ 内。\n-   $i=1$: $r = |1 - 1.3| = 0.3$。这在区间 $[0, 1]$ 内。\n-   $i=2$: $r = |2 - 1.3| = 0.7$。这在区间 $[0, 1]$ 内。\n-   $i=3$: $r = |3 - 1.3| = 1.7$。这在区间 $[1, 2]$ 内。\n\n我们使用给定的 $\\phi(r)$ 定义来计算权重：\n-   $w^{x}_{0} = \\phi(1.3) = \\frac{1}{8}\\left(5 - 2(1.3) - \\sqrt{-7 + 12(1.3) - 4(1.3)^2}\\right) = \\frac{1}{8}\\left(2.4 - \\sqrt{1.84}\\right) = \\frac{1}{8}\\left(\\frac{12}{5} - \\frac{\\sqrt{46}}{5}\\right) = \\frac{12 - \\sqrt{46}}{40}$。\n-   $w^{x}_{1} = \\phi(0.3) = \\frac{1}{8}\\left(3 - 2(0.3) + \\sqrt{1 + 4(0.3) - 4(0.3)^2}\\right) = \\frac{1}{8}\\left(2.4 + \\sqrt{1.84}\\right) = \\frac{12 + \\sqrt{46}}{40}$。\n-   $w^{x}_{2} = \\phi(0.7) = \\frac{1}{8}\\left(3 - 2(0.7) + \\sqrt{1 + 4(0.7) - 4(0.7)^2}\\right) = \\frac{1}{8}\\left(1.6 + \\sqrt{1.84}\\right) = \\frac{8 + \\sqrt{46}}{40}$。\n-   $w^{x}_{3} = \\phi(1.7) = \\frac{1}{8}\\left(5 - 2(1.7) - \\sqrt{-7 + 12(1.7) - 4(1.7)^2}\\right) = \\frac{1}{8}\\left(1.6 - \\sqrt{1.84}\\right) = \\frac{8 - \\sqrt{46}}{40}$。\n\nx 方向的一维单位分解为：\n$$\n\\sum_{i} w^{x}_{i} = \\frac{(12 - \\sqrt{46}) + (12 + \\sqrt{46}) + (8 + \\sqrt{46}) + (8 - \\sqrt{46})}{40} = \\frac{12+12+8+8}{40} = \\frac{40}{40} = 1\n$$\nx 方向的一维一阶矩为：\n$$\n\\sum_{i} i \\, w^{x}_{i} = \\frac{0(12 - \\sqrt{46}) + 1(12 + \\sqrt{46}) + 2(8 + \\sqrt{46}) + 3(8 - \\sqrt{46})}{40} = \\frac{12+\\sqrt{46} + 16+2\\sqrt{46} + 24-3\\sqrt{46}}{40} = \\frac{52}{40} = \\frac{13}{10} = 1.3\n$$\n这与 $x'$ 相符。\n\n**对于 y 方向 ($y' = 2.7$):**\n起作用的索引 $j$ 必须满足 $|j - 2.7|  2$，即 $0.7  j  4.7$。整数索引为 $j \\in \\{1, 2, 3, 4\\}$。\n自变量为 $r \\in \\{|1-2.7|, |2-2.7|, |3-2.7|, |4-2.7|\\} = \\{1.7, 0.7, 0.3, 1.3\\}$。这与 x 方向的自变量集合相同。\n-   $w^{y}_{1} = \\phi(1.7) = \\frac{8 - \\sqrt{46}}{40}$。\n-   $w^{y}_{2} = \\phi(0.7) = \\frac{8 + \\sqrt{46}}{40}$。\n-   $w^{y}_{3} = \\phi(0.3) = \\frac{12 + \\sqrt{46}}{40}$。\n-   $w^{y}_{4} = \\phi(1.3) = \\frac{12 - \\sqrt{46}}{40}$。\n\n一维单位分解为 $\\sum_{j} w^{y}_{j} = 1$。一维一阶矩为：\n$$\n\\sum_{j} j \\, w^{y}_{j} = \\frac{1(8 - \\sqrt{46}) + 2(8 + \\sqrt{46}) + 3(12 + \\sqrt{46}) + 4(12 - \\sqrt{46})}{40} = \\frac{8- \\sqrt{46} + 16+2\\sqrt{46} + 36+3\\sqrt{46} + 48-4\\sqrt{46}}{40} = \\frac{108}{40} = \\frac{27}{10} = 2.7\n$$\n这与 $y'$ 相符。\n\n**对于 z 方向 ($z' = 3.1$):**\n起作用的索引 $k$ 必须满足 $|k - 3.1|  2$，即 $1.1  k  5.1$。整数索引为 $k \\in \\{2, 3, 4, 5\\}$。\n自变量为 $r \\in \\{|2-3.1|, |3-3.1|, |4-3.1|, |5-3.1|\\} = \\{1.1, 0.1, 0.9, 1.9\\}$。\n-   $w^{z}_{2} = \\phi(1.1) = \\frac{1}{8}\\left(5-2.2-\\sqrt{-7+13.2-4(1.21)}\\right) = \\frac{1}{8}\\left(2.8-\\sqrt{1.36}\\right) = \\frac{14-\\sqrt{34}}{40}$。\n-   $w^{z}_{3} = \\phi(0.1) = \\frac{1}{8}\\left(3-0.2+\\sqrt{1+0.4-4(0.01)}\\right) = \\frac{1}{8}\\left(2.8+\\sqrt{1.36}\\right) = \\frac{14+\\sqrt{34}}{40}$。\n-   $w^{z}_{4} = \\phi(0.9) = \\frac{1}{8}\\left(3-1.8+\\sqrt{1+3.6-4(0.81)}\\right) = \\frac{1}{8}\\left(1.2+\\sqrt{1.36}\\right) = \\frac{6+\\sqrt{34}}{40}$。\n-   $w^{z}_{5} = \\phi(1.9) = \\frac{1}{8}\\left(5-3.8-\\sqrt{-7+22.8-4(3.61)}\\right) = \\frac{1}{8}\\left(1.2-\\sqrt{1.36}\\right) = \\frac{6-\\sqrt{34}}{40}$。\n\n一维单位分解为 $\\sum_{k} w^{z}_{k} = 1$。一维一阶矩为：\n$$\n\\sum_{k} k \\, w^{z}_{k} = \\frac{2(14-\\sqrt{34}) + 3(14+\\sqrt{34}) + 4(6+\\sqrt{34}) + 5(6-\\sqrt{34})}{40} = \\frac{28-2\\sqrt{34} + 42+3\\sqrt{34} + 24+4\\sqrt{34} + 30-5\\sqrt{34}}{40} = \\frac{124}{40} = \\frac{31}{10} = 3.1\n$$\n这与 $z'$ 相符。\n\n### 步骤 3：三维条件的验证\n问题要求报告元组 $(S, M_x, M_y, M_z)$，其中这些量是三维求和。由于权重的可分离性，我们可以将求和分解为乘积：\n$$\nS = \\sum_{i,j,k} w_{i,j,k} = \\sum_{i,j,k} w^{x}_{i} w^{y}_{j} w^{z}_{k} = \\left(\\sum_{i} w^{x}_{i}\\right) \\left(\\sum_{j} w^{y}_{j}\\right) \\left(\\sum_{k} w^{z}_{k}\\right)\n$$\n$$\nM_{x} = \\sum_{i,j,k} i \\, w_{i,j,k} = \\left(\\sum_{i} i \\, w^{x}_{i}\\right) \\left(\\sum_{j} w^{y}_{j}\\right) \\left(\\sum_{k} w^{z}_{k}\\right)\n$$\n$$\nM_{y} = \\sum_{i,j,k} j \\, w_{i,j,k} = \\left(\\sum_{i} w^{x}_{i}\\right) \\left(\\sum_{j} j \\, w^{y}_{j}\\right) \\left(\\sum_{k} w^{z}_{k}\\right)\n$$\n$$\nM_{z} = \\sum_{i,j,k} k \\, w_{i,j,k} = \\left(\\sum_{i} w^{x}_{i}\\right) \\left(\\sum_{j} w^{y}_{j}\\right) \\left(\\sum_{k} k \\, w^{z}_{k}\\right)\n$$\n代入一维结果：\n-   $S = (1) \\cdot (1) \\cdot (1) = 1$。\n-   $M_{x} = (1.3) \\cdot (1) \\cdot (1) = 1.3 = \\frac{13}{10}$。\n-   $M_{y} = (1) \\cdot (2.7) \\cdot (1) = 2.7 = \\frac{27}{10}$。\n-   $M_{z} = (1) \\cdot (1) \\cdot (3.1) = 3.1 = \\frac{31}{10}$。\n\n单位分解和一阶矩条件得到满足。最终的元组是 $(S, M_x, M_y, M_z)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{13}{10}  \\frac{27}{10}  \\frac{31}{10} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在使用显式时间格式模拟流固耦合时，可能会出现一种臭名昭著的数值不稳定性，尤其是在将轻质固体沉浸于重质流体中时。本练习  使用一个简化但功能强大的模型来揭示这种“附加质量”不稳定性背后的物理原理。通过解析推导稳定性极限并通过数值方法进行验证，您将对计算流固耦合中的一个主要实践挑战以及决定稳定时间步长的因素有更深刻的认识。",
            "id": "4108437",
            "problem": "考虑一个理想化为一维空间下的浸入式有限元法（IFEM）中可变形固体与周围流体之间显式分区耦合的最小线性模型。可变形固体由一个拉格朗日自由度表示，其位移为 $u_s(t)$，质量为 $m_s$，并连接到一个刚度为 $k_s$ 的线性弹簧上。流体由一个欧拉自由度表示，其位移为 $u_f(t)$，质量为 $m_f$，并连接到一个刚度为 $k_f$ 的线性弹簧上，该弹簧模拟了离散的流体响应。固-液界面通过一个罚函数耦合来施加约束，其系数为 $\\alpha$，产生与位移不匹配成正比的、大小相等、方向相反的界面力。忽略任何阻尼和外力。耦合运动方程遵循 Newton 第二运动定律：\n$$\nm_s \\, \\ddot{u}_s(t) + k_s \\, u_s(t) = \\alpha \\left(u_f(t) - u_s(t)\\right),\n$$\n$$\nm_f \\, \\ddot{u}_f(t) + k_f \\, u_f(t) = -\\alpha \\left(u_f(t) - u_s(t)\\right).\n$$\n定义质量矩阵 $M = \\mathrm{diag}(m_s, m_f)$ 和刚度矩阵\n$$\nK = \\begin{bmatrix}\nk_s + \\alpha  -\\alpha \\\\\n-\\alpha  k_f + \\alpha\n\\end{bmatrix}.\n$$\n对于无阻尼线性系统 $M \\, \\ddot{\\mathbf{u}}(t) + K \\, \\mathbf{u}(t) = \\mathbf{0}$（其中 $\\mathbf{u}(t) = [u_s(t), u_f(t)]^\\top$），一个标准的显式二阶中心差分时间积分格式使用以下递推关系\n$$\n\\mathbf{u}_{n+1} = 2 \\mathbf{u}_n - \\mathbf{u}_{n-1} - \\Delta t^2 \\, M^{-1} K \\, \\mathbf{u}_n,\n$$\n其中离散时间步长 $\\Delta t  0$。临界时间步长 $\\Delta t_{\\mathrm{crit}}$ 是使得该格式对所有初始条件都保持稳定的最大 $\\Delta t$。\n\n你的任务是：\n- 从第一性原理出发，推导中心差分法应用于上述双自由度耦合系统的稳定性条件。\n- 通过分析线性更新的特征结构，为一组给定的参数值计算临界时间步长 $\\Delta t_{\\mathrm{crit}}$（单位：秒）。\n- 通过运行中心差分格式的数值实验来验证预测，初始条件为 $\\mathbf{u}_0$ 和 $\\dot{\\mathbf{u}}_0 = \\mathbf{0}$，使用 $\\Delta t_{\\mathrm{below}} = 0.95 \\, \\Delta t_{\\mathrm{crit}}$ 和 $\\Delta t_{\\mathrm{above}} = 1.05 \\, \\Delta t_{\\mathrm{crit}}$。如果模拟过程中的最大位移范数不超过初始位移范数的 $100$ 倍，则将该次运行分类为“稳定”（stable），否则分类为“不稳定”（unstable）。\n\n使用以下参数值测试套件，其中质量单位为千克（kg），刚度单位为牛顿/米（N/m），罚函数系数单位为牛顿/米（N/m）：\n1. 轻质固体嵌入稠密流体（强耦合）：$(m_s, k_s, m_f, k_f, \\alpha) = (0.01, 100, 1.0, 0.0, 2000)$。\n2. 质量与刚度均衡（中等耦合）：$(m_s, k_s, m_f, k_f, \\alpha) = (1.0, 100, 1.0, 100, 1000)$。\n3. 重质固体嵌入轻质流体（中等耦合）：$(m_s, k_s, m_f, k_f, \\alpha) = (10.0, 100, 0.1, 0.0, 500)$。\n4. 解耦极限（无耦合）：$(m_s, k_s, m_f, k_f, \\alpha) = (0.5, 100, 2.0, 50, 0)$。\n\n实现要求：\n- 对每个测试用例，计算 $\\Delta t_{\\mathrm{crit}}$（单位：秒），并四舍五入到六位小数。\n- 为了验证，使用初始位移 $\\mathbf{u}_0 = [10^{-2}, -10^{-2}]^\\top$ 和初始速度 $\\dot{\\mathbf{u}}_0 = [0, 0]^\\top$ 进行中心差分模拟，模拟的离散步数应足以稳健地对稳定性进行分类。\n- 生成单行输出，包含一个由逗号分隔的列表，列表中的每个元素是一个包含三个值的列表，形式为 $[\\Delta t_{\\mathrm{crit}}, \\mathrm{stable\\_below}, \\mathrm{unstable\\_above}]$，其中 $\\Delta t_{\\mathrm{crit}}$ 是一个浮点数（单位：秒），而 $\\mathrm{stable\\_below}$ 和 $\\mathrm{unstable\\_above}$ 是布尔值。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个 Python 风格的列表的列表，格式如：$[[t_1,s_1,u_1],[t_2,s_2,u_2],\\dots]$，其中每个 $t_i$ 是以秒为单位、四舍五入到六位小数的浮点数，而 $s_i$、$u_i$ 是布尔值。",
            "solution": "我们从 Newton 第二运动定律出发，该定律指出，力之和等于质量乘以加速度。对于固体和流体自由度，界面罚函数力被建模为一个连接 $u_s(t)$ 和 $u_f(t)$ 的线性弹簧，其刚度为 $\\alpha$。在没有阻尼和外力的情况下，我们得到耦合方程\n$$\nm_s \\, \\ddot{u}_s(t) + k_s \\, u_s(t) = \\alpha \\left(u_f(t) - u_s(t)\\right),\n\\qquad\nm_f \\, \\ddot{u}_f(t) + k_f \\, u_f(t) = -\\alpha \\left(u_f(t) - u_s(t)\\right).\n$$\n以向量形式 $\\mathbf{u}(t) = [u_s(t), u_f(t)]^\\top$ 集合，我们写出\n$$\nM \\, \\ddot{\\mathbf{u}}(t) + K \\, \\mathbf{u}(t) = \\mathbf{0},\n$$\n其中\n$$\nM = \\begin{bmatrix} m_s  0 \\\\ 0  m_f \\end{bmatrix}, \\quad\nK = \\begin{bmatrix} k_s + \\alpha  -\\alpha \\\\ -\\alpha  k_f + \\alpha \\end{bmatrix}.\n$$\n这是一个线性、无阻尼、常系数的二阶系统。其模态特性由广义特征问题决定\n$$\nK \\, \\boldsymbol{\\phi} = \\lambda \\, M \\, \\boldsymbol{\\phi},\n$$\n其中 $\\lambda \\ge 0$ 是自然频率的平方，即 $\\omega^2 = \\lambda$，而 $\\boldsymbol{\\phi}$ 是模态振型。等价地，$\\lambda$ 是 $A = M^{-1} K$ 的特征值。\n\n对于时间积分，我们考虑用于二阶系统的显式中心差分法（也称为 Störmer–Verlet 方法），对于常数 $M$ 和 $K$，其形式为\n$$\n\\mathbf{u}_{n+1} = 2 \\mathbf{u}_n - \\mathbf{u}_{n-1} - \\Delta t^2 \\, M^{-1} K \\, \\mathbf{u}_n,\n$$\n其中 $\\Delta t$ 是时间步长，$n$ 是整数时间索引。给定初始条件 $\\mathbf{u}_0$ 和 $\\dot{\\mathbf{u}}_0$，第一步构造如下\n$$\n\\mathbf{u}_1 = \\mathbf{u}_0 + \\Delta t \\, \\dot{\\mathbf{u}}_0 - \\frac{1}{2} \\Delta t^2 \\, M^{-1} K \\, \\mathbf{u}_0.\n$$\n为了评估稳定性，我们在模态坐标下分析递推关系。设 $\\boldsymbol{\\phi}$ 是 $A = M^{-1} K$ 的一个特征向量，其特征值为 $\\lambda$。将 $\\mathbf{u}_n$ 投影到这个模态上，得到一个标量递推关系\n$$\nq_{n+1} = 2 q_n - q_{n-1} - \\Delta t^2 \\lambda \\, q_n,\n$$\n其中 $q_n$ 是模态幅值。寻找 $q_n = r^n$ 形式的解，得到特征多项式\n$$\nr^2 - (2 - \\Delta t^2 \\lambda) r + 1 = 0.\n$$\n其根为\n$$\nr_{\\pm} = \\frac{2 - \\Delta t^2 \\lambda \\pm \\sqrt{(2 - \\Delta t^2 \\lambda)^2 - 4}}{2}.\n$$\n中心差分格式的稳定性要求对每个模态都有 $|r_{\\pm}| \\le 1$，这在判别式为非正且根位于单位圆上时得到保证。该条件是\n$$\n(2 - \\Delta t^2 \\lambda)^2 - 4 \\le 0 \\quad \\Longleftrightarrow \\quad 0 \\le \\Delta t^2 \\lambda \\le 4.\n$$\n因此，对于 $A = M^{-1} K$ 的最大特征值 $\\lambda_{\\max}$，其充要稳定性条件是\n$$\n\\Delta t \\le \\Delta t_{\\mathrm{crit}} := \\frac{2}{\\sqrt{\\lambda_{\\max}}}.\n$$\n这表示显式稳定性极限是一个由耦合系统的最高自然频率决定的 Courant–Friedrichs–Lewy 型约束。它捕捉了附加质量效应：当固体较轻（$m_s$ 小）而流体较重（$m_f$ 大）时，最大特征值会增加，因为耦合将最高频率推向受流体约束的固体位移，从而缩小了 $\\Delta t_{\\mathrm{crit}}$。\n\n算法设计：\n1. 对每个测试用例，使用给定的 $(m_s, k_s, m_f, k_f, \\alpha)$ 构建 $M$ 和 $K$。\n2. 计算 $A = M^{-1} K$ 并获得其特征值 $\\{\\lambda_i\\}$；设置 $\\lambda_{\\max} = \\max_i \\lambda_i$。\n3. 计算临界时间步长为 $\\Delta t_{\\mathrm{crit}} = 2 / \\sqrt{\\lambda_{\\max}}$ （单位：秒），并四舍五入到六位小数。\n4. 通过数值实验进行验证：\n   - 选择初始位移 $\\mathbf{u}_0 = [10^{-2}, -10^{-2}]^\\top$ 和初始速度 $\\dot{\\mathbf{u}}_0 = \\mathbf{0}$。\n   - 使用中心差分的第一步公式计算 $\\mathbf{u}_1$。\n   - 对递推关系 $\\mathbf{u}_{n+1} = 2 \\mathbf{u}_n - \\mathbf{u}_{n-1} - \\Delta t^2 \\, A \\, \\mathbf{u}_n$ 进行固定步数（例如，几千步）的迭代。\n   - 在模拟过程中跟踪最大欧几里得范数 $\\|\\mathbf{u}_n\\|_2$。如果 $\\max_n \\|\\mathbf{u}_n\\|_2 \\le 100 \\, \\|\\mathbf{u}_0\\|_2$，则将运行分类为稳定，否则为不稳定。\n   - 对 $\\Delta t_{\\mathrm{below}} = 0.95 \\, \\Delta t_{\\mathrm{crit}}$ 和 $\\Delta t_{\\mathrm{above}} = 1.05 \\, \\Delta t_{\\mathrm{crit}}$ 执行运行。\n5. 汇总结果：对每个测试用例，生成三元组 $[\\Delta t_{\\mathrm{crit}}, \\mathrm{stable\\_below}, \\mathrm{unstable\\_above}]$。\n\n数值考量：\n- 由于 $M$ 是对角矩阵且其对角线元素严格为正，$M^{-1}$ 存在且 $A$ 是良定义的。\n- 对于具有物理意义的参数 $k_s \\ge 0$，$k_f \\ge 0$ 和 $\\alpha \\ge 0$，$K$ 是对称半正定的，从而确保特征值 $\\lambda_i$ 非负。\n- 中心差分格式在推导出的极限下是条件稳定的；在临界步长附近，增长可能很缓慢，因此当 $\\Delta t > \\Delta t_{\\mathrm{crit}}$ 时，需要足够的模拟时长来观察不稳定性。\n\n最终程序使用数值线性代数实现这些步骤来计算 $\\lambda_{\\max}$，并模拟显式格式以验证稳定性分类。它按要求输出包含测试套件三元组列表的单行内容。所有时间量均以秒表示。",
            "answer": "```python\nimport numpy as np\n\ndef compute_dt_crit(ms, ks, mf, kf, alpha):\n    # Construct mass and stiffness matrices\n    M = np.array([[ms, 0.0],\n                  [0.0, mf]], dtype=float)\n    K = np.array([[ks + alpha, -alpha],\n                  [-alpha, kf + alpha]], dtype=float)\n    # Compute A = M^{-1} K\n    Minv = np.array([[1.0/ms, 0.0],\n                     [0.0, 1.0/mf]], dtype=float)\n    A = Minv @ K\n    # Eigenvalues of A\n    lam = np.linalg.eigvals(A)\n    # Largest eigenvalue (real, non-negative for physical parameters)\n    lam_max = float(np.max(np.real(lam)))\n    # Critical time step\n    dtcrit = 2.0 / np.sqrt(lam_max) if lam_max > 0 else float('inf')\n    return dtcrit\n\ndef simulate_central_difference(ms, ks, mf, kf, alpha, dt, steps, u0, v0):\n    # Setup matrices\n    M = np.array([[ms, 0.0],\n                  [0.0, mf]], dtype=float)\n    K = np.array([[ks + alpha, -alpha],\n                  [-alpha, kf + alpha]], dtype=float)\n    Minv = np.array([[1.0/ms, 0.0],\n                     [0.0, 1.0/mf]], dtype=float)\n    A = Minv @ K  # M^{-1} K\n\n    # Initial displacement and velocity\n    u_prev = np.array(u0, dtype=float)\n    v0_vec = np.array(v0, dtype=float)\n\n    # First step: u1 = u0 + dt*v0 - 0.5*dt^2*A*u0\n    u_curr = u_prev + dt * v0_vec - 0.5 * (dt ** 2) * (A @ u_prev)\n\n    # Track norms\n    init_norm = np.linalg.norm(u_prev)\n    max_norm = max(np.linalg.norm(u_prev), np.linalg.norm(u_curr))\n\n    # Iterate recurrence: u_{n+1} = 2 u_n - u_{n-1} - dt^2 A u_n\n    for _ in range(2, steps + 1):\n        u_next = 2.0 * u_curr - u_prev - (dt ** 2) * (A @ u_curr)\n        max_norm = max(max_norm, np.linalg.norm(u_next))\n        u_prev, u_curr = u_curr, u_next\n\n    # Stability classification\n    threshold = 100.0 * init_norm\n    stable = max_norm = threshold\n    return stable\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (ms, ks, mf, kf, alpha)\n    test_cases = [\n        (0.01, 100.0, 1.0, 0.0, 2000.0),  # Light solid, dense fluid, high coupling\n        (1.0, 100.0, 1.0, 100.0, 1000.0), # Balanced case\n        (10.0, 100.0, 0.1, 0.0, 500.0),   # Heavy solid, light fluid\n        (0.5, 100.0, 2.0, 50.0, 0.0),     # Decoupled limit (alpha=0)\n    ]\n\n    results = []\n    # Simulation parameters\n    steps = 6000\n    u0 = [1e-2, -1e-2]\n    v0 = [0.0, 0.0]\n\n    for case in test_cases:\n        ms, ks, mf, kf, alpha = case\n        dtcrit = compute_dt_crit(ms, ks, mf, kf, alpha)\n        # Guard against infinite/NaN dtcrit (should not occur with provided tests)\n        if not np.isfinite(dtcrit):\n            dtcrit_val = float('inf')\n            stable_below = True\n            unstable_above = False\n        else:\n            # Round to six decimals for output\n            dtcrit_val = round(dtcrit, 6)\n            dt_below = 0.95 * dtcrit\n            dt_above = 1.05 * dtcrit\n            stable_below = simulate_central_difference(ms, ks, mf, kf, alpha, dt_below, steps, u0, v0)\n            unstable_above = not simulate_central_difference(ms, ks, mf, kf, alpha, dt_above, steps, u0, v0)\n        results.append([dtcrit_val, stable_below, unstable_above])\n\n    # Final print statement in the exact required format.\n    print(str(results))\n\nsolve()\n```"
        }
    ]
}