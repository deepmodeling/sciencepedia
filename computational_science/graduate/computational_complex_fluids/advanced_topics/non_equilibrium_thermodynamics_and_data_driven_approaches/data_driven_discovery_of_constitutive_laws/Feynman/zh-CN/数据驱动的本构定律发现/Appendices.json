{
    "hands_on_practices": [
        {
            "introduction": "一旦通过数据驱动方法获得了材料的应变能密度函数 $\\psi$，首要任务便是利用该函数来预测材料在特定变形下的力学响应。本练习将带领您直接应用一个给定的超弹性本构模型，通过已知的变形梯度 $F$ 计算第二类Piola-Kirchhoff应力张量 $S$。这项实践巩固了连续介质力学中能量与应力之间的基本关系，是理解和应用任何本构模型的基础。",
            "id": "3748670",
            "problem": "一项数据驱动的多尺度分析汇集了中尺度应力-应变观测数据，以确定可压缩材料的各向同性超弹性应变能密度，该密度是右柯西-格林(Cauchy–Green)变形张量的主不变量的函数。设变形梯度为\n$$\nF = \\begin{pmatrix}\n1.2  0.1  0.0 \\\\\n0.0  0.9  0.2 \\\\\n0.0  0.0  1.1\n\\end{pmatrix},\n$$\n并设发现的应变能密度具有以下不变量形式\n$$\n\\psi(I_1,I_2,I_3) = \\frac{a_1}{2}\\,(I_1 - 3) + \\frac{a_2}{2}\\,(I_2 - 3) + \\frac{\\kappa}{2}\\,(\\ln J)^2,\\quad J=\\sqrt{I_3},\n$$\n其中系数 $a_1 = 40$ 兆帕 (MPa)，$a_2 = 10$ 兆帕 (MPa)，以及 $\\kappa = 200$ 兆帕 (MPa)。此处，$C = F^{\\top}F$，且主不变量定义为 $I_1 = \\mathrm{tr}(C)$，$I_2 = \\tfrac{1}{2}\\big((\\mathrm{tr}(C))^2 - \\mathrm{tr}(C^2)\\big)$，以及 $I_3 = \\det(C)$。\n\n仅从这些定义和标准的连续介质力学原理出发，计算给定 $F$ 的主不变量 $I_1$、$I_2$ 和 $I_3$，然后评估与给定 $\\psi(I_1,I_2,I_3)$ 一致的第二皮奥拉-基尔霍夫(Piola–Kirchhoff)应力张量 $S$ 的 $(1,1)$ 分量。请用兆帕 (MPa) 表示 $S_{11}$ 的最终数值结果，并将答案四舍五入到四位有效数字。",
            "solution": "### 解答\n\n解答过程分为四个阶段：\n1.  计算右柯西-格林变形张量 `$C$`。\n2.  计算主不变量 `$I_1$`、`$I_2$` 和 `$I_3$`。\n3.  推导第二皮奥拉-基尔霍夫应力张量 `$S$` 的表达式。\n4.  计算分量 `$S_{11}$`。\n\n**1. 右柯西-格林张量 `$C$`**\n\n右柯西-格林变形张量 `$C$` 定义为 `$C = F^{\\top}F$`。给定变形梯度 `$F$`：\n$$F = \\begin{pmatrix} 1.2  0.1  0.0 \\\\ 0.0  0.9  0.2 \\\\ 0.0  0.0  1.1 \\end{pmatrix}$$\n我们可以直接计算 `$C$` 的分量，公式为 `$C_{ij} = \\sum_k F_{ki} F_{kj}$`。\n$C_{11} = F_{11}^2 + F_{21}^2 + F_{31}^2 = 1.2^2 + 0^2 + 0^2 = 1.44$\n$C_{22} = F_{12}^2 + F_{22}^2 + F_{32}^2 = 0.1^2 + 0.9^2 + 0^2 = 0.01 + 0.81 = 0.82$\n$C_{33} = F_{13}^2 + F_{23}^2 + F_{33}^2 = 0^2 + 0.2^2 + 1.1^2 = 0.04 + 1.21 = 1.25$\n$C_{12} = C_{21} = F_{11}F_{12} + F_{21}F_{22} + F_{31}F_{32} = 1.2(0.1) + 0(0.9) + 0(0) = 0.12$\n$C_{13} = C_{31} = F_{11}F_{13} + F_{21}F_{23} + F_{31}F_{33} = 1.2(0) + 0(0.2) + 0(1.1) = 0.0$\n$C_{23} = C_{32} = F_{12}F_{13} + F_{22}F_{23} + F_{32}F_{33} = 0.1(0) + 0.9(0.2) + 0(1.1) = 0.18$\n因此，正确的对称张量 `$C$` 为：\n$$C = \\begin{pmatrix} 1.44  0.12  0.0 \\\\ 0.12  0.82  0.18 \\\\ 0.0  0.18  1.25 \\end{pmatrix}$$\n\n**2. 主不变量 `$I_1, I_2, I_3$`**\n\n-   第一不变量 `$I_1$` 是 `$C$` 的迹。\n    `$$I_1 = \\mathrm{tr}(C) = 1.44 + 0.82 + 1.25 = 3.51$$`\n\n-   第三不变量 `$I_3$` 是 `$C$` 的行列式。这可以计算为 `$(\\det F)^2$`。由于 `$F$` 是上三角矩阵，其行列式是其对角元素的乘积。\n    `$$\\det(F) = 1.2 \\times 0.9 \\times 1.1 = 1.188$$`\n    `$$I_3 = \\det(C) = (\\det F)^2 = (1.188)^2 = 1.411344$$`\n\n-   第二不变量 `$I_2$` 可以通过公式 `$I_2 = C_{11}C_{22} + C_{22}C_{33} + C_{33}C_{11} - (C_{12}^2 + C_{23}^2 + C_{31}^2)$` 计算。\n    `$$I_2 = (1.44)(0.82) + (0.82)(1.25) + (1.25)(1.44) - \\left( (0.12)^2 + (0.18)^2 + (0.0)^2 \\right)$$`\n    `$$I_2 = 1.1808 + 1.025 + 1.8 - (0.0144 + 0.0324 + 0)$$`\n    `$$I_2 = 4.0058 - 0.0468 = 3.959$$`\n\n计算出的不变量为：`$I_1 = 3.51$`，`$I_2 = 3.959$`，以及 `$I_3 = 1.411344$`。\n\n**3. 第二皮奥拉-基尔霍夫应力张量 `$S$`**\n\n第二皮奥拉-基尔霍夫应力张量 `$S$` 通过 `$S = 2 \\frac{\\partial \\psi}{\\partial C}$` 与应变能密度函数 `$\\psi$` 相关。我们使用链式法则：\n`$$S = 2 \\left( \\frac{\\partial \\psi}{\\partial I_1} \\frac{\\partial I_1}{\\partial C} + \\frac{\\partial \\psi}{\\partial I_2} \\frac{\\partial I_2}{\\partial C} + \\frac{\\partial \\psi}{\\partial I_3} \\frac{\\partial I_3}{\\partial C} \\right)$$`\n首先，我们求 `$\\psi$` 关于不变量的偏导数。含 `$J$` 的项用 `$I_3$` 重写：\n`$$\\frac{\\kappa}{2}(\\ln J)^2 = \\frac{\\kappa}{2}(\\ln \\sqrt{I_3})^2 = \\frac{\\kappa}{2} \\left( \\frac{1}{2}\\ln I_3 \\right)^2 = \\frac{\\kappa}{8}(\\ln I_3)^2$$`\n导数为：\n`$$\\frac{\\partial \\psi}{\\partial I_1} = \\frac{a_1}{2}, \\quad \\frac{\\partial \\psi}{\\partial I_2} = \\frac{a_2}{2}, \\quad \\frac{\\partial \\psi}{\\partial I_3} = \\frac{\\kappa}{8} \\cdot 2 (\\ln I_3) \\cdot \\frac{1}{I_3} = \\frac{\\kappa}{4} \\frac{\\ln I_3}{I_3}$$`\n不变量关于 `$C$` 的导数是张量微积分中的标准结果：\n`$$\\frac{\\partial I_1}{\\partial C} = I, \\quad \\frac{\\partial I_2}{\\partial C} = I_1 I - C, \\quad \\frac{\\partial I_3}{\\partial C} = I_3 C^{-1}$$`\n其中 `$I$` 是二阶单位张量。将这些代入 `$S$` 的表达式中：\n`$$S = 2 \\left[ \\left(\\frac{a_1}{2}\\right) I + \\left(\\frac{a_2}{2}\\right) (I_1 I - C) + \\left(\\frac{\\kappa}{4} \\frac{\\ln I_3}{I_3}\\right) (I_3 C^{-1}) \\right]$$`\n`$$S = a_1 I + a_2 (I_1 I - C) + \\frac{\\kappa}{2} (\\ln I_3) C^{-1}$$`\n\n**4. 计算 `$S_{11}$`**\n\n我们需要张量 `$S$` 的 `$(1,1)` 分量：\n`$$S_{11} = a_1 I_{11} + a_2 (I_1 I_{11} - C_{11}) + \\frac{\\kappa}{2} (\\ln I_3) (C^{-1})_{11}$$`\n当 `$I_{11} = 1$` 时：\n`$$S_{11} = a_1 + a_2(I_1 - C_{11}) + \\frac{\\kappa}{2} (\\ln I_3) (C^{-1})_{11}$$`\n分量 `$(C^{-1})_{11}$` 是 `$C$` 的伴随矩阵的 `$(1,1)` 元素除以 `$\\det(C)=I_3$`：\n`$$(C^{-1})_{11} = \\frac{1}{I_3} (C_{22}C_{33} - C_{23}C_{32}) = \\frac{(0.82)(1.25) - (0.18)^2}{1.411344}$$`\n`$$(C^{-1})_{11} = \\frac{1.025 - 0.0324}{1.411344} = \\frac{0.9926}{1.411344}$$`\n现在，代入数值：\n-   `$a_1 = 40.0$` MPa\n-   `$a_2 = 10.0$` MPa\n-   `$\\kappa = 200.0$` MPa\n-   `$I_1 = 3.51$`\n-   `$C_{11} = 1.44$`\n-   `$I_3 = 1.411344$`\n`$$S_{11} = 40 + 10(3.51 - 1.44) + \\frac{200}{2} \\ln(1.411344) \\left( \\frac{0.9926}{1.411344} \\right)$$`\n`$$S_{11} = 40 + 10(2.07) + 100 \\ln(1.411344) \\left( \\frac{0.9926}{1.411344} \\right)$$`\n`$$S_{11} = 40 + 20.7 + 100 (0.344558\\dots) (0.703344\\dots)$$`\n`$$S_{11} = 60.7 + 24.23235\\dots$$`\n`$$S_{11} = 84.93235\\dots~\\text{MPa}$$`\n将最终结果四舍五入到四位有效数字，得到：\n`$$S_{11} \\approx 84.93~\\text{MPa}$$`",
            "answer": "$$\\boxed{84.93}$$"
        },
        {
            "introduction": "在掌握了如何从能量函数 $\\psi(\\varepsilon)$ 计算应力 $\\sigma(\\varepsilon)$ 之后，下一个实际挑战是如何将这些数据驱动模型集成到如有限元法（FEM）等数值模拟中。本练习聚焦于推导“一致性切线模量” $\\mathbb{C}(\\varepsilon)$，这是确保非线性求解器快速、稳定收敛的关键量。通过这个练习，您将深入理解连接本构理论与计算实现的桥梁，这对于开发高效的数值模拟至关重要。",
            "id": "3748588",
            "problem": "考虑一种一维小应变超弹性材料，其应变能密度函数 $\\psi(\\varepsilon)$ 是通过对一个不变量特征候选库进行稀疏回归，并受热力学一致性约束，从多尺度数据中发现的。学习到的形式为\n$$\n\\psi(\\varepsilon) = \\frac{1}{2} a \\varepsilon^{2} + \\frac{1}{4} b \\varepsilon^{4} - c \\ln\\!\\big(1 - d \\varepsilon^{2}\\big),\n$$\n其中 $\\varepsilon$ 是（无量纲）轴向应变，$a$、$b$、$c$ 的单位是应力。此参数化表示是通过最小化代表性体积单元模拟的数据失配得到的，并受约束以确保对数项在关心的应变域内有明确定义，即 $1 - d \\varepsilon^{2} > 0$。你可以假设参数为 $a = 50\\,\\text{MPa}$，$b = 200\\,\\text{MPa}$，$c = 10\\,\\text{MPa}$ 和 $d = 4$。\n\n从基本超弹性理论出发，一维Cauchy应力定义为\n$$\n\\sigma(\\varepsilon) = \\frac{\\partial \\psi(\\varepsilon)}{\\partial \\varepsilon},\n$$\n一致切线模量为\n$$\n\\mathbb{C}(\\varepsilon) = \\frac{\\partial \\sigma(\\varepsilon)}{\\partial \\varepsilon} = \\frac{\\partial^{2} \\psi(\\varepsilon)}{\\partial \\varepsilon^{2}}.\n$$\n在有限元法（FEM）的Newton–Raphson迭代中，一致切线模量 $\\mathbb{C}$ 用于线性化残差，当线性化精确时能够实现快速收敛。\n\n任务：\n- 根据第一性原理，从给定的 $\\psi(\\varepsilon)$ 符号推导 $\\mathbb{C}(\\varepsilon)$。\n- 使用给定参数，计算在 $\\varepsilon = 0.1$ 处的 $\\mathbb{C}$。\n- 基于平衡线性化的第一性原理，简要解释在有限元求解器的Newton迭代中一致切线模量 $\\mathbb{C}$ 的作用，以及为什么在使用数据驱动的本构律时，它对于实现二次收敛至关重要。\n\n提供 $\\mathbb{C}(0.1)$ 的数值，单位为 $\\text{MPa}$。将最终数值答案四舍五入到四位有效数字。以 $\\text{MPa}$ 为单位表示最终模量。",
            "solution": "该问题是有效的。所提供的应变能密度函数 $\\psi(\\varepsilon)$ 是在指定应变域内超弹性模型的有效数学表达式。Cauchy应力 $\\sigma(\\varepsilon)$ 和一致切线模量 $\\mathbb{C}(\\varepsilon)$ 的定义在连续介质力学中是标准的。所有必要的参数都已提供，评估点 $\\varepsilon = 0.1$ 在函数的有效域内，因为对于 $d = 4$，约束条件 $1 - d \\varepsilon^{2} > 0$ 要求 $1 - 4 \\varepsilon^{2} > 0$，即 $|\\varepsilon|  0.5$。\n\n任务是推导一致切线模量 $\\mathbb{C}(\\varepsilon)$，在特定应变 $\\varepsilon = 0.1$ 处进行评估，并解释其在非线性有限元分析中的作用。\n\n首先，我们推导一致切线模量 $\\mathbb{C}(\\varepsilon)$ 的符号表达式。我们从给定的应变能密度函数开始：\n$$\n\\psi(\\varepsilon) = \\frac{1}{2} a \\varepsilon^{2} + \\frac{1}{4} b \\varepsilon^{4} - c \\ln(1 - d \\varepsilon^{2})\n$$\n\n一维Cauchy应力 $\\sigma(\\varepsilon)$ 是 $\\psi(\\varepsilon)$ 关于应变 $\\varepsilon$ 的一阶导数：\n$$\n\\sigma(\\varepsilon) = \\frac{\\partial \\psi(\\varepsilon)}{\\partial \\varepsilon} = \\frac{\\partial}{\\partial \\varepsilon} \\left( \\frac{1}{2} a \\varepsilon^{2} + \\frac{1}{4} b \\varepsilon^{4} - c \\ln(1 - d \\varepsilon^{2}) \\right)\n$$\n逐项微分，我们得到：\n$$\n\\sigma(\\varepsilon) = a \\varepsilon + b \\varepsilon^{3} - c \\left( \\frac{1}{1 - d \\varepsilon^{2}} \\right) (-2 d \\varepsilon)\n$$\n$$\n\\sigma(\\varepsilon) = a \\varepsilon + b \\varepsilon^{3} + \\frac{2 c d \\varepsilon}{1 - d \\varepsilon^{2}}\n$$\n\n一致切线模量 $\\mathbb{C}(\\varepsilon)$ 是 $\\psi(\\varepsilon)$ 的二阶导数，也就是 $\\sigma(\\varepsilon)$ 关于 $\\varepsilon$ 的一阶导数：\n$$\n\\mathbb{C}(\\varepsilon) = \\frac{\\partial \\sigma(\\varepsilon)}{\\partial \\varepsilon} = \\frac{\\partial}{\\partial \\varepsilon} \\left( a \\varepsilon + b \\varepsilon^{3} + \\frac{2 c d \\varepsilon}{1 - d \\varepsilon^{2}} \\right)\n$$\n我们逐项微分。前两项的导数很简单：\n$$\n\\frac{\\partial}{\\partial \\varepsilon} (a \\varepsilon + b \\varepsilon^{3}) = a + 3 b \\varepsilon^{2}\n$$\n对于第三项，我们应用商法则求导，$\\frac{d}{dx} \\left( \\frac{u}{v} \\right) = \\frac{u'v - uv'}{v^2}$，其中 $u(\\varepsilon) = 2 c d \\varepsilon$ 和 $v(\\varepsilon) = 1 - d \\varepsilon^{2}$。它们的导数是 $u'(\\varepsilon) = 2 c d$ 和 $v'(\\varepsilon) = -2 d \\varepsilon$。\n$$\n\\frac{\\partial}{\\partial \\varepsilon} \\left( \\frac{2 c d \\varepsilon}{1 - d \\varepsilon^{2}} \\right) = \\frac{(2 c d)(1 - d \\varepsilon^{2}) - (2 c d \\varepsilon)(-2 d \\varepsilon)}{(1 - d \\varepsilon^{2})^{2}}\n$$\n$$\n= \\frac{2 c d - 2 c d^{2} \\varepsilon^{2} + 4 c d^{2} \\varepsilon^{2}}{(1 - d \\varepsilon^{2})^{2}} = \\frac{2 c d + 2 c d^{2} \\varepsilon^{2}}{(1 - d \\varepsilon^{2})^{2}} = \\frac{2 c d (1 + d \\varepsilon^{2})}{(1 - d \\varepsilon^{2})^{2}}\n$$\n合并所有项，一致切线模量的符号表达式为：\n$$\n\\mathbb{C}(\\varepsilon) = a + 3 b \\varepsilon^{2} + \\frac{2 c d (1 + d \\varepsilon^{2})}{(1 - d \\varepsilon^{2})^{2}}\n$$\n\n接下来，我们使用给定参数 $a = 50\\,\\text{MPa}$，$b = 200\\,\\text{MPa}$，$c = 10\\,\\text{MPa}$ 和 $d = 4$ 来计算在 $\\varepsilon = 0.1$ 处的 $\\mathbb{C}(\\varepsilon)$：\n$$\n\\mathbb{C}(0.1) = 50 + 3(200)(0.1)^{2} + \\frac{2(10)(4)(1 + 4(0.1)^{2})}{(1 - 4(0.1)^{2})^{2}}\n$$\n让我们计算各个项。应变的平方是 $\\varepsilon^2 = (0.1)^2 = 0.01$。\n多项式部分：\n$$\n50 + 3(200)(0.01) = 50 + 600(0.01) = 50 + 6 = 56\n$$\n对数衍生部分：\n$$\n\\frac{2(10)(4)(1 + 4(0.01))}{(1 - 4(0.01))^{2}} = \\frac{80(1 + 0.04)}{(1 - 0.04)^{2}} = \\frac{80(1.04)}{(0.96)^{2}} = \\frac{83.2}{0.9216}\n$$\n除法运算结果为：\n$$\n\\frac{83.2}{0.9216} \\approx 90.2777...\n$$\n各部分相加：\n$$\n\\mathbb{C}(0.1) = 56 + 90.2777... = 146.2777... \\, \\text{MPa}\n$$\n四舍五入到四位有效数字，我们得到 $146.3 \\, \\text{MPa}$。\n\n最后，一致切线模量 $\\mathbb{C}$ 在有限元求解器的Newton迭代中的作用可以通过平衡线性化的原理来解释。在非线性静力分析中，有限元法将控制方程离散化为一个非线性代数方程组 $\\mathbf{R}(\\mathbf{u}) = \\mathbf{0}$，其中 $\\mathbf{R}$ 是残差向量（外力与内力之差），$\\mathbf{u}$ 是未知节点位移向量。Newton-Raphson方法迭代求解该系统。在每次迭代 $i$ 中，通过求解修正量 $\\Delta \\mathbf{u}$ 来找到下一个近似解 $\\mathbf{u}_{i+1} = \\mathbf{u}_i + \\Delta \\mathbf{u}$。这是通过在当前状态 $\\mathbf{u}_i$ 处对残差方程进行线性化来实现的：\n$$\n\\mathbf{R}(\\mathbf{u}_{i+1}) \\approx \\mathbf{R}(\\mathbf{u}_i) + \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{u}}\\bigg|_{\\mathbf{u}_i} \\Delta \\mathbf{u} = \\mathbf{0}\n$$\n这导出了线性系统 $\\mathbf{K}_T(\\mathbf{u}_i) \\Delta \\mathbf{u} = -\\mathbf{R}(\\mathbf{u}_i)$，其中 $\\mathbf{K}_T(\\mathbf{u}_i) = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{u}}\\big|_{\\mathbf{u}_i}$ 是全局切线刚度矩阵，也称为系统的雅可比矩阵。术语“一致切线”指的是用于构造 $\\mathbf{K}_T$ 的材料模量。对于标准平衡方程 $\\mathbf{R}(\\mathbf{u}) = \\mathbf{F}_{\\text{ext}} - \\mathbf{F}_{\\text{int}}(\\mathbf{u})$，切线刚度矩阵是 $\\mathbf{K}_T = \\frac{\\partial \\mathbf{F}_{\\text{int}}}{\\partial \\mathbf{u}}$。这个全局矩阵是由单元刚度矩阵组装而成的，而单元刚度矩阵取决于材料的本构响应。具体来说，材料对切线刚度的贡献是应力对应变的变化率，即切线模量 $\\mathbb{C} = \\frac{\\partial \\sigma}{\\partial \\varepsilon}$。\n\n只有使用精确的雅可比矩阵 $\\mathbf{K}_T$ 时，Newton-Raphson方法才能实现二次收敛率。对于由应变能函数 $\\psi(\\varepsilon)$ 定义的数据驱动或其他任何解析本构律，应力计算为 $\\sigma = \\partial\\psi/\\partial\\varepsilon$。为了保持一致性，切线模量必须是该应力计算的精确导数，即 $\\mathbb{C} = \\partial\\sigma/\\partial\\varepsilon = \\partial^2\\psi/\\partial\\varepsilon^2$。使用这个“一致切线”可以确保组装的 $\\mathbf{K}_T$ 是非线性系统的真实雅可比矩阵。如果使用 $\\mathbb{C}$ 的近似值（例如，初始弹性模量或数值近似），雅可比矩阵将不精确，Newton求解器的收敛性会从二次退化为线性或更慢，甚至可能完全不收敛。因此，在非线性求解器中，尤其是在使用复杂的数据驱动本构模型时，推导和实现精确的一致切线模量对于计算效率和鲁棒性至关重要。",
            "answer": "$$\n\\boxed{146.3}\n$$"
        },
        {
            "introduction": "数据驱动发现方法的一个核心挑战是确保所学到的模型遵守基本的物理定律并能产生可靠的预测。这个动手编程练习将向您介绍评估模型物理一致性（例如，材料稳定性）的方法，并通过检查预测是否在训练数据域之外进行来量化外推风险。这些验证技术对于开发值得信赖的数据驱动本构模型至关重要。",
            "id": "3748583",
            "problem": "给定一个小应变、平面应力的数据驱动本构设定，其中一个学习得到的线性映射通过一个作用于 Voigt 表示的矩阵，将对称应变张量关联到对称应力张量。设 Voigt 应变向量为 $\\mathbf{e} = (e_{xx}, e_{yy}, e_{xy})^\\top \\in \\mathbb{R}^3$，学习得到的刚度矩阵为 $\\mathbf{C} \\in \\mathbb{R}^{3 \\times 3}$。学习得到的应力为 $\\mathbf{s} = \\mathbf{C} \\,\\mathbf{e}$。假设所有量都已无量纲化，因此每个值都是无量纲的。\n\n基本原理和约束：\n- 在小应变线弹性理论下，应变能密度 $W(\\mathbf{e})$ 的存在要求应力可以从一个势函数导出，即 $\\mathbf{s} = \\frac{\\partial W}{\\partial \\mathbf{e}}$，这意味着刚度矩阵必须是对称的，即 $\\mathbf{C} = \\mathbf{C}^\\top$。对于二次形式的能量 $W(\\mathbf{e}) = \\frac{1}{2} \\,\\mathbf{e}^\\top \\mathbf{C}_s \\,\\mathbf{e}$，其中 $\\mathbf{C}_s = \\frac{1}{2}(\\mathbf{C}+\\mathbf{C}^\\top)$ 是对称部分，材料稳定性要求 $\\mathbf{C}_s$ 是正定的（所有特征值严格为正）。\n- 能量非负性与沿射线的单调性：对于任意非零应变方向 $\\mathbf{e}$ 和标量加载参数 $\\lambda \\ge 0$，沿射线 $\\mathbf{e}(\\lambda) = \\lambda \\mathbf{e}$ 的能量必须满足 $\\frac{\\mathrm{d}}{\\mathrm{d}\\lambda} W(\\mathbf{e}(\\lambda)) = \\mathbf{s}(\\lambda) \\cdot \\mathbf{e} = \\lambda \\,\\mathbf{e}^\\top \\mathbf{C}_s \\,\\mathbf{e} \\ge 0$，如果 $\\mathbf{C}_s$ 是正定的，这一点可以得到保证；当 $\\mathbf{e}^\\top \\mathbf{C}_s \\,\\mathbf{e}  0$ 时，就会出现违反情况。\n- 数据驱动的外推风险评估：给定一个训练应变集合 $\\mathcal{E}=\\{\\mathbf{e}_i\\}_{i=1}^N$，如果一个测试应变 $\\mathbf{e}^\\star$ 位于训练集凸包 $\\mathrm{conv}(\\mathcal{E})$ 之外，则称其存在外推风险。即，不存在和为1的非负权重 $\\{w_i\\}$ 使得 $\\sum_i w_i \\mathbf{e}_i = \\mathbf{e}^\\star$。\n\n你的任务是编写一个程序，对于一个固定的训练集 $\\mathcal{E}$ 和一个包含学习得到的刚度矩阵 $\\mathbf{C}$ 及其相应测试应变 $\\mathbf{e}^\\star$ 的测试套件，评估外推风险并量化对物理约束的违反情况。\n\n训练集（所有测试用例共用），以 $\\mathbb{R}^3$ 中四个点的形式给出：\n- $\\mathbf{e}_1 = (0, 0, 0)$，\n- $\\mathbf{e}_2 = (0.02, 0, 0)$，\n- $\\mathbf{e}_3 = (0, 0.02, 0)$，\n- $\\mathbf{e}_4 = (0.01, 0.01, 0.005)$。\n\n测试套件包含四个用例。对于每个用例 $k \\in \\{1,2,3,4\\}$，给定一个学习得到的刚度矩阵 $\\mathbf{C}^{(k)}$ 和一个测试应变 $\\mathbf{e}^{\\star (k)}$：\n1. 用例 1（对称正定，预期为外推）：\n   - $\\mathbf{C}^{(1)} = \\begin{pmatrix} 1000  300  0 \\\\ 300  800  0 \\\\ 0  0  200 \\end{pmatrix}$，\n   - $\\mathbf{e}^{\\star (1)} = (0.03, 0.01, -0.002)$。\n2. 用例 2（轻度不对称，近乎稳定，预期在凸包内）：\n   - $\\mathbf{C}^{(2)} = \\begin{pmatrix} 900  250  10 \\\\ 260  750  -5 \\\\ 5  -20  150 \\end{pmatrix}$，\n   - $\\mathbf{e}^{\\star (2)} = (0.01, 0.01, 0)$。\n3. 用例 3（对称，半正定，处于稳定性边界）：\n   - $\\mathbf{C}^{(3)} = \\begin{pmatrix} 500  0  0 \\\\ 0  0  0 \\\\ 0  0  100 \\end{pmatrix}$，\n   - $\\mathbf{e}^{\\star (3)} = (0.02, 0.02, 0)$。\n4. 用例 4（对称不定，能量在某些方向上可能为负）：\n   - $\\mathbf{C}^{(4)} = \\begin{pmatrix} 100  -300  0 \\\\ -300  100  0 \\\\ 0  0  50 \\end{pmatrix}$，\n   - $\\mathbf{e}^{\\star (4)} = (0.015, 0.015, 0)$。\n\n对于每个测试用例 $k$，计算以下五个量：\n- $Q_1^{(k)}$：一个布尔值，指示 $\\mathbf{e}^{\\star (k)}$ 是否位于训练集 $\\mathcal{E}$ 的凸包之外（True 表示在外；False 表示在内）。\n- $Q_2^{(k)}$：能量非负性违反的量级，定义为 $Q_2^{(k)} = \\max\\{0, -W(\\mathbf{e}^{\\star (k)})\\}$，其中 $W(\\mathbf{e}) = \\frac{1}{2}\\,\\mathbf{e}^\\top \\mathbf{C}_s^{(k)} \\,\\mathbf{e}$ 且 $\\mathbf{C}_s^{(k)} = \\frac{1}{2}(\\mathbf{C}^{(k)} + \\mathbf{C}^{(k)\\top})$ 是对称部分。\n- $Q_3^{(k)}$：学习得到的刚度矩阵的非对称性范数，定义为 $Q_3^{(k)} = \\|\\mathbf{C}^{(k)} - \\mathbf{C}^{(k)\\top}\\|_F$，其中 $\\|\\cdot\\|_F$ 表示 Frobenius 范数。\n- $Q_4^{(k)}$：一个布尔值，指示 $\\mathbf{C}_s^{(k)}$ 是否违反了正定性，即如果 $\\mathbf{C}_s^{(k)}$ 的任何特征值小于或等于容差 $\\varepsilon = 10^{-12}$，则为 True，否则为 False。\n- $Q_5^{(k)}$：一个布尔值，指示是否违反了沿射线的单调性，即如果 $\\mathbf{e}^{\\star (k)\\top} \\mathbf{C}_s^{(k)} \\mathbf{e}^{\\star (k)}  -\\varepsilon$，则为 True，否则为 False，使用相同的 $\\varepsilon$。\n\n所有涉及能量或正定性的计算都必须使用对称部分 $\\mathbf{C}_s^{(k)}$ 来进行。将所有值视为无量纲。对于正定性和单调性检查，使用数值容差 $\\varepsilon = 10^{-12}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$[Q_1^{(1)}, Q_2^{(1)}, Q_3^{(1)}, Q_4^{(1)}, Q_5^{(1)}, Q_1^{(2)}, Q_2^{(2)}, Q_3^{(2)}, Q_4^{(2)}, Q_5^{(2)}, Q_1^{(3)}, Q_2^{(3)}, Q_3^{(3)}, Q_4^{(3)}, Q_5^{(3)}, Q_1^{(4)}, Q_2^{(4)}, Q_3^{(4)}, Q_4^{(4)}, Q_5^{(4)}]$。\n\n根据上述第一性原理设计算法，不要调用任何预打包的凸包例程；为了评估是否包含在凸包内，你可以通过求解一个可行性问题来确定是否存在和为1的非负权重，使得测试应变可以表示为训练应变的凸组合。所有输出必须是所定义的无量纲浮点数或布尔值，并且最后一行必须与指定格式完全匹配。",
            "solution": "该问题是有效的。它在科学上基于线弹性和连续介质力学的原理，问题定义清晰，提供了所有必要的数据和定义，并且其表述是客观的。这些任务是明确定义的数学计算，并有唯一的解。\n\n解决方案的步骤是为四个测试用例中的每一个实施算法，以计算五个不同的量。这些量评估了数据驱动的本构模型对物理原理的遵守情况及其外推行为。下面将针对每个量详细介绍其原理和相应的计算方法。\n\n首先，我们定义所有测试用例的通用数据。应变向量的训练集为 $\\mathcal{E} = \\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3, \\mathbf{e}_4\\}$，其中：\n$$\n\\mathbf{e}_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{e}_2 = \\begin{pmatrix} 0.02 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{e}_3 = \\begin{pmatrix} 0 \\\\ 0.02 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{e}_4 = \\begin{pmatrix} 0.01 \\\\ 0.01 \\\\ 0.005 \\end{pmatrix}\n$$\n对于涉及接近零值的检查，给定的数值容差为 $\\varepsilon = 10^{-12}$。对于每个测试用例 $k$，我们给定一个学习得到的刚度矩阵 $\\mathbf{C}^{(k)}$ 和一个测试应变 $\\mathbf{e}^{\\star (k)}$。\n\n分析的核心依赖于刚度矩阵的对称部分 $\\mathbf{C}_s$，它决定了应变能。对于任何给定的学习矩阵 $\\mathbf{C}$，其对称部分的计算方法如下：\n$$\n\\mathbf{C}_s = \\frac{1}{2}\\left(\\mathbf{C} + \\mathbf{C}^\\top\\right)\n$$\n\n这五个量的计算方法如下：\n\n$Q_1^{(k)}$：外推风险\n这个量是一个布尔值，指示测试应变 $\\mathbf{e}^{\\star (k)}$ 是否位于训练集凸包 $\\mathrm{conv}(\\mathcal{E})$ 之外。根据凸包的定义，一个点 $\\mathbf{e}^\\star$ 位于 $\\mathrm{conv}(\\mathcal{E})$ 内部或边界上的充要条件是，它可以表示为 $\\mathcal{E}$ 中各点的凸组合。也就是说，必须存在一组非负权重 $\\{w_i\\}_{i=1}^4$ 满足：\n$$\n\\sum_{i=1}^4 w_i \\mathbf{e}_i = \\mathbf{e}^{\\star (k)} \\quad \\text{和} \\quad \\sum_{i=1}^4 w_i = 1, \\quad w_i \\ge 0\n$$\n这构成了一个线性规划可行性问题。设权重为未知向量 $\\mathbf{w} = (w_1, w_2, w_3, w_4)^\\top$。这些条件可以写成矩阵形式 $\\mathbf{A}_{\\text{eq}} \\mathbf{w} = \\mathbf{b}_{\\text{eq}}$，其中：\n$$\n\\mathbf{A}_{\\text{eq}} = \\begin{pmatrix} |  |  |  | \\\\ \\mathbf{e}_1  \\mathbf{e}_2  \\mathbf{e}_3  \\mathbf{e}_4 \\\\ |  |  |  | \\\\ 1  1  1  1 \\end{pmatrix} \\in \\mathbb{R}^{4 \\times 4}, \\quad\n\\mathbf{b}_{\\text{eq}} = \\begin{pmatrix} | \\\\ \\mathbf{e}^{\\star (k)} \\\\ | \\\\ 1 \\end{pmatrix} \\in \\mathbb{R}^{4}\n$$\n问题在于找到一个向量 $\\mathbf{w}$，它既满足这个方程组，又满足非负性约束 $\\mathbf{w} \\ge \\mathbf{0}$。我们可以使用线性规划求解器（如 `scipy.optimize.linprog`）和一个任意的目标函数（例如，最小化 $0$）来解决这个问题。如果求解器找到了一个可行解，则 $\\mathbf{e}^{\\star (k)}$ 位于凸包内部，且 $Q_1^{(k)}$ 为 `False`。如果不存在这样的解，则 $\\mathbf{e}^{\\star (k)}$ 位于凸包外部，且 $Q_1^{(k)}$ 为 `True`。\n\n$Q_2^{(k)}$：能量非负性违反\n与线弹性材料相关的应变能密度 $W$ 是应变的二次函数，通过刚度矩阵的对称部分定义：$W(\\mathbf{e}) = \\frac{1}{2} \\mathbf{e}^\\top \\mathbf{C}_s \\mathbf{e}$。材料物理学的一个基本要求是应变能必须为非负值，$W(\\mathbf{e}) \\ge 0$。如果对于给定的应变，计算出的能量为负，则发生了违反。对于测试应变 $\\mathbf{e}^{\\star (k)}$，此违反的量级被量化为：\n$$\nQ_2^{(k)} = \\max\\{0, -W(\\mathbf{e}^{\\star (k)})\\} = \\max\\left\\{0, -\\frac{1}{2} (\\mathbf{e}^{\\star (k)})^\\top \\mathbf{C}_s^{(k)} \\mathbf{e}^{\\star (k)}\\right\\}\n$$\n这是一个涉及矩阵-向量乘法的直接计算。\n\n$Q_3^{(k)}$：非对称性范数\n从数学上讲，应变能势函数 $W(\\mathbf{e})$（应力可由其导出，即 $\\mathbf{s} = \\partial W / \\partial \\mathbf{e}$）的存在要求刚度矩阵是对称的。这被称为 Maxwell 关系。从数据中学习得到的刚度矩阵 $\\mathbf{C}^{(k)}$ 可能不是完全对称的。与对称性的偏差是物理不一致性的一种度量。我们使用矩阵与其转置之差的 Frobenius 范数来量化这种偏差：\n$$\nQ_3^{(k)} = \\|\\mathbf{C}^{(k)} - (\\mathbf{C}^{(k)})^\\top\\|_F = \\sqrt{\\sum_{i=1}^3 \\sum_{j=1}^3 (C_{ij}^{(k)} - C_{ji}^{(k)})^2}\n$$\n这可以使用标准线性代数库函数进行计算。\n\n$Q_4^{(k)}$：正定性违反\n为保证材料稳定性，对于任何非零应变 $\\mathbf{e}$，应变能密度 $W(\\mathbf{e})$ 必须严格为正。这个条件的充要条件是对称刚度矩阵 $\\mathbf{C}_s$ 是正定的。一个矩阵是正定的，如果其所有特征值都严格为正。如果 $\\mathbf{C}_s^{(k)}$ 至少有一个特征值为零或负，则发生违反。在计算上，我们检查最小特征值 $\\lambda_{\\min}(\\mathbf{C}_s^{(k)})$ 是否小于或等于一个小容差 $\\varepsilon = 10^{-12}$：\n$$\nQ_4^{(k)} = \\begin{cases} \\text{True}  \\text{if } \\lambda_{\\min}(\\mathbf{C}_s^{(k)}) \\le \\varepsilon \\\\ \\text{False}  \\text{otherwise} \\end{cases}\n$$\n由于 $\\mathbf{C}_s^{(k)}$ 是对称的，其特征值为实数，可以高效地计算。\n\n$Q_5^{(k)}$：沿射线单调性违反\n这是一个与单点能量非负性相关但又不同的检查。它检查能量沿着从原点出发、方向为测试应变 $\\mathbf{e}^{\\star (k)}$ 的射线上的行为。沿这条射线的能量为 $W(\\lambda \\mathbf{e}^{\\star (k)}) = \\frac{1}{2} \\lambda^2 ((\\mathbf{e}^{\\star (k)})^\\top \\mathbf{C}_s^{(k)} \\mathbf{e}^{\\star (k)})$。为了使能量随着加载参数 $\\lambda \\ge 0$ 不减，二次型 $(\\mathbf{e}^{\\star (k)})^\\top \\mathbf{C}_s^{(k)} \\mathbf{e}^{\\star (k)}$ 必须为非负。如果这个量为负，则发生违反。我们使用一个容差 $\\varepsilon$ 进行此检查：\n$$\nQ_5^{(k)} = \\begin{cases} \\text{True}  \\text{if } (\\mathbf{e}^{\\star (k)})^\\top \\mathbf{C}_s^{(k)} \\mathbf{e}^{\\star (k)}  -\\varepsilon \\\\ \\text{False}  \\text{otherwise} \\end{cases}\n$$\n此检查直接评估由 $\\mathbf{e}^{\\star (k)}$ 定义的特定方向是否是能量减少的方向，这是不稳定的一个标志。\n\n现在将对四个测试用例中的每一个应用这五个计算步骤来实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the data-driven constitutive model validation problem.\n    \"\"\"\n\n    # Define the training set of strain vectors.\n    e_train = [\n        np.array([0., 0., 0.]),\n        np.array([0.02, 0., 0.]),\n        np.array([0., 0.02, 0.]),\n        np.array([0.01, 0.01, 0.005])\n    ]\n\n    # Define the four test cases.\n    test_cases = [\n        {\n            \"C\": np.array([\n                [1000., 300., 0.],\n                [300., 800., 0.],\n                [0., 0., 200.]\n            ]),\n            \"e_star\": np.array([0.03, 0.01, -0.002])\n        },\n        {\n            \"C\": np.array([\n                [900., 250., 10.],\n                [260., 750., -5.],\n                [5., -20., 150.]\n            ]),\n            \"e_star\": np.array([0.01, 0.01, 0.])\n        },\n        {\n            \"C\": np.array([\n                [500., 0., 0.],\n                [0., 0., 0.],\n                [0., 0., 100.]\n            ]),\n            \"e_star\": np.array([0.02, 0.02, 0.])\n        },\n        {\n            \"C\": np.array([\n                [100., -300., 0.],\n                [-300., 100., 0.],\n                [0., 0., 50.]\n            ]),\n            \"e_star\": np.array([0.015, 0.015, 0.])\n        }\n    ]\n\n    # Set numerical tolerance.\n    TOLERANCE = 1e-12\n\n    # Prepare for convex hull checks (A_eq is common to all cases).\n    # A_eq is a 4x4 matrix from the convex combination equations.\n    # The first 3 rows are the training strain vectors as columns.\n    # The last row is [1, 1, 1, 1] for the sum-to-one constraint on weights.\n    A_eq = np.vstack([np.array(e_train).T, np.ones(len(e_train))])\n\n    results = []\n    for case in test_cases:\n        C = case[\"C\"]\n        e_star = case[\"e_star\"]\n\n        # --- Q1: Extrapolation Risk (Convex Hull Check) ---\n        # b_eq is a vector of length 4.\n        # The first 3 elements are the test strain vector.\n        # The last element is 1 for the sum-to-one constraint.\n        b_eq = np.hstack([e_star, 1.0])\n        # We seek weights w >= 0 such that A_eq @ w = b_eq.\n        # Objective function c is irrelevant for a feasibility problem.\n        c = np.zeros(len(e_train))\n        # Use scipy's linear programming solver. Non-negativity of weights is handled by bounds.\n        # method='highs' is a robust simplex and interior-point method.\n        lp_res = linprog(c=c, A_eq=A_eq, b_eq=b_eq, bounds=(0, None), method='highs')\n        \n        # A successful solve means weights were found, so e_star is IN the hull.\n        # The question asks for True if OUTSIDE the hull.\n        q1 = not lp_res.success\n\n        # --- Symmetric part of the stiffness matrix ---\n        C_s = 0.5 * (C + C.T)\n\n        # --- Q2: Energy Nonnegativity Violation ---\n        # W(e) = 0.5 * e.T @ C_s @ e\n        W_e_star = 0.5 * e_star.T @ C_s @ e_star\n        q2 = np.maximum(0.0, -W_e_star)\n\n        # --- Q3: Asymmetry Norm ---\n        # Frobenius norm of (C - C.T)\n        q3 = np.linalg.norm(C - C.T, 'fro')\n\n        # --- Q4: Positive Definiteness Violation ---\n        # Eigenvalues of the symmetric matrix C_s.\n        # np.linalg.eigvalsh is efficient and numerically stable for Hermitian matrices.\n        eigenvalues = np.linalg.eigvalsh(C_s)\n        # Violation if any eigenvalue is = tolerance.\n        q4 = np.any(eigenvalues = TOLERANCE)\n\n        # --- Q5: Ray-wise Monotonicity Violation ---\n        # Check if e_star.T @ C_s @ e_star is negative.\n        quadratic_form = e_star.T @ C_s @ e_star\n        q5 = quadratic_form  -TOLERANCE\n        \n        results.extend([q1, q2, q3, q4, q5])\n\n    # Format the output as a single string.\n    # Booleans are automatically converted to 'True'/'False'.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}