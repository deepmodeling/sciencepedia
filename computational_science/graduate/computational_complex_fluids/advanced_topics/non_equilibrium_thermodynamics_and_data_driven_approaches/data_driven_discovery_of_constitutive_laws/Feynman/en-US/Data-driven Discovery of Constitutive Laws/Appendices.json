{
    "hands_on_practices": [
        {
            "introduction": "After a data-driven discovery process yields a new constitutive law, such as a hyperelastic strain energy function $\\psi$, the most fundamental task is to use it for prediction. This exercise provides hands-on practice in this crucial step, connecting the abstract mathematical form of a model to a concrete physical quantity: stress. You will apply foundational principles of continuum mechanics to compute the Second Piola-Kirchhoff stress tensor $S$ from a given deformation gradient $F$ and a discovered strain energy function, reinforcing your understanding of kinematic tensors and their invariants .",
            "id": "3748670",
            "problem": "A data-driven multiscale analysis aggregates mesoscale stress-strain observations to identify an isotropic hyperelastic strain energy density for a compressible material as a function of the principal invariants of the right Cauchy–Green deformation tensor. Let the deformation gradient be\n$$\nF = \\begin{pmatrix}\n1.2 & 0.1 & 0.0 \\\\\n0.0 & 0.9 & 0.2 \\\\\n0.0 & 0.0 & 1.1\n\\end{pmatrix},\n$$\nand let the strain energy density be discovered in the invariant form\n$$\n\\psi(I_1,I_2,I_3) = \\frac{a_1}{2}\\,(I_1 - 3) + \\frac{a_2}{2}\\,(I_2 - 3) + \\frac{\\kappa}{2}\\,(\\ln J)^2,\\quad J=\\sqrt{I_3},\n$$\nwith coefficients $a_1 = 40$ megapascal (MPa), $a_2 = 10$ megapascal (MPa), and $\\kappa = 200$ megapascal (MPa). Here, $C = F^{\\top}F$, and the principal invariants are defined by $I_1 = \\mathrm{tr}(C)$, $I_2 = \\tfrac{1}{2}\\big((\\mathrm{tr}(C))^2 - \\mathrm{tr}(C^2)\\big)$, and $I_3 = \\det(C)$.\n\nStarting only from these definitions and standard continuum mechanics principles, compute the principal invariants $I_1$, $I_2$, and $I_3$ for the given $F$, and then evaluate the $(1,1)$-component of the Second Piola–Kirchhoff stress tensor $S$ consistent with the given $\\psi(I_1,I_2,I_3)$. Express your final numerical result for $S_{11}$ in MPa and round your answer to four significant figures.",
            "solution": "The problem is first validated against the required criteria.\n\n### Step 1: Extract Givens\n-   Deformation gradient: $$F = \\begin{pmatrix} 1.2 & 0.1 & 0.0 \\\\ 0.0 & 0.9 & 0.2 \\\\ 0.0 & 0.0 & 1.1 \\end{pmatrix}$$\n-   Strain energy density function: $$\\psi(I_1,I_2,I_3) = \\frac{a_1}{2}\\,(I_1 - 3) + \\frac{a_2}{2}\\,(I_2 - 3) + \\frac{\\kappa}{2}\\,(\\ln J)^2$$\n-   Jacobian of deformation: $J=\\sqrt{I_3}$\n-   Material coefficients: $a_1 = 40$ MPa, $a_2 = 10$ MPa, $\\kappa = 200$ MPa.\n-   Right Cauchy–Green deformation tensor: $C = F^{\\top}F$\n-   Principal invariants of $C$:\n    -   $I_1 = \\mathrm{tr}(C)$\n    -   $I_2 = \\tfrac{1}{2}\\big((\\mathrm{tr}(C))^2 - \\mathrm{tr}(C^2)\\big)$\n    -   $I_3 = \\det(C)$\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is set within the established framework of continuum mechanics and hyperelasticity. The definitions of the right Cauchy-Green tensor $C$, its invariants $I_1, I_2, I_3$, and the form of the strain energy density function $\\psi$ are standard in the field. The requested calculation of the Second Piola-Kirchhoff stress tensor $S$ from $\\psi$ is a fundamental procedure.\n2.  **Well-Posed**: The problem provides all necessary data and definitions to compute a unique result. The given deformation gradient $F$ is non-singular, ensuring that $C$ and $C^{-1}$ exist. The constitutive model $\\psi$ is a well-defined function of the invariants.\n3.  **Objective**: The problem statement is precise, quantitative, and free of any subjective or ambiguous language.\n4.  **Topic Relevance**: The problem directly addresses the theme of using a discovered constitutive law ($\\psi$) to predict material behavior (the stress tensor $S$), which is central to \"data-driven discovery of constitutive laws\" in \"multiscale modeling and analysis\".\n\nThe problem is self-contained, consistent, and scientifically sound.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution\n\nThe solution proceeds in four stages:\n1.  Calculation of the right Cauchy-Green deformation tensor $C$.\n2.  Calculation of the principal invariants $I_1$, $I_2$, and $I_3$.\n3.  Derivation of the expression for the Second Piola-Kirchhoff stress tensor $S$.\n4.  Computation of the component $S_{11}$.\n\n**1. Right Cauchy-Green Tensor $C$**\n\nThe right Cauchy-Green deformation tensor $C$ is defined as $C = F^{\\top}F$. First, we write the transpose of the given deformation gradient $F$:\n$$F = \\begin{pmatrix} 1.2 & 0.1 & 0.0 \\\\ 0.0 & 0.9 & 0.2 \\\\ 0.0 & 0.0 & 1.1 \\end{pmatrix} \\implies F^{\\top} = \\begin{pmatrix} 1.2 & 0.0 & 0.0 \\\\ 0.1 & 0.9 & 0.0 \\\\ 0.0 & 0.2 & 1.1 \\end{pmatrix}$$\nNow we perform the matrix multiplication $C = F^{\\top}F$:\n$$C = \\begin{pmatrix} 1.2 & 0.0 & 0.0 \\\\ 0.1 & 0.9 & 0.0 \\\\ 0.0 & 0.2 & 1.1 \\end{pmatrix} \\begin{pmatrix} 1.2 & 0.1 & 0.0 \\\\ 0.0 & 0.9 & 0.2 \\\\ 0.0 & 0.0 & 1.1 \\end{pmatrix}$$\n$$= \\begin{pmatrix} 1.44 & 0.12 & 0.0 \\\\ 0.12 & 0.01+0.81 & 0.18 \\\\ 0.0 & 0.18 & 0.04+1.21 \\end{pmatrix} = \\begin{pmatrix} 1.44 & 0.12 & 0.0 \\\\ 0.12 & 0.82 & 0.18 \\\\ 0.0 & 0.18 & 1.25 \\end{pmatrix}$$\nThe resulting symmetric tensor $C$ is:\n$$C = \\begin{pmatrix} 1.44 & 0.12 & 0.0 \\\\ 0.12 & 0.82 & 0.18 \\\\ 0.0 & 0.18 & 1.25 \\end{pmatrix}$$\n\n**2. Principal Invariants $I_1, I_2, I_3$**\n\n-   The first invariant $I_1$ is the trace of $C$.\n    $$I_1 = \\mathrm{tr}(C) = 1.44 + 0.82 + 1.25 = 3.51$$\n\n-   The third invariant $I_3$ is the determinant of $C$. This can be computed as $(\\det F)^2$. Since $F$ is upper triangular, its determinant is the product of its diagonal elements.\n    $$\\det(F) = 1.2 \\times 0.9 \\times 1.1 = 1.188$$\n    $$I_3 = \\det(C) = (\\det F)^2 = (1.188)^2 = 1.411344$$\n\n-   The second invariant $I_2$ can be computed from the formula $I_2 = \\frac{1}{2}\\big((\\mathrm{tr}(C))^2 - \\mathrm{tr}(C^2)\\big)$. Alternatively, $I_2 = C_{11}C_{22} + C_{22}C_{33} + C_{33}C_{11} - (C_{12}^2 + C_{23}^2 + C_{31}^2)$.\n    $$I_2 = (1.44)(0.82) + (0.82)(1.25) + (1.25)(1.44) - \\left( (0.12)^2 + (0.18)^2 + (0.0)^2 \\right)$$\n    $$I_2 = 1.1808 + 1.025 + 1.8 - (0.0144 + 0.0324 + 0)$$\n    $$I_2 = 4.0058 - 0.0468 = 3.959$$\n\nThe computed invariants are: $I_1 = 3.51$, $I_2 = 3.959$, and $I_3 = 1.411344$.\n\n**3. Second Piola-Kirchhoff Stress Tensor $S$**\n\nThe Second Piola-Kirchhoff stress tensor $S$ is related to the strain energy density function $\\psi$ by $S = 2 \\frac{\\partial \\psi}{\\partial C}$. We use the chain rule:\n$$S = 2 \\left( \\frac{\\partial \\psi}{\\partial I_1} \\frac{\\partial I_1}{\\partial C} + \\frac{\\partial \\psi}{\\partial I_2} \\frac{\\partial I_2}{\\partial C} + \\frac{\\partial \\psi}{\\partial I_3} \\frac{\\partial I_3}{\\partial C} \\right)$$\nFirst, we find the partial derivatives of $\\psi$ with respect to the invariants. The term with $J$ is rewritten in terms of $I_3$:\n$$\\frac{\\kappa}{2}(\\ln J)^2 = \\frac{\\kappa}{2}(\\ln \\sqrt{I_3})^2 = \\frac{\\kappa}{2} \\left( \\frac{1}{2}\\ln I_3 \\right)^2 = \\frac{\\kappa}{8}(\\ln I_3)^2$$\nThe derivatives are:\n$$\\frac{\\partial \\psi}{\\partial I_1} = \\frac{a_1}{2}, \\quad \\frac{\\partial \\psi}{\\partial I_2} = \\frac{a_2}{2}, \\quad \\frac{\\partial \\psi}{\\partial I_3} = \\frac{\\kappa}{8} \\cdot 2 (\\ln I_3) \\cdot \\frac{1}{I_3} = \\frac{\\kappa}{4} \\frac{\\ln I_3}{I_3}$$\nThe derivatives of the invariants with respect to $C$ are standard results in tensor calculus:\n$$\\frac{\\partial I_1}{\\partial C} = I, \\quad \\frac{\\partial I_2}{\\partial C} = I_1 I - C, \\quad \\frac{\\partial I_3}{\\partial C} = I_3 C^{-1}$$\nwhere $I$ is the second-order identity tensor. Substituting these into the expression for $S$:\n$$S = 2 \\left[ \\left(\\frac{a_1}{2}\\right) I + \\left(\\frac{a_2}{2}\\right) (I_1 I - C) + \\left(\\frac{\\kappa}{4} \\frac{\\ln I_3}{I_3}\\right) (I_3 C^{-1}) \\right]$$\n$$S = a_1 I + a_2 (I_1 I - C) + \\frac{\\kappa}{2} (\\ln I_3) C^{-1}$$\n\n**4. Computation of $S_{11}$**\n\nWe need the $(1,1)$-component of the tensor $S$:\n$$S_{11} = a_1 I_{11} + a_2 (I_1 I_{11} - C_{11}) + \\frac{\\kappa}{2} (\\ln I_3) (C^{-1})_{11}$$\nWith $I_{11} = 1$:\n$$S_{11} = a_1 + a_2(I_1 - C_{11}) + \\frac{\\kappa}{2} (\\ln I_3) (C^{-1})_{11}$$\nThe component $(C^{-1})_{11}$ is the $(1,1)$-element of the adjugate of $C$ divided by $\\det(C)=I_3$:\n$$(C^{-1})_{11} = \\frac{1}{I_3} (C_{22}C_{33} - C_{23}C_{32}) = \\frac{(0.82)(1.25) - (0.18)^2}{1.411344}$$\n$$(C^{-1})_{11} = \\frac{1.025 - 0.0324}{1.411344} = \\frac{0.9926}{1.411344}$$\nNow, substitute the numerical values:\n-   $a_1 = 40.0$ MPa\n-   $a_2 = 10.0$ MPa\n-   $\\kappa = 200.0$ MPa\n-   $I_1 = 3.51$\n-   $C_{11} = 1.44$\n-   $I_3 = 1.411344$\n$$S_{11} = 40 + 10(3.51 - 1.44) + \\frac{200}{2} \\ln(1.411344) \\left( \\frac{0.9926}{1.411344} \\right)$$\n$$S_{11} = 40 + 10(2.07) + 100 \\ln(1.411344) \\left( \\frac{0.9926}{1.411344} \\right)$$\n$$S_{11} = 40 + 20.7 + 100 (0.344558\\dots) (0.703344\\dots)$$\n$$S_{11} = 60.7 + 24.23235\\dots$$\n$$S_{11} = 84.93235\\dots~\\text{MPa}$$\nRounding the final result to four significant figures gives:\n$$S_{11} \\approx 84.93~\\text{MPa}$$",
            "answer": "$$\\boxed{84.93}$$"
        },
        {
            "introduction": "Predicting stress is necessary, but often not sufficient for practical engineering applications. To integrate a discovered constitutive model into a nonlinear numerical solver, such as in the Finite Element Method (FEM), we must also provide the model's exact linearization. This exercise focuses on deriving the consistent tangent modulus $\\mathbb{C}$, the derivative of stress with respect to strain, which is essential for the quadratic convergence of Newton-Raphson iterations and the overall stability and efficiency of a simulation .",
            "id": "3748588",
            "problem": "Consider a one-dimensional small-strain hyperelastic material whose strain-energy density function $\\psi(\\varepsilon)$ has been discovered from multiscale data via sparse regression in a candidate library of invariant features, subject to thermodynamic consistency constraints. The learned form is\n$$\n\\psi(\\varepsilon) = \\frac{1}{2} a \\varepsilon^{2} + \\frac{1}{4} b \\varepsilon^{4} - c \\ln\\!\\big(1 - d \\varepsilon^{2}\\big),\n$$\nwhere $\\varepsilon$ is the (dimensionless) axial strain and $a$, $b$, $c$ have units of stress. This parametric representation is obtained by minimizing a data misfit over representative volume element simulations and is constrained so that the logarithmic term is well-defined, i.e., $1 - d \\varepsilon^{2} > 0$ over the strain domain of interest. You may assume that the parameters are $a = 50\\,\\text{MPa}$, $b = 200\\,\\text{MPa}$, $c = 10\\,\\text{MPa}$, and $d = 4$.\n\nStarting from fundamental hyperelasticity, the Cauchy stress in one dimension is defined by\n$$\n\\sigma(\\varepsilon) = \\frac{\\partial \\psi(\\varepsilon)}{\\partial \\varepsilon},\n$$\nand the consistent tangent modulus is\n$$\n\\mathbb{C}(\\varepsilon) = \\frac{\\partial \\sigma(\\varepsilon)}{\\partial \\varepsilon} = \\frac{\\partial^{2} \\psi(\\varepsilon)}{\\partial \\varepsilon^{2}}.\n$$\nIn Newton–Raphson iterations within the Finite Element Method (FEM), the consistent tangent $\\mathbb{C}$ is used to linearize the residual, enabling rapid convergence when the linearization is exact.\n\nTasks:\n- Derive $\\mathbb{C}(\\varepsilon)$ symbolically from the given $\\psi(\\varepsilon)$ using first principles.\n- Evaluate $\\mathbb{C}$ at $\\varepsilon = 0.1$ using the provided parameters.\n- Briefly explain, based on first principles of equilibrium linearization, the role of the consistent tangent $\\mathbb{C}$ in Newton iterations within a finite element solver, and why it is essential for achieving quadratic convergence when using a data-driven constitutive law.\n\nProvide the numerical value of $\\mathbb{C}(0.1)$ in $\\text{MPa}$. Round your final numerical answer to four significant figures. Express the final modulus in $\\text{MPa}$.",
            "solution": "The problem statement is scientifically grounded, well-posed, and free of contradictions or ambiguities. The provided strain-energy density function $\\psi(\\varepsilon)$ is a valid mathematical expression for a hyperelastic model within a specified domain of strain. The definitions of Cauchy stress $\\sigma(\\varepsilon)$ and the consistent tangent modulus $\\mathbb{C}(\\varepsilon)$ are standard in continuum mechanics. All necessary parameters are provided, and the evaluation point $\\varepsilon = 0.1$ is within the valid domain of the function, since for $d = 4$, the constraint $1 - d \\varepsilon^{2} > 0$ requires $1 - 4 \\varepsilon^{2} > 0$, or $|\\varepsilon| < 0.5$. The problem is therefore valid and can be solved as posed.\n\nThe task is to derive the consistent tangent modulus $\\mathbb{C}(\\varepsilon)$, evaluate it at a specific strain $\\varepsilon = 0.1$, and explain its role in nonlinear finite element analysis.\n\nFirst, we derive the symbolic expression for the consistent tangent modulus $\\mathbb{C}(\\varepsilon)$. We start with the given strain-energy density function:\n$$\n\\psi(\\varepsilon) = \\frac{1}{2} a \\varepsilon^{2} + \\frac{1}{4} b \\varepsilon^{4} - c \\ln(1 - d \\varepsilon^{2})\n$$\n\nThe one-dimensional Cauchy stress $\\sigma(\\varepsilon)$ is the first derivative of $\\psi(\\varepsilon)$ with respect to strain $\\varepsilon$:\n$$\n\\sigma(\\varepsilon) = \\frac{\\partial \\psi(\\varepsilon)}{\\partial \\varepsilon} = \\frac{\\partial}{\\partial \\varepsilon} \\left( \\frac{1}{2} a \\varepsilon^{2} + \\frac{1}{4} b \\varepsilon^{4} - c \\ln(1 - d \\varepsilon^{2}) \\right)\n$$\nDifferentiating term by term, we obtain:\n$$\n\\sigma(\\varepsilon) = a \\varepsilon + b \\varepsilon^{3} - c \\left( \\frac{1}{1 - d \\varepsilon^{2}} \\right) (-2 d \\varepsilon)\n$$\n$$\n\\sigma(\\varepsilon) = a \\varepsilon + b \\varepsilon^{3} + \\frac{2 c d \\varepsilon}{1 - d \\varepsilon^{2}}\n$$\n\nThe consistent tangent modulus $\\mathbb{C}(\\varepsilon)$ is the second derivative of $\\psi(\\varepsilon)$, which is the first derivative of $\\sigma(\\varepsilon)$ with respect to $\\varepsilon$:\n$$\n\\mathbb{C}(\\varepsilon) = \\frac{\\partial \\sigma(\\varepsilon)}{\\partial \\varepsilon} = \\frac{\\partial}{\\partial \\varepsilon} \\left( a \\varepsilon + b \\varepsilon^{3} + \\frac{2 c d \\varepsilon}{1 - d \\varepsilon^{2}} \\right)\n$$\nWe differentiate term by term. The derivative of the first two terms is straightforward:\n$$\n\\frac{\\partial}{\\partial \\varepsilon} (a \\varepsilon + b \\varepsilon^{3}) = a + 3 b \\varepsilon^{2}\n$$\nFor the third term, we apply the quotient rule for differentiation, $\\frac{d}{dx} \\left( \\frac{u}{v} \\right) = \\frac{u'v - uv'}{v^2}$, with $u(\\varepsilon) = 2 c d \\varepsilon$ and $v(\\varepsilon) = 1 - d \\varepsilon^{2}$. The derivatives are $u'(\\varepsilon) = 2 c d$ and $v'(\\varepsilon) = -2 d \\varepsilon$.\n$$\n\\frac{\\partial}{\\partial \\varepsilon} \\left( \\frac{2 c d \\varepsilon}{1 - d \\varepsilon^{2}} \\right) = \\frac{(2 c d)(1 - d \\varepsilon^{2}) - (2 c d \\varepsilon)(-2 d \\varepsilon)}{(1 - d \\varepsilon^{2})^{2}}\n$$\n$$\n= \\frac{2 c d - 2 c d^{2} \\varepsilon^{2} + 4 c d^{2} \\varepsilon^{2}}{(1 - d \\varepsilon^{2})^{2}} = \\frac{2 c d + 2 c d^{2} \\varepsilon^{2}}{(1 - d \\varepsilon^{2})^{2}} = \\frac{2 c d (1 + d \\varepsilon^{2})}{(1 - d \\varepsilon^{2})^{2}}\n$$\nCombining all terms, the symbolic expression for the consistent tangent modulus is:\n$$\n\\mathbb{C}(\\varepsilon) = a + 3 b \\varepsilon^{2} + \\frac{2 c d (1 + d \\varepsilon^{2})}{(1 - d \\varepsilon^{2})^{2}}\n$$\n\nNext, we evaluate $\\mathbb{C}(\\varepsilon)$ at $\\varepsilon = 0.1$ using the provided parameters: $a = 50\\,\\text{MPa}$, $b = 200\\,\\text{MPa}$, $c = 10\\,\\text{MPa}$, and $d = 4$.\n$$\n\\mathbb{C}(0.1) = 50 + 3(200)(0.1)^{2} + \\frac{2(10)(4)(1 + 4(0.1)^{2})}{(1 - 4(0.1)^{2})^{2}}\n$$\nLet's compute the individual terms. The strain squared is $\\varepsilon^2 = (0.1)^2 = 0.01$.\nThe polynomial part:\n$$\n50 + 3(200)(0.01) = 50 + 600(0.01) = 50 + 6 = 56\n$$\nThe logarithmic-derived part:\n$$\n\\frac{2(10)(4)(1 + 4(0.01))}{(1 - 4(0.01))^{2}} = \\frac{80(1 + 0.04)}{(1 - 0.04)^{2}} = \\frac{80(1.04)}{(0.96)^{2}} = \\frac{83.2}{0.9216}\n$$\nThe division gives:\n$$\n\\frac{83.2}{0.9216} \\approx 90.2777...\n$$\nSumming the parts:\n$$\n\\mathbb{C}(0.1) = 56 + 90.2777... = 146.2777... \\, \\text{MPa}\n$$\nRounding to four significant figures, we get $146.3 \\, \\text{MPa}$.\n\nFinally, the role of the consistent tangent modulus $\\mathbb{C}$ in Newton iterations within a finite element solver is explained by the principles of equilibrium linearization. In a nonlinear static analysis, the Finite Element Method discretizes the governing equations into a system of nonlinear algebraic equations $\\mathbf{R}(\\mathbf{u}) = \\mathbf{0}$, where $\\mathbf{R}$ is the residual vector (the difference between external and internal forces) and $\\mathbf{u}$ is the vector of unknown nodal displacements. The Newton-Raphson method solves this system iteratively. At each iteration $i$, a correction $\\Delta \\mathbf{u}$ is sought to find the next approximation $\\mathbf{u}_{i+1} = \\mathbf{u}_i + \\Delta \\mathbf{u}$. This is achieved by linearizing the residual equation about the current state $\\mathbf{u}_i$:\n$$\n\\mathbf{R}(\\mathbf{u}_{i+1}) \\approx \\mathbf{R}(\\mathbf{u}_i) + \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{u}}\\bigg|_{\\mathbf{u}_i} \\Delta \\mathbf{u} = \\mathbf{0}\n$$\nThis leads to the linear system $\\mathbf{K}_T(\\mathbf{u}_i) \\Delta \\mathbf{u} = -\\mathbf{R}(\\mathbf{u}_i)$, where $\\mathbf{K}_T(\\mathbf{u}_i) = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{u}}\\big|_{\\mathbf{u}_i}$ is the global tangent stiffness matrix, also known as the Jacobian of the system. The term \"consistent tangent\" refers to the material modulus used to construct $\\mathbf{K}_T$. For the standard equilibrium equation $\\mathbf{R}(\\mathbf{u}) = \\mathbf{F}_{\\text{ext}} - \\mathbf{F}_{\\text{int}}(\\mathbf{u})$, the tangent stiffness matrix is $\\mathbf{K}_T = \\frac{\\partial \\mathbf{F}_{\\text{int}}}{\\partial \\mathbf{u}}$. This global matrix is assembled from element stiffness matrices, which depend on the material's constitutive response. Specifically, the material contribution to the tangent stiffness is the rate of change of stress with respect to strain, which is the tangent modulus $\\mathbb{C} = \\frac{\\partial \\sigma}{\\partial \\varepsilon}$.\n\nThe quadratic convergence rate of the Newton-Raphson method is only achieved if the exact Jacobian, $\\mathbf{K}_T$, is used. For a data-driven or any other analytical constitutive law defined by a strain-energy function $\\psi(\\varepsilon)$, the stress is calculated as $\\sigma = \\partial\\psi/\\partial\\varepsilon$. To maintain consistency, the tangent modulus must be the exact derivative of this stress calculation, i.e., $\\mathbb{C} = \\partial\\sigma/\\partial\\varepsilon = \\partial^2\\psi/\\partial\\varepsilon^2$. Using this \"consistent tangent\" ensures that the assembled $\\mathbf{K}_T$ is the true Jacobian of the nonlinear system. If an approximation is used for $\\mathbb{C}$ (e.g., the initial elastic modulus, or a numerical approximation), the Jacobian is inexact, and the convergence of the Newton solver degrades from quadratic to linear or slower, or it may fail to converge entirely. Therefore, deriving and implementing the exact consistent tangent is essential for computational efficiency and robustness in nonlinear solvers, especially when using complex, data-driven constitutive models.",
            "answer": "$$\n\\boxed{146.3}\n$$"
        },
        {
            "introduction": "The power of data-driven discovery comes with a critical responsibility: model validation. A model that fits training data well may still produce physically unrealistic predictions or fail catastrophically when extrapolating to unseen conditions. This hands-on programming exercise guides you through the essential process of assessing a learned constitutive law for its physical plausibility and reliability, introducing methods to check for thermodynamic consistency and to quantify extrapolation risk by determining if a new data point lies within the convex hull of the training data .",
            "id": "3748583",
            "problem": "You are given a small-strain, plane-stress data-driven constitutive setting in which a learned linear mapping relates the symmetric strain tensor to the symmetric stress tensor via a matrix acting on the Voigt representation. Let the Voigt strain vector be $\\mathbf{e} = (e_{xx}, e_{yy}, e_{xy})^\\top \\in \\mathbb{R}^3$, and let the learned stiffness matrix be $\\mathbf{C} \\in \\mathbb{R}^{3 \\times 3}$. The learned stress is $\\mathbf{s} = \\mathbf{C} \\,\\mathbf{e}$. Assume all quantities are nondimensionalized, so every value is dimensionless.\n\nFundamental base and constraints:\n- Under small-strain linear elasticity, the existence of a strain energy density $W(\\mathbf{e})$ requires the stress to be derived from a potential, $\\mathbf{s} = \\frac{\\partial W}{\\partial \\mathbf{e}}$, which implies the stiffness must be symmetric, i.e., $\\mathbf{C} = \\mathbf{C}^\\top$. For a quadratic energy $W(\\mathbf{e}) = \\frac{1}{2} \\,\\mathbf{e}^\\top \\mathbf{C}_s \\,\\mathbf{e}$, where $\\mathbf{C}_s = \\frac{1}{2}(\\mathbf{C}+\\mathbf{C}^\\top)$ is the symmetric part, material stability requires $\\mathbf{C}_s$ to be positive definite (all eigenvalues strictly positive).\n- Energy nonnegativity and monotonicity along rays: for any nonzero strain direction $\\mathbf{e}$ and scalar loading parameter $\\lambda \\ge 0$, the energy along the ray $\\mathbf{e}(\\lambda) = \\lambda \\mathbf{e}$ must satisfy $\\frac{\\mathrm{d}}{\\mathrm{d}\\lambda} W(\\mathbf{e}(\\lambda)) = \\mathbf{s}(\\lambda) \\cdot \\mathbf{e} = \\lambda \\,\\mathbf{e}^\\top \\mathbf{C}_s \\,\\mathbf{e} \\ge 0$, which is guaranteed if $\\mathbf{C}_s$ is positive definite; violations occur when $\\mathbf{e}^\\top \\mathbf{C}_s \\,\\mathbf{e} < 0$.\n- Data-driven extrapolation risk assessment: given a set of training strains $\\mathcal{E}=\\{\\mathbf{e}_i\\}_{i=1}^N$, a test strain $\\mathbf{e}^\\star$ is said to be an extrapolation risk if it lies outside the convex hull $\\mathrm{conv}(\\mathcal{E})$, i.e., there does not exist nonnegative weights $\\{w_i\\}$ summing to $1$ such that $\\sum_i w_i \\mathbf{e}_i = \\mathbf{e}^\\star$.\n\nYour task is to write a program that, for a fixed training set $\\mathcal{E}$ and a test suite of learned stiffness matrices $\\mathbf{C}$ with corresponding test strains $\\mathbf{e}^\\star$, assesses extrapolation risk and quantifies violations of physical constraints.\n\nTraining set (common to all test cases), given as four points in $\\mathbb{R}^3$:\n- $\\mathbf{e}_1 = (0, 0, 0)$,\n- $\\mathbf{e}_2 = (0.02, 0, 0)$,\n- $\\mathbf{e}_3 = (0, 0.02, 0)$,\n- $\\mathbf{e}_4 = (0.01, 0.01, 0.005)$.\n\nTest suite consists of four cases. For each case $k \\in \\{1,2,3,4\\}$, you are given a learned stiffness matrix $\\mathbf{C}^{(k)}$ and a test strain $\\mathbf{e}^{\\star (k)}$:\n1. Case $1$ (symmetric positive definite, extrapolation expected):\n   - $\\mathbf{C}^{(1)} = \\begin{pmatrix} 1000 & 300 & 0 \\\\ 300 & 800 & 0 \\\\ 0 & 0 & 200 \\end{pmatrix}$,\n   - $\\mathbf{e}^{\\star (1)} = (0.03, 0.01, -0.002)$.\n2. Case $2$ (mild asymmetry, near-stable, inside hull expected):\n   - $\\mathbf{C}^{(2)} = \\begin{pmatrix} 900 & 250 & 10 \\\\ 260 & 750 & -5 \\\\ 5 & -20 & 150 \\end{pmatrix}$,\n   - $\\mathbf{e}^{\\star (2)} = (0.01, 0.01, 0)$.\n3. Case $3$ (symmetric, positive semidefinite, boundary of stability):\n   - $\\mathbf{C}^{(3)} = \\begin{pmatrix} 500 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 100 \\end{pmatrix}$,\n   - $\\mathbf{e}^{\\star (3)} = (0.02, 0.02, 0)$.\n4. Case $4$ (symmetric indefinite, energy can be negative in some directions):\n   - $\\mathbf{C}^{(4)} = \\begin{pmatrix} 100 & -300 & 0 \\\\ -300 & 100 & 0 \\\\ 0 & 0 & 50 \\end{pmatrix}$,\n   - $\\mathbf{e}^{\\star (4)} = (0.015, 0.015, 0)$.\n\nFor each test case $k$, compute the following five quantities:\n- $Q_1^{(k)}$: a boolean indicating whether $\\mathbf{e}^{\\star (k)}$ lies outside the convex hull of the training set $\\mathcal{E}$ (True means outside; False means inside).\n- $Q_2^{(k)}$: the energy nonnegativity violation magnitude, defined as $Q_2^{(k)} = \\max\\{0, -W(\\mathbf{e}^{\\star (k)})\\}$ where $W(\\mathbf{e}) = \\frac{1}{2}\\,\\mathbf{e}^\\top \\mathbf{C}_s^{(k)} \\,\\mathbf{e}$ and $\\mathbf{C}_s^{(k)} = \\frac{1}{2}(\\mathbf{C}^{(k)} + \\mathbf{C}^{(k)\\top})$ is the symmetric part.\n- $Q_3^{(k)}$: the asymmetry norm of the learned stiffness, defined as $Q_3^{(k)} = \\|\\mathbf{C}^{(k)} - \\mathbf{C}^{(k)\\top}\\|_F$, where $\\|\\cdot\\|_F$ denotes the Frobenius norm.\n- $Q_4^{(k)}$: a boolean indicating violation of positive definiteness of $\\mathbf{C}_s^{(k)}$, i.e., True if any eigenvalue of $\\mathbf{C}_s^{(k)}$ is less than or equal to a tolerance $\\varepsilon = 10^{-12}$, and False otherwise.\n- $Q_5^{(k)}$: a boolean indicating violation of ray-wise monotonicity, i.e., True if $\\mathbf{e}^{\\star (k)\\top} \\mathbf{C}_s^{(k)} \\mathbf{e}^{\\star (k)} < -\\varepsilon$ and False otherwise, with the same $\\varepsilon$.\n\nAll computations must be carried out using the symmetric part $\\mathbf{C}_s^{(k)}$ wherever energy or definiteness is involved. Treat all values as dimensionless. Use a numerical tolerance of $\\varepsilon = 10^{-12}$ for definiteness and monotonicity checks.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n$[Q_1^{(1)}, Q_2^{(1)}, Q_3^{(1)}, Q_4^{(1)}, Q_5^{(1)}, Q_1^{(2)}, Q_2^{(2)}, Q_3^{(2)}, Q_4^{(2)}, Q_5^{(2)}, Q_1^{(3)}, Q_2^{(3)}, Q_3^{(3)}, Q_4^{(3)}, Q_5^{(3)}, Q_1^{(4)}, Q_2^{(4)}, Q_3^{(4)}, Q_4^{(4)}, Q_5^{(4)}]$.\n\nDesign the algorithm from first principles stated above, without invoking any pre-packaged convex hull routines; to assess convex containment, you may determine whether there exist nonnegative weights summing to $1$ that reproduce the test strain as a convex combination of the training strains by solving a feasibility problem. All outputs must be dimensionless floats or booleans as defined, and the final line must match exactly the specified format.",
            "solution": "The problem statement has been meticulously reviewed and is deemed valid. It is scientifically grounded in the principles of linear elasticity and continuum mechanics, well-posed with all necessary data and definitions provided, and objective in its formulation. The tasks are clearly defined mathematical computations that admit a unique solution.\n\nThe solution proceeds by implementing algorithms to compute five distinct quantities for each of the four test cases. These quantities assess a data-driven constitutive model's adherence to physical principles and its extrapolation behavior. The principles and corresponding computational methods are detailed below for each quantity.\n\nFirst, we define the common data for all test cases. The training set of strain vectors is $\\mathcal{E} = \\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3, \\mathbf{e}_4\\}$, where:\n$$\n\\mathbf{e}_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{e}_2 = \\begin{pmatrix} 0.02 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{e}_3 = \\begin{pmatrix} 0 \\\\ 0.02 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{e}_4 = \\begin{pmatrix} 0.01 \\\\ 0.01 \\\\ 0.005 \\end{pmatrix}\n$$\nThe numerical tolerance for checks involving near-zero values is given as $\\varepsilon = 10^{-12}$. For each test case $k$, we are given a learned stiffness matrix $\\mathbf{C}^{(k)}$ and a test strain $\\mathbf{e}^{\\star (k)}$.\n\nThe core of the analysis relies on the symmetric part of the stiffness matrix, $\\mathbf{C}_s$, which governs the strain energy. For any given learned matrix $\\mathbf{C}$, its symmetric part is computed as:\n$$\n\\mathbf{C}_s = \\frac{1}{2}\\left(\\mathbf{C} + \\mathbf{C}^\\top\\right)\n$$\n\nThe five quantities are computed as follows:\n\n$Q_1^{(k)}$: Extrapolation Risk\nThis quantity is a boolean indicating whether the test strain $\\mathbf{e}^{\\star (k)}$ lies outside the convex hull of the training set, $\\mathrm{conv}(\\mathcal{E})$. By the definition of a convex hull, a point $\\mathbf{e}^\\star$ is inside or on the boundary of $\\mathrm{conv}(\\mathcal{E})$ if and only if it can be expressed as a convex combination of the points in $\\mathcal{E}$. That is, there must exist a set of non-negative weights $\\{w_i\\}_{i=1}^4$ such that:\n$$\n\\sum_{i=1}^4 w_i \\mathbf{e}_i = \\mathbf{e}^{\\star (k)} \\quad \\text{and} \\quad \\sum_{i=1}^4 w_i = 1, \\quad w_i \\ge 0\n$$\nThis constitutes a linear programming feasibility problem. Let the weights be the unknown vector $\\mathbf{w} = (w_1, w_2, w_3, w_4)^\\top$. The conditions can be written in matrix form as $\\mathbf{A}_{\\text{eq}} \\mathbf{w} = \\mathbf{b}_{\\text{eq}}$, where:\n$$\n\\mathbf{A}_{\\text{eq}} = \\begin{pmatrix} | & | & | & | \\\\ \\mathbf{e}_1 & \\mathbf{e}_2 & \\mathbf{e}_3 & \\mathbf{e}_4 \\\\ | & | & | & | \\\\ 1 & 1 & 1 & 1 \\end{pmatrix} \\in \\mathbb{R}^{4 \\times 4}, \\quad\n\\mathbf{b}_{\\text{eq}} = \\begin{pmatrix} | \\\\ \\mathbf{e}^{\\star (k)} \\\\ | \\\\ 1 \\end{pmatrix} \\in \\mathbb{R}^{4}\n$$\nThe problem is to find a vector $\\mathbf{w}$ that satisfies this system of equations along with the non-negativity constraint $\\mathbf{w} \\ge \\mathbf{0}$. We can solve this using a linear programming solver, such as `scipy.optimize.linprog`, with an arbitrary objective function (e.g., minimizing $0$). If the solver finds a feasible solution, $\\mathbf{e}^{\\star (k)}$ is inside the convex hull, and $Q_1^{(k)}$ is `False`. If no such solution exists, $\\mathbf{e}^{\\star (k)}$ is outside, and $Q_1^{(k)}$ is `True`.\n\n$Q_2^{(k)}$: Energy Nonnegativity Violation\nThe strain energy density $W$ associated with a linear elastic material is a quadratic function of the strain, defined through the symmetric part of the stiffness matrix: $W(\\mathbf{e}) = \\frac{1}{2} \\mathbf{e}^\\top \\mathbf{C}_s \\mathbf{e}$. A fundamental requirement of material physics is that strain energy must be non-negative, $W(\\mathbf{e}) \\ge 0$. A violation occurs if, for a given strain, the computed energy is negative. The magnitude of this violation for the test strain $\\mathbf{e}^{\\star (k)}$ is quantified as:\n$$\nQ_2^{(k)} = \\max\\{0, -W(\\mathbf{e}^{\\star (k)})\\} = \\max\\left\\{0, -\\frac{1}{2} (\\mathbf{e}^{\\star (k)})^\\top \\mathbf{C}_s^{(k)} \\mathbf{e}^{\\star (k)}\\right\\}\n$$\nThis is a direct calculation involving matrix-vector multiplication.\n\n$Q_3^{(k)}$: Asymmetry Norm\nThe existence of a strain energy potential function $W(\\mathbf{e})$ from which the stress can be derived ($\\mathbf{s} = \\partial W / \\partial \\mathbf{e}$) mathematically requires the stiffness matrix to be symmetric. This is known as a Maxwell relation. A learned stiffness matrix $\\mathbf{C}^{(k)}$ from data might not be perfectly symmetric. The deviation from symmetry is a measure of physical inconsistency. We quantify this deviation using the Frobenius norm of the difference between the matrix and its transpose:\n$$\nQ_3^{(k)} = \\|\\mathbf{C}^{(k)} - (\\mathbf{C}^{(k)})^\\top\\|_F = \\sqrt{\\sum_{i=1}^3 \\sum_{j=1}^3 (C_{ij}^{(k)} - C_{ji}^{(k)})^2}\n$$\nThis is computed using standard linear algebra library functions.\n\n$Q_4^{(k)}$: Positive Definiteness Violation\nFor material stability, the strain energy density $W(\\mathbf{e})$ must be strictly positive for any non-zero strain $\\mathbf{e}$. This condition is met if and only if the symmetric stiffness matrix $\\mathbf{C}_s$ is positive definite. A matrix is positive definite if all of its eigenvalues are strictly positive. A violation occurs if $\\mathbf{C}_s^{(k)}$ has at least one eigenvalue that is zero or negative. Computationally, we check if the minimum eigenvalue $\\lambda_{\\min}(\\mathbf{C}_s^{(k)})$ is less than or equal to a small tolerance $\\varepsilon = 10^{-12}$:\n$$\nQ_4^{(k)} = \\begin{cases} \\text{True} & \\text{if } \\lambda_{\\min}(\\mathbf{C}_s^{(k)}) \\le \\varepsilon \\\\ \\text{False} & \\text{otherwise} \\end{cases}\n$$\nSince $\\mathbf{C}_s^{(k)}$ is symmetric, its eigenvalues are real and can be computed efficiently.\n\n$Q_5^{(k)}$: Ray-wise Monotonicity Violation\nThis is a related but distinct check from energy nonnegativity at a single point. It examines the behavior of energy along a ray from the origin in the direction of the test strain $\\mathbf{e}^{\\star (k)}$. The energy along this ray is $W(\\lambda \\mathbf{e}^{\\star (k)}) = \\frac{1}{2} \\lambda^2 ((\\mathbf{e}^{\\star (k)})^\\top \\mathbf{C}_s^{(k)} \\mathbf{e}^{\\star (k)})$. For energy to be non-decreasing with the loading parameter $\\lambda \\ge 0$, the quadratic form $(\\mathbf{e}^{\\star (k)})^\\top \\mathbf{C}_s^{(k)} \\mathbf{e}^{\\star (k)}$ must be non-negative. A violation occurs if this quantity is negative. We use a tolerance $\\varepsilon$ for this check:\n$$\nQ_5^{(k)} = \\begin{cases} \\text{True} & \\text{if } (\\mathbf{e}^{\\star (k)})^\\top \\mathbf{C}_s^{(k)} \\mathbf{e}^{\\star (k)} < -\\varepsilon \\\\ \\text{False} & \\text{otherwise} \\end{cases}\n$$\nThis check directly evaluates whether the specific direction defined by $\\mathbf{e}^{\\star (k)}$ is a direction of decreasing energy, which is a sign of instability.\n\nThe implementation will now proceed by applying these five computational steps to each of the four test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the data-driven constitutive model validation problem.\n    \"\"\"\n\n    # Define the training set of strain vectors.\n    e_train = [\n        np.array([0., 0., 0.]),\n        np.array([0.02, 0., 0.]),\n        np.array([0., 0.02, 0.]),\n        np.array([0.01, 0.01, 0.005])\n    ]\n\n    # Define the four test cases.\n    test_cases = [\n        {\n            \"C\": np.array([\n                [1000., 300., 0.],\n                [300., 800., 0.],\n                [0., 0., 200.]\n            ]),\n            \"e_star\": np.array([0.03, 0.01, -0.002])\n        },\n        {\n            \"C\": np.array([\n                [900., 250., 10.],\n                [260., 750., -5.],\n                [5., -20., 150.]\n            ]),\n            \"e_star\": np.array([0.01, 0.01, 0.])\n        },\n        {\n            \"C\": np.array([\n                [500., 0., 0.],\n                [0., 0., 0.],\n                [0., 0., 100.]\n            ]),\n            \"e_star\": np.array([0.02, 0.02, 0.])\n        },\n        {\n            \"C\": np.array([\n                [100., -300., 0.],\n                [-300., 100., 0.],\n                [0., 0., 50.]\n            ]),\n            \"e_star\": np.array([0.015, 0.015, 0.])\n        }\n    ]\n\n    # Set numerical tolerance.\n    TOLERANCE = 1e-12\n\n    # Prepare for convex hull checks (A_eq is common to all cases).\n    # A_eq is a 4x4 matrix from the convex combination equations.\n    # The first 3 rows are the training strain vectors as columns.\n    # The last row is [1, 1, 1, 1] for the sum-to-one constraint on weights.\n    A_eq = np.vstack([np.array(e_train).T, np.ones(len(e_train))])\n\n    results = []\n    for case in test_cases:\n        C = case[\"C\"]\n        e_star = case[\"e_star\"]\n\n        # --- Q1: Extrapolation Risk (Convex Hull Check) ---\n        # b_eq is a vector of length 4.\n        # The first 3 elements are the test strain vector.\n        # The last element is 1 for the sum-to-one constraint.\n        b_eq = np.hstack([e_star, 1.0])\n        # We seek weights w >= 0 such that A_eq @ w = b_eq.\n        # Objective function c is irrelevant for a feasibility problem.\n        c = np.zeros(len(e_train))\n        # Use scipy's linear programming solver. Non-negativity of weights is handled by bounds.\n        # method='highs' is a robust simplex and interior-point method.\n        lp_res = linprog(c=c, A_eq=A_eq, b_eq=b_eq, bounds=(0, None), method='highs')\n        \n        # A successful solve means weights were found, so e_star is IN the hull.\n        # The question asks for True if OUTSIDE the hull.\n        q1 = not lp_res.success\n\n        # --- Symmetric part of the stiffness matrix ---\n        C_s = 0.5 * (C + C.T)\n\n        # --- Q2: Energy Nonnegativity Violation ---\n        # W(e) = 0.5 * e.T @ C_s @ e\n        W_e_star = 0.5 * e_star.T @ C_s @ e_star\n        q2 = np.maximum(0.0, -W_e_star)\n\n        # --- Q3: Asymmetry Norm ---\n        # Frobenius norm of (C - C.T)\n        q3 = np.linalg.norm(C - C.T, 'fro')\n\n        # --- Q4: Positive Definiteness Violation ---\n        # Eigenvalues of the symmetric matrix C_s.\n        # np.linalg.eigvalsh is efficient and numerically stable for Hermitian matrices.\n        eigenvalues = np.linalg.eigvalsh(C_s)\n        # Violation if any eigenvalue is <= tolerance.\n        q4 = np.any(eigenvalues <= TOLERANCE)\n\n        # --- Q5: Ray-wise Monotonicity Violation ---\n        # Check if e_star.T @ C_s @ e_star is negative.\n        quadratic_form = e_star.T @ C_s @ e_star\n        q5 = quadratic_form < -TOLERANCE\n        \n        results.extend([q1, q2, q3, q4, q5])\n\n    # Format the output as a single string.\n    # Booleans are automatically converted to 'True'/'False'.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}