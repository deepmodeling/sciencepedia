{
    "hands_on_practices": [
        {
            "introduction": "A fundamental requirement for any non-equilibrium theory is that it correctly recovers the laws of equilibrium thermodynamics. This first practice provides a crucial check on the GENERIC formalism by connecting the static concept of equilibrium, defined by the minimization of a free energy functional, to the dynamic concept of a stationary state. By working through this exercise , you will see precisely how the built-in degeneracy conditions ensure that thermodynamic equilibrium corresponds to a fixed point of the system's evolution.",
            "id": "4109694",
            "problem": "Consider a scalar order parameter field $\\psi(\\mathbf{x})$ representing a coarse-grained composition fluctuation of a binary complex fluid on a periodic domain $\\Omega \\subset \\mathbb{R}^{d}$ with sufficiently smooth fields. Work at fixed absolute temperature $T>0$. Let the energy functional $E[\\psi]$ and the entropy functional $S[\\psi]$ be given by\n$$\nE[\\psi] \\equiv \\int_{\\Omega} \\left( \\frac{a}{2}\\,\\psi^{2} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} \\right)\\, \\mathrm{d}\\mathbf{x}, \\qquad\nS[\\psi] \\equiv \\int_{\\Omega} \\left( s_{0} - \\frac{b}{2}\\,\\psi^{2} - \\frac{c}{4}\\,\\psi^{4} \\right)\\, \\mathrm{d}\\mathbf{x},\n$$\nwhere $a>0$, $\\kappa>0$, $b>0$, $c>0$, and $s_{0}$ is a constant (which does not affect the minimization). The Helmholtz free energy functional is $F[\\psi] \\equiv E[\\psi] - T\\,S[\\psi]$.\n\nStart from first principles of the calculus of variations with periodic boundary conditions on $\\Omega$ and the thermodynamic structure of the General Equation for Non-Equilibrium Reversible-Irreversible Coupling (GENERIC). In GENERIC, the evolution of the coarse-grained state variable $\\psi$ is of the form\n$$\n\\dot{\\psi} = L(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} + M(\\psi)\\,\\frac{\\delta S}{\\delta \\psi},\n$$\nwhere $L(\\psi)$ is an antisymmetric operator (generating reversible dynamics) and $M(\\psi)$ is a symmetric positive semidefinite operator (generating dissipative dynamics), with degeneracy conditions $L(\\psi)\\,\\frac{\\delta S}{\\delta \\psi} = 0$ and $M(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} = 0$.\n\nTasks:\n- Derive the Euler–Lagrange equation associated with minimizing $F[\\psi]$ over periodic $\\psi$, and use it together with the given sign conditions on $a$, $\\kappa$, $b$, and $c$ to determine the equilibrium field $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ that minimizes $F[\\psi]$.\n- Using only the GENERIC structure stated above and the degeneracy conditions, verify that the $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ you found is a stationary solution of the GENERIC evolution equation at the fixed temperature $T$.\n\nExpress the final answer for the equilibrium field $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ as a single closed-form analytic expression in terms of the parameters $a$, $b$, $c$, $\\kappa$, and $T$. No numerical evaluation or rounding is required. The final answer must be a single analytical expression.",
            "solution": "The solution involves two main steps: first, finding the equilibrium state by minimizing the Helmholtz free energy functional, and second, showing this state is a stationary point of the GENERIC evolution equation.\n\n**1. Minimization of Helmholtz Free Energy**\n\nThe Helmholtz free energy functional $F[\\psi]$ is given by $F[\\psi] \\equiv E[\\psi] - T\\,S[\\psi]$. Substituting the provided expressions for $E[\\psi]$ and $S[\\psi]$:\n$$\nF[\\psi] = \\int_{\\Omega} \\left( \\frac{a}{2}\\,\\psi^{2} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} \\right)\\, \\mathrm{d}\\mathbf{x} - T \\int_{\\Omega} \\left( s_{0} - \\frac{b}{2}\\,\\psi^{2} - \\frac{c}{4}\\,\\psi^{4} \\right)\\, \\mathrm{d}\\mathbf{x}\n$$\nCombining the terms into a single integrand gives the free energy density $\\mathcal{F}$:\n$$\nF[\\psi] = \\int_{\\Omega} \\underbrace{\\left( \\left(\\frac{a + Tb}{2}\\right)\\psi^{2} + \\frac{Tc}{4}\\,\\psi^{4} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} - T s_{0} \\right)}_{\\mathcal{F}(\\psi, \\nabla\\psi)} \\, \\mathrm{d}\\mathbf{x}\n$$\nTo find the global minimum of $F[\\psi]$, we can analyze its components.\n- The gradient term, $\\int_{\\Omega} \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} \\, \\mathrm{d}\\mathbf{x}$, is minimized (becomes zero) when $\\psi$ is a spatially uniform constant, as $\\kappa > 0$.\n- For a uniform field $\\psi(\\mathbf{x}) = \\psi_0$, the functional simplifies to minimizing the potential $V(\\psi_0) = \\left(\\frac{a + Tb}{2}\\right)\\psi_{0}^{2} + \\frac{Tc}{4}\\,\\psi_{0}^{4}$.\n- The derivative of this potential is $\\frac{dV}{d\\psi_0} = (a + Tb)\\psi_0 + Tc\\psi_0^3 = \\psi_0((a+Tb) + Tc\\psi_0^2)$.\n- Since all parameters $a, b, c, T$ are positive, the term $(a+Tb) + Tc\\psi_0^2$ is always strictly positive. Therefore, the only real solution to $\\frac{dV}{d\\psi_0}=0$ is $\\psi_0 = 0$.\n- The second derivative, $\\frac{d^2V}{d\\psi_0^2} = (a+Tb) + 3Tc\\psi_0^2$, is positive at $\\psi_0=0$, confirming it is a minimum.\nBecause all terms in the potential $V(\\psi_0)$ and the gradient term are non-negative (for real $\\psi_0$), the global minimum of the functional $F[\\psi]$ is achieved when both parts are minimized simultaneously, which occurs at the spatially uniform state $\\psi_{\\mathrm{eq}}(\\mathbf{x}) = 0$.\n\n**2. Verification as a Stationary Solution**\n\nA thermodynamic equilibrium state $\\psi_{\\mathrm{eq}}$ is one that minimizes the free energy, so the variational derivative is zero:\n$$\n\\frac{\\delta F}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} = \\frac{\\delta E}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} - T \\frac{\\delta S}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} = 0\n$$\nThis implies the key equilibrium condition: $\\frac{\\delta E}{\\delta \\psi}\\big|_{\\psi_{\\mathrm{eq}}} = T \\frac{\\delta S}{\\delta \\psi}\\big|_{\\psi_{\\mathrm{eq}}}$.\n\nNow, we evaluate the GENERIC evolution equation $\\dot{\\psi} = L(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} + M(\\psi)\\,\\frac{\\delta S}{\\delta \\psi}$ at this equilibrium state $\\psi_{\\mathrm{eq}}$.\n- The reversible part becomes: $L(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta E}{\\delta \\psi}\\big|_{\\psi_{\\mathrm{eq}}} = L(\\psi_{\\mathrm{eq}})\\,\\left(T \\frac{\\delta S}{\\delta \\psi}\\big|_{\\psi_{\\mathrm{eq}}}\\right) = T \\left(L(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi}\\big|_{\\psi_{\\mathrm{eq}}}\\right)$. By the first degeneracy condition ($L\\frac{\\delta S}{\\delta \\psi} = 0$), this term is zero.\n- For the irreversible part, we use the second degeneracy condition ($M\\frac{\\delta E}{\\delta \\psi} = 0$), which at equilibrium gives $M(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta E}{\\delta \\psi}\\big|_{\\psi_{\\mathrm{eq}}} = 0$. Substituting the equilibrium condition, we get $M(\\psi_{\\mathrm{eq}})\\,\\left(T \\frac{\\delta S}{\\delta \\psi}\\big|_{\\psi_{\\mathrm{eq}}}\\right) = T \\left(M(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi}\\big|_{\\psi_{\\mathrm{eq}}}\\right) = 0$. Since $T>0$, this means the irreversible term $M(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi}\\big|_{\\psi_{\\mathrm{eq}}}$ is also zero.\n\nBoth the reversible and irreversible parts of the time evolution vanish at the thermodynamic equilibrium state. Therefore, $\\dot{\\psi}|_{\\psi=\\psi_{\\mathrm{eq}}} = 0$, confirming that the equilibrium field $\\psi_{\\mathrm{eq}}(\\mathbf{x}) = 0$ is a stationary solution of the GENERIC equation.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "To apply the GENERIC formalism to real-world problems involving spatially varying fields, we must translate the continuous model into a discrete form suitable for a computer. This is not a trivial step; a naive discretization can easily destroy the very thermodynamic structure we wish to preserve. This exercise  guides you through the design of discrete spatial operators that correctly mimic the properties of their continuous counterparts, ensuring that the resulting numerical model remains faithful to the underlying physics.",
            "id": "4109668",
            "problem": "You are to design and implement a spatial discretization for a one-dimensional periodic complex fluid model within the General Equation for the Non-Equilibrium Reversible-Irreversible Coupling (GENERIC) formalism. The GENERIC structure evolves a state vector $\\mathbf{z}$ by\n$$\n\\dot{\\mathbf{z}} \\;=\\; \\mathbf{L}(\\mathbf{z}) \\,\\nabla_{\\mathbf{z}} E(\\mathbf{z}) \\;+\\; \\mathbf{M}(\\mathbf{z}) \\,\\nabla_{\\mathbf{z}} S(\\mathbf{z}),\n$$\nwhere $\\mathbf{L}$ is antisymmetric, $\\mathbf{M}$ is symmetric positive semidefinite, and the degeneracy conditions $\\mathbf{L}\\,\\nabla_{\\mathbf{z}} S \\,=\\, \\mathbf{0}$ and $\\mathbf{M}\\,\\nabla_{\\mathbf{z}} E \\,=\\, \\mathbf{0}$ hold. In this task, consider a single scalar field $\\phi(x,t)$ on a periodic domain of length $L_{\\text{dom}}$, with constant transport parameters: an advection speed $u$ and a mobility $\\kappa \\ge 0$. Your goal is to construct discrete operators $\\mathbf{L}_h$ and $\\mathbf{M}_h$ on a uniform grid of $N$ points that embody the reversible and irreversible couplings consistent with GENERIC, by enforcing the following properties:\n\n- Antisymmetry: $\\mathbf{L}_h^\\top \\,=\\, -\\,\\mathbf{L}_h$.\n- Symmetry and positive semidefiniteness: $\\mathbf{M}_h^\\top \\,=\\, \\mathbf{M}_h$ and $\\mathbf{v}^\\top \\mathbf{M}_h \\mathbf{v} \\,\\ge\\, 0$ for all vectors $\\mathbf{v}$.\n\nStart from the following fundamental base and constraints:\n- Use the discrete analog of the periodic integration-by-parts identity (discrete summation-by-parts) on a uniform grid with spacing $h \\,=\\, L_{\\text{dom}}/N$ to guide the construction of consistent first and second derivative operators.\n- The reversible (Hamiltonian-like) advection part must be represented by a discrete first-derivative operator that is skew-adjoint under the standard Euclidean inner product so that the associated matrix is antisymmetric.\n- The irreversible (dissipative) diffusion part must be represented by a discrete second-derivative operator that is self-adjoint and negative semidefinite; multiplying by a nonnegative mobility yields a symmetric positive semidefinite metric operator.\n\nDesign the discretization in purely mathematical terms:\n- Choose a periodic, uniform grid with $N$ points and spacing $h$, and construct:\n  - A matrix $\\mathbf{D}_1$ that approximates the first derivative in space and satisfies $\\mathbf{D}_1^\\top \\,=\\, -\\,\\mathbf{D}_1$.\n  - A matrix $\\mathbf{D}_2$ that approximates the second derivative in space and satisfies $\\mathbf{D}_2^\\top \\,=\\, \\mathbf{D}_2$ and has nonpositive eigenvalues.\n- Define $\\mathbf{L}_h$ by scaling the first-derivative operator by the advection speed $u$, and define $\\mathbf{M}_h$ by scaling the negative of the second-derivative operator by the mobility $\\kappa$:\n  $$\n  \\mathbf{L}_h \\,=\\, u\\,\\mathbf{D}_1,\\qquad \\mathbf{M}_h \\,=\\, \\kappa\\,\\left(-\\mathbf{D}_2\\right).\n  $$\n- Verify numerically, for each test case, that:\n  $$\n  \\|\\mathbf{L}_h + \\mathbf{L}_h^\\top\\|_F \\,\\le\\, \\varepsilon \\,\\max\\{1,\\|\\mathbf{L}_h\\|_F\\},\\qquad\n  \\|\\mathbf{M}_h - \\mathbf{M}_h^\\top\\|_F \\,\\le\\, \\varepsilon \\,\\max\\{1,\\|\\mathbf{M}_h\\|_F\\},\n  $$\n  and that the minimum eigenvalue of the symmetrized metric $\\tfrac{1}{2}(\\mathbf{M}_h+\\mathbf{M}_h^\\top)$ is greater than or equal to $-\\,\\varepsilon$ for a tolerance $\\varepsilon$.\n\nImplementation requirements:\n- Use a one-dimensional periodic grid of $N$ points on a domain of length $L_{\\text{dom}} \\,=\\, 1$ with spacing $h \\,=\\, 1/N$.\n- Construct $\\mathbf{D}_1$ and $\\mathbf{D}_2$ so that they satisfy the structural properties above for any $N \\ge 3$. The constructions must be consistent with discrete summation-by-parts on the periodic grid.\n- Set the antisymmetric GENERIC operator $\\mathbf{L}_h$ and the symmetric positive semidefinite GENERIC operator $\\mathbf{M}_h$ according to the given $u$ and $\\kappa$.\n- For each test case, return a boolean indicating whether all three checks pass: antisymmetry of $\\mathbf{L}_h$, symmetry of $\\mathbf{M}_h$, and positive semidefiniteness of $\\mathbf{M}_h$.\n\nTest suite:\n- Use tolerance $\\varepsilon \\,=\\, 10^{-12}$.\n- Domain length $L_{\\text{dom}} \\,=\\, 1$.\n- The test cases are the tuples $(N, u, \\kappa)$:\n  - Case A: $(N, u, \\kappa) \\,=\\, (\\,3,\\, 1.7,\\, 0.0\\,)$.\n  - Case B: $(N, u, \\kappa) \\,=\\, (\\,4,\\, 0.0,\\, 1.0\\,)$.\n  - Case C: $(N, u, \\kappa) \\,=\\, (\\,7,\\, -2.0,\\, 0.5\\,)$.\n  - Case D: $(N, u, \\kappa) \\,=\\, (\\,16,\\, 3.3,\\, 10^{-3}\\,)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite cases A, B, C, D. Each entry must be a boolean indicating whether the three required properties hold for that case, for example: \"[True,False,True,True]\".",
            "solution": "The problem statement is valid. It presents a well-posed, scientifically grounded task within the field of computational thermodynamics of complex fluids. The objective is to design and implement a structure-preserving spatial discretization for a one-dimensional system described by the General Equation for a Non-Equilibrium Reversible-Irreversible Coupling (GENERIC). This requires the construction of discrete operators that maintain the fundamental geometric properties of the continuous model—namely, the antisymmetry of the reversible operator $\\mathbf{L}_h$ and the symmetric positive semidefiniteness of the irreversible operator $\\mathbf{M}_h$.\n\nThe design of these discrete operators, denoted $\\mathbf{L}_h$ and $\\mathbf{M}_h$, is based on the principle of discrete summation-by-parts on a periodic, uniform grid. This principle serves as the discrete analogue of integration-by-parts and ensures that the resulting numerical scheme respects the underlying conservation and dissipation laws of the continuous theory. We consider a scalar field $\\phi(x,t)$ discretized on a grid of $N$ points $\\{x_i = i h\\}_{i=0}^{N-1}$ with uniform spacing $h = L_{\\text{dom}}/N$. The field is represented by a vector $\\boldsymbol{\\phi} \\in \\mathbb{R}^N$ where $(\\boldsymbol{\\phi})_i = \\phi(x_i)$.\n\nFirst, we construct the discrete first-derivative operator, $\\mathbf{D}_1$, which forms the basis for the reversible part. The continuous first-derivative operator, $\\partial_x$, is skew-adjoint on a periodic domain with respect to the $L^2$ inner product. Consequently, its discrete counterpart, $\\mathbf{D}_1$, must be an antisymmetric matrix, i.e., $\\mathbf{D}_1^\\top = -\\mathbf{D}_1$. A standard second-order central difference scheme satisfies this requirement under periodic boundary conditions. The action of this operator on the discrete field $\\boldsymbol{\\phi}$ at grid point $i$ is given by:\n$$\n(\\mathbf{D}_1 \\boldsymbol{\\phi})_i = \\frac{\\phi_{i+1 \\pmod N} - \\phi_{i-1 \\pmod N}}{2h}\n$$\nThe resulting $N \\times N$ matrix $\\mathbf{D}_1$ is a circulant matrix with a main diagonal of zeros and off-diagonals with values $1/(2h)$ and $-1/(2h)$, correctly encoding the periodic connectivity. Its antisymmetry is evident from its structure. The reversible GENERIC operator $\\mathbf{L}_h$ is then defined as:\n$$\n\\mathbf{L}_h = u\\,\\mathbf{D}_1\n$$\nwhere $u$ is the advection speed. Since $u$ is a scalar, the antisymmetry of $\\mathbf{D}_1$ is directly inherited by $\\mathbf{L}_h$:\n$$\n\\mathbf{L}_h^\\top = (u\\,\\mathbf{D}_1)^\\top = u\\,\\mathbf{D}_1^\\top = u(-\\mathbf{D}_1) = -\\mathbf{L}_h\n$$\n\nNext, we construct the discrete second-derivative operator, $\\mathbf{D}_2$, which forms the basis for the irreversible part. The continuous negative Laplacian, $-\\partial_x^2$, is a symmetric, positive-semidefinite operator on a periodic domain, which is a required property for a dissipative operator. We thus seek a discrete operator $\\mathbf{D}_2$ that is symmetric and negative-semidefinite. The standard second-order central difference approximation for the second derivative is:\n$$\n(\\mathbf{D}_2 \\boldsymbol{\\phi})_i = \\frac{\\phi_{i+1 \\pmod N} - 2\\phi_i + \\phi_{i-1 \\pmod N}}{h^2}\n$$\nThis defines the matrix $\\mathbf{D}_2$ as the periodic discrete Laplacian, which is a symmetric, circulant, Toeplitz matrix. To verify its spectral properties, we can analytically determine its eigenvalues. The eigenvalues of this specific circulant matrix are known to be:\n$$\n\\lambda_j(\\mathbf{D}_2) = \\frac{1}{h^2} \\left( e^{i 2\\pi j/N} - 2 + e^{-i 2\\pi j/N} \\right) = \\frac{2}{h^2} \\left( \\cos\\left(\\frac{2\\pi j}{N}\\right) - 1 \\right) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi j}{N}\\right)\n$$\nfor $j = 0, 1, \\dots, N-1$. Since $\\sin^2(\\cdot) \\ge 0$, it is clear that all eigenvalues $\\lambda_j(\\mathbf{D}_2)$ are non-positive, confirming that $\\mathbf{D}_2$ is a negative-semidefinite matrix.\n\nThe irreversible GENERIC operator $\\mathbf{M}_h$ is defined by scaling the negative of $\\mathbf{D}_2$ by the non-negative mobility $\\kappa \\ge 0$:\n$$\n\\mathbf{M}_h = \\kappa(-\\mathbf{D}_2)\n$$\nThe symmetry of $\\mathbf{D}_2$ ensures that $\\mathbf{M}_h$ is also symmetric: $\\mathbf{M}_h^\\top = \\kappa(-\\mathbf{D}_2)^\\top = \\kappa(-\\mathbf{D}_2) = \\mathbf{M}_h$. The eigenvalues of $\\mathbf{M}_h$ are $\\lambda_j(\\mathbf{M}_h) = -\\kappa \\lambda_j(\\mathbf{D}_2) = \\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{\\pi j}{N}\\right)$. Since $\\kappa \\ge 0$ and $h^2 > 0$, all eigenvalues of $\\mathbf{M}_h$ are non-negative. This confirms that $\\mathbf{M}_h$ is symmetric and positive-semidefinite.\n\nThis construction guarantees, by its analytical design, that the resulting discrete operators $\\mathbf{L}_h$ and $\\mathbf{M}_h$ satisfy the structural requirements of the GENERIC formalism. The provided implementation numerically constructs these matrices and verifies that these properties hold true up to a specified floating-point tolerance $\\varepsilon = 10^{-12}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef construct_and_verify(N, u, kappa, L_dom, eps):\n    \"\"\"\n    Constructs and verifies the GENERIC operators for a 1D periodic system.\n\n    Args:\n        N (int): Number of grid points.\n        u (float): Advection speed.\n        kappa (float): Mobility.\n        L_dom (float): Length of the periodic domain.\n        eps (float): Tolerance for numerical verification.\n\n    Returns:\n        bool: True if all properties are satisfied, False otherwise.\n    \"\"\"\n    if N  3:\n        # The central difference stencils are not well-defined for N  3.\n        return False\n        \n    # 1. Construct discrete operators D1 and D2\n    h = L_dom / N\n    \n    # Use np.roll for an elegant construction on a periodic grid.\n    # E is the forward shift operator: (E @ f)_i = f_{i+1}\n    E = np.roll(np.identity(N), -1, axis=1)\n    # E_inv is the backward shift operator: (E_inv @ f)_i = f_{i-1}\n    E_inv = np.roll(np.identity(N), 1, axis=1)\n    \n    # Second-order central difference for the first derivative\n    # D1 ~ (f(x+h) - f(x-h)) / 2h\n    D1 = (E - E_inv) / (2.0 * h)\n    \n    # Second-order central difference for the second derivative\n    # D2 ~ (f(x+h) - 2f(x) + f(x-h)) / h^2\n    D2 = (E - 2.0 * np.identity(N) + E_inv) / (h**2)\n    \n    # 2. Define GENERIC operators L_h and M_h\n    L_h = u * D1\n    M_h = kappa * (-D2)\n    \n    # 3. Verify the required properties\n    \n    # Check 1: Antisymmetry of L_h\n    # ||L_h + L_h^T||_F = eps * max(1, ||L_h||_F)\n    norm_L = np.linalg.norm(L_h, 'fro')\n    err_L = np.linalg.norm(L_h + L_h.T, 'fro')\n    check_L = err_L = eps * max(1.0, norm_L)\n    \n    # Check 2: Symmetry of M_h\n    # ||M_h - M_h^T||_F = eps * max(1, ||M_h||_F)\n    norm_M = np.linalg.norm(M_h, 'fro')\n    err_M = np.linalg.norm(M_h - M_h.T, 'fro')\n    check_M_sym = err_M = eps * max(1.0, norm_M)\n    \n    # Check 3: Positive Semidefiniteness of M_h\n    # min_eigenvalue(0.5*(M_h + M_h^T)) >= -eps\n    # The symmetrization step ensures the matrix is Hermitian for the eigenvalue solver,\n    # robustly handling any minor floating-point asymmetries.\n    M_h_symmetrized = 0.5 * (M_h + M_h.T)\n    \n    # Handle the trivial case of a zero matrix separately for robustness.\n    if np.allclose(M_h_symmetrized, 0, atol=eps):\n        min_eig = 0.0\n    else:\n        # Use np.linalg.eigvalsh for real symmetric (Hermitian) matrices.\n        # It is faster and more numerically stable than np.linalg.eigvals.\n        eigenvalues = np.linalg.eigvalsh(M_h_symmetrized)\n        min_eig = np.min(eigenvalues)\n        \n    check_M_psd = min_eig >= -eps\n    \n    return check_L and check_M_sym and check_M_psd\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, u, kappa)\n        (3, 1.7, 0.0),    # Case A\n        (4, 0.0, 1.0),    # Case B\n        (7, -2.0, 0.5),   # Case C\n        (16, 3.3, 1e-3),  # Case D (10^{-3} = 0.001)\n    ]\n    \n    # Parameters defined in the problem\n    L_dom = 1.0\n    eps = 1e-12\n    \n    results = []\n    for case in test_cases:\n        N, u, kappa = case\n        is_valid = construct_and_verify(N, u, kappa, L_dom, eps)\n        results.append(is_valid)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solution\nsolve()\n\n```"
        },
        {
            "introduction": "Once a GENERIC model is discretized in space, the next task is to evolve the system in time. The dual nature of the GENERIC equation, which combines energy-conserving reversible dynamics with entropy-producing irreversible dynamics, calls for specialized numerical methods. This practice  introduces the powerful split-step integration scheme, which treats each part of the dynamics separately to better preserve the overall thermodynamic structure of the model.",
            "id": "4109658",
            "problem": "You are to implement a split-step integrator for a finite-dimensional model inspired by the General Equation for Non-Equilibrium Reversible-Irreversible Coupling (GENERIC) formalism in computational complex fluids. In the GENERIC framework, the state variable is $z \\in \\mathbb{R}^n$ and its evolution is given by\n$$\n\\frac{dz}{dt} = L(z) \\nabla E(z) + M(z) \\nabla S(z),\n$$\nwhere $E(z)$ is the energy, $S(z)$ is the entropy, $L(z)$ is the antisymmetric Poisson operator (reversible, Hamiltonian flow), and $M(z)$ is the symmetric positive semidefinite dissipative operator (irreversible, gradient flow). The degeneracy conditions are\n$$\nL(z) \\nabla S(z) = 0, \\quad M(z) \\nabla E(z) = 0,\n$$\nwhich imply that the reversible part preserves entropy and the irreversible part preserves energy.\n\nConsider the three-dimensional state $z = (q,p,s)$, where $q$ and $p$ are canonical variables and $s$ is a strictly positive scalar representing an entropy-related variable. All quantities are dimensionless. Define the energy and entropy by\n$$\nE(q,p,s) = \\frac{p^2}{2 m} + \\frac{k}{2} q^2, \\quad S(q,p,s) = c \\ln(s),\n$$\nwith parameters $m0$, $k0$, $c0$. Define the Poisson operator\n$$\nL = \\begin{pmatrix} 0  1  0 \\\\ -1  0  0 \\\\ 0  0  0 \\end{pmatrix},\n$$\nand the dissipative operator\n$$\nM(z) = \\operatorname{diag}(0, 0, \\alpha s),\n$$\nwith $\\alpha \\ge 0$. These choices satisfy the GENERIC structural properties, including antisymmetry of $L$, symmetry and positive semidefiniteness of $M$, and the degeneracy conditions $L \\nabla S = 0$ and $M \\nabla E = 0$.\n\nYour task is to construct a split-step integrator that alternates the exact Hamiltonian subflow generated by $L \\nabla E$ and the exact gradient subflow generated by $M \\nabla S$, with a fixed time step $\\Delta t$ for a total time $T$. Angles must be treated in radians. The Hamiltonian subflow should evolve $(q,p)$ using the exact flow of the quadratic Hamiltonian $E(q,p)$, and leave $s$ unchanged. The gradient subflow should evolve $s$ using the exact flow induced by $M \\nabla S$, and leave $(q,p)$ unchanged. Start from initial conditions $(q_0,p_0,s_0)$ with $s_00$, and perform $N = T/\\Delta t$ successive split steps, assuming $T$ is an integer multiple of $\\Delta t$.\n\nAfter integration, compute the change in energy\n$$\n\\Delta E = E(q(T),p(T),s(T)) - E(q_0,p_0,s_0),\n$$\nand the change in entropy\n$$\n\\Delta S = S(q(T),p(T),s(T)) - S(q_0,p_0,s_0).\n$$\nThe program should return these two quantities for each test case.\n\nTest suite:\n- Case 1 (general case): $m=1$, $k=1$, $c=2$, $\\alpha=0.5$, $q_0=0.3$, $p_0=0.7$, $s_0=1.0$, $\\Delta t=0.05$, $T=1.0$.\n- Case 2 (edge case: very small initial $s_0$): $m=2$, $k=0.5$, $c=1.0$, $\\alpha=0.1$, $q_0=1.2$, $p_0=-0.4$, $s_0=10^{-8}$, $\\Delta t=0.02$, $T=0.5$.\n- Case 3 (boundary case: no dissipation): $m=1$, $k=3$, $c=1.0$, $\\alpha=0.0$, $q_0=-0.1$, $p_0=0.2$, $s_0=10.0$, $\\Delta t=0.1$, $T=1.0$.\n- Case 4 (large time step, long evolution): $m=1$, $k=4$, $c=1.5$, $\\alpha=2.0$, $q_0=2.0$, $p_0=0.0$, $s_0=0.5$, $\\Delta t=0.5$, $T=5.0$.\n\nDesign for coverage:\n- Case 1 tests typical behavior with nonzero dissipation and generic initial conditions.\n- Case 2 tests robustness when the entropy variable starts very close to zero but positive.\n- Case 3 tests the limiting case where irreversible effects vanish.\n- Case 4 tests behavior under large time steps and long integration time.\n\nAnswer specification:\n- For each case, output the pair $[\\Delta E, \\Delta S]$ as floats.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list of these pairs enclosed in square brackets, for example, \"[[dE1,dS1],[dE2,dS2],[dE3,dS3],[dE4,dS4]]\".",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the established GENERIC formalism for non-equilibrium thermodynamics, is well-posed with all necessary information provided, and is stated objectively using precise mathematical language. The model is a standard, albeit simplified, representation of a mechanical system coupled to a thermal-like variable, and the specified operators and evolution equations are consistent with the framework's principles. We may therefore proceed with a solution.\n\nThe objective is to implement a split-step time integrator for the given GENERIC system. The evolution of the state vector $z = (q, p, s)$ is governed by the equation:\n$$\n\\frac{dz}{dt} = L(z) \\nabla E(z) + M(z) \\nabla S(z)\n$$\nThe problem specifies a splitting scheme where the full evolution over a time step $\\Delta t$ is approximated by composing the exact flows of the two constituent parts of the dynamics: the reversible (Hamiltonian) part and the irreversible (dissipative) part.\n\nFirst, let us define the gradients of the energy $E(q,p,s) = \\frac{p^2}{2 m} + \\frac{k}{2} q^2$ and entropy $S(q,p,s) = c \\ln(s)$:\n$$\n\\nabla E(z) = \\begin{pmatrix} \\partial E / \\partial q \\\\ \\partial E / \\partial p \\\\ \\partial E / \\partial s \\end{pmatrix} = \\begin{pmatrix} k q \\\\ p/m \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\nabla S(z) = \\begin{pmatrix} \\partial S / \\partial q \\\\ \\partial S / \\partial p \\\\ \\partial S / \\partial s \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ c/s \\end{pmatrix}\n$$\n\nThe split-step method involves solving two sub-problems for a duration of $\\Delta t$.\n\n**1. Reversible (Hamiltonian) Sub-problem**\n\nThe first sub-problem corresponds to the reversible dynamics governed by the Poisson operator $L$:\n$$\n\\frac{dz}{dt} = L(z) \\nabla E(z)\n$$\nSubstituting the given forms for $L$ and $\\nabla E(z)$:\n$$\n\\begin{pmatrix} \\dot{q} \\\\ \\dot{p} \\\\ \\dot{s} \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ -1  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} k q \\\\ p/m \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} p/m \\\\ -kq \\\\ 0 \\end{pmatrix}\n$$\nThis system of equations describes a simple harmonic oscillator for the canonical variables $(q,p)$ and a static entropy variable $s$:\n$$\n\\dot{q} = \\frac{p}{m}, \\quad \\dot{p} = -kq, \\quad \\dot{s} = 0\n$$\nThe angular frequency is $\\omega = \\sqrt{k/m}$. The exact solution for $(q,p)$ over a time interval $\\Delta t$, starting from $(q_n, p_n)$, is a rotation in phase space:\n$$\nq_{n+1} = q_n \\cos(\\omega \\Delta t) + \\frac{p_n}{m \\omega} \\sin(\\omega \\Delta t)\n$$\n$$\np_{n+1} = -m \\omega q_n \\sin(\\omega \\Delta t) + p_n \\cos(\\omega \\Delta t)\n$$\nThe entropy variable remains unchanged: $s_{n+1} = s_n$. This flow exactly conserves both the energy $E$ and the entropy $S$.\n\n**2. Irreversible (Dissipative) Sub-problem**\n\nThe second sub-problem corresponds to the irreversible dynamics governed by the dissipative operator $M(z)$:\n$$\n\\frac{dz}{dt} = M(z) \\nabla S(z)\n$$\nSubstituting the given forms for $M(z)$ and $\\nabla S(z)$:\n$$\n\\begin{pmatrix} \\dot{q} \\\\ \\dot{p} \\\\ \\dot{s} \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  \\alpha s \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ c/s \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\alpha c \\end{pmatrix}\n$$\nThis yields a trivial system of equations:\n$$\n\\dot{q} = 0, \\quad \\dot{p} = 0, \\quad \\dot{s} = \\alpha c\n$$\nThe exact solution over a time interval $\\Delta t$, starting from $(q_n, p_n, s_n)$, is:\n$$\nq_{n+1} = q_n\n$$\n$$\np_{n+1} = p_n\n$$\n$$\ns_{n+1} = s_n + \\alpha c \\Delta t\n$$\nThis flow exactly conserves the energy $E$ (as it does not depend on $s$), but it increases the entropy $S$ for $\\alpha  0$. Since $s_0  0$, $c  0$, $\\alpha \\ge 0$, and $\\Delta t  0$, the value of $s$ is non-decreasing and will always remain positive.\n\n**Split-Step Integrator Algorithm**\n\nThe integrator will perform $N = T/\\Delta t$ steps. In each step, we first apply the reversible update and then the irreversible update. Let $z_n=(q_n, p_n, s_n)$ be the state at time $t_n$.\n\n1.  Initialize state $z(0) = (q_0, p_0, s_0)$.\n2.  Calculate the number of steps $N = T/\\Delta t$.\n3.  For $n$ from $0$ to $N-1$:\n    a.  First, update $(q,p)$ according to the reversible flow over $\\Delta t$, keeping $s$ constant.\n    b.  Second, update $s$ according to the irreversible flow over $\\Delta t$, keeping the newly computed $(q,p)$ constant.\n4.  After $N$ steps, we obtain the final state $z(T) = (q(T), p(T), s(T))$.\n5.  Compute the total change in energy $\\Delta E = E(z(T)) - E(z(0))$ and entropy $\\Delta S = S(z(T)) - S(z(0))$.\n\nA key feature of this specific problem is the complete decoupling of the variables. The energy $E$ depends only on $(q,p)$, while the entropy $S$ depends only on $s$. The reversible operator $L$ acts only on $(q,p)$, and the irreversible operator $M$ acts only on $s$. Furthermore, the irreversible evolution of $s$ is independent of the state $(q,p,s)$, and the reversible evolution of $(q,p)$ is independent of $s$. Consequently, the splitting scheme is not an approximation but gives the exact solution to the full system of ODEs. As a result, the energy $E$ must be conserved exactly by the algorithm, meaning $\\Delta E$ should be zero, limited only by floating-point precision. The total change in entropy after $N$ steps can be calculated as $s(T) = s_0 + N(\\alpha c \\Delta t) = s_0 + \\alpha c T$, which leads to $\\Delta S = c \\ln(s(T)) - c \\ln(s_0) = c \\ln(1 + \\frac{\\alpha c T}{s_0})$. These analytical results serve as a robust verification for the numerical implementation.\n\nThe implementation will loop through the specified steps and calculate the final state changes.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a split-step integrator for a GENERIC-inspired model and\n    calculates the change in energy and entropy for several test cases.\n    \"\"\"\n    # Test cases from the problem description.\n    # Format: (m, k, c, alpha, q0, p0, s0, dt, T)\n    test_cases = [\n        # Case 1 (general case)\n        (1.0, 1.0, 2.0, 0.5, 0.3, 0.7, 1.0, 0.05, 1.0),\n        # Case 2 (edge case: very small initial s0)\n        (2.0, 0.5, 1.0, 0.1, 1.2, -0.4, 1e-8, 0.02, 0.5),\n        # Case 3 (boundary case: no dissipation)\n        (1.0, 3.0, 1.0, 0.0, -0.1, 0.2, 10.0, 0.1, 1.0),\n        # Case 4 (large time step, long evolution)\n        (1.0, 4.0, 1.5, 2.0, 2.0, 0.0, 0.5, 0.5, 5.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        m, k, c, alpha, q0, p0, s0, dt, T = case\n\n        # Initialize state variables\n        q, p, s = q0, p0, s0\n\n        # Calculate constants for the simulation\n        omega = np.sqrt(k / m)\n        # Use round to ensure integer number of steps, as guaranteed by the problem\n        num_steps = int(round(T / dt))\n\n        # Define energy and entropy functions\n        def energy(qt, pt):\n            return pt**2 / (2 * m) + k / 2 * qt**2\n\n        def entropy(st):\n            # s is guaranteed to be positive throughout the simulation\n            return c * np.log(st)\n\n        # Store initial energy and entropy\n        E_initial = energy(q0, p0)\n        S_initial = entropy(s0)\n\n        # Main integration loop\n        for _ in range(num_steps):\n            # --- Hamiltonian (reversible) step for (q, p) ---\n            q_current, p_current = q, p\n            \n            cos_wdt = np.cos(omega * dt)\n            sin_wdt = np.sin(omega * dt)\n            \n            # The case omega=0 is ruled out by k>0, m>0.\n            q = q_current * cos_wdt + (p_current / (m * omega)) * sin_wdt\n            p = -m * omega * q_current * sin_wdt + p_current * cos_wdt\n            \n            # --- Dissipative (irreversible) step for s ---\n            s = s + alpha * c * dt\n\n        # Calculate final energy and entropy\n        E_final = energy(q, p)\n        S_final = entropy(s)\n\n        # Calculate changes\n        delta_E = E_final - E_initial\n        delta_S = S_final - S_initial\n\n        results.append([delta_E, delta_S])\n\n    # Final print statement in the exact required format.\n    # The str() of a list automatically includes the brackets, e.g., '[1.0, 2.0]'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}