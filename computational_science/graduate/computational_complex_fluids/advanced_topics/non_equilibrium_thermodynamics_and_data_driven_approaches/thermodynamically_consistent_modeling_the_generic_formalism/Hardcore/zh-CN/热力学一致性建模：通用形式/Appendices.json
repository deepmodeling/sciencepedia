{
    "hands_on_practices": [
        {
            "introduction": "此练习旨在建立热力学与动力学之间的基础联系。您将通过最小化系统的亥姆霍兹自由能（统计力学的基石）来确定其平衡态。随后，您将验证此平衡态确实是 GENERIC 框架下的一个静态解，从而展示该形式主义的结构如何内在地尊重热力学原理 。",
            "id": "4109694",
            "problem": "考虑一个标量序参量场 $\\psi(\\mathbf{x})$，它代表了周期性区域 $\\Omega \\subset \\mathbb{R}^{d}$ 上具有足够光滑场的二元复杂流体的粗粒化组分涨落。在固定的绝对温度 $T0$下进行研究。设能量泛函 $E[\\psi]$ 和熵泛函 $S[\\psi]$ 由下式给出\n$$\nE[\\psi] \\equiv \\int_{\\Omega} \\left( \\frac{a}{2}\\,\\psi^{2} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} \\right)\\, \\mathrm{d}\\mathbf{x}, \\qquad\nS[\\psi] \\equiv \\int_{\\Omega} \\left( s_{0} - \\frac{b}{2}\\,\\psi^{2} - \\frac{c}{4}\\,\\psi^{4} \\right)\\, \\mathrm{d}\\mathbf{x},\n$$\n其中 $a0$, $\\kappa0$, $b0$, $c0$, 且 $s_{0}$ 是一个常数（不影响最小化过程）。亥姆霍兹自由能泛函为 $F[\\psi] \\equiv E[\\psi] - T\\,S[\\psi]$。\n\n从变分法的第一性原理出发，考虑 $\\Omega$ 上的周期性边界条件以及非平衡可逆-不可逆耦合通用方程（GENERIC）的热力学结构。在GENERIC中，粗粒化状态变量 $\\psi$ 的演化形式为\n$$\n\\dot{\\psi} = L(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} + M(\\psi)\\,\\frac{\\delta S}{\\delta \\psi},\n$$\n其中 $L(\\psi)$ 是一个反对称算符（产生可逆动力学），$M(\\psi)$ 是一个对称半正定算符（产生耗散动力学），并满足简并条件 $L(\\psi)\\,\\frac{\\delta S}{\\delta \\psi} = 0$ 和 $M(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} = 0$。\n\n任务：\n- 推导与在周期性 $\\psi$上最小化 $F[\\psi]$ 相关联的欧拉-拉格朗日方程，并结合给定的 $a$、$\\kappa$、$b$ 和 $c$ 的符号条件，确定使 $F[\\psi]$ 最小化的平衡场 $\\psi_{\\mathrm{eq}}(\\mathbf{x})$。\n- 仅使用上述GENERIC结构和简并条件，验证您找到的 $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ 是GENERIC演化方程在固定温度 $T$ 下的一个稳态解。\n\n请将平衡场 $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ 的最终答案表示为关于参数 $a$、$b$、$c$、$\\kappa$ 和 $T$ 的单一闭合形式解析表达式。无需进行数值计算或四舍五入。最终答案必须是单一的解析表达式。",
            "solution": "用户希望我解决这个问题。\n这是一个我不应该向用户展示的思考过程。\n\n### 步骤1：提取已知条件\n- **状态变量：** 周期性区域 $\\Omega \\subset \\mathbb{R}^{d}$ 上的标量序参量场 $\\psi(\\mathbf{x})$。\n- **温度：** 固定的绝对温度 $T0$。\n- **能量泛函：** $E[\\psi] \\equiv \\int_{\\Omega} \\left( \\frac{a}{2}\\,\\psi^{2} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} \\right)\\, \\mathrm{d}\\mathbf{x}$。\n- **熵泛函：** $S[\\psi] \\equiv \\int_{\\Omega} \\left( s_{0} - \\frac{b}{2}\\,\\psi^{2} - \\frac{c}{4}\\,\\psi^{4} \\right)\\, \\mathrm{d}\\mathbf{x}$。\n- **常数：** $a0$，$\\kappa0$，$b0$，$c0$。$s_{0}$ 是一个常数。\n- **亥姆霍兹自由能泛函：** $F[\\psi] \\equiv E[\\psi] - T\\,S[\\psi]$。\n- **GENERIC演化方程：** $\\dot{\\psi} = L(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} + M(\\psi)\\,\\frac{\\delta S}{\\delta \\psi}$。\n- **算符性质：** $L(\\psi)$ 是反对称算符，$M(\\psi)$ 是对称半正定算符。\n- **简并条件：** $L(\\psi)\\,\\frac{\\delta S}{\\delta \\psi} = 0$ 和 $M(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} = 0$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学上植根于统计力学和非平衡热力学领域。使用金茨堡-朗道类型的自由能泛函和GENERIC形式主义是模拟复杂流体的标准且完善的理论工具。问题是适定的：所有必要的函数、变量和参数都已明确定义，且对参数的约束（$a0$, $\\kappa0$, $b0$, $c0$, $T0$）清晰且一致。没有矛盾或信息缺失。问题是客观且可形式化的。任务陈述清晰，通过应用变分法和GENERIC框架的原理，可以得到一个唯一且有意义的解。虽然对参数的特定符号约束导致的结果比一个表现出相变的系统（即双阱势）要简单，但这并不使问题无效。它只是指定了一个必须应用这些原理的特定物理区域（一个全局稳定的单相态）。该问题是对基本理解的有效检验。\n\n### 步骤3：结论与行动\n问题是有效的。我将继续进行解答。\n\n### 解答推导\n\n根据问题陈述的要求，分析包括两个部分。首先，我们通过最小化亥姆霍兹自由能泛函 $F[\\psi]$ 来确定平衡场 $\\psi_{\\mathrm{eq}}(\\mathbf{x})$。其次，我们验证这个平衡场是给定的GENERIC演化方程的一个稳态解。\n\n**第1部分：亥姆霍兹自由能的最小化**\n\n亥姆霍兹自由能泛函 $F[\\psi]$ 定义为 $F[\\psi] \\equiv E[\\psi] - T\\,S[\\psi]$。代入给定的能量 $E[\\psi]$ 和熵 $S[\\psi]$ 的表达式：\n$$\nF[\\psi] = \\int_{\\Omega} \\left( \\frac{a}{2}\\,\\psi^{2} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} \\right)\\, \\mathrm{d}\\mathbf{x} - T \\int_{\\Omega} \\left( s_{0} - \\frac{b}{2}\\,\\psi^{2} - \\frac{c}{4}\\,\\psi^{4} \\right)\\, \\mathrm{d}\\mathbf{x}\n$$\n合并积分，我们得到：\n$$\nF[\\psi] = \\int_{\\Omega} \\left( \\frac{a}{2}\\,\\psi^{2} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} - T s_{0} + \\frac{Tb}{2}\\,\\psi^{2} + \\frac{Tc}{4}\\,\\psi^{4} \\right)\\, \\mathrm{d}\\mathbf{x}\n$$\n我们可以将各项组合起来，将被积函数确定为自由能密度 $\\mathcal{F}(\\psi, \\nabla\\psi)$：\n$$\n\\mathcal{F}(\\psi, \\nabla\\psi) = \\left(\\frac{a + Tb}{2}\\right)\\psi^{2} + \\frac{Tc}{4}\\,\\psi^{4} + \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} - T s_{0}\n$$\n使泛函 $F[\\psi]$ 最小化的状态 $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ 必须满足相关的欧拉-拉格朗日方程，即 $\\frac{\\delta F}{\\delta \\psi} = 0$。变分导数为：\n$$\n\\frac{\\delta F}{\\delta \\psi} = \\frac{\\partial \\mathcal{F}}{\\partial \\psi} - \\nabla \\cdot \\left( \\frac{\\partial \\mathcal{F}}{\\partial (\\nabla \\psi)} \\right)\n$$\n计算 $\\mathcal{F}$ 的偏导数：\n$$\n\\frac{\\partial \\mathcal{F}}{\\partial \\psi} = (a + Tb)\\psi + Tc\\psi^{3}\n$$\n$$\n\\frac{\\partial \\mathcal{F}}{\\partial (\\nabla \\psi)} = \\kappa \\nabla \\psi\n$$\n因此，欧拉-拉格朗日方程为：\n$$\n(a + Tb)\\psi + Tc\\psi^{3} - \\kappa \\nabla^2 \\psi = 0\n$$\n为了找到 $F[\\psi]$ 的全局最小值，让我们检查泛函的结构。它由三个主要部分组成：一个依赖于 $\\psi$ 的势能项，一个依赖于 $|\\nabla \\psi|^2$ 的梯度项，以及一个常数项。\n梯度项为 $\\int_{\\Omega} \\frac{\\kappa}{2}\\,|\\nabla \\psi|^{2} \\, \\mathrm{d}\\mathbf{x}$。由于 $\\kappa  0$ 且 $|\\nabla \\psi|^2 \\ge 0$，该项总是非负的。当 $\\psi$ 是一个空间均匀场时，即对于某个常数 $\\psi_0$，有 $\\psi(\\mathbf{x}) = \\psi_{0}$，该项达到其最小值0。\n\n对于这样一个均匀场，自由能泛函简化为 $F[\\psi_0] = \\mathrm{Vol}(\\Omega) \\times V(\\psi_0)$，其中 $V(\\psi_0)$ 是势能密度：\n$$\nV(\\psi_{0}) = \\left(\\frac{a + Tb}{2}\\right)\\psi_{0}^{2} + \\frac{Tc}{4}\\,\\psi_{0}^{4} - T s_{0}\n$$\n要找到 $F$ 的最小值，我们需要找到使 $V(\\psi_0)$ 最小的 $\\psi_0$ 值。通过将 $V$ 对 $\\psi_0$ 的导数设为零来找到临界点：\n$$\n\\frac{\\mathrm{d}V}{\\mathrm{d}\\psi_{0}} = (a + Tb)\\psi_{0} + Tc\\psi_{0}^{3} = \\psi_{0} \\left( (a + Tb) + Tc\\psi_{0}^{2} \\right) = 0\n$$\n该方程的解为 $\\psi_{0}=0$ 或 $(a + Tb) + Tc\\psi_{0}^{2} = 0$。\n第二种情况给出 $\\psi_{0}^{2} = -\\frac{a+Tb}{Tc}$。根据问题陈述，$a0$，$b0$，$c0$ 且 $T0$。因此，$(a+Tb)  0$ 且 $Tc  0$。这意味着 $-\\frac{a+Tb}{Tc}$ 是严格负数。在这种条件下，$\\psi_0$ 没有实数解。\n唯一的实数临界点是 $\\psi_{0} = 0$。\n\n为了确认这是一个最小值，我们检查势的二阶导数：\n$$\n\\frac{\\mathrm{d}^2V}{\\mathrm{d}\\psi_{0}^2} = (a + Tb) + 3Tc\\psi_{0}^{2}\n$$\n在临界点 $\\psi_{0}=0$ 处求值：\n$$\n\\left. \\frac{\\mathrm{d}^2V}{\\mathrm{d}\\psi_{0}^2} \\right|_{\\psi_{0}=0} = a + Tb\n$$\n因为 $a0$，$T0$ 且 $b0$，所以我们有 $a+Tb  0$。这个正的二阶导数证实了 $\\psi_{0}=0$ 是势 $V$ 的一个局部最小值。\n因为势 $V(\\psi_0)$ 中的二次项系数（$\\frac{a+Tb}{2}  0$）和四次项系数（$\\frac{Tc}{4}  0$）都为正，所以该势是一个全局凸函数，在 $\\psi_0=0$ 处有唯一的全局最小值。\n因此，空间均匀场 $\\psi_{\\mathrm{eq}}(\\mathbf{x}) = 0$ 同时最小化了自由能泛函的势能部分和梯度部分，因此是 $F[\\psi]$ 的全局最小化子。\n\n**第2部分：验证其作为GENERIC中的稳态解**\n\n我们需要验证 $\\psi_{\\mathrm{eq}}(\\mathbf{x}) = 0$ 是GENERIC演化方程的一个稳态解，即当 $\\psi=\\psi_{\\mathrm{eq}}$ 时 $\\dot{\\psi}=0$。演化方程为：\n$$\n\\dot{\\psi} = L(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} + M(\\psi)\\,\\frac{\\delta S}{\\delta \\psi}\n$$\n热力学平衡态 $\\psi_{\\mathrm{eq}}$ 定义为最小化亥姆霍兹自由能 $F[\\psi] = E[\\psi] - T S[\\psi]$ 的状态。如前所示，这意味着 $F$ 的变分导数消失：\n$$\n\\frac{\\delta F}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} = \\frac{\\delta E}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} - T \\frac{\\delta S}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} = 0\n$$\n这给出了平衡时的基本关系：\n$$\n\\frac{\\delta E}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} = T \\frac{\\delta S}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}}\n$$\n现在，让我们在 $\\psi=\\psi_{\\mathrm{eq}}$ 处评估GENERIC方程的右侧。将平衡关系代入带有算符 $L$ 的项中：\n$$\nL(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta E}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} = L(\\psi_{\\mathrm{eq}})\\,\\left(T \\frac{\\delta S}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}}\\right) = T \\left(L(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}}\\right)\n$$\n使用第一个简并条件 $L(\\psi)\\,\\frac{\\delta S}{\\delta \\psi} = 0$，上述表达式变为零。因此，动力学的可逆部分在平衡时消失。\n\n接下来，我们评估动力学的不可逆部分 $M(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi}|_{\\psi_{\\mathrm{eq}}}$。我们使用第二个简并条件 $M(\\psi)\\,\\frac{\\delta E}{\\delta \\psi} = 0$。在平衡时，这变为：\n$$\nM(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta E}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}} = 0\n$$\n将平衡关系代入此条件：\n$$\nM(\\psi_{\\mathrm{eq}})\\,\\left(T \\frac{\\delta S}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}}\\right) = T \\left(M(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi}\\bigg|_{\\psi=\\psi_{\\mathrm{eq}}}\\right) = 0\n$$\n由于 $T0$，我们必须有 $M(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi}|_{\\psi_{\\mathrm{eq}}} = 0$。这表明动力学的不可逆部分在平衡时也消失。\n\n综合这些结果，平衡态 $\\psi_{\\mathrm{eq}}$ 的时间演化为：\n$$\n\\dot{\\psi}|_{\\psi=\\psi_{\\mathrm{eq}}} = L(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta E}{\\delta \\psi}\\bigg|_{\\psi_{\\mathrm{eq}}} + M(\\psi_{\\mathrm{eq}})\\,\\frac{\\delta S}{\\delta \\psi}\\bigg|_{\\psi_{\\mathrm{eq}}} = 0 + 0 = 0\n$$\n这证实了任何热力学平衡态 $\\psi_{\\mathrm{eq}}$ 都是GENERIC方程的一个稳态解。由于我们从第1部分发现唯一的平衡最小化子是 $\\psi_{\\mathrm{eq}}(\\mathbf{x}) = 0$，我们已经验证了它是一个稳态解。\n\n最终答案是平衡场 $\\psi_{\\mathrm{eq}}(\\mathbf{x})$ 的闭合形式表达式。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在平衡态概念的基础上，此练习将探索系统在受到轻微扰动时的行为。您将计算连接平衡点附近热力学驱动力与通量的线性响应矩阵。这项练习将揭示昂萨格（Onsager）倒易关系如何直接源于 GENERIC 耗散算符 $M$ 的对称性，这是非平衡热力学中的一个关键洞见 。",
            "id": "4109648",
            "problem": "考虑在非平衡可逆-不可逆耦合通用方程 (GENERIC) 形式体系内，对一种复杂流体进行空间均匀、等温的粗粒化描述。慢变量被收集在双分量状态 $x = (x_1, x_2)$ 中，并且假设其动力学是纯耗散的，因为粗粒化能量与 $x$ 无关，所以可逆部分消失，简并条件被平凡满足。GENERIC 耗散演化方程为\n$$\n\\dot{x} = M(x)\\,\\nabla S(x),\n$$\n其中 $S(x)$ 是熵，$M(x)$ 是对称半正定的摩擦矩阵，它保证了第二定律的成立。假设熵在平衡点 $x_{\\mathrm{eq}} = (0,0)$ 处有严格最大值，并且在平衡点附近，它表示为局部二次形式\n$$\nS(x) = S_{\\mathrm{eq}} - \\frac{1}{2}\\left(\\frac{x_1^2}{\\theta_1} + \\frac{x_2^2}{\\theta_2}\\right),\n$$\n其中 $\\theta_1  0$ 且 $\\theta_2  0$，因此\n$$\n\\nabla S(x) = \\left(-\\frac{x_1}{\\theta_1},\\,-\\frac{x_2}{\\theta_2}\\right).\n$$\n假设摩擦矩阵具有以下形式\n$$\nM(x) =\n\\begin{pmatrix}\n\\alpha + a\\,x_2^2  b + c\\,x_1 x_2 \\\\\nb + c\\,x_1 x_2  \\delta + d\\,x_1^2\n\\end{pmatrix},\n$$\n其中常数 $\\alpha  0$, $\\delta  0$, $a \\ge 0$, $d \\ge 0$, 以及 $b, c \\in \\mathbb{R}$ 的选择使得 $M(x)$ 在 $x_{\\mathrm{eq}}$ 的一个邻域内是对称半正定的（例如，在 $x_{\\mathrm{eq}}$ 处 $\\alpha \\delta - b^2  0$）。定义广义热力学力为 $X(x) \\equiv \\nabla S(x)$，耗散流为 $J(x) \\equiv \\dot{x}_{\\mathrm{diss}}(x)$，因此 $J(x) = M(x) X(x)$。\n\n计算线性响应矩阵 $\\mathcal{L}$，该矩阵将平衡点附近小扰动下的 $J$ 与 $X$ 通过 $J = \\mathcal{L} X$ 联系起来，即在 $x_{\\mathrm{eq}}$ 处计算 $\\mathcal{L}$。然后，通过显式计算，验证线性响应的互易关系（昂萨格对称性），即 $\\mathcal{L}$ 的非对角元素相等。以单一矩阵的符号形式表示你的最终答案。不需要数值近似，也不需要单位。",
            "solution": "在等温、纯耗散的设定下，GENERIC 耗散动力学由下式给出\n$$\n\\dot{x} = M(x)\\,\\nabla S(x).\n$$\n在平衡点 $x_{\\mathrm{eq}} = (0,0)$ 的熵最大值附近，熵具有二次形式\n$$\nS(x) = S_{\\mathrm{eq}} - \\frac{1}{2}\\left(\\frac{x_1^2}{\\theta_1} + \\frac{x_2^2}{\\theta_2}\\right),\n$$\n因此其梯度（广义热力学力）为\n$$\nX(x) \\equiv \\nabla S(x) = \\left(-\\frac{x_1}{\\theta_1},\\, -\\frac{x_2}{\\theta_2}\\right).\n$$\n耗散流定义为\n$$\nJ(x) \\equiv \\dot{x}_{\\mathrm{diss}}(x) = M(x)\\,X(x).\n$$\n线性响应矩阵 $\\mathcal{L}$ 是在平衡点处将小扰动力映射到流的雅可比矩阵。因为 $J$ 和 $X$ 之间的关系在 $X$ 上是线性的，系数为 $M(x)$，所以线性响应矩阵就是 $M(x)$ 在平衡点处的值：\n$$\n\\mathcal{L} = M(x_{\\mathrm{eq}}).\n$$\n因此，我们通过将 $x_1 = 0$ 和 $x_2 = 0$ 代入 $M(x)$ 来计算 $M(x_{\\mathrm{eq}})$：\n$$\nM(0,0) =\n\\begin{pmatrix}\n\\alpha + a\\,(0)^2  b + c\\,(0)(0) \\\\\nb + c\\,(0)(0)  \\delta + d\\,(0)^2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\alpha  b \\\\\nb  \\delta\n\\end{pmatrix}.\n$$\n因此，线性响应为\n$$\nJ = \\mathcal{L}\\,X, \\quad \\text{其中} \\quad \\mathcal{L} =\n\\begin{pmatrix}\n\\alpha  b \\\\\nb  \\delta\n\\end{pmatrix}.\n$$\n为了验证互易性，即昂萨格对称性，我们显式计算非对角元素。$\\mathcal{L}$ 的 $(1,2)$ 元素是\n$$\n\\mathcal{L}_{12} = b,\n$$\n而 $(2,1)$ 元素是\n$$\n\\mathcal{L}_{21} = b.\n$$\n因此，\n$$\n\\mathcal{L}_{12} - \\mathcal{L}_{21} = b - b = 0,\n$$\n这表明线性响应矩阵是对称的，正如在没有微观时间反演对称性破缺的情况下互易性所要求的那样。由于 GENERIC 形式体系中 $M(x)$ 的构造强制要求对称性和半正定性，因此在平衡点附近的显式计算得出了一个对称的 $\\mathcal{L}$，这与互易关系一致。\n\n因此，线性响应矩阵为\n$$\n\\mathcal{L} =\n\\begin{pmatrix}\n\\alpha  b \\\\\nb  \\delta\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\alpha  b \\\\ b  \\delta\\end{pmatrix}}$$"
        },
        {
            "introduction": "为了在模拟中应用 GENERIC 形式主义，我们必须将其连续的数学结构转化为离散的、可计算的形式。本练习将指导您设计空间导数算符，以保持 GENERIC 框架的关键特性：可逆算符的反对称性以及不可逆算符的对称正半定性。成功完成此练习是构建结构保持的数值模型的关键第一步 。",
            "id": "4109668",
            "problem": "您的任务是为一维周期性复杂流体模型在非平衡可逆-不可逆耦合通用方程 (GENERIC) 形式体系内设计并实现一种空间离散化方法。GENERIC 结构通过以下方程演化状态向量 $\\mathbf{z}$：\n$$\n\\dot{\\mathbf{z}} \\;=\\; \\mathbf{L}(\\mathbf{z}) \\,\\nabla_{\\mathbf{z}} E(\\mathbf{z}) \\;+\\; \\mathbf{M}(\\mathbf{z}) \\,\\nabla_{\\mathbf{z}} S(\\mathbf{z}),\n$$\n其中 $\\mathbf{L}$ 是反对称的，$\\mathbf{M}$ 是对称半正定的，并且满足退化条件 $\\mathbf{L}\\,\\nabla_{\\mathbf{z}} S \\,=\\, \\mathbf{0}$ 和 $\\mathbf{M}\\,\\nabla_{\\mathbf{z}} E \\,=\\, \\mathbf{0}$。在此任务中，考虑在长度为 $L_{\\text{dom}}$ 的周期性域上的单个标量场 $\\phi(x,t)$，其输运参数为常数：平流速度 $u$ 和迁移率 $\\kappa \\ge 0$。您的目标是在一个包含 $N$ 个点的均匀网格上构建离散算子 $\\mathbf{L}_h$ 和 $\\mathbf{M}_h$，这些算子体现了与 GENERIC 一致的可逆和不可逆耦合，具体通过强制执行以下属性实现：\n\n- 反对称性：$\\mathbf{L}_h^\\top \\,=\\, -\\,\\mathbf{L}_h$。\n- 对称性与半正定性：$\\mathbf{M}_h^\\top \\,=\\, \\mathbf{M}_h$ 且对于所有向量 $\\mathbf{v}$，$\\mathbf{v}^\\top \\mathbf{M}_h \\mathbf{v} \\,\\ge\\, 0$。\n\n从以下基本基础和约束开始：\n- 使用均匀网格上间距为 $h \\,=\\, L_{\\text{dom}}/N$ 的周期性分部积分恒等式的离散模拟（离散分部求和），以指导构建一致的一阶和二阶导数算子。\n- 可逆（类哈密顿）平流部分必须由一个离散一阶导数算子表示，该算子在标准欧几里得内积下是反自伴的，因此其关联矩阵是反对称的。\n- 不可逆（耗散）扩散部分必须由一个离散二阶导数算子表示，该算子是自伴且负半定的；乘以一个非负迁移率将产生一个对称半正定度规算子。\n\n用纯数学术语设计离散化方案：\n- 选择一个具有 $N$ 个点且间距为 $h$ 的周期性均匀网格，并构建：\n  - 一个矩阵 $\\mathbf{D}_1$，它近似空间中的一阶导数并满足 $\\mathbf{D}_1^\\top \\,=\\, -\\,\\mathbf{D}_1$。\n  - 一个矩阵 $\\mathbf{D}_2$，它近似空间中的二阶导数，满足 $\\mathbf{D}_2^\\top \\,=\\, \\mathbf{D}_2$ 并且具有非正特征值。\n- 通过将一阶导数算子与平流速度 $u$ 相乘来定义 $\\mathbf{L}_h$，通过将二阶导数算子的负值与迁移率 $\\kappa$ 相乘来定义 $\\mathbf{M}_h$：\n  $$\n  \\mathbf{L}_h \\,=\\, u\\,\\mathbf{D}_1,\\qquad \\mathbf{M}_h \\,=\\, \\kappa\\,\\left(-\\mathbf{D}_2\\right).\n  $$\n- 对每个测试用例进行数值验证，确保：\n  $$\n  \\|\\mathbf{L}_h + \\mathbf{L}_h^\\top\\|_F \\,\\le\\, \\varepsilon \\,\\max\\{1,\\|\\mathbf{L}_h\\|_F\\},\\qquad\n  \\|\\mathbf{M}_h - \\mathbf{M}_h^\\top\\|_F \\,\\le\\, \\varepsilon \\,\\max\\{1,\\|\\mathbf{M}_h\\|_F\\},\n  $$\n  并且对称化度规 $\\tfrac{1}{2}(\\mathbf{M}_h+\\mathbf{M}_h^\\top)$ 的最小特征值大于或等于 $-\\,\\varepsilon$，其中 $\\varepsilon$ 为容差。\n\n实现要求：\n- 在长度为 $L_{\\text{dom}} \\,=\\, 1$ 的域上使用一个包含 $N$ 个点的一维周期性网格，间距为 $h \\,=\\, 1/N$。\n- 构建 $\\mathbf{D}_1$ 和 $\\mathbf{D}_2$，使其对于任何 $N \\ge 3$ 都满足上述结构性质。构建过程必须与周期性网格上的离散分部求和一致。\n- 根据给定的 $u$ 和 $\\kappa$ 设置反对称 GENERIC 算子 $\\mathbf{L}_h$ 和对称半正定 GENERIC 算子 $\\mathbf{M}_h$。\n- 对于每个测试用例，返回一个布尔值，指示所有三个检查是否通过：$\\mathbf{L}_h$ 的反对称性、$\\mathbf{M}_h$ 的对称性以及 $\\mathbf{M}_h$ 的半正定性。\n\n测试套件：\n- 使用容差 $\\varepsilon \\,=\\, 10^{-12}$。\n- 域长度 $L_{\\text{dom}} \\,=\\, 1$。\n- 测试用例为元组 $(N, u, \\kappa)$：\n  - 用例 A: $(N, u, \\kappa) \\,=\\, (\\,3,\\, 1.7,\\, 0.0\\,)$。\n  - 用例 B: $(N, u, \\kappa) \\,=\\, (\\,4,\\, 0.0,\\, 1.0\\,)$。\n  - 用例 C: $(N, u, \\kappa) \\,=\\, (\\,7,\\, -2.0,\\, 0.5\\,)$。\n  - 用例 D: $(N, u, \\kappa) \\,=\\, (\\,16,\\, 3.3,\\, 10^{-3}\\,)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的列表。列表中的结果按测试用例 A、B、C、D 的顺序排列。每个条目必须是一个布尔值，指示该用例是否满足所有三个必需属性，例如：\"[True,False,True,True]\"。",
            "solution": "该问题陈述是有效的。它提出了一个在复杂流体计算热力学领域内，定义明确且具有科学依据的任务。其目标是为一个由非平衡可逆-不可逆耦合通用方程 (GENERIC) 描述的一维系统设计并实现一种保结构的空间离散化方法。这需要构建离散算子，以保持连续模型的基本几何特性——即可逆算子 $\\mathbf{L}_h$ 的反对称性以及不可逆算子 $\\mathbf{M}_h$ 的对称半正定性。\n\n这些离散算子（表示为 $\\mathbf{L}_h$ 和 $\\mathbf{M}_h$）的设计基于周期性均匀网格上的离散分部求和原理。该原理是分部积分的离散模拟，确保了所得到的数值格式能够遵守连续理论底层的守恒定律和耗散定律。我们考虑在一个由 $N$ 个点 $\\{x_i = i h\\}_{i=0}^{N-1}$ 组成的网格上离散化的标量场 $\\phi(x,t)$，网格间距为均匀的 $h = L_{\\text{dom}}/N$。该场由一个向量 $\\boldsymbol{\\phi} \\in \\mathbb{R}^N$ 表示，其中 $(\\boldsymbol{\\phi})_i = \\phi(x_i)$。\n\n首先，我们构建离散一阶导数算子 $\\mathbf{D}_1$，它构成了可逆部分的基础。连续一阶导数算子 $\\partial_x$ 在周期性域上关于 $L^2$ 内积是反自伴的。因此，其离散对应物 $\\mathbf{D}_1$ 必须是一个反对称矩阵，即 $\\mathbf{D}_1^\\top = -\\mathbf{D}_1$。一个标准的二阶中心差分格式在周期性边界条件下满足此要求。该算子作用于网格点 $i$ 上的离散场 $\\boldsymbol{\\phi}$ 的结果由下式给出：\n$$\n(\\mathbf{D}_1 \\boldsymbol{\\phi})_i = \\frac{\\phi_{i+1 \\pmod N} - \\phi_{i-1 \\pmod N}}{2h}\n$$\n由此产生的 $N \\times N$ 矩阵 $\\mathbf{D}_1$ 是一个循环矩阵，其主对角线为零，次对角线上的值为 $1/(2h)$ 和 $-1/(2h)$，正确地编码了周期性连接。其反对称性从其结构中显而易见。可逆 GENERIC 算子 $\\mathbf{L}_h$ 随之定义为：\n$$\n\\mathbf{L}_h = u\\,\\mathbf{D}_1\n$$\n其中 $u$ 是平流速度。由于 $u$ 是一个标量，$\\mathbf{D}_1$ 的反对称性直接由 $\\mathbf{L}_h$ 继承：\n$$\n\\mathbf{L}_h^\\top = (u\\,\\mathbf{D}_1)^\\top = u\\,\\mathbf{D}_1^\\top = u(-\\mathbf{D}_1) = -\\mathbf{L}_h\n$$\n\n接下来，我们构建离散二阶导数算子 $\\mathbf{D}_2$，它构成了不可逆部分的基础。连续的负拉普拉斯算子 $-\\partial_x^2$ 在周期性域上是一个对称、半正定的算子，这是耗散算子所要求的属性。因此，我们寻求一个离散算子 $\\mathbf{D}_2$，它应是对称且负半定的。二阶导数的标准二阶中心差分近似为：\n$$\n(\\mathbf{D}_2 \\boldsymbol{\\phi})_i = \\frac{\\phi_{i+1 \\pmod N} - 2\\phi_i + \\phi_{i-1 \\pmod N}}{h^2}\n$$\n这定义了矩阵 $\\mathbf{D}_2$ 为周期性离散拉普拉斯算子，它是一个对称的、循环的托普利兹矩阵。为验证其谱特性，我们可以解析地确定其特征值。这个特定循环矩阵的特征值已知为：\n$$\n\\lambda_j(\\mathbf{D}_2) = \\frac{1}{h^2} \\left( e^{i 2\\pi j/N} - 2 + e^{-i 2\\pi j/N} \\right) = \\frac{2}{h^2} \\left( \\cos\\left(\\frac{2\\pi j}{N}\\right) - 1 \\right) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi j}{N}\\right)\n$$\n对于 $j = 0, 1, \\dots, N-1$。由于 $\\sin^2(\\cdot) \\ge 0$，显然所有特征值 $\\lambda_j(\\mathbf{D}_2)$ 都是非正的，这证实了 $\\mathbf{D}_2$ 是一个负半定矩阵。\n\n不可逆 GENERIC 算子 $\\mathbf{M}_h$ 通过将 $\\mathbf{D}_2$ 的负值与非负迁移率 $\\kappa \\ge 0$ 相乘来定义：\n$$\n\\mathbf{M}_h = \\kappa(-\\mathbf{D}_2)\n$$\n$\\mathbf{D}_2$ 的对称性确保了 $\\mathbf{M}_h$ 也是对称的：$\\mathbf{M}_h^\\top = \\kappa(-\\mathbf{D}_2)^\\top = \\kappa(-\\mathbf{D}_2) = \\mathbf{M}_h$。$\\mathbf{M}_h$ 的特征值为 $\\lambda_j(\\mathbf{M}_h) = -\\kappa \\lambda_j(\\mathbf{D}_2) = \\frac{4\\kappa}{h^2} \\sin^2\\left(\\frac{\\pi j}{N}\\right)$。由于 $\\kappa \\ge 0$ 且 $h^2  0$，$\\mathbf{M}_h$ 的所有特征值都是非负的。这证实了 $\\mathbf{M}_h$ 是对称且半正定的。\n\n这种构造通过其解析设计保证了所得到的离散算子 $\\mathbf{L}_h$ 和 $\\mathbf{M}_h$ 满足 GENERIC 形式体系的结构要求。所提供的实现将以数值方式构建这些矩阵，并验证这些属性在指定的浮点容差 $\\varepsilon = 10^{-12}$ 内成立。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef construct_and_verify(N, u, kappa, L_dom, eps):\n    \"\"\"\n    Constructs and verifies the GENERIC operators for a 1D periodic system.\n\n    Args:\n        N (int): Number of grid points.\n        u (float): Advection speed.\n        kappa (float): Mobility.\n        L_dom (float): Length of the periodic domain.\n        eps (float): Tolerance for numerical verification.\n\n    Returns:\n        bool: True if all properties are satisfied, False otherwise.\n    \"\"\"\n    if N  3:\n        # The central difference stencils are not well-defined for N  3.\n        return False\n        \n    # 1. Construct discrete operators D1 and D2\n    h = L_dom / N\n    \n    # Use np.roll for an elegant construction on a periodic grid.\n    # E is the forward shift operator: (E @ f)_i = f_{i+1}\n    E = np.roll(np.identity(N), -1, axis=1)\n    # E_inv is the backward shift operator: (E_inv @ f)_i = f_{i-1}\n    E_inv = np.roll(np.identity(N), 1, axis=1)\n    \n    # Second-order central difference for the first derivative\n    # D1 ~ (f(x+h) - f(x-h)) / 2h\n    D1 = (E - E_inv) / (2.0 * h)\n    \n    # Second-order central difference for the second derivative\n    # D2 ~ (f(x+h) - 2f(x) + f(x-h)) / h^2\n    D2 = (E - 2.0 * np.identity(N) + E_inv) / (h**2)\n    \n    # 2. Define GENERIC operators L_h and M_h\n    L_h = u * D1\n    M_h = kappa * (-D2)\n    \n    # 3. Verify the required properties\n    \n    # Check 1: Antisymmetry of L_h\n    # ||L_h + L_h^T||_F = eps * max(1, ||L_h||_F)\n    norm_L = np.linalg.norm(L_h, 'fro')\n    err_L = np.linalg.norm(L_h + L_h.T, 'fro')\n    check_L = err_L = eps * max(1.0, norm_L)\n    \n    # Check 2: Symmetry of M_h\n    # ||M_h - M_h^T||_F = eps * max(1, ||M_h||_F)\n    norm_M = np.linalg.norm(M_h, 'fro')\n    err_M = np.linalg.norm(M_h - M_h.T, 'fro')\n    check_M_sym = err_M = eps * max(1.0, norm_M)\n    \n    # Check 3: Positive Semidefiniteness of M_h\n    # min_eigenvalue(0.5*(M_h + M_h^T)) >= -eps\n    # The symmetrization step ensures the matrix is Hermitian for the eigenvalue solver,\n    # robustly handling any minor floating-point asymmetries.\n    M_h_symmetrized = 0.5 * (M_h + M_h.T)\n    \n    # Handle the trivial case of a zero matrix separately for robustness.\n    if np.allclose(M_h_symmetrized, 0, atol=eps):\n        min_eig = 0.0\n    else:\n        # Use np.linalg.eigvalsh for real symmetric (Hermitian) matrices.\n        # It is faster and more numerically stable than np.linalg.eigvals.\n        eigenvalues = np.linalg.eigvalsh(M_h_symmetrized)\n        min_eig = np.min(eigenvalues)\n        \n    check_M_psd = min_eig >= -eps\n    \n    return check_L and check_M_sym and check_M_psd\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, u, kappa)\n        (3, 1.7, 0.0),    # Case A\n        (4, 0.0, 1.0),    # Case B\n        (7, -2.0, 0.5),   # Case C\n        (16, 3.3, 1e-3),  # Case D (10^{-3} = 0.001)\n    ]\n    \n    # Parameters defined in the problem\n    L_dom = 1.0\n    eps = 1e-12\n    \n    results = []\n    for case in test_cases:\n        N, u, kappa = case\n        is_valid = construct_and_verify(N, u, kappa, L_dom, eps)\n        results.append(is_valid)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solution\nsolve()\n\n```"
        }
    ]
}