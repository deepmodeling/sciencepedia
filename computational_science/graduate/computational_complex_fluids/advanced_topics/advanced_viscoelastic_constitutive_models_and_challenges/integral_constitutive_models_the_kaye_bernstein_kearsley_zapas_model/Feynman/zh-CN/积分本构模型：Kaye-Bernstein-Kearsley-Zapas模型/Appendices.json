{
    "hands_on_practices": [
        {
            "introduction": "K-BKZ 模型的阻尼函数通常依赖于应变张量的不变量，这些不变量能够以与坐标系无关的方式量化变形程度。这个基础练习旨在通过谱分解方法，从第一性原理出发，推导 Finger 张量 $\\boldsymbol{B}(t,t')$ 的第一和第二主不变量与主拉伸比 $\\lambda_i(t,t')$ 之间的精确关系。掌握这种联系对于理解模型如何将复杂的张量变形转化为可用于材料本构关系的标量至关重要。",
            "id": "4090502",
            "problem": "考虑一个三维连续介质在时间 $t'$ 到时间 $t$ 之间经历一个普遍变形。令变形梯度表示为 $\\boldsymbol{F}(t,t')$。在 Kaye-Bernstein-Kearsley-Zapas (K-BKZ) 积分本构模型中，与时间区间 $(t',t)$ 相关的左柯西-格林张量（或 Finger 张量）定义为 $\\boldsymbol{B}(t,t') = \\boldsymbol{F}(t,t')\\boldsymbol{F}(t,t')^\\top$。K-BKZ 模型中的阻尼函数取决于 $\\boldsymbol{B}(t,t')$ 的主不变量，这些主不变量是变形的内在度量，与坐标基无关。\n\n严格地从连续介质运动学和基本张量性质出发，运用谱论证将 $\\boldsymbol{B}(t,t')$ 的第一和第二主不变量用与 $t'$ 到 $t$ 之间的变形相关的主拉伸比 $\\lambda_{1}(t,t')$, $\\lambda_{2}(t,t')$, 和 $\\lambda_{3}(t,t')$ 表示。仅假设变形具有实数极分解，并且拉伸张量是可对角化的，其主拉伸为实的正数。你的最终答案必须是单一的闭式符号表达式，给出两个不变量作为 $\\lambda_{1}(t,t')$, $\\lambda_{2}(t,t')$, 和 $\\lambda_{3}(t,t')$ 的函数。\n\n不需要进行数值计算。如果在推导中引入任何辅助量，需在最终表达式中将其消去，以使答案仅用 $\\lambda_{1}(t,t')$, $\\lambda_{2}(t,t')$, 和 $\\lambda_{3}(t,t')$ 表示。",
            "solution": "所述问题是有效的。这是一个适定的、具有科学依据的连续介质力学问题，没有矛盾或含糊之处。它要求基于张量代数和运动学的基本原理进行严格的推导。\n\n我们首先建立 Finger 张量 $\\boldsymbol{B}(t,t')$ 与主拉伸比 $\\lambda_{i}(t,t')$ 之间的关系。为了在推导中简化符号，我们将与变形相关的量 $\\boldsymbol{F}(t,t')$, $\\boldsymbol{B}(t,t')$, 和 $\\lambda_{i}(t,t')$ 分别表示为 $\\boldsymbol{F}$, $\\boldsymbol{B}$, 和 $\\lambda_{i}$。\n\n问题给出了左柯西-格林张量（Finger 张量）的定义：\n$$\n\\boldsymbol{B} = \\boldsymbol{F}\\boldsymbol{F}^{\\top}\n$$\n问题还假设变形梯度 $\\boldsymbol{F}$ 存在极分解。我们将其分解写为：\n$$\n\\boldsymbol{F} = \\boldsymbol{R}\\boldsymbol{U}\n$$\n其中 $\\boldsymbol{R}$ 是一个代表纯旋转的正常正交张量（$\\boldsymbol{R}^{\\top}\\boldsymbol{R} = \\boldsymbol{R}\\boldsymbol{R}^{\\top} = \\boldsymbol{I}$，$\\boldsymbol{I}$ 是二阶单位张量），$\\boldsymbol{U}$ 是右拉伸张量，它是对称的（$\\boldsymbol{U}^{\\top} = \\boldsymbol{U}$）且正定的。\n\n将极分解代入 $\\boldsymbol{B}$ 的定义，得到：\n$$\n\\boldsymbol{B} = (\\boldsymbol{R}\\boldsymbol{U})(\\boldsymbol{R}\\boldsymbol{U})^{\\top} = \\boldsymbol{R}\\boldsymbol{U}\\boldsymbol{U}^{\\top}\\boldsymbol{R}^{\\top}\n$$\n利用对称性 $\\boldsymbol{U}^{\\top} = \\boldsymbol{U}$，我们得到：\n$$\n\\boldsymbol{B} = \\boldsymbol{R}\\boldsymbol{U}^2\\boldsymbol{R}^{\\top}\n$$\n这个方程表明，张量 $\\boldsymbol{B}$ 和 $\\boldsymbol{U}^2$ 是相似的，通过一个正交变换 $\\boldsymbol{R}$ 相关联。相似矩阵具有相同的特征值。因此，$\\boldsymbol{B}$ 的特征值与 $\\boldsymbol{U}^2$ 的特征值相同。\n\n问题指出右拉伸张量 $\\boldsymbol{U}$ 是可对角化的。这意味着存在一个由特征向量构成的标准正交基 $\\{\\boldsymbol{n}_{1}, \\boldsymbol{n}_{2}, \\boldsymbol{n}_{3}\\}$，使得 $\\boldsymbol{U}$ 对每个 $\\boldsymbol{n}_{i}$ 的作用是按相应特征值（即主拉伸比 $\\lambda_{i}$）进行简单的缩放。$\\boldsymbol{U}$ 的特征值是主拉伸比 $\\lambda_{i} > 0$。\n\n由于 $\\boldsymbol{U}$ 的特征值是 $\\lambda_i$，那么 $\\boldsymbol{U}^2$ 的特征值就是 $\\lambda_i^2$。因此，$\\boldsymbol{B}$ 的特征值（我们将其表示为 $\\beta_i$）为：\n$$\n\\beta_{1} = \\lambda_{1}^{2}, \\quad \\beta_{2} = \\lambda_{2}^{2}, \\quad \\beta_{3} = \\lambda_{3}^{2}\n$$\n二阶张量的主不变量是根据其特征值定义的。第一主不变量 $I_{1}$ 是张量的迹，即其特征值之和。对于张量 $\\boldsymbol{B}$，这便是：\n$$\nI_{1}(\\boldsymbol{B}) = \\text{tr}(\\boldsymbol{B}) = \\beta_{1} + \\beta_{2} + \\beta_{3} = \\lambda_{1}^{2} + \\lambda_{2}^{2} + \\lambda_{3}^{2}\n$$\n第二主不变量 $I_{2}$ 是特征值两两相乘之积的和。对于张量 $\\boldsymbol{B}$，这便是：\n$$\nI_{2}(\\boldsymbol{B}) = \\beta_{1}\\beta_{2} + \\beta_{2}\\beta_{3} + \\beta_{3}\\beta_{1} = \\lambda_{1}^{2}\\lambda_{2}^{2} + \\lambda_{2}^{2}\\lambda_{3}^{2} + \\lambda_{3}^{2}\\lambda_{1}^{2}\n$$\n恢复主拉伸比的完整符号表示，它们依赖于时间区间 $(t', t)$，我们得到最终表达式。\n\n$\\boldsymbol{B}(t,t')$ 的第一主不变量是：\n$$\nI_{1}(\\boldsymbol{B}(t,t')) = \\lambda_{1}(t,t')^{2} + \\lambda_{2}(t,t')^{2} + \\lambda_{3}(t,t')^{2}\n$$\n$\\boldsymbol{B}(t,t')$ 的第二主不变量是：\n$$\nI_{2}(\\boldsymbol{B}(t,t')) = \\lambda_{1}(t,t')^{2}\\lambda_{2}(t,t')^{2} + \\lambda_{2}(t,t')^{2}\\lambda_{3}(t,t')^{2} + \\lambda_{3}(t,t')^{2}\\lambda_{1}(t,t')^{2}\n$$\n这些表达式提供了 Finger 张量的不变量与主拉伸比之间的所需关系，这是严格从运动学定义和张量的谱性质推导出来的。",
            "answer": "$$\n\\boxed{\n\\begin{align*}\nI_1(\\boldsymbol{B}(t,t')) = \\lambda_{1}(t,t')^{2} + \\lambda_{2}(t,t')^{2} + \\lambda_{3}(t,t')^{2} \\\\\nI_2(\\boldsymbol{B}(t,t')) = \\lambda_{1}(t,t')^{2}\\lambda_{2}(t,t')^{2} + \\lambda_{2}(t,t')^{2}\\lambda_{3}(t,t')^{2} + \\lambda_{3}(t,t')^{2}\\lambda_{1}(t,t')^{2}\n\\end{align*}\n}\n$$"
        },
        {
            "introduction": "积分本构方程的预测能力强烈地依赖于所选的应变度量。本练习旨在通过计算稳态简单剪切流中的第二法向应力差 ($N_2$)，来直接对比两种常用的应变张量——Finger 张量 $\\boldsymbol{B}$ 及其逆张量 $\\boldsymbol{B}^{-1}$——所带来的物理预测差异。这个实践将清晰地揭示，为何对张量的不同选择（例如，对应于上随体或下随体导数的应变度量）会导致模型预测出截然不同的流变现象。",
            "id": "4090528",
            "problem": "考虑一种均匀、不可压缩、等温的粘弹性流体，其由单模态Kaye–Bernstein–Kearsley–Zapas (K-BKZ) 积分本构方程建模。记忆函数取为指数形式，$M(s) = (G/\\lambda)\\exp(-s/\\lambda)$，其中 $G$ 是模量，$\\lambda$ 是松弛时间。假设阻尼函数等于1，因此应力张量泛函仅依赖于所选的应变度量。设流动为稳态简单剪切流，速度场为 $\\boldsymbol{v} = \\dot{\\gamma}\\, y\\, \\boldsymbol{e}_{x}$，其中 $\\dot{\\gamma}$ 是恒定的剪切速率。用 $s = t - t'$ 表示时间延迟，并使用标准连续介质运动学来定义在区间 $[t',t]$ 上的变形梯度 $\\boldsymbol{F}(t,t')$、左柯西-格林（Finger）张量 $\\boldsymbol{B}(t,t') = \\boldsymbol{F}(t,t')\\,\\boldsymbol{F}(t,t')^{\\mathsf{T}}$ 及其逆 $\\boldsymbol{B}^{-1}(t,t')$。\n\n将第二法向应力差定义为 $N_{2} = \\sigma_{yy} - \\sigma_{zz}$，其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量。从稳态简单剪切流的 $\\boldsymbol{F}$、$\\boldsymbol{B}$ 和 $\\boldsymbol{B}^{-1}$ 的基本定义出发，并使用带有两种候选应变度量 $\\boldsymbol{B}$ 和 $\\boldsymbol{B}^{-1}$（通过线性张量泛函 $[\\cdot - \\boldsymbol{I}]$）的K-BKZ积分应力构造，推导两种情况下 $N_{2}$ 的稳态预测值。然后，通过对时间积分的显式计算，确定当应力泛函使用逆Finger张量时 $N_{2}$ 的闭式解析表达式，即\n$$\n\\boldsymbol{\\sigma}(t) = \\int_{0}^{\\infty} M(s)\\,\\big(\\boldsymbol{B}^{-1}(s) - \\boldsymbol{I}\\big)\\,\\mathrm{d}s,\n$$\n在恒定剪切速率 $\\dot{\\gamma}$ 的稳态简单剪切流条件下。\n\n将您关于 $N_{2}$ 的最终答案表示为包含 $G$、$\\lambda$ 和 $\\dot{\\gamma}$ 的单个解析表达式。您的最终答案必须是单个闭式解析表达式。",
            "solution": "该问题要求在稳态简单剪切流条件下，对于由单模态K-BKZ本构方程描述的粘弹性流体，推导第二法向应力差 $N_{2}$。我们必须首先分析应变度量基于Finger张量 $\\boldsymbol{B}$ 及其逆 $\\boldsymbol{B}^{-1}$ 的两种情况，然后为后一种情况提供一个闭式解。\n\n第一步是建立稳态简单剪切流的运动学。速度场由 $\\boldsymbol{v} = \\dot{\\gamma} y \\boldsymbol{e}_{x}$ 给出，其中 $\\dot{\\gamma}$ 是恒定的剪切速率。流体质点在过去时刻 $t'$ 的位置 $\\boldsymbol{x}' = (x', y', z')$ 与其在当前时刻 $t$ 的位置 $\\boldsymbol{x} = (x, y, z)$ 通过对速度场积分相关联。对于稳态流，该关系仅取决于时间延迟 $s = t - t'$。从当前构型到过去构型的映射为：\n$$\nx' = x - \\dot{\\gamma} y s, \\quad y' = y, \\quad z' = z\n$$\n变形梯度张量 $\\boldsymbol{F}(s) \\equiv \\boldsymbol{F}(t, t')$ 由其分量 $F_{ij} = \\frac{\\partial x_i(t)}{\\partial x'_j(t')}$ 定义。为了计算它，我们使用逆映射，该映射描述了当前位置作为过去位置的函数：\n$$\nx(t) = x' + \\dot{\\gamma} y' s, \\quad y(t) = y', \\quad z(t) = z'\n$$\n变形梯度张量的分量则为：\n$$\n\\boldsymbol{F}(s) = \\begin{pmatrix} \\frac{\\partial x}{\\partial x'}  \\frac{\\partial x}{\\partial y'}  \\frac{\\partial x}{\\partial z'} \\\\ \\frac{\\partial y}{\\partial x'}  \\frac{\\partial y}{\\partial y'}  \\frac{\\partial y}{\\partial z'} \\\\ \\frac{\\partial z}{\\partial x'}  \\frac{\\partial z}{\\partial y'}  \\frac{\\partial z}{\\partial z'} \\end{pmatrix} = \\begin{pmatrix} 1  \\dot{\\gamma}s  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n左柯西-格林（或Finger）张量 $\\boldsymbol{B}(s)$ 由 $\\boldsymbol{B}(s) = \\boldsymbol{F}(s)\\boldsymbol{F}(s)^{\\mathsf{T}}$ 给出：\n$$\n\\boldsymbol{B}(s) = \\begin{pmatrix} 1  \\dot{\\gamma}s  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ \\dot{\\gamma}s  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1 + (\\dot{\\gamma}s)^2  \\dot{\\gamma}s  0 \\\\ \\dot{\\gamma}s  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n计算Finger张量的逆 $\\boldsymbol{B}^{-1}(s)$。$\\boldsymbol{B}(s)$ 的行列式为 $\\det(\\boldsymbol{B}(s)) = (1 + (\\dot{\\gamma}s)^2)(1) - (\\dot{\\gamma}s)^2 = 1$，这与不可压缩流体的预期相符。\n$$\n\\boldsymbol{B}^{-1}(s) = \\begin{pmatrix} 1  -\\dot{\\gamma}s  0 \\\\ -\\dot{\\gamma}s  1 + (\\dot{\\gamma}s)^2  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n具有单位阻尼函数的K-BKZ模型将额外应力张量 $\\boldsymbol{\\sigma}$ 与变形历史联系起来。对于不可压缩流体，总应力为 $\\boldsymbol{\\tau} = -p\\boldsymbol{I} + \\boldsymbol{\\sigma}$，其中 $p$ 是待定压力。第二法向应力差 $N_{2} = \\tau_{yy} - \\tau_{zz} = (-p\\delta_{yy} + \\sigma_{yy}) - (-p\\delta_{zz} + \\sigma_{zz}) = \\sigma_{yy} - \\sigma_{zz}$，因此压力项没有贡献。\n\n我们现在考虑额外应力泛函的两种候选应变度量。\n\n情况1：应力泛函依赖于 $(\\boldsymbol{B} - \\boldsymbol{I})$。\n额外应力张量由下式给出：\n$$\n\\boldsymbol{\\sigma}(t) = \\int_{0}^{\\infty} M(s)\\,\\big(\\boldsymbol{B}(s) - \\boldsymbol{I}\\big)\\,\\mathrm{d}s\n$$\n$(\\boldsymbol{B}(s) - \\boldsymbol{I})$ 项为：\n$$\n\\boldsymbol{B}(s) - \\boldsymbol{I} = \\begin{pmatrix} (\\dot{\\gamma}s)^2  \\dot{\\gamma}s  0 \\\\ \\dot{\\gamma}s  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n额外应力张量的相关分量为：\n$$\n\\sigma_{yy} = \\int_{0}^{\\infty} M(s) (0) \\,\\mathrm{d}s = 0\n$$\n$$\n\\sigma_{zz} = \\int_{0}^{\\infty} M(s) (0) \\,\\mathrm{d}s = 0\n$$\n因此，该模型的第二法向应力差为：\n$$\nN_{2} = \\sigma_{yy} - \\sigma_{zz} = 0\n$$\n该模型，对于给定的记忆函数，对应于上随流Maxwell模型，其预测的第二法向应力差为零。\n\n情况2：应力泛函依赖于 $(\\boldsymbol{B}^{-1} - \\boldsymbol{I})$。\n这是需要详细计算的情况。额外应力张量为：\n$$\n\\boldsymbol{\\sigma}(t) = \\int_{0}^{\\infty} M(s)\\,\\big(\\boldsymbol{B}^{-1}(s) - \\boldsymbol{I}\\big)\\,\\mathrm{d}s\n$$\n$(\\boldsymbol{B}^{-1}(s) - \\boldsymbol{I})$ 项为：\n$$\n\\boldsymbol{B}^{-1}(s) - \\boldsymbol{I} = \\begin{pmatrix} 0  -\\dot{\\gamma}s  0 \\\\ -\\dot{\\gamma}s  (\\dot{\\gamma}s)^2  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n额外应力张量的相关分量为：\n$$\n\\sigma_{yy} = \\int_{0}^{\\infty} M(s) (\\dot{\\gamma}s)^2 \\,\\mathrm{d}s = \\dot{\\gamma}^2 \\int_{0}^{\\infty} M(s) s^2 \\,\\mathrm{d}s\n$$\n$$\n\\sigma_{zz} = \\int_{0}^{\\infty} M(s) (0) \\,\\mathrm{d}s = 0\n$$\n该模型的第二法向应力差为：\n$$\nN_{2} = \\sigma_{yy} - \\sigma_{zz} = \\dot{\\gamma}^2 \\int_{0}^{\\infty} M(s) s^2 \\,\\mathrm{d}s\n$$\n我们已知指数记忆函数 $M(s) = \\frac{G}{\\lambda}\\exp(-\\frac{s}{\\lambda})$。将其代入 $N_{2}$ 的表达式中：\n$$\nN_{2} = \\dot{\\gamma}^2 \\int_{0}^{\\infty} \\left(\\frac{G}{\\lambda}\\exp\\left(-\\frac{s}{\\lambda}\\right)\\right) s^2 \\,\\mathrm{d}s\n$$\n我们可以将常数从积分中提出：\n$$\nN_{2} = \\frac{G \\dot{\\gamma}^2}{\\lambda} \\int_{0}^{\\infty} s^2 \\exp\\left(-\\frac{s}{\\lambda}\\right) \\,\\mathrm{d}s\n$$\n该积分为与伽马函数相关的标准形式。通用公式为 $\\int_{0}^{\\infty} x^n \\exp(-ax) \\,\\mathrm{d}x = \\frac{n!}{a^{n+1}}$。在我们的情况下，$n=2$ 且 $a = \\frac{1}{\\lambda}$。\n$$\n\\int_{0}^{\\infty} s^2 \\exp\\left(-\\frac{s}{\\lambda}\\right) \\,\\mathrm{d}s = \\frac{2!}{(1/\\lambda)^{2+1}} = \\frac{2}{(1/\\lambda)^3} = 2\\lambda^3\n$$\n将此结果代回 $N_{2}$ 的表达式中：\n$$\nN_{2} = \\frac{G \\dot{\\gamma}^2}{\\lambda} (2\\lambda^3)\n$$\n简化表达式得到最终的闭式解：\n$$\nN_{2} = 2G\\lambda^2\\dot{\\gamma}^2\n$$\n该模型对应于下随流Maxwell模型，其预测了一个非零、为正且与剪切速率呈二次关系的第二法向应力差。",
            "answer": "$$\\boxed{N_2 = 2G\\lambda^{2}\\dot{\\gamma}^{2}}$$"
        },
        {
            "introduction": "在流体力学的计算模拟中，高效地处理和更新变形历史是实现精确和快速计算的关键。这个计算实践任务要求你为简单剪切流推导并实现一个递推算法，用于更新 K-BKZ 模型中 Finger 张量的历史。通过这个练习，你将把连续介质力学的理论与数值计算的实际需求相结合，体验开发高效流变模拟代码的核心步骤，这种方法避免了在每个时间步都从头进行成本高昂的积分计算。",
            "id": "4090491",
            "problem": "考虑一个经历简单剪切的均质不可压缩连续介质，该过程在 Kaye-Bernstein-Kearsley-Zapas (K-BKZ) 积分本构框架内建模。其基本运动学由相对变形梯度 $\\boldsymbol{F}(t,t')$ 指定，它将材料线元从过去时间 $t'$ 映射到现在时间 $t$，并遵循输运方程 $\\dfrac{d}{dt}\\boldsymbol{F}(t,t')=\\boldsymbol{L}(t)\\,\\boldsymbol{F}(t,t')$，初始条件为 $\\boldsymbol{F}(t',t')=\\boldsymbol{I}$，其中 $\\boldsymbol{L}(t)$ 是空间速度梯度，$\\boldsymbol{I}$ 是单位张量。Finger 应变张量定义为 $\\boldsymbol{B}(t,t')=\\boldsymbol{F}(t,t')\\,\\boldsymbol{F}^{\\mathsf{T}}(t,t')$。\n\n在简单剪切中，空间速度梯度 $\\boldsymbol{L}(t)$ 仅有分量 $L_{12}(t)$ 非零，且 $L_{12}(t)=\\dot{\\gamma}(t)$，其中 $\\dot{\\gamma}(t)$ 是剪切速率。假设一个离散时间网格 $t_n=n\\,\\Delta t$，其时间步长 $\\Delta t0$ 均匀，且整数 $n\\geq 0$。用 $\\boldsymbol{B}(t_n,t_{n-k})$ 表示在 $t_{n-k}$ 和 $t_n$ 之间的 Finger 张量，其中整数 $k\\in\\{1,2,\\dots,n\\}$。\n\n您的任务是：\n- 仅从相对变形梯度的输运方程、Finger 张量的定义以及简单剪切中 $\\boldsymbol{L}(t)$ 的结构出发，推导一个递归关系。该关系能够在一个新的时间步 $t_{n+1}$，仅使用前一时间步 $t_n$ 的信息和当前的增量变形，来计算所有 $k\\in\\{1,\\dots,n\\}$ 的 $\\boldsymbol{B}(t_n,t_{n-k})$（即，在每个步骤中不要从 $t_0$ 重新计算整个历史）。\n- 设计并实现一个算法，该算法使用此递归关系，在均匀时间网格上高效地将整个集合 $\\{\\boldsymbol{B}(t_n,t_{n-k})\\}_{k=1}^n$ 更新为 $\\{\\boldsymbol{B}(t_{n+1},t_{n+1-k})\\}_{k=1}^{n+1}$，以处理简单剪切问题。\n- 为验证正确性，将您递归计算的 $\\boldsymbol{B}(t_n,t_{n-k})$ 与由简单剪切的基本运动学所蕴含的精确表达式进行比较。在构建闭式基准时，您唯一可以引用的中间量是累积剪切 $\\Gamma(t,t')=\\int_{t'}^{t}\\dot{\\gamma}(s)\\,ds$；所有其他步骤必须遵循基本定义。将每个测试案例的差异量化为在所有时间 $t_n$ 和所有 $k\\in\\{1,\\dots,n\\}$ 上的最大绝对逐元误差。\n\n张量使用 $3\\times 3$ 表示法，剪切发生在 $\\{x,y\\}$-平面，$\\{z\\}$-方向不受影响。假设除时间和剪切速率外，所有量均为无量纲。时间单位必须为秒，剪切速率单位为秒的倒数；最终报告的误差是无量纲的。\n\n实现一个完整的、可运行的程序，对以下测试套件执行更新和验证。对于每个测试案例，使用指定的参数，在整个时间范围内计算递归更新，并报告一个标量值，该值等于在所有计算的对 $\\{(t_n,t_{n-k})\\}$ 中，递归 $\\boldsymbol{B}$ 与精确 $\\boldsymbol{B}$ 之间的最大绝对逐元误差。\n\n测试套件：\n- 案例1（恒定剪切速率，理想路径）：$\\Delta t=0.25\\,\\text{s}$，$N=8$ 步，在所有时间 $\\dot{\\gamma}(t)=2.0\\,\\text{s}^{-1}$。\n- 案例2（平滑时间变化）：$\\Delta t=0.05\\,\\text{s}$，$N=40$ 步，$\\dot{\\gamma}(t)=1.5\\,\\sin(\\omega t)$，其中 $\\omega=1.0\\,\\text{rad}\\,\\text{s}^{-1}$，在 $t_n=n\\,\\Delta t$ 处求值。\n- 案例3（符号变化与平台期）：$\\Delta t=0.10\\,\\text{s}$，$N=20$ 步，分段常数方案：前 $5$ 步 $\\dot{\\gamma}(t)=3.0\\,\\text{s}^{-1}$，接下来 $5$ 步 $\\dot{\\gamma}(t)=-3.0\\,\\text{s}^{-1}$，再接下来 $5$ 步 $\\dot{\\gamma}(t)=0.0\\,\\text{s}^{-1}$，最后 $5$ 步 $\\dot{\\gamma}(t)=1.0\\,\\text{s}^{-1}$。\n- 案例4（粗步长，交替速率，边界检查）：$\\Delta t=0.50\\,\\text{s}$，$N=6$ 步，第 $1$ 步到第 $6$ 步的剪切速率 $\\dot{\\gamma}(t)$ 方案为 $\\{0.0,\\,0.0,\\,5.0,\\,-5.0,\\,2.5,\\,-2.5\\}\\,\\text{s}^{-1}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是相应测试案例的最大绝对误差，表示为十进制浮点数。不得产生任何其他输出。",
            "solution": "此问题经评估有效。它在科学上以连续介质力学为基础，数学上是适定的，客观且内部一致。推导、实现和验证所需的所有数据和条件均已提供。开始解答。\n\n此问题的核心是设计并验证一个高效的递归算法，用于在采用 K-BKZ 模型等积分本构模型的仿真中，更新 Finger 应变张量 $\\boldsymbol{B}(t,t')$ 的历史。运动学仅限于简单剪切。\n\n### 1. 递归更新法则的推导\n\n材料变形的时间演化由相对变形梯度 $\\boldsymbol{F}(t, t')$ 捕捉，它将线元从过去构型（时刻 $t'$）映射到当前构型（时刻 $t$）。变形梯度的一个基本性质是其复合律。对于任意三个时间 $t_j  t_n  t_{n+1}$，从 $t_j$ 到 $t_{n+1}$ 的变形可以分解为：\n$$\n\\boldsymbol{F}(t_{n+1}, t_j) = \\boldsymbol{F}(t_{n+1}, t_n) \\boldsymbol{F}(t_n, t_j)\n$$\n这里，$\\boldsymbol{F}(t_{n+1}, t_n)$ 是时间区间 $[t_n, t_{n+1}]$ 上的增量变形梯度，我们将其记为 $\\Delta \\boldsymbol{F}_n$。方程变为：\n$$\n\\boldsymbol{F}(t_{n+1}, t_j) = \\Delta \\boldsymbol{F}_n \\, \\boldsymbol{F}(t_n, t_j)\n$$\nFinger 应变张量 $\\boldsymbol{B}(t, t')$ 定义为 $\\boldsymbol{B}(t,t') = \\boldsymbol{F}(t,t')\\,\\boldsymbol{F}^{\\mathsf{T}}(t,t')$。我们可以将复合律代入 $\\boldsymbol{B}(t_{n+1}, t_j)$ 的定义中：\n$$\n\\boldsymbol{B}(t_{n+1}, t_j) = \\left( \\Delta \\boldsymbol{F}_n \\, \\boldsymbol{F}(t_n, t_j) \\right) \\left( \\Delta \\boldsymbol{F}_n \\, \\boldsymbol{F}(t_n, t_j) \\right)^{\\mathsf{T}}\n$$\n使用性质 $(AB)^{\\mathsf{T}} = B^{\\mathsf{T}}A^{\\mathsf{T}}$，我们得到：\n$$\n\\boldsymbol{B}(t_{n+1}, t_j) = \\Delta \\boldsymbol{F}_n \\, \\boldsymbol{F}(t_n, t_j) \\, \\boldsymbol{F}^{\\mathsf{T}}(t_n, t_j) \\, \\Delta \\boldsymbol{F}_n^{\\mathsf{T}}\n$$\n注意到 $\\boldsymbol{F}(t_n, t_j) \\, \\boldsymbol{F}^{\\mathsf{T}}(t_n, t_j) = \\boldsymbol{B}(t_n, t_j)$，我们便得到了所需的递归关系：\n$$\n\\boldsymbol{B}(t_{n+1}, t_j) = \\Delta \\boldsymbol{F}_n \\, \\boldsymbol{B}(t_n, t_j) \\, \\Delta \\boldsymbol{F}_n^{\\mathsf{T}}\n$$\n此方程允许我们通过对前一时间步 $t_n$ 的相应张量进行前乘和后乘（使用增量变形梯度 $\\Delta \\boldsymbol{F}_n$ 及其转置）来“更新”，从而计算出时间 $t_{n+1}$ 相对于任何过去时间 $t_j$（$j  n$）的 Finger 张量。\n\n### 2. 增量变形梯度的计算\n\n为使用该递归关系，我们必须确定增量变形梯度 $\\Delta \\boldsymbol{F}_n = \\boldsymbol{F}(t_{n+1}, t_n)$。它是在区间 $t \\in [t_n, t_{n+1}]$ 上，初始条件为 $\\boldsymbol{F}(t_n,t_n) = \\boldsymbol{I}$ 的输运方程 $\\frac{d}{dt}\\boldsymbol{F}(t,t_n) = \\boldsymbol{L}(t)\\,\\boldsymbol{F}(t,t_n)$ 的解。对于简单剪切的特定情况，速度梯度张量 $\\boldsymbol{L}(t)$ 只有一个非零分量 $L_{12}(t) = \\dot{\\gamma}(t)$：\n$$\n\\boldsymbol{L}(t) = \\begin{pmatrix} 0  \\dot{\\gamma}(t)  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n该矩阵的一个关键性质是，对于任意两个时间 $t_a$ 和 $t_b$，其对易子为零：$[\\boldsymbol{L}(t_a), \\boldsymbol{L}(t_b)] = \\boldsymbol{L}(t_a)\\boldsymbol{L}(t_b) - \\boldsymbol{L}(t_b)\\boldsymbol{L}(t_a) = \\boldsymbol{0} - \\boldsymbol{0} = \\boldsymbol{0}$，因为 $\\boldsymbol{L}(t)^2 = \\boldsymbol{0}$。这种可交换性将输运方程的解简化为 $\\boldsymbol{L}(t)$ 积分的标准矩阵指数：\n$$\n\\Delta \\boldsymbol{F}_n = \\boldsymbol{F}(t_{n+1}, t_n) = \\exp\\left(\\int_{t_n}^{t_{n+1}} \\boldsymbol{L}(s) \\, ds\\right)\n$$\n令 $\\Delta \\gamma_n = \\int_{t_n}^{t_{n+1}} \\dot{\\gamma}(s) \\, ds$ 为在区间 $[t_n, t_{n+1}]$ 期间累积的剪切应变。积分后的矩阵为：\n$$\n\\int_{t_n}^{t_{n+1}} \\boldsymbol{L}(s) \\, ds = \\begin{pmatrix} 0  \\Delta \\gamma_n  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\equiv \\boldsymbol{A}_n\n$$\n矩阵 $\\boldsymbol{A}_n$ 是 2 阶幂零的（即 $\\boldsymbol{A}_n^2 = \\boldsymbol{0}$）。因此，矩阵指数的泰勒级数 $\\exp(\\boldsymbol{A}_n) = \\boldsymbol{I} + \\boldsymbol{A}_n + \\frac{1}{2!}\\boldsymbol{A}_n^2 + \\dots$ 在线性项之后终止：\n$$\n\\Delta \\boldsymbol{F}_n = \\exp(\\boldsymbol{A}_n) = \\boldsymbol{I} + \\boldsymbol{A}_n = \\begin{pmatrix} 1  \\Delta \\gamma_n  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n问题指定了每个步骤的剪切速率是分段常数。令 $\\dot{\\gamma}_{n+1}$ 为区间 $[t_{n}, t_{n+1}]$ 上的恒定剪切速率。增量剪切应变恰好为 $\\Delta \\gamma_{n} = \\dot{\\gamma}_{n+1} \\Delta t$。\n\n### 3. 完整的递归算法\n\n在每个时间步 $t_n$（其中 $n=1, \\dots, N$），我们需要生成历史张量集合 $\\{\\boldsymbol{B}(t_n, t_{n-k})\\}_{k=1}^n$。算法流程如下：\n1. 初始化一个空列表 `history_B`，用于存储张量。\n2. 对于从 $1$ 到 $N$ 的每一步 $n$：\n   a. 确定增量剪切应变 $\\Delta \\gamma_{n-1} = \\dot{\\gamma}_n \\Delta t$，其中 $\\dot{\\gamma}_n$ 是第 $n$ 步的指定速率。\n   b. 构建增量变形梯度 $\\Delta \\boldsymbol{F}_{n-1} = \\boldsymbol{F}(t_n, t_{n-1})$。\n   c. 为时间 $t_n$ 的更新历史创建一个新列表。\n   d. 对于 `history_B` 中的每个现有张量 $\\boldsymbol{B}_{old} = \\boldsymbol{B}(t_{n-1}, t_j)$，计算更新后的张量 $\\boldsymbol{B}_{new} = \\Delta \\boldsymbol{F}_{n-1} \\, \\boldsymbol{B}_{old} \\, \\Delta \\boldsymbol{F}_{n-1}^{\\mathsf{T}}$ 并将其添加到新列表中。这将 $\\boldsymbol{B}(t_{n-1}, t_j)$ 更新为 $\\boldsymbol{B}(t_n, t_j)$。\n   e. 计算最新的历史张量，它对应于最近的时间区间：$\\boldsymbol{B}(t_n, t_{n-1}) = \\Delta \\boldsymbol{F}_{n-1} \\, \\Delta \\boldsymbol{F}_{n-1}^{\\mathsf{T}}$。\n   f. 将这个最新的张量前置添加到新列表中。\n   g. 用新列表替换旧的 `history_B`。\n\n该过程通过利用前一步的结果来高效地更新整个历史，避免了从 $t_0$ 开始的耗时重新积分。\n\n### 4. 用于精确验证的表达式\n\n为了验证，我们将递归计算的张量与直接的精确计算进行比较。问题指出，精确计算应基于总累积剪切 $\\Gamma(t,t')=\\int_{t'}^{t}\\dot{\\gamma}(s)\\,ds$。\n遵循与 $\\Delta \\boldsymbol{F}_n$ 类似的推导，精确的相对变形梯度 $\\boldsymbol{F}(t, t')$ 为：\n$$\n\\boldsymbol{F}(t, t') = \\begin{pmatrix} 1  \\Gamma(t, t')  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n由此，精确的 Finger 张量 $\\boldsymbol{B}(t, t')$ 为：\n$$\n\\boldsymbol{B}(t, t') = \\boldsymbol{F}(t, t') \\boldsymbol{F}^{\\mathsf{T}}(t, t') = \\begin{pmatrix} 1  \\Gamma(t, t')  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ \\Gamma(t, t')  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{B}(t, t') = \\begin{pmatrix} 1 + \\Gamma(t, t')^2  \\Gamma(t, t')  0 \\\\ \\Gamma(t, t')  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n对于一个分段常数剪切速率方案，其中 $\\dot{\\gamma}_i$ 是区间 $[t_{i-1}, t_i]$ 的速率，则 $t_j$ 和 $t_n$（$jn$）之间的总剪切应变为 $\\Gamma(t_n, t_j) = \\sum_{i=j+1}^{n} \\dot{\\gamma}_i \\Delta t$。\n\n对于案例2，剪切速率是时间相关的。增量剪切应变为 $\\Delta \\gamma_{n-1} = \\int_{t_{n-1}}^{t_n} 1.5 \\sin(\\omega s) ds = \\frac{1.5}{\\omega}[-\\cos(\\omega s)]_{t_{n-1}}^{t_n} = \\frac{1.5}{\\omega}(\\cos(\\omega t_{n-1}) - \\cos(\\omega t_n))$。然而，问题规定“在 $t_n=n\\,\\Delta t$ 处求值”，这暗示了对积分的数值近似，即在每个区间内将速率视为常数 $\\dot{\\gamma}(t_n)$。为了忠实于问题陈述并创建一个可验证的基准，我们将一致地使用这种分段常数近似。因此，对于所有情况，$\\Delta \\gamma_{n-1} = \\dot{\\gamma}(t_n) \\Delta t$ 且 $\\Gamma(t_n, t_j) = \\sum_{i=j+1}^{n} \\dot{\\gamma}(t_i) \\Delta t$。在这种情况下，递归方法和精确表达式在代数上是等价的，任何差异都将仅源于浮点舍入误差。",
            "answer": "[0.0,0.0,0.0,0.0]"
        }
    ]
}