{
    "hands_on_practices": [
        {
            "introduction": "Before delving into the complex dynamics of elastic turbulence, it is essential to identify the physical conditions under which it can arise. This first practice grounds our study in fundamental principles of dimensional analysis, guiding you to calculate the key dimensionless parameters that govern viscoelastic fluid flows. By computing the Reynolds number ($Re$), Weissenberg number ($Wi$), and Elasticity number ($El$) from a given set of physical properties, you will learn to classify flow regimes and pinpoint the specific parameter space—low inertia and high elasticity—where elastic turbulence emerges .",
            "id": "4084941",
            "problem": "A dilute polymer solution flowing in a microchannel is modeled as an incompressible viscoelastic fluid. Assume the momentum balance is given by the conservation of linear momentum with a viscous stress and an additional polymeric extra-stress, and that the polymeric extra-stress obeys a single-mode linear elastic constitutive law with a finite relaxation time. The characteristic scales are a length $L$, a velocity $U$, and a total dynamic viscosity $\\eta$ for the solution. Let the fluid density be $\\rho$ and the polymer relaxation time be $\\lambda$. The flow is steady and the geometry is such that curvature or weak extensional regions can arise, although the analysis here focuses only on the intrinsic dimensionless groups produced by nondimensionalization.\n\nStarting from the balance of linear momentum for an incompressible fluid and a linear viscoelastic constitutive relation with relaxation time, use nondimensionalization with the scales $L$ and $U$ to identify the dimensionless numbers that compare inertia to viscous stress, elastic relaxation to flow time, and elastic effects to inertia. Then, using the following physically consistent parameters for a microchannel flow:\n- Mean velocity $U = 5.0 \\times 10^{-2}\\ \\text{m}\\,\\text{s}^{-1}$,\n- Characteristic length $L = 1.0 \\times 10^{-4}\\ \\text{m}$,\n- Total dynamic viscosity $\\eta = 1.0 \\times 10^{-1}\\ \\text{Pa}\\,\\text{s}$,\n- Density $\\rho = 1.0 \\times 10^{3}\\ \\text{kg}\\,\\text{m}^{-3}$,\n- Polymer relaxation time $\\lambda = 5.0 \\times 10^{-1}\\ \\text{s}$,\n\ncompute the Reynolds number, the Weissenberg number, and the Elasticity number that follow from the nondimensionalization. Round each dimensionless number to three significant figures. Based on the magnitudes of these dimensionless numbers alone, provide a scientifically reasoned classification in the solution as to whether the flow can exhibit elastic turbulence in a suitable geometry, noting any necessary conditions. Express your final numerical answer as a row matrix containing, in order, the Reynolds number, the Weissenberg number, and the Elasticity number. Do not include any units in the final boxed answer.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. All necessary parameters are provided, and they are physically consistent for a microfluidic experiment involving a polymer solution. The task involves standard dimensional analysis of the governing equations of viscoelastic fluid dynamics and the interpretation of the resulting dimensionless numbers, which is a fundamental exercise in the field. Therefore, the problem is valid, and a solution can be constructed.\n\nThe analysis begins with the conservation of linear momentum for a steady, incompressible fluid flow:\n$$\n\\rho (\\mathbf{u} \\cdot \\nabla \\mathbf{u}) = -\\nabla p + \\nabla \\cdot \\boldsymbol{\\tau}\n$$\nHere, $\\rho$ is the fluid density, $\\mathbf{u}$ is the velocity field, $p$ is the pressure, and $\\boldsymbol{\\tau}$ is the extra-stress tensor. For a viscoelastic fluid, this stress tensor comprises both viscous and elastic contributions. The problem provides a total dynamic viscosity $\\eta$, which we will use to characterize the viscous stresses.\n\nWe nondimensionalize the governing equation using the characteristic scales provided: length $L$, velocity $U$, density $\\rho$, viscosity $\\eta$, and polymer relaxation time $\\lambda$. We define dimensionless variables (denoted by a prime) as follows:\n$$\n\\mathbf{u}' = \\frac{\\mathbf{u}}{U}, \\quad \\nabla' = L \\nabla, \\quad p' = \\frac{p}{\\rho U^2}, \\quad \\boldsymbol{\\tau}' = \\frac{\\boldsymbol{\\tau} L}{\\eta U}\n$$\nSubstituting these into the momentum equation and scaling the terms provides insight into the relevant dimensionless groups.\n\nThe inertial term on the left-hand side scales as:\n$$\n|\\rho (\\mathbf{u} \\cdot \\nabla \\mathbf{u})| \\sim \\frac{\\rho U^2}{L}\n$$\nThe viscous stress contribution to the divergence term on the right-hand side scales as:\n$$\n|\\nabla \\cdot \\boldsymbol{\\tau}_{visc}| \\sim \\frac{\\eta U}{L^2}\n$$\nThe first dimensionless number, which compares inertia to viscous stress, is the Reynolds number, $Re$. It is the ratio of the magnitudes of the inertial term to the viscous term:\n$$\nRe = \\frac{\\text{Inertial forces}}{\\text{Viscous forces}} \\sim \\frac{\\rho U^2 / L}{\\eta U / L^2} = \\frac{\\rho U L}{\\eta}\n$$\n\nThe second dimensionless number compares the material's relaxation time, $\\lambda$, to the characteristic time scale of the flow process. The flow time scale is the time it takes for a fluid element to travel the characteristic length $L$ at velocity $U$, which is $t_{flow} = L/U$. The ratio is the Weissenberg number, $Wi$:\n$$\nWi = \\frac{\\text{Relaxation time}}{\\text{Flow time}} = \\frac{\\lambda}{L/U} = \\frac{\\lambda U}{L}\n$$\nThe Weissenberg number quantifies the degree of elastic response in the flow. For $Wi \\gg 1$, the fluid behaves elastically as the deformation rate is much faster than the fluid's ability to relax stress.\n\nThe third dimensionless number compares elastic effects to inertia. This is conventionally given by the Elasticity number, $El$, which is defined as the ratio of the Weissenberg number to the Reynolds number:\n$$\nEl = \\frac{Wi}{Re} = \\frac{\\lambda U / L}{\\rho U L / \\eta} = \\frac{\\lambda \\eta}{\\rho L^2}\n$$\nThis number is independent of the flow velocity $U$ and represents a ratio of material and geometric properties. It compares the viscoelastic time scale of the fluid ($\\lambda$) to the time scale for viscous diffusion of momentum ($\\rho L^2 / \\eta$). A large $El$ indicates that elastic effects are significant compared to inertial effects.\n\nNext, we compute the values of these dimensionless numbers using the provided parameters:\n-   $U = 5.0 \\times 10^{-2}\\ \\text{m}\\,\\text{s}^{-1}$\n-   $L = 1.0 \\times 10^{-4}\\ \\text{m}$\n-   $\\eta = 1.0 \\times 10^{-1}\\ \\text{Pa}\\,\\text{s}$\n-   $\\rho = 1.0 \\times 10^{3}\\ \\text{kg}\\,\\text{m}^{-3}$\n-   $\\lambda = 5.0 \\times 10^{-1}\\ \\text{s}$\n\nThe Reynolds number is:\n$$\nRe = \\frac{\\rho U L}{\\eta} = \\frac{(1.0 \\times 10^{3}) \\times (5.0 \\times 10^{-2}) \\times (1.0 \\times 10^{-4})}{1.0 \\times 10^{-1}} = \\frac{5.0 \\times 10^{-3}}{1.0 \\times 10^{-1}} = 5.0 \\times 10^{-2}\n$$\nRounding to three significant figures, $Re = 5.00 \\times 10^{-2}$.\n\nThe Weissenberg number is:\n$$\nWi = \\frac{\\lambda U}{L} = \\frac(5.0 \\times 10^{-1}) \\times (5.0 \\times 10^{-2})}{1.0 \\times 10^{-4}} = \\frac{2.5 \\times 10^{-2}}{1.0 \\times 10^{-4}} = 2.5 \\times 10^{2}\n$$\nRounding to three significant figures, $Wi = 2.50 \\times 10^{2}$.\n\nThe Elasticity number is:\n$$\nEl = \\frac{Wi}{Re} = \\frac{2.50 \\times 10^{2}}{5.00 \\times 10^{-2}} = 5.0 \\times 10^{3}\n$$\nAlternatively, using its definition:\n$$\nEl = \\frac{\\lambda \\eta}{\\rho L^2} = \\frac{(5.0 \\times 10^{-1}) \\times (1.0 \\times 10^{-1})}{(1.0 \\times 10^{3}) \\times (1.0 \\times 10^{-4})^2} = \\frac{5.0 \\times 10^{-2}}{1.0 \\times 10^{-5}} = 5.0 \\times 10^{3}\n$$\nRounding to three significant figures, $El = 5.00 \\times 10^{3}$.\n\nFinally, we classify the flow regime based on these values. The phenomenon of elastic turbulence is a chaotic flow state that arises in viscoelastic fluids due to purely elastic instabilities, in the absence of significant inertia. The conditions for its occurrence are:\n1.  A very low Reynolds number, typically $Re \\ll 1$. Our calculated value is $Re = 0.05$, which indicates the flow is in the creeping regime where inertial effects are negligible. Classical, inertia-driven turbulence is not possible.\n2.  A high Weissenberg number, typically $Wi \\gg 1$. Our value is $Wi = 250$, indicating that elastic stresses are extremely large compared to viscous stresses. The polymers are stretched significantly by the flow, storing substantial elastic energy.\n3.  A flow geometry with curved streamlines. The problem statement explicitly allows for this possibility. A purely elastic instability, driven by tension in stretched polymers along curved streamlines, can trigger chaotic dynamics under these conditions.\n\nThe calculated dimensionless numbers, $Re \\ll 1$ and $Wi \\gg 1$, are the defining characteristics of the elastic turbulence regime. The very large elasticity number, $El = 5000$, further underscores the overwhelming dominance of elastic effects over inertial ones. Therefore, given a suitable geometry with curvature, the flow is predicted to be in the elastic turbulence regime.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 5.00 \\times 10^{-2} & 2.50 \\times 10^{2} & 5.00 \\times 10^{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "With the conditions for elastic turbulence identified, the next step is to understand how we mathematically model the fluid's response. This exercise explores the critical differences between the elementary Oldroyd-B model and the more physically faithful FENE-P model, focusing on the concept of finite polymer extensibility . By comparing their behavior in strong extensional flows, you will uncover why simple models can predict unphysical stress divergences and how incorporating nonlinear elasticity is essential for capturing the saturation of polymer stretch and the immense storage of elastic energy that fuels the instability.",
            "id": "4084944",
            "problem": "Consider an incompressible viscoelastic fluid modeled by either the Oldroyd-B constitutive equation or the Finite Extensible Nonlinear Elastic-Peterlin (FENE-P) model. The polymer stress is represented via the Kramers expression in terms of the conformation tensor $\\mathbf{A}$, and the evolution of $\\mathbf{A}$ follows an upper-convected derivative. Take a spatially homogeneous, steady, uniaxial extensional flow with velocity gradient $\\nabla \\mathbf{u} = \\mathrm{diag}(\\dot{\\varepsilon}, -\\dot{\\varepsilon}/2, -\\dot{\\varepsilon}/2)$, where $\\dot{\\varepsilon}$ is the constant extension rate. Define the Weissenberg number $\\mathrm{Wi} = \\lambda \\dot{\\varepsilon}$, where $\\lambda$ is the polymer relaxation time, and let $\\eta_p$ be the polymer viscosity coefficient.\n\nFor Oldroyd-B, the governing equations are:\n- Upper-convected derivative: $\\stackrel{\\nabla}{\\mathbf{A}} = -\\dfrac{1}{\\lambda}\\left(\\mathbf{A} - \\mathbf{I}\\right)$, with $\\stackrel{\\nabla}{\\mathbf{A}} = \\partial_t \\mathbf{A} + \\mathbf{u}\\cdot\\nabla \\mathbf{A} - (\\nabla \\mathbf{u})\\mathbf{A} - \\mathbf{A}(\\nabla \\mathbf{u})^{\\top}$.\n- Polymer stress: $\\boldsymbol{\\tau}_p = \\dfrac{\\eta_p}{\\lambda}\\left(\\mathbf{A} - \\mathbf{I}\\right)$.\n\nFor FENE-P, the governing equations are:\n- Upper-convected derivative: $\\stackrel{\\nabla}{\\mathbf{A}} = -\\dfrac{1}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right)$, with $f(\\mathbf{A}) = \\dfrac{1}{1 - \\mathrm{tr}(\\mathbf{A})/b}$ and $b > 0$ the finite extensibility parameter.\n- Polymer stress: $\\boldsymbol{\\tau}_p = \\dfrac{\\eta_p}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right)$.\n\nIn both models, assume a diagonal steady solution $\\mathbf{A} = \\mathrm{diag}(A_{zz}, A_{xx}, A_{yy})$ consistent with the imposed velocity gradient and symmetry. The extensional viscosity is defined from the polymer contribution as $\\eta_E^p = \\dfrac{\\tau_{zz} - \\tau_{xx}}{\\dot{\\varepsilon}}$.\n\nWhich statement best captures how Oldroyd-B and FENE-P predict polymer stress growth in strong extensional flows, and explains the origin of unbounded versus saturated behavior relevant to elastic turbulence and chaotic polymer stretching?\n\nA. In steady uniaxial extension, Oldroyd-B yields $A_{zz} = \\dfrac{1}{1 - 2\\,\\mathrm{Wi}}$ and $A_{xx} = A_{yy} = \\dfrac{1}{1 + \\mathrm{Wi}}$, so $\\eta_E^p$ diverges as $\\mathrm{Wi} \\to 1/2^+$ because the Hookean spring permits unbounded stretch; FENE-P yields $A_{zz} = \\dfrac{1}{f - 2\\,\\mathrm{Wi}}$ and $A_{xx} = A_{yy} = \\dfrac{1}{f + \\mathrm{Wi}}$ with $f = \\dfrac{1}{1 - \\mathrm{tr}(\\mathbf{A})/b}$ that grows as $\\mathrm{tr}(\\mathbf{A}) \\to b$, thereby keeping $\\mathrm{tr}(\\mathbf{A}) < b$ and producing a finite extensional viscosity plateau at large $\\mathrm{Wi}$.\n\nB. Both Oldroyd-B and FENE-P predict divergent extensional stress at large $\\mathrm{Wi}$; in FENE-P the divergence occurs when $\\mathrm{tr}(\\mathbf{A})$ exceeds $b$, which invariably happens as $\\mathrm{Wi} \\to \\infty$, so neither model can saturate the stress.\n\nC. Oldroyd-B predicts bounded extensional stress due to the solvent contribution, whereas FENE-P diverges because the nonlinear spring coefficient $f(\\mathbf{A})$ amplifies stretching without limit in strong extension.\n\nD. Oldroyd-B exhibits divergence only in shear flows and remains bounded in extensional flows for all $\\mathrm{Wi}$, while FENE-P can diverge in extension unless $b$ is taken to be infinite.\n\nSelect the single best option.",
            "solution": "This problem requires a comparison of the Oldroyd-B and FENE-P models in a steady uniaxial extensional flow. We must analyze the steady-state solutions for the conformation tensor $\\mathbf{A}$ for each model to determine their behavior at high Weissenberg numbers.\n\nFor a steady, homogeneous flow, the upper-convected derivative simplifies to $\\stackrel{\\nabla}{\\mathbf{A}} = (\\nabla \\mathbf{u})\\mathbf{A} + \\mathbf{A}(\\nabla \\mathbf{u})^{\\top}$. Given $\\nabla \\mathbf{u} = \\mathrm{diag}(\\dot{\\varepsilon}, -\\dot{\\varepsilon}/2, -\\dot{\\varepsilon}/2)$ and a diagonal conformation tensor $\\mathbf{A} = \\mathrm{diag}(A_{zz}, A_{xx}, A_{yy})$, with $A_{xx}=A_{yy}$ by symmetry.\n\n**1. Analysis of the Oldroyd-B Model**\n\nThe steady-state constitutive equation is:\n$$\n(\\nabla \\mathbf{u})\\mathbf{A} + \\mathbf{A}(\\nabla \\mathbf{u})^{\\top} = \\frac{1}{\\lambda}(\\mathbf{A} - \\mathbf{I})\n$$\nThe diagonal components of this matrix equation give:\n-   zz-component: $2\\dot{\\varepsilon}A_{zz} = \\frac{1}{\\lambda}(A_{zz} - 1)$. Rearranging and substituting $\\mathrm{Wi} = \\lambda \\dot{\\varepsilon}$ gives $(2\\,\\mathrm{Wi} - 1)A_{zz} = -1$, which solves to $A_{zz} = \\frac{1}{1 - 2\\,\\mathrm{Wi}}$.\n-   xx-component: $2(-\\dot{\\varepsilon}/2)A_{xx} = \\frac{1}{\\lambda}(A_{xx} - 1)$. Rearranging gives $(-\\mathrm{Wi} - 1)A_{xx} = -1$, which solves to $A_{xx} = \\frac{1}{1 + \\mathrm{Wi}}$.\n\nFrom the expression for $A_{zz}$, it is clear that as $\\mathrm{Wi} \\to 1/2$ from below, $A_{zz} \\to \\infty$. This implies an infinite polymer stretch and a divergent extensional viscosity $\\eta_E^p$. This unphysical behavior arises because the Oldroyd-B model is based on an idealized Hookean spring, which can extend indefinitely.\n\n**2. Analysis of the FENE-P Model**\n\nThe steady-state constitutive equation is:\n$$\n(\\nabla \\mathbf{u})\\mathbf{A} + \\mathbf{A}(\\nabla \\mathbf{u})^{\\top} = \\frac{1}{\\lambda}(f(\\mathbf{A})\\mathbf{A} - \\mathbf{I}), \\quad \\text{where} \\quad f(\\mathbf{A}) = \\frac{1}{1 - \\mathrm{tr}(\\mathbf{A})/b}\n$$\nThe key feature is the nonlinear function $f(\\mathbf{A})$. As the polymer stretches, the trace of the conformation tensor, $\\mathrm{tr}(\\mathbf{A}) = A_{zz} + 2A_{xx}$, increases. As $\\mathrm{tr}(\\mathbf{A})$ approaches the finite extensibility limit $b$, the denominator of $f(\\mathbf{A})$ approaches zero, causing $f(\\mathbf{A})$ to grow very large. This term acts like a powerful nonlinear spring force that stiffens dramatically upon extension. This prevents $\\mathrm{tr}(\\mathbf{A})$ from ever reaching or exceeding $b$. Consequently, the components of $\\mathbf{A}$, and thus the polymer stress and extensional viscosity, remain bounded and saturate at a finite plateau value at large $\\mathrm{Wi}$. This captures the physical reality that a polymer chain has a finite contour length.\n\n**3. Evaluation of the Options**\n\n-   **Option A:** Correctly provides the derived expressions for $A_{zz}$ and $A_{xx}$ for the Oldroyd-B model and accurately states that the extensional viscosity diverges as $\\mathrm{Wi} \\to 1/2$. It correctly attributes this to the unbounded nature of the Hookean spring. It also correctly describes the FENE-P mechanism: the function $f$ grows to keep $\\mathrm{tr}(\\mathbf{A})  b$, resulting in a finite (saturated) extensional viscosity. The component equations shown for FENE-P are also consistent with our derivation. This statement is accurate.\n-   **Option B:** Incorrect. The FENE-P model is specifically designed to prevent divergent stress by introducing finite extensibility.\n-   **Option C:** Incorrect. The Oldroyd-B model predicts divergent stress in strong extensional flow, not bounded stress.\n-   **Option D:** Incorrect. The Oldroyd-B model's divergence is a classic feature of strong extensional flows, not just shear flows.\n\nTherefore, Option A is the only statement that correctly contrasts the behavior of the two models and explains the underlying physical reasons.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Translating constitutive models into reliable simulations introduces significant computational hurdles, particularly when dealing with chaotic dynamics. This hands-on coding problem tackles a central challenge in computational rheology: maintaining the physical constraints of the polymer conformation tensor, which must remain symmetric and positive-definite . You will implement and contrast a standard, but flawed, explicit time-stepping scheme with a robust, positivity-preserving operator-splitting method, gaining direct experience with the numerical techniques required to build stable and physically meaningful simulations of viscoelastic flows.",
            "id": "4084943",
            "problem": "Consider a spatially homogeneous dilute polymer solution modeled by a conformation tensor $C(t) \\in \\mathbb{R}^{2 \\times 2}$, which represents the second moment of the polymer end-to-end vector and must remain Symmetric Positive Definite (SPD) at all times. In dimensionless form, the Oldroyd-B homogeneous constitutive evolution driven by a prescribed time-dependent velocity gradient is characterized by a linear relaxation of $C$ towards the identity tensor $I$ at rate $1/Wi$, together with affine deformation by the velocity gradient $G(t) \\in \\mathbb{R}^{2 \\times 2}$. The fundamental base for this problem is that $C$ is a covariance-like tensor and must satisfy $v^{\\top} C v > 0$ for every nonzero vector $v$, and that the continuous-time affine deformation $C(t) = M(t) C(0) M(t)^{\\top}$ with $M(t)$ generated by $G(t)$ preserves positive definiteness when $C(0)$ is SPD. Additionally, a relaxation step that updates $C$ towards $I$ via convex combination preserves SPD.\n\nYour task is to design and implement a computational verification of the positivity of $C(t)$ under numerical time integration, and to assess convergence of a positivity-preserving scheme. All quantities in this problem are dimensionless; if angles appear inside trigonometric functions, they must be in radians.\n\nPrescribe the velocity gradient at discrete time $t_k$ as\n$$\nG_k = \\begin{pmatrix}\n0  \\gamma_k \\\\\n-\\gamma_k  s_k\n\\end{pmatrix},\n$$\nwhere\n$$\n\\gamma_k = \\omega \\sin(2\\pi \\phi_k), \\quad s_k = s_0 + \\epsilon \\sin(2\\pi \\psi_k),\n$$\nand $(\\phi_k)$ and $(\\psi_k)$ are sequences generated by the logistic map\n$$\nx_{k+1} = r x_k (1 - x_k),\n$$\nwith $r = 4$ and given seeds $\\phi_0 \\in (0,1)$, $\\psi_0 \\in (0,1)$. This deterministic chaotic source mimics fluctuating stretching typical of elastic turbulence and chaotic polymer stretching.\n\nImplement two numerical time-stepping schemes for the evolution of $C$ over $N$ steps with step size $\\Delta t$:\n1. A naive explicit scheme:\n$$\nC_{k+1}^{\\mathrm{E}} = C_k^{\\mathrm{E}} + \\Delta t \\left( G_k C_k^{\\mathrm{E}} + C_k^{\\mathrm{E}} G_k^{\\top} - \\frac{1}{Wi}\\left( C_k^{\\mathrm{E}} - I \\right) \\right).\n$$\n2. A positivity-preserving operator-splitting scheme based on affine deformation and relaxation:\n$$\nM_k = \\exp\\left(G_k \\Delta t\\right), \\qquad \\alpha = \\exp\\left(-\\frac{\\Delta t}{Wi}\\right),\n$$\n$$\n\\widetilde{C}_{k+1} = M_k \\left( (1 - \\alpha) I + \\alpha \\widetilde{C}_k \\right) M_k^{\\top}.\n$$\nIt is known from the foundational properties that the exact affine deformation update $C \\mapsto M C M^{\\top}$ with $M$ invertible preserves SPD, and that convex relaxation $C \\mapsto (1-\\alpha) I + \\alpha C$ with $\\alpha \\in (0,1)$ preserves SPD. Therefore, their composition preserves SPD when implemented exactly.\n\nVerification tasks:\n- For the explicit scheme, perform eigenvalue checks at each step: compute the smallest eigenvalue $\\lambda_{\\min}(C_k^{\\mathrm{E}})$ using an eigenvalue decomposition for symmetric matrices, and declare a violation if any $\\lambda_{\\min}(C_k^{\\mathrm{E}}) \\leq \\tau$, with tolerance $\\tau = 10^{-12}$ to account for floating-point round-off. If a violation is detected, apply the corrective strategy of eigenvalue clipping for continuation (replace any nonpositive eigenvalue by $\\tau$ and reconstruct $C$), but record that the violation occurred.\n- For the operator-splitting scheme, similarly track $\\lambda_{\\min}(\\widetilde{C}_k)$ and verify that no violations occur with the exact matrix exponential update.\n\nConvergence assessment:\n- For the operator-splitting scheme, compute the final conformation tensor at time $T$ with step size $\\Delta t$ and with step size $\\Delta t/2$ (both starting from the same initial tensor), and report the Frobenius norm of the difference between the two final tensors,\n$$\n\\| \\widetilde{C}^{\\Delta t}(T) - \\widetilde{C}^{\\Delta t/2}(T) \\|_F,\n$$\nwhich should decrease as $\\Delta t$ decreases for a first-order splitting scheme.\n\nImplementation details:\n- Use the given chaotic velocity gradient defined by $(\\phi_k)$ and $(\\psi_k)$ sequences and parameters.\n- Work entirely in $2 \\times 2$ tensor space.\n- Symmetrize numerically computed tensors after each update via $C \\leftarrow \\frac{1}{2}(C + C^{\\top})$ to mitigate asymmetry from floating-point arithmetic.\n- Angles inside $\\sin(\\cdot)$ are measured in radians.\n\nTest suite:\nRun the verification and convergence assessment for the following four parameter sets. In each case, $N$ is the nearest integer to $T/\\Delta t$ and the simulation time is $N \\Delta t$.\n\nCase A (happy path):\n- $Wi = 1.0$, $\\Delta t = 0.01$, $T = 1.0$, $s_0 = 0.5$, $\\epsilon = 0.5$, $\\omega = 2.0$, $\\phi_0 = 0.314159$, $\\psi_0 = 0.271828$, $C(0) = I$.\n\nCase B (large time step, strong stretching, potential explicit violation):\n- $Wi = 2.0$, $\\Delta t = 0.2$, $T = 2.0$, $s_0 = 0.5$, $\\epsilon = 2.0$, $\\omega = 8.0$, $\\phi_0 = 0.123456$, $\\psi_0 = 0.654321$, $C(0) = I$.\n\nCase C (high Weissenberg number, moderate step size):\n- $Wi = 10.0$, $\\Delta t = 0.05$, $T = 1.5$, $s_0 = 0.0$, $\\epsilon = 1.5$, $\\omega = 5.0$, $\\phi_0 = 0.435$, $\\psi_0 = 0.781$, $C(0) = I$.\n\nCase D (near-singular initial condition):\n- $Wi = 1.0$, $\\Delta t = 0.1$, $T = 1.0$, $s_0 = -0.3$, $\\epsilon = 1.0$, $\\omega = 3.0$, $\\phi_0 = 0.9$, $\\psi_0 = 0.4$, $C(0) = \\mathrm{diag}(10^{-8}, 1.0)$.\n\nRequired outputs:\nFor each case, compute and return:\n- A boolean indicating whether the explicit scheme maintained strict positivity (no eigenvalue violations against the tolerance) throughout the simulation.\n- A boolean indicating whether the operator-splitting scheme maintained strict positivity throughout the simulation.\n- A float equal to the Frobenius norm $\\| \\widetilde{C}^{\\Delta t}(T) - \\widetilde{C}^{\\Delta t/2}(T) \\|_F$ for the operator-splitting scheme.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result1,result2,\\dots]$), ordered case-by-case as\n$$\n[\\text{A}_{\\mathrm{explicit}}, \\text{A}_{\\mathrm{split}}, \\text{A}_{\\mathrm{conv}}, \\text{B}_{\\mathrm{explicit}}, \\text{B}_{\\mathrm{split}}, \\text{B}_{\\mathrm{conv}}, \\text{C}_{\\mathrm{explicit}}, \\text{C}_{\\mathrm{split}}, \\text{C}_{\\mathrm{conv}}, \\text{D}_{\\mathrm{explicit}}, \\text{D}_{\\mathrm{split}}, \\text{D}_{\\mathrm{conv}}].\n$$\nAll boolean entries are either the keywords True or False, and all floats are in dimensionless units.",
            "solution": "The problem requires the implementation and validation of numerical schemes for the time evolution of a $2 \\times 2$ symmetric positive definite (SPD) conformation tensor, $C(t)$, in a dilute polymer solution. The governing dynamics are described by the Oldroyd-B model under a spatially homogeneous, time-dependent velocity gradient $G(t)$. The core tasks are to compare a naive explicit scheme against a positivity-preserving operator-splitting scheme and to assess the convergence of the latter.\n\nFirst, the physical model for the evolution of the conformation tensor $C(t)$ is given by the ordinary differential equation:\n$$\n\\frac{dC}{dt} = G(t)C(t) + C(t)G(t)^{\\top} - \\frac{1}{Wi}(C(t) - I)\n$$\nwhere $Wi$ is the Weissenberg number, $I$ is the identity tensor, and $G(t)$ is the velocity gradient. The tensor $C(t)$ must remain SPD for all time $t \\geq 0$ if $C(0)$ is SPD. This physical constraint is challenging to maintain with standard numerical integrators.\n\nThe velocity gradient at discrete time steps $t_k = k \\Delta t$ is prescribed as a stochastically driven rotational and extensional flow:\n$$\nG_k = \\begin{pmatrix} 0  \\gamma_k \\\\ -\\gamma_k  s_k \\end{pmatrix}\n$$\nThe components $\\gamma_k$ and $s_k$ are generated using deterministic chaos to mimic turbulent fluctuations.\n$$\n\\gamma_k = \\omega \\sin(2\\pi \\phi_k), \\quad s_k = s_0 + \\epsilon \\sin(2\\pi \\psi_k)\n$$\nThe sequences $(\\phi_k)$ and $(\\psi_k)$ are derived from the logistic map, $x_{k+1} = r x_k (1 - x_k)$ with $r=4$, which for seeds $\\phi_0, \\psi_0 \\in (0,1)$ generates chaotic sequences within the interval $(0,1)$. This provides a non-trivial, fluctuating driving force for the system. An auxiliary function is designed to generate these sequences for a given number of steps.\n\nTwo numerical schemes are implemented and compared.\n\n1.  **Naive Explicit Scheme (Forward Euler)**:\n    This scheme discretizes the governing ODE using a first-order forward difference:\n    $$\n    C_{k+1}^{\\mathrm{E}} = C_k^{\\mathrm{E}} + \\Delta t \\left( G_k C_k^{\\mathrm{E}} + C_k^{\\mathrm{E}} G_k^{\\top} - \\frac{1}{Wi}\\left( C_k^{\\mathrm{E}} - I \\right) \\right)\n    $$\n    This method is simple to implement but is not guaranteed to preserve the SPD property of $C$, especially for large time steps $\\Delta t$ or strong flows (large norms of $G_k$). To verify its performance, we compute the eigenvalues of the resulting tensor $C_{k+1}^{\\mathrm{E}}$ at each step. A violation of positivity is declared if the smallest eigenvalue, $\\lambda_{\\min}(C_{k+1}^{\\mathrm{E}})$, falls below a small positive tolerance $\\tau = 10^{-12}$ (to account for floating-point precision). If a violation occurs, the boolean flag for positivity is set to `False`. For the simulation to continue, a corrective clipping procedure is applied: the tensor is diagonalized, any non-positive eigenvalue is replaced by $\\tau$, and the tensor is reconstructed. This allows the simulation to complete while recording that the scheme failed to preserve positivity.\n\n2.  **Positivity-Preserving Operator-Splitting Scheme**:\n    This scheme is based on splitting the governing ODE into two sub-problems, each of which can be solved exactly and preserves the SPD property.\n    (a) Relaxation: $\\frac{dC}{dt} = - \\frac{1}{Wi}(C - I)$\n    (b) Deformation: $\\frac{dC}{dt} = G(t)C(t) + C(t)G(t)^{\\top}$\n    The exact solution to (a) over a time step $\\Delta t$ is $C(\\Delta t) = (1 - \\alpha)I + \\alpha C(0)$, where $\\alpha = \\exp(-\\Delta t/Wi)$. This is a convex combination of two SPD tensors ($I$ and $C(0)$) and is therefore SPD.\n    The exact solution to (b) over $\\Delta t$ (assuming $G$ is constant, $G_k$) is $C(\\Delta t) = M_k C(0) M_k^{\\top}$, where $M_k = \\exp\\left(G_k \\Delta t\\right)$ is the matrix exponential. This congruence transformation by an invertible matrix $M_k$ preserves the SPD property.\n    \n    The splitting scheme composes these exact solutions:\n    $$\n    \\widetilde{C}_{k+1} = M_k \\left( (1 - \\alpha) I + \\alpha \\widetilde{C}_k \\right) M_k^{\\top}\n    $$\n    This corresponds to a first-order Lie-Trotter splitting (relaxation followed by deformation). By construction, this scheme mathematically guarantees that if $\\widetilde{C}_k$ is SPD, then $\\widetilde{C}_{k+1}$ will also be SPD. The implementation uses `scipy.linalg.expm` to compute the matrix exponential. As with the explicit scheme, the smallest eigenvalue is monitored at each step to numerically verify this property.\n\nA crucial implementation detail for both schemes is the enforcement of symmetry. After each update step, the tensor $C$ is symmetrized via the operation $C \\leftarrow \\frac{1}{2}(C + C^{\\top})$ to mitigate the accumulation of numerical floating-point errors that can break symmetry.\n\n**Convergence Assessment**:\nThe temporal convergence of the operator-splitting scheme is assessed. This is a first-order scheme, so the error should be proportional to $\\Delta t$. To verify this, for each test case, we run two simulations up to a \"target\" time $T$.\n-   A coarse simulation with time step $\\Delta t_1 = \\Delta t$ for $N_1 = \\text{round}(T/\\Delta t)$ steps, yielding a final tensor $\\widetilde{C}^{\\Delta t}(T_{eff})$.\n-   A fine simulation with time step $\\Delta t_2 = \\Delta t_1/2$ for $N_2 = 2 N_1$ steps, yielding $\\widetilde{C}^{\\Delta t/2}(T_{eff})$.\nBoth simulations run for the same total effective duration $T_{eff} = N_1 \\Delta t_1$. The difference between the final tensors is quantified using the Frobenius norm:\n$$\n\\text{Error} = \\| \\widetilde{C}^{\\Delta t}(T_{eff}) - \\widetilde{C}^{\\Delta t/2}(T_{eff}) \\|_F\n$$\nThis error metric is computed for each parameter case.\n\nThe overall algorithm is structured to iterate through each of the four test cases. For each case, it runs the explicit simulation, the coarse splitting simulation, and the fine splitting simulation. It then collects the three required outputs: the positivity-maintained boolean for the explicit scheme, the positivity-maintained boolean for the splitting scheme, and the Frobenius norm for convergence assessment. These results are aggregated into a single list for the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to run the verification and convergence assessment for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Happy path\n        {'name': 'A', 'Wi': 1.0, 'dt': 0.01, 'T': 1.0, 's0': 0.5, 'eps': 0.5, 'omega': 2.0, \n         'phi0': 0.314159, 'psi0': 0.271828, 'C0': np.identity(2)},\n        # Case B: Large time step, strong stretching\n        {'name': 'B', 'Wi': 2.0, 'dt': 0.2, 'T': 2.0, 's0': 0.5, 'eps': 2.0, 'omega': 8.0, \n         'phi0': 0.123456, 'psi0': 0.654321, 'C0': np.identity(2)},\n        # Case C: High Weissenberg number\n        {'name': 'C', 'Wi': 10.0, 'dt': 0.05, 'T': 1.5, 's0': 0.0, 'eps': 1.5, 'omega': 5.0, \n         'phi0': 0.435, 'psi0': 0.781, 'C0': np.identity(2)},\n        # Case D: Near-singular initial condition\n        {'name': 'D', 'Wi': 1.0, 'dt': 0.1, 'T': 1.0, 's0': -0.3, 'eps': 1.0, 'omega': 3.0, \n         'phi0': 0.9, 'psi0': 0.4, 'C0': np.diag([1e-8, 1.0])}\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = run_case(case)\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef logistic_map_sequence(seed, num_steps):\n    \"\"\"Generates a sequence of values from the logistic map x_k+1 = 4*x_k*(1-x_k).\"\"\"\n    seq = np.zeros(num_steps)\n    x = seed\n    for i in range(num_steps):\n        seq[i] = x\n        x = 4.0 * x * (1.0 - x)\n    return seq\n\ndef run_case(params):\n    \"\"\"\n    Runs both schemes for a given parameter set and computes the required outputs.\n    \"\"\"\n    Wi, dt, T = params['Wi'], params['dt'], params['T']\n    s0, eps, omega = params['s0'], params['eps'], params['omega']\n    phi0, psi0, C0 = params['phi0'], params['psi0'], params['C0']\n    \n    n_steps = int(round(T / dt))\n    tau = 1e-12\n    I = np.identity(2)\n\n    # Run Explicit Scheme\n    explicit_positivity_maintained = run_explicit_scheme(n_steps, dt, Wi, s0, eps, omega, phi0, psi0, C0, I, tau)\n    \n    # Run Operator-Splitting Scheme for positivity check and convergence\n    C_coarse, split_positivity_maintained = run_split_scheme(n_steps, dt, Wi, s0, eps, omega, phi0, psi0, C0, I, tau)\n    \n    n_steps_fine = 2 * n_steps\n    dt_fine = dt / 2.0\n    C_fine, _ = run_split_scheme(n_steps_fine, dt_fine, Wi, s0, eps, omega, phi0, psi0, C0, I, tau)\n    \n    # Convergence Assessment\n    conv_norm = np.linalg.norm(C_coarse - C_fine, 'fro')\n\n    return explicit_positivity_maintained, split_positivity_maintained, conv_norm\n\ndef run_explicit_scheme(n_steps, dt, Wi, s0, eps, omega, phi0, psi0, C0, I, tau):\n    \"\"\"Simulates the conformation tensor evolution using the explicit Euler scheme.\"\"\"\n    C = np.copy(C0)\n    positivity_maintained = True\n    \n    phi_seq = logistic_map_sequence(phi0, n_steps)\n    psi_seq = logistic_map_sequence(psi0, n_steps)\n\n    for k in range(n_steps):\n        gamma_k = omega * np.sin(2 * np.pi * phi_seq[k])\n        s_k = s0 + eps * np.sin(2 * np.pi * psi_seq[k])\n        Gk = np.array([[0.0, gamma_k], [-gamma_k, s_k]])\n        \n        dCdt = Gk @ C + C @ Gk.T - (1.0 / Wi) * (C - I)\n        C += dt * dCdt\n        \n        C = 0.5 * (C + C.T)  # Symmetrize\n        \n        evals, evecs = np.linalg.eigh(C)\n        if np.min(evals) = tau:\n            positivity_maintained = False\n            # Apply eigenvalue clipping for continuation\n            evals[evals = tau] = tau\n            C = evecs @ np.diag(evals) @ evecs.T\n            C = 0.5 * (C + C.T) # Re-symmetrize after reconstruction\n\n    return positivity_maintained\n\ndef run_split_scheme(n_steps, dt, Wi, s0, eps, omega, phi0, psi0, C0, I, tau):\n    \"\"\"Simulates the conformation tensor evolution using the operator-splitting scheme.\"\"\"\n    C = np.copy(C0)\n    positivity_maintained = True\n    \n    phi_seq = logistic_map_sequence(phi0, n_steps)\n    psi_seq = logistic_map_sequence(psi0, n_steps)\n    \n    alpha = np.exp(-dt / Wi)\n\n    for k in range(n_steps):\n        gamma_k = omega * np.sin(2 * np.pi * phi_seq[k])\n        s_k = s0 + eps * np.sin(2 * np.pi * psi_seq[k])\n        Gk = np.array([[0.0, gamma_k], [-gamma_k, s_k]])\n        \n        # Relaxation step\n        C_relaxed = (1.0 - alpha) * I + alpha * C\n        \n        # Deformation step\n        Mk = expm(Gk * dt)\n        C = Mk @ C_relaxed @ Mk.T\n        \n        C = 0.5 * (C + C.T)  # Symmetrize\n        \n        evals = np.linalg.eigh(C)[0]\n        if np.min(evals) = tau:\n            positivity_maintained = False\n            # No clipping required, just record the violation\n            \n    return C, positivity_maintained\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}