{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a foundational analysis of the FENE-P model's behavior in a steady, purely straining flow. Analyzing the model in planar extensional flow is a classic method to probe the limits of polymer extensibility. By deriving the steady-state eigenvalues of the conformation tensor, you will directly engage with the self-consistency condition that arises from the model's non-linear feedback loop and gain a concrete understanding of how finite extensibility manifests as a mathematical constraint .",
            "id": "4106661",
            "problem": "Consider a dilute polymer solution modeled by the Finitely Extensible Nonlinear Elastic-Peterlin (FENE-P) constitutive equation. Let the polymer configuration be described by the symmetric, positive-definite conformation tensor $\\boldsymbol{A}(t)$, whose evolution follows the upper-convected derivative definition from kinetic dumbbell theory and a finite extensibility closure. Specifically, the evolution is governed by\n$$\n\\overset{\\triangledown}{\\boldsymbol{A}} \\equiv \\frac{\\mathrm{D}\\boldsymbol{A}}{\\mathrm{D}t} - \\boldsymbol{L}\\cdot\\boldsymbol{A} - \\boldsymbol{A}\\cdot\\boldsymbol{L}^{\\top} = -\\frac{1}{\\lambda}\\left( f(\\operatorname{tr}\\boldsymbol{A})\\,\\boldsymbol{A} - \\boldsymbol{I} \\right),\n$$\nwhere $\\boldsymbol{L} = \\nabla \\boldsymbol{u}$ is the velocity gradient tensor, $\\lambda$ is the polymer relaxation time, and the finite extensibility factor is\n$$\nf(\\operatorname{tr}\\boldsymbol{A}) = \\frac{b - 3}{\\,b - \\operatorname{tr}\\boldsymbol{A}\\,},\n$$\nwith $b > 3$ the dimensionless finite extensibility parameter. Consider a spatially homogeneous, steady, planar extensional flow with constant extension rate $\\kappa$ along the $x$-axis and equal compression along the $y$-axis, with no deformation along the $z$-axis, so that\n$$\n\\boldsymbol{L} = \\mathrm{diag}\\!\\left(\\kappa,\\,-\\kappa,\\,0\\right).\n$$\nAssume the initial state is isotropic, $\\boldsymbol{A}(t=0) = \\boldsymbol{I}$, and analyze the steady state $\\overset{\\triangledown}{\\boldsymbol{A}} = \\boldsymbol{0}$. Using only the fundamental definitions above and first-principles reasoning, derive the steady-state self-consistency condition for the finite extensibility factor $f$ and the corresponding expressions for the eigenvalues of $\\boldsymbol{A}$. Then, for the parameter values $b = 50$ and Weissenberg number (Wi) defined by $\\mathrm{Wi} = \\lambda \\kappa = 0.6$, compute the principal (largest) steady-state eigenvalue of $\\boldsymbol{A}$. Round your answer to four significant figures and report it as a dimensionless number with no units.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation for Conformation Tensor $\\boldsymbol{A}$**:\n  $$\n  \\overset{\\triangledown}{\\boldsymbol{A}} \\equiv \\frac{\\mathrm{D}\\boldsymbol{A}}{\\mathrm{D}t} - \\boldsymbol{L}\\cdot\\boldsymbol{A} - \\boldsymbol{A}\\cdot\\boldsymbol{L}^{\\top} = -\\frac{1}{\\lambda}\\left( f(\\operatorname{tr}\\boldsymbol{A})\\,\\boldsymbol{A} - \\boldsymbol{I} \\right)\n  $$\n- **Finite Extensibility Factor $f(\\operatorname{tr}\\boldsymbol{A})$**:\n  $$\n  f(\\operatorname{tr}\\boldsymbol{A}) = \\frac{b - 3}{\\,b - \\operatorname{tr}\\boldsymbol{A}\\,}\n  $$\n- **Finite Extensibility Parameter**: $b > 3$.\n- **Flow Field**: Steady, planar extensional flow.\n- **Velocity Gradient Tensor $\\boldsymbol{L}$**:\n  $$\n  \\boldsymbol{L} = \\mathrm{diag}\\!\\left(\\kappa,\\,-\\kappa,\\,0\\right)\n  $$\n- **Initial Condition**: $\\boldsymbol{A}(t=0) = \\boldsymbol{I}$.\n- **Analysis Condition**: Steady state, where $\\overset{\\triangledown}{\\boldsymbol{A}} = \\boldsymbol{0}$.\n- **Numerical Parameters**: $b = 50$, Weissenberg number $\\mathrm{Wi} = \\lambda \\kappa = 0.6$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem describes the FENE-P model, a standard and well-established constitutive model in the field of computational complex fluids and rheology. The governing equations and definitions are presented in their conventional forms. The analysis of steady planar extensional flow is a fundamental exercise in this field. The problem is scientifically sound.\n2.  **Well-Posed**: The problem is well-posed. It provides all necessary equations, boundary conditions (in the form of a specified flow field), and parameters to determine a unique, stable, and meaningful steady-state solution for the conformation tensor.\n3.  **Objective**: The problem is stated using precise, formal mathematical and physical language, free of subjective or ambiguous terminology.\n4.  **Complete and Consistent**: The problem is self-contained. The provided information is sufficient and consistent for solving for the eigenvalues of the conformation tensor.\n5.  **Feasible**: The parameter values ($b=50$, $\\mathrm{Wi}=0.6$) are physically realistic for polymer solutions.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A solution will be provided.\n\n### Solution Derivation\n\nThe analysis begins from the steady-state assumption, $\\overset{\\triangledown}{\\boldsymbol{A}} = \\boldsymbol{0}$. Substituting this into the governing equation yields:\n$$\n\\boldsymbol{0} = \\frac{\\mathrm{D}\\boldsymbol{A}}{\\mathrm{D}t} - \\boldsymbol{L}\\cdot\\boldsymbol{A} - \\boldsymbol{A}\\cdot\\boldsymbol{L}^{\\top} = -\\frac{1}{\\lambda}\\left( f(\\operatorname{tr}\\boldsymbol{A})\\,\\boldsymbol{A} - \\boldsymbol{I} \\right)\n$$\nwhere $f$ is used as a shorthand for $f(\\operatorname{tr}\\boldsymbol{A})$. Rearranging the terms, we get the steady-state algebraic equation for the conformation tensor $\\boldsymbol{A}$:\n$$\n\\boldsymbol{L}\\cdot\\boldsymbol{A} + \\boldsymbol{A}\\cdot\\boldsymbol{L}^{\\top} = \\frac{1}{\\lambda}\\left( f\\boldsymbol{A} - \\boldsymbol{I} \\right)\n$$\nThe velocity gradient tensor is given as $\\boldsymbol{L} = \\mathrm{diag}(\\kappa, -\\kappa, 0)$. Since $\\boldsymbol{L}$ is a diagonal matrix, its transpose is equal to itself, i.e., $\\boldsymbol{L}^{\\top} = \\boldsymbol{L}$. The equation becomes:\n$$\n\\boldsymbol{L}\\cdot\\boldsymbol{A} + \\boldsymbol{A}\\cdot\\boldsymbol{L} = \\frac{1}{\\lambda}\\left( f\\boldsymbol{A} - \\boldsymbol{I} \\right)\n$$\nThe conformation tensor $\\boldsymbol{A}$ is symmetric. Let's analyze the components of this matrix equation. For the off-diagonal components $A_{ij}$ where $i \\neq j$:\n$$\n(\\boldsymbol{L}\\cdot\\boldsymbol{A} + \\boldsymbol{A}\\cdot\\boldsymbol{L})_{ij} = \\sum_{k} L_{ik}A_{kj} + \\sum_{k} A_{ik}L_{kj}\n$$\nSince $\\boldsymbol{L}$ is diagonal, $L_{ik} = L_{ii}\\delta_{ik}$. The expression simplifies to:\n$$\n(L_{ii} + L_{jj})A_{ij} = \\frac{1}{\\lambda} (f A_{ij} - \\delta_{ij})\n$$\nFor off-diagonal components, $\\delta_{ij} = 0$.\n- For $(i, j) = (1, 2)$: $(L_{11} + L_{22})A_{12} = (\\kappa - \\kappa)A_{12} = 0 = \\frac{f}{\\lambda}A_{12}$. As $f > 0$ and $\\lambda > 0$, we must have $A_{12} = 0$.\n- For $(i, j) = (1, 3)$: $(L_{11} + L_{33})A_{13} = (\\kappa + 0)A_{13} = \\kappa A_{13} = \\frac{f}{\\lambda}A_{13}$. This implies $(\\kappa - f/\\lambda)A_{13} = 0$.\n- For $(i, j) = (2, 3)$: $(L_{22} + L_{33})A_{23} = (-\\kappa + 0)A_{23} = -\\kappa A_{23} = \\frac{f}{\\lambda}A_{23}$. This implies $(-\\kappa - f/\\lambda)A_{23} = 0$. Since $\\kappa > 0$, $\\lambda > 0$, and $f > 0$ (as $\\operatorname{tr}\\boldsymbol{A} < b$), the term $(-\\kappa - f/\\lambda)$ is strictly negative, forcing $A_{23} = 0$.\n\nRegarding $A_{13}$, we must have $A_{13}=0$ or $\\kappa = f/\\lambda$. If $\\kappa=f/\\lambda$, then $\\mathrm{Wi} = f$. However, as will be shown, one of the eigenvalues of $\\boldsymbol{A}$ is given by $(f-2\\mathrm{Wi})^{-1}$. If $\\mathrm{Wi}=f$, this would become $(f-2f)^{-1} = -1/f < 0$, which violates the requirement that $\\boldsymbol{A}$ be positive-definite. Thus, the only physically valid solution requires $A_{13}=0$. Consequently, the conformation tensor $\\boldsymbol{A}$ must be diagonal at steady state for this flow. Let $\\boldsymbol{A} = \\mathrm{diag}(A_{11}, A_{22}, A_{33})$. The diagonal entries $A_{ii}$ are the eigenvalues of $\\boldsymbol{A}$.\n\nNow we analyze the diagonal components of the matrix equation:\n$$\n(L_{ii} + L_{ii})A_{ii} = 2L_{ii}A_{ii} = \\frac{1}{\\lambda} (f A_{ii} - 1)\n$$\nWe solve for $A_{ii}$ for each component:\n- For $i=1$: $2L_{11}A_{11} = 2\\kappa A_{11} = \\frac{1}{\\lambda}(fA_{11}-1)$. Rearranging gives $2\\lambda\\kappa A_{11} = fA_{11}-1$. Using the Weissenberg number, $\\mathrm{Wi} = \\lambda\\kappa$, this becomes $2\\mathrm{Wi}A_{11} = fA_{11}-1$, which yields $A_{11}(f-2\\mathrm{Wi}) = 1$. So, the first eigenvalue is $A_{11} = \\frac{1}{f-2\\mathrm{Wi}}$.\n- For $i=2$: $2L_{22}A_{22} = -2\\kappa A_{22} = \\frac{1}{\\lambda}(fA_{22}-1)$. This gives $-2\\mathrm{Wi}A_{22} = fA_{22}-1$, so $A_{22}(f+2\\mathrm{Wi}) = 1$. The second eigenvalue is $A_{22} = \\frac{1}{f+2\\mathrm{Wi}}$.\n- For $i=3$: $2L_{33}A_{33} = 0 = \\frac{1}{\\lambda}(fA_{33}-1)$. This implies $fA_{33}-1=0$. The third eigenvalue is $A_{33} = \\frac{1}{f}$.\n\nThe eigenvalues of $\\boldsymbol{A}$ are:\n$$\n\\lambda_A^{(1)} = A_{11} = \\frac{1}{f - 2\\mathrm{Wi}}, \\quad \\lambda_A^{(2)} = A_{22} = \\frac{1}{f + 2\\mathrm{Wi}}, \\quad \\lambda_A^{(3)} = A_{33} = \\frac{1}{f}\n$$\nThe trace of $\\boldsymbol{A}$ is the sum of its eigenvalues:\n$$\n\\operatorname{tr}\\boldsymbol{A} = A_{11} + A_{22} + A_{33} = \\frac{1}{f-2\\mathrm{Wi}} + \\frac{1}{f+2\\mathrm{Wi}} + \\frac{1}{f}\n$$\nCombining the first two terms:\n$$\n\\operatorname{tr}\\boldsymbol{A} = \\frac{(f+2\\mathrm{Wi}) + (f-2\\mathrm{Wi})}{(f-2\\mathrm{Wi})(f+2\\mathrm{Wi})} + \\frac{1}{f} = \\frac{2f}{f^2 - (2\\mathrm{Wi})^2} + \\frac{1}{f}\n$$\nThe definition of $f$ provides a second relationship for $\\operatorname{tr}\\boldsymbol{A}$:\n$$\nf = \\frac{b-3}{b-\\operatorname{tr}\\boldsymbol{A}} \\implies f(b-\\operatorname{tr}\\boldsymbol{A}) = b-3 \\implies b f - f\\operatorname{tr}\\boldsymbol{A} = b-3 \\implies \\operatorname{tr}\\boldsymbol{A} = b - \\frac{b-3}{f}\n$$\nEquating the two expressions for $\\operatorname{tr}\\boldsymbol{A}$ gives the self-consistency condition for $f$:\n$$\nb - \\frac{b-3}{f} = \\frac{2f}{f^2 - 4\\mathrm{Wi}^2} + \\frac{1}{f}\n$$\nRearranging this equation, we obtain the required self-consistency condition:\n$$\nb - \\frac{b-2}{f} = \\frac{2f}{f^2 - 4\\mathrm{Wi}^2}\n$$\nNow, we substitute the given numerical values: $b=50$ and $\\mathrm{Wi}=0.6$.\n$$\n50 - \\frac{50-2}{f} = \\frac{2f}{f^2 - 4(0.6)^2} \\implies 50 - \\frac{48}{f} = \\frac{2f}{f^2 - 1.44}\n$$\nTo solve for $f$, we multiply by $f(f^2 - 1.44)$ to clear denominators (assuming $f \\neq 0$ and $f^2 \\neq 1.44$):\n$$\n(50f - 48)(f^2 - 1.44) = 2f^2\n$$\n$$\n50f^3 - 50(1.44)f - 48f^2 + 48(1.44) = 2f^2\n$$\n$$\n50f^3 - 72f - 48f^2 + 69.12 = 2f^2\n$$\nThis simplifies to the cubic equation:\n$$\n50f^3 - 50f^2 - 72f + 69.12 = 0\n$$\nFor the eigenvalues of $\\boldsymbol{A}$ to be positive, we need $f > 2\\mathrm{Wi} = 2(0.6) = 1.2$. We must find the root of the cubic equation that satisfies this condition. Numerical solution (e.g., using the Newton-Raphson method) yields a single physically relevant root in this region:\n$$\nf \\approx 1.28223\n$$\nThe problem asks for the principal (largest) steady-state eigenvalue of $\\boldsymbol{A}$. Comparing the denominators of the eigenvalues, we have $f-2\\mathrm{Wi} < f < f+2\\mathrm{Wi}$. Since all denominators are positive, taking the reciprocal reverses the inequalities:\n$$\n\\frac{1}{f-2\\mathrm{Wi}} > \\frac{1}{f} > \\frac{1}{f+2\\mathrm{Wi}}\n$$\nThus, the principal eigenvalue is $\\lambda_A^{(\\text{principal})} = A_{11}$.\nSubstituting the values of $f$ and $\\mathrm{Wi}$:\n$$\n\\lambda_A^{(\\text{principal})} = \\frac{1}{f - 2\\mathrm{Wi}} \\approx \\frac{1}{1.28223 - 1.2} = \\frac{1}{0.08223} \\approx 12.161\n$$\nRounding to four significant figures, the principal eigenvalue is $12.16$.",
            "answer": "$$\n\\boxed{12.16}\n$$"
        },
        {
            "introduction": "Moving from steady-state analysis to transient dynamics is a critical step in modeling complex fluids. This practice challenges you to simulate the start-up of uniaxial extensional flow, a common rheological test, for both the FENE-P and FENE-CR models. You will derive the governing ordinary differential equations from first principles and implement a numerical solution to compute the time-dependent extensional viscosity, thereby directly comparing the distinct predictions of these two important closures .",
            "id": "4106734",
            "problem": "Consider a homogeneous start-up of uniaxial extensional flow of an incompressible viscoelastic fluid modeled by either the Finitely Extensible Nonlinear Elastic - Peterlin (FENE-P) model or the Finitely Extensible Nonlinear Elastic - Chilcott–Rallison (FENE-CR) model. The flow is turned on at time $t=0$ with constant extensional rate $\\dot{\\epsilon}>0$, and the fluid microstructure is initially at equilibrium. The task is to derive from first principles the ordinary differential equation governing the evolution of the polymer conformation tensor and to compute the time-dependent extensional viscosity. Implement the resulting equations in a program and evaluate a specified metric for a given test suite.\n\nUse the following fundamental base and core definitions:\n\n- The polymer microstructure is described by the positive-definite conformation tensor $\\mathbf{A}(t)$, with initial condition $\\mathbf{A}(0)=\\mathbf{I}$, where $\\mathbf{I}$ is the identity tensor.\n- The upper-convected derivative of a tensor $\\mathbf{A}(t)$ in a spatially homogeneous flow with velocity gradient $\\nabla \\mathbf{v}$ is defined as\n$$\n\\overset{\\triangledown}{\\mathbf{A}} = \\frac{d \\mathbf{A}}{dt} - (\\nabla \\mathbf{v})\\cdot \\mathbf{A} - \\mathbf{A}\\cdot \\left(\\nabla \\mathbf{v}\\right)^{\\mathsf{T}}.\n$$\n- The uniaxial extensional flow is characterized by the constant velocity gradient\n$$\n\\nabla \\mathbf{v} = \\boldsymbol{\\kappa} = \\mathrm{diag}\\!\\left(\\dot{\\epsilon}, -\\frac{\\dot{\\epsilon}}{2}, -\\frac{\\dot{\\epsilon}}{2}\\right),\n$$\nso that $\\mathbf{D} = \\frac{1}{2}\\left(\\nabla \\mathbf{v} + \\left(\\nabla \\mathbf{v}\\right)^{\\mathsf{T}}\\right) = \\boldsymbol{\\kappa}$.\n- The Peterlin function $f$ for finitely extensible chains is defined as\n$$\nf(\\mathbf{A}) = \\frac{L^2}{L^2 - \\mathrm{tr}(\\mathbf{A})},\n$$\nwith finite extensibility parameter $L^2>3$ and $\\mathrm{tr}(\\mathbf{A}) = A_{11}+A_{22}+A_{33}$.\n- For both FENE-P and FENE-CR, the conformation tensor evolves according to\n$$\n\\overset{\\triangledown}{\\mathbf{A}} = -\\frac{1}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right),\n$$\nwhere $\\lambda>0$ is the polymer relaxation time.\n- The polymer extra stress is given by Kramers expression with the respective closure:\n  - For FENE-P: \n  $$\n  \\boldsymbol{\\tau}_p = \\frac{\\eta_p}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right),\n  $$\n  - For FENE-CR:\n  $$\n  \\boldsymbol{\\tau}_p = \\frac{\\eta_p}{\\lambda}\\left(\\mathbf{A} - \\mathbf{I}\\right),\n  $$\n  where $\\eta_p>0$ is the polymeric viscosity contribution.\n- The solvent (Newtonian) stress is\n$$\n\\boldsymbol{\\tau}_s = 2\\eta_s \\mathbf{D} = 2\\eta_s\\,\\boldsymbol{\\kappa},\n$$\nwith solvent viscosity $\\eta_s>0$, so the total Cauchy stress is $\\boldsymbol{\\sigma} = -p\\mathbf{I} + \\boldsymbol{\\tau}_s + \\boldsymbol{\\tau}_p$, where $p$ is the pressure (which cancels in the extensional viscosity).\n\nDefine the Weissenberg number $Wi = \\lambda \\dot{\\epsilon}$ and nondimensional time $t^\\star = t/\\lambda$. Denote the solvent-to-total viscosity ratio $\\beta = \\eta_s/(\\eta_s+\\eta_p)$ and the zero-shear total viscosity $\\eta_0 = \\eta_s + \\eta_p$. The uniaxial extensional viscosity is defined as\n$$\n\\eta_E(t) = \\frac{\\sigma_{11}(t) - \\frac{1}{2}\\left(\\sigma_{22}(t) + \\sigma_{33}(t)\\right)}{\\dot{\\epsilon}},\n$$\nand the dimensionless extensional viscosity ratio (Trouton ratio normalized by $\\eta_0$) is\n$$\n\\mathrm{TR}(t^\\star) = \\frac{\\eta_E(t)}{\\eta_0}.\n$$\n\nTask requirements:\n\n1. Starting from the listed fundamental definitions, derive the coupled ordinary differential equations for the diagonal components $A_{11}(t^\\star)$, $A_{22}(t^\\star)$, and $A_{33}(t^\\star)$ under the given $\\boldsymbol{\\kappa}$, expressed in nondimensional time $t^\\star$. The derivation must use the upper-convected derivative and the Peterlin function without invoking any shortcut formulas beyond those in the fundamental base.\n2. Express $\\mathrm{TR}(t^\\star)$ in terms of $\\beta$, $Wi$, the model choice (FENE-P or FENE-CR), and the evolving conformation components $A_{ii}(t^\\star)$, using the definitions of $\\boldsymbol{\\tau}_p$ and $\\boldsymbol{\\tau}_s$.\n3. Implement a program that:\n   - Integrates the derived system from $t^\\star=0$ to $t^\\star=t^\\star_{\\text{end}}$ for each test case,\n   - Evaluates $\\mathrm{TR}(t^\\star)$ over the integration interval,\n   - Returns, for each test case, the maximum value of $\\mathrm{TR}(t^\\star)$ attained on $[0, t^\\star_{\\text{end}}]$.\n4. Finite extensibility constraint: enforce that $\\mathrm{tr}(\\mathbf{A})<L^2$ throughout integration. If $\\mathrm{tr}(\\mathbf{A})$ approaches $L^2$, terminate integration just before violation.\n5. Angles are not used. All quantities are dimensionless; no physical units are required.\n6. Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots,r_n]$), where each $r_k$ is the maximum $\\mathrm{TR}$ value (a float) for the $k$-th test case.\n\nTest suite:\n\nUse the following six test cases, each specified by model type, $Wi$, $L^2$, $\\beta$, and $t^\\star_{\\text{end}}$:\n\n- Case $1$: FENE-P, $Wi=0.5$, $L^2=100$, $\\beta=0.2$, $t^\\star_{\\text{end}}=4$.\n- Case $2$: FENE-CR, $Wi=0.5$, $L^2=100$, $\\beta=0.2$, $t^\\star_{\\text{end}}=4$.\n- Case $3$: FENE-P, $Wi=2.0$, $L^2=10.0$, $\\beta=0.1$, $t^\\star_{\\text{end}}=1.0$.\n- Case $4$: FENE-CR, $Wi=2.0$, $L^2=10.0$, $\\beta=0.1$, $t^\\star_{\\text{end}}=1.0$.\n- Case $5$: FENE-P, $Wi=0.3$, $L^2=10^6$, $\\beta=0.5$, $t^\\star_{\\text{end}}=20.0$.\n- Case $6$: FENE-P, $Wi=0.1$, $L^2=3.3$, $\\beta=0.3$, $t^\\star_{\\text{end}}=10.0$.\n\nYour program must be self-contained, require no input, and strictly follow the final output format described above.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in established principles of non-Newtonian fluid mechanics, specifically the FENE-P and FENE-CR constitutive models. All definitions, parameters, and constraints are provided, rendering the problem self-contained, well-posed, and objective. The task requires a rigorous derivation from first principles followed by a numerical implementation, which is a standard exercise in computational rheology. There are no contradictions, ambiguities, or factual inaccuracies.\n\nThe solution proceeds in three parts: first, the derivation of the governing ordinary differential equations (ODEs); second, the derivation of the expression for the dimensionless extensional viscosity; and third, an overview of the numerical implementation.\n\n**1. Derivation of the governing ODEs**\n\nThe evolution of the conformation tensor $\\mathbf{A}$ is given by the equation:\n$$\n\\overset{\\triangledown}{\\mathbf{A}} = -\\frac{1}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right)\n$$\nwhere $\\overset{\\triangledown}{\\mathbf{A}}$ is the upper-convected derivative:\n$$\n\\overset{\\triangledown}{\\mathbf{A}} = \\frac{d \\mathbf{A}}{dt} - (\\nabla \\mathbf{v})\\cdot \\mathbf{A} - \\mathbf{A}\\cdot \\left(\\nabla \\mathbf{v}\\right)^{\\mathsf{T}}\n$$\nThe flow is a homogeneous uniaxial extension, characterized by the constant velocity gradient $\\nabla \\mathbf{v} = \\boldsymbol{\\kappa} = \\mathrm{diag}\\!\\left(\\dot{\\epsilon}, -\\frac{\\dot{\\epsilon}}{2}, -\\frac{\\dot{\\epsilon}}{2}\\right)$. Since $\\boldsymbol{\\kappa}$ is a diagonal tensor, its transpose is equal to itself, $\\left(\\nabla \\mathbf{v}\\right)^{\\mathsf{T}} = \\boldsymbol{\\kappa}$. Substituting these into the evolution equation yields:\n$$\n\\frac{d \\mathbf{A}}{dt} - \\boldsymbol{\\kappa}\\cdot \\mathbf{A} - \\mathbf{A}\\cdot \\boldsymbol{\\kappa} = -\\frac{1}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right)\n$$\nRearranging for the time derivative of $\\mathbf{A}$:\n$$\n\\frac{d \\mathbf{A}}{dt} = \\boldsymbol{\\kappa}\\cdot \\mathbf{A} + \\mathbf{A}\\cdot \\boldsymbol{\\kappa} - \\frac{1}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right)\n$$\nThe initial condition is $\\mathbf{A}(0) = \\mathbf{I}$, which is a diagonal tensor. Since $\\boldsymbol{\\kappa}$ is also diagonal, the tensor $\\mathbf{A}(t)$ will remain diagonal for all time $t \\ge 0$. Let $\\mathbf{A}(t) = \\mathrm{diag}(A_{11}(t), A_{22}(t), A_{33}(t))$. For diagonal tensors, matrix multiplication is commutative and simplifies to element-wise multiplication, thus $\\boldsymbol{\\kappa}\\cdot \\mathbf{A} = \\mathbf{A}\\cdot \\boldsymbol{\\kappa}$. The equation becomes:\n$$\n\\frac{d \\mathbf{A}}{dt} = 2 \\boldsymbol{\\kappa} \\cdot \\mathbf{A} - \\frac{1}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right)\n$$\nWe can write this equation component-wise for the diagonal elements $A_{ii}$:\n$$\n\\frac{d A_{ii}}{dt} = 2 \\kappa_{ii} A_{ii} - \\frac{1}{\\lambda}\\left(f(\\mathbf{A}) A_{ii} - 1\\right)\n$$\nFor the specific components, using $\\kappa_{11}=\\dot{\\epsilon}$ and $\\kappa_{22}=\\kappa_{33}=-\\dot{\\epsilon}/2$:\n$$\n\\frac{d A_{11}}{dt} = 2 \\dot{\\epsilon} A_{11} - \\frac{1}{\\lambda}\\left(f(\\mathbf{A}) A_{11} - 1\\right)\n$$\n$$\n\\frac{d A_{22}}{dt} = - \\dot{\\epsilon} A_{22} - \\frac{1}{\\lambda}\\left(f(\\mathbf{A}) A_{22} - 1\\right)\n$$\n$$\n\\frac{d A_{33}}{dt} = - \\dot{\\epsilon} A_{33} - \\frac{1}{\\lambda}\\left(f(\\mathbf{A}) A_{33} - 1\\right)\n$$\nThe equations for $A_{22}$ and $A_{33}$ are identical, and their initial conditions are also identical ($A_{22}(0)=A_{33}(0)=1$). Therefore, $A_{22}(t) = A_{33}(t)$ for all $t$. This axial symmetry reduces the system to two independent equations. The trace of $\\mathbf{A}$ is $\\mathrm{tr}(\\mathbf{A}) = A_{11} + 2 A_{22}$.\n\nTo non-dimensionalize, we introduce $t^\\star = t/\\lambda$ and the Weissenberg number $Wi = \\lambda \\dot{\\epsilon}$. The time derivative becomes $\\frac{d}{dt} = \\frac{1}{\\lambda}\\frac{d}{dt^\\star}$.\n$$\n\\frac{1}{\\lambda}\\frac{d A_{11}}{dt^\\star} = \\frac{2 Wi}{\\lambda} A_{11} - \\frac{1}{\\lambda}\\left(f(\\mathbf{A}) A_{11} - 1\\right) \\implies \\frac{d A_{11}}{dt^\\star} = 2 Wi A_{11} - f(\\mathbf{A}) A_{11} + 1\n$$\n$$\n\\frac{1}{\\lambda}\\frac{d A_{22}}{dt^\\star} = -\\frac{Wi}{\\lambda} A_{22} - \\frac{1}{\\lambda}\\left(f(\\mathbf{A}) A_{22} - 1\\right) \\implies \\frac{d A_{22}}{dt^\\star} = -Wi A_{22} - f(\\mathbf{A}) A_{22} + 1\n$$\nThe Peterlin function $f(\\mathbf{A})$ is $f(\\mathbf{A}) = \\frac{L^2}{L^2 - (A_{11} + 2A_{22})}$. The final system of ODEs to be solved for $A_{11}(t^\\star)$ and $A_{22}(t^\\star)$ is:\n$$\n\\begin{cases}\n\\frac{d A_{11}}{dt^\\star} = 1 + \\left(2 Wi - \\frac{L^2}{L^2 - (A_{11} + 2A_{22})}\\right) A_{11} \\\\\n\\frac{d A_{22}}{dt^\\star} = 1 - \\left(Wi + \\frac{L^2}{L^2 - (A_{11} + 2A_{22})}\\right) A_{22}\n\\end{cases}\n$$\nwith initial conditions $A_{11}(0)=1$ and $A_{22}(0)=1$.\n\n**2. Derivation of the Dimensionless Extensional Viscosity**\n\nThe uniaxial extensional viscosity is $\\eta_E(t) = \\frac{\\sigma_{11}(t) - \\frac{1}{2}\\left(\\sigma_{22}(t) + \\sigma_{33}(t)\\right)}{\\dot{\\epsilon}}$.\nThe total Cauchy stress is $\\boldsymbol{\\sigma} = -p\\mathbf{I} + \\boldsymbol{\\tau}_s + \\boldsymbol{\\tau}_p$. Due to the axial symmetry ($A_{22}=A_{33}$ and $\\kappa_{22}=\\kappa_{33}$), we have $\\sigma_{22}=\\sigma_{33}$. The definition of $\\eta_E$ simplifies to:\n$$\n\\eta_E(t) = \\frac{\\sigma_{11}(t) - \\sigma_{22}(t)}{\\dot{\\epsilon}} = \\frac{\\left(-p + (\\tau_s)_{11} + (\\tau_p)_{11}\\right) - \\left(-p + (\\tau_s)_{22} + (\\tau_p)_{22}\\right)}{\\dot{\\epsilon}}\n$$\n$$\n\\eta_E(t) = \\frac{(\\tau_s)_{11} - (\\tau_s)_{22}}{\\dot{\\epsilon}} + \\frac{(\\tau_p)_{11} - (\\tau_p)_{22}}{\\dot{\\epsilon}}\n$$\nThe solvent contribution is from $\\boldsymbol{\\tau}_s = 2\\eta_s \\boldsymbol{\\kappa}$.\n$(\\tau_s)_{11} = 2\\eta_s \\dot{\\epsilon}$ and $(\\tau_s)_{22} = 2\\eta_s(-\\dot{\\epsilon}/2) = -\\eta_s \\dot{\\epsilon}$.\nThe solvent contribution to $\\eta_E$ is $\\frac{2\\eta_s \\dot{\\epsilon} - (-\\eta_s \\dot{\\epsilon})}{\\dot{\\epsilon}} = 3\\eta_s$.\n\nThe polymer contribution depends on the model.\nFor FENE-P, $\\boldsymbol{\\tau}_p = \\frac{\\eta_p}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right)$.\n$(\\tau_p)_{11} - (\\tau_p)_{22} = \\frac{\\eta_p}{\\lambda}\\left( (f(\\mathbf{A})A_{11} - 1) - (f(\\mathbf{A})A_{22} - 1) \\right) = \\frac{\\eta_p}{\\lambda}f(\\mathbf{A})(A_{11} - A_{22})$.\nThe polymer contribution to $\\eta_E$ is $\\frac{1}{\\dot{\\epsilon}} \\frac{\\eta_p}{\\lambda}f(\\mathbf{A})(A_{11} - A_{22}) = \\frac{\\eta_p}{Wi}f(\\mathbf{A})(A_{11} - A_{22})$.\n\nFor FENE-CR, $\\boldsymbol{\\tau}_p = \\frac{\\eta_p}{\\lambda}\\left(\\mathbf{A} - \\mathbf{I}\\right)$.\n$(\\tau_p)_{11} - (\\tau_p)_{22} = \\frac{\\eta_p}{\\lambda}\\left( (A_{11} - 1) - (A_{22} - 1) \\right) = \\frac{\\eta_p}{\\lambda}(A_{11} - A_{22})$.\nThe polymer contribution to $\\eta_E$ is $\\frac{1}{\\dot{\\epsilon}} \\frac{\\eta_p}{\\lambda}(A_{11} - A_{22}) = \\frac{\\eta_p}{Wi}(A_{11} - A_{22})$.\n\nThe total extensional viscosity is $\\eta_E(t) = 3\\eta_s + (\\eta_E)_p(t)$. The dimensionless extensional viscosity ratio (normalized Trouton ratio) is $\\mathrm{TR}(t^\\star) = \\eta_E(t)/\\eta_0$. Using $\\eta_s = \\beta \\eta_0$ and $\\eta_p = (1-\\beta)\\eta_0$:\n$$\n\\mathrm{TR}(t^\\star) = \\frac{3\\eta_s}{\\eta_0} + \\frac{(\\eta_E)_p}{\\eta_0} = 3\\beta + \\frac{(\\eta_E)_p}{\\eta_0}\n$$\nSubstituting the polymer contributions:\nFor FENE-P:\n$$\n\\mathrm{TR}(t^\\star) = 3\\beta + \\frac{1}{\\eta_0}\\left(\\frac{\\eta_p}{Wi}f(\\mathbf{A})(A_{11} - A_{22})\\right) = 3\\beta + \\frac{1-\\beta}{Wi} f(\\mathbf{A}(t^\\star)) (A_{11}(t^\\star) - A_{22}(t^\\star))\n$$\nFor FENE-CR:\n$$\n\\mathrm{TR}(t^\\star) = 3\\beta + \\frac{1}{\\eta_0}\\left(\\frac{\\eta_p}{Wi}(A_{11} - A_{22})\\right) = 3\\beta + \\frac{1-\\beta}{Wi} (A_{11}(t^\\star) - A_{22}(t^\\star))\n$$\nThese expressions are evaluated using the solution of the ODE system for $A_{11}(t^\\star)$ and $A_{22}(t^\\star)$.\n\n**3. Numerical Implementation Strategy**\n\nThe problem is solved numerically by treating the derived system of two non-linear ODEs as an initial value problem (IVP). The state vector is $\\mathbf{y}(t^\\star) = [A_{11}(t^\\star), A_{22}(t^\\star)]^{\\mathsf{T}}$ with the initial condition $\\mathbf{y}(0) = [1, 1]^{\\mathsf{T}}$.\n\nThe SciPy function `scipy.integrate.solve_ivp` is employed to perform the numerical integration. This function is a robust, general-purpose ODE solver. An adaptive step-size Runge-Kutta method (e.g., `RK45`) is suitable.\n\nA critical aspect is the enforcement of the finite extensibility constraint $\\mathrm{tr}(\\mathbf{A}) < L^2$. This constraint means $A_{11} + 2A_{22} < L^2$. As the trace approaches $L^2$, the Peterlin function $f(\\mathbf{A})$ diverges, making the ODE system infinitely stiff. The `solve_ivp` function's event handling mechanism is used to manage this. An event function is defined that evaluates to zero when the constraint is violated (i.e., $L^2 - \\mathrm{tr}(\\mathbf{A}) = 0$). By setting this event to be terminal, the integration is gracefully stopped just before the physical limit is reached.\n\nFor each test case, the program integrates the ODE system from $t^\\star=0$ to $t^\\star=t^\\star_{\\text{end}}$ or until the extensibility limit is reached. The solution is evaluated at a series of discrete time points. At each point, the dimensionless extensional viscosity $\\mathrm{TR}(t^\\star)$ is calculated using the corresponding derived formula. Finally, the maximum value of $\\mathrm{TR}(t^\\star)$ over the entire computed time interval is determined and reported.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the FENE-P/CR model equations for uniaxial extensional flow\n    and calculates the maximum dimensionless extensional viscosity.\n    \"\"\"\n    # Test suite from the problem statement\n    test_cases = [\n        # model type, Wi, L2, beta, t_end_star\n        ('FENE-P', 0.5, 100.0, 0.2, 4.0),\n        ('FENE-CR', 0.5, 100.0, 0.2, 4.0),\n        ('FENE-P', 2.0, 10.0, 0.1, 1.0),\n        ('FENE-CR', 2.0, 10.0, 0.1, 1.0),\n        ('FENE-P', 0.3, 1e6, 0.5, 20.0),\n        ('FENE-P', 0.1, 3.3, 0.3, 10.0),\n    ]\n\n    results = []\n\n    def ode_system(t, y, Wi, L2):\n        \"\"\"\n        Defines the system of ODEs for the conformation tensor components.\n        y[0] = A11, y[1] = A22.\n        \"\"\"\n        A11, A22 = y\n        trace_A = A11 + 2 * A22\n        \n        # This condition is a safeguard; the event system should prevent it.\n        if trace_A >= L2:\n            return [0.0, 0.0]  # Return zeros to prevent solver from diverging.\n            \n        f_A = L2 / (L2 - trace_A)\n        \n        dA11_dt = 1.0 - f_A * A11 + 2.0 * Wi * A11\n        dA22_dt = 1.0 - f_A * A22 - Wi * A22\n        \n        return [dA11_dt, dA22_dt]\n\n    def L2_limit(t, y, Wi, L2):\n        \"\"\"\n        Event function to stop integration when tr(A) approaches L^2.\n        \"\"\"\n        return L2 - (y[0] + 2 * y[1])\n    L2_limit.terminal = True\n    L2_limit.direction = -1\n\n    for case in test_cases:\n        model, Wi, L2, beta, t_end_star = case\n        \n        y0 = np.array([1.0, 1.0])\n        t_span = [0.0, t_end_star]\n        \n        # Evaluate at a fine grid to capture the maximum TR value accurately.\n        t_eval = np.linspace(t_span[0], t_span[1], 1001)\n        \n        sol = solve_ivp(\n            fun=ode_system, \n            t_span=t_span, \n            y0=y0, \n            args=(Wi, L2),\n            method='RK45', \n            t_eval=t_eval, \n            events=L2_limit,\n            rtol=1e-8,\n            atol=1e-10\n        )\n        \n        # If integration fails or produces no steps, use initial value.\n        if sol.y.shape[1] == 0:\n            results.append(3.0 * beta)\n            continue\n            \n        A11 = sol.y[0]\n        A22 = sol.y[1]\n        \n        # Calculate the polymeric contribution to the extensional viscosity.\n        if model == 'FENE-P':\n            trace_A = A11 + 2 * A22\n            # Defensively filter out any points that might numerically violate the constraint.\n            safe_mask = trace_A < L2\n            if not np.all(safe_mask):\n                A11 = A11[safe_mask]\n                A22 = A22[safe_mask]\n                trace_A = trace_A[safe_mask]\n\n            if A11.size == 0:\n                results.append(3.0 * beta)\n                continue\n\n            f_A = L2 / (L2 - trace_A)\n            poly_contrib = ((1.0 - beta) / Wi) * f_A * (A11 - A22)\n            \n        elif model == 'FENE-CR':\n            poly_contrib = ((1.0 - beta) / Wi) * (A11 - A22)\n            \n        tr_values = 3.0 * beta + poly_contrib\n        \n        if tr_values.size > 0:\n            max_tr = np.max(tr_values)\n        else:\n            # Fallback to initial value if all points were filtered out.\n            max_tr = 3.0 * beta\n            \n        results.append(max_tr)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Real-world polymer processing often involves complex, time-varying deformations. This advanced practice explores the non-linear viscoelastic response of the FENE models under large-amplitude oscillatory shear (LAOS), a powerful technique for characterizing material behavior outside the linear regime. By computing the energy dissipated per cycle—the area of the stress-strain hysteresis loop—you will gain deeper insight into how these models capture viscous dissipation and how the FENE-P and FENE-CR closures differ in their prediction of non-linear dynamics .",
            "id": "4106659",
            "problem": "Consider the finitely extensible nonlinear elastic models with Peterlin closure and Chilcott–Rallison closure, namely the Finitely Extensible Nonlinear Elastic–Peterlin (FENE-P) model and the Finitely Extensible Nonlinear Elastic–Chilcott–Rallison (FENE-CR) model, for a polymer solution subject to cyclic loading in simple shear. The objective is to compute the hysteresis area per cycle in the shear stress versus strain representation under large-amplitude oscillatory shear, and to compare the FENE-P and FENE-CR responses across a small test suite of scientifically realistic parameter sets.\n\nFundamental base and core definitions to use:\n- The fluid is modeled as a kinetic-theory dumbbell ensemble, whose second-moment conformation tensor is denoted by $A$, and evolves according to upper-convected derivatives modified by finite extensibility.\n- The velocity field is simple shear $u_x(y,t)$ with shear rate $\\dot{\\gamma}(t)$, given by oscillatory strain $\\gamma(t) = \\gamma_0 \\sin(\\omega t)$, hence $\\dot{\\gamma}(t) = \\gamma_0 \\omega \\cos(\\omega t)$, where $\\gamma_0$ is the strain amplitude (dimensionless) and $\\omega$ is the angular frequency (in radians per second).\n- The velocity gradient tensor is $K = \\nabla u$, which for two-dimensional simple shear is $K = \\begin{bmatrix} 0 & \\dot{\\gamma}(t) \\\\ 0 & 0 \\end{bmatrix}$.\n- The finite extensibility parameter is $b > \\mathrm{tr}(A)$, and the Peterlin function is $f(A) = \\dfrac{b}{b - \\mathrm{tr}(A)}$.\n- The characteristic relaxation time of the polymer is $\\lambda$ (in seconds), and the polymer contribution to viscosity is $\\eta_p$ (in Pascal–seconds). The solvent viscosity is neglected in this problem.\n- The energy dissipated per unit volume per cycle equals the signed area of the hysteresis loop in the shear stress versus strain representation, which is the line integral over one period $T = 2\\pi/\\omega$: $$W = \\oint \\tau_{xy} \\, d\\gamma = \\int_0^T \\tau_{xy}(t) \\, \\dot{\\gamma}(t) \\, dt,$$ where $\\tau_{xy}(t)$ is the shear component of the polymeric stress tensor.\n\nTasks:\n1. Starting from the upper-convected evolution of the conformation tensor with finite extensibility, formulate the specialized two-dimensional evolution equations for $A$ under simple shear, for both FENE-P and FENE-CR closures. Do not assume any linearization. State clearly how the relaxation term differs between FENE-P and FENE-CR and how the polymeric stress is computed in each model.\n2. Explain how to numerically integrate the resulting nonlinear ordinary differential equations (ODEs) to reach periodic steady state under oscillatory shear. The algorithm must ensure that $f(A)$ remains finite by maintaining $\\mathrm{tr}(A) < b$, and must compute $W$ over the final oscillation cycle after transients have decayed.\n3. Implement a complete program that:\n   - Integrates the conformation tensor ODEs for both FENE-P and FENE-CR under $\\gamma(t) = \\gamma_0 \\sin(\\omega t)$.\n   - Computes the hysteresis area per cycle $W$ (energy per unit volume, in Pascal) using $W = \\int_0^T \\tau_{xy}(t) \\, \\dot{\\gamma}(t) \\, dt$ over the last cycle after discarding transients.\n   - Uses the following test suite of parameter values, which are each scientifically plausible and designed to probe different behavioral regimes:\n     - Test case 1 (moderate amplitude, near-linear extensibility): $\\gamma_0 = 1.0$, $\\omega = 2.0 \\, \\mathrm{rad/s}$, $\\lambda = 0.5 \\, \\mathrm{s}$, $\\eta_p = 1.0 \\, \\mathrm{Pa \\cdot s}$, $b = 50.0$.\n     - Test case 2 (large amplitude, pronounced finite extensibility): $\\gamma_0 = 5.0$, $\\omega = 1.0 \\, \\mathrm{rad/s}$, $\\lambda = 1.0 \\, \\mathrm{s}$, $\\eta_p = 1.0 \\, \\mathrm{Pa \\cdot s}$, $b = 10.0$.\n     - Test case 3 (small amplitude, high frequency, very large $b$ approximating Oldroyd-B behavior): $\\gamma_0 = 0.1$, $\\omega = 10.0 \\, \\mathrm{rad/s}$, $\\lambda = 0.1 \\, \\mathrm{s}$, $\\eta_p = 0.5 \\, \\mathrm{Pa \\cdot s}$, $b = 1000.0$.\n     - Test case 4 (boundary extensibility near equilibrium trace in two dimensions): $\\gamma_0 = 0.2$, $\\omega = 1.0 \\, \\mathrm{rad/s}$, $\\lambda = 2.0 \\, \\mathrm{s}$, $\\eta_p = 0.8 \\, \\mathrm{Pa \\cdot s}$, $b = 3.0$.\n   - For each test case, returns a list containing two floating-point numbers: the hysteresis area per cycle $W$ for FENE-P and for FENE-CR, respectively. Each $W$ must be expressed in Pascal and rounded to six decimal places.\n4. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case and is itself a list in the form $[W_{\\mathrm{P}}, W_{\\mathrm{CR}}]$, for example: $[[W_{\\mathrm{P1}}, W_{\\mathrm{CR1}}],[W_{\\mathrm{P2}}, W_{\\mathrm{CR2}}],...]$.\n\nAngle unit specification: use radians for $\\omega$ and arguments of $\\sin(\\cdot)$ and $\\cos(\\cdot)$.\n\nPhysical unit specification: report the hysteresis area per cycle $W$ in Pascal, rounded to six decimal places.\n\nEnsure numerical stability and scientific realism by choosing sufficient cycles to eliminate transients and a sufficiently fine temporal resolution per cycle to accurately evaluate the integral for $W$.",
            "solution": "The problem requires the formulation, numerical solution, and comparison of the Finitely Extensible Nonlinear Elastic–Peterlin (FENE-P) and Finitely Extensible Nonlinear Elastic–Chilcott–Rallison (FENE-CR) models for a polymer solution in large-amplitude oscillatory shear (LAOS). The objective is to compute the energy dissipated per unit volume per cycle, represented by the hysteresis area $W$.\n\n### Step 1: Formulation of the Governing Equations\n\nThe dynamics of the polymer microstructure are described by the second-moment conformation tensor $A$, which is a dimensionless, symmetric, and positive-definite tensor. Its evolution is governed by an upper-convected time derivative framework. For a homogeneous simple shear flow, where the velocity field is $u_x(y,t) = \\dot{\\gamma}(t)y$, the general evolution equation for $A$ simplifies to:\n$$ \\frac{dA}{dt} = K A + A K^T - \\frac{1}{\\lambda} g(A) $$\nHere, $t$ is time, $\\lambda$ is the polymer relaxation time, and $K$ is the velocity gradient tensor. For two-dimensional ($2$D) simple shear, $K$ is given by:\n$$ K(t) = \\begin{bmatrix} 0 & \\dot{\\gamma}(t) \\\\ 0 & 0 \\end{bmatrix} $$\nwhere the shear rate $\\dot{\\gamma}(t)$ is derived from the imposed oscillatory strain $\\gamma(t) = \\gamma_0 \\sin(\\omega t)$:\n$$ \\dot{\\gamma}(t) = \\frac{d\\gamma}{dt} = \\gamma_0 \\omega \\cos(\\omega t) $$\nThe term $K A + A K^T$ accounts for the deformation of the polymer chains by the flow. For a symmetric tensor $A = \\begin{bmatrix} A_{xx} & A_{xy} \\\\ A_{xy} & A_{yy} \\end{bmatrix}$, this term evaluates to:\n$$ K A + A K^T = \\begin{bmatrix} 2\\dot{\\gamma}(t) A_{xy} & \\dot{\\gamma}(t) A_{yy} \\\\ \\dot{\\gamma}(t) A_{yy} & 0 \\end{bmatrix} $$\nThe term $g(A)$ represents the relaxation of the polymer chains back toward an equilibrium state, driven by Brownian motion and counteracted by the entropic spring force of the polymer. The specific form of $g(A)$ and the related polymeric stress tensor $\\tau_p$ distinguishes the FENE-P and FENE-CR models. Both models use the Peterlin function $f(A)$ to account for finite extensibility:\n$$ f(A) = \\frac{b}{b - \\mathrm{tr}(A)} $$\nwhere $b$ is the finite extensibility parameter and, for this 2D problem, $\\mathrm{tr}(A) = A_{xx} + A_{yy}$. This function introduces a strong nonlinearity, as the spring force diverges when the mean-square end-to-end distance of the polymer chains approaches the limit $b$.\n\n**FENE-P Model**\nIn the FENE-P model, the Peterlin closure approximation is applied to the averaged spring force term, affecting both the evolution equation and the stress tensor expression.\nThe relaxation term is $g(A) = f(A)A - I$, where $I$ is the identity tensor. The evolution equation for $A$ is:\n$$ \\frac{dA}{dt} = K A + A K^T - \\frac{1}{\\lambda} (f(A)A - I) $$\nThe polymeric stress tensor is given by Kramers' expression with the Peterlin approximation:\n$$ \\tau_p = \\frac{\\eta_p}{\\lambda} (f(A)A - I) $$\nwhere $\\eta_p$ is the polymer contribution to the viscosity. In component form, the system of ordinary differential equations (ODEs) for the unique components of $A$ is:\n$$ \\frac{dA_{xx}}{dt} = 2\\dot{\\gamma}(t)A_{xy} - \\frac{1}{\\lambda} \\left( \\frac{b}{b - (A_{xx}+A_{yy})} A_{xx} - 1 \\right) $$\n$$ \\frac{dA_{yy}}{dt} = -\\frac{1}{\\lambda} \\left( \\frac{b}{b - (A_{xx}+A_{yy})} A_{yy} - 1 \\right) $$\n$$ \\frac{dA_{xy}}{dt} = \\dot{\\gamma}(t)A_{yy} - \\frac{1}{\\lambda} \\left( \\frac{b}{b - (A_{xx}+A_{yy})} A_{xy} \\right) $$\nThe shear stress component $\\tau_{xy}$ required for calculating $W$ is:\n$$ \\tau_{xy}(t) = \\frac{\\eta_p}{\\lambda} \\left( \\frac{b}{b - (A_{xx}(t)+A_{yy}(t))} A_{xy}(t) \\right) $$\n\n**FENE-CR Model**\nIn the FENE-CR model, the closure approximation is applied differently. The Peterlin function modifies the relaxation process but does not appear directly in the stress tensor expression.\nThe relaxation term is $g(A) = f(A)(A-I)$. The evolution equation for $A$ is:\n$$ \\frac{dA}{dt} = K A + A K^T - \\frac{f(A)}{\\lambda} (A-I) $$\nThe polymeric stress tensor is given by the Giesekus expression:\n$$ \\tau_p = \\frac{\\eta_p}{\\lambda} (A - I) $$\nIn component form, the ODE system is:\n$$ \\frac{dA_{xx}}{dt} = 2\\dot{\\gamma}(t)A_{xy} - \\frac{1}{\\lambda} \\frac{b}{b - (A_{xx}+A_{yy})} (A_{xx} - 1) $$\n$$ \\frac{dA_{yy}}{dt} = -\\frac{1}{\\lambda} \\frac{b}{b - (A_{xx}+A_{yy})} (A_{yy} - 1) $$\n$$ \\frac{dA_{xy}}{dt} = \\dot{\\gamma}(t)A_{yy} - \\frac{1}{\\lambda} \\frac{b}{b - (A_{xx}+A_{yy})} A_{xy} $$\nThe shear stress component $\\tau_{xy}$ is:\n$$ \\tau_{xy}(t) = \\frac{\\eta_p}{\\lambda} (A_{xy}(t)) $$\nThe fundamental difference lies in where the non-linear function $f(A)$ is applied. In FENE-P, it scales the conformation tensor $A$ in both the evolution and stress expressions. In FENE-CR, it scales the relaxation driving force $(A-I)$ in the evolution equation, while the stress remains a linear function of $(A-I)$.\n\n### Step 2: Numerical Integration Algorithm\n\nTo compute the hysteresis area $W$, the system of ODEs for each model must be integrated over time until a periodic steady state is reached.\n\n1.  **Initial Conditions**: The integration starts from the equilibrium state (no flow, $\\dot{\\gamma}=0$). The equilibrium conformation tensor $A_0$ is found by setting $\\frac{dA}{dt}=0$ and $K=0$.\n    -   For FENE-P: $g(A_0) = f(A_0)A_0 - I = 0$. In $2$D, this solves to $A_0 = \\frac{b}{b+2}I$. The initial state is $A_{xx}(0) = A_{yy}(0) = \\frac{b}{b+2}$ and $A_{xy}(0) = 0$.\n    -   For FENE-CR: $g(A_0) = f(A_0)(A_0-I) = 0$. Since $f(A_0)$ is finite at equilibrium, this requires $A_0=I$. The initial state is $A_{xx}(0) = A_{yy}(0) = 1$ and $A_{xy}(0) = 0$.\n\n2.  **Time Integration**: The system of three coupled, nonlinear first-order ODEs is solved numerically. We use an implicit, adaptive step-size solver, such as the Backward Differentiation Formula (BDF) method, which is well-suited for potentially stiff systems that can arise, especially when $\\mathrm{tr}(A)$ approaches $b$. The integration is performed for a sufficient number of oscillation cycles (e.g., $20$ cycles) to ensure that any initial transients have decayed and the system has settled into a periodic steady state, where the trajectory of $A(t)$ over one cycle repeats.\n\n3.  **Hysteresis Area Calculation**: The energy dissipated per unit volume per cycle, $W$, is calculated over the final cycle of the simulation (e.g., from $t_{start} = 19T$ to $t_{end} = 20T$, where $T = 2\\pi/\\omega$). The formula is:\n    $$ W = \\int_{t_{start}}^{t_{end}} \\tau_{xy}(t) \\dot{\\gamma}(t) dt $$\n    The ODE solver is configured to output the solution $(A_{xx}(t), A_{yy}(t), A_{xy}(t))$ at a fine grid of time points within this last cycle. At each point $t_i$, we compute the corresponding values of $\\tau_{xy}(t_i)$ and $\\dot{\\gamma}(t_i)$. The definite integral is then evaluated numerically using a high-order quadrature rule, such as Simpson's rule, for accuracy.\n\n4.  **Numerical Stability**: The divergence of $f(A)$ as $\\mathrm{tr}(A) \\to b$ poses a numerical challenge. By using a robust, adaptive ODE solver (like `scipy.integrate.solve_ivp` with the `'BDF'` method) and setting stringent error tolerances (`rtol=1e-7`, `atol=1e-10`), the time step is automatically reduced as the solution approaches the singularity, preserving the constraint $\\mathrm{tr}(A) < b$ and ensuring a stable and accurate solution. For the given test cases, this approach is sufficient.\n\nThis procedure is implemented for both the FENE-P and FENE-CR models to compute and compare their respective hysteresis areas, $W_P$ and $W_{CR}$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp, simpson\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the hysteresis area per cycle (W) for FENE-P and FENE-CR models\n    under large-amplitude oscillatory shear.\n    \"\"\"\n    \n    # Test cases: (gamma0, omega, lam, eta_p, b)\n    test_cases = [\n        (1.0, 2.0, 0.5, 1.0, 50.0),   # Case 1\n        (5.0, 1.0, 1.0, 1.0, 10.0),   # Case 2\n        (0.1, 10.0, 0.1, 0.5, 1000.0), # Case 3\n        (0.2, 1.0, 2.0, 0.8, 3.0),    # Case 4\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        gamma0, omega, lam, eta_p, b = params\n        \n        # Calculate hysteresis area for FENE-P\n        W_p = calculate_hysteresis(\n            'FENE-P', gamma0, omega, lam, eta_p, b\n        )\n        \n        # Calculate hysteresis area for FENE-CR\n        W_cr = calculate_hysteresis(\n            'FENE-CR', gamma0, omega, lam, eta_p, b\n        )\n        \n        all_results.append([round(W_p, 6), round(W_cr, 6)])\n\n    # Format the final output as specified\n    formatted_results = \"[\" + \",\".join(map(str, all_results)) + \"]\"\n    print(formatted_results.replace(\" \", \"\"))\n\n\ndef calculate_hysteresis(model_type, gamma0, omega, lam, eta_p, b):\n    \"\"\"\n    Calculates the hysteresis area W for a given model and parameters.\n    \n    Args:\n        model_type (str): 'FENE-P' or 'FENE-CR'.\n        gamma0 (float): Strain amplitude.\n        omega (float): Angular frequency (rad/s).\n        lam (float): Polymer relaxation time (s).\n        eta_p (float): Polymer viscosity contribution (Pa.s).\n        b (float): Finite extensibility parameter.\n        \n    Returns:\n        float: The calculated hysteresis area W (in Pa).\n    \"\"\"\n\n    # Shear rate function\n    def shear_rate(t):\n        return gamma0 * omega * np.cos(omega * t)\n\n    if model_type == 'FENE-P':\n        # ODE system for FENE-P model\n        def ode_system(t, y):\n            A_xx, A_yy, A_xy = y\n            trace_A = A_xx + A_yy\n            \n            # Check for physical validity, though solve_ivp should handle this\n            if trace_A >= b:\n                return [0, 0, 0] \n            \n            f_A = b / (b - trace_A)\n            dot_gamma_t = shear_rate(t)\n            \n            dAxx_dt = 2 * dot_gamma_t * A_xy - (1 / lam) * (f_A * A_xx - 1)\n            dAyy_dt = - (1 / lam) * (f_A * A_yy - 1)\n            dAxy_dt = dot_gamma_t * A_yy - (1 / lam) * f_A * A_xy\n            \n            return [dAxx_dt, dAyy_dt, dAxy_dt]\n        \n        # Equilibrium initial conditions for FENE-P in 2D\n        d = 2.0\n        A_eq = b / (b + d)\n        y0 = [A_eq, A_eq, 0.0]\n\n    elif model_type == 'FENE-CR':\n        # ODE system for FENE-CR model\n        def ode_system(t, y):\n            A_xx, A_yy, A_xy = y\n            trace_A = A_xx + A_yy\n\n            if trace_A >= b:\n                return [0, 0, 0]\n\n            f_A = b / (b - trace_A)\n            dot_gamma_t = shear_rate(t)\n            \n            dAxx_dt = 2 * dot_gamma_t * A_xy - (f_A / lam) * (A_xx - 1)\n            dAyy_dt = - (f_A / lam) * (A_yy - 1)\n            dAxy_dt = dot_gamma_t * A_yy - (f_A / lam) * A_xy\n            \n            return [dAxx_dt, dAyy_dt, dAxy_dt]\n            \n        # Equilibrium initial conditions for FENE-CR\n        y0 = [1.0, 1.0, 0.0]\n    else:\n        raise ValueError(\"Unknown model type\")\n\n    # Time parameters\n    T_period = 2 * np.pi / omega\n    num_transient_cycles = 19\n    num_integration_cycles = 1\n    t_start = 0.0\n    t_end = (num_transient_cycles + num_integration_cycles) * T_period\n    \n    # Time points for the final cycle for high-accuracy integration\n    t_eval_start = num_transient_cycles * T_period\n    num_points_in_cycle = 2001 # Odd number for Simpson's rule\n    t_eval = np.linspace(t_eval_start, t_end, num_points_in_cycle)\n\n    # Solve the system of ODEs\n    sol = solve_ivp(\n        ode_system, \n        (t_start, t_end), \n        y0, \n        method='BDF', \n        t_eval=t_eval,\n        rtol=1e-7,\n        atol=1e-10\n    )\n    \n    A_xx_sol, A_yy_sol, A_xy_sol = sol.y\n    t_sol = sol.t\n\n    # Calculate shear stress and integrand for W\n    dot_gamma_vals = shear_rate(t_sol)\n    \n    if model_type == 'FENE-P':\n        trace_A_sol = A_xx_sol + A_yy_sol\n        f_A_sol = b / (b - trace_A_sol)\n        tau_xy = (eta_p / lam) * f_A_sol * A_xy_sol\n    else: # FENE-CR\n        tau_xy = (eta_p / lam) * A_xy_sol\n        \n    integrand = tau_xy * dot_gamma_vals\n\n    # Compute the integral for W using Simpson's rule for accuracy\n    W = simpson(integrand, x=t_sol)\n    \n    return W\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}