{
    "hands_on_practices": [
        {
            "introduction": "在深入研究瞬态动力学和复杂的数值模拟之前，理解本构模型在稳态流动下的行为至关重要。本练习  将引导你分析 FENE-P 模型在平面拉伸流中的稳态解，这是一个典型的强流场。通过从第一性原理推导聚合物构象张量的本征值，你将深入理解有限拉伸性参数 $b$ 和流动强度（以Weissenberg数 $Wi$ 表示）如何共同决定聚合物链的最终拉伸程度。",
            "id": "4106661",
            "problem": "考虑一个由有限可伸长非线性弹性-Peterlin (FENE-P) 本构方程建模的稀聚合物溶液。设聚合物的构型由对称正定构象张量 $\\boldsymbol{A}(t)$ 描述，其演化遵循动力学哑铃理论中的上随流导数定义和有限可伸长性闭合。具体来说，其演化由下式决定\n$$\n\\stackrel{\\nabla}{\\boldsymbol{A}} \\equiv \\frac{\\mathrm{D}\\boldsymbol{A}}{\\mathrm{D}t} - \\boldsymbol{L}\\cdot\\boldsymbol{A} - \\boldsymbol{A}\\cdot\\boldsymbol{L}^{\\top} = -\\frac{1}{\\lambda}\\left( f(\\operatorname{tr}\\boldsymbol{A})\\,\\boldsymbol{A} - \\boldsymbol{I} \\right),\n$$\n其中 $\\boldsymbol{L} = \\nabla \\boldsymbol{u}$ 是速度梯度张量，$\\lambda$ 是聚合物弛豫时间，有限可伸长因子为\n$$\nf(\\operatorname{tr}\\boldsymbol{A}) = \\frac{b - 3}{\\,b - \\operatorname{tr}\\boldsymbol{A}\\,},\n$$\n其中 $b  3$ 是无量纲有限可伸长参数。考虑一个空间均匀、稳态的平面拉伸流，沿 $x$ 轴具有恒定拉伸率 $\\kappa$，沿 $y$ 轴具有相等的压缩率，而沿 $z$ 轴无变形，因此\n$$\n\\boldsymbol{L} = \\mathrm{diag}\\!\\left(\\kappa,\\,-\\kappa,\\,0\\right).\n$$\n假设初始状态为各向同性，即 $\\boldsymbol{A}(t=0) = \\boldsymbol{I}$，并分析稳态 $\\stackrel{\\nabla}{\\boldsymbol{A}} = \\boldsymbol{0}$。仅使用上述基本定义和第一性原理推导，导出有限可伸长因子 $f$ 的稳态自洽条件以及 $\\boldsymbol{A}$ 特征值的相应表达式。然后，对于参数值 $b = 50$ 和由 $\\mathrm{Wi} = \\lambda \\kappa = 0.6$ 定义的魏森伯格数 (Wi)，计算 $\\boldsymbol{A}$ 的主（最大）稳态特征值。将您的答案四舍五入至四位有效数字，并以无单位的无量纲数形式报告。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **构象张量 $\\boldsymbol{A}$ 的控制方程**：\n  $$\n  \\stackrel{\\nabla}{\\boldsymbol{A}} \\equiv \\frac{\\mathrm{D}\\boldsymbol{A}}{\\mathrm{D}t} - \\boldsymbol{L}\\cdot\\boldsymbol{A} - \\boldsymbol{A}\\cdot\\boldsymbol{L}^{\\top} = -\\frac{1}{\\lambda}\\left( f(\\operatorname{tr}\\boldsymbol{A})\\,\\boldsymbol{A} - \\boldsymbol{I} \\right)\n  $$\n- **有限可伸长因子 $f(\\operatorname{tr}\\boldsymbol{A})$**：\n  $$\n  f(\\operatorname{tr}\\boldsymbol{A}) = \\frac{b - 3}{\\,b - \\operatorname{tr}\\boldsymbol{A}\\,}\n  $$\n- **有限可伸长参数**：$b  3$。\n- **流场**：稳态、平面拉伸流。\n- **速度梯度张量 $\\boldsymbol{L}$**：\n  $$\n  \\boldsymbol{L} = \\mathrm{diag}\\!\\left(\\kappa,\\,-\\kappa,\\,0\\right)\n  $$\n- **初始条件**：$\\boldsymbol{A}(t=0) = \\boldsymbol{I}$。\n- **分析条件**：稳态，其中 $\\stackrel{\\nabla}{\\boldsymbol{A}} = \\boldsymbol{0}$。\n- **数值参数**：$b = 50$，魏森伯格数 $\\mathrm{Wi} = \\lambda \\kappa = 0.6$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了 FENE-P 模型，这是计算复杂流体和流变学领域中一个标准且成熟的本构模型。控制方程和定义均以其常规形式给出。对稳态平面拉伸流的分析是该领域的一项基础练习。该问题在科学上是合理的。\n2.  **适定的**：该问题是适定的。它提供了所有必要的方程、边界条件（以指定流场的形式）和参数，以确定一个唯一、稳定且有意义的构象张量稳态解。\n3.  **客观的**：问题使用精确、形式化的数学和物理语言陈述，没有主观或模糊的术语。\n4.  **完整且一致**：问题是自洽的。所提供的信息足以且一致地求解构象张量的特征值。\n5.  **可行的**：参数值（$b=50$，$\\mathrm{Wi}=0.6$）对于聚合物溶液是物理上现实的。\n\n### 步骤 3：结论与行动\n该问题被认定为有效。将提供解答。\n\n### 求解推导\n\n分析始于稳态假设 $\\stackrel{\\nabla}{\\boldsymbol{A}} = \\boldsymbol{0}$。将其代入控制方程得到：\n$$\n\\boldsymbol{0} = \\frac{\\mathrm{D}\\boldsymbol{A}}{\\mathrm{D}t} - \\boldsymbol{L}\\cdot\\boldsymbol{A} - \\boldsymbol{A}\\cdot\\boldsymbol{L}^{\\top} = -\\frac{1}{\\lambda}\\left( f(\\operatorname{tr}\\boldsymbol{A})\\,\\boldsymbol{A} - \\boldsymbol{I} \\right)\n$$\n由于流场是空间均匀的，物质导数 $\\frac{\\mathrm{D}\\boldsymbol{A}}{\\mathrm{D}t}$ 变为普通时间导数 $\\frac{d\\boldsymbol{A}}{dt}$。对于稳态分析，$\\frac{d\\boldsymbol{A}}{dt}=\\boldsymbol{0}$。整理这些项，我们得到构象张量 $\\boldsymbol{A}$ 的稳态代数方程：\n$$\n\\boldsymbol{L}\\cdot\\boldsymbol{A} + \\boldsymbol{A}\\cdot\\boldsymbol{L}^{\\top} = \\frac{1}{\\lambda}\\left( f\\boldsymbol{A} - \\boldsymbol{I} \\right)\n$$\n其中 $f$ 用作 $f(\\operatorname{tr}\\boldsymbol{A})$ 的简写。速度梯度张量为 $\\boldsymbol{L} = \\mathrm{diag}(\\kappa, -\\kappa, 0)$。由于 $\\boldsymbol{L}$ 是对角矩阵，其转置等于自身，即 $\\boldsymbol{L}^{\\top} = \\boldsymbol{L}$。方程变为：\n$$\n\\boldsymbol{L}\\cdot\\boldsymbol{A} + \\boldsymbol{A}\\cdot\\boldsymbol{L} = \\frac{1}{\\lambda}\\left( f\\boldsymbol{A} - \\boldsymbol{I} \\right)\n$$\n构象张量 $\\boldsymbol{A}$ 是对称的。我们来分析这个矩阵方程的分量。对于非对角元 $A_{ij}$（其中 $i \\neq j$）：\n$$\n(\\boldsymbol{L}\\cdot\\boldsymbol{A} + \\boldsymbol{A}\\cdot\\boldsymbol{L})_{ij} = \\sum_{k} L_{ik}A_{kj} + \\sum_{k} A_{ik}L_{kj}\n$$\n由于 $\\boldsymbol{L}$ 是对角的，$L_{ik} = L_{ii}\\delta_{ik}$。表达式简化为：\n$$\n(L_{ii} + L_{jj})A_{ij} = \\frac{1}{\\lambda} (f A_{ij} - \\delta_{ij})\n$$\n对于非对角元，$\\delta_{ij} = 0$。\n- 对于 $(i, j) = (1, 2)$：$(L_{11} + L_{22})A_{12} = (\\kappa - \\kappa)A_{12} = 0 = \\frac{f}{\\lambda}A_{12}$。因为 $f  0$ 和 $\\lambda  0$，我们必须有 $A_{12} = 0$。\n- 对于 $(i, j) = (1, 3)$：$(L_{11} + L_{33})A_{13} = (\\kappa + 0)A_{13} = \\kappa A_{13} = \\frac{f}{\\lambda}A_{13}$。这意味着 $(\\kappa - f/\\lambda)A_{13} = 0$。\n- 对于 $(i, j) = (2, 3)$：$(L_{22} + L_{33})A_{23} = (-\\kappa + 0)A_{23} = -\\kappa A_{23} = \\frac{f}{\\lambda}A_{23}$。这意味着 $(-\\kappa - f/\\lambda)A_{23} = 0$。由于 $\\kappa  0$，$\\lambda  0$ 且 $f  0$（因为 $\\operatorname{tr}\\boldsymbol{A}  b$），项 $(-\\kappa - f/\\lambda)$ 严格为负，迫使 $A_{23} = 0$。\n\n关于 $A_{13}$，我们必须有 $A_{13}=0$ 或 $\\kappa = f/\\lambda$。如果 $\\kappa=f/\\lambda$，则 $\\mathrm{Wi} = f$。然而，如下所示，$\\boldsymbol{A}$ 的一个特征值由 $(f-2\\mathrm{Wi})^{-1}$ 给出。如果 $\\mathrm{Wi}=f$，这将变为 $(f-2f)^{-1} = -1/f  0$，这违反了 $\\boldsymbol{A}$ 是正定的要求。因此，唯一物理上有效的解要求 $A_{13}=0$。因此，对于此流动，构象张量 $\\boldsymbol{A}$ 在稳态时必须是对角阵。设 $\\boldsymbol{A} = \\mathrm{diag}(A_{11}, A_{22}, A_{33})$。对角元 $A_{ii}$ 是 $\\boldsymbol{A}$ 的特征值。\n\n现在我们分析矩阵方程的对角分量：\n$$\n(L_{ii} + L_{ii})A_{ii} = 2L_{ii}A_{ii} = \\frac{1}{\\lambda} (f A_{ii} - 1)\n$$\n我们对每个分量求解 $A_{ii}$：\n- 对于 $i=1$：$2L_{11}A_{11} = 2\\kappa A_{11} = \\frac{1}{\\lambda}(fA_{11}-1)$。整理得到 $2\\lambda\\kappa A_{11} = fA_{11}-1$。使用魏森伯格数 $\\mathrm{Wi} = \\lambda\\kappa$，这变为 $2\\mathrm{Wi}A_{11} = fA_{11}-1$，从而得到 $A_{11}(f-2\\mathrm{Wi}) = 1$。所以，第一个特征值是 $A_{11} = \\frac{1}{f-2\\mathrm{Wi}}$。\n- 对于 $i=2$：$2L_{22}A_{22} = -2\\kappa A_{22} = \\frac{1}{\\lambda}(fA_{22}-1)$。这得到 $-2\\mathrm{Wi}A_{22} = fA_{22}-1$，所以 $A_{22}(f+2\\mathrm{Wi}) = 1$。第二个特征值是 $A_{22} = \\frac{1}{f+2\\mathrm{Wi}}$。\n- 对于 $i=3$：$2L_{33}A_{33} = 0 = \\frac{1}{\\lambda}(fA_{33}-1)$。这意味着 $fA_{33}-1=0$。第三个特征值是 $A_{33} = \\frac{1}{f}$。\n\n$\\boldsymbol{A}$ 的特征值是：\n$$\n\\lambda_A^{(1)} = A_{11} = \\frac{1}{f - 2\\mathrm{Wi}}, \\quad \\lambda_A^{(2)} = A_{22} = \\frac{1}{f + 2\\mathrm{Wi}}, \\quad \\lambda_A^{(3)} = A_{33} = \\frac{1}{f}\n$$\n$\\boldsymbol{A}$ 的迹是其特征值之和：\n$$\n\\operatorname{tr}\\boldsymbol{A} = A_{11} + A_{22} + A_{33} = \\frac{1}{f-2\\mathrm{Wi}} + \\frac{1}{f+2\\mathrm{Wi}} + \\frac{1}{f}\n$$\n合并前两项：\n$$\n\\operatorname{tr}\\boldsymbol{A} = \\frac{(f+2\\mathrm{Wi}) + (f-2\\mathrm{Wi})}{(f-2\\mathrm{Wi})(f+2\\mathrm{Wi})} + \\frac{1}{f} = \\frac{2f}{f^2 - (2\\mathrm{Wi})^2} + \\frac{1}{f}\n$$\n$f$ 的定义为 $\\operatorname{tr}\\boldsymbol{A}$ 提供了第二个关系式：\n$$\nf = \\frac{b-3}{b-\\operatorname{tr}\\boldsymbol{A}} \\implies f(b-\\operatorname{tr}\\boldsymbol{A}) = b-3 \\implies b f - f\\operatorname{tr}\\boldsymbol{A} = b-3 \\implies \\operatorname{tr}\\boldsymbol{A} = b - \\frac{b-3}{f}\n$$\n将两个 $\\operatorname{tr}\\boldsymbol{A}$ 的表达式相等，得到 $f$ 的自洽条件：\n$$\nb - \\frac{b-3}{f} = \\frac{2f}{f^2 - 4\\mathrm{Wi}^2} + \\frac{1}{f}\n$$\n整理这个方程，我们得到所需的自洽条件：\n$$\nb - \\frac{b-2}{f} = \\frac{2f}{f^2 - 4\\mathrm{Wi}^2}\n$$\n现在，我们代入给定的数值：$b=50$ 和 $\\mathrm{Wi}=0.6$。\n$$\n50 - \\frac{50-2}{f} = \\frac{2f}{f^2 - 4(0.6)^2} \\implies 50 - \\frac{48}{f} = \\frac{2f}{f^2 - 1.44}\n$$\n为了解出 $f$，我们乘以 $f(f^2 - 1.44)$ 以消去分母（假设 $f \\neq 0$ 且 $f^2 \\neq 1.44$）：\n$$\n(50f - 48)(f^2 - 1.44) = 2f^2\n$$\n$$\n50f^3 - 50(1.44)f - 48f^2 + 48(1.44) = 2f^2\n$$\n$$\n50f^3 - 72f - 48f^2 + 69.12 = 2f^2\n$$\n这简化为三次方程：\n$$\n50f^3 - 50f^2 - 72f + 69.12 = 0\n$$\n为了使 $\\boldsymbol{A}$ 的特征值为正，我们需要 $f  2\\mathrm{Wi} = 2(0.6) = 1.2$。我们必须找到满足此条件的三次方程的根。数值解（例如，使用牛顿-拉夫逊方法）在该区域产生一个唯一的物理相关根：\n$$\nf \\approx 1.28223\n$$\n问题要求 $\\boldsymbol{A}$ 的主（最大）稳态特征值。比较特征值的分母，我们有 $f-2\\mathrm{Wi}  f  f+2\\mathrm{Wi}$。由于所有分母均为正，取倒数会反转不等式：\n$$\n\\frac{1}{f-2\\mathrm{Wi}}  \\frac{1}{f}  \\frac{1}{f+2\\mathrm{Wi}}\n$$\n因此，主特征值是 $\\lambda_A^{(\\text{principal})} = A_{11}$。\n代入 $f$ 和 $\\mathrm{Wi}$ 的值：\n$$\n\\lambda_A^{(\\text{principal})} = \\frac{1}{f - 2\\mathrm{Wi}} \\approx \\frac{1}{1.28223 - 1.2} = \\frac{1}{0.08223} \\approx 12.161\n$$\n四舍五入到四位有效数字，主特征值为 $12.16$。",
            "answer": "$$\n\\boxed{12.16}\n$$"
        },
        {
            "introduction": "掌握了稳态分析后，下一步是探索模型的瞬态响应，这在描述材料如何应对流动变化时至关重要。本练习  要求你模拟单轴拉伸流的启动过程，这是一个经典的流变测试，用于探测材料的拉伸粘度。你将把 FENE-P 和 FENE-CR 模型的控制方程转化为常微分方程组(ODEs)进行数值求解，并直接比较两种闭合近似在预测非线性粘度增长方面的差异。",
            "id": "4106734",
            "problem": "考虑一个不可压缩粘弹性流体的均匀单轴拉伸流动启动过程，该流体由有限可伸展非线性弹性 - Peterlin (FENE-P) 模型或有限可伸展非线性弹性 - Chilcott–Rallison (FENE-CR) 模型来建模。流动在时间 $t=0$ 时以恒定的拉伸速率 $\\dot{\\epsilon}0$ 启动，流体的微观结构初始处于平衡状态。任务是从第一性原理推导控制聚合物构象张量演化的常微分方程，并计算随时间变化的拉伸粘度。在程序中实现所得方程，并针对给定的测试套件评估一个指定的度量。\n\n使用以下基本和核心定义：\n\n- 聚合物微观结构由正定构象张量 $\\mathbf{A}(t)$ 描述，其初始条件为 $\\mathbf{A}(0)=\\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量。\n- 在速度梯度为 $\\nabla \\mathbf{v}$ 的空间均匀流动中，张量 $\\mathbf{A}(t)$ 的上随流导数定义为\n$$\n\\stackrel{\\triangledown}{\\mathbf{A}} = \\frac{d \\mathbf{A}}{dt} - \\mathbf{A}\\cdot \\nabla \\mathbf{v} - \\left(\\nabla \\mathbf{v}\\right)^{\\mathsf{T}}\\cdot \\mathbf{A}.\n$$\n- 单轴拉伸流的特征在于恒定的速度梯度\n$$\n\\nabla \\mathbf{v} = \\boldsymbol{\\kappa} = \\mathrm{diag}\\!\\left(\\dot{\\epsilon}, -\\frac{\\dot{\\epsilon}}{2}, -\\frac{\\dot{\\epsilon}}{2}\\right),\n$$\n使得 $\\mathbf{D} = \\frac{1}{2}\\left(\\nabla \\mathbf{v} + \\left(\\nabla \\mathbf{v}\\right)^{\\mathsf{T}}\\right) = \\boldsymbol{\\kappa}$。\n- 用于有限可伸展链的 Peterlin 函数 $f$ 定义为\n$$\nf(\\mathbf{A}) = \\frac{L^2}{L^2 - \\mathrm{tr}(\\mathbf{A})},\n$$\n其中有限可伸展性参数 $L^23$，且 $\\mathrm{tr}(\\mathbf{A}) = A_{11}+A_{22}+A_{33}$。\n- FENE-P和FENE-CR模型的构象张量演化遵循以下不同形式的方程：\n  - **FENE-P模型**:\n  $$\n  \\stackrel{\\triangledown}{\\mathbf{A}} = -\\frac{1}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right)\n  $$\n  - **FENE-CR模型**:\n  $$\n  \\stackrel{\\triangledown}{\\mathbf{A}} = -\\frac{f(\\mathbf{A})}{\\lambda}\\left(\\mathbf{A} - \\mathbf{I}\\right)\n  $$\n  其中，在本问题中，两种模型均使用相同的Peterlin函数以作直接比较。$\\lambda0$ 是聚合物松弛时间。\n- 聚合物附加应力由相应闭合近似的 Kramers 表达式给出：\n  - 对于 FENE-P 模型：\n  $$\n  \\boldsymbol{\\tau}_p = \\frac{\\eta_p}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right),\n  $$\n  - 对于 FENE-CR 模型：\n  $$\n  \\boldsymbol{\\tau}_p = \\frac{\\eta_p}{\\lambda}\\left(\\mathbf{A} - \\mathbf{I}\\right),\n  $$\n  其中 $\\eta_p0$ 是聚合物粘度贡献。\n- 溶剂（牛顿）应力为\n$$\n\\boldsymbol{\\tau}_s = 2\\eta_s \\mathbf{D} = 2\\eta_s\\,\\boldsymbol{\\kappa},\n$$\n其中溶剂粘度 $\\eta_s0$，因此总柯西应力为 $\\boldsymbol{\\sigma} = -p\\mathbf{I} + \\boldsymbol{\\tau}_s + \\boldsymbol{\\tau}_p$，其中 $p$ 是压力（在拉伸粘度计算中会抵消）。\n\n定义 Weissenberg 数 $Wi = \\lambda \\dot{\\epsilon}$ 和无量纲时间 $t^\\star = t/\\lambda$。记溶剂与总粘度之比为 $\\beta = \\eta_s/(\\eta_s+\\eta_p)$，零剪切总粘度为 $\\eta_0 = \\eta_s + \\eta_p$。单轴拉伸粘度定义为\n$$\n\\eta_E(t) = \\frac{\\sigma_{11}(t) - \\frac{1}{2}\\left(\\sigma_{22}(t) + \\sigma_{33}(t)\\right)}{\\dot{\\epsilon}},\n$$\n无量纲拉伸粘度比（由 $\\eta_0$ 归一化的 Trouton 比）为\n$$\n\\mathrm{TR}(t^\\star) = \\frac{\\eta_E(t)}{\\eta_0}.\n$$\n\n任务要求：\n\n1. 从所列的基本定义出发，推导在给定 $\\boldsymbol{\\kappa}$ 下，关于对角分量 $A_{11}(t^\\star)$、$A_{22}(t^\\star)$ 和 $A_{33}(t^\\star)$ 的耦合常微分方程，并用无量纲时间 $t^\\star$ 表示。推导过程必须使用上随流导数和 Peterlin 函数，不得调用基本定义之外的任何快捷公式。\n2. 使用 $\\boldsymbol{\\tau}_p$ 和 $\\boldsymbol{\\tau}_s$ 的定义，将 $\\mathrm{TR}(t^\\star)$ 用 $\\beta$、$Wi$、模型选择（FENE-P 或 FENE-CR）以及演化中的构象分量 $A_{ii}(t^\\star)$ 表示。\n3. 实现一个程序，该程序：\n   - 对每个测试用例，将推导出的方程组从 $t^\\star=0$ 积分到 $t^\\star=t^\\star_{\\text{end}}$，\n   - 在积分区间上评估 $\\mathrm{TR}(t^\\star)$，\n   - 对每个测试用例，返回在 $[0, t^\\star_{\\text{end}}]$ 上达到的 $\\mathrm{TR}(t^\\star)$ 的最大值。\n4. 有限可伸展性约束：在整个积分过程中强制满足 $\\mathrm{tr}(\\mathbf{A})  L^2$。\n\n测试套件：\n- 测试用例1：模型='FENE-P'，Wi=0.5，$L^2$=100.0，$\\beta$=0.2，$t^\\star_{\\text{end}}$=4.0\n- 测试用例2：模型='FENE-CR'，Wi=0.5，$L^2$=100.0，$\\beta$=0.2，$t^\\star_{\\text{end}}$=4.0\n- 测试用例3：模型='FENE-P'，Wi=2.0，$L^2$=10.0，$\\beta$=0.1，$t^\\star_{\\text{end}}$=1.0\n- 测试用例4：模型='FENE-CR'，Wi=2.0，$L^2$=10.0，$\\beta$=0.1，$t^\\star_{\\text{end}}$=1.0\n- 测试用例5：模型='FENE-P'，Wi=0.3，$L^2=10^6$，$\\beta$=0.5，$t^\\star_{\\text{end}}$=20.0\n- 测试用例6：模型='FENE-P'，Wi=0.1，$L^2$=3.3，$\\beta$=0.3，$t^\\star_{\\text{end}}$=10.0\n\n对于每个测试用例，将最大$\\mathrm{TR}$值报告为浮点数。您的函数应返回一个包含6个浮点数的列表，每个浮点数对应一个测试用例，并保留8位小数。",
            "solution": "问题陈述经评估是有效的。它在科学上基于非牛顿流体力学的既定原理，特别是 FENE-P 和 FENE-CR 本构模型。所有定义、参数和约束都已提供，使得问题是自包含、适定且客观的。该任务要求从第一性原理进行严格推导，然后进行数值实现，这是计算流变学中的一个标准练习。陈述中没有矛盾、歧义或事实性错误。\n\n求解过程分为三个部分：首先，推导控制常微分方程 (ODEs)；其次，推导无量纲拉伸粘度的表达式；第三，概述数值实现。\n\n**1. 控制常微分方程的推导**\n\n构象张量 $\\mathbf{A}$ 的演化由其上随流导数给出。对于空间均匀流动，$\\frac{d \\mathbf{A}}{dt} = \\mathbf{A}\\cdot \\nabla \\mathbf{v} + \\left(\\nabla \\mathbf{v}\\right)^{\\mathsf{T}}\\cdot \\mathbf{A} + \\stackrel{\\triangledown}{\\mathbf{A}}$。\n流动是均匀单轴拉伸，其特征在于恒定的速度梯度 $\\nabla \\mathbf{v} = \\boldsymbol{\\kappa} = \\mathrm{diag}\\!\\left(\\dot{\\epsilon}, -\\frac{\\dot{\\epsilon}}{2}, -\\frac{\\dot{\\epsilon}}{2}\\right)$。由于 $\\boldsymbol{\\kappa}$ 是一个对角张量，其转置等于其自身。初始条件为 $\\mathbf{A}(0) = \\mathbf{I}$，这是一个对角张量。由于 $\\boldsymbol{\\kappa}$ 也是对角的，张量 $\\mathbf{A}(t)$ 在所有时间 $t \\ge 0$ 内将保持对角。设 $\\mathbf{A}(t) = \\mathrm{diag}(A_{11}(t), A_{22}(t), A_{33}(t))$。\n对于对角张量，方程简化为：\n$$\n\\frac{d \\mathbf{A}}{dt} = 2 \\boldsymbol{\\kappa} \\cdot \\mathbf{A} + \\stackrel{\\triangledown}{\\mathbf{A}}\n$$\n我们可以为对角元素 $A_{ii}$ 写出该方程的分量形式：\n$$\n\\frac{d A_{ii}}{dt} = 2 \\kappa_{ii} A_{ii} + (\\stackrel{\\triangledown}{\\mathbf{A}})_{ii}\n$$\n$A_{22}$ 和 $A_{33}$ 的方程是相同的，它们的初始条件也相同 ($A_{22}(0)=A_{33}(0)=1$)。因此，对于所有 $t$，$A_{22}(t) = A_{33}(t)$。这种轴对称性将系统简化为两个独立的方程。$\\mathbf{A}$ 的迹为 $\\mathrm{tr}(\\mathbf{A}) = A_{11} + 2 A_{22}$。\n\n为了进行无量纲化，我们引入 $t^\\star = t/\\lambda$ 和 Weissenberg 数 $Wi = \\lambda \\dot{\\epsilon}$。时间导数变为 $\\frac{d}{dt} = \\frac{1}{\\lambda}\\frac{d}{dt^\\star}$。\n\n**对于 FENE-P 模型：**\n$\\stackrel{\\triangledown}{\\mathbf{A}} = -\\frac{1}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right)$\n分量形式为 $(\\stackrel{\\triangledown}{\\mathbf{A}})_{ii} = -\\frac{1}{\\lambda}(f(\\mathbf{A})A_{ii}-1)$。\n$$\n\\frac{1}{\\lambda}\\frac{d A_{11}}{dt^\\star} = \\frac{2 Wi}{\\lambda} A_{11} - \\frac{1}{\\lambda}\\left(f(\\mathbf{A}) A_{11} - 1\\right) \\implies \\frac{d A_{11}}{dt^\\star} = 2 Wi A_{11} - f(\\mathbf{A}) A_{11} + 1\n$$\n$$\n\\frac{1}{\\lambda}\\frac{d A_{22}}{dt^\\star} = -\\frac{Wi}{\\lambda} A_{22} - \\frac{1}{\\lambda}\\left(f(\\mathbf{A}) A_{22} - 1\\right) \\implies \\frac{d A_{22}}{dt^\\star} = -Wi A_{22} - f(\\mathbf{A}) A_{22} + 1\n$$\n\n**对于 FENE-CR 模型：**\n$\\stackrel{\\triangledown}{\\mathbf{A}} = -\\frac{f(\\mathbf{A})}{\\lambda}\\left(\\mathbf{A} - \\mathbf{I}\\right)$\n分量形式为 $(\\stackrel{\\triangledown}{\\mathbf{A}})_{ii} = -\\frac{f(\\mathbf{A})}{\\lambda}(A_{ii}-1)$。\n$$\n\\frac{1}{\\lambda}\\frac{d A_{11}}{dt^\\star} = \\frac{2 Wi}{\\lambda} A_{11} - \\frac{f(\\mathbf{A})}{\\lambda}\\left(A_{11} - 1\\right) \\implies \\frac{d A_{11}}{dt^\\star} = 2 Wi A_{11} - f(\\mathbf{A}) (A_{11} - 1)\n$$\n$$\n\\frac{1}{\\lambda}\\frac{d A_{22}}{dt^\\star} = -\\frac{Wi}{\\lambda} A_{22} - \\frac{f(\\mathbf{A})}{\\lambda}\\left(A_{22} - 1\\right) \\implies \\frac{d A_{22}}{dt^\\star} = -Wi A_{22} - f(\\mathbf{A}) (A_{22} - 1)\n$$\n在两种情况下，Peterlin 函数均为 $f(\\mathbf{A}) = \\frac{L^2}{L^2 - (A_{11} + 2A_{22})}$。初始条件为 $A_{11}(0)=1$ 和 $A_{22}(0)=1$。\n\n**2. 无量纲拉伸粘度的推导**\n\n单轴拉伸粘度为 $\\eta_E(t) = \\frac{\\sigma_{11}(t) - \\frac{1}{2}\\left(\\sigma_{22}(t) + \\sigma_{33}(t)\\right)}{\\dot{\\epsilon}}$。\n总柯西应力为 $\\boldsymbol{\\sigma} = -p\\mathbf{I} + \\boldsymbol{\\tau}_s + \\boldsymbol{\\tau}_p$。由于轴对称性（$A_{22}=A_{33}$ 且 $\\kappa_{22}=\\kappa_{33}$），我们有 $\\sigma_{22}=\\sigma_{33}$。$\\eta_E$ 的定义简化为：\n$$\n\\eta_E(t) = \\frac{\\sigma_{11}(t) - \\sigma_{22}(t)}{\\dot{\\epsilon}} = \\frac{(\\tau_s)_{11} - (\\tau_s)_{22}}{\\dot{\\epsilon}} + \\frac{(\\tau_p)_{11} - (\\tau_p)_{22}}{\\dot{\\epsilon}}\n$$\n溶剂的贡献来自 $\\boldsymbol{\\tau}_s = 2\\eta_s \\boldsymbol{\\kappa}$，为 $3\\eta_s$。\n\n聚合物的贡献取决于模型。\n对于 FENE-P 模型，$\\boldsymbol{\\tau}_p = \\frac{\\eta_p}{\\lambda}\\left(f(\\mathbf{A})\\,\\mathbf{A} - \\mathbf{I}\\right)$。\n$(\\tau_p)_{11} - (\\tau_p)_{22} = \\frac{\\eta_p}{\\lambda}f(\\mathbf{A})(A_{11} - A_{22})$。\n聚合物对 $\\eta_E$ 的贡献为 $\\frac{\\eta_p}{Wi}f(\\mathbf{A})(A_{11} - A_{22})$。\n\n对于 FENE-CR 模型，$\\boldsymbol{\\tau}_p = \\frac{\\eta_p}{\\lambda}\\left(\\mathbf{A} - \\mathbf{I}\\right)$。\n$(\\tau_p)_{11} - (\\tau_p)_{22} = \\frac{\\eta_p}{\\lambda}(A_{11} - A_{22})$。\n聚合物对 $\\eta_E$ 的贡献为 $\\frac{\\eta_p}{Wi}(A_{11} - A_{22})$。\n\n无量纲拉伸粘度比为 $\\mathrm{TR}(t^\\star) = \\eta_E(t)/\\eta_0$。使用 $\\eta_s = \\beta \\eta_0$ 和 $\\eta_p = (1-\\beta)\\eta_0$：\n$$\n\\mathrm{TR}(t^\\star) = 3\\beta + \\frac{(\\eta_E)_p}{\\eta_0}\n$$\n对于 FENE-P 模型：\n$$\n\\mathrm{TR}(t^\\star) = 3\\beta + \\frac{1-\\beta}{Wi} f(\\mathbf{A}(t^\\star)) (A_{11}(t^\\star) - A_{22}(t^\\star))\n$$\n对于 FENE-CR 模型：\n$$\n\\mathrm{TR}(t^\\star) = 3\\beta + \\frac{1-\\beta}{Wi} (A_{11}(t^\\star) - A_{22}(t^\\star))\n$$\n\n**3. 数值实现策略**\n\n该问题通过将推导出的两个非线性常微分方程组视为一个初值问题 (IVP) 来进行数值求解。状态向量为 $\\mathbf{y}(t^\\star) = [A_{11}(t^\\star), A_{22}(t^\\star)]^{\\mathsf{T}}$，初始条件为 $\\mathbf{y}(0) = [1, 1]^{\\mathsf{T}}$。\n采用 SciPy 函数 `scipy.integrate.solve_ivp` 来执行数值积分。一个自适应步长的 Runge-Kutta 方法（例如 `RK45`）是合适的。\n一个关键方面是强制执行有限可伸展性约束 $\\mathrm{tr}(\\mathbf{A})  L^2$。当迹接近 $L^2$ 时，Peterlin 函数 $f(\\mathbf{A})$ 发散，使得常微分方程组变得无限刚性。使用 `solve_ivp` 函数的事件处理机制来管理这一点。定义一个事件函数，当约束被违反时（即 $L^2 - \\mathrm{tr}(\\mathbf{A}) = 0$），该函数的值为零。通过将此事件设置为终止事件，积分会在达到物理极限前平稳地停止。\n对于每个测试用例，程序将常微分方程组从 $t^\\star=0$ 积分到 $t^\\star=t^\\star_{\\text{end}}$ 或直到达到可伸展性极限。解在一系列离散时间点上进行评估。在每个点上，使用相应的推导公式计算无量纲拉伸粘度 $\\mathrm{TR}(t^\\star)$。最后，确定并报告在整个计算时间区间内 $\\mathrm{TR}(t^\\star)$ 的最大值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the FENE-P/CR model equations for uniaxial extensional flow\n    and calculates the maximum dimensionless extensional viscosity.\n    \"\"\"\n    test_cases = [\n        ('FENE-P', 0.5, 100.0, 0.2, 4.0),\n        ('FENE-CR', 0.5, 100.0, 0.2, 4.0),\n        ('FENE-P', 2.0, 10.0, 0.1, 1.0),\n        ('FENE-CR', 2.0, 10.0, 0.1, 1.0),\n        ('FENE-P', 0.3, 1e6, 0.5, 20.0),\n        ('FENE-P', 0.1, 3.3, 0.3, 10.0),\n    ]\n\n    results = []\n\n    def ode_system(t, y, Wi, L2, model_type):\n        \"\"\"\n        Defines the system of ODEs for the conformation tensor components.\n        y[0] = A11, y[1] = A22.\n        \"\"\"\n        A11, A22 = y\n        trace_A = A11 + 2 * A22\n        \n        if trace_A >= L2:\n            return [0.0, 0.0]\n            \n        f_A = L2 / (L2 - trace_A)\n        \n        if model_type == 'FENE-P':\n            dA11_dt = 1.0 - f_A * A11 + 2.0 * Wi * A11\n            dA22_dt = 1.0 - f_A * A22 - Wi * A22\n        elif model_type == 'FENE-CR':\n            dA11_dt = 2.0 * Wi * A11 - f_A * (A11 - 1.0)\n            dA22_dt = -Wi * A22 - f_A * (A22 - 1.0)\n        else:\n            raise ValueError(\"Unknown model type\")\n            \n        return [dA11_dt, dA22_dt]\n\n    def L2_limit(t, y, Wi, L2, model_type):\n        \"\"\"\n        Event function to stop integration when tr(A) approaches L^2.\n        \"\"\"\n        return L2 - (y[0] + 2 * y[1])\n    L2_limit.terminal = True\n    L2_limit.direction = -1\n\n    for case in test_cases:\n        model, Wi, L2, beta, t_end_star = case\n        \n        y0 = np.array([1.0, 1.0])\n        t_span = [0.0, t_end_star]\n        \n        t_eval = np.linspace(t_span[0], t_span[1], 1001)\n        \n        sol = solve_ivp(\n            fun=ode_system, \n            t_span=t_span, \n            y0=y0, \n            args=(Wi, L2, model),\n            method='RK45', \n            t_eval=t_eval, \n            events=L2_limit,\n            rtol=1e-8,\n            atol=1e-10\n        )\n        \n        if sol.y.shape[1] == 0:\n            results.append(3.0 * beta)\n            continue\n            \n        A11 = sol.y[0]\n        A22 = sol.y[1]\n        \n        poly_contrib = None\n        if model == 'FENE-P':\n            trace_A = A11 + 2 * A22\n            safe_mask = trace_A  L2\n            if not np.all(safe_mask):\n                A11 = A11[safe_mask]\n                A22 = A22[safe_mask]\n                trace_A = trace_A[safe_mask]\n\n            if A11.size == 0:\n                results.append(3.0 * beta)\n                continue\n\n            f_A = L2 / (L2 - trace_A)\n            poly_contrib = ((1.0 - beta) / Wi) * f_A * (A11 - A22)\n            \n        elif model == 'FENE-CR':\n            poly_contrib = ((1.0 - beta) / Wi) * (A11 - A22)\n            \n        tr_values = 3.0 * beta + poly_contrib\n        \n        if tr_values.size > 0:\n            max_tr = np.max(tr_values)\n        else:\n            max_tr = 3.0 * beta\n            \n        results.append(max_tr)\n        \n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "本章的最终练习将带你进入非线性粘弹性的前沿领域，模拟大振幅振荡剪切（LAOS）实验，这种循环加载在材料加工和生物力学中很常见。在此练习  中，你将通过计算应力-应变曲线形成的迟滞环面积来量化每个周期内耗散的能量。这项实践不仅能加深你对 FENE-P 和 FENE-CR 模型在非线性区域行为差异的理解，还能让你掌握一种分析复杂流变特征的强大计算工具。",
            "id": "4106659",
            "problem": "考虑具有 Peterlin 闭合和 Chilcott–Rallison 闭合的有限可伸长非线性弹性模型，即有限可伸长非线性弹性-Peterlin (FENE-P) 模型和有限可伸长非线性弹性-Chilcott–Rallison (FENE-CR) 模型，用于研究聚合物溶液在简单剪切循环载荷下的行为。目标是计算大振幅振荡剪切下剪切应力-应变图中每个周期的滞后环面积，并在一小组科学上真实的参数集上比较 FENE-P 和 FENE-CR 模型的响应。\n\n使用的基本核心定义：\n- 流体被建模为动理论哑铃系综，其二阶矩构象张量用 $A$ 表示，并根据经有限可伸长性修正的上随流导数演化。\n- 速度场为简单剪切 $u_x(y,t)$，剪切速率为 $\\dot{\\gamma}(t)$，由振荡应变 $\\gamma(t) = \\gamma_0 \\sin(\\omega t)$ 给出，因此 $\\dot{\\gamma}(t) = \\gamma_0 \\omega \\cos(\\omega t)$，其中 $\\gamma_0$ 是应变幅值（无量纲），$\\omega$ 是角频率（单位为弧度/秒）。\n- 速度梯度张量为 $K = \\nabla u$，对于二维简单剪切，其形式为：\n$$K = \\begin{bmatrix} 0  \\dot{\\gamma}(t) \\\\ 0  0 \\end{bmatrix}$$\n- 有限可伸长性参数为 $b  \\mathrm{tr}(A)$，Peterlin 函数为 $f(A) = \\dfrac{b}{b - \\mathrm{tr}(A)}$。\n- 聚合物的特征松弛时间为 $\\lambda$（单位为秒），聚合物对粘度的贡献为 $\\eta_p$（单位为帕斯卡-秒）。本问题中忽略溶剂粘度。\n- 每单位体积每周期耗散的能量等于剪切应力-应变图中滞后环的有向面积，即在一个周期 $T = 2\\pi/\\omega$ 上的线积分：\n$$W = \\oint \\tau_{xy} \\, d\\gamma = \\int_0^T \\tau_{xy}(t) \\, \\dot{\\gamma}(t) \\, dt$$\n其中 $\\tau_{xy}(t)$ 是聚合物应力张量的剪切分量。\n\n任务：\n1. 从具有有限可伸长性的构象张量的上随流演化方程出发，为 FENE-P 和 FENE-CR 两种闭合模型，在简单剪切条件下推导构象张量 $A$ 的二维演化方程。不要做任何线性化假设。清晰地说明 FENE-P 和 FENE-CR 模型之间松弛项的区别，以及在每个模型中聚合物应力是如何计算的。\n2. 解释如何对得到的非线性常微分方程 (ODEs) 进行数值积分，以在振荡剪切下达到周期性稳态。算法必须通过维持 $\\mathrm{tr}(A)  b$ 来确保 $f(A)$ 保持有限，并且必须在瞬态衰减后，计算最后一个振荡周期的 $W$。\n3. 实现一个完整的程序，该程序能够：\n   - 针对 FENE-P 和 FENE-CR 模型，在 $\\gamma(t) = \\gamma_0 \\sin(\\omega t)$ 条件下积分构象张量 ODEs。\n   - 在舍弃瞬态后，使用公式 $W = \\int_0^T \\tau_{xy}(t) \\, \\dot{\\gamma}(t) \\, dt$ 计算最后一个周期的滞后环面积 $W$（单位体积能量，单位为帕斯卡）。\n   - 使用以下参数值测试套件，这些参数值都具有科学合理性，旨在探索不同的行为区间：\n     - 测试用例 1（中等振幅，近线性可伸长性）：$\\gamma_0 = 1.0$, $\\omega = 2.0 \\, \\mathrm{rad/s}$, $\\lambda = 0.5 \\, \\mathrm{s}$, $\\eta_p = 1.0 \\, \\mathrm{Pa \\cdot s}$, $b = 50.0$。\n     - 测试用例 2（大振幅，显著的有限可伸长性）：$\\gamma_0 = 5.0$, $\\omega = 1.0 \\, \\mathrm{rad/s}$, $\\lambda = 1.0 \\, \\mathrm{s}$, $\\eta_p = 1.0 \\, \\mathrm{Pa \\cdot s}$, $b = 10.0$。\n     - 测试用例 3（小振幅，高频率，极大的 $b$ 值以近似 Oldroyd-B 行为）：$\\gamma_0 = 0.1$, $\\omega = 10.0 \\, \\mathrm{rad/s}$, $\\lambda = 0.1 \\, \\mathrm{s}$, $\\eta_p = 0.5 \\, \\mathrm{Pa \\cdot s}$, $b = 1000.0$。\n     - 测试用例 4（边界可伸长性接近二维平衡迹）：$\\gamma_0 = 0.2$, $\\omega = 1.0 \\, \\mathrm{rad/s}$, $\\lambda = 2.0 \\, \\mathrm{s}$, $\\eta_p = 0.8 \\, \\mathrm{Pa \\cdot s}$, $b = 3.0$。\n   - 对于每个测试用例，返回一个包含两个浮点数的列表：分别是 FENE-P 和 FENE-CR 模型的每周期滞后环面积 $W$。每个 $W$ 必须以帕斯卡为单位，并四舍五入到六位小数。\n4. 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素对应一个测试用例，本身也是一个形如 $[W_{\\mathrm{P}}, W_{\\mathrm{CR}}]$ 的列表，例如：$[[W_{\\mathrm{P1}}, W_{\\mathrm{CR1}}],[W_{\\mathrm{P2}}, W_{\\mathrm{CR2}}],...]$。\n\n角度单位说明：对 $\\omega$以及 $\\sin(\\cdot)$ 和 $\\cos(\\cdot)$ 的参数使用弧度。\n\n物理单位说明：报告每周期滞后环面积 $W$，单位为帕斯卡，四舍五入到六位小数。\n\n通过选择足够的周期以消除瞬态，并为每个周期选择足够精细的时间分辨率以精确计算 $W$ 的积分，来确保数值稳定性和科学真实性。",
            "solution": "该问题要求对大振幅振荡剪切 (LAOS) 下的聚合物溶液，建立有限可伸长非线性弹性-Peterlin (FENE-P) 模型和有限可伸长非线性弹性-Chilcott–Rallison (FENE-CR) 模型，进行数值求解和比较。目标是计算每单位体积每周期耗散的能量，即滞后环面积 $W$。\n\n### 步骤 1：控制方程的建立\n\n聚合物微观结构的动力学由二阶矩构象张量 $A$ 描述，它是一个无量纲、对称、正定的张量。其演化遵循上随流时间导数框架。对于均匀简单剪切流，其速度场为 $u_x(y,t) = \\dot{\\gamma}(t)y$，$A$ 的一般演化方程简化为：\n$$ \\frac{dA}{dt} = K A + A K^T - \\frac{1}{\\lambda} g(A) $$\n这里，$t$ 是时间，$\\lambda$ 是聚合物松弛时间，$K$ 是速度梯度张量。对于二维 (2D) 简单剪切，$K$ 由下式给出：\n$$ K(t) = \\begin{bmatrix} 0  \\dot{\\gamma}(t) \\\\ 0  0 \\end{bmatrix} $$\n其中剪切速率 $\\dot{\\gamma}(t)$ 由施加的振荡应变 $\\gamma(t) = \\gamma_0 \\sin(\\omega t)$ 导出：\n$$ \\dot{\\gamma}(t) = \\frac{d\\gamma}{dt} = \\gamma_0 \\omega \\cos(\\omega t) $$\n项 $K A + A K^T$ 表示聚合物链因流动而发生的形变。对于对称张量 $A = \\begin{bmatrix} A_{xx}  A_{xy} \\\\ A_{xy}  A_{yy} \\end{bmatrix}$，该项计算为：\n$$ K A + A K^T = \\begin{bmatrix} 2\\dot{\\gamma}(t) A_{xy}  \\dot{\\gamma}(t) A_{yy} \\\\ \\dot{\\gamma}(t) A_{yy}  0 \\end{bmatrix} $$\n项 $g(A)$ 表示在布朗运动驱动和聚合物熵弹力作用下，聚合物链向平衡态的松弛过程。$g(A)$ 的具体形式及相关的聚合物应力张量 $\\tau_p$ 区分了 FENE-P 和 FENE-CR 模型。两种模型都使用 Peterlin 函数 $f(A)$ 来考虑有限可伸长性：\n$$ f(A) = \\frac{b}{b - \\mathrm{tr}(A)} $$\n其中 $b$ 是有限可伸长性参数。该函数引入了强非线性，因为当由 $\\mathrm{tr}(A)$ 表示的聚合物链的均方端到端距离接近极限 $b$ 时，弹簧力会发散。\n\n**FENE-P 模型**\n在 FENE-P 模型中，Peterlin 闭合近似应用于平均弹簧力项，同时影响了演化方程和应力张量表达式。\n松弛项为 $g(A) = f(A)A - I$，其中 $I$ 是单位张量。$A$ 的演化方程为：\n$$ \\frac{dA}{dt} = K A + A K^T - \\frac{1}{\\lambda} (f(A)A - I) $$\n聚合物应力张量由带有 Peterlin 近似的 Kramers 表达式给出：\n$$ \\tau_p = \\frac{\\eta_p}{\\lambda} (f(A)A - I) $$\n其中 $\\eta_p$ 是聚合物对粘度的贡献。以分量形式表示，$A$ 的唯一分量的常微分方程 (ODEs) 组为：\n$$ \\frac{dA_{xx}}{dt} = 2\\dot{\\gamma}(t)A_{xy} - \\frac{1}{\\lambda} \\left( \\frac{b}{b - (A_{xx}+A_{yy})} A_{xx} - 1 \\right) $$\n$$ \\frac{dA_{yy}}{dt} = -\\frac{1}{\\lambda} \\left( \\frac{b}{b - (A_{xx}+A_{yy})} A_{yy} - 1 \\right) $$\n$$ \\frac{dA_{xy}}{dt} = \\dot{\\gamma}(t)A_{yy} - \\frac{1}{\\lambda} \\left( \\frac{b}{b - (A_{xx}+A_{yy})} A_{xy} \\right) $$\n计算 $W$ 所需的剪切应力分量 $\\tau_{xy}$ 是：\n$$ \\tau_{xy}(t) = \\frac{\\eta_p}{\\lambda} \\left( \\frac{b}{b - (A_{xx}(t)+A_{yy}(t))} A_{xy}(t) \\right) $$\n\n**FENE-CR 模型**\n在 FENE-CR 模型中，闭合近似的应用方式不同。Peterlin 函数修正了松弛过程，但没有直接出现在应力张量表达式中。\n松弛项为 $g(A) = f(A)(A-I)$。$A$ 的演化方程为：\n$$ \\frac{dA}{dt} = K A + A K^T - \\frac{f(A)}{\\lambda} (A-I) $$\n聚合物应力张量由 Giesekus 表达式给出：\n$$ \\tau_p = \\frac{\\eta_p}{\\lambda} (A - I) $$\n以分量形式表示，ODE 系统为：\n$$ \\frac{dA_{xx}}{dt} = 2\\dot{\\gamma}(t)A_{xy} - \\frac{1}{\\lambda} \\frac{b}{b - (A_{xx}+A_{yy})} (A_{xx} - 1) $$\n$$ \\frac{dA_{yy}}{dt} = -\\frac{1}{\\lambda} \\frac{b}{b - (A_{xx}+A_{yy})} (A_{yy} - 1) $$\n$$ \\frac{dA_{xy}}{dt} = \\dot{\\gamma}(t)A_{yy} - \\frac{1}{\\lambda} \\frac{b}{b - (A_{xx}+A_{yy})} A_{xy} $$\n剪切应力分量 $\\tau_{xy}$ 是：\n$$ \\tau_{xy}(t) = \\frac{\\eta_p}{\\lambda} (A_{xy}(t)) $$\n根本区别在于非线性函数 $f(A)$ 的应用位置。在 FENE-P 模型中，它在演化和应力表达式中都对构象张量 $A$ 进行缩放。而在 FENE-CR 模型中，它在演化方程中对松弛驱动力 $(A-I)$ 进行缩放，而应力仍然是 $(A-I)$ 的线性函数。\n\n### 步骤 2：数值积分算法\n\n为计算滞后环面积 $W$，必须对每个模型的 ODE 系统进行时间积分，直到达到周期性稳态。\n\n1.  **初始条件**：积分从平衡态（无流动，$\\dot{\\gamma}=0$）开始。通过设置 $\\frac{dA}{dt}=0$ 和 $K=0$ 来找到平衡构象张量 $A_0$。\n    -   对于 FENE-P 模型：$g(A_0) = f(A_0)A_0 - I = 0$。在二维情况下，解为 $A_0 = \\frac{b}{b+2}I$。初始状态为 $A_{xx}(0) = A_{yy}(0) = \\frac{b}{b+2}$ 且 $A_{xy}(0) = 0$。\n    -   对于 FENE-CR 模型：$g(A_0) = f(A_0)(A_0-I) = 0$。由于 $f(A_0)$ 在平衡时是有限的，这要求 $A_0=I$。初始状态为 $A_{xx}(0) = A_{yy}(0) = 1$ 且 $A_{xy}(0) = 0$。\n\n2.  **时间积分**：这个包含三个耦合、非线性的一阶 ODE 系统需要进行数值求解。我们使用一个隐式、自适应步长的求解器，例如后向分化公式 (BDF) 方法，它非常适合处理可能出现的刚性系统，特别是当 $\\mathrm{tr}(A)$ 接近 $b$ 时。积分会进行足够数量的振荡周期（例如 20 个周期），以确保任何初始瞬态都已衰减，系统已进入周期性稳态，此时 $A(t)$ 在一个周期内的轨迹会重复。\n\n3.  **滞后环面积计算**：每单位体积每周期耗散的能量 $W$ 在模拟的最后一个周期内计算（例如，从 $t_{start} = 19T$ 到 $t_{end} = 20T$，其中 $T = 2\\pi/\\omega$）。公式为：\n    $$ W = \\int_{t_{start}}^{t_{end}} \\tau_{xy}(t) \\dot{\\gamma}(t) dt $$\n    ODE 求解器被配置为在最后一个周期内的一系列密集时间点上输出解 $(A_{xx}(t), A_{yy}(t), A_{xy}(t))$。在每个点 $t_i$，我们计算相应的 $\\tau_{xy}(t_i)$ 和 $\\dot{\\gamma}(t_i)$ 的值。然后使用高阶求积法则（如辛普森法则）对定积分进行数值计算，以确保精度。\n\n4.  **数值稳定性**：当 $\\mathrm{tr}(A) \\to b$ 时，$f(A)$ 的发散性带来了数值挑战。通过使用一个鲁棒的、自适应的 ODE 求解器（如带有 `'BDF'` 方法的 `scipy.integrate.solve_ivp`）并设置严格的误差容限（`rtol=1e-6`, `atol=1e-9`），当解接近奇点时，时间步长会自动减小，从而维持约束 $\\mathrm{tr}(A)  b$ 并确保解的稳定性和准确性。对于给定的测试用例，这种方法是足够的。\n\n该程序将对 FENE-P 和 FENE-CR 模型分别实施，以计算并比较它们各自的滞后环面积 $W_P$ 和 $W_{CR}$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp, simpson\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the hysteresis area per cycle (W) for FENE-P and FENE-CR models\n    under large-amplitude oscillatory shear.\n    \"\"\"\n    \n    # Test cases: (gamma0, omega, lam, eta_p, b)\n    test_cases = [\n        (1.0, 2.0, 0.5, 1.0, 50.0),   # Case 1\n        (5.0, 1.0, 1.0, 1.0, 10.0),   # Case 2\n        (0.1, 10.0, 0.1, 0.5, 1000.0), # Case 3\n        (0.2, 1.0, 2.0, 0.8, 3.0),    # Case 4\n    ]\n\n    all_results = []\n\n    for params in test_cases:\n        gamma0, omega, lam, eta_p, b = params\n        \n        # Calculate hysteresis area for FENE-P\n        W_p = calculate_hysteresis(\n            'FENE-P', gamma0, omega, lam, eta_p, b\n        )\n        \n        # Calculate hysteresis area for FENE-CR\n        W_cr = calculate_hysteresis(\n            'FENE-CR', gamma0, omega, lam, eta_p, b\n        )\n        \n        all_results.append([round(W_p, 6), round(W_cr, 6)])\n\n    # Format the final output as specified\n    formatted_results = \"[\" + \",\".join(map(str, all_results)) + \"]\"\n    print(formatted_results.replace(\" \", \"\"))\n\n\ndef calculate_hysteresis(model_type, gamma0, omega, lam, eta_p, b):\n    \"\"\"\n    Calculates the hysteresis area W for a given model and parameters.\n    \n    Args:\n        model_type (str): 'FENE-P' or 'FENE-CR'.\n        gamma0 (float): Strain amplitude.\n        omega (float): Angular frequency (rad/s).\n        lam (float): Polymer relaxation time (s).\n        eta_p (float): Polymer viscosity contribution (Pa.s).\n        b (float): Finite extensibility parameter.\n        \n    Returns:\n        float: The calculated hysteresis area W (in Pa).\n    \"\"\"\n\n    # Shear rate function\n    def shear_rate(t):\n        return gamma0 * omega * np.cos(omega * t)\n\n    if model_type == 'FENE-P':\n        # ODE system for FENE-P model\n        def ode_system(t, y):\n            A_xx, A_yy, A_xy = y\n            trace_A = A_xx + A_yy\n            \n            # Check for physical validity, though solve_ivp should handle this\n            if trace_A >= b:\n                return [0, 0, 0] \n            \n            f_A = b / (b - trace_A)\n            dot_gamma_t = shear_rate(t)\n            \n            dAxx_dt = 2 * dot_gamma_t * A_xy - (1 / lam) * (f_A * A_xx - 1)\n            dAyy_dt = - (1 / lam) * (f_A * A_yy - 1)\n            dAxy_dt = dot_gamma_t * A_yy - (1 / lam) * f_A * A_xy\n            \n            return [dAxx_dt, dAyy_dt, dAxy_dt]\n        \n        # Equilibrium initial conditions for FENE-P in 2D\n        d = 2.0\n        A_eq = b / (b + d)\n        y0 = [A_eq, A_eq, 0.0]\n\n    elif model_type == 'FENE-CR':\n        # ODE system for FENE-CR model\n        def ode_system(t, y):\n            A_xx, A_yy, A_xy = y\n            trace_A = A_xx + A_yy\n\n            if trace_A >= b:\n                return [0, 0, 0]\n\n            f_A = b / (b - trace_A)\n            dot_gamma_t = shear_rate(t)\n            \n            dAxx_dt = 2 * dot_gamma_t * A_xy - (f_A / lam) * (A_xx - 1)\n            dAyy_dt = - (f_A / lam) * (A_yy - 1)\n            dAxy_dt = dot_gamma_t * A_yy - (f_A / lam) * A_xy\n            \n            return [dAxx_dt, dAyy_dt, dAxy_dt]\n            \n        # Equilibrium initial conditions for FENE-CR\n        y0 = [1.0, 1.0, 0.0]\n    else:\n        raise ValueError(\"Unknown model type\")\n\n    # Time parameters\n    T_period = 2 * np.pi / omega\n    num_transient_cycles = 19\n    num_integration_cycles = 1\n    t_start = 0.0\n    t_end = (num_transient_cycles + num_integration_cycles) * T_period\n    \n    # Time points for the final cycle for high-accuracy integration\n    t_eval_start = num_transient_cycles * T_period\n    num_points_in_cycle = 2001 # Odd number for Simpson's rule\n    t_eval = np.linspace(t_eval_start, t_end, num_points_in_cycle)\n\n    # Solve the system of ODEs\n    sol = solve_ivp(\n        ode_system, \n        (t_start, t_end), \n        y0, \n        method='BDF', \n        t_eval=t_eval,\n        rtol=1e-7,\n        atol=1e-10\n    )\n    \n    A_xx_sol, A_yy_sol, A_xy_sol = sol.y\n    t_sol = sol.t\n\n    # Calculate shear stress and integrand for W\n    dot_gamma_vals = shear_rate(t_sol)\n    \n    if model_type == 'FENE-P':\n        trace_A_sol = A_xx_sol + A_yy_sol\n        f_A_sol = b / (b - trace_A_sol)\n        tau_xy = (eta_p / lam) * f_A_sol * A_xy_sol\n    else: # FENE-CR\n        tau_xy = (eta_p / lam) * A_xy_sol\n        \n    integrand = tau_xy * dot_gamma_vals\n\n    # Compute the integral for W using Simpson's rule for accuracy\n    W = simpson(integrand, x=t_sol)\n    \n    return W\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}