{
    "hands_on_practices": [
        {
            "introduction": "泊松方程是静电学的基石，它将电势与电荷密度联系在一起。本练习提供了通过解析方法求解此类边值问题的基础实践。在处理包含离子输运的完全耦合系统之前，掌握这一步骤对于理解PNP方程中的“P”（泊松）至关重要。",
            "id": "4085804",
            "problem": "考虑在平面一维区域 $x \\in [0, L]$（其中 $L  0$）内电解质的动电输运。在泊松-能斯特-普朗克 (PNP) 框架下，静电势 $\\phi(x)$ 通过静电学高斯定律以及电场和电位移的本构关系与电荷密度 $\\rho_{e}(x)$ 相耦合。假设介电常数是恒定的，等于 $\\epsilon  0$。总电荷密度规定为 $\\rho_{e}(x) = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$，其中 $\\rho_{0}$ 是一个常数。电势满足齐次狄利克雷边界条件 $\\phi(0) = 0$ 和 $\\phi(L) = 0$。\n\n从静电学的基本定律出发，即高斯定律 $\\nabla \\cdot \\mathbf{D} = \\rho_{e}$、本构关系 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 和电场定义 $\\mathbf{E} = -\\nabla \\phi$，推导在 $\\epsilon$ 为常数时 $\\phi(x)$ 的一维控制微分方程，并针对给定的 $\\rho_{e}(x)$ 和边界条件对其进行精确求解。提供 $\\phi(x)$ 关于 $x$、$L$、$\\epsilon$ 和 $\\rho_{0}$ 的最终闭式解析表达式。无需数值近似。",
            "solution": "该问题要求在区域 $x \\in [0, L]$ 内，针对给定的电荷密度分布 $\\rho_{e}(x)$ 和齐次狄利克雷边界条件，推导并求解静电势 $\\phi(x)$ 的一维泊松方程。我们首先验证问题陈述的有效性。\n\n**问题验证**\n\n**第1步：提取已知条件**\n- 区域：$x \\in [0, L]$，其中 $L  0$。\n- 基本定律：\n    1. 高斯定律：$\\nabla \\cdot \\mathbf{D} = \\rho_{e}$。\n    2. 本构关系：$\\mathbf{D} = \\epsilon \\mathbf{E}$。\n    3. 电场定义：$\\mathbf{E} = -\\nabla \\phi$。\n- 参数：\n    - 介电常数 $\\epsilon  0$ 是一个常数。\n    - 电荷密度幅值 $\\rho_{0}$ 是一个常数。\n- 给定的电荷密度：$\\rho_{e}(x) = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$。\n- 边界条件：$\\phi(0) = 0$ 和 $\\phi(L) = 0$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定的、客观的。它基于静电学的基本原理，这些原理导出了泊松方程。这个问题是适定的，因为它描述了一个带有两个边界条件的二阶线性常微分方程（一个狄利克雷边界值问题），这保证了其解的唯一性。问题设定是自洽的，所有必需的函数、参数和条件都已提供。该物理模型是研究动电现象时使用的标准理想化模型。问题陈述中没有矛盾、歧义或事实错误。\n\n**第3步：结论与行动**\n问题有效。将推导求解。\n\n**推导与求解**\n\n首先，我们从给定的基本定律推导出一维泊松方程。\n我们从电位移场 $\\mathbf{D}$ 的高斯定律开始：\n$$ \\nabla \\cdot \\mathbf{D} = \\rho_{e} $$\n代入本构关系 $\\mathbf{D} = \\epsilon \\mathbf{E}$：\n$$ \\nabla \\cdot (\\epsilon \\mathbf{E}) = \\rho_{e} $$\n由于介电常数 $\\epsilon$ 是一个常数，它可以从散度算子中提出：\n$$ \\epsilon (\\nabla \\cdot \\mathbf{E}) = \\rho_{e} $$\n接下来，我们将电场 $\\mathbf{E}$ 用静电势 $\\phi$ 的定义 $\\mathbf{E} = -\\nabla \\phi$ 代入：\n$$ \\epsilon (\\nabla \\cdot (-\\nabla \\phi)) = \\rho_{e} $$\n$$ -\\epsilon (\\nabla \\cdot \\nabla \\phi) = \\rho_{e} $$\n算子 $\\nabla \\cdot \\nabla$ 是拉普拉斯算子，记为 $\\nabla^2$。因此，我们得到广义泊松方程：\n$$ -\\epsilon \\nabla^2 \\phi = \\rho_{e} $$\n对于一维平面系统，拉普拉斯算子简化为关于空间坐标 $x$ 的二阶导数，即 $\\nabla^2 = \\frac{d^2}{dx^2}$。方程变为：\n$$ -\\epsilon \\frac{d^2\\phi}{dx^2} = \\rho_{e}(x) $$\n现在，我们代入给定的电荷密度表达式 $\\rho_{e}(x) = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$：\n$$ -\\epsilon \\frac{d^2\\phi}{dx^2} = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) $$\n重新整理方程以求解 $\\frac{d^2\\phi}{dx^2}$，我们得到待解的常微分方程：\n$$ \\frac{d^2\\phi}{dx^2} = -\\frac{\\rho_{0}}{\\epsilon} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) $$\n我们通过对 $x$ 积分两次来求解这个二阶常微分方程。积分一次得到势的导数 $\\frac{d\\phi}{dx}$：\n$$ \\frac{d\\phi}{dx} = \\int -\\frac{\\rho_{0}}{\\epsilon} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) dx $$\n$$ \\frac{d\\phi}{dx} = -\\frac{\\rho_{0}}{\\epsilon} \\int \\sin\\!\\left(\\frac{\\pi x}{L}\\right) dx = -\\frac{\\rho_{0}}{\\epsilon} \\left(-\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right)\\right) + C_1 $$\n$$ \\frac{d\\phi}{dx} = \\frac{\\rho_{0}L}{\\epsilon\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right) + C_1 $$\n其中 $C_1$ 是第一个积分常数。\n第二次积分给出势 $\\phi(x)$ 的通解：\n$$ \\phi(x) = \\int \\left(\\frac{\\rho_{0}L}{\\epsilon\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right) + C_1\\right) dx $$\n$$ \\phi(x) = \\frac{\\rho_{0}L}{\\epsilon\\pi} \\int \\cos\\!\\left(\\frac{\\pi x}{L}\\right) dx + \\int C_1 dx $$\n$$ \\phi(x) = \\frac{\\rho_{0}L}{\\epsilon\\pi} \\left(\\frac{L}{\\pi} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\right) + C_1 x + C_2 $$\n$$ \\phi(x) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) + C_1 x + C_2 $$\n其中 $C_2$ 是第二个积分常数。\n\n现在，我们应用边界条件来确定常数 $C_1$ 和 $C_2$。\n第一个边界条件是 $\\phi(0) = 0$：\n$$ \\phi(0) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi \\cdot 0}{L}\\right) + C_1(0) + C_2 = 0 $$\n$$ \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin(0) + 0 + C_2 = 0 $$\n由于 $\\sin(0) = 0$，这简化为：\n$$ 0 + C_2 = 0 \\implies C_2 = 0 $$\n解现在具有以下形式：\n$$ \\phi(x) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) + C_1 x $$\n第二个边界条件是 $\\phi(L) = 0$：\n$$ \\phi(L) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi L}{L}\\right) + C_1 L = 0 $$\n$$ \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin(\\pi) + C_1 L = 0 $$\n由于 $\\sin(\\pi) = 0$，这简化为：\n$$ 0 + C_1 L = 0 $$\n鉴于区域长度 $L  0$，我们必须有：\n$$ C_1 = 0 $$\n两个积分常数都为零。将 $C_1 = 0$ 和 $C_2 = 0$ 代入通解，得到静电势的最终唯一解：\n$$ \\phi(x) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) $$\n该表达式代表了 $\\phi(x)$ 关于给定参数的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\left(\\frac{\\pi x}{L}\\right)}$$"
        },
        {
            "introduction": "在热平衡状态下，完整的PNP系统简化为非线性的泊松-玻尔兹曼（PB）方程，它描述了双电层的结构。这个实践问题要求您将精确的PB解与其著名的线性化近似——德拜-休克尔（DH）近似进行比较，并数值化地确定该简化有效的范围。这种实践对于培养对静电动力学中线性理论局限性的直觉至关重要。",
            "id": "4085840",
            "problem": "考虑一个一维平面双电层系统，其中对称单价电解质分布在 $x \\ge 0$ 的空间中，靠近一个位于 $x=0$ 处、均匀带电、平坦的非导电壁。电势记为 $\\psi(x)$，壁面电势边界条件为 $\\psi(0)=\\phi_0$。当 $x \\to \\infty$ 时，体系趋于电中性的体相，此时 $\\psi(\\infty)=0$。电解质的体相摩尔浓度为 $c_0$（单位：$\\mathrm{mol}/\\mathrm{m}^3$），温度为 $T$（单位：$\\mathrm{K}$）。假设溶剂为水，其恒定相对介电常数为 $\\varepsilon_r=78.5$（无量纲）。使用真空介电常数 $\\varepsilon_0$（单位：$\\mathrm{F}/\\mathrm{m}$）、元电荷 $e$（单位：$\\mathrm{C}$）、玻尔兹曼常数 $k_B$（单位：$\\mathrm{J}/\\mathrm{K}$）和阿伏伽德罗常数 $N_A$（单位：$\\mathrm{mol}^{-1}$）作为标准物理常数。\n\n从适用于复杂流体中动电输运的第一性原理出发：\n- 静电泊松方程 $-\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = \\rho$，其中 $\\varepsilon=\\varepsilon_r \\varepsilon_0$ 是介电常数，$\\rho$ 是自由电荷密度。\n- 平衡状态下阳离子和阴离子的离子数密度遵循玻尔兹曼分布：$n_\\pm(x)=n_0 \\exp\\left(\\mp \\frac{e \\psi(x)}{k_B T}\\right)$，其中 $n_0=N_A c_0$。\n- 对称单价电解质的德拜长度的定义，该定义由围绕电中性体相的线性响应导出。\n\n您的任务：\n1. 基于以上原理，不使用任何简化公式，推导出一维平面全泊松-玻尔兹曼方程（针对 $\\psi(x)$）及其线性化的德拜-休克尔近似。请使用无量纲电势 $u(x)=\\frac{e \\psi(x)}{k_B T}$、德拜长度的倒数 $\\kappa$ 以及适当的边界条件来表示。求出与所述边界条件一致的 $\\psi_{\\mathrm{PB}}(x)$ 和 $\\psi_{\\mathrm{DH}}(x)$ 的显式表达式。\n2. 定义一个定量误差度量 $\\mathcal{E}(c_0,\\phi_0,T)$，用于在一个截断至 $L=10 \\lambda_D$（其中 $\\lambda_D$ 为德拜长度）的半无限域上，比较德拜-休克尔近似与全泊松-玻尔兹曼解。使用在 $[0,L]$ 上的归一化均方根误差：\n$$\n\\mathcal{E} = \\frac{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{DH}}(x)-\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}.\n$$\n通过在 $[0,L]$ 上使用至少包含 $10^4$ 个点的均匀网格来近似计算积分，从而数值计算 $\\mathcal{E}$。\n3. 对于下方给出的每个参数三元组 $(c_0,\\phi_0,T)$，判断德拜-休克尔近似与全泊松-玻尔兹曼解相比，其误差是否小于 5%。判断标准为 $\\mathcal{E}  0.05$，表示为小数阈值 $0.05$。输入参数需使用严格的国际单位制（SI）：$c_0$ 单位为 $\\mathrm{mol}/\\mathrm{m}^3$，$\\phi_0$ 单位为 $\\mathrm{V}$，$T$ 单位为 $\\mathrm{K}$。\n\n测试套件（每个项目为一个三元组 $(c_0,\\phi_0,T)$）：\n- $(1.0, 0.010, 298)$\n- $(100.0, 0.050, 298)$\n- $(10.0, 0.200, 298)$\n- $(1.0, 0.100, 310)$\n- $(500.0, 0.100, 273)$\n\n您的程序必须：\n- 实现推导出的公式，并使用给定的常数为每个测试用例计算 $\\mathcal{E}$。\n- 生成单行输出，其中包含一个用方括号括起来的、逗号分隔的布尔值列表，顺序与测试套件一致（例如：$[\\text{result}_1,\\text{result}_2,\\ldots,\\text{result}_5]$）。如果 $\\mathcal{E}  0.05$，则对应的布尔值为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。",
            "solution": "### 第 1 步：提取已知条件\n题目提供了以下信息：\n1.  **系统：** 一个一维平面双电层，其中对称单价电解质邻近一个位于 $x=0$ 处的平坦非导电壁。电解质位于 $x \\ge 0$ 的区域。\n2.  **变量：** 电势 $\\psi(x)$，阳离子/阴离子数密度 $n_\\pm(x)$。\n3.  **边界条件：**\n    - 壁面电势：$\\psi(0) = \\phi_0$。\n    - 体相电中性：当 $x \\to \\infty$ 时，$\\psi(x) \\to 0$。\n4.  **参数：**\n    - 电解质体相摩尔浓度：$c_0$（单位：$\\mathrm{mol}/\\mathrm{m}^3$）。\n    - 温度：$T$（单位：$\\mathrm{K}$）。\n    - 溶剂（水）的相对介电常数：$\\varepsilon_r=78.5$。\n5.  **基本原理与定义：**\n    - 静电学的泊松方程：$-\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = \\rho$，其中 $\\varepsilon=\\varepsilon_r \\varepsilon_0$。\n    - 离子密度的玻尔兹曼分布：$n_\\pm(x)=n_0 \\exp\\left(\\mp \\frac{e \\psi(x)}{k_B T}\\right)$，其中 $n_0 = N_A c_0$。\n    - 德拜长度的定义将从线性响应理论推导得出。\n6.  **任务 1：** 推导一维平面泊松-玻尔兹曼（PB）方程及其线性化的德拜-休克尔（DH）近似，并求出它们的解析解 $\\psi_{\\mathrm{PB}}(x)$ 和 $\\psi_{\\mathrm{DH}}(x)$。\n7.  **任务 2：** 将误差度量 $\\mathcal{E}$ 定义为在域 $[0,L]$（其中 $L=10\\lambda_D$）上比较 DH 解和 PB 解的归一化均方根误差。\n    $$\n    \\mathcal{E} = \\frac{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{DH}}(x)-\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}\n    $$\n    需要在至少有 $10^4$ 个点的均匀网格上进行数值积分。\n8.  **任务 3：** 对于给定的测试套件 $(c_0, \\phi_0, T)$，判断是否 $\\mathcal{E}  0.05$。\n9.  **常数：** 题目涉及标准物理常数：真空介电常数 $\\varepsilon_0$、元电荷 $e$、玻尔兹曼常数 $k_B$ 和阿伏伽德罗常数 $N_A$。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据验证标准评估问题陈述：\n\n-   **科学依据：** 该问题牢固地植根于应用于电解质的静电学和统计力学的既定理论，特别是泊松-玻尔兹曼理论。这是物理化学和计算复杂流体领域的经典问题。它不含任何伪科学或有争议的主张。\n-   **适定性：** 该问题是适定的。控制方程、几何结构和边界条件都已明确指定，可以推导出唯一且稳定的解。数值任务有明确的定义，包括具体的误差度量和计算要求。\n-   **客观性：** 问题以精确、客观和定量的方式陈述。所有参数都已定义，任务清晰明确。\n-   **自洽性与一致性：** 问题提供了进行推导和计算所需的所有必要信息。内部没有矛盾。要求从给定原理（泊松方程、玻尔兹曼分布）推导方程，这一要求是一致的，并确保了基于基础原理的解题方法。\n-   **无其他缺陷：** 该问题并非微不足道、非隐喻性或超出科学验证范围。它代表了对德拜-休克尔近似局限性的标准分析。\n\n### 第 3 步：结论与行动\n问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### 解答推导与计算策略\n\n解答过程首先推导所需的电势解析表达式，然后概述计算误差度量的数值程序。\n\n**1. 泊松-玻尔兹曼和德拜-休克尔方程及其解的推导（任务 1）**\n\n分析始于电势 $\\psi(x)$ 的一维形式的泊松方程，假设介电常数 $\\varepsilon = \\varepsilon_r \\varepsilon_0$ 为常数：\n$$\n-\\varepsilon \\frac{d^2\\psi}{dx^2} = \\rho(x)\n$$\n其中 $\\rho(x)$ 是局部自由电荷密度。对于对称单价（$z=1$）电解质，电荷密度由阳离子和阴离子浓度之差乘以元电荷 $e$ 给出：\n$$\n\\rho(x) = e n_+(x) - e n_-(x)\n$$\n假设离子数密度 $n_\\pm(x)$ 遵循玻尔兹曼分布，该分布将其局部浓度与相对于体相（$\\psi=0$）的局部势能 $q\\psi(x) = \\pm e\\psi(x)$ 联系起来：\n$$\nn_\\pm(x) = n_0 \\exp\\left(\\mp \\frac{e \\psi(x)}{k_B T}\\right)\n$$\n此处，$n_0 = N_A c_0$ 是阳离子（或阴离子）的体相数密度。将玻尔兹曼分布代入 $\\rho(x)$ 的表达式中：\n$$\n\\rho(x) = e n_0 \\left(e^{-e\\psi(x)/(k_B T)} - e^{+e\\psi(x)/(k_B T)}\\right) = -2 e n_0 \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n将此式代入泊松方程，得到完整的**泊松-玻尔兹曼（PB）方程**：\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2 e n_0}{\\varepsilon} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n为简化起见，我们引入无量纲电势 $u(x) = \\frac{e\\psi(x)}{k_B T}$。PB 方程变为：\n$$\n\\frac{d^2u}{dx^2} = \\left(\\frac{2 e^2 n_0}{\\varepsilon k_B T}\\right) \\sinh(u)\n$$\n括号中的项具有长度倒数的平方的单位，并被定义为**德拜长度倒数** $\\kappa$ 的平方：\n$$\n\\kappa^2 = \\frac{2 e^2 N_A c_0}{\\varepsilon_r \\varepsilon_0 k_B T}\n$$\n德拜长度为 $\\lambda_D = 1/\\kappa$。因此，无量纲 PB 方程为：\n$$\n\\frac{d^2u}{dx^2} = \\kappa^2 \\sinh(u)\n$$\n\n**德拜-休克尔（DH）近似**是通过在小电势假设下（即 $|\\psi| \\ll k_B T/e$，意味着 $|u| \\ll 1$）对 PB 方程进行线性化得到的。在此极限下，$\\sinh(u) \\approx u$。线性化后的方程为：\n$$\n\\frac{d^2u}{dx^2} = \\kappa^2 u \\quad \\text{或} \\quad \\frac{d^2\\psi}{dx^2} = \\kappa^2 \\psi\n$$\n这就是 DH 方程。其通解为 $\\psi(x) = A e^{\\kappa x} + B e^{-\\kappa x}$。应用边界条件：\n-   $\\psi(\\infty) = 0 \\implies A=0$。\n-   $\\psi(0) = \\phi_0 \\implies B=\\phi_0$。\n因此，DH 方程的解为：\n$$\n\\psi_{\\mathrm{DH}}(x) = \\phi_0 e^{-\\kappa x}\n$$\n\n为求解完整的非线性 PB 方程，我们两边乘以 $2 \\frac{du}{dx}$ 并积分：\n$$\n2\\frac{du}{dx}\\frac{d^2u}{dx^2} = 2\\kappa^2 \\sinh(u)\\frac{du}{dx} \\implies \\frac{d}{dx}\\left(\\frac{du}{dx}\\right)^2 = 2\\kappa^2 \\frac{d}{dx}(\\cosh(u))\n$$\n对 $x$ 积分得到 $\\left(\\frac{du}{dx}\\right)^2 = 2\\kappa^2 \\cosh(u) + C_1$。积分常数 $C_1$ 可由体相边界条件求出：在 $x \\to \\infty$ 处，$\\psi \\to 0$（因此 $u \\to 0$）且电场 $E_x = -d\\psi/dx \\to 0$（因此 $du/dx \\to 0$）。\n$$\n0 = 2\\kappa^2 \\cosh(0) + C_1 \\implies C_1 = -2\\kappa^2\n$$\n代入 $C_1$ 并使用恒等式 $\\cosh(u) - 1 = 2 \\sinh^2(u/2)$：\n$$\n\\left(\\frac{du}{dx}\\right)^2 = 2\\kappa^2 (\\cosh(u) - 1) = 4\\kappa^2 \\sinh^2(u/2)\n$$\n开方后得到 $\\frac{du}{dx} = \\pm 2\\kappa \\sinh(u/2)$。我们必须选择能确保电势从壁面到体相单调衰减的符号。如果 $\\phi_00$，则 $u(x)0$，我们需要 $du/dx0$，故取负号。如果 $\\phi_00$，则 $u(x)0$ 且 $\\sinh(u/2)0$；我们需要 $du/dx0$，因此也必须取负号。正确的选择总是：\n$$\n\\frac{du}{dx} = -2\\kappa \\sinh(u/2)\n$$\n这是一个可分离变量的微分方程。\n$$\n\\frac{du}{\\sinh(u/2)} = -2\\kappa \\, dx\n$$\n从壁面（$x=0$, $u=u_0$）积分到位置 $x$：\n$$\n\\int_{u_0}^{u(x)} \\frac{dz}{\\sinh(z/2)} = -2\\kappa \\int_0^x d\\xi' = -2\\kappa x\n$$\n左边的积分是 $2 \\ln(\\tanh(z/4))$。\n$$\n\\left[2\\ln\\left(\\tanh\\left(\\frac{z}{4}\\right)\\right)\\right]_{u_0}^{u(x)} = 2\\ln\\left(\\frac{\\tanh(u(x)/4)}{\\tanh(u_0/4)}\\right) = -2\\kappa x\n$$\n解出 $u(x)$：\n$$\n\\ln\\left(\\frac{\\tanh(u(x)/4)}{\\tanh(u_0/4)}\\right) = -\\kappa x \\implies \\tanh\\left(\\frac{u(x)}{4}\\right) = \\tanh\\left(\\frac{u_0}{4}\\right)e^{-\\kappa x}\n$$\n其中 $u_0 = u(0) = e\\phi_0/(k_B T)$。$\\psi_{\\mathrm{PB}}(x)$ 的最终解是：\n$$\n\\psi_{\\mathrm{PB}}(x) = \\frac{k_B T}{e} u(x) = \\frac{4 k_B T}{e} \\mathrm{arctanh}\\left(\\tanh\\left(\\frac{e\\phi_0}{4 k_B T}\\right)e^{-\\kappa x}\\right)\n$$\n\n**2. 误差度量与数值计算（任务 2 和 3）**\n\n问题定义了归一化均方根误差 $\\mathcal{E}$ 来量化 DH 解与 PB 解的偏差：\n$$\n\\mathcal{E} = \\frac{\\sqrt{\\int_{0}^{L}\\left(\\psi_{\\mathrm{DH}}(x)-\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x}}{\\sqrt{\\int_{0}^{L}\\left(\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x}}\n$$\n积分在域 $[0,L]$ 上进行，其中 $L=10\\lambda_D = 10/\\kappa$。由于特征长度尺度是 $\\lambda_D$，该域覆盖了电势衰减的绝大部分。\n\n为计算每个参数集 $(c_0, \\phi_0, T)$ 的 $\\mathcal{E}$，执行以下步骤：\n1.  使用标准国际单位制（SI）的物理常数值：$e=1.602176634 \\times 10^{-19} \\ \\mathrm{C}$，$k_B=1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$，$N_A=6.02214076 \\times 10^{23} \\ \\mathrm{mol}^{-1}$，$\\varepsilon_0=8.854187817 \\times 10^{-12} \\ \\mathrm{F/m}$。水的相对介电常数给定为 $\\varepsilon_r=78.5$。\n2.  根据给定的 $c_0$ 和 $T$ 计算德拜长度的倒数 $\\kappa$。\n3.  在从 $0$ 到 $L=10/\\kappa$ 的区间上建立一个至少有 $10^4$ 个点的均匀空间网格 $x_i$。我们将使用 $10001$ 个点。\n4.  使用推导出的公式在每个网格点上计算 $\\psi_{\\mathrm{DH}}(x_i)$ 和 $\\psi_{\\mathrm{PB}}(x_i)$。\n5.  计算分子 $(\\psi_{\\mathrm{DH}}(x_i)-\\psi_{\\mathrm{PB}}(x_i))^2$ 和分母 $(\\psi_{\\mathrm{PB}}(x_i))^2$ 的被积函数。\n6.  使用复合梯形法则对两个积分进行数值近似。\n7.  计算 $\\mathcal{E}$ 并判断其是否小于阈值 $0.05$。这将为每个测试用例产生一个布尔结果。\n\nDH 近似的有效性主要由无量纲表面电势 $u_0 = e\\phi_0/(k_B T)$ 的大小决定。当 $|u_0| \\ll 1$ 时，该近似预计是准确的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ... # Scipy is not needed\n\ndef solve():\n    \"\"\"\n    Solves the Poisson-Boltzmann problem to compare Debye-Hückel and full solutions.\n    \"\"\"\n\n    # Physical Constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    KB = 1.380649e-23            # Boltzmann constant in J/K\n    NA = 6.02214076e23           # Avogadro constant in mol^-1\n    EPS_0 = 8.854187817e-12      # Vacuum permittivity in F/m\n    EPS_R = 78.5                 # Relative permittivity of water\n\n    # Test cases: (c0 in mol/m^3, phi0 in V, T in K)\n    test_cases = [\n        (1.0, 0.010, 298),\n        (100.0, 0.050, 298),\n        (10.0, 0.200, 298),\n        (1.0, 0.100, 310),\n        (500.0, 0.100, 273),\n    ]\n\n    results = []\n    \n    # Numerical integration parameters\n    num_points = 10001  # Use 10001 points for >10^4 points (10000 intervals)\n\n    for c0, phi0, T in test_cases:\n        # Calculate derived parameters for the current case\n        epsilon = EPS_R * EPS_0\n        \n        # Calculate inverse Debye length (kappa)\n        kappa_sq = (2 * E_CHARGE**2 * NA * c0) / (epsilon * KB * T)\n        kappa = np.sqrt(kappa_sq)\n        \n        # Set integration limit L = 10 * debye_length\n        lambda_d = 1.0 / kappa\n        L = 10.0 * lambda_d\n        \n        # Dimensionless surface potential\n        thermal_voltage = KB * T / E_CHARGE\n        u0 = phi0 / thermal_voltage\n        \n        # Set up the spatial grid for integration\n        x_grid = np.linspace(0, L, num_points)\n        \n        # --- Calculate potentials on the grid ---\n        \n        # 1. Debye-Huckel (DH) solution\n        psi_dh = phi0 * np.exp(-kappa * x_grid)\n        \n        # 2. Full Poisson-Boltzmann (PB) solution\n        # Handle the phi0 = 0 case, although not in test suite.\n        if phi0 == 0.0:\n            psi_pb = np.zeros_like(x_grid)\n        else:\n            tanh_arg = u0 / 4.0\n            tanh_val = np.tanh(tanh_arg)\n            arctanh_arg = tanh_val * np.exp(-kappa * x_grid)\n            psi_pb = 4.0 * thermal_voltage * np.arctanh(arctanh_arg)\n\n        # --- Calculate the error metric E ---\n        \n        # Integrand for the numerator of E^2\n        integrand_num = (psi_dh - psi_pb)**2\n        \n        # Integrand for the denominator of E^2\n        integrand_den = psi_pb**2\n        \n        # Numerically compute integrals using the trapezoidal rule\n        integral_num = np.trapz(integrand_num, x=x_grid)\n        integral_den = np.trapz(integrand_den, x=x_grid)\n        \n        # Calculate the error E\n        if integral_den == 0:\n            # This occurs if phi0=0. In this case, psi_pb is zero everywhere.\n            # If psi_dh is also zero (which it is for phi0=0), the error is 0.\n            # Otherwise, if psi_dh is not zero, the relative error is infinite.\n            # For phi0=0, error is taken as 0.\n            error = 0.0\n        else:\n            error = np.sqrt(integral_num / integral_den)\n            \n        # Compare error to the threshold 0.05\n        results.append(error  0.05)\n        \n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "精确模拟由能斯特-普朗克方程控制的离子输运在数值上具有挑战性，尤其是在电漂移主导扩散的情况下。本练习直接比较了标准的中心差分格式和专门为稳健处理此类漂移-主导问题而设计的Scharfetter-Gummel格式。通过此实践，您将亲身体会到稳定性和准确性问题，这对于开发可靠的静电动力学系统计算模型至关重要。",
            "id": "4085827",
            "problem": "考虑在外加空间均匀电场作用下，由能斯特-普朗克方程控制的单种离子的一维稳态输运。在泊松-能斯特-普朗克 (PNP) 框架中，浓度 $c(x)$ 的稳态能斯特-普朗克通量可以写为守恒律形式\n$$\n\\frac{d}{dx} \\left( - D \\frac{dc}{dx} - \\mu z e E\\, c \\right) = 0 \\quad \\text{for} \\quad x \\in [0,1],\n$$\n其狄利克雷边界条件为 $c(0) = c_L$ 和 $c(1) = c_R$，其中 $D$ 是扩散系数，$\\mu$ 是电泳迁移率，$z$ 是化合价，$e$ 是元电荷，$E$ 是恒定电场。根据爱因斯坦关系式 $D = \\mu V_T$（其中 $V_T$ 是热电压），定义无量纲漂移参数 $\\beta = E/V_T$。在无量纲尺度 $x \\in [0,1]$ 下，并取 $D=1$，控制方程变为\n$$\n\\frac{d}{dx} \\left( - \\frac{dc}{dx} - \\beta\\, c \\right) = 0, \\quad c(0) = c_L, \\quad c(1) = c_R.\n$$\n这是一个一维空间中的守恒形式的对流-扩散边界值问题。\n\n您的任务是实现一个完整的、可运行的程序，使用两种格式对几个测试案例进行数值求解：\n- 应用于微分形式的二阶中心差分格式\n$$\n- \\frac{d^2 c}{dx^2} - \\beta \\frac{d c}{dx} = 0,\n$$\n采用均匀网格间距，并在端点处强制施加狄利克雷边界条件。\n- Scharfetter–Gummel (SG) 有限体积格式（Scharfetter–Gummel (SG) 是一种用于漂移-扩散问题的标准指数拟合离散化方法），该格式使用伯努利函数来离散化每个单元面上的守恒通量\n$$\nB(\\xi) = \\frac{\\xi}{e^{\\xi} - 1},\n$$\n节点 $i$ 和 $i+1$ 之间的界面通量由下式给出\n$$\nF_{i+1/2} = - \\frac{1}{\\Delta x} \\left( c_{i+1} B(P) - c_i B(-P) \\right), \\quad P = \\beta\\, \\Delta x,\n$$\n并在每个控制体积内强制实现通量平衡。\n\n从第一性原理出发，仅从守恒通量形式和边界条件推导出 $c(x)$ 的精确解析解，并用它来计算参考解，以便衡量数值误差。推导过程必须从稳态守恒通量定律开始，逐步构建出精确解，而不能直接套用现成公式。\n\n对于具有节点 $\\{x_i\\}_{i=0}^N$ 的网格，将离散均方根 (RMS) 误差定义为\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N+1} \\sum_{i=0}^{N} \\left( c_i^{\\text{num}} - c(x_i) \\right)^2 },\n$$\n其中 $c_i^{\\text{num}}$ 是节点 $x_i$ 处的数值解，$c(x_i)$ 是在 $x_i$ 处求值的精确解析解。\n\n您必须实现这两种格式，并为以下针对强漂移和覆盖度的测试套件计算它们的 RMS 误差：\n- 测试案例 1（强漂移，粗网格）：$\\beta = 50$，$N = 16$，$c_L = 1.0$，$c_R = 0.2$。\n- 测试案例 2（强漂移，中等网格）：$\\beta = 50$，$N = 64$，$c_L = 1.0$，$c_R = 0.2$。\n- 测试案例 3（强漂移，细网格）：$\\beta = 50$，$N = 256$，$c_L = 1.0$，$c_R = 0.2$。\n- 测试案例 4（中等漂移，中等网格）：$\\beta = 0.5$，$N = 64$，$c_L = 1.0$，$c_R = 0.2$。\n\n所有变量和参数都是无量纲的；因此，最终的数值答案中不需要物理单位。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。对于每个测试案例，按以下顺序输出两个浮点数：中心差分格式的 RMS 误差，然后是 Scharfetter–Gummel 格式的 RMS 误差。因此，最终输出必须总共包含八个数字，按上述测试案例的顺序列出，例如，“[e1_central,e1_sg,e2_central,e2_sg,e3_central,e3_sg,e4_central,e4_sg]”。",
            "solution": "该问题要求推导解析解，并实现两种数值格式来求解一个一维稳态对流-扩散方程。数值格式的准确性将根据给定的一组测试案例与解析解进行评估。\n\n### 1. 解析解\n\n控制方程以守恒形式给出：\n$$\n\\frac{d}{dx} \\left( - \\frac{dc}{dx} - \\beta\\, c(x) \\right) = 0, \\quad \\text{for} \\quad x \\in [0,1]\n$$\n其狄利克雷边界条件为 $c(0) = c_L$ 和 $c(1) = c_R$。\n\n令通量为 $J(x) = - \\frac{dc}{dx} - \\beta c(x)$。控制方程为 $\\frac{dJ}{dx} = 0$，这意味着通量 $J(x)$ 必须是一个常数，我们称之为 $K$，对于所有 $x \\in [0,1]$。\n$$\n- \\frac{dc}{dx} - \\beta c(x) = K\n$$\n这是一个一阶线性常微分方程 (ODE)。我们可以将其重写为：\n$$\n\\frac{dc}{dx} + \\beta c(x) = -K\n$$\n为了解这个 ODE，我们首先求解齐次方程 $\\frac{dc_h}{dx} + \\beta c_h(x) = 0$。通过分离变量法，我们发现齐次解为 $c_h(x) = A e^{-\\beta x}$，其中 $A$ 是一个常数。\n\n对于特解，由于右侧是一个常数，我们假设一个常数特解 $c_p(x) = C_p$。代入 ODE 得到 $0 + \\beta C_p = -K$，所以 $C_p = -K/\\beta$。这在 $\\beta \\neq 0$ 时成立。$\\beta=0$ 的情况对应于纯扩散，$c''(x)=0$，导致一个简单的线性剖面 $c(x) = c_L + (c_R - c_L)x$。由于所有测试案例都有 $\\beta \\neq 0$，我们基于此假设继续进行。\n\n通解是齐次解和特解的和：\n$$\nc(x) = c_h(x) + c_p(x) = A e^{-\\beta x} - \\frac{K}{\\beta}\n$$\n常数 $A$ 和 $K$ 由边界条件确定：\n1.  在 $x=0$ 处：$c(0) = c_L \\implies c_L = A e^0 - K/\\beta = A - K/\\beta$。\n2.  在 $x=1$ 处：$c(1) = c_R \\implies c_R = A e^{-\\beta} - K/\\beta$。\n\n这是一个关于 $A$ 和 $K$ 的二元线性方程组。从第一个方程，我们有 $A = c_L + K/\\beta$。将此代入第二个方程：\n$$\nc_R = (c_L + K/\\beta) e^{-\\beta} - K/\\beta = c_L e^{-\\beta} + \\frac{K}{\\beta} (e^{-\\beta} - 1)\n$$\n解出 $K$：\n$$\nc_R - c_L e^{-\\beta} = \\frac{K}{\\beta} (e^{-\\beta} - 1) \\implies K = \\beta \\frac{c_R - c_L e^{-\\beta}}{e^{-\\beta} - 1}\n$$\n现在我们求 $A$：\n$$\nA = c_L + \\frac{1}{\\beta} \\left( \\beta \\frac{c_R - c_L e^{-\\beta}}{e^{-\\beta} - 1} \\right) = c_L + \\frac{c_R - c_L e^{-\\beta}}{e^{-\\beta} - 1} = \\frac{c_L(e^{-\\beta} - 1) + c_R - c_L e^{-\\beta}}{e^{-\\beta} - 1} = \\frac{c_R - c_L}{e^{-\\beta} - 1}\n$$\n将 $A$ 和 $K$ 代回到通解 $c(x) = A e^{-\\beta x} - K/\\beta$ 中：\n$$\nc(x) = \\left( \\frac{c_R - c_L}{e^{-\\beta} - 1} \\right) e^{-\\beta x} - \\frac{1}{\\beta} \\left( \\beta \\frac{c_R - c_L e^{-\\beta}}{e^{-\\beta} - 1} \\right) = \\frac{(c_R - c_L) e^{-\\beta x} - (c_R - c_L e^{-\\beta})}{e^{-\\beta} - 1}\n$$\n一个更方便的形式可以通过重新排列得到：\n$$\nc(x) = \\frac{c_R(e^{-\\beta x} - 1) - c_L(e^{-\\beta x} - e^{-\\beta})}{e^{-\\beta}-1} = \\frac{c_L(e^{-\\beta} - e^{-\\beta x})}{e^{-\\beta}-1} + c_R\\frac{e^{-\\beta x}-1}{e^{-\\beta}-1}\n$$\n一个更简单的形式是：\n$$\nc(x) = c_L + (c_R - c_L) \\frac{e^{-\\beta x} - 1}{e^{-\\beta} - 1}\n$$\n我们用边界条件验证这个形式：\n- 在 $x=0$ 处：$c(0) = c_L + (c_R - c_L) \\frac{e^0 - 1}{e^{-\\beta} - 1} = c_L + (c_R - c_L) \\frac{1-1}{e^{-\\beta} - 1} = c_L$。\n- 在 $x=1$ 处：$c(1) = c_L + (c_R - c_L) \\frac{e^{-\\beta} - 1}{e^{-\\beta} - 1} = c_L + c_R - c_L = c_R$。\n该解是正确的。此解析表达式将用作参考解。\n\n### 2. 数值格式\n\n我们使用一个包含 $N+1$ 个节点 $\\{x_i\\}_{i=0}^N$ 的均匀网格来离散化域 $x \\in [0,1]$，其中 $x_i = i \\Delta x$，网格间距为 $\\Delta x = 1/N$。内部节点处的浓度 $c_1, c_2, \\dots, c_{N-1}$ 是未知数。边界值 $c_0 = c_L$ 和 $c_N = c_R$ 是给定的。对于这两种格式，我们将为 $N-1$ 个未知数建立一个包含 $N-1$ 个线性方程的方程组，可以表示为矩阵形式 $A\\mathbf{c} = \\mathbf{b}$。\n\n#### 2.1. 中心差分格式\n\n该格式应用于方程的微分形式：\n$$\n- \\frac{d^2 c}{dx^2} - \\beta \\frac{d c}{dx} = 0\n$$\n我们使用二阶中心差分公式来近似内部节点 $x_i$ 处的导数：\n$$\n\\frac{d^2 c}{dx^2}\\bigg|_{x_i} \\approx \\frac{c_{i+1} - 2c_i + c_{i-1}}{(\\Delta x)^2}, \\quad \\frac{d c}{dx}\\bigg|_{x_i} \\approx \\frac{c_{i+1} - c_{i-1}}{2 \\Delta x}\n$$\n将这些代入 ODE，得到节点 $i$（其中 $i=1, \\dots, N-1$）的离散方程：\n$$\n- \\frac{c_{i+1} - 2c_i + c_{i-1}}{(\\Delta x)^2} - \\beta \\frac{c_{i+1} - c_{i-1}}{2 \\Delta x} = 0\n$$\n乘以 $(\\Delta x)^2$ 并重新整理各项：\n$$\n-(c_{i+1} - 2c_i + c_{i-1}) - \\beta \\frac{\\Delta x}{2} (c_{i+1} - c_{i-1}) = 0\n$$\n按共同的未知数 $c_j$ 分组：\n$$\n\\left(\\frac{\\beta \\Delta x}{2} - 1\\right) c_{i-1} + 2 c_i + \\left(-1 - \\frac{\\beta \\Delta x}{2}\\right) c_{i+1} = 0\n$$\n这是一个三对角系统。下、主、上对角线上的系数分别为 $\\left(\\frac{\\beta \\Delta x}{2} - 1\\right)$、$2$ 和 $\\left(-1 - \\frac{\\beta \\Delta x}{2}\\right)$。边界项被移到右侧：\n- 对于 $i=1$：$2 c_1 + \\left(-1 - \\frac{\\beta \\Delta x}{2}\\right) c_2 = -\\left(\\frac{\\beta \\Delta x}{2} - 1\\right) c_0 = \\left(1 - \\frac{\\beta \\Delta x}{2}\\right) c_L$。\n- 对于 $i=N-1$：$\\left(\\frac{\\beta \\Delta x}{2} - 1\\right) c_{N-2} + 2 c_{N-1} = -\\left(-1 - \\frac{\\beta \\Delta x}{2}\\right) c_N = \\left(1 + \\frac{\\beta \\Delta x}{2}\\right) c_R$。\n\n#### 2.2. Scharfetter–Gummel (SG) 格式\n\nSG 格式是一种基于守恒形式 $\\frac{dJ}{dx} = 0$ 的有限体积法。对节点 $x_i$ 周围的控制体积 $[x_i - \\Delta x/2, x_i + \\Delta x/2]$ 进行积分，得到通量平衡：\n$$\n\\int_{x_i - \\Delta x/2}^{x_i + \\Delta x/2} \\frac{dJ}{dx} dx = J(x_i + \\Delta x/2) - J(x_i - \\Delta x/2) = J_{i+1/2} - J_{i-1/2} = 0\n$$\nSG 离散化为界面通量 $J_{i+1/2}$ 提供了一个指数拟合：\n$$\nJ_{i+1/2} = - \\frac{1}{\\Delta x} \\left( c_{i+1} B(\\beta \\Delta x) - c_i B(-\\beta \\Delta x) \\right)\n$$\n其中 $B(\\xi) = \\frac{\\xi}{e^{\\xi} - 1}$ 是伯努利函数。令 $P = \\beta \\Delta x$。通量平衡方程 $J_{i+1/2} = J_{i-1/2}$ 变为：\n$$\n- \\frac{1}{\\Delta x} \\left( c_{i+1} B(P) - c_i B(-P) \\right) = - \\frac{1}{\\Delta x} \\left( c_i B(P) - c_{i-1} B(-P) \\right)\n$$\n乘以 $-\\Delta x$ 并分组：\n$$\nc_{i+1} B(P) - c_i B(-P) = c_i B(P) - c_{i-1} B(-P)\n$$\n$$\nB(-P)c_{i-1} - (B(P) + B(-P))c_i + B(P)c_{i+1} = 0\n$$\n这为内部节点 $i=1, \\dots, N-1$ 定义了一个三对角系统。下、主、上对角线上的系数分别为 $B(-P)$、$-(B(P) + B(-P))$ 和 $B(P)$。边界项被移到右侧：\n- 对于 $i=1$：$-(B(P) + B(-P))c_1 + B(P)c_2 = -B(-P)c_0 = -B(-P)c_L$。\n- 对于 $i=N-1$：$B(-P)c_{N-2} - (B(P) + B(-P))c_{N-1} = -B(P)c_N = -B(P)c_R$。\n为了在计算小 $\\xi$ 的伯努利函数时保持数值稳定性，表达式 $\\exp(\\xi)-1$ 应使用类似 `expm1` 的函数计算。对于 $\\xi=0$，极限为 $B(0)=1$。\n\n### 3. 误差计算\n\n数值解 $c^{\\text{num}}$ 相对于精确解 $c(x)$ 的离散均方根 (RMS) 误差是在所有 $N+1$ 个网格点上计算的：\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N+1} \\sum_{i=0}^{N} \\left( c_i^{\\text{num}} - c(x_i) \\right)^2 }\n$$\n其中 $c_i^{\\text{num}}$ 是节点 $x_i$ 处的数值解，$c(x_i)$ 是解析值。由于狄利克雷边界条件被精确施加，$c_0^{\\text{num}} = c(x_0)$ 和 $c_N^{\\text{num}} = c(x_N)$，因此边界处的误差为零。\n\n该解决方案将在一个 Python 程序中实现，该程序为每个测试案例构建并求解这两个三对角系统，计算 RMS 误差，并打印结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady-state convection-diffusion problem for a suite of test cases\n    using Central Difference and Scharfetter-Gummel schemes, and computes their RMS errors.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (beta, N, c_L, c_R)\n        (50.0, 16, 1.0, 0.2), # Test case 1\n        (50.0, 64, 1.0, 0.2), # Test case 2\n        (50.0, 256, 1.0, 0.2),# Test case 3\n        (0.5, 64, 1.0, 0.2),  # Test case 4\n    ]\n\n    # Helper function for the Bernoulli function B(xi) = xi / (exp(xi) - 1)\n    def bernoulli(xi):\n        # Use Taylor expansion for small xi to avoid catastrophic cancellation\n        # and division by zero.\n        if abs(xi)  1e-9:\n            return 1.0 - xi / 2.0 + xi**2 / 12.0\n        else:\n            # np.expm1(xi) computes exp(xi) - 1 with high precision\n            return xi / np.expm1(xi)\n\n    # Helper function for the exact analytical solution\n    def analytical_solution(x, beta, c_L, c_R):\n        # Handle the case beta = 0 separately (pure diffusion)\n        if abs(beta)  1e-9:\n            return c_L + (c_R - c_L) * x\n        else:\n            # Use np.expm1 for precision in the denominator\n            return c_L + (c_R - c_L) * (np.exp(-beta * x) - 1.0) / np.expm1(-beta)\n\n    # List to store the results\n    results = []\n\n    for beta, N, c_L, c_R in test_cases:\n        # --- Grid Setup ---\n        # Number of interior points\n        num_interior_points = N - 1\n        # Grid spacing\n        dx = 1.0 / N\n        # Grid points\n        x_grid = np.linspace(0.0, 1.0, N + 1)\n        \n        # --- Analytical Solution ---\n        c_exact = analytical_solution(x_grid, beta, c_L, c_R)\n\n        # --- Central Difference Scheme ---\n        # The system is A*c = b, where c is the vector of interior concentrations.\n        # A is a tridiagonal matrix of size (N-1)x(N-1).\n        \n        if num_interior_points > 0:\n            # Set up the tridiagonal matrix bands for scipy.linalg.solve_banded\n            # `ab` is a 3x(N-1) array: ab[0,:]=super-diag, ab[1,:]=main-diag, ab[2,:]=sub-diag\n            ab_cd = np.zeros((3, num_interior_points))\n            \n            # Equation: (1 - beta*dx/2)*c_{i-1} - 2*c_i + (1 + beta*dx/2)*c_{i+1} = 0\n            # which is equivalent to discretizing d^2c/dx^2 + beta*dc/dx = 0\n            # Let's check the problem statement: -d^2c/dx^2 - beta*dc/dx = 0. So we need to multiply by -1.\n            # (-1 + beta*dx/2)*c_{i-1} + 2*c_i + (-1 - beta*dx/2)*c_{i+1} = 0\n            \n            # Main diagonal\n            ab_cd[1, :] = 2.0\n            # Upper diagonal, starting from ab[0, 1]\n            ab_cd[0, 1:] = -1.0 - beta * dx / 2.0\n            # Lower diagonal, ending at ab[2, N-2]\n            ab_cd[2, :-1] = -1.0 + beta * dx / 2.0\n\n            # Set up the right-hand side vector b\n            b_cd = np.zeros(num_interior_points)\n            # Boundary condition at x=0\n            b_cd[0] = -(-1.0 + beta * dx / 2.0) * c_L\n            # Boundary condition at x=1\n            b_cd[-1] = -(-1.0 - beta * dx / 2.0) * c_R\n            \n            # Solve the tridiagonal system\n            c_interior_cd = solve_banded((1, 1), ab_cd, b_cd)\n            \n            # Assemble the full solution vector\n            c_num_cd = np.concatenate(([c_L], c_interior_cd, [c_R]))\n        else: # Handle N=1 case\n            c_num_cd = np.array([c_L, c_R])\n\n        # Calculate RMS error for Central Difference\n        rms_error_cd = np.sqrt(np.mean((c_num_cd - c_exact)**2))\n        results.append(rms_error_cd)\n\n        # --- Scharfetter-Gummel Scheme ---\n        if num_interior_points > 0:\n            P = beta * dx\n            B_p = bernoulli(P)\n            B_neg_p = bernoulli(-P)\n            \n            # Set up the tridiagonal matrix bands for solve_banded\n            ab_sg = np.zeros((3, num_interior_points))\n            \n            # Main diagonal\n            ab_sg[1, :] = -(B_p + B_neg_p)\n            # Upper diagonal\n            ab_sg[0, 1:] = B_p\n            # Lower diagonal\n            ab_sg[2, :-1] = B_neg_p\n            \n            # Set up the right-hand side vector b\n            b_sg = np.zeros(num_interior_points)\n            # Boundary condition at x=0\n            b_sg[0] = -B_neg_p * c_L\n            # Boundary condition at x=1\n            b_sg[-1] = -B_p * c_R\n\n            # Solve the tridiagonal system\n            c_interior_sg = solve_banded((1, 1), ab_sg, b_sg)\n            \n            # Assemble the full solution vector\n            c_num_sg = np.concatenate(([c_L], c_interior_sg, [c_R]))\n        else: # Handle N=1 case\n            c_num_sg = np.array([c_L, c_R])\n\n        # Calculate RMS error for Scharfetter-Gummel\n        rms_error_sg = np.sqrt(np.mean((c_num_sg - c_exact)**2))\n        results.append(rms_error_sg)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}