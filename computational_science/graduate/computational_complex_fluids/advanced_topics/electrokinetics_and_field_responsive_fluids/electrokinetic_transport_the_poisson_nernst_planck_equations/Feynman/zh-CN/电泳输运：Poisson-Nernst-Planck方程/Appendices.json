{
    "hands_on_practices": [
        {
            "introduction": "要深刻理解泊松-能斯特-普朗克（Poisson-Nernst-Planck, PNP）方程组，一个关键的起点是掌握其静电学基础。这个练习将引导你从高斯定律等基本原理出发，推导并求解一维泊松方程 $-\\epsilon \\frac{d^2\\phi}{dx^2} = \\rho_{e}(x)$ 。通过为一个假设的正弦电荷分布解析地求解电势 $\\phi(x)$，你将亲身体验电荷密度如何直接决定系统的电势分布，这是所有电动力学模型的核心。",
            "id": "4085804",
            "problem": "考虑在一个一维平面域 $x \\in [0, L]$（其中 $L > 0$）内电解质的动电输运。在泊松-能斯特-普朗克 (PNP) 框架中，静电势 $\\phi(x)$ 通过静电学高斯定律以及电场和电位移的本构关系与电荷密度 $\\rho_{e}(x)$ 耦合。假设介电常数是恒定的，等于 $\\epsilon > 0$。总电荷密度给定为 $\\rho_{e}(x) = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$，其中 $\\rho_{0}$ 是一个常数。电势满足齐次狄利克雷边界条件 $\\phi(0) = 0$ 和 $\\phi(L) = 0$。\n\n从静电学的基本定律，即高斯定律 $\\nabla \\cdot \\mathbf{D} = \\rho_{e}$、本构关系 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 和电场定义 $\\mathbf{E} = -\\nabla \\phi$ 出发，推导在介电常数 $\\epsilon$ 为常数时，$\\phi(x)$ 的一维控制微分方程，并针对给定的 $\\rho_{e}(x)$ 和边界条件进行精确求解。提供用 $x$, $L$, $\\epsilon$ 和 $\\rho_{0}$ 表示的 $\\phi(x)$ 的最终闭式解析表达式。不需要进行数值近似。",
            "solution": "本问题要求在域 $x \\in [0, L]$ 中，针对给定的电荷密度分布 $\\rho_{e}(x)$ 和齐次狄利克雷边界条件，推导并求解静电势 $\\phi(x)$ 的一维泊松方程。我们首先验证问题陈述的有效性。\n\n**问题验证**\n\n**步骤 1：提取已知条件**\n- 域：$x \\in [0, L]$，其中 $L > 0$。\n- 基本定律：\n    1. 高斯定律：$\\nabla \\cdot \\mathbf{D} = \\rho_{e}$。\n    2. 本构关系：$\\mathbf{D} = \\epsilon \\mathbf{E}$。\n    3. 电场定义：$\\mathbf{E} = -\\nabla \\phi$。\n- 参数：\n    - 介电常数 $\\epsilon > 0$ 是一个常数。\n    - 电荷密度幅值 $\\rho_{0}$ 是一个常数。\n- 给定的电荷密度：$\\rho_{e}(x) = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$。\n- 边界条件：$\\phi(0) = 0$ 和 $\\phi(L) = 0$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据、是适定的且客观的。它基于静电学的基本原理，这些原理导出了泊松方程。该问题是适定的，因为它描述了一个带有两个边界条件的二阶线性常微分方程（一个狄利克雷边值问题），这保证了其解的唯一性。整个设定是自洽的，提供了所有必需的函数、参数和条件。该物理模型是研究动电现象时使用的标准理想化模型。不存在矛盾、歧义或事实性错误。\n\n**步骤 3：结论与行动**\n该问题是有效的。将推导其解。\n\n**推导与求解**\n\n首先，我们从给定的基本定律推导出一维泊松方程。\n我们从电位移场 $\\mathbf{D}$ 的高斯定律开始：\n$$ \\nabla \\cdot \\mathbf{D} = \\rho_{e} $$\n代入本构关系 $\\mathbf{D} = \\epsilon \\mathbf{E}$：\n$$ \\nabla \\cdot (\\epsilon \\mathbf{E}) = \\rho_{e} $$\n由于介电常数 $\\epsilon$ 是一个常数，它可以从散度算子中提出：\n$$ \\epsilon (\\nabla \\cdot \\mathbf{E}) = \\rho_{e} $$\n接下来，我们代入用静电势 $\\phi$ 表示的电场 $\\mathbf{E}$ 的定义，$\\mathbf{E} = -\\nabla \\phi$：\n$$ \\epsilon (\\nabla \\cdot (-\\nabla \\phi)) = \\rho_{e} $$\n$$ -\\epsilon (\\nabla \\cdot \\nabla \\phi) = \\rho_{e} $$\n算子 $\\nabla \\cdot \\nabla$ 是拉普拉斯算子，记为 $\\nabla^2$。因此，我们得到一般形式的泊松方程：\n$$ -\\epsilon \\nabla^2 \\phi = \\rho_{e} $$\n对于一维平面系统，拉普拉斯算子简化为关于空间坐标 $x$ 的二阶导数，即 $\\nabla^2 = \\frac{d^2}{dx^2}$。方程变为：\n$$ -\\epsilon \\frac{d^2\\phi}{dx^2} = \\rho_{e}(x) $$\n现在，我们代入给定的电荷密度表达式 $\\rho_{e}(x) = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$：\n$$ -\\epsilon \\frac{d^2\\phi}{dx^2} = \\rho_{0} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) $$\n整理方程以求解 $\\frac{d^2\\phi}{dx^2}$，我们得到待解的常微分方程：\n$$ \\frac{d^2\\phi}{dx^2} = -\\frac{\\rho_{0}}{\\epsilon} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) $$\n我们通过对 $x$ 积分两次来求解这个二阶常微分方程。积分一次得到电势的导数 $\\frac{d\\phi}{dx}$：\n$$ \\frac{d\\phi}{dx} = \\int -\\frac{\\rho_{0}}{\\epsilon} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) dx $$\n$$ \\frac{d\\phi}{dx} = -\\frac{\\rho_{0}}{\\epsilon} \\int \\sin\\!\\left(\\frac{\\pi x}{L}\\right) dx = -\\frac{\\rho_{0}}{\\epsilon} \\left(-\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right)\\right) + C_1 $$\n$$ \\frac{d\\phi}{dx} = \\frac{\\rho_{0}L}{\\epsilon\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right) + C_1 $$\n其中 $C_1$ 是第一个积分常数。\n再次积分得到电势 $\\phi(x)$ 的通解：\n$$ \\phi(x) = \\int \\left(\\frac{\\rho_{0}L}{\\epsilon\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right) + C_1\\right) dx $$\n$$ \\phi(x) = \\frac{\\rho_{0}L}{\\epsilon\\pi} \\int \\cos\\!\\left(\\frac{\\pi x}{L}\\right) dx + \\int C_1 dx $$\n$$ \\phi(x) = \\frac{\\rho_{0}L}{\\epsilon\\pi} \\left(\\frac{L}{\\pi} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\right) + C_1 x + C_2 $$\n$$ \\phi(x) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) + C_1 x + C_2 $$\n其中 $C_2$ 是第二个积分常数。\n\n现在，我们应用边界条件来确定常数 $C_1$ 和 $C_2$。\n第一个边界条件是 $\\phi(0) = 0$：\n$$ \\phi(0) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi \\cdot 0}{L}\\right) + C_1(0) + C_2 = 0 $$\n$$ \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin(0) + 0 + C_2 = 0 $$\n因为 $\\sin(0) = 0$，上式简化为：\n$$ 0 + C_2 = 0 \\implies C_2 = 0 $$\n现在解的形式为：\n$$ \\phi(x) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) + C_1 x $$\n第二个边界条件是 $\\phi(L) = 0$：\n$$ \\phi(L) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi L}{L}\\right) + C_1 L = 0 $$\n$$ \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin(\\pi) + C_1 L = 0 $$\n因为 $\\sin(\\pi) = 0$，上式简化为：\n$$ 0 + C_1 L = 0 $$\n考虑到域长度 $L > 0$，我们必须有：\n$$ C_1 = 0 $$\n两个积分常数都为零。将 $C_1 = 0$ 和 $C_2 = 0$ 代入通解，得到静电势的最终唯一解：\n$$ \\phi(x) = \\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\!\\left(\\frac{\\pi x}{L}\\right) $$\n该表达式即为用给定参数表示的 $\\phi(x)$ 的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\rho_{0}L^2}{\\epsilon\\pi^2} \\sin\\left(\\frac{\\pi x}{L}\\right)}$$"
        },
        {
            "introduction": "在许多实际情况下，完整的PNP方程组可以被简化。一个重要的简化是在平衡状态下得到的泊松-玻尔兹曼（Poisson-Boltzmann, PB）方程，及其在低电势 $|\\frac{e\\psi}{k_B T}| \\ll 1$ 假设下的线性化德拜-休克尔（Debye-Hückel, DH）近似。这个实践练习  不仅要求你推导这些模型，更重要的是通过编写代码来量化比较它们，从而确定DH近似的适用范围。这项技能对于任何希望在研究中明智地选择和应用简化模型的科学家来说都至关重要。",
            "id": "4085840",
            "problem": "考虑一个一维平面双电层，它位于一个对称单价电解质中，靠近一个在 $x=0$ 位置的均匀带电、平坦、非导电的壁面，电解质占据 $x \\ge 0$ 的区域。电势用 $\\psi(x)$ 表示，壁面电势边界条件为 $\\psi(0)=\\phi_0$，而在 $x \\to \\infty$ 时，电势趋近于电中性体相，即 $\\psi(\\infty)=0$。电解质的体相摩尔浓度为 $c_0$（单位为 $\\mathrm{mol}/\\mathrm{m}^3$），温度为 $T$（单位为 $\\mathrm{K}$）。假设溶剂为水，其相对介电常数恒为 $\\varepsilon_r=78.5$（无量纲），并使用真空介电常数 $\\varepsilon_0$（单位为 $\\mathrm{F}/\\mathrm{m}$）、元电荷 $e$（单位为 $\\mathrm{C}$）、玻尔兹曼常数 $k_B$（单位为 $\\mathrm{J}/\\mathrm{K}$）和阿伏伽德罗常数 $N_A$（单位为 $\\mathrm{mol}^{-1}$）作为标准物理常数。\n\n从适用于复杂流体中动电输运的第一性原理出发：\n- 静电泊松方程 $-\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = \\rho$，其中 $\\varepsilon=\\varepsilon_r \\varepsilon_0$ 是介电常数，$\\rho$ 是自由电荷密度。\n- 平衡状态下阳离子和阴离子数密度的玻尔兹曼分布为 $n_\\pm(x)=n_0 \\exp\\left(\\mp \\frac{e \\psi(x)}{k_B T}\\right)$，其中 $n_0=N_A c_0$。\n- 对称单价电解质的德拜长度的定义，由围绕电中性体相的线性响应导出。\n\n你的任务：\n1. 基于这些基础，不使用任何简化公式，推导出一维平面下的完整泊松-玻尔兹曼方程（针对 $\\psi(x)$）及其线性化的德拜-休克尔近似，方程需用无量纲电势 $u(x)=\\frac{e \\psi(x)}{k_B T}$、德拜长度的倒数 $\\kappa$ 和适当的边界条件表示。获得与所述边界条件一致的 $\\psi_{\\mathrm{PB}}(x)$ 和 $\\psi_{\\mathrm{DH}}(x)$ 的显式表达式。\n2. 定义一个定量误差度量 $\\mathcal{E}(c_0,\\phi_0,T)$，用于在一个截断为 $L=10 \\lambda_D$（其中 $\\lambda_D$ 是德拜长度）的半无限域上，比较德拜-休克尔近似与完整的泊松-玻尔兹曼解。使用在 $[0,L]$ 上的归一化均方根误差：\n$$\n\\mathcal{E} = \\frac{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{DH}}(x)-\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}.\n$$\n通过在 $[0,L]$ 上使用至少 $10^4$ 个点的均匀网格来近似积分，从而数值计算 $\\mathcal{E}$。\n3. 对于下面给出的每个参数三元组 $(c_0,\\phi_0,T)$，判断德拜-休克尔近似与完整的泊松-玻尔兹曼解相比，其误差是否小于 $5\\%$，使用的判据为 $\\mathcal{E}  0.05$（表示为小数阈值 $0.05$）。输入参数使用严格的国际单位制 (SI)：$c_0$ 的单位为 $\\mathrm{mol}/\\mathrm{m}^3$，$\\phi_0$ 的单位为 $\\mathrm{V}$，$T$ 的单位为 $\\mathrm{K}$。\n\n测试组（每一项是一个三元组 $(c_0,\\phi_0,T)$）：\n- $(1.0, 0.010, 298)$\n- $(100.0, 0.050, 298)$\n- $(10.0, 0.200, 298)$\n- $(1.0, 0.100, 310)$\n- $(500.0, 0.100, 273)$\n\n你的程序必须：\n- 实现推导出的公式，并使用所述常数为每个测试用例计算 $\\mathcal{E}$。\n- 生成一行输出，其中包含一个用方括号括起来的、逗号分隔的布尔值列表，顺序与测试组一致（例如，$[\\text{result}_1,\\text{result}_2,\\ldots,\\text{result}_5]$），如果 $\\mathcal{E}  0.05$，则对应的布尔值为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。",
            "solution": "### 步骤1：提取已知条件\n问题提供了以下信息：\n1.  **系统：** 位于一个对称单价电解质中的一维平面双电层，邻近一个在 $x=0$ 处的平坦、非导电壁面。电解质在区域 $x \\ge 0$ 内。\n2.  **变量：** 电势 $\\psi(x)$，阳离子/阴离子数密度 $n_\\pm(x)$。\n3.  **边界条件：**\n    - 壁面电势：$\\psi(0) = \\phi_0$。\n    - 体相电中性：当 $x \\to \\infty$ 时，$\\psi(x) \\to 0$。\n4.  **参数：**\n    - 电解质的体相摩尔浓度：$c_0$（单位为 $\\mathrm{mol}/\\mathrm{m}^3$）。\n    - 温度：$T$（单位为 $\\mathrm{K}$）。\n    - 溶剂（水）的相对介电常数：$\\varepsilon_r=78.5$。\n5.  **基本原理与定义：**\n    - 静电学泊松方程：$-\\nabla \\cdot \\left(\\varepsilon \\nabla \\psi\\right) = \\rho$，其中 $\\varepsilon=\\varepsilon_r \\varepsilon_0$。\n    - 离子密度的玻尔兹曼分布：$n_\\pm(x)=n_0 \\exp\\left(\\mp \\frac{e \\psi(x)}{k_B T}\\right)$，其中 $n_0 = N_A c_0$。\n    - 德拜长度的定义将从线性响应理论中推导。\n6.  **任务1：** 推导一维平面泊松-玻尔兹曼（PB）方程及其线性化的德拜-休克尔（DH）近似，并求出它们的解析解 $\\psi_{\\mathrm{PB}}(x)$ 和 $\\psi_{\\mathrm{DH}}(x)$。\n7.  **任务2：** 定义一个误差度量 $\\mathcal{E}$，作为在域 $[0,L]$（其中 $L=10\\lambda_D$）上比较 DH 和 PB 解的归一化均方根误差。\n    $$\n    \\mathcal{E} = \\frac{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{DH}}(x)-\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}{\\left(\\int_{0}^{L}\\left(\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x\\right)^{1/2}}\n    $$\n    需要在至少有 $10^4$ 个点的均匀网格上进行数值积分。\n8.  **任务3：** 对于给定的测试组 $(c_0, \\phi_0, T)$，判断 $\\mathcal{E}  0.05$ 是否成立。\n9.  **常数：** 问题引用了标准物理常数：真空介电常数 $\\varepsilon_0$、元电荷 $e$、玻尔兹曼常数 $k_B$ 和阿伏伽德罗常数 $N_A$。\n\n### 步骤2：使用提取的已知条件进行验证\n对照验证标准评估问题陈述：\n\n-   **科学基础：** 该问题牢固地植根于电解质静电学和统计力学的既定理论，特别是泊松-玻尔兹曼理论。这是物理化学和计算复杂流体领域的经典问题。它不含任何伪科学或有争议的主张。\n-   **良构性：** 该问题是良构的。控制方程、几何形状和边界条件都已明确指定，可以推导出唯一且稳定的解。数值任务有明确的定义，包括具体的误差度量和计算要求。\n-   **客观性：** 问题以精确、客观和定量的方式陈述。所有参数都有定义，任务清晰明确。\n-   **自洽性与一致性：** 问题提供了进行推导和计算所需的所有必要信息。没有内部矛盾。要求从给定原理（泊松方程、玻尔兹曼分布）推导方程是一致的，并确保了基于基础的解题方法。\n-   **无其他缺陷：** 该问题并非无关紧要、隐喻性的，也未超出科学验证的范围。它代表了对德拜-休克尔近似局限性的标准分析。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### 解答推导与计算策略\n\n解答过程首先推导电势所需的解析表达式，然后概述计算误差度量的数值程序。\n\n**1. 泊松-玻尔兹曼方程和德拜-休克尔方程及其解的推导（任务1）**\n\n分析始于电势 $\\psi(x)$ 的一维泊松方程，假设介电常数 $\\varepsilon = \\varepsilon_r \\varepsilon_0$ 为恒定值：\n$$\n-\\varepsilon \\frac{d^2\\psi}{dx^2} = \\rho(x)\n$$\n其中 $\\rho(x)$ 是局部自由电荷密度。对于对称的单价（$z=1$）电解质，电荷密度由阳离子和阴离子浓度之差乘以元电荷 $e$ 给出：\n$$\n\\rho(x) = e n_+(x) - e n_-(x)\n$$\n假设离子数密度 $n_\\pm(x)$ 服从玻尔兹曼分布，该分布将其局部浓度与相对于 $\\psi=0$ 的体相的局部势能 $q\\psi(x) = \\pm e\\psi(x)$ 联系起来：\n$$\nn_\\pm(x) = n_0 \\exp\\left(\\mp \\frac{e \\psi(x)}{k_B T}\\right)\n$$\n此处，$n_0 = N_A c_0$ 是阳离子（或阴离子）的体相数密度。将玻尔兹曼分布代入 $\\rho(x)$ 的表达式：\n$$\n\\rho(x) = e n_0 \\left(e^{-e\\psi(x)/(k_B T)} - e^{+e\\psi(x)/(k_B T)}\\right) = -2 e n_0 \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n将此代入泊松方程，得到完整的**泊松-玻尔兹曼（PB）方程**：\n$$\n\\frac{d^2\\psi}{dx^2} = \\frac{2 e n_0}{\\varepsilon} \\sinh\\left(\\frac{e\\psi(x)}{k_B T}\\right)\n$$\n为简化起见，我们引入无量纲电势 $u(x) = \\frac{e\\psi(x)}{k_B T}$。PB 方程变为：\n$$\n\\frac{d^2u}{dx^2} = \\left(\\frac{2 e^2 n_0}{\\varepsilon k_B T}\\right) \\sinh(u)\n$$\n括号中的项具有反长度平方的单位，并被定义为**德拜长度倒数** $\\kappa$ 的平方：\n$$\n\\kappa^2 = \\frac{2 e^2 n_0}{\\varepsilon k_B T} = \\frac{2 e^2 N_A c_0}{\\varepsilon_r \\varepsilon_0 k_B T}\n$$\n德拜长度为 $\\lambda_D = 1/\\kappa$。因此，无量纲 PB 方程为：\n$$\n\\frac{d^2u}{dx^2} = \\kappa^2 \\sinh(u)\n$$\n\n**德拜-休克尔（DH）近似**是在小电势假设下（即 $|\\psi| \\ll k_B T/e$，意味着 $|u| \\ll 1$）通过线性化 PB 方程得到的。在此极限下，$\\sinh(u) \\approx u$。线性化方程为：\n$$\n\\frac{d^2u}{dx^2} = \\kappa^2 u \\quad \\text{或} \\quad \\frac{d^2\\psi}{dx^2} = \\kappa^2 \\psi\n$$\n这就是 DH 方程。其通解为 $\\psi(x) = A e^{\\kappa x} + B e^{-\\kappa x}$。应用边界条件：\n-   $\\psi(\\infty) = 0 \\implies A=0$。\n-   $\\psi(0) = \\phi_0 \\implies B=\\phi_0$。\n因此，DH 方程的解为：\n$$\n\\psi_{\\mathrm{DH}}(x) = \\phi_0 e^{-\\kappa x}\n$$\n\n为了求解完整的非线性 PB 方程，我们将其乘以 $2 \\frac{du}{dx}$ 并积分：\n$$\n2\\frac{du}{dx}\\frac{d^2u}{dx^2} = 2\\kappa^2 \\sinh(u)\\frac{du}{dx} \\implies \\frac{d}{dx}\\left(\\frac{du}{dx}\\right)^2 = 2\\kappa^2 \\frac{d}{dx}(\\cosh(u))\n$$\n对 $x$ 积分得到 $\\left(\\frac{du}{dx}\\right)^2 = 2\\kappa^2 \\cosh(u) + C_1$。积分常数 $C_1$ 可由体相边界条件求得：在 $x \\to \\infty$ 时，$\\psi \\to 0$（因此 $u \\to 0$）且电场 $E_x = -d\\psi/dx \\to 0$（因此 $du/dx \\to 0$）。\n$$\n0 = 2\\kappa^2 \\cosh(0) + C_1 \\implies C_1 = -2\\kappa^2\n$$\n代入 $C_1$ 并使用恒等式 $\\cosh(u) - 1 = 2 \\sinh^2(u/2)$：\n$$\n\\left(\\frac{du}{dx}\\right)^2 = 2\\kappa^2 (\\cosh(u) - 1) = 4\\kappa^2 \\sinh^2(u/2)\n$$\n取平方根，我们得到 $\\frac{du}{dx} = \\pm 2\\kappa \\sinh(u/2)$。我们必须选择能确保电势从壁面到体相衰减的符号。如果 $\\phi_0>0$，则 $u(x)>0$，我们需要 $du/dx  0$，所以取负号。如果 $\\phi_00$，则 $u(x)0$ 且 $\\sinh(u/2)0$；我们需要 $du/dx>0$，所以也必须取负号。正确的选择总是：\n$$\n\\frac{du}{dx} = -2\\kappa \\sinh(u/2)\n$$\n这是一个可分离的微分方程。\n$$\n\\frac{du}{\\sinh(u/2)} = -2\\kappa \\, dx\n$$\n从壁面（$x=0$, $u=u_0$）积分到位置 $x$：\n$$\n\\int_{u_0}^{u(x)} \\frac{dz}{\\sinh(z/2)} = -2\\kappa \\int_0^x d\\xi' = -2\\kappa x\n$$\n左边的积分是 $2 \\ln(\\tanh(z/4))$。\n$$\n\\left[2\\ln\\left(\\tanh\\left(\\frac{z}{4}\\right)\\right)\\right]_{u_0}^{u(x)} = 2\\ln\\left(\\frac{\\tanh(u(x)/4)}{\\tanh(u_0/4)}\\right) = -2\\kappa x\n$$\n求解 $u(x)$：\n$$\n\\ln\\left(\\frac{\\tanh(u(x)/4)}{\\tanh(u_0/4)}\\right) = -\\kappa x \\implies \\tanh\\left(\\frac{u(x)}{4}\\right) = \\tanh\\left(\\frac{u_0}{4}\\right)e^{-\\kappa x}\n$$\n其中 $u_0 = u(0) = e\\phi_0/(k_B T)$。$\\psi_{\\mathrm{PB}}(x)$ 的最终解是：\n$$\n\\psi_{\\mathrm{PB}}(x) = \\frac{k_B T}{e} u(x) = \\frac{4 k_B T}{e} \\mathrm{arctanh}\\left(\\tanh\\left(\\frac{e\\phi_0}{4 k_B T}\\right)e^{-\\kappa x}\\right)\n$$\n\n**2. 误差度量与数值计算（任务2和3）**\n\n问题定义了一个归一化均方根误差 $\\mathcal{E}$ 来量化 DH 解相对于 PB 解的偏差：\n$$\n\\mathcal{E} = \\frac{\\sqrt{\\int_{0}^{L}\\left(\\psi_{\\mathrm{DH}}(x)-\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x}}{\\sqrt{\\int_{0}^{L}\\left(\\psi_{\\mathrm{PB}}(x)\\right)^2 \\, \\mathrm{d}x}}\n$$\n积分在域 $[0,L]$ 上进行，其中 $L=10\\lambda_D = 10/\\kappa$。该域覆盖了电势衰减的绝大部分，因为特征长度尺度是 $\\lambda_D$。\n\n为计算每个参数集 $(c_0, \\phi_0, T)$ 的 $\\mathcal{E}$，执行以下步骤：\n1.  使用物理常数的标准国际单位制 (SI) 值：$e=1.602176634 \\times 10^{-19} \\ \\mathrm{C}$，$k_B=1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$，$N_A=6.02214076 \\times 10^{23} \\ \\mathrm{mol}^{-1}$，$\\varepsilon_0=8.854187817 \\times 10^{-12} \\ \\mathrm{F/m}$。水的相对介电常数给定为 $\\varepsilon_r=78.5$。\n2.  对于给定的 $c_0$ 和 $T$ 计算德拜长度的倒数 $\\kappa$。\n3.  在从 $0$ 到 $L=10/\\kappa$ 的区间上建立一个至少有 $10^4$ 个点的均匀空间网格 $x_i$。我们将使用 $10001$ 个点。\n4.  使用推导出的公式在每个网格点上计算 $\\psi_{\\mathrm{DH}}(x_i)$ 和 $\\psi_{\\mathrm{PB}}(x_i)$。\n5.  计算分子 $(\\psi_{\\mathrm{DH}}(x_i)-\\psi_{\\mathrm{PB}}(x_i))^2$ 和分母 $(\\psi_{\\mathrm{PB}}(x_i))^2$ 的被积函数。\n6.  使用复合梯形法则对两个积分进行数值近似。\n7.  计算 $\\mathcal{E}$ 并判断其是否小于阈值 $0.05$。这将为每个测试用例得出一个布尔结果。\n\nDH 近似的有效性主要由无量纲表面电势 $u_0 = e\\phi_0/(k_B T)$ 的大小决定。当 $|u_0| \\ll 1$ 时，该近似预计是准确的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ... # Scipy is not needed\n\ndef solve():\n    \"\"\"\n    Solves the Poisson-Boltzmann problem to compare Debye-Hückel and full solutions.\n    \"\"\"\n\n    # Physical Constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    KB = 1.380649e-23            # Boltzmann constant in J/K\n    NA = 6.02214076e23           # Avogadro constant in mol^-1\n    EPS_0 = 8.854187817e-12      # Vacuum permittivity in F/m\n    EPS_R = 78.5                 # Relative permittivity of water\n\n    # Test cases: (c0 in mol/m^3, phi0 in V, T in K)\n    test_cases = [\n        (1.0, 0.010, 298),\n        (100.0, 0.050, 298),\n        (10.0, 0.200, 298),\n        (1.0, 0.100, 310),\n        (500.0, 0.100, 273),\n    ]\n\n    results = []\n    \n    # Numerical integration parameters\n    num_points = 10001  # Use 10001 points for 10^4 points (10000 intervals)\n\n    for c0, phi0, T in test_cases:\n        # Calculate derived parameters for the current case\n        epsilon = EPS_R * EPS_0\n        \n        # Calculate inverse Debye length (kappa)\n        kappa_sq = (2 * E_CHARGE**2 * NA * c0) / (epsilon * KB * T)\n        kappa = np.sqrt(kappa_sq)\n        \n        # Set integration limit L = 10 * debye_length\n        lambda_d = 1.0 / kappa\n        L = 10.0 * lambda_d\n        \n        # Dimensionless surface potential\n        thermal_voltage = KB * T / E_CHARGE\n        u0 = phi0 / thermal_voltage\n        \n        # Set up the spatial grid for integration\n        x_grid = np.linspace(0, L, num_points)\n        \n        # --- Calculate potentials on the grid ---\n        \n        # 1. Debye-Huckel (DH) solution\n        psi_dh = phi0 * np.exp(-kappa * x_grid)\n        \n        # 2. Full Poisson-Boltzmann (PB) solution\n        # Handle the phi0 = 0 case, although not in test suite.\n        if phi0 == 0.0:\n            psi_pb = np.zeros_like(x_grid)\n        else:\n            tanh_arg = u0 / 4.0\n            tanh_val = np.tanh(tanh_arg)\n            arctanh_arg = tanh_val * np.exp(-kappa * x_grid)\n            psi_pb = 4.0 * thermal_voltage * np.arctanh(arctanh_arg)\n\n        # --- Calculate the error metric E ---\n        \n        # Integrand for the numerator of E^2\n        integrand_num = (psi_dh - psi_pb)**2\n        \n        # Integrand for the denominator of E^2\n        integrand_den = psi_pb**2\n        \n        # Numerically compute integrals using the trapezoidal rule\n        integral_num = np.trapz(integrand_num, x=x_grid)\n        integral_den = np.trapz(integrand_den, x=x_grid)\n        \n        # Calculate the error E\n        if integral_den == 0:\n            # This occurs if phi0=0. In this case, psi_pb is zero everywhere.\n            # If psi_dh is also zero (which it is for phi0=0), the error is 0.\n            # Otherwise, if psi_dh is not zero, the relative error is infinite.\n            # For phi0=0, error is taken as 0.\n            error = 0.0\n        else:\n            error = np.sqrt(integral_num / integral_den)\n            \n        # Compare error to the threshold 0.05\n        results.append(error  0.05)\n        \n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "准确求解能斯特-普朗克方程的输运部分是模拟电动力学现象的核心挑战，尤其是在电迁移（漂移）远大于扩散的情况下，即佩克莱数（Péclet number）很高时。这个练习  将带你直面这一挑战，通过比较标准的中心差分格式和专门设计的Scharfetter-Gummel格式来求解一个对流占优的问题。你将通过计算误差亲眼看到，选择正确的数值方案对于获得物理上准确且无伪振荡的解是多么关键。",
            "id": "4085827",
            "problem": "考虑在外部施加的空间均匀电场作用下，由能斯特-普朗克方程（Nernst–Planck equation）控制的单一离子物质的一维稳态输运。在泊松-能斯特-普朗克（Poisson–Nernst–Planck, PNP）框架中，浓度 $c(x)$ 的稳态能斯特-普朗克通量可以写成守恒律形式\n$$\n\\frac{d}{dx} \\left( - D \\frac{dc}{dx} - \\mu z e E\\, c \\right) = 0 \\quad \\text{for} \\quad x \\in [0,1],\n$$\n边界条件为狄利克雷（Dirichlet）边界条件 $c(0) = c_L$ 和 $c(1) = c_R$，其中 $D$ 是扩散系数，$\\mu$ 是电泳迁移率， $z$ 是化合价， $e$ 是元电荷， $E$ 是恒定电场。在爱因斯坦关系式（Einstein relation）$D = \\mu V_T$（其中 $V_T$ 是热电压）下，定义无量纲漂移参数 $\\beta = E/V_T$。采用无量纲化尺度 $x \\in [0,1]$，并取 $D=1$，控制方程变为\n$$\n\\frac{d}{dx} \\left( - \\frac{dc}{dx} - \\beta\\, c \\right) = 0, \\quad c(0) = c_L, \\quad c(1) = c_R.\n$$\n这是一个一维空间中的守恒型对流-扩散边值问题。\n\n您的任务是实现一个完整的、可运行的程序，使用两种格式对该边值问题的一系列测试用例进行数值求解：\n- 应用于微分形式的二阶中心差分格式\n$$\n- \\frac{d^2 c}{dx^2} - \\beta \\frac{d c}{dx} = 0,\n$$\n该格式使用均匀的网格间距，并在端点处强制施加狄利克雷边界条件。\n- Scharfetter–Gummel (SG) 有限体积格式（Scharfetter–Gummel (SG) 是一种用于漂移-扩散问题的标准指数拟合离散化方法），该格式使用伯努利函数（Bernoulli function）对穿过每个单元交界面的守恒通量进行离散化\n$$\nB(\\xi) = \\frac{\\xi}{e^{\\xi} - 1},\n$$\n节点 $i$ 和 $i+1$ 之间的界面通量由下式给出\n$$\nF_{i+1/2} = - \\frac{1}{\\Delta x} \\left( c_{i+1} B(P) - c_i B(-P) \\right), \\quad P = \\beta\\, \\Delta x,\n$$\n并对每个控制体积强制执行通量平衡。\n\n从第一性原理出发，仅从守恒通量形式和边界条件推导出 $c(x)$ 的精确解析解，并用它来计算参考解，以衡量数值误差。推导必须从守恒稳态通量定律开始，逐步构建出精确解，而不能直接使用现成的公式。\n\n将具有节点 $\\{x_i\\}_{i=0}^N$ 的网格的离散均方根（RMS）误差定义为\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N+1} \\sum_{i=0}^{N} \\left( c_i^{\\text{num}} - c(x_i) \\right)^2 },\n$$\n其中 $c_i^{\\text{num}}$ 是节点 $x_i$ 处的数值解，$c(x_i)$ 是在 $x_i$ 处求值的精确解析解。\n\n您必须实现这两种格式，并为以下针对强漂移和覆盖范围的测试套件计算其 RMS 误差：\n- 测试用例 1（强漂移，粗网格）：$\\beta = 50$，$N = 16$，$c_L = 1.0$，$c_R = 0.2$。\n- 测试用例 2（强漂移，中等网格）：$\\beta = 50$，$N = 64$，$c_L = 1.0$，$c_R = 0.2$。\n- 测试用例 3（强漂移，细网格）：$\\beta = 50$，$N = 256$，$c_L = 1.0$，$c_R = 0.2$。\n- 测试用例 4（中等漂移，中等网格）：$\\beta = 0.5$，$N = 64$，$c_L = 1.0$，$c_R = 0.2$。\n\n所有变量和参数都是无量纲的；因此，最终的数值答案中不需要物理单位。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，按以下顺序输出两个浮点数：中心差分格式的 RMS 误差，然后是 Scharfetter–Gummel 格式的 RMS 误差。因此，最终输出必须总共包含八个数字，顺序与上面列出的测试用例相同，例如，“[e1_central,e1_sg,e2_central,e2_sg,e3_central,e3_sg,e4_central,e4_sg]”。",
            "solution": "该问题要求推导解析解，并实现两种数值格式来求解一维稳态对流-扩散方程。数值格式的准确性将针对一组给定的测试用例，与解析解进行比较评估。\n\n### 1. 解析解\n\n控制方程以守恒形式给出：\n$$\n\\frac{d}{dx} \\left( - \\frac{dc}{dx} - \\beta\\, c(x) \\right) = 0, \\quad \\text{for} \\quad x \\in [0,1]\n$$\n边界条件为狄利克雷（Dirichlet）边界条件 $c(0) = c_L$ 和 $c(1) = c_R$。\n\n设通量为 $J(x) = - \\frac{dc}{dx} - \\beta c(x)$。控制方程为 $\\frac{dJ}{dx} = 0$，这意味着通量 $J(x)$ 对所有 $x \\in [0,1]$ 都必须是一个常数，我们称之为 $K$。\n$$\n- \\frac{dc}{dx} - \\beta c(x) = K\n$$\n这是一个一阶线性常微分方程（ODE）。我们可以将其重写为：\n$$\n\\frac{dc}{dx} + \\beta c(x) = -K\n$$\n为求解此 ODE，我们首先找到齐次方程 $\\frac{dc_h}{dx} + \\beta c_h(x) = 0$ 的解。通过分离变量法，我们得到齐次解为 $c_h(x) = A e^{-\\beta x}$，其中 $A$ 是一个常数。\n\n对于特解，由于右侧是一个常数，我们假设一个常数特解 $c_p(x) = C_p$。代入 ODE 得到 $0 + \\beta C_p = -K$，因此 $C_p = -K/\\beta$。这在 $\\beta \\neq 0$ 时成立。$\\beta=0$ 的情况对应于纯扩散，$c''(x)=0$，其解为一个简单的线性剖面 $c(x) = c_L + (c_R - c_L)x$。由于所有测试用例的 $\\beta \\neq 0$，我们继续基于此假设进行推导。\n\n通解是齐次解和特解之和：\n$$\nc(x) = c_h(x) + c_p(x) = A e^{-\\beta x} - \\frac{K}{\\beta}\n$$\n常数 $A$ 和 $K$ 由边界条件确定：\n1.  在 $x=0$ 处： $c(0) = c_L \\implies c_L = A e^0 - K/\\beta = A - K/\\beta$。\n2.  在 $x=1$ 处： $c(1) = c_R \\implies c_R = A e^{-\\beta} - K/\\beta$。\n\n这是一个关于 $A$ 和 $K$ 的二元线性方程组。由第一个方程，我们得到 $A = c_L + K/\\beta$。将其代入第二个方程：\n$$\nc_R = (c_L + K/\\beta) e^{-\\beta} - K/\\beta = c_L e^{-\\beta} + \\frac{K}{\\beta} (e^{-\\beta} - 1)\n$$\n求解 $K$：\n$$\nc_R - c_L e^{-\\beta} = \\frac{K}{\\beta} (e^{-\\beta} - 1) \\implies K = \\beta \\frac{c_R - c_L e^{-\\beta}}{e^{-\\beta} - 1}\n$$\n现在我们求解 $A$：\n$$\nA = c_L + \\frac{1}{\\beta} \\left( \\beta \\frac{c_R - c_L e^{-\\beta}}{e^{-\\beta} - 1} \\right) = c_L + \\frac{c_R - c_L e^{-\\beta}}{e^{-\\beta} - 1} = \\frac{c_L(e^{-\\beta} - 1) + c_R - c_L e^{-\\beta}}{e^{-\\beta} - 1} = \\frac{c_R - c_L}{e^{-\\beta} - 1}\n$$\n将 $A$ 和 $K$ 代回通解 $c(x) = A e^{-\\beta x} - K/\\beta$ 中：\n$$\nc(x) = \\left( \\frac{c_R - c_L}{e^{-\\beta} - 1} \\right) e^{-\\beta x} - \\frac{1}{\\beta} \\left( \\beta \\frac{c_R - c_L e^{-\\beta}}{e^{-\\beta} - 1} \\right) = \\frac{(c_R - c_L) e^{-\\beta x} - (c_R - c_L e^{-\\beta})}{e^{-\\beta} - 1}\n$$\n通过重新整理可以得到一个更方便的形式：\n$$\nc(x) = \\frac{c_R(e^{-\\beta x} - 1) - c_L(e^{-\\beta x} - e^{-\\beta})}{e^{-\\beta}-1} = \\frac{c_L(e^{-\\beta} - e^{-\\beta x})}{e^{-\\beta}-1} + c_R\\frac{e^{-\\beta x}-1}{e^{-\\beta}-1}\n$$\n一个更简单的形式是：\n$$\nc(x) = c_L + (c_R - c_L) \\frac{e^{-\\beta x} - 1}{e^{-\\beta} - 1}\n$$\n我们用边界条件来验证这个形式：\n- 在 $x=0$ 处：$c(0) = c_L + (c_R - c_L) \\frac{e^0 - 1}{e^{-\\beta} - 1} = c_L + (c_R - c_L) \\frac{1-1}{e^{-\\beta} - 1} = c_L$。\n- 在 $x=1$ 处：$c(1) = c_L + (c_R - c_L) \\frac{e^{-\\beta} - 1}{e^{-\\beta} - 1} = c_L + c_R - c_L = c_R$。\n该解是正确的。此解析表达式将用作参考解。\n\n### 2. 数值格式\n\n我们将区域 $x \\in [0,1]$ 离散化为一个包含 $N+1$ 个节点的均匀网格 $\\{x_i\\}_{i=0}^N$，其中 $x_i = i \\Delta x$，网格间距为 $\\Delta x = 1/N$。内部节点处的浓度 $c_1, c_2, \\dots, c_{N-1}$ 是未知数。边界值 $c_0 = c_L$ 和 $c_N = c_R$ 是给定的。对于这两种格式，我们将为 $N-1$ 个未知数构建一个包含 $N-1$ 个线性方程的方程组，该方程组可以表示为矩阵形式 $A\\mathbf{c} = \\mathbf{b}$。\n\n#### 2.1. 中心差分格式\n\n此格式应用于方程的微分形式：\n$$\n- \\frac{d^2 c}{dx^2} - \\beta \\frac{d c}{dx} = 0\n$$\n我们使用二阶中心差分公式来近似内部节点 $x_i$ 处的导数：\n$$\n\\frac{d^2 c}{dx^2}\\bigg|_{x_i} \\approx \\frac{c_{i+1} - 2c_i + c_{i-1}}{(\\Delta x)^2}, \\quad \\frac{d c}{dx}\\bigg|_{x_i} \\approx \\frac{c_{i+1} - c_{i-1}}{2 \\Delta x}\n$$\n将这些代入 ODE，得到节点 $i$（其中 $i=1, \\dots, N-1$）的离散方程：\n$$\n- \\frac{c_{i+1} - 2c_i + c_{i-1}}{(\\Delta x)^2} - \\beta \\frac{c_{i+1} - c_{i-1}}{2 \\Delta x} = 0\n$$\n乘以 $(\\Delta x)^2$ 并重新整理各项：\n$$\n-(c_{i+1} - 2c_i + c_{i-1}) - \\beta \\frac{\\Delta x}{2} (c_{i+1} - c_{i-1}) = 0\n$$\n按共同的未知数 $c_j$ 进行分组：\n$$\n\\left(1 - \\frac{\\beta \\Delta x}{2}\\right) c_{i-1} - 2 c_i + \\left(1 + \\frac{\\beta \\Delta x}{2}\\right) c_{i+1} = 0\n$$\n这是一个三对角系统。下对角线、主对角线和上对角线上的系数分别为 $\\left(1 - \\frac{\\beta \\Delta x}{2}\\right)$、$-2$ 和 $\\left(1 + \\frac{\\beta \\Delta x}{2}\\right)$。边界项被移到右侧：\n- 对于 $i=1$：$-2 c_1 + \\left(1 + \\frac{\\beta \\Delta x}{2}\\right) c_2 = -\\left(1 - \\frac{\\beta \\Delta x}{2}\\right) c_0 = -\\left(1 - \\frac{\\beta \\Delta x}{2}\\right) c_L$。\n- 对于 $i=N-1$：$\\left(1 - \\frac{\\beta \\Delta x}{2}\\right) c_{N-2} - 2 c_{N-1} = -\\left(1 + \\frac{\\beta \\Delta x}{2}\\right) c_N = -\\left(1 + \\frac{\\beta \\Delta x}{2}\\right) c_R$。\n\n#### 2.2. Scharfetter–Gummel (SG) 格式\n\nSG 格式是一种基于守恒形式 $\\frac{dJ}{dx} = 0$ 的有限体积法。对围绕节点 $x_i$ 的控制体积 $[x_i - \\Delta x/2, x_i + \\Delta x/2]$ 进行积分，得到通量平衡：\n$$\n\\int_{x_i - \\Delta x/2}^{x_i + \\Delta x/2} \\frac{dJ}{dx} dx = J(x_i + \\Delta x/2) - J(x_i - \\Delta x/2) = J_{i+1/2} - J_{i-1/2} = 0\n$$\nSG 离散化为界面通量 $J_{i+1/2}$ 提供了指数拟合：\n$$\nJ_{i+1/2} = - \\frac{1}{\\Delta x} \\left( c_{i+1} B(\\beta \\Delta x) - c_i B(-\\beta \\Delta x) \\right)\n$$\n其中 $B(\\xi) = \\frac{\\xi}{e^{\\xi} - 1}$ 是伯努利函数。设 $P = \\beta \\Delta x$。通量平衡方程 $J_{i+1/2} = J_{i-1/2}$ 变为：\n$$\n- \\frac{1}{\\Delta x} \\left( c_{i+1} B(P) - c_i B(-P) \\right) = - \\frac{1}{\\Delta x} \\left( c_i B(P) - c_{i-1} B(-P) \\right)\n$$\n乘以 $-\\Delta x$ 并对各项进行分组：\n$$\nc_{i+1} B(P) - c_i B(-P) = c_i B(P) - c_{i-1} B(-P)\n$$\n$$\nB(-P)c_{i-1} - (B(P) + B(-P))c_i + B(P)c_{i+1} = 0\n$$\n这为内部节点 $i=1, \\dots, N-1$ 定义了一个三对角系统。下对角线、主对角线和上对角线上的系数分别为 $B(-P)$、$-(B(P) + B(-P))$ 和 $B(P)$。边界项被移到右侧：\n- 对于 $i=1$：$-(B(P) + B(-P))c_1 + B(P)c_2 = -B(-P)c_0 = -B(-P)c_L$。\n- 对于 $i=N-1$：$B(-P)c_{N-2} - (B(P) + B(-P))c_{N-1} = -B(P)c_N = -B(P)c_R$。\n为了在计算小 $\\xi$ 的伯努利函数时保持数值稳定性，表达式 $\\exp(\\xi)-1$ 应使用类似 `expm1` 的函数进行计算。对于 $\\xi=0$，其极限为 $B(0)=1$。\n\n### 3. 误差计算\n\n数值解 $c^{\\text{num}}$ 相对于精确解 $c(x)$ 的离散均方根（RMS）误差是在所有 $N+1$ 个网格点上计算的：\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N+1} \\sum_{i=0}^{N} \\left( c_i^{\\text{num}} - c(x_i) \\right)^2 }\n$$\n其中 $c_i^{\\text{num}}$ 是节点 $x_i$ 处的数值解，$c(x_i)$ 是解析解的值。由于狄利克雷边界条件是精确施加的，所以 $c_0^{\\text{num}} = c(x_0)$ 且 $c_N^{\\text{num}} = c(x_N)$，因此边界上的误差为零。\n\n该求解过程将通过一个 Python 程序实现，该程序为每个测试用例构建并求解这两个三对角系统，计算 RMS 误差，并打印结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady-state convection-diffusion problem for a suite of test cases\n    using Central Difference and Scharfetter-Gummel schemes, and computes their RMS errors.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (beta, N, c_L, c_R)\n        (50.0, 16, 1.0, 0.2), # Test case 1\n        (50.0, 64, 1.0, 0.2), # Test case 2\n        (50.0, 256, 1.0, 0.2),# Test case 3\n        (0.5, 64, 1.0, 0.2),  # Test case 4\n    ]\n\n    # Helper function for the Bernoulli function B(xi) = xi / (exp(xi) - 1)\n    def bernoulli(xi):\n        # Use Taylor expansion for small xi to avoid catastrophic cancellation\n        # and division by zero.\n        if abs(xi)  1e-9:\n            return 1.0 - xi / 2.0 + xi**2 / 12.0\n        else:\n            # np.expm1(xi) computes exp(xi) - 1 with high precision\n            return xi / np.expm1(xi)\n\n    # Helper function for the exact analytical solution\n    def analytical_solution(x, beta, c_L, c_R):\n        # Handle the case beta = 0 separately (pure diffusion)\n        if abs(beta)  1e-9:\n            return c_L + (c_R - c_L) * x\n        else:\n            # Use np.expm1 for precision in the denominator\n            return c_L + (c_R - c_L) * (np.exp(-beta * x) - 1.0) / np.expm1(-beta)\n\n    # List to store the results\n    results = []\n\n    for beta, N, c_L, c_R in test_cases:\n        # --- Grid Setup ---\n        # Number of interior points\n        num_interior_points = N - 1\n        # Grid spacing\n        dx = 1.0 / N\n        # Grid points\n        x_grid = np.linspace(0.0, 1.0, N + 1)\n        \n        # --- Analytical Solution ---\n        c_exact = analytical_solution(x_grid, beta, c_L, c_R)\n\n        # --- Central Difference Scheme ---\n        # The system is A*c = b, where c is the vector of interior concentrations.\n        # A is a tridiagonal matrix of size (N-1)x(N-1).\n        \n        if num_interior_points  0:\n            # Set up the tridiagonal matrix bands for scipy.linalg.solve_banded\n            # `ab` is a 3x(N-1) array: ab[0,:]=super-diag, ab[1,:]=main-diag, ab[2,:]=sub-diag\n            ab_cd = np.zeros((3, num_interior_points))\n            \n            # Main diagonal\n            ab_cd[1, :] = -2.0\n            # Upper diagonal (b_i), starting from ab[0, 1]\n            ab_cd[0, 1:] = 1.0 + beta * dx / 2.0\n            # Lower diagonal (a_i), ending at ab[2, N-2]\n            ab_cd[2, :-1] = 1.0 - beta * dx / 2.0\n\n            # Set up the right-hand side vector b\n            b_cd = np.zeros(num_interior_points)\n            # Boundary condition at x=0\n            b_cd[0] = -(1.0 - beta * dx / 2.0) * c_L\n            # Boundary condition at x=1\n            b_cd[-1] = -(1.0 + beta * dx / 2.0) * c_R\n            \n            # Solve the tridiagonal system\n            c_interior_cd = solve_banded((1, 1), ab_cd, b_cd)\n            \n            # Assemble the full solution vector\n            c_num_cd = np.concatenate(([c_L], c_interior_cd, [c_R]))\n        else: # Handle N=1 case\n            c_num_cd = np.array([c_L, c_R])\n\n        # Calculate RMS error for Central Difference\n        rms_error_cd = np.sqrt(np.mean((c_num_cd - c_exact)**2))\n        results.append(rms_error_cd)\n\n        # --- Scharfetter-Gummel Scheme ---\n        if num_interior_points  0:\n            P = beta * dx\n            B_p = bernoulli(P)\n            B_neg_p = bernoulli(-P)\n            \n            # Set up the tridiagonal matrix bands for solve_banded\n            ab_sg = np.zeros((3, num_interior_points))\n            \n            # Main diagonal\n            ab_sg[1, :] = -(B_p + B_neg_p)\n            # Upper diagonal\n            ab_sg[0, 1:] = B_p\n            # Lower diagonal\n            ab_sg[2, :-1] = B_neg_p\n            \n            # Set up the right-hand side vector b\n            b_sg = np.zeros(num_interior_points)\n            # Boundary condition at x=0\n            b_sg[0] = -B_neg_p * c_L\n            # Boundary condition at x=1\n            b_sg[-1] = -B_p * c_R\n\n            # Solve the tridiagonal system\n            c_interior_sg = solve_banded((1, 1), ab_sg, b_sg)\n            \n            # Assemble the full solution vector\n            c_num_sg = np.concatenate(([c_L], c_interior_sg, [c_R]))\n        else: # Handle N=1 case\n            c_num_sg = np.array([c_L, c_R])\n\n        # Calculate RMS error for Scharfetter-Gummel\n        rms_error_sg = np.sqrt(np.mean((c_num_sg - c_exact)**2))\n        results.append(rms_error_sg)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}