{
    "hands_on_practices": [
        {
            "introduction": "理解聚合物性质如何随分子量变化的标度律是高分子物理学的基石。这个练习将引导你从第一性原理出发，推导两种基本松弛机制——纯粹的爬行（reptation）和链长涨落（contour length fluctuations）——的粘度标度律。通过比较得到的标度指数，我们可以深入理解为何需要更复杂的模型来描述真实的聚合物熔体。",
            "id": "4102130",
            "problem": "考虑在线性聚合物的缠结聚合物管模型中的单分散熔体。令缠结数为 $Z$，管步长为 $a$，缠结时间为 $\\tau_{e}$，其定义为聚合物链段沿原初路径扩散距离 $a$ 所需的时间。总的原初路径轮廓长度为 $L = Z a$。熔体的零剪切粘度 $\\eta_{0}$ 由应力松弛模量的积分给出，对于具有明确平台模量 $G_{N}^{0}$ 的单分散、深度缠结的熔体，$\\eta_{0}$ 随 $Z$ 的标度关系由末端松弛时间 $\\tau_{d}$ 控制，因此有 $\\eta_{0} \\propto \\tau_{d}$。\n\n从基本的输运和统计力学原理出发，处理两种不同的应力松弛途径：\n\n- 纯粹的 reptation（蛇行）：整条链沿着管子进行曲线扩散，当链的位移达到与 $L$ 相当的距离时，导致末端松弛。\n- 轮廓长度涨落 (Contour Length Fluctuations, CLF)：链端的局部平衡导致链端沿着管子回缩，从而逐步释放距离链端一定距离处的取向约束。将 CLF 建模为末端回缩在时间 $t$ 内向链内部扩散性渗透距离 $\\ell(t)$ 的过程，其中 $\\ell(t)$ 由沿管子的一维扩散控制。\n\n仅使用以下基本依据：\n- 总的原初路径长度 $L = Z a$ 和缠结时间的定义，它为沿管运动设定了一个曲线扩散系数标度 $D_{e} \\sim a^{2}/\\tau_{e}$。\n- 一维运动的扩散输运关系 $\\ell(t) \\sim \\sqrt{2 D t}$。\n- 假设对于缠结状态下的线性聚合物，平台模量 $G_{N}^{0}$ 不依赖于 $Z$。\n\n基于这些依据，推导每种途径下末端松弛时间 $\\tau_{d}$ 随 $Z$ 的标度关系，并由此推导 $\\eta_{0}$ 随 $Z$ 的标度关系。然后，关注 CLF 提供主要末端松弛机制的有限 $Z$ 情况，量化轮廓长度涨落 (CLF) 对 $\\eta_{0}$ 标度指数的影响，表示为相对于纯粹 reptation 的指数变化。您的最终答案必须是等于指数变化 $\\Delta n = n_{\\text{CLF}} - n_{\\text{rep}}$ 的单个实数。不接受任何中间结果作为最终答案；仅提供指数变化。如果您需要近似任何表达式，可以这样做，但您的最终答案必须在推导出的标度律所蕴含的指数差异意义上是精确的。不需要四舍五入。由于指数是无量纲的，最终答案中不要包含任何物理单位。",
            "solution": "该问题要求推导缠结聚合物熔体的末端松弛时间 $\\tau_{d}$ 和零剪切粘度 $\\eta_{0}$ 相对于缠结数 $Z$ 的标度指数。这需要对两种不同的理论途径进行：纯粹的 reptation 和简化的轮廓长度涨落 (CLF) 模型。最终目标是计算这两种模型标度指数之间的差异。\n\n首先，我们建立所提供的基本关系。零剪切粘度与末端松弛时间成正比：\n$$\n\\eta_{0} \\propto \\tau_{d}\n$$\n因此，推导 $\\tau_{d}$ 随 $Z$ 的标度关系等同于推导 $\\eta_{0}$ 随 $Z$ 的标度关系。如果我们发现 $\\tau_{d} \\propto Z^{n}$，那么可以得出 $\\eta_{0} \\propto Z^{n}$，其中 $n$ 是标度指数。原初路径轮廓长度由 $L = Za$ 给出，其中 $a$ 是管步长。\n\n我们现在将分别分析每一种松弛途径。\n\n**途径 1：纯粹的 Reptation（蛇行）**\n\n在纯粹的 reptation 模型中，当整个聚合物链扩散出其原始的限制管时，应力松弛完成。这个过程被建模为链的质心沿着总长度为 $L$ 的原初路径轮廓的一维扩散。末端松弛时间 $\\tau_{d, \\text{rep}}$ 是链扩散一个与其自身轮廓长度 $L$ 相当的距离所需的特征时间。\n\n使用一维扩散的一般关系，我们有：\n$$\nL^{2} \\propto D_{c} \\tau_{d, \\text{rep}}\n$$\n其中 $D_{c}$ 是整条链沿管子的曲线扩散系数。\n\n为了确定 $D_{c}$ 对 $Z$ 的依赖关系，我们将链视为由 $Z$ 个缠结链段组成的序列。抵抗整条链沿管子运动的摩擦力是其组成链段摩擦力的总和。如果单个缠结链段的有效摩擦系数是 $\\zeta_{e}$，那么由 $Z$ 个链段组成的链的总摩擦力是 $\\zeta_{c} = Z \\zeta_{e}$。\n\n根据爱因斯坦关系，扩散系数与摩擦系数成反比。问题提供了一个链段扩散系数的标度，$D_{e} \\sim a^{2}/\\tau_{e}$，这是一个不依赖于总链长 $Z$ 的局部性质。我们将 $D_e$ 与单个链段的扩散联系起来，因此 $D_{e} \\propto 1/\\zeta_{e}$。整条链的扩散系数 $D_{c}$ 则是：\n$$\nD_{c} \\propto \\frac{1}{\\zeta_{c}} = \\frac{1}{Z \\zeta_{e}} \\propto \\frac{D_{e}}{Z}\n$$\n由于 $D_e$ 与 $Z$ 无关，链的扩散系数的标度关系为：\n$$\nD_{c} \\propto Z^{-1}\n$$\n现在我们可以求解 $\\tau_{d, \\text{rep}}$：\n$$\n\\tau_{d, \\text{rep}} \\propto \\frac{L^{2}}{D_{c}}\n$$\n代入 $L$ 和 $D_{c}$ 的依赖关系：$L = Za \\implies L^{2} \\propto Z^{2}$，以及 $D_{c} \\propto Z^{-1}$。\n$$\n\\tau_{d, \\text{rep}} \\propto \\frac{Z^{2}}{Z^{-1}} = Z^{3}\n$$\n因此，对于纯粹的 reptation，标度指数为 $n_{\\text{rep}} = 3$。\n\n**途径 2：轮廓长度涨落 (CLF)**\n\n在这种途径中，应力松弛由链端向管内的回缩所控制。问题指示我们将其建模为一个扩散过程，其中末端回缩向链内部的渗透距离 $\\ell(t)$ 由一维扩散控制：\n$$\n\\ell(t) \\sim \\sqrt{2 D t}\n$$\n问题明确指出这是“沿管子的扩散”，并提供了基本标度 $D_{e} \\sim a^{2}/\\tau_{e}$。这是一个局部过程，因此相关的扩散系数 $D$ 应该是链段扩散系数 $D_{e}$，它与总链长 $Z$ 无关。\n\n在此模型中，当链端涨落并回缩的距离达到与整个原初路径长度 $L$ 相当的程度时，就实现了末端松弛。因此，我们将末端时间 $\\tau_{d, \\text{CLF}}$ 设为渗透深度 $\\ell(t)$ 等于 $L$ 的时间 $t$：\n$$\n\\ell(\\tau_{d, \\text{CLF}}) \\sim L\n$$\n将此代入扩散方程：\n$$\nL \\sim \\sqrt{D_{e} \\tau_{d, \\text{CLF}}}\n$$\n两边平方并求解 $\\tau_{d, \\text{CLF}}$ 得到：\n$$\n\\tau_{d, \\text{CLF}} \\propto \\frac{L^{2}}{D_{e}}\n$$\n现在，我们引入对 $Z$ 的依赖关系。如前所述，$L^{2} \\propto Z^{2}$。扩散系数 $D_{e}$ 是一个与缠结链段相关的局部性质，且与 $Z$ 无关。\n$$\n\\tau_{d, \\text{CLF}} \\propto \\frac{Z^{2}}{1} = Z^{2}\n$$\n因此，对于指定的 CLF 主导模型，标度指数为 $n_{\\text{CLF}} = 2$。\n\n**指数变化的计算**\n\n问题要求计算从纯粹的 reptation 模型转到 CLF 主导模型时 $\\eta_{0}$（或等效地，$\\tau_d$）的标度指数的变化。这个变化 $\\Delta n$ 定义为：\n$$\n\\Delta n = n_{\\text{CLF}} - n_{\\text{rep}}\n$$\n代入推导出的指数值：\n$$\n\\Delta n = 2 - 3 = -1\n$$\n负号表示，所建模的 CLF 机制提供了一条比纯粹 reptation 更快的松弛途径（对链长的依赖性更弱），这在物理上是自洽的。",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "理论模型必须通过与实验数据的对比来验证其有效性。本练习将Doi-Edwards模型对压力松弛的预测与可通过介电谱等技术测量的链段取向数据联系起来。这种比较使得我们能够定量地评估纯粹爬行模型的准确性，并揭示压力和取向松弛的不同路径。",
            "id": "4102121",
            "problem": "在时间 $t=0^{+}$，对一种A型线性聚合物（偶极子沿主链链段排列）的单分散熔体施加小振幅阶梯剪切进行研究。Hermans取向张量定义为 $ \\mathbf{S}(t) = \\left\\langle \\frac{3}{2}\\,\\mathbf{u}(t)\\mathbf{u}(t) - \\frac{1}{2}\\,\\mathbf{I} \\right\\rangle $，其中 $\\mathbf{u}(t)$ 是沿代表性管段的单位矢量，$\\mathbf{I}$ 是单位张量。一项介电弛豫实验提供了归一化的链段取向自相关函数 $ \\Psi(t) = \\left\\langle \\mathbf{u}(0)\\cdot \\mathbf{u}(t) \\right\\rangle $。对于该材料，此函数可以很好地用Kohlrausch-Williams-Watts形式 $ \\Psi(t) = \\exp\\!\\big[-(t/\\tau_{e})^{\\beta}\\big] $ 进行拟合，其参数为 $\\tau_{e} = 10\\,\\mathrm{s}$ 和 $\\beta = 0.55$。在阶梯剪切施加后瞬间，$\\mathbf{S}(0)$ 的唯一非零分量是 $S_{xy}(0) = 0.10$。\n\n在Doi–Edwards管模型中，线性应力弛豫模量 $G(t)$ 与管存活概率 $\\mu(t)$ 成正比。对于单分散熔体，爬行存活概率可以用奇数模式 $p=1,3,5,\\dots$ 的傅里叶级数表示。使用前三个奇数模式，时间 $t$ 时的存活概率近似为\n$$\n\\mu(t) \\approx \\frac{8}{\\pi^{2}} \\sum_{p=1,3,5} \\frac{1}{p^{2}} \\exp\\!\\left[-p^{2}\\,\\frac{t}{\\tau_{d}}\\right],\n$$\n其中爬行时间为 $\\tau_{d} = 40\\,\\mathrm{s}$。平台模量为 $G_{N}^{0} = 2.0\\,\\mathrm{MPa}$。\n\n从线性响应和取向相关性的第一性原理出发，在 $t^{\\star} = 20\\,\\mathrm{s}$ 时完成以下计算：\n1. 根据介电弛豫数据计算 $S_{xy}(t^{\\star})$。\n2. 使用上述三模式近似，根据Doi–Edwards存活概率计算 $G(t^{\\star})$。\n3. 为了对介电取向衰减和Doi–Edwards的预测进行定量比较，计算无量纲比率\n$$\nR \\equiv \\frac{\\mu(t^{\\star})}{\\Psi(t^{\\star})}.\n$$\n\n将最终报告的 $R$ 值四舍五入至四位有效数字。最终报告的量必须是无量纲的。不要在最终答案中包含任何中间量。",
            "solution": "用户在聚合物物理领域提供了一个有效且适定的问题。求解该问题需要应用聚合物熔体的爬行理论和线性响应原理。任务涉及计算在特定时间 $t^{\\star} = 20\\,\\mathrm{s}$ 时Hermans取向张量的弛豫、应力弛豫模量，以及一个比较两个底层弛豫函数的无量纲比率。\n\n解题过程将按照问题陈述的要求分三部分进行。\n\n第1部分：取向张量分量 $S_{xy}(t^{\\star})$ 的计算\n\nHermans取向张量定义为 $\\mathbf{S}(t) = \\left\\langle \\frac{3}{2}\\,\\mathbf{u}(t)\\mathbf{u}(t) - \\frac{1}{2}\\,\\mathbf{I} \\right\\rangle$。因此其分量 $S_{xy}(t)$ 为 $S_{xy}(t) = \\frac{3}{2} \\langle u_x(t) u_y(t) \\rangle$。对于在 $t=0$ 时受到小扰动的系统，线性响应理论指出，对于 $t>0$，一个物理量的弛豫由其平衡时间相关函数决定。因此，张量 $\\langle \\mathbf{u}(t)\\mathbf{u}(t) \\rangle$ 的弛豫与链段取向自相关函数 $\\Psi(t) = \\langle \\mathbf{u}(0) \\cdot \\mathbf{u}(t) \\rangle$ 相关。具体来说，取向张量的非对角分量根据关系式 $\\langle u_x(t) u_y(t) \\rangle = \\langle u_x(0) u_y(0) \\rangle \\Psi(t)$ 弛豫。由此直接得出，Hermans张量分量 $S_{xy}(t)$ 从其初始值 $S_{xy}(0)$ 按如下方式弛豫：\n$$S_{xy}(t) = S_{xy}(0) \\Psi(t)$$\n问题中提供了从介电弛豫数据得到的Kohlrausch-Williams-Watts (KWW) 函数来描述 $\\Psi(t)$：\n$$\\Psi(t) = \\exp\\!\\big[-(t/\\tau_{e})^{\\beta}\\big]$$\n给定参数 $\\tau_{e} = 10\\,\\mathrm{s}$、$\\beta = 0.55$ 和初始条件 $S_{xy}(0) = 0.10$。我们必须计算在 $t^{\\star} = 20\\,\\mathrm{s}$ 时的 $S_{xy}(t)$。\n\n首先，我们计算 $\\Psi(t^{\\star})$：\n$$\\Psi(t^{\\star}) = \\Psi(20\\,\\mathrm{s}) = \\exp\\!\\left[-\\left(\\frac{20\\,\\mathrm{s}}{10\\,\\mathrm{s}}\\right)^{0.55}\\right] = \\exp\\!\\left[-2^{0.55}\\right]$$\n其数值为：\n$$2^{0.55} \\approx 1.464134$$\n$$\\Psi(t^{\\star}) \\approx \\exp(-1.464134) \\approx 0.231285$$\n现在我们可以计算 $S_{xy}(t^{\\star})$：\n$$S_{xy}(t^{\\star}) = S_{xy}(0) \\Psi(t^{\\star}) \\approx 0.10 \\times 0.231285 = 0.0231285$$\n\n第2部分：应力弛豫模量 $G(t^{\\star})$ 的计算\n\n根据Doi–Edwards管模型，线性应力弛豫模量 $G(t)$ 与管存活概率 $\\mu(t)$ 成正比，比例常数为平台模量 $G_N^0$：\n$$G(t) = G_N^0 \\mu(t)$$\n问题中为单分散熔体提供了 $\\mu(t)$ 的三模式近似：\n$$\\mu(t) \\approx \\frac{8}{\\pi^{2}} \\sum_{p=1,3,5} \\frac{1}{p^{2}} \\exp\\!\\left[-p^{2}\\,\\frac{t}{\\tau_{d}}\\right]$$\n给定 $G_N^0 = 2.0\\,\\mathrm{MPa}$ 和爬行时间 $\\tau_d = 40\\,\\mathrm{s}$。我们需要计算在 $t^{\\star} = 20\\,\\mathrm{s}$ 时的 $G(t)$。\n\n首先，我们计算 $\\mu(t^{\\star})$。指数的宗量是 $-p^2(t^\\star/\\tau_d) = -p^2(20/40) = -p^2/2$。\n将求和展开（对于 $p=1,3,5$）：\n$$\\mu(t^{\\star}) \\approx \\frac{8}{\\pi^{2}} \\left( \\frac{1}{1^{2}} \\exp\\!\\left[-\\frac{1^{2}}{2}\\right] + \\frac{1}{3^{2}} \\exp\\!\\left[-\\frac{3^{2}}{2}\\right] + \\frac{1}{5^{2}} \\exp\\!\\left[-\\frac{5^{2}}{2}\\right] \\right)$$\n$$\\mu(t^{\\star}) \\approx \\frac{8}{\\pi^{2}} \\left( \\exp(-0.5) + \\frac{1}{9}\\exp(-4.5) + \\frac{1}{25}\\exp(-12.5) \\right)$$\n现在我们代入数值：\n$$\\exp(-0.5) \\approx 0.606531$$\n$$\\exp(-4.5) \\approx 0.011109$$\n$$\\exp(-12.5) \\approx 3.7267 \\times 10^{-6}$$\n$$\\mu(t^{\\star}) \\approx \\frac{8}{\\pi^{2}} \\left( 0.606531 + \\frac{0.011109}{9} + \\frac{3.7267 \\times 10^{-6}}{25} \\right)$$\n$$\\mu(t^{\\star}) \\approx \\frac{8}{\\pi^{2}} \\left( 0.606531 + 0.0012343 + 0.00000015 \\right) \\approx \\frac{8}{\\pi^{2}}(0.607765)$$\n$$\\mu(t^{\\star}) \\approx 0.810569 \\times 0.607765 \\approx 0.492650$$\n现在我们可以计算 $G(t^{\\star})$：\n$$G(t^{\\star}) = G_N^0 \\mu(t^{\\star}) \\approx (2.0\\,\\mathrm{MPa}) \\times 0.492650 = 0.9853\\,\\mathrm{MPa}$$\n\n第3部分：无量纲比率 $R$ 的计算\n\n问题将无量纲比率 $R$ 定义为Doi–Edwards存活概率与链段取向自相关函数在 $t^{\\star}$ 时的比值：\n$$R \\equiv \\frac{\\mu(t^{\\star})}{\\Psi(t^{\\star})}$$\n使用前面部分计算出的值：\n$$\\mu(t^{\\star}) \\approx 0.492650$$\n$$\\Psi(t^{\\star}) \\approx 0.231285$$\n该比率为：\n$$R \\approx \\frac{0.492650}{0.231285} \\approx 2.130053$$\n问题要求将最终的 $R$ 值四舍五入至四位有效数字。\n$$R \\approx 2.130$$\n该比率量化了在 $t^{\\star}$ 时，纯粹爬行模型 ($\\mu(t)$) 的理论预测与从实验数据得出的取向弛豫经验性描述 ($\\Psi(t)$) 之间的差异。该值不为1，表明简单的爬行模型未包含的其他物理机制（例如，等高线长度涨落、约束释放）是显著的。",
            "answer": "$$\n\\boxed{2.130}\n$$"
        },
        {
            "introduction": "最后，我们将把“管子”及其“原始路径”这一抽象概念带入计算领域。这个练习提供了在聚合物模拟中分析纠缠拓扑的一个基础算法的实践经验。通过学习处理周期性边界条件并计算原始路径长度，你将掌握一项研究纠缠体系的关键计算技能。",
            "id": "4102124",
            "problem": "给定一个嵌入在具有周期性边界条件（PBC）的立方模拟盒子中的单条聚合物链。该链由盒子内一系列珠子的位置表示，相邻的珠子由键连接。盒子的边长分别为 $L_x$、$L_y$ 和 $L_z$ 纳米（nm）。在爬行理论和管模型的框架下，链的原初路径（PP）被定义为在保持链的纠缠拓扑不变的情况下，使轮廓长度最小化的路径。对于周期性域中的聚合物，纠缠拓扑最基本的层面可以通过链在三维环面上的同伦类来表示，该同伦类由沿每个周期性方向的整数缠绕数捕获。\n\n从第一性原理出发，推导一个算法，该算法能够：\n- 处理受周期性边界条件（PBC）约束的珠子位置。\n- 使用最小镜像约定（MIC）将链的位置展开到覆盖空间，同时保持链的连通性和正确的拓扑结构。\n- 计算链的缠绕数，即沿 $x$、$y$ 和 $z$ 方向净穿越周期性边界次数的整数。\n- 通过在固定端点（对于开放链）或固定缠绕数（对于闭合环）的约束下最小化轮廓长度，来确定链的原初路径（PP）长度 $L$，而不改变其同伦类。\n\n您的程序必须实现此算法，并为以下测试套件生成数值结果。所有长度必须以纳米（nm）为单位表示，最终输出必须四舍五入到六位小数。\n\n使用的定义和约束：\n- 周期性边界条件（PBC）：珠子位置是相对于盒子长度 $L_x$、$L_y$、$L_z$ 取模给出的。\n- 最小镜像约定（MIC）：对于连续珠子之间的位移 $\\Delta \\mathbf{r}$，最小镜像位移 $\\Delta \\mathbf{r}_{\\text{MIC}}$ 是通过逐分量减去盒子长度的整数倍来选择的，以确保每个分量都位于区间 $(-L_\\alpha/2, L_\\alpha/2]$ 内（其中 $\\alpha \\in \\{x,y,z\\}$），相应的整数累加到缠绕数中。\n- 开放链：展开后端点固定；原初路径是在覆盖空间中连接展开后端点的直线测地线，并保持缠绕数不变。\n- 环（闭合链）：端点在模盒子意义下重合；原初路径是与缠绕数一致的最短闭合测地线，改变缠绕数会破坏拓扑结构。\n\n测试套件（每个案例指定盒子长度（单位纳米）和珠子位置（单位纳米），以及链类型）：\n1. 正常情况，无边界穿越的开放链：\n   - 盒子: $[10.0, 10.0, 10.0]$\n   - 位置: $[(1.0, 1.0, 1.0), (3.0, 4.0, 5.0), (6.0, 7.0, 9.0)]$\n   - 链类型: open\n2. 沿 $x$ 方向穿越周期性边界的开放链：\n   - 盒子: $[10.0, 10.0, 10.0]$\n   - 位置: $[(9.0, 1.0, 1.0), (0.5, 1.5, 1.2), (2.0, 2.0, 2.0)]$\n   - 链类型: open\n3. 沿 $x$ 方向有一次净缠绕的环状聚合物：\n   - 盒子: $[10.0, 10.0, 10.0]$\n   - 位置: $[(1.0, 0.0, 0.0), (4.0, 0.0, 0.0), (7.0, 0.0, 0.0), (9.5, 0.0, 0.0), (1.0, 0.0, 0.0)]$\n   - 链类型: ring\n4. 靠近半盒子长度阈值的边界敏感开放链：\n   - 盒子: $[10.0, 10.0, 10.0]$\n   - 位置: $[(1.0, 1.0, 1.0), (5.9, 1.0, 1.0), (0.8, 1.0, 1.0)]$\n   - 链类型: open\n\n输出规范：\n- 您的程序应生成单行输出，其中包含四个测试用例的原初路径长度，格式为逗号分隔的列表，并用方括号括起来。每个数字必须是浮点数，单位为纳米（nm），四舍五入到六位小数。例如：\"[L1,L2,L3,L4]\"。",
            "solution": "该问题要求推导并实现一个算法，用于计算在受周期性边界条件（PBC）约束的立方模拟盒子中聚合物链的原初路径（PP）长度。问题的核心在于正确解释链的拓扑结构，在周期性域（一个 $3$-维环面）中，该拓扑由其同伦类定义。该同伦类由链围绕每个周期性维度的整数缠绕数捕获。该算法必须将链从主模拟盒子展开到无限覆盖空间，同时保持此拓扑结构，然后计算连接展开后端点的最短路径（测地线）的长度（对于开放链），或代表净拓扑缠绕的路径长度（对于闭合环）。\n\n设模拟盒子由其边长 $L_x$、$L_y$ 和 $L_z$ 定义。一条聚合物链由 $N$ 个珠子位置的序列 $\\mathbf{r}_1, \\mathbf{r}_2, \\ldots, \\mathbf{r}_N$ 给出，其中每个 $\\mathbf{r}_i = (x_i, y_i, z_i)$ 的分量是相对于相应盒子长度取模定义的，即 $x_i \\in [0, L_x)$，$y_i \\in [0, L_y)$ 和 $z_i \\in [0, L_z)$。\n\n为了分析链的拓扑结构，我们必须在无限欧几里得空间 $\\mathbb{R}^3$（它是 $3$-维环面的覆盖空间）中重建其路径。设该空间中“展开后”的珠子位置序列为 $\\mathbf{R}_1, \\mathbf{R}_2, \\ldots, \\mathbf{R}_N$。我们可以任意地将展开链的第一个珠子置于其在主盒子中的位置：\n$$\n\\mathbf{R}_1 = \\mathbf{r}_1\n$$\n展开链的其余部分是迭代构建的。对于每个后续的珠子 $i$（从 $2$ 到 $N$），我们根据前一个展开珠子的位置 $\\mathbf{R}_{i-1}$ 和到当前珠子在周期性盒子中位置 $\\mathbf{r}_i$ 的位移来确定其位置 $\\mathbf{R}_i$。关键原则是最小镜像约定（MIC），它假设连接两个连续珠子的“真实”键是在周期性空间中最短的可能向量。\n\n两个连续珠子在主盒子中的位移矢量是 $\\Delta \\mathbf{r}_i = \\mathbf{r}_i - \\mathbf{r}_{i-1}$。在覆盖空间中相应的“真实”或展开的位移矢量是 $\\Delta \\mathbf{R}_i$。根据 MIC，该矢量的每个分量 $\\Delta R_{i, \\alpha}$（对于 $\\alpha \\in \\{x, y, z\\}$）必须是可能的最短值，这使其处于区间 $(-L_\\alpha/2, L_\\alpha/2]$ 内。这是通过从周期性盒子中的位移分量 $\\Delta r_{i, \\alpha}$ 中加上或减去盒子长度 $L_\\alpha$ 的整数倍来实现的。\n程序上，对于给定的位移分量 $d = \\Delta r_{i, \\alpha}$ 和盒子长度 $L = L_\\alpha$，MIC 位移 $d_{\\text{MIC}} = \\Delta R_{i, \\alpha}$ 按如下方式计算：\n- 当 $d > L/2$ 时，更新 $d \\leftarrow d - L$。\n- 当 $d \\le -L/2$ 时，更新 $d \\leftarrow d + L$。\n最终的 $d$ 值即为 MIC 位移分量 $d_{\\text{MIC}}$。\n\n一旦找到了连接珠子 $i-1$ 和 $i$ 之间键的 MIC 位移矢量 $\\Delta \\mathbf{R}_i$，珠子 $i$ 的展开位置计算如下：\n$$\n\\mathbf{R}_i = \\mathbf{R}_{i-1} + \\Delta \\mathbf{R}_i\n$$\n对从 $i=2$ 到 $N$ 的所有珠子重复此过程，即可得到完整的展开链构型 $\\mathbf{R}_1, \\ldots, \\mathbf{R}_N$。\n\n原初路径（PP）被定义为保持纠缠拓扑不变的轮廓长度最小化路径。对于所描述的简化情况，这对应于覆盖空间中与链的展开构型一致的直线测地线。此路径的长度 $L_{PP}$ 是我们需要计算的量。\n\n代表该测地线的矢量，我们称之为 $\\mathbf{V}$，是展开链的总位移矢量。它是通过将所有单个 MIC 键矢量相加得到的：\n$$\n\\mathbf{V} = \\sum_{i=2}^{N} \\Delta \\mathbf{R}_i\n$$\n对于开放链，此矢量 $\\mathbf{V}$ 就是展开后的端到端矢量，$\\mathbf{V} = \\mathbf{R}_N - \\mathbf{R}_1$。PP 长度是该矢量的大小。\n对于闭合环，主盒子中的第一个和最后一个珠子位置相同，$\\mathbf{r}_1 = \\mathbf{r}_N$。矢量 $\\mathbf{V} = \\mathbf{R}_N - \\mathbf{R}_1$ 代表了在遍历环后链在覆盖空间中的净位移。该矢量的分量是盒子长度的整数倍，$\\mathbf{V} = (W_x L_x, W_y L_y, W_z L_z)$，其中 $\\mathbf{W}=(W_x, W_y, W_z)$ 是整数缠绕矢量，是环的一个拓扑不变量。具有此拓扑的最短周期性路径是一条长度为 $||\\mathbf{V}||$ 的直线。\n\n因此，对于本问题中定义的开放链和闭合链，计算 PP 长度 $L_{PP}$ 的算法是相同的：\n1. 初始化总位移矢量 $\\mathbf{V} = (0, 0, 0)$。\n2. 遍历链的键，从 $i=1$ 到 $N-1$，考虑珠子对 $(\\mathbf{r}_i, \\mathbf{r}_{i+1})$。\n3. 对每个键，计算在周期性盒子中的位移 $\\Delta \\mathbf{r} = \\mathbf{r}_{i+1} - \\mathbf{r}_i$。\n4. 对 $\\Delta \\mathbf{r}$ 的每个分量应用 MIC 程序，以获得 MIC 位移矢量 $\\Delta \\mathbf{R}$。\n5. 累加 MIC 位移：$\\mathbf{V} \\leftarrow \\mathbf{V} + \\Delta \\mathbf{R}$。\n6. 遍历所有键后，PP 长度是最终总位移矢量的欧几里得范数：\n$$\nL_{PP} = ||\\mathbf{V}|| = \\sqrt{V_x^2 + V_y^2 + V_z^2}\n$$\n这个单一、统一的算法可以正确计算所有指定测试用例所需的原初路径长度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Primitive Path (PP) length for polymer chains in a periodic box.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"box\": np.array([10.0, 10.0, 10.0]),\n            \"positions\": np.array([\n                [1.0, 1.0, 1.0], \n                [3.0, 4.0, 5.0], \n                [6.0, 7.0, 9.0]\n            ]),\n            \"type\": \"open\"\n        },\n        {\n            \"box\": np.array([10.0, 10.0, 10.0]),\n            \"positions\": np.array([\n                [9.0, 1.0, 1.0], \n                [0.5, 1.5, 1.2], \n                [2.0, 2.0, 2.0]\n            ]),\n            \"type\": \"open\"\n        },\n        {\n            \"box\": np.array([10.0, 10.0, 10.0]),\n            \"positions\": np.array([\n                [1.0, 0.0, 0.0], \n                [4.0, 0.0, 0.0], \n                [7.0, 0.0, 0.0], \n                [9.5, 0.0, 0.0], \n                [1.0, 0.0, 0.0]\n            ]),\n            \"type\": \"ring\"\n        },\n        {\n            \"box\": np.array([10.0, 10.0, 10.0]),\n            \"positions\": np.array([\n                [1.0, 1.0, 1.0], \n                [5.9, 1.0, 1.0], \n                [0.8, 1.0, 1.0]\n            ]),\n            \"type\": \"open\"\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        box = case[\"box\"]\n        positions = case[\"positions\"]\n        \n        # The total displacement vector in the covering space.\n        total_displacement = np.zeros(3)\n        \n        # Iterate through the bonds of the chain.\n        # A chain with N beads has N-1 bonds.\n        for i in range(len(positions) - 1):\n            r1 = positions[i]\n            r2 = positions[i+1]\n            \n            # Calculate the displacement in the periodic box.\n            delta_r = r2 - r1\n            \n            # Apply the Minimum Image Convention (MIC) to each component.\n            mic_displacement = np.zeros(3)\n            for j in range(3):\n                d = delta_r[j]\n                L = box[j]\n                half_L = L / 2.0\n                \n                # The MIC condition requires the displacement `d`\n                # to be in the interval (-L/2, L/2].\n                while d > half_L:\n                    d -= L\n                # Note the = for the lower bound.\n                while d = -half_L:\n                    d += L\n                \n                mic_displacement[j] = d\n            \n            # Accumulate the MIC bond vector to the total displacement.\n            total_displacement += mic_displacement\n            \n        # The Primitive Path length is the norm of the total displacement vector.\n        pp_length = np.linalg.norm(total_displacement)\n        \n        # Round to six decimal places as required.\n        results.append(f\"{pp_length:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}