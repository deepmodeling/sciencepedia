## 引言
[颗粒介质](@entry_id:750006)，如沙土、谷物和粉末，在自然界和工业生产中无处不在。它们的行为兼具固体与流体的双重特性，既能像固体一样承受应力，又能像流体一样流动，这种复杂的力学行为给传统的[连续介质力学](@entry_id:155125)带来了巨大挑战。为了从根本上理解和预测这些系统的行为，我们需要一种能够直接解析单个颗粒相互作用的方法。离散元方法（Discrete Element Method, DEM）正是为此而生的一种强大的计算工具，它通过追踪系统中每个颗粒的运动和相互作用，为我们打开了一扇观察颗粒世界内部运作的窗户。

本文旨在系统性地介绍离散元方法的建模理论与实践。我们将首先深入探讨其核心的 **原理与机制**，从基本的软硬球[模型选择](@entry_id:155601)，到复杂的[接触力学](@entry_id:177379)、时间积分方案以及非球形颗粒的表示方法，为您构建起完整的DEM知识框架。随后，我们将视野拓展到广阔的 **应用与交叉学科联系**，展示DEM如何作为“虚拟实验室”在岩[土力学](@entry_id:180264)、过程工程、材料科学乃至生物力学等前沿领域解决实际问题，并揭示其与[连续介质力学](@entry_id:155125)之间的深刻联系。最后，通过一系列精心设计的 **动手实践** 练习，您将有机会将理论知识付诸实践，亲手实现DEM的关键算法，并学习如何从模拟数据中提取有价值的物理信息。

## 原理与机制

离散元方法 (Discrete Element Method, DEM) 为我们提供了一个强大的计算框架，用于在颗粒尺度上解析[颗粒介质](@entry_id:750006)的复杂动力学行为。本章旨在深入探讨驱动这些模拟的核心原理与底层机制。我们将从离散元方法的基本思想出发，系统地构建起一个完整的[计算模型](@entry_id:637456)所需的各个关键组成部分——从接触定律到时间积分，再到非球形颗粒和宏观性质的联系。通过理解这些基本构件，读者将能够洞悉离散元方法如何将微观的颗粒相互作用转化为宏观的、可预测的集体行为。

### DEM 的核心思想：软球与硬[球模型](@entry_id:161388)

在离散元方法的发展历程中，形成了两种主流的建模思想：**软球时间驱动法 (soft-sphere time-driven approach)** 和 **硬球事件驱动法 (hard-sphere event-driven approach)**。这两种方法的选择，从根本上取决于所模拟[颗粒系统](@entry_id:1129404)的物理特性，特别是颗粒间的相互作用性质。

**硬球事件驱动法**将颗粒理想化为完全刚性的几何体，它们之间不能发生任何重叠。因此，颗粒间的碰撞被处理为瞬时发生的事件。在两次碰撞事件之间，颗粒进行无相互作用的自由飞行（仅受重力等外[力场](@entry_id:147325)影响）。模拟的推进方式是：首先预测系统中下一次即将发生的碰撞事件，然后将模拟时间精确地推进到该时刻，并根据动量守恒和[恢复系数](@entry_id:170710)等碰撞定律，瞬时地更新碰撞双方的速度。这种方法的核心假设是碰撞是二元的（即每次只涉及两个颗粒）且瞬时发生的。这一假设在[稀疏系统](@entry_id:168473)中是合理的，此时颗粒的平均自由程时间 $t_{\mathrm{mf}}$ 远大于真实的接触持续时间 $t_c$（即 $t_c \ll t_{\mathrm{mf}}$）。因此，硬球法对于模拟稀疏的[颗粒气体](@entry_id:201841)（例如，小体积分数 $\phi \ll 1$ 的系统）非常高效。然而，随着系统密度的增加，碰撞频率急剧上升，事件驱动的效率会骤降。更严重的是，多体（三个或更多颗粒）同时碰撞的概率增加，这打破了二元碰撞的基本假设，给算法和理论带来了巨大挑战。

与此相对，**软球时间驱动法**允许颗粒在接触时发生微小的、弹性的“虚拟”重叠。这种重叠并非物理真实，而是作为一种计算手段，用于根据预设的力-位移关系计算[接触力](@entry_id:165079)。当两个颗粒发生重叠时，会产生一个排斥力，其大小是重叠深度和[相对速度](@entry_id:178060)的函数。这种相互作用具有有限的持续时间 $t_c$。模拟的核心是采用一个固定的、微小的时间步长 $\Delta t$，在每个时间步中，根据所有颗粒的当前位置和速度计算它们之间的[接触力](@entry_id:165079)，然后应用[牛顿第二定律](@entry_id:274217)（$\sum \vec{F}_i = m_i \vec{a}_i$）对每个颗粒的[运动方程](@entry_id:264286)进行[数值积分](@entry_id:136578)，以更新它们在下一个时间步的位置和速度。由于该方法能够自然地处理多个颗粒同时接触以及持久接触的情况，它特别适用于模拟密集[颗粒系统](@entry_id:1129404)（例如，[体积分数](@entry_id:756566) $\phi$ 接近[随机密堆积](@entry_id:143300)的系统）。在这些系统中，颗粒几乎时刻都与邻居保持接触，形成传递力的网络，即“[力链](@entry_id:199587)”。在这种情况下，“持久接触”比“瞬时碰撞”更能描述物理[实质](@entry_id:149406)。

由于密集[颗粒流](@entry_id:750004)和准静态颗粒堆积是复杂流体和材料科学中的核心研究对象，本章后续内容将主要围绕应用更广泛的软球时间驱动法展开。

### 软球 DEM 的计算循环

一个典型的软球 DEM 模拟程序遵循一个固定的计算循环，这个循环在每个时间步 $\Delta t$ 内重复执行：

1.  **[接触检测](@entry_id:1122952) (Contact Detection)**：遍历所有颗粒，找出哪些颗粒对正在发生接触（即它们的虚拟几何体发生了重叠）。
2.  **力计算 (Force Calculation)**：对于每一个检测到的接触对，根据其几何重叠量和相对速度，应用接触力模型计算它们之间的相互作用力（包括[法向力](@entry_id:174233)和切向力）。同时，计算作用在每个颗粒上的体力（如重力）。
3.  **时间积分 (Time Integration)**：将作用在每个颗粒上的合力与[合力矩](@entry_id:166772)代入牛顿-[欧拉运动方程](@entry_id:177528)，使用数值积分算法（如[速度Verlet算法](@entry_id:137907)）更新每个颗粒的线速度、[角速度](@entry_id:192539)、位置和姿态。
4.  **重复**：推进到下一个时间步，返回第一步。

以下各节将详细阐述这一循环中的关键环节。

### [接触检测](@entry_id:1122952)：寻找相互作用的颗粒

在一个包含 $N$ 个颗粒的系统中，一个朴素的[接触检测](@entry_id:1122952)算法需要检查所有可能的颗粒对，即进行 $\binom{N}{2} \approx \frac{1}{2}N^2$ 次检查。对于大规模模拟而言，这种 $O(N^2)$ 的计算复杂度是无法接受的。为了克服这一瓶颈，现代 DEM 代码普遍采用一种两阶段的策略：**宽相 (broad-phase)** 和 **窄相 (narrow-phase)** 检测。

**宽相检测**的目标是使用计算成本低廉的粗略测试，快速剔除绝大多数不可能接触的颗粒对。一种高效的宽相检测方法是**[空间分解](@entry_id:755142)法 (spatial partitioning)**，例如使用均匀网格。该方法将整个模拟区域划分为一系列尺寸略大于最大颗粒直径的单元格。在检查一个特定颗粒的接触时，我们只需考虑其自身所在单元格以及相邻单元格内的其他颗粒。对于均匀分布的系统，每个颗粒的邻域内只包含有限数量的颗粒，这个数量与系统总颗粒数 $N$ 无关。因此，总的检查次数与 $N$ 成正比，即平均计算复杂度降至 $O(N)$。为确保不遗漏任何接触，对于半径在 $[r_{\min}, r_{\max}]$ 范围内的球形颗粒，网格单元的边长 $s$ 必须满足 $s \ge 2r_{\max}$。这样，任何两个接触球体的球心必定位于彼此相邻的单元格（包括自身所在的 $3 \times 3 \times 3$ 的 27 个单元格）之内。

**窄相检测**则对宽相检测筛选出的“候选对”进行精确的几何计算。其任务是确定颗粒间是否真的发生接触，并计算出后续力计算所需的精确几何信息，如法向重叠量、接触点位置和[接触法](@entry_id:152214)向量。

### [接触力学](@entry_id:177379)：模拟颗粒相互作用

[接触力学](@entry_id:177379)模型是 DEM 的物理核心，它决定了颗粒间的相互作用方式。

#### 几何预备：[接触运动学](@entry_id:165205)

在计算接触力之前，必须首先精确描述接触的几何与运动学状态。对于两个球形颗粒 $i$ 和 $j$，其中心位置分别为 $\mathbf{x}_i$ 和 $\mathbf{x}_j$，半径为 $R_i$ 和 $R_j$，我们定义以下关键量：

- **法向[单位向量](@entry_id:165907) $\mathbf{n}$**：通常定义为从颗粒 $i$ 指向颗粒 $j$ 的[单位向量](@entry_id:165907)，$\mathbf{n} = \frac{\mathbf{x}_j - \mathbf{x}_i}{||\mathbf{x}_j - \mathbf{x}_i||}$。
- **法向重叠量 $\delta$**：定义为两个颗粒在法向上的几何侵入深度。它是一个非负值，仅在颗粒接触时大于零：$\delta = \max(0, R_i + R_j - ||\mathbf{x}_j - \mathbf{x}_i||)$。
- **接触点相对速度 $\mathbf{v}_c$**：这是颗粒表面接触点处的[相对速度](@entry_id:178060)，它同时包含了平动和转动的贡献。设颗粒 $i$ 和 $j$ 的[平动](@entry_id:187700)速度为 $\mathbf{v}_i, \mathbf{v}_j$，[角速度](@entry_id:192539)为 $\boldsymbol{\omega}_i, \boldsymbol{\omega}_j$，则接触点相对速度（$j$ 相对于 $i$）为：
  $$
  \mathbf{v}_c = (\mathbf{v}_j - \mathbf{v}_i) - \boldsymbol{\omega}_i \times (R_i \mathbf{n}) - \boldsymbol{\omega}_j \times (R_j \mathbf{n})
  $$
  这个表达式考虑了每个颗粒由于自身旋转而在接触点产生的表面速度。
- **速度分解**：为了分别计算[法向力](@entry_id:174233)和切向力，需要将[相对速度](@entry_id:178060) $\mathbf{v}_c$ 分解为法向分量 $\mathbf{v}_n$ 和切向分量 $\mathbf{v}_t$：
  $$
  \mathbf{v}_n = (\mathbf{v}_c \cdot \mathbf{n})\mathbf{n}
  $$
  $$
  \mathbf{v}_t = \mathbf{v}_c - \mathbf{v}_n
  $$

#### [法向力](@entry_id:174233)模型

法向[接触力](@entry_id:165079) $F_n$ 是描述颗粒间排斥和能量耗散的关键，它通常是重叠量 $\delta$ 和法向[相对速度](@entry_id:178060) $v_n = \mathbf{v}_c \cdot \mathbf{n}$ 的函数。

- **线性弹簧-[阻尼模型](@entry_id:748160) (Linear Spring-Dashpot Model)**：这是最简单也最常用的模型之一，其形式为：
  $$
  F_n = k_n \delta + \gamma_n v_n
  $$
  其中，$k_n$ 是法向刚度系数（[弹簧常数](@entry_id:167197)），$\gamma_n$ 是法向[阻尼系数](@entry_id:163719)。该模型计算简单，且通过调节 $\gamma_n$ 可以方便地控制碰撞过程中的能量耗散，从而匹配一个目标[恢复系数](@entry_id:170710)。$k_n$ 可以被看作是在某个特征重叠量附近对真实[非线性](@entry_id:637147)接触行为的线性近似。

- **Hertz 接触模型**：对于光滑、无粘附的弹性球体间的接触，Hertz 理论给出了一个基于弹性力学推导的[非线性](@entry_id:637147)力-位移关系：
  $$
  F_n = \frac{4}{3} E^* \sqrt{R^*} \delta^{3/2}
  $$
  其中，$R^* = \frac{R_1 R_2}{R_1 + R_2}$ 是等效半径，$E^* = \left[\frac{1-\nu_1^2}{E_1} + \frac{1-\nu_2^2}{E_2}\right]^{-1}$ 是等效杨氏模量，它综合了两个颗粒的材料属性（杨氏模量 $E$ 和泊松比 $\nu$）。Hertz 模型准确地描述了[接触刚度](@entry_id:181039)随重叠深度增加而增加的[非线性](@entry_id:637147)行为（即接触面积增大的效应）。需要强调的是，纯 Hertz 模型是一个完全弹性的模型，它不包含任何能量耗散机制。为了模拟[非弹性碰撞](@entry_id:137360)（[恢复系数](@entry_id:170710)小于1），必须额外引入一个阻尼项，例如与 Hertz 模型结合形成 Hertz-Mindlin (no slip) 模型。 

#### 切向力模型（摩擦）

除了[法向力](@entry_id:174233)，颗粒间的摩擦力（即切向力）对[颗粒系统](@entry_id:1129404)的宏观行为（如[剪切强度](@entry_id:754762)和堆积稳定性）至关重要。一个经典的切向力模型是 Cundall 和 Strack 提出的。该模型在切向引入一个弹性弹簧，用于追踪接触以来的累积切向相对位移。切向力的大小与该位移成正比，但其上限受到[库仑摩擦定律](@entry_id:747943)的约束，即 $|F_t| \le \mu_s F_n$，其中 $\mu_s$ 是[静摩擦系数](@entry_id:163255)。一旦切向力达到这个阈值，接触点就会发生滑动。

#### 粘附接触模型

在许多微米或纳米尺度的[颗粒系统](@entry_id:1129404)中，以及在某些潮湿环境中，颗粒间的吸[引力](@entry_id:189550)（粘附力）不可忽略。经典的 Hertz 理论并未考虑这些吸[引力](@entry_id:189550)。为了描述粘附接触，发展了两种主要的理论模型：JKR 模型和 DMT 模型。

区分这两种模型适用范围的关键，在于比较由粘附力引起的弹性变形尺度与[表面力](@entry_id:188034)作用的微观范围。这个比较可以通过一个[无量纲参数](@entry_id:169335)——**Tabor 参数 $\mu$**——来量化：
$$
\mu = \left( \frac{R (\Delta\gamma)^2}{(E^*)^2 z_0^3} \right)^{1/3}
$$
其中，$\Delta\gamma$ 是单位面积的粘附功（表面能），$z_0$ 是表面吸[引力](@entry_id:189550)的作用范围。

- **JKR 模型 (Johnson-Kendall-Roberts)**：适用于 **Tabor 参数较大**（例如 $\mu \gtrsim 5$）的情况。这对应于颗粒较大、材料较软或粘附力很强的系统。此时，由粘附引起的弹性变形远大于[表面力](@entry_id:188034)的作用范围。粘附力被认为作用于接触区域内部，增大了接触面积，并改变了接触区内的应力分布，形成一个“[颈缩](@entry_id:183657)”。

- **DMT 模型 (Derjaguin-Muller-Toporov)**：适用于 **Tabor 参数较小**（例如 $\mu \lesssim 0.1$）的情况。这对应于颗粒较小、材料较硬或粘附力较弱的系统。此时，弹性变形可以忽略不计，接触的几何与应力分布仍基本符合 Hertz 理论。粘附力被处理为作用在 Hertz 接触区外部的长程吸[引力](@entry_id:189550)，简单地叠加在弹性排斥力之上。

- **过渡区**：当 Tabor 参数在 1 附近时（例如，对于 $R = 5.0 \times 10^{-5}\ \mathrm{m}$, $E^* = 5.0 \times 10^{10}\ \mathrm{Pa}$, $\Delta \gamma = 0.05\ \mathrm{J/m^2}$, $z_0 = 3.0 \times 10^{-10}\ \mathrm{m}$ 的二氧化硅颗粒，计算可得 $\mu \approx 1.2$），系统处于 JKR 和 DMT 模型的过渡区，需要更复杂的模型（如 Maugis-Dugdale 模型）来精确描述。

### [时间积分](@entry_id:267413)与[系统动力学](@entry_id:136288)

在计算出每个颗粒上的合力与合力矩之后，下一步是更新它们的运动状态。

#### [运动方程](@entry_id:264286)

每个颗粒的运动由[牛顿-欧拉方程](@entry_id:1128713)描述：
- **[平动](@entry_id:187700)**： $m_i \frac{d\mathbf{v}_i}{dt} = \sum \mathbf{F}_{i}$
- **转动**： $\mathbf{I}_i \frac{d\boldsymbol{\omega}_i}{dt} + \boldsymbol{\omega}_i \times (\mathbf{I}_i \boldsymbol{\omega}_i) = \sum \mathbf{T}_{i}$
其中，$\mathbf{v}_i$ 和 $\boldsymbol{\omega}_i$ 分别是颗粒的线速度和[角速度](@entry_id:192539)（通常在物体坐标系中表示），$m_i$ 和 $\mathbf{I}_i$ 分别是其质量和惯性张量。

#### 姿态表示：四元数的优势

为了追踪颗粒在三维空间中的转动，我们需要一种能够描述其姿态（orientation）的数学工具。尽管欧拉角（如[偏航、俯仰、滚转](@entry_id:199824)）直观，但它存在一个致命缺陷：**万向节死锁 (gimbal lock)**。在特定的姿态下（例如，当俯仰角为 $\pm \pi/2$ 时），两个旋转轴会重合，导致一个旋转自由度的丢失，从而在[数值积分](@entry_id:136578)中引发奇异性和不稳定性。

**[单位四元数](@entry_id:204470) (Unit Quaternions)** 提供了一种更优越的、无[奇异点](@entry_id:199525)的姿态表示方法。一个[单位四元数](@entry_id:204470) $\mathbf{q} = (q_0, q_1, q_2, q_3)$ 是一个[四维向量](@entry_id:275085)，满足 $\| \mathbf{q} \| = 1$。姿态的随时间演化由以下[运动学方程](@entry_id:173032)描述：
$$
\dot{\mathbf{q}} = \frac{1}{2} \mathbf{q} \otimes \boldsymbol{\omega}^{\text{quat}}
$$
其中 $\boldsymbol{\omega}^{\text{quat}} = (0, \omega_x, \omega_y, \omega_z)$ 是由物体坐标系下的[角速度](@entry_id:192539)构成的纯[四元数](@entry_id:1130460)，$\otimes$ 表示[四元数乘法](@entry_id:154753)。

尽管该方程在连续时间下能精确保持[四元数](@entry_id:1130460)的单位范数，但任何标准的数值积分方案（如[欧拉法](@entry_id:749108)或[龙格-库塔法](@entry_id:140014)）都会引入离散化误差，导致范数随时间漂移。因此，在实际的 DEM 代码中，必须周期性地对四元数进行**再归一化 (re-normalization)**，即 $\mathbf{q} \leftarrow \mathbf{q} / \|\mathbf{q}\|$。这一操作计算成本低廉，却能有效地保证从四元数重构出的旋转矩阵始终保持正交性，从而避免因[旋转矩阵](@entry_id:140302)变形而导致的伪滑移或穿透等[数值误差](@entry_id:635587)。

#### [数值积分](@entry_id:136578)与稳定性

软球 DEM 通常采用[显式时间积分](@entry_id:165797)方案，如[速度-Verlet](@entry_id:160498)算法或[中心差分法](@entry_id:163679)。显式方法的优点是无需迭代[求解非线性方程](@entry_id:177343)组，但其稳定性受到时间步长 $\Delta t$ 的限制。为了保证数值解不发散，时间步长必须足够小，以解析系统中最高频率的振荡。

这个最高频率通常由最“硬”的接触决定，即刚度最大、有效质量最小的接触对。对于一个由刚度为 $k$、有效质量为 $m_{\mathrm{eff}}$ 的接触构成的单自由度系统，其无阻尼固有圆频率为 $\omega_n = \sqrt{k/m_{\mathrm{eff}}}$。使用[中心差分法](@entry_id:163679)进行稳定分析可知，稳定的时间步长必须满足：
$$
\Delta t \le \frac{2}{\omega_n}
$$
对于一个包含多种接触的完整[颗粒系统](@entry_id:1129404)，其稳定性由整个系统中出现的最高[固有频率](@entry_id:174472) $\omega_{\max}$ 决定。因此，整个模拟的**[临界时间步长](@entry_id:178088) $\Delta t_{\mathrm{crit}}$** 为：
$$
\Delta t_{\mathrm{crit}} = \frac{2}{\omega_{\max}} \quad \text{其中} \quad \omega_{\max} = \max_{(i,j), \alpha \in \{n,t\}} \left\{ \sqrt{\frac{k_{\alpha}^{(ij)}}{m_{\mathrm{eff}}^{(ij)}}} \right\}
$$
这里的最大值取遍所有激活接触的法向（$n$）和切向（$t$）模式。这个条件揭示了 DEM 的一个核心权衡：使用更高的[接触刚度](@entry_id:181039)（以更真实地模拟硬颗粒）将导致 $\omega_{\max}$ 增大，从而必须采用更小的 $\Delta t$，使得计算成本显著增加。

### 超越球体：模拟颗粒形状

颗粒形状是影响[颗粒材料](@entry_id:750005)力学行为（如[剪切强度](@entry_id:754762)、各向异性和[堆积密度](@entry_id:138204)）的关键因素。虽然球形颗粒模型简单高效，但许多真实世界的颗粒（如沙子、谷物、药片）都是非球形的。为了捕捉形状效应，DEM 中发展了多种非球形颗粒表示方法。

- **球体团簇 (Clumps of Spheres)**：将一个非球形颗粒表示为多个（可能重叠的）球体的刚性组合。这种方法实现相对简单，因为[接触检测](@entry_id:1122952)最终归结为球-球检测。它可以方便地表示凹形颗粒。其缺点是表面由球面片拼接而成，在接缝处不光滑（法向不连续），这可能给某些需要高阶光滑性的应用带来困难。

- **超[二次曲面](@entry_id:264390) (Superquadrics)**：通过一个[隐式方程](@entry_id:177636) $\left(\left|\frac{x}{a}\right|^{\epsilon_1} + \left|\frac{y}{b}\right|^{\epsilon_1}\right)^{\epsilon_2/\epsilon_1} + \left|\frac{z}{c}\right|^{\epsilon_2} = 1$ 定义的几何体。通过调节半轴长 $a,b,c$ 和形状指数 $\epsilon_1, \epsilon_2$，可以生成从长方体到椭球体再到星形的各种形状。当指数大于2时，其表面[几乎处处](@entry_id:146631)是二次可微的 ($C^2$)，这对于需要解析计算法向和曲率的高级算法非常有利。然而，单个超[二次曲面](@entry_id:264390)只能是[凸体](@entry_id:183909)。

- **球多面体 (Spheropolyhedra)**：由一个核心[多面体](@entry_id:637910)与一个球体的[闵可夫斯基和](@entry_id:176841) (Minkowski sum) 构成，相当于对多面体的棱和角进行“圆化”。其表面由平面片、圆柱面片和球面片光滑拼接而成，保证了法向连续（$C^1$ 边界），但曲率在拼接处不连续。这种模型能很好地模拟具有圆角的颗粒。

- **刚性多面体 (Rigid Polyhedra)**：直接使用由平面构成的[多面体](@entry_id:637910)来表示颗粒。这种方法能精确地表示具有尖锐棱和角的颗粒。然而，[接触检测](@entry_id:1122952)算法更为复杂。对于[凸多面体](@entry_id:170947)，可以使用分离轴定理 (Separating Axis Theorem, SAT)。但对于凹[多面体](@entry_id:637910)，必须先将其分解为多个[凸体](@entry_id:183909)，SAT 并不直接适用。此外，[多面体](@entry_id:637910)的表面在棱和角处法向不连续，这使得接触映射关于姿态是不可微的。

### 从微观到宏观：连接尺度

DEM 的一个核心价值在于它能从颗粒尺度的相互作用出发，预测和解释宏观尺度的材料行为。这需要建立连接微观和宏观的桥梁。

#### 宏观[应力张量](@entry_id:148973)

在连续介质力学中，应力是描述内部力分布的核心物理量。在[颗粒介质](@entry_id:750006)中，宏观应力张量 $\boldsymbol{\sigma}$ 可以通过对一个代表性体积元 (Representative Volume Element, RVE) $V$ 内的微观相互作用进行平均得到。根据 Love-Weber 公式，对于准静态系统，应力主要来自于接触力的贡献：
$$
\boldsymbol{\sigma} = \frac{1}{V} \sum_{c} \mathbf{f}_c \otimes \mathbf{l}_c
$$
其中，求和遍历体积元内所有的接触 $c$，$\mathbf{f}_c$ 是[接触力](@entry_id:165079)，$\mathbf{l}_c$ 是连接接触双方颗粒中心的枝向量。对于快速流动的系统，还必须考虑颗粒速度涨落引起的动理学贡献（或称雷诺应力）。

#### 各向异性与细观结构张量

颗粒堆积的力学行为强烈依赖于其内部结构的各向异性。为了量化这种几何各向异性，我们定义**细观结构张量 (fabric tensor)** $\mathbf{F}$：
$$
\mathbf{F} = \frac{1}{N_c} \sum_{c=1}^{N_c} \mathbf{n}_c \otimes \mathbf{n}_c
$$
其中 $N_c$ 是接触总数，$\mathbf{n}_c$ 是[接触法](@entry_id:152214)向。$\mathbf{F}$ 是一个对称的[二阶张量](@entry_id:199780)，其迹恒为1（$\mathrm{tr}(\mathbf{F}) = 1$）。它的[特征向量](@entry_id:151813)给出了接触网络分布的[主方向](@entry_id:276187)，而特征值的差异则量化了各向异性的程度。一个完全各向同性的接触网络对应于 $\mathbf{F} = \frac{1}{3}\mathbf{I}$，其中 $\mathbf{I}$ 是单位张量。

应力张量 $\boldsymbol{\sigma}$ 和细观结构张量 $\mathbf{F}$ 密切相关。在理想化的假设下（如无摩擦且[法向力](@entry_id:174233)均匀），$\boldsymbol{\sigma}$ 与 $\mathbf{F}$ 成正比。在更一般的情况下，宏观应力的偏量部分（即剪应力）主要是由细观结构和接触力分布的各向异性共同支撑的。

#### 本构行为：µ(I) [流变学](@entry_id:138671)

DEM 模拟是探索[颗粒材料](@entry_id:750005)宏观本构关系（即[应力与应变率](@entry_id:263123)之间关系）的有力工具。对于干燥、密集、无粘性的颗粒在剪切作用下的流动，一个重要的发现是其流变行为可以由一个[无量纲参数](@entry_id:169335)——**[惯性数](@entry_id:750626) (inertial number) $I$**——来主导。
$$
I = \dot{\gamma} d \sqrt{\frac{\rho_p}{P}}
$$
这里，$\dot{\gamma}$ 是剪切率，$d$ 是颗粒直径，$\rho_p$ 是[颗粒材料](@entry_id:750005)密度，$P$ 是系统承受的围压。[惯性数](@entry_id:750626)可以理解为两个时间尺度的比值：颗粒在压力 $P$ 下的微观重排时间与宏观[剪切变形](@entry_id:170920)时间。

大量的 DEM 模拟和实验表明，宏观摩擦系数 $\mu = \tau/P$（其中 $\tau$ 是剪应力）是[惯性数](@entry_id:750626) $I$ 的一个单调递增函数，这种关系被称为 **$\mu(I)$ [流变学](@entry_id:138671)**。一个常用的经验拟合公式是：
$$
\mu(I) = \mu_s + \frac{\Delta \mu}{1 + I_0/I}
$$
其中，$\mu_s$ 是准[静态极限](@entry_id:262480)（$I \to 0$）下的[摩擦系数](@entry_id:150354)，$\mu_s + \Delta \mu$ 是快速流动极限（$I \to \infty$）下的[摩擦系数](@entry_id:150354)，$I_0$ 是一个拟合常数。这个模型成功地将微观颗粒参数（通过 DEM）与宏观连续介质[流变模型](@entry_id:193749)联系起来。

### 确保正确性：[验证与确认](@entry_id:1133775)

最后，作为一种复杂的计算工具，DEM 模型的可靠性必须经过严格的检验。在计算科学中，我们区分两个重要的过程：**验证 (Verification)** 和 **确认 (Validation)**。

**验证 (Verification)** 旨在回答：“我们是否正确地求解了方程？” 这是一个数学和程序层面的检查，用于确保代码准确地实现了其所基于的数学模型。典型的验证测试包括：
- 将模拟结果与已知的解析解进行比较。例如，模拟一个无接触颗粒在重力下的自由落体，并将其轨迹与 $z(t) = z_0 + v_0 t - \frac{1}{2} g t^2$ 进行对比；或模拟两个球体的简单碰撞，并将其运动与[阻尼谐振子](@entry_id:276848)的解析解对比。
- 检查数值收敛性。随着时间步长 $\Delta t$ 的减小，数值解与精确解之间的误差应以与[积分器](@entry_id:261578)阶数相符的速率减小。
- 检查守恒定律。对于一个孤立的、无耗散的系统，总能量和[总动量](@entry_id:173071)应在[数值误差](@entry_id:635587)范围内保持守恒。

**确认 (Validation)** 旨在回答：“我们是否求解了正确的方程？” 这是一个物理层面的检查，用于评估所选的数学模型（包括其参数）在多大程度上能够准确地再现真实世界的物理现象。确认需要将模拟的输出与独立的实验数据进行比较。典型的确认测试包括：
- 比较涌现出的宏观性质。例如，模拟颗粒从漏斗中流出形成的堆积，并将其**[休止角](@entry_id:175944) (angle of repose)** 与实验室测量的结果进行比较。
- 比较宏观动力学行为。例如，模拟筒仓卸料过程，并将模拟得到的流量与实验总结出的 Beverloo 定律进行比较。
- 比较宏观流变规律。例如，模拟颗粒在斜槽中的流动，并检验其应力-应变率关系是否符合实验观察到的 Bagnold [标度律](@entry_id:266186)。
- 比较宏观结构特性。例如，通过模拟振动或压缩过程，看是否能复现出与实验一致的**[随机密堆积](@entry_id:143300) (random close packing)** 体积分数（对单分散球体约为 0.64）。

通过严谨的[验证与确认](@entry_id:1133775)，DEM 才能从一个纯粹的计算工具，转变为一个可靠的、用于科学探索和工程设计的“虚拟实验室”。