{
    "hands_on_practices": [
        {
            "introduction": "The core of a topological defect is a fascinating region where the nematic order parameter vanishes, and the material locally resembles an isotropic fluid. The size of this core is not arbitrary; it is set by a competition between the energetic cost of creating spatial gradients in order and the energetic gain of restoring the ordered phase. This practice guides you through a foundational calculation using the Landau–de Gennes theory to derive the characteristic length scale, or 'healing length,' that defines the defect core radius, providing a direct link between macroscopic material parameters and the microscopic structure of a defect. ",
            "id": "4110588",
            "problem": "Consider the Landau–de Gennes (LdG) continuum theory for a uniaxial nematic liquid crystal described by the second-rank, symmetric, traceless alignment tensor $Q_{ij}$. The total free energy is the functional\n$$\nF[Q] \\;=\\; \\int_{\\Omega} \\left[ f_{\\mathrm{bulk}}(Q) \\;+\\; f_{\\mathrm{elastic}}(Q,\\nabla Q) \\right] \\,\\mathrm{d}V,\n$$\nwith bulk free-energy density\n$$\nf_{\\mathrm{bulk}}(Q) \\;=\\; \\frac{A}{2}\\,\\mathrm{Tr}(Q^{2}) \\;-\\; \\frac{B}{3}\\,\\mathrm{Tr}(Q^{3}) \\;+\\; \\frac{C}{4}\\,\\bigl(\\mathrm{Tr}(Q^{2})\\bigr)^{2},\n$$\nwhere $A$, $B$, and $C$ are material parameters, and the one-constant elastic free-energy density\n$$\nf_{\\mathrm{elastic}}(Q,\\nabla Q) \\;=\\; \\frac{L}{2}\\,\\partial_{k}Q_{ij}\\,\\partial_{k}Q_{ij},\n$$\nwith $L$ a Frank-like elastic constant, and summation over repeated indices understood. In a two-dimensional plane containing a disclination of strength $m$ at the origin, approximate $Q_{ij}$ by a uniaxial form $Q_{ij} = \\frac{3S(r)}{2}\\left(n_{i}n_{j} - \\frac{1}{3}\\delta_{ij}\\right)$, where $S(r)$ is the scalar order parameter depending only on the radial coordinate $r$ and $n_{i}$ is a unit director field with the standard angular dependence of winding number $m$.\n\nUsing only the variational principle $\\delta F = 0$ and asymptotic reasoning valid in the defect core where $S(r)$ is small, derive the characteristic core radius $\\xi$ as a healing length that controls the radial variation of $S(r)$. Your derivation must start from the Euler–Lagrange equation for $S(r)$ obtained from the above free-energy functional and must make clear what combination of material parameters sets $\\xi$.\n\nThen, for a thermotropic nematic with parameters $L = 6.0 \\times 10^{-12}$ $\\mathrm{J\\,m^{-1}}$ and $A = 1.0 \\times 10^{5}$ $\\mathrm{J\\,m^{-3}}$, compute the predicted $\\xi$ and express it in nanometers. Finally, given an observed core radius from high-resolution imaging $\\xi_{\\mathrm{obs}} = 8.0$ nm, compute the ratio $R = \\xi_{\\mathrm{pred}}/\\xi_{\\mathrm{obs}}$.\n\nRound your final ratio $R$ to three significant figures. The ratio is dimensionless; the intermediate core radius must be expressed in nanometers.",
            "solution": "The problem asks for the derivation of the characteristic core radius, $\\xi$, using the Landau–de Gennes (LdG) theory under an asymptotic approximation, and then to compute its value.\n\n### 1. Theoretical Derivation\nThe total free energy is $F[Q] = \\int (f_{\\mathrm{bulk}} + f_{\\mathrm{elastic}}) \\,dV$. We use the provided uniaxial ansatz for the Q-tensor, $Q_{ij} = \\frac{3S}{2}(n_i n_j - \\frac{1}{3}\\delta_{ij})$, where the director field has a winding number $m$ and $S=S(r)$. The corresponding free-energy density can be expressed in terms of $S$ and its gradients. The relevant terms for determining the core size are the lowest-order terms in $S$ and its spatial derivatives.\n-   The bulk energy density is $f_{\\mathrm{bulk}} = \\frac{A}{2}\\mathrm{Tr}(Q^2) - \\dots = \\frac{A}{2}(\\frac{3}{2}S^2) - \\dots = \\frac{3A}{4}S^2 + \\mathcal{O}(S^3)$.\n-   The elastic energy density is $f_{\\mathrm{elastic}} = \\frac{L}{2}\\partial_k Q_{ij} \\partial_k Q_{ij}$. Substituting the ansatz for $Q_{ij}$ and retaining only the term involving the gradient of $S$ gives $f_{\\mathrm{elastic}} = \\frac{3L}{4}(\\nabla S)^2 + \\dots$.\n\nIn the defect core, the scalar order parameter $S$ is small, so we can approximate the free energy density by keeping only these dominant quadratic terms:\n$$\nf(S, \\nabla S) \\approx \\frac{3A}{4}S^2 + \\frac{3L}{4}(\\nabla S)^2\n$$\nThe characteristic length scale, or healing length $\\xi$, is the length over which the elastic energy cost for spatial variations becomes comparable to the bulk energy penalty for deviating from the equilibrium order. This balance occurs when the two terms in the approximate free energy are of the same order of magnitude. If we approximate $\\nabla S \\sim S/\\xi$, this balance condition is:\n$$\n\\frac{L}{\\xi^2} S^2 \\sim A S^2 \\implies \\xi^2 \\sim \\frac{L}{A}\n$$\nA formal minimization of the corresponding energy functional via the Euler-Lagrange equation confirms this result. Thus, the characteristic core radius is given by:\n$$\n\\xi = \\sqrt{\\frac{L}{A}}\n$$\n\n### 2. Numerical Calculation\nGiven the material parameters:\n-   $L = 6.0 \\times 10^{-12}$ $\\mathrm{J\\,m^{-1}}$\n-   $A = 1.0 \\times 10^{5}$ $\\mathrm{J\\,m^{-3}}$\n\nThe predicted core radius $\\xi_{\\mathrm{pred}}$ is:\n$$\n\\xi_{\\mathrm{pred}} = \\sqrt{\\frac{6.0 \\times 10^{-12} \\, \\mathrm{J\\,m^{-1}}}{1.0 \\times 10^{5} \\, \\mathrm{J\\,m^{-3}}}} = \\sqrt{6.0 \\times 10^{-17} \\, \\mathrm{m^2}} = \\sqrt{60 \\times 10^{-18}} \\, \\mathrm{m} \\approx 7.746 \\, \\mathrm{nm}\n$$\nRounding to three significant figures, $\\xi_{\\mathrm{pred}} \\approx 7.75$ nm.\n\n### 3. Ratio Calculation\nGiven the observed core radius $\\xi_{\\mathrm{obs}} = 8.0$ nm, the ratio $R$ is:\n$$\nR = \\frac{\\xi_{\\mathrm{pred}}}{\\xi_{\\mathrm{obs}}} = \\frac{7.745966... \\, \\mathrm{nm}}{8.0 \\, \\mathrm{nm}} \\approx 0.9682458...\n$$\nRounding to three significant figures gives:\n$$\nR \\approx 0.968\n$$",
            "answer": "$$ \\boxed{ \\pmatrix{ 7.75 & 0.968 } } $$"
        },
        {
            "introduction": "The most fundamental property of a topological defect is its integer or half-integer charge, which quantifies the winding of the director field around the defect core. While simple to define in a continuous field, measuring this charge from discrete experimental or simulation data is a non-trivial task, complicated by noise and the inherent symmetry of nematics where the director $\\mathbf{n}$ is equivalent to $-\\mathbf{n}$. This exercise challenges you to implement a robust algorithm that leverages the complex nematic order parameter to compute the topological charge in a way that is invariant to these ambiguities. ",
            "id": "4110590",
            "problem": "You are given a sequence of unit director vectors $\\{\\mathbf{n}_i\\}_{i=0}^{N-1}$ sampled along an ordered, closed contour in two-dimensional (2D) space. The director field in nematic liquid crystals is headless, meaning that $\\mathbf{n}$ and $-\\mathbf{n}$ represent the same physical state. The disclination charge is the winding number of the director orientation around the contour, defined as the net change of the director angle divided by $\\pi$ along the loop. Your task is to design and implement a robust algorithm to compute the disclination charge from a discretized director field in a way that is invariant under the identification $\\theta \\to \\theta + \\pi$ that arises from the headless nature of the director.\n\nFundamental base to be used:\n- The director field is represented by unit vectors $\\mathbf{n}_i = (\\cos\\theta_i, \\sin\\theta_i)$, where $\\theta_i$ is a representative angle of the director defined modulo $\\pi$.\n- The topological charge is the winding number of the director angle along the contour, computed from the discrete angular increments, and must be invariant under the equivalence $\\theta \\sim \\theta + \\pi$.\n\nConstraints and requirements:\n- Your algorithm must compute the winding number in a manner that is invariant under the transformation $\\theta \\to \\theta + \\pi$, which corresponds to flipping $\\mathbf{n}_i \\to -\\mathbf{n}_i$.\n- Your algorithm must be robust to small angular noise and random flips of the director sign.\n- Angles must be handled in radians.\n- The contour is closed and the index ordering $\\{0,1,\\dots,N-1\\}$ is consistent with increasing arclength; you must include the increment from the last sample back to the first to close the loop.\n- You must produce the final disclination charge as a real number for each test case using the stated fundamental base.\n\nTest suite:\nFor each test case, construct the director samples as follows. Let $\\alpha_i$ be the polar angle parameter along the loop, with $\\alpha_i$ uniformly spaced in $[0,2\\pi)$ for $i = 0,1,\\dots,N-1$. Define an underlying director angle model\n$$\n\\theta_i^{\\star} = \\theta_0 + \\frac{s^\\star}{2}\\,\\alpha_i + \\eta_i,\n$$\nwhere $s^\\star$ is the target disclination charge, $\\theta_0$ is a constant offset, and $\\eta_i$ are independent, zero-mean Gaussian noise samples with standard deviation $\\sigma$. The director samples are then\n$$\n\\mathbf{n}_i = \\sigma_i\\big(\\cos\\theta_i^{\\star}, \\sin\\theta_i^{\\star}\\big),\n$$\nwhere $\\sigma_i \\in \\{+1,-1\\}$ represents independent random flips with $\\mathbb{P}(\\sigma_i=-1)=p_{\\mathrm{flip}}$ to model the headless nature of the director. Using this construction, implement your algorithm to compute the disclination charge for each test case.\n\nUse the following parameter sets as the test suite:\n- Case 1: $N=128$, $s^\\star=0.5$, $\\theta_0=0.1$, $\\sigma=0.02$, $p_{\\mathrm{flip}}=0.3$.\n- Case 2: $N=64$, $s^\\star=1.0$, $\\theta_0=-0.5$, $\\sigma=0.0$, $p_{\\mathrm{flip}}=0.0$.\n- Case 3: $N=96$, $s^\\star=-0.5$, $\\theta_0=0.0$, $\\sigma=0.01$, $p_{\\mathrm{flip}}=0.5$.\n- Case 4: $N=200$, $s^\\star=0.0$, $\\theta_0=1.2$, $\\sigma=0.05$, $p_{\\mathrm{flip}}=0.7$.\n- Case 5: $N=3$, $s^\\star=-1.0$, $\\theta_0=0.0$, $\\sigma=0.0$, $p_{\\mathrm{flip}}=0.0$.\n\nAngle units must be radians. For each case, compute and return the disclination charge as a float rounded to six decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, for example, \"[result1,result2,result3,result4,result5]\". Each result must be a float rounded to six decimal places, and no extra text or lines should be printed.",
            "solution": "The problem requires the computation of the disclination charge, a topological invariant, from a discrete set of director vectors along a closed loop in a two-dimensional nematic system. The defining characteristic of a nematic director field, $\\mathbf{n}$, is its headless nature, meaning the states represented by $\\mathbf{n}$ and $-\\mathbf{n}$ are physically indistinguishable. This corresponds to an angular equivalence $\\theta \\sim \\theta + \\pi$, where $\\theta$ is the director's orientation angle. The disclination charge, $s$, is defined as the total winding of the director angle around the contour, normalized by $\\pi$:\n$$\ns = \\frac{1}{\\pi} \\oint d\\theta\n$$\nA naive approach of computing angles $\\theta_i$ from each vector $\\mathbf{n}_i$ and summing the differences $\\Delta\\theta_i = \\theta_{i+1} - \\theta_i$ would fail. This is due to two ambiguities. First, the standard inverse tangent function, $\\operatorname{atan2}$, yields angles in $(-\\pi, \\pi]$, leading to spurious $2\\pi$ jumps. Second, the random and unknown sign of each director vector $\\mathbf{n}_i$ can introduce artificial $\\pi$ jumps in the sequence of angles. A robust algorithm must be invariant to these factors.\n\nThe principled approach to ensure invariance under the transformation $\\mathbf{n} \\to -\\mathbf{n}$ is to work with a quantity that is quadratic in the director components. The nematic order parameter, or $Q$-tensor, provides such a representation. In two dimensions, this can be simplified to a complex number, $q$, whose components are constructed from the director vector $\\mathbf{n}_i = (n_{ix}, n_{iy})$:\n$$\nq_i = (n_{ix}^2 - n_{iy}^2) + i (2n_{ix}n_{iy})\n$$\nIf the director is represented by a unit vector $\\mathbf{n}_i = (\\cos\\theta_i, \\sin\\theta_i)$, where $\\theta_i$ is the angle of the vector in the plane, then the complex number $q_i$ becomes:\n$$\nq_i = (\\cos^2\\theta_i - \\sin^2\\theta_i) + i(2\\cos\\theta_i\\sin\\theta_i) = \\cos(2\\theta_i) + i\\sin(2\\theta_i) = e^{i2\\theta_i}\n$$\nThe angle of this complex number is $2\\theta_i$. Crucially, this representation is invariant under the director flip $\\mathbf{n}_i \\to -\\mathbf{n}_i$. A flip corresponds to changing the angle $\\theta_i \\to \\theta_i + \\pi$. The new complex number $q'_i$ would be:\n$$\nq'_i = e^{i2(\\theta_i + \\pi)} = e^{i2\\theta_i}e^{i2\\pi} = e^{i2\\theta_i} = q_i\n$$\nThus, by transforming the sequence of director vectors $\\{\\mathbf{n}_i\\}$ into a sequence of complex numbers $\\{q_i\\}$, we have eliminated the ambiguity arising from the headless nature of the director. The effect of random sign flips and noise is handled implicitly.\n\nThe problem of computing the disclination charge $s$ is now transformed into finding the total winding of the doubled angle, $2\\theta$. The total change in $2\\theta$ around the loop is $\\Delta\\Phi_{\\text{total}} = \\oint d(2\\theta)$. The relationship between the charge $s$ and this total change is:\n$$\ns = \\frac{1}{\\pi} \\oint d\\theta = \\frac{1}{2\\pi} \\oint d(2\\theta) = \\frac{\\Delta\\Phi_{\\text{total}}}{2\\pi}\n$$\nFor the discrete set of samples $\\{q_i\\}_{i=0}^{N-1}$ on the closed contour, the integral can be approximated by a sum of finite increments:\n$$\n\\Delta\\Phi_{\\text{total}} \\approx \\sum_{i=0}^{N-1} \\Delta\\Phi_i\n$$\nwhere $\\Delta\\Phi_i$ is the angle change between $q_i$ and the next sample $q_{i+1}$ (with the loop closed by taking $q_N=q_0$). To avoid the phase wrapping issue, this increment is calculated robustly as the argument of the ratio of the complex numbers:\n$$\n\\Delta\\Phi_i = \\arg\\left(\\frac{q_{i+1}}{q_i}\\right) = \\arg(q_{i+1}\\bar{q}_i)\n$$\nwhere $\\bar{q}_i$ is the complex conjugate of $q_i$. Since $|q_i|=1$ for all $i$, this simplifies the division. The argument, typically computed via $\\operatorname{atan2}(\\text{Im}(z), \\text{Re}(z))$, naturally yields a value in the range $(-\\pi, \\pi]$. This procedure correctly measures the shortest angle between consecutive $q$ vectors, and is robust as long as the true change in $2\\theta$ between samples does not exceed $\\pi$ in magnitude, a condition which holds for the sampling density provided in all test cases.\n\nThe final algorithm is as follows:\n1.  For each test case, generate the sequence of director vectors $\\{\\mathbf{n}_i\\}_{i=0}^{N-1}$ according to the specified model, including noise and random sign flips.\n2.  For each vector $\\mathbf{n}_i = (n_{ix}, n_{iy})$, compute the corresponding complex representation $q_i = (n_{ix}^2 - n_{iy}^2) + i(2n_{ix}n_{iy})$.\n3.  Compute the incremental changes in the doubled angle, $\\Delta\\Phi_i = \\arg(q_{i+1}\\bar{q}_i)$, for $i=0, \\dots, N-1$, where $q_N=q_0$.\n4.  Sum these increments to find the total change: $\\Delta\\Phi_{\\text{total}} = \\sum_{i=0}^{N-1} \\Delta\\Phi_i$.\n5.  Calculate the disclination charge using the formula $s = \\frac{\\Delta\\Phi_{\\text{total}}}{2\\pi}$.\n6.  Round the final value to six decimal places as required.\nA single random number generator seed is used to ensure the stochastic generation of test data is reproducible.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_charge_for_case(N, s_star, theta_0, sigma, p_flip, rng):\n    \"\"\"\n    Generates director field data for a test case and computes the disclination charge.\n\n    Args:\n        N (int): Number of samples on the contour.\n        s_star (float): The target disclination charge.\n        theta_0 (float): A constant angle offset.\n        sigma (float): Standard deviation of Gaussian noise on the angle.\n        p_flip (float): Probability of a director sign flip.\n        rng (numpy.random.Generator): Random number generator instance.\n\n    Returns:\n        float: The computed disclination charge.\n    \"\"\"\n    # 1. Generate director field data\n    # Generate polar angles uniformly spaced around a circle.\n    alpha = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    \n    # Generate Gaussian noise for the director angle.\n    eta = rng.normal(loc=0.0, scale=sigma, size=N)\n    \n    # Create the underlying smooth director angle field.\n    theta_star = theta_0 + (s_star / 2.0) * alpha + eta\n    \n    # Introduce random sign flips to simulate the headless director nature.\n    flips = rng.choice([-1, 1], size=N, p=[p_flip, 1 - p_flip])\n    \n    # Construct the director vectors.\n    nx = flips * np.cos(theta_star)\n    ny = flips * np.sin(theta_star)\n    \n    # 2. Compute the complex tensor order parameter q = exp(i*2*theta)\n    # This representation is invariant under n -> -n.\n    # Re(q) = nx^2 - ny^2 = cos(2*theta)\n    # Im(q) = 2*nx*ny   = sin(2*theta)\n    q = (nx**2 - ny**2) + 1j * (2 * nx * ny)\n\n    # 3. Calculate phase differences between adjacent q-vectors\n    # Use np.roll to get the next element in the sequence, closing the loop.\n    q_next = np.roll(q, -1)\n    \n    # The ratio q_next/q gives the rotation. Since |q|=1, this is q_next * conj(q).\n    delta_q = q_next * np.conj(q)\n    \n    # np.angle() computes the argument, which is the change in the doubled angle (2*theta),\n    # correctly wrapped to the interval (-pi, pi].\n    delta_phi = np.angle(delta_q)\n    \n    # 4. Sum the phase differences and calculate the charge\n    # The total phase change of 2*theta is the sum of increments.\n    total_delta_phi = np.sum(delta_phi)\n    \n    # The disclination charge s = (total change in theta) / pi\n    # which is equivalent to (total change in 2*theta) / (2*pi).\n    charge = total_delta_phi / (2.0 * np.pi)\n    \n    return charge\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # A fixed seed ensures that the noise and flips are the same for each run,\n    # leading to a reproducible result. The problem does not specify a seed,\n    # so a standard value of 0 is chosen.\n    rng = np.random.default_rng(0) \n\n    test_cases = [\n        # (N, s_star, theta_0, sigma, p_flip)\n        (128, 0.5, 0.1, 0.02, 0.3),\n        (64, 1.0, -0.5, 0.0, 0.0),\n        (96, -0.5, 0.0, 0.01, 0.5),\n        (200, 0.0, 1.2, 0.05, 0.7),\n        (3, -1.0, 0.0, 0.0, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, s_star, theta_0, sigma, p_flip = case\n        charge = compute_charge_for_case(N, s_star, theta_0, sigma, p_flip, rng)\n        # Round the final result to six decimal places as required.\n        results.append(round(charge, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While analytical estimates provide valuable insight, understanding the detailed structure of a defect requires solving the full governing equations of the system. This comprehensive practice bridges the gap between theory and computational modeling by tasking you with implementing a numerical solver to find the equilibrium configuration of a defect. Starting from the Landau–de Gennes free energy, you will derive the Euler–Lagrange equations and use a gradient descent method to simulate the relaxation of the $Q$-tensor field, ultimately revealing the intricate scalar and orientational profile of the defect. ",
            "id": "4110587",
            "problem": "Consider the Landau–de Gennes theory of nematic liquid crystals. The nematic state is characterized by the symmetric, traceless, rank-two order parameter tensor $Q_{ij}(\\mathbf{x})$, and the Landau–de Gennes free energy functional is\n$$\nF[Q] = \\int_{\\Omega} \\left( A\\,\\mathrm{Tr}\\,Q^2 - B\\,\\mathrm{Tr}\\,Q^3 + C\\,(\\mathrm{Tr}\\,Q^2)^2 + L\\,\\partial_k Q_{ij}\\,\\partial_k Q_{ij} \\right)\\, dV,\n$$\nwhere $A$, $B$, $C$, and $L$ are material parameters, $\\partial_k Q_{ij}$ denotes spatial derivatives, and $\\Omega \\subset \\mathbb{R}^2$ is a two-dimensional domain. Assume a one-elastic-constant approximation (a single elastic constant $L$) and neglect any hydrodynamic flow.\n\nTask 1. Starting from the functional $F[Q]$, and using the calculus of variations in the space of symmetric, traceless tensors, derive the Euler–Lagrange equations for $Q_{ij}(\\mathbf{x})$. Your derivation must begin from the fundamental definition of stationarity $\\delta F = 0$ under compactly supported variations $\\delta Q_{ij}$, enforce the symmetry and traceless constraints, and show the form of the bulk “molecular field” that must vanish in stationary equilibrium. Do not use shortcut formulas; derive the result by varying each term using standard tensor calculus identities such as $\\delta\\,\\mathrm{Tr}\\,Q^2 = 2\\,Q_{ij}\\,\\delta Q_{ij}$, and carefully treat the gradient term by integration by parts under appropriate boundary conditions.\n\nTask 2. Restrict to two-dimensional, planar textures where $Q_{ij}$ is a $2\\times 2$ symmetric traceless tensor and parameterize the field by a scalar order parameter $S(\\mathbf{x}) \\ge 0$ and a director angle $\\theta(\\mathbf{x})$ using $Q_{ij} = S\\left(n_i n_j - \\delta_{ij}/2\\right)$ with $\\mathbf{n}=(\\cos\\theta,\\sin\\theta)$. Derive the reduced free energy density in terms of $S$ and $\\theta$, and deduce the coupled Euler–Lagrange equations for $S(\\mathbf{x})$ and $\\theta(\\mathbf{x})$. Then, for a point defect of topological charge $s$ at the origin, assume $\\theta(\\mathbf{x}) = s\\,\\phi$ in polar coordinates $(r,\\phi)$ and $S = S(r)$. Derive the ordinary differential equation for $S(r)$ and the physically motivated boundary conditions that ensure a finite core and recovery to the bulk value $S_0$ far from the defect. Use angles in radians. Work in nondimensional units with lengths measured in grid units.\n\nTask 3. Implement a numerical solver that computes stationary defect solutions in two dimensions for the symmetric, traceless $2\\times 2$ tensor $Q(\\mathbf{x})$ by direct $L^2$-gradient descent on the full Landau–de Gennes functional in two dimensions, without explicitly reducing to the scalar order parameter equation. Use a square grid with spacing equal to $1$ (nondimensional grid units), initialize a defect with charge $s$ at the domain center with a smooth core profile, and fix the boundary values to maintain the imposed defect topology. Discretize the molecular field and the Laplacian using second-order central differences with homogeneous Neumann boundary treatment by edge replication. Iterate explicit gradient descent until a stationary state is reached.\n\nDefine the scalar order parameter field as $S(\\mathbf{x}) = 2\\,\\sqrt{q_{11}^2(\\mathbf{x}) + q_{12}^2(\\mathbf{x})}$, where $Q(\\mathbf{x}) = \\begin{pmatrix} q_{11} & q_{12} \\\\ q_{12} & -q_{11} \\end{pmatrix}$. Define the bulk scalar order $S_0$ as the nonzero uniform stationary solution obtained from the bulk part of the functional in two dimensions. Define the core radius $r_c$ as the smallest radius $r$ (in grid units) for which the azimuthal average of $S$ on the circle of radius $r$ about the defect center is greater than or equal to $S_0/2$.\n\nYour program must:\n- Use nondimensional parameters and angles in radians.\n- Solve the full $Q$-tensor gradient descent on a square grid with fixed boundary values and compute $r_c$ via annular averaging.\n- Produce numerical answers as floating-point numbers.\n\nTest Suite. Run your solver for the following four parameter sets $(A,B,C,L,s,N,\\text{iterations},\\Delta t)$, where $N$ is the grid size, “iterations” is the number of gradient descent steps, and $\\Delta t$ is the explicit time step:\n1. $(-1.0, 0.0, 1.0, 0.02, 0.5, 64, 800, 0.05)$\n2. $(-1.0, 0.0, 1.0, 0.02, -0.5, 64, 800, 0.05)$\n3. $(-1.0, 0.0, 1.0, 0.02, 0.0, 64, 800, 0.05)$\n4. $(-1.0, 0.0, 1.0, 0.05, 0.5, 64, 800, 0.05)$\n\nFinal Output Format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each core radius rounded to three decimal places in nondimensional grid units, in the order listed above (for example, “[0.750,0.745,0.000,1.120]”).",
            "solution": "The problem is well-posed and scientifically grounded in the established Landau–de Gennes theory of nematic liquid crystals. It presents a complete set of tasks for deriving the governing equations and implementing a numerical solution for topological defects. The parameters and definitions provided are standard and sufficient for a unique and meaningful solution.\n\n### Task 1: Derivation of the Euler–Lagrange Equations\n\nThe Landau–de Gennes free energy functional is given by:\n$$\nF[Q] = \\int_{\\Omega} f(Q_{ij}, \\partial_k Q_{ij}) \\, dV\n$$\nwhere the free energy density $f$ is:\n$$\nf = A\\,\\mathrm{Tr}(Q^2) - B\\,\\mathrm{Tr}(Q^3) + C\\,(\\mathrm{Tr}(Q^2))^2 + L\\,(\\partial_k Q_{ij})(\\partial_k Q_{ij})\n$$\nHere, $Q_{ij}$ is a symmetric ($Q_{ij} = Q_{ji}$) and traceless ($\\mathrm{Tr}(Q) = Q_{kk} = 0$) tensor. We seek the stationary equilibrium state by finding the condition $\\delta F = 0$ for an arbitrary, compactly supported variation $\\delta Q_{ij}$ that respects the same symmetry and tracelessness constraints ($\\delta Q_{ij} = \\delta Q_{ji}$ and $\\delta Q_{kk} = 0$).\n\nThe variation of the functional is $\\delta F = \\int_{\\Omega} \\delta f \\, dV$. We compute the variation of each term in the density $f$:\n\n1.  **First term**:\n    $\\delta(A\\,\\mathrm{Tr}(Q^2)) = A\\,\\delta(Q_{ij}Q_{ji}) = A\\,(\\delta Q_{ij} Q_{ji} + Q_{ij} \\delta Q_{ji})$. Using an index switch on the second part ($j \\to i, i \\to j$) and the symmetry of $Q$ and $\\delta Q$, this becomes $A\\,(Q_{ji}\\delta Q_{ij} + Q_{ji}\\delta Q_{ij}) = 2A\\,Q_{ji}\\delta Q_{ij} = 2A\\,Q_{ij}\\delta Q_{ij}$.\n\n2.  **Second term**:\n    $\\delta(-B\\,\\mathrm{Tr}(Q^3)) = -B\\,\\delta(Q_{ij}Q_{jk}Q_{ki})$. Applying the product rule gives three identical terms: $-B\\,(\\delta Q_{ij} Q_{jk} Q_{ki} + Q_{ij} \\delta Q_{jk} Q_{ki} + Q_{ij} Q_{jk} \\delta Q_{ki})$. By relabeling indices, all three can be written in the form $-(Q^2)_{li}\\delta Q_{il}$. The sum is $-3B\\,(Q^2)_{ji}\\delta Q_{ij} = -3B\\,(Q^2)_{ij}\\delta Q_{ij}$.\n\n3.  **Third term**:\n    $\\delta(C\\,(\\mathrm{Tr}(Q^2))^2) = C \\cdot 2\\,\\mathrm{Tr}(Q^2) \\cdot \\delta(\\mathrm{Tr}(Q^2))$. We already found $\\delta(\\mathrm{Tr}(Q^2)) = 2\\,Q_{ij}\\delta Q_{ij}$. Thus, this term's variation is $4C\\,\\mathrm{Tr}(Q^2)\\,Q_{ij}\\delta Q_{ij}$.\n\n4.  **Fourth term (Elastic term)**:\n    $\\delta(L\\,\\partial_k Q_{ij} \\partial_k Q_{ij}) = 2L\\,(\\partial_k Q_{ij}) \\delta(\\partial_k Q_{ij}) = 2L\\,(\\partial_k Q_{ij}) \\partial_k(\\delta Q_{ij})$. To remove the derivative from the variation $\\delta Q_{ij}$, we integrate by parts over the volume:\n    $$\n    \\int_{\\Omega} 2L\\,(\\partial_k Q_{ij}) \\partial_k(\\delta Q_{ij}) \\, dV = \\int_{\\Omega} \\partial_k(2L\\,(\\partial_k Q_{ij}) \\delta Q_{ij}) \\, dV - \\int_{\\Omega} 2L\\,(\\partial_k \\partial_k Q_{ij}) \\delta Q_{ij} \\, dV\n    $$\n    By the divergence theorem, the first term is a surface integral over $\\partial\\Omega$. Since $\\delta Q_{ij}$ has compact support (or vanishes on the boundary), this surface term is zero. The remaining term is $-\\int_{\\Omega} 2L\\,\\nabla^2 Q_{ij} \\delta Q_{ij} \\, dV$.\n\nCombining all terms, the total variation is:\n$$\n\\delta F = \\int_{\\Omega} \\left( [2AQ_{ij} - 3B(Q^2)_{ij} + 4C\\,\\mathrm{Tr}(Q^2)\\,Q_{ij}] - 2L\\nabla^2 Q_{ij} \\right) \\delta Q_{ij} \\, dV = 0\n$$\nFor this integral to be zero for any admissible variation $\\delta Q_{ij}$, the tensor expression multiplying $\\delta Q_{ij}$ must be of a form that its contraction with any symmetric traceless tensor is zero. This implies the expression itself must be a symmetric tensor of the form $\\lambda \\delta_{ij}$ for some scalar Lagrange multiplier field $\\lambda(\\mathbf{x})$ that enforces the traceless constraint. The expression is already symmetric, so we have:\n$$\n2AQ_{ij} - 3B(Q^2)_{ij} + 4C\\,\\mathrm{Tr}(Q^2)\\,Q_{ij} - 2L\\nabla^2 Q_{ij} = \\lambda\\delta_{ij}\n$$\nTo find $\\lambda$, we take the trace of both sides. In $d$ dimensions, $\\mathrm{Tr}(\\delta_{ij}) = d$.\n$$\n2A\\,\\mathrm{Tr}(Q) - 3B\\,\\mathrm{Tr}(Q^2) + 4C\\,\\mathrm{Tr}(Q^2)\\,\\mathrm{Tr}(Q) - 2L\\nabla^2(\\mathrm{Tr}(Q)) = \\lambda d\n$$\nUsing the constraint $\\mathrm{Tr}(Q) = 0$, this simplifies to $-3B\\,\\mathrm{Tr}(Q^2) = \\lambda d$, which gives $\\lambda = -\\frac{3B}{d}\\mathrm{Tr}(Q^2)$.\n\nThe Euler-Lagrange equation is obtained by substituting $\\lambda$ back. It is conventionally expressed by defining the **molecular field** $H_{ij} = -\\frac{\\delta F_{\\text{bulk}}}{\\delta Q_{ij}}$, which is the variational derivative of the bulk (non-gradient) part of the free energy:\n$$\nH_{ij} = -\\left( 2AQ_{ij} - 3B(Q^2)_{ij} + 4C\\,\\mathrm{Tr}(Q^2)\\,Q_{ij} \\right)\n$$\nThe full equilibrium equation is then $H_{ij} - (\\mathrm{Tr}(H)/d)\\delta_{ij} - 2L\\nabla^2 Q_{ij} = 0$, which simplifies to:\n$$\n2L\\nabla^2 Q_{ij} = -\\left( 2AQ_{ij} - 3B\\left((Q^2)_{ij} - \\frac{1}{d}\\mathrm{Tr}(Q^2)\\delta_{ij}\\right) + 4C\\,\\mathrm{Tr}(Q^2)\\,Q_{ij} \\right)\n$$\nThe tensor expression that must vanish for stationary equilibrium is the full symmetric traceless molecular field, including the elastic part:\n$$\n\\mathcal{H}_{ij} = \\left( 2AQ_{ij} - 3B(Q^2)_{ij}^{ST} + 4C\\,\\mathrm{Tr}(Q^2)Q_{ij} - 2L\\nabla^2 Q_{ij} \\right)^{ST} = 0\n$$\nwhere the superscript 'ST' denotes the symmetric traceless part of a tensor, i.e., $T^{ST}_{ij} = \\frac{1}{2}(T_{ij}+T_{ji}) - \\frac{1}{d}T_{kk}\\delta_{ij}$.\n\n### Task 2: Reduced Theory for 2D Planar Defects\n\nIn two dimensions ($d=2$), a symmetric traceless tensor $Q$ can be parameterized by a scalar order parameter $S(\\mathbf{x}) \\ge 0$ and a director angle $\\theta(\\mathbf{x})$:\n$$\nQ_{ij} = S \\left( n_i n_j - \\frac{1}{2}\\delta_{ij} \\right) \\quad \\text{with } \\mathbf{n} = (\\cos\\theta, \\sin\\theta)\n$$\nThe matrix form is $Q = \\frac{S}{2} \\begin{pmatrix} \\cos(2\\theta) & \\sin(2\\theta) \\\\ \\sin(2\\theta) & -\\cos(2\\theta) \\end{pmatrix} = \\begin{pmatrix} q_{11} & q_{12} \\\\ q_{12} & -q_{11} \\end{pmatrix}$. This gives the relations $q_{11} = \\frac{S}{2}\\cos(2\\theta)$ and $q_{12} = \\frac{S}{2}\\sin(2\\theta)$.\nThe invariants are:\n$\\mathrm{Tr}(Q^2) = Q_{ij}Q_{ji} = 2(q_{11}^2 + q_{12}^2) = 2 \\left( (\\frac{S}{2})^2 \\cos^2(2\\theta) + (\\frac{S}{2})^2 \\sin^2(2\\theta) \\right) = \\frac{S^2}{2}$.\n$\\mathrm{Tr}(Q^3) = \\det(Q)\\mathrm{Tr}(Q) = 0$ in 2D. The term with coefficient $B$ vanishes.\n\nThe bulk free energy density reduces to:\n$$\nf_{\\text{bulk}}(S) = A\\left(\\frac{S^2}{2}\\right) + C\\left(\\frac{S^2}{2}\\right)^2 = \\frac{A}{2}S^2 + \\frac{C}{4}S^4\n$$\nThe elastic energy density is $f_{\\text{el}} = L \\partial_k Q_{ij} \\partial_k Q_{ij} = L \\sum_{i,j,k} (\\partial_k Q_{ij})^2 = 2L \\sum_k ((\\partial_k q_{11})^2 + (\\partial_k q_{12})^2)$.\nCalculating the derivatives:\n$\\partial_k q_{11} = \\frac{1}{2}(\\partial_k S \\cos(2\\theta) - 2S \\sin(2\\theta) \\partial_k \\theta)$\n$\\partial_k q_{12} = \\frac{1}{2}(\\partial_k S \\sin(2\\theta) + 2S \\cos(2\\theta) \\partial_k \\theta)$\nSumming their squares simplifies to: $(\\partial_k q_{11})^2 + (\\partial_k q_{12})^2 = \\frac{1}{4}((\\partial_k S)^2 + 4S^2(\\partial_k\\theta)^2)$.\nThe elastic density becomes: $f_{\\text{el}} = 2L \\sum_k \\frac{1}{4}((\\partial_k S)^2 + 4S^2(\\partial_k\\theta)^2) = \\frac{L}{2}(|\\nabla S|^2 + 4S^2|\\nabla\\theta|^2)$.\n\nThe total reduced free energy density is $f(S, \\theta) = \\frac{A}{2}S^2 + \\frac{C}{4}S^4 + \\frac{L}{2}|\\nabla S|^2 + 2LS^2|\\nabla\\theta|^2$.\nThe Euler-Lagrange equations for $S$ and $\\theta$ are:\nFor $S$: $\\frac{\\partial f}{\\partial S} - \\nabla \\cdot \\frac{\\partial f}{\\partial(\\nabla S)} = 0 \\implies AS + CS^3 + 4LS|\\nabla\\theta|^2 - L\\nabla^2 S = 0$.\nFor $\\theta$: $\\frac{\\partial f}{\\partial \\theta} - \\nabla \\cdot \\frac{\\partial f}{\\partial(\\nabla \\theta)} = 0 \\implies 0 - \\nabla \\cdot (4LS^2\\nabla\\theta) = 0 \\implies \\nabla \\cdot (S^2\\nabla\\theta) = 0$.\n\nFor a point defect of charge $s$ at the origin, we assume $\\theta(\\mathbf{x}) = s\\phi$ and $S=S(r)$, where $(r,\\phi)$ are polar coordinates.\nIn polar coordinates, $\\nabla S = S'(r)\\hat{\\mathbf{r}}$ and $\\nabla\\theta = s\\nabla\\phi = s \\frac{1}{r}\\hat{\\boldsymbol{\\phi}}$ and $\\nabla^2 S = S'' + \\frac{1}{r}S'$.\nThe equation for $\\theta$ is satisfied automatically as $\\nabla \\cdot (S(r)^2 \\frac{s}{r}\\hat{\\boldsymbol{\\phi}}) = \\frac{s}{r} \\frac{\\partial}{\\partial\\phi} (\\frac{S(r)^2}{r}) = 0$.\nSubstituting into the equation for $S$ gives the ODE for the radial profile $S(r)$:\n$$\nL\\left(S'' + \\frac{1}{r}S'\\right) = AS + CS^3 + 4LS^2 \\frac{s^2}{r^2} \\implies L\\left(S'' + \\frac{1}{r}S'\\right) - \\frac{4Ls^2S}{r^2} = AS + CS^3\n$$\nThe boundary conditions are:\n1.  **Core:** $S(r \\to 0) = 0$. The order parameter must vanish at the defect core where the director is undefined, to ensure the elastic energy remains finite.\n2.  **Far field:** $S(r \\to \\infty) = S_0 = \\sqrt{-A/C}$. Far from the defect, the system must relax to the uniform bulk equilibrium state, which minimizes $f_{\\text{bulk}}(S)$.\n\n### Task 3: Numerical Implementation Design\n\nThe solver will implement an $L^2$-gradient descent scheme to minimize the full Landau-de Gennes functional on a 2D grid. This corresponds to solving the time-dependent equation $\\partial Q_{ij}/\\partial t = -\\delta F / \\delta Q_{ij}$, where $-\\delta F / \\delta Q_{ij}$ acts as the \"force\" driving the system to a lower energy state. For the given functional in 2D with $B=0$, the evolution equation simplifies significantly. As shown in Task 1, the Lagrange multiplier term vanishes identically. The equation for the two independent components of $Q$ becomes:\n$$\n\\frac{\\partial q_{11}}{\\partial t} = -\\left(2Aq_{11} + 4C(\\mathrm{Tr}Q^2)q_{11}\\right) + 2L\\nabla^2 q_{11}\n$$\n$$\n\\frac{\\partial q_{12}}{\\partial t} = -\\left(2Aq_{12} + 4C(\\mathrm{Tr}Q^2)q_{12}\\right) + 2L\\nabla^2 q_{12}\n$$\nwhere $\\mathrm{Tr}(Q^2) = 2(q_{11}^2 + q_{12}^2)$.\n\n-   **Discretization:** The simulation domain is an $N \\times N$ grid with spacing $\\Delta x = \\Delta y = 1.0$. The Laplacian operator $\\nabla^2$ is approximated using a second-order five-point central difference stencil.\n-   **Initial State:** The grid is initialized with a defect of charge $s$ at the center. The angle field is set to $\\theta(x,y) = s \\cdot \\arctan_2(y,x)$. The scalar order parameter is given a smooth profile $S(r) = S_0 \\tanh(r/r_{\\text{init}})$ that vanishes at the center and saturates to the bulk value $S_0$ far away, with $r_{\\text{init}}$ being an initial guess for the core size.\n-   **Boundary Conditions:** To maintain the overall topological charge, the values of $Q_{ij}$ on the boundary of the grid are fixed to their initial values (Dirichlet boundary condition). The gradient descent updates are applied only to the interior grid points. The Laplacian for points adjacent to the boundary naturally incorporates the fixed boundary values.\n-   **Time Integration:** A simple explicit Euler forward method is used: $Q^{t+\\Delta t} = Q^t + \\Delta t \\cdot (\\partial Q/\\partial t)|_t$.\n-   **Core Radius Measurement:** After the relaxation process converges, the final scalar order parameter field $S(\\mathbf{x}) = 2\\sqrt{q_{11}^2 + q_{12}^2}$ is calculated. The core radius $r_c$ is determined by computing the azimuthal average of $S$ in concentric annuli. This is achieved by binning grid points by their integer distance from the center, calculating the average $S$ in each bin, and finding the smallest radius $r$ for which this average is $\\ge S_0/2$. For the $s=0$ case, the system relaxes to a uniform state with $S=S_0$, so the core radius is trivially $0$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for defect relaxation and print results.\n    \"\"\"\n    \n    test_cases = [\n        # (A, B, C, L, s, N, iterations, dt)\n        (-1.0, 0.0, 1.0, 0.02, 0.5, 64, 800, 0.05),\n        (-1.0, 0.0, 1.0, 0.02, -0.5, 64, 800, 0.05),\n        (-1.0, 0.0, 1.0, 0.02, 0.0, 64, 800, 0.05),\n        (-1.0, 0.0, 1.0, 0.05, 0.5, 64, 800, 0.05),\n    ]\n\n    results = []\n    for params in test_cases:\n        rc = solve_defect_relaxation(*params)\n        results.append(f\"{rc:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef solve_defect_relaxation(A, B, C, L, s, N, iterations, dt):\n    \"\"\"\n    Computes the core radius of a nematic defect by relaxing the Q-tensor field\n    using L2-gradient descent on the Landau-de Gennes free energy.\n\n    Args:\n        A, B, C, L: Material parameters in the Landau-de Gennes functional.\n        s: Topological charge of the defect.\n        N: Grid size (N x N).\n        iterations: Number of gradient descent steps.\n        dt: Time step for the explicit Euler method.\n\n    Returns:\n        The calculated defect core radius in grid units.\n    \"\"\"\n    # Grid setup (grid spacing h=1 is assumed)\n    grid_coords = np.arange(N, dtype=float) - (N - 1) / 2.0\n    xx, yy = np.meshgrid(grid_coords, grid_coords)\n    \n    # Calculate bulk order parameter S0\n    if C = 0 or -A / C  0:\n        S0 = 0.0\n    else:\n        S0 = np.sqrt(-A / C)\n\n    # Initial condition: defect of charge 's' at the center\n    # Polar coordinates\n    rr = np.sqrt(xx**2 + yy**2)\n    phi = np.arctan2(yy, xx)\n\n    # Defect angle profile\n    theta = s * phi\n    \n    # Smooth core profile using tanh function\n    # A reasonable initial core size prevents extreme gradients at the start.\n    r_init = 5.0\n    S_init = S0 * np.tanh(rr / r_init)\n    \n    # Initialize Q-tensor components q11 and q12\n    # Q = [[q11, q12], [q12, -q11]]\n    q11 = (S_init / 2.0) * np.cos(2 * theta)\n    q12 = (S_init / 2.0) * np.sin(2 * theta)\n    \n    # Time evolution via L2-gradient descent\n    for _ in range(iterations):\n        # Calculate Tr(Q^2) = 2 * (q11^2 + q12^2)\n        TrQ2 = 2 * (q11**2 + q12**2)\n        \n        # dQ/dt = -(dF/dQ_bulk) + 2L*nabla^2(Q)\n        # For B=0, dF/dQ_bulk = 2AQ + 4C(TrQ^2)Q\n        h_bulk_11 = -(2 * A * q11 + 4 * C * TrQ2 * q11)\n        h_bulk_12 = -(2 * A * q12 + 4 * C * TrQ2 * q12)\n        \n        # Calculate Laplacian using second-order central differences (h=1)\n        # Fixed boundary conditions mean we only compute and update on interior.\n        lap_q11 = np.zeros_like(q11)\n        lap_q12 = np.zeros_like(q12)\n        \n        lap_q11[1:-1, 1:-1] = (q11[0:-2, 1:-1] + q11[2:, 1:-1] + \n                               q11[1:-1, 0:-2] + q11[1:-1, 2:] - 4 * q11[1:-1, 1:-1])\n        lap_q12[1:-1, 1:-1] = (q12[0:-2, 1:-1] + q12[2:, 1:-1] + \n                               q12[1:-1, 0:-2] + q12[1:-1, 2:] - 4 * q12[1:-1, 1:-1])\n\n        # Explicit Euler time step for interior points\n        q11[1:-1, 1:-1] += dt * (h_bulk_11[1:-1, 1:-1] + 2 * L * lap_q11[1:-1, 1:-1])\n        q12[1:-1, 1:-1] += dt * (h_bulk_12[1:-1, 1:-1] + 2 * L * lap_q12[1:-1, 1:-1])\n\n    # Post-simulation analysis\n    # For s=0, the system relaxes to a uniform state. The \"core\" has zero size.\n    if s == 0:\n        return 0.0\n        \n    # Calculate final scalar order parameter field S(x, y) = 2 * sqrt(q11^2 + q12^2)\n    S_final = 2 * np.sqrt(q11**2 + q12**2)\n    \n    # Calculate core radius r_c\n    S_thresh = S0 / 2.0\n    \n    # Bin S values by their integer radius from the center\n    r_int = np.floor(rr).astype(int)\n    max_r = np.max(r_int)\n    \n    # Flatten arrays for use with np.bincount\n    r_flat = r_int.flatten()\n    S_flat = S_final.flatten()\n    \n    # Calculate sum and count in each radial bin for averaging\n    sum_S_by_r = np.bincount(r_flat, weights=S_flat, minlength=max_r + 1)\n    counts = np.bincount(r_flat, minlength=max_r + 1)\n    \n    # Calculate the azimuthal average S for each integer radius\n    avg_S_by_r = np.zeros(max_r + 1, dtype=float)\n    # Avoid division by zero for bins that may not contain any grid points\n    nonzero_counts = counts > 0\n    avg_S_by_r[nonzero_counts] = sum_S_by_r[nonzero_counts] / counts[nonzero_counts]\n    \n    # Find the smallest radius where the average S meets the threshold S0/2\n    passing_radii_indices = np.where(avg_S_by_r >= S_thresh)[0]\n    \n    if len(passing_radii_indices) == 0:\n        # Fallback if no radius meets threshold (e.g., core > domain size)\n        return float(max_r)\n        \n    core_radius = float(passing_radii_indices[0])\n    \n    return core_radius\n\nsolve()\n```"
        }
    ]
}