{
    "hands_on_practices": [
        {
            "introduction": "本次实践将我们的理解建立在单个带电粒子在磁场中基本行为的基础上。从磁矩 $\\mu$ 和能量 $E$ 守恒的第一性原理出发，你将揭示磁场强度的变化如何形成“磁镜”，从而捕获一部分等离子体粒子。这项练习将指导你推导捕获粒子份额的经典公式，然后通过计算应用该公式，比较托卡马克和仿星器独特的几何构型如何影响这一对等离子体输运和约束至关重要的粒子群。",
            "id": "4004617",
            "problem": "您的任务是，基于第一性原理，利用磁通面上单根闭合磁力线上的最大磁场强度 $B_{\\max}$ 与最小磁场强度 $B_{\\min}$ 之比，推导并计算磁约束等离子体中的俘获粒子份额 $f_t$。您将比较两种磁约束位形族：一种是圆形截面、轴对称的托卡马克，另一种是带有螺旋纹波的仿星器。推导和计算必须基于基本原理以及关于 $B(\\theta)$ 的合理的、自洽的几何模型，其中 $\\theta$ 是参数化磁力线上位置的角向角。\n\n使用的基本原理：\n- 在缓变场中，对于充分磁化的粒子，磁矩 $\\mu = \\frac{m v_\\perp^2}{2B}$ 守恒；在没有碰撞的情况下，总动能 $E = \\frac{m(v_\\perp^2 + v_\\parallel^2)}{2}$ 守恒。\n- 速度空间分布是各向同性的，意味着粒子方向在单位球面上均匀分布。\n- 关联 $B_{\\min}$ 处的螺距角与 $B_{\\max}$ 处反射的磁镜条件。\n\n圆形同心磁通面上沿磁力线的磁场大小的几何模型：\n- 由环向曲率引起的类托卡马克变化：\n  $$B_{\\mathrm{tok}}(\\theta) = B_0 \\, \\frac{R_0}{R_0 + r \\cos\\theta},$$\n  其中 $B_0$ 是轴上磁场，单位为 $\\mathrm{T}$；$R_0$ 是大半径，单位为 $\\mathrm{m}$；$r$ 是小半径，单位为 $\\mathrm{m}$；$\\theta \\in [0, 2\\pi)$ 是角向角，单位为弧度。\n- 在类托卡马克变化上叠加额外螺旋纹波的类仿星器变化：\n  $$B_{\\mathrm{stel}}(\\theta) = B_0 \\, \\frac{R_0}{R_0 + r \\cos\\theta} \\, \\left(1 + \\delta \\cos(N \\theta)\\right),$$\n  其中 $\\delta$ 是无量纲的纹波幅度，$N$ 是整数场周期数。选择 $\\delta$ 以确保对所有 $\\theta$ 都有 $1 + \\delta \\cos(N \\theta) > 0$，从而保持 $B(\\theta)$ 的物理正值性。\n\n您的任务：\n1. 仅从磁矩守恒、动能守恒以及速度空间各向同性分布的定义出发，推导俘获粒子份额 $f_t$ 的闭式表达式，该表达式用磁镜比 $R = B_{\\max}/B_{\\min}$ 表示，其中 $B_{\\max}$ 和 $B_{\\min}$ 是沿磁力线 $B(\\theta)$ 的最大值和最小值。\n2. 实现一个程序，该程序：\n   - 在 $[0, 2\\pi)$ 范围内以弧度为单位均匀采样 $\\theta$，以近似计算 $B_{\\max}$ 和 $B_{\\min}$。\n   - 为每种位形情况计算 $R = B_{\\max}/B_{\\min}$。\n   - 使用您在任务1中推导的表达式来计算 $f_t$。\n   - 将所有测试用例的结果汇总到一行输出中，格式如下文所述。\n\n科学真实性和单位：\n- 这些模型是近似的，但被广泛使用且在科学上是合理的，适用于第一性原理的比较。磁场 $B$ 的单位是 $\\mathrm{T}$，长度 $R_0$ 和 $r$ 的单位是 $\\mathrm{m}$，角度 $\\theta$ 的单位是弧度。俘获份额 $f_t$ 是无量纲的。\n- 确保对于所有采样的 $\\theta$，$B(\\theta) > 0$。\n\n采样要求：\n- 对于每个测试用例，在 $[0, 2\\pi)$ 区间内使用 $N_\\theta = 2000$ 个均匀间隔的 $\\theta$ 样本。\n\n测试套件：\n为以下参数集提供计算，这些参数集涵盖了典型行为、边界极限和几何权衡：\n- 情况1（托卡马克，一般情况）：\n  - $B_0 = 5.0$ $\\mathrm{T}$，$R_0 = 3.0$ $\\mathrm{m}$，$r = 0.3$ $\\mathrm{m}$。\n- 情况2（托卡马克，近均匀 B 场，边界情况）：\n  - $B_0 = 5.0$ $\\mathrm{T}$，$R_0 = 3.0$ $\\mathrm{m}$，$r = 0.001$ $\\mathrm{m}$。\n- 情况3（仿星器，中等纹波，曲率和纹波极值点可能未对齐）：\n  - $B_0 = 5.0$ $\\mathrm{T}$，$R_0 = 3.0$ $\\mathrm{m}$，$r = 0.3$ $\\mathrm{m}$，$\\delta = 0.06$，$N = 5$。\n- 情况4（仿星器，更强纹波，多个磁阱）：\n  - $B_0 = 5.0$ $\\mathrm{T}$，$R_0 = 3.0$ $\\mathrm{m}$，$r = 0.2$ $\\mathrm{m}$，$\\delta = 0.25$，$N = 10$。\n\n答案类型和输出规范：\n- 对于每种情况，程序必须计算一个等于俘获粒子份额 $f_t$ 的浮点数。\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[f_1,f_2,f_3,f_4]$），值的顺序与上述情况的顺序相同。",
            "solution": "问题陈述经核实具有科学依据、适定且客观。它基于等离子体物理学的既定原理，并为一项可解的计算任务提供了一套完整且一致的参数。其推导和后续计算是磁约束聚变研究中的标准程序。因此，我们可以开始求解。\n\n主要任务是推导俘获粒子份额 $f_t$ 的表达式，然后针对几种磁场位形进行计算。推导将基于所提供的第一性原理：粒子磁矩 $\\mu$ 的守恒和其总动能 $E$ 的守恒。\n\n让我们从在磁场 $B$ 中运动的单个质量为 $m$、电荷为 $q$ 的粒子的守恒量定义开始：\n磁矩由 $\\mu = \\frac{m v_{\\perp}^2}{2 B}$ 给出，其中 $v_{\\perp}$ 是粒子速度垂直于磁场矢量的分量。\n动能为 $E = \\frac{1}{2} m v^2 = \\frac{1}{2} m (v_{\\perp}^2 + v_{\\parallel}^2)$，其中 $v_{\\parallel}$ 是平行于磁场的速度分量，$v$ 是总速率。\n\n在静磁场中，$E$ 是守恒的，这意味着粒子的总速率 $v$ 是恒定的。磁矩 $\\mu$ 是一个绝热不变量，只要磁场在空间和时间上的变化相对于粒子的回旋运动是缓慢的，它就守恒。我们假设这些条件成立。\n\n从 $\\mu$ 和 $E$ 的守恒，我们可以建立粒子俘获的条件。$\\mu$ 的恒定性意味着 $\\frac{v_{\\perp}^2}{B}$ 沿着粒子轨迹是一个常数。让我们用螺距角 $\\alpha$ 来表示它，定义为 $v_{\\perp} = v \\sin \\alpha$ 和 $v_{\\parallel} = v \\cos \\alpha$。将此代入不变量中得到：\n$$ \\frac{v^2 \\sin^2 \\alpha}{B} = \\text{constant} $$\n由于 $v$ 也是恒定的，我们有以下关系：\n$$ \\frac{\\sin^2 \\alpha}{B} = \\text{constant} $$\n\n如果一个粒子沿磁力线的运动被磁镜效应反转，那么它就被认为是“俘获”的。这发生在一个“转折点”，在此处平行速度 $v_{\\parallel}$ 变为零。在这样的点，总动能完全是垂直动能，因此 $v_{\\perp} = v$，这意味着螺距角 $\\alpha = \\pi/2$，于是 $\\sin^2 \\alpha = 1$。设 $B_{\\text{turn}}$ 为此转折点的磁场强度。\n\n让我们在磁力线上的两个位置评估不变量 $\\frac{\\sin^2 \\alpha}{B}$：转折点和磁场达到其最小值 $B_{\\min}$ 的点。在 $B_{\\min}$ 的位置，设螺距角为 $\\alpha_{\\min}$。令这两个点的不变量相等，可得：\n$$ \\frac{\\sin^2 \\alpha_{\\min}}{B_{\\min}} = \\frac{1}{B_{\\text{turn}}} $$\n这使我们能够确定在低场点具有螺距角 $\\alpha_{\\min}$ 的粒子将在何种磁场强度下被反射：\n$$ B_{\\text{turn}} = \\frac{B_{\\min}}{\\sin^2 \\alpha_{\\min}} $$\n\n如果一个粒子的转折点发生在场强 $B_{\\text{turn}} \\le B_{\\max}$ 处，那么它就被俘获在 $B_{\\min}$ 和 $B_{\\max}$ 之间的磁阱中。这导出了关于初始螺距角 $\\alpha_{\\min}$ 的俘获条件：\n$$ \\frac{B_{\\min}}{\\sin^2 \\alpha_{\\min}} \\le B_{\\max} $$\n整理这个不等式，得到基本的俘获条件：\n$$ \\sin^2 \\alpha_{\\min} \\ge \\frac{B_{\\min}}{B_{\\max}} $$\n\n接下来，我们计算满足此条件的粒子份额。问题陈述中指出，速度空间分布是各向同性的，这意味着粒子速度矢量在所有立体角上均匀分布。因此，俘获粒子份额 $f_t$ 是对应于速度空间中俘获区域的立体角与球体的总立体角 $4\\pi$ 的比值。\n\n在球速度坐标系中，立体角元为 $d\\Omega = \\sin\\alpha \\, d\\alpha \\, d\\phi$。我们对满足俘获条件的螺距角区域进行积分。设磁镜比为 $R = B_{\\max}/B_{\\min}$。条件是 $\\sin^2 \\alpha_{\\min} \\ge 1/R$。我们定义一个临界角 $\\alpha_c \\in [0, \\pi/2]$，使得 $\\sin \\alpha_c = 1/\\sqrt{R}$。俘获条件变为 $|\\sin \\alpha_{\\min}| \\ge \\sin \\alpha_c$。由于 $\\alpha_{\\min}$ 的范围是 $0$ 到 $\\pi$，这对应于区间 $\\alpha_{\\min} \\in [\\alpha_c, \\pi - \\alpha_c]$。这个速度空间区域是环绕赤道的一个“带”，而“通行”粒子则占据两极的锥形区域（损失锥）。\n\n俘获粒子的立体角是：\n$$ \\Omega_{\\text{trapped}} = \\int_0^{2\\pi} d\\phi \\int_{\\alpha_c}^{\\pi-\\alpha_c} \\sin \\alpha_{\\min} \\, d\\alpha_{\\min} $$\n$$ \\Omega_{\\text{trapped}} = 2\\pi \\left[ -\\cos \\alpha_{\\min} \\right]_{\\alpha_c}^{\\pi-\\alpha_c} = 2\\pi (-\\cos(\\pi - \\alpha_c) - (-\\cos \\alpha_c)) $$\n$$ \\Omega_{\\text{trapped}} = 2\\pi (\\cos \\alpha_c + \\cos \\alpha_c) = 4\\pi \\cos \\alpha_c $$\n\n俘获粒子份额是该立体角与总立体角 $4\\pi$ 的比值：\n$$ f_t = \\frac{\\Omega_{\\text{trapped}}}{\\Omega_{\\text{total}}} = \\frac{4\\pi \\cos \\alpha_c}{4\\pi} = \\cos \\alpha_c $$\n使用恒等式 $\\cos^2 \\alpha_c + \\sin^2 \\alpha_c = 1$，并且知道 $\\alpha_c$ 在第一象限，我们有 $\\cos \\alpha_c = \\sqrt{1 - \\sin^2 \\alpha_c}$。代入 $\\sin \\alpha_c = 1/\\sqrt{R}$：\n$$ f_t = \\sqrt{1 - \\frac{1}{R}} $$\n最后，代入 $R = B_{\\max}/B_{\\min}$，我们得到所需的闭式表达式：\n$$ f_t = \\sqrt{1 - \\frac{B_{\\min}}{B_{\\max}}} $$\n\n对于任务的计算部分，我们将实现这个结果。沿磁力线的磁场强度 $B(\\theta)$ 针对两种位形给出。对于托卡马克：\n$$ B_{\\mathrm{tok}}(\\theta) = B_0 \\, \\frac{R_0}{R_0 + r \\cos\\theta} $$\n对于仿星器，增加了螺旋纹波：\n$$ B_{\\mathrm{stel}}(\\theta) = B_0 \\, \\frac{R_0}{R_0 + r \\cos\\theta} \\, \\left(1 + \\delta \\cos(N \\theta)\\right) $$\n其中参数为轴上磁场 $B_0$、大半径 $R_0$、小半径 $r$、纹波幅度 $\\delta$ 和场周期数 $N$。\n\n对于每个测试用例，步骤如下：\n1.  在区间 $[0, 2\\pi)$ 内用 $N_\\theta = 2000$ 个均匀分布的点对角向角 $\\theta$ 进行采样。\n2.  使用适当的公式和参数在每个采样点上评估 $B(\\theta)$。\n3.  通过在 $B(\\theta)$ 值数组中找到最大值和最小值来数值确定 $B_{\\max}$ 和 $B_{\\min}$。\n4.  计算磁镜比 $R = B_{\\max} / B_{\\min}$。\n5.  计算俘获份额 $f_t = \\sqrt{1 - 1/R}$。\n\n此方法将应用于四个指定的测试用例，以评估几何形状（环径比 $r/R_0$）和螺旋纹波对粒子约束的影响。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes the trapped-particle fraction f_t for various magnetic\n    confinement configurations.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Format: (B0, R0, r, delta, N)\n    # delta=None and N=None indicates a tokamak configuration.\n    test_cases = [\n        # Case 1 (tokamak, general case)\n        (5.0, 3.0, 0.3, None, None),\n        # Case 2 (tokamak, near-uniform B, boundary case)\n        (5.0, 3.0, 0.001, None, None),\n        # Case 3 (stellarator, moderate ripple)\n        (5.0, 3.0, 0.3, 0.06, 5),\n        # Case 4 (stellarator, stronger ripple, multiple wells)\n        (5.0, 3.0, 0.2, 0.25, 10),\n    ]\n\n    # Sampling requirement\n    N_theta = 2000\n    theta = np.linspace(0, 2 * np.pi, N_theta, endpoint=False)\n\n    results = []\n    \n    for case in test_cases:\n        B0, R0, r, delta, N = case\n\n        # Calculate the magnetic field magnitude B(theta) along the field line.\n        # This is the toroidal curvature term common to both models.\n        B_toroidal_part = B0 * (R0 / (R0 + r * np.cos(theta)))\n\n        if delta is None and N is None:\n            # Tokamak configuration\n            B_field = B_toroidal_part\n        else:\n            # Stellarator configuration with helical ripple\n            # The condition 1 + delta * cos(N*theta) > 0 is met by the problem parameters.\n            ripple_part = 1 + delta * np.cos(N * theta)\n            B_field = B_toroidal_part * ripple_part\n\n        # Find the maximum and minimum magnetic field strengths.\n        B_max = np.max(B_field)\n        B_min = np.min(B_field)\n\n        # Ensure B_max is not zero to avoid division by zero.\n        # This is physically guaranteed as B0 > 0.\n        if B_max > 0:\n            # Calculate the mirror ratio R.\n            # R is guaranteed to be >= 1 by definition of B_max and B_min.\n            mirror_ratio = B_max / B_min\n\n            # Calculate the trapped-particle fraction f_t using the derived formula.\n            # The argument of the square root is 1 - 1/R, which is >= 0.\n            f_t = np.sqrt(1 - 1 / mirror_ratio)\n        else: # This case should not be reached with the given test data\n            f_t = 0.0\n\n        results.append(f_t)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从单粒子动力学转向等离子体的集体行为，本次实践探讨了磁流体动力学（MHD）稳定性，这是维持良好约束等离子体的关键因素。由安全因子剖面 $q(r)$ 表征的磁场拓扑结构，决定了磁力线闭合的共振有理面的位置，而这些位置是不稳定模式可能生长的地方。这项练习让你通过定位这些磁面并计算不同 $q$ 剖面下的局部磁剪切，深入探究了这种关系，从而让你对反剪切等构型选择如何改变对撕裂模的敏感性有一个定量的、实践性的理解。",
            "id": "4004674",
            "problem": "在磁约束聚变中，安全因子 $q(r)$ 标记了共振磁面或有理磁面，在这些磁面上，磁力线在经过整数圈的极向和环向穿越后闭合，由 $q = m/n$ 指定，其中 $m$ 和 $n$ 为整数。这些有理磁面的分布和局域磁剪切影响了对电阻磁流体力学（MHD）撕裂不稳定性的易感性。为简化起见，在大环径比的圆形几何中，我们将磁剪切定义为无量纲量 $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$，它衡量了 $q$ 的径向变化与其大小的相对关系。\n\n考虑两种轴对称位形，其小半径为 $a = 1$，由各自的安全因子剖面表示：\n- 位形 $\\mathrm{T}$ (常规托卡马克): $q_{\\mathrm{T}}(r) = q_{0,\\mathrm{T}} + \\alpha_{\\mathrm{T}} \\left(\\frac{r}{a}\\right)^{2}$，其中 $q_{0,\\mathrm{T}} = 0.9$ 且 $\\alpha_{\\mathrm{T}} = 2.5$。\n- 位形 $\\mathrm{R}$ (反剪切托卡马克): $q_{\\mathrm{R}}(r) = 1.8 + 1.6 \\left[\\left(\\frac{r}{a}\\right)^{2} - 0.4\\right]^{2}$。\n\n根据安全因子的定义和给定的剖面进行计算：\n1. 在每种位形中，确定满足 $q(r_{m/n}) = m/n$ 的径向位置 $r_{m/n}$，其中有理数集合为 $\\{2/1,\\,3/2,\\,4/3,\\,5/3,\\,7/3\\}$。只保留位于 $0 \\le r \\le a$ 范围内的位置。\n2. 使用从给定 $q(r)$ 导出的 $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$，在每个共振面上计算磁剪切 $s(r_{m/n})$。\n3. 使用一个撕裂不稳定性易感性的简单代理，将 $S$ 定义为所考虑的共振面上绝对剪切倒数之和，即 $S \\equiv \\sum_{m/n} \\frac{1}{|s(r_{m/n})|}$，并计算两种位形的 $S_{\\mathrm{T}}$ 和 $S_{\\mathrm{R}}$。\n4. 报告比值 $\\mathcal{R} \\equiv \\frac{S_{\\mathrm{T}}}{S_{\\mathrm{R}}}$。\n\n将最终比值 $\\mathcal{R}$ 表示为一个无量纲数。将您的答案四舍五入到四位有效数字。",
            "solution": "用户在计算聚变科学领域提供了一个提法明确且有科学依据的问题，有必要给出一个严谨的、分步的解答。该问题将通过分别分析每个磁位形来解决，以确定指定有理磁面的位置以及这些位置的磁剪切。然后，这些值将用于计算每种情况下撕裂模不稳定性的代理，并最终计算它们的比值。所有计算都将使用给定的参数和定义进行。小半径给定为 $a=1$，这通过归一化所有径向坐标简化了表达式。\n\n首先，我们分析位形 $\\mathrm{T}$（常规托卡马克）。其安全因子剖面由下式给出：\n$$q_{\\mathrm{T}}(r) = q_{0,\\mathrm{T}} + \\alpha_{\\mathrm{T}} \\left(\\frac{r}{a}\\right)^{2}$$\n当 $q_{0,\\mathrm{T}} = 0.9$、$\\alpha_{\\mathrm{T}} = 2.5$ 且 $a=1$ 时，剖面为：\n$$q_{\\mathrm{T}}(r) = 0.9 + 2.5 r^{2}$$\n对于 $r \\in [0, 1]$，$q_{\\mathrm{T}}(r)$ 的范围是从 $q_{\\mathrm{T}}(0) = 0.9$ 到 $q_{\\mathrm{T}}(1) = 0.9 + 2.5 = 3.4$。指定集合 $\\{2/1, 3/2, 4/3, 5/3, 7/3\\}$ 中的所有有理数值都落在此范围内，因此每个值都存在一个相应的共振面。这些值分别为 $2$、$1.5$、约 $1.333$、约 $1.667$ 和约 $2.333$。\n\n磁剪切 $s(r)$ 定义为 $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$。对于位形 $\\mathrm{T}$，q剖面的导数是：\n$$\\frac{dq_{\\mathrm{T}}}{dr} = \\frac{d}{dr}(0.9 + 2.5 r^{2}) = 5r$$\n那么剪切为：\n$$s_{\\mathrm{T}}(r) = \\frac{r}{q_{\\mathrm{T}}(r)} (5r) = \\frac{5r^{2}}{q_{\\mathrm{T}}(r)}$$\n在一个共振面 $r_{m/n}$ 上，我们有 $q_{\\mathrm{T}}(r_{m/n}) = m/n$。我们可以从q剖面中表示出 $r^2$：$2.5r^2 = q_{\\mathrm{T}}(r) - 0.9$，所以 $5r^2 = 2(q_{\\mathrm{T}}(r) - 0.9)$。将此代入剪切表达式中，得到一个仅依赖于 $q$ 值的简化形式：\n$$s_{\\mathrm{T}}(r_{m/n}) = \\frac{2(q_{\\mathrm{T}}(r_{m/n}) - 0.9)}{q_{\\mathrm{T}}(r_{m/n})} = 2\\left(1 - \\frac{0.9}{m/n}\\right)$$\n现在我们为每个有理面计算剪切 $s_{\\mathrm{T}}$：\n- 对于 $q = 2/1 = 2$：$s_{\\mathrm{T}} = 2(1 - \\frac{0.9}{2}) = 2(0.55) = 1.1$。\n- 对于 $q = 3/2 = 1.5$：$s_{\\mathrm{T}} = 2(1 - \\frac{0.9}{1.5}) = 2(1 - 0.6) = 0.8$。\n- 对于 $q = 4/3$：$s_{\\mathrm{T}} = 2(1 - \\frac{0.9}{4/3}) = 2(1 - \\frac{2.7}{4}) = 2(1 - 0.675) = 0.65$。\n- 对于 $q = 5/3$：$s_{\\mathrm{T}} = 2(1 - \\frac{0.9}{5/3}) = 2(1 - \\frac{2.7}{5}) = 2(1 - 0.54) = 0.92$。\n- 对于 $q = 7/3$：$s_{\\mathrm{T}} = 2(1 - \\frac{0.9}{7/3}) = 2(1 - \\frac{2.7}{7}) = 2(\\frac{4.3}{7}) = \\frac{8.6}{7}$。\n所有剪切值均为正，所以 $|s_{\\mathrm{T}}| = s_{\\mathrm{T}}$。易感性代理 $S_{\\mathrm{T}}$ 是剪切倒数值之和：\n$$S_{\\mathrm{T}} = \\sum_{m/n} \\frac{1}{|s_{\\mathrm{T}}(r_{m/n})|} = \\frac{1}{1.1} + \\frac{1}{0.8} + \\frac{1}{0.65} + \\frac{1}{0.92} + \\frac{7}{8.6}$$\n$$S_{\\mathrm{T}} \\approx 0.909091 + 1.25 + 1.538462 + 1.086957 + 0.813953 \\approx 5.598463$$\n\n接下来，我们分析位形 $\\mathrm{R}$（反剪切托卡马克）。其安全因子剖面为：\n$$q_{\\mathrm{R}}(r) = 1.8 + 1.6 \\left[\\left(\\frac{r}{a}\\right)^{2} - 0.4\\right]^{2} = 1.8 + 1.6(r^2 - 0.4)^2$$\n该剖面是非单调的。$q_{\\mathrm{R}}$ 的最小值出现在 $(r^2 - 0.4)^2 = 0$ 时，即 $r = \\sqrt{0.4}$。最小值为 $q_{min} = 1.8$。磁轴处的值为 $q_{\\mathrm{R}}(0) = 1.8 + 1.6(-0.4)^2 = 1.8 + 0.256 = 2.056$。边界处的值为 $q_{\\mathrm{R}}(1) = 1.8 + 1.6(1-0.4)^2 = 1.8 + 0.576 = 2.376$。对于 $r \\in [0,1]$，$q_{\\mathrm{R}}$ 的范围是 $[1.8, 2.376]$。\n我们检查给定的有理数中哪些落在此范围内：\n- $q = 2$：是，$1.8 \\le 2 \\le 2.376$。\n- $q = 1.5$：否。\n- $q = 4/3 \\approx 1.333$：否。\n- $q = 5/3 \\approx 1.667$：否。\n- $q = 7/3 \\approx 2.333$：是，$1.8 \\le 7/3 \\le 2.376$。\n因此，该位形中仅存在 $q=2$ 和 $q=7/3$ 的磁面。\n\n我们通过求解 $q_{\\mathrm{R}}(r) = m/n$ 来找到径向位置 $r_{m/n}$：\n$$(r^2 - 0.4)^2 = \\frac{(m/n) - 1.8}{1.6} \\implies r^2 = 0.4 \\pm \\sqrt{\\frac{(m/n) - 1.8}{1.6}}$$\n对于 $q = 2$：\n$$r^2 = 0.4 \\pm \\sqrt{\\frac{2 - 1.8}{1.6}} = 0.4 \\pm \\sqrt{0.125} = 0.4 \\pm \\frac{1}{2\\sqrt{2}} = 0.4 \\pm \\frac{\\sqrt{2}}{4}$$\n这给出了 $r^2$ 的两个解，它们都为正且小于1，因此存在两个磁面：$r^2_{2/1,1} \\approx 0.04645$ 和 $r^2_{2/1,2} \\approx 0.75355$。\n对于 $q = 7/3$：\n$$r^2 = 0.4 \\pm \\sqrt{\\frac{7/3 - 1.8}{1.6}} = 0.4 \\pm \\sqrt{\\frac{8/15}{8/5}} = 0.4 \\pm \\sqrt{1/3}$$\n解 $r^2 = 0.4 - 1/\\sqrt{3}$ 是负数，因此不具有物理意义。另一个解 $r^2_{7/3} = 0.4 + 1/\\sqrt{3} \\approx 0.97735$ 是有效的。因此，对于 $q=7/3$ 有一个磁面。\n\n$q_{\\mathrm{R}}(r)$ 的导数是：\n$$\\frac{dq_{\\mathrm{R}}}{dr} = 1.6 \\cdot 2(r^2 - 0.4) \\cdot 2r = 6.4r(r^2 - 0.4)$$\n剪切为：\n$$s_{\\mathrm{R}}(r) = \\frac{r}{q_{\\mathrm{R}}(r)} \\frac{dq_{\\mathrm{R}}}{dr} = \\frac{6.4r^2(r^2-0.4)}{q_{\\mathrm{R}}(r)}$$\n我们计算这三个已确定的磁面上的剪切：\n- 对于 $q=2$，磁面1：$r^2 = 0.4 - \\frac{\\sqrt{2}}{4}$。所以 $r^2-0.4 = -\\frac{\\sqrt{2}}{4}$。\n$$s_{2/1,1} = \\frac{6.4(0.4 - \\frac{\\sqrt{2}}{4})(-\\frac{\\sqrt{2}}{4})}{2} = 3.2(0.4 - \\frac{\\sqrt{2}}{4})(-\\frac{\\sqrt{2}}{4}) = 0.4 - 0.32\\sqrt{2} \\approx -0.052548$$\n- 对于 $q=2$，磁面2：$r^2 = 0.4 + \\frac{\\sqrt{2}}{4}$。所以 $r^2-0.4 = +\\frac{\\sqrt{2}}{4}$。\n$$s_{2/1,2} = \\frac{6.4(0.4 + \\frac{\\sqrt{2}}{4})(\\frac{\\sqrt{2}}{4})}{2} = 3.2(0.4 + \\frac{\\sqrt{2}}{4})(\\frac{\\sqrt{2}}{4}) = 0.4 + 0.32\\sqrt{2} \\approx 0.852548$$\n- 对于 $q=7/3$：$r^2 = 0.4 + 1/\\sqrt{3}$。所以 $r^2-0.4 = 1/\\sqrt{3}$。\n$$s_{7/3} = \\frac{6.4(0.4 + 1/\\sqrt{3})(1/\\sqrt{3})}{7/3} = \\frac{19.2}{7}\\left(\\frac{0.4}{\\sqrt{3}} + \\frac{1}{3}\\right) = \\frac{6.4}{35}(2\\sqrt{3}+5) \\approx 1.547436$$\n易感性代理 $S_{\\mathrm{R}}$ 是绝对剪切倒数值之和：\n$$S_{\\mathrm{R}} = \\frac{1}{|-0.052548|} + \\frac{1}{|0.852548|} + \\frac{1}{|1.547436|}$$\n$$S_{\\mathrm{R}} \\approx 19.02999 + 1.17295 + 0.64622 \\approx 20.84916$$\n\n最后，我们计算比值 $\\mathcal{R} = S_{\\mathrm{T}} / S_{\\mathrm{R}}$：\n$$\\mathcal{R} = \\frac{5.598463}{20.84916} \\approx 0.268522$$\n四舍五入到四位有效数字，我们得到 $\\mathcal{R} = 0.2685$。这一结果表明，在这个简化模型中，反剪切位形（位形 R）对撕裂不稳定性的易感性要大得多，其主要贡献来自于q最小值附近的极低剪切区域。",
            "answer": "$$\\boxed{0.2685}$$"
        },
        {
            "introduction": "最后的实践将我们的视角从核心等离子体物理学提升到聚变反应堆工程的综合挑战。一个可行的磁约束构型不仅要能维持稳定、高温的等离子体，还必须在发电厂严格的材料和系统限制内运行。这项练习通过审视与中子壁负载、热通量管理和氚自持相关的权衡来解决这一问题。通过为托卡马克和仿星器计算所需的包层厚度，你将直接参与定义现代聚变反应堆设计的复杂、多目标的优化过程。",
            "id": "4004673",
            "problem": "一位反应堆工程师正在比较在相同聚变功率下两种磁约束位形中的中子壁负载：一种是具有圆形截面的轴对称托卡马克，另一种是等离子体体积相当但由于其三维几何形状而具有更大第一壁表面积的仿星器。从能量守恒和壁负载（定义为单位面积上的入射中子功率）出发，推导比例关系 $W_{n} \\propto P_{\\text{fus}}/A_{\\text{wall}}$，过程中不使用任何预先推导的简化公式。利用在氘-氚聚变中，中子携带每次反应总聚变能量的一个固定份额 $f_{n}$ 这一事实。清晰地陈述您对中子从等离子体边界发射到第一壁之间的输运过程所做的任何假设。\n\n然后，将两种装置都建模为环体。对于托卡马克，用圆环体的表面积近似其第一壁面积，$A_{\\text{T}} \\approx 4\\pi^{2} R a$，其中 $R$ 是大半径，$a$ 是小半径。对于仿星器，近似为 $A_{\\text{S}} = \\kappa\\,A_{\\text{T}}$，其中 $\\kappa > 1$ 是一个由几何形状引起的面积因子。假设以下参数：\n- 聚变功率 $P_{\\text{fus}} = 2.0 \\times 10^{9}\\ \\text{W}$。\n- 氘-氚聚变的中子能量份额 $f_{n} = 14.1/17.6$。\n- 托卡马克几何参数：$R = 7.0\\ \\text{m}$ 和 $a = 2.0\\ \\text{m}$。\n- 仿星器面积因子：$\\kappa = 1.5$。\n\n假设在增殖包层中使用一个简化的一维衰减模型：包层背板的中子热通量为 $q_{\\text{back}}(t) = W_{n}\\,\\exp(-t/\\lambda)$，其中 $t$ 是包层厚度，$\\lambda$ 是有效衰减长度。在结构界面处施加一个热通量限制 $q_{\\max} = 1.0 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$，并取 $\\lambda = 0.12\\ \\text{m}$。\n\n同时，使用参数响应模型 $ \\text{TBR}(t) = c\\,\\beta\\left(1-\\exp(-t/\\delta)\\right)$ 施加氚增殖比（TBR）约束，其中 $c$ 是包层覆盖率，$\\beta$ 是对于所选材料和倍增材料，在包层极厚情况下的渐近TBR，$\\delta$ 是特征增殖饱和长度。托卡马克使用 $c_{\\text{T}} = 0.90$，仿星器使用 $c_{\\text{S}} = 0.80$，$\\beta = 1.40$，$\\delta = 0.10\\ \\text{m}$，并要求满足 $\\text{TBR}_{\\min} = 1.10$。\n\n任务：\n1. 从第一性原理和定义出发，推导比例关系 $W_{n} \\propto P_{\\text{fus}}/A_{\\text{wall}}$，并在您陈述的假设下，用 $P_{\\text{fus}}$、$f_{n}$ 和 $A_{\\text{wall}}$ 明确表示 $W_{n}$。\n2. 使用给定参数计算每种位形的 $W_{n}$。\n3. 确定每种位形下同时满足热通量限制和氚增殖比要求的最小包层厚度 $t$。在每种位形中，起决定性作用的 $t$ 是两个约束所要求的厚度中的最大值。\n4. 提供最小包层厚度对 $(t_{\\text{T}}, t_{\\text{S}})$（单位为米）作为您的最终答案。将您的数值结果四舍五入至三位有效数字。最终厚度以米（$\\text{m}$）表示。\n\n在您的推导和计算中，请在LaTeX中保留所有数学符号和数字。最终答案必须是包含两个元素的单行矩阵。",
            "solution": "经评估，此问题是有效的，因为它的科学基础是成熟的聚变能原理，其参数完整且一致、提法得当，并且表述客观。它要求进行推导和一系列计算，这些都是概念聚变反应堆分析中的标准内容。\n\n**1. 中子壁负载比例关系的推导**\n\n总聚变功率 $P_{\\text{fus}}$ 代表单位时间内所有聚变反应释放的总能量。对于氘-氚（D-T）反应，会释放特定量的能量 $E_{\\text{fus,reaction}}$。因此，总聚变反应率 $R_{\\text{fus}}$ 由下式给出：\n$$R_{\\text{fus}} = \\frac{P_{\\text{fus}}}{E_{\\text{fus,reaction}}}$$\n在D-T反应中，总能量分配给一个α粒子和一个中子。题目指出，中子携带总能量的一个固定份额 $f_{n}$。单个中子携带的能量为 $E_{n} = f_{n} E_{\\text{fus,reaction}}$。等离子体中产生的所有中子携带的总功率 $P_{n}$ 是反应率乘以每个中子的能量：\n$$P_{n} = R_{\\text{fus}} \\times E_{n} = \\left(\\frac{P_{\\text{fus}}}{E_{\\text{fus,reaction}}}\\right) \\times (f_{n} E_{\\text{fus,reaction}}) = f_{n} P_{\\text{fus}}$$\n中子壁负载 $W_{n}$ 定义为入射到第一壁单位面积上的中子功率，该壁的面积为 $A_{\\text{wall}}$。为了将 $P_{n}$ 与 $W_{n}$ 联系起来，我们对中子输运做如下假设：\n1.  中子从等离子体体积内各向同性地发射。\n2.  中子从其产生点沿直线传播至第一壁，在等离子体体积内或等离子体与壁之间的真空间隙中的衰减或相互作用可忽略不计。\n\n在这些假设下，等离子体内部产生的总中子功率 $P_{n}$ 等于入射到第一壁整个表面上的总中子功率。因此，我们可以将壁负载写为：\n$$W_{n} = \\frac{P_{n}}{A_{\\text{wall}}}$$\n代入 $P_{n}$ 的表达式，我们得到明确的关系式：\n$$W_{n} = \\frac{f_{n} P_{\\text{fus}}}{A_{\\text{wall}}}$$\n由于对于D-T聚变，$f_{n}$ 是一个常数，而 $P_{\\text{fus}}$ 是一个指定的运行参数，此推导按要求显示了比例关系 $W_{n} \\propto P_{\\text{fus}}/A_{\\text{wall}}$。\n\n**2. 计算每种位形的中子壁负载 ($W_{n}$) **\n\n我们得到的参数如下：$P_{\\text{fus}} = 2.0 \\times 10^{9}\\ \\text{W}$ 和 $f_{n} = 14.1/17.6$。\n总中子功率为 $P_{n} = f_{n} P_{\\text{fus}} = (14.1/17.6) \\times (2.0 \\times 10^{9}\\ \\text{W}) \\approx 1.6023 \\times 10^{9}\\ \\text{W}$。\n\n对于托卡马克：\n第一壁面积 $A_{\\text{T}}$ 由大半径 $R = 7.0\\ \\text{m}$ 和小半径 $a = 2.0\\ \\text{m}$ 的圆环体表面积近似。\n$$A_{\\text{T}} = 4\\pi^{2} R a = 4\\pi^{2} (7.0\\ \\text{m})(2.0\\ \\text{m}) = 56\\pi^{2}\\ \\text{m}^{2}$$\n托卡马克的中子壁负载 $W_{n, \\text{T}}$ 为：\n$$W_{n, \\text{T}} = \\frac{f_{n} P_{\\text{fus}}}{A_{\\text{T}}} = \\frac{(14.1/17.6) \\times (2.0 \\times 10^{9}\\ \\text{W})}{56\\pi^{2}\\ \\text{m}^{2}} \\approx 2.900 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$$\n\n对于仿星器：\n第一壁面积 $A_{\\text{S}}$ 由 $A_{\\text{S}} = \\kappa A_{\\text{T}}$ 给出，其中 $\\kappa = 1.5$。\n$$A_{\\text{S}} = 1.5 \\times (56\\pi^{2}\\ \\text{m}^{2}) = 84\\pi^{2}\\ \\text{m}^{2}$$\n仿星器的中子壁负载 $W_{n, \\text{S}}$ 为：\n$$W_{n, \\text{S}} = \\frac{f_{n} P_{\\text{fus}}}{A_{\\text{S}}} = \\frac{f_{n} P_{\\text{fus}}}{\\kappa A_{\\text{T}}} = \\frac{W_{n, \\text{T}}}{\\kappa} = \\frac{2.900 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}}{1.5} \\approx 1.933 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$$\n\n**3. 确定最小包层厚度 ($t$)**\n\n对于每种位形，我们必须找到满足热通量限制和氚增殖比（TBR）要求这两个约束的最小厚度 $t$。起决定作用的厚度是这两个单独的最小厚度中的最大值。\n\n**约束1：热通量限制**\n包层背板的热通量 $q_{\\text{back}}(t)$ 不得超过 $q_{\\max} = 1.0 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$。\n模型为 $q_{\\text{back}}(t) = W_{n}\\exp(-t/\\lambda)$。约束为 $W_{n}\\exp(-t/\\lambda) \\le q_{\\max}$。\n为了找到最小厚度 $t_{q}$，我们求解等式：\n$$W_{n}\\exp(-t_{q}/\\lambda) = q_{\\max} \\implies \\exp(-t_{q}/\\lambda) = \\frac{q_{\\max}}{W_{n}}$$\n$$-t_{q}/\\lambda = \\ln\\left(\\frac{q_{\\max}}{W_{n}}\\right) \\implies t_{q} = -\\lambda \\ln\\left(\\frac{q_{\\max}}{W_{n}}\\right) = \\lambda \\ln\\left(\\frac{W_{n}}{q_{\\max}}\\right)$$\n给定 $\\lambda = 0.12\\ \\text{m}$。\n\n**约束2：氚增殖比（TBR）限制**\nTBR必须至少为 $\\text{TBR}_{\\min} = 1.10$。\n模型为 $\\text{TBR}(t) = c\\,\\beta\\left(1-\\exp(-t/\\delta)\\right)$。约束为 $c\\,\\beta\\left(1-\\exp(-t/\\delta)\\right) \\ge \\text{TBR}_{\\min}$。\n为了找到最小厚度 $t_{\\text{TBR}}$，我们求解等式：\n$$c\\,\\beta\\left(1-\\exp(-t_{\\text{TBR}}/\\delta)\\right) = \\text{TBR}_{\\min} \\implies 1-\\exp(-t_{\\text{TBR}}/\\delta) = \\frac{\\text{TBR}_{\\min}}{c\\beta}$$\n$$\\exp(-t_{\\text{TBR}}/\\delta) = 1 - \\frac{\\text{TBR}_{\\min}}{c\\beta} \\implies t_{\\text{TBR}} = -\\delta \\ln\\left(1 - \\frac{\\text{TBR}_{\\min}}{c\\beta}\\right)$$\n给定 $\\delta = 0.10\\ \\text{m}$ 和 $\\beta = 1.40$。\n\n**托卡马克的计算：**\n使用 $W_{n, \\text{T}} \\approx 2.900 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$ 和 $c_{\\text{T}} = 0.90$。\n-   热通量约束厚度 $t_{q, \\text{T}}$：\n    $$t_{q, \\text{T}} = (0.12\\ \\text{m}) \\ln\\left(\\frac{2.900 \\times 10^{6}}{1.0 \\times 10^{6}}\\right) = (0.12\\ \\text{m}) \\ln(2.900) \\approx 0.1278\\ \\text{m}$$\n-   TBR约束厚度 $t_{\\text{TBR, T}}$：\n    $$c_{\\text{T}}\\beta = 0.90 \\times 1.40 = 1.26$$\n    $$t_{\\text{TBR, T}} = -(0.10\\ \\text{m}) \\ln\\left(1 - \\frac{1.10}{1.26}\\right) \\approx -(0.10\\ \\text{m}) \\ln(1 - 0.8730) = -(0.10\\ \\text{m}) \\ln(0.1270) \\approx 0.2064\\ \\text{m}$$\n托卡马克所需的最小包层厚度 $t_{\\text{T}}$ 是这两个值的最大值：\n$$t_{\\text{T}} = \\max(t_{q, \\text{T}}, t_{\\text{TBR, T}}) = \\max(0.1278\\ \\text{m}, 0.2064\\ \\text{m}) = 0.2064\\ \\text{m}$$\n四舍五入到三位有效数字， $t_{\\text{T}} = 0.206\\ \\text{m}$。\n\n**仿星器的计算：**\n使用 $W_{n, \\text{S}} \\approx 1.933 \\times 10^{6}\\ \\text{W}\\,\\text{m}^{-2}$ 和 $c_{\\text{S}} = 0.80$。\n-   热通量约束厚度 $t_{q, \\text{S}}$：\n    $$t_{q, \\text{S}} = (0.12\\ \\text{m}) \\ln\\left(\\frac{1.933 \\times 10^{6}}{1.0 \\times 10^{6}}\\right) = (0.12\\ \\text{m}) \\ln(1.933) \\approx 0.0791\\ \\text{m}$$\n-   TBR约束厚度 $t_{\\text{TBR, S}}$：\n    $$c_{\\text{S}}\\beta = 0.80 \\times 1.40 = 1.12$$\n    $$t_{\\text{TBR, S}} = -(0.10\\ \\text{m}) \\ln\\left(1 - \\frac{1.10}{1.12}\\right) \\approx -(0.10\\ \\text{m}) \\ln(1 - 0.9821) = -(0.10\\ \\text{m}) \\ln(0.0179) \\approx 0.4025\\ \\text{m}$$\n仿星器所需的最小包层厚度 $t_{\\text{S}}$ 是这两个值的最大值：\n$$t_{\\text{S}} = \\max(t_{q, \\text{S}}, t_{\\text{TBR, S}}) = \\max(0.0791\\ \\text{m}, 0.4025\\ \\text{m}) = 0.4025\\ \\text{m}$$\n四舍五入到三位有效数字， $t_{\\text{S}} = 0.403\\ \\text{m}$。\n\n**4. 最终答案**\n\n最小包层厚度对 $(t_{\\text{T}}, t_{\\text{S}})$，四舍五入到三位有效数字后，为 $(0.206\\ \\text{m}, 0.403\\ \\text{m})$。\n\n对于托卡马克，TBR要求（$t=0.206\\ \\text{m}$）是控制性约束，比热通量限制（$t=0.128\\ \\text{m}$）要求更高。对于仿星器，较低的壁负载显著放宽了热通量约束（$t=0.079\\ \\text{m}$），但较低的包层覆盖率（$c_S = 0.80$ 对比 $c_T = 0.90$）使得TBR要求更难满足，需要厚得多的包层（$t=0.403\\ \\text{m}$）。这说明了在不同磁约束几何位形中，在管理表面热负荷和实现氚自持之间存在一个关键的工程权衡。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.206  & 0.403\n\\end{pmatrix}\n}\n$$"
        }
    ]
}