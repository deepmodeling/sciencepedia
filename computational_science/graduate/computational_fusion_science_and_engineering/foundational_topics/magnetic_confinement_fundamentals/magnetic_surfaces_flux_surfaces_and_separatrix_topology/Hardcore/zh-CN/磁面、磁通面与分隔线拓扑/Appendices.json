{
    "hands_on_practices": [
        {
            "introduction": "在轴对称系统中，磁通面的存在是磁场无散性（$\\nabla \\cdot \\mathbf{B} = 0$）的直接结果。这个练习提供了一个具体的机会来进行逆向操作：从一个给定的磁场出发，我们将构建相应的极向磁通函数 $\\psi(R,Z)$，并验证磁力线确实位于其等值面上。通过这项实践，您将加深对磁场与磁通函数之间基本数学联系的理解。",
            "id": "4007702",
            "problem": "考虑一个轴对称环状等离子体，其柱坐标为 $(R,\\phi,Z)$，磁场为 $\\mathbf{B}(R,Z)$，该磁场与 $\\phi$ 无关且在 $R>0$ 时光滑。磁场分量为\n$$B_{R}(R,Z) \\;=\\; \\frac{2\\,\\kappa\\,Z}{R}, \\qquad B_{\\phi}(R,Z) \\;=\\; \\frac{F_{0}}{R}, \\qquad B_{Z}(R,Z) \\;=\\; \\frac{2\\,\\kappa\\,(R - R_{x})}{R},$$\n其中 $\\kappa>0$、$F_{0}>0$ 和 $R_{x}>0$ 是常数。仅从磁静力学的麦克斯韦方程组和柱坐标下的标准矢量微积分出发，构造一个标量函数 $\\psi(R,Z)$，使其等值集在轴对称情况下是磁面；也就是说，$\\psi$ 是一个磁通函数，满足 $\\mathbf{B}\\cdot\\nabla\\psi = 0$。然后在柱坐标下显式计算 $\\mathbf{B}\\cdot\\nabla\\psi$ 以验证其正交性。将最终答案表示为单个数值。最终值无需四舍五入，也无需单位。假设所有场都足够光滑并适当衰减，以确保积分是良定义的。",
            "solution": "该问题要求为给定的轴对称磁场 $\\mathbf{B}$ 构造一个磁通函数 $\\psi(R,Z)$，并随后验证该磁场与此函数的梯度正交。\n\n这个问题的基本原理源于磁静力学的麦克斯韦方程组，特别是磁场的无散条件：\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\n对于轴对称场，$\\frac{\\partial}{\\partial \\phi} = 0$，因此条件 $\\nabla \\cdot \\mathbf{B} = 0$ 仅涉及极向分量 $\\mathbf{B}_p = B_R\\hat{\\mathbf{R}} + B_Z\\hat{\\mathbf{Z}}$，并简化为：\n$$ \\frac{1}{R}\\frac{\\partial}{\\partial R}(R B_R) + \\frac{\\partial B_Z}{\\partial Z} = 0 $$\n\n我们可以定义一个标量函数 $\\psi(R,Z)$（称为极向磁通函数），使得极向场分量可以由它如下导出：\n$$ B_R = \\frac{1}{R} \\frac{\\partial \\psi}{\\partial Z}, \\qquad B_Z = -\\frac{1}{R} \\frac{\\partial \\psi}{\\partial R} $$\n此定义自动满足了轴对称场下的无散条件。这是因为，将 $\\psi$ 的定义代入无散条件的方程，我们得到：\n$$ \\frac{1}{R}\\frac{\\partial}{\\partial R}\\left(R \\cdot \\frac{1}{R}\\frac{\\partial\\psi}{\\partial Z}\\right) + \\frac{\\partial}{\\partial Z}\\left(-\\frac{1}{R}\\frac{\\partial\\psi}{\\partial R}\\right) = \\frac{1}{R}\\frac{\\partial^2\\psi}{\\partial R \\partial Z} - \\frac{1}{R}\\frac{\\partial^2\\psi}{\\partial Z \\partial R} = 0 $$\n上式成立是由于对于足够光滑的函数，混合偏导数是相等的。因此，此定义是有效的。\n\n现在我们可以利用给定的 $\\mathbf{B}$ 的分量来构造 $\\psi(R,Z)$。从 $B_R$ 的定义出发：\n$$ \\frac{\\partial \\psi}{\\partial Z} = R B_R(R,Z) = R \\left( \\frac{2\\kappa Z}{R} \\right) = 2\\kappa Z $$\n将此方程对 $Z$ 积分得到 $\\psi(R,Z)$，并引入一个关于 $R$ 的任意函数，我们称之为 $f(R)$：\n$$ \\psi(R,Z) = \\int 2\\kappa Z \\, dZ = \\kappa Z^2 + f(R) $$\n接下来，我们使用 $B_Z$ 的定义：\n$$ \\frac{\\partial \\psi}{\\partial R} = -R B_Z(R,Z) = -R \\left( \\frac{2\\kappa(R - R_x)}{R} \\right) = -2\\kappa(R - R_x) $$\n我们也可以将我们得到的 $\\psi$ 的表达式对 $R$ 求导：\n$$ \\frac{\\partial \\psi}{\\partial R} = \\frac{\\partial}{\\partial R}(\\kappa Z^2 + f(R)) = \\frac{df(R)}{dR} $$\n将 $\\frac{\\partial \\psi}{\\partial R}$ 的两个表达式相等，就可以确定 $f(R)$：\n$$ \\frac{df(R)}{dR} = -2\\kappa(R - R_x) $$\n对 $R$ 积分：\n$$ f(R) = \\int -2\\kappa(R - R_x) \\, dR = -2\\kappa \\left( \\frac{R^2}{2} - R_x R \\right) + C = -\\kappa R^2 + 2\\kappa R_x R + C $$\n其中 $C$ 是积分常数。将 $f(R)$ 代回 $\\psi$ 的表达式中：\n$$ \\psi(R,Z) = \\kappa Z^2 - \\kappa R^2 + 2\\kappa R_x R + C $$\n$\\psi$ 的等值集与常数 $C$ 无关。为了代数上的方便，我们可以选择 $C$ 的值。对包含 $R$ 的项进行配方：\n$$ -\\kappa R^2 + 2\\kappa R_x R = -\\kappa(R^2 - 2R_x R) = -\\kappa((R-R_x)^2 - R_x^2) = -\\kappa(R-R_x)^2 + \\kappa R_x^2 $$\n所以，$\\psi(R,Z) = \\kappa Z^2 - \\kappa(R-R_x)^2 + \\kappa R_x^2 + C$。令 $C = -\\kappa R_x^2$ 可以得到一个以点 $(R_x, 0)$ 为中心的简洁形式：\n$$ \\psi(R,Z) = \\kappa \\left( Z^2 - (R-R_x)^2 \\right) $$\n这是给定磁场的一个有效的极向磁通函数。\n\n任务的第二部分是验证 $\\mathbf{B} \\cdot \\nabla \\psi = 0$。$\\psi(R,Z)$ 在柱坐标下的梯度为：\n$$ \\nabla \\psi = \\frac{\\partial \\psi}{\\partial R} \\hat{\\mathbf{R}} + \\frac{1}{R}\\frac{\\partial \\psi}{\\partial \\phi} \\hat{\\mathbf{\\phi}} + \\frac{\\partial \\psi}{\\partial Z} \\hat{\\mathbf{Z}} $$\n由于 $\\psi$ 仅是 $R$ 和 $Z$ 的函数，因此 $\\frac{\\partial \\psi}{\\partial \\phi} = 0$。于是，$\\nabla \\psi$ 只存在于极向平面：\n$$ \\nabla \\psi = \\frac{\\partial \\psi}{\\partial R} \\hat{\\mathbf{R}} + \\frac{\\partial \\psi}{\\partial Z} \\hat{\\mathbf{Z}} $$\n与磁场 $\\mathbf{B} = B_R \\hat{\\mathbf{R}} + B_\\phi \\hat{\\mathbf{\\phi}} + B_Z \\hat{\\mathbf{Z}}$ 的点积为：\n$$ \\mathbf{B} \\cdot \\nabla \\psi = B_R \\frac{\\partial \\psi}{\\partial R} + B_Z \\frac{\\partial \\psi}{\\partial Z} $$\n注意，环向场分量 $B_\\phi$ 没有贡献，因为它与 $\\nabla \\psi$ 正交。现在我们计算我们导出的 $\\psi(R,Z)$ 的偏导数：\n$$ \\frac{\\partial \\psi}{\\partial R} = \\frac{\\partial}{\\partial R} \\left[ \\kappa \\left( Z^2 - (R-R_x)^2 \\right) \\right] = \\kappa \\left( -2(R-R_x) \\right) = -2\\kappa(R-R_x) $$\n$$ \\frac{\\partial \\psi}{\\partial Z} = \\frac{\\partial}{\\partial Z} \\left[ \\kappa \\left( Z^2 - (R-R_x)^2 \\right) \\right] = \\kappa(2Z) = 2\\kappa Z $$\n现在我们将这些导数和给定的场分量 $B_R$ 和 $B_Z$ 代入点积表达式中：\n$$ \\mathbf{B} \\cdot \\nabla \\psi = \\left( \\frac{2\\kappa Z}{R} \\right) \\left(-2\\kappa(R-R_x)\\right) + \\left( \\frac{2\\kappa(R - R_x)}{R} \\right) \\left(2\\kappa Z\\right) $$\n$$ \\mathbf{B} \\cdot \\nabla \\psi = -\\frac{4\\kappa^2 Z (R-R_x)}{R} + \\frac{4\\kappa^2 Z (R-R_x)}{R} $$\n这两项正好相互抵消：\n$$ \\mathbf{B} \\cdot \\nabla \\psi = 0 $$\n这明确地验证了磁场矢量处处与 $\\psi$ 的等值面相切，这些等值面因此构成了磁面。计算表达式的最终值为 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "安全因子 $q$ 是一个关键参数，它量化了磁力线在磁通面上的缠绕方式，直接影响等离子体的稳定性。这项练习将从磁通面的存在性转向其全局拓扑特征的表征。通过从第一性原理推导托卡马克模型中的安全因子 $q(r)$ 和磁剪切 $s(r)$ ，您将直观地理解等离子体电流和几何位形如何共同塑造磁约束的结构。",
            "id": "4007635",
            "problem": "考虑一个具有圆形磁通量面的轴对称托卡马克，其小半径为 $r$，大半径为 $R(\\theta)=R_{0}+r\\cos\\theta$，其中 $\\theta$ 是极向角，$R_{0}$ 是磁轴的大半径。环向磁场由外部线圈产生，由于环形几何，可以很好地近似为 $B_{\\phi}(R)=B_{0}\\,R_{0}/R$。而极向磁场由净环向等离子体电流产生，在此简化模型中，根据安培定律建模为 $B_{\\theta}(r)=\\mu_{0}I_{p}/(2\\pi r)$，其中 $\\mu_{0}$ 是真空磁导率，$I_{p}$ 是假定在所关注的半径内被包围的等离子体电流。\n\n从磁力线安全因子 $q(r)$ 的第一性原理定义出发，即磁力线每绕极向一圈的扭转的极向平均值，$q(r)=\\frac{1}{2\\pi}\\int_{0}^{2\\pi}\\frac{\\mathrm{d}\\phi}{\\mathrm{d}\\theta}\\,\\mathrm{d}\\theta$，其中 $\\mathrm{d}\\phi/\\mathrm{d}\\theta$ 由磁场 $\\boldsymbol{B}$ 在坐标梯度上的逆变投影之比给出。利用圆形磁面的几何形状，不使用任何简化公式，推导出一个 $q(r)$ 的闭式解析表达式，该表达式保留 $B_{\\phi}(R)$ 对 $R(\\theta)$ 的显式依赖性。然后计算磁剪切 $s(r)=r\\,q'(r)/q(r)$，其中撇号表示对 $r$ 的微分。\n\n将您的最终结果表示为 $q(r)$ 和 $s(r)$ 的闭式解析表达式。不需要进行数值近似或四舍五入。这两个量都是无量纲的；不要在最终表达式中包含单位。",
            "solution": "### 第1部分：安全因子 $q(r)$ 的推导\n磁力线的轨迹由位移矢量 $\\mathrm{d}\\boldsymbol{l}$ 与磁场矢量 $\\boldsymbol{B}$ 平行的条件定义。在曲线坐标系中，这表示为物理长度微元位移之比等于物理场分量之比：\n$$\n\\frac{\\mathrm{d}l_{r}}{B_{r}} = \\frac{\\mathrm{d}l_{\\theta}}{B_{\\theta}} = \\frac{\\mathrm{d}l_{\\phi}}{B_{\\phi}}\n$$\n在给定的环坐标系 $(r, \\theta, \\phi)$ 中，微分弧长元为 $\\mathrm{d}l_{r} = \\mathrm{d}r$、$\\mathrm{d}l_{\\theta} = r\\,\\mathrm{d}\\theta$ 和 $\\mathrm{d}l_{\\phi} = R\\,\\mathrm{d}\\phi = (R_{0} + r\\cos\\theta)\\,\\mathrm{d}\\phi$。磁通量面上的磁场没有径向分量，因此 $B_{r} = 0$，这意味着 $\\mathrm{d}r=0$，证实了磁力线位于这些磁面上。磁力线路径的关系式则由下式给出：\n$$\n\\frac{r\\,\\mathrm{d}\\theta}{B_{\\theta}} = \\frac{R\\,\\mathrm{d}\\phi}{B_{\\phi}}\n$$\n我们可以重新整理这个表达式，以求出沿磁力线环向角 $\\phi$ 相对于极向角 $\\theta$ 的变化率：\n$$\n\\frac{\\mathrm{d}\\phi}{\\mathrm{d}\\theta} = \\frac{r B_{\\phi}}{R B_{\\theta}}\n$$\n我们已知场和几何的表达式：\n-   $R(\\theta) = R_{0} + r\\cos\\theta$\n-   $B_{\\phi}(R) = \\frac{B_{0} R_{0}}{R}$\n-   $B_{\\theta}(r) = \\frac{\\mu_{0} I_{p}}{2\\pi r}$\n将这些代入 $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}\\theta}$ 的表达式中：\n$$\n\\frac{\\mathrm{d}\\phi}{\\mathrm{d}\\theta} = \\frac{r}{R(\\theta)} \\frac{\\left(\\frac{B_{0} R_{0}}{R(\\theta)}\\right)}{\\left(\\frac{\\mu_{0} I_{p}}{2\\pi r}\\right)} = \\frac{2\\pi r^{2} B_{0} R_{0}}{\\mu_{0} I_{p} R(\\theta)^{2}}\n$$\n现在，代入 $R(\\theta)$ 的表达式：\n$$\n\\frac{\\mathrm{d}\\phi}{\\mathrm{d}\\theta} = \\frac{2\\pi r^{2} B_{0} R_{0}}{\\mu_{0} I_{p} (R_{0} + r\\cos\\theta)^{2}}\n$$\n安全因子 $q(r)$ 定义为该量在一次极向旋转（从 $\\theta=0$ 到 $\\theta=2\\pi$）上的平均值：\n$$\nq(r) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\frac{\\mathrm{d}\\phi}{\\mathrm{d}\\theta} \\mathrm{d}\\theta = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\frac{2\\pi r^{2} B_{0} R_{0}}{\\mu_{0} I_{p} (R_{0} + r\\cos\\theta)^{2}} \\mathrm{d}\\theta\n$$\n不依赖于 $\\theta$ 的项可以移到积分符号外：\n$$\nq(r) = \\frac{r^{2} B_{0} R_{0}}{\\mu_{0} I_{p}} \\int_{0}^{2\\pi} \\frac{\\mathrm{d}\\theta}{(R_{0} + r\\cos\\theta)^{2}}\n$$\n为了计算这个积分，我们使用标准的定积分公式：\n$$\n\\int_{0}^{2\\pi} \\frac{\\mathrm{d}x}{(a+b\\cos x)^{2}} = \\frac{2\\pi a}{(a^{2}-b^{2})^{\\frac{3}{2}}}\n$$\n此公式在 $a > |b|$ 时有效，在我们的情况下对应于 $R_{0} > r$。这个条件在物理上是必需的，因为它意味着磁通量面不与环体的中心轴相交。\n通过设 $a=R_{0}$ 和 $b=r$，我们得到我们积分的值：\n$$\n\\int_{0}^{2\\pi} \\frac{\\mathrm{d}\\theta}{(R_{0} + r\\cos\\theta)^{2}} = \\frac{2\\pi R_{0}}{(R_{0}^{2}-r^{2})^{\\frac{3}{2}}}\n$$\n将此结果代回 $q(r)$ 的表达式中：\n$$\nq(r) = \\frac{r^{2} B_{0} R_{0}}{\\mu_{0} I_{p}} \\left( \\frac{2\\pi R_{0}}{(R_{0}^{2}-r^{2})^{\\frac{3}{2}}} \\right)\n$$\n这就给出了安全因子的最终表达式：\n$$\nq(r) = \\frac{2\\pi r^{2} B_{0} R_{0}^{2}}{\\mu_{0} I_{p} (R_{0}^{2}-r^{2})^{\\frac{3}{2}}}\n$$\n\n### 第2部分：磁剪切 $s(r)$ 的推导\n磁剪切 $s(r)$ 定义为 $q(r)$ 对 $r$ 的对数导数，并按 $r$ 进行缩放：\n$$\ns(r) = \\frac{r}{q(r)} \\frac{\\mathrm{d}q(r)}{\\mathrm{d}r} = r \\frac{\\mathrm{d}}{\\mathrm{d}r} (\\ln q(r))\n$$\n为了计算这个值，我们首先对 $q(r)$ 的表达式取自然对数。令 $C = \\frac{2\\pi B_{0} R_{0}^{2}}{\\mu_{0} I_{p}}$ 为一个相对于 $r$ 的常数。\n$$\nq(r) = C r^{2} (R_{0}^{2} - r^{2})^{-\\frac{3}{2}}\n$$\n取自然对数：\n$$\n\\ln(q(r)) = \\ln(C) + \\ln(r^{2}) + \\ln\\left((R_{0}^{2} - r^{2})^{-\\frac{3}{2}}\\right) = \\ln(C) + 2\\ln(r) - \\frac{3}{2}\\ln(R_{0}^{2} - r^{2})\n$$\n现在，我们对 $r$ 求导：\n$$\n\\frac{1}{q(r)}\\frac{\\mathrm{d}q(r)}{\\mathrm{d}r} = \\frac{\\mathrm{d}}{\\mathrm{d}r}(\\ln(q(r))) = 0 + \\frac{2}{r} - \\frac{3}{2} \\left( \\frac{1}{R_{0}^{2} - r^{2}} \\right)(-2r) = \\frac{2}{r} + \\frac{3r}{R_{0}^{2} - r^{2}}\n$$\n最后，我们乘以 $r$ 以获得磁剪切 $s(r)$：\n$$\ns(r) = r \\left( \\frac{2}{r} + \\frac{3r}{R_{0}^{2} - r^{2}} \\right) = 2 + \\frac{3r^{2}}{R_{0}^{2} - r^{2}}\n$$\n这个表达式可以合并成一个单独的分数：\n$$\ns(r) = \\frac{2(R_{0}^{2} - r^{2}) + 3r^{2}}{R_{0}^{2} - r^{2}} = \\frac{2R_{0}^{2} - 2r^{2} + 3r^{2}}{R_{0}^{2} - r^{2}} = \\frac{2R_{0}^{2} + r^{2}}{R_{0}^{2} - r^{2}}\n$$\n这是磁剪切的最终表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} q(r) = \\frac{2\\pi r^{2} B_{0} R_{0}^{2}}{\\mu_{0} I_{p} (R_{0}^{2} - r^{2})^{\\frac{3}{2}}} \\\\ s(r) = \\frac{2R_{0}^{2} + r^{2}}{R_{0}^{2} - r^{2}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理想的嵌套磁通面结构可能会被共振磁扰动所破坏，从而形成磁岛——这是等离子体稳定性和输运研究中的一个关键课题。这项动手实践结合了分析建模与计算方法，要求您定位这些磁岛的中心（O点）和鞍点（X点）。通过分析一个螺旋磁通函数，您将实现一个算法，以识别这种复杂拓扑结构的关键特征。",
            "id": "4007705",
            "problem": "考虑一个理想磁流体动力学（MHD）中的三维环形等离子体，其中磁力线位于由极向通量 $\\psi$ 标记的嵌套磁通量面上。令 $\\theta$ 表示极向角，$\\zeta$ 表示环向角。当 $q(\\psi_s)=m/n$ 时，安全因子 $q(\\psi)$ 在 $\\psi=\\psi_s$ 处定义了一个有理面，其中 $m$ 和 $n$ 是描述单螺旋性微扰的极向和环向周期性的整数。在此类有理面附近，一个受扰动的平衡会产生磁岛，其拓扑结构可以使用由 $u=m\\theta - n\\zeta$ 定义的螺旋角 $u$ 来描述。O点是磁岛的中心，对应于螺旋通量函数的极小值，而X点是鞍点，当限制在螺旋角坐标上时，对应于螺旋通量函数的极大值。\n\n从以下公认的基础出发：\n- 磁通量面上的磁力线可以通过角变量和安全因子 $q(\\psi)$ 来描述。\n- 具有整数 $m$ 和 $n$ 的单螺旋性微扰在组合 $u=m\\theta - n\\zeta$ 中产生螺旋对称性。\n- 在满足 $q(\\psi_s)=m/n$ 的有理面 $\\psi=\\psi_s$ 处，主导阶的磁岛结构可以通过一个依赖于螺旋角 $u$ 的标量螺旋通量函数来捕捉。\n\n定义一个限制在 $\\psi=\\psi_s$ 上的无量纲螺旋通量函数为\n$$\n\\chi(u) = \\varepsilon_1 \\cos\\!\\big(u+\\phi\\big) + \\varepsilon_2 \\cos\\!\\big(2u+2\\phi\\big),\n$$\n其中 $\\varepsilon_1$ 和 $\\varepsilon_2$ 是实数振幅，$\\phi$ 是一个相移。当在周期域 $u \\in [0,2\\pi)$ 上考虑时，O点对应于 $\\chi(u)$ 的局部极小值，X点对应于 $\\chi(u)$ 的局部极大值。\n\n你的任务是实现一个算法，该算法针对多个参数集，通过在单个周期上对螺旋通量函数 $\\chi(u)$ 进行最小化和鞍点搜索，来定位所有的O点和X点。具体来说：\n- 求解所有驻角 $u^\\star \\in [0,2\\pi)$，使得 $\\frac{d}{du}\\chi(u^\\star)=0$。\n- 将每个驻角 $u^\\star$ 分类为O点（如果 $\\frac{d^2}{du^2}\\chi(u^\\star)>0$，局部极小值）或X点（如果 $\\frac{d^2}{du^2}\\chi(u^\\star)<0$，局部极大值）。\n- 忽略那些 $\\frac{d^2}{du^2}\\chi(u^\\star)=0$（在机器精度内）的驻点（罕见的简并情况）。\n\n角度必须以弧度表示。搜索域为 $u \\in [0,2\\pi)$ 且是周期性的，意味着 $u=0$ 和 $u=2\\pi$ 代表相同的角度；请在一个小的数值公差范围内对相差 $2\\pi$ 整数倍的解进行去重。\n\n实现你的算法以覆盖以下参数集的测试套件，每个参数集以 $(m,n,\\phi,\\varepsilon_1,\\varepsilon_2)$ 的形式提供：\n- 测试用例 1：$(m,n,\\phi,\\varepsilon_1,\\varepsilon_2) = (\\,2,\\,1,\\,0.0,\\,0.075,\\,0.020\\,)$。\n- 测试用例 2：$(m,n,\\phi,\\varepsilon_1,\\varepsilon_2) = (\\,3,\\,2,\\,\\pi/4,\\,0.040,\\,0.015\\,)$。\n- 测试用例 3：$(m,n,\\phi,\\varepsilon_1,\\varepsilon_2) = (\\,3,\\,1,\\,\\pi/3,\\,0.000,\\,0.050\\,)$。\n- 测试用例 4：$(m,n,\\phi,\\varepsilon_1,\\varepsilon_2) = (\\,1,\\,1,\\,\\pi/8,\\,0.020,\\,-0.010\\,)$。\n\n你的程序应该：\n- 对每个测试用例，计算两个已排序的驻螺旋角 $u$（在 $[0,2\\pi)$ 内）列表：一个用于O点（极小值），一个用于X点（极大值）。\n- 所有角度以弧度表示。\n- 将整个测试套件的结果汇总到单行输出中，该行包含一个由方括号括起来的逗号分隔列表。每个测试用例的结果必须是包含两个列表的列表：第一个包含O点角度，第二个包含X点角度。例如，最终输出必须如下所示：\n$$\n[\\,[\\,[u_{O,1},\\dots],[u_{X,1},\\dots]\\,],\\,[\\,[u_{O,2},\\dots],[u_{X,2},\\dots]\\,],\\,[\\,[u_{O,3},\\dots],[u_{X,3},\\dots]\\,],\\,[\\,[u_{O,4},\\dots],[u_{X,4},\\dots]\\,]\\,].\n$$\n\n设计时考虑覆盖范围：\n- 包括一个两个谐波都非零的一般情况（测试用例 1）。\n- 包括一个带相移的多谐波情况（测试用例 2）。\n- 包括一个第一谐波缺失（$\\varepsilon_1=0$）的边界情况（测试用例 3）。\n- 包括一个 $\\varepsilon_2<0$ 的符号反差情况（测试用例 4）。\n\n最终程序必须是自包含的，不需要用户输入，并且只打印上述单行输出。角度必须以弧度表示。不涉及其他单位。",
            "solution": "该问题的核心是在一个周期域上找到并分类给定的一维螺旋通量函数 $\\chi(u)$ 的驻点。该函数由下式给出：\n$$\n\\chi(u) = \\varepsilon_1 \\cos(u+\\phi) + \\varepsilon_2 \\cos(2(u+\\phi))\n$$\n其中 $u \\in [0, 2\\pi)$ 是螺旋角，$\\varepsilon_1$ 和 $\\varepsilon_2$ 是实数振幅，$\\phi$ 是一个相移。\n\n**1. 寻找驻点**\n\n通过求解 $\\frac{d\\chi}{du}|_{u^\\star}=0$ 来找到驻点 $u^\\star$。首先，我们计算 $\\chi(u)$ 对 $u$ 的一阶导数：\n$$\n\\frac{d\\chi}{du} = -\\varepsilon_1 \\sin(u+\\phi) - 2\\varepsilon_2 \\sin(2(u+\\phi))\n$$\n使用倍角公式 $\\sin(2\\alpha) = 2\\sin(\\alpha)\\cos(\\alpha)$，其中 $\\alpha = u+\\phi$，我们得到：\n$$\n-\\varepsilon_1 \\sin(u+\\phi) - 4\\varepsilon_2 \\sin(u+\\phi)\\cos(u+\\phi) = 0\n$$\n提出公因式 $-\\sin(u+\\phi)$ 得：\n$$\n-\\sin(u+\\phi) \\left( \\varepsilon_1 + 4\\varepsilon_2 \\cos(u+\\phi) \\right) = 0\n$$\n该方程为驻点提供了两类解：\n\n*   **第一类解**: $\\sin(u+\\phi) = 0$\n    这要求 $u+\\phi = k\\pi$，其中 $k$ 为任意整数。在一个周期内，我们得到两个不同的解，例如，对于 $k=0$ 和 $k=1$，解为 $u^\\star_1 = -\\phi$ 和 $u^\\star_2 = \\pi-\\phi$。\n\n*   **第二类解**: $\\varepsilon_1 + 4\\varepsilon_2 \\cos(u+\\phi) = 0$\n    这要求 $\\cos(u+\\phi) = -\\frac{\\varepsilon_1}{4\\varepsilon_2}$。只有当 $|\\frac{\\varepsilon_1}{4\\varepsilon_2}| \\le 1$ 且 $\\varepsilon_2 \\ne 0$ 时，此方程才有关于 $u$ 的实数解。如果满足此条件，令 $\\beta = \\arccos(-\\frac{\\varepsilon_1}{4\\varepsilon_2})$。解由 $u+\\phi = \\pm\\beta + 2k\\pi$ 给出，从而得到驻角 $u^\\star_3 = \\beta - \\phi$ 和 $u^\\star_4 = -\\beta - \\phi$。\n\n**2. 分类驻点**\n\n通过计算二阶导数 $\\frac{d^2\\chi}{du^2}$ 在每个驻点处的符号来对这些点进行分类。\n$$\n\\frac{d^2\\chi}{du^2} = -\\varepsilon_1 \\cos(u+\\phi) - 4\\varepsilon_2 \\cos(2(u+\\phi))\n$$\n令 $v = u+\\phi$。\n\n*   对于第一类解，其中 $\\sin(v)=0$，我们有 $\\cos(v) = \\pm 1$。\n    *   若 $\\cos(v)=1$ (即 $v=2k\\pi$)，$\\frac{d^2\\chi}{du^2} = -\\varepsilon_1(1) - 4\\varepsilon_2(1) = -(\\varepsilon_1 + 4\\varepsilon_2)$。\n    *   若 $\\cos(v)=-1$ (即 $v=(2k+1)\\pi$)，$\\frac{d^2\\chi}{du^2} = -\\varepsilon_1(-1) - 4\\varepsilon_2(1) = \\varepsilon_1 - 4\\varepsilon_2$。\n\n*   对于第二类解，其中 $\\cos(v) = -\\frac{\\varepsilon_1}{4\\varepsilon_2}$，使用恒等式 $\\cos(2v) = 2\\cos^2(v)-1$ 来简化二阶导数：\n    $$\n    \\frac{d^2\\chi}{du^2} = -\\varepsilon_1 \\cos(v) - 4\\varepsilon_2 (2\\cos^2(v) - 1)\n    $$\n    代入 $\\cos(v) = -\\frac{\\varepsilon_1}{4\\varepsilon_2}$ 并化简，得到：\n    $$\n    \\frac{d^2\\chi}{du^2} = \\frac{16\\varepsilon_2^2 - \\varepsilon_1^2}{4\\varepsilon_2}\n    $$\n    此表达式的符号对于这类解是恒定的，它决定了它们的分类。\n\n**3. 算法实现**\n\n一个自包含的程序可以实现以下逻辑：\n1.  对于每组参数 $(\\phi, \\varepsilon_1, \\varepsilon_2)$，根据上述解析解生成一个驻角的候选列表。\n2.  将所有候选角度归一化到区间 $[0, 2\\pi)$。\n3.  通过排序并合并在小公差范围内的角度，来移除重复的解。\n4.  对于每个唯一的驻角 $u^\\star$，计算二阶导数 $\\frac{d^2\\chi}{du^2}$。\n5.  如果 $\\frac{d^2\\chi}{du^2} > 0$，该角度被分类为O点（局部极小值）。\n6.  如果 $\\frac{d^2\\chi}{du^2}  0$，该角度被分类为X点（局部极大值）。\n7.  对每个测试用例，将O点和X点的列表进行排序和存储。\n8.  最后，将所有测试用 l例的结果按指定格式化为单个字符串。",
            "answer": "```python\nimport numpy as np\n\ndef solve_and_print_results():\n    \"\"\"\n    Solves for O-points and X-points of a helical flux function for a given\n    set of test cases and prints the results in the specified format.\n    \"\"\"\n    \n    test_cases = [\n        # (m, n, phi, epsilon1, epsilon2)\n        (2, 1, 0.0, 0.075, 0.020),\n        (3, 2, np.pi / 4, 0.040, 0.015),\n        (3, 1, np.pi / 3, 0.000, 0.050),\n        (1, 1, np.pi / 8, 0.020, -0.010),\n    ]\n\n    all_results = []\n    # Numerical tolerance for floating point comparisons\n    tol = 1e-9\n\n    for m, n, phi, epsilon1, epsilon2 in test_cases:\n        candidate_angles = []\n\n        # Family 1: derived from sin(u + phi) = 0\n        candidate_angles.append(-phi)\n        candidate_angles.append(np.pi - phi)\n\n        # Family 2: derived from cos(u + phi) = -epsilon1 / (4 * epsilon2)\n        if abs(epsilon2)  tol:\n            ratio = -epsilon1 / (4.0 * epsilon2)\n            # Only proceed if real solutions exist\n            if abs(ratio) = 1.0:\n                beta = np.arccos(ratio)\n                candidate_angles.append(beta - phi)\n                candidate_angles.append(-beta - phi)\n\n        # Normalize all found angles to the interval [0, 2*pi)\n        normalized_angles = [(u % (2.0 * np.pi) + 2.0 * np.pi) % (2.0 * np.pi) for u in candidate_angles]\n\n        # Sort and deduplicate angles\n        normalized_angles.sort()\n        unique_angles = []\n        if normalized_angles:\n            unique_angles.append(normalized_angles[0])\n            for i in range(1, len(normalized_angles)):\n                # Check for distinctness, as different formulas can yield the same angle\n                if abs(normalized_angles[i] - unique_angles[-1])  tol:\n                    unique_angles.append(normalized_angles[i])\n            # Final wrap-around check (e.g., 0 and 2*pi are the same point)\n            if len(unique_angles)  1:\n                if abs(unique_angles[-1] - (unique_angles[0] + 2.0 * np.pi))  tol:\n                    unique_angles.pop()\n\n        o_points = []\n        x_points = []\n\n        # Classify each unique stationary point using the second derivative test\n        for u in unique_angles:\n            # Second derivative: d^2(chi)/du^2\n            d2_chi_du2 = -epsilon1 * np.cos(u + phi) - 4.0 * epsilon2 * np.cos(2.0 * (u + phi))\n            \n            if d2_chi_du2  tol:\n                o_points.append(u)\n            elif d2_chi_du2  -tol:\n                x_points.append(u)\n        \n        o_points.sort()\n        x_points.sort()\n        all_results.append([o_points, x_points])\n\n    # Format the final output string exactly as specified in the problem description\n    case_strings = []\n    for o_list, x_list in all_results:\n        # Format each number to a reasonable precision\n        o_str = f\"[{','.join([f'{val:.6f}' for val in o_list])}]\"\n        x_str = f\"[{','.join([f'{val:.6f}' for val in x_list])}]\"\n        case_strings.append(f\"[{o_str},{x_str}]\")\n    \n    final_output = f\"[{','.join(case_strings)}]\"\n    print(final_output)\n\nsolve_and_print_results()\n```"
        }
    ]
}