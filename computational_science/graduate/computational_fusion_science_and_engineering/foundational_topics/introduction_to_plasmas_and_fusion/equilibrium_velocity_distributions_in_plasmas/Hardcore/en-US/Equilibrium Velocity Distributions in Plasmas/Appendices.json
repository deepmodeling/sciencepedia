{
    "hands_on_practices": [
        {
            "introduction": "The Maxwellian distribution is the cornerstone of equilibrium statistical mechanics and the starting point for most plasma modeling. This exercise takes you back to first principles, demonstrating how this fundamental distribution arises directly from maximizing the system's entropy under the constraints of conserved particle number, momentum, and energy. Completing this derivation solidifies your understanding of why the Maxwellian is the most probable state for a collisional plasma in thermodynamic equilibrium and provides the theoretical bedrock for the practices that follow. ",
            "id": "3975367",
            "problem": "A homogeneous single-species plasma at thermodynamic equilibrium is frequently initialized in computational fusion science and engineering codes with an equilibrium velocity distribution that maximizes the kinetic entropy subject to conserved macroscopic moments. Consider a species of mass $m$, number density $n$, temperature $T$, and mean flow velocity vector $\\mathbf{u}$. The velocity of a particle is $\\mathbf{v}=(v_x,v_y,v_z)$. Let $k_B$ denote the Boltzmann constant. Assume the plasma is spatially uniform and collisions have driven it to a stationary state consistent with the principle of maximum entropy.\n\nStarting from the continuous entropy functional for the velocity distribution $f(\\mathbf{v})$ and imposing constraints of fixed particle number, fixed mean flow, and fixed kinetic energy, derive the form of the equilibrium velocity distribution $f(\\mathbf{v})$ over $\\mathbf{v}$. Then, compute the one-dimensional marginal along a single Cartesian component defined by\n$$\nf_{1D}(v_x)=\\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(v_x,v_y,v_z)\\, dv_y\\, dv_z.\n$$\nExpress $f_{1D}(v_x)$ as a closed-form analytic expression in terms of $n$, $m$, $k_B$, $T$, and $u_x$, and identify its mean and variance by comparing it to a standard Gaussian in the single velocity component $v_x$.\n\nYour final answer must be a single closed-form expression for $f_{1D}(v_x)$ only. Use International System of Units (SI). Do not substitute numerical values. No rounding is required. Do not include units in your final boxed expression.",
            "solution": "The problem requires the derivation of the one-dimensional marginal equilibrium velocity distribution function, $f_{1D}(v_x)$, for a homogeneous, single-species plasma. The derivation begins from the principle of maximum entropy, a cornerstone of statistical mechanics.\n\nThe state of the plasma is described by the velocity distribution function $f(\\mathbf{v})$, where $\\mathbf{v}=(v_x, v_y, v_z)$ is the particle velocity. We aim to find the function $f(\\mathbf{v})$ that maximizes the Boltzmann-Gibbs entropy functional,\n$$\nS[f] = -k_B \\int f(\\mathbf{v}) \\ln f(\\mathbf{v}) \\, d^3\\mathbf{v}\n$$\nsubject to macroscopic constraints. The constant $k_B$ is the Boltzmann constant. The integration is over all of velocity space.\n\nThe constraints are given by the conservation of particle number, momentum, and energy. For a spatially uniform plasma, these are expressed in terms of the number density $n$, mean flow velocity $\\mathbf{u}$, and temperature $T$.\nThe constraints on $f(\\mathbf{v})$ are:\n1.  Conservation of number density: The integral of the distribution function over all velocities must yield the total number density $n$.\n    $$\n    \\int f(\\mathbf{v}) \\, d^3\\mathbf{v} = n\n    $$\n2.  Definition of mean flow velocity: The first moment of the distribution function defines the mean velocity $\\mathbf{u}$.\n    $$\n    \\int \\mathbf{v} f(\\mathbf{v}) \\, d^3\\mathbf{v} = n\\mathbf{u}\n    $$\n    This is equivalent to three scalar constraints, one for each component of the velocity vector.\n3.  Definition of temperature: The temperature $T$ is related to the average kinetic energy of the particles in the frame of reference moving with the mean flow. The total kinetic energy density in the laboratory frame is the sum of the thermal energy density and the kinetic energy density of the bulk flow. The total kinetic energy density is thus given by $\\frac{3}{2}nk_BT + \\frac{1}{2}nm|\\mathbf{u}|^2$. The constraint on the second moment of the distribution is:\n    $$\n    \\int \\frac{1}{2} m |\\mathbf{v}|^2 f(\\mathbf{v}) \\, d^3\\mathbf{v} = \\frac{3}{2} n k_B T + \\frac{1}{2} n m |\\mathbf{u}|^2\n    $$\n    where $m$ is the mass of a single particle.\n\nTo solve this constrained optimization problem, we use the method of Lagrange multipliers. We construct a new functional $L[f]$ which we will maximize without constraints:\n$$\nL[f] = -\\int f\\ln f \\,d^3\\mathbf{v} - \\lambda_0\\left(\\int f \\, d^3\\mathbf{v} - n\\right) - \\boldsymbol{\\lambda}_1 \\cdot \\left(\\int \\mathbf{v} f \\, d^3\\mathbf{v} - n\\mathbf{u}\\right) - \\lambda_2\\left(\\int \\frac{1}{2} m |\\mathbf{v}|^2 f \\, d^3\\mathbf{v} - E_{kin}\\right)\n$$\nHere, we have divided the entropy by $k_B$ for convenience, and the Lagrange multipliers are $\\lambda_0$, $\\boldsymbol{\\lambda}_1$ (a vector), and $\\lambda_2$.\nTo find the maximum, we take the functional derivative of $L[f]$ with respect to $f$ and set it to zero:\n$$\n\\frac{\\delta L}{\\delta f} = -(\\ln f(\\mathbf{v}) + 1) - \\lambda_0 - \\boldsymbol{\\lambda}_1 \\cdot \\mathbf{v} - \\lambda_2 \\frac{1}{2} m |\\mathbf{v}|^2 = 0\n$$\nSolving for $\\ln f(\\mathbf{v})$:\n$$\n\\ln f(\\mathbf{v}) = -(1 + \\lambda_0) - \\boldsymbol{\\lambda}_1 \\cdot \\mathbf{v} - \\lambda_2 \\frac{1}{2} m |\\mathbf{v}|^2\n$$\nThis gives the functional form of $f(\\mathbf{v})$:\n$$\nf(\\mathbf{v}) = \\exp\\left(-(1 + \\lambda_0)\\right) \\exp\\left(-\\boldsymbol{\\lambda}_1 \\cdot \\mathbf{v} - \\lambda_2 \\frac{1}{2} m |\\mathbf{v}|^2\\right)\n$$\nThe exponent can be rearranged by completing the square:\n$$\n-\\frac{m\\lambda_2}{2}|\\mathbf{v}|^2 - \\boldsymbol{\\lambda}_1 \\cdot \\mathbf{v} = -\\frac{m\\lambda_2}{2}\\left(|\\mathbf{v}|^2 + \\frac{2}{m\\lambda_2}\\boldsymbol{\\lambda}_1 \\cdot \\mathbf{v}\\right) = -\\frac{m\\lambda_2}{2}\\left(\\left|\\mathbf{v} + \\frac{\\boldsymbol{\\lambda}_1}{m\\lambda_2}\\right|^2 - \\left|\\frac{\\boldsymbol{\\lambda}_1}{m\\lambda_2}\\right|^2\\right)\n$$\nThe distribution function becomes:\n$$\nf(\\mathbf{v}) = C \\exp\\left(-\\frac{m\\lambda_2}{2}\\left|\\mathbf{v} + \\frac{\\boldsymbol{\\lambda}_1}{m\\lambda_2}\\right|^2\\right)\n$$\nwhere $C$ is a normalization constant incorporating all other terms. This is a Gaussian distribution in $\\mathbf{v}$, centered at $\\langle\\mathbf{v}\\rangle = -\\frac{\\boldsymbol{\\lambda}_1}{m\\lambda_2}$. From the second constraint, we know that the mean velocity is $\\mathbf{u}$. Therefore, $\\mathbf{u} = -\\frac{\\boldsymbol{\\lambda}_1}{m\\lambda_2}$, which implies $\\boldsymbol{\\lambda}_1 = -m\\lambda_2\\mathbf{u}$.\n\nSubstituting $\\boldsymbol{\\lambda}_1$ back into the original exponent gives:\n$$\n-\\frac{m\\lambda_2}{2}|\\mathbf{v}|^2 - (-m\\lambda_2\\mathbf{u}) \\cdot \\mathbf{v} = -\\frac{m\\lambda_2}{2}(|\\mathbf{v}|^2 - 2\\mathbf{u}\\cdot\\mathbf{v}) = -\\frac{m\\lambda_2}{2}(|\\mathbf{v}-\\mathbf{u}|^2 - |\\mathbf{u}|^2)\n$$\nThe distribution is then:\n$$\nf(\\mathbf{v}) = A \\exp\\left(-\\frac{m\\lambda_2}{2}|\\mathbf{v}-\\mathbf{u}|^2\\right)\n$$\nwhere $A$ is a new normalization constant.\n\nTo determine the Lagrange multiplier $\\lambda_2$ and the constant $A$, we apply the first and third constraints.\nThe relationship between temperature and the velocity distribution is given by the average kinetic energy in the co-moving frame:\n$$\n\\frac{3}{2} k_B T = \\frac{1}{n} \\int \\frac{1}{2}m|\\mathbf{v}-\\mathbf{u}|^2 f(\\mathbf{v}) \\, d^3\\mathbf{v}\n$$\nBy performing the Gaussian integrals required for normalization and for the energy constraint, it can be robustly shown that $\\lambda_2 = \\frac{1}{k_B T}$.\nWith $\\lambda_2$ known, the normalization constant $A$ is found from the first constraint, $\\int f(\\mathbf{v}) \\,d^3\\mathbf{v} = n$.\n$$\nn = \\int A \\exp\\left(-\\frac{m|\\mathbf{v}-\\mathbf{u}|^2}{2k_B T}\\right) \\, d^3\\mathbf{v} = A \\left(\\frac{2\\pi k_B T}{m}\\right)^{3/2}\n$$\nThis gives $A = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2}$.\nThe equilibrium velocity distribution is the drifting Maxwellian:\n$$\nf(\\mathbf{v}) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{m|\\mathbf{v}-\\mathbf{u}|^2}{2k_B T}\\right)\n$$\n\nThe next step is to compute the one-dimensional marginal distribution $f_{1D}(v_x)$:\n$$\nf_{1D}(v_x) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} f(v_x, v_y, v_z) \\, dv_y \\, dv_z\n$$\nWe expand the square in the exponent: $|\\mathbf{v}-\\mathbf{u}|^2 = (v_x - u_x)^2 + (v_y - u_y)^2 + (v_z - u_z)^2$. The distribution function separates into a product of functions of $v_x$, $v_y$, and $v_z$:\n$$\nf(\\mathbf{v}) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{m(v_x-u_x)^2}{2k_B T}\\right) \\exp\\left(-\\frac{m(v_y-u_y)^2}{2k_B T}\\right) \\exp\\left(-\\frac{m(v_z-u_z)^2}{2k_B T}\\right)\n$$\nThe integration over $v_y$ and $v_z$ can be performed independently:\n$$\nf_{1D}(v_x) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{m(v_x-u_x)^2}{2k_B T}\\right) \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m(v_y-u_y)^2}{2k_B T}\\right) dv_y \\right] \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m(v_z-u_z)^2}{2k_B T}\\right) dv_z \\right]\n$$\nBoth integrals are of the standard Gaussian form $\\int_{-\\infty}^{\\infty} \\exp(-a(x-b)^2)dx = \\sqrt{\\pi/a}$. Here, $a = \\frac{m}{2k_B T}$. Thus, each integral evaluates to $\\sqrt{\\frac{2\\pi k_B T}{m}}$.\nThe product of the two integrals is $\\left(\\sqrt{\\frac{2\\pi k_B T}{m}}\\right)^2 = \\frac{2\\pi k_B T}{m}$.\nSubstituting this result into the expression for $f_{1D}(v_x)$:\n$$\nf_{1D}(v_x) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\left(\\frac{2\\pi k_B T}{m}\\right) \\exp\\left(-\\frac{m(v_x-u_x)^2}{2k_B T}\\right)\n$$\nSimplifying the pre-factor:\n$$\nn \\left(\\frac{m}{2\\pi k_B T}\\right)^{(3/2) - 1} = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2}\n$$\nThe resulting one-dimensional marginal distribution is:\n$$\nf_{1D}(v_x) = n \\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2} \\exp\\left(-\\frac{m(v_x-u_x)^2}{2k_B T}\\right)\n$$\nThis expression is a one-dimensional Gaussian distribution in $v_x$. To identify its mean and variance, we can compare its associated probability density function, $p(v_x) = f_{1D}(v_x)/n$, to the standard form of a normal distribution with mean $\\mu$ and variance $\\sigma^2$:\n$$\np(v_x) = \\frac{1}{\\sigma\\sqrt{2\\pi}}\\exp\\left(-\\frac{(v_x-\\mu)^2}{2\\sigma^2}\\right)\n$$\nOur probability density is:\n$$\np(v_x) = \\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2} \\exp\\left(-\\frac{m(v_x-u_x)^2}{2k_B T}\\right)\n$$\nBy comparing the terms in the exponent, we immediately identify the mean as $\\mu = u_x$.\nBy comparing the denominators of the exponents, $2\\sigma^2 = \\frac{2k_B T}{m}$, we find the variance to be $\\sigma^2 = \\frac{k_B T}{m}$. The pre-factor $\\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2} = \\frac{1}{\\sqrt{2\\pi (k_B T/m)}} = \\frac{1}{\\sigma\\sqrt{2\\pi}}$ is consistent with this identification. The mean of $f_{1D}(v_x)$ is the $x$-component of the bulk flow velocity, $u_x$, and its variance is related to the thermal spread, $\\frac{k_B T}{m}$.",
            "answer": "$$\n\\boxed{n \\left( \\frac{m}{2 \\pi k_B T} \\right)^{\\frac{1}{2}} \\exp\\left( -\\frac{m(v_x - u_x)^{2}}{2 k_B T} \\right)}\n$$"
        },
        {
            "introduction": "Moving from an idealized, infinite plasma to a more realistic scenario, this practice explores the crucial interface between the hot plasma and a material wall. The electrostatic sheath that forms at this boundary acts as an energy filter, altering the velocity distribution of particles that reach the surface. By calculating the heat flux from a Maxwellian distribution that has been truncated by the sheath potential, you will learn to quantify a critical engineering parameter and gain insight into the physics of plasma-material interactions. ",
            "id": "3975397",
            "problem": "Consider an equilibrium, three-dimensional (3D), isotropic electron velocity distribution in the scrape-off layer of a magnetically confined fusion plasma adjacent to a perfectly absorbing planar wall. The electron population far from the wall is well described by a Maxwellian distribution with number density $n_{e}$, electron mass $m_{e}$, and temperature $T_{e}$, whose distribution function is\n$$\nf_{M}(\\mathbf{v}) \\;=\\; n_{e}\\left(\\frac{m_{e}}{2\\pi k_{B} T_{e}}\\right)^{3/2}\\exp\\!\\left(-\\frac{m_{e} v^{2}}{2 k_{B} T_{e}}\\right),\n$$\nwhere $k_{B}$ is the Boltzmann constant and $v = |\\mathbf{v}|$.\n\nDue to the electrostatic sheath adjacent to the wall with sheath potential $\\Phi_{s}  0$, electrons with kinetic energy less than the potential energy barrier are reflected and do not reach the wall. Model this effect by a truncated Maxwellian at the sheath entrance in which the incoming distribution toward the wall is\n$$\nf_{t}(\\mathbf{v}) \\;=\\; \\begin{cases}\nf_{M}(\\mathbf{v}),  v \\ge v_{c}, \\\\\n0,  v  v_{c},\n\\end{cases}\n$$\nwith cutoff speed $v_{c} = \\sqrt{2 e \\Phi_{s}/m_{e}}$, where $e$ is the elementary charge. Assume the distribution remains isotropic in velocity space aside from the speed truncation and that collisions within the sheath are negligible.\n\nThe energy flux density (heat flux) carried by electrons to the wall is defined kinetically as\n$$\nq \\;=\\; \\int_{v_{x}  0} \\frac{1}{2} m_{e} v^{2} \\, v_{x} \\, f(\\mathbf{v}) \\, d^{3}v,\n$$\nwhere $v_{x}$ is the velocity component normal to the wall pointing toward it. Using first principles of kinetic theory and the above model, derive the exact closed-form analytical expression for the ratio\n$$\n\\mathcal{R}(\\chi) \\;=\\; \\frac{q_{t}}{q_{M}},\n$$\nwhere $q_{t}$ is the heat flux obtained from $f_{t}$, $q_{M}$ is the heat flux obtained from $f_{M}$, and $\\chi = \\frac{e \\Phi_{s}}{k_{B} T_{e}}$ is the dimensionless sheath potential. Express your final answer as a single simplified analytical expression in terms of $\\chi$ only. No numerical evaluation is required and no units should be included in the final answer.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in plasma kinetic theory, well-posed with all necessary information provided, and stated in an objective, formal manner. The model, while a simplification of sheath physics, is mathematically consistent and explicitly defined.\n\nThe heat flux density `q` carried by electrons to the wall is given by the kinetic definition:\n$$\nq \\;=\\; \\int_{v_{x}  0} \\frac{1}{2} m_{e} v^{2} \\, v_{x} \\, f(\\mathbf{v}) \\, d^{3}v\n$$\nwhere $v_{x}$ is the velocity component normal to the wall. To evaluate this integral, we switch to spherical coordinates in velocity space, where $\\mathbf{v} = (v, \\theta, \\phi)$, with $v$ being the speed, $\\theta$ the polar angle with respect to the $x$-axis, and $\\phi$ the azimuthal angle. The components are $v_x = v \\cos\\theta$, $v_y = v \\sin\\theta \\cos\\phi$, $v_z = v \\sin\\theta \\sin\\phi$. The volume element is $d^3v = v^2 \\sin\\theta \\, dv \\, d\\theta \\, d\\phi$. The integration domain $v_x  0$ corresponds to $0 \\le \\theta  \\pi/2$, while $v \\ge 0$ and $0 \\le \\phi  2\\pi$.\n\nThe problem specifies that both the Maxwellian distribution $f_M(\\mathbf{v})$ and the truncated distribution $f_t(\\mathbf{v})$ are isotropic, meaning they depend only on the speed $v=|\\mathbf{v}|$. For any such isotropic distribution $f(v)$, the heat flux integral becomes:\n$$\nq \\;=\\; \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi/2} d\\theta \\int_{0}^{\\infty} dv \\, \\left( \\frac{1}{2} m_{e} v^{2} \\right) (v \\cos\\theta) (f(v)) (v^2 \\sin\\theta)\n$$\nThe angular integrals can be performed independently of the speed integral:\n$$\n\\int_{0}^{2\\pi} d\\phi = 2\\pi\n$$\n$$\n\\int_{0}^{\\pi/2} \\sin\\theta \\cos\\theta \\, d\\theta = \\left[ \\frac{1}{2}\\sin^2\\theta \\right]_{0}^{\\pi/2} = \\frac{1}{2}\n$$\nSubstituting these results, the expression for heat flux simplifies to:\n$$\nq \\;=\\; (2\\pi) \\left(\\frac{1}{2}\\right) \\int_{0}^{\\infty} \\frac{1}{2} m_{e} v^{5} f(v) \\, dv \\;=\\; \\frac{\\pi m_e}{2} \\int_{0}^{\\infty} v^{5} f(v) \\, dv\n$$\nWe are asked to find the ratio $\\mathcal{R}(\\chi) = q_t/q_M$. Since both distributions $f_M(v)$ and $f_t(v)$ are isotropic, we can use the simplified expression for $q$.\n\nFor the full Maxwellian distribution $f_M(v)$, the heat flux is:\n$$\nq_{M} \\;=\\; \\frac{\\pi m_e}{2} \\int_{0}^{\\infty} v^{5} f_{M}(v) \\, dv\n$$\nFor the truncated Maxwellian distribution $f_t(v)$, the heat flux is:\n$$\nq_{t} \\;=\\; \\frac{\\pi m_e}{2} \\int_{0}^{\\infty} v^{5} f_{t}(v) \\, dv\n$$\nBy definition, $f_t(v) = f_M(v)$ for $v \\ge v_c$ and $f_t(v)=0$ for $v  v_c$. Thus, the integral for $q_t$ has a lower limit of $v_c$:\n$$\nq_{t} \\;=\\; \\frac{\\pi m_e}{2} \\int_{v_c}^{\\infty} v^{5} f_{M}(v) \\, dv\n$$\nThe ratio $\\mathcal{R}(\\chi)$ is therefore the ratio of the two integrals, as the prefactors cancel:\n$$\n\\mathcal{R}(\\chi) \\;=\\; \\frac{q_t}{q_M} \\;=\\; \\frac{\\frac{\\pi m_e}{2} \\int_{v_c}^{\\infty} v^{5} f_{M}(v) \\, dv}{\\frac{\\pi m_e}{2} \\int_{0}^{\\infty} v^{5} f_{M}(v) \\, dv} \\;=\\; \\frac{\\int_{v_c}^{\\infty} v^{5} f_{M}(v) \\, dv}{\\int_{0}^{\\infty} v^{5} f_{M}(v) \\, dv}\n$$\nThe Maxwellian distribution is $f_{M}(v) = n_{e}\\left(\\frac{m_{e}}{2\\pi k_{B} T_{e}}\\right)^{3/2}\\exp\\left(-\\frac{m_{e} v^{2}}{2 k_{B} T_{e}}\\right)$. The constant prefactor $n_{e}\\left(\\frac{m_{e}}{2\\pi k_{B} T_{e}}\\right)^{3/2}$ will also cancel from the numerator and denominator. Let's define a new variable $x = \\frac{m_e v^2}{2 k_B T_e}$. This gives $v = \\sqrt{\\frac{2 k_B T_e}{m_e} x}$ and $dv = \\frac{1}{2} \\sqrt{\\frac{2 k_B T_e}{m_e}} x^{-1/2} dx$.\nThe term $v^5$ becomes $\\left(\\frac{2 k_B T_e}{m_e}\\right)^{5/2} x^{5/2}$.\nThe term $v^5 dv$ becomes $\\left(\\frac{2 k_B T_e}{m_e}\\right)^{5/2} x^{5/2} \\frac{1}{2} \\sqrt{\\frac{2 k_B T_e}{m_e}} x^{-1/2} dx = \\frac{1}{2}\\left(\\frac{2 k_B T_e}{m_e}\\right)^3 x^2 dx$.\nThe exponential becomes $\\exp(-x)$.\nThe integrals become:\n$$\n\\int v^5 \\exp\\left(-\\frac{m_e v^2}{2 k_B T_e}\\right) dv \\;=\\; \\frac{1}{2}\\left(\\frac{2 k_B T_e}{m_e}\\right)^3 \\int x^2 \\exp(-x) dx\n$$\nThe prefactor $\\frac{1}{2}\\left(\\frac{2 k_B T_e}{m_e}\\right)^3$ is constant and will cancel in the ratio. We only need to consider the integrals over $x$.\n\nThe lower limit of integration in the numerator is $v_c = \\sqrt{2e\\Phi_s/m_e}$. In terms of $x$, this becomes:\n$$\nx_c \\;=\\; \\frac{m_e v_c^2}{2 k_B T_e} \\;=\\; \\frac{m_e}{2 k_B T_e} \\left(\\frac{2e\\Phi_s}{m_e}\\right) \\;=\\; \\frac{e\\Phi_s}{k_B T_e} \\;=\\; \\chi\n$$\nThe lower limit for the denominator integral is $v=0$, which corresponds to $x=0$.\nThe ratio $\\mathcal{R}(\\chi)$ is now:\n$$\n\\mathcal{R}(\\chi) \\;=\\; \\frac{\\int_{\\chi}^{\\infty} x^2 \\exp(-x) dx}{\\int_{0}^{\\infty} x^2 \\exp(-x) dx}\n$$\nThe denominator is the complete Gamma function, $\\Gamma(3)$:\n$$\n\\int_{0}^{\\infty} x^2 \\exp(-x) dx = \\Gamma(3) = (3-1)! = 2! = 2\n$$\nThe numerator is the upper incomplete Gamma function, $\\Gamma(3, \\chi)$. We can evaluate it by integration by parts twice:\n$$\n\\int x^2 \\exp(-x) dx = -x^2\\exp(-x) - \\int (- \\exp(-x))(2x) dx = -x^2\\exp(-x) + 2\\int x\\exp(-x) dx\n$$\n$$\n\\int x\\exp(-x) dx = -x\\exp(-x) - \\int(-\\exp(-x))dx = -x\\exp(-x) - \\exp(-x) = -(x+1)\\exp(-x)\n$$\nCombining these:\n$$\n\\int x^2 \\exp(-x) dx = -x^2\\exp(-x) + 2(-(x+1)\\exp(-x)) = (-x^2 - 2x - 2)\\exp(-x)\n$$\nNow we evaluate the definite integral for the numerator:\n$$\n\\int_{\\chi}^{\\infty} x^2 \\exp(-x) dx = \\left[ (-x^2 - 2x - 2)\\exp(-x) \\right]_{\\chi}^{\\infty}\n$$\nAs $x \\to \\infty$, the term evaluates to $0$. At the lower limit $x=\\chi$, the value is $(-\\chi^2 - 2\\chi - 2)\\exp(-\\chi)$.\n$$\n\\int_{\\chi}^{\\infty} x^2 \\exp(-x) dx = 0 - ((-\\chi^2 - 2\\chi - 2)\\exp(-\\chi)) = (\\chi^2 + 2\\chi + 2)\\exp(-\\chi)\n$$\nFinally, we compute the ratio $\\mathcal{R}(\\chi)$:\n$$\n\\mathcal{R}(\\chi) \\;=\\; \\frac{(\\chi^2 + 2\\chi + 2)\\exp(-\\chi)}{2} \\;=\\; \\frac{1}{2}(\\chi^2 + 2\\chi + 2)\\exp(-\\chi)\n$$\nThis is the final closed-form analytical expression for the ratio of the heat fluxes.",
            "answer": "$$\n\\boxed{\\frac{1}{2}(\\chi^{2} + 2\\chi + 2)\\exp(-\\chi)}\n$$"
        },
        {
            "introduction": "The final step in our journey from theory to application is to translate continuous mathematical models into a form that computers can handle. This computational practice addresses the essential task of creating a discrete representation of the Maxwellian velocity distribution, a foundational step in kinetic simulations. You will design a numerical grid and quadrature weights that not only conserve key physical quantities like density and temperature but also accurately capture the high-energy tail, which is vital for calculating rates of fusion reactions and other rare kinetic phenomena. ",
            "id": "3975349",
            "problem": "You are tasked with designing a velocity-space discretization with $N_v$ points to represent an isotropic Maxwellian equilibrium in a plasma and to specify quantitative criteria that ensure accurate capture of the exponential tail while conserving number density $n$ and temperature $T$. The design must start from first principles of kinetic theory and must treat the infinite velocity domain rigorously. The goal is to produce a program that constructs the discretization, computes conservative quadrature weights for velocity-space moments, and evaluates tail resolution criteria and conservation errors on a provided test suite.\n\nFundamental base for this task:\n- The isotropic Maxwellian distribution in three-dimensional velocity space is defined by a particle distribution function $f(\\mathbf{v})$, which depends on the speed $v = \\lVert \\mathbf{v} \\rVert$. The distribution must be integrated over $\\mathrm{d}^3 v$ to obtain macroscopic moments such as number density and temperature.\n- The number density satisfies $n = \\int f(\\mathbf{v}) \\, \\mathrm{d}^3 v$.\n- The temperature (expressed via kinetic energy per particle) satisfies $n \\, E_T = \\dfrac{m}{3} \\int v^2 f(\\mathbf{v}) \\, \\mathrm{d}^3 v$, where $m$ is the particle mass and $E_T = k_B T$ is the thermal energy per particle. Temperatures in this problem are specified in electronvolts and must be converted to joules using $E_T = T \\times q_e$, with $q_e = 1.602176634 \\times 10^{-19} \\ \\mathrm{J/eV}$.\n- The Maxwellian depends on the thermal speed through a parameter $a = \\dfrac{m}{2 E_T}$.\n\nDesign requirements:\n1. Construct a velocity-space grid $\\{ v_i \\}_{i=1}^{N_v}$ and associated positive quadrature weights $\\{ W_i \\}_{i=1}^{N_v}$ such that for any isotropic function $g(v)$, the integral over velocity space is approximated by\n   $$ \\int_0^{\\infty} 4\\pi v^2 g(v) \\, \\mathrm{d}v \\approx \\sum_{i=1}^{N_v} W_i \\, g(v_i). $$\n   The choice of $\\{ v_i, W_i \\}$ must be motivated by the structure of the Maxwellian and the infinite domain.\n2. State and enforce a quantitative tail-resolution criterion in terms of a tolerance $\\epsilon_{\\mathrm{tail}}$ that guarantees the grid extends into the region where the Maxwellian amplitude is below $\\epsilon_{\\mathrm{tail}}$. This criterion must be derived from the exponential decay scale of the Maxwellian and must be testable directly from the grid parameters. Express the criterion explicitly in terms of the largest grid abscissa and $\\epsilon_{\\mathrm{tail}}$.\n3. Demonstrate conservation by computing the discrete number density and temperature from the grid for the Maxwellian, and report the relative errors\n   $$ \\delta_n = \\left| \\frac{n_{\\mathrm{disc}} - n}{n} \\right|, \\qquad \\delta_T = \\left| \\frac{T_{\\mathrm{disc}} - T}{T} \\right|, $$\n   where $n_{\\mathrm{disc}} = \\sum_{i=1}^{N_v} W_i f(v_i)$ and $T_{\\mathrm{disc}}$ is obtained from the discrete second-order velocity moment via the relation $n \\, E_T = \\dfrac{m}{3} \\int v^2 f(\\mathbf{v}) \\, \\mathrm{d}^3 v$.\n\nProgram specifications:\n- Use the three-dimensional isotropic Maxwellian $f(v)$ consistent with the above kinetic theory definitions.\n- Convert temperatures from electronvolts to joules, i.e., use $E_T = T \\times q_e$, with $q_e = 1.602176634 \\times 10^{-19} \\ \\mathrm{J/eV}$.\n- Use the following test suite. Each test case is a tuple $(N_v, n, T, m, \\epsilon_{\\mathrm{tail}})$ with units:\n  - $N_v$: integer number of velocity grid points.\n  - $n$: number density in $\\mathrm{m}^{-3}$.\n  - $T$: temperature in $\\mathrm{eV}$.\n  - $m$: particle mass in $\\mathrm{kg}$.\n  - $\\epsilon_{\\mathrm{tail}}$: dimensionless tail tolerance (expressed as a decimal).\n  The test suite to be evaluated is:\n  1. $(16, \\ 1.0 \\times 10^{19} \\ \\mathrm{m}^{-3}, \\ 15000 \\ \\mathrm{eV}, \\ 3.343583719 \\times 10^{-27} \\ \\mathrm{kg}, \\ 1.0 \\times 10^{-10})$,\n  2. $(2, \\ 5.0 \\times 10^{18} \\ \\mathrm{m}^{-3}, \\ 20 \\ \\mathrm{eV}, \\ 9.1093837015 \\times 10^{-31} \\ \\mathrm{kg}, \\ 1.0 \\times 10^{-4})$,\n  3. $(3, \\ 1.0 \\times 10^{18} \\ \\mathrm{m}^{-3}, \\ 5000 \\ \\mathrm{eV}, \\ 5.006412 \\times 10^{-27} \\ \\mathrm{kg}, \\ 1.0 \\times 10^{-8})$,\n  4. $(1, \\ 1.0 \\times 10^{20} \\ \\mathrm{m}^{-3}, \\ 1000 \\ \\mathrm{eV}, \\ 1.67262192369 \\times 10^{-27} \\ \\mathrm{kg}, \\ 5.0 \\times 10^{-1})$.\n- For each test case, your program must construct the grid and weights, compute $(\\delta_n, \\delta_T)$, and evaluate the tail-resolution boolean\n  $$ b_{\\mathrm{tail}} = \\left( e^{-x_{\\max}} \\le \\epsilon_{\\mathrm{tail}} \\right), $$\n  where $x_{\\max}$ is the largest dimensionless abscissa corresponding to the velocity grid design.\n- Output format: Your program should produce a single line of output containing a list of per-test-case results, each result being a list of the form $[b_{\\mathrm{tail}}, \\delta_n, \\delta_T]$. The final output must be precisely a single line in the format\n  $$ [ [b_{\\mathrm{tail},1}, \\delta_{n,1}, \\delta_{T,1}], [b_{\\mathrm{tail},2}, \\delta_{n,2}, \\delta_{T,2}], [b_{\\mathrm{tail},3}, \\delta_{n,3}, \\delta_{T,3}], [b_{\\mathrm{tail},4}, \\delta_{n,4}, \\delta_{T,4}] ]. $$\nAll numerical outputs for errors must be dimensionless decimals. No angles are involved, so no angle units are required. Use the International System of Units (SI) for all physical inputs.",
            "solution": "The problem requires the design of a velocity-space discretization for an isotropic Maxwellian distribution, including the construction of quadrature points and weights that conserve particle number and energy, and a criterion for resolving the distribution's exponential tail. The solution must be derived from the first principles of kinetic theory.\n\nThe three-dimensional isotropic Maxwellian distribution function $f(\\mathbf{v})$ depends only on the speed $v = \\lVert \\mathbf{v} \\rVert$ and is given by\n$$ f(v) = n \\left(\\frac{m}{2\\pi E_T}\\right)^{3/2} \\exp\\left(-\\frac{m v^2}{2 E_T}\\right), $$\nwhere $n$ is the number density, $m$ is the particle mass, and $E_T = k_B T$ is the thermal energy. For this problem, temperatures are given in electronvolts and must be converted to joules using $E_T = T \\times q_e$, with $q_e = 1.602176634 \\times 10^{-19} \\ \\mathrm{J/eV}$. The distribution is normalized such that its integral over all velocity space yields the number density, $\\int f(\\mathbf{v}) \\, \\mathrm{d}^3v = n$. In spherical velocity coordinates, this integral is $\\int_0^\\infty 4\\pi v^2 f(v) \\, \\mathrm{d}v = n$.\n\nThe central task is to design a quadrature rule—a set of grid points (abscissae) $\\{v_i\\}_{i=1}^{N_v}$ and weights $\\{W_i\\}_{i=1}^{N_v}$—that accurately approximates integrals over the infinite velocity domain for isotropic functions $g(v)$:\n$$ \\mathcal{I}[g] = \\int_0^\\infty 4\\pi v^2 g(v) \\, \\mathrm{d}v \\approx \\sum_{i=1}^{N_v} W_i g(v_i). $$\nThe design must be motivated by the structure of the Maxwellian. The key insight is to perform a change of variables from speed $v$ to a dimensionless energy that simplifies the exponential term in the Maxwellian. Let the kinetic energy be $\\mathcal{E} = \\frac{1}{2} m v^2$, and define the dimensionless energy as $\\xi = \\mathcal{E}/E_T = \\frac{m v^2}{2 E_T}$. With this substitution, the exponential term becomes a simple $e^{-\\xi}$.\n\nWe transform the integral $\\mathcal{I}[g]$ using this change of variables. From $\\xi = \\frac{m v^2}{2 E_T}$, we have $v = \\sqrt{2 \\xi E_T / m}$ and $\\mathrm{d}v = \\sqrt{2 E_T / m} \\cdot \\frac{1}{2\\sqrt{\\xi}} \\, \\mathrm{d}\\xi$. The volume element $4\\pi v^2 \\, \\mathrm{d}v$ becomes:\n$$ 4\\pi v^2 \\, \\mathrm{d}v = 4\\pi \\left(\\frac{2 \\xi E_T}{m}\\right) \\left(\\sqrt{\\frac{2 E_T}{m}} \\frac{1}{2\\sqrt{\\xi}}\\right) \\, \\mathrm{d}\\xi = \\frac{4\\pi\\sqrt{2} E_T^{3/2}}{m^{3/2}} \\sqrt{\\xi} \\, \\mathrm{d}\\xi. $$\nThis integral form is not directly a weighted integral for which standard quadrature rules apply. However, we can construct a powerful quadrature by choosing nodes and weights based on generalized Gauss-Laguerre polynomials, which are orthogonal with respect to the weight function $x^\\alpha e^{-x}$. This choice is motivated by the fact that moments of the Maxwellian distribution, after the change of variables, result in integrals of the form $\\int_0^\\infty \\xi^k \\xi^{1/2} e^{-\\xi} d\\xi$. A generalized Gauss-Laguerre quadrature with parameter $\\alpha=1/2$ approximates integrals as:\n$$ \\int_0^\\infty x^{1/2} e^{-x} h(x) \\, \\mathrm{d}x \\approx \\sum_{j=1}^{N_v} w_j^{\\text{GLa}} h(x_j), $$\nwhere $\\{x_j, w_j^{\\text{GLa}}\\}$ are the standard Gauss-Laguerre abscissae and weights. To apply this to our general integral $\\mathcal{I}[g] = C \\int_0^\\infty \\xi^{1/2} g(\\dots) d\\xi$, where $C = \\frac{4\\pi\\sqrt{2} E_T^{3/2}}{m^{3/2}}$, we rewrite it by multiplying and dividing by $e^{-\\xi}$:\n$$ \\mathcal{I}[g] = C \\int_0^\\infty \\xi^{1/2} e^{-\\xi} \\left[ g\\left(\\sqrt{\\frac{2 \\xi E_T}{m}}\\right) e^{\\xi} \\right] \\, \\mathrm{d}\\xi. $$\nNow, we can apply the quadrature rule with $h(\\xi) = g(\\dots)e^\\xi$:\n$$ \\mathcal{I}[g] \\approx C \\sum_{j=1}^{N_v} w_j^{\\text{GLa}} \\left[ g\\left(\\sqrt{\\frac{2 \\xi_j E_T}{m}}\\right) e^{\\xi_j} \\right] = \\sum_{j=1}^{N_v} \\left( C w_j^{\\text{GLa}} e^{\\xi_j} \\right) g\\left(\\sqrt{\\frac{2 \\xi_j E_T}{m}}\\right). $$\nThis defines our velocity grid and weights:\n1.  **Velocity Abscissae**: $v_j = \\sqrt{\\frac{2 \\xi_j E_T}{m}}$, for $j=1, \\dots, N_v$.\n2.  **Quadrature Weights**: $W_j = \\frac{4\\pi\\sqrt{2} E_T^{3/2}}{m^{3/2}} w_j^{\\text{GLa}} e^{\\xi_j}$, for $j=1, \\dots, N_v$.\n\nWith this design, we can evaluate the conservation and tail resolution criteria.\n\n**Tail Resolution Criterion:**\nThe criterion checks if the grid extends sufficiently far into the tail of the Maxwellian distribution. The decay is governed by $e^{-\\xi}$. The problem specifies the criterion as $e^{-x_{\\max}} \\le \\epsilon_{\\mathrm{tail}}$, where $x_{\\max}$ is the largest dimensionless abscissa. In our design, the dimensionless abscissae are the roots $\\{\\xi_j\\}$ of the generalized Laguerre polynomial. Thus, we set $x_{\\max} = \\max(\\{\\xi_j\\})$. The boolean test is:\n$$ b_{\\mathrm{tail}} = \\left( \\exp(-\\max(\\{\\xi_j\\})) \\le \\epsilon_{\\mathrm{tail}} \\right). $$\n\n**Conservation of Number Density and Temperature:**\nThe discrete number density $n_{\\mathrm{disc}}$ is computed by applying the quadrature to the distribution function itself, i.e., setting $g(v) = f(v)$:\n$$ n_{\\mathrm{disc}} = \\sum_{j=1}^{N_v} W_j f(v_j). $$\nThe relative error in density conservation is $\\delta_n = |n_{\\mathrm{disc}}/n - 1|$.\n\nThe temperature is related to the second velocity moment of the distribution. The average kinetic energy is $\\frac{3}{2}E_T = \\frac{1}{n} \\int \\frac{1}{2} m v^2 f(\\mathbf{v}) \\, \\mathrm{d}^3v$. This rearranges to $n E_T = \\frac{m}{3} \\int v^2 f(v) 4\\pi v^2 \\, \\mathrm{d}v$. We compute the discrete thermal energy $E_{T, \\mathrm{disc}}$ from the discrete version of this moment:\n$$ n E_{T, \\mathrm{disc}} = \\frac{m}{3} \\sum_{j=1}^{N_v} W_j v_j^2 f(v_j). $$\nThis gives $E_{T, \\mathrm{disc}} = \\frac{m}{3n} \\sum_{j=1}^{N_v} W_j v_j^2 f(v_j)$. The corresponding discrete temperature is $T_{\\mathrm{disc}} = E_{T, \\mathrm{disc}} / q_e$. The relative error in temperature is $\\delta_T = |T_{\\mathrm{disc}}/T - 1| = |E_{T, \\mathrm{disc}}/E_T - 1|$.\n\nThe implementation will therefore consist of:\n1.  For each test case, calculate $E_T$.\n2.  Obtain the base abscissae $\\{\\xi_j\\}$ and weights $\\{w_j^{\\text{GLa}}\\}$ using `scipy.special.roots_genlaguerre(Nv, 0.5)`.\n3.  Construct the velocity grid $\\{v_j\\}$ and final weights $\\{W_j\\}$ according to the derived formulas.\n4.  Evaluate the Maxwellian $f(v_j)$ at the grid points.\n5.  Compute $n_{\\mathrm{disc}}$ and $E_{T, \\mathrm{disc}}$ via summation.\n6.  Calculate the relative errors $\\delta_n$ and $\\delta_T$.\n7.  Check the tail resolution criterion $b_{\\mathrm{tail}}$.\n8.  Format the results as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_genlaguerre\n\ndef solve():\n    \"\"\"\n    Designs a velocity-space discretization for an isotropic Maxwellian,\n    constructs conservative quadrature weights, and evaluates tail resolution\n    and conservation errors for a suite of test cases.\n    \"\"\"\n    # Physical constant\n    # Elementary charge in J/eV\n    q_e = 1.602176634e-19\n\n    # Test suite: (Nv, n, T, m, epsilon_tail)\n    test_cases = [\n        (16, 1.0e19, 15000.0, 3.343583719e-27, 1.0e-10),  # Deuterium-like\n        (2, 5.0e18, 20.0, 9.1093837015e-31, 1.0e-4),    # Electron-like\n        (3, 1.0e18, 5000.0, 5.006412e-27, 1.0e-8),      # Helium3-like\n        (1, 1.0e20, 1000.0, 1.67262192369e-27, 5.0e-1)     # Proton-like\n    ]\n\n    results = []\n    for Nv, n, T, m, epsilon_tail in test_cases:\n        # Step 1: Calculate thermal energy in Joules\n        E_T = T * q_e\n\n        # Step 2: Generate base abscissae and weights for generalized\n        # Gauss-Laguerre quadrature with alpha = 1/2.\n        # This is for integrals of the form integral(x^(1/2) * exp(-x) * h(x)) dx\n        xi, w_gla = roots_genlaguerre(Nv, 0.5)\n\n        # Step 3: Construct the velocity grid and final quadrature weights\n        # v_j = sqrt(2 * xi_j * E_T / m)\n        v = np.sqrt(2 * xi * E_T / m)\n        \n        # W_j = (4*pi*sqrt(2)*E_T^(3/2) / m^(3/2)) * w_gla_j * exp(xi_j)\n        weight_factor = (4 * np.pi * np.sqrt(2) * E_T**1.5) / (m**1.5)\n        W = weight_factor * w_gla * np.exp(xi)\n\n        # Step 4: Define and evaluate the Maxwellian distribution function\n        # f(v) = n * (m / (2*pi*E_T))^(3/2) * exp(-m*v^2 / (2*E_T))\n        norm_const = n * (m / (2 * np.pi * E_T))**1.5\n        # Note: m*v^2/(2*E_T) is just xi\n        f_vals = norm_const * np.exp(-xi)\n\n        # Step 5: Compute discrete number density and its relative error\n        n_disc = np.sum(W * f_vals)\n        delta_n = np.abs(n_disc / n - 1.0)\n\n        # Step 6: Compute discrete temperature and its relative error\n        # E_T_disc = (m / (3*n)) * sum(W_j * v_j^2 * f(v_j))\n        moment_2 = np.sum(W * v**2 * f_vals)\n        E_T_disc = (m / (3.0 * n)) * moment_2\n        delta_T = np.abs(E_T_disc / E_T - 1.0)\n\n        # Step 7: Evaluate the tail-resolution criterion\n        # b_tail = (exp(-max(xi)) = epsilon_tail)\n        x_max = np.max(xi)\n        b_tail = bool(np.exp(-x_max) = epsilon_tail)\n\n        # Step 8: Store the results for this test case\n        results.append([b_tail, delta_n, delta_T])\n\n    # Final print statement in the exact required format.\n    # Convert boolean to lowercase string for JSON-like format\n    formatted_results = []\n    for res in results:\n        b, dn, dt = res\n        b_str = 'true' if b else 'false'\n        formatted_results.append(f\"[{b_str},{dn:.15e},{dt:.15e}]\")\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}