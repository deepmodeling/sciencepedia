{
    "hands_on_practices": [
        {
            "introduction": "A foundational concept in burning plasma physics is the steady-state power balance, which dictates the conditions required for a self-sustaining fusion reaction. This exercise introduces a simplified \"zero-dimensional\" model to explore this balance, treating the plasma as a uniform entity. By analyzing the interplay between alpha particle heating, external power injection, and energy losses, you will quantify the heating requirements for a reactor-scale plasma and investigate the impact of \"alpha channeling,\" an advanced concept for redirecting fusion energy to optimize performance .",
            "id": "3956393",
            "problem": "A spatially uniform, magnetically confined, deuterium–tritium (D–T) burning plasma is modeled with separate ion and electron energy balances. The plasma volume is $V = 800\\,\\text{m}^{3}$ and the electron density is $n_{e} = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$. The ion and electron temperatures are held fixed at $T_{i} = T_{e} = 15\\,\\text{keV}$. Assume a $50/50$ deuterium–tritium mixture so that $n_{D} = n_{T} = n_{i}/2$ with $n_{i} = n_{e}$. The deuterium–tritium fusion reactivity at $T_{i} = 15\\,\\text{keV}$ is $\\langle \\sigma v \\rangle = 1.0 \\times 10^{-22}\\,\\text{m}^{3}\\,\\text{s}^{-1}$. Each fusion reaction produces an alpha particle carrying energy $E_{\\alpha} = 3.5\\,\\text{MeV}$. The total bremsstrahlung power loss (which is entirely from the electrons) at $T_{e} = 15\\,\\text{keV}$ is $P_{\\text{rad}} = 16.5\\,\\text{MW}$. The ion and electron transport power losses are modeled as $P_{i,\\text{trans}} = W_{i}/\\tau_{i}$ and $P_{e,\\text{trans}} = W_{e}/\\tau_{e}$ with $\\tau_{i} = 3.5\\,\\text{s}$ and $\\tau_{e} = 2.5\\,\\text{s}$, where $W_{s} = \\frac{3}{2} n_{s} V k_{B} T_{s}$ for species $s \\in \\{i,e\\}$ and $k_{B}$ is the Boltzmann constant. Neglect all impurity radiation and assume that the ion–electron collisional energy exchange term vanishes at steady state because $T_{i} = T_{e}$.\n\nConsider two steady-state cases for alpha particle energy deposition:\n- Case A (no channeling): all alpha energy is deposited to the electrons.\n- Case B (alpha channeling): a fraction $f = 0.30$ of the total alpha power is deposited directly to the ions, with the remaining fraction $1 - f$ deposited to the electrons.\n\nUsing first-principles two-temperature steady-state power balances for ions and electrons, compute the modification in the required external electron heating power between Case B and Case A, that is, compute $P_{e,\\text{ext}}^{(B)} - P_{e,\\text{ext}}^{(A)}$. Express your final answer in $\\text{MW}$ and round to three significant figures.",
            "solution": "We begin from the separate ion and electron thermal energy definitions and steady-state power balances. For species $s \\in \\{i,e\\}$, the stored thermal energy is\n$$\nW_{s} = \\frac{3}{2} n_{s} V k_{B} T_{s},\n$$\nand the transport loss power is\n$$\nP_{s,\\text{trans}} = \\frac{W_{s}}{\\tau_{s}}.\n$$\nAt steady state and with $T_{i} = T_{e}$, the ion–electron collisional exchange power vanishes, so the balances reduce to\n$$\n\\begin{aligned}\n\\text{Ions:}\\quad  0 = P_{\\alpha \\rightarrow i} + P_{i,\\text{ext}} - P_{i,\\text{trans}}, \\\\\n\\text{Electrons:}\\quad  0 = P_{\\alpha \\rightarrow e} + P_{e,\\text{ext}} - P_{e,\\text{trans}} - P_{\\text{rad}}.\n\\end{aligned}\n$$\nHere $P_{\\alpha \\rightarrow i}$ and $P_{\\alpha \\rightarrow e}$ denote the fractions of the total alpha power $P_{\\alpha}$ deposited to ions and electrons, respectively, with $P_{\\alpha \\rightarrow i} + P_{\\alpha \\rightarrow e} = P_{\\alpha}$.\n\nFirst, compute the total alpha power $P_{\\alpha}$ from the fusion reactivity. With a $50/50$ deuterium–tritium mixture,\n$$\nn_{D} = n_{T} = \\frac{n_{i}}{2} = \\frac{n_{e}}{2}.\n$$\nThe total fusion reaction rate is\n$$\nR = n_{D} n_{T} \\langle \\sigma v \\rangle V = \\left(\\frac{n_{e}}{2}\\right)^{2} \\langle \\sigma v \\rangle V.\n$$\nSubstituting the given values,\n$$\nn_{e} = 1.0 \\times 10^{20}\\,\\text{m}^{-3},\\quad \\langle \\sigma v \\rangle = 1.0 \\times 10^{-22}\\,\\text{m}^{3}\\,\\text{s}^{-1},\\quad V = 800\\,\\text{m}^{3},\n$$\nwe find\n$$\nR = \\left( \\frac{1.0 \\times 10^{20}}{2} \\right)^{2} \\left( 1.0 \\times 10^{-22} \\right) \\left( 800 \\right)\n= \\left( 5.0 \\times 10^{19} \\right)^{2} \\times 1.0 \\times 10^{-22} \\times 800\n= 2.5 \\times 10^{39} \\times 10^{-22} \\times 800\n= 2.0 \\times 10^{20}\\,\\text{s}^{-1}.\n$$\nEach fusion reaction yields an alpha particle with energy $E_{\\alpha} = 3.5\\,\\text{MeV} = 3.5 \\times 10^{6}\\,\\text{eV}$. Converting to Joules using $1\\,\\text{eV} = 1.602 \\times 10^{-19}\\,\\text{J}$,\n$$\nE_{\\alpha} = 3.5 \\times 10^{6} \\times 1.602 \\times 10^{-19}\\,\\text{J} = 5.607 \\times 10^{-13}\\,\\text{J}.\n$$\nThus the total alpha power is\n$$\nP_{\\alpha} = R E_{\\alpha} = \\left( 2.0 \\times 10^{20}\\,\\text{s}^{-1} \\right) \\left( 5.607 \\times 10^{-13}\\,\\text{J} \\right)\n= 1.1214 \\times 10^{8}\\,\\text{W} = 112.14\\,\\text{MW}.\n$$\n\nNext, compute the transport loss powers $P_{i,\\text{trans}}$ and $P_{e,\\text{trans}}$. The stored energies for ions and electrons are equal because $n_{i} = n_{e}$ and $T_{i} = T_{e}$:\n$$\nW_{e} = \\frac{3}{2} n_{e} V k_{B} T_{e}, \\qquad W_{i} = \\frac{3}{2} n_{i} V k_{B} T_{i} = W_{e}.\n$$\nNumerically,\n$$\nk_{B} T_{e} = \\left( 1.602 \\times 10^{-19}\\,\\text{J/eV} \\right) \\left( 1.5 \\times 10^{4}\\,\\text{eV} \\right) = 2.403 \\times 10^{-15}\\,\\text{J},\n$$\nand\n$$\nn_{e} V = \\left( 1.0 \\times 10^{20}\\,\\text{m}^{-3} \\right) \\left( 800\\,\\text{m}^{3} \\right) = 8.0 \\times 10^{22}.\n$$\nTherefore\n$$\nW_{e} = \\frac{3}{2} \\left( 8.0 \\times 10^{22} \\right) \\left( 2.403 \\times 10^{-15}\\,\\text{J} \\right)\n= \\frac{3}{2} \\left( 1.9224 \\times 10^{8}\\,\\text{J} \\right)\n= 2.8836 \\times 10^{8}\\,\\text{J}.\n$$\nWith $\\tau_{e} = 2.5\\,\\text{s}$ and $\\tau_{i} = 3.5\\,\\text{s}$,\n$$\nP_{e,\\text{trans}} = \\frac{W_{e}}{\\tau_{e}} = \\frac{2.8836 \\times 10^{8}\\,\\text{J}}{2.5\\,\\text{s}} = 1.15344 \\times 10^{8}\\,\\text{W} = 115.344\\,\\text{MW},\n$$\n$$\nP_{i,\\text{trans}} = \\frac{W_{i}}{\\tau_{i}} = \\frac{2.8836 \\times 10^{8}\\,\\text{J}}{3.5\\,\\text{s}} = 8.23886 \\times 10^{7}\\,\\text{W} = 82.3886\\,\\text{MW}.\n$$\n\nNow write the steady-state electron power balance in each case.\n\nCase A (no channeling): $P_{\\alpha \\rightarrow e}^{(A)} = P_{\\alpha}$ and $P_{\\alpha \\rightarrow i}^{(A)} = 0$. The electron balance gives\n$$\n0 = P_{\\alpha} + P_{e,\\text{ext}}^{(A)} - P_{e,\\text{trans}} - P_{\\text{rad}} \\quad \\Rightarrow \\quad\nP_{e,\\text{ext}}^{(A)} = P_{e,\\text{trans}} + P_{\\text{rad}} - P_{\\alpha}.\n$$\n\nCase B (fraction $f$ channeled to ions): $P_{\\alpha \\rightarrow i}^{(B)} = f P_{\\alpha}$ and $P_{\\alpha \\rightarrow e}^{(B)} = (1 - f) P_{\\alpha}$. The electron balance gives\n$$\n0 = (1 - f) P_{\\alpha} + P_{e,\\text{ext}}^{(B)} - P_{e,\\text{trans}} - P_{\\text{rad}} \\quad \\Rightarrow \\quad\nP_{e,\\text{ext}}^{(B)} = P_{e,\\text{trans}} + P_{\\text{rad}} - (1 - f) P_{\\alpha}.\n$$\n\nThe requested modification in required external electron heating is\n$$\n\\Delta P_{e,\\text{ext}} \\equiv P_{e,\\text{ext}}^{(B)} - P_{e,\\text{ext}}^{(A)} = \\left[ P_{e,\\text{trans}} + P_{\\text{rad}} - (1 - f) P_{\\alpha} \\right] - \\left[ P_{e,\\text{trans}} + P_{\\text{rad}} - P_{\\alpha} \\right] = f P_{\\alpha}.\n$$\nThus, the modification depends only on the channeled fraction and the total alpha power. With $f = 0.30$ and $P_{\\alpha} = 112.14\\,\\text{MW}$,\n$$\n\\Delta P_{e,\\text{ext}} = f P_{\\alpha} = 0.30 \\times 112.14\\,\\text{MW} = 33.642\\,\\text{MW}.\n$$\nRounded to three significant figures and expressed in $\\text{MW}$, the modification is $33.6\\,\\text{MW}$.",
            "answer": "$$\\boxed{33.6}$$"
        },
        {
            "introduction": "While zero-dimensional models provide valuable global insights, real fusion plasmas have complex spatial structures. This practice moves to a one-dimensional analysis to explore how the shapes of the density and temperature profiles affect the distribution of alpha particle heating. Due to the strong, non-linear dependence of the fusion reactivity $\\langle \\sigma v \\rangle$ on temperature, this exercise demonstrates why a centrally peaked temperature profile is significantly more effective at generating a concentrated core heating source than a peaked density profile, a critical consideration for reactor design and operation .",
            "id": "3956500",
            "problem": "A toroidal Deuterium–Tritium (D–T) fusion plasma of large aspect ratio has major radius $R_{0}$ and minor radius $a$. Assume axisymmetric, flux-surface-averaged quantities depend only on the minor radius $r \\in [0,a]$ and define the normalized radius $x = r/a$. The plasma is equimolar, so $n_{D}(r) = n_{T}(r) = n(r)/2$. The fusion alpha birth source density is given by the standard definition $S_{\\alpha}(r) = n_{D}(r)\\,n_{T}(r)\\,\\langle \\sigma v \\rangle(T(r))$ where $\\langle \\sigma v \\rangle(T)$ is the reactivity. In the temperature range relevant for burning plasmas, approximate the reactivity by a power law $\\langle \\sigma v \\rangle(T) = K\\,T(r)^{\\nu}$ with constants $K0$ and exponent $\\nu0$.\n\nConsider two otherwise identical plasmas with the same central density $n_{0}$ and central temperature $T_{0}$ but different profile shapes:\n\n1. Density-peaked case with $n(r) = n_{0}\\,[1 - x^{2}]^{\\alpha_{p}}$ and $T(r) = T_{0}$.\n2. Temperature-peaked case with $n(r) = n_{0}$ and $T(r) = T_{0}\\,[1 - x^{2}]^{\\beta_{p}}$.\n\nAssume local alpha energy deposition in the slowing-down limit so that the alpha heating density $H_{\\alpha}(r)$ is proportional to $S_{\\alpha}(r)$, and use the large-aspect-ratio torus approximation where the differential volume element scales as $dV \\propto r\\,dr$. As a measure of the heating distribution width, define the cross-section-weighted mean-square radius of the heating profile by\n$$\n\\langle r^{2} \\rangle \\equiv \\frac{\\int_{0}^{a} r^{2}\\,H_{\\alpha}(r)\\,r\\,dr}{\\int_{0}^{a} H_{\\alpha}(r)\\,r\\,dr}.\n$$\nCompute, in closed analytic form, the ratio\n$$\n\\mathcal{R} \\equiv \\frac{\\langle r^{2} \\rangle_{\\text{temperature-peaked}}}{\\langle r^{2} \\rangle_{\\text{density-peaked}}}\n$$\nas a function of the peaking exponents $\\alpha_{p}$, $\\beta_{p}$, and the reactivity exponent $\\nu$. Your final answer must be a single closed-form expression. No rounding is required and no units should be included in the final expression.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of fusion plasma physics, well-posed with sufficient information for a unique solution, and expressed in objective, formal language. We may therefore proceed with the solution.\n\nThe alpha birth source density $S_{\\alpha}(r)$ is given by\n$$\nS_{\\alpha}(r) = n_{D}(r)\\,n_{T}(r)\\,\\langle \\sigma v \\rangle(T(r))\n$$\nGiven an equimolar Deuterium-Tritium (D-T) plasma, $n_{D}(r) = n_{T}(r) = n(r)/2$. The reactivity is approximated by a power law, $\\langle \\sigma v \\rangle(T) = K\\,T(r)^{\\nu}$. Substituting these into the source definition yields\n$$\nS_{\\alpha}(r) = \\left(\\frac{n(r)}{2}\\right) \\left(\\frac{n(r)}{2}\\right) K\\,T(r)^{\\nu} = \\frac{K}{4} n(r)^2 T(r)^{\\nu}\n$$\nThe problem states that the alpha heating density $H_{\\alpha}(r)$ is proportional to $S_{\\alpha}(r)$, so we can write $H_{\\alpha}(r) = C' S_{\\alpha}(r)$ for some constant $C'$. The cross-section-weighted mean-square radius is defined as\n$$\n\\langle r^{2} \\rangle \\equiv \\frac{\\int_{0}^{a} r^{2}\\,H_{\\alpha}(r)\\,r\\,dr}{\\int_{0}^{a} H_{\\alpha}(r)\\,r\\,dr} = \\frac{\\int_{0}^{a} r^{3}\\,S_{\\alpha}(r)\\,dr}{\\int_{0}^{a} r\\,S_{\\alpha}(r)\\,dr}\n$$\nThe constant prefactor $C'K/4$ in $S_{\\alpha}(r)$ will cancel from the numerator and denominator, so we can omit it from the calculation.\n\nIt is convenient to work with the normalized radius $x=r/a$. The differential relationship is $dr = a\\,dx$. The integration limits for $x$ are from $0$ to $1$.\n$$\n\\langle r^{2} \\rangle = \\frac{\\int_{0}^{1} (ax)^{3}\\,S_{\\alpha}(x)\\,a\\,dx}{\\int_{0}^{1} (ax)\\,S_{\\alpha}(x)\\,a\\,dx} = \\frac{a^4 \\int_{0}^{1} x^{3}\\,S_{\\alpha}(x)\\,dx}{a^2 \\int_{0}^{1} x\\,S_{\\alpha}(x)\\,dx} = a^2 \\frac{\\int_{0}^{1} x^{3}\\,S_{\\alpha}(x)\\,dx}{\\int_{0}^{1} x\\,S_{\\alpha}(x)\\,dx}\n$$\nWe will now evaluate this expression for the two specified cases.\n\nCase 1: Density-peaked plasma\nThe density and temperature profiles are given by $n(r) = n_{0}\\,[1 - x^{2}]^{\\alpha_{p}}$ and $T(r) = T_{0}$. The source term, neglecting constant factors like $n_0$ and $T_0$ which will cancel, is\n$$\nS_{\\alpha, \\text{dp}}(x) \\propto (n(x))^2 (T(x))^{\\nu} \\propto \\left( [1-x^2]^{\\alpha_p} \\right)^2 (T_0)^{\\nu} \\propto [1-x^2]^{2\\alpha_p}\n$$\nLet's define a general integral form that appears in the calculation of $\\langle r^2 \\rangle$. The numerator and denominator integrals are of the form $\\int_0^1 x^m (1-x^2)^\\gamma dx$. Let $u = x^2$, so $du = 2x\\,dx$ or $x\\,dx = du/2$.\n$$\n\\int_0^1 x (1-x^2)^\\gamma dx = \\int_0^1 (1-u)^\\gamma \\frac{du}{2} = \\frac{1}{2} \\left[ -\\frac{(1-u)^{\\gamma+1}}{\\gamma+1} \\right]_0^1 = \\frac{1}{2(\\gamma+1)}\n$$\n$$\n\\int_0^1 x^3 (1-x^2)^\\gamma dx = \\int_0^1 x^2 (1-x^2)^\\gamma (x\\,dx) = \\int_0^1 u(1-u)^\\gamma \\frac{du}{2}\n$$\nThis is $\\frac{1}{2}$ times the Beta function $B(2, \\gamma+1) = \\frac{\\Gamma(2)\\Gamma(\\gamma+1)}{\\Gamma(2+\\gamma+1)} = \\frac{1!\\Gamma(\\gamma+1)}{(\\gamma+2)(\\gamma+1)\\Gamma(\\gamma+1)} = \\frac{1}{(\\gamma+1)(\\gamma+2)}$.\nSo, the integral is $\\frac{1}{2(\\gamma+1)(\\gamma+2)}$.\nThe ratio of these integrals is\n$$\n\\frac{\\int_{0}^{1} x^{3}\\,(1-x^2)^\\gamma\\,dx}{\\int_{0}^{1} x\\,(1-x^2)^\\gamma\\,dx} = \\frac{1/(2(\\gamma+1)(\\gamma+2))}{1/(2(\\gamma+1))} = \\frac{1}{\\gamma+2}\n$$\nFor the density-peaked case, the exponent of the source profile is $\\gamma_{\\text{dp}} = 2\\alpha_p$. Therefore,\n$$\n\\langle r^{2} \\rangle_{\\text{density-peaked}} = a^2 \\frac{1}{2\\alpha_p+2}\n$$\n\nCase 2: Temperature-peaked plasma\nThe density and temperature profiles are given by $n(r) = n_{0}$ and $T(r) = T_{0}\\,[1 - x^{2}]^{\\beta_{p}}$. The source term, again neglecting constants, is\n$$\nS_{\\alpha, \\text{tp}}(x) \\propto (n(x))^2 (T(x))^{\\nu} \\propto (n_0)^2 \\left( [1-x^2]^{\\beta_p} \\right)^{\\nu} \\propto [1-x^2]^{\\nu\\beta_p}\n$$\nThe functional form is identical to the previous case. The exponent of the source profile is $\\gamma_{\\text{tp}} = \\nu\\beta_p$.\nUsing the same general result derived above, we find\n$$\n\\langle r^{2} \\rangle_{\\text{temperature-peaked}} = a^2 \\frac{1}{\\nu\\beta_p+2}\n$$\n\nFinally, we compute the ratio $\\mathcal{R}$ as requested:\n$$\n\\mathcal{R} \\equiv \\frac{\\langle r^{2} \\rangle_{\\text{temperature-peaked}}}{\\langle r^{2} \\rangle_{\\text{density-peaked}}} = \\frac{a^2 \\frac{1}{\\nu\\beta_p+2}}{a^2 \\frac{1}{2\\alpha_p+2}}\n$$\n$$\n\\mathcal{R} = \\frac{2\\alpha_p+2}{\\nu\\beta_p+2}\n$$\nThis expression provides the ratio of the mean-square radii of the heating profiles as a function of the density peaking exponent $\\alpha_p$, the temperature peaking exponent $\\beta_p$, and the reactivity exponent $\\nu$.",
            "answer": "$$\\boxed{\\frac{2\\alpha_p+2}{\\nu\\beta_p+2}}$$"
        },
        {
            "introduction": "The previous exercises utilized a given value for the thermonuclear reaction rate coefficient, $\\langle \\sigma v \\rangle$, the central parameter governing fusion power output. This final, capstone practice challenges you to derive this quantity from first principles. You will develop a numerical tool to calculate $\\langle \\sigma v \\rangle$ by integrating fundamental nuclear cross-section data over the thermal distribution of interacting particles, a task that requires careful analytical transformation, robust numerical quadrature, and statistically sound uncertainty propagation. This exercise provides direct, hands-on experience with the computational methods that bridge fundamental data to macroscopic plasma behavior .",
            "id": "3956420",
            "problem": "You are tasked with designing and implementing a numerical quadrature strategy to compute the thermonuclear reaction rate coefficient for a burning plasma, defined by the integral of the product of the collisional cross section, the relative speed, and the energy-space Maxwell–Boltzmann probability density. The fundamental base is that the reaction rate coefficient is defined from first principles by the integral over the relative speed distribution and the relation between kinetic energy and speed. Begin from the following core definitions:\n- The Maxwell–Boltzmann distribution for the relative speed of two particles with reduced mass $\\mu$ at temperature $T$ is $f_v(v;T)$, a well-tested result from kinetic theory. The energy–speed relation is $E = \\frac{1}{2}\\,\\mu\\,v^2$, and the reaction rate coefficient is defined by $\\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(v)\\, v\\, f_v(v;T)\\, dv$.\n- The reaction cross section is tabulated as a function of center-of-mass kinetic energy $E$ with uncertainties.\n\nYour program must derive, from these base facts, a computationally sound and efficient quadrature strategy that:\n- Transforms the integral into a numerically stable form in energy space and then to a dimensionless variable that isolates the exponential weight originating from thermal statistics.\n- Accurately interpolates $\\sigma(E)$ from tabulated $(E_i,\\sigma_i)$ with associated independent fractional one-sigma uncertainties $u_i$, enforcing physical positivity of $\\sigma(E)$ and providing reasonable extrapolation outside the tabulated range when needed by the quadrature nodes.\n- Propagates the tabulated uncertainties to the final $\\langle \\sigma v \\rangle$ as a mean and a one-sigma standard deviation using a statistically justifiable approach.\n\nPhysical units and constants to use:\n- All temperatures in the test suite are specified in $\\mathrm{keV}$ and must be converted to $k_B T$ in $\\mathrm{J}$ using $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$, so $1\\,\\mathrm{keV} = 10^3\\,\\mathrm{eV}$.\n- Cross sections are specified in barns and must be converted to $\\mathrm{m}^2$ using $1\\,\\mathrm{barn} = 10^{-28}\\,\\mathrm{m}^2$.\n- The reduced mass $\\mu$ must be computed from the deuterium–tritium pair with $m_D = 2.013553212745\\,\\mathrm{u}$ and $m_T = 3.01550071632\\,\\mathrm{u}$, where $1\\,\\mathrm{u} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$.\n- The Boltzmann constant is $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$.\n- The final reaction rate coefficient $\\langle \\sigma v \\rangle$ must be reported in $\\mathrm{m}^3/\\mathrm{s}$.\n\nTabulated cross section data for a physically plausible deuterium–tritium reaction (energy in $\\mathrm{keV}$, cross section in barns, uncertainty as fractional one-sigma decimal):\n- $(E_i,\\sigma_i,u_i)$ for $i=1,\\dots,6$:\n  - $(1, 1.0\\times 10^{-3}, 0.20)$\n  - $(5, 5.0\\times 10^{-2}, 0.10)$\n  - $(10, 2.0\\times 10^{-1}, 0.10)$\n  - $(20, 1.0, 0.05)$\n  - $(50, 4.5, 0.05)$\n  - $(100, 3.0, 0.10)$\n\nUncertainty propagation requirement:\n- Treat the tabulated uncertainties $u_i$ as independent fractional one-sigma uncertainties. Your program must compute the resulting mean and one-sigma standard deviation of $\\langle \\sigma v \\rangle$ by applying a statistically coherent procedure that ensures $\\sigma(E)0$ at all energies during sampling.\n\nNumerical quadrature requirement:\n- Your strategy must be principled: derive an integral representation in terms of a dimensionless variable that exposes an exponential weight and select a quadrature that matches this weight. Your implementation must justify the choice and perform the corresponding interpolation of $\\sigma(E)$ at the quadrature nodes.\n- Your interpolation should be shape-preserving and monotone in log-log space to reflect typical cross section behavior and preserve positivity. Extrapolation beyond the tabulated range must be handled in a way that remains physically plausible given the thermal weighting.\n\nYour program must implement the above and compute the following test suite. Use the same tabulated cross section and reduced mass for all test cases, varying only the plasma temperature:\n- Test temperatures $T$ in $\\mathrm{keV}$:\n  - $0.1$\n  - $0.5$\n  - $10$\n  - $50$\n\nFor each test temperature, compute:\n- The nominal $\\langle \\sigma v \\rangle$ in $\\mathrm{m}^3/\\mathrm{s}$ and its one-sigma uncertainty in $\\mathrm{m}^3/\\mathrm{s}$, both as floating-point numbers.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be flattened in the order $[\\mathrm{mean}_{T_1},\\mathrm{std}_{T_1},\\mathrm{mean}_{T_2},\\mathrm{std}_{T_2},\\mathrm{mean}_{T_3},\\mathrm{std}_{T_3},\\mathrm{mean}_{T_4},\\mathrm{std}_{T_4}]$.\n- All values must be expressed in $\\mathrm{m}^3/\\mathrm{s}$.\n\nAngle units are not involved. If any intermediate angles are used during derivations, they must be treated in radians, but no angles appear in the required computation.\n\nScientific realism and constraints:\n- Ensure that the quadrature, interpolation, and uncertainty propagation adhere to principles from kinetic theory and numerical analysis and are self-consistent.\n- Do not assume any shortcut formulas in the problem statement for the target integral. Base your derivation and algorithm exclusively on the fundamental definitions stated above.\n\nYour implementation must be deterministic and self-contained, without reading any input files. You may choose reasonable numerical parameters such as the number of quadrature nodes and the number of uncertainty samples, but justify them in the solution. The final output must be in $\\mathrm{m}^3/\\mathrm{s}$, expressed as floating-point numbers.",
            "solution": "The problem requires the design and implementation of a numerical strategy to compute the thermonuclear reaction rate coefficient, $\\langle \\sigma v \\rangle$, for a deuterium-tritium plasma. This involves evaluating an integral over the particle energy distribution, using tabulated cross-section data with uncertainties. The solution is developed from first principles, encompassing an analytical transformation of the governing integral, a robust numerical quadrature scheme, a physically-motivated interpolation of the cross-section data, and a statistically sound method for uncertainty propagation.\n\n### 1. Analytical Formulation of the Reaction Rate Integral\n\nThe reaction rate coefficient is fundamentally defined as the average of the product of the reaction cross section, $\\sigma$, and the relative particle speed, $v$, over the normalized distribution of relative speeds, $f_v(v;T)$. The temperature is given in energy units, which we denote by $\\mathcal{T}$.\n$$\n\\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(v) v f_v(v;\\mathcal{T}) dv\n$$\nFor a system in thermal equilibrium, the distribution of relative speeds between two particle species with a reduced mass $\\mu$ at a thermal energy $\\mathcal{T}$ (equivalent to $k_B T$) is the three-dimensional Maxwell-Boltzmann speed distribution:\n$$\nf_v(v;\\mathcal{T}) = 4\\pi v^2 \\left(\\frac{\\mu}{2\\pi \\mathcal{T}}\\right)^{3/2} \\exp\\left(-\\frac{\\mu v^2}{2\\mathcal{T}}\\right)\n$$\nSubstituting this distribution into the definition of $\\langle \\sigma v \\rangle$ yields:\n$$\n\\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(v) v \\left[ 4\\pi v^2 \\left(\\frac{\\mu}{2\\pi \\mathcal{T}}\\right)^{3/2} \\exp\\left(-\\frac{\\mu v^2}{2\\mathcal{T}}\\right) \\right] dv\n$$\n$$\n\\langle \\sigma v \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi \\mathcal{T}}\\right)^{3/2} \\int_0^\\infty \\sigma(v) v^3 \\exp\\left(-\\frac{\\mu v^2}{2\\mathcal{T}}\\right) dv\n$$\nThe cross-section data, $\\sigma$, is provided as a function of the center-of-mass kinetic energy, $E$. The relationship between energy and relative speed is $E = \\frac{1}{2}\\mu v^2$. We perform a change of variables from speed $v$ to energy $E$:\n$$\nv = \\sqrt{\\frac{2E}{\\mu}}, \\quad dv = \\frac{1}{2} \\sqrt{\\frac{2}{\\mu E}} dE = \\frac{dE}{\\sqrt{2\\mu E}}\n$$\nWith this change of variables, the term $v^3 dv$ transforms as:\n$$\nv^3 dv = \\left(\\frac{2E}{\\mu}\\right)^{3/2} \\frac{dE}{\\sqrt{2\\mu E}} = \\frac{2^{3/2} E^{3/2}}{\\mu^{3/2}} \\frac{1}{2^{1/2} \\mu^{1/2} E^{1/2}} dE = \\frac{2E}{\\mu^2} dE\n$$\nThe exponential term becomes $\\exp(-E/\\mathcal{T})$. Substituting these into the integral gives:\n$$\n\\langle \\sigma v \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi \\mathcal{T}}\\right)^{3/2} \\int_0^\\infty \\sigma(E) \\frac{2E}{\\mu^2} \\exp\\left(-\\frac{E}{\\mathcal{T}}\\right) dE\n$$\nSimplifying the constant pre-factor:\n$$\n4\\pi \\left(\\frac{\\mu}{2\\pi \\mathcal{T}}\\right)^{3/2} \\frac{2}{\\mu^2} = \\frac{8\\pi \\mu^{3/2}}{(2\\pi)^{3/2} \\mathcal{T}^{3/2} \\mu^2} = \\frac{2^3 \\pi}{2^{3/2} \\pi^{3/2} \\mu^{1/2} \\mathcal{T}^{3/2}} = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{\\mathcal{T}^{3/2}}\n$$\nThis leads to the standard energy-space representation of the reaction rate coefficient:\n$$\n\\langle \\sigma v \\rangle = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{\\mathcal{T}^{3/2}} \\int_0^\\infty \\sigma(E) E \\exp\\left(-\\frac{E}{\\mathcal{T}}\\right) dE\n$$\nTo obtain a dimensionless integral suitable for standard numerical quadrature, we introduce the dimensionless variable $x = E/\\mathcal{T}$. This gives $E = x\\mathcal{T}$ and $dE = \\mathcal{T}dx$. The integral becomes:\n$$\n\\langle \\sigma v \\rangle = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{\\mathcal{T}^{3/2}} \\int_0^\\infty \\sigma(x\\mathcal{T}) (x\\mathcal{T}) \\exp(-x) (\\mathcal{T}dx)\n$$\n$$\n\\langle \\sigma v \\rangle = \\sqrt{\\frac{8\\mathcal{T}}{\\pi\\mu}} \\int_0^\\infty \\left[x \\sigma(x\\mathcal{T})\\right] \\exp(-x) dx\n$$\nThis final form is numerically ideal. The integral is over a dimensionless variable and has the canonical weight function $\\exp(-x)$, for which highly efficient quadrature rules exist.\n\n### 2. Numerical Integration and Interpolation\n\nThe integral is of the form $\\int_0^\\infty f(x) e^{-x} dx$, where $f(x) = x \\sigma(x\\mathcal{T})$. The most suitable numerical method for such integrals is Gauss-Laguerre quadrature, which approximates the integral as a weighted sum:\n$$\n\\int_0^\\infty f(x) e^{-x} dx \\approx \\sum_{j=1}^{N} w_j f(x_j)\n$$\nwhere $x_j$ are the roots (nodes) of the $N$-th order Laguerre polynomial $L_N(x)$, and $w_j$ are the corresponding weights. We select $N=32$, a choice that provides a high degree of accuracy for smoothly varying integrands, balancing precision and computational cost.\n\nEvaluation requires the value of the cross section $\\sigma(E)$ at the energies $E_j = x_j \\mathcal{T}$. Since $\\sigma(E)$ is provided as a discrete set of points $(E_i, \\sigma_i)$, a continuous model must be constructed via interpolation. To enforce positivity and reflect the typical power-law-like behavior of cross sections away from resonances, we perform linear interpolation on the logarithms of the data: $\\log(\\sigma)$ versus $\\log(E)$. For an arbitrary energy $E$, we find $\\log(\\sigma(E))$ by linearly interpolating between the tabulated points $(\\log(E_i), \\log(\\sigma_i))$. This is equivalent to a piecewise power-law model, which is physically reasonable and guarantees $\\sigma(E)  0$. For energies outside the tabulated range $[E_{\\min}, E_{\\max}]$, linear extrapolation is applied in log-log space, using the slope defined by the first two points for $E  E_{\\min}$ and the last two points for $E  E_{\\max}$.\n\n### 3. Uncertainty Propagation\n\nThe tabulated cross sections $\\sigma_i$ are provided with independent fractional one-sigma uncertainties $u_i = \\delta\\sigma_i / \\sigma_i$. To propagate these uncertainties to the final value of $\\langle \\sigma v \\rangle$, a Monte Carlo simulation is employed. This method is robust and naturally handles the non-linear dependencies introduced by the log-log interpolation and the integration process.\n\nTo ensure the physical constraint $\\sigma  0$, we model each $\\sigma_i$ as a random variable following a log-normal distribution. The parameters of the log-normal distribution for each data point are chosen to match the given nominal value and fractional uncertainty. If $Y = \\log(\\sigma)$ is normally distributed with mean $\\mu_Y$ and standard deviation $\\sigma_Y$, then the fractional uncertainty of $\\sigma=\\exp(Y)$ is $u = \\sqrt{\\exp(\\sigma_Y^2) - 1}$. From this, we derive the standard deviation of the underlying normal variable as $\\sigma_Y = \\sqrt{\\log(u^2+1)}$. The mean of the log-normal distribution is $E[\\sigma] = \\sigma_{i,\\text{nominal}} = \\exp(\\mu_Y + \\sigma_Y^2/2)$, so the mean of the underlying normal variable is $\\mu_Y = \\log(\\sigma_{i,\\text{nominal}}) - \\sigma_Y^2/2$.\n\nThe uncertainty analysis proceeds as follows:\n1.  A total of $M=2000$ Monte Carlo trials are performed. This number is sufficient to achieve stable statistics for the mean and standard deviation.\n2.  In each trial, a new set of cross-section values $\\{\\sigma_{i}^{(k)}\\}_{i=1 \\dots 6}$ is generated by drawing from their respective log-normal distributions.\n3.  For each realization $k$, the reaction rate coefficient $\\langle \\sigma v \\rangle^{(k)}$ is computed using the Gauss-Laguerre quadrature and log-log interpolation scheme described above.\n4.  The final reported uncertainty is the sample standard deviation of the resulting distribution of $M$ values of $\\langle \\sigma v \\rangle$. The nominal value is computed once using the unperturbed nominal cross-section data.\n\nAll physical constants and data are converted to and handled in base SI units (m, kg, s, J) to ensure the final result for $\\langle \\sigma v \\rangle$ is correctly expressed in $\\mathrm{m}^3/\\mathrm{s}$. Finally, a deterministic result is ensured by seeding the pseudo-random number generator.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_laguerre\n\ndef solve():\n    \"\"\"\n    Computes the D-T thermonuclear reaction rate coefficient and its uncertainty.\n    \"\"\"\n    # ------------------\n    # 1. CONSTANTS AND DATA\n    # ------------------\n\n    # Physical Constants\n    E_CHARGE = 1.602176634e-19  # J/eV\n    AMU_KG = 1.66053906660e-27    # kg/u\n    BARN_M2 = 1.0e-28            # m^2/barn\n\n    # Masses in atomic mass units (u)\n    M_D_U = 2.013553212745\n    M_T_U = 3.01550071632\n\n    # Tabulated cross-section data for D-T reaction\n    # (Energy_keV, Sigma_barns, Fractional_Uncertainty)\n    SIGMA_DATA = np.array([\n        (1.0, 1.0e-3, 0.20),\n        (5.0, 5.0e-2, 0.10),\n        (10.0, 2.0e-1, 0.10),\n        (20.0, 1.0, 0.05),\n        (50.0, 4.5, 0.05),\n        (100.0, 3.0, 0.10),\n    ])\n\n    # Test cases: Plasma temperatures in keV\n    TEST_TEMPERATURES_KEV = [0.1, 0.5, 10, 50]\n\n    # Numerical parameters\n    QUADRATURE_ORDER = 32\n    MC_SAMPLES = 2000\n    RNG_SEED = 42\n\n    # ------------------\n    # 2. DATA PRE-PROCESSING\n    # ------------------\n    \n    # Set seed for reproducibility\n    np.random.seed(RNG_SEED)\n\n    # Calculate reduced mass in kg\n    mu_u = (M_D_U * M_T_U) / (M_D_U + M_T_U)\n    mu_kg = mu_u * AMU_KG\n\n    # Convert tabulated data to SI units (J, m^2)\n    e_table_keV = SIGMA_DATA[:, 0]\n    sigma_table_barn = SIGMA_DATA[:, 1]\n    u_table = SIGMA_DATA[:, 2]\n\n    e_table_j = e_table_keV * 1000.0 * E_CHARGE\n    sigma_table_m2 = sigma_table_barn * BARN_M2\n\n    # Pre-calculate logs for log-log interpolation\n    log_e_table_j = np.log(e_table_j)\n    log_sigma_table_m2 = np.log(sigma_table_m2)\n\n    # Pre-calculate Gauss-Laguerre nodes and weights\n    quad_nodes, quad_weights = roots_laguerre(QUADRATURE_ORDER)\n\n    # ------------------\n    # 3. CORE FUNCTIONS\n    # ------------------\n\n    def interp_extrap_loglog(log_e_query_j, log_e_ref_j, log_sigma_ref_m2):\n        \"\"\"\n        Performs linear interpolation and extrapolation in log-log space.\n        \"\"\"\n        log_sigma_interp = np.interp(log_e_query_j, log_e_ref_j, log_sigma_ref_m2)\n\n        # Boolean masks for extrapolation\n        low_extrap_mask = log_e_query_j  log_e_ref_j[0]\n        high_extrap_mask = log_e_query_j > log_e_ref_j[-1]\n\n        # Low-energy extrapolation\n        if np.any(low_extrap_mask):\n            slope_low = (log_sigma_ref_m2[1] - log_sigma_ref_m2[0]) / \\\n                        (log_e_ref_j[1] - log_e_ref_j[0])\n            offset = log_sigma_ref_m2[0] - slope_low * log_e_ref_j[0]\n            log_sigma_interp[low_extrap_mask] = slope_low * log_e_query_j[low_extrap_mask] + offset\n\n        # High-energy extrapolation\n        if np.any(high_extrap_mask):\n            slope_high = (log_sigma_ref_m2[-1] - log_sigma_ref_m2[-2]) / \\\n                         (log_e_ref_j[-1] - log_e_ref_j[-2])\n            offset = log_sigma_ref_m2[-1] - slope_high * log_e_ref_j[-1]\n            log_sigma_interp[high_extrap_mask] = slope_high * log_e_query_j[high_extrap_mask] + offset\n\n        return np.exp(log_sigma_interp)\n\n    def calculate_rate_coeff(temp_kev, log_e_j, current_log_sigma_m2):\n        \"\"\"\n        Calculates the reaction rate coefficient for a given temperature and sigma table.\n        \"\"\"\n        # Convert temperature to Joules\n        temp_j = temp_kev * 1000.0 * E_CHARGE\n\n        # Energies at which to evaluate sigma, based on quadrature nodes\n        energies_j = temp_j * quad_nodes\n        \n        # Interpolate sigma at the required energies\n        sigma_at_nodes_m2 = interp_extrap_loglog(np.log(energies_j), log_e_j, current_log_sigma_m2)\n\n        # The function to integrate is f(x) = x * sigma(x*T)\n        integrand_values = quad_nodes * sigma_at_nodes_m2\n\n        # Perform the quadrature sum\n        integral_val = np.sum(quad_weights * integrand_values)\n\n        # Calculate the pre-factor\n        pre_factor = np.sqrt(8.0 * temp_j / (np.pi * mu_kg))\n\n        return pre_factor * integral_val\n\n    # ------------------\n    # 4. MAIN CALCULATION LOOP\n    # ------------------\n\n    final_results = []\n    \n    # Calculate log-normal distribution parameters for MC sampling\n    log_sigma_stds = np.sqrt(np.log(u_table**2 + 1))\n    log_sigma_means = log_sigma_table_m2 - 0.5 * log_sigma_stds**2\n\n    for temp_kev in TEST_TEMPERATURES_KEV:\n        # Calculate nominal value with unperturbed cross-sections\n        nominal_rate = calculate_rate_coeff(temp_kev, log_e_table_j, log_sigma_table_m2)\n\n        # Monte Carlo simulation for uncertainty\n        mc_rates = np.zeros(MC_SAMPLES)\n        for i in range(MC_SAMPLES):\n            # Generate a perturbed set of cross-sections\n            perturbed_log_sigma_table = np.random.normal(log_sigma_means, log_sigma_stds)\n            \n            # Calculate rate for this perturbed set\n            mc_rates[i] = calculate_rate_coeff(temp_kev, log_e_table_j, perturbed_log_sigma_table)\n        \n        # Calculate the standard deviation of the results\n        std_dev_rate = np.std(mc_rates, ddof=1)\n\n        final_results.extend([nominal_rate, std_dev_rate])\n\n    # ------------------\n    # 5. FINAL OUTPUT\n    # ------------------\n    \n    # Print the results in the required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}