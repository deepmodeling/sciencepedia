{
    "hands_on_practices": [
        {
            "introduction": "等离子体的准中性是一个近似，而非绝对的恒等式。本练习旨在探究非均匀等离子体中微小但必然存在的电荷分离的物理根源。通过结合高斯定律和电子力平衡，你将推导出一个关于此残余电荷的强大的量级估计，从而揭示出决定准中性近似有效性的基本条件。",
            "id": "4034988",
            "problem": "考虑一个无碰撞的静电等离子体，其处于板状几何中，空间变化仅沿 $x$ 方向，电场为 $\\mathbf{E}(x) = E_{x}(x)\\hat{\\mathbf{x}}$。假设系统处于稳态，因此时间导数为零。设电荷密度为 $\\rho(x) = e\\left(\\sum_{s} Z_{s} n_{s}(x) - n_{e}(x)\\right)$，其中 $e$ 是元电荷，$Z_{s}$ 和 $n_{s}(x)$ 分别是离子种类 $s$ 的电荷态和数密度，$n_{e}(x)$ 是电子数密度。电场由国际单位制 (SI) 中的 Gauss 定律 $\\nabla \\cdot \\mathbf{E} = \\rho/\\varepsilon_{0}$ 自洽地确定，其中 $\\varepsilon_{0}$ 是真空介电常数。\n\n假设电子是等温的，温度为 $T_{e}$，并在 $x$ 方向上满足稳态、无惯性力平衡，因此电子压力梯度与静电力相平衡。设电子压力为 $p_{e}(x) = n_{e}(x)k_{B}T_{e}$，其中 $k_{B}$ 是 Boltzmann 常数。定义电子德拜长度 $\\lambda_{De}$ 为 $\\lambda_{De}^{2} \\equiv \\frac{\\varepsilon_{0} k_{B} T_{e}}{e^{2} n_{e}}$，并定义特征密度标长 $L_{n}$ 为 $L_{n}^{-1} \\equiv \\left| \\partial_{x} \\ln n_{e} \\right|$。将 $L_{n}$ 视为局域特征尺度，并使用量级推断来估计导数。\n\n从上述基本关系出发，结合使用 Gauss 定律和电子力平衡，以 $\\lambda_{De}$ 和 $L_{n}$ 为参数，求出剩余空间电荷分数\n\n$$\n\\frac{\\left|\\sum_{s} Z_{s} n_{s} - n_{e}\\right|}{n_{e}}\\,,\n$$\n\n的量级表达式。请以单个闭式解析表达式的形式提供最终答案。同时，在推导过程中用文字说明剩余空间电荷可以忽略不计的条件（准中性条件），但最终方框内的答案必须仅为所要求的解析表达式，不带单位。",
            "solution": "该问题经评估有效。它在科学上基于等离子体物理学的基本原理，是自洽的，并以客观和精确的语言表述。所有提供的信息都是一致且足以推导出所要求的表达式。\n\n推导过程始于利用两个给定的关键物理定律：Gauss 定律和电子力平衡方程。\n\n在一维板状几何中，物理量仅沿 $x$ 方向变化，Gauss 定律 $\\nabla \\cdot \\mathbf{E} = \\rho/\\varepsilon_{0}$ 简化为涉及电场分量 $E_x(x)$ 导数的标量方程：\n$$\n\\frac{dE_x}{dx} = \\frac{\\rho(x)}{\\varepsilon_0}\n$$\n将给定的电荷密度表达式 $\\rho(x) = e\\left(\\sum_{s} Z_{s} n_{s}(x) - n_{e}(x)\\right)$ 代入 Gauss 定律，我们得到：\n$$\n\\frac{dE_x}{dx} = \\frac{e}{\\varepsilon_0} \\left( \\sum_{s} Z_{s} n_{s}(x) - n_{e}(x) \\right)\n$$\n该方程建立了电场空间梯度与等离子体中局域净电荷分离之间的直接关系。\n\n接下来，我们为电子流体建立稳态、无惯性力平衡。问题指出，作用在电子上的静电力与电子压力梯度相平衡。在一维情况下，静电力密度（单位体积的力）为 $-en_e(x)E_x(x)$，由压力梯度引起的力密度为 $-\\frac{dp_e}{dx}$。因此，平衡条件表示为：\n$$\n-en_e(x)E_x(x) - \\frac{dp_e}{dx} = 0\n$$\n电子压力由等温物种的理想气体定律给出，$p_e(x) = n_e(x)k_B T_e$，其中电子温度 $T_e$ 是一个常数。将其代入力平衡方程，得到：\n$$\n-en_e(x)E_x(x) - \\frac{d}{dx}\\left(n_e(x)k_B T_e\\right) = 0\n$$\n由于 $k_B$ 和 $T_e$ 是常数，它们可以从导数中提出：\n$$\n-en_e(x)E_x(x) - k_B T_e \\frac{dn_e}{dx} = 0\n$$\n我们可以解此方程得到电场 $E_x(x)$：\n$$\nE_x(x) = -\\frac{k_B T_e}{e n_e(x)} \\frac{dn_e}{dx}\n$$\n该表达式通常被称为电子的 Boltzmann 关系。使用自然对数的导数恒等式 $\\frac{d(\\ln u)}{dx} = \\frac{1}{u}\\frac{du}{dx}$ 将其重写通常很有用，这给出：\n$$\nE_x(x) = -\\frac{k_B T_e}{e} \\frac{d}{dx} \\left( \\ln n_e(x) \\right)\n$$\n为了求出净电荷密度，我们必须将力平衡方程与 Gauss 定律联系起来。为此，我们对 $E_x(x)$ 的表达式关于 $x$ 求导：\n$$\n\\frac{dE_x}{dx} = \\frac{d}{dx} \\left[ -\\frac{k_B T_e}{e} \\frac{d}{dx} \\left( \\ln n_e(x) \\right) \\right] = -\\frac{k_B T_e}{e} \\frac{d^2}{dx^2} \\left( \\ln n_e(x) \\right)\n$$\n现在我们有两个不同的 $\\frac{dE_x}{dx}$ 表达式。将它们相等可以消去电场：\n$$\n\\frac{e}{\\varepsilon_0} \\left( \\sum_{s} Z_{s} n_{s}(x) - n_{e}(x) \\right) = -\\frac{k_B T_e}{e} \\frac{d^2}{dx^2} \\left( \\ln n_e(x) \\right)\n$$\n现在我们可以分离出净电荷密度项 $\\sum_{s} Z_{s} n_{s}(x) - n_{e}(x)$：\n$$\n\\sum_{s} Z_{s} n_{s}(x) - n_{e}(x) = -\\frac{\\varepsilon_0 k_B T_e}{e^2} \\frac{d^2}{dx^2} \\left( \\ln n_e(x) \\right)\n$$\n为了求出剩余空间电荷分数，我们将两边同时除以电子数密度 $n_e(x)$：\n$$\n\\frac{\\sum_{s} Z_{s} n_{s}(x) - n_{e}(x)}{n_{e}(x)} = -\\frac{\\varepsilon_0 k_B T_e}{e^2 n_e(x)} \\frac{d^2}{dx^2} \\left( \\ln n_e(x) \\right)\n$$\n我们认识到前置因子项是电子德拜长度的平方，其定义为 $\\lambda_{De}^{2} \\equiv \\frac{\\varepsilon_0 k_B T_e}{e^{2} n_{e}}$。代入此定义，得到在此背景下的 Poisson-Boltzmann 方程：\n$$\n\\frac{\\sum_{s} Z_{s} n_{s}(x) - n_{e}(x)}{n_{e}(x)} = -\\lambda_{De}^2 \\frac{d^2}{dx^2} \\left( \\ln n_e(x) \\right)\n$$\n最后一步是按要求进行量级估计。特征密度标长 $L_n$ 定义为 $L_n^{-1} \\equiv \\left| \\partial_x \\ln n_e \\right|$。对于量级分析，像 $\\frac{d}{dx}$ 这样的微分算子可以近似为除以变化的特征长度尺度 $L_n$。因此，我们有：\n$$\n\\frac{d}{dx} \\left( \\ln n_e(x) \\right) \\sim \\mathcal{O}\\left(\\frac{1}{L_n}\\right)\n$$\n因此，二阶导数估计为：\n$$\n\\frac{d^2}{dx^2} \\left( \\ln n_e(x) \\right) = \\frac{d}{dx} \\left[ \\frac{d}{dx}\\left( \\ln n_e(x) \\right) \\right] \\sim \\frac{1}{L_n} \\mathcal{O}\\left(\\frac{1}{L_n}\\right) = \\mathcal{O}\\left(\\frac{1}{L_n^2}\\right)\n$$\n将这个量级估计代入我们的分数电荷不平衡方程，得到：\n$$\n\\frac{\\sum_{s} Z_{s} n_{s} - n_{e}}{n_{e}} \\sim \\mathcal{O}\\left(-\\lambda_{De}^2 \\frac{1}{L_n^2}\\right)\n$$\n问题要求这个量的大小，通过取绝对值得到：\n$$\n\\frac{\\left|\\sum_{s} Z_{s} n_{s} - n_{e}\\right|}{n_{e}} \\sim \\frac{\\lambda_{De}^2}{L_n^2}\n$$\n当这个分数值远小于 1 时，剩余空间电荷被认为是可忽略的，等离子体被称为是准中性的。这导出了著名的准中性条件：电子德拜长度必须远小于密度变化的特征标长，即 $\\lambda_{De} \\ll L_n$。",
            "answer": "$$\n\\boxed{\\frac{\\lambda_{De}^{2}}{L_{n}^{2}}}\n$$"
        },
        {
            "introduction": "上一个练习表明，准中性的成立与否取决于德拜长度与等离子体特征尺度的比值。本练习将这一概念置于真实世界的情境中，要求你首先从第一性原理出发推导德拜长度的表达式。随后，你将应用此公式，使用托卡马克聚变装置的核心参数进行计算，从而具体地理解为何对于聚变等离子体中的宏观现象而言，准中性是一个极佳的近似。",
            "id": "4035035",
            "problem": "考虑托卡马克等离子体芯部的一次静电扰动，其中单电离离子在电子快速响应时间尺度上被视为固定的、中和的背景。设未扰动的电子密度为 $n_{0}$，电子温度为 $T_{e}$。从第一性原理出发，使用高斯定律（泊松方程）和电子的线性化玻尔兹曼响应，推导特征静电屏蔽长度（德拜长度）$\\lambda_{D}$ 作为 $n_{0}$ 和 $T_{e}$ 的函数。然后，对于典型的托卡马克芯部数值 $n_{e} = 10^{20}\\,\\mathrm{m}^{-3}$ 和 $T_{e} = 5\\,\\mathrm{keV}$, 计算 $\\lambda_{D}$ 并对扰动波数 $k = 10\\,\\mathrm{m}^{-1}$ 求无量纲参数 $k \\lambda_{D}$ 的值，以评估在该尺度下准中性近似的有效性。\n\n使用以下物理常数：基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$, 真空介电常数 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$, 以及能量-温度转换关系 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。将以千电子伏特为单位给出的 $T_{e}$ 解释为，$k_{B} T_{e}$ 是以焦耳表示的能量 $T_{e}$。\n\n将最终的德拜长度以米为单位表示，乘积 $k \\lambda_{D}$ 表示为无单位的小数。两个结果均四舍五入到四位有效数字。最终答案必须只包含所要求的两个值。",
            "solution": "首先将根据所需标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n- 托卡马克等离子体芯部的一次静电扰动。\n- 单电离离子被视为固定的、中和的背景。\n- 未扰动的电子密度: $n_{0}$。\n- 电子温度: $T_{e}$。\n- 任务 1：从第一性原理出发（高斯定律和电子的线性化玻尔兹曼响应），推导特征静电屏蔽长度（德拜长度）$\\lambda_{D}$ 作为 $n_{0}$ 和 $T_{e}$ 的函数。\n- 任务 2：对于典型的托卡马克芯部数值计算 $\\lambda_{D}$。\n- 给定数值: $n_{e} = 10^{20}\\,\\mathrm{m}^{-3}$, $T_{e} = 5\\,\\mathrm{keV}$。\n- 任务 3：对扰动波数 $k = 10\\,\\mathrm{m}^{-1}$，求无量纲参数 $k \\lambda_{D}$ 的值。\n- 任务 4：评估在该尺度下准中性近似的有效性。\n- 物理常数：基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$, 真空介电常数 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$。\n- 能量转换: $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。\n- 解释规则：“以千电子伏特为单位给出的 $T_{e}$” 意味着 “$k_{B} T_{e}$ 是以焦耳表示的能量 $T_{e}$”。\n- 最终答案要求：将 $\\lambda_{D}$ 以米为单位表示，将 $k \\lambda_{D}$ 表示为无单位小数，两者均四舍五入到四位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题的有效性进行评估：\n- **科学依据**：该问题涉及德拜屏蔽，这是等离子体物理学中的一个基本概念。固定离子和玻尔兹曼电子响应的模型是等离子体物理学入门中用于推导德拜长度的标准、科学上有效的近似方法。提供的密度、温度和波数的数值对于聚变级托卡马克的芯部是符合实际的。\n- **适定性**：该问题是适定的。它要求一个标准的推导，然后进行直接计算。问题陈述清晰，所有必需的常数和数据都已提供。关于如何解释以 keV 为单位的温度 $T_e$ 的明确说明消除了任何歧义，确保了唯一解的存在。\n- **客观性**：该问题以精确、客观和定量的术语陈述，没有主观或基于意见的语言。\n\n该问题没有表现出任何诸如科学上不合理、不完整、矛盾或模棱两可的缺陷。为数值计算提供的项 $n_e$ 被合理地解释为未扰动的电子密度 $n_0$。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整解答。\n\n推导从泊松方程开始，该方程将静电势 $\\phi$ 与净电荷密度 $\\rho_c$ 联系起来：\n$$ \\varepsilon_0 \\nabla^2 \\phi = -\\rho_c $$\n净电荷密度是离子和电子电荷密度的总和。离子是单电离的，因此它们的电荷为 $+e$，密度为 $n_i$。电子的电荷为 $-e$，密度为 $n_e$。因此，\n$$ \\rho_c = e n_i - e n_e $$\n问题指出离子构成一个固定的、中和的背景。这意味着离子密度是恒定的，等于未扰动的电子密度，即 $n_i = n_0$。假定等离子体在未扰动状态下是电中性的。\n泊松方程变为：\n$$ \\varepsilon_0 \\nabla^2 \\phi = -(e n_0 - e n_e) = -e(n_i - n_e) = e(n_e - n_0) $$\n接下来，我们采用电子的玻尔兹曼响应。在热平衡中，存在静电势 $\\phi$ 时的电子密度由下式给出：\n$$ n_e(\\mathbf{r}) = n_0 \\exp\\left(\\frac{e\\phi(\\mathbf{r})}{k_B T_e}\\right) $$\n其中 $k_B$ 是玻尔兹曼常数，$T_e$ 是电子温度。\n我们被要求线性化此响应，这在势能远小于热能的小势扰动情况下是有效的，即 $|e\\phi| \\ll k_B T_e$。对于小的 $x$，我们可以使用指数的泰勒级数展开 $\\exp(x) \\approx 1 + x$：\n$$ n_e \\approx n_0 \\left(1 + \\frac{e\\phi}{k_B T_e}\\right) $$\n将这个线性化的电子密度代回泊松方程，得到：\n$$ \\varepsilon_0 \\nabla^2 \\phi = e \\left[ n_0 \\left(1 + \\frac{e\\phi}{k_B T_e}\\right) - n_0 \\right] $$\n$$ \\varepsilon_0 \\nabla^2 \\phi = e \\left[ n_0 + \\frac{n_0 e\\phi}{k_B T_e} - n_0 \\right] = \\frac{n_0 e^2 \\phi}{k_B T_e} $$\n重新整理这个方程，得到屏蔽泊松方程（或亥姆霍兹方程）：\n$$ \\nabla^2 \\phi - \\frac{n_0 e^2}{\\varepsilon_0 k_B T_e} \\phi = 0 $$\n这个方程描述了来自测试电荷的静电势如何被周围的等离子体屏蔽。这种屏蔽的特征长度尺度是德拜长度 $\\lambda_D$。通过将我们的结果与标准形式 $\\nabla^2 \\phi - \\frac{1}{\\lambda_D^2} \\phi = 0$ 进行比较，我们可以确定 $\\lambda_D$ 的表达式：\n$$ \\frac{1}{\\lambda_D^2} = \\frac{n_0 e^2}{\\varepsilon_0 k_B T_e} $$\n因此，德拜长度由下式给出：\n$$ \\lambda_D = \\sqrt{\\frac{\\varepsilon_0 k_B T_e}{n_0 e^2}} $$\n这就完成了从第一性原理的推导。\n\n现在，我们计算 $\\lambda_D$ 的数值。我们已知：\n- 未扰动电子密度，$n_0 = n_e = 10^{20}\\,\\mathrm{m}^{-3}$。\n- 电子温度，$T_e = 5\\,\\mathrm{keV}$。\n- 问题指定项 $k_B T_e$ 应被解释为转换为焦耳的能量 $T_e$。所以，我们将 $5\\,\\mathrm{keV}$ 转换为焦耳：\n$$ k_B T_e = 5\\,\\mathrm{keV} = 5 \\times 10^3\\,\\mathrm{eV} $$\n使用转换关系 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$：\n$$ k_B T_e = (5 \\times 10^3) \\times (1.602176634 \\times 10^{-19}) \\,\\mathrm{J} = 8.01088317 \\times 10^{-16}\\,\\mathrm{J} $$\n其他常数是：\n- $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$\n- $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n\n将这些值代入 $\\lambda_D$ 的表达式中：\n$$ \\lambda_D = \\sqrt{\\frac{(8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}) \\times (8.01088317 \\times 10^{-16}\\,\\mathrm{J})}{(10^{20}\\,\\mathrm{m}^{-3}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{C})^2}} $$\n$$ \\lambda_D = \\sqrt{\\frac{7.0911504 \\times 10^{-27}}{2.56696996 \\times 10^{-18}}} \\,\\mathrm{m} $$\n$$ \\lambda_D = \\sqrt{2.7620614 \\times 10^{-9}} \\,\\mathrm{m} \\approx 5.2555317 \\times 10^{-5}\\,\\mathrm{m} $$\n四舍五入到四位有效数字，德拜长度为 $\\lambda_D = 5.256 \\times 10^{-5}\\,\\mathrm{m}$。\n\n最后，我们计算扰动波数 $k = 10\\,\\mathrm{m}^{-1}$ 时的无量纲参数 $k \\lambda_D$：\n$$ k \\lambda_D = (10\\,\\mathrm{m}^{-1}) \\times (5.2555317 \\times 10^{-5}\\,\\mathrm{m}) = 5.2555317 \\times 10^{-4} $$\n四舍五入到四位有效数字，$k \\lambda_D = 5.256 \\times 10^{-4}$。\n\n准中性近似在等离子体现象的长度尺度 $L$ 远大于德拜长度 $L \\gg \\lambda_D$ 时有效。对于波状扰动，特征长度尺度是波长 $L = 2\\pi/k$，或者简单地 $L \\sim 1/k$。因此，准中性的条件变为 $1/k \\gg \\lambda_D$，这等价于 $k \\lambda_D \\ll 1$。我们计算出的值是 $k \\lambda_D \\approx 5.256 \\times 10^{-4}$，确实远小于 $1$。这证实了对于波数为 $10\\,\\mathrm{m}^{-1}$ 的扰动（对应约 $0.63\\,\\mathrm{m}$ 的波长），等离子体可以被认为是准中性的，因为电荷分离效应被限制在小得多的德拜尺度内。",
            "answer": "$$\n\\boxed{5.256 \\times 10^{-5} \\quad 5.256 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "将物理原理转化为稳健的计算模型是计算科学领域的一项核心技能。本练习要求你将准中性条件实现为一个等离子体模拟的数值初始化程序。你将学习如何以机器精度强制执行代数约束 $\\sum_s Z_s n_s = n_e$，并计算出自洽的静电势，从而架起理论等离子体物理与实际模拟工作之间的桥梁。",
            "id": "4035039",
            "problem": "您的任务是设计并实现一个计算程序，用于初始化磁约束聚变等离子体的准中性静电模拟。该初始化过程必须以机器精度强制实现准中性，并计算与等温电子闭合相符的静电势。该程序必须从基本物理定律和核心定义出发，并以纯粹的数学和逻辑术语表达。该实现必须是完全通用的，但您生成的程序将在一个小的预定义测试用例集上执行，以展示其正确性和鲁棒性。\n\n基本原理：\n- 使用电磁学中的高斯定律，表达式为 $\\nabla \\cdot \\mathbf{E} = \\rho / \\varepsilon_0$。在适用于许多聚变相关体系的准中性极限下，电荷密度满足 $\\rho \\approx 0$，这意味着中性条件 $\\sum_s Z_s e n_s - e n_e \\approx 0$。两边同除以 $e$ 得到 $\\sum_s Z_s n_s \\approx n_e$。\n- 使用等温玻尔兹曼电子闭合，$n_e = n_{e0}\\,\\exp\\!\\big(e\\,\\phi/(k_B T_e)\\big)$。当电子温度以电子伏特 (eV) 为单位表示时，该闭合简化为 $n_e = n_{e0}\\,\\exp\\!\\big(\\phi/T_e\\big)$，因为在 $\\phi$ 以伏特 (V) 为单位且 $T_e$ 以电子伏特 (eV) 为单位时，$e\\,\\phi/(k_B T_e) = \\phi/T_e$。\n\n任务要求：\n- 实现一个数值程序，对于一维 (1D) 网格上的每个空间索引 $i$，计算 $n_e[i]$，使得 $\\sum_s Z_s n_s[i] = n_e[i]$ 达到机器精度。使用补偿求和来最小化浮点舍入误差。\n- 通过求解 $\\phi[i] = T_e \\,\\ln\\!\\big(n_e[i]/n_{e0}[i]\\big)$，计算与等温玻尔兹曼电子关系一致的初始静电势 $\\phi[i]$。\n- 通过重构 $\\tilde{n}_e[i] = n_{e0}[i] \\exp\\!\\big(\\phi[i]/T_e\\big)$ 并将 $\\tilde{n}_e[i]$ 与 $n_e[i]$ 进行比较，来验证计算出的 $\\phi[i]$。\n- 在整个过程中使用双精度算术。\n\n单位与输出：\n- 离子密度 $n_s$ 和电子密度 $n_e$ 必须被视为数密度，单位为每立方米 (m$^{-3}$)。\n- 电子温度 $T_e$ 以电子伏特 (eV) 为单位指定。\n- 静电势 $\\phi$ 必须以伏特 (V) 为单位表示。\n- 不涉及角度；无需角度单位。\n- 对于每个测试用例，计算并报告一个包含以下四项的四元组：\n  1. 最大绝对中性残差 $r_{\\max} = \\max_i \\big|\\sum_s Z_s n_s[i] - n_e[i]\\big|$，单位为每立方米 (m$^{-3}$)。\n  2. 最大相对玻尔兹曼一致性误差 $\\epsilon_{\\max} = \\max_i \\big| \\tilde{n}_e[i] - n_e[i] \\big|/n_e[i]$，为无量纲浮点数。\n  3. 最小电势 $\\min_i \\phi[i]$，单位为伏特 (V)。\n  4. 最大电势 $\\max_i \\phi[i]$，单位为伏特 (V)。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为方括号括起来的、以逗号分隔的列表之列表（例如，`[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4]]`）。单个列表条目必须是浮点数。\n\n算法约束：\n- 程序必须实现补偿求和（例如 Kahan 求和）来计算 $\\sum_s Z_s n_s[i]$，在每个网格点 $i$ 处确保准中性达到机器精度。\n- 程序必须仅使用双精度浮点算术（所选库的默认设置）。\n- 除了最终要求的单行输出外，不允许任何外部输入或输出。\n\n测试套件：\n- 使用以下四个测试用例，每个测试用例都在由 $i \\in \\{0,1,2,3,4\\}$ 索引的五点一维网格上定义。所有密度单位均为每立方米 (m$^{-3}$)，$T_e$ 单位为电子伏特 (eV)，而 $\\phi$ 单位必须为伏特 (V)。\n\n  - 测试用例 1 (具有氘和氦的类芯部等离子体):\n    - 离子电荷数: $Z = [1,2]$。\n    - 离子密度: $n_{\\mathrm{D}^+}[i] = [1.00\\times 10^{19}, 1.05\\times 10^{19}, 1.10\\times 10^{19}, 1.08\\times 10^{19}, 1.02\\times 10^{19}],$ $n_{\\mathrm{He}^{2+}}[i] = [2.00\\times 10^{18}, 1.80\\times 10^{18}, 1.90\\times 10^{18}, 2.10\\times 10^{18}, 2.20\\times 10^{18}]$。\n    - 电子参考密度: $n_{e0}[i] = [1.35\\times 10^{19}, 1.35\\times 10^{19}, 1.35\\times 10^{19}, 1.35\\times 10^{19}, 1.35\\times 10^{19}]$。\n    - 电子温度: $T_e = 2000.0$。\n\n  - 测试用例 2 (具有氘和碳杂质的类边界等离子体):\n    - 离子电荷数: $Z = [1,6]$。\n    - 离子密度: $n_{\\mathrm{D}^+}[i] = [8.00\\times 10^{18}, 7.50\\times 10^{18}, 7.00\\times 10^{18}, 6.50\\times 10^{18}, 6.00\\times 10^{18}],$ $n_{\\mathrm{C}^{6+}}[i] = [1.00\\times 10^{17}, 1.20\\times 10^{17}, 1.40\\times 10^{17}, 1.30\\times 10^{17}, 1.10\\times 10^{17}]$。\n    - 电子参考密度: $n_{e0}[i] = [8.60\\times 10^{18}, 8.20\\times 10^{18}, 7.80\\times 10^{18}, 7.30\\times 10^{18}, 6.90\\times 10^{18}]$。\n    - 电子温度: $T_e = 300.0$。\n\n  - 测试用例 3 (均匀氢等离子体；预期电势为零):\n    - 离子电荷数: $Z = [1]$。\n    - 离子密度: $n_{\\mathrm{H}^+}[i] = [1.00\\times 10^{19}, 1.00\\times 10^{19}, 1.00\\times 10^{19}, 1.00\\times 10^{19}, 1.00\\times 10^{19}]$。\n    - 电子参考密度: $n_{e0}[i] = [1.00\\times 10^{19}, 1.00\\times 10^{19}, 1.00\\times 10^{19}, 1.00\\times 10^{19}, 1.00\\times 10^{19}]$。\n    - 电子温度: $T_e = 1000.0$。\n\n  - 测试用例 4 (包含钨杂质的多离子物种):\n    - 离子电荷数: $Z = [1,2,40]$。\n    - 离子密度: $n_{\\mathrm{D}^+}[i] = [9.00\\times 10^{19}, 8.80\\times 10^{19}, 8.50\\times 10^{19}, 8.30\\times 10^{19}, 8.10\\times 10^{19}],$ $n_{\\mathrm{He}^{2+}}[i] = [1.20\\times 10^{19}, 1.10\\times 10^{19}, 1.00\\times 10^{19}, 9.00\\times 10^{18}, 8.00\\times 10^{18}],$ $n_{\\mathrm{W}^{40+}}[i] = [2.00\\times 10^{16}, 2.20\\times 10^{16}, 2.40\\times 10^{16}, 2.10\\times 10^{16}, 2.30\\times 10^{16}]$。\n    - 电子参考密度: $n_{e0}[i] = [1.14\\times 10^{20}, 1.11\\times 10^{20}, 1.08\\times 10^{20}, 1.05\\times 10^{20}, 1.02\\times 10^{20}]$。\n    - 电子温度: $T_e = 15000.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，格式为方括号括起来的、以逗号分隔的列表，每个测试用例一个子列表。每个子列表必须按上述顺序包含四个浮点数：$r_{\\max}$、$\\epsilon_{\\max}$、$\\min \\phi$、$\\max \\phi$。例如：`[[r_1,e_1,phi_1,min,phi_1,max],[r_2,e_2,phi_2,min,phi_2,max],...]`。",
            "solution": "所陈述的问题在科学上是合理的、适定的，并为一项根植于等离子体物理基本原理的计算任务提供了一套完整的规范。所有需要的数据、约束和输出格式都已明确定义。因此，该问题是有效的，并将提供一个解决方案。\n\n目标是设计并实现一个用于初始化准中性静电模拟的数值程序。这涉及到从一组给定的离子物种密度 $n_s$ 计算自洽的电子密度 $n_e$ 和静电势 $\\phi$。该程序必须严格执行准中性至机器精度，并通过定义的误差度量进行验证。\n\n解决方案分三个阶段展开，遵循核心物理原理。\n\n**1. 准中性和电子密度计算**\n\n该问题的基础是等离子体中的准中性原理。在宏观尺度上，净电荷密度 $\\rho$ 近似为零。因此，高斯定律 $\\nabla \\cdot \\mathbf{E} = \\rho / \\varepsilon_0$ 简化为 $\\nabla \\cdot \\mathbf{E} \\approx 0$。电荷密度由离子和电子贡献：$\\rho = \\sum_s Z_s e n_s - e n_e$，其中 $e$ 是元电荷， $n_s$ 是电荷数为 $Z_s$ 的离子物种 $s$ 的数密度，$n_e$ 是电子数密度。设 $\\rho \\approx 0$ 可得出代数准中性条件：\n$$\n\\sum_s Z_s e n_s = e n_e\n$$\n两边同除以 $e$ 得到电子密度与离子密度的直接关系：\n$$\nn_e = \\sum_s Z_s n_s\n$$\n在一维离散网格上，对于空间索引 $i$，这在每个网格点上成为一个局部条件：\n$$\nn_e[i] = \\sum_s Z_s n_s[i]\n$$\n浮点数的直接求和会累积舍入误差，尤其是在对数量级差异较大的项求和时。为了按要求将准中性强制执行到机器精度，必须使用补偿求和算法。Kahan 求和算法是实现此目的的合适选择。它维护一个运行的补偿项 $c$，以计入每次加法中丢失的低位比特。对于一个数值序列 $x_k$，算法如下：\n1. 初始化总和 $S = 0.0$ 和补偿项 $c = 0.0$。\n2. 对于序列中的每一项 $x_k$：\n   a. 设置 $y = x_k - c$。\n   b. 设置 $t = S + y$。\n   c. 通过 $c = (t - S) - y$ 恢复丢失的低位部分。\n   d. 更新总和：$S = t$。\n3. 最终结果为 $S$。\n\n对于每个网格点 $i$，我们通过将此算法应用于离子电荷密度序列 $\\{Z_s n_s[i]\\}_{s}$ 来计算 $n_e[i]$。\n\n**2. 从等温电子计算静电势**\n\n问题指定了等温电子流体，其中电子密度分布通过玻尔兹曼关系与静电势 $\\phi$ 相关联。对于以能量单位（电子伏特，eV）给出的温度 $T_e$，此关系为：\n$$\nn_e[i] = n_{e0}[i] \\exp\\left(\\frac{\\phi[i]}{T_e}\\right)\n$$\n这里，$n_{e0}[i]$ 是参考电子密度，$\\phi[i]$ 是以伏特为单位的电势。为了找到与上一步计算出的电子密度 $n_e[i]$ 相一致的电势，我们必须对此方程进行反解以求 $\\phi[i]$：\n$$\n\\frac{n_e[i]}{n_{e0}[i]} = \\exp\\left(\\frac{\\phi[i]}{T_e}\\right)\n$$\n对两边取自然对数，得到：\n$$\n\\ln\\left(\\frac{n_e[i]}{n_{e0}[i]}\\right) = \\frac{\\phi[i]}{T_e}\n$$\n解出 $\\phi[i]$，得到每个网格点上静电势的显式公式：\n$$\n\\phi[i] = T_e \\ln\\left(\\frac{n_e[i]}{n_{e0}[i]}\\right)\n$$\n使用先前计算的 $n_e[i]$ 数组，对所有网格点 $i$ 执行此计算。\n\n**3. 验证和误差量化**\n\n最后一步是计算四个度量，以验证数值结果并表征解。所有计算均使用双精度浮点算术。\n\n- **最大绝对中性残差 ($r_{\\max}$):** 该度量验证了计算出的电子密度 $n_e[i]$ 确实强制执行了准中性。其定义为：\n  $$\n  r_{\\max} = \\max_i \\left| \\left(\\sum_s Z_s n_s[i]\\right) - n_e[i] \\right|\n  $$\n  这里，$n_e[i]$ 是使用补偿求和计算并存储的值。为了进行有意义的检查，总和 $\\sum_s Z_s n_s[i]$ 也使用补偿求和重新计算。其差值量化了存储和重用浮点数时固有的任何误差，预期该值接近机器ε的极限，通常为零。\n\n- **最大相对玻尔兹曼一致性误差 ($\\epsilon_{\\max}$):** 该度量验证了电势计算及其反演的数值稳定性。首先，从计算出的电势重构电子密度，$\\tilde{n}_e[i] = n_{e0}[i] \\exp(\\phi[i]/T_e)$。在数学上，$\\tilde{n}_e[i]$ 应与 $n_e[i]$ 完全相同。在数值上，$\\exp(\\ln(x))$ 的往返操作可能会引入微小误差。相对误差计算如下：\n  $$\n  \\epsilon_{\\max} = \\max_i \\frac{|\\tilde{n}_e[i] - n_e[i]|}{n_e[i]}\n  $$\n\n- **最小和最大电势 ($\\min \\phi$, $\\max \\phi$):** 这些值总结了所得电势分布的范围。它们的计算方法如下：\n  $$\n  \\min \\phi = \\min_i \\phi[i] \\quad \\text{和} \\quad \\max \\phi = \\max_i \\phi[i]\n  $$\n\n总体流程是处理每个测试用例，应用这三个步骤，计算所需的四个度量，并将结果汇总成指定的最终输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It initializes plasma state based on quasi-neutrality and Boltzmann electrons,\n    then computes required validation metrics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"core-like plasma with deuterium and helium\",\n            \"Z\": np.array([1, 2], dtype=np.float64),\n            \"n_s\": np.array([\n                [1.00e19, 1.05e19, 1.10e19, 1.08e19, 1.02e19], # n_D+\n                [2.00e18, 1.80e18, 1.90e18, 2.10e18, 2.20e18]  # n_He2+\n            ], dtype=np.float64),\n            \"n_e0\": np.array([1.35e19, 1.35e19, 1.35e19, 1.35e19, 1.35e19], dtype=np.float64),\n            \"T_e\": 2000.0,\n        },\n        {\n            \"name\": \"edge-like plasma with deuterium and carbon impurity\",\n            \"Z\": np.array([1, 6], dtype=np.float64),\n            \"n_s\": np.array([\n                [8.00e18, 7.50e18, 7.00e18, 6.50e18, 6.00e18], # n_D+\n                [1.00e17, 1.20e17, 1.40e17, 1.30e17, 1.10e17]  # n_C6+\n            ], dtype=np.float64),\n            \"n_e0\": np.array([8.60e18, 8.20e18, 7.80e18, 7.30e18, 6.90e18], dtype=np.float64),\n            \"T_e\": 300.0,\n        },\n        {\n            \"name\": \"uniform hydrogen; potential expected zero\",\n            \"Z\": np.array([1], dtype=np.float64),\n            \"n_s\": np.array([\n                [1.00e19, 1.00e19, 1.00e19, 1.00e19, 1.00e19]  # n_H+\n            ], dtype=np.float64),\n            \"n_e0\": np.array([1.00e19, 1.00e19, 1.00e19, 1.00e19, 1.00e19], dtype=np.float64),\n            \"T_e\": 1000.0,\n        },\n        {\n            \"name\": \"multi-species including tungsten impurity\",\n            \"Z\": np.array([1, 2, 40], dtype=np.float64),\n            \"n_s\": np.array([\n                [9.00e19, 8.80e19, 8.50e19, 8.30e19, 8.10e19], # n_D+\n                [1.20e19, 1.10e19, 1.00e19, 9.00e18, 8.00e18], # n_He2+\n                [2.00e16, 2.20e16, 2.40e16, 2.10e16, 2.30e16]  # n_W40+\n            ], dtype=np.float64),\n            \"n_e0\": np.array([1.14e20, 1.11e20, 1.08e20, 1.05e20, 1.02e20], dtype=np.float64),\n            \"T_e\": 15000.0,\n        },\n    ]\n\n    def kahan_sum(arr):\n        \"\"\"\n        Computes the sum of an array of floats using the Kahan summation algorithm\n        to minimize floating-point round-off error. All inputs must be float64.\n        \"\"\"\n        s = 0.0\n        c = 0.0  # A running compensation for lost low-order bits.\n        for x in arr:\n            y = x - c\n            t = s + y\n            c = (t - s) - y\n            s = t\n        return s\n\n    results = []\n    for case in test_cases:\n        Z = case[\"Z\"]\n        n_s = case[\"n_s\"]\n        n_e0 = case[\"n_e0\"]\n        T_e = case[\"T_e\"]\n        \n        num_grid_points = n_s.shape[1]\n        n_e = np.zeros(num_grid_points, dtype=np.float64)\n\n        # 1. Compute electron density n_e[i] using compensated summation\n        for i in range(num_grid_points):\n            # Form the array of ion charge densities at grid point i\n            ion_charge_densities = Z * n_s[:, i]\n            n_e[i] = kahan_sum(ion_charge_densities)\n\n        # 2. Compute electrostatic potential phi[i]\n        phi = T_e * np.log(n_e / n_e0)\n\n        # 3. Compute verification metrics\n        \n        # 3.1. Maximum absolute neutrality residual (r_max)\n        # Recalculate the sum and compare to the stored n_e\n        residual = np.zeros(num_grid_points, dtype=np.float64)\n        for i in range(num_grid_points):\n            ion_charge_densities = Z * n_s[:, i]\n            recalculated_sum = kahan_sum(ion_charge_densities)\n            residual[i] = np.abs(recalculated_sum - n_e[i])\n        r_max = np.max(residual)\n\n        # 3.2. Maximum relative Boltzmann consistency error (epsilon_max)\n        # Reconstruct n_e from phi and compare to the original n_e\n        n_e_tilde = n_e0 * np.exp(phi / T_e)\n        # Handle potential division by zero if n_e[i] can be zero.\n        # In these test cases, densities are all positive.\n        rel_error = np.abs(n_e_tilde - n_e) / n_e\n        epsilon_max = np.max(rel_error)\n\n        # 3.3. Minimum and maximum potential\n        min_phi = np.min(phi)\n        max_phi = np.max(phi)\n        \n        # Collect results for this case\n        case_results = [r_max, epsilon_max, min_phi, max_phi]\n        results.append(case_results)\n\n    # Format the final output string as a list of lists.\n    # The str() representation of a list is '[...]', so joining these\n    # with commas and wrapping with brackets produces the required format.\n    result_strings = [str(res) for res in results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}