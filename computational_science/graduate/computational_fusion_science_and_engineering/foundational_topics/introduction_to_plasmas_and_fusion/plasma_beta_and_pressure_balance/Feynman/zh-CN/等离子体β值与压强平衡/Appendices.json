{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握等离子体贝塔值（$\\beta$），我们必须超越其作为简单压力比的定义。这项基础练习将引导您用声速（$c_s$）和阿尔芬波速（$v_A$）来推导 $\\beta$，揭示其与等离子体基本波动动力学的深层联系。理解这一关系对于判断等离子体是由类似流体的热行为主导，还是由磁流体力学效应主导至关重要。",
            "id": "4028408",
            "problem": "考虑一个由理想磁流体动力学 (MHD) 描述的均匀、各向同性的单流体等离子体，其质量密度为 $\\rho$，热压力为 $p$，磁场强度为 $B$，绝热指数为 $\\gamma$，真空磁导率为 $\\mu_{0}$，Alfvén 速度为 $v_{A}$，绝热声速为 $c_{s}$。在这样的等离子体中，定义无量纲等离子体贝塔值 $\\beta$ 为热压力与磁压力之比。从绝热声速和 Alfvén 速度的基本定义出发，并根据磁场和真空磁导率对磁压力的定义，推导出一个完全用 $c_{s}$、$v_{A}$ 和 $\\gamma$ 表示的 $\\beta$ 表达式。明确说明所使用的任何物理假设。然后，根据你推导出的表达式，简要讨论在高场托卡马克核心与近地太阳风中 $\\beta$ 的预期定性范围，并指出比值 $c_{s}^{2}/v_{A}^{2}$ 和 $\\gamma$ 的值如何控制 $\\beta$ 的大小。你最终报告的答案必须是 $\\beta$ 以 $c_{s}$、$v_{A}$ 和 $\\gamma$ 表示的闭式解析表达式；无需进行数值计算。",
            "solution": "根据指定标准对问题陈述进行有效性审查。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   **系统：** 均匀、各向同性的单流体等离子体。\n-   **框架：** 理想磁流体动力学 (MHD)。\n-   **变量和常数：** 质量密度 $\\rho$、热压力 $p$、磁场强度 $B$、绝热指数 $\\gamma$、真空磁导率 $\\mu_{0}$。\n-   **定义的速度：** Alfvén 速度 $v_{A}$，绝热声速 $c_{s}$。\n-   **等离子体贝塔值 ($\\beta$) 的定义：** 热压力与磁压力之比，$\\beta = \\frac{p}{p_{\\text{mag}}}$。\n-   **隐含定义 (来自“从基本定义出发”)：**\n    -   磁压力：$p_{\\text{mag}} = \\frac{B^2}{2\\mu_0}$。\n    -   绝热声速：$c_s = \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n    -   Alfvén 速度：$v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}}$。\n-   **任务 1 (推导)：** 推导一个完全用 $c_s$、$v_A$ 和 $\\gamma$ 表示的 $\\beta$ 表达式。\n-   **任务 2 (讨论)：** 根据推导出的表达式，简要讨论在高场托卡马克核心与近地太阳风中 $\\beta$ 的预期定性范围。\n-   **最终答案要求：** $\\beta$ 的闭式解析表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题完全基于理想 MHD 的标准、成熟框架。等离子体贝塔值、Alfvén 速度和声速的定义是等离子体物理学中的基本概念。该问题在科学上是合理的。\n-   **提法恰当：** 该问题要求从一组一致且充分的定义中进行具体推导。目标陈述清晰，预期会有一个唯一的解析解。定性讨论是基于定量结果的标准解释性任务。\n-   **客观性：** 语言正式、精确，没有主观或含糊的术语。\n-   **完整性和一致性：** 所有必要的物理量及其标准定义要么已提供，要么已从基本原理中隐含要求，这些原理在此背景下是明确的。没有矛盾之处。\n-   **现实性和可行性：** 该问题在理想 MHD 的理想化模型内进行操作，这是理论等离子体物理学中一个标准且必要的近似。条件并非物理上不可能或不一致。\n\n**步骤 3：结论和行动**\n该问题是有效的。这是一个标准的、提法恰当的入门级等离子体物理学问题，旨在测试对基本 MHD 参数的理解。将提供完整解答。\n\n### 解答\n\n目标是推导等离子体贝塔值 $\\beta$ 的表达式，用绝热声速 $c_s$、Alfvén 速度 $v_A$ 和绝热指数 $\\gamma$ 来表示。\n\n等离子体贝塔值 $\\beta$ 定义为等离子体的热压力 $p$ 与磁压力 $p_{\\text{mag}}$ 之比。\n$$\n\\beta = \\frac{p}{p_{\\text{mag}}}\n$$\n磁压力根据磁场强度 $B$ 和真空磁导率 $\\mu_{0}$ 的基本定义为：\n$$\np_{\\text{mag}} = \\frac{B^2}{2\\mu_{0}}\n$$\n将此定义代入 $\\beta$ 的表达式中，得到：\n$$\n\\beta = \\frac{p}{\\frac{B^2}{2\\mu_{0}}} = \\frac{2\\mu_{0} p}{B^2}\n$$\n这个表达式目前依赖于 $p$、$B$ 和 $\\mu_{0}$。问题要求一个用 $c_s$、$v_A$ 和 $\\gamma$ 表示的表达式。为此，我们必须使用绝热声速和 Alfvén 速度的定义来替换 $p$ 和 $B^2$。\n\n绝热声速 $c_s$ 定义为：\n$$\nc_s = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\n其中 $\\rho$ 是等离子体质量密度。将此方程平方并重新整理以求解热压力 $p$，得到：\n$$\nc_s^2 = \\frac{\\gamma p}{\\rho} \\implies p = \\frac{\\rho c_s^2}{\\gamma}\n$$\nAlfvén 速度 $v_A$ 定义为：\n$$\nv_A = \\frac{B}{\\sqrt{\\mu_{0} \\rho}}\n$$\n将此方程平方并重新整理以求解 $B^2$，得到：\n$$\nv_A^2 = \\frac{B^2}{\\mu_{0} \\rho} \\implies B^2 = \\mu_{0} \\rho v_A^2\n$$\n现在，我们将 $p$ 和 $B^2$ 的表达式代入我们的 $\\beta$ 方程中：\n$$\n\\beta = \\frac{2\\mu_{0} p}{B^2} = \\frac{2\\mu_{0} \\left(\\frac{\\rho c_s^2}{\\gamma}\\right)}{\\mu_{0} \\rho v_A^2}\n$$\n现在我们可以简化这个表达式。分子和分母中都存在的真空磁导率 $\\mu_{0}$ 可以消掉。同样，质量密度 $\\rho$ 也可以消掉。\n$$\n\\beta = \\frac{2 \\left(\\frac{c_s^2}{\\gamma}\\right)}{v_A^2}\n$$\n重新整理各项，得到 $\\beta$ 的最终、简洁的表达式：\n$$\n\\beta = \\frac{2}{\\gamma} \\frac{c_s^2}{v_A^2} = \\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^2\n$$\n此推导依赖于以下假设：一个由理想 MHD 控制的均匀、各向同性的单流体等离子体，对于这种等离子体，$v_A$ 和 $c_s$ 的这些定义是有效的。\n\n### 讨论\n\n推导出的关系式 $\\beta = \\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^2$ 阐明了 $\\beta$ 的物理意义，即作为流体动力学效应（以 $c_s$ 传播）与磁流体动力学效应（以 $v_A$ 传播）相对重要性的量度。$\\beta$ 的大小由比值 $\\frac{c_s^2}{v_A^2}$ 直接控制，并与 $\\gamma$ 成反比。\n\n对于大多数完全电离的等离子体，粒子具有三个平动自由度，因此绝热指数为 $\\gamma = \\frac{5}{3}$。因此，因子 $\\frac{2}{\\gamma}$ 为 $\\frac{2}{(5/3)} = \\frac{6}{5} = 1.2$，是一个量级为 1 的常数。因此，$\\beta$ 的大小主要由速度平方比 $\\left(\\frac{c_s}{v_A}\\right)^2$ 决定。\n\n**强场托卡马克核心：**\n-   托卡马克是为聚变等离子体的磁约束而设计的。这要求磁压力远大于等离子体的热压力，以维持稳定性并将高温等离子体约束在容器壁之外。\n-   这意味着 $p_{\\text{mag}} \\gg p$，根据定义，即 $\\beta \\ll 1$。托卡马克核心中 $\\beta$ 的典型值在百分之几的范围内（例如，$0.01  \\beta  0.1$）。\n-   从我们推导的关系式来看，如果 $\\beta \\ll 1$，那么必然有 $\\left(\\frac{c_s}{v_A}\\right)^2 \\ll 1$，即 $c_s \\ll v_A$。\n-   这与物理条件一致：托卡马克在非常强的磁场（$B$ 为几个特斯拉）和中等密度下运行，导致极高的 Alfvén 速度 $v_A$。虽然核心温度非常高（导致声速 $c_s$ 很高），但 $v_A$ 的量级占主导地位。\n\n**近地太阳风：**\n-   太阳风是从太阳向外流出的等离子体流。在近地环境中，行星际磁场相对较弱（量级为纳特斯拉），且等离子体密度远低于托卡马克。\n-   在这种状态下，热压力和磁压力的大小通常相当。它不是一个强磁场主导的环境。\n-   因此，$\\beta$ 通常的量级为 1 ($\\beta \\approx 1$)。在某些区域或特定事件中，等离子体可能由热压力主导 ($\\beta > 1$) 或由磁压力主导 ($\\beta  1$)，但 $\\beta \\approx 1$ 是一个特征值。\n-   从我们推导的关系式来看，如果 $\\beta \\approx 1$，那么必然有 $\\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^2 \\approx 1$。由于 $\\frac{2}{\\gamma}$ 本身的量级为 1，这意味着 $\\left(\\frac{c_s}{v_A}\\right)^2 \\approx 1$，即 $c_s \\approx v_A$。\n-   在物理上，这意味着在太阳风中，热现象和磁波现象的特征速度是相当的。\n\n总之，比值 $\\frac{c_s^2}{v_A^2}$ 是等离子体状态的主要决定因素。一个小的比值表示一个低 $\\beta$、磁场主导的等离子体，如托卡马克核心；而一个量级为 1 的比值表示一个高 $\\beta$ 或压力相当的等离子体，如太阳风。",
            "answer": "$$\n\\boxed{\\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^{2}}\n$$"
        },
        {
            "introduction": "在掌握了贝塔值的基本概念之后，我们现在将其应用于一个具体的物理系统：托卡马克。本实践将挑战您构建一个索洛维耶夫平衡（Solov’ev equilibrium），这是在理想化假设下Grad-Shafranov方程的一个经典解析解。通过推导压力分布并计算环向贝塔值（$\\beta_T$），您将在MHD平衡建模的核心原理及其在现实情景中的局限性方面获得动手经验。",
            "id": "4028344",
            "problem": "考虑一个大环径比托卡马克，其大半径为 $R_0$，小半径为 $a$，处于轴对称、静态、理想磁流体力学（MHD）平衡状态。设极向磁通函数为 $\\psi(R,Z)$，磁场用 $\\psi$ 和环向场函数 $F(\\psi)$ 表示为 $\\mathbf{B} = \\frac{1}{R}\\nabla \\psi \\times \\hat{\\boldsymbol{\\phi}} + \\frac{F(\\psi)}{R}\\hat{\\boldsymbol{\\phi}}$，其中 $R$ 是柱坐标半径，$\\hat{\\boldsymbol{\\phi}}$ 是环向单位矢量。一个 Solov’ev 平衡由线性的 $p(\\psi)$ 和 $F(\\psi)$ 剖面指定，其中 $p(\\psi)$ 是标量压强，$F(\\psi) = R B_{\\phi}$ 描述了环向磁场 $B_{\\phi}$。假设\n- $p(\\psi) = p_0 - \\alpha \\psi$，其中 $p_0 > 0$ 且 $\\alpha > 0$，\n- $F(\\psi) = F_0 + \\beta \\psi$，其中 $F_0 = R_0 B_0$ 且 $\\beta$ 为常数，\n\n以及边界条件 $\\psi|_{r=0} = 0$ 和 $\\psi|_{r=a} = \\psi_b > 0$，其中 $r$ 是标记圆形截面磁面的小半径，这与大环径比级数展开 $R_0 \\gg a$ 一致。\n\n从理想磁流体力学力平衡方程 $\\nabla p = \\mathbf{J} \\times \\mathbf{B}$ 和轴对称性出发，通过在大环径比极限下获得主要的径向依赖关系 $\\psi(r)$ 来构建领头阶 Solov’ev 平衡，并为所使用的任何近似提供理由。然后，使用环向 beta 值的定义，\n$$\\beta_T = \\frac{2 \\mu_0 \\langle p \\rangle}{B_0^2},$$\n其中 $\\mu_0$ 是真空磁导率，$B_0$ 是 $R_0$ 处的环向磁场，$\\langle p \\rangle$ 表示 $p$ 在整个环体上的体积平均值，以闭合形式计算此平衡的 $\\beta_T$。将最终答案表示为关于 $p_0$ 和 $B_0$ 的单个解析表达式。最后，简要讨论所得 Solov’ev 模型在高 beta ($\\beta$) 值建模中的局限性，重点关注随着 $\\beta$ 值增大而失效的物理和数学假设。\n\n最终答案必须是单个无单位的闭合形式解析表达式。无需四舍五入。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n### 第 1 步：提取已知条件\n- **系统：** 大环径比 ($R_0 \\gg a$) 托卡马克，处于轴对称、静态、理想磁流体力学（MHD）平衡状态。\n- **坐标与几何：** 大半径 $R_0$，小半径 $a$。柱坐标半径 $R$，环向单位矢量 $\\hat{\\boldsymbol{\\phi}}$，标记圆形截面磁面的小半径 $r$。\n- **磁场：** 磁场由 $\\mathbf{B} = \\frac{1}{R}\\nabla \\psi \\times \\hat{\\boldsymbol{\\phi}} + \\frac{F(\\psi)}{R}\\hat{\\boldsymbol{\\phi}}$ 给出，其中 $\\psi(R,Z)$ 是极向磁通函数，$F(\\psi)$ 是环向场函数。\n- **本构关系 (Solov'ev 剖面)：**\n    - 压强：$p(\\psi) = p_0 - \\alpha \\psi$，其中 $p_0 > 0$ 且 $\\alpha > 0$。\n    - 环向场函数：$F(\\psi) = F_0 + \\beta \\psi$，其中 $F_0 = R_0 B_0$ 且 $\\beta$ 为常数。\n- **边界条件：**\n    - 在磁轴上：$\\psi|_{r=0} = 0$。\n    - 在等离子体边缘：$\\psi|_{r=a} = \\psi_b > 0$。\n- **定义：** 环向 beta 值定义为 $\\beta_T = \\frac{2 \\mu_0 \\langle p \\rangle}{B_0^2}$，其中 $\\mu_0$ 是真空磁导率，$B_0$ 是 $R_0$ 处的环向磁场，$\\langle p \\rangle$ 是压强 $p$ 的体积平均值。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题在科学上基于成熟的托卡马克磁流体力学平衡理论，特别是使用了 Grad-Shafranov 形式体系。Solov'ev 平衡的概念，其特点是 Grad-Shafranov 方程中的源项呈线性，是聚变等离子体物理学中的一个标准课题。所提供的 $p(\\psi)$ 和 $F(\\psi)$ 剖面是特定的选择，可以导出一个可解模型。问题是适定的，提供了足够的定义和边界条件，以在指定的大环径比极限下确定唯一解。语言客观而精确。因此，该问题被认定为有效。\n\n### 第 3 步：结论与行动\n问题有效。将提供解答。\n\n### 解答推导\n出发点是静态平衡的理想磁流体力学力平衡方程：\n$$ \\nabla p = \\mathbf{J} \\times \\mathbf{B} $$\n根据安培定律（在无位移电流的情况下），$\\mathbf{J} = \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B}$。将此代入力平衡方程，可将压强梯度与磁场联系起来。对于由极向磁通函数 $\\psi$ 描述的轴对称系统，该关系式可得出 Grad-Shafranov (GS) 方程：\n$$ R^2 \\nabla \\cdot \\left( \\frac{1}{R^2} \\nabla \\psi \\right) = - \\mu_0 R^2 \\frac{dp}{d\\psi} - F(\\psi) \\frac{dF}{d\\psi} $$\n在柱坐标系 $(R, \\phi, Z)$ 中，左侧的算子 $\\Delta^*$ 由 $\\Delta^*\\psi = \\frac{\\partial^2 \\psi}{\\partial R^2} - \\frac{1}{R} \\frac{\\partial \\psi}{\\partial R} + \\frac{\\partial^2 \\psi}{\\partial Z^2}$ 给出。\n\n根据给定的剖面：\n- $p(\\psi) = p_0 - \\alpha \\psi \\implies \\frac{dp}{d\\psi} = -\\alpha$\n- $F(\\psi) = F_0 + \\beta \\psi \\implies \\frac{dF}{d\\psi} = \\beta$\n\nGS 方程右侧的源项变为：\n$$ -\\mu_0 R^2 (-\\alpha) - (F_0 + \\beta\\psi)(\\beta) = \\mu_0 \\alpha R^2 - \\beta F_0 - \\beta^2 \\psi $$\n因此，GS 方程为：\n$$ \\Delta^* \\psi = \\mu_0 \\alpha R^2 - \\beta F_0 - \\beta^2 \\psi $$\n我们现在应用大环径比近似 ($R_0 \\gg a$)。我们引入以磁轴为中心的局部坐标 $(r, \\theta)$，使得 $R = R_0 + r\\cos\\theta$ 和 $Z = r\\sin\\theta$。在此极限下，假设磁面是同心圆，因此 $\\psi$ 仅是小半径 $r$ 的函数，$\\psi=\\psi(r)$。算子 $\\Delta^*$ 简化为极向平面中的领头阶柱坐标拉普拉斯算子：\n$$ \\Delta^* \\psi \\approx \\frac{1}{r} \\frac{d}{dr} \\left(r \\frac{d\\psi}{dr}\\right) $$\n对于源项，我们也通过设置 $R \\approx R_0$ 来取领头阶近似。$\\beta^2\\psi$ 项是等离子体 beta 值的高阶项，在领头阶计算中可以忽略。这对应于假设环向电流密度剖面是平坦的，这是入门模型中常见的简化。因此，GS 方程简化为：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left(r \\frac{d\\psi}{dr}\\right) \\approx \\mu_0 \\alpha R_0^2 - \\beta F_0 = \\mu_0 \\alpha R_0^2 - \\beta R_0 B_0 $$\n设右侧常数为 $K$。对该方程关于 $r$ 积分两次：\n$$ r \\frac{d\\psi}{dr} = \\frac{K}{2} r^2 + C_1 $$\n$$ \\frac{d\\psi}{dr} = \\frac{K}{2} r + \\frac{C_1}{r} $$\n为了使磁场（以及 $d\\psi/dr$）在磁轴（$r=0$）处为有限值，我们必须有 $C_1=0$。再次积分：\n$$ \\psi(r) = \\frac{K}{4} r^2 + C_2 $$\n边界条件 $\\psi(0)=0$ 意味着 $C_2=0$。因此，极向磁通的领头阶解是一个抛物线剖面：\n$$ \\psi(r) = \\frac{K}{4} r^2 = \\frac{1}{4}(\\mu_0 \\alpha R_0^2 - \\beta R_0 B_0) r^2 $$\n我们使用 $r=a$ 处的边界条件将其与压强联系起来。在等离子体边缘（$r=a$），通常假定压强为零，因此 $p(a)=0$。\n$$ p(a) = p(\\psi_b) = p_0 - \\alpha \\psi_b = 0 \\implies \\psi_b = \\frac{p_0}{\\alpha} $$\n将 $r=a$ 时的 $\\psi(r)$ 表达式代入：\n$$ \\psi_b = \\psi(a) = \\frac{K}{4} a^2 $$\n现在我们可以用 $p_0$ 来表示压强剖面 $p(r)$：\n$$ p(r) = p_0 - \\alpha \\psi(r) = p_0 - \\alpha \\left(\\frac{K}{4} r^2\\right) = p_0 - \\alpha\\left(\\frac{\\psi_b}{a^2} r^2\\right) = p_0 - \\alpha\\left(\\frac{p_0/\\alpha}{a^2} r^2\\right) $$\n$$ p(r) = p_0 \\left(1 - \\frac{r^2}{a^2}\\right) $$\n这是由平坦电流密度近似得到的标准抛物线压强剖面。\n\n接下来，我们计算压强的体积平均值 $\\langle p \\rangle$。在环体中，对环径比取领头阶，体积元为 $dV \\approx (2\\pi R_0) (2\\pi r dr)$。体积为 $V = \\int_0^a 2\\pi R_0 (2\\pi r dr) = 2\\pi^2 R_0 a^2$。\n$$ \\langle p \\rangle = \\frac{1}{V} \\int_V p \\, dV = \\frac{1}{2\\pi^2 R_0 a^2} \\int_0^a p(r) (2\\pi R_0) (2\\pi r dr) = \\frac{2}{a^2} \\int_0^a p(r) r dr $$\n代入 $p(r)$ 的抛物线剖面：\n$$ \\langle p \\rangle = \\frac{2}{a^2} \\int_0^a p_0 \\left(1 - \\frac{r^2}{a^2}\\right) r dr = \\frac{2 p_0}{a^2} \\left[ \\int_0^a r dr - \\frac{1}{a^2} \\int_0^a r^3 dr \\right] $$\n$$ \\langle p \\rangle = \\frac{2 p_0}{a^2} \\left[ \\frac{a^2}{2} - \\frac{1}{a^2}\\frac{a^4}{4} \\right] = \\frac{2 p_0}{a^2} \\left[ \\frac{a^2}{2} - \\frac{a^2}{4} \\right] = \\frac{2 p_0}{a^2} \\left( \\frac{a^2}{4} \\right) = \\frac{p_0}{2} $$\n最后，我们使用其定义计算环向 beta 值 $\\beta_T$：\n$$ \\beta_T = \\frac{2 \\mu_0 \\langle p \\rangle}{B_0^2} = \\frac{2 \\mu_0 (p_0/2)}{B_0^2} = \\frac{\\mu_0 p_0}{B_0^2} $$\n\n### 局限性讨论\n推导出的 Solov'ev 平衡模型依赖于几个关键假设，这些假设限制了其适用性，尤其是在高 beta 等离子体中。\n$1$. **大环径比与圆形磁面：** 该模型假设 $R_0 \\gg a$ 且磁面是同心圆。在高 beta 值下，等离子体压强变为磁压强的很大一部分。这个大的压强梯度将等离子体向外推，导致磁轴相对于真空室几何中心发生显著位移（Shafranov 位移）。磁面在外侧被压缩并变为非圆形（通常为 D 形）。简单的 $\\psi(r)$ 依赖关系和柱坐标拉普拉斯近似失效，必须求解完整的二维 GS 方程。\n$2$. **领头阶源项近似：** 在推导抛物线压强剖面时，我们忽略了 GS 方程中的 $\\beta^2 \\psi$ 项。这等同于假设环向电流密度剖面是平坦的。在高 beta 值下，压强梯度本身会驱动显著的“自举”电流，该电流峰值偏离轴心。总电流剖面变得高度不均匀，并与压强剖面耦合。简单的线性模型无法捕捉这种关键的自洽性，而这种自洽性对于高性能等离子体的平衡和稳定性分析至关重要。\n$3$. **线性剖面：** 假设 $p(\\psi)$ 和 $F(\\psi)$ 是 $\\psi$ 的线性函数，是为了获得解析解而在数学上采取的便利措施。真实的等离子体剖面由复杂的输运物理决定，通常不遵循如此简单的规律。例如，输运垒的形成可导致非常陡峭的局部梯度，无法用全局线性函数表示。这使得 Solov'ev 模型对实验观测到的剖面的表征不佳。\n$4$. **理想磁流体力学框架：** 整个模型基于理想磁流体力学，它将等离子体视为理想导电流体。这忽略了重要的非理想效应和动理学效应，如电阻率、粘性和各向异性压强，这些效应可以改变平衡，并且对于理解高 beta 时的稳定性变得至关重要。\n\n总之，Solov'ev 模型是一个有价值的教学工具，但对于高 beta 建模则不再适用，因为其核心的几何和物理假设（同心圆形磁面、平坦电流剖面）被等离子体通过压强和电流的强自相互作用所破坏。",
            "answer": "$$\\boxed{\\frac{\\mu_0 p_0}{B_0^2}}$$"
        },
        {
            "introduction": "现实世界中的聚变等离子体远比我们理想化的解析模型复杂。这项计算实践探讨了压力各向异性和高能粒子的存在这两个关键问题，这在采用辅助加热的现代实验中普遍存在。您将学习如何量化这些效应对贝塔值朴素估计所带来的偏差，并推导修正因子，这是准确解读实验数据和理解高性能等离子体中压力平衡的一项至关重要的技能。",
            "id": "4028402",
            "problem": "要求您设计并实现一个完整的、可运行的程序，该程序能够定量地、算法地展示当仅使用热诊断时，压强各向异性和快离子压强如何对等离子体 beta 值的估算产生偏差，并计算出有原理依据的修正值。请完全基于基本定义和定律进行推导。物理背景设定为一个磁化环形等离子体，其总压强由热组分和快离子组分构成，每个组分都可能相对于磁场方向表现出各向异性。\n\n从以下基本依据出发：\n- 磁流体力学（MHD）的动量平衡和麦克斯韦应力表明，磁压强由 $$\\frac{B^2}{2 \\mu_0},$$ 给出，其中 $B$ 是磁场强度，$\\mu_0$ 是真空磁导率。\n- 回旋等离子体的压强张量（Chew-Goldberger-Low (CGL) 形式）为 $$\\mathbf{P} = p_\\perp \\mathbf{I} + \\left(p_\\parallel - p_\\perp\\right) \\mathbf{b}\\mathbf{b},$$ 其中 $p_\\perp$ 和 $p_\\parallel$ 分别是垂直和平行压强，$\\mathbf{I}$ 是单位张量，$\\mathbf{b}=\\mathbf{B}/B$ 是沿磁场的单位矢量。\n- 在各向同性假设下，通过热诊断测量的标量热压强是一个单一值 $p_{\\mathrm{th,iso}}$，它是通过数密度 $n_{\\mathrm{th}}$ 和温度 $T_{\\mathrm{th,iso}}$ 构建的，公式为 $$p_{\\mathrm{th,iso}} = n_{\\mathrm{th}} T_{\\mathrm{th,iso}} e,$$ 其中温度以电子伏特（eV）为单位，e 是元电荷，用于将能量单位从eV转换为焦耳。\n- 热组分和快离子组分对平行和垂直压强的贡献分别构建如下：$$p_{\\mathrm{th,\\perp}} = n_{\\mathrm{th}} T_{\\mathrm{th,\\perp}} e,\\quad p_{\\mathrm{th,\\parallel}} = n_{\\mathrm{th}} T_{\\mathrm{th,\\parallel}} e,$$ 和 $$p_{\\mathrm{f,\\perp}} = n_{\\mathrm{f}} T_{\\mathrm{f,\\perp}} e,\\quad p_{\\mathrm{f,\\parallel}} = n_{\\mathrm{f}} T_{\\mathrm{f,\\parallel}} e,$$ 其中 $n_{\\mathrm{f}}$ 是快离子数密度，$T_{\\mathrm{f,\\perp}}$、$T_{\\mathrm{f,\\parallel}}$ 是它们以电子伏特为单位的垂直和平行温度。\n\n在您的解决方案中，从这些基础出发，推导如何：\n- 构建一个使用 $p_{\\mathrm{th,iso}}$ 和 $B$ 的、仅基于热组分的、各向同性的朴素 beta 估算值。\n- 通过使用从 $\\mathbf{P}$ 推导出的有效标量压强，构建一个考虑了各向异性的、有物理意义的总 beta 值（从第一性原理出发论证您选择的合理性）。\n- 构建一个垂直方向的 beta 值，该值与跨磁通面的横向压强平衡特别相关。\n- 定义并计算乘法修正因子，用以将朴素的、仅基于热组分的各向同性 beta 值转换为考虑各向异性的总 beta 值和垂直方向的 beta 值。\n- 应用这些修正来生成修正后的 beta 值。\n\n您的程序必须实现推导出的公式，并为每个测试用例计算以下七个浮点数：\n- 朴素的、仅基于热组分的各向同性 beta 值。\n- 考虑各向异性的总 beta 值。\n- 垂直方向的 beta 值。\n- 将朴素 beta 值映射到考虑各向异性的总 beta 值的乘法修正因子。\n- 将该因子应用于朴素 beta 值后得到的修正 beta 值。\n- 将朴素 beta 值映射到垂直方向 beta 值的乘法修正因子。\n- 将该因子应用于朴素 beta 值后得到的修正后的垂直 beta 值。\n\n所有温度均以电子伏特（$\\mathrm{eV}$）为单位，并且必须使用 $e$ 转换为焦耳。所有密度单位均为 $\\mathrm{m}^{-3}$。磁场强度单位为特斯拉（$\\mathrm{T}$）。真空磁导率是一个常数 $$\\mu_0 = 4 \\pi \\times 10^{-7}\\ \\mathrm{N}\\,\\mathrm{A}^{-2},$$ 元电荷是一个常数 $$e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}.$$\n\n不涉及角度单位。等离子体 beta 值是无量纲的；您的程序必须输出无量纲的浮点数，并四舍五入到 $8$ 位小数。\n\n测试套件：\n为以下五个参数集提供计算。每个参数集是一个元组 $\\left(B, n_{\\mathrm{th}}, T_{\\mathrm{th,iso}}, T_{\\mathrm{th,\\perp}}, T_{\\mathrm{th,\\parallel}}, n_{\\mathrm{f}}, T_{\\mathrm{f,\\perp}}, T_{\\mathrm{f,\\parallel}}\\right)$，单位如上所述。\n\n- 情况 1（中等各向异性与显著的快离子）：\n  $$\\left(B=5,\\ n_{\\mathrm{th}}=1.0\\times 10^{20},\\ T_{\\mathrm{th,iso}}=11000,\\ T_{\\mathrm{th,\\perp}}=12000,\\ T_{\\mathrm{th,\\parallel}}=10000,\\ n_{\\mathrm{f}}=5.0\\times 10^{18},\\ T_{\\mathrm{f,\\perp}}=150000,\\ T_{\\mathrm{f,\\parallel}}=80000\\right).$$\n- 情况 2（各向同性热组分，无快离子；边界一致性检查）：\n  $$\\left(B=2,\\ n_{\\mathrm{th}}=8.0\\times 10^{19},\\ T_{\\mathrm{th,iso}}=8000,\\ T_{\\mathrm{th,\\perp}}=8000,\\ T_{\\mathrm{th,\\parallel}}=8000,\\ n_{\\mathrm{f}}=0.0,\\ T_{\\mathrm{f,\\perp}}=0,\\ T_{\\mathrm{f,\\parallel}}=0\\right).$$\n- 情况 3（强热组分各向异性与稀疏快离子；各向异性主导的偏差）：\n  $$\\left(B=1,\\ n_{\\mathrm{th}}=2.0\\times 10^{19},\\ T_{\\mathrm{th,iso}}=10000,\\ T_{\\mathrm{th,\\perp}}=20000,\\ T_{\\mathrm{th,\\parallel}}=5000,\\ n_{\\mathrm{f}}=1.0\\times 10^{18},\\ T_{\\mathrm{f,\\perp}}=200000,\\ T_{\\mathrm{f,\\parallel}}=50000\\right).$$\n- 情况 4（各向同性热组分和各向同性快离子；仅快离子引起的偏差）：\n  $$\\left(B=7,\\ n_{\\mathrm{th}}=1.5\\times 10^{20},\\ T_{\\mathrm{th,iso}}=14000,\\ T_{\\mathrm{th,\\perp}}=14000,\\ T_{\\mathrm{th,\\parallel}}=14000,\\ n_{\\mathrm{f}}=1.0\\times 10^{19},\\ T_{\\mathrm{f,\\perp}}=20000,\\ T_{\\mathrm{f,\\parallel}}=20000\\right).$$\n- 情况 5（低磁场，中等各向异性与高能快离子；高 beta 边界情况）：\n  $$\\left(B=0.5,\\ n_{\\mathrm{th}}=5.0\\times 10^{19},\\ T_{\\mathrm{th,iso}}=1800,\\ T_{\\mathrm{th,\\perp}}=2000,\\ T_{\\mathrm{th,\\parallel}}=1500,\\ n_{\\mathrm{f}}=3.0\\times 10^{18},\\ T_{\\mathrm{f,\\perp}}=40000,\\ T_{\\mathrm{f,\\parallel}}=10000\\right).$$\n\n输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的、以逗号分隔的列表。列表中的每个元素对应一个测试用例，其本身也是一个由方括号括起来的、包含七个浮点数的、以逗号分隔的列表。例如，$$\\left[\\left[x_1,x_2,\\dots,x_7\\right],\\left[y_1,y_2,\\dots,y_7\\right],\\dots\\right].$$ 每个浮点数必须四舍五入到 $8$ 位小数。",
            "solution": "我们从力平衡和压强-应力基础出发。磁流体力学（MHD）将磁应力处理为产生一个各向同性的磁压强 $$\\frac{B^2}{2\\mu_0}$$ 以及一个方向性张力 $-\\frac{\\mathbf{B}\\mathbf{B}}{\\mu_0}$。在各向同性等离子体中，流体应力为 $-p\\mathbf{I}$，从而得到我们熟悉的标量 beta 值 $$\\beta = \\frac{\\text{等离子体压强}}{\\text{磁压强}} = \\frac{2 \\mu_0 p}{B^2}.$$ 当等离子体是各向异性的，流体应力必须由 Chew-Goldberger-Low（CGL）压强张量表示\n$$\\mathbf{P} = p_\\perp \\mathbf{I} + \\left(p_\\parallel - p_\\perp\\right)\\mathbf{b}\\mathbf{b},$$\n其中 $p_\\perp$ 和 $p_\\parallel$ 分别表示垂直于和平行于磁场 $\\mathbf{B}$ 的压强，$\\mathbf{b}=\\mathbf{B}/B$ 是沿磁场的单位矢量。跨磁通面的局域垂直力平衡直接取决于 $p_\\perp$，而体积能量学和压强的标量度量可以合理地与 $\\mathbf{P}$ 的迹相关联。其迹为\n$$\\operatorname{Tr}(\\mathbf{P}) = p_\\parallel + 2 p_\\perp,$$\n由此可以定义一个有效标量压强，即迹平均值\n$$p_{\\mathrm{tr}} = \\frac{1}{3}\\left(p_\\parallel + 2 p_\\perp\\right).$$\n这个 $p_{\\mathrm{tr}}$ 捕获了 $\\mathbf{P}$ 所蕴含的应力的各向同性部分，而 $p_\\perp$ 则捕获了在存在磁张力和曲率的情况下与横向压强平衡直接相关的垂直分量。\n\n假设各向同性的热诊断会产生一个单一的热压强值 $p_{\\mathrm{th,iso}}$，该值是通过测量的数密度 $n_{\\mathrm{th}}$ 和以电子伏特为单位的标量温度 $T_{\\mathrm{th,iso}}$（在国际单位制中）构建的\n$$p_{\\mathrm{th,iso}} = n_{\\mathrm{th}} T_{\\mathrm{th,iso}} e,$$\n其中 $e$ 是将 $\\mathrm{eV}$ 转换为焦耳的元电荷。实际上，热组分和快离子布居都可能是各向异性的。它们的压强为\n$$p_{\\mathrm{th,\\perp}} = n_{\\mathrm{th}} T_{\\mathrm{th,\\perp}} e,\\quad p_{\\mathrm{th,\\parallel}} = n_{\\mathrm{th}} T_{\\mathrm{th,\\parallel}} e,$$\n和\n$$p_{\\mathrm{f,\\perp}} = n_{\\mathrm{f}} T_{\\mathrm{f,\\perp}} e,\\quad p_{\\mathrm{f,\\parallel}} = n_{\\mathrm{f}} T_{\\mathrm{f,\\parallel}} e.$$\n那么总的垂直和平行压强为\n$$p_\\perp = p_{\\mathrm{th,\\perp}} + p_{\\mathrm{f,\\perp}},\\quad p_\\parallel = p_{\\mathrm{th,\\parallel}} + p_{\\mathrm{f,\\parallel}}.$$\n由此，有效标量压强为\n$$p_{\\mathrm{tr}} = \\frac{1}{3}\\left(p_\\parallel + 2 p_\\perp\\right).$$\n\n朴素的、仅基于热组分的各向同性 beta 值是通过将 $p_{\\mathrm{th,iso}}$ 代入各向同性 beta 公式来定义的：\n$$\\beta_{\\mathrm{naive}} = \\frac{2 \\mu_0 p_{\\mathrm{th,iso}}}{B^2}.$$\n考虑各向异性的总 beta 值使用基于迹的标量压强：\n$$\\beta_{\\mathrm{tr}} = \\frac{2 \\mu_0 p_{\\mathrm{tr}}}{B^2} = \\frac{2 \\mu_0}{B^2}\\cdot\\frac{1}{3}\\left(p_\\parallel + 2 p_\\perp\\right).$$\n垂直方向的 beta 值分离出直接进入跨场压强平衡的横向分量：\n$$\\beta_\\perp = \\frac{2 \\mu_0 p_\\perp}{B^2}.$$\n\n我们现在量化仅使用 $p_{\\mathrm{th,iso}}$ 所引起的偏差。一个将朴素估算值映射到基于迹的总 beta 值的乘法修正因子是\n$$C_{\\mathrm{tr}} = \\frac{p_{\\mathrm{tr}}}{p_{\\mathrm{th,iso}}} = \\frac{\\frac{1}{3}\\left(p_\\parallel + 2 p_\\perp\\right)}{p_{\\mathrm{th,iso}}}.$$\n类似地，一个将朴素估算值映射到垂直方向 beta 值的乘法修正因子是\n$$C_{\\perp} = \\frac{p_\\perp}{p_{\\mathrm{th,iso}}}.$$\n应用这些因子可得到修正后的 beta 值：\n$$\\beta_{\\mathrm{corr,tr}} = \\beta_{\\mathrm{naive}}\\, C_{\\mathrm{tr}},\\quad \\beta_{\\mathrm{corr,\\perp}} = \\beta_{\\mathrm{naive}}\\, C_{\\perp}.$$\n这些修正直接揭示了各向异性和快离子压强的角色：当 $p_\\parallel$ 和 $p_\\perp$ 显著偏离热组分各向同性假设，或者当 $p_{\\mathrm{f,\\perp}}$ 和 $p_{\\mathrm{f,\\parallel}}$ 不可忽略时， $C_{\\mathrm{tr}}$ 和 $C_{\\perp}$ 都会超过 1，从而量化了 $\\beta_{\\mathrm{naive}}$ 的低估程度。\n\n算法设计：\n- 输入磁场强度 $B$，热组分和快离子的密度 $n_{\\mathrm{th}}$、$n_{\\mathrm{f}}$，以及温度 $T_{\\mathrm{th,iso}}$、$T_{\\mathrm{th,\\perp}}$、$T_{\\mathrm{th,\\parallel}}$、$T_{\\mathrm{f,\\perp}}$、$T_{\\mathrm{f,\\parallel}}$，其中温度单位为 $\\mathrm{eV}$。\n- 对每个组分，使用 $p = n T e$ 将温度转换为国际单位制（SI）的压强。\n- 求和得到 $p_\\perp$ 和 $p_\\parallel$，然后计算 $p_{\\mathrm{tr}}$。\n- 使用各自的定义计算 $\\beta_{\\mathrm{naive}}$、$\\beta_{\\mathrm{tr}}$ 和 $\\beta_\\perp$。\n- 计算 $C_{\\mathrm{tr}}$ 和 $C_{\\perp}$ 作为 $p_{\\mathrm{tr}}$ 和 $p_\\perp$ 与 $p_{\\mathrm{th,iso}}$ 的比值。\n- 计算 $\\beta_{\\mathrm{corr,tr}} = \\beta_{\\mathrm{naive}} C_{\\mathrm{tr}}$ 和 $\\beta_{\\mathrm{corr,\\perp}} = \\beta_{\\mathrm{naive}} C_{\\perp}$。\n- 将每个结果浮点数四舍五入到 8 位小数，并以所要求的列表的列表的单行格式输出。\n\n科学解释：\n- 当 $p_{\\mathrm{f,\\perp}}$ 和 $p_{\\mathrm{f,\\parallel}}$ 不为零时，$\\beta_{\\mathrm{naive}}$ 完全忽略了它们的贡献，导致总 beta 值和垂直 beta 值被低估。\n- 当 $p_{\\mathrm{th,\\perp}} \\neq p_{\\mathrm{th,\\parallel}}$ 或 $p_{\\mathrm{f,\\perp}} \\neq p_{\\mathrm{f,\\parallel}}$ 时，各向异性会相对于 $p_{\\mathrm{th,iso}}$ 同时改变 $p_{\\mathrm{tr}}$ 和 $p_\\perp$，通常会增加有效压强比，从而增加修正因子。\n- 当需要将标量能量与磁压强进行比较时，基于迹的修正 $C_{\\mathrm{tr}}$ 是合适的；而对于 $p_\\perp$ 直接参与的跨场压强平衡情景， $C_{\\perp}$ 是合适的。\n\n这五个测试用例共同在标准情况、各向同性边界、各向异性主导场景、仅快离子偏差以及低 $B$ 场下的高 beta 边界情况等多种场景下检验了该算法，确保了覆盖范围和科学真实性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\nMU0 = 4.0 * np.pi * 1e-7  # Vacuum permeability (N A^-2)\nE_CHARGE = 1.602176634e-19  # Elementary charge (C), converts eV to J\n\ndef compute_case(B_T,\n                 n_th_m3, T_th_iso_eV, T_th_perp_eV, T_th_par_eV,\n                 n_fast_m3, T_fast_perp_eV, T_fast_par_eV):\n    # Pressures (Pa) from densities (m^-3) and temperatures (eV)\n    p_th_iso = n_th_m3 * T_th_iso_eV * E_CHARGE\n    p_th_perp = n_th_m3 * T_th_perp_eV * E_CHARGE\n    p_th_par = n_th_m3 * T_th_par_eV * E_CHARGE\n\n    p_fast_perp = n_fast_m3 * T_fast_perp_eV * E_CHARGE\n    p_fast_par = n_fast_m3 * T_fast_par_eV * E_CHARGE\n\n    # Total perpendicular and parallel pressures\n    p_perp_total = p_th_perp + p_fast_perp\n    p_par_total = p_th_par + p_fast_par\n\n    # Trace-based effective scalar pressure\n    p_trace_total = (p_par_total + 2.0 * p_perp_total) / 3.0\n\n    # Beta calculations\n    B2 = B_T ** 2\n    beta_naive = (2.0 * MU0 * p_th_iso) / B2\n    beta_trace = (2.0 * MU0 * p_trace_total) / B2\n    beta_perp = (2.0 * MU0 * p_perp_total) / B2\n\n    # Correction factors and corrected betas\n    # Guard against division by zero if p_th_iso == 0\n    if p_th_iso == 0.0:\n        C_trace = np.nan\n        C_perp = np.nan\n        beta_corr_trace = np.nan\n        beta_corr_perp = np.nan\n    else:\n        C_trace = p_trace_total / p_th_iso\n        C_perp = p_perp_total / p_th_iso\n        beta_corr_trace = beta_naive * C_trace\n        beta_corr_perp = beta_naive * C_perp\n\n    return [\n        beta_naive, beta_trace, beta_perp,\n        C_trace, beta_corr_trace,\n        C_perp, beta_corr_perp\n    ]\n\ndef format_results(results):\n    # Round each float to 8 decimal places and construct the required string\n    def fmt(x):\n        if np.isnan(x):\n            return \"nan\"\n        return f\"{x:.8f}\"\n    formatted_cases = []\n    for case in results:\n        formatted = \"[\" + \",\".join(fmt(val) for val in case) + \"]\"\n        formatted_cases.append(formatted)\n    return \"[\" + \",\".join(formatted_cases) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (B, n_th, T_th_iso, T_th_perp, T_th_parallel, n_fast, T_fast_perp, T_fast_parallel)\n    test_cases = [\n        (5.0, 1.0e20, 11000.0, 12000.0, 10000.0, 5.0e18, 150000.0, 80000.0),\n        (2.0, 8.0e19, 8000.0, 8000.0, 8000.0, 0.0, 0.0, 0.0),\n        (1.0, 2.0e19, 10000.0, 20000.0, 5000.0, 1.0e18, 200000.0, 50000.0),\n        (7.0, 1.5e20, 14000.0, 14000.0, 14000.0, 1.0e19, 20000.0, 20000.0),\n        (0.5, 5.0e19, 1800.0, 2000.0, 1500.0, 3.0e18, 40000.0, 10000.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        res = compute_case(*case)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nsolve()\n```"
        }
    ]
}