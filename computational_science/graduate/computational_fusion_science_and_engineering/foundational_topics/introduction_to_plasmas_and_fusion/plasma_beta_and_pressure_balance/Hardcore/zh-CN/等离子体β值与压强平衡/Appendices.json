{
    "hands_on_practices": [
        {
            "introduction": "理解等离子体贝塔值 $\\beta$ 的物理本质，是掌握磁约束聚变的关键第一步。这个基础练习将指导你从阿尔芬速度 $v_A$ 和声速 $c_s$ 的基本定义出发，推导出 $\\beta$ 值的一个重要关系。这个过程不仅能加深你对 $\\beta$ 值作为热压力与磁压力之比的理解，还能揭示它与等离子体中两种基本波动（磁流体波和声波）传播速度之间的深刻联系 。",
            "id": "4028408",
            "problem": "考虑一个由理想磁流体动力学 (MHD) 描述的均匀、各向同性的单流体等离子体，其质量密度为 $\\rho$，热压强为 $p$，磁场强度为 $B$，绝热指数为 $\\gamma$，真空磁导率为 $\\mu_{0}$，Alfvén 速度为 $v_{A}$，绝热声速为 $c_{s}$。在此等离子体中，将无量纲的等离子体 beta 值 $\\beta$ 定义为热压强与磁压强之比。从绝热声速和 Alfvén 速度的基本定义出发，并从磁压强用磁场和真空磁导率表示的定义出发，推导一个仅用 $c_{s}$、$v_{A}$ 和 $\\gamma$ 表示的 $\\beta$ 表达式。明确说明所使用的任何物理假设。然后，根据你推导出的表达式，简要讨论在强场托卡马克核心与近地太阳风中 $\\beta$ 的预期定性范围，并指出比率 $c_{s}^{2}/v_{A}^{2}$ 和 $\\gamma$ 的值如何控制 $\\beta$ 的大小。你最终报告的答案必须是 $\\beta$ 关于 $c_{s}$、$v_{A}$ 和 $\\gamma$ 的闭式解析表达式；无需进行数值计算。",
            "solution": "根据指定标准对问题陈述进行有效性审查。\n\n### 问题验证\n\n**第一步：提取已知条件**\n-   **系统：** 均匀、各向同性的单流体等离子体。\n-   **框架：** 理想磁流体动力学 (MHD)。\n-   **变量与常数：** 质量密度 $\\rho$、热压强 $p$、磁场强度 $B$、绝热指数 $\\gamma$、真空磁导率 $\\mu_{0}$。\n-   **定义的速度：** Alfvén 速度 $v_{A}$、绝热声速 $c_{s}$。\n-   **等离子体 Beta ($\\beta$) 的定义：** 热压强与磁压强之比，$\\beta = \\frac{p}{p_{\\text{mag}}}$。\n-   **隐含定义（来自“从基本定义出发”）：**\n    -   磁压强：$p_{\\text{mag}} = \\frac{B^2}{2\\mu_0}$。\n    -   绝热声速：$c_s = \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n    -   Alfvén 速度：$v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}}$。\n-   **任务1（推导）：** 推导一个仅用 $c_s$、$v_A$ 和 $\\gamma$ 表示的 $\\beta$ 表达式。\n-   **任务2（讨论）：** 基于推导出的表达式，简要讨论强场托卡马克核心与近地太阳风中 $\\beta$ 的定性范围。\n-   **最终答案要求：** $\\beta$ 的闭式解析表达式。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学性：** 该问题完全基于理想 MHD 的标准、成熟框架。等离子体 beta 值、Alfvén 速度和声速的定义是等离子体物理学中的基本概念。该问题在科学上是合理的。\n-   **适定性：** 该问题要求从一组一致且充分的定义中进行特定推导。目标陈述清晰，并期望得到唯一的解析解。定性讨论是基于定量结果的标准解释性任务。\n-   **客观性：** 语言正式、精确，没有主观或含糊的术语。\n-   **完整性与一致性：** 所有必要的物理量及其标准定义均已提供，或被隐含要求从基本原理中得出，这些原理在此背景下是明确的。不存在矛盾。\n-   **现实性与可行性：** 该问题在理想 MHD 的理想化模型内进行操作，这是理论等离子体物理学中一个标准且必要的近似。这些条件在物理上并非不可能或不一致。\n\n**第三步：结论与行动**\n该问题有效。这是一个标准的、适定的等离子体物理入门问题，旨在检验对基本 MHD 参数的理解。将提供完整解答。\n\n### 解答\n\n目标是推导等离子体 beta 值 $\\beta$ 的表达式，使其仅用绝热声速 $c_s$、Alfvén 速度 $v_A$ 和绝热指数 $\\gamma$ 表示。\n\n等离子体 beta 值 $\\beta$ 定义为等离子体的热压强 $p$ 与磁压强 $p_{\\text{mag}}$ 之比。\n$$\n\\beta = \\frac{p}{p_{\\text{mag}}}\n$$\n磁压强的基本定义由磁场强度 $B$ 和真空磁导率 $\\mu_{0}$ 给出：\n$$\np_{\\text{mag}} = \\frac{B^2}{2\\mu_{0}}\n$$\n将此定义代入 $\\beta$ 的表达式中，得到：\n$$\n\\beta = \\frac{p}{\\frac{B^2}{2\\mu_{0}}} = \\frac{2\\mu_{0} p}{B^2}\n$$\n该表达式目前依赖于 $p$、$B$ 和 $\\mu_{0}$。题目要求一个用 $c_s$、$v_A$ 和 $\\gamma$ 表示的表达式。为实现这一目标，我们必须使用绝热声速和 Alfvén 速度的定义来替换 $p$ 和 $B^2$。\n\n绝热声速 $c_s$ 定义为：\n$$\nc_s = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\n其中 $\\rho$ 是等离子体质量密度。将此方程平方并整理以求解热压强 $p$，得到：\n$$\nc_s^2 = \\frac{\\gamma p}{\\rho} \\implies p = \\frac{\\rho c_s^2}{\\gamma}\n$$\nAlfvén 速度 $v_A$ 定义为：\n$$\nv_A = \\frac{B}{\\sqrt{\\mu_{0} \\rho}}\n$$\n将此方程平方并整理以求解 $B^2$，得到：\n$$\nv_A^2 = \\frac{B^2}{\\mu_{0} \\rho} \\implies B^2 = \\mu_{0} \\rho v_A^2\n$$\n现在，我们将 $p$ 和 $B^2$ 的表达式代入我们的 $\\beta$ 方程中：\n$$\n\\beta = \\frac{2\\mu_{0} p}{B^2} = \\frac{2\\mu_{0} \\left(\\frac{\\rho c_s^2}{\\gamma}\\right)}{\\mu_{0} \\rho v_A^2}\n$$\n现在我们可以简化这个表达式。分子和分母中都存在的真空磁导率 $\\mu_{0}$ 可以消去。同样，质量密度 $\\rho$ 也可以消去。\n$$\n\\beta = \\frac{2 \\left(\\frac{c_s^2}{\\gamma}\\right)}{v_A^2}\n$$\n整理这些项，得到 $\\beta$ 的最终、简洁的表达式：\n$$\n\\beta = \\frac{2}{\\gamma} \\frac{c_s^2}{v_A^2} = \\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^2\n$$\n此推导依赖于以下假设：一个受理想 MHD 控制的均匀、各向同性的单流体等离子体，对于这种等离子体，$v_A$ 和 $c_s$ 的这些定义是有效的。\n\n### 讨论\n\n推导出的关系式 $\\beta = \\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^2$ 阐明了 $\\beta$ 的物理意义，即衡量流体动力学效应（以 $c_s$ 传播）与磁流体动力学效应（以 $v_A$ 传播）的相对重要性。$\\beta$ 的大小由比率 $\\frac{c_s^2}{v_A^2}$ 直接控制，并与 $\\gamma$ 成反比。\n\n对于大多数完全电离的等离子体，粒子具有三个平动自由度，因此绝热指数为 $\\gamma = \\frac{5}{3}$。因此，因子 $\\frac{2}{\\gamma}$ 为 $\\frac{2}{(5/3)} = \\frac{6}{5} = 1.2$，这是一个数量级为 1 的常数。因此，$\\beta$ 的大小主要由速度平方之比 $\\left(\\frac{c_s}{v_A}\\right)^2$ 决定。\n\n**强场托卡马克核心：**\n-   托卡马克是为聚变等离子体的磁约束而设计的。这要求磁压强远大于等离子体的热压强，以维持稳定性并将高温等离子体约束在容器壁之外。\n-   这意味着 $p_{\\text{mag}} \\gg p$，根据定义，即 $\\beta \\ll 1$。托卡马克核心中 $\\beta$ 的典型值在百分之几的范围内（例如，$0.01  \\beta  0.1$）。\n-   根据我们推导的关系式，如果 $\\beta \\ll 1$，那么必然有 $\\left(\\frac{c_s}{v_A}\\right)^2 \\ll 1$，即 $c_s \\ll v_A$。\n-   这与物理条件相符：托卡马克在非常强的磁场（$B$ 为几个特斯拉）和中等密度下运行，导致极高的 Alfvén 速度 $v_A$。虽然核心温度非常高（导致声速 $c_s$ 也很高），但 $v_A$ 的量级占主导地位。\n\n**近地太阳风：**\n-   太阳风是从太阳向外流动的等离子体流。在近地环境中，行星际磁场相对较弱（量级为纳特斯拉），且等离子体密度远低于托卡马克。\n-   在这种状态下，热压强和磁压强的大小通常相当。它不是一个强磁场主导的环境。\n-   因此，$\\beta$ 通常为 1 的量级（$\\beta \\approx 1$）。在某些区域或特定事件期间，等离子体可能由热压强主导（$\\beta  1$）或由磁压强主导（$\\beta  1$），但 $\\beta \\approx 1$ 是一个特征值。\n-   根据我们推导的关系式，如果 $\\beta \\approx 1$，那么必然有 $\\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^2 \\approx 1$。由于 $\\frac{2}{\\gamma}$ 本身是 1 的量级，这意味着 $\\left(\\frac{c_s}{v_A}\\right)^2 \\approx 1$，即 $c_s \\approx v_A$。\n-   从物理上讲，这意味着在太阳风中，热现象和磁波现象的特征速度是相当的。\n\n总而言之，比率 $\\frac{c_s^2}{v_A^2}$ 是等离子体状态的主要决定因素。一个小的比率表示一个低 $\\beta$ 值、磁场主导的等离子体，如托卡马克核心；而一个量级为 1 的比率则表示一个高 $\\beta$ 值或压强相当的等离子体，如太阳风。",
            "answer": "$$\n\\boxed{\\beta = \\frac{2}{\\gamma} \\left(\\frac{c_s}{v_A}\\right)^{2}}\n$$"
        },
        {
            "introduction": "真实的聚变等离子体远比理想化的各向同性流体复杂，其中加热系统产生的高能快离子和固有的压力各向异性是不可忽视的因素。本练习将引导你通过编程实践，量化这些效应对 $\\beta$ 值测量的影响，并学习如何从基本物理原理出发构建修正模型 。这项技能对于准确解读诊断数据、评估等离子体性能至关重要。",
            "id": "4028402",
            "problem": "要求您设计并实现一个完整的、可运行的程序，该程序能够定量地、算法地展示当仅使用热诊断时，压强各向异性和快离子压强如何对等离子体 β 值的估算产生偏差，并计算有原理依据的修正。请完全从基本定义和定律出发。物理背景为磁化环形等离子体，其总压强由热组分和快离子组分构成，每个组分都可能相对于磁场方向表现出各向异性。\n\n请从以下基本依据出发：\n- 磁流体力学 (MHD) 动量平衡和麦克斯韦应力表明，磁压强由 $$\\frac{B^2}{2 \\mu_0}$$ 给出，其中 $B$ 是磁场强度大小，$\\mu_0$ 是真空磁导率。\n- 回旋等离子体（gyrotropic plasma）的压强张量（Chew-Goldberger-Low (CGL) 形式）为 $$\\mathbf{P} = p_\\perp \\mathbf{I} + \\left(p_\\parallel - p_\\perp\\right) \\mathbf{b}\\mathbf{b},$$ 其中 $p_\\perp$ 和 $p_\\parallel$ 分别是垂直压强和平行压强，$\\mathbf{I}$ 是单位张量，$\\mathbf{b}=\\mathbf{B}/B$ 是沿磁场方向的单位矢量。\n- 在各向同性假设下，由热诊断测量的标量热压强是一个单一值 $p_{\\mathrm{th,iso}}$，它通过数密度 $n_{\\mathrm{th}}$ 和温度 $T_{\\mathrm{th,iso}}$ 由下式构建：$$p_{\\mathrm{th,iso}} = n_{\\mathrm{th}} T_{\\mathrm{th,iso}} e,$$ 其中 $e$ 是元电荷，温度以电子伏特 (eV) 为单位，因此 $T e$ 可将单位转换为焦耳 (SI)。\n- 热组分和快离子组分对平行压强和垂直压强的贡献分别构建为 $$p_{\\mathrm{th,\\perp}} = n_{\\mathrm{th}} T_{\\mathrm{th,\\perp}} e,\\quad p_{\\mathrm{th,\\parallel}} = n_{\\mathrm{th}} T_{\\mathrm{th,\\parallel}} e,$$ 和 $$p_{\\mathrm{f,\\perp}} = n_{\\mathrm{f}} T_{\\mathrm{f,\\perp}} e,\\quad p_{\\mathrm{f,\\parallel}} = n_{\\mathrm{f}} T_{\\mathrm{f,\\parallel}} e,$$ 其中 $n_{\\mathrm{f}}$ 是快离子数密度，$T_{\\mathrm{f,\\perp}}$ 和 $T_{\\mathrm{f,\\parallel}}$ 是它们以电子伏特为单位的垂直和平行温度。\n\n从这些基础出发，请在您的解决方案中推导如何：\n- 构建一个使用 $p_{\\mathrm{th,iso}}$ 和 $B$ 的、朴素的、仅考虑热组分的各向同性 β 估算值。\n- 通过使用从 $\\mathbf{P}$ 推导出的有效标量压强，构建一个考虑了各向异性的、具有物理意义的总 β 值（请从第一性原理证明您的选择）。\n- 构建一个垂直方向的 β 值，该值与跨磁通面的横向压强平衡特别相关。\n- 定义并计算乘法修正因子，用于将朴素的、仅考虑热组分的各向同性 β 值转换为考虑各向异性的总 β 值和垂直方向的 β 值。\n- 应用这些修正来生成修正后的 β 值。\n\n您的程序必须实现所推导的公式，并为每个测试用例计算以下七个浮点数：\n- 朴素的、仅考虑热组分的各向同性 β 值。\n- 考虑各向异性的总 β 值。\n- 垂直方向的 β 值。\n- 将朴素 β 映射到考虑各向异性的总 β 的乘法修正因子。\n- 将该因子应用于朴素 β 后得到的修正后 β 值。\n- 将朴素 β 映射到垂直方向 β 的乘法修正因子。\n- 将该因子应用于朴素 β 后得到的修正后垂直 β 值。\n\n所有温度均以电子伏特 ($\\mathrm{eV}$) 为单位提供，必须使用 $e$ 转换为焦耳。所有密度单位为 $\\mathrm{m}^{-3}$。磁场强度大小单位为特斯拉 ($\\mathrm{T}$)。真空磁导率是常数 $\\mu_0 = 4 \\pi \\times 10^{-7}\\ \\mathrm{N}\\,\\mathrm{A}^{-2}$，元电荷是常数 $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。\n\n不涉及角度单位。等离子体 β 是无量纲的；您的程序必须输出无量纲的浮点数，并四舍五入到 $8$ 位小数。\n\n测试套件：\n请为以下五组参数集提供计算。每个参数集是一个元组 $\\left(B, n_{\\mathrm{th}}, T_{\\mathrm{th,iso}}, T_{\\mathrm{th,\\perp}}, T_{\\mathrm{th,\\parallel}}, n_{\\mathrm{f}}, T_{\\mathrm{f,\\perp}}, T_{\\mathrm{f,\\parallel}}\\right)$，其单位已在上面指定。\n\n- 案例 $1$ (中等各向异性与显著的快离子)：\n  $$\\left(B=5,\\ n_{\\mathrm{th}}=1.0\\times 10^{20},\\ T_{\\mathrm{th,iso}}=11000,\\ T_{\\mathrm{th,\\perp}}=12000,\\ T_{\\mathrm{th,\\parallel}}=10000,\\ n_{\\mathrm{f}}=5.0\\times 10^{18},\\ T_{\\mathrm{f,\\perp}}=150000,\\ T_{\\mathrm{f,\\parallel}}=80000\\right).$$\n- 案例 $2$ (各向同性热组分，无快离子；边界一致性检查)：\n  $$\\left(B=2,\\ n_{\\mathrm{th}}=8.0\\times 10^{19},\\ T_{\\mathrm{th,iso}}=8000,\\ T_{\\mathrm{th,\\perp}}=8000,\\ T_{\\mathrm{th,\\parallel}}=8000,\\ n_{\\mathrm{f}}=0.0,\\ T_{\\mathrm{f,\\perp}}=0,\\ T_{\\mathrm{f,\\parallel}}=0\\right).$$\n- 案例 $3$ (强热组分各向异性与稀疏快离子；各向异性主导的偏差)：\n  $$\\left(B=1,\\ n_{\\mathrm{th}}=2.0\\times 10^{19},\\ T_{\\mathrm{th,iso}}=10000,\\ T_{\\mathrm{th,\\perp}}=20000,\\ T_{\\mathrm{th,\\parallel}}=5000,\\ n_{\\mathrm{f}}=1.0\\times 10^{18},\\ T_{\\mathrm{f,\\perp}}=200000,\\ T_{\\mathrm{f,\\parallel}}=50000\\right).$$\n- 案例 $4$ (各向同性热组分与各向同性快离子；仅快离子导致的偏差)：\n  $$\\left(B=7,\\ n_{\\mathrm{th}}=1.5\\times 10^{20},\\ T_{\\mathrm{th,iso}}=14000,\\ T_{\\mathrm{th,\\perp}}=14000,\\ T_{\\mathrm{th,\\parallel}}=14000,\\ n_{\\mathrm{f}}=1.0\\times 10^{19},\\ T_{\\mathrm{f,\\perp}}=20000,\\ T_{\\mathrm{f,\\parallel}}=20000\\right).$$\n- 案例 $5$ (弱磁场，中等各向异性与高能快离子；高 β 边界情况)：\n  $$\\left(B=0.5,\\ n_{\\mathrm{th}}=5.0\\times 10^{19},\\ T_{\\mathrm{th,iso}}=1800,\\ T_{\\mathrm{th,\\perp}}=2000,\\ T_{\\mathrm{th,\\parallel}}=1500,\\ n_{\\mathrm{f}}=3.0\\times 10^{18},\\ T_{\\mathrm{f,\\perp}}=40000,\\ T_{\\mathrm{f,\\parallel}}=10000\\right).$$\n\n输出格式：\n您的程序应生成单行输出，其中包含一个由方括号括起来的、以逗号分隔的列表。列表中的每个元素对应一个测试用例，并且本身是一个由方括号括起来的、包含七个浮点数的、以逗号分隔的列表。例如，$$\\left[\\left[x_1,x_2,\\dots,x_7\\right],\\left[y_1,y_2,\\dots,y_7\\right],\\dots\\right].$$ 每个浮点数必须四舍五入到 $8$ 位小数。",
            "solution": "我们从力平衡和压强-应力基础开始。磁流体力学 (MHD) 将磁应力处理为产生一个各向同性的磁压强 $$\\frac{B^2}{2\\mu_0}$$ 和一个方向性张力 $-\\frac{\\mathbf{B}\\mathbf{B}}{\\mu_0}$ 的组合。在各向同性等离子体中，流体应力为 $-p\\mathbf{I}$，从而得到我们熟悉的标量 β 值 $$\\beta = \\frac{\\text{plasma pressure}}{\\text{magnetic pressure}} = \\frac{2 \\mu_0 p}{B^2}$$ 。当等离子体是各向异性时，流体应力必须用 Chew-Goldberger-Low (CGL) 压强张量表示\n$$\\mathbf{P} = p_\\perp \\mathbf{I} + \\left(p_\\parallel - p_\\perp\\right)\\mathbf{b}\\mathbf{b},$$\n其中 $p_\\perp$ 和 $p_\\parallel$ 分别表示垂直于和平行于磁场 $\\mathbf{B}$ 的压强，$\\mathbf{b}=\\mathbf{B}/B$ 是沿磁场方向的单位矢量。跨磁通面的局域垂直力平衡直接取决于 $p_\\perp$，而体积能量学和压强的标量度量可以合理地与 $\\mathbf{P}$ 的迹（trace）相关联。其迹为\n$$\\operatorname{Tr}(\\mathbf{P}) = p_\\parallel + 2 p_\\perp,$$\n由此可将有效标量压强定义为迹的平均值\n$$p_{\\mathrm{tr}} = \\frac{1}{3}\\left(p_\\parallel + 2 p_\\perp\\right).$$\n这个 $p_{\\mathrm{tr}}$ 捕捉了 $\\mathbf{P}$ 所蕴含的应力的各向同性部分，而 $p_\\perp$ 则捕捉了在存在磁张力和曲率的情况下与横向压强平衡直接相关的垂直分量。\n\n假设各向同性的热诊断会产生一个单一的热压强值 $p_{\\mathrm{th,iso}}$，它是根据测得的数密度 $n_{\\mathrm{th}}$ 和以电子伏特为单位的标量温度 $T_{\\mathrm{th,iso}}$ 通过下式（以 SI 单位）构建的：\n$$p_{\\mathrm{th,iso}} = n_{\\mathrm{th}} T_{\\mathrm{th,iso}} e,$$\n其中 $e$ 是元电荷，用于将 $\\mathrm{eV}$ 转换为焦耳。实际上，热组分和快离子布居都可能是各向异性的。它们的压强为\n$$p_{\\mathrm{th,\\perp}} = n_{\\mathrm{th}} T_{\\mathrm{th,\\perp}} e,\\quad p_{\\mathrm{th,\\parallel}} = n_{\\mathrm{th}} T_{\\mathrm{th,\\parallel}} e,$$\n和\n$$p_{\\mathrm{f,\\perp}} = n_{\\mathrm{f}} T_{\\mathrm{f,\\perp}} e,\\quad p_{\\mathrm{f,\\parallel}} = n_{\\mathrm{f}} T_{\\mathrm{f,\\parallel}} e.$$\n总的垂直和平行压强则为\n$$p_\\perp = p_{\\mathrm{th,\\perp}} + p_{\\mathrm{f,\\perp}},\\quad p_\\parallel = p_{\\mathrm{th,\\parallel}} + p_{\\mathrm{f,\\parallel}}.$$\n由此，有效标量压强为\n$$p_{\\mathrm{tr}} = \\frac{1}{3}\\left(p_\\parallel + 2 p_\\perp\\right).$$\n\n朴素的、仅考虑热组分的各向同性 β 值通过将 $p_{\\mathrm{th,iso}}$ 代入各向同性 β 公式来定义：\n$$\\beta_{\\mathrm{naive}} = \\frac{2 \\mu_0 p_{\\mathrm{th,iso}}}{B^2}.$$\n考虑各向异性的总 β 值使用基于迹的标量压强：\n$$\\beta_{\\mathrm{tr}} = \\frac{2 \\mu_0 p_{\\mathrm{tr}}}{B^2} = \\frac{2 \\mu_0}{B^2}\\cdot\\frac{1}{3}\\left(p_\\parallel + 2 p_\\perp\\right).$$\n垂直方向的 β 值分离出直接进入跨场压强平衡的横向分量：\n$$\\beta_\\perp = \\frac{2 \\mu_0 p_\\perp}{B^2}.$$\n\n我们现在量化仅使用 $p_{\\mathrm{th,iso}}$ 所引入的偏差。将朴素估计值映射到基于迹的总 β 值的乘法修正因子为\n$$C_{\\mathrm{tr}} = \\frac{p_{\\mathrm{tr}}}{p_{\\mathrm{th,iso}}} = \\frac{\\frac{1}{3}\\left(p_\\parallel + 2 p_\\perp\\right)}{p_{\\mathrm{th,iso}}}.$$\n类似地，将朴素估计值映射到垂直方向 β 值的乘法修正因子为\n$$C_{\\perp} = \\frac{p_\\perp}{p_{\\mathrm{th,iso}}}.$$\n应用这些因子可得到修正后的 β 值：\n$$\\beta_{\\mathrm{corr,tr}} = \\beta_{\\mathrm{naive}}\\, C_{\\mathrm{tr}},\\quad \\beta_{\\mathrm{corr,\\perp}} = \\beta_{\\mathrm{naive}}\\, C_{\\perp}.$$\n这些修正直接揭示了各向异性和快离子压强的角色：当 $p_\\parallel$ 和 $p_\\perp$ 显著偏离热各向同性假设，或当 $p_{\\mathrm{f,\\perp}}$ 和 $p_{\\mathrm{f,\\parallel}}$ 不可忽略时，$C_{\\mathrm{tr}}$ 和 $C_{\\perp}$ 均会超过 1，从而量化了 $\\beta_{\\mathrm{naive}}$ 中的低估程度。\n\n算法设计：\n- 输入磁场强度大小 $B$、热组分和快离子的密度 $n_{\\mathrm{th}}$、$n_{\\mathrm{f}}$，以及温度 $T_{\\mathrm{th,iso}}$、$T_{\\mathrm{th,\\perp}}$、$T_{\\mathrm{th,\\parallel}}$、$T_{\\mathrm{f,\\perp}}$、$T_{\\mathrm{f,\\parallel}}$，其中温度以 $\\mathrm{eV}$ 为单位。\n- 对每个组分，使用 $p = n T e$ 将温度转换为 SI 单位的压强。\n- 求和得到 $p_\\perp$ 和 $p_\\parallel$，然后计算 $p_{\\mathrm{tr}}$。\n- 使用各自的定义计算 $\\beta_{\\mathrm{naive}}$、$\\beta_{\\mathrm{tr}}$ 和 $\\beta_\\perp$。\n- 将 $p_{\\mathrm{tr}}$ 和 $p_\\perp$ 与 $p_{\\mathrm{th,iso}}$ 的比值作为 $C_{\\mathrm{tr}}$ 和 $C_{\\perp}$ 进行计算。\n- 计算 $\\beta_{\\mathrm{corr,tr}} = \\beta_{\\mathrm{naive}} C_{\\mathrm{tr}}$ 和 $\\beta_{\\mathrm{corr,\\perp}} = \\beta_{\\mathrm{naive}} C_{\\perp}$。\n- 将每个结果浮点数四舍五入到 8 位小数，并以要求的列表的列表的单行格式输出。\n\n科学解释：\n- 当 $p_{\\mathrm{f,\\perp}}$ 和 $p_{\\mathrm{f,\\parallel}}$ 非零时，$\\beta_{\\mathrm{naive}}$ 完全忽略了它们的贡献，导致总 β 和垂直 β 的估值偏低。\n- 当 $p_{\\mathrm{th,\\perp}} \\neq p_{\\mathrm{th,\\parallel}}$ 或 $p_{\\mathrm{f,\\perp}} \\neq p_{\\mathrm{f,\\parallel}}$ 时，各向异性会改变 $p_{\\mathrm{tr}}$ 和 $p_\\perp$ 相对于 $p_{\\mathrm{th,iso}}$ 的值，通常会增加有效压强比，从而增大修正因子。\n- 当需要对能量进行与磁压强的标量比较时，基于迹的修正 $C_{\\mathrm{tr}}$ 是合适的；而在 $p_\\perp$ 直接参与的跨场压强平衡情境中，$C_{\\perp}$ 更为合适。\n\n这五个测试案例共同在标准情况、各向同性边界、各向异性主导场景、仅快离子偏差以及低磁场下的高 β 边界情况等多种条件下检验了该算法，确保了覆盖范围和科学真实性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\nMU0 = 4.0 * np.pi * 1e-7  # Vacuum permeability (N A^-2)\nE_CHARGE = 1.602176634e-19  # Elementary charge (C), converts eV to J\n\ndef compute_case(B_T,\n                 n_th_m3, T_th_iso_eV, T_th_perp_eV, T_th_par_eV,\n                 n_fast_m3, T_fast_perp_eV, T_fast_par_eV):\n    # Pressures (Pa) from densities (m^-3) and temperatures (eV)\n    p_th_iso = n_th_m3 * T_th_iso_eV * E_CHARGE\n    p_th_perp = n_th_m3 * T_th_perp_eV * E_CHARGE\n    p_th_par = n_th_m3 * T_th_par_eV * E_CHARGE\n\n    p_fast_perp = n_fast_m3 * T_fast_perp_eV * E_CHARGE\n    p_fast_par = n_fast_m3 * T_fast_par_eV * E_CHARGE\n\n    # Total perpendicular and parallel pressures\n    p_perp_total = p_th_perp + p_fast_perp\n    p_par_total = p_th_par + p_fast_par\n\n    # Trace-based effective scalar pressure\n    p_trace_total = (p_par_total + 2.0 * p_perp_total) / 3.0\n\n    # Beta calculations\n    B2 = B_T ** 2\n    beta_naive = (2.0 * MU0 * p_th_iso) / B2\n    beta_trace = (2.0 * MU0 * p_trace_total) / B2\n    beta_perp = (2.0 * MU0 * p_perp_total) / B2\n\n    # Correction factors and corrected betas\n    # Guard against division by zero if p_th_iso == 0\n    if p_th_iso == 0.0:\n        C_trace = np.nan\n        C_perp = np.nan\n        beta_corr_trace = np.nan\n        beta_corr_perp = np.nan\n    else:\n        C_trace = p_trace_total / p_th_iso\n        C_perp = p_perp_total / p_th_iso\n        beta_corr_trace = beta_naive * C_trace\n        beta_corr_perp = beta_naive * C_perp\n\n    return [\n        beta_naive, beta_trace, beta_perp,\n        C_trace, beta_corr_trace,\n        C_perp, beta_corr_perp\n    ]\n\ndef format_results(results):\n    # Round each float to 8 decimal places and construct the required string\n    def fmt(x):\n        if np.isnan(x):\n            return \"nan\"\n        return f\"{x:.8f}\"\n    formatted_cases = []\n    for case in results:\n        formatted = \"[\" + \",\".join(fmt(val) for val in case) + \"]\"\n        formatted_cases.append(formatted)\n    return \"[\" + \",\".join(formatted_cases) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (B, n_th, T_th_iso, T_th_perp, T_th_parallel, n_fast, T_fast_perp, T_fast_parallel)\n    test_cases = [\n        (5.0, 1.0e20, 11000.0, 12000.0, 10000.0, 5.0e18, 150000.0, 80000.0),\n        (2.0, 8.0e19, 8000.0, 8000.0, 8000.0, 0.0, 0.0, 0.0),\n        (1.0, 2.0e19, 10000.0, 20000.0, 5000.0, 1.0e18, 200000.0, 50000.0),\n        (7.0, 1.5e20, 14000.0, 14000.0, 14000.0, 1.0e19, 20000.0, 20000.0),\n        (0.5, 5.0e19, 1800.0, 2000.0, 1500.0, 3.0e18, 40000.0, 10000.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        res = compute_case(*case)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nsolve()\n```"
        },
        {
            "introduction": "将理论模型与实验数据相结合是聚变研究的核心工作流程。本练习模拟了托卡马克实验中一个关键的验证步骤：检验计算平衡重建的自洽性 。你将学习如何从重建的压力和磁场分布出发，计算出总等离子体电流和归一化贝塔值 $\\beta_N$ 等宏观参数，并将其与实验测量值进行比对，从而评估重建模型的准确性。",
            "id": "4028357",
            "problem": "考虑一个处于静态磁流体动力学 (MHD) 平衡状态的轴对称、大环径比托卡马克等离子体，其圆形截面的小半径为 $a$，大半径为 $R_0$。每弧度的极向磁通量为 $\\psi(r)$，压强为 $p(\\psi)$，并且 $F(\\psi) \\equiv R B_\\phi$，其中 $B_\\phi$ 是环向磁场，$R$ 是大半径坐标。在轴对称和大环径比的假设下（截面上 $R \\approx R_0$），以下基本关系成立：\n- MHD 平衡中的力平衡：$\\nabla p = \\mathbf{j} \\times \\mathbf{B}$。\n- Grad–Shafranov (GS) 框架意味着 $p = p(\\psi)$ 和 $F = F(\\psi)$。\n- 极向磁场满足 $B_\\theta(r) = \\frac{1}{R_0} \\frac{d\\psi}{dr}$。\n- 将安培定律应用于环向电流可得 $I_p = \\frac{2\\pi R_0}{\\mu_0} B_\\theta(a)$，其中 $\\mu_0$ 是真空磁导率。\n\n给定重构提供了以下函数\n$$p(\\psi) = p_0 \\left(1 - \\frac{\\psi}{\\psi_{\\mathrm{edge}}}\\right)^\\alpha,$$\n$$F(\\psi) = F_0 + c_F \\psi,$$\n并指定了磁通-半径映射关系\n$$\\psi(r) = \\psi_{\\mathrm{edge}} \\left(\\frac{r}{a}\\right)^2,$$\n因此 $\\frac{d\\psi}{dr}\\big|_{r=a} = \\frac{2\\psi_{\\mathrm{edge}}}{a}$。\n\n为与实验进行一致性检验，定义以下量：\n- 圆形截面上的面积平均压强为\n$$\\langle p \\rangle = \\frac{1}{\\pi a^2} \\int_0^{2\\pi} \\int_0^{a} p\\left(\\psi(r)\\right) r\\,dr\\,d\\theta,$$\n在给定的 $p(\\psi)$ 和 $\\psi(r)$ 下，这简化为一个仅关于 $r$ 的积分。\n- 边界处的重构环向磁场为\n$$B_{\\phi,\\mathrm{edge}} = \\frac{F(\\psi_{\\mathrm{edge}})}{R_0}.$$\n- 重构的等离子体电流为\n$$I_{p,\\mathrm{rec}} = \\frac{2\\pi R_0}{\\mu_0} B_\\theta(a) = \\frac{2\\pi R_0}{\\mu_0} \\frac{1}{R_0} \\frac{d\\psi}{dr}\\bigg|_{r=a} = \\frac{4\\pi \\psi_{\\mathrm{edge}}}{\\mu_0 a}.$$\n- 相对于真空环向磁场 $B_{T0}$ 的环向 beta 值（以小数表示）为\n$$\\beta_T = \\frac{2 \\mu_0 \\langle p \\rangle}{B_{T0}^2}.$$\n- 归一化 beta 值（无量纲）定义为（电流单位为兆安培）\n$$\\beta_N = \\beta_T \\frac{a\\,B_{T0}}{I_p^{\\mathrm{MA}}},$$\n其中 $I_p^{\\mathrm{MA}}$ 表示以兆安培为单位的等离子体电流。不得使用百分号；所有分数必须表示为小数。\n\n您的程序必须对每个测试用例执行以下操作：\n1. 根据给定的 $p(\\psi)$ 和 $\\psi(r)$ 映射计算 $\\langle p \\rangle$。\n2. 根据 $\\psi_{\\mathrm{edge}}$ 处的 $F(\\psi)$ 计算 $B_{\\phi,\\mathrm{edge}}$，并将其与实验值 $B_{T0}$ 进行比较。\n3. 根据 $\\psi_{\\mathrm{edge}}$ 计算 $I_{p,\\mathrm{rec}}$，并将其与实验值 $I_{p,\\mathrm{exp}}$ 进行比较。\n4. 使用 $B_{T0}$ 计算 $\\beta_T$ 和 $\\beta_N$，然后将 $\\beta_N$ 与实验值 $\\beta_{N,\\mathrm{exp}}$ 进行比较。\n\n当且仅当以下三个相对差异同时有界时，将该案例定义为“一致”：\n- 环向磁场一致性：$\\left| B_{\\phi,\\mathrm{edge}} - B_{T0} \\right| / B_{T0} \\leq \\delta_B$，容差为 $\\delta_B = 10^{-2}$。\n- 等离子体电流一致性：$\\left| I_{p,\\mathrm{rec}} - I_{p,\\mathrm{exp}} \\right| / I_{p,\\mathrm{exp}} \\leq \\delta_I$，容差为 $\\delta_I = 10^{-2}$。\n- 归一化 beta 值一致性：$\\left| \\beta_N - \\beta_{N,\\mathrm{exp}} \\right| / \\beta_{N,\\mathrm{exp}} \\leq \\delta_\\beta$，容差为 $\\delta_\\beta = 5\\times 10^{-2}$。\n\n使用国际单位制 (SI)：$R_0$ 和 $a$ 的单位为米，$B_{T0}$ 的单位为特斯拉，$I_{p,\\mathrm{exp}}$ 的单位为安培，$p_0$ 和 $\\langle p \\rangle$ 的单位为帕斯卡，$\\psi_{\\mathrm{edge}}$ 的单位为韦伯/弧度。将 $\\beta_T$ 和 $\\beta_N$ 表示为无量纲小数。\n\n测试套件：\n- 案例 1（正常路径，预期一致）：\n    - $R_0 = 3.0$, $a = 1.0$, $B_{T0} = 3.0$, $I_{p,\\mathrm{exp}} = 1.5\\times 10^6$, $\\psi_{\\mathrm{edge}} = 0.15$, $p_0 = 2.148\\times 10^5$, $\\alpha = 1.0$, $F_0 = 9.0$, $c_F = 0.0$, $\\beta_{N,\\mathrm{exp}} = 0.06$。\n- 案例 2（边界环向磁场不匹配，预期不一致）：\n    - $R_0 = 3.0$, $a = 1.0$, $B_{T0} = 3.0$, $I_{p,\\mathrm{exp}} = 1.5\\times 10^6$, $\\psi_{\\mathrm{edge}} = 0.15$, $p_0 = 2.148\\times 10^5$, $\\alpha = 1.0$, $F_0 = 8.0$, $c_F = 0.0$, $\\beta_{N,\\mathrm{exp}} = 0.06$。\n- 案例 3（具有弱 $F(\\psi)$ 变化的边界情况，预期一致）：\n    - $R_0 = 3.5$, $a = 0.6$, $B_{T0} = 2.7$, $I_{p,\\mathrm{exp}} = 0.8\\times 10^6$, $\\psi_{\\mathrm{edge}} = 0.048$, $p_0 = 1.7412\\times 10^5$, $\\alpha = 2.0$, $F_0 = 9.45$, $c_F = -0.1$, $\\beta_{N,\\mathrm{exp}} = 0.0405$。\n- 案例 4（压强引起的 $\\beta_N$ 不匹配，预期不一致）：\n    - $R_0 = 3.0$, $a = 1.0$, $B_{T0} = 3.0$, $I_{p,\\mathrm{exp}} = 1.0\\times 10^6$, $\\psi_{\\mathrm{edge}} = 0.1$, $p_0 = 4.3\\times 10^5$, $\\alpha = 1.0$, $F_0 = 9.0$, $c_F = 0.0$, $\\beta_{N,\\mathrm{exp}} = 0.02$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3,result4]”）。每个结果都必须是一个布尔值，指示相应的测试用例在上述标准下是否一致。不得打印任何其他文本。",
            "solution": "问题陈述已经过仔细验证，并被确定为有效。它在科学上基于应用于托卡马克等离子体的磁流体动力学 (MHD) 原理，在数学上是适定的，并且以客观、明确的语言表述。规定计算所需的所有数据均已提供。\n\n核心任务是根据一组实验测量值，验证给定等离子体平衡重构的一致性。这是通过根据重构的剖面计算几个物理量，并将它们与相应的实验值在指定的容差范围内进行比较来完成的。分析过程遵循一系列明确定义的步骤。\n\n首先，我们推导面积平均等离子体压强 $\\langle p \\rangle$ 的解析表达式。其定义如下：\n$$\n\\langle p \\rangle = \\frac{1}{\\pi a^2} \\int_0^{2\\pi} \\int_0^{a} p\\left(\\psi(r)\\right) r\\,dr\\,d\\theta\n$$\n鉴于压强剖面 $p(\\psi(r))$ 与极向角 $\\theta$ 无关，角度积分产生一个因子 $2\\pi$：\n$$\n\\langle p \\rangle = \\frac{2\\pi}{\\pi a^2} \\int_0^{a} p\\left(\\psi(r)\\right) r\\,dr = \\frac{2}{a^2} \\int_0^{a} p\\left(\\psi(r)\\right) r\\,dr\n$$\n我们已知压强剖面 $p(\\psi) = p_0 \\left(1 - \\frac{\\psi}{\\psi_{\\mathrm{edge}}}\\right)^\\alpha$ 和磁通-半径映射 $\\psi(r) = \\psi_{\\mathrm{edge}} \\left(\\frac{r}{a}\\right)^2$。将这些代入被积函数可得：\n$$\np(\\psi(r)) = p_0 \\left(1 - \\frac{\\psi_{\\mathrm{edge}} (r/a)^2}{\\psi_{\\mathrm{edge}}}\\right)^\\alpha = p_0 \\left(1 - \\frac{r^2}{a^2}\\right)^\\alpha\n$$\n$\\langle p \\rangle$ 的积分变为：\n$$\n\\langle p \\rangle = \\frac{2 p_0}{a^2} \\int_0^a \\left(1 - \\frac{r^2}{a^2}\\right)^\\alpha r\\,dr\n$$\n为求解此积分，我们采用换元法，令 $u = 1 - \\frac{r^2}{a^2}$。其微分为 $du = -\\frac{2r}{a^2} dr$，这意味着 $r\\,dr = -\\frac{a^2}{2} du$。积分限从 $r=0$ 变为 $u=1$，从 $r=a$ 变为 $u=0$。积分变换为：\n$$\n\\langle p \\rangle = \\frac{2 p_0}{a^2} \\int_{u=1}^{u=0} u^\\alpha \\left(-\\frac{a^2}{2} du\\right) = -p_0 \\int_1^0 u^\\alpha du = p_0 \\int_0^1 u^\\alpha du\n$$\n这是一个标准的初等积分，其计算结果为：\n$$\n\\langle p \\rangle = p_0 \\left[ \\frac{u^{\\alpha+1}}{\\alpha+1} \\right]_0^1 = p_0 \\left( \\frac{1^{\\alpha+1}}{\\alpha+1} - \\frac{0^{\\alpha+1}}{\\alpha+1} \\right) = \\frac{p_0}{\\alpha+1}\n$$\n这个简洁的结果允许直接从输入参数 $p_0$ 和 $\\alpha$ 计算平均压强。\n\n在建立了 $\\langle p \\rangle$ 的表达式后，我们现在可以概述验证每个测试用例一致性的完整计算过程。\n\n1.  **计算面积平均压强 $\\langle p \\rangle$**：\n    使用推导出的公式计算 $\\langle p \\rangle = \\frac{p_0}{\\alpha+1}$。\n\n2.  **计算重构的环向磁场 $B_{\\phi,\\mathrm{edge}}$**：\n    这是根据函数 $F(\\psi) = F_0 + c_F \\psi$ 在等离子体边界 $\\psi = \\psi_{\\mathrm{edge}}$ 处计算，并由大半径 $R_0$ 归一化得到的。\n    $$\n    B_{\\phi,\\mathrm{edge}} = \\frac{F(\\psi_{\\mathrm{edge}})}{R_0} = \\frac{F_0 + c_F \\psi_{\\mathrm{edge}}}{R_0}\n    $$\n    使用相对差异将此值与实验真空环向磁场 $B_{T0}$ 进行比较：$\\frac{\\left| B_{\\phi,\\mathrm{edge}} - B_{T0} \\right|}{B_{T0}} \\leq \\delta_B$，其中 $\\delta_B = 10^{-2}$。\n\n3.  **计算重构的等离子体电流 $I_{p,\\mathrm{rec}}$**：\n    重构的电流由以下公式给出：\n    $$\n    I_{p,\\mathrm{rec}} = \\frac{4\\pi \\psi_{\\mathrm{edge}}}{\\mu_0 a}\n    $$\n    使用真空磁导率常数 $\\mu_0 = 4\\pi \\times 10^{-7}$ T·m/A，这可简化为 $I_{p,\\mathrm{rec}} = \\frac{\\psi_{\\mathrm{edge}}}{a} \\times 10^7$ 安培。将其与实验等离子体电流 $I_{p,\\mathrm{exp}}$ 进行比较：$\\frac{\\left| I_{p,\\mathrm{rec}} - I_{p,\\mathrm{exp}} \\right|}{I_{p,\\mathrm{exp}}} \\leq \\delta_I$，其中 $\\delta_I = 10^{-2}$。\n\n4.  **计算归一化 beta 值 $\\beta_N$**：\n    这需要两个子步骤。首先，计算环向 beta 值 $\\beta_T$：\n    $$\n    \\beta_T = \\frac{2 \\mu_0 \\langle p \\rangle}{B_{T0}^2}\n    $$\n    接下来，用它来求归一化 beta 值 $\\beta_N$。这是使用转换为兆安培（$I_{p,\\mathrm{exp}}^{\\mathrm{MA}} = I_{p,\\mathrm{exp}} / 10^6$）的实验等离子体电流 $I_{p,\\mathrm{exp}}$ 进行归一化的。\n    $$\n    \\beta_N = \\beta_T \\frac{a\\,B_{T0}}{I_{p,\\mathrm{exp}}^{\\mathrm{MA}}}\n    $$\n    将计算出的 $\\beta_N$ 与实验值 $\\beta_{N,\\mathrm{exp}}$ 进行比较：$\\frac{\\left| \\beta_N - \\beta_{N,\\mathrm{exp}} \\right|}{\\beta_{N,\\mathrm{exp}}} \\leq \\delta_\\beta$，其中 $\\delta_\\beta = 5\\times 10^{-2}$。\n\n5.  **最终判定**：当且仅当上述所有三个不等式检查都满足时，一个测试用例才被视为“一致”。否则，它就是“不一致”的。程序将对每个测试用例执行这些步骤，并报告布尔结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the plasma equilibrium consistency problem for a suite of test cases.\n    \"\"\"\n    # Define physical and problem-specific constants\n    MU0 = 4 * np.pi * 1e-7  # Vacuum permeability in T·m/A\n    DELTA_B = 1e-2\n    DELTA_I = 1e-2\n    DELTA_BETA = 5e-2\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        # Case 1: happy path, expected consistent\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_T0\": 3.0, \"I_p_exp\": 1.5e6, \"psi_edge\": 0.15,\n            \"p0\": 2.148e5, \"alpha\": 1.0, \"F0\": 9.0, \"c_F\": 0.0, \"beta_N_exp\": 0.06\n        },\n        # Case 2: edge toroidal field mismatch, expected inconsistent\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_T0\": 3.0, \"I_p_exp\": 1.5e6, \"psi_edge\": 0.15,\n            \"p0\": 2.148e5, \"alpha\": 1.0, \"F0\": 8.0, \"c_F\": 0.0, \"beta_N_exp\": 0.06\n        },\n        # Case 3: boundary case, expected consistent\n        {\n            \"R0\": 3.5, \"a\": 0.6, \"B_T0\": 2.7, \"I_p_exp\": 0.8e6, \"psi_edge\": 0.048,\n            \"p0\": 1.7412e5, \"alpha\": 2.0, \"F0\": 9.45, \"c_F\": -0.1, \"beta_N_exp\": 0.0405\n        },\n        # Case 4: pressure-induced beta_N mismatch, expected inconsistent\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_T0\": 3.0, \"I_p_exp\": 1.0e6, \"psi_edge\": 0.1,\n            \"p0\": 4.3e5, \"alpha\": 1.0, \"F0\": 9.0, \"c_F\": 0.0, \"beta_N_exp\": 0.02\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for clarity\n        R0 = case[\"R0\"]\n        a = case[\"a\"]\n        B_T0 = case[\"B_T0\"]\n        I_p_exp = case[\"I_p_exp\"]\n        psi_edge = case[\"psi_edge\"]\n        p0 = case[\"p0\"]\n        alpha = case[\"alpha\"]\n        F0 = case[\"F0\"]\n        c_F = case[\"c_F\"]\n        beta_N_exp = case[\"beta_N_exp\"]\n\n        # 1. Compute area-averaged pressure\n        avg_pressure = p0 / (alpha + 1.0)\n\n        # 2. Toroidal field consistency check\n        F_psi_edge = F0 + c_F * psi_edge\n        B_phi_edge_rec = F_psi_edge / R0\n        discrepancy_B = abs(B_phi_edge_rec - B_T0) / B_T0\n        is_consistent_B = discrepancy_B = DELTA_B\n\n        # 3. Plasma current consistency check\n        # Simplified formula: I_p_rec = (psi_edge / a) * 1e7\n        I_p_rec = (psi_edge / a) * 1e7\n        discrepancy_I = abs(I_p_rec - I_p_exp) / I_p_exp\n        is_consistent_I = discrepancy_I = DELTA_I\n\n        # 4. Normalized beta consistency check\n        # Compute toroidal beta\n        beta_T_rec = (2 * MU0 * avg_pressure) / (B_T0**2)\n        \n        # Convert experimental current to Mega-Amperes for beta_N formula\n        I_p_exp_MA = I_p_exp / 1e6\n        \n        # Compute normalized beta\n        beta_N_rec = beta_T_rec * (a * B_T0) / I_p_exp_MA\n        \n        # Handle the case where beta_N_exp is zero to avoid division by zero\n        if beta_N_exp == 0:\n            discrepancy_beta = abs(beta_N_rec)\n        else:\n            discrepancy_beta = abs(beta_N_rec - beta_N_exp) / beta_N_exp\n            \n        is_consistent_beta = discrepancy_beta = DELTA_BETA\n\n        # A case is consistent if and only if all three checks pass\n        is_consistent_case = is_consistent_B and is_consistent_I and is_consistent_beta\n        results.append(str(is_consistent_case).lower())\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\n```"
        }
    ]
}