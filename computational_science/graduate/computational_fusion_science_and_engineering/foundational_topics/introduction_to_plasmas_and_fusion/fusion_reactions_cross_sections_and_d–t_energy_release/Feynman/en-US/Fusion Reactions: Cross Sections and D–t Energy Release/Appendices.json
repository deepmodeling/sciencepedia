{
    "hands_on_practices": [
        {
            "introduction": "Understanding the energy released in a fusion reaction is the first step in assessing its potential as an energy source. This practice guides you through a foundational calculation of the reaction $Q$-value, applying the principle of mass-energy equivalence ($E=mc^2$) to the primary deuterium-tritium (D-T) and deuterium-deuterium (D-D) fusion reactions. By working from the rest masses of the reactants and products, you will quantify why D-T is the most energetically favorable fusion reaction for near-term energy applications .",
            "id": "3983985",
            "problem": "A deuterium–tritium reaction and a deuterium–deuterium reaction proceed through distinct channels determined by conservation of baryon number, electric charge, and mass–energy. Using first principles of mass–energy conservation $E = mc^{2}$ and without invoking any shortcut reaction energetics, determine the thermonuclear-average energy release per deuterium–deuterium fusion event and compare it to the energy release of deuterium–tritium fusion. Specifically:\n\n- Identify from conservation principles the energetically allowed light-particle exit channels for deuterium–deuterium fusion and for deuterium–tritium fusion, and use atomic rest masses to compute the corresponding $Q$-values via $Q = \\left(m_{\\mathrm{initial}} - m_{\\mathrm{final}}\\right)c^{2}$ for each channel.\n- Assume that at a center-of-mass energy $E_{\\mathrm{cm}} = 50\\,\\mathrm{keV}$ the two deuterium–deuterium channels have equal partial cross sections, so the thermonuclear-average deuterium–deuterium energy release is the arithmetic mean of the two deuterium–deuterium channel $Q$-values.\n\nUse the following atomic rest masses in unified atomic mass units $\\,\\mathrm{u}\\,$ (neutral atoms, so bound-electron masses cancel consistently across reactants and products):\n$m_{\\mathrm{D}} = 2.01410177812\\,\\mathrm{u}$, $m_{\\mathrm{T}} = 3.01604928199\\,\\mathrm{u}$, $m_{{}^{3}\\mathrm{He}} = 3.0160293201\\,\\mathrm{u}$, $m_{{}^{4}\\mathrm{He}} = 4.00260325413\\,\\mathrm{u}$, $m_{\\mathrm{H}} = 1.00782503223\\,\\mathrm{u}$, $m_{n} = 1.00866491588\\,\\mathrm{u}$, and the conversion $1\\,\\mathrm{u} = 931.49410242\\,\\mathrm{MeV}/c^{2}$.\n\nCompute the ratio $\\mathcal{R}$ of the deuterium–tritium $Q$-value to the thermonuclear-average deuterium–deuterium $Q$-value. Express $\\mathcal{R}$ as a dimensionless number and round your final answer to four significant figures.",
            "solution": "The user-provided problem is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\nThe verbatim givens extracted from the problem statement are as follows:\n-   **Principle 1**: Deuterium–tritium (D–T) and deuterium–deuterium (D–D) reactions are determined by conservation of baryon number, electric charge, and mass–energy.\n-   **Principle 2**: Mass–energy conservation is given by $E = mc^{2}$.\n-   **Formula**: The energy release, or $Q$-value, is $Q = \\left(m_{\\mathrm{initial}} - m_{\\mathrm{final}}\\right)c^{2}$.\n-   **Condition**: For D–D fusion at a center-of-mass energy $E_{\\mathrm{cm}} = 50\\,\\mathrm{keV}$, the two energetically allowed light-particle exit channels have equal partial cross sections.\n-   **Definition**: The thermonuclear-average D–D energy release is the arithmetic mean of the two D–D channel $Q$-values.\n-   **Atomic Rest Masses (in unified atomic mass units, $\\mathrm{u}$)**:\n    -   $m_{\\mathrm{D}} = 2.01410177812\\,\\mathrm{u}$\n    -   $m_{\\mathrm{T}} = 3.01604928199\\,\\mathrm{u}$\n    -   $m_{{}^{3}\\mathrm{He}} = 3.0160293201\\,\\mathrm{u}$\n    -   $m_{{}^{4}\\mathrm{He}} = 4.00260325413\\,\\mathrm{u}$\n    -   $m_{\\mathrm{H}} = 1.00782503223\\,\\mathrm{u}$ (for protium, ${}^{1}\\mathrm{H}$)\n    -   $m_{n} = 1.00866491588\\,\\mathrm{u}$ (for a neutron)\n-   **Conversion Constant**: $1\\,\\mathrm{u} = 931.49410242\\,\\mathrm{MeV}/c^{2}$.\n-   **Objective**: Compute the ratio $\\mathcal{R}$ of the D–T $Q$-value to the thermonuclear-average D–D $Q$-value.\n-   **Formatting**: Round the final answer for $\\mathcal{R}$ to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity against the established criteria.\n-   **Scientifically Grounded**: The problem is fundamentally sound. It is based on the core principles of nuclear physics, namely mass-energy equivalence ($E=mc^2$) and conservation laws (baryon number and charge). The reactions D–T and D–D are central to fusion energy research. The provided atomic masses are consistent with high-precision, accepted values (e.g., from the AME2020 atomic mass evaluation). The use of neutral atomic masses for Q-value calculations is a standard and valid technique, as the masses of electrons cancel out when charge is conserved. The assumption of equal branching ratios ($50\\%/50\\%$) for the two D–D channels is a reasonable and common simplification for educational problems, as the experimental values are nearly equal over a wide energy range, including the stated $50\\,\\mathrm{keV}$.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary data (masses, conversion factor) and a clear, unambiguous calculational path. The objective is specific and a unique solution exists.\n-   **Objective**: The language is precise, quantitative, and free of any subjectivity or bias.\n\nThe problem does not violate any of the invalidity criteria. It is scientifically sound, formalizable, complete, realistic, well-posed, and non-trivial.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full, reasoned solution will be provided.\n\n### Solution\nThe solution proceeds by first identifying the reaction products using conservation laws, then calculating the mass defect and corresponding $Q$-value for each reaction channel, and finally computing the required ratio.\n\n**1. Identification of Reaction Channels**\nLet a nucleus be denoted by ${}^{A}_{Z}X$, where $A$ is the baryon number (total number of protons and neutrons) and $Z$ is the charge number (number of protons). Conservation laws require that the sums of $A$ and $Z$ for the reactants equal the sums for the products.\n\n-   **Deuterium–Tritium (D–T) Fusion:**\n    The reactants are deuterium (${}^{2}_{1}\\mathrm{D}$) and tritium (${}^{3}_{1}\\mathrm{T}$).\n    -   Initial state: ${}^{2}_{1}\\mathrm{D} + {}^{3}_{1}\\mathrm{T}$\n    -   Total initial baryon number: $A_{\\mathrm{initial}} = 2 + 3 = 5$\n    -   Total initial charge number: $Z_{\\mathrm{initial}} = 1 + 1 = 2$\n    The products must have $A_{\\mathrm{final}} = 5$ and $Z_{\\mathrm{final}} = 2$. A highly stable nucleus is the alpha particle (${}^{4}_{2}\\mathrm{He}$). If this is one product, the other must have $A = 5 - 4 = 1$ and $Z = 2 - 2 = 0$. This particle is the neutron (${}^{1}_{0}n$).\n    The reaction is:\n    $$ {}^{2}_{1}\\mathrm{D} + {}^{3}_{1}\\mathrm{T} \\rightarrow {}^{4}_{2}\\mathrm{He} + {}^{1}_{0}n $$\n\n-   **Deuterium–Deuterium (D–D) Fusion:**\n    The reactants are two deuterium nuclei (${}^{2}_{1}\\mathrm{D}$).\n    -   Initial state: ${}^{2}_{1}\\mathrm{D} + {}^{2}_{1}\\mathrm{D}$\n    -   Total initial baryon number: $A_{\\mathrm{initial}} = 2 + 2 = 4$\n    -   Total initial charge number: $Z_{\\mathrm{initial}} = 1 + 1 = 2$\n    The products must have $A_{\\mathrm{final}} = 4$ and $Z_{\\mathrm{final}} = 2$. Two primary light-particle channels exist:\n    -   **Channel 1 (neutron branch):** The products can be helium-3 (${}^{3}_{2}\\mathrm{He}$) and a neutron (${}^{1}_{0}n$). Here, $A_{\\mathrm{final}} = 3 + 1 = 4$ and $Z_{\\mathrm{final}} = 2 + 0 = 2$. The reaction is:\n        $$ {}^{2}_{1}\\mathrm{D} + {}^{2}_{1}\\mathrm{D} \\rightarrow {}^{3}_{2}\\mathrm{He} + {}^{1}_{0}n $$\n    -   **Channel 2 (proton branch):** The products can be tritium (${}^{3}_{1}\\mathrm{T}$) and a proton (${}^{1}_{1}\\mathrm{H}$). Here, $A_{\\mathrm{final}} = 3 + 1 = 4$ and $Z_{\\mathrm{final}} = 1 + 1 = 2$. The reaction is:\n        $$ {}^{2}_{1}\\mathrm{D} + {}^{2}_{1}\\mathrm{D} \\rightarrow {}^{3}_{1}\\mathrm{T} + {}^{1}_{1}\\mathrm{H} $$\n\n**2. Calculation of Q-values**\nThe $Q$-value is calculated from the mass defect, $\\Delta m = m_{\\mathrm{initial}} - m_{\\mathrm{final}}$, using the provided atomic masses. The use of neutral atomic masses is appropriate as the total electric charge $Z$ is conserved in each reaction, ensuring that the total mass of orbital electrons cancels on both sides of the mass balance equation. The conversion constant $C = 931.49410242\\,\\mathrm{MeV}/(c^{2} \\cdot \\mathrm{u})$ allows us to write $Q = (\\Delta m / \\mathrm{u}) \\times 931.49410242\\,\\mathrm{MeV}$.\n\n-   **$Q$-value for D–T Fusion ($Q_{\\mathrm{D-T}}$):**\n    -   Initial mass: $m_{\\mathrm{initial}} = m_{\\mathrm{D}} + m_{\\mathrm{T}} = 2.01410177812\\,\\mathrm{u} + 3.01604928199\\,\\mathrm{u} = 5.03015106011\\,\\mathrm{u}$\n    -   Final mass: $m_{\\mathrm{final}} = m_{{}^{4}\\mathrm{He}} + m_{n} = 4.00260325413\\,\\mathrm{u} + 1.00866491588\\,\\mathrm{u} = 5.01126816901\\,\\mathrm{u}$\n    -   Mass defect: $\\Delta m_{\\mathrm{D-T}} = m_{\\mathrm{initial}} - m_{\\mathrm{final}} = 5.03015106011\\,\\mathrm{u} - 5.01126816901\\,\\mathrm{u} = 0.0188828911\\,\\mathrm{u}$\n\n-   **$Q$-values for D–D Fusion:**\n    -   Initial mass for both channels: $m_{\\mathrm{initial}} = m_{\\mathrm{D}} + m_{\\mathrm{D}} = 2 \\times 2.01410177812\\,\\mathrm{u} = 4.02820355624\\,\\mathrm{u}$\n    -   **Channel 1 ($Q_{\\mathrm{D-D},1}$):**\n        -   Final mass: $m_{\\mathrm{final},1} = m_{{}^{3}\\mathrm{He}} + m_{n} = 3.0160293201\\,\\mathrm{u} + 1.00866491588\\,\\mathrm{u} = 4.02469423598\\,\\mathrm{u}$\n        -   Mass defect: $\\Delta m_{\\mathrm{D-D},1} = 4.02820355624\\,\\mathrm{u} - 4.02469423598\\,\\mathrm{u} = 0.00350932026\\,\\mathrm{u}$\n    -   **Channel 2 ($Q_{\\mathrm{D-D},2}$):**\n        -   Final mass: $m_{\\mathrm{final},2} = m_{\\mathrm{T}} + m_{\\mathrm{H}} = 3.01604928199\\,\\mathrm{u} + 1.00782503223\\,\\mathrm{u} = 4.02387431422\\,\\mathrm{u}$\n        -   Mass defect: $\\Delta m_{\\mathrm{D-D},2} = 4.02820355624\\,\\mathrm{u} - 4.02387431422\\,\\mathrm{u} = 0.00432924202\\,\\mathrm{u}$\n\n**3. Thermonuclear-Average D–D Q-value**\nThe problem stipulates that the two D–D channels have equal partial cross sections, so the thermonuclear-average $Q$-value, $\\langle Q_{\\mathrm{D-D}} \\rangle$, is the arithmetic mean of the channel $Q$-values. This is equivalent to averaging the mass defects.\n$$ \\langle \\Delta m_{\\mathrm{D-D}} \\rangle = \\frac{\\Delta m_{\\mathrm{D-D},1} + \\Delta m_{\\mathrm{D-D},2}}{2} $$\n$$ \\langle \\Delta m_{\\mathrm{D-D}} \\rangle = \\frac{0.00350932026\\,\\mathrm{u} + 0.00432924202\\,\\mathrm{u}}{2} = \\frac{0.00783856228\\,\\mathrm{u}}{2} = 0.00391928114\\,\\mathrm{u} $$\n\n**4. Calculation of the Ratio $\\mathcal{R}$**\nThe ratio $\\mathcal{R}$ is defined as $\\frac{Q_{\\mathrm{D-T}}}{\\langle Q_{\\mathrm{D-D}} \\rangle}$. Since $Q$ is directly proportional to $\\Delta m$, the conversion constants cancel out, and the ratio can be computed directly from the mass defects.\n$$ \\mathcal{R} = \\frac{Q_{\\mathrm{D-T}}}{\\langle Q_{\\mathrm{D-D}} \\rangle} = \\frac{\\Delta m_{\\mathrm{D-T}} \\cdot c^2}{\\langle \\Delta m_{\\mathrm{D-D}} \\rangle \\cdot c^2} = \\frac{\\Delta m_{\\mathrm{D-T}}}{\\langle \\Delta m_{\\mathrm{D-D}} \\rangle} $$\n$$ \\mathcal{R} = \\frac{0.0188828911\\,\\mathrm{u}}{0.00391928114\\,\\mathrm{u}} \\approx 4.81804006 $$\nRounding this result to four significant figures as required by the problem statement gives $4.818$.\nFor completeness, the individual energy releases are:\n$Q_{\\mathrm{D-T}} = 0.0188828911 \\times 931.49410242 \\approx 17.589\\,\\mathrm{MeV}$\n$\\langle Q_{\\mathrm{D-D}} \\rangle = 0.00391928114 \\times 931.49410242 \\approx 3.651\\,\\mathrm{MeV}$\nThe ratio is $\\frac{17.589...}{3.651...} \\approx 4.818$.",
            "answer": "$$\\boxed{4.818}$$"
        },
        {
            "introduction": "The energy released per reaction is only half of the story; the rate at which these reactions occur determines the fusion power output. This exercise bridges the gap between the microscopic physics of collision cross sections, captured by the Maxwellian-averaged reactivity $\\langle \\sigma v \\rangle$, and the macroscopic engineering parameter of fusion power density. You will perform a crucial dimensional analysis and unit conversion to ensure physical consistency, a critical skill in any computational physics or engineering model .",
            "id": "4038580",
            "problem": "A thermal plasma contains equal deuterium and tritium number densities and is sufficiently collisional that their relative speed distribution is close to Maxwellian. The reaction rate density is defined as the number of binary fusion reactions per unit volume per unit time that result from particle collisions. Starting only from the dimensional definitions of microscopic cross section and particle speed, derive the International System of Units (SI) for the Maxwellian-averaged reactivity $\\langle \\sigma v \\rangle$, where $\\sigma$ is the microscopic fusion cross section with units of area and $v$ is the relative speed. Contrast these SI units with the customary units often used in fusion data tables. Then, use these unit relations to compute a physically consistent fusion power density for the deuterium–tritium reaction.\n\nAssume the following data are scientifically reasonable at the specified conditions:\n- Deuterium number density $n_{\\mathrm{D}} = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$.\n- Tritium number density $n_{\\mathrm{T}} = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$.\n- Maxwellian-averaged reactivity at the given plasma temperature $\\langle \\sigma v \\rangle = 1.0 \\times 10^{-16}\\,\\text{cm}^{3}\\,\\text{s}^{-1}$.\n- Fusion $Q$-value (energy released per reaction) for deuterium–tritium: $17.6\\,\\text{MeV}$.\n- Energy unit conversion: $1\\,\\text{eV} = 1.602176634 \\times 10^{-19}\\,\\text{J}$.\n\nTasks:\n1. By dimensional reasoning from $\\sigma$ measured in $\\text{m}^{2}$ and $v$ in $\\text{m}\\,\\text{s}^{-1}$, derive the SI units of $\\langle \\sigma v \\rangle$ and explain why this quantity naturally appears in the parameterization of the reaction rate density.\n2. Determine the conversion factor between the customary unit $\\text{cm}^{3}\\,\\text{s}^{-1}$ and the SI unit for $\\langle \\sigma v \\rangle$, and convert the given $\\langle \\sigma v \\rangle$ to SI units.\n3. Using only dimensionally consistent quantities, compute the deuterium–tritium fusion power density, expressed in $\\text{MW}\\,\\text{m}^{-3}$.\n\nRound your final numerical answer to three significant figures and express it in $\\text{MW}\\,\\text{m}^{-3}$.",
            "solution": "The reaction rate density is the number of binary fusion reactions per unit volume per unit time. For two species with number densities $n_{1}$ and $n_{2}$ and relative speed distribution characterized by a probability density over relative speeds, the total reaction rate density can be written as an integral over the relative velocity space. The relevant microscopic inputs are the cross section $\\sigma$ and the relative speed $v_{\\mathrm{rel}}$.\n\nFirst, establish the dimensions of the building blocks:\n- The microscopic cross section has units of area, so $[\\sigma] = \\text{m}^{2}$.\n- The relative speed has units of speed, so $[v_{\\mathrm{rel}}] = \\text{m}\\,\\text{s}^{-1}$.\n\nThe product $\\sigma v_{\\mathrm{rel}}$ thus has units\n$$\n[\\sigma v_{\\mathrm{rel}}] = \\text{m}^{2} \\cdot \\text{m}\\,\\text{s}^{-1} = \\text{m}^{3}\\,\\text{s}^{-1}.\n$$\nThe Maxwellian-averaged reactivity $\\langle \\sigma v \\rangle$ is defined as the average of $\\sigma v_{\\mathrm{rel}}$ over the distribution of relative speeds, which does not change its dimensions. Therefore, the SI units of $\\langle \\sigma v \\rangle$ are\n$$\n[\\langle \\sigma v \\rangle] = \\text{m}^{3}\\,\\text{s}^{-1}.\n$$\nThis quantity appears naturally in the parameterization of the reaction rate density because, for binary collisions between unlike species, the rate density $R$ can be expressed as the product of the number densities and the averaged microscopic reaction kernel, giving $R$ proportional to $n_{1} n_{2} \\langle \\sigma v \\rangle$. Dimensional consistency confirms this: $[n_{1} n_{2} \\langle \\sigma v \\rangle] = (\\text{m}^{-3})(\\text{m}^{-3})(\\text{m}^{3}\\,\\text{s}^{-1}) = \\text{m}^{-3}\\,\\text{s}^{-1}$, which is the unit of reactions per unit volume per unit time.\n\nNext, contrast the SI units with the customary units used in fusion data tables. The customary unit for $\\langle \\sigma v \\rangle$ is $\\text{cm}^{3}\\,\\text{s}^{-1}$. Since $1\\,\\text{cm} = 10^{-2}\\,\\text{m}$, it follows that\n$$\n1\\,\\text{cm}^{3} = (10^{-2}\\,\\text{m})^{3} = 10^{-6}\\,\\text{m}^{3}.\n$$\nTherefore, the conversion factor between $\\text{cm}^{3}\\,\\text{s}^{-1}$ and $\\text{m}^{3}\\,\\text{s}^{-1}$ is\n$$\n1\\,\\text{cm}^{3}\\,\\text{s}^{-1} = 10^{-6}\\,\\text{m}^{3}\\,\\text{s}^{-1}.\n$$\nApplying this conversion to the given reactivity,\n$$\n\\langle \\sigma v \\rangle = 1.0 \\times 10^{-16}\\,\\text{cm}^{3}\\,\\text{s}^{-1} = 1.0 \\times 10^{-16} \\times 10^{-6}\\,\\text{m}^{3}\\,\\text{s}^{-1} = 1.0 \\times 10^{-22}\\,\\text{m}^{3}\\,\\text{s}^{-1}.\n$$\n\nNow compute the reaction rate density for deuterium–tritium collisions. With $n_{\\mathrm{D}} = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$ and $n_{\\mathrm{T}} = 1.0 \\times 10^{20}\\,\\text{m}^{-3}$, and using the Maxwellian-averaged reactivity in SI units,\n$$\nR = n_{\\mathrm{D}}\\,n_{\\mathrm{T}}\\,\\langle \\sigma v \\rangle = \\left(1.0 \\times 10^{20}\\,\\text{m}^{-3}\\right)\\left(1.0 \\times 10^{20}\\,\\text{m}^{-3}\\right)\\left(1.0 \\times 10^{-22}\\,\\text{m}^{3}\\,\\text{s}^{-1}\\right).\n$$\nThis gives a reaction rate density of:\n$$\nR = 1.0 \\times 10^{18}\\,\\text{m}^{-3}\\,\\text{s}^{-1}.\n$$\n\nConvert the deuterium–tritium fusion $Q$-value to joules. The given $Q$-value is $17.6\\,\\text{MeV}$. Using $1\\,\\text{eV} = 1.602176634 \\times 10^{-19}\\,\\text{J}$,\n$$\nQ = 17.6\\,\\text{MeV} = 17.6 \\times 10^{6}\\,\\text{eV} \\times (1.602176634 \\times 10^{-19}\\,\\text{J}/\\text{eV}) \\approx 2.8198 \\times 10^{-12}\\,\\text{J}.\n$$\nThe fusion power density $P$ is the energy released per unit volume per unit time:\n$$\nP = R \\cdot Q = (1.0 \\times 10^{18}\\,\\text{m}^{-3}\\,\\text{s}^{-1}) \\cdot (2.8198 \\times 10^{-12}\\,\\text{J}) \\approx 2.8198 \\times 10^{6}\\,\\text{W}\\,\\text{m}^{-3}.\n$$\nConvert watts to megawatts via $1\\,\\text{MW} = 10^{6}\\,\\text{W}$:\n$$\nP = 2.8198\\,\\text{MW}\\,\\text{m}^{-3}.\n$$\nRounded to three significant figures, the result is:\n$$\nP \\approx 2.82\\,\\text{MW}\\,\\text{m}^{-3}.\n$$\nThis result is consistent with the dimensional derivation of $\\langle \\sigma v \\rangle$ in SI units and its conversion from $\\text{cm}^{3}\\,\\text{s}^{-1}$.",
            "answer": "$$\\boxed{2.82}$$"
        },
        {
            "introduction": "Calculating the Maxwellian-averaged reactivity $\\langle \\sigma v \\rangle$ is a formidable numerical challenge due to the integrand's sharp, narrow \"Gamow peak.\" This advanced practice introduces a powerful computational technique, importance-sampled Monte Carlo, to efficiently solve this integral. You will design and implement an estimator that concentrates sampling in the most important energy region, and analyze its statistical efficiency by comparing its variance to a more naive sampling method .",
            "id": "3983973",
            "problem": "You are tasked with designing a complete, runnable program that constructs a Monte Carlo estimator for the deuterium–tritium fusion reactivity $\\langle \\sigma v \\rangle$ using importance sampling concentrated near the Gamow peak and analyzes its variance. The program must derive the estimator starting from fundamental definitions, implement the sampling scheme, and compute numerical estimates for a specified test suite. All symbols and mathematical entities must be expressed in LaTeX.\n\nThe starting point is the definition of the reaction rate per pair in a thermal plasma. For two ion species with reduced mass $\\,\\mu\\,$ in thermal equilibrium at ion temperature $\\,T\\,$, the velocity distribution of relative motion is Maxwell–Boltzmann. The reactivity is defined as the thermal average\n$$\n\\langle \\sigma v \\rangle = \\int_{0}^{\\infty} \\sigma(v)\\, v\\, f_v(v;T)\\, dv,\n$$\nwhere $\\,\\sigma(v)\\,$ is the fusion cross section and $\\,f_v(v;T)\\,$ is the Maxwell–Boltzmann distribution of relative speed. Using the kinetic energy $\\,E = \\tfrac{1}{2}\\mu v^2\\,$, the reactivity can be expressed as\n$$\n\\langle \\sigma v \\rangle = \\frac{2}{\\sqrt{\\pi}} \\left(\\frac{2}{\\mu}\\right)^{1/2} \\frac{1}{(k_B T)^{3/2}} \\int_{0}^{\\infty} \\sigma(E)\\, E\\, \\exp\\!\\left(-\\frac{E}{k_B T}\\right) dE,\n$$\nwhere $\\,k_B\\,$ is the Boltzmann constant. Define the integral\n$$\nI(T) \\equiv \\int_{0}^{\\infty} \\sigma(E)\\, E\\, \\exp\\!\\left(-\\frac{E}{k_B T}\\right) dE,\n$$\nso that\n$$\n\\langle \\sigma v \\rangle = C(T) \\, I(T), \\quad C(T) = \\frac{2}{\\sqrt{\\pi}} \\left(\\frac{2}{\\mu}\\right)^{1/2} \\frac{1}{(k_B T)^{3/2}}.\n$$\n\nFor charged particle reactions, the cross section exhibits tunneling suppression described by the Gamow factor. Adopt the widely used nonresonant approximation for the deuterium–tritium cross section\n$$\n\\sigma(E) = \\frac{S_0}{E} \\, \\exp\\!\\left(-\\sqrt{\\frac{E_G}{E}}\\right),\n$$\nwhere $\\,S_0\\,$ is a slowly varying astrophysical factor approximated as constant over the thermal range of interest, and $\\,E_G\\,$ is the Gamow energy for $\\,Z_1 = Z_2 = 1\\,$ given by\n$$\nE_G = \\frac{1}{2} \\, \\mu \\, c^2 \\, \\left(2\\pi \\alpha\\right)^2.\n$$\nHere $\\,\\alpha\\,$ is the fine-structure constant and $\\,c\\,$ is the speed of light. This places the integrand of $\\,I(T)\\,$ as\n$$\nh_T(E) = \\sigma(E)\\, E\\, \\exp\\!\\left(-\\frac{E}{k_B T}\\right) = S_0 \\, \\exp\\!\\left(-\\frac{E}{k_B T} - \\sqrt{\\frac{E_G}{E}}\\right).\n$$\nThe location of the Gamow peak $\\,E_0\\,$ is defined by the stationary point of the exponent $\\,g_T(E) = \\frac{E}{k_B T} + \\sqrt{\\frac{E_G}{E}}\\,$, namely $\\,g_T'(E_0) = 0\\,$, which implies\n$$\nE_0(T) = \\left(\\frac{1}{2} \\sqrt{E_G} \\, k_B T \\right)^{2/3}.\n$$\nThe local curvature determines the width. Using $\\,g_T''(E_0) = \\frac{3}{2 k_B T E_0}\\,$, a Gaussian approximation of $\\,\\exp(-g_T(E))\\,$ near $\\,E_0\\,$ has variance\n$$\n\\sigma_T^2 \\approx \\frac{1}{g_T''(E_0)} = \\frac{2}{3}\\, k_B T\\, E_0,\n$$\nand a characteristic full width at the points where the Gaussian drops to $\\,\\exp(-1)\\,$ is\n$$\n\\Delta_T \\approx \\frac{4}{\\sqrt{3}} \\sqrt{k_B T \\, E_0}.\n$$\n\nYou must construct an importance sampling density $\\,q_T(E)\\,$ supported on $\\,E>0\\,$ that approximates the peak region of $\\,h_T(E)\\,$. Use a gamma distribution parameterized by shape $\\,k_T\\,$ and scale $\\,\\theta_T\\,$ such that its mean and variance match $\\,E_0(T)\\,$ and $\\,\\sigma_T^2\\,$:\n$$\nq_T(E) = \\frac{1}{\\Gamma(k_T) \\, \\theta_T^{k_T}}\\, E^{k_T - 1}\\, \\exp\\!\\left(-\\frac{E}{\\theta_T}\\right), \\quad \\mathbb{E}_{q_T}[E] = k_T \\theta_T = E_0, \\quad \\mathrm{Var}_{q_T}[E] = k_T \\theta_T^2 = \\sigma_T^2.\n$$\nFrom these constraints, derive\n$$\n\\theta_T = \\frac{2}{3} k_B T, \\quad k_T = \\frac{3}{2} \\frac{E_0}{k_B T}.\n$$\nWith this $\\,q_T\\,$, the importance sampling Monte Carlo estimator for $\\,I(T)\\,$ is\n$$\n\\widehat{I}_{\\mathrm{IS}}(T) = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{h_T(E_i)}{q_T(E_i)}, \\quad E_i \\sim q_T.\n$$\nThe variance of the estimator is\n$$\n\\mathrm{Var}\\!\\left[\\widehat{I}_{\\mathrm{IS}}(T)\\right] = \\frac{1}{N} \\left( \\mathbb{E}_{q_T}\\!\\left[\\left(\\frac{h_T(E)}{q_T(E)}\\right)^2\\right] - I(T)^2 \\right).\n$$\nIn practice, estimate it by the sample variance of the weights divided by $\\,N\\,$. For comparison, construct a baseline estimator using the pure Boltzmann exponential proposal\n$$\nq_0(E) = \\frac{1}{k_B T} \\exp\\!\\left(-\\frac{E}{k_B T}\\right), \\quad \\widehat{I}_{0}(T) = \\frac{1}{N} \\sum_{i=1}^{N} \\frac{h_T(E_i)}{q_0(E_i)} = \\frac{1}{N} \\sum_{i=1}^{N} k_B T \\, \\sigma(E_i)\\, E_i, \\quad E_i \\sim q_0.\n$$\n\nScientific constants for deuterium–tritium must be used in SI units:\n- Speed of light $\\,c = 299792458\\,\\mathrm{m/s}$.\n- Fine-structure constant $\\,\\alpha = 7.2973525693\\times 10^{-3}$.\n- Atomic mass unit $\\,u = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$.\n- Deuterium mass $\\,m_D = 2.013553212745\\,u\\,\\mathrm{kg}$.\n- Tritium mass $\\,m_T = 3.0155007139\\,u\\,\\mathrm{kg}$.\n- Reduced mass $\\,\\mu = \\frac{m_D m_T}{m_D + m_T}\\,\\mathrm{kg}$.\n- Electronvolt conversion $\\,1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$, hence $\\,1\\,\\mathrm{keV} = 1.602176634\\times 10^{-16}\\,\\mathrm{J}$.\n- Adopt $\\,S_0 = 3.7\\times 10^{-40}\\,\\mathrm{m^2\\cdot J}\\,$ as a calibrated constant astrophysical factor producing realistic magnitudes for $\\,\\sigma(E)\\,$ in the tens of $\\mathrm{keV}$ range.\n\nAll temperatures are specified by the energy scale $\\,k_B T\\,$ in kilo-electronvolt (keV), i.e., interpret $\\,T_{\\mathrm{keV}}\\,$ as $\\,k_B T = T_{\\mathrm{keV}} \\times 1\\,\\mathrm{keV}\\,$. The output reactivity $\\,\\langle \\sigma v \\rangle\\,$ must be expressed in $\\,\\mathrm{m^3/s}\\,$, and variances in $\\,\\mathrm{m^6/s^2}\\,$.\n\nDesign and implement the program to:\n- Compute $\\,E_G\\,$, $\\,E_0(T)\\,$, $\\,k_T\\,$, $\\,\\theta_T\\,$, and the importance sampling estimator $\\,\\widehat{I}_{\\mathrm{IS}}(T)\\,$ for each test case.\n- Compute the corresponding reactivity estimate $\\,\\widehat{R}_{\\mathrm{IS}}(T) = C(T)\\, \\widehat{I}_{\\mathrm{IS}}(T)\\,$.\n- Estimate $\\,\\mathrm{Var}[\\widehat{I}_{\\mathrm{IS}}(T)]\\,$ and propagate to $\\,\\mathrm{Var}[\\widehat{R}_{\\mathrm{IS}}(T)] = C(T)^2 \\, \\mathrm{Var}[\\widehat{I}_{\\mathrm{IS}}(T)]\\,$.\n- Compute the baseline exponential-proposal estimator $\\,\\widehat{I}_0(T)\\,$ and its variance, and the propagated baseline reactivity variance $\\,\\mathrm{Var}[\\widehat{R}_0(T)]\\,$.\n\nTest Suite:\nProvide results for the following parameter sets $\\,\\{(T_{\\mathrm{keV}}, N)\\}\\,$:\n- $\\,\\left(10, 50000\\right)\\,$, a typical \"happy path\" case.\n- $\\,\\left(5, 50000\\right)\\,$, a lower-temperature case.\n- $\\,\\left(20, 50000\\right)\\,$, a higher-temperature case.\n- $\\,\\left(10, 100\\right)\\,$, a low-sample boundary case.\n- $\\,\\left(100, 50000\\right)\\,$, a very high-temperature case.\n\nFinal Output Format:\nYour program must produce a single line containing a comma-separated list enclosed in square brackets with, for each test case in the order above, three floats:\n$\\,\\left[\\widehat{R}_{\\mathrm{IS}},\\, \\mathrm{Var}[\\widehat{R}_{\\mathrm{IS}}],\\, \\mathrm{Var}[\\widehat{R}_0],\\, \\ldots \\right]\\,$. All values must be in SI units $\\,\\mathrm{m^3/s}\\,$ for reactivity and $\\,\\mathrm{m^6/s^2}\\,$ for variances.",
            "solution": "The task is to construct and analyze a Monte Carlo estimator for the deuterium–tritium (D–T) fusion reactivity, $\\langle \\sigma v \\rangle$, using an importance sampling scheme. The solution is developed by first establishing the physical and mathematical framework, then outlining the computational algorithm, including a comparison with a simpler baseline Monte Carlo method.\n\nThe D–T fusion reactivity in a thermal plasma at temperature $\\,T\\,$ is given by the integral of the product of the fusion cross section $\\,\\sigma(E)\\,$ and relative velocity $\\,v\\,$ over the Maxwell–Boltzmann distribution of relative kinetic energies $\\,E\\,$. This can be written as\n$$\n\\langle \\sigma v \\rangle = C(T) \\, I(T),\n$$\nwhere\n$$\nI(T) = \\int_{0}^{\\infty} h_T(E) \\, dE = \\int_{0}^{\\infty} S_0 \\, \\exp\\!\\left(-\\frac{E}{k_B T} - \\sqrt{\\frac{E_G}{E}}\\right) dE,\n$$\nand the coefficient $\\,C(T)\\,$ is\n$$\nC(T) = \\sqrt{\\frac{8}{\\pi \\mu}} \\frac{1}{(k_B T)^{3/2}}.\n$$\nHere, $\\,h_T(E)\\,$ is the integrand, $\\,S_0\\,$ is the astrophysical factor, $\\,E_G\\,$ is the Gamow energy, $\\,\\mu\\,$ is the reduced mass of the D-T pair, and $\\,k_B\\,$ is the Boltzmann constant. All calculations must be performed using SI units.\n\nFirst, we calculate the necessary physical constants. The D-T reduced mass $\\,\\mu\\,$ is calculated from the given masses of deuterium ($\\,m_D\\,$) and tritium ($\\,m_T\\,$):\n$$\n\\mu = \\frac{m_D m_T}{m_D + m_T}.\n$$\nThe Gamow energy $\\,E_G\\,$ is then computed using $\\,\\mu\\,$, the speed of light $\\,c\\,$, and the fine-structure constant $\\,\\alpha\\,$:\n$$\nE_G = \\frac{1}{2} \\, \\mu \\, c^2 \\, (2\\pi \\alpha)^2.\n$$\nThese constants, along with $\\,S_0\\,$ and the electronvolt-to-Joule conversion factor, form the basis for all subsequent calculations.\n\nThe core of the problem is to estimate the integral $\\,I(T)\\,$ using Monte Carlo methods. The integrand $\\,h_T(E)\\,$ is sharply peaked around the Gamow peak energy $\\,E_0(T)\\,$, which makes naive sampling methods inefficient. Importance sampling is employed to concentrate the sampling points in this high-contribution region, thereby reducing the variance of the estimator.\n\nAn importance sampling probability density function, $\\,q_T(E)\\,$, is chosen to approximate the shape of $\\,h_T(E)\\,$. A gamma distribution is selected, as it is defined on $\\,E>0\\,$ and its shape can be tuned. The gamma distribution is given by\n$$\nq_T(E) = \\frac{1}{\\Gamma(k_T) \\, \\theta_T^{k_T}}\\, E^{k_T - 1}\\, \\exp\\!\\left(-\\frac{E}{\\theta_T}\\right),\n$$\nwith shape parameter $\\,k_T\\,$ and scale parameter $\\,\\theta_T\\,$. These parameters are determined by matching the mean and variance of $\\,q_T(E)\\,$ to the location and width of the Gamow peak. The Gamow peak location $\\,E_0\\,$ is found where the negative exponent of $\\,h_T(E)\\,$ is minimized:\n$$\nE_0(T) = \\left(\\frac{1}{2} \\sqrt{E_G} \\, k_B T \\right)^{2/3}.\n$$\nThe variance is approximated from the second derivative of the exponent at the peak, leading to $\\,\\sigma_T^2 \\approx \\frac{2}{3} k_B T E_0\\,$. Matching $\\,\\mathbb{E}_{q_T}[E] = k_T \\theta_T = E_0\\,$ and $\\,\\mathrm{Var}_{q_T}[E] = k_T \\theta_T^2 = \\sigma_T^2\\,$ yields the parameters for the sampling distribution:\n$$\n\\theta_T = \\frac{\\sigma_T^2}{E_0} = \\frac{2}{3} k_B T, \\qquad k_T = \\frac{E_0}{\\theta_T} = \\frac{3}{2} \\frac{E_0}{k_B T}.\n$$\nFor each temperature $\\,T\\,$ in the test suite, these parameters $\\,E_0(T)\\,$, $\\,k_T\\,$, and $\\,\\theta_T\\,$ are computed.\n\nWith the sampling distribution $\\,q_T(E)\\,$ defined, the importance sampling estimator for $\\,I(T)\\,$ based on $\\,N\\,$ samples $\\,E_i \\sim q_T\\,$ is\n$$\n\\widehat{I}_{\\mathrm{IS}}(T) = \\frac{1}{N} \\sum_{i=1}^{N} w_i, \\quad \\text{where } w_i = \\frac{h_T(E_i)}{q_T(E_i)}.\n$$\nThe corresponding reactivity estimate is $\\,\\widehat{R}_{\\mathrm{IS}}(T) = C(T) \\widehat{I}_{\\mathrm{IS}}(T)\\,$. The statistical uncertainty is quantified by the variance of this estimator. The variance of $\\,\\widehat{I}_{\\mathrm{IS}}(T)\\,$ is estimated from the sample variance of the weights $\\,w_i\\,$:\n$$\n\\mathrm{Var}[\\widehat{I}_{\\mathrm{IS}}(T)] \\approx \\frac{1}{N} \\mathrm{Var}(w) = \\frac{1}{N} \\left( \\frac{1}{N-1} \\sum_{i=1}^{N} (w_i - \\widehat{I}_{\\mathrm{IS}})^2 \\right).\n$$\nThe variance is then propagated to the reactivity estimate: $\\,\\mathrm{Var}[\\widehat{R}_{\\mathrm{IS}}(T)] = C(T)^2 \\mathrm{Var}[\\widehat{I}_{\\mathrm{IS}}(T)]\\,$.\n\nFor comparison, a baseline Monte Carlo estimator is constructed using a simpler proposal distribution, $\\,q_0(E)\\,$, which is the pure Boltzmann exponential term:\n$$\nq_0(E) = \\frac{1}{k_B T} \\exp\\!\\left(-\\frac{E}{k_B T}\\right).\n$$\nThis corresponds to sampling from an exponential distribution with scale parameter $\\,k_B T\\,$. The baseline estimator for $\\,I(T)\\,$ is $\\,\\widehat{I}_{0}(T) = \\frac{1}{N} \\sum_{i=1}^{N} w'_i\\,$ with weights\n$$\nw'_i = \\frac{h_T(E_i)}{q_0(E_i)} = k_B T \\, \\sigma(E_i) E_i = k_B T \\, S_0 \\, \\exp\\!\\left(-\\sqrt{\\frac{E_G}{E_i}}\\right),\n$$\nwhere $\\,E_i \\sim q_0\\,$. The variance of the corresponding reactivity estimate, $\\,\\mathrm{Var}[\\widehat{R}_0(T)]\\,$, is calculated similarly by computing the sample variance of the weights $\\,w'_i\\,$ and propagating it with the factor $\\,C(T)^2 / N\\,$. This method is expected to be less efficient (higher variance) because it does not specifically target the Gamow peak region.\n\nThe computational procedure for each test case $\\,(T_{\\mathrm{keV}}, N)\\,$ is as follows:\n1. Convert the temperature $\\,T_{\\mathrm{keV}}\\,$ to Joules: $\\,k_B T = T_{\\mathrm{keV}} \\times (1000 \\times 1.602176634\\times 10^{-19}) \\,\\mathrm{J}\\,$.\n2. Calculate temperature-dependent parameters $\\,E_0(T)\\,$, $\\,k_T\\,$, $\\,\\theta_T\\,$, and $\\,C(T)\\,$.\n3. Generate $\\,N\\,$ random energy samples $\\,\\{E_i\\}\\,$ from the gamma distribution $\\,\\text{Gamma}(k_T, \\theta_T)\\,$.\n4. For each sample $\\,E_i\\,$, compute the weight $\\,w_i = h_T(E_i)/q_T(E_i)\\,$.\n5. Compute the importance-sampled reactivity estimate $\\,\\widehat{R}_{\\mathrm{IS}}\\,$ and its variance $\\,\\mathrm{Var}[\\widehat{R}_{\\mathrm{IS}}]\\,$.\n6. Generate $\\,N\\,$ random energy samples $\\,\\{E'_i\\}\\,$ from the exponential distribution with scale $\\,k_B T\\,$.\n7. For each sample $\\,E'_i\\,$, compute the baseline weight $\\,w'_i = k_B T S_0 \\exp(-\\sqrt{E_G/E'_i})\\,$.\n8. Compute the variance of the baseline reactivity estimate, $\\,\\mathrm{Var}[\\widehat{R}_0]\\,$.\n9. Store the three resulting values: $\\,\\widehat{R}_{\\mathrm{IS}}\\,$, $\\,\\mathrm{Var}[\\widehat{R}_{\\mathrm{IS}}]\\,$, and $\\,\\mathrm{Var}[\\widehat{R}_0]\\,$.\n\nThis process is repeated for all specified test cases, and the results are collected into a single formatted output string. The use of `numpy` facilitates array-based computations for efficiency, and `scipy.special.gammaln` is used for a numerically stable computation of the log of the gamma function in the denominator of $\\,q_T(E)\\,$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import gammaln\n\ndef solve():\n    \"\"\"\n    Computes D-T fusion reactivity using importance-sampled Monte Carlo\n    and analyzes its variance compared to a baseline method.\n    \"\"\"\n    # Scientific constants in SI units\n    C_LIGHT = 299792458.0  # m/s\n    ALPHA = 7.2973525693e-3  # Fine-structure constant\n    AMU = 1.66053906660e-27  # kg\n    M_D = 2.013553212745 * AMU  # kg\n    M_T = 3.0155007139 * AMU  # kg\n    EV_TO_J = 1.602176634e-19  # J/eV\n    KEV_TO_J = EV_TO_J * 1000  # J/keV\n    S0 = 3.7e-40  # m^2 * J\n\n    # Derived constants\n    MU = (M_D * M_T) / (M_D + M_T)  # Reduced mass, kg\n    E_G = 0.5 * MU * C_LIGHT**2 * (2 * np.pi * ALPHA)**2  # Gamow energy, J\n\n    # Test suite: (T_keV, N_samples)\n    test_cases = [\n        (10, 50000),\n        (5, 50000),\n        (20, 50000),\n        (10, 100),\n        (100, 50000),\n    ]\n\n    results = []\n\n    for T_keV, N in test_cases:\n        # Set a seed for reproducibility of random numbers per case\n        np.random.seed(hash((T_keV, N)) & 0xFFFFFFFF)\n\n        kBT = T_keV * KEV_TO_J  # Thermal energy in Joules\n\n        # --- Temperature-dependent parameters ---\n        # Gamow peak energy E0\n        E0 = ((0.5 * np.sqrt(E_G) * kBT))**(2/3)\n\n        # Importance sampling (gamma distribution) parameters\n        theta_T = (2/3) * kBT\n        k_T = (3/2) * E0 / kBT\n\n        # Coefficient C(T) to get reactivity from the integral I(T)\n        C_T = np.sqrt(8 / (np.pi * MU)) / (kBT**1.5)\n\n        # --- Importance Sampling (IS) Calculation ---\n        # 1. Sample energies from the gamma distribution q_T(E)\n        #    numpy.random.gamma takes shape (k) and scale (theta)\n        E_samples_is = np.random.gamma(shape=k_T, scale=theta_T, size=N)\n        \n        # Avoid E=0 if it occurs, though highly improbable for these parameters\n        E_samples_is[E_samples_is == 0] = np.finfo(float).eps\n\n        # 2. Calculate the integrand h_T(E)\n        h_T = S0 * np.exp(-E_samples_is / kBT - np.sqrt(E_G / E_samples_is))\n\n        # 3. Calculate the proposal PDF q_T(E) using log-gamma for stability\n        log_q_T = (-gammaln(k_T) - k_T * np.log(theta_T) +\n                   (k_T - 1) * np.log(E_samples_is) - E_samples_is / theta_T)\n        q_T = np.exp(log_q_T)\n\n        # 4. Calculate importance weights\n        weights_is = h_T / q_T\n\n        # 5. Compute estimator for I(T) and its variance\n        I_hat_is = np.mean(weights_is)\n        # Variance of the mean is sample variance / N\n        var_I_hat_is = np.var(weights_is, ddof=1) / N\n\n        # 6. Propagate to reactivity and its variance\n        R_hat_is = C_T * I_hat_is\n        var_R_hat_is = C_T**2 * var_I_hat_is\n\n        # --- Baseline (Exponential) Calculation ---\n        # 1. Sample energies from the exponential distribution q_0(E)\n        #    numpy.random.exponential takes scale (beta = 1/lambda)\n        E_samples_base = np.random.exponential(scale=kBT, size=N)\n        \n        # Avoid E=0\n        E_samples_base[E_samples_base == 0] = np.finfo(float).eps\n\n        # 2. Calculate weights for the baseline estimator\n        weights_base = kBT * S0 * np.exp(-np.sqrt(E_G / E_samples_base))\n\n        # 3. Compute estimator variance\n        #    We only need the variance for the final output\n        var_I_hat_base = np.var(weights_base, ddof=1) / N\n\n        # 4. Propagate to reactivity variance\n        var_R_hat_base = C_T**2 * var_I_hat_base\n\n        results.extend([R_hat_is, var_R_hat_is, var_R_hat_base])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}