{
    "hands_on_practices": [
        {
            "introduction": "The concept of Debye shielding is the cornerstone of plasma physics, describing how mobile charges rearrange to screen out electrostatic fields. This first exercise guides you through the foundational derivation of the electron Debye length, $\\lambda_D$, starting from Poisson’s equation and a linearized Maxwell-Boltzmann distribution for electrons. By applying this derivation to calculate $\\lambda_D$ for typical parameters in a tokamak's scrape-off layer, you will connect this fundamental scale length to its critical role in determining the thickness of the plasma sheath, the boundary layer governing plasma-material interactions .",
            "id": "3964050",
            "problem": "In the scrape-off layer (SOL) of a diverted tokamak, consider a stationary, quasi-neutral hydrogen plasma near a material boundary with electron number density $n_e \\sim 10^{19}\\,\\mathrm{m}^{-3}$ and electron temperature $T_e \\sim 50\\,\\mathrm{eV}$. Starting from Poisson’s equation $\\nabla^2 \\phi = -\\rho/\\varepsilon_0$ and the Maxwell–Boltzmann response of electrons $n_e(\\phi) = n_{e0} \\exp\\!\\big(e\\phi/(k_B T_e)\\big)$, linearize the electron response for small electrostatic potential perturbations and derive the characteristic screening length of the resulting equation for $\\phi$. Using that characteristic length, evaluate the Debye length for the given parameters and explain, based on first principles, the consequences for the physical thickness of an electrostatic sheath that forms at the boundary in such a plasma. You may assume singly charged ions, $n_{i0} \\approx n_{e0}$ far from the boundary, and that ions are unresponsive on the linearized electron time scale. Report the numerical value of the Debye length in micrometers and round your answer to three significant figures. Express your final numerical answer in micrometers.",
            "solution": "The problem requires the derivation of the characteristic electrostatic screening length in a plasma, its calculation for given parameters, and an explanation of its relevance to the sheath thickness at a material boundary. We begin by formalizing the physics described.\n\nThe starting point is Poisson’s equation for the electrostatic potential $\\phi$, which relates the potential to the net charge density $\\rho$:\n$$\n\\nabla^2 \\phi = -\\frac{\\rho}{\\varepsilon_0}\n$$\nwhere $\\varepsilon_0$ is the vacuum permittivity. The plasma is composed of singly charged positive ions and electrons. The net charge density is given by $\\rho = e(n_i - n_e)$, where $e$ is the elementary charge, $n_i$ is the ion number density, and $n_e$ is the electron number density.\n\nThe problem states several conditions and assumptions:\n1.  Far from the boundary or any perturbation, the plasma is quasi-neutral, implying the unperturbed ion density $n_{i0}$ is equal to the unperturbed electron density $n_{e0}$. We set $n_{i0} = n_{e0} = n_0$.\n2.  The ions are considered unresponsive on the fast timescale of electron motion. Thus, their density is treated as a fixed, uniform background, $n_i(\\mathbf{r}) = n_{i0} = n_0$.\n3.  The electrons are thermalized and respond to the local electrostatic potential according to the Maxwell-Boltzmann distribution:\n    $$\n    n_e(\\phi) = n_{e0} \\exp\\left(\\frac{e\\phi}{k_B T_e}\\right) = n_0 \\exp\\left(\\frac{e\\phi}{k_B T_e}\\right)\n    $$\n    where $k_B$ is the Boltzmann constant and $T_e$ is the electron temperature.\n\nSubstituting these expressions for $n_i$ and $n_e$ into the charge density formula yields:\n$$\n\\rho = e\\left(n_0 - n_0 \\exp\\left(\\frac{e\\phi}{k_B T_e}\\right)\\right) = e n_0 \\left(1 - \\exp\\left(\\frac{e\\phi}{k_B T_e}\\right)\\right)\n$$\nPoisson’s equation then becomes:\n$$\n\\nabla^2 \\phi = -\\frac{e n_0}{\\varepsilon_0} \\left(1 - \\exp\\left(\\frac{e\\phi}{k_B T_e}\\right)\\right)\n$$\nThis is the nonlinear Poisson-Boltzmann equation. The problem asks for a linearization for small potential perturbations. This corresponds to the assumption that the electrostatic potential energy is much smaller than the electron thermal energy, i.e., $|e\\phi| \\ll k_B T_e$. Under this condition, we can use the first-order Taylor series expansion for the exponential function, $\\exp(x) \\approx 1 + x$ for $|x| \\ll 1$. Let $x = \\frac{e\\phi}{k_B T_e}$. The electron density becomes:\n$$\nn_e(\\phi) \\approx n_0 \\left(1 + \\frac{e\\phi}{k_B T_e}\\right)\n$$\nThe linearized charge density is then:\n$$\n\\rho \\approx e n_0 \\left(1 - \\left(1 + \\frac{e\\phi}{k_B T_e}\\right)\\right) = - \\frac{n_0 e^2 \\phi}{k_B T_e}\n$$\nSubstituting this linearized charge density back into Poisson’s equation gives:\n$$\n\\nabla^2 \\phi = -\\frac{1}{\\varepsilon_0} \\left(- \\frac{n_0 e^2 \\phi}{k_B T_e}\\right) = \\left(\\frac{n_0 e^2}{\\varepsilon_0 k_B T_e}\\right) \\phi\n$$\nThis equation is commonly written in the form:\n$$\n\\nabla^2 \\phi - \\frac{1}{\\lambda_D^2} \\phi = 0\n$$\nwhere $\\lambda_D$ is the characteristic length scale of the equation. By comparing the two forms, we identify the square of this characteristic length as:\n$$\n\\lambda_D^2 = \\frac{\\varepsilon_0 k_B T_e}{n_0 e^2}\n$$\nThis characteristic screening length is the electron Debye length, $\\lambda_D$.\n$$\n\\lambda_D = \\sqrt{\\frac{\\varepsilon_0 k_B T_e}{n_0 e^2}}\n$$\nThis length scale represents the distance over which a local charge imbalance or potential perturbation is screened out by the mobile electrons in the plasma.\n\nThe consequence for the physical thickness of an electrostatic sheath is direct. A sheath is a non-neutral boundary layer that forms when a plasma contacts a material surface. Due to the higher thermal velocity of electrons compared to ions, a surface typically charges negatively relative to the plasma. This creates a large potential drop between the bulk plasma and the wall. This potential drop occurs over a finite region, the sheath, where quasi-neutrality is violated ($n_e \\neq n_i$). The Debye length, $\\lambda_D$, governs the spatial scale of this charge separation. The thickness of the sheath is fundamentally set by the Debye length, typically being on the order of a few to several $\\lambda_D$. Therefore, $\\lambda_D$ provides the fundamental estimate for the physical extent of the plasma-wall interaction layer.\n\nWe now evaluate the Debye length for the given parameters:\nElectron number density $n_e \\approx n_0 = 10^{19} \\, \\mathrm{m}^{-3}$.\nElectron temperature $T_e \\sim 50 \\, \\mathrm{eV}$.\n\nThe term $k_B T_e$ represents the thermal energy. When $T_e$ is given in units of electron-volts ($\\mathrm{eV}$), this value directly corresponds to the thermal energy $k_B T_e$ after converting to Joules. The conversion factor is $1 \\, \\mathrm{eV} = e \\, \\mathrm{J}$, where $e$ is the elementary charge in Coulombs.\nSo, $k_B T_e = 50 \\, \\mathrm{eV} = 50 \\times (1.602176634 \\times 10^{-19} \\, \\mathrm{J})$.\n\nWe use the following values for the physical constants:\n$\\varepsilon_0 \\approx 8.8541878 \\times 10^{-12} \\, \\mathrm{F/m}$\n$e \\approx 1.6021766 \\times 10^{-19} \\, \\mathrm{C}$\n$n_0 = 10^{19} \\, \\mathrm{m}^{-3}$\n\nSubstituting these values into the formula for the Debye length:\n$$\n\\lambda_D = \\sqrt{\\frac{(\\varepsilon_0) \\times (50 \\cdot e)}{n_0 \\cdot e^2}} = \\sqrt{\\frac{50 \\, \\varepsilon_0}{n_0 \\, e}}\n$$\n$$\n\\lambda_D = \\sqrt{\\frac{50 \\times (8.8541878 \\times 10^{-12} \\, \\mathrm{F/m})}{(10^{19} \\, \\mathrm{m}^{-3}) \\times (1.6021766 \\times 10^{-19} \\, \\mathrm{C})}}\n$$\n$$\n\\lambda_D = \\sqrt{\\frac{4.4270939 \\times 10^{-10}}{1.6021766}} \\, \\mathrm{m}\n$$\n$$\n\\lambda_D = \\sqrt{2.76313 \\times 10^{-10}} \\, \\mathrm{m} \\approx 1.662266 \\times 10^{-5} \\, \\mathrm{m}\n$$\nThe problem asks for the result in micrometers ($\\mu\\mathrm{m}$). We convert the result from meters to micrometers:\n$$\n\\lambda_D \\approx (1.662266 \\times 10^{-5}) \\times (10^6 \\, \\mu\\mathrm{m/m}) \\approx 16.62266 \\, \\mu\\mathrm{m}\n$$\nRounding to three significant figures, we get:\n$$\n\\lambda_D \\approx 16.6 \\, \\mu\\mathrm{m}\n$$",
            "answer": "$$\n\\boxed{16.6}\n$$"
        },
        {
            "introduction": "Real-world plasmas, particularly those in fusion reactors, are never simple two-component systems. This practice generalizes the concept of shielding to a more realistic multi-species plasma, including fuel ions (deuterium and tritium) and fusion products (helium ash). By deriving the Debye length for this complex mixture, you will learn how each species contributes to the overall screening and quantitatively assess the impact of impurities like helium ash on a fundamental plasma property .",
            "id": "3964085",
            "problem": "A spatially uniform, quasi-neutral, collisionless fusion plasma consists of electrons and three ion species: deuterium with charge number $Z_{\\mathrm{D}} = 1$, tritium with charge number $Z_{\\mathrm{T}} = 1$, and helium ash with charge number $Z_{\\mathrm{He}} = 2$. Assume each species is Maxwell–Boltzmann and responds linearly to a small, static electrostatic test potential $\\,\\phi\\,$. The electron number density is $\\,n_{e} = 1.5 \\times 10^{20}\\,\\mathrm{m}^{-3}\\,$. The thermal energies $\\,k_{B} T_{s}\\,$ of the species are specified as $\\,k_{B} T_{e} = 12\\,\\mathrm{keV}\\,$, $\\,k_{B} T_{\\mathrm{D}} = 10\\,\\mathrm{keV}\\,$, $\\,k_{B} T_{\\mathrm{T}} = 10\\,\\mathrm{keV}\\,$, and $\\,k_{B} T_{\\mathrm{He}} = 8\\,\\mathrm{keV}\\,$, where kiloelectronvolt (keV) is used as the unit of $\\,k_{B} T\\,$.\n\nDefine the helium ash charge fraction by $\\,f \\equiv \\frac{Z_{\\mathrm{He}} n_{\\mathrm{He}}}{n_{e}}\\,$. Consider the case $\\,f = 0.04\\,$. The remaining ion charge density is provided by deuterium and tritium in equal parts, and quasi-neutrality at zero potential holds, $\\,n_{e} = Z_{\\mathrm{D}} n_{\\mathrm{D}} + Z_{\\mathrm{T}} n_{\\mathrm{T}} + Z_{\\mathrm{He}} n_{\\mathrm{He}}\\,$.\n\nStarting from Poisson’s equation $\\,\\nabla^{2} \\phi = -\\rho/\\epsilon_{0}\\,$ and the linearized Maxwell–Boltzmann response of each species to $\\,\\phi\\,$, derive the static screening scale (Debye shielding length) $\\,\\lambda_{D}\\,$ for a multi-species plasma in terms of the densities, charges, and thermal energies. Using your derived expression, compute the ratio $\\,\\lambda_{D}(f)/\\lambda_{D}(0)\\,$, where $\\,\\lambda_{D}(0)\\,$ is the Debye length for the same $\\,n_{e}\\,$ and species thermal energies but with $\\,f = 0\\,$ (no helium ash).\n\nExpress your final answer as a pure number and round to four significant figures.",
            "solution": "The problem asks for the ratio of the Debye shielding lengths for a multi-species plasma with and without helium ash. We begin by deriving the general expression for the Debye length, $\\lambda_D$, in a multi-species plasma.\n\nThe starting point is Poisson's equation for the electrostatic potential $\\phi$:\n$$ \\nabla^{2} \\phi = -\\frac{\\rho}{\\epsilon_{0}} $$\nwhere $\\rho$ is the total charge density and $\\epsilon_{0}$ is the permittivity of free space. The total charge density is the sum of charge densities of all species $s$ (electrons, deuterium, tritium, helium):\n$$ \\rho = \\sum_{s} q_s n_s $$\nwhere $q_s = Z_s e$ is the charge of a particle of species $s$, and $n_s$ is its number density. For electrons, $Z_e = -1$.\n\nEach species is assumed to be in thermal equilibrium and follow a Maxwell-Boltzmann distribution. In the presence of a potential $\\phi$, the number density of species $s$ is given by:\n$$ n_s(\\mathbf{r}) = n_{s0} \\exp\\left(-\\frac{q_s \\phi(\\mathbf{r})}{k_B T_s}\\right) $$\nwhere $n_{s0}$ is the unperturbed number density of species $s$ (in the region where $\\phi=0$), $k_B$ is the Boltzmann constant, and $T_s$ is the temperature of species $s$.\n\nThe problem specifies a small potential $\\phi$, which allows for a linear response. We linearize the exponential term for $\\frac{|q_s \\phi|}{k_B T_s} \\ll 1$:\n$$ \\exp\\left(-\\frac{q_s \\phi}{k_B T_s}\\right) \\approx 1 - \\frac{q_s \\phi}{k_B T_s} $$\nThe number density becomes:\n$$ n_s(\\mathbf{r}) \\approx n_{s0} \\left(1 - \\frac{q_s \\phi}{k_B T_s}\\right) $$\nSubstituting this into the expression for the charge density $\\rho$:\n$$ \\rho(\\mathbf{r}) \\approx \\sum_s q_s n_{s0} \\left(1 - \\frac{q_s \\phi(\\mathbf{r})}{k_B T_s}\\right) = \\sum_s q_s n_{s0} - \\phi(\\mathbf{r}) \\sum_s \\frac{q_s^2 n_{s0}}{k_B T_s} $$\nThe plasma is quasi-neutral in its unperturbed state, so the net charge density at $\\phi=0$ is zero: $\\sum_s q_s n_{s0} = 0$. This simplifies the charge density to:\n$$ \\rho(\\mathbf{r}) \\approx - \\phi(\\mathbf{r}) \\sum_s \\frac{q_s^2 n_{s0}}{k_B T_s} $$\nNow we substitute this linearized charge density back into Poisson's equation:\n$$ \\nabla^{2} \\phi = -\\frac{1}{\\epsilon_{0}} \\left( - \\phi \\sum_s \\frac{q_s^2 n_{s0}}{k_B T_s} \\right) = \\left( \\frac{1}{\\epsilon_{0}} \\sum_s \\frac{n_{s0} (Z_s e)^2}{k_B T_s} \\right) \\phi $$\nThis equation can be written in the form of the screened Poisson equation (or Helmholtz equation):\n$$ \\nabla^{2} \\phi - \\frac{1}{\\lambda_D^2} \\phi = 0 $$\nwhere we identify the inverse square of the Debye length as:\n$$ \\frac{1}{\\lambda_D^2} = \\frac{e^2}{\\epsilon_{0}} \\sum_s \\frac{n_{s0} Z_s^2}{k_B T_s} $$\nThus, the Debye length for a multi-species plasma is:\n$$ \\lambda_D = \\left( \\frac{\\epsilon_{0}}{e^2 \\sum_s \\frac{n_{s0} Z_s^2}{k_B T_s}} \\right)^{1/2} $$\nThe problem asks for the ratio $\\lambda_D(f) / \\lambda_D(0)$, where $f$ is the helium ash charge fraction. Let the sum be denoted $S(f) = \\sum_s \\frac{n_{s}(f) Z_s^2}{k_B T_s}$, where $n_s(f)$ are the densities for a given $f$. The ratio is:\n$$ \\frac{\\lambda_D(f)}{\\lambda_D(0)} = \\frac{\\left( \\frac{\\epsilon_{0}}{e^2 S(f)} \\right)^{1/2}}{\\left( \\frac{\\epsilon_{0}}{e^2 S(0)} \\right)^{1/2}} = \\left( \\frac{S(0)}{S(f)} \\right)^{1/2} $$\nThe unperturbed densities $n_{s0}$ will be denoted simply as $n_s$. The electron charge number is $Z_e=-1$, so $Z_e^2=1$. The sum $S(f)$ is:\n$$ S(f) = \\frac{n_e Z_e^2}{k_B T_e} + \\frac{n_{\\mathrm{D}} Z_{\\mathrm{D}}^2}{k_B T_{\\mathrm{D}}} + \\frac{n_{\\mathrm{T}} Z_{\\mathrm{T}}^2}{k_B T_{\\mathrm{T}}} + \\frac{n_{\\mathrm{He}} Z_{\\mathrm{He}}^2}{k_B T_{\\mathrm{He}}} $$\nFirst, we determine the species densities as a function of $f$. We are given:\n$1$. Quasi-neutrality: $n_e = Z_{\\mathrm{D}} n_{\\mathrm{D}} + Z_{\\mathrm{T}} n_{\\mathrm{T}} + Z_{\\mathrm{He}} n_{\\mathrm{He}}$.\n$2$. Helium ash fraction: $f = \\frac{Z_{\\mathrm{He}} n_{\\mathrm{He}}}{n_e}$, which implies $Z_{\\mathrm{He}} n_{\\mathrm{He}} = f n_e$.\n$3$. D-T balance: $Z_{\\mathrm{D}} n_{\\mathrm{D}} = Z_{\\mathrm{T}} n_{\\mathrm{T}}$.\nSubstituting (2) and (3) into (1):\n$n_e = Z_{\\mathrm{D}} n_{\\mathrm{D}} + Z_{\\mathrm{D}} n_{\\mathrm{D}} + f n_e = 2 Z_{\\mathrm{D}} n_{\\mathrm{D}} + f n_e$.\nThis gives $2 Z_{\\mathrm{D}} n_{\\mathrm{D}} = n_e(1-f)$. With $Z_{\\mathrm{D}}=1$, we find $n_{\\mathrm{D}} = \\frac{n_e(1-f)}{2}$.\nFrom the D-T balance, $n_{\\mathrm{D}} = n_{\\mathrm{T}}$ since $Z_{\\mathrm{D}}=Z_{\\mathrm{T}}=1$. So, $n_{\\mathrm{T}} = \\frac{n_e(1-f)}{2}$.\nFrom the definition of $f$, with $Z_{\\mathrm{He}}=2$, we find $n_{\\mathrm{He}} = \\frac{f n_e}{Z_{\\mathrm{He}}} = \\frac{f n_e}{2}$.\n\nNow we can write $S(f)$ in terms of $n_e$ and $f$, using $Z_e^2=1$, $Z_{\\mathrm{D}}=1$, $Z_{\\mathrm{T}}=1$, $Z_{\\mathrm{He}}=2$:\n$$ S(f) = n_e \\left[ \\frac{1}{k_B T_e} + \\frac{1-f}{2} \\left( \\frac{1}{k_B T_{\\mathrm{D}}} + \\frac{1}{k_B T_{\\mathrm{T}}} \\right) + \\frac{2f}{k_B T_{\\mathrm{He}}} \\right] $$\nFor the case with no helium ash, $f=0$. The densities are $n_{\\mathrm{He}}(0)=0$, $n_{\\mathrm{D}}(0) = \\frac{n_e}{2}$, and $n_{\\mathrm{T}}(0) = \\frac{n_e}{2}$. The sum $S(0)$ is obtained by setting $f=0$ in the expression for $S(f)$:\n$$ S(0) = n_e \\left[ \\frac{1}{k_B T_e} + \\frac{1}{2} \\left( \\frac{1}{k_B T_{\\mathrm{D}}} + \\frac{1}{k_B T_{\\mathrm{T}}} \\right) \\right] $$\nThe factor $n_e$ cancels in the ratio $S(0)/S(f)$. The ratio of Debye lengths becomes:\n$$ \\frac{\\lambda_D(f)}{\\lambda_D(0)} = \\left( \\frac{\\frac{1}{k_B T_e} + \\frac{1}{2} \\left( \\frac{1}{k_B T_{\\mathrm{D}}} + \\frac{1}{k_B T_{\\mathrm{T}}} \\right) }{\\frac{1}{k_B T_e} + \\frac{1-f}{2} \\left( \\frac{1}{k_B T_{\\mathrm{D}}} + \\frac{1}{k_B T_{\\mathrm{T}}} \\right) + \\frac{2f}{k_B T_{\\mathrm{He}}}} \\right)^{1/2} $$\nWe are given the thermal energies $k_B T_s$ in units of keV. Since the ratio is dimensionless, we can use these units directly.\n$k_B T_e = 12\\,\\mathrm{keV}$\n$k_B T_{\\mathrm{D}} = 10\\,\\mathrm{keV}$\n$k_B T_{\\mathrm{T}} = 10\\,\\mathrm{keV}$\n$k_B T_{\\mathrm{He}} = 8\\,\\mathrm{keV}$\n$f = 0.04$\n\nLet's compute the numerator term inside the square root, which we'll call $K_0$:\n$$ K_0 = \\frac{1}{12} + \\frac{1}{2} \\left( \\frac{1}{10} + \\frac{1}{10} \\right) = \\frac{1}{12} + \\frac{1}{2} \\left( \\frac{2}{10} \\right) = \\frac{1}{12} + \\frac{1}{10} $$\n$$ K_0 = \\frac{5}{60} + \\frac{6}{60} = \\frac{11}{60} \\,(\\mathrm{keV}^{-1})$$\nNext, compute the denominator term, $K_f$:\n$$ K_f = \\frac{1}{12} + \\frac{1-0.04}{2} \\left( \\frac{1}{10} + \\frac{1}{10} \\right) + \\frac{2 \\times 0.04}{8} $$\n$$ K_f = \\frac{1}{12} + \\frac{0.96}{2} \\left( \\frac{2}{10} \\right) + \\frac{0.08}{8} $$\n$$ K_f = \\frac{1}{12} + \\frac{0.96}{10} + 0.01 = \\frac{1}{12} + 0.096 + 0.01 = \\frac{1}{12} + 0.106 $$\nTo maintain precision, we use fractions:\n$$ K_f = \\frac{1}{12} + \\frac{106}{1000} = \\frac{1}{12} + \\frac{53}{500} $$\nThe common denominator for $12$ and $500$ is $3 \\times 500 = 1500$.\n$$ K_f = \\frac{125}{1500} + \\frac{3 \\times 53}{1500} = \\frac{125 + 159}{1500} = \\frac{284}{1500} = \\frac{71}{375} \\,(\\mathrm{keV}^{-1})$$\nThe ratio is $\\left( K_0 / K_f \\right)^{1/2}$:\n$$ \\frac{\\lambda_D(f)}{\\lambda_D(0)} = \\left( \\frac{11/60}{71/375} \\right)^{1/2} = \\left( \\frac{11}{60} \\times \\frac{375}{71} \\right)^{1/2} $$\n$$ \\frac{375}{60} = \\frac{75 \\times 5}{12 \\times 5} = \\frac{75}{12} = \\frac{25 \\times 3}{4 \\times 3} = \\frac{25}{4} $$\n$$ \\frac{\\lambda_D(f)}{\\lambda_D(0)} = \\left( \\frac{11}{71} \\times \\frac{25}{4} \\right)^{1/2} = \\left( \\frac{275}{284} \\right)^{1/2} $$\nNow we compute the numerical value and round to four significant figures:\n$$ \\left( \\frac{275}{284} \\right)^{1/2} \\approx \\sqrt{0.968309859...} \\approx 0.984027367... $$\nRounding to four significant figures gives $0.9840$.",
            "answer": "$$\\boxed{0.9840}$$"
        },
        {
            "introduction": "Our final practice moves from idealized uniform plasmas to the more realistic scenario of spatial inhomogeneity, where plasma parameters like density and temperature vary in space. This variation means the Debye length itself becomes a local quantity, $\\lambda_D(x)$, changing from point to point within the plasma. This advanced computational exercise challenges you to derive this local screening scale and then implement a numerical algorithm to calculate it for various inhomogeneous plasma profiles, bridging the gap between analytical theory and practical simulation work in computational plasma physics .",
            "id": "3963977",
            "problem": "Consider a one-dimensional, electrostatic plasma slab occupying the interval $x \\in [0,L]$ with fixed ion density $n_i(x)$ and electrons following the Boltzmann response. Let $\\phi(x)$ denote the electrostatic potential, $\\varepsilon_0$ the vacuum permittivity, $e$ the elementary charge, and $k_B$ the Boltzmann constant. The governing equation is the Poisson equation derived from Maxwell's equations under electrostatic conditions and charge density $\\rho(x)$,\n$$\n\\frac{d^2 \\phi}{dx^2} \\;=\\; -\\,\\frac{\\rho(x)}{\\varepsilon_0},\n$$\nwith\n$$\n\\rho(x) \\;=\\; e\\,n_i(x) \\;-\\; e\\,n_e(x,\\phi),\n$$\nand Boltzmann electrons\n$$\nn_e(x,\\phi) \\;=\\; n_{e0}(x)\\,\\exp\\!\\left(\\frac{e\\,\\phi(x)}{k_B\\,T_e(x)}\\right),\n$$\nwhere $n_{e0}(x)$ is the equilibrium electron density profile and $T_e(x)$ is the electron temperature profile. Assume quasi-neutral equilibrium in the absence of perturbations, so $n_i(x) = n_{e0}(x)$.\n\nStarting from the above fundamental laws and definitions, derive the local screening scale by linearizing the Poisson–Boltzmann relation about small $\\phi(x)$ and define the position-dependent Debye length $\\lambda_D(x)$ compatible with spatially varying $n_{e0}(x)$ and $T_e(x)$. Then, design and implement a numerical algorithm that:\n- Computes $\\lambda_D(x)$ along the domain for specified $n_{e0}(x)$ and $T_e(x)$ based on your derivation.\n- Solves the nonlinear one-dimensional Poisson–Boltzmann (PB) boundary value problem for $\\phi(x)$ with Dirichlet boundary conditions $\\phi(0)=V_0$ and $\\phi(L)=0$ for a small $V_0$ to remain in the validity regime of the linearization, using a finite-difference discretization and Newton's method. The PB solution is used to algorithmically verify consistency, but the required output focuses on $\\lambda_D(x)$.\n\nYour program must implement the following test suite with physically consistent profiles (all quantities must be treated in the International System of Units (SI); the electron temperature is provided in electron-volts and must be handled consistently via $k_B T_e(x) \\equiv e \\, T_e^{(\\mathrm{eV})}(x)$):\n- Test Case 1 (uniform reference):\n  - $L = 1.0\\times 10^{-3}\\,\\mathrm{m}$,\n  - $n_{e0}(x) = 1.0\\times 10^{19}\\,\\mathrm{m}^{-3}$,\n  - $T_e^{(\\mathrm{eV})}(x) = 100\\,\\mathrm{eV}$,\n  - $V_0 = 1.0\\times 10^{-3}\\,\\mathrm{V}$.\n- Test Case 2 (oscillatory density, ramped temperature):\n  - $L = 2.0\\times 10^{-3}\\,\\mathrm{m}$,\n  - $n_{e0}(x) = 1.0\\times 10^{19}\\,\\bigl(1 + 0.2 \\sin(2\\pi x/L)\\bigr)\\,\\mathrm{m}^{-3}$,\n  - $T_e^{(\\mathrm{eV})}(x) = 80 + 40\\,(x/L)\\,\\mathrm{eV}$,\n  - $V_0 = 1.0\\times 10^{-3}\\,\\mathrm{V}$.\n- Test Case 3 (parabolic density, decreasing temperature):\n  - $L = 1.0\\times 10^{-3}\\,\\mathrm{m}$,\n  - $n_{e0}(x) = 5.0\\times 10^{18} + 4.5\\times 10^{18}\\,(x/L)^2\\,\\mathrm{m}^{-3}$,\n  - $T_e^{(\\mathrm{eV})}(x) = 200 - 180\\,(x/L)\\,\\mathrm{eV}$,\n  - $V_0 = 1.0\\times 10^{-3}\\,\\mathrm{V}$.\n- Test Case 4 (low-density, constant temperature):\n  - $L = 5.0\\times 10^{-3}\\,\\mathrm{m}$,\n  - $n_{e0}(x) = 1.0\\times 10^{16}\\,\\bigl(1 + 4\\,(x/L)\\bigr)\\,\\mathrm{m}^{-3}$,\n  - $T_e^{(\\mathrm{eV})}(x) = 5\\,\\mathrm{eV}$,\n  - $V_0 = 1.0\\times 10^{-3}\\,\\mathrm{V}$.\n\nAlgorithmic requirements:\n- Discretize each domain $[0,L]$ uniformly with at least $N=1001$ points.\n- Compute $\\lambda_D(x)$ using your derived formula at each grid point.\n- For verification, solve the nonlinear PB boundary value problem for $\\phi(x)$ using a second-order central-difference approximation and Newton's method, treating the Dirichlet boundary conditions exactly. Ensure convergence by using the small $V_0$ specified. This verification step does not alter the required outputs.\n\nNumerical outputs required:\n- For each test case, compute three scalars from the position-dependent $\\lambda_D(x)$ profile:\n  1. The spatial average of $\\lambda_D(x)$ over $[0,L]$,\n  2. The minimum of $\\lambda_D(x)$ over the grid,\n  3. The maximum of $\\lambda_D(x)$ over the grid.\n- Express all three results for each test case in meters, formatted in scientific notation with six significant digits.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n\\bigl[\\overline{\\lambda_D}_1,\\,\\min\\lambda_D_1,\\,\\max\\lambda_D_1,\\,\\overline{\\lambda_D}_2,\\,\\min\\lambda_D_2,\\,\\max\\lambda_D_2,\\,\\overline{\\lambda_D}_3,\\,\\min\\lambda_D_3,\\,\\max\\lambda_D_3,\\,\\overline{\\lambda_D}_4,\\,\\min\\lambda_D_4,\\,\\max\\lambda_D_4\\bigr],\n$$\nwhere the subscript denotes the test case index. Each number must be a float in meters, printed in scientific notation with six significant digits (e.g., $1.234560\\mathrm{e}{-03}$).",
            "solution": "### Principle-Based Design and Solution\n\nThe primary objective is to derive the position-dependent Debye length, $\\lambda_D(x)$, from the provided fundamental equations and then use this formula to compute statistical properties for several test cases.\n\n**1. Derivation of the Position-Dependent Debye Length $\\lambda_D(x)$**\n\nWe begin with the one-dimensional Poisson equation:\n$$\n\\frac{d^2 \\phi}{dx^2} = -\\frac{\\rho(x)}{\\varepsilon_0}\n$$\nThe charge density $\\rho(x)$ is the sum of ion and electron charge densities, $\\rho(x) = e\\,n_i(x) - e\\,n_e(x,\\phi)$. The problem specifies that in the unperturbed state, the plasma is quasi-neutral, so the fixed ion density $n_i(x)$ is equal to the equilibrium electron density $n_{e0}(x)$. The electron density $n_e(x,\\phi)$ perturbs from this equilibrium value according to the Boltzmann relation:\n$$\nn_e(x,\\phi) = n_{e0}(x)\\,\\exp\\left(\\frac{e\\,\\phi(x)}{k_B\\,T_e(x)}\\right)\n$$\nSubstituting these expressions into the Poisson equation gives the nonlinear Poisson-Boltzmann equation:\n$$\n\\frac{d^2 \\phi}{dx^2} = -\\frac{e}{\\varepsilon_0} \\left[ n_{e0}(x) - n_{e0}(x)\\,\\exp\\left(\\frac{e\\,\\phi(x)}{k_B\\,T_e(x)}\\right) \\right] = \\frac{e\\,n_{e0}(x)}{\\varepsilon_0} \\left[ \\exp\\left(\\frac{e\\,\\phi(x)}{k_B\\,T_e(x)}\\right) - 1 \\right]\n$$\nTo find the characteristic screening length, we linearize this equation under the assumption of a small potential, i.e., the potential energy is much smaller than the thermal energy: $|e\\,\\phi(x)| \\ll k_B\\,T_e(x)$. This allows for a first-order Taylor expansion of the exponential function, $\\exp(z) \\approx 1+z$ for small $z$. Applying this to our equation with $z = \\frac{e\\,\\phi(x)}{k_B\\,T_e(x)}$:\n$$\n\\exp\\left(\\frac{e\\,\\phi(x)}{k_B\\,T_e(x)}\\right) - 1 \\approx \\left(1 + \\frac{e\\,\\phi(x)}{k_B\\,T_e(x)}\\right) - 1 = \\frac{e\\,\\phi(x)}{k_B\\,T_e(x)}\n$$\nSubstituting this linearization back into the Poisson-Boltzmann equation yields the linearized equation:\n$$\n\\frac{d^2 \\phi}{dx^2} \\approx \\frac{e\\,n_{e0}(x)}{\\varepsilon_0} \\left( \\frac{e\\,\\phi(x)}{k_B\\,T_e(x)} \\right) = \\left( \\frac{e^2\\,n_{e0}(x)}{\\varepsilon_0\\,k_B\\,T_e(x)} \\right) \\phi(x)\n$$\nThis equation is a form of the screened Poisson equation, $\\nabla^2\\phi = \\phi/\\lambda_D^2$. By comparing the two forms, we can identify the inverse square of the position-dependent Debye length, $\\lambda_D(x)$, as the term multiplying $\\phi(x)$:\n$$\n\\frac{1}{\\lambda_D^2(x)} = \\frac{e^2\\,n_{e0}(x)}{\\varepsilon_0\\,k_B\\,T_e(x)}\n$$\nSolving for $\\lambda_D(x)$ gives:\n$$\n\\lambda_D(x) = \\sqrt{\\frac{\\varepsilon_0\\,k_B\\,T_e(x)}{e^2\\,n_{e0}(x)}}\n$$\nThe problem provides the convenient relation for temperature expressed in electron-volts, $T_e^{(\\mathrm{eV})}(x)$, where $k_B\\,T_e(x) = e\\,T_e^{(\\mathrm{eV})}(x)$. Substituting this into the expression for $\\lambda_D(x)$ simplifies it to the final form used for computation:\n$$\n\\lambda_D(x) = \\sqrt{\\frac{\\varepsilon_0\\,(e\\,T_e^{(\\mathrm{eV})}(x))}{e^2\\,n_{e0}(x)}} = \\sqrt{\\frac{\\varepsilon_0\\,T_e^{(\\mathrm{eV})}(x)}{e\\,n_{e0}(x)}}\n$$\nThis is the derived formula for the local Debye screening length.\n\n**2. Numerical Algorithm Design**\n\nThe core task is to compute $\\lambda_D(x)$ and its statistics. A secondary task for verification is to implement a solver for the full nonlinear Poisson-Boltzmann equation.\n\n**Computing $\\lambda_D(x)$:**\n1.  Discretize the spatial domain $x \\in [0,L]$ into a uniform grid of $N=1001$ points, $x_j = j \\cdot h$ where $h=L/(N-1)$.\n2.  For each test case, define the functions $n_{e0}(x)$ and $T_e^{(\\mathrm{eV})}(x)$ as specified.\n3.  Evaluate these functions at each grid point $x_j$ to obtain arrays of density values, $n_{e0,j}$, and temperature values, $T_{e,j}^{(\\mathrm{eV})}$.\n4.  Apply the derived formula for $\\lambda_D(x)$ element-wise to these arrays to compute the Debye length profile $\\lambda_{D,j}$.\n5.  Use standard numerical functions to calculate the spatial average ($\\overline{\\lambda_D} = \\frac{1}{N}\\sum_{j=0}^{N-1} \\lambda_{D,j}$), the minimum, and the maximum of the computed $\\lambda_D$ profile.\n\n**Nonlinear Poisson-Boltzmann Solver (for Verification):**\nThis is a boundary value problem. We solve it using a finite-difference scheme combined with Newton's method.\n1.  Discretize the nonlinear PB equation using a second-order central difference for the second derivative: $(\\phi_{j+1} - 2\\phi_j + \\phi_{j-1})/h^2$. This yields a system of $N-2$ nonlinear algebraic equations for the potential $\\phi_j$ at the interior grid points ($j=1, \\dots, N-2$).\n2.  The system has the form $\\mathbf{F}(\\mathbf{\\Phi}) = \\mathbf{0}$, where $\\mathbf{\\Phi}$ is the vector of unknown potentials $[\\phi_1, \\dots, \\phi_{N-2}]^T$.\n3.  Newton's method iteratively refines a solution guess $\\mathbf{\\Phi}^{(k)}$ by solving the linear system $\\mathbf{J}(\\mathbf{\\Phi}^{(k)}) \\Delta\\mathbf{\\Phi}^{(k)} = -\\mathbf{F}(\\mathbf{\\Phi}^{(k)})$, where $\\mathbf{J}$ is the Jacobian matrix of $\\mathbf{F}$.\n4.  The Jacobian is tridiagonal due to the local nature of the finite-difference stencil. Its elements are computed from the derivatives of the discretized equations.\n5.  The solution is updated via $\\mathbf{\\Phi}^{(k+1)} = \\mathbf{\\Phi}^{(k)} + \\Delta\\mathbf{\\Phi}^{(k)}$. Iterations continue until the norm of the update vector $\\Delta\\mathbf{\\Phi}^{(k)}$ falls below a specified tolerance. An initial guess, e.g., a linear interpolation $\\phi(x) = V_0(1-x/L)$, is used to start the process. This solver is implemented but not used for the final output as per problem instructions.\n\nThe final output is generated by collecting the three computed scalars (average, min, max of $\\lambda_D(x)$) for each of the four test cases and formatting them into a single-line string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.constants import epsilon_0, e\n\ndef calculate_debye_length_stats(L, n_e0_func, Te_eV_func, N=1001):\n    \"\"\"\n    Computes the position-dependent Debye length and its key statistics.\n\n    Args:\n        L (float): Length of the domain in meters.\n        n_e0_func (callable): Function n_e0(x, L) for equilibrium electron density.\n        Te_eV_func (callable): Function T_e_eV(x, L) for electron temperature in eV.\n        N (int): Number of grid points for discretization.\n\n    Returns:\n        tuple: A tuple containing the average, minimum, and maximum Debye length.\n    \"\"\"\n    x = np.linspace(0, L, N)\n    \n    # Evaluate density and temperature profiles on the grid\n    n_e0_vals = n_e0_func(x, L)\n    Te_eV_vals = Te_eV_func(x, L)\n\n    # Derived formula for position-dependent Debye length:\n    # lambda_D(x) = sqrt(epsilon_0 * T_e_eV(x) / (e * n_e0(x)))\n    # Add a small value to the denominator to prevent division by zero in pathological cases,\n    # though not strictly necessary for the given test cases.\n    denominator = e * n_e0_vals\n    safe_denominator = np.where(denominator > 0, denominator, 1e-99)\n    lambda_d_profile = np.sqrt(epsilon_0 * Te_eV_vals / safe_denominator)\n\n    # Compute statistics\n    avg_lambda_d = np.mean(lambda_d_profile)\n    min_lambda_d = np.min(lambda_d_profile)\n    max_lambda_d = np.max(lambda_d_profile)\n    \n    return avg_lambda_d, min_lambda_d, max_lambda_d\n\ndef solve_nonlinear_pb(L, n_e0_func, Te_eV_func, V0, N, tol=1e-8, max_iter=50):\n    \"\"\"\n    Solves the 1D nonlinear Poisson-Boltzmann equation using Newton's method.\n    This function is implemented to fulfill the problem requirements but is not\n    used to generate the final required output.\n\n    Args:\n        L (float): Domain length.\n        n_e0_func (callable): Equilibrium electron density function.\n        Te_eV_func (callable): Electron temperature function (in eV).\n        V0 (float): Boundary potential at x=0.\n        N (int): Number of grid points.\n        tol (float): Convergence tolerance for Newton's method.\n        max_iter (int): Maximum number of iterations.\n\n    Returns:\n        tuple: A tuple of (x_grid, phi_solution) NumPy arrays.\n    \"\"\"\n    x = np.linspace(0, L, N)\n    h = L / (N - 1)\n    \n    n_e0 = n_e0_func(x, L)\n    T_e_eV = Te_eV_func(x, L)\n    \n    # Initial guess: linear potential from V0 to 0\n    phi = V0 * (1.0 - x / L)\n    \n    # Indices for interior points\n    interior = slice(1, N - 1)\n    \n    for k in range(max_iter):\n        phi_int = phi[interior]\n        n_e0_int = n_e0[interior]\n        T_e_eV_int = T_e_eV[interior]\n\n        if np.any(T_e_eV_int = 0):\n             raise ValueError(\"Temperature must be positive.\")\n\n        # Compute residual vector F(phi) for interior points\n        # F_j = (phi_{j+1}-2phi_j+phi_{j-1})/h^2 - (e*n_j/eps0)*(exp(phi_j/T_j)-1)\n        F = (phi[2:] - 2 * phi[1:-1] + phi[:-2]) / h**2\n        exp_term = np.exp(phi_int / T_e_eV_int)\n        F -= (e * n_e0_int / epsilon_0) * (exp_term - 1)\n        \n        # Compute Jacobian matrix J(phi) (tridiagonal)\n        # Main diagonal: J_jj = -2/h^2 - (e*n_j/(eps0*T_j))*exp(phi_j/T_j)\n        diag = -2.0 / h**2 - (e * n_e0_int / (epsilon_0 * T_e_eV_int)) * exp_term\n        \n        J = np.diag(diag)\n        \n        # Off-diagonals: J_{j,j-1} = J_{j,j+1} = 1/h^2\n        off_diag_val = 1.0 / h**2\n        np.fill_diagonal(J[1:], off_diag_val)\n        np.fill_diagonal(J[:, 1:], off_diag_val)\n        \n        # Solve the linear system J * delta_phi = -F\n        try:\n            delta_phi = np.linalg.solve(J, -F)\n        except np.linalg.LinAlgError:\n            # Fallback to pseudo-inverse if Jacobian is singular\n            delta_phi = np.linalg.pinv(J) @ -F\n\n        # Update solution for interior points\n        phi[interior] += delta_phi\n        \n        # Check for convergence\n        if np.linalg.norm(delta_phi)  tol:\n            return x, phi\n            \n    # If not converged\n    # warnings.warn(\"Newton's method did not converge within max_iter.\")\n    return x, phi\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    N_points = 1001\n\n    test_cases = [\n        # Test Case 1: uniform reference\n        {\n            \"L\": 1.0e-3, \n            \"n_e0_func\": lambda x, L: 1.0e19 * np.ones_like(x),\n            \"Te_eV_func\": lambda x, L: 100.0 * np.ones_like(x),\n        },\n        # Test Case 2: oscillatory density, ramped temperature\n        {\n            \"L\": 2.0e-3, \n            \"n_e0_func\": lambda x, L: 1.0e19 * (1.0 + 0.2 * np.sin(2.0 * np.pi * x / L)),\n            \"Te_eV_func\": lambda x, L: 80.0 + 40.0 * (x / L),\n        },\n        # Test Case 3: parabolic density, decreasing temperature\n        {\n            \"L\": 1.0e-3, \n            \"n_e0_func\": lambda x, L: 5.0e18 + 4.5e18 * (x / L)**2,\n            \"Te_eV_func\": lambda x, L: 200.0 - 180.0 * (x / L),\n        },\n        # Test Case 4: low-density, constant temperature\n        {\n            \"L\": 5.0e-3, \n            \"n_e0_func\": lambda x, L: 1.0e16 * (1.0 + 4.0 * (x / L)),\n            \"Te_eV_func\": lambda x, L: 5.0 * np.ones_like(x),\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        stats = calculate_debye_length_stats(\n            case[\"L\"],\n            case[\"n_e0_func\"],\n            case[\"Te_eV_func\"],\n            N=N_points\n        )\n        all_results.extend(stats)\n\n    # Format the results into the required string format\n    # Example format: 1.234560e-03 (scientific notation with 6 digits after decimal)\n    formatted_results = [f\"{res:.6e}\" for res in all_results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}