{
    "hands_on_practices": [
        {
            "introduction": "To build our understanding of plasma equations of state, we begin with the most fundamental case: the ideal plasma. This exercise  treats the plasma as a simple mixture of non-interacting electrons and ions, allowing us to apply the ideal gas law to each species separately. By calculating the total pressure and the contribution from each component, you will establish a crucial baseline for comparison with the more complex, non-ideal models required for dense plasmas.",
            "id": "3974789",
            "problem": "Consider a uniform, quasineutral, fully ionized hydrogen plasma in the International System of Units (SI) with electron number density $n_e$ and ion number density $n_i$ satisfying $n_e = n_i = 10^{19}\\,\\mathrm{m}^{-3}$. Assume the electrons and ions are classical, non-degenerate, non-relativistic, and each species has a Maxwellian velocity distribution at a common kinetic temperature $T = 10\\,\\mathrm{eV}$, where the electronvolt (eV) is defined such that $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$ and the elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$. Starting from the kinetic-theory definition of pressure for an ideal monatomic gas and the thermodynamic postulates applicable to a dilute, weakly coupled plasma, derive the expression for the total pressure of this two-species mixture in terms of the species number densities and temperatures. Then evaluate the total pressure numerically for the stated conditions and determine the fraction of the total pressure contributed by electrons. Express the final pressure in Pascals, and express the fraction as a pure number (decimal or fraction) with no percentage sign. Round your answers to $4$ significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All conditions and data provided are self-consistent and realistic for a laboratory plasma.\n\nThe derivation begins from the kinetic theory of gases. For a single species of particles (e.g., electrons or ions) treated as an ideal monatomic gas, the pressure $P$ exerted on the walls of a container is given by the average rate of momentum transfer per unit area. This leads to the expression:\n$$P = \\frac{1}{3} n m \\langle v^2 \\rangle$$\nwhere $n$ is the number density of the particles, $m$ is the mass of a single particle, and $\\langle v^2 \\rangle$ is the mean-squared speed of the particles.\n\nThe problem states that each species has a Maxwellian velocity distribution at a kinetic temperature $T$. For a Maxwellian gas in three dimensions, the equipartition theorem states that the average kinetic energy per particle is related to the temperature by:\n$$\\frac{1}{2} m \\langle v^2 \\rangle = \\frac{3}{2} k_B T$$\nwhere $k_B$ is the Boltzmann constant. From this, we can express the mean-squared speed as:\n$$m \\langle v^2 \\rangle = 3 k_B T$$\n\nSubstituting this result back into the kinetic expression for pressure, we obtain the ideal gas law for a single species:\n$$P = \\frac{1}{3} n (3 k_B T) = n k_B T$$\n\nThe problem describes a dilute, weakly coupled plasma, which is a mixture of two species: electrons (subscript $e$) and ions (subscript $i$). In such a mixture, the interactions between particles are negligible for determining the equation of state. Therefore, according to Dalton's Law of Partial Pressures, the total pressure $P_{total}$ is the sum of the partial pressures of the constituent species.\n$$P_{total} = P_e + P_i$$\nEach species is treated as an ideal gas, so their partial pressures are given by:\n$$P_e = n_e k_B T_e$$\n$$P_i = n_i k_B T_i$$\nwhere $n_e$ and $T_e$ are the electron number density and temperature, and $n_i$ and $T_i$ are the ion number density and temperature.\n\nThe problem specifies a common kinetic temperature for both species, so $T_e = T_i = T$. The total pressure is thus:\n$$P_{total} = n_e k_B T + n_i k_B T = (n_e + n_i) k_B T$$\nThis is the general expression for the total pressure of a two-species ideal plasma in thermal equilibrium.\n\nThe problem provides the following numerical values:\nElectron number density: $n_e = 10^{19}\\,\\mathrm{m}^{-3}$\nIon number density: $n_i = 10^{19}\\,\\mathrm{m}^{-3}$\nKinetic temperature: $T = 10\\,\\mathrm{eV}$\n\nNote that in plasma physics, temperature is often given in units of electronvolts ($\\mathrm{eV}$). This is a statement about the average thermal energy, $k_B T$. The conversion is $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$, where $e$ is the elementary charge. Thus, the thermal energy is:\n$$k_B T = 10\\,\\mathrm{eV} = 10 \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\times (1\\,\\mathrm{J/C}) = 1.602176634 \\times 10^{-18}\\,\\mathrm{J}$$\n\nNow we can calculate the total pressure.\n$$P_{total} = (n_e + n_i) k_B T$$\n$$P_{total} = (10^{19}\\,\\mathrm{m}^{-3} + 10^{19}\\,\\mathrm{m}^{-3}) \\times (1.602176634 \\times 10^{-18}\\,\\mathrm{J})$$\n$$P_{total} = (2 \\times 10^{19}\\,\\mathrm{m}^{-3}) \\times (1.602176634 \\times 10^{-18}\\,\\mathrm{J})$$\n$$P_{total} = 3.204353268 \\times 10^{1}\\,\\mathrm{J/m^3}$$\nSince $1\\,\\mathrm{J/m^3} = 1\\,\\mathrm{Pa}$, the total pressure is:\n$$P_{total} = 32.04353268\\,\\mathrm{Pa}$$\nRounding to $4$ significant figures, we get:\n$$P_{total} \\approx 32.04\\,\\mathrm{Pa}$$\n\nNext, we determine the fraction of the total pressure contributed by the electrons. This fraction, $f_e$, is given by the ratio of the electron partial pressure to the total pressure:\n$$f_e = \\frac{P_e}{P_{total}} = \\frac{n_e k_B T}{(n_e + n_i) k_B T}$$\nThe term $k_B T$ cancels, leaving:\n$$f_e = \\frac{n_e}{n_e + n_i}$$\nUsing the given number densities, $n_e = n_i = 10^{19}\\,\\mathrm{m}^{-3}$:\n$$f_e = \\frac{10^{19}}{10^{19} + 10^{19}} = \\frac{10^{19}}{2 \\times 10^{19}} = \\frac{1}{2}$$\nAs a decimal, this is $0.5$. The problem requests the answer rounded to $4$ significant figures, which gives:\n$$f_e = 0.5000$$\nThis result is independent of temperature and depends only on the relative number densities. Since the number densities of electrons and ions are equal in a fully ionized hydrogen plasma, they contribute equally to the total pressure.",
            "answer": "$$\\boxed{\\begin{pmatrix} 32.04 & 0.5000 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Real plasmas, especially at high densities, deviate significantly from ideal behavior due to strong electrostatic interactions. The key to navigating this complexity is to first diagnose the plasma's coupling strength, which is the focus of this practice . You will calculate the ionic Coulomb coupling parameter, $\\Gamma$, to quantify the ratio of potential to kinetic energy and assess whether a sophisticated model like the One-Component Plasma (OCP) is a valid approximation.",
            "id": "3974855",
            "problem": "A fully ionized carbon plasma is characterized by ionic charge number $Z=6$, temperature $T=1\\,\\mathrm{eV}$, and ion number density $n_i=10^{28}\\,\\mathrm{m}^{-3}$. Starting from first principles, define the Coulomb coupling parameter for ions as the ratio of a characteristic Coulomb potential energy to a characteristic thermal energy. Use the mean interionic separation estimated by the Wigner–Seitz construction, expressed via the ion number density, as the characteristic length scale of the interaction. Derive a closed-form expression for the ionic Coulomb coupling parameter $\\Gamma$ in terms of $Z$, $n_i$, and $T$, and then compute its numerical value for the given plasma. Round your computed $\\Gamma$ to three significant figures and report it as a dimensionless number with no units.\n\nAfter computing $\\Gamma$, briefly evaluate whether an equation of state based on the One-Component Plasma (OCP) model is appropriate for the ions in this plasma, stating the physical criteria that guide this assessment.\n\nUse the following constants:\n- Elementary charge $e=1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$,\n- Vacuum permittivity $\\varepsilon_0=8.854\\,187\\,8128 \\times 10^{-12}\\,\\mathrm{F/m}$,\n- Boltzmann constant $k_B=1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}$,\n- Energy conversion $1\\,\\mathrm{eV}=1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It presents a standard problem in plasma physics that is solvable using fundamental principles and the provided data.\n\nThe ionic Coulomb coupling parameter, denoted by $\\Gamma$, is defined as the ratio of the characteristic Coulomb potential energy between two ions, $U_C$, to the characteristic thermal energy, $E_{th}$.\n$$\n\\Gamma = \\frac{U_C}{E_{th}}\n$$\nThe characteristic thermal energy of an ion at temperature $T$ is given by $k_B T$, where $k_B$ is the Boltzmann constant.\n$$\nE_{th} = k_B T\n$$\nThe characteristic Coulomb potential energy, $U_C$, is the electrostatic potential energy between two ions at a characteristic separation distance. For a fully ionized carbon plasma, the charge of each ion is $q = Ze$, where $Z=6$ is the ionic charge number and $e$ is the elementary charge. The problem specifies that the characteristic separation distance should be the Wigner-Seitz radius, $a$. This radius is defined as the radius of a sphere that, on average, contains a single ion. The volume of this sphere, $V_{ion} = \\frac{4}{3}\\pi a^3$, is the reciprocal of the ion number density, $n_i$.\n$$\n\\frac{4}{3}\\pi a^3 = \\frac{1}{n_i}\n$$\nSolving for the Wigner-Seitz radius $a$:\n$$\na = \\left( \\frac{3}{4\\pi n_i} \\right)^{1/3}\n$$\nThe Coulomb potential energy between two ions of charge $Ze$ separated by the distance $a$ is given by Coulomb's law:\n$$\nU_C = \\frac{1}{4\\pi\\varepsilon_0} \\frac{(Ze)(Ze)}{a} = \\frac{Z^2 e^2}{4\\pi\\varepsilon_0 a}\n$$\nwhere $\\varepsilon_0$ is the vacuum permittivity.\nSubstituting the expressions for $E_{th}$, $U_C$, and $a$ into the definition of $\\Gamma$, we obtain the closed-form expression for the ionic Coulomb coupling parameter:\n$$\n\\Gamma = \\frac{\\frac{Z^2 e^2}{4\\pi\\varepsilon_0 a}}{k_B T} = \\frac{Z^2 e^2}{4\\pi\\varepsilon_0 a k_B T}\n$$\nSubstituting the expression for $a$:\n$$\n\\Gamma = \\frac{Z^2 e^2}{4\\pi\\varepsilon_0 k_B T} \\left( \\frac{1}{a} \\right) = \\frac{Z^2 e^2}{4\\pi\\varepsilon_0 k_B T} \\left( \\frac{4\\pi n_i}{3} \\right)^{1/3}\n$$\nNow we compute the numerical value of $\\Gamma$ for the given plasma parameters:\n- Ionic charge number: $Z=6$\n- Ion number density: $n_i=10^{28}\\,\\mathrm{m}^{-3}$\n- Temperature: $T=1\\,\\mathrm{eV}$. This is a unit of energy, so it represents the thermal energy $k_B T$. We convert it to Joules using the given conversion factor: $k_B T = 1\\,\\mathrm{eV} = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$.\n- Constants:\n  - $e=1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$\n  - $\\varepsilon_0=8.854\\,187\\,8128 \\times 10^{-12}\\,\\mathrm{F/m}$\n\nFirst, we calculate the Wigner-Seitz radius $a$:\n$$\na = \\left( \\frac{3}{4\\pi (10^{28}\\,\\mathrm{m}^{-3})} \\right)^{1/3} \\approx 2.8794 \\times 10^{-10}\\,\\mathrm{m}\n$$\nNext, we calculate $\\Gamma$ using the formula $\\Gamma = \\frac{Z^2 e^2}{4\\pi\\varepsilon_0 a k_B T}$:\n$$\n\\Gamma = \\frac{1}{4\\pi\\varepsilon_0} \\frac{Z^2 e^2}{a (k_B T)}\n$$\nWe substitute the numerical values:\n$$\n\\Gamma = \\frac{1}{4\\pi (8.854\\,187\\,8128 \\times 10^{-12})} \\frac{(6 \\times 1.602\\,176\\,634 \\times 10^{-19})^2}{(2.8794 \\times 10^{-10}) (1.602\\,176\\,634 \\times 10^{-19})}\n$$\n$$\n\\Gamma \\approx (8.98755 \\times 10^9) \\frac{9.24109 \\times 10^{-37}}{4.61331 \\times 10^{-29}}\n$$\n$$\n\\Gamma \\approx (8.98755 \\times 10^9) \\times (2.00269 \\times 10^{-8})\n$$\n$$\n\\Gamma \\approx 180.03\n$$\nRounding to three significant figures, the value is $\\Gamma \\approx 180$.\n\nNext, we evaluate whether an equation of state based on the One-Component Plasma (OCP) model is appropriate for the ions in this plasma. The OCP model treats ions as a single species of point charges interacting via the Coulomb potential, immersed in a rigid, uniform, neutralizing background of opposite charge (the electrons). The validity of this model rests on two physical criteria:\n1. The ions must be strongly coupled, meaning that their potential energy of interaction significantly exceeds their kinetic energy. This condition is met when the ion coupling parameter $\\Gamma$ is much greater than $1$. In our case, $\\Gamma \\approx 180 \\gg 1$, so the ions are indeed very strongly coupled. They are expected to be in a liquid or solid-like state.\n\n2. The electrons must form a nearly ideal, uniform background. This occurs when the electrons are highly quantum degenerate. Electron degeneracy is measured by the ratio of the thermal energy $k_B T$ to the electron Fermi energy $E_F$. The degeneracy parameter is $\\Theta_e = k_B T / E_F$. The OCP model is applicable if $\\Theta_e \\ll 1$.\n\nTo check this condition, we first calculate the electron number density $n_e$ from the charge neutrality condition: $n_e = Z n_i$.\n$$\nn_e = 6 \\times (10^{28}\\,\\mathrm{m}^{-3}) = 6 \\times 10^{28}\\,\\mathrm{m}^{-3}\n$$\nThe Fermi energy $E_F$ for a non-relativistic electron gas is given by:\n$$\nE_F = \\frac{\\hbar^2}{2m_e}(3\\pi^2 n_e)^{2/3}\n$$\nwhere $\\hbar$ is the reduced Planck constant and $m_e$ is the electron mass.\n$$\nE_F = \\frac{(1.05457 \\times 10^{-34}\\,\\mathrm{J\\cdot s})^2}{2(9.10938 \\times 10^{-31}\\,\\mathrm{kg})} (3\\pi^2 (6 \\times 10^{28}\\,\\mathrm{m}^{-3}))^{2/3}\n$$\n$$\nE_F \\approx (6.1042 \\times 10^{-39}\\,\\mathrm{J\\cdot m^2}) \\times (1.7765 \\times 10^{30}\\,\\mathrm{m}^{-3})^{2/3}\n$$\n$$\nE_F \\approx (6.1042 \\times 10^{-39}\\,\\mathrm{J\\cdot m^2}) \\times (1.4682 \\times 10^{20}\\,\\mathrm{m}^{-2}) \\approx 8.962 \\times 10^{-18}\\,\\mathrm{J}\n$$\nThe thermal energy is $k_B T = 1\\,\\mathrm{eV} = 1.602 \\times 10^{-19}\\,\\mathrm{J}$. The electron degeneracy parameter is:\n$$\n\\Theta_e = \\frac{k_B T}{E_F} = \\frac{1.602 \\times 10^{-19}\\,\\mathrm{J}}{8.962 \\times 10^{-18}\\,\\mathrm{J}} \\approx 0.01787\n$$\nSince $\\Theta_e \\approx 0.018 \\ll 1$, the electrons are highly degenerate. Their Fermi energy greatly exceeds the thermal energy, causing them to behave as a nearly ideal, high-pressure quantum gas which forms a smooth, neutralizing background for the ions.\n\nBoth criteria ($\\Gamma \\gg 1$ and $\\Theta_e \\ll 1$) are well satisfied. Therefore, the One-Component Plasma model is an excellent approximation for describing the ionic equation of state for this plasma.",
            "answer": "$$\\boxed{180}$$"
        },
        {
            "introduction": "A physically valid Equation of State must not only be accurate but also thermodynamically self-consistent. This hands-on coding exercise  tasks you with implementing a fundamental check on any EOS model by numerically verifying a Maxwell relation. By confirming that $\\left(\\partial P/\\partial T\\right)_V = \\left(\\partial S/\\partial V\\right)_T$ for a plasma model, you will practice a critical skill for developing robust and reliable computational tools in fusion science.",
            "id": "3974863",
            "problem": "You are given a specification to implement a numerical consistency check for the equation of state (EOS) of a two-component classical plasma, in the context of computational fusion science and engineering. The check targets the Maxwell relation linking pressure and entropy via the Helmholtz free energy, which requires verifying that the mixed second derivatives of the Helmholtz free energy are equal, implying that the equality $\\left(\\partial P/\\partial T\\right)_V = \\left(\\partial S/\\partial V\\right)_T$ holds. Your program must construct an EOS table on a rectangular grid of temperature and volume, compute the relevant derivatives numerically, and report whether the equality holds within specified tolerances for several test scenarios.\n\nFundamental base and model construction requirements:\n- Use the Helmholtz free energy $F(T,V,N_e,N_i)$ with fixed particle numbers $N_e$ and $N_i$ for electrons and ions, respectively. The total Helmholtz free energy $F$ is the sum of ideal-gas contributions for electrons and ions and a non-ideal excess term given by the Debye–Hückel (DH) limiting law where specified.\n- For each species $j \\in \\{e,i\\}$, the ideal-gas Helmholtz free energy is $F_{\\mathrm{id},j}(T,V,N_j) = N_j k_B T \\left[\\ln\\!\\left(n_j \\lambda_j^3\\right) - 1\\right]$, where $n_j = N_j/V$ is the number density and $\\lambda_j = h/\\sqrt{2\\pi m_j k_B T}$ is the thermal de Broglie wavelength. Here $m_e$ and $m_i$ are the electron and ion masses, $k_B$ is the Boltzmann constant, and $h$ is the Planck constant.\n- The Debye–Hückel excess free energy is $F_{\\mathrm{ex}}(T,V,N_e,N_i) = - V k_B T \\, k_D^3 / (12 \\pi)$ when enabled, where the Debye wavenumber satisfies $k_D^2 = \\sum_j n_j z_j^2 e^2 / (\\varepsilon_0 k_B T)$ with $z_e^2 = 1$, $z_i^2 = 1$, $e$ is the elementary charge, and $\\varepsilon_0$ is the vacuum permittivity. In the symmetric case $N_e = N_i = N$, one has $k_D^2 = 2 N e^2 / (\\varepsilon_0 k_B T V)$, which implies $F_{\\mathrm{ex}}(T,V) = - C (k_B T)^{-1/2} V^{-1/2}$ with $C = \\left(2 N e^2 / \\varepsilon_0\\right)^{3/2} / (12 \\pi)$.\n- Pressure and entropy must be obtained from the Helmholtz free energy via $P(T,V) = -\\left(\\partial F/\\partial V\\right)_T$ and $S(T,V) = -\\left(\\partial F/\\partial T\\right)_V$.\n\nNumerical consistency check:\n- Build a rectangular grid of temperatures $T$ and volumes $V$. Compute the EOS table $P(T,V)$ and $S(T,V)$ on this grid.\n- Compute $\\left(\\partial P/\\partial T\\right)_V$ using centered finite differences along the temperature axis at interior grid points, i.e., for interior index $i$, $\\left(\\partial P/\\partial T\\right)_V \\approx \\left[P(T_{i+1},V) - P(T_{i-1},V)\\right] / \\left(T_{i+1}-T_{i-1}\\right)$.\n- Compute $\\left(\\partial S/\\partial V\\right)_T$ using centered finite differences along the volume axis at interior grid points, i.e., for interior index $j$, $\\left(\\partial S/\\partial V\\right)_T \\approx \\left[S(T,V_{j+1}) - S(T,V_{j-1})\\right] / \\left(V_{j+1}-V_{j-1}\\right)$.\n- Compare the two derivatives on the interior subgrid using a pointwise normalized discrepancy $R = \\left|\\Delta\\right| / \\max\\!\\left(\\left|\\left(\\partial P/\\partial T\\right)_V\\right|,\\left|\\left(\\partial S/\\partial V\\right)_T\\right|,\\epsilon\\right)$, where $\\Delta = \\left(\\partial P/\\partial T\\right)_V - \\left(\\partial S/\\partial V\\right)_T$ and $\\epsilon$ is a small positive number to avoid division by zero. Use $\\epsilon = 10^{-300}$.\n- For each test case, compute the maximum $R$ over the interior subgrid. The test passes if the maximum $R$ is less than or equal to the specified tolerance.\n\nUnits and constants:\n- Use the International System of Units (SI). Temperature $T$ must be in kelvin, volume $V$ in $\\mathrm{m}^3$, pressure $P$ in pascal, and entropy $S$ in joule per kelvin.\n- Use the constants $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$, $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\cdot s}$, $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$, $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$, $m_e = 9.1093837015 \\times 10^{-31}\\ \\mathrm{kg}$, and $m_i = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$.\n\nTest suite:\n- Test case $1$ (happy path, non-ideal): Use $N_e = N_i = N$ with $N = n_{\\mathrm{ref}} V_{\\mathrm{ref}}$, where $n_{\\mathrm{ref}} = 10^{20}\\ \\mathrm{m}^{-3}$ and $V_{\\mathrm{ref}} = 10^{-6}\\ \\mathrm{m}^3$, so $N = 10^{14}$. Use a temperature grid from $T_{\\min} = 10^{5}\\ \\mathrm{K}$ to $T_{\\max} = 5\\times 10^{6}\\ \\mathrm{K}$ with $41$ equally spaced points, and a volume grid from $V_{\\min} = 10^{-6}\\ \\mathrm{m}^3$ to $V_{\\max} = 5\\times 10^{-6}\\ \\mathrm{m}^3$ with $41$ equally spaced points. Enable the Debye–Hückel excess free energy. Tolerance $= 10^{-4}$.\n- Test case $2$ (coarse grid, non-ideal edge): Same $N$ and ranges as Test case $1$, but with $9$ equally spaced points for both temperature and volume grids. Enable the Debye–Hückel excess free energy. Tolerance $= 5\\times 10^{-3}$.\n- Test case $3$ (ideal-only): Same $N$ and grid as Test case $1$, but disable the Debye–Hückel excess free energy. Tolerance $= 10^{-6}$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the pass/fail results for the three test cases as a comma-separated list enclosed in square brackets, where each entry is either $\\,\\texttt{true}\\,$ or $\\,\\texttt{false}\\,$ in lowercase. For example, the output format must be exactly like $\\texttt{[true,false,true]}$.\n\nNo external input is allowed; all parameters must be defined within the program.",
            "solution": "The problem requires the implementation of a numerical verification procedure for the thermodynamic self-consistency of an equation of state (EOS) for a two-component classical plasma. The core of this verification lies in confirming a fundamental Maxwell relation derived from the Helmholtz free energy, $F(T,V)$. Specifically, we must verify that the mixed second partial derivatives of the free energy are equal, $F_{TV} = F_{VT}$, which implies the equality $\\left(\\partial P/\\partial T\\right)_V = \\left(\\partial S/\\partial V\\right)_T$. Here, $P$ is the pressure and $S$ is the entropy, quantities derived from $F$ as $P = -\\left(\\partial F/\\partial V\\right)_T$ and $S = -\\left(\\partial F/\\partial T\\right)_V$.\n\nThe problem is first validated and found to be scientifically sound, well-posed, and complete. The physical model, consisting of an ideal gas contribution and a Debye-Hückel excess term, is a standard and appropriate approximation for weakly coupled classical plasmas. The numerical method, using centered finite differences, is a standard approach for derivative approximation. The test cases and parameters are physically reasonable and internally consistent.\n\nThe solution proceeds in two primary stages: first, the analytical derivation of pressure and entropy from the specified Helmholtz free energy model, and second, the design of a numerical algorithm to compute and compare the required derivatives.\n\nThe total Helmholtz free energy $F$ for a quasi-neutral plasma with $N_e = N_i = N$ is the sum of the ideal gas contributions from electrons ($e$) and ions ($i$), and an excess term $F_{\\mathrm{ex}}$ from the Debye-Hückel (DH) model:\n$$\nF(T,V,N) = F_{\\mathrm{id},e}(T,V,N) + F_{\\mathrm{id},i}(T,V,N) + F_{\\mathrm{ex}}(T,V,N)\n$$\n\nThe ideal-gas free energy for a species $j$ is given by $F_{\\mathrm{id},j} = N k_B T \\left[\\ln(n \\lambda_j^3) - 1\\right]$, where $n=N/V$ is the number density and $\\lambda_j = h/\\sqrt{2\\pi m_j k_B T}$ is the thermal de Broglie wavelength. Combining electron and ion terms gives the total ideal free energy:\n$$\nF_{\\mathrm{id}}(T,V,N) = -2 N k_B T \\ln(V) - 3 N k_B T \\ln(T) + T \\cdot \\text{const}(N, m_e, m_i)\n$$\n\nThe Debye-Hückel excess free energy is specified for the symmetric case as $F_{\\mathrm{ex}}(T,V) = -C (k_B T)^{-1/2} V^{-1/2}$, where the constant $C = \\left(2 N e^2 / \\varepsilon_0\\right)^{3/2} / (12 \\pi)$ depends on the particle number $N$, the elementary charge $e$, and the vacuum permittivity $\\varepsilon_0$.\n\nFrom these expressions, we derive the pressure $P$ and entropy $S$:\n\n1.  **Pressure $P(T,V)$**:\n    $P = -\\left(\\frac{\\partial F}{\\partial V}\\right)_T = -\\left(\\frac{\\partial F_{\\mathrm{id}}}{\\partial V}\\right)_T - \\left(\\frac{\\partial F_{\\mathrm{ex}}}{\\partial V}\\right)_T$.\n    The ideal part yields the ideal gas law for $2N$ particles: $P_{\\mathrm{id}} = -(-2 N k_B T/V) = 2 N k_B T/V$.\n    The excess part contributes: $P_{\\mathrm{ex}} = - \\frac{\\partial}{\\partial V}\\left(-C (k_B T)^{-1/2} V^{-1/2}\\right) = -C (k_B T)^{-1/2} (\\frac{1}{2}V^{-3/2})$.\n    The total pressure is:\n    $$\n    P(T,V) = \\frac{2 N k_B T}{V} - \\frac{C}{2} (k_B T)^{-1/2} V^{-3/2}\n    $$\n    The second term is evaluated only if the Debye-Hückel model is enabled.\n\n2.  **Entropy $S(T,V)$**:\n    $S = -\\left(\\frac{\\partial F}{\\partial T}\\right)_V = -\\left(\\frac{\\partial F_{\\mathrm{id}}}{\\partial T}\\right)_V - \\left(\\frac{\\partial F_{\\mathrm{ex}}}{\\partial T}\\right)_V$.\n    The ideal part gives the Sackur-Tetrode equation for a two-component mixture:\n    $S_{\\mathrm{id}} = S_{\\mathrm{id},e} + S_{\\mathrm{id},i}$, where $S_{\\mathrm{id},j} = N k_B \\left[ \\ln\\left(\\frac{V}{N} \\left(\\frac{2\\pi m_j k_B T}{h^2}\\right)^{3/2}\\right) + \\frac{5}{2} \\right]$.\n    The excess part contributes: $S_{\\mathrm{ex}} = - \\frac{\\partial}{\\partial T}\\left(-C (k_B T)^{-1/2} V^{-1/2}\\right) = -C V^{-1/2} \\frac{\\partial}{\\partial T}( (k_B T)^{-1/2} ) = - C V^{-1/2} (-\\frac{1}{2}(k_B T)^{-3/2} k_B)$.\n    This simplifies to: $S_{\\mathrm{ex}} = -\\frac{C}{2} k_B^{-1/2} V^{-1/2} T^{-3/2}$.\n    The total entropy is:\n    $$\n    S(T,V) = S_{\\mathrm{id},e} + S_{\\mathrm{id},i} - \\frac{C}{2} k_B^{-1/2} V^{-1/2} T^{-3/2}\n    $$\n    As with pressure, the excess term is included only when specified.\n\nThe numerical implementation follows these steps for each test case:\n1.  **Grid Generation**: A rectangular grid in temperature and volume is created using `numpy.linspace` and `numpy.meshgrid`. For a grid of $N_T \\times N_V$ points, this produces two arrays, `T` and `V`, of shape $(N_T, N_V)$, where `T` varies along the first axis and `V` along the second.\n2.  **EOS Table Computation**: The analytical expressions for $P(T,V)$ and $S(T,V)$ are evaluated on the grid, yielding two tables, `P_table` and `S_table`, of shape $(N_T, N_V)$. This is done efficiently using NumPy's vectorized operations.\n3.  **Numerical Differentiation**: The partial derivatives are approximated using a second-order centered finite difference scheme on the interior of the grid.\n    -   $\\left(\\frac{\\partial P}{\\partial T}\\right)_V$ at grid point $(T_i, V_j)$ is computed as $\\frac{P_{i+1,j} - P_{i-1,j}}{T_{i+1} - T_{i-1}}$. This is calculated for all interior temperature points ($i=1, \\dots, N_T-2$) and all volume points.\n    -   $\\left(\\frac{\\partial S}{\\partial V}\\right)_T$ at $(T_i, V_j)$ is computed as $\\frac{S_{i,j+1} - S_{i,j-1}}{V_{j+1} - V_{j-1}}$. This is calculated for all interior volume points ($j=1, \\dots, N_V-2$) and all temperature points.\n    -   The two resulting derivative arrays are then sliced to represent the common interior subgrid of dimensions $(N_T-2) \\times (N_V-2)$.\n4.  **Discrepancy Calculation**: The consistency is quantified by the pointwise normalized discrepancy, $R$, on the interior subgrid:\n    $$\n    R = \\frac{\\left| \\left(\\frac{\\partial P}{\\partial T}\\right)_V - \\left(\\frac{\\partial S}{\\partial V}\\right)_T \\right|}{\\max\\left(\\left|\\left(\\frac{\\partial P}{\\partial T}\\right)_V\\right|, \\left|\\left(\\frac{\\partial S}{\\partial V}\\right)_T\\right|, \\epsilon\\right)}\n    $$\n    where $\\epsilon=10^{-300}$ is a small regularization parameter to prevent division by zero.\n5.  **Verification**: The maximum value of $R$ over the entire interior subgrid is determined. The test case passes if this maximum discrepancy is less than or equal to the specified tolerance. The result (`true` or `false`) is then recorded.\n\nThis procedure is repeated for all three test cases defined in the problem, and the final results are formatted into the specified string output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the numerical consistency check for the three test cases.\n    \"\"\"\n    # Physical constants in SI units as specified in the problem.\n    k_B = 1.380649e-23       # Boltzmann constant (J/K)\n    h = 6.62607015e-34       # Planck constant (J*s)\n    e = 1.602176634e-19       # Elementary charge (C)\n    eps0 = 8.8541878128e-12  # Vacuum permittivity (F/m)\n    m_e = 9.1093837015e-31   # Electron mass (kg)\n    m_i = 1.67262192369e-27  # Ion mass (proton) (kg)\n    \n    # Epsilon for normalized discrepancy calculation.\n    epsilon = 1e-300\n\n    # Definition of the three test cases.\n    test_cases = [\n        {\n            \"name\": \"Case 1: Standard Grid, Non-Ideal\",\n            \"n_ref\": 1e20, \"v_ref\": 1e-6,\n            \"T_min\": 1e5, \"T_max\": 5e6, \"T_points\": 41,\n            \"V_min\": 1e-6, \"V_max\": 5e-6, \"V_points\": 41,\n            \"use_DH\": True, \"tolerance\": 1e-4\n        },\n        {\n            \"name\": \"Case 2: Coarse Grid, Non-Ideal\",\n            \"n_ref\": 1e20, \"v_ref\": 1e-6,\n            \"T_min\": 1e5, \"T_max\": 5e6, \"T_points\": 9,\n            \"V_min\": 1e-6, \"V_max\": 5e-6, \"V_points\": 9,\n            \"use_DH\": True, \"tolerance\": 5e-3\n        },\n        {\n            \"name\": \"Case 3: Standard Grid, Ideal-Only\",\n            \"n_ref\": 1e20, \"v_ref\": 1e-6,\n            \"T_min\": 1e5, \"T_max\": 5e6, \"T_points\": 41,\n            \"V_min\": 1e-6, \"V_max\": 5e-6, \"V_points\": 41,\n            \"use_DH\": False, \"tolerance\": 1e-6\n        },\n    ]\n\n    results = []\n    # Process each test case.\n    for params in test_cases:\n        passed = run_consistency_check(params, k_B, h, e, eps0, m_e, m_i, epsilon)\n        results.append(str(passed).lower())\n    \n    # Print the final output in the specified format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_pressure(T, V, N, k_B, C_dh, use_DH):\n    \"\"\"\n    Computes the pressure P(T, V) for the plasma.\n    P = 2*N*k_B*T/V - (C_dh/2) * (k_B*T)^(-1/2) * V^(-3/2)\n    \"\"\"\n    P_ideal = 2 * N * k_B * T / V\n    if not use_DH:\n        return P_ideal\n    \n    P_ex = - (1/2) * C_dh * (k_B * T)**(-1/2) * V**(-3/2)\n    return P_ideal + P_ex\n\ndef calculate_entropy(T, V, N, k_B, C_dh, use_DH, h, m_e, m_i):\n    \"\"\"\n    Computes the entropy S(T, V) for the plasma.\n    S_id,j = N*k_B * [ ln(V/N * (2*pi*m_j*k_B*T/h^2)^(3/2)) + 5/2 ]\n    S_ex = - (C_dh/2) * k_B^(-1/2) * T^(-3/2) * V^(-1/2)\n    \"\"\"\n    # Ideal gas contribution (Sackur-Tetrode equation for electrons and ions).\n    lambda_e_sq_inv = (2 * np.pi * m_e * k_B * T) / (h**2)\n    S_ideal_e = N * k_B * (np.log((V / N) * lambda_e_sq_inv**(3/2)) + 2.5)\n    \n    lambda_i_sq_inv = (2 * np.pi * m_i * k_B * T) / (h**2)\n    S_ideal_i = N * k_B * (np.log((V / N) * lambda_i_sq_inv**(3/2)) + 2.5)\n    \n    S_ideal = S_ideal_e + S_ideal_i\n    \n    if not use_DH:\n        return S_ideal\n    \n    # Debye-Hückel excess contribution.\n    S_ex = - (1/2) * C_dh * k_B**(-1/2) * V**(-1/2) * T**(-3/2)\n    return S_ideal + S_ex\n\ndef run_consistency_check(params, k_B, h, e, eps0, m_e, m_i, epsilon):\n    \"\"\"\n    Performs the numerical consistency check for a single test case.\n    \"\"\"\n    # Unpack parameters for the current test case.\n    N = params['n_ref'] * params['v_ref']\n    t_grid = np.linspace(params['T_min'], params['T_max'], params['T_points'])\n    v_grid = np.linspace(params['V_min'], params['V_max'], params['V_points'])\n    \n    # Create meshgrids for vectorized calculations.\n    T, V = np.meshgrid(t_grid, v_grid, indexing='ij')\n    \n    # Calculate the Debye-Hückel constant C if required.\n    C_dh = 0.0\n    if params['use_DH']:\n        C_dh = ((2 * N * e**2 / eps0)**(3/2)) / (12 * np.pi)\n\n    # Compute Pressure and Entropy tables on the grid.\n    P_table = calculate_pressure(T, V, N, k_B, C_dh, params['use_DH'])\n    S_table = calculate_entropy(T, V, N, k_B, C_dh, params['use_DH'], h, m_e, m_i)\n    \n    # Step sizes for finite differences.\n    dt = t_grid[1] - t_grid[0]\n    dv = v_grid[1] - v_grid[0]\n    \n    # Compute (dP/dT)_V using centered finite differences on the T-axis.\n    # Result is an array of shape (T_points-2, V_points).\n    dPdT = (P_table[2:, :] - P_table[:-2, :]) / (2 * dt)\n    \n    # Compute (dS/dV)_T using centered finite differences on the V-axis.\n    # Result is an array of shape (T_points, V_points-2).\n    dSdV = (S_table[:, 2:] - S_table[:, :-2]) / (2 * dv)\n\n    # Align derivatives on the interior subgrid of shape (T_points-2, V_points-2).\n    dPdT_interior = dPdT[:, 1:-1]\n    dSdV_interior = dSdV[1:-1, :]\n    \n    # Calculate the pointwise normalized discrepancy R.\n    Delta = dPdT_interior - dSdV_interior\n    norm = np.maximum(np.abs(dPdT_interior), np.abs(dSdV_interior))\n    norm = np.maximum(norm, epsilon)\n    R_table = np.abs(Delta) / norm\n    \n    # Find the maximum discrepancy over the interior subgrid.\n    max_R = np.max(R_table)\n    \n    # Test passes if the maximum discrepancy is within the specified tolerance.\n    return max_R <= params['tolerance']\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}