{
    "hands_on_practices": [
        {
            "introduction": "将物理世界中的连续信号转化为可供计算机处理的数字信号，是所有现代数据分析的第一步。然而，这一被称为模数转换（ADC）的过程并非完美无瑕，它会引入一种不可避免的误差——量化噪声。本练习 () 将引导您从第一性原理出发，推导量化噪声的基本特性，并学习如何通过信噪比（SNR）这一关键指标来量化其对信号质量的影响。",
            "id": "4046221",
            "problem": "托卡马克诊断链中的一个磁拾取线圈由一个均匀中置式模数转换器 (ADC) 进行数字化，其分辨率为 $B$ 位，满量程峰峰值输入范围为 $V_{\\mathrm{pp}} = 10\\,\\mathrm{V}$ (对应于 $\\pm 5\\,\\mathrm{V}$)。采样频率足够高，并且一个精心设计的抗混叠滤波器确保了带外频谱分量在采样前被衰减。假设量化误差是加性的，与输入不相关，并且在奈奎斯特频带内是白噪声。\n\n一个峰值为 $A = 1.25\\,\\mathrm{V}$ 的正弦校准音被施加到 ADC 输入端，该信号完全在通带内。从第一性原理和核心定义出发，完成以下任务：\n\n1. 根据步长为 $\\Delta$ 的均匀量化器的定义，通过将量化误差建模为在其量化单元上均匀分布的随机变量，推导量化误差功率。不要假定任何目标公式；从均匀概率密度函数开始并计算其方差。\n\n2. 使用峰值为 $A$ 的正弦波的均方根值，以及信噪比 (SNR) 定义为平均信号功率与噪声功率之比，推导一个用 $A$、$B$ 和 $V_{\\mathrm{pp}}$ 表示的 SNR 表达式。\n\n3. 对于 $B=14$、$V_{\\mathrm{pp}}=10\\,\\mathrm{V}$ 和 $A=1.25\\,\\mathrm{V}$，计算 SNR，并以分贝表示。将最终数值答案四舍五入到四位有效数字。\n\n最终答案仅报告以分贝为单位的 SNR。不要在最终答案中报告中间量。",
            "solution": "该问题陈述清晰，具有科学依据，并包含推导唯一解所需的所有信息。该过程涉及问题陈述中概述的三个主要步骤：推导量化误差功率，推导信噪比 (SNR) 表达式，以及根据给定参数计算 SNR。\n\n第 1 部分：量化误差功率的推导\n\n一个均匀的 $B$ 位量化器将其满量程峰峰值电压范围 $V_{\\mathrm{pp}}$ 分为 $2^B$ 个离散电平。相邻电平之间的电压差是量化步长 $\\Delta$。\n$$ \\Delta = \\frac{V_{\\mathrm{pp}}}{2^B} $$\n量化误差 $e_q$ 是连续输入电压与离散输出电压之间的差值。对于一个均匀中置式量化器，该误差被限制在 $[-\\frac{\\Delta}{2}, \\frac{\\Delta}{2}]$ 范围内。问题要求将此误差建模为在其量化单元上均匀分布的随机变量。因此，量化误差的概率密度函数 (PDF) $p(e_q)$ 为：\n$$ p(e_q) = \\begin{cases} \\frac{1}{\\Delta}  \\text{for } -\\frac{\\Delta}{2} \\le e_q \\le \\frac{\\Delta}{2} \\\\ 0  \\text{otherwise} \\end{cases} $$\n量化噪声的平均功率 $P_N$ 等于其方差 $\\sigma_q^2$，因为其均值为零。我们首先验证均值 $E[e_q]$ 为零。\n$$ E[e_q] = \\int_{-\\infty}^{\\infty} e_q p(e_q) de_q = \\int_{-\\Delta/2}^{\\Delta/2} e_q \\frac{1}{\\Delta} de_q = \\frac{1}{\\Delta} \\left[ \\frac{e_q^2}{2} \\right]_{-\\Delta/2}^{\\Delta/2} $$\n$$ E[e_q] = \\frac{1}{2\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^2 - \\left(-\\frac{\\Delta}{2}\\right)^2 \\right) = \\frac{1}{2\\Delta} \\left( \\frac{\\Delta^2}{4} - \\frac{\\Delta^2}{4} \\right) = 0 $$\n噪声功率 $P_N$ 是方差 $\\sigma_q^2 = E[e_q^2] - (E[e_q])^2 = E[e_q^2]$。我们从 PDF 计算这个均方值：\n$$ P_N = E[e_q^2] = \\int_{-\\infty}^{\\infty} e_q^2 p(e_q) de_q = \\int_{-\\Delta/2}^{\\Delta/2} e_q^2 \\frac{1}{\\Delta} de_q $$\n$$ P_N = \\frac{1}{\\Delta} \\left[ \\frac{e_q^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{3\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^3 - \\left(-\\frac{\\Delta}{2}\\right)^3 \\right) $$\n$$ P_N = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{8} - \\left(-\\frac{\\Delta^3}{8}\\right) \\right) = \\frac{1}{3\\Delta} \\left( \\frac{2\\Delta^3}{8} \\right) = \\frac{\\Delta^2}{12} $$\n第一部分的推导到此结束。\n\n第 2 部分：SNR 表达式的推导\n\n输入信号是一个峰值为 $A$ 的正弦波。瞬时电压可以写为 $s(t) = A \\sin(\\omega t)$。平均信号功率 $P_S$ 是信号的一个通用属性，定义为其平方值的均值。对于周期信号，这是在一个周期内计算的。对于正弦波，这等同于其均方根 (RMS) 值的平方。峰值为 $A$ 的正弦波的 RMS 值 $V_{\\mathrm{rms}}$ 是 $A/\\sqrt{2}$。\n$$ P_S = V_{\\mathrm{rms}}^2 = \\left( \\frac{A}{\\sqrt{2}} \\right)^2 = \\frac{A^2}{2} $$\n信噪比 (SNR) 定义为平均信号功率与平均噪声功率之比。\n$$ \\mathrm{SNR} = \\frac{P_S}{P_N} $$\n代入推导出的 $P_S$ 和 $P_N$ 表达式：\n$$ \\mathrm{SNR} = \\frac{A^2/2}{\\Delta^2/12} = \\frac{12A^2}{2\\Delta^2} = \\frac{6A^2}{\\Delta^2} $$\n为了用 $A$、$B$ 和 $V_{\\mathrm{pp}}$ 表示 SNR，我们代入 $\\Delta = V_{\\mathrm{pp}}/2^B$：\n$$ \\mathrm{SNR} = \\frac{6A^2}{\\left( V_{\\mathrm{pp}}/2^B \\right)^2} = \\frac{6A^2 (2^B)^2}{V_{\\mathrm{pp}}^2} = \\frac{6A^2 2^{2B}}{V_{\\mathrm{pp}}^2} $$\n这就是所要求的 SNR 解析表达式。\n\n第 3 部分：以分贝为单位计算 SNR\n\n我们给定的值为 $B = 14$、$V_{\\mathrm{pp}} = 10\\,\\mathrm{V}$ 和 $A = 1.25\\,\\mathrm{V}$。我们将这些值代入 SNR 表达式。\n$$ \\mathrm{SNR} = \\frac{6 \\times (1.25)^2 \\times 2^{2 \\times 14}}{(10)^2} = \\frac{6 \\times 1.5625 \\times 2^{28}}{100} $$\n$$ \\mathrm{SNR} = \\frac{9.375 \\times 268435456}{100} = \\frac{2516582400}{100} = 25165824 $$\n这是线性的功率比。为了以分贝 ($\\mathrm{dB}$) 表示 SNR，我们使用以下公式：\n$$ \\mathrm{SNR}_{\\mathrm{dB}} = 10 \\log_{10}(\\mathrm{SNR}) $$\n$$ \\mathrm{SNR}_{\\mathrm{dB}} = 10 \\log_{10}(25165824) $$\n计算对数值：\n$$ \\log_{10}(25165824) \\approx 7.40082046 $$\n现在，我们计算以分贝为单位的 SNR：\n$$ \\mathrm{SNR}_{\\mathrm{dB}} \\approx 10 \\times 7.40082046 \\approx 74.0082046\\,\\mathrm{dB} $$\n问题要求将最终答案四舍五入到四位有效数字。\n$$ \\mathrm{SNR}_{\\mathrm{dB}} \\approx 74.01\\,\\mathrm{dB} $$",
            "answer": "$$\n\\boxed{74.01}\n$$"
        },
        {
            "introduction": "信号数字化后，下一步通常是分析其频率成分。直接对整个数据集进行傅里叶变换往往不是最佳选择，因为它得到的谱估计可能带有很大的方差。本练习 () 将深入探讨韦尔奇方法（Welch's method），这是一种通过分段、加窗和平均来显著改善功率谱密度（PSD）估计质量的强大技术。您将亲手推导其在方差和分辨率之间的权衡关系，从而深刻理解谱估计的精髓。",
            "id": "4046281",
            "problem": "来自托卡马克 Mirnov 线圈的环向磁涨落信号 $x(t)$ 经过一个模拟低通抗混叠滤波器进行预滤波，其单边带宽为 $W = 2.0 \\times 10^{5}\\,\\mathrm{Hz}$，并以 $f_{s} = 2.0 \\times 10^{6}\\,\\mathrm{s^{-1}}$ 的速率进行均匀采样，得到 $N_{\\mathrm{tot}} = 1.31072 \\times 10^{5}$ 个样本。您的任务是使用 Welch 平均周期图法估计 $f_{0} = 5.0 \\times 10^{4}\\,\\mathrm{Hz}$ 附近的功率谱密度 (PSD)，其中使用长度为 $L=4096$ 的 Hann 数据窗，重叠率为 $50\\,\\%$，跳跃步长为 $H = L/2$。假设该过程是宽平稳、遍历的，并且在 $f_{0}$ 附近的一个窄带上可以建模为具有局部平坦功率谱密度的零均值高斯过程。\n\n从周期图、加窗分段、二阶平稳性以及高斯随机过程在线性时不变操作下的性质等基本定义出发，完成以下任务：\n\n1. 从概念上解释 Welch 法估计的是什么，并从频谱泄漏控制和方差减小的角度解释为什么使用加窗和重叠。\n2. 从平均周期图是 $K$ 个重叠加窗分段周期图的均值这一-定义出发，推导 Welch PSD 估计量在 $f_0$ 处的方差表达式，该方差用 $f_0$ 处真实 PSD 的平方进行归一化，并用分段数 $K$ 和重叠分段周期图之间的归一化协方差来表示。将您的推导应用于 $50\\,\\%$ 重叠和 Hann 窗的情况，并说明归一化协方差如何简化为相邻移位窗的归一化内积的平方。使用由 $L \\gg 1$ 证明为合理的大 $L$ 渐近法，为 Hann 窗和 $50\\,\\%$ 重叠情况显式计算此归一化内积。\n3. 使用以上结果，为指定的设置获得等效独立平均次数 $K_{\\mathrm{eff}}$ 的闭式表达式，该表达式应是分段数 $K$ 和您计算出的相邻分段协方差的函数。\n4. 通过计算 Hann 窗及其平方的大 $L$ 求和，使用等效噪声带宽 (ENBW) 来量化由 Hann 窗引起的频谱分辨率损失。该损失以离散频率单元为单位，并相对于矩形窗进行比较。\n5. 设 Welch 分段数为 $K = \\left\\lfloor \\dfrac{N_{\\mathrm{tot}} - L}{H} \\right\\rfloor + 1$，其中 $H = L/2$。定义标量品质因数\n$$\n\\eta \\equiv \\frac{K_{\\mathrm{eff}}}{\\beta_{\\mathrm{Hann}}},\n$$\n其中 $\\beta_{\\mathrm{Hann}}$ 是 Hann 窗的 ENBW，以离散频率单元为单位表示，并用矩形窗的 ENBW 进行归一化。根据给定的数值参数计算 $\\eta$。将 $\\eta$ 表示为一个纯数（无量纲），并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求对用于功率谱密度 (PSD) 估计的 Welch 法进行分析，包括概念解释、方差性质的推导，以及针对计算聚变科学中一个特定信号处理场景的性能品质因数的计算。\n\n### 问题验证\n**步骤 1：提取已知条件**\n- 信号：来自 Mirnov 线圈的环向磁涨落信号 $x(t)$。\n- 模拟预滤波：单边带宽 $W = 2.0 \\times 10^{5}\\,\\mathrm{Hz}$。\n- 采样率：$f_{s} = 2.0 \\times 10^{6}\\,\\mathrm{s^{-1}}$。\n- 总样本数：$N_{\\mathrm{tot}} = 1.31072 \\times 10^{5}$。\n- 目标频率：在 $f_{0} = 5.0 \\times 10^{4}\\,\\mathrm{Hz}$ 附近进行估计。\n- 估计方法：Welch 平均周期图法。\n- 窗函数：长度为 $L = 4096$ 的 Hann 数据窗。\n- 重叠率：$50\\,\\%$，跳跃步长 $H = L/2$。\n- 过程假设：宽平稳 (WSS)、遍历、零均值高斯过程，在 $f_0$ 附近具有局部平坦的 PSD。\n- 分段数定义：$K = \\left\\lfloor \\dfrac{N_{\\mathrm{tot}} - L}{H} \\right\\rfloor + 1$。\n- 品质因数定义：$\\eta \\equiv \\frac{K_{\\mathrm{eff}}}{\\beta_{\\mathrm{Hann}}}$，其中 $K_{\\mathrm{eff}}$ 是等效独立平均次数，$\\beta_{\\mathrm{Hann}}$ 是相对于矩形窗 ENBW 归一化的 Hann 窗 ENBW。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地建立在数字信号处理和谱分析的既定原则之上。Welch 法是一种标准且鲁棒的技术。将其应用于托卡马克的 Mirnov 线圈数据是等离子体物理诊断中的一个现实场景。\n- **适定性：** 所有必要的参数（$W$, $f_s$, $N_{tot}$, $L$, 重叠率）和过程假设（WSS，高斯）均已提供。问题结构逻辑清晰，从基本概念逐步深入到最终的数值计算。问题是自洽的，没有矛盾。采样率 $f_s = 2.0 \\times 10^6\\,\\mathrm{Hz}$ 满足预滤波信号带宽 $W = 2.0 \\times 10^5\\,\\mathrm{Hz}$ 的奈奎斯特准则 ($f_s > 2W$）。\n- **客观性：** 问题以精确、定量和无偏见的语言陈述。\n\n**步骤 3：结论与行动**\n问题有效。我们继续进行解答。\n\n### 详细解答\n\n**1. Welch 法的概念解释**\n\nWelch 法提供了一个对随机过程功率谱密度 (PSD) $S_{xx}(f)$ 的估计。PSD 量化了信号功率随频率的分布。该方法包括三个关键步骤：\n1.  将长度为 $N_{\\mathrm{tot}}$ 的总数据记录分成 $K$ 个长度为 $L$ 的较小分段。\n2.  每个分段都乘以一个窗函数 $w(n)$，以创建一个加窗分段。然后为每个加窗分段计算一个周期图（PSD 的一个估计）。\n3.  最终的 PSD 估计 $\\hat{S}_{xx}(f)$ 是通过对 $K$ 个单独的周期图进行平均得到的。\n\n**加窗**用于控制**频谱泄漏**。用于计算周期图的离散傅里叶变换 (DFT) 内在地将有限的数据段视为一个无限重复信号的周期。这种隐式的周期性会在分段边界处引入剧烈的不连续性，这会将信号的真实频谱与隐式矩形窗的傅里叶变换（一个 sinc 函数）进行卷积。sinc 函数的大旁瓣会导致强频率分量的功率“泄漏”到并掩盖邻近的弱频率分量。像 Hann 窗这样的锥形窗函数可以在分段的端点处将信号幅度平滑地减小到零。Hann 窗的傅里叶变换具有比矩形窗低得多的旁瓣，从而大大减少了频谱泄漏。其代价是主瓣更宽，这意味着频率分辨率更低。\n\n**重叠**用于减小最终 PSD 估计的**方差**。当应用锥形窗时，每个分段末端附近的数据会被降权或被有效丢弃。通过重叠连续的分段（例如，重叠 $50\\%$），在一个分段末端被衰减的数据会在下一个分段的中心被完全加权。这种做法可以恢复在非重叠方案中会丢失的信息。虽然重叠会在相邻分段的周期图之间引入相关性，但对于固定的总数据长度，对更多数量的这些相关估计进行平均，仍然比对较少数量的、来自非重叠分段的独立估计进行平均，能带来更大的方差减小。\n\n**2. 归一化方差的推导**\n\n设 Welch PSD 估计为 $\\hat{S}_{xx}(f) = \\frac{1}{K} \\sum_{k=1}^K I_k(f)$，其中 $I_k(f)$ 是第 $k$ 个加窗分段的周期图。该估计量的方差为：\n$$ \\mathrm{Var}[\\hat{S}_{xx}(f)] = \\mathrm{Var}\\left[\\frac{1}{K} \\sum_{k=1}^K I_k(f)\\right] = \\frac{1}{K^2} \\sum_{k=1}^K \\sum_{l=1}^K \\mathrm{Cov}[I_k(f), I_l(f)] $$\n对于一个零均值、宽平稳 (WSS) 且具有局部平坦谱 $S_{xx}(f)$ 的高斯过程，单个周期图的方差（在非直流或奈奎斯特频率处）为 $\\mathrm{Var}[I_k(f)] \\approx S_{xx}^2(f)$。相隔 $m=|k-l|$ 个跳跃步长的分段周期图之间的协方差为 $\\mathrm{Cov}[I_k(f), I_l(f)] \\approx S_{xx}^2(f) |\\rho(m)|^2$，其中 $\\rho(m)$ 是窗函数的归一化自相关：\n$$ \\rho(m) = \\frac{\\sum_{n=0}^{L-1} w(n) w(n-mH)}{\\sum_{n=0}^{L-1} w(n)^2} $$\n由于协方差仅取决于间隔 $m$，我们可以重写方差和：\n$$ \\mathrm{Var}[\\hat{S}_{xx}(f)] \\approx \\frac{S_{xx}^2(f)}{K^2} \\left[ K|\\rho(0)|^2 + 2\\sum_{m=1}^{K-1} (K-m) |\\rho(m)|^2 \\right] $$\n根据定义，$\\rho(0)=1$。对于 $50\\%$ 的重叠，跳跃步长为 $H=L/2$。对于 $m=2$ 个跳跃步长的分段间隔，位移为 $mH=L$。对于长度为 $L$ 的窗，函数 $w(n)$ 和 $w(n-L)$ 不重叠，因此它们的乘积为零。因此，对于所有 $m \\geq 2$，$\\rho(m)=0$。方差表达式简化为只涉及相邻分段（$m=1$）的项。\n设 $c$ 为相邻移位窗的归一化内积的平方，即相邻周期图之间的归一化协方差：$c = |\\rho(1)|^2$。方差为：\n$$ \\mathrm{Var}[\\hat{S}_{xx}(f)] \\approx \\frac{S_{xx}^2(f)}{K^2} \\left[ K + 2(K-1)c \\right] $$\n因此，归一化方差为：\n$$ \\frac{\\mathrm{Var}[\\hat{S}_{xx}(f)]}{S_{xx}^2(f)} \\approx \\frac{1}{K} + \\frac{2(K-1)}{K^2}c $$\n我们现在为 Hann 窗 $w(n) = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2\\pi n}{L}\\right)\\right)$ 和 $H=L/2$ 计算 $c$。使用大 $L$ 渐近法，对于整数 $L$，求和可以通过窗的 DFT 周期版本的已知精确结果来近似。\n窗的平方和为：\n$$ \\sum_{n=0}^{L-1} w^2(n) = \\sum_{n=0}^{L-1} \\frac{1}{4}\\left(1 - \\cos\\left(\\frac{2\\pi n}{L}\\right)\\right)^2 = \\frac{1}{4}\\sum_{n=0}^{L-1}\\left(1-2\\cos\\left(\\frac{2\\pi n}{L}\\right)+\\frac{1}{2}\\left(1+\\cos\\left(\\frac{4\\pi n}{L}\\right)\\right)\\right) $$\n由于对于非 $L$ 倍数的整数 $k$，$\\sum_{n=0}^{L-1} \\cos(2\\pi kn/L)=0$，该式简化为 $\\sum w^2(n) = \\frac{1}{4} \\sum \\frac{3}{2} = \\frac{3L}{8}$。\n相邻窗的内积仅在重叠区域（对于 $n=L/2, \\dots, L-1$）非零：\n$$ \\sum_{n=L/2}^{L-1} w(n)w(n-L/2) = \\sum_{n=L/2}^{L-1} \\frac{1}{2}\\left(1-\\cos\\frac{2\\pi n}{L}\\right) \\frac{1}{2}\\left(1+\\cos\\frac{2\\pi n}{L}\\right) = \\sum_{n=L/2}^{L-1} \\frac{1}{4}\\sin^2\\frac{2\\pi n}{L} $$\n这等于 $\\sum_{n=L/2}^{L-1} \\frac{1}{8}\\left(1-\\cos\\frac{4\\pi n}{L}\\right) = \\frac{1}{8}\\left(\\frac{L}{2} - \\sum_{n=L/2}^{L-1}\\cos\\frac{4\\pi n}{L}\\right)$。余弦项的和为零，得到 $\\frac{L}{16}$。\n所以，$\\rho(1) = \\frac{L/16}{3L/8} = \\frac{1}{6}$。归一化协方差为 $c = |\\rho(1)|^2 = \\left(\\frac{1}{6}\\right)^2 = \\frac{1}{36}$。\n\n**3. 等效独立平均次数 $K_{\\mathrm{eff}}$**\n\n一个基于 $K_{\\mathrm{eff}}$ 次独立平均的理想估计量的方差应为 $S_{xx}^2(f)/K_{\\mathrm{eff}}$。将其与推导出的 Welch 估计量的方差相等：\n$$ \\frac{S_{xx}^2(f)}{K_{\\mathrm{eff}}} = \\frac{S_{xx}^2(f)}{K^2} \\left[ K + 2(K-1)c \\right] $$\n求解 $K_{\\mathrm{eff}}$ 可得：\n$$ K_{\\mathrm{eff}} = \\frac{K^2}{K + 2(K-1)c} = \\frac{K}{1 + 2\\left(1-\\frac{1}{K}\\right)c} $$\n这就是等效独立平均次数的表达式，它是一个关于总分段数 $K$ 和相邻分段协方差 $c$ 的函数。\n\n**4. 频谱分辨率损失和等效噪声带宽 (ENBW)**\n\n加窗引起的分辨率损失由等效噪声带宽 (ENBW) 来量化，ENBW 衡量了窗的频谱主瓣的宽度。对于一个离散窗，ENBW 以频率单元（$\\Delta f = f_s/L$）为单位，由下式给出：\n$$ \\beta = L \\frac{\\sum_{n=0}^{L-1} w^2(n)}{\\left(\\sum_{n=0}^{L-1} w(n)\\right)^2} $$\n对于矩形窗 $w_R(n)=1$，$\\sum w_R^2 = L$ 且 $\\sum w_R=L$，因此 $\\beta_R = L(L/L^2) = 1$ 个频率单元。\n对于 Hann 窗，我们有 $\\sum w^2(n) = 3L/8$。窗系数的和为 $\\sum w(n) = \\sum \\frac{1}{2}(1 - \\cos(2\\pi n/L)) = \\frac{L}{2}$。\nHann 窗的 ENBW，用矩形窗的 ENBW 进行归一化后，为：\n$$ \\beta_{\\mathrm{Hann}} = L \\frac{3L/8}{(L/2)^2} = L \\frac{3L/8}{L^2/4} = \\frac{12L^2}{8L^2} = \\frac{3}{2} = 1.5 $$\n这意味着与未加窗（或矩形窗）的分析相比，Hann 窗使频率分辨率降低了 1.5 倍。\n\n**5. 品质因数 $\\eta$ 的计算**\n\n首先，我们使用给定的参数计算分段数 $K$：$N_{\\mathrm{tot}} = 131072$，$L = 4096$，以及 $H = L/2 = 2048$。\n$$ K = \\left\\lfloor \\frac{N_{\\mathrm{tot}} - L}{H} \\right\\rfloor + 1 = \\left\\lfloor \\frac{131072 - 4096}{2048} \\right\\rfloor + 1 = \\left\\lfloor \\frac{126976}{2048} \\right\\rfloor + 1 = \\lfloor 62 \\rfloor + 1 = 63 $$\n接下来，我们使用 $K=63$ 和 $c=1/36$ 计算等效平均次数 $K_{\\mathrm{eff}}$：\n$$ K_{\\mathrm{eff}} = \\frac{K}{1 + 2\\left(1-\\frac{1}{K}\\right)c} = \\frac{63}{1 + 2\\left(1-\\frac{1}{63}\\right)\\frac{1}{36}} = \\frac{63}{1 + 2\\left(\\frac{62}{63}\\right)\\frac{1}{36}} = \\frac{63}{1 + \\frac{62}{1134}} $$\n$$ K_{\\mathrm{eff}} = \\frac{63}{\\frac{1134+62}{1134}} = \\frac{63 \\times 1134}{1196} = \\frac{71442}{1196} \\approx 59.7341137 $$\n最后，我们计算品质因数 $\\eta = K_{\\mathrm{eff}} / \\beta_{\\mathrm{Hann}}$：\n$$ \\eta = \\frac{59.7341137}{1.5} \\approx 39.8227425 $$\n四舍五入到四位有效数字，我们得到 $\\eta = 39.82$。",
            "answer": "$$\\boxed{39.82}$$"
        },
        {
            "introduction": "在实际测量中，我们关心的信号常常混杂在各种噪声和干扰之中。数字滤波器是分离特定频带信号、提取有用信息的关键工具。本练习 () 将带您挑战一个真实的工程问题：设计一个高性能的数字带通滤波器，以研究托卡马克等离子体中的特定波动模式。您将综合运用频率预畸变、原型滤波器变换等高级技术，来满足严格的设计指标，体验从理论到实践的完整设计流程。",
            "id": "4046301",
            "problem": "托卡马克上的米尔诺夫线圈阵列测量磁涨落以诊断剪切阿尔芬波活动。数据由模数转换器 (ADC) 以采样频率 $f_{s} = 2.0 \\times 10^{6}\\ \\mathrm{Hz}$ 进行采样，随后的频谱分析旨在分离出 $80\\ \\mathrm{kHz}$ 至 $120\\ \\mathrm{kHz}$ 之间的阿尔芬波段。为了抑制此频段外的磁流体动力学 (MHD) 活动，并控制下游处理中的频谱泄漏和混叠，您的任务是设计一个因果、稳定的数字带通滤波器，该滤波器通过双线性变换从模拟低通原型导出。\n\n设计要求如下：\n- 通带边缘频率为 $f_{p1} = 80\\ \\mathrm{kHz}$ 和 $f_{p2} = 120\\ \\mathrm{kHz}$，最大通带纹波为 $R_{p} = 0.2\\ \\mathrm{dB}$。\n- 阻带边缘频率为 $f_{s1} = 60\\ \\mathrm{kHz}$（低于通带）和 $f_{s2} = 140\\ \\mathrm{kHz}$（高于通带），最小阻带衰减为 $R_{s} = 60\\ \\mathrm{dB}$。\n- 使用频率双线性预畸，以解释双线性变换中固有的频率映射关系。\n- 使用切比雪夫I型近似来设计模拟低通原型，并使用标准的带通到低通频率变换来评估最坏情况下的阻带间隔。\n\n从采样定理、双线性变换定义和切比雪夫I型幅度特性出发，推导最终的数字带通无限脉冲响应 (IIR) 滤波器的最小阶数。您的推导必须明确执行频率预畸和带通到低通的映射，以获得低通原型的阶数，然后考虑由带通变换引起的阶数倍增。请将最终答案以数字带通滤波器的最小整数阶数形式给出。无需按有效数字进行四舍五入；报告精确的整数。",
            "solution": "目标是确定一个数字带通滤波器的最小整数阶数，该滤波器基于切比雪夫I型模拟低通原型，并使用带频率预畸的双线性变换进行设计。推导过程主要分为四个步骤：\n1. 将数字频率指标预畸到模拟域。\n2. 将模拟带通指标转换为等效的模拟低通原型指标。\n3. 计算所需的模拟低通原型的阶数。\n4. 确定最终数字带通滤波器的阶数。\n\n首先，我们整理给定的设计指标：\n- 采样频率：$f_s = 2.0 \\times 10^6\\ \\mathrm{Hz}$。采样周期为 $T_s = 1/f_s = 0.5 \\times 10^{-6}\\ \\mathrm{s}$。\n- 通带边缘：$f_{p1} = 80\\ \\mathrm{kHz} = 80 \\times 10^3\\ \\mathrm{Hz}$，$f_{p2} = 120\\ \\mathrm{kHz} = 120 \\times 10^3\\ \\mathrm{Hz}$。\n- 阻带边缘：$f_{s1} = 60\\ \\mathrm{kHz} = 60 \\times 10^3\\ \\mathrm{Hz}$，$f_{s2} = 140\\ \\mathrm{kHz} = 140 \\times 10^3\\ \\mathrm{Hz}$。\n- 最大通带纹波：$R_p = 0.2\\ \\mathrm{dB}$。\n- 最小阻带衰减：$R_s = 60\\ \\mathrm{dB}$。\n\n**步骤 1：频率预畸**\n双线性变换通过映射 $s = \\frac{2}{T_s} \\frac{1-z^{-1}}{1+z^{-1}}$ 将数字频率 $\\omega \\in [-\\pi, \\pi]$ 与模拟频率 $\\Omega$ 关联起来。对于正弦稳态，其中 $s=j\\Omega$ 且 $z=e^{j\\omega}$，这意味着 $\\Omega = \\frac{2}{T_s} \\tan(\\frac{\\omega}{2})$。由于数字频率通过 $\\omega = 2\\pi f / f_s$ 与连续时间频率 $f$ 相关，我们可以将关键数字频率（$f_{p1}$、$f_{p2}$、$f_{s1}$、$f_{s2}$）预畸为其对应的模拟频率：\n$$ \\Omega = \\frac{2}{T_s} \\tan\\left(\\frac{2\\pi f}{2 f_s}\\right) = \\frac{2}{T_s} \\tan\\left(\\frac{\\pi f}{f_s}\\right) $$\n当 $T_s = 0.5 \\times 10^{-6}\\ \\mathrm{s}$ 时，预畸因子为 $\\frac{2}{T_s} = 4.0 \\times 10^6\\ \\mathrm{s}^{-1}$。预畸后的模拟频率为：\n- $\\Omega_{p1} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 80 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.04\\pi)\\ \\mathrm{rad/s}$\n- $\\Omega_{p2} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 120 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.06\\pi)\\ \\mathrm{rad/s}$\n- $\\Omega_{s1} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 60 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.03\\pi)\\ \\mathrm{rad/s}$\n- $\\Omega_{s2} = (4.0 \\times 10^6) \\tan\\left(\\frac{\\pi \\times 140 \\times 10^3}{2.0 \\times 10^6}\\right) = (4.0 \\times 10^6) \\tan(0.07\\pi)\\ \\mathrm{rad/s}$\n\n**步骤 2：模拟带通到低通的变换**\n模拟带通滤波器的指标必须转换为归一化低通原型的指标。标准频率映射由 $\\Omega_{LP} = \\frac{\\Omega_{BP}^2 - \\Omega_0^2}{B \\Omega_{BP}}$ 给出，其中 $\\Omega_0 = \\sqrt{\\Omega_{p1}\\Omega_{p2}}$ 是几何中心频率，$B = \\Omega_{p2} - \\Omega_{p1}$ 是模拟带通滤波器的通带带宽。\n此变换将带通滤波器的通带 $[\\Omega_{p1}, \\Omega_{p2}]$ 映射到低通原型的通带 $[-1, 1]$。因此，低通原型的通带边缘频率为 $\\Omega_{LP,p} = 1\\ \\mathrm{rad/s}$。\n\n我们必须确定低通原型对应的阻带频率 $\\Omega_{LP,s}$。两个带通阻带边缘频率 $\\Omega_{s1}$ 和 $\\Omega_{s2}$ 映射到低通域中的两个频率：\n$$ \\Omega_1 = \\frac{\\Omega_{s1}^2 - \\Omega_0^2}{B \\Omega_{s1}} = \\frac{\\Omega_{s1}^2 - \\Omega_{p1}\\Omega_{p2}}{(\\Omega_{p2}-\\Omega_{p1})\\Omega_{s1}} $$\n$$ \\Omega_2 = \\frac{\\Omega_{s2}^2 - \\Omega_0^2}{B \\Omega_{s2}} = \\frac{\\Omega_{s2}^2 - \\Omega_{p1}\\Omega_{p2}}{(\\Omega_{p2}-\\Omega_{p1})\\Omega_{s2}} $$\n低通原型必须对所有频率 $|\\Omega| \\ge \\Omega_{LP,s}$ 满足阻带衰减要求。更严格的约束对应于最窄的过渡带，即其幅度最接近通带边缘幅度 $1$ 的阻带频率。这由 $\\Omega_{LP,s} = \\min(|\\Omega_1|, |\\Omega_2|)$ 给出。\n代入预畸频率的表达式（公共因子 $4.0 \\times 10^6$ 会被约掉）：\n$$ \\Omega_1 = \\frac{\\tan^2(0.03\\pi) - \\tan(0.04\\pi)\\tan(0.06\\pi)}{[\\tan(0.06\\pi) - \\tan(0.04\\pi)]\\tan(0.03\\pi)} \\approx \\frac{(0.094914)^2 - (0.126868)(0.190983)}{[0.190983 - 0.126868](0.094914)} \\approx -2.5025 $$\n$$ \\Omega_2 = \\frac{\\tan^2(0.07\\pi) - \\tan(0.04\\pi)\\tan(0.06\\pi)}{[\\tan(0.06\\pi) - \\tan(0.04\\pi)]\\tan(0.07\\pi)} \\approx \\frac{(0.223866)^2 - (0.126868)(0.190983)}{[0.190983 - 0.126868](0.223866)} \\approx 1.8039 $$\n低通原型的临界阻带频率为 $\\Omega_{LP,s} = \\min(|-2.5025|, 1.8039) = 1.8039\\ \\mathrm{rad/s}$。\n\n**步骤 3：切比雪夫低通原型阶数计算**\n对于切比雪夫I型滤波器，所需的阶数 $N_{LP}$ 由以下公式给出：\n$$ N_{LP} \\ge \\frac{\\arccosh\\left(\\frac{\\sqrt{A^2-1}}{\\epsilon}\\right)}{\\arccosh\\left(\\frac{\\Omega_{LP,s}}{\\Omega_{LP,p}}\\right)} $$\n参数 $\\epsilon$ 与通带纹波 $R_p = 0.2\\ \\mathrm{dB}$ 相关：\n$$ \\epsilon = \\sqrt{10^{R_p/10} - 1} = \\sqrt{10^{0.2/10} - 1} = \\sqrt{10^{0.02} - 1} \\approx 0.21709 $$\n参数 $A$ 与阻带衰减 $R_s = 60\\ \\mathrm{dB}$ 相关：\n$$ A = 10^{R_s/20} = 10^{60/20} = 10^3 = 1000 $$\n现在，我们可以计算阶数公式的分子和分母。\n分子 $\\arccosh$ 函数的参数为：\n$$ \\frac{\\sqrt{A^2-1}}{\\epsilon} = \\frac{\\sqrt{1000^2 - 1}}{\\sqrt{10^{0.02} - 1}} \\approx \\frac{999.9995}{0.21709} \\approx 4606.32 $$\n分母 $\\arccosh$ 函数的参数是选择性系数：\n$$ \\frac{\\Omega_{LP,s}}{\\Omega_{LP,p}} = \\frac{1.8039}{1} = 1.8039 $$\n使用恒等式 $\\arccosh(x) = \\ln(x + \\sqrt{x^2 - 1})$:\n$$ N_{LP} \\ge \\frac{\\arccosh(4606.32)}{\\arccosh(1.8039)} = \\frac{\\ln(4606.32 + \\sqrt{4606.32^2 - 1})}{\\ln(1.8039 + \\sqrt{1.8039^2 - 1})} \\approx \\frac{\\ln(9212.64)}{1.1955} \\approx \\frac{9.1283}{1.1955} \\approx 7.6358 $$\n由于滤波器阶数必须是整数，我们必须对此值取上整：\n$$ N_{LP} = \\lceil 7.6358 \\rceil = 8 $$\n\n**步骤 4：最终数字带通滤波器阶数**\n从阶数为 $N_{LP}$ 的低通原型滤波器到带通滤波器的变换是通过替换 $s \\rightarrow \\frac{s^2+\\Omega_0^2}{Bs}$ 实现的。此替换将低通传递函数的每个极点和零点替换为一对极点和零点，从而有效地使滤波器阶数加倍。因此，模拟带通滤波器的阶数为：\n$$ N_{BP} = 2 \\times N_{LP} = 2 \\times 8 = 16 $$\n双线性变换将 $s$ 域中阶数为 $N$ 的有理传递函数映射到 $z$ 域中阶数相同的有理传递函数。因此，最终的数字带通滤波器的阶数与中间的模拟带通滤波器的阶数相同。\n$$ N_{digital} = N_{BP} = 16 $$\n推导完成。满足指标的数字带通滤波器的最小整数阶数为 16。",
            "answer": "$$\\boxed{16}$$"
        }
    ]
}