{
    "hands_on_practices": [
        {
            "introduction": "在求解大型线性系统时，迭代法通常不会得到精确解，而是提供一个近似解。那么我们如何衡量这个近似解的“好坏”呢？后向误差分析提供了一个强有力的视角：它不直接比较近似解与精确解的距离，而是反问，我们的近似解是哪个“邻近”问题的精确解。这个练习 () 将引导你从第一性原理出发，推导并计算这个最小的扰动，从而深入理解为何最小化残差是迭代方法的核心目标。",
            "id": "4000459",
            "problem": "对托卡马克边界区进行磁流体力学（MHD）平衡计算，在线性化的 Grad–Shafranov 算子进行空间离散化后，会得到一个非对称线性系统 $A x = b$。该系统使用广义最小残差法（GMRES）求解，并采用一个选择为不完全 LU 分解（ILU）的右预条件子 $M$。在 GMRES 的第 $k$ 次迭代中，算法产生了一个近似解 $x_{k}$ 和一个残差 $r_{k} = b - A x_{k}$。在后向误差分析中，计算出的 $x_{k}$ 被解释为一个邻近问题的精确解，通常是通过将算子扰动为 $(A + \\Delta A) x_{k} = b$ 来实现。\n\n请在右预条件Krylov子空间方法的背景下，从残差 $r_{k}$、向量 2-范数和矩阵 2-范数的定义出发，解释线性系统的后向误差概念。然后，从第一性原理出发，不使用现成公式，计算满足 $(A + \\Delta A) x_{k} = b$ 的最小扰动 $\\Delta A$（相对于矩阵 2-范数），并使用以下数据：\n- 迭代解 $x_{k} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 3 \\end{pmatrix}$，\n- 残差 $r_{k} = \\begin{pmatrix} 1 \\\\ -2 \\\\ 0 \\end{pmatrix}$，\n- 算子 $A = \\begin{pmatrix} 10  -2  0 \\\\ -2  5  1 \\\\ 0  1  3 \\end{pmatrix}$，以及由 $b = A x_{k} + r_{k}$ 一致定义的右端项 $b$。\n\n请以闭合形式提供显式矩阵 $\\Delta A$，使得 $(A + \\Delta A) x_{k} = b$ 成立。无需四舍五入。请将最终答案表示为单个显式矩阵。",
            "solution": "问题要求在右预条件Krylov子空间方法的背景下解释后向误差，并为给定的线性系统计算最小扰动矩阵 $\\Delta A$。\n\n首先，我们讨论线性系统近似解的后向误差概念。设线性系统为\n$$A x = b$$\n其中 $A$ 是一个 $n \\times n$ 矩阵， $x$ 和 $b$ 是 $n$ 维列向量。像广义最小残差法（GMRES）这样的迭代方法会生成一系列近似解 $\\{x_k\\}$。对于一个给定的近似解 $x_k$，其对应的残差定义为\n$$r_k = b - A x_k$$\n如果 $x_k$ 是精确解，则 $r_k = 0$。否则，$r_k$ 是一个非零向量，用于衡量 $x_k$ 对该方程的满足程度。\n\n后向误差分析将非精确解 $x_k$ 不视为真解 $x$ 的近似，而是看作某个扰动问题的精确解。我们寻求对矩阵 $A$ 的一个扰动 $\\Delta A$，使得 $x_k$ 是新系统的精确解：\n$$(A + \\Delta A) x_k = b$$\n展开此方程得到 $A x_k + \\Delta A x_k = b$。整理并使用残差的定义，我们得到扰动矩阵 $\\Delta A$ 必须满足的基本条件：\n$$\\Delta A x_k = b - A x_k = r_k$$\n这是一个关于矩阵 $\\Delta A$ 中元素的线性方程组。通常情况下，当 $n > 1$ 时，该系统是欠定的，存在无数个矩阵 $\\Delta A$ 满足此条件。为了得到唯一且有意义的答案，我们寻求“最小”的 $\\Delta A$。矩阵的大小使用矩阵范数来衡量。问题指定了矩阵 2-范数，也称为谱范数，其定义为：\n$$\\|\\Delta A\\|_2 = \\sup_{z \\neq 0} \\frac{\\|\\Delta A z\\|_2}{\\|z\\|_2}$$\n其中分数中的 $\\| \\cdot \\|_2$ 表示欧几里得向量 2-范数。因此，问题就是找到矩阵 $\\Delta A$ 来解决以下最小化问题：\n$$\\min_{\\Delta A} \\|\\Delta A\\|_2 \\quad \\text{满足} \\quad \\Delta A x_k = r_k$$\n\n右预条件GMRES的背景说明了近似解 $x_k$ 是如何生成的。原始系统 $Ax=b$ 通过引入预条件子 $M$ 被转换为一个等价系统。对于右预条件，我们求解\n$$(A M^{-1}) y = b$$\n然后通过 $x = M^{-1} y$ 恢复解 $x$。GMRES 应用于此预条件系统时，会在某个Krylov子空间上找到一个近似解 $y_k$，该解使得残差的 2-范数 $\\|b - (AM^{-1})y_k\\|_2$ 最小。原始问题对应的近似解是 $x_k = M^{-1} y_k$。在这次迭代中，原始系统的残差是 $r_k = b - A x_k = b - A(M^{-1} y_k) = b - (AM^{-1})y_k$。这恰好是GMRES算法所最小化的残差向量的范数。因此，右预条件GMRES旨在生成具有小残差 $\\|r_k\\|_2$ 的迭代解 $x_k$，正如我们将看到的，这对应于小的后向误差。\n\n现在，我们来推导最小扰动 $\\Delta A$ 的公式。对于任何满足条件 $\\Delta A x_k = r_k$ 的矩阵 $\\Delta A$，其 2-范数必须满足以下不等式：\n$$\\|\\Delta A\\|_2 = \\sup_{z \\neq 0} \\frac{\\|\\Delta A z\\|_2}{\\|z\\|_2} \\ge \\frac{\\|\\Delta A x_k\\|_2}{\\|x_k\\|_2} = \\frac{\\|r_k\\|_2}{\\|x_k\\|_2}$$\n这为任何有效扰动的 2-范数建立了一个下界。一个最小扰动就是其范数等于这个下界的扰动。\n\n让我们构造一个达到此界的矩阵 $\\Delta A$。考虑由 $r_k$ 和 $x_k$ 的外积构成的秩一矩阵：\n$$\\Delta A = \\frac{r_k x_k^T}{x_k^T x_k}$$\n注意 $x_k^T x_k = \\|x_k\\|_2^2$。首先，我们验证该矩阵满足约束条件：\n$$\\Delta A x_k = \\left(\\frac{r_k x_k^T}{\\|x_k\\|_2^2}\\right) x_k = \\frac{r_k (x_k^T x_k)}{\\|x_k\\|_2^2} = r_k$$\n该条件得到满足。接下来，我们计算其 2-范数。对于形如 $u v^T$ 的秩一矩阵，其 2-范数是 $\\|u v^T\\|_2 = \\|u\\|_2 \\|v\\|_2$。对于我们提出的 $\\Delta A$，我们可以确定 $u=r_k$ 和 $v = \\frac{x_k}{\\|x_k\\|_2^2}$。其范数为：\n$$\\|\\Delta A\\|_2 = \\left\\|r_k \\left(\\frac{x_k^T}{\\|x_k\\|_2^2}\\right)\\right\\|_2 = \\|r_k\\|_2 \\left\\|\\frac{x_k}{\\|x_k\\|_2^2}\\right\\|_2 = \\|r_k\\|_2 \\frac{\\|x_k\\|_2}{\\|x_k\\|_2^2} = \\frac{\\|r_k\\|_2}{\\|x_k\\|_2}$$\n由于这个特定矩阵 $\\Delta A$ 的范数等于推导出的下界，它确实是该最小化问题的解。它是关于矩阵 2-范数的最小扰动。\n\n我们现在将此公式应用于问题中给出的数据。\n给定的向量是：\n$$x_{k} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 3 \\end{pmatrix}, \\quad r_{k} = \\begin{pmatrix} 1 \\\\ -2 \\\\ 0 \\end{pmatrix}$$\n首先，我们计算 $x_k$ 的 2-范数的平方：\n$$\\|x_k\\|_2^2 = x_k^T x_k = (2)^2 + (-1)^2 + (3)^2 = 4 + 1 + 9 = 14$$\n接下来，我们计算外积 $r_k x_k^T$：\n$$r_k x_k^T = \\begin{pmatrix} 1 \\\\ -2 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 2  -1  3 \\end{pmatrix} = \\begin{pmatrix} (1)(2)  (1)(-1)  (1)(3) \\\\ (-2)(2)  (-2)(-1)  (-2)(3) \\\\ (0)(2)  (0)(-1)  (0)(3) \\end{pmatrix} = \\begin{pmatrix} 2  -1  3 \\\\ -4  2  -6 \\\\ 0  0  0 \\end{pmatrix}$$\n最小扰动矩阵 $\\Delta A$ 是此外积除以 $\\|x_k\\|_2^2$：\n$$\\Delta A = \\frac{r_k x_k^T}{\\|x_k\\|_2^2} = \\frac{1}{14} \\begin{pmatrix} 2  -1  3 \\\\ -4  2  -6 \\\\ 0  0  0 \\end{pmatrix}$$\n最后，我们将标量因子分配进去，写出显式矩阵：\n$$\\Delta A = \\begin{pmatrix} \\frac{2}{14}  -\\frac{1}{14}  \\frac{3}{14} \\\\ -\\frac{4}{14}  \\frac{2}{14}  -\\frac{6}{14} \\\\ \\frac{0}{14}  \\frac{0}{14}  \\frac{0}{14} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{7}  -\\frac{1}{14}  \\frac{3}{14} \\\\ -\\frac{2}{7}  \\frac{1}{7}  -\\frac{3}{7} \\\\ 0  0  0 \\end{pmatrix}$$\n这就是所求的、满足 $(A+\\Delta A)x_k=b$ 的最小扰动矩阵 $\\Delta A$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{7}  -\\frac{1}{14}  \\frac{3}{14} \\\\ -\\frac{2}{7}  \\frac{1}{7}  -\\frac{3}{7} \\\\ 0  0  0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "广义最小残差方法 (GMRES) 是求解大型非对称线性系统的强大工具，但其内存需求随迭代步数线性增长，对于大规模问题构成了严峻挑战。带重启的 GMRES($m$) 算法通过限制子空间维度来控制内存使用，但这引入了一个关键的权衡：重启参数 $m$ 的选择。这个练习 () 模拟了一个在计算聚变科学中常见的场景，要求你在理论收敛界和硬件内存限制之间做出抉择，以确定最优的重启参数，这是高性能科学计算中的一项核心实践技能。",
            "id": "4000471",
            "problem": "用于托卡马克边缘模拟的电阻磁流体动力学（MHD）隐式时间推进，在每个牛顿步中，都会产生一个大型非对称线性系统 $A x = b$。我们应用了一个基于不完全LU分解（ILU）的右预处理算子 $M^{-1}$，因此克雷洛夫方法处理的是算子 $AM^{-1}$。使用了带重启的广义最小残差（GMRES）方法，记为 GMRES($m$)。经过预处理的算子 $AM^{-1}$ 是可对角化的，其真实谱通过基于物理的预处理被紧密地聚集在一起：所有特征值都位于实数区间 $[\\alpha, \\beta]$ 内，其中 $\\alpha = 0.85$ 且 $\\beta = 1.15$。假设使用双精度实数算术。\n\n该离散系统有 $n = 2.0 \\times 10^{7}$ 个未知数。节点的总内存为 $64$ 吉比字节（GiB）。其中，$20$ GiB 用于存储预条件子 $M$，$8$ GiB 用于存储稀疏矩阵 $A$，$4$ GiB 为操作系统和其他非迭代开销保留。剩余内存可用于 GMRES($m$) 的工作空间。GMRES($m$) 的实现以双精度存储 $(m+1)$ 个长度为 $n$ 的 Arnoldi 基向量，两个用于预处理和残差更新的长度为 $n$ 的额外工作向量，以及一个大小为 $(m+1) \\times m$ 的上 Hessenberg 矩阵。\n\n您必须选择重启长度 $m$，以在单个重启周期内达到 $10^{-8}$ 的目标相对残差缩减，同时要遵守内存约束。请使用以下基本事实：\n\n- $m$ 步后的 GMRES($m$) 残差可以用一个在 $AM^{-1}$ 的谱上求值的 $m$ 次多项式 $p$（其中 $p(0) = 1$）来界定，即 $\\|r_{m}\\| \\leq \\min_{p \\in \\mathcal{P}_{m},\\, p(0) = 1} \\max_{\\lambda \\in \\Lambda(AM^{-1})} |p(\\lambda)| \\, \\|r_{0}\\|$。\n- 对于包含在不含 $0$ 的区间 $[\\alpha, \\beta]$ 内的实数谱，最小化多项式通过将第一类切比雪夫多项式 $T_{m}$ 从 $[-1,1]$ 映射到 $[\\alpha, \\beta]$ 来获得，从而得出界 $\\max_{\\lambda \\in [\\alpha,\\beta]} |p(\\lambda)| \\leq \\left| T_{m}\\!\\left(\\frac{-c}{d}\\right) \\right|^{-1}$，其中 $c = (\\alpha + \\beta)/2$ 且 $d = (\\beta - \\alpha)/2$。\n- 对于 $|x| \\geq 1$，$T_{m}(x) = \\cosh\\!\\left(m \\, \\operatorname{arccosh}(x)\\right)$ 且 $\\operatorname{arccosh}(x) = \\ln\\!\\big(x + \\sqrt{x^{2} - 1}\\big)$。\n\n假设初始残差已归一化，因此当在一个重启周期内 $\\max_{\\lambda \\in [\\alpha,\\beta]} |p(\\lambda)| \\leq 10^{-8}$ 时，即可达到目标缩减因子。计算最佳整数重启长度 $m$，该长度在一个周期内达到目标且不超过可用内存。最终答案必须是 $m$ 的整数值。不要四舍五入；请提供满足约束的精确整数。",
            "solution": "该问题要求为 GMRES($m$) 算法确定最佳整数重启长度，记为 $m$。$m$ 的值必须满足两个约束：一个收敛准则和一个内存容量限制。最佳值是满足收敛准则同时遵守内存约束的最小整数 $m$，因为这可以最小化重启周期的计算工作量和存储需求。\n\n首先，我们分析收敛约束。问题指出，预处理算子 $AM^{-1}$ 的实谱完全包含在区间 $[\\alpha, \\beta]$ 内，其中 $\\alpha = 0.85$ 且 $\\beta = 1.15$。目标是在 $m$ 步的单个重启周期内实现 $10^{-8}$ 的相对残差缩减。这被表述为对收敛因子的条件：\n$$\n\\max_{\\lambda \\in [\\alpha,\\beta]} |p(\\lambda)| \\leq 10^{-8}\n$$\n其中 $p(\\lambda)$ 是 $m$ 次多项式且 $p(0)=1$。问题为此情况提供了标准界限，其中涉及第一类切比雪夫多项式 $T_m$。残差缩减因子的界限由下式给出：\n$$\n\\rho_m = \\left| T_{m}\\!\\left(\\frac{-c}{d}\\right) \\right|^{-1}\n$$\n其中 $c = (\\alpha + \\beta)/2$ 且 $d = (\\beta - \\alpha)/2$。我们需要找到使 $\\rho_m \\le 10^{-8}$ 成立的最小整数 $m$。\n\n我们来计算 $c$ 和 $d$：\n$$\nc = \\frac{0.85 + 1.15}{2} = \\frac{2.0}{2} = 1.0\n$$\n$$\nd = \\frac{1.15 - 0.85}{2} = \\frac{0.30}{2} = 0.15\n$$\n切比雪夫多项式的自变量是 $\\frac{-c}{d} = \\frac{-1.0}{0.15} = -\\frac{20}{3}$。\n条件 $\\rho_m \\le 10^{-8}$ 变为：\n$$\n\\left| T_{m}\\!\\left(-\\frac{20}{3}\\right) \\right|^{-1} \\le 10^{-8} \\implies \\left| T_{m}\\!\\left(-\\frac{20}{3}\\right) \\right| \\ge 10^{8}\n$$\n因为 $T_m(-x) = (-1)^m T_m(x)$，所以我们有 $|T_m(-x)| = |T_m(x)|$。该不等式等价于：\n$$\nT_{m}\\!\\left(\\frac{20}{3}\\right) \\ge 10^{8}\n$$\n自变量 $x_0 = 20/3$ 大于 $1$，所以我们可以使用恒等式 $T_m(x) = \\cosh(m \\cdot \\operatorname{arccosh}(x))$：\n$$\n\\cosh\\left(m \\cdot \\operatorname{arccosh}\\left(\\frac{20}{3}\\right)\\right) \\ge 10^{8}\n$$\n对不等式两边应用反双曲余弦函数 $\\operatorname{arccosh}$（该函数在自变量 $\\ge 1$ 时单调递增），我们得到：\n$$\nm \\cdot \\operatorname{arccosh}\\left(\\frac{20}{3}\\right) \\ge \\operatorname{arccosh}(10^8)\n$$\n求解 $m$：\n$$\nm \\ge \\frac{\\operatorname{arccosh}(10^8)}{\\operatorname{arccosh}(20/3)}\n$$\n我们使用对数公式 $\\operatorname{arccosh}(x) = \\ln(x + \\sqrt{x^2-1})$ 来计算各项：\n$$\n\\operatorname{arccosh}\\left(\\frac{20}{3}\\right) = \\ln\\left(\\frac{20}{3} + \\sqrt{\\left(\\frac{20}{3}\\right)^2 - 1}\\right) = \\ln\\left(\\frac{20}{3} + \\sqrt{\\frac{400}{9} - \\frac{9}{9}}\\right) = \\ln\\left(\\frac{20 + \\sqrt{391}}{3}\\right)\n$$\n$$\n\\operatorname{arccosh}(10^8) = \\ln(10^8 + \\sqrt{(10^8)^2 - 1}) = \\ln(10^8 + \\sqrt{10^{16}-1})\n$$\n数值上，$\\operatorname{arccosh}(10^8) \\approx 19.1138$ 且 $\\operatorname{arccosh}(20/3) \\approx 2.5846$。\n$$\nm \\ge \\frac{19.1138...}{2.5846...} \\approx 7.3953...\n$$\n由于 $m$ 必须是整数，满足收敛准则的最小值为 $m_{conv} = 8$。\n\n接下来，我们分析内存约束。\n节点总内存为 $64$ 吉比字节（GiB），其中 $1\\,\\mathrm{GiB} = 2^{30}$ 字节。\n总内存 $= 64 \\times 2^{30}$ 字节。\n用于 $M$ 的内存为 $20$ GiB，用于 $A$ 的内存为 $8$ GiB，用于操作系统的内存为 $4$ GiB。\n固定的总内存使用量 $= (20 + 8 + 4)\\,\\mathrm{GiB} = 32\\,\\mathrm{GiB}$。\n可用于 GMRES($m$) 工作空间的内存 $= (64 - 32)\\,\\mathrm{GiB} = 32\\,\\mathrm{GiB} = 32 \\times 2^{30}$ 字节。\n\nGMRES($m$) 工作空间的内存用于：\n\\begin{enumerate}\n    \\item $(m+1)$ 个长度为 $n$ 的 Arnoldi 基向量。\n    \\item $2$ 个长度为 $n$ 的额外工作向量。\n    \\item $1$ 个大小为 $(m+1) \\times m$ 的上 Hessenberg 矩阵。\n\\end{enumerate}\n所有数据均为双精度，每个数字使用 $8$ 字节。系统大小为 $n = 2.0 \\times 10^7$。\n向量总数为 $(m+1) + 2 = m+3$。\n向量所需内存 $= (m+3) \\times n \\times 8$ 字节。\nHessenberg 矩阵所需内存 $= (m+1) \\times m \\times 8$ 字节。\n工作空间总内存 $= \\left[ (m+3)n + m(m+1) \\right] \\times 8$ 字节。\n这必须小于或等于可用内存：\n$$\n8 \\left[ (m+3)n + m(m+1) \\right] \\le 32 \\times 2^{30}\n$$\n$$\n(m+3)n + m(m+1) \\le 4 \\times 2^{30} = 4,294,967,296\n$$\n代入 $n = 2 \\times 10^7$：\n$$\n(m+3)(2 \\times 10^7) + m^2 + m \\le 4,294,967,296\n$$\n$$\nm^2 + (20,000,001) m + 60,000,000 \\le 4,294,967,296\n$$\n$$\nm^2 + 20,000,001 m - 4,234,967,296 \\le 0\n$$\n与 $m$ 的线性项相比，$m^2$ 项可以忽略不计。我们可以通过忽略二次项来近似 $m$ 的最大值：\n$$\nm \\approx \\frac{4,234,967,296}{20,000,001} \\approx 211.75\n$$\n这表明 $m$ 的最大整数值为 $211$。我们通过在不等式中测试 $m=211$ 和 $m=212$ 来验证这一点。\n对于 $m=211$：\n$$\n(211+3)(2 \\times 10^7) + 211(211+1) = 214 \\times (2 \\times 10^7) + 44732 = 4,280,000,000 + 44,732 = 4,280,044,732\n$$\n由于 $4,280,044,732 \\le 4,294,967,296$， $m=211$ 是一个有效的选择。\n对于 $m=212$：\n$$\n(212+3)(2 \\times 10^7) + 212(212+1) = 215 \\times (2 \\times 10^7) + 45396 = 4,300,000,000 + 45,396 = 4,300,045,396\n$$\n由于 $4,300,045,396 > 4,294,967,296$，$m=212$ 不是一个有效的选择。\n因此，内存约束允许的最大重启长度为 $m_{mem} = 211$。\n\n最后，我们必须选择最佳的 $m$。收敛要求 $m \\ge 8$，而内存允许 $m \\le 211$。在 $[8, 211]$ 范围内的任何整数 $m$ 都是一个有效的选择。“最佳”选择是计算成本最小的那个。每个重启周期的工作量，特别是正交化成本，随 $m$ 的增加而增加（实际上是平方级增加）。因此，保证收敛的最小 $m$ 值是最高效的选择。最佳重启长度是 $m = m_{conv} = 8$。这个值满足内存约束，因为 $8 \\le 211$。",
            "answer": "$$\\boxed{8}$$"
        },
        {
            "introduction": "许多复杂的物理问题，如不可压缩磁流体动力学，在离散化后会产生具有特定块结构（例如鞍点问题）的线性系统。对于这类系统，通用的“黑箱”预条件子（如不完全 LU 分解）往往效果不佳。更有效的方法是设计一个能反映系统物理耦合特性的“基于物理的”块预条件子。这个练习 () 将带你亲手构建一个针对鞍点问题的块三角预条件子，通过识别舒尔补并利用物理洞察（时间尺度分析）来近似它，最终掌握一种在现代计算科学中至关重要的高级预条件策略。",
            "id": "4000472",
            "problem": "在不可压缩电阻磁流体力学 (MHD) 中，考虑一个在大小为 $\\Delta t$ 的时间步长上，具有恒定密度 $\\rho$ 和运动粘度 $\\nu$ 的线性化半隐式时间离散。强制施加不可压缩性条件的离散速度-压力子问题呈现为带有 $2\\times 2$ 分块算子的鞍点形式\n$$\n\\mathcal{K} \\equiv \\begin{pmatrix} A  B^{\\top} \\\\ B  -C \\end{pmatrix},\n$$\n其中 $A$ 表示离散动量块，$B$ 是离散散度算子，$C$ 是由稳定化或耦合效应产生的对称半正定贡献项。对于强施加不可压缩性条件极限下的不可压缩电阻磁流体力学，就本问题而言，可以取 $C = 0$。\n\n从分块算子 $\\mathcal{K}$ 出发：\n1) 推导 $\\mathcal{K}$ 的精确分块分解，并用 $A$、$B$ 和 $C$ 来确定其精确舒尔补。\n2) 在阿尔文 (Alfvénic) 尺度下，当时间步相对于粘性扩散时间尺度很小时，利用电阻磁流体力学时间步进的物理合理渐近性质，提出用于构建分块下三角预条件子的近似 $\\widehat{A}$ 和 $\\widehat{S}$。仅使用半隐式离散化中的项主导性和算子缩放等基本建模考量来证明这些近似的合理性。\n\n接下来，考虑一个周期性域上波数大小为 $k$ 的单一均匀傅里叶模式。在此逐模式分析中，取算子的符号如下：将 $A$ 替换为标量\n$$\na \\equiv \\frac{\\rho}{\\Delta t} + \\nu k^{2},\n$$\n将 $B$ 和 $B^{\\top}$ 替换为实标量\n$$\nb \\equiv k,\n$$\n并设置 $C=0$。采用质量主导的近似\n$$\n\\widehat{A} \\equiv a_{m} \\equiv \\frac{\\rho}{\\Delta t}, \\qquad \\widehat{S} \\equiv \\frac{b^{2}}{a_{m}}.\n$$\n构建分块下三角预条件子\n$$\n\\widehat{\\mathcal{M}} \\equiv \\begin{pmatrix} \\widehat{A}  0 \\\\ B  -\\widehat{S} \\end{pmatrix},\n$$\n并为上述单模式标量简化情况下的预处理算子 $\\widehat{\\mathcal{M}}^{-1} \\mathcal{K}$ 推导谱半径的闭式表达式。\n\n最后，对参数值 $\\rho = 1$, $\\nu = 1$, $\\Delta t = 1$ 和 $k = 1$ 计算你的表达式。将最终的谱半径表示为单一的精确解析表达式。不要包含单位，也不要四舍五入。最终答案必须是单一表达式。",
            "solution": "首先，我们推导算子 $\\mathcal{K}$ 的精确分块分解并确定舒尔补。给定的算子是\n$$\n\\mathcal{K} \\equiv \\begin{pmatrix} A  B^{\\top} \\\\ B  -C \\end{pmatrix}\n$$\n假设分块 $A$ 可逆，我们可以执行分块高斯消元。我们寻求一个 $\\mathcal{K} = L U$ 形式的分解，其中 $L$ 是一个对角线上为单位块的分块下三角矩阵，$U$ 是一个分块上三角矩阵。\n$$\n\\mathcal{K} = \\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  B^{\\top} \\\\ 0  S \\end{pmatrix}\n$$\n将右侧的因子相乘得到\n$$\n\\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  B^{\\top} \\\\ 0  S \\end{pmatrix} = \\begin{pmatrix} A  B^{\\top} \\\\ (B A^{-1})A  (B A^{-1})B^{\\top} + S \\end{pmatrix} = \\begin{pmatrix} A  B^{\\top} \\\\ B  B A^{-1} B^{\\top} + S \\end{pmatrix}\n$$\n将此结果与原始算子 $\\mathcal{K}$ 比较，我们必须有 $-C = B A^{-1} B^{\\top} + S$。\n这就导出了 $\\mathcal{K}$ 中 $A$ 的精确舒尔补的表达式：\n$$\nS = -C - B A^{-1} B^{\\top}\n$$\n对于 $C=0$ 的特殊情况，舒尔补简化为 $S = -B A^{-1} B^{\\top}$。\n\n其次，我们为近似 $\\widehat{A}$ 和 $\\widehat{S}$ 提供物理上的合理解释。离散动量块 $A$ 代表算子 $\\frac{\\rho}{\\Delta t}I - \\nu \\nabla^2$（以及其他未指明的可能项）。对于波数为 $k$ 的模式，其在傅里叶空间中的符号是 $a = \\frac{\\rho}{\\Delta t} + \\nu k^2$。问题陈述，时间步 $\\Delta t$ 相对于粘性扩散时间尺度很小。粘性扩散时间尺度为 $\\tau_{\\nu} \\sim (\\nu k^2)^{-1}$。条件 $\\Delta t \\ll \\tau_{\\nu}$ 意味着 $\\Delta t \\ll (\\nu k^2)^{-1}$，可以改写为 $\\nu k^2 \\Delta t \\ll 1$。\n在符号 $a$ 中，粘性项与惯性项的量级之比为：\n$$\n\\frac{\\nu k^2}{\\rho / \\Delta t} = \\frac{\\nu k^2 \\Delta t}{\\rho}\n$$\n鉴于 $\\nu k^2 \\Delta t \\ll 1$ 且在典型的无量纲化中 $\\rho$ 的量级为1，该比值远小于1。因此，惯性项占主导地位：$\\frac{\\rho}{\\Delta t} \\gg \\nu k^2$。这证明了用算子 $A$ 的质量主导部分来近似它是合理的：\n$$\nA \\approx \\widehat{A} \\equiv \\frac{\\rho}{\\Delta t} I\n$$\n理想预条件子的右下块 $-\\widehat{S}$ 应当近似于真实的舒尔补 $S = -B A^{-1} B^{\\top}$（因为 $C=0$）。这意味着 $\\widehat{S}$ 应当近似于 $-S = B A^{-1} B^{\\top}$。一个常用且有效的策略是将 $A$ 的近似代入此表达式中，从而构成近似舒尔补：\n$$\n\\widehat{S} \\approx B \\widehat{A}^{-1} B^{\\top} = B \\left(\\frac{\\rho}{\\Delta t} I\\right)^{-1} B^{\\top} = \\frac{\\Delta t}{\\rho} B B^{\\top}\n$$\n这与问题中提供的标量定义 $\\widehat{S} \\equiv b^2/a_m$ 完全对应，因为对于标量情况，$b^2/a_m = k^2 / (\\rho/\\Delta t) = \\frac{k^2 \\Delta t}{\\rho}$。\n\n第三，我们推导标量情况下预处理算子 $\\widehat{\\mathcal{M}}^{-1}\\mathcal{K}$ 的谱半径。\n算子变为标量或标量条目的 $2 \\times 2$ 矩阵：\n$$\n\\mathcal{K} = \\begin{pmatrix} a  b \\\\ b  0 \\end{pmatrix}, \\quad \\text{其中 } a = \\frac{\\rho}{\\Delta t} + \\nu k^{2} \\text{ 且 } b = k.\n$$\n预条件子为：\n$$\n\\widehat{\\mathcal{M}} = \\begin{pmatrix} \\widehat{a}  0 \\\\ b  -\\widehat{s} \\end{pmatrix}, \\quad \\text{其中 } \\widehat{a} = \\frac{\\rho}{\\Delta t} \\text{ 且 } \\widehat{s} = \\frac{b^2}{\\widehat{a}} = \\frac{k^2 \\Delta t}{\\rho}.\n$$\n预处理算子 $\\widehat{\\mathcal{M}}^{-1}\\mathcal{K}$ 的特征值 $\\lambda$ 通过求解广义特征值问题 $\\mathcal{K}v = \\lambda \\widehat{\\mathcal{M}}v$ 得到，这等价于求 $\\det(\\mathcal{K} - \\lambda \\widehat{\\mathcal{M}}) = 0$ 的根。\n$$\n\\mathcal{K} - \\lambda \\widehat{\\mathcal{M}} = \\begin{pmatrix} a  b \\\\ b  0 \\end{pmatrix} - \\lambda \\begin{pmatrix} \\widehat{a}  0 \\\\ b  -\\widehat{s} \\end{pmatrix} = \\begin{pmatrix} a - \\lambda\\widehat{a}  b \\\\ b - \\lambda b  \\lambda\\widehat{s} \\end{pmatrix} = \\begin{pmatrix} a - \\lambda\\widehat{a}  b \\\\ b(1-\\lambda)  \\lambda\\widehat{s} \\end{pmatrix}\n$$\n行列式为：\n$$\n\\det(\\mathcal{K} - \\lambda \\widehat{\\mathcal{M}}) = (a - \\lambda\\widehat{a})(\\lambda\\widehat{s}) - b(b(1-\\lambda)) = a\\lambda\\widehat{s} - \\lambda^2\\widehat{a}\\widehat{s} - b^2 + \\lambda b^2 = 0\n$$\n将其重新排列成关于 $\\lambda$ 的二次方程：\n$$\n(\\widehat{a}\\widehat{s})\\lambda^2 - (a\\widehat{s} + b^2)\\lambda + b^2 = 0\n$$\n我们使用它们的定义来计算系数：\n- $\\lambda^2$ 的系数：$\\widehat{a}\\widehat{s} = \\left(\\frac{\\rho}{\\Delta t}\\right) \\left(\\frac{k^2 \\Delta t}{\\rho}\\right) = k^2$。\n- $\\lambda$ 的系数：$-(a\\widehat{s} + b^2) = -\\left(\\left(\\frac{\\rho}{\\Delta t} + \\nu k^2\\right)\\left(\\frac{k^2 \\Delta t}{\\rho}\\right) + k^2\\right) = -\\left(\\frac{\\rho k^2\\Delta t}{\\Delta t \\rho} + \\frac{\\nu k^4 \\Delta t}{\\rho} + k^2\\right) = -\\left(k^2 + \\frac{\\nu k^4 \\Delta t}{\\rho} + k^2\\right) = -\\left(2k^2 + \\frac{\\nu k^4 \\Delta t}{\\rho}\\right)$。\n- 常数项：$b^2 = k^2$。\n\n特征方程变为：\n$$\nk^2 \\lambda^2 - \\left(2k^2 + \\frac{\\nu k^4 \\Delta t}{\\rho}\\right)\\lambda + k^2 = 0\n$$\n假设 $k \\neq 0$，我们可以两边同除以 $k^2$：\n$$\n\\lambda^2 - \\left(2 + \\frac{\\nu k^2 \\Delta t}{\\rho}\\right)\\lambda + 1 = 0\n$$\n令无量纲参数 $x = \\frac{\\nu k^2 \\Delta t}{\\rho}$。方程为 $\\lambda^2 - (2+x)\\lambda + 1 = 0$。使用二次求根公式，特征值为：\n$$\n\\lambda = \\frac{(2+x) \\pm \\sqrt{(2+x)^2 - 4}}{2} = \\frac{(2+x) \\pm \\sqrt{4+4x+x^2 - 4}}{2} = \\frac{(2+x) \\pm \\sqrt{x(4+x)}}{2}\n$$\n由于所有参数 $\\rho, \\nu, \\Delta t, k^2$ 均为非负，所以 $x \\ge 0$。这确保了特征值为实数且为正。谱半径是特征值绝对值的最大值，即两个根中较大的那个：\n$$\n\\rho(\\widehat{\\mathcal{M}}^{-1}\\mathcal{K}) = \\lambda_{\\max} = \\frac{1}{2} \\left(2 + \\frac{\\nu k^2 \\Delta t}{\\rho} + \\sqrt{\\frac{\\nu k^2 \\Delta t}{\\rho} \\left(4 + \\frac{\\nu k^2 \\Delta t}{\\rho}\\right)}\\right)\n$$\n最后，我们用给定的参数 $\\rho = 1$, $\\nu = 1$, $\\Delta t = 1$ 和 $k = 1$ 计算此表达式。\n参数 $x$ 为：\n$$\nx = \\frac{\\nu k^2 \\Delta t}{\\rho} = \\frac{(1)(1)^2(1)}{1} = 1\n$$\n将 $x=1$ 代入谱半径的表达式中：\n$$\n\\rho(\\widehat{\\mathcal{M}}^{-1}\\mathcal{K}) = \\frac{(2+1) + \\sqrt{1(4+1)}}{2} = \\frac{3 + \\sqrt{5}}{2}\n$$\n这是谱半径的最终精确解析表达式。",
            "answer": "$$\n\\boxed{\\frac{3 + \\sqrt{5}}{2}}\n$$"
        }
    ]
}