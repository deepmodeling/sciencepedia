{
    "hands_on_practices": [
        {
            "introduction": "当我们使用像GMRES这样的Krylov子空间方法求解线性系统时，我们通常在达到某个收敛标准时提前终止迭代，得到一个近似解。后向误差分析为我们提供了一个强有力的视角来评估这个解的质量：它不再关注近似解与真实解的距离，而是去寻找一个对原始问题矩阵$A$的最小扰动$\\Delta A$，使得我们的近似解$x_k$成为这个“被扰动”了的新问题$(A + \\Delta A)x_k = b$的精确解。这项实践 () 将引导您从第一性原理出发，推导并计算这个最小扰动，从而让您对迭代解的可靠性有一个具体而深刻的量化理解。",
            "id": "4000459",
            "problem": "对托卡马克边缘区域进行磁流体动力学 (MHD) 平衡计算，在对线性化的 Grad–Shafranov 算子进行空间离散化后，会得到一个非对称线性系统 $A x = b$。该系统使用广义最小残差法 (GMRES) 求解，其中右预条件子 $M$ 选择为不完全 LU 分解 (ILU)。在 GMRES 的第 $k$ 次迭代中，算法产生了一个近似解 $x_{k}$ 和一个残差 $r_{k} = b - A x_{k}$。在后向误差分析中，计算出的 $x_{k}$ 被解释为一个邻近问题的精确解，这通常通过将算子扰动为 $(A + \\Delta A) x_{k} = b$ 来实现。\n\n请在这种右预处理的克雷洛夫子空间法的背景下，从残差 $r_{k}$、向量 2-范数和矩阵 2-范数的定义出发，解释线性系统的后向误差概念。然后，从第一性原理出发，不使用现成公式，计算满足 $(A + \\Delta A) x_{k} = b$ 的最小扰动 $\\Delta A$（关于矩阵 2-范数），并使用以下数据：\n- 迭代解 $x_{k} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 3 \\end{pmatrix}$，\n- 残差 $r_{k} = \\begin{pmatrix} 1 \\\\ -2 \\\\ 0 \\end{pmatrix}$，\n- 算子 $A = \\begin{pmatrix} 10  -2  0 \\\\ -2  5  1 \\\\ 0  1  3 \\end{pmatrix}$，以及由 $b = A x_{k} + r_{k}$ 一致性定义的右端项 $b$。\n\n提供显式矩阵 $\\Delta A$ 的封闭形式，以使 $(A + \\Delta A) x_{k} = b$ 成立。无需四舍五入。将你的最终答案表示为单个显式矩阵。",
            "solution": "该问题要求在右预处理的克雷洛夫子空间法的背景下解释后向误差，并为一个给定的线性系统计算最小扰动矩阵 $\\Delta A$。\n\n首先，我们讨论线性系统近似解的后向误差概念。设线性系统为\n$$A x = b$$\n其中 $A$ 是一个 $n \\times n$ 矩阵，$x$ 和 $b$ 是 $n$ 维列向量。像广义最小残差法 (GMRES) 这样的迭代方法会生成一系列近似解 $\\{x_k\\}$。对于一个给定的近似解 $x_k$，其对应的残差定义为\n$$r_k = b - A x_k$$\n如果 $x_k$ 是精确解，则 $r_k = 0$。否则，$r_k$ 是一个非零向量，用于衡量 $x_k$ 对该方程的满足程度。\n\n后向误差分析将非精确解 $x_k$ 不视为真解 $x$ 的一个近似，而是视为一个扰动问题的精确解。我们寻求对矩阵 $A$ 的一个扰动 $\\Delta A$，使得 $x_k$ 是新系统的精确解：\n$$(A + \\Delta A) x_k = b$$\n展开此方程得到 $A x_k + \\Delta A x_k = b$。重新整理并使用残差的定义，我们得到扰动矩阵 $\\Delta A$ 必须满足的基本条件：\n$$\\Delta A x_k = b - A x_k = r_k$$\n这是一个关于矩阵 $\\Delta A$ 中元素的线性方程组。通常，对于 $n > 1$，该系统是欠定的，存在无限多个矩阵 $\\Delta A$ 满足此条件。为了得到唯一且有意义的答案，我们寻求“最小”的 $\\Delta A$。矩阵的大小使用矩阵范数来衡量。问题指定了矩阵 2-范数，也称为谱范数，其定义为：\n$$\\|\\Delta A\\|_2 = \\sup_{z \\neq 0} \\frac{\\|\\Delta A z\\|_2}{\\|z\\|_2}$$\n其中分数中的 $\\| \\cdot \\|_2$ 表示欧几里得向量 2-范数。因此，问题是找到矩阵 $\\Delta A$ 来解决以下最小化问题：\n$$\\min_{\\Delta A} \\|\\Delta A\\|_2 \\quad \\text{约束条件为} \\quad \\Delta A x_k = r_k$$\n\n右预处理 GMRES 的背景说明了近似解 $x_k$ 是如何生成的。通过引入预条件子 $M$，原始系统 $Ax=b$ 被转换为一个等价系统。对于右预处理，我们求解\n$$A M^{-1} y = b$$\n然后通过 $x = M^{-1} y$ 恢复解 $x$。当 GMRES 应用于此预处理系统时，它会在某个克雷洛夫子空间上找到一个近似解 $y_k$，该解使得残差的 2-范数 $\\|b - A(M^{-1}y_k)\\|_2$ 最小。原始问题对应的近似解是 $x_k = M^{-1} y_k$。在此次迭代中，原始系统的残差为 $r_k = b - A x_k = b - A(M^{-1} y_k)$。这正是 GMRES 算法所最小化的残差向量的范数。因此，右预处理 GMRES 旨在产生具有小残差 $\\|r_k\\|_2$ 的迭代解 $x_k$，正如我们将看到的，这对应于一个小的后向误差。\n\n现在，我们推导最小扰动 $\\Delta A$ 的公式。对于任何满足条件 $\\Delta A x_k = r_k$ 的矩阵 $\\Delta A$，其 2-范数必须满足以下不等式：\n$$\\|\\Delta A\\|_2 = \\sup_{z \\neq 0} \\frac{\\|\\Delta A z\\|_2}{\\|z\\|_2} \\ge \\frac{\\|\\Delta A x_k\\|_2}{\\|x_k\\|_2} = \\frac{\\|r_k\\|_2}{\\|x_k\\|_2}$$\n这为任何有效扰动的 2-范数建立了一个下界。最小扰动是其范数等于此下界的扰动。\n\n让我们构造一个达到此下界的矩阵 $\\Delta A$。考虑由 $r_k$ 和 $x_k$ 的外积构成的秩一矩阵：\n$$\\Delta A = \\frac{r_k x_k^T}{x_k^T x_k}$$\n注意 $x_k^T x_k = \\|x_k\\|_2^2$。首先，我们验证该矩阵是否满足约束条件：\n$$\\Delta A x_k = \\left(\\frac{r_k x_k^T}{\\|x_k\\|_2^2}\\right) x_k = \\frac{r_k (x_k^T x_k)}{\\|x_k\\|_2^2} = r_k$$\n条件得到满足。接下来，我们计算其 2-范数。对于形式为 $u v^T$ 的秩一矩阵，其 2-范数为 $\\|u v^T\\|_2 = \\|u\\|_2 \\|v\\|_2$。对于我们提出的 $\\Delta A$，我们可以确定 $u=r_k$ 和 $v = \\frac{x_k}{\\|x_k\\|_2^2}$。其范数为：\n$$\\|\\Delta A\\|_2 = \\left\\|r_k \\left(\\frac{x_k^T}{\\|x_k\\|_2^2}\\right)\\right\\|_2 = \\|r_k\\|_2 \\left\\|\\frac{x_k^T}{\\|x_k\\|_2^2}\\right\\|_2 = \\|r_k\\|_2 \\frac{\\|x_k\\|_2}{\\|x_k\\|_2^2} = \\frac{\\|r_k\\|_2}{\\|x_k\\|_2}$$\n由于这个特定矩阵 $\\Delta A$ 的范数等于我们推导出的下界，因此它确实是该最小化问题的解。它是关于矩阵 2-范数的最小扰动。\n\n我们现在将此公式应用于问题中提供的数据。\n给定的向量是：\n$$x_{k} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 3 \\end{pmatrix}, \\quad r_{k} = \\begin{pmatrix} 1 \\\\ -2 \\\\ 0 \\end{pmatrix}$$\n首先，我们计算 $x_k$ 的 2-范数的平方：\n$$\\|x_k\\|_2^2 = x_k^T x_k = (2)^2 + (-1)^2 + (3)^2 = 4 + 1 + 9 = 14$$\n接下来，我们计算外积 $r_k x_k^T$：\n$$r_k x_k^T = \\begin{pmatrix} 1 \\\\ -2 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 2  -1  3 \\end{pmatrix} = \\begin{pmatrix} (1)(2)  (1)(-1)  (1)(3) \\\\ (-2)(2)  (-2)(-1)  (-2)(3) \\\\ (0)(2)  (0)(-1)  (0)(3) \\end{pmatrix} = \\begin{pmatrix} 2  -1  3 \\\\ -4  2  -6 \\\\ 0  0  0 \\end{pmatrix}$$\n最小扰动矩阵 $\\Delta A$ 是此外积除以 $\\|x_k\\|_2^2$：\n$$\\Delta A = \\frac{r_k x_k^T}{\\|x_k\\|_2^2} = \\frac{1}{14} \\begin{pmatrix} 2  -1  3 \\\\ -4  2  -6 \\\\ 0  0  0 \\end{pmatrix}$$\n最后，我们将标量因子分配进去，写出显式矩阵：\n$$\\Delta A = \\begin{pmatrix} \\frac{2}{14}  -\\frac{1}{14}  \\frac{3}{14} \\\\ -\\frac{4}{14}  \\frac{2}{14}  -\\frac{6}{14} \\\\ \\frac{0}{14}  \\frac{0}{14}  \\frac{0}{14} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{7}  -\\frac{1}{14}  \\frac{3}{14} \\\\ -\\frac{2}{7}  \\frac{1}{7}  -\\frac{3}{7} \\\\ 0  0  0 \\end{pmatrix}$$\n这就是所求的、满足 $(A+\\Delta A)x_k=b$ 的最小扰动矩阵 $\\Delta A$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{7}  -\\frac{1}{14}  \\frac{3}{14} \\\\ -\\frac{2}{7}  \\frac{1}{7}  -\\frac{3}{7} \\\\ 0  0  0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在求解计算聚变科学中的大规模问题时，理论上理想的Krylov方法往往会因内存限制而变得不切实际。重启的GMRES方法，即GMRES(m)，是应对这一挑战的关键技术，但它引入了一个核心的权衡：重启周期$m$越大，收敛可能越快，但内存消耗也越高。这项实践 () 将您置于一个真实的计算场景中，要求您在有限的内存预算下，通过分析算子的谱特性来选择一个最优的重启参数$m$，以确保算法既能有效收敛，又不会超出硬件资源的限制。",
            "id": "4000471",
            "problem": "用于托卡马克边缘模拟的电阻磁流体力学 (MHD) 隐式时间推进，在每个牛顿步中都会产生一个大型非对称线性系统 $A x = b$。我们应用了一个基于不完全LU分解 (ILU) 的右预处理算子 $M$，因此Krylov方法看到的算子是 $A M^{-1}$。我们使用带重启的广义最小残差 (GMRES) 方法，记为 $ \\mathrm{GMRES}(m) $。预处理算子 $A M^{-1}$ 是可对角化的，其谱为实谱，并且通过基于物理的预处理被紧密地聚集：所有特征值都位于实数区间 $[\\alpha, \\beta]$ 内，其中 $\\alpha = 0.85$ 且 $\\beta = 1.15$。假设使用双精度实数算术。\n\n离散系统有 $n = 2.0 \\times 10^{7}$ 个未知数。总节点内存为 $64$ 吉比字节 (GiB)。其中，$20$ GiB 用于存储预处理器 $M$，$8$ GiB 用于存储稀疏矩阵 $A$，$4$ GiB 为操作系统和其他非迭代开销保留。剩余的内存可用于 $\\mathrm{GMRES}(m)$ 的工作空间。$\\mathrm{GMRES}(m)$ 的实现以双精度存储 $(m+1)$ 个长度为 $n$ 的Arnoldi基向量，两个用于预处理和残差更新的长度为 $n$ 的额外工作向量，以及一个大小为 $(m+1) \\times m$ 的上Hessenberg矩阵。\n\n你必须选择重启长度 $m$ 以在单个重启周期内达到 $10^{-8}$ 的目标相对残差下降，同时要遵守内存约束。使用以下基本事实：\n\n- $m$ 步后的 $\\mathrm{GMRES}(m)$ 残差可以通过一个在 $A M^{-1}$ 的谱上求值的 $m$ 次多项式 $p$ (其中 $p(0) = 1$) 来界定，即 $\\|r_{m}\\|_2 \\leq \\min_{p \\in \\mathcal{P}_{m},\\, p(0) = 1} \\max_{\\lambda \\in \\Lambda(A M^{-1})} |p(\\lambda)| \\, \\|r_{0}\\|_2$。\n- 对于包含在不含0的区间 $[\\alpha, \\beta]$ 内的实谱，最小化多项式是通过将第一类切比雪夫多项式 $T_{m}$ 从 $[-1,1]$ 映射到 $[\\alpha, \\beta]$ 得到的，从而得出界 $\\max_{\\lambda \\in [\\alpha,\\beta]} |p(\\lambda)| \\leq \\left| T_{m}\\!\\left(\\frac{\\beta+\\alpha}{\\beta-\\alpha}\\right) \\right|^{-1}$。\n- 对于 $|x| \\geq 1$，$T_{m}(x) = \\cosh\\!\\left(m \\, \\operatorname{arccosh}(x)\\right)$ 且 $\\operatorname{arccosh}(x) = \\ln\\!\\big(x + \\sqrt{x^{2} - 1}\\big)$。\n\n假设初始残差已被归一化，因此当在一个重启周期内 $\\max_{\\lambda \\in [\\alpha,\\beta]} |p(\\lambda)| \\leq 10^{-8}$ 时，即可达到目标下降因子。计算最优整数重启长度 $m$，该值需在一个周期内达到目标，并且不超过可用内存。最终答案必须是 $m$ 的整数值。不要四舍五入；提供满足约束条件的精确整数。",
            "solution": "该问题要求确定 `GMRES(m)` 算法的最优整数重启长度，记为 $m$。$m$ 的值必须满足两个约束条件：收敛准则和内存容量限制。最优值是满足收敛准则同时遵守内存约束的最小整数 $m$，因为这能最小化重启周期的计算工作量和存储需求。\n\n首先，我们分析收敛约束。问题陈述，预处理算子 $A M^{-1}$ 的实谱完全包含在区间 $[\\alpha, \\beta]$ 内，其中 $\\alpha = 0.85$ 且 $\\beta = 1.15$。目标是在一个 $m$ 步的重启周期内实现 $10^{-8}$ 的相对残差下降。这可以表述为关于收敛因子的条件：\n$$\n\\max_{\\lambda \\in [\\alpha,\\beta]} |p(\\lambda)| \\leq 10^{-8}\n$$\n其中 $p(\\lambda)$ 是一个次数为 $m$ 且 $p(0)=1$ 的多项式。问题为此情况提供了标准界，它涉及第一类切比雪夫多项式 $T_m$。残差下降因子的界由以下公式给出：\n$$\n\\rho_m = \\left| T_{m}\\!\\left(\\frac{\\beta+\\alpha}{\\beta-\\alpha}\\right) \\right|^{-1}\n$$\n我们需要找到满足 $\\rho_m \\le 10^{-8}$ 的最小整数 $m$。\n\n让我们计算切比雪夫多项式的自变量：\n$$\n\\frac{\\beta+\\alpha}{\\beta-\\alpha} = \\frac{1.15 + 0.85}{1.15 - 0.85} = \\frac{2.0}{0.30} = \\frac{20}{3}\n$$\n条件 $\\rho_m \\le 10^{-8}$ 变为：\n$$\n\\left| T_{m}\\!\\left(\\frac{20}{3}\\right) \\right|^{-1} \\le 10^{-8} \\implies \\left| T_{m}\\!\\left(\\frac{20}{3}\\right) \\right| \\ge 10^{8}\n$$\n由于自变量 $x_0 = 20/3$ 大于 $1$，我们可以使用恒等式 $T_m(x) = \\cosh(m \\cdot \\operatorname{arccosh}(x))$：\n$$\n\\cosh\\left(m \\cdot \\operatorname{arccosh}\\left(\\frac{20}{3}\\right)\\right) \\ge 10^{8}\n$$\n对两边应用反双曲余弦函数 $\\operatorname{arccosh}$（该函数在自变量 $\\ge 1$ 时是单调递增的），我们得到：\n$$\nm \\cdot \\operatorname{arccosh}\\left(\\frac{20}{3}\\right) \\ge \\operatorname{arccosh}(10^8)\n$$\n解出 $m$：\n$$\nm \\ge \\frac{\\operatorname{arccosh}(10^8)}{\\operatorname{arccosh}(20/3)}\n$$\n我们使用对数公式 $\\operatorname{arccosh}(x) = \\ln(x + \\sqrt{x^2-1})$ 来计算这些项。\n对于 $x \\gg 1$，$\\operatorname{arccosh}(x) \\approx \\ln(2x)$。\n$\\operatorname{arccosh}(10^8) \\approx \\ln(2 \\cdot 10^8) \\approx 19.1138$\n$\\operatorname{arccosh}(20/3) = \\ln(20/3 + \\sqrt{(20/3)^2 - 1}) = \\ln(20/3 + \\sqrt{400/9 - 9/9}) = \\ln((20 + \\sqrt{391})/3) \\approx 2.5846$\n$$\nm \\ge \\frac{19.1138...}{2.5846...} \\approx 7.3953...\n$$\n由于 $m$ 必须是整数，满足收敛准则的最小值为 $m_{conv} = 8$。\n\n接下来，我们分析内存约束。\n总节点内存为 $64$ 吉比字节 (GiB)，其中 $1\\,\\mathrm{GiB} = 2^{30}$ 字节。\n总内存 $= 64 \\times 2^{30}$ 字节。\n用于 $M$ 的内存为 $20$ GiB，用于 $A$ 的内存为 $8$ GiB，用于操作系统的内存为 $4$ GiB。\n总固定内存使用量 $= (20 + 8 + 4)\\,\\mathrm{GiB} = 32\\,\\mathrm{GiB}$。\n可用于 $\\mathrm{GMRES}(m)$ 工作空间的内存 $= (64 - 32)\\,\\mathrm{GiB} = 32\\,\\mathrm{GiB} = 32 \\times 2^{30}$ 字节。\n\n$\\mathrm{GMRES}(m)$ 的工作空间内存用于：\n\\begin{enumerate}\n    \\item $(m+1)$ 个长度为 $n$ 的 Arnoldi 基向量。\n    \\item $2$ 个长度为 $n$ 的额外工作向量。\n    \\item $1$ 个大小为 $(m+1) \\times m$ 的上 Hessenberg 矩阵。\n\\end{enumerate}\n所有数据均为双精度，每个数字使用 $8$ 字节。系统大小为 $n = 2.0 \\times 10^7$。\n向量总数为 $(m+1) + 2 = m+3$。\n向量所需内存 $= (m+3) \\times n \\times 8$ 字节。\nHessenberg矩阵所需内存 $= (m+1) \\times m \\times 8$ 字节。\n总工作空间内存 $= \\left[ (m+3)n + m(m+1) \\right] \\times 8$ 字节。\n这必须小于或等于可用内存：\n$$\n8 \\left[ (m+3)n + m(m+1) \\right] \\le 32 \\times 2^{30}\n$$\n$$\n(m+3)n + m(m+1) \\le 4 \\times 2^{30} = 4,294,967,296\n$$\n代入 $n = 2 \\times 10^7$：\n$$\n(m+3)(2 \\times 10^7) + m^2 + m \\le 4,294,967,296\n$$\n$$\nm^2 + (20,000,001) m + 60,000,000 \\le 4,294,967,296\n$$\n$$\nm^2 + 20,000,001 m - 4,234,967,296 \\le 0\n$$\n与 $m$ 的线性项相比，$m^2$ 项可以忽略不计。我们可以通过忽略二次项来近似 $m$ 的最大值：\n$$\nm \\approx \\frac{4,234,967,296}{20,000,001} \\approx 211.75\n$$\n这表明 $m$ 的最大整数值为 $211$。我们通过在不等式中测试 $m=211$ 和 $m=212$ 来验证这一点。\n对于 $m=211$：\n$$\n(211+3)(2 \\times 10^7) + 211(211+1) = 214 \\times (2 \\times 10^7) + 44732 = 4,280,000,000 + 44,732 = 4,280,044,732\n$$\n由于 $4,280,044,732 \\le 4,294,967,296$，所以 $m=211$ 是一个有效的选择。\n对于 $m=212$：\n$$\n(212+3)(2 \\times 10^7) + 212(212+1) = 215 \\times (2 \\times 10^7) + 45396 = 4,300,000,000 + 45,396 = 4,300,045,396\n$$\n由于 $4,300,045,396 > 4,294,967,296$，所以 $m=212$ 不是一个有效的选择。\n因此，内存约束允许的最大重启长度为 $m_{mem} = 211$。\n\n最后，我们必须选择最优的 $m$。收敛要求 $m \\ge 8$，而内存允许 $m \\le 211$。在 $[8, 211]$ 范围内的任何整数 $m$ 都是一个有效的选择。“最优”选择是能最小化计算成本的选择。每个重启周期的工作量，特别是正交化成本，随 $m$ 的增加而增加（实际上是平方级增加）。因此，保证收敛的最小 $m$ 值是最有效的选择。\n最优重启长度是 $m = m_{conv} = 8$。这个值满足内存约束，因为 $8 \\le 211$。",
            "answer": "$$\\boxed{8}$$"
        },
        {
            "introduction": "聚变等离子体模拟中的许多关键模型，如不可压磁流体力学（MHD），在离散化后会产生具有鞍点结构的线性系统，这种系统通常是病态的，直接求解非常困难。高效求解这类问题的关键在于设计和构建强大的预条件子，而这往往需要深刻的物理洞察力。这项实践 () 将引导您完成一个典型的基于物理的预条件子设计过程：首先通过块高斯消元精确地推导出问题的舒尔补（Schur complement）结构，然后基于物理近似来构造一个高效且易于计算的块三角预条件子。这个过程完美体现了在计算科学中，物理直觉如何指导数值算法设计的艺术。",
            "id": "4000472",
            "problem": "在不可压缩电阻磁流体动力学（MHD）中，考虑一个线性化的、半隐式时间离散化，其时间步长为 $\\Delta t$，密度 $\\rho$ 和运动粘度 $\\nu$ 恒定。用于施加不可压缩性条件的离散速度-压力子问题，其形式为一个鞍点问题，具有一个 $2\\times 2$ 的分块算子\n$$\n\\mathcal{K} \\equiv \\begin{pmatrix} A  B^{\\top} \\\\ B  -C \\end{pmatrix},\n$$\n其中 $A$ 表示离散动量块，$B$ 是离散散度算子，$C$ 是由稳定化或耦合效应产生的对称半正定贡献。对于不可压缩电阻MHD，在强施加不可压缩性的极限情况下，为本题目的，可以取 $C = 0$。\n\n从分块算子 $\\mathcal{K}$ 出发：\n1) 推导 $\\mathcal{K}$ 的精确分块因式分解，并用 $A$、$B$ 和 $C$ 表示出精确的舒尔补。\n2) 在阿尔芬尺度下，时间步长相对于粘性扩散时间尺度很小。利用此物理上合理的电阻MHD时间步进渐近关系，提出用于构建分块下三角预条件子的近似 $\\widehat{A}$ 和 $\\widehat{S}$。仅使用半隐式离散化中项的主导性和算子尺度的基本建模考虑，来证明这些近似的合理性。\n\n接下来，考虑周期域上的单个均匀傅里叶模式，其波数大小为 $k$。在这种逐模式分析中，取算子的符号如下：将 $A$ 替换为标量\n$$\na \\equiv \\frac{\\rho}{\\Delta t} + \\nu k^{2},\n$$\n将 $B$ 和 $B^{\\top}$ 替换为实标量\n$$\nb \\equiv k,\n$$\n并设置 $C=0$。采用质量主导的近似\n$$\n\\widehat{A} \\equiv a_{m} \\equiv \\frac{\\rho}{\\Delta t}, \\qquad \\widehat{S} \\equiv \\frac{b^{2}}{a_{m}}.\n$$\n构建分块下三角预条件子\n$$\n\\widehat{\\mathcal{M}} \\equiv \\begin{pmatrix} \\widehat{A}  0 \\\\ B  -\\widehat{S} \\end{pmatrix},\n$$\n并为上述单模标量简化情况下的预处理算子 $\\widehat{\\mathcal{M}}^{-1} \\mathcal{K}$ 的谱半径推导一个闭式表达式。\n\n最后，使用参数值 $\\rho = 1$，$\\nu = 1$，$\\Delta t = 1$ 和 $k = 1$ 计算您的表达式。将最终的谱半径表示为单个精确的解析表达式。不包含单位，也不要四舍五入。最终答案必须是单个表达式。",
            "solution": "首先，我们推导算子 $\\mathcal{K}$ 的精确分块因式分解并确定舒尔补。给定的算子是\n$$\n\\mathcal{K} \\equiv \\begin{pmatrix} A  B^{\\top} \\\\ B  -C \\end{pmatrix}\n$$\n假设分块 $A$ 是可逆的，我们可以执行分块高斯消元。我们寻求 $\\mathcal{K} = L U$ 形式的因式分解，其中 $L$ 是一个对角线上为单位块的分块下三角矩阵，$U$ 是一个分块上三角矩阵。\n$$\n\\mathcal{K} = \\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  B^{\\top} \\\\ 0  S \\end{pmatrix}\n$$\n将右侧的因子相乘得到\n$$\n\\begin{pmatrix} I  0 \\\\ B A^{-1}  I \\end{pmatrix} \\begin{pmatrix} A  B^{\\top} \\\\ 0  S \\end{pmatrix} = \\begin{pmatrix} A  B^{\\top} \\\\ (B A^{-1})A  (B A^{-1})B^{\\top} + S \\end{pmatrix} = \\begin{pmatrix} A  B^{\\top} \\\\ B  B A^{-1} B^{\\top} + S \\end{pmatrix}\n$$\n将此与原始算子 $\\mathcal{K}$ 比较，我们必须有 $-C = B A^{-1} B^{\\top} + S$。\n这导出了 $\\mathcal{K}$ 中 $A$ 的精确舒尔补的表达式：\n$$\nS = -C - B A^{-1} B^{\\top}\n$$\n对于 $C=0$ 的特殊情况，舒尔补简化为 $S = -B A^{-1} B^{\\top}$。\n\n其次，我们为近似 $\\widehat{A}$ 和 $\\widehat{S}$ 提供物理上的合理解释。离散动量块 $A$ 代表算子 $\\frac{\\rho}{\\Delta t}I - \\nu \\nabla^2$（以及其他可能未指明的项）。对于波数为 $k$ 的模式，其在傅里叶空间中的符号是 $a = \\frac{\\rho}{\\Delta t} + \\nu k^2$。问题陈述时间步长 $\\Delta t$ 相对于粘性扩散时间尺度很小。粘性扩散时间尺度为 $\\tau_{\\nu} \\sim (\\nu k^2)^{-1}$。条件 $\\Delta t \\ll \\tau_{\\nu}$ 意味着 $\\Delta t \\ll (\\nu k^2)^{-1}$，可以重写为 $\\nu k^2 \\Delta t \\ll 1$。\n在符号 $a$ 中，粘性项与惯性项的量级之比为：\n$$\n\\frac{\\nu k^2}{\\rho / \\Delta t} = \\frac{\\nu k^2 \\Delta t}{\\rho}\n$$\n鉴于 $\\nu k^2 \\Delta t \\ll 1$ 并且在典型的无量纲化中 $\\rho$ 的数量级为1，这个比率远小于1。因此，惯性项占主导地位：$\\frac{\\rho}{\\Delta t} \\gg \\nu k^2$。这证明了用其质量主导部分来近似算子 $A$ 是合理的：\n$$\nA \\approx \\widehat{A} \\equiv \\frac{\\rho}{\\Delta t} I\n$$\n理想预条件子的右下块 $-\\widehat{S}$ 应近似于真实的舒尔补 $S = -B A^{-1} B^{\\top}$（因为 $C=0$）。这意味着 $\\widehat{S}$ 应近似于 $-S = B A^{-1} B^{\\top}$。一个常用且有效的策略是将 $A$ 的近似代入该表达式来形成近似舒尔补：\n$$\n\\widehat{S} \\approx B \\widehat{A}^{-1} B^{\\top} = B \\left(\\frac{\\rho}{\\Delta t} I\\right)^{-1} B^{\\top} = \\frac{\\Delta t}{\\rho} B B^{\\top}\n$$\n这与问题中提供的标量定义 $\\widehat{S} \\equiv b^2/a_m$ 完全对应，因为对于标量情况，$b^2/a_m = k^2 / (\\rho/\\Delta t) = \\frac{k^2 \\Delta t}{\\rho}$。\n\n第三，我们推导标量情况下预处理算子 $\\widehat{\\mathcal{M}}^{-1}\\mathcal{K}$ 的谱半径。\n算子变为标量或带有标量元素的 $2 \\times 2$ 矩阵：\n$$\n\\mathcal{K} = \\begin{pmatrix} a  b \\\\ b  0 \\end{pmatrix}, \\quad \\text{其中 } a = \\frac{\\rho}{\\Delta t} + \\nu k^{2} \\text{ 且 } b = k.\n$$\n预条件子是：\n$$\n\\widehat{\\mathcal{M}} = \\begin{pmatrix} \\widehat{a}  0 \\\\ b  -\\widehat{s} \\end{pmatrix}, \\quad \\text{其中 } \\widehat{a} = \\frac{\\rho}{\\Delta t} \\text{ 且 } \\widehat{s} = \\frac{b^2}{\\widehat{a}} = \\frac{k^2 \\Delta t}{\\rho}.\n$$\n预处理算子 $\\widehat{\\mathcal{M}}^{-1}\\mathcal{K}$ 的特征值 $\\lambda$ 通过求解广义特征值问题 $\\mathcal{K}v = \\lambda \\widehat{\\mathcal{M}}v$ 来找到，这等价于求解 $\\det(\\mathcal{K} - \\lambda \\widehat{\\mathcal{M}}) = 0$ 的根。\n$$\n\\mathcal{K} - \\lambda \\widehat{\\mathcal{M}} = \\begin{pmatrix} a  b \\\\ b  0 \\end{pmatrix} - \\lambda \\begin{pmatrix} \\widehat{a}  0 \\\\ b  -\\widehat{s} \\end{pmatrix} = \\begin{pmatrix} a - \\lambda\\widehat{a}  b \\\\ b - \\lambda b  \\lambda\\widehat{s} \\end{pmatrix} = \\begin{pmatrix} a - \\lambda\\widehat{a}  b \\\\ b(1-\\lambda)  \\lambda\\widehat{s} \\end{pmatrix}\n$$\n行列式是：\n$$\n\\det(\\mathcal{K} - \\lambda \\widehat{\\mathcal{M}}) = (a - \\lambda\\widehat{a})(\\lambda\\widehat{s}) - b(b(1-\\lambda)) = a\\lambda\\widehat{s} - \\lambda^2\\widehat{a}\\widehat{s} - b^2 + \\lambda b^2 = 0\n$$\n将其重新整理为关于 $\\lambda$ 的二次方程：\n$$\n(\\widehat{a}\\widehat{s})\\lambda^2 - (a\\widehat{s} + b^2)\\lambda + b^2 = 0\n$$\n我们使用它们的定义来计算系数：\n- $\\lambda^2$ 的系数： $\\widehat{a}\\widehat{s} = \\left(\\frac{\\rho}{\\Delta t}\\right) \\left(\\frac{k^2 \\Delta t}{\\rho}\\right) = k^2$。\n- $\\lambda$ 的系数： $-(a\\widehat{s} + b^2) = -\\left(\\left(\\frac{\\rho}{\\Delta t} + \\nu k^2\\right)\\left(\\frac{k^2 \\Delta t}{\\rho}\\right) + k^2\\right) = -\\left(\\frac{\\rho k^2\\Delta t}{\\Delta t \\rho} + \\frac{\\nu k^4 \\Delta t}{\\rho} + k^2\\right) = -\\left(k^2 + \\frac{\\nu k^4 \\Delta t}{\\rho} + k^2\\right) = -\\left(2k^2 + \\frac{\\nu k^4 \\Delta t}{\\rho}\\right)$。\n- 常数项： $b^2 = k^2$。\n\n特征方程变为：\n$$\nk^2 \\lambda^2 - \\left(2k^2 + \\frac{\\nu k^4 \\Delta t}{\\rho}\\right)\\lambda + k^2 = 0\n$$\n假设 $k \\neq 0$，我们可以除以 $k^2$：\n$$\n\\lambda^2 - \\left(2 + \\frac{\\nu k^2 \\Delta t}{\\rho}\\right)\\lambda + 1 = 0\n$$\n令无量纲参数 $x = \\frac{\\nu k^2 \\Delta t}{\\rho}$。方程为 $\\lambda^2 - (2+x)\\lambda + 1 = 0$。使用二次求根公式，特征值为：\n$$\n\\lambda = \\frac{(2+x) \\pm \\sqrt{(2+x)^2 - 4}}{2} = \\frac{(2+x) \\pm \\sqrt{x(4+x)}}{2}\n$$\n由于所有参数 $\\rho, \\nu, \\Delta t, k^2$ 都是非负的，所以 $x \\ge 0$。这确保了特征值是实数且为正。谱半径是特征值绝对值的最大值，也就是两个根中较大的那个：\n$$\n\\rho(\\widehat{\\mathcal{M}}^{-1}\\mathcal{K}) = \\lambda_{\\max} = \\frac{1}{2} \\left(2 + \\frac{\\nu k^2 \\Delta t}{\\rho} + \\sqrt{\\frac{\\nu k^2 \\Delta t}{\\rho} \\left(4 + \\frac{\\nu k^2 \\Delta t}{\\rho}\\right)}\\right)\n$$\n最后，我们使用给定的参数 $\\rho = 1$, $\\nu = 1$, $\\Delta t = 1$ 和 $k = 1$ 来计算此表达式。\n参数 $x$ 为：\n$$\nx = \\frac{\\nu k^2 \\Delta t}{\\rho} = \\frac{(1)(1)^2(1)}{1} = 1\n$$\n将 $x=1$ 代入谱半径的表达式：\n$$\n\\rho(\\widehat{\\mathcal{M}}^{-1}\\mathcal{K}) = \\frac{(2+1) + \\sqrt{1(4+1)}}{2} = \\frac{3 + \\sqrt{5}}{2}\n$$\n这就是谱半径的最终精确解析表达式。",
            "answer": "$$\n\\boxed{\\frac{3 + \\sqrt{5}}{2}}\n$$"
        }
    ]
}