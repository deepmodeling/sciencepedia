{
    "hands_on_practices": [
        {
            "introduction": "The Method of Manufactured Solutions (MMS) begins with a creative step: choosing a solution and then modifying the governing equation to accommodate it. This first exercise walks you through the fundamental process of deriving the necessary source term for a linear advection-diffusion equation . Mastering this core skill is essential for constructing any valid MMS test, as it allows you to create a benchmark problem with a known, analytic answer against which you can verify your code.",
            "id": "3952656",
            "problem": "In computational fusion science and engineering, code verification requires demonstrating that a numerical implementation reproduces a known exact solution of a governing model. One standard approach is the Method of Manufactured Solutions (MMS), in which one selects an analytic function and derives the source that makes this function an exact solution of the target equation. Consider the one-dimensional linear advection–diffusion partial differential equation (PDE) with constant coefficients,\n$$u_{t} + a\\,u_{x} = \\nu\\,u_{xx},$$\nposed on the spatial domain $x\\in[0,1]$ with periodic boundary conditions, where $a>0$ is the advection speed and $\\nu>0$ is the diffusion coefficient. Using the Method of Manufactured Solutions (MMS), prescribe the manufactured solution\n$$u(x,t) = \\sin(2\\pi x)\\,\\exp(-t),$$\nwhich is compatible with the periodic boundary conditions on $[0,1]$. To make this manufactured solution an exact solution for all $x\\in[0,1]$ and all $t\\ge 0$, augment the PDE with a source term as\n$$u_{t} + a\\,u_{x} = \\nu\\,u_{xx} + S(x,t).$$\nStarting only from the definitions of partial derivatives, standard trigonometric identities, and the governing PDE above, derive the closed-form analytic expression for the required source $S(x,t)$ so that the manufactured solution satisfies the augmented PDE identically in space and time. Express your final answer as a single analytic expression. No rounding is required and no units are needed.",
            "solution": "The problem as stated is valid. It is a well-posed mathematical problem based on established principles of partial differential equations and the Method of Manufactured Solutions, a standard technique for code verification in computational science. All provided information is self-consistent and sufficient to derive a unique solution.\n\nThe objective is to determine the source term, $S(x,t)$, required to make the manufactured solution, $u(x,t)$, an exact solution to the augmented one-dimensional linear advection–diffusion equation. The augmented PDE is given by:\n$$u_{t} + a\\,u_{x} = \\nu\\,u_{xx} + S(x,t)$$\nwhere $u_t = \\frac{\\partial u}{\\partial t}$, $u_x = \\frac{\\partial u}{\\partial x}$, and $u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$. The coefficients $a$ and $\\nu$ are positive constants.\n\nTo find the source term $S(x,t)$, we first rearrange the PDE to isolate $S(x,t)$:\n$$S(x,t) = u_{t} + a\\,u_{x} - \\nu\\,u_{xx}$$\n\nThe prescribed manufactured solution is:\n$$u(x,t) = \\sin(2\\pi x)\\,\\exp(-t)$$\n\nWe must now compute the necessary partial derivatives of $u(x,t)$ with respect to time $t$ and space $x$.\n\nFirst, we compute the partial derivative with respect to time, $u_t$:\n$$u_{t} = \\frac{\\partial}{\\partial t} \\left[ \\sin(2\\pi x)\\,\\exp(-t) \\right]$$\nSince $\\sin(2\\pi x)$ is independent of $t$, we treat it as a constant factor with respect to the time differentiation:\n$$u_{t} = \\sin(2\\pi x) \\cdot \\frac{d}{dt}\\left[\\exp(-t)\\right]$$\nUsing the chain rule for differentiation, where $\\frac{d}{dt}\\exp(f(t)) = \\exp(f(t)) \\cdot f'(t)$, we have:\n$$u_{t} = \\sin(2\\pi x) \\cdot \\left[ \\exp(-t) \\cdot (-1) \\right]$$\n$$u_{t} = -\\sin(2\\pi x)\\,\\exp(-t)$$\n\nNext, we compute the first partial derivative with respect to space, $u_x$:\n$$u_{x} = \\frac{\\partial}{\\partial x} \\left[ \\sin(2\\pi x)\\,\\exp(-t) \\right]$$\nHere, $\\exp(-t)$ is independent of $x$ and is treated as a constant factor:\n$$u_{x} = \\exp(-t) \\cdot \\frac{d}{dx}\\left[\\sin(2\\pi x)\\right]$$\nUsing the chain rule, where $\\frac{d}{dx}\\sin(g(x)) = \\cos(g(x)) \\cdot g'(x)$, we find:\n$$u_{x} = \\exp(-t) \\cdot \\left[ \\cos(2\\pi x) \\cdot (2\\pi) \\right]$$\n$$u_{x} = 2\\pi\\,\\cos(2\\pi x)\\,\\exp(-t)$$\n\nFinally, we compute the second partial derivative with respect to space, $u_{xx}$, by differentiating $u_x$:\n$$u_{xx} = \\frac{\\partial}{\\partial x} \\left[ u_{x} \\right] = \\frac{\\partial}{\\partial x} \\left[ 2\\pi\\,\\cos(2\\pi x)\\,\\exp(-t) \\right]$$\nAgain, the terms $2\\pi$ and $\\exp(-t)$ are constant with respect to $x$:\n$$u_{xx} = 2\\pi\\,\\exp(-t) \\cdot \\frac{d}{dx}\\left[\\cos(2\\pi x)\\right]$$\nUsing the chain rule, where $\\frac{d}{dx}\\cos(g(x)) = -\\sin(g(x)) \\cdot g'(x)$, we get:\n$$u_{xx} = 2\\pi\\,\\exp(-t) \\cdot \\left[ -\\sin(2\\pi x) \\cdot (2\\pi) \\right]$$\n$$u_{xx} = -(2\\pi)^{2}\\,\\sin(2\\pi x)\\,\\exp(-t)$$\n$$u_{xx} = -4\\pi^{2}\\,\\sin(2\\pi x)\\,\\exp(-t)$$\n\nNow we substitute these derived partial derivatives into the expression for $S(x,t)$:\n$$S(x,t) = u_{t} + a\\,u_{x} - \\nu\\,u_{xx}$$\n$$S(x,t) = \\left[ -\\sin(2\\pi x)\\,\\exp(-t) \\right] + a\\left[ 2\\pi\\,\\cos(2\\pi x)\\,\\exp(-t) \\right] - \\nu\\left[ -4\\pi^{2}\\,\\sin(2\\pi x)\\,\\exp(-t) \\right]$$\n\nTo obtain the final closed-form expression, we factor out the common term $\\exp(-t)$:\n$$S(x,t) = \\exp(-t) \\left[ -\\sin(2\\pi x) + 2a\\pi\\,\\cos(2\\pi x) + 4\\nu\\pi^{2}\\,\\sin(2\\pi x) \\right]$$\n\nFinally, we group the terms containing $\\sin(2\\pi x)$ and $\\cos(2\\pi x)$ to simplify the expression within the brackets:\n$$S(x,t) = \\exp(-t) \\left[ (4\\nu\\pi^{2} - 1)\\sin(2\\pi x) + 2a\\pi\\,\\cos(2\\pi x) \\right]$$\n\nThis is the required source term $S(x,t)$ that ensures the manufactured function $u(x,t) = \\sin(2\\pi x)\\,\\exp(-t)$ is an exact solution to the augmented advection–diffusion equation.",
            "answer": "$$\\boxed{\\exp(-t) \\left[ (4\\pi^{2}\\nu - 1)\\sin(2\\pi x) + 2a\\pi\\cos(2\\pi x) \\right]}$$"
        },
        {
            "introduction": "Real-world physical systems, particularly in fusion plasma, are governed by nonlinear equations. This practice demonstrates the power of MMS by applying it to the viscous Burgers equation, a classic model for nonlinear convection and diffusion . By working through the derivation of the source term in the presence of a nonlinear term, you will see how MMS can be used to verify codes designed for these more challenging and realistic scenarios.",
            "id": "3952620",
            "problem": "In computational fusion science and engineering, reduced one-dimensional transport models are often used to test numerical algorithms that approximate nonlinear convective and diffusive dynamics. Consider the viscous Burgers equation, a canonical nonlinear partial differential equation (PDE) representative of coupled convection and diffusion processes,\n$$u_{t} + u\\,u_{x} = \\nu\\,u_{xx},$$\nposed on the spatial domain $x \\in [0,\\pi]$ and time $t \\geq 0$, where $\\nu > 0$ is a constant kinematic viscosity. To perform code verification using the Method of Manufactured Solutions (MMS), the PDE is augmented with a source term so that a prescribed smooth function is an exact solution of the forced PDE. Specifically, consider the forced PDE\n$$u_{t} + u\\,u_{x} = \\nu\\,u_{xx} + f(x,t),$$\nand the manufactured solution\n$$u^{\\mathrm{MMS}}(x,t) = \\sin(x)\\,\\exp(t) + \\cos(2x)\\,\\exp(-t),$$\nwhich is smooth, spatially periodic over $[0,\\pi]$ in the sense of trigonometric content, and ensures that both convection and diffusion are activated in the interior.\n\nUsing only fundamental definitions from calculus and the Method of Manufactured Solutions (MMS), derive the source term $f(x,t)$ that makes $u^{\\mathrm{MMS}}(x,t)$ an exact solution of the forced PDE. Also, determine the initial condition $u(x,0)$ and the Dirichlet boundary data $u(0,t)$ and $u(\\pi,t)$ consistent with $u^{\\mathrm{MMS}}(x,t)$ on the domain. Express your final answer as a single closed-form analytic expression for $f(x,t)$. No units are required. No rounding is required.",
            "solution": "The problem is valid. It is a well-posed, scientifically grounded problem in the field of computational science, specifically concerning the Method of Manufactured Solutions (MMS) for code verification of numerical schemes for partial differential equations (PDEs). The problem requires the direct application of multivariate calculus to derive a source term and associated conditions, which is a standard and formalizable procedure. All required data and definitions are provided, and there are no contradictions or ambiguities.\n\nThe task is to find the source term $f(x,t)$ that makes the manufactured solution $u^{\\mathrm{MMS}}(x,t)$ an exact solution to the forced viscous Burgers equation. The equation for the source term is obtained by rearranging the given PDE:\n$$f(x,t) = u_{t} + u\\,u_{x} - \\nu\\,u_{xx}$$\nWe are given the manufactured solution:\n$$u(x,t) = u^{\\mathrm{MMS}}(x,t) = \\sin(x)\\,\\exp(t) + \\cos(2x)\\,\\exp(-t)$$\nTo find $f(x,t)$, we must compute the necessary partial derivatives of $u(x,t)$ and substitute them into the expression for $f(x,t)$.\n\nFirst, we compute the partial derivative with respect to time, $u_t$:\n$$u_{t} = \\frac{\\partial}{\\partial t} \\left( \\sin(x)\\,\\exp(t) + \\cos(2x)\\,\\exp(-t) \\right) = \\sin(x)\\,\\exp(t) - \\cos(2x)\\,\\exp(-t)$$\n\nNext, we compute the first partial derivative with respect to space, $u_x$:\n$$u_{x} = \\frac{\\partial}{\\partial x} \\left( \\sin(x)\\,\\exp(t) + \\cos(2x)\\,\\exp(-t) \\right) = \\cos(x)\\,\\exp(t) - 2\\sin(2x)\\,\\exp(-t)$$\n\nThen, we compute the second partial derivative with respect to space, $u_{xx}$:\n$$u_{xx} = \\frac{\\partial}{\\partial x} \\left( \\cos(x)\\,\\exp(t) - 2\\sin(2x)\\,\\exp(-t) \\right) = -\\sin(x)\\,\\exp(t) - 4\\cos(2x)\\,\\exp(-t)$$\n\nNow, we compute the nonlinear convective term $u\\,u_x$:\n$$u\\,u_{x} = \\left( \\sin(x)\\,\\exp(t) + \\cos(2x)\\,\\exp(-t) \\right) \\left( \\cos(x)\\,\\exp(t) - 2\\sin(2x)\\,\\exp(-t) \\right)$$\nExpanding this product gives four terms:\n$$u\\,u_{x} = \\sin(x)\\cos(x)\\,\\exp(2t) - 2\\sin(x)\\sin(2x) + \\cos(x)\\cos(2x) - 2\\sin(2x)\\cos(2x)\\,\\exp(-2t)$$\nWe use the trigonometric identities $\\sin(A)\\cos(A) = \\frac{1}{2}\\sin(2A)$ and $\\sin(2A)\\cos(2A) = \\frac{1}{2}\\sin(4A)$:\n$$u\\,u_{x} = \\frac{1}{2}\\sin(2x)\\,\\exp(2t) - 2\\sin(x)\\sin(2x) + \\cos(x)\\cos(2x) - \\sin(4x)\\,\\exp(-2t)$$\nThe time-independent part, $\\cos(x)\\cos(2x) - 2\\sin(x)\\sin(2x)$, can be simplified using product-to-sum identities. Alternatively, we use $\\cos(3x) = 4\\cos^3(x)-3\\cos(x)$ and express the term as $6\\cos^3(x)-5\\cos(x)$, which is equivalent to $-\\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x)$. Thus, the convective term is:\n$$u\\,u_{x} = \\frac{1}{2}\\sin(2x)\\,\\exp(2t) - \\sin(4x)\\,\\exp(-2t) - \\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x)$$\n\nFinally, we substitute the expressions for $u_t$, $u\\,u_x$, and $u_{xx}$ into the equation for $f(x,t)$:\n$$f(x,t) = \\left( \\sin(x)\\,\\exp(t) - \\cos(2x)\\,\\exp(-t) \\right) + \\left( \\frac{1}{2}\\sin(2x)\\,\\exp(2t) - \\sin(4x)\\,\\exp(-2t) - \\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x) \\right) - \\nu \\left( -\\sin(x)\\,\\exp(t) - 4\\cos(2x)\\,\\exp(-t) \\right)$$\nWe collect terms with the same time dependence:\n$$f(x,t) = \\left( \\sin(x)\\,\\exp(t) + \\nu\\sin(x)\\,\\exp(t) \\right) + \\left( -\\cos(2x)\\,\\exp(-t) + 4\\nu\\cos(2x)\\,\\exp(-t) \\right) + \\frac{1}{2}\\sin(2x)\\,\\exp(2t) - \\sin(4x)\\,\\exp(-2t) - \\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x)$$\nSimplifying the coefficients gives the final expression for the source term:\n$$f(x,t) = (1+\\nu)\\sin(x)\\,\\exp(t) + (4\\nu-1)\\cos(2x)\\,\\exp(-t) + \\frac{1}{2}\\sin(2x)\\,\\exp(2t) - \\sin(4x)\\,\\exp(-2t) - \\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x)$$\n\nThe problem also requires determining the initial and boundary conditions consistent with the manufactured solution.\nThe initial condition at $t=0$ is:\n$$u(x,0) = u^{\\mathrm{MMS}}(x,0) = \\sin(x)\\,\\exp(0) + \\cos(2x)\\,\\exp(0) = \\sin(x) + \\cos(2x)$$\nThe Dirichlet boundary condition at $x=0$ is:\n$$u(0,t) = u^{\\mathrm{MMS}}(0,t) = \\sin(0)\\,\\exp(t) + \\cos(0)\\,\\exp(-t) = 0 + 1 \\cdot \\exp(-t) = \\exp(-t)$$\nThe Dirichlet boundary condition at $x=\\pi$ is:\n$$u(\\pi,t) = u^{\\mathrm{MMS}}(\\pi,t) = \\sin(\\pi)\\,\\exp(t) + \\cos(2\\pi)\\,\\exp(-t) = 0 + 1 \\cdot \\exp(-t) = \\exp(-t)$$\nThese provide the necessary data to set up a well-posed numerical problem for verification purposes. The final required answer is the analytical expression for $f(x,t)$.",
            "answer": "$$\\boxed{(1+\\nu)\\sin(x)\\exp(t) + (4\\nu-1)\\cos(2x)\\exp(-t) + \\frac{1}{2}\\sin(2x)\\exp(2t) - \\sin(4x)\\exp(-2t) - \\frac{1}{2}\\cos(x) + \\frac{3}{2}\\cos(3x)}$$"
        },
        {
            "introduction": "Once an MMS test is implemented and run, the focus shifts to analyzing the results to confirm the code's correctness. This exercise introduces Richardson extrapolation, a powerful technique for analyzing the output from a grid refinement study . You will learn how to use the numerical solutions from two different grid resolutions, $U_{h}$ and $U_{h/2}$, to both verify the expected second-order accuracy and derive a more accurate estimate of the exact solution.",
            "id": "3952625",
            "problem": "In the numerical verification of parallel electron heat conduction along a tokamak magnetic field line, consider the one-dimensional steady parallel conduction equation along the field coordinate $s$, written generically as \n$$-\\frac{d}{ds}\\left(\\kappa_{\\parallel}(T)\\frac{dT}{ds}\\right)=S(s),$$ \nwhere $\\kappa_{\\parallel}(T)$ is the parallel thermal conductivity and $S(s)$ is a volumetric source constructed via the Method of Manufactured Solutions (MMS), defined here as the practice of prescribing an analytic solution and deriving a matching source to enable controlled code verification. A centered second-order finite-difference discretization is used to approximate $T(s)$.\n\nLet $s_{0}$ be a fixed point along the field line, and denote by $U_{h}(s_{0})$ and $U_{h/2}(s_{0})$ the numerical approximations to $T(s_{0})$ obtained on two uniform grids with spacings $h$ and $h/2$, respectively. Under smooth manufactured solutions and a consistent second-order method, the leading-order discretization error at a point scales as the grid spacing squared. Define the pointwise errors via MMS as $E_{h}\\equiv T(s_{0})-U_{h}(s_{0})$ and $E_{h/2}\\equiv T(s_{0})-U_{h/2}(s_{0})$.\n\nA verification study at $s_{0}$ produces the following values (electron temperature in kilo–electron volts (keV)):\n- Numerical approximations: $U_{h}(s_{0})=3.200$ and $U_{h/2}(s_{0})=3.260$.\n- MMS pointwise errors: $E_{h}=0.080$ and $E_{h/2}=0.020$.\n\nStarting from the definition of the leading-order error model for a second-order method and without assuming any shortcut formulas, use the scaling of the discretization error with grid spacing to derive a Richardson-type extrapolated estimate of the exact temperature $T(s_{0})$ in terms of $U_{h}(s_{0})$ and $U_{h/2}(s_{0})$, and then evaluate it numerically using the given data. Round your final answer to four significant figures and express it in keV.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n**Step 1: Extract Givens**\n- Governing equation: $-\\frac{d}{ds}\\left(\\kappa_{\\parallel}(T)\\frac{dT}{ds}\\right)=S(s)$\n- Numerical scheme: Centered second-order finite-difference method.\n- Error model: For a smooth manufactured solution $T(s)$, the leading-order discretization error at a fixed point $s_0$ scales as the grid spacing squared.\n- Grid spacings: A coarse grid with spacing $h$ and a fine grid with spacing $h/2$.\n- Numerical approximations at $s_0$: $U_{h}(s_{0})$ and $U_{h/2}(s_{0})$.\n- Pointwise error definitions: $E_{h} \\equiv T(s_{0})-U_{h}(s_{0})$ and $E_{h/2} \\equiv T(s_{0})-U_{h/2}(s_{0})$.\n- Given data:\n  - $U_{h}(s_{0})=3.200$\n  - $U_{h/2}(s_{0})=3.260$\n  - $E_{h}=0.080$\n  - $E_{h/2}=0.020$\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is grounded in the standard practices of code verification in computational physics, specifically using the Method of Manufactured Solutions (MMS) and Richardson extrapolation. The governing equation is a valid physical model for heat conduction. The concept of error scaling for a second-order numerical method is fundamental to numerical analysis.\n\nA critical consistency check is performed on the provided data. Using the definition of the error:\n1. $T(s_0) = U_{h}(s_{0}) + E_{h} = 3.200 + 0.080 = 3.280$.\n2. $T(s_0) = U_{h/2}(s_{0}) + E_{h/2} = 3.260 + 0.020 = 3.280$.\nBoth computations yield the same value for the exact solution $T(s_0)$, so the data is internally consistent.\n\nFurthermore, for a second-order method, the ratio of errors on grids with spacings $h$ and $h/2$ should be approximately $(h)^2 / (h/2)^2 = 4$.\nThe ratio from the given data is $\\frac{E_h}{E_{h/2}} = \\frac{0.080}{0.020} = 4$.\nThis perfect agreement confirms that the provided data precisely follows the assumed second-order convergence behavior, validating the premise for the derivation. The problem is valid.\n\n**Step 3: Derivation and Solution**\nThe problem requires the derivation of a Richardson-type extrapolated estimate for the exact temperature $T(s_0)$. We begin with the leading-order error model for a second-order accurate method. The error in the numerical approximation $U_h$ at a point $s_0$ is given by:\n$$T(s_0) - U_h(s_0) = C h^2 + \\mathcal{O}(h^p)$$\nwhere $C$ is a constant independent of the grid spacing $h$, and the higher-order terms $\\mathcal{O}(h^p)$ have $p > 2$. For the purpose of Richardson extrapolation, we neglect these higher-order terms. This gives the leading-order error expressions for the two grids:\n\nOn the grid with spacing $h$:\n$$T(s_0) - U_h(s_0) \\approx C h^2 \\quad (1)$$\n\nOn the grid with spacing $h/2$:\n$$T(s_0) - U_{h/2}(s_0) \\approx C \\left(\\frac{h}{2}\\right)^2 = C \\frac{h^2}{4} \\quad (2)$$\n\nOur goal is to find an improved estimate for $T(s_0)$ by eliminating the unknown term $C h^2$. We can rearrange equation $(2)$ to express $C h^2$ in terms of the quantities from the finer grid:\n$$4 \\left(T(s_0) - U_{h/2}(s_0)\\right) \\approx C h^2 \\quad (3)$$\n\nNow, we have two expressions for the same quantity $C h^2$ from equations $(1)$ and $(3)$. Equating them allows us to eliminate the error constant and the grid spacing:\n$$T(s_0) - U_h(s_0) \\approx 4 \\left(T(s_0) - U_{h/2}(s_0)\\right)$$\n\nWe now solve this equation for $T(s_0)$, which will be our Richardson-extrapolated estimate. Let's denote this estimate as $T_{RE}$.\n$$T_{RE} - U_h(s_0) = 4 T_{RE} - 4 U_{h/2}(s_0)$$\n$$4 U_{h/2}(s_0) - U_h(s_0) = 4 T_{RE} - T_{RE}$$\n$$4 U_{h/2}(s_0) - U_h(s_0) = 3 T_{RE}$$\n\nIsolating $T_{RE}$ yields the formula for the Richardson-extrapolated solution:\n$$T_{RE}(s_0) = \\frac{4 U_{h/2}(s_0) - U_h(s_0)}{3}$$\nThis expression provides a higher-order estimate of the exact solution $T(s_0)$ using only the numerical approximations from the two grids.\n\nFinally, we evaluate this expression using the provided numerical data:\n- $U_{h}(s_{0})=3.200$\n- $U_{h/2}(s_{0})=3.260$\n\nSubstituting these values into the derived formula:\n$$T_{RE}(s_0) = \\frac{4(3.260) - 3.200}{3}$$\n$$T_{RE}(s_0) = \\frac{13.040 - 3.200}{3}$$\n$$T_{RE}(s_0) = \\frac{9.840}{3}$$\n$$T_{RE}(s_0) = 3.280$$\n\nThe problem asks for the answer to be rounded to four significant figures. The calculated value $3.280$ already has four significant figures. As confirmed during the validation step, this extrapolated value matches the exact manufactured solution $T(s_0)$ that can be inferred from the given data, which is expected since the input data perfectly adheres to the theoretical second-order error scaling.\nThe final answer is expressed in units of kilo-electron volts (keV), but only the numerical value is required in the final answer box.",
            "answer": "$$\\boxed{3.280}$$"
        }
    ]
}