{
    "hands_on_practices": [
        {
            "introduction": "Real-world simulations in fusion science, such as those modeling magnetohydrodynamics (MHD), must account for multiple physical processes occurring simultaneously. Each process, from bulk plasma advection and the propagation of MHD waves to diffusive transport like thermal conduction and resistivity, operates on a different timescale. This exercise  provides a practical scenario where you will calculate the individual stability constraints imposed by each of these phenomena and, by taking the minimum, determine the single most restrictive timestep that governs the entire explicit simulation.",
            "id": "3977943",
            "problem": "A three-dimensional explicit simulation of resistive magnetohydrodynamics (MHD) with anisotropic thermal conduction is performed in a rectangular domain discretized by a uniform Cartesian grid with spacings $\\Delta x = 1.0 \\times 10^{-3} \\text{ m}$, $\\Delta y = 5.0 \\times 10^{-3} \\text{ m}$, and $\\Delta z = 1.0 \\times 10^{-2} \\text{ m}$. The plasma has mass density $\\rho = 3.343 \\times 10^{-7} \\text{ kg/m}^3$, scalar thermal pressure $p = 1.602 \\times 10^{5} \\text{ Pa}$, ratio of specific heats $\\gamma = 5/3$, and a uniform magnetic field of magnitude $B = 5 \\text{ T}$ directed along the $y$-axis. The flow velocity is spatially uniform with components $u_{x} = 5.0 \\times 10^{3} \\text{ m/s}$, $u_{y} = 2.0 \\times 10^{4} \\text{ m/s}$, and $u_{z} = 1.0 \\times 10^{4} \\text{ m/s}$. The resistive magnetic diffusivity is $\\eta_{m} = 5.0 \\text{ m}^2\\text{/s}$. Anisotropic thermal transport is modeled by a diffusion tensor with parallel and perpendicular thermal diffusivities $\\chi_{\\parallel} = 1.0 \\times 10^{8} \\text{ m}^2\\text{/s}$ and $\\chi_{\\perp} = 1.0 \\text{ m}^2\\text{/s}$, respectively, with the parallel direction aligned with the magnetic field.\n\nThe code advances all fields using an unsplit finite-volume method with first-order Forward Euler time integration. Advective and MHD wave fluxes are computed with an upwind Godunov flux that is stable when the sum of directional Courant numbers does not exceed a Courant–Friedrichs–Lewy (CFL) constant $C_{\\mathrm{hyp}} = 0.5$. Diffusive terms (thermal conduction and resistive diffusion) are discretized by second-order central differences and advanced explicitly, subject to a parabolic stability constant $C_{\\mathrm{diff}} = 0.5$. Assume the maximum MHD signal speed is the fast magnetosonic speed $c_{f} = \\sqrt{c_{s}^{2} + v_{A}^{2}}$, where $c_{s} = \\sqrt{\\gamma p / \\rho}$ is the sound speed and $v_{A} = B/\\sqrt{\\mu_{0}\\rho}$ is the Alfvén speed, with magnetic permeability $\\mu_{0} = 4\\pi \\times 10^{-7} \\text{ H/m}$. Treat the fast magnetosonic speed as isotropic.\n\nCompute the final explicit time step obtained by aggregating the individual stability constraints from:\n1) pure advection of the flow velocity,\n2) hyperbolic MHD waves at the fast magnetosonic speed,\n3) anisotropic thermal conduction aligned with the magnetic field, and\n4) resistive magnetic diffusion.\n\nTake the global time step as the minimum of all individual bounds using the given stability constants. Identify, in words, the dominant limiting mechanism in your derivation, but report only the numerical value of the final time step as your answer. Round your numerical answer to three significant figures. Express the final time step in seconds.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. All necessary parameters and definitions for computing the explicit time step constraints in a resistive magnetohydrodynamics (MHD) simulation are provided. The physical model and numerical-method constraints are standard in computational plasma physics. Therefore, the problem is valid and a solution will be provided.\n\nThe goal is to determine the maximum allowable time step, $\\Delta t$, for an explicit time integration scheme, which is constrained by several physical phenomena. The overall time step is the minimum of the time steps imposed by each individual process:\n$$ \\Delta t = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{MHD}}, \\Delta t_{\\text{th}}, \\Delta t_{\\text{res}}) $$\nWe will calculate each of these four stability limits.\n\nFirst, we compute the characteristic wave speeds of the plasma using the provided parameters:\n- Mass density: $\\rho = 3.343 \\times 10^{-7} \\text{ kg/m}^3$\n- Thermal pressure: $p = 1.602 \\times 10^{5} \\text{ Pa}$\n- Ratio of specific heats: $\\gamma = 5/3$\n- Magnetic field magnitude: $B = 5 \\text{ T}$\n- Magnetic permeability of free space: $\\mu_0 = 4\\pi \\times 10^{-7} \\text{ H/m}$\n\nThe sound speed, $c_s$, is given by:\n$$ c_s = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(5/3) \\times (1.602 \\times 10^5 \\text{ Pa})}{3.343 \\times 10^{-7} \\text{ kg/m}^3}} \\approx 8.937 \\times 10^5 \\text{ m/s} $$\n\nThe Alfvén speed, $v_A$, is given by:\n$$ v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}} = \\frac{5 \\text{ T}}{\\sqrt{(4\\pi \\times 10^{-7} \\text{ H/m}) \\times (3.343 \\times 10^{-7} \\text{ kg/m}^3)}} \\approx 7.714 \\times 10^6 \\text{ m/s} $$\n\nThe fast magnetosonic speed, $c_f$, is the quadrature sum of the sound and Alfvén speeds:\n$$ c_f = \\sqrt{c_s^2 + v_A^2} = \\sqrt{(8.937 \\times 10^5 \\text{ m/s})^2 + (7.714 \\times 10^6 \\text{ m/s})^2} \\approx 7.766 \\times 10^6 \\text{ m/s} $$\n\nThe stability constraints for hyperbolic (advection, waves) and parabolic (diffusion) phenomena in an unsplit, three-dimensional explicit scheme are given by:\n- Hyperbolic CFL condition: $\\Delta t_{\\text{hyp}} \\le \\frac{C_{\\mathrm{hyp}}}{\\sum_{i=x,y,z} \\frac{v_i}{\\Delta i}}$, where $v_i$ is the maximum signal speed in direction $i$.\n- Parabolic condition: $\\Delta t_{\\text{diff}} \\le \\frac{C_{\\mathrm{diff}}}{\\sum_{i=x,y,z} \\frac{D_i}{(\\Delta i)^2}}$, where $D_i$ is the diffusivity in direction $i$.\n\nThe given grid spacings are $\\Delta x = 1.0 \\times 10^{-3} \\text{ m}$, $\\Delta y = 5.0 \\times 10^{-3} \\text{ m}$, and $\\Delta z = 1.0 \\times 10^{-2} \\text{ m}$. The stability constants are $C_{\\mathrm{hyp}} = 0.5$ and $C_{\\mathrm{diff}} = 0.5$.\n\n1.  **Pure Advection Constraint ($\\Delta t_{\\text{adv}}$)**\n    This constraint is determined by the fluid velocity $\\vec{u} = (u_x, u_y, u_z)$, where $u_x = 5.0 \\times 10^3 \\text{ m/s}$, $u_y = 2.0 \\times 10^4 \\text{ m/s}$, and $u_z = 1.0 \\times 10^4 \\text{ m/s}$.\n    $$ \\Delta t_{\\text{adv}} \\le \\frac{C_{\\mathrm{hyp}}}{\\frac{|u_x|}{\\Delta x} + \\frac{|u_y|}{\\Delta y} + \\frac{|u_z|}{\\Delta z}} $$\n    $$ \\Delta t_{\\text{adv}} \\le \\frac{0.5}{\\frac{5.0 \\times 10^3}{1.0 \\times 10^{-3}} + \\frac{2.0 \\times 10^4}{5.0 \\times 10^{-3}} + \\frac{1.0 \\times 10^4}{1.0 \\times 10^{-2}}} = \\frac{0.5}{5.0 \\times 10^6 + 4.0 \\times 10^6 + 1.0 \\times 10^6} = \\frac{0.5}{1.0 \\times 10^7} $$\n    $$ \\Delta t_{\\text{adv}} \\le 5.0 \\times 10^{-8} \\text{ s} $$\n\n2.  **Hyperbolic MHD Wave Constraint ($\\Delta t_{\\text{MHD}}$)**\n    The maximum signal speed in direction $i$ is $|u_i| + c_f$.\n    $$ \\Delta t_{\\text{MHD}} \\le \\frac{C_{\\mathrm{hyp}}}{\\frac{|u_x| + c_f}{\\Delta x} + \\frac{|u_y| + c_f}{\\Delta y} + \\frac{|u_z| + c_f}{\\Delta z}} $$\n    The sum of inverse time scales in the denominator is:\n    $$ \\sum \\frac{v_i}{\\Delta i} = \\frac{5.0 \\times 10^3 + 7.766 \\times 10^6}{1.0 \\times 10^{-3}} + \\frac{2.0 \\times 10^4 + 7.766 \\times 10^6}{5.0 \\times 10^{-3}} + \\frac{1.0 \\times 10^4 + 7.766 \\times 10^6}{1.0 \\times 10^{-2}} $$\n    $$ \\sum \\frac{v_i}{\\Delta i} \\approx (7.771 \\times 10^9) + (1.557 \\times 10^9) + (0.778 \\times 10^9) = 1.0106 \\times 10^{10} \\text{ s}^{-1} $$\n    $$ \\Delta t_{\\text{MHD}} \\le \\frac{0.5}{1.0106 \\times 10^{10}} \\approx 4.948 \\times 10^{-11} \\text{ s} $$\n\n3.  **Anisotropic Thermal Conduction Constraint ($\\Delta t_{\\text{th}}$)**\n    This is a parabolic constraint. The magnetic field is aligned with the $y$-axis, so thermal diffusion is highly anisotropic. The diffusion coefficients along the grid axes are $\\chi_x = \\chi_{\\perp} = 1.0 \\text{ m}^2\\text{/s}$, $\\chi_y = \\chi_{\\parallel} = 1.0 \\times 10^8 \\text{ m}^2\\text{/s}$, and $\\chi_z = \\chi_{\\perp} = 1.0 \\text{ m}^2\\text{/s}$.\n    $$ \\Delta t_{\\text{th}} \\le \\frac{C_{\\mathrm{diff}}}{\\frac{\\chi_x}{(\\Delta x)^2} + \\frac{\\chi_y}{(\\Delta y)^2} + \\frac{\\chi_z}{(\\Delta z)^2}} $$\n    The grid spacings squared are $(\\Delta x)^2 = 1.0 \\times 10^{-6} \\text{ m}^2$, $(\\Delta y)^2 = 2.5 \\times 10^{-5} \\text{ m}^2$, and $(\\Delta z)^2 = 1.0 \\times 10^{-4} \\text{ m}^2$.\n    The sum of inverse time scales in the denominator is:\n    $$ \\sum \\frac{\\chi_i}{(\\Delta i)^2} = \\frac{1.0}{1.0 \\times 10^{-6}} + \\frac{1.0 \\times 10^8}{2.5 \\times 10^{-5}} + \\frac{1.0}{1.0 \\times 10^{-4}} = 1.0 \\times 10^6 + 4.0 \\times 10^{12} + 1.0 \\times 10^4 $$\n    The term for parallel conduction, $\\frac{\\chi_{\\parallel}}{(\\Delta y)^2}$, is dominant.\n    $$ \\sum \\frac{\\chi_i}{(\\Delta i)^2} \\approx 4.0 \\times 10^{12} \\text{ s}^{-1} $$\n    $$ \\Delta t_{\\text{th}} \\le \\frac{0.5}{4.0 \\times 10^{12}} = 1.25 \\times 10^{-13} \\text{ s} $$\n\n4.  **Resistive Magnetic Diffusion Constraint ($\\Delta t_{\\text{res}}$)**\n    This is an isotropic parabolic process with diffusivity $\\eta_m = 5.0 \\text{ m}^2\\text{/s}$.\n    $$ \\Delta t_{\\text{res}} \\le \\frac{C_{\\mathrm{diff}}}{\\eta_m \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} + \\frac{1}{(\\Delta z)^2} \\right)} $$\n    The sum of the geometric factors is:\n    $$ \\sum \\frac{1}{(\\Delta i)^2} = \\frac{1}{1.0 \\times 10^{-6}} + \\frac{1}{2.5 \\times 10^{-5}} + \\frac{1}{1.0 \\times 10^{-4}} = 1.0 \\times 10^6 + 4.0 \\times 10^4 + 1.0 \\times 10^4 = 1.05 \\times 10^6 \\text{ m}^{-2} $$\n    $$ \\Delta t_{\\text{res}} \\le \\frac{0.5}{5.0 \\times (1.05 \\times 10^6)} = \\frac{0.5}{5.25 \\times 10^6} \\approx 9.524 \\times 10^{-8} \\text{ s} $$\n\nComparing the four time step limits:\n- $\\Delta t_{\\text{adv}} \\le 5.0 \\times 10^{-8} \\text{ s}$\n- $\\Delta t_{\\text{MHD}} \\le 4.948 \\times 10^{-11} \\text{ s}$\n- $\\Delta t_{\\text{th}} \\le 1.25 \\times 10^{-13} \\text{ s}$\n- $\\Delta t_{\\text{res}} \\le 9.524 \\times 10^{-8} \\text{ s}$\n\nThe minimum value determines the global time step for the explicit simulation.\n$$ \\Delta t = \\min(5.0 \\times 10^{-8}, 4.948 \\times 10^{-11}, 1.25 \\times 10^{-13}, 9.524 \\times 10^{-8}) = 1.25 \\times 10^{-13} \\text{ s} $$\nThe dominant limiting mechanism is the explicit treatment of anisotropic thermal conduction. The extremely high diffusivity parallel to the magnetic field combined with the spatial resolution in that direction imposes a very severe time step restriction. The final answer, rounded to three significant figures, is $1.25 \\times 10^{-13}$ seconds.",
            "answer": "$$ \\boxed{1.25 \\times 10^{-13}} $$"
        },
        {
            "introduction": "While fluid models are governed by Courant-Friedrichs-Lewy (CFL) stability conditions, kinetic simulations of individual charged particles introduce different numerical considerations. The Boris pusher, a cornerstone algorithm in Particle-In-Cell (PIC) codes, is famous for its excellent long-term stability properties when modeling particle gyration in a magnetic field. This thought experiment  delves into the critical distinction between numerical stability and physical accuracy, challenging you to explain why a method can be unconditionally stable yet still require a small timestep, $\\Delta t \\ll \\Omega_c^{-1}$, to accurately resolve the phase of the cyclotron motion.",
            "id": "3977945",
            "problem": "A nonrelativistic charged particle with charge $q$ and mass $m$ moves in a spatially uniform magnetic field $\\mathbf{B} = B_0 \\,\\hat{\\mathbf{z}}$ and zero electric field $\\mathbf{E} = \\mathbf{0}$. In Particle-In-Cell (PIC) computations for magnetized fusion plasmas, the explicit Boris pusher is widely used to advance the particle velocity and position. Starting from the Lorentz force law and the definition of cyclotron frequency $\\Omega_c = q B_0 / m$, reason about the qualitative and quantitative differences between stability and accuracy for the explicit time integration performed by the Boris pusher in this setting. In particular, distinguish whether and why the method can be stable without a Courant–Friedrichs–Lewy (CFL) constraint while still requiring $\\Delta t\\,\\Omega_c \\ll 1$ to accurately resolve cyclotron motion.\n\nSelect all statements that correctly characterize the stability versus accuracy of the Boris pusher under these conditions:\n\nA. In a uniform magnetic field with $\\mathbf{E}=\\mathbf{0}$, the Boris pusher preserves kinetic energy exactly for any $\\Delta t$, implying linear stability of the discrete velocity update without a Courant–Friedrichs–Lewy (CFL) constraint tying $\\Delta t$ to $\\Omega_c$.\n\nB. In a uniform magnetic field, the Boris pusher advances the velocity by a rotation in the plane perpendicular to $\\mathbf{B}$ through an angle that is exactly $\\theta = \\Omega_c \\Delta t$, so there is no phase error at any $\\Delta t$.\n\nC. Although the Boris pusher is stable for any $\\Delta t$, resolving cyclotron motion with quantitative accuracy requires $\\Delta t\\,\\Omega_c \\ll 1$ because the per-step phase error scales like $\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^3\\right)$, yielding a cumulative (global) phase error of $\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^2\\right)$ over many gyrations.\n\nD. For explicit stability, the Boris pusher requires $\\Delta t\\,\\Omega_c  2$, otherwise the discrete map becomes unstable and particle speeds blow up.\n\nE. In fusion-relevant fields, for example deuterons at $B_0 = 5\\,\\mathrm{T}$, choosing $\\Delta t = \\dfrac{0.1}{\\Omega_c}$ produces no phase error in the gyration while preserving kinetic energy, so both stability and exact accuracy are achieved.",
            "solution": "The user wants a critical validation of the problem statement, followed by a detailed solution and evaluation of the options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- A nonrelativistic charged particle with charge $q$ and mass $m$.\n- Motion is in a spatially uniform magnetic field $\\mathbf{B} = B_0 \\,\\hat{\\mathbf{z}}$.\n- The electric field is zero, $\\mathbf{E} = \\mathbf{0}$.\n- The numerical method is the explicit Boris pusher.\n- The cyclotron frequency is defined as $\\Omega_c = q B_0 / m$.\n- The central question is to distinguish between stability and accuracy for this method, specifically why it can be stable without a Courant–Friedrichs–Lewy (CFL) constraint while still requiring $\\Delta t\\,\\Omega_c \\ll 1$ for accuracy.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes Larmor gyration, a fundamental motion of charged particles in a magnetic field, governed by the Lorentz force. The Boris pusher is a standard, canonical algorithm used for decades in Particle-In-Cell (PIC) simulations of plasmas. The concepts of numerical stability, CFL conditions, accuracy, and phase error are all rigorous and central topics in computational physics. The problem is firmly rooted in established physics and numerical analysis.\n- **Well-Posed:** The physical system is clearly defined ($\\mathbf{E}=0$, uniform $\\mathbf{B}$). The numerical method is specified (Boris pusher). The question is precise, asking for the distinction between stability and accuracy constraints. A unique and meaningful analysis is possible.\n- **Objective:** The language is technical, precise, and devoid of subjectivity. All terms are standard in the field.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, well-posed, and objective. It presents a standard, non-trivial problem in computational plasma physics that is suitable for rigorous analysis. The problem is valid.\n\n### Principle-Based Derivation\n\nThe motion of the particle is governed by the nonrelativistic Lorentz force equation:\n$$ m \\frac{d\\mathbf{v}}{dt} = q (\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) $$\nGiven $\\mathbf{E} = \\mathbf{0}$, this simplifies to the magnetic force equation:\n$$ \\frac{d\\mathbf{v}}{dt} = \\frac{q}{m} (\\mathbf{v} \\times \\mathbf{B}) $$\nFor a uniform magnetic field $\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$, and using $\\Omega_c = qB_0/m$, the equation becomes:\n$$ \\frac{d\\mathbf{v}}{dt} = \\Omega_c (\\mathbf{v} \\times \\hat{\\mathbf{z}}) $$\nThis equation describes a rotation of the velocity vector $\\mathbf{v}$ around the $\\hat{\\mathbf{z}}$ axis at an angular frequency $\\Omega_c$. The component of velocity parallel to $\\mathbf{B}$, $v_z$, is constant, while the perpendicular component, $\\mathbf{v}_{\\perp}$, rotates. The kinetic energy $K = \\frac{1}{2}mv^2$ is an exact constant of motion, since the magnetic force does no work ($(\\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{v} = 0$).\n\nThe Boris algorithm is a leapfrog time-integration scheme. For the magnetic term, it is based on a second-order accurate, time-centered finite-difference approximation of the differential equation:\n$$ \\frac{\\mathbf{v}^{n+1/2} - \\mathbf{v}^{n-1/2}}{\\Delta t} = \\frac{q}{m} \\left( \\frac{\\mathbf{v}^{n+1/2} + \\mathbf{v}^{n-1/2}}{2} \\times \\mathbf{B}^n \\right) $$\nwhere $\\mathbf{v}^{n\\pm1/2}$ represents the velocity at time $t^n \\pm \\Delta t/2$. Rearranging and using the definition of $\\Omega_c$:\n$$ \\mathbf{v}^{n+1/2} - \\mathbf{v}^{n-1/2} = \\frac{\\Omega_c \\Delta t}{2} \\left( (\\mathbf{v}^{n+1/2} + \\mathbf{v}^{n-1/2}) \\times \\hat{\\mathbf{z}} \\right) $$\nThis equation defines an implicit update for $\\mathbf{v}^{n+1/2}$. The insight of Boris was to solve this equation for $\\mathbf{v}^{n+1/2}$ explicitly and efficiently. The result of this algebraic manipulation is a pure rotation. Let's define $\\mathbf{v}^- = \\mathbf{v}^{n-1/2}$ and $\\mathbf{v}^+ = \\mathbf{v}^{n+1/2}$. The update can be written as $\\mathbf{v}^+ = \\mathbf{R} \\mathbf{v}^-$, where $\\mathbf{R}$ is a rotation matrix.\n\n**Analysis of Stability:**\nThe Boris push for $\\mathbf{E}=0$ is exactly a rotation of the velocity vector. A rotation is a unitary transformation, meaning it preserves the length (norm) of the vector it acts upon. Therefore:\n$$ |\\mathbf{v}^{n+1/2}| = |\\mathbf{v}^{n-1/2}| $$\nThis holds true regardless of the size of the time step $\\Delta t$. Since the magnitude of the velocity vector is exactly conserved at every step, the kinetic energy $K = \\frac{1}{2}m|\\mathbf{v}|^2$ is also exactly conserved. A numerical scheme that exactly conserves a constant of motion like energy cannot become unstable (i.e., it cannot lead to unphysical growth of the velocity). This property holds for any $\\Delta t  0$, so the Boris method in a purely magnetic field is unconditionally stable. There is no CFL-like stability constraint on $\\Delta t$ related to $\\Omega_c$.\n\n**Analysis of Accuracy:**\nThe exact solution is a rotation of $\\mathbf{v}_{\\perp}$ by an angle $\\theta_{\\text{exact}} = \\Omega_c \\Delta t$ over a time step $\\Delta t$.\nThe Boris algorithm can be shown to perform a rotation of the velocity vector by a numerically determined angle, $\\theta_B$. This angle is given by:\n$$ \\theta_B = 2 \\arctan\\left(\\frac{\\Omega_c \\Delta t}{2}\\right) $$\nFor the numerical solution to be accurate, the numerical rotation angle $\\theta_B$ must be a close approximation of the exact physical angle $\\theta_{\\text{exact}}$. Let's analyze the difference using a Taylor series expansion for small argument $x = \\frac{\\Omega_c \\Delta t}{2}$:\n$$ \\arctan(x) = x - \\frac{x^3}{3} + \\mathcal{O}(x^5) $$\nSubstituting this into the expression for $\\theta_B$:\n$$ \\theta_B = 2 \\left( \\frac{\\Omega_c \\Delta t}{2} - \\frac{1}{3}\\left(\\frac{\\Omega_c \\Delta t}{2}\\right)^3 + \\dots \\right) = \\Omega_c \\Delta t - \\frac{(\\Omega_c \\Delta t)^3}{12} + \\mathcal{O}((\\Omega_c \\Delta t)^5) $$\nThe difference between the numerical and exact angles, which is the local phase error per step, is:\n$$ \\Delta\\theta = \\theta_B - \\theta_{\\text{exact}} \\approx -\\frac{(\\Omega_c \\Delta t)^3}{12} $$\nThe local truncation error for the phase is of order $\\mathcal{O}((\\Omega_c \\Delta t)^3)$. For the phase to be accurately tracked, this error must be small, which requires $\\Omega_c \\Delta t \\ll 1$. This is an accuracy requirement, not a stability constraint.\n\nThe cumulative, or global, phase error after a time $T = N\\Delta t$ is the sum of the local errors over $N = T/\\Delta t$ steps. The global error scales as:\n$$ \\text{Global Error} \\approx N \\times \\Delta\\theta \\approx \\frac{T}{\\Delta t} \\times \\mathcal{O}((\\Omega_c \\Delta t)^3) = T \\Omega_c^3 \\mathcal{O}((\\Delta t)^2) = \\mathcal{O}((\\Omega_c \\Delta t)^2) $$\nThis means the method is second-order accurate for the phase. To maintain accuracy over many gyrations, one must choose $\\Delta t$ small enough such that $\\Omega_c \\Delta t \\ll 1$.\n\n### Option-by-Option Analysis\n\n**A. In a uniform magnetic field with $\\mathbf{E}=\\mathbf{0}$, the Boris pusher preserves kinetic energy exactly for any $\\Delta t$, implying linear stability of the discrete velocity update without a Courant–Friedrichs–Lewy (CFL) constraint tying $\\Delta t$ to $\\Omega_c$.**\nAs derived above, the velocity update in this case is a pure rotation, which is a norm-preserving operation. This means $|\\mathbf{v}|$ and thus kinetic energy are exactly conserved for any value of $\\Delta t$. Exact energy conservation guarantees that the solution cannot grow without bound, hence the method is stable. This stability is independent of $\\Delta t$, so there is no CFL-type stability limit. This statement accurately describes the stability properties.\n**Verdict: Correct**\n\n**B. In a uniform magnetic field, the Boris pusher advances the velocity by a rotation in the plane perpendicular to $\\mathbf{B}$ through an angle that is exactly $\\theta = \\Omega_c \\Delta t$, so there is no phase error at any $\\Delta t$.**\nThis statement is false. As derived in the accuracy analysis, the numerical rotation angle is $\\theta_B = 2 \\arctan(\\Omega_c \\Delta t / 2)$, which is not equal to the exact physical angle $\\theta_{\\text{exact}} = \\Omega_c \\Delta t$ for any $\\Delta t  0$. The inequality $\\arctan(x)  x$ for $x0$ ensures there is always a phase error, causing the numerical gyration to lag behind the physical one.\n**Verdict: Incorrect**\n\n**C. Although the Boris pusher is stable for any $\\Delta t$, resolving cyclotron motion with quantitative accuracy requires $\\Delta t\\,\\Omega_c \\ll 1$ because the per-step phase error scales like $\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^3\\right)$, yielding a cumulative (global) phase error of $\\mathcal{O}\\!\\left((\\Omega_c \\Delta t)^2\\right)$ over many gyrations.**\nThis statement correctly summarizes the key distinction. The first clause, \"stable for any $\\Delta t$\", is correct. The second, \"accuracy requires $\\Delta t\\,\\Omega_c \\ll 1$\", is also correct. The justification provided is also precisely what was derived: the local (per-step) phase error is $\\mathcal{O}((\\Omega_c \\Delta t)^3)$, and the global (cumulative) phase error is $\\mathcal{O}((\\Omega_c \\Delta t)^2)$. This is a textbook description of the method's accuracy.\n**Verdict: Correct**\n\n**D. For explicit stability, the Boris pusher requires $\\Delta t\\,\\Omega_c  2$, otherwise the discrete map becomes unstable and particle speeds blow up.**\nThis statement is false. It claims a conditional stability limit, which contradicts the unconditional stability proven by exact energy conservation. The stability condition $\\Omega_c \\Delta t  2$ is famous, but it applies to other, simpler explicit schemes like the standard leapfrog integrator applied to a simple harmonic oscillator equation ($y'' = -\\omega^2 y$), not to the Boris pusher, which has superior stability properties. The Boris pusher is stable for all $\\Delta t$.\n**Verdict: Incorrect**\n\n**E. In fusion-relevant fields, for example deuterons at $B_0 = 5\\,\\mathrm{T}$, choosing $\\Delta t = \\dfrac{0.1}{\\Omega_c}$ produces no phase error in the gyration while preserving kinetic energy, so both stability and exact accuracy are achieved.**\nThis statement contains two claims. The first, \"preserving kinetic energy,\" is true for the Boris pusher. The second, \"produces no phase error\" and achieves \"exact accuracy,\" is false. The dimensionless parameter is $\\Omega_c \\Delta t = 0.1$. Since this value is not zero, there is a finite, albeit small, phase error. The numerical values of $B_0$ and the particle species are irrelevant to this conclusion. A choice of $\\Omega_c \\Delta t = 0.1$ is a practical one for achieving good (but not exact) accuracy, but the statement's claim of \"no phase error\" is incorrect.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "Using a fixed, small timestep that caters to the worst-case stability limit can be computationally wasteful, as physical conditions may allow for a much larger step during less dynamic phases of a simulation. Modern codes often employ adaptive timestepping to enhance efficiency by dynamically adjusting the step size based on an estimate of the local error. This final practice  brings together the concepts of accuracy and stability, asking you to derive a step-size controller for an embedded Runge-Kutta pair and then apply it in a scenario where the final timestep is chosen as the more restrictive of the accuracy-based proposal and a hard cap imposed by the CFL stability condition.",
            "id": "3977905",
            "problem": "In an explicit time integration of a semi-discrete hyperbolic system arising in computational magnetohydrodynamics (MHD), consider advancing the solution with an embedded Runge–Kutta (RK) pair of orders $p$ and $p-1$. The embedded pair produces two approximations at time $t_{n}+\\Delta t_{n}$ using the same stage derivatives: a higher-order solution $y_{n+1}^{[p]}$ and an embedded lower-order solution $y_{n+1}^{[p-1]}$, whose difference is used to estimate the local truncation error. Assume the standard asymptotic local error expansion for explicit RK methods and that the error estimator is normalized to a dimensionless scalar $\\text{err}_{n}$ that is asymptotically proportional to $\\Delta t_{n}^{p+1}$. \n\nTask 1: Concisely describe how an embedded RK pair constructs a local error estimate from a single stage computation. Then, starting from the asymptotic relation between the local truncation error and the time step size, derive a step-size controller that updates $\\Delta t_{n+1}$ in terms of $\\Delta t_{n}$, a user tolerance $\\text{tol}$, the measured scalar error $\\text{err}_{n}$, and the method order $p$. Include a safety factor $s\\in(0,1)$.\n\nTask 2: In one-dimensional (1D) MHD with flow speed $u$, sound speed $c_{s}$, and Alfvén speed $v_{A}$, the fast magnetosonic speed is $c_{f}=\\sqrt{c_{s}^{2}+v_{A}^{2}}$ for the aligned-field case, and a conservative upper bound on the maximum characteristic speed relative to the mesh is $a_{\\max}=|u|+c_{f}$. For a uniform grid of spacing $\\Delta x$, an explicit finite-volume method with an explicit RK time integrator must satisfy a Courant–Friedrichs–Lewy (CFL) condition of the form $\\Delta t\\le \\nu_{\\max}\\,\\Delta x/a_{\\max}$ for stability, where $\\nu_{\\max}\\in(0,1)$ is a prescribed Courant number bound consistent with the linear stability region of the chosen spatial–temporal discretization.\n\nCombine your controller from Task 1 with a hard cap imposed by the CFL stability limit to produce a single update formula for $\\Delta t_{n+1}$ that selects the smaller of the error-based proposal and the CFL cap. Then evaluate $\\Delta t_{n+1}$ numerically for the following parameters:\n- Embedded pair order for the accepted solution: $p=5$.\n- Safety factor: $s=0.9$.\n- Current step size: $\\Delta t_{n}=1.2\\times 10^{-8} \\text{ s}$.\n- User tolerance: $\\text{tol}=1.0\\times 10^{-5}$.\n- Measured scalar error: $\\text{err}_{n}=2.5\\times 10^{-4}$.\n- Grid spacing: $\\Delta x=5.2\\times 10^{-3} \\text{ m}$.\n- Flow speed magnitude: $|u|=1.0\\times 10^{5} \\text{ m/s}$.\n- Sound speed: $c_{s}=1.5\\times 10^{6} \\text{ m/s}$.\n- Alfvén speed: $v_{A}=2.0\\times 10^{6} \\text{ m/s}$.\n- Courant number bound: $\\nu_{\\max}=0.8$.\n\nExpress your final answer as the single numerical value of $\\Delta t_{n+1}$ in seconds, rounded to three significant figures.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically sound, well-posed, and free of contradictions or ambiguities, resting upon established principles of numerical methods for partial differential equations in computational physics. A full solution is therefore presented.\n\nThe problem is divided into two tasks. The first is to describe the error estimation mechanism of an embedded Runge-Kutta (RK) pair and derive an adaptive step-size controller. The second is to combine this controller with a Courant–Friedrichs–Lewy (CFL) stability constraint and perform a numerical calculation.\n\n**Task 1: Error Estimation and Step-Size Controller Derivation**\n\nAn embedded Runge-Kutta pair consists of two explicit RK methods of orders $p$ and $p-1$. Its defining feature is that both methods utilize the same set of stage derivatives (function evaluations) to advance the solution from time $t_n$ by a step $\\Delta t_n$. This yields two distinct approximations at time $t_{n+1} = t_n + \\Delta t_n$: a higher-order solution $y_{n+1}^{[p]}$ and a lower-order embedded solution $y_{n+1}^{[p-1]}$. The difference between these two approximations, $E_{n+1} = y_{n+1}^{[p]} - y_{n+1}^{[p-1]}$, serves as an estimate of the local truncation error (LTE). Typically, this difference is an estimate for the LTE of the lower-order method, which is of order $p$. However, the problem statement specifies that a normalized scalar error metric, $\\text{err}_n$, is asymptotically proportional to $\\Delta t_{n}^{p+1}$. This indicates that the error being controlled is the LTE of the higher-order method. We proceed based on this given premise.\n\nThe asymptotic relationship between the estimated error $\\text{err}_n$ at step $n$ and the step size $\\Delta t_n$ is given as:\n$$\n\\text{err}_{n} \\approx C \\Delta t_{n}^{p+1}\n$$\nwhere $C$ is a constant that depends on the solution's higher-order derivatives but is assumed to be approximately constant over consecutive time steps.\n\nThe objective of an adaptive step-size controller is to select the next time step, $\\Delta t_{n+1}$, such that the predicted error for that step, $\\text{err}_{n+1}$, meets a prescribed user tolerance, $\\text{tol}$. We thus set the target:\n$$\n\\text{tol} \\approx C \\Delta t_{n+1}^{p+1}\n$$\n\nTo find the new step size $\\Delta t_{n+1}$, we can eliminate the unknown constant $C$ by taking the ratio of the two preceding expressions:\n$$\n\\frac{\\text{tol}}{\\text{err}_{n}} \\approx \\frac{C \\Delta t_{n+1}^{p+1}}{C \\Delta t_{n}^{p+1}} = \\left(\\frac{\\Delta t_{n+1}}{\\Delta t_{n}}\\right)^{p+1}\n$$\nSolving for $\\Delta t_{n+1}$ yields the optimal step-size estimate:\n$$\n\\Delta t_{n+1} \\approx \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}}\n$$\nTo create a more robust controller that avoids overly optimistic step-size increases and reduces the frequency of rejected steps, a safety factor $s \\in (0,1)$ is introduced. The resulting formula for the step size proposed by the error controller, which we denote $\\Delta t_{\\text{err}}$, is:\n$$\n\\Delta t_{\\text{err}} = s \\cdot \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}}\n$$\n\n**Task 2: Combined Controller and Numerical Evaluation**\n\nFor an explicit time integration scheme applied to a hyperbolic system, the time step must satisfy a CFL condition for numerical stability. The problem provides this condition as $\\Delta t \\le \\nu_{\\max}\\,\\Delta x/a_{\\max}$, where $a_{\\max}$ is the maximum characteristic speed. This imposes a hard upper limit on the step size, $\\Delta t_{\\text{CFL}} = \\nu_{\\max}\\,\\Delta x/a_{\\max}$, independent of accuracy considerations.\n\nThe final time step $\\Delta t_{n+1}$ must satisfy both the accuracy requirement (to keep the error below $\\text{tol}$) and the stability requirement. Therefore, the new step size is chosen as the minimum of the value proposed by the error controller and the CFL stability limit:\n$$\n\\Delta t_{n+1} = \\min(\\Delta t_{\\text{err}}, \\Delta t_{\\text{CFL}})\n$$\n\nWe now evaluate this expression using the provided numerical parameters.\nFirst, we calculate the CFL time-step limit, $\\Delta t_{\\text{CFL}}$. This requires the maximum characteristic speed, $a_{\\max}$.\nThe fast magnetosonic speed $c_f$ is:\n$$\nc_{f} = \\sqrt{c_{s}^{2} + v_{A}^{2}} = \\sqrt{(1.5 \\times 10^{6})^2 + (2.0 \\times 10^{6})^2} = \\sqrt{2.25 \\times 10^{12} + 4.0 \\times 10^{12}} = \\sqrt{6.25 \\times 10^{12}} = 2.5 \\times 10^{6} \\text{ m/s}\n$$\nThe maximum characteristic speed relative to the mesh is:\n$$\na_{\\max} = |u| + c_{f} = 1.0 \\times 10^{5} + 2.5 \\times 10^{6} = 2.6 \\times 10^{6} \\text{ m/s}\n$$\nNow, we can compute the CFL step-size limit:\n$$\n\\Delta t_{\\text{CFL}} = \\nu_{\\max} \\frac{\\Delta x}{a_{\\max}} = 0.8 \\times \\frac{5.2 \\times 10^{-3}}{2.6 \\times 10^{6}} = 0.8 \\times (2.0 \\times 10^{-9}) = 1.6 \\times 10^{-9} \\text{ s}\n$$\nNext, we calculate the step size proposed by the error controller, $\\Delta t_{\\text{err}}$. The parameters are $p=5$, $s=0.9$, $\\Delta t_n = 1.2 \\times 10^{-8} \\text{ s}$, $\\text{tol}=1.0 \\times 10^{-5}$, and $\\text{err}_n = 2.5 \\times 10^{-4}$. The exponent in the controller is $\\frac{1}{p+1} = \\frac{1}{5+1} = \\frac{1}{6}$.\n$$\n\\Delta t_{\\text{err}} = s \\cdot \\Delta t_{n} \\left(\\frac{\\text{tol}}{\\text{err}_{n}}\\right)^{\\frac{1}{p+1}} = 0.9 \\cdot (1.2 \\times 10^{-8} \\text{ s}) \\left(\\frac{1.0 \\times 10^{-5}}{2.5 \\times 10^{-4}}\\right)^{\\frac{1}{6}}\n$$\n$$\n\\Delta t_{\\text{err}} = 1.08 \\times 10^{-8} \\text{ s} \\left(\\frac{1}{25}\\right)^{\\frac{1}{6}} = 1.08 \\times 10^{-8} \\text{ s} \\left(0.04\\right)^{\\frac{1}{6}}\n$$\n$$\n\\Delta t_{\\text{err}} \\approx 1.08 \\times 10^{-8} \\text{ s} \\times 0.573539 \\approx 6.1942 \\times 10^{-9} \\text{ s}\n$$\nFinally, we select the new step size $\\Delta t_{n+1}$ by taking the minimum of the two calculated values:\n$$\n\\Delta t_{n+1} = \\min(\\Delta t_{\\text{err}}, \\Delta t_{\\text{CFL}}) = \\min(6.1942 \\times 10^{-9} \\text{ s}, 1.6 \\times 10^{-9} \\text{ s}) = 1.6 \\times 10^{-9} \\text{ s}\n$$\nIn this case, the time step is limited by the CFL stability condition, not the accuracy requirement. The problem requires the final answer to be rounded to three significant figures.\n$$\n\\Delta t_{n+1} = 1.60 \\times 10^{-9} \\text{ s}\n$$",
            "answer": "$$\n\\boxed{1.60 \\times 10^{-9}}\n$$"
        }
    ]
}