{
    "hands_on_practices": [
        {
            "introduction": "隐式方法的核心挑战在于求解一个代数方程来确定未来的系统状态，这个状态是方程的隐式解。本练习将通过一个典型的刚性常微分方程来分解这一基本过程。我们将应用后向欧拉法，学习如何将时间离散后的方程构建为一个非线性求根问题，并执行一步牛顿法迭代来求解。这个过程是所有更复杂隐式求解器所依赖的基础性操作 。",
            "id": "3992852",
            "problem": "在一个聚变等离子体能量平衡的集总零维模型中，用于描述电阻弛豫的线性化扰动振幅 $y(t)$ 服从标量常微分方程 (ODE) $y'(t) = f(t,y) = -\\lambda y(t) + S(t)$，其中 $\\lambda$ 表示强碰撞阻尼率，$S(t)$ 是一个外部驱动。考虑 $\\lambda = 10^{6}$ 和 $S(t) = \\sin(t)$ 的情况，这代表了在隐式时间积分中离散化磁流体动力学 (MHD) 时经常遇到的刚性源项。为处理刚性问题，使用时间步长恒为 $\\Delta t = 10^{-2}$ 的后向欧拉法。\n\n从导数的定义和后向欧拉法所基于的隐式离散化原理出发，推导在时间 $t_{n+1} = t_n + \\Delta t$ 时 $y_{n+1}$ 关于 $y_n$ 和 $t_{n+1}$ 的代数更新方程。然后，构建以 $y_{n+1}$ 为根的非线性残差 $R(y)$ 并计算其雅可比矩阵。以初始猜测值 $y^{(0)} = y_n$ 执行一次牛顿-拉夫逊方法的迭代，并使用 $\\Delta t = 10^{-2}$ 简化所得表达式。\n\n将您的最终答案表示为单步牛顿迭代值 $y^{(1)}$ 关于 $y_n$ 和 $t_{n+1}$ 的单个闭式解析表达式。无需进行数值四舍五入，最终表达式中也不要包含单位。",
            "solution": "首先验证问题以确保其科学上合理、适定且所有必要信息均已提供。\n\n### 步骤 1：提取已知条件\n- **控制常微分方程**：$y'(t) = f(t,y) = -\\lambda y(t) + S(t)$\n- **阻尼率**：$\\lambda = 10^{6}$\n- **外部驱动**：$S(t) = \\sin(t)$\n- **数值方法**：后向欧拉法\n- **时间步长**：$\\Delta t = 10^{-2}$\n- **任务**：推导 $y_{n+1}$ 的更新方程，构建残差 $R(y)$ 及其雅可比矩阵 $J(y)$，并以初始猜测值 $y^{(0)} = y_n$ 执行一次牛顿-拉夫逊迭代以求得 $y^{(1)}$。$y^{(1)}$ 的最终表达式应以 $y_n$ 和 $t_{n+1}$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了一个标准的刚性常微分方程，这是等离子体物理学中一个简化但具有代表性的模型。使用后向欧拉法处理刚性问题以及使用牛顿-拉夫逊法求解得到的隐式方程，是数值分析和计算科学中标准且成熟的技术。该问题是适定的，所有必要的参数（$\\lambda$、$\\Delta t$）和条件（初始猜测值 $y^{(0)}=y_n$）都已指明。术语精确，目标明确。没有矛盾、歧义或事实错误。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将推导完整解。\n\n### 推导\n问题要求我们使用隐式后向欧拉法求解刚性常微分方程 (ODE) $y'(t) = -\\lambda y(t) + \\sin(t)$。\n\n对于常微分方程 $y'(t) = f(t, y(t))$，后向欧拉法的一般形式由以下离散化给出：\n$$ \\frac{y_{n+1} - y_n}{\\Delta t} = f(t_{n+1}, y_{n+1}) $$\n其中 $y_n \\approx y(t_n)$，$y_{n+1} \\approx y(t_{n+1})$，且 $t_{n+1} = t_n + \\Delta t$。\n\n对于给定的常微分方程，右侧的函数为 $f(t, y) = -\\lambda y + \\sin(t)$。应用后向欧拉格式，我们得到：\n$$ \\frac{y_{n+1} - y_n}{\\Delta t} = -\\lambda y_{n+1} + \\sin(t_{n+1}) $$\n这是一个关于未知数 $y_{n+1}$ 的隐式代数方程。\n\n问题要求我们使用牛顿-拉夫逊法来解这个方程。首先，我们构建残差函数 $R(y)$，其根为 $y_{n+1}$。我们将方程重排为 $R(y_{n+1}) = 0$ 的形式。令 $y$ 为我们要求解的变量，在根处它将等于 $y_{n+1}$。\n$$ R(y) = y - y_n - \\Delta t(-\\lambda y + \\sin(t_{n+1})) $$\n展开此表达式得到残差：\n$$ R(y) = y - y_n + \\lambda \\Delta t y - \\Delta t \\sin(t_{n+1}) $$\n$$ R(y) = (1 + \\lambda \\Delta t)y - y_n - \\Delta t \\sin(t_{n+1}) $$\n\n接下来，我们计算残差的雅可比矩阵 $J(y)$，对于一个标量函数，它就是该函数对 $y$ 的导数：\n$$ J(y) = \\frac{dR}{dy} $$\n$$ J(y) = \\frac{d}{dy} \\left[ (1 + \\lambda \\Delta t)y - y_n - \\Delta t \\sin(t_{n+1}) \\right] $$\n由于在求解第 $(n+1)$ 步的 $y$ 时，$y_n$ 和 $t_{n+1}$ 是常数，因此导数为：\n$$ J(y) = 1 + \\lambda \\Delta t $$\n注意，因为原始常微分方程对 $y$ 是线性的，所以残差 $R(y)$ 对 $y$ 也是线性的，其雅可比矩阵是一个与 $y$ 无关的常数。\n\n用于寻找 $R(y)$ 根的牛顿-拉夫逊更新公式为：\n$$ y^{(k+1)} = y^{(k)} - [J(y^{(k)})]^{-1} R(y^{(k)}) $$\n对于我们的标量问题，这简化为：\n$$ y^{(k+1)} = y^{(k)} - \\frac{R(y^{(k)})}{J(y^{(k)})} $$\n我们被要求从初始猜测值 $y^{(0)} = y_n$ 开始执行一次迭代。第一次迭代的结果 $y^{(1)}$ 为：\n$$ y^{(1)} = y^{(0)} - \\frac{R(y^{(0)})}{J(y^{(0)})} = y_n - \\frac{R(y_n)}{J(y_n)} $$\n我们在 $y=y_n$ 处计算残差 $R(y)$ 的值：\n$$ R(y_n) = (1 + \\lambda \\Delta t)y_n - y_n - \\Delta t \\sin(t_{n+1}) = \\lambda \\Delta t y_n - \\Delta t \\sin(t_{n+1}) $$\n雅可比矩阵是常数：$J(y_n) = 1 + \\lambda \\Delta t$。\n将这些表达式代入 $y^{(1)}$ 的公式中：\n$$ y^{(1)} = y_n - \\frac{\\lambda \\Delta t y_n - \\Delta t \\sin(t_{n+1})}{1 + \\lambda \\Delta t} $$\n为了简化，我们通分：\n$$ y^{(1)} = \\frac{y_n (1 + \\lambda \\Delta t) - (\\lambda \\Delta t y_n - \\Delta t \\sin(t_{n+1}))}{1 + \\lambda \\Delta t} $$\n$$ y^{(1)} = \\frac{y_n + \\lambda \\Delta t y_n - \\lambda \\Delta t y_n + \\Delta t \\sin(t_{n+1})}{1 + \\lambda \\Delta t} $$\n包含 $\\lambda \\Delta t y_n$ 的项相互抵消，得到：\n$$ y^{(1)} = \\frac{y_n + \\Delta t \\sin(t_{n+1})}{1 + \\lambda \\Delta t} $$\n因为残差函数 $R(y)$ 是线性的，牛顿-拉夫逊法在单次迭代中收敛。因此，$y^{(1)}$ 是后向欧拉步骤中 $y_{n+1}$ 的精确解。\n\n最后，我们代入给定的数值：$\\lambda = 10^6$ 和 $\\Delta t = 10^{-2}$。\n$$ \\lambda \\Delta t = 10^6 \\times 10^{-2} = 10^4 $$\n分母变为 $1 + \\lambda \\Delta t = 1 + 10^4 = 10001$。\n那么 $y^{(1)}$ 的表达式为：\n$$ y^{(1)} = \\frac{y_n + 10^{-2} \\sin(t_{n+1})}{10001} $$\n这就是单步牛顿迭代值 $y^{(1)}$ 关于 $y_n$ 和 $t_{n+1}$ 的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{y_n + 10^{-2} \\sin(t_{n+1})}{10001}}\n$$"
        },
        {
            "introduction": "在解决了单个常微分方程之后，我们将视野扩展到更具普遍性的偏微分方程。通过空间离散化（例如，使用有限差分法），一个偏微分方程可以被转化为一个大型的耦合常微分方程组。本练习将Crank-Nicolson方法应用于热传导方程，演示了如何构建在每个时间步都必须求解的三对角线性系统。这是计算物理中求解隐式格式的一个经典且高效的实践 。",
            "id": "3992805",
            "problem": "考虑将一维热传导作为面向等离子体部件中跨场热扩散的模型，该过程由扩散方程 $u_t = \\nu u_{xx}$ 建模，其中 $u(x,t)$ 是温度，$\\nu$ 是热扩散系数，下标表示偏导数。假设在有限区间上存在一个间距为 $h$ 的均匀网格，并且在两个端点处施加齐次狄利克雷边界条件。使用 Crank–Nicolson 方法，即对半离散演化方程在时间上应用梯形法则，并在空间上使用中心二阶有限差分，推导出将内部节点值从时间 $t^n$ 推进到 $t^{n+1} = t^n + \\Delta t$ 所需的线性系统。您的推导必须从时间导数和中心二阶差分的定义，以及时间上的梯形数值积分法则出发，不得假设任何预先推导出的格式。请清晰地分离出所得三对角系统左侧对应于时间 $t^{n+1}$ 处未知内部值的系数，并用 $\\nu$、$h$ 和 $\\Delta t$ 表示这些系数。\n\n就本问题而言，请只关注作用于时间 $t^{n+1}$ 处内部未知数的左侧三对角矩阵（即次对角线、主对角线和超对角线）。假设采用齐次狄利克雷边界条件，因此左侧系数在所有内部节点上是空间常数。\n\n您需要实现一个程序，给定 $(\\nu, h, \\Delta t)$，计算内部方程的三对角矩阵的三个不同系数，顺序为：次对角线、主对角线、超对角线。这些系数是无单位的。将每个系数表示为四舍五入到六位小数的小数。\n\n测试套件：\n为下列参数集提供结果，每个参数集以（$\\nu$ 单位为 $\\mathrm{m^2/s}$，$h$ 单位为 $\\mathrm{m}$，$\\Delta t$ 单位为 $\\mathrm{s}$）的形式给出：\n- 情况 A: $(\\nu, h, \\Delta t) = (1.0, 0.2, 0.01)$。\n- 情况 B: $(\\nu, h, \\Delta t) = (0.0, 0.1, 1.0)$。\n- 情况 C: $(\\nu, h, \\Delta t) = (0.01, 0.005, 1.0)$。\n- 情况 D: $(\\nu, h, \\Delta t) = (1.0, 0.1, 10^{-6})$。\n- 情况 E: $(\\nu, h, \\Delta t) = (5.0, 0.03, 0.7)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，格式为列表的列表，每个内部列表对应一个情况，按 A 到 E 的顺序排列。每个内部列表必须包含三个系数，顺序为 [次对角线, 主对角线, 超对角线]，每个系数四舍五入到六位小数，且输出中任何地方都不能有空格。例如，包含两个情况的输出应如下所示：$[[a_1,b_1,c_1],[a_2,b_2,c_2]]$，其中每个 $a_i$、$b_i$、$c_i$ 都是六位小数。在本问题中，您必须以所描述的精确格式在一行上输出五个情况的结果。",
            "solution": "该问题要求推导出一维热方程 $u_t = \\nu u_{xx}$ 经过 Crank–Nicolson 离散化后产生的线性系统隐式部分的系数。推导过程必须从基本定义出发。\n\n控制偏微分方程 (PDE) 是热扩散方程：\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\n其中，$u(x,t)$ 是温度，$\\nu$ 是热扩散系数，$x$ 是空间坐标，$t$ 是时间坐标。\n\n我们在空间和时间上引入一个离散网格。设 $x_j = j h$ 为空间网格点，其中 $h$ 是均匀网格间距；设 $t^n = n \\Delta t$ 为时间层，其中 $\\Delta t$ 是时间步长。在网格点 $(x_j, t^n)$ 处的温度值记为 $u_j^n \\approx u(x_j, t^n)$。\n\n在内部空间节点 $x_j$ 处，空间二阶导数 $\\frac{\\partial^2 u}{\\partial x^2}$ 使用二阶中心有限差分公式近似：\n$$\n\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x=x_j} \\approx \\frac{u_{j-1} - 2u_j + u_{j+1}}{h^2}\n$$\n将此应用于每个内部节点 $j$ 上的偏微分方程，得到一个常微分方程组 (ODEs)，这种方法被称为直线法：\n$$\n\\frac{du_j(t)}{dt} = \\nu \\frac{u_{j-1}(t) - 2u_j(t) + u_{j+1}(t)}{h^2}\n$$\n\n接下来，我们使用 Crank–Nicolson 方法在时间上进行离散化，这等效于对时间积分应用梯形法则。对于一个形如 $\\frac{dy}{dt} = f(y, t)$ 的一般常微分方程，从时间 $t^n$ 推进到 $t^{n+1}$ 的梯形法则是：\n$$\n\\frac{y^{n+1} - y^n}{\\Delta t} = \\frac{1}{2} \\left[ f(y^n, t^n) + f(y^{n+1}, t^{n+1}) \\right]\n$$\n\n将此法则应用于我们的半离散化热方程，我们将 $y_j$ 等同于 $u_j$，将 $f(u_j, t)$ 等同于半离散方程的右侧。结果如下：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{1}{2} \\left( \\nu \\frac{u_{j-1}^n - 2u_j^n + u_{j+1}^n}{h^2} + \\nu \\frac{u_{j-1}^{n+1} - 2u_j^{n+1} + u_{j+1}^{n+1}}{h^2} \\right)\n$$\n该方程将时间 $t^{n+1}$ 处的未知值（在右侧）与时间 $t^n$ 处的已知值耦合在一起。为了构建关于未知数的线性系统，我们必须重排方程，将所有时间层 $n+1$ 的项组合到左侧 (LHS)，并将所有时间层 $n$ 的项组合到右侧 (RHS)。\n\n首先，两边同乘以 $\\Delta t$：\n$$\nu_j^{n+1} - u_j^n = \\frac{\\nu \\Delta t}{2h^2} \\left( u_{j-1}^n - 2u_j^n + u_{j+1}^n \\right) + \\frac{\\nu \\Delta t}{2h^2} \\left( u_{j-1}^{n+1} - 2u_j^{n+1} + u_{j+1}^{n+1} \\right)\n$$\n\n现在，我们将所有上标为 $n+1$ 的项移到左侧：\n$$\nu_j^{n+1} - \\frac{\\nu \\Delta t}{2h^2} u_{j-1}^{n+1} - \\frac{\\nu \\Delta t}{2h^2} (-2u_j^{n+1}) - \\frac{\\nu \\Delta t}{2h^2} u_{j+1}^{n+1} = u_j^n + \\frac{\\nu \\Delta t}{2h^2} \\left( u_{j-1}^n - 2u_j^n + u_{j+1}^n \\right)\n$$\n\n我们可以按空间索引 $(j-1, j, j+1)$ 对左侧的项进行分组，以揭示线性系统的结构：\n$$\n\\left(-\\frac{\\nu \\Delta t}{2h^2}\\right) u_{j-1}^{n+1} + \\left(1 + \\frac{2\\nu \\Delta t}{2h^2}\\right) u_j^{n+1} + \\left(-\\frac{\\nu \\Delta t}{2h^2}\\right) u_{j+1}^{n+1} = \\text{RHS}\n$$\n\n化简 $u_j^{n+1}$ 项的系数，得到节点 $j$ 的线性方程的最终形式：\n$$\n\\left(-\\frac{\\nu \\Delta t}{2h^2}\\right) u_{j-1}^{n+1} + \\left(1 + \\frac{\\nu \\Delta t}{h^2}\\right) u_j^{n+1} + \\left(-\\frac{\\nu \\Delta t}{2h^2}\\right) u_{j+1}^{n+1} = \\text{RHS}\n$$\n\n该方程代表了三对角线性系统 $A \\mathbf{u}^{n+1} = \\mathbf{b}$ 的一行，其中 $\\mathbf{u}^{n+1}$ 是时间 $t^{n+1}$ 处未知内部节点值的向量。问题要求的是构成左侧三对角矩阵 $A$ 的三个不同系数。因为假设了齐次狄利克雷边界条件，并且系数 $\\nu$、$h$ 和 $\\Delta t$ 是常数，所以这三个值对于矩阵的所有内部行都是常数。\n\n这些系数是：\n1.  **次对角线系数** ($u_{j-1}^{n+1}$ 的系数): $c_{sub} = -\\frac{\\nu \\Delta t}{2h^2}$\n2.  **主对角线系数** ($u_j^{n+1}$ 的系数): $c_{main} = 1 + \\frac{\\nu \\Delta t}{h^2}$\n3.  **超对角线系数** ($u_{j+1}^{n+1}$ 的系数): $c_{super} = -\\frac{\\nu \\Delta t}{2h^2}$\n\n以下程序使用这些表达式来计算给定测试用例的数值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Crank-Nicolson LHS coefficients for 1D heat diffusion.\n    \"\"\"\n    \n    # Test cases as tuples of (nu, h, dt).\n    test_cases = [\n        (1.0, 0.2, 0.01),      # Case A\n        (0.0, 0.1, 1.0),       # Case B\n        (0.01, 0.005, 1.0),    # Case C\n        (1.0, 0.1, 1e-6),      # Case D\n        (5.0, 0.03, 0.7),      # Case E\n    ]\n    \n    # A list to store the formatted string for each case's results.\n    results_str_list = []\n    \n    for case in test_cases:\n        nu, h, dt = case\n        \n        # Avoid division by zero if h is zero, although not in test cases.\n        if h == 0.0:\n            # This case is physically ill-defined, but for robustness:\n            # Assigning infinity or NaN might be alternatives.\n            # Using very large numbers to signify singularity.\n            r_val = np.inf\n        else:\n            # Calculate the dimensionless diffusion number parameter\n            r_val = nu * dt / (h**2)\n            \n        # The problem defines the equation as u_t = nu * u_xx.\n        # The Crank-Nicolson scheme is:\n        # (I - (nu*dt/2) * D_xx) * u^{n+1} = (I + (nu*dt/2) * D_xx) * u^n\n        # where D_xx is the finite difference operator (1/h^2)*[1, -2, 1].\n        # For a row j, the LHS is:\n        # -(nu*dt / (2*h^2)) * u_{j-1}^{n+1} + (1 + nu*dt / h^2) * u_j^{n+1} - (nu*dt / (2*h^2)) * u_{j+1}^{n+1}\n\n        # Coefficient of u_{j-1}^{n+1} (sub-diagonal)\n        sub_diag = -r_val / 2.0\n        \n        # Coefficient of u_j^{n+1} (main-diagonal)\n        main_diag = 1.0 + r_val\n        \n        # Coefficient of u_{j+1}^{n+1} (super-diagonal)\n        super_diag = -r_val / 2.0\n        \n        # Format the result list for this case into a string with no spaces,\n        # with each number rounded to six decimal places.\n        case_str = f\"[{sub_diag:.6f},{main_diag:.6f},{super_diag:.6f}]\"\n        results_str_list.append(case_str)\n        \n    # Join all case strings with commas and enclose in brackets\n    # to match the final required output format.\n    final_output = f\"[[{','.join(results_str_list)}]]\"\n    \n    print(final_output)\n\n# Execute the solver function\nsolve()\n```"
        },
        {
            "introduction": "成功实现一个数值方法仅仅是第一步，更重要的是要深入理解其内在属性，以便在复杂问题中做出明智的选择。本练习将从执行转向分析，使用放大因子这一强大工具来研究Crank-Nicolson方法的稳定性和耗散特性。通过这个分析，你将揭示一个关键的、非直观的特性：尽管该方法无条件稳定，但它对刚性扩散模的阻尼效果很差，可能导致非物理的数值振荡。这个练习旨在阐明稳定性与有效阻尼之间的重要区别 。",
            "id": "3992877",
            "problem": "考虑高温磁化聚变等离子体中沿单条磁力线的平行电子热传导，其模型为长度为 $L$ 的周期性区域上的一维扩散。电子温度 $T(x,t)$ 遵循线性扩散方程 $ \\partial T / \\partial t = \\chi \\, \\partial^{2} T / \\partial x^{2} $，其中 $\\chi > 0$ 是（恒定的）平行热扩散系数。对于波数为 $k = 2 \\pi m / L$（$m$为整数）的单个傅里叶模式 $T(x,t) = \\hat{T}(t) \\exp(i k x)$，空间算子简化为本征值问题，得到常微分方程 $ d \\hat{T} / d t = \\lambda \\, \\hat{T} $，其中 $\\lambda = - \\chi k^{2}$。\n\n一种隐式梯形时间积分方法，也称为 Crank-Nicolson (CN) 方法，通过对 $t^{n}$ 和 $t^{n+1}$ 之间的右侧项进行平均，将时间 $t^{n}$ 的模式振幅 $\\hat{T}^{n}$ 更新到时间 $t^{n+1} = t^{n} + \\Delta t$ 的 $\\hat{T}^{n+1}$。定义无量纲步长 $z = \\lambda \\, \\Delta t$。从线性常微分方程的梯形法则的基本定义出发，推导此线性模式的 CN 放大因子 $G(z)$，其中 $G(z) = \\hat{T}^{n+1} / \\hat{T}^{n}$。然后，分析验证 CN 方法对于纯虚数 $z$ 表现出零数值耗散，即对于任意实数 $\\beta$，都有 $|G(i \\beta)| = 1$。并解释这对于处理聚变相关模拟中扩散动力学的刚性问题有何影响，在这些模拟中，高波数模式会使 $|z|$ 变得很大且为负。\n\n将最终结果表示为 $G(z)$ 的闭式表达式。无需进行数值计算。无需四舍五入。最终表达式中不包含任何单位。",
            "solution": "该问题陈述清晰，具有科学依据，并包含了完整求解所需的所有信息。它描述了将 Crank-Nicolson 数值方法应用于线性扩散方程的标准分析，这是计算科学中的一个基本课题。我们将按要求进行推导和分析。\n\n分析分为三个部分：首先，推导放大因子 $G(z)$；其次，验证其在纯虚数参数下的模；第三，解释其对模拟刚性系统的影响。\n\n**第 1 部分：放大因子 $G(z)$ 的推导**\n\n我们从控制单个傅里叶模式振幅 $\\hat{T}(t)$ 时间演化的常微分方程（ODE）开始：\n$$\n\\frac{d \\hat{T}}{d t} = \\lambda \\hat{T}\n$$\n其中 $\\lambda = -\\chi k^2$ 是与波数为 $k$ 的空间模式相关的本征值。\n\n隐式梯形法则，即 Crank-Nicolson (CN) 方法，将此常微分方程在时间上离散化。新时间步的值 $\\hat{T}^{n+1}$ 与旧时间步的值 $\\hat{T}^{n}$ 相关，其关系通过在区间 $[t^n, t^{n+1}]$ 的中点近似时间导数，并将右侧项计算为其在 $t^n$ 和 $t^{n+1}$ 处值的平均值得到。对于一般的常微分方程 $\\frac{dy}{dt} = f(y)$，其格式为：\n$$\n\\frac{y^{n+1} - y^{n}}{\\Delta t} = \\frac{1}{2} \\left[ f(y^{n}) + f(y^{n+1}) \\right]\n$$\n在我们的具体情况下，$y = \\hat{T}$ 且函数是线性的，$f(\\hat{T}) = \\lambda \\hat{T}$。将其代入通用形式可得：\n$$\n\\frac{\\hat{T}^{n+1} - \\hat{T}^{n}}{\\Delta t} = \\frac{1}{2} \\left[ \\lambda \\hat{T}^{n} + \\lambda \\hat{T}^{n+1} \\right]\n$$\n这个方程是关于 $\\hat{T}^{n+1}$ 的隐式方程，因此我们必须重排它以求解 $\\hat{T}^{n+1}$。\n$$\n\\hat{T}^{n+1} - \\hat{T}^{n} = \\frac{\\lambda \\Delta t}{2} \\left( \\hat{T}^{n} + \\hat{T}^{n+1} \\right)\n$$\n我们将包含 $\\hat{T}^{n+1}$ 的项归到左侧，将包含 $\\hat{T}^{n}$ 的项归到右侧：\n$$\n\\hat{T}^{n+1} - \\frac{\\lambda \\Delta t}{2} \\hat{T}^{n+1} = \\hat{T}^{n} + \\frac{\\lambda \\Delta t}{2} \\hat{T}^{n}\n$$\n提出公因子 $\\hat{T}^{n+1}$ 和 $\\hat{T}^{n}$：\n$$\n\\hat{T}^{n+1} \\left( 1 - \\frac{\\lambda \\Delta t}{2} \\right) = \\hat{T}^{n} \\left( 1 + \\frac{\\lambda \\Delta t}{2} \\right)\n$$\n放大因子 $G$ 定义为比率 $G = \\hat{T}^{n+1} / \\hat{T}^{n}$。求解该比率可得：\n$$\nG = \\frac{1 + \\frac{\\lambda \\Delta t}{2}}{1 - \\frac{\\lambda \\Delta t}{2}}\n$$\n问题定义了无量纲参数 $z = \\lambda \\Delta t$。代入此定义，我们得到放大因子的最终表达式：\n$$\nG(z) = \\frac{1 + \\frac{z}{2}}{1 - \\frac{z}{2}}\n$$\n\n**第 2 部分：$|G(i \\beta)| = 1$ 的验证**\n\n我们需要验证对于纯虚数参数 $z = i \\beta$（其中 $\\beta$ 是任意实数），放大因子的模恰好为 1。这个性质是纯振荡（非耗散）系统能量守恒格式的特征。我们将 $z=i\\beta$ 代入 $G(z)$ 的表达式中：\n$$\nG(i\\beta) = \\frac{1 + \\frac{i\\beta}{2}}{1 - \\frac{i\\beta}{2}}\n$$\n复数之比的模等于它们的模之比。一个复数 $a + ib$ 的模为 $|a+ib| = \\sqrt{a^2 + b^2}$。\n$$\n|G(i\\beta)| = \\frac{\\left| 1 + i\\frac{\\beta}{2} \\right|}{\\left| 1 - i\\frac{\\beta}{2} \\right|}\n$$\n分子的模为：\n$$\n\\left| 1 + i\\frac{\\beta}{2} \\right| = \\sqrt{1^2 + \\left(\\frac{\\beta}{2}\\right)^2} = \\sqrt{1 + \\frac{\\beta^2}{4}}\n$$\n分母的模为：\n$$\n\\left| 1 - i\\frac{\\beta}{2} \\right| = \\sqrt{1^2 + \\left(-\\frac{\\beta}{2}\\right)^2} = \\sqrt{1 + \\frac{\\beta^2}{4}}\n$$\n由于分子和分母的模相同，它们的比值为 $1$：\n$$\n|G(i\\beta)| = \\frac{\\sqrt{1 + \\frac{\\beta^2}{4}}}{\\sqrt{1 + \\frac{\\beta^2}{4}}} = 1\n$$\n这从分析上证实了对于任何本征值 $\\lambda$ 为纯虚数的系统，Crank-Nicolson 方法都是完全非耗散的。\n\n**第 3 部分：对刚性处理的影响**\n\n在给定的扩散问题背景下，刚性源于不同傅里叶模式相关的衰减时间尺度的巨大差异。波数为 $k$ 的模式的衰减时间为 $\\tau_k = 1/|\\lambda| = 1/(\\chi k^2)$。高波数（短波长）模式具有非常短的衰减时间（快动力学），而低波数（长波长）模式具有很长的衰减时间（慢动力学）。数值方法必须能够处理这种差异。\n\n对于扩散问题，本征值为 $\\lambda = -\\chi k^2$，它是一个非正实数。因此，无量纲步长 $z = \\lambda \\Delta t = -(\\chi k^2) \\Delta t \\le 0$。如果对于所有这样的 $z$，都有 $|G(z)| \\le 1$，则数值格式是稳定的。对于实数 $z \\le 0$ 的 CN 方法：\n$$\n|G(z)| = \\left| \\frac{1 + z/2}{1 - z/2} \\right|\n$$\n因为 $z \\le 0$，分母 $1 - z/2$ 总是 $\\ge 1$。分子 $1+z/2$ 可以是正数或负数。然而，很容易证明对于所有 $z \\le 0$，都有 $|1+z/2| \\le |1-z/2|$，这意味着 $|G(z)| \\le 1$。该格式对于扩散问题是无条件稳定的，也称为 A-稳定。这是处理刚性问题的一个主要优点，因为它允许根据慢速、物理相关的模式的精度要求来选择时间步长 $\\Delta t$，而不受最快的、通常未解析模式的稳定性极限的限制。\n\n然而，性质 $|G(i\\beta)|=1$ 对刚性扩散动力学有关键影响。这个性质意味着 CN 方法将连续系统的稳定性边界（虚轴，$\\text{Re}(z)=0$）精确地映射到离散系统的稳定性边界（单位圆，$|G|=1$）。对于一个非常刚性的扩散模式，波数 $k$ 很大，使得 $|\\lambda|$ 非常大。如果使用大的时间步长 $\\Delta t$，参数 $z = -\\chi k^2 \\Delta t$ 就会成为一个绝对值非常大的负数，即 $z \\to -\\infty$。\n\n我们来考察 $G(z)$ 在此极限下的行为：\n$$\n\\lim_{z \\to -\\infty} G(z) = \\lim_{z \\to -\\infty} \\frac{1 + z/2}{1 - z/2} = \\lim_{z \\to -\\infty} \\frac{z(1/z + 1/2)}{z(1/z - 1/2)} = \\frac{1/2}{-1/2} = -1\n$$\n这意味着对于非常刚性的分量，数值解不会衰减；相反，它在每个时间步都会反转符号：$\\hat{T}^{n+1} \\approx -\\hat{T}^n$。虽然这种行为是稳定的（模不增长），但它未能像物理上应该的那样衰减高频模式。这些刚性模式中的能量以不物理的高频振荡（通常称为“振铃”）形式持续存在，这会破坏整体解的准确性。对于刚性耗散分量，理想的行为是当 $z \\to -\\infty$ 时 $|G(z)| \\to 0$（这一性质称为 L-稳定性），这样可以迅速将它们衰减掉。\n\n总而言之，性质 $|G(i\\beta)|=1$ 使得 CN 方法非常适用于非耗散波动现象，但这也直接导致了其对刚性扩散模式的衰减效果不佳。无条件稳定性允许使用大的时间步长，但代价是会因未衰减的刚性分量而引入伪数值振荡。这种权衡是为多尺度聚变等离子体模拟选择隐式积分器时的核心考虑因素。",
            "answer": "$$\n\\boxed{\\frac{1 + \\frac{z}{2}}{1 - \\frac{z}{2}}}\n$$"
        }
    ]
}