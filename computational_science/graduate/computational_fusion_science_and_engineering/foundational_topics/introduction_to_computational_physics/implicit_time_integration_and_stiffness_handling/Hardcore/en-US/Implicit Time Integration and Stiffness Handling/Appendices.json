{
    "hands_on_practices": [
        {
            "introduction": "To effectively handle the extreme timescale separation in stiff systems, we must turn to implicit methods. This first practice demonstrates the core mechanics of this process using the Backward Euler method on a representative stiff ODE. You will see how an implicit step transforms the differential equation into an algebraic root-finding problem and then apply the workhorse of nonlinear solvers, the Newton-Raphson method, to find the solution at the next time step. ",
            "id": "3992852",
            "problem": "In a lumped zero-dimensional model of resistive relaxation in a fusion plasma energy balance, a linearized perturbation amplitude $y(t)$ obeys the scalar Ordinary Differential Equation (ODE) $y'(t) = f(t,y) = -\\lambda y(t) + S(t)$, where $\\lambda$ represents a strong collisional damping rate and $S(t)$ is an external drive. Consider the case $\\lambda = 10^{6}$ and $S(t) = \\sin(t)$, which is representative of a stiff source term often encountered when discretizing Magnetohydrodynamics (MHD) in implicit time integration. To handle stiffness, use the Backward Euler method with constant time step $\\Delta t = 10^{-2}$.\n\nStarting from the definition of the derivative and the implicit discretization principle underlying Backward Euler, derive the algebraic update equation for $y_{n+1}$ at time $t_{n+1} = t_n + \\Delta t$ in terms of $y_n$ and $t_{n+1}$. Then, formulate the nonlinear residual $R(y)$ whose root is $y_{n+1}$ and compute its Jacobian. Perform one iteration of the Newton–Raphson method starting from the initial guess $y^{(0)} = y_n$ and simplify the resulting expression using $\\Delta t = 10^{-2}$. \n\nExpress your final answer as a single closed-form analytic expression for the one-step Newton iterate $y^{(1)}$ in terms of $y_n$ and $t_{n+1}$. No numerical rounding is required, and do not include units in your final expression.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and all necessary information is provided.\n\n### Step 1: Extract Givens\n- **Governing ODE**: $y'(t) = f(t,y) = -\\lambda y(t) + S(t)$\n- **Damping Rate**: $\\lambda = 10^{6}$\n- **External Drive**: $S(t) = \\sin(t)$\n- **Numerical Method**: Backward Euler\n- **Time Step**: $\\Delta t = 10^{-2}$\n- **Task**: Derive the update equation for $y_{n+1}$, formulate the residual $R(y)$ and its Jacobian $J(y)$, and perform one Newton-Raphson iteration with initial guess $y^{(0)} = y_n$ to find $y^{(1)}$. The final expression for $y^{(1)}$ should be in terms of $y_n$ and $t_{n+1}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a standard stiff ordinary differential equation which is a simplified but representative model in plasma physics. The use of Backward Euler for stiff problems and Newton-Raphson for solving the resulting implicit equation are standard, well-established techniques in numerical analysis and computational science. The problem is well-posed, with all necessary parameters ($\\lambda$, $\\Delta t$) and conditions (initial guess $y^{(0)}=y_n$) specified. The terminology is precise and the objectives are clear. There are no contradictions, ambiguities, or factual errors.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be derived.\n\n### Derivation\nThe problem requires us to solve the stiff ordinary differential equation (ODE) $y'(t) = -\\lambda y(t) + \\sin(t)$ using the implicit Backward Euler method.\n\nThe general form of the Backward Euler method for an ODE $y'(t) = f(t, y(t))$ is given by the discretization:\n$$ \\frac{y_{n+1} - y_n}{\\Delta t} = f(t_{n+1}, y_{n+1}) $$\nwhere $y_n \\approx y(t_n)$, $y_{n+1} \\approx y(t_{n+1})$, and $t_{n+1} = t_n + \\Delta t$.\n\nFor the given ODE, the function on the right-hand side is $f(t, y) = -\\lambda y + \\sin(t)$. Applying the Backward Euler scheme, we get:\n$$ \\frac{y_{n+1} - y_n}{\\Delta t} = -\\lambda y_{n+1} + \\sin(t_{n+1}) $$\nThis is an implicit algebraic equation for the unknown $y_{n+1}$.\n\nThe problem requires us to solve this equation using the Newton-Raphson method. First, we formulate the residual function, $R(y)$, whose root is $y_{n+1}$. We rearrange the equation into the form $R(y_{n+1}) = 0$. Let $y$ be the variable we are solving for, which will be equal to $y_{n+1}$ at the root.\n$$ R(y) = y - y_n - \\Delta t(-\\lambda y + \\sin(t_{n+1})) $$\nExpanding this expression gives the residual:\n$$ R(y) = y - y_n + \\lambda \\Delta t y - \\Delta t \\sin(t_{n+1}) $$\n$$ R(y) = (1 + \\lambda \\Delta t)y - y_n - \\Delta t \\sin(t_{n+1}) $$\n\nNext, we compute the Jacobian of the residual, $J(y)$, which for a scalar function is its derivative with respect to $y$:\n$$ J(y) = \\frac{dR}{dy} $$\n$$ J(y) = \\frac{d}{dy} \\left[ (1 + \\lambda \\Delta t)y - y_n - \\Delta t \\sin(t_{n+1}) \\right] $$\nSince $y_n$ and $t_{n+1}$ are constants in the context of solving for $y$ at the $(n+1)$-th step, the derivative is:\n$$ J(y) = 1 + \\lambda \\Delta t $$\nNote that because the original ODE is linear in $y$, the residual $R(y)$ is linear in $y$, and its Jacobian is a constant, independent of $y$.\n\nThe Newton-Raphson update formula for finding the root of $R(y)$ is:\n$$ y^{(k+1)} = y^{(k)} - [J(y^{(k)})]^{-1} R(y^{(k)}) $$\nFor our scalar problem, this simplifies to:\n$$ y^{(k+1)} = y^{(k)} - \\frac{R(y^{(k)})}{J(y^{(k)})} $$\nWe are asked to perform one iteration starting with the initial guess $y^{(0)} = y_n$. The first iterate, $y^{(1)}$, is:\n$$ y^{(1)} = y^{(0)} - \\frac{R(y^{(0)})}{J(y^{(0)})} = y_n - \\frac{R(y_n)}{J(y_n)} $$\nWe evaluate the residual $R(y)$ at $y=y_n$:\n$$ R(y_n) = (1 + \\lambda \\Delta t)y_n - y_n - \\Delta t \\sin(t_{n+1}) = \\lambda \\Delta t y_n - \\Delta t \\sin(t_{n+1}) $$\nThe Jacobian is constant: $J(y_n) = 1 + \\lambda \\Delta t$.\nSubstituting these expressions into the formula for $y^{(1)}$:\n$$ y^{(1)} = y_n - \\frac{\\lambda \\Delta t y_n - \\Delta t \\sin(t_{n+1})}{1 + \\lambda \\Delta t} $$\nTo simplify, we find a common denominator:\n$$ y^{(1)} = \\frac{y_n (1 + \\lambda \\Delta t) - (\\lambda \\Delta t y_n - \\Delta t \\sin(t_{n+1}))}{1 + \\lambda \\Delta t} $$\n$$ y^{(1)} = \\frac{y_n + \\lambda \\Delta t y_n - \\lambda \\Delta t y_n + \\Delta t \\sin(t_{n+1})}{1 + \\lambda \\Delta t} $$\nThe terms involving $\\lambda \\Delta t y_n$ cancel out, yielding:\n$$ y^{(1)} = \\frac{y_n + \\Delta t \\sin(t_{n+1})}{1 + \\lambda \\Delta t} $$\nBecause the residual function $R(y)$ is linear, the Newton-Raphson method converges in a single iteration. Therefore, $y^{(1)}$ is the exact solution for $y_{n+1}$ in the Backward Euler step.\n\nFinally, we substitute the given numerical values: $\\lambda = 10^6$ and $\\Delta t = 10^{-2}$.\n$$ \\lambda \\Delta t = 10^6 \\times 10^{-2} = 10^4 $$\nThe denominator becomes $1 + \\lambda \\Delta t = 1 + 10^4 = 10001$.\nThe expression for $y^{(1)}$ is then:\n$$ y^{(1)} = \\frac{y_n + 10^{-2} \\sin(t_{n+1})}{10001} $$\nThis is the final closed-form analytic expression for the one-step Newton iterate $y^{(1)}$ in terms of $y_n$ and $t_{n+1}$.",
            "answer": "$$\n\\boxed{\\frac{y_n + 10^{-2} \\sin(t_{n+1})}{10001}}\n$$"
        },
        {
            "introduction": "While stability is paramount for stiff integrators, not all stable methods behave the same. This practice moves to the second-order accurate Crank-Nicolson method to explore the subtleties of numerical stability and dissipation through Fourier analysis. By deriving the method's amplification factor, you will uncover why it can produce unphysical oscillations in stiff diffusive problems despite being unconditionally stable, a critical lesson in selecting the right tool for the job. ",
            "id": "3992877",
            "problem": "Consider parallel electron heat conduction in a high-temperature magnetized fusion plasma along a single magnetic field line, modeled as one-dimensional diffusion on a periodic domain of length $L$. The electron temperature $T(x,t)$ obeys the linear diffusion equation $ \\partial T / \\partial t = \\chi \\, \\partial^{2} T / \\partial x^{2} $, where $\\chi  0$ is the (constant) parallel thermal diffusivity. For a single Fourier mode $T(x,t) = \\hat{T}(t) \\exp(i k x)$ with wavenumber $k = 2 \\pi m / L$ (integer $m$), the spatial operator reduces to an eigenvalue problem, giving the ordinary differential equation $ d \\hat{T} / d t = \\lambda \\, \\hat{T} $ with $\\lambda = - \\chi k^{2}$.\n\nAn implicit trapezoidal time integration, also known as the Crank–Nicolson (CN) method, updates the mode amplitude $\\hat{T}^{n}$ at time $t^{n}$ to $\\hat{T}^{n+1}$ at time $t^{n+1} = t^{n} + \\Delta t$ by averaging the right-hand side between $t^{n}$ and $t^{n+1}$. Define the non-dimensional step $z = \\lambda \\, \\Delta t$. Derive the CN amplification factor $G(z)$ for this linear mode, where $G(z) = \\hat{T}^{n+1} / \\hat{T}^{n}$, starting from the fundamental definition of the trapezoidal rule for linear ordinary differential equations. Then, verify analytically that the CN method exhibits zero numerical dissipation for purely imaginary $z$ in the sense that $|G(i \\beta)| = 1$ for any real $\\beta$, and explain the implications this has for stiffness handling of diffusive dynamics in fusion-relevant simulations where high-wavenumber modes make $|z|$ large and negative.\n\nExpress the final result as the closed-form expression for $G(z)$. No numerical evaluation is required. No rounding is required. Do not include any units in your final expression.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a complete solution. It describes a standard analysis of the Crank-Nicolson numerical method applied to a linear diffusion equation, a fundamental topic in computational science. We shall proceed with the derivation and analysis as requested.\n\nThe analysis is divided into three parts: first, the derivation of the amplification factor $G(z)$; second, the verification of its magnitude for a purely imaginary argument; and third, an explanation of the implications for simulating stiff systems.\n\n**Part 1: Derivation of the Amplification Factor $G(z)$**\n\nWe begin with the ordinary differential equation (ODE) governing the time evolution of a single Fourier mode amplitude, $\\hat{T}(t)$:\n$$\n\\frac{d \\hat{T}}{d t} = \\lambda \\hat{T}\n$$\nwhere $\\lambda = -\\chi k^2$ is the eigenvalue associated with the spatial mode of wavenumber $k$.\n\nThe implicit trapezoidal rule, or Crank-Nicolson (CN) method, discretizes this ODE in time. The value at the new time step, $\\hat{T}^{n+1}$, is related to the value at the old time step, $\\hat{T}^{n}$, by approximating the time derivative at the midpoint of the interval $[t^n, t^{n+1}]$ and evaluating the right-hand side as the average of its values at $t^n$ and $t^{n+1}$. For a general ODE $\\frac{dy}{dt} = f(y)$, the scheme is:\n$$\n\\frac{y^{n+1} - y^{n}}{\\Delta t} = \\frac{1}{2} \\left[ f(y^{n}) + f(y^{n+1}) \\right]\n$$\nIn our specific case, $y = \\hat{T}$ and the function is linear, $f(\\hat{T}) = \\lambda \\hat{T}$. Substituting this into the general form gives:\n$$\n\\frac{\\hat{T}^{n+1} - \\hat{T}^{n}}{\\Delta t} = \\frac{1}{2} \\left[ \\lambda \\hat{T}^{n} + \\lambda \\hat{T}^{n+1} \\right]\n$$\nThis equation is implicit in $\\hat{T}^{n+1}$, so we must rearrange it to solve for $\\hat{T}^{n+1}$.\n$$\n\\hat{T}^{n+1} - \\hat{T}^{n} = \\frac{\\lambda \\Delta t}{2} \\left( \\hat{T}^{n} + \\hat{T}^{n+1} \\right)\n$$\nWe group terms involving $\\hat{T}^{n+1}$ on the left-hand side and terms involving $\\hat{T}^{n}$ on the right-hand side:\n$$\n\\hat{T}^{n+1} - \\frac{\\lambda \\Delta t}{2} \\hat{T}^{n+1} = \\hat{T}^{n} + \\frac{\\lambda \\Delta t}{2} \\hat{T}^{n}\n$$\nFactoring out $\\hat{T}^{n+1}$ and $\\hat{T}^{n}$:\n$$\n\\hat{T}^{n+1} \\left( 1 - \\frac{\\lambda \\Delta t}{2} \\right) = \\hat{T}^{n} \\left( 1 + \\frac{\\lambda \\Delta t}{2} \\right)\n$$\nThe amplification factor $G$ is defined as the ratio $G = \\hat{T}^{n+1} / \\hat{T}^{n}$. Solving for this ratio yields:\n$$\nG = \\frac{1 + \\frac{\\lambda \\Delta t}{2}}{1 - \\frac{\\lambda \\Delta t}{2}}\n$$\nThe problem defines the non-dimensional parameter $z = \\lambda \\Delta t$. Substituting this definition, we obtain the final expression for the amplification factor:\n$$\nG(z) = \\frac{1 + \\frac{z}{2}}{1 - \\frac{z}{2}}\n$$\n\n**Part 2: Verification of $|G(i \\beta)| = 1$**\n\nWe are asked to verify that for a purely imaginary argument $z = i \\beta$, where $\\beta$ is any real number, the magnitude of the amplification factor is exactly unity. This property is characteristic of a scheme that conserves energy for purely oscillatory (non-dissipative) systems. Let's substitute $z=i\\beta$ into the expression for $G(z)$:\n$$\nG(i\\beta) = \\frac{1 + \\frac{i\\beta}{2}}{1 - \\frac{i\\beta}{2}}\n$$\nThe magnitude of a ratio of complex numbers is the ratio of their magnitudes. The magnitude of a complex number $a + ib$ is $|a+ib| = \\sqrt{a^2 + b^2}$.\n$$\n|G(i\\beta)| = \\frac{\\left| 1 + i\\frac{\\beta}{2} \\right|}{\\left| 1 - i\\frac{\\beta}{2} \\right|}\n$$\nThe magnitude of the numerator is:\n$$\n\\left| 1 + i\\frac{\\beta}{2} \\right| = \\sqrt{1^2 + \\left(\\frac{\\beta}{2}\\right)^2} = \\sqrt{1 + \\frac{\\beta^2}{4}}\n$$\nThe magnitude of the denominator is:\n$$\n\\left| 1 - i\\frac{\\beta}{2} \\right| = \\sqrt{1^2 + \\left(-\\frac{\\beta}{2}\\right)^2} = \\sqrt{1 + \\frac{\\beta^2}{4}}\n$$\nSince the numerator and the denominator have the same magnitude, their ratio is $1$:\n$$\n|G(i\\beta)| = \\frac{\\sqrt{1 + \\frac{\\beta^2}{4}}}{\\sqrt{1 + \\frac{\\beta^2}{4}}} = 1\n$$\nThis confirms analytically that the Crank-Nicolson method is perfectly non-dissipative for any system where the eigenvalues $\\lambda$ are purely imaginary.\n\n**Part 3: Implications for Stiffness Handling**\n\nStiffness in the context of the given diffusion problem arises from the wide separation of decay timescales associated with different Fourier modes. The decay time for a mode with wavenumber $k$ is $\\tau_k = 1/|\\lambda| = 1/(\\chi k^2)$. High-wavenumber (short wavelength) modes have very short decay times (fast dynamics), while low-wavenumber (long wavelength) modes have long decay times (slow dynamics). A numerical method must be able to handle this disparity.\n\nFor the diffusion problem, the eigenvalue is $\\lambda = -\\chi k^2$, which is real and non-positive. Therefore, the non-dimensional step is $z = \\lambda \\Delta t = -(\\chi k^2) \\Delta t \\le 0$. A numerical scheme is stable if $|G(z)| \\le 1$ for all such $z$. For the CN method with real $z \\le 0$:\n$$\n|G(z)| = \\left| \\frac{1 + z/2}{1 - z/2} \\right|\n$$\nSince $z \\le 0$, the denominator $1 - z/2$ is always $\\ge 1$. The numerator $1+z/2$ can be positive or negative. However, it is straightforward to show that $|1+z/2| \\le |1-z/2|$ for all $z \\le 0$, which means $|G(z)| \\le 1$. The scheme is unconditionally stable for diffusion, also known as A-stable. This is a primary advantage for stiff problems, as it allows the time step $\\Delta t$ to be chosen based on the accuracy requirements of the slow, physically relevant modes, rather than being restricted by the stability limit of the fastest, often unresolved modes.\n\nHowever, the property $|G(i\\beta)|=1$ has a critical consequence for stiff diffusive dynamics. This property implies that the CN method maps the stability boundary of the continuous system (the imaginary axis, $\\text{Re}(z)=0$) exactly onto the stability boundary of the discrete system (the unit circle, $|G|=1$). For a very stiff diffusive mode, the wavenumber $k$ is large, making $|\\lambda|$ very large. If a large time step $\\Delta t$ is used, the parameter $z = -\\chi k^2 \\Delta t$ becomes a negative number with very large magnitude, i.e., $z \\to -\\infty$.\n\nLet's examine the behavior of $G(z)$ in this limit:\n$$\n\\lim_{z \\to -\\infty} G(z) = \\lim_{z \\to -\\infty} \\frac{1 + z/2}{1 - z/2} = \\lim_{z \\to -\\infty} \\frac{z(1/z + 1/2)}{z(1/z - 1/2)} = \\frac{1/2}{-1/2} = -1\n$$\nThis means that for very stiff components, the numerical solution does not decay; instead, it flips its sign at each time step: $\\hat{T}^{n+1} \\approx -\\hat{T}^n$. While this behavior is stable (the magnitude does not grow), it fails to damp the high-frequency modes as they should be physically. The energy in these stiff modes persists as unphysical, high-frequency oscillations (often called \"ringing\"), which can corrupt the accuracy of the overall solution. The ideal behavior for stiff dissipative components is for $|G(z)| \\to 0$ as $z \\to -\\infty$ (a property known as L-stability), which would rapidly damp them out.\n\nIn summary, the property $|G(i\\beta)|=1$, which makes the CN method excellent for non-dissipative wave phenomena, is directly responsible for its poor damping of stiff diffusive modes. The unconditional stability allows for large time steps, but this comes at the cost of introducing spurious numerical oscillations from the undamped stiff components. This trade-off is a central consideration in choosing an implicit integrator for multiscale fusion plasma simulations.",
            "answer": "$$\n\\boxed{\\frac{1 + \\frac{z}{2}}{1 - \\frac{z}{2}}}\n$$"
        },
        {
            "introduction": "The true power of implicit methods is realized when solving partial differential equations (PDEs) that model physical phenomena like heat diffusion. This final practice bridges theory and application by asking you to apply the Crank-Nicolson scheme to a spatially discretized 1D heat equation. Your task is to derive the structure of the resulting linear system, revealing how the implicit time step couples all spatial points together into a matrix equation that must be solved, a fundamental concept in computational physics. ",
            "id": "3992805",
            "problem": "Consider one-dimensional heat conduction as a model of cross-field thermal diffusion in a plasma-facing component, modeled by the diffusion equation $u_t = \\nu u_{xx}$, where $u(x,t)$ is temperature, $\\nu$ is the thermal diffusivity, and subscripts denote partial derivatives. Assume a uniform grid with spacing $h$ on a finite interval and homogeneous Dirichlet boundary conditions at the two endpoints. Using the Crank–Nicolson method, which is the trapezoidal rule in time applied to the semi-discrete evolution and a centered second-order finite difference in space, derive the linear system to advance the interior nodal values from time $t^n$ to time $t^{n+1} = t^n + \\Delta t$. Your derivation must start from the definition of the time derivative and the centered second difference, and from the trapezoidal numerical integration rule in time, without assuming any pre-derived scheme. Clearly isolate the coefficients of the resulting tridiagonal system on the left-hand side for the unknown interior values at time $t^{n+1}$, and express these coefficients in terms of $\\nu$, $h$, and $\\Delta t$.\n\nFor the purposes of this problem, focus exclusively on the left-hand side tridiagonal matrix acting on the interior unknowns at time $t^{n+1}$ (the sub-diagonal, main diagonal, and super-diagonal). Assume homogeneous Dirichlet boundary conditions so that the left-hand side coefficients are spatially constant across interior nodes.\n\nYou are to implement a program that, given $(\\nu, h, \\Delta t)$, computes the three distinct coefficients of the tridiagonal matrix for the interior equations in the order: sub-diagonal, main diagonal, super-diagonal. The coefficients are unitless. Express each coefficient as a decimal rounded to six decimal places.\n\nTest Suite:\nProvide results for the following parameter sets, each given as $(\\nu\\ \\mathrm{in\\ m^2/s},\\ h\\ \\mathrm{in\\ m},\\ \\Delta t\\ \\mathrm{in\\ s})$:\n- Case A: $(\\nu, h, \\Delta t) = (1.0, 0.2, 0.01)$.\n- Case B: $(\\nu, h, \\Delta t) = (0.0, 0.1, 1.0)$.\n- Case C: $(\\nu, h, \\Delta t) = (0.01, 0.005, 1.0)$.\n- Case D: $(\\nu, h, \\Delta t) = (1.0, 0.1, $10^{-6}$).\n- Case E: $(\\nu, h, \\Delta t) = (5.0, 0.03, 0.7)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a list of lists, one inner list per case, in the order A through E. Each inner list must be the three coefficients in the order [sub-diagonal, main-diagonal, super-diagonal], each rounded to six decimal places, and there must be no spaces anywhere in the output. For example, an output with two cases would look like $[[a_1,b_1,c_1],[a_2,b_2,c_2]]$ where each $a_i$, $b_i$, $c_i$ is a decimal with six places. In this problem you must output the five-case result on one line in the exact format described.",
            "solution": "The problem requires the derivation of the coefficients of the implicit part of the linear system arising from the Crank–Nicolson discretization of the one-dimensional heat equation, $u_t = \\nu u_{xx}$. The derivation must proceed from fundamental definitions.\n\nThe governing partial differential equation (PDE) is the heat diffusion equation:\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\nHere, $u(x,t)$ is the temperature, $\\nu$ is the thermal diffusivity, $x$ is the spatial coordinate, and $t$ is the time coordinate.\n\nWe introduce a discrete grid in space and time. Let $x_j = j h$ be the spatial grid points, where $h$ is the uniform grid spacing, and $t^n = n \\Delta t$ be the time levels, where $\\Delta t$ is the time step. The value of the temperature at a grid point $(x_j, t^n)$ is denoted by $u_j^n \\approx u(x_j, t^n)$.\n\nThe second spatial derivative, $\\frac{\\partial^2 u}{\\partial x^2}$, at an interior spatial node $x_j$ is approximated using a second-order centered finite difference formula:\n$$\n\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x=x_j} \\approx \\frac{u_{j-1} - 2u_j + u_{j+1}}{h^2}\n$$\nApplying this to the PDE at each interior node $j$ gives a system of ordinary differential equations (ODEs), a method known as the method of lines:\n$$\n\\frac{du_j(t)}{dt} = \\nu \\frac{u_{j-1}(t) - 2u_j(t) + u_{j+1}(t)}{h^2}\n$$\n\nNext, we discretize in time using the Crank–Nicolson method, which is equivalent to applying the trapezoidal rule to the time integration. For a generic ODE of the form $\\frac{dy}{dt} = f(y, t)$, the trapezoidal rule to advance from time $t^n$ to $t^{n+1}$ is:\n$$\n\\frac{y^{n+1} - y^n}{\\Delta t} = \\frac{1}{2} \\left[ f(y^n, t^n) + f(y^{n+1}, t^{n+1}) \\right]\n$$\n\nApplying this rule to our semi-discretized heat equation, we identify $y_j$ with $u_j$ and $f(u_j, t)$ with the right-hand side of the semi-discrete equation. This results in:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{1}{2} \\left( \\nu \\frac{u_{j-1}^n - 2u_j^n + u_{j+1}^n}{h^2} + \\nu \\frac{u_{j-1}^{n+1} - 2u_j^{n+1} + u_{j+1}^{n+1}}{h^2} \\right)\n$$\nThis equation couples the unknown values at time $t^{n+1}$ (on the right) with the known values at time $t^n$. To form the linear system for the unknowns, we must rearrange the equation to group all terms at time level $n+1$ on the left-hand side (LHS) and all terms at time level $n$ on the right-hand side (RHS).\n\nFirst, multiply both sides by $\\Delta t$:\n$$\nu_j^{n+1} - u_j^n = \\frac{\\nu \\Delta t}{2h^2} \\left( u_{j-1}^n - 2u_j^n + u_{j+1}^n \\right) + \\frac{\\nu \\Delta t}{2h^2} \\left( u_{j-1}^{n+1} - 2u_j^{n+1} + u_{j+1}^{n+1} \\right)\n$$\n\nNow, we move all terms with the superscript $n+1$ to the LHS:\n$$\nu_j^{n+1} - \\frac{\\nu \\Delta t}{2h^2} u_{j-1}^{n+1} - \\frac{\\nu \\Delta t}{2h^2} (-2u_j^{n+1}) - \\frac{\\nu \\Delta t}{2h^2} u_{j+1}^{n+1} = u_j^n + \\frac{\\nu \\Delta t}{2h^2} \\left( u_{j-1}^n - 2u_j^n + u_{j+1}^n \\right)\n$$\n\nWe can group the terms on the LHS by their spatial indices $(j-1, j, j+1)$ to reveal the structure of the linear system:\n$$\n\\left(-\\frac{\\nu \\Delta t}{2h^2}\\right) u_{j-1}^{n+1} + \\left(1 + \\frac{2\\nu \\Delta t}{2h^2}\\right) u_j^{n+1} + \\left(-\\frac{\\nu \\Delta t}{2h^2}\\right) u_{j+1}^{n+1} = \\text{RHS}\n$$\n\nSimplifying the coefficient of the $u_j^{n+1}$ term gives the final form of the linear equation for node $j$:\n$$\n\\left(-\\frac{\\nu \\Delta t}{2h^2}\\right) u_{j-1}^{n+1} + \\left(1 + \\frac{\\nu \\Delta t}{h^2}\\right) u_j^{n+1} + \\left(-\\frac{\\nu \\Delta t}{2h^2}\\right) u_{j+1}^{n+1} = \\text{RHS}\n$$\n\nThis equation represents one row of a tridiagonal linear system $A \\mathbf{u}^{n+1} = \\mathbf{b}$, where $\\mathbf{u}^{n+1}$ is the vector of unknown interior nodal values at time $t^{n+1}$. The problem asks for the three distinct coefficients forming the tridiagonal matrix $A$ on the LHS. Because homogeneous Dirichlet boundary conditions are assumed and the coefficients $\\nu$, $h$, and $\\Delta t$ are constant, these three values are constant for all interior rows of the matrix.\n\nThe coefficients are:\n1.  **Sub-diagonal coefficient** (coefficient of $u_{j-1}^{n+1}$): $c_{sub} = -\\frac{\\nu \\Delta t}{2h^2}$\n2.  **Main diagonal coefficient** (coefficient of $u_j^{n+1}$): $c_{main} = 1 + \\frac{\\nu \\Delta t}{h^2}$\n3.  **Super-diagonal coefficient** (coefficient of $u_{j+1}^{n+1}$): $c_{super} = -\\frac{\\nu \\Delta t}{2h^2}$\n\nThese expressions are used in the following program to compute the numerical values for the given test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Crank-Nicolson LHS coefficients for 1D heat diffusion.\n    \"\"\"\n    \n    # Test cases as tuples of (nu, h, dt).\n    test_cases = [\n        (1.0, 0.2, 0.01),      # Case A\n        (0.0, 0.1, 1.0),       # Case B\n        (0.01, 0.005, 1.0),    # Case C\n        (1.0, 0.1, 1e-6),      # Case D\n        (5.0, 0.03, 0.7),      # Case E\n    ]\n    \n    # A list to store the formatted string for each case's results.\n    results_list = []\n    \n    for case in test_cases:\n        nu, h, dt = case\n        \n        # Avoid division by zero if h is zero, although not in test cases.\n        if h == 0.0:\n            r_val = np.inf\n        else:\n            # Calculate the dimensionless diffusion number parameter\n            r_val = nu * dt / (h**2)\n            \n        # The problem defines the equation as u_t = nu * u_xx.\n        # The Crank-Nicolson scheme is:\n        # (I - (nu*dt/2) * D_xx) * u^{n+1} = (I + (nu*dt/2) * D_xx) * u^n\n        # where D_xx is the finite difference operator (1/h^2)*[1, -2, 1].\n        # For a row j, the LHS is:\n        # -(nu*dt / (2*h^2)) * u_{j-1}^{n+1} + (1 + nu*dt / h^2) * u_j^{n+1} - (nu*dt / (2*h^2)) * u_{j+1}^{n+1}\n\n        # Coefficient of u_{j-1}^{n+1} (sub-diagonal)\n        sub_diag = -r_val / 2.0\n        \n        # Coefficient of u_j^{n+1} (main-diagonal)\n        main_diag = 1.0 + r_val\n        \n        # Coefficient of u_{j+1}^{n+1} (super-diagonal)\n        super_diag = -r_val / 2.0\n        \n        # Append the list of coefficients to the results list.\n        results_list.append([round(sub_diag, 6), round(main_diag, 6), round(super_diag, 6)])\n\n    # Format the final output string according to the problem specification.\n    # The format is a list of lists, with no spaces.\n    # Ex: [[-0.125000,1.250000,-0.125000],...]\n    output_str_parts = []\n    for res in results_list:\n        output_str_parts.append(f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f}]\")\n    \n    final_output = f\"[{','.join(output_str_parts)}]\"\n    print(final_output)\n\n# The expected output string from the execution of the code is:\n# [[-0.125000,1.250000,-0.125000],[0.000000,1.000000,0.000000],[-200.000000,401.000000,-200.000000],[-0.000050,1.000100,-0.000050],[-1944.444444,3889.888889,-1944.444444]]\n```"
        }
    ]
}