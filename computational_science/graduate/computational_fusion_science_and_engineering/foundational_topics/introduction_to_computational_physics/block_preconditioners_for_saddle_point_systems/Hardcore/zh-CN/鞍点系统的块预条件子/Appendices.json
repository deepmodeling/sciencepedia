{
    "hands_on_practices": [
        {
            "introduction": "鞍点系统预处理的核心在于有效近似舒尔补算子。这个练习从一个最简化的标量块模型入手，帮助你推导舒尔补的基本形式。通过分析当 $(1,1)$ 块趋于奇异时系统的行为，你将亲身体会到为何简单的预处理策略会失效，并理解构建鲁棒预处理器的关键挑战。",
            "id": "3954742",
            "problem": "在用于磁约束聚变的磁流体动力学平衡与稳定性计算中，同时施加平衡方程和约束（如无散条件）的混合格式会产生鞍点线性系统。考虑经过单次空间自由度约化后得到的线性系统，该约化保留了鞍点结构，\n$$\n\\begin{pmatrix}\nA  B^{\\top} \\\\\nB  -C\n\\end{pmatrix}\n\\begin{pmatrix}\nu \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf \\\\\ng\n\\end{pmatrix},\n$$\n其中 $A$ 是对称正定矩阵，$C$ 是对称半正定矩阵，$B$ 代表离散约束耦合。为了分析目的，我们关注标量块情形，即 $A=a0$，$B=b$，$C=c\\ge 0$，且右端项 $f$ 和 $g$ 是任意的。仅使用分块消元作为基本工具，消去 $u$ 以获得拉格朗日乘子 $\\lambda$ 的约化方程，并将约化算子（舒尔补）$S$ 确定为 $a$、$b$ 和 $c$ 的显式函数。\n\n然后，使用此约化算子，通过从分块消元和谱等价的基本原理出发进行论证，分析在固定 $b\\neq 0$ 和 $c\\ge 0$ 的情况下 $a\\to 0^{+}$ 的极限。说明这对一个仅用 $c$ 来代替约化算子（即忽略了由 $B A^{-1} B^{\\top}$ 产生的耦合贡献）的分块预条件子的质量意味着什么。解释这种极限影响数值行为的机制，特别地，说明约化方程的尺度变化以及在实践中对预条件迭代的影响。\n\n将你的最终报告答案表示为约化算子 $S$ 关于 $a$、$b$ 和 $c$ 的单个闭式符号表达式。不需要进行数值计算，也不需要单位。最终答案框中不要包含任何定性分析；所有讨论都应出现在你的解题文本中。",
            "solution": "该问题陈述完全有效。它在数值线性代数领域提出了一个明确定义的问题，具体涉及在科学计算（包括计算聚变科学背景下）中普遍存在的鞍点系统的分析。该问题是自洽的、数学上一致的、且有科学依据的。我们可以开始求解。\n\n问题始于一个一般的鞍点线性系统：\n$$\n\\begin{pmatrix}\nA  B^{\\top} \\\\\nB  -C\n\\end{pmatrix}\n\\begin{pmatrix}\nu \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf \\\\\ng\n\\end{pmatrix}\n$$\n这个矩阵方程代表了一个由两个耦合线性方程组成的系统：\n$$\n(1) \\quad Au + B^{\\top}\\lambda = f \\\\\n(2) \\quad Bu - C\\lambda = g\n$$\n变量是向量 $u$ 和 $\\lambda$。矩阵 $A$、$B$ 和 $C$ 以及向量 $f$ 和 $g$ 是给定的。我们已知 $A$ 是对称正定的（$A=A^{\\top}, A0$），这保证了其逆矩阵 $A^{-1}$ 存在。矩阵 $C$ 是对称半正定的（$C=C^{\\top}, C \\ge 0$）。\n\n核心任务是使用分块消元来推导拉格朗日乘子变量 $\\lambda$ 的约化方程。为此，我们首先从方程 $(1)$ 中解出 $u$：\n$$\nAu = f - B^{\\top}\\lambda\n$$\n从左侧乘以 $A^{-1}$ 得到 $u$ 关于 $\\lambda$ 的表达式：\n$$\nu = A^{-1}(f - B^{\\top}\\lambda)\n$$\n接下来，我们将这个 $u$ 的表达式代入方程 $(2)$：\n$$\nB \\left( A^{-1}(f - B^{\\top}\\lambda) \\right) - C\\lambda = g\n$$\n我们将矩阵 $B$ 分配到括号内的项上：\n$$\nB A^{-1}f - B A^{-1}B^{\\top}\\lambda - C\\lambda = g\n$$\n现在，我们重排方程，将包含 $\\lambda$ 的项分离到一侧。习惯上将它们放在左侧：\n$$\n- B A^{-1}B^{\\top}\\lambda - C\\lambda = g - B A^{-1}f\n$$\n在左侧提出公因子 $-\\lambda$ 可得：\n$$\n- (C + B A^{-1}B^{\\top})\\lambda = g - B A^{-1}f\n$$\n最后，两边乘以 $-1$ 得到关于 $\\lambda$ 的约化方程：\n$$\n(C + B A^{-1}B^{\\top})\\lambda = B A^{-1}f - g\n$$\n该方程形如 $S\\lambda = \\tilde{g}$，其中算子 $S = C + B A^{-1}B^{\\top}$ 被称为原始系统矩阵中 $(1,1)$ 块 $A$ 的舒尔补（取决于约定，可能相差一个符号；这里我们将其定义为在约化系统中作用于 $\\lambda$ 的算子）。\n\n对于要求分析的特定标量块情形，我们有 $A=a0$，$B=b$ 和 $C=c\\ge 0$。由于 $B$ 是一个标量，所以 $B^{\\top}=b$。$A$ 的逆是 $A^{-1}=a^{-1}=\\frac{1}{a}$。将这些标量代入约化算子 $S$ 的一般表达式可得：\n$$\nS = c + b(a^{-1})b = c + \\frac{b^2}{a}\n$$\n这个表达式就是标量块情形下的约化算子。\n\n问题的第二部分要求分析在 $b\\neq 0$ 和 $c\\ge 0$ 保持固定的情况下 $a\\to 0^{+}$ 的极限。在此极限下，舒尔补变为：\n$$\n\\lim_{a\\to 0^{+}} S = \\lim_{a\\to 0^{+}} \\left( c + \\frac{b^2}{a} \\right)\n$$\n由于 $b\\neq 0$，所以 $b^2  0$。当 $a$ 从正方向趋近于 $0$ 时，项 $\\frac{b^2}{a}$ 无界增长。因此，$S \\to +\\infty$。\n\n这对数值方法，特别是预条件处理，具有深远的影响。我们被要求考虑一个用块 $C$（在标量情形下为 $c$）来近似舒尔补 $S$ 的预条件子。我们用 $P_C = C$ 表示该预条件子。对于标量情况，$P_c = c$。预条件子的有效性通常通过分析预条件算子 $P_c^{-1}S$ 的谱（在标量情况下即其值）来评估。为了使预条件共轭梯度法等迭代方法快速收敛，预条件算子的特征值应聚集在 $1$ 附近。\n\n假设 $c0$，因此 $P_c$ 是可逆的。预条件算子为：\n$$\nP_c^{-1}S = c^{-1} \\left( c + \\frac{b^2}{a} \\right) = 1 + \\frac{b^2}{ac}\n$$\n当我们取极限 $a\\to 0^{+}$ 时，这个值会发散：\n$$\n\\lim_{a\\to 0^{+}} \\left( 1 + \\frac{b^2}{ac} \\right) \\to +\\infty\n$$\n这表明预条件算子是无界的。在更一般的矩阵情况下，这将表现为 $P_C^{-1}S$ 的最大特征值趋于无穷大。因此，预条件系统的条件数 $\\kappa(P_C^{-1}S)$ 将会发散，表明预条件子发生了灾难性的失效。随着 $a\\to 0^{+}$，克雷洛夫子空间方法所需的迭代次数将无界增长。\n\n这种失效的机制从 $S = C + B A^{-1} B^{\\top}$ 的结构中可以清楚地看出。极限 $a\\to 0^{+}$（在矩阵情况下，即 $A$ 变为奇异或高度病态）是一个奇异极限。在此极限下，$B A^{-1} B^{\\top}$ 项在算子 $S$ 中占主导地位。预条件子 $P_C = C$ 完全忽略了这一主导贡献。在物理上，涉及 $A$ 的项通常代表一种正则化，其消失（$a \\to 0^{+}$）意味着由 $B$ 代表的约束的加强。由于算子 $S$ 变得非常大，约化系统变得病态。任何旨在在该极限下有效的预条件子*必须*为整个舒尔补（包括 $B A^{-1} B^{\\top}$ 项）提供一个良好的近似。仅使用 $C$ 是不够的，并在实践中会导致迭代求解过程的完全崩溃。这凸显了预处理鞍点系统的一个基本原则：舒尔补的预条件子必须尊重原始矩阵不同块之间的耦合，特别是在奇异或近奇异极限下。",
            "answer": "$$\n\\boxed{c + \\frac{b^2}{a}}\n$$"
        },
        {
            "introduction": "一个真正鲁棒的预处理器必须能适应问题的物理参数变化。本练习将抽象的鞍点系统与磁化等离子体动力学这一具体物理情境相结合，指导你进行量纲分析。通过推导出一个能平衡惯性力和洛伦兹力的压力尺度，你将学会如何通过无量纲化来构建在不同物理区间内都表现稳健的“基于物理的”预处理器。",
            "id": "3954701",
            "problem": "考虑一个用于聚变相关装置中磁化等离子体的线性化电阻磁流体力学 (MHD) 动量平衡的混合速度-压力格式，该格式在空间上进行离散化后，得到如下鞍点系统\n$$\n\\begin{pmatrix}\nA  B^{\\top} \\\\\nB  -C\n\\end{pmatrix}\n\\begin{pmatrix}\nu \\\\\np\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf \\\\\ng\n\\end{pmatrix},\n$$\n其中，$u$ 是等离子体速度，$p$ 是热力学压力。算子 $A$ 来自线性惯性、粘性和线性化洛伦兹力耦合之和，$B^{\\top}$ 表示压力到动量的弱梯度耦合，$B$ 表示连续性方程中的弱散度，而 $C$ 表示压力空间中的压缩性或稳定性。假设其底层连续介质模型由动量平衡和质量守恒构建：\n$$\n\\rho \\frac{\\partial u}{\\partial t} - \\nabla \\cdot (2 \\mu D(u)) + \\nabla p - \\frac{1}{\\mu_0}(\\nabla \\times B) \\times B = f_{\\mathrm{body}}, \\quad \\nabla \\cdot u = s_{\\mathrm{m}},\n$$\n其中 $\\rho$ 是质量密度，$\\mu$ 是动力粘度，$D(u)$ 是应变率张量，$B$ 是磁场，$\\mu_0$ 是真空磁导率，$f_{\\mathrm{body}}$ 是体积力密度，$s_{\\mathrm{m}}$ 是给定的质量源。设特征尺度为 $L$（长度）、$U$（速度）、$T = L/U$（时间）、$\\rho_0$（密度）、$B_0$（磁场）、$\\mu$（粘度），以及一个待定的未知压力标度 $P_0$。在国际单位制（SI）下进行计算。\n\n任务：\n1.  运用基本原理和SI基本单位一致性，进行量纲和单位分析，以确定离散算子 $A$、$B$ 和 $C$ 元素的单位，并将它们解释为与上述方程弱形式一致的映射。\n2.  引入无量纲变量 $\\tilde{x} = x/L$、$\\tilde{t} = t/T$、$\\tilde{u} = u/U$、$\\tilde{p} = p/P_0$ 和 $\\tilde{B} = B/B_0$，并使用连续介质动量方程的标度分析来确定惯性项、压力梯度项、粘性项和洛伦兹力项的典型量级。\n3.  施加要求：当无量纲速度、压力和磁场均为一阶（量级为1）时，无量纲压力梯度项的量级应与惯性项和洛伦兹力项的组合量级处于同一主导阶。根据此要求，推导压力标度 $P_0$ 关于 $\\rho_0$、$U$、$B_0$ 和 $\\mu_0$ 的显式表达式。\n4.  基于所得的无量纲化，解释典范块对角预条件子 $K = \\mathrm{diag}(A_0, S_0)$（其中 $S_0$ 是 $B A^{-1} B^{\\top} + C$ 的近似）如何能保持良好标度，即在无需计算任何范数的情况下，标度后块的光谱在跨越惯性、粘性和磁主导流动的区域内均保持为一阶（量级为1）。\n5.  以单个闭式解析表达式的形式，报告无量纲压力标度因子 $\\gamma := P_0 / (\\rho_0 U^2)$。无需四舍五入，最终报告的表达式必须是无量纲的。最终表达式不带单位。",
            "solution": "用户提供了一个来自计算科学与工程领域的有效且适定的问题陈述。我将继续提供完整解答。该问题要求对一个由线性化电阻磁流体力学（MHD）方程离散化产生的鞍点系统进行多部分分析。\n\n### 步骤1：问题验证\n我已根据指定标准对问题陈述进行了验证。\n\n- **提取的已知条件**：\n    - 离散鞍点系统为 $\\begin{pmatrix} A  B^{\\top} \\\\ B  -C \\end{pmatrix} \\begin{pmatrix} u \\\\ p \\end{pmatrix} = \\begin{pmatrix} f \\\\ g \\end{pmatrix}$。\n    - 变量为等离子体速度 $u$ 和压力 $p$。\n    - 算子为 $A$（惯性、粘性、洛伦兹）、$B^{\\top}$（弱梯度）、$B$（弱散度）和 $C$（压缩性/稳定性）。\n    - 底层连续介质方程为动量平衡方程 $\\rho \\frac{\\partial u}{\\partial t} - \\nabla \\cdot (2 \\mu D(u)) + \\nabla p - \\frac{1}{\\mu_0}(\\nabla \\times B) \\times B = f_{\\mathrm{body}}$ 和质量守恒方程 $\\nabla \\cdot u = s_{\\mathrm{m}}$。\n    - 参数包括密度 $\\rho$、动力粘度 $\\mu$、应变率张量 $D(u)$、磁场 $B$、磁导率 $\\mu_0$、体积力 $f_{\\mathrm{body}}$ 和质量源 $s_{\\mathrm{m}}$。\n    - 特征尺度为 $L$（长度）、$U$（速度）、$T=L/U$（时间）、$\\rho_0$（密度）、$B_0$（磁场）、$\\mu$（粘度）和 $P_0$（压力）。\n    - 无量纲变量为 $\\tilde{x} = x/L$、$\\tilde{t} = t/T$、$\\tilde{u} = u/U$、$\\tilde{p} = p/P_0$ 和 $\\tilde{B} = B/B_0$。\n- **验证结论**：该问题在MHD理论和数值线性代数方面有科学依据，问题适定且目标明确，并使用了精确、客观的语言。它与指定主题直接相关，内容自洽，并提出了一个非平凡但可解的挑战。因此，该问题被判定为**有效**。\n\n### 任务1：离散算子 $A$、$B$ 和 $C$ 的单位\n\n为了确定矩阵元素的单位，我们将矩阵方程解释为由有限元或有限体积离散化产生的节点平衡方程。在这种情况下，离散向量 $u$ 和 $p$ 代表速度场和压力场系数的集合（例如，节点值），而右端项向量 $f$ 和 $g$ 代表离散源。\n\n系统的第一行 $A u + B^{\\top} p = f$ 代表离散动量平衡。项 $f$ 来自体积力的弱形式，$f_i \\approx \\int \\phi_i f_{\\mathrm{body}} dV$，其中 $\\phi_i$ 是一个基函数。假设基函数是无量纲的，则 $f$ 元素的单位是力的单位（N）。令 $[X]$ 表示量 $X$ 的单位。\n$$[f] = [\\text{力}] = \\text{牛顿} = \\text{N} = \\text{kg} \\cdot \\text{m} \\cdot \\text{s}^{-2}$$\n离散向量 $u$ 代表速度，所以 $[u] = \\text{m} \\cdot \\text{s}^{-1}$。离散向量 $p$ 代表压力，所以 $[p] = \\text{帕斯卡} = \\text{Pa} = \\text{N} \\cdot \\text{m}^{-2} = \\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}$。\n为了使方程 $A u + B^{\\top} p = f$ 在量纲上一致，每一项都必须具有力的单位。\n对于项 $Au$：\n$$[A][u] = [f] \\implies [A] \\cdot (\\text{m} \\cdot \\text{s}^{-1}) = \\text{kg} \\cdot \\text{m} \\cdot \\text{s}^{-2}$$\n$$[A] = \\frac{\\text{kg} \\cdot \\text{m} \\cdot \\text{s}^{-2}}{\\text{m} \\cdot \\text{s}^{-1}} = \\text{kg} \\cdot \\text{s}^{-1}$$\n对于项 $B^{\\top}p$：\n$$[B^{\\top}][p] = [f] \\implies [B^{\\top}] \\cdot (\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}) = \\text{kg} \\cdot \\text{m} \\cdot \\text{s}^{-2}$$\n$$[B^{\\top}] = \\frac{\\text{kg} \\cdot \\text{m} \\cdot \\text{s}^{-2}}{\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}} = \\text{m}^2$$\n由于 $B^{\\top}$ 是 $B$ 的转置，所以 $B$ 元素的单位也是 $[B] = \\text{m}^2$。\n\n第二行 $Bu - Cp = g$ 代表离散连续性方程。项 $g$ 来自质量源的弱形式，$g_i \\approx \\int \\psi_i s_{\\mathrm{m}} dV$。连续介质方程 $\\nabla \\cdot u = s_{\\mathrm{m}}$ 意味着 $[s_{\\mathrm{m}}] = [\\nabla \\cdot u] = (\\text{m} \\cdot \\text{s}^{-1})/\\text{m} = \\text{s}^{-1}$。因此，$g$ 元素的单位是：\n$$[g] = [s_{\\mathrm{m}}] \\cdot [\\text{体积}] = \\text{s}^{-1} \\cdot \\text{m}^3 = \\text{m}^3 \\cdot \\text{s}^{-1} \\quad (\\text{体积流率})$$\n为了使方程 $Bu - Cp = g$ 一致，每一项都必须具有体积流率的单位。\n对于项 $Bu$：\n$$[B][u] = [g] \\implies [B] \\cdot (\\text{m} \\cdot \\text{s}^{-1}) = \\text{m}^3 \\cdot \\text{s}^{-1}$$\n$$[B] = \\frac{\\text{m}^3 \\cdot \\text{s}^{-1}}{\\text{m} \\cdot \\text{s}^{-1}} = \\text{m}^2$$\n此结果与我们对 $[B^{\\top}]$ 的发现一致。\n对于项 $Cp$：\n$$[C][p] = [g] \\implies [C] \\cdot (\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}) = \\text{m}^3 \\cdot \\text{s}^{-1}$$\n$$[C] = \\frac{\\text{m}^3 \\cdot \\text{s}^{-1}}{\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}} = \\text{m}^4 \\cdot \\text{s} \\cdot \\text{kg}^{-1}$$\n\n矩阵块元素的单位是：\n- $[A]$: $\\text{kg} \\cdot \\text{s}^{-1}$\n- $[B]$ 和 $[B^{\\top}]$: $\\text{m}^2$\n- $[C]$: $\\text{m}^4 \\cdot \\text{s} \\cdot \\text{kg}^{-1}$\n\n### 任务2：动量方程项的标度分析\n\n我们使用给定的标度来估计动量方程中每一项的特征量级。微分算子 $\\nabla$ 的标度为 $1/L$。\n$$ \\underbrace{\\rho \\frac{\\partial u}{\\partial t}}_{\\text{惯性项}} \\underbrace{- \\nabla \\cdot (2 \\mu D(u))}_{\\text{粘性项}} \\underbrace{+ \\nabla p}_{\\text{压力项}} \\underbrace{- \\frac{1}{\\mu_0}(\\nabla \\times B) \\times B}_{\\text{洛伦兹项}} = f_{\\mathrm{body}} $$\n- **惯性项**：该项包括瞬态和对流惯性。其标度由 $\\rho \\frac{\\partial u}{\\partial t} \\sim \\rho (u \\cdot \\nabla) u$ 决定。使用特征尺度，其量级为：\n  $$ \\left| \\rho_0 \\frac{U}{T} \\right| = \\left| \\rho_0 \\frac{U}{L/U} \\right| = \\frac{\\rho_0 U^2}{L} $$\n- **粘性项**：应变率张量 $D(u)$ 是 $\\nabla u$ 的对称部分，因此其分量的标度为 $U/L$。粘性项的量级为：\n  $$ \\left| \\nabla \\cdot (\\mu D(u)) \\right| \\sim \\frac{1}{L} \\left( \\mu \\frac{U}{L} \\right) = \\frac{\\mu U}{L^2} $$\n- **压力梯度项**：其量级由压力标度 $P_0$ 和长度标度 $L$ 决定：\n  $$ \\left| \\nabla p \\right| \\sim \\frac{P_0}{L} $$\n- **洛伦兹力项**：磁场旋度的标度为 $B_0/L$。该力项的量级为：\n  $$ \\left| \\frac{1}{\\mu_0}(\\nabla \\times B) \\times B \\right| \\sim \\frac{1}{\\mu_0} \\left( \\frac{B_0}{L} \\right) B_0 = \\frac{B_0^2}{\\mu_0 L} $$\n所有项的单位都正确地为单位体积的力，即 $\\text{N} \\cdot \\text{m}^{-3}$。\n\n### 任务3：压力标度 $P_0$ 的推导\n\n问题要求压力梯度项的量级与惯性项和洛伦兹力项的组合量级相平衡。这是无量纲化中的常见做法，以确保压力相对于动量方程中的主导力进行适当的标度。我们令在任务2中推导的特征标度相等。\n\n压力梯度项的标度 $=$ 惯性项的标度 $+$ 洛伦兹力项的标度\n$$ \\frac{P_0}{L} = \\frac{\\rho_0 U^2}{L} + \\frac{B_0^2}{\\mu_0 L} $$\n两边同乘以 $L$，我们得到压力标度 $P_0$ 的显式表达式：\n$$ P_0 = \\rho_0 U^2 + \\frac{B_0^2}{\\mu_0} $$\n这个 $P_0$ 的表达式代表了特征动压（$\\rho_0 U^2$）和特征磁压（$B_0^2 / (2\\mu_0)$，尽管 $B_0^2/\\mu_0$ 是常用的标度因子）之和。这种选择确保了无论是流体惯性主导还是磁力主导的流动，无量纲压力都保持为一个一阶（量级为1）的量。\n\n### 任务4：预条件子标度的解释\n\n预条件子的有效性，特别是对于迭代求解器而言，取决于它将系统矩阵转换为具有更有利特征值分布（例如，聚集在1附近）的能力。对于鞍点系统，这通常涉及近似系统的关键块或其舒尔补 $S = B A^{-1} B^{\\top} + C$。挑战在于，这些块的性质，如它们的范数和条件数，会随物理参数发生巨大变化。\n\n任务3中推导的标度是实现鲁棒预处理的关键。让我们通过除以压力梯度标度 $P_0/L$ 来对动量方程进行无量纲化：\n$$ \\frac{L}{P_0} \\left( \\rho \\frac{\\partial u}{\\partial t} \\right) + \\frac{L}{P_0} \\left( - \\nabla \\cdot (2 \\mu D(u)) \\right) + \\tilde{\\nabla} \\tilde{p} + \\frac{L}{P_0} \\left( - \\frac{1}{\\mu_0}(\\nabla \\times B) \\times B \\right) = 0 $$\n代入标度和我们对 $P_0 = \\rho_0 U^2 + B_0^2/\\mu_0$ 的表达式，得到 $O(1)$ 微分算子的无量纲系数：\n$$ \\left( \\frac{\\rho_0 U^2}{\\rho_0 U^2 + B_0^2/\\mu_0} \\right) (\\text{无量纲惯性项}) - \\left( \\frac{\\mu U/L}{\\rho_0 U^2 + B_0^2/\\mu_0} \\right) (\\text{无量纲粘性项}) + \\tilde{\\nabla} \\tilde{p} - \\left( \\frac{B_0^2/\\mu_0}{\\rho_0 U^2 + B_0^2/\\mu_0} \\right) (\\text{无量纲洛伦兹项}) = 0 $$\n通过这种无量纲化，变量 $(\\tilde{u}, \\tilde{p})$ 的离散系统形式为 $\\begin{pmatrix} \\tilde{A}  \\tilde{B}^{\\top} \\\\ \\tilde{B}  -\\tilde{C} \\end{pmatrix} \\begin{pmatrix} \\tilde{u} \\\\ \\tilde{p} \\end{pmatrix} = \\begin{pmatrix} \\tilde{f} \\\\ \\tilde{g} \\end{pmatrix}$。\n\n关键的洞见在于算子 $\\tilde{A}$ 是如何构成的。它是由物理区域决定的系数与无量纲算子的和：\n- 惯性系数：$\\alpha_I = \\frac{\\rho_0 U^2}{\\rho_0 U^2 + B_0^2/\\mu_0}$。注意 $0 \\le \\alpha_I \\le 1$。\n- 洛伦兹系数：$\\alpha_M = \\frac{B_0^2/\\mu_0}{\\rho_0 U^2 + B_0^2/\\mu_0}$。注意 $0 \\le \\alpha_M \\le 1$。\n\n至关重要的是，$\\alpha_I + \\alpha_M = 1$。离散块 $\\tilde{A}$ 是一个算子的离散化，该算子的主导项系数为 $\\alpha_I$ 和 $\\alpha_M$。\n- 在**惯性主导**区域（$U$ 大，$B_0$ 小）中，$P_0 \\approx \\rho_0 U^2$，因此 $\\alpha_I \\to 1$ 且 $\\alpha_M \\to 0$。$\\tilde{A}$ 块由 $O(1)$ 的无量纲流体动量算子主导。\n- 在**磁主导**区域（$B_0$ 大，$U$ 小）中，$P_0 \\approx B_0^2/\\mu_0$，因此 $\\alpha_I \\to 0$ 且 $\\alpha_M \\to 1$。$\\tilde{A}$ 块由 $O(1)$ 的无量纲洛伦兹算子主导。\n\n在所有区域中，$\\tilde{A}$ 中主导系数的和为1，这确保了 $\\tilde{A}$ 的范数保持为 $O(1)$。$\\tilde{B}$ 块代表一个纯几何算子（$\\tilde{\\nabla}$），其范数也为 $O(1)$。因此，只要 $\\tilde{A}$ 可逆且 $\\tilde{C}$ 性态良好，无量纲系统的舒尔补 $\\tilde{S} = \\tilde{B} \\tilde{A}^{-1} \\tilde{B}^{\\top} + \\tilde{C}$ 也将是良好标度的，并且其范数在所有物理区域内都为 $O(1)$。\n\n这意味着为无量纲系统设计的预条件子 $K_{\\text{nondim}} = \\mathrm{diag}(\\tilde{A}_0, \\tilde{S}_0)$（其中 $\\tilde{A}_0 \\approx \\tilde{A}$ 且 $\\tilde{S}_0 \\approx \\tilde{S}$）的性能将与物理区域无关。例如，用于 $\\tilde{A}_0$ 的代数多重网格近似和基于离散拉普拉斯算子求逆的 $\\tilde{S}_0$ 近似，无论流动是惯性的还是磁性的，都将是有效的。原始的有量纲预条件子 $K = \\mathrm{diag}(A_0, S_0)$ 的标度特性继承自这种性态良好的无量纲结构，确保了其标度后块的光谱保持为一阶（量级为1）。\n\n### 任务5：无量纲压力标度因子 $\\gamma$\n\n问题要求无量纲压力标度因子 $\\gamma := P_0 / (\\rho_0 U^2)$。使用任务3中推导的 $P_0$ 表达式：\n$$ P_0 = \\rho_0 U^2 + \\frac{B_0^2}{\\mu_0} $$\n我们用动压标度 $\\rho_0 U^2$ 去除：\n$$ \\gamma = \\frac{P_0}{\\rho_0 U^2} = \\frac{\\rho_0 U^2 + \\frac{B_0^2}{\\mu_0}}{\\rho_0 U^2} $$\n$$ \\gamma = \\frac{\\rho_0 U^2}{\\rho_0 U^2} + \\frac{B_0^2/\\mu_0}{\\rho_0 U^2} $$\n$$ \\gamma = 1 + \\frac{B_0^2}{\\mu_0 \\rho_0 U^2} $$\n这是最终的无量纲表达式。项 $\\frac{B_0^2}{\\mu_0 \\rho_0 U^2}$ 是磁压标度与动压标度之比，通常表示为阿尔文（Alfvén）马赫数平方的倒数，$1/M_A^2$。",
            "answer": "$$\\boxed{1 + \\frac{B_0^2}{\\mu_0 \\rho_0 U^2}}$$"
        },
        {
            "introduction": "在对流占优的流动问题中，鞍点系统的非对称性给标准预处理技术带来了巨大挑战。本练习通过一个精心设计的极简模型，让你直观地诊断最小二乘换元（LSC）预处理器在此类问题中的失效原因。你将进一步探索并应用增广拉格朗日（AL）方法作为修正，从计算中理解其如何通过稳定化来恢复预处理的鲁棒性。",
            "id": "3954711",
            "problem": "考虑托卡马克刮削层中的一个简化不可压缩电阻磁流体动力学 (MHD) 线性化边界流模型，该模型经离散化后产生一个具有块形式的鞍点系统\n$$\n\\begin{pmatrix}\nA  B^{\\top} \\\\\nB  0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{u} \\\\\np\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f} \\\\\ng\n\\end{pmatrix},\n$$\n其中 $A \\in \\mathbb{R}^{n \\times n}$ 近似动量算子（扩散加对流），$B \\in \\mathbb{R}^{m \\times n}$ 近似离散散度，$\\mathbf{u}$ 是速度向量，$p$ 是压力。控制压力块的舒尔补为 $S = B A^{-1} B^{\\top}$。在具有空间变化漂移的对流主导区域中，基于最小二乘交换子 (LSC) 的块预条件子可能会失去其鲁棒性。\n\n构建以下针对强可变对流的最小示例：令 $n = 2$ 和 $m = 1$，其中\n$$\nA = \\begin{pmatrix}\n\\varepsilon  \\alpha \\\\\n0  \\varepsilon\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n1  -1\n\\end{pmatrix},\n$$\n其中 $\\varepsilon  0$ 表示扩散，$\\alpha  0$ 表示沿环向带有剪切的局部强有向对流（因此离散算子是非对称的）。LSC 的速度质量矩阵是单位矩阵 $M = I$。\n\n从鞍点舒尔补和块预处理原理的标准定义出发：\n- 对于上述 $A$ 和 $B$，推导精确的标量舒尔补 $S = B A^{-1} B^{\\top}$。\n- 使用最小二乘交换子 (LSC) 近似 $S_{\\mathrm{LSC}} = B M^{-1} B^{\\top}$，构造单特征值预处理算子 $S S_{\\mathrm{LSC}}^{-1}$，并确定当 $\\varepsilon  0$ 固定时，其在 $\\alpha \\to \\infty$ 时的渐近行为。\n- 通过将 $A$ 替换为 $A_{\\tau} = A + \\tau B^{\\top} B$ 提出一个增广拉格朗日 (AL) 校正，其中 $\\tau  0$ 是一个稳定化参数。对于在压力块上使用 $(1/\\tau) I$ 的块对角 AL 预条件子，计算预处理舒尔算子的单特征值，\n$$\n\\lambda_{\\mathrm{AL}}(\\varepsilon,\\alpha,\\tau) = \\tau \\, B A_{\\tau}^{-1} B^{\\top},\n$$\n然后对于与局部对流强度成正比的选择 $\\tau = \\alpha$ 简化结果。\n\n将您的最终答案表示为 $\\lambda_{\\mathrm{AL}}(\\varepsilon,\\alpha,\\tau)$ 在 $\\tau = \\alpha$ 时的单个闭式表达式。无需单位。如果您引入任何其他符号，请明确定义它们。不要进行任何四舍五入；提供精确的解析表达式。",
            "solution": "该问题设置在计算流体和等离子体动力学的数值线性代数背景下，具体涉及由离散化磁流体动力学 (MHD) 方程产生的鞍点系统的预处理。所使用的概念，如舒尔补、最小二乘交换子 (LSC) 预条件子和增广拉格朗日 (AL) 方法，在该领域都是标准的。该问题提供了一个定义明确的最小示例，以探究这些预条件子在对流主导区域中的行为。所有定义、参数和矩阵都陈述清晰且数学上一致。该问题具有科学依据、客观且适定。因此，该问题是有效的，可以构建解答。\n\n任务是执行三个相关的计算。\n\n首先，我们推导精确的标量舒尔补 $S = B A^{-1} B^{\\top}$。给定的矩阵是：\n$$\nA = \\begin{pmatrix}\n\\varepsilon  \\alpha \\\\\n0  \\varepsilon\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n1  -1\n\\end{pmatrix}\n$$\n参数为 $\\varepsilon  0$ 和 $\\alpha  0$。我们首先求 $A$ 的逆矩阵。$A$ 的行列式为 $\\det(A) = \\varepsilon \\cdot \\varepsilon - \\alpha \\cdot 0 = \\varepsilon^2$。逆矩阵是：\n$$\nA^{-1} = \\frac{1}{\\varepsilon^2} \\begin{pmatrix}\n\\varepsilon  -\\alpha \\\\\n0  \\varepsilon\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{1}{\\varepsilon}  -\\frac{\\alpha}{\\varepsilon^2} \\\\\n0  \\frac{1}{\\varepsilon}\n\\end{pmatrix}\n$$\n现在我们计算舒尔补 $S$。$B$ 的转置是 $B^{\\top} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n$$\nS = B A^{-1} B^{\\top} = \\begin{pmatrix}\n1  -1\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{\\varepsilon}  -\\frac{\\alpha}{\\varepsilon^2} \\\\\n0  \\frac{1}{\\varepsilon}\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\\n-1\n\\end{pmatrix}\n$$\n我们首先计算乘积 $B A^{-1}$：\n$$\nB A^{-1} = \\begin{pmatrix}\n1 \\cdot \\frac{1}{\\varepsilon} - 1 \\cdot 0   1 \\cdot \\left(-\\frac{\\alpha}{\\varepsilon^2}\\right) - 1 \\cdot \\frac{1}{\\varepsilon}\n\\end{pmatrix} = \\begin{pmatrix}\n\\frac{1}{\\varepsilon}   -\\frac{\\alpha+\\varepsilon}{\\varepsilon^2}\n\\end{pmatrix}\n$$\n然后，我们用 $B^{\\top}$ 完成乘积：\n$$\nS = \\begin{pmatrix}\n\\frac{1}{\\varepsilon}   -\\frac{\\alpha+\\varepsilon}{\\varepsilon^2}\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\\n-1\n\\end{pmatrix} = \\frac{1}{\\varepsilon} - \\left(-\\frac{\\alpha+\\varepsilon}{\\varepsilon^2}\\right) = \\frac{\\varepsilon}{\\varepsilon^2} + \\frac{\\alpha+\\varepsilon}{\\varepsilon^2} = \\frac{2\\varepsilon+\\alpha}{\\varepsilon^2}\n$$\n\n第二，我们分析 LSC 预处理算子 $S S_{\\mathrm{LSC}}^{-1}$。LSC 近似为 $S_{\\mathrm{LSC}} = B M^{-1} B^{\\top}$。由于质量矩阵 $M$ 是单位矩阵 $I$，因此 $M^{-1} = I$。\n$$\nS_{\\mathrm{LSC}} = B I B^{\\top} = B B^{\\top} = \\begin{pmatrix}\n1  -1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\\n-1\n\\end{pmatrix} = 1^2 + (-1)^2 = 2\n$$\n预处理算子是一个标量（即 $1 \\times 1$ 预处理系统的单特征值），由比率 $S/S_{\\mathrm{LSC}}$ 给出：\n$$\n\\lambda_{\\mathrm{LSC}} = S S_{\\mathrm{LSC}}^{-1} = \\frac{(2\\varepsilon+\\alpha)/\\varepsilon^2}{2} = \\frac{2\\varepsilon+\\alpha}{2\\varepsilon^2}\n$$\n当 $\\varepsilon  0$ 固定时，$\\alpha \\to \\infty$ 的渐近行为是：\n$$\n\\lim_{\\alpha \\to \\infty} \\lambda_{\\mathrm{LSC}} = \\lim_{\\alpha \\to \\infty} \\left( \\frac{2\\varepsilon}{2\\varepsilon^2} + \\frac{\\alpha}{2\\varepsilon^2} \\right) = \\lim_{\\alpha \\to \\infty} \\left( \\frac{1}{\\varepsilon} + \\frac{\\alpha}{2\\varepsilon^2} \\right) \\to \\infty\n$$\n特征值随 $\\alpha$ 线性增长，表明 LSC 预条件子对于大对流缺乏鲁棒性。\n\n第三，我们计算增广拉格朗日公式的特征值 $\\lambda_{\\mathrm{AL}}(\\varepsilon,\\alpha,\\tau) = \\tau \\, B A_{\\tau}^{-1} B^{\\top}$，然后特化为 $\\tau=\\alpha$。矩阵 $A$ 被替换为 $A_{\\tau} = A + \\tau B^{\\top} B$。\n$$\nB^{\\top}B = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\begin{pmatrix} 1  -1 \\end{pmatrix} = \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n$$\nA_{\\tau} = \\begin{pmatrix} \\varepsilon  \\alpha \\\\ 0  \\varepsilon \\end{pmatrix} + \\tau \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\begin{pmatrix} \\varepsilon+\\tau   \\alpha-\\tau \\\\ -\\tau   \\varepsilon+\\tau \\end{pmatrix}\n$$\n$A_{\\tau}$ 的行列式为 $\\det(A_{\\tau}) = (\\varepsilon+\\tau)^2 - (\\alpha-\\tau)(-\\tau) = \\varepsilon^2 + 2\\varepsilon\\tau + \\tau^2 + \\tau\\alpha - \\tau^2 = \\varepsilon^2 + 2\\varepsilon\\tau + \\tau\\alpha$。逆矩阵 $A_{\\tau}^{-1}$ 是：\n$$\nA_{\\tau}^{-1} = \\frac{1}{\\varepsilon^2 + 2\\varepsilon\\tau + \\tau\\alpha} \\begin{pmatrix} \\varepsilon+\\tau   \\tau-\\alpha \\\\ \\tau   \\varepsilon+\\tau \\end{pmatrix}\n$$\n我们接着计算项 $B A_{\\tau}^{-1} B^{\\top}$：\n$$\nB A_{\\tau}^{-1} = \\frac{1}{\\det(A_{\\tau})} \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{pmatrix} \\varepsilon+\\tau   \\tau-\\alpha \\\\ \\tau   \\varepsilon+\\tau \\end{pmatrix} = \\frac{1}{\\det(A_{\\tau})} \\begin{pmatrix} \\varepsilon+\\tau-\\tau   \\tau-\\alpha-(\\varepsilon+\\tau) \\end{pmatrix} = \\frac{1}{\\det(A_{\\tau})} \\begin{pmatrix} \\varepsilon   -\\alpha-\\varepsilon \\end{pmatrix}\n$$\n$$\nB A_{\\tau}^{-1} B^{\\top} = \\frac{1}{\\det(A_{\\tau})} \\begin{pmatrix} \\varepsilon   -(\\alpha+\\varepsilon) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\frac{\\varepsilon - (-(\\alpha+\\varepsilon))}{\\det(A_{\\tau})} = \\frac{2\\varepsilon+\\alpha}{\\varepsilon^2 + 2\\varepsilon\\tau + \\tau\\alpha}\n$$\n特征值为 $\\lambda_{\\mathrm{AL}}(\\varepsilon,\\alpha,\\tau) = \\tau \\, B A_{\\tau}^{-1} B^{\\top}$：\n$$\n\\lambda_{\\mathrm{AL}}(\\varepsilon,\\alpha,\\tau) = \\frac{\\tau(2\\varepsilon+\\alpha)}{\\varepsilon^2 + 2\\varepsilon\\tau + \\tau\\alpha}\n$$\n最后，我们代入选择 $\\tau = \\alpha$：\n$$\n\\lambda_{\\mathrm{AL}}(\\varepsilon,\\alpha,\\alpha) = \\frac{\\alpha(2\\varepsilon+\\alpha)}{\\varepsilon^2 + 2\\varepsilon\\alpha + \\alpha(\\alpha)} = \\frac{\\alpha(2\\varepsilon+\\alpha)}{\\varepsilon^2 + 2\\varepsilon\\alpha + \\alpha^2}\n$$\n分母是 $(\\varepsilon+\\alpha)^2$ 的展开式。最终的简化表达式是：\n$$\n\\lambda_{\\mathrm{AL}}(\\varepsilon,\\alpha,\\alpha) = \\frac{\\alpha(2\\varepsilon+\\alpha)}{(\\varepsilon+\\alpha)^2}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\alpha(2\\varepsilon+\\alpha)}{(\\varepsilon+\\alpha)^2}}\n$$"
        }
    ]
}