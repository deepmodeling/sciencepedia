{
    "hands_on_practices": [
        {
            "introduction": "The computational efficiency of many IMEX schemes comes from their structure when applied to problems with linear stiff terms. This exercise  guides you through the algebraic derivation that reveals how the implicit stages of an Additive Runge-Kutta method reduce to solving a sequence of linear systems with a constant, reusable matrix. Understanding this process is key to appreciating and implementing high-performance IMEX solvers.",
            "id": "3993135",
            "problem": "Consider a semi-discrete model of parallel electron heat conduction in a magnetically confined fusion plasma, where the discretization along a magnetic field line yields an ordinary differential equation system of the form $y'(t)=f(y(t))+g(y(t))$. The term $f(y)$ collects non-stiff nonlinear sources (e.g., sheath boundary conditions and volumetric heating), while $g(y)$ models stiff linear diffusion, here assumed linear of the form $g(y)=\\nu L y$ with $\\nu>0$ and $L \\in \\mathbb{R}^{m \\times m}$ a constant, symmetric positive definite (SPD) matrix arising from a second-order central-difference approximation of the one-dimensional Laplacian with Dirichlet boundary conditions on a uniform grid. Thus the Jacobian of the stiff term is $J_g=\\nu L$, which is constant in time.\n\nApply a $s$-stage Implicit–Explicit (IMEX) Additive Runge–Kutta (ARK) method, defined by an explicit coefficient matrix $A^{\\mathrm{E}}=\\{a^{\\mathrm{E}}_{ij}\\}$ and an implicit coefficient matrix $A^{\\mathrm{I}}=\\{a^{\\mathrm{I}}_{ij}\\}$, with $A^{\\mathrm{E}}$ strictly lower triangular and $A^{\\mathrm{I}}$ lower triangular (diagonally implicit). Let $y^n$ denote the solution at time $t^n$, let $\\Delta t$ denote the time step, and let $Y_i$ denote the stage values for $i=1,\\dots,s$.\n\nStarting from the standard stage definitions used in additive Runge–Kutta methods and the given properties of $g$, rigorously derive the linear algebraic form of the implicit stage equations for each $i$, isolating the unknown $Y_i$ on the left-hand side. Then consider a specific three-stage implicit matrix $A^{\\mathrm{I}}$ with diagonal entries $a^{\\mathrm{I}}_{11}=\\gamma$, $a^{\\mathrm{I}}_{22}=\\gamma$, and $a^{\\mathrm{I}}_{33}=0$, and zeros above the diagonal. Under the assumption that $\\Delta t$ is constant and $J_g$ is constant, explain how the structure of the implicit stage equations enables precomputation and reuse of matrix factorizations within and across time steps. Finally, provide the explicit analytic expression for the single matrix whose factorization can be precomputed and reused for the nontrivial implicit stages in terms of $I$, $\\Delta t$, $\\gamma$, and $J_g$.\n\nExpress your final answer as a single closed-form analytic expression. No numerical evaluation or rounding is required.",
            "solution": "The user-provided problem will first be validated for scientific soundness, self-consistency, and clarity before a solution is attempted.\n\n### Step 1: Extract Givens\n- **ODE System**: A semi-discrete model of the form $y'(t)=f(y(t))+g(y(t))$.\n- **Explicit Part**: $f(y)$ is a non-stiff nonlinear function.\n- **Implicit Part**: $g(y)$ is a stiff linear diffusion term, $g(y)=\\nu L y$.\n- **Constants and Matrices**:\n    - $\\nu > 0$ is a constant.\n    - $L \\in \\mathbb{R}^{m \\times m}$ is a constant, symmetric positive definite (SPD) matrix.\n    - The Jacobian of the stiff term is $J_g = \\nu L$, which is constant.\n- **Numerical Method**: An $s$-stage Implicit–Explicit (IMEX) Additive Runge–Kutta (ARK) method.\n    - Coefficient matrix for an explicit method: $A^{\\mathrm{E}}=\\{a^{\\mathrm{E}}_{ij}\\}$, strictly lower triangular.\n    - Coefficient matrix for an implicit method: $A^{\\mathrm{I}}=\\{a^{\\mathrm{I}}_{ij}\\}$, lower triangular (diagonally implicit).\n- **Notation**:\n    - $y^n$ is the solution at time $t^n$.\n    - $\\Delta t$ is the time step, assumed constant.\n    - $Y_i$ are the stage values for $i=1,\\dots,s$.\n- **Specifics for Second Part of the Problem**:\n    - A three-stage implicit matrix $A^{\\mathrm{I}}$ is considered.\n    - Diagonal entries are $a^{\\mathrm{I}}_{11}=\\gamma$, $a^{\\mathrm{I}}_{22}=\\gamma$, and $a^{\\mathrm{I}}_{33}=0$.\n    - $A^{\\mathrm{I}}$ is lower triangular, implying $a^{\\mathrm{I}}_{ij}=0$ for $j>i$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is well-grounded in the field of numerical analysis and computational science. The stiff ODE system $y' = f(y) + g(y)$ is a canonical form for problems with multiple time scales, common in computational physics and engineering. The model of parallel heat conduction in a plasma leading to a stiff diffusion term is a classic example. The use of IMEX ARK methods is a standard, state-of-the-art technique for such problems. The properties of the matrix $L$ (constant, SPD) are consistent with its origin from a standard finite difference discretization of the Laplacian operator.\n2.  **Well-Posed**: The problem is well-posed. It asks for a specific algebraic derivation, an explanation of a computational advantage, and a final analytical expression. All necessary information is provided to arrive at a unique and meaningful answer.\n3.  **Objective**: The language is precise, technical, and free of any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, and objective. A solution will be provided.\n\n### Solution Derivation\nThe problem concerns the application of an $s$-stage IMEX ARK method to the additive ODE system $y'(t) = f(y(t)) + g(y(t))$. The general formula for the $i$-th stage value, $Y_i$, of such a method is given by:\n$$\nY_i = y^n + \\Delta t \\sum_{j=1}^{s} a^{\\mathrm{E}}_{ij} f(Y_j) + \\Delta t \\sum_{j=1}^{s} a^{\\mathrm{I}}_{ij} g(Y_j)\n$$\nGiven that the explicit coefficient matrix $A^{\\mathrm{E}}$ is strictly lower triangular ($a^{\\mathrm{E}}_{ij}=0$ for $j \\ge i$) and the implicit coefficient matrix $A^{\\mathrm{I}}$ is lower triangular ($a^{\\mathrm{I}}_{ij}=0$ for $j > i$), the stage value equation simplifies to:\n$$\nY_i = y^n + \\Delta t \\sum_{j=1}^{i-1} a^{\\mathrm{E}}_{ij} f(Y_j) + \\Delta t \\sum_{j=1}^{i} a^{\\mathrm{I}}_{ij} g(Y_j)\n$$\nThe problem states that the stiff part $g(y)$ is linear, specifically $g(y) = \\nu L y$. Since $L$ is a constant matrix, the Jacobian of $g$ is $J_g = \\frac{\\partial g}{\\partial y} = \\nu L$, which is also constant. For a linear function, we have $g(Y_j) = J_g Y_j$. Substituting this into the stage equation yields:\n$$\nY_i = y^n + \\Delta t \\sum_{j=1}^{i-1} a^{\\mathrm{E}}_{ij} f(Y_j) + \\Delta t \\sum_{j=1}^{i} a^{\\mathrm{I}}_{ij} (J_g Y_j)\n$$\nTo solve for the unknown stage value $Y_i$, we must isolate it. The term involving $Y_i$ appears in the second summation only when the index $j$ equals $i$. We can separate this term from the sum:\n$$\nY_i = y^n + \\Delta t \\sum_{j=1}^{i-1} a^{\\mathrm{E}}_{ij} f(Y_j) + \\Delta t \\left( \\sum_{j=1}^{i-1} a^{\\mathrm{I}}_{ij} J_g Y_j \\right) + \\Delta t a^{\\mathrm{I}}_{ii} J_g Y_i\n$$\nThe right-hand side now contains terms that depend on previously computed stage values ($Y_j$ for $j<i$) and the unknown $Y_i$. We can group all terms involving $Y_i$ on the left-hand side:\n$$\nY_i - \\Delta t a^{\\mathrm{I}}_{ii} J_g Y_i = y^n + \\Delta t \\sum_{j=1}^{i-1} a^{\\mathrm{E}}_{ij} f(Y_j) + \\Delta t \\sum_{j=1}^{i-1} a^{\\mathrm{I}}_{ij} J_g Y_j\n$$\nFactoring out $Y_i$ on the left-hand side, where $I$ is the identity matrix of size $m \\times m$:\n$$\n(I - \\Delta t a^{\\mathrm{I}}_{ii} J_g) Y_i = y^n + \\Delta t \\sum_{j=1}^{i-1} a^{\\mathrm{E}}_{ij} f(Y_j) + \\Delta t \\sum_{j=1}^{i-1} a^{\\mathrm{I}}_{ij} J_g Y_j\n$$\nThis is the linear algebraic form of the implicit stage equations. At each stage $i$, the right-hand side is fully determined by the solution from the previous time step, $y^n$, and the stage values $Y_j$ and stage derivatives $f(Y_j)$ for $j < i$, which have already been computed. To find $Y_i$, one must solve this system of linear equations. This completes the first part of the task.\n\nNext, we consider the specific three-stage method where the implicit matrix $A^{\\mathrm{I}}$ has diagonal entries $a^{\\mathrm{I}}_{11}=\\gamma$, $a^{\\mathrm{I}}_{22}=\\gamma$, and $a^{\\mathrm{I}}_{33}=0$. We analyze the structure of the stage equations for $i=1, 2, 3$.\n\nFor stage $i=1$:\nThe summations are empty. The equation is:\n$$\n(I - \\Delta t a^{\\mathrm{I}}_{11} J_g) Y_1 = y^n \\implies (I - \\Delta t \\gamma J_g) Y_1 = y^n\n$$\nThis is a linear system for $Y_1$.\n\nFor stage $i=2$:\nThe equation is:\n$$\n(I - \\Delta t a^{\\mathrm{I}}_{22} J_g) Y_2 = y^n + \\Delta t a^{\\mathrm{E}}_{21} f(Y_1) + \\Delta t a^{\\mathrm{I}}_{21} J_g Y_1\n$$\nSubstituting $a^{\\mathrm{I}}_{22}=\\gamma$, we get:\n$$\n(I - \\Delta t \\gamma J_g) Y_2 = y^n + \\Delta t a^{\\mathrm{E}}_{21} f(Y_1) + \\Delta t a^{\\mathrm{I}}_{21} J_g Y_1\n$$\nThis is another linear system for $Y_2$, where the right-hand side depends on the just-computed $Y_1$.\n\nFor stage $i=3$:\nThe equation is:\n$$\n(I - \\Delta t a^{\\mathrm{I}}_{33} J_g) Y_3 = y^n + \\Delta t \\sum_{j=1}^{2} a^{\\mathrm{E}}_{3j} f(Y_j) + \\Delta t \\sum_{j=1}^{2} a^{\\mathrm{I}}_{3j} J_g Y_j\n$$\nSubstituting $a^{\\mathrm{I}}_{33}=0$, the matrix on the left-hand side becomes the identity matrix:\n$$\n(I - 0) Y_3 = I Y_3 = Y_3\n$$\nThus, the third stage is explicit:\n$$\nY_3 = y^n + \\Delta t (a^{\\mathrm{E}}_{31} f(Y_1) + a^{\\mathrm{E}}_{32} f(Y_2)) + \\Delta t (a^{\\mathrm{I}}_{31} J_g Y_1 + a^{\\mathrm{I}}_{32} J_g Y_2)\n$$\nNo linear system needs to be solved for $Y_3$.\n\nThe crucial observation concerns the linear systems for the nontrivial implicit stages, $i=1$ and $i=2$. Both stages require solving a linear system with the **exact same matrix**, $M = I - \\Delta t \\gamma J_g$. The problem specifies that the time step $\\Delta t$ is constant and the Jacobian of the stiff term, $J_g$, is also constant. The coefficient $\\gamma$ is a defining constant of the numerical method. Therefore, the matrix $M$ is constant throughout the entire time-stepping procedure.\n\nThis property enables significant computational savings. The most expensive part of solving a linear system $Mz=b$ is typically the factorization of the matrix $M$ (e.g., an LU decomposition), which for a dense $m \\times m$ matrix costs $\\mathcal{O}(m^3)$ operations. Once the factorization is computed, solving for $z$ using forward and backward substitution is much cheaper, costing $\\mathcal{O}(m^2)$ operations.\n\nBecause the matrix $M = I - \\Delta t \\gamma J_g$ is constant, we can perform the following optimization:\n1.  **Precomputation**: Before the main time-stepping loop begins, compute the matrix $M$ and its factorization (e.g., $M=PLU$, where $P$ is a permutation matrix, $L$ is lower unitriangular, and $U$ is upper triangular). This is a one-time cost.\n2.  **Reuse within a time step**: To compute $Y_1$ and $Y_2$ within a single time step $n$, use the precomputed factorization to solve the two linear systems. This requires two cheap $\\mathcal{O}(m^2)$ solves instead of two expensive $\\mathcal{O}(m^3)$ factorizations.\n3.  **Reuse across time steps**: Since $M$ is independent of the time step index $n$, the same factorization can be reused for every subsequent time step.\n\nThis strategy reduces the dominant computational cost of the implicit solves at each time step from factorization to substitution, amortizing the one-time factorization cost over the entire simulation.\n\nFinally, the single matrix whose factorization can be precomputed and reused for the nontrivial implicit stages ($i=1, 2$) is the matrix that appears on the left-hand side of the linear systems for these stages. As derived, this matrix is $I - \\Delta t \\gamma J_g$.",
            "answer": "$$\\boxed{I - \\Delta t \\gamma J_g}$$"
        },
        {
            "introduction": "While the implicit part of an IMEX scheme circumvents the most severe time step restrictions, the explicit part is still subject to a stability limit, typically a Courant–Friedrichs–Lewy (CFL) condition. This practice  connects the abstract stability region of an explicit Runge-Kutta method to the physical properties of a plasma wave model. By completing it, you will learn how to determine the maximum stable time step for the non-stiff dynamics.",
            "id": "3993147",
            "problem": "Consider one-dimensional, small-amplitude Alfvén wave propagation along a uniform magnetic field in ideal Magnetohydrodynamics (MHD). Linearization about a constant equilibrium with magnetic field magnitude $B_{0}$ and mass density $\\rho_{0}$ yields nondissipative, purely propagating modes with phase speed equal to the Alfvén speed $v_{A} = B_{0}/\\sqrt{\\mu_{0}\\rho_{0}}$, where $\\mu_{0}$ is the magnetic permeability of free space. For propagation strictly parallel to $B_{0}$, the dynamics along the field can be modeled by an advection equation of the form $\\partial_{t} u + v_{A} \\partial_{x} u = 0$, which possesses Fourier-mode solutions with frequencies $\\omega = k v_{A}$ and purely imaginary spatial operator eigenvalues.\n\nSuppose the spatial derivative $\\partial_{x}$ is discretized on a uniform periodic grid of spacing $\\Delta x$ using the second-order centered difference operator $\\mathcal{D}_{x} u_{j} = (u_{j+1} - u_{j-1})/(2\\Delta x)$. Its Fourier symbol is $i\\,\\sin(k \\Delta x)/\\Delta x$, so the discrete advection operator has eigenvalues $\\lambda_{k} = i v_{A} \\sin(k \\Delta x)/\\Delta x$, and the spectral radius estimate is $\\rho_{E} = \\max_{k} |\\lambda_{k}| = v_{A}/\\Delta x$.\n\nConsider an Implicit–Explicit (IMEX) Runge–Kutta (RK) time integration scheme in which all fast stiff source terms are treated implicitly, while the Alfvén-wave advection term is treated explicitly using the classical four-stage, fourth-order explicit Runge–Kutta method (often called “RK4”). Denote by $R_{E}(z)$ the scalar stability function of the explicit part applied to the linear test problem $\\dot{y} = \\lambda y$. The explicit Courant–Friedrichs–Lewy (CFL) number associated with the advection term is $C = v_{A}\\Delta t/\\Delta x$, which equals $|\\lambda| \\Delta t$ for the most rapidly varying grid-scale mode under the given spectral radius estimate.\n\nStarting from first principles and core definitions of Fourier symbols of linear operators, the Alfvén speed, and the explicit Runge–Kutta method construction for linear problems, derive and use the explicit stability region on the imaginary axis to determine the maximum allowable explicit CFL number $C_{\\max}$ such that the explicit part is linearly stable for all discrete advection modes of the Alfvén wave under the stated spatial discretization and spectral radius estimate. Express your final answer as a single exact analytic value. No rounding is required. The CFL number is dimensionless; do not attach units.",
            "solution": "The physical base for Alfvén wave propagation in ideal Magnetohydrodynamics (MHD) is linear wave dynamics along a uniform magnetic field. The Alfvén speed is $v_{A} = B_{0}/\\sqrt{\\mu_{0}\\rho_{0}}$. For strictly parallel propagation, the linearized dynamics reduce to advection at speed $v_{A}$:\n$$\n\\partial_{t} u + v_{A} \\partial_{x} u = 0.\n$$\nOn a periodic domain, Fourier modes $u(x,t) = \\hat{u}(t) \\exp(i k x)$ yield the relation $\\partial_{x} \\leftrightarrow i k$, so the continuous linear operator has eigenvalues $\\lambda = i k v_{A}$, which are purely imaginary.\n\nNow consider the discrete spatial operator. The second-order centered difference for $\\partial_{x}$ is\n$$\n\\mathcal{D}_{x} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}.\n$$\nFor a discrete Fourier mode $u_{j} = \\hat{u} \\exp(i k j \\Delta x)$, we have\n$$\nu_{j+1} = \\hat{u} \\exp(i k (j+1)\\Delta x), \\quad u_{j-1} = \\hat{u} \\exp(i k (j-1)\\Delta x).\n$$\nThus\n$$\n\\mathcal{D}_{x} u_{j} = \\frac{\\hat{u} \\exp(i k j \\Delta x)\\left(\\exp(i k \\Delta x) - \\exp(-i k \\Delta x)\\right)}{2\\Delta x}\n= \\hat{u} \\exp(i k j \\Delta x) \\frac{i \\sin(k \\Delta x)}{\\Delta x}.\n$$\nTherefore, the discrete advection operator has eigenvalues\n$$\n\\lambda_{k} = i v_{A} \\frac{\\sin(k \\Delta x)}{\\Delta x}.\n$$\nThe spectral radius estimate is the maximum magnitude over all admissible $k$, which is\n$$\n\\rho_{E} = \\max_{k} |\\lambda_{k}| = v_{A}\\,\\max_{k} \\left|\\frac{\\sin(k \\Delta x)}{\\Delta x}\\right| = \\frac{v_{A}}{\\Delta x},\n$$\nbecause $|\\sin(\\cdot)| \\leq 1$.\n\nWe now analyze explicit stability. Consider the explicit part of the Implicit–Explicit (IMEX) scheme to be the classical four-stage, fourth-order explicit Runge–Kutta method (RK4). For the scalar linear test problem $\\dot{y} = \\lambda y$, any $s$-stage explicit Runge–Kutta method defines a one-step map $y_{n+1} = R_{E}(z) y_{n}$, where $z = \\lambda \\Delta t$ and $R_{E}(z)$ is a polynomial determined by the method’s Butcher tableau. For RK4 (with its standard coefficients), it is well known—and can be derived from the stage construction—that the stability function equals the fourth-order Taylor truncation of the exponential:\n$$\nR_{E}(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24}.\n$$\nWe justify this from first principles of Runge–Kutta construction. The RK4 method computes intermediate stages $k_{1} = \\lambda y_{n}$, $k_{2} = \\lambda\\left(y_{n} + \\frac{\\Delta t}{2} k_{1}\\right)$, $k_{3} = \\lambda\\left(y_{n} + \\frac{\\Delta t}{2} k_{2}\\right)$, $k_{4} = \\lambda\\left(y_{n} + \\Delta t k_{3}\\right)$, and updates\n$$\ny_{n+1} = y_{n} + \\Delta t \\left(\\frac{1}{6}k_{1} + \\frac{1}{3}k_{2} + \\frac{1}{3}k_{3} + \\frac{1}{6}k_{4}\\right).\n$$\nSubstituting the linear forms of the $k_{i}$ and simplifying yields the polynomial above, which matches the order conditions for fourth-order accuracy and equals the truncated series of $\\exp(z)$ at degree four.\n\nStability for the explicit part requires $|R_{E}(z)| \\leq 1$ for all eigenvalues $z = \\lambda \\Delta t$ in the spectrum of the explicit operator. Since $\\lambda_{k}$ are purely imaginary, we restrict to the imaginary axis $z = i y$, with $y \\in \\mathbb{R}$. We must find the largest $y_{\\max} > 0$ such that\n$$\n|R_{E}(i y)| \\leq 1\n$$\nfor all $|y| \\leq y_{\\max}$. Substituting $z = i y$,\n$$\nR_{E}(i y) = 1 + i y - \\frac{y^{2}}{2} - i \\frac{y^{3}}{6} + \\frac{y^{4}}{24}.\n$$\nWrite $R_{E}(i y) = A(y) + i B(y)$ with\n$$\nA(y) = 1 - \\frac{y^{2}}{2} + \\frac{y^{4}}{24}, \\qquad B(y) = y - \\frac{y^{3}}{6}.\n$$\nThe magnitude squared is\n$$\n|R_{E}(i y)|^{2} = A(y)^{2} + B(y)^{2}.\n$$\nWe expand $A(y)^{2}$ and $B(y)^{2}$:\n$$\nA(y)^{2} = \\left(1 - \\frac{y^{2}}{2} + \\frac{y^{4}}{24}\\right)^{2}\n= 1 - y^{2} + \\frac{1}{3} y^{4} - \\frac{1}{24} y^{6} + \\frac{1}{576} y^{8},\n$$\n$$\nB(y)^{2} = \\left(y - \\frac{y^{3}}{6}\\right)^{2}\n= y^{2} - \\frac{1}{3} y^{4} + \\frac{1}{36} y^{6}.\n$$\nSumming,\n$$\n|R_{E}(i y)|^{2} = \\left[1 - y^{2} + \\frac{1}{3} y^{4} - \\frac{1}{24} y^{6} + \\frac{1}{576} y^{8}\\right]\n+ \\left[y^{2} - \\frac{1}{3} y^{4} + \\frac{1}{36} y^{6}\\right]\n= 1 - \\frac{1}{72} y^{6} + \\frac{1}{576} y^{8}.\n$$\nTherefore, the stability condition $|R_{E}(i y)| \\leq 1$ is equivalent to\n$$\n1 - \\frac{1}{72} y^{6} + \\frac{1}{576} y^{8} \\leq 1,\n$$\nwhich simplifies to\n$$\n- \\frac{1}{72} y^{6} + \\frac{1}{576} y^{8} \\leq 0.\n$$\nFactor out $y^{6} \\geq 0$:\n$$\ny^{6} \\left(\\frac{y^{2}}{576} - \\frac{1}{72}\\right) \\leq 0.\n$$\nThus we require\n$$\n\\frac{y^{2}}{576} - \\frac{1}{72} \\leq 0 \\quad \\Longleftrightarrow \\quad y^{2} \\leq \\frac{576}{72} = 8.\n$$\nTherefore, the largest admissible value on the imaginary axis is\n$$\ny_{\\max} = \\sqrt{8}.\n$$\nWith the spectral radius estimate for the discrete advection operator,\n$$\n|\\lambda| \\leq \\rho_{E} = \\frac{v_{A}}{\\Delta x},\n$$\nand $z = \\lambda \\Delta t$, we must have $|z| \\leq y_{\\max}$ for stability of all modes. Hence\n$$\n\\Delta t \\leq \\frac{y_{\\max}}{\\rho_{E}} = \\frac{\\sqrt{8}}{v_{A}/\\Delta x} = \\sqrt{8}\\,\\frac{\\Delta x}{v_{A}}.\n$$\nThe explicit Courant–Friedrichs–Lewy (CFL) number $C$ for the advection term is $C = v_{A} \\Delta t / \\Delta x$. Combining the inequality with this definition gives\n$$\nC \\leq \\sqrt{8}.\n$$\nTherefore, the maximum allowable explicit CFL number under the given IMEX RK scheme’s explicit part (classical RK4), the imaginary-axis stability region, and the centered-difference spectral radius estimate for Alfvén-wave advection is\n$$\nC_{\\max} = \\sqrt{8}.\n$$\nThis is a dimensionless exact analytic value, requiring no rounding.",
            "answer": "$$\\boxed{\\sqrt{8}}$$"
        },
        {
            "introduction": "A cornerstone of reliable computational science is code verification—the process of ensuring that a program correctly solves the mathematical model it is intended to solve. This exercise  introduces the Method of Manufactured Solutions (MMS) as a powerful framework for this task. You will outline a verification plan to confirm that an IMEX implementation achieves its theoretical order of temporal accuracy, a critical step in developing trustworthy simulation tools.",
            "id": "3993185",
            "problem": "Consider a one-dimensional minor-radial transport model for a tokamak plasma in computational fusion science and engineering. Let $r \\in [0,1]$ denote the normalized minor radius and let $t \\ge 0$ denote time. A benchmark scalar field $T(r,t)$, representing a transport-relevant quantity (for example, temperature or density), is governed by the advection–diffusion–reaction partial differential equation (PDE)\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial r} = \\chi \\frac{\\partial^2 T}{\\partial r^2} - \\lambda T + S(r,t),\n$$\nwith boundary conditions on $r=0$ and $r=1$ and an initial condition at $t=0$ to be specified. Here $a$ is a constant advection speed, $\\chi$ is a constant diffusion coefficient, $\\lambda$ is a constant reaction rate, and $S(r,t)$ is a source term. Suppose an Implicit–Explicit (IMEX) time integration scheme is chosen that treats the linear stiff diffusion–reaction operator implicitly and the non-stiff advection operator explicitly. The Method of Manufactured Solutions (MMS) proposes selecting a smooth, sufficiently rich, time-dependent target $T^\\star(r,t)$ and then determining $S(r,t)$, boundary conditions, and the initial condition so that $T^\\star(r,t)$ is an exact solution of the PDE.\n\nAssume a known analytic solution $T^\\star(r,t)$ suitable for this benchmark is available and is consistent with the physical boundaries, and that spatial discretization uses a method with known order $m \\ge 2$ (for example, finite difference or finite volume with second-order central differencing for diffusion and a suitable monotone scheme for advection). The goal is to verify, using MMS, the observed temporal order of accuracy $p$ of the chosen IMEX method in regimes relevant to fusion transport where $\\lambda$ may be large.\n\nWhich option most correctly outlines an MMS-based verification plan that isolates and confirms the temporal order of accuracy $p$ of the IMEX scheme?\n\nA. Define a manufactured solution $T^\\star(r,t)$ and compute $S(r,t)$ by substituting $T^\\star(r,t)$ into the PDE, thereby ensuring the PDE, initial condition $T(r,0)=T^\\star(r,0)$, and boundary conditions $T(0,t)$ and $T(1,t)$ are all exactly consistent with $T^\\star$. Implement the IMEX splitting with the diffusion–reaction terms implicit and the advection term explicit, consistent with the PDE decomposition. Choose a sufficiently fine spatial grid with spacing $\\Delta r$ so that the spatial discretization error $C_s (\\Delta r)^m$ is negligible compared to the temporal error $C_t (\\Delta t)^p$ over the refinement range of time steps $\\Delta t$. For multiple refinements $\\Delta t \\to \\Delta t/2 \\to \\Delta t/4$ at fixed final time $t_f$, compute the global error $\\|T(\\cdot,t_f)-T^\\star(\\cdot,t_f)\\|_{L^2}$ and estimate $p$ as the slope of $\\log$ error versus $\\log \\Delta t$, confirming a stable asymptotic regime. Repeat the refinement study for a range of large $\\lambda$ to confirm stiff accuracy without degrading the observed $p$, and tighten linear/nonlinear solver tolerances so that solver errors do not contaminate the convergence measurement.\n\nB. Use the known analytic solution $T^\\star(r,t)$ but keep the source term $S(r,t)$ identically zero; enforce only the initial condition from $T^\\star(r,0)$ while applying homogeneous boundary conditions. Refine both $\\Delta r$ and $\\Delta t$ together to keep the Courant number $a \\Delta t/\\Delta r$ constant, and measure the residual of the semidiscrete IMEX system at each time step. Infer the temporal order $p$ from how the residual magnitude decreases with refinement, without comparing to $T^\\star$ at a final time.\n\nC. Perform a Von Neumann (Fourier) linear stability analysis of the IMEX scheme on the advection–diffusion–reaction PDE, determine the maximum stable time step, and equate the stability restriction with the temporal order of accuracy. Use the stability result to assert the method’s order $p$ since the known analytic solution $T^\\star(r,t)$ exists and the scheme is stable.\n\nD. Select a manufactured solution $T^\\star(r,t)$ that does not satisfy the physical boundary conditions but is smooth in the interior. Compute $S(r,t)$ from the PDE and set $T(r,0)=T^\\star(r,0)$. Treat all terms, including the stiff reaction term $-\\lambda T$, explicitly to avoid implicit solver errors. Estimate $p$ by examining the pointwise error at $r=1/2$ for two time steps $\\Delta t$ and $\\Delta t/2$, and adjust $\\lambda$ between refinements to maintain a constant product $\\lambda \\Delta t$ so the stiffness does not bias the estimate.\n\nSelect the best option.",
            "solution": "The problem statement is a valid exercise in computational science methodology, specifically concerning the verification of numerical schemes for partial differential equations. The premises are scientifically sound, well-posed, and objective. It poses a clear, non-trivial question about the correct procedure for the Method of Manufactured Solutions (MMS). Therefore, a detailed analysis of the options is warranted.\n\nThe objective is to devise a verification plan using MMS to isolate and confirm the temporal order of accuracy, $p$, of a given Implicit-Explicit (IMEX) time integration scheme. A correct plan must adhere to the fundamental principles of MMS and numerical error analysis.\n\nThe total error in a numerical solution arises from several sources. For the given problem, the error $E$ between the numerical solution $T_{num}(r, t_f)$ and the exact solution $T^\\star(r, t_f)$ at a final time $t_f$ can be conceptually expressed as:\n$$\nE \\approx E_{temporal} + E_{spatial} + E_{solver}\n$$\nwhere $E_{temporal} \\sim C_t (\\Delta t)^p$ is the temporal discretization error, $E_{spatial} \\sim C_s (\\Delta r)^m$ is the spatial discretization error, and $E_{solver}$ is the error from any iterative solvers used (e.g., for the implicit part). Here, $\\Delta t$ is the time step, $\\Delta r$ is the spatial grid spacing, $p$ and $m$ are the orders of accuracy, and $C_t$ and $C_s$ are constants.\n\nTo measure $p$, the temporal error must be the dominant term. This requires a specific experimental design:\n1.  **Eliminate Analytical Error**: The MMS procedure accomplishes this. By choosing a manufactured solution $T^\\star(r, t)$ and substituting it into the PDE to define the source term $S(r,t)$, initial condition $T(r,0)$, and boundary conditions $T(0,t)$ and $T(1,t)$, we ensure $T^\\star$ is the exact analytical solution to the problem being numerically solved. Any deviation of the numerical solution from $T^\\star$ is purely numerical error. The source term is calculated as:\n    $$\n    S(r,t) = \\frac{\\partial T^\\star}{\\partial t} + a \\frac{\\partial T^\\star}{\\partial r} - \\chi \\frac{\\partial^2 T^\\star}{\\partial r^2} + \\lambda T^\\star\n    $$\n2.  **Isolate Temporal Error**: To isolate the temporal error, the other error sources must be rendered negligible.\n    -   $E_{spatial}$ must be much smaller than $E_{temporal}$. This is achieved by using a very fine spatial grid (small $\\Delta r$) and keeping it fixed while refining $\\Delta t$. As $\\Delta t$ is reduced, the condition $C_s (\\Delta r)^m \\ll C_t (\\Delta t)^p$ must hold for the range of $\\Delta t$ values used.\n    -   $E_{solver}$ must be negligible. This is achieved by setting the convergence tolerance of any linear or nonlinear iterative solvers to a value much smaller than the expected discretization error.\n3.  **Perform a Convergence Study**: With the spatial grid and solver tolerances fixed, the simulation is run for a sequence of progressively smaller time steps (e.g., $\\Delta t_0, \\Delta t_0/2, \\Delta t_0/4, \\dots$). For each run, the global error at a fixed final time $t_f$ is computed, typically using a norm like the $L^2$-norm:\n    $$\n    \\text{Error}(\\Delta t) = \\left( \\int_0^1 |T_{num}(r, t_f; \\Delta t) - T^\\star(r, t_f)|^2 dr \\right)^{1/2}\n    $$\n    If the temporal error dominates, we expect $\\text{Error}(\\Delta t) \\approx C_t (\\Delta t)^p$. The observed order of accuracy, $p_{obs}$, can be computed from two successive refinements:\n    $$\n    p_{obs} = \\frac{\\log(\\text{Error}(\\Delta t) / \\text{Error}(\\Delta t/2))}{\\log(2)}\n    $$\n    A plot of $\\log(\\text{Error})$ versus $\\log(\\Delta t)$ should yield a line with slope $p$ in the asymptotic region.\n4.  **Confirm Behavior in Stiff Regime**: The problem specifies that $\\lambda$ can be large, making the reaction term stiff. The verification plan should confirm that the method's order $p$ is not degraded for large $\\lambda$, which is a key property of good IMEX schemes.\n\nNow, we evaluate each option against these principles.\n\n**Option A**\nThis option outlines the procedure as follows:\n- Correctly applies MMS by defining $T^\\star$, computing $S(r,t)$ from the PDE, and setting the initial and boundary conditions to be consistent with $T^\\star$. This correctly eliminates analytical error.\n- Implements the specified IMEX scheme.\n- Explicitly states the need to choose a fine spatial grid with fixed $\\Delta r$ to make spatial error negligible, which is the correct way to isolate temporal error.\n- Describes the standard convergence study: refining $\\Delta t$, computing the global error in a norm at a fixed $t_f$, and estimating $p$ from a log-log plot of error vs. $\\Delta t$. This is the correct way to measure the order of accuracy.\n- Mentions repeating the study for large $\\lambda$ to check for order degradation, correctly addressing the stiffness aspect of the problem.\n- Includes the crucial detail of tightening solver tolerances to eliminate solver error as a contaminant.\nThis procedure is a complete and rigorous description of the standard methodology for MMS-based temporal convergence verification.\n**Verdict: Correct**\n\n**Option B**\n- Proposes setting $S(r,t)=0$ and using homogeneous boundary conditions. This is a fundamental violation of the MMS principle. If $S(r,t)$ and the BCs are not derived from $T^\\star$, then $T^\\star$ is not the true solution to the problem being solved, and the difference $|T_{num} - T^\\star|$ is not the numerical error.\n- Suggests refining $\\Delta r$ and $\\Delta t$ together. This confounds spatial and temporal errors, making it impossible to isolate the temporal order $p$.\n- Recommends measuring the residual. The convergence of the residual is related to the local truncation error, not the global error, which is what the order of accuracy $p$ describes. Measuring the global error against the exact solution is the direct method.\nThis option is fundamentally incorrect in its approach to both MMS and error analysis.\n**Verdict: Incorrect**\n\n**Option C**\n- Proposes performing a Von Neumann stability analysis. Stability analysis determines the conditions under which a numerical scheme's solution remains bounded. It does not determine the order of accuracy, which quantifies how quickly the error approaches zero as the discretization is refined.\n- Erroneously equates the stability restriction with the temporal order of accuracy. These are distinct concepts. For example, an A-stable method like implicit Euler ($p=1$) has no stability restriction on $\\Delta t$ for many problems, but it is still only first-order accurate.\n- The Lax Equivalence Theorem states that for a consistent scheme, stability is equivalent to convergence. However, it does not state that the stability boundary determines the *rate* (order) of convergence.\nThis option confuses two different, though related, areas of numerical analysis.\n**Verdict: Incorrect**\n\n**Option D**\n- Suggests using a $T^\\star$ that does not satisfy the boundary conditions. This is an incorrect application of MMS. The boundary conditions for the numerical simulation must be derived from $T^\\star$ to ensure $T^\\star$ is the exact solution.\n- Proposes treating the stiff term $-\\lambda T$ explicitly. This contradicts the problem statement, which specifies an IMEX scheme where this term is treated implicitly. Furthermore, for large $\\lambda$, this explicit approach would be prohibitively restrictive on $\\Delta t$.\n- Suggests adjusting $\\lambda$ during the refinement process. A convergence study requires solving the *same* problem with different discretizations. Changing the problem's governing parameters ($\\lambda$) invalidates the comparison between runs.\nThis option proposes a series of methodologically unsound steps.\n**Verdict: Incorrect**\n\nBased on the analysis, Option A is the only one that describes a scientifically rigorous and standard plan for verifying the temporal order of accuracy using the Method of Manufactured Solutions. It correctly addresses all critical aspects: MMS setup, error isolation, convergence measurement, and additional considerations for stiff problems and solver errors.",
            "answer": "$$\n\\boxed{A}\n$$"
        }
    ]
}