{
    "hands_on_practices": [
        {
            "introduction": "在代数多重网格（AMG）中，第一步是识别变量之间的“强连接”，以指导粗化过程。这个练习提供了一个具体的实例，演示如何从一个连续的各向异性算子出发，构建其离散的九点格式，并应用经典的连接强度判据。通过这个实践，你将深入理解各向异性（尤其是旋转各向异性）如何在离散系统中体现，并为后续更复杂的分析奠定基础。",
            "id": "3949935",
            "problem": "在与计算聚变科学与工程相关的磁化等离子体热输运中，热导率沿着磁场线表现出高度各向异性。考虑一个间距为 $h=1$ 的均匀笛卡尔网格和一个局部的 $3\\times 3$ 节点片。假设热导率张量为常数，并由下式给出\n$$\n\\mathbf{K}=\\mathbf{R}(\\gamma)\\,\\mathrm{diag}(\\alpha,\\beta)\\,\\mathbf{R}(\\gamma)^{\\top},\n$$\n其中 $\\alpha=100$ 和 $\\beta=1$ 分别代表沿场和跨场的热导率，$\\mathbf{R}(\\gamma)$ 是相对于 $x$ 轴旋转角度 $\\gamma=\\pi/6$ 弧度的旋转矩阵。稳态传导的控制线性算子是对称正定算子 $-\\nabla\\cdot(\\mathbf{K}\\nabla u)$。\n\n在此均匀网格上使用二阶中心有限差分，离散化 $-\\nabla\\cdot(\\mathbf{K}\\nabla u)$，并通过连接在得到的 $9$ 点模板（网格索引中水平、垂直和对角线偏移为 $\\pm 1$）中作为邻居出现的节点对，构建该 $3\\times 3$ 节点片的无向邻接图。对于代数多重网格(AMG)，如果对称连接强度不等式\n$$\n|a_{ij}|\\ge \\theta\\,a_{ii}\n$$\n在 $\\theta=0.25$ 的条件下成立，则将节点 $i$ 和 $j$ 之间的无向边分类为“强”连接。其中 $a_{ij}$ 是与节点对 $(i,j)$ 相关联的非对角模板系数，$a_{ii}$ 是对角系数，所有这些系数都是从常数张量 $\\mathbf{K}$ 和 $h=1$ 计算得出的。\n\n确定 $3 \\times 3$ 邻接图中的强无向边总数。将最终答案表示为一个不带单位的整数。",
            "solution": "题目要求计算 $3 \\times 3$ 节点网格邻接图中的“强”无向边总数。边的强度由各向异性扩散算子 $L u = -\\nabla\\cdot(\\mathbf{K}\\nabla u)$ 的有限差分模板的系数决定。\n\n首先，我们必须计算常数热导率张量 $\\mathbf{K}$。它由 $\\mathbf{K}=\\mathbf{R}(\\gamma)\\,\\mathrm{diag}(\\alpha,\\beta)\\,\\mathbf{R}(\\gamma)^{\\top}$ 给出，其中 $\\alpha=100$，$\\beta=1$，$\\gamma=\\pi/6$。旋转矩阵 $\\mathbf{R}(\\gamma)$ 由下式给出\n$$\n\\mathbf{R}(\\gamma) = \\begin{pmatrix} \\cos\\gamma  -\\sin\\gamma \\\\ \\sin\\gamma  \\cos\\gamma \\end{pmatrix}\n$$\n对于 $\\gamma=\\pi/6$，我们有 $\\cos(\\pi/6) = \\sqrt{3}/2$ 和 $\\sin(\\pi/6) = 1/2$。因此，\n$$\n\\mathbf{R}(\\pi/6) = \\begin{pmatrix} \\frac{\\sqrt{3}}{2}  -\\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{\\sqrt{3}}{2} \\end{pmatrix}\n$$\n对角张量为 $\\mathrm{diag}(\\alpha, \\beta) = \\begin{pmatrix} 100  0 \\\\ 0  1 \\end{pmatrix}$。我们现在可以计算 $\\mathbf{K}$：\n$$\n\\mathbf{K} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2}  -\\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{\\sqrt{3}}{2} \\end{pmatrix} \\begin{pmatrix} 100  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{\\sqrt{3}}{2}  \\frac{1}{2} \\\\ -\\frac{1}{2}  \\frac{\\sqrt{3}}{2} \\end{pmatrix}\n$$\n$\\mathbf{K} = \\begin{pmatrix} K_{11}  K_{12} \\\\ K_{21}  K_{22} \\end{pmatrix}$ 的分量通常由以下公式给出：\n$K_{11} = \\alpha\\cos^2\\gamma + \\beta\\sin^2\\gamma$\n$K_{22} = \\alpha\\sin^2\\gamma + \\beta\\cos^2\\gamma$\n$K_{12} = K_{21} = (\\alpha - \\beta)\\sin\\gamma\\cos\\gamma$\n\n代入数值 $\\alpha=100$，$\\beta=1$ 和 $\\gamma=\\pi/6$：\n$$\nK_{11} = 100\\left(\\frac{\\sqrt{3}}{2}\\right)^2 + 1\\left(\\frac{1}{2}\\right)^2 = 100\\left(\\frac{3}{4}\\right) + \\frac{1}{4} = 75 + \\frac{1}{4} = \\frac{301}{4}\n$$\n$$\nK_{22} = 100\\left(\\frac{1}{2}\\right)^2 + 1\\left(\\frac{\\sqrt{3}}{2}\\right)^2 = 100\\left(\\frac{1}{4}\\right) + \\frac{3}{4} = 25 + \\frac{3}{4} = \\frac{103}{4}\n$$\n$$\nK_{12} = K_{21} = (100 - 1)\\left(\\frac{1}{2}\\right)\\left(\\frac{\\sqrt{3}}{2}\\right) = 99\\frac{\\sqrt{3}}{4}\n$$\n\n接下来，我们离散化算子 $L u = -\\nabla\\cdot(\\mathbf{K}\\nabla u)$。由于 $\\mathbf{K}$ 是常数，该算子展开为：\n$$\nL u = -K_{11}\\frac{\\partial^2 u}{\\partial x^2} - 2K_{12}\\frac{\\partial^2 u}{\\partial x \\partial y} - K_{22}\\frac{\\partial^2 u}{\\partial y^2}\n$$\n我们在间距为 $h=1$ 的均匀网格上使用二阶中心有限差分。令 $u_{i,j}$ 表示 $u(ih, jh)$。近似式为：\n$$\n\\frac{\\partial^2 u}{\\partial x^2} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h^2}\n$$\n$$\n\\frac{\\partial^2 u}{\\partial y^2} \\approx \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h^2}\n$$\n$$\n\\frac{\\partial^2 u}{\\partial x \\partial y} \\approx \\frac{u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}}{4h^2}\n$$\n将这些代入 $L u$ 的表达式，并设 $h=1$，作用于中心节点 $(i,j)$ 的离散算子 $(L_h u)_{i,j}$ 为：\n$$\n(L_h u)_{i,j} = -K_{11}(u_{i+1,j} - 2u_{i,j} + u_{i-1,j}) - \\frac{K_{12}}{2}(u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}) - K_{22}(u_{i,j+1} - 2u_{i,j} + u_{i,j-1})\n$$\n待求解的线性系统形式为 $\\mathbf{A} \\mathbf{u} = \\mathbf{f}$，其中矩阵 $\\mathbf{A}$ 的元素对应于 $(L_h u)_{i,j}$ 表达式中 $u$ 的系数。对角系数 $a_{ii}$（对于与网格点 $(i,j)$ 对应的节点 $i$）是 $u_{i,j}$ 的系数，非对角系数 $a_{ij}$ 是相邻 $u$ 值的系数。\n\n从 $(L_h u)_{i,j}$ 的表达式中，我们提取模板系数：\n- 对角系数 ($a_{ii}$): $a_{\\text{center}} = 2K_{11} + 2K_{22}$\n- 非对角系数 ($a_{ij}$):\n  - 东/西 ($u_{i\\pm 1, j}$): $a_{E,W} = -K_{11}$\n  - 北/南 ($u_{i, j\\pm 1}$): $a_{N,S} = -K_{22}$\n  - 东北/西南 ($u_{i\\pm 1, j\\pm 1}$): $a_{NE,SW} = -K_{12}/2$\n  - 西北/东南 ($u_{i\\mp 1, j\\pm 1}$): $a_{NW,SE} = +K_{12}/2$\n\n由于张量 $\\mathbf{K}$ 在整个网格上是常数，所以每个内部节点的模板系数都相同。\n对角系数为：\n$$\na_{ii} = 2\\left(\\frac{301}{4}\\right) + 2\\left(\\frac{103}{4}\\right) = \\frac{301+103}{2} = \\frac{404}{2} = 202\n$$\n非对角系数为：\n$$\na_{E,W} = -\\frac{301}{4} = -75.25\n$$\n$$\na_{N,S} = -\\frac{103}{4} = -25.75\n$$\n$$\na_{NE,SW} = -\\frac{1}{2}\\left(\\frac{99\\sqrt{3}}{4}\\right) = -\\frac{99\\sqrt{3}}{8} \\approx -21.434\n$$\n$$\na_{NW,SE} = +\\frac{1}{2}\\left(\\frac{99\\sqrt{3}}{4}\\right) = +\\frac{99\\sqrt{3}}{8} \\approx 21.434\n$$\n连接强度准则为 $|a_{ij}| \\ge \\theta a_{ii}$，其中 $\\theta=0.25$。\n阈值为 $\\theta a_{ii} = 0.25 \\times 202 = 50.5$。\n\n我们现在根据此阈值测试每种连接类型：\n1.  水平连接（东、西）：$|a_{E,W}| = \\left|-\\frac{301}{4}\\right| = 75.25$。由于 $75.25 \\ge 50.5$，这些连接是**强**连接。\n2.  垂直连接（北、南）：$|a_{N,S}| = \\left|-\\frac{103}{4}\\right| = 25.75$。由于 $25.75  50.5$，这些连接是**弱**连接。\n3.  对角连接（东北、西南、西北、东南）：$|a_{\\text{diag}}| = \\left|\\pm\\frac{99\\sqrt{3}}{8}\\right| = \\frac{99\\sqrt{3}}{8}$。为了将其与 $50.5 = 101/2$ 比较，我们比较 $99\\sqrt{3}/8$ 与 $404/8$。这等价于比较 $99\\sqrt{3}$ 与 $404$。两边平方：$(99\\sqrt{3})^2 = 9801 \\times 3 = 29403$，而 $404^2 = 163216$。显然 $29403  163216$，所以 $\\frac{99\\sqrt{3}}{8}  50.5$。所有对角连接都是**弱**连接。\n\n分析表明，只有水平连接（节点与其东、西邻居之间的连接）是强连接。问题要求计算 $3 \\times 3$ 邻接图中的强无向边总数。让我们将网格节点表示为 $(x,y)$，其中 $x,y \\in \\{0, 1, 2\\}$。\n水平边连接 $(x,y)$ 和 $(x+1,y)$。\n- 对于行 $y=0$：在 $(0,0)$ 和 $(1,0)$ 之间，以及 $(1,0)$ 和 $(2,0)$ 之间存在边。即 $2$ 条边。\n- 对于行 $y=1$：在 $(0,1)$ 和 $(1,1)$ 之间，以及 $(1,1)$ 和 $(2,1)$ 之间存在边。即 $2$ 条边。\n- 对于行 $y=2$：在 $(0,2)$ 和 $(1,2)$ 之间，以及 $(1,2)$ 和 $(2,2)$ 之间存在边。即 $2$ 条边。\n\n强无向边的总数是每行中强连接边数的总和：$2 + 2 + 2 = 6$。",
            "answer": "$$\n\\boxed{6}\n$$"
        },
        {
            "introduction": "学习了如何应用经典的连接强度判据后，理解其局限性至关重要。这个练习要求你从理论上推导出一个反例，证明在特定的旋转角度下，经典方法会错误地将物理上最强的连接识别为弱连接。这一推导揭示了为何需要更先进的AMG方法来处理复杂的各向异性问题，为你提供了深刻的概念性理解。",
            "id": "3949946",
            "problem": "在磁化聚变等离子体中，平行输运张量可以建模为与磁场对齐的各向异性扩散张量，该张量可能相对于计算网格发生旋转。考虑二维常系数各向异性扩散算子\n$$\n\\mathcal{L} u = -\\nabla \\cdot \\left( \\mathbf{K} \\nabla u \\right),\n$$\n其扩散张量为\n$$\n\\mathbf{K} = \\mathbf{R}(\\phi)\\,\\mathrm{diag}(1,\\epsilon)\\,\\mathbf{R}(\\phi)^{\\top},\n$$\n其中 $0  \\epsilon \\ll 1$ 是各向异性比（垂直扩散系数与平行扩散系数之比），$\\mathbf{R}(\\phi)$ 是相对于 $x$ 轴旋转角度 $\\phi$ 的旋转矩阵。在间距为 $h$ 的均匀笛卡尔网格上，使用二阶中心差分对 $u_{xx}$、$u_{yy}$ 和 $u_{xy}$ 进行离散化，得到一个九点格式。将所得矩阵记为 $\\mathbf{A}$，其具有标准的5个轴向邻点和4个对角邻点。\n\nRuge–Stüben 类型的代数多重网格（AMG）中的经典连接强度定义为：如果\n$$\n-a_{ij} \\ge \\theta \\max_{k \\ne i,\\, a_{ik}  0} \\left( -a_{ik} \\right),\n$$\n则节点 $j$ 与节点 $i$ 是强连接的，其中阈值为 $\\theta \\in (0,1)$，并且只考虑负的非对角元 $a_{ik}  0$（这与M-矩阵的设定一致）。在旋转各向异性的情况下，物理上关键的耦合与磁场方向对齐，而该方向可能与网格的对角线方向重合。\n\n假设 $0  \\phi  \\pi/4$，因此强扩散方向发生了旋转但未超过第一象限对角线，并取高度各向异性极限 $\\epsilon \\to 0^{+}$。使用上述离散化和定义，推导比率 $r(\\phi)$，该比率是与强扩散方向对齐的负对角系数的量值与同一行中最大的负非对角轴向系数的量值之比。然后，对于经典选择 $\\theta = 1/4$，确定最大的旋转角 $\\phi_{\\star} \\in (0,\\pi/4)$（以弧度为单位），使得负对角邻点未通过强连接测试，即 $r(\\phi)  \\theta$。请以初等函数的形式给出 $\\phi_{\\star}$ 的闭式解析表达式（以弧度表示）。无需进行数值四舍五入。",
            "solution": "用户希望找到临界旋转角 $\\phi_{\\star}$，在该角度下，各向异性扩散问题在离散化后，对于一个特定的邻点，会导致代数多重网格（AMG）的强连接测试失败。\n\n求解过程分为以下几个步骤：\n1.  推导各向异性扩散张量 $\\mathbf{K}$ 的分量。\n2.  展开扩散算子 $\\mathcal{L}u = -\\nabla \\cdot (\\mathbf{K} \\nabla u)$。\n3.  在均匀笛卡尔网格上离散化该算子，以求出格式系数。\n4.  应用高度各向异性极限 $\\epsilon \\to 0^{+}$。\n5.  根据问题陈述，构建比率 $r(\\phi)$。\n6.  使用 AMG 强连接准则求出临界角 $\\phi_{\\star}$。\n\n**步骤 1：扩散张量**\n\n扩散张量由 $\\mathbf{K} = \\mathbf{R}(\\phi)\\,\\mathrm{diag}(1,\\epsilon)\\,\\mathbf{R}(\\phi)^{\\top}$ 给出，其中 $\\mathbf{R}(\\phi)$ 是旋转矩阵：\n$$\n\\mathbf{R}(\\phi) = \\begin{pmatrix} \\cos\\phi  -\\sin\\phi \\\\ \\sin\\phi  \\cos\\phi \\end{pmatrix}\n$$\n我们记 $c = \\cos\\phi$ 和 $s = \\sin\\phi$。张量 $\\mathbf{K}$ 的计算如下：\n$$\n\\mathbf{K} = \\begin{pmatrix} c  -s \\\\ s  c \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix} \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix} = \\begin{pmatrix} c  -\\epsilon s \\\\ s  \\epsilon c \\end{pmatrix} \\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix}\n$$\n$$\n\\mathbf{K} = \\begin{pmatrix} c^2 + \\epsilon s^2  cs - \\epsilon sc \\\\ sc - \\epsilon sc  s^2 + \\epsilon c^2 \\end{pmatrix} = \\begin{pmatrix} c^2 + \\epsilon s^2  (1-\\epsilon)sc \\\\ (1-\\epsilon)sc  s^2 + \\epsilon c^2 \\end{pmatrix}\n$$\n张量的分量为：\n$K_{xx} = \\cos^2\\phi + \\epsilon \\sin^2\\phi$\n$K_{yy} = \\sin^2\\phi + \\epsilon \\cos^2\\phi$\n$K_{xy} = K_{yx} = (1-\\epsilon)\\sin\\phi\\cos\\phi$\n\n**步骤 2：微分算子**\n\n算子为 $\\mathcal{L}u = -\\nabla \\cdot (\\mathbf{K} \\nabla u)$。使用常系数 $K_{ij}$ 将其展开：\n$$\n\\mathcal{L}u = -\\left( \\frac{\\partial}{\\partial x}(K_{xx}u_x + K_{xy}u_y) + \\frac{\\partial}{\\partial y}(K_{yx}u_x + K_{yy}u_y) \\right)\n$$\n$$\n\\mathcal{L}u = -(K_{xx}u_{xx} + K_{xy}u_{xy} + K_{yx}u_{yx} + K_{yy}u_{yy})\n$$\n由于 $u_{xy} = u_{yx}$，上式可简化为：\n$$\n\\mathcal{L}u = -(K_{xx}u_{xx} + 2K_{xy}u_{xy} + K_{yy}u_{yy})\n$$\n\n**步骤 3：离散化和格式系数**\n\n我们在间距为 $h$ 的网格上对点 $(i,j)$ 使用二阶中心差分：\n$u_{xx} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h^2}$\n$u_{yy} \\approx \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h^2}$\n$u_{xy} \\approx \\frac{u_{i+1,j+1} - u_{i+1,j-1} - u_{i-1,j+1} + u_{i-1,j-1}}{4h^2}$\n\n将这些代入 $\\mathcal{L}u$ 的表达式中，得到离散算子。所得的线性系统形式为 $\\mathbf{A}u=f$。矩阵 $\\mathbf{A}$ 的非对角元，特别是对应于中心节点 $i$ 的行中的元素 $a_{i,j}$，与相邻节点值 $u_j$ 的系数成正比。AMG 的连接强度准则与一个正常数缩放无关，因此我们可以通过将格式系数视为矩阵 $\\tilde{\\mathbf{A}} = -h^2\\mathbf{A}$ 的元素来进行分析。节点 $(i,j)$ 的邻点的非对角系数为：\n- 东 ($i+1,j$): $-\\tilde{a}_{i,E} = K_{xx}$\n- 西 ($i-1,j$): $-\\tilde{a}_{i,W} = K_{xx}$\n- 北 ($i,j+1$): $-\\tilde{a}_{i,N} = K_{yy}$\n- 南 ($i,j-1$): $-\\tilde{a}_{i,S} = K_{yy}$\n- 东北 ($i+1,j+1$): $-\\tilde{a}_{i,NE} = K_{xy}/2$\n- 西南 ($i-1,j-1$): $-\\tilde{a}_{i,SW} = K_{xy}/2$\n- 西北 ($i-1,j+1$): $\\tilde{a}_{i,NW} = K_{xy}/2$\n- 东南 ($i+1,j-1$): $\\tilde{a}_{i,SE} = K_{xy}/2$\n\n由于 $c>0$, $s>0$, $1-\\epsilon>0$，我们有 $K_{xx}, K_{yy}, K_{xy}$ 均为正。AMG 准则只考虑负的非对角元。这些是与东、西、北、南、东北和西南邻点的连接。\n\n**步骤 4：高度各向异性极限**\n\n在极限 $\\epsilon \\to 0^{+}$ 下，张量分量简化为：\n$K_{xx} \\to \\cos^2\\phi = c^2$\n$K_{yy} \\to \\sin^2\\phi = s^2$\n$K_{xy} \\to \\sin\\phi\\cos\\phi = sc$\n\n负非对角格式系数的量值变为：\n- 轴向 (东, 西): $|-\\tilde{a}_{i,E/W}| \\to c^2$\n- 轴向 (北, 南): $|-\\tilde{a}_{i,N/S}| \\to s^2$\n- 对角向 (东北, 西南): $|-\\tilde{a}_{i,NE/SW}| \\to \\frac{sc}{2}$\n\n**步骤 5：构建比率 $r(\\phi)$**\n\n问题要求的是比率 $r(\\phi)$，定义为：\n$$\nr(\\phi) = \\frac{\\text{与强扩散方向对齐的负对角系数的量值}}{\\text{最大的负非对角轴向系数的量值}}\n$$\n- 强扩散方向与 x 轴成 $\\phi \\in (0, \\pi/4)$ 角。该方向位于正 x 轴与网格东北对角线之间。因此，“与强扩散方向对齐的负对角系数”指的是与东北邻点的耦合，其量值为 $|-\\tilde{a}_{i,NE}| \\to sc/2$。\n- 轴向系数的量值为 $c^2$ 和 $s^2$。对于 $\\phi \\in (0, \\pi/4)$，我们有 $\\cos\\phi > \\sin\\phi > 0$，这意味着 $c^2 > s^2$。因此，最大的负非对角轴向系数的量值为 $c^2$。\n\n于是，比率 $r(\\phi)$ 为：\n$$\nr(\\phi) = \\frac{sc/2}{c^2} = \\frac{s}{2c} = \\frac{\\sin\\phi}{2\\cos\\phi} = \\frac{1}{2}\\tan\\phi\n$$\n\n**步骤 6：AMG 强连接测试**\n\nRuge-Stüben 强连接准则规定，如果 $-a_{ij} \\ge \\theta \\max_{k \\ne i, a_{ik}  0}(-a_{ik})$，则节点 $j$ 与节点 $i$ 是强连接的。如果不满足此不等式，则测试失败。我们关心的是东北邻点何时未通过测试。失败的条件是：\n$$\n|-\\tilde{a}_{i,NE}|  \\theta \\max_{k \\ne i, \\tilde{a}_{ik}  0}(|-\\tilde{a}_{ik}|)\n$$\n右侧的最大值是在所有负非对角连接上取。在极限 $\\epsilon \\to 0^{+}$ 下，这些量值为 $\\{c^2, s^2, sc/2\\}$。对于 $\\phi \\in (0, \\pi/4)$，我们比较它们：\n- 因为 $c > s$，所以 $c^2 > s^2$。\n- $c^2$ 与 $sc/2$ 的比较：这等价于比较 $c$ 与 $s/2$。由于 $c > 1/\\sqrt{2}$ 且 $s  1/\\sqrt{2}$，我们有 $s/2  1/(2\\sqrt{2}) \\approx 0.354$。又因为 $c > 0.707$，显然 $c > s/2$，所以 $c^2 > sc/2$。\n最大量值为 $c^2$。\n东北邻点测试失败的条件是：\n$$\n\\frac{sc}{2}  \\theta (c^2)\n$$\n两边除以 $c^2$（非零），我们得到：\n$$\n\\frac{s}{2c}  \\theta \\implies \\frac{1}{2}\\tan\\phi  \\theta\n$$\n这可以写成 $r(\\phi)  \\theta$，与问题陈述一致。问题要求的是使得测试失败的最大角度 $\\phi_{\\star}$。这对应于失败区域的边界，即 $r(\\phi_{\\star}) = \\theta$。\n给定 $\\theta = 1/4$：\n$$\nr(\\phi_{\\star}) = \\frac{1}{2}\\tan(\\phi_{\\star}) = \\frac{1}{4}\n$$\n$$\n\\tan(\\phi_{\\star}) = \\frac{1}{2}\n$$\n求解 $\\phi_{\\star}$：\n$$\n\\phi_{\\star} = \\arctan\\left(\\frac{1}{2}\\right)\n$$\n我们必须验证这个角度在指定的范围 $(0, \\pi/4)$ 内。由于 $\\tan(\\pi/4)=1$ 和 $\\tan(0)=0$，且 $\\arctan$ 是一个严格递增函数，我们有 $0  \\arctan(1/2)  \\arctan(1) = \\pi/4$。条件满足。角度 $\\phi_{\\star}$ 是使得连接为弱的角度集合的上确界。",
            "answer": "$$\n\\boxed{\\arctan\\left(\\frac{1}{2}\\right)}\n$$"
        },
        {
            "introduction": "基于前一个练习所揭示的局限性，本实践介绍了一种更稳健、更现代的连接强度定义方法。通过直接比较经典的Ruge–Stüben方法和一种基于代数距离（algebraic-distance）的方法，你将亲眼看到不同的强度度量如何产生截然不同的粗网格。这个练习强调了利用近零空间信息来指导各向异性算子粗化过程的重要性。",
            "id": "3949909",
            "problem": "考虑一个磁约束聚变等离子体，其中跨场输运是高度各向异性的。设扩散张量与磁场方向对齐，相对于 $x$ 轴的角度为 $\\phi$，具有强扩散系数 $D_{\\parallel}$ 和弱扩散系数 $D_{\\perp}$。连续统算子是旋转后的扩散算子\n$$\n\\mathcal{L} u = - \\nabla \\cdot \\left( \\mathbf{K} \\nabla u \\right),\n$$\n其中传导张量 $\\mathbf{K}$ 由下式给出\n$$\n\\mathbf{K} = \\mathbf{R}(\\phi) \\begin{pmatrix} D_{\\parallel}  0 \\\\ 0  D_{\\perp} \\end{pmatrix} \\mathbf{R}(\\phi)^{\\top}, \\quad \\mathbf{R}(\\phi) = \\begin{pmatrix} \\cos\\phi  -\\sin\\phi \\\\ \\sin\\phi  \\cos\\phi \\end{pmatrix}.\n$$\n取 $D_{\\parallel} = 1$，$D_{\\perp} = 10^{-3}$，$\\phi = \\pi/6$，以及间距为 $h=1$ 的均匀方形网格。在内部网格点 $(0,0)$ 处，使用 $\\mathcal{L}$ 的标准九点有限差分离散，得到一个具有以下系数的 $9$ 点模板：\n- 轴上邻点：$a_{E} = a_{W} = -k_{xx}/h^{2}$，$a_{N} = a_{S} = -k_{yy}/h^{2}$，\n- 来自混合导数的对角邻点：$a_{NE} = a_{SW} = -k_{xy}/(2 h^{2})$，$a_{NW} = a_{SE} = +k_{xy}/(2 h^{2})$，\n其中 $k_{xx}$，$k_{yy}$ 和 $k_{xy}$ 是 $\\mathbf{K}$ 的元素。\n\n对于代数多重网格（AMG），在 $(0,0)$ 处定义两种连接强度概念：\n1. 经典连接强度（Ruge–Stüben）：如果 $-a_{ij} \\ge \\theta \\max\\{-a_{ik} : a_{ik}  0\\}$ 且 $\\theta = 1/4$，则邻点 $(i,j)$ 是强连接，其中只考虑具有负非对角系数 $a_{ik}  0$ 的邻点。\n2. 代数距离连接强度：给定两个沿场方向近似平滑误差的测试向量，\n$$\nv^{(1)}(x,y) = \\cos(\\alpha x_{\\parallel}), \\quad v^{(2)}(x,y) = \\sin(\\alpha x_{\\parallel}), \\quad x_{\\parallel} = x \\cos\\phi + y \\sin\\phi,\n$$\n其中 $\\alpha = 0.2$，定义到具有位移 $\\mathbf{r}_{ij}$ 的邻点 $(i,j)$ 的代数距离为\n$$\nd_{ij} = \\frac{1}{\\left(v^{(1)}(0,0) - v^{(1)}(i,j)\\right)^{2} + \\left(v^{(2)}(0,0) - v^{(2)}(i,j)\\right)^{2}} = \\frac{1}{2\\left(1 - \\cos\\left(\\alpha\\, \\mathbf{d}\\cdot \\mathbf{r}_{ij}\\right)\\right)},\n$$\n其中 $\\mathbf{d} = (\\cos\\phi, \\sin\\phi)$。如果 $d_{ij} \\ge \\tau \\max\\{ d_{ik} \\}$ 且 $\\tau = 0.7$，则邻点是强连接。\n\n显式计算：\n- 元素 $k_{xx}$、$k_{yy}$、$k_{xy}$，以及在 $(0,0)$ 点产生的模板系数 $a_{ij}$，\n- 经典强连接邻点的集合及其基数 $N_{\\mathrm{classical}}$，\n- $(0,0)$ 点的所有八个邻点的代数距离 $d_{ij}$，以及代数距离强连接邻点的集合及其基数 $N_{\\mathrm{AD}}$。\n\n最后，计算差值\n$$\n\\Delta = N_{\\mathrm{AD}} - N_{\\mathrm{classical}}.\n$$\n将您的最终答案表示为 $\\Delta$ 的精确整数值。无需四舍五入。",
            "solution": "用户想要计算在一个应用于各向异性扩散问题的代数多重网格方法中，由两种不同准则确定的强连接邻点数量之间的差异。\n\n首先，我们计算传导张量 $\\mathbf{K}$ 的元素。\n给定的参数是：\n- 扩散系数：$D_{\\parallel} = 1$，$D_{\\perp} = 10^{-3} = \\frac{1}{1000}$。\n- 角度：$\\phi = \\pi/6$。\n- 网格间距：$h=1$。\n\n角度 $\\phi$ 的三角函数值为 $\\cos\\phi = \\frac{\\sqrt{3}}{2}$ 和 $\\sin\\phi = \\frac{1}{2}$。\n传导张量 $\\mathbf{K} = \\begin{pmatrix} k_{xx}  k_{xy} \\\\ k_{yx}  k_{yy} \\end{pmatrix}$ 由 $\\mathbf{K} = \\mathbf{R}(\\phi) \\mathbf{D} \\mathbf{R}(\\phi)^{\\top}$ 给出，其中 $\\mathbf{D} = \\begin{pmatrix} D_{\\parallel}  0 \\\\ 0  D_{\\perp} \\end{pmatrix}$。\n$\\mathbf{K}$ 的元素由以下公式给出：\n$k_{xx} = D_{\\parallel} \\cos^2\\phi + D_{\\perp} \\sin^2\\phi$\n$k_{yy} = D_{\\parallel} \\sin^2\\phi + D_{\\perp} \\cos^2\\phi$\n$k_{xy} = (D_{\\parallel} - D_{\\perp}) \\sin\\phi \\cos\\phi$\n\n代入给定值：\n$k_{xx} = 1 \\cdot \\left(\\frac{\\sqrt{3}}{2}\\right)^2 + 10^{-3} \\cdot \\left(\\frac{1}{2}\\right)^2 = \\frac{3}{4} + \\frac{1}{1000} \\cdot \\frac{1}{4} = \\frac{3}{4} + \\frac{1}{4000} = \\frac{3000+1}{4000} = \\frac{3001}{4000} = 0.75025$。\n$k_{yy} = 1 \\cdot \\left(\\frac{1}{2}\\right)^2 + 10^{-3} \\cdot \\left(\\frac{\\sqrt{3}}{2}\\right)^2 = \\frac{1}{4} + \\frac{1}{1000} \\cdot \\frac{3}{4} = \\frac{1}{4} + \\frac{3}{4000} = \\frac{1000+3}{4000} = \\frac{1003}{4000} = 0.25075$。\n$k_{xy} = (1 - 10^{-3}) \\left(\\frac{1}{2}\\right) \\left(\\frac{\\sqrt{3}}{2}\\right) = \\left(1 - \\frac{1}{1000}\\right) \\frac{\\sqrt{3}}{4} = \\frac{999}{1000} \\frac{\\sqrt{3}}{4} = \\frac{999\\sqrt{3}}{4000}$。\n\n接下来，我们使用 $h=1$ 计算网格点 $(0,0)$ 处的 $9$ 点模板系数：\n- $a_{E} = a_{W} = -k_{xx}/h^{2} = -\\frac{3001}{4000}$。\n- $a_{N} = a_{S} = -k_{yy}/h^{2} = -\\frac{1003}{4000}$。\n- $a_{NE} = a_{SW} = -k_{xy}/(2h^{2}) = -\\frac{999\\sqrt{3}}{8000}$。\n- $a_{NW} = a_{SE} = +k_{xy}/(2h^{2}) = +\\frac{999\\sqrt{3}}{8000}$。\n\n现在，我们确定经典强连接邻点的集合。该准则仅适用于具有负非对角系数 $a_{ij}  0$ 的邻点。这些是 E (东), W (西), N (北), S (南), NE (东北), 和 SW (西南)。\nRuge-Stüben 强度条件是 $-a_{ij} \\ge \\theta \\max\\{-a_{ik} : a_{ik}  0\\}$，其中 $\\theta = 1/4$。\n让我们找到 $\\{-a_{ik}\\}$ 的最大值：\n$-a_{E} = -a_{W} = \\frac{3001}{4000} = 0.75025$。\n$-a_{N} = -a_{S} = \\frac{1003}{4000} = 0.25075$。\n$-a_{NE} = -a_{SW} = \\frac{999\\sqrt{3}}{8000} \\approx \\frac{999 \\cdot 1.732}{8000} \\approx 0.21629$。\n最大值为 $M = \\max\\{-a_{ik}\\} = \\frac{3001}{4000}$。\n强度阈值为 $\\theta M = \\frac{1}{4} \\cdot \\frac{3001}{4000} = \\frac{3001}{16000} = 0.1875625$。\n我们检查每个连接：\n- 对于 E, W: $-a_E = \\frac{3001}{4000} \\ge \\frac{3001}{16000}$。这是成立的。E 和 W 是强连接。\n- 对于 N, S: $-a_N = \\frac{1003}{4000}$。我们检查是否 $\\frac{1003}{4000} \\ge \\frac{3001}{16000}$，这等价于 $4 \\cdot 1003 \\ge 3001$，或 $4012 \\ge 3001$。这是成立的。N 和 S 是强连接。\n- 对于 NE, SW: $-a_{NE} = \\frac{999\\sqrt{3}}{8000}$。我们检查是否 $\\frac{999\\sqrt{3}}{8000} \\ge \\frac{3001}{16000}$，这可以简化为 $2 \\cdot 999\\sqrt{3} \\ge 3001$，或 $1998\\sqrt{3} \\ge 3001$。两边平方，我们检查 $(1998\\sqrt{3})^2 \\ge 3001^2$，即 $1998^2 \\cdot 3 \\ge 3001^2$，或 $3992004 \\cdot 3 \\ge 9006001$，所以 $11976012 \\ge 9006001$。这是成立的。NE 和 SW 是强连接。\n所有六个具有负系数的邻点都是强连接。因此，经典强连接邻点的数量为 $N_{\\mathrm{classical}} = 6$。\n\n接下来，我们确定代数距离强连接邻点。代数距离由 $d_{ij} = \\frac{1}{2\\left(1 - \\cos\\left(\\alpha\\, \\mathbf{d}\\cdot \\mathbf{r}_{ij}\\right)\\right)}$ 给出，其中 $\\alpha = 0.2$，$\\mathbf{d} = (\\cos\\phi, \\sin\\phi) = (\\frac{\\sqrt{3}}{2}, \\frac{1}{2})$，而 $\\mathbf{r}_{ij}$ 是到邻点的位移向量。\n一个大的距离 $d_{ij}$ 对应于一个强连接。当余弦函数的参数 $\\alpha\\, \\mathbf{d}\\cdot \\mathbf{r}_{ij}$ 接近于零时，会发生这种情况。我们需要通过最小化 $|\\mathbf{d}\\cdot \\mathbf{r}_{ij}|$ 来找到使 $d_{ij}$ 最大化的邻点 $(i,j)$。\n位移向量是 $\\mathbf{r}_E=(1,0), \\mathbf{r}_W=(-1,0), \\mathbf{r}_N=(0,1), \\mathbf{r}_S=(0,-1), \\mathbf{r}_{NE}=(1,1), \\mathbf{r}_{NW}=(-1,1), \\mathbf{r}_{SE}=(1,-1), \\mathbf{r}_{SW}=(-1,-1)$。\n点积是：\n- $\\mathbf{d} \\cdot \\mathbf{r}_{E/W} = \\pm \\frac{\\sqrt{3}}{2}$\n- $\\mathbf{d} \\cdot \\mathbf{r}_{N/S} = \\pm \\frac{1}{2}$\n- $\\mathbf{d} \\cdot \\mathbf{r}_{NE/SW} = \\pm \\frac{\\sqrt{3}+1}{2}$\n- $\\mathbf{d} \\cdot \\mathbf{r}_{NW/SE} = \\pm \\frac{1-\\sqrt{3}}{2}$ 或 $\\pm \\frac{\\sqrt{3}-1}{2}$\n点积的绝对值是：\n$|\\mathbf{d} \\cdot \\mathbf{r}_{E/W}| = \\frac{\\sqrt{3}}{2} \\approx 0.866$\n$|\\mathbf{d} \\cdot \\mathbf{r}_{N/S}| = \\frac{1}{2} = 0.5$\n$|\\mathbf{d} \\cdot \\mathbf{r}_{NE/SW}| = \\frac{\\sqrt{3}+1}{2} \\approx 1.366$ (最大)\n$|\\mathbf{d} \\cdot \\mathbf{r}_{NW/SE}| = \\frac{\\sqrt{3}-1}{2} \\approx 0.366$ (最小)\n最大代数距离 $D_{\\max}$ 出现在最小绝对点积处，这对应于邻点 NW 和 SE。\n$D_{\\max} = d_{NW} = d_{SE}$。\n强度条件是 $d_{ij} \\ge \\tau D_{\\max}$，其中 $\\tau = 0.7$。这等价于 $d_{ij} \\ge 0.7 d_{SE}$。\n由于 $d_{ij}$ 是 $|\\mathbf{d} \\cdot \\mathbf{r}_{ij}|$ 的单调递减函数，这个不等式等价于 $|\\mathbf{d} \\cdot \\mathbf{r}_{ij}|$ 足够小。\n让我们检查邻点 N（和 S）的条件：$d_N \\ge 0.7 d_{SE}$。\n即 $\\frac{1}{2(1-\\cos(\\alpha/2))} \\ge 0.7 \\frac{1}{2(1-\\cos(\\alpha(\\sqrt{3}-1)/2))}$。\n$1-\\cos(\\alpha\\frac{\\sqrt{3}-1}{2}) \\ge 0.7(1-\\cos(\\alpha/2))$。\n使用 $\\alpha = 0.2=1/5$，以及对于小 $x$ 的近似 $1-\\cos(x) \\approx x^2/2$：\n$(\\alpha\\frac{\\sqrt{3}-1}{2})^2/2 \\ge 0.7 (\\alpha/2)^2/2 \\implies (\\sqrt{3}-1)^2 \\ge 0.7$。\n$(\\sqrt{3}-1)^2 = 3 - 2\\sqrt{3} + 1 = 4-2\\sqrt{3} \\approx 4 - 2(1.73205) = 4 - 3.4641 = 0.5359$。\n不等式 $0.5359 \\ge 0.7$ 不成立。所以，N 和 S 不是强连接。\nE/W 和 NE/SW 的点积的绝对值更大，因此它们的距离 $d_{ij}$ 会更小，它们同样不会满足强度准则。\n在代数距离准则下，只有邻点 NW 和 SE 是强连接。\n因此，强连接邻点的数量为 $N_{\\mathrm{AD}} = 2$。\n\n最后，我们计算差值 $\\Delta$：\n$\\Delta = N_{\\mathrm{AD}} - N_{\\mathrm{classical}} = 2 - 6 = -4$。",
            "answer": "$$\\boxed{-4}$$"
        }
    ]
}