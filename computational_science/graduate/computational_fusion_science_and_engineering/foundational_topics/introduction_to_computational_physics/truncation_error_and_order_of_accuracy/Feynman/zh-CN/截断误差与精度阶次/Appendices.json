{
    "hands_on_practices": [
        {
            "introduction": "分析任何有限差分格式的基础都是泰勒级数展开。本练习旨在提供运用这一核心技术的直接实践，演示如何为高阶格式推导主截断误差项，并确认其精度阶数。通过这个过程，我们能够从根本上理解离散化是如何引入误差的，以及这些误差如何随网格尺寸的变化而变化。",
            "id": "4149911",
            "problem": "考虑一维（$1\\mathrm{D}$）线性声学系统，用于描述在密度为 $\\rho_{0}$、声速为 $c$ 的均匀、无粘性介质中的小振幅波，\n$$\np_{t}(x,t)+\\rho_{0}c^{2}u_{x}(x,t)=0,\\qquad u_{t}(x,t)+\\frac{1}{\\rho_{0}}p_{x}(x,t)=0,\n$$\n其中 $p(x,t)$ 是声压，$u(x,t)$ 是质点速度。在显式时域有限差分积分格式（如时域有限差分法，FDTD）中，空间导数（如 $p_{x}(x,t)$）在网格间距为 $h>0$ 的均匀网格 $x_{i}=x_{0}+ih$ 上进行近似。在固定的时间 $t$（为简化符号而省略），将网格点 $x_{i}$ 处 $p_{x}(x)$ 的四阶中心有限差分近似定义为\n$$\nD_{x}^{(4)}p_{i}:=\\frac{-p(x_{i}+2h)+8\\,p(x_{i}+h)-8\\,p(x_{i}-h)+p(x_{i}-2h)}{12\\,h}.\n$$\n假设 $p(x)$ 足够光滑（在 $x_{i}$ 的邻域内至少五次连续可微）。从泰勒定理和 $p(x)$ 的光滑性出发，推导离散导数 $D_{x}^{(4)}p_{i}$相对于精确导数 $p_{x}(x_{i})$ 的主截断误差项，并证明截断误差为 $\\mathcal{O}(h^{4})$，且乘以 $h^{4}$ 的常数前因子非零。将您的最终答案表示为截断误差 $\\tau_{i}:=D_{x}^{(4)}p_{i}-p_{x}(x_{i})$ 的主项的单个闭式解析表达式，用 $h$ 和在 $x_{i}$ 处求值的 $p$ 的相应导数表示。不需要进行数值取整。最终答案必须是无单位的单个解析表达式。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它包含一个数值分析中的标准推导，并应用于计算物理中的一个常见场景。\n\n目标是推导函数 $p(x)$ 在网格点 $x_i$ 处的一阶导数的四阶中心有限差分近似的主截断误差项 $\\tau_i$。截断误差定义为离散近似与精确连续导数之间的差：\n$$\n\\tau_{i} := D_{x}^{(4)}p_{i} - \\frac{dp}{dx}(x_{i})\n$$\n其中离散算子由下式给出：\n$$\nD_{x}^{(4)}p_{i} = \\frac{-p(x_{i}+2h)+8p(x_{i}+h)-8p(x_{i}-h)+p(x_{i}-2h)}{12h}\n$$\n问题指出 $p(x)$ 至少五次连续可微，这为在点 $x_i$ 周围使用泰勒级数展开提供了依据。我们展开算子分子中出现的项 $p(x_i \\pm h)$ 和 $p(x_i \\pm 2h)$。令 $p^{(k)}(x_i)$ 表示 $p(x)$ 关于 $x$ 的 $k$ 阶导数在 $x=x_i$ 处的值。\n\n$p(x_i + \\delta)$ 在 $x_i$ 点的泰勒级数展开为：\n$$\np(x_i + \\delta) = p(x_i) + \\delta p^{(1)}(x_i) + \\frac{\\delta^2}{2!} p^{(2)}(x_i) + \\frac{\\delta^3}{3!} p^{(3)}(x_i) + \\frac{\\delta^4}{4!} p^{(4)}(x_i) + \\frac{\\delta^5}{5!} p^{(5)}(x_i) + \\mathcal{O}(\\delta^6)\n$$\n我们将此展开应用于 $\\delta = h, -h, 2h, -2h$：\n对于 $\\delta = h$：\n$$\np(x_{i}+h) = p(x_i) + h p^{(1)}(x_i) + \\frac{h^2}{2} p^{(2)}(x_i) + \\frac{h^3}{6} p^{(3)}(x_i) + \\frac{h^4}{24} p^{(4)}(x_i) + \\frac{h^5}{120} p^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n对于 $\\delta = -h$：\n$$\np(x_{i}-h) = p(x_i) - h p^{(1)}(x_i) + \\frac{h^2}{2} p^{(2)}(x_i) - \\frac{h^3}{6} p^{(3)}(x_i) + \\frac{h^4}{24} p^{(4)}(x_i) - \\frac{h^5}{120} p^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n对于 $\\delta = 2h$：\n$$\np(x_{i}+2h) = p(x_i) + 2h p^{(1)}(x_i) + \\frac{(2h)^2}{2} p^{(2)}(x_i) + \\frac{(2h)^3}{6} p^{(3)}(x_i) + \\frac{(2h)^4}{24} p^{(4)}(x_i) + \\frac{(2h)^5}{120} p^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\np(x_{i}+2h) = p(x_i) + 2h p^{(1)}(x_i) + 2h^2 p^{(2)}(x_i) + \\frac{4h^3}{3} p^{(3)}(x_i) + \\frac{2h^4}{3} p^{(4)}(x_i) + \\frac{4h^5}{15} p^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n对于 $\\delta = -2h$：\n$$\np(x_{i}-2h) = p(x_i) - 2h p^{(1)}(x_i) + \\frac{(-2h)^2}{2} p^{(2)}(x_i) + \\frac{(-2h)^3}{6} p^{(3)}(x_i) + \\frac{(-2h)^4}{24} p^{(4)}(x_i) + \\frac{(-2h)^5}{120} p^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\np(x_{i}-2h) = p(x_i) - 2h p^{(1)}(x_i) + 2h^2 p^{(2)}(x_i) - \\frac{4h^3}{3} p^{(3)}(x_i) + \\frac{2h^4}{3} p^{(4)}(x_i) - \\frac{4h^5}{15} p^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n现在，我们将这些展开式代入 $D_{x}^{(4)}p_{i}$ 的分子中：\n$$\n\\text{分子} = -p(x_{i}+2h)+8p(x_{i}+h)-8p(x_{i}-h)+p(x_{i}-2h)\n$$\n我们收集 $p$ 在 $x_i$ 处各阶导数的系数：\n-   $p(x_i)$ 的系数：$-1 + 8 - 8 + 1 = 0$。\n-   $p^{(1)}(x_i)$ 的系数：$h(-2 + 8 \\cdot 1 - 8 \\cdot (-1) + 1 \\cdot (-2)) = h(-2 + 8 + 8 - 2) = 12h$。\n-   $p^{(2)}(x_i)$ 的系数：$h^2(-2 + 8 \\cdot \\frac{1}{2} - 8 \\cdot \\frac{1}{2} + 1 \\cdot 2) = h^2(-2 + 4 - 4 + 2) = 0$。\n-   $p^{(3)}(x_i)$ 的系数：$h^3(-\\frac{4}{3} + 8 \\cdot \\frac{1}{6} - 8 \\cdot (-\\frac{1}{6}) + 1 \\cdot (-\\frac{4}{3})) = h^3(-\\frac{4}{3} + \\frac{4}{3} + \\frac{4}{3} - \\frac{4}{3}) = 0$。\n-   $p^{(4)}(x_i)$ 的系数：$h^4(-\\frac{2}{3} + 8 \\cdot \\frac{1}{24} - 8 \\cdot \\frac{1}{24} + 1 \\cdot \\frac{2}{3}) = h^4(-\\frac{2}{3} + \\frac{1}{3} - \\frac{1}{3} + \\frac{2}{3}) = 0$。\n-   $p^{(5)}(x_i)$ 的系数：$h^5(-\\frac{4}{15} + 8 \\cdot \\frac{1}{120} - 8 \\cdot (-\\frac{1}{120}) + 1 \\cdot (-\\frac{4}{15})) = h^5(-\\frac{8}{15} + \\frac{16}{120}) = h^5(-\\frac{64}{120} + \\frac{16}{120}) = -\\frac{48}{120}h^5 = -\\frac{2}{5}h^5$。\n\n对于一阶导数的中心差分格式，奇数次幂的误差项（来自二阶、四阶导数）必须为零，这已得到证实。一阶导数之后的下一个非零误差项涉及 $p^{(3)}(x_i)$，但此四阶格式的特定权重被构造成也可以抵消此项。下一项，来自 $p^{(5)}(x_i)$ 的项，是主误差项。\n因此，分子可以表示为：\n$$\n\\text{分子} = 12h p^{(1)}(x_i) - \\frac{2}{5}h^5 p^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n由于对于此对称模板，六阶导数项的系数也相互抵消，因此 $\\mathcal{O}(h^7)$ 项来自 $p(x)$ 的七阶导数。\n\n现在我们可以写出完整离散算子的表达式：\n$$\nD_{x}^{(4)}p_{i} = \\frac{12h p^{(1)}(x_i) - \\frac{2}{5}h^5 p^{(5)}(x_i) + \\mathcal{O}(h^7)}{12h}\n$$\n$$\nD_{x}^{(4)}p_{i} = p^{(1)}(x_i) - \\frac{2}{5 \\cdot 12} h^4 p^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nD_{x}^{(4)}p_{i} = p^{(1)}(x_i) - \\frac{1}{30} h^4 p^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n截断误差 $\\tau_i$ 通过减去精确导数 $p^{(1)}(x_i)$（在问题的符号中为 $p_x(x_i)$）得到：\n$$\n\\tau_i = D_{x}^{(4)}p_{i} - p^{(1)}(x_i) = \\left( p^{(1)}(x_i) - \\frac{1}{30} h^4 p^{(5)}(x_i) + \\mathcal{O}(h^6) \\right) - p^{(1)}(x_i)\n$$\n$$\n\\tau_i = - \\frac{1}{30} h^4 p^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n这表明截断误差为 $h^4$ 阶，即 $\\tau_i = \\mathcal{O}(h^4)$，因为主误差项与 $h^4$ 成正比。对于任何五阶导数不为零的函数 $p(x)$，前因子 $-\\frac{1}{30}p^{(5)}(x_i)$ 非零，这证实了该论断。\n\n因此，截断误差的主项是展开式中的第一个非零项，即 $-\\frac{1}{30}h^4 p^{(5)}(x_i)$。",
            "answer": "$$\n\\boxed{-\\frac{h^{4}}{30} p^{(5)}(x_i)}\n$$"
        },
        {
            "introduction": "理论分析固然重要，但在计算科学中，我们必须验证计算机程序是否正确实现了数值格式并达到了预期的精度阶数。本练习介绍了一种强大且标准的代码验证技术——网格加密研究。通过比较不同分辨率网格上的数值解，我们可以从经验上测量出观察到的精度阶数，从而验证我们代码的正确性 。",
            "id": "4149943",
            "problem": "您的任务是设计一个数学上严谨的网格加密研究，以估计一个声学求解器的观测收敛阶。您将使用在以 $h$、$h/2$ 和 $h/4$ 为间距的逐次加密的空间网格上计算得到的三个解。您的目标是推导观测收敛阶的估计量和适用于底层声学可观测量的一致的 Richardson 外推公式，并在一个程序中实现这些公式来评估一组测试用例。\n\n本问题的基本依据是截断误差和收敛阶的定义。对于一个在间距为 $h$ 的网格上近似光滑声学可观测量（例如，声压样本或空间范数）的相容数值方法，其离散近似 $S_h$ 在 $h$ 足够小时满足以下渐近误差模型\n$$\nS_h = S + C h^p + \\mathcal{O}\\left(h^{p+1}\\right),\n$$\n其中 $S$ 是精确可观测量，$C$ 是一个与 $h$ 无关的常数，$p$ 是（未知的）收敛阶。网格加密研究的目的是仅使用 $S_h$、$S_{h/2}$ 和 $S_{h/4}$ 来估计 $p$ 并计算 $S$ 的外推近似值。\n\n设计要求：\n- 从上述渐近误差模型出发，使用在加密比 $r = 2$ 下的三个近似解 $S_h$、$S_{h/2}$ 和 $S_{h/4}$，推导一个用于估计观测阶 $p$ 的公式。\n- 使用两个最细网格的近似解和您估计的阶数 $p$，推导一个用于 $S$ 的 Richardson 外推公式。\n- 推导过程不得引用任何预先推导的“捷径”公式。您必须从误差模型出发，通过推理得出最终公式。\n\n实现要求：\n- 实现一个程序，该程序能构造与渐近模型一致的合成“声学求解器”输出。对于每个测试用例，将给定参数 $(S_\\star, p_{\\text{true}}, C, D, h)$，您必须通过以下方式定义合成近似解\n$$\nS_h = S_\\star + C h^{p_{\\text{true}}} + D h^{p_{\\text{true}} + 1}, \\quad\nS_{h/2} = S_\\star + C \\left(\\frac{h}{2}\\right)^{p_{\\text{true}}} + D \\left(\\frac{h}{2}\\right)^{p_{\\text{true}} + 1}, \\quad\nS_{h/4} = S_\\star + C \\left(\\frac{h}{4}\\right)^{p_{\\text{true}}} + D \\left(\\frac{h}{4}\\right)^{p_{\\text{true}} + 1}.\n$$\n这里 $S_\\star$ 代表一个精确的声学可观测量（无量纲），$p_{\\text{true}}$ 是合成模型的真实阶数，$C$ 是领头阶误差系数，$D$ 是代表高阶项污染的次领阶误差系数。\n- 根据这三个值，使用您推导的公式计算观测阶 $p_{\\text{obs}}$ 和外推解 $S_{\\text{ext}}$。使用最细的网格对 $(h/2,h/4)$ 进行外推，以减少高阶项污染。\n- 为了数值鲁棒性，在估计阶数时，在对数函数内部取绝对值，以避免 $C$ 的符号变化带来的问题；您仍须确保该比值为正且有限。\n\n测试套件：\n使用以下四个测试用例，每个用例由 $(S_\\star, p_{\\text{true}}, C, D, h)$ 定义。\n- 用例 1：$(0.75321, 2, 0.5, 0, 0.1)$\n- 用例 2：$(-0.132, 3, -0.3, 0, 0.12)$\n- 用例 3：$(2.5, 4, 1.0, 5.0, 0.08)$\n- 用例 4：$(0.0, 2, 1.0 \\times 10^{-4}, 0, 0.5)$\n\n程序输出规范：\n- 对于每个测试用例，输出两个浮点数：观测阶 $p_{\\text{obs}}$ 和外推解 $S_{\\text{ext}}$，两者均四舍五入到 $6$ 位小数。\n- 将所有四个测试用例的结果汇总到单行输出中，结果为逗号分隔的列表，用方括号括起来，顺序如下\n$$\n[p_{\\text{obs}}^{(1)}, S_{\\text{ext}}^{(1)}, p_{\\text{obs}}^{(2)}, S_{\\text{ext}}^{(2)}, p_{\\text{obs}}^{(3)}, S_{\\text{ext}}^{(3)}, p_{\\text{obs}}^{(4)}, S_{\\text{ext}}^{(4)}].\n$$\n由于所有量在构造上都是无量纲的，因此不需要物理单位。输出中不要包含任何额外文本。",
            "solution": "该问题要求基于网格加密研究中的三个数值解，推导观测收敛阶 $p_{\\text{obs}}$ 的估计量和相应的 Richardson 外推公式 $S_{\\text{ext}}$。之后，需要通过实现一个程序将这些公式应用于一组合成的测试用例。\n\n此分析的基础是，在特征间距为 $h$ 的网格上，精确值 $S$ 的数值近似解 $S_h$ 的渐近误差模型：\n$$\nS_h = S + C h^p + \\mathcal{O}\\left(h^{p+1}\\right)\n$$\n这里，$p$ 是数值方法的形式收敛阶，$C$ 是领头阶误差系数，假定在 $h$ 足够小时为常数。\n\n我们得到了在加密比恒为 $r=2$ 的逐次加密网格上计算出的三个解 $S_h$、$S_{h/2}$ 和 $S_{h/4}$。为简化推导，我们将这些解表示为 $S_1 = S_h$、$S_2 = S_{h/2}$ 和 $S_3 = S_{h/4}$。通过截断渐近误差模型并忽略高阶项 $\\mathcal{O}(h^{p+1})$，我们得到一个近似方程组。这种截断在 $h \\to 0$ 的渐近极限下是有效的。\n\n$$\nS_1 \\approx S + C h^p \\\\\nS_2 \\approx S + C \\left(\\frac{h}{2}\\right)^p = S + C \\frac{h^p}{2^p} \\\\\nS_3 \\approx S + C \\left(\\frac{h}{4}\\right)^p = S + C \\frac{h^p}{4^p}\n$$\n\n**观测收敛阶 ($p_{\\text{obs}}$) 的推导**\n\n我们的第一个目标是使用现有的三个解来估计收敛阶 $p$。策略是从方程组中消去未知量 $S$ 和 $C$。我们可以通过考虑连续近似解之间的差值来消去 $S$：\n\n$$\nS_1 - S_2 \\approx \\left(S + C h^p\\right) - \\left(S + C \\frac{h^p}{2^p}\\right) = C h^p \\left(1 - \\frac{1}{2^p}\\right)\n$$\n\n$$\nS_2 - S_3 \\approx \\left(S + C \\frac{h^p}{2^p}\\right) - \\left(S + C \\frac{h^p}{4^p}\\right) = C \\frac{h^p}{2^p} \\left(1 - \\frac{1}{2^p}\\right)\n$$\n\n现在，我们可以通过计算这两个差值的比率来消去 $C h^p \\left(1 - \\frac{1}{2^p}\\right)$ 项。只要分母不为零，这样做就是允许的，而对于一个误差不会过早消失的收敛解来说，这通常是成立的。\n\n$$\n\\frac{S_1 - S_2}{S_2 - S_3} \\approx \\frac{C h^p \\left(1 - \\frac{1}{2^p}\\right)}{C \\frac{h^p}{2^p} \\left(1 - \\frac{1}{2^p}\\right)} = 2^p\n$$\n这个关系为求解 $p$ 提供了一个直接的方法。通过对两边取自然对数，我们可以分离出 $p$：\n\n$$\n\\ln\\left(\\frac{S_1 - S_2}{S_2 - S_3}\\right) \\approx \\ln(2^p) = p \\ln(2)\n$$\n\n求解 $p$ 可得到观测收敛阶的估计量，我们将其表示为 $p_{\\text{obs}}$：\n\n$$\np_{\\text{obs}} = \\frac{\\ln\\left(\\frac{S_h - S_{h/2}}{S_{h/2} - S_{h/4}}\\right)}{\\ln(2)}\n$$\n\n正如问题中所规定的，为了保证数值鲁棒性，特别是在处理可能包含浮点噪声或非单调收敛行为的真实求解器输出时，谨慎的做法是在应用对数函数前对该比率取绝对值。\n\n$$\np_{\\text{obs}} = \\frac{\\ln\\left(\\left| \\frac{S_h - S_{h/2}}{S_{h/2} - S_{h/4}} \\right|\\right)}{\\ln(2)}\n$$\n\n**Richardson 外推公式 ($S_{\\text{ext}}$) 的推导**\n\n我们的第二个目标是使用已有的近似解来推导精确解 $S$ 的一个更准确的估计。这个过程被称为 Richardson 外推法。问题指定使用两个最细网格的解 $S_2 = S_{h/2}$ 和 $S_3 = S_{h/4}$，以及我们估计的收敛阶 $p_{\\text{obs}}$。\n\n我们回到这两个解的截断误差方程，现在使用 $p_{\\text{obs}}$作为 $p$ 的估计值：\n\n$$\nS_2 \\approx S + C \\left(\\frac{h}{2}\\right)^{p_{\\text{obs}}} \\\\\nS_3 \\approx S + C \\left(\\frac{h}{4}\\right)^{p_{\\text{obs}}} = S + C \\frac{(h/2)^{p_{\\text{obs}}}}{2^{p_{\\text{obs}}}}\n$$\n\n这是一个关于两个未知数 $S$ 和误差项 $E_2 = C (h/2)^{p_{\\text{obs}}}$ 的二元线性方程组。我们的目标是求解 $S$。让我们重写这个系统：\n\n$$\nS_2 \\approx S + E_2 \\\\\nS_3 \\approx S + \\frac{E_2}{2^{p_{\\text{obs}}}}\n$$\n\n从第一个方程，我们可以将误差项 $E_2$ 表示为 $E_2 \\approx S_2 - S$。将其代入第二个方程可得：\n\n$$\nS_3 \\approx S + \\frac{S_2 - S}{2^{p_{\\text{obs}}}}\n$$\n\n我们现在求解这个关于 $S$ 的方程。将两边同乘以 $2^{p_{\\text{obs}}}$ 以消去分母：\n\n$$\nS_3 \\cdot 2^{p_{\\text{obs}}} \\approx S \\cdot 2^{p_{\\text{obs}}} + S_2 - S\n$$\n\n将包含 $S$ 的项组合在一起：\n\n$$\nS_3 \\cdot 2^{p_{\\text{obs}}} - S_2 \\approx S \\left(2^{p_{\\text{obs}}} - 1\\right)\n$$\n\n最后，除以 $(2^{p_{\\text{obs}}} - 1)$ 就得到了 Richardson 外推解 $S_{\\text{ext}}$ 的公式。该公式在 $p_{\\text{obs}} \\neq 0$ 的条件下有效。\n\n$$\nS_{\\text{ext}} = \\frac{S_3 \\cdot 2^{p_{\\text{obs}}} - S_2}{2^{p_{\\text{obs}}} - 1} = \\frac{S_{h/4} \\cdot 2^{p_{\\text{obs}}} - S_{h/2}}{2^{p_{\\text{obs}}} - 1}\n$$\n\n假设渐近误差模型能准确描述求解器在所用网格上的行为，这个外推值 $S_{\\text{ext}}$ 的误差阶比原始近似解的更高，通常为 $\\mathcal{O}(h^{p+1})$。\n\n实现将首先为每个测试用例生成合成数据点 $S_h$、$S_{h/2}$ 和 $S_{h/4}$。然后，它将应用推导出的 $p_{\\text{obs}}$ 公式，接着应用 $S_{\\text{ext}}$ 的公式，并按规定格式化结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the grid refinement study problem by deriving estimators for the\n    order of accuracy and performing Richardson extrapolation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (S_star, p_true, C, D, h)\n    test_cases = [\n        (0.75321, 2, 0.5, 0, 0.1),\n        (-0.132, 3, -0.3, 0, 0.12),\n        (2.5, 4, 1.0, 5.0, 0.08),\n        (0.0, 2, 1.0e-4, 0, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        S_star, p_true, C, D, h = case\n\n        # 1. Generate synthetic \"acoustic solver\" outputs\n        # S_h = S_star + C*h^p + D*h^(p+1)\n        s_h = S_star + C * h**p_true + D * h**(p_true + 1)\n        # S_h/2\n        s_h_2 = S_star + C * (h / 2)**p_true + D * (h / 2)**(p_true + 1)\n        # S_h/4\n        s_h_4 = S_star + C * (h / 4)**p_true + D * (h / 4)**(p_true + 1)\n\n        # 2. Compute the observed order of accuracy (p_obs)\n        # p_obs = ln(|(S_h - S_h/2) / (S_h/2 - S_h/4)|) / ln(2)\n        numerator = s_h - s_h_2\n        denominator = s_h_2 - s_h_4\n\n        # The problem cases are well-behaved, so denominator won't be zero.\n        ratio = numerator / denominator\n        \n        # Taking the absolute value as per the problem's robustness requirement.\n        p_obs = np.log(np.abs(ratio)) / np.log(2)\n\n        # 3. Compute the extrapolated solution (S_ext)\n        # S_ext = (S_h/4 * 2^p_obs - S_h/2) / (2^p_obs - 1)\n        # This formula is valid for p_obs != 0.\n        power_of_2 = 2**p_obs\n        S_ext = (s_h_4 * power_of_2 - s_h_2) / (power_of_2 - 1)\n\n        # 4. Round results to 6 decimal places and append to the list\n        results.append(round(p_obs, 6))\n        results.append(round(S_ext, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "数值分析中存在一个至关重要的细节：我们从泰勒级数推导出的形式精度阶数，其前提是解足够光滑。本练习通过一个特殊函数揭示了当此前提不满足时会发生什么，该函数缺乏标准分析所需的光滑性。这个案例  精彩地说明了为何有效精度阶数可能低于形式阶数，并强调了理解理论工具背后假设的重要性。",
            "id": "2421857",
            "problem": "设函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 定义为 $f(x)=|x|^{3}$。考虑一个间距为 $h0$ 的均匀网格，以及函数 $f$ 在 $x=0$ 处的二阶导数的三点中心有限差分近似，其表达式为\n$$\nD_{h}^{(2)}f(0)=\\frac{f(h)-2f(0)+f(-h)}{h^{2}}.\n$$\n将此近似在 $x=0$ 处的有效精度阶数 $p$ 定义为满足点态误差 $E(h)=\\left|D_{h}^{(2)}f(0)-f''(0)\\right|$ 在 $h\\to 0^{+}$ 时有 $E(h)=\\mathcal{O}(h^{p})$ 的最大实数 $p$。已知 $f''(0)$ 存在但 $f'''(0)$ 未定义。\n\n确定 $p$ 的精确值。请以一个不带单位的数字作答。无需四舍五入。",
            "solution": "首先对用于分析的问题陈述进行严格的验证。\n\n已知条件如下：\n- 函数为 $f(x) = |x|^3$，$x \\in \\mathbb{R}$。\n- 对于网格间距 $h>0$，在 $x=0$ 处的二阶导数有限差分近似为 $D_{h}^{(2)}f(0) = \\frac{f(h) - 2f(0) + f(-h)}{h^2}$。\n- 点态误差为 $E(h) = |D_{h}^{(2)}f(0) - f''(0)|$。\n- 有效精度阶数 $p$ 定义为满足在 $h \\to 0^+$ 时 $E(h) = \\mathcal{O}(h^p)$ 的最大实数。\n- 已知 $f''(0)$ 存在且 $f'''(0)$ 未定义。\n\n需要对函数 $f(x)=|x|^3$ 的所述性质进行初步验证。\n对于 $x \\neq 0$，导数是直接的。对于 $x>0$，$f(x)=x^3$，得到 $f'(x)=3x^2$ 和 $f''(x)=6x$。对于 $x0$，$f(x)=-x^3$，得到 $f'(x)=-3x^2$ 和 $f''(x)=-6x$。对于 $x \\neq 0$，紧凑形式为 $f'(x)=3x|x|$ 和 $f''(x)=6|x|$。\n\n我们必须根据极限定义来检查在 $x=0$ 处的导数。\n一阶导数为：\n$$\nf'(0) = \\lim_{\\Delta x \\to 0} \\frac{f(0+\\Delta x) - f(0)}{\\Delta x} = \\lim_{\\Delta x \\to 0} \\frac{|\\Delta x|^3 - 0}{\\Delta x} = \\lim_{\\Delta x \\to 0} (\\Delta x)^2 \\frac{|\\Delta x|}{\\Delta x} = 0\n$$\n二阶导数为：\n$$\nf''(0) = \\lim_{\\Delta x \\to 0} \\frac{f'(\\Delta x) - f'(0)}{\\Delta x} = \\lim_{\\Delta x \\to 0} \\frac{3(\\Delta x)|\\Delta x| - 0}{\\Delta x} = \\lim_{\\Delta x \\to 0} 3|\\Delta x| = 0\n$$\n因此，$f''(0)$ 存在且等于 $0$。\n三阶导数为：\n$$\nf'''(0) = \\lim_{\\Delta x \\to 0} \\frac{f''(\\Delta x) - f''(0)}{\\Delta x} = \\lim_{\\Delta x \\to 0} \\frac{6|\\Delta x| - 0}{\\Delta x} = 6 \\lim_{\\Delta x \\to 0} \\frac{|\\Delta x|}{\\Delta x}\n$$\n当 $\\Delta x \\to 0^+$ 时的右极限是 $6$，而当 $\\Delta x \\to 0^-$ 时的左极限是 $-6$。由于极限不相等，$f'''(0)$ 未定义。\n因此，问题的各项前提被验证为正确且自洽的。该问题在数值分析领域是适定的并且有科学依据的。我们可以继续进行求解。\n\n任务是确定有效精度阶数 $p$。我们首先直接计算有限差分近似 $D_{h}^{(2)}f(0)$。\n公式为：\n$$\nD_{h}^{(2)}f(0) = \\frac{f(h) - 2f(0) + f(-h)}{h^2}\n$$\n我们在所需点上计算函数 $f(x) = |x|^3$ 的值。由于 $h>0$：\n- $f(h) = |h|^3 = h^3$\n- $f(0) = |0|^3 = 0$\n- $f(-h) = |-h|^3 = h^3$\n\n将这些值代入公式：\n$$\nD_{h}^{(2)}f(0) = \\frac{h^3 - 2(0) + h^3}{h^2} = \\frac{2h^3}{h^2} = 2h\n$$\n接下来，我们计算点态误差 $E(h) = |D_{h}^{(2)}f(0) - f''(0)|$。我们已经确定 $f''(0)=0$。\n因此，误差为：\n$$\nE(h) = |2h - 0| = 2h\n$$\n这里我们用到了 $h>0$ 的事实。\n\n对于一个足够光滑的函数 $g \\in C^4(\\mathbb{R})$，标准的泰勒级数分析会预测该中心差分格式的截断误差为 $\\mathcal{O}(h^2)$ 阶，因为\n$$\n\\frac{g(x+h) - 2g(x) + g(x-h)}{h^2} - g''(x) = \\frac{g^{(4)}(\\xi)}{12}h^2\n$$\n这个结果取决于三阶导数项的抵消，这要求 $g'''(x)$ 存在且连续。在本问题中，$f'''(0)$ 不存在。这种光滑性的缺失使得标准分析无效，并导致精度阶数的降低。我们的直接计算证实了这一点。\n\n我们必须找到最大的实数 $p$，使得当 $h \\to 0^+$ 时 $E(h) = \\mathcal{O}(h^p)$。这等价于找到使以下极限有界的最大 $p$：\n$$\n\\limsup_{h \\to 0^+} \\frac{E(h)}{h^p}  \\infty\n$$\n代入我们对 $E(h)$ 的表达式：\n$$\n\\limsup_{h \\to 0^+} \\frac{2h}{h^p} = \\limsup_{h \\to 0^+} 2h^{1-p}\n$$\n为了使这个极限为有限值，$h$ 的指数必须为非负。即，$1-p \\ge 0$，这意味着 $p \\le 1$。\n满足此条件的最大实数是 $p=1$。\n对于 $p=1$，极限为 $\\lim_{h \\to 0^+} 2h^{1-1} = \\lim_{h \\to 0^+} 2 = 2$。这是一个有限的非零常数，证实了 $E(h)$ 确实是 $\\mathcal{O}(h^1)$。\n对于任何 $p > 1$，例如 $p = 1 + \\epsilon$ 且 $\\epsilon > 0$，极限变为 $\\lim_{h \\to 0^+} 2h^{-\\epsilon} = \\infty$。这表明对于任何 $p>1$，$E(h)$ 都不是 $\\mathcal{O}(h^p)$。\n\n因此，使得 $E(h) = \\mathcal{O}(h^p)$ 的最大实数 $p$ 精确地为 $1$。\n有效精度阶数为 $p=1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}