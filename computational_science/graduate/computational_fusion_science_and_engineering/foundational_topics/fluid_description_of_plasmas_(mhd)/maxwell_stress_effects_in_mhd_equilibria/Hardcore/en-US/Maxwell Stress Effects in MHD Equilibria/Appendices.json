{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a foundational understanding of magnetohydrodynamic (MHD) equilibrium in its simplest form. We will explore how a spatially varying magnetic field creates a \"magnetic pressure\" that can confine a plasma, a core principle in devices like the theta-pinch. By deriving the required plasma pressure gradient to balance the magnetic forces, you will gain direct insight into the fundamental force balance equation $\\nabla p = \\mathbf{J} \\times \\mathbf{B}$ and the concept of beta, the ratio of plasma pressure to magnetic pressure.",
            "id": "4009453",
            "problem": "Consider an ideal, fully ionized plasma column in a cylindrical geometry undergoing a quasi-static compression in a theta-pinch configuration. Assume axisymmetry and no flows so that the plasma is in steady equilibrium. The magnetic field is purely axial and depends on radius, $B_{z}(r)$, with no $z$-dependence and no azimuthal component. The plasma occupies $0 \\leq r \\leq a$.\n\nStarting from the magnetohydrodynamic (MHD) momentum equation in equilibrium and invoking the Maxwell stress formulation of electromagnetic forces, derive the expression for the required radial pressure gradient $dp/dr$ that balances the radial magnetic force associated with the spatially varying axial field $B_{z}(r)$ during compression.\n\nThen, for the specific axial field profile\n$$\nB_{z}(r) = B_{0}\\left(1 - \\frac{r^{2}}{a^{2}}\\right)^{\\alpha}, \\quad 0 \\leq r \\leq a,\n$$\nwith $B_{0} > 0$, $a > 0$, and $\\alpha > 0$, compute the analytic expression for the radial pressure gradient $dp/dr$ as a function of $r$, $B_{0}$, $a$, and $\\alpha$.\n\nExpress your final answer in the International System of Units (SI) as Pascals per meter. No numerical evaluation or rounding is required; provide a closed-form expression.",
            "solution": "The physical setting is a theta-pinch compression in which the magnetic field is axial and varies with radius, $B_{z}(r)$. We consider a steady, axisymmetric state without flow. The appropriate fundamental laws for this derivation are the magnetohydrodynamic (MHD) momentum equation for equilibrium and the Maxwell stress tensor representation of magnetic forces.\n\nThe MHD momentum equation in equilibrium (no flow, no time dependence) is\n$$\n\\boldsymbol{0} = -\\nabla p + \\boldsymbol{J} \\times \\boldsymbol{B},\n$$\nwhere $p$ is the scalar plasma pressure, $\\boldsymbol{J}$ is the current density, and $\\boldsymbol{B}$ is the magnetic field. This can also be expressed using the Maxwell stress tensor $\\boldsymbol{T}$ via\n$$\n\\nabla \\cdot \\boldsymbol{T} = \\frac{1}{\\mu_{0}} (\\nabla \\times \\boldsymbol{B}) \\times \\boldsymbol{B},\n$$\nwith the Maxwell stress tensor defined as\n$$\n\\boldsymbol{T} = \\frac{1}{\\mu_{0}} \\left( \\boldsymbol{B}\\boldsymbol{B} - \\frac{1}{2} B^{2} \\boldsymbol{I} \\right),\n$$\nwhere $\\mu_{0}$ is the vacuum permeability, $B^{2} = \\boldsymbol{B} \\cdot \\boldsymbol{B}$, and $\\boldsymbol{I}$ is the identity tensor. In equilibrium, the total stress (fluid plus electromagnetic) must be divergence-free:\n$$\n\\nabla \\cdot (p \\boldsymbol{I} + \\boldsymbol{T}) = \\boldsymbol{0}.\n$$\n\nWe derive the radial pressure gradient by considering the radial component of the MHD force balance. For the given geometry, the magnetic field is $\\boldsymbol{B} = B_{z}(r) \\,\\hat{\\boldsymbol{z}}$, with no $z$-dependence and no azimuthal or radial components. The current density follows from Ampère's law (in magnetostatics),\n$$\n\\nabla \\times \\boldsymbol{B} = \\mu_{0} \\boldsymbol{J}.\n$$\nIn cylindrical coordinates $(r,\\theta,z)$, with $\\boldsymbol{B} = B_{z}(r)\\,\\hat{\\boldsymbol{z}}$, the only nonzero component of $\\nabla \\times \\boldsymbol{B}$ is the azimuthal component,\n$$\n(\\nabla \\times \\boldsymbol{B})_{\\theta} = -\\frac{d B_{z}(r)}{d r}.\n$$\nThus,\n$$\nJ_{\\theta}(r) = -\\frac{1}{\\mu_{0}} \\frac{d B_{z}}{d r}.\n$$\nThe Lorentz force density is $\\boldsymbol{f} = \\boldsymbol{J} \\times \\boldsymbol{B}$. The radial component is\n$$\nf_{r} = J_{\\theta} B_{z} = -\\frac{1}{\\mu_{0}} B_{z} \\frac{d B_{z}}{d r}.\n$$\nIn equilibrium, the radial component of $-\\nabla p + \\boldsymbol{J} \\times \\boldsymbol{B} = \\boldsymbol{0}$ gives\n$$\n-\\frac{d p}{d r} + f_{r} = 0 \\quad \\Rightarrow \\quad \\frac{d p}{d r} = f_{r} = -\\frac{1}{\\mu_{0}} B_{z} \\frac{d B_{z}}{d r}.\n$$\nRecognizing that\n$$\n\\frac{d}{d r} \\left( \\frac{B_{z}^{2}}{2 \\mu_{0}} \\right) = \\frac{1}{\\mu_{0}} B_{z} \\frac{d B_{z}}{d r},\n$$\nwe can also write\n$$\n\\frac{d p}{d r} = -\\frac{d}{d r} \\left( \\frac{B_{z}^{2}}{2 \\mu_{0}} \\right).\n$$\nThis is consistent with the Maxwell stress description where the radial magnetic force density is the negative gradient of the magnetic pressure, and for a purely axial field with no curvature change along the field direction, the magnetic tension does not contribute to the radial component.\n\nWe now evaluate the radial pressure gradient for the given profile,\n$$\nB_{z}(r) = B_{0} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{\\alpha}, \\quad 0 \\leq r \\leq a,\n$$\nwith $B_{0} > 0$, $a > 0$, and $\\alpha > 0$. First compute $B_{z}^{2}(r)$:\n$$\nB_{z}^{2}(r) = B_{0}^{2} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha}.\n$$\nThen the magnetic pressure is\n$$\np_{m}(r) = \\frac{B_{z}^{2}(r)}{2 \\mu_{0}} = \\frac{B_{0}^{2}}{2 \\mu_{0}} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha}.\n$$\nDifferentiate with respect to $r$:\n$$\n\\frac{d p_{m}}{d r} = \\frac{B_{0}^{2}}{2 \\mu_{0}} \\cdot 2\\alpha \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha - 1} \\cdot \\frac{d}{d r} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right).\n$$\nSince\n$$\n\\frac{d}{d r} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right) = -\\frac{2 r}{a^{2}},\n$$\nwe have\n$$\n\\frac{d p_{m}}{d r} = \\frac{B_{0}^{2}}{2 \\mu_{0}} \\cdot 2\\alpha \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha - 1} \\cdot \\left( -\\frac{2 r}{a^{2}} \\right) = -\\frac{2 \\alpha B_{0}^{2}}{\\mu_{0}} \\frac{r}{a^{2}} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha - 1}.\n$$\nTherefore, the equilibrium condition\n$$\n\\frac{d p}{d r} = -\\frac{d p_{m}}{d r}\n$$\ngives\n$$\n\\frac{d p}{d r} = \\frac{2 \\alpha B_{0}^{2}}{\\mu_{0}} \\frac{r}{a^{2}} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha - 1}.\n$$\n\nThis expression is the required radial pressure gradient that balances the magnetic pressure gradient of the axial field during compression. It is positive for $0 < r < a$ when $\\alpha > 0$, meaning the plasma pressure must increase outward to compensate for the decreasing magnetic pressure in this particular profile. The expression is in SI units, with $\\mu_{0}$ in $\\mathrm{N/A^{2}}$, $B_{0}$ in $\\mathrm{T}$, $r$ and $a$ in $\\mathrm{m}$, yielding $dp/dr$ in Pascals per meter as required.",
            "answer": "$$\\boxed{\\frac{2 \\alpha B_{0}^{2}}{\\mu_{0}} \\frac{r}{a^{2}} \\left( 1 - \\frac{r^{2}}{a^{2}} \\right)^{2\\alpha - 1}}$$"
        },
        {
            "introduction": "Building on the concept of magnetic pressure, this practice applies the Maxwell stress tensor to a more realistic fusion configuration: the tokamak. You will calculate the distribution of normal forces, or \"traction,\" on the plasma's edge, accounting for the device's toroidal geometry and the helical nature of the magnetic field. This exercise is crucial for understanding how magnetic fields shape and hold a high-temperature plasma away from the vessel walls, and how these forces vary poloidally due to toroidal effects.",
            "id": "4009480",
            "problem": "Consider an axisymmetric, large-aspect-ratio tokamak equilibrium with circular cross-section minor radius $a$ and major radius $R_{0}$. Let the poloidal angle be $\\theta$, measured from the outboard midplane, so that the geometric major radius at the plasma boundary is $R(\\theta)=R_{0}+a\\cos\\theta$. The toroidal magnetic field is generated by external coils and obeys toroidal flux conservation such that the toroidal field at the boundary is $B_{\\phi}(\\theta)$ with $B_{\\phi}(\\theta)\\propto 1/R(\\theta)$. The edge safety factor $q_{a}$ is assumed constant along the boundary, and is defined by the standard relation $q = r B_{\\phi}/(R B_{\\theta})$ in a circular, axisymmetric equilibrium, where $B_{\\theta}$ is the poloidal magnetic field and $r$ is the minor radius. Assume ideal Magnetohydrodynamics (MHD), so that the magnetic field is tangent to the equilibrium boundary and has no normal component at $r=a$.\n\nYou will analyze the Maxwell stress effects on the equilibrium boundary. Begin from the magnetostatic form of the Maxwell stress concept and the definition of the traction vector on a surface. Using only fundamental principles and the given geometric and equilibrium assumptions, derive the nondimensional normal traction distribution on the plasma boundary produced by the magnetic field. Normalize the Maxwell stress tensor by $B_{0}^{2}/\\mu_{0}$, where $B_{0}$ is the toroidal magnetic field at $R_{0}$, so that your final expression is dimensionless. Express your final answer as a single closed-form analytic expression $\\tau_{n}(\\theta)$ in terms of $R_{0}$, $a$, $q_{a}$, and $\\theta$. Do not introduce any additional parameters beyond those specified. The final answer must be a single symbolic expression; no numerical evaluation is required, and no units should be included in the final answer.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   System: Axisymmetric, large-aspect-ratio tokamak equilibrium.\n-   Geometry: Circular cross-section with minor radius $a$ and major radius $R_{0}$.\n-   Coordinates: Poloidal angle $\\theta$ is measured from the outboard midplane.\n-   Boundary Major Radius: The major radius at the plasma boundary is $R(\\theta) = R_{0} + a\\cos\\theta$.\n-   Toroidal Field: $B_{\\phi}$ is generated by external coils and follows $B_{\\phi}(\\theta) \\propto 1/R(\\theta)$. The field at the major radius $R_0$ is $B_0$.\n-   Edge Safety Factor: $q_{a}$ is constant on the boundary $r=a$.\n-   Safety Factor Definition: $q = r B_{\\phi}/(R B_{\\theta})$, where $B_{\\theta}$ is the poloidal magnetic field.\n-   MHD Model: Ideal Magnetohydrodynamics (MHD).\n-   Boundary Condition: The magnetic field $\\mathbf{B}$ is tangent to the equilibrium boundary, meaning it has no normal component at $r=a$.\n-   Task: Derive the nondimensional normal traction distribution, $\\tau_{n}(\\theta)$, on the plasma boundary.\n-   Normalization: The Maxwell stress tensor is to be normalized by $B_{0}^{2}/\\mu_{0}$.\n-   Output: A single closed-form analytic expression for $\\tau_{n}(\\theta)$ in terms of $R_{0}$, $a$, $q_{a}$, and $\\theta$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded. It uses a standard, albeit simplified, model of a tokamak equilibrium common in fusion plasma physics. All concepts, such as the Maxwell stress tensor, ideal MHD, safety factor $q$, and magnetic field topology ($1/R$ scaling of $B_{\\phi}$), are fundamental principles in this field. The problem is well-posed, providing sufficient information and clear definitions to derive a unique solution. The language is objective and technical. There are no contradictions, missing pieces of crucial information, or scientifically implausible assumptions. The problem is therefore deemed valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe force per unit area, or traction vector $\\mathbf{t}$, exerted by the electromagnetic field on a surface with an outward-pointing unit normal vector $\\mathbf{\\hat{n}}$ is given by the contraction of the Maxwell stress tensor $\\mathbf{T}$ with $\\mathbf{\\hat{n}}$. The magnetostatic Maxwell stress tensor is:\n$$\n\\mathbf{T} = \\frac{1}{\\mu_0} \\left( \\mathbf{B} \\mathbf{B} - \\frac{1}{2} \\mathbf{I} B^2 \\right)\n$$\nwhere $\\mathbf{B}$ is the magnetic field vector, $B^2 = \\mathbf{B} \\cdot \\mathbf{B}$ is the squared magnitude of the magnetic field, and $\\mathbf{I}$ is the identity tensor. In index notation, this is $T_{ij} = \\frac{1}{\\mu_0} \\left( B_i B_j - \\frac{1}{2} \\delta_{ij} B^2 \\right)$.\n\nThe traction vector $\\mathbf{t}$ on the surface is then:\n$$\n\\mathbf{t} = \\mathbf{T} \\cdot \\mathbf{\\hat{n}} = \\frac{1}{\\mu_0} \\left[ (\\mathbf{B} \\cdot \\mathbf{\\hat{n}})\\mathbf{B} - \\frac{1}{2} B^2 \\mathbf{\\hat{n}} \\right]\n$$\nThe problem states that the magnetic field is tangent to the equilibrium boundary. This implies that the component of the magnetic field normal to the surface is zero, i.e., $\\mathbf{B} \\cdot \\mathbf{\\hat{n}} = 0$. With this condition, the traction vector simplifies to:\n$$\n\\mathbf{t} = - \\frac{B^2}{2\\mu_0} \\mathbf{\\hat{n}}\n$$\nThis expression represents a pressure, known as the magnetic pressure, acting perpendicularly inward on the surface. The normal traction, $\\tau_{n,\\text{dim}}$, is the scalar component of the traction vector in the direction of the normal vector $\\mathbf{\\hat{n}}$:\n$$\n\\tau_{n,\\text{dim}} = \\mathbf{t} \\cdot \\mathbf{\\hat{n}} = \\left( - \\frac{B^2}{2\\mu_0} \\mathbf{\\hat{n}} \\right) \\cdot \\mathbf{\\hat{n}} = - \\frac{B^2}{2\\mu_0}\n$$\nThe problem requires a nondimensional result. Following the prompt to normalize the stress by $B_0^2/\\mu_0$, we can define a nondimensional normal traction $\\tau_n(\\theta)$ as:\n$$\n\\tau_n(\\theta) = \\frac{\\tau_{n,\\text{dim}}}{B_0^2/\\mu_0} = -\\frac{B^2(\\theta)}{2 B_0^2}\n$$\nTo find $\\tau_n(\\theta)$, we must determine the magnetic field strength $B^2(\\theta)$ at the boundary. The magnetic field has toroidal ($\\phi$) and poloidal ($\\theta$) components, so $\\mathbf{B} = B_{\\phi}\\mathbf{\\hat{e}}_{\\phi} + B_{\\theta}\\mathbf{\\hat{e}}_{\\theta}$. The squared magnitude is $B^2 = B_{\\phi}^2 + B_{\\theta}^2$.\n\nFirst, we find the toroidal field $B_{\\phi}(\\theta)$. We are given that $B_{\\phi} \\propto 1/R$ and that the field is $B_0$ at the major radius $R_0$. This implies $B_{\\phi}(R) R = B_0 R_0$. At the plasma boundary, the major radius is $R(\\theta) = R_0 + a\\cos\\theta$. Thus, the toroidal field at the boundary is:\n$$\nB_{\\phi}(\\theta) = \\frac{B_0 R_0}{R(\\theta)} = \\frac{B_0 R_0}{R_0 + a\\cos\\theta}\n$$\nNext, we find the poloidal field $B_{\\theta}(\\theta)$ using the definition of the edge safety factor, $q_a$. At the boundary $r=a$:\n$$\nq_a = \\frac{a B_{\\phi}(\\theta)}{R(\\theta) B_{\\theta}(\\theta)}\n$$\nSolving for $B_{\\theta}(\\theta)$:\n$$\nB_{\\theta}(\\theta) = \\frac{a B_{\\phi}(\\theta)}{q_a R(\\theta)}\n$$\nSubstituting the expression for $B_{\\phi}(\\theta)$:\n$$\nB_{\\theta}(\\theta) = \\frac{a}{q_a R(\\theta)} \\left( \\frac{B_0 R_0}{R(\\theta)} \\right) = \\frac{a B_0 R_0}{q_a R(\\theta)^2} = \\frac{a B_0 R_0}{q_a (R_0 + a\\cos\\theta)^2}\n$$\nNow we can compute the total magnetic field strength squared, $B^2(\\theta)$:\n$$\nB^2(\\theta) = B_{\\phi}(\\theta)^2 + B_{\\theta}(\\theta)^2 = \\left( \\frac{B_0 R_0}{R_0 + a\\cos\\theta} \\right)^2 + \\left( \\frac{a B_0 R_0}{q_a (R_0 + a\\cos\\theta)^2} \\right)^2\n$$\n$$\nB^2(\\theta) = \\frac{B_0^2 R_0^2}{(R_0 + a\\cos\\theta)^2} + \\frac{a^2 B_0^2 R_0^2}{q_a^2 (R_0 + a\\cos\\theta)^4}\n$$\nWe can factor out the common term:\n$$\nB^2(\\theta) = \\frac{B_0^2 R_0^2}{(R_0 + a\\cos\\theta)^2} \\left[ 1 + \\frac{a^2}{q_a^2 (R_0 + a\\cos\\theta)^2} \\right]\n$$\nFinally, we substitute this expression for $B^2(\\theta)$ into our formula for the nondimensional normal traction $\\tau_n(\\theta)$:\n$$\n\\tau_n(\\theta) = -\\frac{B^2(\\theta)}{2B_0^2} = -\\frac{1}{2B_0^2} \\left( \\frac{B_0^2 R_0^2}{(R_0 + a\\cos\\theta)^2} \\left[ 1 + \\frac{a^2}{q_a^2 (R_0 + a\\cos\\theta)^2} \\right] \\right)\n$$\nSimplifying by canceling the $B_0^2$ terms, we arrive at the final expression for the nondimensional normal traction distribution:\n$$\n\\tau_n(\\theta) = -\\frac{R_0^2}{2(R_0 + a\\cos\\theta)^2} \\left( 1 + \\frac{a^2}{q_a^2 (R_0 + a\\cos\\theta)^2} \\right)\n$$\nThis is the single closed-form analytic expression for $\\tau_n(\\theta)$ in terms of the specified parameters $R_0$, $a$, $q_a$, and $\\theta$. The negative sign confirms that the traction is a pressure directed inward into the plasma volume.",
            "answer": "$$\n\\boxed{-\\frac{R_0^2}{2(R_0 + a\\cos\\theta)^2} \\left(1 + \\frac{a^2}{q_a^2 (R_0 + a\\cos\\theta)^2}\\right)}\n$$"
        },
        {
            "introduction": "This final practice transitions from analytical derivation to computational verification, a vital skill in modern fusion science. You will implement the Maxwell stress tensor for a specific three-dimensional magnetic field—a Beltrami field—and numerically confirm a key consequence of the divergence theorem in a periodic system. This exercise reinforces the theoretical link between the divergence of the stress tensor and the net force on a volume, building confidence in the computational tools used to model complex MHD phenomena.",
            "id": "4009431",
            "problem": "Consider a three-dimensional periodic rectangular box with side lengths $L_x$, $L_y$, and $L_z$ and periodic boundary conditions in all directions. In magnetohydrodynamics (MHD), assume a magnetostatic configuration with negligible electric field where the magnetic field $\\mathbf{B}(\\mathbf{x})$ is solenoidal and the current density $\\mathbf{J}(\\mathbf{x})$ satisfies the static Maxwell equations. A Beltrami field is defined by the eigenvalue equation $\\nabla \\times \\mathbf{B} = \\alpha \\mathbf{B}$ for some constant $\\alpha$, which implies that $\\mathbf{J}$ is parallel to $\\mathbf{B}$. The electromagnetic stress that acts on surfaces is encoded in the Maxwell stress tensor. Starting from the fundamental laws (magnetostatics, momentum conservation, and the definition of traction on a surface), derive the appropriate expression for the Maxwell stress tensor in the absence of electric field and show how its divergence relates to the force density in the plasma. Then, use these principles to design and implement a program that computes the Maxwell stress tensor for a specific periodic Beltrami magnetic field and numerically verifies that the net stress integrated over all box faces is zero.\n\nThe specific magnetic field to be used in the computation is the Arnold–Beltrami–Childress (ABC) field with equal amplitudes, which is a periodic Beltrami field for integer wavenumber $k$. Define the domain to be $[0,2\\pi)\\times[0,2\\pi)\\times[0,2\\pi)$, with angles in radians, and the magnetic field components\n$$\nB_x(x,y,z) = A \\left[\\sin(k\\,z) + \\cos(k\\,y)\\right], \\quad\nB_y(x,y,z) = A \\left[\\sin(k\\,x) + \\cos(k\\,z)\\right], \\quad\nB_z(x,y,z) = A \\left[\\sin(k\\,y) + \\cos(k\\,x)\\right],\n$$\nwhere $A$ is a real amplitude and $k$ is a positive integer. For this field, the curl satisfies $\\nabla \\times \\mathbf{B} = k\\,\\mathbf{B}$, so $\\alpha = k$. Use normalized units typical in computational fusion science such that the magnetic permeability $\\mu_0$ is set to $1$, making the Maxwell stress tensor dimensionless. All angles must be in radians. Express all final numerical results in dimensionless units.\n\nYour program must:\n- Discretize the domain with a uniform grid of $N_x$, $N_y$, $N_z$ points in $x$, $y$, $z$ respectively, using periodic sampling with $x\\in[0,2\\pi)$, $y\\in[0,2\\pi)$, $z\\in[0,2\\pi)$ and endpoints excluded.\n- Construct the field $\\mathbf{B}$ on the grid as specified above.\n- Compute the Maxwell stress tensor field (derived in your solution) at each grid point.\n- Compute the traction vector $\\mathbf{t} = \\mathbf{T}\\cdot\\mathbf{n}$ on each of the $6$ faces of the box, where $\\mathbf{n}$ is the outward unit normal to the face. For the faces at $x=0$ and $x=2\\pi$, use $\\mathbf{n} = -\\hat{\\mathbf{e}}_x$ and $\\mathbf{n} = +\\hat{\\mathbf{e}}_x$ respectively; similarly for $y$ and $z$ faces. Numerically integrate the traction over each face using Riemann sums with the appropriate area element ($\\mathrm{d}y\\,\\mathrm{d}z$ for $x$-faces, $\\mathrm{d}x\\,\\mathrm{d}z$ for $y$-faces, and $\\mathrm{d}x\\,\\mathrm{d}y$ for $z$-faces), then sum the contributions from all $6$ faces to obtain the net integrated traction vector over the closed surface.\n- Return the Euclidean norm of the net integrated traction vector as a single float for each test case. This value should be numerically close to zero. All angles must be in radians, and results must be expressed in dimensionless units.\n\nUse the following test suite, which explores different resolutions, amplitudes, and wavenumbers:\n$1.$ $k=1$, $A=1$, $N_x=64$, $N_y=64$, $N_z=64$.\n$2.$ $k=1$, $A=1$, $N_x=8$, $N_y=8$, $N_z=8$.\n$3.$ $k=4$, $A=0.5$, $N_x=64$, $N_y=64$, $N_z=64$.\n$4.$ $k=2$, $A=1.2$, $N_x=32$, $N_y=48$, $N_z=40$.\n$5.$ $k=1$, $A=1$, $N_x=4$, $N_y=4$, $N_z=4$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as listed above, with each float formatted in scientific notation with $12$ digits after the decimal point (for example, $[1.234567890123e-04,5.000000000000e-01]$). The angle unit throughout must be radians, and the outputs must be in dimensionless units.",
            "solution": "The problem asks for a derivation of the Maxwell stress tensor in magnetostatics and its application in a numerical computation to verify a consequence of the divergence theorem for a specific periodic magnetic field.\n\nFirst, we derive the expression for the Maxwell stress tensor, $\\mathbf{T}$, in a magnetostatic system with no electric field ($\\mathbf{E}=\\mathbf{0}$) and in normalized units where the permeability of free space $\\mu_0=1$. The force per unit volume, or force density, exerted by a magnetic field on a plasma is the Lorentz force density, given by\n$$\n\\mathbf{f} = \\mathbf{J} \\times \\mathbf{B}\n$$\nwhere $\\mathbf{J}$ is the current density and $\\mathbf{B}$ is the magnetic field. In a static configuration, Ampere's Law relates the current density to the magnetic field via\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}\n$$\nWith $\\mu_0=1$, we have $\\mathbf{J} = \\nabla \\times \\mathbf{B}$. Substituting this into the force density expression yields\n$$\n\\mathbf{f} = (\\nabla \\times \\mathbf{B}) \\times \\mathbf{B}\n$$\nUsing the vector calculus identity $(\\nabla \\times \\mathbf{A}) \\times \\mathbf{A} = (\\mathbf{A} \\cdot \\nabla)\\mathbf{A} - \\frac{1}{2}\\nabla(A^2)$, we can rewrite the force density as\n$$\n\\mathbf{f} = (\\mathbf{B} \\cdot \\nabla)\\mathbf{B} - \\nabla\\left(\\frac{B^2}{2}\\right)\n$$\nwhere $B^2 = \\mathbf{B} \\cdot \\mathbf{B} = B_x^2 + B_y^2 + B_z^2$. The magnetic field is solenoidal, meaning $\\nabla \\cdot \\mathbf{B} = 0$. This allows us to rewrite the first term. The divergence of the dyadic product $\\mathbf{B}\\mathbf{B}$ is $\\nabla \\cdot (\\mathbf{B}\\mathbf{B}) = (\\nabla \\cdot \\mathbf{B})\\mathbf{B} + (\\mathbf{B} \\cdot \\nabla)\\mathbf{B}$. Since $\\nabla \\cdot \\mathbf{B} = 0$, we have $(\\mathbf{B} \\cdot \\nabla)\\mathbf{B} = \\nabla \\cdot (\\mathbf{B}\\mathbf{B})$. Substituting this back into the force density equation gives\n$$\n\\mathbf{f} = \\nabla \\cdot (\\mathbf{B}\\mathbf{B}) - \\nabla\\left(\\frac{B^2}{2}\\right)\n$$\nTo express this as the divergence of a single tensor, we write the expression in tensor index notation:\n$$\nf_i = \\sum_{j=1}^{3} \\frac{\\partial}{\\partial x_j} (B_i B_j) - \\frac{\\partial}{\\partial x_i} \\left(\\frac{1}{2} B^2\\right)\n$$\nUsing the Kronecker delta, $\\delta_{ij}$, we can write the gradient term as a divergence: $\\frac{\\partial}{\\partial x_i} = \\sum_{j=1}^{3} \\delta_{ij} \\frac{\\partial}{\\partial x_j}$. This gives\n$$\nf_i = \\sum_j \\frac{\\partial}{\\partial x_j} (B_i B_j) - \\sum_j \\frac{\\partial}{\\partial x_j} \\left(\\frac{1}{2} B^2 \\delta_{ij}\\right) = \\sum_j \\frac{\\partial}{\\partial x_j} \\left( B_i B_j - \\frac{1}{2} B^2 \\delta_{ij} \\right)\n$$\nThis shows that the force density is the divergence of a tensor, $\\mathbf{f} = \\nabla \\cdot \\mathbf{T}$. The tensor $\\mathbf{T}$ is the Maxwell stress tensor, whose components are\n$$\nT_{ij} = B_i B_j - \\frac{1}{2} (B_x^2 + B_y^2 + B_z^2) \\delta_{ij}\n$$\nThe total force $\\mathbf{F}$ on a fluid element in a volume $V$ is the integral of the force density over that volume:\n$$\n\\mathbf{F} = \\int_V \\mathbf{f} \\, dV = \\int_V (\\nabla \\cdot \\mathbf{T}) \\, dV\n$$\nBy the divergence theorem, this volume integral can be converted into a surface integral over the boundary $S = \\partial V$ of the volume:\n$$\n\\mathbf{F} = \\oint_S \\mathbf{T} \\cdot d\\mathbf{S} = \\oint_S (\\mathbf{T} \\cdot \\mathbf{n}) \\, dS\n$$\nwhere $\\mathbf{n}$ is the outward-pointing unit normal vector to the surface element $dS$. The vector $\\mathbf{t} = \\mathbf{T} \\cdot \\mathbf{n}$ is the traction, or force per unit area, acting on the surface. For the specified periodic box $[0, 2\\pi)^3$, the total force on the volume is the sum of integrals over the $6$ faces. Due to the periodicity of the magnetic field $\\mathbf{B}(\\mathbf{x})$, the stress tensor $\\mathbf{T}(\\mathbf{x})$ is also periodic. For any pair of opposite faces, e.g., the face at $x=0$ (with normal $\\mathbf{n}=-\\hat{\\mathbf{e}}_x$) and the face at $x=2\\pi$ (with normal $\\mathbf{n}=+\\hat{\\mathbf{e}}_x$), the field values are identical: $\\mathbf{T}(x=0, y, z) = \\mathbf{T}(x=2\\pi, y, z)$. The sum of forces from this pair of faces is $\\int_0^{2\\pi} \\int_0^{2\\pi} [\\mathbf{T}(x=2\\pi,y,z)\\cdot\\hat{\\mathbf{e}}_x + \\mathbf{T}(x=0,y,z)\\cdot(-\\hat{\\mathbf{e}}_x)] \\,dydz$. Because the tensor fields are identical, the tractions are equal and opposite, and their sum is zero at every point on the face. Thus, the integral is analytically zero. This holds for all three pairs of faces, so the net integrated traction over the closed surface is identically zero. The numerical program will verify this by computing the sum and showing it is close to zero, limited only by floating-point precision.\n\nThe algorithm to implement this verification is as follows:\nFor each test case, specified by parameters $k, A, N_x, N_y, N_z$:\n1. Initialize a total force vector $\\mathbf{F}_{net} = (0,0,0)$.\n2. Calculate the force on each of the $6$ faces of the box $[0, 2\\pi)^3$ and add it to $\\mathbf{F}_{net}$. The force on a single face with normal $\\mathbf{n}$ is computed by a Riemann sum: $\\mathbf{F}_{\\text{face}} = \\sum_{i} (\\mathbf{T}_i \\cdot \\mathbf{n}) \\Delta A_i$, where $\\Delta A_i$ is the area of a grid cell on the face.\n3. For the pair of faces at $x=0$ and $x=2\\pi$:\n   a. Create a 2D grid of $N_y \\times N_z$ points $(y_j, z_k)$ for the face. The area element is $\\Delta A = (2\\pi/N_y)(2\\pi/N_z)$.\n   b. The field $\\mathbf{B}$ and tensor $\\mathbf{T}$ are evaluated at all points $(x=0, y_j, z_k)$. Due to periodicity, these values are also valid for the face at $x=2\\pi$.\n   c. The traction column vector for the $x$-faces is $(T_{xx}, T_{xy}, T_{xz})^T$.\n   d. The force on the $x=0$ face is $\\mathbf{F}_{x-} = -\\Delta A \\sum_{j,k} (T_{xx}, T_{xy}, T_{xz})^T$.\n   e. The force on the $x=2\\pi$ face is $\\mathbf{F}_{x+} = +\\Delta A \\sum_{j,k} (T_{xx}, T_{xy}, T_{xz})^T$.\n   f. Add $\\mathbf{F}_{x-}$ and $\\mathbf{F}_{x+}$ to $\\mathbf{F}_{net}$.\n4. Repeat step 3 for the faces at $y=0, 2\\pi$ (normal $\\mp\\hat{\\mathbf{e}}_y$, traction column $(T_{yx}, T_{yy}, T_{yz})^T = (T_{xy}, T_{yy}, T_{yz})^T$) and $z=0, 2\\pi$ (normal $\\mp\\hat{\\mathbf{e}}_z$, traction column $(T_{zx}, T_{zy}, T_{zz})^T = (T_{xz}, T_{yz}, T_{zz})^T$).\n5. After summing the forces from all $6$ faces, compute the Euclidean norm of the final vector $\\mathbf{F}_{net}$. This norm, which should be close to zero, is the result for the test case.\nThis procedure is implemented in the Python code below.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Maxwell stress tensor computation for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # (k, A, Nx, Ny, Nz)\n        (1, 1.0, 64, 64, 64),\n        (1, 1.0, 8, 8, 8),\n        (4, 0.5, 64, 64, 64),\n        (2, 1.2, 32, 48, 40),\n        (1, 1.0, 4, 4, 4),\n    ]\n\n    results = []\n    for k, A, Nx, Ny, Nz in test_cases:\n        norm = calculate_net_force_norm(k, A, Nx, Ny, Nz)\n        results.append(f\"{norm:.12e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_net_force_norm(k, A, Nx, Ny, Nz):\n    \"\"\"\n    Computes the Maxwell stress tensor for a periodic ABC field and verifies\n    that the net integrated traction over the box faces is zero.\n\n    Args:\n        k (int): Wavenumber.\n        A (float): Amplitude.\n        Nx (int): Number of grid points in x.\n        Ny (int): Number of grid points in y.\n        Nz (int): Number of grid points in z.\n\n    Returns:\n        float: The Euclidean norm of the net integrated traction vector.\n    \"\"\"\n    L = 2.0 * np.pi\n    total_force = np.zeros(3, dtype=np.float64)\n\n    # --- Helper function to compute B field ---\n    def compute_B(x, y, z):\n        Bx = A * (np.sin(k * z) + np.cos(k * y))\n        By = A * (np.sin(k * x) + np.cos(k * z))\n        Bz = A * (np.sin(k * y) + np.cos(k * x))\n        return Bx, By, Bz\n\n    # --- Helper function to compute Maxwell stress tensor components ---\n    def compute_T(Bx, By, Bz):\n        B_sq = Bx**2 + By**2 + Bz**2\n        Txx = Bx**2 - 0.5 * B_sq\n        Tyy = By**2 - 0.5 * B_sq\n        Tzz = Bz**2 - 0.5 * B_sq\n        Txy = Bx * By\n        Txz = Bx * Bz\n        Tyz = By * Bz\n        return Txx, Tyy, Tzz, Txy, Txz, Tyz\n\n    # --- Faces with normals in +/- x direction ---\n    dy, dz = L / Ny, L / Nz\n    dA_yz = dy * dz\n    y_coords = np.linspace(0, L, Ny, endpoint=False)\n    z_coords = np.linspace(0, L, Nz, endpoint=False)\n    yy_face, zz_face = np.meshgrid(y_coords, z_coords, indexing='ij')\n    # Evaluate at x=0; periodicity implies B(x=L, y, z) = B(x=0, y, z)\n    xx_face = np.zeros_like(yy_face)\n    \n    Bx, By, Bz = compute_B(xx_face, yy_face, zz_face)\n    Txx, _, _, Txy, Txz, _ = compute_T(Bx, By, Bz)\n    \n    # Traction vector on x-face is (Txx, Txy, Txz)\n    traction_sum_x = np.array([np.sum(Txx), np.sum(Txy), np.sum(Txz)])\n    \n    # Force on face at x=L (n = +ex)\n    force_x_plus = traction_sum_x * dA_yz\n    # Force on face at x=0 (n = -ex)\n    force_x_minus = -traction_sum_x * dA_yz\n    total_force += (force_x_plus + force_x_minus)\n\n    # --- Faces with normals in +/- y direction ---\n    dx, dz = L / Nx, L / Nz\n    dA_xz = dx * dz\n    x_coords = np.linspace(0, L, Nx, endpoint=False)\n    z_coords = np.linspace(0, L, Nz, endpoint=False)\n    xx_face, zz_face = np.meshgrid(x_coords, z_coords, indexing='ij')\n    # Evaluate at y=0\n    yy_face = np.zeros_like(xx_face)\n\n    Bx, By, Bz = compute_B(xx_face, yy_face, zz_face)\n    _, Tyy, _, Txy, _, Tyz = compute_T(Bx, By, Bz)\n\n    # Traction vector on y-face is (Txy, Tyy, Tyz)\n    traction_sum_y = np.array([np.sum(Txy), np.sum(Tyy), np.sum(Tyz)])\n    \n    # Force on face at y=L (n = +ey)\n    force_y_plus = traction_sum_y * dA_xz\n    # Force on face at y=0 (n = -ey)\n    force_y_minus = -traction_sum_y * dA_xz\n    total_force += (force_y_plus + force_y_minus)\n\n    # --- Faces with normals in +/- z direction ---\n    dx, dy = L / Nx, L / Ny\n    dA_xy = dx * dy\n    x_coords = np.linspace(0, L, Nx, endpoint=False)\n    y_coords = np.linspace(0, L, Ny, endpoint=False)\n    xx_face, yy_face = np.meshgrid(x_coords, y_coords, indexing='ij')\n    # Evaluate at z=0\n    zz_face = np.zeros_like(xx_face)\n\n    Bx, By, Bz = compute_B(xx_face, yy_face, zz_face)\n    _, _, Tzz, _, Txz, Tyz = compute_T(Bx, By, Bz)\n\n    # Traction vector on z-face is (Txz, Tyz, Tzz)\n    traction_sum_z = np.array([np.sum(Txz), np.sum(Tyz), np.sum(Tzz)])\n    \n    # Force on face at z=L (n = +ez)\n    force_z_plus = traction_sum_z * dA_xy\n    # Force on face at z=0 (n = -ez)\n    force_z_minus = -traction_sum_z * dA_xy\n    total_force += (force_z_plus + force_z_minus)\n\n    return np.linalg.norm(total_force)\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}