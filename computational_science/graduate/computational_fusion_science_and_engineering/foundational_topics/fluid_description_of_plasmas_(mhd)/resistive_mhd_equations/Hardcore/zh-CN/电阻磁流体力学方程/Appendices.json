{
    "hands_on_practices": [
        {
            "introduction": "电阻磁流体力学（MHD）模型的核心在于电阻率 $\\eta$ 的存在，它量化了等离子体对电流的阻碍。本练习将从微观的库仑碰撞物理出发，推导著名的Spitzer电阻率公式，从而将第一性原理与宏观输运系数联系起来。通过计算托卡马克核心和边界等离子体的典型电阻率数值，你将对磁场在聚变等离子体中的扩散行为有一个更具体的认识。",
            "id": "4039149",
            "problem": "在电阻磁流体动力学（MHD）中，进入广义欧姆定律的碰撞电阻率源于电子通过库仑碰撞向离子损失动量。请从第一性原理出发，完成以下任务：\n\n- 从电子动量平衡方程开始，将摩擦力密度与碰撞频率联系起来，并在广义欧姆定律的碰撞极限下，将电阻率定义为电场和电流密度之间的比例常数。\n- 使用弱耦合、完全电离等离子体极限下的小角度库仑碰撞理论，推导电子-离子碰撞频率，并说明它如何决定电阻率的温度标度关系。明确地将此标度关系与离子电荷态和库仑对数联系起来。\n- 在国际单位制（SI）下仔细进行推导，将最终的电阻率表示为一个闭合形式的解析表达式，该表达式以电子电荷 $e$、电子质量 $m_e$、真空介电常数 $\\varepsilon_0$、玻尔兹曼常数 $k_B$、电子温度 $T_e$（单位为 $\\mathrm{eV}$）、有效电荷数 $Z$ 和库仑对数 $\\ln\\Lambda$ 为变量。\n\n然后，针对两种科学上真实的托卡马克条件，评估电阻率的大小：\n\n- 芯部：$T_e = 12\\,\\mathrm{keV}$，$Z = 1.7$，$\\ln\\Lambda = 17.5$。\n- 边缘：$T_e = 150\\,\\mathrm{eV}$，$Z = 3.5$，$\\ln\\Lambda = 15.0$。\n\n假设准中性和完全电离。使用以下SI单位制下的物理常数：$e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$，$m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$，$\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,\\mathrm{F/m}$，$k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。将最终的数值电阻率以 $\\Omega\\cdot\\mathrm{m}$ 为单位表示。将每个数值四舍五入到四位有效数字。将芯部和边缘的两个最终答案分别作为一个单行矩阵中的元素返回。",
            "solution": "该问题是等离子体物理学中一个有效的科学练习。它要求从第一性原理推导碰撞电阻率，并针对真实的聚变等离子体参数进行评估。\n\n### 步骤 1：提取给定条件\n- **任务**：在电阻磁流体动力学中推导电阻率 $\\eta$ 的表达式。\n- **出发点**：电子动量平衡。\n- **方法论**：将摩擦力与碰撞频率关联，通过欧姆定律定义 $\\eta$，并使用适用于弱耦合、完全电离等离子体的小角度库仑碰撞理论。\n- **单位**：国际单位制（SI）。\n- **最终表达式变量**：电子电荷 $e$、电子质量 $m_e$、真空介电常数 $\\varepsilon_0$、玻尔兹曼常数 $k_B$、电子温度（以 eV 为单位）$T_e$、有效电荷数 $Z$ 以及库仑对数 $\\ln\\Lambda$。\n- **假设**：准中性（$n_e = Z n_i$）、完全电离。\n- **条件 1 (芯部)**：$T_e = 12\\,\\mathrm{keV}$，$Z = 1.7$，$\\ln\\Lambda = 17.5$。\n- **条件 2 (边缘)**：$T_e = 150\\,\\mathrm{eV}$，$Z = 3.5$，$\\ln\\Lambda = 15.0$。\n- **物理常数 (SI 单位)**：\n  - $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$\n  - $m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$\n  - $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,\\mathrm{F/m}$\n  - $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$\n- **输出要求**：$\\eta_{core}$ 和 $\\eta_{edge}$ 的数值（单位为 $\\Omega\\cdot\\mathrm{m}$），四舍五入至四位有效数字，以行矩阵形式呈现。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题科学基础扎实，提法明确，且客观。\n- **科学基础**：Spitzer 电阻率的推导是等离子体物理学中的一个经典课题，基于经典电磁学和统计力学。该问题牢固地植根于既定原理。\n- **提法明确性**：要求进行标准推导，然后直接计算。所有必要的常数和参数都已提供。假设条件明确陈述。存在唯一解。\n- **客观性**：语言精确且无偏见。托卡马克芯部和边缘的参数在科学上是真实的。\n- **完整性**：问题提供了推导和计算所需的所有必要信息。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 电阻率的推导\n\n等离子体中的电阻率 $\\eta$ 量化了对电流流动的阻碍。它主要源于载流电子在与离子碰撞中损失的动量。\n\n**1. 从电子动量平衡（广义欧姆定律）推导电阻率**\n\n电子流体的运动由电子动量平衡方程描述：\n$$ m_e n_e \\left( \\frac{\\partial \\mathbf{v}_e}{\\partial t} + \\mathbf{v}_e \\cdot \\nabla \\mathbf{v}_e \\right) = -n_e e (\\mathbf{E} + \\mathbf{v}_e \\times \\mathbf{B}) - \\nabla p_e + \\mathbf{R}_{ei} $$\n其中 $m_e$ 是电子质量，$n_e$ 是电子数密度，$\\mathbf{v}_e$ 是电子流体速度，$e$ 是元电荷，$\\mathbf{E}$ 是电场，$\\mathbf{B}$ 是磁场，$p_e$ 是电子压力，$\\mathbf{R}_{ei}$ 是由于与离子碰撞而作用在电子上的摩擦力密度。\n\n在稳态（$\\frac{\\partial}{\\partial t} = 0$）和均匀等离子体（$\\nabla = 0$）的碰撞极限下，忽略洛伦兹力和压力梯度项（这对于平行于 $\\mathbf{B}$ 的分量或在非磁化等离子体中是精确的），方程简化为电场力与碰撞摩擦之间的平衡：\n$$ 0 = -n_e e \\mathbf{E} + \\mathbf{R}_{ei} $$\n摩擦力密度 $\\mathbf{R}_{ei}$ 与单位时间内每个电子损失的平均动量成正比。其模型为：\n$$ \\mathbf{R}_{ei} = n_e m_e \\nu_{ei} (\\mathbf{v}_i - \\mathbf{v}_e) $$\n其中 $\\nu_{ei}$ 是动量传递电子-离子碰撞频率，$\\mathbf{v}_i$ 是离子流体速度。\n\n电流密度 $\\mathbf{J}$ 定义为 $\\mathbf{J} = q_i n_i \\mathbf{v}_i + q_e n_e \\mathbf{v}_e = Z e n_i \\mathbf{v}_i - e n_e \\mathbf{v}_e$。使用准中性条件 $n_e = Z n_i$ 并假设离子是静止的（$\\mathbf{v}_i \\approx 0$），这对于电子驱动的电流是典型情况，我们得到 $\\mathbf{J} \\approx -n_e e \\mathbf{v}_e$。同时，$(\\mathbf{v}_i - \\mathbf{v}_e) \\approx -\\mathbf{v}_e = \\frac{\\mathbf{J}}{n_e e}$。\n\n将这些关系代入力平衡方程：\n$$ n_e e \\mathbf{E} = \\mathbf{R}_{ei} = n_e m_e \\nu_{ei} \\left( \\frac{\\mathbf{J}}{n_e e} \\right) = \\frac{m_e \\nu_{ei}}{e} \\mathbf{J} $$\n对 $\\mathbf{E}$ 进行整理，得到简单的欧姆定律：\n$$ \\mathbf{E} = \\left( \\frac{m_e \\nu_{ei}}{n_e e^2} \\right) \\mathbf{J} $$\n根据定义，电阻率 $\\eta$ 是 $\\mathbf{E} = \\eta \\mathbf{J}$ 中的比例常数。因此，我们有：\n$$ \\eta = \\frac{m_e \\nu_{ei}}{n_e e^2} $$\n这个表达式将宏观电阻率与微观碰撞频率 $\\nu_{ei}$ 联系起来。\n\n**2. 电子-离子碰撞频率**\n\n电子-离子动量传递碰撞频率 $\\nu_{ei}$ 是通过考虑许多小角度库仑散射的累积效应推导出来的。详细的动理学理论计算（对电子和离子的麦克斯韦分布进行平均）得出了标准的 Braginskii/Spitzer 结果：\n$$ \\nu_{ei} = \\frac{4 \\sqrt{2\\pi}}{3} \\frac{n_i Z^2 e^4 \\ln\\Lambda}{(4\\pi\\varepsilon_0)^2 \\sqrt{m_e} (k_B T_e)^{3/2}} $$\n其中 $k_B$ 是玻尔兹曼常数，$T_e$ 是以开尔文为单位的电子温度，$\\ln\\Lambda$ 是库仑对数，它解释了在屏蔽库仑势中碰撞参数的范围。使用准中性条件 $n_e = Z n_i$，我们可以写出 $n_i = n_e/Z$：\n$$ \\nu_{ei} = \\frac{4 \\sqrt{2\\pi}}{3} \\frac{(n_e/Z) Z^2 e^4 \\ln\\Lambda}{(4\\pi\\varepsilon_0)^2 \\sqrt{m_e} (k_B T_e)^{3/2}} = \\frac{4 \\sqrt{2\\pi} n_e Z e^4 \\ln\\Lambda}{3 (4\\pi\\varepsilon_0)^2 \\sqrt{m_e} (k_B T_e)^{3/2}} $$\n\n**3. 电阻率的最终表达式**\n\n将 $\\nu_{ei}$ 的表达式代入 $\\eta$ 的公式中：\n$$ \\eta = \\frac{m_e}{n_e e^2} \\left[ \\frac{4 \\sqrt{2\\pi} n_e Z e^4 \\ln\\Lambda}{3 (4\\pi\\varepsilon_0)^2 \\sqrt{m_e} (k_B T_e)^{3/2}} \\right] $$\n电子密度 $n_e$ 被消去，表明电阻率是等离子体的一种内在属性，与密度无关。\n$$ \\eta = \\frac{4 \\sqrt{2\\pi}}{3} \\frac{\\sqrt{m_e} Z e^2 \\ln\\Lambda}{(4\\pi\\varepsilon_0)^2 (k_B T_e)^{3/2}} $$\n这就是著名的 Spitzer 电阻率（在洛伦兹气体近似下，对于大的 $Z$ 是准确的）。它清楚地显示了其依赖关系：$\\eta \\propto Z \\ln\\Lambda T_e^{-3/2}$。\n\n为了用电子伏特（$T_{e,eV}$）表示 $T_e$，我们使用关系式 $k_B T_e(\\mathrm{K}) = e T_{e,eV}$。\n$$ \\eta = \\frac{4 \\sqrt{2\\pi}}{3} \\frac{\\sqrt{m_e} Z e^2 \\ln\\Lambda}{(4\\pi\\varepsilon_0)^2 (e T_{e,eV})^{3/2}} = \\frac{\\sqrt{2}}{12 \\pi^{3/2}} \\frac{\\sqrt{m_e} Z e^2 \\ln\\Lambda}{\\varepsilon_0^2 e^{3/2} T_{e,eV}^{3/2}} $$\n简化常数后，得到所要求的闭合形式解析表达式：\n$$ \\eta = \\frac{\\sqrt{2}}{12 \\pi^{3/2}} \\frac{\\sqrt{m_e} e^{1/2} Z \\ln\\Lambda}{\\varepsilon_0^2 T_{e,eV}^{3/2}} $$\n\n### 数值计算\n\n我们首先计算常数前因子 $C_0$：\n$$ C_0 = \\frac{\\sqrt{2m_e} e^{1/2}}{12 \\pi^{3/2} \\varepsilon_0^2} $$\n使用提供的物理常数：\n$C_0 = \\frac{\\sqrt{2 \\cdot (9.1093837015\\times 10^{-31}\\,\\mathrm{kg})} \\sqrt{1.602176634\\times 10^{-19}\\,\\mathrm{C}}}{12 \\pi^{3/2} (8.8541878128\\times 10^{-12}\\,\\mathrm{F/m})^2}$\n$C_0 = \\frac{(1.34976915 \\times 10^{-15}) \\cdot (1.2657791 \\times 10^{-10})}{12 \\cdot (5.568328) \\cdot (7.8396676 \\times 10^{-23})}$\n$C_0 = \\frac{1.708805 \\times 10^{-25}}{5.23830 \\times 10^{-21}}$\n$C_0 \\approx 3.2625 \\times 10^{-5} \\, \\frac{\\Omega\\cdot\\mathrm{m}\\cdot(\\mathrm{eV})^{3/2}}{\\mathrm{unitless}}$\n因此，我们的工作公式是：\n$$ \\eta \\approx (3.2625 \\times 10^{-5}) \\frac{Z \\ln\\Lambda}{T_{e,eV}^{3/2}} \\, \\Omega\\cdot\\mathrm{m} $$\n\n**托卡马克芯部条件：**\n- $T_e = 12\\,\\mathrm{keV} = 1.2 \\times 10^4\\,\\mathrm{eV}$\n- $Z = 1.7$\n- $\\ln\\Lambda = 17.5$\n\n$$ \\eta_{core} = (3.2625 \\times 10^{-5}) \\frac{1.7 \\times 17.5}{(1.2 \\times 10^4)^{3/2}} $$\n$$ \\eta_{core} = (3.2625 \\times 10^{-5}) \\frac{29.75}{1314534.5} \\approx 7.3734 \\times 10^{-10} \\, \\Omega\\cdot\\mathrm{m} $$\n四舍五入到四位有效数字，$\\eta_{core} = 7.373 \\times 10^{-10} \\, \\Omega\\cdot\\mathrm{m}$。\n\n**托卡马克边缘条件：**\n- $T_e = 150\\,\\mathrm{eV}$\n- $Z = 3.5$\n- $\\ln\\Lambda = 15.0$\n\n$$ \\eta_{edge} = (3.2625 \\times 10^{-5}) \\frac{3.5 \\times 15.0}{150^{3/2}} $$\n$$ \\eta_{edge} = (3.2625 \\times 10^{-5}) \\frac{52.5}{1837.117} \\approx 9.3243 \\times 10^{-7} \\, \\Omega\\cdot\\mathrm{m} $$\n四舍五入到四位有效数字，$\\eta_{edge} = 9.324 \\times 10^{-7} \\, \\Omega\\cdot\\mathrm{m}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 7.373 \\times 10^{-10}  9.324 \\times 10^{-7} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在等离子体中，有限的电阻率使得磁场拓扑结构的改变成为可能，从而催生了磁重联这一关键物理过程。本练习将运用电阻MHD方程推导经典的Sweet-Parker重联模型，并将其应用于解释托卡马克中的锯齿振荡现象。通过对比理论预测和实验观测，你将深入理解经典重联理论面临的“快重联问题”。",
            "id": "4039208",
            "problem": "考虑一个柱形托卡马克芯部，其在局域上可近似为一个正在经历磁重联的二维电流片，该过程由电阻磁流体动力学（MHD）描述。使用以下代表安全因子 $q=1$ 磁面的芯部等离子体参数：\n\n- 磁场强度 $B = 3.0\\,\\mathrm{T}$。\n- 电子密度 $n_{e} = 1.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$。\n- 电子温度 $T_{e} = 1.5\\,\\mathrm{keV}$。\n- 离子为氘，其离子质量为 $m_{i} = 3.345 \\times 10^{-27}\\,\\mathrm{kg}$，电荷数为 $Z=1$。\n- 电流片半长（特征重联尺度）$L = 1.0\\,\\mathrm{m}$。\n- 库仑对数 $\\ln\\Lambda = 17$（芯部条件的典型值）。\n\n在现代托卡马克中，观测到的锯齿崩塌持续时间量级为 $\\tau_{\\mathrm{obs}} = 1.0\\,\\mathrm{ms}$。\n\n从电阻MHD感应方程和欧姆定律出发，并利用质量守恒和安培定律得到 Sweet–Parker 标度关系，推导重联入流速度 $v_{\\mathrm{in}}$ 以及相应的重联时间尺度 $\\tau_{\\mathrm{SP}} = L / v_{\\mathrm{in}}$，并用阿尔芬速度 $V_{A}$、磁导率 $\\mu_{0}$ 和电阻率 $\\eta$ 表示。根据给定的 $B$、$n_{e}$ 和 $m_{i}$ 计算阿尔芬速度 $V_{A}$，其中质量密度视为 $\\rho = m_{i} n_{i}$，并满足准中性条件 $n_{i} = n_{e}$。使用完全电离等离子体的标准平行电导率公式估算经典（Spitzer）电阻率 $\\eta_{\\mathrm{Sp}}$，公式为\n$$\\sigma_{\\parallel} \\approx \\frac{1.92 \\times 10^{4}\\,T_{e}^{3/2}}{Z\\,\\ln\\Lambda}\\ \\mathrm{S/m},$$\n其中 $T_{e}$ 以 $\\mathrm{eV}$ 为单位，且 $\\eta_{\\mathrm{Sp}} = 1/\\sigma_{\\parallel}$。将使用 $\\eta_{\\mathrm{Sp}}$ 得到的 Sweet–Parker 重联时间尺度 $\\tau_{\\mathrm{SP}}$ 与 $\\tau_{\\mathrm{obs}}$ 进行比较，并通过反演 Sweet–Parker 标度关系，确定使 $\\tau_{\\mathrm{SP}}$ 等于 $\\tau_{\\mathrm{obs}}$ 所需的有效电阻率 $\\eta_{\\mathrm{req}}$ 的值。\n\n将你关于 $\\eta_{\\mathrm{req}}$ 的最终答案四舍五入到三位有效数字。最终答案以 $\\mathrm{\\Omega\\cdot m}$ 为单位表示。所有步骤必须从电阻MHD的第一性原理和等离子体基本定义出发进行推导；不要在未经推导的情况下假设任何重联率公式。",
            "solution": "该问题要求推导 Sweet–Parker 重联时间尺度，使用经典等离子体参数进行计算，并最终确定一个能够解释托卡马克中观测到的重联时间尺度的有效电阻率。\n\n首先，我们推导 Sweet–Parker 标度关系。该模型考虑一个稳态（$\\frac{\\partial}{\\partial t} = 0$）的二维磁重联过程，该过程发生在一个半长为 $L$、半宽为 $\\delta$ 的电流片中。我们从电阻MHD的欧姆定律开始：\n$$ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{j} $$\n在稳态下，法拉第定律 $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$ 意味着 $\\nabla \\times \\mathbf{E} = 0$，这在这种二维几何结构中表示存在一个均匀的重联电场，我们称之为 $E_z$，其方向垂直于平面向外。\n\n在远离电流片的“理想”入流区，电阻率 $\\eta$ 可忽略不计。等离子体以速度 $v_{\\mathrm{in}}$ 流入，磁场强度为 $B$。欧姆定律简化为 $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\approx 0$。因此，重联电场的强度由入流条件决定：\n$$ E_z \\approx v_{\\mathrm{in}} B $$\n在电阻层中心（X点），磁场和等离子体速度理想情况下为零，因此 $\\mathbf{v} \\times \\mathbf{B}$ 项消失。此处，欧姆定律给出：\n$$ E_z = \\eta j_z $$\n其中 $j_z$ 是电流片中的电流密度。令 $E_z$ 的两个表达式相等，得到重联率的基本关系：\n$$ v_{\\mathrm{in}} B = \\eta j_z $$\n使用安培定律 $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{j}$，我们可以估算电流密度。磁场在电流片的宽度（$2\\delta$）上反向，所以旋度可以近似为 $|\\nabla \\times \\mathbf{B}| \\sim \\frac{B}{\\delta}$。这给出的电流密度为 $j_z \\sim \\frac{B}{\\mu_0 \\delta}$。将此代入我们的重联关系式：\n$$ v_{\\mathrm{in}} B \\approx \\eta \\frac{B}{\\mu_0 \\delta} \\implies v_{\\mathrm{in}} \\approx \\frac{\\eta}{\\mu_0 \\delta} $$\n接下来，我们应用质量守恒。假设等离子体不可压缩（$\\nabla \\cdot \\mathbf{v} = 0$），则进入重联区的质量通量必须等于流出重联区的质量通量。等离子体通过面积 $2L \\times 1$（在z方向长度为1）进入，通过面积 $2\\delta \\times 1$ 流出。这给出：\n$$ \\rho v_{\\mathrm{in}} (2L) = \\rho v_{\\mathrm{out}} (2\\delta) \\implies v_{\\mathrm{in}} L = v_{\\mathrm{out}} \\delta $$\n最后，我们使用动量守恒。入流区的磁压 $P_m = \\frac{B^2}{2\\mu_0}$ 转化为流出等离子体射流的动能 $\\frac{1}{2}\\rho v_{\\mathrm{out}}^2$。\n$$ \\frac{B^2}{2\\mu_0} \\approx \\frac{1}{2}\\rho v_{\\mathrm{out}}^2 \\implies v_{\\mathrm{out}} \\approx \\frac{B}{\\sqrt{\\mu_0 \\rho}} $$\n这个流出速度就是阿尔芬速度，$V_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}}$。所以，$v_{\\mathrm{out}} \\approx V_A$。\n\n我们现在有一个包含三个方程的方程组：\n1. $v_{\\mathrm{in}} \\approx \\frac{\\eta}{\\mu_0 \\delta}$\n2. $v_{\\mathrm{in}} L = v_{\\mathrm{out}} \\delta$\n3. $v_{\\mathrm{out}} \\approx V_A$\n\n从(2)和(3)中，我们将 $\\delta$ 表示为 $\\delta = \\frac{v_{\\mathrm{in}} L}{V_A}$。将其代入(1)：\n$$ v_{\\mathrm{in}} \\approx \\frac{\\eta}{\\mu_0} \\left( \\frac{V_A}{v_{\\mathrm{in}} L} \\right) = \\frac{\\eta V_A}{\\mu_0 L v_{\\mathrm{in}}} $$\n$$ v_{\\mathrm{in}}^2 \\approx \\frac{\\eta V_A}{\\mu_0 L} \\implies v_{\\mathrm{in}} \\approx \\sqrt{\\frac{\\eta V_A}{\\mu_0 L}} $$\nSweet–Parker 重联时间尺度 $\\tau_{\\mathrm{SP}}$ 是等离子体流过整个电流片长度所需的时间，即 $\\tau_{\\mathrm{SP}} = L / v_{\\mathrm{in}}$。\n$$ \\tau_{\\mathrm{SP}} = \\frac{L}{v_{\\mathrm{in}}} = L \\sqrt{\\frac{\\mu_0 L}{\\eta V_A}} = \\sqrt{\\frac{\\mu_0 L^3}{\\eta V_A}} $$\n这就完成了所要求的推导。\n\n现在，我们计算数值。给定的参数是：\n$B = 3.0\\,\\mathrm{T}$\n$n_{e} = 1.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$\n$T_{e} = 1.5\\,\\mathrm{keV} = 1500\\,\\mathrm{eV}$\n$m_{i} = 3.345 \\times 10^{-27}\\,\\mathrm{kg}$\n$Z = 1$\n$L = 1.0\\,\\mathrm{m}$\n$\\ln\\Lambda = 17$\n$\\tau_{\\mathrm{obs}} = 1.0\\,\\mathrm{ms} = 1.0 \\times 10^{-3}\\,\\mathrm{s}$\n自由空间的磁导率为 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{T\\cdot m/A}$。\n\n1.  计算质量密度 $\\rho$。在准中性条件下，$n_i = n_e = 1.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$。\n    $$ \\rho = n_i m_i = (1.0 \\times 10^{20}\\,\\mathrm{m}^{-3}) (3.345 \\times 10^{-27}\\,\\mathrm{kg}) = 3.345 \\times 10^{-7}\\,\\mathrm{kg/m^3} $$\n\n2.  计算阿尔芬速度 $V_A$。\n    $$ V_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}} = \\frac{3.0}{\\sqrt{(4\\pi \\times 10^{-7}) (3.345 \\times 10^{-7})}} = \\frac{3.0}{\\sqrt{4.2035 \\times 10^{-13}}} \\approx 4.6273 \\times 10^{6}\\,\\mathrm{m/s} $$\n\n3.  计算经典 Spitzer 电阻率 $\\eta_{\\mathrm{Sp}}$。首先，我们求电导率 $\\sigma_{\\parallel}$。\n    $$ \\sigma_{\\parallel} = \\frac{1.92 \\times 10^{4} \\, T_{e}^{3/2}}{Z\\,\\ln\\Lambda} = \\frac{1.92 \\times 10^{4} \\, (1500)^{3/2}}{1 \\times 17} \\approx \\frac{1.92 \\times 10^{4} \\times 58095}{17} \\approx 6.552 \\times 10^{7}\\,\\mathrm{S/m} $$\n    电阻率是电导率的倒数：\n    $$ \\eta_{\\mathrm{Sp}} = \\frac{1}{\\sigma_{\\parallel}} \\approx \\frac{1}{6.552 \\times 10^{7}} \\approx 1.526 \\times 10^{-8}\\,\\mathrm{\\Omega\\cdot m} $$\n\n4.  使用 $\\eta_{\\mathrm{Sp}}$ 计算 Sweet–Parker 时间尺度 $\\tau_{\\mathrm{SP}}$。\n    $$ \\tau_{\\mathrm{SP}} = \\sqrt{\\frac{\\mu_0 L^3}{\\eta_{\\mathrm{Sp}} V_A}} = \\sqrt{\\frac{(4\\pi \\times 10^{-7}) (1.0)^3}{(1.526 \\times 10^{-8}) (4.6273 \\times 10^{6})}} \\approx \\sqrt{\\frac{1.2566 \\times 10^{-6}}{0.07062}} \\approx \\sqrt{1.779 \\times 10^{-5}} \\approx 4.218 \\times 10^{-3}\\,\\mathrm{s} $$\n    这个时间尺度约为 $4.22\\,\\mathrm{ms}$。这与观测到的锯齿崩塌时间 $\\tau_{\\mathrm{obs}} = 1.0\\,\\mathrm{ms}$ 处于同一数量级，但仍然存在约4倍的差异。这突显了经典Sweet-Parker理论与快速重联现象之间的差距，并暗示可能需要更复杂的物理（如湍流或双流体效应）来完全解释观测结果。\n\n5.  确定与观测时间尺度相匹配所需的电阻率 $\\eta_{\\mathrm{req}}$。我们令 $\\tau_{\\mathrm{SP}} = \\tau_{\\mathrm{obs}}$，并求解时间尺度方程以得到 $\\eta = \\eta_{\\mathrm{req}}$。\n    $$ \\tau_{\\mathrm{obs}} = \\sqrt{\\frac{\\mu_0 L^3}{\\eta_{\\mathrm{req}} V_A}} $$\n    两边平方并整理得到 $\\eta_{\\mathrm{req}}$：\n    $$ \\tau_{\\mathrm{obs}}^2 = \\frac{\\mu_0 L^3}{\\eta_{\\mathrm{req}} V_A} \\implies \\eta_{\\mathrm{req}} = \\frac{\\mu_0 L^3}{V_A \\tau_{\\mathrm{obs}}^2} $$\n    现在，代入数值：\n    $$ \\eta_{\\mathrm{req}} = \\frac{(4\\pi \\times 10^{-7}\\,\\mathrm{T\\cdot m/A}) (1.0\\,\\mathrm{m})^3}{(4.6273 \\times 10^{6}\\,\\mathrm{m/s}) (1.0 \\times 10^{-3}\\,\\mathrm{s})^2} = \\frac{4\\pi \\times 10^{-7}}{4.6273 \\times 10^{6} \\times 1.0 \\times 10^{-6}} = \\frac{4\\pi \\times 10^{-7}}{4.6273} $$\n    $$ \\eta_{\\mathrm{req}} \\approx 2.7163 \\times 10^{-7}\\,\\mathrm{\\Omega\\cdot m} $$\n\n四舍五入到三位有效数字，所需的有效电阻率为 $2.72 \\times 10^{-7}\\,\\mathrm{\\Omega\\cdot m}$。这种反常高的电阻率表明，在像锯齿崩塌这样的快速重联事件中，非MHD效应（可能是湍流效应或双流体效应）占主导地位。",
            "answer": "$$\n\\boxed{2.72 \\times 10^{-7}}\n$$"
        },
        {
            "introduction": "除了理论分析，数值模拟是研究复杂MHD现象不可或缺的工具。本练习聚焦于电阻MHD的核心方程——磁感应方程，并将其简化为一个一维扩散问题。你将通过冯·诺依曼稳定性分析，推导显式时间积分格式的稳定性条件，并编写一个简单的求解器来验证你的理论分析，从而掌握计算MHD中的基本技能。",
            "id": "4039209",
            "problem": "考虑来自电阻磁流体动力学 (MHD) 的感应方程，该方程专门用于具有恒定磁扩散率 $\\eta$ 的均匀导电介质（磁扩散率是电阻率除以磁导率，单位为 $\\mathrm{m^2/s}$）。从麦克斯韦-法拉第定律和广义欧姆定律出发，并假设流体速度为零，证明感应方程可以简化为单个磁场分量的扩散方程。然后，在一维均匀周期性边界条件的网格上，使用空间二阶中心差分近似和前向欧拉显式时间积分器，进行 von Neumann 稳定性分析，并推导时间步长的稳定性边界。具体来说，请在标准扩散时间步长限制的形式中确定常数 $C$，其中时间步长为满足稳定性而与 $\\Delta t \\sim \\Delta x^2/\\eta$ 成比例。\n\n完成推导后，实现一个程序，在一维空间中根据以下约束和规范对电阻感应方程进行积分：\n\n- 推导的基本依据：\n  - 麦克斯韦-法拉第定律：$\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}$。\n  - 广义欧姆定律（各向同性标量电阻率）：$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta_e \\mathbf{J}$，其中 $\\mathbf{J} = \\nabla \\times \\mathbf{B} / \\mu_0$，磁扩散率 $\\eta = \\eta_e / \\mu_0$。\n  - 无散磁场：$\\nabla \\cdot \\mathbf{B} = 0$。\n- 数值模型：\n  - 通过设速度 $\\mathbf{v}=\\mathbf{0}$ 和恒定磁扩散率 $\\eta$，将问题简化到一维空间 $x$ 和单个磁场分量 $B(x,t)$。\n  - 由此得到的偏微分方程为扩散型：$\\partial_t B = \\eta \\, \\partial_{xx} B$。\n  - 使用 $N$ 个间距为 $\\Delta x = L/N$ 的均匀分布点，在长度为 $L$ 的周期性域上离散化空间。\n  - 使用前向欧拉显式时间积分器和拉普拉斯算子的二阶中心差分近似：$$B_i^{n+1} = B_i^n + \\eta \\, \\Delta t \\, \\frac{B_{i-1}^n - 2 B_i^n + B_{i+1}^n}{\\Delta x^2},$$ 其中 $B_{-1}^n$ 和 $B_{N}^n$ 采用周期性索引。\n- 初始条件：\n  - 选择网格上可解析的最高傅里叶模式来探测最坏情况下的稳定性行为：$B_i^0 = B_0 (-1)^i$，其中 $B_0 = 1$，单位为特斯拉 ($\\mathrm{T}$)。\n- 单位：\n  - $L$ 的单位为米 ($\\mathrm{m}$)，$\\eta$ 的单位为 $\\mathrm{m^2/s}$，$\\Delta t$ 的单位为秒 ($\\mathrm{s}$)，$B$ 的单位为特斯拉 ($\\mathrm{T}$)。\n- 程序的稳定性判定规则：\n  - 对于每个测试用例，积分指定的步数，并计算最终时刻网格上 $B$ 的最大绝对值 $M_{\\text{final}}$。\n  - 如果 $M_{\\text{final}} \\le 10 \\, M_{\\text{initial}}$，则将该情况定义为“稳定”（布尔值为真），其中 $M_{\\text{initial}}$ 是 $t=0$ 时的最大绝对值。否则，定义为“不稳定”（布尔值为假）。\n\n测试套件规范：\n- 对于测试套件中的每个元组，参数为 $(L, N, \\eta, r, n_{\\text{steps}})$，其中 $L$ 单位为米， $N$ 为网格点数的整数，$\\eta$ 单位为 $\\mathrm{m^2/s}$，$r$ 是一个无量纲比率，用于设置时间步长 $\\Delta t = r \\, \\Delta x^2 / \\eta$，$n_{\\text{steps}}$ 是要执行的前向欧拉步数。\n- 使用以下测试套件，涵盖一般情况、稳定性边界以及明显的不稳定区域，并跨越不同的网格分辨率和扩散率：\n  1. $(L, N, \\eta, r, n_{\\text{steps}}) = (1.0, 128, 1.0, 0.45, 500)$\n  2. $(L, N, \\eta, r, n_{\\text{steps}}) = (1.0, 128, 1.0, 0.50, 500)$\n  3. $(L, N, \\eta, r, n_{\\text{steps}}) = (1.0, 128, 1.0, 0.60, 60)$\n  4. $(L, N, \\eta, r, n_{\\text{steps}}) = (1.0, 16, 0.5, 0.55, 120)$\n  5. $(L, N, \\eta, r, n_{\\text{steps}}) = (1.0, 64, 2.0, 0.49, 400)$\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个以逗号分隔的布尔值列表，并用方括号括起来（例如，“[True,False,True,False,True]”），与上述五个测试用例的顺序相对应。",
            "solution": "用户提供的问题被评估为有效。它在科学上基于磁流体动力学（MHD）和数值分析的原理，问题适定且目标明确，并包含完整解决方案所需的所有必要信息。推导路径逻辑上合理，数值任务也得到了精确的规定。\n\n### 第1部分：控制方程的推导\n\n推导从给定的无流体流动情况下的电阻性MHD基本定律开始。\n\n1.  **给定方程**：\n    -   麦克斯韦-法拉第定律：$\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}$\n    -   广义欧姆定律：$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta_e \\mathbf{J}$\n    -   电流密度（来自安培定律）：$\\mathbf{J} = \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B}$\n    -   无散条件：$\\nabla \\cdot \\mathbf{B} = 0$\n\n2.  **根据给定条件进行简化**：\n    -   问题陈述要求假设流体速度为零，即 $\\mathbf{v} = \\mathbf{0}$。欧姆定律简化为 $\\mathbf{E} = \\eta_e \\mathbf{J}$。\n    -   将电流密度 $\\mathbf{J}$ 的表达式代入简化的欧姆定律，得到电场 $\\mathbf{E}$ 关于磁场 $\\mathbf{B}$ 的表达式：\n        $$ \\mathbf{E} = \\eta_e \\left( \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B} \\right) = \\frac{\\eta_e}{\\mu_0} (\\nabla \\times \\mathbf{B}) $$\n    -   磁扩散率 $\\eta$ 定义为 $\\eta = \\eta_e / \\mu_0$。代入此定义，我们得到：\n        $$ \\mathbf{E} = \\eta (\\nabla \\times \\mathbf{B}) $$\n\n3.  **感应方程的推导**：\n    -   我们将此 $\\mathbf{E}$ 的表达式代入麦克斯韦-法拉第定律：\n        $$ \\partial_t \\mathbf{B} = -\\nabla \\times \\left( \\eta (\\nabla \\times \\mathbf{B}) \\right) $$\n    -   鉴于磁扩散率 $\\eta$ 是一个常数标量，可以将其从旋度算子中提出：\n        $$ \\partial_t \\mathbf{B} = -\\eta \\nabla \\times (\\nabla \\times \\mathbf{B}) $$\n    -   我们使用矢量微积分恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$，其中 $\\nabla^2$ 是矢量拉普拉斯算子。将此恒等式应用于我们的方程，得到：\n        $$ \\partial_t \\mathbf{B} = -\\eta \\left( \\nabla(\\nabla \\cdot \\mathbf{B}) - \\nabla^2 \\mathbf{B} \\right) $$\n    -   使用无散条件 $\\nabla \\cdot \\mathbf{B} = 0$，右侧第一项消失：\n        $$ \\partial_t \\mathbf{B} = -\\eta (0 - \\nabla^2 \\mathbf{B}) = \\eta \\nabla^2 \\mathbf{B} $$\n    -   这就是磁感应方程，其形式为矢量扩散方程。对于一个仅在 $x$ 方向变化的一维系统，考虑单个分量 $B(x,t)$，该方程简化为标量扩散方程：\n        $$ \\frac{\\partial B}{\\partial t} = \\eta \\frac{\\partial^2 B}{\\partial x^2} $$\n至此完成了控制偏微分方程的推导。\n\n### 第2部分：von Neumann 稳定性分析\n\n我们分析指定数值格式对于一维扩散方程的稳定性。\n\n1.  **数值格式**：问题指定了前向时间中心空间（FTCS）离散化方法：\n    $$ B_i^{n+1} = B_i^n + \\eta \\frac{\\Delta t}{\\Delta x^2} \\left( B_{i-1}^n - 2 B_i^n + B_{i+1}^n \\right) $$\n    其中 $B_i^n \\approx B(i\\Delta x, n\\Delta t)$。\n\n2.  **傅里叶模式分析**：我们采用标准的 von Neumann 分析，将单个傅里叶模式拟设 $B_i^n = G^n e^{\\mathrm{i} k x_i} = G^n e^{\\mathrm{i} k i \\Delta x}$ 代入差分方程。这里，$G$ 是波数为 $k$ 的放大因子，$\\mathrm{i}$ 是虚数单位。\n    $$ G^{n+1} e^{\\mathrm{i} k i \\Delta x} = G^n e^{\\mathrm{i} k i \\Delta x} + \\frac{\\eta \\Delta t}{\\Delta x^2} \\left( G^n e^{\\mathrm{i} k (i-1) \\Delta x} - 2 G^n e^{\\mathrm{i} k i \\Delta x} + G^n e^{\\mathrm{i} k (i+1) \\Delta x} \\right) $$\n\n3.  **放大因子的推导**：两边同除以 $G^n e^{\\mathrm{i} k i \\Delta x}$，得到 $G$ 的表达式：\n    $$ G = 1 + \\frac{\\eta \\Delta t}{\\Delta x^2} \\left( e^{-\\mathrm{i} k \\Delta x} - 2 + e^{\\mathrm{i} k \\Delta x} \\right) $$\n    使用恒等式 $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2 \\cos(\\theta)$，上式简化为：\n    $$ G = 1 + \\frac{2\\eta \\Delta t}{\\Delta x^2} \\left( \\cos(k \\Delta x) - 1 \\right) $$\n    再利用半角恒等式 $1 - \\cos(\\theta) = 2 \\sin^2(\\theta/2)$，我们得到：\n    $$ G = 1 - \\frac{4\\eta \\Delta t}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) $$\n\n4.  **稳定性条件**：为使格式稳定，放大因子的模必须小于或等于1，即 $|G| \\le 1$。由于 $G$ 是实数，这等价于 $-1 \\le G \\le 1$。\n    -   项 $4 \\frac{\\eta \\Delta t}{\\Delta x^2} \\sin^2(\\frac{k \\Delta x}{2})$ 始终为非负数，因此 $G \\le 1$ 总是满足的。\n    -   非平凡的约束来自于下界，$G \\ge -1$：\n        $$ -1 \\le 1 - \\frac{4\\eta \\Delta t}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) $$\n        $$ \\frac{4\\eta \\Delta t}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 2 $$\n        $$ \\frac{\\eta \\Delta t}{\\Delta x^2} \\le \\frac{1}{2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)} $$\n    这个条件必须对所有波数 $k$ 成立。最严格的情况（“最坏情况”）发生在 $\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)$ 取最大值1时。这对应于网格上可解析的最高频率，即奈奎斯特模式，此时 $k \\Delta x = \\pi$。\n    -   代入这个最大值，得到该格式的 Courant-Friedrichs-Lewy (CFL) 稳定性条件：\n        $$ \\frac{\\eta \\Delta t}{\\Delta x^2} \\le \\frac{1}{2} $$\n    问题将时间步长表示为 $\\Delta t = r \\frac{\\Delta x^2}{\\eta}$，其中 $r$ 是一个无量纲比率。将此代入我们的条件，得到 $r \\le 1/2$。问题要求在 $\\Delta t \\sim \\Delta x^2 / \\eta$ 的标度关系中确定常数 $C$，我们的分析确定 $C=1/2$。因此，当 $r \\le 0.5$ 时，该格式是稳定的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Integrates the 1D resistive induction equation and determines the numerical\n    stability for a set of test cases.\n    \"\"\"\n    # Test suite specification:\n    # Each tuple contains (L, N, eta, r, n_steps)\n    # L: domain length (m)\n    # N: number of grid points\n    # eta: magnetic diffusivity (m^2/s)\n    # r: dimensionless ratio for timestep, r = eta * dt / dx^2\n    # n_steps: number of integration steps\n    test_cases = [\n        (1.0, 128, 1.0, 0.45, 500), # Stable (r  0.5)\n        (1.0, 128, 1.0, 0.50, 500), # Marginally stable (r = 0.5)\n        (1.0, 128, 1.0, 0.60, 60),  # Unstable (r  0.5)\n        (1.0, 16, 0.5, 0.55, 120),  # Unstable (r  0.5)\n        (1.0, 64, 2.0, 0.49, 400),  # Stable (r  0.5)\n    ]\n\n    results = []\n    for case in test_cases:\n        L, N, eta, r, n_steps = case\n        \n        # Spatial grid spacing\n        dx = L / N\n        \n        # The problem defines the timestep via r = eta * dt / dx^2.\n        # This dimensionless number, r, is what governs stability.\n        \n        # Initial condition: B(x,0) = B_0 * (-1)^i, with B_0 = 1.\n        # This corresponds to the highest-resolvable (Nyquist) Fourier mode on the\n        # grid, which is the most unstable mode for this scheme.\n        B = np.array([(-1.0)**i for i in range(N)], dtype=np.float64)\n        \n        # The initial maximum absolute value of B is M_initial = 1.0.\n        # The stability decision rule is M_final = 10 * M_initial.\n        # The threshold is therefore 10.0.\n        stability_threshold = 10.0\n\n        # Main time-integration loop using a Forward-Time Central-Space (FTCS) scheme.\n        for _ in range(n_steps):\n            # The update rule is B_i^{n+1} = B_i^n + r * (B_{i-1}^n - 2*B_i^n + B_{i+1}^n).\n            # We use np.roll for an efficient implementation of the finite difference\n            # operator with periodic boundary conditions.\n            # np.roll(B, 1) provides the B_{i-1} term for all i.\n            # np.roll(B, -1) provides the B_{i+1} term for all i.\n            laplacian_B = np.roll(B, 1) + np.roll(B, -1) - 2 * B\n            B += r * laplacian_B\n            \n            # This check prevents numerical overflow for very unstable cases.\n            # It will not alter the final stability decision, as the value will\n            # have already far exceeded the stability_threshold.\n            if np.max(np.abs(B))  1e12:\n                break\n\n        # After integration, determine stability based on the specified rule.\n        M_final = np.max(np.abs(B))\n        is_stable = M_final = stability_threshold\n        results.append(is_stable)\n\n    # Format and print the final output as a single line.\n    # The output should be a comma-separated list of booleans, e.g., \"[True,False,True]\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}