{
    "hands_on_practices": [
        {
            "introduction": "连续性方程是等离子体流体描述的基石，它确保了粒子数守恒。本练习旨在通过一个简化的稳态一维模型，将这一基本原理付诸实践。通过求解这个问题，您将亲身体会等离子体源和流动剖面如何直接决定密度分布，从而为理解更复杂的输运现象打下坚实的基础。",
            "id": "3958863",
            "problem": "考虑一种占据 $0 \\le x \\le L$ 区域的单一离子种类的一维板状等离子体，其在 $x=0$ 和 $x=L$ 处有不可渗透的壁。一维空间中的离子连续性方程由粒子数平衡给出，即 $\\partial_t n_i + \\partial_x (n_i u_i) = S_{n,i}(x)$，其中 $n_i(x,t)$ 是离子数密度，$u_i(x,t)$ 是离子流速，$S_{n,i}(x)$ 是净粒子源（电离减去复合）。在稳态下，时间导数 $\\partial_t n_i$ 为零。\n\n假设一个给定的稳态离子流速剖面 $u_i(x) = u_0 \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$（其满足边界上的无流动条件），以及一个空间变化的净源剖面 $S_{n,i}(x) = S_0 \\sin\\!\\left(\\frac{2\\pi x}{L}\\right)$（其在板内的积分为零，这与稳态下无净粒子积累相符）。不可渗透壁条件意味着边界处的法向离子粒子通量 $n_i u_i$ 为零，即 $n_i(0) u_i(0) = 0$ 和 $n_i(L) u_i(L) = 0$。\n\n从基本连续性平衡和给定的边界条件出发，计算在 $0  x  L$ 范围内的稳态离子密度剖面 $n_i(x)$ 的闭式解析表达式，用 $x$、$L$、$u_0$ 和 $S_0$ 表示。假设参数采用国际单位制 (SI)：$S_{n,i}$ 的单位为 $\\mathrm{m^{-3}\\ s^{-1}}$，$u_0$ 的单位为 $\\mathrm{m\\ s^{-1}}$，$n_i$ 的单位为 $\\mathrm{m^{-3}}$。给出最终表达式，无需进行数值计算。最终表达式中不要包含单位。",
            "solution": "一维离子连续性方程是离子粒子数的局域守恒，\n$$\n\\partial_t n_i(x,t) + \\partial_x\\!\\big(n_i(x,t)\\,u_i(x,t)\\big) = S_{n,i}(x).\n$$\n在稳态下，$\\partial_t n_i = 0$，因此方程简化为\n$$\n\\frac{d}{dx}\\!\\big(n_i(x)\\,u_i(x)\\big) = S_{n,i}(x).\n$$\n给定 $u_i(x) = u_0 \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$ 和 $S_{n,i}(x) = S_0 \\sin\\!\\left(\\frac{2\\pi x}{L}\\right)$，以及不可渗透的壁，使得法向离子粒子通量在两个边界处均为零：\n$$\nn_i(0)\\,u_i(0) = 0, \\quad n_i(L)\\,u_i(L) = 0.\n$$\n因为 $u_i(0) = u_0 \\sin(0) = 0$ 且 $u_i(L) = u_0 \\sin(\\pi) = 0$，这些边界条件与任何有限的 $n_i(0)$ 和 $n_i(L)$ 都是相符的，但它们强制要求壁上的通量为零。\n\n将稳态连续性方程从 $x=0$ 积分到一个点 $x$：\n$$\n\\int_{0}^{x} \\frac{d}{d\\xi}\\!\\big(n_i(\\xi)\\,u_i(\\xi)\\big)\\,d\\xi = \\int_{0}^{x} S_{n,i}(\\xi)\\,d\\xi,\n$$\n这得到\n$$\nn_i(x)\\,u_i(x) - n_i(0)\\,u_i(0) = \\int_{0}^{x} S_{n,i}(\\xi)\\,d\\xi.\n$$\n利用 $n_i(0)\\,u_i(0) = 0$，\n$$\nn_i(x)\\,u_i(x) = \\int_{0}^{x} S_{n,i}(\\xi)\\,d\\xi,\n$$\n并且对于 $0",
            "answer": "$$\\boxed{\\frac{S_0 L}{2\\pi u_0}\\,\\frac{1 - \\cos\\!\\left(\\dfrac{2\\pi x}{L}\\right)}{\\sin\\!\\left(\\dfrac{\\pi x}{L}\\right)}}$$"
        },
        {
            "introduction": "从粒子平衡过渡到能量平衡，是设计和理解聚变反应堆的关键一步。这个问题模拟了托卡马克中一个更为现实的场景，要求您量化通过热传导和轫致辐射损失的能量。这项练习将理论上的输运方程与实际工程需求（例如计算维持稳态所需的辅助加热功率）联系起来，搭建了理论与应用之间的桥梁。",
            "id": "3958878",
            "problem": "在一个大环径比的托卡马克等离子体中，假设具有轴对称性和圆形磁通量面，其大半径为 $R_{0}$，小半径为 $a$。电子密度分布 $n_{e}(r)$、电子温度分布 $T_{e}(r)$ 和测得的有效热导率 $\\kappa_{e}(r)$ 由以下公式给出\n$$n_{e}(r) = n_{0}\\left[1 - \\left(\\frac{r}{a}\\right)^{2}\\right], \\quad T_{e}(r) = T_{0}\\left[1 - \\left(\\frac{r}{a}\\right)^{2}\\right], \\quad \\kappa_{e}(r) = \\kappa_{0}\\left[1 + \\alpha \\left(\\frac{r}{a}\\right)^{2}\\right], \\quad 0 \\le r \\le a,$$\n其中 $R_{0} = 1.7\\,\\mathrm{m}$，$a = 0.6\\,\\mathrm{m}$，$n_{0} = 8.5 \\times 10^{19}\\,\\mathrm{m}^{-3}$，$T_{0} = 4.0\\,\\mathrm{keV}$，$\\kappa_{0} = 7.5 \\times 10^{19}\\,\\mathrm{W\\,m^{-1}\\,J^{-1}}$，且 $\\alpha = 0.4$。等离子体处于稳态，无整体流动，且压缩功可忽略不计。唯一的能量汇是穿过分界面的径向传导损失和单位体积发射率为\n$$P_{\\mathrm{br}}(r) = C_{b}\\, Z_{\\mathrm{eff}}\\, n_{e}(r)^{2}\\, \\sqrt{T_{e}(r)\\, [\\mathrm{eV}]}$$\n的体积电子轫致辐射，其中 $C_{b} = 1.69 \\times 10^{-38}\\,\\mathrm{W\\,m^{3}\\,eV^{-1/2}}$，$Z_{\\mathrm{eff}} = 1.7$，并且 $T_{e}(r)\\,[\\mathrm{eV}]$ 表示以电子伏特为单位的电子温度。有效热导率通过 $\\mathbf{q}_{e} = - \\kappa_{e}(r)\\, \\nabla T_{e}$ 将传导能量通量与电子温度梯度联系起来，对于此本构关系，$T_{e}$ 必须以焦耳表示，使用 $1\\,\\mathrm{eV} = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$。分界面的热流出等于最外层磁通量面的面积乘以当地的径向热通量，磁通量面面积为 $A(r) = 4\\pi^{2} R_{0} r$。\n\n从能量守恒定律出发，并仅使用所提供的信息，计算维持给定稳态分布所需的总辅助加热功率 $P_{\\mathrm{aux}}$，其值为穿过分界面的传导功率与在整个等离子体体积上积分的轫致辐射之和。将您的答案四舍五入到三位有效数字，并以兆瓦（MW）为单位表示。",
            "solution": "该问题要求计算维持托卡马克等离子体在给定稳态下所需的总辅助加热功率 $P_{\\mathrm{aux}}$。根据稳态下的能量守恒原理，总输入功率必须与总功率损失相平衡。问题指出，辅助加热是唯一的功率源，损失包括等离子体边界的传导热损失和体积轫致辐射损失。\n因此，总辅助功率由这两个损失通道之和给出：\n$$P_{\\mathrm{aux}} = P_{\\mathrm{cond}}(a) + P_{\\mathrm{rad}}$$\n其中 $P_{\\mathrm{cond}}(a)$ 是在分界面（小半径 $r=a$）处流出等离子体的总传导功率，$P_{\\mathrm{rad}}$ 是在整个等离子体体积上积分的韧致辐射所损失的总功率。\n\n我们将分别计算这两个项。\n\n1.  总辐射功率 ($P_{\\mathrm{rad}}$)\n\n总辐射功率是轫致辐射的体积功率密度 $P_{\\mathrm{br}}(r)$ 在等离子体体积 $V$ 上的积分。\n$$P_{\\mathrm{rad}} = \\int_V P_{\\mathrm{br}}(r) \\, dV$$\n对于具有圆形磁通量面的大环径比托卡马克，小半径为 $r$、厚度为 $dr$ 的薄环状壳层的体积元 $dV$ 由磁通量面的表面积 $A(r)$ 乘以厚度 $dr$ 给出。问题提供了 $A(r) = 4\\pi^2 R_0 r$。因此，$dV = 4\\pi^2 R_0 r \\, dr$。\n总辐射功率的积分变为：\n$$P_{\\mathrm{rad}} = \\int_{0}^{a} P_{\\mathrm{br}}(r) (4\\pi^2 R_0 r) \\, dr$$\n发射率由 $P_{\\mathrm{br}}(r) = C_{b}\\, Z_{\\mathrm{eff}}\\, n_{e}(r)^{2}\\, \\sqrt{T_{e}(r)\\, [\\mathrm{eV}]}$ 给出。我们已知电子密度 $n_e(r)$ 和温度 $T_e(r)$ 的分布：\n$$n_{e}(r) = n_{0}\\left[1 - \\left(\\frac{r}{a}\\right)^{2}\\right]$$\n$$T_{e}(r) = T_{0}\\left[1 - \\left(\\frac{r}{a}\\right)^{2}\\right], \\quad \\text{其中 } T_0 = 4.0 \\, \\mathrm{keV}$$\n对于轫致辐射公式，温度必须以电子伏特（eV）为单位。我们将 $T_0$ 从 keV 转换为 eV：$T_0 = 4.0 \\, \\mathrm{keV} = 4000 \\, \\mathrm{eV}$。\n因此，以 eV 为单位的温度分布为：\n$$T_{e}(r)\\,[\\mathrm{eV}] = 4000 \\left[1 - \\left(\\frac{r}{a}\\right)^{2}\\right] \\, \\mathrm{eV}$$\n将 $n_e(r)$ 和 $T_e(r) [\\mathrm{eV}]$ 的分布代入发射率表达式：\n$$P_{\\mathrm{br}}(r) = C_{b} Z_{\\mathrm{eff}} \\left( n_{0}\\left[1 - \\frac{r^2}{a^2}\\right] \\right)^2 \\sqrt{4000 \\left[1 - \\frac{r^2}{a^2}\\right]}$$\n$$P_{\\mathrm{br}}(r) = C_{b} Z_{\\mathrm{eff}} n_0^2 \\sqrt{4000} \\left(1 - \\frac{r^2}{a^2}\\right)^{2 + 1/2} = C_{b} Z_{\\mathrm{eff}} n_0^2 \\sqrt{4000} \\left(1 - \\frac{r^2}{a^2}\\right)^{5/2}$$\n现在，我们对此表达式进行积分以求得 $P_{\\mathrm{rad}}$：\n$$P_{\\mathrm{rad}} = \\int_{0}^{a} \\left[ C_{b} Z_{\\mathrm{eff}} n_0^2 \\sqrt{4000} \\left(1 - \\frac{r^2}{a^2}\\right)^{5/2} \\right] (4\\pi^2 R_0 r) \\, dr$$\n$$P_{\\mathrm{rad}} = 4\\pi^2 R_0 C_{b} Z_{\\mathrm{eff}} n_0^2 \\sqrt{4000} \\int_{0}^{a} r \\left(1 - \\frac{r^2}{a^2}\\right)^{5/2} \\, dr$$\n为求解此积分，我们使用换元法，令 $u = 1 - r^2/a^2$。这得到 $du = -2r/a^2 \\, dr$，所以 $r \\, dr = -a^2/2 \\, du$。积分限从 $r=0 \\to u=1$ 和 $r=a \\to u=0$ 变化。\n$$\\int_{0}^{a} r \\left(1 - \\frac{r^2}{a^2}\\right)^{5/2} \\, dr = \\int_{1}^{0} u^{5/2} \\left(-\\frac{a^2}{2}\\right) \\, du = \\frac{a^2}{2} \\int_{0}^{1} u^{5/2} \\, du = \\frac{a^2}{2} \\left[ \\frac{u^{7/2}}{7/2} \\right]_{0}^{1} = \\frac{a^2}{2} \\left(\\frac{2}{7}\\right) = \\frac{a^2}{7}$$\n将此结果代回 $P_{\\mathrm{rad}}$ 的表达式中：\n$$P_{\\mathrm{rad}} = 4\\pi^2 R_0 C_{b} Z_{\\mathrm{eff}} n_0^2 \\sqrt{4000} \\left( \\frac{a^2}{7} \\right) = \\frac{4\\pi^2 a^2 R_0}{7} C_{b} Z_{\\mathrm{eff}} n_0^2 \\sqrt{4000}$$\n\n2.  总传导功率 ($P_{\\mathrm{cond}}(a)$)\n\n分界面处的传导功率损失是在 $r=a$ 处的磁通量面面积与该位置的径向热通量 $q_e(r)$ 大小的乘积。\n$$P_{\\mathrm{cond}}(a) = A(a) \\, q_e(a)$$\n径向热通量由傅里叶定律给出：$q_e(r) = - \\kappa_e(r) \\frac{dT_e}{dr}$。在此关系式中，温度 $T_e$ 必须以焦耳为单位。令 $e_c = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}$ 为基本电荷。\n以焦耳为单位的中心温度是 $T_{0,J} = 4.0\\,\\mathrm{keV} \\times \\frac{1000\\,\\mathrm{eV}}{1\\,\\mathrm{keV}} \\times e_c = 4000 e_c \\, \\mathrm{J}$。\n以焦耳为单位的温度分布是：\n$$T_{e}(r) = T_{0,J} \\left[1 - \\left(\\frac{r}{a}\\right)^{2}\\right]$$\n温度梯度为：\n$$\\frac{dT_e}{dr} = \\frac{d}{dr} \\left( T_{0,J} \\left[1 - \\frac{r^2}{a^2}\\right] \\right) = -T_{0,J} \\frac{2r}{a^2}$$\n在边界 $r=a$ 处，梯度为：\n$$\\left. \\frac{dT_e}{dr} \\right|_{r=a} = -T_{0,J} \\frac{2a}{a^2} = -\\frac{2T_{0,J}}{a}$$\n有效热导率分布为 $\\kappa_e(r) = \\kappa_0 \\left[1 + \\alpha (r/a)^2 \\right]$。在 $r=a$ 处：\n$$\\kappa_e(a) = \\kappa_0(1+\\alpha)$$\n在 $r=a$ 处的表面积为 $A(a) = 4\\pi^2 R_0 a$。\n现在我们组合出 $P_{\\mathrm{cond}}(a)$ 的表达式：\n$$P_{\\mathrm{cond}}(a) = A(a) \\left( -\\kappa_e(a) \\left. \\frac{dT_e}{dr} \\right|_{r=a} \\right) = (4\\pi^2 R_0 a) \\left( -[\\kappa_0(1+\\alpha)] \\left[-\\frac{2T_{0,J}}{a}\\right] \\right)$$\n负号相互抵消，分子和分母中的小半径 $a$ 也相互抵消：\n$$P_{\\mathrm{cond}}(a) = 8\\pi^2 R_0 \\kappa_0 (1+\\alpha) T_{0,J}$$\n\n3.  数值计算\n\n现在我们将给定的数值代入推导出的 $P_{\\mathrm{rad}}$ 和 $P_{\\mathrm{cond}}(a)$ 的表达式中。\n给定值：\n$R_0 = 1.7\\,\\mathrm{m}$，$a = 0.6\\,\\mathrm{m}$，$n_0 = 8.5 \\times 10^{19}\\,\\mathrm{m}^{-3}$，$T_0 = 4.0\\,\\mathrm{keV}$，$\\kappa_0 = 7.5 \\times 10^{19}\\,\\mathrm{W\\,m^{-1}\\,J^{-1}}$，$\\alpha = 0.4$，$C_b = 1.69 \\times 10^{-38}\\,\\mathrm{W\\,m^{3}\\,eV^{-1/2}}$，$Z_{\\mathrm{eff}} = 1.7$，$e_c = 1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}$。\n\n$P_{\\mathrm{rad}}$ 的计算：\n$$P_{\\mathrm{rad}} = \\frac{4\\pi^2 (0.6)^2 (1.7)}{7} (1.69 \\times 10^{-38}) (1.7) (8.5 \\times 10^{19})^2 \\sqrt{4000}$$\n$$P_{\\mathrm{rad}} \\approx \\frac{4(9.8696)(0.36)(1.7)}{7} (1.69 \\times 10^{-38}) (1.7) (7.225 \\times 10^{39}) (63.246)$$\n$$P_{\\mathrm{rad}} \\approx (3.447) \\times (2.873 \\times 10^{-38}) \\times (7.225 \\times 10^{39}) \\times (63.246)$$\n$$P_{\\mathrm{rad}} \\approx (3.447) \\times (20.755 \\times 10^1) \\times (63.246) \\approx 45293 \\, \\mathrm{W} = 0.045293 \\, \\mathrm{MW}$$\n\n$P_{\\mathrm{cond}}(a)$ 的计算：\n$$T_{0,J} = 4000 \\times (1.602176634 \\times 10^{-19}) = 6.408706536 \\times 10^{-16} \\, \\mathrm{J}$$\n$$P_{\\mathrm{cond}}(a) = 8\\pi^2 (1.7) (7.5 \\times 10^{19}) (1+0.4) (6.408706536 \\times 10^{-16})$$\n$$P_{\\mathrm{cond}}(a) = 8\\pi^2 (1.7) (7.5 \\times 10^{19}) (1.4) (6.408706536 \\times 10^{-16})$$\n$$P_{\\mathrm{cond}}(a) \\approx 8(9.8696)(1.7)(7.5 \\times 10^{19})(1.4)(6.4087 \\times 10^{-16})$$\n$$P_{\\mathrm{cond}}(a) \\approx 9032515 \\, \\mathrm{W} = 9.032515 \\, \\mathrm{MW}$$\n\n总辅助功率：\n$$P_{\\mathrm{aux}} = P_{\\mathrm{rad}} + P_{\\mathrm{cond}}(a) \\approx 0.045293 \\, \\mathrm{MW} + 9.032515 \\, \\mathrm{MW} = 9.077808 \\, \\mathrm{MW}$$\n问题要求将答案四舍五入到三位有效数字。\n$$P_{\\mathrm{aux}} \\approx 9.08 \\, \\mathrm{MW}$$\n所需的辅助加热功率为 $9.08$ 兆瓦。",
            "answer": "$$\\boxed{9.08}$$"
        },
        {
            "introduction": "许多重要的等离子体，如聚变装置和空间环境中的等离子体，是无碰撞的，其行为不能用简单的各向同性流体模型完全描述。本练习深入探讨了绝热不变量的后果，这导致了平行和垂直于磁场方向的压力遵循不同的演化规律。通过从第一性原理推导并以计算方式实现Chew-Goldberger-Low (CGL) 方程，您将深刻理解压力各向异性这一关键现象。",
            "id": "3958905",
            "problem": "一个磁化的、无碰撞的、回旋各向同性的等离子体团，从一个初始状态经历缓慢的磁镜压缩到一个最终状态，其过程远低于绝热不变量失效的特征频率，并忽略热通量。仅从适用于弗拉索夫方程矩层次的第一性原理、粒子数守恒以及各向同性参考系的准理想气体热力学出发，推导沿流体元的平行和垂直于磁场方向的压强的演化定律。然后，构建一个算法，在这些假设下计算最终的平行压强和垂直压强，并将它们与单原子理想气体的标量各向同性绝热响应进行比较。\n\n您的推导必须从以下几点开始：\n- 无碰撞的弗拉索夫方程及其低阶流体矩，包括连续性方程和带有回旋各向同性压强张量的动量方程。\n- 保证前两个单粒子导心意义下的绝热不变量有效性的回旋各向同性假设和尺度分离假设，且不援引任何预先给定的压强演化公式。\n- 绝热指数为 $\\gamma = \\tfrac{5}{3}$ 的各向同性理想气体的热力学绝热关系。\n\n推导出这些演化定律后，实现一个程序，为每个测试案例计算：\n- 最终平行压强 $p_{\\parallel,1}$，单位为 $\\mathrm{Pa}$。\n- 最终垂直压强 $p_{\\perp,1}$，单位为 $\\mathrm{Pa}$。\n- 最终各向同性绝热压强 $p_{\\mathrm{iso},1}$，单位为 $\\mathrm{Pa}$，通过从其初始标量值进行绝热演化得到。\n- 比率 $r_{\\parallel} = p_{\\parallel,1} / p_{\\mathrm{iso},1}$ 和 $r_{\\perp} = p_{\\perp,1} / p_{\\mathrm{iso},1}$（无量纲）。\n\n使用以下定义：\n- 初始标量压强为 $p_{\\mathrm{iso},0} = \\tfrac{1}{3}\\left(p_{\\parallel,0} + 2 p_{\\perp,0}\\right)$，单位为 $\\mathrm{Pa}$。\n- 各向同性绝热演化由 $p_{\\mathrm{iso},1} = p_{\\mathrm{iso},0}\\left(n_1/n_0\\right)^{\\gamma}$ 给出，其中 $\\gamma = \\tfrac{5}{3}$。\n- 所有压强必须以 $\\mathrm{Pa}$ 报告；磁场强度以 $\\mathrm{T}$ 报告；数密度以 $\\mathrm{m^{-3}}$ 报告。\n\n您的程序必须评估以下五个案例的测试套件。对于每个案例，输入是初始和最终状态 $\\left(n_0, B_0, p_{\\parallel,0}, p_{\\perp,0}, n_1, B_1\\right)$：\n- 案例 A（密度增加的一般磁镜压缩）：$n_0 = 1.0\\times 10^{19}\\ \\mathrm{m^{-3}}$，$B_0 = 1.5\\ \\mathrm{T}$，$p_{\\parallel,0} = 1.2\\times 10^{4}\\ \\mathrm{Pa}$，$p_{\\perp,0} = 8.0\\times 10^{3}\\ \\mathrm{Pa}$，$n_1 = 2.0\\times 10^{19}\\ \\mathrm{m^{-3}}$，$B_1 = 3.0\\ \\mathrm{T}$。\n- 案例 B（各向同性初始状态，固定密度下的强磁场压缩）：$n_0 = 8.0\\times 10^{18}\\ \\mathrm{m^{-3}}$，$B_0 = 2.0\\ \\mathrm{T}$，$p_{\\parallel,0} = 1.0\\times 10^{4}\\ \\mathrm{Pa}$，$p_{\\perp,0} = 1.0\\times 10^{4}\\ \\mathrm{Pa}$，$n_1 = 8.0\\times 10^{18}\\ \\mathrm{m^{-3}}$，$B_1 = 8.0\\ \\mathrm{T}$。\n- 案例 C（密度增加，磁场减小）：$n_0 = 2.0\\times 10^{19}\\ \\mathrm{m^{-3}}$，$B_0 = 5.0\\ \\mathrm{T}$，$p_{\\parallel,0} = 1.5\\times 10^{4}\\ \\mathrm{Pa}$，$p_{\\perp,0} = 2.0\\times 10^{4}\\ \\mathrm{Pa}$，$n_1 = 3.0\\times 10^{19}\\ \\mathrm{m^{-3}}$，$B_1 = 2.5\\ \\mathrm{T}$。\n- 案例 D（极端的同步压缩）：$n_0 = 5.0\\times 10^{19}\\ \\mathrm{m^{-3}}$，$B_0 = 1.0\\ \\mathrm{T}$，$p_{\\parallel,0} = 1.0\\times 10^{4}\\ \\mathrm{Pa}$，$p_{\\perp,0} = 1.0\\times 10^{4}\\ \\mathrm{Pa}$，$n_1 = 5.0\\times 10^{20}\\ \\mathrm{m^{-3}}$，$B_1 = 10.0\\ \\mathrm{T}$。\n- 案例 E（无变化基准）：$n_0 = 1.1\\times 10^{19}\\ \\mathrm{m^{-3}}$，$B_0 = 3.2\\ \\mathrm{T}$，$p_{\\parallel,0} = 9.0\\times 10^{3}\\ \\mathrm{Pa}$，$p_{\\perp,0} = 1.4\\times 10^{4}\\ \\mathrm{Pa}$，$n_1 = 1.1\\times 10^{19}\\ \\mathrm{m^{-3}}$，$B_1 = 3.2\\ \\mathrm{T}$。\n\n最终输出规格：\n- 对于每个测试案例，输出列表 $\\left[p_{\\parallel,1},\\ p_{\\perp,1},\\ p_{\\mathrm{iso},1},\\ r_{\\parallel},\\ r_{\\perp}\\right]$，其中压强单位为 $\\mathrm{Pa}$，比率为无量纲。\n- 您的程序应生成单行输出，其中包含所有案例的结果，形式为这些逐案例列表的列表，每个数值条目四舍五入到六位有效数字，例如：$[[\\dots],[\\dots],\\dots]$。",
            "solution": "所提出的问题是有效的，因为它科学地植根于等离子体物理学原理，是适定的、客观的且内部一致的。我们将进行完整的推导和求解。\n\n核心任务是为一个经历缓慢压缩的无碰撞、回旋各向同性等离子体推导平行压强 $p_{\\parallel}$ 和垂直压强 $p_{\\perp}$ 的演化定律。该推导必须源于动力学理论和绝热不变量的基本原理，而不是先验地假设最终的状态方程。\n\n一个无碰撞的等离子体由关于粒子分布函数 $f(\\mathbf{r}, \\mathbf{v}, t)$ 的弗拉索夫方程描述：\n$$\n\\frac{\\partial f}{\\partial t} + \\mathbf{v} \\cdot \\nabla f + \\frac{q}{m}(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot \\nabla_{\\mathbf{v}} f = 0\n$$\n其中 $q$ 是粒子电荷，$m$ 是质量，$\\mathbf{E}$ 是电场，$\\mathbf{B}$ 是磁场。宏观流体量是分布函数的速度矩。数密度 $n$ 和压强张量 $\\mathbf{P}$ 定义为：\n$$\nn = \\int f \\, d^3v\n$$\n$$\n\\mathbf{P} = m \\int (\\mathbf{v}-\\mathbf{u})(\\mathbf{v}-\\mathbf{u}) f \\, d^3v\n$$\n其中 $\\mathbf{u}$ 是流体整体速度。对于回旋各向同性等离子体，其中粒子运动围绕磁场线对称，压强张量得以简化。在与局部磁场 $\\mathbf{B} = B\\hat{\\mathbf{b}}$ 对齐的坐标系中，压强张量是对角化的：\n$$\n\\mathbf{P} = p_{\\perp}(\\mathbf{I} - \\hat{\\mathbf{b}}\\hat{\\mathbf{b}}) + p_{\\parallel}\\hat{\\mathbf{b}}\\hat{\\mathbf{b}}\n$$\n这里，$p_{\\parallel}$ 和 $p_{\\perp}$ 分别代表与平行和垂直于磁场的热运动相关的压强。它们在随流体运动的参考系中定义为：\n$$\np_{\\parallel} = m \\int v_{\\parallel}^2 f \\, d^3v \\quad \\text{和} \\quad p_{\\perp} = \\frac{m}{2} \\int v_{\\perp}^2 f \\, d^3v\n$$\n其中 $v_{\\parallel}$ 和 $v_{\\perp}$ 是平行和垂直于 $\\mathbf{B}$ 的粒子速度分量。\n\n问题指出压缩是“缓慢的”，这意味着粒子所经历的磁场变化的特征时间尺度远大于粒子的回旋周期和弹跳周期。这确保了前两个绝热不变量的守恒。\n\n**垂直压强演化的推导**\n\n第一绝热不变量是与带电粒子回旋运动相关的磁矩 $\\mu$：\n$$\n\\mu = \\frac{m v_{\\perp}^2}{2B}\n$$\n$\\mu$ 的守恒意味着对于任何单个粒子，$\\frac{d\\mu}{dt} = 0$。对于一个流体元，其组成粒子间的 $\\mu$ 值分布同样是守恒的。因此，流体元的平均磁矩 $\\langle\\mu\\rangle$ 是一个常数。\n\n我们可以用平均垂直动能来表示垂直压强 $p_{\\perp}$：\n$$\np_{\\perp} = n \\left\\langle \\frac{m v_{\\perp}^2}{2} \\right\\rangle\n$$\n使用 $\\mu$ 的定义，这变为：\n$$\np_{\\perp} = n \\left\\langle \\mu B \\right\\rangle = n B \\langle\\mu\\rangle\n$$\n由于给定流体元在等离子体中移动时 $\\langle\\mu\\rangle$ 是恒定的，我们得到守恒定律：\n$$\n\\frac{p_{\\perp}}{nB} = \\langle\\mu\\rangle = \\text{constant}\n$$\n对于一个将等离子体从初始状态 ($n_0, B_0, p_{\\perp,0}$) 带到最终状态 ($n_1, B_1, p_{\\perp,1}$) 的过程，这意味着：\n$$\n\\frac{p_{\\perp,1}}{n_1 B_1} = \\frac{p_{\\perp,0}}{n_0 B_0} \\implies p_{\\perp,1} = p_{\\perp,0} \\left(\\frac{n_1}{n_0}\\right) \\left(\\frac{B_1}{B_0}\\right)\n$$\n这是垂直压强的演化定律，通常被称为第一 CGL (Chew-Goldberger-Low) 方程。\n\n**平行压强演化的推导**\n\n第二绝热不变量是纵向不变量 $J$：\n$$\nJ = \\oint v_{\\parallel} \\, dl = \\text{constant}\n$$\n其中积分是沿着粒子在两个磁镜点之间的弹跳路径进行的。$J$ 的守恒使我们能够推导出 $p_{\\parallel}$ 的演化。为了将微观不变量 $J$ 与宏观流体量联系起来，我们考虑流体元的平均性质。让我们近似地认为 $J \\approx \\langle |v_{\\parallel}| \\rangle L$，其中 $L$ 是流体元所占据的磁力线段的特征长度。\n\n特征平行热速度可以与平行压强相关联：$p_{\\parallel} = n m \\langle v_{\\parallel}^2 \\rangle$。假设平行速度呈类麦克斯韦分布，则 $\\langle |v_{\\parallel}| \\rangle \\propto \\sqrt{\\langle v_{\\parallel}^2 \\rangle}$。因此，\n$$\n\\langle |v_{\\parallel}| \\rangle \\propto \\sqrt{\\frac{p_{\\parallel}}{n m}} \\propto \\sqrt{\\frac{p_{\\parallel}}{n}}\n$$\n流体元的长度 $L$ 受到两个守恒定律的约束。首先，流体元中的粒子数是恒定的：$N = n V = \\text{constant}$，其中 $V$ 是元的体积。其次，对于一个磁通管，磁通量是恒定的：$\\Phi = B A = \\text{constant}$，其中 $A$ 是横截面积。流体元的体积是 $V = A L$。将 $A \\propto 1/B$ 代入粒子数守恒方程，得到 $n (1/B) L \\approx \\text{constant}$。这意味着流体元的长度按以下方式缩放：\n$$\nL \\propto \\frac{B}{n}\n$$\n现在，我们将 $\\langle|v_{\\parallel}|\\rangle$ 和 $L$ 的这些缩放关系代入第二不变量 $J$ 的表达式中：\n$$\nJ \\propto \\sqrt{\\frac{p_{\\parallel}}{n}} \\left(\\frac{B}{n}\\right) = \\frac{\\sqrt{p_{\\parallel}} B}{n^{3/2}} = \\text{constant}\n$$\n将此表达式平方，我们得到平行压强的守恒定律：\n$$\n\\frac{p_{\\parallel} B^2}{n^3} = \\text{constant}\n$$\n对于一个从状态 0 到状态 1 的过程，这给出了演化定律：\n$$\n\\frac{p_{\\parallel,1} B_1^2}{n_1^3} = \\frac{p_{\\parallel,0} B_0^2}{n_0^3} \\implies p_{\\parallel,1} = p_{\\parallel,0} \\left(\\frac{n_1}{n_0}\\right)^3 \\left(\\frac{B_0}{B_1}\\right)^2\n$$\n这是第二 CGL 方程。这两个定律共同构成了双绝热理论。\n\n**各向同性绝热比较**\n\n为了比较，我们将等离子体视为一个各向同性的、单原子的理想气体。标量压强是压强张量对角分量的平均值：\n$$\np_{\\mathrm{iso}} = \\frac{1}{3} \\operatorname{Tr}(\\mathbf{P}) = \\frac{1}{3} (p_{\\parallel} + 2p_{\\perp})\n$$\n对于单原子气体中的绝热过程，状态方程为 $p V^{\\gamma} = \\text{constant}$，绝热指数 $\\gamma = 5/3$（对应于 3 个自由度）。由于数密度 $n \\propto 1/V$，这等价于：\n$$\n\\frac{p}{n^{\\gamma}} = \\text{constant}\n$$\n因此，如果等离子体的行为像一个各向同性理想气体，其最终压强 $p_{\\mathrm{iso},1}$ 将是：\n$$\np_{\\mathrm{iso},1} = p_{\\mathrm{iso},0} \\left(\\frac{n_1}{n_0}\\right)^{\\gamma}\n$$\n其中初始各向同性压强为 $p_{\\mathrm{iso},0} = \\frac{1}{3} (p_{\\parallel,0} + 2p_{\\perp,0})$。\n\n**计算算法**\n\n给定初始状态 $(n_0, B_0, p_{\\parallel,0}, p_{\\perp,0})$ 和最终状态参数 $(n_1, B_1)$，计算最终压强和比率的算法如下：\n1.  使用推导出的定律计算最终平行压强 $p_{\\parallel,1}$：$p_{\\parallel,1} = p_{\\parallel,0} (n_1/n_0)^3 (B_0/B_1)^2$。\n2.  使用其推导出的定律计算最终垂直压强 $p_{\\perp,1}$：$p_{\\perp,1} = p_{\\perp,0} (n_1/n_0) (B_1/B_0)$。\n3.  计算初始有效各向同性压强：$p_{\\mathrm{iso},0} = (p_{\\parallel,0} + 2p_{\\perp,0}) / 3$。\n4.  计算参考情况下的最终各向同性压强 $p_{\\mathrm{iso},1}$：$p_{\\mathrm{iso},1} = p_{\\mathrm{iso},0} (n_1/n_0)^{5/3}$。\n5.  计算比率 $r_{\\parallel} = p_{\\parallel,1} / p_{\\mathrm{iso},1}$ 和 $r_{\\perp} = p_{\\perp,1} / p_{\\mathrm{iso},1}$，以比较各向异性响应与各向同性响应。\n\n此过程将为每个提供的测试案例实施。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Derives and applies double-adiabatic laws for plasma compression.\n\n    This function implements the derived evolution laws for parallel and perpendicular\n    pressure in a collisionless, gyrotropic plasma undergoing slow compression.\n    It calculates the final pressures for several test cases and compares them to\n    the evolution of an equivalent isotropic ideal gas.\n    \"\"\"\n\n    # Test cases defined as (n0, B0, p_par0, p_perp0, n1, B1) tuples.\n    # Units: n in m^-3, B in T, p in Pa.\n    test_cases = [\n        # Case A\n        (1.0e19, 1.5, 1.2e4, 8.0e3, 2.0e19, 3.0),\n        # Case B\n        (8.0e18, 2.0, 1.0e4, 1.0e4, 8.0e18, 8.0),\n        # Case C\n        (2.0e19, 5.0, 1.5e4, 2.0e4, 3.0e19, 2.5),\n        # Case D\n        (5.0e19, 1.0, 1.0e4, 1.0e4, 5.0e20, 10.0),\n        # Case E\n        (1.1e19, 3.2, 9.0e3, 1.4e4, 1.1e19, 3.2),\n    ]\n\n    def round_to_sig_figs(x, sig_figs=6):\n        \"\"\"\n        Rounds a number to a specified number of significant figures.\n        \"\"\"\n        if x == 0:\n            return 0.0\n        return round(x, sig_figs - int(math.floor(math.log10(abs(x)))) - 1)\n\n    all_results = []\n    gamma = 5.0 / 3.0\n\n    for case in test_cases:\n        n0, B0, p_par0, p_perp0, n1, B1 = case\n\n        # Calculate density and magnetic field ratios\n        if n0 == 0: continue # Avoid division by zero\n        Rn = n1 / n0\n        \n        if B0 == 0: continue # Avoid division by zero\n        RB = B1 / B0\n        \n        # 1. Calculate final parallel pressure (CGL law 1)\n        # p_par1 = p_par0 * (n1/n0)^3 * (B0/B1)^2\n        p_par1 = p_par0 * (Rn**3) * ((1.0/RB)**2 if RB != 0 else np.inf)\n\n        # 2. Calculate final perpendicular pressure (CGL law 2)\n        # p_perp1 = p_perp0 * (n1/n0) * (B1/B0)\n        p_perp1 = p_perp0 * Rn * RB\n\n        # 3. Calculate initial isotropic pressure\n        p_iso0 = (p_par0 + 2.0 * p_perp0) / 3.0\n\n        # 4. Calculate final isotropic pressure (ideal gas adiabatic law)\n        # p_iso1 = p_iso0 * (n1/n0)^gamma\n        p_iso1 = p_iso0 * (Rn**gamma)\n\n        # 5. Compute ratios\n        if p_iso1 == 0:\n            # Handle case where isotropic pressure is zero to avoid division error\n            r_par = np.inf if p_par1 != 0 else 0\n            r_perp = np.inf if p_perp1 != 0 else 0\n        else:\n            r_par = p_par1 / p_iso1\n            r_perp = p_perp1 / p_iso1\n\n        # Round all results to six significant figures\n        case_results = [\n            round_to_sig_figs(p_par1),\n            round_to_sig_figs(p_perp1),\n            round_to_sig_figs(p_iso1),\n            round_to_sig_figs(r_par),\n            round_to_sig_figs(r_perp),\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as a list of lists.\n    # Convert each inner list to a string representation without spaces.\n    inner_lists_as_strings = []\n    for res_list in all_results:\n        # Map each float to its string representation\n        # str() on a rounded float will produce the desired output format\n        str_values = [str(v) for v in res_list]\n        inner_lists_as_strings.append(f\"[{','.join(str_values)}]\")\n    \n    final_output_string = f\"[{','.join(inner_lists_as_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}