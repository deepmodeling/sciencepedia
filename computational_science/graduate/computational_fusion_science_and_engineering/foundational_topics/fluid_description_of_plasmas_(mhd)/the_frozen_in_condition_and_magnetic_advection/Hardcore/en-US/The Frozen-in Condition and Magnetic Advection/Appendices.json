{
    "hands_on_practices": [
        {
            "introduction": "The statement that magnetic fields are \"frozen-in\" to hot, ionized plasmas is a cornerstone of magnetohydrodynamics (MHD). This practice provides a quantitative basis for this important approximation by guiding you through a fundamental scaling analysis. You will derive the magnetic induction equation from first principles and estimate the relative importance of magnetic field advection by the plasma flow versus its diffusion due to electrical resistivity . By calculating the magnetic Reynolds number, $R_m$, for parameters typical of a fusion tokamak, you will develop a concrete appreciation for the conditions under which the ideal, frozen-in picture is overwhelmingly valid.",
            "id": "4053022",
            "problem": "Consider a single-fluid Resistive Magnetohydrodynamics (MHD) model of a deuterium plasma region representative of a tokamak core. You are to assess whether the magnetic field evolution is dominated by advection (frozen-in behavior) or diffusion. Use as your fundamental base: Maxwell–Faraday’s law $\\,\\partial \\mathbf{B}/\\partial t = -\\nabla \\times \\mathbf{E}\\,$, Ampère’s law without displacement current $\\,\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}\\,$, quasineutrality $\\,n_e \\approx n_i\\,$, and the simplest form of the generalized Ohm’s law $\\,\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta_{\\mathrm{e}} \\mathbf{J}\\,$, where $\\,\\eta_{\\mathrm{e}}\\,$ is the scalar electric resistivity. Assume a characteristic magnetic-field magnitude $\\,B_0\\,$ varies over a typical macroscopic length scale $\\,L\\,$, and a bulk plasma flow of magnitude $\\,v\\,$ advects the field. Take the magnetic permeability of free space $\\,\\mu_0 = 4\\pi \\times 10^{-7}\\,$ H/m.\n\nFor a parameter set typical of computational fusion science simulations, adopt:\n- Electron temperature $\\,T_e = 5.0 \\times 10^{3}\\,$ eV,\n- Effective charge state $\\,Z = 1\\,$,\n- Coulomb logarithm $\\,\\ln \\Lambda = 17\\,$,\n- Magnetic field magnitude $\\,B_0 = 3.0\\,$ T,\n- Flow speed $\\,v = 3.0 \\times 10^{4}\\,$ m/s,\n- Macroscopic scale $\\,L = 0.30\\,$ m.\n\nUse the classical Spitzer resistivity (a well-tested collisional transport result) $\\,\\eta_{\\mathrm{e}} \\approx 5.2 \\times 10^{-5} \\, Z \\, \\ln \\Lambda \\, T_e^{-3/2}\\,$ in units of $\\,$\\Omega\\cdot\\mathrm{m}$\\,$ with $\\,T_e\\,$ in eV, and define the magnetic diffusivity $\\,\\eta_{\\mathrm{m}} \\equiv \\eta_{\\mathrm{e}}/\\mu_0\\,$.\n\nStarting strictly from the stated fundamental laws, derive scale estimates for the magnitudes of the two terms that appear in the magnetic induction equation—an advection term and a diffusion term—and evaluate their magnitudes to determine which process dominates for the given parameters. Your final answer must be the magnetic Reynolds number $\\,R_{\\mathrm{m}}\\,$, defined as the ratio of the advection-term magnitude to the diffusion-term magnitude for the induction equation in this model. Round your final $\\,R_{\\mathrm{m}}\\,$ to three significant figures and express it as a unitless quantity. In your working, report all intermediate physical quantities in SI units.",
            "solution": "The problem requires the derivation of the magnetic induction equation from fundamental laws, a scaling analysis to compare the advection and diffusion of the magnetic field, and the calculation of the magnetic Reynolds number, $R_{\\mathrm{m}}$, for a set of parameters typical of a tokamak core plasma.\n\nFirst, we derive the magnetic induction equation. The starting point is Maxwell-Faraday's law of induction:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}\n$$\nThe problem provides the simplest form of the generalized Ohm's law for a plasma, which relates the electric field $\\mathbf{E}$ to the plasma flow velocity $\\mathbf{v}$, magnetic field $\\mathbf{B}$, and current density $\\mathbf{J}$:\n$$\n\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta_{\\mathrm{e}} \\mathbf{J}\n$$\nwhere $\\eta_{\\mathrm{e}}$ is the scalar electrical resistivity. We rearrange this to express $\\mathbf{E}$ in terms of the other quantities:\n$$\n\\mathbf{E} = \\eta_{\\mathrm{e}} \\mathbf{J} - \\mathbf{v} \\times \\mathbf{B}\n$$\nSubstituting this expression for $\\mathbf{E}$ into Faraday's law yields:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times (\\eta_{\\mathrm{e}} \\mathbf{J} - \\mathbf{v} \\times \\mathbf{B}) = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) - \\nabla \\times (\\eta_{\\mathrm{e}} \\mathbf{J})\n$$\nNext, we use Ampère's law, neglecting the displacement current as specified, to replace the current density $\\mathbf{J}$:\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} \\implies \\mathbf{J} = \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B}\n$$\nSubstituting this into the evolving induction equation gives:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) - \\nabla \\times \\left( \\frac{\\eta_{\\mathrm{e}}}{\\mu_0} \\nabla \\times \\mathbf{B} \\right)\n$$\nThe problem defines the magnetic diffusivity as $\\eta_{\\mathrm{m}} \\equiv \\eta_{\\mathrm{e}}/\\mu_0$. For the purpose of this scaling analysis, the resistivity $\\eta_{\\mathrm{e}}$, and thus the diffusivity $\\eta_{\\mathrm{m}}$, are treated as spatially constant, determined by the given characteristic plasma parameters. The equation becomes:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) - \\eta_{\\mathrm{m}} \\nabla \\times (\\nabla \\times \\mathbf{B})\n$$\nWe apply the vector calculus identity $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$ to the second term on the right-hand side. From Maxwell's equations (specifically Gauss's law for magnetism), we have $\\nabla \\cdot \\mathbf{B} = 0$. Therefore, the vector identity simplifies to $\\nabla \\times (\\nabla \\times \\mathbf{B}) = -\\nabla^2 \\mathbf{B}$.\nSubstituting this result, we obtain the final form of the magnetic induction equation:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\underbrace{\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})}_{\\text{Advection}} + \\underbrace{\\eta_{\\mathrm{m}} \\nabla^2 \\mathbf{B}}_{\\text{Diffusion}}\n$$\nThe first term on the right-hand side, $\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})$, describes the advection or convection of the magnetic field with the fluid flow. The second term, $\\eta_{\\mathrm{m}} \\nabla^2 \\mathbf{B}$, describes the resistive diffusion of the magnetic field.\n\nNext, we perform a scaling analysis to estimate the magnitudes of these two terms. We use the characteristic scales provided: flow speed $|\\mathbf{v}| \\sim v$, magnetic field magnitude $|\\mathbf{B}| \\sim B_0$, and the gradient operator for spatial variations over a length scale $L$, $|\\nabla| \\sim 1/L$.\n\nThe magnitude of the advection term is estimated as:\n$$\n|\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})| \\sim \\frac{1}{L} |\\mathbf{v} \\times \\mathbf{B}| \\sim \\frac{v B_0}{L}\n$$\nThe magnitude of the diffusion term is estimated as:\n$$\n|\\eta_{\\mathrm{m}} \\nabla^2 \\mathbf{B}| \\sim \\eta_{\\mathrm{m}} |\\nabla (\\nabla \\mathbf{B})| \\sim \\eta_{\\mathrm{m}} \\frac{1}{L} \\left(\\frac{B_0}{L}\\right) = \\frac{\\eta_{\\mathrm{m}} B_0}{L^2}\n$$\nThe magnetic Reynolds number, $R_{\\mathrm{m}}$, is defined as the ratio of the magnitude of the advection term to that of the diffusion term:\n$$\nR_{\\mathrm{m}} = \\frac{|\\text{Advection term}|}{|\\text{Diffusion term}|} \\sim \\frac{v B_0 / L}{\\eta_{\\mathrm{m}} B_0 / L^2} = \\frac{v L}{\\eta_{\\mathrm{m}}}\n$$\nIf $R_{\\mathrm{m}} \\gg 1$, advection dominates, and the magnetic field is said to be \"frozen-in\" to the plasma. If $R_{\\mathrm{m}} \\ll 1$, diffusion dominates.\n\nNow, we perform the numerical calculation.\nFirst, we calculate the classical Spitzer resistivity $\\eta_{\\mathrm{e}}$ using the given formula and parameters: $Z = 1$, $\\ln \\Lambda = 17$, and $T_e = 5.0 \\times 10^{3}\\,$ eV.\n$$\n\\eta_{\\mathrm{e}} \\approx 5.2 \\times 10^{-5} \\, Z \\, \\ln \\Lambda \\, T_e^{-3/2} \\, [\\Omega \\cdot \\text{m}]\n$$\n$$\n\\eta_{\\mathrm{e}} \\approx (5.2 \\times 10^{-5}) \\times (1) \\times (17) \\times (5.0 \\times 10^3)^{-3/2}\n$$\n$$\n\\eta_{\\mathrm{e}} \\approx (8.84 \\times 10^{-4}) \\times (5000)^{-1.5} \\approx (8.84 \\times 10^{-4}) \\times (353553.39)^{-1}\n$$\n$$\n\\eta_{\\mathrm{e}} \\approx (8.84 \\times 10^{-4}) \\times (2.8284 \\times 10^{-6}) \\approx 2.5003 \\times 10^{-9} \\, \\Omega \\cdot \\text{m}\n$$\nNext, we calculate the magnetic diffusivity $\\eta_{\\mathrm{m}}$:\n$$\n\\eta_{\\mathrm{m}} = \\frac{\\eta_{\\mathrm{e}}}{\\mu_0} = \\frac{2.5003 \\times 10^{-9} \\, \\Omega \\cdot \\text{m}}{4\\pi \\times 10^{-7} \\, \\text{H/m}} \\approx 1.9897 \\times 10^{-3} \\, \\text{m}^2/\\text{s}\n$$\nFinally, we calculate the magnetic Reynolds number $R_{\\mathrm{m}}$ using the given parameters $v = 3.0 \\times 10^{4}\\,$ m/s and $L = 0.30\\,$ m:\n$$\nR_{\\mathrm{m}} = \\frac{v L}{\\eta_{\\mathrm{m}}} \\approx \\frac{(3.0 \\times 10^4 \\, \\text{m/s}) \\times (0.30 \\, \\text{m})}{1.9897 \\times 10^{-3} \\, \\text{m}^2/\\text{s}}\n$$\n$$\nR_{\\mathrm{m}} \\approx \\frac{9.0 \\times 10^3 \\, \\text{m}^2/\\text{s}}{1.9897 \\times 10^{-3} \\, \\text{m}^2/\\text{s}} \\approx 4.5233 \\times 10^6\n$$\nThe value of the magnetic Reynolds number is very large, $R_{\\mathrm{m}} \\gg 1$. This indicates that for the given tokamak core parameters, the advection of the magnetic field by the plasma flow is overwhelmingly dominant compared to its resistive diffusion. The frozen-in condition is an excellent approximation in this regime.\n\nRounding the result to three significant figures, we get:\n$$\nR_{\\mathrm{m}} \\approx 4.52 \\times 10^6\n$$",
            "answer": "$$\n\\boxed{4.52 \\times 10^6}\n$$"
        },
        {
            "introduction": "While the frozen-in condition provides an excellent model for many plasma phenomena, its violation is equally important, enabling critical processes like magnetic reconnection. This conceptual practice moves beyond the simple scalar criterion of the magnetic Reynolds number to explore the fundamental physics of how magnetic field lines can \"slip\" relative to the plasma. By analyzing the change in magnetic flux, $\\Phi$, through a material loop moving with the plasma, you will uncover the crucial role of the electric field parallel to the magnetic field, $E_{\\parallel}$ . This exercise clarifies that preserving magnetic topology is not just about high conductivity, but is fundamentally linked to the absence of a potential drop along magnetic field lines.",
            "id": "4053014",
            "problem": "In a toroidal plasma device representative of fusion engineering, consider a thin, material loop $\\,\\mathcal{C}(t)\\,$ that is the boundary of a material surface $\\,\\mathcal{S}(t)\\,$ composed of the same labeled plasma elements and moving with the local plasma velocity $\\,\\mathbf{v}(\\mathbf{x},t)\\,$. The loop is threaded by magnetic field lines of the magnetic field $\\,\\mathbf{B}(\\mathbf{x},t)\\,$ and subject to the electric field $\\,\\mathbf{E}(\\mathbf{x},t)\\,$. Using Faraday’s law of induction and kinematics of a moving contour, assess the conditions under which the footpoints of the magnetic field lines remain attached to $\\,\\mathcal{C}(t)\\,$ and when they can slip relative to the moving material, with explicit reference to the component of $\\,\\mathbf{E}\\,$ parallel to $\\,\\mathbf{B}\\,$, denoted $\\,\\mathbf{E}_{\\parallel} \\equiv (\\mathbf{E}\\cdot\\hat{\\mathbf{b}})\\,\\hat{\\mathbf{b}}\\,$ where $\\,\\hat{\\mathbf{b}} = \\mathbf{B}/|\\mathbf{B}|\\,$. Magnetohydrodynamics (MHD) and its extensions are assumed valid, with non-ideal effects permitted.\n\nWhich statement is correct?\n\nA. For a material loop moving with $\\,\\mathbf{v}\\,$, magnetic footpoints remain attached if and only if along every magnetic field line that threads $\\,\\mathcal{C}(t)\\,$ the line integral of the parallel electric field vanishes, $\\,\\int_{\\text{field line}} \\mathbf{E}\\cdot\\hat{\\mathbf{b}}\\,\\mathrm{d}\\ell = 0\\,$. In that case, the magnetic flux through the comoving loop satisfies $\\,\\mathrm{d}\\Phi/\\mathrm{d}t = -\\oint_{\\mathcal{C}(t)} (\\mathbf{E}+\\mathbf{v}\\times\\mathbf{B})\\cdot \\mathrm{d}\\boldsymbol{\\ell} = 0\\,$, and the footpoints remain attached. Slippage occurs precisely where and to the extent that $\\,\\int_{\\text{field line}} \\mathbf{E}_{\\parallel}\\,\\mathrm{d}\\ell \\neq 0\\,$ across a non-ideal region.\n\nB. If $\\,\\nabla\\times \\mathbf{E}_{\\parallel} = \\mathbf{0}\\,$, then by Faraday’s law the parallel electric field cannot change magnetic flux; therefore footpoints remain attached even if $\\,\\int \\mathbf{E}_{\\parallel}\\cdot \\mathrm{d}\\boldsymbol{\\ell} \\neq 0\\,$ along the field line.\n\nC. The frozen-in condition is governed solely by the perpendicular component $\\,\\mathbf{E}_{\\perp}\\,$; as long as $\\,\\lvert \\mathbf{E}_{\\perp} \\rvert  \\lvert \\mathbf{v} \\times \\mathbf{B} \\rvert\\,$, footpoints remain attached regardless of $\\,\\mathbf{E}_{\\parallel}\\,$.\n\nD. In Hall Magnetohydrodynamics (Hall MHD), even a finite $\\,\\mathbf{E}_{\\parallel}\\,$ cannot cause slippage of magnetic footpoints relative to the ion fluid; magnetic field lines are strictly frozen into the ion velocity $\\,\\mathbf{v}_{i}\\,$.",
            "solution": "### Problem Validation\n\n#### Step 1: Extract Givens\n- **System:** A toroidal plasma device in fusion engineering.\n- **Objects and Motion:** A thin, material loop $\\mathcal{C}(t)$ is the boundary of a material surface $\\mathcal{S}(t)$. Both are composed of plasma elements moving with the local plasma velocity $\\mathbf{v}(\\mathbf{x},t)$.\n- **Fields:** Magnetic field $\\mathbf{B}(\\mathbf{x},t)$ and electric field $\\mathbf{E}(\\mathbf{x},t)$.\n- **Definitions:** The component of $\\mathbf{E}$ parallel to $\\mathbf{B}$ is $\\mathbf{E}_{\\parallel} \\equiv (\\mathbf{E}\\cdot\\hat{\\mathbf{b}})\\,\\hat{\\mathbf{b}}$, where $\\hat{\\mathbf{b}} = \\mathbf{B}/|\\mathbf{B}|$.\n- **Governing Principles:** Faraday’s law of induction, kinematics of a moving contour, Magnetohydrodynamics (MHD) and its extensions are valid.\n- **Key Condition:** Non-ideal effects are permitted.\n- **Question:** To assess the conditions for the attachment (frozen-in) and slippage of magnetic field line footpoints relative to the material loop $\\mathcal{C}(t)$, with specific reference to $\\mathbf{E}_{\\parallel}$.\n\n#### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is firmly rooted in the fundamental principles of plasma physics and magnetohydrodynamics. It involves Faraday's law, the concept of a material loop, magnetic flux, the frozen-in condition (Alfvén's theorem), and non-ideal effects (which lead to magnetic reconnection). These are standard and critical concepts in fusion plasma physics.\n2.  **Well-Posed:** The problem asks for the physical conditions governing a well-defined phenomenon (slippage of magnetic field lines). The provided information is sufficient to derive these conditions from first principles. A unique and meaningful physical conclusion can be reached.\n3.  **Objective:** The problem is phrased using precise, standard scientific terminology. There are no subjective or ambiguous statements.\n\n#### Step 3: Verdict and Action\nThe problem statement is scientifically sound, well-posed, and objective. It contains no invalidating flaws. Therefore, the problem is **valid**. I will proceed with the derivation and solution.\n\n### Derivation\n\nThe analysis begins with the magnetic flux, $\\Phi$, passing through the material surface $\\mathcal{S}(t)$ whose boundary is the material loop $\\mathcal{C}(t)$.\nThe magnetic flux is defined as:\n$$ \\Phi(t) = \\int_{\\mathcal{S}(t)} \\mathbf{B}(\\mathbf{x}, t) \\cdot d\\mathbf{A} $$\nThe rate of change of this flux for a surface moving with velocity $\\mathbf{v}$ is given by the Reynolds transport theorem for surfaces (also known as the Leibniz integral rule for moving surfaces):\n$$ \\frac{d\\Phi}{dt} = \\int_{\\mathcal{S}(t)} \\left( \\frac{\\partial \\mathbf{B}}{\\partial t} - \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) \\right) \\cdot d\\mathbf{A} $$\nWe use Faraday's law of induction, $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$, to substitute for the time derivative of $\\mathbf{B}$:\n$$ \\frac{d\\Phi}{dt} = \\int_{\\mathcal{S}(t)} \\left( -(\\nabla \\times \\mathbf{E}) - \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) \\right) \\cdot d\\mathbf{A} = - \\int_{\\mathcal{S}(t)} \\nabla \\times (\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot d\\mathbf{A} $$\nApplying Stokes' theorem, we convert the surface integral over $\\mathcal{S}(t)$ into a line integral around its boundary, the material loop $\\mathcal{C}(t)$:\n$$ \\frac{d\\Phi}{dt} = - \\oint_{\\mathcal{C}(t)} (\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot d\\boldsymbol{\\ell} $$\nThe vector $\\mathbf{E}' = \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}$ is the electric field in the local frame of reference moving with the plasma. Thus, the rate of change of magnetic flux through a material loop is equal to the negative of the electromotive force (EMF) around that loop as measured in the co-moving frame.\n\nThe concept of magnetic field lines being \"frozen-in\" or \"attached\" to the plasma means that the magnetic flux through any and every material loop is conserved, i.e., $\\frac{d\\Phi}{dt} = 0$. This implies that the magnetic topology relative to the fluid elements is preserved. This condition, $\\frac{d\\Phi}{dt} = 0$ for any loop $\\mathcal{C}(t)$, requires the integrand to be zero locally (or be the gradient of a scalar potential). The simplest and most general condition is the ideal Ohm's law:\n$$ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0} $$\nThis vector equation can be broken into components parallel and perpendicular to $\\mathbf{B}$:\n1.  Parallel component: $(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot \\hat{\\mathbf{b}} = \\mathbf{E} \\cdot \\hat{\\mathbf{b}} = E_{\\parallel} = 0$.\n2.  Perpendicular component: $\\mathbf{E}_{\\perp} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$.\n\nSlippage of magnetic footpoints is a visualization of a change in magnetic field topology. This process is known as magnetic reconnection. It occurs when the frozen-in condition is violated, i.e., when $\\frac{d\\Phi}{dt} \\neq 0$. This requires that $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\neq \\mathbf{0}$. This non-zero term arises from non-ideal effects, such as resistivity ($\\eta \\mathbf{J}$), the Hall effect ($\\frac{1}{ne}\\mathbf{J}\\times\\mathbf{B}$), or electron pressure gradients ($-\\frac{1}{ne}\\nabla p_e$).\n\nA central tenet of modern magnetic reconnection theory is that a change in magnetic connectivity requires a non-zero potential drop along a magnetic field line. This potential drop is given by the line integral of the parallel electric field:\n$$ V_{\\parallel} = \\int_{\\text{field line}} \\mathbf{E} \\cdot d\\boldsymbol{\\ell} = \\int_{\\text{field line}} E_{\\parallel} d\\ell $$\nIn ideal MHD, $E_{\\parallel}=0$ everywhere, so $V_{\\parallel} = 0$, and reconnection is forbidden. In a real plasma with non-ideal effects, a localized region can support a finite $E_{\\parallel}$, leading to a non-zero $V_{\\parallel}$. This \"reconnection voltage\" determines the rate at which magnetic field lines break and re-form with a new topology, which is precisely the phenomenon of footpoint slippage. Therefore, the condition for footpoints to remain attached is that $\\int E_{\\parallel} d\\ell = 0$ for all field lines threading the loop. Slippage occurs when, where, and to the extent that this integral is non-zero.\n\n### Option-by-Option Analysis\n\n**A. For a material loop moving with $\\,\\mathbf{v}\\,$, magnetic footpoints remain attached if and only if along every magnetic field line that threads $\\,\\mathcal{C}(t)\\,$ the line integral of the parallel electric field vanishes, $\\,\\int_{\\text{field line}} \\mathbf{E}\\cdot\\hat{\\mathbf{b}}\\,\\mathrm{d}\\ell = 0\\,$. In that case, the magnetic flux through the comoving loop satisfies $\\,\\mathrm{d}\\Phi/\\mathrm{d}t = -\\oint_{\\mathcal{C}(t)} (\\mathbf{E}+\\mathbf{v}\\times\\mathbf{B})\\cdot \\mathrm{d}\\boldsymbol{\\ell} = 0\\,$, and the footpoints remain attached. Slippage occurs precisely where and to the extent that $\\,\\int_{\\text{field line}} \\mathbf{E}_{\\parallel}\\,\\mathrm{d}\\ell \\neq 0\\,$ across a non-ideal region.**\n\nThis statement is entirely consistent with our derivation. It correctly identifies the vanishing of the integrated parallel electric field as the necessary and sufficient condition for maintaining magnetic topology (no slippage). It correctly states that if footpoints are attached, the flux through a co-moving loop is conserved ($\\frac{d\\Phi}{dt}=0$), and correctly provides the integral expression for this rate of change. Finally, it accurately describes slippage as being caused by, and proportional to, the non-zero integrated parallel E-field, which can only exist in a non-ideal region.\n**Verdict: Correct.**\n\n**B. If $\\,\\nabla\\times \\mathbf{E}_{\\parallel} = \\mathbf{0}\\,$, then by Faraday’s law the parallel electric field cannot change magnetic flux; therefore footpoints remain attached even if $\\,\\int \\mathbf{E}_{\\parallel}\\cdot \\mathrm{d}\\boldsymbol{\\ell} \\neq 0\\,$ along the field line.**\n\nThis statement is flawed. First, Faraday's law relates $\\frac{\\partial \\mathbf{B}}{\\partial t}$ to $\\nabla \\times \\mathbf{E} = \\nabla \\times (\\mathbf{E}_{\\parallel} + \\mathbf{E}_{\\perp})$, not just $\\nabla \\times \\mathbf{E}_{\\parallel}$. One cannot isolate the contribution this way. Second, and more critically, the conclusion that footpoints remain attached even if $\\int E_{\\parallel} d\\ell \\neq 0$ is fundamentally incorrect. As derived, a non-zero line integral of $E_{\\parallel}$ is the very definition of a reconnection voltage that drives the change in magnetic topology, i.e., footpoint slippage.\n**Verdict: Incorrect.**\n\n**C. The frozen-in condition is governed solely by the perpendicular component $\\,\\mathbf{E}_{\\perp}\\,$; as long as $\\,\\lvert \\mathbf{E}_{\\perp} \\rvert  \\lvert \\mathbf{v} \\times \\mathbf{B} \\rvert\\,$, footpoints remain attached regardless of $\\,\\mathbf{E}_{\\parallel}\\,$.**\n\nThis is incorrect. The frozen-in condition, $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$, is a vector equation that must hold for both parallel and perpendicular components. Specifically, it requires $E_{\\parallel}=0$. The statement that the condition is governed \"solely by the perpendicular component\" and that slippage is prevented \"regardless of $\\mathbf{E}_{\\parallel}$\" is false. A non-zero $\\mathbf{E}_{\\parallel}$ is a direct violation of the ideal condition and is precisely what enables reconnection. Furthermore, the condition on the magnitudes, $\\lvert \\mathbf{E}_{\\perp} \\rvert  \\lvert \\mathbf{v} \\times \\mathbf{B} \\rvert$, is not the correct condition; the ideal condition is a vector equality, $\\mathbf{E}_{\\perp} = - \\mathbf{v} \\times \\mathbf{B}$.\n**Verdict: Incorrect.**\n\n**D. In Hall Magnetohydrodynamics (Hall MHD), even a finite $\\,\\mathbf{E}_{\\parallel}\\,$ cannot cause slippage of magnetic footpoints relative to the ion fluid; magnetic field lines are strictly frozen into the ion velocity $\\,\\mathbf{v}_{i}\\,$.**\n\nThis statement contains a fundamental error regarding Hall MHD. In the Hall MHD model, the induction equation takes the form $\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v}_e \\times \\mathbf{B})$, where $\\mathbf{v}_e$ is the electron fluid velocity. This means that magnetic field lines are frozen into the *electron fluid*, not the ion fluid ($\\mathbf{v}_i$). The difference in velocities, $\\mathbf{v}_i - \\mathbf{v}_e = \\mathbf{J}/(ne)$, represents a slippage of the ion fluid relative to the magnetic field. The assertion that field lines are frozen into the ions is incorrect.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Correctly simulating the frozen-in condition requires capturing the kinematic effect of the flow on the magnetic field vector—namely, its stretching and rotation by velocity gradients. This computational benchmark provides a hands-on opportunity to implement the exact analytic solution for ideal magnetic advection in a simple shear flow, a result known as Cauchy's solution . By contrasting this correct evolution with a naive model that treats the magnetic field components as independent passive scalars, you will directly visualize and quantify the error that arises from ignoring the field line stretching term. This exercise builds essential intuition for developing and verifying numerical MHD codes.",
            "id": "4053049",
            "problem": "Consider incompressible ideal Magnetohydrodynamics (MHD), defined by the combination of Maxwell–Faraday equation and the ideal Ohm's law. The relevant fundamentals are: the Maxwell–Faraday equation $ \\nabla \\times \\mathbf{E} = - \\partial_t \\mathbf{B} $, the ideal Ohm’s law $ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0} $, and mass conservation for incompressible flow $ \\nabla \\cdot \\mathbf{v} = 0 $. For magnetostatics in the absence of magnetic sources, the solenoidal constraint holds $ \\nabla \\cdot \\mathbf{B} = 0 $. In the ideal limit, magnetic field lines are expected to be frozen into the fluid motion.\n\nYou are to design a computational benchmark for shear advection in a two-dimensional periodic square domain, where analytic solutions exist to validate the frozen-in behavior. The velocity field is a linear shear given by $ \\mathbf{v}(x,y) = (\\gamma y, 0) $, where $ \\gamma $ is a constant shear rate with units of $ \\mathrm{s}^{-1} $. The domain is $ [0, L) \\times [0, L) $ with periodic boundary conditions in both directions, where $ L $ has units of $ \\mathrm{m} $.\n\nYour tasks are:\n\n- Starting from the fundamental laws and definitions above, derive the analytic evolution of the magnetic field under the ideal assumption for this shear flow, expressed in terms of the flow map from initial coordinates $ \\mathbf{a} $ to current coordinates $ \\mathbf{x} $, and the associated deformation gradient. Do not use or cite any shortcut formulas that are already specialized to the result; instead, derive the result from the fundamentals provided. Clearly state the assumptions required for the derivation, including any constraints on $ \\nabla \\cdot \\mathbf{v} $ and $ \\nabla \\cdot \\mathbf{B} $.\n\n- Implement a numerical model that computes, at a given time $ t $, both:\n  1. The analytically evolved magnetic field obtained from your derivation (frozen-in pushforward under incompressible shear).\n  2. A naive passive-advection model that treats the magnetic field components as independent passive scalars transported by the flow without accounting for any stretching or rotation due to velocity gradients.\n\n- Quantify the discrepancy between the naive passive-advection model and the analytically correct frozen-in evolution by computing the relative $ L^2 $ error over the domain, defined as\n$$\n\\varepsilon = \\sqrt{\\frac{\\sum_{i,j} \\left( \\left[B_x^{\\mathrm{naive}}(x_i,y_j,t) - B_x^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 + \\left[B_y^{\\mathrm{naive}}(x_i,y_j,t) - B_y^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 \\right)}{\\sum_{i,j} \\left( \\left[B_x^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 + \\left[B_y^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 \\right)}}\n$$\n\nUse the inverse flow map $ \\mathbf{a}(\\mathbf{x},t) $ for evaluation of initial conditions at the appropriate Lagrangian labels, and enforce periodicity by mapping coordinates modulo $ L $ before evaluating trigonometric functions. All angles in trigonometric evaluations must be in radians.\n\nInitial conditions and test suite:\n\n- Define a divergence-free initial magnetic field using a scalar potential $ A_z(\\mathbf{a}) $ such that $ \\mathbf{B}_0(\\mathbf{a}) = \\nabla \\times \\left( A_z(\\mathbf{a}) \\, \\hat{\\mathbf{z}} \\right) $. Use the choice\n$$\nA_z(\\mathbf{a}) = \\frac{B_\\star}{k} \\sin\\left(k a_x\\right) \\sin\\left(k a_y\\right) \\, ,\n$$\nwith $ B_\\star $ in $ \\mathrm{T} $ and $ k $ in $ \\mathrm{rad}\\,\\mathrm{m}^{-1} $, so that\n$$\nB_{0x}(\\mathbf{a}) = B_\\star \\sin\\left(k a_x\\right) \\cos\\left(k a_y\\right) \\, , \\quad B_{0y}(\\mathbf{a}) = - B_\\star \\cos\\left(k a_x\\right) \\sin\\left(k a_y\\right) \\, .\n$$\nAlso include a uniform initial field case $ \\mathbf{B}_0(\\mathbf{a}) = (0, B_\\star) $ for a constant $ B_\\star $.\n\n- Use the periodic square domain of side $ L $ with a uniform Cartesian grid of $ N \\times N $ points. For periodicity, evaluate initial conditions at $ \\mathbf{a}(\\mathbf{x},t) $ reduced modulo $ L $ in each direction.\n\n- Provide the relative $ L^2 $ error $ \\varepsilon $ for each of the following test cases (the set forms the test suite):\n  1. Case $ A $ (happy path, constant field under shear): $ L = 1.0 \\, \\mathrm{m} $, $ N = 128 $, $ \\gamma = 1.0 \\, \\mathrm{s}^{-1} $, $ t = 0.3 \\, \\mathrm{s} $, $ B_\\star = 0.7 \\, \\mathrm{T} $. Use the uniform initial field $ \\mathbf{B}_0 = (0, B_\\star) $.\n  2. Case $ B $ (divergence-free sinusoidal initial field): $ L = 1.0 \\, \\mathrm{m} $, $ N = 128 $, $ \\gamma = 0.6 \\, \\mathrm{s}^{-1} $, $ t = 0.5 \\, \\mathrm{s} $, $ B_\\star = 0.5 \\, \\mathrm{T} $, $ k = \\frac{2\\pi}{L} \\, \\mathrm{rad}\\,\\mathrm{m}^{-1} $. Use the divergence-free initial field defined above.\n  3. Case $ C $ (boundary condition at zero time): Same parameters as Case $ B $ but with $ t = 0.0 \\, \\mathrm{s} $.\n  4. Case $ D $ (edge case with zero shear): Same parameters as Case $ B $ but with $ \\gamma = 0.0 \\, \\mathrm{s}^{-1} $.\n\nUnits and angle specification:\n\n- Distances $ L $ are in $ \\mathrm{m} $, shear rate $ \\gamma $ is in $ \\mathrm{s}^{-1} $, time $ t $ is in $ \\mathrm{s} $, magnetic field amplitudes $ B_\\star $ are in $ \\mathrm{T} $, and wavenumber $ k $ is in $ \\mathrm{rad}\\,\\mathrm{m}^{-1} $. All trigonometric function arguments must be in radians.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the relative $ L^2 $ errors for Cases $ A $, $ B $, $ C $, and $ D $ as a comma-separated list enclosed in square brackets, for example $ [e_A, e_B, e_C, e_D] $. Each entry must be a floating-point number. Express each entry as a dimensionless float rounded to eight decimal places.\n\nNo user input is required; all parameters are specified above and must be hard-coded. Your implementation should be self-contained and executable in any modern programming environment with standard numerical libraries.",
            "solution": "The problem requires the derivation of the analytic solution for the evolution of a magnetic field in an ideal, incompressible shear flow, and its comparison against a naive passive advection model. The validation of the problem statement has confirmed its scientific soundness, completeness, and clarity. We now proceed with the formal derivation and the design of the numerical implementation.\n\n### Part 1: Derivation of the Analytic Magnetic Field Evolution (Frozen-In Law)\n\nThe evolution of the magnetic field $ \\mathbf{B} $ in an ideal conducting fluid is governed by the combination of the Maxwell-Faraday equation and the ideal Ohm's law.\n\nThe fundamental equations provided are:\n1.  Maxwell-Faraday equation: $ \\nabla \\times \\mathbf{E} = - \\partial_t \\mathbf{B} $\n2.  Ideal Ohm's law: $ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0} $\n3.  Incompressibility condition for the flow: $ \\nabla \\cdot \\mathbf{v} = 0 $\n4.  Solenoidal constraint on the magnetic field: $ \\nabla \\cdot \\mathbf{B} = 0 $\n\nFrom Ohm's law, we express the electric field as $ \\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B} $. Substituting this into the Maxwell-Faraday equation yields the ideal induction equation:\n$$\n\\partial_t \\mathbf{B} = - \\nabla \\times (-\\mathbf{v} \\times \\mathbf{B}) = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B})\n$$\nWe use the vector calculus identity $ \\nabla \\times (\\mathbf{A} \\times \\mathbf{C}) = (\\mathbf{C} \\cdot \\nabla) \\mathbf{A} - (\\mathbf{A} \\cdot \\nabla) \\mathbf{C} + \\mathbf{A}(\\nabla \\cdot \\mathbf{C}) - \\mathbf{C}(\\nabla \\cdot \\mathbf{A}) $. Identifying $ \\mathbf{A} $ with $ \\mathbf{v} $ and $ \\mathbf{C} $ with $ \\mathbf{B} $, we expand the curl term:\n$$\n\\partial_t \\mathbf{B} = (\\mathbf{B} \\cdot \\nabla) \\mathbf{v} - (\\mathbf{v} \\cdot \\nabla) \\mathbf{B} + \\mathbf{v}(\\nabla \\cdot \\mathbf{B}) - \\mathbf{B}(\\nabla \\cdot \\mathbf{v})\n$$\nApplying the given constraints $ \\nabla \\cdot \\mathbf{v} = 0 $ and $ \\nabla \\cdot \\mathbf{B} = 0 $, the equation simplifies to:\n$$\n\\partial_t \\mathbf{B} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{B} = (\\mathbf{B} \\cdot \\nabla) \\mathbf{v}\n$$\nThe left-hand side is the material derivative of the magnetic field, $ \\frac{D\\mathbf{B}}{Dt} $, which describes the rate of change of $ \\mathbf{B} $ as seen by an observer moving with a fluid parcel. Thus, we have:\n$$\n\\frac{D\\mathbf{B}}{Dt} = (\\mathbf{B} \\cdot \\nabla) \\mathbf{v}\n$$\nThe term $ (\\mathbf{B} \\cdot \\nabla) \\mathbf{v} $ represents the stretching and rotation of the field by the velocity gradient tensor $ \\nabla\\mathbf{v} $. Let us represent this in component form. The $i$-th component is $ \\frac{DB_i}{Dt} = \\sum_j B_j \\frac{\\partial v_i}{\\partial x_j} $. In matrix form, this is $ \\frac{D\\mathbf{B}}{Dt} = (\\nabla\\mathbf{v})\\mathbf{B} $.\n\nTo solve this equation, we consider the evolution in a Lagrangian frame. Let $ \\mathbf{a} $ be the initial position of a fluid parcel at time $ t=0 $, and let $ \\mathbf{x} = \\mathbf{\\Phi}(\\mathbf{a}, t) $ be its position at time $ t $. The deformation gradient tensor is defined as $ \\mathbf{F}(\\mathbf{a}, t) $ with components $ F_{ij} = \\frac{\\partial x_i}{\\partial a_j} $. The evolution of $ \\mathbf{F} $ is given by $ \\frac{D\\mathbf{F}}{Dt} = (\\nabla\\mathbf{v})\\mathbf{F} $. In the Lagrangian frame, this is $ \\frac{\\partial \\mathbf{F}}{\\partial t}\\Big|_{\\mathbf{a}} = (\\nabla\\mathbf{v})\\mathbf{F} $.\n\nLet $ \\tilde{\\mathbf{B}}(\\mathbf{a}, t) = \\mathbf{B}(\\mathbf{\\Phi}(\\mathbf{a}, t), t) $ be the magnetic field vector of the fluid parcel that was initially at $ \\mathbf{a} $. The material derivative is then $ \\frac{D\\mathbf{B}}{Dt} = \\frac{\\partial \\tilde{\\mathbf{B}}}{\\partial t}\\Big|_{\\mathbf{a}} $. The induction equation in this frame becomes:\n$$\n\\frac{\\partial \\tilde{\\mathbf{B}}}{\\partial t}\\Big|_{\\mathbf{a}} = (\\nabla\\mathbf{v}) \\tilde{\\mathbf{B}}\n$$\nWe observe that $ \\tilde{\\mathbf{B}} $ and $ \\mathbf{F} $ satisfy formally identical linear ordinary differential equations in time for a fixed parcel $ \\mathbf{a} $. Let us construct a quantity $ \\mathbf{C}(\\mathbf{a}, t) = \\mathbf{F}^{-1}(\\mathbf{a}, t) \\tilde{\\mathbf{B}}(\\mathbf{a}, t) $ and show it is conserved in time.\n$$\n\\frac{\\partial \\mathbf{C}}{\\partial t} = \\frac{\\partial \\mathbf{F}^{-1}}{\\partial t}\\tilde{\\mathbf{B}} + \\mathbf{F}^{-1}\\frac{\\partial \\tilde{\\mathbf{B}}}{\\partial t}\n$$\nUsing the identity $ \\frac{\\partial \\mathbf{F}^{-1}}{\\partial t} = -\\mathbf{F}^{-1} \\frac{\\partial \\mathbf{F}}{\\partial t} \\mathbf{F}^{-1} $ and substituting the evolution equations for $ \\tilde{\\mathbf{B}} $ and $ \\mathbf{F} $:\n$$\n\\frac{\\partial \\mathbf{C}}{\\partial t} = \\left( -\\mathbf{F}^{-1} (\\nabla\\mathbf{v})\\mathbf{F} \\mathbf{F}^{-1} \\right) \\tilde{\\mathbf{B}} + \\mathbf{F}^{-1} \\left( (\\nabla\\mathbf{v}) \\tilde{\\mathbf{B}} \\right) = -\\mathbf{F}^{-1}(\\nabla\\mathbf{v})\\tilde{\\mathbf{B}} + \\mathbf{F}^{-1}(\\nabla\\mathbf{v})\\tilde{\\mathbf{B}} = \\mathbf{0}\n$$\nTherefore, $ \\mathbf{C}(\\mathbf{a}, t) $ is constant in time. We can evaluate it at $ t=0 $:\n$$\n\\mathbf{C}(\\mathbf{a}, t) = \\mathbf{C}(\\mathbf{a}, 0) = \\mathbf{F}^{-1}(\\mathbf{a}, 0) \\tilde{\\mathbf{B}}(\\mathbf{a}, 0)\n$$\nAt $ t=0 $, $ \\mathbf{x}=\\mathbf{a} $, so the deformation gradient is the identity matrix, $ \\mathbf{F}(\\mathbf{a}, 0) = \\mathbf{I} $, and $ \\tilde{\\mathbf{B}}(\\mathbf{a}, 0) = \\mathbf{B}(\\mathbf{a}, 0) \\equiv \\mathbf{B}_0(\\mathbf{a}) $.\nThus, $ \\mathbf{C}(\\mathbf{a}, t) = \\mathbf{I}^{-1} \\mathbf{B}_0(\\mathbf{a}) = \\mathbf{B}_0(\\mathbf{a}) $.\n\nFrom $ \\mathbf{B}_0(\\mathbf{a}) = \\mathbf{F}^{-1}(\\mathbf{a}, t) \\tilde{\\mathbf{B}}(\\mathbf{a}, t) $, we find the solution for $ \\tilde{\\mathbf{B}} $:\n$$\n\\tilde{\\mathbf{B}}(\\mathbf{a}, t) = \\mathbf{F}(\\mathbf{a}, t) \\mathbf{B}_0(\\mathbf{a})\n$$\nTranslating back to Eulerian coordinates $ (\\mathbf{x}, t) $, where $ \\mathbf{a} = \\mathbf{\\Phi}^{-1}(\\mathbf{x}, t) $ is the required Lagrangian label:\n$$\n\\mathbf{B}(\\mathbf{x}, t) = \\mathbf{F}(\\mathbf{\\Phi}^{-1}(\\mathbf{x}, t), t) \\cdot \\mathbf{B}_0(\\mathbf{\\Phi}^{-1}(\\mathbf{x}, t))\n$$\nThis is the analytic expression for the evolved magnetic field under the frozen-in condition, derived from the specified fundamental laws and assumptions.\n\n### Part 2: Application to Linear Shear Flow\n\nWe now apply this general result to the specified two-dimensional linear shear flow $ \\mathbf{v}(x, y) = (\\gamma y, 0) $.\nThe trajectory of a fluid parcel is found by integrating $ \\frac{d\\mathbf{x}}{dt} = \\mathbf{v}(\\mathbf{x}) $ with initial condition $ \\mathbf{x}(0) = \\mathbf{a} = (a_x, a_y) $.\n$$\n\\frac{dx}{dt} = \\gamma y \\quad ; \\quad \\frac{dy}{dt} = 0\n$$\nIntegrating the second equation yields $ y(t) = a_y $. Substituting this into the first equation gives $ \\frac{dx}{dt} = \\gamma a_y $, which integrates to $ x(t) = a_x + \\gamma t a_y $.\nThe flow map is $ \\mathbf{x}(\\mathbf{a}, t) = (a_x + \\gamma t a_y, a_y) $.\n\nThe inverse flow map $ \\mathbf{a}(\\mathbf{x}, t) $ is found by solving for $ \\mathbf{a} $ given $ \\mathbf{x}=(x,y) $:\n$$\na_y = y \\quad ; \\quad a_x = x - \\gamma t a_y = x - \\gamma t y\n$$\nThe deformation gradient tensor $ F_{ij} = \\frac{\\partial x_i}{\\partial a_j} $ is:\n$$\n\\mathbf{F}(\\mathbf{a}, t) = \\begin{pmatrix} \\frac{\\partial x}{\\partial a_x}  \\frac{\\partial x}{\\partial a_y} \\\\ \\frac{\\partial y}{\\partial a_x}  \\frac{\\partial y}{\\partial a_y} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial a_x}(a_x + \\gamma t a_y)  \\frac{\\partial}{\\partial a_y}(a_x + \\gamma t a_y) \\\\ \\frac{\\partial}{\\partial a_x}(a_y)  \\frac{\\partial}{\\partial a_y}(a_y) \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma t \\\\ 0  1 \\end{pmatrix}\n$$\nNote that $ \\mathbf{F} $ is independent of position $ \\mathbf{a} $. The analytically correct evolved field is:\n$$\n\\mathbf{B}^{\\mathrm{analytic}}(\\mathbf{x}, t) = \\begin{pmatrix} 1  \\gamma t \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} B_{0x}(a_x, a_y) \\\\ B_{0y}(a_x, a_y) \\end{pmatrix}\n$$\nwhere $ (a_x, a_y) = (x - \\gamma t y, y) $. In component form:\n$$\nB_x^{\\mathrm{analytic}}(x, y, t) = B_{0x}(x - \\gamma t y, y) + \\gamma t \\, B_{0y}(x - \\gamma t y, y)\n$$\n$$\nB_y^{\\mathrm{analytic}}(x, y, t) = B_{0y}(x - \\gamma t y, y)\n$$\n\n### Part 3: The Naive Passive-Advection Model\n\nThe naive model treats each component of the magnetic field, $ B_x $ and $ B_y $, as an independent passive scalar. The evolution of a passive scalar $ S $ is given by $ \\frac{DS}{Dt} = \\partial_t S + (\\mathbf{v} \\cdot \\nabla)S = 0 $. This implies that the scalar value is simply advected along the flow trajectories, i.e., $ S(\\mathbf{x}, t) = S_0(\\mathbf{a}) $, where $ S_0 $ is the initial condition and $ \\mathbf{a} = \\mathbf{\\Phi}^{-1}(\\mathbf{x}, t) $.\nApplying this to $ B_x $ and $ B_y $:\n$$\nB_x^{\\mathrm{naive}}(x, y, t) = B_{0x}(a_x, a_y) = B_{0x}(x - \\gamma t y, y)\n$$\n$$\nB_y^{\\mathrm{naive}}(x, y, t) = B_{0y}(a_x, a_y) = B_{0y}(x - \\gamma t y, y)\n$$\nThis model incorrectly neglects the stretching term $ \\gamma t \\, B_{0y} $ in the $ B_x $ component, which arises from the shearing of the vertical magnetic field component into a horizontal one.\n\n### Part 4: Numerical Implementation Plan\n\nThe computational task is to evaluate the relative $ L^2 $ error between the analytic and naive models on a discrete grid.\n\n1.  **Grid Setup:** A uniform Cartesian grid of $ N \\times N $ points $ (x_i, y_j) $ is defined over the domain $ [0, L) \\times [0, L) $. The coordinates are $ x_i = i L/N $ and $ y_j = j L/N $ for $ i, j \\in \\{0, 1, ..., N-1\\} $.\n\n2.  **Evaluation Loop:** For each grid point $ (x_i, y_j) $:\n    a. Compute the Lagrangian coordinates: $ a_x = x_i - \\gamma t y_j $ and $ a_y = y_j $.\n    b. Apply periodic boundary conditions to the Lagrangian coordinates. The initial conditions are periodic with period $ L $, so we evaluate them at $ a_x^{\\mathrm{p}} = a_x \\pmod L $ and $ a_y^{\\mathrm{p}} = a_y \\pmod L $.\n    c. Evaluate the initial magnetic field components $ B_{0x}(a_x^{\\mathrm{p}}, a_y^{\\mathrm{p}}) $ and $ B_{0y}(a_x^{\\mathrm{p}}, a_y^{\\mathrm{p}}) $ using the specified functions for the uniform or sinusoidal cases.\n    d. Compute the analytic field components at $ (x_i, y_j, t) $: $ B_x^{\\mathrm{analytic}} = B_{0x} + \\gamma t B_{0y} $ and $ B_y^{\\mathrm{analytic}} = B_{0y} $.\n    e. Compute the naive field components: $ B_x^{\\mathrm{naive}} = B_{0x} $ and $ B_y^{\\mathrm{naive}} = B_{0y} $.\n\n3.  **Error Calculation:** After computing the field components over the entire grid, the relative $ L^2 $ error, $ \\varepsilon $, is calculated as:\n    $$\n    \\varepsilon = \\sqrt{\\frac{\\sum_{i,j=0}^{N-1} \\left( [B_x^{\\mathrm{naive}} - B_x^{\\mathrm{analytic}}]^2 + [B_y^{\\mathrm{naive}} - B_y^{\\mathrm{analytic}}]^2 \\right) }{\\sum_{i,j=0}^{N-1} \\left( [B_x^{\\mathrm{analytic}}]^2 + [B_y^{\\mathrm{analytic}}]^2 \\right)}}\n    $$\n    The difference in the numerator simplifies to:\n    $ [B_x^{\\mathrm{naive}} - B_x^{\\mathrm{analytic}}]^2 = [B_{0x} - (B_{0x} + \\gamma t B_{0y})]^2 = (-\\gamma t B_{0y})^2 $.\n    $ [B_y^{\\mathrm{naive}} - B_y^{\\mathrm{analytic}}]^2 = [B_{0y} - B_{0y}]^2 = 0 $.\n    The numerator sum is $ \\sum_{i,j} (\\gamma t B_{0y})^2 $. The denominator is the sum of squares of the analytic field components, $ \\sum_{i,j} ( (B_{0x} + \\gamma t B_{0y})^2 + B_{0y}^2 ) $. The implementation will compute these sums and find the square root of their ratio. Special cases where the denominator is zero (e.g., $ \\mathbf{B}_0 = \\mathbf{0} $) leading to an undefined error are not present in the test suite. For $t=0$ or $\\gamma=0$, the numerator is zero, yielding $\\varepsilon=0$.\nThis procedure will be implemented for each test case provided.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative L2 error between a naive passive-advection model and the\n    analytically correct frozen-in evolution of a magnetic field in a shear flow.\n    \"\"\"\n\n    def calculate_error(L, N, gamma, t, B_star, k, initial_field_type):\n        \"\"\"\n        Calculates the relative L2 error for a single test case.\n\n        Args:\n            L (float): Domain side length [m].\n            N (int): Number of grid points per dimension.\n            gamma (float): Shear rate [s^-1].\n            t (float): Time [s].\n            B_star (float): Magnetic field amplitude [T].\n            k (float): Wavenumber [rad/m].\n            initial_field_type (str): 'uniform' or 'sinusoidal'.\n\n        Returns:\n            float: The relative L2 error.\n        \"\"\"\n        # 1. Set up the grid\n        grid_coords = np.linspace(0, L, N, endpoint=False)\n        x, y = np.meshgrid(grid_coords, grid_coords)\n\n        # 2. Compute Lagrangian coordinates (inverse flow map)\n        a_x = x - gamma * t * y\n        a_y = y\n\n        # 3. Apply periodic boundary conditions to Lagrangian coordinates\n        a_x_periodic = a_x % L\n        a_y_periodic = a_y % L\n\n        # 4. Evaluate initial magnetic field B0 at Lagrangian coordinates\n        if initial_field_type == 'uniform':\n            B_0x = np.zeros_like(a_x_periodic)\n            B_0y = np.full_like(a_y_periodic, B_star)\n        elif initial_field_type == 'sinusoidal':\n            B_0x = B_star * np.sin(k * a_x_periodic) * np.cos(k * a_y_periodic)\n            B_0y = -B_star * np.cos(k * a_x_periodic) * np.sin(k * a_y_periodic)\n        else:\n            raise ValueError(\"Invalid initial_field_type\")\n\n        # 5. Compute analytic and naive field components\n        # Analytic field (frozen-in pushforward)\n        B_x_analytic = B_0x + gamma * t * B_0y\n        B_y_analytic = B_0y\n\n        # Naive field (passive scalar advection)\n        B_x_naive = B_0x\n        B_y_naive = B_0y\n\n        # 6. Calculate L2 error\n        # Numerator: sum of squared differences\n        diff_sq_sum = np.sum((B_x_naive - B_x_analytic)**2 + (B_y_naive - B_y_analytic)**2)\n\n        # Denominator: sum of squared analytic field components\n        analytic_norm_sq_sum = np.sum(B_x_analytic**2 + B_y_analytic**2)\n\n        if analytic_norm_sq_sum == 0.0:\n            # This can happen if the initial field is zero everywhere.\n            # If the difference is also zero, the error is 0. Otherwise it's undefined (inf).\n            return 0.0 if diff_sq_sum == 0.0 else np.inf\n\n        error = np.sqrt(diff_sq_sum / analytic_norm_sq_sum)\n        return error\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case A: uniform field\n        {'L': 1.0, 'N': 128, 'gamma': 1.0, 't': 0.3, 'B_star': 0.7, 'k': 0.0, 'type': 'uniform'},\n        # Case B: sinusoidal field\n        {'L': 1.0, 'N': 128, 'gamma': 0.6, 't': 0.5, 'B_star': 0.5, 'k': 2 * np.pi / 1.0, 'type': 'sinusoidal'},\n        # Case C: sinusoidal field at t=0\n        {'L': 1.0, 'N': 128, 'gamma': 0.6, 't': 0.0, 'B_star': 0.5, 'k': 2 * np.pi / 1.0, 'type': 'sinusoidal'},\n        # Case D: sinusoidal field with gamma=0\n        {'L': 1.0, 'N': 128, 'gamma': 0.0, 't': 0.5, 'B_star': 0.5, 'k': 2 * np.pi / 1.0, 'type': 'sinusoidal'},\n    ]\n\n    results = []\n    for case in test_cases:\n        error = calculate_error(\n            L=case['L'],\n            N=case['N'],\n            gamma=case['gamma'],\n            t=case['t'],\n            B_star=case['B_star'],\n            k=case['k'],\n            initial_field_type=case['type']\n        )\n        results.append(error)\n\n    # Format the final output string as required\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}