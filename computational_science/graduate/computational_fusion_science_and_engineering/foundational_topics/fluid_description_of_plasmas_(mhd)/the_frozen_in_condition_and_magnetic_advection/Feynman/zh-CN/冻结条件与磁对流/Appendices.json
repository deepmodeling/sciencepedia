{
    "hands_on_practices": [
        {
            "introduction": "要判断等离子体的行为在多大程度上是“理想的”，我们必须量化磁场随流体运动的平流效应与因电阻而产生的扩散效应之间的相对强度。这个比较可以通过一个无量纲参数，即磁雷诺数$R_{\\mathrm{m}}$来实现，它是磁流体力学（MHD）中的一个核心概念。通过练习 ，您将从基本定律出发推导磁感应方程，并对一个典型的托卡马克聚变等离子体场景进行标度分析，这是MHD研究中的一项基本技能。",
            "id": "4053022",
            "problem": "考虑一个单流体电阻磁流体力学（MHD）模型，该模型描述了一个代表托卡马克核心的氘等离子体区域。你需要评估磁场的演化是由平流（冻结行为）主导还是由扩散主导。使用以下基本定律作为你的基础：麦克斯韦-法拉第定律$\\partial \\mathbf{B}/\\partial t = -\\nabla \\times \\mathbf{E}$，无位移电流的安培定律$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$，准中性条件$n_e \\approx n_i$，以及最简形式的广义欧姆定律$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta_{\\mathrm{e}} \\mathbf{J}$，其中$\\eta_{\\mathrm{e}}$是标量电阻率。假设特征磁场大小$B_0$在一个典型的宏观长度尺度$L$上变化，并且一个大小为$v$的整体等离子体流对磁场进行平流输运。取真空磁导率$\\mu_0 = 4\\pi \\times 10^{-7}$ H/m。\n\n对于计算聚变科学模拟中的一组典型参数，采用：\n- 电子温度$T_e = 5.0 \\times 10^{3}$ eV,\n- 有效电荷态$Z = 1$,\n- 库仑对数$\\ln \\Lambda = 17$,\n- 磁场大小$B_0 = 3.0$ T,\n- 流速$v = 3.0 \\times 10^{4}$ m/s,\n- 宏观尺度$L = 0.30$ m.\n\n使用经典的Spitzer电阻率（一个经过充分检验的碰撞输运结果）$\\eta_{\\mathrm{e}} \\approx 5.2 \\times 10^{-5} \\, Z \\, \\ln \\Lambda \\, T_e^{-3/2}$，单位为$\\Omega\\cdot\\mathrm{m}$，其中$T_e$的单位是eV，并定义磁扩散系数$\\eta_{\\mathrm{m}} \\equiv \\eta_{\\mathrm{e}}/\\mu_0$。\n\n严格从给定的基本定律出发，推导磁感应方程中出现的两项——平流项和扩散项——的量级估计，并评估它们的量级以确定在给定参数下哪个过程占主导地位。你的最终答案必须是磁雷诺数$R_{\\mathrm{m}}$，其定义为该模型中感应方程的平流项量级与扩散项量级之比。将你的最终$R_{\\mathrm{m}}$值四舍五入到三位有效数字，并表示为一个无量纲的量。在你的计算过程中，所有中间物理量均以国际单位制（SI）报告。",
            "solution": "该问题要求从基本定律推导磁感应方程，进行标度分析以比较磁场的平流和扩散，并为托卡马克核心等离子体的一组典型参数计算磁雷诺数$R_{\\mathrm{m}}$。\n\n首先，我们推导磁感应方程。出发点是麦克斯韦-法拉第感应定律：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}\n$$\n问题给出了等离子体广义欧姆定律的最简形式，它将电场$\\mathbf{E}$与等离子体流速$\\mathbf{v}$、磁场$\\mathbf{B}$和电流密度$\\mathbf{J}$联系起来：\n$$\n\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta_{\\mathrm{e}} \\mathbf{J}\n$$\n其中$\\eta_{\\mathrm{e}}$是标量电阻率。我们重新整理此式，用其他量表示$\\mathbf{E}$：\n$$\n\\mathbf{E} = \\eta_{\\mathrm{e}} \\mathbf{J} - \\mathbf{v} \\times \\mathbf{B}\n$$\n将$\\mathbf{E}$的这个表达式代入法拉第定律得到：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times (\\eta_{\\mathrm{e}} \\mathbf{J} - \\mathbf{v} \\times \\mathbf{B}) = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) - \\nabla \\times (\\eta_{\\mathrm{e}} \\mathbf{J})\n$$\n接下来，我们使用安培定律，并按要求忽略位移电流，来替换电流密度$\\mathbf{J}$：\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} \\implies \\mathbf{J} = \\frac{1}{\\mu_0} \\nabla \\times \\mathbf{B}\n$$\n将其代入演化中的感应方程，得到：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) - \\nabla \\times \\left( \\frac{\\eta_{\\mathrm{e}}}{\\mu_0} \\nabla \\times \\mathbf{B} \\right)\n$$\n问题将磁扩散系数定义为$\\eta_{\\mathrm{m}} \\equiv \\eta_{\\mathrm{e}}/\\mu_0$。为了进行标度分析，电阻率$\\eta_{\\mathrm{e}}$以及扩散系数$\\eta_{\\mathrm{m}}$被视为空间常数，由给定的特征等离子体参数确定。方程变为：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) - \\eta_{\\mathrm{m}} \\nabla \\times (\\nabla \\times \\mathbf{B})\n$$\n我们对右侧第二项应用矢量微积分恒等式$\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$。根据麦克斯韦方程组（特别是磁场高斯定律），我们有$\\nabla \\cdot \\mathbf{B} = 0$。因此，该矢量恒等式简化为$\\nabla \\times (\\nabla \\times \\mathbf{B}) = -\\nabla^2 \\mathbf{B}$。\n代入此结果，我们得到磁感应方程的最终形式：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\underbrace{\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})}_{\\text{平流}} + \\underbrace{\\eta_{\\mathrm{m}} \\nabla^2 \\mathbf{B}}_{\\text{扩散}}\n$$\n右侧第一项$\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})$描述了磁场随流体流动的平流或对流。第二项$\\eta_{\\mathrm{m}} \\nabla^2 \\mathbf{B}$描述了磁场的电阻扩散。\n\n接下来，我们进行标度分析来估计这两项的量级。我们使用所提供的特征尺度：流速$|\\mathbf{v}| \\sim v$，磁场大小$|\\mathbf{B}| \\sim B_0$，以及对于长度尺度$L$上的空间变化的梯度算子$|\\nabla| \\sim 1/L$。\n\n平流项的量级估计为：\n$$\n|\\nabla \\times (\\mathbf{v} \\times \\mathbf{B})| \\sim \\frac{1}{L} |\\mathbf{v} \\times \\mathbf{B}| \\sim \\frac{v B_0}{L}\n$$\n扩散项的量级估计为：\n$$\n|\\eta_{\\mathrm{m}} \\nabla^2 \\mathbf{B}| \\sim \\eta_{\\mathrm{m}} |\\nabla (\\nabla \\mathbf{B})| \\sim \\eta_{\\mathrm{m}} \\frac{1}{L} \\left(\\frac{B_0}{L}\\right) = \\frac{\\eta_{\\mathrm{m}} B_0}{L^2}\n$$\n磁雷诺数$R_{\\mathrm{m}}$定义为平流项量级与扩散项量级之比：\n$$\nR_{\\mathrm{m}} = \\frac{|\\text{平流项}|}{|\\text{扩散项}|} \\sim \\frac{v B_0 / L}{\\eta_{\\mathrm{m}} B_0 / L^2} = \\frac{v L}{\\eta_{\\mathrm{m}}}\n$$\n如果$R_{\\mathrm{m}} \\gg 1$，则平流占主导，磁场被称为“冻结”在等离子体中。如果$R_{\\mathrm{m}} \\ll 1$，则扩散占主导。\n\n现在，我们进行数值计算。\n首先，我们使用给定的公式和参数计算经典的Spitzer电阻率$\\eta_{\\mathrm{e}}$：$Z = 1$，$\\ln \\Lambda = 17$，以及$T_e = 5.0 \\times 10^{3}$ eV。\n$$\n\\eta_{\\mathrm{e}} \\approx 5.2 \\times 10^{-5} \\, Z \\, \\ln \\Lambda \\, T_e^{-3/2} \\, [\\Omega \\cdot \\text{m}]\n$$\n$$\n\\eta_{\\mathrm{e}} \\approx (5.2 \\times 10^{-5}) \\times (1) \\times (17) \\times (5.0 \\times 10^3)^{-3/2}\n$$\n$$\n\\eta_{\\mathrm{e}} \\approx (8.84 \\times 10^{-4}) \\times (5000)^{-1.5} \\approx (8.84 \\times 10^{-4}) \\times (353553.39)^{-1}\n$$\n$$\n\\eta_{\\mathrm{e}} \\approx (8.84 \\times 10^{-4}) \\times (2.8284 \\times 10^{-6}) \\approx 2.5003 \\times 10^{-9} \\, \\Omega \\cdot \\text{m}\n$$\n接下来，我们计算磁扩散系数$\\eta_{\\mathrm{m}}$：\n$$\n\\eta_{\\mathrm{m}} = \\frac{\\eta_{\\mathrm{e}}}{\\mu_0} = \\frac{2.5003 \\times 10^{-9} \\, \\Omega \\cdot \\text{m}}{4\\pi \\times 10^{-7} \\, \\text{H/m}} \\approx 1.9897 \\times 10^{-3} \\, \\text{m}^2/\\text{s}\n$$\n最后，我们使用给定的参数$v = 3.0 \\times 10^{4}$ m/s和$L = 0.30$ m计算磁雷诺数$R_{\\mathrm{m}}$：\n$$\nR_{\\mathrm{m}} = \\frac{v L}{\\eta_{\\mathrm{m}}} \\approx \\frac{(3.0 \\times 10^4 \\, \\text{m/s}) \\times (0.30 \\, \\text{m})}{1.9897 \\times 10^{-3} \\, \\text{m}^2/\\text{s}}\n$$\n$$\nR_{\\mathrm{m}} \\approx \\frac{9.0 \\times 10^3 \\, \\text{m}^2/\\text{s}}{1.9897 \\times 10^{-3} \\, \\text{m}^2/\\text{s}} \\approx 4.5233 \\times 10^6\n$$\n磁雷诺数的值非常大，$R_{\\mathrm{m}} \\gg 1$。这表明对于给定的托卡马克核心参数，磁场被等离子体流平流输运的作用远超其电阻扩散作用。在此条件下，冻结条件是一个极好的近似。\n\n将结果四舍五入到三位有效数字，我们得到：\n$$\nR_{\\mathrm{m}} \\approx 4.52 \\times 10^6\n$$",
            "answer": "$$\n\\boxed{4.52 \\times 10^6}\n$$"
        },
        {
            "introduction": "磁冻结条件意味着磁力线与等离子体流体元牢固地“冻结”在一起，但这种理想化的图像在真实等离子体中会被打破。理解磁力线如何从流体中“滑移”并改变其拓扑结构，是理解磁重联等关键物理过程的基础。这个过程的核心机制是沿着磁场方向存在一个非零的平行电场分量$E_{\\parallel}$。本练习  旨在超越简单的电阻效应，深入探讨磁拓扑变化的根本原因，这对于理解聚变和天体物理等离子体中的多种现象至关重要。",
            "id": "4053014",
            "problem": "在一个代表聚变工程的环形等离子体装置中，考虑一个薄的物质环路$\\mathcal{C}(t)$，它是一个物质表面$\\mathcal{S}(t)$的边界。该表面由相同的标记等离子体元构成，并以局域等离子体速度$\\mathbf{v}(\\mathbf{x},t)$运动。该环路被磁场$\\mathbf{B}(\\mathbf{x},t)$的磁场线穿过，并受到电场$\\mathbf{E}(\\mathbf{x},t)$的作用。使用Faraday感应定律和运动轮廓的运动学，评估磁场线足点保持附着于$\\mathcal{C}(t)$的条件，以及它们何时会相对于运动物质发生滑移，并明确参考$\\mathbf{E}$平行于$\\mathbf{B}$的分量，记为$\\mathbf{E}_{\\parallel} \\equiv (\\mathbf{E}\\cdot\\hat{\\mathbf{b}})\\,\\hat{\\mathbf{b}}$，其中$\\hat{\\mathbf{b}} = \\mathbf{B}/|\\mathbf{B}|$。假设磁流体力学 (MHD) 及其扩展理论有效，并允许存在非理想效应。\n\n哪个陈述是正确的？\n\nA. 对于一个以速度$\\mathbf{v}$运动的物质环路，磁足点保持附着的充要条件是，沿着每一条穿过$\\mathcal{C}(t)$的磁场线，平行电场的线积分消失，即$\\int_{\\text{field line}} \\mathbf{E}\\cdot\\hat{\\mathbf{b}}\\,\\mathrm{d}\\ell = 0$。在这种情况下，穿过随动环路的磁通量满足$\\mathrm{d}\\Phi/\\mathrm{d}t = -\\oint_{\\mathcal{C}(t)} (\\mathbf{E}+\\mathbf{v}\\times\\mathbf{B})\\cdot \\mathrm{d}\\boldsymbol{\\ell} = 0$，且足点保持附着。滑移发生的位置和程度，恰好取决于非理想区域中$\\int_{\\text{field line}} \\mathbf{E}_{\\parallel}\\,\\mathrm{d}\\ell \\neq 0$的情况。\n\nB. 如果$\\nabla\\times \\mathbf{E}_{\\parallel} = \\mathbf{0}$，那么根据Faraday定律，平行电场不能改变磁通量；因此，即使沿磁场线的积分$\\int \\mathbf{E}_{\\parallel}\\cdot \\mathrm{d}\\boldsymbol{\\ell} \\neq 0$，足点也保持附着。\n\nC. 磁冻结条件仅由垂直分量$\\mathbf{E}_{\\perp}$决定；只要$\\lvert \\mathbf{E}_{\\perp} \\rvert  \\lvert \\mathbf{v} \\times \\mathbf{B} \\rvert$，无论$\\mathbf{E}_{\\parallel}$如何，足点都保持附着。\n\nD. 在霍尔磁流体力学 (Hall MHD) 中，即使存在有限的$\\mathbf{E}_{\\parallel}$，也不会导致磁足点相对于离子流体发生滑移；磁场线严格地冻结在离子速度$\\mathbf{v}_{i}$中。",
            "solution": "### 问题验证\n\n#### 第1步：提取已知条件\n- **系统：** 聚变工程中的环形等离子体装置。\n- **物体与运动：** 一个薄的物质环路$\\mathcal{C}(t)$是一个物质表面$\\mathcal{S}(t)$的边界。两者都由等离子体元构成，并以局域等离子体速度$\\mathbf{v}(\\mathbf{x},t)$运动。\n- **场：** 磁场$\\mathbf{B}(\\mathbf{x},t)$和电场$\\mathbf{E}(\\mathbf{x},t)$。\n- **定义：** $\\mathbf{E}$平行于$\\mathbf{B}$的分量是$\\mathbf{E}_{\\parallel} \\equiv (\\mathbf{E}\\cdot\\hat{\\mathbf{b}})\\,\\hat{\\mathbf{b}}$，其中$\\hat{\\mathbf{b}} = \\mathbf{B}/|\\mathbf{B}|$。\n- **基本原理：** Faraday感应定律、运动轮廓的运动学、磁流体力学 (MHD) 及其扩展理论均有效。\n- **关键条件：** 允许存在非理想效应。\n- **问题：** 评估磁场线足点相对于物质环路$\\mathcal{C}(t)$附着（磁冻结）和滑移的条件，并特别参考$\\mathbf{E}_{\\parallel}$。\n\n#### 第2步：使用提取的已知条件进行验证\n1.  **科学依据充分：** 该问题牢固地植根于等离子体物理学和磁流体力学的基本原理。它涉及Faraday定律、物质环路的概念、磁通量、磁冻结条件（Alfvén定理）以及非理想效应（导致磁重联）。这些是聚变等离子体物理学中的标准和关键概念。\n2.  **问题定义明确：** 问题要求阐述控制一个明确现象（磁场线的滑移）的物理条件。所提供的信息足以从第一性原理推导出这些条件。可以得出一个唯一且有意义的物理结论。\n3.  **客观性：** 问题采用精确、标准的科学术语进行表述。没有主观或含糊不清的陈述。\n\n#### 第3步：结论与行动\n问题陈述在科学上是合理的、定义明确且客观的。它不包含任何使其无效的缺陷。因此，该问题是**有效的**。我将继续进行推导和求解。\n\n### 推导\n\n分析始于穿过物质表面$\\mathcal{S}(t)$的磁通量$\\Phi$，该物质表面的边界是物质环路$\\mathcal{C}(t)$。\n磁通量定义为：\n$$ \\Phi(t) = \\int_{\\mathcal{S}(t)} \\mathbf{B}(\\mathbf{x}, t) \\cdot d\\mathbf{A} $$\n对于一个以速度$\\mathbf{v}$运动的曲面，该通量的变化率由曲面的Reynolds输运定理（也称为运动曲面的Leibniz积分法则）给出：\n$$ \\frac{d\\Phi}{dt} = \\int_{\\mathcal{S}(t)} \\left( \\frac{\\partial \\mathbf{B}}{\\partial t} - \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) \\right) \\cdot d\\mathbf{A} $$\n我们使用Faraday感应定律$\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$来替换$\\mathbf{B}$的时间导数：\n$$ \\frac{d\\Phi}{dt} = \\int_{\\mathcal{S}(t)} \\left( -(\\nabla \\times \\mathbf{E}) - \\nabla \\times (\\mathbf{v} \\times \\mathbf{B}) \\right) \\cdot d\\mathbf{A} = - \\int_{\\mathcal{S}(t)} \\nabla \\times (\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot d\\mathbf{A} $$\n应用Stokes定理，我们将对$\\mathcal{S}(t)$的面积分转换为沿其边界，即物质环路$\\mathcal{C}(t)$的线积分：\n$$ \\frac{d\\Phi}{dt} = - \\oint_{\\mathcal{C}(t)} (\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot d\\boldsymbol{\\ell} $$\n矢量$\\mathbf{E}' = \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}$是在随等离子体运动的局域参考系中的电场。因此，穿过物质环路的磁通量变化率等于在随动参考系中测量的环路电动势 (EMF) 的负值。\n\n磁场线“冻结”或“附着”于等离子体的概念意味着穿过任何物质环路的磁通量都是守恒的，即$\\frac{d\\Phi}{dt} = 0$。这意味着相对于流体元的磁拓扑是保持不变的。对于任何环路$\\mathcal{C}(t)$，条件$\\frac{d\\Phi}{dt} = 0$要求被积函数在局域为零（或者是某个标量势的梯度）。最简单和最普遍的条件是理想欧姆定律：\n$$ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0} $$\n这个矢量方程可以分解为平行于和垂直于$\\mathbf{B}$的分量：\n1.  平行分量：$(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot \\hat{\\mathbf{b}} = \\mathbf{E} \\cdot \\hat{\\mathbf{b}} = E_{\\parallel} = 0$。\n2.  垂直分量：$\\mathbf{E}_{\\perp} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$。\n\n磁足点的滑移是磁场拓扑变化的一种形象化描述。这个过程被称为磁重联。它发生在磁冻结条件被破坏时，即当$\\frac{d\\Phi}{dt} \\neq 0$。这要求$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} \\neq \\mathbf{0}$。这个非零项源于非理想效应，例如电阻率($\\eta \\mathbf{J}$)、霍尔效应($\\frac{1}{ne}\\mathbf{J}\\times\\mathbf{B}$)或电子压力梯度($-\\frac{1}{ne}\\nabla p_e$)。\n\n现代磁重联理论的一个核心原则是，磁连接性的改变需要沿磁场线存在非零的电势降。该电势降由平行电场的线积分给出：\n$$ V_{\\parallel} = \\int_{\\text{field line}} \\mathbf{E} \\cdot d\\boldsymbol{\\ell} = \\int_{\\text{field line}} E_{\\parallel} d\\ell $$\n在理想MHD中，处处有$E_{\\parallel}=0$，因此$V_{\\parallel} = 0$，重联是被禁止的。在具有非理想效应的真实等离子体中，一个局域区域可以支持有限的$E_{\\parallel}$，从而导致非零的$V_{\\parallel}$。这个“重联电压”决定了磁场线断开并以新拓扑重新连接的速率，这正是足点滑移的现象。因此，足点保持附着的条件是，对于所有穿过环路的磁场线，都有$\\int E_{\\parallel} d\\ell = 0$。当、何处以及何种程度上这个积分为非零，就会发生滑移。\n\n### 逐项分析\n\n**A. 对于一个以速度$\\mathbf{v}$运动的物质环路，磁足点保持附着的充要条件是，沿着每一条穿过$\\mathcal{C}(t)$的磁场线，平行电场的线积分消失，即$\\int_{\\text{field line}} \\mathbf{E}\\cdot\\hat{\\mathbf{b}}\\,\\mathrm{d}\\ell = 0$。在这种情况下，穿过随动环路的磁通量满足$\\mathrm{d}\\Phi/\\mathrm{d}t = -\\oint_{\\mathcal{C}(t)} (\\mathbf{E}+\\mathbf{v}\\times\\mathbf{B})\\cdot \\mathrm{d}\\boldsymbol{\\ell} = 0$，且足点保持附着。滑移发生的位置和程度，恰好取决于非理想区域中$\\int_{\\text{field line}} \\mathbf{E}_{\\parallel}\\,\\mathrm{d}\\ell \\neq 0$的情况。**\n\n该陈述与我们的推导完全一致。它正确地指出了积分平行电场为零是维持磁拓扑（无滑移）的充要条件。它正确地说明了如果足点附着，穿过随动环路的磁通量是守恒的（$\\frac{d\\Phi}{dt}=0$），并正确地给出了该变化率的积分表达式。最后，它准确地描述了滑移是由非零的积分平行电场引起的，且与其成正比，而这种电场只能存在于非理想区域。\n**结论：正确。**\n\n**B. 如果$\\nabla\\times \\mathbf{E}_{\\parallel} = \\mathbf{0}$，那么根据Faraday定律，平行电场不能改变磁通量；因此，即使沿磁场线的积分$\\int \\mathbf{E}_{\\parallel}\\cdot \\mathrm{d}\\boldsymbol{\\ell} \\neq 0$，足点也保持附着。**\n\n这个陈述是有缺陷的。首先，Faraday定律关联的是$\\frac{\\partial \\mathbf{B}}{\\partial t}$与$\\nabla \\times \\mathbf{E} = \\nabla \\times (\\mathbf{E}_{\\parallel} + \\mathbf{E}_{\\perp})$，而不仅仅是$\\nabla \\times \\mathbf{E}_{\\parallel}$。不能以这种方式孤立其贡献。其次，更关键的是，即使$\\int E_{\\parallel} d\\ell \\neq 0$，足点也保持附着的结论是根本错误的。正如所推导的，非零的$E_{\\parallel}$线积分正是驱动磁拓扑变化（即足点滑移）的重联电压的定义。\n**结论：不正确。**\n\n**C. 磁冻结条件仅由垂直分量$\\mathbf{E}_{\\perp}$决定；只要$\\lvert \\mathbf{E}_{\\perp} \\rvert  \\lvert \\mathbf{v} \\times \\mathbf{B} \\rvert$，无论$\\mathbf{E}_{\\parallel}$如何，足点都保持附着。**\n\n这是不正确的。磁冻结条件$\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$是一个矢量方程，必须对平行和垂直分量都成立。具体来说，它要求$E_{\\parallel}=0$。该陈述声称条件“仅由垂直分量”决定，并且“无论$\\mathbf{E}_{\\parallel}$如何”都能防止滑移，这是错误的。非零的$\\mathbf{E}_{\\parallel}$直接违反了理想条件，并且正是它使重联成为可能。此外，关于大小的条件$\\lvert \\mathbf{E}_{\\perp} \\rvert  \\lvert \\mathbf{v} \\times \\mathbf{B} \\rvert$并非正确条件；理想条件是矢量等式$\\mathbf{E}_{\\perp} = - \\mathbf{v} \\times \\mathbf{B}$。\n**结论：不正确。**\n\n**D. 在霍尔磁流体力学 (Hall MHD) 中，即使存在有限的$\\mathbf{E}_{\\parallel}$，也不会导致磁足点相对于离子流体发生滑移；磁场线严格地冻结在离子速度$\\mathbf{v}_{i}$中。**\n\n该陈述包含一个关于霍尔MHD的根本性错误。在霍尔MHD模型中，感应方程的形式为$\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v}_e \\times \\mathbf{B})$，其中$\\mathbf{v}_e$是电子流体速度。这意味着磁场线冻结在*电子流体*中，而不是离子流体（$\\mathbf{v}_i$）中。速度差$\\mathbf{v}_i - \\mathbf{v}_e = \\mathbf{J}/(ne)$代表了离子流体相对于磁场的滑移。关于场线冻结在离子中的断言是不正确的。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在计算磁流体力学中，准确地模拟磁场的平流是一个重要且具有挑战性的任务。与简单的被动标量不同，磁场作为一个矢量场，其演化不仅包含平移，还受到流场梯度的拉伸和旋转效应，这正是磁冻结定律的体现。本计算基准测试练习  将指导您推导一个剪切流中磁场演化的精确解析解，并用它来量化一种简化的数值平流模型所产生的误差，从而为MHD代码的开发与验证提供深刻的实践见解。",
            "id": "4053049",
            "problem": "考虑由麦克斯韦-法拉第方程和理想欧姆定律定义的不可压理想磁流体动力学 (MHD)。相关基本原理包括：麦克斯韦-法拉第方程$ \\nabla \\times \\mathbf{E} = - \\partial_t \\mathbf{B} $，理想欧姆定律$ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0} $，以及不可压流的质量守恒$ \\nabla \\cdot \\mathbf{v} = 0 $。对于无磁源的静磁学，无散约束$ \\nabla \\cdot \\mathbf{B} = 0 $成立。在理想极限下，磁场线应被冻结于流体运动中。\n\n您的任务是为一个二维周期性方形区域中的剪切平流设计一个计算基准，其中存在解析解可用于验证冻结行为。速度场为线性剪切，由$ \\mathbf{v}(x,y) = (\\gamma y, 0) $给出，其中$ \\gamma $是一个单位为$\\mathrm{s}^{-1}$的恒定剪切率。区域为$ [0, L) \\times [0, L) $，在两个方向上均具有周期性边界条件，其中$ L $的单位为$\\mathrm{m}$。\n\n您的任务是：\n\n- 从上述基本定律和定义出发，推导在此剪切流的理想假设下磁场的解析演化，以从初始坐标$ \\mathbf{a} $到当前坐标$ \\mathbf{x} $的流映射以及相关的形变梯度表示。不要使用或引用任何已特化于此结果的捷径公式；相反，应从提供的基本原理出发推导结果。清晰陈述推导所需的假设，包括对$ \\nabla \\cdot \\mathbf{v} $和$ \\nabla \\cdot \\mathbf{B} $的任何约束。\n\n- 实现一个数值模型，在给定时间$ t $计算以下两者：\n  1. 从您的推导中获得的解析演化磁场（不可压剪切下的冻结推前）。\n  2. 一个朴素的被动平流模型，该模型将磁场分量视为由流输运的独立被动标量，而不考虑由速度梯度引起的任何拉伸或旋转。\n\n- 通过计算区域上的相对$L^2$误差来量化朴素被动平流模型与解析正确的冻结演化之间的差异，该误差定义为\n$$\n\\varepsilon = \\sqrt{\\frac{\\sum_{i,j} \\left( \\left[B_x^{\\mathrm{naive}}(x_i,y_j,t) - B_x^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 + \\left[B_y^{\\mathrm{naive}}(x_i,y_j,t) - B_y^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 \\right)}{\\sum_{i,j} \\left( \\left[B_x^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 + \\left[B_y^{\\mathrm{analytic}}(x_i,y_j,t)\\right]^2 \\right)}} \\, .\n$$\n\n使用逆流映射$ \\mathbf{a}(\\mathbf{x},t) $在适当的拉格朗日标签上评估初始条件，并通过在评估三角函数之前将坐标对$ L $取模来强制周期性。三角函数评估中的所有角度必须以弧度为单位。\n\n初始条件和测试套件：\n\n- 使用标量势$A_z(\\mathbf{a})$定义一个无散初始磁场，使得$ \\mathbf{B}_0(\\mathbf{a}) = \\nabla \\times \\left( A_z(\\mathbf{a}) \\, \\hat{\\mathbf{z}} \\right) $。使用以下选择\n$$\nA_z(\\mathbf{a}) = \\frac{B_\\star}{k} \\sin\\left(k a_x\\right) \\sin\\left(k a_y\\right) \\, ,\n$$\n其中$ B_\\star $的单位为$\\mathrm{T}$，$ k $的单位为$\\mathrm{rad}\\,\\mathrm{m}^{-1}$，因此\n$$\nB_{0x}(\\mathbf{a}) = B_\\star \\sin\\left(k a_x\\right) \\cos\\left(k a_y\\right) \\, , \\quad B_{0y}(\\mathbf{a}) = - B_\\star \\cos\\left(k a_x\\right) \\sin\\left(k a_y\\right) \\, .\n$$\n同时包括一个均匀初始场情况$ \\mathbf{B}_0(\\mathbf{a}) = (0, B_\\star) $，其中$ B_\\star $为常数。\n\n- 使用边长为$L$的周期性方形区域，以及一个$N \\times N$点的均匀笛卡尔网格。为实现周期性，请在$ \\mathbf{a}(\\mathbf{x},t) $的每个方向上对$L$取模后评估初始条件。\n\n- 为以下每个测试用例提供相对$L^2$误差$ \\varepsilon $ (这些用例共同构成测试套件)：\n  1. 情况 A (理想情况，剪切下的恒定场): $ L = 1.0 \\, \\mathrm{m} $, $ N = 128 $, $ \\gamma = 1.0 \\, \\mathrm{s}^{-1} $, $ t = 0.3 \\, \\mathrm{s} $, $ B_\\star = 0.7 \\, \\mathrm{T} $。使用均匀初始场$ \\mathbf{B}_0 = (0, B_\\star) $。\n  2. 情况 B (无散正弦初始场): $ L = 1.0 \\, \\mathrm{m} $, $ N = 128 $, $ \\gamma = 0.6 \\, \\mathrm{s}^{-1} $, $ t = 0.5 \\, \\mathrm{s} $, $ B_\\star = 0.5 \\, \\mathrm{T} $, $ k = \\frac{2\\pi}{L} \\, \\mathrm{rad}\\,\\mathrm{m}^{-1} $。使用上面定义的无散初始场。\n  3. 情况 C (零时刻情况): 参数与情况 B 相同，但$ t = 0.0 \\, \\mathrm{s} $。\n  4. 情况 D (零剪切的边缘情况): 参数与情况 B 相同，但$ \\gamma = 0.0 \\, \\mathrm{s}^{-1} $。\n\n单位和角度规范：\n\n- 距离$L$的单位是$\\mathrm{m}$，剪切率$\\gamma$的单位是$\\mathrm{s}^{-1}$，时间$t$的单位是$\\mathrm{s}$，磁场振幅$B_\\star$的单位是$\\mathrm{T}$，波数$k$的单位是$\\mathrm{rad}\\,\\mathrm{m}^{-1}$。所有三角函数的参数都必须是弧度。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含情况 A、B、C 和 D 的相对$L^2$误差，形式为方括号括起来的逗号分隔列表，例如$ [e_A, e_B, e_C, e_D] $。每个条目必须是一个浮点数。将每个条目表示为四舍五入到八位小数的无量纲浮点数。\n\n不需要用户输入；所有参数均已在上面指定，并且必须进行硬编码。您的实现应该是独立完整的，并可在任何具有标准数值库的现代编程环境中执行。",
            "solution": "该问题要求推导理想、不可压剪切流中磁场演化的解析解，并将其与一个朴素的被动平流模型进行比较。对问题陈述的验证已确认其科学上的合理性、完整性和清晰性。我们现在进行形式推导和数值实现的设计。\n\n### 第1部分：解析磁场演化（冻结定律）的推导\n\n理想导电流体中磁场$ \\mathbf{B} $的演化由麦克斯韦-法拉第方程和理想欧姆定律共同决定。\n\n提供的基本方程是：\n1.  麦克斯韦-法拉第方程: $ \\nabla \\times \\mathbf{E} = - \\partial_t \\mathbf{B} $\n2.  理想欧姆定律: $ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0} $\n3.  流的不可压条件: $ \\nabla \\cdot \\mathbf{v} = 0 $\n4.  磁场的无散约束: $ \\nabla \\cdot \\mathbf{B} = 0 $\n\n根据欧姆定律，我们将电场表示为$ \\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B} $。将其代入麦克斯韦-法拉第方程，得到理想感应方程：\n$$\n\\partial_t \\mathbf{B} = - \\nabla \\times (-\\mathbf{v} \\times \\mathbf{B}) = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B})\n$$\n我们使用矢量微积分恒等式$ \\nabla \\times (\\mathbf{A} \\times \\mathbf{C}) = (\\mathbf{C} \\cdot \\nabla) \\mathbf{A} - (\\mathbf{A} \\cdot \\nabla) \\mathbf{C} + \\mathbf{A}(\\nabla \\cdot \\mathbf{C}) - \\mathbf{C}(\\nabla \\cdot \\mathbf{A}) $。将$ \\mathbf{A} $等同于$ \\mathbf{v} $，将$ \\mathbf{C} $等同于$ \\mathbf{B} $，我们展开旋度项：\n$$\n\\partial_t \\mathbf{B} = (\\mathbf{B} \\cdot \\nabla) \\mathbf{v} - (\\mathbf{v} \\cdot \\nabla) \\mathbf{B} + \\mathbf{v}(\\nabla \\cdot \\mathbf{B}) - \\mathbf{B}(\\nabla \\cdot \\mathbf{v})\n$$\n应用给定的约束条件$ \\nabla \\cdot \\mathbf{v} = 0 $和$ \\nabla \\cdot \\mathbf{B} = 0 $，方程简化为：\n$$\n\\partial_t \\mathbf{B} + (\\mathbf{v} \\cdot \\nabla) \\mathbf{B} = (\\mathbf{B} \\cdot \\nabla) \\mathbf{v}\n$$\n左侧是磁场的物质导数$ \\frac{D\\mathbf{B}}{Dt} $，它描述了随流体微元移动的观察者所看到的$ \\mathbf{B} $的变化率。因此，我们有：\n$$\n\\frac{D\\mathbf{B}}{Dt} = (\\mathbf{B} \\cdot \\nabla) \\mathbf{v}\n$$\n项$ (\\mathbf{B} \\cdot \\nabla) \\mathbf{v} $表示速度梯度张量$ \\nabla\\mathbf{v} $对场的拉伸和旋转。让我们用分量形式表示它。第$i$个分量是$ \\frac{DB_i}{Dt} = \\sum_j B_j \\frac{\\partial v_i}{\\partial x_j} $。用矩阵形式表示为$ \\frac{D\\mathbf{B}}{Dt} = (\\nabla\\mathbf{v})\\mathbf{B} $。\n\n为求解此方程，我们考虑在拉格朗日框架中的演化。设$ \\mathbf{a} $是一个流体微元在时间$ t=0 $时的初始位置，设$ \\mathbf{x} = \\mathbf{\\Phi}(\\mathbf{a}, t) $是其在时间$ t $的位置。形变梯度张量定义为$ \\mathbf{F}(\\mathbf{a}, t) $，其分量为$ F_{ij} = \\frac{\\partial x_i}{\\partial a_j} $。$ \\mathbf{F} $的演化由$ \\frac{D\\mathbf{F}}{Dt} = (\\nabla\\mathbf{v})\\mathbf{F} $给出。在拉格朗日框架中，这是$ \\frac{\\partial \\mathbf{F}}{\\partial t}\\Big|_{\\mathbf{a}} = (\\nabla\\mathbf{v})\\mathbf{F} $。\n\n设$ \\tilde{\\mathbf{B}}(\\mathbf{a}, t) = \\mathbf{B}(\\mathbf{\\Phi}(\\mathbf{a}, t), t) $是最初位于$ \\mathbf{a} $的流体微元的磁场矢量。物质导数则为$ \\frac{D\\mathbf{B}}{Dt} = \\frac{\\partial \\tilde{\\mathbf{B}}}{\\partial t}\\Big|_{\\mathbf{a}} $。在此框架下，感应方程变为：\n$$\n\\frac{\\partial \\tilde{\\mathbf{B}}}{\\partial t}\\Big|_{\\mathbf{a}} = (\\nabla\\mathbf{v}) \\tilde{\\mathbf{B}}\n$$\n我们观察到，对于一个固定的微元$ \\mathbf{a} $，$ \\tilde{\\mathbf{B}} $和$ \\mathbf{F} $在时间上满足形式上相同的线性常微分方程。让我们构造一个量$ \\mathbf{C}(\\mathbf{a}, t) = \\mathbf{F}^{-1}(\\mathbf{a}, t) \\tilde{\\mathbf{B}}(\\mathbf{a}, t) $并证明它在时间上是守恒的。\n$$\n\\frac{\\partial \\mathbf{C}}{\\partial t} = \\frac{\\partial \\mathbf{F}^{-1}}{\\partial t}\\tilde{\\mathbf{B}} + \\mathbf{F}^{-1}\\frac{\\partial \\tilde{\\mathbf{B}}}{\\partial t}\n$$\n使用恒等式$ \\frac{\\partial \\mathbf{F}^{-1}}{\\partial t} = -\\mathbf{F}^{-1} \\frac{\\partial \\mathbf{F}}{\\partial t} \\mathbf{F}^{-1} $并代入$ \\tilde{\\mathbf{B}} $和$ \\mathbf{F} $的演化方程：\n$$\n\\frac{\\partial \\mathbf{C}}{\\partial t} = \\left( -\\mathbf{F}^{-1} (\\nabla\\mathbf{v})\\mathbf{F} \\mathbf{F}^{-1} \\right) \\tilde{\\mathbf{B}} + \\mathbf{F}^{-1} \\left( (\\nabla\\mathbf{v}) \\tilde{\\mathbf{B}} \\right) = -\\mathbf{F}^{-1}(\\nabla\\mathbf{v})\\tilde{\\mathbf{B}} + \\mathbf{F}^{-1}(\\nabla\\mathbf{v})\\tilde{\\mathbf{B}} = \\mathbf{0}\n$$\n因此，$ \\mathbf{C}(\\mathbf{a}, t) $在时间上是恒定的。我们可以在$ t=0 $时对其求值：\n$$\n\\mathbf{C}(\\mathbf{a}, t) = \\mathbf{C}(\\mathbf{a}, 0) = \\mathbf{F}^{-1}(\\mathbf{a}, 0) \\tilde{\\mathbf{B}}(\\mathbf{a}, 0)\n$$\n在$ t=0 $时，$ \\mathbf{x}=\\mathbf{a} $，所以形变梯度是单位矩阵$ \\mathbf{F}(\\mathbf{a}, 0) = \\mathbf{I} $，且$ \\tilde{\\mathbf{B}}(\\mathbf{a}, 0) = \\mathbf{B}(\\mathbf{a}, 0) \\equiv \\mathbf{B}_0(\\mathbf{a}) $。\n因此，$ \\mathbf{C}(\\mathbf{a}, t) = \\mathbf{I}^{-1} \\mathbf{B}_0(\\mathbf{a}) = \\mathbf{B}_0(\\mathbf{a}) $。\n\n从$ \\mathbf{B}_0(\\mathbf{a}) = \\mathbf{F}^{-1}(\\mathbf{a}, t) \\tilde{\\mathbf{B}}(\\mathbf{a}, t) $，我们找到$ \\tilde{\\mathbf{B}} $的解：\n$$\n\\tilde{\\mathbf{B}}(\\mathbf{a}, t) = \\mathbf{F}(\\mathbf{a}, t) \\mathbf{B}_0(\\mathbf{a})\n$$\n转换回欧拉坐标$ (\\mathbf{x}, t) $，其中$ \\mathbf{a} = \\mathbf{\\Phi}^{-1}(\\mathbf{x}, t) $是所需的拉格朗日标签：\n$$\n\\mathbf{B}(\\mathbf{x}, t) = \\mathbf{F}(\\mathbf{\\Phi}^{-1}(\\mathbf{x}, t), t) \\cdot \\mathbf{B}_0(\\mathbf{\\Phi}^{-1}(\\mathbf{x}, t))\n$$\n这就是根据指定的基准定律和假设，在冻结条件下推导出的演化磁场的解析表达式。\n\n### 第2部分：应用于线性剪切流\n\n我们现在将这个一般结果应用于指定的二维线性剪切流$ \\mathbf{v}(x, y) = (\\gamma y, 0) $。\n流体微元的轨迹可通过积分$ \\frac{d\\mathbf{x}}{dt} = \\mathbf{v}(\\mathbf{x}) $找到，初始条件为$ \\mathbf{x}(0) = \\mathbf{a} = (a_x, a_y) $。\n$$\n\\frac{dx}{dt} = \\gamma y \\quad ; \\quad \\frac{dy}{dt} = 0\n$$\n积分第二个方程得到$ y(t) = a_y $。将此代入第一个方程得到$ \\frac{dx}{dt} = \\gamma a_y $，积分后得$ x(t) = a_x + \\gamma t a_y $。\n流映射为$ \\mathbf{x}(\\mathbf{a}, t) = (a_x + \\gamma t a_y, a_y) $。\n\n逆流映射$ \\mathbf{a}(\\mathbf{x}, t) $通过给定$ \\mathbf{x}=(x,y) $求解$ \\mathbf{a} $得到：\n$$\na_y = y \\quad ; \\quad a_x = x - \\gamma t a_y = x - \\gamma t y\n$$\n形变梯度张量$ F_{ij} = \\frac{\\partial x_i}{\\partial a_j} $为：\n$$\n\\mathbf{F}(\\mathbf{a}, t) = \\begin{pmatrix} \\frac{\\partial x}{\\partial a_x}  \\frac{\\partial x}{\\partial a_y} \\\\ \\frac{\\partial y}{\\partial a_x}  \\frac{\\partial y}{\\partial a_y} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial a_x}(a_x + \\gamma t a_y)  \\frac{\\partial}{\\partial a_y}(a_x + \\gamma t a_y) \\\\ \\frac{\\partial}{\\partial a_x}(a_y)  \\frac{\\partial}{\\partial a_y}(a_y) \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma t \\\\ 0  1 \\end{pmatrix}\n$$\n注意$ \\mathbf{F} $与位置$ \\mathbf{a} $无关。解析正确的演化场为：\n$$\n\\mathbf{B}^{\\mathrm{analytic}}(\\mathbf{x}, t) = \\begin{pmatrix} 1  \\gamma t \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} B_{0x}(a_x, a_y) \\\\ B_{0y}(a_x, a_y) \\end{pmatrix}\n$$\n其中$ (a_x, a_y) = (x - \\gamma t y, y) $。用分量形式表示：\n$$\nB_x^{\\mathrm{analytic}}(x, y, t) = B_{0x}(x - \\gamma t y, y) + \\gamma t \\, B_{0y}(x - \\gamma t y, y)\n$$\n$$\nB_y^{\\mathrm{analytic}}(x, y, t) = B_{0y}(x - \\gamma t y, y)\n$$\n\n### 第3部分：朴素被动平流模型\n\n朴素模型将磁场的每个分量$ B_x $和$ B_y $视为独立的被动标量。被动标量$ S $的演化由$ \\frac{DS}{Dt} = \\partial_t S + (\\mathbf{v} \\cdot \\nabla)S = 0 $给出。这意味着标量值只是沿着流的轨迹平流，即$ S(\\mathbf{x}, t) = S_0(\\mathbf{a}) $，其中$ S_0 $是初始条件，$ \\mathbf{a} = \\mathbf{\\Phi}^{-1}(\\mathbf{x}, t) $。\n将此应用于$ B_x $和$ B_y $：\n$$\nB_x^{\\mathrm{naive}}(x, y, t) = B_{0x}(a_x, a_y) = B_{0x}(x - \\gamma t y, y)\n$$\n$$\nB_y^{\\mathrm{naive}}(x, y, t) = B_{0y}(a_x, a_y) = B_{0y}(x - \\gamma t y, y)\n$$\n这个模型错误地忽略了$ B_x $分量中的拉伸项$ \\gamma t \\, B_{0y} $，该项源于垂直磁场分量被剪切成水平分量。\n\n### 第4部分：数值实现计划\n\n计算任务是在离散网格上评估解析模型和朴素模型之间的相对$ L^2 $误差。\n\n1.  **网格设置：** 在区域$ [0, L) \\times [0, L) $上定义一个$ N \\times N $点的均匀笛卡尔网格$ (x_i, y_j) $。坐标为$ x_i = i L/N $和$ y_j = j L/N $，其中$ i, j \\in \\{0, 1, ..., N-1\\} $。\n\n2.  **求值循环：** 对于每个网格点$ (x_i, y_j) $:\n    a. 计算拉格朗日坐标：$ a_x = x_i - \\gamma t y_j $和$ a_y = y_j $。\n    b. 对拉格朗日坐标应用周期性边界条件。初始条件以$ L $为周期，因此我们在$ a_x^{\\mathrm{p}} = a_x \\pmod L $和$ a_y^{\\mathrm{p}} = a_y \\pmod L $处对其求值。\n    c. 使用均匀或正弦情况的指定函数，评估初始磁场分量$ B_{0x}(a_x^{\\mathrm{p}}, a_y^{\\mathrm{p}}) $和$ B_{0y}(a_x^{\\mathrm{p}}, a_y^{\\mathrm{p}}) $。\n    d. 计算在$ (x_i, y_j, t) $处的解析场分量：$ B_x^{\\mathrm{analytic}} = B_{0x} + \\gamma t B_{0y} $和$ B_y^{\\mathrm{analytic}} = B_{0y} $。\n    e. 计算朴素场分量：$ B_x^{\\mathrm{naive}} = B_{0x} $和$ B_y^{\\mathrm{naive}} = B_{0y} $。\n\n3.  **误差计算：** 在整个网格上计算场分量后，相对$ L^2 $误差$ \\varepsilon $按如下方式计算：\n    $$\n    \\varepsilon = \\sqrt{\\frac{\\sum_{i,j=0}^{N-1} \\left( [B_x^{\\mathrm{naive}} - B_x^{\\mathrm{analytic}}]^2 + [B_y^{\\mathrm{naive}} - B_y^{\\mathrm{analytic}}]^2 \\right) }{\\sum_{i,j=0}^{N-1} \\left( [B_x^{\\mathrm{analytic}}]^2 + [B_y^{\\mathrm{analytic}}]^2 \\right)}}\n    $$\n    分子中的差简化为：\n    $ [B_x^{\\mathrm{naive}} - B_x^{\\mathrm{analytic}}]^2 = [B_{0x} - (B_{0x} + \\gamma t B_{0y})]^2 = (-\\gamma t B_{0y})^2 $。\n    $ [B_y^{\\mathrm{naive}} - B_y^{\\mathrm{analytic}}]^2 = [B_{0y} - B_{0y}]^2 = 0 $。\n    分子和为$ \\sum_{i,j} (\\gamma t B_{0y})^2 $。分母是解析场分量的平方和$ \\sum_{i,j} ( (B_{0x} + \\gamma t B_{0y})^2 + B_{0y}^2 ) $。实现将计算这些和，并求其比值的平方根。分母为零（例如$ \\mathbf{B}_0 = \\mathbf{0} $）导致未定义误差的特殊情况在测试套件中不存在。对于$t=0$或$\\gamma=0$，分子为零，得出$\\varepsilon=0$。\n将为每个提供的测试用例实施此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative L2 error between a naive passive-advection model and the\n    analytically correct frozen-in evolution of a magnetic field in a shear flow.\n    \"\"\"\n\n    def calculate_error(L, N, gamma, t, B_star, k, initial_field_type):\n        \"\"\"\n        Calculates the relative L2 error for a single test case.\n\n        Args:\n            L (float): Domain side length [m].\n            N (int): Number of grid points per dimension.\n            gamma (float): Shear rate [s^-1].\n            t (float): Time [s].\n            B_star (float): Magnetic field amplitude [T].\n            k (float): Wavenumber [rad/m].\n            initial_field_type (str): 'uniform' or 'sinusoidal'.\n\n        Returns:\n            float: The relative L2 error.\n        \"\"\"\n        # 1. Set up the grid\n        grid_coords = np.linspace(0, L, N, endpoint=False)\n        x, y = np.meshgrid(grid_coords, grid_coords)\n\n        # 2. Compute Lagrangian coordinates (inverse flow map)\n        a_x = x - gamma * t * y\n        a_y = y\n\n        # 3. Apply periodic boundary conditions to Lagrangian coordinates\n        a_x_periodic = a_x % L\n        a_y_periodic = a_y % L\n\n        # 4. Evaluate initial magnetic field B0 at Lagrangian coordinates\n        if initial_field_type == 'uniform':\n            B_0x = np.zeros_like(a_x_periodic)\n            B_0y = np.full_like(a_y_periodic, B_star)\n        elif initial_field_type == 'sinusoidal':\n            B_0x = B_star * np.sin(k * a_x_periodic) * np.cos(k * a_y_periodic)\n            B_0y = -B_star * np.cos(k * a_x_periodic) * np.sin(k * a_y_periodic)\n        else:\n            raise ValueError(\"Invalid initial_field_type\")\n\n        # 5. Compute analytic and naive field components\n        # Analytic field (frozen-in pushforward)\n        B_x_analytic = B_0x + gamma * t * B_0y\n        B_y_analytic = B_0y\n\n        # Naive field (passive scalar advection)\n        B_x_naive = B_0x\n        B_y_naive = B_0y\n\n        # 6. Calculate L2 error\n        # Numerator: sum of squared differences\n        diff_sq_sum = np.sum((B_x_naive - B_x_analytic)**2 + (B_y_naive - B_y_analytic)**2)\n\n        # Denominator: sum of squared analytic field components\n        analytic_norm_sq_sum = np.sum(B_x_analytic**2 + B_y_analytic**2)\n\n        if analytic_norm_sq_sum == 0.0:\n            # This can happen if the initial field is zero everywhere.\n            # If the difference is also zero, the error is 0. Otherwise it's undefined (inf).\n            return 0.0 if diff_sq_sum == 0.0 else np.inf\n\n        error = np.sqrt(diff_sq_sum / analytic_norm_sq_sum)\n        return error\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case A: uniform field\n        {'L': 1.0, 'N': 128, 'gamma': 1.0, 't': 0.3, 'B_star': 0.7, 'k': 0.0, 'type': 'uniform'},\n        # Case B: sinusoidal field\n        {'L': 1.0, 'N': 128, 'gamma': 0.6, 't': 0.5, 'B_star': 0.5, 'k': 2 * np.pi / 1.0, 'type': 'sinusoidal'},\n        # Case C: sinusoidal field at t=0\n        {'L': 1.0, 'N': 128, 'gamma': 0.6, 't': 0.0, 'B_star': 0.5, 'k': 2 * np.pi / 1.0, 'type': 'sinusoidal'},\n        # Case D: sinusoidal field with gamma=0\n        {'L': 1.0, 'N': 128, 'gamma': 0.0, 't': 0.5, 'B_star': 0.5, 'k': 2 * np.pi / 1.0, 'type': 'sinusoidal'},\n    ]\n\n    results = []\n    for case in test_cases:\n        error = calculate_error(\n            L=case['L'],\n            N=case['N'],\n            gamma=case['gamma'],\n            t=case['t'],\n            B_star=case['B_star'],\n            k=case['k'],\n            initial_field_type=case['type']\n        )\n        results.append(error)\n\n    # Format the final output string as required\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}