{
    "hands_on_practices": [
        {
            "introduction": "Before we can explore the complexities of wave-particle resonance, we must first master the fundamental motion of a single charged particle in a uniform magnetic field. This foundational exercise guides you through deriving and calculating the Larmor radius from first principles, establishing the characteristic scale of this circular \"gyromotion\". Understanding how this radius scales with particle properties and field strength is the first step toward building a complete picture of magnetized plasma dynamics .",
            "id": "3963559",
            "problem": "A singly ionized hydrogen nucleus (proton) with charge $q=+e$ and mass $m=m_{p}$ moves in a uniform magnetic field of magnitude $B$ such that its velocity component perpendicular to the magnetic field is $v_{\\perp}$. In the context of magnetized plasma dynamics and wave–particle interaction basics relevant to computational fusion science and engineering, the perpendicular motion of the charged particle in a uniform magnetic field is circular due to the Lorentz force. Starting from the Lorentz force law $m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$ and the kinematic description of uniform circular motion, derive an expression for the gyroradius (also called the Larmor radius) $r_{L}$ in terms of $m$, $q$, $v_{\\perp}$, and $B$. Then, compute $r_{L}$ for a proton with $v_{\\perp} = 2.50\\times 10^{6}\\,\\mathrm{m/s}$ in a uniform field $B = 6.00\\,\\mathrm{T}$. Use $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$ and $m_{p} = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$. Assume nonrelativistic motion. Express your final numerical answer for $r_{L}$ in meters and round your result to four significant figures.\n\nFinally, based on your derived expression, discuss the scaling of $r_{L}$ with particle mass $m$, charge magnitude $|q|$, and magnetic field strength $B$, connecting to the notion of cyclotron frequency as it arises from first principles.",
            "solution": "The problem asks for the derivation of the gyroradius for a charged particle in a uniform magnetic field, its numerical calculation for a specific case, and a discussion of its scaling properties.\n\n**Problem Validation**\n\nFirst, I will validate the provided problem statement.\n\n**Step 1: Extract Givens**\n-   Particle: Singly ionized hydrogen nucleus (proton).\n-   Charge: $q = +e$.\n-   Mass: $m = m_p$.\n-   Magnetic Field: Uniform, with magnitude $B$.\n-   Velocity: Perpendicular component to the magnetic field is $v_{\\perp}$.\n-   Governing Equation: Lorentz force law, $m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$.\n-   Motion Type: Uniform circular motion for the perpendicular component.\n-   Task 1: Derive an expression for the gyroradius $r_{L}$ in terms of $m$, $q$, $v_{\\perp}$, and $B$.\n-   Task 2: Compute $r_{L}$ for a proton with $v_{\\perp} = 2.50\\times 10^{6}\\,\\mathrm{m/s}$ in a uniform field $B = 6.00\\,\\mathrm{T}$.\n-   Constants: $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$, $m_{p} = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$.\n-   Assumption: Nonrelativistic motion.\n-   Requirement: Express numerical answer in meters, rounded to four significant figures.\n-   Task 3: Discuss the scaling of $r_L$ with $m$, $|q|$, and $B$, and connect to the cyclotron frequency.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is a classic and fundamental exercise in plasma physics and electromagnetism, based on the well-established Lorentz force law and Newtonian mechanics. The context of fusion science is appropriate and the physical parameters are realistic. The proton energy is $(1/2)m_p v_{\\perp}^2 \\approx 32.7\\,\\mathrm{keV}$ and the magnetic field strength of $6.00\\,\\mathrm{T}$ is typical for high-field fusion experiments. The velocity $v_{\\perp} = 2.50\\times 10^6\\,\\mathrm{m/s}$ is approximately $0.83\\%$ of the speed of light, so the nonrelativistic assumption is valid.\n-   **Well-Posed:** The problem is clearly stated, with all necessary data and constraints provided to derive a unique analytical expression and compute a specific numerical result.\n-   **Objective:** The language is formal, precise, and free of subjective or ambiguous statements.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, well-posed, and objective. I will now proceed with the solution.\n\n**Part 1: Derivation of the Gyroradius ($r_L$)**\n\nThe motion of a charged particle with mass $m$ and charge $q$ in a magnetic field $\\mathbf{B}$ is governed by the Lorentz force, given by Newton's second law:\n$$m \\frac{d\\mathbf{v}}{dt} = q(\\mathbf{v} \\times \\mathbf{B})$$\nLet's decompose the velocity vector $\\mathbf{v}$ into components parallel ($\\mathbf{v}_{\\parallel}$) and perpendicular ($\\mathbf{v}_{\\perp}$) to the magnetic field $\\mathbf{B}$. So, $\\mathbf{v} = \\mathbf{v}_{\\parallel} + \\mathbf{v}_{\\perp}$.\nSubstituting this into the equation of motion:\n$$m \\frac{d}{dt}(\\mathbf{v}_{\\parallel} + \\mathbf{v}_{\\perp}) = q((\\mathbf{v}_{\\parallel} + \\mathbf{v}_{\\perp}) \\times \\mathbf{B})$$\n$$m \\frac{d\\mathbf{v}_{\\parallel}}{dt} + m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{v}_{\\parallel} \\times \\mathbf{B}) + q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\nSince $\\mathbf{v}_{\\parallel}$ is parallel to $\\mathbf{B}$, their cross product is zero: $\\mathbf{v}_{\\parallel} \\times \\mathbf{B} = \\mathbf{0}$. The equation simplifies to:\n$$m \\frac{d\\mathbf{v}_{\\parallel}}{dt} + m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\nThis shows that there is no force component parallel to $\\mathbf{B}$, so the parallel velocity $\\mathbf{v}_{\\parallel}$ remains constant. The force acts entirely in the plane perpendicular to $\\mathbf{B}$. The equation for the perpendicular motion is:\n$$m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\nThe force $\\mathbf{F}_{\\perp} = q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$ is always perpendicular to both $\\mathbf{v}_{\\perp}$ and $\\mathbf{B}$. A force that is constant in magnitude and always perpendicular to the velocity vector results in uniform circular motion. The magnitude of this force is:\n$$F_{\\perp} = |q| v_{\\perp} B \\sin(\\theta)$$\nwhere $v_{\\perp} = |\\mathbf{v}_{\\perp}|$ and $\\theta$ is the angle between $\\mathbf{v}_{\\perp}$ and $\\mathbf{B}$. By definition, $\\theta = \\frac{\\pi}{2}$, so $\\sin(\\theta) = 1$. The force magnitude is therefore:\n$$F_{\\perp} = |q| v_{\\perp} B$$\nFor uniform circular motion with radius $r_L$ (the gyroradius) and speed $v_{\\perp}$, the centripetal force required is given by:\n$$F_{c} = m a_{c} = m \\frac{v_{\\perp}^2}{r_L}$$\nEquating the magnitude of the magnetic Lorentz force with the required centripetal force:\n$$m \\frac{v_{\\perp}^2}{r_L} = |q| v_{\\perp} B$$\nAssuming $v_{\\perp} \\neq 0$, we can divide both sides by $v_{\\perp}$ and solve for $r_L$:\n$$r_L = \\frac{m v_{\\perp}}{|q| B}$$\nThis is the desired expression for the gyroradius.\n\n**Part 2: Numerical Calculation of $r_L$**\n\nWe are given the following values for a proton:\n-   Mass $m = m_p = 1.67262192369 \\times 10^{-27}\\,\\mathrm{kg}$\n-   Charge $q = +e$, so $|q| = e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n-   Perpendicular velocity $v_{\\perp} = 2.50 \\times 10^{6}\\,\\mathrm{m/s}$\n-   Magnetic field strength $B = 6.00\\,\\mathrm{T}$\n\nSubstituting these values into the derived expression for $r_L$:\n$$r_L = \\frac{(1.67262192369 \\times 10^{-27}\\,\\mathrm{kg}) \\cdot (2.50 \\times 10^{6}\\,\\mathrm{m/s})}{(1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\cdot (6.00\\,\\mathrm{T})}$$\n$$r_L = \\frac{4.181554809225 \\times 10^{-21}}{9.613059804 \\times 10^{-19}}\\,\\mathrm{m}$$\n$$r_L = 0.43499039... \\times 10^{-2}\\,\\mathrm{m}$$\n$$r_L \\approx 0.0043499\\,\\mathrm{m}$$\nThe problem requires the result to be rounded to four significant figures. The first four significant figures are $4$, $3$, $4$, $9$. The fifth digit is $9$, so we round up the fourth digit.\n$$r_L \\approx 0.004350\\,\\mathrm{m}$$\nExpressed in scientific notation, this is $4.350 \\times 10^{-3}\\,\\mathrm{m}$.\n\n**Part 3: Scaling and Connection to Cyclotron Frequency**\n\nThe derived expression for the gyroradius is $r_L = \\frac{m v_{\\perp}}{|q| B}$.\nFrom this expression, we can analyze the scaling of $r_L$:\n-   **Scaling with mass ($m$):** $r_L \\propto m$. The gyroradius is directly proportional to the particle's mass. A more massive particle has greater inertia, making it more resistant to the bending effect of the magnetic force, thus resulting in a larger orbit for the same velocity and field.\n-   **Scaling with charge magnitude ($|q|$):** $r_L \\propto \\frac{1}{|q|}$. The gyroradius is inversely proportional to the magnitude of the particle's charge. A larger charge leads to a stronger Lorentz force ($F_{\\perp} \\propto |q|$), which curves the particle's path more sharply, resulting in a smaller gyroradius.\n-   **Scaling with magnetic field strength ($B$):** $r_L \\propto \\frac{1}{B}$. The gyroradius is inversely proportional to the magnetic field strength. A stronger magnetic field also increases the Lorentz force ($F_{\\perp} \\propto B$), leading to tighter confinement and a smaller gyroradius.\n\nThe **cyclotron frequency**, $\\omega_c$, is the angular frequency of the particle's gyration. For uniform circular motion, the tangential velocity $v_{\\perp}$ is related to the angular frequency $\\omega_c$ and radius $r_L$ by $v_{\\perp} = \\omega_c r_L$.\nWe can substitute this into our gyroradius equation:\n$$r_L = \\frac{m (\\omega_c r_L)}{|q| B}$$\nCanceling $r_L$ from both sides (since $r_L \\neq 0$), we can solve for $\\omega_c$:\n$$\\omega_c = \\frac{|q| B}{m}$$\nThis is the cyclotron (or gyro-) frequency. A key result of nonrelativistic theory is that $\\omega_c$ is independent of the particle's velocity $v_{\\perp}$ and its energy.\nWe can now express the gyroradius in terms of the cyclotron frequency by rearranging the above relation:\n$$r_L = \\frac{v_{\\perp}}{\\omega_c}$$\nThis relationship provides a clear physical picture: the size of the orbit ($r_L$) is determined by how far the particle travels at speed $v_{\\perp}$ during one characteristic radian of its rotation (which happens in a time $1/\\omega_c$). A higher cyclotron frequency (from a stronger field $B$, larger charge $|q|$, or smaller mass $m$) means the particle gyrates faster, completing its circular path in a shorter time, which for a given speed $v_{\\perp}$ corresponds to a smaller radius. This elegantly connects the concepts of gyroradius, particle properties, field strength, and the fundamental frequency of motion.",
            "answer": "$$\n\\boxed{4.350 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "With the basics of gyromotion established, we now explore the heart of our topic: cyclotron resonance. This hands-on computational practice challenges you to simulate a particle's trajectory under the influence of an oscillating electric field, revealing the conditions for efficient energy transfer. By integrating the equations of motion numerically, you will directly observe how a particle's energy changes when the wave frequency is tuned to its natural gyration frequency, providing a concrete example of wave-particle interaction .",
            "id": "3963539",
            "problem": "Consider a non-relativistic charged test particle moving in a uniform static magnetic field and a prescribed time-harmonic Radio Frequency (RF) electric field. The computational task is to integrate the particle’s equations of motion and extract time-averaged resonant energy exchange rates as a function of RF phase and initial pitch angle. The physical and mathematical setting is defined as follows.\n\nFundamental base:\n- The particle obeys the non-relativistic Lorentz force law, $$m \\frac{d\\mathbf{v}}{dt} = q \\left( \\mathbf{E}(t) + \\mathbf{v} \\times \\mathbf{B} \\right),$$ and kinematics $$\\frac{d\\mathbf{x}}{dt} = \\mathbf{v},$$ where $m$ is the particle mass, $q$ is the particle charge, $\\mathbf{x}$ is the position, and $\\mathbf{v}$ is the velocity.\n- The static magnetic field is uniform and aligned with the $z$-axis, $$\\mathbf{B} = (0, 0, B_0).$$\n- The RF electric field is spatially uniform and linearly polarized along the $x$-axis, $$\\mathbf{E}(t) = \\left(E_0 \\cos(\\omega t + \\phi), 0, 0\\right),$$ where $E_0$ is the electric field amplitude, $\\omega$ is the angular frequency, and $\\phi$ is the phase offset at $t=0$.\n\nDefinitions and parameters:\n- The cyclotron angular frequency is $$\\Omega = \\frac{q B_0}{m}.$$\n- The initial speed is fixed at $$v_0 = 1.0 \\times 10^6 \\text{ m/s}.$$ The initial pitch angle $$\\alpha$$ is the angle between the initial velocity and the magnetic field direction (the $z$-axis). The initial velocity components are set by $$v_{\\parallel}(0) = v_0 \\cos(\\alpha), \\quad v_{\\perp}(0) = v_0 \\sin(\\alpha),$$ with the perpendicular component initially aligned along the $x$-axis so that $$\\mathbf{v}(0) = \\left(v_{\\perp}(0), 0, v_{\\parallel}(0)\\right).$$\n- Use Deuterium ion parameters: $$q = +e = 1.602176634 \\times 10^{-19} \\text{ C},$$ $$m = 3.343583719 \\times 10^{-27} \\text{ kg}.$$ Use a magnetic field magnitude $$B_0 = 2.0 \\text{ T},$$ and an RF electric field amplitude $$E_0 = 5.0 \\times 10^4 \\text{ V/m}.$$\n- For resonant cases, set $$\\omega = \\Omega.$$ For detuned cases, use $$\\omega = \\lambda \\Omega$$ where $$\\lambda$$ is a specified dimensionless detuning factor.\n\nTarget quantity:\n- The instantaneous energy exchange rate (power transferred to the particle) is $$P(t) = q \\, \\mathbf{v}(t) \\cdot \\mathbf{E}(t).$$\n- The required output for each test case is the time-averaged energy exchange rate over the latter half of the simulation interval, computed as $$\\overline{P} = \\frac{1}{T_2 - T_1} \\int_{T_1}^{T_2} P(t) \\, dt,$$ where $$T_1 = \\frac{T_{\\text{end}}}{2}$$ and $$T_2 = T_{\\text{end}}.$$ The averaging suppresses initial transients and isolates steady resonant exchange. Express $$\\overline{P}$$ in watts (J/s) as a floating-point number.\n\nSimulation protocol:\n- Integrate the equations of motion for $$N_{\\text{cyc}} = 120$$ cyclotron periods, where one period is $$T_{\\Omega} = \\frac{2\\pi}{\\Omega}.$$ Therefore, $$T_{\\text{end}} = N_{\\text{cyc}} \\, T_{\\Omega}.$$ Use angles in radians. The problem is strictly non-relativistic; ensure speeds remain well below $$c.$$ The fields are spatially uniform, so spatial dependence of $$\\mathbf{E}$$ is omitted.\n\nTest suite:\nProvide results for the following test cases, covering a “happy path” resonant case, phase sensitivity, pitch-angle extremes, and a detuned edge case:\n1. $$\\phi = 0,$$ $$\\alpha = \\frac{\\pi}{3},$$ $$\\lambda = 1.0$$ (resonant).\n2. $$\\phi = \\frac{\\pi}{2},$$ $$\\alpha = \\frac{\\pi}{3},$$ $$\\lambda = 1.0$$ (resonant, phase-shifted).\n3. $$\\phi = \\frac{\\pi}{3},$$ $$\\alpha = 0,$$ $$\\lambda = 1.0$$ (resonant, zero pitch angle).\n4. $$\\phi = \\pi,$$ $$\\alpha = \\frac{\\pi}{2},$$ $$\\lambda = 1.0$$ (resonant, perpendicular).\n5. $$\\phi = \\frac{\\pi}{4},$$ $$\\alpha = \\frac{\\pi}{3},$$ $$\\lambda = 1.05$$ (slightly detuned).\n\nAlgorithmic requirements:\n- Implement a numerical integrator for the ordinary differential equations defined above.\n- Compute $$P(t)$$ over the time grid and return $$\\overline{P}$$ for each case.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $$[result_1,result_2,result_3,result_4,result_5]$$), where each $$result_i$$ is the floating-point value of $$\\overline{P}$$ in watts for test case $$i$$. No additional text should be printed.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of classical electrodynamics, specifically the non-relativistic Lorentz force law. The setup is a canonical problem in plasma physics concerning cyclotron wave-particle interaction. The problem is well-posed, providing a complete set of ordinary differential equations (ODEs), initial conditions, and physical parameters. All terms are defined unambiguously, and the objective is mathematically precise. The given parameters are physically realistic for a magnetically confined fusion plasma environment. The non-relativistic assumption is justified, as the initial velocity $v_0=1.0\\times 10^6 \\text{ m/s}$ corresponds to $v_0/c \\approx 0.0033$, and even with significant energy gain in the resonant cases, the particle velocity remains well below the speed of light, ensuring relativistic effects are negligible. The problem is formalizable, objective, and internally consistent.\n\nThe solution proceeds by numerically integrating the particle's equations of motion and then computing the specified time-averaged quantity.\n\nThe governing equation is the Lorentz force law:\n$$m \\frac{d\\mathbf{v}}{dt} = q \\left( \\mathbf{E}(t) + \\mathbf{v} \\times \\mathbf{B} \\right)$$\nThe magnetic field is $\\mathbf{B} = (0, 0, B_0)$ and the electric field is $\\mathbf{E}(t) = (E_0 \\cos(\\omega t + \\phi), 0, 0)$. Let $\\mathbf{v} = (v_x, v_y, v_z)$. The cross product $\\mathbf{v} \\times \\mathbf{B}$ is:\n$$ \\mathbf{v} \\times \\mathbf{B} = \\begin{vmatrix} \\mathbf{\\hat{i}}  \\mathbf{\\hat{j}}  \\mathbf{\\hat{k}} \\\\ v_x  v_y  v_z \\\\ 0  0  B_0 \\end{vmatrix} = (v_y B_0, -v_x B_0, 0) $$\nSubstituting the fields and the cross product into the Lorentz force equation and separating into components yields the system of ODEs for the velocity components:\n$$ \\frac{dv_x}{dt} = \\frac{q}{m} \\left( E_0 \\cos(\\omega t + \\phi) + v_y B_0 \\right) $$\n$$ \\frac{dv_y}{dt} = \\frac{q}{m} \\left( -v_x B_0 \\right) $$\n$$ \\frac{dv_z}{dt} = 0 $$\nUsing the definition of the cyclotron frequency, $\\Omega = q B_0 / m$, the system simplifies to:\n$$ \\frac{dv_x}{dt} = \\frac{q E_0}{m} \\cos(\\omega t + \\phi) + \\Omega v_y $$\n$$ \\frac{dv_y}{dt} = -\\Omega v_x $$\n$$ \\frac{dv_z}{dt} = 0 $$\nThe equation for the parallel velocity, $v_z$, implies that it is constant: $v_z(t) = v_z(0) = v_0 \\cos(\\alpha)$. The perpendicular velocity components, $v_x$ and $v_y$, form a coupled, linear, first-order system with a time-dependent driving term. This system constitutes an initial value problem (IVP) that must be solved numerically.\n\nThe initial conditions for the velocity at $t=0$ are derived from the given initial speed $v_0$ and pitch angle $\\alpha$:\n$$ \\mathbf{v}(0) = (v_0 \\sin(\\alpha), 0, v_0 \\cos(\\alpha)) $$\nEach test case provides specific values for the phase offset $\\phi$, pitch angle $\\alpha$, and detuning factor $\\lambda$, where the RF frequency is $\\omega = \\lambda \\Omega$.\n\nThe numerical solution is obtained using a robust IVP solver. The `scipy.integrate.solve_ivp` function from the SciPy library is ideally suited for this task. It implements high-order adaptive-step methods (such as Runge-Kutta-Fehlberg, `RK45`) that ensure accuracy and efficiency. We configure the solver to produce a dense output, which provides a continuous representation of the solution via interpolation. This is crucial for accurately computing the integral of the power over a specific interval.\n\nThe instantaneous power transferred from the electric field to the particle is given by $P(t) = q \\mathbf{v}(t) \\cdot \\mathbf{E}(t)$. Since $\\mathbf{E}(t)$ has only an $x$-component, this simplifies to:\n$$ P(t) = q v_x(t) E_x(t) = q v_x(t) E_0 \\cos(\\omega t + \\phi) $$\nThe target quantity is the time-averaged power, $\\overline{P}$, over the latter half of the total simulation time, $T_{\\text{end}} = N_{\\text{cyc}} T_{\\Omega}$, where $T_{\\Omega} = 2\\pi/\\Omega$:\n$$ \\overline{P} = \\frac{1}{T_2 - T_1} \\int_{T_1}^{T_2} P(t) \\, dt $$\nwith $T_1 = T_{\\text{end}}/2$ and $T_2 = T_{\\text{end}}$.\n\nThe computational procedure for each test case is as follows:\n1.  Define the physical constants $q, m, B_0, E_0$, and the simulation parameters $v_0, N_{\\text{cyc}}$.\n2.  Calculate the derived constants $\\Omega$ and $T_{\\text{end}}$.\n3.  For each test case $(\\phi, \\alpha, \\lambda)$, set up the specific RF frequency $\\omega = \\lambda \\Omega$ and initial velocity vector $\\mathbf{v}(0)$.\n4.  Define a function representing the system of ODEs for $(v_x, v_y, v_z)$.\n5.  Call `scipy.integrate.solve_ivp` to solve the ODEs from $t=0$ to $t=T_{\\text{end}}$, requesting dense output.\n6.  Define a function for the instantaneous power, $P(t)$, which uses the dense solution from the solver to find $v_x(t)$ at any given time $t$.\n7.  Use a numerical quadrature function, `scipy.integrate.quad`, to compute the definite integral of $P(t)$ from $T_1 = T_{\\text{end}}/2$ to $T_2 = T_{\\text{end}}$. This method is highly accurate as it adaptively refines the integration subintervals.\n8.  Divide the integral by the duration of the interval, $(T_2 - T_1)$, to obtain the average power $\\overline{P}$.\n9.  Collect the results for all test cases and format them as specified.\n\nThis methodology provides a rigorous and accurate solution to the posed problem, respecting the principles of both physics and numerical analysis.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp, quad\n\ndef solve():\n    \"\"\"\n    Solves for the time-averaged resonant energy exchange rate for a charged particle\n    in uniform magnetic and time-harmonic electric fields.\n    \"\"\"\n    # Define physical and simulation constants\n    Q = 1.602176634e-19  # Charge of Deuterium ion (C)\n    M = 3.343583719e-27  # Mass of Deuterium ion (kg)\n    B0 = 2.0             # Magnetic field magnitude (T)\n    E0 = 5.0e4           # Electric field amplitude (V/m)\n    V0 = 1.0e6           # Initial speed (m/s)\n    N_CYC = 120.0        # Number of cyclotron periods for simulation\n\n    # Calculate derived constants\n    OMEGA = Q * B0 / M          # Cyclotron angular frequency (rad/s)\n    T_OMEGA = 2.0 * np.pi / OMEGA # Cyclotron period (s)\n    T_END = N_CYC * T_OMEGA     # Total simulation time (s)\n    T1 = T_END / 2.0            # Start time for averaging (s)\n    T2 = T_END                  # End time for averaging (s)\n\n    # Define the test suite\n    test_cases = [\n        # case 1: phi=0, alpha=pi/3, lambda=1.0\n        {'phi': 0.0, 'alpha': np.pi / 3.0, 'lambda_': 1.0},\n        # case 2: phi=pi/2, alpha=pi/3, lambda=1.0\n        {'phi': np.pi / 2.0, 'alpha': np.pi / 3.0, 'lambda_': 1.0},\n        # case 3: phi=pi/3, alpha=0, lambda=1.0\n        {'phi': np.pi / 3.0, 'alpha': 0.0, 'lambda_': 1.0},\n        # case 4: phi=pi, alpha=pi/2, lambda=1.0\n        {'phi': np.pi, 'alpha': np.pi / 2.0, 'lambda_': 1.0},\n        # case 5: phi=pi/4, alpha=pi/3, lambda=1.05\n        {'phi': np.pi / 4.0, 'alpha': np.pi / 3.0, 'lambda_': 1.05},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        phi = case['phi']\n        alpha = case['alpha']\n        lambda_ = case['lambda_']\n\n        omega = lambda_ * OMEGA  # RF angular frequency\n\n        # Set initial velocity components\n        v_perp_0 = V0 * np.sin(alpha)\n        v_para_0 = V0 * np.cos(alpha)\n        v0_vec = np.array([v_perp_0, 0.0, v_para_0])\n\n        # Define the ODE system for the Lorentz force\n        def lorentz_force(t, v):\n            vx, vy, vz = v\n            # dv_x/dt = (q*E_0/m)*cos(omega*t+phi) + Omega*v_y\n            dvx_dt = (Q * E0 / M) * np.cos(omega * t + phi) + OMEGA * vy\n            # dv_y/dt = -Omega*v_x\n            dvy_dt = -OMEGA * vx\n            # dv_z/dt = 0\n            dvz_dt = 0.0\n            return np.array([dvx_dt, dvy_dt, dvz_dt])\n\n        # Numerically integrate the equations of motion\n        sol = solve_ivp(\n            lorentz_force,\n            [0, T_END],\n            v0_vec,\n            method='RK45',      # Standard adaptive Runge-Kutta method\n            dense_output=True,  # Enable continuous solution\n            rtol=1e-8,          # Relative tolerance for accuracy\n            atol=1e-10          # Absolute tolerance for accuracy\n        )\n\n        # Define the instantaneous power function using the interpolated solution\n        def power_func(t):\n            # v_x(t) is the first component of the solution vector\n            vx_t = sol.sol(t)[0]\n            # P(t) = q * v_x(t) * E_x(t)\n            return Q * vx_t * (E0 * np.cos(omega * t + phi))\n\n        # Integrate P(t) from T1 to T2 using adaptive quadrature\n        integral_P, _ = quad(power_func, T1, T2)\n\n        # Calculate the time-averaged power\n        avg_power = integral_P / (T2 - T1)\n        results.append(avg_power)\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "How do resonant interactions with individual electrons lead to the heating of a bulk plasma? This final practice bridges the gap from the microscopic to the macroscopic, introducing the crucial concept of optical depth. You will model how the cumulative effect of resonant absorption weakens an electromagnetic wave as it propagates through a plasma with a varying magnetic field, a process central to heating fusion plasmas .",
            "id": "3963572",
            "problem": "Consider Electron Cyclotron (EC) waves of angular frequency $\\omega$ propagating along a ray coordinate $s$ in a magnetized plasma with slowly varying magnetic field magnitude $B(s)$. Assume that the local power attenuation per unit length obeys the Beer–Lambert law for a slowly varying medium, and that cyclotron absorption is localized near the electron cyclotron resonance. The electron cyclotron frequency is $\\omega_{\\mathrm{ce}}(s) = \\frac{e}{m_{e}} B(s)$, where $e$ is the elementary charge and $m_{e}$ is the electron mass. Near the resonance, model the spatially local absorption coefficient as\n$$\n\\alpha(s) = \\alpha_{0} \\exp\\!\\left(-\\frac{\\big(\\omega - \\omega_{\\mathrm{ce}}(s)\\big)^{2}}{\\Delta^{2}}\\right),\n$$\nwith $\\alpha_{0}$ a constant amplitude and $\\Delta$ a resonance-broadening parameter (both strictly positive). Let the magnetic field vary linearly along the ray as $B(s) = B_{r} + \\beta s$, with $\\beta  0$, and choose $B_{r}$ such that the cyclotron resonance occurs at $s = 0$, that is, $\\frac{e}{m_{e}} B_{r} = \\omega$. Assume the ray traverses the entire resonance region so that the absorption integral can be approximated over $s \\in (-\\infty, +\\infty)$.\n\nStarting from conservation of electromagnetic energy and the definition of the local absorption coefficient, derive an expression for the optical depth\n$$\n\\tau = \\int_{-\\infty}^{+\\infty} \\alpha(s)\\, ds\n$$\nin terms of the given parameters, and then determine the absorbed power fraction $1 - \\exp(-\\tau)$.\n\nUse the following parameter values: $\\omega = 2\\pi \\times 170 \\times 10^{9}\\ \\mathrm{rad/s}$, $\\alpha_{0} = 10\\ \\mathrm{m}^{-1}$, $\\Delta = 1.0 \\times 10^{10}\\ \\mathrm{rad/s}$, and $\\beta = 1.0\\ \\mathrm{T/m}$. For the fundamental constants, use $\\frac{e}{m_{e}} = 1.758820010 \\times 10^{11}\\ \\mathrm{s}^{-1}\\ \\mathrm{T}^{-1}$. Round both the optical depth and the absorbed power fraction to four significant figures. The optical depth is dimensionless. Express the absorbed power fraction as a decimal without a unit.",
            "solution": "The problem is first validated against the required criteria.\n\n**Problem Validation**\n\n**Step 1: Extracted Givens**\n- Wave angular frequency: $\\omega = 2\\pi \\times 170 \\times 10^{9}\\ \\mathrm{rad/s}$\n- Ray coordinate: $s$\n- Magnetic field: $B(s) = B_{r} + \\beta s$, with $\\beta = 1.0\\ \\mathrm{T/m}  0$\n- Electron cyclotron frequency: $\\omega_{\\mathrm{ce}}(s) = \\frac{e}{m_{e}} B(s)$\n- Absorption coefficient: $\\alpha(s) = \\alpha_{0} \\exp\\!\\left(-\\frac{\\big(\\omega - \\omega_{\\mathrm{ce}}(s)\\big)^{2}}{\\Delta^{2}}\\right)$\n- Absorption amplitude: $\\alpha_{0} = 10\\ \\mathrm{m}^{-1}  0$\n- Resonance broadening parameter: $\\Delta = 1.0 \\times 10^{10}\\ \\mathrm{rad/s}  0$\n- Resonance condition at $s=0$: $\\frac{e}{m_{e}} B_{r} = \\omega$\n- Integration domain for optical depth: $s \\in (-\\infty, +\\infty)$\n- Optical depth definition: $\\tau = \\int_{-\\infty}^{+\\infty} \\alpha(s)\\, ds$\n- Absorbed power fraction: $1 - \\exp(-\\tau)$\n- Constants: $\\frac{e}{m_{e}} = 1.758820010 \\times 10^{11}\\ \\mathrm{s}^{-1}\\ \\mathrm{T}^{-1}$\n- Required precision: Round final numerical answers to four significant figures.\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes electron cyclotron resonance absorption in a magnetized plasma. The use of a Gaussian profile for the absorption coefficient is a standard model for Doppler-broadened resonance. The Beer–Lambert law for attenuation and a linear magnetic field approximation are standard and valid in this context. The physics is sound and central to fusion plasma science.\n- **Well-Posed:** The problem provides all necessary definitions, functions, and parameters to calculate the requested quantities. The integral for the optical depth is a convergent Gaussian integral, ensuring a unique and stable solution exists.\n- **Objective:** The problem is stated using precise, quantitative, and unbiased language.\n- **Flaws:** The problem statement is free from the listed flaws. It is self-contained, scientifically correct, formalizable, and well-posed. The provided numerical values are physically realistic for electron cyclotron heating in a modern fusion experiment.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be derived.\n\n**Derivation and Solution**\n\nThe objective is to compute the optical depth, $\\tau$, defined as the integral of the absorption coefficient, $\\alpha(s)$, along the ray path $s$ from $-\\infty$ to $+\\infty$.\n$$\n\\tau = \\int_{-\\infty}^{+\\infty} \\alpha(s)\\, ds\n$$\nThe absorption coefficient is given by\n$$\n\\alpha(s) = \\alpha_{0} \\exp\\!\\left(-\\frac{\\big(\\omega - \\omega_{\\mathrm{ce}}(s)\\big)^{2}}{\\Delta^{2}}\\right)\n$$\nwhere $\\omega_{\\mathrm{ce}}(s)$ is the local electron cyclotron frequency. This frequency depends on the magnetic field $B(s)$, which varies linearly along the ray:\n$$\n\\omega_{\\mathrm{ce}}(s) = \\frac{e}{m_{e}} B(s) = \\frac{e}{m_{e}} (B_{r} + \\beta s) = \\frac{e}{m_{e}} B_{r} + \\left(\\frac{e \\beta}{m_{e}}\\right) s\n$$\nThe problem states that the resonance condition $\\omega = \\omega_{\\mathrm{ce}}$ occurs at $s=0$. This implies $\\omega = \\frac{e}{m_{e}} B_{r}$. Substituting this into the expression for $\\omega_{\\mathrm{ce}}(s)$ gives:\n$$\n\\omega_{\\mathrm{ce}}(s) = \\omega + \\left(\\frac{e \\beta}{m_{e}}\\right) s\n$$\nNow, we evaluate the term in the exponent of $\\alpha(s)$:\n$$\n\\omega - \\omega_{\\mathrm{ce}}(s) = \\omega - \\left(\\omega + \\left(\\frac{e \\beta}{m_{e}}\\right) s\\right) = -\\left(\\frac{e \\beta}{m_{e}}\\right) s\n$$\nSubstituting this result back into the expression for $\\alpha(s)$:\n$$\n\\alpha(s) = \\alpha_{0} \\exp\\!\\left(-\\frac{\\left(-\\left(\\frac{e \\beta}{m_{e}}\\right) s\\right)^{2}}{\\Delta^{2}}\\right) = \\alpha_{0} \\exp\\!\\left(-\\left(\\frac{e \\beta}{m_{e} \\Delta}\\right)^{2} s^{2}\\right)\n$$\nWe can now compute the integral for the optical depth $\\tau$:\n$$\n\\tau = \\int_{-\\infty}^{+\\infty} \\alpha_{0} \\exp\\!\\left(-\\left(\\frac{e \\beta}{m_{e} \\Delta}\\right)^{2} s^{2}\\right) ds\n$$\nThis is a standard Gaussian integral of the form $\\int_{-\\infty}^{+\\infty} C \\exp(-ax^{2}) dx = C\\sqrt{\\frac{\\pi}{a}}$.\nIn our case, the constant prefactor is $C=\\alpha_{0}$ and the coefficient in the exponent is $a = \\left(\\frac{e \\beta}{m_{e} \\Delta}\\right)^{2}$.\nPerforming the integration yields the analytical expression for the optical depth:\n$$\n\\tau = \\alpha_{0} \\sqrt{\\frac{\\pi}{\\left(\\frac{e \\beta}{m_{e} \\Delta}\\right)^{2}}} = \\alpha_{0} \\frac{\\sqrt{\\pi}}{\\left|\\frac{e \\beta}{m_{e} \\Delta}\\right|}\n$$\nSince all parameters $\\alpha_{0}$, $\\beta$, $\\Delta$, $e$, and $m_{e}$ are positive, the absolute value can be removed. The expression can be conveniently rewritten in terms of the ratio $\\frac{e}{m_e}$:\n$$\n\\tau = \\frac{\\alpha_{0} \\Delta \\sqrt{\\pi}}{\\beta \\left(\\frac{e}{m_{e}}\\right)}\n$$\nThis is the derived expression for the optical depth.\n\nNext, we substitute the given numerical values to calculate $\\tau$:\n- $\\alpha_{0} = 10\\ \\mathrm{m}^{-1}$\n- $\\Delta = 1.0 \\times 10^{10}\\ \\mathrm{rad/s}$\n- $\\beta = 1.0\\ \\mathrm{T/m}$\n- $\\frac{e}{m_{e}} = 1.758820010 \\times 10^{11}\\ \\mathrm{s}^{-1}\\ \\mathrm{T}^{-1}$\n\n$$\n\\tau = \\frac{(10) \\cdot (1.0 \\times 10^{10}) \\cdot \\sqrt{\\pi}}{(1.0) \\cdot (1.758820010 \\times 10^{11})} = \\frac{10^{11} \\sqrt{\\pi}}{1.758820010 \\times 10^{11}} = \\frac{\\sqrt{\\pi}}{1.758820010}\n$$\nUsing the value $\\sqrt{\\pi} \\approx 1.77245385$:\n$$\n\\tau \\approx \\frac{1.77245385}{1.758820010} \\approx 1.0077519\n$$\nRounding to four significant figures, the optical depth is $\\tau \\approx 1.008$.\n\nFinally, the absorbed power fraction, which we denote as $f_{abs}$, is given by $1 - \\exp(-\\tau)$. The transmitted fraction is $\\exp(-\\tau)$, so the absorbed fraction is the remainder.\n$$\nf_{abs} = 1 - \\exp(-\\tau)\n$$\nUsing the unrounded value of $\\tau$ for accuracy:\n$$\nf_{abs} = 1 - \\exp(-1.0077519) \\approx 1 - 0.3650261 = 0.6349739\n$$\nRounding to four significant figures, the absorbed power fraction is $f_{abs} \\approx 0.6350$.\nThe trailing zero is significant and must be included.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.008  0.6350 \\end{pmatrix}}\n$$"
        }
    ]
}