{
    "hands_on_practices": [
        {
            "introduction": "在我们理解波与粒子如何相互作用之前，我们必须首先掌握如何描述单个粒子在磁场中的运动。这项练习将引导你从洛伦兹力定律出发，推导出粒子完整的螺旋运动轨迹。这个“未受扰动轨道”是所有波粒相互作用分析的基础。",
            "id": "3963557",
            "problem": "一个电荷为 $q$、质量为 $m$ 的带电粒子在空间均匀、不随时间变化的磁场 $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$ 和零电场中运动。在时间 $t=0$ 时，该粒子的位置为 $\\mathbf{r}_{0} = (x_{0}, y_{0}, z_{0})$，速度由两部分组成：一个平行于 $\\mathbf{B}$ 的分量，其大小为 $v_{\\parallel 0}$，以及一个垂直于 $\\mathbf{B}$ 的分量，其大小为 $v_{\\perp 0}$。$t=0$ 时垂直速度的方向由回旋相位角 $\\phi_{0}$ 指定，该角定义为从 $+\\hat{\\mathbf{x}}$ 轴朝向 $+\\hat{\\mathbf{y}}$ 轴测量的垂直速度的极角，因此 $v_{x}(0) = v_{\\perp 0} \\cos\\phi_{0}$，$v_{y}(0) = v_{\\perp 0} \\sin\\phi_{0}$，而 $v_{z}(0) = v_{\\parallel 0}$。\n\n仅从洛伦兹力定律 $m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$ 和运动学关系 $d\\mathbf{r}/dt=\\mathbf{v}$ 出发，推导该粒子的参数化运动方程。然后，显式计算在任意时间 $t$ 后的回旋相位 $\\phi(t)$ 和粒子位置分量 $(x(t), y(t), z(t))$，并用 $q$、$m$、$B_{0}$、$v_{\\parallel 0}$、$v_{\\perp 0}$、$\\phi_{0}$、$x_{0}$、$y_{0}$、$z_{0}$ 和 $t$ 表示。在推导中请正确处理 $q$ 的符号。\n\n最终的回旋相位以弧度表示。无需进行数值代入，也无需四舍五入。将您的最终答案以单行形式报告，按顺序依次列出 $\\phi(t)$、$x(t)$、$y(t)$ 和 $z(t)$，并以闭合形式的解析表达式给出。",
            "solution": "问题陈述的验证如下。\n\n### 第1步：提取已知条件\n- 带电荷 $q$ 和质量 $m$ 的带电粒子。\n- 空间均匀、不随时间变化的磁场 $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$。\n- 零电场，$\\mathbf{E} = \\mathbf{0}$。\n- 在时间 $t=0$ 时：\n    - 位置：$\\mathbf{r}(0) = \\mathbf{r}_{0} = (x_{0}, y_{0}, z_{0})$。\n    - 平行于 $\\mathbf{B}$ 的速度分量：大小 $v_{\\parallel 0}$。\n    - 垂直于 $\\mathbf{B}$ 的速度分量：大小 $v_{\\perp 0}$。\n    - 回旋相位角：$\\phi_{0}$。\n    - 初始速度分量：$v_{x}(0) = v_{\\perp 0} \\cos\\phi_{0}$，$v_{y}(0) = v_{\\perp 0} \\sin\\phi_{0}$，$v_{z}(0) = v_{\\parallel 0}$。\n- 控制方程：\n    - 洛伦兹力定律：$m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$。\n    - 运动学关系：$d\\mathbf{r}/dt=\\mathbf{v}$。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据（关键）**：该问题是经典电磁学和等离子体物理学的基石。它描述了带电粒子在均匀磁场中的基本运动，这种现象被称为回旋运动。所有原理、定律和条件都是有科学依据的。\n- **适定性**：该问题是适定的。控制方程是一个带有指定初始条件的线性一阶常微分方程组。存在唯一且稳定的解，并且可以通过解析方法推导出来。\n- **客观性（关键）**：该问题使用物理学和数学中精确、客观和标准的术语进行陈述。没有主观或基于观点的陈述。\n- **完整性和一致性**：该问题提供了求解运动方程所需的所有必要信息（电荷、质量、场以及完整的位置和速度初始条件）。不存在矛盾。\n- **现实性**：所描述的条件（带电粒子在均匀磁场中）是一个标准的、物理上可实现的场景，通常用作许多物理学领域（包括聚变能、天体物理学和加速器物理学）中的一级近似。\n\n### 第3步：结论与行动\n该问题有效。这是一个物理学中标准的、适定的问题，具有科学依据、客观性和完整性。将提供完整的解。\n\n### 解的推导\n带电粒子的运动由洛伦兹力定律决定。在电场为零的情况下，该定律为：\n$$m \\frac{d\\mathbf{v}}{dt} = q(\\mathbf{v} \\times \\mathbf{B})$$\n粒子的速度为 $\\mathbf{v} = (v_x, v_y, v_z)$，磁场为 $\\mathbf{B} = (0, 0, B_0)$。叉积为：\n$$\\mathbf{v} \\times \\mathbf{B} = \\begin{vmatrix} \\hat{\\mathbf{x}}  \\hat{\\mathbf{y}}  \\hat{\\mathbf{z}} \\\\ v_x  v_y  v_z \\\\ 0  0  B_0 \\end{vmatrix} = v_y B_0 \\hat{\\mathbf{x}} - v_x B_0 \\hat{\\mathbf{y}}$$\n将此代入洛伦兹力定律并以分量形式写出，我们得到一个关于速度分量的三元微分方程组：\n$$m \\frac{dv_x}{dt} = q v_y B_0$$\n$$m \\frac{dv_y}{dt} = -q v_x B_0$$\n$$m \\frac{dv_z}{dt} = 0$$\n我们定义回旋频率 $\\omega_c = \\frac{q B_0}{m}$。这个带符号的频率其符号取决于电荷 $q$ 的符号。速度的运动方程变为：\n$$(1) \\quad \\frac{dv_x}{dt} = \\omega_c v_y$$\n$$(2) \\quad \\frac{dv_y}{dt} = -\\omega_c v_x$$\n$$(3) \\quad \\frac{dv_z}{dt} = 0$$\n从方程 $(3)$，我们可以看出 $v_z$ 是一个常数。使用初始条件 $v_z(0) = v_{\\parallel 0}$，我们有：\n$$v_z(t) = v_{\\parallel 0}$$\n对于所有时间 $t$。\n\n为了求解垂直分量，我们将方程 $(1)$ 对时间求导，并代入方程 $(2)$：\n$$\\frac{d^2v_x}{dt^2} = \\omega_c \\frac{dv_y}{dt} = \\omega_c(-\\omega_c v_x) = -\\omega_c^2 v_x$$\n这给出了一个简谐振子的方程：\n$$\\frac{d^2v_x}{dt^2} + \\omega_c^2 v_x = 0$$\n$v_x(t)$ 的通解形式为 $v_x(t) = C_1 \\cos(\\omega_c t) + C_2 \\sin(\\omega_c t)$。然后我们可以从方程 $(1)$ 中求出 $v_y(t)$：\n$$v_y(t) = \\frac{1}{\\omega_c} \\frac{dv_x}{dt} = \\frac{1}{\\omega_c} (-C_1 \\omega_c \\sin(\\omega_c t) + C_2 \\omega_c \\cos(\\omega_c t)) = -C_1 \\sin(\\omega_c t) + C_2 \\cos(\\omega_c t)$$\n现在我们应用 $t=0$ 时的初始条件：\n$$v_x(0) = v_{\\perp 0} \\cos(\\phi_0) = C_1 \\cos(0) + C_2 \\sin(0) = C_1$$\n$$v_y(0) = v_{\\perp 0} \\sin(\\phi_0) = -C_1 \\sin(0) + C_2 \\cos(0) = C_2$$\n因此，常数为 $C_1 = v_{\\perp 0} \\cos(\\phi_0)$ 和 $C_2 = v_{\\perp 0} \\sin(\\phi_0)$。将它们代回 $v_x(t)$ 和 $v_y(t)$ 的表达式中：\n$$v_x(t) = v_{\\perp 0} \\cos(\\phi_0) \\cos(\\omega_c t) + v_{\\perp 0} \\sin(\\phi_0) \\sin(\\omega_c t)$$\n$$v_y(t) = -v_{\\perp 0} \\cos(\\phi_0) \\sin(\\omega_c t) + v_{\\perp 0} \\sin(\\phi_0) \\cos(\\omega_c t)$$\n使用三角函数的差角恒等式：\n$$v_x(t) = v_{\\perp 0} \\cos(\\phi_0 - \\omega_c t)$$\n$$v_y(t) = v_{\\perp 0} \\sin(\\phi_0 - \\omega_c t)$$\n垂直速度矢量为 $\\mathbf{v}_\\perp(t) = (v_x(t), v_y(t))$。其大小为 $\\sqrt{v_x^2 + v_y^2} = \\sqrt{v_{\\perp 0}^2(\\cos^2(\\dots) + \\sin^2(\\dots))} = v_{\\perp 0}$，正如预期那样是一个常数。\n\n回旋相位 $\\phi(t)$ 定义为垂直速度的极角。从我们得到的 $v_x(t)$ 和 $v_y(t)$ 的解，通过与标准极坐标形式 $v_x = v_{\\perp 0} \\cos(\\phi)$ 和 $v_y = v_{\\perp 0} \\sin(\\phi)$ 进行比较，我们可以直接确定该角度。\n$$\\phi(t) = \\phi_0 - \\omega_c t = \\phi_0 - \\frac{q B_0}{m} t$$\n\n接下来，我们通过对速度分量从初始位置 $\\mathbf{r}_0 = (x_0, y_0, z_0)$ 进行积分来求得粒子的位置 $\\mathbf{r}(t) = (x(t), y(t), z(t))$。\n$z$ 分量为：\n$$z(t) = z_0 + \\int_0^t v_z(t') dt' = z_0 + \\int_0^t v_{\\parallel 0} dt' = z_0 + v_{\\parallel 0} t$$\n$x$ 分量为：\n$$x(t) = x_0 + \\int_0^t v_x(t') dt' = x_0 + \\int_0^t v_{\\perp 0} \\cos(\\phi_0 - \\omega_c t') dt'$$\n$$x(t) = x_0 + v_{\\perp 0} \\left[ \\frac{\\sin(\\phi_0 - \\omega_c t')}{-\\omega_c} \\right]_{0}^{t} = x_0 - \\frac{v_{\\perp 0}}{\\omega_c} \\left[ \\sin(\\phi_0 - \\omega_c t) - \\sin(\\phi_0) \\right]$$\n$$x(t) = x_0 + \\frac{v_{\\perp 0}}{\\omega_c} \\left[ \\sin(\\phi_0) - \\sin(\\phi_0 - \\omega_c t) \\right]$$\n$y$ 分量为：\n$$y(t) = y_0 + \\int_0^t v_y(t') dt' = y_0 + \\int_0^t v_{\\perp 0} \\sin(\\phi_0 - \\omega_c t') dt'$$\n$$y(t) = y_0 + v_{\\perp 0} \\left[ \\frac{-\\cos(\\phi_0 - \\omega_c t')}{-\\omega_c} \\right]_{0}^{t} = y_0 + \\frac{v_{\\perp 0}}{\\omega_c} \\left[ \\cos(\\phi_0 - \\omega_c t) - \\cos(\\phi_0) \\right]$$\n\n最后，我们将 $\\omega_c = \\frac{q B_0}{m}$ 代入回旋相位和位置的表达式中，以便用给定的参数来表示它们。\n$$\\phi(t) = \\phi_0 - \\frac{q B_0 t}{m}$$\n$$x(t) = x_0 + \\frac{m v_{\\perp 0}}{q B_0} \\left( \\sin(\\phi_0) - \\sin\\left(\\phi_0 - \\frac{q B_0 t}{m}\\right) \\right)$$\n$$y(t) = y_0 + \\frac{m v_{\\perp 0}}{q B_0} \\left( \\cos\\left(\\phi_0 - \\frac{q B_0 t}{m}\\right) - \\cos(\\phi_0) \\right)$$\n$$z(t) = z_0 + v_{\\parallel 0} t$$\n这些是粒子回旋相位和位置的最终参数方程。该运动是螺旋运动，由沿磁场的匀速运动和垂直于磁场的平面内的圆周运动（回旋运动）组成。",
            "answer": "$$\\boxed{\\pmatrix{ \\phi_0 - \\frac{q B_0 t}{m}  x_0 + \\frac{m v_{\\perp 0}}{q B_0} \\left( \\sin(\\phi_0) - \\sin\\left(\\phi_0 - \\frac{q B_0 t}{m}\\right) \\right)  y_0 + \\frac{m v_{\\perp 0}}{q B_0} \\left( \\cos\\left(\\phi_0 - \\frac{q B_0 t}{m}\\right) - \\cos(\\phi_0) \\right)  z_0 + v_{\\parallel 0} t }}$$"
        },
        {
            "introduction": "现在我们已经掌握了未受扰动的轨道，我们可以探索加入一个振荡电场时会发生什么。这个动手计算练习让你能够直接模拟回旋共振现象，即当波的频率与粒子的自然回旋频率匹配时，粒子会持续从波中获得能量。你将计算单个粒子吸收的功率，从而从微观视角理解等离子体加热的过程。",
            "id": "3963539",
            "problem": "考虑一个非相对论带电测试粒子，在均匀静磁场和给定的时谐射频（RF）电场中运动。计算任务是积分该粒子的运动方程，并提取时间平均的共振能量交换率，将其作为射频相位和初始投掷角的函数。其物理和数学设定如下。\n\n基本依据：\n- 粒子遵循非相对论洛伦兹力定律，$$m \\frac{d\\mathbf{v}}{dt} = q \\left( \\mathbf{E}(t) + \\mathbf{v} \\times \\mathbf{B} \\right),$$ 以及运动学关系 $$\\frac{d\\mathbf{x}}{dt} = \\mathbf{v},$$ 其中 $m$ 是粒子质量，$q$ 是粒子电荷，$\\mathbf{x}$ 是位置，$\\mathbf{v}$ 是速度。\n- 静磁场是均匀的，并沿 $z$ 轴方向，$$\\mathbf{B} = (0, 0, B_0),$$\n- 射频电场在空间上是均匀的，并沿 $x$ 轴线性极化，$$\\mathbf{E}(t) = \\left(E_0 \\cos(\\omega t + \\phi), 0, 0\\right),$$ 其中 $E_0$ 是电场振幅，$\\omega$ 是角频率，$\\phi$ 是 $t=0$ 时的相位偏移。\n\n定义和参数：\n- 回旋角频率为 $$\\Omega = \\frac{q B_0}{m}。$$\n- 初始速率固定为 $$v_0 = 1.0 \\times 10^6 \\text{ m/s}。$$ 初始投掷角 $$\\alpha$$ 是初始速度与磁场方向（$z$ 轴）之间的夹角。初始速度分量由 $$v_{\\parallel}(0) = v_0 \\cos(\\alpha), \\quad v_{\\perp}(0) = v_0 \\sin(\\alpha),$$ 设定，其中垂直分量初始时沿 $x$ 轴方向，因此 $$\\mathbf{v}(0) = \\left(v_{\\perp}(0), 0, v_{\\parallel}(0)\\right)。$$\n- 使用氘离子参数：$$q = +e = 1.602176634 \\times 10^{-19} \\text{ C},$$ $$m = 3.343583719 \\times 10^{-27} \\text{ kg}。$$ 使用磁场大小 $$B_0 = 2.0 \\text{ T},$$ 以及射频电场振幅 $$E_0 = 5.0 \\times 10^4 \\text{ V/m}。$$\n- 对于共振情况，设置 $$\\omega = \\Omega。$$ 对于失谐情况，使用 $$\\omega = \\lambda \\Omega$$，其中 $$\\lambda$$ 是一个给定的无量纲失谐因子。\n\n目标量：\n- 瞬时能量交换率（传递给粒子的功率）为 $$P(t) = q \\, \\mathbf{v}(t) \\cdot \\mathbf{E}(t)。$$\n- 每个测试用例所需的输出是模拟区间后半段的时间平均能量交换率，计算公式为 $$\\overline{P} = \\frac{1}{T_2 - T_1} \\int_{T_1}^{T_2} P(t) \\, dt,$$ 其中 $$T_1 = \\frac{T_{\\text{end}}}{2}$$ 且 $$T_2 = T_{\\text{end}}。$$ 该平均过程可以抑制初始瞬态，并分离出稳态的共振交换。将 $$\\overline{P}$$ 以瓦特（J/s）为单位，表示为一个浮点数。\n\n模拟协议：\n- 对运动方程进行积分，时长为 $$N_{\\text{cyc}} = 120$$ 个回旋周期，其中一个周期是 $$T_{\\Omega} = \\frac{2\\pi}{\\Omega}。$$ 因此，$$T_{\\text{end}} = N_{\\text{cyc}} \\, T_{\\Omega}。$$ 角度使用弧度制。此问题严格为非相对论性问题；确保速度远低于 $$c。$$ 场在空间上是均匀的，因此 $$\\mathbf{E}$$ 的空间依赖性被省略。\n\n测试套件：\n为以下测试用例提供结果，涵盖“理想路径”共振情况、相位敏感性、投掷角极端情况以及一个失谐边界情况：\n1. $$\\phi = 0,$$ $$\\alpha = \\frac{\\pi}{3},$$ $$\\lambda = 1.0$$ (共振)。\n2. $$\\phi = \\frac{\\pi}{2},$$ $$\\alpha = \\frac{\\pi}{3},$$ $$\\lambda = 1.0$$ (共振，相移)。\n3. $$\\phi = \\frac{\\pi}{3},$$ $$\\alpha = 0,$$ $$\\lambda = 1.0$$ (共振，零投掷角)。\n4. $$\\phi = \\pi,$$ $$\\alpha = \\frac{\\pi}{2},$$ $$\\lambda = 1.0$$ (共振，垂直)。\n5. $$\\phi = \\frac{\\pi}{4},$$ $$\\alpha = \\frac{\\pi}{3},$$ $$\\lambda = 1.05$$ (轻微失谐)。\n\n算法要求：\n- 为上述定义的常微分方程实现一个数值积分器。\n- 在时间网格上计算 $$P(t)$$，并返回每个用例的 $$\\overline{P}$$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$$[result_1,result_2,result_3,result_4,result_5]$$），其中每个 $$result_i$$ 是测试用例 $$i$$ 的 $$\\overline{P}$$ 的浮点数值，单位为瓦特。不应打印任何额外文本。",
            "solution": "该问题陈述经评估有效。其科学基础是经典电动力学原理，特别是非相对论洛伦兹力定律。该设定是等离子体物理学中关于回旋波-粒子相互作用的一个典型问题。该问题是适定的，提供了一整套常微分方程（ODE）、初始条件和物理参数。所有术语均有明确定义，目标在数学上是精确的。给定的参数对于磁约束聚变等离子体环境是物理上现实的。非相对论假设是合理的，因为初始速度 $v_0=1.0\\times 10^6 \\text{ m/s}$ 对应于 $v_0/c \\approx 0.0033$，即使在共振情况下获得显著能量增益，粒子速度仍远低于光速，确保了相对论效应可以忽略不计。该问题是可形式化、客观且内部一致的。\n\n求解过程通过对粒子的运动方程进行数值积分，然后计算指定的时间平均量来进行。\n\n控制方程是洛伦兹力定律：\n$$m \\frac{d\\mathbf{v}}{dt} = q \\left( \\mathbf{E}(t) + \\mathbf{v} \\times \\mathbf{B} \\right)$$\n磁场为 $\\mathbf{B} = (0, 0, B_0)$，电场为 $\\mathbf{E}(t) = (E_0 \\cos(\\omega t + \\phi), 0, 0)$。设 $\\mathbf{v} = (v_x, v_y, v_z)$。叉积 $\\mathbf{v} \\times \\mathbf{B}$ 为：\n$$ \\mathbf{v} \\times \\mathbf{B} = \\begin{vmatrix} \\mathbf{\\hat{i}}  \\mathbf{\\hat{j}}  \\mathbf{\\hat{k}} \\\\ v_x  v_y  v_z \\\\ 0  0  B_0 \\end{vmatrix} = (v_y B_0, -v_x B_0, 0) $$\n将场和叉积代入洛伦兹力方程，并按分量展开，得到速度分量的常微分方程组：\n$$ \\frac{dv_x}{dt} = \\frac{q}{m} \\left( E_0 \\cos(\\omega t + \\phi) + v_y B_0 \\right) $$\n$$ \\frac{dv_y}{dt} = \\frac{q}{m} \\left( -v_x B_0 \\right) $$\n$$ \\frac{dv_z}{dt} = 0 $$\n使用回旋频率的定义 $\\Omega = q B_0 / m$，该方程组简化为：\n$$ \\frac{dv_x}{dt} = \\frac{q E_0}{m} \\cos(\\omega t + \\phi) + \\Omega v_y $$\n$$ \\frac{dv_y}{dt} = -\\Omega v_x $$\n$$ \\frac{dv_z}{dt} = 0 $$\n平行速度 $v_z$ 的方程意味着它是恒定的：$v_z(t) = v_z(0) = v_0 \\cos(\\alpha)$。垂直速度分量 $v_x$ 和 $v_y$ 构成一个含时驱动项的耦合线性一阶系统。该系统构成一个必须进行数值求解的初值问题（IVP）。\n\n$t=0$ 时的速度初始条件由给定的初始速率 $v_0$ 和投掷角 $\\alpha$ 导出：\n$$ \\mathbf{v}(0) = (v_0 \\sin(\\alpha), 0, v_0 \\cos(\\alpha)) $$\n每个测试用例都为相位偏移 $\\phi$、投掷角 $\\alpha$ 和失谐因子 $\\lambda$ 提供了具体值，其中射频频率为 $\\omega = \\lambda \\Omega$。\n\n数值解通过使用一个鲁棒的 IVP 求解器获得。`SciPy` 库中的 `scipy.integrate.solve_ivp` 函数非常适合此任务。它实现了高阶自适应步长方法（如 `RK45`，即龙格-库塔-菲尔伯格方法），可确保准确性和效率。我们将求解器配置为生成密集输出，这通过插值提供了对解的连续表示。这对于在特定区间上精确计算功率的积分至关重要。\n\n从电场传递到粒子的瞬时功率由 $P(t) = q \\mathbf{v}(t) \\cdot \\mathbf{E}(t)$ 给出。由于 $\\mathbf{E}(t)$ 只有 $x$ 分量，该式简化为：\n$$ P(t) = q v_x(t) E_x(t) = q v_x(t) E_0 \\cos(\\omega t + \\phi) $$\n目标量是总模拟时间 $T_{\\text{end}} = N_{\\text{cyc}} T_{\\Omega}$（其中 $T_{\\Omega} = 2\\pi/\\Omega$）后半段的时间平均功率 $\\overline{P}$：\n$$ \\overline{P} = \\frac{1}{T_2 - T_1} \\int_{T_1}^{T_2} P(t) \\, dt $$\n其中 $T_1 = T_{\\text{end}}/2$ 且 $T_2 = T_{\\text{end}}$。\n\n每个测试用例的计算步骤如下：\n1.  定义物理常数 $q, m, B_0, E_0$，以及模拟参数 $v_0, N_{\\text{cyc}}$。\n2.  计算导出常数 $\\Omega$ 和 $T_{\\text{end}}$。\n3.  对于每个测试用例 $(\\phi, \\alpha, \\lambda)$，设置特定的射频频率 $\\omega = \\lambda \\Omega$ 和初始速度矢量 $\\mathbf{v}(0)$。\n4.  定义一个函数，表示关于 $(v_x, v_y, v_z)$ 的常微分方程组。\n5.  调用 `scipy.integrate.solve_ivp` 求解从 $t=0$到 $t=T_{\\text{end}}$ 的常微分方程，并请求密集输出。\n6.  定义瞬时功率函数 $P(t)$，该函数使用求解器的密集解来找到任意给定时间 $t$ 的 $v_x(t)$。\n7.  使用数值求积函数 `scipy.integrate.quad` 计算 $P(t)$ 从 $T_1 = T_{\\text{end}}/2$ 到 $T_2 = T_{\\text{end}}$ 的定积分。该方法通过自适应地细化积分子区间来获得高精度。\n8.  将积分结果除以区间时长 $(T_2 - T_1)$，得到平均功率 $\\overline{P}$。\n9.  收集所有测试用例的结果，并按规定格式化。\n\n此方法为所提问题提供了一个严谨而准确的解决方案，遵循了物理学和数值分析的原理。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp, quad\n\ndef solve():\n    \"\"\"\n    Solves for the time-averaged resonant energy exchange rate for a charged particle\n    in uniform magnetic and time-harmonic electric fields.\n    \"\"\"\n    # Define physical and simulation constants\n    Q = 1.602176634e-19  # Charge of Deuterium ion (C)\n    M = 3.343583719e-27  # Mass of Deuterium ion (kg)\n    B0 = 2.0             # Magnetic field magnitude (T)\n    E0 = 5.0e4           # Electric field amplitude (V/m)\n    V0 = 1.0e6           # Initial speed (m/s)\n    N_CYC = 120.0        # Number of cyclotron periods for simulation\n\n    # Calculate derived constants\n    OMEGA = Q * B0 / M          # Cyclotron angular frequency (rad/s)\n    T_OMEGA = 2.0 * np.pi / OMEGA # Cyclotron period (s)\n    T_END = N_CYC * T_OMEGA     # Total simulation time (s)\n    T1 = T_END / 2.0            # Start time for averaging (s)\n    T2 = T_END                  # End time for averaging (s)\n\n    # Define the test suite\n    test_cases = [\n        # case 1: phi=0, alpha=pi/3, lambda=1.0\n        {'phi': 0.0, 'alpha': np.pi / 3.0, 'lambda_': 1.0},\n        # case 2: phi=pi/2, alpha=pi/3, lambda=1.0\n        {'phi': np.pi / 2.0, 'alpha': np.pi / 3.0, 'lambda_': 1.0},\n        # case 3: phi=pi/3, alpha=0, lambda=1.0\n        {'phi': np.pi / 3.0, 'alpha': 0.0, 'lambda_': 1.0},\n        # case 4: phi=pi, alpha=pi/2, lambda=1.0\n        {'phi': np.pi, 'alpha': np.pi / 2.0, 'lambda_': 1.0},\n        # case 5: phi=pi/4, alpha=pi/3, lambda=1.05\n        {'phi': np.pi / 4.0, 'alpha': np.pi / 3.0, 'lambda_': 1.05},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        phi = case['phi']\n        alpha = case['alpha']\n        lambda_ = case['lambda_']\n\n        omega = lambda_ * OMEGA  # RF angular frequency\n\n        # Set initial velocity components\n        v_perp_0 = V0 * np.sin(alpha)\n        v_para_0 = V0 * np.cos(alpha)\n        v0_vec = np.array([v_perp_0, 0.0, v_para_0])\n\n        # Define the ODE system for the Lorentz force\n        def lorentz_force(t, v):\n            vx, vy, vz = v\n            # dv_x/dt = (q*E_0/m)*cos(omega*t+phi) + Omega*v_y\n            dvx_dt = (Q * E0 / M) * np.cos(omega * t + phi) + OMEGA * vy\n            # dv_y/dt = -Omega*v_x\n            dvy_dt = -OMEGA * vx\n            # dv_z/dt = 0\n            dvz_dt = 0.0\n            return np.array([dvx_dt, dvy_dt, dvz_dt])\n\n        # Numerically integrate the equations of motion\n        sol = solve_ivp(\n            lorentz_force,\n            [0, T_END],\n            v0_vec,\n            method='RK45',      # Standard adaptive Runge-Kutta method\n            dense_output=True,  # Enable continuous solution\n            rtol=1e-8,          # Relative tolerance for accuracy\n            atol=1e-10          # Absolute tolerance for accuracy\n        )\n\n        # Define the instantaneous power function using the interpolated solution\n        def power_func(t):\n            # v_x(t) is the first component of the solution vector\n            vx_t = sol.sol(t)[0]\n            # P(t) = q * v_x(t) * E_x(t)\n            return Q * vx_t * (E0 * np.cos(omega * t + phi))\n\n        # Integrate P(t) from T1 to T2 using adaptive quadrature\n        integral_P, _ = quad(power_func, T1, T2)\n\n        # Calculate the time-averaged power\n        avg_power = integral_P / (T2 - T1)\n        results.append(avg_power)\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从单个粒子的微观相互作用，我们现在将视角放大到宏观的等离子体。这个问题模拟了电磁波在穿越磁场变化的等离子体时其能量如何被吸收。通过计算穿越共振层的光深，你将确定波的功率被等离子体吸收的总份额，这是设计聚变加热系统时的关键参数。",
            "id": "3963572",
            "problem": "考虑角频率为 $\\omega$ 的电子回旋（EC）波在具有缓慢变化的磁场强度 $B(s)$ 的磁化等离子体中沿着射线坐标 $s$ 传播。假设单位长度的局部功率衰减对于缓慢变化的介质遵循比尔-朗伯定律，并且回旋吸收局域在电子回旋共振附近。电子回旋频率为 $\\omega_{\\mathrm{ce}}(s) = \\frac{e}{m_{e}} B(s)$，其中 $e$ 是元电荷，$m_{e}$ 是电子质量。在共振点附近，将空间局域吸收系数建模为\n$$\n\\alpha(s) = \\alpha_{0} \\exp\\!\\left(-\\frac{\\big(\\omega - \\omega_{\\mathrm{ce}}(s)\\big)^{2}}{\\Delta^{2}}\\right),\n$$\n其中 $\\alpha_{0}$ 是一个恒定振幅，$\\Delta$ 是一个共振展宽参数（两者都严格为正）。设磁场沿射线线性变化，即 $B(s) = B_{r} + \\beta s$，其中 $\\beta > 0$，并选择 $B_{r}$ 使得回旋共振发生在 $s = 0$ 处，即 $\\frac{e}{m_{e}} B_{r} = \\omega$。假设射线穿过整个共振区，因此吸收积分可以在 $s \\in (-\\infty, +\\infty)$ 上进行近似计算。\n\n从电磁能量守恒和局部吸收系数的定义出发，推导光学深度\n$$\n\\tau = \\int_{-\\infty}^{+\\infty} \\alpha(s)\\, ds\n$$\n的表达式（用给定参数表示），然后确定吸收功率分数 $1 - \\exp(-\\tau)$。\n\n使用以下参数值：$\\omega = 2\\pi \\times 170 \\times 10^{9}\\ \\mathrm{rad/s}$，$\\alpha_{0} = 10\\ \\mathrm{m}^{-1}$，$\\Delta = 1.0 \\times 10^{10}\\ \\mathrm{rad/s}$，以及 $\\beta = 1.0\\ \\mathrm{T/m}$。对于基本常数，使用 $\\frac{e}{m_{e}} = 1.758820010 \\times 10^{11}\\ \\mathrm{s}^{-1}\\ \\mathrm{T}^{-1}$。将光学深度和吸收功率分数都四舍五入到四位有效数字。光学深度是无量纲的。将吸收功率分数表示为不带单位的小数。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**问题验证**\n\n**步骤1：提取的已知条件**\n- 波的角频率: $\\omega = 2\\pi \\times 170 \\times 10^{9}\\ \\mathrm{rad/s}$\n- 射线坐标: $s$\n- 磁场: $B(s) = B_{r} + \\beta s$，其中 $\\beta = 1.0\\ \\mathrm{T/m} > 0$\n- 电子回旋频率: $\\omega_{\\mathrm{ce}}(s) = \\frac{e}{m_{e}} B(s)$\n- 吸收系数: $\\alpha(s) = \\alpha_{0} \\exp\\!\\left(-\\frac{\\big(\\omega - \\omega_{\\mathrm{ce}}(s)\\big)^{2}}{\\Delta^{2}}\\right)$\n- 吸收振幅: $\\alpha_{0} = 10\\ \\mathrm{m}^{-1} > 0$\n- 共振展宽参数: $\\Delta = 1.0 \\times 10^{10}\\ \\mathrm{rad/s} > 0$\n- s=0处的共振条件: $\\frac{e}{m_{e}} B_{r} = \\omega$\n- 光学深度的积分域: $s \\in (-\\infty, +\\infty)$\n- 光学深度定义: $\\tau = \\int_{-\\infty}^{+\\infty} \\alpha(s)\\, ds$\n- 吸收功率分数: $1 - \\exp(-\\tau)$\n- 常数: $\\frac{e}{m_{e}} = 1.758820010 \\times 10^{11}\\ \\mathrm{s}^{-1}\\ \\mathrm{T}^{-1}$\n- 要求精度: 将最终数值答案四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题描述了磁化等离子体中的电子回旋共振吸收。使用高斯分布作为吸收系数是多普勒展宽共振的标准模型。用于衰减的比尔-朗伯定律和线性磁场近似在此背景下是标准且有效的。其物理原理是可靠的，并且是聚变等离子体科学的核心。\n- **适定性：** 该问题提供了计算所要求量所需的所有必要定义、函数和参数。光学深度的积分是一个收敛的高斯积分，确保了唯一且稳定解的存在。\n- **客观性：** 问题以精确、定量和无偏见的语言陈述。\n- **缺陷：** 问题陈述没有列出的缺陷。它是自洽的、科学正确的、可形式化的和适定的。所提供的数值对于现代聚变实验中的电子回旋加热是物理上现实的。\n\n**步骤3：结论与行动**\n问题是**有效的**。将推导解答。\n\n**推导与求解**\n\n目标是计算光学深度 $\\tau$，其定义为吸收系数 $\\alpha(s)$ 沿射线路径 $s$ 从 $-\\infty$ 到 $+\\infty$ 的积分。\n$$\n\\tau = \\int_{-\\infty}^{+\\infty} \\alpha(s)\\, ds\n$$\n吸收系数由下式给出\n$$\n\\alpha(s) = \\alpha_{0} \\exp\\!\\left(-\\frac{\\big(\\omega - \\omega_{\\mathrm{ce}}(s)\\big)^{2}}{\\Delta^{2}}\\right)\n$$\n其中 $\\omega_{\\mathrm{ce}}(s)$ 是局部电子回旋频率。该频率取决于沿射线线性变化的磁场 $B(s)$：\n$$\n\\omega_{\\mathrm{ce}}(s) = \\frac{e}{m_{e}} B(s) = \\frac{e}{m_{e}} (B_{r} + \\beta s) = \\frac{e}{m_{e}} B_{r} + \\left(\\frac{e \\beta}{m_{e}}\\right) s\n$$\n问题陈述共振条件 $\\omega = \\omega_{\\mathrm{ce}}$ 发生在 $s=0$ 处。这意味着 $\\omega = \\frac{e}{m_{e}} B_{r}$。将此代入 $\\omega_{\\mathrm{ce}}(s)$ 的表达式中，得到：\n$$\n\\omega_{\\mathrm{ce}}(s) = \\omega + \\left(\\frac{e \\beta}{m_{e}}\\right) s\n$$\n现在，我们计算 $\\alpha(s)$ 指数中的项：\n$$\n\\omega - \\omega_{\\mathrm{ce}}(s) = \\omega - \\left(\\omega + \\left(\\frac{e \\beta}{m_{e}}\\right) s\\right) = -\\left(\\frac{e \\beta}{m_{e}}\\right) s\n$$\n将此结果代回 $\\alpha(s)$ 的表达式中：\n$$\n\\alpha(s) = \\alpha_{0} \\exp\\!\\left(-\\frac{\\left(-\\left(\\frac{e \\beta}{m_{e}}\\right) s\\right)^{2}}{\\Delta^{2}}\\right) = \\alpha_{0} \\exp\\!\\left(-\\left(\\frac{e \\beta}{m_{e} \\Delta}\\right)^{2} s^{2}\\right)\n$$\n我们现在可以计算光学深度 $\\tau$ 的积分：\n$$\n\\tau = \\int_{-\\infty}^{+\\infty} \\alpha_{0} \\exp\\!\\left(-\\left(\\frac{e \\beta}{m_{e} \\Delta}\\right)^{2} s^{2}\\right) ds\n$$\n这是一个标准的高斯积分，形式为 $\\int_{-\\infty}^{+\\infty} C \\exp(-ax^{2}) dx = C\\sqrt{\\frac{\\pi}{a}}$。\n在我们的例子中，常数前因子是 $C=\\alpha_{0}$，指数中的系数是 $a = \\left(\\frac{e \\beta}{m_{e} \\Delta}\\right)^{2}$。\n进行积分得到光学深度的解析表达式：\n$$\n\\tau = \\alpha_{0} \\sqrt{\\frac{\\pi}{\\left(\\frac{e \\beta}{m_{e} \\Delta}\\right)^{2}}} = \\alpha_{0} \\frac{\\sqrt{\\pi}}{\\left|\\frac{e \\beta}{m_{e} \\Delta}\\right|}\n$$\n由于所有参数 $\\alpha_{0}$、$\\beta$、$\\Delta$、$e$ 和 $m_{e}$ 均为正，绝对值可以去掉。该表达式可以方便地用比率 $\\frac{e}{m_e}$ 重写：\n$$\n\\tau = \\frac{\\alpha_{0} \\Delta \\sqrt{\\pi}}{\\beta \\left(\\frac{e}{m_{e}}\\right)}\n$$\n这就是推导出的光学深度表达式。\n\n接下来，我们代入给定的数值来计算 $\\tau$：\n- $\\alpha_{0} = 10\\ \\mathrm{m}^{-1}$\n- $\\Delta = 1.0 \\times 10^{10}\\ \\mathrm{rad/s}$\n- $\\beta = 1.0\\ \\mathrm{T/m}$\n- $\\frac{e}{m_{e}} = 1.758820010 \\times 10^{11}\\ \\mathrm{s}^{-1}\\ \\mathrm{T}^{-1}$\n\n$$\n\\tau = \\frac{(10) \\cdot (1.0 \\times 10^{10}) \\cdot \\sqrt{\\pi}}{(1.0) \\cdot (1.758820010 \\times 10^{11})} = \\frac{10^{11} \\sqrt{\\pi}}{1.758820010 \\times 10^{11}} = \\frac{\\sqrt{\\pi}}{1.758820010}\n$$\n使用值 $\\sqrt{\\pi} \\approx 1.77245385$：\n$$\n\\tau \\approx \\frac{1.77245385}{1.758820010} \\approx 1.0077519\n$$\n四舍五入到四位有效数字，光学深度为 $\\tau \\approx 1.008$。\n\n最后，吸收功率分数（我们表示为 $f_{abs}$）由 $1 - \\exp(-\\tau)$ 给出。透射分数为 $\\exp(-\\tau)$，所以吸收分数是剩余部分。\n$$\nf_{abs} = 1 - \\exp(-\\tau)\n$$\n为确保准确性，使用未四舍五入的 $\\tau$ 值：\n$$\nf_{abs} = 1 - \\exp(-1.0077519) \\approx 1 - 0.3650261 = 0.6349739\n$$\n四舍五入到四位有效数字，吸收功率分数为 $f_{abs} \\approx 0.6350$。\n末尾的零是有效数字，必须包括在内。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.008  0.6350 \\end{pmatrix}}\n$$"
        }
    ]
}