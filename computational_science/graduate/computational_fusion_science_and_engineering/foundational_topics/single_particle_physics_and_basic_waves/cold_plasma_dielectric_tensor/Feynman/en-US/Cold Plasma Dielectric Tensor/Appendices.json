{
    "hands_on_practices": [
        {
            "introduction": "The macroscopic dielectric response of a plasma originates from the collective motion of its constituent charged particles. This first exercise is a foundational practice in deriving this response from first principles, starting with the linearized equation of motion for a single particle species. By solving for the velocity response to an applied electric field, you will construct the species susceptibility tensor, $\\boldsymbol{\\chi}_s(\\omega)$, which is the fundamental building block for the full cold plasma dielectric tensor .",
            "id": "3957239",
            "problem": "A homogeneous, magnetized, cold, multispecies plasma is driven by a small-amplitude monochromatic Radio Frequency (RF) electric field. The equilibrium magnetic field is uniform and static, $\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{z}}$, and the equilibrium number density $n_s$ is uniform for each species $s$ with charge $q_s$ and mass $m_s$. Collisional friction with an effective collision frequency $\\nu_s$ is included as a linear drag. Assume linear response, zero equilibrium flow, and neglect pressure and convective nonlinearities. Adopt the temporal and spatial dependence $\\exp\\!\\left(i\\,\\mathbf{k}\\cdot\\mathbf{r} - i\\,\\omega t\\right)$ for all perturbed fields and velocities.\n\nStarting from the linearized species momentum equation,\n$$\nm_s\\left(\\frac{\\partial \\mathbf{v}_s}{\\partial t} + \\nu_s \\mathbf{v}_s\\right) \\;=\\; q_s\\left(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0\\right),\n$$\nsolve algebraically for $\\mathbf{v}_s$ in terms of $\\mathbf{E}$ for a coordinate system with $\\mathbf{B}_0 \\parallel \\hat{\\mathbf{z}}$. Then, using the definitions of the species current density $\\mathbf{J}_s = n_s q_s \\mathbf{v}_s$, the polarization $\\mathbf{P}_s$ satisfying $\\mathbf{J}_s = -i\\,\\omega\\,\\mathbf{P}_s$, and the electric displacement relation $\\mathbf{D} = \\epsilon_0 \\mathbf{E} + \\sum_s \\mathbf{P}_s = \\epsilon_0\\left(\\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s(\\omega)\\right)\\mathbf{E}$, construct the species susceptibility tensor $\\boldsymbol{\\chi}_s(\\omega)$ as an explicit $3 \\times 3$ matrix in the basis $\\{\\hat{\\mathbf{x}},\\hat{\\mathbf{y}},\\hat{\\mathbf{z}}\\}$ aligned with $\\mathbf{B}_0$.\n\nExpress your final answer in closed form in terms of the species plasma frequency $\\omega_{ps}^2 \\equiv \\dfrac{n_s q_s^2}{\\epsilon_0 m_s}$, the signed cyclotron frequency $\\omega_{cs} \\equiv \\dfrac{q_s B_0}{m_s}$, the driving frequency $\\omega$, and the complex shifted frequency $\\tilde{\\omega}_s \\equiv \\omega + i\\,\\nu_s$. Provide the full tensor $\\boldsymbol{\\chi}_s(\\omega)$ as a single analytic expression. Do not simplify to special propagation angles. No numerical evaluation is required.",
            "solution": "The user wants to derive the species susceptibility tensor, $\\boldsymbol{\\chi}_s(\\omega)$, for a cold, magnetized, collisional plasma.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\n-   **Physical System**: A homogeneous, magnetized, cold, multispecies plasma.\n-   **Driving Field**: Small-amplitude monochromatic Radio Frequency (RF) electric field, $\\mathbf{E}$.\n-   **Equilibrium State**:\n    -   Magnetic field: $\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{z}}$ (uniform and static).\n    -   Number density: $n_s$ (uniform for each species $s$).\n    -   Species properties: charge $q_s$, mass $m_s$.\n    -   Flow: Zero equilibrium flow.\n-   **Dynamics and Assumptions**:\n    -   Linearized species momentum equation: $m_s\\left(\\frac{\\partial \\mathbf{v}_s}{\\partial t} + \\nu_s \\mathbf{v}_s\\right) \\;=\\; q_s\\left(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0\\right)$.\n    -   Collisions: Linear drag with effective collision frequency $\\nu_s$.\n    -   Assumptions: Linear response, neglect pressure and convective nonlinearities.\n    -   Field dependence: $\\exp\\!\\left(i\\,\\mathbf{k}\\cdot\\mathbf{r} - i\\,\\omega t\\right)$ for all perturbed quantities.\n-   **Definitions**:\n    -   Species current density: $\\mathbf{J}_s = n_s q_s \\mathbf{v}_s$.\n    -   Species polarization: $\\mathbf{J}_s = -i\\,\\omega\\,\\mathbf{P}_s$.\n    -   Electric displacement: $\\mathbf{D} = \\epsilon_0 \\mathbf{E} + \\sum_s \\mathbf{P}_s = \\epsilon_0\\left(\\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s(\\omega)\\right)\\mathbf{E}$.\n    -   Species plasma frequency: $\\omega_{ps}^2 \\equiv \\dfrac{n_s q_s^2}{\\epsilon_0 m_s}$.\n    -   Signed cyclotron frequency: $\\omega_{cs} \\equiv \\dfrac{q_s B_0}{m_s}$.\n    -   Complex shifted frequency: $\\tilde{\\omega}_s \\equiv \\omega + i\\,\\nu_s$.\n-   **Objective**: Construct the species susceptibility tensor $\\boldsymbol{\\chi}_s(\\omega)$ as an explicit $3 \\times 3$ matrix in the basis $\\{\\hat{\\mathbf{x}},\\hat{\\mathbf{y}},\\hat{\\mathbf{z}}\\}$.\n\n**1.2. Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The problem describes the standard derivation of the dielectric response of a cold plasma, a fundamental concept in plasma physics and computational fusion science. The governing equation and all associated definitions are standard textbook material. The model is scientifically valid.\n-   **Well-Posed**: The problem is clearly stated, providing a starting point (momentum equation) and a clear objective (derivation of $\\boldsymbol{\\chi}_s(\\omega)$) with all necessary intermediate definitions. A unique, stable, and meaningful solution exists.\n-   **Objective**: The problem is stated using precise, standard terminology from physics and mathematics. It is free from ambiguity and subjectivity.\n-   **Completeness**: All required data, definitions, and equations are provided. The problem is self-contained.\n-   **Consistency and Feasibility**: The assumptions and equations are consistent with the standard cold plasma model. The problem is a theoretical derivation, so questions of physical feasibility of specific parameters do not arise.\n\n**1.3. Verdict and Action**\n\nThe problem is valid. A detailed solution will be provided.\n\n### Step 2: Derivation of the Susceptibility Tensor\n\nThe derivation begins with the linearized momentum equation for a particle species $s$:\n$$\nm_s\\left(\\frac{\\partial \\mathbf{v}_s}{\\partial t} + \\nu_s \\mathbf{v}_s\\right) \\;=\\; q_s\\left(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0\\right)\n$$\nWe assume a harmonic time dependence of the form $\\exp(-i\\omega t)$ for all perturbed quantities. This implies the substitution $\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$. Applying this to the momentum equation gives:\n$$\nm_s (-i\\omega \\mathbf{v}_s + \\nu_s \\mathbf{v}_s) = q_s(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\nFactoring out $\\mathbf{v}_s$ on the left-hand side:\n$$\nm_s(-i\\omega + \\nu_s) \\mathbf{v}_s = q_s\\mathbf{E} + q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\nWe can express the term $(-i\\omega + \\nu_s)$ using the defined complex frequency $\\tilde{\\omega}_s = \\omega + i\\nu_s$:\n$$\n-i\\omega + \\nu_s = i(i\\omega + \\nu_s) = i(\\omega + i\\nu_s)\n$$\nThis is slightly incorrect, lets use the provided definition directly. $\\tilde{\\omega}_s = \\omega + i\\nu_s$. Then $-i\\tilde{\\omega}_s = -i(\\omega + i\\nu_s) = -i\\omega + \\nu_s$. So the substitution is correct.\n$$\nm_s(-i\\tilde{\\omega}_s) \\mathbf{v}_s = q_s \\mathbf{E} + q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\nTo solve for $\\mathbf{v}_s$, we rearrange the equation to group all terms containing $\\mathbf{v}_s$:\n$$\n-q_s \\mathbf{E} = i m_s \\tilde{\\omega}_s \\mathbf{v}_s + q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\nDividing by $m_s$ and using the definitions $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ and the signed cyclotron frequency $\\omega_{cs} = q_s B_0 / m_s$:\n$$\n-\\frac{q_s}{m_s} \\mathbf{E} = i \\tilde{\\omega}_s \\mathbf{v}_s + \\frac{q_s B_0}{m_s}(\\mathbf{v}_s \\times \\hat{\\mathbf{z}}) = i \\tilde{\\omega}_s \\mathbf{v}_s + \\omega_{cs}(\\mathbf{v}_s \\times \\hat{\\mathbf{z}})\n$$\nLet's express this single vector equation as a system of three scalar equations in a Cartesian coordinate system where $\\mathbf{v}_s = v_{sx}\\hat{\\mathbf{x}} + v_{sy}\\hat{\\mathbf{y}} + v_{sz}\\hat{\\mathbf{z}}$ and $\\mathbf{E} = E_{x}\\hat{\\mathbf{x}} + E_{y}\\hat{\\mathbf{y}} + E_{z}\\hat{\\mathbf{z}}$. The cross product is $\\mathbf{v}_s \\times \\hat{\\mathbf{z}} = v_{sy}\\hat{\\mathbf{x}} - v_{sx}\\hat{\\mathbf{y}}$.\nThe component equations are:\n\\begin{align*}\n\\text{x-component: } \\quad -\\frac{q_s}{m_s}E_x &= i\\tilde{\\omega}_s v_{sx} + \\omega_{cs} v_{sy} \\\\\n\\text{y-component: } \\quad -\\frac{q_s}{m_s}E_y &= i\\tilde{\\omega}_s v_{sy} - \\omega_{cs} v_{sx} \\\\\n\\text{z-component: } \\quad -\\frac{q_s}{m_s}E_z &= i\\tilde{\\omega}_s v_{sz}\n\\end{align*}\nThe z-component equation is solved directly:\n$$\nv_{sz} = \\frac{-q_s}{i m_s \\tilde{\\omega}_s} E_z = \\frac{i q_s}{m_s \\tilde{\\omega}_s} E_z\n$$\nThe x and y components form a $2 \\times 2$ linear system:\n$$\n\\begin{pmatrix} i\\tilde{\\omega}_s & \\omega_{cs} \\\\ -\\omega_{cs} & i\\tilde{\\omega}_s \\end{pmatrix} \\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = -\\frac{q_s}{m_s} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix}\n$$\nThe determinant of the matrix is $\\Delta = (i\\tilde{\\omega}_s)^2 - (\\omega_{cs})(-\\omega_{cs}) = -\\tilde{\\omega}_s^2 + \\omega_{cs}^2 = -(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)$.\nInverting the matrix to solve for $(v_{sx}, v_{sy})$:\n$$\n\\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = \\frac{1}{-(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} \\begin{pmatrix} i\\tilde{\\omega}_s & -\\omega_{cs} \\\\ \\omega_{cs} & i\\tilde{\\omega}_s \\end{pmatrix} \\left( -\\frac{q_s}{m_s} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix} \\right)\n$$\n$$\n\\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = \\frac{q_s}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} \\begin{pmatrix} i\\tilde{\\omega}_s E_x - \\omega_{cs} E_y \\\\ \\omega_{cs} E_x + i\\tilde{\\omega}_s E_y \\end{pmatrix}\n$$\nSo, the components of the velocity are:\n\\begin{align*}\nv_{sx} &= \\frac{q_s}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} (i\\tilde{\\omega}_s E_x - \\omega_{cs} E_y) \\\\\nv_{sy} &= \\frac{q_s}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} (\\omega_{cs} E_x + i\\tilde{\\omega}_s E_y) \\\\\nv_{sz} &= \\frac{i q_s}{m_s \\tilde{\\omega}_s} E_z\n\\end{align*}\nNow, we relate the species velocity $\\mathbf{v}_s$ to the species susceptibility tensor $\\boldsymbol{\\chi}_s(\\omega)$. We use the given chain of definitions:\n$$\n\\mathbf{J}_s = n_s q_s \\mathbf{v}_s\n$$\n$$\n\\mathbf{J}_s = -i\\omega \\mathbf{P}_s \\quad \\implies \\quad \\mathbf{P}_s = \\frac{i}{\\omega}\\mathbf{J}_s\n$$\n$$\n\\mathbf{D} = \\epsilon_0\\mathbf{E} + \\sum_s \\mathbf{P}_s = \\epsilon_0\\left(\\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s(\\omega)\\right)\\mathbf{E} \\quad \\implies \\quad \\mathbf{P}_s = \\epsilon_0 \\boldsymbol{\\chi}_s \\mathbf{E}\n$$\nCombining these, we find the direct relationship between $\\boldsymbol{\\chi}_s$ and $\\mathbf{v}_s$:\n$$\n\\epsilon_0 \\boldsymbol{\\chi}_s \\mathbf{E} = \\frac{i}{\\omega} (n_s q_s \\mathbf{v}_s) \\quad \\implies \\quad \\boldsymbol{\\chi}_s \\mathbf{E} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\mathbf{v}_s\n$$\nWe can now find the components of the tensor $\\boldsymbol{\\chi}_s$ by substituting the expressions for the components of $\\mathbf{v}_s$. Let us define the species mobility tensor $\\boldsymbol{\\mu}_s$ such that $\\mathbf{v}_s = \\boldsymbol{\\mu}_s \\mathbf{E}$. Then $\\boldsymbol{\\chi}_s = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\boldsymbol{\\mu}_s$.\nThe components of $\\boldsymbol{\\chi}_s$ are:\n$$\n\\chi_{s,xx} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sx}}{\\partial E_x} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (i\\tilde{\\omega}_s)}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{\\omega_{ps}^2 \\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,xy} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sx}}{\\partial E_y} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (-\\omega_{cs})}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{i n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{i \\omega_{ps}^2 \\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,yx} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sy}}{\\partial E_x} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (\\omega_{cs})}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = \\frac{i n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = \\frac{i \\omega_{ps}^2 \\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,yy} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sy}}{\\partial E_y} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (i\\tilde{\\omega}_s)}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{\\omega_{ps}^2 \\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,zz} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sz}}{\\partial E_z} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{i q_s}{m_s \\tilde{\\omega}_s} = -\\frac{n_s q_s^2}{\\epsilon_0 m_s} \\frac{1}{\\omega \\tilde{\\omega}_s} = -\\frac{\\omega_{ps}^2}{\\omega \\tilde{\\omega}_s}\n$$\nThe remaining components ($\\chi_{s,xz}, \\chi_{s,zx}, \\chi_{s,yz}, \\chi_{s,zy}$) are all zero. Assembling these components into a single matrix gives the species susceptibility tensor:\n$$\n\\boldsymbol{\\chi}_s(\\omega) = -\\frac{\\omega_{ps}^2}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n\\begin{pmatrix}\n\\tilde{\\omega}_s & i\\omega_{cs} & 0 \\\\\n-i\\omega_{cs} & \\tilde{\\omega}_s & 0 \\\\\n0 & 0 & \\frac{\\tilde{\\omega}_s^2 - \\omega_{cs}^2}{\\tilde{\\omega}_s}\n\\end{pmatrix}\n$$\nThis expression is the complete susceptibility tensor for species $s$ under the given conditions, expressed in terms of the specified parameters.",
            "answer": "$$\n\\boxed{\n\\boldsymbol{\\chi}_s(\\omega) = -\\frac{\\omega_{ps}^2}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n\\begin{pmatrix}\n\\tilde{\\omega}_s & i\\omega_{cs} & 0 \\\\\n-i\\omega_{cs} & \\tilde{\\omega}_s & 0 \\\\\n0 & 0 & \\frac{\\tilde{\\omega}_s^2 - \\omega_{cs}^2}{\\tilde{\\omega}_s}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With the dielectric tensor in hand, we can unlock its predictive power for describing wave phenomena. This practice focuses on one of the most fundamental cases: wave propagation parallel to the background magnetic field. You will see how the tensor's mathematical structure naturally leads to the discovery of the circularly polarized Right-hand (R) and Left-hand (L) modes and reveals their selective resonant interaction with particles based on the direction of their gyromotion .",
            "id": "3957253",
            "problem": "Consider a uniform, cold, magnetized plasma composed of multiple species indexed by $s$, each with equilibrium number density $n_{0s}$, charge $q_s$, and mass $m_s$, in a uniform static magnetic field $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$. The cyclotron frequency of species $s$ is defined as $\\Omega_s = q_s B_0 / m_s$, which may be positive or negative depending on $q_s$. Assume plane-wave perturbations with space-time dependence $\\exp(i k z - i \\omega t)$, where $\\mathbf{k} = k \\hat{\\mathbf{z}}$ is parallel to $\\mathbf{B}_0$, and restrict attention to transverse electromagnetic waves with electric field $\\mathbf{E} = E_x \\hat{\\mathbf{x}} + E_y \\hat{\\mathbf{y}}$.\n\nStarting only from the frequency-domain forms of Maxwell’s equations with harmonic time dependence, and the linearized cold-fluid momentum equation for each species $s$ (neglecting pressure and collisions),\n$$- i \\omega m_s \\mathbf{v}_s = q_s \\left( \\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0 \\right),$$\nderive the wave equation in terms of the cold-plasma dielectric tensor acting on $\\mathbf{E}$, reduce it for parallel propagation ($\\mathbf{k} \\parallel \\mathbf{B}_0$) to its in-plane ($x$–$y$) form, and compute the polarization eigenvectors corresponding to the two electromagnetic modes commonly denoted the “Right-hand (R) mode” and the “Left-hand (L) mode.”\n\nThen, by explicitly projecting the species momentum equation onto an appropriate circular basis and using the sign of $\\Omega_s$, demonstrate why these eigenvectors represent circular polarizations whose handedness is selected by the sign of the cyclotron frequency $\\operatorname{sgn}(\\Omega_s)$, in the sense that the circular component $\\mathbf{E}_+$ resonates for $\\Omega_s > 0$ while $\\mathbf{E}_-$ resonates for $\\Omega_s < 0$ at the respective cyclotron frequencies.\n\nProvide, as your final answer, the two normalized Cartesian-component eigenvectors for the R and L modes (in that order) as a single $3 \\times 2$ matrix whose columns are the eigenvectors. No numerical evaluation is required. Express your final answer purely in terms of the Cartesian unit vectors $\\hat{\\mathbf{x}}$ and $\\hat{\\mathbf{y}}$ components. No units are required, and no rounding is needed.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- Plasma model: Uniform, cold, magnetized, multiple species ($s$).\n- Species parameters: Equilibrium number density $n_{0s}$, charge $q_s$, mass $m_s$.\n- Magnetic field: $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$.\n- Cyclotron frequency: $\\Omega_s = q_s B_0 / m_s$.\n- Wave form: Plane wave, $\\exp(i k z - i \\omega t)$.\n- Wavevector: $\\mathbf{k} = k \\hat{\\mathbf{z}}$, parallel to $\\mathbf{B}_0$.\n- Wave polarization: Transverse electromagnetic, $\\mathbf{E} = E_x \\hat{\\mathbf{x}} + E_y \\hat{\\mathbf{y}}$, implying $E_z=0$ for the incident field.\n- Governing equations:\n    1. Frequency-domain Maxwell's equations.\n    2. Linearized cold-fluid momentum equation: $- i \\omega m_s \\mathbf{v}_s = q_s \\left( \\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0 \\right)$.\n- Assumptions: Pressure and collisions are neglected.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes the derivation of fundamental wave modes in a cold plasma, a cornerstone of plasma physics. The model and equations are standard and factually sound.\n- **Well-Posed**: The problem is a standard textbook derivation with a unique, well-defined solution for the wave polarizations.\n- **Objective**: The language is precise, and the setup is based on established physical formalisms.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation\nWe begin with the frequency-domain form of Maxwell's equations, assuming a time dependence of $\\exp(-i \\omega t)$ and no external sources:\n$$\n\\nabla \\times \\mathbf{E} = i \\omega \\mathbf{B}\n$$\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} - i \\omega \\mu_0 \\epsilon_0 \\mathbf{E}\n$$\nFor plane waves of the form $\\exp(i \\mathbf{k} \\cdot \\mathbf{r})$, the curl operator $\\nabla$ becomes $i \\mathbf{k}$. Substituting this into Maxwell's equations yields:\n$$\ni \\mathbf{k} \\times \\mathbf{E} = i \\omega \\mathbf{B} \\quad \\implies \\quad \\mathbf{B} = \\frac{\\mathbf{k} \\times \\mathbf{E}}{\\omega}\n$$\n$$\ni \\mathbf{k} \\times \\mathbf{B} = \\mu_0 \\mathbf{J} - \\frac{i \\omega}{c^2} \\mathbf{E}\n$$\nwhere we used $c^2 = 1/(\\mu_0 \\epsilon_0)$. Substituting the expression for $\\mathbf{B}$ into the second equation:\n$$\ni \\mathbf{k} \\times \\left( \\frac{\\mathbf{k} \\times \\mathbf{E}}{\\omega} \\right) = \\mu_0 \\mathbf{J} - \\frac{i \\omega}{c^2} \\mathbf{E}\n$$\nUsing the vector identity $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$, we get:\n$$\n\\frac{i}{\\omega} \\left( \\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} \\right) = \\mu_0 \\mathbf{J} - \\frac{i \\omega}{c^2} \\mathbf{E}\n$$\nMultiplying by $-i \\omega$ and rearranging gives:\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{E} = -i \\omega \\mu_0 \\mathbf{J}\n$$\nThe plasma's response is contained in the current density $\\mathbf{J}$, which is the sum of contributions from all species: $\\mathbf{J} = \\sum_s n_{0s} q_s \\mathbf{v}_s$. We define the dielectric tensor $\\boldsymbol{\\epsilon}$ via the relation $\\mathbf{D} = \\epsilon_0 \\boldsymbol{\\epsilon} \\cdot \\mathbf{E} = \\epsilon_0 \\mathbf{E} + \\mathbf{P}$, where $\\mathbf{J} = \\partial \\mathbf{P}/\\partial t = -i\\omega \\mathbf{P}$. This implies $\\mathbf{J} = -i\\omega(\\epsilon_0 \\boldsymbol{\\epsilon} \\cdot \\mathbf{E} - \\epsilon_0 \\mathbf{E}) = -i\\omega\\epsilon_0 (\\boldsymbol{\\epsilon} - \\mathbf{I}) \\cdot \\mathbf{E}$. Substituting this into the wave equation:\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{E} = -i \\omega \\mu_0 (-i \\omega \\epsilon_0 (\\boldsymbol{\\epsilon} - \\mathbf{I}) \\cdot \\mathbf{E})\n$$\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{E} = -\\frac{\\omega^2}{c^2} (\\boldsymbol{\\epsilon} - \\mathbf{I}) \\cdot \\mathbf{E}\n$$\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\boldsymbol{\\epsilon} \\cdot \\mathbf{E} = 0\n$$\nThis is the general wave equation. For propagation parallel to the magnetic field, $\\mathbf{k} = k \\hat{\\mathbf{z}}$ and $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$. The wave is transverse, so $\\mathbf{E} \\perp \\mathbf{k}$, which means $\\mathbf{k} \\cdot \\mathbf{E} = 0$. The wave equation simplifies to:\n$$\n-k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\boldsymbol{\\epsilon} \\cdot \\mathbf{E} = 0 \\quad \\implies \\quad \\left(\\boldsymbol{\\epsilon} - n^2 \\mathbf{I}\\right) \\cdot \\mathbf{E} = 0\n$$\nwhere $n=ck/\\omega$ is the refractive index.\n\nFor a cold magnetized plasma, $\\boldsymbol{\\epsilon}$ (often denoted $\\mathbf{K}$ in plasma literature) takes the form:\n$$\n\\boldsymbol{\\epsilon} = \\begin{pmatrix} S & -iD & 0 \\\\ iD & S & 0 \\\\ 0 & 0 & P \\end{pmatrix}\n$$\nwhere the components $S$, $D$, and $P$ are defined as:\n$$\nS = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}, \\quad D = \\sum_s \\frac{(\\Omega_s/\\omega)\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}, \\quad P = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2}\n$$\nwith $\\omega_{ps}^2 = n_{0s} q_s^2 / (\\epsilon_0 m_s)$ being the plasma frequency squared for species $s$.\n\nFor transverse waves with $\\mathbf{E} = E_x \\hat{\\mathbf{x}} + E_y \\hat{\\mathbf{y}}$, the wave equation $(\\boldsymbol{\\epsilon} - n^2 \\mathbf{I}) \\cdot \\mathbf{E} = 0$ reduces to its $x-y$ components:\n$$\n\\begin{pmatrix} S-n^2 & -iD \\\\ iD & S-n^2 \\end{pmatrix} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nFor a non-trivial solution, the determinant must be zero:\n$$\n(S-n^2)^2 - (-iD)(iD) = (S-n^2)^2 - D^2 = 0 \\quad \\implies \\quad n^2 = S \\mp D\n$$\nThese two solutions for $n^2$ correspond to the two transverse modes.\n\nTo find the polarization eigenvectors, we substitute these eigenvalues back into the matrix equation.\nCase 1: Right-hand (R) mode. The dispersion relation is conventionally taken as $n_R^2 = S - D$.\n$$\n(S - (S-D))E_x - iDE_y = 0 \\quad \\implies \\quad DE_x - iDE_y = 0 \\quad \\implies \\quad E_x = iE_y\n$$\nThis can be written as $E_y = -iE_x$. The eigenvector is proportional to $(\\hat{\\mathbf{x}} - i\\hat{\\mathbf{y}})$.\nCase 2: Left-hand (L) mode. The dispersion relation is $n_L^2 = S + D$.\n$$\n(S - (S+D))E_x - iDE_y = 0 \\quad \\implies \\quad -DE_x - iDE_y = 0 \\quad \\implies \\quad E_x = -iE_y\n$$\nThis can be written as $E_y = iE_x$. The eigenvector is proportional to $(\\hat{\\mathbf{x}} + i\\hat{\\mathbf{y}})$.\n\nTo understand the physical meaning, we project the momentum equation onto a circular basis. Define circular components for any vector $\\mathbf{A} = A_x\\hat{\\mathbf{x}} + A_y\\hat{\\mathbf{y}}$ as $A_\\pm = A_x \\pm iA_y$. Combining the $x$ and $y$ components of the momentum equation:\n$$\n-i\\omega(v_{sx} \\pm i v_{sy}) = \\frac{q_s}{m_s}(E_x \\pm i E_y) - (\\pm i \\Omega_s)(v_{sx} \\pm i v_{sy})\n$$\nThis gives two decoupled equations for the circular components $v_{s\\pm}$:\n$$\n-i\\omega v_{s+} = \\frac{q_s}{m_s} E_+ - i\\Omega_s v_{s+} \\quad \\implies \\quad v_{s+} = \\frac{i q_s/m_s}{\\omega - \\Omega_s} E_+\n$$\n$$\n-i\\omega v_{s-} = \\frac{q_s}{m_s} E_- + i\\Omega_s v_{s-} \\quad \\implies \\quad v_{s-} = \\frac{i q_s/m_s}{\\omega + \\Omega_s} E_-\n$$\nThe particle velocity response $v_{s+}$ shows a resonance when the wave frequency $\\omega$ matches the cyclotron frequency $\\Omega_s$. Since $\\omega>0$, this resonance occurs for particles with $\\Omega_s > 0$ (i.e., $q_s > 0$, positive ions).\nThe velocity response $v_{s-}$ shows a resonance when $\\omega = -\\Omega_s$. This occurs for particles with $\\Omega_s < 0$ (i.e., $q_s < 0$, electrons), since for them $\\Omega_s = -|\\Omega_s|$ and the resonance is at $\\omega = |\\Omega_s|$.\n\nNow connect this to the eigenvectors.\nFor the R-mode, $E_y = -iE_x$. Its circular components are:\n$E_+ = E_x + iE_y = E_x + i(-iE_x) = 2E_x$.\n$E_- = E_x - iE_y = E_x - i(-iE_x) = 0$.\nThe R-mode is a purely $E_+$ wave. This component resonates with particles where $\\Omega_s > 0$. Thus, the R-mode polarization (right-hand circular) resonates with positive ions, which also gyrate in a right-hand sense about $\\mathbf{B}_0$.\n\nFor the L-mode, $E_y = iE_x$. Its circular components are:\n$E_+ = E_x + iE_y = E_x + i(iE_x) = 0$.\n$E_- = E_x - iE_y = E_x - i(iE_x) = 2E_x$.\nThe L-mode is a purely $E_-$ wave. This component resonates with particles where $\\Omega_s < 0$. Thus, the L-mode polarization (left-hand circular) resonates with electrons, which gyrate in a left-hand sense about $\\mathbf{B}_0$.\n\nThis demonstrates the selective resonance of the circular polarizations based on the sign of the particle's charge, or equivalently, the sign of its cyclotron frequency $\\operatorname{sgn}(\\Omega_s)$.\n\nThe normalized eigenvectors are found by dividing by the magnitude. For $\\mathbf{v}_R \\propto (1, -i, 0)$, the squared magnitude is $1^2 + |-i|^2 = 2$. Normalizing gives $\\frac{1}{\\sqrt{2}}(1, -i, 0)$. For $\\mathbf{v}_L \\propto (1, i, 0)$, the squared magnitude is $1^2 + |i|^2 = 2$. Normalizing gives $\\frac{1}{\\sqrt{2}}(1, i, 0)$.\n\nThe final answer is a $3 \\times 2$ matrix with these normalized eigenvectors as columns.\nColumn 1 (R-mode): $\\left( \\frac{1}{\\sqrt{2}}, -\\frac{i}{\\sqrt{2}}, 0 \\right)^T$.\nColumn 2 (L-mode): $\\left( \\frac{1}{\\sqrt{2}}, \\frac{i}{\\sqrt{2}}, 0 \\right)^T$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} \\\\\n-\\frac{i}{\\sqrt{2}} & \\frac{i}{\\sqrt{2}} \\\\\n0 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "For computational scientists, bridging the gap between analytical theory and robust numerical implementation is a paramount skill. This exercise guides you through the process of building a computational solver for the dielectric tensor directly from the governing equations. A crucial aspect of this practice is verification, where you will confirm that your general-purpose magnetized plasma code correctly reproduces the well-established Drude model in the unmagnetized limit, a cornerstone of good scientific computing .",
            "id": "3957249",
            "problem": "You are to implement, from first principles, a computational verification that the unmagnetized limit of a cold-plasma dielectric solver yields a scalar permittivity consistent with a Drude model for each species. Start from the linearized, frequency-domain, cold-fluid momentum equation with a phenomenological collision frequency for each species, and the definition of the complex conductivity and dielectric tensors. Do not use any pre-derived cold-plasma tensor formulas; instead, construct the species current response by solving the $3 \\times 3$ linear system that relates the velocity to the electric field for an arbitrary background magnetic field vector. Then, take the unmagnetized limit by setting the background magnetic field to be vanishingly small or exactly zero, and confirm that, for each individual species, the dielectric tensor contribution becomes isotropic and equals the scalar Drude permittivity contribution for that species.\n\nFundamental starting point and definitions:\n- Use the linearized cold-fluid momentum equation for species $s$ in the frequency domain,\n  $$m_s \\left(\\nu_s - i \\omega\\right) \\mathbf{v}_s - q_s \\, \\mathbf{v}_s \\times \\mathbf{B}_0 = q_s \\, \\mathbf{E},$$\n  where $m_s$ is the species mass, $q_s$ is the species charge, $\\nu_s$ is the species-neutral collision frequency, $\\omega$ is the angular frequency, $\\mathbf{v}_s$ is the species velocity response, $\\mathbf{B}_0$ is the static background magnetic field, and $\\mathbf{E}$ is the harmonic electric field.\n- Define the cross-product operator matrix $\\mathbf{C}(\\mathbf{B}_0)$ by $\\mathbf{C}(\\mathbf{B}_0)\\,\\mathbf{v} = \\mathbf{v} \\times \\mathbf{B}_0$. With this, form the $3 \\times 3$ complex system matrix\n  $$\\mathbf{A}_s = \\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0).$$\n- Solve $\\mathbf{v}_s = \\frac{q_s}{m_s} \\mathbf{A}_s^{-1} \\mathbf{E}$ to obtain the species conductivity tensor $\\boldsymbol{\\sigma}_s = n_s q_s \\frac{q_s}{m_s} \\mathbf{A}_s^{-1}$, where $n_s$ is the species number density.\n- The dielectric tensor is related to the conductivity tensor by\n  $$\\boldsymbol{\\varepsilon} = \\mathbf{I} + \\frac{i}{\\varepsilon_0 \\omega} \\sum_s \\boldsymbol{\\sigma}_s,$$\n  where $\\varepsilon_0$ is the vacuum permittivity. The individual species contribution to the dielectric tensor is\n  $$\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\boldsymbol{\\sigma}_s.$$\n- In the strictly unmagnetized limit $\\mathbf{B}_0 = \\mathbf{0}$, the Drude-model scalar permittivity contribution for species $s$ is\n  $$\\varepsilon_{s,\\mathrm{Drude}} = - \\frac{\\omega_{p,s}^2}{\\omega \\left(\\omega + i \\nu_s\\right)}, \\quad \\omega_{p,s}^2 \\equiv \\frac{n_s q_s^2}{\\varepsilon_0 m_s}.$$\n\nYour program must:\n1. Implement the above procedure to compute $\\boldsymbol{\\varepsilon}_s$ for each species $s$ given $(n_s, q_s, m_s, \\nu_s)$, the angular frequency $\\omega$, and the background magnetic field vector $\\mathbf{B}_0$.\n2. Compute the scalar Drude permittivity $\\varepsilon_{s,\\mathrm{Drude}}$ for each species $s$ from the same parameters.\n3. For each test case listed below, verify that, in the unmagnetized limit (by using $\\mathbf{B}_0 = \\mathbf{0}$ or a sufficiently small $\\mathbf{B}_0$), the species-level tensor $\\boldsymbol{\\varepsilon}_s$ is isotropic and equals $\\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I}$ within a specified tolerance. Quantify the species-level relative error as\n   $$\\mathrm{err}_s = \\frac{\\left\\| \\boldsymbol{\\varepsilon}_s - \\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I} \\right\\|_F}{\\max\\left(1, \\left|\\varepsilon_{s,\\mathrm{Drude}}\\right|\\right)},$$\n   where $\\|\\cdot\\|_F$ is the Frobenius norm and $|\\cdot|$ is the complex modulus. A test case passes if $\\mathrm{err}_s \\le \\text{tol}$ for all species $s$ in that test case.\n\nPhysical units and constants:\n- Use the International System of Units (SI).\n- Number density $n_s$ in $\\mathrm{m}^{-3}$, charge $q_s$ in $\\mathrm{C}$, mass $m_s$ in $\\mathrm{kg}$, collision frequency $\\nu_s$ in $\\mathrm{s}^{-1}$.\n- Frequency is provided in hertz $f$; convert to angular frequency using $\\omega = 2 \\pi f$ in $\\mathrm{rad/s}$.\n- Background magnetic field $\\mathbf{B}_0$ is in $\\mathrm{T}$.\n- Use $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$, elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$, electron mass $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$, proton mass $m_p = 1.67262192369 \\times 10^{-27}\\,\\mathrm{kg}$, deuteron mass $m_D = 3.3435837724 \\times 10^{-27}\\,\\mathrm{kg}$, and fully ionized helium-4 ion mass $m_{\\mathrm{He}^{2+}} = 6.6464764 \\times 10^{-27}\\,\\mathrm{kg}$.\n\nTest suite:\n- Case 1 (exact unmagnetized boundary, two-species hydrogenic plasma):\n  - Species: electrons with $(n_e = 1.0 \\times 10^{19}, q_e = -e, m_e, \\nu_e = 1.0 \\times 10^{8})$, protons with $(n_p = 1.0 \\times 10^{19}, q_p = e, m_p, \\nu_p = 1.0 \\times 10^{5})$.\n  - Frequency: $f = 1.0 \\times 10^{10}\\,\\mathrm{Hz}$ (so $\\omega = 2\\pi f$).\n  - Magnetic field: $\\mathbf{B}_0 = (0, 0, 0)\\,\\mathrm{T}$.\n  - Tolerance: $\\text{tol} = 1.0 \\times 10^{-12}$.\n- Case 2 (small magnetic field, radiofrequency regime):\n  - Species: same as Case 1.\n  - Frequency: $f = 1.0 \\times 10^{6}\\,\\mathrm{Hz}$.\n  - Magnetic field: $\\mathbf{B}_0 = (0, 0, 1.0 \\times 10^{-9})\\,\\mathrm{T}$.\n  - Tolerance: $\\text{tol} = 1.0 \\times 10^{-7}$.\n- Case 3 (small magnetic field, very low frequency, finite collisionality):\n  - Species: electrons with $(n_e = 1.0 \\times 10^{18}, q_e = -e, m_e, \\nu_e = 5.0 \\times 10^{6})$, singly charged ions with $(n_i = 1.0 \\times 10^{18}, q_i = e, m_i = m_p, \\nu_i = 1.0 \\times 10^{4})$.\n  - Frequency: $f = 1.0 \\times 10^{3}\\,\\mathrm{Hz}$.\n  - Magnetic field: $\\mathbf{B}_0 = (0, 0, 1.0 \\times 10^{-13})\\,\\mathrm{T}$.\n  - Tolerance: $\\text{tol} = 1.0 \\times 10^{-5}$.\n- Case 4 (multispecies ions, small magnetic field):\n  - Species: electrons $(n_e = 2.0 \\times 10^{19}, q_e = -e, m_e, \\nu_e = 5.0 \\times 10^{7})$, deuterons $(n_D = 1.5 \\times 10^{19}, q_D = e, m_D, \\nu_D = 2.0 \\times 10^{5})$, fully ionized helium-4 $(n_{\\mathrm{He}^{2+}} = 2.5 \\times 10^{18}, q_{\\mathrm{He}^{2+}} = 2 e, m_{\\mathrm{He}^{2+}}, \\nu_{\\mathrm{He}^{2+}} = 3.0 \\times 10^{5})$.\n  - Frequency: $f = 1.0 \\times 10^{8}\\,\\mathrm{Hz}$.\n  - Magnetic field: $\\mathbf{B}_0 = (0, 0, 1.0 \\times 10^{-10})\\,\\mathrm{T}$.\n  - Tolerance: $\\text{tol} = 1.0 \\times 10^{-7}$.\n\nRequired final output:\n- For each of the four cases, output a boolean indicating whether all species in that case satisfy $\\mathrm{err}_s \\le \\text{tol}$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True,True]\") with exactly four boolean entries corresponding to Cases $1$ through $4$ in order.",
            "solution": "We begin from the linearized cold-fluid momentum equation with collisions for species $s$ in the frequency domain. Let the harmonic time dependence be $e^{-i \\omega t}$, and consider a static background magnetic field $\\mathbf{B}_0$. The equation is\n$$m_s \\left(\\nu_s - i \\omega\\right) \\mathbf{v}_s - q_s \\, \\mathbf{v}_s \\times \\mathbf{B}_0 = q_s \\, \\mathbf{E}.$$\nDefine the $3 \\times 3$ identity matrix $\\mathbf{I}$ and the cross-product operator matrix $\\mathbf{C}(\\mathbf{B}_0)$ by $\\mathbf{C}(\\mathbf{B}_0)\\,\\mathbf{v} = \\mathbf{v} \\times \\mathbf{B}_0$. In Cartesian components for $\\mathbf{B}_0 = (B_x, B_y, B_z)$, the matrix $\\mathbf{C}(\\mathbf{B}_0)$ is\n$$\\mathbf{C}(\\mathbf{B}_0) = \\begin{bmatrix}\n0 & B_z & -B_y \\\\\n-B_z & 0 & B_x \\\\\nB_y & -B_x & 0\n\\end{bmatrix},$$\nsince applying this matrix to $\\mathbf{v}$ yields the components of $\\mathbf{v} \\times \\mathbf{B}_0$.\n\nWe rewrite the momentum equation in operator form:\n$$\\left[m_s\\left(\\nu_s - i \\omega\\right) \\mathbf{I} - q_s \\mathbf{C}(\\mathbf{B}_0)\\right] \\mathbf{v}_s = q_s \\mathbf{E}.$$\nLet\n$$\\mathbf{A}_s \\equiv \\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0).$$\nThis matches the problem definition. Assuming $\\mathbf{A}_s$ is invertible for the parameters of interest, the velocity response is\n$$\\mathbf{v}_s = \\frac{q_s}{m_s} \\mathbf{A}_s^{-1} \\mathbf{E}.$$\n\nThe current density contribution from species $s$ is $\\mathbf{J}_s = n_s q_s \\mathbf{v}_s$, so the species conductivity tensor is\n$$\\boldsymbol{\\sigma}_s = n_s q_s \\frac{q_s}{m_s} \\mathbf{A}_s^{-1} = \\frac{n_s q_s^2}{m_s} \\mathbf{A}_s^{-1},$$\nwith the total conductivity $\\boldsymbol{\\sigma} = \\sum_s \\boldsymbol{\\sigma}_s$.\n\nThe relationship between the dielectric tensor $\\boldsymbol{\\varepsilon}$ and the conductivity tensor $\\boldsymbol{\\sigma}$ in the frequency domain is\n$$\\boldsymbol{\\varepsilon} = \\mathbf{I} + \\frac{i}{\\varepsilon_0 \\omega} \\boldsymbol{\\sigma},$$\nso the species-level dielectric contribution is\n$$\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\boldsymbol{\\sigma}_s = \\frac{i}{\\varepsilon_0 \\omega} \\frac{n_s q_s^2}{m_s} \\mathbf{A}_s^{-1}.$$\n\nIn the strictly unmagnetized case, set $\\mathbf{B}_0 = \\mathbf{0}$, which implies $\\mathbf{C}(\\mathbf{B}_0) = \\mathbf{0}$ and hence $\\mathbf{A}_s = \\left(\\nu_s - i \\omega\\right) \\mathbf{I}$. The inverse is $\\mathbf{A}_s^{-1} = \\left(\\nu_s - i \\omega\\right)^{-1} \\mathbf{I}$. Therefore,\n$$\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\frac{n_s q_s^2}{m_s} \\left(\\nu_s - i \\omega\\right)^{-1} \\mathbf{I}.$$\nUsing the plasma frequency squared $\\omega_{p,s}^2 \\equiv n_s q_s^2/(\\varepsilon_0 m_s)$, we obtain\n$$\\boldsymbol{\\varepsilon}_s = \\left[\\frac{i}{\\omega} \\frac{\\omega_{p,s}^2}{\\nu_s - i \\omega}\\right] \\mathbf{I}.$$\nNote that $\\frac{i}{\\nu_s - i\\omega} = \\frac{i(-i)}{(-i)(\\nu_s - i\\omega)} = \\frac{1}{\\omega + i\\nu_s}$. The unmagnetized $\\boldsymbol{\\varepsilon}_s$ simplifies to\n$$\\boldsymbol{\\varepsilon}_s = \\left[\\frac{\\omega_{p,s}^2}{\\omega \\left(\\omega + i \\nu_s\\right)}\\right] \\mathbf{I}.$$\nThis is incorrect by a minus sign compared to the Drude formula in the prompt. Let's re-check the original momentum equation.\nThe frequency-domain equation for a harmonic dependence $e^{-i\\omega t}$ is $m_s(-i\\omega \\mathbf{v}_s) = q_s(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0) - m_s \\nu_s \\mathbf{v}_s$.\n$m_s(\\nu_s - i\\omega)\\mathbf{v}_s = q_s(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0)$. The problem has it as $m_s(\\nu_s - i\\omega)\\mathbf{v}_s - q_s(\\mathbf{v}_s \\times \\mathbf{B}_0) = q_s\\mathbf{E}$, which is a correct rearrangement. The definitions seem consistent. Let's recheck the Drude derivation.\n$\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0\\omega} \\frac{n_s q_s^2}{m_s} \\frac{1}{\\nu_s-i\\omega} \\mathbf{I} = \\frac{\\omega_{p,s}^2}{\\omega} \\frac{i}{\\nu_s-i\\omega} \\mathbf{I}$.\n$\\frac{i}{\\nu_s-i\\omega} = \\frac{i(\\nu_s+i\\omega)}{(\\nu_s-i\\omega)(\\nu_s+i\\omega)} = \\frac{i\\nu_s - \\omega}{\\nu_s^2+\\omega^2}$.\nThe Drude formula given is $\\varepsilon_{s,\\mathrm{Drude}} = - \\frac{\\omega_{p,s}^2}{\\omega \\left(\\omega + i \\nu_s\\right)}$.\nLet's analyze this term: $-\\frac{1}{\\omega(\\omega+i\\nu_s)} = -\\frac{\\omega-i\\nu_s}{\\omega(\\omega^2+\\nu_s^2)}$.\nMy derivation from the tensor: $\\frac{i}{\\omega(\\nu_s-i\\omega)} = \\frac{i}{\\omega(\\nu_s-i\\omega)} \\frac{-i}{-i} = \\frac{1}{\\omega(-i\\nu_s-\\omega)} = -\\frac{1}{\\omega(\\omega+i\\nu_s)}$.\nThe derivation is correct, the formula is correct.\n\nFor a small but nonzero $\\mathbf{B}_0$, expand the operator inverse as a Neumann series in the small parameter $\\|\\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0)\\| / \\left|\\nu_s - i \\omega\\right|$. Up to first order,\n$$\\mathbf{A}_s^{-1} \\approx \\left(\\nu_s - i \\omega\\right)^{-1} \\left[\\mathbf{I} + \\frac{q_s}{m_s} \\left(\\nu_s - i \\omega\\right)^{-1} \\mathbf{C}(\\mathbf{B}_0) + \\cdots \\right],$$\nso the leading correction to $\\boldsymbol{\\varepsilon}_s$ is proportional to $\\left(\\frac{q_s \\|\\mathbf{B}_0\\|}{m_s}\\right)/\\left|\\nu_s - i \\omega\\right|$, which is the ratio of the cyclotron frequency scale $\\left|q_s\\right|\\|\\mathbf{B}_0\\|/m_s$ to the complex frequency scale $\\left|\\nu_s - i \\omega\\right|$. As $\\|\\mathbf{B}_0\\| \\to 0$, the anisotropic corrections vanish and $\\boldsymbol{\\varepsilon}_s \\to \\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I}$.\n\nAlgorithmic implementation:\n- Construct $\\mathbf{C}(\\mathbf{B}_0)$ from the components of $\\mathbf{B}_0$.\n- For each species $s$, form $\\mathbf{A}_s = \\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0)$ and compute $\\mathbf{A}_s^{-1}$ numerically.\n- Compute $\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\frac{n_s q_s^2}{m_s} \\mathbf{A}_s^{-1}$.\n- Compute the scalar Drude value $\\varepsilon_{s,\\mathrm{Drude}} = - \\omega_{p,s}^2 / \\left[\\omega \\left(\\omega + i \\nu_s\\right)\\right]$, where $\\omega_{p,s}^2 = n_s q_s^2 / (\\varepsilon_0 m_s)$.\n- Evaluate the species-level error metric $\\mathrm{err}_s = \\left\\| \\boldsymbol{\\varepsilon}_s - \\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I} \\right\\|_F / \\max\\left(1, \\left|\\varepsilon_{s,\\mathrm{Drude}}\\right|\\right)$.\n- For each test case, determine if all species satisfy $\\mathrm{err}_s \\le \\text{tol}$.\n\nTest suite coverage rationale:\n- Case $1$ verifies the exact equality at $\\mathbf{B}_0 = \\mathbf{0}$ for a typical hydrogenic plasma at microwave frequency; the tolerance is very strict.\n- Case $2$ tests the small-$\\mathbf{B}_0$ limit at radiofrequency where the cyclotron-to-frequency ratio is tiny; the tolerance is moderately strict to account for finite $\\mathbf{B}_0$.\n- Case $3$ explores a low-frequency, collisional regime with a very small magnetic field; the tolerance is relaxed to accommodate the relatively larger $\\left|q_s\\right|\\|\\mathbf{B}_0\\|/(m_s \\left|\\nu_s - i \\omega\\right|)$ parameter.\n- Case $4$ confirms multi-species additivity and per-species isotropy in the small-$\\mathbf{B}_0$ limit with different ion charges and masses.\n\nThe final output is a single line containing four boolean values in a comma-separated list enclosed in square brackets, corresponding to whether Cases $1$ through $4$ passed their per-species unmagnetized-limit verification as defined.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef cross_matrix(B):\n    \"\"\"\n    Construct the cross-product matrix C(B) such that C(B) @ v = v x B.\n    \"\"\"\n    Bx, By, Bz = B\n    return np.array([\n        [0.0,   Bz,  -By],\n        [-Bz,  0.0,   Bx],\n        [By,   -Bx,  0.0]\n    ], dtype=np.complex128)\n\ndef species_epsilon_tensor(n, q, m, nu, omega, B, eps0):\n    \"\"\"\n    Compute the dielectric tensor contribution for a single species using\n    the cold-fluid linear response:\n        epsilon_s = (i/(eps0 * omega)) * (n q^2 / m) * A^{-1}\n    where A = (nu - i*omega) I - (q/m) C(B).\n    \"\"\"\n    I = np.eye(3, dtype=np.complex128)\n    C = cross_matrix(B)\n    A = (nu - 1j*omega) * I - (q/m) * C\n    A_inv = np.linalg.inv(A)\n    sigma_s = (n * q * q / m) * A_inv  # conductivity tensor for species\n    epsilon_s_contribution = 1j * sigma_s / (eps0 * omega)\n    return epsilon_s_contribution\n\ndef drude_scalar(n, q, m, nu, omega, eps0):\n    \"\"\"\n    Scalar Drude permittivity contribution for one species:\n        epsilon_s = - omega_p^2 / (omega * (omega + i*nu))\n    where omega_p^2 = n q^2 / (eps0 m)\n    \"\"\"\n    omega_p2 = n * q * q / (eps0 * m)\n    return - omega_p2 / (omega * (omega + 1j * nu))\n\ndef relative_tensor_error(eps_tensor, scalar_val):\n    \"\"\"\n    Compute Frobenius-norm relative error of a 3x3 tensor versus scalar*I:\n        err = ||eps_tensor - scalar_val * I||_F / max(1, |scalar_val|)\n    \"\"\"\n    I = np.eye(3, dtype=np.complex128)\n    diff = eps_tensor - scalar_val * I\n    num = np.linalg.norm(diff, ord='fro')\n    den = max(1.0, abs(scalar_val))\n    return float(num / den)\n\ndef solve():\n    # Physical constants (SI)\n    eps0 = 8.8541878128e-12\n    e = 1.602176634e-19\n    m_e = 9.1093837015e-31\n    m_p = 1.67262192369e-27\n    m_D = 3.3435837724e-27\n    m_He2 = 6.6464764e-27\n\n    # Define the test cases\n    # Each case: dict with species list, frequency f (Hz), B vector (T), tolerance\n    test_cases = [\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 1.0e19, \"q\": -e, \"m\": m_e, \"nu\": 1.0e8},\n                {\"name\": \"p\", \"n\": 1.0e19, \"q\":  e, \"m\": m_p, \"nu\": 1.0e5},\n            ],\n            \"f_Hz\": 1.0e10,\n            \"B\": np.array([0.0, 0.0, 0.0]),\n            \"tol\": 1.0e-12,\n        },\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 1.0e19, \"q\": -e, \"m\": m_e, \"nu\": 1.0e8},\n                {\"name\": \"p\", \"n\": 1.0e19, \"q\":  e, \"m\": m_p, \"nu\": 1.0e5},\n            ],\n            \"f_Hz\": 1.0e6,\n            \"B\": np.array([0.0, 0.0, 1.0e-9]),\n            \"tol\": 1.0e-7,\n        },\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 1.0e18, \"q\": -e, \"m\": m_e, \"nu\": 5.0e6},\n                {\"name\": \"i\", \"n\": 1.0e18, \"q\":  e, \"m\": m_p, \"nu\": 1.0e4},\n            ],\n            \"f_Hz\": 1.0e3,\n            \"B\": np.array([0.0, 0.0, 1.0e-13]),\n            \"tol\": 1.0e-5,\n        },\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 2.0e19,  \"q\": -e,    \"m\": m_e,   \"nu\": 5.0e7},\n                {\"name\": \"D\", \"n\": 1.5e19, \"q\":  e,    \"m\": m_D,   \"nu\": 2.0e5},\n                {\"name\": \"He2\", \"n\": 2.5e18, \"q\":  2*e, \"m\": m_He2, \"nu\": 3.0e5},\n            ],\n            \"f_Hz\": 1.0e8,\n            \"B\": np.array([0.0, 0.0, 1.0e-10]),\n            \"tol\": 1.0e-7,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        omega = 2.0 * np.pi * case[\"f_Hz\"]\n        Bvec = case[\"B\"].astype(np.float64)\n        tol = case[\"tol\"]\n        all_species_ok = True\n        for sp in case[\"species\"]:\n            # Note: the total dielectric tensor is I + sum(eps_s_contrib).\n            # The problem asks to verify the species-level contribution eps_s_contrib.\n            eps_tensor_contrib = species_epsilon_tensor(\n                n=sp[\"n\"], q=sp[\"q\"], m=sp[\"m\"], nu=sp[\"nu\"], omega=omega, B=Bvec, eps0=eps0\n            )\n            drude_val_contrib = drude_scalar(\n                n=sp[\"n\"], q=sp[\"q\"], m=sp[\"m\"], nu=sp[\"nu\"], omega=omega, eps0=eps0\n            )\n            err = relative_tensor_error(eps_tensor_contrib, drude_val_contrib)\n            if not (err = tol):\n                all_species_ok = False\n                break\n        results.append(all_species_ok)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, [r.capitalize() for r in map(str, results)]))}]\")\n\nsolve()\n```"
        }
    ]
}