{
    "hands_on_practices": [
        {
            "introduction": "理解波与等离子体相互作用的基础在于介电张量，它描述了等离子体对电磁场的宏观响应。本练习将指导您从第一性原理出发，通过求解线性化的动量方程，推导出单个等离子体组分的磁化率张量 $\\boldsymbol{\\chi}_s$。这是构建完整介电张量的关键一步，也是将单个带电粒子的洛伦兹力运动与等离子体的集体响应联系起来的核心实践。",
            "id": "3957239",
            "problem": "一个均匀、磁化、冷的、多组分的等离子体由一个小振幅的单色射频（RF）电场驱动。平衡磁场是均匀且静态的，$\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{z}}$，且对于每个电荷为 $q_s$、质量为 $m_s$ 的组分 $s$，其平衡数密度 $n_s$ 是均匀的。其中包含了一个有效碰撞频率为 $\\nu_s$ 的碰撞摩擦，作为线性拖曳项。假设为线性响应，平衡流为零，并忽略压力和对流非线性项。对所有微扰场和速度，采用 $\\exp\\!\\left(i\\,\\mathbf{k}\\cdot\\mathbf{r} - i\\,\\omega t\\right)$ 的时空依赖形式。\n\n从线性化的组分动量方程出发，\n$$\nm_s\\left(\\frac{\\partial \\mathbf{v}_s}{\\partial t} + \\nu_s \\mathbf{v}_s\\right) \\;=\\; q_s\\left(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0\\right),\n$$\n对于一个 $\\mathbf{B}_0 \\parallel \\hat{\\mathbf{z}}$ 的坐标系，用代数方法求解 $\\mathbf{v}_s$ 关于 $\\mathbf{E}$ 的表达式。然后，利用组分电流密度 $\\mathbf{J}_s = n_s q_s \\mathbf{v}_s$、极化强度 $\\mathbf{P}_s$ 满足 $\\mathbf{J}_s = -i\\,\\omega\\,\\mathbf{P}_s$ 以及电位移关系 $\\mathbf{D} = \\epsilon_0 \\mathbf{E} + \\sum_s \\mathbf{P}_s = \\epsilon_0\\left(\\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s(\\omega)\\right)\\mathbf{E}$ 的定义，在与 $\\mathbf{B}_0$ 对齐的基 $\\{\\hat{\\mathbf{x}},\\hat{\\mathbf{y}},\\hat{\\mathbf{z}}\\}$ 上，将组分电极化率张量 $\\boldsymbol{\\chi}_s(\\omega)$ 构建为一个显式的 $3 \\times 3$ 矩阵。\n\n以组分等离子体频率 $\\omega_{ps}^2 \\equiv \\dfrac{n_s q_s^2}{\\epsilon_0 m_s}$、带符号的回旋频率 $\\omega_{cs} \\equiv \\dfrac{q_s B_0}{m_s}$、驱动频率 $\\omega$ 以及复频移 $\\tilde{\\omega}_s \\equiv \\omega + i\\,\\nu_s$ 的形式，用闭合形式表达你的最终答案。以单一解析表达式的形式给出完整的张量 $\\boldsymbol{\\chi}_s(\\omega)$。不要针对特殊的传播角度进行简化。不需要进行数值计算。",
            "solution": "用户希望推导出冷、磁化、有碰撞的等离子体的组分电极化率张量 $\\boldsymbol{\\chi}_s(\\omega)$。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n-   **物理系统**：一个均匀、磁化、冷的、多组分的等离子体。\n-   **驱动场**：小振幅单色射频（RF）电场 $\\mathbf{E}$。\n-   **平衡态**：\n    -   磁场：$\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{z}}$（均匀且静态）。\n    -   数密度：$n_s$（对每个组分 $s$ 均为常数）。\n    -   组分属性：电荷 $q_s$，质量 $m_s$。\n    -   流：平衡流为零。\n-   **动力学与假设**：\n    -   线性化的组分动量方程：$m_s\\left(\\frac{\\partial \\mathbf{v}_s}{\\partial t} + \\nu_s \\mathbf{v}_s\\right) \\;=\\; q_s\\left(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0\\right)$。\n    -   碰撞：有效碰撞频率为 $\\nu_s$ 的线性拖曳。\n    -   假设：线性响应，忽略压力和对流非线性项。\n    -   场依赖性：所有微扰量均具有 $\\exp\\!\\left(i\\,\\mathbf{k}\\cdot\\mathbf{r} - i\\,\\omega t\\right)$ 的形式。\n-   **定义**：\n    -   组分电流密度：$\\mathbf{J}_s = n_s q_s \\mathbf{v}_s$。\n    -   组分极化强度：$\\mathbf{J}_s = -i\\,\\omega\\,\\mathbf{P}_s$。\n    -   电位移：$\\mathbf{D} = \\epsilon_0 \\mathbf{E} + \\sum_s \\mathbf{P}_s = \\epsilon_0\\left(\\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s(\\omega)\\right)\\mathbf{E}$。\n    -   组分等离子体频率：$\\omega_{ps}^2 \\equiv \\dfrac{n_s q_s^2}{\\epsilon_0 m_s}$。\n    -   带符号的回旋频率：$\\omega_{cs} \\equiv \\dfrac{q_s B_0}{m_s}$。\n    -   复频移：$\\tilde{\\omega}_s \\equiv \\omega + i\\,\\nu_s$。\n-   **目标**：在基 $\\{\\hat{\\mathbf{x}},\\hat{\\mathbf{y}},\\hat{\\mathbf{z}}\\}$ 上将组分电极化率张量 $\\boldsymbol{\\chi}_s(\\omega)$ 构建为一个显式的 $3 \\times 3$ 矩阵。\n\n**1.2. 使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题描述了冷等离子体介电响应的标准推导，这是等离子体物理和计算聚变科学中的一个基本概念。控制方程和所有相关定义都是标准的教科书内容。该模型在科学上是有效的。\n-   **适定性**：问题陈述清晰，提供了一个起点（动量方程）和一个明确的目标（推导 $\\boldsymbol{\\chi}_s(\\omega)$），并包含了所有必要的中间定义。存在唯一、稳定且有意义的解。\n-   **客观性**：问题使用物理学和数学中精确、标准的术语进行陈述。它没有歧义和主观性。\n-   **完整性**：所有需要的数据、定义和方程都已提供。问题是自洽的。\n-   **一致性与可行性**：假设和方程与标准的冷等离子体模型一致。该问题是一个理论推导，因此不涉及特定参数的物理可行性问题。\n\n**1.3. 结论与行动**\n\n问题有效。将提供详细的解决方案。\n\n### 步骤 2：电极化率张量的推导\n\n推导从组分 $s$ 的线性化动量方程开始：\n$$\nm_s\\left(\\frac{\\partial \\mathbf{v}_s}{\\partial t} + \\nu_s \\mathbf{v}_s\\right) \\;=\\; q_s\\left(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0\\right)\n$$\n我们假设所有微扰量都具有 $\\exp(-i\\omega t)$ 形式的谐波时间依赖性。这意味着可以进行替换 $\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$。将此应用于动量方程，得到：\n$$\nm_s (-i\\omega \\mathbf{v}_s + \\nu_s \\mathbf{v}_s) = q_s(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n在左侧提取公因子 $\\mathbf{v}_s$：\n$$\nm_s(-i\\omega + \\nu_s) \\mathbf{v}_s = q_s\\mathbf{E} + q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n我们可以使用定义的复数频率 $\\tilde{\\omega}_s = \\omega + i\\nu_s$ 来表示项 $(-i\\omega + \\nu_s)$：\n$$\n-i\\omega + \\nu_s = i(-i\\nu_s - \\omega) = -i(\\omega + i\\nu_s) = -i\\tilde{\\omega}_s\n$$\n这部分推导有误。正确的应为：\n$$\nm_s( \\nu_s - i\\omega ) \\mathbf{v}_s = q_s(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n$$\nm_s(-i(\\omega + i\\nu_s)) \\mathbf{v}_s = q_s\\mathbf{E} + q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n$$\n-i m_s \\tilde{\\omega}_s \\mathbf{v}_s = q_s \\mathbf{E} + q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n为了求解 $\\mathbf{v}_s$，我们重新整理方程，将所有包含 $\\mathbf{v}_s$ 的项组合在一起：\n$$\nq_s \\mathbf{E} = -i m_s \\tilde{\\omega}_s \\mathbf{v}_s - q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n$$\n-q_s \\mathbf{E} = i m_s \\tilde{\\omega}_s \\mathbf{v}_s + q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n两边除以 $m_s$，并使用定义 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 和带符号的回旋频率 $\\omega_{cs} = q_s B_0 / m_s$：\n$$\n-\\frac{q_s}{m_s} \\mathbf{E} = i \\tilde{\\omega}_s \\mathbf{v}_s + \\frac{q_s B_0}{m_s}(\\mathbf{v}_s \\times \\hat{\\mathbf{z}}) = i \\tilde{\\omega}_s \\mathbf{v}_s + \\omega_{cs}(\\mathbf{v}_s \\times \\hat{\\mathbf{z}})\n$$\n让我们将这个矢量方程表示为笛卡尔坐标系中的三个标量方程组，其中 $\\mathbf{v}_s = v_{sx}\\hat{\\mathbf{x}} + v_{sy}\\hat{\\mathbf{y}} + v_{sz}\\hat{\\mathbf{z}}$ 且 $\\mathbf{E} = E_{x}\\hat{\\mathbf{x}} + E_{y}\\hat{\\mathbf{y}} + E_{z}\\hat{\\mathbf{z}}$。叉积为 $\\mathbf{v}_s \\times \\hat{\\mathbf{z}} = v_{sy}\\hat{\\mathbf{x}} - v_{sx}\\hat{\\mathbf{y}}$。\n分量方程为：\n\\begin{align*}\n\\text{x-分量: } \\quad -\\frac{q_s}{m_s}E_x = i\\tilde{\\omega}_s v_{sx} + \\omega_{cs} v_{sy} \\\\\n\\text{y-分量: } \\quad -\\frac{q_s}{m_s}E_y = i\\tilde{\\omega}_s v_{sy} - \\omega_{cs} v_{sx} \\\\\n\\text{z-分量: } \\quad -\\frac{q_s}{m_s}E_z = i\\tilde{\\omega}_s v_{sz}\n\\end{align*}\nz-分量方程可直接求解：\n$$\nv_{sz} = \\frac{-q_s}{i m_s \\tilde{\\omega}_s} E_z = \\frac{i q_s}{m_s \\tilde{\\omega}_s} E_z\n$$\nx和y分量构成一个 $2 \\times 2$ 线性方程组：\n$$\n\\begin{pmatrix} i\\tilde{\\omega}_s  \\omega_{cs} \\\\ -\\omega_{cs}  i\\tilde{\\omega}_s \\end{pmatrix} \\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = -\\frac{q_s}{m_s} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix}\n$$\n该矩阵的行列式为 $\\Delta = (i\\tilde{\\omega}_s)^2 - (\\omega_{cs})(-\\omega_{cs}) = -\\tilde{\\omega}_s^2 + \\omega_{cs}^2 = -(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)$。\n对矩阵求逆以求解 $(v_{sx}, v_{sy})$：\n$$\n\\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = \\frac{1}{-(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} \\begin{pmatrix} i\\tilde{\\omega}_s  -\\omega_{cs} \\\\ \\omega_{cs}  i\\tilde{\\omega}_s \\end{pmatrix} \\left( -\\frac{q_s}{m_s} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix} \\right)\n$$\n$$\n\\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = \\frac{q_s}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} \\begin{pmatrix} i\\tilde{\\omega}_s E_x - \\omega_{cs} E_y \\\\ \\omega_{cs} E_x + i\\tilde{\\omega}_s E_y \\end{pmatrix}\n$$\n因此，速度的分量为：\n\\begin{align*}\nv_{sx} = \\frac{q_s}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} (i\\tilde{\\omega}_s E_x - \\omega_{cs} E_y) \\\\\nv_{sy} = \\frac{q_s}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} (\\omega_{cs} E_x + i\\tilde{\\omega}_s E_y) \\\\\nv_{sz} = \\frac{i q_s}{m_s \\tilde{\\omega}_s} E_z\n\\end{align*}\n现在，我们将组分速度 $\\mathbf{v}_s$ 与组分电极化率张量 $\\boldsymbol{\\chi}_s(\\omega)$ 联系起来。我们使用给定的定义链：\n$$\n\\mathbf{J}_s = n_s q_s \\mathbf{v}_s\n$$\n$$\n\\mathbf{J}_s = -i\\omega \\mathbf{P}_s \\quad \\implies \\quad \\mathbf{P}_s = \\frac{i}{\\omega}\\mathbf{J}_s\n$$\n$$\n\\mathbf{D} = \\epsilon_0\\mathbf{E} + \\sum_s \\mathbf{P}_s = \\epsilon_0\\left(\\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s(\\omega)\\right)\\mathbf{E} \\quad \\implies \\quad \\mathbf{P}_s = \\epsilon_0 \\boldsymbol{\\chi}_s \\mathbf{E}\n$$\n结合这些，我们找到 $\\boldsymbol{\\chi}_s$ 和 $\\mathbf{v}_s$ 之间的直接关系：\n$$\n\\epsilon_0 \\boldsymbol{\\chi}_s \\mathbf{E} = \\frac{i}{\\omega} (n_s q_s \\mathbf{v}_s) \\quad \\implies \\quad \\boldsymbol{\\chi}_s \\mathbf{E} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\mathbf{v}_s\n$$\n现在我们可以通过代入 $\\mathbf{v}_s$ 各分量的表达式来求出张量 $\\boldsymbol{\\chi}_s$ 的分量。让我们定义组分迁移率张量 $\\boldsymbol{\\mu}_s$ 使得 $\\mathbf{v}_s = \\boldsymbol{\\mu}_s \\mathbf{E}$。那么 $\\boldsymbol{\\chi}_s = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\boldsymbol{\\mu}_s$。\n$\\boldsymbol{\\chi}_s$ 的分量为：\n$$\n\\chi_{s,xx} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sx}}{\\partial E_x} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (i\\tilde{\\omega}_s)}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{\\omega_{ps}^2 \\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,xy} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sx}}{\\partial E_y} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (-\\omega_{cs})}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{i n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{i \\omega_{ps}^2 \\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,yx} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sy}}{\\partial E_x} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (\\omega_{cs})}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = \\frac{i n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = \\frac{i \\omega_{ps}^2 \\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,yy} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sy}}{\\partial E_y} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (i\\tilde{\\omega}_s)}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{\\omega_{ps}^2 \\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,zz} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sz}}{\\partial E_z} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{i q_s}{m_s \\tilde{\\omega}_s} = -\\frac{n_s q_s^2}{\\epsilon_0 m_s} \\frac{1}{\\omega \\tilde{\\omega}_s} = -\\frac{\\omega_{ps}^2}{\\omega \\tilde{\\omega}_s}\n$$\n其余分量（$\\chi_{s,xz}, \\chi_{s,zx}, \\chi_{s,yz}, \\chi_{s,zy}$）均为零。将这些分量组合成一个矩阵，便得到组分电极化率张量：\n$$\n\\boldsymbol{\\chi}_s(\\omega) = -\\frac{\\omega_{ps}^2}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n\\begin{pmatrix}\n\\tilde{\\omega}_s  i\\omega_{cs}  0 \\\\\n-i\\omega_{cs}  \\tilde{\\omega}_s  0 \\\\\n0  0  \\frac{\\tilde{\\omega}_s^2 - \\omega_{cs}^2}{\\tilde{\\omega}_s}\n\\end{pmatrix}\n$$\n该表达式是在给定条件下，用指定参数表示的组分 $s$ 的完整电极化率张量。",
            "answer": "$$\n\\boxed{\n-\\frac{\\omega_{ps}^2}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n\\begin{pmatrix}\n\\tilde{\\omega}_s   i\\omega_{cs}   0 \\\\\n-i\\omega_{cs}   \\tilde{\\omega}_s   0 \\\\\n0   0   \\frac{\\tilde{\\omega}_s^2 - \\omega_{cs}^2}{\\tilde{\\omega}_s}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "掌握了介电张量的形式之后，我们便可以探究它如何决定波的传播特性。本练习将介电张量应用于波沿磁场方向传播的特定情况，揭示了右旋和左旋圆偏振波这两种基本本征模的存在。理解这些本征模是解读许多等离子体波现象（包括回旋共振）的关键。",
            "id": "3957253",
            "problem": "考虑一个由多种粒子（下标为 $s$）组成的均匀冷磁化等离子体，每种粒子的平衡数密度为 $n_{0s}$、电荷为 $q_s$、质量为 $m_s$。该等离子体处于均匀静磁场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 中。粒子 $s$ 的回旋频率定义为 $\\Omega_s = q_s B_0 / m_s$，其正负取决于 $q_s$ 的符号。假设存在时空依赖关系为 $\\exp(i k z - i \\omega t)$ 的平面波微扰，其中波矢 $\\mathbf{k} = k \\hat{\\mathbf{z}}$ 平行于 $\\mathbf{B}_0$。我们只关注电场为 $\\mathbf{E} = E_x \\hat{\\mathbf{x}} + E_y \\hat{\\mathbf{y}}$ 的横向电磁波。\n\n仅从具有谐波时间依赖的频域麦克斯韦方程组以及每种粒子 $s$ 的线性化冷流体动量方程（忽略压强和碰撞）出发，\n$$- i \\omega m_s \\mathbf{v}_s = q_s \\left( \\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0 \\right),$$\n推导以作用于 $\\mathbf{E}$ 的冷等离子体介电张量表示的波动方程，并针对平行传播（$\\mathbf{k} \\parallel \\mathbf{B}_0$）的情况，将其简化为面内（$x$–$y$）形式，然后计算通常被称为“右旋（R）模”和“左旋（L）模”的两种电磁模式所对应的极化本征矢量。\n\n然后，通过将粒子动量方程显式地投影到合适的圆极化基上，并利用 $\\Omega_s$ 的符号，论证为何这些本征矢量代表圆极化，其手性由回旋频率的符号 $\\operatorname{sgn}(\\Omega_s)$ 决定，即圆极化分量 $\\mathbf{E}_+$ 在 $\\Omega_s  0$ 时在其回旋频率处发生共振，而 $\\mathbf{E}_-$ 在 $\\Omega_s  0$ 时在其回旋频率处发生共振。\n\n以一个 $3 \\times 2$ 矩阵的形式给出 R 模和 L 模（按此顺序）的两个归一化笛卡尔分量本征矢量，矩阵的列即为本征矢量。此为您的最终答案。无需进行数值计算。将您的最终答案纯粹用笛卡尔单位矢量 $\\hat{\\mathbf{x}}$ 和 $\\hat{\\mathbf{y}}$ 的分量来表示。无需单位，也无需四舍五入。",
            "solution": "首先验证问题，以确保其科学上合理、内容完整且适定。\n\n### 第 1 步：提取已知条件\n- 等离子体模型：均匀、冷、磁化、多组分（$s$）。\n- 粒子参数：平衡数密度 $n_{0s}$、电荷 $q_s$、质量 $m_s$。\n- 磁场：$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$。\n- 回旋频率：$\\Omega_s = q_s B_0 / m_s$。\n- 波形：平面波，$\\exp(i k z - i \\omega t)$。\n- 波矢：$\\mathbf{k} = k \\hat{\\mathbf{z}}$，平行于 $\\mathbf{B}_0$。\n- 波的极化：横向电磁波，$\\mathbf{E} = E_x \\hat{\\mathbf{x}} + E_y \\hat{\\mathbf{y}}$，意味着入射场的 $E_z=0$。\n- 控制方程：\n    1. 频域麦克斯韦方程组。\n    2. 线性化冷流体动量方程：$- i \\omega m_s \\mathbf{v}_s = q_s \\left( \\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0 \\right)$。\n- 假设：忽略压强和碰撞。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了冷等离子体中基本波模的推导，这是等离子体物理学的基石。所用模型和方程都是标准的，且符合事实。\n- **适定性**：该问题是一个标准的教科书式推导，对于波的极化有唯一且明确的解。\n- **客观性**：问题语言精确，其设定基于已建立的物理形式体系。\n\n### 第 3 步：结论与操作\n该问题是有效的。将提供完整解答。\n\n### 推导过程\n我们从频域形式的麦克斯韦方程组开始，假设时间依赖关系为 $\\exp(-i \\omega t)$ 且没有外部源：\n$$\n\\nabla \\times \\mathbf{E} = i \\omega \\mathbf{B}\n$$\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} - i \\omega \\mu_0 \\epsilon_0 \\mathbf{E}\n$$\n对于形式为 $\\exp(i \\mathbf{k} \\cdot \\mathbf{r})$ 的平面波，旋度算符 $\\nabla$ 变为 $i \\mathbf{k}$。将此代入麦克斯韦方程组，得到：\n$$\ni \\mathbf{k} \\times \\mathbf{E} = i \\omega \\mathbf{B} \\quad \\implies \\quad \\mathbf{B} = \\frac{\\mathbf{k} \\times \\mathbf{E}}{\\omega}\n$$\n$$\ni \\mathbf{k} \\times \\mathbf{B} = \\mu_0 \\mathbf{J} - \\frac{i \\omega}{c^2} \\mathbf{E}\n$$\n此处我们使用了 $c^2 = 1/(\\mu_0 \\epsilon_0)$。将 $\\mathbf{B}$ 的表达式代入第二个方程：\n$$\ni \\mathbf{k} \\times \\left( \\frac{\\mathbf{k} \\times \\mathbf{E}}{\\omega} \\right) = \\mu_0 \\mathbf{J} - \\frac{i \\omega}{c^2} \\mathbf{E}\n$$\n使用矢量恒等式 $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$，我们得到：\n$$\n\\frac{i}{\\omega} \\left( \\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} \\right) = \\mu_0 \\mathbf{J} - \\frac{i \\omega}{c^2} \\mathbf{E}\n$$\n两边乘以 $-i \\omega$ 并重新整理，得到：\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{E} = -i \\omega \\mu_0 \\mathbf{J}\n$$\n等离子体的响应包含在电流密度 $\\mathbf{J}$ 中，它是所有粒子贡献的总和：$\\mathbf{J} = \\sum_s n_{0s} q_s \\mathbf{v}_s$。我们通过关系式 $\\mathbf{J} = -i \\omega \\epsilon_0 (\\mathbf{K} - \\mathbf{I}) \\cdot \\mathbf{E}$ 来定义介电张量 $\\mathbf{K}$，其中 $\\mathbf{I}$ 是单位张量。将此代入波动方程：\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{E} = -i \\omega \\mu_0 (-i \\omega \\epsilon_0 (\\mathbf{K} - \\mathbf{I}) \\cdot \\mathbf{E})\n$$\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{E} = -\\frac{\\omega^2}{c^2} (\\mathbf{K} - \\mathbf{I}) \\cdot \\mathbf{E}\n$$\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E} = 0\n$$\n这是一般的波动方程。对于平行于磁场的传播，有 $\\mathbf{k} = k \\hat{\\mathbf{z}}$ 和 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$。波是横向的，所以 $\\mathbf{E} \\perp \\mathbf{k}$，这意味着 $\\mathbf{k} \\cdot \\mathbf{E} = 0$。波动方程简化为：\n$$\n-k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E} = 0 \\quad \\implies \\quad \\left(\\mathbf{K} - n^2 \\mathbf{I}\\right) \\cdot \\mathbf{E} = 0\n$$\n其中 $n=ck/\\omega$ 是折射率。\n\n为了求出 $\\mathbf{K}$，我们求解 $\\mathbf{v}_s$ 的线性化动量方程：\n$$\n-i \\omega m_s \\mathbf{v}_s = q_s \\mathbf{E} + q_s (\\mathbf{v}_s \\times B_0 \\hat{\\mathbf{z}})\n$$\n用笛卡尔分量表示，方程为：\n$$\n-i \\omega m_s v_{sx} = q_s E_x + q_s v_{sy} B_0\n$$\n$$\n-i \\omega m_s v_{sy} = q_s E_y - q_s v_{sx} B_0\n$$\n$$\n-i \\omega m_s v_{sz} = q_s E_z\n$$\n使用 $\\Omega_s = q_s B_0 / m_s$，横向方程变为一个关于 $(v_{sx}, v_{sy})$ 的方程组：\n$$\n\\begin{pmatrix} -i\\omega  -\\Omega_s \\\\ \\Omega_s  -i\\omega \\end{pmatrix} \\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = \\frac{q_s}{m_s} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix}\n$$\n解此方程组可得：\n$$\n\\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = \\frac{q_s/m_s}{\\Omega_s^2 - \\omega^2} \\begin{pmatrix} -i\\omega  \\Omega_s \\\\ -\\Omega_s  -i\\omega \\end{pmatrix} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix}\n$$\n电流密度的横向分量为 $\\mathbf{J}_\\perp = \\sum_s n_{0s} q_s \\mathbf{v}_{s\\perp}$。这使我们能从 $\\mathbf{J} = \\mathbf{\\sigma} \\cdot \\mathbf{E}$ 中求出电导率张量 $\\mathbf{\\sigma}$，进而求出介电张量 $\\mathbf{K} = \\mathbf{I} + \\frac{i}{\\omega \\epsilon_0} \\mathbf{\\sigma}$。对于冷磁化等离子体，$\\mathbf{K}$ 的形式为：\n$$\n\\mathbf{K} = \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix}\n$$\n其中分量 $S$、$D$ 和 $P$ 定义为：\n$$\nS = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}, \\quad D = \\sum_s \\frac{(\\Omega_s/\\omega)\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}, \\quad P = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2}\n$$\n其中 $\\omega_{ps}^2 = n_{0s} q_s^2 / (\\epsilon_0 m_s)$ 是粒子 $s$ 的等离子体频率的平方。\n\n对于横向波，其电场为 $\\mathbf{E} = E_x \\hat{\\mathbf{x}} + E_y \\hat{\\mathbf{y}}$，波动方程 $(\\mathbf{K} - n^2 \\mathbf{I}) \\cdot \\mathbf{E} = 0$ 可简化为其 $x-y$ 分量形式：\n$$\n\\begin{pmatrix} S-n^2  -iD \\\\ iD  S-n^2 \\end{pmatrix} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n为得到非平庸解，行列式必须为零：\n$$\n(S-n^2)^2 - (-iD)(iD) = (S-n^2)^2 - D^2 = 0 \\quad \\implies \\quad n^2 = S \\mp D\n$$\n这两个 $n^2$ 的解对应于两种横向模式。\n\n为求极化本征矢量，我们将这些本征值代回矩阵方程。\n情况 1：右旋（R）模。色散关系通常取为 $n_R^2 = S - D$。\n$$\n(S - (S-D))E_x - iDE_y = 0 \\quad \\implies \\quad DE_x - iDE_y = 0 \\quad \\implies \\quad E_x = iE_y\n$$\n这可以写成 $E_y = -iE_x$。本征矢量与 $(\\hat{\\mathbf{x}} - i\\hat{\\mathbf{y}})$ 成正比。\n情况 2：左旋（L）模。色散关系为 $n_L^2 = S + D$。\n$$\n(S - (S+D))E_x - iDE_y = 0 \\quad \\implies \\quad -DE_x - iDE_y = 0 \\quad \\implies \\quad E_x = -iE_y\n$$\n这可以写成 $E_y = iE_x$。本征矢量与 $(\\hat{\\mathbf{x}} + i\\hat{\\mathbf{y}})$ 成正比。\n\n为理解其物理意义，我们将动量方程投影到圆极化基上。对于任意矢量 $\\mathbf{A} = A_x\\hat{\\mathbf{x}} + A_y\\hat{\\mathbf{y}}$，定义其圆极化分量为 $A_\\pm = A_x \\pm iA_y$。组合动量方程的 $x$ 和 $y$ 分量：\n$$\n-i\\omega(v_{sx} \\pm i v_{sy}) = \\frac{q_s}{m_s}(E_x \\pm i E_y) - (\\pm i \\Omega_s)(v_{sx} \\pm i v_{sy})\n$$\n这给出了关于圆极化分量 $v_{s\\pm}$ 的两个解耦方程：\n$$\n-i\\omega v_{s+} = \\frac{q_s}{m_s} E_+ - i\\Omega_s v_{s+} \\quad \\implies \\quad v_{s+} = \\frac{i q_s/m_s}{\\omega - \\Omega_s} E_+\n$$\n$$\n-i\\omega v_{s-} = \\frac{q_s}{m_s} E_- + i\\Omega_s v_{s-} \\quad \\implies \\quad v_{s-} = \\frac{i q_s/m_s}{\\omega + \\Omega_s} E_-\n$$\n粒子速度响应 $v_{s+}$ 在波频 $\\omega$ 与回旋频率 $\\Omega_s$ 相匹配时出现共振。由于 $\\omega0$，这种共振发生在 $\\Omega_s  0$ 的粒子（即 $q_s  0$ 的正离子）上。\n速度响应 $v_{s-}$ 在 $\\omega = -\\Omega_s$ 时出现共振。这种情况发生在 $\\Omega_s  0$ 的粒子（即 $q_s  0$ 的电子）上，因为对它们而言 $\\Omega_s = -|\\Omega_s|$，共振发生在 $\\omega = |\\Omega_s|$。\n\n现在将此与本征矢量联系起来。\n对于 R 模，有 $E_y = -iE_x$。其圆极化分量为：\n$E_+ = E_x + iE_y = E_x + i(-iE_x) = 2E_x$。\n$E_- = E_x - iE_y = E_x - i(-iE_x) = 0$。\nR 模是纯 $E_+$ 波。该分量与 $\\Omega_s  0$ 的粒子发生共振。因此，R 模极化（右旋圆极化）与正离子发生共振，正离子也围绕 $\\mathbf{B}_0$ 以右手定则方向回旋。\n\n对于 L 模，有 $E_y = iE_x$。其圆极化分量为：\n$E_+ = E_x + iE_y = E_x + i(iE_x) = 0$。\n$E_- = E_x - iE_y = E_x - i(iE_x) = 2E_x$。\nL 模是纯 $E_-$ 波。该分量与 $\\Omega_s  0$ 的粒子发生共振。因此，L 模极化（左旋圆极化）与电子发生共振，电子也围绕 $\\mathbf{B}_0$ 以左手定则方向回旋。\n\n这就论证了圆极化波基于粒子电荷符号（或等效地，其回旋频率符号 $\\operatorname{sgn}(\\Omega_s)$）的选择性共振。\n\n归一化本征矢量通过将其除以模长得到。对于 $\\mathbf{v}_R \\propto (1, -i, 0)$，模的平方为 $1^2 + |-i|^2 = 2$。归一化后得到 $\\frac{1}{\\sqrt{2}}(1, -i, 0)$。对于 $\\mathbf{v}_L \\propto (1, i, 0)$，模的平方为 $1^2 + |i|^2 = 2$。归一化后得到 $\\frac{1}{\\sqrt{2}}(1, i, 0)$。\n\n最终答案是一个以这些归一化本征矢量为列的 $3 \\times 2$ 矩阵。第 1 列（R 模）：$\\left( \\frac{1}{\\sqrt{2}}, -\\frac{i}{\\sqrt{2}}, 0 \\right)^T$。第 2 列（L 模）：$\\left( \\frac{1}{\\sqrt{2}}, \\frac{i}{\\sqrt{2}}, 0 \\right)^T$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}   \\frac{1}{\\sqrt{2}} \\\\\n-\\frac{i}{\\sqrt{2}}   \\frac{i}{\\sqrt{2}} \\\\\n0   0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "建立对复杂物理模型的信心，一个有效的方法是验证其在适当极限下能否正确地简化为一个更简单、已知的模型。本计算练习要求您编写程序实现完整的冷等离子体介电张量，并验证当磁场趋于零时，其响应变为各向同性，且与著名的德鲁德（Drude）模型相符。这项实践将理论与计算实现联系起来，并加深了对张量各分量物理意义的理解。",
            "id": "3957249",
            "problem": "你需要从第一性原理出发，实现一个计算验证，证明冷等离子体介电求解器在无磁极限下，会为每个组分产生与德鲁德模型一致的标量介电常数。请从包含各组分唯象碰撞频率的线性化、频域、冷流体动量方程，以及复电导率和介电张量的定义开始。不要使用任何预先推导出的冷等离子体张量公式；相反，你应该通过求解一个联系速度与电场的 $3 \\times 3$ 线性系统来构建组分的电流响应，该系统适用于任意背景磁场矢量。然后，通过将背景磁场设置为极小或精确为零来取无磁极限，并确认对于每个独立组分，其介电张量贡献变为各向同性，且等于该组分的德鲁德模型标量介电常数贡献。\n\n基本出发点和定义：\n- 使用频域中组分 $s$ 的线性化冷流体动量方程，\n  $$m_s \\left(\\nu_s - i \\omega\\right) \\mathbf{v}_s - q_s \\, \\mathbf{v}_s \\times \\mathbf{B}_0 = q_s \\, \\mathbf{E},$$\n  其中 $m_s$ 是组分质量，$q_s$ 是组分电荷，$\\nu_s$ 是组分与中性粒子的碰撞频率，$\\omega$ 是角频率，$\\mathbf{v}_s$ 是组分速度响应，$\\mathbf{B}_0$ 是静态背景磁场，$\\mathbf{E}$ 是谐波电场。\n- 定义叉积算符矩阵 $\\mathbf{C}(\\mathbf{B}_0)$ 为 $\\mathbf{C}(\\mathbf{B}_0)\\,\\mathbf{v} = \\mathbf{v} \\times \\mathbf{B}_0$。据此，构建 $3 \\times 3$ 复数系统矩阵\n  $$\\mathbf{A}_s = \\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0).$$\n- 求解 $\\mathbf{v}_s = \\frac{q_s}{m_s} \\mathbf{A}_s^{-1} \\mathbf{E}$ 以获得组分电导率张量 $\\boldsymbol{\\sigma}_s = n_s q_s \\frac{q_s}{m_s} \\mathbf{A}_s^{-1}$，其中 $n_s$ 是组分数密度。\n- 介电张量通过以下关系式与电导率张量相关联\n  $$\\boldsymbol{\\varepsilon} = \\mathbf{I} + \\frac{i}{\\varepsilon_0 \\omega} \\sum_s \\boldsymbol{\\sigma}_s,$$\n  其中 $\\varepsilon_0$ 是真空介电常数。单个组分对介电张量的贡献为\n  $$\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\boldsymbol{\\sigma}_s.$$\n- 在严格的无磁极限 $\\mathbf{B}_0 = \\mathbf{0}$ 下，组分 $s$ 的德鲁德模型标量介电常数贡献为\n  $$\\varepsilon_{s,\\mathrm{Drude}} = - \\frac{\\omega_{p,s}^2}{\\omega \\left(\\omega + i \\nu_s\\right)}, \\quad \\omega_{p,s}^2 \\equiv \\frac{n_s q_s^2}{\\varepsilon_0 m_s}.$$\n\n你的程序必须：\n1. 实现上述过程，根据给定的 $(n_s, q_s, m_s, \\nu_s)$、角频率 $\\omega$ 和背景磁场矢量 $\\mathbf{B}_0$ 来计算每个组分 $s$ 的 $\\boldsymbol{\\varepsilon}_s$。\n2. 根据相同的参数计算每个组分 $s$ 的标量德鲁德介电常数 $\\varepsilon_{s,\\mathrm{Drude}}$。\n3. 对于下面列出的每个测试用例，在无磁极限下（通过使用 $\\mathbf{B}_0 = \\mathbf{0}$ 或足够小的 $\\mathbf{B}_0$），验证组分层级的张量 $\\boldsymbol{\\varepsilon}_s$ 是各向同性的，并且在指定的容差范围内等于 $\\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I}$。将组分层级的相对误差量化为\n   $$\\mathrm{err}_s = \\frac{\\left\\| \\boldsymbol{\\varepsilon}_s - \\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I} \\right\\|_F}{\\max\\left(1, \\left|\\varepsilon_{s,\\mathrm{Drude}}\\right|\\right)},$$\n   其中 $\\|\\cdot\\|_F$ 是弗罗贝尼乌斯范数，而 $|\\cdot|$ 是复模。如果一个测试用例中所有组分 $s$ 都满足 $\\mathrm{err}_s \\le \\text{tol}$，则该测试用例通过。\n\n物理单位和常数：\n- 使用国际单位制 (SI)。\n- 数密度 $n_s$ 的单位是 $\\mathrm{m}^{-3}$，电荷 $q_s$ 的单位是 $\\mathrm{C}$，质量 $m_s$ 的单位是 $\\mathrm{kg}$，碰撞频率 $\\nu_s$ 的单位是 $\\mathrm{s}^{-1}$。\n- 频率以赫兹 $f$ 给出；使用 $\\omega = 2 \\pi f$ 将其转换为角频率，单位为 $\\mathrm{rad/s}$。\n- 背景磁场 $\\mathbf{B}_0$ 的单位是 $\\mathrm{T}$。\n- 使用 $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$，基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，电子质量 $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$，质子质量 $m_p = 1.67262192369 \\times 10^{-27}\\,\\mathrm{kg}$，氘核质量 $m_D = 3.3435837724 \\times 10^{-27}\\,\\mathrm{kg}$，以及完全电离的氦-4离子质量 $m_{\\mathrm{He}^{2+}} = 6.6464764 \\times 10^{-27}\\,\\mathrm{kg}$。\n\n测试套件：\n- 用例 1 (精确无磁边界，双组分氢等离子体)：\n  - 组分：电子 $(n_e = 1.0 \\times 10^{19}, q_e = -e, m_e, \\nu_e = 1.0 \\times 10^{8})$，质子 $(n_p = 1.0 \\times 10^{19}, q_p = e, m_p, \\nu_p = 1.0 \\times 10^{5})$。\n  - 频率: $f = 1.0 \\times 10^{10}\\,\\mathrm{Hz}$ (所以 $\\omega = 2\\pi f$）。\n  - 磁场: $\\mathbf{B}_0 = (0, 0, 0)\\,\\mathrm{T}$。\n  - 容差: $\\text{tol} = 1.0 \\times 10^{-12}$。\n- 用例 2 (小磁场，射频范围)：\n  - 组分：与用例 1 相同。\n  - 频率: $f = 1.0 \\times 10^{6}\\,\\mathrm{Hz}$。\n  - 磁场: $\\mathbf{B}_0 = (0, 0, 1.0 \\times 10^{-9})\\,\\mathrm{T}$。\n  - 容差: $\\text{tol} = 1.0 \\times 10^{-7}$。\n- 用例 3 (小磁场，甚低频，有限碰撞性)：\n  - 组分：电子 $(n_e = 1.0 \\times 10^{18}, q_e = -e, m_e, \\nu_e = 5.0 \\times 10^{6})$，单电荷离子 $(n_i = 1.0 \\times 10^{18}, q_i = e, m_i = m_p, \\nu_i = 1.0 \\times 10^{4})$。\n  - 频率: $f = 1.0 \\times 10^{3}\\,\\mathrm{Hz}$。\n  - 磁场: $\\mathbf{B}_0 = (0, 0, 1.0 \\times 10^{-13})\\,\\mathrm{T}$。\n  - 容差: $\\text{tol} = 1.0 \\times 10^{-5}$。\n- 用例 4 (多组分离子，小磁场)：\n  - 组分：电子 $(n_e = 2.0 \\times 10^{19}, q_e = -e, m_e, \\nu_e = 5.0 \\times 10^{7})$，氘核 $(n_D = 1.5 \\times 10^{19}, q_D = e, m_D, \\nu_D = 2.0 \\times 10^{5})$，完全电离的氦-4 $(n_{\\mathrm{He}^{2+}} = 2.5 \\times 10^{18}, q_{\\mathrm{He}^{2+}} = 2 e, m_{\\mathrm{He}^{2+}}, \\nu_{\\mathrm{He}^{2+}} = 3.0 \\times 10^{5})$。\n  - 频率: $f = 1.0 \\times 10^{8}\\,\\mathrm{Hz}$。\n  - 磁场: $\\mathbf{B}_0 = (0, 0, 1.0 \\times 10^{-10})\\,\\mathrm{T}$。\n  - 容差: $\\text{tol} = 1.0 \\times 10^{-7}$。\n\n要求的最终输出：\n- 对于四个用例中的每一个，输出一个布尔值，表示该用例中的所有组分是否都满足 $\\mathrm{err}_s \\le \\text{tol}$。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[True,False,True,True]”），列表内有四个布尔值条目，按顺序分别对应于用例 1 到 4 的结果。",
            "solution": "我们从频域中包含碰撞的组分 $s$ 的线性化冷流体动量方程开始。设谐波时间依赖性为 $e^{-i \\omega t}$，并考虑一个静态背景磁场 $\\mathbf{B}_0$。该方程为\n$$m_s \\left(\\nu_s - i \\omega\\right) \\mathbf{v}_s - q_s \\, \\mathbf{v}_s \\times \\mathbf{B}_0 = q_s \\, \\mathbf{E}.$$\n定义 $3 \\times 3$ 单位矩阵 $\\mathbf{I}$ 和叉积算符矩阵 $\\mathbf{C}(\\mathbf{B}_0)$ 为 $\\mathbf{C}(\\mathbf{B}_0)\\,\\mathbf{v} = \\mathbf{v} \\times \\mathbf{B}_0$。在笛卡尔分量中，对于 $\\mathbf{B}_0 = (B_x, B_y, B_z)$，矩阵 $\\mathbf{C}(\\mathbf{B}_0)$ 是\n$$\\mathbf{C}(\\mathbf{B}_0) = \\begin{bmatrix}\n0   -B_z   B_y \\\\\nB_z   0   -B_x \\\\\n-B_y   B_x   0\n\\end{bmatrix},$$\n因为问题中将叉积定义为 $\\mathbf{v} \\times \\mathbf{B}_0$。\n\n我们将动量方程重写为算符形式：\n$$\\left[\\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0)\\right] \\mathbf{v}_s = \\frac{q_s}{m_s} \\mathbf{E}.$$\n令\n$$\\mathbf{A}_s \\equiv \\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0).$$\n假设对于我们关心的参数，$\\mathbf{A}_s$ 是可逆的，则速度响应为\n$$\\mathbf{v}_s = \\frac{q_s}{m_s} \\mathbf{A}_s^{-1} \\mathbf{E}.$$\n\n来自组分 $s$ 的电流密度贡献为 $\\mathbf{J}_s = n_s q_s \\mathbf{v}_s$，因此组分电导率张量为\n$$\\boldsymbol{\\sigma}_s = n_s q_s \\frac{q_s}{m_s} \\mathbf{A}_s^{-1} = \\frac{n_s q_s^2}{m_s} \\mathbf{A}_s^{-1},$$\n总电导率为 $\\boldsymbol{\\sigma} = \\sum_s \\boldsymbol{\\sigma}_s$。\n\n在频域中，介电张量 $\\boldsymbol{\\varepsilon}$ 和电导率张量 $\\boldsymbol{\\sigma}$ 之间的关系是\n$$\\boldsymbol{\\varepsilon} = \\mathbf{I} + \\frac{i}{\\varepsilon_0 \\omega} \\boldsymbol{\\sigma},$$\n因此，组分层级的介电贡献是\n$$\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\boldsymbol{\\sigma}_s = \\frac{i}{\\varepsilon_0 \\omega} \\frac{n_s q_s^2}{m_s} \\mathbf{A}_s^{-1}.$$\n\n在严格的无磁情况下，设 $\\mathbf{B}_0 = \\mathbf{0}$，这意味着 $\\mathbf{C}(\\mathbf{B}_0) = \\mathbf{0}$，因此 $\\mathbf{A}_s = \\left(\\nu_s - i \\omega\\right) \\mathbf{I}$。其逆矩阵为 $\\mathbf{A}_s^{-1} = \\left(\\nu_s - i \\omega\\right)^{-1} \\mathbf{I}$。所以，\n$$\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\frac{n_s q_s^2}{m_s} \\left(\\nu_s - i \\omega\\right)^{-1} \\mathbf{I}.$$\n使用等离子体频率的平方 $\\omega_{p,s}^2 \\equiv n_s q_s^2/(\\varepsilon_0 m_s)$，我们得到\n$$\\boldsymbol{\\varepsilon}_s = \\left[\\frac{i}{\\omega} \\frac{\\omega_{p,s}^2}{\\nu_s - i \\omega}\\right] \\mathbf{I}.$$\n将括号中的分母乘以 $-i$ 得到\n$$\\frac{i}{\\omega} \\frac{1}{-i(\\omega + i \\nu_s)} = - \\frac{1}{\\omega \\left(\\omega + i \\nu_s\\right)},$$\n因此，无磁情况下的 $\\boldsymbol{\\varepsilon}_s$ 简化为\n$$\\boldsymbol{\\varepsilon}_s = \\left[- \\frac{\\omega_{p,s}^2}{\\omega \\left(\\omega + i \\nu_s\\right)}\\right] \\mathbf{I}.$$\n这恰好是组分 $s$ 的标量德鲁德介电常数贡献（记为 $\\varepsilon_{s,\\mathrm{Drude}}$）乘以单位矩阵。\n\n对于一个很小但非零的 $\\mathbf{B}_0$，可将算符的逆展开为关于小参数 $\\|\\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0)\\| / \\left|\\nu_s - i \\omega\\right|$ 的诺伊曼级数。到一阶为止，\n$$\\mathbf{A}_s^{-1} \\approx \\left(\\nu_s - i \\omega\\right)^{-1} \\left[\\mathbf{I} + \\frac{q_s}{m_s} \\left(\\nu_s - i \\omega\\right)^{-1} \\mathbf{C}(\\mathbf{B}_0) + \\cdots \\right],$$\n因此 $\\boldsymbol{\\varepsilon}_s$ 的主导修正项与 $\\left(\\frac{q_s \\|\\mathbf{B}_0\\|}{m_s}\\right)/\\left|\\nu_s - i \\omega\\right|$ 成正比，此比例即回旋频率标度 $\\left|q_s\\right|\\|\\mathbf{B}_0\\|/m_s$ 与复频率标度 $\\left|\\nu_s - i \\omega\\right|$ 之比。当 $\\|\\mathbf{B}_0\\| \\to 0$ 时，各向异性修正项消失，且 $\\boldsymbol{\\varepsilon}_s \\to \\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I}$。\n\n算法实现：\n- 根据 $\\mathbf{B}_0$ 的分量构建 $\\mathbf{C}(\\mathbf{B}_0)$。\n- 对每个组分 $s$，构建 $\\mathbf{A}_s = \\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0)$ 并数值计算其逆矩阵 $\\mathbf{A}_s^{-1}$。\n- 计算 $\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\frac{n_s q_s^2}{m_s} \\mathbf{A}_s^{-1}$。\n- 计算标量德鲁德值 $\\varepsilon_{s,\\mathrm{Drude}} = - \\omega_{p,s}^2 / \\left[\\omega \\left(\\omega + i \\nu_s\\right)\\right]$，其中 $\\omega_{p,s}^2 = n_s q_s^2 / (\\varepsilon_0 m_s)$。\n- 评估组分层级的误差度量 $\\mathrm{err}_s = \\left\\| \\boldsymbol{\\varepsilon}_s - \\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I} \\right\\|_F / \\max\\left(1, \\left|\\varepsilon_{s,\\mathrm{Drude}}\\right|\\right)$。\n- 对每个测试用例，判断是否所有组分都满足 $\\mathrm{err}_s \\le \\text{tol}$。\n\n测试套件覆盖原理：\n- 用例 1 验证了在微波频率下，典型氢等离子体在 $\\mathbf{B}_0 = \\mathbf{0}$ 时的精确相等性；其容差非常严格。\n- 用例 2 测试了在射频范围下的小 $\\mathbf{B}_0$ 极限，此时回旋频率与驱动频率之比极小；其容差设定为中等严格，以考虑有限大小的 $\\mathbf{B}_0$。\n- 用例 3 探讨了一个具有极小磁场的低频、碰撞性体系；其容差较为宽松，以适应相对较大的参数 $\\left|q_s\\right|\\|\\mathbf{B}_0\\|/(m_s \\left|\\nu_s - i \\omega\\right|)$。\n- 用例 4 在包含不同离子电荷和质量的情况下，确认了在小 $\\mathbf{B}_0$ 极限下的多组分可加性和逐组分各向同性。\n\n最终输出为单行文本，其中包含一个用方括号括起来的逗号分隔列表，内含四个布尔值，按顺序对应于用例 1 到 4 是否通过了其定义的逐组分无磁极限验证。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef cross_matrix(B):\n    \"\"\"\n    Construct the cross-product matrix C(B) such that C(B) @ v = v x B.\n    \"\"\"\n    Bx, By, Bz = B\n    return np.array([\n        [0.0,  -Bz,  By],\n        [Bz,   0.0, -Bx],\n        [-By,  Bx,  0.0]\n    ], dtype=np.complex128)\n\ndef species_epsilon_tensor(n, q, m, nu, omega, B, eps0):\n    \"\"\"\n    Compute the dielectric tensor contribution for a single species using\n    the cold-fluid linear response:\n        epsilon_s = (i/(eps0 * omega)) * (n q^2 / m) * A^{-1}\n    where A = (nu - i*omega) I - (q/m) C(B).\n    \"\"\"\n    I = np.eye(3, dtype=np.complex128)\n    C = cross_matrix(B)\n    A = (nu - 1j*omega) * I - (q/m) * C\n    A_inv = np.linalg.inv(A)\n    sigma_s = (n * q * q / m) * A_inv  # conductivity tensor for species\n    epsilon_s = 1j * sigma_s / (eps0 * omega)\n    return epsilon_s\n\ndef drude_scalar(n, q, m, nu, omega, eps0):\n    \"\"\"\n    Scalar Drude permittivity contribution for one species:\n        epsilon_s = - omega_p^2 / (omega * (omega + i*nu))\n    where omega_p^2 = n q^2 / (eps0 m)\n    \"\"\"\n    omega_p2 = n * q * q / (eps0 * m)\n    return - omega_p2 / (omega * (omega + 1j * nu))\n\ndef relative_tensor_error(eps_tensor, scalar_val):\n    \"\"\"\n    Compute Frobenius-norm relative error of a 3x3 tensor versus scalar*I:\n        err = ||eps_tensor - scalar_val * I||_F / max(1, |scalar_val|)\n    \"\"\"\n    I = np.eye(3, dtype=np.complex128)\n    diff = eps_tensor - scalar_val * I\n    num = np.linalg.norm(diff, ord='fro')\n    den = max(1.0, abs(scalar_val))\n    return float(num / den)\n\ndef solve():\n    # Physical constants (SI)\n    eps0 = 8.8541878128e-12\n    e = 1.602176634e-19\n    m_e = 9.1093837015e-31\n    m_p = 1.67262192369e-27\n    m_D = 3.3435837724e-27\n    m_He2 = 6.6464764e-27\n\n    # Define the test cases\n    # Each case: dict with species list, frequency f (Hz), B vector (T), tolerance\n    test_cases = [\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 1.0e19, \"q\": -e, \"m\": m_e, \"nu\": 1.0e8},\n                {\"name\": \"p\", \"n\": 1.0e19, \"q\":  e, \"m\": m_p, \"nu\": 1.0e5},\n            ],\n            \"f_Hz\": 1.0e10,\n            \"B\": np.array([0.0, 0.0, 0.0]),\n            \"tol\": 1.0e-12,\n        },\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 1.0e19, \"q\": -e, \"m\": m_e, \"nu\": 1.0e8},\n                {\"name\": \"p\", \"n\": 1.0e19, \"q\":  e, \"m\": m_p, \"nu\": 1.0e5},\n            ],\n            \"f_Hz\": 1.0e6,\n            \"B\": np.array([0.0, 0.0, 1.0e-9]),\n            \"tol\": 1.0e-7,\n        },\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 1.0e18, \"q\": -e, \"m\": m_e, \"nu\": 5.0e6},\n                {\"name\": \"i\", \"n\": 1.0e18, \"q\":  e, \"m\": m_p, \"nu\": 1.0e4},\n            ],\n            \"f_Hz\": 1.0e3,\n            \"B\": np.array([0.0, 0.0, 1.0e-13]),\n            \"tol\": 1.0e-5,\n        },\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 2.0e19,  \"q\": -e,    \"m\": m_e,   \"nu\": 5.0e7},\n                {\"name\": \"D\", \"n\": 1.5e19, \"q\":  e,    \"m\": m_D,   \"nu\": 2.0e5},\n                {\"name\": \"He2\", \"n\": 2.5e18, \"q\":  2*e, \"m\": m_He2, \"nu\": 3.0e5},\n            ],\n            \"f_Hz\": 1.0e8,\n            \"B\": np.array([0.0, 0.0, 1.0e-10]),\n            \"tol\": 1.0e-7,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        omega = 2.0 * np.pi * case[\"f_Hz\"]\n        Bvec = case[\"B\"].astype(np.float64)\n        tol = case[\"tol\"]\n        all_species_ok = True\n        for sp in case[\"species\"]:\n            eps_tensor = species_epsilon_tensor(\n                n=sp[\"n\"], q=sp[\"q\"], m=sp[\"m\"], nu=sp[\"nu\"], omega=omega, B=Bvec, eps0=eps0\n            )\n            drude_val = drude_scalar(\n                n=sp[\"n\"], q=sp[\"q\"], m=sp[\"m\"], nu=sp[\"nu\"], omega=omega, eps0=eps0\n            )\n            err = relative_tensor_error(eps_tensor, drude_val)\n            if not (err = tol):\n                all_species_ok = False\n                break\n        results.append(all_species_ok)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}