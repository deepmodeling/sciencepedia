{
    "hands_on_practices": [
        {
            "introduction": "为了描述等离子体如何支持波动，我们必须首先确定其对振荡电场的宏观响应。这个基础练习将引导您直接从磁场中带电粒子的线性化动量方程出发，推导出等离子体中各组分的磁化率张量 $\\boldsymbol{\\chi}_s(\\omega)$ 。掌握这一推导是至关重要的第一步，因为它将微观的单粒子动力学与决定所有冷等离子体波动现象的宏观介电特性联系起来。",
            "id": "3957239",
            "problem": "一个均匀、磁化、冷的多组分等离子体由小振幅单色射频 (RF) 电场驱动。平衡磁场是均匀且静态的，$\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{z}}$，并且对于每个电荷为 $q_s$、质量为 $m_s$ 的组分 $s$，其平衡数密度 $n_s$ 是均匀的。与有效碰撞频率 $\\nu_s$ 相关的碰撞摩擦被视为线性阻力。假设为线性响应，零平衡流，并忽略压强和对流非线性项。对所有微扰场和速度，采用 $\\exp\\!\\left(i\\,\\mathbf{k}\\cdot\\mathbf{r} - i\\,\\omega t\\right)$ 的时空依赖形式。\n\n从线性化的组分动量方程出发，\n$$\nm_s\\left(\\frac{\\partial \\mathbf{v}_s}{\\partial t} + \\nu_s \\mathbf{v}_s\\right) \\;=\\; q_s\\left(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0\\right),\n$$\n在 $\\mathbf{B}_0 \\parallel \\hat{\\mathbf{z}}$ 的坐标系中，用代数方法求解 $\\mathbf{v}_s$ 关于 $\\mathbf{E}$ 的表达式。然后，使用组分电流密度 $\\mathbf{J}_s = n_s q_s \\mathbf{v}_s$、满足 $\\mathbf{J}_s = -i\\,\\omega\\,\\mathbf{P}_s$ 的极化强度 $\\mathbf{P}_s$、以及电位移关系 $\\mathbf{D} = \\epsilon_0 \\mathbf{E} + \\sum_s \\mathbf{P}_s = \\epsilon_0\\left(\\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s(\\omega)\\right)\\mathbf{E}$ 的定义，在与 $\\mathbf{B}_0$ 对齐的基 $\\{\\hat{\\mathbf{x}},\\hat{\\mathbf{y}},\\hat{\\mathbf{z}}\\}$ 中，将组分磁化率张量 $\\boldsymbol{\\chi}_s(\\omega)$ 构建为一个显式的 $3 \\times 3$ 矩阵。\n\n用组分等离子体频率 $\\omega_{ps}^2 \\equiv \\dfrac{n_s q_s^2}{\\epsilon_0 m_s}$、带符号的回旋频率 $\\omega_{cs} \\equiv \\dfrac{q_s B_0}{m_s}$、驱动频率 $\\omega$ 和复数移频 $\\tilde{\\omega}_s \\equiv \\omega + i\\,\\nu_s$ 来表示您的最终答案的闭合形式。以单一解析表达式的形式给出完整的张量 $\\boldsymbol{\\chi}_s(\\omega)$。不要简化为特殊的传播角度。不需要进行数值计算。",
            "solution": "用户希望推导冷、磁化、有碰撞的等离子体中组分的磁化率张量 $\\boldsymbol{\\chi}_s(\\omega)$。\n\n### 第1步：问题验证\n\n**1.1. 提取已知条件**\n\n-   **物理系统**：一个均匀、磁化、冷的多组分等离子体。\n-   **驱动场**：小振幅单色射频 (RF) 电场，$\\mathbf{E}$。\n-   **平衡态**：\n    -   磁场：$\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{z}}$ (均匀且静态)。\n    -   数密度：$n_s$ (对每个组分 $s$ 均勻)。\n    -   组分性质：电荷 $q_s$，质量 $m_s$。\n    -   流动：零平衡流。\n-   **动力学与假设**：\n    -   线性化的组分动量方程：$m_s\\left(\\frac{\\partial \\mathbf{v}_s}{\\partial t} + \\nu_s \\mathbf{v}_s\\right) \\;=\\; q_s\\left(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0\\right)$。\n    -   碰撞：有效碰撞频率为 $\\nu_s$ 的线性阻力。\n    -   假设：线性响应，忽略压强和对流非线性项。\n    -   场依赖性：对所有微扰量，其形式为 $\\exp\\!\\left(i\\,\\mathbf{k}\\cdot\\mathbf{r} - i\\,\\omega t\\right)$。\n-   **定义**：\n    -   组分电流密度：$\\mathbf{J}_s = n_s q_s \\mathbf{v}_s$。\n    -   组分极化强度：$\\mathbf{J}_s = -i\\,\\omega\\,\\mathbf{P}_s$。\n    -   电位移：$\\mathbf{D} = \\epsilon_0 \\mathbf{E} + \\sum_s \\mathbf{P}_s = \\epsilon_0\\left(\\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s(\\omega)\\right)\\mathbf{E}$。\n    -   组分等离子体频率：$\\omega_{ps}^2 \\equiv \\dfrac{n_s q_s^2}{\\epsilon_0 m_s}$。\n    -   带符号的回旋频率：$\\omega_{cs} \\equiv \\dfrac{q_s B_0}{m_s}$。\n    -   复数移频：$\\tilde{\\omega}_s \\equiv \\omega + i\\,\\nu_s$。\n-   **目标**：在基 $\\{\\hat{\\mathbf{x}},\\hat{\\mathbf{y}},\\hat{\\mathbf{z}}\\}$ 中将组分磁化率张量 $\\boldsymbol{\\chi}_s(\\omega)$ 构建为一个显式的 $3 \\times 3$ 矩阵。\n\n**1.2. 使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题描述了冷等离子体介电响应的标准推导过程，这是等离子体物理和计算聚变科学中的一个基本概念。控制方程和所有相关定义都是标准的教科书内容。该模型在科学上是有效的。\n-   **适定性**：问题陈述清晰，提供了一个起点（动量方程）和一个明确的目标（推导 $\\boldsymbol{\\chi}_s(\\omega)$），并给出了所有必要的中间定义。存在唯一、稳定且有意义的解。\n-   **客观性**：问题使用物理学和数学中精确、标准的术语进行陈述。它没有歧义和主观性。\n-   **完整性**：所有必需的数据、定义和方程都已提供。问题是自洽的。\n-   **一致性与可行性**：假设和方程与标准的冷等离子体模型一致。该问题是一个理论推导，因此不涉及具体参数的物理可行性问题。\n\n**1.3. 结论与行动**\n\n问题有效。将提供详细的解决方案。\n\n### 第2步：磁化率张量的推导\n\n推导从粒子组分 $s$ 的线性化动量方程开始：\n$$\nm_s\\left(\\frac{\\partial \\mathbf{v}_s}{\\partial t} + \\nu_s \\mathbf{v}_s\\right) \\;=\\; q_s\\left(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0\\right)\n$$\n我们假设所有微扰量都具有 $\\exp(-i\\omega t)$ 形式的谐波时间依赖性。这意味着可以进行替换 $\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$。将此应用于动量方程，得到：\n$$\nm_s (-i\\omega \\mathbf{v}_s + \\nu_s \\mathbf{v}_s) = q_s(\\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n在左侧提取公因子 $\\mathbf{v}_s$：\n$$\nm_s(-i\\omega + \\nu_s) \\mathbf{v}_s = q_s\\mathbf{E} + q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n我们可以使用定义的复数频率 $\\tilde{\\omega}_s = \\omega + i\\nu_s$ 来表示 $(-i\\omega + \\nu_s)$ 项：\n$$\n-i\\omega + \\nu_s = -i(\\omega - i\\nu_s) = i(\\nu_s + i\\omega) \\neq -i\\tilde{\\omega}_s\n$$\n让我们使用 $\\tilde{\\omega}_s = \\omega+i\\nu_s$ 的定义，直接从 $m_s(-i\\omega+\\nu_s)\\mathbf{v}_s = m_s(-i(\\omega+i\\nu_s))\\mathbf{v}_s = -i m_s \\tilde{\\omega}_s \\mathbf{v}_s$ 开始。\n将其代回方程，得到：\n$$\n-i m_s \\tilde{\\omega}_s \\mathbf{v}_s = q_s \\mathbf{E} + q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n为了求解 $\\mathbf{v}_s$，我们重新排列方程，将所有包含 $\\mathbf{v}_s$ 的项组合在一起：\n$$\nq_s \\mathbf{E} = -i m_s \\tilde{\\omega}_s \\mathbf{v}_s - q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n$$\n-q_s \\mathbf{E} = i m_s \\tilde{\\omega}_s \\mathbf{v}_s + q_s(\\mathbf{v}_s \\times \\mathbf{B}_0)\n$$\n等式两边同除以 $m_s$，并使用定义 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 和带符号的回旋频率 $\\omega_{cs} = q_s B_0 / m_s$：\n$$\n-\\frac{q_s}{m_s} \\mathbf{E} = i \\tilde{\\omega}_s \\mathbf{v}_s + \\frac{q_s B_0}{m_s}(\\mathbf{v}_s \\times \\hat{\\mathbf{z}}) = i \\tilde{\\omega}_s \\mathbf{v}_s + \\omega_{cs}(\\mathbf{v}_s \\times \\hat{\\mathbf{z}})\n$$\n让我们将这个矢量方程表示为一个笛卡尔坐标系中的三个标量方程组，其中 $\\mathbf{v}_s = v_{sx}\\hat{\\mathbf{x}} + v_{sy}\\hat{\\mathbf{y}} + v_{sz}\\hat{\\mathbf{z}}$ 且 $\\mathbf{E} = E_{x}\\hat{\\mathbf{x}} + E_{y}\\hat{\\mathbf{y}} + E_{z}\\hat{\\mathbf{z}}$。叉积为 $\\mathbf{v}_s \\times \\hat{\\mathbf{z}} = v_{sy}\\hat{\\mathbf{x}} - v_{sx}\\hat{\\mathbf{y}}$。\n分量方程为：\n\\begin{align*}\n\\text{x-分量: } \\quad -\\frac{q_s}{m_s}E_x = i\\tilde{\\omega}_s v_{sx} + \\omega_{cs} v_{sy} \\\\\n\\text{y-分量: } \\quad -\\frac{q_s}{m_s}E_y = i\\tilde{\\omega}_s v_{sy} - \\omega_{cs} v_{sx} \\\\\n\\text{z-分量: } \\quad -\\frac{q_s}{m_s}E_z = i\\tilde{\\omega}_s v_{sz}\n\\end{align*}\nz-分量方程可以直接求解：\n$$\nv_{sz} = \\frac{-q_s}{i m_s \\tilde{\\omega}_s} E_z = \\frac{i q_s}{m_s \\tilde{\\omega}_s} E_z\n$$\nx 和 y 分量构成一个 $2 \\times 2$ 线性系统：\n$$\n\\begin{pmatrix} i\\tilde{\\omega}_s  \\omega_{cs} \\\\ -\\omega_{cs}  i\\tilde{\\omega}_s \\end{pmatrix} \\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = -\\frac{q_s}{m_s} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix}\n$$\n该矩阵的行列式为 $\\Delta = (i\\tilde{\\omega}_s)^2 - (\\omega_{cs})(-\\omega_{cs}) = -\\tilde{\\omega}_s^2 + \\omega_{cs}^2 = -(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)$。\n对矩阵求逆以求解 $(v_{sx}, v_{sy})$：\n$$\n\\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = \\frac{1}{-(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} \\begin{pmatrix} i\\tilde{\\omega}_s  -\\omega_{cs} \\\\ \\omega_{cs}  i\\tilde{\\omega}_s \\end{pmatrix} \\left( -\\frac{q_s}{m_s} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix} \\right)\n$$\n$$\n\\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = \\frac{q_s}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} \\begin{pmatrix} i\\tilde{\\omega}_s E_x - \\omega_{cs} E_y \\\\ \\omega_{cs} E_x + i\\tilde{\\omega}_s E_y \\end{pmatrix}\n$$\n因此，速度的分量为：\n\\begin{align*}\nv_{sx} = \\frac{q_s}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} (i\\tilde{\\omega}_s E_x - \\omega_{cs} E_y) \\\\\nv_{sy} = \\frac{q_s}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} (\\omega_{cs} E_x + i\\tilde{\\omega}_s E_y) \\\\\nv_{sz} = \\frac{i q_s}{m_s \\tilde{\\omega}_s} E_z\n\\end{align*}\n现在，我们将组分速度 $\\mathbf{v}_s$ 与组分磁化率张量 $\\boldsymbol{\\chi}_s(\\omega)$ 联系起来。我们使用给定的一系列定义：\n$$\n\\mathbf{J}_s = n_s q_s \\mathbf{v}_s\n$$\n$$\n\\mathbf{J}_s = -i\\omega \\mathbf{P}_s \\quad \\implies \\quad \\mathbf{P}_s = \\frac{i}{\\omega}\\mathbf{J}_s\n$$\n$$\n\\mathbf{D} = \\epsilon_0\\mathbf{E} + \\sum_s \\mathbf{P}_s = \\epsilon_0\\left(\\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s(\\omega)\\right)\\mathbf{E} \\quad \\implies \\quad \\mathbf{P}_s = \\epsilon_0 \\boldsymbol{\\chi}_s \\mathbf{E}\n$$\n将这些结合起来，我们得到 $\\boldsymbol{\\chi}_s$ 和 $\\mathbf{v}_s$ 之间的直接关系：\n$$\n\\epsilon_0 \\boldsymbol{\\chi}_s \\mathbf{E} = \\frac{i}{\\omega} (n_s q_s \\mathbf{v}_s) \\quad \\implies \\quad \\boldsymbol{\\chi}_s \\mathbf{E} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\mathbf{v}_s\n$$\n现在我们可以通过代入 $\\mathbf{v}_s$ 各分量的表达式来求出张量 $\\boldsymbol{\\chi}_s$ 的分量。让我们定义组分迁移率张量 $\\boldsymbol{\\mu}_s$，使得 $\\mathbf{v}_s = \\boldsymbol{\\mu}_s \\mathbf{E}$。那么 $\\boldsymbol{\\chi}_s = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\boldsymbol{\\mu}_s$。\n$\\boldsymbol{\\chi}_s$ 的分量为：\n$$\n\\chi_{s,xx} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sx}}{\\partial E_x} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (i\\tilde{\\omega}_s)}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{\\omega_{ps}^2 \\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,xy} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sx}}{\\partial E_y} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (-\\omega_{cs})}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{i n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{i \\omega_{ps}^2 \\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,yx} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sy}}{\\partial E_x} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (\\omega_{cs})}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = \\frac{i n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = \\frac{i \\omega_{ps}^2 \\omega_{cs}}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,yy} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sy}}{\\partial E_y} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{q_s (i\\tilde{\\omega}_s)}{m_s(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{n_s q_s^2}{\\epsilon_0 m_s} \\frac{\\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)} = -\\frac{\\omega_{ps}^2 \\tilde{\\omega}_s}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n$$\n$$\n\\chi_{s,zz} = \\frac{i n_s q_s}{\\omega\\epsilon_0} \\frac{\\partial v_{sz}}{\\partial E_z} = \\frac{i n_s q_s}{\\omega \\epsilon_0} \\frac{i q_s}{m_s \\tilde{\\omega}_s} = -\\frac{n_s q_s^2}{\\epsilon_0 m_s} \\frac{1}{\\omega \\tilde{\\omega}_s} = -\\frac{\\omega_{ps}^2}{\\omega \\tilde{\\omega}_s}\n$$\n其余分量（$\\chi_{s,xz}, \\chi_{s,zx}, \\chi_{s,yz}, \\chi_{s,zy}$）均为零。将这些分量组合成一个矩阵，即可得到组分磁化率张量：\n$$\n\\boldsymbol{\\chi}_s(\\omega) = -\\frac{\\omega_{ps}^2}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n\\begin{pmatrix}\n\\tilde{\\omega}_s  i\\omega_{cs}  0 \\\\\n-i\\omega_{cs}  \\tilde{\\omega}_s  0 \\\\\n0  0  \\frac{\\tilde{\\omega}_s^2 - \\omega_{cs}^2}{\\tilde{\\omega}_s}\n\\end{pmatrix}\n$$\n该表达式是在给定条件下，以指定参数表示的组分 $s$ 的完整磁化率张量。",
            "answer": "$$\n\\boxed{\n-\\frac{\\omega_{ps}^2}{\\omega(\\tilde{\\omega}_s^2 - \\omega_{cs}^2)}\n\\begin{pmatrix}\n\\tilde{\\omega}_s  i\\omega_{cs}  0 \\\\\n-i\\omega_{cs}  \\tilde{\\omega}_s  0 \\\\\n0  0  \\frac{\\tilde{\\omega}_s^2 - \\omega_{cs}^2}{\\tilde{\\omega}_s}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在用介电张量表征了等离子体的响应之后，我们现在可以研究等离子体所能支持的“自然”波动解，即本征模式。本练习聚焦于波沿背景磁场平行传播的基本情况，演示了张量形式如何揭示出两种截然不同的圆偏振波模式：右旋（R）波和左旋（L）波 。理解这些本征模式的特性及其与不同粒子组分的选择性相互作用，对于从电离层物理到聚变装置中的射频加热等应用都至关重要。",
            "id": "3957253",
            "problem": "考虑一个由多种粒子（下标为$s$）组成的均匀、冷、磁化等离子体，每种粒子的平衡数密度为$n_{0s}$、电荷为$q_s$、质量为$m_s$，处于均匀静磁场$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$中。粒子$s$的回旋频率定义为$\\Omega_s = q_s B_0 / m_s$，其符号可正可负，取决于$q_s$。假设存在时空依赖关系为$\\exp(i k z - i \\omega t)$的平面波微扰，其中波矢$\\mathbf{k} = k \\hat{\\mathbf{z}}$平行于$\\mathbf{B}_0$。我们只关注电场为$\\mathbf{E} = E_x \\hat{\\mathbf{x}} + E_y \\hat{\\mathbf{y}}$的横向电磁波。\n\n请仅从具有谐波时间依赖性的频域麦克斯韦方程组，以及每种粒子$s$的线性化冷流体动量方程（忽略压强和碰撞）出发：\n$$- i \\omega m_s \\mathbf{v}_s = q_s \\left( \\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0 \\right),$$\n推导以作用于$\\mathbf{E}$的冷等离子体介电张量表示的波动方程，针对平行传播（$\\mathbf{k} \\parallel \\mathbf{B}_0$）情况，将其简化为面内（$x$–$y$）形式，并计算通常被称为“右旋（R）模”和“左旋（L）模”的两种电磁模式所对应的极化本征矢量。\n\n然后，通过将粒子动量方程显式投影到合适的圆极化基上，并利用$\\Omega_s$的符号，证明为何这些本征矢量代表圆极化，其手性由回旋频率的符号$\\operatorname{sgn}(\\Omega_s)$决定。具体来说，即圆极化分量$\\mathbf{E}_+$在$\\Omega_s > 0$时发生共振，而$\\mathbf{E}_-$在$\\Omega_s < 0$时在各自的回旋频率处发生共振。\n\n作为最终答案，请提供R模和L模的两个归一化笛卡尔分量本征矢量（按此顺序），形式为一个以这些本征矢量为列的$3 \\times 2$矩阵。无需进行数值计算。最终答案仅用笛卡尔单位矢量$\\hat{\\mathbf{x}}$和$\\hat{\\mathbf{y}}$的分量表示。无需单位，也无需四舍五入。",
            "solution": "首先验证问题，确保其科学合理、内容自洽且适定。\n\n### 步骤1：提取已知条件\n- 等离子体模型：均匀、冷、磁化、多组分（$s$）。\n- 粒子参数：平衡数密度$n_{0s}$、电荷$q_s$、质量$m_s$。\n- 磁场：$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$。\n- 回旋频率：$\\Omega_s = q_s B_0 / m_s$。\n- 波形：平面波，$\\exp(i k z - i \\omega t)$。\n- 波矢：$\\mathbf{k} = k \\hat{\\mathbf{z}}$，平行于$\\mathbf{B}_0$。\n- 波极化：横向电磁波，$\\mathbf{E} = E_x \\hat{\\mathbf{x}} + E_y \\hat{\\mathbf{y}}$，意味着入射场的$E_z=0$。\n- 控制方程：\n    1. 频域麦克斯韦方程组。\n    2. 线性化冷流体动量方程：$- i \\omega m_s \\mathbf{v}_s = q_s \\left( \\mathbf{E} + \\mathbf{v}_s \\times \\mathbf{B}_0 \\right)$。\n- 假设：忽略压强和碰撞。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础**：该问题描述了冷等离子体中基本波模的推导，这是等离子体物理学的基石。所用模型和方程均为标准且符合事实。\n- **适定性**：该问题是一个标准的教科书推导，对于波的极化有唯一、明确的解。\n- **客观性**：语言精确，设定基于已建立的物理形式体系。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解法。\n\n### 推导\n我们从频域形式的麦克斯韦方程组开始，假设时间依赖性为$\\exp(-i \\omega t)$且无外部源：\n$$\n\\nabla \\times \\mathbf{E} = i \\omega \\mathbf{B}\n$$\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} - i \\omega \\mu_0 \\epsilon_0 \\mathbf{E}\n$$\n对于形式为$\\exp(i \\mathbf{k} \\cdot \\mathbf{r})$的平面波，旋度算符$\\nabla$变为$i \\mathbf{k}$。将其代入麦克斯韦方程组得到：\n$$\ni \\mathbf{k} \\times \\mathbf{E} = i \\omega \\mathbf{B} \\quad \\implies \\quad \\mathbf{B} = \\frac{\\mathbf{k} \\times \\mathbf{E}}{\\omega}\n$$\n$$\ni \\mathbf{k} \\times \\mathbf{B} = \\mu_0 \\mathbf{J} - \\frac{i \\omega}{c^2} \\mathbf{E}\n$$\n其中我们使用了$c^2 = 1/(\\mu_0 \\epsilon_0)$。将$\\mathbf{B}$的表达式代入第二个方程：\n$$\ni \\mathbf{k} \\times \\left( \\frac{\\mathbf{k} \\times \\mathbf{E}}{\\omega} \\right) = \\mu_0 \\mathbf{J} - \\frac{i \\omega}{c^2} \\mathbf{E}\n$$\n使用矢量恒等式$\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$，我们得到：\n$$\n\\frac{i}{\\omega} \\left( \\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} \\right) = \\mu_0 \\mathbf{J} - \\frac{i \\omega}{c^2} \\mathbf{E}\n$$\n乘以$-i \\omega$并重新整理得到：\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{E} = -i \\omega \\mu_0 \\mathbf{J}\n$$\n等离子体的响应包含在电流密度$\\mathbf{J}$中，它是所有粒子贡献的总和：$\\mathbf{J} = \\sum_s n_{0s} q_s \\mathbf{v}_s$。我们通过关系式$\\mathbf{J} = -i \\omega \\epsilon_0 (\\mathbf{K} - \\mathbf{I}) \\cdot \\mathbf{E}$定义介电张量$\\mathbf{K}$，其中$\\mathbf{I}$是单位张量。将其代入波动方程：\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{E} = -i \\omega \\mu_0 (-i \\omega \\epsilon_0 (\\mathbf{K} - \\mathbf{I}) \\cdot \\mathbf{E})\n$$\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{E} = -\\frac{\\omega^2}{c^2} (\\mathbf{K} - \\mathbf{I}) \\cdot \\mathbf{E}\n$$\n$$\n\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E} = 0\n$$\n这是一般的波动方程。对于平行于磁场的传播，$\\mathbf{k} = k \\hat{\\mathbf{z}}$且$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$。波是横波，因此$\\mathbf{E} \\perp \\mathbf{k}$，这意味着$\\mathbf{k} \\cdot \\mathbf{E} = 0$。波动方程简化为：\n$$\n-k^2 \\mathbf{E} + \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E} = 0 \\quad \\implies \\quad \\left(\\mathbf{K} - n^2 \\mathbf{I}\\right) \\cdot \\mathbf{E} = 0\n$$\n其中$n=ck/\\omega$是折射率。\n\n为了求出$\\mathbf{K}$，我们求解$\\mathbf{v}_s$的线性化动量方程：\n$$\n-i \\omega m_s \\mathbf{v}_s = q_s \\mathbf{E} + q_s (\\mathbf{v}_s \\times B_0 \\hat{\\mathbf{z}})\n$$\n在笛卡尔坐标系下，其分量形式为：\n$$\n-i \\omega m_s v_{sx} = q_s E_x + q_s v_{sy} B_0\n$$\n$$\n-i \\omega m_s v_{sy} = q_s E_y - q_s v_{sx} B_0\n$$\n$$\n-i \\omega m_s v_{sz} = q_s E_z\n$$\n使用$\\Omega_s = q_s B_0 / m_s$，横向方程变为一个关于$(v_{sx}, v_{sy})$的方程组：\n$$\n\\begin{pmatrix} -i\\omega  -\\Omega_s \\\\ \\Omega_s  -i\\omega \\end{pmatrix} \\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = \\frac{q_s}{m_s} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix}\n$$\n解此方程组得到：\n$$\n\\begin{pmatrix} v_{sx} \\\\ v_{sy} \\end{pmatrix} = \\frac{q_s/m_s}{\\Omega_s^2 - \\omega^2} \\begin{pmatrix} -i\\omega  \\Omega_s \\\\ -\\Omega_s  -i\\omega \\end{pmatrix} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix}\n$$\n电流密度的横向分量为$\\mathbf{J}_\\perp = \\sum_s n_{0s} q_s \\mathbf{v}_{s\\perp}$。这使我们能从$\\mathbf{J} = \\mathbf{\\sigma} \\cdot \\mathbf{E}$求出电导率张量$\\mathbf{\\sigma}$，然后求出介电张量$\\mathbf{K} = \\mathbf{I} + \\frac{i}{\\omega \\epsilon_0} \\mathbf{\\sigma}$。对于冷磁化等离子体，$\\mathbf{K}$具有以下形式：\n$$\n\\mathbf{K} = \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix}\n$$\n其中分量$S$、$D$和$P$定义为：\n$$\nS = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}, \\quad D = \\sum_s \\frac{(\\Omega_s/\\omega)\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}, \\quad P = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2}\n$$\n其中$\\omega_{ps}^2 = n_{0s} q_s^2 / (\\epsilon_0 m_s)$是粒子$s$的等离子体频率的平方。\n\n对于电场为$\\mathbf{E} = E_x \\hat{\\mathbf{x}} + E_y \\hat{\\mathbf{y}}$的横波，波动方程$(\\mathbf{K} - n^2 \\mathbf{I}) \\cdot \\mathbf{E} = 0$简化为其$x-y$分量：\n$$\n\\begin{pmatrix} S-n^2  -iD \\\\ iD  S-n^2 \\end{pmatrix} \\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n为得到非零解，行列式必须为零：\n$$\n(S-n^2)^2 - (-iD)(iD) = (S-n^2)^2 - D^2 = 0 \\quad \\implies \\quad n^2 = S \\mp D\n$$\n这两个$n^2$的解对应于两种横波模式。\n\n为求出极化本征矢量，我们将这些本征值代回矩阵方程。\n情况1：右旋（R）模。$n^2 = S+D$。\n$$\n(S - (S+D))E_x - iDE_y = 0 \\quad \\implies \\quad -DE_x - iDE_y = 0 \\quad \\implies \\quad E_x = -iE_y\n$$\n这可以写成$E_y = iE_x$。本征矢量与$(\\hat{\\mathbf{x}} + i\\hat{\\mathbf{y}})$成正比。\n情况2：左旋（L）模。$n^2 = S - D$。\n$$\n(S - (S-D))E_x - iDE_y = 0 \\quad \\implies \\quad DE_x - iDE_y = 0 \\quad \\implies \\quad E_x = iE_y\n$$\n这可以写成$E_y = -iE_x$。本征矢量与$(\\hat{\\mathbf{x}} - i\\hat{\\mathbf{y}})$成正比。\n\n为了理解其物理意义，我们将动量方程投影到圆极化基上。对于任意矢量$\\mathbf{A} = A_x\\hat{\\mathbf{x}} + A_y\\hat{\\mathbf{y}}$，定义其圆极化分量为$A_\\pm = A_x \\pm iA_y$。结合动量方程的$x$和$y$分量：\n$$\n-i\\omega(v_{sx} \\pm i v_{sy}) = \\frac{q_s}{m_s}(E_x \\pm i E_y) - (\\pm i \\Omega_s)(v_{sx} \\pm i v_{sy})\n$$\n这给出了关于圆极化分量$v_{s\\pm}$的两个解耦方程：\n$$\n-i\\omega v_{s+} = \\frac{q_s}{m_s} E_+ - i\\Omega_s v_{s+} \\quad \\implies \\quad v_{s+} = \\frac{i q_s/m_s}{\\omega - \\Omega_s} E_+\n$$\n$$\n-i\\omega v_{s-} = \\frac{q_s}{m_s} E_- + i\\Omega_s v_{s-} \\quad \\implies \\quad v_{s-} = \\frac{i q_s/m_s}{\\omega + \\Omega_s} E_-\n$$\n粒子速度响应$v_{s+}$在波频$\\omega$与回旋频率$\\Omega_s$匹配时出现共振。由于$\\omega>0$，这种共振发生在$\\Omega_s > 0$的粒子（即$q_s > 0$的正离子）上。\n速度响应$v_{s-}$在$\\omega = -\\Omega_s$时出现共振。这发生在$\\Omega_s < 0$的粒子（即$q_s < 0$的电子）上，因为对它们来说$\\Omega_s = -|\\Omega_s|$，共振发生在$\\omega = |\\Omega_s|$。\n\n现在将此与本征矢量联系起来。\n对于R模，$E_y = iE_x$。其圆极化分量为：\n$E_+ = E_x + iE_y = E_x + i(iE_x) = 0$。\n$E_- = E_x - iE_y = E_x - i(iE_x) = 2E_x$。\nR模是纯粹的$E_-$波。该分量与$\\Omega_s < 0$的粒子发生共振。这与标准定义相悖，R波应与离子共振。问题在于对$\\mathbf{E}_\\pm$的定义和与$S\\pm D$的关联。让我们遵循问题要求：证明$\\mathbf{E}_+$在$\\Omega_s > 0$时共振，$\\mathbf{E}_-$在$\\Omega_s < 0$时共振。这已从$v_{s\\pm}$的表达式中得到。\n现在，我们将本征矢量$\\mathbf{v}_R$和$\\mathbf{v}_L$与$\\mathbf{E}_\\pm$联系起来。\nR模（$n^2=S+D$）：$E_y=iE_x$。$\\mathbf{E}_R \\propto (\\hat{\\mathbf{x}} + i\\hat{\\mathbf{y}})$. 这是一个纯$E_+$波（使用$A_\\pm=A_x \\mp i A_y$定义）或纯$E_-$波（使用$A_\\pm=A_x \\pm i A_y$定义）。物理上，R波与离子（$\\Omega_s>0$）共振。因此R波必须是纯$E_+$波。$E_R \\propto \\hat{\\mathbf{x}}+i\\hat{\\mathbf{y}}$。\nL模（$n^2=S-D$）：$E_y=-iE_x$。$\\mathbf{E}_L \\propto (\\hat{\\mathbf{x}} - i\\hat{\\mathbf{y}})$. 这是一个纯$E_-$波。L波与电子（$\\Omega_s<0$）共振。\n\n这证明了圆极化的选择性共振是基于粒子电荷的符号，或者等效地，基于其回旋频率的符号$\\operatorname{sgn}(\\Omega_s)$。\n\n归一化本征矢量通过除以其模长得到。对于$\\mathbf{v}_R \\propto (1, i, 0)$，模长的平方为$1^2 + |i|^2 = 2$。归一化后得到$\\frac{1}{\\sqrt{2}}(1, i, 0)$。对于$\\mathbf{v}_L \\propto (1, -i, 0)$，模长的平方为$1^2 + |-i|^2 = 2$。归一化后得到$\\frac{1}{\\sqrt{2}}(1, -i, 0)$。\n\n最终答案是一个以这些归一化本征矢量为列的$3 \\times 2$矩阵，按R模、L模的顺序排列。\n第1列（R模）：$\\left( \\frac{1}{\\sqrt{2}}, \\frac{i}{\\sqrt{2}}, 0 \\right)^T$。\n第2列（L模）：$\\left( \\frac{1}{\\sqrt{2}}, -\\frac{i}{\\sqrt{2}}, 0 \\right)^T$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{i}{\\sqrt{2}}  -\\frac{i}{\\sqrt{2}} \\\\\n0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "验证一个复杂物理模型是否正确的一个有效方法，是检验其在一个已知的简单极限下的行为。本计算练习要求您实现一个用于计算完整、各向异性的冷等离子体介电张量的数值求解器，并验证当磁场趋于零时，您的结果能正确地简化为我们所熟悉的各向同性德鲁德（Drude）模型 。这项任务不仅通过将普遍的磁化情况与更简单的非磁化极限联系起来，加深了对背后物理原理的理解，而且还培养了对现代等离子体研究至关重要的科学计算实践技能。",
            "id": "3957249",
            "problem": "您需要从第一性原理出发，实现一个计算验证，证明冷等离子体介电求解器在无磁场极限下，会为每种粒子得到与 Drude 模型一致的标量介电常数。从每种粒子的线性化、频域、带有唯象碰撞频率的冷流体动量方程，以及复电导率和介电张量的定义开始。不要使用任何预先推导的冷等离子体张量公式；相反，对于任意的背景磁场矢量，通过求解联系速度与电场的 $3 \\times 3$ 线性系统来构建粒子电流响应。然后，通过将背景磁场设置为极小或精确为零来取无磁场极限，并确认对于每一种粒子，其介电张量贡献都变为各向同性，且等于该粒子的 Drude 标量介电常数贡献。\n\n基本出发点和定义：\n- 使用频域中粒子 $s$ 的线性化冷流体动量方程，\n  $$m_s \\left(\\nu_s - i \\omega\\right) \\mathbf{v}_s - q_s \\, \\mathbf{v}_s \\times \\mathbf{B}_0 = q_s \\, \\mathbf{E},$$\n  其中 $m_s$ 是粒子质量，$q_s$ 是粒子电荷，$\\nu_s$ 是粒子-中性粒子碰撞频率，$\\omega$ 是角频率，$\\mathbf{v}_s$ 是粒子速度响应，$\\mathbf{B}_0$ 是静态背景磁场，$\\mathbf{E}$ 是谐波电场。\n- 通过 $\\mathbf{C}(\\mathbf{B}_0)\\,\\mathbf{v} = \\mathbf{v} \\times \\mathbf{B}_0$ 定义叉积算子矩阵 $\\mathbf{C}(\\mathbf{B}_0)$。用此矩阵构建 $3 \\times 3$ 复数系统矩阵\n  $$\\mathbf{A}_s = \\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0)。$$\n- 求解 $\\mathbf{v}_s = \\frac{q_s}{m_s} \\mathbf{A}_s^{-1} \\mathbf{E}$ 以获得粒子电导率张量 $\\boldsymbol{\\sigma}_s = n_s q_s \\frac{q_s}{m_s} \\mathbf{A}_s^{-1}$，其中 $n_s$ 是粒子数密度。\n- 介电张量与电导率张量之间的关系为\n  $$\\boldsymbol{\\varepsilon} = \\mathbf{I} + \\frac{i}{\\varepsilon_0 \\omega} \\sum_s \\boldsymbol{\\sigma}_s,$$\n  其中 $\\varepsilon_0$ 是真空介电常数。单个粒子对介电张量的贡献为\n  $$\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\boldsymbol{\\sigma}_s。$$\n- 在严格的无磁场极限 $\\mathbf{B}_0 = \\mathbf{0}$ 下，粒子 $s$ 的 Drude 模型标量介电常数贡献为\n  $$\\varepsilon_{s,\\mathrm{Drude}} = - \\frac{\\omega_{p,s}^2}{\\omega \\left(\\omega + i \\nu_s\\right)}, \\quad \\omega_{p,s}^2 \\equiv \\frac{n_s q_s^2}{\\varepsilon_0 m_s}。$$\n\n您的程序必须：\n1. 实现上述过程，根据给定的 $(n_s, q_s, m_s, \\nu_s)$、角频率 $\\omega$ 和背景磁场矢量 $\\mathbf{B}_0$ 计算每种粒子 $s$ 的 $\\boldsymbol{\\varepsilon}_s$。\n2. 使用相同的参数计算每种粒子 $s$ 的标量 Drude 介电常数 $\\varepsilon_{s,\\mathrm{Drude}}$。\n3. 对于下面列出的每个测试用例，验证在无磁场极限下（通过使用 $\\mathbf{B}_0 = \\mathbf{0}$ 或足够小的 $\\mathbf{B}_0$），粒子层级的张量 $\\boldsymbol{\\varepsilon}_s$ 在指定容差范围内是各向同性的，并且等于 $\\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I}$。将粒子层级的相对误差量化为\n   $$\\mathrm{err}_s = \\frac{\\left\\| \\boldsymbol{\\varepsilon}_s - \\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I} \\right\\|_F}{\\max\\left(1, \\left|\\varepsilon_{s,\\mathrm{Drude}}\\right|\\right)},$$\n   其中 $\\|\\cdot\\|_F$ 是 Frobenius 范数，而 $|\\cdot|$ 是复数模。如果一个测试用例中的所有粒子 $s$ 都满足 $\\mathrm{err}_s \\le \\text{tol}$，则该测试用例通过。\n\n物理单位和常数：\n- 使用国际单位制 (SI)。\n- 数密度 $n_s$ 单位为 $\\mathrm{m}^{-3}$，电荷 $q_s$ 单位为 $\\mathrm{C}$，质量 $m_s$ 单位为 $\\mathrm{kg}$，碰撞频率 $\\nu_s$ 单位为 $\\mathrm{s}^{-1}$。\n- 频率以赫兹 $f$ 提供；使用 $\\omega = 2 \\pi f$ 将其转换为角频率，单位为 $\\mathrm{rad/s}$。\n- 背景磁场 $\\mathbf{B}_0$ 单位为 $\\mathrm{T}$。\n- 使用 $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$，基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，电子质量 $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$，质子质量 $m_p = 1.67262192369 \\times 10^{-27}\\,\\mathrm{kg}$，氘核质量 $m_D = 3.3435837724 \\times 10^{-27}\\,\\mathrm{kg}$，以及完全电离的氦-4离子质量 $m_{\\mathrm{He}^{2+}} = 6.6464764 \\times 10^{-27}\\,\\mathrm{kg}$。\n\n测试套件：\n- 用例 1 (精确无磁场边界，双组分氢等离子体)：\n  - 粒子：电子 $(n_e = 1.0 \\times 10^{19}, q_e = -e, m_e, \\nu_e = 1.0 \\times 10^{8})$，质子 $(n_p = 1.0 \\times 10^{19}, q_p = e, m_p, \\nu_p = 1.0 \\times 10^{5})$。\n  - 频率：$f = 1.0 \\times 10^{10}\\,\\mathrm{Hz}$ (因此 $\\omega = 2\\pi f$)。\n  - 磁场：$\\mathbf{B}_0 = (0, 0, 0)\\,\\mathrm{T}$。\n  - 容差：$\\text{tol} = 1.0 \\times 10^{-12}$。\n- 用例 2 (小磁场，射频范围)：\n  - 粒子：与用例 1 相同。\n  - 频率：$f = 1.0 \\times 10^{6}\\,\\mathrm{Hz}$。\n  - 磁场：$\\mathbf{B}_0 = (0, 0, 1.0 \\times 10^{-9})\\,\\mathrm{T}$。\n  - 容差：$\\text{tol} = 1.0 \\times 10^{-7}$。\n- 用例 3 (小磁场，甚低频，有限碰撞性)：\n  - 粒子：电子 $(n_e = 1.0 \\times 10^{18}, q_e = -e, m_e, \\nu_e = 5.0 \\times 10^{6})$，单电荷离子 $(n_i = 1.0 \\times 10^{18}, q_i = e, m_i = m_p, \\nu_i = 1.0 \\times 10^{4})$。\n  - 频率：$f = 1.0 \\times 10^{3}\\,\\mathrm{Hz}$。\n  - 磁场：$\\mathbf{B}_0 = (0, 0, 1.0 \\times 10^{-13})\\,\\mathrm{T}$。\n  - 容差：$\\text{tol} = 1.0 \\times 10^{-5}$。\n- 用例 4 (多组分离子，小磁场)：\n  - 粒子：电子 $(n_e = 2.0 \\times 10^{19}, q_e = -e, m_e, \\nu_e = 5.0 \\times 10^{7})$，氘核 $(n_D = 1.5 \\times 10^{19}, q_D = e, m_D, \\nu_D = 2.0 \\times 10^{5})$，完全电离的氦-4 $(n_{\\mathrm{He}^{2+}} = 2.5 \\times 10^{18}, q_{\\mathrm{He}^{2+}} = 2 e, m_{\\mathrm{He}^{2+}}, \\nu_{\\mathrm{He}^{2+}} = 3.0 \\times 10^{5})$。\n  - 频率：$f = 1.0 \\times 10^{8}\\,\\mathrm{Hz}$。\n  - 磁场：$\\mathbf{B}_0 = (0, 0, 1.0 \\times 10^{-10})\\,\\mathrm{T}$。\n  - 容差：$\\text{tol} = 1.0 \\times 10^{-7}$。\n\n要求的最终输出：\n- 对于四个用例中的每一个，输出一个布尔值，指示该用例中的所有粒子是否都满足 $\\mathrm{err}_s \\le \\text{tol}$。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，“[True,False,True,True]”），其中包含与用例 1 到 4 依次对应的恰好四个布尔条目。",
            "solution": "我们从频域中带碰撞的粒子 $s$ 的线性化冷流体动量方程开始。设谐波时间依赖性为 $e^{-i \\omega t}$，并考虑一个静态背景磁场 $\\mathbf{B}_0$。方程为\n$$m_s \\left(\\nu_s - i \\omega\\right) \\mathbf{v}_s - q_s \\, \\mathbf{v}_s \\times \\mathbf{B}_0 = q_s \\, \\mathbf{E}。$$\n定义 $3 \\times 3$ 单位矩阵 $\\mathbf{I}$ 和叉积算子矩阵 $\\mathbf{C}(\\mathbf{B}_0)$，其定义为 $\\mathbf{C}(\\mathbf{B}_0)\\,\\mathbf{v} = \\mathbf{v} \\times \\mathbf{B}_0$。对于 $\\mathbf{B}_0 = (B_x, B_y, B_z)$ 的笛卡尔分量，矩阵 $\\mathbf{C}(\\mathbf{B}_0)$ 为\n$$\\mathbf{C}(\\mathbf{B}_0) = \\begin{bmatrix}\n0  B_z  -B_y \\\\\n-B_z  0  B_x \\\\\nB_y  -B_x  0\n\\end{bmatrix},$$\n因为 $\\mathbf{C}(\\mathbf{B}_0)\\,\\mathbf{v} = \\mathbf{v} \\times \\mathbf{B}_0$ 产生了预期的分量关系。\n\n我们将动量方程重写为算子形式：\n$$\\left[\\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0)\\right] \\mathbf{v}_s = \\frac{q_s}{m_s} \\mathbf{E}。$$\n令\n$$\\mathbf{A}_s \\equiv \\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0)。$$\n假设对于我们关心的参数，$\\mathbf{A}_s$ 是可逆的，则速度响应为\n$$\\mathbf{v}_s = \\frac{q_s}{m_s} \\mathbf{A}_s^{-1} \\mathbf{E}。$$\n\n来自粒子 $s$ 的电流密度贡献为 $\\mathbf{J}_s = n_s q_s \\mathbf{v}_s$，因此粒子电导率张量为\n$$\\boldsymbol{\\sigma}_s = n_s q_s \\frac{q_s}{m_s} \\mathbf{A}_s^{-1} = \\frac{n_s q_s^2}{m_s} \\mathbf{A}_s^{-1},$$\n总电导率为 $\\boldsymbol{\\sigma} = \\sum_s \\boldsymbol{\\sigma}_s$。\n\n在频域中，介电张量 $\\boldsymbol{\\varepsilon}$ 和电导率张量 $\\boldsymbol{\\sigma}$ 之间的关系是\n$$\\boldsymbol{\\varepsilon} = \\mathbf{I} + \\frac{i}{\\varepsilon_0 \\omega} \\boldsymbol{\\sigma},$$\n因此粒子层级的介电贡献为\n$$\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\boldsymbol{\\sigma}_s = \\frac{i}{\\varepsilon_0 \\omega} \\frac{n_s q_s^2}{m_s} \\mathbf{A}_s^{-1}。$$\n\n在严格无磁场的情况下，设 $\\mathbf{B}_0 = \\mathbf{0}$，这意味着 $\\mathbf{C}(\\mathbf{B}_0) = \\mathbf{0}$，因此 $\\mathbf{A}_s = \\left(\\nu_s - i \\omega\\right) \\mathbf{I}$。其逆矩阵为 $\\mathbf{A}_s^{-1} = \\left(\\nu_s - i \\omega\\right)^{-1} \\mathbf{I}$。因此，\n$$\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\frac{n_s q_s^2}{m_s} \\left(\\nu_s - i \\omega\\right)^{-1} \\mathbf{I}。$$\n使用等离子体频率的平方 $\\omega_{p,s}^2 \\equiv n_s q_s^2/(\\varepsilon_0 m_s)$，我们得到\n$$\\boldsymbol{\\varepsilon}_s = \\left[\\frac{i}{\\omega} \\frac{\\omega_{p,s}^2}{\\nu_s - i \\omega}\\right] \\mathbf{I}。$$\n将括号中的分子和分母同乘以 $\\left(\\omega + i \\nu_s\\right)$ 得到\n$$\\frac{i}{\\omega} \\frac{1}{\\nu_s - i \\omega} = - \\frac{1}{\\omega \\left(\\omega + i \\nu_s\\right)},$$\n因此无磁场情况下的 $\\boldsymbol{\\varepsilon}_s$ 简化为\n$$\\boldsymbol{\\varepsilon}_s = \\left[- \\frac{\\omega_{p,s}^2}{\\omega \\left(\\omega + i \\nu_s\\right)}\\right] \\mathbf{I}。$$\n这恰好是粒子 $s$ 的标量 Drude 介电常数贡献（记为 $\\varepsilon_{s,\\mathrm{Drude}}$）乘以单位矩阵。\n\n对于一个小的但非零的 $\\mathbf{B}_0$，我们将算子逆矩阵按小参数 $\\|\\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0)\\| / \\left|\\nu_s - i \\omega\\right|$ 展开为 Neumann 级数。到一阶为止，\n$$\\mathbf{A}_s^{-1} \\approx \\left(\\nu_s - i \\omega\\right)^{-1} \\left[\\mathbf{I} + \\frac{q_s}{m_s} \\left(\\nu_s - i \\omega\\right)^{-1} \\mathbf{C}(\\mathbf{B}_0) + \\cdots \\right],$$\n因此，$\\boldsymbol{\\varepsilon}_s$ 的主导修正项正比于 $\\left(\\frac{q_s \\|\\mathbf{B}_0\\|}{m_s}\\right)/\\left|\\nu_s - i \\omega\\right|$，这是回旋频率尺度 $\\left|q_s\\right|\\|\\mathbf{B}_0\\|/m_s$ 与复频率尺度 $\\left|\\nu_s - i \\omega\\right|$ 的比值。当 $\\|\\mathbf{B}_0\\| \\to 0$ 时，各向异性修正项消失，且 $\\boldsymbol{\\varepsilon}_s \\to \\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I}$。\n\n算法实现：\n- 从 $\\mathbf{B}_0$ 的分量构建 $\\mathbf{C}(\\mathbf{B}_0)$。\n- 对于每种粒子 $s$，构建 $\\mathbf{A}_s = \\left(\\nu_s - i \\omega\\right) \\mathbf{I} - \\frac{q_s}{m_s} \\mathbf{C}(\\mathbf{B}_0)$ 并数值计算 $\\mathbf{A}_s^{-1}$。\n- 计算 $\\boldsymbol{\\varepsilon}_s = \\frac{i}{\\varepsilon_0 \\omega} \\frac{n_s q_s^2}{m_s} \\mathbf{A}_s^{-1}$。\n- 计算标量 Drude 值 $\\varepsilon_{s,\\mathrm{Drude}} = - \\omega_{p,s}^2 / \\left[\\omega \\left(\\omega + i \\nu_s\\right)\\right]$，其中 $\\omega_{p,s}^2 = n_s q_s^2 / (\\varepsilon_0 m_s)$。\n- 评估粒子层级的误差度量 $\\mathrm{err}_s = \\left\\| \\boldsymbol{\\varepsilon}_s - \\varepsilon_{s,\\mathrm{Drude}} \\mathbf{I} \\right\\|_F / \\max\\left(1, \\left|\\varepsilon_{s,\\mathrm{Drude}}\\right|\\right)$。\n- 对于每个测试用例，确定所有粒子是否满足 $\\mathrm{err}_s \\le \\text{tol}$。\n\n测试套件覆盖理由：\n- 用例 1 验证了在 $\\mathbf{B}_0 = \\mathbf{0}$ 时，对于微波频率下的典型氢等离子体，等式是精确成立的；容差非常严格。\n- 用例 2 测试了在射频下的弱磁场极限，此时回旋频率与波频率之比极小；容差设定为中等严格，以考虑有限大小的 $\\mathbf{B}_0$。\n- 用例 3 探索了一个低频、碰撞占优、磁场极弱的情景；容差被放宽，以适应相对较大的参数 $\\left|q_s\\right|\\|\\mathbf{B}_0\\|/(m_s \\left|\\nu_s - i \\omega\\right|)$。\n- 用例 4 在弱磁场极限下，用不同电荷和质量的离子，确认了多组分的可加性和每种粒子的各向同性。\n\n最终输出是包含四个布尔值的单行，形式为方括号内的逗号分隔列表，分别对应于用例 1 至 4 是否通过了其定义的逐粒子无磁场极限验证。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef cross_matrix(B):\n    \"\"\"\n    Construct the cross-product matrix C(B) such that C(B) @ v = v x B.\n    \"\"\"\n    Bx, By, Bz = B\n    return np.array([\n        [0.0,   Bz,  -By],\n        [-Bz,  0.0,   Bx],\n        [By,   -Bx,  0.0]\n    ], dtype=np.complex128)\n\ndef species_epsilon_tensor(n, q, m, nu, omega, B, eps0):\n    \"\"\"\n    Compute the dielectric tensor contribution for a single species using\n    the cold-fluid linear response:\n        epsilon_s = (i/(eps0 * omega)) * (n q^2 / m) * A^{-1}\n    where A = (nu - i*omega) I - (q/m) C(B).\n    \"\"\"\n    I = np.eye(3, dtype=np.complex128)\n    C = cross_matrix(B)\n    A = (nu - 1j*omega) * I - (q/m) * C\n    A_inv = np.linalg.inv(A)\n    sigma_s = (n * q * q / m) * A_inv  # conductivity tensor for species\n    epsilon_s = 1j * sigma_s / (eps0 * omega)\n    return epsilon_s\n\ndef drude_scalar(n, q, m, nu, omega, eps0):\n    \"\"\"\n    Scalar Drude permittivity contribution for one species:\n        epsilon_s = - omega_p^2 / (omega * (omega + i*nu))\n    where omega_p^2 = n q^2 / (eps0 m)\n    \"\"\"\n    omega_p2 = n * q * q / (eps0 * m)\n    return - omega_p2 / (omega * (omega + 1j * nu))\n\ndef relative_tensor_error(eps_tensor, scalar_val):\n    \"\"\"\n    Compute Frobenius-norm relative error of a 3x3 tensor versus scalar*I:\n        err = ||eps_tensor - scalar_val * I||_F / max(1, |scalar_val|)\n    \"\"\"\n    I = np.eye(3, dtype=np.complex128)\n    diff = eps_tensor - scalar_val * I\n    num = np.linalg.norm(diff, ord='fro')\n    den = max(1.0, abs(scalar_val))\n    return float(num / den)\n\ndef solve():\n    # Physical constants (SI)\n    eps0 = 8.8541878128e-12\n    e = 1.602176634e-19\n    m_e = 9.1093837015e-31\n    m_p = 1.67262192369e-27\n    m_D = 3.3435837724e-27\n    m_He2 = 6.6464764e-27\n\n    # Define the test cases\n    # Each case: dict with species list, frequency f (Hz), B vector (T), tolerance\n    test_cases = [\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 1.0e19, \"q\": -e, \"m\": m_e, \"nu\": 1.0e8},\n                {\"name\": \"p\", \"n\": 1.0e19, \"q\":  e, \"m\": m_p, \"nu\": 1.0e5},\n            ],\n            \"f_Hz\": 1.0e10,\n            \"B\": np.array([0.0, 0.0, 0.0]),\n            \"tol\": 1.0e-12,\n        },\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 1.0e19, \"q\": -e, \"m\": m_e, \"nu\": 1.0e8},\n                {\"name\": \"p\", \"n\": 1.0e19, \"q\":  e, \"m\": m_p, \"nu\": 1.0e5},\n            ],\n            \"f_Hz\": 1.0e6,\n            \"B\": np.array([0.0, 0.0, 1.0e-9]),\n            \"tol\": 1.0e-7,\n        },\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 1.0e18, \"q\": -e, \"m\": m_e, \"nu\": 5.0e6},\n                {\"name\": \"i\", \"n\": 1.0e18, \"q\":  e, \"m\": m_p, \"nu\": 1.0e4},\n            ],\n            \"f_Hz\": 1.0e3,\n            \"B\": np.array([0.0, 0.0, 1.0e-13]),\n            \"tol\": 1.0e-5,\n        },\n        {\n            \"species\": [\n                {\"name\": \"e\", \"n\": 2.0e19,  \"q\": -e,    \"m\": m_e,   \"nu\": 5.0e7},\n                {\"name\": \"D\", \"n\": 1.5e19, \"q\":  e,    \"m\": m_D,   \"nu\": 2.0e5},\n                {\"name\": \"He2\", \"n\": 2.5e18, \"q\":  2*e, \"m\": m_He2, \"nu\": 3.0e5},\n            ],\n            \"f_Hz\": 1.0e8,\n            \"B\": np.array([0.0, 0.0, 1.0e-10]),\n            \"tol\": 1.0e-7,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        omega = 2.0 * np.pi * case[\"f_Hz\"]\n        Bvec = case[\"B\"].astype(np.float64)\n        tol = case[\"tol\"]\n        all_species_ok = True\n        for sp in case[\"species\"]:\n            eps_tensor = species_epsilon_tensor(\n                n=sp[\"n\"], q=sp[\"q\"], m=sp[\"m\"], nu=sp[\"nu\"], omega=omega, B=Bvec, eps0=eps0\n            )\n            drude_val = drude_scalar(\n                n=sp[\"n\"], q=sp[\"q\"], m=sp[\"m\"], nu=sp[\"nu\"], omega=omega, eps0=eps0\n            )\n            err = relative_tensor_error(eps_tensor, drude_val)\n            if not (err = tol):\n                all_species_ok = False\n                break\n        results.append(all_species_ok)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}