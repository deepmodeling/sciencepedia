{
    "hands_on_practices": [
        {
            "introduction": "To truly understand particle confinement in a magnetic mirror, we must begin with the first principles of motion. This foundational exercise guides you through the derivation of the loss cone condition, starting from the conservation of the first adiabatic invariant and kinetic energy. By establishing the direct relationship between the mirror ratio $R_m$ and the critical pitch angle, you will gain a core understanding of what determines whether a particle is trapped or lost .",
            "id": "4012760",
            "problem": "A charged particle moving in a slowly varying, axisymmetric magnetic mirror field experiences nearly conserved invariants on time scales short compared to collisional scattering. Assume a nonrelativistic particle with mass $m$ and charge $q$ moves in a one-dimensional magnetic mirror configuration where the magnetic field magnitude along the axis varies from a minimum $B_{\\min}$ at the midplane to a maximum $B_{\\max}$ at the mirror throat. The first adiabatic invariant $\\mu$ and the total kinetic energy $E$ are conserved as the particle moves along the field. Let the particle’s pitch angle at the midplane be $\\alpha$, defined as the angle between its velocity vector and the local magnetic field line, where $v_{\\perp}$ and $v_{\\parallel}$ are the perpendicular and parallel components of the velocity with respect to the local magnetic field.\n\nStarting from conservation of the first adiabatic invariant $\\mu = m v_{\\perp}^{2}/(2 B)$ and conservation of total kinetic energy $E = m(v_{\\perp}^{2} + v_{\\parallel}^{2})/2$, derive the condition for reflection and obtain an expression for the critical midplane pitch angle $\\alpha_{L}$ that delineates the loss cone. Express $\\alpha_{L}$ purely in terms of $B_{\\min}$ and $B_{\\max}$, and identify how the mirror ratio $R_m$ enters this expression.\n\nThen, for a mirror device with $B_{\\min} = 0.4\\,\\text{T}$ and $B_{\\max} = 4\\,\\text{T}$, compute the mirror ratio $R_m$. Using your derived $\\alpha_{L}(R_m)$ relation, discuss qualitatively (without computing any numerical angles) how the loss cone angle changes when comparing $R_m = 10$ to $R_m = 5$, and explain the physical implication for phase-space accessibility of escaping trajectories.\n\nProvide only the computed $R_m$ as your final answer. No rounding is necessary; report the exact value. The final answer is dimensionless.",
            "solution": "The problem is well-posed and grounded in the fundamental principles of plasma physics, specifically the guiding-center motion of charged particles in a magnetic mirror configuration. We can proceed with the derivation.\n\nThe motion of a charged particle in a slowly varying magnetic field is governed by the conservation of two key quantities: the total kinetic energy, $E$, and the first adiabatic invariant (magnetic moment), $\\mu$. The expressions are given as:\n$$E = \\frac{1}{2}m(v_{\\perp}^{2} + v_{\\parallel}^{2})$$\n$$\\mu = \\frac{m v_{\\perp}^{2}}{2 B}$$\nwhere $m$ is the particle's mass, $v_{\\perp}$ and $v_{\\parallel}$ are the components of velocity perpendicular and parallel to the magnetic field $\\vec{B}$, and $B$ is the magnitude of the magnetic field.\n\nSince $E$ is conserved, the particle's total speed, $v = \\sqrt{v_{\\perp}^{2} + v_{\\parallel}^{2}}$, is constant. We can express the kinetic energy as $E = \\frac{1}{2}mv^2$. The particle's pitch angle $\\theta$ at any point is defined by $v_{\\perp} = v \\sin(\\theta)$ and $v_{\\parallel} = v \\cos(\\theta)$. Substituting $v_{\\perp}$ into the expression for $\\mu$, we get:\n$$\\mu = \\frac{m (v \\sin(\\theta))^2}{2B} = \\frac{mv^2 \\sin^2(\\theta)}{2B}$$\nSince $m$, $v$, and $\\mu$ are all conserved quantities, the term $\\frac{\\sin^2(\\theta)}{B}$ must also be a constant of motion.\n\nLet's denote the quantities at the midplane (where the magnetic field is minimum, $B_{\\min}$) with a subscript 'min', and at any other point along the particle's trajectory with no subscript. We have:\n$$\\frac{\\sin^2(\\theta_{\\min})}{B_{\\min}} = \\frac{\\sin^2(\\theta)}{B}$$\nHere, $\\theta_{\\min}$ is the particle's pitch angle at the midplane, which the problem statement refers to as $\\alpha$.\n\nA particle is reflected, or \"mirrored,\" at the point where its parallel velocity $v_{\\parallel}$ becomes zero. At this turning point, all of its kinetic energy is in the perpendicular motion, so $v_{\\perp} = v$. This corresponds to a pitch angle of $\\theta = \\frac{\\pi}{2}$, for which $\\sin(\\theta) = 1$. Let the magnetic field at this turning point be $B_{\\text{turn}}$. The condition for reflection is found by setting $\\theta = \\frac{\\pi}{2}$ and $B = B_{\\text{turn}}$ in our conservation relation:\n$$\\frac{\\sin^2(\\theta_{\\min})}{B_{\\min}} = \\frac{\\sin^2(\\pi/2)}{B_{\\text{turn}}} = \\frac{1}{B_{\\text{turn}}}$$\nSolving for $B_{\\text{turn}}$, we find the magnetic field strength required to reflect a particle with a midplane pitch angle $\\theta_{\\min}$:\n$$B_{\\text{turn}} = \\frac{B_{\\min}}{\\sin^2(\\theta_{\\min})}$$\nA particle is trapped within the mirror if its turning point occurs at a field strength less than or equal to the maximum field at the mirror throat, i.e., if $B_{\\text{turn}} \\le B_{\\max}$.\n\nThe loss cone consists of particles that are not reflected and escape through the mirror throat. This occurs if the magnetic field required for reflection, $B_{\\text{turn}}$, is greater than $B_{\\max}$. The boundary of the loss cone is defined by the critical pitch angle, which we will call $\\alpha_L$, for which a particle is reflected exactly at the mirror throat. For this limiting case, we set $B_{\\text{turn}} = B_{\\max}$ and $\\theta_{\\min} = \\alpha_L$.\n$$B_{\\max} = \\frac{B_{\\min}}{\\sin^2(\\alpha_L)}$$\nRearranging this equation gives the condition for the critical angle:\n$$\\sin^2(\\alpha_L) = \\frac{B_{\\min}}{B_{\\max}}$$\nTaking the square root and solving for $\\alpha_L$ yields the expression for the critical midplane pitch angle purely in terms of $B_{\\min}$ and $B_{\\max}$:\n$$\\alpha_L = \\arcsin\\left(\\sqrt{\\frac{B_{\\min}}{B_{\\max}}}\\right)$$\nAny particle with a midplane pitch angle $\\alpha  \\alpha_L$ will escape, defining the loss cone.\n\nThe mirror ratio, $R_m$, is defined as the ratio of the maximum magnetic field at the throat to the minimum magnetic field at the midplane:\n$$R_m = \\frac{B_{\\max}}{B_{\\min}}$$\nUsing this definition, the expression for the critical angle $\\alpha_L$ can be written in terms of $R_m$:\n$$\\sin^2(\\alpha_L) = \\frac{1}{R_m} \\quad \\implies \\quad \\alpha_L = \\arcsin\\left(\\frac{1}{\\sqrt{R_m}}\\right)$$\nThis explicitly shows how the mirror ratio $R_m$ enters the expression for the loss cone angle.\n\nFor the specific mirror device given, with $B_{\\min} = 0.4\\,\\text{T}$ and $B_{\\max} = 4\\,\\text{T}$, the mirror ratio $R_m$ is:\n$$R_m = \\frac{4\\,\\text{T}}{0.4\\,\\text{T}} = 10$$\n\nNow, for the qualitative discussion. We compare a mirror with $R_m = 10$ to one with $R_m = 5$. The loss cone boundary is given by $\\alpha_L = \\arcsin(R_m^{-1/2})$. The function $f(R_m) = R_m^{-1/2}$ is a decreasing function for $R_m > 0$. The function $g(x) = \\arcsin(x)$ is an increasing function for $x \\in [-1, 1]$. Therefore, the composite function $\\alpha_L(R_m) = g(f(R_m))$ is a decreasing function of $R_m$. This means that as the mirror ratio $R_m$ increases, the loss cone angle $\\alpha_L$ decreases.\nComparing $R_{m1} = 10$ and $R_{m2} = 5$:\nSince $R_{m1}  R_{m2}$, it follows that $\\alpha_L(R_{m1})  \\alpha_L(R_{m2})$. The loss cone for the mirror with $R_m=5$ is larger than the loss cone for the mirror with $R_m=10$.\nThe physical implication relates to the effectiveness of the magnetic mirror as a confinement device. The loss cone represents the region in velocity phase space corresponding to escaping particle trajectories. A larger loss cone angle means that a greater fraction of the particles (those with small pitch angles) are unconfined. Therefore, the mirror with the lower ratio, $R_m=5$, is less effective at confining the plasma than the mirror with the higher ratio, $R_m=10$. Higher mirror ratios lead to smaller loss cones and thus better confinement.\n\nThe problem asks only for the computed value of $R_m$.",
            "answer": "$$\\boxed{10}$$"
        },
        {
            "introduction": "The mirror ratio $R_m$ is a critical design parameter, but where does it come from? This practice moves from abstract parameters to a concrete physical model by providing an axial magnetic field profile, $B(z)$. Your task will be to apply basic calculus to determine the minimum and maximum field strengths within the confinement volume, thereby deriving the mirror ratio from the geometry of the field itself .",
            "id": "4012688",
            "problem": "Consider a linear magnetic mirror device whose axial magnetic field profile is modeled by $B(z) = B_{0}\\left(1 + a z^{2}\\right)$ for positions $z \\in [-L, L]$, where $B_{0}  0$, $a  0$, and $L  0$. The confinement region is symmetric about $z = 0$. Using first principles, determine the extrema of the magnetic field along the axis and identify the locations where they occur. Then, using the core definition of the mirror ratio in a magnetic mirror, form the dimensionless mirror ratio in terms of only $a$ and $L$. Your reasoning should proceed from basic calculus for extremum identification and physically justified properties of this field profile, and any symmetry arguments must be explicitly justified.\n\nAs context, recall that magnetic mirroring and the associated loss-cone physics in magnetically confined plasmas arise from adiabatic invariance of the first invariant of motion, but do not use any pre-supplied shortcut formulas; build all necessary steps from foundational definitions and invariance principles. You must first determine $B_{\\min}$ and $B_{\\max}$ along $z \\in [-L, L]$, and only then form the mirror ratio.\n\nExpress the final mirror ratio as a dimensionless analytic expression. Provide only the mirror ratio in your final answer.",
            "solution": "The problem requires us to determine the mirror ratio for a linear magnetic mirror device. The axial magnetic field strength, $B(z)$, is given by the function:\n$$\nB(z) = B_{0}\\left(1 + a z^{2}\\right)\n$$\nwhere $B_{0}  0$, $a  0$, and the confinement region is defined by the interval $z \\in [-L, L]$ with $L  0$.\n\nThe mirror ratio, $R_m$, is fundamentally defined as the ratio of the maximum magnetic field strength, $B_{\\max}$, to the minimum magnetic field strength, $B_{\\min}$, within the confinement region.\n$$\nR_m = \\frac{B_{\\max}}{B_{\\min}}\n$$\nTo find the mirror ratio, we must first find the extrema of the function $B(z)$ on the closed interval $[-L, L]$. According to the extreme value theorem, a continuous function on a closed interval must attain its absolute maximum and minimum values on that interval. These extrema occur either at the critical points of the function within the interval or at the endpoints of the interval.\n\nFirst, we identify the critical points of $B(z)$ by finding where its first derivative with respect to $z$ is zero or undefined. The function $B(z)$ is a polynomial in $z$, so it is differentiable everywhere. We compute the derivative $\\frac{dB}{dz}$:\n$$\n\\frac{dB}{dz} = \\frac{d}{dz} \\left[ B_{0}\\left(1 + a z^{2}\\right) \\right] = B_{0} \\frac{d}{dz} \\left(1 + a z^{2}\\right) = B_{0}(2az) = 2aB_{0}z\n$$\nTo find the critical points, we set the derivative equal to zero:\n$$\n2aB_{0}z = 0\n$$\nGiven that $a  0$ and $B_{0}  0$, the product $2aB_{0}$ is non-zero. Therefore, the only solution to this equation is:\n$$\nz = 0\n$$\nThis critical point $z=0$ lies within the interior of the interval $[-L, L]$ since $L0$. To determine if this point corresponds to a local minimum or maximum, we can use the second derivative test. The second derivative of $B(z)$ is:\n$$\n\\frac{d^2B}{dz^2} = \\frac{d}{dz} \\left( 2aB_{0}z \\right) = 2aB_{0}\n$$\nSince $a  0$ and $B_{0}  0$, the second derivative $\\frac{d^2B}{dz^2} = 2aB_{0}$ is strictly positive for all $z$. This indicates that the function $B(z)$ is concave up everywhere, and thus the critical point at $z=0$ corresponds to a local and absolute minimum.\n\nThe value of the magnetic field at this minimum is:\n$$\nB(0) = B_{0}\\left(1 + a(0)^{2}\\right) = B_{0}\n$$\nSo, the minimum magnetic field strength is $B_{\\min} = B_{0}$, and it occurs at the center of the device, $z=0$.\n\nNext, we must evaluate the function at the endpoints of the interval, $z = -L$ and $z = L$.\nAt $z=L$:\n$$\nB(L) = B_{0}\\left(1 + a(L)^{2}\\right) = B_{0}\\left(1 + aL^{2}\\right)\n$$\nAt $z=-L$:\n$$\nB(-L) = B_{0}\\left(1 + a(-L)^{2}\\right) = B_{0}\\left(1 + aL^{2}\\right)\n$$\nAs an explicit justification of the symmetry, the function $B(z)$ is an even function of $z$ because it depends only on $z^2$. This means $B(z) = B(-z)$, so the magnetic field strength is symmetric about the plane $z=0$. Consequently, the values at the endpoints $z=L$ and $z=-L$ are identical.\n\nTo find the maximum magnetic field, $B_{\\max}$, we compare the value at the minimum, $B(0)$, with the values at the endpoints, $B(\\pm L)$.\nWe have $B(0) = B_0$ and $B(\\pm L) = B_0(1 + aL^2)$. Since the problem states that $a  0$ and $L  0$, the term $aL^2$ is strictly positive. Therefore:\n$$\n1 + aL^2  1\n$$\nMultiplying by the positive constant $B_0$ preserves the inequality:\n$$\nB_0(1 + aL^2)  B_0\n$$\nThis confirms that the maximum value of the magnetic field occurs at the endpoints $z = \\pm L$.\n$$\nB_{\\max} = B(\\pm L) = B_{0}\\left(1 + aL^{2}\\right)\n$$\nWe have now identified the extrema:\n- Minimum field: $B_{\\min} = B_{0}$ at $z=0$.\n- Maximum field: $B_{\\max} = B_{0}(1 + aL^{2})$ at $z=\\pm L$.\n\nFinally, we can form the dimensionless mirror ratio, $R_m$, by substituting these values into its definition:\n$$\nR_m = \\frac{B_{\\max}}{B_{\\min}} = \\frac{B_{0}\\left(1 + aL^{2}\\right)}{B_{0}}\n$$\nThe term $B_{0}$ cancels from the numerator and the denominator, yielding the expression for the mirror ratio in terms of only $a$ and $L$:\n$$\nR_m = 1 + aL^{2}\n$$\nThis result is dimensionless as required, as the product $aL^2$ must be dimensionless for the expression $1 + a z^2$ to be consistent (meaning $a$ must have units of inverse length squared).",
            "answer": "$$\\boxed{1 + aL^{2}}$$"
        },
        {
            "introduction": "Analytical solutions provide the \"what,\" but computational methods show us the \"how\" in dynamic detail. In this capstone exercise, you will implement a numerical scheme to integrate the guiding-center equations of motion for a particle in a specified magnetic field. By simulating trajectories and applying a trapping criterion, you will computationally verify the confinement principles explored analytically and gain hands-on experience in building a fundamental plasma physics code .",
            "id": "4012737",
            "problem": "A one-dimensional, axisymmetric magnetic mirror is described along a field line coordinate $s \\in [-L,L]$ by a magnetic field magnitude $B(s)$ that increases monotonically from the midplane to both ends. Consider the specific, scientifically plausible profile\n$$\nB(s) = B_{\\min}\\left[1 + (R_m - 1)\\sin^2\\left(\\frac{\\pi s}{2L}\\right)\\right],\n$$\nwhere $B_{\\min}  0$ is the minimum magnetic field at $s = 0$, $R_m  1$ is the mirror ratio, and $L  0$ is the half-length of the mirror. The maximum field along the line is $B_{\\max} = R_m B_{\\min}$ at $s = \\pm L$. Assume a single charged particle of mass $m$ moves under guiding-center dynamics with no electric field, negligible curvature and gradient drifts, and conserved magnetic moment. The guiding-center parallel dynamics are governed by the fundamental laws\n$$\n\\mu = \\frac{m v_\\perp^2}{2 B}, \\quad m \\frac{d v_\\parallel}{dt} = - \\mu \\frac{d B}{d s}, \\quad \\frac{d s}{dt} = v_\\parallel,\n$$\nand the total kinetic energy $W = \\frac{m}{2}\\left(v_\\perp^2 + v_\\parallel^2\\right)$ is constant in time. The particle’s instantaneous pitch angle $\\alpha(t)$ at position $s(t)$ is defined by the kinematic relation\n$$\n\\alpha(t) = \\arctan\\left(\\frac{v_\\perp(t)}{v_\\parallel(t)}\\right),\n$$\nwith angles to be expressed in radians. The local critical pitch angle $\\alpha_c(s)$ along the same field line is defined as the boundary angle at position $s$, such that a particle launched at $s$ with pitch angle equal to $\\alpha_c(s)$ and the same speed $v$ will be exactly mirrored at the location where $B(s)$ attains its maximum $B_{\\max}$, consistent with conservation of magnetic moment and energy. A trajectory is classified as trapped if it experiences magnetic mirroring (its parallel velocity $v_\\parallel$ reverses direction) inside the domain $|s| \\le L$. Otherwise, it is classified as passing.\n\nImplement a numerical scheme that integrates the guiding-center equations in time, computes $v_\\perp(t)$ from conserved $\\mu$ and local $B(s(t))$, evaluates $\\alpha(t)$ and $\\alpha_c(s(t))$ along the orbit, and determines whether the trajectory is trapped or passing according to the rule above. Your algorithm must be principle-based, relying only on the stated conservation laws and definitions, and should use a stable update for $s(t)$ and $v_\\parallel(t)$ over time. Use International System of Units (SI) consistently: magnetic field in Tesla, length in meters, mass in kilograms, speed in meters per second, and angles in radians. Use a numerical time step small enough to resolve the mirror dynamics and terminate the integration when either the trajectory is classified as trapped (by detecting a reflection) or the particle exits the domain $|s|  L$. If a particle reflects exactly at the boundary $|s| = L$, it is considered trapped.\n\nTest Suite:\nProvide outputs for the following parameter sets. Each test case specifies $(m, v, B_{\\min}, R_m, L, s_0, \\alpha_0)$, where $s_0$ is the initial position and $\\alpha_0$ is the initial pitch angle. All angles must be in radians. For each case, the program should return a boolean value: $\\,\\text{True}$ for trapped, $\\,\\text{False}$ for passing.\n\n- Case $1$ (boundary condition at the loss-cone edge launched from midplane): $(m = 3.3436\\times 10^{-27}\\ \\text{kg},\\ v = 1.5\\times 10^{6}\\ \\text{m/s},\\ B_{\\min} = 1.5\\ \\text{T},\\ R_m = 5.0,\\ L = 1.0\\ \\text{m},\\ s_0 = 0.0\\ \\text{m},\\ \\alpha_0 = 0.463648\\ \\text{rad})$.\n- Case $2$ (trapped, midplane launch): $(m = 3.3436\\times 10^{-27}\\ \\text{kg},\\ v = 2.0\\times 10^{6}\\ \\text{m/s},\\ B_{\\min} = 1.0\\ \\text{T},\\ R_m = 3.0,\\ L = 1.0\\ \\text{m},\\ s_0 = 0.0\\ \\text{m},\\ \\alpha_0 = 0.900000\\ \\text{rad})$.\n- Case $3$ (passing, midplane launch): $(m = 3.3436\\times 10^{-27}\\ \\text{kg},\\ v = 2.0\\times 10^{6}\\ \\text{m/s},\\ B_{\\min} = 1.0\\ \\text{T},\\ R_m = 3.0,\\ L = 1.0\\ \\text{m},\\ s_0 = 0.0\\ \\text{m},\\ \\alpha_0 = 0.400000\\ \\text{rad})$.\n- Case $4$ (off-midplane launch, trapped): $(m = 3.3436\\times 10^{-27}\\ \\text{kg},\\ v = 1.0\\times 10^{6}\\ \\text{m/s},\\ B_{\\min} = 1.2\\ \\text{T},\\ R_m = 4.0,\\ L = 1.5\\ \\text{m},\\ s_0 = 0.75\\ \\text{m},\\ \\alpha_0 = 1.000000\\ \\text{rad})$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3,x_4]$, where each $x_i$ is a boolean as specified above.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, objective, and internally consistent. It poses a standard problem in computational plasma physics concerning the guiding-center motion of a charged particle in an axisymmetric magnetic mirror. All provided physical laws, definitions, and parameters are valid and appropriate for the context. The task is to implement a numerical simulation to determine particle confinement, which is a standard and verifiable computational exercise.\n\nThe solution proceeds by first principles, establishing the necessary physical and mathematical framework before designing the numerical algorithm.\n\n**1. Governing Principles and Derived Quantities**\n\nThe motion of the charged particle is governed by the conservation of total kinetic energy, $W$, and the magnetic moment, $\\mu$.\n\nThe total kinetic energy is constant, determined by the initial conditions:\n$$\nW = \\frac{1}{2}mv^2 = \\text{constant}\n$$\nwhere $m$ is the particle mass and $v$ is its total speed.\n\nThe magnetic moment, an adiabatic invariant, is also constant along the trajectory:\n$$\n\\mu = \\frac{m v_\\perp^2(s)}{2 B(s)} = \\text{constant}\n$$\nIts value is determined by the initial state $(s_0, \\alpha_0)$:\n$$\n\\mu = \\frac{m v_{\\perp,0}^2}{2 B(s_0)} = \\frac{m (v \\sin(\\alpha_0))^2}{2 B(s_0)}\n$$\nwhere $v_{\\perp,0} = v \\sin(\\alpha_0)$ is the initial perpendicular velocity and $B(s_0)$ is the magnetic field at the initial position $s_0$.\n\nThe parallel motion is described by a system of two coupled first-order ordinary differential equations (ODEs):\n$$\n\\frac{ds}{dt} = v_\\parallel\n$$\n$$\n\\frac{dv_\\parallel}{dt} = \\frac{F_\\parallel}{m} = -\\frac{\\mu}{m} \\frac{dB}{ds}\n$$\nThe force $F_\\parallel = -\\mu \\frac{dB}{ds}$ is the \"mirror force,\" which acts to repel the particle from regions of high magnetic field strength. To compute this force, we need the spatial derivative of the given magnetic field profile $B(s) = B_{\\min}\\left[1 + (R_m - 1)\\sin^2\\left(\\frac{\\pi s}{2L}\\right)\\right]$:\n$$\n\\frac{dB}{ds} = \\frac{d}{ds} \\left( B_{\\min}\\left[1 + (R_m - 1)\\sin^2\\left(\\frac{\\pi s}{2L}\\right)\\right] \\right)\n$$\nUsing the chain rule, we find:\n$$\n\\frac{dB}{ds} = B_{\\min}(R_m - 1) \\cdot 2\\sin\\left(\\frac{\\pi s}{2L}\\right)\\cos\\left(\\frac{\\pi s}{2L}\\right) \\cdot \\frac{\\pi}{2L}\n$$\nApplying the trigonometric identity $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$, this simplifies to:\n$$\n\\frac{dB}{ds} = B_{\\min}(R_m - 1) \\frac{\\pi}{2L} \\sin\\left(\\frac{\\pi s}{L}\\right)\n$$\n\n**2. Trapping and Passing Criterion**\n\nA particle is \"trapped\" if it is reflected by the magnetic mirror before it can escape the device. This physical reflection point, or \"turning point,\" is where the parallel velocity $v_\\parallel$ becomes zero. If a particle's parallel velocity becomes zero at a position $|s|  L$, it is trapped. If the particle reaches the end of the mirror, $|s| = L$, with a non-zero parallel velocity, it escapes and is classified as \"passing.\" A particle that reaches $|s|=L$ with exactly $v_\\parallel=0$ is, by the problem's definition, considered trapped.\n\nThe numerical simulation will directly test for this condition. We will integrate the equations of motion for $s(t)$ and $v_\\parallel(t)$ and monitor the state of the particle. The simulation terminates and reports a classification based on two conditions:\n1.  **Trapped:** The particle's parallel velocity $v_\\parallel(t)$ reverses sign at a position $|s(t)| \\le L$. This indicates a turning point has been reached inside the mirror.\n2.  **Passing:** The particle's position $s(t)$ satisfies $|s(t)|  L$. This indicates the particle has exited the mirror from one end.\n\n**3. Numerical Integration Scheme**\n\nTo solve the system of ODEs for $s(t)$ and $v_\\parallel(t)$, we employ the Velocity Verlet (or leapfrog) algorithm. This is a symplectic integrator, well-suited for Hamiltonian systems like this one, as it exhibits good long-term energy conservation properties. Given the state $(s_i, v_{\\parallel,i})$ at time $t_i$, the state at time $t_{i+1} = t_i + \\Delta t$ is computed as follows:\n\nFirst, we define the parallel acceleration $a_\\parallel(s) = -\\frac{\\mu}{m}\\frac{dB}{ds}$.\n\n1.  Calculate the half-step velocity (this step is implicit in the standard form): $v_{\\parallel, i+1/2} = v_{\\parallel, i} + \\frac{1}{2} a_\\parallel(s_i) \\Delta t$.\n2.  Update the position to the full step: $s_{i+1} = s_i + v_{\\parallel, i} \\Delta t + \\frac{1}{2} a_\\parallel(s_i) (\\Delta t)^2$. This is mathematically equivalent to $s_{i+1} = s_i + v_{\\parallel,i+1/2} \\Delta t$.\n3.  Calculate the new acceleration $a_\\parallel(s_{i+1})$ at the new position.\n4.  Update the velocity to the full step: $v_{\\parallel, i+1} = v_{\\parallel, i} + \\frac{1}{2}\\left(a_\\parallel(s_i) + a_\\parallel(s_{i+1})\\right)\\Delta t$. This is equivalent to $v_{\\parallel, i+1} = v_{\\parallel, i+1/2} + \\frac{1}{2}a_\\parallel(s_{i+1}) \\Delta t$.\n\nThis scheme is applied iteratively, starting from the initial conditions $(s_0, v_{\\parallel,0})$, until a trapping or passing condition is met. A sufficiently small time step $\\Delta t$ is chosen to ensure the dynamics are well-resolved. Given particle speeds of $\\sim 10^6 \\, \\text{m/s}$ and a device length of $\\sim 1 \\, \\text{m}$, the characteristic bounce time is on the order of microseconds ($10^{-6} \\, \\text{s}$). A time step of $\\Delta t = 10^{-9} \\, \\text{s}$ provides ample resolution.\n\n**4. Algorithmic Implementation**\n\nFor each test case specified by $(m, v, B_{\\min}, R_m, L, s_0, \\alpha_0)$:\n\n1.  **Initialize**:\n    -   Calculate initial parallel and perpendicular velocities: $v_{\\parallel,0} = v\\cos(\\alpha_0)$, $v_{\\perp,0} = v\\sin(\\alpha_0)$.\n    -   Store the initial direction of motion via $\\text{sign}(v_{\\parallel,0})$. If $v_{\\parallel,0} = 0$, the particle is immediately classified as trapped.\n    -   Compute the magnetic field at the start position, $B(s_0)$.\n    -   Compute the conserved magnetic moment, $\\mu = m v_{\\perp,0}^2 / (2 B(s_0))$.\n    -   Initialize current state: $s \\leftarrow s_0$, $v_\\parallel \\leftarrow v_{\\parallel,0}$.\n\n2.  **Iterate**:\n    -   Start a time-stepping loop up to a maximum number of iterations to prevent infinite execution.\n    -   Inside the loop, apply one step of the Velocity Verlet algorithm to update $s$ and $v_\\parallel$.\n    -   After each step, check termination conditions:\n        -   If $|s|  L$, the particle has escaped. The trajectory is `passing`. Return `False`.\n        -   If the sign of the current $v_\\parallel$ is opposite to or zero compared to the initial $v_\\parallel$, a reflection has occurred. The trajectory is `trapped`. Return `True`.\n\n3.  **Output**: Collect the boolean results for all test cases and format them as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n    # Test Suite: (m, v, B_min, R_m, L, s0, alpha0)\n    # m: mass (kg), v: total speed (m/s), B_min: min field (T), R_m: mirror ratio,\n    # L: half-length (m), s0: initial position (m), alpha0: initial pitch angle (rad)\n    test_cases = [\n        # Case 1 (boundary condition at the loss-cone edge launched from midplane)\n        (3.3436e-27, 1.5e6, 1.5, 5.0, 1.0, 0.0, 0.463648),\n        # Case 2 (trapped, midplane launch)\n        (3.3436e-27, 2.0e6, 1.0, 3.0, 1.0, 0.0, 0.900000),\n        # Case 3 (passing, midplane launch)\n        (3.3436e-27, 2.0e6, 1.0, 3.0, 1.0, 0.0, 0.400000),\n        # Case 4 (off-midplane launch, trapped)\n        (3.3436e-27, 1.0e6, 1.2, 4.0, 1.5, 0.75, 1.000000),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = is_trapped_simulation(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef is_trapped_simulation(m, v, B_min, R_m, L, s0, alpha0):\n    \"\"\"\n    Numerically integrates the guiding-center equations of motion to determine\n    if a particle trajectory is trapped or passing.\n\n    Returns:\n        bool: True if the particle is trapped, False if it is passing.\n    \"\"\"\n    # Numerical parameters\n    dt = 1e-9  # Time step in seconds\n    max_steps = 5_000_000  # Max iterations to prevent infinite loop (5 ms)\n\n    # Initial conditions from given parameters\n    v_parallel = v * np.cos(alpha0)\n    v_perp = v * np.sin(alpha0)\n    \n    # A particle with zero initial parallel velocity is trapped if not at a stable point.\n    # The force will push it towards the midplane. If at s=0, it stays there.\n    # In all cases, it does not escape.\n    if np.isclose(v_parallel, 0.0):\n        return True\n\n    v_parallel_initial_sign = np.sign(v_parallel)\n    s = s0\n\n    # Conserved magnetic moment calculation\n    # B(s) = B_min * [1 + (R_m - 1) * sin^2(pi*s / (2L))]\n    B_s0 = B_min * (1 + (R_m - 1) * np.sin(np.pi * s0 / (2 * L))**2)\n    mu = (m * v_perp**2) / (2 * B_s0)\n\n    # Pre-calculate constant terms for the force calculation\n    force_coeff = - (mu / m) * B_min * (R_m - 1) * (np.pi / (2 * L))\n    \n    def dB_ds(current_s):\n        \"\"\"Calculates the magnetic field gradient dB/ds at position s.\"\"\"\n        return B_min * (R_m - 1) * (np.pi / (2 * L)) * np.sin(np.pi * current_s / L)\n\n    def parallel_acceleration(current_s):\n        \"\"\"Calculates the parallel acceleration at position s.\"\"\"\n        return - (mu / m) * dB_ds(current_s)\n\n    # Leapfrog (Velocity Verlet) integration loop\n    # Initial acceleration\n    accel_parallel = parallel_acceleration(s)\n    \n    for _ in range(max_steps):\n        # Velocity Verlet integrator\n        s_new = s + v_parallel * dt + 0.5 * accel_parallel * dt**2\n        accel_parallel_new = parallel_acceleration(s_new)\n        v_parallel_new = v_parallel + 0.5 * (accel_parallel + accel_parallel_new) * dt\n        \n        s = s_new\n        v_parallel = v_parallel_new\n        accel_parallel = accel_parallel_new\n\n        # Check for passing condition\n        if np.abs(s)  L:\n            return False\n\n        # Check for trapping condition (mirroring, i.e., v_parallel sign flip)\n        # The product is = 0 if v_parallel is 0 or has flipped sign.\n        if v_parallel_initial_sign * v_parallel = 0:\n            return True\n\n    # If the loop finishes, something is unexpected. For a trapped particle,\n    # it must mirror within the max_steps. If not, it suggests a numerical issue\n    # or an extremely long bounce period. For this problem's scope, we can assume\n    # this state implies a trapped particle that has not exited.\n    return True\n\nsolve()\n```"
        }
    ]
}