{
    "hands_on_practices": [
        {
            "introduction": "Understanding the plasma's collective behavior begins with mastering its dielectric response. This foundational exercise guides you through the derivation of the longitudinal dielectric function for a simple, unmagnetized plasma, starting from the first principles of the two-fluid model . By setting the dielectric function to zero, you will uncover the dispersion relation for ion acoustic waves, providing a direct and tangible link between the abstract concept of dielectric response and a physically observable wave mode.",
            "id": "4064005",
            "problem": "An unmagnetized, uniform, singly ionized plasma with equilibrium density $n_{0}$ consists of ions of mass $m_{i}$ and electrons with temperature $T_{e}$ that obey an adiabatic equation of state with adiabatic index $\\gamma_{e}$. Consider small-amplitude, electrostatic, longitudinal plane-wave perturbations proportional to $\\exp(i k x - i \\omega t)$. Use a collisionless, two-fluid description with cold ions (neglect ion pressure) and neglect electron inertia, and close the electron fluid with the adiabatic pressure law. Begin from the linearized continuity and momentum equations for ions and electrons together with Poisson’s equation, and proceed from these fundamental equations without introducing any shortcut formulas.\n\nTasks:\n- Derive the longitudinal dielectric function $\\epsilon_{L}(\\omega,k)$ for this system in a form that makes explicit the contribution of the electron pressure through $\\gamma_{e}$. Express your result in terms of the ion plasma frequency $\\omega_{pi}$ and the electron Debye length modified by the adiabatic index, $\\lambda_{D,\\gamma}$, where\n$$\n\\omega_{pi}^{2} \\equiv \\frac{n_{0} e^{2}}{\\varepsilon_{0} m_{i}},\\qquad \\lambda_{D,\\gamma}^{2} \\equiv \\frac{\\varepsilon_{0} \\gamma_{e} k_{B} T_{e}}{n_{0} e^{2}}.\n$$\n- Impose the longitudinal electrostatic wave condition $\\epsilon_{L}(\\omega,k)=0$ to obtain the ion acoustic wave dispersion in closed form. Eliminate $\\omega_{pi}$ and $\\lambda_{D,\\gamma}$ in favor of the ion-acoustic speed $c_{s}$ if desired, where $c_{s}^{2} \\equiv \\gamma_{e} k_{B} T_{e} / m_{i}$.\n\nAnswer specification:\n- Provide a single, closed-form analytic expression for $\\omega^{2}(k)$ in terms of $k$, $c_{s}$, and $\\lambda_{D,\\gamma}$.\n- Do not include units in your final expression.",
            "solution": "The problem is valid as it is scientifically grounded in established plasma physics principles, well-posed with a clear objective and sufficient information, and uses precise, objective language. We may proceed with the solution.\n\nThe problem asks for the derivation of the ion-acoustic wave dispersion relation within a collisionless, two-fluid model for an unmagnetized, uniform plasma. The starting point is the set of fundamental fluid equations for ions (species label $i$) and electrons (species label $e$), along with Poisson's equation.\n\nThe fundamental equations are:\n1.  Continuity equation for species $s \\in \\{i, e\\}$:\n    $$ \\frac{\\partial n_s}{\\partial t} + \\nabla \\cdot (n_s \\mathbf{v}_s) = 0 $$\n2.  Momentum equation for species $s$:\n    $$ m_s n_s \\left( \\frac{\\partial \\mathbf{v}_s}{\\partial t} + (\\mathbf{v}_s \\cdot \\nabla) \\mathbf{v}_s \\right) = q_s n_s \\mathbf{E} - \\nabla p_s $$\n3.  Poisson's equation:\n    $$ \\nabla \\cdot \\mathbf{E} = \\frac{1}{\\varepsilon_0} \\sum_s q_s n_s = \\frac{e}{\\varepsilon_0}(n_i - n_e) $$\nThe system is closed with an adiabatic equation of state for electrons:\n$$ \\frac{d}{dt} (p_e n_e^{-\\gamma_e}) = 0 \\implies p_e = C n_e^{\\gamma_e} $$\n\nWe consider small perturbations about a uniform, stationary, and neutral equilibrium:\n$n_s(\\mathbf{r}, t) = n_0 + n_{s1}(\\mathbf{r}, t)$\n$\\mathbf{v}_s(\\mathbf{r}, t) = \\mathbf{0} + \\mathbf{v}_{s1}(\\mathbf{r}, t)$\n$\\mathbf{E}(\\mathbf{r}, t) = \\mathbf{0} + \\mathbf{E}_1(\\mathbf{r}, t)$\n$p_s(\\mathbf{r}, t) = p_{s0} + p_{s1}(\\mathbf{r}, t)$\n\nThe perturbations are assumed to be longitudinal plane waves of the form $\\exp(i k x - i \\omega t)$. This implies the substitutions $\\frac{\\partial}{\\partial t} \\to -i \\omega$ and $\\nabla \\to i k \\hat{\\mathbf{x}}$. The vectors become scalars in this one-dimensional geometry: $\\mathbf{v}_{s1} \\to v_{s1} \\hat{\\mathbf{x}}$ and $\\mathbf{E}_1 \\to E_1 \\hat{\\mathbf{x}}$.\n\nThe linearized equations become:\nIon continuity:\n$$ -i \\omega n_{i1} + i k n_0 v_{i1} = 0 \\implies n_{i1} = \\frac{k n_0}{\\omega} v_{i1} $$\nIon momentum (cold ions, $p_{i1}=0$, $q_i = +e$):\n$$ -i \\omega m_i n_0 v_{i1} = n_0 e E_1 \\implies v_{i1} = \\frac{e E_1}{-i \\omega m_i} = \\frac{i e E_1}{\\omega m_i} $$\nElectron momentum (massless electrons, $m_e \\to 0$, $q_e = -e$):\nThe left-hand side vanishes, giving a balance between electric and pressure forces.\n$$ 0 = -n_0 e E_1 - i k p_{e1} $$\nAdiabatic electron pressure perturbation:\nLinearizing $p_e = C n_e^{\\gamma_e}$ gives $p_{e1} = (\\frac{\\partial p_e}{\\partial n_e})_0 n_{e1} = \\gamma_e \\frac{p_{e0}}{n_0} n_{e1}$. Using the ideal gas law for the equilibrium state, $p_{e0} = n_0 k_B T_e$, we get:\n$$ p_{e1} = \\gamma_e k_B T_e n_{e1} $$\nPoisson's equation:\n$$ i k E_1 = \\frac{e}{\\varepsilon_0} (n_{i1} - n_{e1}) $$\n\nNow, we express the perturbed densities $n_{i1}$ and $n_{e1}$ in terms of the electric field $E_1$.\nFor ions, we substitute the expression for $v_{i1}$ into the continuity equation:\n$$ n_{i1} = \\frac{k n_0}{\\omega} \\left( \\frac{i e E_1}{\\omega m_i} \\right) = \\frac{i k n_0 e E_1}{\\omega^2 m_i} $$\nFor electrons, we substitute the pressure law into the momentum equation:\n$$ 0 = -n_0 e E_1 - i k (\\gamma_e k_B T_e n_{e1}) $$\nSolving for $n_{e1}$:\n$$ n_{e1} = \\frac{-n_0 e E_1}{i k \\gamma_e k_B T_e} = \\frac{i n_0 e E_1}{k \\gamma_e k_B T_e} $$\n\nTo derive the longitudinal dielectric function $\\epsilon_L(\\omega,k)$, we express it as $\\epsilon_L = 1 + \\chi_i + \\chi_e$, where $\\chi_s$ is the electric susceptibility of species $s$. The susceptibility is defined via the induced charge density $q_s n_{s1}$ and the electric potential $\\phi_1$, where $E_1 = -ik\\phi_1$. The definition is $q_s n_{s1} = -\\varepsilon_0 k^2 \\chi_s \\phi_1 = -\\varepsilon_0 k^2 \\chi_s (E_1/(-ik)) = i \\varepsilon_0 k \\chi_s E_1$.\nThus, $\\chi_s = \\frac{q_s n_{s1}}{i \\varepsilon_0 k E_1}$.\n\nFor ions ($q_i=e$):\n$$ \\chi_i = \\frac{e}{i \\varepsilon_0 k E_1} \\left( \\frac{i k n_0 e E_1}{\\omega^2 m_i} \\right) = \\frac{n_0 e^2}{\\varepsilon_0 m_i \\omega^2} = -\\frac{\\omega_{pi}^2}{\\omega^2} $$\nwhere we have used the definition of the ion plasma frequency, $\\omega_{pi}^2 \\equiv \\frac{n_0 e^2}{\\varepsilon_0 m_i}$. The minus sign is inserted by convention in plasma physics, so $\\chi_i = -\\frac{\\omega_{pi}^2}{\\omega^2}$. Let's re-verify the definition. $\\sigma = \\frac{J}{E}$. $\\epsilon = 1 + \\frac{i\\sigma}{\\omega\\epsilon_0}$. $J_i = n_0qv_i = n_0e \\frac{ieE_1}{\\omega m_i} = \\frac{in_0e^2E_1}{\\omega m_i}$. So $\\sigma_i = \\frac{in_0e^2}{\\omega m_i}$. $\\epsilon_i(\\omega)=1 - \\frac{n_0e^2}{\\epsilon_0 m_i\\omega^2} = 1 - \\frac{\\omega_{pi}^2}{\\omega^2}$. Hence $\\chi_i = -\\frac{\\omega_{pi}^2}{\\omega^2}$.\n\nFor electrons ($q_e=-e$):\n$$ \\chi_e = \\frac{-e}{i \\varepsilon_0 k E_1} \\left( \\frac{i n_0 e E_1}{k \\gamma_e k_B T_e} \\right) = \\frac{-n_0 e^2}{\\varepsilon_0 k^2 \\gamma_e k_B T_e} = \\frac{1}{k^2 \\lambda_{D,\\gamma}^2} $$\nwhere we have used the definition of the modified Debye length, $\\lambda_{D,\\gamma}^2 \\equiv \\frac{\\varepsilon_0 \\gamma_e k_B T_e}{n_0 e^2}$. My previous calculation had a sign error. Let me re-check.\n$\\chi_s = \\frac{q_s n_{s1}}{i \\varepsilon_0 k E_1}$.\n$n_{e1} = \\frac{i n_0 e E_1}{k \\gamma_e k_B T_e}$.\n$\\chi_e = \\frac{(-e)}{i \\varepsilon_0 k E_1} \\left( \\frac{i n_0 e E_1}{k \\gamma_e k_B T_e} \\right) = \\frac{-n_0 e^2}{-\\varepsilon_0 k^2 \\gamma_e k_B T_e} \\cdot (-1) = \\frac{n_0 e^2}{\\varepsilon_0 k^2 \\gamma_e k_B T_e} = \\frac{1}{k^2 \\lambda_{D, \\gamma}^2}$. The definition of susceptibility is from $\\nabla \\cdot (\\epsilon \\mathbf{E})=0$, which implies $k^2 \\epsilon \\phi = 0$. $\\epsilon_0 k^2 \\phi + \\sum q_s n_{s1}=0$. $\\epsilon_0 k^2 \\phi + q_i n_{i1} + q_e n_{e1}=0$. The susceptibilities are defined by $q_s n_{s1} = -\\epsilon_0 k^2 \\chi_s \\phi$. So $\\epsilon = 1+\\chi_i+\\chi_e$. With $E_1 = -ik\\phi$, $\\chi_s = \\frac{q_s n_{s1}}{\\epsilon_0 k^2 \\phi} = \\frac{q_s n_{s1}}{-i\\epsilon_0 k E_1}$.\nFor electrons: $\\chi_e=\\frac{(-e) n_{e1}}{-i\\epsilon_0 k E_1} = \\frac{e}{-i\\epsilon_0 k E_1} (\\frac{i n_0 e E_1}{k \\gamma_e k_B T_e}) = \\frac{n_0 e^2}{\\epsilon_0 k^2 \\gamma_e k_B T_e} = \\frac{1}{k^2 \\lambda_{D, \\gamma}^2}$. This is correct.\n\nThe longitudinal dielectric function is:\n$$ \\epsilon_L(\\omega, k) = 1 + \\chi_i + \\chi_e = 1 - \\frac{\\omega_{pi}^2}{\\omega^2} + \\frac{1}{k^2 \\lambda_{D,\\gamma}^2} $$\nThis expression fulfills the first task, showing the dependence on $\\gamma_e$ via $\\lambda_{D,\\gamma}$.\n\nFor self-sustained longitudinal waves to exist, the dielectric function must be zero, $\\epsilon_L(\\omega, k) = 0$.\n$$ 1 - \\frac{\\omega_{pi}^2}{\\omega^2} + \\frac{1}{k^2 \\lambda_{D,\\gamma}^2} = 0 $$\nWe solve for $\\omega^2$:\n$$ \\frac{\\omega_{pi}^2}{\\omega^2} = 1 + \\frac{1}{k^2 \\lambda_{D,\\gamma}^2} = \\frac{k^2 \\lambda_{D,\\gamma}^2 + 1}{k^2 \\lambda_{D,\\gamma}^2} $$\n$$ \\omega^2 = \\omega_{pi}^2 \\frac{k^2 \\lambda_{D,\\gamma}^2}{1 + k^2 \\lambda_{D,\\gamma}^2} $$\nThis is the dispersion relation. The final step is to express it in terms of the ion-acoustic speed $c_s$, where $c_s^2 \\equiv \\frac{\\gamma_e k_B T_e}{m_i}$. We use the provided definitions to find a relationship between $\\omega_{pi}^2$, $\\lambda_{D,\\gamma}^2$, and $c_s^2$:\n$$ \\omega_{pi}^2 \\lambda_{D,\\gamma}^2 = \\left( \\frac{n_0 e^2}{\\varepsilon_0 m_i} \\right) \\left( \\frac{\\varepsilon_0 \\gamma_e k_B T_e}{n_0 e^2} \\right) = \\frac{\\gamma_e k_B T_e}{m_i} = c_s^2 $$\nFrom this, we can write $\\omega_{pi}^2 = \\frac{c_s^2}{\\lambda_{D,\\gamma}^2}$. Substituting this into the dispersion relation:\n$$ \\omega^2 = \\left( \\frac{c_s^2}{\\lambda_{D,\\gamma}^2} \\right) \\frac{k^2 \\lambda_{D,\\gamma}^2}{1 + k^2 \\lambda_{D,\\gamma}^2} $$\nThe term $\\lambda_{D,\\gamma}^2$ in the numerator cancels, yielding the final expression for the ion-acoustic wave dispersion relation:\n$$ \\omega^2(k) = \\frac{c_s^2 k^2}{1 + k^2 \\lambda_{D,\\gamma}^2} $$\nThis expression gives the wave frequency $\\omega$ as a function of the wavenumber $k$, in terms of the ion-acoustic speed $c_s$ and the modified Debye length $\\lambda_{D,\\gamma}$.",
            "answer": "$$\n\\boxed{\\frac{c_s^2 k^2}{1 + k^2 \\lambda_{D,\\gamma}^2}}\n$$"
        },
        {
            "introduction": "Introducing a background magnetic field breaks the plasma's isotropy, promoting the scalar dielectric function to a full tensor. This practice explores the structure of the warm plasma dielectric tensor for the important case of wave propagation parallel to the magnetic field in a multi-species plasma . By implementing a two-fluid model, you will computationally dissect the tensor, observing how thermal pressure modifies the longitudinal response while the transverse response retains its characteristic cold-plasma, cyclotron-driven form.",
            "id": "4064010",
            "problem": "A homogeneous, collisionless, magnetized, multi-species plasma is considered with a uniform background magnetic field $\\mathbf{B}_0$ aligned with the $\\hat{\\mathbf{z}}$ direction, and a plane wave characterized by an angular frequency $\\omega$ and a wavevector $\\mathbf{k}$ parallel to $\\mathbf{B}_0$ (so that $\\mathbf{k}=k_z\\hat{\\mathbf{z}}$). The plasma contains electrons and two distinct ion species with different charge numbers $Z$ and masses $m$. The task is to construct the total dielectric tensor for this warm plasma under a two-fluid adiabatic assumption and analyze each species' contribution to the tensor components $\\epsilon_{xx}$, $\\epsilon_{xy}$, and $\\epsilon_{zz}$.\n\nBegin from the linearized two-fluid equations with adiabatic pressure closure and Maxwell's equations in the frequency-wavenumber domain. Use the continuity equation, the momentum equation including the Lorentz force and pressure-gradient term, and the current-density definition to connect the species velocity perturbations to the electric field. Assume an adiabatic index $\\gamma_s$ for each species $s$ and define a species-specific sound speed $c_s$ consistent with the adiabatic closure. Under the special geometry $\\mathbf{k}\\parallel\\mathbf{B}_0$, deduce how the thermal pressure modifies only the longitudinal ($\\hat{\\mathbf{z}}$) response while the transverse ($\\hat{\\mathbf{x}},\\hat{\\mathbf{y}}$) cyclotron dynamics remain of the cold-plasma form. From these, construct the species susceptibilities and assemble the total dielectric tensor $\\boldsymbol{\\epsilon}$.\n\nYou must implement a program that computes, for each test case, the total dimensionless dielectric components $\\epsilon_{xx}$, the scalar $D$ such that $\\epsilon_{xy}=-\\mathrm{i}D$, and $\\epsilon_{zz}$, as well as the per-species additive contributions to these components. The program must not take any input and must use the specified test suite below. All physical computations must use International System of Units (SI), with the following constants and conventions:\n- Elementary charge $e=1.602176634\\times 10^{-19}~\\mathrm{C}$,\n- Vacuum permittivity $\\epsilon_0=8.8541878128\\times 10^{-12}~\\mathrm{F/m}$,\n- Electron mass $m_e=9.1093837015\\times 10^{-31}~\\mathrm{kg}$,\n- Atomic mass unit $1~\\mathrm{amu}=1.66053906660\\times 10^{-27}~\\mathrm{kg}$.\nTemperatures are provided in electronvolts and must be converted to joules via $T~[\\mathrm{J}]=T~[\\mathrm{eV}]\\times e$. For the adiabatic index, use $\\gamma_s=5/3$ for all species. Use $q_e=-e$ for electrons and $q_i=Z_ie$ for ions. Define the plasma frequency for species $s$ by $\\omega_{ps}^2=n_s q_s^2/(\\epsilon_0 m_s)$ and the cyclotron frequency by $\\Omega_s=q_s B_0/m_s$.\n\nSpecies and background parameters for all test cases:\n- Background magnetic field $B_0=3.0~\\mathrm{T}$.\n- Electron: number density $n_e$ set by quasi-neutrality, charge $q_e=-e$, mass $m_e$ as above, temperature $T_e=2000~\\mathrm{eV}$, adiabatic index $\\gamma_e=5/3$.\n- Ion species 1 (deuterium): charge number $Z_1=1$, mass $m_1=2~\\mathrm{amu}$, number density $n_1=3.0\\times 10^{19}~\\mathrm{m}^{-3}$, temperature $T_1=1000~\\mathrm{eV}$, adiabatic index $\\gamma_1=5/3$.\n- Ion species 2 (lithium): charge number $Z_2=3$, mass $m_2=7~\\mathrm{amu}$, number density $n_2=1.0\\times 10^{19}~\\mathrm{m}^{-3}$, temperature $T_2=500~\\mathrm{eV}$, adiabatic index $\\gamma_2=5/3$.\n- Enforce quasi-neutrality $n_e=Z_1 n_1+Z_2 n_2$.\n\nTest suite of $(\\omega,k_z)$ values, with $\\omega$ in $\\mathrm{rad/s}$ and $k_z$ in $\\mathrm{m}^{-1}$:\n1. Case A (general oblique-frequency, moderate warm effect): $\\omega=1.0\\times 10^{9}~\\mathrm{rad/s}$, $k_z=10~\\mathrm{m}^{-1}$.\n2. Case B (high frequency near electron cyclotron, cold-like transverse response): $\\omega=5.0\\times 10^{11}~\\mathrm{rad/s}$, $k_z=1~\\mathrm{m}^{-1}$.\n3. Case C (strong longitudinal warm effect, near compressional resonance for electrons): $\\omega=8.0\\times 10^{9}~\\mathrm{rad/s}$, $k_z=95~\\mathrm{m}^{-1}$.\n\nYour program must compute, for each test case, the following lists of floats:\n- The total components $[\\epsilon_{xx},D,\\epsilon_{zz}]$,\n- The electron additive contributions $[\\Delta\\epsilon_{xx}^{(e)},D^{(e)},\\Delta\\epsilon_{zz}^{(e)}]$,\n- The ion species 1 additive contributions $[\\Delta\\epsilon_{xx}^{(1)},D^{(1)},\\Delta\\epsilon_{zz}^{(1)}]$,\n- The ion species 2 additive contributions $[\\Delta\\epsilon_{xx}^{(2)},D^{(2)},\\Delta\\epsilon_{zz}^{(2)}]$.\n\nThe final output must be a single line containing a list of the above four-list structures for all three test cases, concatenated into one list, with no spaces, for example: \n$[\\,[\\,[\\epsilon_{xx},D,\\epsilon_{zz}],[\\Delta\\epsilon_{xx}^{(e)},D^{(e)},\\Delta\\epsilon_{zz}^{(e)}],[\\Delta\\epsilon_{xx}^{(1)},D^{(1)},\\Delta\\epsilon_{zz}^{(1)}],[\\Delta\\epsilon_{xx}^{(2)},D^{(2)},\\Delta\\epsilon_{zz}^{(2)}]\\,],\\ldots\\,]$.\nAll returned values are dimensionless floats. Angle units are not used because $\\mathbf{k}\\parallel\\mathbf{B}_0$ is prescribed. The program must not read any inputs and must be runnable as-is.\n\nDesign for coverage:\n- Case A tests a typical warm plasma regime in fusion-relevant parameters.\n- Case B probes proximity to the electron cyclotron frequency, emphasizing transverse cyclotron contributions.\n- Case C examines strong longitudinal warm effects and the role of electron compressibility via $k_z^2 c_e^2$ relative to $\\omega^2$.\n\nThe final output format must be a single line containing the results as a comma-separated list enclosed in square brackets, exactly as specified above, without any spaces.",
            "solution": "The user-provided problem is valid. It is scientifically grounded in the established principles of plasma physics, specifically the two-fluid model for wave propagation in a magnetized plasma. The problem is well-posed, with all necessary parameters and physical laws defined, leading to a unique and meaningful solution. It is objective and uses precise terminology. The conditions and parameters provided are physically realistic for a fusion plasma environment. Therefore, a complete solution is warranted.\n\nThe theoretical foundation for constructing the warm plasma dielectric tensor begins with the linearized two-fluid equations for each species $s$ in the plasma. For a plane wave perturbation proportional to $\\exp(i(\\mathbf{k} \\cdot \\mathbf{r} - \\omega t))$, the linearized momentum and continuity equations are our starting point.\n\nThe linearized momentum equation for a particle of species $s$ is:\n$$\n-i\\omega m_s \\mathbf{v}_{s1} = q_s (\\mathbf{E}_1 + \\mathbf{v}_{s1} \\times \\mathbf{B}_0) - \\frac{\\nabla p_{s1}}{n_{s0}}\n$$\nwhere $m_s$, $q_s$, $n_{s0}$, and $T_{s0}$ are the mass, charge, equilibrium number density, and equilibrium temperature for species $s$. The terms $\\mathbf{v}_{s1}$, $\\mathbf{E}_1$, and $p_{s1}$ represent the first-order perturbed fluid velocity, electric field, and pressure, respectively. The background magnetic field is uniform and directed along the $\\hat{\\mathbf{z}}$ axis, $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$.\n\nThe pressure perturbation is related to the density perturbation $n_{s1}$ through the adiabatic law of state, $p_{s1}/p_{s0} = \\gamma_s n_{s1}/n_{s0}$. With $p_{s0} = n_{s0} T_{s0}$ (temperature in energy units, joules), this gives $p_{s1} = \\gamma_s T_{s0} n_{s1}$. The pressure gradient force in Fourier space is $-i\\mathbf{k}p_{s1}$.\n\nThe linearized continuity equation relates the density and velocity perturbations:\n$$\n-i\\omega n_{s1} + i\\mathbf{k} \\cdot (n_{s0}\\mathbf{v}_{s1}) = 0 \\implies n_{s1} = n_{s0} \\frac{\\mathbf{k} \\cdot \\mathbf{v}_{s1}}{\\omega}\n$$\nThe problem specifies propagation parallel to the magnetic field, so $\\mathbf{k} = k_z \\hat{\\mathbf{z}}$. This has a crucial consequence: the density perturbation is coupled only to the parallel component of the velocity, $n_{s1} = n_{s0} \\frac{k_z v_{sz1}}{\\omega}$. The pressure gradient force thus becomes:\n$$\n-i\\mathbf{k}p_{s1} = -i k_z \\hat{\\mathbf{z}} (\\gamma_s T_{s0} n_{s1}) = -i \\hat{\\mathbf{z}} \\frac{k_z^2 \\gamma_s T_{s0} n_{s0}}{\\omega} v_{sz1}\n$$\nSubstituting this into the momentum equation (and dividing by $n_{s0}$ for the per-particle force) yields:\n$$\n-i\\omega m_s \\mathbf{v}_{s1} = q_s (\\mathbf{E}_1 + \\mathbf{v}_{s1} \\times B_0 \\hat{\\mathbf{z}}) - i \\hat{\\mathbf{z}} \\frac{m_s k_z^2 c_s^2}{\\omega} v_{sz1}\n$$\nwhere we have defined the species thermal speed (specifically, the adiabatic sound speed) squared as $c_s^2 = \\gamma_s T_{s0} / m_s$.\n\nThe Lorentz force term is $\\mathbf{v}_{s1} \\times B_0 \\hat{\\mathbf{z}} = B_0(v_{sy1}\\hat{\\mathbf{x}} - v_{sx1}\\hat{\\mathbf{y}})$. We can now write the momentum equation in its three Cartesian components:\n\\begin{align*}\n-i\\omega m_s v_{sx1} = q_s E_{x1} + q_s B_0 v_{sy1} \\\\\n-i\\omega m_s v_{sy1} = q_s E_{y1} - q_s B_0 v_{sx1} \\\\\n-i\\omega m_s v_{sz1} = q_s E_{z1} - i \\frac{m_s k_z^2 c_s^2}{\\omega} v_{sz1}\n\\end{align*}\nAs stipulated in the problem, the transverse dynamics (in $x$ and $y$) are decoupled from the longitudinal dynamics (in $z$) and from the thermal effects. The transverse equations are identical to those of a cold plasma. Let us define the species cyclotron frequency as $\\Omega_s = q_s B_0 / m_s$. The equations can be rearranged to solve for the velocity components $\\mathbf{v}_{s1}$ in terms of the electric field $\\mathbf{E}_1$.\n\nFor the transverse components:\n$$\n\\begin{pmatrix} -i\\omega  -\\Omega_s \\\\ \\Omega_s  -i\\omega \\end{pmatrix} \\begin{pmatrix} v_{sx1} \\\\ v_{sy1} \\end{pmatrix} = \\frac{q_s}{m_s} \\begin{pmatrix} E_{x1} \\\\ E_{y1} \\end{pmatrix}\n$$\nInverting the matrix yields:\n\\begin{align*}\nv_{sx1} = \\frac{q_s/m_s}{\\Omega_s^2 - \\omega^2} (-i\\omega E_{x1} + \\Omega_s E_{y1}) \\\\\nv_{sy1} = \\frac{q_s/m_s}{\\Omega_s^2 - \\omega^2} (-\\Omega_s E_{x1} - i\\omega E_{y1})\n\\end{align*}\n\nFor the longitudinal component:\n$$\n\\left(-i\\omega m_s + i \\frac{m_s k_z^2 c_s^2}{\\omega}\\right) v_{sz1} = q_s E_{z1} \\implies v_{sz1} = \\frac{q_s E_{z1}}{-im_s(\\omega - k_z^2 c_s^2/\\omega)} = i\\frac{q_s}{m_s} \\frac{\\omega}{\\omega^2 - k_z^2 c_s^2} E_{z1}\n$$\n\nThe perturbed current density for species $s$ is $\\mathbf{J}_{s1} = n_{s0} q_s \\mathbf{v}_{s1}$. The species electrical susceptibility tensor $\\boldsymbol{\\chi}_s$ is defined by the relation $\\mathbf{J}_{s1} = -i\\omega\\epsilon_0 \\boldsymbol{\\chi}_s \\mathbf{E}_1$. Combining these gives $\\boldsymbol{\\chi}_s \\mathbf{E}_1 = \\frac{i n_{s0} q_s}{\\omega \\epsilon_0} \\mathbf{v}_{s1}$. We can now find the components of $\\boldsymbol{\\chi}_s$.\n\nDefining the species plasma frequency squared as $\\omega_{ps}^2 = n_{s0} q_s^2 / (\\epsilon_0 m_s)$:\n$$\n(\\chi_s)_{xx} = (\\chi_s)_{yy} = \\frac{i n_{s0} q_s}{\\omega \\epsilon_0} \\frac{q_s}{m_s} \\frac{-i\\omega}{\\Omega_s^2 - \\omega^2} = -\\frac{n_{s0} q_s^2}{\\epsilon_0 m_s (\\omega^2 - \\Omega_s^2)} = -\\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}\n$$\n$$\n(\\chi_s)_{xy} = -(\\chi_s)_{yx} = \\frac{i n_{s0} q_s}{\\omega \\epsilon_0} \\frac{q_s}{m_s} \\frac{\\Omega_s}{\\Omega_s^2 - \\omega^2} = -i \\frac{\\omega_{ps}^2 \\Omega_s}{\\omega(\\omega^2 - \\Omega_s^2)}\n$$\n$$\n(\\chi_s)_{zz} = \\frac{i n_{s0} q_s}{\\omega \\epsilon_0} \\frac{i q_s}{m_s} \\frac{\\omega}{\\omega^2 - k_z^2 c_s^2} = -\\frac{\\omega_{ps}^2}{\\omega^2 - k_z^2 c_s^2}\n$$\n\nThe total dielectric tensor is given by $\\boldsymbol{\\epsilon} = \\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s$, where $\\mathbf{I}$ is the identity matrix representing the vacuum contribution. The components of $\\boldsymbol{\\epsilon}$ are:\n\\begin{align*}\n\\epsilon_{xx} = 1 + \\sum_s (\\chi_s)_{xx} = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2} \\\\\n\\epsilon_{xy} = \\sum_s (\\chi_s)_{xy} = -i \\sum_s \\frac{\\omega_{ps}^2 \\Omega_s}{\\omega(\\omega^2 - \\Omega_s^2)} \\\\\n\\epsilon_{zz} = 1 + \\sum_s (\\chi_s)_{zz} = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - k_z^2 c_s^2}\n\\end{align*}\nThe problem defines a scalar $D$ such that $\\epsilon_{xy} = -iD$. Therefore, $D = \\sum_s D^{(s)}$ where $D^{(s)} = \\frac{\\omega_{ps}^2 \\Omega_s}{\\omega(\\omega^2 - \\Omega_s^2)}$. The species-specific additive contributions to the dielectric tensor components, which we denote as $\\Delta\\epsilon^{(s)}$, are simply the components of $\\boldsymbol{\\chi}_s$:\n\\begin{align*}\n\\Delta\\epsilon_{xx}^{(s)} = (\\chi_s)_{xx} = -\\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2} \\\\\nD^{(s)} = \\frac{\\omega_{ps}^2 \\Omega_s}{\\omega(\\omega^2 - \\Omega_s^2)} \\\\\n\\Delta\\epsilon_{zz}^{(s)} = (\\chi_s)_{zz} = -\\frac{\\omega_{ps}^2}{\\omega^2 - k_z^2 c_s^2}\n\\end{align*}\n\nThe program will implement these formulas for the three specified species (electrons, deuterium, lithium) and the given test cases.\n\nThe total components to be computed are:\n\\begin{align*}\n\\epsilon_{xx} = 1 + \\Delta\\epsilon_{xx}^{(e)} + \\Delta\\epsilon_{xx}^{(1)} + \\Delta\\epsilon_{xx}^{(2)} \\\\\nD = D^{(e)} + D^{(1)} + D^{(2)} \\\\\n\\epsilon_{zz} = 1 + \\Delta\\epsilon_{zz}^{(e)} + \\Delta\\epsilon_{zz}^{(1)} + \\Delta\\epsilon_{zz}^{(2)}\n\\end{align*}\nAll necessary physical constants and parameters are provided, and quasi-neutrality ($n_e = \\sum_i Z_i n_i$) is used to determine the electron density. These relations are implemented in the following code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom collections import namedtuple\n\n# Define a recursive function to format lists without spaces\ndef list_to_string_no_spaces(l):\n    if not isinstance(l, list):\n        # Format floats with sufficient precision, avoid scientific notation for smaller numbers\n        if isinstance(l, float):\n            return f\"{l:.10g}\"\n        return str(l)\n    return f\"[{','.join(map(list_to_string_no_spaces, l))}]\"\n\ndef solve():\n    \"\"\"\n    Computes the components of the warm plasma dielectric tensor for parallel\n    propagation in a multi-species plasma.\n    \"\"\"\n    # Physical Constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    EPS_0 = 8.8541878128e-12    # Vacuum permittivity in F/m\n    M_E = 9.1093837015e-31      # Electron mass in kg\n    AMU = 1.66053906660e-27     # Atomic mass unit in kg\n\n    # Background plasma parameters\n    B0 = 3.0  # Background magnetic field in Tesla\n    \n    # Species Data Structure\n    Species = namedtuple('Species', ['Z', 'm', 'n', 'T_eV', 'gamma'])\n\n    # Define the species in the plasma\n    ion1_D = Species(Z=1, m=2.0 * AMU, n=3.0e19, T_eV=1000.0, gamma=5.0/3.0)\n    ion2_Li = Species(Z=3, m=7.0 * AMU, n=1.0e19, T_eV=500.0, gamma=5.0/3.0)\n    \n    # Enforce quasi-neutrality to find electron density\n    n_e = ion1_D.Z * ion1_D.n + ion2_Li.Z * ion2_Li.n\n    electron = Species(Z=-1, m=M_E, n=n_e, T_eV=2000.0, gamma=5.0/3.0)\n    \n    all_species = [electron, ion1_D, ion2_Li]\n\n    # Test suite of (omega, k_z) values\n    test_cases = [\n        (1.0e9, 10.0),    # Case A\n        (5.0e11, 1.0),     # Case B\n        (8.0e9, 95.0),    # Case C\n    ]\n\n    all_results = []\n\n    for omega, kz in test_cases:\n        \n        species_contributions = []\n        \n        for sp in all_species:\n            # Convert temperature from eV to Joules\n            T_J = sp.T_eV * E_CHARGE\n            \n            # Species charge\n            q_s = sp.Z * E_CHARGE\n            \n            # Calculate characteristic frequencies and speeds\n            # Squared plasma frequency\n            omega_ps_sq = (sp.n * q_s**2) / (EPS_0 * sp.m)\n            \n            # Cyclotron frequency (sign matters)\n            Omega_s = (q_s * B0) / sp.m\n            \n            # Squared adiabatic sound speed\n            c_s_sq = sp.gamma * T_J / sp.m\n\n            # Calculate denominators for the susceptibility terms\n            denom_cyc = omega**2 - Omega_s**2\n            denom_th = omega**2 - kz**2 * c_s_sq\n            \n            # Check for division by zero (resonances), though test cases avoid this.\n            if denom_cyc == 0 or denom_th == 0:\n                # In a real scenario, handle this with damping or principal value\n                # For this problem, we assume non-resonant cases.\n                delta_eps_xx = np.inf\n                D_s = np.inf\n                delta_eps_zz = np.inf\n            else:\n                # Additive contribution to epsilon_xx\n                delta_eps_xx = -omega_ps_sq / denom_cyc\n                \n                # Additive contribution to D (from epsilon_xy = -i*D)\n                D_s = (omega_ps_sq * Omega_s) / (omega * denom_cyc)\n                \n                # Additive contribution to epsilon_zz\n                delta_eps_zz = -omega_ps_sq / denom_th\n\n            species_contributions.append([delta_eps_xx, D_s, delta_eps_zz])\n\n        # Unpack species contributions\n        e_contrib = species_contributions[0]\n        ion1_contrib = species_contributions[1]\n        ion2_contrib = species_contributions[2]\n\n        # Calculate total dielectric tensor components\n        # Epsilon_xx = 1 + sum(chi_xx)\n        total_eps_xx = 1.0 + e_contrib[0] + ion1_contrib[0] + ion2_contrib[0]\n        \n        # D = sum(D_s)\n        total_D = e_contrib[1] + ion1_contrib[1] + ion2_contrib[1]\n        \n        # Epsilon_zz = 1 + sum(chi_zz)\n        total_eps_zz = 1.0 + e_contrib[2] + ion1_contrib[2] + ion2_contrib[2]\n        \n        case_result = [\n            [total_eps_xx, total_D, total_eps_zz],\n            e_contrib,\n            ion1_contrib,\n            ion2_contrib\n        ]\n        all_results.append(case_result)\n\n    # Print the final result in the strictly specified format (no spaces)\n    print(list_to_string_no_spaces(all_results))\n\nsolve()\n```"
        },
        {
            "introduction": "For a more complete description that captures wave-particle resonances and finite Larmor radius (FLR) effects, we must move from fluid models to a kinetic description based on the Vlasov equation. This advanced practice involves implementing the hot-plasma dielectric tensor for perpendicular propagation, which is expressed as a sum over cyclotron harmonics . The exercise focuses on numerically verifying the fundamental reciprocity symmetry, $\\epsilon_{ij}(\\mathbf{B}_0)=\\epsilon_{ji}(-\\mathbf{B}_0)$, and identifying the numerical pitfalls that can lead to its apparent violation in computational models.",
            "id": "4064047",
            "problem": "A program is required to assess the reciprocity symmetry of a warm, magnetized plasma dielectric tensor by comparing whether $\\,\\epsilon_{ij}(\\mathbf{B}_0)=\\epsilon_{ji}(-\\mathbf{B}_0)\\,$ holds for a finite Larmor radius kinetic model in perpendicular propagation. The underlying physical system is a homogeneous, collisionless, isotropic Maxwellian plasma. The magnetic field is uniform and static, $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$. The wave vector is perpendicular to $\\mathbf{B}_0$, $\\mathbf{k} = k_\\perp \\hat{\\mathbf{x}}$, so $k_\\parallel = 0$. The frequency $\\omega$ is real and the current is obtained from the linearized Vlasov–Maxwell system. The dielectric tensor $\\epsilon_{ij}$ relates the displacement field $\\mathbf{D}$ to the electric field $\\mathbf{E}$ through $\\mathbf{D} = \\epsilon_0 \\epsilon \\mathbf{E}$, where $\\epsilon$ includes species susceptibilities.\n\nStart from the linearized Vlasov equation for species $s$ with charge $q_s$, mass $m_s$, and equilibrium Maxwellian distribution, and the Maxwell equations in the absence of collisions. Use the magnetized kinetic response for perpendicular propagation to obtain the dielectric tensor elements in terms of cyclotron harmonics $n \\in \\mathbb{Z}$. The finite Larmor radius (FLR) enters through the parameter $\\,b_s = k_\\perp^2 \\frac{k_B T_s}{m_s \\Omega_s^2}\\,$, where $\\,\\Omega_s = \\frac{q_s B_0}{m_s}\\,$ is the cyclotron frequency, $\\,k_B\\,$ is Boltzmann’s constant, and $\\,T_s\\,$ is the species temperature. The harmonic content is represented via the modified Bessel functions of the first kind $\\,I_n(b_s)\\,$ and the factors $\\,\\Gamma_n(b_s) = I_n(b_s)\\,e^{-b_s}\\,$, and their derivative with respect to $b_s$, $\\,\\Gamma_n'(b_s) = \\frac{d}{d b_s}\\Gamma_n(b_s)\\,$. The plasma frequency is $\\,\\omega_{ps}^2 = \\frac{n_s q_s^2}{\\epsilon_0 m_s}\\,$, where $n_s$ is the species density. For perpendicular propagation, the longitudinal component $\\,\\epsilon_{zz}\\,$ reduces to the cold-plasma form and off-diagonal $z$-couplings vanish.\n\nYour task is to:\n- Derive, then implement in code, the warm-plasma dielectric tensor $\\,\\epsilon(\\mathbf{B}_0)\\,$ for perpendicular propagation using the magnetized Maxwellian susceptibility obtained from the linearized Vlasov–Maxwell system. Use a truncated harmonic sum over $\\,n\\,$ with symmetric bounds $\\,n=-N,\\ldots,+N\\,$ and evaluate $\\,\\Gamma_n(b_s)\\,$ and $\\,\\Gamma_n'(b_s)\\,$ robustly. Do not assume any pre-given formula beyond the fundamental laws and definitions stated; the derivation must be principled from these bases.\n- Numerically test the reciprocity symmetry $\\,\\epsilon_{ij}(\\mathbf{B}_0)=\\epsilon_{ji}(-\\mathbf{B}_0)\\,$ by computing the maximum absolute difference $\\,\\max_{i,j} \\left|\\epsilon_{ij}(\\mathbf{B}_0)-\\epsilon_{ji}(-\\mathbf{B}_0)\\right|\\,$ for each test case.\n- Identify and demonstrate numerical sources that may break or degrade this symmetry, such as harmonic truncation, near-resonant denominators $\\,(\\omega - n \\Omega_s)\\,$, and the numerical evaluation of derivatives $\\,\\Gamma_n'(b_s)\\,$.\n\nUse the following physical and numerical specifications:\n- Species: electrons ($\\,q_e=-e\\,$, $\\,m_e\\,$) and singly ionized deuterium ions ($\\,q_i=+e\\,$, $\\,m_i=2 m_p\\,$), with quasi-neutral densities $\\,n_e=n_i\\,$.\n- Units: use the Systeme International d’Unités (SI). Temperatures are given in electronvolts and must be converted to Joules via $\\,E = T_{\\mathrm{eV}} \\times e\\,$. Magnetic field in Tesla, wavenumber in $\\mathrm{m}^{-1}$, frequency in Hertz with angular frequency $\\,\\omega=2\\pi f\\,$.\n- Angle units: not applicable because propagation is purely perpendicular ($\\,k_\\parallel=0\\,$).\n- The final program must output the single line containing the list of floats for the reciprocity error $\\,\\max_{i,j} \\left|\\epsilon_{ij}(\\mathbf{B}_0)-\\epsilon_{ji}(-\\mathbf{B}_0)\\right|\\,$ for each test case, in the exact format $\\,\\left[\\text{result}_1,\\text{result}_2,\\ldots\\right]\\,$.\n\nImplement the dielectric tensor for perpendicular propagation as follows, based on the derived kinetic susceptibility:\n- Compute $\\,\\epsilon_{xx}\\,$, $\\,\\epsilon_{xy}\\,$, $\\,\\epsilon_{yx}\\,$, $\\,\\epsilon_{yy}\\,$ from the magnetized Maxwellian warm-plasma response with FLR.\n- Set $\\,\\epsilon_{zz} = 1 - \\sum_s \\omega_{ps}^2/\\omega^2\\,$ and $\\,\\epsilon_{xz}=\\epsilon_{zx}=\\epsilon_{yz}=\\epsilon_{zy}=0\\,$ for $\\,k_\\parallel=0\\,$.\n- Use symmetric harmonic summation $\\,n=-N,\\ldots,+N\\,$ unless specified otherwise in a test case to demonstrate a failure mode.\n\nTest suite. For each case, compute and return the single float $\\,\\max_{i,j} \\left|\\epsilon_{ij}(\\mathbf{B}_0)-\\epsilon_{ji}(-\\mathbf{B}_0)\\right|\\,$:\n- Case A (happy path, good symmetry): $\\,n_e = n_i = 1.0\\times 10^{19}\\,\\mathrm{m}^{-3}\\,$, $\\,T_e = 2000\\,\\mathrm{eV}\\,$, $\\,T_i = 1000\\,\\mathrm{eV}\\,$, $\\,B_0 = 3.0\\,\\mathrm{T}\\,$, $\\,k_\\perp = 5.0\\,\\mathrm{m}^{-1}\\,$, $\\,f = 60.0\\times 10^{6}\\,\\mathrm{Hz}\\,$, harmonic truncation $\\,N=50\\,$, derivative method analytic.\n- Case B (harmonic truncation stress): same as Case A but $\\,N=5\\,$, derivative method analytic.\n- Case C (near ion cyclotron resonance): same densities and temperatures, $\\,B_0 = 3.0\\,\\mathrm{T}\\,$, $\\,k_\\perp = 5.0\\,\\mathrm{m}^{-1}\\,$, $\\,f\\,$ set to $\\,f_i = \\Omega_i/(2\\pi)\\,$ with $\\,\\Omega_i = e B_0/m_i\\,$, harmonic truncation $\\,N=50\\,$, derivative method analytic.\n- Case D (large FLR parameter): same densities and temperatures, $\\,B_0 = 3.0\\,\\mathrm{T}\\,$, $\\,k_\\perp = 500.0\\,\\mathrm{m}^{-1}\\,$, $\\,f = 60.0\\times 10^{6}\\,\\mathrm{Hz}\\,$, $\\,N=100\\,$, derivative method analytic.\n- Case E (intentional asymmetry via non-symmetric harmonic summation to illustrate an implementation pitfall): same as Case A but sum only $\\,n=0,\\ldots,N\\,$ (omit negative harmonics), derivative method analytic.\n\nAll answers must be computed and expressed as dimensionless floats (no units in the output), and the final program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $\\,\\left[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D,\\text{result}_E\\right]\\,$.",
            "solution": "The problem statement is a valid and well-posed exercise in computational plasma physics. It asks for the derivation and numerical implementation of the warm plasma dielectric tensor for perpendicular propagation, followed by a numerical verification of the reciprocity symmetry relation $\\epsilon_{ij}(\\mathbf{B}_0)=\\epsilon_{ji}(-\\mathbf{B}_0)$. The physical model is a homogeneous, collisionless, magnetized Maxwellian plasma, which is a standard and scientifically grounded system. The provided parameters and test cases are physically realistic and designed to probe specific numerical and physical aspects of the model, such as harmonic truncation, cyclotron resonance, and large Larmor radius effects. The problem is self-contained and objective.\n\n### Theoretical Derivation of the Dielectric Tensor\n\nThe dielectric tensor $\\epsilon$ relates the displacement field $\\mathbf{D}$ to the electric field $\\mathbf{E}$ via $\\mathbf{D} = \\epsilon_0 \\epsilon \\cdot \\mathbf{E}$. In a plasma, it is determined by the plasma's response to the electric field, which generates a current density $\\mathbf{J}$. The relation is given by $\\epsilon = \\mathbf{I} + \\frac{i}{\\omega \\epsilon_0} \\sigma$, where $\\sigma$ is the conductivity tensor defined by $\\mathbf{J} = \\sigma \\cdot \\mathbf{E}$. The total current is the sum of contributions from all particle species $s$, $\\mathbf{J} = \\sum_s \\mathbf{J}_s$.\n\nWe begin with the linearized Vlasov equation for the perturbed distribution function $f_s^{(1)}$ of species $s$:\n$$\n\\frac{\\partial f_s^{(1)}}{\\partial t} + \\mathbf{v} \\cdot \\nabla f_s^{(1)} + \\frac{q_s}{m_s}(\\mathbf{v} \\times \\mathbf{B}_0) \\cdot \\nabla_{\\mathbf{v}} f_s^{(1)} = -\\frac{q_s}{m_s} \\mathbf{E}^{(1)} \\cdot \\nabla_{\\mathbf{v}} f_s^{(0)}\n$$\nwhere $f_s^{(0)}$ is the equilibrium distribution function, here a Maxwellian, and $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ is the uniform static magnetic field. We assume a plane wave perturbation of the form $e^{i(\\mathbf{k} \\cdot \\mathbf{r} - \\omega t)}$. For perpendicular propagation, $\\mathbf{k} = k_\\perp \\hat{\\mathbf{x}}$ ($k_\\parallel=0$).\n\nThe standard method of solving this equation is by integrating along the unperturbed particle trajectories (helical paths in the magnetic field). This yields $f_s^{(1)}$, from which the perturbed current density $\\mathbf{J}_s^{(1)} = q_s \\int \\mathbf{v} f_s^{(1)} d^3v$ is computed. This procedure establishes a linear relation between $\\mathbf{J}_s$ and $\\mathbf{E}$, defining the species conductivity $\\sigma_s$ and susceptibility $\\chi_s = \\frac{i}{\\omega \\epsilon_0} \\sigma_s$.\n\nFor a Maxwellian plasma, the derivation involves integrals over velocity space containing Bessel functions that arise from the expansion of the harmonic motion of particles. The result for the susceptibility tensor of a single species $s$ in the limit of perpendicular propagation ($k_\\parallel=0$) is an infinite sum over cyclotron harmonics $n$. The components of the susceptibility tensor $\\chi_s$ are given by:\n$$\n\\chi_{xx}^{(s)} = \\sum_{n=-\\infty}^{\\infty} \\frac{\\omega_{ps}^2}{\\omega} \\frac{1}{\\omega - n \\Omega_s} \\frac{n^2 \\Gamma_n(b_s)}{b_s}\n$$\n$$\n\\chi_{xy}^{(s)} = i \\sum_{n=-\\infty}^{\\infty} \\frac{\\omega_{ps}^2}{\\omega} \\frac{1}{\\omega - n \\Omega_s} n \\Gamma_n'(b_s)\n$$\n$$\n\\chi_{yx}^{(s)} = -i \\sum_{n=-\\infty}^{\\infty} \\frac{\\omega_{ps}^2}{\\omega} \\frac{1}{\\omega - n \\Omega_s} n \\Gamma_n'(b_s)\n$$\n$$\n\\chi_{yy}^{(s)} = \\sum_{n=-\\infty}^{\\infty} \\frac{\\omega_{ps}^2}{\\omega} \\frac{1}{\\omega - n \\Omega_s} \\left[ \\frac{n^2 \\Gamma_n(b_s)}{b_s} - 2b_s \\Gamma_n'(b_s) \\right]\n$$\nThe remaining components related to the $\\hat{\\mathbf{z}}$ direction are zero except for $\\chi_{zz}^{(s)}$, which simplifies in the $k_\\parallel=0$ limit:\n$$\n\\chi_{zz}^{(s)} = -\\frac{\\omega_{ps}^2}{\\omega^2}\n$$\nHere, $\\omega_{ps} = \\sqrt{n_s q_s^2 / (\\epsilon_0 m_s)}$ is the species plasma frequency, $\\Omega_s = q_s B_0 / m_s$ is the signed cyclotron frequency, $b_s = \\frac{k_\\perp^2 k_B T_s}{m_s \\Omega_s^2}$ is the finite Larmor radius (FLR) parameter. The functions $\\Gamma_n(b_s) = I_n(b_s) e^{-b_s}$ and $\\Gamma_n'(b_s) = \\frac{d}{db_s} \\Gamma_n(b_s)$ contain the modified Bessel function of the first kind, $I_n$. The total dielectric tensor is $\\epsilon = \\mathbf{I} + \\sum_s \\chi_s$.\n\n### Reciprocity Symmetry Analysis\n\nThe reciprocity relation to be tested is $\\epsilon_{ij}(\\mathbf{B}_0) = \\epsilon_{ji}(-\\mathbf{B}_0)$. The magnetic field $\\mathbf{B}_0$ enters the expressions only through the cyclotron frequency $\\Omega_s$. Reversing the magnetic field, $\\mathbf{B}_0 \\to -\\mathbf{B}_0$, implies $\\Omega_s \\to -\\Omega_s$. The FLR parameter $b_s$ depends on $\\Omega_s^2$, so it is invariant under the field reversal. Consequently, $\\Gamma_n(b_s)$ and $\\Gamma_n'(b_s)$ are also invariant.\n\nLet's verify the relation for the off-diagonal components $\\epsilon_{xy}$ and $\\epsilon_{yx}$.\n$$\n\\epsilon_{xy}(\\mathbf{B}_0) = i \\sum_s \\sum_n \\frac{\\omega_{ps}^2}{\\omega} \\frac{n \\Gamma_n'(b_s)}{\\omega - n\\Omega_s}\n$$\nNow we evaluate $\\epsilon_{yx}(-\\mathbf{B}_0)$:\n$$\n\\epsilon_{yx}(-\\mathbf{B}_0) = -i \\sum_s \\sum_n \\frac{\\omega_{ps}^2}{\\omega} \\frac{n \\Gamma_n'(b_s)}{\\omega - n(-\\Omega_s)} = -i \\sum_s \\sum_n \\frac{\\omega_{ps}^2}{\\omega} \\frac{n \\Gamma_n'(b_s)}{\\omega + n\\Omega_s}\n$$\nBy changing the summation index from $n$ to $n' = -n$, and using the identity $\\Gamma'_{-n'}(x) = \\Gamma'_{n'}(x)$ (which follows from $I_{-n'}(x)=I_{n'}(x)$), we get:\n$$\n\\epsilon_{yx}(-\\mathbf{B}_0) = -i \\sum_s \\sum_{n'} \\frac{\\omega_{ps}^2}{\\omega} \\frac{(-n') \\Gamma'_{-n'}(b_s)}{\\omega - n'\\Omega_s} = i \\sum_s \\sum_{n'} \\frac{\\omega_{ps}^2}{\\omega} \\frac{n' \\Gamma'_{n'}(b_s)}{\\omega - n'\\Omega_s} = \\epsilon_{xy}(\\mathbf{B}_0)\n$$\nThis confirms $\\epsilon_{xy}(\\mathbf{B}_0) = \\epsilon_{yx}(-\\mathbf{B}_0)$. A similar procedure confirms the relations for all other components. This analytical proof relies on the summation being over a symmetric range (e.g., $-\\infty$ to $+\\infty$). Any finite symmetric truncation, $\\sum_{n=-N}^N$, preserves this property.\n\n### Numerical Implementation and Sources of Error\n\nThe implementation involves computing the tensor elements by truncating the infinite sum over harmonics to a finite symmetric range $[-N, N]$. Several factors can lead to numerical inaccuracies or apparent breakdown of symmetry:\n1.  **Harmonic Truncation ($N$)**: If $N$ is too small, the truncated sum is a poor approximation of the full series. This is especially true for large $b_s$, where energy is distributed over a wide range of harmonics. While a symmetric truncation preserves the reciprocity relation formally, the accumulated floating-point errors in an inaccurate sum might be larger.\n2.  **Asymmetric Summation**: If the summation range is not symmetric (e.g., $n=0, \\ldots, N$), the change of index trick $n \\to -n$ used in the proof fails. This is an implementation error that explicitly breaks the reciprocity symmetry, as will be demonstrated in Case E.\n3.  **Cyclotron Resonance**: When $\\omega \\approx n\\Omega_s$ for some harmonic $n$, the corresponding term in the sum diverges. In a physical system, damping mechanisms (e.g., collisions, or Landau damping for $k_\\parallel \\neq 0$) regularize this singularity. In our collisionless, $k_\\parallel=0$ model, this leads to a division by zero, resulting in `inf` or `NaN` values, as seen in Case C.\n4.  **Numerical Evaluation of Functions**: The term $\\Gamma_n(b_s) = I_n(b_s)e^{-b_s}$ involves the product of an exponentially growing function ($I_n$) and an exponentially decaying one ($e^{-b_s}$), which is numerically unstable for large $b_s$. A robust approach is to use specialized library functions that compute this product directly, such as `scipy.special.ive`. The derivative $\\Gamma_n'(b_s)$ is computed analytically using the recurrence relation for Bessel function derivatives, $I_n'(x) = \\frac{1}{2}(I_{n-1}(x) + I_{n+1}(x))$, which is also numerically stable when formulated with `ive`.\n\nThe following code implements the calculation and tests the symmetry relation under various conditions.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import ive\nfrom scipy.constants import e, m_e, m_p, epsilon_0, pi\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for warm plasma dielectric tensor reciprocity.\n    \"\"\"\n\n    # Physical Constants\n    # Deuterium mass is specified as 2 * proton mass\n    m_i_val = 2.0 * m_p\n    q_e_val = -e\n    q_i_val = e\n\n    species_defs = {\n        'e': {'q': q_e_val, 'm': m_e},\n        'i': {'q': q_i_val, 'm': m_i_val}\n    }\n    \n    # Test cases as defined in the problem statement\n    test_cases = [\n        # Case A: Happy path\n        {'name': 'A', 'ne': 1.0e19, 'Te': 2000.0, 'Ti': 1000.0, 'B0': 3.0, 'k_perp': 5.0, 'f': 60.0e6, 'N': 50, 'sum_type': 'symmetric'},\n        # Case B: Harmonic truncation stress\n        {'name': 'B', 'ne': 1.0e19, 'Te': 2000.0, 'Ti': 1000.0, 'B0': 3.0, 'k_perp': 5.0, 'f': 60.0e6, 'N': 5, 'sum_type': 'symmetric'},\n        # Case C: Near ion cyclotron resonance\n        {'name': 'C', 'ne': 1.0e19, 'Te': 2000.0, 'Ti': 1000.0, 'B0': 3.0, 'k_perp': 5.0, 'f': (q_i_val * 3.0 / m_i_val) / (2.0 * pi), 'N': 50, 'sum_type': 'symmetric'},\n        # Case D: Large FLR parameter\n        {'name': 'D', 'ne': 1.0e19, 'Te': 2000.0, 'Ti': 1000.0, 'B0': 3.0, 'k_perp': 500.0, 'f': 60.0e6, 'N': 100, 'sum_type': 'symmetric'},\n        # Case E: Intentional asymmetry via non-symmetric harmonic summation\n        {'name': 'E', 'ne': 1.0e19, 'Te': 2000.0, 'Ti': 1000.0, 'B0': 3.0, 'k_perp': 5.0, 'f': 60.0e6, 'N': 50, 'sum_type': 'asymmetric'},\n    ]\n\n    results = []\n    for case in test_cases:\n        error = compute_reciprocity_error(case, species_defs)\n        results.append(error)\n\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\ndef calculate_dielectric_tensor(params, species_defs, b0_sign):\n    \"\"\"\n    Computes the warm plasma dielectric tensor for perpendicular propagation.\n    \"\"\"\n    n_e = params['ne']\n    n_i = n_e  # Quasi-neutrality\n    T_e_eV = params['Te']\n    T_i_eV = params['Ti']\n    B0 = params['B0']\n    k_perp = params['k_perp']\n    omega = 2.0 * np.pi * params['f']\n    N = params['N']\n\n    plasma_defs = {\n        'e': {'n': n_e, 'T_eV': T_e_eV},\n        'i': {'n': n_i, 'T_eV': T_i_eV}\n    }\n    \n    if params['sum_type'] == 'symmetric':\n        n_range = range(-N, N + 1)\n    else: # asymmetric\n        n_range = range(0, N + 1)\n        \n    epsilon = np.identity(3, dtype=np.complex128)\n    total_wp_sq = 0.0\n\n    for s_name, s_props in species_defs.items():\n        q_s = s_props['q']\n        m_s = s_props['m']\n        n_s = plasma_defs[s_name]['n']\n        T_s_J = plasma_defs[s_name]['T_eV'] * e\n\n        wp_sq = n_s * q_s**2 / (epsilon_0 * m_s)\n        Omega_s = q_s * B0 * b0_sign / m_s\n        \n        total_wp_sq += wp_sq\n\n        # Handle Omega_s = 0 case\n        if Omega_s == 0:\n            continue\n            \n        v_th_sq = T_s_J / m_s\n        b_s = k_perp**2 * v_th_sq / Omega_s**2\n        \n        chi_s = np.zeros((3, 3), dtype=np.complex128)\n\n        for n in n_range:\n            #Denominator\n            denominator = omega - n * Omega_s\n            if np.isclose(denominator, 0.0):\n                # At resonance, terms diverge\n                term_coeff = np.inf\n            else:\n                term_coeff = wp_sq / (omega * denominator)\n\n            # Modified Bessel functions and their derivatives\n            # Using ive for numerical stability: ive(n,x) = iv(n,x) * exp(-abs(x))\n            # Gamma_n(b) = I_n(b) * exp(-b) - ive(n, b) for b  0\n            # Gamma_n'(b) = (I_n'(b) - I_n(b)) * exp(-b)\n            #           = (0.5*(I_{n-1}(b)+I_{n+1}(b)) - I_n(b)) * exp(-b)\n            #           = 0.5*(ive(n-1,b)+ive(n+1,b)) - ive(n,b)\n            gamma_n = ive(n, b_s)\n            gamma_n_prime = 0.5 * (ive(n - 1, b_s) + ive(n + 1, b_s)) - gamma_n\n\n            # Susceptibility contributions from harmonic n\n            if b_s > 0: # Avoid division by zero if k_perp or T is zero\n                chi_s[0, 0] += term_coeff * n**2 * gamma_n / b_s\n                chi_s[1, 1] += term_coeff * (n**2 * gamma_n / b_s - 2 * b_s * gamma_n_prime)\n            \n            chi_s[0, 1] += term_coeff * 1j * n * gamma_n_prime\n            chi_s[1, 0] -= term_coeff * 1j * n * gamma_n_prime\n\n        epsilon[:2, :2] += chi_s[:2, :2]\n\n    # Epsilon_zz component (cold plasma form for k_perp=0)\n    if omega != 0:\n        epsilon[2, 2] = 1.0 - total_wp_sq / omega**2\n    else:\n        epsilon[2, 2] = np.inf\n\n    return epsilon\n\ndef compute_reciprocity_error(case_params, species_defs):\n    \"\"\"\n    Computes the reciprocity error for a single test case.\n    \"\"\"\n    # Calculate epsilon(B0)\n    eps_B0 = calculate_dielectric_tensor(case_params, species_defs, b0_sign=1.0)\n    \n    # Calculate epsilon(-B0)\n    eps_minus_B0 = calculate_dielectric_tensor(case_params, species_defs, b0_sign=-1.0)\n\n    # Calculate difference matrix: eps_ij(B0) - eps_ji(-B0)\n    diff_matrix = eps_B0 - eps_minus_B0.T\n    \n    # The metric is the maximum absolute difference\n    error = np.nanmax(np.abs(diff_matrix))\n    return error\n\nsolve()\n\n```"
        }
    ]
}