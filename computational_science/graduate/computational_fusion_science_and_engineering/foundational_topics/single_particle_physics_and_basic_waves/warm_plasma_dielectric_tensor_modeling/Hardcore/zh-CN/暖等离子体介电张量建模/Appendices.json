{
    "hands_on_practices": [
        {
            "introduction": "本实践将引导您从基本的多流体方程出发，为包含多种离子成分的暖等离子体构建介电张量。通过这个练习，您将掌握如何将不同粒子种类的贡献相加，并理解在平行传播的特定情况下，热压力效应如何选择性地影响纵向（平行于磁场）的等离子体响应。这是一个基础练习，旨在巩固您对等离子体波动理论中流体模型的理解。",
            "id": "4064010",
            "problem": "考虑一个均匀、无碰撞、磁化的多组分等离子体，其背景磁场 $\\mathbf{B}_0$ 沿 $\\hat{\\mathbf{z}}$ 方向均匀分布，以及一个平面波，其角频率为 $\\omega$，波矢 $\\mathbf{k}$ 平行于 $\\mathbf{B}_0$（因此 $\\mathbf{k}=k_z\\hat{\\mathbf{z}}$）。该等离子体包含电子和两种具有不同电荷数 $Z$ 和质量 $m$ 的不同离子组分。任务是在双流体绝热假设下，构建此暖等离子体的总介电张量，并分析每个组分对张量分量 $\\epsilon_{xx}$、$\\epsilon_{xy}$ 和 $\\epsilon_{zz}$ 的贡献。\n\n从频散域中的线性化双流体方程（采用绝热压力闭合）和麦克斯韦方程组开始。使用连续性方程、包含洛伦兹力和压力梯度项的动量方程以及电流密度定义，将各组分的速度扰动与电场联系起来。为每个组分 $s$ 假设一个绝热指数 $\\gamma_s$，并定义一个与绝热闭合一致的特定于组分的声速 $c_s$。在 $\\mathbf{k}\\parallel\\mathbf{B}_0$ 的特殊几何构型下，推导热压力如何仅改变纵向（$\\hat{\\mathbf{z}}$）响应，而横向（$\\hat{\\mathbf{x}}、\\hat{\\mathbf{y}}$）回旋动力学保持冷等离子体形式。据此，构建各组分的极化率并组合成总介电张量 $\\boldsymbol{\\epsilon}$。\n\n您必须实现一个程序，为每个测试用例计算总的无量纲介电分量 $\\epsilon_{xx}$、标量 $D$（使得 $\\epsilon_{xy}=-\\mathrm{i}D$）和 $\\epsilon_{zz}$，以及每个组分对这些分量的加性贡献。该程序不得接受任何输入，并且必须使用下面指定的测试套件。所有物理计算必须使用国际单位制 (SI)，并遵循以下常数和约定：\n- 元电荷 $e=1.602176634\\times 10^{-19}~\\mathrm{C}$，\n- 真空介电常数 $\\epsilon_0=8.8541878128\\times 10^{-12}~\\mathrm{F/m}$，\n- 电子质量 $m_e=9.1093837015\\times 10^{-31}~\\mathrm{kg}$，\n- 原子质量单位 $1~\\mathrm{amu}=1.66053906660\\times 10^{-27}~\\mathrm{kg}$。\n温度以电子伏特为单位提供，必须通过 $T~[\\mathrm{J}]=T~[\\mathrm{eV}]\\times e$ 转换为焦耳。对于绝热指数，所有组分均使用 $\\gamma_s=5/3$。电子电荷使用 $q_e=-e$，离子电荷使用 $q_i=Z_ie$。将组分 $s$ 的等离子体频率定义为 $\\omega_{ps}^2=n_s q_s^2/(\\epsilon_0 m_s)$，回旋频率定义为 $\\Omega_s=q_s B_0/m_s$。\n\n所有测试用例的组分和背景参数：\n- 背景磁场 $B_0=3.0~\\mathrm{T}$。\n- 电子：数密度 $n_e$ 由准中性条件设定，电荷 $q_e=-e$，质量 $m_e$ 如上，温度 $T_e=2000~\\mathrm{eV}$，绝热指数 $\\gamma_e=5/3$。\n- 离子组分 1 (氘)：电荷数 $Z_1=1$，质量 $m_1=2~\\mathrm{amu}$，数密度 $n_1=3.0\\times 10^{19}~\\mathrm{m}^{-3}$，温度 $T_1=1000~\\mathrm{eV}$，绝热指数 $\\gamma_1=5/3$。\n- 离子组分 2 (锂)：电荷数 $Z_2=3$，质量 $m_2=7~\\mathrm{amu}$，数密度 $n_2=1.0\\times 10^{19}~\\mathrm{m}^{-3}$，温度 $T_2=500~\\mathrm{eV}$，绝热指数 $\\gamma_2=5/3$。\n- 强制执行准中性条件 $n_e=Z_1 n_1+Z_2 n_2$。\n\n$(\\omega,k_z)$ 值的测试套件，其中 $\\omega$ 的单位是 $\\mathrm{rad/s}$，$k_z$ 的单位是 $\\mathrm{m}^{-1}$：\n1. 情况 A (通用频率，中等热效应): $\\omega=1.0\\times 10^{9}~\\mathrm{rad/s}$, $k_z=10~\\mathrm{m}^{-1}$。\n2. 情况 B (靠近电子回旋的高频，类冷等离子体横向响应): $\\omega=5.0\\times 10^{11}~\\mathrm{rad/s}$, $k_z=1~\\mathrm{m}^{-1}$。\n3. 情况 C (强纵向热效应，靠近电子的压缩共振): $\\omega=8.0\\times 10^{9}~\\mathrm{rad/s}$, $k_z=95~\\mathrm{m}^{-1}$。\n\n您的程序必须为每个测试用例计算以下浮点数列表：\n- 总分量 $[\\epsilon_{xx},D,\\epsilon_{zz}]$，\n- 电子的加性贡献 $[\\Delta\\epsilon_{xx}^{(e)},D^{(e)},\\Delta\\epsilon_{zz}^{(e)}]$，\n- 离子组分 1 的加性贡献 $[\\Delta\\epsilon_{xx}^{(1)},D^{(1)},\\Delta\\epsilon_{zz}^{(1)}]$，\n- 离子组分 2 的加性贡献 $[\\Delta\\epsilon_{xx}^{(2)},D^{(2)},\\Delta\\epsilon_{zz}^{(2)}]$。\n\n最终输出必须是单行文本，包含所有三个测试用例的上述四列表结构，连接成一个列表，不含空格，例如：\n$[\\,[\\,[\\epsilon_{xx},D,\\epsilon_{zz}],[\\Delta\\epsilon_{xx}^{(e)},D^{(e)},\\Delta\\epsilon_{zz}^{(e)}],[\\Delta\\epsilon_{xx}^{(1)},D^{(1)},\\Delta\\epsilon_{zz}^{(1)}],[\\Delta\\epsilon_{xx}^{(2)},D^{(2)},\\Delta\\epsilon_{zz}^{(2)}]\\,],\\ldots\\,]$。\n所有返回值都是无量纲浮点数。由于规定了 $\\mathbf{k}\\parallel\\mathbf{B}_0$，因此不使用角度单位。程序不得读取任何输入，且必须能直接运行。\n\n覆盖性设计：\n- 情况 A 测试了聚变相关参数下的典型暖等离子体状态。\n- 情况 B 探测了靠近电子回旋频率的情况，强调了横向回旋贡献。\n- 情况 C 检验了强纵向热效应以及通过 $k_z^2 c_e^2$ 相对于 $\\omega^2$ 的关系所体现的电子可压缩性的作用。\n\n最终输出格式必须是单行文本，包含用方括号括起来的逗号分隔列表形式的结果，严格按照上述规定，不含任何空格。",
            "solution": "用户提供的问题是有效的。它在科学上基于等离子体物理学的既定原理，特别是用于描述磁化等离子体中波传播的双流体模型。该问题定义清晰，所有必要的参数和物理定律都已给出，从而可以得到唯一且有意义的解。它是客观的，并使用了精确的术语。所提供的条件和参数对于聚变等离子体环境是物理上现实的。因此，有必要提供完整的解决方案。\n\n构建暖等离子体介电张量的理论基础始于等离子体中每个组分 $s$ 的线性化双流体方程。对于一个与 $\\exp(i(\\mathbf{k} \\cdot \\mathbf{r} - \\omega t))$ 成正比的平面波扰动，我们的出发点是线性化的动量和连续性方程。\n\n组分 $s$ 的粒子的线性化动量方程为：\n$$\n-i\\omega m_s \\mathbf{v}_{s1} = q_s (\\mathbf{E}_1 + \\mathbf{v}_{s1} \\times \\mathbf{B}_0) - \\frac{\\nabla p_{s1}}{n_{s0}}\n$$\n其中 $m_s$、$q_s$、$n_{s0}$ 和 $T_{s0}$ 分别是组分 $s$ 的质量、电荷、平衡数密度和平衡温度。项 $\\mathbf{v}_{s1}$、$\\mathbf{E}_1$ 和 $p_{s1}$ 分别表示一阶扰动的流体速度、电场和压力。背景磁场是均匀的，并沿 $\\hat{\\mathbf{z}}$ 轴方向，即 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$。\n\n压力扰动通过绝热状态定律 $p_{s1}/p_{s0} = \\gamma_s n_{s1}/n_{s0}$ 与密度扰动 $n_{s1}$ 相关。由于 $p_{s0} = n_{s0} T_{s0}$（温度以能量单位焦耳计），这得到 $p_{s1} = \\gamma_s T_{s0} n_{s1}$。傅里叶空间中的压力梯度力为 $-i\\mathbf{k}p_{s1}$。\n\n线性化连续性方程将密度和速度扰动联系起来：\n$$\n-i\\omega n_{s1} + i\\mathbf{k} \\cdot (n_{s0}\\mathbf{v}_{s1}) = 0 \\implies n_{s1} = n_{s0} \\frac{\\mathbf{k} \\cdot \\mathbf{v}_{s1}}{\\omega}\n$$\n问题指定传播方向平行于磁场，因此 $\\mathbf{k} = k_z \\hat{\\mathbf{z}}$。这带来一个关键后果：密度扰动仅与速度的平行分量耦合，$n_{s1} = n_{s0} \\frac{k_z v_{sz1}}{\\omega}$。因此，压力梯度力变为：\n$$\n-i\\mathbf{k}p_{s1} = -i k_z \\hat{\\mathbf{z}} (\\gamma_s T_{s0} n_{s1}) = -i \\hat{\\mathbf{z}} \\frac{k_z^2 \\gamma_s T_{s0} n_{s0}}{\\omega} v_{sz1}\n$$\n将此代入动量方程（并除以 $n_{s0}$ 以获得单位粒子受力）得到：\n$$\n-i\\omega m_s \\mathbf{v}_{s1} = q_s (\\mathbf{E}_1 + \\mathbf{v}_{s1} \\times B_0 \\hat{\\mathbf{z}}) - i \\hat{\\mathbf{z}} \\frac{m_s k_z^2 c_s^2}{\\omega} v_{sz1}\n$$\n其中我们已将组分热速度（具体为绝热声速）的平方定义为 $c_s^2 = \\gamma_s T_{s0} / m_s$。\n\n洛伦兹力项为 $\\mathbf{v}_{s1} \\times B_0 \\hat{\\mathbf{z}} = B_0(v_{sy1}\\hat{\\mathbf{x}} - v_{sx1}\\hat{\\mathbf{y}})$。我们现在可以将其三个笛卡尔分量的动量方程写出：\n\\begin{align*}\n-i\\omega m_s v_{sx1} = q_s E_{x1} + q_s B_0 v_{sy1} \\\\\n-i\\omega m_s v_{sy1} = q_s E_{y1} - q_s B_0 v_{sx1} \\\\\n-i\\omega m_s v_{sz1} = q_s E_{z1} - i \\frac{m_s k_z^2 c_s^2}{\\omega} v_{sz1}\n\\end{align*}\n正如问题所规定，横向动力学（在 $x$ 和 $y$ 方向）与纵向动力学（在 $z$ 方向）以及热效应解耦。横向方程与冷等离子体的方程相同。让我们将组分回旋频率定义为 $\\Omega_s = q_s B_0 / m_s$。可以重排这些方程，以电场 $\\mathbf{E}_1$ 为变量求解速度分量 $\\mathbf{v}_{s1}$。\n\n对于横向分量：\n$$\n\\begin{pmatrix} -i\\omega  -\\Omega_s \\\\ \\Omega_s  -i\\omega \\end{pmatrix} \\begin{pmatrix} v_{sx1} \\\\ v_{sy1} \\end{pmatrix} = \\frac{q_s}{m_s} \\begin{pmatrix} E_{x1} \\\\ E_{y1} \\end{pmatrix}\n$$\n对矩阵求逆可得：\n\\begin{align*}\nv_{sx1} = \\frac{q_s/m_s}{\\Omega_s^2 - \\omega^2} (-i\\omega E_{x1} + \\Omega_s E_{y1}) \\\\\nv_{sy1} = \\frac{q_s/m_s}{\\Omega_s^2 - \\omega^2} (-\\Omega_s E_{x1} - i\\omega E_{y1})\n\\end{align*}\n\n对于纵向分量：\n$$\n\\left(-i\\omega m_s + i \\frac{m_s k_z^2 c_s^2}{\\omega}\\right) v_{sz1} = q_s E_{z1} \\implies v_{sz1} = \\frac{q_s E_{z1}}{-im_s(\\omega - k_z^2 c_s^2/\\omega)} = i\\frac{q_s}{m_s} \\frac{\\omega}{\\omega^2 - k_z^2 c_s^2} E_{z1}\n$$\n\n组分 $s$ 的扰动电流密度为 $\\mathbf{J}_{s1} = n_{s0} q_s \\mathbf{v}_{s1}$。组分电极化率张量 $\\boldsymbol{\\chi}_s$ 由关系式 $\\mathbf{J}_{s1} = -i\\omega\\epsilon_0 \\boldsymbol{\\chi}_s \\mathbf{E}_1$ 定义。结合这些可得 $\\boldsymbol{\\chi}_s \\mathbf{E}_1 = \\frac{i n_{s0} q_s}{\\omega \\epsilon_0} \\mathbf{v}_{s1}$。我们现在可以求出 $\\boldsymbol{\\chi}_s$ 的分量。\n\n将组分等离子体频率的平方定义为 $\\omega_{ps}^2 = n_{s0} q_s^2 / (\\epsilon_0 m_s)$：\n$$\n(\\chi_s)_{xx} = (\\chi_s)_{yy} = \\frac{i n_{s0} q_s}{\\omega \\epsilon_0} \\frac{q_s}{m_s} \\frac{-i\\omega}{\\Omega_s^2 - \\omega^2} = -\\frac{n_{s0} q_s^2}{\\epsilon_0 m_s (\\omega^2 - \\Omega_s^2)} = -\\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}\n$$\n$$\n(\\chi_s)_{xy} = -(\\chi_s)_{yx} = \\frac{i n_{s0} q_s}{\\omega \\epsilon_0} \\frac{q_s}{m_s} \\frac{\\Omega_s}{\\Omega_s^2 - \\omega^2} = -i \\frac{\\omega_{ps}^2 \\Omega_s}{\\omega(\\omega^2 - \\Omega_s^2)}\n$$\n$$\n(\\chi_s)_{zz} = \\frac{i n_{s0} q_s}{\\omega \\epsilon_0} \\frac{i q_s}{m_s} \\frac{\\omega}{\\omega^2 - k_z^2 c_s^2} = -\\frac{\\omega_{ps}^2}{\\omega^2 - k_z^2 c_s^2}\n$$\n\n总介电张量由 $\\boldsymbol{\\epsilon} = \\mathbf{I} + \\sum_s \\boldsymbol{\\chi}_s$ 给出，其中 $\\mathbf{I}$ 是表示真空贡献的单位矩阵。$\\boldsymbol{\\epsilon}$ 的分量为：\n\\begin{align*}\n\\epsilon_{xx} = 1 + \\sum_s (\\chi_s)_{xx} = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2} \\\\\n\\epsilon_{xy} = \\sum_s (\\chi_s)_{xy} = -i \\sum_s \\frac{\\omega_{ps}^2 \\Omega_s}{\\omega(\\omega^2 - \\Omega_s^2)} \\\\\n\\epsilon_{zz} = 1 + \\sum_s (\\chi_s)_{zz} = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - k_z^2 c_s^2}\n\\end{align*}\n问题定义了一个标量 $D$，使得 $\\epsilon_{xy} = -iD$。因此，$D = \\sum_s D^{(s)}$，其中 $D^{(s)} = \\frac{\\omega_{ps}^2 \\Omega_s}{\\omega(\\omega^2 - \\Omega_s^2)}$。特定于组分的对介电张量分量的加性贡献，我们记作 $\\Delta\\epsilon^{(s)}$，就是 $\\boldsymbol{\\chi}_s$ 的分量：\n\\begin{align*}\n\\Delta\\epsilon_{xx}^{(s)} = (\\chi_s)_{xx} = -\\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2} \\\\\nD^{(s)} = \\frac{\\omega_{ps}^2 \\Omega_s}{\\omega(\\omega^2 - \\Omega_s^2)} \\\\\n\\Delta\\epsilon_{zz}^{(s)} = (\\chi_s)_{zz} = -\\frac{\\omega_{ps}^2}{\\omega^2 - k_z^2 c_s^2}\n\\end{align*}\n\n程序将为三种指定组分（电子、氘、锂）和给定的测试用例实现这些公式。\n\n需要计算的总分量是：\n\\begin{align*}\n\\epsilon_{xx} = 1 + \\Delta\\epsilon_{xx}^{(e)} + \\Delta\\epsilon_{xx}^{(1)} + \\Delta\\epsilon_{xx}^{(2)} \\\\\nD = D^{(e)} + D^{(1)} + D^{(2)} \\\\\n\\epsilon_{zz} = 1 + \\Delta\\epsilon_{zz}^{(e)} + \\Delta\\epsilon_{zz}^{(1)} + \\Delta\\epsilon_{zz}^{(2)}\n\\end{align*}\n所有必要的物理常数和参数都已提供，并使用准中性条件 ($n_e = \\sum_i Z_i n_i$) 来确定电子密度。这些关系在以下代码中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom collections import namedtuple\n\n# Define a recursive function to format lists without spaces\ndef list_to_string_no_spaces(l):\n    if not isinstance(l, list):\n        # Format floats with sufficient precision, avoid scientific notation for smaller numbers\n        if isinstance(l, float):\n            return f\"{l:.10g}\"\n        return str(l)\n    return f\"[{','.join(map(list_to_string_no_spaces, l))}]\"\n\ndef solve():\n    \"\"\"\n    Computes the components of the warm plasma dielectric tensor for parallel\n    propagation in a multi-species plasma.\n    \"\"\"\n    # Physical Constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    EPS_0 = 8.8541878128e-12    # Vacuum permittivity in F/m\n    M_E = 9.1093837015e-31      # Electron mass in kg\n    AMU = 1.66053906660e-27     # Atomic mass unit in kg\n\n    # Background plasma parameters\n    B0 = 3.0  # Background magnetic field in Tesla\n    \n    # Species Data Structure\n    Species = namedtuple('Species', ['Z', 'm', 'n', 'T_eV', 'gamma'])\n\n    # Define the species in the plasma\n    ion1_D = Species(Z=1, m=2.0 * AMU, n=3.0e19, T_eV=1000.0, gamma=5.0/3.0)\n    ion2_Li = Species(Z=3, m=7.0 * AMU, n=1.0e19, T_eV=500.0, gamma=5.0/3.0)\n    \n    # Enforce quasi-neutrality to find electron density\n    n_e = ion1_D.Z * ion1_D.n + ion2_Li.Z * ion2_Li.n\n    electron = Species(Z=-1, m=M_E, n=n_e, T_eV=2000.0, gamma=5.0/3.0)\n    \n    all_species = [electron, ion1_D, ion2_Li]\n\n    # Test suite of (omega, k_z) values\n    test_cases = [\n        (1.0e9, 10.0),    # Case A\n        (5.0e11, 1.0),     # Case B\n        (8.0e9, 95.0),    # Case C\n    ]\n\n    all_results = []\n\n    for omega, kz in test_cases:\n        \n        species_contributions = []\n        \n        for sp in all_species:\n            # Convert temperature from eV to Joules\n            T_J = sp.T_eV * E_CHARGE\n            \n            # Species charge\n            q_s = sp.Z * E_CHARGE\n            \n            # Calculate characteristic frequencies and speeds\n            # Squared plasma frequency\n            omega_ps_sq = (sp.n * q_s**2) / (EPS_0 * sp.m)\n            \n            # Cyclotron frequency (sign matters)\n            Omega_s = (q_s * B0) / sp.m\n            \n            # Squared adiabatic sound speed\n            c_s_sq = sp.gamma * T_J / sp.m\n\n            # Calculate denominators for the susceptibility terms\n            denom_cyc = omega**2 - Omega_s**2\n            denom_th = omega**2 - kz**2 * c_s_sq\n            \n            # Check for division by zero (resonances), though test cases avoid this.\n            if denom_cyc == 0 or denom_th == 0:\n                # In a real scenario, handle this with damping or principal value\n                # For this problem, we assume non-resonant cases.\n                delta_eps_xx = np.inf\n                D_s = np.inf\n                delta_eps_zz = np.inf\n            else:\n                # Additive contribution to epsilon_xx\n                delta_eps_xx = -omega_ps_sq / denom_cyc\n                \n                # Additive contribution to D (from epsilon_xy = -i*D)\n                D_s = (omega_ps_sq * Omega_s) / (omega * denom_cyc)\n                \n                # Additive contribution to epsilon_zz\n                delta_eps_zz = -omega_ps_sq / denom_th\n\n            species_contributions.append([delta_eps_xx, D_s, delta_eps_zz])\n\n        # Unpack species contributions\n        e_contrib = species_contributions[0]\n        ion1_contrib = species_contributions[1]\n        ion2_contrib = species_contributions[2]\n\n        # Calculate total dielectric tensor components\n        # Epsilon_xx = 1 + sum(chi_xx)\n        total_eps_xx = 1.0 + e_contrib[0] + ion1_contrib[0] + ion2_contrib[0]\n        \n        # D = sum(D_s)\n        total_D = e_contrib[1] + ion1_contrib[1] + ion2_contrib[1]\n        \n        # Epsilon_zz = 1 + sum(chi_zz)\n        total_eps_zz = 1.0 + e_contrib[2] + ion1_contrib[2] + ion2_contrib[2]\n        \n        case_result = [\n            [total_eps_xx, total_D, total_eps_zz],\n            e_contrib,\n            ion1_contrib,\n            ion2_contrib\n        ]\n        all_results.append(case_result)\n\n    # Print the final result in the strictly specified format (no spaces)\n    print(list_to_string_no_spaces(all_results))\n\nsolve()\n```"
        },
        {
            "introduction": "在流体模型的基础上，我们通过引入动力学效应来提升模型的精度。本实践聚焦于有限拉莫尔半径（FLR）效应，这是描述短波长下波与粒子相互作用的关键物理机制。您将通过编程比较一个精确的回旋平均模型（使用贝塞尔函数）和一个常见的低阶FLR近似，从而亲身体会近似模型的适用范围及其局限性，这对于在实际研究中选择合适的物理模型至关重要。",
            "id": "4064008",
            "problem": "考虑一个由电子和单一离子种类组成的均匀、磁化、各向同性、无碰撞的等离子体，两种粒子都由麦克斯韦速度分布描述。设磁场是均匀恒定的，大小为$B$，且存在一个平面波，其垂直波数为$k_{\\perp}$，角频率为$\\omega$。有限拉莫尔半径（FLR）效应通过对粒子响应进行回旋平均而进入温等离子体介电常数。在低频极化响应中（当回旋周期远小于波的时间尺度时，该响应在垂直电场分量中占主导地位），粒子种类$s$对垂直介电常数元素的精确回旋平均贡献可以用零阶回旋平均算子$\\Gamma_{0}(b_{s})$表示，其中$b_{s}$是标准的FLR参数，定义为垂直波长与该粒子种类的回旋半径之比的平方。\n\n从线性化的Vlasov-Maxwell系统和各向同性麦克斯韦分布的导心回旋平均响应出发，粒子种类$s$的垂直极化磁化率通过附加贡献的形式进入介电张量元素：\n$$\\Delta\\varepsilon_{\\perp,s}^{\\mathrm{full}} = \\frac{\\omega_{ps}^{2}}{\\omega^{2}} \\left(1 - \\Gamma_{0}(b_{s})\\right),$$\n其中$\\omega_{ps} = \\sqrt{\\frac{n_{s} q_{s}^{2}}{\\varepsilon_{0} m_{s}}}$是该粒子种类的等离子体频率，$n_{s}$是数密度，$q_{s}$是电荷，$m_{s}$是质量，$\\varepsilon_{0}$是真空介电常数。FLR参数为\n$$b_{s} = k_{\\perp}^{2} \\rho_{s}^{2},\\quad \\rho_{s} = \\frac{v_{ts}}{\\lvert \\Omega_{s} \\rvert},\\quad v_{ts} = \\sqrt{\\frac{2 k_{B} T_{s}}{m_{s}}},\\quad \\Omega_{s} = \\frac{q_{s} B}{m_{s}},$$\n其中$T_{s}$是该粒子种类的温度，$k_{B}$是玻尔兹曼常数，$v_{ts}$是麦克斯韦分布下的热速度。算子$\\Gamma_{0}$由完整的贝塞尔函数求和结果精确给出\n$$\\Gamma_{0}(b) = e^{-b} I_{0}(b),$$\n其中$I_{0}$是零阶第一类修正贝塞尔函数，它是在对回旋平均响应中的回旋谐波贡献求和后得到的。在小$b$展开中的一阶截断（一个$O(b)$的FLR近似）使用了$\\Gamma_{0}(b)$的泰勒级数，\n$$\\Gamma_{0}(b) = 1 - b + \\frac{3}{4} b^{2} - \\cdots,$$\n并仅保留主导修正项，得到\n$$\\Delta\\varepsilon_{\\perp,s}^{O(b)} = \\frac{\\omega_{ps}^{2}}{\\omega^{2}}\\, b_{s}.$$\n在该极化模型中，垂直介电张量元素是回旋各向同性的，因此\n$$\\varepsilon_{xx}^{\\mathrm{model}} = \\varepsilon_{yy}^{\\mathrm{model}} = 1 + \\sum_{s} \\Delta\\varepsilon_{\\perp,s},$$\n其中求和遍及电子和离子。\n\n您的任务是实现一个程序，该程序针对一组基准参数，使用$\\Gamma_{0}$的精确回旋平均表达式（“完整贝塞尔函数求和”结果）和$O(b)$截断来计算垂直介电常数元素，然后量化两者之间的相对误差。具体来说，对每个测试用例，计算\n$$\\varepsilon_{\\perp}^{\\mathrm{full}} = 1 + \\sum_{s \\in \\{\\mathrm{e}, \\mathrm{i}\\}} \\frac{\\omega_{ps}^{2}}{\\omega^{2}} \\left(1 - \\Gamma_{0}(b_{s})\\right),\\quad \\varepsilon_{\\perp}^{O(b)} = 1 + \\sum_{s \\in \\{\\mathrm{e}, \\mathrm{i}\\}} \\frac{\\omega_{ps}^{2}}{\\omega^{2}}\\, b_{s},$$\n并报告标量相对误差\n$$\\mathcal{E} = \\frac{\\left\\lvert \\varepsilon_{\\perp}^{\\mathrm{full}} - \\varepsilon_{\\perp}^{O(b)} \\right\\rvert}{\\left\\lvert \\varepsilon_{\\perp}^{\\mathrm{full}} \\right\\rvert}。$$\n\n所有物理量必须在国际单位制（SI）中处理。温度以电子伏特（eV）为单位提供，必须通过$T\\,[\\mathrm{J}] = T\\,[\\mathrm{eV}] \\times e$转换为焦耳（J），其中$e$是单位为库仑的元电荷。角频率的单位必须是弧度/秒。输出$\\mathcal{E}$是无量纲的，必须表示为小数。\n\n使用以下参数集的测试套件，每个参数集由粒子密度$n_{\\mathrm{e}} = n_{\\mathrm{i}}$（单位为$\\mathrm{m}^{-3}$）、磁场$B$（单位为特斯拉）、电子温度$T_{\\mathrm{e}}$（单位为$\\mathrm{eV}$）、离子温度$T_{\\mathrm{i}}$（单位为$\\mathrm{eV}$）、垂直波数$k_{\\perp}$（单位为$\\mathrm{m}^{-1}$）和波的角频率$\\omega$（单位为$\\mathrm{rad/s}$）指定。假设离子种类为氘，其质量为$m_{\\mathrm{i}}$，电荷为$q_{\\mathrm{i}} = +e$；电子的质量为$m_{\\mathrm{e}}$，电荷为$q_{\\mathrm{e}} = -e$。\n\n- 测试用例1：$n_{\\mathrm{e}} = n_{\\mathrm{i}} = 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$，$B = 3.0\\,\\mathrm{T}$，$T_{\\mathrm{e}} = 3000\\,\\mathrm{eV}$，$T_{\\mathrm{i}} = 3000\\,\\mathrm{eV}$，$k_{\\perp} = 50\\,\\mathrm{m}^{-1}$，$\\omega = 1.0 \\times 10^{7}\\,\\mathrm{rad/s}$。\n- 测试用例2：$n_{\\mathrm{e}} = n_{\\mathrm{i}} = 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$，$B = 3.0\\,\\mathrm{T}$，$T_{\\mathrm{e}} = 3000\\,\\mathrm{eV}$，$T_{\\mathrm{i}} = 3000\\,\\mathrm{eV}$，$k_{\\perp} = 500\\,\\mathrm{m}^{-1}$，$\\omega = 1.0 \\times 10^{7}\\,\\mathrm{rad/s}$。\n- 测试用例3：$n_{\\mathrm{e}} = n_{\\mathrm{i}} = 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$，$B = 3.0\\,\\mathrm{T}$，$T_{\\mathrm{e}} = 3000\\,\\mathrm{eV}$，$T_{\\mathrm{i}} = 3000\\,\\mathrm{eV}$，$k_{\\perp} = 5\\,\\mathrm{m}^{-1}$，$\\omega = 1.0 \\times 10^{7}\\,\\mathrm{rad/s}$。\n- 测试用例4：$n_{\\mathrm{e}} = n_{\\mathrm{i}} = 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$，$B = 3.0\\,\\mathrm{T}$，$T_{\\mathrm{e}} = 3000\\,\\mathrm{eV}$，$T_{\\mathrm{i}} = 3000\\,\\mathrm{eV}$，$k_{\\perp} = 3000\\,\\mathrm{m}^{-1}$，$\\omega = 1.0 \\times 10^{7}\\,\\mathrm{rad/s}$。\n- 测试用例5：$n_{\\mathrm{e}} = n_{\\mathrm{i}} = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$，$B = 1.0\\,\\mathrm{T}$，$T_{\\mathrm{e}} = 2000\\,\\mathrm{eV}$，$T_{\\mathrm{i}} = 1000\\,\\mathrm{eV}$，$k_{\\perp} = 200\\,\\mathrm{m}^{-1}$，$\\omega = 5.0 \\times 10^{6}\\,\\mathrm{rad/s}$。\n\n您的程序应生成单行输出，其中包含五个测试用例的相对误差$\\mathcal{E}$，形式为方括号内以逗号分隔的列表，例如$\\left[\\mathcal{E}_{1},\\mathcal{E}_{2},\\mathcal{E}_{3},\\mathcal{E}_{4},\\mathcal{E}_{5}\\right]$。不应打印任何其他文本。",
            "solution": "问题陈述已经过仔细审查，并被确定为有效。它在科学上基于成熟的温等离子体动力学响应理论，特别是在均匀磁场存在下的Vlasov-Maxwell模型。该问题是适定的，提供了计算唯一且有意义的结果所需的所有物理参数、常数和清晰的数学表达式——该结果即为完整回旋平均介电模型与其一阶有限拉莫尔半径（FLR）近似之间的相对误差。语言是客观的，为测试用例提供的参数对于磁约束聚变等离子体是物理上现实的。该任务是计算等离子体物理学中一个标准的、非平凡的练习。\n\n解决方案首先通过实现所提供的公式来计算垂直介电张量元素$\\varepsilon_{\\perp}$，其中使用了两种不同的粒子磁化率模型：一个使用精确回旋平均算子$\\Gamma_0$的“完整”模型，以及一个在FLR参数$b_s$中进行一阶泰勒展开的近似模型。计算是针对由电子（e）和氘离子（i）组成的等离子体进行的。然后为一系列测试用例中的每一个计算两种模型之间的相对误差。\n\n此计算所需的基本物理常数（国际单位制）如下：\n- 元电荷：$e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n- 电子质量：$m_{\\mathrm{e}} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$\n- 氘核质量：$m_{\\mathrm{i}} = 3.3435837724 \\times 10^{-27}\\,\\mathrm{kg}$\n- 真空介电常数：$\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$\n\n对于单个测试用例，由参数$n_{\\mathrm{e}} = n_{\\mathrm{i}} = n$、$B$、$T_{\\mathrm{e}}$、$T_{\\mathrm{i}}$、$k_{\\perp}$和$\\omega$定义，其计算过程如下。对于每种粒子$s \\in \\{\\mathrm{e}, \\mathrm{i}\\}$：\n\n1.  **粒子种类参数**：确定粒子种类的电荷$q_s$和质量$m_s$。对于电子，$q_{\\mathrm{e}} = -e$，$m_s = m_{\\mathrm{e}}$。对于氘离子，$q_{\\mathrm{i}} = +e$，$m_s = m_{\\mathrm{i}}$。数密度为$n_s = n$。\n\n2.  **温度转换**：将以电子伏特（eV）为单位的粒子温度$T_s$通过关系式$T_s\\,[\\mathrm{J}] = T_s\\,[\\mathrm{eV}] \\times e$转换为焦耳（J）。在标准热物理学记法中，该能量值对应于$k_B T_s$。\n\n3.  **等离子体频率**：该粒子种类的等离子体频率的平方，$\\omega_{ps}^2$，计算如下：\n    $$ \\omega_{ps}^{2} = \\frac{n_{s} q_{s}^{2}}{\\varepsilon_{0} m_{s}} $$\n\n4.  **回旋频率**：粒子种类$s$的回旋频率$\\Omega_s$，即围绕磁场线回旋的角频率，由下式给出：\n    $$ \\Omega_{s} = \\frac{q_{s} B}{m_{s}} $$\n\n5.  **热速度**：麦克斯韦分布下粒子种类的热速度$v_{ts}$，使用以焦耳为单位的能量计算：\n    $$ v_{ts} = \\sqrt{\\frac{2 T_{s}\\,[\\mathrm{J}]}{m_{s}}} = \\sqrt{\\frac{2 (T_{s}\\,[\\mathrm{eV}] \\times e)}{m_{s}}} $$\n\n6.  **回旋半径**：热回旋半径$\\rho_s$，即粒子螺旋路径的特征半径，计算为热速度与回旋频率大小之比：\n    $$ \\rho_{s} = \\frac{v_{ts}}{\\lvert \\Omega_{s} \\rvert} $$\n\n7.  **FLR参数**：无量纲的有限拉莫尔半径（FLR）参数$b_s$，量化了波的垂直尺度长度（$1/k_{\\perp}$）与粒子回旋半径的平方比。其计算公式为：\n    $$ b_{s} = k_{\\perp}^{2} \\rho_{s}^{2} $$\n    该参数决定了FLR效应的重要性。近似$\\Gamma_0(b_s) \\approx 1-b_s$仅在$b_s \\ll 1$时有效。\n\n8.  **磁化率贡献**：计算粒子种类$s$对垂直介电常数的附加贡献，分别针对完整模型和近似模型。\n    - 对于“完整贝塞尔函数求和”模型，我们使用$\\Gamma_{0}(b_{s}) = e^{-b_s} I_{0}(b_s)$，其中$I_0$是零阶第一类修正贝塞尔函数。磁化率为：\n      $$ \\Delta\\varepsilon_{\\perp,s}^{\\mathrm{full}} = \\frac{\\omega_{ps}^{2}}{\\omega^{2}} \\left(1 - e^{-b_s} I_{0}(b_s)\\right) $$\n    - 对于一阶小$b_s$近似（$O(b)$），我们有：\n      $$ \\Delta\\varepsilon_{\\perp,s}^{O(b)} = \\frac{\\omega_{ps}^{2}}{\\omega^{2}} b_{s} $$\n\n在计算完电子（$s=\\mathrm{e}$）和离子（$s=\\mathrm{i}$）的这些贡献后，我们将它们相加，以找到每个模型的总垂直介电元素。\n\n9.  **总介电元素**：真空贡献为$1$。\n    $$ \\varepsilon_{\\perp}^{\\mathrm{full}} = 1 + \\Delta\\varepsilon_{\\perp,\\mathrm{e}}^{\\mathrm{full}} + \\Delta\\varepsilon_{\\perp,\\mathrm{i}}^{\\mathrm{full}} $$\n    $$ \\varepsilon_{\\perp}^{O(b)} = 1 + \\Delta\\varepsilon_{\\perp,\\mathrm{e}}^{O(b)} + \\Delta\\varepsilon_{\\perp,\\mathrm{i}}^{O(b)} $$\n\n10. **相对误差**：最后，计算标量相对误差$\\mathcal{E}$以量化两种模型之间的差异：\n    $$ \\mathcal{E} = \\frac{\\left\\lvert \\varepsilon_{\\perp}^{\\mathrm{full}} - \\varepsilon_{\\perp}^{O(b)} \\right\\rvert}{\\left\\lvert \\varepsilon_{\\perp}^{\\mathrm{full}} \\right\\rvert} $$\n\n此过程被系统地应用于5个测试用例中的每一个，以生成最终的误差值列表。该实现利用数值库`SciPy`来计算修正贝塞尔函数$I_0(b_s)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\n\ndef solve():\n    \"\"\"\n    Computes the relative error between a full gyroaveraged dielectric model and\n    its first-order FLR approximation for a set of plasma parameters.\n    \"\"\"\n\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    M_E = 9.1093837015e-31      # Electron mass in kg\n    M_D = 3.3435837724e-27      # Deuteron mass in kg\n    EPSILON_0 = 8.8541878128e-12 # Vacuum permittivity in F/m\n\n    # Per-species data (charge and mass)\n    species_data = {\n        'e': {'q': -E_CHARGE, 'm': M_E},  # Electrons\n        'i': {'q': E_CHARGE, 'm': M_D}    # Deuterium ions\n    }\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (n_e=n_i, B, T_e, T_i, k_perp, omega)\n    test_cases = [\n        (1.0e19, 3.0, 3000.0, 3000.0, 50.0, 1.0e7),\n        (1.0e19, 3.0, 3000.0, 3000.0, 500.0, 1.0e7),\n        (1.0e19, 3.0, 3000.0, 3000.0, 5.0, 1.0e7),\n        (1.0e19, 3.0, 3000.0, 3000.0, 3000.0, 1.0e7),\n        (5.0e19, 1.0, 2000.0, 1000.0, 200.0, 5.0e6)\n    ]\n\n    results = []\n\n    for n, B, T_e_eV, T_i_eV, k_perp, omega in test_cases:\n        # Initialize dielectric elements with vacuum contribution (1)\n        eps_perp_full = 1.0\n        eps_perp_ob = 1.0\n\n        # Store temperatures for easy access in the loop\n        temps = {'e': T_e_eV, 'i': T_i_eV}\n\n        # Loop over species (electrons and ions)\n        for s_key, s_params in species_data.items():\n            T_s_eV = temps[s_key]\n            q_s = s_params['q']\n            m_s = s_params['m']\n            n_s = n  # Density is the same for both species\n\n            # 1. Calculate square of species plasma frequency\n            omega_ps_sq = (n_s * q_s**2) / (EPSILON_0 * m_s)\n\n            # 2. Convert temperature from eV to Joules\n            T_s_J = T_s_eV * E_CHARGE\n            \n            # 3. Calculate thermal speed\n            v_ts = np.sqrt(2 * T_s_J / m_s)\n            \n            # 4. Calculate cyclotron frequency\n            Omega_s = (q_s * B) / m_s\n            \n            # 5. Calculate thermal gyroradius\n            rho_s = v_ts / np.abs(Omega_s)\n            \n            # 6. Calculate FLR parameter b_s\n            b_s = (k_perp * rho_s)**2\n\n            # 7. Calculate susceptibility contributions\n            common_factor = omega_ps_sq / (omega**2)\n            \n            # Full model contribution\n            gamma_0 = np.exp(-b_s) * i0(b_s)\n            delta_eps_full = common_factor * (1.0 - gamma_0)\n            \n            # O(b) approximation contribution\n            delta_eps_ob = common_factor * b_s\n\n            # 8. Add contributions to total dielectric elements\n            eps_perp_full += delta_eps_full\n            eps_perp_ob += delta_eps_ob\n\n        # 9. Calculate the final relative error for the test case\n        numerator = np.abs(eps_perp_full - eps_perp_ob)\n        denominator = np.abs(eps_perp_full)\n        \n        # Handle potential division by zero, although unlikely for these parameters\n        if denominator == 0:\n            error = np.inf if numerator > 0 else 0.0\n        else:\n            error = numerator / denominator\n\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "本高级实践将带您深入探索完整的暖等离子体动理学介电张量，它包含了回旋共振谐波的贡献。您的任务不仅是实现这一复杂的物理模型，还要利用它来数值验证一个深刻的物理对称性——互易原理。这个练习将锻炼您处理复杂物理模型的能力，并揭示在计算等离子体物理中常见的数值挑战，如谐波截断和共振处理。",
            "id": "4064047",
            "problem": "需要一个程序来评估温磁化等离子体介电张量的互易对称性，通过比较 $\\,\\epsilon_{ij}(\\mathbf{B}_0)=\\epsilon_{ji}(-\\mathbf{B}_0)\\,$ 是否在垂直传播的有限拉莫尔半径动理学模型中成立。其基础物理系统是均匀、无碰撞、各向同性的麦克斯韦等离子体。磁场是均匀且静态的，$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$。波矢垂直于 $\\mathbf{B}_0$，即 $\\mathbf{k} = k_\\perp \\hat{\\mathbf{x}}$，因此 $k_\\parallel = 0$。频率 $\\omega$ 是实数，电流从线性化的弗拉索夫-麦克斯韦系统中获得。介电张量 $\\epsilon_{ij}$ 通过 $\\mathbf{D} = \\epsilon_0 \\epsilon \\mathbf{E}$ 将位移场 $\\mathbf{D}$ 与电场 $\\mathbf{E}$ 联系起来，其中 $\\epsilon$ 包含各种粒子的磁化率。\n\n从适用于带电荷 $q_s$、质量为 $m_s$、具有平衡麦克斯韦分布的粒子 $s$ 的线性化弗拉索夫方程，以及无碰撞情况下的麦克斯韦方程组出发。利用垂直传播的磁化动理学响应，以回旋谐波 $n \\in \\mathbb{Z}$ 的形式，获得介电张量元。有限拉莫尔半径 (FLR) 效应通过参数 $\\,b_s = k_\\perp^2 \\frac{k_B T_s}{m_s \\Omega_s^2}\\,$ 体现，其中 $\\,\\Omega_s = \\frac{q_s B_0}{m_s}\\,$ 是回旋频率，$\\,k_B\\,$ 是玻尔兹曼常数，$\\,T_s\\,$ 是该粒子的温度。谐波内容通过第一类修正贝塞尔函数 $\\,I_n(b_s)\\,$、因子 $\\,\\Gamma_n(b_s) = I_n(b_s)\\,e^{-b_s}\\,$ 及其对 $b_s$ 的导数 $\\,\\Gamma_n'(b_s) = \\frac{d}{d b_s}\\Gamma_n(b_s)\\,$ 来表示。等离子体频率为 $\\,\\omega_{ps}^2 = \\frac{n_s q_s^2}{\\epsilon_0 m_s}\\,$, 其中 $n_s$ 是粒子密度。对于垂直传播，纵向分量 $\\,\\epsilon_{zz}\\,$ 简化为冷等离子体形式，且非对角的 z-耦合项消失。\n\n您的任务是：\n- 使用从线性化弗拉索夫-麦克斯韦系统获得的磁化麦克斯韦磁化率，推导并用代码实现用于垂直传播的温等离子体介电张量 $\\,\\epsilon(\\mathbf{B}_0)\\,$。使用对称边界 $\\,n=-N,\\ldots,+N\\,$ 对谐波 $\\,n\\,$ 进行截断求和，并稳健地计算 $\\,\\Gamma_n(b_s)\\,$ 和 $\\,\\Gamma_n'(b_s)\\,$。除了所述的基本定律和定义外，不要假定任何预先给定的公式；推导必须基于这些基础原则。\n- 通过计算每个测试用例的最大绝对差 $\\,\\max_{i,j} \\left|\\epsilon_{ij}(\\mathbf{B}_0)-\\epsilon_{ji}(-\\mathbf{B}_0)\\right|\\,$，数值检验互易对称性 $\\,\\epsilon_{ij}(\\mathbf{B}_0)=\\epsilon_{ji}(-\\mathbf{B}_0)\\,$。\n- 识别并演示可能破坏或降低此对称性的数值来源，例如谐波截断、近共振分母 $\\,(\\omega - n \\Omega_s)\\,$ 以及导数 $\\,\\Gamma_n'(b_s)\\,$ 的数值计算。\n\n使用以下物理和数值规范：\n- 粒子种类：电子（$\\,q_e=-e\\,$, $\\,m_e\\,$）和单电离氘离子（$\\,q_i=+e\\,$, $\\,m_i=2 m_p\\,$），具有准中性密度 $\\,n_e=n_i\\,$。\n- 单位：使用国际单位制（SI）。温度以电子伏特给出，必须通过 $\\,E = T_{\\mathrm{eV}} \\times e\\,$ 转换为焦耳。磁场单位为特斯拉，波数单位为 $\\mathrm{m}^{-1}$，频率单位为赫兹，角频率为 $\\,\\omega=2\\pi f\\,$。\n- 角度单位：不适用，因为传播是纯粹垂直的（$\\,k_\\parallel=0\\,$）。\n- 最终程序必须输出一行内容，其中包含每个测试用例的互易误差 $\\,\\max_{i,j} \\left|\\epsilon_{ij}(\\mathbf{B}_0)-\\epsilon_{ji}(-\\mathbf{B}_0)\\right|\\,$ 的浮点数列表，格式必须为 $\\,\\left[\\text{result}_1,\\text{result}_2,\\ldots\\right]\\,$。\n\n基于推导出的动理学磁化率，按如下方式实现垂直传播的介电张量：\n- 从包含有限拉莫尔半径效应的磁化麦克斯韦温等离子体响应中计算 $\\,\\epsilon_{xx}\\,$, $\\,\\epsilon_{xy}\\,$, $\\,\\epsilon_{yx}\\,$, $\\,\\epsilon_{yy}\\,$。\n- 对于 $\\,k_\\parallel=0\\,$，设置 $\\,\\epsilon_{zz} = 1 - \\sum_s \\omega_{ps}^2/\\omega^2\\,$ 和 $\\,\\epsilon_{xz}=\\epsilon_{zx}=\\epsilon_{yz}=\\epsilon_{zy}=0\\,$。\n- 除非在测试用例中为演示失效模式而另有规定，否则使用对称谐波求和 $\\,n=-N,\\ldots,+N\\,$。\n\n测试套件。对于每个案例，计算并返回单个浮点数 $\\,\\max_{i,j} \\left|\\epsilon_{ij}(\\mathbf{B}_0)-\\epsilon_{ji}(-\\mathbf{B}_0)\\right|\\,$：\n- 案例A（理想情况，良好对称性）：$\\,n_e = n_i = 1.0\\times 10^{19}\\,\\mathrm{m}^{-3}\\,$, $\\,T_e = 2000\\,\\mathrm{eV}\\,$, $\\,T_i = 1000\\,\\mathrm{eV}\\,$, $\\,B_0 = 3.0\\,\\mathrm{T}\\,$, $\\,k_\\perp = 5.0\\,\\mathrm{m}^{-1}\\,$, $\\,f = 60.0\\times 10^{6}\\,\\mathrm{Hz}\\,$, 谐波截断 $\\,N=50\\,$, 导数方法为解析法。\n- 案例B（谐波截断压力测试）：与案例A相同，但 $\\,N=5\\,$, 导数方法为解析法。\n- 案例C（靠近离子回旋共振）：密度和温度相同，$\\,B_0 = 3.0\\,\\mathrm{T}\\,$, $\\,k_\\perp = 5.0\\,\\mathrm{m}^{-1}\\,$, $\\,f\\,$ 设置为 $\\,f_i = \\Omega_i/(2\\pi)\\,$，其中 $\\,\\Omega_i = e B_0/m_i\\,$, 谐波截断 $\\,N=50\\,$, 导数方法为解析法。\n- 案例D（大FLR参数）：密度和温度相同，$\\,B_0 = 3.0\\,\\mathrm{T}\\,$, $\\,k_\\perp = 500.0\\,\\mathrm{m}^{-1}\\,$, $\\,f = 60.0\\times 10^{6}\\,\\mathrm{Hz}\\,$, $\\,N=100\\,$, 导数方法为解析法。\n- 案例E（为说明实现陷阱而故意采用非对称谐波求和）：与案例A相同，但仅对 $\\,n=0,\\ldots,N\\,$ 求和（省略负谐波），导数方法为解析法。\n\n所有答案都必须计算并表示为无量纲浮点数（输出中不含单位），最终程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，格式如 $\\,\\left[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D,\\text{result}_E\\right]\\,$。",
            "solution": "该问题陈述是计算等离子体物理学中一个有效且定义明确的练习。它要求推导和数值实现垂直传播下的温等离子体介电张量，然后对互易对称关系 $\\epsilon_{ij}(\\mathbf{B}_0)=\\epsilon_{ji}(-\\mathbf{B}_0)$ 进行数值验证。其物理模型是一个均匀、无碰撞的磁化麦克斯韦等离子体，这是一个标准且有科学依据的系统。所提供的参数和测试用例在物理上是现实的，旨在探究模型的特定数值和物理方面，如谐波截断、回旋共振和大的拉莫尔半径效应。该问题是自洽且客观的。\n\n### 介电张量的理论推导\n\n介电张量 $\\epsilon$ 通过 $\\mathbf{D} = \\epsilon_0 \\epsilon \\cdot \\mathbf{E}$ 将位移场 $\\mathbf{D}$ 与电场 $\\mathbf{E}$ 联系起来。在等离子体中，它由等离子体对电场的响应决定，该响应会产生电流密度 $\\mathbf{J}$。其关系由 $\\epsilon = \\mathbf{I} + \\frac{i}{\\omega \\epsilon_0} \\sigma$ 给出，其中 $\\sigma$ 是由 $\\mathbf{J} = \\sigma \\cdot \\mathbf{E}$ 定义的电导率张量。总电流是所有粒子种类 $s$ 贡献的总和，$\\mathbf{J} = \\sum_s \\mathbf{J}_s$。\n\n我们从粒子种类 $s$ 的微扰分布函数 $f_s^{(1)}$ 的线性化弗拉索夫方程开始：\n$$\n\\frac{\\partial f_s^{(1)}}{\\partial t} + \\mathbf{v} \\cdot \\nabla f_s^{(1)} + \\frac{q_s}{m_s}(\\mathbf{v} \\times \\mathbf{B}_0) \\cdot \\nabla_{\\mathbf{v}} f_s^{(1)} = -\\frac{q_s}{m_s} \\mathbf{E}^{(1)} \\cdot \\nabla_{\\mathbf{v}} f_s^{(0)}\n$$\n其中 $f_s^{(0)}$ 是平衡分布函数（此处为麦克斯韦分布），$\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 是均匀静态磁场。我们假设一个形式为 $e^{i(\\mathbf{k} \\cdot \\mathbf{r} - \\omega t)}$ 的平面波微扰。对于垂直传播，$\\mathbf{k} = k_\\perp \\hat{\\mathbf{x}}$（$k_\\parallel=0$）。\n\n求解此方程的标准方法是沿未受扰动的粒子轨迹（磁场中的螺旋路径）进行积分。这将得到 $f_s^{(1)}$，由此可以计算出微扰电流密度 $\\mathbf{J}_s^{(1)} = q_s \\int \\mathbf{v} f_s^{(1)} d^3v$。该过程建立了 $\\mathbf{J}_s$ 和 $\\mathbf{E}$ 之间的线性关系，从而定义了粒子电导率 $\\sigma_s$ 和磁化率 $\\chi_s = \\frac{i}{\\omega \\epsilon_0} \\sigma_s$。\n\n对于麦克斯韦等离子体，推导过程涉及对速度空间的积分，其中包含由粒子谐波运动展开而来的贝塞尔函数。在垂直传播极限（$k_\\parallel=0$）下，单个粒子种类 $s$ 的磁化率张量结果是关于回旋谐波 $n$ 的无穷级数。磁化率张量 $\\chi_s$ 的分量由下式给出：\n$$\n\\chi_{xx}^{(s)} = \\sum_{n=-\\infty}^{\\infty} \\frac{\\omega_{ps}^2}{\\omega} \\frac{1}{\\omega - n \\Omega_s} \\frac{n^2 \\Gamma_n(b_s)}{b_s}\n$$\n$$\n\\chi_{xy}^{(s)} = i \\sum_{n=-\\infty}^{\\infty} \\frac{\\omega_{ps}^2}{\\omega} \\frac{1}{\\omega - n \\Omega_s} n \\Gamma_n'(b_s)\n$$\n$$\n\\chi_{yx}^{(s)} = -i \\sum_{n=-\\infty}^{\\infty} \\frac{\\omega_{ps}^2}{\\omega} \\frac{1}{\\omega - n \\Omega_s} n \\Gamma_n'(b_s)\n$$\n$$\n\\chi_{yy}^{(s)} = \\sum_{n=-\\infty}^{\\infty} \\frac{\\omega_{ps}^2}{\\omega} \\frac{1}{\\omega - n \\Omega_s} \\left[ \\frac{n^2 \\Gamma_n(b_s)}{b_s} - 2b_s \\Gamma_n'(b_s) \\right]\n$$\n与 $\\hat{\\mathbf{z}}$ 方向相关的其余分量均为零，除了 $\\chi_{zz}^{(s)}$，它在 $k_\\parallel=0$ 的极限下简化为：\n$$\n\\chi_{zz}^{(s)} = -\\frac{\\omega_{ps}^2}{\\omega^2}\n$$\n此处，$\\omega_{ps} = \\sqrt{n_s q_s^2 / (\\epsilon_0 m_s)}$ 是粒子等离子体频率，$\\Omega_s = q_s B_0 / m_s$ 是带符号的回旋频率，$b_s = \\frac{k_\\perp^2 k_B T_s}{m_s \\Omega_s^2}$ 是有限拉莫尔半径（FLR）参数。函数 $\\Gamma_n(b_s) = I_n(b_s) e^{-b_s}$ 和 $\\Gamma_n'(b_s) = \\frac{d}{db_s} \\Gamma_n(b_s)$ 包含第一类修正贝塞尔函数 $I_n$。总介电张量为 $\\epsilon = \\mathbf{I} + \\sum_s \\chi_s$。\n\n### 互易对称性分析\n\n待检验的互易关系是 $\\epsilon_{ij}(\\mathbf{B}_0) = \\epsilon_{ji}(-\\mathbf{B}_0)$。磁场 $\\mathbf{B}_0$ 仅通过回旋频率 $\\Omega_s$ 进入表达式。反转磁场，即 $\\mathbf{B}_0 \\to -\\mathbf{B}_0$，意味着 $\\Omega_s \\to -\\Omega_s$。FLR 参数 $b_s$ 取决于 $\\Omega_s^2$，因此在磁场反转下它是不变的。因此，$\\Gamma_n(b_s)$ 和 $\\Gamma_n'(b_s)$ 也是不变的。\n\n让我们验证非对角分量 $\\epsilon_{xy}$ 和 $\\epsilon_{yx}$ 的关系。\n$$\n\\epsilon_{xy}(\\mathbf{B}_0) = i \\sum_s \\sum_n \\frac{\\omega_{ps}^2}{\\omega} \\frac{n \\Gamma_n'(b_s)}{\\omega - n\\Omega_s}\n$$\n现在我们计算 $\\epsilon_{yx}(-\\mathbf{B}_0)$：\n$$\n\\epsilon_{yx}(-\\mathbf{B}_0) = -i \\sum_s \\sum_n \\frac{\\omega_{ps}^2}{\\omega} \\frac{n \\Gamma_n'(b_s)}{\\omega - n(-\\Omega_s)} = -i \\sum_s \\sum_n \\frac{\\omega_{ps}^2}{\\omega} \\frac{n \\Gamma_n'(b_s)}{\\omega + n\\Omega_s}\n$$\n通过将求和索引从 $n$ 变为 $n' = -n$，并使用恒等式 $\\Gamma'_{-n'}(x) = \\Gamma'_{n'}(x)$（该恒等式源于 $I_{-n'}(x)=I_{n'}(x)$），我们得到：\n$$\n\\epsilon_{yx}(-\\mathbf{B}_0) = -i \\sum_s \\sum_{n'} \\frac{\\omega_{ps}^2}{\\omega} \\frac{(-n') \\Gamma'_{-n'}(b_s)}{\\omega - n'\\Omega_s} = i \\sum_s \\sum_{n'} \\frac{\\omega_{ps}^2}{\\omega} \\frac{n' \\Gamma'_{n'}(b_s)}{\\omega - n'\\Omega_s} = \\epsilon_{xy}(\\mathbf{B}_0)\n$$\n这证实了 $\\epsilon_{xy}(\\mathbf{B}_0) = \\epsilon_{yx}(-\\mathbf{B}_0)$。类似的过程可以证实所有其他分量的关系。这个解析证明依赖于求和是在一个对称范围（例如 $-\\infty$ 到 $+\\infty$）内进行的。任何有限的对称截断 $\\sum_{n=-N}^N$ 都保留了这一性质。\n\n### 数值实现与误差来源\n\n该实现涉及通过将谐波的无穷级数求和截断到有限对称范围 $[-N, N]$ 来计算张量元。有几个因素可能导致数值不准确或对称性的明显破坏：\n1.  **谐波截断 ($N$)**：如果 $N$ 太小，截断后的和是对完整级数的糟糕近似。对于大的 $b_s$ 尤其如此，因为能量分布在很宽的谐波范围内。虽然对称截断在形式上保留了互易关系，但不精确求和中累积的浮点误差可能会更大。\n2.  **非对称求和**：如果求和范围不对称（例如 $n=0, \\ldots, N$），证明中使用的变动索引技巧 $n \\to -n$ 将失效。这是一个实现错误，会明确地破坏互易对称性，案例E将对此进行演示。\n3.  **回旋共振**：当某个谐波 $n$ 满足 $\\omega \\approx n\\Omega_s$ 时，求和中的相应项会发散。在物理系统中，阻尼机制（例如，碰撞，或 $k_\\parallel \\neq 0$ 时的朗道阻尼）会使这个奇点正则化。在我们的无碰撞、$k_\\parallel=0$ 模型中，这会导致除以零，从而产生 `inf` 或 `NaN` 值，如案例C所示。\n4.  **函数的数值计算**：项 $\\Gamma_n(b_s) = I_n(b_s)e^{-b_s}$ 涉及一个指数增长函数 ($I_n$) 和一个指数衰减函数 ($e^{-b_s}$) 的乘积，这在 $b_s$ 很大时数值上不稳定。一种稳健的方法是使用专门的库函数直接计算这个乘积，例如 `scipy.special.ive`。导数 $\\Gamma_n'(b_s)$ 是使用贝塞尔函数导数的递推关系 $I_n'(x) = \\frac{1}{2}(I_{n-1}(x) + I_{n+1}(x))$ 解析计算的，当用 `ive` 实现时，它在数值上也是稳定的。\n\n以下代码实现了这一计算，并在各种条件下测试了对称关系。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import ive\nfrom scipy.constants import e, m_e, m_p, epsilon_0, pi\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for warm plasma dielectric tensor reciprocity.\n    \"\"\"\n\n    # Physical Constants\n    # Deuterium mass is specified as 2 * proton mass\n    m_i_val = 2.0 * m_p\n    q_e_val = -e\n    q_i_val = e\n\n    species_defs = {\n        'e': {'q': q_e_val, 'm': m_e},\n        'i': {'q': q_i_val, 'm': m_i_val}\n    }\n    \n    # Test cases as defined in the problem statement\n    test_cases = [\n        # Case A: Happy path\n        {'name': 'A', 'ne': 1.0e19, 'Te': 2000.0, 'Ti': 1000.0, 'B0': 3.0, 'k_perp': 5.0, 'f': 60.0e6, 'N': 50, 'sum_type': 'symmetric'},\n        # Case B: Harmonic truncation stress\n        {'name': 'B', 'ne': 1.0e19, 'Te': 2000.0, 'Ti': 1000.0, 'B0': 3.0, 'k_perp': 5.0, 'f': 60.0e6, 'N': 5, 'sum_type': 'symmetric'},\n        # Case C: Near ion cyclotron resonance\n        {'name': 'C', 'ne': 1.0e19, 'Te': 2000.0, 'Ti': 1000.0, 'B0': 3.0, 'k_perp': 5.0, 'f': (q_i_val * 3.0 / m_i_val) / (2.0 * pi), 'N': 50, 'sum_type': 'symmetric'},\n        # Case D: Large FLR parameter\n        {'name': 'D', 'ne': 1.0e19, 'Te': 2000.0, 'Ti': 1000.0, 'B0': 3.0, 'k_perp': 500.0, 'f': 60.0e6, 'N': 100, 'sum_type': 'symmetric'},\n        # Case E: Intentional asymmetry via non-symmetric harmonic summation\n        {'name': 'E', 'ne': 1.0e19, 'Te': 2000.0, 'Ti': 1000.0, 'B0': 3.0, 'k_perp': 5.0, 'f': 60.0e6, 'N': 50, 'sum_type': 'asymmetric'},\n    ]\n\n    results = []\n    for case in test_cases:\n        error = compute_reciprocity_error(case, species_defs)\n        results.append(error)\n\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\ndef calculate_dielectric_tensor(params, species_defs, b0_sign):\n    \"\"\"\n    Computes the warm plasma dielectric tensor for perpendicular propagation.\n    \"\"\"\n    n_e = params['ne']\n    n_i = n_e  # Quasi-neutrality\n    T_e_eV = params['Te']\n    T_i_eV = params['Ti']\n    B0 = params['B0']\n    k_perp = params['k_perp']\n    omega = 2.0 * np.pi * params['f']\n    N = params['N']\n\n    plasma_defs = {\n        'e': {'n': n_e, 'T_eV': T_e_eV},\n        'i': {'n': n_i, 'T_eV': T_i_eV}\n    }\n    \n    if params['sum_type'] == 'symmetric':\n        n_range = range(-N, N + 1)\n    else: # asymmetric\n        n_range = range(0, N + 1)\n        \n    epsilon = np.identity(3, dtype=np.complex128)\n    total_wp_sq = 0.0\n\n    for s_name, s_props in species_defs.items():\n        q_s = s_props['q']\n        m_s = s_props['m']\n        n_s = plasma_defs[s_name]['n']\n        T_s_J = plasma_defs[s_name]['T_eV'] * e\n\n        wp_sq = n_s * q_s**2 / (epsilon_0 * m_s)\n        Omega_s = q_s * B0 * b0_sign / m_s\n        \n        total_wp_sq += wp_sq\n\n        # Handle Omega_s = 0 case\n        if Omega_s == 0:\n            continue\n            \n        v_th_sq = T_s_J / m_s\n        b_s = k_perp**2 * v_th_sq / Omega_s**2\n        \n        chi_s = np.zeros((3, 3), dtype=np.complex128)\n\n        for n in n_range:\n            #Denominator\n            denominator = omega - n * Omega_s\n            if np.isclose(denominator, 0.0):\n                # At resonance, terms diverge\n                term_coeff = np.inf\n            else:\n                term_coeff = wp_sq / (omega * denominator)\n\n            # Modified Bessel functions and their derivatives\n            # Using ive for numerical stability: ive(n,x) = iv(n,x) * exp(-abs(x))\n            # Gamma_n(b) = I_n(b) * exp(-b) -> ive(n, b) for b > 0\n            # Gamma_n'(b) = (I_n'(b) - I_n(b)) * exp(-b)\n            #           = (0.5*(I_{n-1}(b)+I_{n+1}(b)) - I_n(b)) * exp(-b)\n            #           = 0.5*(ive(n-1,b)+ive(n+1,b)) - ive(n,b)\n            gamma_n = ive(n, b_s)\n            gamma_n_prime = 0.5 * (ive(n - 1, b_s) + ive(n + 1, b_s)) - gamma_n\n\n            # Susceptibility contributions from harmonic n\n            if b_s > 0: # Avoid division by zero if k_perp or T is zero\n                chi_s[0, 0] += term_coeff * n**2 * gamma_n / b_s\n                chi_s[1, 1] += term_coeff * (n**2 * gamma_n / b_s - 2 * b_s * gamma_n_prime)\n            \n            chi_s[0, 1] += term_coeff * 1j * n * gamma_n_prime\n            chi_s[1, 0] -= term_coeff * 1j * n * gamma_n_prime\n\n        epsilon[:2, :2] += chi_s[:2, :2]\n\n    # Epsilon_zz component (cold plasma form for k_perp=0)\n    if omega != 0:\n        epsilon[2, 2] = 1.0 - total_wp_sq / omega**2\n    else:\n        epsilon[2, 2] = np.inf\n\n    return epsilon\n\ndef compute_reciprocity_error(case_params, species_defs):\n    \"\"\"\n    Computes the reciprocity error for a single test case.\n    \"\"\"\n    # Calculate epsilon(B0)\n    eps_B0 = calculate_dielectric_tensor(case_params, species_defs, b0_sign=1.0)\n    \n    # Calculate epsilon(-B0)\n    eps_minus_B0 = calculate_dielectric_tensor(case_params, species_defs, b0_sign=-1.0)\n\n    # Calculate difference matrix: eps_ij(B0) - eps_ji(-B0)\n    diff_matrix = eps_B0 - eps_minus_B0.T\n    \n    # The metric is the maximum absolute difference\n    error = np.nanmax(np.abs(diff_matrix))\n    return error\n\nsolve()\n\n```"
        }
    ]
}