{
    "hands_on_practices": [
        {
            "introduction": "要深刻理解朗道阻尼，一个有效的方法是首先研究一个不存在阻尼的理想化系统。本练习采用“水袋”分布模型，该模型在速度空间中具有截断边界，从而缺少了能够与波发生共振的粒子。通过推导这个系统的色散关系并证明其阻尼率为零 ，我们可以清晰地揭示朗道阻尼发生的必要条件——即在波的相速度附近必须存在一个连续的粒子速度分布。",
            "id": "4000814",
            "problem": "考虑一个无磁化的一维静电电子等离子体，它是计算聚变科学与工程中堆芯湍流模拟的典型代表。电子遵循围绕空间均匀平衡态的线性化 Vlasov–Poisson 方程组，该平衡态的数密度为 $n_{e}$，速度分布函数为 $f_{0}(v)$，且归一化满足 $\\int_{-\\infty}^{\\infty} f_{0}(v)\\, dv = 1$。假设单电荷离子提供了一个固定的中性化背景。设微扰正比于 $\\exp(i k x - i \\omega t)$，其中 $k$ 为实数波数，$\\omega$ 为复数频率。\n\n平衡电子分布是有限宽度的水袋（顶帽）分布，\n$$\nf_{0}(v) = \\begin{cases}\n\\frac{1}{2 \\Delta},  |v| \\le \\Delta, \\\\\n0,  |v|  \\Delta,\n\\end{cases}\n$$\n其恒定半宽度为 $\\Delta  0$。\n\n从第一性原理出发，即电子的线性化 Vlasov 方程和泊松方程，\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} - \\frac{e}{m_{e}} E \\frac{\\partial f}{\\partial v} = 0, \\qquad \\frac{\\partial E}{\\partial x} = \\frac{e}{\\epsilon_{0}} \\left(n_{i} - n_{e} \\int_{-\\infty}^{\\infty} f\\, dv\\right),\n$$\n推导标准介电形式的色散关系，并计算水袋分布下电子等离子体波的朗道阻尼率 $\\gamma$。在复 $\\omega$ 平面中使用朗道围道规定进行解析延拓。将阻尼率的最终答案以 $\\mathrm{s}^{-1}$ 为单位表示。\n\n此外，请根据你的推导解释，与麦克斯韦平衡态相比，水袋分布中指数尾的缺失如何改变了共振的贡献。你的解释必须基于 $f_{0}(v)$ 的速度空间导数的结构以及速度积分的解析性质。\n\n如果你的最终数值结果需要四舍五入，请将答案四舍五入到四位有效数字。如果你的最终结果是一个精确的闭合形式解析表达式，请精确给出，无需四舍五入。",
            "solution": "该问题要求在具有水袋平衡分布函数的无磁化等离子体中，推导电子等离子体波的色散关系并计算朗道阻尼率。\n\n出发点是电子的线性化 Vlasov 方程和泊松方程。离子背景是固定的且起中性化作用。我们假设微扰的形式为 $\\exp(i k x - i \\omega t)$，其中 $k$ 是实数波数，$\\omega = \\omega_r + i\\gamma$ 是复数频率。\n\n围绕平衡态 $f_0(v)$ 线性化的微扰电子分布函数 $f_1(x, v, t)$ 的 Vlasov 方程为：\n$$\n\\frac{\\partial f_1}{\\partial t} + v \\frac{\\partial f_1}{\\partial x} - \\frac{e E_1}{m_{e}} \\frac{d f_{0}}{d v} = 0\n$$\n其中 $E_1(x,t)$ 是微扰电场，$e$ 是元电荷，$m_e$ 是电子质量。代入平面波形式可得：\n$$\n(-i\\omega + ikv) f_1 - \\frac{e E_1}{m_{e}} \\frac{d f_{0}}{d v} = 0\n$$\n求解微扰分布函数 $f_1$ 可得：\n$$\nf_1(v) = \\frac{e E_1}{m_e} \\frac{1}{-i\\omega+ikv} \\frac{df_0}{dv} = \\frac{i e E_1}{m_e} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v}\n$$\n接下来，我们使用泊松方程。总分布为 $f = f_0 + f_1$。为保持电中性，离子密度 $n_i$ 等于平衡电子密度 $n_e$。线性化的泊松方程变为：\n$$\n\\frac{\\partial E_1}{\\partial x} = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} f_1(v) dv\n$$\n应用平面波形式，方程变为：\n$$\nik E_1 = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} f_1(v) dv\n$$\n将 $f_1(v)$ 的表达式代入：\n$$\nik E_1 = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} \\left( \\frac{i e E_1}{m_{e}} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v} \\right) dv\n$$\n消去两边的公因子 $i E_1$ 可得：\n$$\nk = -\\frac{n_e e^2}{m_e \\epsilon_0} \\int_{-\\infty}^{\\infty} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v} dv\n$$\n引入电子等离子体频率 $\\omega_p^2 = \\frac{n_e e^2}{m_e \\epsilon_0}$，并整理得到色散关系：\n$$\n1 = -\\frac{\\omega_p^2}{k} \\int_{L} \\frac{f_0'(v)}{\\omega - kv} dv = \\frac{\\omega_p^2}{k^2} \\int_{L} \\frac{f_0'(v)}{v - \\omega/k} dv\n$$\n其中 $f_0'(v) = \\frac{d f_{0}}{d v}$，积分路径 $L$ 遵循朗道规定。这可以写成标准形式 $\\epsilon(\\omega, k) = 0$，其中介电函数为 $\\epsilon(\\omega, k) = 1 - \\frac{\\omega_p^2}{k^2} \\int_{L} \\frac{f_0'(v)}{v - \\omega/k} dv$。\n\n现在我们将此应用于具体的水袋分布：\n$$\nf_{0}(v) = \\begin{cases}\n\\frac{1}{2 \\Delta},   |v| \\le \\Delta, \\\\\n0,   |v|  \\Delta.\n\\end{cases}\n$$\n该函数的导数用狄拉克 delta 函数表示为：\n$$\nf_0'(v) = \\frac{d}{dv} \\left( \\frac{1}{2\\Delta} [H(v+\\Delta) - H(v-\\Delta)] \\right) = \\frac{1}{2\\Delta} [\\delta(v+\\Delta) - \\delta(v-\\Delta)]\n$$\n其中 $H(v)$ 是亥维赛阶跃函数。\n我们将此导数代入色散关系的速度积分中。令 $u = \\omega/k$。\n$$\n\\int_L \\frac{f_0'(v)}{v - u} dv = \\int_{-\\infty}^{\\infty} \\frac{1}{2\\Delta} \\frac{\\delta(v+\\Delta) - \\delta(v-\\Delta)}{v - u} dv\n$$\n使用 delta 函数的筛选性质 $\\int g(x) \\delta(x-a) dx = g(a)$：\n$$\n\\int_L \\frac{f_0'(v)}{v - u} dv = \\frac{1}{2\\Delta} \\left( \\frac{1}{-\\Delta - u} - \\frac{1}{\\Delta - u} \\right) = \\frac{1}{2\\Delta} \\left( \\frac{-1}{\\Delta + u} - \\frac{1}{\\Delta - u} \\right)\n$$\n$$\n= \\frac{1}{2\\Delta} \\frac{-(\\Delta - u) - (\\Delta + u)}{(\\Delta+u)(\\Delta-u)} = \\frac{1}{2\\Delta} \\frac{-2\\Delta}{\\Delta^2 - u^2} = \\frac{1}{u^2 - \\Delta^2}\n$$\n只要 $u \\neq \\pm \\Delta$，此结果对任何复数 $u$ 均有效。该积分是 $u$ 的一个解析函数，除了在 $u=\\pm \\Delta$ 处有简单极点。朗道围道规定自然得到满足，因为除非 $u$ 是实数且等于 $\\pm \\Delta$，否则被积函数在实轴上没有奇点。\n\n将此结果代回色散关系 $1 - \\frac{\\omega_p^2}{k^2} \\int \\frac{f_0'}{v - \\omega/k}dv = 0$ 中：\n$$\n1 - \\frac{\\omega_p^2}{k^2} \\left( \\frac{1}{(\\omega/k)^2 - \\Delta^2} \\right) = 0\n$$\n$$\n1 = \\frac{\\omega_p^2}{k^2} \\frac{1}{\\omega^2/k^2 - \\Delta^2} = \\frac{\\omega_p^2}{\\omega^2 - k^2\\Delta^2}\n$$\n求解 $\\omega^2$：\n$$\n\\omega^2 - k^2\\Delta^2 = \\omega_p^2\n$$\n$$\n\\omega^2 = \\omega_p^2 + k^2\\Delta^2\n$$\n由于 $\\omega_p^2  0$, $k^2 \\ge 0$, 且 $\\Delta^2  0$，方程右侧是一个正实数。因此，复数频率 $\\omega$ 由下式给出：\n$$\n\\omega = \\pm \\sqrt{\\omega_p^2 + k^2\\Delta^2}\n$$\n频率 $\\omega$ 是纯实数。阻尼率 $\\gamma$ 定义为频率的虚部，即 $\\gamma = \\Im(\\omega)$。\n从我们的结果可以明显看出，对于任何实数波数 $k$：\n$$\n\\gamma = 0\n$$\n因此，在具有水袋分布的等离子体中，电子等离子体波是无阻尼的。结果为 $0 \\ \\mathrm{s}^{-1}$。\n\n阻尼的缺失可以通过分析共振条件和 $f_0'(v)$ 的结构来解释。朗道阻尼源于波与以波的相速度 $v_{ph} = \\Re(\\omega)/k = \\omega_r/k$ 或其附近速度运动的粒子之间的净能量交换。这种能量交换的速率正比于分布函数在相速度处的斜率 $f_0'(v_{ph})$。\n\n对于水袋分布，波的相速度为：\n$$\n|v_{ph}| = \\frac{|\\omega_r|}{k} = \\frac{\\sqrt{\\omega_p^2 + k^2\\Delta^2}}{k} = \\sqrt{\\frac{\\omega_p^2}{k^2} + \\Delta^2}\n$$\n由于 $\\omega_p^2/k^2  0$，显然有 $|v_{ph}|  \\Delta$。\n水袋分布具有有限宽度，这意味着不存在速度 $|v|  \\Delta$ 的粒子。其导数 $f_0'(v)$ 仅在精确的速度 $v = \\pm\\Delta$ 处非零。由于波的相速度 $|v_{ph}|$ 严格大于 $\\Delta$，它不与 $f_0'(v)$ 非零的速度重合。更重要的是，在 $v=v_{ph}$ 处没有粒子能与波发生共振。这就是没有朗道阻尼的物理原因。\n\n相比之下，对于麦克斯韦平衡分布 $f_M(v) \\propto \\exp(-v^2/v_{th}^2)$，该函数及其导数对所有速度都非零。麦克斯韦分布具有“指数尾”，意味着在任何速度下（无论多高）都存在少量但有限的粒子。当电子等离子体波传播时，其相速度 $v_{ph}$ 通常大于热速度 $v_{th}$，但由于指数尾的存在，总有粒子的速度满足 $v \\approx v_{ph}$。导数 $f_M'(v_{ph})$ 非零（且对于 $v_{ph}  0$ 为负），导致能量从波净转移到粒子，从而产生波阻尼。\n\n在数学上，差异在于速度积分的解析性质。\n对于水袋分布，$f_0(v)$ 的紧支集导致色散关系是关于 $\\omega^2$ 的一个简单代数（有理）函数。$\\omega$ 的解是这个代数方程的根，而这些根恰好是纯实数。\n对于麦克斯韦分布，$f_0(v)$ 的无限支集导致色散函数涉及超越的等离子体色散函数 $Z(\\zeta)$，其中 $\\zeta = \\omega/(k v_{th})$。对于实数宗量，该函数是复数，这从根本上为任何实数 $k$ 的频率 $\\omega$ 引入了虚部。这一数学特征反映了在所有速度上都存在连续的共振粒子的物理事实。水袋分布中指数尾的缺失，有效地消除了产生朗道阻尼的数学结构。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在理解了共振粒子的关键作用后，我们需要一个普适的准则来判断等离子体系统是稳定（阻尼）还是不稳定（增长）。彭罗斯判据（Penrose criterion）为此提供了坚实的理论基础，它通过分析速度分布函数的形态来预测静电波的行为。本练习将应用彭罗斯判据于一个双束流等离子体模型 ，以精确确定系统从稳定向不稳定转变的临界条件，从而加深对动理学不稳定性的理解。",
            "id": "4000840",
            "problem": "考虑一维、无碰撞、无磁化的电子等离子体，其中不动的离子提供中性化背景。设未受扰动的电子速度分布函数模型为两个密度相等、温度相同、漂移速度大小相等方向相反的漂移麦克斯韦分布的叠加（对称双流状态），其形式为\n$$\nf_{0}(v) = \\frac{n_{e}}{2} \\frac{1}{\\sqrt{\\pi} v_{th}} \\left[ \\exp\\!\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\!\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right],\n$$\n其中，$n_{e}$ 是电子数密度，$U$ 是每束电子流的漂移速率大小，$v_{th} = \\sqrt{2 k_{B} T_{e} / m_{e}}$ 是与电子温度 $T_{e}$ 和电子质量 $m_{e}$ 相关的热速率，$k_{B}$ 是玻尔兹曼常数。\n\n从弗拉索夫-泊松系统的线性静电响应出发，并使用彭罗斯判据，确定区分稳定与不稳定行为的比值 $U / v_{th}$ 的精确阈值。具体来说，找到临界值 $U_{c}$，使得对于某个实波数 $k$，存在不稳定的静电模式当且仅当 $U  U_{c}$，而当 $U \\le U_{c}$ 时没有不稳定的模式。将您的最终答案表示为无量纲比值 $U_{c} / v_{th}$ 的单个闭合形式解析表达式。不需要进行数值取整，且您的答案必须是无量纲的。",
            "solution": "用户想要找出一维、无碰撞、无磁化电子等离子体中双流不稳定性的阈值。\n\n### 步骤1：问题验证\n\n在尝试任何解答之前，该问题经过了严格的验证过程。\n\n#### 步骤1.1：提取已知条件\n- **系统**：一维、无碰撞、无磁化的电子等离子体，其中不动的正离子提供中性化背景。\n- **未受扰动的电子速度分布函数**：\n$$\nf_{0}(v) = \\frac{n_{e}}{2} \\frac{1}{\\sqrt{\\pi} v_{th}} \\left[ \\exp\\!\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\!\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n- **变量定义**：\n  - $n_{e}$：电子数密度\n  - $v$：电子速度\n  - $U$：每束电子流的漂移速率大小\n  - $v_{th}$：电子热速率，定义为 $v_{th} = \\sqrt{2 k_{B} T_{e} / m_{e}}$\n  - $T_{e}$：电子温度\n  - $m_{e}$：电子质量\n  - $k_{B}$：玻尔兹曼常数\n- **方法**：分析将基于弗拉索夫-泊松系统的线性静电响应，并使用彭罗斯判据。\n- **目标**：确定漂移速度 $U$ 的精确临界值 $U_{c}$，使得存在不稳定的静电模式当且仅当 $U  U_{c}$。最终答案必须是无量纲比值 $U_{c} / v_{th}$。\n\n#### 步骤1.2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了经典的双流不稳定性，这是等离子体动理学理论中的一个基本概念。弗拉索夫-泊松系统是描述此现象的标准模型，而彭罗斯判据是确定动理学不稳定性起始的正确且严谨的工具。所提供的分布函数是对称双流系统的标准表示。该问题在科学上是合理的。\n2.  **适定性**：该问题是适定的。它提供了一个具体、良态的分布函数，并要求一个唯一定义的稳定性阈值。所有参数都已明确定义。\n3.  **客观性**：该问题以精确、客观和标准的科学语言陈述，没有歧义或主观论断。\n\n#### 步骤1.3：结论与行动\n该问题被认定为有效，因为它在科学上是合理的、适定的和客观的。没有矛盾、信息缺失或违反物理原理之处。因此，我将继续进行完整的解题推导。\n\n### 步骤2：解题推导\n\n等离子体的稳定性由彭罗斯判据决定，该判据源于线性弗拉索夫-泊松色散关系。该判据指出，存在不稳定性的条件（即对于某个实波数 $k$，色散关系存在 $\\text{Im}(\\omega)  0$ 的解）是当且仅当分布函数 $f_0(v)$ 在某个速度 $v=v_m$ 处有局部极小值，使得彭罗斯积分为正：\n$$\n\\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{f_0'(v)}{v - v_m} dv  0\n$$\n其中 $\\mathcal{P}$ 表示柯西主值。对于对称双流分布，一个更简单且等价的条件是速度分布函数 $f_0(v)$ 在 $v=0$ 处存在一个局部极小值。\n\n因此，我们将找出给定分布函数 $f_0(v)$ 出现局部极小值的条件。\n分布函数为：\n$$\nf_{0}(v) = C \\left[ \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n其中 $C = \\frac{n_{e}}{2 \\sqrt{\\pi} v_{th}}$ 是一个正常数。\n\n该函数关于 $v=0$ 对称，即 $f_0(v) = f_0(-v)$。极值将出现在一阶导数为零的地方，即 $\\frac{df_0}{dv} = 0$。\n$f_0(v)$ 对 $v$ 的一阶导数为：\n$$\n\\frac{df_0}{dv} = C \\left[ \\left( -\\frac{2(v - U)}{v_{th}^{2}} \\right) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\left( -\\frac{2(v + U)}{v_{th}^{2}} \\right) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\frac{df_0}{dv} = -\\frac{2C}{v_{th}^{2}} \\left[ (v - U) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + (v + U) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n我们在 $v=0$ 处检验极值。计算在 $v=0$ 处的导数：\n$$\n\\left. \\frac{df_0}{dv} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ (-U) \\exp\\left( - \\frac{(-U)^{2}}{v_{th}^{2}} \\right) + (U) \\exp\\left( - \\frac{U^{2}}{v_{th}^{2}} \\right) \\right] = -\\frac{2C}{v_{th}^{2}} [ -U + U ] \\exp\\left( - \\frac{U^{2}}{v_{th}^{2}} \\right) = 0\n$$\n因此，$v=0$ 始终是分布函数的一个极值点。要确定它是局部极小值还是局部极大值，我们必须检验在 $v=0$ 处二阶导数 $\\frac{d^2f_0}{dv^2}$ 的符号。正号表示局部极小值（不稳定），而负号表示局部极大值（稳定）。稳定与不稳定之间的过渡发生在临界点，此时极值点变为一个平坦的拐点，即 $\\frac{d^2f_0}{dv^2}|_{v=0} = 0$。\n\n我们计算 $f_0(v)$ 的二阶导数：\n$$\n\\frac{d^2f_0}{dv^2} = -\\frac{2C}{v_{th}^{2}} \\frac{d}{dv} \\left[ (v - U) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + (v + U) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n使用乘法法则，形如 $(v-a) \\exp(-(v-a)^2/b^2)$ 的项的导数是 $\\left[1 - \\frac{2(v-a)^2}{b^2}\\right] \\exp(-(v-a)^2/b^2)$。应用此法则，我们得到：\n$$\n\\frac{d^2f_0}{dv^2} = -\\frac{2C}{v_{th}^{2}} \\left[ \\left(1 - \\frac{2(v - U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(v - U)^2}{v_{th}^{2}} \\right) + \\left(1 - \\frac{2(v + U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(v + U)^2}{v_{th}^{2}} \\right) \\right]\n$$\n现在，我们在极值点 $v=0$ 处计算该表达式的值：\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ \\left(1 - \\frac{2(-U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(-U)^2}{v_{th}^{2}} \\right) + \\left(1 - \\frac{2(U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ 2 \\left(1 - \\frac{2U^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{4C}{v_{th}^{2}} \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\left(1 - \\frac{2U^2}{v_{th}^2}\\right)\n$$\n如果 $v=0$ 是一个局部极小值，则存在不稳定性，这要求 $\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0}  0$。因子 $-\\frac{4C}{v_{th}^{2}} \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right)$ 始终为负。因此，不稳定的条件变为：\n$$\n1 - \\frac{2U^2}{v_{th}^2}  0 \\implies 1  \\frac{2U^2}{v_{th}^2} \\implies U^2  \\frac{v_{th}^2}{2} \\implies U  \\frac{v_{th}}{\\sqrt{2}}\n$$\n反之，如果 $v=0$ 是一个局部极大值，系统是稳定的，这要求 $\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0}  0$。这导致：\n$$\n1 - \\frac{2U^2}{v_{th}^2}  0 \\implies U  \\frac{v_{th}}{\\sqrt{2}}\n$$\n区分稳定和不稳定区域的临界阈值 $U_c$ 是使二阶导数为零的 $U$ 值。这标志着从单峰分布（稳定）到在 $v=0$ 处有极小值的双峰分布（不稳定）的转变。\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = 0 \\implies 1 - \\frac{2U_c^2}{v_{th}^2} = 0\n$$\n求解 $U_c$：\n$$\n\\frac{2U_c^2}{v_{th}^2} = 1 \\implies U_c^2 = \\frac{v_{th}^2}{2}\n$$\n由于 $U_c$ 是速率大小，它必须是非负的。取正平方根：\n$$\nU_c = \\frac{v_{th}}{\\sqrt{2}}\n$$\n问题要求无量纲比值 $U_c / v_{th}$。\n$$\n\\frac{U_c}{v_{th}} = \\frac{1}{\\sqrt{2}}\n$$\n这是精确的阈值。对于 $U  U_c$，分布在 $v=0$ 处有一个局部极小值，满足彭罗斯判据的不稳定性条件。对于 $U \\le U_c$，分布在 $v=0$ 处有一个单峰（或在 $U=U_c$ 时为平顶），系统是稳定的。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2}}}\n$$"
        },
        {
            "introduction": "理论分析揭示了能量交换是朗道阻尼的核心，而计算物理则让我们能够直接“观测”这一过程。本练习要求您构建一个弗拉索夫-泊松方程的数值求解器，并实现一个“场-粒子关联”诊断工具 。通过这个强大的工具，您可以实时测量不同速度的粒子对波能量的贡献，从而在速度空间中精确定位发生能量交换的共振区域，为朗道阻尼的微观机理提供最直观的证据。",
            "id": "4000790",
            "problem": "考虑一个无量纲单位下，离子静止不动的一维、单速度静电 Vlasov–Poisson 系统。设电子分布函数为 $f(x,v,t)$，电场为 $E(x,t)$，电子电荷为 $q=-1$，电子质量为 $m=1$。控制方程为 Vlasov 方程和 Poisson 方程：\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\n在 $x$ 方向采用周期性边界条件，速度域被截断为 $v \\in [-v_{\\max}, v_{\\max}]$，其选择要足够大，以使 $f$ 在边界处可以忽略不计。初始条件是麦克斯韦分布的一个弱扰动空间模式：\n$$\nf(x,v,0) = f_0(v)\\left[1 + \\alpha \\cos(k x)\\right], \\quad f_0(v) = \\frac{1}{\\sqrt{2\\pi} v_{\\mathrm{th}}}\\exp\\left(-\\frac{v^2}{2 v_{\\mathrm{th}}^2}\\right),\n$$\n其中 $k$ 是扰动的基波数，$α$ 是扰动振幅，$v_{\\mathrm{th}}$ 是电子热速度。\n\n定义速度分辨的场-粒子关联诊断量，用于测量在每个速度上从场到粒子的时间平均能量转移密度：\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\n其中 $\\langle \\cdot \\rangle_{x,t}$ 表示在空间和模拟时间间隔上的平均值。与朗道阻尼相关的共振速度 $v_{\\mathrm{res}}$ 被确定为使 $C(v)$ 达到最大值的速度 $v \\ge 0$。\n\n您的任务是为上述 Vlasov–Poisson 系统实现一个无量纲数值求解器，该求解器使用 Strang 分裂半拉格朗日格式，其中 $x$ 方向为周期性平流，$v$ 方向为线性插值平流，并与 Poisson 方程的傅里叶空间求解器耦合。然后实现场-粒子关联诊断 $C(v)$，并对每个指定的测试用例，计算并返回 $v_{\\mathrm{res}}$。\n\n使用以下域和离散化选择：\n- 空间域长度 $L = 2\\pi$，$x$ 方向周期性。\n- 空间网格点数 $N_x = 64$。\n- 速度域 $v \\in [-v_{\\max}, v_{\\max}]$，其中 $v_{\\max} = 5$。\n- 速度网格点数 $N_v = 256$。\n- 时间步长 $\\Delta t = 0.05$。\n- 时间步数 $N_t = 300$。\n- 电子热速度 $v_{\\mathrm{th}} = 1$。\n\n为每个时间步 $n$ 实现 Strang 分裂：\n1. $v$ 方向半步：使用当前电场 $E^n(x)$，沿 $v$ 特征线对 $f$ 进行 $\\Delta t/2$ 的平流。\n2. $x$ 方向全步：使用粒子速度，沿 $x$ 特征线对 $f$ 进行 $\\Delta t$ 的平流，并采用周期性边界条件。\n3. 更新电场：根据更新后的 $f$ 求解 Poisson 方程以获得 $E^{n+1}(x)$。\n4. $v$ 方向半步：使用 $E^{n+1}(x)$，沿 $v$ 特征线对 $f$ 进行 $\\Delta t/2$ 的平流。\n\n在每个完整时间步，通过对 $x$ 进行平均并随时间累加，使用瞬时 $E(x,t)$ 和 $f(x,v,t)$ 来累积 $C(v)$，最后除以样本数量以获得时间平均值。通过选择使 $C(v)$ 最大化的速度 $v \\ge 0$ 来确定 $v_{\\mathrm{res}}$。\n\n所有量均为无量纲。每个测试用例所需的输出是单个浮点数 $v_{\\mathrm{res}}$。程序必须处理以下参数值的测试套件：\n- 测试用例 1：$k = 1$, $\\alpha = 10^{-3}$。\n- 测试用例 2：$k = 2$, $\\alpha = 10^{-3}$。\n- 测试用例 3：$k = 3$, $\\alpha = 5 \\times 10^{-4}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3]$），其中每个 $r_i$ 是为测试用例 $i$ 计算出的浮点数 $v_{\\mathrm{res}}$。",
            "solution": "该问题的基础是静电 Vlasov–Poisson 系统，在一维空间和一维速度下可写为\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\n其中 $q=-1$，$m=1$，且在 $x$ 方向采用周期性边界条件。从第一性原理出发，Vlasov 方程表示了沿运动特征线的相空间平流：粒子以速度 $v$ 在位置上平移，并根据加速度 $a = q E$ 在速度上平移。Poisson 方程将电场的空间导数与净电荷密度联系起来，此处净电荷密度是恒定离子背景（归一化为 $1$）与电子密度 $n_e(x,t) = \\int f(x,v,t)\\, dv$ 之间的差值。\n\n由于电场引起的电子动能密度 $W(x,t) = \\int \\frac{1}{2} m v^2 f(x,v,t)\\, dv$ 的变化率，可以通过将 Vlasov 方程乘以 $\\frac{1}{2} m v^2$ 并对 $v$ 积分得到：\n$$\n\\frac{\\partial W}{\\partial t} = \\int \\frac{1}{2} m v^2 \\left[ - v \\frac{\\partial f}{\\partial x} - q E \\frac{\\partial f}{\\partial v} \\right] dv.\n$$\n空间平流项变为动能通量在 $x$ 方向的散度，在周期性域中进行空间平均时，对净场-粒子能量交换率没有贡献。对于速度平流项，在 $v$ 上进行分部积分（假设在速度边界处 $f \\to 0$ 且 $m=1$）：\n$$\n\\int \\frac{1}{2} v^2 \\left(- q E \\frac{\\partial f}{\\partial v} \\right) dv = q E \\int v f \\, dv.\n$$\n因此，在位置 $x$ 处，从场到电子的瞬时能量转移密度率为\n$$\n\\dot{W}(x,t) = \\int q\\, E(x,t)\\, v\\, f(x,v,t)\\, dv.\n$$\n为了将此转移解析为速度的函数，定义速度分辨的场-粒子关联诊断量\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\n其中 $\\langle \\cdot \\rangle_{x,t}$ 表示在空间和模拟时间间隔上的平均值。在波数为 $k$ 的单个静电模式的朗道阻尼存在下，共振能量交换局域在相速度 $v_\\phi \\approx \\omega/k$ 附近，其中 $ω$ 是该模式的实频率。因此，使 $C(v)$ 在 $v \\ge 0$ 处达到峰值的速度 $v$ 确定了对阻尼有贡献的共振速度：\n$$\nv_{\\mathrm{res}} = \\arg\\max_{v \\ge 0} \\, C(v).\n$$\n\n算法设计：\n- 将空间域 $x \\in [0,L)$ 离散为 $N_x$ 个点并采用周期性边界条件，将速度域 $v \\in [-v_{\\max}, v_{\\max}]$ 离散为 $N_v$ 个点。\n- 将 $f(x,v,0)$ 初始化为具有热速度 $v_{\\mathrm{th}}$ 的弱扰动麦克斯韦分布 $f_0(v)\\left[1 + \\alpha \\cos(kx)\\right]$。\n- 使用 Strang 分裂法在时间上推进 $f$：\n  - 速度半步平流：对于每个空间点 $x_i$，通过 $v$ 网格上的半拉格朗日线性插值（边界索引采用截断方式）实现分布在 $v$ 方向的平流，平流量为 $\\Delta v = a(x_i)\\, \\Delta t/2$，其中 $a(x_i) = q E(x_i)$。\n  - 空间全步平流：对于每个速度点 $v_j$，通过 $x$ 网格上的半拉格朗日线性插值（使用整数位移和线性分数插值进行周期性回绕）实现分布在 $x$ 方向的平流，平流量为 $\\Delta x = v_j\\, \\Delta t$。\n  - 在傅里叶空间中求解 Poisson 方程：通过数值积分（离散求和乘以 $\\Delta v$）计算电子密度 $n_e(x) = \\int f(x,v)\\, dv$，形成电荷密度 $\\rho(x) = 1 - n_e(x)$，对其进行离散傅里叶变换得到 $\\hat{\\rho}(k_n)$，然后对于每个波数为 $k_n$ 的非零傅里叶模式，获得 $\\hat{E}(k_n) = - i\\, \\hat{\\rho}(k_n)/k_n$，并进行逆变换得到 $E(x)$；将 $\\hat{E}$ 的零模式设置为零以强制周期性中性。\n  - 使用更新后的电场进行速度半步平流。\n- 在每个完整时间步，通过计算每个速度上 $q\\, E(x,t)\\, v\\, f(x,v,t)$ 的空间平均值并随时间累加来累积相关性 $C(v)$，最后除以样本数以获得时间平均值。\n- 通过找到使 $C(v)$ 最大的速度 $v \\ge 0$ 来确定 $v_{\\mathrm{res}}$。\n\n数值细节：\n- 选择 $L = 2\\pi$，$N_x = 64$，$v_{\\max} = 5$，$N_v = 256$，$\\Delta t = 0.05$，$N_t = 300$，以及 $v_{\\mathrm{th}} = 1$。\n- 初始扰动使用 $k \\in \\{1,2,3\\}$，以与周期域的离散傅里叶模式对齐。\n- 使用较小的 $\\alpha$（例如，$\\alpha = 10^{-3}$ 或 $\\alpha = 5 \\times 10^{-4}$），以保持在近似线性朗道阻尼的弱非线性区域。\n- 速度平流在边界附近使用截断插值；通过选择合适的 $v_{\\max}$ 使得对于给定的 $v_{\\mathrm{th}}$，$f$ 在边界处可忽略不计，从而最小化截断误差。\n\n测试套件和输出：\n- 测试用例 1：$k = 1$, $\\alpha = 10^{-3}$。\n- 测试用例 2：$k = 2$, $\\alpha = 10^{-3}$。\n- 测试用例 3：$k = 3$, $\\alpha = 5 \\times 10^{-4}$。\n对于每个测试用例，计算 $C(v)$ 并以浮点数形式返回 $v_{\\mathrm{res}}$。程序必须打印单行，其中包含一个用方括号括起来的三个结果的逗号分隔列表，例如 $[r_1,r_2,r_3]$。\n\n此方法严格遵循基本的 Vlasov–Poisson 动力学，从动能方程推导出速度分辨的能量转移诊断量，并实现了一种稳健的半拉格朗日数值方法，适用于捕捉朗道阻尼并通过相关性 $C(v)$ 识别共振速度。",
            "answer": "```python\nimport numpy as np\n\n# Vlasov-Poisson 1D1V solver with field–particle correlation diagnostic\n# Dimensionless units: q = -1, m = 1, L = 2*pi, v_th = 1\n\ndef maxwellian(v, v_th):\n    return (1.0 / (np.sqrt(2.0 * np.pi) * v_th)) * np.exp(-0.5 * (v / v_th) ** 2)\n\ndef solve_poisson(ne, dx, L):\n    # Solve dE/dx = 1 - ne using FFT with periodic boundary conditions\n    rho = 1.0 - ne  # Charge density (ions = 1)\n    rho_k = np.fft.fft(rho)\n    kfreq = np.fft.fftfreq(ne.size, d=dx)  # cycles per unit length\n    k = 2.0 * np.pi * kfreq  # angular wavenumbers\n    E_k = np.zeros_like(rho_k, dtype=np.complex128)\n    nonzero = k != 0.0\n    E_k[nonzero] = -1j * rho_k[nonzero] / k[nonzero]\n    E_k[~nonzero] = 0.0 + 0.0j  # enforce neutrality\n    E = np.fft.ifft(E_k).real\n    return E\n\ndef advect_x(f, vgrid, dt, dx):\n    # Semi-Lagrangian advection in x with periodic boundary\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    for j in range(Nv):\n        s = vgrid[j] * dt / dx\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        # Linear interpolation between shifted fields\n        out[:, j] = (1.0 - a) * np.roll(f[:, j], n) + a * np.roll(f[:, j], n + 1)\n    return out\n\ndef advect_v(f, E, dt, dv):\n    # Semi-Lagrangian advection in v with clamped boundary indices\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    j = np.arange(Nv)\n    for i in range(Nx):\n        s = (-E[i]) * dt / dv  # dv/dt = qE/m = -E\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        j0 = j - n\n        j1 = j - n - 1\n        j0 = np.clip(j0, 0, Nv - 1)\n        j1 = np.clip(j1, 0, Nv - 1)\n        out[i, :] = (1.0 - a) * f[i, j0] + a * f[i, j1]\n    return out\n\ndef run_case(k_mode, alpha, params):\n    # Unpack parameters\n    L = params['L']\n    Nx = params['Nx']\n    Nv = params['Nv']\n    vmax = params['vmax']\n    dt = params['dt']\n    Nt = params['Nt']\n    v_th = params['v_th']\n    q = -1.0\n\n    # Grids\n    x = np.linspace(0.0, L, Nx, endpoint=False)\n    v = np.linspace(-vmax, vmax, Nv)\n    dx = x[1] - x[0]\n    dv = v[1] - v[0]\n\n    # Initial distribution: weakly perturbed Maxwellian\n    f0 = maxwellian(v, v_th)  # shape (Nv,)\n    f = f0[None, :] * (1.0 + alpha * np.cos(k_mode * x)[:, None])  # shape (Nx, Nv)\n\n    # Initial field from Poisson\n    ne = np.sum(f, axis=1) * dv\n    E = solve_poisson(ne, dx, L)\n\n    # Correlation accumulator C(v)\n    C = np.zeros(Nv)\n\n    # Time loop with Strang splitting\n    for _ in range(Nt):\n        # Half-step in v\n        f = advect_v(f, E, dt * 0.5, dv)\n        # Full-step in x\n        f = advect_x(f, v, dt, dx)\n        # Update field\n        ne = np.sum(f, axis=1) * dv\n        E = solve_poisson(ne, dx, L)\n        # Half-step in v with updated field\n        f = advect_v(f, E, dt * 0.5, dv)\n\n        # Accumulate correlation C(v) =  q E v f _{x}\n        Ef = (E[:, None] * f)  # shape (Nx, Nv)\n        C += q * v * (Ef.mean(axis=0))\n\n    # Time-average\n    C /= Nt\n\n    # Identify resonant velocity v_res for v = 0 as location of maximum C(v)\n    pos_mask = v = 0.0\n    v_pos = v[pos_mask]\n    C_pos = C[pos_mask]\n    idx = int(np.argmax(C_pos))\n    v_res = float(v_pos[idx])\n    return v_res\n\ndef solve():\n    # Simulation parameters\n    params = {\n        'L': 2.0 * np.pi,\n        'Nx': 64,\n        'Nv': 256,\n        'vmax': 5.0,\n        'dt': 0.05,\n        'Nt': 300,\n        'v_th': 1.0,\n    }\n\n    # Test cases: (k, alpha)\n    test_cases = [\n        (1, 1e-3),\n        (2, 1e-3),\n        (3, 5e-4),\n    ]\n\n    results = []\n    for k_mode, alpha in test_cases:\n        v_res = run_case(k_mode, alpha, params)\n        results.append(v_res)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}