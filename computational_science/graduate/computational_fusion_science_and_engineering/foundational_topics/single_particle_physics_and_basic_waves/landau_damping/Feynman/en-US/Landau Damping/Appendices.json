{
    "hands_on_practices": [
        {
            "introduction": "Landau damping is fundamentally a resonant process, relying on a population of particles that travel at nearly the same velocity as the wave. To build a sharp intuition for this, this exercise explores a hypothetical scenario using a \"waterbag\" distribution, which abruptly cuts off at a finite velocity. By analyzing wave propagation in this plasma, where resonant particles may be entirely absent, you will uncover the critical role of the velocity distribution's shape in enabling—or disabling—the damping mechanism .",
            "id": "4000814",
            "problem": "Consider an unmagnetized, one-dimensional, electrostatic electron plasma representative of core turbulence modeling in computational fusion science and engineering. Electrons obey the linearized Vlasov–Poisson system about a spatially homogeneous equilibrium with number density $n_{e}$ and a velocity distribution function $f_{0}(v)$ normalized so that $\\int_{-\\infty}^{\\infty} f_{0}(v)\\, dv = 1$. Assume singly charged ions provide a fixed neutralizing background. Let perturbations be proportional to $\\exp(i k x - i \\omega t)$ with real wavenumber $k$ and complex frequency $\\omega$.\n\nThe equilibrium electron distribution is a waterbag (top-hat) of finite width,\n$$\nf_{0}(v) = \\begin{cases}\n\\frac{1}{2 \\Delta}, & |v| \\le \\Delta, \\\\\n0, & |v| > \\Delta,\n\\end{cases}\n$$\nwith constant half-width $\\Delta > 0$.\n\nStarting from first principles, namely the linearized Vlasov equation for electrons and Poisson’s equation,\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} - \\frac{e}{m_{e}} E \\frac{\\partial f}{\\partial v} = 0, \\qquad \\frac{\\partial E}{\\partial x} = \\frac{e}{\\epsilon_{0}} \\left(n_{i} - n_{e} \\int_{-\\infty}^{\\infty} f\\, dv\\right),\n$$\nderive the dispersion relation in the standard dielectric form and compute the Landau damping rate $\\gamma$ of the electron plasma wave for the waterbag distribution. Use the Landau contour prescription for analytic continuation in the complex $\\omega$-plane. Express your final answer for the damping rate in $\\mathrm{s}^{-1}$.\n\nIn addition, explain, based on your derivation, how the absence of exponential tails in the waterbag distribution modifies resonance contributions relative to a Maxwellian equilibrium. Your explanation must be grounded in the structure of the velocity-space derivative of $f_{0}(v)$ and the analytic properties of the velocity integral.\n\nIf your final numerical result requires rounding, round your answer to four significant figures. If your final result is an exact closed-form analytic expression, provide it exactly with no rounding.",
            "solution": "The problem statement is critically evaluated and found to be valid. It presents a well-posed, scientifically grounded problem in plasma kinetic theory. Initially, the requirement to provide a numerical answer in units of $\\mathrm{s}^{-1}$ without supplying numerical values for plasma parameters ($n_e$, $\\Delta$) or wave parameters ($k$) suggests the problem is underspecified. However, a full derivation reveals that the Landau damping rate for the specified waterbag distribution is exactly zero, a result that is independent of any specific parameter values. Thus, the problem is self-contained and solvable as stated.\n\nThe problem asks for the derivation of the dispersion relation and the computation of the Landau damping rate for electron plasma waves in an unmagnetized plasma with a waterbag equilibrium distribution function.\n\nThe starting points are the linearized Vlasov and Poisson equations for electrons. The ion background is fixed and neutralizing.\nThe Vlasov equation for the perturbed electron distribution function, $f_1(x, v, t)$, linearized around the equilibrium $f_0(v)$, is:\n$$\n\\frac{\\partial f_1}{\\partial t} + v \\frac{\\partial f_1}{\\partial x} - \\frac{e E_1}{m_{e}} \\frac{d f_{0}}{d v} = 0\n$$\nwhere $E_1(x,t)$ is the perturbed electric field, $e$ is the elementary charge, and $m_e$ is the electron mass. We assume perturbations of the form $\\exp(i k x - i \\omega t)$, where $k$ is the real wavenumber and $\\omega = \\omega_r + i\\gamma$ is the complex frequency. Substituting this form into the linearized Vlasov equation gives:\n$$\n-i\\omega f_1 + ikv f_1 - \\frac{e E_1}{m_{e}} \\frac{d f_{0}}{d v} = 0\n$$\nSolving for the perturbed distribution function $f_1$ yields:\n$$\nf_1(v) = \\frac{e E_1}{m_{e}} \\frac{1}{i(kv - \\omega)} \\frac{d f_{0}}{d v} = -i \\frac{e E_1}{m_{e}} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v}\n$$\nNext, we use Poisson's equation. The problem statement gives $\\frac{\\partial E}{\\partial x} = \\frac{e}{\\epsilon_{0}} \\left(n_{i} - n_{e} \\int_{-\\infty}^{\\infty} f\\, dv\\right)$. The total distribution is $f = f_0 + f_1$. The ion density $n_i$ is constant and equal to the equilibrium electron density $n_e$ for neutrality. The perturbed electron density is $n_{e1} = n_e \\int_{-\\infty}^{\\infty} f_1(v) dv$.\nThe linearized Poisson equation becomes:\n$$\n\\frac{\\partial E_1}{\\partial x} = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} f_1(v) dv\n$$\nApplying the plane wave form $E_1 \\propto \\exp(ikx - i\\omega t)$, this becomes:\n$$\nik E_1 = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} f_1(v) dv\n$$\nAssuming a non-trivial wave mode ($E_1 \\neq 0$), we substitute the expression for $f_1(v)$:\n$$\nik E_1 = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} \\left( -i \\frac{e E_1}{m_{e}} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v} \\right) dv\n$$\nCanceling the common factor $i E_1$ from both sides gives:\n$$\nk = \\frac{n_e e^2}{m_e \\epsilon_0} \\int_{-\\infty}^{\\infty} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v} dv\n$$\nThe integral over velocity must be interpreted using the Landau contour prescription. For an initially growing wave, $\\Im(\\omega) > 0$, the pole at $v = \\omega/k$ is in the upper half of the complex velocity plane, and the integration path along the real velocity axis is well-defined. The result is then analytically continued to the entire complex $\\omega$-plane.\nRearranging the equation yields the general dispersion relation for electrostatic waves:\n$$\n1 = \\frac{\\omega_p^2}{k} \\int_{L} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v} dv = \\frac{\\omega_p^2}{k^2} \\int_{L} \\frac{f_0'(v)}{v - \\omega/k} dv\n$$\nwhere $\\omega_p^2 = \\frac{n_e e^2}{m_e \\epsilon_0}$ is the square of the electron plasma frequency, and $f_0'(v) = \\frac{d f_{0}}{d v}$. The standard form of the dielectric function is $\\epsilon(\\omega, k) = 1 - \\frac{\\omega_p^2}{k^2} \\int_{L} \\frac{f_0'(v)}{v - \\omega/k} dv$. The dispersion relation is given by $\\epsilon(\\omega, k) = 0$. Note that some conventions use a `+` sign. With our derivation, the relation is:\n$$\n1 + \\frac{\\omega_p^2}{k^2} \\int_L \\frac{f_0'(v)}{v - \\omega/k} dv = 0\n$$\nwhere we've used integration by parts on the initial expression:\n$\\int \\frac{f_0'}{\\omega-kv}dv = -\\int \\frac{f_0}{(\\omega-kv)^2}(-k)dv = k\\int \\frac{f_0}{(\\omega-kv)^2}dv$.\nOur derivation $k = \\frac{n_e e^2}{m_e \\epsilon_0} \\int \\frac{f_0'}{\\omega-kv}dv$ yields $1 = \\frac{\\omega_p^2}{k} \\int \\frac{f_0'}{\\omega-kv}dv$. This is $1 = \\frac{\\omega_p^2}{k^2} \\int \\frac{f_0'}{ \\omega/k - v}dv$. So $1 - \\frac{\\omega_p^2}{k^2} \\int \\frac{f_0'}{v - \\omega/k}dv = 0$.\n\nNow we apply this to the specific waterbag distribution:\n$$\nf_{0}(v) = \\begin{cases}\n\\frac{1}{2 \\Delta}, & |v| \\le \\Delta, \\\\\n0, & |v| > \\Delta.\n\\end{cases}\n$$\nThe derivative of this function is given in terms of Dirac delta functions:\n$$\nf_0'(v) = \\frac{d}{dv} \\left( \\frac{1}{2\\Delta} [H(v+\\Delta) - H(v-\\Delta)] \\right) = \\frac{1}{2\\Delta} [\\delta(v+\\Delta) - \\delta(v-\\Delta)]\n$$\nwhere $H(v)$ is the Heaviside step function.\nWe substitute this derivative into the velocity integral of the dispersion relation. Let $u = \\omega/k$.\n$$\n\\int_L \\frac{f_0'(v)}{v - u} dv = \\int_{-\\infty}^{\\infty} \\frac{1}{2\\Delta} \\frac{\\delta(v+\\Delta) - \\delta(v-\\Delta)}{v - u} dv\n$$\nUsing the sifting property of the delta function, $\\int g(x) \\delta(x-a) dx = g(a)$:\n$$\n\\int_L \\frac{f_0'(v)}{v - u} dv = \\frac{1}{2\\Delta} \\left( \\frac{1}{-\\Delta - u} - \\frac{1}{\\Delta - u} \\right) = \\frac{1}{2\\Delta} \\left( \\frac{-1}{\\Delta + u} - \\frac{1}{\\Delta - u} \\right)\n$$\n$$\n= \\frac{1}{2\\Delta} \\frac{-(\\Delta - u) - (\\Delta + u)}{(\\Delta+u)(\\Delta-u)} = \\frac{1}{2\\Delta} \\frac{-2\\Delta}{\\Delta^2 - u^2} = \\frac{1}{u^2 - \\Delta^2}\n$$\nThis result is valid for any complex $u$ as long as $u \\neq \\pm \\Delta$. The integral is an analytic function of $u$ except for simple poles at $u=\\pm \\Delta$. The Landau contour prescription is trivially satisfied as there are no singularities of the integrand on the real axis unless $u$ is real and equals $\\pm \\Delta$.\n\nSubstituting this result back into the dispersion relation $1 - \\frac{\\omega_p^2}{k^2} \\int \\frac{f_0'}{v - \\omega/k}dv = 0$:\n$$\n1 - \\frac{\\omega_p^2}{k^2} \\left( \\frac{1}{(\\omega/k)^2 - \\Delta^2} \\right) = 0\n$$\n$$\n1 = \\frac{\\omega_p^2}{k^2} \\frac{1}{\\omega^2/k^2 - \\Delta^2} = \\frac{\\omega_p^2}{\\omega^2 - k^2\\Delta^2}\n$$\nSolving for $\\omega^2$:\n$$\n\\omega^2 - k^2\\Delta^2 = \\omega_p^2\n$$\n$$\n\\omega^2 = \\omega_p^2 + k^2\\Delta^2\n$$\nSince $\\omega_p^2 > 0$, $k^2 \\ge 0$, and $\\Delta^2 > 0$, the right-hand side is a positive real number. The complex frequency $\\omega$ is therefore given by:\n$$\n\\omega = \\pm \\sqrt{\\omega_p^2 + k^2\\Delta^2}\n$$\nThe frequency $\\omega$ is purely real. The damping rate, $\\gamma$, is defined as the imaginary part of the frequency, $\\gamma = \\Im(\\omega)$.\nFrom our result, it is evident that for any real wavenumber $k$:\n$$\n\\gamma = 0\n$$\nThus, the electron plasma waves in a plasma with a waterbag distribution are undamped. The result is $0 \\ \\mathrm{s}^{-1}$.\n\nThe absence of damping can be explained by analyzing the resonance condition and the structure of $f_0'(v)$. Landau damping arises from the net exchange of energy between the wave and particles moving at or near the wave's phase velocity, $v_{ph} = \\Re(\\omega)/k = \\omega_r/k$. The rate of this energy exchange is proportional to the slope of the distribution function at the phase velocity, $f_0'(v_{ph})$.\n\nFor the waterbag distribution, the wave's phase velocity is:\n$$\n|v_{ph}| = \\frac{|\\omega_r|}{k} = \\frac{\\sqrt{\\omega_p^2 + k^2\\Delta^2}}{k} = \\sqrt{\\frac{\\omega_p^2}{k^2} + \\Delta^2}\n$$\nSince $\\omega_p^2/k^2 > 0$, it is clear that $|v_{ph}| > \\Delta$.\nThe waterbag distribution has a finite width, meaning there are no particles with velocities $|v| > \\Delta$. The derivative, $f_0'(v)$, is non-zero only at the precise velocities $v = \\pm\\Delta$. Since the wave's phase velocity $|v_{ph}|$ is strictly greater than $\\Delta$, it does not coincide with the velocities where $f_0'(v)$ is non-zero. More importantly, there are no particles at $v=v_{ph}$ to resonate with the wave. This is the physical reason for the absence of Landau damping.\n\nIn contrast, for a Maxwellian equilibrium distribution, $f_M(v) \\propto \\exp(-v^2/v_{th}^2)$, the function and its derivative are non-zero for all velocities. A Maxwellian distribution has \"exponential tails\", meaning there is a small but finite population of particles at any velocity, no matter how high. When an electron plasma wave propagates, its phase velocity $v_{ph}$ is typically greater than the thermal velocity $v_{th}$, but because of the tails, there are always particles with $v \\approx v_{ph}$. The derivative $f_M'(v_{ph})$ is non-zero (and negative for $v_{ph} > 0$), leading to a net transfer of energy from the wave to the particles, and thus wave damping.\n\nMathematically, the difference lies in the analytic properties of the velocity integral.\nFor the waterbag, the compact support of $f_0(v)$ leads to a dispersion relation that is a simple algebraic (rational) function of $\\omega^2$. The solutions for $\\omega$ are the roots of this algebraic equation, which turn out to be purely real.\nFor the Maxwellian, the infinite support of $f_0(v)$ leads to a dispersion function involving the transcendental plasma dispersion function, $Z(\\zeta)$, where $\\zeta = \\omega/(k v_{th}\\sqrt{2})$. This function is complex for real arguments, which fundamentally introduces an imaginary part to the frequency $\\omega$ for any real $k$. This mathematical feature reflects the physical presence of a continuum of resonant particles at all velocities. The absence of exponential tails in the waterbag distribution effectively eliminates the mathematical structure that gives rise to Landau damping.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "The resonant interaction between waves and particles can lead not only to damping but also to growth. This exercise explores the classic two-stream instability, a prime example of \"inverse\" Landau damping where the plasma free energy is channeled into an unstable electrostatic wave. Applying the powerful Penrose criterion, you will determine the precise threshold at which a double-humped distribution transitions from being stable to driving wave growth, highlighting the dual nature of wave-particle resonance .",
            "id": "4000840",
            "problem": "Consider a one-dimensional, collisionless, unmagnetized electron plasma with immobile ions providing neutralizing background. Let the unperturbed electron velocity distribution function be modeled as the superposition of two equal-density drifting Maxwellians (a symmetric two-stream state) with common temperature and opposite drift speeds, given by\n$$\nf_{0}(v) = \\frac{n_{e}}{2} \\frac{1}{\\sqrt{\\pi} v_{th}} \\left[ \\exp\\!\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\!\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right],\n$$\nwhere $n_{e}$ is the electron number density, $U$ is the magnitude of the drift speed of each stream, and $v_{th} = \\sqrt{2 k_{B} T_{e} / m_{e}}$ is the thermal speed associated with electron temperature $T_{e}$ and electron mass $m_{e}$, with $k_{B}$ the Boltzmann constant.\n\nStarting from the linear electrostatic response of the Vlasov–Poisson system and using the Penrose criterion, determine the exact threshold value of the ratio $U / v_{th}$ that separates stable from unstable behavior. Specifically, find the critical value $U_{c}$ such that for some real wavenumber $k$ there exist unstable electrostatic modes if and only if $U > U_{c}$, and there are no unstable modes for $U \\le U_{c}$. Express your final answer as a single closed-form analytic expression for the dimensionless ratio $U_{c} / v_{th}$. No numerical rounding is required, and your answer must be dimensionless.",
            "solution": "The user wants to find the threshold for two-stream instability in a one-dimensional, collisionless, unmagnetized electron plasma.\n\n### Step 1: Problem Validation\n\nThe problem is subjected to a rigorous validation process before any attempt at a solution.\n\n#### Step 1.1: Extract Givens\n- **System:** A one-dimensional, collisionless, unmagnetized electron plasma with immobile positive ions providing a neutralizing background.\n- **Unperturbed Electron Velocity Distribution Function:**\n$$\nf_{0}(v) = \\frac{n_{e}}{2} \\frac{1}{\\sqrt{\\pi} v_{th}} \\left[ \\exp\\!\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\!\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n- **Variable Definitions:**\n  - $n_{e}$: electron number density\n  - $v$: electron velocity\n  - $U$: magnitude of the drift speed of each electron stream\n  - $v_{th}$: electron thermal speed, defined as $v_{th} = \\sqrt{2 k_{B} T_{e} / m_{e}}$\n  - $T_{e}$: electron temperature\n  - $m_{e}$: electron mass\n  - $k_{B}$: Boltzmann constant\n- **Methodology:** The analysis is to be based on the linear electrostatic response of the Vlasov–Poisson system, using the Penrose criterion.\n- **Objective:** Determine the exact critical value $U_{c}$ of the drift speed $U$ such that unstable electrostatic modes exist if and only if $U > U_{c}$. The final answer must be the dimensionless ratio $U_{c} / v_{th}$.\n\n#### Step 1.2: Validate Using Extracted Givens\n1.  **Scientific Groundedness:** The problem describes the classic two-stream instability, a fundamental concept in plasma kinetic theory. The Vlasov–Poisson system is the standard model for this phenomenon, and the Penrose criterion is the correct and rigorous tool for determining the onset of kinetic instability. The provided distribution function is a standard representation of a symmetric two-stream system. The problem is scientifically sound.\n2.  **Well-Posedness:** The problem is well-posed. It provides a specific, well-behaved distribution function and asks for a uniquely defined stability threshold. All parameters are clearly defined.\n3.  **Objectivity:** The problem is stated in precise, objective, and standard scientific language, free from ambiguity or subjective claims.\n\n#### Step 1.3: Verdict and Action\nThe problem is found to be valid as it is scientifically grounded, well-posed, and objective. There are no contradictions, missing information, or violations of physical principles. Therefore, I will proceed with a full derivation of the solution.\n\n### Step 2: Derivation of the Solution\n\nThe stability of the plasma is governed by the Penrose criterion, which is derived from the linear Vlasov-Poisson dispersion relation. The criterion states that an instability exists (i.e., there is a solution to the dispersion relation with $\\text{Im}(\\omega) > 0$ for some real wavenumber $k$) if and only if the distribution function $f_0(v)$ has a local minimum at some velocity $v=v_m$ such that the Penrose integral is positive:\n$$\n\\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{f_0'(v)}{v - v_m} dv > 0\n$$\nwhere $\\mathcal{P}$ denotes the Cauchy principal value. A simpler, sufficient condition for instability is the mere existence of a local minimum in the velocity distribution function $f_0(v)$. For the symmetric two-stream distribution, this condition is found to be both necessary and sufficient.\n\nWe will therefore find the condition under which the given distribution function $f_0(v)$ develops a local minimum.\nThe distribution function is:\n$$\nf_{0}(v) = C \\left[ \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\nwhere $C = \\frac{n_{e}}{2 \\sqrt{\\pi} v_{th}}$ is a positive constant.\n\nThis function is symmetric with respect to $v=0$, i.e., $f_0(v) = f_0(-v)$. An extremum will occur where the first derivative is zero, $\\frac{df_0}{dv} = 0$.\nThe first derivative of $f_0(v)$ with respect to $v$ is:\n$$\n\\frac{df_0}{dv} = C \\left[ \\left( -\\frac{2(v - U)}{v_{th}^{2}} \\right) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\left( -\\frac{2(v + U)}{v_{th}^{2}} \\right) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\frac{df_0}{dv} = -\\frac{2C}{v_{th}^{2}} \\left[ (v - U) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + (v + U) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\nWe test for an extremum at $v=0$. Evaluating the derivative at $v=0$:\n$$\n\\left. \\frac{df_0}{dv} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ (-U) \\exp\\left( - \\frac{(-U)^{2}}{v_{th}^{2}} \\right) + (U) \\exp\\left( - \\frac{U^{2}}{v_{th}^{2}} \\right) \\right] = -\\frac{2C}{v_{th}^{2}} [ -U + U ] \\exp\\left( - \\frac{U^{2}}{v_{th}^{2}} \\right) = 0\n$$\nThus, $v=0$ is always an extremum of the distribution function. To determine whether it is a local minimum or a local maximum, we must examine the sign of the second derivative, $\\frac{d^2f_0}{dv^2}$, at $v=0$. A positive sign indicates a local minimum (instability), while a negative sign indicates a local maximum (stability). The transition between stability and instability occurs at the critical point where the extremum becomes a flat inflection point, i.e., $\\frac{d^2f_0}{dv^2}|_{v=0} = 0$.\n\nWe compute the second derivative of $f_0(v)$:\n$$\n\\frac{d^2f_0}{dv^2} = -\\frac{2C}{v_{th}^{2}} \\frac{d}{dv} \\left[ (v - U) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + (v + U) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\nUsing the product rule, the derivative of a term like $(v-a) \\exp(-(v-a)^2/b^2)$ is $\\left[1 - \\frac{2(v-a)^2}{b^2}\\right] \\exp(-(v-a)^2/b^2)$. Applying this, we get:\n$$\n\\frac{d^2f_0}{dv^2} = -\\frac{2C}{v_{th}^{2}} \\left[ \\left(1 - \\frac{2(v - U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(v - U)^2}{v_{th}^{2}} \\right) + \\left(1 - \\frac{2(v + U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(v + U)^2}{v_{th}^{2}} \\right) \\right]\n$$\nNow, we evaluate this expression at the extremum $v=0$:\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ \\left(1 - \\frac{2(-U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(-U)^2}{v_{th}^{2}} \\right) + \\left(1 - \\frac{2(U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ 2 \\left(1 - \\frac{2U^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{4C}{v_{th}^{2}} \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\left(1 - \\frac{2U^2}{v_{th}^2}\\right)\n$$\nAn instability exists if $v=0$ is a local minimum, which requires $\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} > 0$. The factor $-\\frac{4C}{v_{th}^{2}} \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right)$ is always negative. Therefore, the condition for instability becomes:\n$$\n1 - \\frac{2U^2}{v_{th}^2} < 0 \\implies 1 < \\frac{2U^2}{v_{th}^2} \\implies U^2 > \\frac{v_{th}^2}{2} \\implies U > \\frac{v_{th}}{\\sqrt{2}}\n$$\nConversely, the system is stable if $v=0$ is a local maximum, which requires $\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} < 0$. This leads to:\n$$\n1 - \\frac{2U^2}{v_{th}^2} > 0 \\implies U < \\frac{v_{th}}{\\sqrt{2}}\n$$\nThe critical threshold $U_c$ that separates the stable and unstable regimes is the value of $U$ for which the second derivative is zero. This marks the transition from a single-peaked distribution (stable) to a double-peaked distribution with a minimum at $v=0$ (unstable).\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = 0 \\implies 1 - \\frac{2U_c^2}{v_{th}^2} = 0\n$$\nSolving for $U_c$:\n$$\n\\frac{2U_c^2}{v_{th}^2} = 1 \\implies U_c^2 = \\frac{v_{th}^2}{2}\n$$\nSince $U_c$ is a speed magnitude, it must be non-negative. Taking the positive square root:\n$$\nU_c = \\frac{v_{th}}{\\sqrt{2}}\n$$\nThe problem asks for the dimensionless ratio $U_c / v_{th}$.\n$$\n\\frac{U_c}{v_{th}} = \\frac{1}{\\sqrt{2}}\n$$\nThis is the exact threshold. For $U > U_c$, the distribution has a local minimum at $v=0$, satisfying the Penrose criterion for instability. For $U \\le U_c$, the distribution has a single maximum at $v=0$ (or a flat top at $U=U_c$), and the system is stable.",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2}}}\n$$"
        },
        {
            "introduction": "While analytical theory provides the foundation, computational physics offers direct insight into the dynamics of Landau damping. This practice challenges you to implement a Vlasov-Poisson solver and a field-particle correlation diagnostic, a tool used in modern research to measure the flow of energy between the electric field and particles at each velocity. By simulating the process, you will numerically identify the resonant velocity and visualize the energy exchange that underpins the damping phenomenon, bridging the gap between abstract theory and tangible results .",
            "id": "4000790",
            "problem": "Consider a one-dimensional, one-velocity electrostatic Vlasov–Poisson system for electrons with immobile ions in dimensionless units. Let the electron distribution function be $f(x,v,t)$, the electric field be $E(x,t)$, the electron charge be $q=-1$, and the electron mass be $m=1$. The governing equations are the Vlasov equation and Poisson’s equation:\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\nwith periodic boundary conditions in $x$ and truncated velocity domain $v \\in [-v_{\\max}, v_{\\max}]$ chosen large enough that $f$ is negligible at the boundaries. The initial condition is a weakly perturbed spatial mode of a Maxwellian:\n$$\nf(x,v,0) = f_0(v)\\left[1 + \\alpha \\cos(k x)\\right], \\quad f_0(v) = \\frac{1}{\\sqrt{2\\pi} v_{\\mathrm{th}}}\\exp\\left(-\\frac{v^2}{2 v_{\\mathrm{th}}^2}\\right),\n$$\nwhere $k$ is the fundamental wavenumber of the perturbation, $\\alpha$ is the perturbation amplitude, and $v_{\\mathrm{th}}$ is the electron thermal speed.\n\nDefine the velocity-resolved field–particle correlation diagnostic that measures the time-averaged energy transfer density from the field to particles at each velocity:\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\nwhere $\\langle \\cdot \\rangle_{x,t}$ denotes an average over space and over the simulation time interval. The resonant velocity $v_{\\mathrm{res}}$ associated with Landau damping is identified as the velocity $v \\ge 0$ at which $C(v)$ attains its maximum value.\n\nYour task is to implement a dimensionless numerical solver for the above Vlasov–Poisson system using a Strang-splitting semi-Lagrangian scheme with periodic advection in $x$ and linear-interpolation advection in $v$, coupled with a Fourier-space solver for Poisson’s equation. Then implement the field–particle correlation diagnostic $C(v)$ and, for each specified test case, compute and return $v_{\\mathrm{res}}$.\n\nUse the following domain and discretization choices:\n- Spatial domain length $L = 2\\pi$, periodic in $x$.\n- Number of spatial grid points $N_x = 64$.\n- Velocity domain $v \\in [-v_{\\max}, v_{\\max}]$ with $v_{\\max} = 5$.\n- Number of velocity grid points $N_v = 256$.\n- Time step $\\Delta t = 0.05$.\n- Number of time steps $N_t = 300$.\n- Electron thermal speed $v_{\\mathrm{th}} = 1$.\n\nImplement the Strang splitting for each time step $n$:\n1. Half-step in $v$: advect $f$ along the $v$-characteristics using the current field $E^n(x)$ for $\\Delta t/2$.\n2. Full-step in $x$: advect $f$ along the $x$-characteristics using the particle velocities for $\\Delta t$ with periodic boundary conditions.\n3. Update the field: solve Poisson’s equation to obtain $E^{n+1}(x)$ from the updated $f$.\n4. Half-step in $v$: advect $f$ along the $v$-characteristics using $E^{n+1}(x)$ for $\\Delta t/2$.\n\nAt each full time step, accumulate $C(v)$ using the instantaneous $E(x,t)$ and $f(x,v,t)$ by averaging over $x$ and summing over time, and finally divide by the number of samples to obtain the time average. Identify $v_{\\mathrm{res}}$ by selecting the velocity $v \\ge 0$ at which $C(v)$ is maximized.\n\nAll quantities are dimensionless. The required output for each test case is a single float $v_{\\mathrm{res}}$. The program must process the following test suite of parameter values:\n- Test case $1$: $k = 1$, $\\alpha = 10^{-3}$.\n- Test case $2$: $k = 2$, $\\alpha = 10^{-3}$.\n- Test case $3$: $k = 3$, $\\alpha = 5 \\times 10^{-4}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3]$), where each $r_i$ is the computed $v_{\\mathrm{res}}$ for test case $i$ as a float.",
            "solution": "The foundation of the problem is the electrostatic Vlasov–Poisson system, which in one dimension and one velocity dimension can be written as\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\nwith $q=-1$ and $m=1$, and periodic boundary conditions in $x$. Starting from first principles, the Vlasov equation expresses phase-space advection along characteristics of motion: particles translate in position with velocity $v$ and in velocity according to acceleration $a = q E$. The Poisson equation relates the spatial derivative of the electric field to the net charge density, here the difference between the constant ion background (normalized to $1$) and the electron density $n_e(x,t) = \\int f(x,v,t)\\, dv$.\n\nThe rate of change of the electron kinetic energy density $W(x,t) = \\int \\frac{1}{2} m v^2 f(x,v,t)\\, dv$ due to the electric field follows from the Vlasov equation by multiplying by $\\frac{1}{2} m v^2$ and integrating over $v$:\n$$\n\\frac{\\partial W}{\\partial t} = \\int \\frac{1}{2} m v^2 \\left[ - v \\frac{\\partial f}{\\partial x} - q E \\frac{\\partial f}{\\partial v} \\right] dv.\n$$\nThe spatial-advection term becomes a divergence in $x$ of the kinetic energy flux and does not contribute to the net field–particle energy exchange rate when spatially averaged in a periodic domain. For the velocity-advection term, integrate by parts in $v$ (assuming $f \\to 0$ at the velocity boundaries and $m=1$):\n$$\n\\int \\frac{1}{2} v^2 \\left(- q E \\frac{\\partial f}{\\partial v} \\right) dv = q E \\int v f \\, dv.\n$$\nTherefore, the instantaneous rate of energy transfer density from the field to the electrons at position $x$ is\n$$\n\\dot{W}(x,t) = \\int q\\, E(x,t)\\, v\\, f(x,v,t)\\, dv.\n$$\nTo resolve this transfer as a function of velocity, define the velocity-resolved field–particle correlation diagnostic\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\nwhere $\\langle \\cdot \\rangle_{x,t}$ denotes an average over space and over the simulation time interval. In the presence of Landau damping of a single electrostatic mode with wavenumber $k$, the resonant energy exchange is localized near the phase velocity $v_\\phi \\approx \\omega/k$, where $\\omega$ is the real frequency of the mode. Thus, the velocity $v$ at which $C(v)$ peaks for $v \\ge 0$ identifies the resonant velocity contributing to damping:\n$$\nv_{\\mathrm{res}} = \\arg\\max_{v \\ge 0} \\, C(v).\n$$\n\nAlgorithmic design:\n- Discretize the spatial domain $x \\in [0,L)$ with $N_x$ points and periodic boundary conditions, and the velocity domain $v \\in [-v_{\\max}, v_{\\max}]$ with $N_v$ points.\n- Initialize $f(x,v,0)$ as a weakly perturbed Maxwellian $f_0(v)\\left[1 + \\alpha \\cos(kx)\\right]$ with thermal speed $v_{\\mathrm{th}}$.\n- Use Strang splitting to advance $f$ in time:\n  - Half-step velocity advection: For each spatial point $x_i$, advect the distribution in $v$ by $\\Delta v = a(x_i)\\, \\Delta t/2$ with $a(x_i) = q E(x_i)$, implemented via semi-Lagrangian linear interpolation along the $v$ grid with clamped boundary indices.\n  - Full-step spatial advection: For each velocity point $v_j$, advect the distribution in $x$ by $\\Delta x = v_j\\, \\Delta t$, implemented via semi-Lagrangian linear interpolation along the $x$ grid with periodic wrapping (using integer shifts and linear fractional interpolation).\n  - Solve Poisson’s equation in Fourier space: Compute the electron density $n_e(x) = \\int f(x,v)\\, dv$ via numerical quadrature (discrete sum times $\\Delta v$), form the charge density $\\rho(x) = 1 - n_e(x)$, take its discrete Fourier transform $\\hat{\\rho}(k_n)$, then for each nonzero Fourier mode with wavenumber $k_n$, obtain $\\hat{E}(k_n) = - i\\, \\hat{\\rho}(k_n)/k_n$, and inverse transform to get $E(x)$; set the zero mode of $\\hat{E}$ to zero to enforce periodic neutrality.\n  - Half-step velocity advection with the updated field.\n- At each full time step, accumulate the correlation $C(v)$ by computing the spatial average of $q\\, E(x,t)\\, v\\, f(x,v,t)$ at each velocity and summing over time, and at the end divide by the number of samples to obtain the time average.\n- Determine $v_{\\mathrm{res}}$ by finding the velocity $v \\ge 0$ at which $C(v)$ is maximal.\n\nNumerical details:\n- Choose $L = 2\\pi$, $N_x = 64$, $v_{\\max} = 5$, $N_v = 256$, $\\Delta t = 0.05$, $N_t = 300$, and $v_{\\mathrm{th}} = 1$.\n- The initial perturbation uses $k \\in \\{1,2,3\\}$ to align with the discrete Fourier modes of the periodic domain.\n- Use small $\\alpha$ (e.g., $\\alpha = 10^{-3}$ or $\\alpha = 5 \\times 10^{-4}$) to remain in the weakly nonlinear regime approximating linear Landau damping.\n- The velocity advection uses clamped interpolation near the boundaries; truncation errors are minimized by choosing $v_{\\max}$ so that $f$ is negligible at the boundaries for the chosen $v_{\\mathrm{th}}$.\n\nTest suite and outputs:\n- Test case $1$: $k = 1$, $\\alpha = 10^{-3}$.\n- Test case $2$: $k = 2$, $\\alpha = 10^{-3}$.\n- Test case $3$: $k = 3$, $\\alpha = 5 \\times 10^{-4}$.\nFor each test case, compute $C(v)$ and return $v_{\\mathrm{res}}$ as a float. The program must print a single line containing a comma-separated list of the three results enclosed in square brackets, e.g., $[r_1,r_2,r_3]$.\n\nThis approach strictly follows from the fundamental Vlasov–Poisson dynamics, derives the velocity-resolved energy transfer diagnostic from the kinetic energy equation, and implements a robust semi-Lagrangian numerical method suitable for capturing Landau damping and identifying the resonant velocity via the correlation $C(v)$.",
            "answer": "```python\nimport numpy as np\n\n# Vlasov-Poisson 1D1V solver with field–particle correlation diagnostic\n# Dimensionless units: q = -1, m = 1, L = 2*pi, v_th = 1\n\ndef maxwellian(v, v_th):\n    return (1.0 / (np.sqrt(2.0 * np.pi) * v_th)) * np.exp(-0.5 * (v / v_th) ** 2)\n\ndef solve_poisson(ne, dx, L):\n    # Solve dE/dx = 1 - ne using FFT with periodic boundary conditions\n    rho = 1.0 - ne  # Charge density (ions = 1)\n    rho_k = np.fft.fft(rho)\n    kfreq = np.fft.fftfreq(ne.size, d=dx)  # cycles per unit length\n    k = 2.0 * np.pi * kfreq  # angular wavenumbers\n    E_k = np.zeros_like(rho_k, dtype=np.complex128)\n    nonzero = k != 0.0\n    E_k[nonzero] = -1j * rho_k[nonzero] / k[nonzero]\n    E_k[~nonzero] = 0.0 + 0.0j  # enforce neutrality\n    E = np.fft.ifft(E_k).real\n    return E\n\ndef advect_x(f, vgrid, dt, dx):\n    # Semi-Lagrangian advection in x with periodic boundary\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    for j in range(Nv):\n        s = vgrid[j] * dt / dx\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        # Linear interpolation between shifted fields\n        out[:, j] = (1.0 - a) * np.roll(f[:, j], n) + a * np.roll(f[:, j], n + 1)\n    return out\n\ndef advect_v(f, E, dt, dv):\n    # Semi-Lagrangian advection in v with clamped boundary indices\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    j = np.arange(Nv)\n    for i in range(Nx):\n        s = (-E[i]) * dt / dv  # dv/dt = qE/m = -E\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        j0 = j - n\n        j1 = j - n - 1\n        j0 = np.clip(j0, 0, Nv - 1)\n        j1 = np.clip(j1, 0, Nv - 1)\n        out[i, :] = (1.0 - a) * f[i, j0] + a * f[i, j1]\n    return out\n\ndef run_case(k_mode, alpha, params):\n    # Unpack parameters\n    L = params['L']\n    Nx = params['Nx']\n    Nv = params['Nv']\n    vmax = params['vmax']\n    dt = params['dt']\n    Nt = params['Nt']\n    v_th = params['v_th']\n    q = -1.0\n\n    # Grids\n    x = np.linspace(0.0, L, Nx, endpoint=False)\n    v = np.linspace(-vmax, vmax, Nv)\n    dx = x[1] - x[0]\n    dv = v[1] - v[0]\n\n    # Initial distribution: weakly perturbed Maxwellian\n    f0 = maxwellian(v, v_th)  # shape (Nv,)\n    f = f0[None, :] * (1.0 + alpha * np.cos(k_mode * x)[:, None])  # shape (Nx, Nv)\n\n    # Initial field from Poisson\n    ne = np.sum(f, axis=1) * dv\n    E = solve_poisson(ne, dx, L)\n\n    # Correlation accumulator C(v)\n    C = np.zeros(Nv)\n\n    # Time loop with Strang splitting\n    for _ in range(Nt):\n        # Half-step in v\n        f = advect_v(f, E, dt * 0.5, dv)\n        # Full-step in x\n        f = advect_x(f, v, dt, dx)\n        # Update field\n        ne = np.sum(f, axis=1) * dv\n        E = solve_poisson(ne, dx, L)\n        # Half-step in v with updated field\n        f = advect_v(f, E, dt * 0.5, dv)\n\n        # Accumulate correlation C(v) = < q E v f >_{x}\n        Ef = (E[:, None] * f)  # shape (Nx, Nv)\n        C += q * v * (Ef.mean(axis=0))\n\n    # Time-average\n    C /= Nt\n\n    # Identify resonant velocity v_res for v >= 0 as location of maximum C(v)\n    pos_mask = v >= 0.0\n    v_pos = v[pos_mask]\n    C_pos = C[pos_mask]\n    idx = int(np.argmax(C_pos))\n    v_res = float(v_pos[idx])\n    return v_res\n\ndef solve():\n    # Simulation parameters\n    params = {\n        'L': 2.0 * np.pi,\n        'Nx': 64,\n        'Nv': 256,\n        'vmax': 5.0,\n        'dt': 0.05,\n        'Nt': 300,\n        'v_th': 1.0,\n    }\n\n    # Test cases: (k, alpha)\n    test_cases = [\n        (1, 1e-3),\n        (2, 1e-3),\n        (3, 5e-4),\n    ]\n\n    results = []\n    for k_mode, alpha in test_cases:\n        v_res = run_case(k_mode, alpha, params)\n        results.append(v_res)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}