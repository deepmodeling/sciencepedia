{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握朗道阻尼，研究一个阻尼*不会*发生的情形是很有启发性的。本练习将探讨一种具有明确截止速度、没有速度分布“尾巴”的“水袋”分布模型。通过推导该分布下的色散关系，您将发现共振粒子的缺失为何会消除阻尼，这与麦克斯韦分布形成鲜明对比，从而为共振波-粒子相互作用的核心作用建立起强大的物理直觉。",
            "id": "4000814",
            "problem": "考虑一个无磁化的一维静电电子等离子体，这是计算聚变科学与工程中堆芯湍流模拟的典型代表。电子遵循围绕空间均匀平衡态的线性化 Vlasov–Poisson 方程组，该平衡态的数密度为 $n_{e}$，速度分布函数为 $f_{0}(v)$，归一化后满足 $\\int_{-\\infty}^{\\infty} f_{0}(v)\\, dv = 1$。假设单电荷离子提供了一个固定的中性化背景。设微扰正比于 $\\exp(i k x - i \\omega t)$，其中 $k$ 为实波数，$\\omega$ 为复频率。\n\n平衡电子分布是一个有限宽度的水袋（顶帽）分布，\n$$\nf_{0}(v) = \\begin{cases}\n\\frac{1}{2 \\Delta},  |v| \\le \\Delta, \\\\\n0,  |v|  \\Delta,\n\\end{cases}\n$$\n其恒定半宽为 $\\Delta  0$。\n\n从第一性原理出发，即电子的线性化 Vlasov 方程和 Poisson 方程，\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} - \\frac{e}{m_{e}} E \\frac{\\partial f}{\\partial v} = 0, \\qquad \\frac{\\partial E}{\\partial x} = \\frac{e}{\\epsilon_{0}} \\left(n_{i} - n_{e} \\int_{-\\infty}^{\\infty} f\\, dv\\right),\n$$\n推导标准介电形式的色散关系，并计算水袋分布下电子等离子体波的 Landau 阻尼率 $\\gamma$。在复 $\\omega$ 平面中使用 Landau 围道规定进行解析延拓。将阻尼率的最终答案以 $\\mathrm{s}^{-1}$ 为单位表示。\n\n此外，根据您的推导，解释水袋分布中不存在指数尾部这一特性如何改变其相对于麦克斯韦平衡态的共振贡献。您的解释必须基于 $f_{0}(v)$ 的速度空间导数的结构以及速度积分的解析性质。\n\n如果您的最终数值结果需要四舍五入，请将答案保留四位有效数字。如果您的最终结果是一个精确的闭合解析表达式，请无需四舍五入，直接给出。",
            "solution": "问题陈述经过严格评估，被认为是有效的。它提出了一个在等离子体动理学理论中适定的、有科学依据的问题。起初，要求在没有提供等离子体参数（$n_e$, $\\Delta$）或波参数（$k$）的数值的情况下，以 $\\mathrm{s}^{-1}$ 为单位给出数值答案，这表明问题可能未完全指定。然而，完整的推导表明，对于指定的水袋分布，Landau 阻尼率精确为零，这一结果不依赖于任何具体的参数值。因此，该问题是自洽的，并且可以按原样求解。\n\n该问题要求推导色散关系，并计算在具有水袋平衡分布函数的无磁化等离子体中电子等离子体波的 Landau 阻尼率。\n\n出发点是电子的线性化 Vlasov 方程和 Poisson 方程。离子背景是固定的且呈电中性。\n围绕平衡态 $f_0(v)$ 线性化的微扰电子分布函数 $f_1(x, v, t)$ 的 Vlasov 方程为：\n$$\n\\frac{\\partial f_1}{\\partial t} + v \\frac{\\partial f_1}{\\partial x} - \\frac{e E_1}{m_{e}} \\frac{d f_{0}}{d v} = 0\n$$\n其中 $E_1(x,t)$ 是微扰电场，$e$ 是元电荷，$m_e$ 是电子质量。我们假设微扰的形式为 $\\exp(i k x - i \\omega t)$，其中 $k$ 是实波数，$\\omega = \\omega_r + i\\gamma$ 是复频率。将此形式代入线性化的 Vlasov 方程得到：\n$$\n-i\\omega f_1 + ikv f_1 - \\frac{e E_1}{m_{e}} \\frac{d f_{0}}{d v} = 0\n$$\n求解微扰分布函数 $f_1$ 可得：\n$$\nf_1(v) = \\frac{e E_1}{m_{e}} \\frac{1}{i(kv - \\omega)} \\frac{d f_{0}}{d v} = -i \\frac{e E_1}{m_{e}} \\frac{1}{\\omega - kv} \\frac{d f_{0}}{d v}\n$$\n接下来，我们使用 Poisson 方程。问题陈述给出了 $\\frac{\\partial E}{\\partial x} = \\frac{e}{\\epsilon_{0}} \\left(n_{i} - n_{e} \\int_{-\\infty}^{\\infty} f\\, dv\\right)$。总分布为 $f = f_0 + f_1$。为了保持电中性，离子密度 $n_i$ 是恒定的，且等于平衡电子密度 $n_e$。微扰电子密度为 $n_{e1} = n_e \\int_{-\\infty}^{\\infty} f_1(v) dv$。线性化的 Poisson 方程变为：\n$$\n\\frac{\\partial E_1}{\\partial x} = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} f_1(v) dv\n$$\n应用平面波形式 $E_1 \\propto \\exp(ikx - i\\omega t)$，方程变为：\n$$\nik E_1 = -\\frac{e n_e}{\\epsilon_{0}} \\int_{-\\infty}^{\\infty} f_1(v) dv\n$$\n根据线性化 Vlasov-Poisson 理论，静电波的色散关系由 $\\epsilon(\\omega, k) = 0$ 给出，其中一个标准的介电函数定义为：\n$$\n\\epsilon(\\omega, k) = 1 - \\frac{\\omega_p^2}{k^2} \\int_{L} \\frac{f_0'(v)}{v - \\omega/k} dv\n$$\n其中 $\\omega_p^2 = \\frac{n_e e^2}{m_e \\epsilon_0}$ 是电子等离子体频率的平方，$f_0'(v) = \\frac{df_0}{dv}$，积分沿 Landau 围道进行。\n\n现在我们将此应用于特定的水袋分布：\n$$\nf_{0}(v) = \\begin{cases}\n\\frac{1}{2 \\Delta},  |v| \\le \\Delta, \\\\\n0,  |v|  \\Delta.\n\\end{cases}\n$$\n该函数的导数用 Dirac δ 函数表示为：\n$$\nf_0'(v) = \\frac{d}{dv} \\left( \\frac{1}{2\\Delta} [H(v+\\Delta) - H(v-\\Delta)] \\right) = \\frac{1}{2\\Delta} [\\delta(v+\\Delta) - \\delta(v-\\Delta)]\n$$\n其中 $H(v)$ 是 Heaviside 阶跃函数。\n我们将此导数代入色散关系的速度积分中。令相速度 $u = \\omega/k$。\n$$\n\\int_L \\frac{f_0'(v)}{v - u} dv = \\int_{-\\infty}^{\\infty} \\frac{1}{2\\Delta} \\frac{\\delta(v+\\Delta) - \\delta(v-\\Delta)}{v - u} dv\n$$\n使用 δ 函数的筛选性质，$\\int g(x) \\delta(x-a) dx = g(a)$：\n$$\n\\int_L \\frac{f_0'(v)}{v - u} dv = \\frac{1}{2\\Delta} \\left( \\frac{1}{-\\Delta - u} - \\frac{1}{\\Delta - u} \\right) = \\frac{1}{2\\Delta} \\left( \\frac{-1}{\\Delta + u} - \\frac{1}{\\Delta - u} \\right)\n$$\n$$\n= \\frac{1}{2\\Delta} \\frac{-(\\Delta - u) - (\\Delta + u)}{(\\Delta+u)(\\Delta-u)} = \\frac{1}{2\\Delta} \\frac{-2\\Delta}{\\Delta^2 - u^2} = \\frac{1}{u^2 - \\Delta^2}\n$$\n只要 $u \\neq \\pm \\Delta$，此结果对任何复数 $u$ 均有效。该积分是 $u$ 的解析函数，除了在 $u=\\pm \\Delta$ 处有单极点。由于被积函数在实轴上没有奇点（除非 $u$ 是实数且等于 $\\pm \\Delta$），Landau 围道规定自然得到满足。\n\n将此结果代回色散关系 $\\epsilon(\\omega, k) = 0$ 中：\n$$\n1 - \\frac{\\omega_p^2}{k^2} \\left( \\frac{1}{(\\omega/k)^2 - \\Delta^2} \\right) = 0\n$$\n$$\n1 = \\frac{\\omega_p^2}{k^2} \\frac{1}{\\omega^2/k^2 - \\Delta^2} = \\frac{\\omega_p^2}{\\omega^2 - k^2\\Delta^2}\n$$\n求解 $\\omega^2$：\n$$\n\\omega^2 - k^2\\Delta^2 = \\omega_p^2\n$$\n$$\n\\omega^2 = \\omega_p^2 + k^2\\Delta^2\n$$\n由于 $\\omega_p^2 > 0$，$k^2 \\ge 0$，以及 $\\Delta^2 > 0$，等式右边是一个正实数。因此，复频率 $\\omega$ 由下式给出：\n$$\n\\omega = \\pm \\sqrt{\\omega_p^2 + k^2\\Delta^2}\n$$\n频率 $\\omega$ 是纯实数。阻尼率 $\\gamma$ 定义为频率的虚部，即 $\\gamma = \\Im(\\omega)$。\n从我们的结果可以明显看出，对于任何实波数 $k$：\n$$\n\\gamma = 0\n$$\n因此，在具有水袋分布的等离子体中，电子等离子体波是无阻尼的。结果为 $0 \\ \\mathrm{s}^{-1}$。\n\n阻尼的缺失可以通过分析共振条件和 $f_0'(v)$ 的结构来解释。Landau 阻尼源于波与以波的相速度 $v_{ph} = \\Re(\\omega)/k = \\omega_r/k$ 或其附近速度运动的粒子之间的能量净交换。这种能量交换的速率与分布函数在相速度处的斜率 $f_0'(v_{ph})$ 成正比。\n\n对于水袋分布，波的相速度为：\n$$\n|v_{ph}| = \\frac{|\\omega_r|}{k} = \\frac{\\sqrt{\\omega_p^2 + k^2\\Delta^2}}{k} = \\sqrt{\\frac{\\omega_p^2}{k^2} + \\Delta^2}\n$$\n由于 $\\omega_p^2/k^2 > 0$，显然有 $|v_{ph}| > \\Delta$。\n水袋分布具有有限宽度，意味着不存在速度 $|v| > \\Delta$ 的粒子。其导数 $f_0'(v)$ 仅在 $v = \\pm\\Delta$ 这两个精确的速度上非零。由于波的相速度 $|v_{ph}|$ 严格大于 $\\Delta$，它不与 $f_0'(v)$ 非零的速度重合。更重要的是，在 $v=v_{ph}$ 处没有粒子能与波发生共振。这就是不存在 Landau 阻尼的物理原因。\n\n相比之下，对于麦克斯韦平衡分布 $f_M(v) \\propto \\exp(-v^2/v_{th}^2)$，该函数及其导数对所有速度都非零。麦克斯韦分布具有“指数尾部”，意味着在任何速度下（无论多高）都存在少量但有限的粒子。当电子等离子体波传播时，其相速度 $v_{ph}$ 通常大于热速度 $v_{th}$，但由于存在指数尾部，总有粒子的速度满足 $v \\approx v_{ph}$。导数 $f_M'(v_{ph})$ 是非零的（对于 $v_{ph} > 0$ 为负），这导致能量从波净转移到粒子，从而产生波阻尼。\n\n在数学上，差异在于速度积分的解析性质。对于水袋分布，$f_0(v)$ 的紧支集导致色散关系是关于 $\\omega^2$ 的一个简单代数（有理）函数。$\\omega$ 的解是这个代数方程的根，而这些根恰好是纯实数。对于麦克斯韦分布，$f_0(v)$ 的无穷支集导致色散函数涉及超越的等离子体色散函数 $Z(\\zeta)$，其中 $\\zeta = \\omega/(k v_{th}\\sqrt{2})$。对于实数自变量，该函数是复数，这从根本上为任何实数 $k$ 对应的频率 $\\omega$ 引入了虚部。这一数学特征反映了在所有速度上都存在连续的共振粒子的物理事实。水袋分布中不存在指数尾部，有效地消除了导致 Landau 阻尼的数学结构。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "波-粒子相互作用不仅能导致阻尼，也能引发波的增长，这种现象被称为动理学不稳定性。本练习将运用强大的彭罗斯判据（Penrose criterion）分析双流等离子体，这是一个用于模拟反向粒子束的常用模型。您将确定分布函数形态驱动不稳定性的精确阈值，此时系统的自由能将转化为波能量，从而证明阻尼和不稳定性是同一现象的两个方面，均由速度分布函数的斜率决定。",
            "id": "4000840",
            "problem": "考虑一个一维、无碰撞、无磁化的电子等离子体，其中不动的离子提供中性化背景。设未受扰动的电子速度分布函数被建模为两个密度相等、温度相同、漂移速度相反的漂移麦克斯韦分布的叠加（一种对称双流状态），由下式给出\n$$\nf_{0}(v) = \\frac{n_{e}}{2} \\frac{1}{\\sqrt{\\pi} v_{th}} \\left[ \\exp\\!\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\!\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right],\n$$\n其中，$n_{e}$ 是电子数密度，$U$ 是每个电子流的漂移速度大小，$v_{th} = \\sqrt{2 k_{B} T_{e} / m_{e}}$ 是与电子温度 $T_{e}$ 和电子质量 $m_{e}$ 相关的热速度，$k_{B}$ 是玻尔兹曼常数。\n\n从 Vlasov–Poisson 系统的线性静电响应出发，并使用 Penrose 判据，确定将稳定行为与不稳定行为分开的比值 $U / v_{th}$ 的精确阈值。具体来说，找到临界值 $U_{c}$，使得当且仅当 $U  U_{c}$ 时，对于某个实波数 $k$ 存在不稳定的静电模式，而当 $U \\le U_{c}$ 时，不存在不稳定的模式。将您的最终答案表示为无量纲比值 $U_{c} / v_{th}$ 的单个闭式解析表达式。不需要进行数值四舍五入，您的答案必须是无量纲的。",
            "solution": "用户希望找到一维、无碰撞、无磁化电子等离子体中双流不稳定性的阈值。\n\n### 步骤 1：问题验证\n\n在尝试任何解决方案之前，该问题都经过了严格的验证过程。\n\n#### 步骤 1.1：提取已知条件\n- **系统：** 一维、无碰撞、无磁化的电子等离子体，其中不动的正离子提供中性化背景。\n- **未受扰动的电子速度分布函数：**\n$$\nf_{0}(v) = \\frac{n_{e}}{2} \\frac{1}{\\sqrt{\\pi} v_{th}} \\left[ \\exp\\!\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\!\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n- **变量定义：**\n  - $n_{e}$：电子数密度\n  - $v$：电子速度\n  - $U$：每个电子流的漂移速度大小\n  - $v_{th}$：电子热速度，定义为 $v_{th} = \\sqrt{2 k_{B} T_{e} / m_{e}}$\n  - $T_{e}$：电子温度\n  - $m_{e}$：电子质量\n  - $k_{B}$：玻尔兹曼常数\n- **方法论：** 分析将基于 Vlasov–Poisson 系统的线性静电响应，并使用 Penrose 判据。\n- **目标：** 确定漂移速度 $U$ 的精确临界值 $U_{c}$，使得当且仅当 $U  U_{c}$ 时存在不稳定的静电模式。最终答案必须是无量纲比值 $U_{c} / v_{th}$。\n\n#### 步骤 1.2：使用提取的已知条件进行验证\n1.  **科学基础：** 该问题描述了经典的双流不稳定性，这是等离子体动理学理论中的一个基本概念。Vlasov–Poisson 系统是描述此现象的标准模型，而 Penrose 判据是确定动理学不稳定性起始的正确且严谨的工具。所提供的分布函数是对称双流系统的标准表示。该问题在科学上是合理的。\n2.  **适定性：** 该问题是适定的。它提供了一个具体、良好行为的分布函数，并要求一个唯一定义的稳定性阈值。所有参数都已明确定义。\n3.  **客观性：** 该问题以精确、客观和标准的科学语言陈述，没有歧义或主观论断。\n\n#### 步骤 1.3：结论与行动\n该问题被认定为有效，因为它具有科学基础、适定性和客观性。没有矛盾、信息缺失或违反物理原理的情况。因此，我将继续进行完整的解题推导。\n\n### 步骤 2：解题推导\n\n等离子体的稳定性由 Penrose 判据决定，该判据源自线性 Vlasov-Poisson 色散关系。该判据指出，当且仅当分布函数 $f_0(v)$ 在某个速度 $v=v_m$ 处有局部极小值，且 Penrose 积分为正时，存在不稳定性（即对于某个实波数 $k$，色散关系存在一个解，其 $\\text{Im}(\\omega)  0$）：\n$$\n\\mathcal{P} \\int_{-\\infty}^{\\infty} \\frac{f_0'(v)}{v - v_m} dv  0\n$$\n其中 $\\mathcal{P}$ 表示柯西主值。一个更简单的不稳定性充分条件是速度分布函数 $f_0(v)$ 中存在局部极小值。对于对称双流分布，这个条件恰好既是必要的也是充分的。\n\n因此，我们将找到给定分布函数 $f_0(v)$ 出现局部极小值的条件。\n分布函数为：\n$$\nf_{0}(v) = C \\left[ \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n其中 $C = \\frac{n_{e}}{2 \\sqrt{\\pi} v_{th}}$ 是一个正常数。\n\n该函数关于 $v=0$ 对称，即 $f_0(v) = f_0(-v)$。极值点将出现在一阶导数为零的地方，即 $\\frac{df_0}{dv} = 0$。\n$f_0(v)$ 关于 $v$ 的一阶导数为：\n$$\n\\frac{df_0}{dv} = C \\left[ \\left( -\\frac{2(v - U)}{v_{th}^{2}} \\right) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + \\left( -\\frac{2(v + U)}{v_{th}^{2}} \\right) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\frac{df_0}{dv} = -\\frac{2C}{v_{th}^{2}} \\left[ (v - U) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + (v + U) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n我们在 $v=0$ 处检验极值。计算在 $v=0$ 处的导数：\n$$\n\\left. \\frac{df_0}{dv} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ (-U) \\exp\\left( - \\frac{(-U)^{2}}{v_{th}^{2}} \\right) + (U) \\exp\\left( - \\frac{U^{2}}{v_{th}^{2}} \\right) \\right] = -\\frac{2C}{v_{th}^{2}} [ -U + U ] \\exp\\left( - \\frac{U^{2}}{v_{th}^{2}} \\right) = 0\n$$\n因此，$v=0$ 始终是分布函数的一个极值点。要确定它是局部极小值还是局部极大值，我们必须检查在 $v=0$ 处的二阶导数 $\\frac{d^2f_0}{dv^2}$ 的符号。正号表示局部极小值（不稳定），而负号表示局部极大值（稳定）。稳定与不稳定之间的转变发生在临界点，此时极值点变为一个平坦的拐点，即 $\\frac{d^2f_0}{dv^2}|_{v=0} = 0$。\n\n我们计算 $f_0(v)$ 的二阶导数：\n$$\n\\frac{d^2f_0}{dv^2} = -\\frac{2C}{v_{th}^{2}} \\frac{d}{dv} \\left[ (v - U) \\exp\\left( - \\frac{(v - U)^{2}}{v_{th}^{2}} \\right) + (v + U) \\exp\\left( - \\frac{(v + U)^{2}}{v_{th}^{2}} \\right) \\right]\n$$\n使用乘积法则，像 $(v-a) \\exp(-(v-a)^2/b^2)$ 这样的项的导数是 $\\left[1 - \\frac{2(v-a)^2}{b^2}\\right] \\exp(-(v-a)^2/b^2)$。应用此法则，我们得到：\n$$\n\\frac{d^2f_0}{dv^2} = -\\frac{2C}{v_{th}^{2}} \\left[ \\left(1 - \\frac{2(v - U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(v - U)^2}{v_{th}^{2}} \\right) + \\left(1 - \\frac{2(v + U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(v + U)^2}{v_{th}^{2}} \\right) \\right]\n$$\n现在，我们在极值点 $v=0$ 处计算这个表达式的值：\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ \\left(1 - \\frac{2(-U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{(-U)^2}{v_{th}^{2}} \\right) + \\left(1 - \\frac{2(U)^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{2C}{v_{th}^{2}} \\left[ 2 \\left(1 - \\frac{2U^2}{v_{th}^2}\\right) \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\right]\n$$\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = -\\frac{4C}{v_{th}^{2}} \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right) \\left(1 - \\frac{2U^2}{v_{th}^2}\\right)\n$$\n如果 $v=0$ 是一个局部极小值，则存在不稳定性，这要求 $\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} > 0$。因子 $-\\frac{4C}{v_{th}^{2}} \\exp\\left( - \\frac{U^2}{v_{th}^{2}} \\right)$ 总是负的。因此，不稳定性的条件变为：\n$$\n1 - \\frac{2U^2}{v_{th}^2}  0 \\implies 1  \\frac{2U^2}{v_{th}^2} \\implies U^2 > \\frac{v_{th}^2}{2} \\implies U > \\frac{v_{th}}{\\sqrt{2}}\n$$\n反之，如果 $v=0$ 是一个局部极大值，则系统是稳定的，这要求 $\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0}  0$。这导致：\n$$\n1 - \\frac{2U^2}{v_{th}^2} > 0 \\implies U  \\frac{v_{th}}{\\sqrt{2}}\n$$\n区分稳定和不稳定区域的临界阈值 $U_c$ 是使二阶导数为零的 $U$ 值。这标志着从单峰分布（稳定）到在 $v=0$ 处有极小值的双峰分布（不稳定）的转变。\n$$\n\\left. \\frac{d^2f_0}{dv^2} \\right|_{v=0} = 0 \\implies 1 - \\frac{2U_c^2}{v_{th}^2} = 0\n$$\n求解 $U_c$：\n$$\n\\frac{2U_c^2}{v_{th}^2} = 1 \\implies U_c^2 = \\frac{v_{th}^2}{2}\n$$\n因为 $U_c$ 是速度大小，它必须是非负的。取正平方根：\n$$\nU_c = \\frac{v_{th}}{\\sqrt{2}}\n$$\n问题要求无量纲比值 $U_c / v_{th}$。\n$$\n\\frac{U_c}{v_{th}} = \\frac{1}{\\sqrt{2}}\n$$\n这就是精确的阈值。对于 $U > U_c$，分布在 $v=0$ 处有一个局部极小值，满足 Penrose 不稳定性判据。对于 $U \\le U_c$，分布在 $v=0$ 处有一个单峰（或在 $U=U_c$ 时为平顶），系统是稳定的。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2}}}\n$$"
        },
        {
            "introduction": "超越解析理论，本练习将从第一性原理出发，对基本的弗拉索夫-泊松（Vlasov-Poisson）系统进行数值模拟。您将实现一种先进的场-粒子关联诊断方法，这是现代等离子体研究中使用的工具。这项计算练习让您通过测量波与粒子之间按速度分辨的能量转移，直接“看到”朗道阻尼的作用过程，并通过确定这种关联的峰值来明确量化共振速度，从而将抽象的动理学理论与具体的模拟数据联系起来。",
            "id": "4000790",
            "problem": "考虑一个无量纲单位下，包含固定离子的电子的一维单速静电 Vlasov–Poisson 系统。设电子分布函数为 $f(x,v,t)$，电场为 $E(x,t)$，电子电荷为 $q=-1$，电子质量为 $m=1$。控制方程为 Vlasov 方程和 Poisson 方程：\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\n其中 $x$ 方向为周期性边界条件，速度域被截断为 $v \\in [-v_{\\max}, v_{\\max}]$，并选择足够大的 $v_{\\max}$ 以使 $f$ 在边界处可忽略不计。初始条件是一个麦克斯韦分布的弱微扰空间模式：\n$$\nf(x,v,0) = f_0(v)\\left[1 + \\alpha \\cos(k x)\\right], \\quad f_0(v) = \\frac{1}{\\sqrt{2\\pi} v_{\\mathrm{th}}}\\exp\\left(-\\frac{v^2}{2 v_{\\mathrm{th}}^2}\\right),\n$$\n其中 $k$ 是微扰的基波数，$\\alpha$ 是微扰振幅，$v_{\\mathrm{th}}$ 是电子热速度。\n\n定义一个速度分辨的场-粒子关联诊断量，用于测量在每个速度上从场到粒子的时间平均能量转移密度：\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\n其中 $\\langle \\cdot \\rangle_{x,t}$ 表示在空间和模拟时间间隔上的平均。与朗道阻尼相关的共振速度 $v_{\\mathrm{res}}$ 被定义为使 $C(v)$ 达到其最大值的速度 $v \\ge 0$。\n\n你的任务是为上述 Vlasov–Poisson 系统实现一个无量纲数值求解器，该求解器使用 Strang 分裂半拉格朗日格式（其中 $x$ 方向为周期性平流，$v$ 方向为线性插值平流），并与一个用于 Poisson 方程的傅里叶空间求解器相结合。然后实现场-粒子关联诊断 $C(v)$，并为每个指定的测试用例计算并返回 $v_{\\mathrm{res}}$。\n\n使用以下域和离散化选择：\n- 空间域长度 $L = 2\\pi$，$x$ 方向周期性。\n- 空间网格点数 $N_x = 64$。\n- 速度域 $v \\in [-v_{\\max}, v_{\\max}]$，其中 $v_{\\max} = 5$。\n- 速度网格点数 $N_v = 256$。\n- 时间步长 $\\Delta t = 0.05$。\n- 时间步数 $N_t = 300$。\n- 电子热速度 $v_{\\mathrm{th}} = 1$。\n\n为每个时间步 $n$ 实现 Strang 分裂：\n1. $v$ 方向半步：使用当前场 $E^n(x)$，沿 $v$ 特征线对 $f$ 进行 $\\Delta t/2$ 的平流。\n2. $x$ 方向全步：使用粒子速度，沿 $x$ 特征线对 $f$ 进行 $\\Delta t$ 的平流，并采用周期性边界条件。\n3. 更新场：通过求解 Poisson 方程，从更新后的 $f$ 获得 $E^{n+1}(x)$。\n4. $v$ 方向半步：使用 $E^{n+1}(x)$，沿 $v$ 特征线对 $f$ 进行 $\\Delta t/2$ 的平流。\n\n在每个完整的时间步，通过对瞬时 $E(x,t)$ 和 $f(x,v,t)$ 在 $x$ 方向上求平均并随时间累加来计算 $C(v)$，最后除以样本数得到时间平均值。通过选取使 $C(v)$ 最大化的速度 $v \\ge 0$ 来确定 $v_{\\mathrm{res}}$。\n\n所有量均为无量纲。每个测试用例需要输出一个浮点数 $v_{\\mathrm{res}}$。程序必须处理以下参数值的测试套件：\n- 测试用例 1：$k = 1$，$\\alpha = 10^{-3}$。\n- 测试用例 2：$k = 2$，$\\alpha = 10^{-3}$。\n- 测试用例 3：$k = 3$，$\\alpha = 5 \\times 10^{-4}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3]$），其中每个 $r_i$ 是为测试用例 $i$ 计算出的浮点数 $v_{\\mathrm{res}}$。",
            "solution": "该问题的基础是静电 Vlasov–Poisson 系统，其一维空间和一维速度形式可写为\n$$\n\\frac{\\partial f}{\\partial t} + v \\frac{\\partial f}{\\partial x} + q E(x,t) \\frac{\\partial f}{\\partial v} = 0,\n$$\n$$\n\\frac{\\partial E}{\\partial x} = 1 - \\int_{-\\infty}^{\\infty} f(x,v,t) \\, dv,\n$$\n其中 $q=-1$，$m=1$，且 $x$ 方向为周期性边界条件。从第一性原理出发，Vlasov 方程表达了沿运动特征线的相空间平流：粒子以速度 $v$ 在位置上平移，并根据加速度 $a = q E$ 在速度上平移。Poisson 方程将电场的空间导数与净电荷密度联系起来，此处净电荷密度为恒定的离子背景（归一化为 1）与电子密度 $n_e(x,t) = \\int f(x,v,t)\\, dv$ 之差。\n\n由电场引起的电子动能密度 $W(x,t) = \\int \\frac{1}{2} m v^2 f(x,v,t)\\, dv$ 的变化率，可以通过将 Vlasov 方程乘以 $\\frac{1}{2} m v^2$ 并对 $v$ 积分得到：\n$$\n\\frac{\\partial W}{\\partial t} = \\int \\frac{1}{2} m v^2 \\left[ - v \\frac{\\partial f}{\\partial x} - q E \\frac{\\partial f}{\\partial v} \\right] dv.\n$$\n空间平流项变为动能通量在 $x$ 方向的散度，在周期性域中进行空间平均时，对净场-粒子能量交换率没有贡献。对于速度平流项，在 $v$ 方向上进行分部积分（假设在速度边界处 $f \\to 0$ 且 $m=1$）：\n$$\n\\int \\frac{1}{2} v^2 \\left(- q E \\frac{\\partial f}{\\partial v} \\right) dv = q E \\int v f \\, dv.\n$$\n因此，在位置 $x$ 处，从场到电子的瞬时能量转移密度率为\n$$\n\\dot{W}(x,t) = \\int q\\, E(x,t)\\, v\\, f(x,v,t)\\, dv.\n$$\n为了将此能量转移解析为速度的函数，定义速度分辨的场-粒子关联诊断量\n$$\nC(v) = \\left\\langle q\\, E(x,t)\\, v\\, f(x,v,t) \\right\\rangle_{x,t},\n$$\n其中 $\\langle \\cdot \\rangle_{x,t}$ 表示在空间和模拟时间间隔上的平均。在波数为 $k$ 的单个静电模式发生朗道阻尼时，共振能量交换局域化在相速度 $v_\\phi \\approx \\omega/k$ 附近，其中 $\\omega$ 是模式的实频率。因此，对于 $v \\ge 0$，使 $C(v)$ 达到峰值的速度 $v$ 确定了对阻尼有贡献的共振速度：\n$$\nv_{\\mathrm{res}} = \\arg\\max_{v \\ge 0} \\, C(v).\n$$\n\n算法设计：\n- 用 $N_x$ 个点离散化空间域 $x \\in [0,L)$ 并采用周期性边界条件，用 $N_v$ 个点离散化速度域 $v \\in [-v_{\\max}, v_{\\max}]$。\n- 将 $f(x,v,0)$ 初始化为一个弱微扰的麦克斯韦分布 $f_0(v)\\left[1 + \\alpha \\cos(kx)\\right]$，其热速度为 $v_{\\mathrm{th}}$。\n- 使用 Strang 分裂来对 $f$ 进行时间推进：\n  - 速度半步平流：对于每个空间点 $x_i$，以 $a(x_i) = q E(x_i)$，将分布函数在 $v$ 方向上平流 $\\Delta v = a(x_i)\\, \\Delta t/2$。这通过沿 $v$ 网格使用半拉格朗日线性插值实现，边界索引采用截断（clamped）方式。\n  - 空间全步平流：对于每个速度点 $v_j$，将分布函数在 $x$ 方向上平流 $\\Delta x = v_j\\, \\Delta t$。这通过沿 $x$ 网格使用半拉格朗日线性插值实现，并采用周期性环绕（通过整数位移和线性分数插值）。\n  - 在傅里叶空间中求解 Poisson 方程：通过数值积分（离散求和乘以 $\\Delta v$）计算电子密度 $n_e(x) = \\int f(x,v)\\, dv$，形成电荷密度 $\\rho(x) = 1 - n_e(x)$，对其进行离散傅里叶变换得到 $\\hat{\\rho}(k_n)$，然后对于每个波数为 $k_n$ 的非零傅里叶模式，获得 $\\hat{E}(k_n) = - i\\, \\hat{\\rho}(k_n)/k_n$，再进行逆变换得到 $E(x)$；将 $\\hat{E}$ 的零模式设为零以强制周期性电中性。\n  - 使用更新后的场进行速度半步平流。\n- 在每个完整的时间步，通过计算每个速度下 $q\\, E(x,t)\\, v\\, f(x,v,t)$ 的空间平均值并随时间累加来累积相关性 $C(v)$，最后除以样本数以获得时间平均值。\n- 通过找到使 $C(v)$ 最大的速度 $v \\ge 0$ 来确定 $v_{\\mathrm{res}}$。\n\n数值细节：\n- 选择 $L = 2\\pi$、$N_x = 64$、$v_{\\max} = 5$、$N_v = 256$、$\\Delta t = 0.05$、$N_t = 300$ 及 $v_{\\mathrm{th}} = 1$。\n- 初始微扰使用 $k \\in \\{1,2,3\\}$ 以与周期性域的离散傅里叶模式对齐。\n- 使用小的 $\\alpha$（例如 $\\alpha = 10^{-3}$ 或 $\\alpha = 5 \\times 10^{-4}$）以保持在近似线性朗道阻尼的弱非线性区域。\n- 速度平流在边界附近使用截断插值；通过选择合适的 $v_{\\max}$，使得对于所选的 $v_{\\mathrm{th}}$，$f$ 在边界处可忽略不计，从而最小化截断误差。\n\n测试套件和输出：\n- 测试用例 1：$k = 1$，$\\alpha = 10^{-3}$。\n- 测试用例 2：$k = 2$，$\\alpha = 10^{-3}$。\n- 测试用例 3：$k = 3$，$\\alpha = 5 \\times 10^{-4}$。\n对于每个测试用例，计算 $C(v)$ 并返回浮点数 $v_{\\mathrm{res}}$。程序必须打印单行输出，其中包含一个用方括号括起来的三个结果的逗号分隔列表，例如 $[r_1,r_2,r_3]$。\n\n该方法严格遵循基本的 Vlasov–Poisson 动力学，从动能方程推导出速度分辨的能量转移诊断量，并实现了一种鲁棒的半拉格朗日数值方法，适用于捕捉朗道阻尼并通过相关性 $C(v)$ 识别共振速度。",
            "answer": "```python\nimport numpy as np\n\n# Vlasov-Poisson 1D1V solver with field–particle correlation diagnostic\n# Dimensionless units: q = -1, m = 1, L = 2*pi, v_th = 1\n\ndef maxwellian(v, v_th):\n    return (1.0 / (np.sqrt(2.0 * np.pi) * v_th)) * np.exp(-0.5 * (v / v_th) ** 2)\n\ndef solve_poisson(ne, dx, L):\n    # Solve dE/dx = 1 - ne using FFT with periodic boundary conditions\n    rho = 1.0 - ne  # Charge density (ions = 1)\n    rho_k = np.fft.fft(rho)\n    kfreq = np.fft.fftfreq(ne.size, d=dx)  # cycles per unit length\n    k = 2.0 * np.pi * kfreq  # angular wavenumbers\n    E_k = np.zeros_like(rho_k, dtype=np.complex128)\n    nonzero = k != 0.0\n    E_k[nonzero] = -1j * rho_k[nonzero] / k[nonzero]\n    E_k[~nonzero] = 0.0 + 0.0j  # enforce neutrality\n    E = np.fft.ifft(E_k).real\n    return E\n\ndef advect_x(f, vgrid, dt, dx):\n    # Semi-Lagrangian advection in x with periodic boundary\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    for j in range(Nv):\n        s = vgrid[j] * dt / dx\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        # Linear interpolation between shifted fields\n        out[:, j] = (1.0 - a) * np.roll(f[:, j], n) + a * np.roll(f[:, j], n + 1)\n    return out\n\ndef advect_v(f, E, dt, dv):\n    # Semi-Lagrangian advection in v with clamped boundary indices\n    Nx, Nv = f.shape\n    out = np.empty_like(f)\n    j = np.arange(Nv)\n    for i in range(Nx):\n        s = (-E[i]) * dt / dv  # dv/dt = qE/m = -E\n        n = int(np.floor(s))\n        a = s - n  # fractional part in [0,1)\n        j0 = j - n\n        j1 = j - n - 1\n        j0 = np.clip(j0, 0, Nv - 1)\n        j1 = np.clip(j1, 0, Nv - 1)\n        out[i, :] = (1.0 - a) * f[i, j0] + a * f[i, j1]\n    return out\n\ndef run_case(k_mode, alpha, params):\n    # Unpack parameters\n    L = params['L']\n    Nx = params['Nx']\n    Nv = params['Nv']\n    vmax = params['vmax']\n    dt = params['dt']\n    Nt = params['Nt']\n    v_th = params['v_th']\n    q = -1.0\n\n    # Grids\n    x = np.linspace(0.0, L, Nx, endpoint=False)\n    v = np.linspace(-vmax, vmax, Nv)\n    dx = x[1] - x[0]\n    dv = v[1] - v[0]\n\n    # Initial distribution: weakly perturbed Maxwellian\n    f0 = maxwellian(v, v_th)  # shape (Nv,)\n    f = f0[None, :] * (1.0 + alpha * np.cos(k_mode * x)[:, None])  # shape (Nx, Nv)\n\n    # Initial field from Poisson\n    ne = np.sum(f, axis=1) * dv\n    E = solve_poisson(ne, dx, L)\n\n    # Correlation accumulator C(v)\n    C = np.zeros(Nv)\n\n    # Time loop with Strang splitting\n    for _ in range(Nt):\n        # Half-step in v\n        f = advect_v(f, E, dt * 0.5, dv)\n        # Full-step in x\n        f = advect_x(f, v, dt, dx)\n        # Update field\n        ne = np.sum(f, axis=1) * dv\n        E = solve_poisson(ne, dx, L)\n        # Half-step in v with updated field\n        f = advect_v(f, E, dt * 0.5, dv)\n\n        # Accumulate correlation C(v) =  q E v f >_{x}\n        Ef = (E[:, None] * f)  # shape (Nx, Nv)\n        C += q * v * (Ef.mean(axis=0))\n\n    # Time-average\n    C /= Nt\n\n    # Identify resonant velocity v_res for v >= 0 as location of maximum C(v)\n    pos_mask = v >= 0.0\n    v_pos = v[pos_mask]\n    C_pos = C[pos_mask]\n    idx = int(np.argmax(C_pos))\n    v_res = float(v_pos[idx])\n    return v_res\n\ndef solve():\n    # Simulation parameters\n    params = {\n        'L': 2.0 * np.pi,\n        'Nx': 64,\n        'Nv': 256,\n        'vmax': 5.0,\n        'dt': 0.05,\n        'Nt': 300,\n        'v_th': 1.0,\n    }\n\n    # Test cases: (k, alpha)\n    test_cases = [\n        (1, 1e-3),\n        (2, 1e-3),\n        (3, 5e-4),\n    ]\n\n    results = []\n    for k_mode, alpha in test_cases:\n        v_res = run_case(k_mode, alpha, params)\n        results.append(v_res)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}