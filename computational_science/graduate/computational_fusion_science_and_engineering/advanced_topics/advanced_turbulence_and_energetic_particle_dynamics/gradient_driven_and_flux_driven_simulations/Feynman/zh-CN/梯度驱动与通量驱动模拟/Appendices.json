{
    "hands_on_practices": [
        {
            "introduction": "这个首个练习提供了梯度驱动和通量驱动模型之间基础性的解析对比。通过求解具有这两种边界条件的稳态输运问题，您将具体理解边界条件的选择如何直接影响最终的物理剖面，在此即温度分布。这个练习  突出了规定剖面斜率与规定物理量流量之间的根本数学和物理差异。",
            "id": "3986727",
            "problem": "考虑一个一维板状区域 $x \\in [0,L]$，它代表了环形聚变装置的一个简化径向坐标。设 $T(x,t)$ 表示一个类温度标量场，该场遵循一个具有体源 $s$（假设其在空间上均匀且不随时间变化）的输运量的守恒。输运通量闭合关系结合了扩散和对流，其形式为 $q(x,t) = -\\chi \\,\\partial T/\\partial x + v\\,T$，其中 $\\chi > 0$ 是一个常数扩散系数，$v > 0$ 是一个常数对流速度。从局域守恒定律 $\\partial T/\\partial t + \\partial q/\\partial x = s$ 出发，推导 $T(x)$ 的稳态方程。\n\n在 $x=0$ 处施加以下两种不同的边界条件，并在 $x=L$ 处施加一个共同的狄利克雷条件：\n\n- 情况 G（梯度驱动）：给定边界梯度 $\\partial T/\\partial x|_{x=0} = G_{0}$。\n- 情况 Q（通量驱动）：给定边界通量 $q(0) = Q_{0}$。\n\n在这两种情况下，均令 $T(L) = T_{L}$。\n\n求解两种情况下的稳态边值问题，并计算中点值的差异的闭式解析表达式：\n$$\n\\Delta T_{\\mathrm{mid}} \\equiv T_{Q}(L/2) - T_{G}(L/2),\n$$\n其中 $T_{Q}$ 和 $T_{G}$ 分别表示在通量驱动和梯度驱动边界条件下的稳态解。将你的最终答案表示为关于 $\\chi$、$v$、$s$、$L$、$G_{0}$、$Q_{0}$ 和 $T_{L}$ 的单个解析表达式。不需要进行数值近似。",
            "solution": "用户希望我解决一个一维稳态输运问题。\n\n### 第一步：提取已知条件\n- **区域**：一维板状区域，$x \\in [0,L]$。\n- **场**：类温度标量场 $T(x,t)$。\n- **守恒定律**：$\\partial T/\\partial t + \\partial q/\\partial x = s$。\n- **源**：体源 $s$，空间均匀且不随时间变化。\n- **输运通量**：$q(x,t) = -\\chi \\,\\partial T/\\partial x + v\\,T$。\n- **常数**：扩散系数 $\\chi > 0$，对流速度 $v > 0$。\n- **问题类型**：稳态，因此 $\\partial T/\\partial t = 0$。\n- **边界条件**：\n    - 在 $x=L$ 处的共同条件：$T(L) = T_{L}$。\n    - **情况 G（梯度驱动）**：在 $x=0$ 处给定梯度，$\\partial T/\\partial x|_{x=0} = G_{0}$。对应的解记为 $T_G(x)$。\n    - **情况 Q（通量驱动）**：在 $x=0$ 处给定通量，$q(0) = Q_{0}$。对应的解记为 $T_Q(x)$。\n- **目标**：计算中点值的差异，$\\Delta T_{\\mathrm{mid}} \\equiv T_{Q}(L/2) - T_{G}(L/2)$。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了一个一维、稳态的对流-扩散-反应方程。这是输运现象中的一个基础且典型的模型，广泛应用于许多科学、技术、工程和数学（STEM）学科，包括作为聚变等离子体中输运的简化模型。其物理基础是合理的。\n- **适定性**：该问题在于为两种不同情况（情况 G 和情况 Q）求解一个二阶线性常微分方程。每种情况下都提供了两个边界条件（一个在 $x=0$，一个在 $x=L$）。情况 G 在 $x=0$ 处使用诺伊曼条件，在 $x=L$ 处使用狄利克雷条件。情况 Q 在 $x=0$ 处使用罗宾条件，在 $x=L$ 处使用狄利克雷条件。两个边值问题都是适定的，确保了 $T_G(x)$ 和 $T_Q(x)$ 存在唯一解。\n- **目标**：问题使用精确的数学语言和输运物理学的标准术语进行陈述。没有主观或模糊的术语。\n- **完整性与一致性**：所有必要的参数（$\\chi, v, s, L, G_0, Q_0, T_L$）和条件都已提供，足以找到唯一解。给定的条件是自洽的。\n- **相关性**：梯度驱动和通量驱动条件之间的区别是计算输运建模中的一个核心主题，尤其是在聚变能源科学中用于模拟等离子体剖面。该问题与指定主题直接相关。\n\n### 第三步：结论与行动\n问题有效。将提供完整解答。\n\n### 求解推导\n\n首先，我们推导稳态输运方程。守恒定律由下式给出\n$$\n\\frac{\\partial T}{\\partial t} + \\frac{\\partial q}{\\partial x} = s\n$$\n在稳态下，$\\frac{\\partial T}{\\partial t} = 0$，因此方程简化为 $\\frac{d q}{d x} = s$。对 $x$ 积分得到通量剖面\n$$\nq(x) = sx + C\n$$\n其中 $C$ 是一个积分常数。在 $x=0$ 处求值，我们发现 $C = q(0)$，即边界 $x=0$ 处的通量。\n现在，我们将通量闭合关系 $q(x) = -\\chi \\frac{dT}{dx} + vT$ 代入稳态守恒定律 $\\frac{d q}{d x} = s$ 中：\n$$\n\\frac{d}{dx}\\left(-\\chi \\frac{dT}{dx} + vT\\right) = s\n$$\n由于 $\\chi$ 和 $v$ 是常数，这得到了关于稳态温度剖面 $T(x)$ 的二阶线性常微分方程（ODE）：\n$$\n-\\chi \\frac{d^2 T}{dx^2} + v \\frac{dT}{dx} = s \\quad \\implies \\quad \\chi \\frac{d^2 T}{dx^2} - v \\frac{dT}{dx} = -s\n$$\n这个 ODE 对 $T_G(x)$ 和 $T_Q(x)$ 都成立。\n\n我们需要求 $\\Delta T_{\\mathrm{mid}} = T_Q(L/2) - T_G(L/2)$。让我们定义差值剖面 $\\delta T(x) = T_Q(x) - T_G(x)$。由于 $T_Q$ 和 $T_G$ 都满足相同的非齐次 ODE，它们的差 $\\delta T(x)$ 必须满足相应的齐次 ODE：\n$$\n\\chi \\frac{d^2(\\delta T)}{dx^2} - v \\frac{d(\\delta T)}{dx} = 0\n$$\n这个齐次 ODE 的通解是 $\\delta T(x) = C_1 + C_2 \\exp\\left(\\frac{v}{\\chi}x\\right)$。\n\n接下来，我们建立 $\\delta T(x)$ 的边界条件。\n在 $x=L$ 处，两个解都满足相同的狄利克雷条件：$T_Q(L) = T_L$ 和 $T_G(L) = T_L$。因此，差值为零：\n$$\n\\delta T(L) = T_Q(L) - T_G(L) = T_L - T_L = 0\n$$\n将此应用于 $\\delta T(x)$ 的通解：\n$$\n\\delta T(L) = C_1 + C_2 \\exp\\left(\\frac{vL}{\\chi}\\right) = 0 \\quad \\implies \\quad C_1 = -C_2 \\exp\\left(\\frac{vL}{\\chi}\\right)\n$$\n将 $C_1$ 代回 $\\delta T(x)$ 的解中：\n$$\n\\delta T(x) = -C_2 \\exp\\left(\\frac{vL}{\\chi}\\right) + C_2 \\exp\\left(\\frac{vx}{\\chi}\\right) = C_2 \\left( \\exp\\left(\\frac{vx}{\\chi}\\right) - \\exp\\left(\\frac{vL}{\\chi}\\right) \\right)\n$$\n这可以重写为 $\\delta T(x) = A \\left(1 - \\exp\\left(\\frac{v}{\\chi}(x-L)\\right)\\right)$，其中 $A$ 是某个常数。\n\n为了求出这个常数，我们需要一个在 $x=0$ 处的条件。让我们考察通量的差异 $\\delta q(x) = q_Q(x) - q_G(x)$。根据积分后的守恒定律 $q(x) = sx + q(0)$，所以\n$$\n\\delta q(x) = (sx + q_Q(0)) - (sx + q_G(0)) = q_Q(0) - q_G(0)\n$$\n通量差是恒定的。我们已知 $q_Q(0) = Q_0$。通量 $q_G(0)$ 是梯度驱动情况的一个结果。我们也可以使用通量的定义来表示 $\\delta q(x)$：\n$$\n\\delta q(x) = \\left(-\\chi \\frac{dT_Q}{dx} + vT_Q\\right) - \\left(-\\chi \\frac{dT_G}{dx} + vT_G\\right) = -\\chi \\frac{d(\\delta T)}{dx} + v\\delta T\n$$\n令 $\\delta q(x)$ 的两个表达式相等：\n$$\n-\\chi \\frac{d(\\delta T)}{dx} + v\\delta T = Q_0 - q_G(0)\n$$\n这是关于 $\\delta T(x)$ 的一阶 ODE。我们可以在 $x=L$ 处对其求值。由于 $\\delta T(L)=0$，我们得到：\n$$\n-\\chi \\left.\\frac{d(\\delta T)}{dx}\\right|_{x=L} = Q_0 - q_G(0)\n$$\n根据我们的解 $\\delta T(x) = A \\left(1 - \\exp\\left(\\frac{v}{\\chi}(x-L)\\right)\\right)$，其导数为 $\\frac{d(\\delta T)}{dx} = -A \\frac{v}{\\chi} \\exp\\left(\\frac{v}{\\chi}(x-L)\\right)$。在 $x=L$ 处：\n$$\n\\left.\\frac{d(\\delta T)}{dx}\\right|_{x=L} = -A \\frac{v}{\\chi}\n$$\n将此代入 $x=L$ 处的通量差分方程中：\n$$\n-\\chi \\left(-A \\frac{v}{\\chi}\\right) = Q_0 - q_G(0) \\implies Av = Q_0 - q_G(0) \\implies A = \\frac{Q_0 - q_G(0)}{v}\n$$\n所以，差值剖面的完整解是：\n$$\n\\delta T(x) = \\frac{Q_0 - q_G(0)}{v} \\left(1 - \\exp\\left(\\frac{v}{\\chi}(x-L)\\right)\\right)\n$$\n现在，我们必须确定 $q_G(0)$。稳态 ODE 的通解是 $T(x) = K_1 + K_2 \\exp\\left(\\frac{v}{\\chi}x\\right) + \\frac{s}{v}x$。对于情况 G，我们应用其边界条件：\n1. $T_G'(0) = G_0$: $T_G'(x) = K_{2G} \\frac{v}{\\chi}\\exp\\left(\\frac{v}{\\chi}x\\right) + \\frac{s}{v}$。在 $x=0$ 处，$K_{2G}\\frac{v}{\\chi} + \\frac{s}{v} = G_0 \\implies K_{2G} = \\frac{\\chi}{v}\\left(G_0 - \\frac{s}{v}\\right)$。\n2. $T_G(L) = T_L$: $K_{1G} + K_{2G}\\exp\\left(\\frac{vL}{\\chi}\\right) + \\frac{sL}{v} = T_L \\implies K_{1G} = T_L - \\frac{sL}{v} - K_{2G}\\exp\\left(\\frac{vL}{\\chi}\\right)$。\n\n得到的通量 $q_G(0)$ 由 $q_G(0) = -\\chi T_G'(0) + v T_G(0) = -\\chi G_0 + v T_G(0)$ 给出。\n我们需要 $T_G(0) = K_{1G} + K_{2G}$。\n$$\nT_G(0) = \\left( T_L - \\frac{sL}{v} - K_{2G}\\exp\\left(\\frac{vL}{\\chi}\\right) \\right) + K_{2G} = T_L - \\frac{sL}{v} + K_{2G}\\left(1 - \\exp\\left(\\frac{vL}{\\chi}\\right)\\right)\n$$\n代入 $K_{2G}$：\n$$\nT_G(0) = T_L - \\frac{sL}{v} + \\frac{\\chi}{v}\\left(G_0 - \\frac{s}{v}\\right)\\left(1 - \\exp\\left(\\frac{vL}{\\chi}\\right)\\right)\n$$\n现在我们求 $q_G(0)$：\n$$\nq_G(0) = -\\chi G_0 + v \\left[ T_L - \\frac{sL}{v} + \\frac{\\chi}{v}\\left(G_0 - \\frac{s}{v}\\right)\\left(1 - \\exp\\left(\\frac{vL}{\\chi}\\right)\\right) \\right]\n$$\n$$\nq_G(0) = -\\chi G_0 + vT_L - sL + \\chi\\left(G_0 - \\frac{s}{v}\\right)\\left(1 - \\exp\\left(\\frac{vL}{\\chi}\\right)\\right)\n$$\n$$\nq_G(0) = -\\chi G_0 + vT_L - sL + \\chi G_0 - \\frac{s\\chi}{v} - \\chi G_0 \\exp\\left(\\frac{vL}{\\chi}\\right) + \\frac{s\\chi}{v}\\exp\\left(\\frac{vL}{\\chi}\\right)\n$$\n$$\nq_G(0) = vT_L - sL - \\frac{s\\chi}{v} - \\left(\\chi G_0 - \\frac{s\\chi}{v}\\right)\\exp\\left(\\frac{vL}{\\chi}\\right) = vT_L-sL-\\frac{s\\chi}{v} + \\chi\\left(\\frac{s}{v} - G_0\\right)\\exp\\left(\\frac{vL}{\\chi}\\right)\n$$\n现在，我们计算常数 $A$：\n$$\nA = \\frac{Q_0 - q_G(0)}{v} = \\frac{1}{v} \\left[ Q_0 - \\left( vT_L - sL - \\frac{s\\chi}{v} + \\chi\\left(\\frac{s}{v} - G_0\\right)\\exp\\left(\\frac{vL}{\\chi}\\right) \\right) \\right]\n$$\n$$\nA = \\frac{1}{v} \\left[ Q_0 - vT_L + sL + \\frac{s\\chi}{v} - \\chi\\left(\\frac{s}{v} - G_0\\right)\\exp\\left(\\frac{vL}{\\chi}\\right) \\right]\n$$\n$$\nA = \\frac{1}{v} \\left[ Q_0 - vT_L + sL + \\frac{s\\chi}{v} + \\chi\\left(G_0 - \\frac{s}{v}\\right)\\exp\\left(\\frac{vL}{\\chi}\\right) \\right]\n$$\n最后，我们在 $x=L/2$ 处计算 $\\delta T(x)$：\n$$\n\\Delta T_{\\mathrm{mid}} = \\delta T(L/2) = A \\left(1 - \\exp\\left(\\frac{v}{\\chi}\\left(\\frac{L}{2}-L\\right)\\right)\\right) = A \\left(1 - \\exp\\left(-\\frac{vL}{2\\chi}\\right)\\right)\n$$\n代入 A 的表达式：\n$$\n\\Delta T_{\\mathrm{mid}} = \\frac{1}{v} \\left[ Q_0 - vT_L + sL + \\frac{s\\chi}{v} + \\chi\\left(G_0 - \\frac{s}{v}\\right)\\exp\\left(\\frac{vL}{\\chi}\\right) \\right] \\left(1 - \\exp\\left(-\\frac{vL}{2\\chi}\\right)\\right)\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{v} \\left( Q_{0} - vT_{L} + sL + \\frac{s\\chi}{v} + \\chi\\left(G_{0} - \\frac{s}{v}\\right)\\exp\\left(\\frac{vL}{\\chi}\\right) \\right) \\left(1 - \\exp\\left(-\\frac{vL}{2\\chi}\\right)\\right)}\n$$"
        },
        {
            "introduction": "在稳态分析的基础上，本问题探究一个更为动态的情景，其中系统由时变通量驱动，这是等离子体实验中探测输运性质的常见情况。您将推导热波的特征“趋肤深度”，它揭示了边缘处的固定温度边界条件如何响应核心热通量，从而塑造剖面并导致边界层的形成 。此练习将帮助您理解在混合边界条件下，局部扰动是如何在扩散系统中传播和衰减的。",
            "id": "3986721",
            "problem": "考虑一个被理想化为一维平板的磁约束聚变等离子体中的径向热输运，坐标为 $x \\in [0,L]$，其中 $x=0$ 代表芯部，$x=L$ 代表外边界。假设跨场热输运是扩散性的，具有恒定的热扩散系数 $\\chi$，并且等离子体可以很好地由热能守恒定律与傅里叶热传导定律耦合来描述。具体来说，径向热通量 $q(x,t)$ 和温度 $T(x,t)$ 在一维空间中满足能量守恒和菲克型闭合，且区域内没有体源。这种设置代表了通量驱动的模拟，即在芯部注入净热通量，同时边界条件固定了边缘温度，这是梯度驱动约束的典型情况。\n\n施加一个固定的外部温度（狄利克雷）边界条件 $T(L,t)=T_{\\mathrm{edge}}$，该条件通过强大的边缘控制系统保持恒定；并在 $x=0$ 处施加一个芯部热通量（诺伊曼）边界条件，形式如下\n$$\nq(0,t)=\\bar{q}+\\tilde{q}\\cos(\\omega t),\n$$\n其中 $\\bar{q}>0$ 是从芯部注入的恒定平均热通量，$\\tilde{q}$ 是一个小振幅调制，$\\omega>0$ 是一个单一角频率。假设该调制足够小，可以围绕由 $\\bar{q}$ 设定的稳态进行线性化，并且调制频率满足高频极限 $\\omega L^{2}/\\chi \\gg 1$，以确保在 $x=L$ 附近形成的任何振荡边界层的厚度远小于 $L$。\n\n从具有恒定 $\\chi$ 的热能守恒和傅里叶定律出发，并且不使用任何现成的“穿透深度”公式，推导叠加在稳态剖面上的时间谐波温度微扰 $\\tilde{T}(x)\\cos(\\omega t+\\phi)$ 的空间结构。证明固定的外部温度条件在 $x=L$ 附近强制形成一个快速变化的层，并通过提取振荡解在远离 $x=L$ 处的指数衰减长度来确定该边界层的特征厚度 $\\delta$。\n\n请以 $\\delta$ 关于 $\\chi$ 和 $\\omega$ 的单个闭式解析表达式的形式提供您的最终答案。不需要进行数值计算。在您的最终方框答案中不要包含单位。如果您选择检查量纲一致性，可以在计算过程中进行。要求的最终答案只是一个单一的表达式。",
            "solution": "用户要求我解决一个聚变等离子体中的热输运问题。\n\n### 步骤1：问题验证\n\n#### 步骤1.1：提取已知条件\n-   **系统：** 一维平板，坐标 $x \\in [0,L]$。\n-   **物理：** 径向热输运是扩散性的。\n-   **方程：** 热能守恒与傅里叶热传导定律耦合。\n-   **参数：** 恒定的热扩散系数 $\\chi$。\n-   **源：** 域 $x \\in (0,L)$ 内无体热源。\n-   **$x=L$ 处的边界条件（狄利克雷）：** $T(L,t) = T_{\\mathrm{edge}}$，随时间恒定。\n-   **$x=0$ 处的边界条件（诺伊曼）：** 热通量 $q(0,t) = \\bar{q} + \\tilde{q}\\cos(\\omega t)$。\n-   **通量边界条件参数：** $\\bar{q}>0$ (平均通量)，$\\tilde{q}$ (小调制振幅)，$\\omega>0$ (角频率)。\n-   **假设：**\n    1.  围绕稳态的线性化是合理的（$\\tilde{q}$ 很小）。\n    2.  高频极限：$\\omega L^2/\\chi \\gg 1$。\n-   **目标：** 推导时间谐波温度微扰 $\\tilde{T}(x)\\cos(\\omega t+\\phi)$ 的空间结构。通过提取振荡解的指数衰减长度来确定 $x=L$ 附近边界层的特征厚度 $\\delta$。\n\n#### 步骤1.2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题使用扩散（热）方程描述热输运，这是物理学和工程学中一个基本且完善的模型。傅里叶定律的使用是标准的。边界条件（固定温度，固定通量）在描述物理系统中很常见。该模型是聚变等离子体中微扰输运实验（热脉冲传播）的标准表示。该问题在科学上是合理的。\n-   **适定性：** 问题为指定域提供了一个具有明确边界条件的偏微分方程。线性化和高频假设将问题简化为可解的形式。预期存在唯一、稳定的解。该问题是适定的。\n-   **客观性：** 语言精确且定量。所有术语在数学物理和等离子体物理中都是标准的。没有主观或基于观点的陈述。\n-   **其他检查：** 问题完整、一致，在理想化物理建模的背景下是现实的。它并非微不足道，需要一个标准但严谨的推导。\n\n#### 步骤1.3：结论和行动\n问题是有效的。我将继续进行求解。\n\n### 步骤2：求解推导\n\n在一个没有体源的一维系统中，热能守恒由下式给出：\n$$\nn c_p \\frac{\\partial T}{\\partial t} + \\frac{\\partial q}{\\partial x} = 0\n$$\n其中 $n$ 是数密度，$c_p$ 是定压比热。傅里叶热传导定律指出，热通量 $q$ 与温度梯度成正比：\n$$\nq = -k_{th} \\frac{\\partial T}{\\partial x}\n$$\n其中 $k_{th}$ 是热导率。问题给出了热扩散系数 $\\chi$，其定义为 $\\chi = k_{th}/(n c_p)$，假设 $n$ 和 $c_p$ 是常数。因此，傅里叶定律可以写成：\n$$\nq = -n c_p \\chi \\frac{\\partial T}{\\partial x}\n$$\n将此代入能量守恒方程，我们得到一维热方程：\n$$\nn c_p \\frac{\\partial T}{\\partial t} - \\frac{\\partial}{\\partial x} \\left(n c_p \\chi \\frac{\\partial T}{\\partial x}\\right) = 0\n$$\n鉴于 $n$、$c_p$ 和 $\\chi$ 是常数，这简化为：\n$$\n\\frac{\\partial T}{\\partial t} = \\chi \\frac{\\partial^2 T}{\\partial x^2}\n$$\n问题指出解可以在稳态周围进行线性化。我们将温度 $T(x,t)$ 分解为稳态分量 $\\bar{T}(x)$ 和一个小的时变微扰 $\\tilde{T}(x,t)$：\n$$\nT(x,t) = \\bar{T}(x) + \\tilde{T}(x,t)\n$$\n将其代入热方程并分离稳态和微扰部分，微扰 $\\tilde{T}(x,t)$ 的方程在形式上与原方程相同：\n$$\n\\frac{\\partial \\tilde{T}}{\\partial t} = \\chi \\frac{\\partial^2 \\tilde{T}}{\\partial x^2}\n$$\n芯部热通量调制是谐波的，因此我们寻求温度微扰的谐波解。为方便起见，我们使用复数表示法，令 $\\tilde{T}(x,t) = \\mathrm{Re}\\{\\hat{T}(x)e^{i\\omega t}\\}$，其中 $\\hat{T}(x)$ 是一个复振幅，它同时编码了微扰的空间振幅和相位。将此形式代入微扰方程，得到：\n$$\ni\\omega \\hat{T}(x)e^{i\\omega t} = \\chi \\frac{d^2 \\hat{T}(x)}{dx^2} e^{i\\omega t}\n$$\n这简化为关于复振幅 $\\hat{T}(x)$ 的一个二阶常微分方程（ODE）：\n$$\n\\frac{d^2 \\hat{T}}{dx^2} = \\frac{i\\omega}{\\chi} \\hat{T}\n$$\n该方程的通解形式为 $\\hat{T}(x) = C_1 e^{kx} + C_2 e^{-kx}$，其中 $C_1$ 和 $C_2$ 是复常数，$k$ 是复波数，定义为：\n$$\nk^2 = \\frac{i\\omega}{\\chi}\n$$\n问题要求解边界层的特征厚度 $\\delta$，它对应于解的指数衰减长度。基本解 $e^{kx}$ 和 $e^{-kx}$ 描述了在空间中指数增长或衰减的波。这种空间衰减或增长的e-折叠距离由波数实部的倒数 $1/|\\mathrm{Re}(k)|$ 给出。我们现在计算这个值。\n\n设 $k = k_r + i k_i$，其中 $k_r$ 和 $k_i$ 分别是 $k$ 的实部和虚部。我们必须求解 $k_r$。对 $k$ 平方得到：\n$$\nk^2 = (k_r + i k_i)^2 = (k_r^2 - k_i^2) + i(2k_r k_i)\n$$\n将其与 $k^2 = i\\omega/\\chi$ 相等，我们可以分离实部和虚部：\n1.  实部：$k_r^2 - k_i^2 = 0$\n2.  虚部：$2k_r k_i = \\omega/\\chi$\n\n从第一个方程可知 $k_r^2 = k_i^2$，这意味着 $|k_r| = |k_i|$。对于一个涉及传播和衰减的有物理意义的解，$k_r$ 和 $k_i$ 都不能为零。我们选择 $k_r > 0$，对应于在 $+x$ 方向上的衰减（或在 $-x$ 方向上的增长）。这给出了两种可能性：$k_i = k_r$ 或 $k_i = -k_r$。将 $k_i = k_r$ 代入第二个方程，得到：\n$$\n2k_r(k_r) = \\frac{\\omega}{\\chi} \\implies 2k_r^2 = \\frac{\\omega}{\\chi}\n$$\n求解 $k_r$：\n$$\nk_r^2 = \\frac{\\omega}{2\\chi} \\implies k_r = \\sqrt{\\frac{\\omega}{2\\chi}}\n$$\n（我们取 $k_r$ 的正根）。如果我们选择 $k_i = -k_r$，我们会得到 $-2k_r^2 = \\omega/\\chi$，因为 $\\omega>0$ 和 $\\chi>0$，所以这对 $k_r$ 没有实数解。因此，我们必须有 $k_r = k_i = \\sqrt{\\omega/2\\chi}$。\n\n因此，复波数为：\n$$\nk = \\sqrt{\\frac{\\omega}{2\\chi}} (1+i)\n$$\n振荡解的空间结构包含像 $e^{\\pm kx}$ 这样的项。这些项的振幅变化形式为 $e^{\\pm k_r x}$。振幅变化一个因子 $e$ 所经过的特征长度是指​​数衰减长度 $\\delta$，定义为波数实部的倒数：\n$$\n\\delta = \\frac{1}{k_r}\n$$\n代入 $k_r$ 的表达式：\n$$\n\\delta = \\frac{1}{\\sqrt{\\frac{\\omega}{2\\chi}}} = \\sqrt{\\frac{2\\chi}{\\omega}}\n$$\n这个长度尺度 $\\delta$ 是高频振荡驱动下扩散过程所固有的，通常被称为趋肤深度或穿透深度。在 $x=L$ 处的固定温度边界条件迫使总温度微扰（即基本解 $e^{kx}$ 和 $e^{-kx}$ 的叠加）为零。在距边界一个特征距离内快速变化并调整为零的过程定义了一个边界层，该层的厚度由长度尺度 $\\delta$ 控制。高频条件 $\\omega L^2/\\chi \\gg 1$ 等效于 $(L/\\delta)^2 \\gg 1$，这确保了平板的宽度是多个衰减长度，使得边界层与芯部区域明显分开。\n\n所要求的推导已经完成。特征厚度 $\\delta$ 是通过分析控制微分方程的基本解得到的，而没有借助任何现成的公式。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{2\\chi}{\\omega}}}\n$$"
        },
        {
            "introduction": "从解析解转向数值模拟，这个练习要求您为等离子体柱实现一个通量驱动的热输运模型。您将使用有限体积法——计算物理中的一种强大技术——来模拟温度剖面如何响应特定的加热源而演化 。这项动手编程任务将理论输运方程与它们在预测性聚变模拟中的实际应用联系起来，让您掌握从连续介质模型到离散计算方案的转化过程。",
            "id": "3986676",
            "problem": "考虑一个在柱坐标系下的磁约束等离子体芯部和边界的一维径向热输运模型。温度分布 $T(r,t)$ 在不随时间变化的体加热源 $S_T(r)$ 和扩散输运的作用下演化。该演化过程由能量守恒和傅里叶 (Fourier) 热传导定律控制，得到如下偏微分方程 (PDE)\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\chi\\,\\frac{\\partial T}{\\partial r}\\right) + S_T(r),\n$$\n其中 $r \\in [0,a]$，$a$ 为小半径，$\\chi$ 为热扩散系数，$S_T(r)$ 为加热源。芯部的无通量边界条件强制要求\n$$\n\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = 0,\n$$\n边界通过罗宾 (Robin) 边界条件与一个热汇耦合，该条件模拟了向刮削层的对流损失，\n$$\n-\\chi\\,\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=a} = h\\,[T(a,t) - T_{\\mathrm{edge}}],\n$$\n其中 $h$ 是传热系数，$T_{\\mathrm{edge}}$ 是给定的边界温度。\n\n这种设置是“通量驱动”的：剖面 $T(r,t)$ 允许随施加的源 $S_T(r)$ 而演化，并且边界处向外的热通量会自洽地调整。在柱坐标系中，对 PDE 按 $r$ 积分可以表明，在稳态下，向外的边界热通量满足\n$$\nF_{\\mathrm{out}} = -\\chi\\,\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=a} = \\frac{1}{a}\\int_{0}^{a} r\\,S_T(r)\\,dr,\n$$\n这体现了通量驱动的平衡。\n\n你的任务是实现一个空间上的有限体积法，并使用一个隐式时间积分器，在不随时间变化的源 $S_T(r)$ 的作用下演化 $T(r,t)$，并强制执行上述边界条件。使用单元中心离散化，包含 $N$ 个均匀的径向单元，单元中心位于 $r_i = \\left(i + \\tfrac{1}{2}\\right)\\Delta r$（其中 $i \\in \\{0,\\dots,N-1\\}$），单元交界面位于 $r_{i+\\frac{1}{2}} = (i+1)\\Delta r$，且 $\\Delta r = a/N$。加热源指定为高斯函数，\n$$\nS_T(r) = S_0 \\exp\\!\\left(-\\left(\\frac{r}{r_s}\\right)^2\\right),\n$$\n其中 $S_0$ 为恒定振幅，$r_s$ 为尺度长度。对所有 $r$，初始化 $T(r,0) = 0$。\n\n实现与柱坐标系一致的离散通量。在 $r=0$ 处的内交界面通量必须为零，以强制执行芯部的无通量边界条件。在 $r=a$ 处的外交界面通量必须满足罗宾条件，在有限体积公式中，这转化为使用以下关系式消除虚拟单元\n$$\n-\\chi\\,\\frac{T_N - T_{N-1}}{\\Delta r} = h\\,[T_{N-1} - T_{\\mathrm{edge}}],\n$$\n其中 $T_N$ 是边界外的虚拟值，$T_{N-1}$ 是边界单元中心的值。使用大小为 $\\Delta t$ 的隐式欧拉时间步演化到最终时间 $t_{\\mathrm{end}}$，构建线性系统\n$$\n\\left(\\mathbf{I} - \\Delta t\\,\\mathbf{L}\\right)\\,\\mathbf{T}^{n+1} = \\mathbf{T}^{n} + \\Delta t\\,\\left(\\mathbf{S} + \\mathbf{g}\\right),\n$$\n其中 $\\mathbf{L}$ 是包含了坐标系和边界条件的离散扩散算子，$\\mathbf{S}$ 是离散源向量，$\\mathbf{g}$ 是由罗宾边界条件的边界温度项产生的常数向量。\n\n单位：$r$ 使用米 (m)，$t$ 使用秒 (s)，$T$ 使用千电子伏 (keV)，$\\chi$ 使用平方米/秒 ($\\mathrm{m}^2/\\mathrm{s}$)，$h$ 使用米/秒 ($\\mathrm{m}/\\mathrm{s}$)，$S_T$ 使用千电子伏/秒 (keV/s)。报告最终向外的边界热通量 $F_{\\mathrm{out}}(t_{\\mathrm{end}})$（单位 keV·m/s）和芯部梯度的模 $\\left|\\partial T/\\partial r\\right|_{r=0}(t_{\\mathrm{end}})$（单位 keV/m）。\n\n设计一个程序，为下述每个测试用例计算这两个量。使用以下测试套件，它涵盖一个常规情况、一个零源情况、一个高扩散系数情况以及一个小区域弱热汇情况：\n\n- 测试用例 $1$ (常规“理想”情况): $a = 1.0\\,\\mathrm{m}$, $\\chi = 1.0\\,\\mathrm{m}^2/\\mathrm{s}$, $h = 3.0\\,\\mathrm{m}/\\mathrm{s}$, $T_{\\mathrm{edge}} = 0.0\\,\\mathrm{keV}$, $S_0 = 2.0\\,\\mathrm{keV}/\\mathrm{s}$, $r_s = 0.3\\,\\mathrm{m}$, $N = 256$, $\\Delta t = 0.01\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 1.5\\,\\mathrm{s}$。\n- 测试用例 $2$ (零源): $a = 1.0\\,\\mathrm{m}$, $\\chi = 1.0\\,\\mathrm{m}^2/\\mathrm{s}$, $h = 3.0\\,\\mathrm{m}/\\mathrm{s}$, $T_{\\mathrm{edge}} = 0.0\\,\\mathrm{keV}$, $S_0 = 0.0\\,\\mathrm{keV}/\\mathrm{s}$, $r_s = 0.3\\,\\mathrm{m}$, $N = 256$, $\\Delta t = 0.1\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 1.0\\,\\mathrm{s}$。\n- 测试用例 $3$ (高扩散系数): $a = 1.0\\,\\mathrm{m}$, $\\chi = 10.0\\,\\mathrm{m}^2/\\mathrm{s}$, $h = 3.0\\,\\mathrm{m}/\\mathrm{s}$, $T_{\\mathrm{edge}} = 0.0\\,\\mathrm{keV}$, $S_0 = 2.0\\,\\mathrm{keV}/\\mathrm{s}$, $r_s = 0.3\\,\\mathrm{m}$, $N = 256$, $\\Delta t = 0.01\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 0.3\\,\\mathrm{s}$。\n- 测试用例 $4$ (小区域，弱热汇): $a = 0.5\\,\\mathrm{m}$, $\\chi = 1.0\\,\\mathrm{m}^2/\\mathrm{s}$, $h = 0.5\\,\\mathrm{m}/\\mathrm{s}$, $T_{\\mathrm{edge}} = 0.0\\,\\mathrm{keV}$, $S_0 = 1.5\\,\\mathrm{keV}/\\mathrm{s}$, $r_s = 0.2\\,\\mathrm{m}$, $N = 256$, $\\Delta t = 0.02\\,\\mathrm{s}$, $t_{\\mathrm{end}} = 1.0\\,\\mathrm{s}$。\n\n对每个测试用例，计算：\n- 最终向外的边界热通量 $F_{\\mathrm{out}}(t_{\\mathrm{end}}) = h\\,[T(a,t_{\\mathrm{end}}) - T_{\\mathrm{edge}}]$（单位 keV·m/s）。\n- 芯部梯度的模 $\\left|\\partial T/\\partial r\\right|_{r=0}(t_{\\mathrm{end}})$（单位 keV/m），通过最内层单元中心的单边差分近似。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。该列表必须按以下顺序包含 $8$ 个浮点数\n$$\n\\left[F_{\\mathrm{out}}^{(1)},\\left|\\partial_r T\\right|_{0}^{(1)},F_{\\mathrm{out}}^{(2)},\\left|\\partial_r T\\right|_{0}^{(2)},F_{\\mathrm{out}}^{(3)},\\left|\\partial_r T\\right|_{0}^{(3)},F_{\\mathrm{out}}^{(4)},\\left|\\partial_r T\\right|_{0}^{(4)}\\right],\n$$\n其中上标 $^{(k)}$ 指的是测试用例 $k$。",
            "solution": "该问题要求使用有限体积法，对柱坐标系下的一维径向热输运方程进行数值求解。我们将首先验证问题陈述，然后通过离散化控制性偏微分方程 (PDE) 和实现指定的边界条件来构建解决方案。\n\n温度分布 $T(r,t)$ 的控制性 PDE 如下所示：\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\chi\\,\\frac{\\partial T}{\\partial r}\\right) + S_T(r)\n$$\n该方程描述了能量守恒，其中温度随时间的变化由热扩散（右侧第一项）和体热源 $S_T(r)$ 驱动。热扩散系数 $\\chi$ 假定为常数。\n\n为了数值求解该方程，我们采用有限体积法。径向区域 $r \\in [0, a]$ 被划分为 $N$ 个均匀单元。第 $i$ 个单元（$i \\in \\{0, 1, \\dots, N-1\\}$）由区间 $[r_{i-1/2}, r_{i+1/2}]$ 定义，其中单元交界面位于 $r_{i+1/2} = (i+1)\\Delta r$，且 $\\Delta r = a/N$。单元中心位于 $r_i = (i + 1/2)\\Delta r$。单元 $i$ 内的温度由单个值 $T_i(t)$ 表示，它是对单元中心温度 $T(r_i, t)$ 的近似。\n\n我们首先将 PDE 乘以 $r$，然后在第 $i$ 个单元的体积上积分，在一维情况下（单位长度和角度），这对应于从 $r_{i-1/2}$ 到 $r_{i+1/2}$ 的积分：\n$$\n\\int_{r_{i-1/2}}^{r_{i+1/2}} r \\frac{\\partial T}{\\partial t} \\,dr = \\int_{r_{i-1/2}}^{r_{i+1/2}} \\frac{\\partial}{\\partial r}\\left(r\\,\\chi\\,\\frac{\\partial T}{\\partial r}\\right) \\,dr + \\int_{r_{i-1/2}}^{r_{i+1/2}} r S_T(r) \\,dr\n$$\n对于在单元上平滑变化的量，使用中点法则近似积分，我们得到：\n$$\n(r_i \\Delta r) \\frac{dT_i}{dt} \\approx \\left[r\\,\\chi\\,\\frac{\\partial T}{\\partial r}\\right]_{r_{i+1/2}} - \\left[r\\,\\chi\\,\\frac{\\partial T}{\\partial r}\\right]_{r_{i-1/2}} + (r_i \\Delta r) S_T(r_i)\n$$\n右边的项表示穿过单元交界面的热通量。让我们定义径向热通量密度为 $F_r = -\\chi \\frac{\\partial T}{\\partial r}$，因此项 $r \\chi \\frac{\\partial T}{\\partial r}$ 即为 $-r F_r$。我们使用中心差分格式在单元交界面上离散化空间导数：\n$$\n\\left.\\frac{\\partial T}{\\partial r}\\right|_{r_{i+1/2}} \\approx \\frac{T_{i+1} - T_i}{\\Delta r}\n$$\n在交界面 $r_{i+1/2}$ 处的通量项变为：\n$$\nJ_{i+1/2} = \\left[r\\,\\chi\\,\\frac{\\partial T}{\\partial r}\\right]_{r_{i+1/2}} \\approx r_{i+1/2} \\chi \\frac{T_{i+1} - T_i}{\\Delta r}\n$$\n将此代入积分方程并除以 $r_i \\Delta r$，得到内部单元 $i \\in \\{1, \\dots, N-2\\}$ 的半离散方程：\n$$\n\\frac{dT_i}{dt} = \\frac{1}{r_i \\Delta r} \\left( r_{i+1/2} \\chi \\frac{T_{i+1} - T_i}{\\Delta r} - r_{i-1/2} \\chi \\frac{T_i - T_{i-1}}{\\Delta r} \\right) + S_i\n$$\n其中 $S_i = S_T(r_i)$。\n\n现在，我们必须为芯部 ($i=0$) 和边界 ($i=N-1$) 的单元引入边界条件。\n\n对于芯部单元 ($i=0$)，其区域为 $[r_{-1/2}, r_{1/2}] = [0, \\Delta r]$。中心的无通量边界条件 $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = 0$ 意味着在交界面 $r_{-1/2}=0$ 处的通量为零，即 $J_{-1/2} = 0$。单元 0 的方程变为：\n$$\n\\frac{dT_0}{dt} = \\frac{1}{r_0 \\Delta r} \\left( J_{1/2} - J_{-1/2} \\right) + S_0 = \\frac{1}{r_0 \\Delta r} \\left( r_{1/2} \\chi \\frac{T_1 - T_0}{\\Delta r} - 0 \\right) + S_0\n$$\n代入 $r_0 = \\Delta r/2$ 和 $r_{1/2} = \\Delta r$：\n$$\n\\frac{dT_0}{dt} = \\frac{1}{(\\Delta r/2) \\Delta r} \\left( \\Delta r \\chi \\frac{T_1 - T_0}{\\Delta r} \\right) + S_0 = \\frac{2\\chi}{\\Delta r^2} (T_1 - T_0) + S_0\n$$\n\n对于边界单元 ($i=N-1$)，其区域为 $[r_{N-3/2}, r_{N-1/2}] = [r_{N-3/2}, a]$。在外交界面 $r_{N-1/2}=a$ 处的通量由罗宾边界条件确定：\n$$\n-\\chi\\,\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=a} = h\\,[T(a,t) - T_{\\mathrm{edge}}]\n$$\n通量项 $J_{N-1/2}$ 为 $\\left. r \\chi \\frac{\\partial T}{\\partial r} \\right|_{r=a} = a \\chi \\left. \\frac{\\partial T}{\\partial r} \\right|_{r=a}$。使用罗宾条件，这变为：\n$$\nJ_{N-1/2} = -a h [T(a,t) - T_{\\mathrm{edge}}]\n$$\n我们用最后一个单元中心的温度 $T_{N-1}$ 来近似边界处的温度 $T(a,t)$。因此，$J_{N-1/2} \\approx -a h (T_{N-1} - T_{\\mathrm{edge}})$。单元 $N-1$ 的方程是：\n$$\n\\frac{dT_{N-1}}{dt} = \\frac{1}{r_{N-1} \\Delta r} \\left( J_{N-1/2} - J_{N-3/2} \\right) + S_{N-1}\n$$\n$$\n\\frac{dT_{N-1}}{dt} = \\frac{1}{r_{N-1} \\Delta r} \\left( -a h (T_{N-1} - T_{\\mathrm{edge}}) - r_{N-3/2} \\chi \\frac{T_{N-1} - T_{N-2}}{\\Delta r} \\right) + S_{N-1}\n$$\n这个包含 $N$ 个常微分方程的系统可以写成矩阵形式：\n$$\n\\frac{d\\mathbf{T}}{dt} = \\mathbf{L}\\mathbf{T} + \\mathbf{S} + \\mathbf{g}\n$$\n其中 $\\mathbf{T}$ 是单元温度向量 $[T_0, T_1, \\dots, T_{N-1}]^T$，$\\mathbf{L}$ 是表示离散扩散算子的三对角矩阵，$\\mathbf{S}$ 是源项向量 $[S_0, S_1, \\dots, S_{N-1}]^T$，$\\mathbf{g}$ 是一个包含边界条件常数部分的向量。只有 $\\mathbf{g}$ 的最后一个元素非零：$g_{N-1} = \\frac{ahT_{\\mathrm{edge}}}{r_{N-1}\\Delta r}$。矩阵 $\\mathbf{L}$ 具有以下非零元素：\n- 上对角线 ($i \\in \\{0, \\dots, N-2\\}$): $L_{i, i+1} = \\frac{\\chi}{\\Delta r^2} \\frac{r_{i+1/2}}{r_i} = \\frac{\\chi}{\\Delta r^2} \\frac{i+1}{i+0.5}$\n- 主对角线 ($i \\in \\{0, \\dots, N-2\\}$): $L_{i,i} = -\\frac{\\chi}{\\Delta r^2}\\frac{r_{i+1/2}+r_{i-1/2}}{r_i} = - \\frac{2\\chi}{\\Delta r^2}$ (当 $i=0$ 时 $r_{-1/2}=0$)\n- 主对角线 (边界, $i=N-1$): $L_{N-1,N-1} = -\\frac{ah}{r_{N-1}\\Delta r} - \\frac{\\chi r_{N-3/2}}{r_{N-1}\\Delta r^2} = -\\frac{Nh}{(N-0.5)\\Delta r} - \\frac{\\chi(N-1)}{(N-0.5)\\Delta r^2}$\n- 下对角线 ($i \\in \\{1, \\dots, N-1\\}$): $L_{i, i-1} = \\frac{\\chi}{\\Delta r^2} \\frac{r_{i-1/2}}{r_i} = \\frac{\\chi}{\\Delta r^2} \\frac{i}{i+0.5}$\n\n对于时间积分，我们使用无条件稳定的隐式欧拉方法。时间导数近似为 $\\frac{d\\mathbf{T}}{dt} \\approx \\frac{\\mathbf{T}^{n+1} - \\mathbf{T}^n}{\\Delta t}$。隐式格式在未来的时间步 $n+1$ 处计算右侧项：\n$$\n\\frac{\\mathbf{T}^{n+1} - \\mathbf{T}^n}{\\Delta t} = \\mathbf{L}\\mathbf{T}^{n+1} + \\mathbf{S} + \\mathbf{g}\n$$\n重新排列各项以求解 $\\mathbf{T}^{n+1}$，我们得到问题中指定的线性系统：\n$$\n(\\mathbf{I} - \\Delta t \\mathbf{L}) \\mathbf{T}^{n+1} = \\mathbf{T}^n + \\Delta t (\\mathbf{S} + \\mathbf{g})\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。在每个时间步，我们求解这个三对角线性系统以得到 $\\mathbf{T}^{n+1}$。初始条件是 $T(r,0)=0$，所以 $\\mathbf{T}^0 = \\mathbf{0}$。\n\n将系统演化到最终时间 $t_{\\mathrm{end}}$ 后，我们计算所需的量。\n最终向外的边界热通量由对流损失项给出：\n$$\nF_{\\mathrm{out}}(t_{\\mathrm{end}}) = h\\,[T(a,t_{\\mathrm{end}}) - T_{\\mathrm{edge}}] \\approx h\\,[T_{N-1}(t_{\\mathrm{end}}) - T_{\\mathrm{edge}}]\n$$\n芯部梯度的模通过两个最内层单元中心之间的单边有限差分来近似：\n$$\n\\left|\\frac{\\partial T}{\\partial r}\\right|_{r=0}(t_{\\mathrm{end}}) \\approx \\left| \\frac{T_1(t_{\\mathrm{end}}) - T_0(t_{\\mathrm{end}})}{\\Delta r} \\right|\n$$\n这个量是芯部附近剖面形状的一个简单数值诊断，尽管它代表的是 $r \\approx \\Delta r/2$ 处的梯度，而不是 $r=0$ 处的梯度（根据对称性，解析梯度在该处为零）。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases for the plasma heat transport problem.\n    \"\"\"\n    test_cases = [\n        # Test Case 1 (general “happy path”)\n        (1.0, 1.0, 3.0, 0.0, 2.0, 0.3, 256, 0.01, 1.5),\n        # Test Case 2 (zero source)\n        (1.0, 1.0, 3.0, 0.0, 0.0, 0.3, 256, 0.1, 1.0),\n        # Test Case 3 (high diffusivity)\n        (1.0, 10.0, 3.0, 0.0, 2.0, 0.3, 256, 0.01, 0.3),\n        # Test Case 4 (small domain, weak sink)\n        (0.5, 1.0, 0.5, 0.0, 1.5, 0.2, 256, 0.02, 1.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        F_out, core_grad_mag = simulate_heat_transport(*params)\n        results.extend([F_out, core_grad_mag])\n    \n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\ndef simulate_heat_transport(a, chi, h, T_edge, S0, rs, N, dt, t_end):\n    \"\"\"\n    Solves the 1D radial heat transport equation using a finite-volume method.\n\n    Args:\n        a (float): Minor radius [m].\n        chi (float): Thermal diffusivity [m^2/s].\n        h (float): Heat-transfer coefficient [m/s].\n        T_edge (float): Prescribed edge temperature [keV].\n        S0 (float): Heating source amplitude [keV/s].\n        rs (float): Heating source scale length [m].\n        N (int): Number of radial cells.\n        dt (float): Time step size [s].\n        t_end (float): Final simulation time [s].\n\n    Returns:\n        tuple: A tuple containing:\n            - F_out (float): Final outward edge heat flux [keV·m/s].\n            - core_grad_mag (float): Magnitude of the core gradient approximation [keV/m].\n    \"\"\"\n    dr = a / N\n    \n    # Grid setup\n    i_vals = np.arange(N)\n    r_centers = (i_vals + 0.5) * dr\n\n    # Source vector S\n    S_vec = S0 * np.exp(-(r_centers / rs)**2) if rs > 0 else np.full(N, S0)\n\n    # Constant boundary vector g\n    g_vec = np.zeros(N)\n    # The term is only non-zero if h != 0 and T_edge != 0.\n    if abs(h) > 0 and abs(T_edge) > 0:\n        g_vec[N - 1] = (a * h * T_edge) / (r_centers[N - 1] * dr)\n\n    # Build the diffusion matrix L\n    L_main = np.zeros(N)\n    L_upper = np.zeros(N - 1)\n    L_lower = np.zeros(N - 1)\n\n    # Vectorized calculation for L matrix components\n    i_upper = np.arange(N - 1)  # Matrix indices i=0 to N-2\n    L_upper = (chi / dr**2) * ((i_upper + 1) / (i_upper + 0.5))\n\n    i_lower = np.arange(1, N)  # Matrix indices i=1 to N-1\n    L_lower = (chi / dr**2) * (i_lower / (i_lower + 0.5))\n\n    L_main[:N-1] = -2.0 * chi / dr**2\n    L_main[N-1] = -(N * h / ((N - 0.5) * dr)) - (chi * (N - 1) / ((N - 0.5) * dr**2))\n\n    # Form the implicit evolution matrix M = I - dt*L for solve_banded\n    # M_banded[0,:] = super-diagonal (upper), M_banded[1,:] = main diagonal, M_banded[2,:] = sub-diagonal (lower)\n    M_banded = np.zeros((3, N))\n    M_banded[0, 1:] = -dt * L_upper\n    M_banded[1, :] = 1.0 - dt * L_main\n    M_banded[2, :-1] = -dt * L_lower\n\n    # Time evolution loop\n    T = np.zeros(N)  # Initial condition T(r,0) = 0\n    num_steps = int(round(t_end / dt))\n    \n    # Pre-calculate the time-independent part of the right-hand side\n    rhs_const_part = dt * (S_vec + g_vec)\n    \n    for _ in range(num_steps):\n        rhs = T + rhs_const_part\n        T = solve_banded((1, 1), M_banded, rhs)\n\n    # Calculate final quantities\n    F_out = h * (T[N - 1] - T_edge)\n    core_grad_mag = np.abs((T[1] - T[0]) / dr)\n    \n    return F_out, core_grad_mag\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}