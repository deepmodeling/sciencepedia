{
    "hands_on_practices": [
        {
            "introduction": "理解高能粒子轨道的第一步是掌握引导中心漂移。本练习为在简化的、但具有代表性的托卡马克几何中，从第一性原理出发推导这些漂移速度（梯度B漂移和曲率漂移）提供了必要的实践。掌握这种解析计算是开发或使用复杂轨道跟踪代码的先决条件，它能帮助你深入理解控制粒子轨迹的基本物理效应 。",
            "id": "4025430",
            "problem": "考虑一个托卡马克类型的环形约束装置，其大半径为 $R_{0}$，具有圆形同心磁通量面，小半径为 $r$，且满足 $r \\ll R_{0}$ (大环径比)。使用柱坐标系 $(R,\\phi,Z)$，其标准正交基为 $\\{\\hat{\\mathbf{e}}_{R},\\hat{\\mathbf{e}}_{\\phi},\\hat{\\mathbf{e}}_{Z}\\}$，并引入由 $R = R_{0} + r \\cos\\theta$ 和 $Z = r \\sin\\theta$ 定义的极向角 $\\theta$。假设轴对称，并且磁场是占主导地位的环向分量和较小的极向分量的叠加。环向磁场的大小按 $B_{\\phi}(R) = B_{0}\\,R_{0}/R$ 比例变化，其中 $B_{0}$ 是一个常数。安全因子 $q(r)$ 定义为 $q = \\frac{r\\,B_{\\phi}}{R_{0}\\,B_{\\theta}}$。\n\n仅从这些定义和标准的导心漂移公式出发，并一致地计算到反环径比 $\\varepsilon = r/R_{0}$ 的领头阶（忽略 $\\varepsilon^{2}$ 及更高阶的项）：\n\n1) 使用极向单位矢量 $\\hat{\\mathbf{e}}_{\\theta} = -\\sin\\theta\\,\\hat{\\mathbf{e}}_{R} + \\cos\\theta\\,\\hat{\\mathbf{e}}_{Z}$，在柱坐标系中用 $B_{\\phi}(R)$、$q(r)$、$r$ 和 $\\theta$ 表示磁场 $\\mathbf{B}(R,Z)$。\n\n2) 在柱坐标系中，计算磁场大小的梯度矢量 $\\nabla B$ 和磁曲率矢量 $\\boldsymbol{\\kappa} = \\hat{\\mathbf{b}}\\cdot\\nabla\\hat{\\mathbf{b}}$ 到 $\\varepsilon$ 的领头阶，其中 $\\hat{\\mathbf{b}} = \\mathbf{B}/|\\mathbf{B}|$ 是磁场单位矢量。\n\n3) 利用你的结果，推导一个带电荷 $q_{i}$、质量为 $m_{i}$、具有平行速度 $v_{\\parallel}$ 和垂直速度 $v_{\\perp}$ 的高能离子，在外侧中平面 $\\theta = 0$ 处的总磁漂移速度。总磁漂移速度是梯度B漂移和曲率漂移之和。将你的最终答案表示为柱坐标分量 $(v_{R}, v_{\\phi}, v_{Z})$ 的单个闭式解析行矢量，仅保留 $\\varepsilon$ 的领头阶项。不需要数值计算或四舍五入，并且最终表达式中不包含单位。",
            "solution": "经评估，问题陈述有效。其科学基础是等离子体物理和磁约束聚变的原理，特别是托卡马克中带电粒子运动的导心近似。问题提法得当、客观，并包含足够的信息，可以在指定的近似下得到唯一的解析解。不存在科学缺陷、矛盾或模糊之处。\n\n解答按问题要求分三部分进行。\n\n第1部分：磁场 $\\mathbf{B}$ 的表达式\n\n磁场 $\\mathbf{B}$ 是其环向分量和极向分量之和，$\\mathbf{B} = \\mathbf{B}_{\\phi} + \\mathbf{B}_{p}$。在柱坐标基中，环向分量是 $\\mathbf{B}_{\\phi} = B_{\\phi} \\hat{\\mathbf{e}}_{\\phi}$。极向分量沿极向单位矢量 $\\hat{\\mathbf{e}}_{\\theta}$ 方向，因此 $\\mathbf{B}_{p} = B_{\\theta} \\hat{\\mathbf{e}}_{\\theta}$。使用给定的 $\\hat{\\mathbf{e}}_{\\theta}$ 表达式，总磁场为：\n$$\n\\mathbf{B} = B_{\\phi} \\hat{\\mathbf{e}}_{\\phi} + B_{\\theta} (-\\sin\\theta\\,\\hat{\\mathbf{e}}_{R} + \\cos\\theta\\,\\hat{\\mathbf{e}}_{Z})\n$$\n$$\n\\mathbf{B} = - B_{\\theta} \\sin\\theta\\,\\hat{\\mathbf{e}}_{R} + B_{\\phi} \\hat{\\mathbf{e}}_{\\phi} + B_{\\theta} \\cos\\theta\\,\\hat{\\mathbf{e}}_{Z}\n$$\n接下来，我们将大小 $B_{\\phi}$ 和 $B_{\\theta}$ 用给定参数表示，并计算到反环径比 $\\varepsilon = r/R_{0}$ 的领头阶。环向坐标 $R$ 由 $R = R_{0} + r \\cos\\theta = R_{0}(1 + \\varepsilon \\cos\\theta)$ 给出。\n环向磁场大小为 $B_{\\phi}(R) = B_{0} R_{0}/R$。代入 $R$ 的表达式：\n$$\nB_{\\phi} = \\frac{B_{0} R_{0}}{R_{0}(1 + \\varepsilon \\cos\\theta)} = B_{0}(1 + \\varepsilon \\cos\\theta)^{-1}\n$$\n对小 $x$ 使用二项式展开 $(1+x)^{n} \\approx 1+nx$，我们得到 $\\varepsilon$ 的一阶项：\n$$\nB_{\\phi} \\approx B_{0}(1 - \\varepsilon \\cos\\theta)\n$$\n极向磁场大小 $B_{\\theta}$ 由安全因子 $q(r) = \\frac{r B_{\\phi}}{R_{0} B_{\\theta}}$ 的定义给出。\n$$\nB_{\\theta} = \\frac{r B_{\\phi}}{R_{0} q(r)} = \\frac{\\varepsilon B_{\\phi}}{q(r)}\n$$\n由于 $B_{\\theta}$ 本身已是 $\\varepsilon$ 阶，为获得其领头阶表达式，我们可以使用 $B_{\\phi}$ 的领头阶表达式，即 $B_{\\phi} \\approx B_{0}$。\n$$\nB_{\\theta} \\approx \\frac{\\varepsilon B_{0}}{q(r)} = \\frac{r B_{0}}{R_{0} q(r)}\n$$\n将 $B_{\\phi}$ 和 $B_{\\theta}$ 的这些表达式代入 $\\mathbf{B}$ 的矢量表达式中，我们得到在柱坐标系中到 $\\varepsilon$ 领头阶的磁场：\n$$\n\\mathbf{B}(r,\\theta) \\approx -\\frac{r B_{0}}{R_{0} q(r)}\\sin\\theta\\,\\hat{\\mathbf{e}}_{R} + B_{0}(1 - \\frac{r}{R_{0}}\\cos\\theta)\\hat{\\mathbf{e}}_{\\phi} + \\frac{r B_{0}}{R_{0} q(r)}\\cos\\theta\\,\\hat{\\mathbf{e}}_{Z}\n$$\n\n第2部分：$\\nabla B$ 和 $\\boldsymbol{\\kappa}$ 的计算\n\n首先，我们求磁场的大小，$B = |\\mathbf{B}|$。\n$$\nB^{2} = B_{R}^{2} + B_{\\phi}^{2} + B_{Z}^{2} \\approx \\left(-\\frac{\\varepsilon B_{0}}{q}\\sin\\theta\\right)^{2} + \\left(B_{0}(1 - \\varepsilon\\cos\\theta)\\right)^{2} + \\left(\\frac{\\varepsilon B_{0}}{q}\\cos\\theta\\right)^{2}\n$$\n$$\nB^{2} \\approx \\frac{\\varepsilon^{2} B_{0}^{2}}{q^{2}}\\sin^{2}\\theta + B_{0}^{2}(1 - 2\\varepsilon\\cos\\theta + \\varepsilon^{2}\\cos^{2}\\theta) + \\frac{\\varepsilon^{2} B_{0}^{2}}{q^{2}}\\cos^{2}\\theta\n$$\n$$\nB^{2} \\approx B_{0}^{2} \\left( 1 - 2\\varepsilon\\cos\\theta + \\frac{\\varepsilon^{2}}{q^{2}} + \\varepsilon^{2}\\cos^{2}\\theta \\right)\n$$\n忽略 $\\varepsilon^{2}$ 及更高阶的项，我们得到 $B^{2} \\approx B_{0}^{2}(1 - 2\\varepsilon\\cos\\theta)$。取平方根并使用二项式近似：\n$$\nB \\approx B_{0}(1 - 2\\varepsilon\\cos\\theta)^{1/2} \\approx B_{0}(1 - \\varepsilon\\cos\\theta)\n$$\n这表明在领头阶上，$B \\approx B_{\\phi}$。一个更简单且完全一致的方法是认识到 $B_{\\theta}^{2}$ 是 $\\varepsilon^{2}B_{0}^{2}$ 阶的，因此它对 $B$ 的一阶贡献可以忽略不计。因此，我们可以用环向分量来近似磁场的大小：\n$$\nB(R,Z) \\approx B_{\\phi}(R) = \\frac{B_{0} R_{0}}{R}\n$$\n现在我们在柱坐标系中计算 $B$ 的梯度。梯度算子是 $\\nabla = \\hat{\\mathbf{e}}_{R}\\frac{\\partial}{\\partial R} + \\hat{\\mathbf{e}}_{\\phi}\\frac{1}{R}\\frac{\\partial}{\\partial \\phi} + \\hat{\\mathbf{e}}_{Z}\\frac{\\partial}{\\partial Z}$。由于 $B$ 仅依赖于 $R$：\n$$\n\\nabla B = \\nabla\\left(\\frac{B_{0} R_{0}}{R}\\right) = B_{0} R_{0} \\nabla\\left(\\frac{1}{R}\\right) = B_{0} R_{0} \\left(-\\frac{1}{R^{2}}\\hat{\\mathbf{e}}_{R}\\right) = -\\frac{B_{0} R_{0}}{R^{2}}\\hat{\\mathbf{e}}_{R}\n$$\n通过在系数中设置 $R \\approx R_{0}$ 来找到领头阶项：\n$$\n\\nabla B \\approx -\\frac{B_{0}}{R_{0}}\\hat{\\mathbf{e}}_{R}\n$$\n接下来，我们计算磁曲率矢量 $\\boldsymbol{\\kappa} = (\\hat{\\mathbf{b}}\\cdot\\nabla)\\hat{\\mathbf{b}}$，其中 $\\hat{\\mathbf{b}} = \\mathbf{B}/B$ 是沿磁场方向的单位矢量。到领头阶，磁场是纯环向的，$\\mathbf{B} \\approx B_{0}\\hat{\\mathbf{e}}_{\\phi}$，所以 $\\hat{\\mathbf{b}} \\approx \\hat{\\mathbf{e}}_{\\phi}$。因此，方向导数算子 $\\hat{\\mathbf{b}}\\cdot\\nabla$ 中的主导项是 $(\\hat{\\mathbf{e}}_{\\phi}\\cdot\\nabla) = \\frac{1}{R}\\frac{\\partial}{\\partial\\phi}$。将此应用于 $\\hat{\\mathbf{b}} \\approx \\hat{\\mathbf{e}}_{\\phi}$ 需要对基矢量 $\\hat{\\mathbf{e}}_{\\phi}$ 求导，即 $\\frac{\\partial\\hat{\\mathbf{e}}_{\\phi}}{\\partial\\phi} = -\\hat{\\mathbf{e}}_{R}$。\n$$\n\\boldsymbol{\\kappa} \\approx (\\hat{\\mathbf{e}}_{\\phi}\\cdot\\nabla)\\hat{\\mathbf{e}}_{\\phi} = \\frac{1}{R}\\frac{\\partial\\hat{\\mathbf{e}}_{\\phi}}{\\partial\\phi} = -\\frac{1}{R}\\hat{\\mathbf{e}}_{R}\n$$\n到领头阶，当 $R \\approx R_{0}$ 时：\n$$\n\\boldsymbol{\\kappa} \\approx -\\frac{1}{R_{0}}\\hat{\\mathbf{e}}_{R}\n$$\n\n第3部分：磁漂移速度的推导\n\n总磁漂移速度 $\\mathbf{v}_{m}$ 是梯度B漂移 $\\mathbf{v}_{\\nabla B}$ 和曲率漂移 $\\mathbf{v}_{\\kappa}$ 的和：\n$$\n\\mathbf{v}_{m} = \\mathbf{v}_{\\nabla B} + \\mathbf{v}_{\\kappa} = \\frac{m_{i} v_{\\perp}^{2}}{2 q_{i} B^{2}}(\\hat{\\mathbf{b}} \\times \\nabla B) + \\frac{m_{i} v_{\\parallel}^{2}}{q_{i} B}(\\hat{\\mathbf{b}} \\times \\boldsymbol{\\kappa})\n$$\n我们可以合并这些项：\n$$\n\\mathbf{v}_{m} = \\frac{m_{i}}{q_{i}B} \\left( \\hat{\\mathbf{b}} \\times \\left( \\frac{v_{\\perp}^{2}}{2B} \\nabla B + v_{\\parallel}^{2} \\boldsymbol{\\kappa} \\right) \\right)\n$$\n我们在外侧中平面 $\\theta=0$ 处计算此表达式的值。在此位置，我们使用所涉及量的领头阶表达式：\n$R = R_{0}+r$, $Z=0$。\n$B \\approx B_{0}(1-\\varepsilon\\cos(0)) = B_{0}(1-\\varepsilon)$. 到领头阶，$B \\approx B_{0}$。\n$\\hat{\\mathbf{b}} \\approx \\hat{\\mathbf{e}}_{\\phi}$。（在 $\\theta=0$ 处，$\\hat{\\mathbf{e}}_Z$ 分量是 $O(\\varepsilon)$ 阶的）。\n$\\nabla B \\approx -\\frac{B_{0}}{R_{0}}\\hat{\\mathbf{e}}_{R}$。\n$\\boldsymbol{\\kappa} \\approx -\\frac{1}{R_{0}}\\hat{\\mathbf{e}}_{R}$。\n\n将这些领头阶表达式代入漂移速度公式：\n$$\n\\mathbf{v}_{m} \\approx \\frac{m_{i}}{q_{i}B_{0}} \\left( \\hat{\\mathbf{e}}_{\\phi} \\times \\left( \\frac{v_{\\perp}^{2}}{2B_{0}} \\left(-\\frac{B_{0}}{R_{0}}\\hat{\\mathbf{e}}_{R}\\right) + v_{\\parallel}^{2} \\left(-\\frac{1}{R_{0}}\\hat{\\mathbf{e}}_{R}\\right) \\right) \\right)\n$$\n$$\n\\mathbf{v}_{m} \\approx \\frac{m_{i}}{q_{i}B_{0}} \\left( \\hat{\\mathbf{e}}_{\\phi} \\times \\left( -\\frac{v_{\\perp}^{2}}{2R_{0}}\\hat{\\mathbf{e}}_{R} - \\frac{v_{\\parallel}^{2}}{R_{0}}\\hat{\\mathbf{e}}_{R} \\right) \\right)\n$$\n$$\n\\mathbf{v}_{m} \\approx \\frac{m_{i}}{q_{i}B_{0}} \\left( \\hat{\\mathbf{e}}_{\\phi} \\times \\left( -\\frac{1}{R_{0}} \\left( \\frac{v_{\\perp}^{2}}{2} + v_{\\parallel}^{2} \\right) \\hat{\\mathbf{e}}_{R} \\right) \\right)\n$$\n$$\n\\mathbf{v}_{m} \\approx -\\frac{m_{i}}{q_{i}B_{0}R_{0}} \\left( \\frac{v_{\\perp}^{2}}{2} + v_{\\parallel}^{2} \\right) (\\hat{\\mathbf{e}}_{\\phi} \\times \\hat{\\mathbf{e}}_{R})\n$$\n使用柱坐标基矢量的右手定则，$\\hat{\\mathbf{e}}_{\\phi} \\times \\hat{\\mathbf{e}}_{R} = -\\hat{\\mathbf{e}}_{Z}$。\n$$\n\\mathbf{v}_{m} \\approx -\\frac{m_{i}}{q_{i}B_{0}R_{0}} \\left( \\frac{v_{\\perp}^{2}}{2} + v_{\\parallel}^{2} \\right) (-\\hat{\\mathbf{e}}_{Z})\n$$\n$$\n\\mathbf{v}_{m} \\approx \\frac{m_{i}}{q_{i}B_{0}R_{0}} \\left( \\frac{v_{\\perp}^{2}}{2} + v_{\\parallel}^{2} \\right) \\hat{\\mathbf{e}}_{Z}\n$$\n这就是领头阶的磁漂移速度。表示为柱坐标分量 $(v_{R}, v_{\\phi}, v_{Z})$ 的行矢量，结果是：\n$$\n\\mathbf{v}_{m} = \\left( 0,  0,  \\frac{m_{i}}{q_{i}B_{0}R_{0}} \\left( \\frac{v_{\\perp}^{2}}{2} + v_{\\parallel}^{2} \\right) \\right)\n$$",
            "answer": "$$\n\\boxed{\\left( 0,  0,  \\frac{m_{i}}{q_{i}B_{0}R_{0}} \\left(\\frac{v_{\\perp}^{2}}{2} + v_{\\parallel}^{2}\\right) \\right)}\n$$"
        },
        {
            "introduction": "尽管引导中心近似非常强大，但它也有其局限性。本练习探讨了其中一个关键的限制：磁零点附近的区域，该区域磁场很弱且变化迅速，导致绝热不变量不再守恒。通过直接积分洛伦兹力并将其与理论预测进行比较，本练习为模型验证和理解我们物理近似的适用范围提供了重要的实践经验 。",
            "id": "4025404",
            "problem": "考虑一个电荷为 $q=-e$、质量为 $m=m_e$ 的非相对论性高能电子，在磁零点附近的静态、空间非均匀磁场中运动。使用具有一维零点的局域线性磁场模型：$\\mathbf{B}(\\mathbf{x})=b\\,x\\,\\hat{\\mathbf{z}}$，其中 $b$ 是单位为 $\\text{T}/\\text{m}$ 的恒定梯度，$x$ 是单位为米的笛卡尔坐标，$\\hat{\\mathbf{z}}$ 是沿 $z$ 轴的单位向量。不存在电场。电子的运动由洛伦兹力定律和运动学方程决定：$m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$，$d\\mathbf{x}/dt=\\mathbf{v}$。磁矩定义为 $\\mu = m v_{\\perp}^{2}/(2\\,|\\mathbf{B}|)$，其中 $v_{\\perp}$ 是垂直于局域磁场方向的速度分量。\n\n从基本原理出发，完成以下任务：\n\n1) 使用洛伦兹力定律、局域回旋半径的定义 $\\rho = m v_{\\perp}/(|q|\\,|\\mathbf{B}|)$ 以及标准场变化尺度 $L_{B} \\equiv |\\mathbf{B}|/|\\nabla \\mathbf{B}|$，推导给定线性零点场的无量纲绝热参数 $\\varepsilon \\equiv \\rho/L_{B}$，并用瞬时位置 $x$ 和速度分量 $v_{\\perp}$ 表示。然后，仅使用关于缓变系统的第一性原理进行推理，通过将每个回旋周期的磁矩分数变化 $\\Delta \\mu/\\mu$ 与 $\\varepsilon$ 相关联，论证在零点附近回旋平均失效的标度关系，并推导当初始位置为 $x(0)=r_{0}>0$ 时，$\\Delta \\mu/\\mu$ 随接近零点的距离 $r_{0}$ 变化的标度关系。你的推导必须从上述定义和牛顿第二定律开始，并且不得引入任何关于回旋平均的现成结论；结论必须源于你自己的推理链。\n\n2) 在指定场中，通过对完整洛伦兹动力学进行直接数值轨道积分，来估计回旋平均的失效情况。在 $t=0$ 时，将电子初始化于位置 $(x,y,z)=(r_{0},0,0)$ 和速度 $(v_{x},v_{y},v_{z})=(0,v_{0},0)$，其中 $r_{0}>0$ 且 $v_{0}>0$。对于下面测试组中的每个初始 $r_{0}$，计算在一个初始回旋周期 $T_{0}$ 内磁矩的分数变化。该周期对应于初始磁场 $|\\mathbf{B}(0)|=b\\,r_{0}$，即 $T_{0}=2\\pi/\\omega_{0}$，其中 $\\omega_{0}=|q|\\,b\\,r_{0}/m$。具体而言，定义\n$$D(r_{0})=\\left|\\frac{\\mu(T_{0})-\\mu(0)}{\\mu(0)}\\right|,$$\n其中 $\\mu(t)=m\\,v_{\\perp}^{2}(t)/(2\\,|\\mathbf{B}(t)|)$ 且 $v_{\\perp}^{2}(t)=v_{x}^{2}(t)+v_{y}^{2}(t)$，因为 $\\mathbf{B}$ 沿着 $\\hat{\\mathbf{z}}$ 方向。为避免在数值计算 $\\mu(t)$ 时因轨迹恰好接近零点而出现除零错误，通过使用一个小的下限值 $B_{\\text{floor}}$ 将磁场大小正则化，即用 $|\\mathbf{B}(t)|_{\\text{eff}}=\\max(|\\mathbf{B}(t)|,B_{\\text{floor}})$ 替换 $|\\mathbf{B}(t)|$。\n\n3) 使用四个初始接近距离的集合（测试组）\n- $r_{0,1}=1.0\\times 10^{-4}\\,\\text{m}$，\n- $r_{0,2}=5.0\\times 10^{-5}\\,\\text{m}$，\n- $r_{0,3}=2.5\\times 10^{-5}\\,\\text{m}$，\n- $r_{0,4}=1.25\\times 10^{-5}\\,\\text{m}$，\n\n以及固定参数\n- $b=50\\,\\text{T}/\\text{m}$，\n- $v_{0}=1.0\\times 10^{4}\\,\\text{m}/\\text{s}$，\n- $q=-1.602176634\\times 10^{-19}\\,\\text{C}$，\n- $m=9.1093837015\\times 10^{-31}\\,\\text{kg}$，\n- $B_{\\text{floor}}=1.0\\times 10^{-6}\\,\\text{T}$，\n\n计算 $i\\in\\{1,2,3,4\\}$ 的 $D(r_{0,i})$。然后，使用这四个数据点，通过对 $\\log D$ 与 $\\log r_{0}$ 进行最小二乘线性拟合，估计由 $D(r_{0})\\propto r_{0}^{-\\alpha}$ 定义的标度指数 $\\alpha$，并将 $\\alpha=-\\,d(\\log D)/d(\\log r_{0})$ 报告为单个浮点数。\n\n任何计算中的所有角度都必须以弧度为单位。输出 $D(r_{0,i})$ 和 $\\alpha$ 是无量纲的，必须报告为不带单位的浮点数。\n\n你的程序必须直接积分运动方程（在数值步骤中不使用导心近似），为所有四个 $r_{0}$ 值计算 $D(r_{0,i})$，根据这四个点估计 $\\alpha$，并生成单行输出，其中包含按以下顺序排列的五个结果，格式为逗号分隔的 Python 风格列表：\n$[D(r_{0,1}),D(r_{0,2}),D(r_{0,3}),D(r_{0,4}),\\alpha]$。",
            "solution": "该问题要求对电子在一维磁零点磁场中的运动进行两部分分析。首先，对绝热参数进行理论推导，并就磁矩守恒的破坏提出标度论证。其次，通过直接数值模拟计算磁矩的分数变化，并从数值数据中确定标度指数。\n\n### 第 1 部分：理论推导与标度论证\n\n电子的运动受洛伦兹力 $m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$ 控制，在磁场 $\\mathbf{B}(\\mathbf{x})=b\\,x\\,\\hat{\\mathbf{z}}$ 中运动。问题要求推导无量纲绝热参数 $\\varepsilon \\equiv \\rho/L_{B}$，并为磁矩 $\\mu$ 的不守恒性提供一个标度论证。\n\n**1.1. 绝热参数 $\\varepsilon$ 的推导**\n\n绝热参数 $\\varepsilon$ 是局域回旋半径 $\\rho$ 与磁场特征尺度长度 $L_{B}$ 的比值。我们针对给定场推导每一项。\n\n磁场为 $\\mathbf{B} = b\\,x\\,\\hat{\\mathbf{z}}$。其大小为 $|\\mathbf{B}| = |b\\,x|$。我们假设 $b > 0$ 且感兴趣的区域是 $x>0$，这与初始条件 $x(0) = r_0 > 0$ 一致。因此， $|\\mathbf{B}| = b\\,x$。\n\n磁场变化特征尺度长度定义为 $L_{B} \\equiv |\\mathbf{B}|/|\\nabla \\mathbf{B}|$。项 $|\\nabla \\mathbf{B}|$ 通常被解释为磁场强度梯度的模，即 $|\\nabla(|\\mathbf{B}|)|$。\n我们计算场强的梯度：\n$$\n\\nabla(|\\mathbf{B}|) = \\nabla(b\\,x) = b\\,\\nabla x = b\\,\\hat{\\mathbf{x}}\n$$\n该梯度的模为 $|\\nabla(|\\mathbf{B}|)| = |b\\,\\hat{\\mathbf{x}}| = b$。\n因此，特征尺度长度为：\n$$\nL_{B} = \\frac{|\\mathbf{B}|}{|\\nabla(|\\mathbf{B}|)|} = \\frac{b\\,x}{b} = x\n$$\n该结果表明，对于这种线性零点场，特征尺度长度就是到 $x=0$ 零点平面的距离。\n\n局域回旋半径定义为 $\\rho = m v_{\\perp}/(|q|\\,|\\mathbf{B}|)$，其中 $v_{\\perp}$ 是垂直于 $\\mathbf{B}$ 的速度分量。代入 $|\\mathbf{B}| = b\\,x$，我们得到：\n$$\n\\rho = \\frac{m v_{\\perp}}{|q|\\,b\\,x}\n$$\n现在，我们可以表示绝热参数 $\\varepsilon$：\n$$\n\\varepsilon \\equiv \\frac{\\rho}{L_{B}} = \\frac{m v_{\\perp}/(|q|\\,b\\,x)}{x} = \\frac{m v_{\\perp}}{|q|\\,b\\,x^2}\n$$\n这就是所求的用瞬时位置 $x$ 和垂直速度 $v_{\\perp}$ 表示的 $\\varepsilon$ 的表达式。\n\n**1.2. 磁矩不守恒的标度关系**\n\n磁矩 $\\mu = m v_{\\perp}^2 / (2|\\mathbf{B}|)$ 是一个绝热不变量，意味着当粒子经历的磁场在一个回旋周期内变化缓慢时，它近似守恒。“缓慢”的程度由 $\\varepsilon$ 量化。当 $\\varepsilon \\ll 1$ 时，系统是绝热的。当 $\\varepsilon \\gtrsim 1$ 时，绝热性被破坏，$\\mu$ 不再守恒。\n\n问题要求为每个回旋周期内 $\\mu$ 的分数变化 $\\Delta\\mu/\\mu$ 的标度关系提供一个第一性原理的论证。$\\mu$ 的守恒性依赖于回旋平均：在一个回旋轨道的一半中改变粒子能量或动量的效应，会被另一半中的相反效应所抵消。这种抵消仅在均匀磁场中是完美的。在非均匀场中，粒子在其轨道上会采样到变化的场强和方向。\n\n这种抵消作用的破坏是由于场在回旋半径 $\\rho$ 范围内的变化。粒子在其轨道上经历的磁场分数变化量级约为 $\\delta B / |\\mathbf{B}| \\approx (\\rho |\\nabla \\mathbf{B}|) / |\\mathbf{B}| = \\rho / (|\\mathbf{B}|/|\\nabla \\mathbf{B}|) = \\rho/L_B = \\varepsilon$。\n\n导致 $\\mu$ 在一个回旋周期内发生净变化的非绝热效应是这种场变化的直接后果。对于缓变系统 ($\\varepsilon \\ll 1$)，微扰理论的一个标准结果是，绝热不变量在快速运动的每个周期内的分数变化与表征缓慢变化的小参数成正比。在这种情况下，该参数是 $\\varepsilon$。因此，我们可以论证每个回旋周期内 $\\mu$ 的分数变化与 $\\varepsilon$ 线性相关：\n$$\n\\frac{\\Delta \\mu}{\\mu} \\propto \\varepsilon\n$$\n问题要求根据初始接近距离 $r_0$ 来评估此标度关系。我们在初始条件下评估 $\\varepsilon$：$x(0) = r_0$ 且由于 $\\mathbf{v}(0)=(0,v_0,0)$ 且 $\\mathbf{B}$ 沿 $\\hat{\\mathbf{z}}$ 方向，所以 $v_{\\perp}(0)=v_0$。\n$$\n\\varepsilon(t=0) = \\frac{m v_0}{|q|\\,b\\,r_0^2}\n$$\n基于在第一个回旋周期内 $\\mu$ 的分数变化 $D(r_0)$ 与绝热参数的初始值成正比的论点，我们推导出标度关系：\n$$\nD(r_0) \\propto \\varepsilon(t=0) \\propto \\frac{1}{r_0^2}\n$$\n这意味着一个标度定律 $D(r_0) \\propto r_0^{-\\alpha}$，其理论指数为 $\\alpha=2$。\n\n### 第 2 部分：数值解法设计\n\n问题要求通过对运动方程进行直接数值积分来计算 $D(r_0)=\\left|\\frac{\\mu(T_{0})-\\mu(0)}{\\mu(0)}\\right|$ 并估计标度指数 $\\alpha$。\n\n**2.1. 运动方程和运动常数**\n\n电子的状态由其位置 $\\mathbf{x}=(x,y,z)$ 和速度 $\\mathbf{v}=(v_x,v_y,v_z)$ 描述。洛伦兹力方程的分量形式为：\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{v}\n$$\n$$\nm \\frac{d\\mathbf{v}}{dt} = q\\,\\mathbf{v} \\times (b\\,x\\,\\hat{\\mathbf{z}}) = q\\,b\\,x\\,(v_y\\hat{\\mathbf{x}} - v_x\\hat{\\mathbf{y}})\n$$\n这产生了一个由六个一阶常微分方程（ODEs）组成的系统：\n1. $\\quad \\dot{x} = v_x$\n2. $\\quad \\dot{y} = v_y$\n3. $\\quad \\dot{z} = v_z$\n4. $\\quad \\dot{v}_x = (q/m)\\,b\\,x\\,v_y$\n5. $\\quad \\dot{v}_y = -(q/m)\\,b\\,x\\,v_x$\n6. $\\quad \\dot{v}_z = 0$\n\n从方程 6 和初始条件 $v_z(0)=0$，我们有对所有 $t$ 都有 $v_z(t)=0$。因此，$z(t)=0$。\n此外，考虑垂直动能 $K_{\\perp} = \\frac{1}{2}m v_{\\perp}^2 = \\frac{1}{2}m(v_x^2+v_y^2)$。其变化率为：\n$$\n\\frac{dK_{\\perp}}{dt} = m(v_x \\dot{v}_x + v_y \\dot{v}_y) = m\\left(v_x \\frac{qbxv_y}{m} + v_y \\frac{-qbxv_x}{m}\\right) = qbx(v_x v_y - v_y v_x) = 0\n$$\n因此，对于这个特定的磁场，$v_{\\perp}^2 = v_x^2+v_y^2$ 是一个精确的运动常数。给定初始条件，$v_{\\perp}^2(t) = v_x(0)^2+v_y(0)^2 = v_0^2$ 对所有 $t$ 成立。\n\n**2.2. $D(r_0)$ 的计算**\n\n磁矩为 $\\mu(t) = \\frac{m v_{\\perp}^2(t)}{2 |\\mathbf{B}(t)|_{\\text{eff}}}$。由于 $v_{\\perp}^2(t) = v_0^2$ 是常数，公式简化为 $\\mu(t) = \\frac{m v_0^2}{2 |\\mathbf{B}(t)|_{\\text{eff}}}$。那么量 $D(r_0)$ 为：\n$$\nD(r_0) = \\left|\\frac{\\mu(T_0) - \\mu(0)}{\\mu(0)}\\right| = \\left|\\frac{m v_0^2 / (2 |\\mathbf{B}(T_0)|_{\\text{eff}}) - m v_0^2 / (2 |\\mathbf{B}(0)|_{\\text{eff}})}{m v_0^2 / (2 |\\mathbf{B}(0)|_{\\text{eff}})}\\right| = \\left| \\frac{|\\mathbf{B}(0)|_{\\text{eff}}}{|\\mathbf{B}(T_0)|_{\\text{eff}}} - 1 \\right|\n$$\n其中 $|\\mathbf{B}(t)|_{\\text{eff}}=\\max(|\\mathbf{B}(t)|,B_{\\text{floor}})$。在 $t=0$ 时， $|\\mathbf{B}(0)| = |b\\,x(0)| = b\\,r_0$。在 $t=T_0$ 时， $|\\mathbf{B}(T_0)| = |b\\,x(T_0)|$。\n数值算法如下：\n1.  对于测试组中的每个初始距离 $r_{0,i}$：\n2.  定义初始状态向量 $S_0 = (x,y,z,v_x,v_y,v_z) = (r_{0,i}, 0, 0, 0, v_0, 0)$。\n3.  计算初始回旋周期 $T_{0,i} = 2\\pi m / (|q|\\,b\\,r_{0,i})$。\n4.  使用高精度数值求解器（例如，具有严格误差容差的 `scipy.integrate.solve_ivp`）将这 6 个 ODEs 系统从 $t=0$ 积分到 $t=T_{0,i}$。\n5.  从积分结果中提取最终位置 $x(T_{0,i})$。\n6.  计算有效磁场大小：$|\\mathbf{B}(0)|_{\\text{eff}} = \\max(b\\,r_{0,i}, B_{\\text{floor}})$ 和 $|\\mathbf{B}(T_0)|_{\\text{eff}} = \\max(|b\\,x(T_{0,i})|, B_{\\text{floor}})$。\n7.  使用上述简化公式计算 $D(r_{0,i})$。\n\n**2.3. 标度指数 $\\alpha$ 的估计**\n\n假设的标度定律是 $D(r_0) \\propto r_0^{-\\alpha}$。两边取自然对数得到一个线性关系：\n$$\n\\ln(D(r_0)) = C - \\alpha \\ln(r_0)\n$$\n其中 $C$ 是一个常数。这是一个直线方程 $y = mx+c$，其中 $y = \\ln(D)$，$x = \\ln(r_0)$，斜率 $m = -\\alpha$，截距 $c=C$。\n要从四个计算出的数据点 $(r_{0,i}, D(r_{0,i}))$ 估计 $\\alpha$：\n1.  将数据转换为对数尺度：$(\\ln(r_{0,i}), \\ln(D(r_{0,i})))$。\n2.  对这四个转换后的点进行线性最小二乘回归，以找到最佳拟合斜率。可以使用像 `numpy.polyfit` 这样的标准库函数。\n3.  标度指数是斜率的负值：$\\alpha = -\\text{slope}$。\n\n此数值过程将提供 $D(r_{0,i})$ 的四个值和估计的指数 $\\alpha$，从而满足问题的所有要求。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the problem of electron orbit integration near a magnetic null\n    to determine the breakdown of magnetic moment conservation.\n    \"\"\"\n    \n    # Given physical and simulation parameters\n    b = 50.0  # T/m\n    v0 = 1.0e4 # m/s\n    q = -1.602176634e-19  # C\n    m = 9.1093837015e-31  # kg\n    B_floor = 1.0e-6  # T\n    \n    # Test suite of initial distances to the null\n    r0_values = np.array([\n        1.0e-4,\n        5.0e-5,\n        2.5e-5,\n        1.25e-5,\n    ])\n\n    # Pre-calculate constant factor for ODEs\n    q_over_m = q / m\n    q_b_over_m = q_over_m * b\n\n    def lorentz_force_ode(t, state):\n        \"\"\"\n        Defines the system of ordinary differential equations for the Lorentz force.\n        The state vector is [x, y, z, vx, vy, vz].\n        \"\"\"\n        x, y, z, vx, vy, vz = state\n        \n        # d(state)/dt\n        dxdt = vx\n        dydt = vy\n        dzdt = vz\n        \n        # Lorentz force components\n        dvxdt = q_b_over_m * x * vy\n        dvydt = -q_b_over_m * x * vx\n        dvzdt = 0.0\n        \n        return [dxdt, dydt, dzdt, dvxdt, dvydt, dvzdt]\n\n    D_values = []\n    \n    for r0 in r0_values:\n        # 1. Set initial conditions\n        # state = [x, y, z, vx, vy, vz]\n        initial_state = [r0, 0.0, 0.0, 0.0, v0, 0.0]\n        \n        # 2. Calculate the initial gyroperiod\n        # B0 is guaranteed to be > B_floor for the given r0 values.\n        B0 = b * r0 \n        omega0 = abs(q) * B0 / m\n        T0 = 2.0 * np.pi / omega0\n        \n        # 3. Integrate the equations of motion over one initial gyroperiod\n        # Use a high-precision solver (RK45 is the default, which is fine)\n        # with stringent tolerances for accuracy.\n        sol = solve_ivp(\n            lorentz_force_ode,\n            t_span=[0, T0],\n            y0=initial_state,\n            t_eval=[T0],\n            rtol=1e-12,\n            atol=1e-12,\n        )\n        \n        final_state = sol.y[:, -1]\n        x_final = final_state[0]\n        \n        # 4. Calculate the fractional change in magnetic moment D(r0)\n        # As derived, v_perp is conserved, so the change in mu is due to B\n        # D(r0) = | mu(T0)/mu(0) - 1 | = | B(0)_eff / B(T0)_eff - 1|\n        B0_eff = max(B0, B_floor)\n        B_final = abs(b * x_final)\n        B_final_eff = max(B_final, B_floor)\n        \n        # Avoid division by zero if particle hits the null and B_final_eff is zero\n        if B_final_eff == 0:\n            # This case is unlikely with B_floor regularization but is a safe-guard.\n            # If the final field is zero, mu is infinite, and D is infinite.\n            D_r0 = np.inf\n        else:\n            D_r0 = abs(B0_eff / B_final_eff - 1.0)\n            \n        D_values.append(D_r0)\n\n    # 5. Estimate the scaling exponent alpha\n    # Model: D(r0) = C * r0^(-alpha) => log(D) = log(C) - alpha * log(r0)\n    # We fit a line to log(D) vs log(r0). The slope is -alpha.\n    log_r0 = np.log(r0_values)\n    log_D = np.log(D_values)\n    \n    # Perform linear least-squares fit (degree 1 polynomial)\n    slope, intercept = np.polyfit(log_r0, log_D, 1)\n    \n    alpha = -slope\n    \n    # 6. Format and print the final output\n    results = D_values + [alpha]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "我们将前面的概念与聚变装置中的一个关键性能指标——粒子约束——联系起来。本练习聚焦于恒星器，其复杂的三维磁场结构会产生能够捕获粒子的磁阱。通过分析沿磁力线的磁场，你将计算捕获-通行边界，这是决定一个粒子是被良好约束还是会迅速丢失的关键因素 。",
            "id": "4025421",
            "problem": "考虑一个在磁约束仿星器中运动的高能带电粒子。假设导心近似成立，且第一绝热不变量守恒。设沿单根磁力线的磁场强度在Boozer坐标系中局部地表示为两个主要螺旋傅里叶分量的叠加，磁力线剪切较弱，因此沿弧长$s$的磁场强度为\n$$\nB(s) \\;=\\; B_{0}\\,\\Big[\\,1 \\;+\\; b_{1}\\,\\cos\\big(\\Phi_{1}(s)\\big) \\;+\\; b_{2}\\,\\cos\\big(\\Phi_{2}(s) + \\delta\\big)\\,\\Big],\n$$\n其中$B_{0}$是参考磁场强度，$b_{1}$和$b_{2}$是小振幅参数，相位为\n$$\n\\Phi_{j}(s) \\;=\\; \\phi_{j0} \\;+\\; \\frac{m_{j}\\,\\iota(s) - n_{j}}{R_{0}}\\,s, \\qquad \\iota(s) \\;=\\; \\iota_{0} \\;+\\; \\sigma\\,s.\n$$\n这里，$R_{0}$是特征大半径，$\\iota(s)$是具有弱磁力线剪切$\\sigma$的旋转变换，$(m_{j},n_{j})$是螺旋谐波的角向和环向模数。参数$\\delta$通过第二谐波的相位偏移来编码三维磁阱结构。假设剪切和调制均较弱：$|b_{1}| \\ll 1$，$|b_{2}| \\ll 1$，以及$|\\sigma| R_{0} \\ll 1$，并且将注意力限制在近似有效的局部线段$s \\in [-L,\\,L]$上，其中$L = 0.2\\,\\mathrm{m}$。\n\n取以下物理上合理的数值（角度单位为弧度，长度单位为米，磁场单位为特斯拉）来定义特定的磁力线：\n- $B_{0} = 2.7$,\n- $R_{0} = 1.7$,\n- $\\iota_{0} = 0.42$,\n- $\\sigma = 0.08$,\n- $(m_{1},n_{1}) = (4,5)$, $(m_{2},n_{2}) = (5,7)$,\n- $b_{1} = 0.06$, $b_{2} = 0.04$,\n- $\\phi_{10} = 0$, $\\phi_{20} = 0$, 以及 $\\delta = 0.35$。\n\n对于一个质量为$m$、能量为$E$的高能粒子，假设总能量和第一绝热不变量（磁矩）守恒。设在$s=0$处的螺距角参数定义为\n$$\n\\lambda \\;\\equiv\\; \\frac{\\mu\\,B(0)}{E}.\n$$\n如果一个粒子的平行速度在磁力线上的某个反转点处变为零，则该粒子为捕获粒子，否则为通行粒子。捕获-通行边界出现在临界值$\\lambda_{c}$处，此时反转点与磁力线段上的最大磁场$B$重合。\n\n仅从能量和磁矩守恒以及给定的$B(s)$出发，推导捕获-通行边界，用$s=0$处的局部磁场与沿磁力线的最大磁场之比表示。然后，在所述小参数体系下，并保留$b_{1}$、$b_{2}$和$\\sigma$的领头非平凡阶，通过定位$B(s)$的驻点并进行一致展开来计算$B(s)$在$s \\in [-L,\\,L]$上的最大值。利用此结果，根据指定的参数，数值计算临界边界$\\lambda_{c}$。\n\n将$\\lambda_{c}$的最终答案表示为一个无量纲数，并四舍五入到四位有效数字。所有中间角度必须以弧度处理。",
            "solution": "该问题要求计算临界螺距角参数$\\lambda_c$，它定义了在给定仿星器磁场模型中高能粒子捕获与通行之间的边界。求解过程需要两个主要步骤：首先，从第一性原理推导$\\lambda_c$的表达式；其次，通过找到磁场强度$B(s)$在指定磁力线段上的最大值来计算其数值。\n\n### 第一部分：捕获-通行边界条件的推导\n\n我们从带电粒子在磁场中运动的总能量$E$和第一绝热不变量（磁矩）$\\mu$守恒原理开始。\n\n粒子的总能量是其平行动能和垂直动能之和：\n$$\nE = \\frac{1}{2}m v_{||}^2 + \\frac{1}{2}m v_{\\perp}^2\n$$\n其中$m$是粒子质量，$v_{||}$是平行于磁力线的速度分量，$v_{\\perp}$是垂直于磁力线的速度分量。\n\n磁矩$\\mu$定义为：\n$$\n\\mu = \\frac{\\frac{1}{2}m v_{\\perp}^2}{B(s)}\n$$\n其中$B(s)$是磁力线上位置$s$处的磁场强度。由于$\\mu$守恒，我们可以将垂直动能表示为$\\frac{1}{2}m v_{\\perp}^2 = \\mu B(s)$。\n\n将此代入能量守恒方程得到：\n$$\nE = \\frac{1}{2}m v_{||}^2 + \\mu B(s)\n$$\n我们可以解出平行速度的平方：\n$$\nv_{||}^2(s) = \\frac{2}{m} \\left(E - \\mu B(s)\\right)\n$$\n为了使粒子物理上存在，其速度必须是实数，所以$v_{||}^2 \\ge 0$。这意味着粒子的运动被限制在$E - \\mu B(s) \\ge 0$的区域内，或者等价地：\n$$\n\\frac{E}{\\mu} \\ge B(s)\n$$\n如果一个粒子的平行运动反向，则它被认为是“捕获”的。这发生在一个“反转点”$s_t$处，在该点$v_{||}(s_t) = 0$。在这样的点上，条件是：\n$$\nE - \\mu B(s_t) = 0 \\implies \\frac{E}{\\mu} = B(s_t)\n$$\n如果一个粒子从未达到反转点，即$E/ \\mu$大于其路径上遇到的任何$B(s)$值，则该粒子是通行的。因此，捕获粒子和通行粒子之间的边界对应于粒子刚好能越过最高磁场势垒的临界情况。这发生在所需能量与磁矩之比等于磁力线段上最大磁场强度$B_{max}$时：\n$$\n\\left(\\frac{E}{\\mu}\\right)_{critical} = B_{max} = \\max_{s \\in [-L, L]} B(s)\n$$\n问题将在$s=0$处的螺距角参数$\\lambda$定义为：\n$$\n\\lambda = \\frac{\\mu B(0)}{E}\n$$\n临界螺距角参数$\\lambda_c$对应于捕获-通行边界条件。将临界比值$(E/\\mu)_{critical} = B_{max}$代入$\\lambda$的定义，我们得到：\n$$\n\\lambda_c = \\frac{\\mu B(0)}{(E)_{critical}} = \\frac{B(0)}{ (E/\\mu)_{critical} } = \\frac{B(0)}{B_{max}}\n$$\n这完成了推导的第一部分。为了求出$\\lambda_c$，我们现在必须找到$B(0)$和$B_{max}$的值。\n\n### 第二部分：最大磁场强度的计算\n\n磁场由下式给出：\n$$\nB(s) = B_{0}\\,\\Big[\\,1 + b_{1}\\,\\cos\\big(\\Phi_{1}(s)\\big) + b_{2}\\,\\cos\\big(\\Phi_{2}(s) + \\delta\\big)\\,\\Big]\n$$\n其中相位为$\\Phi_{j}(s) = \\phi_{j0} + \\frac{m_{j}\\,\\iota(s) - n_{j}}{R_{0}}\\,s$，且$\\iota(s) = \\iota_{0} + \\sigma\\,s$。给定$\\phi_{10}=0$和$\\phi_{20}=0$，相位简化为$\\Phi_{j}(s) = \\frac{m_{j}(\\iota_{0} + \\sigma s) - n_{j}}{R_{0}}s$。我们可以将其写为$\\Phi_j(s) = k_j s + \\alpha_j s^2$，其中$k_j = \\frac{m_j \\iota_0 - n_j}{R_0}$且$\\alpha_j = \\frac{m_j \\sigma}{R_0}$。\n\n为了找到$B(s)$的最大值，我们通过求解$B'(s) = \\frac{dB}{ds} = 0$来定位其驻点。由于调制振幅$b_1, b_2$和剪切$\\sigma$很小，我们预计最大值位于一个小的$s$值处，我们将其表示为$s_{max}$。我们可以用$B(s)$在$s=0$附近的二阶泰勒展开来近似它：\n$$\nB(s) \\approx B(0) + s B'(0) + \\frac{s^2}{2} B''(0)\n$$\n这个二次函数的最大值出现在$s_{max} \\approx -B'(0)/B''(0)$处，前提是$B''(0)  0$。那么最大磁场的值为$B_{max} = B(s_{max}) \\approx B(0) + s_{max}B'(0) + \\frac{s_{max}^2}{2}B''(0)$。代入$s_{max}$的表达式：\n$$\nB_{max} \\approx B(0) - \\frac{B'(0)}{B''(0)}B'(0) + \\frac{1}{2}\\left(-\\frac{B'(0)}{B''(0)}\\right)^2 B''(0) = B(0) - \\frac{1}{2}\\frac{(B'(0))^2}{B''(0)}\n$$\n我们现在计算$B(s)$的必要导数，并在$s=0$处求值。\n相位及其在$s=0$处的导数为：\n$$\n\\Phi_j(0) = 0, \\quad \\Phi_j'(s) = k_j + 2\\alpha_j s \\implies \\Phi_j'(0) = k_j, \\quad \\Phi_j''(s) = 2\\alpha_j \\implies \\Phi_j''(0) = 2\\alpha_j\n$$\n磁场及其在$s=0$处的导数为：\n$$\nB(0) = B_0[1 + b_1\\cos(0) + b_2\\cos(\\delta)] = B_0[1 + b_1 + b_2\\cos(\\delta)]\n$$\n$$\nB'(s) = -B_0[b_1 \\sin(\\Phi_1(s))\\Phi_1'(s) + b_2 \\sin(\\Phi_2(s)+\\delta)\\Phi_2'(s)]\n$$\n$$\nB'(0) = -B_0[b_1 \\sin(0)k_1 + b_2 \\sin(\\delta) k_2] = -B_0 b_2 k_2 \\sin(\\delta)\n$$\n$$\nB''(s) = -B_0[b_1(\\cos(\\Phi_1)(\\Phi_1')^2 + \\sin(\\Phi_1)\\Phi_1'') + b_2(\\cos(\\Phi_2+\\delta)(\\Phi_2')^2 + \\sin(\\Phi_2+\\delta)\\Phi_2'')]\n$$\n$$\nB''(0) = -B_0[b_1(\\cos(0)k_1^2 + \\sin(0)(2\\alpha_1)) + b_2(\\cos(\\delta)k_2^2 + \\sin(\\delta)(2\\alpha_2))]\n$$\n$$\nB''(0) = -B_0[b_1 k_1^2 + b_2 k_2^2 \\cos(\\delta) + 2 b_2 \\alpha_2 \\sin(\\delta)]\n$$\n\n### 第三部分：数值计算\n\n我们代入给定的数值：\n$B_0 = 2.7$, $R_0 = 1.7$, $\\iota_0 = 0.42$, $\\sigma = 0.08$。\n$(m_1, n_1) = (4, 5)$, $(m_2, n_2) = (5, 7)$。\n$b_1 = 0.06$, $b_2 = 0.04$, $\\delta = 0.35$ rad。\n\n首先，我们计算系数$k_j$和$\\alpha_j$：\n$$\nk_1 = \\frac{4 \\times 0.42 - 5}{1.7} = \\frac{1.68 - 5}{1.7} = \\frac{-3.32}{1.7} \\approx -1.95294\n$$\n$$\nk_2 = \\frac{5 \\times 0.42 - 7}{1.7} = \\frac{2.1 - 7}{1.7} = \\frac{-4.9}{1.7} \\approx -2.88235\n$$\n$$\n\\alpha_2 = \\frac{m_2 \\sigma}{R_0} = \\frac{5 \\times 0.08}{1.7} = \\frac{0.4}{1.7} \\approx 0.23529\n$$\n我们还需要$\\sin(\\delta)$和$\\cos(\\delta)$：\n$$\n\\sin(0.35) \\approx 0.342898 \\quad \\text{和} \\quad \\cos(0.35) \\approx 0.939373\n$$\n现在，我们计算$B(0)$、$B'(0)$和$B''(0)$：\n$$\nB(0) = 2.7 \\times [1 + 0.06 + 0.04 \\times \\cos(0.35)] \\approx 2.7 \\times [1.06 + 0.04 \\times 0.939373] \\approx 2.963452\n$$\n$$\nB'(0) = -2.7 \\times 0.04 \\times (-2.88235) \\times \\sin(0.35) \\approx -0.108 \\times (-2.88235) \\times 0.342898 \\approx 0.106488\n$$\n对于二阶导数，我们有以下分量：\n$b_1 k_1^2 \\approx 0.06 \\times (-1.95294)^2 \\approx 0.228839$\n$b_2 k_2^2 \\cos(\\delta) \\approx 0.04 \\times (-2.88235)^2 \\times 0.939373 \\approx 0.312159$\n$2 b_2 \\alpha_2 \\sin(\\delta) \\approx 2 \\times 0.04 \\times 0.23529 \\times 0.342898 \\approx 0.006456$\n$$\nB''(0) \\approx -2.7 \\times [0.228839 + 0.312159 + 0.006456] = -2.7 \\times 0.547454 \\approx -1.478126\n$$\n由于$B''(0)  0$，我们关于在$s=0$附近存在局部最大值的假设是正确的。\n最大值的位置是$s_{max} \\approx -B'(0)/B''(0) \\approx -0.106488 / (-1.478126) \\approx 0.07204$ m，这在指定的区间$s \\in [-0.2, 0.2]$ m内。\n\n我们现在可以计算$B_{max}$：\n$$\nB_{max} \\approx B(0) - \\frac{1}{2}\\frac{(B'(0))^2}{B''(0)} \\approx 2.963452 - \\frac{1}{2} \\frac{(0.106488)^2}{-1.478126}\n$$\n$$\nB_{max} \\approx 2.963452 + \\frac{1}{2} \\frac{0.011340}{1.478126} \\approx 2.963452 + 0.003836 \\approx 2.967288\n$$\n最后，我们计算临界螺距角参数$\\lambda_c$：\n$$\n\\lambda_c = \\frac{B(0)}{B_{max}} \\approx \\frac{2.963452}{2.967288} \\approx 0.998707\n$$\n按要求四舍五入到四位有效数字，得到：\n$$\n\\lambda_c \\approx 0.9987\n$$",
            "answer": "$$\\boxed{0.9987}$$"
        }
    ]
}