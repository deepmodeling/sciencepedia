{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的湍流物理之前，我们必须首先确保我们的模拟在数值上是稳定和可靠的。回旋动理学模拟的核心是求解描述分布函数演化的方程，其中非线性 $E \\times B$ 平流项起着关键作用。这个练习  将指导你通过冯·诺依曼稳定性分析，来确定一个常用离散格式的稳定性条件，这是保证模拟结果物理意义的第一步。",
            "id": "4021454",
            "problem": "考虑均匀磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$ 中，描述涨落分布函数 $f(x,y,z,v_{\\parallel},\\mu,t)$ 的静电、无碰撞、局域平板模型下的回旋动理学 (GK) 方程。其中，非线性项源于 $\\mathbf{E} \\times \\mathbf{B}$ 漂移。GK 方程的非线性平流贡献可以以守恒形式写为泊松括号\n$$\n\\left\\{ \\langle \\phi \\rangle, f \\right\\} \\equiv \\frac{c}{B} \\left( \\hat{\\mathbf{z}} \\times \\nabla \\langle \\phi \\rangle \\right) \\cdot \\nabla f ,\n$$\n其中 $\\langle \\phi \\rangle(x,y,t)$ 是回旋平均静电势，$c$ 是光速。假设电势只有一个波数为 $k_{y}$ 的主导角向傅里叶分量，并在一个时间步长 $\\Delta t$ 内采用标准的系数冻结近似，从而使得更新过程中 $x$ 方向的 $\\mathbf{E} \\times \\mathbf{B}$ 速度在空间上是均匀且为正的，即 $U \\equiv -\\frac{c}{B} \\frac{\\partial \\langle \\phi \\rangle}{\\partial y} > 0$。在这些假设下，非线性项简化为一维平流，\n$$\n\\frac{\\partial f}{\\partial t} + U \\frac{\\partial f}{\\partial x} = 0 ,\n$$\n其定义在周期性区域 $x \\in [0,L_{x}]$ 上。\n\n用间距为 $\\Delta x$、指标为 $j = 0,1,\\dots,N-1$ 的均匀有限差分网格对 $x$ 进行离散化，并用步长 $t^{n} = n \\Delta t$ 对时间进行离散化。对时间采用前向欧拉格式，对 $x$ 采用适用于 $U > 0$ 的一阶迎风差分，则非线性平流通量的显式更新为\n$$\nf_{j}^{n+1} = f_{j}^{n} - C \\left( f_{j}^{n} - f_{j-1}^{n} \\right) ,\n$$\n其中 $C \\equiv \\frac{U \\Delta t}{\\Delta x}$ 是库朗数。\n\n通过代入实相位 $\\theta \\in [0,2\\pi)$ 的单个傅里叶模 $f_{j}^{n} = \\hat{f}^{n} \\exp\\!\\left( i j \\theta \\right)$，对该周期性边界条件下的离散格式进行 von Neumann 稳定性分析，并确定放大因子 $G(\\theta;C) \\equiv \\frac{\\hat{f}^{n+1}}{\\hat{f}^{n}}$（作为 $C$ 的函数）。利用对所有 $\\theta$ 都满足 $|G(\\theta;C)| \\leq 1$ 的稳定性要求，确定这个用于非线性 $\\mathbf{E} \\times \\mathbf{B}$ 平流项的显式迎风格式的最大稳定库朗数 $C_{\\text{max}}$。\n\n你的最终答案必须是 $C_{\\text{max}}$ 的无量纲值，以单个实数形式给出。无需四舍五入。",
            "solution": "该问题要求对一维平流方程的离散数值格式进行 von Neumann 稳定性分析，该方程在简化的回旋动理学背景下模拟了非线性 $\\mathbf{E} \\times \\mathbf{B}$ 平流项。\n\n控制偏微分方程如下所示：\n$$\n\\frac{\\partial f}{\\partial t} + U \\frac{\\partial f}{\\partial x} = 0\n$$\n其中 $U > 0$ 是一个恒定的平流速度。区域是周期性的。\n\n该方程在时间上使用前向欧拉格式，在空间上使用一阶迎风格式进行离散化。对于 $U > 0$，在网格点 $j$ 处 $\\frac{\\partial f}{\\partial x}$ 的迎风差分为 $\\frac{f_j - f_{j-1}}{\\Delta x}$。由此得到的显式有限差分方程为：\n$$\n\\frac{f_{j}^{n+1} - f_{j}^{n}}{\\Delta t} + U \\frac{f_{j}^{n} - f_{j-1}^{n}}{\\Delta x} = 0\n$$\n整理此方程以求解 $f_{j}^{n+1}$，得到问题陈述中给出的更新规则：\n$$\nf_{j}^{n+1} = f_{j}^{n} - \\frac{U \\Delta t}{\\Delta x} \\left( f_{j}^{n} - f_{j-1}^{n} \\right)\n$$\n引入库朗数 $C \\equiv \\frac{U \\Delta t}{\\Delta x}$，该格式可写为：\n$$\nf_{j}^{n+1} = f_{j}^{n} - C \\left( f_{j}^{n} - f_{j-1}^{n} \\right)\n$$\n为进行 von Neumann 稳定性分析，我们研究解中单个傅里叶模的放大情况。我们将试探解 $f_{j}^{n} = \\hat{f}^{n} \\exp(i j \\theta)$ 代入离散方程。这里，$\\hat{f}^{n}$ 是傅里叶模在时间步长 $n$ 处的复振幅，$j$ 是空间网格指标，$\\theta = k_x \\Delta x$ 是相邻网格点之间的无量纲相位差，其中 $k_x$ 是波数。\n\n对于离散方程中的每一项，代入后得到：\n\\begin{align*}\nf_{j}^{n+1} = \\hat{f}^{n+1} \\exp(i j \\theta) \\\\\nf_{j}^{n} = \\hat{f}^{n} \\exp(i j \\theta) \\\\\nf_{j-1}^{n} = \\hat{f}^{n} \\exp(i (j-1) \\theta) = \\hat{f}^{n} \\exp(i j \\theta) \\exp(-i \\theta)\n\\end{align*}\n将这些表达式代入有限差分格式，得到：\n$$\n\\hat{f}^{n+1} \\exp(i j \\theta) = \\hat{f}^{n} \\exp(i j \\theta) - C \\left( \\hat{f}^{n} \\exp(i j \\theta) - \\hat{f}^{n} \\exp(i j \\theta) \\exp(-i \\theta) \\right)\n$$\n我们可以将整个方程除以公因子 $\\hat{f}^{n} \\exp(i j \\theta)$，因为该因子不为零（否则该模是平凡的）。这样就得到了放大因子 $G(\\theta;C) \\equiv \\frac{\\hat{f}^{n+1}}{\\hat{f}^{n}}$ 的表达式：\n$$\nG(\\theta;C) = 1 - C \\left( 1 - \\exp(-i \\theta) \\right)\n$$\n为使数值格式稳定，对于相位 $\\theta \\in [0, 2\\pi)$ 的任何可能值，放大因子的模都不能超过1。这个稳定性条件表示为：\n$$\n|G(\\theta;C)| \\leq 1 \\quad \\forall \\theta\n$$\n这等价于条件 $|G(\\theta;C)|^2 \\leq 1$。让我们计算 $G$ 的模的平方。首先，使用欧拉公式 $\\exp(-i\\theta) = \\cos(\\theta) - i\\sin(\\theta)$，我们可以将 $G$ 写成其实部和虚部的形式：\n$$\nG(\\theta;C) = 1 - C \\left( 1 - (\\cos(\\theta) - i\\sin(\\theta)) \\right) = (1 - C + C\\cos(\\theta)) + i(C\\sin(\\theta))\n$$\n模的平方是实部和虚部的平方和：\n\\begin{align*}\n|G(\\theta;C)|^2 = \\left( 1 - C + C\\cos(\\theta) \\right)^2 + \\left( C\\sin(\\theta) \\right)^2 \\\\\n= (1 - C)^2 + 2(1 - C)C\\cos(\\theta) + C^2\\cos^2(\\theta) + C^2\\sin^2(\\theta) \\\\\n= (1 - C)^2 + 2C(1 - C)\\cos(\\theta) + C^2(\\cos^2(\\theta) + \\sin^2(\\theta)) \\\\\n= 1 - 2C + C^2 + 2C\\cos(\\theta) - 2C^2\\cos(\\theta) + C^2 \\\\\n= 1 - 2C + 2C^2 + (2C - 2C^2)\\cos(\\theta) \\\\\n= 1 - 2C(1 - C) + 2C(1 - C)\\cos(\\theta) \\\\\n= 1 - 2C(1 - C)(1 - \\cos(\\theta))\n\\end{align*}\n现在，我们应用稳定性条件 $|G(\\theta;C)|^2 \\leq 1$：\n$$\n1 - 2C(1 - C)(1 - \\cos(\\theta)) \\leq 1\n$$\n两边同时减去 $1$ 得到：\n$$\n-2C(1 - C)(1 - \\cos(\\theta)) \\leq 0\n$$\n两边同时除以 $-2$ 会使不等号反向：\n$$\nC(1 - C)(1 - \\cos(\\theta)) \\geq 0\n$$\n为了确定对 $C$ 的约束，我们分析这个不等式中的每个因子。\n\\begin{enumerate}\n    \\item 库朗数 $C = \\frac{U \\Delta t}{\\Delta x}$ 的定义中，$U > 0$、$\\Delta t > 0$ 且 $\\Delta x > 0$。因此，我们必须有 $C \\geq 0$。如果 $C=0$，不等式自然成立。\n    \\item 对于任何实数 $\\theta$，由于 $\\cos(\\theta)$ 的范围是 $[-1, 1]$，因此项 $(1 - \\cos(\\theta))$ 总是非负的。具体来说，$0 \\leq 1 - \\cos(\\theta) \\leq 2$。\n\\end{enumerate}\n鉴于 $C \\geq 0$ 和 $(1 - \\cos(\\theta)) \\geq 0$，不等式 $C(1 - C)(1 - \\cos(\\theta)) \\geq 0$ 对所有 $\\theta$ 都成立的充要条件是剩下的因子 $(1 - C)$ 也为非负。\n$$\n1 - C \\geq 0 \\implies C \\leq 1\n$$\n结合这些条件，该格式稳定的充要条件是 $0 \\leq C \\leq 1$。因此，保证稳定性的库朗数的最大值为 $1$。\n\n因此，该显式迎风格式的最大稳定库朗数为 $C_{\\text{max}} = 1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "一个数值稳定的模拟能够让我们探索湍流输运背后的核心物理机制。湍流引起的粒子和热量输运并非随机过程，而是源于等离子体中各种波动量之间的精确关联。通过这个练习 ，你将推导粒子通量与密度和电势波动的交叉相位之间的直接关系，从而揭示湍流输运产生的根本原因。",
            "id": "4021471",
            "problem": "考虑一个在均匀磁场中的离子的静电、均匀平板非线性回旋动理学（GK）湍流模拟。磁场为 $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$，其大小 $B$ 为常数。电场为 $\\mathbf{E} = -\\nabla \\phi$，其中 $\\phi(x,y,t)$ 是静电势涨落。$E\\times B$ 漂移速度由 $\\mathbf{v}_{E} = \\mathbf{E}\\times \\mathbf{B} / B^{2}$ 给出，因此在平板中的径向分量为 $v_{E,x} = E_{y}/B = -(1/B)\\,\\partial_{y}\\phi$。设离子密度涨落为 $\\tilde{n}_{i}(x,y,t)$，它是绝热和非绝热回旋中心贡献的总和，但您应将 $\\tilde{n}_{i}$ 视为一个通过湍流动力学与 $\\phi$ 相关的实标量场。\n\n从这些基本定义出发，并且不假设任何特定的模型闭合，推导离子密度和电势涨落之间交叉相位的谱表达式，并说明该交叉相位如何决定离子粒子通量的符号。使用以下操作性定义：\n- 离子粒子通量为 $\\Gamma_{i}(x,t) = \\langle \\tilde{n}_{i}(x,y,t)\\, v_{E,x}(x,y,t)\\rangle_{y,t}$，其中 $\\langle \\cdot \\rangle_{y,t}$ 表示对副法向坐标 $y$ 和远长于涨落周期的时间进行平均。\n- 对于副法向波数为 $k_{y}$ 的单个主导副法向模式，将在固定 $(x,t)$ 处的涨落表示为 $\\tilde{n}_{i}(y) = A_{n}\\cos(k_{y} y + \\alpha_{n})$ 和 $\\phi(y) = A_{\\phi}\\cos(k_{y} y + \\alpha_{\\phi})$，其中 $A_{n}$ 和 $A_{\\phi}$ 是实振幅，$\\alpha_{n}$、$\\alpha_{\\phi}$ 是相位。定义交叉相位角 $\\theta_{n\\phi} = \\alpha_{\\phi} - \\alpha_{n}$。\n\n从第一性原理（上述定义和标准傅里叶恒等式）出发，推导以 $A_{n}$、$A_{\\phi}$、$k_{y}$、$B$ 和 $\\theta_{n\\phi}$ 表示的 $\\Gamma_{i}$ 的解析表达式，并解释 $\\Gamma_{i}$ 的符号是如何由交叉相位决定的。然后，使用在模拟中给定半径处通过综合诊断获得的以下物理上合理的参数：\n- $B = 2.7\\,\\text{T}$,\n- $k_{y} = 150\\,\\text{m}^{-1}$,\n- $A_{n} = 8.0\\times 10^{16}\\,\\text{m}^{-3}$,\n- $A_{\\phi} = 12.0\\,\\text{V}$,\n- $\\theta_{n\\phi} = -0.50\\,\\text{radians}$,\n\n计算该位置处离子粒子通量 $\\Gamma_{i}$ 的数值。用单位 $\\text{m}^{-2}\\,\\text{s}^{-1}$ 表示您的最终答案，并将答案四舍五入到四位有效数字。请明确说明您使用的角度单位；此处提供的角度以弧度为单位。",
            "solution": "这个问题陈述清晰，有科学依据，并为完整解答提供了所有必要信息。这是等离子体湍流理论中的一个标准练习。我将开始推导和计算。\n\n目标是推导离子粒子通量 $\\Gamma_i$ 的表达式，然后计算其数值。\n\n离子粒子通量定义为离子密度涨落 $\\tilde{n}_{i}$ 与 $E\\times B$ 漂移速度的径向分量 $v_{E,x}$ 之间的相关性，并在副法向坐标 $y$ 和时间 $t$ 上进行平均。\n$$\n\\Gamma_{i}(x) = \\langle \\tilde{n}_{i}(x,y,t) \\, v_{E,x}(x,y,t) \\rangle_{y,t}\n$$\n问题考虑的是一个时间快照和一个固定的径向位置 $x$，因此平均实际上是对 $y$ 坐标进行的。$E\\times B$ 漂移速度的径向分量由 $v_{E,x} = E_y/B$ 给出。将电场表示为静电势的梯度 $\\mathbf{E} = -\\nabla\\phi$，我们得到 $E_y = -\\partial_y \\phi$。因此，速度为：\n$$\nv_{E,x} = -\\frac{1}{B} \\frac{\\partial \\phi}{\\partial y}\n$$\n问题为波数为 $k_y$ 的单个主导副法向模式指定了密度和电势涨落的函数形式：\n$$\n\\tilde{n}_{i}(y) = A_{n}\\cos(k_{y} y + \\alpha_{n})\n$$\n$$\n\\phi(y) = A_{\\phi}\\cos(k_{y} y + \\alpha_{\\phi})\n$$\n其中 $A_n$ 和 $A_\\phi$ 是实振幅，$\\alpha_n$ 和 $\\alpha_\\phi$ 分别是它们的相位。\n\n首先，我们通过对 $\\phi(y)$ 的表达式求导来推导 $v_{E,x}(y)$ 的表达式：\n$$\nv_{E,x}(y) = -\\frac{1}{B} \\frac{\\partial}{\\partial y} \\left( A_{\\phi}\\cos(k_{y} y + \\alpha_{\\phi}) \\right)\n$$\n$$\nv_{E,x}(y) = -\\frac{A_{\\phi}}{B} \\left( -k_y \\sin(k_{y} y + \\alpha_{\\phi}) \\right) = \\frac{A_{\\phi} k_y}{B} \\sin(k_{y} y + \\alpha_{\\phi})\n$$\n现在，我们可以写出局部的、未平均的通量，即 $\\tilde{n}_{i}(y)$ 和 $v_{E,x}(y)$ 的乘积：\n$$\n\\tilde{n}_{i}(y) v_{E,x}(y) = \\left( A_{n}\\cos(k_{y} y + \\alpha_{n}) \\right) \\left( \\frac{A_{\\phi} k_y}{B} \\sin(k_{y} y + \\alpha_{\\phi}) \\right)\n$$\n$$\n\\tilde{n}_{i}(y) v_{E,x}(y) = \\frac{A_{n} A_{\\phi} k_y}{B} \\cos(k_{y} y + \\alpha_{n}) \\sin(k_{y} y + \\alpha_{\\phi})\n$$\n为了求得净通量 $\\Gamma_i$，我们将此乘积在一个空间周期 $y$（即 $L = 2\\pi/k_y$）上进行平均。\n$$\n\\Gamma_i = \\langle \\tilde{n}_{i}(y) v_{E,x}(y) \\rangle_y = \\frac{A_{n} A_{\\phi} k_y}{B} \\langle \\cos(k_{y} y + \\alpha_{n}) \\sin(k_{y} y + \\alpha_{\\phi}) \\rangle_y\n$$\n我们使用三角函数的积化和差恒等式 $\\sin(U)\\cos(V) = \\frac{1}{2}(\\sin(U+V) + \\sin(U-V))$。令 $U = k_y y + \\alpha_{\\phi}$ 和 $V = k_y y + \\alpha_{n}$。\n$$\n\\cos(k_{y} y + \\alpha_{n}) \\sin(k_{y} y + \\alpha_{\\phi}) = \\frac{1}{2} \\left[ \\sin((k_y y + \\alpha_{\\phi}) + (k_y y + \\alpha_{n})) + \\sin((k_y y + \\alpha_{\\phi}) - (k_y y + \\alpha_{n})) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ \\sin(2k_y y + \\alpha_{\\phi} + \\alpha_{n}) + \\sin(\\alpha_{\\phi} - \\alpha_{n}) \\right]\n$$\n波数不为零的正弦函数在一个完整周期上的空间平均值为零。因此，$\\langle \\sin(2k_y y + \\alpha_{\\phi} + \\alpha_{n}) \\rangle_y = 0$。第二项 $\\sin(\\alpha_{\\phi} - \\alpha_{n})$ 是一个关于 $y$ 的常数，所以它的平均值就是它本身。\n$$\n\\langle \\cos(k_{y} y + \\alpha_{n}) \\sin(k_{y} y + \\alpha_{\\phi}) \\rangle_y = \\frac{1}{2} \\sin(\\alpha_{\\phi} - \\alpha_{n})\n$$\n交叉相位角定义为 $\\theta_{n\\phi} = \\alpha_{\\phi} - \\alpha_{n}$。将其代入 $\\Gamma_i$ 的表达式，我们得到离子粒子通量的最终解析表达式：\n$$\n\\Gamma_i = \\frac{A_{n} A_{\\phi} k_y}{2B} \\sin(\\theta_{n\\phi})\n$$\n这个表达式说明了粒子通量是如何从涨落之间的相关性中产生的。通量与密度和电势涨落的振幅（$A_n, A_\\phi$）、副法向波数（$k_y$）以及交叉相位角（$\\theta_{n\\phi}$）的正弦值成正比。\n\n粒子通量 $\\Gamma_i$ 的符号由 $\\sin(\\theta_{n\\phi})$ 的符号决定，因为振幅 $A_n$、$A_\\phi$、波数 $k_y$（按惯例取正值）和磁场强度 $B$ 都是正值。\n- 如果 $0 < \\theta_{n\\phi} < \\pi$，则 $\\sin(\\theta_{n\\phi}) > 0$ 且 $\\Gamma_i > 0$，对应于向外的通量（从等离子体核心到边缘）。\n- 如果 $-\\pi < \\theta_{n\\phi} < 0$，则 $\\sin(\\theta_{n\\phi}) < 0$ 且 $\\Gamma_i < 0$，对应于向内的通量或“粒子箍缩”。\n- 如果 $\\theta_{n\\phi} = 0$ 或 $\\theta_{n\\phi} = \\pm\\pi$，则 $\\sin(\\theta_{n\\phi}) = 0$ 且 $\\Gamma_i = 0$。这表示密度和电势涨落完全同相或反相，导致没有净粒子输运。\n\n接下来，我们使用给定的参数计算 $\\Gamma_i$ 的数值：\n- $B = 2.7\\,\\text{T}$\n- $k_{y} = 150\\,\\text{m}^{-1}$\n- $A_{n} = 8.0 \\times 10^{16}\\,\\text{m}^{-3}$\n- $A_{\\phi} = 12.0\\,\\text{V}$\n- $\\theta_{n\\phi} = -0.50\\,\\text{radians}$\n\n将这些值代入推导出的 $\\Gamma_i$ 公式中：\n$$\n\\Gamma_i = \\frac{(8.0 \\times 10^{16}\\,\\text{m}^{-3}) \\times (12.0\\,\\text{V}) \\times (150\\,\\text{m}^{-1})}{2 \\times (2.7\\,\\text{T})} \\sin(-0.50)\n$$\n首先，我们计算预因子：\n$$\n\\frac{(8.0 \\times 10^{16}) \\times 12.0 \\times 150}{2 \\times 2.7} = \\frac{1.44 \\times 10^{20}}{5.4} \\approx 2.666... \\times 10^{19}\n$$\n单位为 $\\frac{\\text{m}^{-3} \\cdot \\text{V} \\cdot \\text{m}^{-1}}{\\text{T}} = \\frac{\\text{V}}{\\text{T} \\cdot \\text{m}^4}$。使用关系式 $1\\,\\text{T} = 1\\,\\frac{\\text{V} \\cdot \\text{s}}{\\text{m}^2}$，单位变为 $\\frac{\\text{V}}{(\\text{V} \\cdot \\text{s} / \\text{m}^2) \\cdot \\text{m}^4} = \\frac{1}{\\text{s} \\cdot \\text{m}^2}$，这对于单位面积的通量密度是正确的。\n\n现在，我们计算完整的表达式。角度以弧度给出。\n$$\n\\sin(-0.50) = -\\sin(0.50) \\approx -0.4794255\n$$\n$$\n\\Gamma_i \\approx (2.666... \\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1}) \\times (-0.4794255)\n$$\n$$\n\\Gamma_i \\approx -1.278468 \\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Gamma_i \\approx -1.278 \\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n负号表示向内的粒子通量，这与交叉相位角 $\\theta_{n\\phi}$ 位于区间 $(-\\pi, 0)$ 内的事实相符。",
            "answer": "$$\\boxed{-1.278 \\times 10^{19}}$$"
        },
        {
            "introduction": "理解了输运的起源后，下一步是研究如何调控它，并将复杂模拟的结果与简洁的物理模型联系起来。这项实践  模拟了计算科学家的一个典型工作流程：你将首先从物理原理出发，推导出一个描述流动剪切抑制湍流输运的简化模型，然后利用非线性最小二乘法将该模型与模拟数据进行拟合。这个练习旨在让你掌握从复杂模拟数据中提取关键物理规律和建立简化模型的实用技能。",
            "id": "4021440",
            "problem": "您将执行一项计算任务，该任务源于与磁约束聚变装置相关的非线性回旋动理学湍流模拟。在此类系统中，跨场热输运由漂移波湍流介导，该湍流被电场叉乘磁场（E×B）流非线性地平流。施加背景 E×B 剪切会引入一个剪切率，该剪切率倾向于使湍流涡退相关并减少输运。您的目标是基于第一性原理推导，构建一个用于描述流剪切导致的输运减少的参数化、无量纲模型，然后用它来量化一组数据集中的热通量减少情况。\n\n推导的基本依据：\n- 漂移波湍流的回旋动理学描述支持这样一幅物理图像：湍流跨场热通量是由温度涨落的 E×B 平流驱动的，其特征退相关时间由非线性相互作用和施加的 E×B 剪切之间的竞争决定。\n- E×B 剪切率作为一种针对湍流涡的退相关机制；增加剪切率会减少有效相关时间，从而减少湍流热通量。\n- 一个物理上可接受的输运减少函数必须是无量纲的，必须满足 $S(0) = 1$（在零剪切下没有减少），必须在施加的剪切率上单调递减，并且必须满足 $\\lim_{\\gamma_{E} \\to \\infty} S(\\gamma_{E}) = 0$。\n\n任务：\n- 根据上述物理原理，推导一个双参数、无量纲的抑制模型 $S(\\gamma_{E}; \\theta)$，其中 $\\theta$ 是待通过拟合确定的未知正参数集。该模型应反映随着施加的剪切率 $\\gamma_{E}$ 的增加，湍流输运的单调抑制，并遵循上述极限行为。推导必须从 E×B 剪切导致涡流退相关的物理图像出发，并得出一个闭合形式的 $S(\\gamma_{E}; \\theta)$。\n- 使用推导出的抑制模型，定义归一化热通量比 $R_{Q}(\\gamma_{E}) = Q(\\gamma_{E}) / Q(0)$，并对下面提供的每个数据集，通过最小二乘法将模型参数 $\\theta$ 拟合到此比率。假设所有量都是无量纲的，并已归一化到一个合适的回旋-玻姆类（gyro-Bohm-like）体系，因此最终的数值中不出现物理单位。\n- 使用拟合的抑制模型，计算在评估剪切率 $\\gamma_{E}^{*} = 1.0$ 时的预测分数减少量，定义为 $\\Delta(\\gamma_{E}^{*}) = 1 - R_{Q}(\\gamma_{E}^{*})$。\n\n测试套件数据集（每个数据集都是一对施加的剪切率和来自非线性模拟的相应测量的归一化热通量值）：\n- 数据集 A：\n  - 剪切率 $\\gamma_{E}$: $[0.0, 0.2, 0.5, 1.0, 2.0, 5.0]$\n  - 测量的热通量 $Q$: $[1.0, 0.8, 0.6153846154, 0.4444444444, 0.2857142857, 0.1379310345]$\n- 数据集 B：\n  - 剪切率 $\\gamma_{E}$: $[0.0, 0.3, 0.6, 0.9, 1.5, 3.0]$\n  - 测量的热通量 $Q$: $[1.2, 0.96, 0.6, 0.3692307692, 0.1655172414, 0.0461538462]$\n- 数据集 C：\n  - 剪切率 $\\gamma_{E}$: $[0.0, 0.05, 0.1, 0.2, 0.4]$\n  - 测量的热通量 $Q$: $[0.8, 0.7111111111, 0.64, 0.5333333333, 0.4]$\n\n您的程序必须：\n- 对每个数据集，计算 $R_{Q}(\\gamma_{E}) = Q(\\gamma_{E})/Q(0)$，通过非线性最小二乘法将推导的抑制模型拟合到 $R_{Q}(\\gamma_{E})$，并在 $\\gamma_{E}^{*} = 1.0$ 处评估 $\\Delta(\\gamma_{E}^{*})$。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。每个数据集的输出必须按顺序包含三个浮点数 $[\\hat{\\gamma}_{c}, \\hat{p}, \\Delta(1.0)]$，其中 $\\hat{\\gamma}_{c}$ 和 $\\hat{p}$ 是拟合参数，并在不同数据集间连接。因此，您的程序应按数据集 A, B, C 的顺序打印一个包含九个浮点数的列表。\n\n所有量都应被视为无量纲的归一化值；不需要物理单位。不涉及角度；不要使用度或弧度。不得使用百分比；减少量必须以小数分数报告。最终输出格式必须是严格包含如上所述的单个列表的一行。",
            "solution": "所提出的问题是，推导一个物理上合理的、无量纲的模型，用于描述由施加的平均速度剪切引起的湍流热通量抑制，并随后应用此模型分析来自非线性回旋动理学模拟的给定数据集。分析过程涉及拟合模型参数并计算在特定剪切率下的输运减少量。\n\n### 步骤 1：抑制模型的推导\n\n推导过程源于漂移波湍流在剪切流中的基本物理图像。\n\n1.  湍流热通量，记为 $Q$，源于等离子体温度和 E×B 速度的关联涨落。在准线性框架下，通量的大小与负责输运的湍流涡的相关时间 $\\tau_{corr}$ 成正比。\n    $$\n    Q \\propto \\tau_{corr}\n    $$\n2.  相关时间是总退相关率 $\\omega_{total}$ 的倒数。该率量化了湍流涡失去其空间相干性的速度。\n    $$\n    \\tau_{corr} = \\frac{1}{\\omega_{total}}\n    $$\n3.  总退相关率 $\\omega_{total}$ 由两种主要机制之间的竞争决定：湍流的内禀非线性自退相关和由外部 E×B 剪切施加的退相关。一个标准的启发式模型将这些速率结合起来。反映两种贡献过程的最简单模型是内禀非线性率 $\\omega_{nl}$ 和有效剪切率 $\\omega_{s,eff}$ 的线性求和。\n    $$\n    \\omega_{total}(\\gamma_E) = \\omega_{nl} + \\omega_{s,eff}(\\gamma_E)\n    $$\n    这里，$\\gamma_E$ 是施加的 E×B 剪切率。在零剪切（$\\gamma_E = 0$）时，有效剪切率为零，$\\omega_{s,eff}(0) = 0$，总速率简化为内禀非线性率，$\\omega_{total}(0) = \\omega_{nl}$。\n\n4.  有效剪切率 $\\omega_{s,eff}$ 表示平均流剪切撕裂湍流涡的速率。这不一定等于 $\\gamma_E$ 本身，因为湍流的响应可能更复杂。我们采用幂律依赖关系来模拟这种响应，这是开发简化模型的一种常用方法。\n    $$\n    \\omega_{s,eff}(\\gamma_E) = \\alpha \\gamma_E^p\n    $$\n    其中 $\\alpha$ 是比例常数， $p$ 是一个正指数。这两个常数捕捉了剪切-湍流相互作用的物理。例如，$p=2$ 的值可以由波数空间中类似随机游走的剪切过程来论证。\n\n5.  归一化抑制函数 $S(\\gamma_E)$ 定义为在给定剪切率 $\\gamma_E$ 下的热通量与零剪切下热通量 $Q(0)$ 的比值。\n    $$\n    S(\\gamma_E) = \\frac{Q(\\gamma_E)}{Q(0)} = \\frac{\\tau_{corr}(\\gamma_E)}{\\tau_{corr}(0)} = \\frac{\\omega_{total}(0)}{\\omega_{total}(\\gamma_E)}\n    $$\n    代入退相关率的表达式：\n    $$\n    S(\\gamma_E) = \\frac{\\omega_{nl}}{\\omega_{nl} + \\alpha \\gamma_E^p} = \\frac{1}{1 + \\left(\\frac{\\alpha}{\\omega_{nl}}\\right) \\gamma_E^p}\n    $$\n6.  该表达式构成一个双参数模型。为了便于物理诠释并减少拟合过程中的参数相关性，通常会对其进行重新参数化。我们引入一个临界剪切率 $\\gamma_c$，定义为有效剪切项等于内禀非线性项时的剪切率：$\\omega_{s,eff}(\\gamma_c) = \\omega_{nl}$。\n    $$\n    \\alpha \\gamma_c^p = \\omega_{nl} \\implies \\frac{\\alpha}{\\omega_{nl}} = \\frac{1}{\\gamma_c^p}\n    $$\n7.  将此代回抑制模型，得到最终形式：\n    $$\n    S(\\gamma_E; \\gamma_c, p) = \\frac{1}{1 + \\left(\\frac{\\gamma_E}{\\gamma_c}\\right)^p}\n    $$\n    两个正的拟合参数是 $\\theta = \\{\\gamma_c, p\\}$。此模型通常被称为 Waltz-Hassam-Diamond 规则形式。\n\n8.  这个推导出的模型满足所有必需的物理约束：\n    -   它是无量纲的，因为幂律的参数是比值 $\\gamma_E / \\gamma_c$。\n    -   在零剪切时：$S(0; \\gamma_c, p) = 1 / (1 + 0) = 1$。\n    -   对于 $\\gamma_E > 0$, $\\gamma_c > 0$, 和 $p > 0$，分母大于 $1$ 且随 $\\gamma_E$ 增加而增加，因此函数是单调递减的。\n    -   在大剪切极限下：$\\lim_{\\gamma_E \\to \\infty} S(\\gamma_E; \\gamma_c, p) = 0$。\n\n### 步骤 2：数据分析方法\n\n将推导出的模型 $S(\\gamma_E; \\gamma_c, p)$ 拟合到每个给定数据集的实验数据。\n\n1.  **归一化**：原始热通量数据 $Q(\\gamma_E)$ 必须首先通过零剪切值 $Q(0)$ 进行归一化，以获得经验抑制因子，我们将其表示为 $R_Q(\\gamma_E)$。\n    $$\n    R_Q(\\gamma_E) = \\frac{Q(\\gamma_E)}{Q(0)}\n    $$\n    对于每个数据集，$Q(0)$ 是热通量数组中的第一个值，对应于 $\\gamma_E = 0$。\n\n2.  **参数拟合**：模型参数 $\\hat{\\gamma}_c$ 和 $\\hat{p}$（其中帽子符号表示拟合估计值）通过最小化模型预测 $S(\\gamma_E)$ 与归一化数据 $R_Q(\\gamma_E)$ 之间的残差平方和来确定。这是一个非线性最小二乘回归问题。要最小化的目标函数是：\n    $$\n    \\chi^2(\\gamma_c, p) = \\sum_{i} \\left[ R_Q(\\gamma_{E,i}) - S(\\gamma_{E,i}; \\gamma_c, p) \\right]^2\n    $$\n    这对每个数据集进行数值求解，并受限于约束条件 $\\gamma_c > 0$ 和 $p > 0$。\n\n3.  **分数减少量的评估**：一旦找到最优参数 $(\\hat{\\gamma}_c, \\hat{p})$，就使用该模型来预测在特定评估剪切率 $\\gamma_E^* = 1.0$ 下的抑制效果。然后，热通量的分数减少量 $\\Delta(\\gamma_E^*)$ 计算如下：\n    $$\n    \\Delta(\\gamma_E^*) = 1 - S(\\gamma_E^*; \\hat{\\gamma}_c, \\hat{p}) = 1 - \\frac{1}{1 + \\left(\\frac{\\gamma_E^*}{\\hat{\\gamma}_c}\\right)^{\\hat{p}}}\n    $$\n    当 $\\gamma_E^* = 1.0$ 时，这简化为：\n    $$\n    \\Delta(1.0) = 1 - \\frac{1}{1 + \\left(\\frac{1.0}{\\hat{\\gamma}_c}\\right)^{\\hat{p}}}\n    $$\n计算过程包括将这些步骤应用于所提供的三个数据集中的每一个。最终结果是数据集 A、B 和 C 的三元组 $[\\hat{\\gamma}_c, \\hat{p}, \\Delta(1.0)]$ 的串联。",
            "answer": "[0.8, 1.0, 0.55555556, 0.6, 2.0, 0.73529412, 0.4, 1.0, 0.71428571]"
        }
    ]
}