{
    "hands_on_practices": [
        {
            "introduction": "湍流输运并非源于随机噪声，而是产生于波动的物理量之间特定的关联。这个练习将通过第一性原理推导，揭示密度涨落和静电势涨落之间的相位关系是如何直接决定净粒子通量的 。掌握这一基本联系，对于解读和诊断回旋动理学模拟中的输运现象至关重要。",
            "id": "4021471",
            "problem": "考虑在均匀磁场中离子的静电、均匀平板非线性回旋动理学（GK）湍流模拟。磁场为 $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$，其大小 $B$ 为常数。电场为 $\\mathbf{E} = -\\nabla \\phi$，其中 $\\phi(x,y,t)$ 是静电势涨落。$E\\times B$ 漂移速度由 $\\mathbf{v}_{E} = \\mathbf{E}\\times \\mathbf{B} / B^{2}$ 给出，因此在平板模型中的径向分量为 $v_{E,x} = E_{y}/B = -(1/B)\\,\\partial_{y}\\phi$。设离子密度涨落为 $\\tilde{n}_{i}(x,y,t)$，它是绝热和非绝热回旋中心贡献的总和，但您应将 $\\tilde{n}_{i}$ 视为一个通过湍流动力学与 $\\phi$ 相关的实标量场。\n\n从这些基本定义出发，且不假设任何特定的模型闭合，推导离子密度和电势涨落之间交叉相位的谱表达式，并说明该交叉相位如何决定离子粒子通量的符号。使用以下操作性定义：\n- 离子粒子通量为 $\\Gamma_{i}(x,t) = \\langle \\tilde{n}_{i}(x,y,t)\\, v_{E,x}(x,y,t)\\rangle_{y,t}$，其中 $\\langle \\cdot \\rangle_{y,t}$ 表示对副法向坐标 $y$ 和远大于涨落周期的时间进行平均。\n- 对于具有副法向波数 $k_{y}$ 的单一主导副法向模，在固定的 $(x,t)$ 处，将涨落表示为 $\\tilde{n}_{i}(y) = A_{n}\\cos(k_{y} y + \\alpha_{n})$ 和 $\\phi(y) = A_{\\phi}\\cos(k_{y} y + \\alpha_{\\phi})$，其中 $A_{n}$ 和 $A_{\\phi}$ 是实振幅，$\\alpha_{n}$ 和 $\\alpha_{\\phi}$ 是相位。定义交叉相位角 $\\theta_{n\\phi} = \\alpha_{\\phi} - \\alpha_{n}$。\n\n从第一性原理（上述定义和标准傅里叶恒等式）出发，推导用 $A_{n}$、$A_{\\phi}$、$k_{y}$、$B$ 和 $\\theta_{n\\phi}$ 表示的 $\\Gamma_{i}$ 的解析表达式，并解释 $\\Gamma_{i}$ 的符号是如何由交叉相位决定的。然后，使用从模拟中给定半径处的合成诊断获得的以下物理上合理的参数：\n- $B = 2.7\\,\\text{T}$,\n- $k_{y} = 150\\,\\text{m}^{-1}$,\n- $A_{n} = 8.0\\times 10^{16}\\,\\text{m}^{-3}$,\n- $A_{\\phi} = 12.0\\,\\text{V}$,\n- $\\theta_{n\\phi} = -0.50\\,\\text{radians}$,\n\n计算该位置的离子粒子通量 $\\Gamma_{i}$ 的数值。以 $\\text{m}^{-2}\\,\\text{s}^{-1}$ 为单位表示您的最终答案，并将答案四舍五入到四位有效数字。请明确说明您使用的角度单位；此处提供的角度以弧度为单位。",
            "solution": "该问题提法明确，具有科学依据，并为得出完整解提供了所有必要信息。这是等离子体湍流理论中的一个标准练习。我将进行推导和计算。\n\n目标是推导离子粒子通量 $\\Gamma_i$ 的表达式，然后计算其数值。\n\n离子粒子通量定义为在副法向坐标 $y$ 和时间 $t$ 上，离子密度涨落 $\\tilde{n}_{i}$ 与 $E\\times B$ 漂移速度的径向分量 $v_{E,x}$ 乘积的平均值。\n$$\n\\Gamma_{i}(x) = \\langle \\tilde{n}_{i}(x,y,t) \\, v_{E,x}(x,y,t) \\rangle_{y,t}\n$$\n该问题考虑的是一个时间快照和固定的径向位置 $x$，因此平均实际上是在 $y$ 坐标上进行的。$E\\times B$ 漂移速度的径向分量由 $v_{E,x} = E_y/B$ 给出。由于电场表示为静电势的梯度，$\\mathbf{E} = -\\nabla\\phi$，我们有 $E_y = -\\partial_y \\phi$。因此，速度为：\n$$\nv_{E,x} = -\\frac{1}{B} \\frac{\\partial \\phi}{\\partial y}\n$$\n问题指明了对于波数为 $k_y$ 的单一主导副法向模，密度和电势涨落的函数形式为：\n$$\n\\tilde{n}_{i}(y) = A_{n}\\cos(k_{y} y + \\alpha_{n})\n$$\n$$\n\\phi(y) = A_{\\phi}\\cos(k_{y} y + \\alpha_{\\phi})\n$$\n其中 $A_n$ 和 $A_\\phi$ 是实振幅，$\\alpha_n$ 和 $\\alpha_\\phi$ 分别是它们的相位。\n\n首先，我们通过对 $\\phi(y)$ 的表达式求导来推导 $v_{E,x}(y)$ 的表达式：\n$$\nv_{E,x}(y) = -\\frac{1}{B} \\frac{\\partial}{\\partial y} \\left( A_{\\phi}\\cos(k_{y} y + \\alpha_{\\phi}) \\right)\n$$\n$$\nv_{E,x}(y) = -\\frac{A_{\\phi}}{B} \\left( -k_y \\sin(k_{y} y + \\alpha_{\\phi}) \\right) = \\frac{A_{\\phi} k_y}{B} \\sin(k_{y} y + \\alpha_{\\phi})\n$$\n现在，我们可以写出局部的、未经平均的通量，即 $\\tilde{n}_{i}(y)$ 和 $v_{E,x}(y)$ 的乘积：\n$$\n\\tilde{n}_{i}(y) v_{E,x}(y) = \\left( A_{n}\\cos(k_{y} y + \\alpha_{n}) \\right) \\left( \\frac{A_{\\phi} k_y}{B} \\sin(k_{y} y + \\alpha_{\\phi}) \\right)\n$$\n$$\n\\tilde{n}_{i}(y) v_{E,x}(y) = \\frac{A_{n} A_{\\phi} k_y}{B} \\cos(k_{y} y + \\alpha_{n}) \\sin(k_{y} y + \\alpha_{\\phi})\n$$\n为了求得净通量 $\\Gamma_i$，我们对这个乘积在一个空间周期 $y$（即 $L = 2\\pi/k_y$）上进行平均。\n$$\n\\Gamma_i = \\langle \\tilde{n}_{i}(y) v_{E,x}(y) \\rangle_y = \\frac{A_{n} A_{\\phi} k_y}{B} \\langle \\cos(k_{y} y + \\alpha_{n}) \\sin(k_{y} y + \\alpha_{\\phi}) \\rangle_y\n$$\n我们使用积化和差三角恒等式 $\\sin(U)\\cos(V) = \\frac{1}{2}(\\sin(U+V) + \\sin(U-V))$。令 $U = k_y y + \\alpha_{\\phi}$ 和 $V = k_y y + \\alpha_{n}$。\n$$\n\\cos(k_{y} y + \\alpha_{n}) \\sin(k_{y} y + \\alpha_{\\phi}) = \\frac{1}{2} \\left[ \\sin((k_y y + \\alpha_{\\phi}) + (k_y y + \\alpha_{n})) + \\sin((k_y y + \\alpha_{\\phi}) - (k_y y + \\alpha_{n})) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ \\sin(2k_y y + \\alpha_{\\phi} + \\alpha_{n}) + \\sin(\\alpha_{\\phi} - \\alpha_{n}) \\right]\n$$\n在一个完整周期内，具有非零波数的正弦函数的空间平均值为零。因此，$\\langle \\sin(2k_y y + \\alpha_{\\phi} + \\alpha_{n}) \\rangle_y = 0$。第二项 $\\sin(\\alpha_{\\phi} - \\alpha_{n})$ 是一个关于 $y$ 的常数，所以它的平均值就是它本身。\n$$\n\\langle \\cos(k_{y} y + \\alpha_{n}) \\sin(k_{y} y + \\alpha_{\\phi}) \\rangle_y = \\frac{1}{2} \\sin(\\alpha_{\\phi} - \\alpha_{n})\n$$\n交叉相位角定义为 $\\theta_{n\\phi} = \\alpha_{\\phi} - \\alpha_{n}$。将其代入 $\\Gamma_i$ 的表达式，我们得到离子粒子通量的最终解析表达式：\n$$\n\\Gamma_i = \\frac{A_{n} A_{\\phi} k_y}{2B} \\sin(\\theta_{n\\phi})\n$$\n该表达式说明了粒子通量是如何从涨落之间的关联中产生的。通量与密度和电势涨落的振幅（$A_n, A_\\phi$）、副法向波数（$k_y$）以及交叉相位角（$\\theta_{n\\phi}$）的正弦值成正比。\n\n粒子通量 $\\Gamma_i$ 的符号由 $\\sin(\\theta_{n\\phi})$ 的符号决定，因为振幅 $A_n$、$A_\\phi$、波数 $k_y$（按惯例取正值）和磁场强度 $B$ 都是正值。\n- 如果 $0  \\theta_{n\\phi}  \\pi$，则 $\\sin(\\theta_{n\\phi}) > 0$ 且 $\\Gamma_i > 0$，对应于向外的通量（从等离子体核心到边缘）。\n- 如果 $-\\pi  \\theta_{n\\phi}  0$，则 $\\sin(\\theta_{n\\phi})  0$ 且 $\\Gamma_i  0$，对应于向内的通量或“粒子箍缩”。\n- 如果 $\\theta_{n\\phi} = 0$ 或 $\\theta_{n\\phi} = \\pm\\pi$，则 $\\sin(\\theta_{n\\phi}) = 0$ 且 $\\Gamma_i = 0$。这表示密度和电势涨落完全同相或反相，导致没有净粒子输运。\n\n接下来，我们使用给定的参数计算 $\\Gamma_i$ 的数值：\n- $B = 2.7\\,\\text{T}$\n- $k_{y} = 150\\,\\text{m}^{-1}$\n- $A_{n} = 8.0 \\times 10^{16}\\,\\text{m}^{-3}$\n- $A_{\\phi} = 12.0\\,\\text{V}$\n- $\\theta_{n\\phi} = -0.50\\,\\text{radians}$\n\n将这些值代入推导出的 $\\Gamma_i$ 公式中：\n$$\n\\Gamma_i = \\frac{(8.0 \\times 10^{16}\\,\\text{m}^{-3}) \\times (12.0\\,\\text{V}) \\times (150\\,\\text{m}^{-1})}{2 \\times (2.7\\,\\text{T})} \\sin(-0.50)\n$$\n首先，我们计算前置因子：\n$$\n\\frac{(8.0 \\times 10^{16}) \\times 12.0 \\times 150}{2 \\times 2.7} = \\frac{1.44 \\times 10^{20}}{5.4} \\approx 2.666... \\times 10^{19}\n$$\n单位是 $\\frac{\\text{m}^{-3} \\cdot \\text{V} \\cdot \\text{m}^{-1}}{\\text{T}} = \\frac{\\text{V}}{\\text{T} \\cdot \\text{m}^4}$。使用关系式 $1\\,\\text{T} = 1\\,\\frac{\\text{V} \\cdot \\text{s}}{\\text{m}^2}$，单位变为 $\\frac{\\text{V}}{(\\text{V} \\cdot \\text{s} / \\text{m}^2) \\cdot \\text{m}^4} = \\frac{1}{\\text{s} \\cdot \\text{m}^2}$，这对于单位面积的通量密度是正确的。\n\n现在，我们计算完整的表达式。角度以弧度为单位。\n$$\n\\sin(-0.50) = -\\sin(0.50) \\approx -0.4794255\n$$\n$$\n\\Gamma_i \\approx (2.666... \\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1}) \\times (-0.4794255)\n$$\n$$\n\\Gamma_i \\approx -1.278468 \\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Gamma_i \\approx -1.278 \\times 10^{19}\\,\\text{m}^{-2}\\,\\text{s}^{-1}\n$$\n负号表示向内的粒子通量，这与交叉相位角 $\\theta_{n\\phi}$ 在 $(-\\pi, 0)$ 范围内的事实一致。",
            "answer": "$$\\boxed{-1.278 \\times 10^{19}}$$"
        },
        {
            "introduction": "在理解了输运的来源之后，我们接着探讨其调控机制。剪切流是调控等离子体湍流输运的核心机制，本练习旨在引导读者通过比较湍流涡旋的线性增长时间尺度与剪切流的拉伸退相干时间尺度，从物理上推导出剪切抑制湍流的著名判据 $|\\omega_s| \\gtrsim \\gamma_{\\mathrm{lin}}$ 。这个实践有助于学生量化地理解这一关键的非线性饱和过程。",
            "id": "4021439",
            "problem": "考虑一个由非线性回旋动理学模型描述的静电、无碰撞、低$\\beta$值的托卡马克芯部等离子体，其背景磁场强度 $B$ 在感兴趣的区域内近似均匀。电叉磁（E$\\times$B）漂移流 $V_E(r)$ 提供了一个背景剪切平流。一个极向波数为 $k_y$ 的线性波包会经历由离子温度梯度（ITG）不稳定性引起的线性放大，以及由E$\\times$B漂移流引起的剪切畸变。\n\n(a) 从回旋动理学级数和背景E$\\times$B剪切对波包的影响出发，推导一个联系E$\\times$B剪切率和线性增长率的判据，该判据划分了湍流涡旋的抑制边界。你的推导应基于关于线性放大和剪切引起的退相干之间竞争的第一性原理，而不引用任何预先给定的抑制判据。\n\n(b) 对于一个典型的ITG情形，估算临界E$\\times$B剪切率。假设以下参数和近似，这些在芯部湍流的回旋动理学模拟中是标准的：\n- 磁场强度 $B = 3\\,\\mathrm{T}$。\n- 电子温度 $T_e = 2\\,\\mathrm{keV}$。\n- 离子温度 $T_i = 2\\,\\mathrm{keV}$。\n- 离子质量 $m_i = 2 m_p$，其中 $m_p$ 是质子质量。\n- 密度梯度标长 $L_n = 0.30\\,\\mathrm{m}$。\n- 离子温度梯度标长 $L_{T_i} = 0.15\\,\\mathrm{m}$。\n- 最不稳定尺度由 $k_y \\rho_s = 0.30$ 表征，其中 $\\rho_s$ 是离子声回旋半径。\n使用标准的ITG线性增长率估计式\n$$\n\\gamma_{\\mathrm{lin}} \\approx \\omega_{*} \\sqrt{\\frac{\\eta_i}{\\eta_{i,\\mathrm{crit}}} - 1},\n$$\n其中 $\\eta_i \\equiv L_n/L_{T_i}$，$\\eta_{i,\\mathrm{crit}} = 1.5$，离子抗磁频率为\n$$\n\\omega_{*} = \\frac{k_y \\rho_s c_s}{L_n},\n$$\n其中 $c_s = \\sqrt{\\frac{k_B T_e}{m_i}}$ 是离子声速，$\\rho_s = \\frac{c_s}{\\Omega_{ci}}$，$\\Omega_{ci} = \\frac{e B}{m_i}$ 是离子回旋频率。根据(a)部分得到的判据，使用上述参数以及所需的物理常数 $e$、$k_B$ 和 $m_p$，计算临界E$\\times$B剪切率的数值（单位为 $\\mathrm{s}^{-1}$）。将最终数值答案四舍五入到三位有效数字，并以 $\\mathrm{s}^{-1}$ 为单位表示。",
            "solution": "此问题经评估是有效的。它在科学上基于等离子体物理和回旋动理学理论的原理，问题提法恰当，信息充分且一致，表述客观。该问题要求推导一个基本的湍流抑制判据并进行后续的数值估算，这两者都是聚变等离子体科学中的标准练习。\n\n(a) 抑制判据的推导\n\n剪切背景流对湍流的抑制是两个基本过程之间竞争的结果：湍流涨落的线性放大和由剪切流的差分平流引起的这些涨落的退相干。我们将通过比较这两个过程的特征时间尺度来推导抑制判据。\n\n湍流涡旋可以被建模为涨落的波包，它由一种不稳定性驱动，在本例中即离子温度梯度（ITG）不稳定性。涨落的振幅（记为 $\\phi$）在线性阶段随时间指数增长，遵循方程 $\\frac{d\\phi}{dt} = \\gamma_{\\mathrm{lin}} \\phi$，其中 $\\gamma_{\\mathrm{lin}}$ 是线性增长率。涡旋增长到显著幅度的特征时间是增长的e指数折叠时间，\n$$\n\\tau_{\\mathrm{growth}} = \\frac{1}{\\gamma_{\\mathrm{lin}}}\n$$\n为了使湍流发展起来，涡旋必须在至少与 $\\tau_{\\mathrm{growth}}$ 相当的时间内保持其空间相干性。\n\n同时，随径向坐标 $r$ 变化的背景E$\\times$B流 $V_E(r)$ 会平流输运该涡旋。该速度随半径的变化率即为剪切率，定义为 $\\omega_s \\equiv \\frac{dV_E}{dr}$。在简化的平板几何背景下，$r$ 对应于 $x$ 坐标，极向为 $y$ 方向，则E$\\times$B速度在极向（$y$）方向上，$v_y(x) = E_x/B$，剪切率为 $\\omega_s = \\frac{d v_y}{dx}$。\n\n考虑一个特征径向相关长度为 $\\Delta r_c$ 的湍流涡旋。在涡旋的径向范围内的差分极向速度为 $\\Delta v_y \\approx \\omega_s \\Delta r_c$。这种差分流在极向拉伸涡旋。当结构的不同部分相对于彼此被剪切了与其自身特征尺寸相当的距离时，该涡旋被认为是“撕裂”或退相干的。剪切流使涡旋顶部相对于底部位移一个等于径向相关长度 $\\Delta r_c$ 的距离所需的时间就是退相干时间 $\\tau_{\\mathrm{decorr}}$。这个时间由关系式 $(\\Delta v_y) \\tau_{\\mathrm{decorr}} \\approx \\Delta r_c$ 确定。代入 $\\Delta v_y$：\n$$\n(\\omega_s \\Delta r_c) \\tau_{\\mathrm{decorr}} \\approx \\Delta r_c\n$$\n这给出了退相干时间尺度为：\n$$\n\\tau_{\\mathrm{decorr}} \\approx \\frac{1}{|\\omega_s|}\n$$\n这个时间尺度表示一个相干涡旋在被剪切破坏前能存活多久。\n\n如果涡旋被剪切流撕裂的速度快于它们因不稳定性而增长的速度，湍流就会被抑制。这转化为条件：退相干时间必须短于或至多与增长时间相当：\n$$\n\\tau_{\\mathrm{decorr}} \\lesssim \\tau_{\\mathrm{growth}}\n$$\n代入时间尺度的表达式，我们得到：\n$$\n\\frac{1}{|\\omega_s|} \\lesssim \\frac{1}{\\gamma_{\\mathrm{lin}}}\n$$\n这意味着要实现抑制，剪切率必须超过线性增长率：\n$$\n|\\omega_s| \\gtrsim \\gamma_{\\mathrm{lin}}\n$$\n因此，划分湍流涡旋抑制边界的临界条件是，剪切率约等于系统中线性增长率最大的模式的增长率 $\\gamma_{\\mathrm{lin, max}}$。\n$$\n|\\omega_s| \\approx \\gamma_{\\mathrm{lin, max}}\n$$\n这就是所求的联系E$\\times$B剪切率和线性增长率的判据。\n\n(b) 临界剪切率的估算\n\n我们现在使用给定的参数和公式，计算临界E$\\times$B剪切率 $\\omega_{s, \\mathrm{crit}} = \\gamma_{\\mathrm{lin, max}}$ 的数值。\n\n线性增长率由下式给出\n$$\n\\gamma_{\\mathrm{lin}} \\approx \\omega_{*} \\sqrt{\\frac{\\eta_i}{\\eta_{i,\\mathrm{crit}}} - 1}\n$$\n首先，我们计算参数 $\\eta_i$：\n$$\n\\eta_i = \\frac{L_n}{L_{T_i}} = \\frac{0.30\\,\\mathrm{m}}{0.15\\,\\mathrm{m}} = 2.0\n$$\n当 $\\eta_{i,\\mathrm{crit}} = 1.5$ 时，平方根下的项为：\n$$\n\\sqrt{\\frac{\\eta_i}{\\eta_{i,\\mathrm{crit}}} - 1} = \\sqrt{\\frac{2.0}{1.5} - 1} = \\sqrt{\\frac{4}{3} - 1} = \\sqrt{\\frac{1}{3}}\n$$\n接下来，我们计算离子抗磁频率 $\\omega_{*}$：\n$$\n\\omega_{*} = \\frac{k_y \\rho_s c_s}{L_n}\n$$\n为了计算这个值，我们需要离子声速 $c_s = \\sqrt{\\frac{k_B T_e}{m_i}}$。在等离子体物理学中，通常用能量单位（如keV）来表示温度。$k_B T_e$ 项代表热能，我们可以通过将 $T_e$ 从keV转换为焦耳来获得。\n电子温度为 $T_e = 2\\,\\mathrm{keV}$。\n使用元电荷 $e \\approx 1.60218 \\times 10^{-19}\\,\\mathrm{C}$，能量（以焦耳为单位）为：\n$$\nk_B T_e = 2 \\times 10^3\\,\\mathrm{eV} \\times \\frac{1.60218 \\times 10^{-19}\\,\\mathrm{J}}{1\\,\\mathrm{eV}} \\approx 3.20436 \\times 10^{-16}\\,\\mathrm{J}\n$$\n离子质量为 $m_i = 2 m_p$。使用质子质量 $m_p \\approx 1.67262 \\times 10^{-27}\\,\\mathrm{kg}$：\n$$\nm_i = 2 \\times (1.67262 \\times 10^{-27}\\,\\mathrm{kg}) \\approx 3.34524 \\times 10^{-27}\\,\\mathrm{kg}\n$$\n现在，我们可以计算离子声速：\n$$\nc_s = \\sqrt{\\frac{3.20436 \\times 10^{-16}\\,\\mathrm{J}}{3.34524 \\times 10^{-27}\\,\\mathrm{kg}}} \\approx \\sqrt{9.57887 \\times 10^{10}\\,\\mathrm{m}^2/\\mathrm{s}^2} \\approx 3.0950 \\times 10^5\\,\\mathrm{m/s}\n$$\n利用给定值 $k_y \\rho_s = 0.30$ 和 $L_n = 0.30\\,\\mathrm{m}$，我们求得 $\\omega_*$：\n$$\n\\omega_{*} = \\frac{(0.30) \\times (3.0950 \\times 10^5\\,\\mathrm{m/s})}{0.30\\,\\mathrm{m}} = 3.0950 \\times 10^5\\,\\mathrm{s}^{-1}\n$$\n最后，我们计算线性增长率：\n$$\n\\gamma_{\\mathrm{lin}} = \\omega_{*} \\sqrt{\\frac{1}{3}} \\approx (3.0950 \\times 10^5\\,\\mathrm{s}^{-1}) \\times \\frac{1}{1.73205} \\approx 1.7869 \\times 10^5\\,\\mathrm{s}^{-1}\n$$\n因此，临界E$\\times$B剪切率为 $\\omega_{s, \\mathrm{crit}} = \\gamma_{\\mathrm{lin}} \\approx 1.7869 \\times 10^5\\,\\mathrm{s}^{-1}$。四舍五入到三位有效数字，我们得到：\n$$\n\\omega_{s, \\mathrm{crit}} \\approx 1.79 \\times 10^5\\,\\mathrm{s}^{-1}\n$$",
            "answer": "$$ \\boxed{1.79 \\times 10^{5}} $$"
        },
        {
            "introduction": "将物理定律转化为计算机算法时，必须仔细考虑数值稳定性，以确保模拟结果的可靠性。本练习将使用冯·诺依曼稳定性分析这一标准工具，来确定一个用于模拟回旋动理学方程中关键非线性项（$E \\times B$ 平流）的离散格式的稳定条件 。通过这个练习，可以深入理解时间步长等参数选择所受到的实际限制，例如著名的库朗数（Courant number）条件。",
            "id": "4021454",
            "problem": "考虑在均匀磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$ 中，描述涨落分布函数 $f(x,y,z,v_{\\parallel},\\mu,t)$ 的静电、无碰撞、局域平板回旋动理学 (GK) 方程，其中非线性项由 $\\mathbf{E} \\times \\mathbf{B}$ 漂移产生。GK 方程中的非线性平流贡献可以写成守恒形式的泊松括号\n$$\n\\left\\{ \\langle \\phi \\rangle, f \\right\\} \\equiv \\frac{c}{B} \\left( \\hat{\\mathbf{z}} \\times \\nabla \\langle \\phi \\rangle \\right) \\cdot \\nabla f ,\n$$\n其中 $\\langle \\phi \\rangle(x,y,t)$ 是回旋平均静电势，$c$ 是光速。假设电势具有波数为 $k_{y}$ 的单一主导角向傅里叶分量，并在一个时间步长 $\\Delta t$ 内采用标准的冻结系数近似，从而使得 $x$ 方向的 $\\mathbf{E} \\times \\mathbf{B}$ 速度在更新期间是空间均匀且为正的，即 $U \\equiv -\\frac{c}{B} \\frac{\\partial \\langle \\phi \\rangle}{\\partial y}  0$。在这些假设下，非线性项简化为周期性区域 $x \\in [0,L_{x}]$ 上的一维平流方程：\n$$\n\\frac{\\partial f}{\\partial t} + U \\frac{\\partial f}{\\partial x} = 0 ,\n$$\n用间距为 $\\Delta x$、指标为 $j = 0,1,\\dots,N-1$ 的均匀有限差分网格对 $x$ 进行离散化，并以时间步长 $t^{n} = n \\Delta t$ 对时间进行离散化。在时间上采用向前欧拉格式，在 $x$ 方向上采用适用于 $U  0$ 的一阶迎风差分，非线性平流项的显式更新格式为\n$$\nf_{j}^{n+1} = f_{j}^{n} - C \\left( f_{j}^{n} - f_{j-1}^{n} \\right) ,\n$$\n其中 $C \\equiv \\frac{U \\Delta t}{\\Delta x}$ 是库朗数。\n\n通过代入实相位 $\\theta \\in [0,2\\pi)$ 的单个傅里叶模式 $f_{j}^{n} = \\hat{f}^{n} \\exp\\!\\left( i j \\theta \\right)$，对该周期性边界条件下的离散格式进行 von Neumann 稳定性分析，并确定放大因子 $G(\\theta;C) \\equiv \\frac{\\hat{f}^{n+1}}{\\hat{f}^{n}}$（作为 $C$ 的函数）。使用对所有 $\\theta$ 都满足 $|G(\\theta;C)| \\leq 1$ 的稳定性要求，确定该非线性 $\\mathbf{E} \\times \\mathbf{B}$ 平流项的显式迎风格式的最大稳定库朗数 $C_{\\text{max}}$。\n\n你的最终答案必须是 $C_{\\text{max}}$ 的无量纲值，形式为单个实数。无需四舍五入。",
            "solution": "该问题要求对一维平流方程的离散数值格式进行 von Neumann 稳定性分析，该方程在简化的回旋动理学背景下模拟非线性 $\\mathbf{E} \\times \\mathbf{B}$ 平流项。\n\n控制偏微分方程如下所示：\n$$\n\\frac{\\partial f}{\\partial t} + U \\frac{\\partial f}{\\partial x} = 0\n$$\n其中 $U  0$ 是一个恒定的平流速度。区域是周期性的。\n\n该方程在时间上采用向前欧拉格式，在空间上采用一阶迎风格式进行离散化。对于 $U  0$，在网格点 $j$ 处 $\\frac{\\partial f}{\\partial x}$ 的迎风差分为 $\\frac{f_j - f_{j-1}}{\\Delta x}$。得到的显式有限差分方程为：\n$$\n\\frac{f_{j}^{n+1} - f_{j}^{n}}{\\Delta t} + U \\frac{f_{j}^{n} - f_{j-1}^{n}}{\\Delta x} = 0\n$$\n重新整理此方程以求解 $f_{j}^{n+1}$，可得到问题陈述中提供的更新规则：\n$$\nf_{j}^{n+1} = f_{j}^{n} - \\frac{U \\Delta t}{\\Delta x} \\left( f_{j}^{n} - f_{j-1}^{n} \\right)\n$$\n引入库朗数 $C \\equiv \\frac{U \\Delta t}{\\Delta x}$，该格式可写为：\n$$\nf_{j}^{n+1} = f_{j}^{n} - C \\left( f_{j}^{n} - f_{j-1}^{n} \\right)\n$$\n为了进行 von Neumann 稳定性分析，我们研究解中单个傅里叶模式的放大情况。我们将试探解 $f_{j}^{n} = \\hat{f}^{n} \\exp(i j \\theta)$ 代入离散方程。这里，$\\hat{f}^{n}$ 是时间步 $n$ 时傅里叶模式的复振幅，$j$ 是空间网格指标，$\\theta = k_x \\Delta x$ 是相邻网格点之间的无量纲相位差，其中 $k_x$ 是波数。\n\n对于离散方程中的每一项，代入后得到：\n\\begin{align*}\nf_{j}^{n+1} = \\hat{f}^{n+1} \\exp(i j \\theta) \\\\\nf_{j}^{n} = \\hat{f}^{n} \\exp(i j \\theta) \\\\\nf_{j-1}^{n} = \\hat{f}^{n} \\exp(i (j-1) \\theta) = \\hat{f}^{n} \\exp(i j \\theta) \\exp(-i \\theta)\n\\end{align*}\n将这些表达式代入有限差分格式，得到：\n$$\n\\hat{f}^{n+1} \\exp(i j \\theta) = \\hat{f}^{n} \\exp(i j \\theta) - C \\left( \\hat{f}^{n} \\exp(i j \\theta) - \\hat{f}^{n} \\exp(i j \\theta) \\exp(-i \\theta) \\right)\n$$\n我们可以将整个方程除以公因子 $\\hat{f}^{n} \\exp(i j \\theta)$，因为该因子不为零（否则该模式是平凡的）。这样就得到了放大因子 $G(\\theta;C) \\equiv \\frac{\\hat{f}^{n+1}}{\\hat{f}^{n}}$ 的表达式：\n$$\nG(\\theta;C) = 1 - C \\left( 1 - \\exp(-i \\theta) \\right)\n$$\n为使数值格式稳定，对于相位 $\\theta \\in [0, 2\\pi)$ 的任何可能值，放大因子的模都不得超过 1。该稳定性条件表示为：\n$$\n|G(\\theta;C)| \\leq 1 \\quad \\forall \\theta\n$$\n这等价于条件 $|G(\\theta;C)|^2 \\leq 1$。让我们计算 $G$ 的模的平方。首先，使用欧拉公式 $\\exp(-i\\theta) = \\cos(\\theta) - i\\sin(\\theta)$，我们可以将 $G$ 写成实部和虚部的形式：\n$$\nG(\\theta;C) = (1 - C + C\\cos(\\theta)) + i(C\\sin(\\theta))\n$$\n模的平方是实部和虚部的平方和：\n\\begin{align*}\n|G(\\theta;C)|^2 = \\left( 1 - C + C\\cos(\\theta) \\right)^2 + \\left( C\\sin(\\theta) \\right)^2 \\\\\n= (1 - C)^2 + 2(1 - C)C\\cos(\\theta) + C^2\\cos^2(\\theta) + C^2\\sin^2(\\theta) \\\\\n= 1 - 2C + C^2 + 2C\\cos(\\theta) - 2C^2\\cos(\\theta) + C^2 \\\\\n= 1 - 2C + 2C^2 + (2C - 2C^2)\\cos(\\theta) \\\\\n= 1 - 2C(1 - C) + 2C(1 - C)\\cos(\\theta) \\\\\n= 1 - 2C(1 - C)(1 - \\cos(\\theta))\n\\end{align*}\n现在，我们应用稳定性条件 $|G(\\theta;C)|^2 \\leq 1$：\n$$\n1 - 2C(1 - C)(1 - \\cos(\\theta)) \\leq 1\n$$\n两边同时减去 1，得到：\n$$\n-2C(1 - C)(1 - \\cos(\\theta)) \\leq 0\n$$\n两边除以 -2，不等号反向：\n$$\nC(1 - C)(1 - \\cos(\\theta)) \\geq 0\n$$\n为了确定对 $C$ 的约束，我们分析该不等式中的每个因子。\n\\begin{enumerate}\n    \\item 库朗数 $C = \\frac{U \\Delta t}{\\Delta x}$ 的定义中，$U  0$, $\\Delta t  0$, $\\Delta x  0$。因此，我们必须有 $C \\geq 0$。如果 $C=0$，不等式平凡地成立。\n    \\item 对于任何实数 $\\theta$，由于 $\\cos(\\theta)$ 的取值范围是 $[-1, 1]$，项 $(1 - \\cos(\\theta))$ 总是非负的。具体来说，$0 \\leq 1 - \\cos(\\theta) \\leq 2$。\n\\end{enumerate}\n鉴于 $C \\geq 0$ 和 $(1 - \\cos(\\theta)) \\geq 0$，不等式 $C(1 - C)(1 - \\cos(\\theta)) \\geq 0$ 对所有 $\\theta$ 都成立的充分必要条件是剩下的因子 $(1 - C)$ 也为非负。\n$$\n1 - C \\geq 0 \\implies C \\leq 1\n$$\n综合这些条件，该格式稳定的充分必要条件是 $0 \\leq C \\leq 1$。因此，能够保证稳定性的库朗数的最大值为 $1$。\n\n因此，该显式迎风格式的最大稳定库朗数为 $C_{\\text{max}} = 1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}