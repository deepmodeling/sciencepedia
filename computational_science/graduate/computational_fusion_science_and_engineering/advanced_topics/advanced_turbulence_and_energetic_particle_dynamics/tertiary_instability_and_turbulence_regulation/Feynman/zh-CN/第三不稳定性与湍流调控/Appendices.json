{
    "hands_on_practices": [
        {
            "introduction": "三次不稳定性本质上是一种调制不稳定性。本练习将引导您通过等离子体物理学中的一个基本模型——Charney-Hasegawa-Mima (CHM) 方程，来推导这种不稳定性的产生过程。通过运用多尺度分析方法，您将得出一个描述初级漂移波包络的非线性薛定谔 (NLS) 方程，并揭示其包络的调制不稳定性正是带状流三次不稳定性的根源。 这项实践旨在培养您在非线性波理论方面的核心分析能力，并让您从第一性原理层面理解三次不稳定性的起源。",
            "id": "4052617",
            "problem": "考虑描述磁化等离子体中绝热电子的静电漂移波动力学的 Charney–Hasegawa–Mima (CHM) 方程。该方程以离子声拉莫尔半径 $\\rho_s$ 作为长度单位，离子声时 $\\rho_s/c_s$ 作为时间单位，写成归一化形式为：\n$$\n\\frac{\\partial}{\\partial t}\\left(\\nabla^{2}\\phi - \\phi\\right) + \\left\\{\\phi, \\nabla^{2}\\phi\\right\\} + \\frac{\\partial \\phi}{\\partial y} = 0,\n$$\n其中 $\\phi$ 是归一化的静电势，$\\nabla^{2}$ 是垂直于磁场平面内的拉普拉斯算子，而 $\\{f,g\\} \\equiv \\partial_x f\\,\\partial_y g - \\partial_y f\\,\\partial_x g$ 是与 $\\mathbf{E}\\times\\mathbf{B}$（电场叉乘磁场）漂移非线性相关的规范泊松括号。波矢为 $\\boldsymbol{k}=(k_x,k_y)$ 的线性漂移波的频率为\n$$\n\\omega(\\boldsymbol{k}) = \\frac{k_y}{1 + k^{2}}, \\quad k^{2}\\equiv k_x^{2} + k_y^{2}.\n$$\n假设一个准单色泵浦漂移波，其载波矢为 $\\boldsymbol{k}_0=(k_x,k_y)$，复包络振幅为 $A(X,T)$，对应于慢径向调制 $X$ 和慢时间 $T$，使得\n$$\n\\phi(x,y,t) \\approx \\Re\\left\\{A(X,T)\\,\\exp\\!\\left[i\\left(k_x x + k_y y - \\omega(\\boldsymbol{k}_0) t\\right)\\right]\\right\\},\n$$\n并且调制是纯径向的，带状流波数为 $q$（即，调制随 $\\exp(i q x)$ 变化且 $k_y=0$）。使用多尺度展开到领头非平凡阶，包络动力学简化为一个非线性薛定谔型方程\n$$\ni\\,\\frac{\\partial A}{\\partial T} + \\alpha\\,\\frac{\\partial^{2} A}{\\partial X^{2}} + \\beta\\,|A|^{2}A = 0,\n$$\n该方程是在以群速度运动的随动参考系中描述的，其中 $\\alpha$ 是从线性漂移波色散导出的色散曲率系数，$\\beta$ 是从 $\\mathbf{E}\\times\\mathbf{B}$ 平流继承的三次非线性系数。在本问题中，采用规范振幅归一化，使得 $\\beta=1$。\n\n从 CHM 方程和漂移波色散关系出发，完成以下任务：\n\n- 通过计算 $\\omega(\\boldsymbol{k})$ 在 $\\boldsymbol{k}_0$ 处对 $k_x$ 的二阶导数并考虑标准的包络约化因子，显式地导出 $\\alpha$ 关于泵浦波矢分量 $(k_x,k_y)$ 的表达式。\n- 围绕平面波解 $A(X,T)=A_0\\,\\exp(i\\,|A_0|^{2} T)$ 对非线性薛定谔方程进行线性化，并导出形式为 $\\delta A \\propto \\exp(i q X + \\gamma T)$ 的微扰的调制不稳定性增长率 $\\gamma(q)$。\n- 根据你得到的 $\\gamma(q)$ 表达式，获得联系漂移波振幅 $|A_0|$ 和带状流波数 $q$ 的调制不稳定性条件，该条件用于三级边带的增长。\n- 以 $k_x$、$k_y$ 和 $|A_0|$ 的闭合形式解析表达式，计算增长最快的三级边带的波数 $q_\\ast$（即使 $\\gamma(q)$ 最大化的调制）。\n\n假设泵浦参数满足此模型中调制不稳定性所需的聚焦条件。将 $q_\\ast$ 的最终结果以 $\\rho_s^{-1}$ 为单位表示。无需进行数值计算；请提供精确的解析表达式。最终答案必须是单一的闭合形式表达式。",
            "solution": "本题要求通过四个推导步骤，找到漂移波调制不稳定性中增长最快的三级边带的波数 $q_\\ast$。\n\n**1. 色散系数 $\\alpha$ 的推导**\n\nNLS 方程中的系数 $\\alpha$ 代表群速度色散。对于 $x$ 方向的包络调制（慢坐标为 $X$），$\\alpha$ 由线性频率 $\\omega(\\boldsymbol{k})$ 对 $k_x$ 的二阶导数的一半给出，并在泵浦波矢 $\\boldsymbol{k}_0=(k_x, k_y)$ 处求值：\n$$\n\\alpha = \\frac{1}{2} \\frac{\\partial^2 \\omega}{\\partial k_x^2} \\bigg|_{\\boldsymbol{k}=\\boldsymbol{k}_0}\n$$\n线性色散关系为 $\\omega(\\boldsymbol{k}) = k_y (1 + k_x^2 + k_y^2)^{-1}$。我们计算关于 $k_x$ 的偏导数。\n\n一阶导数：\n$$\n\\frac{\\partial \\omega}{\\partial k_x} = k_y \\frac{\\partial}{\\partial k_x} (1 + k_x^2 + k_y^2)^{-1} = k_y \\left( -1 \\cdot (1 + k_x^2 + k_y^2)^{-2} \\cdot 2k_x \\right) = \\frac{-2 k_x k_y}{(1 + k_x^2 + k_y^2)^2}\n$$\n\n二阶导数：\n$$\n\\frac{\\partial^2 \\omega}{\\partial k_x^2} = -2k_y \\frac{\\partial}{\\partial k_x} \\left( \\frac{k_x}{(1 + k_x^2 + k_y^2)^2} \\right) = -2k_y \\left( \\frac{1 \\cdot (1 + k_x^2 + k_y^2)^2 - k_x \\cdot 2(1 + k_x^2 + k_y^2) \\cdot 2k_x}{(1 + k_x^2 + k_y^2)^4} \\right)\n$$\n$$\n\\frac{\\partial^2 \\omega}{\\partial k_x^2} = -2k_y \\left( \\frac{(1 + k_x^2 + k_y^2) - 4k_x^2}{(1 + k_x^2 + k_y^2)^3} \\right) = \\frac{2k_y (3k_x^2 - k_y^2 - 1)}{(1 + k_x^2 + k_y^2)^3}\n$$\n因此，系数 $\\alpha$ 为：\n$$\n\\alpha = \\frac{1}{2} \\frac{\\partial^2 \\omega}{\\partial k_x^2} = \\frac{k_y (3k_x^2 - k_y^2 - 1)}{(1 + k_x^2 + k_y^2)^3}\n$$\n\n**2. 调制不稳定性增长率 $\\gamma(q)$ 的推导**\n\n对于 $\\beta=1$，NLS 方程为 $i\\,\\frac{\\partial A}{\\partial T} + \\alpha\\,\\frac{\\partial^{2} A}{\\partial X^{2}} + |A|^{2}A = 0$。我们围绕平面波解 $A_s(T) = A_0 \\exp(i |A_0|^2 T)$ 进行线性化。设微扰解为 $A(X,T) = (A_0 + \\delta A) \\exp(i |A_0|^2 T)$。将此代入 NLS 方程并保留 $\\delta A$ 的线性项，可以得到一个关于 $\\delta A$ 和其复共轭 $\\delta A^*$ 的耦合方程：\n$$\ni \\frac{\\partial (\\delta A)}{\\partial T} + \\alpha \\frac{\\partial^2 (\\delta A)}{\\partial X^2} + |A_0|^2 \\delta A + A_0^2 \\delta A^* = 0\n$$\n我们寻找形如 $\\delta A(X,T) = \\delta A_+ e^{i q X + \\gamma T} + \\delta A_-^* e^{-i q X + \\gamma^* T}$ 的解。代入后可得一个关于 $\\delta A_+$ 和 $\\delta A_-^*$ 的代数方程组，其系数矩阵的行列式为零时有非平凡解。该条件最终导出增长率 $\\gamma$ 满足的色散关系。一个标准的结果是：\n$$\n\\gamma^2 = \\alpha q^2 (2|A_0|^2 - \\alpha q^2)\n$$\n因此，增长率 $\\gamma(q)$ 是该表达式的正平方根：\n$$\n\\gamma(q) = \\sqrt{\\alpha q^2 (2|A_0|^2 - \\alpha q^2)}\n$$\n\n**3. 调制不稳定性条件**\n\n当增长率 $\\gamma$ 为实数且为正时，发生不稳定性，这要求 $\\gamma^2 > 0$。\n$$\n\\alpha q^2 (2|A_0|^2 - \\alpha q^2) > 0\n$$\n问题陈述中假设了聚焦条件，对于 $\\beta=1>0$ 的 NLS 方程，该条件为 $\\alpha > 0$。由于 $q^2 > 0$，项 $\\alpha q^2$ 为正。因此，不稳定性的条件变为：\n$$\n2|A_0|^2 - \\alpha q^2 > 0 \\implies \\alpha q^2  2|A_0|^2\n$$\n这个不等式，连同聚焦条件 $\\alpha > 0$，定义了不稳定波数的范围：$0  q^2  2|A_0|^2 / \\alpha$。\n\n**4. 增长最快模式的波数 $q_\\ast$**\n\n为了找到使增长率 $\\gamma(q)$ 最大化的波数 $q_\\ast$，我们可以最大化其平方 $\\gamma^2(q)$。令 $z = q^2$。我们想要最大化函数 $f(z) = \\alpha z (2|A_0|^2 - \\alpha z) = 2\\alpha|A_0|^2 z - \\alpha^2 z^2$ (对于 $z > 0$)。我们通过将其对 $z$ 的导数设为零来找到临界点：\n$$\n\\frac{df}{dz} = 2\\alpha|A_0|^2 - 2\\alpha^2 z = 0\n$$\n解出 $z$：\n$$\n2\\alpha^2 z = 2\\alpha|A_0|^2 \\implies z = \\frac{|A_0|^2}{\\alpha}\n$$\n这对应于增长最快模式的波数平方：\n$$\nq_\\ast^2 = \\frac{|A_0|^2}{\\alpha}\n$$\n二阶导数为 $d^2f/dz^2 = -2\\alpha^2  0$ （因为 $\\alpha$ 是非零实数），这证实了这是一个最大值。波数 $q_\\ast$ 是其正平方根：\n$$\nq_\\ast = \\sqrt{\\frac{|A_0|^2}{\\alpha}} = \\frac{|A_0|}{\\sqrt{\\alpha}}\n$$\n代入第一步中推导出的 $\\alpha$ 的表达式：\n$$\nq_\\ast = |A_0| \\left( \\frac{k_y (3k_x^2 - k_y^2 - 1)}{(1 + k_x^2 + k_y^2)^3} \\right)^{-1/2}\n$$\n$$\nq_\\ast = |A_0| \\sqrt{\\frac{(1 + k_x^2 + k_y^2)^3}{k_y (3k_x^2 - k_y^2 - 1)}}\n$$\n这就是增长最快的三级不稳定性波数的最终闭合形式表达式，根据问题的设定，它已经是归一化单位 $\\rho_s^{-1}$。",
            "answer": "$$\n\\boxed{|A_0| \\sqrt{\\frac{(1 + k_x^2 + k_y^2)^3}{k_y (3k_x^2 - k_y^2 - 1)}}}\n$$"
        },
        {
            "introduction": "在理解了三次不稳定性如何产生之后，关键的下一步是探究如何控制或抑制它们。碰撞是等离子体中一种基本的耗散过程，能够有效抑制各类不稳定性。本练习通过一个洛伦兹变桨角散射算符来模拟碰撞效应，并要求您计算其对特定模式自由能的耗散贡献。 这项实践让您亲身体验如何处理碰撞算符并进行稳定性分析，最终得出一个界定不稳定性被抑制的临界条件，从而突显了决定等离子体输运的驱动与阻尼之间的关键平衡。",
            "id": "4052563",
            "problem": "考虑一个由非线性回旋动理学方程描述的静电、磁化等离子体，该方程描述了分布函数的非绝热部分 $h(\\mathbf{R}, v, \\xi, t)$，其中 $\\mathbf{R}$ 是回旋中心位置，$v$ 是速率，$\\xi = v_{\\parallel}/v$ 是螺距角余弦。设平衡分布为静态麦克斯韦分布 $F_{0}(v)$，并定义回旋动理学自由能为\n$$\nW(t) = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{|h(\\mathbf{R}, v, \\xi, t)|^{2}}{2\\,F_{0}(v)}.\n$$\n假设碰撞效应通过模型洛伦兹螺距角散射算子引入，该算子是 Fokker–Planck (FP) 碰撞算子的一种简化形式，它在 $\\xi$ 上保持自伴性，\n$$\nC[h] = \\nu\\,\\frac{\\partial}{\\partial \\xi}\\left[(1-\\xi^{2})\\,\\frac{\\partial h}{\\partial \\xi}\\right],\n$$\n其中碰撞频率 $\\nu0$ 为常数。在三次不稳定性发生附近，考虑一个单模微扰，其螺距角结构由单一的 $\\ell$ 阶勒让德多项式 $P_{\\ell}(\\xi)$（$\\ell \\in \\mathbb{N}$）主导，其空间依赖性为径向上的单一傅里叶模式，\n$$\nh(\\mathbf{R}, v, \\xi, t) = \\hat{h}(v, t)\\,P_{\\ell}(\\xi)\\,\\exp(i k_{x} x),\n$$\n其中 $k_{x}$ 是一个恒定的径向波数，$\\hat{h}(v, t)$ 是一个慢变振幅。三次不稳定性驱动被建模为一个有效线性增长率 $\\gamma_{t}0$，它源于预先存在的带状流与背景梯度的相互作用，因此对振幅动力学的净线性贡献为 $\\partial_{t}\\hat{h} = \\gamma_{t}\\,\\hat{h} + \\text{碰撞项} + \\text{非线性项}$。为本次计算目的，忽略所有非线性项和平行流。\n\n从给定的定义出发，并且不使用任何快捷公式，完成以下任务：\n\n1. 解析计算自由能时间导数的碰撞贡献，\n$$\n\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{h}{F_{0}}\\,C[h],\n$$\n对于给定的模型和模式结构。用 $\\nu$、$\\ell$ 和自由能 $W$ 表示你的结果。\n\n2. 从你的结果中，推断出模式振幅的有效碰撞阻尼率，并得出一个描述碰撞阻尼抑制三次不稳定性增长的判据。推导出使得三次不稳定性增长处于临界状态的临界碰撞频率 $\\nu_{c}$，并用 $\\gamma_{t}$ 和 $\\ell$ 表示。\n\n将你的最终答案以 $\\nu_{c}$ 的单一闭式解析表达式形式给出。不需要进行数值计算，也不需要四舍五入。最终表达式中不要包含单位。",
            "solution": "该问题在科学上是合理的，它是在等离子体回旋动理学理论的既定框架内进行的。然而，为了确保结果是物理上正确的实数（能量耗散率），自由能时间导数的碰撞贡献的定义应被理解为 $\\int \\Re\\left( \\frac{h^*}{F_0} C[h] \\right) d^3\\mathbf{R}\\,d^3\\mathbf{v}$。由于洛伦兹算子是自伴的，积分 $\\int h^* C[h] d\\xi$ 是纯实数，因此我们可以直接使用 $\\int \\frac{h^*}{F_0} C[h] d^3\\mathbf{R}\\,d^3\\mathbf{v}$。\n\n**1. 自由能时间导数的碰撞贡献计算**\n\n我们从修正后的碰撞耗散率表达式开始：\n$$\n\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{h^{*}(\\mathbf{R}, v, \\xi, t)}{F_{0}(v)}\\,C[h(\\mathbf{R}, v, \\xi, t)]\n$$\n碰撞算子 $C$ 只作用于螺距角变量 $\\xi$。微扰 $h$ 被给定为 $h = \\hat{h}(v, t)\\,P_{\\ell}(\\xi)\\,\\exp(i k_{x} x)$。我们首先计算 $C$ 对 $h$ 的作用：\n$$\nC[h] = C[\\hat{h}(v, t)\\,P_{\\ell}(\\xi)\\,\\exp(i k_{x} x)] = \\hat{h}(v, t)\\,\\exp(i k_{x} x) \\cdot \\nu\\,\\frac{\\partial}{\\partial \\xi}\\left[(1-\\xi^{2})\\,\\frac{\\partial P_{\\ell}(\\xi)}{\\partial \\xi}\\right]\n$$\n勒让德多项式 $P_{\\ell}(\\xi)$ 是勒让德微分算子 $\\frac{\\partial}{\\partial \\xi}\\left[(1-\\xi^{2})\\,\\frac{\\partial}{\\partial \\xi}\\right]$ 的本征函数。它们满足勒让德微分方程：\n$$\n\\frac{d}{d\\xi}\\left[(1-\\xi^{2})\\frac{dP_{\\ell}(\\xi)}{d\\xi}\\right] + \\ell(\\ell+1)P_{\\ell}(\\xi) = 0\n$$\n由此，我们确定碰撞算子微分部分的作用：\n$$\n\\frac{\\partial}{\\partial \\xi}\\left[(1-\\xi^{2})\\,\\frac{\\partial P_{\\ell}(\\xi)}{\\partial \\xi}\\right] = -\\ell(\\ell+1)P_{\\ell}(\\xi)\n$$\n将此结果代回 $C[h]$ 的表达式中：\n$$\nC[h] = \\hat{h}(v, t)\\,\\exp(i k_{x} x) \\cdot \\nu [-\\ell(\\ell+1)P_{\\ell}(\\xi)] = -\\nu\\ell(\\ell+1)h\n$$\n指定的微扰是碰撞算子的一个本征模，其本征值为 $-\\nu\\ell(\\ell+1)$。\n\n现在，我们将这个简化的 $C[h]$ 形式代入 $\\left.\\frac{dW}{dt}\\right|_{\\text{coll}}$ 的积分中：\n$$\n\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{h^{*}}{F_{0}}\\,[-\\nu\\ell(\\ell+1)h]\n$$\n常数可以从积分中提取出来：\n$$\n\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = -\\nu\\ell(\\ell+1) \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{|h|^{2}}{F_{0}}\n$$\n我们将这个积分与自由能的定义 $W(t) = \\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{|h|^{2}}{2\\,F_{0}}$ 联系起来。根据定义，我们有 $\\int d^{3}\\mathbf{R}\\int d^{3}\\mathbf{v}\\,\\frac{|h|^{2}}{F_{0}} = 2W(t)$。代入后得到：\n$$\n\\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = -\\nu\\ell(\\ell+1) [2W(t)] = -2\\nu\\ell(\\ell+1)W(t)\n$$\n\n**2. 临界碰撞频率 $\\nu_c$ 的推导**\n\n微扰 $h$ 的线性演化方程可以写为：\n$$\n\\frac{\\partial h}{\\partial t} = \\gamma_{t} h + C[h]\n$$\n我们已经确定，对于给定的模式结构，$C[h] = -\\nu\\ell(\\ell+1)h$。代入演化方程，得到：\n$$\n\\frac{\\partial h}{\\partial t} = \\gamma_{t} h - \\nu\\ell(\\ell+1)h = \\left(\\gamma_{t} - \\nu\\ell(\\ell+1)\\right)h\n$$\n该方程的解为 $h(t) \\propto \\exp(\\gamma_{\\text{net}}t)$，其中净增长率 $\\gamma_{\\text{net}} = \\gamma_{t} - \\nu\\ell(\\ell+1)$。项 $\\gamma_{d} = \\nu\\ell(\\ell+1)$ 是有效碰撞阻尼率。\n\n当净增长率小于或等于零时，三次不稳定性增长被抑制。临界增长的情况对应于净增长率恰好为零：\n$$\n\\gamma_{\\text{net}} = \\gamma_{t} - \\gamma_{d} = 0\n$$\n这个条件在碰撞频率的一个特定临界值 $\\nu_c$ 时发生。在临界稳定性条件中设置 $\\nu = \\nu_c$：\n$$\n\\gamma_{t} - \\nu_{c}\\ell(\\ell+1) = 0\n$$\n解出临界碰撞频率 $\\nu_c$，我们得到：\n$$\n\\nu_{c} = \\frac{\\gamma_{t}}{\\ell(\\ell+1)}\n$$\n这个表达式给出了对于一个螺距角结构由 $\\ell$ 阶勒让德多项式主导的模式，要精确平衡其三次不稳定性增长率所需的碰撞频率。\n这个结果与我们关于自由能演化的发现是一致的。自由能的总时间导数是 $\\frac{dW}{dt} = \\left.\\frac{dW}{dt}\\right|_{\\text{drive}} + \\left.\\frac{dW}{dt}\\right|_{\\text{coll}} = 2\\gamma_t W - 2\\nu\\ell(\\ell+1)W = 2(\\gamma_t - \\nu\\ell(\\ell+1))W$。临界稳定性（$dW/dt = 0$）再次导出了 $\\gamma_t - \\nu_c\\ell(\\ell+1) = 0$。",
            "answer": "$$\n\\boxed{\\frac{\\gamma_t}{\\ell(\\ell+1)}}\n$$"
        },
        {
            "introduction": "前面的练习侧重于孤立的物理机制，而本练习则将这些概念——驱动、带状流调控和三次不稳定性破缺——整合到一个动态系统中。您将使用一个简化的“捕食者-猎物-资源”模型，来模拟湍流能量、带状流能量和压力梯度的耦合演化，其中三次不稳定性被建模为一种允许湍流在剪切过强时“吞噬”带状流的机制。 这项计算实践旨在弥合理论概念与可观测等离子体现象之间的鸿沟，展示这些机制的相互作用如何导致截然不同的等离子体状态，例如平静、良好约束的“静态H模”或爆发性的、周期性的“类ELM”振荡。",
            "id": "4052609",
            "problem": "您的任务是通过结合漂移波驱动、纬向流剪切和三级击穿效应，为磁约束等离子体中的宁静高约束模式 (H-模式) 和类边界局域模 (ELM) 爆发构建一个简化的无量纲边界模型，并对其进行数值积分。高约束模式 (H-模式) 和边界局域模 (ELM) 必须被视为从第一性原理构建的一组动力学方程所产生的结果。您的程序必须将提供的每个参数集分类为宁静H模式或类ELM爆发，并报告辅助指标。本问题中的所有变量和参数都是无量纲的。\n\n使用的基本出发点和物理原理：\n- 当压力梯度驱动超过耗散时，漂移波湍流能量增长。令漂移波湍流能量表示为 $E(t)$，边界压力梯度驱动表示为 $G(t)$。线性增长贡献与梯度成比例，耗散则减少能量。\n- 纬向流通过湍流的雷诺应力产生，并通过剪切抑制湍流。令纬向流能量（或均方剪切振幅）表示为 $Z(t)$。有效剪切率定义为 $\\Omega_s(t) = k_s Z(t)$，其中 $k_s$ 是纬向剪切的一个无量纲波数平方因子。\n- 三级不稳定性代表当强纬向流剪切超过一个依赖于梯度的阈值时，其分解为小尺度湍流的过程。将三级转换率建模为一个非负函数 $\\mathcal{T}(Z,G) = c_t \\max\\{0, \\Omega_s - \\kappa_t G\\}$，其中 $c_t$ 是转换系数，$\\kappa_t$ 设定了阈值对梯度的依赖性。\n- 能量和梯度根据守恒和输运演化：外部加热增加梯度驱动，而湍流和剪切输运则减少它。\n\n根据上述原理，构建以下闭合自治系统：\n1. 漂移波湍流能量方程结合了来自 $G$ 的线性增长、剪切抑制、非线性饱和以及向湍流的三级转换：\n$$\n\\frac{dE}{dt} = \\left(\\alpha G - \\mu_E\\right) E - \\beta_Z \\Omega_s E - \\nu_E E^2 + \\eta_T \\,\\mathcal{T}(Z,G),\n$$\n其中 $\\alpha$、$\\mu_E$、$\\beta_Z$ 和 $\\nu_E$ 是正常数，$\\eta_T$ 将三级转换的能量转移到 $E$ 中。\n2. 纬向流能量方程由湍流驱动，受到阻尼，并因三级击穿而耗尽：\n$$\n\\frac{dZ}{dt} = \\chi_E E - \\mu_Z Z - \\mathcal{T}(Z,G),\n$$\n其中 $\\chi_E$ 和 $\\mu_Z$ 是正常数。\n3. 梯度驱动方程包括外部输入 $P_\\text{in}$ 和湍流/剪切输运损失：\n$$\n\\frac{dG}{dt} = P_\\text{in} - \\lambda_E E G - \\lambda_Z Z G - \\mu_G G,\n$$\n其中 $P_\\text{in}$、$\\lambda_E$、$\\lambda_Z$ 和 $\\mu_G$ 是正常数。\n\n所有状态变量必须保持非负。在数值实现中，如果任何状态因数值误差而暂时变为负值，应在其所有右侧计算中使用其非负部分。从初始条件 $E(0) = 0.05$、$Z(0) = 0.10$、$G(0) = 1.00$ 开始，在无量纲时间内向前积分，直至最终时间 $T_\\text{end} = 500$。\n\n分类规则：\n- 定义宁静阈值 $E_\\text{quiet} = 0.20$ 和 $Z_\\text{quiet} = 0.40$。\n- 定义爆发阈值 $E_\\text{burst} = 0.50$。\n- 如果在采样时间内，同时满足 $E(t)  E_\\text{quiet}$ 和 $Z(t)  Z_\\text{quiet}$ 的时间点比例至少为 $0.90$，并且识别出的爆发数量为 $0$，则该情况被分类为宁静H模式。否则，它被分类为类ELM爆发。\n- 将爆发定义为 $E(t)$ 的任何超过 $E_\\text{burst}$ 的局域极大值，并且其前后紧邻的局域极小值均小于 $E_\\text{quiet}$。报告爆发的数量以及第一个爆发发生的时间（如果有）；如果没有爆发发生，则报告第一个爆发时间为 $-1.0$。\n\n数值要求：\n- 使用带有自适应步长控制的、鲁棒的常微分方程求解器。\n- 在 $[0, T_\\text{end}]$ 区间内，于 $N_s = 5000$ 个均匀间隔的时间点上对解进行采样，用于分类和爆发检测。\n\n测试套件：\n为以下五个参数集实现该模型。每个测试用例使用 $E(0) = 0.05$、$Z(0) = 0.10$、$G(0) = 1.00$、$T_\\text{end} = 500$ 和 $N_s = 5000$。参数矢量如下：\n- 用例 $\\#1$ (预期为宁静)：$\\alpha = 1.40$, $\\mu_E = 0.30$, $\\beta_Z = 0.80$, $\\nu_E = 0.20$, $\\chi_E = 1.00$, $\\mu_Z = 0.25$, $k_s = 1.00$, $c_t = 0.40$, $\\kappa_t = 1.20$, $\\eta_T = 0.60$, $\\lambda_E = 0.50$, $\\lambda_Z = 0.30$, $\\mu_G = 0.40$, $P_\\text{in} = 0.60$。\n- 用例 $\\#2$ (预期为爆发)：$\\alpha = 1.80$, $\\mu_E = 0.25$, $\\beta_Z = 0.70$, $\\nu_E = 0.18$, $\\chi_E = 0.80$, $\\mu_Z = 0.15$, $k_s = 1.20$, $c_t = 1.00$, $\\kappa_t = 0.80$, $\\eta_T = 0.80$, $\\lambda_E = 0.60$, $\\lambda_Z = 0.35$, $\\mu_G = 0.45$, $P_\\text{in} = 1.00$。\n- 用例 $\\#3$ (接近阈值)：$\\alpha = 1.60$, $\\mu_E = 0.30$, $\\beta_Z = 0.75$, $\\nu_E = 0.20$, $\\chi_E = 0.90$, $\\mu_Z = 0.20$, $k_s = 1.00$, $c_t = 0.70$, $\\kappa_t = 1.00$, $\\eta_T = 0.70$, $\\lambda_E = 0.55$, $\\lambda_Z = 0.32, \\mu_G = 0.42$, $P_\\text{in} = 0.80$。\n- 用例 $\\#4$ (无三级击穿)：$\\alpha = 1.80$, $\\mu_E = 0.25$, $\\beta_Z = 0.70$, $\\nu_E = 0.18$, $\\chi_E = 0.80$, $\\mu_Z = 0.15$, $k_s = 1.20$, $c_t = 0.00$, $\\kappa_t = 0.80$, $\\eta_T = 0.80$, $\\lambda_E = 0.60, \\lambda_Z = 0.35$, $\\mu_G = 0.45$, $P_\\text{in} = 1.00$。\n- 用例 $\\#5$ (强阻尼)：$\\alpha = 1.20$, $\\mu_E = 0.60$, $\\beta_Z = 0.85$, $\\nu_E = 0.25$, $\\chi_E = 0.90$, $\\mu_Z = 0.40$, $k_s = 1.00$, $c_t = 0.60$, $\\kappa_t = 1.00$, $\\eta_T = 0.70$, $\\lambda_E = 0.50$, $\\lambda_Z = 0.30$, $\\mu_G = 0.50$, $P_\\text{in} = 0.70$。\n\n输出规范：\n对于每个测试用例，生成一个三元列表 $[b, n, t]$，其中 $b$ 是一个布尔值，表示宁静H模式 (`True`) 或类ELM爆发 (`False`)，$n$ 是识别出的爆发的整数数量，$t$ 是第一个爆发的浮点数时间（如果没有爆发，则使用 $-1.0$）。您的程序应生成单行输出，其中包含所有五个用例的结果，格式为一个用方括号括起来的、以逗号分隔的列表，例如 $[ [\\dots], [\\dots], [\\dots], [\\dots], [\\dots] ]$。不使用角度。不使用物理单位；所有变量均为无量纲。程序必须是完全自包含的，并且不得要求任何输入。",
            "solution": "### 解题思路验证\n在提供解法之前，首先对用户提供的问题进行有效性评估。该问题是一个定义明确的计算任务，它基于一个简化的、但在物理上合理的“捕食者-猎物-资源”模型，用于模拟等离子体湍流、带状流和压力梯度之间的动力学。模型包含了驱动、耗散、非线性相互作用和三次不稳定性等关键物理过程。\n\n- **科学依据**：该模型是等离子体输运和湍流调控研究中常用的简化模型（0D模型），能够定性地再现静态高约束（H模）和周期性爆发（类ELM）等复杂的非线性现象。问题中给出的方程组和参数设置是该领域研究的合理表述。\n- **问题设定**：问题给出了一个完整的常微分方程（ODE）初值问题，包括所有方程、参数、初始条件和积分区间。分类和爆发检测的规则清晰、客观、无歧义。\n- **可行性**：该问题可以通过标准的数值ODE求解器在合理时间内解决。\n\n**结论**：问题是**有效的**。将构建一个Python程序来求解。\n\n### 解题设计\n解决方案包含两个主要阶段：对提供的ODE系统进行数值积分，以及随后对得到的时间序列数据进行分析以对系统行为进行分类。\n\n**1. ODE系统的数值积分**\n问题的核心是求解由三个耦合的非线性常微分方程定义的初值问题，状态向量为 $\\vec{y}(t) = [E(t), Z(t), G(t)]^T$。系统形式为 $\\frac{d\\vec{y}}{dt} = \\vec{f}(t, \\vec{y}, \\vec{p})$，其中 $\\vec{p}$ 是模型参数向量。\n\n函数 $\\vec{f}$ 的实现如下：\n首先，根据物理约束，在计算微分方程右侧的每一步，都强制状态变量为非负值：$E = \\max(0, y_0)$，$Z = \\max(0, y_1)$，$G = \\max(0, y_2)$。\n接着，计算中间量：\n- 有效剪切率：$\\Omega_s = k_s Z$。\n- 三次转换率：$\\mathcal{T}(Z,G) = c_t \\max\\{0, \\Omega_s - \\kappa_t G\\}$。\n最后，使用这些量和系统参数计算时间导数：\n- $\\frac{dE}{dt} = (\\alpha G - \\mu_E) E - \\beta_Z \\Omega_s E - \\nu_E E^2 + \\eta_T \\mathcal{T}$\n- $\\frac{dZ}{dt} = \\chi_E E - \\mu_Z Z - \\mathcal{T}$\n- $\\frac{dG}{dt} = P_\\text{in} - \\lambda_E E G - \\lambda_Z Z G - \\mu_G G$\n\n该系统将使用一个鲁棒的自适应步长ODE求解器进行积分。Python的SciPy库中的 `scipy.integrate.solve_ivp` 函数非常适合此任务。我们将从 $t=0$ 积分到 $T_\\text{end}=500$，初始条件为 $E(0)=0.05$, $Z(0)=0.10$, $G(0)=1.00$。为了便于分析，我们将指示求解器在积分区间内的 $N_s=5000$ 个均匀间隔的时间点上输出解。\n\n**2. 解的时间序列分析**\n在获得 $E(t)$, $Z(t)$ 和 $G(t)$ 的离散时间序列后，我们按照规定执行分析。\n\n**a. 爆发检测**\n爆发是在湍流能量 $E(t)$ 中的一种特定的大振幅事件。为了识别爆发，我们首先需要找到 $E(t)$ 时间序列中的所有局部极大值和极小值。这可以通过寻找离散导数改变符号的点来高效完成。\n\n找到极大值和极小值列表后，我们按以下步骤验证每个潜在的爆发：\n1.  识别所有能量 $E(t_i)$ 超过爆发阈值 $E_\\text{burst} = 0.50$ 的局部极大值。\n2.  对于每个这样的极大值，找到其最近的前一个局部极小值和最近的后一个局部极小值。\n3.  如果前、后两个极小值都低于宁静能量阈值 $E_\\text{min}  E_\\text{quiet} = 0.20$，则确认该极大值为一次有效爆发。\n4.  爆发次数 $n$ 是此类有效事件的总数。第一个爆发的时间 $t$ 是第一个有效极大值对应的时间。如果没有找到爆发，则 $n=0$ 且 $t=-1.0$。\n\n**b. 动力学分类**\n对于给定的参数集，系统行为被分为“宁静H模式”或“类ELM爆发”。\n1.  在给定时间 $t$ 的宁静状态定义为同时满足条件 $E(t)  E_\\text{quiet} = 0.20$ 和 $Z(t)  Z_\\text{quiet} = 0.40$。\n2.  我们计算满足此宁静条件的采样时间点占总采样点 $N_s=5000$ 的比例。\n3.  如果该比例至少为 $0.90$ 并且爆发次数 $n$ 恰好为 $0$，则该情况被分类为宁静H模式 ($b=\\text{True}$)。\n4.  否则，该情况被分类为类ELM爆发 ($b=\\text{False}$)。\n\n从积分到分析的整个过程将对测试套件中的五个参数集分别重复。最终输出是每个案例的 $[b, n, t]$ 三元组的集合，并按指定格式输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef model_rhs(t, y, params):\n    \"\"\"\n    Computes the right-hand side of the ODE system for the reduced plasma edge model.\n    y: state vector [E, Z, G]\n    params: dictionary of model parameters\n    \"\"\"\n    # Enforce non-negativity of state variables\n    E, Z, G = np.maximum(0, y)\n\n    # Unpack parameters\n    alpha = params['alpha']\n    mu_E = params['mu_E']\n    beta_Z = params['beta_Z']\n    nu_E = params['nu_E']\n    chi_E = params['chi_E']\n    mu_Z = params['mu_Z']\n    k_s = params['k_s']\n    c_t = params['c_t']\n    kappa_t = params['kappa_t']\n    eta_T = params['eta_T']\n    lambda_E = params['lambda_E']\n    lambda_Z = params['lambda_Z']\n    mu_G = params['mu_G']\n    P_in = params['P_in']\n\n    # Intermediate quantities\n    Omega_s = k_s * Z\n    T_val = c_t * max(0, Omega_s - kappa_t * G)\n\n    # ODEs\n    dE_dt = (alpha * G - mu_E) * E - beta_Z * Omega_s * E - nu_E * E**2 + eta_T * T_val\n    dZ_dt = chi_E * E - mu_Z * Z - T_val\n    dG_dt = P_in - lambda_E * E * G - lambda_Z * Z * G - mu_G * G\n\n    return [dE_dt, dZ_dt, dG_dt]\n\ndef analyze_solution(t_eval, solution, thresholds):\n    \"\"\"Analyzes the ODE solution to classify dynamics and detect bursts.\"\"\"\n    E_t, Z_t, G_t = solution\n\n    E_quiet = thresholds['E_quiet']\n    Z_quiet = thresholds['Z_quiet']\n    E_burst = thresholds['E_burst']\n\n    # --- Burst Detection ---\n    # Find local maxima and minima indices\n    maxima_indices = np.where((E_t[1:-1] > E_t[:-2])  (E_t[1:-1] > E_t[2:]))[0] + 1\n    minima_indices = np.where((E_t[1:-1]  E_t[:-2])  (E_t[1:-1]  E_t[2:]))[0] + 1\n\n    potential_burst_indices = [idx for idx in maxima_indices if E_t[idx] > E_burst]\n    \n    burst_times = []\n    if minima_indices.size > 0:\n        for p_idx in potential_burst_indices:\n            preceding_mins = minima_indices[minima_indices  p_idx]\n            following_mins = minima_indices[minima_indices > p_idx]\n\n            if preceding_mins.size > 0 and following_mins.size > 0:\n                closest_prev_min_idx = preceding_mins[-1]\n                closest_fol_min_idx = following_mins[0]\n\n                if E_t[closest_prev_min_idx]  E_quiet and E_t[closest_fol_min_idx]  E_quiet:\n                    burst_times.append(t_eval[p_idx])\n\n    num_bursts = len(burst_times)\n    first_burst_time = burst_times[0] if num_bursts > 0 else -1.0\n\n    # --- Classification ---\n    is_quiescent_sample = (E_t  E_quiet)  (Z_t > Z_quiet)\n    quiescent_fraction = np.sum(is_quiescent_sample) / len(t_eval)\n\n    is_quiescent_mode = (quiescent_fraction >= 0.90) and (num_bursts == 0)\n\n    return [is_quiescent_mode, num_bursts, first_burst_time]\n\n\ndef solve():\n    \"\"\"\n    Main function to run simulations for all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'alpha': 1.40, 'mu_E': 0.30, 'beta_Z': 0.80, 'nu_E': 0.20, 'chi_E': 1.00, 'mu_Z': 0.25, 'k_s': 1.00, 'c_t': 0.40, 'kappa_t': 1.20, 'eta_T': 0.60, 'lambda_E': 0.50, 'lambda_Z': 0.30, 'mu_G': 0.40, 'P_in': 0.60},\n        {'alpha': 1.80, 'mu_E': 0.25, 'beta_Z': 0.70, 'nu_E': 0.18, 'chi_E': 0.80, 'mu_Z': 0.15, 'k_s': 1.20, 'c_t': 1.00, 'kappa_t': 0.80, 'eta_T': 0.80, 'lambda_E': 0.60, 'lambda_Z': 0.35, 'mu_G': 0.45, 'P_in': 1.00},\n        {'alpha': 1.60, 'mu_E': 0.30, 'beta_Z': 0.75, 'nu_E': 0.20, 'chi_E': 0.90, 'mu_Z': 0.20, 'k_s': 1.00, 'c_t': 0.70, 'kappa_t': 1.00, 'eta_T': 0.70, 'lambda_E': 0.55, 'lambda_Z': 0.32, 'mu_G': 0.42, 'P_in': 0.80},\n        {'alpha': 1.80, 'mu_E': 0.25, 'beta_Z': 0.70, 'nu_E': 0.18, 'chi_E': 0.80, 'mu_Z': 0.15, 'k_s': 1.20, 'c_t': 0.00, 'kappa_t': 0.80, 'eta_T': 0.80, 'lambda_E': 0.60, 'lambda_Z': 0.35, 'mu_G': 0.45, 'P_in': 1.00},\n        {'alpha': 1.20, 'mu_E': 0.60, 'beta_Z': 0.85, 'nu_E': 0.25, 'chi_E': 0.90, 'mu_Z': 0.40, 'k_s': 1.00, 'c_t': 0.60, 'kappa_t': 1.00, 'eta_T': 0.70, 'lambda_E': 0.50, 'lambda_Z': 0.30, 'mu_G': 0.50, 'P_in': 0.70}\n    ]\n\n    # Shared simulation parameters\n    y0 = [0.05, 0.10, 1.00]\n    T_end = 500\n    N_s = 5000\n    t_span = [0, T_end]\n    t_eval = np.linspace(t_span[0], t_span[1], N_s)\n\n    thresholds = {\n        'E_quiet': 0.20,\n        'Z_quiet': 0.40,\n        'E_burst': 0.50\n    }\n\n    results = []\n    for params in test_cases:\n        sol = solve_ivp(\n            model_rhs,\n            t_span,\n            y0,\n            args=(params,),\n            method='RK45',\n            t_eval=t_eval,\n            dense_output=True\n        )\n        \n        analysis_result = analyze_solution(sol.t, sol.y, thresholds)\n        results.append(analysis_result)\n\n    # Format output as a string representation of a list of lists.\n    # str([True, 0, -1.0]) -> '[True, 0, -1.0]'\n    formatted_results = [str(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}