{
    "hands_on_practices": [
        {
            "introduction": "To build intuition for the magnitude of turbulent transport, physicists often turn to simplified models. A cornerstone of this approach is the mixing-length estimate, which approximates the turbulent heat flux based on the instability's linear growth rate and characteristic scale. This exercise provides practice in applying this fundamental concept, while also incorporating the critical real-world effect of transport suppression by $E \\times B$ velocity shear, demonstrating how to quantify the balance between turbulent drive and shear-flow regulation. ",
            "id": "3960495",
            "problem": "A magnetically confined toroidal plasma exhibits core-driven Ion Temperature Gradient (ITG) turbulence that couples to the edge through finite radial correlation, while edge ExB shear generated by a radial electric field suppresses turbulent transport. Consider a near-edge region where the ion density is $n_i = 4.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, the ion temperature is $T_i = 1.5\\,\\mathrm{keV}$, the characteristic perpendicular wavenumber of the dominant ITG fluctuations is $k_\\perp = 200\\,\\mathrm{m}^{-1}$, the linear instability growth rate is $\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^{5}\\,\\mathrm{s}^{-1}$, and the ExB shearing rate is $\\gamma_E = 3.0 \\times 10^{5}\\,\\mathrm{s}^{-1}$. The equilibrium ion temperature gradient scale length is $L_T = 5.0 \\times 10^{-2}\\,\\mathrm{m}$. \n\nStarting from the random-walk mixing-length picture in which the thermal diffusivity scales like $\\chi \\sim \\ell^2/\\tau$ with $\\ell \\sim 1/k_\\perp$ and decorrelation timescale set by the linear drive, and using the quasilinear heat flux form $Q_i \\sim n_i \\chi |\\nabla T_i|$, model the shear suppression of turbulence by taking the fluctuation amplitude to be reduced according to a quench rule based on the ratio of the ExB shearing rate to the linear growth rate. Specifically, adopt a multiplicative suppression factor\n$$\nS(\\gamma_E,\\gamma_{\\mathrm{lin}}) = \\left(\\frac{\\gamma_{\\mathrm{lin}}}{\\gamma_{\\mathrm{lin}} + \\gamma_E}\\right)^{2},\n$$\nso that the saturated ion heat flux is \n$$\nQ_i \\sim n_i\\,\\chi\\,\\left|\\nabla T_i\\right|\\,S(\\gamma_E,\\gamma_{\\mathrm{lin}}),\n$$\nwith $\\chi \\sim \\gamma_{\\mathrm{lin}}/k_\\perp^2$ and $\\left|\\nabla T_i\\right| \\sim T_i/L_T$.\n\nCompute the saturated ion heat flux $Q_i$ using the above modeling assumptions. Convert $T_i$ from $\\mathrm{keV}$ to $\\mathrm{J}$ using $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$ with $e$ the elementary charge. Express the final heat flux in $\\mathrm{W}/\\mathrm{m}^2$ and round your answer to four significant figures.",
            "solution": "The user-provided problem is first subjected to a rigorous validation procedure.\n\n### Step 1: Extract Givens\n-   Ion density: $n_i = 4.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$\n-   Ion temperature: $T_i = 1.5\\,\\mathrm{keV}$\n-   Perpendicular wavenumber: $k_\\perp = 200\\,\\mathrm{m}^{-1}$\n-   Linear instability growth rate: $\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^{5}\\,\\mathrm{s}^{-1}$\n-   ExB shearing rate: $\\gamma_E = 3.0 \\times 10^{5}\\,\\mathrm{s}^{-1}$\n-   Equilibrium ion temperature gradient scale length: $L_T = 5.0 \\times 10^{-2}\\,\\mathrm{m}$\n-   Energy conversion: $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$\n-   Suppression factor model: $S(\\gamma_E,\\gamma_{\\mathrm{lin}}) = \\left(\\frac{\\gamma_{\\mathrm{lin}}}{\\gamma_{\\mathrm{lin}} + \\gamma_E}\\right)^{2}$\n-   Heat flux model: $Q_i \\sim n_i\\,\\chi\\,\\left|\\nabla T_i\\right|\\,S(\\gamma_E,\\gamma_{\\mathrm{lin}})$\n-   Thermal diffusivity model: $\\chi \\sim \\gamma_{\\mathrm{lin}}/k_\\perp^2$\n-   Temperature gradient model: $\\left|\\nabla T_i\\right| \\sim T_i/L_T$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n-   **Scientifically Grounded**: The problem describes a simplified but standard model of turbulent transport in a magnetized plasma, specifically addressing Ion Temperature Gradient (ITG) turbulence and its suppression by $E \\times B$ velocity shear. The mixing-length estimate for diffusivity, the quasilinear form of the heat flux, and the quench rule for shear suppression are all established concepts in plasma physics and computational fusion science. The physical parameters provided are realistic for the edge region of a tokamak.\n-   **Well-Posed**: The problem is fully specified. It provides all necessary physical quantities and explicit mathematical models required to calculate a unique numerical result.\n-   **Objective**: The problem is stated using precise, objective scientific language, free of ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a well-posed, scientifically grounded physics problem. A solution will be derived.\n\nThe task is to compute the saturated ion heat flux, $Q_i$, based on the provided scaling-based models. The problem statement uses the proportionality symbol '$\\sim$', which is standard in mixing-length estimations. To obtain a numerical value, we treat these as equalities by assuming that any dimensionless proportionality constants are of order unity and can be set to $1$.\n\nThe expression for the ion heat flux is given as:\n$$\nQ_i = n_i\\,\\chi\\,\\left|\\nabla T_i\\right|\\,S(\\gamma_E,\\gamma_{\\mathrm{lin}})\n$$\nWe substitute the provided models for the thermal diffusivity $\\chi$, the temperature gradient magnitude $|\\nabla T_i|$, and the suppression factor $S$:\n$$\nQ_i = n_i \\left( \\frac{\\gamma_{\\mathrm{lin}}}{k_\\perp^2} \\right) \\left( \\frac{T_i}{L_T} \\right) \\left( \\frac{\\gamma_{\\mathrm{lin}}}{\\gamma_{\\mathrm{lin}} + \\gamma_E} \\right)^2\n$$\nTo calculate the heat flux in SI units of $\\mathrm{W}/\\mathrm{m}^2$ (or $\\mathrm{J}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-2}$), the ion temperature $T_i$ must be converted from kilo-electron-volts ($\\mathrm{keV}$) to Joules ($\\mathrm{J}$). The conversion is $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$, where $e$ is the elementary charge. The problem does not specify the value of $e$, so the standard CODATA value will be used: $e \\approx 1.602176634 \\times 10^{-19}\\,\\mathrm{J}/\\mathrm{eV}$.\nThe temperature in Joules is:\n$$\nT_i\\,[\\mathrm{J}] = (1.5\\,\\mathrm{keV}) \\times \\frac{1000\\,\\mathrm{eV}}{1\\,\\mathrm{keV}} \\times (e\\,\\mathrm{J}/\\mathrm{eV}) = 1.5 \\times 10^3 \\times e\\,\\mathrm{J}\n$$\nNow, we can substitute all the given numerical values into the expression for $Q_i$:\n-   $n_i = 4.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$\n-   $\\gamma_{\\mathrm{lin}} = 1.0 \\times 10^{5}\\,\\mathrm{s}^{-1}$\n-   $k_\\perp = 200\\,\\mathrm{m}^{-1}$\n-   $T_i = 1.5 \\times 10^3 \\times (1.602176634 \\times 10^{-19})\\,\\mathrm{J}$\n-   $L_T = 5.0 \\times 10^{-2}\\,\\mathrm{m}$\n-   $\\gamma_E = 3.0 \\times 10^{5}\\,\\mathrm{s}^{-1}$\n\nLet's evaluate each component separately.\nThe thermal diffusivity $\\chi$ is:\n$$\n\\chi = \\frac{\\gamma_{\\mathrm{lin}}}{k_\\perp^2} = \\frac{1.0 \\times 10^5\\,\\mathrm{s}^{-1}}{(200\\,\\mathrm{m}^{-1})^2} = \\frac{1.0 \\times 10^5}{4.0 \\times 10^4}\\,\\mathrm{m}^2/\\mathrm{s} = 2.5\\,\\mathrm{m}^2/\\mathrm{s}\n$$\nThe temperature in Joules is:\n$$\nT_i = 1.5 \\times 10^3 \\times 1.602176634 \\times 10^{-19}\\,\\mathrm{J} \\approx 2.403265 \\times 10^{-16}\\,\\mathrm{J}\n$$\nThe temperature gradient magnitude is:\n$$\n|\\nabla T_i| = \\frac{T_i}{L_T} = \\frac{2.403265 \\times 10^{-16}\\,\\mathrm{J}}{5.0 \\times 10^{-2}\\,\\mathrm{m}} \\approx 4.80653 \\times 10^{-15}\\,\\mathrm{J}/\\mathrm{m}\n$$\nThe suppression factor $S$ is:\n$$\nS = \\left( \\frac{\\gamma_{\\mathrm{lin}}}{\\gamma_{\\mathrm{lin}} + \\gamma_E} \\right)^2 = \\left( \\frac{1.0 \\times 10^5\\,\\mathrm{s}^{-1}}{1.0 \\times 10^5\\,\\mathrm{s}^{-1} + 3.0 \\times 10^5\\,\\mathrm{s}^{-1}} \\right)^2 = \\left( \\frac{1.0 \\times 10^5}{4.0 \\times 10^5} \\right)^2 = \\left(\\frac{1}{4}\\right)^2 = \\frac{1}{16} = 0.0625\n$$\nNow, we assemble these components to calculate $Q_i$:\n$$\nQ_i = n_i \\times \\chi \\times |\\nabla T_i| \\times S\n$$\n$$\nQ_i = (4.0 \\times 10^{19}\\,\\mathrm{m}^{-3}) \\times (2.5\\,\\mathrm{m}^2/\\mathrm{s}) \\times (4.80653 \\times 10^{-15}\\,\\mathrm{J}/\\mathrm{m}) \\times (0.0625)\n$$\n$$\nQ_i = (1.0 \\times 10^{20}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-1}) \\times (4.80653 \\times 10^{-15}\\,\\mathrm{J}/\\mathrm{m}) \\times (0.0625)\n$$\n$$\nQ_i = (4.80653 \\times 10^{5}\\,\\mathrm{J}\\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-2}) \\times (0.0625)\n$$\n$$\nQ_i \\approx 30040.81\\,\\mathrm{W}/\\mathrm{m}^2\n$$\nIn scientific notation, this is $Q_i \\approx 3.004081 \\times 10^4\\,\\mathrm{W}/\\mathrm{m}^2$.\nThe problem requires the answer to be rounded to four significant figures.\n$$\nQ_i \\approx 3.004 \\times 10^4\\,\\mathrm{W}/\\mathrm{m}^2\n$$",
            "answer": "$$\n\\boxed{3.004 \\times 10^{4}}\n$$"
        },
        {
            "introduction": "While mixing-length models estimate the level of transport, they do not explain its fundamental origin. Turbulent particle and heat fluxes arise from the precise temporal and spatial correlations between fluctuating quantities, such as density and electric potential. This exercise delves into this microscopic mechanism, requiring you to derive the expression for particle flux and demonstrate how it is exquisitely sensitive to the cross-phase angle between these fluctuations, a key parameter targeted by zonal flow shear. ",
            "id": "3960491",
            "problem": "In a magnetically confined plasma at the edge of a tokamak, assume poloidal coordinate $y$ and a homogeneous background magnetic field of magnitude $B$. Turbulent drift-wave fluctuations of the electrostatic potential $\\tilde{\\phi}(y,t)$ and density $\\tilde{n}(y,t)$ are represented by a finite set of poloidal Fourier modes with wavenumbers $k_{y}$, complex mode amplitudes $\\tilde{\\phi}_{k}(t)$ and $\\tilde{n}_{k}(t)$, and cross-phase angles $\\theta_{k}$ defined by the argument of the cross-correlation $\\langle \\tilde{n}_{k} \\tilde{\\phi}_{k}^{*} \\rangle$. The radial $E \\times B$ (Electric field cross magnetic field) drift velocity is given, in the International System of Units, by $v_{r} = E_{y}/B$ with $E_{y} = -\\partial_{y}\\phi$. The time-averaged radial particle flux is defined by $\\Gamma = \\langle \\tilde{n} \\tilde{v}_{r} \\rangle$, where $\\langle \\cdot \\rangle$ denotes a combined time and poloidal average.\n\nConsider three dominant poloidal modes in the edge region with the following properties at a given time:\n- Magnetic field magnitude $B = 2.5\\,\\mathrm{T}$.\n- Mode $k=1$: $k_{y,1} = 400\\,\\mathrm{m}^{-1}$, $|\\tilde{n}_{1}| = 3.0 \\times 10^{16}\\,\\mathrm{m}^{-3}$, $|\\tilde{\\phi}_{1}| = 1.8\\,\\mathrm{V}$, initial cross-phase angle $\\theta_{1} = 35^{\\circ}$.\n- Mode $k=2$: $k_{y,2} = 750\\,\\mathrm{m}^{-1}$, $|\\tilde{n}_{2}| = 2.0 \\times 10^{16}\\,\\mathrm{m}^{-3}$, $|\\tilde{\\phi}_{2}| = 2.5\\,\\mathrm{V}$, initial cross-phase angle $\\theta_{2} = 20^{\\circ}$.\n- Mode $k=3$: $k_{y,3} = 1100\\,\\mathrm{m}^{-1}$, $|\\tilde{n}_{3}| = 1.5 \\times 10^{16}\\,\\mathrm{m}^{-3}$, $|\\tilde{\\phi}_{3}| = 1.2\\,\\mathrm{V}$, initial cross-phase angle $\\theta_{3} = 50^{\\circ}$.\n\nSuppose a zonal flow, generated predominantly in the core, couples to the edge and imposes a uniform poloidal shear that rotates the cross-phase of each mode by the same amount $\\Delta \\theta = -15^{\\circ}$, without changing $B$, the wavenumbers $k_{y}$, or the mode amplitudes $|\\tilde{n}_{k}|$ and $|\\tilde{\\phi}_{k}|$. Starting from the definition of $v_{r}$, the Fourier representation in $y$, and the definition of $\\Gamma$, derive the multi-mode expression for the time-averaged radial particle flux in terms of the cross-phase angles. Using that expression, compute the reduction factor\n$$R \\equiv \\frac{\\Gamma_{\\mathrm{sheared}}}{\\Gamma_{\\mathrm{unsheared}}},$$\ncaused by the cross-phase rotation $\\Delta \\theta$. Treat all angles in degrees. Express your final answer for $R$ as a dimensionless number and round your answer to four significant figures.",
            "solution": "The user wants me to solve a plasma physics problem.\n\n**1. Problem Validation**\n\n*   **Step 1: Extract Givens**\n    *   `poloidal coordinate`: $y$\n    *   `homogeneous background magnetic field`: magnitude $B$\n    *   `electrostatic potential fluctuations`: $\\tilde{\\phi}(y,t)$\n    *   `density fluctuations`: $\\tilde{n}(y,t)$\n    *   `Fourier modes`: wavenumbers $k_y$, complex mode amplitudes $\\tilde{\\phi}_k(t)$, $\\tilde{n}_k(t)$\n    *   `cross-phase angles`: $\\theta_k = \\arg(\\langle \\tilde{n}_{k} \\tilde{\\phi}_{k}^{*} \\rangle)$\n    *   `radial E x B drift velocity`: $v_{r} = E_{y}/B$\n    *   `poloidal electric field`: $E_{y} = -\\partial_{y}\\phi$\n    *   `time-averaged radial particle flux`: $\\Gamma = \\langle \\tilde{n} \\tilde{v}_{r} \\rangle$\n    *   `average operator`: $\\langle \\cdot \\rangle$ denotes a combined time and poloidal average\n    *   `Magnetic field`: $B = 2.5\\,\\mathrm{T}$\n    *   `Mode k=1`: $k_{y,1} = 400\\,\\mathrm{m}^{-1}$, $|\\tilde{n}_{1}| = 3.0 \\times 10^{16}\\,\\mathrm{m}^{-3}$, $|\\tilde{\\phi}_{1}| = 1.8\\,\\mathrm{V}$, $\\theta_{1} = 35^{\\circ}$\n    *   `Mode k=2`: $k_{y,2} = 750\\,\\mathrm{m}^{-1}$, $|\\tilde{n}_{2}| = 2.0 \\times 10^{16}\\,\\mathrm{m}^{-3}$, $|\\tilde{\\phi}_{2}| = 2.5\\,\\mathrm{V}$, $\\theta_{2} = 20^{\\circ}$\n    *   `Mode k=3`: $k_{y,3} = 1100\\,\\mathrm{m}^{-1}$, $|\\tilde{n}_{3}| = 1.5 \\times 10^{16}\\,\\mathrm{m}^{-3}$, $|\\tilde{\\phi}_{3}| = 1.2\\,\\mathrm{V}$, $\\theta_{3} = 50^{\\circ}$\n    *   `cross-phase rotation`: $\\Delta \\theta = -15^{\\circ}$\n    *   `invariants`: $B$, $k_y$, $|\\tilde{n}_k|$, $|\\tilde{\\phi}_k|$\n    *   `target quantity`: reduction factor $R \\equiv \\frac{\\Gamma_{\\mathrm{sheared}}}{\\Gamma_{\\mathrm{unsheared}}}$\n    *   `rounding`: four significant figures\n\n*   **Step 2: Validate Using Extracted Givens**\n    *   **Scientifically Grounded**: The problem describes turbulent particle transport via $E \\times B$ drift in a magnetized plasma, a fundamental concept in fusion science. The equations and definitions are standard. The mechanism of transport reduction by zonal-flow-induced shear of the turbulence cross-phase is a well-established and critical topic in turbulence theory. The numerical values are physically plausible for a tokamak edge plasma. The problem is scientifically sound.\n    *   **Well-Posed**: All necessary data and conditions for calculating the initial and final particle fluxes are provided. The problem leads to a unique, stable solution.\n    *   **Objective**: The problem is stated in precise, quantitative, and unbiased scientific language.\n    *   No other flaws from the checklist are present. The problem is self-contained, consistent, and requires a non-trivial derivation and calculation based on core physics principles.\n\n*   **Step 3: Verdict and Action**\n    *   The problem is **valid**. I will proceed with the solution.\n\n**2. Solution Derivation**\n\nThe primary task is to derive an expression for the time-averaged radial particle flux $\\Gamma$ and then use it to compute the reduction factor $R$.\n\nThe radial particle flux is defined as the spatio-temporal average of the product of the density fluctuation $\\tilde{n}$ and the radial velocity fluctuation $\\tilde{v}_{r}$.\n$$\n\\Gamma = \\langle \\tilde{n} \\tilde{v}_{r} \\rangle\n$$\nThe radial velocity is the $E \\times B$ drift, given by $v_{r} = E_{y}/B$. The poloidal electric field fluctuation is the negative gradient of the electrostatic potential fluctuation, $E_{y} = -\\partial_{y}\\tilde{\\phi}$. Substituting these into the definition of $\\Gamma$:\n$$\n\\Gamma = \\left\\langle \\tilde{n} \\left( -\\frac{1}{B} \\frac{\\partial \\tilde{\\phi}}{\\partial y} \\right) \\right\\rangle = -\\frac{1}{B} \\left\\langle \\tilde{n} \\frac{\\partial \\tilde{\\phi}}{\\partial y} \\right\\rangle\n$$\nThe fluctuating quantities $\\tilde{n}(y,t)$ and $\\tilde{\\phi}(y,t)$ are real-valued physical fields. They can be represented by a Fourier series over the poloidal coordinate $y$. We use the complex exponential form, summing over all integer mode numbers $k$ (positive, negative, and zero), where $k$ corresponds to a poloidal wavenumber $k_y$.\n$$\n\\tilde{n}(y,t) = \\sum_{k} \\tilde{n}_{k}(t) e^{i k_y y}\n$$\n$$\n\\tilde{\\phi}(y,t) = \\sum_{j} \\tilde{\\phi}_{j}(t) e^{i k_{y,j} y}\n$$\nFor these fields to be real, the complex Fourier amplitudes must satisfy the reality condition $\\tilde{n}_{-k} = \\tilde{n}_{k}^{*}$ and $\\tilde{\\phi}_{-k} = \\tilde{\\phi}_{k}^{*}$, where the star denotes complex conjugation. The derivative of the potential is:\n$$\n\\frac{\\partial \\tilde{\\phi}}{\\partial y} = \\sum_{j} i k_{y,j} \\tilde{\\phi}_{j}(t) e^{i k_{y,j} y}\n$$\nNow we form the product $\\tilde{n} \\frac{\\partial \\tilde{\\phi}}{\\partial y}$:\n$$\n\\tilde{n} \\frac{\\partial \\tilde{\\phi}}{\\partial y} = \\left( \\sum_{k} \\tilde{n}_{k} e^{i k_y y} \\right) \\left( \\sum_{j} i k_{y,j} \\tilde{\\phi}_{j} e^{i k_{y,j} y} \\right) = \\sum_{k,j} i k_{y,j} \\tilde{n}_{k} \\tilde{\\phi}_{j} e^{i(k_y + k_{y,j})y}\n$$\nThe averaging operator $\\langle \\cdot \\rangle$ includes an average over the poloidal direction $y$. The spatial average of $e^{i(k_y + k_{y,j})y}$ is zero unless the exponent is zero, which requires $k_{y,j} = -k_y$, or $j=-k$. Applying this condition to the double summation reduces it to a single sum:\n$$\n\\left\\langle \\tilde{n} \\frac{\\partial \\tilde{\\phi}}{\\partial y} \\right\\rangle_{y} = \\sum_{k} i k_{y,-k} \\tilde{n}_{k} \\tilde{\\phi}_{-k}\n$$\nSince $k_{y,-k} = -k_{y,k}$ and using the reality condition $\\tilde{\\phi}_{-k} = \\tilde{\\phi}_{k}^{*}$, we get:\n$$\n\\left\\langle \\tilde{n} \\frac{\\partial \\tilde{\\phi}}{\\partial y} \\right\\rangle_{y} = \\sum_{k} i (-k_{y,k}) \\tilde{n}_{k} \\tilde{\\phi}_{k}^{*} = -i \\sum_{k} k_{y,k} \\tilde{n}_{k} \\tilde{\\phi}_{k}^{*}\n$$\nThis quantity is still a function of time. The full flux $\\Gamma$ requires a time average of this expression. The flux, being a physical quantity, must be real. Therefore, we take the real part.\n$$\n\\Gamma = -\\frac{1}{B} \\text{Re} \\left\\langle -i \\sum_{k} k_{y,k} \\tilde{n}_{k}(t) \\tilde{\\phi}_{k}^{*}(t) \\right\\rangle_t = \\frac{1}{B} \\text{Re} \\left( i \\sum_{k} k_{y,k} \\langle \\tilde{n}_{k} \\tilde{\\phi}_{k}^{*} \\rangle_t \\right)\n$$\nThe problem defines the cross-phase angle $\\theta_k$ as the argument of the time-averaged cross-correlation, $\\theta_k = \\arg(\\langle \\tilde{n}_{k} \\tilde{\\phi}_{k}^{*} \\rangle_t)$. We can thus write this correlation in polar form. We also approximate the magnitude of the correlation by the product of the time-averaged mode amplitudes, $|\\langle \\tilde{n}_{k} \\tilde{\\phi}_{k}^{*} \\rangle_t| \\approx |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}|$.\n$$\n\\langle \\tilde{n}_{k} \\tilde{\\phi}_{k}^{*} \\rangle_t = |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| e^{i\\theta_k} = |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| (\\cos\\theta_k + i\\sin\\theta_k)\n$$\nSubstituting this into the expression for $\\Gamma$:\n$$\n\\Gamma = \\frac{1}{B} \\text{Re} \\left( i \\sum_{k} k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| (\\cos\\theta_k + i\\sin\\theta_k) \\right)\n$$\n$$\n\\Gamma = \\frac{1}{B} \\text{Re} \\left( \\sum_{k} k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| (i\\cos\\theta_k - \\sin\\theta_k) \\right)\n$$\nTaking the real part leaves only the term with $\\sin\\theta_k$:\n$$\n\\Gamma = -\\frac{1}{B} \\sum_{k} k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin\\theta_k\n$$\nThis summation is over all modes $k$. Given that the problem provides data for modes with positive wavenumbers $k_{y,k} > 0$, we must account for their counterparts at $-k_y$. Let's split the sum into $k>0$ and $k0$ (the $k=0$ mean-field term has $k_y=0$ and does not contribute to the flux).\nFor a mode $k>0$, its counterpart is $-k$. The wavenumber is $k_{y,-k} = -k_{y,k}$. The cross-phase is $\\theta_{-k} = \\arg(\\langle \\tilde{n}_{-k} \\tilde{\\phi}_{-k}^{*} \\rangle_t) = \\arg(\\langle \\tilde{n}_{k}^{*} \\tilde{\\phi}_{k} \\rangle_t) = \\arg((\\langle \\tilde{n}_{k} \\tilde{\\phi}_{k}^{*} \\rangle_t)^*) = -\\theta_k$. The amplitudes are $| \\tilde{n}_{-k} | = | \\tilde{n}_{k}^{*} | = | \\tilde{n}_{k} |$ and likewise for $\\phi$.\nThe contribution from the pair $(k, -k)$ to the sum is:\n$$\nk_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin\\theta_k + k_{y,-k} |\\tilde{n}_{-k}| |\\tilde{\\phi}_{-k}| \\sin\\theta_{-k}\n$$\n$$\n= k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin\\theta_k + (-k_{y,k}) |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin(-\\theta_k)\n$$\n$$\n= k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin\\theta_k + k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin\\theta_k = 2 k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin\\theta_k\n$$\nTherefore, summing over only the given modes (which we take as the $k>0$ modes), the total flux is:\n$$\n\\Gamma = -\\frac{2}{B} \\sum_{k=1}^{3} k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin\\theta_k\n$$\nThis is the required multi-mode expression for the radial particle flux.\n\nThe reduction factor $R$ is the ratio of the flux with sheared phases to the flux with unsheared phases. Let $\\Gamma_{\\mathrm{unsheared}}$ be the flux with initial angles $\\theta_k$, and $\\Gamma_{\\mathrm{sheared}}$ be the flux with new angles $\\theta'_k = \\theta_k + \\Delta\\theta$.\n$$\nR = \\frac{\\Gamma_{\\mathrm{sheared}}}{\\Gamma_{\\mathrm{unsheared}}} = \\frac{-\\frac{2}{B} \\sum_{k=1}^{3} k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin(\\theta'_k)}{-\\frac{2}{B} \\sum_{k=1}^{3} k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin(\\theta_k)}\n$$\nThe constant factor $-\\frac{2}{B}$ cancels out.\n$$\nR = \\frac{\\sum_{k=1}^{3} k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin(\\theta_k - 15^{\\circ})}{\\sum_{k=1}^{3} k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}| \\sin(\\theta_k)}\n$$\nLet's calculate the weighted sum of sines for the numerator and the denominator. Let $S_k = k_{y,k} |\\tilde{n}_{k}| |\\tilde{\\phi}_{k}|$.\n$S_1 = (400) \\times (3.0 \\times 10^{16}) \\times (1.8) = 2.16 \\times 10^{19}$ (in SI units of $\\mathrm{V m^{-4}}$).\n$S_2 = (750) \\times (2.0 \\times 10^{16}) \\times (2.5) = 3.75 \\times 10^{19}$.\n$S_3 = (1100) \\times (1.5 \\times 10^{16}) \\times (1.2) = 1.98 \\times 10^{19}$.\n\nDenominator (unsheared flux sum):\n$\\sum S_k \\sin(\\theta_k) = S_1 \\sin(35^{\\circ}) + S_2 \\sin(20^{\\circ}) + S_3 \\sin(50^{\\circ})$\n$= (2.16 \\times 10^{19}) \\sin(35^{\\circ}) + (3.75 \\times 10^{19}) \\sin(20^{\\circ}) + (1.98 \\times 10^{19}) \\sin(50^{\\circ})$\n$= (2.16 \\times 0.573576 + 3.75 \\times 0.342020 + 1.98 \\times 0.766044) \\times 10^{19}$\n$= (1.238925 + 1.282575 + 1.516768) \\times 10^{19} = 4.038268 \\times 10^{19}$.\n\nNumerator (sheared flux sum):\nThe new angles are $\\theta'_1=35^{\\circ}-15^{\\circ}=20^{\\circ}$, $\\theta'_2=20^{\\circ}-15^{\\circ}=5^{\\circ}$, $\\theta'_3=50^{\\circ}-15^{\\circ}=35^{\\circ}$.\n$\\sum S_k \\sin(\\theta'_k) = S_1 \\sin(20^{\\circ}) + S_2 \\sin(5^{\\circ}) + S_3 \\sin(35^{\\circ})$\n$= (2.16 \\times 10^{19}) \\sin(20^{\\circ}) + (3.75 \\times 10^{19}) \\sin(5^{\\circ}) + (1.98 \\times 10^{19}) \\sin(35^{\\circ})$\n$= (2.16 \\times 0.342020 + 3.75 \\times 0.087156 + 1.98 \\times 0.573576) \\times 10^{19}$\n$= (0.738763 + 0.326835 + 1.135681) \\times 10^{19} = 2.201279 \\times 10^{19}$.\n\nFinally, calculate the ratio $R$:\n$R = \\frac{2.201279 \\times 10^{19}}{4.038268 \\times 10^{19}} = 0.54510...$\n\nRounding to four significant figures, the reduction factor is $0.5451$.",
            "answer": "$$\n\\boxed{0.5451}\n$$"
        },
        {
            "introduction": "Having explored local flux generation and regulation, we now address the spatial dynamics of how turbulence spreads from an unstable region to a stable one. This phenomenon can be modeled as a propagating front, whose dynamics are captured by reaction-diffusion-advection equations, a powerful paradigm also found in fields from ecology to combustion. This exercise challenges you to derive the propagation speed of a turbulence front based on the famous Fisher-KPP model, providing a hands-on application of front propagation theory to the problem of core-edge coupling. ",
            "id": "3960472",
            "problem": "Consider a one-dimensional model for the radial evolution of a scalar turbulence-intensity field $n(x,t)$ in a magnetically confined plasma, representing core turbulence spreading toward the edge. The evolution is governed by an advection–diffusion–reaction equation of the form\n$$\n\\frac{\\partial n}{\\partial t} + v \\frac{\\partial n}{\\partial x} = D \\frac{\\partial^2 n}{\\partial x^2} + R(n),\n$$\nwhere $x$ is the minor-radius coordinate measured outward from a core source located at $x=0$, $t$ is time, $v$ is the outward drift velocity due to macroscopic flows, $D$ is the effective turbulent diffusivity, and $R(n)$ is a reaction term capturing local instability drive and saturation. Assume $R(n)$ is of Fisher–Kolmogorov–Petrovsky–Piskunov (Fisher–KPP) type,\n$$\nR(n) = \\gamma n \\left(1 - \\frac{n}{n_{\\mathrm{sat}}}\\right),\n$$\nwith linear growth rate $\\gamma$ and saturation level $n_{\\mathrm{sat}}$. The core–edge interface is located at a fixed distance $\\Delta$ from the source. The initial condition is localized near $x=0$ and sufficiently small such that the leading edge of the front evolves in the linearly unstable regime where $n \\ll n_{\\mathrm{sat}}$.\n\nStarting from fundamental principles (conservation form, Fick's law for diffusion, linearization of the reaction term near $n=0$, and the definition of a pulled front dominated by the leading-edge linear dynamics), derive an expression for the expected position of the leading edge of the turbulence front after a time interval $\\tau$, denoted by the spreading length $L(\\tau)$ in meters. Your derivation must be grounded in the linearized dynamics near the front and must explicitly justify how advection, diffusion, and reaction each contribute to $L(\\tau)$. In the special case where the linear growth rate is zero (that is, $\\gamma=0$), there is no self-sustained front, and you must define a physically justified proxy for $L(\\tau)$ based on the advection–diffusion Green's function and a conservative detection criterion constructed from the root-mean-square width of the packet.\n\nThen, for each parameter set in the test suite below, compute $L(\\tau)$ and determine whether the core–edge interface at distance $\\Delta$ can be traversed within time $\\tau$, that is, whether $L(\\tau) \\ge \\Delta$. Express all distances in meters and all times in seconds, all velocities in meters per second, all diffusivities in square meters per second, and all growth rates in inverse seconds. Angles do not appear. The boolean decision must be expressed as a boolean value.\n\nTest suite consisting of $5$ parameter sets $(v,D,\\gamma,\\tau,\\Delta)$, given in International System of Units (SI):\n- Case $1$: $(v,D,\\gamma,\\tau,\\Delta) = (\\,50\\,\\mathrm{m/s},\\,1.0\\,\\mathrm{m^2/s},\\,100\\,\\mathrm{s^{-1}},\\,0.02\\,\\mathrm{s},\\,1.0\\,\\mathrm{m}\\,)$.\n- Case $2$: $(v,D,\\gamma,\\tau,\\Delta) = (\\,20\\,\\mathrm{m/s},\\,0.2\\,\\mathrm{m^2/s},\\,0\\,\\mathrm{s^{-1}},\\,0.05\\,\\mathrm{s},\\,1.5\\,\\mathrm{m}\\,)$.\n- Case $3$: $(v,D,\\gamma,\\tau,\\Delta) = (\\,{-10}\\,\\mathrm{m/s},\\,0.5\\,\\mathrm{m^2/s},\\,200\\,\\mathrm{s^{-1}},\\,0.03\\,\\mathrm{s},\\,0.6\\,\\mathrm{m}\\,)$.\n- Case $4$: $(v,D,\\gamma,\\tau,\\Delta) = (\\,0\\,\\mathrm{m/s},\\,0.8\\,\\mathrm{m^2/s},\\,300\\,\\mathrm{s^{-1}},\\,0.01\\,\\mathrm{s},\\,0.2\\,\\mathrm{m}\\,)$.\n- Case $5$: $(v,D,\\gamma,\\tau,\\Delta) = (\\,100\\,\\mathrm{m/s},\\,1.0\\,\\mathrm{m^2/s},\\,50\\,\\mathrm{s^{-1}},\\,0.001\\,\\mathrm{s},\\,0.12\\,\\mathrm{m}\\,)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list with two entries: the first is the floating-point spreading length $L(\\tau)$ in meters, and the second is the boolean decision of whether the interface is traversed. For example, the output format must be\n$$\n[\\,[L_1,\\mathrm{decision}_1],\\,[L_2,\\mathrm{decision}_2],\\,\\dots\\,]\n$$\nwith no additional text.",
            "solution": "The problem statement is deemed valid as it is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique and meaningful solution. It presents a standard model in transport physics and asks for a derivation and calculation based on established principles.\n\nThe central task is to derive the spreading length $L(\\tau)$, representing the position of the leading edge of a turbulence front after a time interval $\\tau$. The dynamics are governed by the one-dimensional advection–diffusion–reaction equation for the turbulence intensity field $n(x,t)$:\n$$\n\\frac{\\partial n}{\\partial t} + v \\frac{\\partial n}{\\partial x} = D \\frac{\\partial^2 n}{\\partial x^2} + \\gamma n \\left(1 - \\frac{n}{n_{\\mathrm{sat}}}\\right)\n$$\nwhere $v$ is the advection velocity, $D$ is the diffusivity, and the final term is the Fisher-KPP reaction term with linear growth rate $\\gamma$ and saturation level $n_{\\mathrm{sat}}$. The derivation depends on whether the linear growth rate $\\gamma$ is positive or zero.\n\n**Case 1: Spreading with Reaction ($\\gamma  0$)**\n\nIn this case, the system can support a self-propagating front. The problem specifies that the leading edge of the front evolves in the linearly unstable regime where $n \\ll n_{\\mathrm{sat}}$. This allows for the linearization of the reaction term:\n$$\nR(n) = \\gamma n \\left(1 - \\frac{n}{n_{\\mathrm{sat}}}\\right) \\approx \\gamma n\n$$\nThe governing equation for the leading edge thus simplifies to a linear partial differential equation:\n$$\n\\frac{\\partial n}{\\partial t} + v \\frac{\\partial n}{\\partial x} = D \\frac{\\partial^2 n}{\\partial x^2} + \\gamma n\n$$\nThis type of front, whose speed is determined by the linear dynamics at the very tip, is known as a \"pulled front.\" We can find its speed, $c_{\\mathrm{front}}$, by seeking a traveling wave solution of the form $n(x,t) = f(z)$, where $z = x - c_{\\mathrm{front}}t$. Substituting this ansatz into the linearized equation, the partial derivatives become ordinary derivatives with respect to $z$: $\\frac{\\partial}{\\partial t} \\to -c_{\\mathrm{front}} \\frac{d}{dz}$ and $\\frac{\\partial}{\\partial x} \\to \\frac{d}{dz}$. This yields the ordinary differential equation:\n$$\n-c_{\\mathrm{front}} f'(z) + v f'(z) = D f''(z) + \\gamma f(z)\n$$\nRearranging gives:\n$$\nD f''(z) + (c_{\\mathrm{front}} - v) f'(z) + \\gamma f(z) = 0\n$$\nAt the leading edge of the front (large $z$), the profile must decay to zero. We look for solutions of the form $f(z) \\propto e^{-\\lambda z}$, where $\\lambda  0$ is the spatial decay rate. Substituting this into the ODE gives the characteristic equation for $\\lambda$:\n$$\nD \\lambda^2 - (c_{\\mathrm{front}} - v) \\lambda + \\gamma = 0\n$$\nFor a physically realistic, decaying solution, $\\lambda$ must be real and positive. The solutions for $\\lambda$ from the quadratic formula are:\n$$\n\\lambda = \\frac{(c_{\\mathrm{front}} - v) \\pm \\sqrt{(c_{\\mathrm{front}} - v)^2 - 4D\\gamma}}{2D}\n$$\nReal solutions for $\\lambda$ exist only if the discriminant is non-negative:\n$$\n(c_{\\mathrm{front}} - v)^2 - 4D\\gamma \\ge 0 \\implies |c_{\\mathrm{front}} - v| \\ge 2\\sqrt{D\\gamma}\n$$\nThis inequality sets a lower bound on the speed of the front relative to the advecting medium. For pulled fronts originating from localized initial conditions, the system selects the minimum possible speed. The front propagates outward, so we take the positive root, $c_{\\mathrm{front}} - v  0$. The minimal speed condition is therefore:\n$$\nc_{\\mathrm{front}} - v = 2\\sqrt{D\\gamma}\n$$\nThis leads to the expression for the front propagation speed:\n$$\nc_{\\mathrm{front}} = v + 2\\sqrt{D\\gamma}\n$$\nThis result clearly separates the contributions: the front is advected with the background flow at velocity $v$, and it propagates relative to this flow at a speed $2\\sqrt{D\\gamma}$ determined by the interplay of diffusion ($D$) and linear reaction ($\\gamma$). The spreading length $L(\\tau)$, which is the position of the front at time $\\tau$ starting from $x=0$, is then:\n$$\nL(\\tau) = c_{\\mathrm{front}} \\cdot \\tau = (v + 2\\sqrt{D\\gamma})\\tau\n$$\n\n**Case 2: Spreading without Reaction ($\\gamma = 0$)**\n\nWhen $\\gamma = 0$, the reaction term vanishes, and the equation becomes the standard advection-diffusion equation:\n$$\n\\frac{\\partial n}{\\partial t} + v \\frac{\\partial n}{\\partial x} = D \\frac{\\partial^2 n}{\\partial x^2}\n$$\nIn this case, there is no self-sustaining front. An initial localized packet of turbulence will spread out diffusively while its center of mass advects. The solution for a point-source initial condition $n(x,0) = N_0 \\delta(x)$ is given by the Green's function, which is a drifting Gaussian:\n$$\nn(x,t) = \\frac{N_0}{\\sqrt{4\\pi Dt}} \\exp\\left(-\\frac{(x - vt)^2}{4Dt}\\right)\n$$\nTo define a proxy for the spreading length, we follow the prompt's instruction to use a criterion based on the root-mean-square (RMS) width of the packet. For this Gaussian distribution, the statistical moments at time $t$ are:\n-   Mean position: $\\langle x(t) \\rangle = vt$. This represents the purely advective motion of the packet's center.\n-   Variance: $\\sigma_x^2(t) = \\langle (x - \\langle x \\rangle)^2 \\rangle = 2Dt$.\n-   RMS width (standard deviation): $\\sigma_x(t) = \\sqrt{2Dt}$. This characterizes the diffusive spreading of the packet.\n\nA physically justified and conservative proxy for the position of the \"leading edge\" is the mean position plus a measure of the packet's width. We define the spreading length $L(\\tau)$ as the mean position plus one RMS width at time $\\tau$:\n$$\nL(\\tau) = \\langle x(\\tau) \\rangle + \\sigma_x(\\tau) = v\\tau + \\sqrt{2D\\tau}\n$$\nThis definition captures both the advective drift ($v\\tau$) and the diffusive spreading ($\\sqrt{2D\\tau}$) of the turbulence packet.\n\n**Summary of Formulas and Decision Criterion**\n\nThe spreading length $L(\\tau)$ is calculated as follows:\n-   If $\\gamma  0$: $L(\\tau) = (v + 2\\sqrt{D\\gamma})\\tau$\n-   If $\\gamma = 0$: $L(\\tau) = v\\tau + \\sqrt{2D\\tau}$\n\nFor each parameter set, we compute $L(\\tau)$ and compare it to the core–edge interface distance $\\Delta$. The interface is considered to be traversed if the spreading length is greater than or equal to the interface distance, i.e., $L(\\tau) \\ge \\Delta$. The result for each case is a two-element list containing the calculated value of $L(\\tau)$ and a boolean value representing this decision.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the turbulence spreading length L(tau) and determines if it\n    traverses the core-edge interface distance Delta for a given set of\n    plasma parameters.\n    \"\"\"\n    \n    # Test suite of 5 parameter sets (v, D, gamma, tau, Delta) in SI units.\n    test_cases = [\n        # (v,      D,   gamma,  tau,  Delta)\n        (50.0,    1.0,   100.0,  0.02, 1.0),\n        (20.0,    0.2,   0.0,    0.05, 1.5),\n        (-10.0,   0.5,   200.0,  0.03, 0.6),\n        (0.0,     0.8,   300.0,  0.01, 0.2),\n        (100.0,   1.0,   50.0,   0.001, 0.12)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        v, D, gamma, tau, Delta = case\n        \n        L_tau = 0.0\n        \n        if gamma > 0:\n            # Case 1: Fisher-KPP front propagation (reaction-dominated)\n            # The front speed is c_front = v + 2*sqrt(D*gamma).\n            # The position of the front at time tau is L(tau) = c_front * tau.\n            c_front = v + 2 * np.sqrt(D * gamma)\n            L_tau = c_front * tau\n        else: # gamma == 0\n            # Case 2: Pure advection-diffusion\n            # No self-sustaining front. We use a proxy for the spreading length.\n            # L(tau) is defined as the mean position (vt) plus one RMS width (sqrt(2Dt)).\n            L_tau = v * tau + np.sqrt(2 * D * tau)\n            \n        # Determine if the core-edge interface is traversed.\n        # This is true if the spreading length is greater than or equal to the\n        # interface distance Delta.\n        decision = L_tau >= Delta\n        \n        results.append([L_tau, decision])\n\n    # Format the results into the required string representation:\n    # A list of lists, e.g., [[L1, decision1], [L2, decision2], ...]\n    # The default string representation of a Python list of lists is the desired format.\n    # map(str, results) converts each inner list (e.g., [1.4, True]) to its string form.\n    # ','.join(...) concatenates these strings with commas.\n    # The outer f-string adds the enclosing square brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}