{
    "hands_on_practices": [
        {
            "introduction": "了解等离子体的稳定性边界是聚变研究的核心。经典的磁剪切-压力梯度（$s$-$\\alpha$）模型为分析磁流体力学（MHD）气球模不稳定性提供了一个强大的分析框架。这项练习将引导你推导出一个简化的动理学气球模（KBM）稳定性判据，并探索微湍流输运如何通过弛豫压力梯度来影响这一边界，这对于理解等离子体剖面在接近边际稳定性时的“刚性”至关重要。",
            "id": "3961761",
            "problem": "考虑一个圆形截面的托卡马克等离子体，其局部由用于磁流体动力学（MHD）气球模稳定性的标准磁剪切-压强梯度模型（$s$–$\\alpha$ 模型）来建模。在 $s$–$\\alpha$ 模型的通常意义下，定义磁剪切 $s$ 和归一化的压强梯度参数 $\\alpha$，其中 $\\alpha$ 是无量纲的，用于衡量压强梯度相对于磁力线曲率的失稳效应。动理学气球模（KBM）在其最简单的类流体表示中，在临界稳定性附近继承了理想MHD气球模的结构，但会受到微湍流输运的修正，后者会重新分布压强并使 $\\alpha$ 松弛。\n\n假设一个带极向角 $\\theta$ 的一维局域磁力线气球模描述，以及一个关于磁力线位移振幅 $\\psi(\\theta)$ 的类薛定谔本征值问题，\n$$\n-\\frac{d^{2}\\psi}{d\\theta^{2}} + V(\\theta)\\,\\psi = \\lambda\\,\\psi,\n$$\n其中临界稳定性对应于 $\\lambda=0$，有效势近似为\n$$\nV(\\theta) = s^{2}\\theta^{2} - \\alpha\\cos\\theta.\n$$\n假设稳定性阈值由 $\\theta=0$ 附近的势阱中束缚态的形成所控制。当 $\\alpha$ 超过其阈值时，微湍流通过增强输运与MHD耦合，从而降低压强梯度，并使 $\\alpha$ 向临界状态松弛。在径向范围为 $L$ 的平板几何中，使用均匀的压强源密度 $S_{p}$ 和压强的反常扩散模型来对此耦合进行建模，\n$$\nD(\\alpha) = \n\\begin{cases}\nD_{0},  \\alpha \\le \\alpha_{\\text{crit}}(s) \\\\\nD_{0}\\left[1 + \\dfrac{\\alpha - \\alpha_{\\text{crit}}(s)}{\\Delta}\\right],  \\alpha \\ge \\alpha_{\\text{crit}}(s)\n\\end{cases}\n$$\n其中 $\\Delta0$ 是一个刚度标度。在稳态下，取压强梯度 $g_{p}=-\\partial p/\\partial r$ 为均匀值，使得 $S_{p}L = D(\\alpha)\\,g_{p}$。通过 $\\alpha = K\\,g_{p}$ 将气球模参数与压强梯度联系起来，其中常数 $K0$ 包含了几何因子，并将在没有输运增强情况下的驱动值定义为 $\\alpha_{\\text{src}} \\equiv K S_{p}L/D_{0}$。\n\n任务：\n1. 使用 $\\theta=0$ 附近的小角度展开 $\\cos\\theta \\approx 1-\\theta^{2}/2$，得到一个临界稳定性的阈值条件，从而在这个简单的 $s$–$\\alpha$ 模型中得出KBM阈值 $\\alpha_{\\text{crit}}(s)$。\n2. 使用给定的扩散模型，推导当 $\\alpha \\ge \\alpha_{\\text{crit}}(s)$ 时，松弛稳态 $\\alpha$ 关于 $\\alpha_{\\text{src}}$、$\\Delta$ 和 $\\alpha_{\\text{crit}}(s)$ 的闭式表达式。\n3. 对 $s=0.8$、$\\alpha_{\\text{src}}=1.8$ 和 $\\Delta=0.6$ 的情况，计算松弛稳态的 $\\alpha$。\n\n将您的最终答案表示为一个无量纲数，并将最终数值四舍五入到四位有效数字。",
            "solution": "该问题经验证具有科学依据，提法恰当，客观且自洽。所有变量和模型，尽管经过简化，都是计算聚变科学中使用的标准表示方法。该问题可按所述方式求解。\n\n按照题目要求，解题过程分为三个部分。\n\n### 第一部分：稳定性阈值 $\\alpha_{\\text{crit}}(s)$ 的推导\n\n起点是关于磁力线位移振幅 $\\psi(\\theta)$ 的一维类薛定谔本征值问题：\n$$\n-\\frac{d^{2}\\psi}{d\\theta^{2}} + V(\\theta)\\,\\psi = \\lambda\\,\\psi\n$$\n势 $V(\\theta)$ 由下式给出：\n$$\nV(\\theta) = s^{2}\\theta^{2} - \\alpha\\cos\\theta\n$$\n定义了阈值 $\\alpha_{\\text{crit}}(s)$ 的临界稳定性，对应于条件 $\\lambda=0$。题目指定在势的最小值点 $\\theta=0$ 附近使用 $\\cos\\theta$ 的小角度展开：\n$$\n\\cos\\theta \\approx 1 - \\frac{\\theta^{2}}{2}\n$$\n将此近似代入势函数中得到：\n$$\nV(\\theta) \\approx s^{2}\\theta^{2} - \\alpha\\left(1 - \\frac{\\theta^{2}}{2}\\right) = -\\alpha + \\left(s^{2} + \\frac{\\alpha}{2}\\right)\\theta^{2}\n$$\n于是临界稳定性方程（$\\lambda=0$）变为：\n$$\n-\\frac{d^{2}\\psi}{d\\theta^{2}} + \\left[-\\alpha + \\left(s^{2} + \\frac{\\alpha}{2}\\right)\\theta^{2}\\right]\\psi = 0\n$$\n该方程可以重排为量子简谐振子（QSHO）的定态薛定谔方程的规范形式：\n$$\n-\\frac{d^{2}\\psi}{d\\theta^{2}} + \\left(s^{2} + \\frac{\\alpha}{2}\\right)\\theta^{2}\\psi = \\alpha\\,\\psi\n$$\n该方程的形式为 $-\\frac{d^{2}\\psi}{dx^{2}} + kx^{2}\\psi = E\\psi$。此类方程的能量本征值 $E_n$ 由 $E_n = (2n+1)\\sqrt{k}$ 给出，其中 $n=0, 1, 2, ...$ 是量子数。\n\n在我们的问题中，变量是 $\\theta$，“劲度系数”是 $k = s^{2} + \\frac{\\alpha}{2}$，“能量”本征值是 $E = \\alpha$。当能量 $\\alpha$ 等于离散本征值 $E_n$ 之一时，出现束缚态，从而发生不稳定性。临界稳定性阈值对应于第一个（能量最低的）束缚态的出现，即基态（$n=0$）。\n\n在阈值处令 $\\alpha = \\alpha_{\\text{crit}}(s)$，我们将其等同于基态能量 $E_0$：\n$$\n\\alpha_{\\text{crit}}(s) = E_0 = (2(0)+1)\\sqrt{s^{2} + \\frac{\\alpha_{\\text{crit}}(s)}{2}}\n$$\n$$\n\\alpha_{\\text{crit}}(s) = \\sqrt{s^{2} + \\frac{\\alpha_{\\text{crit}}(s)}{2}}\n$$\n为了解出 $\\alpha_{\\text{crit}}(s)$，我们将方程两边平方，假设 $\\alpha_{\\text{crit}}(s) \\ge 0$，这是物理上所要求的，因为它与压强梯度成正比。\n$$\n\\left(\\alpha_{\\text{crit}}(s)\\right)^{2} = s^{2} + \\frac{\\alpha_{\\text{crit}}(s)}{2}\n$$\n将此方程重排成关于 $x=\\alpha_{\\text{crit}}(s)$ 的标准二次方程 $ax^2+bx+c=0$ 的形式：\n$$\n\\left(\\alpha_{\\text{crit}}(s)\\right)^{2} - \\frac{1}{2}\\alpha_{\\text{crit}}(s) - s^{2} = 0\n$$\n我们使用二次公式 $x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 来求解：\n$$\n\\alpha_{\\text{crit}}(s) = \\frac{-(-1/2) \\pm \\sqrt{(-1/2)^{2} - 4(1)(-s^{2})}}{2(1)} = \\frac{1/2 \\pm \\sqrt{1/4 + 4s^{2}}}{2}\n$$\n$$\n\\alpha_{\\text{crit}}(s) = \\frac{1}{4} \\pm \\frac{1}{2}\\sqrt{\\frac{1}{4}(1 + 16s^{2})} = \\frac{1}{4} \\pm \\frac{1}{4}\\sqrt{1 + 16s^{2}}\n$$\n因为对于任何 $s \\ne 0$，都有 $\\sqrt{1 + 16s^{2}} > 1$，所以负号将导致 $\\alpha_{\\text{crit}}(s)$ 为负值，这在物理上是不合理的。因此，我们必须选择正号。\n$$\n\\alpha_{\\text{crit}}(s) = \\frac{1}{4}\\left(1 + \\sqrt{1 + 16s^{2}}\\right)\n$$\n\n### 第二部分：松弛稳态 $\\alpha$ 的推导\n\n对于输运增强的情况（$\\alpha \\ge \\alpha_{\\text{crit}}(s)$），我们有四个给定的关系式：\n1. 扩散系数： $D(\\alpha) = D_{0}\\left[1 + \\dfrac{\\alpha - \\alpha_{\\text{crit}}(s)}{\\Delta}\\right]$\n2. 稳态条件： $S_{p}L = D(\\alpha)\\,g_{p}$\n3. 与压强梯度的关系： $\\alpha = K\\,g_{p}$\n4. 源强度的定义： $\\alpha_{\\text{src}} = K S_{p}L/D_{0}$\n\n从(3)式，我们将压强梯度表示为 $g_{p} = \\alpha/K$。将其代入(2)式：\n$$\nS_{p}L = D(\\alpha)\\frac{\\alpha}{K}\n$$\n从(4)式，我们将源项 $S_{p}L$ 表示为 $S_{p}L = \\frac{\\alpha_{\\text{src}} D_{0}}{K}$。\n令 $S_{p}L$ 的两个表达式相等：\n$$\n\\frac{\\alpha_{\\text{src}} D_{0}}{K} = D(\\alpha)\\frac{\\alpha}{K}\n$$\n$$\n\\alpha_{\\text{src}} D_{0} = D(\\alpha)\\,\\alpha\n$$\n现在，将(1)式中 $D(\\alpha)$ 的表达式代入此方程：\n$$\n\\alpha_{\\text{src}} D_{0} = D_{0}\\left[1 + \\dfrac{\\alpha - \\alpha_{\\text{crit}}(s)}{\\Delta}\\right]\\alpha\n$$\n基准扩散系数 $D_{0}$ 被消去：\n$$\n\\alpha_{\\text{src}} = \\left(1 + \\frac{\\alpha - \\alpha_{\\text{crit}}(s)}{\\Delta}\\right)\\alpha\n$$\n为了解出松弛后的 $\\alpha$ 值，我们将其重排成一个二次方程。为简化符号，令 $\\alpha_{c} = \\alpha_{\\text{crit}}(s)$。\n$$\n\\Delta\\alpha_{\\text{src}} = \\left(\\Delta + \\alpha - \\alpha_{c}\\right)\\alpha = \\Delta\\alpha + \\alpha^{2} - \\alpha_{c}\\alpha\n$$\n$$\n\\alpha^{2} + (\\Delta - \\alpha_{c})\\alpha - \\Delta\\alpha_{\\text{src}} = 0\n$$\n求解这个关于 $\\alpha$ 的二次方程：\n$$\n\\alpha = \\frac{-(\\Delta - \\alpha_{c}) \\pm \\sqrt{(\\Delta - \\alpha_{c})^{2} - 4(1)(-\\Delta\\alpha_{\\text{src}})}}{2}\n$$\n$$\n\\alpha = \\frac{\\alpha_{c} - \\Delta \\pm \\sqrt{(\\Delta - \\alpha_{c})^{2} + 4\\Delta\\alpha_{\\text{src}}}}{2}\n$$\n松弛后的 $\\alpha$ 必须是一个正实数。由于 $\\Delta0$ 且 $\\alpha_{\\text{src}}0$，平方根下的项总是正的。项 $\\sqrt{(\\Delta - \\alpha_{c})^{2} + 4\\Delta\\alpha_{\\text{src}}}$ 严格大于 $|\\Delta - \\alpha_{c}|$。如果我们取负号，即 $\\alpha = \\frac{\\alpha_{c} - \\Delta - \\sqrt{(\\Delta - \\alpha_{c})^{2} + 4\\Delta\\alpha_{\\text{src}}}}{2}$，结果将为负。因此，为了得到一个有物理意义的解，我们必须选择正号。\n$$\n\\alpha = \\frac{\\alpha_{\\text{crit}}(s) - \\Delta + \\sqrt{(\\Delta - \\alpha_{\\text{crit}}(s))^{2} + 4\\Delta\\alpha_{\\text{src}}}}{2}\n$$\n\n### 第三部分：松弛 $\\alpha$ 的数值计算\n\n我们给定的参数是 $s=0.8$，$\\alpha_{\\text{src}}=1.8$ 和 $\\Delta=0.6$。\n\n首先，我们计算 $s=0.8$ 时的临界阈值 $\\alpha_{\\text{crit}}(s)$：\n$$\n\\alpha_{\\text{crit}}(0.8) = \\frac{1}{4}\\left(1 + \\sqrt{1 + 16(0.8)^{2}}\\right) = \\frac{1}{4}\\left(1 + \\sqrt{1 + 16(0.64)}\\right)\n$$\n$$\n\\alpha_{\\text{crit}}(0.8) = \\frac{1}{4}\\left(1 + \\sqrt{1 + 10.24}\\right) = \\frac{1}{4}\\left(1 + \\sqrt{11.24}\\right)\n$$\n数值上，$\\sqrt{11.24} \\approx 3.3526109$。\n$$\n\\alpha_{\\text{crit}}(0.8) \\approx \\frac{1 + 3.3526109}{4} = \\frac{4.3526109}{4} \\approx 1.0881527\n$$\n我们将此值记为 $\\alpha_{c}$。由于 $\\alpha_{\\text{src}} = 1.8 > \\alpha_{c}$，系统处于增强输运状态，正如第二部分所假设的。\n\n现在，我们将 $\\alpha_{c} \\approx 1.0881527$，$\\Delta=0.6$ 和 $\\alpha_{\\text{src}}=1.8$ 代入松弛 $\\alpha$ 的表达式中：\n$$\n\\alpha = \\frac{\\alpha_{c} - \\Delta + \\sqrt{(\\Delta - \\alpha_{c})^{2} + 4\\Delta\\alpha_{\\text{src}}}}{2}\n$$\n我们来计算各项：\n$$\n\\alpha_{c} - \\Delta \\approx 1.0881527 - 0.6 = 0.4881527\n$$\n$$\n\\Delta - \\alpha_{c} \\approx 0.6 - 1.0881527 = -0.4881527\n$$\n$$\n(\\Delta - \\alpha_{c})^{2} \\approx (-0.4881527)^{2} \\approx 0.2382931\n$$\n$$\n4\\Delta\\alpha_{\\text{src}} = 4(0.6)(1.8) = 2.4(1.8) = 4.32\n$$\n平方根下的项是：\n$$\n0.2382931 + 4.32 = 4.5582931\n$$\n它的平方根是：\n$$\n\\sqrt{4.5582931} \\approx 2.1350159\n$$\n现在，代回 $\\alpha$ 的表达式中：\n$$\n\\alpha \\approx \\frac{0.4881527 + 2.1350159}{2} = \\frac{2.6231686}{2} \\approx 1.3115843\n$$\n将最终结果四舍五入到四位有效数字，得到：\n$$\n\\alpha \\approx 1.312\n$$",
            "answer": "$$\\boxed{1.312}$$"
        },
        {
            "introduction": "在静态分析的基础上，我们进一步考虑一个动态演化的场景，这更接近真实的等离子体行为。外部加热不断地向等离子体注入能量，增加了压力梯度，而湍流输运则耗散能量，同时流剪切可以抑制湍流。这项练习要求你编写一个数值求解器，以模拟在这些相互竞争的物理效应下，等离子体压力如何随时间演化，并确定其穿越动理学气球模不稳定性阈值的精确时刻。",
            "id": "3961793",
            "problem": "你需要实现一个数值求解器，用于在一个给定的加热剖面下，确定等离子体何时达到动理学气球模阈值。此计算需在一个简化模型中考虑湍流输运和剪切稳定化效应。目标是计算穿越时间以及该穿越时间对ExB剪切率的灵敏度。该任务被转化为一个关于芯部压强的一维常微分方程（ODE），并通过一个归一化的压强梯度阈值来监测磁流体力学（MHD）气球模的稳定性。磁流体力学（MHD）通过有效扩散系数和剪切修正的阈值与微湍流耦合。动理学气球模（KBM）是所监测其阈值的不稳定性。电场叉乘磁场剪切率（ExB剪切率）是流剪切稳定微湍流的速率。\n\n从以下基本定律和定义开始：\n- 标量压强 $p(t)$ 的能量平衡由一个线性的源-损失方程建模：\n$$\n\\frac{d p}{d t} = Q(t) - \\frac{\\chi_{\\mathrm{eff}}(\\gamma_E)}{L_p^2}\\,p(t),\n$$\n其中 $Q(t)$ 是一个有效加热率，表示为压强源，单位为帕斯卡/秒；$\\chi_{\\mathrm{eff}}(\\gamma_E)$ 是有效热扩散系数，单位为 $\\mathrm{m^2/s}$；$L_p$ 是一个固定的压强梯度长度标度，单位为 $\\mathrm{m}$；$\\gamma_E$ 是ExB剪切率，单位为 $\\mathrm{s^{-1}}$。\n- 归一化气球模参数 $\\alpha(t)$（无量纲）根据压强梯度建模：\n$$\n\\alpha(t) = \\frac{2 \\mu_0\\, q^2\\, R}{B^2}\\,\\left|\\frac{d p}{d r}\\right| \\approx \\frac{2 \\mu_0\\, q^2\\, R}{B^2}\\,\\frac{p(t)}{L_p},\n$$\n其中 $q$ 是安全因子（无量纲），$R$ 是大半径，单位为 $\\mathrm{m}$，$B$ 是磁场强度，单位为 $\\mathrm{T}$，$\\mu_0$ 是真空磁导率，表示为 $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$。\n- 阿尔芬频率 $\\omega_A$ 定义为\n$$\n\\omega_A = \\frac{v_A}{q R},\\quad v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}},\n$$\n其中 $\\rho$ 是质量密度，单位为 $\\mathrm{kg/m^3}$。\n- 剪切修正的KBM阈值：\n$$\n\\alpha_c(\\gamma_E) = \\alpha_{c0} \\left( 1 + C_{\\mathrm{shear}} \\frac{\\gamma_E}{\\omega_A} \\right),\n$$\n其中 $\\alpha_{c0}$ 是基线阈值（无量纲），$C_{\\mathrm{shear}}$ 是一个无量纲比例常数。\n- 剪切抑制的有效扩散系数：\n$$\n\\chi_{\\mathrm{eff}}(\\gamma_E) = \\frac{\\chi_0}{1 + \\left(\\frac{\\gamma_E}{\\gamma_{\\mathrm{bg}}}\\right)^2},\n$$\n其中 $\\chi_0$ 是基线微湍流扩散系数，单位为 $\\mathrm{m^2/s}$，$\\gamma_{\\mathrm{bg}}$ 是背景微湍流率，单位为 $\\mathrm{s^{-1}}$。\n\n你的任务：\n- 在初始条件 $p(0) = 0$ 下，对 $p(t)$ 的ODE进行积分，计算 $\\alpha(t)$，并在指定的时间窗口 $[0, t_{\\max}]$ 内检测到满足 $\\alpha(t) \\ge \\alpha_c(\\gamma_E)$ 的最小时间 $t_{\\mathrm{cross}}$。如果在该窗口内没有发生穿越，则报告 $t_{\\mathrm{cross}} = -1.0$。\n- 通过对称有限差分计算穿越时间对ExB剪切率的灵敏度：\n$$\nS = \\frac{t_{\\mathrm{cross}}(\\gamma_E + \\Delta) - t_{\\mathrm{cross}}(\\gamma_E - \\Delta)}{2 \\Delta}.\n$$\n如果 $t_{\\mathrm{cross}}(\\gamma_E + \\Delta)$ 或 $t_{\\mathrm{cross}}(\\gamma_E - \\Delta)$ 等于 $-1.0$，则报告 $S = 0.0$。\n\n需要使用的加热剖面 $Q(t)$：\n- 恒定剖面：\n$$\nQ(t) = Q_0.\n$$\n- 线性斜坡剖面：\n$$\nQ(t) = Q_0 + r t.\n$$\n- 方波脉冲剖面：\n$$\nQ(t) = Q_0 + A\\, H(t - t_s)\\,H(t_e - t),\n$$\n其中 $H(x)$ 是亥维赛德函数，当 $x  0$ 时 $H(x) = 0$，当 $x \\ge 0$ 时 $H(x) = 1$，$A$ 是脉冲幅度，单位为 $\\mathrm{Pa/s}$，$t_s$ 是脉冲开始时间，单位为 $\\mathrm{s}$，$t_e$ 是脉冲结束时间，单位为 $\\mathrm{s}$。\n\n数值方法要求：\n- 使用固定步长 $dt$ 的显式时间步长积分（前向欧拉法）。\n- 在每个时间步，使用ODE更新 $p$，计算 $\\alpha(t)$，并检查穿越条件。\n- 时间单位是秒，所有报告的时间都必须以秒为单位。\n\n测试套件：\n为以下三种情况提供结果。每种情况都是一个参数元组；你必须精确使用这些值。\n\n情况 $1$（斜坡加热，预期会发生穿越）：\n- $B = 3\\,\\mathrm{T}$, $R = 2.5\\,\\mathrm{m}$, $q = 1.4$, $L_p = 0.3\\,\\mathrm{m}$, $\\rho = 6 \\times 10^{-7}\\,\\mathrm{kg/m^3}$。\n- $\\alpha_{c0} = 0.45$, $C_{\\mathrm{shear}} = 0.3$。\n- $\\chi_0 = 0.7\\,\\mathrm{m^2/s}$, $\\gamma_{\\mathrm{bg}} = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$。\n- 加热：$Q_0 = 8.0 \\times 10^{5}\\,\\mathrm{Pa/s}$, $r = 1.2 \\times 10^{7}\\,\\mathrm{Pa/s^2}$。\n- 剪切：$\\gamma_E = 1.2 \\times 10^{5}\\,\\mathrm{s^{-1}}$, $\\Delta = 3.0 \\times 10^{4}\\,\\mathrm{s^{-1}}$。\n- 积分：$dt = 1.0 \\times 10^{-5}\\,\\mathrm{s}$, $t_{\\max} = 0.40\\,\\mathrm{s}$。\n\n情况 $2$（恒定加热，预期不会发生穿越）：\n- $B = 3\\,\\mathrm{T}$, $R = 2.5\\,\\mathrm{m}$, $q = 1.4$, $L_p = 0.3\\,\\mathrm{m}$, $\\rho = 6 \\times 10^{-7}\\,\\mathrm{kg/m^3}$。\n- $\\alpha_{c0} = 0.45$, $C_{\\mathrm{shear}} = 0.3$。\n- $\\chi_0 = 0.7\\,\\mathrm{m^2/s}$, $\\gamma_{\\mathrm{bg}} = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$。\n- 加热：$Q_0 = 3.0 \\times 10^{5}\\,\\mathrm{Pa/s}$。\n- 剪切：$\\gamma_E = 1.2 \\times 10^{5}\\,\\mathrm{s^{-1}}$, $\\Delta = 3.0 \\times 10^{4}\\,\\mathrm{s^{-1}}$。\n- 积分：$dt = 1.0 \\times 10^{-5}\\,\\mathrm{s}$, $t_{\\max} = 0.40\\,\\mathrm{s}$。\n\n情况 $3$（脉冲加热，预期在更高剪切稳定化下发生穿越）：\n- $B = 5\\,\\mathrm{T}$, $R = 3.0\\,\\mathrm{m}$, $q = 1.5$, $L_p = 0.25\\,\\mathrm{m}$, $\\rho = 5 \\times 10^{-7}\\,\\mathrm{kg/m^3}$。\n- $\\alpha_{c0} = 0.50$, $C_{\\mathrm{shear}} = 0.50$。\n- $\\chi_0 = 0.5\\,\\mathrm{m^2/s}$, $\\gamma_{\\mathrm{bg}} = 3.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$。\n- 加热：$Q_0 = 0.0\\,\\mathrm{Pa/s}$, $A = 3.0 \\times 10^{7}\\,\\mathrm{Pa/s}$, $t_s = 0.05\\,\\mathrm{s}$, $t_e = 0.15\\,\\mathrm{s}$。\n- 剪切：$\\gamma_E = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$, $\\Delta = 5.0 \\times 10^{4}\\,\\mathrm{s^{-1}}$。\n- 积分：$dt = 1.0 \\times 10^{-5}\\,\\mathrm{s}$, $t_{\\max} = 0.30\\,\\mathrm{s}$。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含结果，格式为逗号分隔的列表的列表（每个内部列表是两个浮点数），形式如下\n$$\n\\left[ [t_1, S_1], [t_2, S_2], [t_3, S_3] \\right],\n$$\n其中 $t_i$ 是情况 $i$ 的穿越时间（单位：秒），$S_i$ 是灵敏度（单位：秒/秒）。如果在指定窗口内没有发生穿越，$t_i$ 必须为 $-1.0$，$S_i$ 必须为 $0.0$。",
            "solution": "问题陈述经过了严格验证，被认为是合理的。它科学地基于等离子体物理学的简化模型，问题定义良好，所有必要的参数和条件都已明确，并且其表述是客观的。任务是数值求解等离子体压强的一阶常微分方程（ODE），监测一个磁流体力学（MHD）稳定性判据，并计算稳定性边界穿越时间对一个关键参数的灵敏度。\n\n解决方案遵循以下原则性设计。\n\n**1. 控制方程和关键参数**\n\n问题的核心在于标量等离子体压强 $p(t)$ 的时间演化，它由线性的源-损失ODE控制：\n$$\n\\frac{d p}{d t} = Q(t) - \\frac{\\chi_{\\mathrm{eff}}(\\gamma_E)}{L_p^2}\\,p(t)\n$$\n在这里，$Q(t)$ 是一个给定的加热源，损失项代表在固定梯度长度标度 $L_p$ 上的湍流能量输运，其有效热扩散系数为 $\\chi_{\\mathrm{eff}}(\\gamma_E)$。初始条件为 $p(0)=0$。\n\nMHD稳定性通过归一化气球模参数 $\\alpha(t)$ 进行监测，该参数与压强 $p(t)$ 呈线性关系：\n$$\n\\alpha(t) = K_{\\alpha} \\cdot p(t), \\quad \\text{其中} \\quad K_{\\alpha} = \\frac{2 \\mu_0\\, q^2\\, R}{B^2 L_p}\n$$\n其中 $\\mu_0=4\\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$ 是真空磁导率，$q$ 是安全因子，$R$ 是大半径，$B$ 是磁场强度。\n\n当 $\\alpha(t)$ 超过一个临界阈值 $\\alpha_c$ 时，动理学气球模（KBM）预计会变得不稳定。这个阈值本身依赖于提供稳定效应的ExB剪切率 $\\gamma_E$：\n$$\n\\alpha_c(\\gamma_E) = \\alpha_{c0} \\left( 1 + C_{\\mathrm{shear}} \\frac{\\gamma_E}{\\omega_A} \\right)\n$$\n在这里，$\\alpha_{c0}$ 是基线阈值，$C_{\\mathrm{shear}}$ 是一个无量纲系数，$\\omega_A$ 是阿尔芬频率，由 $\\omega_A = v_A / (qR)$ 定义，其中阿尔芬速度 $v_A = B/\\sqrt{\\mu_0 \\rho}$。\n\nExB剪切也抑制了微湍流，根据模型降低了热扩散系数 $\\chi_{\\mathrm{eff}}$：\n$$\n\\chi_{\\mathrm{eff}}(\\gamma_E) = \\frac{\\chi_0}{1 + \\left(\\frac{\\gamma_E}{\\gamma_{\\mathrm{bg}}}\\right)^2}\n$$\n其中 $\\chi_0$ 是基线扩散系数，$\\gamma_{\\mathrm{bg}}$ 是一个特征微湍流率。\n\n**2. 数值积分方案**\n\n该问题要求使用显式前向欧拉法来积分压强ODE。对于一个时间步长 $dt$，在时间 $t_{n+1} = t_n + dt$ 的压强 $p_{n+1}$ 由在时间 $t_n$ 的压强 $p_n$ 更新如下：\n$$\np_{n+1} = p_n + dt \\left( Q(t_n) - \\frac{\\chi_{\\mathrm{eff}}(\\gamma_E)}{L_p^2}\\,p_n \\right)\n$$\n这等价于 $p_{n+1} = p_n \\left(1 - dt \\frac{\\chi_{\\mathrm{eff}}}{L_p^2}\\right) + dt\\, Q(t_n)$。模拟从 $t_0=0$ 时的 $p_0=0$ 开始。\n\n**3. 穿越时间的算法实现**\n\n对于给定的一组物理和数值参数，包括 $\\gamma_E$ 的一个特定值，穿越时间 $t_{\\mathrm{cross}}$ 通过以下算法确定：\n\n首先，为了优化计算，所有在整个时间积分过程中保持不变的参数都会被预先计算。这些参数包括阿尔芬频率 $\\omega_A$、有效扩散系数 $\\chi_{\\mathrm{eff}}(\\gamma_E)$、损失系数 $\\chi_{\\mathrm{eff}}/L_p^2$、稳定性阈值 $\\alpha_c(\\gamma_E)$ 和比例常数 $K_{\\alpha}$。\n\n接下来，启动一个时间循环，从 $t=0$ 开始，以 $dt$ 为增量，直到 $t_{\\max}$：\n- 在每个时间步 $t_n$，根据指定的剖面（恒定、斜坡或脉冲）评估热源 $Q(t_n)$。\n- 使用前向欧拉公式计算压强 $p_{n+1}$。\n- 计算气球模参数 $\\alpha_{n+1} = K_{\\alpha} \\cdot p_{n+1}$。\n- 执行检查：如果 $\\alpha_{n+1} \\ge \\alpha_c(\\gamma_E)$，循环终止，报告穿越时间为 $t_{\\mathrm{cross}} = t_{n+1} = (n+1)dt$。\n- 如果循环完成而条件未被满足，则表示在模拟窗口内没有发生穿越，此时将 $t_{\\mathrm{cross}}$ 设置为 $-1.0$。\n\n这个过程被封装在一个函数 `find_crossing_time` 中，该函数接受全套参数并返回计算出的 $t_{\\mathrm{cross}}$。\n\n**4. 灵敏度计算**\n\n主要任务不仅要求计算名义 $\\gamma_E$ 对应的 $t_{\\mathrm{cross}}$，还要计算其对 $\\gamma_E$ 变化的灵敏度 $S$。灵敏度由对称有限差分定义：\n$$\nS = \\frac{t_{\\mathrm{cross}}(\\gamma_E + \\Delta) - t_{\\mathrm{cross}}(\\gamma_E - \\Delta)}{2 \\Delta}\n$$\n为了计算每个测试用例的 $S$，`find_crossing_time` 函数被调用三次：\n1.  使用名义剪切率 $\\gamma_E$ 来找到 $t_{\\mathrm{cross, mid}} = t_{\\mathrm{cross}}(\\gamma_E)$。\n2.  使用扰动后的剪切率 $\\gamma_E + \\Delta$ 来找到 $t_{\\mathrm{cross, plus}} = t_{\\mathrm{cross}}(\\gamma_E + \\Delta)$。\n3.  使用扰动后的剪切率 $\\gamma_E - \\Delta$ 来找到 $t_{\\mathrm{cross, minus}} = t_{\\mathrm{cross}}(\\gamma_E - \\Delta)$。\n\n然后根据 $t_{\\mathrm{cross, plus}}$ 和 $t_{\\mathrm{cross, minus}}$ 计算灵敏度 $S$。根据问题规范，如果这两个扰动运行的穿越时间中任意一个为 $-1.0$，则灵敏度 $S$ 设置为 $0.0$。\n\n整个过程由一个 `solve_case` 函数管理，该函数协调对 `find_crossing_time` 的三次调用，并计算最终的结果对 $[t_{\\mathrm{cross, mid}}, S]$。一个主函数 `solve` 遍历三个指定的测试用例，为每个用例调用 `solve_case`，并将所有结果格式化为所需的输出字符串。",
            "answer": "[[0.09311, 7.633333333333334e-08],[-1.0, 0.0],[0.17744, 1.1690000000000002e-07]]"
        },
        {
            "introduction": "在理解了湍流与MHD相互作用的物理机制后，下一步便是如何在计算上实现这种耦合。多物理场模拟通常需要将处理不同尺度物理的多个模型（例如，局域回旋动理学模型和全局MHD模型）在空间边界上耦合起来。这项练习聚焦于此过程中的一个关键技术挑战：你将计算确保物理一致性所必需的界面变量，包括电场、势和输运通量的连续性，为构建可靠的耦合模拟框架打下实践基础。",
            "id": "3961718",
            "problem": "一个局域陀螺动理学模型必须与一个全局磁流体力学模型在一个由磁通面和极向角标记的界面上进行耦合。该耦合要求静电势和磁矢量势平行分量的一致性，以及湍流输运通量的一致性。你需要实现一个程序，该程序针对每个测试用例，计算耦合局域陀螺动理学求解器与全局磁流体力学代码所需的界面变量和边界条件，并对平行电场施加一个有物理动机的约束。\n\n假设以下背景和定义。陀螺动理学侧在界面上的局域直磁力线坐标 $ \\theta $ 上提供涨落形状：\n- 静电势形状为 $ \\hat{\\phi}(\\theta) = \\phi_0 \\cos(\\theta + \\delta_\\phi) $。\n- 平行磁矢量势形状为 $ \\hat{A}_\\parallel(\\theta) = A_0 \\cos(\\theta + \\delta_A) $。\n\n假设角频率为 $ \\omega  0 $ 的时谐涨落，因此瞬时场为 $ \\phi(\\theta,t) = s \\hat{\\phi}(\\theta) \\cos(\\omega t) + c_\\phi $ 和 $ A_\\parallel(\\theta,t) = s \\hat{A}_\\parallel(\\theta) \\cos(\\omega t) + c_{A_\\parallel} $，其中 $ s $ 是应用于陀螺动理学形状的实数标度因子，$ c_\\phi $ 和 $ c_{A_\\parallel} $ 是为匹配全局磁流体力学界面值而设定的不随时间变化的规范偏移量。设界面上沿磁场的平行梯度算符近似为 $ \\nabla_\\parallel \\approx \\alpha \\, \\partial/\\partial \\theta $，其中 $ \\alpha $ 是一个依赖于平衡位形的常数度规系数。全局磁流体力学模型在特定的极向角 $ \\theta_0 $ 和匹配时间 $ t_0 $ 规定了界面值 $ \\phi_{\\mathrm{MHD},0} $、$ A_{\\parallel,\\mathrm{MHD},0} $ 以及目标瞬时平行电场 $ E_{\\parallel,\\mathrm{MHD},0} $。\n\n在选择的匹配时间 $ t_0 $（使得 $ \\cos(\\omega t_0) = 0 $ 且 $ \\sin(\\omega t_0) = 1 $，即 $ t_0 = \\pi/(2\\omega) $）处，强制平行电场满足 Maxwell–Faraday 一致性：\n$$\nE_\\parallel(\\theta,t) = -\\frac{\\partial A_\\parallel(\\theta,t)}{\\partial t} - \\nabla_\\parallel \\phi(\\theta,t),\n$$\n在此选择下，平行电场在 $ (\\theta_0,t_0) $ 处简化为\n$$\nE_\\parallel(\\theta_0,t_0) = \\omega \\, s \\, \\hat{A}_\\parallel(\\theta_0),\n$$\n这绕过了来自 $ c_\\phi $ 和 $ c_{A_\\parallel} $ 的规范模糊性，并分离出了感应贡献。为满足界面处的平行电场连续性，设置\n$$\ns = \\begin{cases}\n\\frac{E_{\\parallel,\\mathrm{MHD},0}}{\\omega \\, \\hat{A}_\\parallel(\\theta_0)},   \\text{if } \\hat{A}_\\parallel(\\theta_0) \\neq 0, \\\\\n0,   \\text{if } \\hat{A}_\\parallel(\\theta_0) = 0,\n\\end{cases}\n$$\n并通过取规范偏移量\n$$\nc_\\phi = \\phi_{\\mathrm{MHD},0}, \\qquad c_{A_\\parallel} = A_{\\parallel,\\mathrm{MHD},0}\n$$\n来强制在 $ (\\theta_0,t_0) $ 处的值匹配。这确保了 $ \\phi(\\theta_0,t_0) = \\phi_{\\mathrm{MHD},0} $ 和 $ A_\\parallel(\\theta_0,t_0) = A_{\\parallel,\\mathrm{MHD},0} $，同时以对局域陀螺动理学形状侵入性最小的方式匹配了 $ E_\\parallel(\\theta_0,t_0) $。定义一个界面连续性误差\n$$\n\\varepsilon = \\left| \\omega \\, s \\, \\hat{A}_\\parallel(\\theta_0) - E_{\\parallel,\\mathrm{MHD},0} \\right|,\n$$\n该误差量化了由于简并性或有限精度导致的任何残余失配。\n\n对于输运，采用一个准线性无量纲模型，将湍流扩散系数与静电势相关的 $ \\mathbf{E}\\times\\mathbf{B} $ 速度振幅的平方联系起来，\n$$\n\\chi_t = \\beta \\, s^2 \\, \\phi_0^2,\n$$\n其中 $ \\beta $ 是一个反映局域几何和饱和物理的无量纲比例因子。然后使用 Fick 定律及给定的无量纲梯度 $ g_n $ 和 $ g_T $ 计算无量纲粒子通量 $ \\Gamma $ 和热通量 $ Q $：\n$$\n\\Gamma = -\\chi_t \\, g_n, \\qquad Q = -\\chi_t \\, g_T.\n$$\n\n本问题中所有量均为无量纲；角度以弧度为单位。你的程序必须为每个测试用例计算并输出列表\n$$\n\\left[ \\, \\phi(\\theta_0,t_0), \\; A_\\parallel(\\theta_0,t_0), \\; \\Gamma, \\; Q, \\; \\varepsilon \\, \\right].\n$$\n将所有测试用例的输出聚合到一行中，形式为一个逗号分隔的列表，并用方括号括起来，其中每个元素是该测试用例的列表。不得打印任何额外文本。\n\n为以下参数值的测试套件实现上述内容，其中每个测试用例提供一个元组\n$$\n\\left( \\phi_0, \\; \\delta_\\phi, \\; A_0, \\; \\delta_A, \\; \\omega, \\; \\alpha, \\; \\theta_0, \\; \\beta, \\; g_n, \\; g_T, \\; \\phi_{\\mathrm{MHD},0}, \\; A_{\\parallel,\\mathrm{MHD},0}, \\; E_{\\parallel,\\mathrm{MHD},0} \\right).\n$$\n\n- 测试用例 1（一般一致性情况）：\n  - $ \\phi_0 = 0.8 $, $ \\delta_\\phi = 0.3 $, $ A_0 = 0.6 $, $ \\delta_A = -0.2 $, $ \\omega = 3.0 $, $ \\alpha = 0.5 $, $ \\theta_0 = 1.2 $, $ \\beta = 0.1 $, $ g_n = 0.7 $, $ g_T = 1.1 $, $ \\phi_{\\mathrm{MHD},0} = 0.05 $, $ A_{\\parallel,\\mathrm{MHD},0} = -0.02 $, $ E_{\\parallel,\\mathrm{MHD},0} = 0.18 $。\n\n- 测试用例 2（在 $ \\hat{A}_\\parallel(\\theta_0) = 0 $ 时的简并感应耦合）：\n  - $ \\phi_0 = 1.0 $, $ \\delta_\\phi = 0.0 $, $ A_0 = 0.0 $, $ \\delta_A = 0.0 $, $ \\omega = 2.5 $, $ \\alpha = 0.5 $, $ \\theta_0 = 0.7 $, $ \\beta = 0.2 $, $ g_n = 0.5 $, $ g_T = 0.9 $, $ \\phi_{\\mathrm{MHD},0} = 0.0 $, $ A_{\\parallel,\\mathrm{MHD},0} = 0.1 $, $ E_{\\parallel,\\mathrm{MHD},0} = 0.05 $。\n\n- 测试用例 3（产生负标度因子 $ s $ 的大振幅相移情况）：\n  - $ \\phi_0 = 1.2 $, $ \\delta_\\phi = 0.8 $, $ A_0 = 0.9 $, $ \\delta_A = 0.5 $, $ \\omega = 4.0 $, $ \\alpha = 0.6 $, $ \\theta_0 = 2.2 $, $ \\beta = 0.15 $, $ g_n = 1.3 $, $ g_T = 0.8 $, $ \\phi_{\\mathrm{MHD},0} = -0.03 $, $ A_{\\parallel,\\mathrm{MHD},0} = 0.04 $, $ E_{\\parallel,\\mathrm{MHD},0} = 0.27 $。\n\n- 测试用例 4（目标 $ E_{\\parallel,\\mathrm{MHD},0} $ 为负的高频情况）：\n  - $ \\phi_0 = 0.5 $, $ \\delta_\\phi = -0.4 $, $ A_0 = 0.4 $, $ \\delta_A = 1.1 $, $ \\omega = 10.0 $, $ \\alpha = 0.7 $, $ \\theta_0 = 0.2 $, $ \\beta = 0.12 $, $ g_n = 0.2 $, $ g_T = 0.4 $, $ \\phi_{\\mathrm{MHD},0} = 0.02 $, $ A_{\\parallel,\\mathrm{MHD},0} = -0.03 $, $ E_{\\parallel,\\mathrm{MHD},0} = -0.5 $。\n\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个列表 $ [ \\phi(\\theta_0,t_0), A_\\parallel(\\theta_0,t_0), \\Gamma, Q, \\varepsilon ] $。所有输出都必须是无量纲浮点数，角度以弧度为单位指定。",
            "solution": "目标是计算连接局域陀螺动理学描述与全局磁流体力学描述的一致性界面变量。该耦合依赖于 Maxwell–Faraday 定律以及静电势和磁矢量势平行分量的值匹配，同时还传递一致的湍流输运通量。\n\n我们从基本的电磁学原理开始。电场的平行分量遵循 Maxwell–Faraday 定律：\n$$\n\\mathbf{E} = -\\frac{\\partial \\mathbf{A}}{\\partial t} - \\nabla \\phi,\n$$\n界面平行分量为\n$$\nE_\\parallel(\\theta,t) = -\\frac{\\partial A_\\parallel(\\theta,t)}{\\partial t} - \\nabla_\\parallel \\phi(\\theta,t).\n$$\n对于一个圆形、大环径比的托卡马克，可以定义一个直磁力线极向坐标 $ \\theta $ 来捕捉沿磁力线的变化。在局域上，我们用一个常数度规因子来近似平行梯度\n$$\n\\nabla_\\parallel \\approx \\alpha \\, \\frac{\\partial}{\\partial \\theta},\n$$\n这样，$ \\theta $ 中的形状导数就反映了平行梯度。\n\n在陀螺动理学侧，局域漲落形状由下式给出：\n$$\n\\hat{\\phi}(\\theta) = \\phi_0 \\cos(\\theta + \\delta_\\phi), \\qquad \\hat{A}_\\parallel(\\theta) = A_0 \\cos(\\theta + \\delta_A).\n$$\n我们将它们嵌入到瞬时界面场中，使用一个单一的实数标度因子 $ s $ 和不随时间变化的偏移量 $ c_\\phi $ 和 $ c_{A_\\parallel} $：\n$$\n\\phi(\\theta,t) = s \\hat{\\phi}(\\theta) \\cos(\\omega t) + c_\\phi, \\qquad A_\\parallel(\\theta,t) = s \\hat{A}_\\parallel(\\theta) \\cos(\\omega t) + c_{A_\\parallel},\n$$\n其中 $ \\omega $ 是微湍流涨落的角频率。这些偏移量解释了局域陀螺动理学表示与全局磁流体力学场在界面处的规范和平均场差异。\n\n为了实现一个没有静电规范模糊性的一致耦合，选择匹配时间 $ t_0 $ 使得 $ \\cos(\\omega t_0) = 0 $ 且 $ \\sin(\\omega t_0) = 1 $，即\n$$\nt_0 = \\frac{\\pi}{2\\omega}.\n$$\n此时，在固定的极向角 $ \\theta_0 $ 处的瞬时平行电场简化为感应贡献\n$$\nE_\\parallel(\\theta_0,t_0) = \\omega \\, s \\, \\hat{A}_\\parallel(\\theta_0),\n$$\n因为 $ \\partial_t (s \\hat{A}_\\parallel \\cos \\omega t)|_{t_0} = -\\omega s \\hat{A}_\\parallel \\sin(\\omega t_0) = -\\omega s \\hat{A}_\\parallel $，并且 Maxwell–Faraday 方程中有一个额外的负号，从而得到 $ \\omega s \\hat{A}_\\parallel $，而由于 $ \\cos(\\omega t_0)=0 $，$ \\nabla_\\parallel \\phi(\\theta_0,t_0) = \\alpha \\, \\partial_\\theta (s \\hat{\\phi} \\cos \\omega t)|_{t_0} = 0 $，并且因为 $ c_\\phi $ 不随时间变化且在 $ \\theta $ 上空间均匀，规范偏移量的导数消失。\n\n因此，我们通过选择\n$$\ns = \\frac{E_{\\parallel,\\mathrm{MHD},0}}{\\omega \\, \\hat{A}_\\parallel(\\theta_0)} \\quad \\text{if } \\hat{A}_\\parallel(\\theta_0) \\neq 0,\n$$\n来强制界面处平行电场的连续性，否则当 $ \\hat{A}_\\parallel(\\theta_0) = 0 $ 时设置 $ s = 0 $，这反映了在这个单标度因子模型中，无法从一个消失的 $ \\hat{A}_\\parallel(\\theta_0) $ 来构造在 $ t_0 $ 时的感应匹配。残余失配由下式量化：\n$$\n\\varepsilon = \\left| \\omega \\, s \\, \\hat{A}_\\parallel(\\theta_0) - E_{\\parallel,\\mathrm{MHD},0} \\right|.\n$$\n通过设置规范偏移量\n$$\nc_\\phi = \\phi_{\\mathrm{MHD},0}, \\qquad c_{A_\\parallel} = A_{\\parallel,\\mathrm{MHD},0},\n$$\n来强制在 $ (\\theta_0, t_0) $ 处的值连续性，这自然得到\n$$\n\\phi(\\theta_0,t_0) = c_\\phi = \\phi_{\\mathrm{MHD},0}, \\qquad A_\\parallel(\\theta_0,t_0) = c_{A_\\parallel} = A_{\\parallel,\\mathrm{MHD},0}.\n$$\n\n对于输运耦合，我们从标准的准线性直觉出发，即湍流扩散系数 $ \\chi_t $ 与静电势相关的 $ \\mathbf{E}\\times\\mathbf{B} $ 速度的平方成比例。以无量纲形式，我们使用\n$$\n\\chi_t = \\beta \\, s^2 \\, \\phi_0^2,\n$$\n其中 $ \\beta $ 是一个无量纲比例常数。利用给定的密度和温度的无量纲梯度 $ g_n $ 和 $ g_T $，Fick 定律给出了粒子通量和热通量：\n$$\n\\Gamma = -\\chi_t \\, g_n, \\qquad Q = -\\chi_t \\, g_T.\n$$\n\n在算法上，对于每个测试用例，我们实现以下步骤：\n1. 计算 $ \\hat{A}_\\parallel(\\theta_0) = A_0 \\cos(\\theta_0 + \\delta_A) $。\n2. 如果对于一个小的阈值 $ \\epsilon $，$ |\\hat{A}_\\parallel(\\theta_0)|  \\epsilon $，则设置 $ s = E_{\\parallel,\\mathrm{MHD},0} / (\\omega \\hat{A}_\\parallel(\\theta_0)) $。否则设置 $ s = 0 $。\n3. 取 $ c_\\phi = \\phi_{\\mathrm{MHD},0} $ 和 $ c_{A_\\parallel} = A_{\\parallel,\\mathrm{MHD},0} $。\n4. 在 $ (\\theta_0,t_0) $ 处的界面值为 $ \\phi(\\theta_0,t_0) = c_\\phi $ 和 $ A_\\parallel(\\theta_0,t_0) = c_{A_\\parallel} $。\n5. 计算 $ \\chi_t = \\beta \\, s^2 \\, \\phi_0^2 $，然后计算 $ \\Gamma = -\\chi_t \\, g_n $ 和 $ Q = -\\chi_t \\, g_T $。\n6. 计算连续性误差 $ \\varepsilon = \\left| \\omega \\, s \\, \\hat{A}_\\parallel(\\theta_0) - E_{\\parallel,\\mathrm{MHD},0} \\right| $。\n\n每个测试用例的输出是列表 $ [ \\phi(\\theta_0,t_0), A_\\parallel(\\theta_0,t_0), \\Gamma, Q, \\varepsilon ] $。这些步骤产生确定性、可复现的输出，并覆盖了重要的边缘情况：一般的非简并情况、在匹配角度处感应形状消失、相移引起的负标度因子，以及与负目标平行电场的高频匹配。所有量均为无量纲，角度以弧度为单位，这一点已明确说明。最终输出按要求将所有测试用例的结果聚合到包含列表的列表的单行中。",
            "answer": "[[0.05,-0.02,-0.001534493375837279,-0.002411822858095116,0.0],[0.0,0.1,-0.0,-0.0,0.05],[-0.03,0.04,-0.001941655005830911,-0.0011948646189728682,0.0],[0.02,-0.03,-0.0013082309837943534,-0.002616461967588707,5.551115123125783e-17]]"
        }
    ]
}