{
    "hands_on_practices": [
        {
            "introduction": "我们将首先通过一个分析练习来探索湍流输运的核心原理。在托卡马克等离子体中，当压力梯度超过某个临界MHD稳定性阈值时，微观湍流会急剧增强，这种现象被称为“刚性”输运。本练习将指导您从一个简化的模型中推导出这个阈值，并计算增强的输运如何反过来将压力梯度“钳制”在临界值附近()。这个过程揭示了微观湍流通过调节驱动它的宏观平衡来实现自我调节的基本反馈机制。",
            "id": "3961761",
            "problem": "考虑一个圆形截面的托卡马克等离子体，其通过标准的磁剪切-压力梯度模型（$s$-$\\alpha$模型）进行局部建模，以分析磁流体力学（MHD）气球模不稳定性。在$s$-$\\alpha$模型通常的意义下，定义磁剪切$s$和归一化压力梯度参数$\\alpha$，其中$\\alpha$是无量纲的，用于衡量压力梯度相对于磁力线曲率的失稳效应。动理学气球模（KBM）在其最简单的类流体表示中，继承了理想MHD气球模在临界稳定性附近的结构，但会受到微观湍流输运的修正，后者会重新分布压力并使$\\alpha$弛豫。\n\n假设一个使用极向角$\\theta$的一维局域磁力线气球模描述，以及一个针对磁力线位移振幅$\\psi(\\theta)$的类薛定谔本征值问题，\n$$\n-\\frac{d^{2}\\psi}{d\\theta^{2}} + V(\\theta)\\,\\psi = \\lambda\\,\\psi,\n$$\n其中临界稳定性对应于$\\lambda=0$，有效势近似为\n$$\nV(\\theta) = s^{2}\\theta^{2} - \\alpha\\cos\\theta.\n$$\n假设稳定性阈值由势阱中$\\theta=0$附近束缚态的形成所控制。当$\\alpha$超过其阈值时，微观湍流通过增强输运与MHD耦合，从而降低压力梯度并使$\\alpha$向临界状态弛豫。在一个径向范围为$L$的平板几何中对此耦合进行建模，该模型具有均匀的压力源密度$S_{p}$和压力的反常扩散模型：\n$$\nD(\\alpha) = \n\\begin{cases}\nD_{0},  \\alpha \\le \\alpha_{\\text{crit}}(s) \\\\\nD_{0}\\left[1 + \\dfrac{\\alpha - \\alpha_{\\text{crit}}(s)}{\\Delta}\\right],  \\alpha \\ge \\alpha_{\\text{crit}}(s)\n\\end{cases}\n$$\n其中$\\Delta0$是一个刚度标度。在稳态下，取压力梯度$g_{p}=-\\partial p/\\partial r$为均匀的，使得$S_{p}L = D(\\alpha)\\,g_{p}$。通过$\\alpha = K\\,g_{p}$将气球模参数与压力梯度联系起来，其中常数$K0$包含了几何因子，并定义在没有输运增强情况下的驱动值为$\\alpha_{\\text{src}} \\equiv K S_{p}L/D_{0}$。\n\n任务：\n1. 在$\\theta=0$附近使用小角度展开$\\cos\\theta \\approx 1-\\theta^{2}/2$，得到一个临界稳定性的阈值条件，从而在该简化的$s$-$\\alpha$模型中得出KBM阈值$\\alpha_{\\text{crit}}(s)$。\n2. 使用给定的扩散模型，推导出当$\\alpha \\ge \\alpha_{\\text{crit}}(s)$时，弛豫后的稳态$\\alpha$关于$\\alpha_{\\text{src}}$、$\\Delta$和$\\alpha_{\\text{crit}}(s)$的闭式表达式。\n3. 对于$s=0.8$，$\\alpha_{\\text{src}}=1.8$和$\\Delta=0.6$，计算弛豫后的稳态$\\alpha$。\n\n将你的最终答案表示为一个无量纲数，并将最终数值四舍五入到四位有效数字。",
            "solution": "该问题被验证为具有科学依据、提法恰当、客观且自洽。所有变量和模型虽然经过简化，但都是计算聚变科学中使用的标准表示方法。该问题可按所述方式求解。\n\n该解答按问题陈述的要求分为三部分。\n\n### 第一部分：稳定性阈值$\\alpha_{\\text{crit}}(s)$的推导\n\n出发点是关于磁力线位移振幅$\\psi(\\theta)$的一维类薛定谔本征值问题：\n$$\n-\\frac{d^{2}\\psi}{d\\theta^{2}} + V(\\theta)\\,\\psi = \\lambda\\,\\psi\n$$\n势函数$V(\\theta)$由下式给出：\n$$\nV(\\theta) = s^{2}\\theta^{2} - \\alpha\\cos\\theta\n$$\n临界稳定性定义了阈值$\\alpha_{\\text{crit}}(s)$，对应于条件$\\lambda=0$。问题指定在势函数最小值$\\theta=0$附近对$\\cos\\theta$使用小角度展开：\n$$\n\\cos\\theta \\approx 1 - \\frac{\\theta^{2}}{2}\n$$\n将此近似代入势函数可得：\n$$\nV(\\theta) \\approx s^{2}\\theta^{2} - \\alpha\\left(1 - \\frac{\\theta^{2}}{2}\\right) = -\\alpha + \\left(s^{2} + \\frac{\\alpha}{2}\\right)\\theta^{2}\n$$\n临界稳定性方程（$\\lambda=0$）于是变为：\n$$\n-\\frac{d^{2}\\psi}{d\\theta^{2}} + \\left[-\\alpha + \\left(s^{2} + \\frac{\\alpha}{2}\\right)\\theta^{2}\\right]\\psi = 0\n$$\n该方程可以重排为量子简谐振子（QSHO）的定态薛定谔方程的规范形式：\n$$\n-\\frac{d^{2}\\psi}{d\\theta^{2}} + \\left(s^{2} + \\frac{\\alpha}{2}\\right)\\theta^{2}\\psi = \\alpha\\,\\psi\n$$\n该方程的形式为$-\\frac{d^{2}\\psi}{dx^{2}} + kx^{2}\\psi = E\\psi$。此类方程的能量本征值$E_n$由$E_n = (2n+1)\\sqrt{k}$给出，其中$n=0, 1, 2, ...$是量子数。\n\n在我们的情况下，变量是$\\theta$，“弹簧常数”是$k = s^{2} + \\frac{\\alpha}{2}$，“能量”本征值是$E = \\alpha$。当能量$\\alpha$等于离散本征值$E_n$之一时，出现束缚态，从而发生不稳定性。临界稳定性阈值对应于第一个（最低能量）束缚态的出现，即基态（$n=0$）。\n\n在阈值处设$\\alpha = \\alpha_{\\text{crit}}(s)$，我们将其等同于基态能量$E_0$：\n$$\n\\alpha_{\\text{crit}}(s) = E_0 = (2(0)+1)\\sqrt{s^{2} + \\frac{\\alpha_{\\text{crit}}(s)}{2}}\n$$\n$$\n\\alpha_{\\text{crit}}(s) = \\sqrt{s^{2} + \\frac{\\alpha_{\\text{crit}}(s)}{2}}\n$$\n为求解$\\alpha_{\\text{crit}}(s)$，我们对方程两边取平方，假设$\\alpha_{\\text{crit}}(s) \\ge 0$，这在物理上是必需的，因为它与压力梯度成正比。\n$$\n\\left(\\alpha_{\\text{crit}}(s)\\right)^{2} = s^{2} + \\frac{\\alpha_{\\text{crit}}(s)}{2}\n$$\n将其重排为关于$x=\\alpha_{\\text{crit}}(s)$的标准二次方程$ax^2+bx+c=0$形式：\n$$\n\\left(\\alpha_{\\text{crit}}(s)\\right)^{2} - \\frac{1}{2}\\alpha_{\\text{crit}}(s) - s^{2} = 0\n$$\n我们使用二次方程求根公式$x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$来求解：\n$$\n\\alpha_{\\text{crit}}(s) = \\frac{-(-1/2) \\pm \\sqrt{(-1/2)^{2} - 4(1)(-s^{2})}}{2(1)} = \\frac{1/2 \\pm \\sqrt{1/4 + 4s^{2}}}{2}\n$$\n$$\n\\alpha_{\\text{crit}}(s) = \\frac{1}{4} \\pm \\frac{1}{2}\\sqrt{\\frac{1}{4}(1 + 16s^{2})} = \\frac{1}{4} \\pm \\frac{1}{4}\\sqrt{1 + 16s^{2}}\n$$\n由于对于任何$s \\ne 0$，$\\sqrt{1 + 16s^{2}}  1$，负号将导致$\\alpha_{\\text{crit}}(s)$为负值，这不符合物理实际。因此，我们必须选择正号。\n$$\n\\alpha_{\\text{crit}}(s) = \\frac{1}{4}\\left(1 + \\sqrt{1 + 16s^{2}}\\right)\n$$\n\n### 第二部分：弛豫后稳态$\\alpha$的推导\n\n对于输运增强的情况（$\\alpha \\ge \\alpha_{\\text{crit}}(s)$），我们有四个关系式：\n1. 扩散系数：$D(\\alpha) = D_{0}\\left[1 + \\dfrac{\\alpha - \\alpha_{\\text{crit}}(s)}{\\Delta}\\right]$\n2. 稳态条件：$S_{p}L = D(\\alpha)\\,g_{p}$\n3. 与压力梯度的关系：$\\alpha = K\\,g_{p}$\n4. 源强度的定义：$\\alpha_{\\text{src}} = K S_{p}L/D_{0}$\n\n由(3)式，我们将压力梯度表示为$g_{p} = \\alpha/K$。将其代入(2)式：\n$$\nS_{p}L = D(\\alpha)\\frac{\\alpha}{K}\n$$\n由(4)式，我们将源项$S_{p}L$表示为$S_{p}L = \\frac{\\alpha_{\\text{src}} D_{0}}{K}$。\n令两个$S_{p}L$的表达式相等：\n$$\n\\frac{\\alpha_{\\text{src}} D_{0}}{K} = D(\\alpha)\\frac{\\alpha}{K}\n$$\n$$\n\\alpha_{\\text{src}} D_{0} = D(\\alpha)\\,\\alpha\n$$\n现在，将(1)中$D(\\alpha)$的表达式代入此方程：\n$$\n\\alpha_{\\text{src}} D_{0} = D_{0}\\left[1 + \\dfrac{\\alpha - \\alpha_{\\text{crit}}(s)}{\\Delta}\\right]\\alpha\n$$\n基准扩散系数$D_{0}$被消去：\n$$\n\\alpha_{\\text{src}} = \\left(1 + \\frac{\\alpha - \\alpha_{\\text{crit}}(s)}{\\Delta}\\right)\\alpha\n$$\n为求解弛豫后的$\\alpha$值，我们将其重排成一个二次方程。为简化符号，令$\\alpha_{c} = \\alpha_{\\text{crit}}(s)$。\n$$\n\\Delta\\alpha_{\\text{src}} = \\left(\\Delta + \\alpha - \\alpha_{c}\\right)\\alpha = \\Delta\\alpha + \\alpha^{2} - \\alpha_{c}\\alpha\n$$\n$$\n\\alpha^{2} + (\\Delta - \\alpha_{c})\\alpha - \\Delta\\alpha_{\\text{src}} = 0\n$$\n解此二次方程求$\\alpha$：\n$$\n\\alpha = \\frac{-(\\Delta - \\alpha_{c}) \\pm \\sqrt{(\\Delta - \\alpha_{c})^{2} - 4(1)(-\\Delta\\alpha_{\\text{src}})}}{2}\n$$\n$$\n\\alpha = \\frac{\\alpha_{c} - \\Delta \\pm \\sqrt{(\\Delta - \\alpha_{c})^{2} + 4\\Delta\\alpha_{\\text{src}}}}{2}\n$$\n弛豫后的$\\alpha$必须是一个正实数。由于$\\Delta0$且$\\alpha_{\\text{src}}0$，平方根下的项总是正的。$\\sqrt{(\\Delta - \\alpha_{c})^{2} + 4\\Delta\\alpha_{\\text{src}}}$这一项严格大于$|\\Delta - \\alpha_{c}|$。如果我们取负号，$\\alpha = \\frac{\\alpha_{c} - \\Delta - \\sqrt{(\\Delta - \\alpha_{c})^{2} + 4\\Delta\\alpha_{\\text{src}}}}{2}$的结果将是负的。因此，为得到有物理意义的解，我们必须选择正号。\n$$\n\\alpha = \\frac{\\alpha_{\\text{crit}}(s) - \\Delta + \\sqrt{(\\Delta - \\alpha_{\\text{crit}}(s))^{2} + 4\\Delta\\alpha_{\\text{src}}}}{2}\n$$\n\n### 第三部分：弛豫后$\\alpha$的数值计算\n\n我们给定的参数为$s=0.8$，$\\alpha_{\\text{src}}=1.8$和$\\Delta=0.6$。\n\n首先，我们计算$s=0.8$时的临界阈值$\\alpha_{\\text{crit}}(s)$：\n$$\n\\alpha_{\\text{crit}}(0.8) = \\frac{1}{4}\\left(1 + \\sqrt{1 + 16(0.8)^{2}}\\right) = \\frac{1}{4}\\left(1 + \\sqrt{1 + 16(0.64)}\\right)\n$$\n$$\n\\alpha_{\\text{crit}}(0.8) = \\frac{1}{4}\\left(1 + \\sqrt{1 + 10.24}\\right) = \\frac{1}{4}\\left(1 + \\sqrt{11.24}\\right)\n$$\n数值上，$\\sqrt{11.24} \\approx 3.3526109$。\n$$\n\\alpha_{\\text{crit}}(0.8) \\approx \\frac{1 + 3.3526109}{4} = \\frac{4.3526109}{4} \\approx 1.0881527\n$$\n我们用$\\alpha_{c}$表示这个值。由于$\\alpha_{\\text{src}} = 1.8  \\alpha_{c}$，系统处于输运增强区，与第二部分的假设一致。\n\n现在，我们将$\\alpha_{c} \\approx 1.0881527$，$\\Delta=0.6$和$\\alpha_{\\text{src}}=1.8$代入弛豫后$\\alpha$的表达式中：\n$$\n\\alpha = \\frac{\\alpha_{c} - \\Delta + \\sqrt{(\\Delta - \\alpha_{c})^{2} + 4\\Delta\\alpha_{\\text{src}}}}{2}\n$$\n我们计算各项：\n$$\n\\alpha_{c} - \\Delta \\approx 1.0881527 - 0.6 = 0.4881527\n$$\n$$\n\\Delta - \\alpha_{c} \\approx 0.6 - 1.0881527 = -0.4881527\n$$\n$$\n(\\Delta - \\alpha_{c})^{2} \\approx (-0.4881527)^{2} \\approx 0.2382931\n$$\n$$\n4\\Delta\\alpha_{\\text{src}} = 4(0.6)(1.8) = 2.4(1.8) = 4.32\n$$\n平方根下的项是：\n$$\n0.2382931 + 4.32 = 4.5582931\n$$\n其平方根是：\n$$\n\\sqrt{4.5582931} \\approx 2.1350159\n$$\n现在，代回$\\alpha$的表达式中：\n$$\n\\alpha \\approx \\frac{0.4881527 + 2.1350159}{2} = \\frac{2.6231686}{2} \\approx 1.3115843\n$$\n将最终结果四舍五入到四位有效数字可得：\n$$\n\\alpha \\approx 1.312\n$$",
            "answer": "$$\\boxed{1.312}$$"
        },
        {
            "introduction": "在理解了临界梯度和刚性输运的概念之后，下一个练习将让您模拟等离子体接近这个稳定性边界的动态过程。您将通过编写一个数值求解器，来追踪在外部加热作用下等离子体压力梯度的演化，同时模型中会包含湍流输运造成的能量损失以及电流剪切的稳定化效应()。这个练习提供了一个处理时变模型的实践机会，让您亲身体验加热、输运和宏观不稳定性之间相互竞争的复杂物理图景。",
            "id": "3961793",
            "problem": "你需要实现一个数值求解器，以确定在给定的加热剖面下，等离子体何时穿过动理学气球模阈值，同时在一个简化模型中考虑湍流输运和剪切稳定效应。目标是计算穿越时间和该穿越时间对ExB剪切率的敏感度。该任务被构建为一个关于核心压力的一维常微分方程（ODE），通过一个归一化的压力梯度阈值来监测磁流体力学（MHD）气球模的稳定性。磁流体力学（MHD）通过有效扩散率和剪切修正的阈值与微湍流相耦合。动理学气球模（KBM）是其阈值被监测的不稳定性。电场叉乘磁场剪切率（ExB剪切率）是流剪切稳定微湍流的速率。\n\n从以下基本定律和定义开始：\n- 标量压力 $p(t)$ 的能量平衡由一个线性的源-损失方程建模：\n$$\n\\frac{d p}{d t} = Q(t) - \\frac{\\chi_{\\mathrm{eff}}(\\gamma_E)}{L_p^2}\\,p(t),\n$$\n其中 $Q(t)$ 是一个有效加热率，表示为压力源，单位为帕斯卡/秒，$\\chi_{\\mathrm{eff}}(\\gamma_E)$ 是有效热扩散率，单位为 $\\mathrm{m^2/s}$，$L_p$ 是一个固定的压力梯度长度尺度，单位为 $\\mathrm{m}$，$\\gamma_E$ 是ExB剪切率，单位为 $\\mathrm{s^{-1}}$。\n- 归一化的气球模参数 $\\alpha(t)$（无量纲）由压力梯度建模：\n$$\n\\alpha(t) = \\frac{2 \\mu_0\\, q^2\\, R}{B^2}\\,\\left|\\frac{d p}{d r}\\right| \\approx \\frac{2 \\mu_0\\, q^2\\, R}{B^2}\\,\\frac{p(t)}{L_p},\n$$\n其中 $q$ 是安全因子（无量纲），$R$ 是大半径，单位为 $\\mathrm{m}$，$B$ 是磁场强度，单位为 $\\mathrm{T}$，$\\mu_0$ 是真空磁导率，表示为 $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$。\n- 阿尔芬频率 $\\omega_A$ 定义为\n$$\n\\omega_A = \\frac{v_A}{q R},\\quad v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}},\n$$\n其中 $\\rho$ 是质量密度，单位为 $\\mathrm{kg/m^3}$。\n- 剪切修正的KBM阈值：\n$$\n\\alpha_c(\\gamma_E) = \\alpha_{c0} \\left( 1 + C_{\\mathrm{shear}} \\frac{\\gamma_E}{\\omega_A} \\right),\n$$\n其中 $\\alpha_{c0}$ 是基线阈值（无量纲），$C_{\\mathrm{shear}}$ 是一个无量纲的比例常数。\n- 剪切抑制的有效扩散率：\n$$\n\\chi_{\\mathrm{eff}}(\\gamma_E) = \\frac{\\chi_0}{1 + \\left(\\frac{\\gamma_E}{\\gamma_{\\mathrm{bg}}}\\right)^2},\n$$\n其中 $\\chi_0$ 是基线微湍流扩散率，单位为 $\\mathrm{m^2/s}$，$\\gamma_{\\mathrm{bg}}$ 是背景微湍流率，单位为 $\\mathrm{s^{-1}}$。\n\n你的任务：\n- 对 $p(t)$ 的常微分方程（ODE）进行积分，初始条件为 $p(0) = 0$，计算 $\\alpha(t)$，并在指定的时间窗口 $[0, t_{\\max}]$ 内检测到满足 $\\alpha(t) \\ge \\alpha_c(\\gamma_E)$ 的最小时间 $t_{\\mathrm{cross}}$。如果在该窗口内没有发生穿越，则报告 $t_{\\mathrm{cross}} = -1.0$。\n- 通过对称有限差分计算穿越时间对ExB剪切率的敏感度：\n$$\nS = \\frac{t_{\\mathrm{cross}}(\\gamma_E + \\Delta) - t_{\\mathrm{cross}}(\\gamma_E - \\Delta)}{2 \\Delta}.\n$$\n如果 $t_{\\mathrm{cross}}(\\gamma_E + \\Delta)$ 或 $t_{\\mathrm{cross}}(\\gamma_E - \\Delta)$ 等于 $-1.0$，则报告 $S = 0.0$。\n\n待使用的加热剖面 $Q(t)$：\n- 恒定剖面：\n$$\nQ(t) = Q_0.\n$$\n- 线性斜坡剖面：\n$$\nQ(t) = Q_0 + r t.\n$$\n- 方顶脉冲剖面：\n$$\nQ(t) = Q_0 + A\\, H(t - t_s)\\,H(t_e - t),\n$$\n其中 $H(x)$ 是亥维赛函数，当 $x  0$ 时 $H(x) = 0$，当 $x \\ge 0$ 时 $H(x) = 1$，$A$ 是脉冲幅度，单位为 $\\mathrm{Pa/s}$，$t_s$ 是脉冲开始时间，单位为 $\\mathrm{s}$，$t_e$ 是脉冲结束时间，单位为 $\\mathrm{s}$。\n\n数值方法要求：\n- 使用具有固定步长 $dt$ 的显式时间步长积分（前向欧拉法）。\n- 在每个时间步，使用ODE更新 $p$，计算 $\\alpha(t)$，并检查穿越条件。\n- 时间单位是秒，所有报告的时间必须以秒为单位。\n\n测试套件：\n为以下三种情况提供结果。每种情况都是一个参数元组；你必须严格使用这些值。\n\n案例1（斜坡加热，预期会发生穿越）：\n- $B = 3\\,\\mathrm{T}$, $R = 2.5\\,\\mathrm{m}$, $q = 1.4$, $L_p = 0.3\\,\\mathrm{m}$, $\\rho = 6 \\times 10^{-7}\\,\\mathrm{kg/m^3}$。\n- $\\alpha_{c0} = 0.45$, $C_{\\mathrm{shear}} = 0.3$。\n- $\\chi_0 = 0.7\\,\\mathrm{m^2/s}$, $\\gamma_{\\mathrm{bg}} = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$。\n- 加热：$Q_0 = 8.0 \\times 10^{5}\\,\\mathrm{Pa/s}$, $r = 1.2 \\times 10^{7}\\,\\mathrm{Pa/s^2}$。\n- 剪切：$\\gamma_E = 1.2 \\times 10^{5}\\,\\mathrm{s^{-1}}$, $\\Delta = 3.0 \\times 10^{4}\\,\\mathrm{s^{-1}}$。\n- 积分：$dt = 1.0 \\times 10^{-5}\\,\\mathrm{s}$, $t_{\\max} = 0.40\\,\\mathrm{s}$。\n\n案例2（恒定加热，预期不会发生穿越）：\n- $B = 3\\,\\mathrm{T}$, $R = 2.5\\,\\mathrm{m}$, $q = 1.4$, $L_p = 0.3\\,\\mathrm{m}$, $\\rho = 6 \\times 10^{-7}\\,\\mathrm{kg/m^3}$。\n- $\\alpha_{c0} = 0.45$, $C_{\\mathrm{shear}} = 0.3$。\n- $\\chi_0 = 0.7\\,\\mathrm{m^2/s}$, $\\gamma_{\\mathrm{bg}} = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$。\n- 加热：$Q_0 = 3.0 \\times 10^{5}\\,\\mathrm{Pa/s}$。\n- 剪切：$\\gamma_E = 1.2 \\times 10^{5}\\,\\mathrm{s^{-1}}$, $\\Delta = 3.0 \\times 10^{4}\\,\\mathrm{s^{-1}}$。\n- 积分：$dt = 1.0 \\times 10^{-5}\\,\\mathrm{s}$, $t_{\\max} = 0.40\\,\\mathrm{s}$。\n\n案例3（脉冲加热，预期在高剪切稳定下会发生穿越）：\n- $B = 5\\,\\mathrm{T}$, $R = 3.0\\,\\mathrm{m}$, $q = 1.5$, $L_p = 0.25\\,\\mathrm{m}$, $\\rho = 5 \\times 10^{-7}\\,\\mathrm{kg/m^3}$。\n- $\\alpha_{c0} = 0.50$, $C_{\\mathrm{shear}} = 0.50$。\n- $\\chi_0 = 0.5\\,\\mathrm{m^2/s}$, $\\gamma_{\\mathrm{bg}} = 3.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$。\n- 加热：$Q_0 = 0.0\\,\\mathrm{Pa/s}$, $A = 3.0 \\times 10^{7}\\,\\mathrm{Pa/s}$, $t_s = 0.05\\,\\mathrm{s}$, $t_e = 0.15\\,\\mathrm{s}$。\n- 剪切：$\\gamma_E = 2.0 \\times 10^{5}\\,\\mathrm{s^{-1}}$, $\\Delta = 5.0 \\times 10^{4}\\,\\mathrm{s^{-1}}$。\n- 积分：$dt = 1.0 \\times 10^{-5}\\,\\mathrm{s}$, $t_{\\max} = 0.30\\,\\mathrm{s}$。\n\n最终输出格式：\n你的程序应生成单行输出，包含一个以逗号分隔的列表的列表（每个内部列表是两个浮点数）形式的结果，格式如下\n$$\n\\left[ [t_1, S_1], [t_2, S_2], [t_3, S_3] \\right],\n$$\n其中 $t_i$ 是案例 $i$ 的穿越时间（秒），$S_i$ 是敏感度（秒/秒）。如果在指定窗口内没有穿越，则 $t_i$ 必须为 $-1.0$，$S_i$ 必须为 $0.0$。",
            "solution": "问题陈述已经过严格验证，被认为是合理的。它在一个简化等离子体物理模型中具有科学依据，所有必要的参数和条件都已定义，因此是适定的，并且其表述是客观的。任务是数值求解一个关于等离子体压力的一阶常微分方程（ODE），监测一个磁流体力学（MHD）稳定性判据，并计算稳定性边界穿越时间对一个关键参数的敏感度。\n\n该解决方案遵循以下原则性设计进行实施。\n\n**1. 控制方程和关键参数**\n\n问题的核心在于标量等离子体压力 $p(t)$ 的时间演化，它由线性的源-损失ODE控制：\n$$\n\\frac{d p}{d t} = Q(t) - \\frac{\\chi_{\\mathrm{eff}}(\\gamma_E)}{L_p^2}\\,p(t)\n$$\n在这里，$Q(t)$ 是一个给定的加热源，损失项表示具有有效热扩散率 $\\chi_{\\mathrm{eff}}(\\gamma_E)$ 的湍流能量输运，其作用在固定的梯度长度尺度 $L_p$ 上。初始条件为 $p(0)=0$。\n\nMHD稳定性通过归一化的气球模参数 $\\alpha(t)$ 来监测，该参数与压力 $p(t)$ 线性成正比：\n$$\n\\alpha(t) = K_{\\alpha} \\cdot p(t), \\quad \\text{其中} \\quad K_{\\alpha} = \\frac{2 \\mu_0\\, q^2\\, R}{B^2 L_p}\n$$\n其中 $\\mu_0=4\\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$ 是真空磁导率，$q$ 是安全因子，$R$ 是大半径，$B$ 是磁场强度。\n\n当 $\\alpha(t)$ 超过一个临界阈值 $\\alpha_c$ 时，预测动理学气球模（KBM）会变得不稳定。这个阈值本身依赖于ExB剪切率 $\\gamma_E$，它提供了一种稳定效应：\n$$\n\\alpha_c(\\gamma_E) = \\alpha_{c0} \\left( 1 + C_{\\mathrm{shear}} \\frac{\\gamma_E}{\\omega_A} \\right)\n$$\n此处，$\\alpha_{c0}$ 是基线阈值，$C_{\\mathrm{shear}}$ 是一个无量纲系数，$\\omega_A$ 是阿尔芬频率，定义为 $\\omega_A = v_A / (qR)$，其中阿尔芬速度 $v_A = B/\\sqrt{\\mu_0 \\rho}$。\n\nExB剪切也抑制了微湍流，根据以下模型降低了热扩散率 $\\chi_{\\mathrm{eff}}$：\n$$\n\\chi_{\\mathrm{eff}}(\\gamma_E) = \\frac{\\chi_0}{1 + \\left(\\frac{\\gamma_E}{\\gamma_{\\mathrm{bg}}}\\right)^2}\n$$\n其中 $\\chi_0$ 是基线扩散率，$\\gamma_{\\mathrm{bg}}$ 是一个特征微湍流率。\n\n**2. 数值积分方案**\n\n问题要求使用显式前向欧拉法来对压力ODE进行积分。对于一个时间步长 $dt$，在时间 $t_{n+1} = t_n + dt$ 时的压力 $p_{n+1}$ 是根据在时间 $t_n$ 时的压力 $p_n$ 更新的：\n$$\np_{n+1} = p_n + dt \\left( Q(t_n) - \\frac{\\chi_{\\mathrm{eff}}(\\gamma_E)}{L_p^2}\\,p_n \\right)\n$$\n这等价于 $p_{n+1} = p_n \\left(1 - dt \\frac{\\chi_{\\mathrm{eff}}}{L_p^2}\\right) + dt\\, Q(t_n)$。模拟从 $t_0=0$ 时的 $p_0=0$ 开始。\n\n**3. 穿越时间的算法实现**\n\n对于给定的一组物理和数值参数，包括特定的 $\\gamma_E$ 值，穿越时间 $t_{\\mathrm{cross}}$ 通过以下算法确定：\n\n首先，为了优化计算，预先计算所有在时间积分过程中保持不变的参数。这些包括阿尔芬频率 $\\omega_A$、有效扩散率 $\\chi_{\\mathrm{eff}}(\\gamma_E)$、损失系数 $\\chi_{\\mathrm{eff}}/L_p^2$、稳定性阈值 $\\alpha_c(\\gamma_E)$ 以及比例常数 $K_{\\alpha}$。\n\n接下来，启动一个时间循环，从 $t=0$ 开始，以 $dt$ 为增量，直到 $t_{\\max}$：\n- 在每个时间步 $t_n$，根据指定的剖面（恒定、斜坡或脉冲）评估加热源 $Q(t_n)$。\n- 使用前向欧拉公式计算压力 $p_{n+1}$。\n- 计算气球模参数 $\\alpha_{n+1} = K_{\\alpha} \\cdot p_{n+1}$。\n- 进行检查：如果 $\\alpha_{n+1} \\ge \\alpha_c(\\gamma_E)$，则循环终止，并报告穿越时间为 $t_{\\mathrm{cross}} = t_{n+1} = (n+1)dt$。\n- 如果循环完成而条件未满足，这表示在模拟窗口内没有发生穿越，此时将 $t_{\\mathrm{cross}}$ 设置为 $-1.0$。\n\n此过程被封装在一个名为 `find_crossing_time` 的函数中，该函数接收全套参数并返回计算出的 $t_{\\mathrm{cross}}$。\n\n**4. 敏感度计算**\n\n主要任务不仅要求计算标称 $\\gamma_E$ 的 $t_{\\mathrm{cross}}$，还要求计算其对 $\\gamma_E$ 变化的敏感度 $S$。敏感度由对称有限差分定义：\n$$\nS = \\frac{t_{\\mathrm{cross}}(\\gamma_E + \\Delta) - t_{\\mathrm{cross}}(\\gamma_E - \\Delta)}{2 \\Delta}\n$$\n为了计算每个测试案例的 $S$，`find_crossing_time` 函数被调用三次：\n1.  使用标称剪切率 $\\gamma_E$ 来找到 $t_{\\mathrm{cross, mid}} = t_{\\mathrm{cross}}(\\gamma_E)$。\n2.  使用扰动后的剪切率 $\\gamma_E + \\Delta$ 来找到 $t_{\\mathrm{cross, plus}} = t_{\\mathrm{cross}}(\\gamma_E + \\Delta)$。\n3.  使用扰动后的剪切率 $\\gamma_E - \\Delta$ 来找到 $t_{\\mathrm{cross, minus}} = t_{\\mathrm{cross}}(\\gamma_E - \\Delta)$。\n\n然后根据 $t_{\\mathrm{cross, plus}}$ 和 $t_{\\mathrm{cross, minus}}$ 计算敏感度 $S$。按照问题规范，如果这两个扰动运行的穿越时间中任何一个为 $-1.0$，则敏感度 $S$ 设置为 $0.0$。\n\n整个过程由一个 `solve_case` 函数管理，该函数协调对 `find_crossing_time` 的三次调用，并计算最终的结果对 $[t_{\\mathrm{cross, mid}}, S]$。一个主函数 `solve` 遍历三个指定的测试案例，为每个案例调用 `solve_case`，并将汇总的结果格式化为所需的输出字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the three test cases specified in the problem.\n    \"\"\"\n    \n    # Global constant for vacuum permeability in N/A^2\n    MU0 = 4 * np.pi * 1e-7\n\n    def find_crossing_time(params, heating_params, gamma_E_val):\n        \"\"\"\n        Integrates the pressure ODE and finds the KBM threshold crossing time.\n\n        Args:\n            params (tuple): A tuple of physical and integration parameters.\n            heating_params (dict): A dictionary defining the heating profile.\n            gamma_E_val (float): The specific ExB shearing rate for this run.\n\n        Returns:\n            float: The crossing time t_cross in seconds, or -1.0 if no crossing.\n        \"\"\"\n        (B, R, q, Lp, rho,\n         alpha_c0, C_shear,\n         chi0, gamma_bg,\n         _, _, # gamma_E and Delta from the case are not used here\n         dt, t_max) = params\n\n        # --- Pre-calculate constant values for the simulation ---\n        \n        # Alfvén speed and frequency\n        v_A = B / np.sqrt(MU0 * rho)\n        omega_A = v_A / (q * R)\n\n        # Shear-suppressed diffusivity and loss coefficient\n        chi_eff = chi0 / (1 + (gamma_E_val / gamma_bg)**2)\n        loss_coeff = chi_eff / (Lp**2)\n\n        # Shear-modified KBM threshold\n        alpha_c = alpha_c0 * (1 + C_shear * gamma_E_val / omega_A)\n        \n        # Proportionality constant for alpha\n        alpha_factor = (2 * MU0 * q**2 * R) / (B**2 * Lp)\n\n        # --- Time integration loop (Forward Euler) ---\n        p = 0.0\n        num_steps = int(t_max / dt)\n        heating_type = heating_params['type']\n\n        for i in range(num_steps):\n            t = i * dt\n            \n            # Calculate heating source Q(t)\n            if heating_type == 'constant':\n                Q_t = heating_params['Q0']\n            elif heating_type == 'ramp':\n                Q_t = heating_params['Q0'] + heating_params['r'] * t\n            elif heating_type == 'pulse':\n                pulse = 0.0\n                if heating_params['t_s'] = t and t = heating_params['t_e']:\n                    pulse = heating_params['A']\n                Q_t = heating_params['Q0'] + pulse\n            \n            # Euler step for pressure p(t)\n            p += (Q_t - loss_coeff * p) * dt\n            \n            # Calculate alpha at time t + dt\n            current_alpha = alpha_factor * p\n\n            # Check crossing condition\n            if current_alpha >= alpha_c:\n                return (i + 1) * dt\n        \n        # No crossing found within t_max\n        return -1.0\n\n    def solve_case(case_params, heating_params):\n        \"\"\"\n        Solves a single case, calculating crossing time and sensitivity.\n\n        Args:\n            case_params (tuple): Parameters for the specific case.\n            heating_params (dict): Heating profile for the case.\n\n        Returns:\n            list: A list [t_cross, S] with the results.\n        \"\"\"\n        gamma_E = case_params[9]\n        Delta = case_params[10]\n\n        # Find crossing time for the central gamma_E\n        t_mid = find_crossing_time(case_params, heating_params, gamma_E)\n\n        # Find crossing time for gamma_E + Delta\n        t_plus = find_crossing_time(case_params, heating_params, gamma_E + Delta)\n\n        # Find crossing time for gamma_E - Delta\n        t_minus = find_crossing_time(case_params, heating_params, gamma_E - Delta)\n        \n        # Calculate sensitivity S\n        if t_plus == -1.0 or t_minus == -1.0:\n            S = 0.0\n        else:\n            S = (t_plus - t_minus) / (2 * Delta)\n            \n        return [t_mid, S]\n    \n    # Define the test cases from the problem statement.\n    case1_params = (3.0, 2.5, 1.4, 0.3, 6e-7,\n                    0.45, 0.3, 0.7, 2.0e5,\n                    1.2e5, 3.0e4, 1.0e-5, 0.40)\n    case1_heating = {'type': 'ramp', 'Q0': 8.0e5, 'r': 1.2e7}\n\n    case2_params = (3.0, 2.5, 1.4, 0.3, 6e-7,\n                    0.45, 0.3, 0.7, 2.0e5,\n                    1.2e5, 3.0e4, 1.0e-5, 0.40)\n    case2_heating = {'type': 'constant', 'Q0': 3.0e5}\n\n    case3_params = (5.0, 3.0, 1.5, 0.25, 5e-7,\n                    0.50, 0.50, 0.5, 3.0e5,\n                    2.0e5, 5.0e4, 1.0e-5, 0.30)\n    case3_heating = {'type': 'pulse', 'Q0': 0.0, 'A': 3.0e7, 't_s': 0.05, 't_e': 0.15}\n\n    test_cases = [\n        (case1_params, case1_heating),\n        (case2_params, case2_heating),\n        (case3_params, case3_heating)\n    ]\n\n    results = []\n    for case_p, heat_p in test_cases:\n        result = solve_case(case_p, heat_p)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后的练习将带您进入多尺度模拟的前沿，解决一个在计算聚变科学中至关重要的问题：如何将一个局部的、高保真度的回旋动理学模型与一个全局的、流体的磁流体动力学模型耦合起来。本练习的核心任务是为两个模型之间的界面定义必要的边界条件，确保电磁势的连续性，并一致地计算由微观湍流产生的输运通量()。完成这项任务，相当于模拟了开发先进多物理模拟工具中的一个关键步骤。",
            "id": "3961718",
            "problem": "一个局域回旋动理学模型和一个全局磁流体动力学模型必须在一个由磁通面和极向角标记的界面上进行耦合。该耦合要求静电势和磁矢势的平行分量保持一致，同时也要求湍流输运通量保持一致。你需要实现一个程序，为每个测试用例计算必要的界面变量和边界条件，以便将一个局域回旋动理学求解器与一个全局磁流体动力学程序耦合起来，同时对平行电场施加一个具有物理动机的约束。\n\n假设存在以下背景和定义。回旋动理学侧在界面上提供了一个局域直线磁力线坐标 $ \\theta $ 上的涨落形状：\n- 静电势形状为 $ \\hat{\\phi}(\\theta) = \\phi_0 \\cos(\\theta + \\delta_\\phi) $。\n- 平行磁矢势形状为 $ \\hat{A}_\\parallel(\\theta) = A_0 \\cos(\\theta + \\delta_A) $。\n\n假设存在角频率为 $ \\omega  0 $ 的时间谐波涨落，因此瞬时场为 $ \\phi(\\theta,t) = s \\hat{\\phi}(\\theta) \\cos(\\omega t) + c_\\phi $ 和 $ A_\\parallel(\\theta,t) = s \\hat{A}_\\parallel(\\theta) \\cos(\\omega t) + c_{A_\\parallel} $，其中 $ s $ 是应用于回旋动理学形状的实数标度因子，$ c_\\phi $ 和 $ c_{A_\\parallel} $ 是为匹配全局磁流体动力学界面值而设置的不依赖于时间的规范偏移量。设界面上沿磁场的平行梯度算子近似为 $ \\nabla_\\parallel \\approx \\alpha \\, \\partial/\\partial \\theta $，其中 $ \\alpha $ 是一个依赖于平衡位形的常数度规系数。全局磁流体动力学模型在特定极向角 $ \\theta_0 $ 和匹配时间 $ t_0 $ 处给定界面值 $ \\phi_{\\mathrm{MHD},0} $、$ A_{\\parallel,\\mathrm{MHD},0} $ 以及一个目标瞬时平行电场 $ E_{\\parallel,\\mathrm{MHD},0} $。\n\n强制执行平行电场的麦克斯韦-法拉第方程一致性，\n$$\nE_\\parallel(\\theta,t) = -\\frac{\\partial A_\\parallel(\\theta,t)}{\\partial t} - \\nabla_\\parallel \\phi(\\theta,t),\n$$\n在匹配时间 $ t_0 $ 处，该时间的选择满足 $ \\cos(\\omega t_0) = 0 $ 和 $ \\sin(\\omega t_0) = 1 $（即 $ t_0 = \\pi/(2\\omega) $）。在此选择下，平行电场在 $ (\\theta_0,t_0) $ 处简化为\n$$\nE_\\parallel(\\theta_0,t_0) = \\omega \\, s \\, \\hat{A}_\\parallel(\\theta_0),\n$$\n这绕过了由 $ c_\\phi $ 和 $ c_{A_\\parallel} $ 引起的规范模糊性，并分离出感应贡献。为满足界面上平行电场的连续性，设置\n$$\ns = \\begin{cases}\n\\frac{E_{\\parallel,\\mathrm{MHD},0}}{\\omega \\, \\hat{A}_\\parallel(\\theta_0)},   \\text{如果 } \\hat{A}_\\parallel(\\theta_0) \\neq 0, \\\\\n0,   \\text{如果 } \\hat{A}_\\parallel(\\theta_0) = 0,\n\\end{cases}\n$$\n并通过取规范偏移量\n$$\nc_\\phi = \\phi_{\\mathrm{MHD},0}, \\qquad c_{A_\\parallel} = A_{\\parallel,\\mathrm{MHD},0}\n$$\n来强制在 $ (\\theta_0,t_0) $ 处的数值匹配。\n这确保了 $ \\phi(\\theta_0,t_0) = \\phi_{\\mathrm{MHD},0} $ 和 $ A_\\parallel(\\theta_0,t_0) = A_{\\parallel,\\mathrm{MHD},0} $，同时以对局域回旋动理学形状侵入性最小的方式匹配了 $ E_\\parallel(\\theta_0,t_0) $。定义一个界面连续性误差\n$$\n\\varepsilon = \\left| \\omega \\, s \\, \\hat{A}_\\parallel(\\theta_0) - E_{\\parallel,\\mathrm{MHD},0} \\right|,\n$$\n该误差用于量化由简并性或有限精度引起的任何残余失配。\n\n对于输运，采用一个准线性、无量纲模型，将湍流扩散系数与静电势相关的 $ \\mathbf{E}\\times\\mathbf{B} $ 速度振幅的平方联系起来，\n$$\n\\chi_t = \\beta \\, s^2 \\, \\phi_0^2,\n$$\n其中 $ \\beta $ 是一个反映局域几何和饱和物理的无量纲比例因子。然后使用菲克定律和给定的无量纲梯度 $ g_n $ 和 $ g_T $ 计算无量纲粒子通量 $ \\Gamma $ 和热通量 $ Q $：\n$$\n\\Gamma = -\\chi_t \\, g_n, \\qquad Q = -\\chi_t \\, g_T.\n$$\n\n本问题中所有量均为无量纲；角度以弧度为单位。你的程序必须为每个测试用例计算并输出列表\n$$\n\\left[ \\, \\phi(\\theta_0,t_0), \\; A_\\parallel(\\theta_0,t_0), \\; \\Gamma, \\; Q, \\; \\varepsilon \\, \\right].\n$$\n将所有测试用例的输出汇总到单行中，作为一个用方括号括起来的逗号分隔列表，其中每个元素是该测试用例的列表。不得打印任何额外文本。\n\n针对以下参数值的测试套件实现上述过程，其中每个测试用例提供一个元组\n$$\n\\left( \\phi_0, \\; \\delta_\\phi, \\; A_0, \\; \\delta_A, \\; \\omega, \\; \\alpha, \\; \\theta_0, \\; \\beta, \\; g_n, \\; g_T, \\; \\phi_{\\mathrm{MHD},0}, \\; A_{\\parallel,\\mathrm{MHD},0}, \\; E_{\\parallel,\\mathrm{MHD},0} \\right).\n$$\n\n- 测试用例 1（一般一致性情况）：\n  - $ \\phi_0 = 0.8 $, $ \\delta_\\phi = 0.3 $, $ A_0 = 0.6 $, $ \\delta_A = -0.2 $, $ \\omega = 3.0 $, $ \\alpha = 0.5 $, $ \\theta_0 = 1.2 $, $ \\beta = 0.1 $, $ g_n = 0.7 $, $ g_T = 1.1 $, $ \\phi_{\\mathrm{MHD},0} = 0.05 $, $ A_{\\parallel,\\mathrm{MHD},0} = -0.02 $, $ E_{\\parallel,\\mathrm{MHD},0} = 0.18 $。\n\n- 测试用例 2（$ \\hat{A}_\\parallel(\\theta_0) = 0 $ 的简并感应耦合情况）：\n  - $ \\phi_0 = 1.0 $, $ \\delta_\\phi = 0.0 $, $ A_0 = 0.0 $, $ \\delta_A = 0.0 $, $ \\omega = 2.5 $, $ \\alpha = 0.5 $, $ \\theta_0 = 0.7 $, $ \\beta = 0.2 $, $ g_n = 0.5 $, $ g_T = 0.9 $, $ \\phi_{\\mathrm{MHD},0} = 0.0 $, $ A_{\\parallel,\\mathrm{MHD},0} = 0.1 $, $ E_{\\parallel,\\mathrm{MHD},0} = 0.05 $。\n\n- 测试用例 3（产生负标度因子 $ s $ 的大振幅、相移情况）：\n  - $ \\phi_0 = 1.2 $, $ \\delta_\\phi = 0.8 $, $ A_0 = 0.9 $, $ \\delta_A = 0.5 $, $ \\omega = 4.0 $, $ \\alpha = 0.6 $, $ \\theta_0 = 2.2 $, $ \\beta = 0.15 $, $ g_n = 1.3 $, $ g_T = 0.8 $, $ \\phi_{\\mathrm{MHD},0} = -0.03 $, $ A_{\\parallel,\\mathrm{MHD},0} = 0.04 $, $ E_{\\parallel,\\mathrm{MHD},0} = 0.27 $。\n\n- 测试用例 4（目标 $ E_{\\parallel,\\mathrm{MHD},0} $ 为负的高频情况）：\n  - $ \\phi_0 = 0.5 $, $ \\delta_\\phi = -0.4 $, $ A_0 = 0.4 $, $ \\delta_A = 1.1 $, $ \\omega = 10.0 $, $ \\alpha = 0.7 $, $ \\theta_0 = 0.2 $, $ \\beta = 0.12 $, $ g_n = 0.2 $, $ g_T = 0.4 $, $ \\phi_{\\mathrm{MHD},0} = 0.02 $, $ A_{\\parallel,\\mathrm{MHD},0} = -0.03 $, $ E_{\\parallel,\\mathrm{MHD},0} = -0.5 $。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个列表 $ [ \\phi(\\theta_0,t_0), A_\\parallel(\\theta_0,t_0), \\Gamma, Q, \\varepsilon ] $。所有输出必须是无量纲浮点数，角度以弧度为单位。",
            "solution": "目标是计算连接局域回旋动理学描述与全局磁流体动力学描述的一致性界面变量。该耦合依赖于麦克斯韦-法拉第定律，以及静电势和磁矢势平行分量数值的匹配，同时还需传递一致的湍流输运通量。\n\n我们从基本电磁学原理开始。电场的平行分量源于麦克斯韦-法拉第定律，\n$$\n\\mathbf{E} = -\\frac{\\partial \\mathbf{A}}{\\partial t} - \\nabla \\phi,\n$$\n界面平行分量为\n$$\nE_\\parallel(\\theta,t) = -\\frac{\\partial A_\\parallel(\\theta,t)}{\\partial t} - \\nabla_\\parallel \\phi(\\theta,t).\n$$\n对于圆形、大环径比托卡马克，可以定义一个直线磁力线极向坐标 $ \\theta $ 来捕捉沿磁力线的变化。在局域上，我们用一个常数度规因子来近似平行梯度\n$$\n\\nabla_\\parallel \\approx \\alpha \\, \\frac{\\partial}{\\partial \\theta},\n$$\n从而使得 $ \\theta $ 中的形状导数能反映平行梯度。\n\n在回旋动理学一侧，局域涨落形状由下式给出\n$$\n\\hat{\\phi}(\\theta) = \\phi_0 \\cos(\\theta + \\delta_\\phi), \\qquad \\hat{A}_\\parallel(\\theta) = A_0 \\cos(\\theta + \\delta_A).\n$$\n我们将它们通过一个单一的实数标度因子 $ s $ 和不依赖于时间的偏移量 $ c_\\phi $ 和 $ c_{A_\\parallel} $ 嵌入到瞬时界面场中：\n$$\n\\phi(\\theta,t) = s \\hat{\\phi}(\\theta) \\cos(\\omega t) + c_\\phi, \\qquad A_\\parallel(\\theta,t) = s \\hat{A}_\\parallel(\\theta) \\cos(\\omega t) + c_{A_\\parallel},\n$$\n其中 $ \\omega $ 是微观湍流涨落的角频率。这些偏移量用于弥补局域回旋动理学表示与界面上的全局磁流体动力学场之间的规范和平均场差异。\n\n为实现一致耦合且避免静电规范带来的模糊性，选择匹配时间 $ t_0 $，使其满足 $ \\cos(\\omega t_0) = 0 $ 和 $ \\sin(\\omega t_0) = 1 $，即\n$$\nt_0 = \\frac{\\pi}{2\\omega}.\n$$\n在此时间，固定极向角 $ \\theta_0 $ 处的瞬时平行电场简化为感应贡献\n$$\nE_\\parallel(\\theta_0,t_0) = \\omega \\, s \\, \\hat{A}_\\parallel(\\theta_0),\n$$\n因为 $ \\partial_t (s \\hat{A}_\\parallel \\cos \\omega t)|_{t_0} = -\\omega s \\hat{A}_\\parallel \\sin(\\omega t_0) = -\\omega s \\hat{A}_\\parallel $，且麦克斯韦-法拉第定律中有一个额外的负号，得到 $ \\omega s \\hat{A}_\\parallel $，而 $ \\nabla_\\parallel \\phi(\\theta_0,t_0) = \\alpha \\, \\partial_\\theta (s \\hat{\\phi} \\cos \\omega t)|_{t_0} = 0 $ 是由于 $ \\cos(\\omega t_0)=0 $，并且规范偏移量的导数消失，因为 $ c_\\phi $ 不依赖于时间且在 $ \\theta $ 上空间均匀。\n\n因此，我们通过选择\n$$\ns = \\frac{E_{\\parallel,\\mathrm{MHD},0}}{\\omega \\, \\hat{A}_\\parallel(\\theta_0)} \\quad \\text{如果 } \\hat{A}_\\parallel(\\theta_0) \\neq 0,\n$$\n来强制界面上平行电场的连续性，否则当 $ \\hat{A}_\\parallel(\\theta_0) = 0 $ 时设置 $ s = 0 $，这反映了在此单标度因子模型内，无法从一个消失的 $ \\hat{A}_\\parallel(\\theta_0) $ 来构建 $ t_0 $ 时刻的感应匹配。残余失配由下式量化\n$$\n\\varepsilon = \\left| \\omega \\, s \\, \\hat{A}_\\parallel(\\theta_0) - E_{\\parallel,\\mathrm{MHD},0} \\right|.\n$$\n通过设置规范偏移量\n$$\nc_\\phi = \\phi_{\\mathrm{MHD},0}, \\qquad c_{A_\\parallel} = A_{\\parallel,\\mathrm{MHD},0},\n$$\n来强制 $ (\\theta_0, t_0) $ 处的数值连续性，这自然地得到\n$$\n\\phi(\\theta_0,t_0) = c_\\phi = \\phi_{\\mathrm{MHD},0}, \\qquad A_\\parallel(\\theta_0,t_0) = c_{A_\\parallel} = A_{\\parallel,\\mathrm{MHD},0}.\n$$\n\n对于输运耦合，我们从标准的准线性直觉出发，即湍流扩散系数 $ \\chi_t $ 与静电势相关的 $ \\mathbf{E}\\times\\mathbf{B} $ 速度的平方成比例。在无量纲形式下，我们使用\n$$\n\\chi_t = \\beta \\, s^2 \\, \\phi_0^2,\n$$\n其中 $ \\beta $ 是一个无量纲比例常数。利用给定的密度和温度的无量纲梯度 $ g_n $ 和 $ g_T $，菲克定律给出了粒子和热通量，\n$$\n\\Gamma = -\\chi_t \\, g_n, \\qquad Q = -\\chi_t \\, g_T.\n$$\n\n在算法上，对每个测试用例，我们执行以下步骤：\n1. 计算 $ \\hat{A}_\\parallel(\\theta_0) = A_0 \\cos(\\theta_0 + \\delta_A) $。\n2. 如果对于一个小的阈值 $\\epsilon$ 有 $|\\hat{A}_\\parallel(\\theta_0)|  \\epsilon$，则设置 $ s = E_{\\parallel,\\mathrm{MHD},0} / (\\omega \\hat{A}_\\parallel(\\theta_0)) $。否则设置 $ s = 0 $。\n3. 取 $ c_\\phi = \\phi_{\\mathrm{MHD},0} $ 和 $ c_{A_\\parallel} = A_{\\parallel,\\mathrm{MHD},0} $。\n4. 在 $ (\\theta_0,t_0) $ 处的界面值为 $ \\phi(\\theta_0,t_0) = c_\\phi $ 和 $ A_\\parallel(\\theta_0,t_0) = c_{A_\\parallel} $。\n5. 计算 $ \\chi_t = \\beta \\, s^2 \\, \\phi_0^2 $，然后计算 $ \\Gamma = -\\chi_t \\, g_n $ 和 $ Q = -\\chi_t \\, g_T $。\n6. 计算连续性误差 $ \\varepsilon = \\left| \\omega \\, s \\, \\hat{A}_\\parallel(\\theta_0) - E_{\\parallel,\\mathrm{MHD},0} \\right| $。\n\n每个测试用例的输出是列表 $ [ \\phi(\\theta_0,t_0), A_\\parallel(\\theta_0,t_0), \\Gamma, Q, \\varepsilon ] $。这些步骤产生确定性的、可复现的输出，并覆盖了重要的边界情况：一般非简并情况、在匹配角度处感应形状消失、相位引起的负标度因子，以及目标平行电场为负的高频匹配。所有量均为无量纲，角度以弧度为单位，这一点已明确说明。最终输出将所有测试用例的结果汇总到包含列表的列表的单行中，符合要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_interface(phi0, dphi, A0, dA, omega, alpha, theta0, beta, g_n, g_T,\n                      phi_MHD0, Apar_MHD0, Epar_MHD0):\n    # Compute local GK shapes at theta0\n    Ahat_theta0 = A0 * np.cos(theta0 + dA)\n    # Scaling to match E_parallel at t0 where cos(omega t0)=0, sin(omega t0)=1\n    eps = 1e-12\n    if abs(Ahat_theta0) > eps:\n        s = Epar_MHD0 / (omega * Ahat_theta0)\n    else:\n        s = 0.0\n    # Gauge offsets to match instantaneous values at (theta0, t0)\n    c_phi = phi_MHD0\n    c_Apar = Apar_MHD0\n    # Interface values at (theta0, t0)\n    phi_interface = c_phi\n    Apar_interface = c_Apar\n    # Turbulent diffusivity and fluxes (dimensionless)\n    chi_t = beta * (s ** 2) * (phi0 ** 2)\n    Gamma = -chi_t * g_n\n    Q = -chi_t * g_T\n    # Continuity error for E_parallel at (theta0, t0)\n    Epar_computed = omega * s * Ahat_theta0\n    error = abs(Epar_computed - Epar_MHD0)\n    return [float(phi_interface), float(Apar_interface), float(Gamma), float(Q), float(error)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (phi0, dphi, A0, dA, omega, alpha, theta0, beta, g_n, g_T, phi_MHD0, Apar_MHD0, Epar_MHD0)\n    test_cases = [\n        (0.8, 0.3, 0.6, -0.2, 3.0, 0.5, 1.2, 0.1, 0.7, 1.1, 0.05, -0.02, 0.18),\n        (1.0, 0.0, 0.0, 0.0, 2.5, 0.5, 0.7, 0.2, 0.5, 0.9, 0.0, 0.1, 0.05),\n        (1.2, 0.8, 0.9, 0.5, 4.0, 0.6, 2.2, 0.15, 1.3, 0.8, -0.03, 0.04, 0.27),\n        (0.5, -0.4, 0.4, 1.1, 10.0, 0.7, 0.2, 0.12, 0.2, 0.4, 0.02, -0.03, -0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        phi0, dphi, A0, dA, omega, alpha, theta0, beta, g_n, g_T, phi_MHD0, Apar_MHD0, Epar_MHD0 = case\n        res = compute_interface(phi0, dphi, A0, dA, omega, alpha, theta0, beta, g_n, g_T,\n                                phi_MHD0, Apar_MHD0, Epar_MHD0)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    # Single line with the aggregated list of results for all test cases.\n    print(f\"[{','.join('[' + ','.join(map(str, r)) + ']' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}