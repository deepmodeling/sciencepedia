{
    "hands_on_practices": [
        {
            "introduction": "引导中心近似是研究高能粒子输运的基石，它极大地简化了带电粒子在复杂磁场中运动的分析。然而，应用此近似之前，我们必须检验其有效性。本练习旨在通过计算关键的无量纲参数，例如拉莫尔半径与系统尺寸之比 $\\rho/a$ 以及与磁场梯度标长之比 $\\rho/L_B$，来量化引导中心近似的适用范围 。掌握这种评估模型假设的能力，对于任何从事等离子体模拟的科研人员来说都至关重要。",
            "id": "3973328",
            "problem": "一个大环径比的圆形托卡马克被模型化，其大半径为 $R_0$，小半径为 $a$。环向磁场取为 $B_{\\mathrm{t}}(R) = B_0 R_0 / R$，其中 $R$ 是大半径坐标。考虑一个能量为 $1.0\\ \\mathrm{MeV}$ 的阿尔法粒子，位于外侧中平面的边缘，其位置在 $R_{\\mathrm{edge}} = R_0 + a$。假设以下参数：$R_0 = 3.0\\ \\mathrm{m}$，$a = 0.6\\ \\mathrm{m}$，$B_0 = 2.8\\ \\mathrm{T}$，阿尔法粒子电荷 $q_{\\alpha} = 2e$，阿尔法粒子质量 $m_{\\alpha} = 6.644657 \\times 10^{-27}\\ \\mathrm{kg}$，以及外侧中平面处的相对环向场波纹振幅 $\\delta B / B = 8.0 \\times 10^{-3}$。该粒子在外侧中平面的螺距角为 $\\alpha = 60^\\circ$。角度必须以度为单位处理。\n\n从带电粒子在磁场中运动的第一性原理和非相对论动能关系出发，计算粒子在边缘处的的回旋频率、回旋半径和特征磁场标度长度。使用这些量在 $R_{\\mathrm{edge}}$ 处评估无量纲量 $\\rho/a$、$\\rho/L_B$ 和 $\\delta B/B$，其中 $\\rho$ 是拉莫尔半径，$L_B \\equiv B/|\\nabla B|$ 是磁场梯度标度长度。对于大环径比托卡马克中外侧中平面的磁力线曲率，你可以将曲率标度 $L_c \\equiv 1/|\\hat{\\boldsymbol{b}}\\cdot\\nabla \\hat{\\boldsymbol{b}}|$ 取为 $R_{\\mathrm{edge}}$ 的量级，并据此进行估算。\n\n定义单一的导心小量指标为\n$\\epsilon_{\\mathrm{gc}} \\equiv \\max\\left\\{\\rho/a,\\ \\rho/L_B,\\ \\delta B/B\\right\\}$，\n并将其计算为一个无量纲数。\n\n将你的 $\\epsilon_{\\mathrm{gc}}$ 最终值四舍五入到三位有效数字。最终答案必须是一个不带单位的实数。",
            "solution": "首先对问题陈述进行验证。\n\n### 第1步：提取给定条件\n- 托卡马克大半径：$R_0 = 3.0\\ \\mathrm{m}$\n- 托卡马克小半径：$a = 0.6\\ \\mathrm{m}$\n- 环向磁场模型：$B_{\\mathrm{t}}(R) = B_0 R_0 / R$\n- 轴上磁场：$B_0 = 2.8\\ \\mathrm{T}$\n- 粒子：阿尔法粒子\n- 粒子动能：$K = 1.0\\ \\mathrm{MeV}$\n- 粒子初始位置：外侧中平面边缘，$R_{\\mathrm{edge}} = R_0 + a$\n- 阿尔法粒子电荷：$q_{\\alpha} = 2e$\n- 阿尔法粒子质量：$m_{\\alpha} = 6.644657 \\times 10^{-27}\\ \\mathrm{kg}$\n- 外侧中平面处的相对环向场波纹：$\\delta B / B = 8.0 \\times 10^{-3}$\n- 粒子在外侧中平面的螺距角：$\\alpha = 60^\\circ$\n- 磁场梯度标度长度的定义：$L_B \\equiv B/|\\nabla B|$\n- 导心小量指标的定义：$\\epsilon_{\\mathrm{gc}} \\equiv \\max\\left\\{\\rho/a,\\ \\rho/L_B,\\ \\delta B/B\\right\\}$\n\n### 第2步：使用提取的给定条件进行验证\n该问题在科学上基于成熟的带电粒子在磁场中运动的理论，特别是在托卡马克背景下的导心近似，这是聚变等离子体物理学的核心。所提供的托卡马克模型（$B \\propto 1/R$）是一个标准的大环径比近似。所有参数（尺寸、场强、粒子能量）对于当代的聚变实验都是符合实际的。问题提法得当、客观且自洽，提供了计算所需量所必需的所有物理常数、定义和数据。指示是明确的。该问题不违反任何科学原理，不包含矛盾，也不依赖于主观论断。\n\n### 第3步：结论与行动\n问题被评估为 **有效**。将提供完整解答。\n\n### 解答推导\n解答过程首先计算在指定位置的粒子物理参数和磁场参数。然后，计算无量纲比率以确定导心小量指标。\n\n首先，我们确定粒子所在位置，即外侧中平面边缘的属性。该点的大半径为：\n$$R_{\\mathrm{edge}} = R_0 + a = 3.0\\ \\mathrm{m} + 0.6\\ \\mathrm{m} = 3.6\\ \\mathrm{m}$$\n此位置的磁场强度由环向场模型给出：\n$$B_{\\mathrm{edge}} = B_{\\mathrm{t}}(R_{\\mathrm{edge}}) = B_0 \\frac{R_0}{R_{\\mathrm{edge}}} = (2.8\\ \\mathrm{T}) \\frac{3.0\\ \\mathrm{m}}{3.6\\ \\mathrm{m}} = 2.8 \\times \\frac{5}{6}\\ \\mathrm{T} = \\frac{7}{3}\\ \\mathrm{T}$$\n\n接下来，我们计算粒子的属性。动能给定为 $K = 1.0\\ \\mathrm{MeV}$。我们使用基本电荷 $e = 1.60217663 \\times 10^{-19}\\ \\mathrm{C}$ 将其转换为焦耳：\n$$K = 1.0 \\times 10^6\\ \\mathrm{eV} \\times (1.60217663 \\times 10^{-19}\\ \\mathrm{J/eV}) = 1.60217663 \\times 10^{-13}\\ \\mathrm{J}$$\n粒子的总速率 $v$ 从非相对论动能关系 $K = \\frac{1}{2} m_{\\alpha} v^2$ 导出：\n$$v = \\sqrt{\\frac{2K}{m_{\\alpha}}} = \\sqrt{\\frac{2(1.60217663 \\times 10^{-13}\\ \\mathrm{J})}{6.644657 \\times 10^{-27}\\ \\mathrm{kg}}} \\approx 6.944 \\times 10^6\\ \\mathrm{m/s}$$\n垂直于磁场的速度分量 $v_{\\perp}$ 由螺距角 $\\alpha = 60^\\circ$ 确定：\n$$v_{\\perp} = v \\sin(\\alpha) = v \\sin(60^\\circ)$$\n\n问题要求计算回旋频率、回旋半径和磁场标度长度。\n\n回旋（或陀螺）频率 $\\omega_c$ 由下式给出：\n$$\\omega_c = \\frac{|q_{\\alpha}| B}{m_{\\alpha}}$$\n在边缘位置，使用 $|q_\\alpha| = 2e$：\n$$\\omega_{c, \\mathrm{edge}} = \\frac{2e B_{\\mathrm{edge}}}{m_{\\alpha}} = \\frac{2(1.60217663 \\times 10^{-19}\\ \\mathrm{C}) (\\frac{7}{3}\\ \\mathrm{T})}{6.644657 \\times 10^{-27}\\ \\mathrm{kg}} \\approx 1.125 \\times 10^8\\ \\mathrm{rad/s}$$\n\n回旋半径（或拉莫尔半径）$\\rho$ 是粒子围绕磁力线做圆周运动的半径：\n$$\\rho = \\frac{m_{\\alpha} v_{\\perp}}{|q_{\\alpha}| B}$$\n代入 $v_{\\perp} = v \\sin(\\alpha)$ 和 $v = \\sqrt{2K/m_{\\alpha}}$：\n$$\\rho = \\frac{m_{\\alpha}}{|q_{\\alpha}| B} \\left(\\sqrt{\\frac{2K}{m_{\\alpha}}} \\sin(\\alpha)\\right) = \\frac{\\sqrt{2 K m_{\\alpha}}}{|q_{\\alpha}| B} \\sin(\\alpha)$$\n在边缘处，我们有：\n$$\\rho_{\\mathrm{edge}} = \\frac{\\sqrt{2(1.60217663 \\times 10^{-13}\\ \\mathrm{J})(6.644657 \\times 10^{-27}\\ \\mathrm{kg})}}{2(1.60217663 \\times 10^{-19}\\ \\mathrm{C})(\\frac{7}{3}\\ \\mathrm{T})} \\sin(60^\\circ)$$\n$$\\rho_{\\mathrm{edge}} \\approx 0.053447\\ \\mathrm{m}$$\n\n磁场梯度标度长度为 $L_B \\equiv B/|\\nabla B|$。对于给定的磁场 $B(R) = B_0 R_0 / R$，场的大小仅随 $R$ 变化。其梯度为：\n$$\\nabla B(R) = \\frac{dB}{dR}\\hat{\\boldsymbol{R}} = -\\frac{B_0 R_0}{R^2}\\hat{\\boldsymbol{R}}$$\n其大小为 $|\\nabla B| = \\frac{B_0 R_0}{R^2}$。因此，标度长度简化为：\n$$L_B = \\frac{B(R)}{|\\nabla B(R)|} = \\frac{B_0 R_0 / R}{B_0 R_0 / R^2} = R$$\n在外侧中平面边缘，这变为：\n$$L_{B, \\mathrm{edge}} = R_{\\mathrm{edge}} = 3.6\\ \\mathrm{m}$$\n\n我们现在评估构成导心小量指标 $\\epsilon_{\\mathrm{gc}}$ 的三个无量纲量。\n\n1.  回旋半径与小半径之比，$\\rho/a$：\n    $$\\frac{\\rho_{\\mathrm{edge}}}{a} = \\frac{0.053447\\ \\mathrm{m}}{0.6\\ \\mathrm{m}} \\approx 0.089078$$\n\n2.  回旋半径与磁场梯度标度长度之比，$\\rho/L_B$：\n    $$\\frac{\\rho_{\\mathrm{edge}}}{L_{B, \\mathrm{edge}}} = \\frac{0.053447\\ \\mathrm{m}}{3.6\\ \\mathrm{m}} \\approx 0.014846$$\n\n3.  相对环向场波纹，$\\delta B/B$：\n    这个值是针对感兴趣的位置直接给出的。\n    $$\\frac{\\delta B}{B} = 8.0 \\times 10^{-3} = 0.008$$\n\n最后，我们通过取这三个值的最大值来计算 $\\epsilon_{\\mathrm{gc}}$：\n$$\\epsilon_{\\mathrm{gc}} = \\max\\left\\{\\frac{\\rho}{a}, \\frac{\\rho}{L_B}, \\frac{\\delta B}{B}\\right\\} = \\max\\{0.089078, 0.014846, 0.008\\}$$\n$$\\epsilon_{\\mathrm{gc}} = 0.089078$$\n问题要求将最终结果四舍五入到三位有效数字。\n$$\\epsilon_{\\mathrm{gc}} \\approx 0.0891$$",
            "answer": "$$\\boxed{0.0891}$$"
        },
        {
            "introduction": "在引导中心近似的框架内，我们可以分析导致高能粒子损失的具体物理机制，其中环向场波纹是一种重要的无碰撞损失通道。本练习从第一性原理出发，利用磁矩 $\\mu$ 和能量 $E$ 的守恒定律，推导粒子被离散环向场线圈产生的磁阱捕获的条件 。通过这个实践，你将学会如何运用基本物理定律构建解析模型，以估算一个关键粒子损失通道的量级，这对于理解和优化托卡马克约束性能至关重要。",
            "id": "3973346",
            "problem": "考虑一个大环径比托卡马克，其环向磁场存在由有限数量线圈引起的波纹。我们用单谐波调制来模拟沿磁力线的环向场变化，使得磁场强度的最小值和最大值由 $B_{\\min} = B_{0}(1 - \\delta)$ 和 $B_{\\max} = B_{0}(1 + \\delta)$ 给出，其中 $B_{0}$ 是标称环向场，$\\delta$ 是波纹幅度。假设一个高能粒子进行无碰撞导心运动，并且在 $B_{\\min}$ 和 $B_{\\max}$ 之间，第一绝热不变量（磁矩）和总动能是守恒的。如果一个粒子由于波纹井而在 $B_{\\min}$ 和 $B_{\\max}$ 之间经历磁镜效应，则称该粒子被波纹捕获。\n\n从磁化粒子运动的基本不变量出发，推导一个捕获条件，该条件将在 $B_{\\min}$ 处评估的粒子能量 $E$ 与 $\\delta$ 联系起来。然后，假设在 $B_{\\min}$ 处的粒子螺距角呈各向同性分布，并估算被波纹捕获的粒子所占的份额。最后，对于一个具有代表性的装置，其特征为：大半径 $R_{0} = 3.0\\ \\mathrm{m}$，小半径 $a = 1.0\\ \\mathrm{m}$，标称环向场 $B_{0} = 5.3\\ \\mathrm{T}$，环向场（TF）线圈数 $N = 18$，外侧中平面的波纹幅度 $\\delta = 8.0 \\times 10^{-3}$，以及能量为 $E = 3.5\\ \\mathrm{MeV}$ 的单能聚变阿尔法粒子群，假设任何被波纹捕获的粒子都会立即损失到壁上。在这些假设下，计算该托卡马克的波纹损失份额。将该份额表示为小数，并将最终答案四舍五入到三位有效数字。",
            "solution": "该问题要求推导波纹捕获条件，估算被捕获粒子的份额，并针对一个特定的托卡马克场景进行该份额的数值计算。我们将首先建立粒子在空间变化磁场中被捕获的物理模型。\n\n在无碰撞导心近似下，带电粒子在缓变磁场中的运动有两个关键守恒量：总动能 $E$ 和第一绝热不变量，即磁矩 $\\mu$。\n动能由下式给出：\n$$E = \\frac{1}{2}m v_{\\parallel}^2 + \\frac{1}{2}m v_{\\perp}^2 = \\text{constant}$$\n其中 $m$ 是粒子质量，$v_{\\parallel}$ 是平行于磁场 $\\vec{B}$ 的速度分量，$v_{\\perp}$ 是垂直于 $\\vec{B}$ 的速度分量。\n\n磁矩由下式给出：\n$$\\mu = \\frac{\\frac{1}{2}m v_{\\perp}^2}{B} = \\text{constant}$$\n其中 $B = |\\vec{B}|$ 是磁场强度。\n\n根据 $\\mu$ 的表达式，我们可以将垂直动能写为 $\\frac{1}{2}m v_{\\perp}^2 = \\mu B$。将其代入能量守恒方程，得到：\n$$E = \\frac{1}{2}m v_{\\parallel}^2 + \\mu B$$\n这个方程可以重新整理以求解平行速度：\n$$v_{\\parallel} = \\pm\\sqrt{\\frac{2}{m}(E - \\mu B)}$$\n当粒子的平行速度变为零时，即 $v_{\\parallel} = 0$，称粒子被捕获或发生磁镜反射。这发生在其轨迹上磁场强度达到某个值 $B_{mirror}$ 的特定点。在这个“转折点”，条件是：\n$$E - \\mu B_{mirror} = 0 \\implies B_{mirror} = \\frac{E}{\\mu}$$\n从磁场较弱区域移动到磁场较强区域的粒子，如果场强达到 $B_{mirror}$，将会被反射。\n\n问题描述了一个波纹井，其中磁场在 $B_{\\min}$ 和 $B_{\\max}$ 之间变化。如果一个粒子进入该区域，并且其磁镜点 $B_{mirror}$ 小于或等于该井的最大场强，即 $B_{mirror} \\le B_{\\max}$，则该粒子被波纹捕获。如果 $B_{mirror} > B_{\\max}$，则该粒子是“通行”粒子，不会被波纹捕获。\n\n为了推导捕获条件，我们用粒子在磁场最小值位置 $B_{\\min}$ 处的状态来表示 $\\mu$。粒子的总速率是 $v = \\sqrt{2E/m}$。设在 $B_{\\min}$ 处的螺距角为 $\\theta$，定义为 $v_{\\perp, \\min} = v \\sin\\theta$ 和 $v_{\\parallel, \\min} = v \\cos\\theta$。磁矩可以写为：\n$$\\mu = \\frac{\\frac{1}{2}m v_{\\perp, \\min}^2}{B_{\\min}} = \\frac{\\frac{1}{2}m (v \\sin\\theta)^2}{B_{\\min}} = \\frac{E \\sin^2\\theta}{B_{\\min}}$$\n将此代入 $B_{mirror}$ 的表达式中：\n$$B_{mirror} = \\frac{E}{\\mu} = \\frac{E}{(E \\sin^2\\theta / B_{\\min})} = \\frac{B_{\\min}}{\\sin^2\\theta}$$\n粒子被捕获的条件是 $B_{mirror} \\le B_{\\max}$，这导致以下条件：\n$$\\frac{B_{\\min}}{\\sin^2\\theta} \\le B_{\\max} \\implies \\sin^2\\theta \\ge \\frac{B_{\\min}}{B_{\\max}}$$\n这个条件将粒子在 $B_{\\min}$ 处的螺距角与磁场极值联系起来。螺距角本身是总能量 $E$ 在 $B_{\\min}$ 处如何分配为垂直和平行分量（$E_{\\perp, \\min} = E \\sin^2\\theta$, $E_{\\parallel, \\min} = E \\cos^2\\theta$）的度量。\n使用给定的 $B_{\\min} = B_{0}(1 - \\delta)$ 和 $B_{\\max} = B_{0}(1 + \\delta)$ 的形式，捕获条件变为：\n$$\\sin^2\\theta \\ge \\frac{B_{0}(1 - \\delta)}{B_{0}(1 + \\delta)} = \\frac{1 - \\delta}{1 + \\delta}$$\n\n接下来，我们假设在 $B_{\\min}$ 处的螺距角呈各向同性分布，并估算被波纹捕获的粒子份额。在各向同性速度分布中，粒子速度矢量在所有立体角上均匀分布。速度空间中的立体角元为 $d\\Omega = 2\\pi \\sin\\theta d\\theta$（对于 $\\theta \\in [0, \\pi]$）。总立体角为 $4\\pi$。因此，螺距角 $\\theta$ 的概率分布函数为 $p(\\theta)d\\theta = \\frac{2\\pi \\sin\\theta d\\theta}{4\\pi} = \\frac{1}{2}\\sin\\theta d\\theta$。\n\n被捕获粒子的份额 $f_{trap}$ 是该概率密度在所有满足捕获条件的角度 $\\theta$ 上的积分。令 $\\xi_0^2 = \\frac{B_{\\min}}{B_{\\max}}$。捕获条件是 $\\sin^2\\theta \\ge \\xi_0^2$，或 $\\sin\\theta \\ge \\xi_0$（因为对于 $\\theta \\in [0, \\pi]$，$\\sin\\theta \\ge 0$）。这个不等式对螺距角在 $[\\theta_c, \\pi - \\theta_c]$ 范围内成立，其中 $\\theta_c = \\arcsin(\\xi_0)$。\n被捕获的份额是：\n$$f_{trap} = \\int_{\\theta_c}^{\\pi - \\theta_c} \\frac{1}{2}\\sin\\theta \\, d\\theta = \\frac{1}{2} \\left[-\\cos\\theta\\right]_{\\arcsin(\\xi_0)}^{\\pi - \\arcsin(\\xi_0)}$$\n$$f_{trap} = \\frac{1}{2} \\left( -\\cos(\\pi - \\arcsin(\\xi_0)) - (-\\cos(\\arcsin(\\xi_0))) \\right)$$\n使用恒等式 $\\cos(\\pi - x) = -\\cos(x)$，我们得到：\n$$f_{trap} = \\frac{1}{2} \\left( \\cos(\\arcsin(\\xi_0)) + \\cos(\\arcsin(\\xi_0)) \\right) = \\cos(\\arcsin(\\xi_0))$$\n使用恒等式 $\\cos(\\arcsin(x)) = \\sqrt{1-x^2}$，我们得到：\n$$f_{trap} = \\sqrt{1 - \\xi_0^2} = \\sqrt{1 - \\frac{B_{\\min}}{B_{\\max}}} = \\sqrt{\\frac{B_{\\max} - B_{\\min}}{B_{\\max}}}$$\n现在，我们将 $B_{\\min}$ 和 $B_{\\max}$ 用波纹幅度 $\\delta$ 的表达式代入：\n$$B_{\\max} - B_{\\min} = B_{0}(1 + \\delta) - B_{0}(1 - \\delta) = 2\\delta B_{0}$$\n$$B_{\\max} = B_{0}(1 + \\delta)$$\n所以，被捕获的份额是：\n$$f_{trap} = \\sqrt{\\frac{2\\delta B_{0}}{B_{0}(1 + \\delta)}} = \\sqrt{\\frac{2\\delta}{1 + \\delta}}$$\n这个被捕获份额的表达式仅取决于波纹幅度 $\\delta$。\n\n最后，我们计算波纹损失份额的数值。问题陈述任何被波纹捕获的粒子都会立即损失。因此，波纹损失份额 $f_{loss}$ 等于波纹捕获份额 $f_{trap}$。给定的波纹幅度值为 $\\delta = 8.0 \\times 10^{-3}$。请注意，其他设备参数（$R_0$, $a$, $B_0$, $N$）和粒子能量 $E$ 对于此计算并非必需，因为波纹幅度 $\\delta$ 已直接给出，并且推导出的损失份额公式仅取决于 $\\delta$。\n$$f_{loss} = f_{trap} = \\sqrt{\\frac{2\\delta}{1 + \\delta}} = \\sqrt{\\frac{2 \\times (8.0 \\times 10^{-3})}{1 + 8.0 \\times 10^{-3}}}$$\n$$f_{loss} = \\sqrt{\\frac{0.016}{1.008}}$$\n$$f_{loss} \\approx \\sqrt{0.015873015...} \\approx 0.125988156...$$\n将结果四舍五入到三位有效数字，我们得到 0.126。",
            "answer": "$$\\boxed{0.126}$$"
        },
        {
            "introduction": "除了无碰撞损失，高能粒子与背景粒子的相互作用也至关重要，其中与背景中性原子的电荷交换（CX）是中性束注入（NBI）快离子的一个主要损失机制。本练习是一个综合性的计算任务，要求你整合多个给定的剖面信息——如快离子密度、能量和中性原子密度——以及依赖于能量的反应截面，来计算空间分辨的损失率 。通过完成这项任务，你将模拟聚变研究中的真实分析流程，练习实现物理模型、执行数值积分和量化物理过程对约束性能影响的核心计算物理技能。",
            "id": "3973279",
            "problem": "考虑一个环向对称的托卡马克等离子体，其中有快氘离子的中性束注入 (NBI) 和背景氢族中性原子。目标是使用测量的中性原子密度剖面和依赖于速度的 CX 截面来计算快离子的电荷交换 (CX) 损失的径向剖面，然后量化由此导致的快离子约束的退化。将等离子体视为具有圆形磁通面的轴对称体。设径向坐标 $r$ 满足 $0 \\le r \\le a$，其中 $a$ 是小半径，并设 $R_0$ 为大半径。\n\n使用以下基本依据和定义：\n- 二元碰撞的动理学理论表明，当中性原子热速度与快离子速度相比可以忽略不计时，局域 CX 损失频率为 $\\nu_{\\mathrm{CX}}(r) = n_n(r) \\, \\sigma\\!\\left(v(r)\\right) \\, v(r)$，其中 $n_n(r)$ 是中性原子密度，$\\sigma(v)$ 是依赖于速度的 CX 截面，$v(r)$ 是快离子速度。\n- 快离子速度通过 $E(r) = \\tfrac{1}{2} m_i v(r)^2$ 与局域平均能量相关，其中 $m_i$ 是离子质量。使用 $E_{\\mathrm{J}}(r) = E_{\\mathrm{keV}}(r) \\times 10^3 \\times q_e$ 将能量从千电子伏转换为焦耳，其中 $q_e$ 是元电荷，然后 $v(r) = \\sqrt{2 E_{\\mathrm{J}}(r) / m_i}$。\n- 假设圆形截面和同心环体，位于小半径 $r$ 处的薄壳的环形微分体积元为 $dV = 4 \\pi^2 R_0 \\, r \\, dr$。\n- 体积 CX 损失密度为 $L_{\\mathrm{CX}}(r) = n_f(r) \\, \\nu_{\\mathrm{CX}}(r)$，其中 $n_f(r)$ 是快离子密度剖面。\n- 快离子总含量为 $N_f = \\int_0^a n_f(r) \\, dV$。每个快离子的体积加权 CX 损失率为 $\\gamma_{\\mathrm{CX,eff}} = \\dfrac{\\int_0^a n_f(r) \\, \\nu_{\\mathrm{CX}}(r) \\, dV}{\\int_0^a n_f(r) \\, dV}$。\n- 将没有 CX 时的基线约束时间定义为 $\\tau_0$，因此全局粒子平衡包含一个线性损失项 $N_f / \\tau_0$。将 CX 损失视为一个速率为 $\\gamma_{\\mathrm{CX,eff}}$ 的额外独立线性损失通道。根据此粒子平衡，确定快离子的有效约束时间 $\\tau_{\\mathrm{eff}}$。\n\n使用以下建模假设和参数化：\n- 离子质量：$m_i = 3.344 \\times 10^{-27} \\ \\mathrm{kg}$ (氘)。\n- 元电荷：$q_e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$。\n- 几何参数：$R_0 = 1.7 \\ \\mathrm{m}$，$a = 0.6 \\ \\mathrm{m}$。\n- 快离子密度剖面：$n_f(r) = n_{f0} \\exp\\left( - \\left( \\dfrac{r}{w a} \\right)^2 \\right)$，其中 $n_{f0} = 3.0 \\times 10^{17} \\ \\mathrm{m}^{-3}$，形状参数为 $w$。\n- 快离子能量剖面：$E_{\\mathrm{keV}}(r) = E_b \\left( 1 - \\alpha \\left( \\dfrac{r}{a} \\right)^2 \\right)$，适用于 $0 \\le r \\le a$，其中 $E_b$ 为束注入能量，$\\alpha$ 为径向变化参数。\n- 测量的中性原子密度剖面：$n_n(r) = n_{n,\\mathrm{core}} + \\left( n_{n,\\mathrm{edge}} - n_{n,\\mathrm{core}} \\right) \\left( \\dfrac{r}{a} \\right)^{p_n}$，指数为 $p_n$。\n- 依赖于速度的 CX 截面，表示为以千电子伏为单位的能量拟合：$\\sigma\\!\\left(E_{\\mathrm{keV}}\\right) = \\sigma_{\\min} + \\dfrac{\\sigma_{\\max} - \\sigma_{\\min}}{1 + \\left( \\dfrac{E_{\\mathrm{keV}}}{E_0} \\right)^{p_{cs}} }$，参数为 $\\sigma_{\\min}$、$\\sigma_{\\max}$、$E_0$ 和 $p_{cs}$。\n\n任务：\n- 计算由附加线性损失模型所蕴含的径向剖面 $L_{\\mathrm{CX}}(r)$ 和有效约束时间 $\\tau_{\\mathrm{eff}}$。同时计算约束退化因子 $d = \\tau_{\\mathrm{eff}} / \\tau_0$。\n- 除非明确指定，所有物理量必须使用国际单位制处理：距离以米为单位，密度以 $\\mathrm{m}^{-3}$ 为单位，截面以 $\\mathrm{m}^2$ 为单位，速度以 $\\mathrm{m/s}$ 为单位，用于速度计算的能量从千电子伏转换为焦耳，时间以秒为单位。最终的约束时间以秒表示，四舍五入到六位小数，退化因子以十进制数表示，四舍五入到六位小数。\n- 数值实现：将 $r \\in [0,a]$ 均匀离散化，评估所需的剖面，并使用一致的数值积分法（如梯形法则）执行体积积分。\n\n测试套件：\n为以下四个参数集提供输出，这些参数集涵盖了一系列运行区间：\n\n- 案例 1 (基线)：\n  - $\\tau_0 = 0.25 \\ \\mathrm{s}$，$E_b = 80 \\ \\mathrm{keV}$，$\\alpha = 0.3$，$w = 0.6$，$p_n = 4$，\n  - $n_{n,\\mathrm{core}} = 5.0 \\times 10^{14} \\ \\mathrm{m}^{-3}$，$n_{n,\\mathrm{edge}} = 3.0 \\times 10^{16} \\ \\mathrm{m}^{-3}$，\n  - $\\sigma_{\\min} = 0.6 \\times 10^{-20} \\ \\mathrm{m}^2$，$\\sigma_{\\max} = 2.5 \\times 10^{-19} \\ \\mathrm{m}^2$，$E_0 = 10 \\ \\mathrm{keV}$，$p_{cs} = 0.5$。\n- 案例 2 (低中性原子密度，边缘上升较缓)：\n  - $\\tau_0 = 0.25 \\ \\mathrm{s}$，$E_b = 80 \\ \\mathrm{keV}$，$\\alpha = 0.3$，$w = 0.6$，$p_n = 2$，\n  - $n_{n,\\mathrm{core}} = 1.0 \\times 10^{14} \\ \\mathrm{m}^{-3}$，$n_{n,\\mathrm{edge}} = 1.0 \\times 10^{16} \\ \\mathrm{m}^{-3}$，\n  - $\\sigma_{\\min} = 0.6 \\times 10^{-20} \\ \\mathrm{m}^2$，$\\sigma_{\\max} = 2.5 \\times 10^{-19} \\ \\mathrm{m}^2$，$E_0 = 10 \\ \\mathrm{keV}$，$p_{cs} = 0.5$。\n- 案例 3 (高中性原子密度，边缘陡峭上升，较窄的快离子剖面)：\n  - $\\tau_0 = 0.25 \\ \\mathrm{s}$，$E_b = 80 \\ \\mathrm{keV}$，$\\alpha = 0.3$，$w = 0.5$，$p_n = 8$，\n  - $n_{n,\\mathrm{core}} = 1.0 \\times 10^{15} \\ \\mathrm{m}^{-3}$，$n_{n,\\mathrm{edge}} = 5.0 \\times 10^{16} \\ \\mathrm{m}^{-3}$，\n  - $\\sigma_{\\min} = 0.6 \\times 10^{-20} \\ \\mathrm{m}^2$，$\\sigma_{\\max} = 2.5 \\times 10^{-19} \\ \\mathrm{m}^2$，$E_0 = 10 \\ \\mathrm{keV}$，$p_{cs} = 0.5$。\n- 案例 4 (更高的束能量)：\n  - $\\tau_0 = 0.25 \\ \\mathrm{s}$，$E_b = 120 \\ \\mathrm{keV}$，$\\alpha = 0.3$，$w = 0.6$，$p_n = 4$，\n  - $n_{n,\\mathrm{core}} = 5.0 \\times 10^{14} \\ \\mathrm{m}^{-3}$，$n_{n,\\mathrm{edge}} = 3.0 \\times 10^{16} \\ \\mathrm{m}^{-3}$，\n  - $\\sigma_{\\min} = 0.6 \\times 10^{-20} \\ \\mathrm{m}^2$，$\\sigma_{\\max} = 2.5 \\times 10^{-19} \\ \\mathrm{m}^2$，$E_0 = 10 \\ \\mathrm{keV}$，$p_{cs} = 0.5$。\n\n答案规格：\n- 对每个案例，计算以秒为单位的 $\\tau_{\\mathrm{eff}}$ 和 $d = \\tau_{\\mathrm{eff}}/\\tau_0$，两者均四舍五入到六位小数。\n- 您的程序应产生单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表，顺序为 $[\\tau_{\\mathrm{eff},1}, d_1, \\tau_{\\mathrm{eff},2}, d_2, \\tau_{\\mathrm{eff},3}, d_3, \\tau_{\\mathrm{eff},4}, d_4]$。",
            "solution": "问题提法恰当，有科学依据，并包含进行求解所需的所有信息。\n\n目标是计算托卡马克等离子体中快离子的有效约束时间 $\\tau_{\\mathrm{eff}}$，考虑与背景中性原子发生电荷交换 (CX) 造成的损失，并通过因子 $d = \\tau_{\\mathrm{eff}} / \\tau_0$ 来量化约束退化。\n\n分析始于快离子总数 $N_f$ 的全局粒子平衡。问题指定了一个基线损失机制，其特征时间为 $\\tau_0$，对应于 $N_f / \\tau_0$ 的损失率。电荷交换过程引入了一个额外的、独立的损失通道。此损失通道的速率由 $\\gamma_{\\mathrm{CX,eff}} N_f$ 给出，其中 $\\gamma_{\\mathrm{CX,eff}}$ 是体积加权平均 CX 碰撞频率。因此，快离子布居的总时间变化率为：\n$$\n\\frac{dN_f}{dt} = S - \\frac{N_f}{\\tau_0} - \\gamma_{\\mathrm{CX,eff}} N_f\n$$\n其中 $S$ 是快离子源率。该方程可以重写为：\n$$\n\\frac{dN_f}{dt} = S - N_f \\left( \\frac{1}{\\tau_0} + \\gamma_{\\mathrm{CX,eff}} \\right)\n$$\n括号中的项表示总逆约束时间。因此，有效约束时间 $\\tau_{\\mathrm{eff}}$ 由以下关系式定义：\n$$\n\\frac{1}{\\tau_{\\mathrm{eff}}} = \\frac{1}{\\tau_0} + \\gamma_{\\mathrm{CX,eff}}\n$$\n求解 $\\tau_{\\mathrm{eff}}$ 得：\n$$\n\\tau_{\\mathrm{eff}} = \\left( \\frac{1 + \\tau_0 \\gamma_{\\mathrm{CX,eff}}}{\\tau_0} \\right)^{-1} = \\frac{\\tau_0}{1 + \\tau_0 \\gamma_{\\mathrm{CX,eff}}}\n$$\n约束退化因子 $d$ 是有效约束时间与基线约束时间之比：\n$$\nd = \\frac{\\tau_{\\mathrm{eff}}}{\\tau_0} = \\frac{1}{1 + \\tau_0 \\gamma_{\\mathrm{CX,eff}}}\n$$\n中心任务是计算有效 CX 损失率 $\\gamma_{\\mathrm{CX,eff}}$。它被定义为局域 CX 损失频率 $\\nu_{\\mathrm{CX}}(r)$ 的体积加权平均值：\n$$\n\\gamma_{\\mathrm{CX,eff}} = \\frac{\\int_V n_f(\\vec{x}) \\, \\nu_{\\mathrm{CX}}(\\vec{x}) \\, dV}{\\int_V n_f(\\vec{x}) \\, dV}\n$$\n鉴于环向对称性和基本环形体积壳层 $dV = 4 \\pi^2 R_0 \\, r \\, dr$，对体积 $V$ 的积分简化为在小半径 $r$ 上从 $0$ 到 $a$ 的一维积分：\n$$\n\\gamma_{\\mathrm{CX,eff}} = \\frac{\\int_0^a n_f(r) \\, \\nu_{\\mathrm{CX}}(r) \\, (4 \\pi^2 R_0 r) \\, dr}{\\int_0^a n_f(r) \\, (4 \\pi^2 R_0 r) \\, dr}\n$$\n常数因子 $4 \\pi^2 R_0$ 从分子和分母中约去，将表达式简化为：\n$$\n\\gamma_{\\mathrm{CX,eff}} = \\frac{\\int_0^a n_f(r) \\, \\nu_{\\mathrm{CX}}(r) \\, r \\, dr}{\\int_0^a n_f(r) \\, r \\, dr}\n$$\n为计算这些积分，我们必须首先构建被积函数中各量的径向剖面。局域 CX 损失频率为 $\\nu_{\\mathrm{CX}}(r) = n_n(r) \\, \\sigma(v(r)) \\, v(r)$。所需的剖面构建如下：\n\n1.  **快离子密度剖面：** 快离子密度剖面由一个高斯函数给出：\n    $$\n    n_f(r) = n_{f0} \\exp\\left( - \\left( \\frac{r}{w a} \\right)^2 \\right)\n    $$\n    其中 $n_{f0} = 3.0 \\times 10^{17} \\ \\mathrm{m}^{-3}$。\n\n2.  **中性原子密度剖面：** 中性原子密度剖面由一个幂律模型给出：\n    $$\n    n_n(r) = n_{n,\\mathrm{core}} + (n_{n,\\mathrm{edge}} - n_{n,\\mathrm{core}}) \\left( \\frac{r}{a} \\right)^{p_n}\n    $$\n\n3.  **快离子能量和速度剖面：** 快离子平均能量剖面以千电子伏 ($\\mathrm{keV}$) 给出：\n    $$\n    E_{\\mathrm{keV}}(r) = E_b \\left( 1 - \\alpha \\left( \\frac{r}{a} \\right)^2 \\right)\n    $$\n    首先使用元电荷 $q_e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$ 将此能量转换为焦耳：\n    $$\n    E_{\\mathrm{J}}(r) = E_{\\mathrm{keV}}(r) \\times 10^3 \\times q_e\n    $$\n    然后，根据动能关系 $E = \\frac{1}{2} m_i v^2$ 确定相应的快离子速度 $v(r)$，其中快离子质量为 $m_i = 3.344 \\times 10^{-27} \\ \\mathrm{kg}$：\n    $$\n    v(r) = \\sqrt{\\frac{2 E_{\\mathrm{J}}(r)}{m_i}}\n    $$\n\n4.  **电荷交换截面剖面：** CX 截面 $\\sigma$ 依赖于快离子能量，以 $E_{\\mathrm{keV}}$ 的拟合函数形式提供：\n    $$\n    \\sigma(E_{\\mathrm{keV}}) = \\sigma_{\\min} + \\frac{\\sigma_{\\max} - \\sigma_{\\min}}{1 + \\left( \\frac{E_{\\mathrm{keV}}}{E_0} \\right)^{p_{cs}}}\n    $$\n    通过将 $E_{\\mathrm{keV}}(r)$ 代入此公式，我们得到截面的径向剖面 $\\sigma(r) = \\sigma(E_{\\mathrm{keV}}(r))$。\n\n5.  **电荷交换频率剖面：** 将所有分量组合起来，局域 CX 频率剖面计算如下：\n    $$\n    \\nu_{\\mathrm{CX}}(r) = n_n(r) \\, \\sigma(r) \\, v(r)\n    $$\n\n由于被积函数的复杂性，$\\gamma_{\\mathrm{CX,eff}}$ 的积分没有简单的解析解。因此，需要采用数值方法。将径向域 $r \\in [0, a]$ 离散化为均匀的网格点。在每个网格点上计算剖面 $n_f(r)$、$n_n(r)$、$v(r)$、$\\sigma(r)$ 和 $\\nu_{\\mathrm{CX}}(r)$。然后计算分子被积函数 $I_{num}(r) = n_f(r) \\, \\nu_{\\mathrm{CX}}(r) \\, r$ 和分母被积函数 $I_{den}(r) = n_f(r) \\, r$。\n定积分使用梯形法则进行近似。对于函数 $f(r)$ 和点网格 $r_i$，积分为：\n$$\n\\int_0^a f(r) \\, dr \\approx \\sum_{i=0}^{N-2} \\frac{f(r_i) + f(r_{i+1})}{2} (r_{i+1} - r_i)\n$$\n其中 $N$ 是网格点的数量。在计算出分子积分 $I_{num} = \\int_0^a I_{num}(r) \\, dr$ 和分母积分 $I_{den} = \\int_0^a I_{den}(r) \\, dr$ 的数值后，有效 CX 损失率可求得为 $\\gamma_{\\mathrm{CX,eff}} = I_{num} / I_{den}$。\n\n最后，将该值代回到 $\\tau_{\\mathrm{eff}}$ 和 $d$ 的表达式中，以获得每个给定参数集的最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effective fast-ion confinement time and degradation factor\n    due to charge-exchange losses in a tokamak plasma.\n    \"\"\"\n\n    # Physical and geometrical constants\n    M_I = 3.344e-27  # Mass of deuterium ion (kg)\n    Q_E = 1.602176634e-19  # Elementary charge (C)\n    R_0 = 1.7  # Major radius (m)\n    A = 0.6  # Minor radius (m)\n    N_F0 = 3.0e17 # Central fast-ion density (m^-3)\n    \n    # Numerical integration parameters\n    NUM_POINTS = 2001\n    \n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1 (baseline)\n        {\n            \"tau0\": 0.25, \"Eb\": 80.0, \"alpha\": 0.3, \"w\": 0.6, \"pn\": 4.0,\n            \"n_n_core\": 5.0e14, \"n_n_edge\": 3.0e16,\n            \"sigma_min\": 0.6e-20, \"sigma_max\": 2.5e-19, \"E0\": 10.0, \"pcs\": 0.5\n        },\n        # Case 2 (low neutrals, milder edge rise)\n        {\n            \"tau0\": 0.25, \"Eb\": 80.0, \"alpha\": 0.3, \"w\": 0.6, \"pn\": 2.0,\n            \"n_n_core\": 1.0e14, \"n_n_edge\": 1.0e16,\n            \"sigma_min\": 0.6e-20, \"sigma_max\": 2.5e-19, \"E0\": 10.0, \"pcs\": 0.5\n        },\n        # Case 3 (high neutrals, steep edge rise, narrower fast-ion profile)\n        {\n            \"tau0\": 0.25, \"Eb\": 80.0, \"alpha\": 0.3, \"w\": 0.5, \"pn\": 8.0,\n            \"n_n_core\": 1.0e15, \"n_n_edge\": 5.0e16,\n            \"sigma_min\": 0.6e-20, \"sigma_max\": 2.5e-19, \"E0\": 10.0, \"pcs\": 0.5\n        },\n        # Case 4 (higher beam energy)\n        {\n            \"tau0\": 0.25, \"Eb\": 120.0, \"alpha\": 0.3, \"w\": 0.6, \"pn\": 4.0,\n            \"n_n_core\": 5.0e14, \"n_n_edge\": 3.0e16,\n            \"sigma_min\": 0.6e-20, \"sigma_max\": 2.5e-19, \"E0\": 10.0, \"pcs\": 0.5\n        }\n    ]\n\n    results = []\n    \n    # Create the radial grid\n    r_grid = np.linspace(0, A, NUM_POINTS)\n    r_norm = r_grid / A\n\n    for case in test_cases:\n        # Unpack parameters for the current case\n        tau0 = case[\"tau0\"]\n        w = case[\"w\"]\n        Eb = case[\"Eb\"]\n        alpha = case[\"alpha\"]\n        n_n_core = case[\"n_n_core\"]\n        n_n_edge = case[\"n_n_edge\"]\n        pn = case[\"pn\"]\n        sigma_min = case[\"sigma_min\"]\n        sigma_max = case[\"sigma_max\"]\n        E0 = case[\"E0\"]\n        pcs = case[\"pcs\"]\n\n        # 1. Fast-ion density profile n_f(r)\n        nf_profile = N_F0 * np.exp(-(r_grid / (w * A))**2)\n\n        # 2. Fast-ion energy profile E_keV(r)\n        E_keV_profile = Eb * (1 - alpha * r_norm**2)\n        # Ensure energy is non-negative\n        E_keV_profile[E_keV_profile  0] = 0\n\n        # 3. Fast-ion speed profile v(r)\n        E_J_profile = E_keV_profile * 1e3 * Q_E\n        v_profile = np.sqrt(2 * E_J_profile / M_I)\n\n        # 4. CX cross-section profile sigma(r)\n        # Handle potential division by zero at E_keV=0, although formula is safe\n        # As E_keV - 0, E_keV/E0 - 0, denominator - 1, result is sigma_max\n        sigma_profile = sigma_min + (sigma_max - sigma_min) / (1 + (E_keV_profile / E0)**pcs)\n\n        # 5. Neutral density profile n_n(r)\n        nn_profile = n_n_core + (n_n_edge - n_n_core) * r_norm**pn\n\n        # 6. CX frequency profile nu_CX(r)\n        nu_cx_profile = nn_profile * sigma_profile * v_profile\n\n        # 7. Define integrands for gamma_CX,eff calculation\n        integrand_num = nf_profile * nu_cx_profile * r_grid\n        integrand_den = nf_profile * r_grid\n\n        # 8. Perform numerical integration using the trapezoidal rule\n        integral_num = np.trapz(integrand_num, r_grid)\n        integral_den = np.trapz(integrand_den, r_grid)\n\n        # 9. Calculate the effective CX loss rate gamma_CX,eff\n        gamma_cx_eff = 0\n        if integral_den > 0:\n            gamma_cx_eff = integral_num / integral_den\n\n        # 10. Calculate effective confinement time and degradation factor\n        tau_eff = tau0 / (1 + tau0 * gamma_cx_eff)\n        d = tau_eff / tau0\n        \n        results.extend([round(tau_eff, 6), round(d, 6)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}