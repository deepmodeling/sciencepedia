{
    "hands_on_practices": [
        {
            "introduction": "引导中心近似是研究高能粒子输运理论的基石，它将粒子复杂的螺旋运动简化为引导中心的漂移和围绕磁力线的快速回旋。然而，该近似的有效性并非普遍适用，而是取决于关键的无量纲参数。本练习 () 提供了一种实用的方法来量化这些适用条件，通过计算拉莫尔半径与磁场梯度特征长度等参数的比值，确保我们在其有效范围内应用模型。",
            "id": "3973328",
            "problem": "一个大环径比的圆形托卡马克被建模，其大半径为 $R_0$，小半径为 $a$。环向磁场取为 $B_{\\mathrm{t}}(R) = B_0 R_0 / R$，其中 $R$ 是大半径坐标。考虑一个位于边缘外侧中平面处的 $1.0\\ \\mathrm{MeV}$ α粒子，其位置在 $R_{\\mathrm{edge}} = R_0 + a$。假设以下参数：$R_0 = 3.0\\ \\mathrm{m}$，$a = 0.6\\ \\mathrm{m}$，$B_0 = 2.8\\ \\mathrm{T}$，α粒子电荷 $q_{\\alpha} = 2e$，α粒子质量 $m_{\\alpha} = 6.644657 \\times 10^{-27}\\ \\mathrm{kg}$，以及外侧中平面处的相对环向磁场纹波幅度 $\\delta B / B = 8.0 \\times 10^{-3}$。该粒子在外侧中平面处的螺距角为 $\\alpha = 60^\\circ$。角度必须以度为单位处理。\n\n从磁场中带电粒子运动的第一性原理和非相对论动能关系出发，计算该粒子在边缘处的的回旋频率、回旋半径以及特征磁场标长。使用这些量来评估在 $R_{\\mathrm{edge}}$ 处的无量纲度量 $\\rho/a$、$\\rho/L_B$ 和 $\\delta B/B$，其中 $\\rho$ 是拉莫尔半径，$L_B \\equiv B/|\\nabla B|$ 是磁场梯度标长。对于大环径比托卡马克中外侧中平面处的磁力线曲率，你可以将曲率标长 $L_c \\equiv 1/|\\hat{\\boldsymbol{b}}\\cdot\\nabla \\hat{\\boldsymbol{b}}|$ 取为 $R_{\\mathrm{edge}}$ 的量级，并据此进行估算。\n\n通过 $\\epsilon_{\\mathrm{gc}} \\equiv \\max\\left\\{\\rho/a,\\ \\rho/L_B,\\ \\delta B/B\\right\\}$ 定义一个单一的导心小量指标，并将其计算为一个无量纲数。\n\n将你最终的 $\\epsilon_{\\mathrm{gc}}$ 值四舍五入到三位有效数字。最终答案必须是一个不带单位的实数。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 托卡马克大半径: $R_0 = 3.0\\ \\mathrm{m}$\n- 托卡马克小半径: $a = 0.6\\ \\mathrm{m}$\n- 环向磁场模型: $B_{\\mathrm{t}}(R) = B_0 R_0 / R$\n- 轴上磁场: $B_0 = 2.8\\ \\mathrm{T}$\n- 粒子：α粒子\n- 粒子动能: $K = 1.0\\ \\mathrm{MeV}$\n- 粒子初始位置：外侧中平面边缘, $R_{\\mathrm{edge}} = R_0 + a$\n- α粒子电荷: $q_{\\alpha} = 2e$\n- α粒子质量: $m_{\\alpha} = 6.644657 \\times 10^{-27}\\ \\mathrm{kg}$\n- 外侧中平面处的相对环向磁场纹波: $\\delta B / B = 8.0 \\times 10^{-3}$\n- 粒子在外侧中平面处的螺距角: $\\alpha = 60^\\circ$\n- 磁场梯度标长的定义: $L_B \\equiv B/|\\nabla B|$\n- 导心小量指标的定义: $\\epsilon_{\\mathrm{gc}} \\equiv \\max\\left\\{\\rho/a,\\ \\rho/L_B,\\ \\delta B/B\\right\\}$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于成熟的磁场中带电粒子运动理论，特别是在托卡马克背景下的导心近似，这是聚变等离子体物理学的核心。所提供的托卡马克模型 ($B \\propto 1/R$) 是一个标准的大环径比近似。所有参数（尺寸、场强、粒子能量）对于当代聚变实验都是符合实际的。该问题提法良好、客观且自洽，提供了计算所需量所需的所有必要物理常数、定义和数据。指令是明确的。该问题没有违反任何科学原理，不包含矛盾，也不依赖于主观论斷。\n\n### 步骤 3：结论与行动\n该问题被评估为**有效**。将提供完整解答。\n\n### 解答推导\n解答过程首先计算粒子和磁场在指定位置的物理参数。然后，计算无量纲比率以确定导心小量指标。\n\n首先，我们确定粒子位置（外侧中平面边缘）处的属性。该点的大半径为：\n$$R_{\\mathrm{edge}} = R_0 + a = 3.0\\ \\mathrm{m} + 0.6\\ \\mathrm{m} = 3.6\\ \\mathrm{m}$$\n该位置的磁场强度由环向磁场模型给出：\n$$B_{\\mathrm{edge}} = B_{\\mathrm{t}}(R_{\\mathrm{edge}}) = B_0 \\frac{R_0}{R_{\\mathrm{edge}}} = (2.8\\ \\mathrm{T}) \\frac{3.0\\ \\mathrm{m}}{3.6\\ \\mathrm{m}} = 2.8 \\times \\frac{5}{6}\\ \\mathrm{T} = \\frac{7}{3}\\ \\mathrm{T}$$\n\n接下来，我们计算粒子的属性。动能给定为 $K = 1.0\\ \\mathrm{MeV}$。我们使用元电荷 $e = 1.60217663 \\times 10^{-19}\\ \\mathrm{C}$ 将其转换为焦耳：\n$$K = 1.0 \\times 10^6\\ \\mathrm{eV} \\times (1.60217663 \\times 10^{-19}\\ \\mathrm{J/eV}) = 1.60217663 \\times 10^{-13}\\ \\mathrm{J}$$\n粒子的总速率 $v$ 可由非相对论动能关系 $K = \\frac{1}{2} m_{\\alpha} v^2$ 导出：\n$$v = \\sqrt{\\frac{2K}{m_{\\alpha}}} = \\sqrt{\\frac{2(1.60217663 \\times 10^{-13}\\ \\mathrm{J})}{6.644657 \\times 10^{-27}\\ \\mathrm{kg}}} \\approx 6.944 \\times 10^6\\ \\mathrm{m/s}$$\n垂直于磁场的速度分量 $v_{\\perp}$ 由螺距角 $\\alpha = 60^\\circ$ 确定：\n$$v_{\\perp} = v \\sin(\\alpha) = v \\sin(60^\\circ)$$\n\n问题要求计算回旋频率、回旋半径和磁场标长。\n\n回旋（或陀螺）频率 $\\omega_c$ 由以下公式给出：\n$$\\omega_c = \\frac{|q_{\\alpha}| B}{m_{\\alpha}}$$\n在边缘位置，使用 $|q_\\alpha| = 2e$：\n$$\\omega_{c, \\mathrm{edge}} = \\frac{2e B_{\\mathrm{edge}}}{m_{\\alpha}} = \\frac{2(1.60217663 \\times 10^{-19}\\ \\mathrm{C}) (\\frac{7}{3}\\ \\mathrm{T})}{6.644657 \\times 10^{-27}\\ \\mathrm{kg}} \\approx 1.125 \\times 10^8\\ \\mathrm{rad/s}$$\n\n回旋半径（或拉莫尔半径）$\\rho$ 是粒子围绕磁力线做圆周运动的半径：\n$$\\rho = \\frac{m_{\\alpha} v_{\\perp}}{|q_{\\alpha}| B}$$\n代入 $v_{\\perp} = v \\sin(\\alpha)$ 和 $v = \\sqrt{2K/m_{\\alpha}}$：\n$$\\rho = \\frac{m_{\\alpha}}{|q_{\\alpha}| B} \\left(\\sqrt{\\frac{2K}{m_{\\alpha}}} \\sin(\\alpha)\\right) = \\frac{\\sqrt{2 K m_{\\alpha}}}{|q_{\\alpha}| B} \\sin(\\alpha)$$\n在边缘处，我们有：\n$$\\rho_{\\mathrm{edge}} = \\frac{\\sqrt{2(1.60217663 \\times 10^{-13}\\ \\mathrm{J})(6.644657 \\times 10^{-27}\\ \\mathrm{kg})}}{2(1.60217663 \\times 10^{-19}\\ \\mathrm{C})(\\frac{7}{3}\\ \\mathrm{T})} \\sin(60^\\circ)$$\n$$\\rho_{\\mathrm{edge}} \\approx 0.053447\\ \\mathrm{m}$$\n\n磁场梯度标长为 $L_B \\equiv B/|\\nabla B|$。对于给定的磁场 $B(R) = B_0 R_0 / R$，场的大小仅随 $R$ 变化。其梯度为：\n$$\\nabla B(R) = \\frac{dB}{dR}\\hat{\\boldsymbol{R}} = -\\frac{B_0 R_0}{R^2}\\hat{\\boldsymbol{R}}$$\n其大小为 $|\\nabla B| = \\frac{B_0 R_0}{R^2}$。因此，标长简化为：\n$$L_B = \\frac{B(R)}{|\\nabla B(R)|} = \\frac{B_0 R_0 / R}{B_0 R_0 / R^2} = R$$\n在外侧中平面边缘，这变为：\n$$L_{B, \\mathrm{edge}} = R_{\\mathrm{edge}} = 3.6\\ \\mathrm{m}$$\n\n我们现在评估构成导心小量指标 $\\epsilon_{\\mathrm{gc}}$ 的三个无量纲度量。\n\n1.  回旋半径与小半径之比, $\\rho/a$：\n    $$\\frac{\\rho_{\\mathrm{edge}}}{a} = \\frac{0.053447\\ \\mathrm{m}}{0.6\\ \\mathrm{m}} \\approx 0.089078$$\n\n2.  回旋半径与磁场梯度标长之比, $\\rho/L_B$：\n    $$\\frac{\\rho_{\\mathrm{edge}}}{L_{B, \\mathrm{edge}}} = \\frac{0.053447\\ \\mathrm{m}}{3.6\\ \\mathrm{m}} \\approx 0.014846$$\n\n3.  相对环向磁场纹波, $\\delta B/B$：\n    这个值是针对感兴趣的位置直接给出的。\n    $$\\frac{\\delta B}{B} = 8.0 \\times 10^{-3} = 0.008$$\n\n最后，我们通过取这三个值的最大值来计算 $\\epsilon_{\\mathrm{gc}}$：\n$$\\epsilon_{\\mathrm{gc}} = \\max\\left\\{\\frac{\\rho}{a}, \\frac{\\rho}{L_B}, \\frac{\\delta B}{B}\\right\\} = \\max\\{0.089078, 0.014846, 0.008\\}$$\n$$\\epsilon_{\\mathrm{gc}} = 0.089078$$\n问题要求将最终结果四舍五入到三位有效数字。\n$$\\epsilon_{\\mathrm{gc}} \\approx 0.0891$$",
            "answer": "$$\\boxed{0.0891}$$"
        },
        {
            "introduction": "在引导中心框架的基础上，我们来分析一个具体的粒子损失机制。托卡马克中环向磁场的微小周期性波动，即“磁场波纹”，可以捕获高能粒子并导致其快速逃逸。本练习 () 将引导你从第一性原理出发，推导粒子被波纹捕获的条件，并估算由此造成的损失份额，从而将装置设计参数（如波纹幅度 $\\delta$）与等离子体性能直接联系起来。",
            "id": "3973346",
            "problem": "考虑一个大环径比托卡马克，其环形磁场由于线圈数量有限而表现出波纹。将沿磁力线的环形场变化模拟为单谐波调制，使得磁场大小的最小值和最大值由 $B_{\\min} = B_{0}(1 - \\delta)$ 和 $B_{\\max} = B_{0}(1 + \\delta)$ 给出，其中 $B_{0}$ 是标称环形场，$\\delta$ 是波纹幅度。假设高能粒子进行无碰撞的导心运动，并且在 $B_{\\min}$ 和 $B_{\\max}$ 之间，第一绝热不变量（磁矩）和总动能守恒。如果一个粒子由于波纹阱在 $B_{\\min}$ 和 $B_{\\max}$ 之间经历磁镜效应，则称该粒子被波纹捕获。\n\n从磁化粒子运动的基本不变量出发，推导一个捕获条件，该条件将 $\\delta$ 与粒子在 $B_{\\min}$ 处的参数联系起来。然后，假设在 $B_{\\min}$ 处粒子螺距角呈各向同性分布，并估算被波纹捕获的粒子比例。最后，对于一个具有代表性的装置，其特征为：大半径 $R_{0} = 3.0\\ \\mathrm{m}$，小半径 $a = 1.0\\ \\mathrm{m}$，标称环形场 $B_{0} = 5.3\\ \\mathrm{T}$，环形场（TF）线圈数量 $N = 18$，外侧中平面处的波纹幅度 $\\delta = 8.0 \\times 10^{-3}$，以及能量为 $E = 3.5\\ \\mathrm{MeV}$ 的单能聚变产生的alpha粒子群，假设任何被波纹捕获的粒子都会立即损失到壁上。在这些假设下，计算该托卡马克的波纹损失份额。将该份额表示为小数，并将最终答案四舍五入到三位有效数字。",
            "solution": "该问题要求推导波纹捕获条件，估算捕获粒子份额，并针对一个特定的托卡马克场景进行该份额的数值计算。我们将首先阐明在空间变化磁场中粒子捕获的物理原理。\n\n在无碰撞导心近似下，带电粒子在缓慢变化的磁场中的运动有两个关键的守恒量：总动能 $E$ 和第一绝热不变量，即磁矩 $\\mu$。\n动能由下式给出：\n$$E = \\frac{1}{2}m v_{\\parallel}^2 + \\frac{1}{2}m v_{\\perp}^2 = \\text{constant}$$\n其中 $m$ 是粒子质量，$v_{\\parallel}$ 是平行于磁场 $\\vec{B}$ 的速度分量，$v_{\\perp}$ 是垂直于 $\\vec{B}$ 的速度分量。\n\n磁矩由下式给出：\n$$\\mu = \\frac{\\frac{1}{2}m v_{\\perp}^2}{B} = \\text{constant}$$\n其中 $B = |\\vec{B}|$ 是磁场强度。\n\n从 $\\mu$ 的表达式，我们可以将垂直动能写为 $\\frac{1}{2}m v_{\\perp}^2 = \\mu B$。将其代入能量守恒方程得到：\n$$E = \\frac{1}{2}m v_{\\parallel}^2 + \\mu B$$\n这个方程可以重新整理以求解平行速度：\n$$v_{\\parallel} = \\pm\\sqrt{\\frac{2}{m}(E - \\mu B)}$$\n当粒子的平行速度变为零，即 $v_{\\parallel} = 0$ 时，我们称该粒子被捕获或发生磁镜反射。这种情况发生在其轨道上的一个特定点，那里的磁场强度达到一个值 $B_{mirror}$。在这个“转折点”，条件是：\n$$E - \\mu B_{mirror} = 0 \\implies B_{mirror} = \\frac{E}{\\mu}$$\n一个从较低磁场区域移动到较高磁场区域的粒子，如果磁场强度达到 $B_{mirror}$，将会被反射。\n\n问题描述了一个波纹阱，其中磁场在 $B_{\\min}$ 和 $B_{\\max}$ 之间变化。如果一个粒子进入这个区域，并且其磁镜点 $B_{mirror}$ 小于或等于该阱的最大磁场，即 $B_{mirror} \\le B_{\\max}$，那么它就被波纹捕获。如果 $B_{mirror} > B_{\\max}$，该粒子是“通行”粒子，不会被波纹捕获。\n\n为了推导捕获条件，我们用粒子在磁场最小值位置 $B_{\\min}$ 的状态来表示 $\\mu$。粒子的总速率是 $v = \\sqrt{2E/m}$。设在 $B_{\\min}$ 处的螺距角为 $\\theta$，其定义为 $v_{\\perp, \\min} = v \\sin\\theta$ 和 $v_{\\parallel, \\min} = v \\cos\\theta$。磁矩可以写为：\n$$\\mu = \\frac{\\frac{1}{2}m v_{\\perp, \\min}^2}{B_{\\min}} = \\frac{\\frac{1}{2}m (v \\sin\\theta)^2}{B_{\\min}} = \\frac{E \\sin^2\\theta}{B_{\\min}}$$\n将此代入 $B_{mirror}$ 的表达式中：\n$$B_{mirror} = \\frac{E}{\\mu} = \\frac{E}{(E \\sin^2\\theta / B_{\\min})} = \\frac{B_{\\min}}{\\sin^2\\theta}$$\n如果 $B_{mirror} \\le B_{\\max}$，粒子被捕获，这导出条件：\n$$\\frac{B_{\\min}}{\\sin^2\\theta} \\le B_{\\max} \\implies \\sin^2\\theta \\ge \\frac{B_{\\min}}{B_{\\max}}$$\n这个条件将粒子在 $B_{\\min}$ 处的螺距角与磁场极值联系起来。这个螺距角本身是总能量 $E$ 在 $B_{\\min}$ 处分解为垂直和平行分量的一种度量 ($E_{\\perp, \\min} = E \\sin^2\\theta$, $E_{\\parallel, \\min} = E \\cos^2\\theta$)。\n使用给定的形式 $B_{\\min} = B_{0}(1 - \\delta)$ 和 $B_{\\max} = B_{0}(1 + \\delta)$，捕获条件变为：\n$$\\sin^2\\theta \\ge \\frac{B_{0}(1 - \\delta)}{B_{0}(1 + \\delta)} = \\frac{1 - \\delta}{1 + \\delta}$$\n\n接下来，我们假设在 $B_{\\min}$ 处的螺距角呈各向同性分布，来估算被波纹捕获的粒子比例。在各向同性的速度分布中，粒子速度矢量在所有立体角上均匀分布。速度空间中的立体角微元是 $d\\Omega = 2\\pi \\sin\\theta d\\theta$，其中 $\\theta \\in [0, \\pi]$。总立体角为 $4\\pi$。因此，螺距角 $\\theta$ 的概率分布函数为 $p(\\theta)d\\theta = \\frac{2\\pi \\sin\\theta d\\theta}{4\\pi} = \\frac{1}{2}\\sin\\theta d\\theta$。\n\n捕获粒子的比例 $f_{trap}$ 是该概率密度在所有满足捕获条件的角度 $\\theta$ 上的积分。设 $\\xi_0^2 = \\frac{B_{\\min}}{B_{\\max}}$。捕获条件是 $\\sin^2\\theta \\ge \\xi_0^2$，或 $\\sin\\theta \\ge \\xi_0$（因为对于 $\\theta \\in [0, \\pi]$，有 $\\sin\\theta \\ge 0$）。这个不等式对于螺距角在 $[\\theta_c, \\pi - \\theta_c]$ 范围内成立，其中 $\\theta_c = \\arcsin(\\xi_0)$。\n捕获比例为：\n$$f_{trap} = \\int_{\\theta_c}^{\\pi - \\theta_c} \\frac{1}{2}\\sin\\theta \\, d\\theta = \\frac{1}{2} \\left[-\\cos\\theta\\right]_{\\arcsin(\\xi_0)}^{\\pi - \\arcsin(\\xi_0)}$$\n$$f_{trap} = \\frac{1}{2} \\left( -\\cos(\\pi - \\arcsin(\\xi_0)) - (-\\cos(\\arcsin(\\xi_0))) \\right)$$\n使用恒等式 $\\cos(\\pi - x) = -\\cos(x)$，我们得到：\n$$f_{trap} = \\frac{1}{2} \\left( \\cos(\\arcsin(\\xi_0)) + \\cos(\\arcsin(\\xi_0)) \\right) = \\cos(\\arcsin(\\xi_0))$$\n使用恒等式 $\\cos(\\arcsin(x)) = \\sqrt{1-x^2}$，我们得到：\n$$f_{trap} = \\sqrt{1 - \\xi_0^2} = \\sqrt{1 - \\frac{B_{\\min}}{B_{\\max}}} = \\sqrt{\\frac{B_{\\max} - B_{\\min}}{B_{\\max}}}$$\n现在，我们将 $B_{\\min}$ 和 $B_{\\max}$ 的表达式用波纹幅度 $\\delta$ 代入：\n$$B_{\\max} - B_{\\min} = B_{0}(1 + \\delta) - B_{0}(1 - \\delta) = 2\\delta B_{0}$$\n$$B_{\\max} = B_{0}(1 + \\delta)$$\n所以，捕获比例为：\n$$f_{trap} = \\sqrt{\\frac{2\\delta B_{0}}{B_{0}(1 + \\delta)}} = \\sqrt{\\frac{2\\delta}{1 + \\delta}}$$\n这个捕获比例的表达式仅取决于波纹幅度 $\\delta$。\n\n最后，我们计算波纹损失份额的数值。问题陈述任何被波纹捕获的粒子都会立即损失。因此，波纹损失份额 $f_{loss}$ 等于波纹捕获份额 $f_{trap}$。提供的波纹幅度值为 $\\delta = 8.0 \\times 10^{-3}$。注意，其他装置参数（$R_0$, $a$, $B_0$, $N$）和粒子能量 $E$ 对于此计算并非必需，因为波纹幅度 $\\delta$ 是直接给出的，并且推导出的损失份额公式仅依赖于 $\\delta$。\n$$f_{loss} = f_{trap} = \\sqrt{\\frac{2\\delta}{1 + \\delta}} = \\sqrt{\\frac{2 \\times (8.0 \\times 10^{-3})}{1 + 8.0 \\times 10^{-3}}}$$\n$$f_{loss} = \\sqrt{\\frac{0.016}{1.008}}$$\n$$f_{loss} \\approx \\sqrt{0.015873015...} \\approx 0.125988156...$$\n将结果四舍五入到三位有效数字，我们得到 $0.126$。",
            "answer": "$$\\boxed{0.126}$$"
        },
        {
            "introduction": "现在，我们将从理想化的解析问题转向更全面的计算建模。电荷交换（CX）是另一个关键的高能粒子损失通道，尤其对于中性束注入（NBI）产生的高能离子而言。本练习 () 模拟了一项真实的分析任务，要求你综合多种实际的等离子体剖面，计算总的电荷交换损失率及其对粒子约束的影响，从而展示数值建模在聚变科学研究中的强大威力。",
            "id": "3973279",
            "problem": "考虑一个具有环向对称性的托卡马克等离子体，其中通过中性束注入（NBI）引入了快氘离子和背景氢同位素中性粒子。目标是使用测量的中性粒子密度剖面和依赖于速度的CX截面，计算快离子的电荷交换（CX）损失的径向剖面，然后量化由此导致的快离子约束的退化。将等离子体视为具有圆形磁通面的轴对称体。设径向坐标 $r$ 满足 $0 \\le r \\le a$，其中 $a$ 为小半径， $R_0$ 为大半径。\n\n使用以下基本依据和定义：\n- 当中性粒子的热速度与快离子速度相比可以忽略不计时，根据双体碰撞的动理论，局域CX损失频率为 $\\nu_{\\mathrm{CX}}(r) = n_n(r) \\, \\sigma\\!\\left(v(r)\\right) \\, v(r)$，其中 $n_n(r)$ 是中性粒子密度，$\\sigma(v)$ 是依赖于速度的CX截面，$v(r)$ 是快离子速度。\n- 快离子速度通过 $E(r) = \\tfrac{1}{2} m_i v(r)^2$ 与局域平均能量相关联，其中 $m_i$ 为离子质量。使用 $E_{\\mathrm{J}}(r) = E_{\\mathrm{keV}}(r) \\times 10^3 \\times q_e$ 将能量从千电子伏转换为焦耳，其中 $q_e$ 是基本电荷，然后 $v(r) = \\sqrt{2 E_{\\mathrm{J}}(r) / m_i}$。\n- 假设为圆形截面和同心环，位于小半径 $r$ 处的薄壳层的环形微分体积元为 $dV = 4 \\pi^2 R_0 \\, r \\, dr$。\n- 体积CX损失密度为 $L_{\\mathrm{CX}}(r) = n_f(r) \\, \\nu_{\\mathrm{CX}}(r)$，其中 $n_f(r)$ 是快离子密度剖面。\n- 快离子总数为 $N_f = \\int_0^a n_f(r) \\, dV$。每个快离子的体积加权CX损失率为 $\\gamma_{\\mathrm{CX,eff}} = \\dfrac{\\int_0^a n_f(r) \\, \\nu_{\\mathrm{CX}}(r) \\, dV}{\\int_0^a n_f(r) \\, dV}$。\n- 定义没有CX损失时的基准约束时间为 $\\tau_0$，使得全局粒子平衡包含一个线性损失项 $N_f / \\tau_0$。将CX损失视为一个额外的、独立的、速率为 $\\gamma_{\\mathrm{CX,eff}}$ 的线性损失通道。根据此粒子平衡，确定快离子的有效约束时间 $\\tau_{\\mathrm{eff}}$。\n\n使用以下建模假设和参数化：\n- 离子质量: $m_i = 3.344 \\times 10^{-27} \\ \\mathrm{kg}$ (氘)。\n- 基本电荷: $q_e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$。\n- 几何参数: $R_0 = 1.7 \\ \\mathrm{m}$, $a = 0.6 \\ \\mathrm{m}$。\n- 快离子密度剖面: $n_f(r) = n_{f0} \\exp\\left( - \\left( \\dfrac{r}{w a} \\right)^2 \\right)$，其中 $n_{f0} = 3.0 \\times 10^{17} \\ \\mathrm{m}^{-3}$，形状参数为 $w$。\n- 快离子能量剖面: $E_{\\mathrm{keV}}(r) = E_b \\left( 1 - \\alpha \\left( \\dfrac{r}{a} \\right)^2 \\right)$，适用于 $0 \\le r \\le a$，其中束注入能量为 $E_b$，径向变化参数为 $\\alpha$。\n- 测量的中性粒子密度剖面: $n_n(r) = n_{n,\\mathrm{core}} + \\left( n_{n,\\mathrm{edge}} - n_{n,\\mathrm{core}} \\right) \\left( \\dfrac{r}{a} \\right)^{p_n}$，指数为 $p_n$。\n- 依赖于速度的CX截面，以千电子伏为单位的能量拟合形式为: $\\sigma\\!\\left(E_{\\mathrm{keV}}\\right) = \\sigma_{\\min} + \\dfrac{\\sigma_{\\max} - \\sigma_{\\min}}{1 + \\left( \\dfrac{E_{\\mathrm{keV}}}{E_0} \\right)^{p_{cs}} }$，参数为 $\\sigma_{\\min}$, $\\sigma_{\\max}$, $E_0$ 和 $p_{cs}$。\n\n任务：\n- 计算由附加线性损失模型所隐含的径向剖面 $L_{\\mathrm{CX}}(r)$ 和有效约束时间 $\\tau_{\\mathrm{eff}}$。同时计算约束退化因子 $d = \\tau_{\\mathrm{eff}} / \\tau_0$。\n- 除非另有明确说明，所有物理量必须使用国际单位制处理：距离以米为单位，密度以 $\\mathrm{m}^{-3}$ 为单位，截面以 $\\mathrm{m}^2$ 为单位，速度以 $\\mathrm{m/s}$ 为单位，能量在计算速度时从千电子伏转换为焦耳，时间以秒为单位。最终的约束时间以秒表示，四舍五入到六位小数，退化因子以十进制数表示，同样四舍五入到六位小数。\n- 数值实现：将 $r \\in [0,a]$ 均匀离散化，计算所需的剖面，并使用一种一致的数值积分方法（如梯形法则）来执行体积积分。\n\n测试套件：\n为以下四个覆盖不同工况范围的参数集提供输出：\n\n- 情况1（基准情况）：\n  - $\\tau_0 = 0.25 \\ \\mathrm{s}$， $E_b = 80 \\ \\mathrm{keV}$， $\\alpha = 0.3$， $w = 0.6$， $p_n = 4$，\n  - $n_{n,\\mathrm{core}} = 5.0 \\times 10^{14} \\ \\mathrm{m}^{-3}$， $n_{n,\\mathrm{edge}} = 3.0 \\times 10^{16} \\ \\mathrm{m}^{-3}$，\n  - $\\sigma_{\\min} = 0.6 \\times 10^{-20} \\ \\mathrm{m}^2$， $\\sigma_{\\max} = 2.5 \\times 10^{-19} \\ \\mathrm{m}^2$， $E_0 = 10 \\ \\mathrm{keV}$， $p_{cs} = 0.5$。\n- 情况2（中性粒子密度低，边缘上升较缓）：\n  - $\\tau_0 = 0.25 \\ \\mathrm{s}$， $E_b = 80 \\ \\mathrm{keV}$， $\\alpha = 0.3$， $w = 0.6$， $p_n = 2$，\n  - $n_{n,\\mathrm{core}} = 1.0 \\times 10^{14} \\ \\mathrm{m}^{-3}$， $n_{n,\\mathrm{edge}} = 1.0 \\times 10^{16} \\ \\mathrm{m}^{-3}$，\n  - $\\sigma_{\\min} = 0.6 \\times 10^{-20} \\ \\mathrm{m}^2$， $\\sigma_{\\max} = 2.5 \\times 10^{-19} \\ \\mathrm{m}^2$， $E_0 = 10 \\ \\mathrm{keV}$， $p_{cs} = 0.5$。\n- 情况3（中性粒子密度高，边缘急剧上升，快离子剖面较窄）：\n  - $\\tau_0 = 0.25 \\ \\mathrm{s}$， $E_b = 80 \\ \\mathrm{keV}$， $\\alpha = 0.3$， $w = 0.5$， $p_n = 8$，\n  - $n_{n,\\mathrm{core}} = 1.0 \\times 10^{15} \\ \\mathrm{m}^{-3}$， $n_{n,\\mathrm{edge}} = 5.0 \\times 10^{16} \\ \\mathrm{m}^{-3}$，\n  - $\\sigma_{\\min} = 0.6 \\times 10^{-20} \\ \\mathrm{m}^2$， $\\sigma_{\\max} = 2.5 \\times 10^{-19} \\ \\mathrm{m}^2$， $E_0 = 10 \\ \\mathrm{keV}$， $p_{cs} = 0.5$。\n- 情况4（束能量更高）：\n  - $\\tau_0 = 0.25 \\ \\mathrm{s}$， $E_b = 120 \\ \\mathrm{keV}$， $\\alpha = 0.3$， $w = 0.6$， $p_n = 4$，\n  - $n_{n,\\mathrm{core}} = 5.0 \\times 10^{14} \\ \\mathrm{m}^{-3}$， $n_{n,\\mathrm{edge}} = 3.0 \\times 10^{16} \\ \\mathrm{m}^{-3}$，\n  - $\\sigma_{\\min} = 0.6 \\times 10^{-20} \\ \\mathrm{m}^2$， $\\sigma_{\\max} = 2.5 \\times 10^{-19} \\ \\mathrm{m}^2$， $E_0 = 10 \\ \\mathrm{keV}$， $p_{cs} = 0.5$。\n\n答案规格：\n- 对每种情况，计算以秒为单位的 $\\tau_{\\mathrm{eff}}$ 和 $d = \\tau_{\\mathrm{eff}}/\\tau_0$，两者均四舍五入到六位小数。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\tau_{\\mathrm{eff},1}, d_1, \\tau_{\\mathrm{eff},2}, d_2, \\tau_{\\mathrm{eff},3}, d_3, \\tau_{\\mathrm{eff},4}, d_4]$。",
            "solution": "该问题提法清晰，有科学依据，并包含了求解所需的所有必要信息。\n\n目标是计算托卡马克等离子体中快离子的有效约束时间 $\\tau_{\\mathrm{eff}}$，其中考虑了与背景中性粒子发生电荷交换（CX）所造成的损失，并通过因子 $d = \\tau_{\\mathrm{eff}} / \\tau_0$ 来量化约束的退化程度。\n\n分析始于快离子总数 $N_f$ 的全局粒子平衡。问题指定了一个特征时间为 $\\tau_0$ 的基准损失机制，对应的损失率为 $N_f / \\tau_0$。电荷交换过程引入了一个额外的、独立的损失通道。该损失通道的速率由 $\\gamma_{\\mathrm{CX,eff}} N_f$ 给出，其中 $\\gamma_{\\mathrm{CX,eff}}$ 是体积加权的平均CX碰撞频率。因此，快离子总数随时间的总变化率为：\n$$\n\\frac{dN_f}{dt} = S - \\frac{N_f}{\\tau_0} - \\gamma_{\\mathrm{CX,eff}} N_f\n$$\n其中 $S$ 是快离子的源率。此方程可重写为：\n$$\n\\frac{dN_f}{dt} = S - N_f \\left( \\frac{1}{\\tau_0} + \\gamma_{\\mathrm{CX,eff}} \\right)\n$$\n括号中的项代表总逆约束时间。因此，有效约束时间 $\\tau_{\\mathrm{eff}}$ 由以下关系定义：\n$$\n\\frac{1}{\\tau_{\\mathrm{eff}}} = \\frac{1}{\\tau_0} + \\gamma_{\\mathrm{CX,eff}}\n$$\n求解 $\\tau_{\\mathrm{eff}}$ 可得：\n$$\n\\tau_{\\mathrm{eff}} = \\left( \\frac{1 + \\tau_0 \\gamma_{\\mathrm{CX,eff}}}{\\tau_0} \\right)^{-1} = \\frac{\\tau_0}{1 + \\tau_0 \\gamma_{\\mathrm{CX,eff}}}\n$$\n约束退化因子 $d$ 是有效约束时间与基准约束时间的比值：\n$$\nd = \\frac{\\tau_{\\mathrm{eff}}}{\\tau_0} = \\frac{1}{1 + \\tau_0 \\gamma_{\\mathrm{CX,eff}}}\n$$\n中心任务是计算有效CX损失率 $\\gamma_{\\mathrm{CX,eff}}$。它被定义为局域CX损失频率 $\\nu_{\\mathrm{CX}}(r)$ 的体积加权平均值：\n$$\n\\gamma_{\\mathrm{CX,eff}} = \\frac{\\int_V n_f(\\vec{x}) \\, \\nu_{\\mathrm{CX}}(\\vec{x}) \\, dV}{\\int_V n_f(\\vec{x}) \\, dV}\n$$\n鉴于环向对称性和环形基本体积壳层 $dV = 4 \\pi^2 R_0 \\, r \\, dr$，对体积 $V$ 的积分可以简化为对小半径 $r$ 从 $0$ 到 $a$ 的一维积分：\n$$\n\\gamma_{\\mathrm{CX,eff}} = \\frac{\\int_0^a n_f(r) \\, \\nu_{\\mathrm{CX}}(r) \\, (4 \\pi^2 R_0 r) \\, dr}{\\int_0^a n_f(r) \\, (4 \\pi^2 R_0 r) \\, dr}\n$$\n常数因子 $4 \\pi^2 R_0$ 从分子和分母中约去，表达式简化为：\n$$\n\\gamma_{\\mathrm{CX,eff}} = \\frac{\\int_0^a n_f(r) \\, \\nu_{\\mathrm{CX}}(r) \\, r \\, dr}{\\int_0^a n_f(r) \\, r \\, dr}\n$$\n为计算这些积分，我们必须首先构建被积函数中各量的径向剖面。局域CX损失频率为 $\\nu_{\\mathrm{CX}}(r) = n_n(r) \\, \\sigma(v(r)) \\, v(r)$。所需的剖面按以下方式构建：\n\n1.  **快离子密度剖面：** 快离子密度剖面由高斯函数给出：\n    $$\n    n_f(r) = n_{f0} \\exp\\left( - \\left( \\frac{r}{w a} \\right)^2 \\right)\n    $$\n    其中 $n_{f0} = 3.0 \\times 10^{17} \\ \\mathrm{m}^{-3}$。\n\n2.  **中性粒子密度剖面：** 中性粒子密度剖面由幂律模型给出：\n    $$\n    n_n(r) = n_{n,\\mathrm{core}} + (n_{n,\\mathrm{edge}} - n_{n,\\mathrm{core}}) \\left( \\frac{r}{a} \\right)^{p_n}\n    $$\n\n3.  **快离子能量和速度剖面：** 快离子平均能量剖面以千电子伏（$\\mathrm{keV}$）为单位给出：\n    $$\n    E_{\\mathrm{keV}}(r) = E_b \\left( 1 - \\alpha \\left( \\frac{r}{a} \\right)^2 \\right)\n    $$\n    首先使用基本电荷 $q_e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$ 将该能量转换为焦耳：\n    $$\n    E_{\\mathrm{J}}(r) = E_{\\mathrm{keV}}(r) \\times 10^3 \\times q_e\n    $$\n    然后根据动能关系 $E = \\frac{1}{2} m_i v^2$ 确定相应的快离子速度 $v(r)$，其中快离子质量为 $m_i = 3.344 \\times 10^{-27} \\ \\mathrm{kg}$：\n    $$\n    v(r) = \\sqrt{\\frac{2 E_{\\mathrm{J}}(r)}{m_i}}\n    $$\n\n4.  **电荷交换截面剖面：** CX截面 $\\sigma$ 依赖于快离子能量，以 $E_{\\mathrm{keV}}$ 的拟合函数形式给出：\n    $$\n    \\sigma(E_{\\mathrm{keV}}) = \\sigma_{\\min} + \\frac{\\sigma_{\\max} - \\sigma_{\\min}}{1 + \\left( \\frac{E_{\\mathrm{keV}}}{E_0} \\right)^{p_{cs}}}\n    $$\n    通过将 $E_{\\mathrm{keV}}(r)$ 代入此公式，我们得到截面的径向剖面 $\\sigma(r) = \\sigma(E_{\\mathrm{keV}}(r))$。\n\n5.  **电荷交换频率剖面：** 将所有分量组合起来，计算局域CX频率剖面如下：\n    $$\n    \\nu_{\\mathrm{CX}}(r) = n_n(r) \\, \\sigma(r) \\, v(r)\n    $$\n\n由于被积函数的复杂性，$\\gamma_{\\mathrm{CX,eff}}$ 的积分没有简单的解析解。因此，需要采用数值方法。将径向域 $r \\in [0, a]$ 离散化为均匀的网格点。在每个网格点上计算剖面 $n_f(r)$、 $n_n(r)$、 $v(r)$、 $\\sigma(r)$ 和 $\\nu_{\\mathrm{CX}}(r)$。然后计算分子的被积函数 $I_{num}(r) = n_f(r) \\, \\nu_{\\mathrm{CX}}(r) \\, r$ 和分母的被积函数 $I_{den}(r) = n_f(r) \\, r$。\n定积分使用梯形法则进行近似计算。对于一个函数 $f(r)$ 和一组网格点 $r_i$，积分为：\n$$\n\\int_0^a f(r) \\, dr \\approx \\sum_{i=0}^{N-2} \\frac{f(r_i) + f(r_{i+1})}{2} (r_{i+1} - r_i)\n$$\n其中 $N$ 是网格点的数量。在计算出分子积分 $I_{num} = \\int_0^a I_{num}(r) \\, dr$ 和分母积分 $I_{den} = \\int_0^a I_{den}(r) \\, dr$ 的数值后，有效CX损失率即可求得，为 $\\gamma_{\\mathrm{CX,eff}} = I_{num} / I_{den}$。\n\n最后，将该值代回 $\\tau_{\\mathrm{eff}}$ 和 $d$ 的表达式中，以获得每个给定参数集的最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effective fast-ion confinement time and degradation factor\n    due to charge-exchange losses in a tokamak plasma.\n    \"\"\"\n\n    # Physical and geometrical constants\n    M_I = 3.344e-27  # Mass of deuterium ion (kg)\n    Q_E = 1.602176634e-19  # Elementary charge (C)\n    R_0 = 1.7  # Major radius (m)\n    A = 0.6  # Minor radius (m)\n    N_F0 = 3.0e17 # Central fast-ion density (m^-3)\n    \n    # Numerical integration parameters\n    NUM_POINTS = 2001\n    \n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1 (baseline)\n        {\n            \"tau0\": 0.25, \"Eb\": 80.0, \"alpha\": 0.3, \"w\": 0.6, \"pn\": 4.0,\n            \"n_n_core\": 5.0e14, \"n_n_edge\": 3.0e16,\n            \"sigma_min\": 0.6e-20, \"sigma_max\": 2.5e-19, \"E0\": 10.0, \"pcs\": 0.5\n        },\n        # Case 2 (low neutrals, milder edge rise)\n        {\n            \"tau0\": 0.25, \"Eb\": 80.0, \"alpha\": 0.3, \"w\": 0.6, \"pn\": 2.0,\n            \"n_n_core\": 1.0e14, \"n_n_edge\": 1.0e16,\n            \"sigma_min\": 0.6e-20, \"sigma_max\": 2.5e-19, \"E0\": 10.0, \"pcs\": 0.5\n        },\n        # Case 3 (high neutrals, steep edge rise, narrower fast-ion profile)\n        {\n            \"tau0\": 0.25, \"Eb\": 80.0, \"alpha\": 0.3, \"w\": 0.5, \"pn\": 8.0,\n            \"n_n_core\": 1.0e15, \"n_n_edge\": 5.0e16,\n            \"sigma_min\": 0.6e-20, \"sigma_max\": 2.5e-19, \"E0\": 10.0, \"pcs\": 0.5\n        },\n        # Case 4 (higher beam energy)\n        {\n            \"tau0\": 0.25, \"Eb\": 120.0, \"alpha\": 0.3, \"w\": 0.6, \"pn\": 4.0,\n            \"n_n_core\": 5.0e14, \"n_n_edge\": 3.0e16,\n            \"sigma_min\": 0.6e-20, \"sigma_max\": 2.5e-19, \"E0\": 10.0, \"pcs\": 0.5\n        }\n    ]\n\n    results = []\n    \n    # Create the radial grid\n    r_grid = np.linspace(0, A, NUM_POINTS)\n    r_norm = r_grid / A\n\n    for case in test_cases:\n        # Unpack parameters for the current case\n        tau0 = case[\"tau0\"]\n        w = case[\"w\"]\n        Eb = case[\"Eb\"]\n        alpha = case[\"alpha\"]\n        n_n_core = case[\"n_n_core\"]\n        n_n_edge = case[\"n_n_edge\"]\n        pn = case[\"pn\"]\n        sigma_min = case[\"sigma_min\"]\n        sigma_max = case[\"sigma_max\"]\n        E0 = case[\"E0\"]\n        pcs = case[\"pcs\"]\n\n        # 1. Fast-ion density profile n_f(r)\n        nf_profile = N_F0 * np.exp(-(r_grid / (w * A))**2)\n\n        # 2. Fast-ion energy profile E_keV(r)\n        E_keV_profile = Eb * (1 - alpha * r_norm**2)\n        # Ensure energy is non-negative\n        E_keV_profile[E_keV_profile  0] = 0\n\n        # 3. Fast-ion speed profile v(r)\n        E_J_profile = E_keV_profile * 1e3 * Q_E\n        v_profile = np.sqrt(2 * E_J_profile / M_I)\n\n        # 4. CX cross-section profile sigma(r)\n        # Handle potential division by zero at E_keV=0, although formula is safe\n        # As E_keV -> 0, E_keV/E0 -> 0, denominator -> 1, result is sigma_max\n        sigma_profile = sigma_min + (sigma_max - sigma_min) / (1 + (E_keV_profile / E0)**pcs)\n\n        # 5. Neutral density profile n_n(r)\n        nn_profile = n_n_core + (n_n_edge - n_n_core) * r_norm**pn\n\n        # 6. CX frequency profile nu_CX(r)\n        nu_cx_profile = nn_profile * sigma_profile * v_profile\n\n        # 7. Define integrands for gamma_CX,eff calculation\n        integrand_num = nf_profile * nu_cx_profile * r_grid\n        integrand_den = nf_profile * r_grid\n\n        # 8. Perform numerical integration using the trapezoidal rule\n        integral_num = np.trapz(integrand_num, r_grid)\n        integral_den = np.trapz(integrand_den, r_grid)\n\n        # 9. Calculate the effective CX loss rate gamma_CX,eff\n        gamma_cx_eff = 0\n        if integral_den > 0:\n            gamma_cx_eff = integral_num / integral_den\n\n        # 10. Calculate effective confinement time and degradation factor\n        tau_eff = tau0 / (1 + tau0 * gamma_cx_eff)\n        d = tau_eff / tau0\n        \n        results.extend([round(tau_eff, 6), round(d, 6)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}