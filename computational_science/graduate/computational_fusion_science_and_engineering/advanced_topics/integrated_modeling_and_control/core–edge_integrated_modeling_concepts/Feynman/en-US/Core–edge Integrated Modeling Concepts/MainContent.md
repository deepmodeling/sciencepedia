## Introduction
Building a predictive model of a fusion reactor—a "[virtual tokamak](@entry_id:1133833)"—is one of the grand challenges in computational science. This endeavor is complicated by the fact that a tokamak plasma is not a uniform entity, but a collection of distinct regions, from the searingly hot core to the cooler, turbulent edge. These regions are governed by different physical laws and evolve on different timescales, making a single, monolithic simulation intractable. The central problem, therefore, is how to develop a holistic understanding by consistently coupling the specialized models that describe these disparate domains.

This article provides a comprehensive overview of the concepts behind [core–edge integrated modeling](@entry_id:1123076), the discipline dedicated to solving this complex puzzle. We will first delve into the fundamental physics that divides the plasma world and the numerical strategies developed to bridge this divide. Next, we will explore the powerful applications of these integrated models, showing how they reveal the intricate dialogue between the core and the edge and enable the optimization of reactor performance. Finally, we will ground these theories in application through a series of hands-on practices.

Across the following chapters, you will learn the essential principles and mechanisms for coupling disparate plasma regimes, see how these integrated simulations are used as indispensable tools for both science and engineering, and gain practical experience with the core calculations that underpin this field.

## Principles and Mechanisms

To build a virtual fusion reactor, one that lives inside a supercomputer, is not a matter of writing a single, monolithic piece of code. A tokamak is not a uniform ball of gas; it is a fantastically complex and structured ecosystem of plasma regimes, each with its own character, its own language of physics, and its own timescale. The art of core-edge integrated modeling lies in understanding these different regions, building specialized tools for each, and, most importantly, teaching them to communicate in a way that respects the fundamental laws of nature. It’s a grand exercise in digital diplomacy, governed by the unyielding principles of conservation.

### A Tale of Two Plasmas: The Great Divide

Imagine looking at the magnetic field of a modern tokamak. You would not see a simple, [uniform structure](@entry_id:150536). Instead, you would see a beautifully nested set of magnetic surfaces, like the layers of an onion, filling the hot, dense core of the machine. These are the **closed flux surfaces**. A charged particle, a tiny ion or electron, placed on one of these surfaces is magnetically confined; it will spiral along the field line, but the line itself never ends, looping around the torus endlessly. These particles are residents of the "core," a walled city where they can live for a relatively long time, their escape being a slow, difficult process of leaking across the magnetic walls.

But then, at a distinct boundary, the topology changes dramatically. This boundary is called the **separatrix**. It is the last closed flux surface, the outermost wall of our city. Beyond it lie the **open field lines** of the Scrape-Off Layer (SOL) and divertor. A particle that finds its way onto one of these lines is no longer confined. It is now in the countryside, on a highway that leads directly to a physical, material boundary—the divertor targets. Its journey is swift and final.

This fundamental division of the world into closed and open field lines is the single most important concept in core-edge modeling. It is why we partition the problem. The transport physics in these two regions is as different as night and day. In the core, transport is a slow, cross-field diffusion, a "leaking" governed by collisions and turbulence. In the SOL, transport is dominated by rapid, nearly unimpeded flow *along* the magnetic field lines to the divertor plates. The [separatrix](@entry_id:175112) itself is a special contour, often passing through one or more **X-points**, which are nulls in the [poloidal magnetic field](@entry_id:753563)—think of them as special gateways in the city wall. Regions like the **private flux region**, bounded by the separatrix legs leading to the divertor, have their own unique connection topology to the walls, further complicating the picture at the plasma's edge.

### The Guardian at the Gate: The Pedestal Transport Barrier

The boundary between the core and the edge is not just a simple line. In high-performance plasmas, or H-mode, a remarkable structure forms just inside the separatrix: the **pedestal**. Think of this not just as a wall, but as an incredibly thick, well-guarded fortification. It is a narrow region, only a few centimeters wide, where the plasma pressure and temperature drop precipitously from their high core values to the much lower values of the edge. This steep gradient is the signature of a **[transport barrier](@entry_id:756131)**.

What magical physics builds this wall? The steep pressure gradient, according to the laws of plasma [force balance](@entry_id:267186), generates a very strong **[radial electric field](@entry_id:194700)**, $E_r$. This electric field is not uniform; it varies sharply across the pedestal, creating a region of intense $E_r$ shear. This shear acts like a microscopic blender, tearing apart the large-scale turbulent eddies and vortices that are the primary drivers of transport in the main core. Instabilities that cause a slow leak through the core, such as Ion Temperature Gradient (ITG) modes, are largely suppressed here.

However, this wall is not impregnable. By suppressing one form of transport, the plasma allows the pressure gradient to build until it becomes vulnerable to a different class of, often more violent, instabilities. These are large-scale Magnetohydrodynamic (MHD) modes, such as **[peeling-ballooning modes](@entry_id:753311)**, which are driven by the combination of the steep pressure gradient and the strong electrical currents it generates. When the pedestal grows too high and steep, it can cross the stability limit for these modes, leading to a catastrophic collapse of the barrier known as an Edge Localized Mode (ELM)—an event that expels a burst of particles and energy towards the wall. The pedestal, therefore, lives in a constant state of tension, its height and width determined by a complex interplay between shear-suppressed turbulence and MHD stability limits. This entire drama is further colored by the plasma **collisionality** ($\nu^*$), which changes by orders of magnitude from the hot core to the cool edge, determining which physical effects, from kinetic to resistive, come into play.

### The Language of the Machine: Coordinates and Fluxes

To simulate this complex world, we must first describe it in a language a computer can understand. Using a simple Cartesian $(x,y,z)$ grid is a poor choice for a system whose physics is so completely dominated by the magnetic field. Instead, we adopt a more natural description: **[flux coordinates](@entry_id:1125149)**. We use the magnetic surfaces themselves as one of our coordinates, say $\psi$, a poloidal angle $\theta$ to move along a surface, and the toroidal angle $\phi$ to go the long way around the torus. It’s like navigating a city by saying "I'm on the third ring road at the 5 o'clock position"—far more intuitive than using latitude and longitude. Of course, to perform calculations, we need a precise mathematical "map"—the metric tensor ($g_{ij}$) and Jacobian ($J$)—to translate distances, areas, and volumes from this curved, natural system back into physical space.

With our coordinate system established, we can focus on the "currencies" we need to track: particles, energy, and momentum. The global conservation laws tell us that the change in the amount of a substance in a volume is equal to what is created inside (sources) minus what flows out across the boundary (fluxes). In our plasma, these are the **particle flux** ($\boldsymbol{\Gamma}$), the **heat flux** ($\boldsymbol{Q}$), and the **momentum flux** ($\boldsymbol{\Pi}$).

What drives these fluxes across the magnetic surfaces in the core? There are two primary mechanisms. The first is **neoclassical transport**. This is the irreducible, baseline transport that arises simply from particle collisions in the complex toroidal magnetic geometry. The variation of the magnetic field strength on a flux surface causes particles to drift off their "home" surface, and collisions then prevent them from perfectly returning. It's a slow, steady, and predictable "friction" with the magnetic landscape. The second, and often dominant, mechanism is **turbulent transport**. This is the chaotic, [anomalous transport](@entry_id:746472) driven by a zoo of microinstabilities. Tiny fluctuations in density, temperature, and the [electromagnetic fields](@entry_id:272866) conspire to create a stormy, convective flow that can carry particles and heat out of the core far more effectively than neoclassical processes alone. Our integrated model must account for both of these phenomena.

### The Art of the Deal: Coupling the Core and Edge

We now have our two distinct regions—the core and the edge—and a description of the physics within them. Often, these are handled by two separate, highly specialized computer codes. The challenge of integrated modeling is to couple them together into a single, self-consistent simulation. The interface, the [separatrix](@entry_id:175112), is where the negotiation happens.

The cardinal rule of this negotiation is **conservation**. Particles and energy cannot magically appear or disappear at the interface. The total flux of particles leaving the core domain must *exactly* equal the total flux of particles entering the edge domain at every moment in time. A common but flawed approach is to simply ensure the temperature and density profiles are continuous. This is not enough. If the two codes calculate the flux from this continuous profile using different methods or different grids, a mismatch in the fluxes will occur, creating an artificial source or sink of energy and particles at the interface, violating the laws of physics.

The correct approach is to make the flux itself the subject of the contract. One code calculates the flux crossing the boundary, and the other code accepts this value as its input. This is the only way to guarantee discrete conservation. To implement this "contract," numerical analysts have developed sophisticated domain decomposition strategies. In a **non-overlapping** scheme, where the two domains meet at a sharp boundary, one might use a Dirichlet-Neumann iteration: the core code provides a temperature value (a Dirichlet condition) to the edge code, and the edge code computes the resulting heat flux and passes it back (a Neumann condition). They iterate until both temperature and flux are continuous. Alternatively, **overlapping** schemes, like the Schwarz method, create a small overlapping region and iteratively exchange [state variables](@entry_id:138790) (like temperature) at the artificial boundaries until the solutions agree throughout the overlap, which implicitly ensures the fluxes match too.

To verify that the "deal" is being honored, we can compute diagnostic checksums. After each time step, we can check that the flux out of the core plus the flux into the edge sums to zero. More importantly, we can check global conservation: the total change in particles and energy across the entire machine must equal the total power we've put in minus what has been lost to the walls. If this balance holds, our coupling is conservative.

### The End of the Line: Interacting with the Wall

The plasma's journey ends at the material surfaces of the divertor. This final interaction is mediated by the **sheath**, a microscopic layer only fractions of a millimeter thick that forms at the plasma-wall interface. Here, the plasma loses its quasi-neutrality, developing a strong electric field that accelerates ions and repels most electrons.

Two key pieces of physics from this tiny region provide the ultimate boundary conditions for the entire simulation. The first is the **Bohm criterion**. It states that for a stable sheath to form, ions must enter it traveling at least at the local **ion sound speed**, $c_s = \sqrt{k_B(T_e + T_i)/m_i}$. It's like a river accelerating as it approaches a waterfall; the flow must become sonic at the ledge. This sets a definitive boundary condition on the plasma flow velocity at the wall.

The second is the **[sheath heat transmission coefficient](@entry_id:1131561)**, $\gamma$. This dimensionless number tells us how much total energy (kinetic plus thermal) is deposited on the surface for each ion that strikes it. It is the "toll" that the plasma pays to exit the system. This relation provides a boundary condition for the energy equation, linking the heat flux to the particle flux and temperatures at the wall. These sheath conditions provide the physical sink for particles and energy that are being transported out of the core, across the separatrix, and along the SOL. In some simplified models, the physics of the entire SOL and sheath is condensed into a single, effective boundary condition applied directly at the separatrix, a testament to the power of multi-scale thinking.

### Beyond Fluids: The Kinetic-Fluid Handshake

So far, our discussion has largely assumed a fluid description of the plasma. This works well in the collisional edge but can be inadequate for the searingly hot, nearly collisionless core. In these regimes, a more fundamental **gyrokinetic** description is needed, which tracks the evolution of the particle distribution function, $f(v)$, in phase space.

This presents the ultimate coupling challenge: interfacing a kinetic core model with a fluid edge model. We must now match a distribution function $f$ to fluid moments like density $n$ and temperature $T$. The governing gyrokinetic equation is hyperbolic, meaning information flows along characteristics. This has a profound implication for the boundary condition: we can only specify the distribution function for particles that are *entering* the core simulation domain—the **inflow boundary**. The distribution of particles *leaving* the core is an outcome of the simulation and cannot be prescribed. The art of kinetic-fluid coupling, therefore, involves constructing a physically-sensible inflow distribution function whose velocity moments—the integrated fluxes of particles, momentum, and energy—are consistent with the fluxes provided by the fluid model of the edge. It is at this frontier where the physics of microscopic distributions meets the macroscopic world of fluid transport, representing one of the most advanced and active areas in the quest to build a truly predictive virtual tokamak.