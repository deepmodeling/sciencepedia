{
    "hands_on_practices": [
        {
            "introduction": "这项实践是一次在辐射测量学和几何光学方面的基础性推导。通过为一个理想化的针孔相机模型计算其信号响应，您将亲手推导仪器核函数 $K(\\mathbf{x})$，并理解孔径和渐晕等几何效应如何塑造诊断的视场和灵敏度 。这个练习是从第一性原理构建任何光学诊断模型的第一步。",
            "id": "4051679",
            "problem": "一种模拟弦道诊断被用于验证磁约束聚变装置中等离子体发射的计算模型。该诊断被建模为一个理想化的针孔相机，其具有面积为 $A$ 的圆形孔径、一个位于平面 $z=0$ 的无限薄不透明屏，以及一个与 $+z$ 轴对齐的法向量。等离子体占据半空间 $z>0$。该诊断收集从等离子体各向同性发射的光，其测量是线积分的，即记录到的信号 $S$ 可以写成体积发射率 $\\epsilon(\\mathbf{x})$ 乘以一个有效弦核 $K(\\mathbf{x})$ 的积分。\n\n从基本的辐射度学定义和几何光学出发，使用以下基础：\n- 体积发射率 $\\epsilon(\\mathbf{x})$ 的单位是瓦特/立方米，表示单位体积向所有立体角发射的总辐射功率。\n- 对于各向同性源，从微分体积元 $d^{3}x$ 发出并到达距离为 $r$、与探测器法线夹角为 $\\theta$ 的微分探测器面积 $dA$ 的功率为 $dP = \\epsilon(\\mathbf{x})\\,d^{3}x \\times \\frac{d\\Omega}{4\\pi}$，其中 $d\\Omega = \\frac{dA \\cos\\theta}{r^{2}}$。\n- 仪器的有限孔径和渐晕效应由一个无量纲的角度传输函数 $V(\\theta)$ 表示，该函数乘以几何通量，且 $0 \\leq V(\\theta) \\leq 1$。\n\n假设采用柱坐标系 $(R,\\phi,z)$，孔径中心位于原点。几何因子为 $r = \\sqrt{R^{2} + z^{2}}$ 和 $\\cos\\theta = \\frac{z}{r}$。视场光阑施加了一个半角为 $\\theta_{c}$ 的硬接收锥，并伴有朝向视场边缘的二次渐晕，其模型为\n$$\nV(\\theta) = \\begin{cases}\n1 - \\left(\\frac{\\tan\\theta}{\\tan\\theta_{c}}\\right)^{2},  & \\theta \\leq \\theta_{c}, \\\\\n0,  & \\theta > \\theta_{c}.\n\\end{cases}\n$$\n这对非零通量施加了 $R \\leq z \\tan\\theta_{c}$ 的几何约束。\n\n设等离子体发射率是可分离的，并沿 $z$ 轴按如下规律衰减\n$$\n\\epsilon(R,\\phi,z) = \\epsilon_{0}\\,\\exp\\!\\left(-\\frac{z}{\\lambda}\\right),\n$$\n其中常数 $\\epsilon_{0} > 0$ 和 $\\lambda > 0$，且与 $R$ 和 $\\phi$ 无关。根据上述原理，严格推导有效弦核 $K(\\mathbf{x})$，并明确展示有限孔径和渐晕效应如何修正 $K(\\mathbf{x})$。然后计算得到的模拟诊断信号\n$$\nS = \\int_{\\mathbb{R}^{3}} \\epsilon(\\mathbf{x})\\,K(\\mathbf{x})\\,d^{3}x,\n$$\n其中积分域受限于半空间 $z>0$ 和接收锥 $R \\leq z \\tan\\theta_{c}$。将 $S$ 的最终答案表示为关于 $\\epsilon_{0}$、$\\lambda$、$A$ 和 $\\theta_{c}$ 的单一闭合形式解析表达式。以瓦特为单位表示最终信号。最终表达式中不需要进行数值代入，也不允许进行任何近似。在最终的方框答案中不要包含任何单位。",
            "solution": "问题陈述具有科学依据，提法恰当，客观，并包含一套完整且一致的定义和约束。它代表了辐射度学应用于等离子体诊断中的一个标准但非平凡的问题。因此，该问题被认为是有效的，有必要给出完整解答。\n\n诊断仪记录的总信号 $S$ 是来自等离子体每个微分体积元 $d^3x$ 的功率贡献 $dP$ 的积分。从体积发射率为 $\\epsilon(\\mathbf{x})$ 的各向同性源发出、被面积为 $A$ 的孔径收集的功率 $dP$，由体积元发射的总功率 $\\epsilon(\\mathbf{x}) d^3x$ 与探测器有效接收的立体角占总 $4\\pi$ 立体角的分数的乘积给出。这个有效立体角包括了几何通量和渐晕效应。\n\n来自位置 $\\mathbf{x}$ 处体积元 $d^3x$ 的功率 $dP$ 为：\n$$\ndP = \\epsilon(\\mathbf{x}) d^3x \\frac{\\Omega_{\\text{eff}}}{4\\pi}\n$$\n其中 $\\Omega_{\\text{eff}}$ 是孔径所对应的有效立体角。它由几何立体角乘以角度传输函数 $V(\\theta)$ 给出：\n$$\n\\Omega_{\\text{eff}} = \\frac{A \\cos\\theta}{r^2} V(\\theta)\n$$\n这里，$r$ 是体积元到孔径的距离，$\\theta$ 是位置向量与探测器法线（$+z$ 轴）之间的夹角。\n\n将此代入 $dP$ 的表达式得到：\n$$\ndP = \\epsilon(\\mathbf{x}) \\frac{A \\cos\\theta V(\\theta)}{4\\pi r^2} d^3x\n$$\n总信号 $S$ 是 $dP$ 在整个等离子体体积上的积分：\n$$\nS = \\int_{\\text{volume}} dP = \\int_{\\mathbb{R}^3} \\epsilon(\\mathbf{x}) \\frac{A \\cos\\theta V(\\theta)}{4\\pi r^2} d^3x\n$$\n问题将信号定义为 $S = \\int \\epsilon(\\mathbf{x}) K(\\mathbf{x}) d^3x$。通过直接比较，有效弦核 $K(\\mathbf{x})$ 为：\n$$\nK(\\mathbf{x}) = \\frac{A \\cos\\theta V(\\theta)}{4\\pi r^2}\n$$\n这完成了推导的第一部分。现在我们用指定的柱坐标 $(R, \\phi, z)$ 来表示这个核函数。几何关系给出为 $r = \\sqrt{R^2+z^2}$ 和 $\\cos\\theta = z/r = z/\\sqrt{R^2+z^2}$。传输函数 $V(\\theta)$ 用 $\\tan\\theta = R/z$ 表示。将这些代入 $K(\\mathbf{x})$ 的表达式，得到：\n$$\nK(R, \\phi, z) = \\frac{A}{4\\pi} \\frac{z}{(R^2+z^2)^{3/2}} V(\\theta(R,z))\n$$\n其中\n$$\nV(\\theta(R,z)) = \\begin{cases}\n1 - \\left(\\frac{R/z}{\\tan\\theta_{c}}\\right)^{2} = 1 - \\frac{R^2}{z^2 \\tan^2\\theta_{c}},  & \\text{for } R \\leq z \\tan\\theta_{c} \\\\\n0,  & \\text{for } R > z \\tan\\theta_{c}\n\\end{cases}\n$$\n因此，核函数仅在由 $R \\leq z \\tan\\theta_c$ 定义的接收锥内非零。\n\n接下来，我们通过在等离子体体积上积分 $\\epsilon(\\mathbf{x}) K(\\mathbf{x})$ 的乘积来计算总信号 $S$。柱坐标系中的体积元是 $d^3x = R\\,dR\\,d\\phi\\,dz$。发射率给出为 $\\epsilon(R,\\phi,z) = \\epsilon_0 \\exp(-z/\\lambda)$。积分域是受接收锥约束的 $z>0$ 半空间。\n$S$ 的积分为：\n$$\nS = \\int_0^\\infty dz \\int_0^{2\\pi} d\\phi \\int_0^{z\\tan\\theta_c} R \\left(\\epsilon_0 \\exp(-z/\\lambda)\\right) \\left(\\frac{A z}{4\\pi(R^2+z^2)^{3/2}} \\left(1-\\frac{R^2}{z^2\\tan^2\\theta_c}\\right)\\right) dR\n$$\n由于被积函数与 $\\phi$ 无关，对 $\\phi$ 的积分产生一个因子 $2\\pi$。我们也可以将常数提出。\n$$\nS = \\frac{2\\pi A \\epsilon_0}{4\\pi} \\int_0^\\infty dz \\, z \\exp(-z/\\lambda) \\int_0^{z\\tan\\theta_c} \\left(\\frac{R}{(R^2+z^2)^{3/2}} - \\frac{R^3}{z^2\\tan^2\\theta_c(R^2+z^2)^{3/2}}\\right) dR\n$$\n我们来计算关于 $R$ 的内层积分，记为 $I_R(z)$：\n$$\nI_R(z) = \\int_0^{z\\tan\\theta_c} \\left(\\frac{R}{(R^2+z^2)^{3/2}} - \\frac{1}{z^2\\tan^2\\theta_c} \\frac{R^3}{(R^2+z^2)^{3/2}}\\right) dR\n$$\n我们进行换元，令 $u = R^2+z^2$，这意味着 $du = 2R\\,dR$ 且 $R^2=u-z^2$。$u$ 的积分上下限变为：\n当 $R=0$ 时，$u = z^2$。\n当 $R=z\\tan\\theta_c$ 时，$u = (z\\tan\\theta_c)^2 + z^2 = z^2(\\tan^2\\theta_c+1) = z^2\\sec^2\\theta_c = z^2/\\cos^2\\theta_c$。\n$$\nI_R(z) = \\frac{1}{2} \\int_{z^2}^{z^2/\\cos^2\\theta_c} \\left(\\frac{1}{u^{3/2}} - \\frac{u-z^2}{z^2\\tan^2\\theta_c\\, u^{3/2}}\\right) du\n$$\n$$\nI_R(z) = \\frac{1}{2} \\int_{z^2}^{z^2/\\cos^2\\theta_c} \\left( u^{-3/2} - \\frac{1}{z^2\\tan^2\\theta_c} (u^{-1/2} - z^2 u^{-3/2}) \\right) du\n$$\n$$\nI_R(z) = \\frac{1}{2} \\int_{z^2}^{z^2/\\cos^2\\theta_c} \\left( \\left(1 + \\frac{1}{\\tan^2\\theta_c}\\right)u^{-3/2} - \\frac{1}{z^2\\tan^2\\theta_c} u^{-1/2} \\right) du\n$$\n使用恒等式 $1+\\cot^2\\theta_c = \\csc^2\\theta_c$，上式变为：\n$$\nI_R(z) = \\frac{1}{2} \\left[ \\csc^2\\theta_c (-2u^{-1/2}) - \\frac{\\cot^2\\theta_c}{z^2}(2u^{1/2}) \\right]_{z^2}^{z^2/\\cos^2\\theta_c}\n$$\n$$\nI_R(z) = \\left[ -\\csc^2\\theta_c u^{-1/2} - \\frac{\\cot^2\\theta_c}{z^2} u^{1/2} \\right]_{z^2}^{z^2/\\cos^2\\theta_c}\n$$\n在上限（$u=z^2/\\cos^2\\theta_c$）处求值：\n$$\n-\\csc^2\\theta_c \\left(\\frac{z}{\\cos\\theta_c}\\right)^{-1} - \\frac{\\cot^2\\theta_c}{z^2} \\left(\\frac{z}{\\cos\\theta_c}\\right) = -\\frac{1}{\\sin^2\\theta_c}\\frac{\\cos\\theta_c}{z} - \\frac{\\cos^2\\theta_c}{z\\sin^2\\theta_c}\\frac{1}{\\cos\\theta_c} = -\\frac{2\\cos\\theta_c}{z\\sin^2\\theta_c}\n$$\n在下限（$u=z^2$）处求值：\n$$\n-\\csc^2\\theta_c (z)^{-1} - \\frac{\\cot^2\\theta_c}{z^2} (z) = -\\frac{1}{z\\sin^2\\theta_c} - \\frac{\\cos^2\\theta_c}{z\\sin^2\\theta_c} = -\\frac{1+\\cos^2\\theta_c}{z\\sin^2\\theta_c}\n$$\n用上限减去下限：\n$$\nI_R(z) = \\frac{-2\\cos\\theta_c}{z\\sin^2\\theta_c} - \\left(-\\frac{1+\\cos^2\\theta_c}{z\\sin^2\\theta_c}\\right) = \\frac{1-2\\cos\\theta_c+\\cos^2\\theta_c}{z\\sin^2\\theta_c} = \\frac{(1-\\cos\\theta_c)^2}{z(1-\\cos^2\\theta_c)}\n$$\n$$\nI_R(z) = \\frac{(1-\\cos\\theta_c)^2}{z(1-\\cos\\theta_c)(1+\\cos\\theta_c)} = \\frac{1-\\cos\\theta_c}{z(1+\\cos\\theta_c)}\n$$\n现在，我们将此结果代回 $S$ 的表达式：\n$$\nS = \\frac{A \\epsilon_0}{2} \\int_0^\\infty dz \\, z \\exp(-z/\\lambda) \\, I_R(z) = \\frac{A \\epsilon_0}{2} \\int_0^\\infty dz \\, z \\exp(-z/\\lambda) \\left(\\frac{1-\\cos\\theta_c}{z(1+\\cos\\theta_c)}\\right)\n$$\n分子和分母中的因子 $z$ 相消。涉及 $\\theta_c$ 的项相对于 $z$ 是常数，可以移到积分号外。\n$$\nS = \\frac{A \\epsilon_0}{2} \\left(\\frac{1-\\cos\\theta_c}{1+\\cos\\theta_c}\\right) \\int_0^\\infty \\exp(-z/\\lambda) dz\n$$\n最后的积分是初等的：\n$$\n\\int_0^\\infty \\exp(-z/\\lambda) dz = \\left[-\\lambda \\exp(-z/\\lambda)\\right]_0^\\infty = 0 - (-\\lambda \\exp(0)) = \\lambda\n$$\n将其代回，得到总信号 $S$ 的最终表达式：\n$$\nS = \\frac{A \\epsilon_0 \\lambda}{2} \\left(\\frac{1-\\cos\\theta_c}{1+\\cos\\theta_c}\\right)\n$$\n所得表达式是用所需的常数 $\\epsilon_0$、$\\lambda$、$A$ 和 $\\theta_c$ 表示的。单位为 $(\\text{m}^2)(\\text{W}/\\text{m}^3)(\\text{m}) = \\text{W}$，这与辐射功率信号的预期一致。",
            "answer": "$$\\boxed{\\frac{A \\epsilon_{0} \\lambda (1-\\cos\\theta_{c})}{2(1+\\cos\\theta_{c})}}$$"
        },
        {
            "introduction": "从单一视线扩展到完整的二维成像，本练习探讨了点扩展函数 (Point-Spread Function, PSF) 的关键概念。您将分析仪器光学系统如何通过与真实辐射分布进行卷积来生成模糊的图像，并学习如何使用调制传递函数 (Modulation Transfer Function, MTF) 来量化空间分辨率，特别是在分辨率具有各向异性的情况下 。",
            "id": "4051667",
            "problem": "在计算聚变科学与工程中，合成相机诊断被用于验证辐射传输和成像代码，其方法是将合成图像与实验观测结果进行比较。假设该仪器在像平面上可以被建模为线性和移位不变的，因此空间局部输入的图像仅取决于输入和输出位置之间的相对位移。设像平面上的发射率场为标量函数 $\\epsilon(\\mathbf{x})$，其中 $\\mathbf{x} = (x,y)$。仪器对单位脉冲发射率（某一点的狄拉克δ函数）的响应定义了仪器的点扩展函数（PSF），记为 $\\mathrm{PSF}(\\mathbf{x})$。光学传递函数（OTF）定义为 $\\mathrm{PSF}(\\mathbf{x})$ 的傅里叶变换，而调制传递函数（MTF）是 OTF 的幅值。假设仪器是能量守恒的，即 $\\int \\mathrm{PSF}(\\mathbf{x})\\, d^2\\mathbf{x} = 1$。\n\n考虑一个各向异性的高斯 PSF，\n$$\n\\mathrm{PSF}(\\mathbf{x}) = \\frac{1}{2\\pi \\sigma_x \\sigma_y}\\exp\\!\\left(-\\frac{x^2}{2\\sigma_x^2} - \\frac{y^2}{2\\sigma_y^2}\\right)\n$$\n其中 $\\sigma_x > 0$ 且 $\\sigma_y > 0$。考虑以下用于合成诊断表征的发射率测试图案：\n- 点源 $\\epsilon(\\mathbf{x}) = \\delta(x)\\delta(y)$。\n- 正弦光栅 $\\epsilon(\\mathbf{x}) = \\epsilon_0\\left[1 + C\\cos(k_x x + k_y y)\\right]$，其中 $0 < C \\ll 1$，空间频率向量为 $\\mathbf{k} = (k_x,k_y)$。\n\n利用以上定义以及线性移位不变成像和傅里叶分析的基本性质，判断哪些关于合成图像形成以及 PSF 各向异性对分辨率度量影响的陈述是正确的。选择所有正确的选项。\n\nA. 对于线性和移位不变的仪器，合成图像由发射率与 PSF 的卷积给出：$I(\\mathbf{x}) = \\int \\epsilon(\\mathbf{x}')\\, \\mathrm{PSF}(\\mathbf{x}-\\mathbf{x}')\\, d^2\\mathbf{x}'$。\n\nB. 对于点源发射率 $\\epsilon(\\mathbf{x}) = \\delta(x)\\delta(y)$，合成图像等于 PSF：$I(\\mathbf{x}) = \\mathrm{PSF}(\\mathbf{x})$。\n\nC. 对于正弦光栅 $\\epsilon(\\mathbf{x}) = \\epsilon_0\\left[1 + C\\cos(k_x x + k_y y)\\right]$，图像对比度（余弦分量相对于直流水平的振幅）是 $C$ 乘以在 $\\mathbf{k}$ 处求值的调制传递函数，对于各向异性高斯 PSF，该值等于 $\\exp\\!\\left[-\\tfrac{1}{2}\\left(\\sigma_x^2 k_x^2 + \\sigma_y^2 k_y^2\\right)\\right]$。\n\nD. 点源图像的半峰全宽（FWHM），分别沿 $x$ 轴和 $y$ 轴测量，为 $2\\sqrt{2\\ln 2}\\,\\sigma_x$ 和 $2\\sqrt{2\\ln 2}\\,\\sigma_y$。\n\nE. 当 PSF 是各向异性时，通过在固定的 $|\\mathbf{k}|$ 下对调制传递函数按方向进行角度平均而构建的单一各向同性分辨率度量，通常会高估分辨率最差方向上的分辨率。\n\nF. PSF 中的各向异性不影响光学传递函数的幅值，只影响其相位，因此调制传递函数保持各向同性。\n\nG. 对于各向异性高斯 PSF，沿主轴的负三分贝空间频率（定义为对于与轴对齐的一维图案，调制传递函数等于 $1/2$ 时的波数）分别为 $k_x^{(-3\\mathrm{dB})} = \\sqrt{2\\ln 2}/\\sigma_x$ 和 $k_y^{(-3\\mathrm{dB})} = \\sqrt{2\\ln 2}/\\sigma_y$，这表明分辨率极限具有方向依赖性。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、适定、客观且内部一致的。它提出了一个应用于成像系统表征的线性系统理论和傅里叶光学的标准问题。所有定义和提供的数据都是标准的，足以对所提出的陈述进行严格评估。因此，我们可以进行分析。\n\nA. 对于线性和移位不变的仪器，合成图像由发射率与 PSF 的卷积给出：$I(\\mathbf{x}) = \\int \\epsilon(\\mathbf{x}')\\, \\mathrm{PSF}(\\mathbf{x}-\\mathbf{x}')\\, d^2\\mathbf{x}'$。\n\n这个陈述是线性移位不变（LSI）系统输出的数学定义。在成像科学中，被成像物体的属性（这里是发射率 $\\epsilon(\\mathbf{x})$）是输入信号。仪器由其对点脉冲的响应来表征，即点扩展函数（PSF）。对于一个 LSI 系统，图像 $I(\\mathbf{x})$ 是输入信号与系统脉冲响应的卷积。所给出的积分 $I(\\mathbf{x}) = (\\epsilon * \\mathrm{PSF})(\\mathbf{x}) = \\int \\epsilon(\\mathbf{x}')\\, \\mathrm{PSF}(\\mathbf{x}-\\mathbf{x}')\\, d^2\\mathbf{x}'$ 是这个二维卷积运算的正确数学表达式。\n\n**结论：正确。**\n\nB. 对于点源发射率 $\\epsilon(\\mathbf{x}) = \\delta(x)\\delta(y)$，合成图像等于 PSF：$I(\\mathbf{x}) = \\mathrm{PSF}(\\mathbf{x})$。\n\n使用陈述 A 中的卷积积分，并代入点源发射率 $\\epsilon(\\mathbf{x}) = \\delta(\\mathbf{x})$，我们计算图像 $I(\\mathbf{x})$：\n$$\nI(\\mathbf{x}) = \\int \\delta(\\mathbf{x}')\\, \\mathrm{PSF}(\\mathbf{x}-\\mathbf{x}')\\, d^2\\mathbf{x}'\n$$\n这个积分是狄拉克δ函数筛选性质的应用，该性质表明 $\\int f(\\mathbf{z}) \\delta(\\mathbf{z}-\\mathbf{a})\\,d\\mathbf{z} = f(\\mathbf{a})$。在我们的例子中，积分变量是 $\\mathbf{x}'$，δ函数位于 $\\mathbf{x}'=0$ 处，被筛选的函数是 $\\mathrm{PSF}(\\mathbf{x}-\\mathbf{x}')$。\n$$\nI(\\mathbf{x}) = \\mathrm{PSF}(\\mathbf{x}-0) = \\mathrm{PSF}(\\mathbf{x})\n$$\n这个结果与 PSF 作为点源图像的定义是一致的。\n\n**结论：正确。**\n\nC. 对于正弦光栅 $\\epsilon(\\mathbf{x}) = \\epsilon_0\\left[1 + C\\cos(k_x x + k_y y)\\right]$，图像对比度（余弦分量相对于直流水平的振幅）是 $C$ 乘以在 $\\mathbf{k}$ 处求值的调制传递函数，对于各向异性高斯 PSF，该值等于 $\\exp\\!\\left[-\\tfrac{1}{2}\\left(\\sigma_x^2 k_x^2 + \\sigma_y^2 k_y^2\\right)\\right]$。\n\n在傅里叶域中，卷积变成乘法：$\\mathcal{F}\\{I(\\mathbf{x})\\} = \\mathcal{F}\\{\\epsilon(\\mathbf{x})\\} \\cdot \\mathcal{F}\\{\\mathrm{PSF}(\\mathbf{x})\\}$，或者说 $\\hat{I}(\\mathbf{k}) = \\hat{\\epsilon}(\\mathbf{k}) \\cdot \\mathrm{OTF}(\\mathbf{k})$。\n输入发射率为 $\\epsilon(\\mathbf{x}) = \\epsilon_0 + \\epsilon_0 C \\cos(\\mathbf{k}_0 \\cdot \\mathbf{x})$，其中 $\\mathbf{k}_0 = (k_x, k_y)$ 是光栅的固定空间频率。使用恒等式 $\\cos(\\theta) = \\frac{1}{2}(e^{i\\theta} + e^{-i\\theta})$，$\\epsilon(\\mathbf{x})$ 的傅里叶变换是：\n$$\n\\hat{\\epsilon}(\\mathbf{k}) = \\epsilon_0 (2\\pi)^2 \\delta(\\mathbf{k}) + \\frac{\\epsilon_0 C (2\\pi)^2}{2} \\left[ \\delta(\\mathbf{k}-\\mathbf{k}_0) + \\delta(\\mathbf{k}+\\mathbf{k}_0) \\right]\n$$\n那么图像的傅里叶变换是：\n$$\n\\hat{I}(\\mathbf{k}) = \\hat{\\epsilon}(\\mathbf{k}) \\mathrm{OTF}(\\mathbf{k}) = \\epsilon_0 (2\\pi)^2 \\delta(\\mathbf{k})\\mathrm{OTF}(0) + \\frac{\\epsilon_0 C (2\\pi)^2}{2} \\left[ \\delta(\\mathbf{k}-\\mathbf{k}_0)\\mathrm{OTF}(\\mathbf{k}_0) + \\delta(\\mathbf{k}+\\mathbf{k}_0)\\mathrm{OTF}(-\\mathbf{k}_0) \\right]\n$$\n问题陈述中指出 $\\int \\mathrm{PSF}(\\mathbf{x})\\, d^2\\mathbf{x} = 1$，这意味着 $\\mathrm{OTF}(0) = 1$。由于 $\\mathrm{PSF}(\\mathbf{x})$ 是实函数，所以 $\\mathrm{OTF}(-\\mathbf{k}) = \\mathrm{OTF}^*(\\mathbf{k})$。进行傅里叶逆变换得到图像：\n$$\nI(\\mathbf{x}) = \\epsilon_0 \\mathrm{OTF}(0) + \\frac{\\epsilon_0 C}{2} \\left[ \\mathrm{OTF}(\\mathbf{k}_0)e^{i\\mathbf{k}_0 \\cdot \\mathbf{x}} + \\mathrm{OTF}^*(\\mathbf{k}_0)e^{-i\\mathbf{k}_0 \\cdot \\mathbf{x}} \\right]\n$$\n令 $\\mathrm{OTF}(\\mathbf{k}_0) = \\mathrm{MTF}(\\mathbf{k}_0)e^{i\\phi(\\mathbf{k}_0)}$，上式简化为：\n$$\nI(\\mathbf{x}) = \\epsilon_0 \\left[ 1 + C \\cdot \\mathrm{MTF}(\\mathbf{k}_0) \\cos(\\mathbf{k}_0 \\cdot \\mathbf{x} + \\phi(\\mathbf{k}_0)) \\right]\n$$\n图像对比度是振荡部分的振幅 $C \\cdot \\mathrm{MTF}(\\mathbf{k}_0)$ 相对于直流水平（$1$）的值。所以对比度是 $C \\cdot \\mathrm{MTF}(\\mathbf{k}_0)$。\n现在我们为给定的高斯 PSF 计算 OTF：$\\mathrm{PSF}(\\mathbf{x}) = \\frac{1}{2\\pi \\sigma_x \\sigma_y}\\exp(-\\frac{x^2}{2\\sigma_x^2} - \\frac{y^2}{2\\sigma_y^2})$。这是一个可分离的两个一维高斯函数的乘积。$\\frac{1}{\\sqrt{2\\pi}\\sigma}e^{-z^2/(2\\sigma^2)}$ 的傅里叶变换是 $e^{-k^2\\sigma^2/2}$。因此，\n$$\n\\mathrm{OTF}(\\mathbf{k}) = \\mathcal{F}_x\\left\\{\\frac{1}{\\sqrt{2\\pi}\\sigma_x}e^{-x^2/(2\\sigma_x^2)}\\right\\} \\mathcal{F}_y\\left\\{\\frac{1}{\\sqrt{2\\pi}\\sigma_y}e^{-y^2/(2\\sigma_y^2)}\\right\\} = e^{-k_x^2\\sigma_x^2/2} e^{-k_y^2\\sigma_y^2/2} = \\exp\\left[-\\frac{1}{2}(k_x^2\\sigma_x^2 + k_y^2\\sigma_y^2)\\right]\n$$\n这个 OTF 是实数且为正，所以 $\\mathrm{MTF}(\\mathbf{k}) = |\\mathrm{OTF}(\\mathbf{k})| = \\mathrm{OTF}(\\mathbf{k})$。该陈述断言图像对比度是 MTF 的 $C$ 倍，并且该 MTF 由推导出的表达式给出。这两个部分都是正确的。\n\n**结论：正确。**\n\nD. 点源图像的半峰全宽（FWHM），分别沿 $x$ 轴和 $y$ 轴测量，为 $2\\sqrt{2\\ln 2}\\,\\sigma_x$ 和 $2\\sqrt{2\\ln 2}\\,\\sigma_y$。\n\n从 B 可知，点源的图像是 $I(\\mathbf{x}) = \\mathrm{PSF}(\\mathbf{x})$。最大强度在 $\\mathbf{x}=0$ 处，为 $I_{max} = \\frac{1}{2\\pi\\sigma_x\\sigma_y}$。我们寻求强度为 $I_{max}/2$ 处的宽度。\n沿 $x$ 轴（$y=0$），我们求解 $I(x,0) = I_{max}/2$：\n$$\n\\frac{1}{2\\pi \\sigma_x \\sigma_y} \\exp\\left(-\\frac{x^2}{2\\sigma_x^2}\\right) = \\frac{1}{2} \\left(\\frac{1}{2\\pi \\sigma_x \\sigma_y}\\right)\n$$\n$$\n\\exp\\left(-\\frac{x^2}{2\\sigma_x^2}\\right) = \\frac{1}{2} \\implies -\\frac{x^2}{2\\sigma_x^2} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln 2\n$$\n$$\nx^2 = 2\\sigma_x^2 \\ln 2 \\implies x = \\pm \\sigma_x \\sqrt{2\\ln 2}\n$$\n全宽是这两点之间的距离：$\\mathrm{FWHM}_x = \\sigma_x \\sqrt{2\\ln 2} - (-\\sigma_x \\sqrt{2\\ln 2}) = 2\\sigma_x\\sqrt{2\\ln 2}$。\n根据对称性，$y$ 轴的计算得出 $\\mathrm{FWHM}_y = 2\\sigma_y\\sqrt{2\\ln 2}$。该陈述是准确的。\n\n**结论：正确。**\n\nE. 当 PSF 是各向异性时，通过在固定的 $|\\mathbf{k}|$ 下对调制传递函数按方向进行角度平均而构建的单一各向同性分辨率度量，通常会高估分辨率最差方向上的分辨率。\n\n对于各向异性高斯 PSF，当 $\\sigma_x \\neq \\sigma_y$ 时，MTF 为 $\\mathrm{MTF}(\\mathbf{k}) = \\exp[-\\frac{1}{2}(k_x^2\\sigma_x^2 + k_y^2\\sigma_y^2)]$。当 MTF 在较大的空间频率 $|\\mathbf{k}|$ 处保持较高值时，分辨率更好。“分辨率最差的方向”是 MTF 下降最快的方向。假设 $\\sigma_x > \\sigma_y$。PSF 沿 $x$ 轴最宽，因此该方向的分辨率最差。在k空间中，这对应于 $k_x$ 轴 $(\\theta=0)$，其中 MTF 为 $\\exp[-\\frac{1}{2}|\\mathbf{k}|^2\\sigma_x^2]$。最佳分辨率沿 $y$ 轴，对应于 $k_y$ 轴 $(\\theta=\\pi/2)$，其 MTF 等于 $\\exp[-\\frac{1}{2}|\\mathbf{k}|^2\\sigma_y^2]$。\n角度平均的 MTF，$\\langle\\mathrm{MTF}\\rangle (|\\mathbf{k}|)$，是 $\\mathrm{MTF}(|\\mathbf{k}|, \\theta)$ 在所有角度 $\\theta$ 上的平均值。由于被平均的函数不是常数，其平均值必须严格位于其最小值和最大值之间。对于任何 $|\\mathbf{k}| > 0$：\n$$\n\\mathrm{MTF}_{poor}  < \\langle\\mathrm{MTF}\\rangle  < \\mathrm{MTF}_{best}\n$$\n其中 $\\mathrm{MTF}_{poor}$ 是分辨率最差方向的 MTF。由于较高的 MTF 值对应于更好的分辨率，基于 $\\langle\\mathrm{MTF}\\rangle$ 的分辨率度量将高于最差方向的实际分辨率。因此，它“高估了分辨率最差方向上的分辨率”。\n\n**结论：正确。**\n\nF. PSF 中的各向异性不影响光学传递函数的幅值，只影响其相位，因此调制传递函数保持各向同性。\n\n这个陈述是根本错误的。PSF 中的各向异性（即 $\\mathrm{PSF}(\\mathbf{x})$ 不仅仅是 $|\\mathbf{x}|$ 的函数）直接导致 OTF 和 MTF 的各向异性。如在 C 中推导的，我们的各向异性高斯 PSF 的 MTF 是：\n$$\n\\mathrm{MTF}(\\mathbf{k}) = \\exp\\left[-\\frac{1}{2}(\\sigma_x^2 k_x^2 + \\sigma_y^2 k_y^2)\\right]\n$$\n如果 $\\sigma_x \\neq \\sigma_y$，这个函数就不完全是 $|\\mathbf{k}| = \\sqrt{k_x^2+k_y^2}$ 的函数，因此是各向异性的。它的等值线是椭圆，而不是圆。例如，沿 $k_x$ 轴，$\\mathrm{MTF}(k,0) = e^{-k^2\\sigma_x^2/2}$，而沿 $k_y$ 轴，$\\mathrm{MTF}(0,k) = e^{-k^2\\sigma_y^2/2}$。这两者是不同的，证明了 MTF 是各向异性的。各向异性只影响相位的假设也是错误的；对于像给定这样的对称实函数 PSF，其 OTF 是纯实数（零相位），所有的各向异性都体现在其幅值上。\n\n**结论：错误。**\n\nG. 对于各向异性高斯 PSF，沿主轴的负三分贝空间频率（定义为对于与轴对齐的一维图案，调制传递函数等于 $1/2$ 时的波数）分别为 $k_x^{(-3\\mathrm{dB})} = \\sqrt{2\\ln 2}/\\sigma_x$ 和 $k_y^{(-3\\mathrm{dB})} = \\sqrt{2\\ln 2}/\\sigma_y$，这表明分辨率极限具有方向依赖性。\n\n该陈述为“负三分贝”频率提供了一个明确的定义：波数 $k$ 使得 $\\mathrm{MTF}(k) = 1/2$。虽然 $-3\\,\\mathrm{dB}$ 的标准定义对应于 $1/\\sqrt{2}$ 的振幅比，我们必须遵循问题中给出的定义。\n我们需要找到沿 $x$ 轴（$k_y=0$）使得 MTF 等于 $1/2$ 的频率 $k_x$。\n$$\n\\mathrm{MTF}(k_x, 0) = \\exp\\left(-\\frac{1}{2}\\sigma_x^2 k_x^2\\right) = \\frac{1}{2}\n$$\n对两边取自然对数：\n$$\n-\\frac{1}{2}\\sigma_x^2 k_x^2 = \\ln\\left(\\frac{1}{2}\\right) = -\\ln 2\n$$\n$$\n\\sigma_x^2 k_x^2 = 2\\ln 2 \\implies k_x^2 = \\frac{2\\ln 2}{\\sigma_x^2}\n$$\n取空间频率的正根，我们得到 $k_x^{(-3\\mathrm{dB})} = \\frac{\\sqrt{2\\ln 2}}{\\sigma_x}$。\n对 $y$ 轴的计算是类似的，得到 $k_y^{(-3\\mathrm{dB})} = \\frac{\\sqrt{2\\ln 2}}{\\sigma_y}$。\n推导出的表达式与陈述完全匹配。由于 $\\sigma_x$ 和 $\\sigma_y$ 可以不同，这些频率极限是方向依赖的，正如陈述正确地总结的那样。\n\n**结论：正确。**",
            "answer": "$$\\boxed{ABCDEG}$$"
        },
        {
            "introduction": "最后的这项练习将物理模型、电子学和数值计算结合起来，从零开始构建一个具有时间响应的综合诊断。通过模拟一个金属箔测辐射热计，您将推导并求解描述热惯性和电子滤波的常微分方程，从而学习如何生成仪器对时变等离子体信号的动态响应 。这是一个将理论模型转化为实用计算工具的完整示例。",
            "id": "4051674",
            "problem": "您的任务是构建一个包含热惯性的箔式热辐射计 (FB) 合成诊断工具，用于验证计算辐射输运程序。箔式热辐射计通过将吸收的辐射转化为热量来测量入射辐射功率，这会改变箔片的温度，随后电子读出链将温度变化转化为电信号。您的程序必须使用一种基于物理、从第一性原理和广泛接受的定义出发的方法来模拟箔片温度的演变和测量电压，而不依赖于简便公式。\n\n从基本原理出发：\n- 能量守恒：箔片内能的变化率等于吸收功率减去对环境的热损失。\n- 热容和热阻的定义：箔片的热惯性响应取决于其热容，其冷却取决于与环境之间的热阻。\n- 电子学的一阶低通滤波器 (LPF) 表示：电子读出链可以很好地用一阶线性滤波器来近似。\n\n使用以下物理上一致且符合实际的箔材料常数：\n- 金箔厚度 $d = 10\\times 10^{-6}\\,\\mathrm{m}$，\n- 箔片面积 $A = 1\\times 10^{-4}\\,\\mathrm{m}^2$，\n- 黄金质量密度 $\\rho = 19300\\,\\mathrm{kg/m^3}$，\n- 比热容 $c = 129\\,\\mathrm{J/(kg\\cdot K)}$。\n\n在所有测试中，环境基准温度固定为 $T_0 = 300\\,\\mathrm{K}$。\n\n需要推导和实现的模型要求：\n- 根据材料属性计算箔片的热容 $C$。\n- 利用能量守恒和线性热损失项，推导出箔片温度 $T(t)$ 的控制常微分方程 (ODE)。\n- 推导并实现从温度到测量电压的转换关系，该转换使用时间常数为 $\\tau_e$ 且温度-电压灵敏度为 $k_T$ 的一阶电子滤波器。\n- 吸收功率为 $\\eta P_{\\text{rad}}(t)$，其中 $\\eta$ 是无量纲的吸收因子，$P_{\\text{rad}}(t)$ 是单位为 $\\mathrm{W}$ 的入射辐射功率。\n\n数值计算要求：\n- 使用固定时间步长进行显式时间步进，在指定的时间段内求解关于 $T(t)$ 和测量电压 $v(t)$ 的耦合常微分方程组。\n- 初始条件：$T(0)=T_0$ 和 $v(0)=0$。\n- 对每个测试案例，计算三个指标：\n    1. `v_final`：最终仿真时刻的测量电压，单位为伏特。\n    2. `v_peak`：在整个仿真区间内的最大测量电压，单位为伏特。\n    3. `t_90`：测量电压首次达到 `v_final` 的 $0.9$ 倍时的时间，单位为秒。如果 `v_final` $\\le 0$，则报告 `t_90` $=-1.0$ 秒。\n\n所有电压以伏特表示，所有时间以秒表示。不使用角度。数值输出不附加单位，本说明中已隐含其单位。\n\n测试套件：\n实现以下四个测试案例，每个案例都由辐射功率曲线 $P_{\\text{rad}}(t)$、吸收因子 $\\eta$、热阻 $R_{\\text{th}}$、电子学时间常数 $\\tau_e$、灵敏度 $k_T$、时间步长 $\\Delta t$ 和结束时间 $T_{\\text{end}}$ 完全指定。\n\n- 案例 1 (阶跃输入，标称情况)：\n    - $P_{\\text{rad}}(t) = P_0\\, H(t-t_s)$，其中 $H$ 是 Heaviside 阶跃函数，$P_0 = 2.0\\,\\mathrm{W}$，$t_s = 0.2\\,\\mathrm{s}$。\n    - $\\eta = 0.35$，$R_{\\text{th}} = 120\\,\\mathrm{K/W}$，$\\tau_e = 0.05\\,\\mathrm{s}$，$k_T = 7.0\\times 10^{-3}\\,\\mathrm{V/K}$。\n    - $\\Delta t = 1.0\\times 10^{-3}\\,\\mathrm{s}$，$T_{\\text{end}} = 2.0\\,\\mathrm{s}$。\n\n- 案例 2 (斜坡输入)：\n    - $P_{\\text{rad}}(t)$ 在 $t=0.2\\,\\mathrm{s}$ 时从 $0\\,\\mathrm{W}$ 线性增加到 $t=1.2\\,\\mathrm{s}$ 时的 $1.0\\,\\mathrm{W}$，此后保持在 $1.0\\,\\mathrm{W}$；在 $t=0.2\\,\\mathrm{s}$ 之前为 $0\\,\\mathrm{W}$。\n    - $\\eta = 0.35$，$R_{\\text{th}} = 80\\,\\mathrm{K/W}$，$\\tau_e = 0.02\\,\\mathrm{s}$，$k_T = 5.0\\times 10^{-3}\\,\\mathrm{V/K}$。\n    - $\\Delta t = 1.0\\times 10^{-3}\\,\\mathrm{s}$，$T_{\\text{end}} = 2.0\\,\\mathrm{s}$。\n\n- 案例 3 (高斯脉冲)：\n    - $P_{\\text{rad}}(t) = P_0 \\exp\\!\\left(-\\frac{1}{2}\\left(\\frac{t-t_c}{\\sigma}\\right)^2\\right)$，其中 $P_0 = 5.0\\,\\mathrm{W}$，$t_c = 0.5\\,\\mathrm{s}$，$\\sigma = 0.02\\,\\mathrm{s}$。\n    - $\\eta = 0.30$，$R_{\\text{th}} = 200\\,\\mathrm{K/W}$，$\\tau_e = 0.10\\,\\mathrm{s}$，$k_T = 1.0\\times 10^{-2}\\,\\mathrm{V/K}$。\n    - $\\Delta t = 5.0\\times 10^{-4}\\,\\mathrm{s}$，$T_{\\text{end}} = 1.5\\,\\mathrm{s}$。\n\n- 案例 4 (零输入基线)：\n    - 对所有 $t$，$P_{\\text{rad}}(t) = 0$。\n    - $\\eta = 0.30$，$R_{\\text{th}} = 100\\,\\mathrm{K/W}$，$\\tau_e = 0.05\\,\\mathrm{s}$，$k_T = 5.0\\times 10^{-3}\\,\\mathrm{V/K}$。\n    - $\\Delta t = 1.0\\times 10^{-3}\\,\\mathrm{s}$，$T_{\\text{end}} = 1.0\\,\\mathrm{s}$。\n\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表。其中每个测试案例贡献一个包含三个浮点数 $[v_{\\text{final}}, v_{\\text{peak}}, t_{90}]$ 的子列表。例如，输出格式为 $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$。",
            "solution": "该问题要求从基本物理原理出发，构建一个箔式热辐射计的合成诊断工具。这涉及到推导并数值求解一个耦合常微分方程组 (ODEs)，该方程组模拟了热辐射计箔片的温度演变以及由此产生的测量电压。\n\n推导和数值求解策略如下：\n\n首先，我们确定系统的物理常数。箔片的热容 $C$ 是其热响应的一个关键参数。它由给定的材料属性推导得出：金箔厚度 $d = 10 \\times 10^{-6}\\,\\mathrm{m}$，面积 $A = 1 \\times 10^{-4}\\,\\mathrm{m}^2$，质量密度 $\\rho = 19300\\,\\mathrm{kg/m^3}$，以及比热容 $c = 129\\,\\mathrm{J/(kg\\cdot K)}$。\n箔片的体积为 $V = A d$。\n$V = (1 \\times 10^{-4}\\,\\mathrm{m}^2) \\times (10 \\times 10^{-6}\\,\\mathrm{m}) = 1 \\times 10^{-9}\\,\\mathrm{m}^3$。\n箔片的质量为 $m = \\rho V$。\n$m = (19300\\,\\mathrm{kg/m^3}) \\times (1 \\times 10^{-9}\\,\\mathrm{m}^3) = 1.93 \\times 10^{-5}\\,\\mathrm{kg}$。\n热容 $C$ 是质量和比热容的乘积，$C = m c$。\n$C = (1.93 \\times 10^{-5}\\,\\mathrm{kg}) \\times (129\\,\\mathrm{J/(kg\\cdot K)}) = 2.4897 \\times 10^{-3}\\,\\mathrm{J/K}$。\n\n接下来，我们根据能量守恒原理推导箔片温度 $T(t)$ 的控制常微分方程。箔片内能的变化率 $C \\frac{dT(t)}{dt}$ 等于吸收的净功率。这个净功率是吸收的辐射功率 $P_{\\text{abs}}(t)$ 与损失到周围环境的功率 $P_{\\text{loss}}(t)$ 之差。\n吸收功率由 $P_{\\text{abs}}(t) = \\eta P_{\\text{rad}}(t)$ 给出，其中 $\\eta$ 是吸收因子，$P_{\\text{rad}}(t)$ 是入射辐射功率。\n热损失使用线性热阻 $R_{\\text{th}}$ 进行建模，这类似于欧姆定律，其中热流（功率）是温差除以电阻：$P_{\\text{loss}}(t) = \\frac{T(t) - T_0}{R_{\\text{th}}}$，其中 $T_0 = 300\\,\\mathrm{K}$ 是恒定的环境温度。\n能量平衡方程为：\n$$C \\frac{dT(t)}{dt} = P_{\\text{abs}}(t) - P_{\\text{loss}}(t) = \\eta P_{\\text{rad}}(t) - \\frac{T(t) - T_0}{R_{\\text{th}}}$$\n将其整理成一阶常微分方程的标准形式，得到：\n$$\\frac{dT(t)}{dt} = \\frac{\\eta P_{\\text{rad}}(t)}{C} - \\frac{T(t) - T_0}{R_{\\text{th}} C}$$\n我们可以将箔片的热时间常数定义为 $\\tau_{\\text{th}} = R_{\\text{th}} C$。温度的常微分方程变为：\n$$\\frac{dT(t)}{dt} = \\frac{T_0 - T(t)}{\\tau_{\\text{th}}} + \\frac{\\eta P_{\\text{rad}}(t)}{C}$$\n\n模型的第二部分描述了电子读出链，它将箔片温度转换为测量电压 $v(t)$。这个过程被建模为一个一阶低通滤波器 (LPF)。与箔片相对于基线的温升成正比的“理想”电压信号为 $v_{\\text{ideal}}(t) = k_T (T(t) - T_0)$，其中 $k_T$ 是单位为 $\\mathrm{V/K}$ 的温度-电压灵敏度。\n具有电子学时间常数 $\\tau_e$ 的一阶低通滤波器通过以下常微分方程将输出电压 $v(t)$ 与输入电压 $v_{\\text{ideal}}(t)$ 联系起来：\n$$\\tau_e \\frac{dv(t)}{dt} + v(t) = v_{\\text{ideal}}(t) = k_T (T(t) - T_0)$$\n对测量电压的导数进行整理，得到第二个常微分方程：\n$$\\frac{dv(t)}{dt} = \\frac{k_T (T(t) - T_0) - v(t)}{\\tau_e}$$\n\n现在我们得到了一个关于状态变量 $T(t)$ 和 $v(t)$ 的耦合一阶常微分方程组：\n1. $\\frac{dT}{dt} = \\frac{T_0 - T}{\\tau_{\\text{th}}} + \\frac{\\eta P_{\\text{rad}}(t)}{C}$\n2. $\\frac{dv}{dt} = \\frac{k_T (T - T_0) - v}{\\tau_e}$\n\n问题指定了初始条件 $T(0) = T_0 = 300\\,\\mathrm{K}$ 和 $v(0) = 0\\,\\mathrm{V}$。\n\n为了数值求解该方程组，我们采用具有固定时间步长 $\\Delta t$ 的显式前向欧拉法。设 $t_n = n \\Delta t$ 为第 $n$ 步的时间，对应 $T_n = T(t_n)$ 和 $v_n = v(t_n)$。下一个时间步 $t_{n+1} = (n+1) \\Delta t$ 的值计算如下：\n$$T_{n+1} = T_n + \\Delta t \\left( \\frac{T_0 - T_n}{\\tau_{\\text{th}}} + \\frac{\\eta P_{\\text{rad}}(t_n)}{C} \\right)$$\n$$v_{n+1} = v_n + \\Delta t \\left( \\frac{k_T (T_n - T_0) - v_n}{\\tau_e} \\right)$$\n从 $t=0$ 到 $t=T_{\\text{end}}$ 重复此迭代过程，以生成 $T(t)$ 和 $v(t)$ 的时间序列。\n\n最后，从计算出的电压时间序列 $v(t)$ 中，我们为每个测试案例提取所需的指标：\n1.  $v_{\\text{final}}$：最终时间步的电压，$v(T_{\\text{end}})$。\n2.  $v_{\\text{peak}}$：在整个仿真区间内达到的最大电压值，$\\max_{t \\in [0, T_{\\text{end}}]} v(t)$。\n3.  $t_{90}$：电压首次达到或超过最终电压 $0.9$ 倍的时间 $t$，即 $v(t) \\ge 0.9 v_{\\text{final}}$。如果 $v_{\\text{final}} \\le 0$，则 $t_{90}$ 定义为 $-1.0\\,\\mathrm{s}$。数值实现将搜索满足此条件的第一个时间步。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the foil bolometer synthetic diagnostic problem for all test cases.\n    \"\"\"\n\n    # Physical constants for the gold foil\n    d = 10e-6  # Foil thickness in m\n    A = 1e-4   # Foil area in m^2\n    rho = 19300  # Gold mass density in kg/m^3\n    c = 129    # Specific heat capacity in J/(kg*K)\n\n    # Derived constant: foil heat capacity\n    C_foil = rho * A * d * c  # in J/K\n\n    # Environment baseline temperature\n    T0 = 300.0  # in K\n\n    test_cases = [\n        # Case 1 (step input, nominal)\n        {\n            \"id\": 1,\n            \"power_profile\": lambda t: 2.0 if t >= 0.2 else 0.0,\n            \"eta\": 0.35, \"R_th\": 120.0, \"tau_e\": 0.05, \"k_T\": 7.0e-3,\n            \"dt\": 1.0e-3, \"T_end\": 2.0,\n        },\n        # Case 2 (ramp input)\n        {\n            \"id\": 2,\n            \"power_profile\": lambda t: 0.0 if t  0.2 else (1.0 * (t - 0.2) if t  1.2 else 1.0),\n            \"eta\": 0.35, \"R_th\": 80.0, \"tau_e\": 0.02, \"k_T\": 5.0e-3,\n            \"dt\": 1.0e-3, \"T_end\": 2.0,\n        },\n        # Case 3 (Gaussian pulse)\n        {\n            \"id\": 3,\n            \"power_profile\": lambda t: 5.0 * np.exp(-0.5 * ((t - 0.5) / 0.02)**2),\n            \"eta\": 0.30, \"R_th\": 200.0, \"tau_e\": 0.10, \"k_T\": 1.0e-2,\n            \"dt\": 5.0e-4, \"T_end\": 1.5,\n        },\n        # Case 4 (zero input baseline)\n        {\n            \"id\": 4,\n            \"power_profile\": lambda t: 0.0,\n            \"eta\": 0.30, \"R_th\": 100.0, \"tau_e\": 0.05, \"k_T\": 5.0e-3,\n            \"dt\": 1.0e-3, \"T_end\": 1.0,\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters\n        P_rad_func = case[\"power_profile\"]\n        eta = case[\"eta\"]\n        R_th = case[\"R_th\"]\n        tau_e = case[\"tau_e\"]\n        k_T = case[\"k_T\"]\n        dt = case[\"dt\"]\n        T_end = case[\"T_end\"]\n\n        # Calculate thermal time constant\n        tau_th = R_th * C_foil\n\n        # Set up simulation time grid and state vectors\n        num_steps = int(T_end / dt)\n        times = np.linspace(0, T_end, num_steps + 1)\n        T = np.zeros(num_steps + 1)\n        v = np.zeros(num_steps + 1)\n\n        # Initial conditions\n        T[0] = T0\n        v[0] = 0.0\n\n        # Perform explicit time-stepping (Forward Euler)\n        for i in range(num_steps):\n            t_i = times[i]\n            T_i = T[i]\n            v_i = v[i]\n            \n            P_rad_i = P_rad_func(t_i)\n            \n            # ODE for temperature\n            dT_dt = (T0 - T_i) / tau_th + (eta * P_rad_i) / C_foil\n            \n            # ODE for measured voltage\n            dv_dt = (k_T * (T_i - T0) - v_i) / tau_e\n            \n            # Update states\n            T[i+1] = T_i + dt * dT_dt\n            v[i+1] = v_i + dt * dv_dt\n\n        # Calculate metrics\n        v_final = v[-1]\n        v_peak = np.max(v)\n        \n        t_90 = -1.0\n        if v_final > 0:\n            v_90_target = 0.9 * v_final\n            # Find first index where voltage >= target\n            indices = np.where(v >= v_90_target)[0]\n            if indices.size > 0:\n                first_index = indices[0]\n                t_90 = times[first_index]\n\n        results.append([v_final, v_peak, t_90])\n    \n    # Final print statement in the exact required format\n    # Using map and join to correctly format the list of lists as a string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}