{
    "hands_on_practices": [
        {
            "introduction": "为了掌握辐射输运，我们首先从其最核心的方程——辐射输运方程（RTE）——的一个基本场景出发。这个练习要求我们推导并求解一个均匀、一维等离子体板中的辐射强度。这个问题的解析解，被称为“形式解”，是理解吸收、发射和光学深度等基本物理过程的基石 ()，也为验证更复杂的数值模拟程序提供了黄金标准。通过这个练习，你将亲手推导这个关键结果，并用具体数值感受辐射在介质中传播和演化的过程。",
            "id": "4037038",
            "problem": "考虑一个物理厚度为 $L$ 的平面平行均匀等离子体板，在固定频率 $\\nu$ 下进行观测。设空间坐标 $s$ 测量沿法向穿过该板的射线的距离，入口表面处 $s=0$，出口表面处 $s=L$。假设吸收系数 $\\alpha_{\\nu}$ 在空间上是均匀的，并且发射是各向同性的，具有一个恒定的源函数 $S_{\\nu}$（与 $s$ 无关）。入口表面的边界条件是入射比强度为 $I_{\\nu}(0)$。从与频率相关的辐射转移方程（RTE）出发，\n$$\\frac{d I_{\\nu}}{d s}=-\\alpha_{\\nu} I_{\\nu}+j_{\\nu},$$\n以及源函数 $S_{\\nu}\\equiv j_{\\nu}/\\alpha_{\\nu}$ 的定义，推导出出口表面的出射比强度 $I_{\\nu}(L)$。然后，使用以下参数对您推导出的表达式进行数值计算：$L=0.20\\,\\text{m}$，$\\alpha_{\\nu}=0.75\\,\\text{m}^{-1}$，$S_{\\nu}=2.00\\times 10^{-7}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}$，以及 $I_{\\nu}(0)=1.00\\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}$。将最终的出射比强度以 $\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}$ 为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "所述问题具有科学依据，提法恰当，客观且自洽。这是一个基于基本辐射转移方程的标准初值问题。所提供的物理参数和边界条件是一致且合理的。因此，该问题是有效的，并将推导求解。\n\n出发点是沿射线路径（坐标为 $s$）的比强度 $I_{\\nu}$ 的频率相关辐射转移方程（RTE）：\n$$\n\\frac{d I_{\\nu}}{d s}=-\\alpha_{\\nu} I_{\\nu}+j_{\\nu}\n$$\n其中，$\\alpha_{\\nu}$ 是吸收系数，$j_{\\nu}$ 是发射系数。\n源函数 $S_{\\nu}$ 定义为发射系数与吸收系数之比：\n$$\nS_{\\nu} \\equiv \\frac{j_{\\nu}}{\\alpha_{\\nu}}\n$$\n将 $j_{\\nu} = S_{\\nu} \\alpha_{\\nu}$ 代入RTE，得到：\n$$\n\\frac{d I_{\\nu}}{d s}=-\\alpha_{\\nu} I_{\\nu}+S_{\\nu} \\alpha_{\\nu}\n$$\n该方程可以重新整理为：\n$$\n\\frac{d I_{\\nu}}{d s} + \\alpha_{\\nu} I_{\\nu} = \\alpha_{\\nu} S_{\\nu}\n$$\n问题指出等离子体板是均匀的，这意味着吸收系数 $\\alpha_{\\nu}$ 相对于空间坐标 $s$ 是一个常数。题目还给出了源函数 $S_{\\nu}$ 是一个常数。因此，整理后方程的整个右侧 $\\alpha_{\\nu} S_{\\nu}$ 是一个常数。\n\n这是一个形式为 $\\frac{dy}{dx} + P(x)y = Q(x)$ 的一阶线性常微分方程，其中 $y(x) = I_{\\nu}(s)$，$P(s) = \\alpha_{\\nu}$，以及 $Q(s) = \\alpha_{\\nu} S_{\\nu}$。可以使用一个积分因子 $\\mu(s)$ 来求解，其定义为：\n$$\n\\mu(s) = \\exp\\left(\\int P(s) \\, ds\\right) = \\exp\\left(\\int \\alpha_{\\nu} \\, ds\\right)\n$$\n由于 $\\alpha_{\\nu}$ 是常数，积分很简单：\n$$\n\\mu(s) = \\exp(\\alpha_{\\nu} s)\n$$\n将RTE乘以积分因子 $\\mu(s)$ 得到：\n$$\n\\exp(\\alpha_{\\nu} s) \\frac{d I_{\\nu}}{d s} + \\alpha_{\\nu} \\exp(\\alpha_{\\nu} s) I_{\\nu} = \\alpha_{\\nu} S_{\\nu} \\exp(\\alpha_{\\nu} s)\n$$\n根据微分的乘法法则，该方程的左侧是 $I_{\\nu}(s) \\exp(\\alpha_{\\nu} s)$ 的导数：\n$$\n\\frac{d}{ds} \\left( I_{\\nu}(s) \\exp(\\alpha_{\\nu} s) \\right) = \\alpha_{\\nu} S_{\\nu} \\exp(\\alpha_{\\nu} s)\n$$\n我们可以将此方程沿路径长度 $s$ 从板的入口 $s=0$ 积分到出口 $s=L$：\n$$\n\\int_{0}^{L} \\frac{d}{ds'} \\left( I_{\\nu}(s') \\exp(\\alpha_{\\nu} s') \\right) ds' = \\int_{0}^{L} \\alpha_{\\nu} S_{\\nu} \\exp(\\alpha_{\\nu} s') ds'\n$$\n根据微积分基本定理，左侧为：\n$$\n\\left[ I_{\\nu}(s') \\exp(\\alpha_{\\nu} s') \\right]_{0}^{L} = I_{\\nu}(L) \\exp(\\alpha_{\\nu} L) - I_{\\nu}(0) \\exp(0) = I_{\\nu}(L) \\exp(\\alpha_{\\nu} L) - I_{\\nu}(0)\n$$\n右侧的积分为：\n$$\n\\int_{0}^{L} \\alpha_{\\nu} S_{\\nu} \\exp(\\alpha_{\\nu} s') ds' = \\alpha_{\\nu} S_{\\nu} \\left[ \\frac{1}{\\alpha_{\\nu}} \\exp(\\alpha_{\\nu} s') \\right]_{0}^{L} = S_{\\nu} \\left( \\exp(\\alpha_{\\nu} L) - \\exp(0) \\right) = S_{\\nu} \\left( \\exp(\\alpha_{\\nu} L) - 1 \\right)\n$$\n令两边结果相等：\n$$\nI_{\\nu}(L) \\exp(\\alpha_{\\nu} L) - I_{\\nu}(0) = S_{\\nu} \\left( \\exp(\\alpha_{\\nu} L) - 1 \\right)\n$$\n现在，我们求解出射强度 $I_{\\nu}(L)$：\n$$\nI_{\\nu}(L) \\exp(\\alpha_{\\nu} L) = I_{\\nu}(0) + S_{\\nu} \\exp(\\alpha_{\\nu} L) - S_{\\nu}\n$$\n$$\nI_{\\nu}(L) = I_{\\nu}(0) \\exp(-\\alpha_{\\nu} L) + S_{\\nu} - S_{\\nu} \\exp(-\\alpha_{\\nu} L)\n$$\n将 $S_{\\nu}$ 因子提出，得到出射强度的最终符号表达式：\n$$\nI_{\\nu}(L) = I_{\\nu}(0) \\exp(-\\alpha_{\\nu} L) + S_{\\nu} (1 - \\exp(-\\alpha_{\\nu} L))\n$$\n该表达式是均匀介质中RTE的正式解。它表明出射强度是两项之和：初始强度 $I_{\\nu}(0)$ 在穿过板时被因子 $\\exp(-\\alpha_{\\nu} L)$ 衰减后的部分，以及板本身的积分发射，由源函数 $S_{\\nu}$ 乘以 $(1 - \\exp(-\\alpha_{\\nu} L))$ 表示。无量纲量 $\\tau_{\\nu,L} = \\alpha_{\\nu} L$ 被称为板的光学厚度。\n\n接下来，我们使用给定的参数对该表达式进行数值计算：\n$L = 0.20\\,\\text{m}$\n$\\alpha_{\\nu} = 0.75\\,\\text{m}^{-1}$\n$S_{\\nu} = 2.00 \\times 10^{-7}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}$\n$I_{\\nu}(0) = 1.00 \\times 10^{-8}\\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}$\n\n首先，我们计算光学厚度 $\\tau_{\\nu,L}$：\n$$\n\\tau_{\\nu,L} = \\alpha_{\\nu} L = (0.75\\,\\text{m}^{-1}) \\times (0.20\\,\\text{m}) = 0.15\n$$\n衰减因子为 $\\exp(-\\tau_{\\nu,L}) = \\exp(-0.15)$。\n$$\n\\exp(-0.15) \\approx 0.8607079764\n$$\n现在，将数值代入推导出的公式中：\n$$\nI_{\\nu}(L) = (1.00 \\times 10^{-8}) \\exp(-0.15) + (2.00 \\times 10^{-7}) (1 - \\exp(-0.15))\n$$\n$$\nI_{\\nu}(L) \\approx (1.00 \\times 10^{-8})(0.8607079764) + (2.00 \\times 10^{-7})(1 - 0.8607079764)\n$$\n$$\nI_{\\nu}(L) \\approx 0.8607079764 \\times 10^{-8} + (2.00 \\times 10^{-7})(0.1392920236)\n$$\n$$\nI_{\\nu}(L) \\approx 0.8607079764 \\times 10^{-8} + 2.785840472 \\times 10^{-8}\n$$\n$$\nI_{\\nu}(L) \\approx (0.8607079764 + 2.785840472) \\times 10^{-8}\n$$\n$$\nI_{\\nu}(L) \\approx 3.646548448 \\times 10^{-8} \\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nI_{\\nu}(L) \\approx 3.647 \\times 10^{-8} \\,\\text{W}\\,\\text{m}^{-2}\\,\\text{Hz}^{-1}\\,\\text{sr}^{-1}\n$$",
            "answer": "$$\n\\boxed{3.647 \\times 10^{-8}}\n$$"
        },
        {
            "introduction": "在所有方向上求解完整的辐射输运方程在计算上是极其昂贵的。因此，发展近似方法至关重要，而矩方法就是其中一类强大的技术。该方法通过辐射场的角向平均量（如能量密度和辐射通量）来简化描述。这个练习聚焦于矩方法的核心——“封闭问题”，并通过爱丁顿因子这一关键概念来探索它 ()。通过计算各向同性、完美平行束等极限情况下的爱丁顿因子，你将深入理解辐射场的各向异性是如何影响输运模型，并领会为何需要高级的封闭关系来准确模拟从扩散到自由流的各种辐射状态。",
            "id": "4037050",
            "problem": "等离子体中的辐射场由比强度 $I(\\boldsymbol{x}, \\boldsymbol{\\Omega}, \\nu, t)$ 描述，其中 $\\boldsymbol{\\Omega}$ 是单位球面上的传播方向，$\\nu$ 是频率。考虑一个关于 $z$ 轴轴对称的、平面平行的、频率积分的设定，因此 $I$ 仅依赖于 $\\mu = \\cos\\theta$，其中 $\\theta$ 是相对于 $z$ 轴的极角。将 $I(\\mu)$ 的角矩定义为平均强度 $J$ 和二阶矩 $K$，由下式给出：\n$$\nJ = \\frac{1}{4\\pi} \\int_{4\\pi} I(\\mu)\\, \\mathrm{d}\\Omega, \\qquad\nK = \\frac{1}{4\\pi} \\int_{4\\pi} \\mu^2 I(\\mu)\\, \\mathrm{d}\\Omega,\n$$\n并将爱丁顿因子 $f$ 定义为 $f = K/J$。在一维空间中，辐射压强 $P$ 和能量密度 $E$ 通过矩封闭关系 $P = f E$ 相关联。\n\n从这些定义和角平均的第一性原理出发，对以下每种强度分布计算 $f$：\n- 各向同性辐射：$I(\\mu) = I_0$，其中 $I_0$ 为正常数。\n- 沿 $+\\hat{z}$ 方向的完美束流辐射：$I(\\mu) = I_0\\, \\delta(\\mu - 1)$，其中 $\\delta(\\cdot)$ 是狄拉克δ分布。\n- 通过四极畸变建模的光学薄前向峰值辐射：$I(\\mu) = I_0 \\left[ 1 + \\beta\\, P_2(\\mu) \\right]$，其中 $P_2(\\mu) = \\frac{1}{2}\\left(3\\mu^2 - 1\\right)$ 是2阶勒让德多项式，$\\beta$ 是一个满足 $|\\beta| \\ll 1$ 的无量纲参数。\n\n然后，基于计算出的 $f$ 的值和极限，从矩方程定性地推断，在封闭关系 $P = f E$ 中对 $f$ 的选择为何会影响双矩辐射输运模型能否在扩散和自由流极限下再现正确的行为。特别地，评论使用恒定的 $f$ 与使用一个能适应辐射场局部角各向异性的可变 $f$ 所带来的后果。你可以引用约化通量 $\\chi = |\\boldsymbol{F}|/(c E)$（其中 $\\boldsymbol{F}$ 是辐射通量矢量，$c$ 是光速）作为各向异性的度量，但除了要求 $f$ 与你计算出的极限值一致外，不要假设任何特定的封闭公式。\n\n下列哪个陈述是正确的？\n\nA. 对于各向同性辐射，$f = \\frac{1}{3}$；对于沿 $+\\hat{z}$ 方向的完美束流辐射，$f = 1$；对于 $I(\\mu) = I_0 \\left[ 1 + \\beta\\, P_2(\\mu) \\right]$，$f = \\frac{1}{3} + \\frac{2}{15}\\beta$。使用恒定 $f = \\frac{1}{3}$ 的封闭关系会产生各向同性的辐射压强和一种扩散性的、抛物线的行为，这种行为无法捕捉光学薄的束流状态下的自由流，而一个随着各向异性增加（例如，当 $\\chi \\to 1$ 时）而趋近于 $1$ 的可变 $f$ 则能保持双曲性和与自由流一致的有限信号速度。\n\nB. 对于各向同性辐射，$f = \\frac{1}{2}$；对于沿 $+\\hat{z}$ 方向的完美束流辐射，$f = 1$；对于 $I(\\mu) = I_0 \\left[ 1 + \\beta\\, P_2(\\mu) \\right]$，$f = \\frac{1}{2} + \\frac{1}{10}\\beta$。使用恒定 $f$ 的封闭关系能准确地再现扩散和自由流极限，因此可变的 $f$ 是不必要的。\n\nC. 对于各向同性辐射，$f = \\frac{1}{3}$；对于沿 $+\\hat{z}$ 方向的完美束流辐射，$f = 0$；对于 $I(\\mu) = I_0 \\left[ 1 + \\beta\\, P_2(\\mu) \\right]$，$f = \\frac{1}{3} - \\frac{2}{15}\\beta$。使用恒定 $f = \\frac{1}{3}$ 的封闭关系会产生一个适用于自由流射线的双曲系统，而允许 $f$ 变化会破坏双曲性。\n\nD. 对于各向同性辐射，$f = 0$；对于沿 $+\\hat{z}$ 方向的完美束流辐射，$f = 1$；对于 $I(\\mu) = I_0 \\left[ 1 + \\beta\\, P_2(\\mu) \\right]$，$f = \\frac{2}{3}\\beta$。可变的 $f$ 通常会导致非因果的辐射通量，所以应始终使用恒定的 $f$。",
            "solution": "这个问题是有效的，因为它具有科学依据、问题明确且客观。它展示了辐射输运理论中对爱丁顿因子的标准分析，使用了明确定义的物理模型和数学定义。我们开始解答。\n\n比强度 $I(\\mu)$ 的角矩定义为平均强度 $J$ 和二阶矩 $K$。在具有轴对称性的平面平行设定中，立体角积分 $\\mathrm{d}\\Omega$ 变为 $2\\pi \\sin\\theta \\, \\mathrm{d}\\theta$。通过代换 $\\mu = \\cos\\theta$，我们得到 $\\mathrm{d}\\mu = -\\sin\\theta \\, \\mathrm{d}\\theta$。对单位球面的积分变为 $\\int_{4\\pi} (\\cdot) \\, \\mathrm{d}\\Omega = \\int_0^{2\\pi} \\mathrm{d}\\phi \\int_0^\\pi (\\cdot) \\sin\\theta \\, \\mathrm{d}\\theta = 2\\pi \\int_{-1}^1 (\\cdot) \\, \\mathrm{d}\\mu$。\n\n因此，$J$ 和 $K$ 的定义变为：\n$$\nJ = \\frac{1}{4\\pi} \\int_{4\\pi} I(\\mu)\\, \\mathrm{d}\\Omega = \\frac{2\\pi}{4\\pi} \\int_{-1}^1 I(\\mu)\\, \\mathrm{d}\\mu = \\frac{1}{2} \\int_{-1}^1 I(\\mu)\\, \\mathrm{d}\\mu\n$$\n$$\nK = \\frac{1}{4\\pi} \\int_{4\\pi} \\mu^2 I(\\mu)\\, \\mathrm{d}\\Omega = \\frac{2\\pi}{4\\pi} \\int_{-1}^1 \\mu^2 I(\\mu)\\, \\mathrm{d}\\mu = \\frac{1}{2} \\int_{-1}^1 \\mu^2 I(\\mu)\\, \\mathrm{d}\\mu\n$$\n爱丁顿因子定义为 $f = K/J$。我们现在对三种指定情况计算这个值。\n\n**情况1：各向同性辐射**\n比强度由 $I(\\mu) = I_0$ 给出，其中 $I_0$ 是一个正常数。\n平均强度 $J$ 是：\n$$\nJ = \\frac{1}{2} \\int_{-1}^1 I_0 \\, \\mathrm{d}\\mu = \\frac{I_0}{2} [\\mu]_{-1}^1 = \\frac{I_0}{2} (1 - (-1)) = I_0\n$$\n二阶矩 $K$ 是：\n$$\nK = \\frac{1}{2} \\int_{-1}^1 \\mu^2 I_0 \\, \\mathrm{d}\\mu = \\frac{I_0}{2} \\left[\\frac{\\mu^3}{3}\\right]_{-1}^1 = \\frac{I_0}{2} \\left(\\frac{1^3}{3} - \\frac{(-1)^3}{3}\\right) = \\frac{I_0}{2} \\left(\\frac{1}{3} + \\frac{1}{3}\\right) = \\frac{I_0}{3}\n$$\n爱丁顿因子 $f$ 是：\n$$\nf = \\frac{K}{J} = \\frac{I_0/3}{I_0} = \\frac{1}{3}\n$$\n这是扩散极限下的特征值。\n\n**情况2：沿 $+\\hat{z}$ 方向的完美束流辐射**\n比强度由 $I(\\mu) = I_0\\, \\delta(\\mu - 1)$ 给出，使用了狄拉克δ分布。\n平均强度 $J$ 是：\n$$\nJ = \\frac{1}{2} \\int_{-1}^1 I_0\\, \\delta(\\mu - 1) \\, \\mathrm{d}\\mu = \\frac{I_0}{2} \\cdot 1 = \\frac{I_0}{2}\n$$\n二阶矩 $K$ 是：\n$$\nK = \\frac{1}{2} \\int_{-1}^1 \\mu^2 I_0\\, \\delta(\\mu - 1) \\, \\mathrm{d}\\mu = \\frac{I_0}{2} \\int_{-1}^1 \\mu^2 \\delta(\\mu - 1) \\, \\mathrm{d}\\mu = \\frac{I_0}{2} \\cdot (1^2) = \\frac{I_0}{2}\n$$\n爱丁顿因子 $f$ 是：\n$$\nf = \\frac{K}{J} = \\frac{I_0/2}{I_0/2} = 1\n$$\n这是自由流极限下的特征值。\n\n**情况3：光学薄前向峰值辐射（四极畸变）**\n比强度为 $I(\\mu) = I_0 \\left[ 1 + \\beta\\, P_2(\\mu) \\right]$，其中 $P_2(\\mu) = \\frac{1}{2}\\left(3\\mu^2 - 1\\right)$。我们利用勒让德多项式的正交性：$\\int_{-1}^1 P_n(\\mu) P_m(\\mu) \\, \\mathrm{d}\\mu = \\frac{2}{2n+1}\\delta_{nm}$，其中 $\\delta_{nm}$ 是克罗内克δ。注意 $1 = P_0(\\mu)$。\n平均强度 $J$ 是：\n$$\nJ = \\frac{1}{2} \\int_{-1}^1 I_0 \\left[ 1 + \\beta P_2(\\mu) \\right] \\, \\mathrm{d}\\mu = \\frac{I_0}{2} \\left( \\int_{-1}^1 P_0(\\mu) \\, \\mathrm{d}\\mu + \\beta \\int_{-1}^1 P_2(\\mu) P_0(\\mu) \\, \\mathrm{d}\\mu \\right)\n$$\n由于正交性（$n=2, m=0$），第二个积分为零。第一个积分为 $\\int_{-1}^1 P_0(\\mu) \\mathrm{d}\\mu = \\int_{-1}^1 1 \\mathrm{d}\\mu = 2$。\n$$\nJ = \\frac{I_0}{2} (2 + 0) = I_0\n$$\n为了计算 $K$，我们首先用勒让德多项式表示 $\\mu^2$：$\\mu^2 = \\frac{2}{3}P_2(\\mu) + \\frac{1}{3}P_0(\\mu)$。\n$$\nK = \\frac{1}{2} \\int_{-1}^1 \\mu^2 I_0 \\left[ 1 + \\beta P_2(\\mu) \\right] \\, \\mathrm{d}\\mu = \\frac{I_0}{2} \\int_{-1}^1 \\mu^2 \\left[ P_0(\\mu) + \\beta P_2(\\mu) \\right] \\, \\mathrm{d}\\mu\n$$\n$$\nK = \\frac{I_0}{2} \\int_{-1}^1 \\left(\\frac{2}{3}P_2(\\mu) + \\frac{1}{3}P_0(\\mu)\\right) \\left[ P_0(\\mu) + \\beta P_2(\\mu) \\right] \\, \\mathrm{d}\\mu\n$$\n展开并应用正交性：\n$$\nK = \\frac{I_0}{2} \\left[ \\frac{2}{3}\\beta \\int_{-1}^1 P_2^2(\\mu) \\, \\mathrm{d}\\mu + \\frac{1}{3} \\int_{-1}^1 P_0^2(\\mu) \\, \\mathrm{d}\\mu \\right]\n$$\n交叉项 $\\int P_2 P_0 \\, \\mathrm{d}\\mu$ 为零。使用正交关系：$\\int_{-1}^1 P_0^2(\\mu) \\, \\mathrm{d}\\mu = \\frac{2}{2(0)+1} = 2$，以及 $\\int_{-1}^1 P_2^2(\\mu) \\, \\mathrm{d}\\mu = \\frac{2}{2(2)+1} = \\frac{2}{5}$。\n$$\nK = \\frac{I_0}{2} \\left[ \\frac{2}{3}\\beta \\left(\\frac{2}{5}\\right) + \\frac{1}{3}(2) \\right] = \\frac{I_0}{2} \\left[ \\frac{4}{15}\\beta + \\frac{2}{3} \\right] = I_0 \\left[ \\frac{2}{15}\\beta + \\frac{1}{3} \\right]\n$$\n爱丁顿因子 $f$ 是：\n$$\nf = \\frac{K}{J} = \\frac{I_0 \\left( \\frac{1}{3} + \\frac{2}{15}\\beta \\right)}{I_0} = \\frac{1}{3} + \\frac{2}{15}\\beta\n$$\n\n**关于矩封闭的定性推理**\n辐射输运的双矩方程构成一个双曲型偏微分方程组。封闭关系 $P=fE$ 决定了系统的特征速度，这些速度对应于辐射的信号传播速度。\n- **扩散极限：** 在光学厚的介质中，频繁的碰撞导致辐射场变得近乎各向同性。此时，$I(\\mu)$ 几乎是恒定的，正确的爱丁顿因子为 $f \\approx 1/3$。使用恒定的封闭关系 $f=1/3$（爱丁顿近似或P1封闭）会得到一个系统，其在光学厚极限下的行为能正确地简化为扩散方程（一个抛物线型偏微分方程）。\n- **自由流极限：** 在光学薄的介质中，辐射沿直线（束流）传播很长距离。在完美束流的极端情况下，$I(\\mu)$ 是尖锐峰值的，正确的爱丁顿因子为 $f=1$。这对应于辐射以光速 $c$ 传播。\n- **恒定 $f$ 与可变 $f$ 的对比**：\n    - 一个使用**恒定** $f=1/3$ 的模型能正确捕捉光学厚区域中输运的扩散性质，但在光学薄区域会失效。它预测的最大信号速度为 $c/\\sqrt{3}$，这对于必须以 $c$ 传播的自由流辐射来说是不符合物理的。这会导致显著的误差，例如辐射前沿以错误的速度传播。\n    - 一个依赖于辐射场局部各向异性（通常由约化通量 $\\chi = |\\boldsymbol{F}|/(cE)$ 参数化）的**可变**爱丁顿因子 $f$ 可以在这两个极限之间架起桥梁。这样的封闭关系将确保当 $\\chi \\to 0$ 时（各向同性/扩散极限），$f \\to 1/3$，而当 $\\chi \\to 1$ 时（束流/自由流极限），$f \\to 1$。通过这样做，双曲型矩方程保持了其特性，但其特征速度会正确地适应。这使得模型能够准确地再现扩散和自由流两种情况，保持因果性（信号速度 $\\le c$）和有限传播速度，这是双曲系统的关键特性。\n\n**选项评估**\n\n*   **A. 对于各向同性辐射，$f = \\frac{1}{3}$；对于沿 $+\\hat{z}$ 方向的完美束流辐射，$f = 1$；对于 $I(\\mu) = I_0 \\left[ 1 + \\beta\\, P_2(\\mu) \\right]$，$f = \\frac{1}{3} + \\frac{2}{15}\\beta$。使用恒定 $f = \\frac{1}{3}$ 的封闭关系会产生各向同性的辐射压强和一种扩散性的、抛物线的行为，这种行为无法捕捉光学薄的束流状态下的自由流，而一个随着各向异性增加（例如，当 $\\chi \\to 1$ 时）而趋近于 $1$ 的可变 $f$ 则能保持双曲性和与自由流一致的有限信号速度。**\n    - 计算出的 $f$ 值都是正确的：$1/3$，$1$，和 $\\frac{1}{3} + \\frac{2}{15}\\beta$。\n    - 定性推理也是正确的。恒定 $f=1/3$ 的封闭关系适用于扩散，但对自由流则失效。需要一个可变的爱丁顿因子来创建一个在两个极限下都有效的模型，正确地捕捉自由流辐射的双曲性质和信号速度。\n    - **结论：正确。**\n\n*   **B. 对于各向同性辐射，$f = \\frac{1}{2}$；对于沿 $+\\hat{z}$ 方向的完美束流辐射，$f = 1$；对于 $I(\\mu) = I_0 \\left[ 1 + \\beta\\, P_2(\\mu) \\right]$，$f = \\frac{1}{2} + \\frac{1}{10}\\beta$。使用恒定 $f$ 的封闭关系能准确地再现扩散和自由流极限，因此可变的 $f$ 是不必要的。**\n    - 对于各向同性辐射，$f=1/2$ 的值是错误的。正确的值是 $f=1/3$。\n    - 恒定 $f$ 能再现两个极限的说法是根本错误的。\n    - **结论：错误。**\n\n*   **C. 对于各向同性辐射，$f = \\frac{1}{3}$；对于沿 $+\\hat{z}$ 方向的完美束流辐射，$f = 0$；对于 $I(\\mu) = I_0 \\left[ 1 + \\beta\\, P_2(\\mu) \\right]$，$f = \\frac{1}{3} - \\frac{2}{15}\\beta$。使用恒定 $f = \\frac{1}{3}$ 的封闭关系会产生一个适用于自由流射线的双曲系统，而允许 $f$ 变化会破坏双曲性。**\n    - 对于完美束流辐射，$f=0$ 的值是错误的。正确的值是 $f=1$。\n    - 恒定 $f=1/3$ 适用于自由流的说法是错误的。\n    - 可变 $f$ 会破坏双曲性的说法通常也是错误的；设计良好的可变封闭关系正是为了维持一个鲁棒的双曲系统。\n    - **结论：错误。**\n\n*   **D. 对于各向同性辐射，$f = 0$；对于沿 $+\\hat{z}$ 方向的完美束流辐射，$f = 1$；对于 $I(\\mu) = I_0 \\left[ 1 + \\beta\\, P_2(\\mu) \\right]$，$f = \\frac{2}{3}\\beta$。可变的 $f$ 通常会导致非因果的辐射通量，所以应始终使用恒定的 $f$。**\n    - 对于各向同性辐射，$f=0$ 的值是错误的。正确的值是 $f=1/3$。\n    - 可变 $f$ 通常导致非因果性的说法与事实相反。构造合理的变量封闭关系可以确保因果性。\n    - **结论：错误。**\n\n根据推导和分析，只有陈述A是正确的。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在掌握了辐射输运的解析解和核心概念后，我们转向实际的数值实现。离散纵标 ($S_N$) 方法是求解多维复杂几何中辐射输运方程的“主力军”。这个练习将带你构建一个二维 $S_N$ 求解器的核心部分 ()。你将关注两个关键的算法组件：确保解的物理稳定性的“迎风差分格式”，以及使逐方向计算成为可能的“扫描排序”。完成这个练习将让你对输运程序“引擎盖下”的工作原理有一个具体而深刻的理解。",
            "id": "4036979",
            "problem": "考虑在具有入流边界条件的二维、凸形、矩形等离子体区域中的稳态、单能辐射输运。设角通量表示为 $\\psi(x,y,\\Omega)$，其中 $(x,y)$ 是笛卡尔坐标，$\\Omega$ 是单位圆上的方向，其方向余弦分别为 $\\mu$（对应 $x$）和 $\\eta$（对应 $y$）。对于吸收性、各向同性发射介质，其控制方程为稳态线性辐射输运方程\n$$\n\\mu \\frac{\\partial \\psi}{\\partial x} + \\eta \\frac{\\partial \\psi}{\\partial y} + \\sigma_t \\psi = q,\n$$\n其中 $\\sigma_t$ 是宏观总截面，$q$ 是一个各向同性体积源项。在入流边界（边界上满足 $\\Omega \\cdot \\mathbf{n}  0$ 的部分，其中 $\\mathbf{n}$ 是单位外法线），指定 $\\psi = g(\\Omega)$；在出流边界，$\\psi$ 由内部解确定。\n\n使用离散纵标 (S$_N$) 方法，取一组有限的方向 $\\{\\Omega_m\\}_{m=1}^M$ 和相应的权重 $\\{w_m\\}_{m=1}^M$。假设权重是归一化的，使得 $\\sum_{m=1}^M w_m = 1$，因此离散标量通量是角平均值\n$$\n\\phi(x,y) = \\sum_{m=1}^M w_m \\psi(x,y,\\Omega_m).\n$$\n\n在一个具有 $N_x \\times N_y$ 个单元、间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀笛卡尔网格上，构建：\n- 针对每个离散方向 $\\Omega_m = (\\mu_m,\\eta_m)$ 的扫描顺序，该顺序从入流边界开始访问区域内的单元。\n- 一个与上述方程和入流边界条件一致的一阶迎风差分格式，确保当 $q \\ge 0$ 和 $g(\\Omega_m) \\ge 0$ 时数值解的单调性。\n\n从基本原理和定义（上述输运方程、入流边界条件以及方向导数的迎风差分）出发，推导在单元 $(i,j)$ 处、方向为 $m$ 的 $\\psi_{i,j,m}$ 的离散更新公式，用其迎风邻居和边界入流值来表示。然后实现一个程序，该程序：\n- 为每个方向生成扫描顺序。\n- 为指定的测试用例计算角通量 $\\psi_{i,j,m}$ 和标量通量 $\\phi_{i,j}$。\n- 验证迎风格式所蕴含的单调性。\n\n假设区域为凸矩形，索引 $i \\in \\{0,\\ldots,N_x-1\\}$ 和 $j \\in \\{0,\\ldots,N_y-1\\}$。在二维情况下使用以下离散方向集：\n- 四个方向，其方向余弦为 $\\left(\\mu_m,\\eta_m\\right) \\in \\left\\{ \\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right), \\left(\\frac{1}{\\sqrt{2}},-\\frac{1}{\\sqrt{2}}\\right), \\left(-\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right), \\left(-\\frac{1}{\\sqrt{2}},-\\frac{1}{\\sqrt{2}}\\right) \\right\\}$，权重为 $w_m = \\frac{1}{4}$，$m=1,\\ldots,4$。\n\n您的程序必须实现迎风离散更新，在迎风邻居位于区域外部时应用入流边界条件 $g$，并根据 $\\mu_m$ 和 $\\eta_m$ 的符号为每个方向执行正确顺序的扫描。\n\n测试套件：\n- 测试用例 1（正常路径）：$N_x = 6$，$N_y = 5$，$\\Delta x = 0.1$ 米，$\\Delta y = 0.1$ 米，$\\sigma_t = 1.0$ 米$^{-1}$，$q = 1.0$（各向同性，对所有方向相同），$g = 0.0$。计算标量通量场并报告 $\\min_{i,j} \\phi_{i,j}$。该值以粒子数/平方米/秒（即 $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$）表示。\n- 测试用例 2（源项的单调性）：几何形状和方向与测试用例1相同。比较 $q_1 = 0.5$ 和 $q_2 = 1.0$ 两种情况，其中 $g = 0.0$ 且 $\\sigma_t = 1.0$ 米$^{-1}$。验证对于所有单元，$\\phi^{(2)}_{i,j} \\ge \\phi^{(1)}_{i,j}$。如果该不等式在所有地方都成立（在与浮点运算一致的容差范围内），则输出布尔值 $\\mathrm{True}$，否则输出 $\\mathrm{False}$。\n- 测试用例 3（吸收的单调性）：几何形状和方向与测试用例1相同。在 $q = 1.0$ 和 $g = 0.0$ 的条件下，比较 $\\sigma_{t,\\mathrm{low}} = 0.5$ 米$^{-1}$ 和 $\\sigma_{t,\\mathrm{high}} = 2.0$ 米$^{-1}$。验证对于所有单元，$\\phi^{(\\mathrm{high})}_{i,j} \\le \\phi^{(\\mathrm{low})}_{i,j}$。如果该不等式在所有地方都成立（在与浮点运算一致的容差范围内），则输出布尔值 $\\mathrm{True}$，否则输出 $\\mathrm{False}$。\n- 测试用例 4（顺序检查，边界情况）：$N_x = 3$，$N_y = 3$，单个方向为 $(\\mu,\\eta) = (0.6,-0.8)$（顺序检查不需要单位方向），$\\Delta x$、$\\Delta y$ 为任意值。构建扫描顺序并验证当 $\\mu > 0$ 且 $\\eta  0$ 时，第一个被访问的单元是 $(0,N_y-1)$，最后一个被访问的单元是 $(N_x-1,0)$，并且该顺序恰好包含 $N_x \\cdot N_y$ 个单元。如果所有条件都成立，则输出布尔值 $\\mathrm{True}$，否则输出 $\\mathrm{False}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n- 测试用例1的 $\\min \\phi$（一个以 $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 为单位的浮点数），\n- 测试用例2的布尔结果，\n- 测试用例3的布尔结果，\n- 测试用例4的布尔结果。\n\n例如，输出应类似于 $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}]$。\n\n所有角度都通过方向余弦指定，它们是无量纲的。报告的标量通量值是角平均值（权重和为1），因此它们的单位与角通量相同，即粒子数/平方米/秒。角度不被报告，因此输出不需要角度单位。确保所有数值输出都是确定性生成的，无需任何外部输入。",
            "solution": "用户提供了一个有效的问题陈述。该问题在辐射输运领域具有科学依据，是适定、客观的，并包含了构建唯一、可验证解所需的所有信息。\n\n任务是使用带有一阶迎风空间差分的离散纵标 (S$_N$) 方法，在矩形区域上求解二维、稳态、单能线性辐射输运方程。控制方程为：\n$$\n\\mu \\frac{\\partial \\psi}{\\partial x} + \\eta \\frac{\\partial \\psi}{\\partial y} + \\sigma_t \\psi = q\n$$\n这里，$\\psi(x, y, \\Omega)$ 是在位置 $(x,y)$ 处沿方向 $\\Omega$ 运动的粒子的角通量。方向余弦是 $\\mu$ 和 $\\eta$。介质由一个恒定的总截面 $\\sigma_t$ 和一个各向同性体积源 $q$ 来表征。解的构建将首先推导离散更新公式，然后建立正确的计算流程（扫描顺序），最后实现此算法以解决指定的测试用例。\n\n**1. 输运方程的离散化**\n\n我们在一个大小为 $\\Delta x \\times \\Delta y$ 的均匀笛卡尔网格上离散化该方程。网格索引为 $i \\in \\{0, \\ldots, N_x-1\\}$ 和 $j \\in \\{0, \\ldots, N_y-1\\}$。我们考虑一个包含 $M$ 个方向的离散集合 $\\{\\Omega_m\\}_{m=1}^M$，其中方向 $\\Omega_m$ 的余弦为 $(\\mu_m, \\eta_m)$。对于每个方向 $m$，我们对连续方程进行近似。设 $\\psi_{i,j,m}$ 为单元 $(i,j)$ 中方向 $m$ 的平均角通量。\n\n在单元中心 $(x_i, y_j)$ 处空间导数的一阶有限差分近似为：\n$$\n\\left. \\frac{\\partial \\psi_m}{\\partial x} \\right|_{i,j} \\approx \\frac{\\psi_{i+1/2,j,m} - \\psi_{i-1/2,j,m}}{\\Delta x}\n$$\n$$\n\\left. \\frac{\\partial \\psi_m}{\\partial y} \\right|_{i,j} \\approx \\frac{\\psi_{i,j+1/2,m} - \\psi_{i,j-1/2,m}}{\\Delta y}\n$$\n其中 $\\psi_{i+1/2,j,m}$ 是单元右侧面上的角通量，$\\psi_{i-1/2,j,m}$ 是左侧面上的通量，以此类推。\n\n一阶迎风格式（或“阶梯”格式）用来自迎风单元的单元平均通量来近似面通量。迎风单元是粒子流入的那个单元。例如，如果 $\\mu_m > 0$，粒子从左向右流动，因此 $x$ 导数的迎风方向来自单元 $i-1$。因此，面通量近似为：\n- 如果 $\\mu_m > 0$，则 $\\psi_{i-1/2,j,m} = \\psi_{i-1,j,m}$ 且 $\\psi_{i+1/2,j,m} = \\psi_{i,j,m}$。\n- 如果 $\\mu_m  0$，则 $\\psi_{i+1/2,j,m} = \\psi_{i+1,j,m}$ 且 $\\psi_{i-1/2,j,m} = \\psi_{i,j,m}$。\n\n对于 $y$ 方向，也根据 $\\eta_m$ 的符号进行类似处理。将这些代入有限差分近似中得到：\n$$\n\\frac{\\partial \\psi_m}{\\partial x} \\approx \\frac{\\psi_{i,j,m} - \\psi_{\\text{upwind},x}}{\\Delta x} \\quad (\\text{if } \\mu_m > 0) \\quad \\text{or} \\quad \\frac{\\psi_{\\text{upwind},x} - \\psi_{i,j,m}}{\\Delta x} \\quad (\\text{if } \\mu_m  0)\n$$\n这可以用绝对值紧凑地写为：$\\mu_m \\frac{\\partial \\psi_m}{\\partial x} \\approx \\frac{|\\mu_m|}{\\Delta x} (\\psi_{i,j,m} - \\psi_{\\text{upwind},x})$。\n\n单元 $(i,j)$ 和方向 $m$ 的完全离散化方程为：\n$$\n\\frac{|\\mu_m|}{\\Delta x} (\\psi_{i,j,m} - \\psi_{x, \\text{in}}) + \\frac{|\\eta_m|}{\\Delta y} (\\psi_{i,j,m} - \\psi_{y, \\text{in}}) + \\sigma_t \\psi_{i,j,m} = q\n$$\n这里，$\\psi_{x, \\text{in}}$ 和 $\\psi_{y, \\text{in}}$ 分别是 $x$ 和 $y$ 方向上单元面上的迎风角通量。\n\n**2. 离散更新公式**\n\n我们可以从上一步的代数方程中解出 $\\psi_{i,j,m}$：\n$$\n\\psi_{i,j,m} \\left( \\frac{|\\mu_m|}{\\Delta x} + \\frac{|\\eta_m|}{\\Delta y} + \\sigma_t \\right) = \\frac{|\\mu_m|}{\\Delta x} \\psi_{x, \\text a{in}} + \\frac{|\\eta_m|}{\\Delta y} \\psi_{y, \\text{in}} + q\n$$\n这就得到了最终的更新公式：\n$$\n\\psi_{i,j,m} = \\frac{\\frac{|\\mu_m|}{\\Delta x} \\psi_{x, \\text{in}} + \\frac{|\\eta_m|}{\\Delta y} \\psi_{y, \\text{in}} + q}{\\frac{|\\mu_m|}{\\Delta x} + \\frac{|\\eta_m|}{\\Delta y} + \\sigma_t}\n$$\n迎风通量值 $\\psi_{x, \\text{in}}$ 和 $\\psi_{y, \\text{in}}$ 取决于方向 $(\\mu_m, \\eta_m)$：\n- 如果 $\\mu_m > 0$，则 $\\psi_{x, \\text{in}} = \\psi_{i-1,j,m}$。如果 $i=0$，这是一个入流边界，所以 $\\psi_{x, \\text{in}} = g(\\Omega_m)$。\n- 如果 $\\mu_m  0$，则 $\\psi_{x, \\text{in}} = \\psi_{i+1,j,m}$。如果 $i=N_x-1$，这是一个入流边界，所以 $\\psi_{x, \\text{in}} = g(\\Omega_m)$。\n- 如果 $\\eta_m > 0$，则 $\\psi_{y, \\text{in}} = \\psi_{i,j-1,m}$。如果 $j=0$，这是一个入流边界，所以 $\\psi_{y, \\text{in}} = g(\\Omega_m)$。\n- 如果 $\\eta_m  0$，则 $\\psi_{y, \\text{in}} = \\psi_{i,j+1,m}$。如果 $j=N_y-1$，这是一个入流边界，所以 $\\psi_{y, \\text{in}} = g(\\Omega_m)$。\n\n**3. 扫描顺序**\n\n$\\psi_{i,j,m}$ 的更新依赖于相邻迎风单元中预先计算的值。这种数据依赖性强制要求在整个网格上采用一种严格的计算顺序，称为扫描。扫描必须从区域的入流边界向内部进行，沿着该方向上粒子的“流动”方向。扫描顺序完全由 $\\mu_m$ 和 $\\eta_m$ 的符号决定，它们定义了方向向量所在的象限。\n\n对于一个 $i \\in \\{0, \\ldots, N_x-1\\}$ 和 $j \\in \\{0, \\ldots, N_y-1\\}$ 的矩形网格：\n1.  **象限 I ($\\mu_m > 0, \\eta_m > 0$):** 从左下扫描到右上。循环 $i$ 从 $0$ 到 $N_x-1$，$j$ 从 $0$ 到 $N_y-1$。\n2.  **象限 II ($\\mu_m  0, \\eta_m > 0$):** 从右下扫描到左上。循环 $i$ 从 $N_x-1$ 向下到 $0$，$j$ 从 $0$ 到 $N_y-1$。\n3.  **象限 III ($\\mu_m  0, \\eta_m  0$):** 从右上扫描到左下。循环 $i$ 从 $N_x-1$ 向下到 $0$，$j$ 从 $N_y-1$ 向下到 $0$。\n4.  **象限 IV ($\\mu_m > 0, \\eta_m  0$):** 从左上扫描到右下。循环 $i$ 从 $0$ 到 $N_x-1$，$j$ 从 $N_y-1$ 向下到 $0$。\n\n这确保了每当计算 $\\psi_{i,j,m}$ 时，所需的迎风值（$\\psi_{i \\pm 1, j, m}$ 和 $\\psi_{i, j \\pm 1, m}$）在当前扫描中已经可用。\n\n**4. 算法实现与验证**\n\n整体算法包括遍历每个离散方向，执行一次完整的空间扫描来计算角通量场 $\\psi_m(x,y)$，并将其加权贡献累加到总标量通量 $\\phi(x,y)$ 中。\n\n该算法如下：\n1.  初始化一个 $N_x \\times N_y$ 的标量通量数组 $\\phi$，所有元素为零。\n2.  对于每个权重为 $w_m$ 的离散方向 $\\Omega_m$：\n    a. 根据 $\\mu_m, \\eta_m$ 的符号确定扫描顺序（$i$ 和 $j$ 的循环范围）。\n    b. 创建一个临时的 $N_x \\times N_y$ 数组 $\\psi_m$，初始化为零。\n    c. 执行扫描：按确定的顺序遍历所有单元 $(i,j)$。在每个单元中：\n        i. 使用边界值 $g(\\Omega_m)$ 或在 $\\psi_m$ 中先前计算的值来确定迎风通量 $\\psi_{x, \\text{in}}$ 和 $\\psi_{y, \\text{in}}$。\n        ii. 使用推导出的离散更新公式计算 $\\psi_{i,j,m}$。\n        iii. 将结果存储在 $\\psi_m[i,j]$ 中。\n    d. 将角通量贡献加到标量通量上：$\\phi \\leftarrow \\phi + w_m \\psi_m$。\n3.  遍历所有方向后，数组 $\\phi$ 包含最终的标量通量场。\n\n该算法在提供的 Python 代码中实现。测试用例验证了关键属性：\n- **测试用例 1:** 对于给定的参数集，直接计算标量通量场并找到其最小值。\n- **测试用例 2 (源项单调性):** 更新公式表明 $\\psi_{i,j,m}$ 是源项 $q$ 的单调递增函数（因为所有系数和分母都为正）。因此，标量通量 $\\phi = \\sum w_m \\psi_m$ 也必须关于 $q$ 是单调的。我们验证当 $q_2 > q_1$ 时，$\\phi^{(2)} \\ge \\phi^{(1)}$。\n- **测试用例 3 (吸收单调性):** 截面 $\\sigma_t$ 出现在更新公式的分母中。因此，$\\psi_{i,j,m}$ 是 $\\sigma_t$ 的单调递减函数。我们验证当 $\\sigma_{t,\\text{high}} > \\sigma_{t,\\text{low}}$ 时，$\\phi^{(\\text{high})} \\le \\phi^{(\\text{low})}$。\n- **测试用例 4 (扫描顺序):** 直接测试第四象限中一个方向的扫描顺序逻辑，确认了第一个和最后一个被访问的单元以及扫描路径中的总单元数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef generate_sweep_order_info(Nx, Ny, mu, eta):\n    \"\"\"\n    Generates sweep order for a given direction and performs checks for Test Case 4.\n    \"\"\"\n    order = []\n    i_range = range(Nx) if mu > 0 else range(Nx - 1, -1, -1)\n    j_range = range(Ny) if eta > 0 else range(Ny - 1, -1, -1)\n    \n    for i in i_range:\n        for j in j_range:\n            order.append((i, j))\n            \n    # Expected first and last cells for mu > 0, eta  0\n    expected_first = (0, Ny - 1)\n    expected_last = (Nx - 1, 0)\n    \n    check1 = (order[0] == expected_first)\n    check2 = (order[-1] == expected_last)\n    check3 = (len(order) == Nx * Ny)\n    \n    return all([check1, check2, check3])\n\ndef transport_sweep_solver(Nx, Ny, dx, dy, sigma_t, q, g, directions, weights):\n    \"\"\"\n    Solves the 2D S_N transport equation using first-order upwinding.\n    \"\"\"\n    phi = np.zeros((Nx, Ny))\n    num_directions = len(directions)\n    \n    for m in range(num_directions):\n        mu_m, eta_m = directions[m]\n        w_m = weights[m]\n        \n        psi_m = np.zeros((Nx, Ny))\n        \n        # Determine sweep order based on direction quadrant\n        i_range = range(Nx) if mu_m > 0 else range(Nx - 1, -1, -1)\n        j_range = range(Ny) if eta_m > 0 else range(Ny - 1, -1, -1)\n        \n        # Perform transport sweep for direction m\n        for i in i_range:\n            for j in j_range:\n                # Determine upwind flux in x-direction\n                if mu_m > 0:\n                    psi_x_in = psi_m[i - 1, j] if i > 0 else g\n                else:  # mu_m  0\n                    psi_x_in = psi_m[i + 1, j] if i  Nx - 1 else g\n                \n                # Determine upwind flux in y-direction\n                if eta_m > 0:\n                    psi_y_in = psi_m[i, j - 1] if j > 0 else g\n                else:  # eta_m  0\n                    psi_y_in = psi_m[i, j + 1] if j  Ny - 1 else g\n\n                # Since mu_m and eta_m are non-zero for the given problem,\n                # we don't need to handle the case of zero-dimensional derivatives.\n                \n                abs_mu_m = abs(mu_m)\n                abs_eta_m = abs(eta_m)\n                \n                numerator = (abs_mu_m / dx) * psi_x_in + (abs_eta_m / dy) * psi_y_in + q\n                denominator = (abs_mu_m / dx) + (abs_eta_m / dy) + sigma_t\n                \n                psi_m[i, j] = numerator / denominator\n                \n        # Add contribution to scalar flux\n        phi += w_m * psi_m\n        \n    return phi\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    results = []\n    \n    # Common parameters\n    Nx_common, Ny_common = 6, 5\n    dx_common, dy_common = 0.1, 0.1\n    g_common = 0.0\n    \n    # S4-like discrete ordinate set\n    sqrt2_inv = 1.0 / np.sqrt(2)\n    directions_common = np.array([\n        [sqrt2_inv, sqrt2_inv],\n        [sqrt2_inv, -sqrt2_inv],\n        [-sqrt2_inv, sqrt2_inv],\n        [-sqrt2_inv, -sqrt2_inv]\n    ])\n    weights_common = np.array([0.25, 0.25, 0.25, 0.25])\n    \n    # --- Test Case 1: Happy Path ---\n    sigma_t_tc1 = 1.0\n    q_tc1 = 1.0\n    phi_tc1 = transport_sweep_solver(\n        Nx_common, Ny_common, dx_common, dy_common,\n        sigma_t_tc1, q_tc1, g_common,\n        directions_common, weights_common\n    )\n    result1 = np.min(phi_tc1)\n    results.append(result1)\n\n    # --- Test Case 2: Monotonicity in Source ---\n    sigma_t_tc2 = 1.0\n    q1 = 0.5\n    q2 = 1.0\n    phi1_tc2 = transport_sweep_solver(\n        Nx_common, Ny_common, dx_common, dy_common,\n        sigma_t_tc2, q1, g_common,\n        directions_common, weights_common\n    )\n    phi2_tc2 = transport_sweep_solver(\n        Nx_common, Ny_common, dx_common, dy_common,\n        sigma_t_tc2, q2, g_common,\n        directions_common, weights_common\n    )\n    # Verify phi2 >= phi1 for all cells, with a small tolerance for floating point errors\n    result2 = bool(np.all(phi2_tc2 >= phi1_tc2 - 1e-12))\n    results.append(result2)\n\n    # --- Test Case 3: Monotonicity in Absorption ---\n    q_tc3 = 1.0\n    sigma_t_low = 0.5\n    sigma_t_high = 2.0\n    phi_low_tc3 = transport_sweep_solver(\n        Nx_common, Ny_common, dx_common, dy_common,\n        sigma_t_low, q_tc3, g_common,\n        directions_common, weights_common\n    )\n    phi_high_tc3 = transport_sweep_solver(\n        Nx_common, Ny_common, dx_common, dy_common,\n        sigma_t_high, q_tc3, g_common,\n        directions_common, weights_common\n    )\n    # Verify phi_high = phi_low for all cells, with a small tolerance\n    result3 = bool(np.all(phi_high_tc3 = phi_low_tc3 + 1e-12))\n    results.append(result3)\n    \n    # --- Test Case 4: Ordering Check ---\n    Nx_tc4, Ny_tc4 = 3, 3\n    mu_tc4, eta_tc4 = 0.6, -0.8 # mu > 0, eta  0\n    # The dx, dy values are not needed for ordering check.\n    result4 = generate_sweep_order_info(Nx_tc4, Ny_tc4, mu_tc4, eta_tc4)\n    results.append(result4)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}