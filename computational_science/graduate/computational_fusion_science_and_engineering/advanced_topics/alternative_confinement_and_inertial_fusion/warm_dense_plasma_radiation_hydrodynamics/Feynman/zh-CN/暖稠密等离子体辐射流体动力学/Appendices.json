{
    "hands_on_practices": [
        {
            "introduction": "为了精确模拟温稠密物质，我们必须首先理解其独特的物理性质。本练习将引导您完成一项基本计算，以揭示为何温稠密物质被视为“强耦合”等离子体，在此区域内，诸如德拜-亥克尔屏蔽等经典理论不再适用。通过比较平均粒子间距与德拜长度，您将量化这一关键假设失效的程度。",
            "id": "4063812",
            "problem": "一个均匀、完全电离的类氢温稠密等离子体，代表了惯性约束聚变（ICF）辐射流体力学中的烧蚀层，其特征是离子数密度 $n_{i}$ 和电子温度 $T$。平均电离态为 $\\bar{Z}$。在所关注的区域内，德拜-亥克尔屏蔽的有效性取决于平均粒子间距与静电屏蔽长度的比值。仅使用第一性原理定义，估算在以下条件下 Wigner–Seitz 平均粒子间距与经典静电屏蔽长度（Debye 长度）的比值：\n- $n_{i} = 1.0 \\times 10^{29}\\ \\mathrm{m}^{-3}$，\n- $\\bar{Z} = 1.0$（因此电子数密度为 $n_{e} = \\bar{Z} n_{i}$），\n- $T = 10\\ \\mathrm{eV}$。\n\n使用从 Maxwell–Boltzmann 电子布居的线性响应推导出的 Wigner–Seitz 半径 $a$ 和经典 Debye 长度 $\\lambda_{D}$ 的标准定义。在屏蔽尺度上，对于静电响应，假设离子是固定不动的。取以下常数：\n- 真空介电常数 $\\epsilon_{0} = 8.854\\,187\\,8128 \\times 10^{-12}\\ \\mathrm{F\\,m^{-1}}$，\n- Boltzmann 常数 $k_{B} = 1.380\\,649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$，\n- 基本电荷 $e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\mathrm{C}$，\n- 使用 $\\pi = 3.141\\,592\\,653\\,589\\,793$，\n- 温度-能量转换关系 $1\\ \\mathrm{eV} = e \\times 1\\ \\mathrm{V} = 1.602\\,176\\,634 \\times 10^{-19}\\ \\mathrm{J}$。\n\n在进行最终数值计算之前，先进行符号推导。计算无量纲比值 $a/\\lambda_{D}$，并将其报告为一个纯数。将最终结果四舍五入到三位有效数字。",
            "solution": "目标是使用第一性原理计算在温稠密等离子体条件下的比值 $a/\\lambda_{D}$。\n\n从离子的 Wigner–Seitz 半径（平均粒子间距）的定义开始。Wigner–Seitz 球的定义为一个离子占据的体积等于该球的体积：\n$$\n\\frac{4}{3}\\pi a^{3} = \\frac{1}{n_{i}} \\quad \\Longrightarrow \\quad a = \\left(\\frac{3}{4\\pi n_{i}}\\right)^{1/3}.\n$$\n\n接下来，从 Maxwell–Boltzmann 电子气的线性响应推导经典 Debye 长度。考虑准中性等离子体中的一个小的静电势扰动 $\\phi$。电子密度根据 Boltzmann 因子响应：\n$$\nn_{e}(\\phi) \\approx n_{e0} \\exp\\!\\left(\\frac{e\\phi}{k_{B}T}\\right) \\approx n_{e0}\\left(1 + \\frac{e\\phi}{k_{B}T}\\right),\n$$\n其中线性化假设 $|e\\phi| \\ll k_{B}T$。电荷密度扰动为 $\\rho \\approx -e\\left[n_{e}(\\phi)-n_{e0}\\right] \\approx -e n_{e0}\\left(\\frac{e\\phi}{k_{B}T}\\right)$。Poisson 方程给出\n$$\n\\nabla^{2}\\phi = -\\frac{\\rho}{\\epsilon_{0}} \\approx \\frac{e^{2} n_{e0}}{\\epsilon_{0} k_{B} T}\\,\\phi.\n$$\n从 $\\nabla^{2}\\phi - \\phi/\\lambda_{D}^{2} = 0$ 中确定屏蔽长度 $\\lambda_{D}$，得到经典 Debye 长度\n$$\n\\lambda_{D} = \\sqrt{\\frac{\\epsilon_{0} k_{B} T}{n_{e} e^{2}}}.\n$$\n\n对于平均电离态为 $\\bar{Z}$ 的完全电离类氢等离子体，电子密度为 $n_{e} = \\bar{Z} n_{i}$。因此，所关注的比值为\n$$\n\\frac{a}{\\lambda_{D}} = \\left(\\frac{3}{4\\pi n_{i}}\\right)^{1/3}\\,\\sqrt{\\frac{n_{e} e^{2}}{\\epsilon_{0} k_{B} T}}\n= \\left(\\frac{3}{4\\pi n_{i}}\\right)^{1/3}\\,\\sqrt{\\frac{\\bar{Z} n_{i} e^{2}}{\\epsilon_{0} k_{B} T}}.\n$$\n\n代入给定参数 $n_{i} = 1.0 \\times 10^{29}\\ \\mathrm{m^{-3}}$，$\\bar{Z} = 1.0$ 和 $T = 10\\ \\mathrm{eV}$。首先计算 $a$：\n$$\na = \\left(\\frac{3}{4\\pi \\times 1.0 \\times 10^{29}}\\right)^{1/3}\\ \\mathrm{m}.\n$$\n数值上，\n$$\n\\frac{3}{4\\pi \\times 1.0 \\times 10^{29}} = \\frac{3}{1.256637061 \\times 10^{30}} \\approx 2.387324146 \\times 10^{-30},\n$$\n所以\n$$\na \\approx \\left(2.387324146 \\times 10^{-30}\\right)^{1/3}\\ \\mathrm{m} \\approx 1.336 \\times 10^{-10}\\ \\mathrm{m}.\n$$\n\n接下来计算 $\\lambda_{D}$，使用 $n_{e} = \\bar{Z} n_{i} = 1.0 \\times 10^{29}\\ \\mathrm{m^{-3}}$ 和 $k_{B}T = 10\\ \\mathrm{eV} = 10 \\times 1.602\\,176\\,634 \\times 10^{-19}\\ \\mathrm{J} = 1.602\\,176\\,634 \\times 10^{-18}\\ \\mathrm{J}$：\n$$\n\\lambda_{D} = \\sqrt{\\frac{\\epsilon_{0} k_{B} T}{n_{e} e^{2}}}\n= \\sqrt{\\frac{(8.854\\,187\\,8128 \\times 10^{-12})\\times(1.602\\,176\\,634 \\times 10^{-18})}{(1.0 \\times 10^{29})\\times(1.602\\,176\\,634 \\times 10^{-19})^{2}}}\\ \\mathrm{m}.\n$$\n分别计算分子和分母：\n$$\n\\epsilon_{0} k_{B} T \\approx 1.419 \\times 10^{-29}\\ \\mathrm{J\\,F\\,m^{-1}},\\quad\nn_{e} e^{2} = 1.0 \\times 10^{29} \\times 2.566\\,969\\,9 \\times 10^{-38} \\approx 2.566\\,969\\,9 \\times 10^{-9}.\n$$\n因此\n$$\n\\lambda_{D} \\approx \\sqrt{\\frac{1.419 \\times 10^{-29}}{2.566\\,969\\,9 \\times 10^{-9}}}\\ \\mathrm{m}\n= \\sqrt{5.532 \\times 10^{-21}}\\ \\mathrm{m} \\approx 7.436 \\times 10^{-11}\\ \\mathrm{m}.\n$$\n\n最后，计算该比值：\n$$\n\\frac{a}{\\lambda_{D}} \\approx \\frac{1.336 \\times 10^{-10}}{7.436 \\times 10^{-11}} \\approx 1.796.\n$$\n四舍五入到三位有效数字，结果是 $1.80$。\n\n在温稠密等离子体辐射流体力学的背景下解读：比值 $a/\\lambda_{D} \\gtrsim 1$ 意味着 Debye 球内的电子数 $N_{D} = \\tfrac{4}{3}\\pi n_{e} \\lambda_{D}^{3}$ 约为单位量级，这违反了德拜-亥克尔理论所基于的弱耦合假设。这表明，在给定的温稠密物质状态下，集体屏蔽与粒子间尺度没有很好地分离开，因此在将辐射输运与等离子体微观物理耦合时，有必要使用超出德拜-亥克尔理论的模型。然而，题目所要求的量是上面计算出的数值比。",
            "answer": "$$\\boxed{1.80}$$"
        },
        {
            "introduction": "辐射能量输运是温稠密物质流体动力学的核心，但精确处理依赖于频率的不透明度在计算上代价高昂。本练习探讨了平均不透明度的概念，重点对比了分别适用于模拟发射和输运的普朗克平均不透明度与罗斯兰平均不透明度。您将通过编程实现计算，以量化在输运模型中使用错误平均不透明度所导致的显著误差。",
            "id": "4063844",
            "problem": "考虑处于辐射扩散状态下的一维温稠密等离子体 (WDP)。辐射输运采用扩散近似建模，频率相关的吸收由具有分段常数质量吸收不透明度的群谱描述。你的任务是量化在两个物理相关量（辐射能流和瞬时 Marshak 波前速度）中使用普朗克平均不透明度代替罗瑟兰平均不透明度所产生的误差。温稠密等离子体指的是一种状态，其中物质部分电离，辐射对能量输运有显著贡献，温度量级为 $10^{5}\\text{ K}$ 到 $10^{6}\\text{ K}$，密度为类固态密度。程序必须计算并报告指定测试套件的结果。\n\n使用的基本原理：\n- 温度为 $T$ 的黑体的普朗克谱辐射亮度 $B_{\\nu}(T)$ 为\n$$\nB_{\\nu}(T) = \\frac{2 h \\nu^{3}}{c^{2}} \\frac{1}{\\exp\\!\\left(\\frac{h \\nu}{k_{\\mathrm{B}} T}\\right) - 1},\n$$\n其中 $h$ 是普朗克常数，$c$ 是真空光速，$\\nu$ 是光子频率，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n- 普朗克谱辐射亮度的温度导数为\n$$\n\\frac{\\partial B_{\\nu}}{\\partial T}(T) = \\frac{2 h \\nu^{3}}{c^{2}} \\cdot \\frac{x \\exp(x)}{T \\left(\\exp(x) - 1\\right)^{2}},\n\\quad \\text{with} \\quad x = \\frac{h \\nu}{k_{\\mathrm{B}} T}.\n$$\n- 在给定频率范围内，对于质量吸收不透明度 $\\kappa_{\\nu}$，普朗克平均不透明度 $\\kappa_{\\mathrm{P}}(T)$ 定义为\n$$\n\\kappa_{\\mathrm{P}}(T) = \\frac{\\displaystyle \\int_{\\nu_{\\min}}^{\\nu_{\\max}} \\kappa_{\\nu} B_{\\nu}(T)\\, d\\nu}{\\displaystyle \\int_{\\nu_{\\min}}^{\\nu_{\\max}} B_{\\nu}(T)\\, d\\nu}.\n$$\n- 在相同范围内，罗瑟兰平均不透明度 $\\kappa_{\\mathrm{R}}(T)$ 通过以下方式定义\n$$\n\\frac{1}{\\kappa_{\\mathrm{R}}(T)} = \\frac{\\displaystyle \\int_{\\nu_{\\min}}^{\\nu_{\\max}} \\frac{1}{\\kappa_{\\nu}} \\frac{\\partial B_{\\nu}}{\\partial T}(T)\\, d\\nu}{\\displaystyle \\int_{\\nu_{\\min}}^{\\nu_{\\max}} \\frac{\\partial B_{\\nu}}{\\partial T}(T)\\, d\\nu}.\n$$\n- 辐射常数 $a$ 通过 $a = \\frac{4 \\sigma}{c}$ 与斯特藩-玻尔兹曼常数 $\\sigma$ 相关。\n- 在辐射扩散近似中，对于均匀温度梯度 $\\nabla T$ 和质量密度 $\\rho$，辐射能流的大小为\n$$\nF = \\frac{4 a c T^{3}}{3 \\kappa \\rho} \\left\\lVert \\nabla T \\right\\rVert,\n$$\n其中，为了物理上的一致性，$\\kappa$ 必须是罗瑟兰平均不透明度 $\\kappa_{\\mathrm{R}}(T)$。在此公式中使用 $\\kappa_{\\mathrm{P}}(T)$ 会引入一个待量化的误差。\n- 对于辐射能量密度 $E_{\\mathrm{rad}} = a T^{4}$，辐射能扩散系数为\n$$\nD = \\frac{c}{3 \\kappa \\rho}.\n$$\n- 对于一个初始辐射能量密度为零的半无限介质，其在位置 $x = 0$ 处的边界保持辐射能量密度为 $E_{s} = a T^{4}$，具有常数 $D$ 的线性扩散方程的解为\n$$\nE(x,t) = E_{s} \\, \\mathrm{erfc}\\!\\left(\\frac{x}{2 \\sqrt{D t}}\\right),\n$$\n其中 $\\mathrm{erfc}$ 是互补误差函数。通过 $E(x_{f},t) = \\frac{E_{s}}{2}$ 隐式定义 Marshak 波前位置 $x_{f}(t)$，可得\n$$\nx_{f}(t) = 2 \\sqrt{D t} \\, \\mathrm{erfc}^{-1}\\!\\left(\\frac{1}{2}\\right),\n$$\n瞬时波前速度为\n$$\nv(t) = \\frac{d x_{f}}{d t} = \\mathrm{erfc}^{-1}\\!\\left(\\frac{1}{2}\\right) \\sqrt{\\frac{D}{t}}.\n$$\n\n计算任务：\n- 对每个测试用例，通过在指定的频率群上进行数值积分，计算普朗克平均不透明度 $\\kappa_{\\mathrm{P}}(T)$ 和罗瑟兰平均不透明度 $\\kappa_{\\mathrm{R}}(T)$。每个群 $i$ 由一个下界 $\\nu_{i}^{\\mathrm{low}}$、一个上界 $\\nu_{i}^{\\mathrm{high}}$ 和一个常数质量吸收不透明度 $\\kappa_{i}$ 指定；在一个群内，设置 $\\kappa_{\\nu} = \\kappa_{i}$。总积分边界为 $\\nu_{\\min} = \\min_{i} \\nu_{i}^{\\mathrm{low}}$ 和 $\\nu_{\\max} = \\max_{i} \\nu_{i}^{\\mathrm{high}}$，积分被评估为在每个群子区间上的积分之和。\n- 使用 $\\kappa_{\\mathrm{R}}(T)$，计算物理上一致的辐射能流大小 $F_{\\mathrm{R}} = \\frac{4 a c T^{3}}{3 \\kappa_{\\mathrm{R}} \\rho} \\left\\lVert \\nabla T \\right\\rVert$。然后，通过将 $\\kappa_{\\mathrm{P}}(T)$ 代入相同公式，计算得到的错误能流大小 $F_{\\mathrm{P}} = \\frac{4 a c T^{3}}{3 \\kappa_{\\mathrm{P}} \\rho} \\left\\lVert \\nabla T \\right\\rVert$。\n- 计算辐射扩散系数 $D_{\\mathrm{R}} = \\frac{c}{3 \\kappa_{\\mathrm{R}} \\rho}$ 和 $D_{\\mathrm{P}} = \\frac{c}{3 \\kappa_{\\mathrm{P}} \\rho}$，然后在指定时间 $t$ 使用上述公式计算瞬时 Marshak 波前速度 $v_{\\mathrm{R}}(t)$ 和 $v_{\\mathrm{P}}(t)$。\n- 对每个测试用例，报告两个十进制数：能流大小的相对误差 $\\left|F_{\\mathrm{P}} - F_{\\mathrm{R}}\\right| / F_{\\mathrm{R}}$ 和瞬时波前速度的相对误差 $\\left|v_{\\mathrm{P}} - v_{\\mathrm{R}}\\right| / v_{\\mathrm{R}}$。这两个值都是无量纲的，并且必须以十进制数的形式报告，不带任何百分号。\n\n物理单位和常数：\n- 使用国际单位制 (SI)。温度单位为 $\\text{K}$，频率单位为 $\\text{Hz}$，不透明度单位为 $\\text{m}^{2}\\!/\\!\\text{kg}$，密度单位为 $\\text{kg}\\!/\\!\\text{m}^{3}$，空间梯度单位为 $\\text{K}\\!/\\!\\text{m}$，时间单位为 $\\text{s}$，能流单位为 $\\text{W}\\!/\\!\\text{m}^{2}$，速度单位为 $\\text{m}\\!/\\!\\text{s}$。\n- 常数：$h = 6.62607015 \\times 10^{-34}\\, \\text{J}\\cdot\\text{s}$，$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\, \\text{J}\\!/\\!\\text{K}$，$c = 2.99792458 \\times 10^{8}\\, \\text{m}\\!/\\!\\text{s}$，$\\sigma = 5.670374419 \\times 10^{-8}\\, \\text{W}\\!/\\!\\text{m}^{2}\\!/\\!\\text{K}^{4}$，$a = \\frac{4 \\sigma}{c}$。\n\n测试套件：\n- 测试用例 1（具有频率相关不透明度的典型温稠密等离子体）：\n  - $T = 1.5 \\times 10^{6}\\, \\text{K}$，$\\rho = 1.0 \\times 10^{3}\\, \\text{kg}\\!/\\!\\text{m}^{3}$，$\\left\\lVert \\nabla T \\right\\rVert = 1.0 \\times 10^{6}\\, \\text{K}\\!/\\!\\text{m}$，$t = 1.0 \\times 10^{-8}\\, \\text{s}$。\n  - 群组：$\\left(1.0 \\times 10^{15},\\, 5.0 \\times 10^{15},\\, 0.5\\right)$，$\\left(5.0 \\times 10^{15},\\, 2.0 \\times 10^{16},\\, 1.0\\right)$，$\\left(2.0 \\times 10^{16},\\, 5.0 \\times 10^{16},\\, 5.0\\right)$，$\\left(5.0 \\times 10^{16},\\, 1.0 \\times 10^{17},\\, 10.0\\right)$。\n- 测试用例 2（在整个频谱上不透明度近乎恒定）：\n  - $T = 1.0 \\times 10^{6}\\, \\text{K}$，$\\rho = 1.0 \\times 10^{3}\\, \\text{kg}\\!/\\!\\text{m}^{3}$，$\\left\\lVert \\nabla T \\right\\rVert = 1.0 \\times 10^{6}\\, \\text{K}\\!/\\!\\text{m}$，$t = 1.0 \\times 10^{-8}\\, \\text{s}$。\n  - 群组：$\\left(1.0 \\times 10^{15},\\, 5.0 \\times 10^{15},\\, 2.0\\right)$，$\\left(5.0 \\times 10^{15},\\, 2.0 \\times 10^{16},\\, 2.0\\right)$，$\\left(2.0 \\times 10^{16},\\, 5.0 \\times 10^{16},\\, 2.0\\right)$，$\\left(5.0 \\times 10^{16},\\, 1.0 \\times 10^{17},\\, 2.0\\right)$。\n- 测试用例 3（不透明度随频率强烈增加且密度更高）：\n  - $T = 5.0 \\times 10^{5}\\, \\text{K}$，$\\rho = 3.0 \\times 10^{3}\\, \\text{kg}\\!/\\!\\text{m}^{3}$，$\\left\\lVert \\nabla T \\right\\rVert = 5.0 \\times 10^{5}\\, \\text{K}\\!/\\!\\text{m}$，$t = 5.0 \\times 10^{-9}\\, \\text{s}$。\n  - 群组：$\\left(1.0 \\times 10^{15},\\, 3.0 \\times 10^{15},\\, 0.1\\right)$，$\\left(3.0 \\times 10^{15},\\, 1.0 \\times 10^{16},\\, 0.2\\right)$，$\\left(1.0 \\times 10^{16},\\, 5.0 \\times 10^{16},\\, 2.0\\right)$，$\\left(5.0 \\times 10^{16},\\, 2.0 \\times 10^{17},\\, 20.0\\right)$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含按测试用例顺序排列的结果，形式为用方括号括起来的逗号分隔列表。对于每个测试用例，首先输出能流相对误差，然后输出 Marshak 波前速度相对误差。例如，输出应如下所示\n$$\n[\\delta F_{1}, \\delta v_{1}, \\delta F_{2}, \\delta v_{2}, \\delta F_{3}, \\delta v_{3}],\n$$\n其中每个 $\\delta$ 是一个十进制数。",
            "solution": "该问题要求定量分析在辐射能流和 Marshak 波前传播速度的公式中，使用普朗克平均不透明度 $\\kappa_{\\mathrm{P}}$ 代替物理上正确的罗瑟兰平均不透明度 $\\kappa_{\\mathrm{R}}$ 时所引入的误差。该分析是在针对具有分段常数质量吸收不透明度谱的一维暖稠密等离子体的辐射扩散近似背景下进行的。\n\n问题的核心在于两种平均不透明度不同的物理作用和数学定义。普朗克平均不透明度 $\\kappa_{\\mathrm{P}}(T)$ 是频率相关不透明度 $\\kappa_{\\nu}$ 由普朗克黑体谱 $B_{\\nu}(T)$ 加权的平均值。\n$$\n\\kappa_{\\mathrm{P}}(T) = \\frac{\\displaystyle \\int \\kappa_{\\nu} B_{\\nu}(T)\\, d\\nu}{\\displaystyle \\int B_{\\nu}(T)\\, d\\nu}\n$$\n在考虑处于局域热力学平衡状态的材料体积所发射或包含的总能量时，这种平均最为相关。\n\n相反，罗瑟兰平均不透明度 $\\kappa_{\\mathrm{R}}(T)$ 是一个由普朗克函数的温度导数 $\\frac{\\partial B_{\\nu}}{\\partial T}(T)$ 加权的调和平均值。\n$$\n\\frac{1}{\\kappa_{\\mathrm{R}}(T)} = \\frac{\\displaystyle \\int \\frac{1}{\\kappa_{\\nu}} \\frac{\\partial B_{\\nu}}{\\partial T}(T)\\, d\\nu}{\\displaystyle \\int \\frac{\\partial B_{\\nu}}{\\partial T}(T)\\, d\\nu}\n$$\n权重函数 $\\frac{\\partial B_{\\nu}}{\\partial T}$ 强调的是那些温度变化引起辐射强度变化最大的频率。调和平均结构对不透明度 $\\kappa_{\\nu}$ 较低（即介质是透明的）的频率给予更大的权重。这是因为在扩散过程中，能量优先通过光谱中的这些低不透明度“窗口”流动。因此，在扩散近似下，$\\kappa_{\\mathrm{R}}$ 是用于模拟辐射能量输运的正确平均不透明度。辐射输运理论的一个基本结果是 $\\kappa_{\\mathrm{R}} \\le \\kappa_{\\mathrm{P}}$，等号仅在 $\\kappa_{\\nu}$ 与频率无关时成立。\n\n任务是计算两个量的相对误差：辐射能流大小 $F$ 和瞬时 Marshak 波前速度 $v(t)$。\n\n首先，考虑由辐射扩散的菲克定律给出的辐射能流大小：\n$$\nF = \\frac{c}{3 \\rho \\kappa} \\frac{d(aT^4)}{dx} = \\frac{4 a c T^3}{3 \\rho \\kappa} \\frac{dT}{dx}\n$$\n对于均匀温度梯度 $\\left\\lVert \\nabla T \\right\\rVert$，物理上一致的能流是 $F_{\\mathrm{R}} = \\frac{4 a c T^{3}}{3 \\kappa_{\\mathrm{R}} \\rho} \\left\\lVert \\nabla T \\right\\rVert$，而错误的能流是 $F_{\\mathrm{P}} = \\frac{4 a c T^{3}}{3 \\kappa_{\\mathrm{P}} \\rho} \\left\\lVert \\nabla T \\right\\rVert$。相对误差为：\n$$\n\\delta F = \\frac{\\left|F_{\\mathrm{P}} - F_{\\mathrm{R}}\\right|}{F_{\\mathrm{R}}} = \\frac{\\left|\\frac{1}{\\kappa_{\\mathrm{P}}} - \\frac{1}{\\kappa_{\\mathrm{R}}}\\right|}{\\frac{1}{\\kappa_{\\mathrm{R}}} } = \\left|\\frac{\\kappa_{\\mathrm{R}}}{\\kappa_{\\mathrm{P}}} - 1\\right|\n$$\n这个推导表明，能流的相对误差仅取决于两种平均不透明度的比值。\n\n接下来，考虑瞬时 Marshak 波前速度。波前传播被建模为一个扩散过程，其扩散系数为 $D = \\frac{c}{3 \\kappa \\rho}$。在时间 $t$ 的波前速度由 $v(t) = C \\sqrt{D/t}$ 给出，其中 $C = \\mathrm{erfc}^{-1}(1/2)$ 是一个常数。物理上一致的速度是 $v_{\\mathrm{R}}(t) = C \\sqrt{D_{\\mathrm{R}}/t}$，其中 $D_{\\mathrm{R}} = \\frac{c}{3 \\kappa_{\\mathrm{R}} \\rho}$；而错误的速度是 $v_{\\mathrm{P}}(t) = C \\sqrt{D_{\\mathrm{P}}/t}$，其中 $D_{\\mathrm{P}} = \\frac{c}{3 \\kappa_{\\mathrm{P}} \\rho}$。相对误差是：\n$$\n\\delta v = \\frac{\\left|v_{\\mathrm{P}} - v_{\\mathrm{R}}\\right|}{v_{\\mathrm{R}}} = \\frac{\\left|C \\sqrt{D_{\\mathrm{P}}/t} - C \\sqrt{D_{\\mathrm{R}}/t}\\right|}{C \\sqrt{D_{\\mathrm{R}}/t}} = \\frac{\\left|\\sqrt{D_{\\mathrm{P}}} - \\sqrt{D_{\\mathrm{R}}}\\right|}{\\sqrt{D_{\\mathrm{R}}}} = \\left|\\sqrt{\\frac{D_{\\mathrm{P}}}{D_{\\mathrm{R}}}} - 1\\right|\n$$\n代入扩散系数的定义，我们得到比值 $\\frac{D_{\\mathrm{P}}}{D_{\\mathrm{R}}} = \\frac{c / (3 \\kappa_{\\mathrm{P}} \\rho)}{c / (3 \\kappa_{\\mathrm{R}} \\rho)} = \\frac{\\kappa_{\\mathrm{R}}}{\\kappa_{\\mathrm{P}}}$。因此，速度的相对误差是：\n$$\n\\delta v = \\left|\\sqrt{\\frac{\\kappa_{\\mathrm{R}}}{\\kappa_{\\mathrm{P}}}} - 1\\right|\n$$\n与能流一样，速度的相对误差也仅取决于比值 $\\kappa_{\\mathrm{R}}/\\kappa_{\\mathrm{P}}$。这显著简化了计算任务，因为我们只需要为给定的温度 $T$ 和不透明度谱计算 $\\kappa_{\\mathrm{P}}(T)$ 和 $\\kappa_{\\mathrm{R}}(T)$。\n\n计算步骤如下。对于每个测试用例，我们给定一个温度 $T$ 和一组频率群，每个群由一个范围 $[\\nu_{i}^{\\mathrm{low}}, \\nu_{i}^{\\mathrm{high}}]$ 和一个常数质量吸收不透明度 $\\kappa_{i}$ 定义。为了计算 $\\kappa_{\\mathrm{P}}$ 和 $\\kappa_{\\mathrm{R}}$，我们必须在整个频率范围 $[\\nu_{\\min}, \\nu_{\\max}]$ 上评估四个积分：\n1.  $I_{1} = \\int \\kappa_{\\nu} B_{\\nu}(T) d\\nu = \\sum_i \\kappa_i \\int_{\\nu_i^{\\mathrm{low}}}^{\\nu_i^{\\mathrm{high}}} B_{\\nu}(T) d\\nu$\n2.  $I_{2} = \\int B_{\\nu}(T) d\\nu = \\sum_i \\int_{\\nu_i^{\\mathrm{low}}}^{\\nu_i^{\\mathrm{high}}} B_{\\nu}(T) d\\nu$\n3.  $I_{3} = \\int \\frac{1}{\\kappa_{\\nu}} \\frac{\\partial B_{\\nu}}{\\partial T}(T) d\\nu = \\sum_i \\frac{1}{\\kappa_i} \\int_{\\nu_i^{\\mathrm{low}}}^{\\nu_i^{\\mathrm{high}}} \\frac{\\partial B_{\\nu}}{\\partial T}(T) d\\nu$\n4.  $I_{4} = \\int \\frac{\\partial B_{\\nu}}{\\partial T}(T) d\\nu = \\sum_i \\int_{\\nu_i^{\\mathrm{low}}}^{\\nu_i^{\\mathrm{high}}} \\frac{\\partial B_{\\nu}}{\\partial T}(T) d\\nu$\n\n被积函数 $B_{\\nu}(T)$ 和 $\\frac{\\partial B_{\\nu}}{\\partial T}(T)$ 没有初等原函数，因此这些积分必须进行数值计算。我们将为此目的使用一个标准的数值求积程序，并应用于每个频率群。一旦计算出四个积分和，平均不透明度通过以下方式求得：\n$$\n\\kappa_{\\mathrm{P}}(T) = \\frac{I_1}{I_2} \\quad \\text{and} \\quad \\kappa_{\\mathrm{R}}(T) = \\frac{I_4}{I_3}\n$$\n所需的相对误差 $\\delta F$ 和 $\\delta v$ 随后从比值 $\\kappa_{\\mathrm{R}} / \\kappa_{\\mathrm{P}}$ 计算得出。\n\n当不透明度 $\\kappa_{\\nu}$ 在整个频谱上为常数时（如测试用例 2 中近似成立的情况），会出现一种特殊情况。如果 $\\kappa_{\\nu} = \\kappa_{0}$，那么 $\\kappa_{\\mathrm{P}} = \\frac{\\int \\kappa_0 B_{\\nu} d\\nu}{\\int B_{\\nu} d\\nu} = \\kappa_0$ 且 $\\frac{1}{\\kappa_{\\mathrm{R}}} = \\frac{\\int (1/\\kappa_0) (\\partial B_{\\nu}/\\partial T) d\\nu}{\\int (\\partial B_{\\nu}/\\partial T) d\\nu} = 1/\\kappa_0$，这意味着 $\\kappa_{\\mathrm{R}} = \\kappa_0$。在这种情况下，$\\kappa_{\\mathrm{P}} = \\kappa_{\\mathrm{R}}$，比值为 1，两个相对误差 $\\delta F$ 和 $\\delta v$ 都恰好为 0。这为检查实现的正确性提供了一个有价值的合理性检查。然而，对于频率相关的不透明度，我们预期 $\\kappa_{\\mathrm{P}} > \\kappa_{\\mathrm{R}}$，从而导致非零误差。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Solves the warm dense plasma opacity problem for the given test suite.\n    \"\"\"\n\n    # Physical constants from problem statement and SciPy library\n    h = constants.h  # 6.62607015e-34 J·s\n    k_B = constants.k  # 1.380649e-23 J/K\n    c = constants.c  # 2.99792458e8 m/s\n    sigma = constants.sigma # 5.670374419e-8 W/(m^2 K^4)\n    a = 4 * sigma / c\n\n    # Define test cases\n    # Format: (T, rho, grad_T, t, groups)\n    # groups format: list of (nu_low, nu_high, kappa_i)\n    test_cases = [\n        (1.5e6, 1.0e3, 1.0e6, 1.0e-8, [\n            (1.0e15, 5.0e15, 0.5), (5.0e15, 2.0e16, 1.0),\n            (2.0e16, 5.0e16, 5.0), (5.0e16, 1.0e17, 10.0)\n        ]),\n        (1.0e6, 1.0e3, 1.0e6, 1.0e-8, [\n            (1.0e15, 5.0e15, 2.0), (5.0e15, 2.0e16, 2.0),\n            (2.0e16, 5.0e16, 2.0), (5.0e16, 1.0e17, 2.0)\n        ]),\n        (5.0e5, 3.0e3, 5.0e5, 5.0e-9, [\n            (1.0e15, 3.0e15, 0.1), (3.0e15, 1.0e16, 0.2),\n            (1.0e16, 5.0e16, 2.0), (5.0e16, 2.0e17, 20.0)\n        ]),\n    ]\n\n    def B_nu(nu, T):\n        \"\"\"\n        Planck spectral radiance B_nu(T).\n        nu: frequency in Hz\n        T: temperature in K\n        \"\"\"\n        x = h * nu / (k_B * T)\n        # Avoid overflow for large x, where exp(x) is huge and B_nu -> 0.\n        if x > 700:  # np.exp(709) is near float limit\n            return 0.0\n        \n        factor = 2 * h * nu**3 / c**2\n        return factor / (np.exp(x) - 1)\n\n    def dB_nu_dT(nu, T):\n        \"\"\"\n        Temperature derivative of Planck spectral radiance, d(B_nu)/dT.\n        nu: frequency in Hz\n        T: temperature in K\n        \"\"\"\n        x = h * nu / (k_B * T)\n        # Avoid overflow\n        if x > 700:\n            return 0.0\n\n        exp_x = np.exp(x)\n        factor = (2 * h**2 * nu**4) / (c**2 * k_B * T**2)\n        denominator = (exp_x - 1)**2\n        # Avoid division by zero if exp_x is too big\n        if denominator == 0 or np.isinf(denominator):\n             return 0.0\n        return factor * exp_x / denominator\n\n    def compute_opacities(T, groups):\n        \"\"\"\n        Computes Planck and Rosseland mean opacities for a given T and group structure.\n        Returns (kappa_P, kappa_R).\n        \"\"\"\n        # Numerators and Denominators for kappa_P and kappa_R calculations\n        # kappa_P = integral(kappa*B) / integral(B)\n        # 1/kappa_R = integral(1/kappa * dB/dT) / integral(dB/dT)\n        \n        integral_kappa_B_nu = 0.0\n        integral_B_nu = 0.0\n        integral_inv_kappa_dB_dT = 0.0\n        integral_dB_dT = 0.0\n\n        for group in groups:\n            nu_low, nu_high, kappa_i = group\n            \n            # Integrals for Planck mean\n            res_B_nu, _ = integrate.quad(lambda nu: B_nu(nu, T), nu_low, nu_high)\n            integral_B_nu += res_B_nu\n            integral_kappa_B_nu += kappa_i * res_B_nu\n            \n            # Integrals for Rosseland mean\n            res_dB_dT, _ = integrate.quad(lambda nu: dB_nu_dT(nu, T), nu_low, nu_high)\n            integral_dB_dT += res_dB_dT\n            # The case kappa_i = 0 is not present in test data but handled for robustness\n            if kappa_i > 0:\n                integral_inv_kappa_dB_dT += (1.0 / kappa_i) * res_dB_dT\n\n        # Calculate mean opacities\n        kappa_P = integral_kappa_B_nu / integral_B_nu if integral_B_nu != 0 else 0\n        kappa_R = integral_dB_dT / integral_inv_kappa_dB_dT if integral_inv_kappa_dB_dT != 0 else float('inf')\n\n        return kappa_P, kappa_R\n\n    results = []\n    for case in test_cases:\n        T, rho, grad_T, t, groups = case\n        \n        kappa_P, kappa_R = compute_opacities(T, groups)\n\n        # Handle the case of zero opacity which can lead to division by zero\n        if kappa_P == 0.0:\n             # This physical situation would mean infinite flux/speed,\n             # but we can't form a ratio. This won't happen with the test data.\n             # If kappa_R is also 0, error is 0. Otherwise, error is infinite.\n             err_F = 0.0 if kappa_R == 0 else float('inf')\n             err_v = 0.0 if kappa_R == 0 else float('inf')\n        else:\n            kappa_ratio = kappa_R / kappa_P\n            \n            # Relative error in flux\n            # err_F = | F_P/F_R - 1 | = | (1/kappa_P) / (1/kappa_R) -1 | = | kappa_R/kappa_P - 1 |\n            err_F = abs(kappa_ratio - 1)\n            \n            # Relative error in speed\n            # err_v = | v_P/v_R - 1| = | sqrt(D_P/D_R) - 1 | = | sqrt(kappa_R/kappa_P) - 1|\n            err_v = abs(np.sqrt(kappa_ratio) - 1)\n        \n        results.append(f\"{err_F:.6f}\")\n        results.append(f\"{err_v:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "温稠密物质中的物理过程通常发生在迥异的时间尺度上，这导致了“刚性”方程组，对数值模拟构成了重大挑战。本练习聚焦于电子和离子之间的刚性能量交换，这是双温模型中的一个共同特征。您将推导并实现一个半隐式数值格式——这是一种即使在使用大时间步长时也能确保稳定性的强大技术，并从解析上证明其能量守恒、正定性和稳定性的优良特性。",
            "id": "4063837",
            "problem": "考虑辐射流体力学中的一个双温温稠密物质（WDM）模型，其中电子和离子通过二元碰撞交换能量。令 $E_e(t)$ 和 $E_i(t)$ 分别表示电子和离子的内能，并令 $C_e>0$ 和 $C_i>0$ 为在上一时间步计算的相应恒定体积热容。碰撞能量交换由源项 $Q_{ei}=\\Gamma\\left(T_e-T_i\\right)$ 建模，其中 $\\Gamma\\ge 0$ 是给定的耦合系数，$T_e=E_e/C_e$，$T_i=E_i/C_i$。仅考虑交换步骤的连续子问题为\n$$\n\\frac{dE_e}{dt}=-Q_{ei},\\quad \\frac{dE_i}{dt}=+Q_{ei},\n$$\n该过程严格保持总能量 $E_{\\text{tot}}(t)=E_e(t)+E_i(t)$ 守恒，并使温差 $T_e-T_i$ 趋于零。\n\n你的任务是推导并实现一个从时间步 $n$ 到 $n+1$ 的半隐式时间更新方法，该方法对 $Q_{ei}$ 进行隐式处理，同时将 $C_e$ 和 $C_i$ 冻结在时间步 $n$ 的值。使用时间步长 $\\Delta t\\ge 0$，半隐式更新定义为\n$$\nE_e^{n+1}=E_e^n-\\Delta t\\,\\Gamma\\left(\\frac{E_e^{n+1}}{C_e}-\\frac{E_i^{n+1}}{C_i}\\right),\\quad\nE_i^{n+1}=E_i^n+\\Delta t\\,\\Gamma\\left(\\frac{E_e^{n+1}}{C_e}-\\frac{E_i^{n+1}}{C_i}\\right).\n$$\n从基本交换模型以及温度和热容的定义出发，你必须：\n- 推导出 $E_e^{n+1}$ 和 $E_i^{n+1}$ 关于 $E_e^n$、$E_i^n$、$C_e$、$C_i$、$\\Gamma$ 和 $\\Delta t$ 的封闭形式表达式。\n- 证明对于任意 $\\Delta t\\ge 0$，离散更新都保持 $E_{\\text{tot}}^{n+1}=E_e^{n+1}+E_i^{n+1}=E_e^n+E_i^n$ 守恒。\n- 证明正性保持：如果 $E_e^n\\ge 0$ 且 $E_i^n\\ge 0$，则在 $C_e>0$、$C_i>0$ 和 $\\Gamma\\ge 0$ 的条件下，对于任意 $\\Delta t\\ge 0$，都有 $E_e^{n+1}\\ge 0$ 和 $E_i^{n+1}\\ge 0$。\n- 通过推导温差 $\\Delta T^{n}=T_e^n-T_i^n$ 的放大因子 $g$，证明在温差收缩意义下的无条件稳定性，使得\n$$\n\\Delta T^{n+1}=g\\,\\Delta T^n,\n$$\n并证明在仅由能量守恒和正性所隐含的时间步长约束下（即 $\\Delta t\\ge 0$、$C_e>0$、$C_i>0$ 和 $\\Gamma\\ge 0$），有 $0\\le g\\le 1$。\n\n在一个程序中实现你推导的更新方法，并使用以下测试套件对该格式进行评估。所有物理量必须使用指定的单位处理：能量 $E$ 的单位为焦耳（$\\mathrm{J}$），热容 $C$ 的单位为焦耳每开尔文（$\\mathrm{J}/\\mathrm{K}$），时间步长 $\\Delta t$ 的单位为秒（$\\mathrm{s}$），耦合系数 $\\Gamma$ 的单位为焦耳每秒每开尔文（$\\mathrm{J}/(\\mathrm{s}\\cdot\\mathrm{K})$）。不涉及角度，因此不需要角度单位。\n\n测试套件（每个案例为 $(C_e,C_i,\\Gamma,\\Delta t,E_e^n,E_i^n)$）：\n- 案例 1（正常情况）：$(2.0\\times 10^{-9},\\,3.0\\times 10^{-9},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-9},\\,2.0\\times 10^{-4},\\,1.0\\times 10^{-4})$。\n- 案例 2（刚性耦合，大时间步长）：$(2.0\\times 10^{-9},\\,3.0\\times 10^{-9},\\,1.0\\times 10^{5},\\,1.0\\times 10^{-3},\\,2.0\\times 10^{-4},\\,1.0\\times 10^{-4})$。\n- 案例 3（边界情况 $\\Delta t=0$）：$(2.0\\times 10^{-9},\\,3.0\\times 10^{-9},\\,1.0\\times 10^{3},\\,0.0,\\,2.0\\times 10^{-4},\\,1.0\\times 10^{-4})$。\n- 案例 4（强热容不对称性）：$(2.0\\times 10^{-9},\\,3.0\\times 10^{-6},\\,1.0,\\,1.0\\times 10^{-6},\\,2.0\\times 10^{-4},\\,1.0\\times 10^{-1})$。\n- 案例 5（初始温差为零）：$(5.0\\times 10^{-9},\\,5.0\\times 10^{-9},\\,1.0\\times 10^{2},\\,1.0\\times 10^{-6},\\,2.5\\times 10^{-4},\\,2.5\\times 10^{-4})$。\n\n对每个案例，计算：\n- 一个布尔值，表示在绝对容差 $10^{-12} \\times \\max(1,|E_e^n+E_i^n|)$ 内，总能量是否离散守恒。\n- 一个布尔值，表示 $E_e^{n+1}$ 和 $E_i^{n+1}$ 是否保持正性，容差为 $10^{-18}$（即，由于舍入误差，大于或等于 $-10^{-18}$ 的值是可接受的）。\n- 一个布尔值，通过检查 $0\\le g\\le 1$ 以及数值测量的放大因子 $g_{\\text{num}}=\\Delta T^{n+1}/\\Delta T^{n}$（若 $\\Delta T^n=0$ 则定义 $g_{\\text{num}}=1$）是否与解析推导的 $g$ 在绝对容差 $10^{-12}$ 内一致，来表示无条件稳定性。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[result_1,result_2,\\dots]$），该列表按顺序连接每个案例的三个布尔值（按上述顺序）。",
            "solution": "出发点是碰撞能量交换模型\n$$\n\\frac{dE_e}{dt}=-Q_{ei},\\quad \\frac{dE_i}{dt}=+Q_{ei},\\quad Q_{ei}=\\Gamma\\left(T_e-T_i\\right),\\quad T_e=\\frac{E_e}{C_e},\\quad T_i=\\frac{E_i}{C_i},\n$$\n其中 $C_e>0$，$C_i>0$ 且 $\\Gamma\\ge 0$。该模型是完整的温稠密物质（WDM）辐射流体力学方程组的一个子集，它分离出电子-离子能量耦合子步骤，并假设热容冻结在上一时间步的值，这是一种标准的半隐式做法，可避免在 $C_e$ 和 $C_i$ 依赖于温度时进行非线性求解。\n\n为了以时间步长 $\\Delta t\\ge 0$ 从时间步 $n$推进到 $n+1$，我们对 $Q_{ei}$进行隐式处理，同时将 $C_e$ 和 $C_i$ 冻结在其已知值上。半隐式离散方程为\n$$\nE_e^{n+1}=E_e^n-\\Delta t\\,\\Gamma\\left(\\frac{E_e^{n+1}}{C_e}-\\frac{E_i^{n+1}}{C_i}\\right),\\quad\nE_i^{n+1}=E_i^n+\\Delta t\\,\\Gamma\\left(\\frac{E_e^{n+1}}{C_e}-\\frac{E_i^{n+1}}{C_i}\\right).\n$$\n定义非负参数\n$$\na=\\frac{\\Delta t\\,\\Gamma}{C_e}\\ge 0,\\quad b=\\frac{\\Delta t\\,\\Gamma}{C_i}\\ge 0.\n$$\n重写离散系统，得到关于 $\\left(E_e^{n+1},E_i^{n+1}\\right)$ 的线性 $2\\times 2$ 方程组：\n$$\n(1+a)E_e^{n+1}-b\\,E_i^{n+1}=E_e^n,\\quad -a\\,E_e^{n+1}+(1+b)E_i^{n+1}=E_i^n.\n$$\n其矩阵形式为\n$$\n\\begin{pmatrix}\n1+a  -b\\\\\n-a  1+b\n\\end{pmatrix}\n\\begin{pmatrix}\nE_e^{n+1}\\\\\nE_i^{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nE_e^n\\\\\nE_i^n\n\\end{pmatrix}.\n$$\n系数矩阵的行列式为\n$$\nD=(1+a)(1+b)-ab=1+a+b>0,\n$$\n这保证了对于所有 $\\Delta t\\ge 0$、$C_e>0$、$C_i>0$ 和 $\\Gamma\\ge 0$ 都存在唯一解。逆矩阵为\n$$\n\\frac{1}{D}\n\\begin{pmatrix}\n1+b  b\\\\\na  1+a\n\\end{pmatrix},\n$$\n因此，封闭形式的更新表达式为\n$$\nE_e^{n+1}=\\frac{(1+b)E_e^n+b\\,E_i^n}{1+a+b},\\quad\nE_i^{n+1}=\\frac{a\\,E_e^n+(1+a)E_i^n}{1+a+b}.\n$$\n\n将两个更新方程相加，直接可得离散守恒性：\n$$\nE_e^{n+1}+E_i^{n+1}=\\frac{(1+b)E_e^n+b\\,E_i^n+a\\,E_e^n+(1+a)E_i^n}{1+a+b}\n=\\frac{(1+a+b)\\left(E_e^n+E_i^n\\right)}{1+a+b}=E_e^n+E_i^n.\n$$\n因此，对于任意 $\\Delta t\\ge 0$，该方法都能精确地保持总能量守恒。\n\n通过检查更新表达式中的系数可以得到正性保持。如果 $E_e^n\\ge 0$ 且 $E_i^n\\ge 0$，那么\n$$\nE_e^{n+1}=\\frac{(1+b)E_e^n+b\\,E_i^n}{1+a+b}\\ge 0,\\quad\nE_i^{n+1}=\\frac{a\\,E_e^n+(1+a)E_i^n}{1+a+b}\\ge 0,\n$$\n因为分子中的系数 $(1+b)$、$b$、$a$ 和 $(1+a)$ 均为非负，且分母 $1+a+b$ 为正。除了 $\\Delta t\\ge 0$、$C_e>0$、$C_i>0$ 和 $\\Gamma\\ge 0$之外，不需要其他限制条件。\n\n通过考虑 $\\Delta T^n=T_e^n-T_i^n=E_e^n/C_e-E_i^n/C_i$ 的离散演化，可以揭示温差收缩意义下的无条件稳定性。将两个能量更新方程分别除以它们各自的热容，然后相减：\n$$\n\\frac{E_e^{n+1}}{C_e}-\\frac{E_i^{n+1}}{C_i}\n=\\frac{(1+b)\\frac{E_e^n}{C_e}+b\\,\\frac{E_i^n}{C_e}-a\\,\\frac{E_e^n}{C_i}-(1+a)\\frac{E_i^n}{C_i}}{1+a+b}.\n$$\n使用 $\\Delta T^n=\\frac{E_e^n}{C_e}-\\frac{E_i^n}{C_i}$ 以及 $a$ 和 $b$ 的定义重新组合各项：\n$$\n\\frac{E_e^{n+1}}{C_e}-\\frac{E_i^{n+1}}{C_i}\n=\\frac{\\left(1+b+a\\right)\\left(\\frac{E_e^n}{C_e}-\\frac{E_i^n}{C_i}\\right)}{1+a+b}\\cdot\\frac{1}{1+\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)}.\n$$\n一个更直接、更简洁的推导是使用关于温度的连续模型。从\n$$\n\\frac{dT_e}{dt}=-\\frac{\\Gamma}{C_e}\\left(T_e-T_i\\right),\\quad \\frac{dT_i}{dt}=\\frac{\\Gamma}{C_i}\\left(T_e-T_i\\right),\n$$\n可以得到\n$$\n\\frac{d}{dt}\\left(T_e-T_i\\right)=-\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)\\left(T_e-T_i\\right).\n$$\n由我们的半隐式能量更新所诱导的、对应于 $\\Delta T$ 的后向欧拉步为\n$$\n\\Delta T^{n+1}=\\Delta T^n-\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)\\Delta T^{n+1},\n$$\n解得\n$$\n\\Delta T^{n+1}=\\frac{\\Delta T^n}{1+\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)}.\n$$\n因此，放大因子为\n$$\ng=\\frac{1}{1+\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)}.\n$$\n因为 $\\Delta t\\ge 0$、$\\Gamma\\ge 0$、$C_e>0$ 和 $C_i>0$，所以有 $1+\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)\\ge 1$，因此 $0\\le g\\le 1$。这种收缩性相对于 $Q_{ei}$ 的刚度和 $\\Delta t$ 的大小是无条件的；除了物理上的正性条件外，不需要额外的时间步长限制。特别地，当 $\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)\\to\\infty$ 时，$g\\to 0$，反映了快速的平衡过程；当 $\\Delta t=0$ 时，$g=1$，这与预期相符。\n\n在算法上，对每个测试案例的实现步骤如下：\n- 计算 $a=\\Delta t\\,\\Gamma/C_e$、$b=\\Delta t\\,\\Gamma/C_i$ 和 $D=1+a+b$。\n- 使用 $E_e^{n+1}=\\left((1+b)E_e^n+b\\,E_i^n\\right)/D$ 和 $E_i^{n+1}=\\left(a\\,E_e^n+(1+a)E_i^n\\right)/D$ 更新能量。\n- 验证离散守恒性：检查 $\\left|E_e^{n+1}+E_i^{n+1}-(E_e^n+E_i^n)\\right|\\le 10^{-12}\\max\\left(1,\\left|E_e^n+E_i^n\\right|\\right)$。\n- 验证正性：检查 $E_e^{n+1}\\ge -10^{-18}$ 和 $E_i^{n+1}\\ge -10^{-18}$。\n- 计算解析放大因子 $g=\\left(1+\\Delta t\\,\\Gamma\\left(\\frac{1}{C_e}+\\frac{1}{C_i}\\right)\\right)^{-1}$ 和数值放大因子 $g_{\\text{num}}=\\Delta T^{n+1}/\\Delta T^{n}$，其中当 $\\Delta T^n=0$ 时定义 $g_{\\text{num}}=1$。通过检查 $0\\le g\\le 1$ 和 $\\left|g_{\\text{num}}-g\\right|\\le 10^{-12}$ 来验证无条件稳定性。\n\n程序对每个测试案例输出三个分别对应守恒性、正性和稳定性检查的布尔值，并按要求将它们聚合到一个用方括号括起来的逗号分隔列表中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef semi_implicit_update(Ee, Ei, Ce, Ci, Gamma, dt):\n    \"\"\"\n    Semi-implicit update for electron and ion energies with stiff collisional exchange.\n    Ce, Ci: heat capacities (J/K)\n    Gamma: coupling coefficient (J/(s*K))\n    dt: timestep (s)\n    Returns Ee_next, Ei_next\n    \"\"\"\n    a = dt * Gamma / Ce  # nonnegative if dt>=0, Gamma>=0, Ce>0\n    b = dt * Gamma / Ci  # nonnegative if dt>=0, Gamma>=0, Ci>0\n    D = 1.0 + a + b      # strictly positive\n    Ee_next = ((1.0 + b) * Ee + b * Ei) / D\n    Ei_next = (a * Ee + (1.0 + a) * Ei) / D\n    return Ee_next, Ei_next\n\ndef amplification_factors(Ee, Ei, Ce, Ci, Ee_next, Ei_next, Gamma, dt):\n    \"\"\"\n    Compute analytical and numerical amplification factors for Delta T.\n    \"\"\"\n    # Temperatures\n    Te = Ee / Ce\n    Ti = Ei / Ci\n    Te_next = Ee_next / Ce\n    Ti_next = Ei_next / Ci\n    dT_n = Te - Ti\n    dT_np1 = Te_next - Ti_next\n\n    # Analytical amplification factor\n    g_analytical = 1.0 / (1.0 + dt * Gamma * (1.0 / Ce + 1.0 / Ci))\n\n    # Numerical amplification factor; define as 1 when initial difference is zero\n    if np.isclose(dT_n, 0.0, atol=1e-30, rtol=0.0):\n        g_numeric = 1.0 if np.isclose(dT_np1, 0.0, atol=1e-30, rtol=0.0) else np.nan\n    else:\n        g_numeric = dT_np1 / dT_n\n\n    return g_analytical, g_numeric\n\ndef check_case(case):\n    Ce, Ci, Gamma, dt, Ee_n, Ei_n = case\n    Ee_np1, Ei_np1 = semi_implicit_update(Ee_n, Ei_n, Ce, Ci, Gamma, dt)\n\n    # Conservation check\n    Etot_n = Ee_n + Ei_n\n    Etot_np1 = Ee_np1 + Ei_np1\n    tol_cons = 1e-12 * max(1.0, abs(Etot_n))\n    conserved = abs(Etot_np1 - Etot_n) = tol_cons\n\n    # Positivity check (allow tiny negativity due to roundoff)\n    tol_pos = 1e-18\n    positive = (Ee_np1 >= -tol_pos) and (Ei_np1 >= -tol_pos)\n\n    # Stability check: 0 = g = 1 and numeric amplification agrees with analytical\n    g_analytical, g_numeric = amplification_factors(Ee_n, Ei_n, Ce, Ci, Ee_np1, Ei_np1, Gamma, dt)\n    g_bounds_ok = (g_analytical >= -1e-18) and (g_analytical = 1.0 + 1e-18)\n    # Agreement check; if numeric is nan due to zero division with nonzero next, mark as False\n    if np.isnan(g_numeric):\n        g_agree = False\n    else:\n        g_agree = abs(g_numeric - g_analytical) = 1e-12\n    stable = g_bounds_ok and g_agree\n\n    return conserved, positive, stable\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path)\n        (2.0e-9, 3.0e-9, 1.0e-3, 1.0e-9, 2.0e-4, 1.0e-4),\n        # Case 2 (stiff coupling, large timestep)\n        (2.0e-9, 3.0e-9, 1.0e5, 1.0e-3, 2.0e-4, 1.0e-4),\n        # Case 3 (boundary dt=0)\n        (2.0e-9, 3.0e-9, 1.0e3, 0.0, 2.0e-4, 1.0e-4),\n        # Case 4 (strong heat capacity asymmetry)\n        (2.0e-9, 3.0e-6, 1.0, 1.0e-6, 2.0e-4, 1.0e-1),\n        # Case 5 (zero initial temperature difference)\n        (5.0e-9, 5.0e-9, 1.0e2, 1.0e-6, 2.5e-4, 2.5e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        conserved, positive, stable = check_case(case)\n        results.extend([conserved, positive, stable])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}