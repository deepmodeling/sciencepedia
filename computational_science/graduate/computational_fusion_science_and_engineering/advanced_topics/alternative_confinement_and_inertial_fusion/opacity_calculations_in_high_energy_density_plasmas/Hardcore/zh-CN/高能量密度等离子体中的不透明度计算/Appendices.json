{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基本练习开始，它将微观原子物理与宏观不透明度直接联系起来。本练习旨在通过计算单个谱线的质量吸收系数，来巩固对决定不透明度大小和谱线形状的关键因素（如振子强度、线型函数和粒子数密度）的理解。这是一个基础技能，它揭示了如何从原子参数出发，推导出等离子体的辐射特性。",
            "id": "4025041",
            "problem": "在聚变相关环境中的高能量密度等离子体含有一种痕量的铁离子，这些铁离子产生一条束缚-束缚 (bb) 吸收线。考虑一个振子强度为 $f_{lu}$、低能级布居数为 $n_l$、线心频率为 $\\nu_0$ 的单次跃迁。质量吸收系数 $\\kappa_{\\nu}$ 定义为 $\\kappa_{\\nu}=\\alpha_{\\nu}/\\rho$，其中 $\\alpha_{\\nu}$ 是体吸收系数，$\\rho$ 是质量密度。每个吸收粒子的吸收截面 $\\sigma(\\nu)$ 通过一个经过充分检验的结果与振子强度相关联，即频率积分截面遵循 $\\int \\sigma(\\nu)\\,d\\nu = \\left(\\pi e^2\\right)\\!/\\!\\left(m_e c\\right)\\,f_{lu}$，并且线型函数 $\\phi(\\nu)$ 被定义为归一化的，即 $\\int \\phi(\\nu)\\,d\\nu = 1$。在多普勒展宽占主导地位的等离子体中，设线型为高斯分布，\n$$\n\\phi(\\nu)=\\frac{1}{\\Delta \\nu_D \\sqrt{\\pi}} \\exp\\!\\left[-\\left(\\frac{\\nu-\\nu_0}{\\Delta \\nu_D}\\right)^{2}\\right],\n$$\n其热多普勒宽度为\n$$\n\\Delta \\nu_D=\\nu_0 \\sqrt{\\frac{2 k_B T_i}{M c^{2}}},\n$$\n其中 $T_i$ 是离子温度，$M$ 是离子质量。\n\n从这些基本定义和事实出发，推导束缚-束缚质量吸收系数 $\\kappa_{\\nu}^{bb}$ 关于 $f_{lu}$、$n_l$、$\\rho$ 和 $\\phi(\\nu)$ 的表达式，并用它计算在线心处的数值 $\\kappa_{\\nu_0}^{bb}$，使用以下物理上一致的参数：\n- 振子强度 $f_{lu}=0.30$，\n- 低能级布居数 $n_l=1.0\\times 10^{18}\\,\\text{cm}^{-3}$，\n- 质量密度 $\\rho=0.10\\,\\text{g}\\,\\text{cm}^{-3}$，\n- 线心频率 $\\nu_0=3.0\\times 10^{16}\\,\\text{s}^{-1}$，\n- 离子温度 $T_i=500\\,\\text{eV}$，\n- 离子质量 $M=56\\,m_u$。\n\n采用厘米-克-秒单位制，并使用以下常数：\n- 基本电荷 $e=4.803204712\\times 10^{-10}\\,\\text{esu}$，\n- 电子质量 $m_e=9.1093837015\\times 10^{-28}\\,\\text{g}$，\n- 光速 $c=2.99792458\\times 10^{10}\\,\\text{cm}\\,\\text{s}^{-1}$，\n- 玻尔兹曼常数 $k_B=1.380649\\times 10^{-16}\\,\\text{erg}\\,\\text{K}^{-1}$，\n- 原子质量单位 $m_u=1.66053906660\\times 10^{-24}\\,\\text{g}$，\n- 能量转换 $1\\,\\text{eV}=1.602176634\\times 10^{-12}\\,\\text{erg}$。\n\n你可以通过将以电子伏特为单位给出的 $T_i$ 转换，把 $k_B T_i$ 当作以尔格为单位的热能来处理。明确验证高斯分布的归一化条件 $\\int \\phi(\\nu)\\,d\\nu=1$。将线心处的最终不透明度 $\\kappa_{\\nu_0}^{bb}$ 以 $\\text{cm}^{2}\\,\\text{g}^{-1}$ 为单位表示，并将你的答案四舍五入到三位有效数字。",
            "solution": "该问题经评估有效，因为它科学上基于原子物理和等离子体光谱学的原理，问题设定良好，具有完整且一致的数据和定义，并以客观、正式的语言表述。所提供的参数对于高能量密度等离子体环境是物理上一致的。因此，我们可以着手求解。\n\n根据要求，解答分为三部分构建：验证线型归一化，推导质量吸收系数，以及计算其在线心处的值。\n\n首先，我们验证给定高斯线型函数 $\\phi(\\nu)$ 的归一化。归一化条件是 $\\int_{-\\infty}^{\\infty} \\phi(\\nu)\\,d\\nu = 1$。\n积分为：\n$$\n\\int_{-\\infty}^{\\infty} \\phi(\\nu)\\,d\\nu = \\int_{-\\infty}^{\\infty} \\frac{1}{\\Delta \\nu_D \\sqrt{\\pi}} \\exp\\!\\left[-\\left(\\frac{\\nu-\\nu_0}{\\Delta \\nu_D}\\right)^{2}\\right] d\\nu\n$$\n我们进行变量替换。令 $x = (\\nu-\\nu_0) / \\Delta \\nu_D$。那么 $d\\nu = \\Delta \\nu_D dx$。积分上下限仍为 $-\\infty$到 $\\infty$。将这些代入积分得到：\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{\\Delta \\nu_D \\sqrt{\\pi}} \\exp(-x^2) (\\Delta \\nu_D dx) = \\frac{1}{\\sqrt{\\pi}} \\int_{-\\infty}^{\\infty} \\exp(-x^2) dx\n$$\n这是标准的高斯积分，其值为 $\\int_{-\\infty}^{\\infty} \\exp(-x^2) dx = \\sqrt{\\pi}$。\n因此，结果是：\n$$\n\\frac{1}{\\sqrt{\\pi}} \\cdot \\sqrt{\\pi} = 1\n$$\n线型函数的归一化得到验证。\n\n接下来，我们推导束缚-束缚质量吸收系数 $\\kappa_{\\nu}^{bb}$ 的表达式。体吸收系数 $\\alpha_{\\nu}$ 定义为吸收体数密度 $n_l$ 与每个吸收体的吸收截面 $\\sigma(\\nu)$ 的乘积：\n$$\n\\alpha_{\\nu} = n_l \\sigma(\\nu)\n$$\n吸收截面本身可以表示为其频率积分值与归一化线型函数 $\\phi(\\nu)$ 的乘积：\n$$\n\\sigma(\\nu) = \\left( \\int_0^\\infty \\sigma(\\nu')\\,d\\nu' \\right) \\phi(\\nu)\n$$\n我们已知积分截面用振子强度 $f_{lu}$ 表示为：\n$$\n\\int_0^\\infty \\sigma(\\nu)\\,d\\nu = \\frac{\\pi e^2}{m_e c} f_{lu}\n$$\n将此代入 $\\sigma(\\nu)$ 的表达式，得到：\n$$\n\\sigma(\\nu) = \\frac{\\pi e^2}{m_e c} f_{lu} \\phi(\\nu)\n$$\n现在，我们可以将体吸收系数写为：\n$$\n\\alpha_{\\nu} = n_l \\left( \\frac{\\pi e^2}{m_e c} f_{lu} \\phi(\\nu) \\right)\n$$\n质量吸收系数 $\\kappa_{\\nu}^{bb}$ 定义为 $\\kappa_{\\nu}^{bb} = \\alpha_{\\nu} / \\rho$，其中 $\\rho$ 是质量密度。因此，束缚-束缚质量吸收系数的一般表达式为：\n$$\n\\kappa_{\\nu}^{bb} = \\frac{n_l}{\\rho} \\frac{\\pi e^2}{m_e c} f_{lu} \\phi(\\nu)\n$$\n最后，我们使用提供的参数计算线心处的不透明度值 $\\kappa_{\\nu_0}^{bb}$。在线心处，$\\nu = \\nu_0$，高斯线型函数简化为：\n$$\n\\phi(\\nu_0) = \\frac{1}{\\Delta \\nu_D \\sqrt{\\pi}} \\exp\\!\\left[-\\left(\\frac{\\nu_0-\\nu_0}{\\Delta \\nu_D}\\right)^{2}\\right] = \\frac{1}{\\Delta \\nu_D \\sqrt{\\pi}}\n$$\n我们必须首先计算热多普勒宽度 $\\Delta \\nu_D$：\n$$\n\\Delta \\nu_D = \\nu_0 \\sqrt{\\frac{2 k_B T_i}{M c^{2}}}\n$$\n参数以cgs单位制给出，离子温度 $T_i$ 以eV为单位。我们按照规定将 $T_i$ 转换为以尔格为单位的能量。此值用于项 $k_B T_i$。\n给定 $T_i = 500\\,\\text{eV}$ 和 $1\\,\\text{eV} = 1.602176634 \\times 10^{-12}\\,\\text{erg}$：\n$$\nk_B T_i = 500 \\times (1.602176634 \\times 10^{-12}) = 8.01088317 \\times 10^{-10}\\,\\text{erg}\n$$\n质量数为56的离子的质量 $M$ 是 $M = 56\\,m_u$：\n$$\nM = 56 \\times (1.66053906660 \\times 10^{-24}\\,\\text{g}) = 9.29901877 \\times 10^{-23}\\,\\text{g}\n$$\n平方根内的项是：\n$$\n\\frac{2 k_B T_i}{M c^{2}} = \\frac{2 \\times (8.01088317 \\times 10^{-10}\\,\\text{erg})}{(9.29901877 \\times 10^{-23}\\,\\text{g}) \\times (2.99792458 \\times 10^{10}\\,\\text{cm}\\,\\text{s}^{-1})^{2}} \\approx 1.91689 \\times 10^{-8}\n$$\n多普勒宽度是：\n$$\n\\Delta \\nu_D = (3.0 \\times 10^{16}\\,\\text{s}^{-1}) \\sqrt{1.91689 \\times 10^{-8}} \\approx 4.15356 \\times 10^{12}\\,\\text{s}^{-1}\n$$\n线心处的线型值是：\n$$\n\\phi(\\nu_0) = \\frac{1}{\\Delta \\nu_D \\sqrt{\\pi}} = \\frac{1}{(4.15356 \\times 10^{12}\\,\\text{s}^{-1}) \\sqrt{\\pi}} \\approx 1.35854 \\times 10^{-13}\\,\\text{s}\n$$\n现在我们组合所有部分来计算 $\\kappa_{\\nu_0}^{bb}$。经典电子半径相关的常数项是：\n$$\n\\frac{\\pi e^2}{m_e c} = \\frac{\\pi (4.803204712 \\times 10^{-10}\\,\\text{esu})^2}{(9.1093837015 \\times 10^{-28}\\,\\text{g})(2.99792458 \\times 10^{10}\\,\\text{cm}\\,\\text{s}^{-1})} \\approx 0.026535\\,\\text{cm}^2\\,\\text{s}^{-1}\n$$\n线心不透明度的表达式为：\n$$\n\\kappa_{\\nu_0}^{bb} = \\frac{n_l}{\\rho} \\frac{\\pi e^2}{m_e c} f_{lu} \\phi(\\nu_0)\n$$\n代入数值：\n$$\n\\kappa_{\\nu_0}^{bb} = \\left(\\frac{1.0 \\times 10^{18}\\,\\text{cm}^{-3}}{0.10\\,\\text{g}\\,\\text{cm}^{-3}}\\right) \\times (0.026535\\,\\text{cm}^2\\,\\text{s}^{-1}) \\times (0.30) \\times (1.35854 \\times 10^{-13}\\,\\text{s})\n$$\n$$\n\\kappa_{\\nu_0}^{bb} = (1.0 \\times 10^{19}\\,\\text{g}^{-1}) \\times (0.0079606\\,\\text{cm}^2\\,\\text{s}^{-1}) \\times (1.35854 \\times 10^{-13}\\,\\text{s})\n$$\n$$\n\\kappa_{\\nu_0}^{bb} \\approx 1.08157 \\times 10^4\\,\\text{cm}^2\\,\\text{g}^{-1}\n$$\n四舍五入到三位有效数字，结果是 $1.08 \\times 10^4\\,\\text{cm}^2\\,\\text{g}^{-1}$。",
            "answer": "$$\\boxed{1.08 \\times 10^4}$$"
        },
        {
            "introduction": "在实际应用中，详细的逐线不透明度数据由于其巨大的计算成本而难以直接在流体力学模拟中使用，因此必须采用频率平均的分组方法。本练习探讨了这一关键实用技术的理论基础，即不透明度分组。它旨在检验我们对不同不透明度平均方案（特别是用于辐射输运的罗斯兰平均和用于源项的普朗克平均）的理解，以及它们在合并频率组时如何保持总辐射通量和能量交换等物理量的守恒性。",
            "id": "4025003",
            "problem": "一个处于局域热动平衡 (LTE) 状态的高能量密度 (HED) 等离子体，采用多群辐射扩散闭合模型进行建模。在光学厚极限下，扩散近似给出的单色通量形式为 $F_{\\nu} \\approx -\\dfrac{c}{3 \\rho \\kappa_{\\nu}} \\nabla u_{\\nu}$，其中 $c$ 是光速，$\\rho$ 是质量密度，$\\kappa_{\\nu}$ 是单色吸收不透明度，而 $u_{\\nu}$ 是单色辐射能量密度。在频率区间 $\\Delta \\nu_{g}$ 上的群积分辐射能量密度为 $E_{g} = \\int_{\\Delta \\nu_{g}} u_{\\nu} \\, d\\nu$，而群扩散通量则通过 $F_{g} \\approx - D_{g} \\nabla E_{g}$ 进行闭合，其中 $D_{g}$ 是一个由合适的群平均不透明度构造的标量扩散系数。\n\n在光学厚扩散区中，一种广泛使用的构造是 Rosseland 平均不透明度，其对于群 $g$ 的定义为\n$$\n\\frac{1}{\\kappa_{R,g}} = \\frac{\\int_{\\Delta \\nu_{g}} \\frac{1}{\\kappa_{\\nu}} \\, \\frac{\\partial B_{\\nu}(T)}{\\partial T} \\, d\\nu}{\\int_{\\Delta \\nu_{g}} \\frac{\\partial B_{\\nu}(T)}{\\partial T} \\, d\\nu} ,\n$$\n其中 $B_{\\nu}(T)$ 是温度 $T$ 下的普朗克函数。在 LTE 条件下，$u_{\\nu} = \\dfrac{4 \\pi}{c} B_{\\nu}(T)$，对于小的温度梯度，可以进行线性化处理：$\\nabla u_{\\nu} \\approx \\dfrac{\\partial u_{\\nu}}{\\partial T} \\nabla T$。在计算辐射流体力学中，常见的积分源项包括形式为 $S_{W} = c \\rho \\int \\kappa_{\\nu} W_{\\nu} \\, d\\nu$ 的表达式，其中 $W_{\\nu}$ 是一个给定的非负权重，它定义了适用于该源的平均方式（例如，对于发射，$W_{\\nu} = B_{\\nu}(T)$；对于吸收，$W_{\\nu} = E_{\\nu}$，其中 $E_{\\nu}$ 是谱辐射能量密度）。\n\n在许多大规模模拟中，期望通过合并相邻群组（不透明度重新分组）来减少频率群的数量，即用两个区间 $\\Delta \\nu_{g_{1}}$ 和 $\\Delta \\nu_{g_{2}}$ 的并集 $\\Delta \\nu_{G} = \\Delta \\nu_{g_{1}} \\cup \\Delta \\nu_{g_{2}}$ 来替换它们，同时重新定义 $E_{G} = E_{g_{1}} + E_{g_{2}}$ 以及输运项和源项中使用的相应平均不透明度。\n\n关于不透明度重新分组（合并相邻群组）以及重新分组能使扩散通量和积分源项保持不变所需满足的标准，以下哪项陈述是正确的？\n\nA. 在局域热动平衡（LTE）下的光学厚扩散极限中，如果输运使用 Rosseland 平均（权重为 $\\dfrac{\\partial B_{\\nu}}{\\partial T}$），并且每个积分源项使用与其自身线性权重一致定义的群平均不透明度（例如，发射使用普朗克平均，权重为 $W_{\\nu} = B_{\\nu}(T)$；吸收使用能量加权平均，权重为 $W_{\\nu} = E_{\\nu}$），那么合并相邻群组可以精确地保持总扩散辐射通量以及任何形式为 $S_{W} = c \\rho \\int \\kappa_{\\nu} W_{\\nu} \\, d\\nu$ 的源项不变，因为底层的加权积分在相邻频率区间的并集上是可加的。\n\nB. 只有当单色不透明度在合并的频带上与频率无关（灰体）时，重新分组才能保持扩散通量不变；否则，Rosseland 平均值会改变，通量无法保持不变。\n\nC. 对于任何具有固定非负权重 $W_{\\nu}$ 的线性频率积分源项 $S_{W} = c \\rho \\int \\kappa_{\\nu} W_{\\nu} \\, d\\nu$，通过\n$$\n\\kappa_{W,g} = \\frac{\\int_{\\Delta \\nu_{g}} \\kappa_{\\nu} W_{\\nu} \\, d\\nu}{\\int_{\\Delta \\nu_{g}} W_{\\nu} \\, d\\nu}\n$$\n定义群平均不透明度，可以保证合并相邻群组后，离散化源项 $S_{W} \\approx c \\rho \\sum_{g} \\kappa_{W,g} \\int_{\\Delta \\nu_{g}} W_{\\nu} \\, d\\nu$ 保持不变，因为频率积分是精确可加的。\n\nD. 即使在光学薄、以自由流为主的区域，当使用 Rosseland 平均时，重新分组也能保持扩散通量不变，因为平均不透明度的定义与输运区无关。\n\nE. 在群扩散闭合模型 $F_{g} = - D_{g} \\nabla E_{g}$下，将两个相邻群组合并为一个，当且仅当梯度 $\\nabla E_{g_{1}}$ 和 $\\nabla E_{g_{2}}$ 在该点共线时，才能逐点匹配精确的总通量；在这种情况下，可以定义一个合并后的标量扩散系数\n$$\nD_{G} = \\frac{D_{g_{1}} \\, \\lVert \\nabla E_{g_{1}} \\rVert + D_{g_{2}} \\, \\lVert \\nabla E_{g_{2}} \\rVert}{\\lVert \\nabla E_{g_{1}} + \\nabla E_{g_{2}} \\rVert}\n$$\n以满足 $F_{G} = - D_{G} \\nabla (E_{g_{1}} + E_{g_{2}}) = F_{g_{1}} + F_{g_{2}}$。如果梯度不共线，则不存在任何标量 $D_{G}$ 能够精确地再现 $F_{g_{1}} + F_{g_{2}}$，除非引入各向异性扩散张量。",
            "solution": "问题陈述已经过严格验证，被认为是具有科学依据、适定且客观的。它提出了计算辐射流体力学中一个关于多群辐射输运和不透明度平均方法的标准情景。所有给定条件都是该领域的标准定义和关系。该问题是有效的。\n\n问题的核心在于理解当通过合并相邻频率群来改变底层群结构时，不同类型的频率平均如何表现。我们必须分析两种主要类型的量：积分源项，通常涉及类算术加权平均；以及扩散通量，其涉及 Rosseland 平均不透明度的类调和权重。\n\n让我们考虑两个相邻的频率群 $g_1$ 和 $g_2$，其对应的频率区间为 $\\Delta \\nu_{g_{1}}$ 和 $\\Delta \\nu_{g_{2}}$。当我们合并它们时，我们创建了一个新的群 $G$，其区间为 $\\Delta \\nu_{G} = \\Delta \\nu_{g_{1}} \\cup \\Delta \\nu_{g_{2}}$。\n\n### 积分源项分析\n\n让我们首先分析一个形式为 $S_{W} = c \\rho \\int \\kappa_{\\nu} W_{\\nu} \\, d\\nu$ 的通用积分源项。在多群方案中，这通过对每个群的贡献求和来进行离散化：\n$$\nS_{W} = \\sum_{g} S_{W,g}\n$$\n其中 $S_{W,g} = c \\rho \\int_{\\Delta \\nu_{g}} \\kappa_{\\nu} W_{\\nu} \\, d\\nu$。这是积分在不相交区域上可加性的直接结果。\n\n如果将源项的群平均不透明度定义为：\n$$\n\\kappa_{W,g} = \\frac{\\int_{\\Delta \\nu_{g}} \\kappa_{\\nu} W_{\\nu} \\, d\\nu}{\\int_{\\Delta \\nu_{g}} W_{\\nu} \\, d\\nu}\n$$\n那么群源项可以写成 $S_{W,g} = c \\rho \\, \\kappa_{W,g} \\int_{\\Delta \\nu_{g}} W_{\\nu} \\, d\\nu$。\n总源项为 $S_{W} = \\sum_{g} c \\rho \\, \\kappa_{W,g} \\int_{\\Delta \\nu_{g}} W_{\\nu} \\, d\\nu$。\n\n当我们将群 $g_1$ 和 $g_2$ 合并为 $G$ 时，这两个群的源项贡献就是它们的和：$S_{W,g_1} + S_{W,g_2}$。\n根据定义，新的合并群的源项是 $S_{W,G} = c \\rho \\int_{\\Delta \\nu_{G}} \\kappa_{\\nu} W_{\\nu} \\, d\\nu$。由于 $\\Delta \\nu_{G} = \\Delta \\nu_{g_{1}} \\cup \\Delta \\nu_{g_{2}}$ 且区间是相邻的（除了可能的端点外不相交），积分是可加的：\n$$\nS_{W,G} = c \\rho \\left( \\int_{\\Delta \\nu_{g_{1}}} \\kappa_{\\nu} W_{\\nu} \\, d\\nu + \\int_{\\Delta \\nu_{g_{2}}} \\kappa_{\\nu} W_{\\nu} \\, d\\nu \\right) = S_{W,g_1} + S_{W,g_2}\n$$\n因此，总源项 $S_{W} = \\sum_g S_{W,g}$ 保持不变，无论频率域如何划分为群。这个过程是完全守恒的。\n\n### 扩散通量分析\n\n在光学厚 LTE 极限下，单色通量为 $F_{\\nu} \\approx -\\dfrac{c}{3 \\rho \\kappa_{\\nu}} \\nabla u_{\\nu}$。使用线性化 $\\nabla u_{\\nu} \\approx \\dfrac{\\partial u_{\\nu}}{\\partial T} \\nabla T$ 和 LTE 关系 $u_{\\nu} = \\dfrac{4 \\pi}{c} B_{\\nu}(T)$，我们得到：\n$$\nF_{\\nu} \\approx -\\dfrac{c}{3 \\rho \\kappa_{\\nu}} \\frac{4 \\pi}{c} \\frac{\\partial B_{\\nu}(T)}{\\partial T} \\nabla T = -\\frac{4\\pi}{3\\rho} \\frac{1}{\\kappa_{\\nu}} \\frac{\\partial B_{\\nu}(T)}{\\partial T} \\nabla T\n$$\n群通量是该量在群频率区间上的积分：\n$$\nF_{g} = \\int_{\\Delta \\nu_{g}} F_{\\nu} \\, d\\nu \\approx -\\left(\\frac{4\\pi}{3\\rho} \\int_{\\Delta \\nu_{g}} \\frac{1}{\\kappa_{\\nu}} \\frac{\\partial B_{\\nu}(T)}{\\partial T} d\\nu\\right) \\nabla T\n$$\n多群扩散闭合模型假设 $F_{g} \\approx - D_{g} \\nabla E_{g}$。群能量密度梯度为 $\\nabla E_{g} = \\nabla \\int_{\\Delta \\nu_{g}} u_{\\nu} d\\nu \\approx \\left(\\int_{\\Delta \\nu_g} \\frac{\\partial u_{\\nu}}{\\partial T} d\\nu\\right) \\nabla T = \\left(\\frac{4\\pi}{c}\\int_{\\Delta \\nu_g} \\frac{\\partial B_{\\nu}(T)}{\\partial T} d\\nu\\right) \\nabla T$。\n扩散系数定义为 $D_{g} = \\frac{c}{3 \\rho \\kappa_{R,g}}$，其中 $\\kappa_{R,g}$ 是 Rosseland 平均不透明度。将这些代入闭合关系式并与积分通量相等，便得到 Rosseland 平均的定义：\n$$\n\\frac{1}{\\kappa_{R,g}} = \\frac{\\int_{\\Delta \\nu_{g}} \\frac{1}{\\kappa_{\\nu}} \\, \\frac{\\partial B_{\\nu}(T)}{\\partial T} \\, d\\nu}{\\int_{\\Delta \\nu_{g}} \\frac{\\partial B_{\\nu}(T)}{\\partial T} \\, d\\nu}\n$$\n根据这个定义，在所述近似条件下，离散模型中的群通量精确等于积分得到的物理通量：$F_g = \\int_{\\Delta \\nu_g} F_\\nu d\\nu$。\n总通量为 $F_{tot} = \\sum_g F_g$。当将群 $g_1$ 和 $g_2$ 合并为 $G$ 时，新的总通量是用一项 $F_G$ 来计算，而不是 $F_{g_1}+F_{g_2}$。由于 $F_g$ 是在 $\\Delta \\nu_g$ 上的积分，而积分是可加的，所以 $F_G = \\int_{\\Delta\\nu_G} F_\\nu d\\nu = \\int_{\\Delta\\nu_{g_1}} F_\\nu d\\nu + \\int_{\\Delta\\nu_{g_2}} F_\\nu d\\nu = F_{g_1} + F_{g_2}$。\n因此，在这个特定极限下，总通量 $F_{tot}$ 在重新分组后也完全守恒。\n\n更一般地，在严格的 LTE 极限之外，不同群的 $\\nabla E_g$ 可能不共线，此时闭合模型 $F_{g} = - D_{g} \\nabla E_{g}$ 对重新分组提出了挑战。为了保持通量贡献不变，我们需要新的群通量 $F_G$ 等于旧通量之和，$F_{g_1} + F_{g_2}$。使用闭合形式，这需要找到一个标量 $D_G$ 使得：\n$$\n- D_G \\nabla E_G = (-D_{g_1} \\nabla E_{g_1}) + (-D_{g_2} \\nabla E_{g_2})\n$$\n由于 $E_G = E_{g_1} + E_{g_2}$，这变成了一个矢量方程：\n$$\nD_G (\\nabla E_{g_1} + \\nabla E_{g_2}) = D_{g_1} \\nabla E_{g_1} + D_{g_2} \\nabla E_{g_2}\n$$\n要使一个标量 $D_G$ 存在，左边的矢量 $\\nabla E_{g_1} + \\nabla E_{g_2}$ 必须与右边的矢量 $D_{g_1} \\nabla E_{g_1} + D_{g_2} \\nabla E_{g_2}$ 平行。这通常仅在初始梯度矢量 $\\nabla E_{g_1}$ 和 $\\nabla E_{g_2}$ 本身共线时才成立。如果它们不共线，所产生的扩散过程是各向异性的，意味着通量不平行于总能量密度梯度，这需要一个张量扩散系数来建模。\n\n在确立了这些原则之后，我们可以评估每个选项。\n\n### 逐项分析\n\n**A. 在局域热动平衡（LTE）下的光学厚扩散极限中，如果输运使用 Rosseland 平均（权重为 $\\dfrac{\\partial B_{\\nu}}{\\partial T}$），并且每个积分源项使用与其自身线性权重一致定义的群平均不透明度（例如，发射使用普朗克平均，权重为 $W_{\\nu} = B_{\\nu}(T)$；吸收使用能量加权平均，权重为 $W_{\\nu} = E_{\\nu}$），那么合并相邻群组可以精确地保持总扩散辐射通量以及任何形式为 $S_{W} = c \\rho \\int \\kappa_{\\nu} W_{\\nu} \\, d\\nu$ 的源项不变，因为底层的加权积分在相邻频率区间的并集上是可加的。**\n\n该陈述是正确的。如上所述，总源项和总通量都表示为在群频率区间上的积分之和。总和等效于在整个频率域上的单个积分。这个总值与域的划分方式无关。积分的可加性确保了对求和中的项进行重新分组不会改变总值。指定的条件（LTE、光学厚、Rosseland 平均）正是标量扩散模型下通量守恒成立的条件。\n\n**结论：正确。**\n\n**B. 只有当单色不透明度在合并的频带上与频率无关（灰体）时，重新分组才能保持扩散通量不变；否则，Rosseland 平均值会改变，通量无法保持不变。**\n\n该陈述是错误的。Rosseland 平均正是为了处理与频率相关的不透明度 $\\kappa_{\\nu}$ 而设计的。它计算一个加权调和平均值，该平均值能正确地再现光谱积分通量。如果不透明度是灰体的（$\\kappa_{\\nu} = \\text{constant}$），Rosseland 平均值将就是那个常数，但它的用途在于其对非灰体情况的适用性。虽然如果 $\\kappa_\\nu$ 变化，合并后群组的 Rosseland 平均值会与其组成群组的值不同，但这种变化恰恰是保持总通量守恒所必需的。\n\n**结论：错误。**\n\n**C. 对于任何具有固定非负权重 $W_{\\nu}$ 的线性频率积分源项 $S_{W} = c \\rho \\int \\kappa_{\\nu} W_{\\nu} \\, d\\nu$，通过\n$$\n\\kappa_{W,g} = \\frac{\\int_{\\Delta \\nu_{g}} \\kappa_{\\nu} W_{\\nu} \\, d\\nu}{\\int_{\\Delta \\nu_{g}} W_{\\nu} \\, d\\nu}\n$$\n定义群平均不透明度，可以保证合并相邻群组后，离散化源项 $S_{W} \\approx c \\rho \\sum_{g} \\kappa_{W,g} \\int_{\\Delta \\nu_{g}} W_{\\nu} \\, d\\nu$ 保持不变，因为频率积分是精确可加的。**\n\n该陈述是正确的。如初始分析所示，将 $\\kappa_{W,g}$ 的定义代入总源项的表达式中可得：\n$$\nS_{W} = \\sum_{g} c \\rho \\left( \\frac{\\int_{\\Delta \\nu_{g}} \\kappa_{\\nu} W_{\\nu} \\, d\\nu}{\\int_{\\Delta \\nu_{g}} W_{\\nu} \\, d\\nu} \\right) \\left( \\int_{\\Delta \\nu_{g}} W_{\\nu} \\, d\\nu \\right) = \\sum_{g} c \\rho \\int_{\\Delta \\nu_{g}} \\kappa_{\\nu} W_{\\nu} \\, d\\nu = c \\rho \\int_{0}^{\\infty} \\kappa_{\\nu} W_{\\nu} \\, d\\nu\n$$\n总源项的表达式是一个与群结构无关的恒等式。因此，合并群组（即合并求和中的项）不会改变总值。选项中使用的 `$\\approx$` 符号略有不精确，因为等式是精确成立的，但总值不变的结论是正确的。\n\n**结论：正确。**\n\n**D. 即使在光学薄、以自由流为主的区域，当使用 Rosseland 平均时，重新分组也能保持扩散通量不变，因为平均不透明度的定义与输运区无关。**\n\n该陈述是根本错误的。整个扩散近似，包括类似菲克定律的闭合关系 $F_{\\nu} \\propto \\nabla u_{\\nu}$（Rosseland 平均由此导出），在光学薄、以自由流为主的区域是无效的。在此类区域，辐射不是扩散而是自由流动，输运由完整的玻尔兹曼输运方程而非扩散方程控制。应用 Rosseland 平均（其物理合理性与光学厚极限相关联）是一个严重的建模错误。其数学定义可能与区域无关，但其物理有效性并非如此。\n\n**结论：错误。**\n\n**E. 在群扩散闭合模型 $F_{g} = - D_{g} \\nabla E_{g}$下，将两个相邻群组合并为一个，当且仅当梯度 $\\nabla E_{g_{1}}$ 和 $\\nabla E_{g_{2}}$ 在该点共线时，才能逐点匹配精确的总通量；在这种情况下，可以定义一个合并后的标量扩散系数\n$$\nD_{G} = \\frac{D_{g_{1}} \\, \\lVert \\nabla E_{g_{1}} \\rVert + D_{g_{2}} \\, \\lVert \\nabla E_{g_{2}} \\rVert}{\\lVert \\nabla E_{g_{1}} + \\nabla E_{g_{2}} \\rVert}\n$$\n以满足 $F_{G} = - D_{G} \\nabla (E_{g_{1}} + E_{g_{2}}) = F_{g_{1}} + F_{g_{2}}$。如果梯度不共线，则不存在任何标量 $D_{G}$ 能够精确地再现 $F_{g_{1}} + F_{g_{2}}$，除非引入各向异性扩散张量。**\n\n该陈述是对标量扩散模型数学约束的正确且富有洞察力的分析。如在一般性分析中所推导，使用标量扩散系数 $D_G$ 来保持通量的可加性（$F_G = F_{g_1} + F_{g_2}$），需要解矢量方程 $D_G (\\nabla E_{g_1} + \\nabla E_{g_2}) = D_{g_1} \\nabla E_{g_1} + D_{g_2} \\nabla E_{g_2}$。这个方程仅当右侧的矢量和与左侧的矢量和相互平行时才有一个标量 $D_G$ 的解，这当且仅当 $\\nabla E_{g_{1}}$ 和 $\\nabla E_{g_{2}}$ 共线时才成立。如果它们不共线，所产生的扩散过程是各向异性的，意味着通量不平行于总能量密度梯度，这需要一个张量扩散系数来建模。给出的 $D_G$ 公式对于共线情况是正确的结果（假设梯度指向相同方向，使得 $\\lVert \\nabla E_{g_{1}} + \\nabla E_{g_{2}} \\rVert = \\lVert \\nabla E_{g_{1}} \\rVert + \\lVert \\nabla E_{g_{2}} \\rVert$）。选项 A 中描述的 LTE 扩散情况是满足此共线条件的特定物理场景。\n\n**结论：正确。**\n\n最终总结：选项 A、C 和 E 都是描述不透明度重新分组的不同但一致方面的正确陈述。",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "在许多高能量密度等离子体中，局部热动平衡（LTE）的假设不再成立，这要求我们采用更真实的非局部热动平衡（NLTE）模型。本练习提供了一个综合性的高级实践，指导您从第一性原理出发，构建一个包含多种原子过程的动力学模型。通过求解稳态速率方程来确定真实的能级布居数，并最终计算出等离子体的连续谱不透明度，这个过程模拟了计算原子物理学家的核心工作流程。",
            "id": "4025048",
            "problem": "给定一个最小的、物理上自洽的非局部热动平衡（NLTE）原子模型，该模型由三个束缚能级和一个连续谱（第一电离阶）组成。目标是基于辐射和碰撞跃迁的基本定义，建立稳态速率方程，求解非局部热动平衡的能级布居数，并计算指定频率下的单色连续谱消光系数。辐射场由单位频率的辐射能量密度指定，等离子体电子环境由电子密度和电子温度指定。\n\n使用的基本原理：\n- 每个能级的稳态布居平衡，由 $$\\sum_{j} n_j R_{j i} - n_i \\sum_{j} R_{i j} = 0$$ 给出，其中 $n_i$ 是能级 $i$ 的布居数，$R_{i j}$ 是从能级 $i$ 到能级 $j$ 的总跃迁速率（单位为 $\\mathrm{s}^{-1}$）。归一化约束为 $$\\sum_{i=1}^{3} n_i + n_c = n_{\\mathrm{A,tot}},$$ 其中 $n_c$ 是连续谱（电离）布居数，$n_{\\mathrm{A,tot}}$ 是总原子丰度（单位为 $\\mathrm{m}^{-3}$）。\n- 爱因斯坦系数关联了自发和受激的谱线过程。对于从上能级 $u$ 到下能级 $\\ell$ 的束缚-束缚跃迁，$$A_{u\\ell} = \\frac{8 \\pi h \\nu_{u\\ell}^3}{c^3} B_{u\\ell}, \\quad B_{\\ell u} = \\frac{g_u}{g_\\ell} B_{u\\ell},$$ 其中 $h$ 是普朗克常数，$c$ 是光速，$\\nu_{u\\ell}$ 是跃迁频率，$g_i$ 是能级简并度。对于单位频率的辐射能量密度 $u_\\nu$（单位 $\\mathrm{J\\,m^{-3}\\,Hz^{-1}}$），辐射性束缚-束缚跃迁速率为 $$R_{\\ell \\to u}^{\\mathrm{rad}} = B_{\\ell u}\\, u_\\nu, \\quad R_{u \\to \\ell}^{\\mathrm{rad}} = A_{u\\ell} + B_{u\\ell}\\, u_\\nu.$$\n- 碰撞（电子撞击）激发和退激发速率用细致平衡来建模。对于能量差为 $\\Delta E_{\\ell u}$ 的激发 $\\ell \\to u$，$$k_{\\ell u}(T_e) = K_{\\ell u}\\, \\exp\\!\\left(-\\frac{\\Delta E_{\\ell u}}{k_B T_e}\\right), \\quad k_{u\\ell}(T_e) = k_{\\ell u}(T_e)\\, \\frac{g_\\ell}{g_u}\\, \\exp\\!\\left(\\frac{\\Delta E_{\\ell u}}{k_B T_e}\\right),$$ 其中 $K_{\\ell u}$ 是一个前因子（单位 $\\mathrm{m^3\\,s^{-1}}$），$T_e$ 是电子温度，$k_B$ 是玻尔兹曼常数。相应的能级间跃迁速率为 $$R_{\\ell \\to u}^{\\mathrm{col}} = n_e\\, k_{\\ell u}(T_e), \\quad R_{u \\to \\ell}^{\\mathrm{col}} = n_e\\, k_{u\\ell}(T_e),$$ 其中 $n_e$ 是电子密度（单位 $\\mathrm{m^{-3}}$）。\n- 束缚-自由（光致电离和复合）速率模型如下。对于从束缚能级 $i$ 到连续谱的光致电离，其阈值频率为 $\\nu_{0,i}$，截面为类 Kramers 形式 $$\\sigma_i(\\nu) = \\begin{cases}\\sigma_{0,i}\\, \\left(\\dfrac{\\nu}{\\nu_{0,i}}\\right)^{-3},  \\nu \\ge \\nu_{0,i}, \\\\ 0,  \\nu  \\nu_{0,i},\\end{cases}$$ 在 $u_\\nu$ 在阈值以上近似恒定的各向同性辐射场中，光致电离速率为 $$R_{i \\to c}^{\\mathrm{pi}} = \\int_{\\nu_{0,i}}^\\infty \\sigma_i(\\nu)\\, \\frac{c\\, u_\\nu}{h \\nu}\\, d\\nu = \\frac{c\\, u_\\nu}{h}\\, \\frac{\\sigma_{0,i}}{3\\, \\nu_{0,i}}.$$ 碰撞电离由以下模型描述 $$R_{i \\to c}^{\\mathrm{ci}} = n_e\\, k_{i}^{\\mathrm{ion}}(T_e), \\quad k_{i}^{\\mathrm{ion}}(T_e) = K_{i}^{\\mathrm{ion}}\\, T_e^{1/2}\\, \\exp\\!\\left(-\\frac{\\chi_i}{k_B T_e}\\right),$$ 其中 $\\chi_i$ 是从能级 $i$ 到连续谱的电离势（单位 $\\mathrm{J}$），$K_{i}^{\\mathrm{ion}}$ 是一个前因子（单位 $\\mathrm{m^3\\,s^{-1}\\,K^{-1/2}}$）。到能级 $i$ 的辐射复合由以下模型描述 $$R_{c \\to i}^{\\mathrm{rec}} = n_e\\, \\alpha_i(T_e), \\quad \\alpha_i(T_e) = \\alpha_{0,i}\\, \\left(\\frac{T_e}{10^4\\, \\mathrm{K}}\\right)^{-0.7},$$ 其中 $\\alpha_{0,i}$ 的单位为 $\\mathrm{m^3\\,s^{-1}}$。\n- 在频率 $\\nu$ 下的单色连续谱消光系数（仅考虑束缚-自由过程，忽略束缚-束缚谱线贡献）为 $$\\kappa_\\nu^{\\mathrm{bf}} = \\sum_{i=1}^3 n_i\\, \\sigma_i(\\nu),$$ 单位为 $\\mathrm{m^{-1}}$。\n\n原子模型参数（在所有测试中固定）：\n- 束缚能级能量：$E_1 = 0\\, \\mathrm{eV}$，$E_2 = 2\\, \\mathrm{eV}$，$E_3 = 4\\, \\mathrm{eV}$。\n- 连续谱阈值（从基态的电离势）：$\\chi_1 = 5\\, \\mathrm{eV}$，因此 $\\chi_2 = 3\\, \\mathrm{eV}$ 且 $\\chi_3 = 1\\, \\mathrm{eV}$，其中 $\\nu_{0,i} = \\chi_i / h$。\n- 简并度：$g_1 = 1$，$g_2 = 3$，$g_3 = 5$。\n- 爱因斯坦自发辐射系数：$A_{21} = 5\\times 10^7\\, \\mathrm{s^{-1}}$，$A_{32} = 7\\times 10^7\\, \\mathrm{s^{-1}}$，$A_{31} = 1\\times 10^8\\, \\mathrm{s^{-1}}$。使用所述关系式获得 $B_{u\\ell}$ 和 $B_{\\ell u}$。\n- 碰撞激发前因子：$K_{12} = 3\\times 10^{-14}\\, \\mathrm{m^3\\,s^{-1}}$，$K_{23} = 2\\times 10^{-14}\\, \\mathrm{m^3\\,s^{-1}}$，$K_{13} = 1\\times 10^{-14}\\, \\mathrm{m^3\\,s^{-1}}$。\n- 碰撞电离前因子：$K_{1}^{\\mathrm{ion}} = 1\\times 10^{-16}\\, \\mathrm{m^3\\,s^{-1}\\,K^{-1/2}}$，$K_{2}^{\\mathrm{ion}} = 5\\times 10^{-17}\\, \\mathrm{m^3\\,s^{-1}\\,K^{-1/2}}$，$K_{3}^{\\mathrm{ion}} = 2\\times 10^{-17}\\, \\mathrm{m^3\\,s^{-1}\\,K^{-1/2}}$。\n- 在 $10^4\\, \\mathrm{K}$ 时的辐射复合系数：$\\alpha_{0,1} = 1\\times 10^{-19}\\, \\mathrm{m^3\\,s^{-1}}$，$\\alpha_{0,2} = 5\\times 10^{-20}\\, \\mathrm{m^3\\,s^{-1}}$，$\\alpha_{0,3} = 2\\times 10^{-20}\\, \\mathrm{m^3\\,s^{-1}}$。\n- 光致电离截面阈值：$\\sigma_{0,1} = 6\\times 10^{-22}\\, \\mathrm{m^2}$，$\\sigma_{0,2} = 8\\times 10^{-22}\\, \\mathrm{m^2}$，$\\sigma_{0,3} = 1.2\\times 10^{-21}\\, \\mathrm{m^2}$。\n- 用于多普勒效应考虑的原子质量在此处的消光计算中未使用。\n- 在国际单位制（SI）下使用基本电荷 $e$、普朗克常数 $h$、玻尔兹曼常数 $k_B$ 和光速 $c$。\n\n计算任务：\n1. 对于每个测试用例，构建能级 $\\{1,2,3,c\\}$ 的 $4\\times 4$ 速率矩阵 $\\mathbf{M}$，使得 $$\\mathbf{M}\\, \\mathbf{n} = \\mathbf{b},$$ 其中前三行强制执行稳态平衡方程 $$\\sum_{j} n_j R_{j i} - n_i \\sum_{j} R_{i j} = 0,$$ 第四行强制执行归一化 $$n_1 + n_2 + n_3 + n_c = n_{\\mathrm{A,tot}}.$$ 右侧项 $\\mathbf{b}$ 除最后一个分量等于 $n_{\\mathrm{A,tot}}$ 外，其余均为零。\n2. 求解布居数 $\\mathbf{n} = (n_1, n_2, n_3, n_c)$。\n3. 在频率 $$\\nu_{\\mathrm{test}} = 1.2\\, \\nu_{0,1} = \\frac{1.2\\, \\chi_1}{h},$$ 下计算单色连续谱消光系数，使用 $$\\kappa_{\\nu_{\\mathrm{test}}}^{\\mathrm{bf}} = n_1\\, \\sigma_1(\\nu_{\\mathrm{test}}) + n_2\\, \\sigma_2(\\nu_{\\mathrm{test}}) + n_3\\, \\sigma_3(\\nu_{\\mathrm{test}}).$$ 以 $\\mathrm{m^{-1}}$ 为单位表示最终的消光系数。\n\n测试套件：\n每个测试用例是一个元组 $(u_\\nu, n_e, T_e, n_{\\mathrm{A,tot}})$，单位为 $(\\mathrm{J\\,m^{-3}\\,Hz^{-1}}, \\mathrm{m^{-3}}, \\mathrm{K}, \\mathrm{m^{-3}})$。\n\n- 用例 1（通用，中等辐射和密度）：$(1.0\\times 10^{-13},\\ 1.0\\times 10^{23},\\ 2.0\\times 10^{4},\\ 1.0\\times 10^{20})$。\n- 用例 2（辐射主导，低密度）：$(5.0\\times 10^{-13},\\ 1.0\\times 10^{21},\\ 1.5\\times 10^{4},\\ 5.0\\times 10^{19})$。\n- 用例 3（碰撞主导，高密度，弱辐射）：$(1.0\\times 10^{-15},\\ 5.0\\times 10^{24},\\ 3.0\\times 10^{4},\\ 2.0\\times 10^{20})$。\n- 用例 4（可忽略辐射的边缘情况）：$(1.0\\times 10^{-20},\\ 1.0\\times 10^{23},\\ 2.0\\times 10^{4},\\ 1.0\\times 10^{20})$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含测试用例的消光系数，形式为方括号内以逗号分隔的列表（例如，$$[x_1,x_2,x_3,x_4]$$），其中每个 $x_i$ 是为相应测试用例计算出的 $\\kappa_{\\nu_{\\mathrm{test}}}^{\\mathrm{bf}}$（单位为 $\\mathrm{m^{-1}}$）。",
            "solution": "我们从第一性原理出发，推导非局部热动平衡（NLTE）的稳态速率方程，然后将其转化为适合数值求解的算法矩阵形式，最后计算单色连续谱消光系数。\n\n1. 定义能级和跃迁。原子有三个束缚能级，能量分别为 $E_1 = 0\\, \\mathrm{eV}$，$E_2 = 2\\, \\mathrm{eV}$，$E_3 = 4\\, \\mathrm{eV}$，简并度为 $g_1 = 1$，$g_2 = 3$，$g_3 = 5$，以及一个具有电离势 $\\chi_1 = 5\\, \\mathrm{eV}$，$\\chi_2 = 3\\, \\mathrm{eV}$，$\\chi_3 = 1\\, \\mathrm{eV}$ 的单一连续谱 $c$。束缚-束缚辐射跃迁 $u \\to \\ell$ 具有自发辐射系数 $A_{21}$、$A_{32}$ 和 $A_{31}$；其相应的爱因斯坦 $B$ 系数通过以下公式获得：$$B_{u\\ell} = \\frac{A_{u\\ell}\\, c^3}{8 \\pi h \\nu_{u\\ell}^3}, \\quad B_{\\ell u} = \\frac{g_u}{g_\\ell} B_{u\\ell},$$ 其中 $\\nu_{u\\ell} = (E_u - E_\\ell) / h$，$E$ 从电子伏特转换为焦耳。对于单位频率的辐射能量密度 $u_\\nu$（假设在谱线的窄带宽内是恒定的），辐射速率为 $$R_{\\ell \\to u}^{\\mathrm{rad}} = B_{\\ell u}\\, u_\\nu, \\quad R_{u \\to \\ell}^{\\mathrm{rad}} = A_{u\\ell} + B_{u\\ell}\\, u_\\nu.$$\n\n2. 束缚能级之间的碰撞跃迁使用细致平衡进行建模。对于能隙为 $\\Delta E_{\\ell u}$ 的向上激发 $\\ell \\to u$，激发速率系数为 $$k_{\\ell u}(T_e) = K_{\\ell u}\\, \\exp\\!\\left(-\\frac{\\Delta E_{\\ell u}}{k_B T_e}\\right),$$ 其中 $K_{\\ell u}$ 是一个前因子（单位 $\\mathrm{m^3\\,s^{-1}}$）。退激发速率系数由细致平衡得出，$$k_{u\\ell}(T_e) = k_{\\ell u}(T_e)\\, \\frac{g_\\ell}{g_u}\\, \\exp\\!\\left(\\frac{\\Delta E_{\\ell u}}{k_B T_e}\\right).$$ 能级间的碰撞速率为 $$R_{\\ell \\to u}^{\\mathrm{col}} = n_e\\, k_{\\ell u}(T_e), \\quad R_{u \\to \\ell}^{\\mathrm{col}} = n_e\\, k_{u\\ell}(T_e).$$\n\n3. 束缚-自由过程包括光致电离和辐射复合；碰撞电离也包括在内。对于类 Kramers 阈值截面 $$\\sigma_i(\\nu) = \\sigma_{0,i}\\, \\left(\\frac{\\nu}{\\nu_{0,i}}\\right)^{-3}, \\quad \\nu \\ge \\nu_{0,i},$$ 其中 $\\nu_{0,i} = \\chi_i / h$，在阈值以上 $u_\\nu$ 恒定的各向同性场中，能级 $i$ 的光致电离速率为 $$R_{i \\to c}^{\\mathrm{pi}} = \\int_{\\nu_{0,i}}^\\infty \\sigma_i(\\nu)\\, \\frac{c\\, u_\\nu}{h \\nu}\\, d\\nu = \\frac{c\\, u_\\nu}{h}\\, \\frac{\\sigma_{0,i}}{3\\, \\nu_{0,i}}.$$ 碰撞电离由以下模型描述 $$R_{i \\to c}^{\\mathrm{ci}} = n_e\\, k_{i}^{\\mathrm{ion}}(T_e), \\quad k_{i}^{\\mathrm{ion}}(T_e) = K_{i}^{\\mathrm{ion}}\\, T_e^{1/2}\\, \\exp\\!\\left(-\\frac{\\chi_i}{k_B T_e}\\right),$$ 辐射复合由以下模型描述 $$R_{c \\to i}^{\\mathrm{rec}} = n_e\\, \\alpha_i(T_e), \\quad \\alpha_i(T_e) = \\alpha_{0,i}\\, \\left(\\frac{T_e}{10^4\\, \\mathrm{K}}\\right)^{-0.7}.$$\n\n4. 稳态速率方程。令索引 $i,j \\in \\{1,2,3,c\\}$。对于每个束缚能级 $i \\in \\{1,2,3\\}$，稳态条件为 $$\\sum_{j} n_j R_{j i} - n_i \\sum_{j} R_{i j} = 0,$$ 其中 $R_{i j}$ 包含所有辐射和碰撞贡献（束缚-束缚和束缚-自由）。对于连续谱 $c$，条件是类似的；然而，我们将用归一化约束 $$n_1 + n_2 + n_3 + n_c = n_{\\mathrm{A,tot}}$$ 替换四个方程中的一个，以使系统良态。\n\n5. 矩阵形式。我们构建一个 $4 \\times 4$ 矩阵 $\\mathbf{M}$，其前三行编码 $i = 1,2,3$ 的稳态条件：\n- 对每个 $i$，设置 $$M_{i,i} = -\\sum_{j} R_{i j}, \\quad M_{i,j} = R_{j i} \\text{ for } j \\ne i.$$\n第四行强制执行归一化：$$M_{4,1} = M_{4,2} = M_{4,3} = M_{4,4} = 1.$$\n右侧向量为 $$\\mathbf{b} = (0, 0, 0, n_{\\mathrm{A,tot}})^{\\top}.$$ 求解 $$\\mathbf{M}\\, \\mathbf{n} = \\mathbf{b}$$ 得到布居数 $\\mathbf{n} = (n_1, n_2, n_3, n_c)$。\n\n6. 单色连续谱消光。在指定的测试频率 $$\\nu_{\\mathrm{test}} = 1.2\\, \\nu_{0,1} = \\frac{1.2\\, \\chi_1}{h},$$ 束缚-自由消光系数为 $$\\kappa_{\\nu_{\\mathrm{test}}}^{\\mathrm{bf}} = \\sum_{i=1}^3 n_i\\, \\sigma_i(\\nu_{\\mathrm{test}}), \\quad \\sigma_i(\\nu_{\\mathrm{test}}) = \\sigma_{0,i}\\, \\left(\\frac{\\nu_{\\mathrm{test}}}{\\nu_{0,i}}\\right)^{-3}.$$ 其单位为 $\\mathrm{m^{-1}}$，并作为所要求的 $\\kappa_\\nu$。\n\n7. 与原理一致的算法大纲：\n- 将所有与能量相关的参数从电子伏特转换为焦耳，以计算频率 $\\nu_{u\\ell}$ 和阈值 $\\nu_{0,i}$。\n- 使用 $$B_{u\\ell} = \\frac{A_{u\\ell}\\, c^3}{8 \\pi h \\nu_{u\\ell}^3}, \\quad B_{\\ell u} = \\frac{g_u}{g_\\ell} B_{u\\ell}$$ 从 $A$ 计算爱因斯坦 $B$ 系数。每个测试用例使用统一的 $u_\\nu$。\n- 计算束缚-束缚辐射速率：向上 $R_{\\ell u}^{\\mathrm{rad}} = B_{\\ell u}\\, u_\\nu$，向下 $R_{u\\ell}^{\\mathrm{rad}} = A_{u\\ell} + B_{u\\ell}\\, u_\\nu$ 对于所有允许的跃迁 $(1\\leftrightarrow 2)$、$(2\\leftrightarrow 3)$、$(1\\leftrightarrow 3)$。\n- 使用 $k_{\\ell u}(T_e)$ 和细致平衡计算 $k_{u\\ell}(T_e)$，然后乘以 $n_e$，来计算碰撞束缚-束缚速率。\n- 计算束缚-自由光致电离速率 $R_{i c}^{\\mathrm{pi}}$（使用积分公式）、碰撞电离速率 $R_{i c}^{\\mathrm{ci}}$ 和复合速率 $R_{c i}^{\\mathrm{rec}}$，对于 $i = 1,2,3$。\n- 组装速率矩阵 $\\mathbf{M}$ 并使用线性求解器求解 $\\mathbf{M}\\, \\mathbf{n} = \\mathbf{b}$。通过将微小的负数数值误差截断为零来强制布居数的非负性，并在数值容差范围内验证归一化。\n- 根据能级布居数和在 $\\nu_{\\mathrm{test}}$ 的截面计算 $\\kappa_{\\nu_{\\mathrm{test}}}^{\\mathrm{bf}}$。\n\n8. 数值鲁棒性和边缘情况：\n- 即使某个能级耦合很弱，归一化约束也能确保系统有唯一解。\n- 极端的辐射情况（非常小或非常大的 $u_\\nu$）通过爱因斯坦关系式调整辐射泵浦和退激发速率，与自发过程和受激过程之间的基本平衡保持一致。\n- 非常高的密度会使碰撞速率与 $n_e$ 成比例增加，从而产生碰撞主导的 NLTE 布居。\n- 消光计算仅包括束缚-自由贡献，这对于科学上合理的连续谱不透明度是足够的。包含束缚-束缚谱线不透明度将需要谱线轮廓积分，这超出了最小连续谱任务的范围。\n\n程序为四个指定的测试用例实现了上述步骤，并以要求的格式输出单行结果，其中每个条目代表 $\\kappa_{\\nu_{\\mathrm{test}}}^{\\mathrm{bf}}$（单位为 $\\mathrm{m^{-1}}$）。\n```python\n# Python 3.12\n# Required libraries: numpy 1.23.5\nimport numpy as np\n\n# Physical constants (SI)\nh = 6.62607015e-34       # Planck constant, J*s\nc = 2.99792458e8         # speed of light, m/s\nkB = 1.380649e-23        # Boltzmann constant, J/K\neV = 1.602176634e-19     # 1 eV in J\n\n# Atomic model parameters (fixed)\n# Level energies (eV) and convert to J\nE1_eV, E2_eV, E3_eV = 0.0, 2.0, 4.0\nE1, E2, E3 = E1_eV * eV, E2_eV * eV, E3_eV * eV\n# Ionization potentials (eV) and convert to J\nchi1_eV, chi2_eV, chi3_eV = 5.0, 3.0, 1.0\nchi1, chi2, chi3 = chi1_eV * eV, chi2_eV * eV, chi3_eV * eV\n# Threshold frequencies\nnu0_1, nu0_2, nu0_3 = chi1 / h, chi2 / h, chi3 / h\n\n# Degeneracies\ng1, g2, g3 = 1, 3, 5\n\n# Einstein A coefficients (s^-1)\nA21 = 5.0e7\nA32 = 7.0e7\nA31 = 1.0e8\n\n# Bound-bound transition frequencies\nnu21 = (E2 - E1) / h\nnu32 = (E3 - E2) / h\nnu31 = (E3 - E1) / h\n\ndef B_ul(A_ul, nu):\n    # Einstein B_ul from A_ul for energy density per unit frequency rho (u_nu)\n    return A_ul * c**3 / (8.0 * np.pi * h * nu**3)\n\n# Compute B coefficients\nB21_ul = B_ul(A21, nu21)  # u=2, l=1\nB32_ul = B_ul(A32, nu32)  # u=3, l=2\nB31_ul = B_ul(A31, nu31)  # u=3, l=1\nB12_lu = (g2 / g1) * B21_ul\nB23_lu = (g3 / g2) * B32_ul\nB13_lu = (g3 / g1) * B31_ul\n\n# Collisional excitation prefactors (m^3/s)\nK12 = 3.0e-14\nK23 = 2.0e-14\nK13 = 1.0e-14\n\n# Collisional ionization prefactors (m^3 s^-1 K^-1/2)\nKion1 = 1.0e-16\nKion2 = 5.0e-17\nKion3 = 2.0e-17\n\n# Radiative recombination coefficients at 1e4 K (m^3/s)\nalpha0_1 = 1.0e-19\nalpha0_2 = 5.0e-20\nalpha0_3 = 2.0e-20\n\n# Photoionization cross-section thresholds (m^2)\nsigma0_1 = 6.0e-22\nsigma0_2 = 8.0e-22\nsigma0_3 = 1.2e-21\n\ndef k_excitation(Kpref, DeltaE, Te):\n    return Kpref * np.exp(-DeltaE / (kB * Te))\n\ndef k_deexcitation(k_up, g_l, g_u, DeltaE, Te):\n    return k_up * (g_l / g_u) * np.exp(DeltaE / (kB * Te))\n\ndef k_ion(Kion_pref, chi, Te):\n    return Kion_pref * (Te**0.5) * np.exp(-chi / (kB * Te))\n\ndef alpha_rec(alpha0, Te):\n    return alpha0 * (Te / 1.0e4)**(-0.7)\n\ndef R_photoionization(sigma0, nu0, u_nu):\n    # R = (c u_nu / h) * (sigma0 / (3 nu0))\n    return (c * u_nu / h) * (sigma0 / (3.0 * nu0))\n\ndef sigma_bf_at_nu(sigma0, nu0, nu):\n    if nu  nu0:\n        return 0.0\n    return sigma0 * (nu / nu0)**(-3.0)\n\ndef solve_case(u_nu, ne, Te, nA_tot):\n    # Bound-bound radiative rates using energy density u_nu\n    # Upward (absorption)\n    R12_rad_up = B12_lu * u_nu\n    R23_rad_up = B23_lu * u_nu\n    R13_rad_up = B13_lu * u_nu\n    # Downward (spontaneous + stimulated)\n    R21_rad_down = A21 + B21_ul * u_nu\n    R32_rad_down = A32 + B32_ul * u_nu\n    R31_rad_down = A31 + B31_ul * u_nu\n\n    # Collisional bound-bound rates\n    # 1 -> 2\n    DeltaE12 = E2 - E1\n    k12_up = k_excitation(K12, DeltaE12, Te)\n    k21_down = k_deexcitation(k12_up, g1, g2, DeltaE12, Te)\n    R12_col = ne * k12_up\n    R21_col = ne * k21_down\n    # 2 -> 3\n    DeltaE23 = E3 - E2\n    k23_up = k_excitation(K23, DeltaE23, Te)\n    k32_down = k_deexcitation(k23_up, g2, g3, DeltaE23, Te)\n    R23_col = ne * k23_up\n    R32_col = ne * k32_down\n    # 1 -> 3\n    DeltaE13 = E3 - E1\n    k13_up = k_excitation(K13, DeltaE13, Te)\n    k31_down = k_deexcitation(k13_up, g1, g3, DeltaE13, Te)\n    R13_col = ne * k13_up\n    R31_col = ne * k31_down\n\n    # Bound-free rates\n    R1c_pi = R_photoionization(sigma0_1, nu0_1, u_nu)\n    R2c_pi = R_photoionization(sigma0_2, nu0_2, u_nu)\n    R3c_pi = R_photoionization(sigma0_3, nu0_3, u_nu)\n    R1c_ci = ne * k_ion(Kion1, chi1, Te)\n    R2c_ci = ne * k_ion(Kion2, chi2, Te)\n    R3c_ci = ne * k_ion(Kion3, chi3, Te)\n    Rc1_rec = ne * alpha_rec(alpha0_1, Te)\n    Rc2_rec = ne * alpha_rec(alpha0_2, Te)\n    Rc3_rec = ne * alpha_rec(alpha0_3, Te)\n\n    # Build rate matrix M for levels [1,2,3,c] indices [0,1,2,3]\n    M = np.zeros((4, 4))\n\n    # R[i, j] is the rate from state i to state j\n    R = np.zeros((4,4))\n\n    # Bound-bound contributions:\n    R[0,1] = R12_rad_up + R12_col\n    R[1,0] = R21_rad_down + R21_col\n    R[1,2] = R23_rad_up + R23_col\n    R[2,1] = R32_rad_down + R32_col\n    R[0,2] = R13_rad_up + R13_col\n    R[2,0] = R31_rad_down + R31_col\n\n    # Bound-free: i -> c and c -> i\n    R[0,3] = R1c_pi + R1c_ci\n    R[1,3] = R2c_pi + R2c_ci\n    R[2,3] = R3c_pi + R3c_ci\n    R[3,0] = Rc1_rec\n    R[3,1] = Rc2_rec\n    R[3,2] = Rc3_rec\n\n    # Fill first three rows (i = 0,1,2) with steady-state balances\n    # Row i represents sum_j n_j R_{j->i} - n_i sum_j R_{i->j} = 0\n    for i in range(3):\n        # Outgoing sum from i\n        sum_out = np.sum(R[i, :])\n        M[i, i] = -sum_out\n        # Incoming from other j\n        for j in range(4):\n            if j != i:\n                M[i, j] = R[j, i]\n\n    # Fourth row: normalization\n    M[3, :] = 1.0\n\n    # RHS vector\n    b = np.zeros(4)\n    b[3] = nA_tot\n\n    # Solve linear system\n    n = np.linalg.solve(M, b)\n\n    # Numerical cleanup: enforce non-negativity due to possible tiny numerical undershoots\n    n = np.where(n  0.0, 0.0, n)\n\n    # Compute continuum extinction at nu_test = 1.2 * nu0_1\n    nu_test = 1.2 * nu0_1\n    sigma1 = sigma_bf_at_nu(sigma0_1, nu0_1, nu_test)\n    sigma2 = sigma_bf_at_nu(sigma0_2, nu0_2, nu_test)\n    sigma3 = sigma_bf_at_nu(sigma0_3, nu0_3, nu_test)\n    kappa_nu = n[0] * sigma1 + n[1] * sigma2 + n[2] * sigma3  # m^-1\n\n    return kappa_nu\n\ndef solve():\n    # Define the test cases from the problem statement: (u_nu, n_e, T_e, n_A_total)\n    test_cases = [\n        (1.0e-13, 1.0e23, 2.0e4, 1.0e20),  # Case 1\n        (5.0e-13, 1.0e21, 1.5e4, 5.0e19),  # Case 2\n        (1.0e-15, 5.0e24, 3.0e4, 2.0e20),  # Case 3\n        (1.0e-20, 1.0e23, 2.0e4, 1.0e20),  # Case 4\n    ]\n\n    results = []\n    for u_nu, ne, Te, nA_tot in test_cases:\n        kappa = solve_case(u_nu, ne, Te, nA_tot)\n        results.append(kappa)\n\n    # Format the results to a reasonable precision for the final answer\n    formatted_results = [f\"{res:.4g}\" for res in results]\n    return f\"[{','.join(formatted_results)}]\"\n```",
            "answer": "$$\\boxed{[0.03817, 0.02101, 0.05437, 0.03789]}$$"
        }
    ]
}