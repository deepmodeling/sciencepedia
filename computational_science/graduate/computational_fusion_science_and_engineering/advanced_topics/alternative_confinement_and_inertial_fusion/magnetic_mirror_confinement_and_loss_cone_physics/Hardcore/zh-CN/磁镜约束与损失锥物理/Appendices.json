{
    "hands_on_practices": [
        {
            "introduction": "理解被约束粒子和逃逸粒子之间的边界是磁镜物理学的基础。第一个练习将引导你推导临界螺距角，它在速度空间中定义了“损失锥”，并要求你应用这一概念来确定一个粒子在特定磁镜位形中的命运 。这项技能是评估任何磁镜装置基本约束性能的基石。",
            "id": "4012768",
            "problem": "考虑一个直的、轴对称的磁镜装置，其磁场大小沿磁力线变化，在中平面处有最小值，在两端有对称的最大值。假设粒子运动遵循导心近似，在没有电场和碰撞的情况下，第一绝热不变量（磁矩）和总能量守恒。设磁镜比定义为 $R \\equiv B_{\\max}/B_{\\min}$。一个离子在中平面处被注入，此处 $B=B_{\\min}$，其总速率为 $v$，螺距角为 $\\alpha$，在中平面处定义为 $\\tan\\alpha \\equiv v_{\\perp}/v_{\\parallel}$。\n\n从磁矩 $\\mu \\equiv m v_{\\perp}^{2}/(2B)$ 和总能量 $E \\equiv \\tfrac{1}{2} m v^{2}$ 的定义出发，并仅利用它们沿磁力线的守恒性，推导出磁镜反射的条件，并确定在中平面处区分被捕获轨道和逸入磁镜喉轨道的临界螺距角 $\\alpha_{c}$。\n\n然后，对于在 $B_{\\min}=0.2\\,\\text{T}$ 处速度为 $v=3\\times 10^{5}\\,\\text{m/s}$ 且磁镜比为 $R=16$ 的离子，计算 $\\alpha_{c}$ 并确定一个以初始螺距角 $\\alpha=10^{\\circ}$ 在中平面发射的粒子是会丢失还是保持约束。将临界螺距角以度为单位表示，并四舍五入到四位有效数字。为了报告，定义一个指示符 $L$，如果粒子丢失（即其轨道在损失锥内），则 $L=1$；如果它保持约束（即它被磁镜反射），则 $L=0$。将您的最终答案以一个 $1\\times 2$ 行矩阵的形式在 $\\texttt{pmatrix}$ 环境中报告，即 $(\\alpha_{c}\\ \\ L)$，其中 $\\alpha_{c}$ 按指定以度为单位。",
            "solution": "所陈述的问题在科学上是合理的，提法恰当，并包含了获得唯一解所需的所有信息。这是一个关于带电粒子在磁镜位形中运动的等离子体物理学标准问题。因此，我们可以进行推导和求解。\n\n控制粒子运动的基本原理是其总动能 $E$ 和磁矩 $\\mu$ 的守恒。题目给定没有电场，因此势能为零。\n\n总动能为：\n$$ E = \\frac{1}{2} m v^{2} = \\frac{1}{2} m (v_{\\parallel}^{2} + v_{\\perp}^{2}) $$\n这里，$m$ 是粒子质量，$v$ 是其总速率，$v_{\\parallel}$ 和 $v_{\\perp}$ 分别是平行和垂直于磁场矢量 $\\vec{B}$ 的速度分量。由于 $E$ 和 $m$ 是常数，总速率 $v$ 也沿粒子轨道保持不变。\n\n磁矩，或第一绝热不变量，是：\n$$ \\mu = \\frac{m v_{\\perp}^{2}}{2B} $$\n其中 $B = |\\vec{B}|$ 是磁场的大小。$\\mu$ 的守恒是这个问题的一个基石。\n\n我们用下标“$0$”表示磁镜装置中平面处的条件，那里的磁场处于其最小值 $B_{\\min}$。任何没有下标的量指的是粒子路径上场强为 $B$ 的任意点处的值。\n\n根据 $\\mu$ 的守恒，我们可以写出：\n$$ \\frac{m v_{\\perp,0}^{2}}{2 B_{\\min}} = \\frac{m v_{\\perp}^{2}}{2 B} $$\n这使我们能够将任意点的垂直速率与其在中平面处的初始值联系起来：\n$$ v_{\\perp}^{2} = v_{\\perp,0}^{2} \\left( \\frac{B}{B_{\\min}} \\right) $$\n\n根据能量守恒，我们有：\n$$ v^{2} = v_{\\parallel}^{2} + v_{\\perp}^{2} = v_{\\parallel,0}^{2} + v_{\\perp,0}^{2} $$\n我们可以找到在任意点 $B$ 处平行速度分量 $v_{\\parallel}$ 的表达式：\n$$ v_{\\parallel}^{2} = v^{2} - v_{\\perp}^{2} $$\n将从 $\\mu$ 守恒得到的 $v_{\\perp}^{2}$ 表达式代入：\n$$ v_{\\parallel}^{2} = v^{2} - v_{\\perp,0}^{2} \\left( \\frac{B}{B_{\\min}} \\right) $$\n\n问题指明了在中平面处的初始螺距角 $\\alpha$。中平面处的速度分量可以用总速率 $v$ 和这个螺距角 $\\alpha$ 表示为：\n$$ v_{\\perp,0} = v \\sin\\alpha $$\n$$ v_{\\parallel,0} = v \\cos\\alpha $$\n这些定义与问题陈述 $\\tan\\alpha = v_{\\perp,0}/v_{\\parallel,0}$ 相一致。将 $v_{\\perp,0}^{2} = v^{2} \\sin^{2}\\alpha$ 代入 $v_{\\parallel}^{2}$ 的方程：\n$$ v_{\\parallel}^{2} = v^{2} - (v^{2} \\sin^{2}\\alpha) \\left( \\frac{B}{B_{\\min}} \\right) $$\n提出因子 $v^{2}$：\n$$ v_{\\parallel}^{2} = v^{2} \\left( 1 - \\frac{B}{B_{\\min}} \\sin^{2}\\alpha \\right) $$\n这个方程描述了当粒子沿磁力线运动时，其平行方向的动能如何变化。\n\n当粒子的平行速度变为零（$v_{\\parallel} = 0$）时，它在这一点被反射，或称“镜像反射”。在这个转折点，其所有动能都在垂直运动中。设反射点处的磁场为 $B_{\\text{refl}}$。令 $v_{\\parallel} = 0$ 提供了反射的条件：\n$$ 0 = v^{2} \\left( 1 - \\frac{B_{\\text{refl}}}{B_{\\min}} \\sin^{2}\\alpha \\right) $$\n对于一个速度不为零的粒子（$v \\neq 0$），这简化为：\n$$ 1 = \\frac{B_{\\text{refl}}}{B_{\\min}} \\sin^{2}\\alpha \\quad \\implies \\quad \\sin^{2}\\alpha = \\frac{B_{\\min}}{B_{\\text{refl}}} $$\n\n如果一个粒子在到达磁镜末端（场强达到最大值 $B_{\\max}$）之前发生反射，则认为它被捕获或约束。这意味着反射必须在场强 $B_{\\text{refl}} \\le B_{\\max}$ 处发生。将此应用于我们的反射条件：\n$$ \\frac{B_{\\min}}{\\sin^{2}\\alpha} \\le B_{\\max} $$\n重新整理这个不等式，得到以初始螺距角 $\\alpha$ 表示的粒子约束条件：\n$$ \\sin^{2}\\alpha \\ge \\frac{B_{\\min}}{B_{\\max}} $$\n使用磁镜比的定义 $R \\equiv B_{\\max}/B_{\\min}$，约束条件变为：\n$$ \\sin^{2}\\alpha \\ge \\frac{1}{R} $$\n\n不满足此条件的粒子将穿过磁镜而丢失。这些粒子被称为处于“损失锥”内。临界螺距角 $\\alpha_c$ 定义了该损失锥的边界。它对应于一个恰好在最大磁场处反射的粒子，即 $B_{\\text{refl}} = B_{\\max}$。在这个临界角下，约束条件是一个等式：\n$$ \\sin^{2}\\alpha_{c} = \\frac{1}{R} $$\n由于螺距角在范围 $[0, \\pi/2]$ 内，我们可以取正平方根：\n$$ \\sin\\alpha_{c} = \\frac{1}{\\sqrt{R}} $$\n因此，临界螺距角由下式给出：\n$$ \\alpha_{c} = \\arcsin\\left(\\frac{1}{\\sqrt{R}}\\right) $$\n任何在中平面以初始螺距角 $\\alpha  \\alpha_c$ 发射的粒子都位于损失锥内，将会逃逸。\n\n现在我们应用给定的数值。我们有磁镜比 $R=16$。计算 $\\alpha_c$ 时不需要粒子速率 $v=3 \\times 10^{5}\\,\\text{m/s}$ 和最小磁场 $B_{\\min}=0.2\\,\\text{T}$ 的值，因为它仅取决于通过 $R$ 表达的磁场几何形状。\n$$ \\alpha_{c} = \\arcsin\\left(\\frac{1}{\\sqrt{16}}\\right) = \\arcsin\\left(\\frac{1}{4}\\right) = \\arcsin(0.25) $$\n为了用度表示，我们进行数值计算：\n$$ \\alpha_{c} \\approx 14.477512...^{\\circ} $$\n按要求四舍五入到四位有效数字：\n$$ \\alpha_{c} \\approx 14.48^{\\circ} $$\n\n接下来，我们评估一个以初始螺距角 $\\alpha_{\\text{initial}} = 10^{\\circ}$ 发射的粒子的轨道。我们将这个角度与临界角 $\\alpha_c$ 进行比较：\n$$ \\alpha_{\\text{initial}} = 10^{\\circ}  14.48^{\\circ} \\approx \\alpha_{c} $$\n由于初始螺距角小于临界角，粒子的速度矢量位于损失锥内部。因此，该粒子未被约束并将丢失。\n\n最后，我们确定指示变量 $L$，其定义为：对于丢失的粒子，$L=1$；对于被约束的粒子，$L=0$。由于该粒子丢失，我们有 $L=1$。\n\n所要求的答案是行矩阵 $(\\alpha_c, L)$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 14.48  1 \\end{pmatrix}} $$"
        },
        {
            "introduction": "虽然单粒子分析富有洞察力，但真正的聚变等离子体是具有速度分布的大量粒子的集合。本练习将我们的分析扩展到具有温度各向异性（$T_\\perp \\neq T_\\parallel$）的等离子体，这是磁镜装置中的一个普遍特征。通过计算双麦克斯韦分布下损失锥中的粒子份额 ，你将探索动力学效应如何改变约束性能，并开始理解控制等离子体稳定性的反馈回路。",
            "id": "3708231",
            "problem": "一个单室轴对称磁镜在中平面具有最小磁场强度 $B_{0}$，在磁喉处具有最大磁场强度 $B_{m}$，其磁镜比 $R \\equiv B_{m}/B_{0} \\geq 1$。考虑中平面处的一个无碰撞等离子体，其离子速度分布函数为双麦克斯韦分布，分别由垂直温度 $T_{\\perp}$ 和平行温度 $T_{\\parallel}$ 表征。假设在缓变磁场中的导心运动，使得总动能 $E = \\tfrac{1}{2} m v^{2}$ 和磁矩 $\\mu = m v_{\\perp}^{2}/(2 B)$ 是沿磁力线的运动不变量。忽略沿磁力线的任何静电势降和任何非绝热效应。\n\n1) 从这些守恒定律和中平面处的双麦克斯韦分布出发，推导出一个闭式表达式，表示速度空间中处于损失轨道（即在速度空间损失锥内，从磁镜任一端流出的粒子）的粒子所占的比例。最终答案仅用各向异性 $A \\equiv T_{\\perp}/T_{\\parallel}$ 和磁镜比 $R$ 的函数表示。你的结果必须是一个单一的闭式解析表达式。\n\n2) 在标度和物理推理的层面上，简要讨论各向异性 $A$ 如何通过其对损失锥布居的影响来改变端部损失率，以及这如何与磁镜模不稳定性反馈耦合。在你的讨论中，可以参考双麦克斯韦等离子体中磁镜不稳定性起始的经过充分检验的判据，但不要依赖它来获得第 (1) 部分的表达式。\n\n要求的最终答案仅为第 (1) 部分的表达式。不需要数值计算，也不需要单位，因为该比例是无量纲的。",
            "solution": "用户提供了一个来自等离子体物理领域的有效问题陈述，具体涉及磁镜中的粒子约束。该问题具有科学依据，论述清晰且客观。它基于等离子体物理学的基本原理，即带电粒子在缓变磁场中能量和磁矩的守恒。所有推导所需表达式的必要信息都已提供。\n\n问题分为两部分。第 (1) 部分要求推导损失轨道上的粒子比例。第 (2) 部分要求讨论其物理含义。最终答案应仅为第 (1) 部分的结果。\n\n### 第 (1) 部分：损失分数的推导\n\n我们首先建立粒子从磁镜中损失的条件。如果一个粒子在到达磁场达到最大值 $B_m$ 的磁喉之前被磁场反射，则该粒子被约束。如果粒子能够穿过磁喉，则该粒子会损失。\n\n设粒子质量为 $m$。其速度矢量 $\\vec{v}$ 可以分解为平行于磁力线的分量 ($v_{\\parallel}$) 和垂直于磁力线的分量 ($v_{\\perp}$)。问题指出，总动能 $E$ 和磁矩 $\\mu$ 是运动不变量。它们的定义如下：\n$$ E = \\frac{1}{2}m(v_{\\parallel}^2 + v_{\\perp}^2) $$\n$$ \\mu = \\frac{m v_{\\perp}^2}{2B} $$\n\n我们用下标“0”表示中平面（$B=B_0$）处的量，用下标“m”表示磁喉（$B=B_m$）处的量。守恒定律意味着：\n$$ E = \\frac{1}{2}m(v_{\\parallel,0}^2 + v_{\\perp,0}^2) = \\frac{1}{2}m(v_{\\parallel,m}^2 + v_{\\perp,m}^2) $$\n$$ \\mu = \\frac{m v_{\\perp,0}^2}{2B_0} = \\frac{m v_{\\perp,m}^2}{2B_m} $$\n\n根据 $\\mu$ 的守恒，我们可以用中平面的垂直速度表示磁喉处的垂直速度：\n$$ v_{\\perp,m}^2 = v_{\\perp,0}^2 \\frac{B_m}{B_0} = R v_{\\perp,0}^2 $$\n其中 $R \\equiv B_m/B_0$ 是磁镜比。\n\n现在，我们将其代入能量守恒方程，求出磁喉处的平行速度：\n$$ v_{\\parallel,0}^2 + v_{\\perp,0}^2 = v_{\\parallel,m}^2 + R v_{\\perp,0}^2 $$\n$$ v_{\\parallel,m}^2 = v_{\\parallel,0}^2 + v_{\\perp,0}^2 - R v_{\\perp,0}^2 = v_{\\parallel,0}^2 - (R-1)v_{\\perp,0}^2 $$\n\n如果一个粒子到达磁喉时具有实值的平行速度，即 $v_{\\parallel,m}^2 \\ge 0$，它就可以逃离磁镜。这给出了粒子处于“损失锥”中的条件：\n$$ v_{\\parallel,0}^2 - (R-1)v_{\\perp,0}^2 \\ge 0 $$\n$$ \\frac{v_{\\perp,0}^2}{v_{\\parallel,0}^2} \\le \\frac{1}{R-1} $$\n这个不等式定义了中平面速度空间中对应于损失轨道上粒子的区域。\n\n接下来，我们计算满足此条件的粒子比例。中平面的分布函数是双麦克斯韦分布：\n$$ f(v_{\\perp,0}, v_{\\parallel,0}) = C \\exp\\left(-\\frac{m v_{\\perp,0}^2}{2 k_B T_{\\perp}} - \\frac{m v_{\\parallel,0}^2}{2 k_B T_{\\parallel}}\\right) $$\n其中 $C$ 是归一化常数，$k_B$ 是玻尔兹曼常数，$T_{\\perp}$ 和 $T_{\\parallel}$ 分别是垂直和平行温度。\n\n损失粒子的比例 $F_{loss}$ 是损失锥中粒子数 $N_{loss}$ 与总粒子数 $N_{total}$ 之比。我们可以通过在速度空间的适当区域上对分布函数进行积分来计算这些值。我们在速度空间中使用柱坐标 $(v_{\\perp,0}, \\phi, v_{\\parallel,0})$，其中体积元为 $d^3v_0 = 2\\pi v_{\\perp,0} dv_{\\perp,0} dv_{\\parallel,0}$。\n\n总粒子数通过对整个速度空间积分得到：\n$$ N_{total} = \\int_{-\\infty}^{\\infty} dv_{\\parallel,0} \\int_0^{\\infty} 2\\pi v_{\\perp,0} dv_{\\perp,0} \\ f(v_{\\perp,0}, v_{\\parallel,0}) $$\n$$ N_{total} = 2\\pi C \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m v_{\\parallel,0}^2}{2 k_B T_{\\parallel}}\\right) dv_{\\parallel,0} \\int_0^{\\infty} v_{\\perp,0} \\exp\\left(-\\frac{m v_{\\perp,0}^2}{2 k_B T_{\\perp}}\\right) dv_{\\perp,0} $$\n对 $v_{\\perp,0}$ 的积分计算结果为：\n$$ \\int_0^{\\infty} v_{\\perp,0} \\exp\\left(-\\frac{m v_{\\perp,0}^2}{2 k_B T_{\\perp}}\\right) dv_{\\perp,0} = \\left[-\\frac{k_B T_{\\perp}}{m} \\exp\\left(-\\frac{m v_{\\perp,0}^2}{2 k_B T_{\\perp}}\\right)\\right]_0^{\\infty} = \\frac{k_B T_{\\perp}}{m} $$\n对 $v_{\\parallel,0}$ 的积分是一个标准的高斯积分：\n$$ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m v_{\\parallel,0}^2}{2 k_B T_{\\parallel}}\\right) dv_{\\parallel,0} = \\sqrt{\\frac{2\\pi k_B T_{\\parallel}}{m}} $$\n因此，总粒子数正比于：\n$$ N_{total} = 2\\pi C \\left(\\frac{k_B T_{\\perp}}{m}\\right) \\sqrt{\\frac{2\\pi k_B T_{\\parallel}}{m}} $$\n\n损失的粒子数通过对损失锥区域 $|v_{\\parallel,0}| \\ge \\sqrt{R-1} v_{\\perp,0}$（等价于 $v_{\\perp,0} \\le |v_{\\parallel,0}|/\\sqrt{R-1}$）积分得到：\n$$ N_{loss} = \\int_{-\\infty}^{\\infty} dv_{\\parallel,0} \\int_0^{|v_{\\parallel,0}|/\\sqrt{R-1}} 2\\pi v_{\\perp,0} dv_{\\perp,0} \\ f(v_{\\perp,0}, v_{\\parallel,0}) $$\n$$ N_{loss} = 2\\pi C \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m v_{\\parallel,0}^2}{2 k_B T_{\\parallel}}\\right) dv_{\\parallel,0} \\int_0^{|v_{\\parallel,0}|/\\sqrt{R-1}} v_{\\perp,0} \\exp\\left(-\\frac{m v_{\\perp,0}^2}{2 k_B T_{\\perp}}\\right) dv_{\\perp,0} $$\n内部对 $v_{\\perp,0}$ 的积分计算结果为：\n$$ \\int_0^{|v_{\\parallel,0}|/\\sqrt{R-1}} v_{\\perp,0} \\exp\\left(-\\frac{m v_{\\perp,0}^2}{2 k_B T_{\\perp}}\\right) dv_{\\perp,0} = \\frac{k_B T_{\\perp}}{m} \\left[1 - \\exp\\left(-\\frac{m v_{\\parallel,0}^2}{2 k_B T_{\\perp}(R-1)}\\right)\\right] $$\n将此结果代回，我们得到：\n$$ N_{loss} = 2\\pi C \\frac{k_B T_{\\perp}}{m} \\int_{-\\infty}^{\\infty} \\left[ \\exp\\left(-\\frac{m v_{\\parallel,0}^2}{2 k_B T_{\\parallel}}\\right) - \\exp\\left(-\\frac{m v_{\\parallel,0}^2}{2 k_B T_{\\parallel}} - \\frac{m v_{\\parallel,0}^2}{2 k_B T_{\\perp}(R-1)}\\right) \\right] dv_{\\parallel,0} $$\n第二项中的指数可以重写为：\n$$ -\\frac{m v_{\\parallel,0}^2}{2 k_B} \\left(\\frac{1}{T_{\\parallel}} + \\frac{1}{T_{\\perp}(R-1)}\\right) = -\\frac{m v_{\\parallel,0}^2}{2 k_B T_{\\parallel}} \\left(1 + \\frac{T_{\\parallel}}{T_{\\perp}(R-1)}\\right) = -\\frac{m v_{\\parallel,0}^2}{2 k_B T_{\\parallel}} \\left(1 + \\frac{1}{A(R-1)}\\right) $$\n其中 $A \\equiv T_{\\perp}/T_{\\parallel}$ 是各向异性。再次使用高斯积分公式：\n$$ N_{loss} = 2\\pi C \\frac{k_B T_{\\perp}}{m} \\left[ \\sqrt{\\frac{2\\pi k_B T_{\\parallel}}{m}} - \\sqrt{\\frac{2\\pi k_B T_{\\parallel}/m}{1 + \\frac{1}{A(R-1)}}} \\right] $$\n$$ N_{loss} = 2\\pi C \\frac{k_B T_{\\perp}}{m} \\sqrt{\\frac{2\\pi k_B T_{\\parallel}}{m}} \\left[ 1 - \\frac{1}{\\sqrt{1 + \\frac{1}{A(R-1)}}} \\right] $$\n\n损失粒子的比例为 $F_{loss} = N_{loss} / N_{total}$：\n$$ F_{loss} = \\frac{2\\pi C \\frac{k_B T_{\\perp}}{m} \\sqrt{\\frac{2\\pi k_B T_{\\parallel}}{m}} \\left[ 1 - \\frac{1}{\\sqrt{1 + \\frac{1}{A(R-1)}}} \\right]}{2\\pi C \\frac{k_B T_{\\perp}}{m} \\sqrt{\\frac{2\\pi k_B T_{\\parallel}}{m}}} $$\n$$ F_{loss} = 1 - \\frac{1}{\\sqrt{1 + \\frac{1}{A(R-1)}}} $$\n这个表达式可以通过合并平方根下的项来简化：\n$$ F_{loss} = 1 - \\sqrt{\\frac{A(R-1)}{A(R-1)+1}} $$\n这是损失轨道上粒子比例关于各向异性 $A$ 和磁镜比 $R$ 的最终闭式表达式。\n\n### 第 (2) 部分：讨论\n\n推导出的表达式 $F_{loss} = 1 - \\sqrt{\\frac{A(R-1)}{A(R-1)+1}}$ 量化了约束粒子比例 $F_{trap} = 1 - F_{loss}$ 如何依赖于温度各向异性 $A = T_{\\perp}/T_{\\parallel}$。对于固定的磁镜比 $R > 1$，随着各向异性 $A$ 的增加，项 $\\frac{A(R-1)}{A(R-1)+1}$ 增加并趋近于 $1$。因此，$F_{trap}$ 增加，而损失轨道上的粒子比例 $F_{loss}$ 减少。物理上，更高的各向异性意味着粒子平均有更多的能量用于垂直运动。由于磁矩 $\\mu \\propto v_{\\perp}^2$ 守恒，这些粒子在接近强磁场区域时会经历更强的排斥性磁镜力 $-\\mu \\nabla_{\\parallel} B$。这增加了它们被反射的可能性，从而改善了约束并减少了损失锥的布居。\n\n这种效应与磁镜模不稳定性有着内在的联系。在一个简单的磁镜中，投掷角较小（即 $v_{\\perp}/v_{\\parallel}$ 较低）的粒子会优先损失。这种选择性损失过程自然会导致被约束的等离子体布居产生 $T_{\\perp} > T_{\\parallel}$（即 $A > 1$）的温度各向异性。然而，如果这种各向异性变得过大，它会驱动等离子体对磁镜模不稳定性变得不稳定。普遍接受的这种不稳定性起始判据是 $A > 1 + 1/\\beta_{\\perp}$，其中 $\\beta_{\\perp}$ 是垂直等离子体压强与磁压之比。\n\n当磁镜不稳定性被激发时，它会产生磁场涨落。这些涨落破坏了磁矩 $\\mu$ 守恒的条件。由此产生的波-粒子相互作用会在速度空间中散射粒子，主要作用是减小它们的投掷角（将能量从垂直运动转移到平行运动）。这个散射过程降低了温度各向异性 $A$。\n\n因此建立了一个反馈回路：\n1. 优先的端部损失增加了被捕获等离子体的各向异性 $A$。\n2. 当 $A$ 超过不稳定性阈值时，磁镜模不稳定性增长。\n3. 不稳定性引起投掷角散射，这会填充损失锥并减小 $A$。\n4. $A$ 的减小会增加端部损失率（如我们的公式所示），并将系统推回到临界稳定状态。\n这种自调节机制限制了可实现的最大各向异性，因此也限制了简单磁镜构型中的约束质量。等离子体约束最终不仅由经典碰撞决定，还由不稳定性驱动的向损失锥散射的速率决定。",
            "answer": "$$\\boxed{1 - \\sqrt{\\frac{A(R-1)}{A(R-1)+1}}}$$"
        },
        {
            "introduction": "实际上，磁镜中的约束并非无限，因为碰撞和微观不稳定性可以将粒子散射到损失锥中。这最后一个更高级的练习通过将弱碰撞散射建模为螺距角空间中的扩散过程，引入了时间依赖性。通过计算一个粒子在逃逸前完成一次弹跳的概率 ，你将对表征所有真实世界磁镜系统的有限约束时间有更深刻的理解。",
            "id": "4007073",
            "problem": "考虑带电粒子在静态、轴对称磁镜中的运动，该磁镜在中平面 $s=0$ 处有最小磁场 $B_{\\min}$，在 $s=\\pm L$ 处有最大磁场 $B_{\\max}$，磁镜比 $R_m = B_{\\max}/B_{\\min}  1$。一个粒子以速度 $v$ 和螺距角 $\\alpha_0$（速度与磁场之间的夹角）在 $s=0$ 处注入，满足 $\\alpha_0  \\alpha_c$，其中 $\\alpha_c$ 是与中平面相关的损失锥角。假设在一个弹跳周期内，导心近似和第一绝热不变量（磁矩）守恒成立，并且碰撞引起的弱螺距角散射可以模型化为 $\\alpha$ 中的一维扩散。\n\n基本原理：\n- 洛伦兹力定律决定了带电粒子的运动，在强磁场和沿磁力线缓慢变化的条件下，导心动力学适用。\n- 当场的变化和碰撞在一个弹跳时间内很弱时，第一绝热不变量（磁矩） $\\mu = m v_{\\perp}^2/(2 B)$ 是守恒的。\n- 损失锥由 $s=0$ 处的阈值螺距角 $\\alpha_c$ 定义，使得螺距角为 $\\alpha_0 \\le \\alpha_c$ 的粒子不会被反射并逃逸到端区；$\\alpha_c$ 通过 $\\mu$ 的不变性依赖于 $R_m$ 和 $B_{\\min}$。\n- 弱螺距角散射被模型化为在 $\\alpha$ 中的扩散，扩散系数为 $D_{\\alpha}$（单位为 $\\mathrm{rad}^2/\\mathrm{s}$），这导致一个在 $\\alpha$ 中的福克-普朗克方程，并在 $\\alpha = \\alpha_c$ 处有一个吸收边界。\n\n几何结构：\n- 设沿磁力线的磁场分布为 $B(s) = B_{\\min} \\left[ 1 + \\left( R_m - 1 \\right) \\left( \\frac{s}{L} \\right)^2 \\right]$，对于 $s \\in [-L, L]$，该分布在远离中平面时是单调的，并在 $s = \\pm L$ 处达到 $B_{\\max} = B_{\\min} R_m$。\n\n任务：\n1. 利用磁矩守恒和给定的 $B(s)$，推导从中平面 $s=0$ 处以注入螺距角 $\\alpha_0$ 开始的平行速度 $v_{\\parallel}(s)$ 沿磁力线的时间演化。从第一性原理出发，得到首次磁镜反射所需时间（半个弹跳时间）$T_{\\mathrm{ref}}$ 作为 $v$, $L$, $R_m$ 和 $\\alpha_0$ 的函数表达式。\n2. 将弱螺距角扩散模型化为 $\\alpha(t)$ 中的一维布朗运动，扩散系数为 $D_{\\alpha}$，在 $\\alpha = \\alpha_c$ 处有吸收边界。利用扩散的基本性质和福克-普朗克方程，确定从 $\\alpha_0$ 开始的粒子在时间 $t$ 之前尚未进入损失锥的存活概率 $S(t)$。\n3. 结合以上结果，计算在逃逸前发生瞬态磁镜反射的概率，即从损失锥外侧刚开始的 $\\alpha_0$ 出发，粒子在 $\\alpha$ 坐标下存活到首次磁镜反射时间 $T_{\\mathrm{ref}}$ 的概率。将该概率表示为十进制浮点数。\n\n数值约束和单位：\n- 角度必须以弧度表示。\n- 磁场值必须以 $\\mathrm{T}$ (特斯拉) 为单位。\n- 速度必须以 $\\mathrm{m/s}$ 为单位。\n- 长度 $L$ 必须以 $\\mathrm{m}$ (米) 为单位。\n- 扩散系数 $D_{\\alpha}$ 必须以 $\\mathrm{rad}^2/\\mathrm{s}$ 为单位。\n- 对于每个测试用例，使用源于磁矩守恒的物理定义，从磁镜比 $R_m$ 计算损失锥角 $\\alpha_c$。\n- 对于弱扩散，可以假设 $D_{\\alpha}$ 小到足以使导心近似在半个弹跳时间内保持有效。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果 (例如, $[result_1,result_2,result_3]$)。\n- 每个结果必须是逃逸前至少发生一次瞬态反射的概率，表示为四舍五入到六位小数的十进制浮点数，不带单位。\n\n测试套件：\n为以下参数集实现您的解决方案。在每个元组中，参数按 $(B_{\\min}, R_m, L, v, \\delta, D_{\\alpha})$ 的顺序排列，其中 $\\delta$ 是正偏移量，使得 $\\alpha_0 = \\alpha_c + \\delta$。\n\n- 案例A（通用理想路径）：$(1.5, 5.0, 1.0, 1.2\\times 10^6, 0.02, 1.0\\times 10^{-3})$\n- 案例B（近边界螺距角和更强扩散）：$(1.5, 5.0, 1.0, 8.0\\times 10^5, 1.0\\times 10^{-4}, 5.0\\times 10^{-3})$\n- 案例C（更高磁镜比和更长设备）：$(2.0, 10.0, 1.2, 1.0\\times 10^6, 0.015, 1.0\\times 10^{-3})$\n- 案例D（较慢粒子，中等磁镜比）：$(1.0, 6.0, 0.8, 2.0\\times 10^5, 0.025, 1.0\\times 10^{-3})$\n- 案例E（极弱扩散）：$(1.2, 4.0, 0.9, 1.5\\times 10^6, 0.01, 1.0\\times 10^{-5})$\n\n对于每个案例：\n- 根据 $R_m$ 计算 $\\alpha_c$ (以弧度为单位)。\n- 设置 $\\alpha_0 = \\alpha_c + \\delta$。\n- 计算 $T_{\\mathrm{ref}}$ (以秒为单位)。\n- 使用在 $t = T_{\\mathrm{ref}}$ 时的存活概率，计算在逃逸前至少发生一次瞬态磁镜反射的概率。\n\n您的程序必须按照上面测试套件案例的相同顺序，以指定的单行格式输出五个概率，四舍五入到六位小数。",
            "solution": "该问题经检验在科学上是合理的、提法得当且客观的。它基于等离子体物理学的既定原理，特别是磁镜约束，并且没有任何可指出的缺陷。因此，我们可以着手解决。\n\n按照要求，解决方案分三个阶段展开：首先，推导粒子的半个弹跳时间；其次，建立螺距角扩散下的存活概率公式；第三，结合这些结果计算最终概率。\n\n**第1部分：半个弹跳时间, $T_{\\mathrm{ref}}$**\n\n带电粒子在静态磁场中的运动使其动能 $E = \\frac{1}{2}mv^2$ 守恒，这意味着其速率 $v$ 是恒定的。在缓慢变化的磁场中，第一绝热不变量，即磁矩 $\\mu = \\frac{mv_\\perp^2}{2B}$，也是守恒的。这里，$v_\\perp$ 是速度垂直于磁力线的分量，$B$ 是磁场强度。\n\n在中平面 ($s=0$)，磁场为 $B(0) = B_{\\min}$，粒子的速度 $v$ 有一个螺距角 $\\alpha_0$。垂直速度为 $v_{\\perp,0} = v \\sin \\alpha_0$。因此，磁矩固定为 $\\mu = \\frac{m(v \\sin \\alpha_0)^2}{2B_{\\min}}$。\n\n在沿磁力线的任何其他点 $s$，$\\mu$ 的守恒意味着 $\\frac{mv_\\perp(s)^2}{2B(s)} = \\frac{m(v \\sin \\alpha_0)^2}{2B_{\\min}}$。这给出了在 $s$ 处的垂直速度：\n$$v_\\perp(s)^2 = v^2 \\sin^2 \\alpha_0 \\frac{B(s)}{B_{\\min}}$$\n根据能量守恒，$v^2 = v_\\parallel(s)^2 + v_\\perp(s)^2$，平行速度 $v_\\parallel(s)$ 为：\n$$v_\\parallel(s)^2 = v^2 - v_\\perp(s)^2 = v^2 \\left( 1 - \\frac{B(s)}{B_{\\min}} \\sin^2 \\alpha_0 \\right)$$\n如果粒子在到达最大磁场 $B_{\\max}$ 之前被反射，它就被捕获。反射发生在转折点 $s_{tp}$，此处 $v_\\parallel(s_{tp}) = 0$。这要求 $1 - \\frac{B(s_{tp})}{B_{\\min}}\\sin^2 \\alpha_0 = 0$，或 $B(s_{tp}) = B_{\\min}/\\sin^2 \\alpha_0$。为使粒子被约束，我们必须有 $B(s_{tp}) \\le B_{\\max}$，这导致条件 $\\sin^2 \\alpha_0 \\ge B_{\\min}/B_{\\max} = 1/R_m$。中平面处的临界损失锥角 $\\alpha_c$ 由该条件的边界定义：\n$$\\sin \\alpha_c = \\frac{1}{\\sqrt{R_m}} \\implies \\alpha_c = \\arcsin\\left(\\frac{1}{\\sqrt{R_m}}\\right)$$\n螺距角 $\\alpha_0  \\alpha_c$ 的粒子被捕获。\n\n为了找到半个弹跳时间 $T_{\\mathrm{ref}}$，我们将时间微分 $dt = ds/v_\\parallel(s)$ 从中平面 ($s=0$) 积分到转折点 ($s_{tp}$)。我们将给定的磁场分布 $B(s) = B_{\\min} \\left[ 1 + (R_m-1)(s/L)^2 \\right]$ 代入 $v_\\parallel(s)$ 的表达式中：\n$$v_\\parallel(s) = v \\sqrt{1 - \\left(1 + (R_m-1)\\frac{s^2}{L^2}\\right) \\sin^2 \\alpha_0} = v \\sqrt{\\cos^2\\alpha_0 - (R_m-1)\\sin^2\\alpha_0 \\frac{s^2}{L^2}}$$\n$$T_{\\mathrm{ref}} = \\int_0^{s_{tp}} \\frac{ds}{v_\\parallel(s)} = \\frac{1}{v} \\int_0^{s_{tp}} \\frac{ds}{\\sqrt{\\cos^2\\alpha_0 - (R_m-1)\\sin^2\\alpha_0 \\frac{s^2}{L^2}}}$$\n转折点 $s_{tp}$ 是平方根下项为零的地方： $s_{tp} = \\frac{L \\cos\\alpha_0}{\\sqrt{R_m-1}\\sin\\alpha_0}$。\n该积分为标准形式。令 $s = s_{tp} \\sin\\theta$。积分的计算结果为：\n$$T_{\\mathrm{ref}} = \\frac{L}{v \\sin\\alpha_0 \\sqrt{R_m-1}} \\int_0^{\\pi/2} d\\theta = \\frac{\\pi L}{2v \\sqrt{R_m-1} \\sin\\alpha_0}$$\n\n**第2部分：存活概率, $S(t)$**\n\n弱螺距角散射被模型化为螺距角坐标 $\\alpha$ 中的一维扩散过程。概率密度 $P(\\alpha, t)$ 的演化由扩散方程描述：\n$$\\frac{\\partial P}{\\partial t} = D_\\alpha \\frac{\\partial^2 P}{\\partial \\alpha^2}$$\n其中 $D_\\alpha$ 是给定的常数扩散系数。如果粒子的螺距角散射进入损失锥，即如果 $\\alpha \\le \\alpha_c$，则粒子丢失。这在 $\\alpha = \\alpha_c$ 处建立了一个吸收边界。粒子从 $\\alpha_0 = \\alpha_c + \\delta$ 开始。我们可以通过平移坐标系来简化：令 $x = \\alpha - \\alpha_c$。粒子从 $x_0 = \\delta$ 开始，在 $x=0$ 处有一个吸收边界。$\\alpha$ 的物理域是 $[\\alpha_c, \\pi/2]$，因此 $x$ 的物理域是 $[0, \\pi/2 - \\alpha_c]$。然而，对于弱扩散，首次反射的时间 $T_{\\mathrm{ref}}$ 通常远短于粒子扩散到像 $\\pi/2$ 这样大得多的角度所需的时间。因此，我们可以将系统精确地模型化为在半无限域 $x \\in [0, \\infty)$ 中的扩散，这是一个标准的教科书问题。\n\n对于初始条件 $P(x,0) = \\delta_{\\text{Dirac}}(x-x_0)$ 和吸收边界 $P(0,t)=0$，概率密度 $P(x,t)$ 的解可以使用镜像法找到：\n$$P(x,t) = \\frac{1}{\\sqrt{4\\pi D_\\alpha t}} \\left( e^{-\\frac{(x-x_0)^2}{4D_\\alpha t}} - e^{-\\frac{(x+x_0)^2}{4D_\\alpha t}} \\right)$$\n存活概率 $S(t)$ 是在时间 $t$ 在允许区域内找到粒子的总概率：\n$$S(t) = \\int_0^\\infty P(x,t) dx$$\n对 $P(x,t)$ 的表达式进行积分，得到以误差函数 $\\mathrm{erf}(z)$ 表示的解：\n$$S(t) = \\mathrm{erf}\\left(\\frac{x_0}{\\sqrt{4D_\\alpha t}}\\right)$$\n\n**第3部分：最终计算**\n\n问题要求计算粒子在逃逸前经历至少一次磁镜反射的概率。这恰好是粒子在扩散散射过程中存活时间等于到达第一个反射点所需时间 $T_{\\mathrm{ref}}$ 的概率。我们将第1部分和第2部分的结果结合起来，通过将 $t = T_{\\mathrm{ref}}$ 和 $x_0 = \\delta$ 代入存活概率方程：\n$$P_{\\mathrm{reflect}} = S(T_{\\mathrm{ref}}) = \\mathrm{erf}\\left(\\frac{\\delta}{\\sqrt{4 D_\\alpha T_{\\mathrm{ref}}}}\\right)$$\n\n每个测试用例的算法如下：\n1.  给定 $R_m$，计算损失锥角 $\\alpha_c = \\arcsin(1/\\sqrt{R_m})$。\n2.  给定 $\\delta$，计算初始螺距角 $\\alpha_0 = \\alpha_c + \\delta$。\n3.  给定 $L$, $v$, $R_m$ 和计算出的 $\\alpha_0$，计算半个弹跳时间 $T_{\\mathrm{ref}} = \\frac{\\pi L}{2v \\sqrt{R_m-1} \\sin\\alpha_0}$。\n4.  给定 $D_\\alpha$, $\\delta$ 和计算出的 $T_{\\mathrm{ref}}$，计算最终概率 $P_{\\mathrm{reflect}} = \\mathrm{erf}\\left(\\frac{\\delta}{\\sqrt{4 D_\\alpha T_{\\mathrm{ref}}}}\\right)$。\n\n将此方法应用于每个测试用例以产生最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes the probability of a transient mirror reflection for a charged particle\n    in a magnetic mirror, considering pitch-angle diffusion.\n    \"\"\"\n\n    # Test cases are tuples of (B_min, R_m, L, v, delta, D_alpha)\n    # B_min is not directly used in the final formulas but is part of the problem context.\n    test_cases = [\n        # Case A (general happy path)\n        (1.5, 5.0, 1.0, 1.2e6, 0.02, 1.0e-3),\n        # Case B (near-boundary pitch angle and stronger diffusion)\n        (1.5, 5.0, 1.0, 8.0e5, 1.0e-4, 5.0e-3),\n        # Case C (higher mirror ratio and longer device)\n        (2.0, 10.0, 1.2, 1.0e6, 0.015, 1.0e-3),\n        # Case D (slower particle, moderate mirror ratio)\n        (1.0, 6.0, 0.8, 2.0e5, 0.025, 1.0e-3),\n        # Case E (very weak diffusion)\n        (1.2, 4.0, 0.9, 1.5e6, 0.01, 1.0e-5),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        B_min, R_m, L, v, delta, D_alpha = case\n\n        # 1. Compute the loss-cone angle alpha_c in radians from the mirror ratio R_m.\n        # The condition for reflection is sin^2(alpha_0) = 1/R_m.\n        # The loss cone angle is the boundary of this condition.\n        alpha_c = np.arcsin(1.0 / np.sqrt(R_m))\n\n        # 2. Set the initial pitch angle alpha_0.\n        alpha_0 = alpha_c + delta\n\n        # 3. Compute the half-bounce time T_ref in seconds.\n        # This is derived from integrating ds/v_parallel for a parabolic B-field.\n        # T_ref = (pi * L) / (2 * v * sqrt(R_m - 1) * sin(alpha_0))\n        T_ref = (np.pi * L) / (2 * v * np.sqrt(R_m - 1) * np.sin(alpha_0))\n\n        # 4. Compute the survival probability at t = T_ref.\n        # This is modeled as 1D diffusion in a semi-infinite domain with an\n        # absorbing boundary. The survival probability S(t) for a particle\n        # starting at a distance 'delta' from the boundary is:\n        # S(t) = erf(delta / sqrt(4 * D_alpha * t))\n        \n        # Argument of the error function\n        denominator_squared = 4 * D_alpha * T_ref\n        \n        # Handle edge cases where denominator is zero or negative, although\n        # physically impossible with the given constraints.\n        if denominator_squared == 0:\n            # If D_alpha or T_ref is zero, there is no diffusion or time to diffuse,\n            # so survival probability is 1.\n            prob = 1.0\n        else:\n            argument = delta / np.sqrt(denominator_squared)\n            prob = erf(argument)\n        \n        results.append(prob)\n\n    # Format the results to exactly six decimal places and join into a single string.\n    formatted_results = [f'{r:.6f}' for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}