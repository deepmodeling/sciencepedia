{
    "hands_on_practices": [
        {
            "introduction": "设计任何聚变装置的第一步都是理解其基本的能量需求。本练习将引导你估算将聚变燃料加热到点火温度所需的最小驱动能量。通过建立一个考虑了等离子体内部热能和韧致辐射等不可避免的能量损失的能量平衡模型，你可以掌握评估一种聚变概念可行性的基础分析方法。",
            "id": "3950883",
            "problem": "一个柱状的氘-氚燃料柱在磁化套筒惯性聚变 (MagLIF) 构型下被预热，这是一种典型的磁惯性聚变 (MIF) 方案。假设燃料在空间上是均匀的、完全电离的，并且对其自身的韧致辐射是光学薄的。该柱体长度为 $L = 5\\,\\mathrm{mm}$，半径为 $R = 2\\,\\mathrm{mm}$，总粒子数密度（电子和离子的总和）为 $n = 1.0\\times 10^{23}\\,\\mathrm{m}^{-3}$。离子电荷数为 $Z=1$。预热驱动器在 $\\tau = 100\\,\\mathrm{ns}$ 的脉冲持续时间内，将等离子体温度从 $0$ 提高到最终值 $T = 5\\,\\mathrm{keV}$，温度随时间线性增加，即 $T(t) = T\\, t/\\tau$ (对于 $0 \\le t \\le \\tau$)。为了获得一个下限估计，诸如热传导和端部损失等非辐射损失被忽略。\n\n从能量守恒出发，所需的最小驱动能量是加热时间内内能的增加量与韧致辐射损失之和。使用能量均分假设 $T_e = T_i = T$，因此内能的增加是两种粒子的内能增加之和。对于光学薄的自由-自由发射，单位体积的韧致辐射功率密度形式为 $P_{\\mathrm{br}}(t) = C\\, n_e n_i Z^2 \\sqrt{T(t)}$，其中 $C = 1.69\\times 10^{-38} g_B\\,\\mathrm{W\\,m^3\\,K^{-1/2}}$，Gaunt 因子 $g_B = 1.2$。对于 $Z=1$ 的情况，根据电准中性条件，有 $n_e = n_i = n/2$。将等离子体体积视为 $V = \\pi R^2 L$，并使用 $k_B T = (\\text{每个粒子的能量})$ 的关系将温度 $T$ 从 $\\mathrm{keV}$ 转换为 $\\mathrm{K}$，其中 $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$，玻尔兹曼常数 $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$。\n\n推导所需驱动能量的表达式，并根据给定参数进行数值计算。用 $\\mathrm{kJ}$ 作单位表示最终能量，并将您的答案四舍五入到三位有效数字。",
            "solution": "问题要求计算预热一个柱状氘-氚燃料柱所需的最小驱动能量。该能量是等离子体内能的增加量与加热过程中因韧致辐射而损失的能量之和。我们首先写出主导的能量守恒方程：\n$$\nE_{\\mathrm{driver}} = \\Delta E_{\\mathrm{thermal}} + E_{\\mathrm{rad}}\n$$\n其中 $\\Delta E_{\\mathrm{thermal}}$ 是等离子体总内能的变化量，而 $E_{\\mathrm{rad}}$ 是辐射掉的总能量。我们将为每一项推导一个表达式，然后将它们相加来求得总驱动能量。\n\n首先，我们计算内能的变化量 $\\Delta E_{\\mathrm{thermal}}$。等离子体由电子和离子组成，对于理想气体，其内能由 $E_{\\mathrm{thermal}} = \\frac{3}{2} N k_B T$ 给出，其中 $N$ 是总粒子数， $k_B$ 是玻尔兹曼常数，$T$ 是温度。总粒子数是总粒子数密度 $n$ 乘以等离子体体积 $V$。柱体的体积是 $V = \\pi R^2 L$。因此，$N = nV = n\\pi R^2 L$。\n\n内能的变化量是最终能量减去初始能量：\n$$\n\\Delta E_{\\mathrm{thermal}} = E_{\\mathrm{thermal, final}} - E_{\\mathrm{thermal, initial}} = \\frac{3}{2} N k_B T_f - \\frac{3}{2} N k_B T(0)\n$$\n问题说明加热从温度 $0$ 开始，所以 $T(0) = 0$。最终温度记为 $T_f$。因此，内能的变化量就是最终的内能：\n$$\n\\Delta E_{\\mathrm{thermal}} = \\frac{3}{2} N k_B T_f = \\frac{3}{2} (n \\pi R^2 L) k_B T_f\n$$\n注意，量 $k_B T_f$ 代表每个粒子的最终热能，给定值为 $5\\,\\mathrm{keV}$。\n\n接下来，我们计算总辐射能量 $E_{\\mathrm{rad}}$。该能量是总辐射功率 $P_{\\mathrm{rad}}(t)$ 在加热脉冲持续时间 $\\tau$ 内的时间积分。\n$$\nE_{\\mathrm{rad}} = \\int_0^\\tau P_{\\mathrm{rad}}(t)\\,dt\n$$\n总功率是单位体积的功率密度 $P_{\\mathrm{br}}(t)$ 乘以等离子体体积 $V$。\n$$\nP_{\\mathrm{rad}}(t) = V \\cdot P_{\\mathrm{br}}(t) = (\\pi R^2 L) P_{\\mathrm{br}}(t)\n$$\n单位体积的韧致辐射功率密度由 $P_{\\mathrm{br}}(t) = C n_e n_i Z^2 \\sqrt{T(t)}$ 给出。对于带单电荷离子 ($Z=1$) 的电准中性等离子体，电子密度 $n_e$ 和离子密度 $n_i$ 都等于总粒子密度 $n$ 的一半，即 $n_e = n_i = n/2$。将这些代入功率密度表达式，得到：\n$$\nP_{\\mathrm{br}}(t) = C \\left(\\frac{n}{2}\\right) \\left(\\frac{n}{2}\\right) (1)^2 \\sqrt{T(t)} = \\frac{1}{4} C n^2 \\sqrt{T(t)}\n$$\n温度随时间线性增加，关系式为 $T(t) = T_f \\frac{t}{\\tau}$ (对于 $0 \\le t \\le \\tau$)。将此代入 $P_{\\mathrm{br}}(t)$ 的表达式，得到：\n$$\nP_{\\mathrm{br}}(t) = \\frac{1}{4} C n^2 \\sqrt{T_f \\frac{t}{\\tau}} = \\frac{C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} t^{1/2}\n$$\n现在，我们可以将总功率 $P_{\\mathrm{rad}}(t) = V \\cdot P_{\\mathrm{br}}(t)$ 从 $t=0$ 到 $t=\\tau$ 进行积分：\n$$\nE_{\\mathrm{rad}} = \\int_0^\\tau (\\pi R^2 L) \\left( \\frac{C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} t^{1/2} \\right) dt\n$$\n与 $t$ 无关的项可以移到积分号外：\n$$\nE_{\\mathrm{rad}} = \\frac{\\pi R^2 L C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} \\int_0^\\tau t^{1/2} dt\n$$\n$t^{1/2}$ 的积分是 $\\frac{2}{3} t^{3/2}$。对其从 $0$ 到 $\\tau$ 求值：\n$$\n\\int_0^\\tau t^{1/2} dt = \\left[ \\frac{2}{3} t^{3/2} \\right]_0^\\tau = \\frac{2}{3} \\tau^{3/2}\n$$\n将此结果代回 $E_{\\mathrm{rad}}$ 的表达式中：\n$$\nE_{\\mathrm{rad}} = \\frac{\\pi R^2 L C n^2 \\sqrt{T_f}}{4\\sqrt{\\tau}} \\left( \\frac{2}{3} \\tau^{3/2} \\right) = \\frac{2}{12} (\\pi R^2 L) C n^2 \\sqrt{T_f} \\frac{\\tau^{3/2}}{\\tau^{1/2}}\n$$\n$$\nE_{\\mathrm{rad}} = \\frac{1}{6} (\\pi R^2 L) C n^2 \\tau \\sqrt{T_f}\n$$\n所需的总驱动能量是这两个分量的和：\n$$\nE_{\\mathrm{driver}} = \\frac{3}{2} n (\\pi R^2 L) k_B T_f + \\frac{1}{6} (\\pi R^2 L) C n^2 \\tau \\sqrt{T_f}\n$$\n这是驱动能量的最终解析表达式。\n\n我们现在对该表达式进行数值计算。首先，我们以国际单位制（SI）列出给定的参数：\n- 长度: $L = 5\\,\\mathrm{mm} = 5 \\times 10^{-3}\\,\\mathrm{m}$\n- 半径: $R = 2\\,\\mathrm{mm} = 2 \\times 10^{-3}\\,\\mathrm{m}$\n- 总粒子密度: $n = 1.0 \\times 10^{23}\\,\\mathrm{m}^{-3}$\n- 最终温度（每个粒子的能量）: $E_p = 5\\,\\mathrm{keV} = 5 \\times 10^3\\,\\mathrm{eV} \\times (1.602176634\\times 10^{-19}\\,\\mathrm{J/eV}) = 8.01088 \\times 10^{-16}\\,\\mathrm{J}$。此项等效于 $k_B T_f$。\n- 脉冲持续时间: $\\tau = 100\\,\\mathrm{ns} = 1.0 \\times 10^{-7}\\,\\mathrm{s}$\n- 韧致辐射常数系数: $C_{base} = 1.69\\times 10^{-38}\\,\\mathrm{W\\,m^3\\,K^{-1/2}}$\n- Gaunt 因子: $g_B = 1.2$\n- 玻尔兹曼常数: $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$\n\n首先，我们计算常数和派生量：\n- 等离子体体积: $V = \\pi R^2 L = \\pi (2\\times 10^{-3}\\,\\mathrm{m})^2 (5\\times 10^{-3}\\,\\mathrm{m}) = 2\\pi \\times 10^{-8}\\,\\mathrm{m}^3$。\n- 以开尔文为单位的最终温度: $T_f = E_p / k_B = (8.01088 \\times 10^{-16}\\,\\mathrm{J}) / (1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) \\approx 5.8021 \\times 10^7\\,\\mathrm{K}$。\n- 包含 Gaunt 因子的韧致辐射常数: $C = C_{base} \\times g_B = (1.69\\times 10^{-38}) \\times 1.2 = 2.028 \\times 10^{-38}\\,\\mathrm{W\\,m^3\\,K^{-1/2}}$。\n\n现在我们计算两个能量项：\n- 内能增加量：\n$\\Delta E_{\\mathrm{thermal}} = \\frac{3}{2} n V (k_B T_f) = \\frac{3}{2} (1.0 \\times 10^{23}\\,\\mathrm{m}^{-3}) (2\\pi \\times 10^{-8}\\,\\mathrm{m}^3) (8.01088 \\times 10^{-16}\\,\\mathrm{J}) \\approx 7.5498\\,\\mathrm{J}$。\n\n- 辐射能量：\n$E_{\\mathrm{rad}} = \\frac{1}{6} V C n^2 \\tau \\sqrt{T_f}$\n$E_{\\mathrm{rad}} = \\frac{1}{6} (2\\pi \\times 10^{-8}) (2.028 \\times 10^{-38}) (1.0 \\times 10^{23})^2 (1.0 \\times 10^{-7}) \\sqrt{5.8021 \\times 10^7}$\n$E_{\\mathrm{rad}} \\approx \\frac{\\pi}{3} (10^{-8}) (2.028 \\times 10^{-38}) (10^{46}) (10^{-7}) (7.617 \\times 10^3) \\approx 0.001618\\,\\mathrm{J}$。\n\n总驱动能量是两者之和：\n$E_{\\mathrm{driver}} = \\Delta E_{\\mathrm{thermal}} + E_{\\mathrm{rad}} \\approx 7.5498\\,\\mathrm{J} + 0.001618\\,\\mathrm{J} \\approx 7.5514\\,\\mathrm{J}$。\n\n问题要求答案以千焦耳 ($\\mathrm{kJ}$) 为单位，并四舍五入到三位有效数字。\n$E_{\\mathrm{driver}} = 7.5514\\,\\mathrm{J} = 0.0075514\\,\\mathrm{kJ}$。\n四舍五入到三位有效数字，我们得到 $0.00755\\,\\mathrm{kJ}$。",
            "answer": "$$\\boxed{0.00755}$$"
        },
        {
            "introduction": "仅仅为等离子体提供能量是不够的，我们还必须有效地将其约束住，防止能量过快散失。本练习深入探讨了一种提高能量约束效率的关键机制：通过掺杂高原子序数（高$Z$）杂质来增加等离子体的不透明度，从而“囚禁”辐射能量。通过计算辐射能量的囚禁分数，你将能定量地评估这种方法的有效性，并理解辐射输运在稠密等离子体中的重要作用。",
            "id": "3950898",
            "problem": "考虑磁惯性聚变 (MIF) 概念这一更广泛类别中的磁化套筒惯性聚变 (MagLIF) 的一个预热阶段。一个圆柱状的氘-氚 (DT) 气体柱中掺杂了小质量分数的高原子序数物质，以增加其辐射不透明度。假设气体内的预热辐射场可以在相关光子能带上被建模为灰体和吸收主导的，且弹性散射可忽略不计。设辐射沿穿过介质的特征逃逸路径的衰减由路径上无源情况下的辐射转移方程决定，即 $\\frac{dI}{ds}=-\\alpha I$，其中 $I$ 是比强度，$s$ 是沿路径的空间坐标，$\\alpha$ 是吸收系数。在适用于光学厚输运的扩散近似中，取吸收系数为 $\\alpha=\\kappa_{R}\\rho$，其中 $\\kappa_{R}$ 是 Rosseland 平均不透明度，$\\rho$ 是介质的质量密度。在此框架下，估算在长度为 $\\ell$ 的单一特征直线路径上，被掺杂的 DT 混合物截留（吸收）的预热辐射能量的分数，并将此截留分数解释为该路径的预热能量保留分数。假设以下参数代表了类 MagLIF 预热：\n- Rosseland 平均不透明度 $\\kappa_{R}=5.0\\times 10^{3}\\,\\mathrm{cm^{2}/g}$\n- DT 质量密度 $\\rho=3.0\\times 10^{-4}\\,\\mathrm{g/cm^{3}}$\n- 路径长度 $\\ell=0.30\\,\\mathrm{cm}$\n计算保留分数，并以小数形式提供最终数值。将答案四舍五入到四位有效数字。保留分数不需要单位。",
            "solution": "该问题陈述已经过验证，被认为具有科学依据、适定且内部一致。它提出了一个基于已确立的辐射转移原理的可解物理问题。\n\n问题要求计算在一条特征路径上，被掺杂的氘-氚 (DT) 混合物截留（吸收）的预热辐射能量的分数。这个量被称为预热能量保留分数。辐射比强度 $I$ 沿长度为 $s$ 的路径的衰减由所给出的纯吸收介质的辐射转移方程决定：\n$$\n\\frac{dI}{ds} = -\\alpha I\n$$\n其中 $\\alpha$ 是吸收系数。这是一个一阶线性常微分方程。我们可以用分离变量法求解。设 $I_0$ 为路径起点的比强度，即 $I(s=0) = I_0$。\n$$\n\\frac{dI}{I} = -\\alpha ds\n$$\n对两边从路径起点 ($s=0$) 到沿路径距离为 $s$ 的位置进行积分，得到：\n$$\n\\int_{I_0}^{I(s)} \\frac{dI'}{I'} = \\int_{0}^{s} -\\alpha ds'\n$$\n假设吸收系数 $\\alpha$ 沿路径为常数，该积分得出：\n$$\n\\ln\\left(\\frac{I(s)}{I_0}\\right) = -\\alpha s\n$$\n对两边取指数，得到比强度作为距离函数的解：\n$$\nI(s) = I_0 \\exp(-\\alpha s)\n$$\n这个方程被称为比尔-朗伯定律。它描述了辐射在吸收介质中的指数衰减。量 $\\tau(s) = \\alpha s$ 是无量纲光学深度。\n\n问题要求计算在总长度为 $\\ell$ 的路径上截留的能量分数。成功穿过介质并在 $s=\\ell$ 处出射的辐射的比强度是 $I(\\ell) = I_0 \\exp(-\\alpha \\ell)$。\n透射的初始强度的分数是出射强度与初始强度的比值：\n$$\n\\text{Fraction Transmitted} = \\frac{I(\\ell)}{I_0} = \\exp(-\\alpha \\ell)\n$$\n能量保留分数，或称截留分数，是初始能量中未被透射，而是被介质吸收的部分。根据这个纯吸收系统中的能量守恒，这个分数等于 1 减去透射分数。\n$$\n\\text{Retention Fraction} = 1 - \\text{Fraction Transmitted} = 1 - \\exp(-\\alpha \\ell)\n$$\n问题在扩散近似中为吸收系数提供了一个模型：\n$$\n\\alpha = \\kappa_R \\rho\n$$\n其中 $\\kappa_R$ 是 Rosseland 平均不透明度，$\\rho$ 是质量密度。将其代入我们的保留分数表达式中，得到：\n$$\n\\text{Retention Fraction} = 1 - \\exp(-\\kappa_R \\rho \\ell)\n$$\n指数项 $\\tau = \\kappa_R \\rho \\ell$ 是路径的总光学深度。给定以下值：\n- Rosseland 平均不透明度：$\\kappa_{R} = 5.0 \\times 10^{3} \\, \\mathrm{cm^{2}/g}$\n- 质量密度：$\\rho = 3.0 \\times 10^{-4} \\, \\mathrm{g/cm^{3}}$\n- 路径长度：$\\ell = 0.30 \\, \\mathrm{cm}$\n\n首先，我们计算吸收系数 $\\alpha$：\n$$\n\\alpha = \\kappa_R \\rho = (5.0 \\times 10^{3} \\, \\mathrm{cm^{2}/g}) \\times (3.0 \\times 10^{-4} \\, \\mathrm{g/cm^{3}}) = 1.5 \\, \\mathrm{cm^{-1}}\n$$\n接下来，我们计算整个长度为 $\\ell$ 的路径的光学深度 $\\tau$：\n$$\n\\tau = \\alpha \\ell = (1.5 \\, \\mathrm{cm^{-1}}) \\times (0.30 \\, \\mathrm{cm}) = 0.45\n$$\n由于 $\\tau  1$，介质是光学薄的。现在我们可以计算保留分数：\n$$\n\\text{Retention Fraction} = 1 - \\exp(-\\tau) = 1 - \\exp(-0.45)\n$$\n计算数值：\n$$\n\\exp(-0.45) \\approx 0.63762815\n$$\n$$\n\\text{Retention Fraction} \\approx 1 - 0.63762815 = 0.36237185\n$$\n问题要求答案四舍五入到四位有效数字。第五位有效数字是 7，所以我们将第四位数字向上取整。\n$$\n\\text{Retention Fraction} \\approx 0.3624\n$$\n这就是沿特征路径吸收的预热能量的估算分数。",
            "answer": "$$\\boxed{0.3624}$$"
        },
        {
            "introduction": "在成功预热燃料并有效约束能量之后，聚变研究的最终目标是实现自持燃烧，即由聚变反应自身产生的能量来维持等离子体的高温。这个高级练习让你探索“自持燃烧”等离子体的核心物理过程。你需要通过建模来预测聚变产生的阿尔法（alpha）粒子的最终去向，计算它们有多少能量通过碰撞沉积在等离子体中（实现加热），又有多少因磁场约束不完美而逃逸，这涉及到粒子输运、碰撞物理和磁约束机制之间的复杂权衡。",
            "id": "3950849",
            "problem": "考虑与替代聚变概念相关的磁化氘-氚燃料，这些概念包括磁化惯性聚变（MIF）、磁化套筒惯性聚变（MagLIF）、Z箍缩、反向场箍缩（RFP）、球形托卡马克和重离子驱动器。一个聚变产生的α粒子在约束场线的磁场最小值位置以一定的动能和各向同性的投掷角分布诞生。目标是利用碰撞阻止和磁镜效应的第一性原理模型，估算沉积在燃料中的α粒子能量的份额，并确定其对热能平衡的相应贡献。\n\n从基本原理出发：\n\n- 带电粒子之间的库仑碰撞将能量从快离子转移到背景电子和离子上。α粒子的减速过程主要由高速极限下与电子的库仑散射导致的能量损失所决定。\n- 在缓慢变化的磁场中，绝热磁矩不变量和总能量守恒决定了带电粒子沿场线运动的磁镜反射条件。\n\n将使用的假设：\n\n- α粒子的初始动能为 $E_0$。\n- α粒子的电荷数为 $Z_\\alpha = 2$，质量为 $m_\\alpha$。\n- 电子数密度为 $n_e$，电子质量为 $m_e$。\n- 库仑对数为 $\\ln\\Lambda$。\n- 电子和离子温度相等，记为 $T$。\n- 离子数密度满足 $n_i = n_e$。\n- 磁场沿场线有最小值 $B_{\\min}$ 和最大值 $B_{\\max}$，定义了磁镜比 $R_m = B_{\\max}/B_{\\min} \\ge 1$。\n- 投掷角 $\\theta$ 以弧度为单位。\n- 到端部损失区的特征平行距离为 $L_\\parallel$（单位：米）。\n- α粒子在 $B_{\\min}$ 处的诞生投掷角分布是各向同性的。\n- 沉积的能量被加到等离子体的热能中；热能密度为 $U_{\\mathrm{th}} = \\frac{3}{2} n_e k_B T + \\frac{3}{2} n_i k_B T$。\n- α粒子源的单位体积生成率为 $S_\\alpha$（单位：$\\mathrm{s^{-1}\\,m^{-3}}$）。\n- 热化阈值能量为 $E_{\\mathrm{th}} = 3 k_B T$。\n\n定义以下计算任务：\n\n1. 使用高速库仑碰撞模型，推导一个诞生能量为 $E_0$ 的α粒子在密度为 $n_e$、温度为 $T$ 的背景等离子体中减速到 $E_{\\mathrm{th}}$ 所需的碰撞能量减速时间 $\\tau_s$。所有量均以国际单位制（SI）表示。\n2. 根据磁镜不变量推导出在 $B_{\\min}$ 处的磁损失锥半角，并计算对于各向同性分布的α粒子投掷角，其被约束的份额 $f_{\\mathrm{conf}}$。\n3. 通过对损失锥分布上的平行渡越时间进行平均，估算处于损失锥中的α粒子的平均逃逸时间 $\\tau_{\\mathrm{esc}}$。使用 $L_\\parallel$ 和初始α粒子速度 $v_0 = \\sqrt{2 E_0 / m_\\alpha}$ 进行此估算。\n4. 计算α粒子能量沉积份额 $f_{\\mathrm{dep}}$，其为以下两项之和：\n   - 磁约束部分 $f_{\\mathrm{conf}}$ 的完全沉积，以及\n   - 损失锥部分 $(1 - f_{\\mathrm{conf}})$ 的部分沉积，近似为 $\\min(1, \\tau_{\\mathrm{esc}} / \\tau_s)$。\n5. 计算单位体积的α粒子加热率 $Q_\\alpha = f_{\\mathrm{dep}} E_0 S_\\alpha$ 和相对于现有热能密度的加热率 $r = Q_\\alpha / U_{\\mathrm{th}}$（单位：$\\mathrm{s^{-1}}$）。\n\n单位和输出：\n\n- 全部使用国际单位制。能量必须以焦耳为单位，磁场以特斯拉为单位，长度以米为单位，数密度以 $\\mathrm{m^{-3}}$ 为单位，温度通过 $k_B T$ 以焦耳为单位，时间以秒为单位。\n- 角度以弧度为单位。\n- 对于每个测试案例，程序必须输出两个值：能量沉积份额 $f_{\\mathrm{dep}}$（无量纲）和加热率比值 $r$（单位：$\\mathrm{s^{-1}}$）。\n- 将每个输出值表示为四舍五入到 $6$ 位有效数字的小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[f_{\\mathrm{dep},1}, r_1, f_{\\mathrm{dep},2}, r_2, f_{\\mathrm{dep},3}, r_3, f_{\\mathrm{dep},4}, r_4]$。\n\n将使用的物理常数（国际单位制）：\n\n- 基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$。\n- 电子质量 $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。\n- α粒子质量 $m_\\alpha = 6.6446573357 \\times 10^{-27}\\,\\mathrm{kg}$。\n- 玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n- 库仑常数 $k_e = 1/(4\\pi\\epsilon_0) = 8.9875517923 \\times 10^{9}\\,\\mathrm{N\\,m^2\\,C^{-2}}$。\n- α粒子诞生能量 $E_0 = 3.5\\,\\mathrm{MeV}$。\n\n测试套件：\n\n提供以下四个测试案例，每个案例由 $(n_e, T, R_m, L_\\parallel, \\ln\\Lambda, S_\\alpha)$ 指定：\n\n- 案例1（磁化套筒惯性聚变柱体）：\n  - $n_e = 1.0 \\times 10^{26}\\,\\mathrm{m^{-3}}$，\n  - $T = 3.0\\,\\mathrm{keV}$，\n  - $R_m = 10.0$，\n  - $L_\\parallel = 0.01\\,\\mathrm{m}$，\n  - $\\ln\\Lambda = 10.0$，\n  - $S_\\alpha = 1.0 \\times 10^{29}\\,\\mathrm{s^{-1}\\,m^{-3}}$。\n- 案例2（类球形托卡马克参数）：\n  - $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，\n  - $T = 10.0\\,\\mathrm{keV}$，\n  - $R_m = 1.5$，\n  - $L_\\parallel = 5.0\\,\\mathrm{m}$，\n  - $\\ln\\Lambda = 17.0$，\n  - $S_\\alpha = 1.0 \\times 10^{22}\\,\\mathrm{s^{-1}\\,m^{-3}}$。\n- 案例3（类Z箍缩密柱）：\n  - $n_e = 5.0 \\times 10^{27}\\,\\mathrm{m^{-3}}$，\n  - $T = 1.0\\,\\mathrm{keV}$，\n  - $R_m = 5.0$，\n  - $L_\\parallel = 0.005\\,\\mathrm{m}$，\n  - $\\ln\\Lambda = 8.0$，\n  - $S_\\alpha = 5.0 \\times 10^{30}\\,\\mathrm{s^{-1}\\,m^{-3}}$。\n- 案例4（重离子驱动器磁化靶）：\n  - $n_e = 1.0 \\times 10^{25}\\,\\mathrm{m^{-3}}$，\n  - $T = 5.0\\,\\mathrm{keV}$，\n  - $R_m = 2.0$，\n  - $L_\\parallel = 0.02\\,\\mathrm{m}$，\n  - $\\ln\\Lambda = 12.0$，\n  - $S_\\alpha = 1.0 \\times 10^{28}\\,\\mathrm{s^{-1}\\,m^{-3}}$。\n\n您的程序必须实现上述物理过程，为每个案例计算 $f_{\\mathrm{dep}}$ 和 $r$，并按规定格式输出单行结果。",
            "solution": "问题陈述具有科学依据，提法恰当且内容完整，提出了一个关于等离子体约束和高能粒子输运的有效经典物理问题。它提供了所有必需的物理常数、参数，以及一组基于等离子体物理既定原则的明确计算任务。我们逐步推导所要求的量。\n\n问题的核心在于两个特征时间尺度的相互作用：碰撞减速时间 $\\tau_s$ 和由磁约束几何决定的粒子损失时间。我们通过将聚变产生的α粒子分为两个群体来分析其行为：磁约束部分和逃逸（损失锥）部分。\n\n**1. 碰撞能量减速时间, $\\tau_s$**\n\n一个高能α粒子穿过等离子体时，主要通过与背景电子和离子的库仑碰撞来损失能量。问题指定了高速极限，即α粒子速度 $v_\\alpha$ 远大于背景电子的热速度。在这种情况下，能量损失主要由电子的拖拽力决定。能量损失率由下式给出：\n$$ \\frac{dE}{dt} = -\\frac{n_e Z_\\alpha^2 e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_e v_\\alpha} $$\n这里，$E = \\frac{1}{2} m_\\alpha v_\\alpha^2$ 是α粒子的动能，$Z_\\alpha = 2$ 是其电荷数，$m_\\alpha$ 是其质量，$n_e$ 是电子密度，$m_e$ 是电子质量，$e$ 是基本电荷，$\\ln\\Lambda$ 是库仑对数。我们可以将速度表示为 $v_\\alpha = \\sqrt{2E/m_\\alpha}$。将此代入能量损失方程，并使用库仑常数 $k_e = 1/(4\\pi\\epsilon_0)$（这意味着 $1/\\epsilon_0^2 = 16\\pi^2 k_e^2$），我们得到：\n$$ \\frac{dE}{dt} = -\\frac{4\\pi k_e^2 n_e Z_\\alpha^2 e^4 \\ln\\Lambda}{m_e} \\sqrt{\\frac{m_\\alpha}{2E}} = -C \\frac{1}{\\sqrt{E}} $$\n其中常数 $C$ 由 $C = \\frac{4\\pi k_e^2 n_e Z_\\alpha^2 e^4 \\ln\\Lambda \\sqrt{m_\\alpha}}{m_e \\sqrt{2}}$ 给出。这是一个关于能量 $E(t)$ 的可分离常微分方程。为了找到α粒子从其诞生能量 $E_0$ 减速到热化能量 $E_{\\mathrm{th}} = 3k_B T$ 所需的时间 $\\tau_s$，我们进行积分：\n$$ \\int_{E_0}^{E_{\\mathrm{th}}} E^{1/2} dE = -\\int_0^{\\tau_s} C dt $$\n$$ \\left[ \\frac{2}{3} E^{3/2} \\right]_{E_0}^{E_{\\mathrm{th}}} = -C \\tau_s $$\n$$ \\frac{2}{3} (E_{\\mathrm{th}}^{3/2} - E_0^{3/2}) = -C \\tau_s $$\n求解减速时间 $\\tau_s$：\n$$ \\tau_s = \\frac{2(E_0^{3/2} - E_{\\mathrm{th}}^{3/2})}{3C} = \\frac{\\sqrt{2} m_e (E_0^{3/2} - E_{\\mathrm{th}}^{3/2})}{6\\pi k_e^2 n_e Z_\\alpha^2 e^4 \\ln\\Lambda \\sqrt{m_\\alpha}} $$\n这个 $\\tau_s$ 的表达式将使用提供的参数（全部为国际单位制）来实现。\n\n**2. 磁损失锥和约束份额, $f_{\\mathrm{conf}}$**\n\n在磁镜位形中，带电粒子的运动由动能 $E$ 和第一绝热不变量——磁矩 $\\mu = \\frac{m_\\alpha v_\\perp^2}{2B}$ 的守恒所决定，其中 $v_\\perp$ 是垂直于磁场 $\\vec{B}$ 的速度分量。给定投掷角 $\\theta$ 使得 $v_\\perp = v \\sin\\theta$，$\\mu$ 和 $E$ 的守恒意味着：\n$$ \\frac{\\sin^2\\theta}{B} = \\text{常数} $$\n一个从磁场最小值 $B_{\\min}$ 处以投掷角 $\\theta_{\\min}$ 开始运动的粒子，将在其投掷角变为 $\\pi/2$ 的地方被反射。设此反射点的磁场为 $B_{\\mathrm{refl}}$。则有 $\\frac{\\sin^2\\theta_{\\min}}{B_{\\min}} = \\frac{\\sin^2(\\pi/2)}{B_{\\mathrm{refl}}} = \\frac{1}{B_{\\mathrm{refl}}}$。\n如果粒子在到达最大磁场 $B_{\\max}$ 之前被反射，即 $B_{\\mathrm{refl}} \\le B_{\\max}$，则该粒子被约束。这意味着 $\\sin^2\\theta_{\\min} \\le \\frac{B_{\\min}}{B_{\\max}} = \\frac{1}{R_m}$，其中 $R_m$ 是磁镜比。\n不满足此条件的粒子处于“损失锥”中并会逃逸。损失锥半角 $\\theta_L$ 由此条件的边界定义：$\\sin\\theta_L = 1/\\sqrt{R_m}$。\n对于诞生时各向同性的投掷角分布，粒子在整个 $4\\pi$ 立体角上均匀分布。被约束的粒子份额对应于总立体角中位于两个损失锥（一个在速度球的两端）之外的部分。该份额由下式给出：\n$$ f_{\\mathrm{conf}} = \\frac{\\int_{\\theta_L}^{\\pi-\\theta_L} 2\\pi \\sin\\theta d\\theta}{\\int_0^\\pi 2\\pi \\sin\\theta d\\theta} = \\frac{[-\\cos\\theta]_{\\theta_L}^{\\pi-\\theta_L}}{2} = \\frac{\\cos\\theta_L - \\cos(\\pi-\\theta_L)}{2} = \\cos\\theta_L $$\n使用恒等式 $\\cos\\theta_L = \\sqrt{1-\\sin^2\\theta_L}$，我们得到约束份额为：\n$$ f_{\\mathrm{conf}} = \\sqrt{1 - \\frac{1}{R_m}} $$\n\n**3. 平均逃逸时间, $\\tau_{\\mathrm{esc}}$**\n\n对于在损失锥中（$0 \\le \\theta  \\theta_L$）诞生的粒子，我们估算其逃逸时间。平行速度为 $v_\\parallel(\\theta) = v_0 \\cos\\theta$，其中 $v_0 = \\sqrt{2E_0/m_\\alpha}$ 是初始速度。逃逸经过距离 $L_\\parallel$ 的渡越时间为 $t(\\theta) = L_\\parallel / v_\\parallel(\\theta)$。为求得平均逃逸时间，我们对 $t(\\theta)$ 在损失锥投掷角分布上进行平均。$\\theta$ 的概率分布为 $p(\\theta) = \\frac{1}{2}\\sin\\theta$。\n考虑一个损失锥（$0 \\le \\theta  \\theta_L$），平均时间为：\n$$ \\tau_{\\mathrm{esc}} = \\frac{\\int_0^{\\theta_L} t(\\theta) p(\\theta) d\\theta}{\\int_0^{\\theta_L} p(\\theta) d\\theta} = \\frac{\\int_0^{\\theta_L} \\frac{L_\\parallel}{v_0 \\cos\\theta} \\frac{1}{2}\\sin\\theta d\\theta}{\\int_0^{\\theta_L} \\frac{1}{2}\\sin\\theta d\\theta} $$\n分子积分为 $\\frac{L_\\parallel}{2v_0} \\int_0^{\\theta_L} \\tan\\theta d\\theta = \\frac{L_\\parallel}{2v_0} [-\\ln(\\cos\\theta)]_0^{\\theta_L} = -\\frac{L_\\parallel}{2v_0} \\ln(\\cos\\theta_L)$。\n分母积分为 $\\frac{1}{2}[-\\cos\\theta]_0^{\\theta_L} = \\frac{1}{2}(1 - \\cos\\theta_L)$。\n综合这些结果，得到平均逃逸时间：\n$$ \\tau_{\\mathrm{esc}} = \\frac{-\\frac{L_\\parallel}{2v_0} \\ln(\\cos\\theta_L)}{\\frac{1}{2}(1 - \\cos\\theta_L)} = \\frac{L_\\parallel}{v_0} \\frac{-\\ln(\\cos\\theta_L)}{1 - \\cos\\theta_L} $$\n使用 $\\cos\\theta_L = \\sqrt{1-1/R_m}$，我们可以计算出 $\\tau_{\\mathrm{esc}}$。对于 $R_m=1$，此表达式无定义，但所提供的测试案例均有 $R_m  1$。\n\n**4. 总α粒子能量沉积份额, $f_{\\mathrm{dep}}$**\n\n总的沉积α粒子能量份额是约束群体和逃逸群体贡献的总和。\n- 约束份额 $f_{\\mathrm{conf}}$ 被假定沉积其全部能量。其贡献为 $f_{\\mathrm{conf}} \\times 1$。\n- 损失锥份额 $(1 - f_{\\mathrm{conf}})$ 在平均时间 $\\tau_{\\mathrm{esc}}$ 内逃逸。在此期间，它沉积的能量份额近似为时间尺度之比 $\\tau_{\\mathrm{esc}}/\\tau_s$。此分数沉积的上限为1，因为粒子不能沉积超过其总能量。因此，其贡献为 $(1-f_{\\mathrm{conf}}) \\times \\min(1, \\tau_{\\mathrm{esc}}/\\tau_s)$。\n将这些贡献相加，得到总沉积份额：\n$$ f_{\\mathrm{dep}} = f_{\\mathrm{conf}} + (1 - f_{\\mathrm{conf}}) \\min(1, \\frac{\\tau_{\\mathrm{esc}}}{\\tau_s}) $$\n\n**5. 体积加热率, $Q_\\alpha$, 和相对加热率, $r$**\n\n单位体积的α粒子加热功率密度 $Q_\\alpha$ 是α粒子单位体积源率 $S_\\alpha$、每个α粒子的能量 $E_0$ 以及该能量沉积份额 $f_{\\mathrm{dep}}$ 的乘积：\n$$ Q_\\alpha = f_{\\mathrm{dep}} E_0 S_\\alpha $$\n假设电子和离子温度相等（$T_e=T_i=T$）且氘-氚等离子体呈电中性（$n_i=n_e$），背景等离子体的热能密度为：\n$$ U_{\\mathrm{th}} = \\frac{3}{2} n_e k_B T + \\frac{3}{2} n_i k_B T = 3 n_e k_B T $$\n相对于现有热能密度的加热率 $r$ 是加热功率密度与热能密度的比值。该量的单位为 $\\mathrm{s^{-1}}$，代表了α粒子加热等离子体的一个特征时间倒数。\n$$ r = \\frac{Q_\\alpha}{U_{\\mathrm{th}}} = \\frac{f_{\\mathrm{dep}} E_0 S_\\alpha}{3 n_e k_B T} $$\n这些公式为数值计算提供了基础。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for alpha particle energy deposition fraction and relative heating rate\n    for several alternative fusion concept scenarios.\n    \"\"\"\n\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    M_E = 9.1093837015e-31      # Electron mass in kg\n    M_ALPHA = 6.6446573357e-27  # Alpha particle mass in kg\n    K_B = 1.380649e-23          # Boltzmann constant in J/K\n    K_E = 8.9875517923e9        # Coulomb constant in N m^2 C^-2\n    \n    # Problem-specific constants\n    E0_MEV = 3.5                # Alpha birth energy in MeV\n    E0_J = E0_MEV * 1e6 * E_CHARGE  # Alpha birth energy in Joules\n    Z_ALPHA = 2.0                 # Alpha charge number\n\n    def calculate_metrics(n_e, T_keV, R_m, L_parallel, ln_Lambda, S_alpha):\n        \"\"\"\n        Computes f_dep and r for a single test case.\n        \n        Args:\n            n_e (float): Electron number density (m^-3)\n            T_keV (float): Plasma temperature (k_B*T) in keV\n            R_m (float): Mirror ratio (B_max / B_min)\n            L_parallel (float): Parallel distance to end loss region (m)\n            ln_Lambda (float): Coulomb logarithm\n            S_alpha (float): Alpha source rate per unit volume (s^-1 m^-3)\n\n        Returns:\n            tuple: (f_dep, r)\n        \"\"\"\n        \n        # Convert temperature to Joules\n        kBT_J = T_keV * 1e3 * E_CHARGE\n        \n        # --- Task 1: Calculate collisional slowing-down time tau_s ---\n        E_th = 3.0 * kBT_J  # Thermalization energy\n        \n        # Ensure E0  E_th to avoid math domain errors\n        if E0_J = E_th:\n             tau_s = 0.0\n        else:\n            # Constant part of the tau_s formula\n            C1 = (np.sqrt(2.0) * M_E) / (6.0 * np.pi * K_E**2 * E_CHARGE**4)\n            # Variable part\n            C2 = (E0_J**1.5 - E_th**1.5) / (n_e * ln_Lambda * Z_ALPHA**2 * np.sqrt(M_ALPHA))\n            tau_s = C1 * C2\n\n        # --- Task 2: Calculate confined fraction f_conf ---\n        if R_m  1.0:\n            # Physically R_m should be = 1. If not, handle as no confinement.\n            f_conf = 0.0\n        else:\n            f_conf = np.sqrt(1.0 - 1.0 / R_m)\n\n        # --- Task 3: Calculate average escape time tau_esc ---\n        v0 = np.sqrt(2.0 * E0_J / M_ALPHA)\n        cos_theta_L = f_conf # As derived: f_conf = cos(theta_L)\n        \n        # Handle the case R_m = 1 (cos_theta_L = 0) where log(0) is -inf\n        if np.isclose(cos_theta_L, 0):\n            # Model breaks down, escape time is effectively infinite for some particles\n            # but for the average, it is very large compared to tau_s.\n            # Using a very large number to ensure min(1, tau_esc/tau_s) = 1\n            tau_esc = np.inf\n        else:\n            tau_esc = (L_parallel / v0) * (-np.log(cos_theta_L) / (1.0 - cos_theta_L))\n\n        # --- Task 4: Compute alpha energy deposition fraction f_dep ---\n        if tau_s > 0:\n            deposition_ratio = tau_esc / tau_s\n        else: # If tau_s is effectively zero (instant slowing), deposition is immediate\n             deposition_ratio = np.inf\n\n        partial_deposition = min(1.0, deposition_ratio)\n        f_dep = f_conf + (1.0 - f_conf) * partial_deposition\n        \n        # --- Task 5: Compute volumetric heating rate Q_alpha and relative rate r ---\n        U_th = 3.0 * n_e * kBT_J\n        Q_alpha = f_dep * E0_J * S_alpha\n        \n        if U_th > 0:\n            r = Q_alpha / U_th\n        else:\n            r = np.inf # If thermal energy is zero, any heating is infinite relative rate\n\n        return f_dep, r\n\n    # Test suite from the problem description\n    test_cases = [\n        # Case 1 (MagLIF)\n        (1.0e26, 3.0, 10.0, 0.01, 10.0, 1.0e29),\n        # Case 2 (spherical tokamak)\n        (5.0e19, 10.0, 1.5, 5.0, 17.0, 1.0e22),\n        # Case 3 (Z-pinch)\n        (5.0e27, 1.0, 5.0, 0.005, 8.0, 5.0e30),\n        # Case 4 (heavy-ion driver)\n        (1.0e25, 5.0, 2.0, 0.02, 12.0, 1.0e28),\n    ]\n\n    results = []\n    for case in test_cases:\n        f_dep, r = calculate_metrics(*case)\n        # Format to 6 significant figures\n        results.append(f\"{f_dep:.6g}\")\n        results.append(f\"{r:.6g}\")\n\n    # Print the final output in the specified single-line format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}