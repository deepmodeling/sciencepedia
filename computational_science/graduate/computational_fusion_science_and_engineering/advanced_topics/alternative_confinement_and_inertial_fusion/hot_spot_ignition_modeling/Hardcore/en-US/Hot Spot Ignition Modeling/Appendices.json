{
    "hands_on_practices": [
        {
            "introduction": "At the heart of ignition modeling lies a fundamental energy balance. This exercise challenges you to quantify this balance by developing a program to compute the ignition temperature ($T_{\\text{ign}}$) and the minimum energy required to achieve it. By modeling alpha-particle self-heating and radiative losses as temperature-dependent functions, you will numerically solve for the critical point where heating begins to dominate losses, a foundational concept in fusion energy . This practice provides a tangible connection between the abstract theory of thermal instability and the practical engineering question of \"how much energy do we need?\"",
            "id": "3991325",
            "problem": "Consider a hot spot of equimolar Deuterium–Tritium (D–T) plasma where the ion temperature $T_i$ and electron temperature $T_e$ are assumed equal at all times due to fast electron–ion equilibration, that is, $T_e = T_i = T$. The hot spot has ion number density $n_i$ (in $\\mathrm{m}^{-3}$), electron number density $n_e$ (in $\\mathrm{m}^{-3}$), and volume $V$ (in $\\mathrm{m}^3$). In an equimolar D–T plasma with fully ionized ions, one has $n_D = n_T = n_i/2$, $n_e = n_i$, and the average ion charge $Z_{\\text{eff}} = 1$.\n\nThe thermal energy of the hot spot as a function of temperature $T$ (measured in kiloelectronvolts, $\\mathrm{keV}$, interpreted as energy per particle) is\n$$\nE(T) = \\frac{3}{2} (n_e + n_i) \\, V \\, T \\, E_{\\mathrm{keV}},\n$$\nwhere $E_{\\mathrm{keV}} = 1.602176634 \\times 10^{-16} \\,\\mathrm{J}$ is the energy corresponding to $1 \\,\\mathrm{keV}$.\n\nThe energy balance equation is\n$$\n\\frac{dE}{dt} = Q_{\\text{ext}}(t) + Q_{\\alpha}(T) - Q_{\\text{rad}}(T),\n$$\nwhere $Q_{\\text{ext}}(t)$ is externally supplied power, $Q_{\\alpha}(T)$ is alpha-particle self-heating power, and $Q_{\\text{rad}}(T)$ is radiative loss power. The alpha-particle heating for equimolar D–T is modeled as\n$$\nQ_{\\alpha}(T) = f_{\\alpha} \\, E_{\\alpha}^{\\mathrm{J}} \\, V \\, n_D n_T \\, \\langle \\sigma v \\rangle(T) = f_{\\alpha} \\, E_{\\alpha}^{\\mathrm{J}} \\, V \\, \\frac{n_i^2}{4} \\, \\langle \\sigma v \\rangle(T),\n$$\nwhere $f_{\\alpha} \\in (0,1]$ is the fraction of alpha energy deposited locally in the hot spot, $E_{\\alpha}^{\\mathrm{J}} = 3.5 \\times 10^{3} \\, E_{\\mathrm{keV}}$ is the alpha energy in Joules, and $\\langle \\sigma v \\rangle(T)$ is the reactivity (in $\\mathrm{m}^3/\\mathrm{s}$) modeled here by a Gamow-like approximation\n$$\n\\langle \\sigma v \\rangle(T) = S_0 \\, \\frac{T^2}{1 + T/T_s} \\, \\exp\\!\\left(- b \\, T^{-1/3}\\right),\n$$\nwhere $S_0$ is a constant with units $\\mathrm{m}^3/\\mathrm{s} \\cdot \\mathrm{keV}^{-2}$, $T_s$ is a softening scale in $\\mathrm{keV}$, and $b$ is a dimensionless barrier parameter.\n\nThe radiative power is modeled by effective bremsstrahlung-like losses\n$$\nQ_{\\text{rad}}(T) = C_b \\, Z_{\\text{eff}}^2 \\, n_e \\, n_i \\, V \\, \\sqrt{T},\n$$\nwhere $C_b$ is a constant with units $\\mathrm{W}\\cdot\\mathrm{m}^3\\cdot\\mathrm{keV}^{-1/2}$. The factor $C_b$ can be interpreted to include corrections for radiation transport and reabsorption; $Z_{\\text{eff}} = 1$ for D–T.\n\nDefine the ignition temperature $T_{\\text{ign}}$ as the smallest temperature within a prescribed search interval $[T_{\\min}, T_{\\max}]$ such that\n$$\nQ_{\\alpha}(T_{\\text{ign}}) = Q_{\\text{rad}}(T_{\\text{ign}}),\n$$\nand the local slope condition\n$$\n\\left.\\frac{d}{dT}\\big(Q_{\\alpha}(T) - Q_{\\text{rad}}(T)\\big)\\right|_{T=T_{\\text{ign}}} > 0\n$$\nholds, ensuring positive feedback if the hot spot is slightly hotter than $T_{\\text{ign}}$.\n\nLet the initial temperature be $T_0$. The minimum additional external energy input required to reach ignition, $E_{\\text{add,min}}$, is defined as the smallest integral of $Q_{\\text{ext}}(t)$ over time that suffices to bring the temperature from $T_0$ to $T_{\\text{ign}}$ under the above dynamics. If $T_0 \\ge T_{\\text{ign}}$, then $E_{\\text{add,min}} = 0$ by definition. If no ignition temperature exists in $[T_{\\min}, T_{\\max}]$, report $E_{\\text{add,min}} = -1.0$.\n\nTask:\n1. Implement a program that, for each test case specified below, computes $T_{\\text{ign}}$ and then computes\n$$\nE_{\\text{add,min}} =\n\\begin{cases}\nE(T_{\\text{ign}}) - E(T_0), & \\text{if } T_0 < T_{\\text{ign}},\\\\\n0, & \\text{if } T_0 \\ge T_{\\text{ign}},\n\\end{cases}\n$$\nin Joules.\n2. The ignition temperature must be found numerically as the smallest root of $Q_{\\alpha}(T) - Q_{\\text{rad}}(T)$ in $[T_{\\min}, T_{\\max}]$ for which the slope condition is satisfied. If no such root exists, output $-1.0$ for that test case.\n3. Express all final energies in Joules, rounded to three significant figures.\n4. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\").\n\nUse the following test suite (all temperatures in $\\mathrm{keV}$, densities in $\\mathrm{m}^{-3}$, volumes in $\\mathrm{m}^3$, and power-law constants as described):\n\n- Test case 1 (general case):\n  - $n_i = 5.0 \\times 10^{30}$, $n_e = 5.0 \\times 10^{30}$, $V = 1.0 \\times 10^{-12}$,\n  - $f_{\\alpha} = 0.85$, $S_0 = 1.0 \\times 10^{-22}$, $T_s = 40.0$, $b = 3.0$, $C_b = 1.0 \\times 10^{-35}$,\n  - $T_0 = 2.0$, $T_{\\min} = 0.5$, $T_{\\max} = 30.0$.\n\n- Test case 2 (initial temperature already above ignition):\n  - Same parameters as Test case 1, except $T_0 = 8.0$, $T_{\\min} = 0.5$, $T_{\\max} = 30.0$.\n\n- Test case 3 (no ignition within search interval due to larger radiative losses):\n  - Same as Test case 1, except $C_b = 1.0 \\times 10^{-34}$, $T_0 = 2.0$, $T_{\\min} = 0.5$, $T_{\\max} = 20.0$.\n\n- Test case 4 (reduced density and volume; ignition threshold similar but energy requirement smaller):\n  - $n_i = 1.0 \\times 10^{30}$, $n_e = 1.0 \\times 10^{30}$, $V = 5.0 \\times 10^{-13}$,\n  - $f_{\\alpha} = 0.85$, $S_0 = 1.0 \\times 10^{-22}$, $T_s = 40.0$, $b = 3.0$, $C_b = 1.0 \\times 10^{-35}$,\n  - $T_0 = 1.0$, $T_{\\min} = 0.5$, $T_{\\max} = 30.0$.\n\nYour program must implement the above computation for all four test cases and produce a single line of output containing the four results in Joules, rounded to three significant figures, as a comma-separated list enclosed in square brackets.",
            "solution": "The user has provided a valid problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Plasma Model**: Equimolar Deuterium-Tritium (D-T) with $T_e = T_i = T$, $n_D = n_T = n_i/2$, $n_e = n_i$, and $Z_{\\text{eff}} = 1$.\n- **Thermal Energy**: $E(T) = \\frac{3}{2} (n_e + n_i) \\, V \\, T \\, E_{\\mathrm{keV}}$, with $E_{\\mathrm{keV}} = 1.602176634 \\times 10^{-16} \\,\\mathrm{J}$.\n- **Energy Balance**: $\\frac{dE}{dt} = Q_{\\text{ext}}(t) + Q_{\\alpha}(T) - Q_{\\text{rad}}(T)$.\n- **Alpha Heating Power**: $Q_{\\alpha}(T) = f_{\\alpha} \\, E_{\\alpha}^{\\mathrm{J}} \\, V \\, \\frac{n_i^2}{4} \\, \\langle \\sigma v \\rangle(T)$, where $E_{\\alpha}^{\\mathrm{J}} = 3.5 \\times 10^{3} \\, E_{\\mathrm{keV}}$.\n- **Reactivity Model**: $\\langle \\sigma v \\rangle(T) = S_0 \\, \\frac{T^2}{1 + T/T_s} \\, \\exp\\!\\left(- b \\, T^{-1/3}\\right)$.\n- **Radiative Loss Power**: $Q_{\\text{rad}}(T) = C_b \\, Z_{\\text{eff}}^2 \\, n_e \\, n_i \\, V \\, \\sqrt{T}$.\n- **Ignition Temperature $T_{\\text{ign}}$**: The smallest temperature $T$ in $[T_{\\min}, T_{\\max}]$ satisfying both $Q_{\\alpha}(T) = Q_{\\text{rad}}(T)$ and $\\left.\\frac{d}{dT}\\big(Q_{\\alpha}(T) - Q_{\\text{rad}}(T)\\big)\\right|_{T} > 0$.\n- **Minimum Additional Energy $E_{\\text{add,min}}$**:\n  - $E(T_{\\text{ign}}) - E(T_0)$ if $T_0 < T_{\\text{ign}}$.\n  - $0$ if $T_0 \\ge T_{\\text{ign}}$.\n  - $-1.0$ if no $T_{\\text{ign}}$ exists in the search interval.\n- **Task**: For each of four test cases, compute $E_{\\text{add,min}}$ in Joules, rounded to three significant figures.\n- **Test Cases**: Specific values for $n_i, n_e, V, f_{\\alpha}, S_0, T_s, b, C_b, T_0, T_{\\min}, T_{\\max}$ are provided for four distinct scenarios.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, employing a standard zero-dimensional (point) model for plasma hot spot analysis in inertial confinement fusion. The equations for thermal energy, alpha heating (using a Gamow-like approximation for reactivity), and bremsstrahlung radiation are physically correct representations in this simplified context. The definition of ignition temperature, as the point where heating balances losses with a positive feedback slope, is a standard concept. All parameters are defined, units are consistent, and the given values are physically plausible within the modeling context. The problem is self-contained, well-posed, and objective. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be developed.\n\n### Solution\n\nThe problem requires us to determine the minimum external energy needed to bring a D-T plasma hot spot to ignition. This involves finding the ignition temperature, $T_{\\text{ign}}$, and then calculating the change in the system's thermal energy to reach that temperature from an initial state.\n\nFirst, let's define the net power balance function, $P_{\\text{net}}(T)$, which is the difference between the alpha heating power and the radiative loss power:\n$$\nP_{\\text{net}}(T) = Q_{\\alpha}(T) - Q_{\\text{rad}}(T)\n$$\nThe ignition temperature $T_{\\text{ign}}$ is defined by two conditions:\n1.  **Power Balance**: The plasma is in thermal equilibrium (ignoring external power), meaning the self-heating from fusion products exactly balances the energy lost to radiation.\n    $$\n    P_{\\text{net}}(T_{\\text{ign}}) = 0 \\quad \\implies \\quad Q_{\\alpha}(T_{\\text{ign}}) = Q_{\\text{rad}}(T_{\\text{ign}})\n    $$\n2.  **Thermal Instability**: The equilibrium must be unstable in a way that favors heating. If the temperature slightly increases, the net power must become positive, causing the temperature to rise further (a thermal runaway, which is ignition). This is expressed as a condition on the local slope of the net power function:\n    $$\n    \\left.\\frac{dP_{\\text{net}}}{dT}\\right|_{T=T_{\\text{ign}}} > 0\n    $$\n\nThe expressions for the power terms can be simplified by grouping the constant parameters for a given test case.\nFor the radiative losses, with $n_e=n_i$ and $Z_{\\text{eff}}=1$:\n$$\nQ_{\\text{rad}}(T) = (C_b \\, n_i^2 \\, V) \\, \\sqrt{T} = K_{\\text{rad}} \\sqrt{T}\n$$\nFor the alpha heating, with $n_D n_T = n_i^2/4$:\n$$\nQ_{\\alpha}(T) = \\left(f_{\\alpha} \\, E_{\\alpha}^{\\mathrm{J}} \\, V \\, \\frac{n_i^2}{4} \\, S_0\\right) \\, \\frac{T^2}{1 + T/T_s} \\, \\exp\\!\\left(- b \\, T^{-1/3}\\right) = K_{\\alpha} \\, \\frac{T^2}{1 + T/T_s} \\, \\exp\\!\\left(- b \\, T^{-1/3}\\right)\n$$\nThe problem reduces to finding the smallest root of $P_{\\text{net}}(T) = 0$ in the interval $[T_{\\min}, T_{\\max}]$ that satisfies the derivative condition.\n\nTo evaluate the derivative condition efficiently, we compute the analytical derivative of $P_{\\text{net}}(T)$. It is convenient to use logarithmic derivatives:\n$$\n\\frac{d Q_{\\alpha}}{dT} = Q_{\\alpha}(T) \\frac{d}{dT} (\\ln Q_{\\alpha}(T)) = Q_{\\alpha}(T) \\left( \\frac{2}{T} - \\frac{1}{T+T_s} + \\frac{b}{3}T^{-4/3} \\right)\n$$\n$$\n\\frac{d Q_{\\text{rad}}}{dT} = Q_{\\text{rad}}(T) \\frac{d}{dT} (\\ln Q_{\\text{rad}}(T)) = Q_{\\text{rad}}(T) \\left( \\frac{1}{2T} \\right)\n$$\nAt a root $T_{\\text{root}}$ where $Q_{\\alpha}(T_{\\text{root}}) = Q_{\\text{rad}}(T_{\\text{root}})$, the derivative becomes:\n$$\n\\left.\\frac{dP_{\\text{net}}}{dT}\\right|_{T_{\\text{root}}} = Q_{\\text{rad}}(T_{\\text{root}}) \\left[ \\left( \\frac{2}{T_{\\text{root}}} - \\frac{1}{T_{\\text{root}}+T_s} + \\frac{b}{3}T_{\\text{root}}^{-4/3} \\right) - \\frac{1}{2T_{\\text{root}}} \\right]\n$$\n$$\n\\left.\\frac{dP_{\\text{net}}}{dT}\\right|_{T_{\\text{root}}} = Q_{\\text{rad}}(T_{\\text{root}}) \\left( \\frac{3}{2T_{\\text{root}}} - \\frac{1}{T_{\\text{root}}+T_s} + \\frac{b}{3}T_{\\text{root}}^{-4/3} \\right)\n$$\nSince $Q_{\\text{rad}}(T_{\\text{root}}) > 0$ for $T_{\\text{root}} > 0$, the stability condition simplifies to checking the sign of the term in parentheses.\n\nThe numerical procedure is as follows:\n1.  For each test case, define the functions $P_{\\text{net}}(T)$ and the stability check function derived from $\\frac{dP_{\\text{net}}}{dT}$.\n2.  Discretize the search interval $[T_{\\min}, T_{\\max}]$ into a fine grid of points.\n3.  Iterate through adjacent grid points $(T_j, T_{j+1})$ and check for a sign change in $P_{\\text{net}}(T)$, i.e., $P_{\\text{net}}(T_j) \\cdot P_{\\text{net}}(T_{j+1}) < 0$.\n4.  For each sub-interval where a sign change is detected, use a robust numerical root-finding algorithm, such as Brent's method (`scipy.optimize.brentq`), to find the precise root $T_{\\text{root}}$.\n5.  For each root found, verify if it satisfies the stability condition $\\left.\\frac{dP_{\\text{net}}}{dT}\\right|_{T_{\\text{root}}} > 0$.\n6.  Collect all valid roots that satisfy the condition. The ignition temperature $T_{\\text{ign}}$ is the minimum of these valid roots.\n7.  If no such roots are found, $T_{\\text{ign}}$ does not exist in the specified range, and the required energy is reported as $-1.0$.\n8.  If $T_{\\text{ign}}$ is found, calculate the minimum additional energy $E_{\\text{add,min}}$. If the initial temperature $T_0 \\ge T_{\\text{ign}}$, ignition has already been surpassed, so $E_{\\text{add,min}} = 0$. Otherwise,\n    $$\n    E_{\\text{add,min}} = E(T_{\\text{ign}}) - E(T_0) = \\frac{3}{2} (n_e + n_i) \\, V \\, (T_{\\text{ign}} - T_0) \\, E_{\\mathrm{keV}}\n    $$\n    Using $n_e=n_i$, this is $E_{\\text{add,min}} = 3 n_i V (T_{\\text{ign}} - T_0) E_{\\mathrm{keV}}$.\n9.  The final result for each case is formatted to three significant figures.",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases for hot spot ignition.\n    \"\"\"\n    # Physical Constants\n    E_KEV = 1.602176634e-16  # Energy of 1 keV in Joules\n    E_ALPHA_J = 3.5e3 * E_KEV  # Alpha particle energy in Joules\n\n    # Test cases as provided in the problem description.\n    # Format: (n_i, n_e, V, f_alpha, S0, Ts, b, Cb, T0, Tmin, Tmax)\n    test_cases = [\n        # Case 1\n        (5.0e30, 5.0e30, 1.0e-12, 0.85, 1.0e-22, 40.0, 3.0, 1.0e-35, 2.0, 0.5, 30.0),\n        # Case 2\n        (5.0e30, 5.0e30, 1.0e-12, 0.85, 1.0e-22, 40.0, 3.0, 1.0e-35, 8.0, 0.5, 30.0),\n        # Case 3\n        (5.0e30, 5.0e30, 1.0e-12, 0.85, 1.0e-22, 40.0, 3.0, 1.0e-34, 2.0, 0.5, 20.0),\n        # Case 4\n        (1.0e30, 1.0e30, 5.0e-13, 0.85, 1.0e-22, 40.0, 3.0, 1.0e-35, 1.0, 0.5, 30.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        energy_result = calculate_ignition_energy(case, E_KEV, E_ALPHA_J)\n        # Format to 3 significant figures. The 'g' format is ideal for this.\n        if energy_result == -1.0:\n            formatted_result = \"-1.0\"\n        else:\n            formatted_result = f\"{energy_result:.3g}\"\n        results.append(formatted_result)\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_ignition_energy(case_params, e_kev, e_alpha_j):\n    \"\"\"\n    Calculates the minimum additional energy for a single test case.\n    \"\"\"\n    n_i, n_e, V, f_alpha, S0, Ts, b, Cb, T0, Tmin, Tmax = case_params\n\n    # Z_eff = 1 for D-T plasma is assumed\n    Z_eff = 1.0\n\n    # Constant factors for power equations\n    # Q_rad(T) = K_rad * T**0.5\n    K_rad = Cb * (Z_eff**2) * n_e * n_i * V\n    # Q_alpha(T) = K_alpha * (T**2 / (1 + T / Ts)) * exp(-b * T**(-1/3))\n    K_alpha = f_alpha * e_alpha_j * V * (n_i**2 / 4.0) * S0\n    \n    # Power functions\n    def q_alpha(T):\n        if T <= 0: return 0.0\n        return K_alpha * (T**2 / (1 + T / Ts)) * np.exp(-b * T**(-1/3))\n\n    def q_rad(T):\n        if T <= 0: return 0.0\n        return K_rad * np.sqrt(T)\n\n    # Net power P_net(T) = Q_alpha(T) - Q_rad(T)\n    def p_net(T):\n        return q_alpha(T) - q_rad(T)\n\n    # Stability condition check: dP_net/dT > 0\n    # This simplifies to: 3/(2*T) - 1/(T+Ts) + b/(3*T**(4/3)) > 0\n    def check_stability(T):\n        if T <= 0: return False\n        return (1.5 / T - 1.0 / (T + Ts) + b / (3.0 * T**(4.0/3.0))) > 0\n\n    # --- Numerical search for ignition temperature T_ign ---\n    num_points = 2000\n    temp_grid = np.linspace(Tmin, Tmax, num_points)\n    ignition_candidates = []\n\n    for i in range(num_points - 1):\n        T1, T2 = temp_grid[i], temp_grid[i+1]\n        p_net1, p_net2 = p_net(T1), p_net(T2)\n        \n        # Check for sign change, indicating a root in [T1, T2]\n        if np.sign(p_net1) != np.sign(p_net2):\n            try:\n                root = optimize.brentq(p_net, T1, T2)\n                # Check if the root satisfies the stability condition\n                if check_stability(root):\n                    ignition_candidates.append(root)\n            except (ValueError, RuntimeError):\n                # brentq can fail if values are too close to zero, or if the interval is invalid\n                continue\n    \n    if not ignition_candidates:\n        return -1.0 # No ignition temperature found\n\n    T_ign = min(ignition_candidates)\n\n    # --- Calculate minimum additional energy ---\n    if T0 >= T_ign:\n        return 0.0\n    else:\n        # E_add_min = E(T_ign) - E(T0)\n        # E(T) = 1.5 * (n_e + n_i) * V * T * e_kev\n        # For n_e = n_i: E(T) = 3 * n_i * V * T * e_kev\n        E_add_min = 3.0 * n_i * V * (T_ign - T0) * e_kev\n        return E_add_min\n\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Achieving ignition is not just about winning the energy balance, but also winning a race against time before the plasma disassembles. This practice explores the critical interplay between different physical timescales that govern a hot spot's life. You will derive and compare the characteristic time for radiation to diffuse out of the hot spot against the time it takes for the hot spot to fly apart hydrodynamically . This order-of-magnitude analysis is a powerful tool that builds crucial physical intuition, helping you assess whether the conditions for ignition can be sustained long enough for fusion burn to propagate.",
            "id": "3991404",
            "problem": "A spherical deuterium–tritium (DT) hot spot of radius $R_{hs}$ embedded in an inertial confinement fusion capsule can exchange radiation energy internally by diffusion when the optical depth is sufficiently large. Consider a gray (frequency-integrated) radiation model in the optically thick limit, where the radiation energy density $E_{r}(\\mathbf{x},t)$ obeys a diffusion-type evolution inside the hot spot. Assume the hot spot is initially perturbed from uniform radiation energy density and that the boundary behaves as a strong sink for radiation (vacuum-like losses), so that energy density gradients drive outward fluxes at the edge. Starting from the diffusion equation for $E_{r}$ and physically appropriate boundary conditions for a finite sphere, derive an order-of-magnitude expression for the characteristic radiation equilibration time scale $t_{\\mathrm{rad}}$ in terms of the hot spot radius $R_{hs}$ and the radiation diffusion coefficient $D_{\\mathrm{rad}}$. Based on this derivation, approximate $t_{\\mathrm{rad}} \\sim R_{hs}^{2}/D_{\\mathrm{rad}}$ up to an order-unity factor determined by the boundary condition.\n\nNext, evaluate whether radiation can equilibrate before hydrodynamic disassembly by comparing $t_{\\mathrm{rad}}$ to a disassembly time $t_{d}$. Model the disassembly time as $t_{d}\\approx R_{hs}/c_{s}$, where $c_{s}$ is the effective sound speed of a fully ionized DT plasma with adiabatic index $\\gamma=5/3$, equal ion and electron temperatures $T_{i}=T_{e}=T$, and ion charge number $Z=1$. Use the ideal-gas relation for a two-species plasma to show that $c_{s}=\\sqrt{(2\\gamma k_{B}T)/m_{i}}$, where $m_{i}$ is the average ion mass of the DT mixture. Treat the radiation diffusion coefficient in the gray Rosseland limit as $D_{\\mathrm{rad}}=c/\\left(3\\kappa_{R}\\rho\\right)$, where $c$ is the speed of light, $\\kappa_{R}$ is the Rosseland mean opacity, and $\\rho$ is the mass density.\n\nFor numerical evaluation, use the following parameters, chosen to be physically realistic for an ignition-relevant hot spot:\n- $R_{hs}=30\\,\\mu\\mathrm{m}$,\n- $\\rho=50\\,\\mathrm{g/cm^{3}}$,\n- $\\kappa_{R}=0.20\\,\\mathrm{cm^{2}/g}$,\n- $T=5\\,\\mathrm{keV}$,\n- $m_{i}=\\left(m_{D}+m_{T}\\right)/2$ with $m_{D}=2m_{p}$, $m_{T}=3m_{p}$, and $m_{p}=1.6726\\times 10^{-24}\\,\\mathrm{g}$,\n- $c=3.00\\times 10^{10}\\,\\mathrm{cm/s}$,\n- $1\\,\\mathrm{eV}=1.602176634\\times 10^{-12}\\,\\mathrm{erg}$ so that $k_{B}T$ may be expressed directly in $\\mathrm{erg}$.\n\nCompute the ratio $t_{\\mathrm{rad}}/t_{d}$ using the order-of-magnitude form $t_{\\mathrm{rad}}\\sim R_{hs}^{2}/D_{\\mathrm{rad}}$. Round your final ratio to four significant figures and express it as a pure decimal number without units.",
            "solution": "The problem asks for a comparison of the radiation equilibration time scale and the hydrodynamic disassembly time scale for an inertial confinement fusion hot spot. This requires a derivation of these time scales followed by a numerical evaluation.\n\nFirst, we validate the problem statement.\nAll givens are extracted verbatim:\n-   A spherical deuterium–tritium (DT) hot spot of radius $R_{hs}$.\n-   Gray radiation model, optically thick limit, diffusion equation for radiation energy density $E_{r}(\\mathbf{x},t)$.\n-   Boundary condition: strong sink for radiation at the edge.\n-   Order-of-magnitude expression for radiation equilibration time: $t_{\\mathrm{rad}} \\sim R_{hs}^{2}/D_{\\mathrm{rad}}$.\n-   Radiation diffusion coefficient: $D_{\\mathrm{rad}}=c/\\left(3\\kappa_{R}\\rho\\right)$.\n-   Disassembly time: $t_{d}\\approx R_{hs}/c_{s}$.\n-   Sound speed $c_{s}$ for a fully ionized DT plasma with adiabatic index $\\gamma=5/3$, equal temperatures $T_{i}=T_{e}=T$, and ion charge number $Z=1$.\n-   Formula to be shown for sound speed: $c_{s}=\\sqrt{(2\\gamma k_{B}T)/m_{i}}$.\n-   Average ion mass definition: $m_{i}=\\left(m_{D}+m_{T}\\right)/2$ with $m_{D}=2m_{p}$ and $m_{T}=3m_{p}$.\n-   Numerical values:\n    -   $R_{hs}=30\\,\\mu\\mathrm{m}$\n    -   $\\rho=50\\,\\mathrm{g/cm^{3}}$\n    -   $\\kappa_{R}=0.20\\,\\mathrm{cm^{2}/g}$\n    -   $T=5\\,\\mathrm{keV}$\n    -   $m_{p}=1.6726\\times 10^{-24}\\,\\mathrm{g}$\n    -   $c=3.00\\times 10^{10}\\,\\mathrm{cm/s}$\n    -   $1\\,\\mathrm{eV}=1.602176634\\times 10^{-12}\\,\\mathrm{erg}$\n\nThe problem is scientifically grounded in the principles of plasma physics and radiative transfer, specifically within the context of inertial confinement fusion. All concepts, such as the radiation diffusion approximation, Rosseland mean opacity, and plasma sound speed, are standard in the field. The provided parameters are physically realistic for an ignition-scale hot spot. The problem is well-posed, providing a clear path from derivation to numerical calculation with all necessary data. The language is objective and unambiguous. Therefore, the problem is deemed valid.\n\nWe proceed with the solution.\n\nThe first step is to establish the order-of-magnitude expression for the radiation equilibration time, $t_{\\mathrm{rad}}$. The evolution of the radiation energy density, $E_r$, in the diffusion limit is given by the diffusion equation:\n$$\n\\frac{\\partial E_r}{\\partial t} = \\nabla \\cdot (D_{\\mathrm{rad}} \\nabla E_r)\n$$\nAssuming the radiation diffusion coefficient $D_{\\mathrm{rad}}$ is uniform, this simplifies to:\n$$\n\\frac{\\partial E_r}{\\partial t} = D_{\\mathrm{rad}} \\nabla^2 E_r\n$$\nThis is a parabolic partial differential equation. A dimensional analysis of this equation reveals the characteristic time scale $t$ for changes to propagate over a characteristic length scale $L$. The time derivative term scales as $1/t$, while the spatial derivative term scales as $1/L^2$. Equating the scales gives:\n$$\n\\frac{1}{t_{\\mathrm{rad}}} \\sim \\frac{D_{\\mathrm{rad}}}{R_{hs}^2}\n$$\nwhere the characteristic length scale is the hot spot radius, $R_{hs}$. This yields the order-of-magnitude relationship:\n$$\nt_{\\mathrm{rad}} \\sim \\frac{R_{hs}^2}{D_{\\mathrm{rad}}}\n$$\nThe problem states to use this form, which neglects an order-unity geometric factor (e.g., $1/\\pi^2$) that would arise from a full solution with specific boundary conditions.\n\nNext, we derive the expression for the sound speed, $c_s$. The sound speed in a fluid is generally given by $c_s = \\sqrt{(\\partial P / \\partial \\rho)_S}$, where the derivative is taken at constant entropy (adiabatically). For an ideal gas with a constant adiabatic index $\\gamma$, this relationship simplifies to:\n$$\nc_s = \\sqrt{\\frac{\\gamma P}{\\rho}}\n$$\nThe plasma consists of ions (a $50/50$ mix of D and T) and electrons. The total pressure $P$ is the sum of the ion pressure $P_i$ and the electron pressure $P_e$, both treated as ideal gases:\n$$\nP = P_i + P_e = n_i k_B T_i + n_e k_B T_e\n$$\nHere, $n_i$ and $n_e$ are the ion and electron number densities, and $T_i$ and $T_e$ are their respective temperatures. The problem specifies $T_i = T_e = T$. For a fully ionized DT plasma, both deuterium ($Z=1$) and tritium ($Z=1$) contribute one electron per ion. Thus, quasi-neutrality requires the electron number density to equal the ion number density, $n_e = n_i$. The total pressure becomes:\n$$\nP = n_i k_B T + n_i k_B T = 2 n_i k_B T\n$$\nThe mass density $\\rho$ is dominated by the ions, so we can approximate $\\rho \\approx n_i m_i$, where $m_i$ is the average ion mass. Substituting the expressions for $P$ and $\\rho$ into the sound speed formula yields:\n$$\nc_s = \\sqrt{\\frac{\\gamma (2 n_i k_B T)}{n_i m_i}} = \\sqrt{\\frac{2 \\gamma k_B T}{m_i}}\n$$\nThis confirms the expression given in the problem statement. The factor of $2$ arises from including the electron pressure.\n\nWe now form the ratio of the two time scales, $t_{\\mathrm{rad}}/t_d$. Using the provided definitions:\n$$\n\\frac{t_{\\mathrm{rad}}}{t_d} \\approx \\frac{R_{hs}^2 / D_{\\mathrm{rad}}}{R_{hs} / c_s} = \\frac{R_{hs} c_s}{D_{\\mathrm{rad}}}\n$$\nSubstituting the expressions for $c_s$ and $D_{\\mathrm{rad}}$:\n$$\n\\frac{t_{\\mathrm{rad}}}{t_d} \\approx \\frac{R_{hs} \\sqrt{\\frac{2 \\gamma k_B T}{m_i}}}{c / (3 \\kappa_R \\rho)} = \\frac{3 R_{hs} \\kappa_R \\rho}{c} \\sqrt{\\frac{2 \\gamma k_B T}{m_i}}\n$$\nThis is the final symbolic expression we need to evaluate. For the numerical calculation, we must use a consistent set of units, for which we choose the CGS system (cm, g, s).\n\nThe given parameters are converted to CGS units:\n-   $R_{hs} = 30\\,\\mu\\mathrm{m} = 30 \\times 10^{-4}\\,\\mathrm{cm} = 3.0 \\times 10^{-3}\\,\\mathrm{cm}$\n-   $\\rho = 50\\,\\mathrm{g/cm^3}$\n-   $\\kappa_R = 0.20\\,\\mathrm{cm^2/g}$\n-   $c = 3.00 \\times 10^{10}\\,\\mathrm{cm/s}$\n-   $\\gamma = 5/3$\n\nWe calculate the remaining terms. The thermal energy $k_B T$ is given in terms of $T=5\\,\\mathrm{keV}$:\n$$\nk_B T = 5\\,\\mathrm{keV} = 5 \\times 10^3\\,\\mathrm{eV} \\times (1.602176634 \\times 10^{-12}\\,\\mathrm{erg/eV}) = 8.01088317 \\times 10^{-9}\\,\\mathrm{erg}\n$$\nThe average ion mass $m_i$ is:\n$$\nm_p = 1.6726 \\times 10^{-24}\\,\\mathrm{g}\n$$\n$$\nm_D = 2 m_p = 3.3452 \\times 10^{-24}\\,\\mathrm{g}\n$$\n$$\nm_T = 3 m_p = 5.0178 \\times 10^{-24}\\,\\mathrm{g}\n$$\n$$\nm_i = \\frac{m_D + m_T}{2} = \\frac{(3.3452 + 5.0178) \\times 10^{-24}}{2}\\,\\mathrm{g} = \\frac{8.363 \\times 10^{-24}}{2}\\,\\mathrm{g} = 4.1815 \\times 10^{-24}\\,\\mathrm{g}\n$$\nNow we compute the sound speed $c_s$:\n$$\nc_s = \\sqrt{\\frac{2 \\gamma k_B T}{m_i}} = \\sqrt{\\frac{2 \\times (5/3) \\times (8.01088317 \\times 10^{-9}\\,\\mathrm{erg})}{4.1815 \\times 10^{-24}\\,\\mathrm{g}}} \n$$\n$$\nc_s = \\sqrt{\\frac{2.67029439 \\times 10^{-8}}{4.1815 \\times 10^{-24}}}\\,\\mathrm{cm/s} = \\sqrt{6.386068 \\times 10^{15}}\\,\\mathrm{cm/s} \\approx 7.991288 \\times 10^7\\,\\mathrm{cm/s}\n$$\nNext, we compute the radiation diffusion coefficient $D_{\\mathrm{rad}}$:\n$$\nD_{\\mathrm{rad}} = \\frac{c}{3 \\kappa_R \\rho} = \\frac{3.00 \\times 10^{10}\\,\\mathrm{cm/s}}{3 \\times (0.20\\,\\mathrm{cm^2/g}) \\times (50\\,\\mathrm{g/cm^3})} = \\frac{3.00 \\times 10^{10}}{30}\\,\\mathrm{cm^2/s} = 1.0 \\times 10^9\\,\\mathrm{cm^2/s}\n$$\nFinally, we compute the ratio $t_{\\mathrm{rad}}/t_d$:\n$$\n\\frac{t_{\\mathrm{rad}}}{t_d} \\approx \\frac{R_{hs} c_s}{D_{\\mathrm{rad}}} = \\frac{(3.0 \\times 10^{-3}\\,\\mathrm{cm}) \\times (7.991288 \\times 10^7\\,\\mathrm{cm/s})}{1.0 \\times 10^9\\,\\mathrm{cm^2/s}}\n$$\n$$\n\\frac{t_{\\mathrm{rad}}}{t_d} \\approx \\frac{2.3973864 \\times 10^5}{1.0 \\times 10^9} = 2.3973864 \\times 10^{-4}\n$$\nRounding this result to four significant figures as a pure decimal number gives $0.0002397$. This result, being much less than $1$, implies that radiation transport is very rapid compared to the hydrodynamic motion of the hot spot. Radiation will therefore equilibrate its temperature profile on a time scale much shorter than the time it takes for the hot spot to disassemble.",
            "answer": "$$\n\\boxed{0.0002397}\n$$"
        },
        {
            "introduction": "In computational science, we often rely on simplified \"surrogate\" models for rapid analysis, but their validity must be confirmed against more comprehensive, physically-detailed models. This exercise puts you in the role of a model developer, tasking you with building and validating an ignition metric. You will compare a simple ignition parameter against one derived from a more advanced model that includes transport effects like alpha-particle escape and flux-limited thermal conduction . This hands-on comparison is essential for understanding the limitations of simple models and appreciating the impact of transport physics on ignition predictions.",
            "id": "3991340",
            "problem": "You are tasked with constructing a surrogate ignition metric for a Deuterium–Tritium hot spot and validating its accuracy against a more complete transport model across the temperature range $3\\text{–}10\\ \\text{keV}$. The surrogate ignition metric is defined as the dimensionless ratio $ \\Pi = Q_{\\alpha}/Q_{\\text{loss}} $, where $ Q_{\\alpha} $ is alpha-particle heating and $ Q_{\\text{loss}} $ is the total thermal loss. Your program must compute $ \\Pi $ using both a surrogate model and a more complete transport model, and then quantify the discrepancy between them.\n\nBegin from first principles appropriate for computational fusion science and engineering:\n\n- Fusion power density for a Deuterium–Tritium mixture is based on the reaction rate density $ R_{\\text{fus}} = n_D n_T \\langle \\sigma v \\rangle(T) $, where $ n_D $ and $ n_T $ are the Deuterium and Tritium number densities, respectively, and $ \\langle \\sigma v \\rangle(T) $ is the thermally averaged reaction rate coefficient at temperature $ T $. For an equimolar mixture, take $ n_D = n_T = n_i/2 $, where $ n_i $ is the ion number density.\n\n- Alpha-particle heating power density is $ p_{\\alpha} = R_{\\text{fus}} E_{\\alpha} $, where $ E_{\\alpha} $ is the alpha energy. The total alpha heating power is $ P_{\\alpha} = p_{\\alpha} V $, where $ V $ is the hot spot volume. In the surrogate model, assume full alpha deposition. In the transport model, account for finite areal density using a deposition fraction $ f_{\\text{dep}} = 1 - \\exp\\left( -\\frac{\\rho R}{\\rho R_0} \\right) $, where $ \\rho = n_i m_i $ is the mass density, $ m_i $ is the average ion mass for equimolar Deuterium–Tritium, $ R $ is the hot spot radius, and $ \\rho R_0 $ is a characteristic alpha range areal density.\n\n- Thermal conduction loss is modeled by Fourier’s law with Spitzer–Härm electron thermal conductivity. The classical conduction heat flux magnitude is $ q_{\\text{class}} = \\kappa_e \\frac{T_e}{R} $, with total conduction power $ P_{\\text{cond,class}} = 4\\pi R^2 q_{\\text{class}} $. Use the Spitzer conductivity $ \\kappa_e = \\frac{1.84 \\times 10^{-5}\\ T_e^{5/2}}{Z_{\\text{eff}} \\ln\\Lambda} $ in $\\text{W}/(\\text{m}\\cdot\\text{K})$ for a fully ionized plasma, where $ T_e $ is the electron temperature in $\\text{K}$, $ Z_{\\text{eff}} $ is the effective charge number, and $ \\ln\\Lambda $ is the Coulomb logarithm. In the transport model, apply a flux limiter with limited heat flux $ q_{\\text{lim}} = f_L n_e k_B T_e v_{e,\\text{th}} $, where $ n_e $ is the electron number density, $ k_B $ is Boltzmann’s constant, and $ v_{e,\\text{th}} = \\sqrt{\\frac{8 k_B T_e}{\\pi m_e}} $ is the electron thermal speed. The flux-limited conduction power is $ P_{\\text{cond,FL}} = 4\\pi R^2 \\min(q_{\\text{class}}, q_{\\text{lim}}) $.\n\n- Bremsstrahlung radiation loss power is $ P_{\\text{brem}} = C_b Z_{\\text{eff}}^2 n_e n_i \\sqrt{T_e} V $, where $ C_b $ is a constant emissivity coefficient in $\\text{W}\\cdot\\text{m}^3\\cdot\\text{K}^{-1/2}$.\n\nDefine the surrogate ignition ratio as $ \\Pi_{\\text{surr}} = \\frac{P_{\\alpha,\\text{surr}}}{P_{\\text{cond,class}} + P_{\\text{brem}}} $ with $ P_{\\alpha,\\text{surr}} = p_{\\alpha} V $ assuming full deposition, and the transport-model ignition ratio as $ \\Pi_{\\text{full}} = \\frac{P_{\\alpha,\\text{full}}}{P_{\\text{cond,FL}} + P_{\\text{brem}}} $ with $ P_{\\alpha,\\text{full}} = f_{\\text{dep}} p_{\\alpha} V $. Quantify accuracy by the per-case relative error $ \\varepsilon = \\left| \\Pi_{\\text{surr}} - \\Pi_{\\text{full}} \\right| / \\Pi_{\\text{full}} $, and also report the fraction of cases where the surrogate and full models agree on the ignition threshold decision $ (\\Pi > 1) $.\n\nImplement the following scientifically sound constants and conversions:\n- $ E_{\\alpha} = 3.5\\ \\text{MeV} $ converted to Joules.\n- $ m_i = 2.5\\ \\text{amu} $ converted to kilograms.\n- $ Z_{\\text{eff}} = 1 $.\n- $ \\ln\\Lambda = 7 $.\n- $ f_L = 0.06 $.\n- $ C_b = 1.69 \\times 10^{-38}\\ \\text{W}\\cdot\\text{m}^3\\cdot\\text{K}^{-1/2} $.\n- $ k_B $ and $ m_e $ are the Boltzmann constant and electron mass in SI units.\n- Convert temperature $ T $ from $\\text{keV}$ to $\\text{K}$ using $ 1\\ \\text{eV} = 11604.525\\ \\text{K} $.\n\nUse a well-tested reaction rate coefficient $ \\langle \\sigma v \\rangle(T) $ for Deuterium–Tritium in $ \\text{m}^3/\\text{s} $ based on tabulated values and monotone interpolation:\n- Tabulated $ T $ in $\\text{keV}$: $ [3,\\ 4,\\ 5,\\ 7,\\ 10] $.\n- Tabulated $ \\langle \\sigma v \\rangle $ in $ \\text{m}^3/\\text{s} $: $ [1.0\\times 10^{-22},\\ 2.4\\times 10^{-22},\\ 4.5\\times 10^{-22},\\ 7.5\\times 10^{-22},\\ 1.1\\times 10^{-21}] $.\nInterpolate $ \\langle \\sigma v \\rangle(T) $ monotonically over $ T \\in [3,10]\\ \\text{keV} $.\n\nAdopt the alpha deposition areal density scale $ \\rho R_0 = 0.003\\ \\text{kg}/\\text{m}^2 $.\n\nYour program must evaluate the following test suite of hot-spot parameter sets, each specified by $ (T,\\ n_i,\\ R) $:\n- Case $1$: $ (3\\ \\text{keV},\\ 5\\times 10^{28}\\ \\text{m}^{-3},\\ 1\\times 10^{-6}\\ \\text{m}) $.\n- Case $2$: $ (5\\ \\text{keV},\\ 1\\times 10^{31}\\ \\text{m}^{-3},\\ 2\\times 10^{-5}\\ \\text{m}) $.\n- Case $3$: $ (7\\ \\text{keV},\\ 2\\times 10^{31}\\ \\text{m}^{-3},\\ 5\\times 10^{-5}\\ \\text{m}) $.\n- Case $4$: $ (10\\ \\text{keV},\\ 5\\times 10^{31}\\ \\text{m}^{-3},\\ 1\\times 10^{-4}\\ \\text{m}) $.\n\nFor each case, compute $ \\Pi_{\\text{surr}} $, $ \\Pi_{\\text{full}} $, and then the relative error $ \\varepsilon $. Also determine the ignition decision for each model by checking whether $ \\Pi > 1 $. Finally, compute the root-mean-square error $ \\varepsilon_{\\text{RMS}} $ across all cases and the ignition-agreement fraction $ f_{\\text{agree}} $ equal to the number of cases where both models make the same ignition decision divided by the total number of cases, expressed as a decimal.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, formatted as $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4,\\varepsilon_{\\text{RMS}},f_{\\text{agree}}]$, where each $ \\varepsilon_i $ is a float and $ f_{\\text{agree}} $ is a float in $[0,1]$. All quantities are dimensionless. No external input should be read; all parameters must be defined internally within the program.",
            "solution": "The objective of this problem is to construct and compare two models for the ignition condition of a spherical Deuterium-Tritium (DT) plasma hot spot: a simplified surrogate model and a more comprehensive transport model. The comparison is performed over a range of hot spot temperatures from $3\\ \\text{keV}$ to $10\\ \\text{keV}$. The central quantity is the ignition parameter, $\\Pi$, defined as the ratio of alpha-particle heating power, $P_{\\alpha}$, to the total thermal power loss, $P_{\\text{loss}}$. An ignition condition is met when $\\Pi > 1$.\n\nWe begin by establishing the fundamental physical constants and conversion factors required for the calculations, all in SI units.\n-   Charge of an electron: $e \\approx 1.602 \\times 10^{-19}\\ \\text{C}$.\n-   Boltzmann constant: $k_B \\approx 1.381 \\times 10^{-23}\\ \\text{J/K}$.\n-   Electron mass: $m_e \\approx 9.109 \\times 10^{-31}\\ \\text{kg}$.\n-   Atomic mass unit: $1\\ \\text{amu} \\approx 1.661 \\times 10^{-27}\\ \\text{kg}$.\nThe problem provides specific values for model parameters and conversions:\n-   Alpha particle energy: $E_{\\alpha} = 3.5\\ \\text{MeV} = 3.5 \\times 10^6\\ \\text{eV} \\times e \\approx 5.608 \\times 10^{-13}\\ \\text{J}$.\n-   Average ion mass for an equimolar DT mixture: $m_i = 2.5\\ \\text{amu} \\approx 4.151 \\times 10^{-27}\\ \\text{kg}$.\n-   Temperature conversion: Temperature in Kelvin, $T_{\\text{K}}$, is related to temperature in kilo-electron-volts, $T_{\\text{keV}}$, by $T_{\\text{K}} = T_{\\text{keV}} \\times 1000 \\times 11604.525$.\nWe assume a spherical hot spot of radius $R$, giving a volume $V = \\frac{4}{3}\\pi R^3$ and surface area $A = 4\\pi R^2$. The plasma is an equimolar, fully ionized DT mixture, so the Deuterium and Tritium number densities are $n_D = n_T = n_i/2$, where $n_i$ is the total ion number density. Due to charge neutrality, the electron number density is $n_e = n_D + n_T = n_i$. The effective charge is $Z_{\\text{eff}} = \\frac{\\sum_j n_j Z_j^2}{\\sum_j n_j Z_j} = \\frac{n_D(1)^2 + n_T(1)^2}{n_D(1) + n_T(1)} = 1$. The problem assumes thermal equilibrium, so $T_e = T_i = T$.\n\nFirst, we formulate the alpha-particle heating power, $P_{\\alpha}$. The fusion reaction rate density for the DT reaction is given by $R_{\\text{fus}} = n_D n_T \\langle \\sigma v \\rangle(T) = \\frac{1}{4} n_i^2 \\langle \\sigma v \\rangle(T)$. The term $\\langle \\sigma v \\rangle(T)$ is the thermally averaged reaction rate coefficient, which is a strong function of temperature. Its value is determined by monotonic linear interpolation from the provided tabulated data: $(T\\ [\\text{keV}], \\langle \\sigma v \\rangle\\ [\\text{m}^3/\\text{s}])$ pairs of $(3, 1.0\\times 10^{-22})$, $(4, 2.4\\times 10^{-22})$, $(5, 4.5\\times 10^{-22})$, $(7, 7.5\\times 10^{-22})$, and $(10, 1.1\\times 10^{-21})$. The alpha heating power density is then $p_{\\alpha} = R_{\\text{fus}} E_{\\alpha}$. The total power generated is $p_{\\alpha} V$.\nThe two models differ in their treatment of alpha-particle energy deposition.\n-   The surrogate model assumes all alpha particles deposit their energy locally. The heating power is $P_{\\alpha,\\text{surr}} = p_{\\alpha} V = \\frac{1}{4} n_i^2 \\langle \\sigma v \\rangle(T) E_{\\alpha} V$.\n-   The transport model accounts for alpha-particle escape from the finite hot spot. This is modeled via a deposition fraction, $f_{\\text{dep}} = 1 - \\exp\\left( -\\frac{\\rho R}{\\rho R_0} \\right)$. Here, $\\rho = n_i m_i$ is the hot spot mass density, $R$ is the radius, and $\\rho R_0 = 0.003\\ \\text{kg}/\\text{m}^2$ is the characteristic areal density for alpha stopping. The heating power in this model is $P_{\\alpha,\\text{full}} = f_{\\text{dep}} P_{\\alpha,\\text{surr}}$.\n\nNext, we formulate the power loss terms, $P_{\\text{loss}}$. The two primary loss mechanisms considered are thermal conduction and Bremsstrahlung radiation.\nThe Bremsstrahlung radiation power loss is given by $P_{\\text{brem}} = C_b Z_{\\text{eff}}^2 n_e n_i \\sqrt{T} V$. Using the model parameters $Z_{\\text{eff}}=1$, $n_e=n_i$, and the provided constant $C_b = 1.69 \\times 10^{-38}\\ \\text{W}\\cdot\\text{m}^3\\cdot\\text{K}^{-1/2}$, with temperature $T$ in Kelvin, this becomes $P_{\\text{brem}} = C_b n_i^2 \\sqrt{T} V$. This term is identical in both the surrogate and full models.\n\nThe thermal conduction loss model is another point of divergence between the two approaches.\n-   The surrogate model uses the classical Spitzer-Härm electron thermal conductivity, $\\kappa_e$, in Fourier's law. The heat flux is approximated as $q_{\\text{class}} = \\kappa_e \\frac{T}{R}$, where $T/R$ represents the temperature gradient scale length. The total conduction power loss is $P_{\\text{cond,class}} = A \\cdot q_{\\text{class}} = 4\\pi R^2 (\\kappa_e \\frac{T}{R}) = 4\\pi R \\kappa_e T$. The Spitzer conductivity is $\\kappa_e = \\frac{1.84 \\times 10^{-5}\\ T^{5/2}}{Z_{\\text{eff}} \\ln\\Lambda}$, with $T$ in Kelvin, $Z_{\\text{eff}}=1$, and the Coulomb logarithm $\\ln\\Lambda = 7$.\n-   The transport model recognizes that in steep temperature gradients, the classical diffusive heat flux can become unphysically large, exceeding the rate at which electrons can freely stream. This is corrected by applying a flux limiter. The classical flux $q_{\\text{class}}$ is compared to a limited flux, $q_{\\text{lim}} = f_L n_e k_B T v_{e,\\text{th}}$, where $f_L=0.06$ is the flux-limiter coefficient and $v_{e,\\text{th}} = \\sqrt{\\frac{8 k_B T}{\\pi m_e}}$ is the electron thermal speed. The actual heat flux is the minimum of these two values, $q_{\\text{FL}} = \\min(q_{\\text{class}}, q_{\\text{lim}})$. The flux-limited conduction power is $P_{\\text{cond,FL}} = A \\cdot q_{\\text{FL}} = 4\\pi R^2 \\min(q_{\\text{class}}, q_{\\text{lim}})$.\n\nWith all power terms defined, we can assemble the ignition metrics for each model.\n-   Surrogate model: $\\Pi_{\\text{surr}} = \\frac{P_{\\alpha,\\text{surr}}}{P_{\\text{cond,class}} + P_{\\text{brem}}}$.\n-   Transport model: $\\Pi_{\\text{full}} = \\frac{P_{\\alpha,\\text{full}}}{P_{\\text{cond,FL}} + P_{\\text{brem}}}$.\n\nThe final step is to quantify the discrepancy between the two models for the given test cases. For each case $i$, we compute the relative error $\\varepsilon_i = \\frac{\\left| \\Pi_{\\text{surr},i} - \\Pi_{\\text{full},i} \\right|}{\\Pi_{\\text{full},i}}$. We also determine the ignition decision for each model based on the criterion $\\Pi > 1$. The overall performance is evaluated using two metrics: the root-mean-square error over all cases, $\\varepsilon_{\\text{RMS}} = \\sqrt{\\frac{1}{N}\\sum_i \\varepsilon_i^2}$, where $N=4$ is the number of cases; and the ignition-agreement fraction, $f_{\\text{agree}}$, which is the fraction of cases where both models yield the same ignition decision (either both $\\Pi > 1$ or both $\\Pi \\le 1$).\n\nThe computational algorithm proceeds as follows for each test case $(T, n_i, R)$:\n1.  Convert temperature $T$ from $\\text{keV}$ to Kelvin.\n2.  Calculate hot spot volume $V$ and surface area $A$.\n3.  Interpolate to find $\\langle \\sigma v \\rangle(T)$.\n4.  Calculate the surrogate alpha heating power $P_{\\alpha,\\text{surr}}$.\n5.  Calculate the alpha deposition fraction $f_{\\text{dep}}$ and the full model's alpha heating power $P_{\\alpha,\\text{full}}$.\n6.  Calculate the Bremsstrahlung power loss $P_{\\text{brem}}$.\n7.  Calculate the classical conduction power loss $P_{\\text{cond,class}}$.\n8.  Calculate the flux-limited conduction power loss $P_{\\text{cond,FL}}$.\n9.  Compute $\\Pi_{\\text{surr}}$ and $\\Pi_{\\text{full}}$.\n10. Compute the relative error $\\varepsilon$ for the case.\n11. Compare the ignition decisions $(\\Pi > 1)$ for both models.\nAfter processing all cases, compute the final aggregate metrics $\\varepsilon_{\\text{RMS}}$ and $f_{\\text{agree}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import interp1d\n\ndef solve():\n    \"\"\"\n    Computes and compares surrogate and transport-based ignition metrics\n    for a DT hot spot.\n    \"\"\"\n    # --- Scientific and Model Constants (SI Units) ---\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    KB = 1.380649e-23           # Boltzmann constant in J/K\n    M_E = 9.1093837e-31         # Electron mass in kg\n    AMU_TO_KG = 1.660539e-27      # Atomic mass unit to kg conversion\n    PI = np.pi\n\n    # --- Problem-Specific Parameters ---\n    E_ALPHA_MEV = 3.5                           # Alpha energy in MeV\n    E_ALPHA_J = E_ALPHA_MEV * 1e6 * E_CHARGE    # Alpha energy in Joules\n    KEV_TO_K = 11604.525 * 1e3                  # Conversion from keV to K\n    AVG_ION_MASS_AMU = 2.5                      # Average ion mass in amu for equimolar DT\n    M_I = AVG_ION_MASS_AMU * AMU_TO_KG          # Average ion mass in kg\n    Z_EFF = 1.0                                 # Effective charge number\n    COULOMB_LOG = 7.0                           # Coulomb logarithm\n    FLUX_LIMITER = 0.06                         # Electron heat flux limiter\n    C_BREM = 1.69e-38                           # Bremsstrahlung coefficient in W*m^3*K^(-1/2)\n    RHO_R0_ALPHA = 0.003                        # Alpha range areal density in kg/m^2\n    KAPPA_E_COEFF = 1.84e-5                     # Spitzer conductivity coefficient from problem\n\n    # --- Reaction Rate Data for DT Fusion ---\n    # T in keV, <sigma v> in m^3/s\n    sv_temp_kev = np.array([3.0, 4.0, 5.0, 7.0, 10.0])\n    sv_values_m3_s = np.array([1.0e-22, 2.4e-22, 4.5e-22, 7.5e-22, 1.1e-21])\n    \n    # Create a monotonic linear interpolator for the reaction rate\n    sv_func = interp1d(sv_temp_kev, sv_values_m3_s, kind='linear', fill_value=\"extrapolate\")\n\n    # --- Test Suite ---\n    # Each case is a tuple (T in keV, n_i in m^-3, R in m)\n    test_cases = [\n        (3.0, 5e28, 1e-6),\n        (5.0, 1e31, 2e-5),\n        (7.0, 2e31, 5e-5),\n        (10.0, 5e31, 1e-4),\n    ]\n\n    relative_errors = []\n    ignition_agreements = []\n\n    for case in test_cases:\n        T_kev, n_i, R = case\n        \n        # --- Basic Parameters ---\n        T_k = T_kev * KEV_TO_K        # Temperature in Kelvin\n        n_e = n_i                     # Electron number density for Z_eff=1 plasma\n        V = (4.0/3.0) * PI * R**3     # Hot spot volume\n        A = 4.0 * PI * R**2           # Hot spot surface area\n\n        # --- Alpha Heating Power (P_alpha) ---\n        sv = sv_func(T_kev)\n        R_fus = (n_i**2 / 4.0) * sv   # Fusion reaction rate density\n        p_alpha = R_fus * E_ALPHA_J   # Alpha heating power density\n        P_alpha_surr = p_alpha * V    # Surrogate model (full deposition)\n        \n        rho = n_i * M_I\n        rho_R = rho * R\n        f_dep = 1.0 - np.exp(-rho_R / RHO_R0_ALPHA) # Alpha deposition fraction\n        P_alpha_full = f_dep * P_alpha_surr       # Transport model\n\n        # --- Power Loss Terms (P_loss) ---\n        # Bremsstrahlung Radiation Loss (same for both models)\n        P_brem = C_BREM * (Z_EFF**2) * n_e * n_i * np.sqrt(T_k) * V\n\n        # Thermal Conduction Loss\n        # Surrogate Model (Classical Spitzer)\n        kappa_e_spitzer = (KAPPA_E_COEFF * T_k**2.5) / (Z_EFF * COULOMB_LOG)\n        P_cond_class = 4.0 * PI * R * kappa_e_spitzer * T_k\n\n        # Transport Model (Flux-Limited)\n        q_class = kappa_e_spitzer * T_k / R\n        v_eth = np.sqrt((8.0 * KB * T_k) / (PI * M_E))\n        q_lim = FLUX_LIMITER * n_e * KB * T_k * v_eth\n        P_cond_FL = A * min(q_class, q_lim)\n        \n        # --- Ignition Metrics (Pi) ---\n        P_loss_surr = P_cond_class + P_brem\n        P_loss_full = P_cond_FL + P_brem\n        \n        # Avoid division by zero if a loss term is zero, though unlikely\n        Pi_surr = P_alpha_surr / P_loss_surr if P_loss_surr > 0 else 0.\n        Pi_full = P_alpha_full / P_loss_full if P_loss_full > 0 else 0.\n\n        # --- Error and Agreement Analysis ---\n        if Pi_full > 0:\n            error = np.abs(Pi_surr - Pi_full) / Pi_full\n        else: # Handle case where Pi_full is zero\n            error = np.abs(Pi_surr)\n\n        relative_errors.append(error)\n        \n        ignition_surr = Pi_surr > 1.0\n        ignition_full = Pi_full > 1.0\n        ignition_agreements.append(ignition_surr == ignition_full)\n\n    # --- Final Aggregate Metrics ---\n    errors_array = np.array(relative_errors)\n    rms_error = np.sqrt(np.mean(errors_array**2))\n    agreement_fraction = np.mean(ignition_agreements)\n\n    # Format the final output string\n    output_values = relative_errors + [rms_error, agreement_fraction]\n    # The problem asks for float, which is the default for these calculations.\n    # The map(str,...) ensures conversion before joining.\n    print(f\"[{','.join(map(str, output_values))}]\")\n\nsolve()\n```"
        }
    ]
}