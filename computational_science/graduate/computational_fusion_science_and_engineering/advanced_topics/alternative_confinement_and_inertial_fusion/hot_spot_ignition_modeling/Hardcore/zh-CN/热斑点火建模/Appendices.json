{
    "hands_on_practices": [
        {
            "introduction": "点火建模的基石是能量平衡方程。本练习旨在引导您构建一个计算模型，以确定“点火点”，即聚变自加热超过辐射损失的临界点，并计算达到此状态所需的能量。这是在给定条件下确定点火是否可能的基础性计算 。",
            "id": "3991325",
            "problem": "考虑一个等摩尔 Deuterium–Tritium (D–T) 等离子体的热斑，其中，由于快速的电子-离子平衡，假定离子温度 $T_i$ 和电子温度 $T_e$ 在任何时候都相等，即 $T_e = T_i = T$。该热斑的离子数密度为 $n_i$（单位 $\\mathrm{m}^{-3}$），电子数密度为 $n_e$（单位 $\\mathrm{m}^{-3}$），体积为 $V$（单位 $\\mathrm{m}^3$）。在完全电离的等摩尔 D–T 等离子体中，有 $n_D = n_T = n_i/2$，$n_e = n_i$，平均离子电荷数 $Z_{\\text{eff}} = 1$。\n\n热斑的热能是温度 $T$（以千电子伏特 $\\mathrm{keV}$ 为单位，解释为每个粒子的能量）的函数，表示为\n$$\nE(T) = \\frac{3}{2} (n_e + n_i) \\, V \\, T \\, E_{\\mathrm{keV}},\n$$\n其中 $E_{\\mathrm{keV}} = 1.602176634 \\times 10^{-16} \\,\\mathrm{J}$ 是对应于 $1 \\,\\mathrm{keV}$ 的能量。\n\n能量平衡方程为\n$$\n\\frac{dE}{dt} = Q_{\\text{ext}}(t) + Q_{\\alpha}(T) - Q_{\\text{rad}}(T),\n$$\n其中 $Q_{\\text{ext}}(t)$ 是外部提供的功率，$Q_{\\alpha}(T)$ 是 α 粒子自加热功率，$Q_{\\text{rad}}(T)$ 是辐射损失功率。等摩尔 D–T 的 α 粒子加热模型为\n$$\nQ_{\\alpha}(T) = f_{\\alpha} \\, E_{\\alpha}^{\\mathrm{J}} \\, V \\, n_D n_T \\, \\langle \\sigma v \\rangle(T) = f_{\\alpha} \\, E_{\\alpha}^{\\mathrm{J}} \\, V \\, \\frac{n_i^2}{4} \\, \\langle \\sigma v \\rangle(T),\n$$\n其中 $f_{\\alpha} \\in (0,1]$ 是沉积在热斑局部的 α 能量分数，$E_{\\alpha}^{\\mathrm{J}} = 3.5 \\times 10^{3} \\, E_{\\mathrm{keV}}$ 是以焦耳为单位的 α 能量，$\\langle \\sigma v \\rangle(T)$ 是反应率（单位 $\\mathrm{m}^3/\\mathrm{s}$），此处通过类 Gamow 近似进行建模\n$$\n\\langle \\sigma v \\rangle(T) = S_0 \\, \\frac{T^2}{1 + T/T_s} \\, \\exp\\!\\left(- b \\, T^{-1/3}\\right),\n$$\n其中 $S_0$ 是一个单位为 $\\mathrm{m}^3/\\mathrm{s} \\cdot \\mathrm{keV}^{-2}$ 的常数，$T_s$ 是一个单位为 $\\mathrm{keV}$ 的软化尺度，$b$ 是一个无量纲的势垒参数。\n\n辐射功率通过等效的类韧致辐射损失来建模\n$$\nQ_{\\text{rad}}(T) = C_b \\, Z_{\\text{eff}}^2 \\, n_e \\, n_i \\, V \\, \\sqrt{T},\n$$\n其中 $C_b$ 是一个单位为 $\\mathrm{W}\\cdot\\mathrm{m}^3\\cdot\\mathrm{keV}^{-1/2}$ 的常数。因子 $C_b$ 可以解释为包含了对辐射输运和重吸收的修正；对于 D–T 等离子体，$Z_{\\text{eff}} = 1$。\n\n将点火温度 $T_{\\text{ign}}$ 定义为在给定的搜索区间 $[T_{\\min}, T_{\\max}]$ 内满足以下条件的最小温度\n$$\nQ_{\\alpha}(T_{\\text{ign}}) = Q_{\\text{rad}}(T_{\\text{ign}}),\n$$\n并且局部斜率条件\n$$\n\\left.\\frac{d}{dT}\\big(Q_{\\alpha}(T) - Q_{\\text{rad}}(T)\\big)\\right|_{T=T_{\\text{ign}}} > 0\n$$\n成立，以确保当热斑温度略高于 $T_{\\text{ign}}$ 时产生正反馈。\n\n设初始温度为 $T_0$。达到点火所需的最小额外外部能量输入 $E_{\\text{add,min}}$ 定义为，在上述动力学条件下，足以将温度从 $T_0$ 提升到 $T_{\\text{ign}}$ 的 $Q_{\\text{ext}}(t)$ 对时间的最小积分。根据定义，如果 $T_0 \\ge T_{\\text{ign}}$，则 $E_{\\text{add,min}} = 0$。如果在 $[T_{\\min}, T_{\\max}]$ 中不存在点火温度，则报告 $E_{\\text{add,min}} = -1.0$。\n\n任务：\n1. 实现一个程序，对于下面指定的每个测试用例，计算 $T_{\\text{ign}}$，然后计算\n$$\nE_{\\text{add,min}} =\n\\begin{cases}\nE(T_{\\text{ign}}) - E(T_0),  &\\text{若 } T_0  T_{\\text{ign}},\\\\\n0,  \\text{若 } T_0 \\ge T_{\\text{ign}},\n\\end{cases}\n$$\n的值（单位为焦耳）。\n2. 点火温度必须通过数值方法找到，它是 $[T_{\\min}, T_{\\max}]$ 区间内满足斜率条件的 $Q_{\\alpha}(T) - Q_{\\text{rad}}(T)$ 的最小根。如果不存在这样的根，则该测试用例输出 $-1.0$。\n3. 所有最终能量均以焦耳表示，并四舍五入到三位有效数字。\n4. 你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，“[result1,result2,result3]”）。\n\n使用以下测试套件（所有温度单位为 $\\mathrm{keV}$，密度单位为 $\\mathrm{m}^{-3}$，体积单位为 $\\mathrm{m}^3$，幂律常数如前所述）：\n\n- 测试用例 1（一般情况）：\n  - $n_i = 5.0 \\times 10^{30}$, $n_e = 5.0 \\times 10^{30}$, $V = 1.0 \\times 10^{-12}$,\n  - $f_{\\alpha} = 0.85$, $S_0 = 1.0 \\times 10^{-22}$, $T_s = 40.0$, $b = 3.0$, $C_b = 1.0 \\times 10^{-35}$,\n  - $T_0 = 2.0$, $T_{\\min} = 0.5$, $T_{\\max} = 30.0$。\n\n- 测试用例 2（初始温度已高于点火温度）：\n  - 参数与测试用例 1 相同，除了 $T_0 = 8.0$, $T_{\\min} = 0.5$, $T_{\\max} = 30.0$。\n\n- 测试用例 3（由于辐射损失较大，在搜索区间内没有点火）：\n  - 与测试用例 1 相同，除了 $C_b = 1.0 \\times 10^{-34}$, $T_0 = 2.0$, $T_{\\min} = 0.5$, $T_{\\max} = 20.0$。\n\n- 测试用例 4（密度和体积减小；点火阈值相似但能量需求更小）：\n  - $n_i = 1.0 \\times 10^{30}$, $n_e = 1.0 \\times 10^{30}$, $V = 5.0 \\times 10^{-13}$,\n  - $f_{\\alpha} = 0.85$, $S_0 = 1.0 \\times 10^{-22}$, $T_s = 40.0$, $b = 3.0$, $C_b = 1.0 \\times 10^{-35}$,\n  - $T_0 = 1.0$, $T_{\\min} = 0.5$, $T_{\\max} = 30.0$。\n\n你的程序必须为所有四个测试用例实现上述计算，并生成单行输出，其中包含四个结果（单位为焦耳），四舍五入到三位有效数字，并以逗号分隔的列表形式用方括号括起来。",
            "solution": "用户提供了有效的问题陈述。\n\n### 问题验证\n\n**第 1 步：提取已知信息**\n- **等离子体模型**：等摩尔 Deuterium-Tritium (D-T)，满足 $T_e = T_i = T$, $n_D = n_T = n_i/2$, $n_e = n_i$, 且 $Z_{\\text{eff}} = 1$。\n- **热能**：$E(T) = \\frac{3}{2} (n_e + n_i) \\, V \\, T \\, E_{\\mathrm{keV}}$，其中 $E_{\\mathrm{keV}} = 1.602176634 \\times 10^{-16} \\,\\mathrm{J}$。\n- **能量平衡**：$\\frac{dE}{dt} = Q_{\\text{ext}}(t) + Q_{\\alpha}(T) - Q_{\\text{rad}}(T)$。\n- **α 加热功率**：$Q_{\\alpha}(T) = f_{\\alpha} \\, E_{\\alpha}^{\\mathrm{J}} \\, V \\, \\frac{n_i^2}{4} \\, \\langle \\sigma v \\rangle(T)$，其中 $E_{\\alpha}^{\\mathrm{J}} = 3.5 \\times 10^{3} \\, E_{\\mathrm{keV}}$。\n- **反应率模型**：$\\langle \\sigma v \\rangle(T) = S_0 \\, \\frac{T^2}{1 + T/T_s} \\, \\exp\\!\\left(- b \\, T^{-1/3}\\right)$。\n- **辐射损失功率**：$Q_{\\text{rad}}(T) = C_b \\, Z_{\\text{eff}}^2 \\, n_e \\, n_i \\, V \\, \\sqrt{T}$。\n- **点火温度 $T_{\\text{ign}}$**：在 $[T_{\\min}, T_{\\max}]$ 区间内同时满足 $Q_{\\alpha}(T) = Q_{\\text{rad}}(T)$ 和 $\\left.\\frac{d}{dT}\\big(Q_{\\alpha}(T) - Q_{\\text{rad}}(T)\\big)\\right|_{T} > 0$ 的最小温度 $T$。\n- **最小额外能量 $E_{\\text{add,min}}$**：\n  - 若 $T_0  T_{\\text{ign}}$，则为 $E(T_{\\text{ign}}) - E(T_0)$。\n  - 若 $T_0 \\ge T_{\\text{ign}}$，则为 $0$。\n  - 如果在搜索区间内不存在 $T_{\\text{ign}}$，则为 $-1.0$。\n- **任务**：对四个测试用例中的每一个，计算 $E_{\\text{add,min}}$（单位为焦耳），并四舍五入到三位有效数字。\n- **测试用例**：为四种不同情景提供了 $n_i, n_e, V, f_{\\alpha}, S_0, T_s, b, C_b, T_0, T_{\\min}, T_{\\max}$ 的具体值。\n\n**第 2 步：使用提取的已知信息进行验证**\n该问题具有科学依据，采用了惯性约束聚变中等离子体热斑分析的标准零维（点）模型。热能、α 加热（使用类 Gamow 近似反应率）和韧致辐射的方程在这种简化背景下是物理上正确的表示。点火温度的定义，即加热与损失平衡且具有正反馈斜率的点，是一个标准概念。所有参数都有定义，单位一致，给定值在模型背景下是物理上合理的。问题是自洽的、适定的和客观的。它没有违反任何无效标准。\n\n**第 3 步：结论和行动**\n问题是**有效的**。将制定解决方案。\n\n### 解决方案\n\n该问题要求我们确定将 D-T 等离子体热斑带到点火状态所需的最小外部能量。这涉及到找到点火温度 $T_{\\text{ign}}$，然后计算系统从初始状态达到该温度所需的热能变化。\n\n首先，我们定义净功率平衡函数 $P_{\\text{net}}(T)$，它是 α 加热功率和辐射损失功率之间的差值：\n$$\nP_{\\text{net}}(T) = Q_{\\alpha}(T) - Q_{\\text{rad}}(T)\n$$\n点火温度 $T_{\\text{ign}}$ 由两个条件定义：\n1.  **功率平衡**：等离子体处于热平衡状态（忽略外部功率），意味着聚变产物的自加热恰好平衡了辐射损失的能量。\n    $$\n    P_{\\text{net}}(T_{\\text{ign}}) = 0 \\quad \\implies \\quad Q_{\\alpha}(T_{\\text{ign}}) = Q_{\\text{rad}}(T_{\\text{ign}})\n    $$\n2.  **热不稳定性**：该平衡必须是不稳定的，并且有利于加热。如果温度略有增加，净功率必须变为正值，导致温度进一步升高（即热失控，也就是点火）。这表示为对净功率函数局部斜率的条件：\n    $$\n    \\left.\\frac{dP_{\\text{net}}}{dT}\\right|_{T=T_{\\text{ign}}} > 0\n    $$\n\n通过对给定测试用例的常数参数进行分组，可以简化功率项的表达式。\n对于辐射损失，当 $n_e=n_i$ 且 $Z_{\\text{eff}}=1$ 时：\n$$\nQ_{\\text{rad}}(T) = (C_b \\, n_i^2 \\, V) \\, \\sqrt{T} = K_{\\text{rad}} \\sqrt{T}\n$$\n对于 α 加热，当 $n_D n_T = n_i^2/4$ 时：\n$$\nQ_{\\alpha}(T) = \\left(f_{\\alpha} \\, E_{\\alpha}^{\\mathrm{J}} \\, V \\, \\frac{n_i^2}{4} \\, S_0\\right) \\, \\frac{T^2}{1 + T/T_s} \\, \\exp\\!\\left(- b \\, T^{-1/3}\\right) = K_{\\alpha} \\, \\frac{T^2}{1 + T/T_s} \\, \\exp\\!\\left(- b \\, T^{-1/3}\\right)\n$$\n问题简化为在区间 $[T_{\\min}, T_{\\max}]$ 内找到满足导数条件的 $P_{\\text{net}}(T) = 0$ 的最小根。\n\n为了高效地评估导数条件，我们计算 $P_{\\text{net}}(T)$ 的解析导数。使用对数导数很方便：\n$$\n\\frac{d Q_{\\alpha}}{dT} = Q_{\\alpha}(T) \\frac{d}{dT} (\\ln Q_{\\alpha}(T)) = Q_{\\alpha}(T) \\left( \\frac{2}{T} - \\frac{1}{T+T_s} + \\frac{b}{3}T^{-4/3} \\right)\n$$\n$$\n\\frac{d Q_{\\text{rad}}}{dT} = Q_{\\text{rad}}(T) \\frac{d}{dT} (\\ln Q_{\\text{rad}}(T)) = Q_{\\text{rad}}(T) \\left( \\frac{1}{2T} \\right)\n$$\n在根 $T_{\\text{root}}$ 处，$Q_{\\alpha}(T_{\\text{root}}) = Q_{\\text{rad}}(T_{\\text{root}})$，导数变为：\n$$\n\\left.\\frac{dP_{\\text{net}}}{dT}\\right|_{T_{\\text{root}}} = Q_{\\text{rad}}(T_{\\text{root}}) \\left[ \\left( \\frac{2}{T_{\\text{root}}} - \\frac{1}{T_{\\text{root}}+T_s} + \\frac{b}{3}T_{\\text{root}}^{-4/3} \\right) - \\frac{1}{2T_{\\text{root}}} \\right]\n$$\n$$\n\\left.\\frac{dP_{\\text{net}}}{dT}\\right|_{T_{\\text{root}}} = Q_{\\text{rad}}(T_{\\text{root}}) \\left( \\frac{3}{2T_{\\text{root}}} - \\frac{1}{T_{\\text{root}}+T_s} + \\frac{b}{3}T_{\\text{root}}^{-4/3} \\right)\n$$\n由于当 $T_{\\text{root}} > 0$ 时 $Q_{\\text{rad}}(T_{\\text{root}}) > 0$，稳定性条件简化为检查括号中项的符号。\n\n数值计算步骤如下：\n1.  对于每个测试用例，定义函数 $P_{\\text{net}}(T)$ 和从 $\\frac{dP_{\\text{net}}}{dT}$ 派生出的稳定性检查函数。\n2.  将搜索区间 $[T_{\\min}, T_{\\max}]$ 离散化为一个密集的点网格。\n3.  遍历相邻的网格点 $(T_j, T_{j+1})$，并检查 $P_{\\text{net}}(T)$ 的符号是否发生变化，即 $P_{\\text{net}}(T_j) \\cdot P_{\\text{net}}(T_{j+1})  0$。\n4.  对于检测到符号变化的每个子区间，使用一个稳健的数值求根算法，如 Brent 方法 (`scipy.optimize.brentq`)，来找到精确的根 $T_{\\text{root}}$。\n5.  对于找到的每个根，验证其是否满足稳定性条件 $\\left.\\frac{dP_{\\text{net}}}{dT}\\right|_{T_{\\text{root}}} > 0$。\n6.  收集所有满足条件的有效根。点火温度 $T_{\\text{ign}}$ 是这些有效根中的最小值。\n7.  如果没有找到这样的根，则 $T_{\\text{ign}}$ 在指定范围内不存在，所需能量报告为 $-1.0$。\n8.  如果找到了 $T_{\\text{ign}}$，则计算最小额外能量 $E_{\\text{add,min}}$。如果初始温度 $T_0 \\ge T_{\\text{ign}}$，则已经超过了点火条件，因此 $E_{\\text{add,min}} = 0$。否则，\n    $$\n    E_{\\text{add,min}} = E(T_{\\text{ign}}) - E(T_0) = \\frac{3}{2} (n_e + n_i) \\, V \\, (T_{\\text{ign}} - T_0) \\, E_{\\mathrm{keV}}\n    $$\n    使用 $n_e=n_i$，该式为 $E_{\\text{add,min}} = 3 n_i V (T_{\\text{ign}} - T_0) E_{\\mathrm{keV}}$。\n9.  每个用例的最终结果格式化为三位有效数字。",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases for hot spot ignition.\n    \"\"\"\n    # Physical Constants\n    E_KEV = 1.602176634e-16  # Energy of 1 keV in Joules\n    E_ALPHA_J = 3.5e3 * E_KEV  # Alpha particle energy in Joules\n\n    # Test cases as provided in the problem description.\n    # Format: (n_i, n_e, V, f_alpha, S0, Ts, b, Cb, T0, Tmin, Tmax)\n    test_cases = [\n        # Case 1\n        (5.0e30, 5.0e30, 1.0e-12, 0.85, 1.0e-22, 40.0, 3.0, 1.0e-35, 2.0, 0.5, 30.0),\n        # Case 2\n        (5.0e30, 5.0e30, 1.0e-12, 0.85, 1.0e-22, 40.0, 3.0, 1.0e-35, 8.0, 0.5, 30.0),\n        # Case 3\n        (5.0e30, 5.0e30, 1.0e-12, 0.85, 1.0e-22, 40.0, 3.0, 1.0e-34, 2.0, 0.5, 20.0),\n        # Case 4\n        (1.0e30, 1.0e30, 5.0e-13, 0.85, 1.0e-22, 40.0, 3.0, 1.0e-35, 1.0, 0.5, 30.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        energy_result = calculate_ignition_energy(case, E_KEV, E_ALPHA_J)\n        # Format to 3 significant figures. The 'g' format is ideal for this.\n        if energy_result == -1.0:\n            formatted_result = \"-1.0\"\n        else:\n            formatted_result = f\"{energy_result:.3g}\"\n        results.append(formatted_result)\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_ignition_energy(case_params, e_kev, e_alpha_j):\n    \"\"\"\n    Calculates the minimum additional energy for a single test case.\n    \"\"\"\n    n_i, n_e, V, f_alpha, S0, Ts, b, Cb, T0, Tmin, Tmax = case_params\n\n    # Z_eff = 1 for D-T plasma is assumed\n    Z_eff = 1.0\n\n    # Constant factors for power equations\n    # Q_rad(T) = K_rad * T**0.5\n    K_rad = Cb * (Z_eff**2) * n_e * n_i * V\n    # Q_alpha(T) = K_alpha * (T**2 / (1 + T / Ts)) * exp(-b * T**(-1/3))\n    K_alpha = f_alpha * e_alpha_j * V * (n_i**2 / 4.0) * S0\n    \n    # Power functions\n    def q_alpha(T):\n        if T == 0: return 0.0\n        return K_alpha * (T**2 / (1 + T / Ts)) * np.exp(-b * T**(-1/3))\n\n    def q_rad(T):\n        if T == 0: return 0.0\n        return K_rad * np.sqrt(T)\n\n    # Net power P_net(T) = Q_alpha(T) - Q_rad(T)\n    def p_net(T):\n        return q_alpha(T) - q_rad(T)\n\n    # Stability condition check: dP_net/dT > 0\n    # This simplifies to: 3/(2*T) - 1/(T+Ts) + b/(3*T**(4/3)) > 0\n    def check_stability(T):\n        if T == 0: return False\n        return (1.5 / T - 1.0 / (T + Ts) + b / (3.0 * T**(4.0/3.0))) > 0\n\n    # --- Numerical search for ignition temperature T_ign ---\n    num_points = 2000\n    temp_grid = np.linspace(Tmin, Tmax, num_points)\n    ignition_candidates = []\n\n    for i in range(num_points - 1):\n        T1, T2 = temp_grid[i], temp_grid[i+1]\n        p_net1, p_net2 = p_net(T1), p_net(T2)\n        \n        # Check for sign change, indicating a root in [T1, T2]\n        if np.sign(p_net1) != np.sign(p_net2):\n            try:\n                root = optimize.brentq(p_net, T1, T2)\n                # Check if the root satisfies the stability condition\n                if check_stability(root):\n                    ignition_candidates.append(root)\n            except (ValueError, RuntimeError):\n                # brentq can fail if values are too close to zero, or if the interval is invalid\n                continue\n    \n    if not ignition_candidates:\n        return -1.0 # No ignition temperature found\n\n    T_ign = min(ignition_candidates)\n\n    # --- Calculate minimum additional energy ---\n    if T0 >= T_ign:\n        return 0.0\n    else:\n        # E_add_min = E(T_ign) - E(T0)\n        # E(T) = 1.5 * (n_e + n_i) * V * T * e_kev\n        # For n_e = n_i: E(T) = 3 * n_i * V * T * e_kev\n        E_add_min = 3.0 * n_i * V * (T_ign - T0) * e_kev\n        return E_add_min\n\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "简单的模型虽然实用，但其本身具有局限性。本练习将挑战您超越基本的代理模型，引入更真实的输运物理过程，例如 α 粒子逃逸和热流限制传导。通过比较简单模型和精确模型，您将学会批判性地评估物理假设对点火预测的影响 。",
            "id": "3991340",
            "problem": "您的任务是为氘-氚热斑构建一个替代点火度量，并在 $3\\text{–}10\\ \\text{keV}$ 的温度范围内，对照一个更完整的输运模型来验证其准确性。替代点火度量定义为无量纲比值 $ \\Pi = Q_{\\alpha}/Q_{\\text{loss}} $，其中 $ Q_{\\alpha} $ 是α粒子加热，$ Q_{\\text{loss}} $ 是总热损失。您的程序必须使用替代模型和更完整的输运模型计算 $ \\Pi $，然后量化它们之间的差异。\n\n从适用于计算聚变科学与工程的第一性原理开始：\n\n- 氘-氚混合物的聚变功率密度基于反应率密度 $ R_{\\text{fus}} = n_D n_T \\langle \\sigma v \\rangle(T) $，其中 $ n_D $ 和 $ n_T $ 分别是氘和氚的数密度，$ \\langle \\sigma v \\rangle(T) $ 是在温度 $ T $ 下的热平均反应率系数。对于等摩尔混合物，取 $ n_D = n_T = n_i/2 $，其中 $ n_i $ 是离子数密度。\n\n- α粒子加热功率密度为 $ p_{\\alpha} = R_{\\text{fus}} E_{\\alpha} $，其中 $ E_{\\alpha} $ 是α粒子能量。总α粒子加热功率为 $ P_{\\alpha} = p_{\\alpha} V $，其中 $ V $ 是热斑体积。在替代模型中，假设α粒子完全沉积。在输运模型中，使用沉积分数 $ f_{\\text{dep}} = 1 - \\exp\\left( -\\frac{\\rho R}{\\rho R_0} \\right) $ 来考虑有限的面密度，其中 $ \\rho = n_i m_i $ 是质量密度，$ m_i $ 是等摩尔氘-氚混合物的平均离子质量，$ R $ 是热斑半径，$ \\rho R_0 $ 是一个特征α粒子射程面密度。\n\n- 热传导损失通过 Fourier 定律和 Spitzer–Härm 电子热导率进行建模。经典传导热通量的大小为 $ q_{\\text{class}} = \\kappa_e \\frac{T_e}{R} $，总传导功率为 $ P_{\\text{cond,class}} = 4\\pi R^2 q_{\\text{class}} $。对于完全电离等离子体，使用 Spitzer 电导率 $ \\kappa_e = \\frac{1.84 \\times 10^{-10}\\ T_e^{5/2}}{Z_{\\text{eff}} \\ln\\Lambda} $，单位为 $\\text{W}/(\\text{m}\\cdot\\text{K})$，其中 $ T_e $ 是以 $\\text{K}$ 为单位的电子温度，$ Z_{\\text{eff}} $ 是有效电荷数，$ \\ln\\Lambda $ 是库仑对数。在输运模型中，应用一个通量限制器，其受限热通量为 $ q_{\\text{lim}} = f_L n_e k_B T_e v_{e,\\text{th}} $，其中 $ n_e $ 是电子数密度，$ k_B $ 是 Boltzmann 常数，$ v_{e,\\text{th}} = \\sqrt{\\frac{8 k_B T_e}{\\pi m_e}} $ 是电子热速度。通量受限的传导功率为 $ P_{\\text{cond,FL}} = 4\\pi R^2 \\min(q_{\\text{class}}, q_{\\text{lim}}) $。\n\n- 韧致辐射损失功率为 $ P_{\\text{brem}} = C_b Z_{\\text{eff}}^2 n_e n_i \\sqrt{T_e} V $，其中 $ C_b $ 是一个单位为 $\\text{W}\\cdot\\text{m}^3\\cdot\\text{K}^{-1/2}$ 的恒定发射率系数。\n\n将替代点火比定义为 $ \\Pi_{\\text{surr}} = \\frac{P_{\\alpha,\\text{surr}}}{P_{\\text{cond,class}} + P_{\\text{brem}}} $，其中 $ P_{\\alpha,\\text{surr}} = p_{\\alpha} V $ 假设完全沉积；将输运模型点火比定义为 $ \\Pi_{\\text{full}} = \\frac{P_{\\alpha,\\text{full}}}{P_{\\text{cond,FL}} + P_{\\text{brem}}} $，其中 $ P_{\\alpha,\\text{full}} = f_{\\text{dep}} p_{\\alpha} V $。通过每个案例的相对误差 $ \\varepsilon = \\left| \\Pi_{\\text{surr}} - \\Pi_{\\text{full}} \\right| / \\Pi_{\\text{full}} $ 来量化准确性，并报告替代模型和完整模型在点火阈值判定 $ (\\Pi > 1) $ 上一致的案例所占的比例。\n\n实现以下科学上合理的常数和转换：\n- $ E_{\\alpha} = 3.5\\ \\text{MeV} $ 转换为焦耳。\n- $ m_i = 2.5\\ \\text{amu} $ 转换为千克。\n- $ Z_{\\text{eff}} = 1 $。\n- $ \\ln\\Lambda = 7 $。\n- $ f_L = 0.06 $。\n- $ C_b = 1.69 \\times 10^{-38}\\ \\text{W}\\cdot\\text{m}^3\\cdot\\text{K}^{-1/2} $。\n- $ k_B $ 和 $ m_e $ 是SI单位制下的 Boltzmann 常数和电子质量。\n- 使用 $ 1\\ \\text{eV} = 11604.525\\ \\text{K} $ 将温度 $ T $ 从 $\\text{keV}$ 转换为 $\\text{K}$。\n\n使用一个经过良好测试的氘-氚反应率系数 $ \\langle \\sigma v \\rangle(T) $（单位为 $ \\text{m}^3/\\text{s} $），其基于表格值和单调插值：\n- 表格中的 $ T $ (单位 keV): $ [3,\\ 4,\\ 5,\\ 7,\\ 10] $。\n- 表格中的 $ \\langle \\sigma v \\rangle $ (单位 $ \\text{m}^3/\\text{s} $): $ [1.0\\times 10^{-22},\\ 2.4\\times 10^{-22},\\ 4.5\\times 10^{-22},\\ 7.5\\times 10^{-22},\\ 1.1\\times 10^{-21}] $。\n在 $ T \\in [3,10]\\ \\text{keV} $ 范围内对 $ \\langle \\sigma v \\rangle(T) $ 进行单调插值。\n\n采用α粒子沉积面密度标度 $ \\rho R_0 = 0.003\\ \\text{kg}/\\text{m}^2 $。\n\n您的程序必须评估以下热斑参数集测试套件，每个参数集由 $ (T,\\ n_i,\\ R) $ 指定：\n- 案例 1: $ (3\\ \\text{keV},\\ 5\\times 10^{28}\\ \\text{m}^{-3},\\ 1\\times 10^{-6}\\ \\text{m}) $。\n- 案例 2: $ (5\\ \\text{keV},\\ 1\\times 10^{31}\\ \\text{m}^{-3},\\ 2\\times 10^{-5}\\ \\text{m}) $。\n- 案例 3: $ (7\\ \\text{keV},\\ 2\\times 10^{31}\\ \\text{m}^{-3},\\ 5\\times 10^{-5}\\ \\text{m}) $。\n- 案例 4: $ (10\\ \\text{keV},\\ 5\\times 10^{31}\\ \\text{m}^{-3},\\ 1\\times 10^{-4}\\ \\text{m}) $。\n\n对于每个案例，计算 $ \\Pi_{\\text{surr}} $、$ \\Pi_{\\text{full}} $，然后计算相对误差 $ \\varepsilon $。此外，通过检查是否 $ \\Pi > 1 $ 来确定每个模型的点火判定。最后，计算所有案例的均方根误差 $ \\varepsilon_{\\text{RMS}} $ 和点火一致性比例 $ f_{\\text{agree}} $，$ f_{\\text{agree}} $ 等于两个模型做出相同点火判定的案例数除以总案例数，结果以小数表示。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，格式为 $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4,\\varepsilon_{\\text{RMS}},f_{\\text{agree}}]$，其中每个 $ \\varepsilon_i $ 是一个浮点数，$ f_{\\text{agree}} $ 是一个在 $[0,1]$ 区间内的浮点数。所有量都是无量纲的。不应读取任何外部输入；所有参数必须在程序内部定义。",
            "solution": "本问题的目标是为球形氘-氚(DT)等离子体热斑的点火条件构建并比较两个模型：一个简化的替代模型和一个更全面的输运模型。比较是在 $3\\ \\text{keV}$ 到 $10\\ \\text{keV}$ 的热斑温度范围内进行的。核心量是点火参数 $\\Pi$，定义为α粒子加热功率 $P_{\\alpha}$ 与总热功率损失 $P_{\\text{loss}}$ 的比值。当 $\\Pi > 1$ 时，达到点火条件。\n\n我们首先确定计算所需的基本物理常数和转换因子，全部采用国际单位制(SI)单位。\n-   电子电荷: $e \\approx 1.602 \\times 10^{-19}\\ \\text{C}$。\n-   Boltzmann 常数: $k_B \\approx 1.381 \\times 10^{-23}\\ \\text{J/K}$。\n-   电子质量: $m_e \\approx 9.109 \\times 10^{-31}\\ \\text{kg}$。\n-   原子质量单位: $1\\ \\text{amu} \\approx 1.661 \\times 10^{-27}\\ \\text{kg}$。\n问题为模型参数和转换提供了具体值：\n-   α粒子能量: $E_{\\alpha} = 3.5\\ \\text{MeV} = 3.5 \\times 10^6\\ \\text{eV} \\times e \\approx 5.608 \\times 10^{-13}\\ \\text{J}$。\n-   等摩尔DT混合物的平均离子质量: $m_i = 2.5\\ \\text{amu} \\approx 4.151 \\times 10^{-27}\\ \\text{kg}$。\n-   温度转换: 以开尔文为单位的温度 $T_{\\text{K}}$ 与以千电子伏特为单位的温度 $T_{\\text{keV}}$ 的关系是 $T_{\\text{K}} = T_{\\text{keV}} \\times 1000 \\times 11604.525$。\n我们假设一个半径为 $R$ 的球形热斑，其体积为 $V = \\frac{4}{3}\\pi R^3$，表面积为 $A = 4\\pi R^2$。等离子体是等摩尔、完全电离的DT混合物，因此氘和氚的数密度为 $n_D = n_T = n_i/2$，其中 $n_i$ 是总离子数密度。由于电中性，电子数密度为 $n_e = n_D + n_T = n_i$。有效电荷数为 $Z_{\\text{eff}} = \\frac{\\sum_j n_j Z_j^2}{\\sum_j n_j Z_j} = \\frac{n_D(1)^2 + n_T(1)^2}{n_D(1) + n_T(1)} = 1$。问题假设处于热平衡状态，因此 $T_e = T_i = T$。\n\n首先，我们建立α粒子加热功率 $P_{\\alpha}$ 的公式。DT反应的聚变反应率密度由 $R_{\\text{fus}} = n_D n_T \\langle \\sigma v \\rangle(T) = \\frac{1}{4} n_i^2 \\langle \\sigma v \\rangle(T)$ 给出。项 $\\langle \\sigma v \\rangle(T)$ 是热平均反应率系数，它是温度的强函数。其值通过对提供的表格数据进行单调线性插值来确定：$(T\\ [\\text{keV}], \\langle \\sigma v \\rangle\\ [\\text{m}^3/\\text{s}])$ 数值对为 $(3, 1.0\\times 10^{-22})$、$(4, 2.4\\times 10^{-22})$、$(5, 4.5\\times 10^{-22})$、$(7, 7.5\\times 10^{-22})$ 和 $(10, 1.1\\times 10^{-21})$。α粒子加热功率密度则为 $p_{\\alpha} = R_{\\text{fus}} E_{\\alpha}$。产生的总功率为 $p_{\\alpha} V$。\n两种模型在处理α粒子能量沉积方面有所不同。\n-   替代模型假设所有α粒子都在局部沉积其能量。加热功率为 $P_{\\alpha,\\text{surr}} = p_{\\alpha} V = \\frac{1}{4} n_i^2 \\langle \\sigma v \\rangle(T) E_{\\alpha} V$。\n-   输运模型考虑了α粒子从有限大小的热斑中逃逸。这通过一个沉积分数 $f_{\\text{dep}} = 1 - \\exp\\left( -\\frac{\\rho R}{\\rho R_0} \\right)$ 来建模。这里，$\\rho = n_i m_i$ 是热斑质量密度，$R$ 是半径，$\\rho R_0 = 0.003\\ \\text{kg}/\\text{m}^2$ 是α粒子阻止的特征面密度。该模型中的加热功率为 $P_{\\alpha,\\text{full}} = f_{\\text{dep}} P_{\\alpha,\\text{surr}}$。\n\n接下来，我们建立功率损失项 $P_{\\text{loss}}$ 的公式。考虑的两个主要损失机制是热传导和韧致辐射。\n韧致辐射功率损失由 $P_{\\text{brem}} = C_b Z_{\\text{eff}}^2 n_e n_i \\sqrt{T} V$ 给出。使用模型参数 $Z_{\\text{eff}}=1$、$n_e=n_i$ 和提供的常数 $C_b = 1.69 \\times 10^{-38}\\ \\text{W}\\cdot\\text{m}^3\\cdot\\text{K}^{-1/2}$，且温度 $T$ 以开尔文为单位，该式变为 $P_{\\text{brem}} = C_b n_i^2 \\sqrt{T} V$。该项在替代模型和完整模型中是相同的。\n\n热传导损失模型是两种方法之间的另一个分歧点。\n-   替代模型在 Fourier 定律中使用了经典的 Spitzer-Härm 电子热导率 $\\kappa_e$。热通量近似为 $q_{\\text{class}} = \\kappa_e \\frac{T}{R}$，其中 $T/R$ 代表温度梯度标长。总传导功率损失为 $P_{\\text{cond,class}} = A \\cdot q_{\\text{class}} = 4\\pi R^2 (\\kappa_e \\frac{T}{R}) = 4\\pi R \\kappa_e T$。Spitzer 电导率为 $\\kappa_e = \\frac{1.84 \\times 10^{-10}\\ T^{5/2}}{Z_{\\text{eff}} \\ln\\Lambda}$，其中 $T$ 以开尔文为单位，$Z_{\\text{eff}}=1$，库仑对数 $\\ln\\Lambda = 7$。\n-   输运模型认识到，在陡峭的温度梯度中，经典的扩散热通量可能会变得非物理地大，超过电子自由流动的速率。这通过应用一个通量限制器来校正。将经典通量 $q_{\\text{class}}$ 与一个受限通量 $q_{\\text{lim}} = f_L n_e k_B T v_{e,\\text{th}}$ 进行比较，其中 $f_L=0.06$ 是通量限制器系数，$v_{e,\\text{th}} = \\sqrt{\\frac{8 k_B T}{\\pi m_e}}$ 是电子热速度。实际热通量是这两个值的最小值，$q_{\\text{FL}} = \\min(q_{\\text{class}}, q_{\\text{lim}})$。通量受限的传导功率为 $P_{\\text{cond,FL}} = A \\cdot q_{\\text{FL}} = 4\\pi R^2 \\min(q_{\\text{class}}, q_{\\text{lim}})$。\n\n在定义了所有功率项后，我们可以为每个模型组合出点火度量。\n-   替代模型: $\\Pi_{\\text{surr}} = \\frac{P_{\\alpha,\\text{surr}}}{P_{\\text{cond,class}} + P_{\\text{brem}}}$。\n-   输运模型: $\\Pi_{\\text{full}} = \\frac{P_{\\alpha,\\text{full}}}{P_{\\text{cond,FL}} + P_{\\text{brem}}}$。\n\n最后一步是针对给定的测试案例量化两个模型之间的差异。对于每个案例 $i$，我们计算相对误差 $\\varepsilon_i = \\frac{\\left| \\Pi_{\\text{surr},i} - \\Pi_{\\text{full},i} \\right|}{\\Pi_{\\text{full},i}}$。我们还根据标准 $\\Pi > 1$ 来确定每个模型的点火判定。总体性能使用两个度量来评估：所有案例的均方根误差 $\\varepsilon_{\\text{RMS}} = \\sqrt{\\frac{1}{N}\\sum_i \\varepsilon_i^2}$，其中 $N=4$ 是案例数量；以及点火一致性比例 $f_{\\text{agree}}$，即两个模型得出相同点火判定（即都 $\\Pi > 1$ 或都 $\\Pi \\le 1$）的案例所占的比例。\n\n对于每个测试案例 $(T, n_i, R)$，计算算法按以下步骤进行：\n1.  将温度 $T$ 从 $\\text{keV}$ 转换为开尔文。\n2.  计算热斑体积 $V$ 和表面积 $A$。\n3.  插值找到 $\\langle \\sigma v \\rangle(T)$。\n4.  计算替代模型的α粒子加热功率 $P_{\\alpha,\\text{surr}}$。\n5.  计算α粒子沉积分数 $f_{\\text{dep}}$ 和完整模型的α粒子加热功率 $P_{\\alpha,\\text{full}}$。\n6.  计算韧致辐射功率损失 $P_{\\text{brem}}$。\n7.  计算经典传导功率损失 $P_{\\text{cond,class}}$。\n8.  计算通量受限的传导功率损失 $P_{\\text{cond,FL}}$。\n9.  计算 $\\Pi_{\\text{surr}}$ 和 $\\Pi_{\\text{full}}$。\n10. 计算该案例的相对误差 $\\varepsilon$。\n11. 比较两个模型的点火判定 $(\\Pi > 1)$。\n处理完所有案例后，计算最终的聚合度量 $\\varepsilon_{\\text{RMS}}$ 和 $f_{\\text{agree}}$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import interp1d\n\ndef solve():\n    \"\"\"\n    Computes and compares surrogate and transport-based ignition metrics\n    for a DT hot spot.\n    \"\"\"\n    # --- Scientific and Model Constants (SI Units) ---\n    E_CHARGE = 1.602176634e-19\n    KB = 1.380649e-23\n    M_E = 9.1093837e-31\n    AMU_TO_KG = 1.660539e-27\n    PI = np.pi\n\n    # --- Problem-Specific Parameters ---\n    E_ALPHA_MEV = 3.5\n    E_ALPHA_J = E_ALPHA_MEV * 1e6 * E_CHARGE\n    KEV_TO_K_FACTOR = 11604.525 * 1e3\n    AVG_ION_MASS_AMU = 2.5\n    M_I = AVG_ION_MASS_AMU * AMU_TO_KG\n    Z_EFF = 1.0\n    COULOMB_LOG = 7.0\n    FLUX_LIMITER = 0.06\n    C_BREM = 1.69e-38\n    RHO_R0_ALPHA = 0.003\n    KAPPA_E_COEFF = 1.84e-10\n\n    # --- Reaction Rate Data for DT Fusion ---\n    T_nodes_kev = np.array([3, 4, 5, 7, 10])\n    SIGMA_V_NODES = np.array([1.0e-22, 2.4e-22, 4.5e-22, 7.5e-22, 1.1e-21])\n    reactivity_interpolator = interp1d(T_nodes_kev, SIGMA_V_NODES, kind='linear')\n\n    # --- Test Suite ---\n    test_cases = [\n        (3, 5e28, 1e-6),\n        (5, 1e31, 2e-5),\n        (7, 2e31, 5e-5),\n        (10, 5e31, 1e-4),\n    ]\n\n    errors = []\n    agreement_count = 0\n\n    for T_kev, n_i, R in test_cases:\n        T_K = T_kev * KEV_TO_K_FACTOR\n        V = (4.0 / 3.0) * PI * R**3\n        A = 4.0 * PI * R**2\n        n_e = n_i\n        \n        sigma_v = reactivity_interpolator(T_kev)\n        \n        # --- Alpha Power ---\n        p_alpha_density = (1/4) * n_i**2 * sigma_v * E_ALPHA_J\n        P_alpha_surr = p_alpha_density * V\n        \n        rho = n_i * M_I\n        rho_R = rho * R\n        f_dep = 1 - np.exp(-rho_R / RHO_R0_ALPHA)\n        P_alpha_full = f_dep * P_alpha_surr\n        \n        # --- Losses ---\n        P_brem = C_BREM * Z_EFF**2 * n_e * n_i * np.sqrt(T_K) * V\n\n        # --- Conduction Loss ---\n        kappa_e = KAPPA_E_COEFF * T_K**(2.5) / (Z_EFF * COULOMB_LOG)\n        \n        # Surrogate model conduction\n        q_class = kappa_e * (T_K / R) \n        P_cond_class = A * q_class\n        \n        # Full transport model conduction\n        v_e_th = np.sqrt(8 * KB * T_K / (PI * M_E))\n        q_lim = FLUX_LIMITER * n_e * KB * T_K * v_e_th\n        q_FL = min(q_class, q_lim)\n        P_cond_FL = A * q_FL\n\n        # --- Ignition Metrics ---\n        Pi_surr = P_alpha_surr / (P_cond_class + P_brem) if (P_cond_class + P_brem) > 0 else 0\n        Pi_full = P_alpha_full / (P_cond_FL + P_brem) if (P_cond_FL + P_brem) > 0 else 0\n        \n        # --- Comparison ---\n        relative_error = np.abs(Pi_surr - Pi_full) / Pi_full if Pi_full != 0 else 0.0\n        errors.append(relative_error)\n        \n        ignites_surr = Pi_surr > 1\n        ignites_full = Pi_full > 1\n        if ignites_surr == ignites_full:\n            agreement_count += 1\n            \n    rms_error = np.sqrt(np.mean(np.array(errors)**2))\n    f_agree = agreement_count / len(test_cases)\n    \n    error_strs = [f\"{err:.6f}\" for err in errors]\n    final_list = error_strs + [f\"{rms_error:.6f}\", f\"{f_agree:.2f}\"]\n    print(f\"[{','.join(final_list)}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "实现点火本身并非终极目标，最终目的是要燃烧大部分燃料。本练习着重于对点火结果进行建模，通过推导和求解考虑燃料消耗的燃耗分数方程，将点火的抽象概念与聚变能量产出的实际衡量标准联系起来。这有助于我们理解在热斑解体前，有多少燃料能被有效利用 。",
            "id": "3991371",
            "problem": "考虑在惯性约束聚变 (Inertial Confinement Fusion (ICF)) 背景下，一个均匀的球形氘-氚 (DT) 燃料热斑。假设以下作为基本基础且有物理动机的模型假设：(i) 热斑在空间上是均匀的，(ii) 在解体前的短暂燃烧窗口内，温度近似恒定，(iii) 在此期间忽略α粒子自加热和热传导，以及 (iv) 混合物最初是氘和氚等摩尔的。使用标准的单位体积二元聚变反应率公式 $R = n_D n_T \\langle \\sigma v \\rangle(T)$，其中 $n_D$ 和 $n_T$ 分别是氘和氚的数密度，而 $\\langle \\sigma v \\rangle(T)$ 是依赖于温度的DT反应性。设热斑解体时间由流体动力学时间尺度 $t_{\\mathrm{dis}} = R_0 / c_s$ 建模，其中 $R_0$ 是初始热斑半径，$c_s$ 是离子声速。对于理想等离子体，离子声速由 $c_s = \\sqrt{\\gamma k_B T / m_i}$ 给出，其中 $\\gamma$ 是绝热指数，$k_B$ 是 Boltzmann 常数，$T$ 是温度（单位为焦耳），$m_i$ 是平均离子质量。\n\n仅从这些基本定律和定义出发，从第一性原理推导出一个关于燃烧份额 $f_b(t)$ 的常微分方程。然后，在均匀和等温假设下，获得 $f_b(t)$ 的闭式表达式，并确定表征在解体前发生显著燃烧的条件的不等式，即 $f_b(t_{\\mathrm{dis}}) \\geq 0.2$。\n\n为了进行数值计算，采用一个基于标准列表值的经验性、对数-对数插值的氘-氚反应性模型：\n- 温度节点 $T$（单位：千电子伏特 (keV)）：$[1, 5, 10, 20, 50, 100]$。\n- 对应的DT反应性值 $\\langle \\sigma v \\rangle$（单位：$\\mathrm{m^3/s}$）：$[1.0 \\times 10^{-24}, 5.0 \\times 10^{-23}, 1.1 \\times 10^{-22}, 2.0 \\times 10^{-22}, 2.5 \\times 10^{-22}, 2.7 \\times 10^{-22}]$。\n通过在这些节点的 $\\log_{10} T$–$\\log_{10} \\langle \\sigma v \\rangle$ 空间中进行线性插值，计算任意温度 $T$（单位：keV）下的 $\\langle \\sigma v \\rangle(T)$。使用 $\\gamma = 5/3$，氘原子质量 $m_D = 2.014\\,\\mathrm{amu}$，氚原子质量 $m_T = 3.016\\,\\mathrm{amu}$，以及原子质量单位 $1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。设 $m_i$ 为 $m_D$ 和 $m_T$ 的平均值。\n\n您的程序必须为每个测试用例计算：\n1. 解体时间 $t_{\\mathrm{dis}}$（单位：秒）。\n2. 从推导出的闭式解得到的燃烧份额 $f_b(t_{\\mathrm{dis}})$（无量纲）。\n3. 一个布尔值，指示是否达到显著燃烧，定义为 $f_b(t_{\\mathrm{dis}}) \\geq 0.2$。\n\n输入由测试套件固定，并使用以下单位：\n- 温度 $T$（单位：$\\mathrm{keV}$）。\n- 初始总离子数密度 $n_0$（单位：$\\mathrm{m^{-3}}$）（等摩尔DT意味着初始 $n_D(0) = n_T(0) = n_0/2$）。\n- 初始半径 $R_0$（单位：微米 $\\mathrm{\\mu m}$）。\n\n测试套件（每个用例是一个元组 $(T, n_0, R_0)$）：\n- 用例 A（理想情况）：$(10, 5.0 \\times 10^{31}, 500)$。\n- 用例 B（接近阈值）：$(5, 2.0 \\times 10^{31}, 300)$。\n- 用例 C（短约束边界）：$(10, 1.0 \\times 10^{31}, 30)$。\n- 用例 D（高温，中等尺寸）：$(20, 3.0 \\times 10^{31}, 100)$。\n\n您的程序应生成单行输出，其中包含一个由逗号分隔并用方括号括起来的结果列表，每个测试用例对应一个条目。每个条目必须是一个包含 $[f_b, \\text{布尔值}]$ 的双元素列表，其中 $f_b$ 是一个浮点数，布尔值指示是否发生显著燃烧。例如，输出格式必须类似于 $[[f_{b,A}, True], [f_{b,B}, False], \\dots]$。不得打印任何单位，所有浮点数必须由程序计算得出；请勿硬编码期望值。",
            "solution": "用户提供的问题已经过严格验证，并被确定为科学上合理、良定且自洽的。关于离子声速公式中温度的微小符号歧义，通过采用等离子体物理学中的标准惯例得以解决，即使用能量单位（例如千电子伏特，keV）给出的温度来表示热能，相当于乘积 $k_B T_{\\text{Kelvin}}$。解决方案首先从基本原理推导燃料燃烧份额的主控常微分方程（ODE），然后求解以找到闭式表达式，最后构建一个计算算法来评估给定测试用例的结果。\n\n**1. 燃烧份额 $f_b(t)$ 的常微分方程推导**\n\n我们考虑一个氘-氚 (DT) 聚变反应：$\\mathrm{D} + \\mathrm{T} \\rightarrow \\alpha + \\mathrm{n}$。单位体积内该反应的速率 $R$ 由 $R = n_D n_T \\langle \\sigma v \\rangle(T)$ 给出，其中 $n_D$ 和 $n_T$ 分别是氘和氚的数密度，而 $\\langle \\sigma v \\rangle(T)$ 是依赖于温度的反应性。\n\n对于每个聚变事件，会消耗一个D离子和一个T离子。因此，它们数密度的变化率为：\n$$ \\frac{d n_D}{d t} = -R = -n_D(t) n_T(t) \\langle \\sigma v \\rangle $$\n$$ \\frac{d n_T}{d t} = -R = -n_D(t) n_T(t) \\langle \\sigma v \\rangle $$\n\n问题陈述混合物最初是等摩尔的，意味着 $n_D(0) = n_T(0)$。由于它们以相同的速率被消耗，它们的密度在所有时间都保持相等，即 $n_D(t) = n_T(t)$。让我们将这个共同的数密度表示为 $n_f(t)$，其中下标 $f$ 表示单一燃料种类（D或T）。初始总离子密度为 $n_0 = n_D(0) + n_T(0)$，因此对于等摩尔混合物，$n_D(0) = n_T(0) = n_0/2$。于是，$n_f(0) = n_0/2$。\n\nODE简化为：\n$$ \\frac{d n_f}{d t} = -n_f(t)^2 \\langle \\sigma v \\rangle $$\n\n燃烧份额 $f_b(t)$ 定义为到时间 $t$ 为止，已消耗的初始氘（或氚）的比例。\n$$ f_b(t) = \\frac{n_f(0) - n_f(t)}{n_f(0)} = 1 - \\frac{n_f(t)}{n_f(0)} $$\n根据这个定义，我们可以用 $f_b(t)$ 和初始密度 $n_f(0) = n_0/2$ 来表示 $n_f(t)$：\n$$ n_f(t) = n_f(0) (1 - f_b(t)) = \\frac{n_0}{2} (1 - f_b(t)) $$\n将此表达式对时间 $t$ 求导得到：\n$$ \\frac{d n_f}{d t} = -\\frac{n_0}{2} \\frac{d f_b}{d t} $$\n现在，我们将 $n_f(t)$ 及其导数的表达式代入简化的速率方程中：\n$$ -\\frac{n_0}{2} \\frac{d f_b}{d t} = - \\left( \\frac{n_0}{2} (1 - f_b(t)) \\right)^2 \\langle \\sigma v \\rangle $$\n$$ \\frac{n_0}{2} \\frac{d f_b}{d t} = \\left( \\frac{n_0}{2} \\right)^2 (1 - f_b(t))^2 \\langle \\sigma v \\rangle $$\n两边同时除以 $n_0/2$（假设 $n_0 \\neq 0$），我们得到燃烧份额的ODE：\n$$ \\frac{d f_b}{d t} = \\frac{n_0}{2} \\langle \\sigma v \\rangle (1 - f_b(t))^2 $$\n初始条件为 $f_b(0) = 0$，因为在时间 $t=0$ 时没有燃料被消耗。\n\n**2. $f_b(t)$ 的闭式解**\n\n推导出的ODE是一个可分离的一阶微分方程。在温度 $T$ 以及反应性 $\\langle \\sigma v \\rangle$ 为常数的假设下，我们可以通过积分来求解它。\n$$ \\frac{d f_b}{(1 - f_b)^2} = \\left( \\frac{n_0}{2} \\langle \\sigma v \\rangle \\right) dt $$\n将两边分别从时间 $0$ 到 $t$ 以及从燃烧份额 $f_b(0)=0$ 到 $f_b(t)$ 进行积分：\n$$ \\int_{0}^{f_b(t)} \\frac{d f_b'}{(1 - f_b')^2} = \\int_{0}^{t} \\frac{n_0}{2} \\langle \\sigma v \\rangle dt' $$\n左侧积分计算结果为：\n$$ \\left[ \\frac{1}{1 - f_b'} \\right]_{0}^{f_b(t)} = \\frac{1}{1 - f_b(t)} - \\frac{1}{1 - 0} = \\frac{1}{1 - f_b(t)} - 1 $$\n右侧积分，在参数为常数的情况下，结果为：\n$$ \\left( \\frac{n_0}{2} \\langle \\sigma v \\rangle \\right) t $$\n令两个结果相等：\n$$ \\frac{1}{1 - f_b(t)} - 1 = \\frac{n_0}{2} \\langle \\sigma v \\rangle t $$\n求解 $f_b(t)$：\n$$ \\frac{1}{1 - f_b(t)} = 1 + \\frac{n_0}{2} \\langle \\sigma v \\rangle t $$\n$$ 1 - f_b(t) = \\frac{1}{1 + \\frac{n_0}{2} \\langle \\sigma v \\rangle t} $$\n$$ f_b(t) = 1 - \\frac{1}{1 + \\frac{n_0}{2} \\langle \\sigma v \\rangle t} = \\frac{1 + \\frac{n_0}{2} \\langle \\sigma v \\rangle t - 1}{1 + \\frac{n_0}{2} \\langle \\sigma v \\rangle t} $$\n燃烧份额的最终闭式解为：\n$$ f_b(t) = \\frac{\\frac{n_0}{2} \\langle \\sigma v \\rangle t}{1 + \\frac{n_0}{2} \\langle \\sigma v \\rangle t} $$\n\n**3. 计算模型**\n\n该任务要求为几个测试用例计算解体时间点的燃烧份额 $f_b(t_{\\mathrm{dis}})$。这包括以下步骤：\n\n**a. 常数和单位换算：** 所有计算均使用国际单位制（SI）单位。\n-   输入为温度 $T$（单位：keV），$n_0$（单位：$\\mathrm{m^{-3}}$），以及 $R_0$（单位：微米 $\\mu m$）。\n-   温度 $T_{\\mathrm{keV}}$ 被转换为能量（单位：焦耳）$T_J$，用于声速公式：$T_J = T_{\\mathrm{keV}} \\times 1000 \\times e$，其中 $e \\approx 1.602 \\times 10^{-19}\\,\\mathrm{C}$ 是基本电荷。\n-   初始半径 $R_0$ 被转换为米：$R_{0, \\mathrm{m}} = R_{0, \\mu m} \\times 10^{-6}$。\n-   对于等摩尔DT混合物，平均离子质量为 $m_i = (m_D + m_T)/2$。使用给定的原子质量 $m_D=2.014\\,\\mathrm{amu}$ 和 $m_T=3.016\\,\\mathrm{amu}$，以及换算关系 $1\\,\\mathrm{amu} \\approx 1.6605 \\times 10^{-27}\\,\\mathrm{kg}$，我们得到 $m_i = (2.014 + 3.016)/2 \\times 1.660539... \\times 10^{-27}\\,\\mathrm{kg} \\approx 4.176 \\times 10^{-27}\\,\\mathrm{kg}$。\n-   绝热指数给定为 $\\gamma = 5/3$。\n\n**b. 反应性计算 $\\langle \\sigma v \\rangle(T)$：**\n反应性 $\\langle \\sigma v \\rangle$ 是温度 $T$（单位：keV）的函数。它通过使用提供的节点表在对数-对数空间中进行线性插值来计算。对于给定的温度 $T$，我们找到对应的 $\\log_{10} T$，并用它在 $\\log_{10} \\langle \\sigma v \\rangle$ 对 $\\log_{10} T$ 的列表值之间进行线性插值。\n设 $X = \\log_{10} T$ 和 $Y = \\log_{10} \\langle \\sigma v \\rangle$。给定两个包围查询点 $X$ 的节点 $(X_1, Y_1)$ 和 $(X_2, Y_2)$，插值结果 $Y$ 为：\n$$ Y = Y_1 + (Y_2 - Y_1) \\frac{X - X_1}{X_2 - X_1} $$\n最终的反应性则为 $\\langle \\sigma v \\rangle = 10^Y$。\n\n**c. 解体时间尺度 $t_{\\mathrm{dis}}$：**\n解体时间被建模为 $t_{\\mathrm{dis}} = R_0 / c_s$，其中 $c_s$ 是离子声速。\n声速由 $c_s = \\sqrt{\\gamma k_B T / m_i}$ 给出。如前所述，项 $k_B T$（能量）被替换为以焦耳为单位的温度 $T_J$。\n$$ c_s = \\sqrt{\\frac{\\gamma T_J}{m_i}} $$\n当 $R_0$ 单位为米，$c_s$ 单位为 $\\mathrm{m/s}$ 时，$t_{\\mathrm{dis}}$ 的单位将是秒。\n\n**d. 最终燃烧份额计算：**\n解体时的燃烧份额 $f_b(t_{\\mathrm{dis}})$ 是通过将 $t = t_{\\mathrm{dis}}$ 代入闭式解来计算的：\n$$ f_b(t_{\\mathrm{dis}}) = \\frac{\\frac{n_0}{2} \\langle \\sigma v \\rangle(T) t_{\\mathrm{dis}}}{1 + \\frac{n_0}{2} \\langle \\sigma v \\rangle(T) t_{\\mathrm{dis}}} $$\n最后，将此值与显著燃烧的阈值进行比较：$f_b(t_{\\mathrm{dis}}) \\geq 0.2$。根据此比较生成一个布尔结果。每个用例的最终输出是一个包含 $f_b(t_{\\mathrm{dis}})$ 的浮点值和布尔结果的列表。",
            "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import interp1d\n\ndef solve():\n    \"\"\"\n    Computes the hot spot burn fraction for several Inertial Confinement Fusion scenarios.\n\n    The solution is based on a simplified 0D, isothermal model of a DT hot spot.\n    It involves:\n    1. Deriving and solving the ODE for burn fraction.\n    2. Calculating DT reactivity via log-log interpolation.\n    3. Computing the hydrodynamic disassembly time.\n    4. Evaluating the final burn fraction and checking for significant burn.\n    \"\"\"\n\n    # --- Physical Constants ---\n    E_CHARGE = 1.602176634e-19\n    AMU_KG = 1.66053906660e-27\n    M_D_AMU = 2.014\n    M_T_AMU = 3.016\n    GAMMA = 5.0 / 3.0\n\n    m_i_kg = (M_D_AMU + M_T_AMU) / 2.0 * AMU_KG\n\n    # --- Tabulated Reactivity Data ---\n    T_nodes_kev = np.array([1, 5, 10, 20, 50, 100])\n    log_T_nodes = np.log10(T_nodes_kev)\n    \n    sigma_v_nodes = np.array([1.0e-24, 5.0e-23, 1.1e-22, 2.0e-22, 2.5e-22, 2.7e-22])\n    log_sigma_v_nodes = np.log10(sigma_v_nodes)\n    \n    log_reactivity_interpolator = interp1d(log_T_nodes, log_sigma_v_nodes, kind='linear', fill_value=\"extrapolate\")\n\n    def get_reactivity(T_kev):\n        log_T = np.log10(T_kev)\n        log_sigma_v = log_reactivity_interpolator(log_T)\n        return 10**log_sigma_v\n\n    # --- Test Suite ---\n    test_cases = [\n        (10, 5.0e31, 500), # Case A\n        (5, 2.0e31, 300),  # Case B\n        (10, 1.0e31, 30),  # Case C\n        (20, 3.0e31, 100), # Case D\n    ]\n\n    results = []\n\n    for T_kev, n0, R0_micron in test_cases:\n        T_J = T_kev * 1000 * E_CHARGE\n        R0_m = R0_micron * 1e-6\n        \n        c_s = np.sqrt(GAMMA * T_J / m_i_kg)\n        \n        t_dis = R0_m / c_s\n        \n        sigma_v = get_reactivity(T_kev)\n        \n        burn_param = (n0 / 2.0) * sigma_v * t_dis\n        \n        f_b = burn_param / (1.0 + burn_param)\n        \n        significant_burn = f_b >= 0.2\n        \n        results.append([f_b, significant_burn])\n\n    # Format the final output string as per requirements\n    # e.g., [[0.345, True], [0.123, False], ...]\n    output_str = \"[\" + \", \".join([f\"[{res[0]:.6f}, {res[1]}]\" for res in results]) + \"]\"\n    \n    print(output_str)\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}