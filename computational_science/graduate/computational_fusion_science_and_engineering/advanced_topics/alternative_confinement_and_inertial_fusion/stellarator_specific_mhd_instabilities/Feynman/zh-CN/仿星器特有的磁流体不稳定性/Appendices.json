{
    "hands_on_practices": [
        {
            "introduction": "要分析仿星器复杂三维几何中的磁流体动力学（MHD），必须首先牢固掌握非正交曲线坐标系下的矢量微积分。本练习旨在巩固您的第一性原理知识，要求您从几何定义出发，推导梯度和散度等基本微分算子。通过完成这一推导并验证基本定律 $\\nabla \\cdot \\mathbf{B} = 0$，您将对支撑所有仿星器 MHD 代码和理论的数学工具，特别是雅可比行列式 $\\mathcal{J}$ 的作用，获得深刻且可操作的理解。",
            "id": "4049390",
            "problem": "考虑一个在三维磁流形坐标 $(\\psi,\\theta,\\phi)$ 中描述的仿星器平衡，其中 $\\psi$ 是一个环向磁通标签，$\\theta$ 是一个角向角，$\\phi$ 是一个环向角。设位置矢量为 $\\mathbf{r}(\\psi,\\theta,\\phi)$，并定义协变基矢 $\\mathbf{e}_{i}=\\partial\\mathbf{r}/\\partial u^{i}$ 和逆变基矢 $\\mathbf{e}^{i}=\\nabla u^{i}$，其中 $(u^{1},u^{2},u^{3})\\equiv(\\psi,\\theta,\\phi)$。该坐标系是仿星器的通用坐标系，不假定其为正交坐标系。雅可比量定义为\n$$\n\\mathcal{J}=\\left(\\nabla\\psi\\cdot\\nabla\\theta\\times\\nabla\\phi\\right)^{-1}.\n$$\n在这些坐标中对磁流体力学（MHD）进行建模，假设存在嵌套磁面，并且磁场 $\\mathbf{B}$ 与 $\\psi=\\text{常数}$ 的曲面相切。从曲线坐标中的矢量微积分第一性原理和上述雅可比量的定义出发，完成以下任务：\n\n1. 推导雅可比量 $\\mathcal{J}$ 如何出现在标量 $f(\\psi,\\theta,\\phi)$ 的梯度和以逆变形式 $\\mathbf{A}=A^{i}\\mathbf{e}_{i}$ 书写的矢量场 $\\mathbf{A}(\\psi,\\theta,\\phi)$ 的散度的坐标表达式中。您的推导必须从多变量微积分的链式法则、$\\mathbf{e}_{i}$ 和 $\\mathbf{e}^{i}$ 的几何定义，以及由通过无穷小坐标单元的通量除以其体积的极限所定义的散度出发。不要假定正交性。\n\n2. 使用您得到的散度算子，考虑与磁面相容的磁场的 Clebsch 型表示\n$$\n\\mathbf{B}=\\nabla\\psi\\times\\nabla\\alpha(\\psi,\\theta,\\phi),\n$$\n其中，在固定的 $\\psi$ 下，$\\alpha$ 是一个在 $(\\theta,\\phi)$ 上具有连续二阶混合偏导数的光滑标量场。在 $(\\psi,\\theta,\\phi)$ 坐标中显式计算 $\\nabla\\cdot\\mathbf{B}$，展示所有使用 $\\mathcal{J}$ 和基矢恒等式的步骤。\n\n将 $\\nabla\\cdot\\mathbf{B}$ 的最终值表示为一个无单位的实数。无需四舍五入。",
            "solution": "解答按问题陈述的要求分为两部分。\n\n**第1部分：梯度和散度算子的推导**\n\n**标量场 $f(\\psi, \\theta, \\phi)$ 的梯度**\n\n设 $f(\\psi, \\theta, \\phi)$ 为一个标量场。根据链式法则，其全微分 $df$ 由下式给出：\n$$\ndf = \\frac{\\partial f}{\\partial \\psi} d\\psi + \\frac{\\partial f}{\\partial \\theta} d\\theta + \\frac{\\partial f}{\\partial \\phi} d\\phi\n$$\n$f$ 的梯度记为 $\\nabla f$，其定义满足 $df = \\nabla f \\cdot d\\mathbf{r}$，其中 $d\\mathbf{r}$ 是微分位移矢量。在我们的坐标系中，$d\\mathbf{r}$ 可以用协变基矢 $\\mathbf{e}_i = \\frac{\\partial\\mathbf{r}}{\\partial u^i}$ 表示：\n$$\nd\\mathbf{r} = \\frac{\\partial \\mathbf{r}}{\\partial \\psi} d\\psi + \\frac{\\partial \\mathbf{r}}{\\partial \\theta} d\\theta + \\frac{\\partial \\mathbf{r}}{\\partial \\phi} d\\phi = \\mathbf{e}_{\\psi} d\\psi + \\mathbf{e}_{\\theta} d\\theta + \\mathbf{e}_{\\phi} d\\phi\n$$\n我们将梯度矢量 $\\nabla f$ 在逆变基矢 $\\mathbf{e}^i = \\nabla u^i$ 中表示：\n$$\n\\nabla f = (\\nabla f)_{\\psi} \\mathbf{e}^{\\psi} + (\\nabla f)_{\\theta} \\mathbf{e}^{\\theta} + (\\nabla f)_{\\phi} \\mathbf{e}^{\\phi}\n$$\n然后使用对偶基的基本性质 $\\mathbf{e}^{i} \\cdot \\mathbf{e}_{j} = \\delta^{i}_{j}$（克罗内克 δ）计算点积 $\\nabla f \\cdot d\\mathbf{r}$：\n$$\n\\nabla f \\cdot d\\mathbf{r} = ((\\nabla f)_{\\psi} \\mathbf{e}^{\\psi} + \\dots) \\cdot (\\mathbf{e}_{\\psi} d\\psi + \\dots) = (\\nabla f)_{\\psi} d\\psi + (\\nabla f)_{\\theta} d\\theta + (\\nabla f)_{\\phi} d\\phi\n$$\n将此与 $df$ 的链式法则表达式进行比较，我们确定梯度的分量：\n$$\n(\\nabla f)_{\\psi} = \\frac{\\partial f}{\\partial \\psi}, \\quad (\\nabla f)_{\\theta} = \\frac{\\partial f}{\\partial \\theta}, \\quad (\\nabla f)_{\\phi} = \\frac{\\partial f}{\\partial \\phi}\n$$\n因此，梯度的表达式为：\n$$\n\\nabla f = \\frac{\\partial f}{\\partial \\psi} \\mathbf{e}^{\\psi} + \\frac{\\partial f}{\\partial \\theta} \\mathbf{e}^{\\theta} + \\frac{\\partial f}{\\partial \\phi} \\mathbf{e}^{\\phi} = \\sum_{i} \\frac{\\partial f}{\\partial u^i} \\mathbf{e}^{i}\n$$\n雅可比量 $\\mathcal{J}$ 通过逆变基矢和协变基矢之间的关系进入此表达式。根据定义，$\\mathcal{J}^{-1} = \\mathbf{e}^{\\psi} \\cdot (\\mathbf{e}^{\\theta} \\times \\mathbf{e}^{\\phi})$。曲线坐标中的一个标准恒等式将逆变基矢与协变基矢的叉积联系起来：\n$$\n\\mathbf{e}^{\\psi} = \\frac{\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}}{\\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})} = \\frac{1}{\\mathcal{J}}(\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})\n$$\n通过循环置换，我们还有：\n$$\n\\mathbf{e}^{\\theta} = \\frac{1}{\\mathcal{J}}(\\mathbf{e}_{\\phi} \\times \\mathbf{e}_{\\psi}), \\quad \\mathbf{e}^{\\phi} = \\frac{1}{\\mathcal{J}}(\\mathbf{e}_{\\psi} \\times \\mathbf{e}_{\\theta})\n$$\n将这些代入 $\\nabla f$ 的表达式中，可以明确地显示出雅可比量的作用：\n$$\n\\nabla f = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial f}{\\partial \\psi} (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) + \\frac{\\partial f}{\\partial \\theta} (\\mathbf{e}_{\\phi} \\times \\mathbf{e}_{\\psi}) + \\frac{\\partial f}{\\partial \\phi} (\\mathbf{e}_{\\psi} \\times \\mathbf{e}_{\\theta}) \\right)\n$$\n\n**矢量场 $\\mathbf{A} = A^i\\mathbf{e}_i$ 的散度**\n\n散度定义为无穷小体积元极限下的单位体积通量：\n$$\n\\nabla \\cdot \\mathbf{A} = \\lim_{\\Delta V \\to 0} \\frac{1}{\\Delta V} \\oint_{\\partial(\\Delta V)} \\mathbf{A} \\cdot d\\mathbf{S}\n$$\n我们考虑一个由矢量 $\\mathbf{e}_{\\psi}d\\psi$、$\\mathbf{e}_{\\theta}d\\theta$ 和 $\\mathbf{e}_{\\phi}d\\phi$ 构成的无穷小平移六面体。其体积为 $\\Delta V = |\\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})| d\\psi d\\theta d\\phi = \\mathcal{J} d\\psi d\\theta d\\phi$，因为对于右手坐标系，$\\mathcal{J} = \\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) > 0$。\n\n流出该体积的总通量是穿过其六个面的通量之和。我们来计算穿过位于常数 $\\psi$ 和 $\\psi+d\\psi$ 的一对面的净通量。在 $\\psi+d\\psi$ 面上，向外的面元矢量是 $d\\mathbf{S}_{\\psi} = \\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi} d\\theta d\\phi$。穿过该面的通量是 $\\mathbf{A}(\\psi+d\\psi, \\theta, \\phi) \\cdot d\\mathbf{S}_{\\psi}$。\n穿过 $\\psi$ 面的通量有一个方向相反的面矢量，所以净通量是：\n$$\n\\Delta\\Phi_{\\psi} = \\left[ \\mathbf{A}(\\psi+d\\psi) \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) d\\theta d\\phi \\right] - \\left[ \\mathbf{A}(\\psi) \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) d\\theta d\\phi \\right]\n$$\n（基矢也是坐标的函数，但在该公式中我们可以使用乘积法则。）这可以写成：\n$$\n\\Delta\\Phi_{\\psi} = \\frac{\\partial}{\\partial \\psi} \\left( \\mathbf{A} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) \\right) d\\psi d\\theta d\\phi\n$$\n我们来计算点积。给定 $\\mathbf{A} = A^{\\psi}\\mathbf{e}_{\\psi} + A^{\\theta}\\mathbf{e}_{\\theta} + A^{\\phi}\\mathbf{e}_{\\phi}$。\n$$\n\\mathbf{A} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) = (A^{\\psi}\\mathbf{e}_{\\psi} + A^{\\theta}\\mathbf{e}_{\\theta} + A^{\\phi}\\mathbf{e}_{\\phi}) \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) = A^{\\psi} (\\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})) = A^{\\psi} \\mathcal{J}\n$$\n所以，穿过 $\\psi$ 面的净通量是 $\\frac{\\partial}{\\partial \\psi}(\\mathcal{J} A^{\\psi}) d\\psi d\\theta d\\phi$。通过对坐标 $(\\psi, \\theta, \\phi)$ 进行循环置换，穿过其他对面组的净通量分别为 $\\frac{\\partial}{\\partial \\theta}(\\mathcal{J} A^{\\theta}) d\\psi d\\theta d\\phi$ 和 $\\frac{\\partial}{\\partial \\phi}(\\mathcal{J} A^{\\phi}) d\\psi d\\theta d\\phi$。\n\n总通量是这三项贡献之和：\n$$\n\\oint \\mathbf{A} \\cdot d\\mathbf{S} = \\left( \\frac{\\partial(\\mathcal{J} A^{\\psi})}{\\partial \\psi} + \\frac{\\partial(\\mathcal{J} A^{\\theta})}{\\partial \\theta} + \\frac{\\partial(\\mathcal{J} A^{\\phi})}{\\partial \\phi} \\right) d\\psi d\\theta d\\phi\n$$\n除以体积 $\\Delta V = \\mathcal{J} d\\psi d\\theta d\\phi$，我们得到散度的表达式：\n$$\n\\nabla \\cdot \\mathbf{A} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial(\\mathcal{J} A^{\\psi})}{\\partial \\psi} + \\frac{\\partial(\\mathcal{J} A^{\\theta})}{\\partial \\theta} + \\frac{\\partial(\\mathcal{J} A^{\\phi})}{\\partial \\phi} \\right)\n$$\n这个表达式明确地显示了对于用逆变分量和协变基矢表示的矢量，雅可比量 $\\mathcal{J}$ 如何进入散度算子。\n\n**第2部分：$\\nabla \\cdot \\mathbf{B}$ 的计算**\n\n磁场由 Clebsch 表示给出 $\\mathbf{B} = \\nabla\\psi \\times \\nabla\\alpha$。\n首先，我们必须找到 $\\mathbf{B}$ 的逆变分量（$B^{\\psi}$, $B^{\\theta}$, $B^{\\phi}$），使得 $\\mathbf{B} = B^{\\psi}\\mathbf{e}_{\\psi} + B^{\\theta}\\mathbf{e}_{\\theta} + B^{\\phi}\\mathbf{e}_{\\phi}$。为此，我们将梯度在逆变基矢中表示：\n$$\n\\nabla\\psi = \\mathbf{e}^{\\psi}\n$$\n$$\n\\nabla\\alpha = \\frac{\\partial \\alpha}{\\partial \\psi} \\mathbf{e}^{\\psi} + \\frac{\\partial \\alpha}{\\partial \\theta} \\mathbf{e}^{\\theta} + \\frac{\\partial \\alpha}{\\partial \\phi} \\mathbf{e}^{\\phi}\n$$\n现在我们计算它们的叉积：\n$$\n\\mathbf{B} = \\mathbf{e}^{\\psi} \\times \\left( \\frac{\\partial \\alpha}{\\partial \\psi} \\mathbf{e}^{\\psi} + \\frac{\\partial \\alpha}{\\partial \\theta} \\mathbf{e}^{\\theta} + \\frac{\\partial \\alpha}{\\partial \\phi} \\mathbf{e}^{\\phi} \\right)\n$$\n利用叉积的线性和 $\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\psi} = \\mathbf{0}$ 的事实：\n$$\n\\mathbf{B} = \\frac{\\partial \\alpha}{\\partial \\theta} (\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\theta}) + \\frac{\\partial \\alpha}{\\partial \\phi} (\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\phi})\n$$\n我们使用恒等式 $\\mathbf{e}^{i} \\times \\mathbf{e}^{j} = \\frac{1}{\\mathcal{J}}\\epsilon^{ijk}\\mathbf{e}_{k}$ 将此表达式从逆变基矢转换为协变基矢，其中 $\\epsilon^{ijk}$ 是 Levi-Civita 符号。采用排序 $(\\psi, \\theta, \\phi) \\leftrightarrow (1, 2, 3)$：\n$$\n\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\theta} = \\frac{1}{\\mathcal{J}}\\epsilon^{12k}\\mathbf{e}_{k} = \\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\phi}\n$$\n$$\n\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\phi} = \\frac{1}{\\mathcal{J}}\\epsilon^{13k}\\mathbf{e}_{k} = -\\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\theta}\n$$\n将这些代回 $\\mathbf{B}$ 的表达式中：\n$$\n\\mathbf{B} = \\frac{\\partial \\alpha}{\\partial \\theta} \\left( \\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\phi} \\right) + \\frac{\\partial \\alpha}{\\partial \\phi} \\left( -\\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\theta} \\right) = 0 \\cdot \\mathbf{e}_{\\psi} - \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\phi} \\mathbf{e}_{\\theta} + \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\theta} \\mathbf{e}_{\\phi}\n$$\n通过将其与 $\\mathbf{B} = B^{\\psi}\\mathbf{e}_{\\psi} + B^{\\theta}\\mathbf{e}_{\\theta} + B^{\\phi}\\mathbf{e}_{\\phi}$ 进行比较，我们确定 $\\mathbf{B}$ 的逆变分量：\n$$\nB^{\\psi} = 0\n$$\n$$\nB^{\\theta} = -\\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\phi}\n$$\n$$\nB^{\\phi} = \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\theta}\n$$\n现在我们将这些分量代入第1部分推导出的散度公式中：\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial(\\mathcal{J} B^{\\psi})}{\\partial \\psi} + \\frac{\\partial(\\mathcal{J} B^{\\theta})}{\\partial \\theta} + \\frac{\\partial(\\mathcal{J} B^{\\phi})}{\\partial \\phi} \\right)\n$$\n我们来计算括号内的各项：\n$$\n\\mathcal{J} B^{\\psi} = \\mathcal{J}(0) = 0\n$$\n$$\n\\mathcal{J} B^{\\theta} = \\mathcal{J} \\left( -\\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\phi} \\right) = -\\frac{\\partial \\alpha}{\\partial \\phi}\n$$\n$$\n\\mathcal{J} B^{\\phi} = \\mathcal{J} \\left( \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\theta} \\right) = \\frac{\\partial \\alpha}{\\partial \\theta}\n$$\n将这些代回散度表达式中：\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial(0)}{\\partial \\psi} + \\frac{\\partial}{\\partial \\theta}\\left(-\\frac{\\partial \\alpha}{\\partial \\phi}\\right) + \\frac{\\partial}{\\partial \\phi}\\left(\\frac{\\partial \\alpha}{\\partial \\theta}\\right) \\right)\n$$\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( 0 - \\frac{\\partial^2 \\alpha}{\\partial \\theta \\partial \\phi} + \\frac{\\partial^2 \\alpha}{\\partial \\phi \\partial \\theta} \\right)\n$$\n问题陈述 $\\alpha$ 具有连续的二阶混合偏导数。根据 Clairaut 定理（混合偏导数相等），如果二阶偏导数是连续的，那么它们的求导次序可以交换：\n$$\n\\frac{\\partial^2 \\alpha}{\\partial \\theta \\partial \\phi} = \\frac{\\partial^2 \\alpha}{\\partial \\phi \\partial \\theta}\n$$\n因此，括号中的表达式为零：\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial^2 \\alpha}{\\partial \\phi \\partial \\theta} - \\frac{\\partial^2 \\alpha}{\\partial \\theta \\partial \\phi} \\right) = \\frac{1}{\\mathcal{J}}(0) = 0\n$$\n这个结果证实了用 Clebsch 表示法表示的磁场具有无散性（$\\nabla\\cdot\\mathbf{B}=0$），这是 MHD 中的一个基本要求。最终值为实数 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "掌握了坐标系之后，下一步是量化驱动不稳定性的物理机制。压力梯度、磁曲率和磁场线弯曲之间的竞争决定了稳定性。本练习将指导您构建一个仿星器特有的“压力梯度驱动度规”$\\alpha_{\\mathrm{eff}}$，它类似于托卡马克中著名的 $\\alpha$ 参数。这个练习展示了如何将复杂的三维物理提炼成一个富有洞察力的单一参数，并突显了仿星器中轴对称性的缺失如何为不稳定性驱动带来更丰富的谐波成分 。",
            "id": "4049485",
            "problem": "考虑理想磁流体力学 (MHD) 中环形等离子体嵌套磁面上的不可压缩交换/气球模微扰。从理想MHD力平衡方程 $ \\nabla p = \\mathbf{J} \\times \\mathbf{B} $ 和理想MHD能量原理出发，并回想在局域气球模表示中，压强梯度驱动是通过沿选定磁力线上直磁力线角 $\\vartheta$ 的法向曲率 $\\kappa_n(\\vartheta)$ 进入的。在大环径比圆形托卡马克中，气球模方程中压强梯度项的系数通常被归结为一个无量纲参数，常由一个符号表示，并被理解为与安全因子 $q$ 和大半径 $R_0$ 成比例。\n\n你的任务是，从第一性原理出发，通过在直磁力线坐标系中使用最小二乘法，将几何驱动投影到驱动交换模的基本极向谐波 $\\cos \\vartheta$ 上，从而为仿星器磁力线构建一个类似的、坐标无关的“压强梯度驱动度规”。具体来说，将仿星器等效气球模驱动定义为\n$$\n\\alpha_{\\mathrm{eff}} \\equiv - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\,\n\\frac{\\displaystyle \\int_{0}^{2\\pi} \\kappa_n(\\vartheta) \\cos \\vartheta \\, \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right|^{-2} \\, \\mathrm{d}\\vartheta}{\\displaystyle \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right|^{-2} \\, \\mathrm{d}\\vartheta},\n$$\n其中 $ \\mathbf{b} \\equiv \\mathbf{B}/|\\mathbf{B}| $，$ \\mu_0 $ 是真空磁导率，$ B_0 $ 是磁面上的特征磁场强度，$ R_0 $ 是大半径标度，$ \\mathrm{d}p/\\mathrm{d}r $ 是磁面径向压强梯度。\n\n假设一个模型仿星器磁力线几何，其中：\n- 直磁力线度规因子沿磁力线为常数，$ \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right| = ( q_{\\mathrm{eff}} R_0 )^{-1} $，其中 $ q_{\\mathrm{eff}} $ 是磁面上的一个常数“等效安全因子”，\n- 沿此磁力线的法向曲率为\n$$\n\\kappa_n(\\vartheta) = \\frac{1}{R_0} \\left[ a_1 \\cos \\vartheta + a_N \\cos(N \\vartheta + \\varphi) \\right],\n$$\n其中 $a_1$ 和 $a_N$ 是无量纲常数，$N \\ge 2$ 是一个整数螺旋性，$\\varphi \\in [0,2\\pi)$ 是一个相位。\n\n1) 从理想MHD能量原理和直磁力线气球模表示出发，通过阐明压强梯度项如何与 $\\kappa_n(\\vartheta)$ 耦合以及权重 $\\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right|^{-2}$ 为何出现，来证明上述给出的 $\\alpha_{\\mathrm{eff}}$ 投影定义的合理性。\n\n2) 使用给定的模型和定义，计算 $\\alpha_{\\mathrm{eff}}$，结果表示为由 $\\mu_0$、$R_0$、$B_0$、$\\mathrm{d}p/\\mathrm{d}r$、$q_{\\mathrm{eff}}$ 以及几何参数 $a_1$、$a_N$、$N$ 和 $\\varphi$ 构成的闭合形式符号表达式。你的最终结果必须是单一的解析表达式。无需进行数值计算。将答案表示为无量纲量。不要包含单位。不适用四舍五入。",
            "solution": "这个问题包含两个部分。第一部分要求基于理想磁流体力学（MHD）的第一性原理，为所提供的仿星器等效气球模驱动 $ \\alpha_{\\mathrm{eff}} $ 的定义提供合理性证明。第二部分要求对于给定的仿星器磁几何模型，显式计算 $ \\alpha_{\\mathrm{eff}} $。\n\n### 第1部分：$ \\alpha_{\\mathrm{eff}} $ 定义的合理性证明\n\n$ \\alpha_{\\mathrm{eff}} $ 的定义如下：\n$$\n\\alpha_{\\mathrm{eff}} \\equiv - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\,\n\\frac{\\displaystyle \\int_{0}^{2\\pi} \\kappa_n(\\vartheta) \\cos \\vartheta \\, \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right|^{-2} \\, \\mathrm{d}\\vartheta}{\\displaystyle \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right|^{-2} \\, \\mathrm{d}\\vartheta}\n$$\n我们必须证明该公式中关键组成部分的合理性：与法向曲率 $ \\kappa_n(\\vartheta) $ 的耦合、到 $ \\cos \\vartheta $ 谐波上的投影，以及权重因子 $ \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right|^{-2} $ 的出现。\n\n1.  **与法向曲率 $ \\kappa_n(\\vartheta) $ 的耦合**\n    在理想MHD中，压强驱动不稳定性的来源由势能原理捕获，该原理由能量泛函 $ \\delta W $ 表示。对于一个由位移矢量 $ \\boldsymbol{\\xi} $（其中 $ \\nabla \\cdot \\boldsymbol{\\xi} = 0 $）表征的不可压缩等离子体微扰， $ \\delta W $ 中可能为负（导致不稳定）的一个关键项是：\n    $$\n    \\delta W_{\\text{drive}} = - \\int_V (\\boldsymbol{\\xi}_{\\perp} \\cdot \\nabla p) ( \\boldsymbol{\\xi}_{\\perp} \\cdot \\boldsymbol{\\kappa}) \\, \\mathrm{d}V\n    $$\n    此处，$ \\boldsymbol{\\xi}_{\\perp} $ 是垂直于磁场 $ \\mathbf{B} $ 的位移分量，$ p $ 是等离子体压强，$ \\boldsymbol{\\kappa} = (\\mathbf{b} \\cdot \\nabla)\\mathbf{b} $ 是磁场曲率矢量，其中 $ \\mathbf{b} = \\mathbf{B}/|\\mathbf{B}| $。\n    在具有嵌套磁面的磁约束等离子体中，压强梯度 $ \\nabla p = \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\nabla r $ 径向朝外。交换模和气球模由径向位移主导，因此 $ \\boldsymbol{\\xi}_{\\perp} \\approx \\xi_r \\nabla r $。曲率矢量可以分解为法向分量和测地分量，$ \\boldsymbol{\\kappa} = \\kappa_n \\mathbf{\\hat{n}} + \\kappa_g \\mathbf{\\hat{g}} $。法向曲率 $ \\kappa_n = \\boldsymbol{\\kappa} \\cdot \\nabla r / |\\nabla r| $ 沿径向方向。\n    将这些代入驱动项，我们得到：\n    $$\n    \\delta W_{\\text{drive}} \\approx - \\int_V (\\xi_r |\\nabla r|^2 \\frac{\\mathrm{d}p}{\\mathrm{d}r}) (\\xi_r \\kappa_n) \\, \\mathrm{d}V = - \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\int_V \\kappa_n(\\vartheta) \\xi_r^2 |\\nabla r|^2 \\, \\mathrm{d}V\n    $$\n    在法向曲率为正或“不利”的区域（$ \\kappa_n > 0 $），负压强梯度（$\\frac{\\mathrm{d}p}{\\mathrm{d}r}  0$，这是约束等离子体的标准情况）会促进不稳定性（$\\delta W_{\\text{drive}}  0$）。该分析确立了不稳定性驱动与法向曲率 $ \\kappa_n(\\vartheta) $ 之间的直接耦合。\n\n2.  **到 $ \\cos \\vartheta $ 上的投影**\n    气球模表示法分析沿单条磁力线的微扰。极向角 $ \\vartheta $ 作为沿该线的坐标。在典型的环形装置中，外侧（大半径最大处）对应于 $ \\vartheta \\approx 0 $。该区域具有不利曲率（$ \\kappa_n > 0 $），是不稳定性的主要来源。描述一个在该不利区域最大而在有利区域（$ \\vartheta \\approx \\pi $）最小的模的基本谐波是 $ \\cos \\vartheta $。\n    在复杂的三维仿星器场中，完整的曲率剖面 $ \\kappa_n(\\vartheta) $ 包含许多谐波。$ \\alpha_{\\mathrm{eff}} $ 的定义使用加权最小二乘投影来分离出 $ \\kappa_n(\\vartheta) $ 中驱动交换模的基本分量的“等效”振幅。该定义中的积分之比，正是在使用权重为 $ w(\\vartheta) = \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right|^{-2} $ 的内积时，将 $ \\kappa_n(\\vartheta) $ 投影到基函数 $ \\cos \\vartheta $ 上的系数。\n\n3.  **权重因子 $ \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right|^{-2} $**\n    这一项是最微妙的，它源于气球模形式理论的详细数学结构。量 $\\left|\\mathbf{b} \\cdot \\nabla \\vartheta\\right|^{-1} = \\frac{\\mathrm{d}l}{\\mathrm{d}\\vartheta}$ 表示沿磁力线的弧长微分 $\\mathrm{d}l$ 与极向角变化单位 $\\mathrm{d}\\vartheta$ 之比。较小的 $\\left|\\mathbf{b} \\cdot \\nabla \\vartheta\\right|$ 值意味着磁力线在该 $\\vartheta$ 范围内“逗留”时间更长，从而放大了局域的物理效应。\n    在推导一维气球模本征值方程时，我们从三维的 $ \\delta W $ 出发，并对磁面积分。起稳定作用的磁力线弯曲能和起不稳定作用的压强梯度能都涉及到来自体积元（$ \\mathrm{d}V = J \\mathrm{d}r \\mathrm{d}\\vartheta \\mathrm{d}\\zeta $）和沿磁力线导数（$ \\mathbf{b} \\cdot \\nabla = |\\mathbf{b} \\cdot \\nabla \\vartheta| \\frac{\\mathrm{d}}{\\mathrm{d}\\vartheta} $）的几何因子。必须分析稳定的弯曲项（其标度为 $\\sim \\int (dY/d\\vartheta)^2 |\\mathbf{b} \\cdot \\nabla \\vartheta| d\\vartheta$）与驱动的压强项（其标度为 $\\sim \\int Y^2 \\kappa_n / |\\mathbf{b} \\cdot \\nabla \\vartheta| d\\vartheta$）之间的竞争。在等效驱动度规的定义中，特定的权重 $ \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right|^{-2} $ 出现在某些理论的高级表述中，这些表述使用变量变换来简化能量泛函的一部分（例如，拉格朗日量中的动能项），从而导致这个权重因子出现在势能项中。这是一种以坐标无关的方式同时考虑磁力线驻留时间和等离子体元惯性的复杂方法。\n\n### 第2部分：$ \\alpha_{\\mathrm{eff}} $ 的计算\n\n我们的任务是使用给定的模型假设来计算 $ \\alpha_{\\mathrm{eff}} $：\n- 直磁力线度规因子为常数：$ \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right| = ( q_{\\mathrm{eff}} R_0 )^{-1} $。\n- 法向曲率为：$ \\kappa_n(\\vartheta) = \\frac{1}{R_0} \\left[ a_1 \\cos \\vartheta + a_N \\cos(N \\vartheta + \\varphi) \\right] $。\n\n我们将这些代入 $ \\alpha_{\\mathrm{eff}} $ 的定义中。权重因子为 $ \\left| \\mathbf{b} \\cdot \\nabla \\vartheta \\right|^{-2} = (q_{\\mathrm{eff}} R_0)^{2} $。由于这是一个常数，它可以从两个积分中提出并相互抵消：\n$$\n\\alpha_{\\mathrm{eff}} = - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\,\n\\frac{\\displaystyle \\int_{0}^{2\\pi} \\kappa_n(\\vartheta) \\cos \\vartheta \\, (q_{\\mathrm{eff}} R_0)^2 \\, \\mathrm{d}\\vartheta}{\\displaystyle \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, (q_{\\mathrm{eff}} R_0)^2 \\, \\mathrm{d}\\vartheta}\n= - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\,\n\\frac{\\displaystyle \\int_{0}^{2\\pi} \\kappa_n(\\vartheta) \\cos \\vartheta \\, \\mathrm{d}\\vartheta}{\\displaystyle \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, \\mathrm{d}\\vartheta}\n$$\n让我们分别计算分子和分母的积分。\n\n**分母积分：**\n$$\nI_{\\mathrm{den}} = \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, \\mathrm{d}\\vartheta\n$$\n使用半角恒等式 $ \\cos^2 \\vartheta = \\frac{1}{2}(1 + \\cos(2\\vartheta)) $：\n$$\nI_{\\mathrm{den}} = \\int_{0}^{2\\pi} \\frac{1}{2}(1 + \\cos(2\\vartheta)) \\, \\mathrm{d}\\vartheta = \\frac{1}{2} \\left[ \\vartheta + \\frac{1}{2}\\sin(2\\vartheta) \\right]_0^{2\\pi} = \\frac{1}{2} ((2\\pi + 0) - (0+0)) = \\pi\n$$\n\n**分子积分：**\n$$\nI_{\\mathrm{num}} = \\int_{0}^{2\\pi} \\kappa_n(\\vartheta) \\cos \\vartheta \\, \\mathrm{d}\\vartheta\n$$\n代入 $ \\kappa_n(\\vartheta) $ 的表达式：\n$$\nI_{\\mathrm{num}} = \\int_{0}^{2\\pi} \\frac{1}{R_0} \\left[ a_1 \\cos \\vartheta + a_N \\cos(N \\vartheta + \\varphi) \\right] \\cos \\vartheta \\, \\mathrm{d}\\vartheta\n$$\n$$\nI_{\\mathrm{num}} = \\frac{1}{R_0} \\left[ a_1 \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, \\mathrm{d}\\vartheta + a_N \\int_{0}^{2\\pi} \\cos(N \\vartheta + \\varphi) \\cos \\vartheta \\, \\mathrm{d}\\vartheta \\right]\n$$\n第一项包含我们刚刚计算的积分：$ \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, \\mathrm{d}\\vartheta = \\pi $。\n对于第二项，我们利用三角函数的正交性。积分 $ \\int_{0}^{2\\pi} \\cos(A) \\cos(B) \\, \\mathrm{d}\\vartheta $ 仅在 $ |A|=|B| $ 时非零。这里，我们将 $ \\cos(N \\vartheta + \\varphi) $ 对 $ \\cos \\vartheta $ 积分。由于问题陈述 $ N $ 是一个整数且 $ N \\ge 2 $，我们有 $ N \\ne 1 $。因此，由于在区间 $ [0, 2\\pi] $ 上的正交性，该积分为零。\n$$\n\\int_{0}^{2\\pi} \\cos(N \\vartheta + \\varphi) \\cos \\vartheta \\, \\mathrm{d}\\vartheta = 0 \\quad \\text{for } N \\ge 2\n$$\n因此，分子积分的计算结果为：\n$$\nI_{\\mathrm{num}} = \\frac{1}{R_0} [ a_1 (\\pi) + a_N (0) ] = \\frac{a_1 \\pi}{R_0}\n$$\n\n**最后组合：**\n现在我们将积分的值代回 $ \\alpha_{\\mathrm{eff}} $ 的表达式中：\n$$\n\\alpha_{\\mathrm{eff}} = - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\, \\frac{I_{\\mathrm{num}}}{I_{\\mathrm{den}}} = - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\, \\frac{a_1 \\pi / R_0}{\\pi}\n$$\n化简表达式，因子 $ \\pi $ 相互抵消，一个因子 $ R_0 $ 也抵消：\n$$\n\\alpha_{\\mathrm{eff}} = - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} R_0^2 \\frac{a_1}{R_0} = - a_1 \\frac{\\mu_0 R_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r}\n$$\n这是 $ \\alpha_{\\mathrm{eff}} $ 的最终闭合形式符号表达式。注意，由于常数权重假设和三角函数正交性，它分别与 $ q_{\\mathrm{eff}} $、$ a_N $、$ N $ 和 $ \\varphi $ 无关。",
            "answer": "$$\\boxed{-a_{1} \\frac{\\mu_{0} R_{0}}{B_{0}^{2}} \\frac{\\mathrm{d}p}{\\mathrm{d}r}}$$"
        },
        {
            "introduction": "在仿星器中，有利和不利的区域沿着磁力线和跨越磁面错综复杂地联系在一起。因此，一个区域的局部稳定并不能保证整体的稳定性。本练习引入了一个强大的概念模型，将全局稳定性问题简化为求解一个代表离散化 MHD 能量泛函 $\\delta W$ 的矩阵的本征值问题。通过构建和分析该矩阵，您将对局部（Mercier）稳定性与全局交换不稳定性之间的关键区别有一个具体的理解，并亲眼见证非对角耦合项如何使一个在每个点都看起来稳定的系统变得不稳定 。",
            "id": "4049501",
            "problem": "请考虑在三维环形位形（如仿星器）中，局部Mercier稳定性与全局交换不稳定性之间的区别。在理想磁流体动力学 (MHD) 中，能量原理指出，如果对于所有容许的扰动，势能的二阶变分（记为 $\\delta W$）为正，则等离子体平衡是线性稳定的。局部Mercier稳定性判据评估了在给定磁面上，由包括压力梯度、磁曲率和磁剪切在内的平衡几何量所构造的局部参数 $D_{\\mathrm{M}}$ 的符号；$D_{\\mathrm{M}} > 0$ 在气球模极限下表示局部交换稳定性。相比之下，全局交换不稳定性要求在考虑整个位形的全局耦合时，与 $\\delta W$ 相关的二次型是正定的。这种耦合包括相邻傅里叶分量、场周期或磁通管段之间的耦合。即使在每个位置都满足局部Mercier判据，这些耦合也可能使全局模不稳定。\n\n从理想MHD能量原理出发，通过一个代表 $\\delta W$ 离散化二次型的有限维实对称矩阵 $\\mathbf{A}$ 来对全局稳定性问题进行建模。矩阵 $\\mathbf{A}$ 的对角元是位置 $i$ 处的局部Mercier参数 $D_{\\mathrm{M},i}$，而非对角元 $C_{ij}$ 代表由于磁场非轴对称性、几何耦合或模式相互作用在位置 $i$ 和 $j$ 之间的守恒能量耦合。在这个玩具模型中，全局交换不稳定性等价于矩阵 $\\mathbf{A}$ 的所有特征值都严格为正，而局部Mercier稳定性对应于每个对角元 $D_{\\mathrm{M},i} > 0$。当且仅当矩阵 $\\mathbf{A}$ 的最小特征值为负时，存在全局不稳定性。\n\n您的任务是：\n- 基于理想MHD能量原理，推导一个算法，用于从矩阵 $\\mathbf{A}$ 判断全局交换不稳定性。\n- 实现一个程序，对于给定的一组测试矩阵 $\\mathbf{A}$，计算每个矩阵的最小特征值 $\\lambda_{\\min}$。将 $\\lambda_{\\min} > 0$ 解释为全局稳定，$\\lambda_{\\min} = 0$ 解释为临界稳定，$\\lambda_{\\min}  0$ 解释为全局不稳定。\n- 构建并包含至少一个测试用例，其中所有局部的 $D_{\\mathrm{M},i} > 0$，但由于足够强的耦合 $C_{ij}$，全局模变得不稳定。\n\n在本问题中，所有量都是无量纲的。不使用角度。该算法必须从理想MHD能量原理的陈述（即稳定性要求对所有扰动 $\\delta W > 0$）出发，通过离散化得到对称矩阵 $\\mathbf{A}$，其特征值决定了稳定性。\n\n使用以下测试矩阵套件：\n1. 情况1（理想路径，局部和全局均稳定）：$2 \\times 2$ 矩阵，其中 $D_{\\mathrm{M}} = [1.0, 1.0]$，耦合 $C_{01} = 0.3$。\n2. 情况2（边界条件，临界全局稳定）：$2 \\times 2$ 矩阵，其中 $D_{\\mathrm{M}} = [1.0, 1.0]$，耦合 $C_{01} = 1.0$。\n3. 情况3（所要求的现象，局部稳定但全局不稳定）：$2 \\times 2$ 矩阵，其中 $D_{\\mathrm{M}} = [1.0, 1.0]$，耦合 $C_{01} = 2.0$。\n4. 情况4（边缘情况，局部Mercier判据被违反）：$3 \\times 3$ 矩阵，其中 $D_{\\mathrm{M}} = [1.0, -0.2, 0.8]$，耦合 $C_{01} = 0.1$ 和 $C_{12} = 0.1$。\n\n对于每种情况，按如下方式构造矩阵 $\\mathbf{A}$：设置 $\\mathbf{A}_{ii} = D_{\\mathrm{M},i}$，对于每个指定的耦合，设置 $\\mathbf{A}_{ij} = \\mathbf{A}_{ji} = C_{ij}$，所有其他非对角元为零。计算每种情况下 $\\mathbf{A}$ 的最小特征值 $\\lambda_{\\min}$ 并报告它。\n\n最终输出规范：\n- 生成单行输出，其中包含所有四个测试用例的结果，形式为一个用方括号括起来的逗号分隔的浮点数列表，每个浮点数四舍五入到六位小数（例如，$\\left[0.123456,-0.000001,0.000000,2.000000\\right]$）。",
            "solution": "理想MHD线性稳定性的基本原则是能量原理。一个磁约束等离子体平衡是稳定的，当且仅当与等离子体的任何物理上容许的无穷小位移 $\\vec{\\xi}(\\vec{r})$ 相关联的势能变化 $\\delta W$ 为正。在数学上，这表示为：\n$$ \\delta W[\\vec{\\xi}, \\vec{\\xi}] > 0 $$\n对于所有非平凡位移场 $\\vec{\\xi}$。$\\delta W$ 项是 $\\vec{\\xi}$ 的二次泛函，意味着它二次地依赖于位移场及其空间导数。\n\n为了将此原理转化为一个计算上可处理的问题，所有可能位移场 $\\vec{\\xi}(\\vec{r})$ 的无穷维空间被投影到一个有限维子空间上。这是通过将 $\\vec{\\xi}(\\vec{r})$ 表示为一组有限的 $N$ 个基函数 $\\{\\vec{f}_i(\\vec{r})\\}_{i=1}^N$ 的线性组合来实现的：\n$$ \\vec{\\xi}(\\vec{r}) = \\sum_{i=1}^{N} x_i \\vec{f}_i(\\vec{r}) $$\n这里，$x_i$ 是基函数的标量振幅。通过将此展开式代入能量泛函并利用其双线性性质，我们得到一个关于未知振幅 $x_i$ 的二次型：\n$$ \\delta W = \\sum_{i=1}^{N} \\sum_{j=1}^{N} x_i x_j \\delta W[\\vec{f}_i, \\vec{f}_j] $$\n这个表达式可以写成矩阵形式：\n$$ \\delta W = \\mathbf{x}^T \\mathbf{A} \\mathbf{x} $$\n其中 $\\mathbf{x}$ 是振幅的列向量 $[x_1, x_2, \\dots, x_N]^T$，而 $\\mathbf{A}$ 是一个 $N \\times N$ 矩阵，其元素由基函数对的能量积分给出：\n$$ A_{ij} = \\delta W[\\vec{f}_i, \\vec{f}_j] $$\n理想MHD中的 $\\delta W$ 泛函算符是自伴的，这意味着所得到的矩阵 $\\mathbf{A}$ 是实对称的，即 $A_{ij} = A_{ji}$。\n\n问题陈述提供了这样一个矩阵 $\\mathbf{A}$。对角元 $\\mathbf{A}_{ii} = D_{\\mathrm{M},i}$ 与局部稳定性判据相对应，代表一个局域扰动 $x_i \\vec{f}_i$ 的能量代价。非对角元 $\\mathbf{A}_{ij} = C_{ij}$ (当 $i \\neq j$ 时) 代表不同基函数（模式）之间的能量耦合，这是非轴对称系统中全局稳定性的一个关键特征。\n\n对于所有非平凡扰动 $\\vec{\\xi}$，稳定性条件 $\\delta W > 0$ 转化为对于所有非零向量 $\\mathbf{x} \\in \\mathbb{R}^N$，二次型 $\\mathbf{x}^T \\mathbf{A} \\mathbf{x} > 0$。这正是正定矩阵的定义。\n\n线性代数的一个基本定理指出，一个实对称矩阵是正定的，当且仅当其所有特征值都严格为正。因此，由矩阵 $\\mathbf{A}$ 描述的系统的稳定性可以通过检查其特征值谱来确定。如果我们将 $\\mathbf{A}$ 的特征值表示为 $\\lambda_1, \\lambda_2, \\dots, \\lambda_N$，则系统是：\n- 如果最小特征值 $\\lambda_{\\min} = \\min(\\{\\lambda_k\\})$ 为正（$\\lambda_{\\min} > 0$），则为**全局稳定**。\n- 如果最小特征值为零（$\\lambda_{\\min} = 0$），则为**临界稳定**。\n- 如果最小特征值为负（$\\lambda_{\\min}  0$），则为**全局不稳定**。\n\n矩阵 $\\mathbf{A}$ 的特征值代表了与相应特征向量（系统的全局本征模）相关联的势能。一个负特征值表示存在一个可以降低系统势能的全局模，从而导致不稳定性。\n\n因此，推导出的算法如下：\n1.  根据所提供的局部稳定性参数 $D_{\\mathrm{M},i}$ 和耦合系数 $C_{ij}$ 构造实对称矩阵 $\\mathbf{A}$。\n2.  计算矩阵 $\\mathbf{A}$ 的特征值。由于 $\\mathbf{A}$ 是实对称的，其所有特征值都是实数。标准的数值线性代数例程非常适合此任务。\n3.  在计算出的特征值中找到最小值 $\\lambda_{\\min}$。\n4.  根据 $\\lambda_{\\min}$ 的符号评估稳定性。\n\n该算法将被实现以解决所提供的测试用例。情况3具有特别的物理意义，因为它旨在表明，即使所有局部稳定性判据都满足（对所有 $i$ 都有 $D_{\\mathrm{M},i} > 0$），强耦合（$C_{ij}$）也可以驱动一个全局模变得不稳定，导致 $\\lambda_{\\min}  0$。这表明局部稳定性分析不足以确定整个系统的稳定性。情况4展示了一个更直接的情况，其中存在局部Mercier判据的违反（$D_{\\mathrm{M},1} = -0.2  0$），这是不稳定性的一个强烈指标，通常直接导致一个负特征值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives global MHD interchange stability by computing the minimum eigenvalue\n    of a matrix representing the discretized potential energy functional delta W.\n    \"\"\"\n\n    # The problem defines test cases in terms of diagonal elements (D_M) and\n    # off-diagonal couplings (C_ij). We construct the corresponding matrices.\n\n    # Case 1: 2x2, DM=[1.0, 1.0], C01=0.3. Locally and globally stable.\n    A1 = np.array([\n        [1.0, 0.3],\n        [0.3, 1.0]\n    ])\n\n    # Case 2: 2x2, DM=[1.0, 1.0], C01=1.0. Marginally stable.\n    # The coupling is exactly equal to the local stabilizing term.\n    A2 = np.array([\n        [1.0, 1.0],\n        [1.0, 1.0]\n    ])\n\n    # Case 3: 2x2, DM=[1.0, 1.0], C01=2.0. Locally stable, globally unstable.\n    # This case demonstrates that strong coupling can overcome local stability.\n    # All diagonal elements (D_M) are positive, but a global mode is unstable.\n    A3 = np.array([\n        [1.0, 2.0],\n        [2.0, 1.0]\n    ])\n\n    # Case 4: 3x3, DM=[1.0, -0.2, 0.8], C01=0.1, C12=0.1.\n    # A local Mercier violation (D_M,1 = -0.2) leads to global instability.\n    A4 = np.array([\n        [1.0, 0.1, 0.0],\n        [0.1, -0.2, 0.1],\n        [0.0, 0.1, 0.8]\n    ])\n\n    test_matrices = [A1, A2, A3, A4]\n    min_eigenvalues = []\n\n    for A in test_matrices:\n        # For a real symmetric matrix, numpy.linalg.eigvalsh is an efficient\n        # and numerically stable choice to compute the eigenvalues.\n        eigenvalues = np.linalg.eigvalsh(A)\n        \n        # The minimum eigenvalue determines the stability of the system.\n        lambda_min = np.min(eigenvalues)\n        min_eigenvalues.append(lambda_min)\n\n    # Format the results as specified: a list of floats, each rounded to\n    # six decimal places, in a single line.\n    formatted_results = [f\"{val:.6f}\" for val in min_eigenvalues]\n    output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}