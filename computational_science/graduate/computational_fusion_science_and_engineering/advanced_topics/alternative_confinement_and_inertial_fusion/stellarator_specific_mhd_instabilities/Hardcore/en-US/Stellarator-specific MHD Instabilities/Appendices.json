{
    "hands_on_practices": [
        {
            "introduction": "Before analyzing instabilities, we must first master the mathematical language used to describe magnetohydrodynamics in complex 3D geometries. This exercise solidifies your understanding of curvilinear flux coordinates, a cornerstone of stellarator theory. By deriving the divergence operator from first principles and verifying the fundamental law $\\nabla \\cdot \\mathbf{B} = 0$, you will build the mathematical foundation needed to manipulate and interpret the MHD equations in their native, non-orthogonal coordinate system. ",
            "id": "4049390",
            "problem": "Consider a stellarator equilibrium described in three-dimensional flux coordinates $(\\psi,\\theta,\\phi)$, where $\\psi$ is a toroidal flux label, $\\theta$ is a poloidal angle, and $\\phi$ is a toroidal angle. Let the position vector be $\\mathbf{r}(\\psi,\\theta,\\phi)$, and define the covariant basis vectors $\\mathbf{e}_{i}=\\partial\\mathbf{r}/\\partial u^{i}$ and the contravariant basis vectors $\\mathbf{e}^{i}=\\nabla u^{i}$, with $(u^{1},u^{2},u^{3})\\equiv(\\psi,\\theta,\\phi)$. The coordinate system is generic for stellarators and is not assumed orthogonal. The Jacobian is defined by\n$$\n\\mathcal{J}=\\left(\\nabla\\psi\\cdot\\nabla\\theta\\times\\nabla\\phi\\right)^{-1}.\n$$\nMagnetohydrodynamics (MHD) is modeled in these coordinates under the assumption that nested flux surfaces exist and that the magnetic field $\\mathbf{B}$ lies tangent to surfaces $\\psi=\\text{constant}$. Starting from first principles of vector calculus in curvilinear coordinates and the definition of the Jacobian above, do the following:\n\n1. Derive how the Jacobian $\\mathcal{J}$ enters the coordinate expressions for the gradient of a scalar $f(\\psi,\\theta,\\phi)$ and the divergence of a vector field $\\mathbf{A}(\\psi,\\theta,\\phi)$ written in contravariant form $\\mathbf{A}=A^{i}\\mathbf{e}_{i}$. Your derivation must start from the chain rule for multivariable calculus, the geometric definitions of $\\mathbf{e}_{i}$ and $\\mathbf{e}^{i}$, and the divergence defined by the limit of flux through an infinitesimal coordinate cell divided by its volume. Do not assume orthogonality.\n\n2. Using your divergence operator, consider a Clebsch-type representation of the magnetic field consistent with flux surfaces,\n$$\n\\mathbf{B}=\\nabla\\psi\\times\\nabla\\alpha(\\psi,\\theta,\\phi),\n$$\nwhere $\\alpha$ is a smooth scalar field with continuous second mixed partial derivatives in $(\\theta,\\phi)$ at fixed $\\psi$. Compute $\\nabla\\cdot\\mathbf{B}$ explicitly in $(\\psi,\\theta,\\phi)$ coordinates, showing all steps that use $\\mathcal{J}$ and basis identities. \n\nExpress the final value of $\\nabla\\cdot\\mathbf{B}$ as a real number without units. No rounding is required.",
            "solution": "The problem as stated is subjected to validation.\n\n### Step 1: Extract Givens\n-   Coordinate system: Three-dimensional flux coordinates $(\\psi, \\theta, \\phi)$, with corresponding position vector $\\mathbf{r}(\\psi, \\theta, \\phi)$.\n-   Coordinate variables: $u^1 \\equiv \\psi$ (toroidal flux label), $u^2 \\equiv \\theta$ (poloidal angle), $u^3 \\equiv \\phi$ (toroidal angle).\n-   Basis vectors: Covariant basis $\\mathbf{e}_{i} = \\frac{\\partial\\mathbf{r}}{\\partial u^{i}}$ and contravariant basis $\\mathbf{e}^{i} = \\nabla u^{i}$.\n-   Coordinate system property: Not assumed orthogonal.\n-   Jacobian definition: $\\mathcal{J} = (\\nabla\\psi \\cdot \\nabla\\theta \\times \\nabla\\phi)^{-1}$.\n-   MHD modeling assumption: Nested flux surfaces exist, and the magnetic field $\\mathbf{B}$ is tangent to surfaces of constant $\\psi$.\n-   Task 1: Derive the coordinate expressions for the gradient of a scalar $f(\\psi, \\theta, \\phi)$ and the divergence of a vector field $\\mathbf{A}(\\psi, \\theta, \\phi) = A^{i}\\mathbf{e}_{i}$, showing how the Jacobian $\\mathcal{J}$ enters. Derivations must start from first principles (chain rule, geometric definitions of basis vectors, and the limit definition of divergence).\n-   Task 2: Consider a magnetic field in Clebsch representation $\\mathbf{B} = \\nabla\\psi \\times \\nabla\\alpha(\\psi, \\theta, \\phi)$.\n-   Property of $\\alpha$: $\\alpha$ is a smooth scalar field with continuous second mixed partial derivatives in $(\\theta, \\phi)$ at fixed $\\psi$.\n-   Task 3: Compute $\\nabla \\cdot \\mathbf{B}$ explicitly in $(\\psi, \\theta, \\phi)$ coordinates, showing all steps.\n-   Final answer format: A real number without units.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is set within the well-established framework of magnetohydrodynamics (MHD) for magnetically confined plasmas, specifically using flux coordinates common in stellarator theory. The concepts of curvilinear coordinates, covariant and contravariant bases, the Jacobian, and the Clebsch representation for a magnetic field are standard and fundamental in this field. The identity $\\nabla \\cdot \\mathbf{B} = 0$ is a cornerstone of Maxwell's equations and MHD. The problem asks for a derivation and verification of this fact within a specific coordinate representation. This is scientifically sound.\n-   **Well-Posed:** The problem is clearly structured into two parts. The first part asks for the derivation of fundamental differential operators in curvilinear coordinates. The starting points and required methodology are specified. The second part is a direct application of the results from the first part to a specific, well-defined vector field. The condition on the smoothness of $\\alpha$ is provided, which is necessary to complete the final step of the calculation. A unique, meaningful solution exists.\n-   **Objective:** The problem is stated in precise mathematical language, free of ambiguity, subjectivity, or opinion. All terms are standard in vector calculus and theoretical physics.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, rigorous exercise in theoretical plasma physics that tests understanding of vector calculus in general curvilinear coordinates. The solution will now be provided.\n\n### Solution\n\nThe solution is presented in two parts as requested by the problem statement.\n\n**Part 1: Derivation of Gradient and Divergence Operators**\n\n**Gradient of a scalar field $f(\\psi, \\theta, \\phi)$**\n\nLet $f(\\psi, \\theta, \\phi)$ be a scalar field. By the chain rule, its total differential $df$ is given by:\n$$\ndf = \\frac{\\partial f}{\\partial \\psi} d\\psi + \\frac{\\partial f}{\\partial \\theta} d\\theta + \\frac{\\partial f}{\\partial \\phi} d\\phi\n$$\nThe gradient of $f$, denoted $\\nabla f$, is defined such that $df = \\nabla f \\cdot d\\mathbf{r}$, where $d\\mathbf{r}$ is the differential displacement vector. In our coordinate system, $d\\mathbf{r}$ can be expressed in terms of the covariant basis vectors $\\mathbf{e}_i = \\frac{\\partial\\mathbf{r}}{\\partial u^i}$:\n$$\nd\\mathbf{r} = \\frac{\\partial \\mathbf{r}}{\\partial \\psi} d\\psi + \\frac{\\partial \\mathbf{r}}{\\partial \\theta} d\\theta + \\frac{\\partial \\mathbf{r}}{\\partial \\phi} d\\phi = \\mathbf{e}_{\\psi} d\\psi + \\mathbf{e}_{\\theta} d\\theta + \\mathbf{e}_{\\phi} d\\phi\n$$\nWe express the gradient vector $\\nabla f$ in the contravariant basis $\\mathbf{e}^i = \\nabla u^i$:\n$$\n\\nabla f = (\\nabla f)_{\\psi} \\mathbf{e}^{\\psi} + (\\nabla f)_{\\theta} \\mathbf{e}^{\\theta} + (\\nabla f)_{\\phi} \\mathbf{e}^{\\phi}\n$$\nThe dot product $\\nabla f \\cdot d\\mathbf{r}$ is then computed using the fundamental property of dual bases, $\\mathbf{e}^{i} \\cdot \\mathbf{e}_{j} = \\delta^{i}_{j}$ (the Kronecker delta):\n$$\n\\nabla f \\cdot d\\mathbf{r} = ((\\nabla f)_{\\psi} \\mathbf{e}^{\\psi} + \\dots) \\cdot (\\mathbf{e}_{\\psi} d\\psi + \\dots) = (\\nabla f)_{\\psi} d\\psi + (\\nabla f)_{\\theta} d\\theta + (\\nabla f)_{\\phi} d\\phi\n$$\nComparing this with the chain rule expression for $df$, we identify the components of the gradient:\n$$\n(\\nabla f)_{\\psi} = \\frac{\\partial f}{\\partial \\psi}, \\quad (\\nabla f)_{\\theta} = \\frac{\\partial f}{\\partial \\theta}, \\quad (\\nabla f)_{\\phi} = \\frac{\\partial f}{\\partial \\phi}\n$$\nThus, the expression for the gradient is:\n$$\n\\nabla f = \\frac{\\partial f}{\\partial \\psi} \\mathbf{e}^{\\psi} + \\frac{\\partial f}{\\partial \\theta} \\mathbf{e}^{\\theta} + \\frac{\\partial f}{\\partial \\phi} \\mathbf{e}^{\\phi} = \\sum_{i} \\frac{\\partial f}{\\partial u^i} \\mathbf{e}^{i}\n$$\nThe Jacobian $\\mathcal{J}$ enters this expression through the relationship between the contravariant and covariant basis vectors. From the definition, $\\mathcal{J}^{-1} = \\mathbf{e}^{\\psi} \\cdot (\\mathbf{e}^{\\theta} \\times \\mathbf{e}^{\\phi})$. A standard identity in curvilinear coordinates relates the contravariant basis vectors to the cross product of covariant basis vectors:\n$$\n\\mathbf{e}^{\\psi} = \\frac{\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}}{\\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})} = \\frac{1}{\\mathcal{J}}(\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})\n$$\nBy cyclic permutation, we also have:\n$$\n\\mathbf{e}^{\\theta} = \\frac{1}{\\mathcal{J}}(\\mathbf{e}_{\\phi} \\times \\mathbf{e}_{\\psi}), \\quad \\mathbf{e}^{\\phi} = \\frac{1}{\\mathcal{J}}(\\mathbf{e}_{\\psi} \\times \\mathbf{e}_{\\theta})\n$$\nSubstituting these into the expression for $\\nabla f$ explicitly shows the role of the Jacobian:\n$$\n\\nabla f = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial f}{\\partial \\psi} (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) + \\frac{\\partial f}{\\partial \\theta} (\\mathbf{e}_{\\phi} \\times \\mathbf{e}_{\\psi}) + \\frac{\\partial f}{\\partial \\phi} (\\mathbf{e}_{\\psi} \\times \\mathbf{e}_{\\theta}) \\right)\n$$\n\n**Divergence of a vector field $\\mathbf{A} = A^i\\mathbf{e}_i$**\n\nThe divergence is defined by the flux per unit volume in the limit of an infinitesimal volume element:\n$$\n\\nabla \\cdot \\mathbf{A} = \\lim_{\\Delta V \\to 0} \\frac{1}{\\Delta V} \\oint_{\\partial(\\Delta V)} \\mathbf{A} \\cdot d\\mathbf{S}\n$$\nWe consider an infinitesimal parallelepiped formed by the vectors $\\mathbf{e}_{\\psi}d\\psi$, $\\mathbf{e}_{\\theta}d\\theta$, and $\\mathbf{e}_{\\phi}d\\phi$. Its volume is $\\Delta V = |\\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})| d\\psi d\\theta d\\phi = \\mathcal{J} d\\psi d\\theta d\\phi$, since $\\mathcal{J} = \\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})  0$ for a right-handed coordinate system.\n\nThe total flux out of the volume is the sum of fluxes through its six faces. Let's calculate the net flux through the pair of faces at constant $\\psi$ and $\\psi+d\\psi$. The outward-pointing surface element vector on the face at $\\psi+d\\psi$ is $d\\mathbf{S}_{\\psi} = \\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi} d\\theta d\\phi$. The flux through this face is $\\mathbf{A}(\\psi+d\\psi, \\theta, \\phi) \\cdot d\\mathbf{S}_{\\psi}$.\nThe flux through the face at $\\psi$ has an opposite-pointing surface vector, so the net flux is:\n$$\n\\Delta\\Phi_{\\psi} = \\left[ \\mathbf{A}(\\psi+d\\psi) \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) d\\theta d\\phi \\right] - \\left[ \\mathbf{A}(\\psi) \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) d\\theta d\\phi \\right]\n$$\n(Basis vectors are also functions of coordinates, but in this formulation we can use the product rule.) This can be written as:\n$$\n\\Delta\\Phi_{\\psi} = \\frac{\\partial}{\\partial \\psi} \\left( \\mathbf{A} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) \\right) d\\psi d\\theta d\\phi\n$$\nLet's evaluate the dot product. We are given $\\mathbf{A} = A^{\\psi}\\mathbf{e}_{\\psi} + A^{\\theta}\\mathbf{e}_{\\theta} + A^{\\phi}\\mathbf{e}_{\\phi}$.\n$$\n\\mathbf{A} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) = (A^{\\psi}\\mathbf{e}_{\\psi} + A^{\\theta}\\mathbf{e}_{\\theta} + A^{\\phi}\\mathbf{e}_{\\phi}) \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) = A^{\\psi} (\\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})) = A^{\\psi} \\mathcal{J}\n$$\nSo, the net flux through the $\\psi$-faces is $\\frac{\\partial}{\\partial \\psi}(\\mathcal{J} A^{\\psi}) d\\psi d\\theta d\\phi$. By cyclic permutation of the coordinates $(\\psi, \\theta, \\phi)$, the net fluxes through the other pairs of faces are $\\frac{\\partial}{\\partial \\theta}(\\mathcal{J} A^{\\theta}) d\\psi d\\theta d\\phi$ and $\\frac{\\partial}{\\partial \\phi}(\\mathcal{J} A^{\\phi}) d\\psi d\\theta d\\phi$.\n\nThe total flux is the sum of these three contributions:\n$$\n\\oint \\mathbf{A} \\cdot d\\mathbf{S} = \\left( \\frac{\\partial(\\mathcal{J} A^{\\psi})}{\\partial \\psi} + \\frac{\\partial(\\mathcal{J} A^{\\theta})}{\\partial \\theta} + \\frac{\\partial(\\mathcal{J} A^{\\phi})}{\\partial \\phi} \\right) d\\psi d\\theta d\\phi\n$$\nDividing by the volume $\\Delta V = \\mathcal{J} d\\psi d\\theta d\\phi$, we obtain the expression for the divergence:\n$$\n\\nabla \\cdot \\mathbf{A} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial(\\mathcal{J} A^{\\psi})}{\\partial \\psi} + \\frac{\\partial(\\mathcal{J} A^{\\theta})}{\\partial \\theta} + \\frac{\\partial(\\mathcal{J} A^{\\phi})}{\\partial \\phi} \\right)\n$$\nThis expression explicitly shows how the Jacobian $\\mathcal{J}$ enters the divergence operator for a vector expressed with contravariant components and a covariant basis.\n\n**Part 2: Computation of $\\nabla \\cdot \\mathbf{B}$**\n\nThe magnetic field is given by the Clebsch representation $\\mathbf{B} = \\nabla\\psi \\times \\nabla\\alpha$.\nFirst, we must find the contravariant components ($B^{\\psi}$, $B^{\\theta}$, $B^{\\phi}$) of $\\mathbf{B}$ such that $\\mathbf{B} = B^{\\psi}\\mathbf{e}_{\\psi} + B^{\\theta}\\mathbf{e}_{\\theta} + B^{\\phi}\\mathbf{e}_{\\phi}$. To do this, we express the gradients in the contravariant basis:\n$$\n\\nabla\\psi = \\mathbf{e}^{\\psi}\n$$\n$$\n\\nabla\\alpha = \\frac{\\partial \\alpha}{\\partial \\psi} \\mathbf{e}^{\\psi} + \\frac{\\partial \\alpha}{\\partial \\theta} \\mathbf{e}^{\\theta} + \\frac{\\partial \\alpha}{\\partial \\phi} \\mathbf{e}^{\\phi}\n$$\nNow we compute their cross product:\n$$\n\\mathbf{B} = \\mathbf{e}^{\\psi} \\times \\left( \\frac{\\partial \\alpha}{\\partial \\psi} \\mathbf{e}^{\\psi} + \\frac{\\partial \\alpha}{\\partial \\theta} \\mathbf{e}^{\\theta} + \\frac{\\partial \\alpha}{\\partial \\phi} \\mathbf{e}^{\\phi} \\right)\n$$\nUsing the linearity of the cross product and the fact that $\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\psi} = \\mathbf{0}$:\n$$\n\\mathbf{B} = \\frac{\\partial \\alpha}{\\partial \\theta} (\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\theta}) + \\frac{\\partial \\alpha}{\\partial \\phi} (\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\phi})\n$$\nWe convert this expression from the contravariant basis to the covariant basis using the identity $\\mathbf{e}^{i} \\times \\mathbf{e}^{j} = \\frac{1}{\\mathcal{J}}\\epsilon^{ijk}\\mathbf{e}_{k}$, where $\\epsilon^{ijk}$ is the Levi-Civita symbol. Adopting the ordering $(\\psi, \\theta, \\phi) \\leftrightarrow (1, 2, 3)$:\n$$\n\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\theta} = \\frac{1}{\\mathcal{J}}\\epsilon^{12k}\\mathbf{e}_{k} = \\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\phi}\n$$\n$$\n\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\phi} = \\frac{1}{\\mathcal{J}}\\epsilon^{13k}\\mathbf{e}_{k} = -\\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\theta}\n$$\nSubstituting these back into the expression for $\\mathbf{B}$:\n$$\n\\mathbf{B} = \\frac{\\partial \\alpha}{\\partial \\theta} \\left( \\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\phi} \\right) + \\frac{\\partial \\alpha}{\\partial \\phi} \\left( -\\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\theta} \\right) = 0 \\cdot \\mathbf{e}_{\\psi} - \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\phi} \\mathbf{e}_{\\theta} + \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\theta} \\mathbf{e}_{\\phi}\n$$\nBy comparing this with $\\mathbf{B} = B^{\\psi}\\mathbf{e}_{\\psi} + B^{\\theta}\\mathbf{e}_{\\theta} + B^{\\phi}\\mathbf{e}_{\\phi}$, we identify the contravariant components of $\\mathbf{B}$:\n$$\nB^{\\psi} = 0\n$$\n$$\nB^{\\theta} = -\\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\phi}\n$$\n$$\nB^{\\phi} = \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\theta}\n$$\nNow we substitute these components into the divergence formula derived in Part 1:\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial(\\mathcal{J} B^{\\psi})}{\\partial \\psi} + \\frac{\\partial(\\mathcal{J} B^{\\theta})}{\\partial \\theta} + \\frac{\\partial(\\mathcal{J} B^{\\phi})}{\\partial \\phi} \\right)\n$$\nLet's evaluate the terms inside the parenthesis:\n$$\n\\mathcal{J} B^{\\psi} = \\mathcal{J}(0) = 0\n$$\n$$\n\\mathcal{J} B^{\\theta} = \\mathcal{J} \\left( -\\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\phi} \\right) = -\\frac{\\partial \\alpha}{\\partial \\phi}\n$$\n$$\n\\mathcal{J} B^{\\phi} = \\mathcal{J} \\left( \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\theta} \\right) = \\frac{\\partial \\alpha}{\\partial \\theta}\n$$\nSubstituting these back into the divergence expression:\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial(0)}{\\partial \\psi} + \\frac{\\partial}{\\partial \\theta}\\left(-\\frac{\\partial \\alpha}{\\partial \\phi}\\right) + \\frac{\\partial}{\\partial \\phi}\\left(\\frac{\\partial \\alpha}{\\partial \\theta}\\right) \\right)\n$$\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( 0 - \\frac{\\partial^2 \\alpha}{\\partial \\theta \\partial \\phi} + \\frac{\\partial^2 \\alpha}{\\partial \\phi \\partial \\theta} \\right)\n$$\nThe problem states that $\\alpha$ has continuous second mixed partial derivatives. By Clairaut's theorem (equality of mixed partials), if the second-order partial derivatives are continuous, then their order can be interchanged:\n$$\n\\frac{\\partial^2 \\alpha}{\\partial \\theta \\partial \\phi} = \\frac{\\partial^2 \\alpha}{\\partial \\phi \\partial \\theta}\n$$\nTherefore, the expression in the parenthesis is zero:\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial^2 \\alpha}{\\partial \\phi \\partial \\theta} - \\frac{\\partial^2 \\alpha}{\\partial \\theta \\partial \\phi} \\right) = \\frac{1}{\\mathcal{J}}(0) = 0\n$$\nThis result confirms the solenoidal nature ($\\nabla\\cdot\\mathbf{B}=0$) of a magnetic field expressed in the Clebsch representation, which is a fundamental requirement in MHD. The final value is the real number $0$.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "The core driver for many MHD instabilities is the interaction between the plasma pressure gradient and the magnetic field curvature. This practice challenges you to quantify this drive by constructing an effective ballooning parameter, analogous to the well-known $\\alpha$-parameter in tokamaks. By projecting the complex 3D curvature profile onto its most destabilizing component, you will gain insight into how stellarator shaping directly influences stability and learn a powerful technique for reducing geometric complexity into a physically meaningful metric. ",
            "id": "4049485",
            "problem": "Consider an incompressible interchange/ballooning perturbation in Ideal Magnetohydrodynamics (MHD) on a nested flux surface of a toroidal plasma. Start from the ideal MHD force balance $ \\nabla p = \\mathbf{J} \\times \\mathbf{B} $ and the ideal MHD energy principle, and recall that in the local ballooning representation the pressure-gradient drive enters through the normal curvature $ \\kappa_n(\\vartheta) $ along a straight-field-line angle $ \\vartheta $ on a chosen magnetic field line. In a large-aspect-ratio circular tokamak, the coefficient multiplying the pressure-gradient term in the ballooning equation is customarily summarized by a dimensionless parameter, often denoted by a symbol and understood to scale with the safety factor $ q $ and major radius $ R_0 $.\n\nYou are to construct, from first principles, an analogous, coordinate-invariant “pressure-gradient drive metric” for a stellarator field line by projecting the geometric drive onto the fundamental poloidal harmonic that drives interchange, $ \\cos \\vartheta $, using a least-squares procedure in the straight-field-line coordinate. Specifically, define the stellarator-effective ballooning drive as\n$$\n\\alpha_{\\mathrm{eff}} \\equiv - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\,\n\\frac{\\displaystyle \\int_{0}^{2\\pi} \\kappa_n(\\vartheta) \\cos \\vartheta \\, | \\mathbf{b} \\cdot \\nabla \\vartheta |^{-2} \\, \\mathrm{d}\\vartheta}{\\displaystyle \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, | \\mathbf{b} \\cdot \\nabla \\vartheta |^{-2} \\, \\mathrm{d}\\vartheta},\n$$\nwhere $ \\mathbf{b} \\equiv \\mathbf{B}/|\\mathbf{B}| $, $ \\mu_0 $ is the permeability of free space, $ B_0 $ is a characteristic magnetic field strength on the surface, $ R_0 $ is the major radius scale, and $ \\mathrm{d}p/\\mathrm{d}r $ is the flux-surface radial pressure gradient.\n\nAssume a model stellarator field-line geometry in which:\n- the straight-field-line metric factor is constant along the field line, $ | \\mathbf{b} \\cdot \\nabla \\vartheta | = ( q_{\\mathrm{eff}} R_0 )^{-1} $ with $ q_{\\mathrm{eff}} $ a constant “effective safety factor” on the surface,\n- the normal curvature along this field line is\n$$\n\\kappa_n(\\vartheta) = \\frac{1}{R_0} \\left[ a_1 \\cos \\vartheta + a_N \\cos(N \\vartheta + \\varphi) \\right],\n$$\nwith $ a_1 $ and $ a_N $ dimensionless constants, $ N \\ge 2 $ an integer helicity, and $ \\varphi \\in [0,2\\pi) $ a phase.\n\n1) Starting from the ideal MHD energy principle and the straight-field-line ballooning representation, justify the projection definition of $ \\alpha_{\\mathrm{eff}} $ given above by identifying how the pressure-gradient term couples to $ \\kappa_n(\\vartheta) $ and why the weighting $ | \\mathbf{b} \\cdot \\nabla \\vartheta |^{-2} $ appears.\n\n2) Using the stated model and definition, compute $ \\alpha_{\\mathrm{eff}} $ as a closed-form symbolic expression in terms of $ \\mu_0 $, $ R_0 $, $ B_0 $, $ \\mathrm{d}p/\\mathrm{d}r $, $ q_{\\mathrm{eff}} $, and the geometry parameters $ a_1 $, $ a_N $, $ N $, and $ \\varphi $. Your final result must be a single analytic expression. No numerical evaluation is required. Express the answer as a dimensionless quantity. Do not include units. Round-off is not applicable.",
            "solution": "This problem consists of two parts. The first part requires a justification of the provided definition for the stellarator-effective ballooning drive, $ \\alpha_{\\mathrm{eff}} $, based on first principles of ideal Magnetohydrodynamics (MHD). The second part requires the explicit computation of $ \\alpha_{\\mathrm{eff}} $ for a given model of the stellarator magnetic geometry.\n\n### Part 1: Justification of the Definition of $ \\alpha_{\\mathrm{eff}} $\n\nThe definition of $ \\alpha_{\\mathrm{eff}} $ is given by:\n$$\n\\alpha_{\\mathrm{eff}} \\equiv - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\,\n\\frac{\\displaystyle \\int_{0}^{2\\pi} \\kappa_n(\\vartheta) \\cos \\vartheta \\, | \\mathbf{b} \\cdot \\nabla \\vartheta |^{-2} \\, \\mathrm{d}\\vartheta}{\\displaystyle \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, | \\mathbf{b} \\cdot \\nabla \\vartheta |^{-2} \\, \\mathrm{d}\\vartheta}\n$$\nWe must justify the key components of this formula: the coupling to the normal curvature $ \\kappa_n(\\vartheta) $, the projection onto the $ \\cos \\vartheta $ harmonic, and the appearance of the weighting factor $ | \\mathbf{b} \\cdot \\nabla \\vartheta |^{-2} $.\n\n1.  **Coupling to Normal Curvature $ \\kappa_n(\\vartheta) $**\n    The source of pressure-driven instabilities in ideal MHD is captured by the potential energy principle, represented by the energy functional $ \\delta W $. For an incompressible plasma perturbation characterized by a displacement vector $ \\boldsymbol{\\xi} $ (where $ \\nabla \\cdot \\boldsymbol{\\xi} = 0 $), a key term in $ \\delta W $ that can be negative (destabilizing) is:\n    $$\n    \\delta W_{\\text{drive}} = - \\int_V (\\boldsymbol{\\xi}_{\\perp} \\cdot \\nabla p) ( \\boldsymbol{\\xi}_{\\perp} \\cdot \\boldsymbol{\\kappa}) \\, \\mathrm{d}V\n    $$\n    Here, $ \\boldsymbol{\\xi}_{\\perp} $ is the component of the displacement perpendicular to the magnetic field $ \\mathbf{B} $, $ p $ is the plasma pressure, and $ \\boldsymbol{\\kappa} = (\\mathbf{b} \\cdot \\nabla)\\mathbf{b} $ is the magnetic field curvature vector, with $ \\mathbf{b} = \\mathbf{B}/|\\mathbf{B}| $.\n    In a magnetically confined plasma with nested flux surfaces, the pressure gradient $ \\nabla p = \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\nabla r $ is directed radially outward. Interchange and ballooning modes are dominated by a radial displacement, so $ \\boldsymbol{\\xi}_{\\perp} \\approx \\xi_r \\nabla r $. The curvature vector can be decomposed into normal and geodesic components, $ \\boldsymbol{\\kappa} = \\kappa_n \\mathbf{\\hat{n}} + \\kappa_g \\mathbf{\\hat{g}} $. The normal curvature $ \\kappa_n = \\boldsymbol{\\kappa} \\cdot \\nabla r / |\\nabla r| $ points along the radial direction.\n    Substituting these into the driving term, we find:\n    $$\n    \\delta W_{\\text{drive}} \\approx - \\int_V (\\xi_r |\\nabla r|^2 \\frac{\\mathrm{d}p}{\\mathrm{d}r}) (\\xi_r \\kappa_n) \\, \\mathrm{d}V = - \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\int_V \\kappa_n(\\vartheta) \\xi_r^2 |\\nabla r|^2 \\, \\mathrm{d}V\n    $$\n    Instability ($ \\delta W_{\\text{drive}}  0 $) is favored by a negative pressure gradient ($ \\frac{\\mathrm{d}p}{\\mathrm{d}r}  0 $, which is the standard case for confined plasmas) in regions of positive or \"unfavorable\" normal curvature ($ \\kappa_n  0 $). This analysis establishes the direct coupling of the instability drive to the normal curvature $ \\kappa_n(\\vartheta) $.\n\n2.  **Projection onto $ \\cos \\vartheta $**\n    The ballooning representation analyzes perturbations along a single magnetic field line. The poloidal angle $ \\vartheta $ serves as a coordinate along this line. In a typical toroidal device, the outboard side (largest major radius) corresponds to $ \\vartheta \\approx 0 $. This region has unfavorable curvature ($ \\kappa_n  0 $) and is the primary source of instability. The fundamental harmonic describing a mode that is largest in this unfavorable region and smallest in the favorable region ($ \\vartheta \\approx \\pi $) is $ \\cos \\vartheta $.\n    The full curvature profile $ \\kappa_n(\\vartheta) $ in a complex 3D stellarator field contains many harmonics. The definition of $ \\alpha_{\\mathrm{eff}} $ uses a weighted least-squares projection to isolate the \"effective\" amplitude of the fundamental interchange-driving component of $ \\kappa_n(\\vartheta) $. The ratio of integrals in the definition is precisely the coefficient of the projection of $ \\kappa_n(\\vartheta) $ onto the basis function $ \\cos \\vartheta $ using an inner product with weight $ w(\\vartheta) = | \\mathbf{b} \\cdot \\nabla \\vartheta |^{-2} $.\n\n3.  **Weighting Factor $ | \\mathbf{b} \\cdot \\nabla \\vartheta |^{-2} $**\n    This term is the most subtle and arises from the detailed mathematical structure of the ballooning formalism. The quantity $ |\\mathbf{b} \\cdot \\nabla \\vartheta|^{-1} = \\frac{\\mathrm{d}l}{\\mathrm{d}\\vartheta} $ represents the differential arc length $ \\mathrm{d}l $ along the field line per unit change in the poloidal angle $ \\mathrm{d}\\vartheta $. A small value of $ |\\mathbf{b} \\cdot \\nabla \\vartheta| $ implies that the field line \"lingers\" in that particular range of $ \\vartheta $, thus amplifying the local physical effects.\n    When deriving the one-dimensional ballooning eigenvalue equation, one starts from the three-dimensional $ \\delta W $ and integrates over the flux surface. The stabilizing field-line bending energy and the destabilizing pressure-gradient energy involve geometric factors from the volume element ($ \\mathrm{d}V = J \\mathrm{d}r \\mathrm{d}\\vartheta \\mathrm{d}\\zeta $) and the field-line-following derivative ($ \\mathbf{b} \\cdot \\nabla = |\\mathbf{b} \\cdot \\nabla \\vartheta| \\frac{\\mathrm{d}}{\\mathrm{d}\\vartheta} $). The competition between the stabilizing bending term, which scales as $ \\sim \\int (dY/d\\vartheta)^2 |\\mathbf{b} \\cdot \\nabla \\vartheta| d\\vartheta $, and the driving pressure term, which scales as $ \\sim \\int Y^2 \\kappa_n / |\\mathbf{b} \\cdot \\nabla \\vartheta| d\\vartheta $, must be analyzed. The specific weight $ | \\mathbf{b} \\cdot \\nabla \\vartheta |^{-2} $ in the definition of an effective drive metric arises in certain advanced formulations of the theory that use variable transformations to simplify one part of the energy functional (e.g., the kinetic energy term in the Lagrangian), which then results in this weighting factor appearing in the potential energy terms. It is a sophisticated way to account for both the residence time of the field line and the inertia of the plasma element in a coordinate-invariant manner.\n\n### Part 2: Calculation of $ \\alpha_{\\mathrm{eff}} $\n\nWe are tasked with computing $ \\alpha_{\\mathrm{eff}} $ using the provided model assumptions:\n- The straight-field-line metric factor is constant: $ | \\mathbf{b} \\cdot \\nabla \\vartheta | = ( q_{\\mathrm{eff}} R_0 )^{-1} $.\n- The normal curvature is: $ \\kappa_n(\\vartheta) = \\frac{1}{R_0} \\left[ a_1 \\cos \\vartheta + a_N \\cos(N \\vartheta + \\varphi) \\right] $.\n\nWe substitute these into the definition of $ \\alpha_{\\mathrm{eff}} $. The weighting factor is $ | \\mathbf{b} \\cdot \\nabla \\vartheta |^{-2} = (q_{\\mathrm{eff}} R_0)^{2} $. Since this is a constant, it can be factored out of both integrals and will cancel:\n$$\n\\alpha_{\\mathrm{eff}} = - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\,\n\\frac{\\displaystyle \\int_{0}^{2\\pi} \\kappa_n(\\vartheta) \\cos \\vartheta \\, (q_{\\mathrm{eff}} R_0)^2 \\, \\mathrm{d}\\vartheta}{\\displaystyle \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, (q_{\\mathrm{eff}} R_0)^2 \\, \\mathrm{d}\\vartheta}\n= - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\,\n\\frac{\\displaystyle \\int_{0}^{2\\pi} \\kappa_n(\\vartheta) \\cos \\vartheta \\, \\mathrm{d}\\vartheta}{\\displaystyle \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, \\mathrm{d}\\vartheta}\n$$\nLet's evaluate the numerator and denominator integrals separately.\n\n**Denominator Integral:**\n$$\nI_{\\mathrm{den}} = \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, \\mathrm{d}\\vartheta\n$$\nUsing the half-angle identity $ \\cos^2 \\vartheta = \\frac{1}{2}(1 + \\cos(2\\vartheta)) $:\n$$\nI_{\\mathrm{den}} = \\int_{0}^{2\\pi} \\frac{1}{2}(1 + \\cos(2\\vartheta)) \\, \\mathrm{d}\\vartheta = \\frac{1}{2} \\left[ \\vartheta + \\frac{1}{2}\\sin(2\\vartheta) \\right]_0^{2\\pi} = \\frac{1}{2} ((2\\pi + 0) - (0+0)) = \\pi\n$$\n\n**Numerator Integral:**\n$$\nI_{\\mathrm{num}} = \\int_{0}^{2\\pi} \\kappa_n(\\vartheta) \\cos \\vartheta \\, \\mathrm{d}\\vartheta\n$$\nSubstitute the expression for $ \\kappa_n(\\vartheta) $:\n$$\nI_{\\mathrm{num}} = \\int_{0}^{2\\pi} \\frac{1}{R_0} \\left[ a_1 \\cos \\vartheta + a_N \\cos(N \\vartheta + \\varphi) \\right] \\cos \\vartheta \\, \\mathrm{d}\\vartheta\n$$\n$$\nI_{\\mathrm{num}} = \\frac{1}{R_0} \\left[ a_1 \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, \\mathrm{d}\\vartheta + a_N \\int_{0}^{2\\pi} \\cos(N \\vartheta + \\varphi) \\cos \\vartheta \\, \\mathrm{d}\\vartheta \\right]\n$$\nThe first term contains the integral we just calculated: $ \\int_{0}^{2\\pi} \\cos^2 \\vartheta \\, \\mathrm{d}\\vartheta = \\pi $.\nFor the second term, we rely on the orthogonality of trigonometric functions. The integral $ \\int_{0}^{2\\pi} \\cos(A) \\cos(B) \\, \\mathrm{d}\\vartheta $ is non-zero only if $ |A|=|B| $. Here, we are integrating $ \\cos(N \\vartheta + \\varphi) $ against $ \\cos \\vartheta $. Since the problem states $ N $ is an integer and $ N \\ge 2 $, we have $ N \\ne 1 $. Therefore, due to orthogonality over the interval $ [0, 2\\pi] $, the integral is zero.\n$$\n\\int_{0}^{2\\pi} \\cos(N \\vartheta + \\varphi) \\cos \\vartheta \\, \\mathrm{d}\\vartheta = 0 \\quad \\text{for } N \\ge 2\n$$\nThus, the numerator integral evaluates to:\n$$\nI_{\\mathrm{num}} = \\frac{1}{R_0} [ a_1 (\\pi) + a_N (0) ] = \\frac{a_1 \\pi}{R_0}\n$$\n\n**Final Assembly:**\nNow we substitute the values of the integrals back into the expression for $ \\alpha_{\\mathrm{eff}} $:\n$$\n\\alpha_{\\mathrm{eff}} = - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\, \\frac{I_{\\mathrm{num}}}{I_{\\mathrm{den}}} = - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\, R_0^2 \\, \\frac{a_1 \\pi / R_0}{\\pi}\n$$\nSimplifying the expression, the factors of $ \\pi $ cancel, and one factor of $ R_0 $ cancels:\n$$\n\\alpha_{\\mathrm{eff}} = - \\frac{\\mu_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r} R_0^2 \\frac{a_1}{R_0} = - a_1 \\frac{\\mu_0 R_0}{B_0^2} \\frac{\\mathrm{d}p}{\\mathrm{d}r}\n$$\nThis is the final closed-form symbolic expression for $ \\alpha_{\\mathrm{eff}} $. Note that it is independent of $ q_{\\mathrm{eff}} $, $ a_N $, $ N $, and $ \\varphi $ due to the constant weight assumption and trigonometric orthogonality, respectively.",
            "answer": "$$\\boxed{-a_{1} \\frac{\\mu_{0} R_{0}}{B_{0}^{2}} \\frac{\\mathrm{d}p}{\\mathrm{d}r}}$$"
        },
        {
            "introduction": "A defining feature of stellarators is that local stability on every flux surface does not guarantee global stability of the entire plasma. This exercise uses a simplified but powerful matrix model of the ideal MHD energy principle, $\\delta W$, to demonstrate this crucial concept. By calculating the eigenvalues of a system where all local stability metrics are positive ($D_{\\mathrm{M},i} \\gt 0$) but strong off-diagonal couplings exist, you will see firsthand how mode coupling can create a global instability ($\\lambda_{\\min} \\lt 0$) where local analysis would predict stability. ",
            "id": "4049501",
            "problem": "Consider the distinction between local Mercier stability and global interchange stability in three-dimensional toroidal configurations such as stellarators. In ideal Magnetohydrodynamics (MHD), the energy principle states that a plasma equilibrium is linearly stable if the second variation of the potential energy, denoted by $\\delta W$, is positive for all admissible perturbations. The local Mercier stability criterion assesses the sign of a local parameter $D_{\\mathrm{M}}$ constructed from equilibrium geometric quantities including pressure gradient, magnetic curvature, and magnetic shear on a given magnetic surface; $D_{\\mathrm{M}}  0$ indicates local interchange stability in the ballooning limit. Global interchange stability, by contrast, requires that the quadratic form associated with $\\delta W$ is positive-definite when global coupling across the configuration is taken into account, which includes couplings between neighboring Fourier components, field-periods, or flux-tube segments. These couplings can destabilize global modes even when local Mercier criteria are satisfied at every location.\n\nStarting from the ideal MHD energy principle, model the global stability problem by a finite-dimensional, real, symmetric matrix $\\mathbf{A}$ representing the discretized quadratic form of $\\delta W$. The diagonal entries of $\\mathbf{A}$ are local Mercier parameters $D_{\\mathrm{M},i}$ at positions $i$, and the off-diagonal entries $C_{ij}$ represent conservative energy couplings between locations $i$ and $j$ due to magnetic field non-axisymmetry, geometric coupling, or mode interaction. In this toy model, global interchange stability is equivalent to all eigenvalues of $\\mathbf{A}$ being strictly positive, while local Mercier stability corresponds to $D_{\\mathrm{M},i}  0$ for each diagonal element. A global instability exists if and only if the minimum eigenvalue of $\\mathbf{A}$ is negative.\n\nYour task is to:\n- Derive an algorithm, grounded in the ideal MHD energy principle, to decide global interchange stability from $\\mathbf{A}$.\n- Implement a program that, for a provided test suite of $\\mathbf{A}$ matrices, computes the minimum eigenvalue $\\lambda_{\\min}$ of each matrix. Interpret $\\lambda_{\\min}  0$ as globally stable, $\\lambda_{\\min} = 0$ as marginal, and $\\lambda_{\\min}  0$ as globally unstable.\n- Construct and include at least one test case where all local $D_{\\mathrm{M},i}  0$, yet a global mode is unstable due to sufficiently strong coupling $C_{ij}$.\n\nAll quantities are dimensionless in this problem. Angles are not used. The algorithm must start from the ideal MHD energy principle’s statement that stability requires $\\delta W  0$ for all perturbations and proceed by discretization to the symmetric matrix $\\mathbf{A}$ whose eigenvalues dictate stability.\n\nUse the following test suite of matrices:\n1. Case 1 (happy path, locally and globally stable): $2 \\times 2$ matrix with $D_{\\mathrm{M}} = [1.0, 1.0]$ and coupling $C_{01} = 0.3$.\n2. Case 2 (boundary condition, marginal global stability): $2 \\times 2$ matrix with $D_{\\mathrm{M}} = [1.0, 1.0]$ and coupling $C_{01} = 1.0$.\n3. Case 3 (requested phenomenon, locally stable but globally unstable): $2 \\times 2$ matrix with $D_{\\mathrm{M}} = [1.0, 1.0]$ and coupling $C_{01} = 2.0$.\n4. Case 4 (edge case, local Mercier violation): $3 \\times 3$ matrix with $D_{\\mathrm{M}} = [1.0, -0.2, 0.8]$ and couplings $C_{01} = 0.1$ and $C_{12} = 0.1$.\n\nFor each case, construct $\\mathbf{A}$ as follows: set $\\mathbf{A}_{ii} = D_{\\mathrm{M},i}$ and for each specified coupling set $\\mathbf{A}_{ij} = \\mathbf{A}_{ji} = C_{ij}$, with all other off-diagonal entries zero. Compute the minimum eigenvalue $\\lambda_{\\min}$ of $\\mathbf{A}$ for each case and report it.\n\nFinal output specification:\n- Produce a single line of output containing the results for all four test cases as a comma-separated list of floats enclosed in square brackets, with each float rounded to six decimal places (e.g., $\\left[0.123456,-0.000001,0.000000,2.000000\\right]$).",
            "solution": "The problem requires the derivation of an algorithm to assess the global interchange stability of a plasma configuration based on a discretized model of the ideal Magnetohydrodynamic (MHD) energy principle, and its subsequent implementation. The analysis begins with a validation of the problem statement.\n\n### Step 1: Extract Givens\n- **Principle**: The plasma equilibrium is linearly stable if the second variation of the potential energy, $\\delta W$, is positive for all admissible perturbations. $\\delta W  0$.\n- **Model**: The global stability problem is modeled by a finite-dimensional, real, symmetric matrix $\\mathbf{A}$ representing the discretized quadratic form of $\\delta W$.\n- **Matrix Construction**: The diagonal entries are local Mercier parameters, $\\mathbf{A}_{ii} = D_{\\mathrm{M},i}$. The off-diagonal entries are couplings, $\\mathbf{A}_{ij} = C_{ij}$ for $i \\neq j$. The matrix $\\mathbf{A}$ is symmetric, so $\\mathbf{A}_{ij} = \\mathbf{A}_{ji}$.\n- **Local Stability**: Local Mercier stability at position $i$ corresponds to $D_{\\mathrm{M},i}  0$.\n- **Global Stability**: Global interchange stability is equivalent to all eigenvalues of $\\mathbf{A}$ being strictly positive.\n- **Global Instability**: A global instability exists if and only if the minimum eigenvalue of $\\mathbf{A}$, denoted $\\lambda_{\\min}$, is negative. Marginal stability corresponds to $\\lambda_{\\min} = 0$.\n- **Task**: Derive an algorithm from the energy principle to decide global stability via $\\mathbf{A}$ and implement it.\n- **Test Cases**:\n    1.  $2 \\times 2$ matrix: $D_{\\mathrm{M}} = [1.0, 1.0]$, $C_{01} = 0.3$.\n    2.  $2 \\times 2$ matrix: $D_{\\mathrm{M}} = [1.0, 1.0]$, $C_{01} = 1.0$.\n    3.  $2 \\times 2$ matrix: $D_{\\mathrm{M}} = [1.0, 1.0]$, $C_{01} = 2.0$.\n    4.  $3 \\times 3$ matrix: $D_{\\mathrm{M}} = [1.0, -0.2, 0.8]$, couplings $C_{01} = 0.1, C_{12} = 0.1$.\n- **Output**: A single-line comma-separated list of the minimum eigenvalues for the four cases, rounded to six decimal places, enclosed in square brackets.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is evaluated against the established criteria.\n- **Scientifically Grounded**: The problem is well-grounded in ideal MHD stability theory. The energy principle, $\\delta W  0$, is the foundation of linear MHD stability analysis. The discretization of the $\\delta W$ operator into a matrix is a standard and valid technique in computational plasma physics for analyzing global modes. The distinction between local stability criteria (like Mercier's) and global stability is a central theme in the study of complex three-dimensional magnetic configurations like stellarators. The model, though simplified, correctly captures the essential physics of local stability (diagonal terms) and global coupling effects (off-diagonal terms).\n- **Well-Posed**: The problem is well-posed. For any given real symmetric matrix $\\mathbf{A}$, its eigenvalues are real and uniquely determined. The task of finding the minimum eigenvalue, $\\lambda_{\\min}$, is a standard, well-defined problem in linear algebra. The stability criterion, $\\lambda_{\\min}  0$, is unambiguous.\n- **Objective**: The problem is stated using precise, objective, and formal scientific language. All terms are clearly defined.\n\nThe problem exhibits none of the specified flaws. It is scientifically sound, well-posed, complete, and formalizable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A reasoned solution follows.\n\nThe fundamental tenet of ideal MHD linear stability is the energy principle. A magnetically confined plasma equilibrium is stable if and only if the change in potential energy, $\\delta W$, associated with any physically admissible infinitesimal displacement of the plasma, $\\vec{\\xi}(\\vec{r})$, is positive. Mathematically, this is expressed as:\n$$ \\delta W[\\vec{\\xi}, \\vec{\\xi}]  0 $$\nfor all non-trivial displacement fields $\\vec{\\xi}$. The term $\\delta W$ is a quadratic functional of $\\vec{\\xi}$, meaning it depends quadratically on the displacement field and its spatial derivatives.\n\nTo transform this principle into a computationally tractable problem, the infinite-dimensional space of all possible displacement fields $\\vec{\\xi}(\\vec{r})$ is projected onto a finite-dimensional subspace. This is achieved by representing $\\vec{\\xi}(\\vec{r})$ as a linear combination of a finite set of $N$ basis functions, $\\{\\vec{f}_i(\\vec{r})\\}_{i=1}^N$:\n$$ \\vec{\\xi}(\\vec{r}) = \\sum_{i=1}^{N} x_i \\vec{f}_i(\\vec{r}) $$\nHere, $x_i$ are the scalar amplitudes of the basis functions. By substituting this expansion into the energy functional and exploiting its bilinear properties, we obtain a quadratic form in the unknown amplitudes $x_i$:\n$$ \\delta W = \\sum_{i=1}^{N} \\sum_{j=1}^{N} x_i x_j \\delta W[\\vec{f}_i, \\vec{f}_j] $$\nThis expression can be written in matrix form as:\n$$ \\delta W = \\mathbf{x}^T \\mathbf{A} \\mathbf{x} $$\nwhere $\\mathbf{x}$ is the column vector of amplitudes $[x_1, x_2, \\dots, x_N]^T$, and $\\mathbf{A}$ is an $N \\times N$ matrix whose elements are given by the energy integrals of pairs of basis functions:\n$$ A_{ij} = \\delta W[\\vec{f}_i, \\vec{f}_j] $$\nThe $\\delta W$ functional operator in ideal MHD is self-adjoint, which implies that the resulting matrix $\\mathbf{A}$ is real and symmetric, i.e., $A_{ij} = A_{ji}$.\n\nThe problem statement provides such a matrix $\\mathbf{A}$. The diagonal elements, $\\mathbf{A}_{ii} = D_{\\mathrm{M},i}$, are identified with local stability criteria, representing the energy cost of a localized perturbation $x_i \\vec{f}_i$. The off-diagonal elements, $\\mathbf{A}_{ij} = C_{ij}$ for $i \\neq j$, represent the energetic coupling between different basis functions (modes), which is a key feature of global stability in non-axisymmetric systems.\n\nThe stability condition $\\delta W  0$ for all non-trivial perturbations $\\vec{\\xi}$ translates to the condition that the quadratic form $\\mathbf{x}^T \\mathbf{A} \\mathbf{x}  0$ for all non-zero vectors $\\mathbf{x} \\in \\mathbb{R}^N$. This is precisely the definition of a positive-definite matrix.\n\nA fundamental theorem of linear algebra states that a real symmetric matrix is positive-definite if and only if all of its eigenvalues are strictly positive. Therefore, the stability of the system described by the matrix $\\mathbf{A}$ can be determined by examining its spectrum of eigenvalues. If we denote the eigenvalues of $\\mathbf{A}$ by $\\lambda_1, \\lambda_2, \\dots, \\lambda_N$, the system is:\n- **Globally Stable** if the minimum eigenvalue, $\\lambda_{\\min} = \\min(\\{\\lambda_k\\})$, is positive ($\\lambda_{\\min}  0$).\n- **Marginally Stable** if the minimum eigenvalue is zero ($\\lambda_{\\min} = 0$).\n- **Globally Unstable** if the minimum eigenvalue is negative ($\\lambda_{\\min}  0$).\n\nThe eigenvalues of the matrix $\\mathbf{A}$ represent the potential energy associated with the corresponding eigenvectors (the global eigenmodes of the system). A negative eigenvalue indicates the existence of a global mode that lowers the system's potential energy, leading to an instability.\n\nThe derived algorithm is therefore as follows:\n1.  Construct the real, symmetric matrix $\\mathbf{A}$ from the provided local stability parameters $D_{\\mathrm{M},i}$ and coupling coefficients $C_{ij}$.\n2.  Compute the eigenvalues of the matrix $\\mathbf{A}$. Since $\\mathbf{A}$ is real and symmetric, all its eigenvalues are real. Standard numerical linear algebra routines are well-suited for this task.\n3.  Find the minimum value among the computed eigenvalues, $\\lambda_{\\min}$.\n4.  Assess stability based on the sign of $\\lambda_{\\min}$.\n\nThis algorithm will be implemented to solve for the provided test cases. Case 3 is of particular physical interest, as it is designed to show that even if all local stability criteria are met ($D_{\\mathrm{M},i}  0$ for all $i$), strong coupling ($C_{ij}$) can drive a global mode unstable, resulting in $\\lambda_{\\min}  0$. This demonstrates that local stability analysis is insufficient for determining the stability of the entire system. Case 4 demonstrates a more straightforward situation where a local Mercier violation ($D_{\\mathrm{M},1} = -0.2  0$) is present, which is a strong indicator of instability, often leading directly to a negative eigenvalue.",
            "answer": "$$\n\\boxed{[0.700000,0.000000,-1.000000,-0.224695]}\n$$"
        }
    ]
}