{
    "hands_on_practices": [
        {
            "introduction": "在深入研究仿星器中复杂的磁流体动力学（MHD）不稳定性之前，我们必须首先掌握描述其三维几何的数学语言。本练习将引导您从第一性原理出发，在通用的非正交磁通坐标系中构建梯度和散度等基本微分算子。通过亲手推导并验证最基本的MHD约束条件 $\\nabla\\cdot\\mathbf{B}=0$ ，您将深入理解雅可比行列式 $(\\mathcal{J})$ 的几何意义，并熟练运用协变与逆变基矢量，为分析复杂的等离子体物理打下坚实的数学基础。",
            "id": "4049390",
            "problem": "考虑一个在三维磁通坐标 $(\\psi,\\theta,\\phi)$ 中描述的仿星器平衡，其中 $\\psi$ 是一个环向磁通标签，$\\theta$ 是一个角向角，$\\phi$ 是一个环向角。设位置矢量为 $\\mathbf{r}(\\psi,\\theta,\\phi)$，并定义协变基矢 $\\mathbf{e}_{i}=\\partial\\mathbf{r}/\\partial u^{i}$ 和逆变基矢 $\\mathbf{e}^{i}=\\nabla u^{i}$，其中 $(u^{1},u^{2},u^{3})\\equiv(\\psi,\\theta,\\phi)$。该坐标系对于仿星器是通用的，并且不假定其为正交坐标系。雅可比定义为\n$$\n\\mathcal{J}=\\left(\\nabla\\psi\\cdot\\nabla\\theta\\times\\nabla\\phi\\right)^{-1}.\n$$\n在这些坐标中对磁流体动力学 (MHD) 进行建模，其假设是存在嵌套磁面，并且磁场 $\\mathbf{B}$ 与 $\\psi=\\text{常数}$ 的曲面相切。从曲线坐标中的矢量微积分的第一性原理以及上述雅可比的定义出发，完成以下任务：\n\n1. 推导雅可比 $\\mathcal{J}$ 如何出现在标量 $f(\\psi,\\theta,\\phi)$ 的梯度和以逆变形式 $\\mathbf{A}=A^{i}\\mathbf{e}_{i}$ 书写的矢量场 $\\mathbf{A}(\\psi,\\theta,\\phi)$ 的散度的坐标表达式中。您的推导必须从多变量微积分的链式法则、$\\mathbf{e}_{i}$ 和 $\\mathbf{e}^{i}$ 的几何定义，以及由通过无穷小坐标单元的通量除以其体积的极限所定义的散度出发。不要假定正交性。\n\n2. 使用您得到的散度算子，考虑一个与磁面一致的磁场的 Clebsch 型表示\n$$\n\\mathbf{B}=\\nabla\\psi\\times\\nabla\\alpha(\\psi,\\theta,\\phi),\n$$\n其中 $\\alpha$ 是一个光滑标量场，在固定的 $\\psi$ 下，其在 $(\\theta,\\phi)$ 上的二阶混合偏导数连续。在 $(\\psi,\\theta,\\phi)$ 坐标系中显式计算 $\\nabla\\cdot\\mathbf{B}$，并展示所有使用 $\\mathcal{J}$ 和基矢恒等式的步骤。\n\n将 $\\nabla\\cdot\\mathbf{B}$ 的最终值表示为一个无单位的实数。无需四舍五入。",
            "solution": "所述问题需要经过验证。\n\n### 步骤 1：提取已知条件\n-   坐标系：三维磁通坐标 $(\\psi, \\theta, \\phi)$，及其对应的位置矢量 $\\mathbf{r}(\\psi, \\theta, \\phi)$。\n-   坐标变量：$u^1 \\equiv \\psi$ (环向磁通标签)，$u^2 \\equiv \\theta$ (角向角)，$u^3 \\equiv \\phi$ (环向角)。\n-   基矢：协变基矢 $\\mathbf{e}_{i} = \\frac{\\partial\\mathbf{r}}{\\partial u^{i}}$ 和逆变基矢 $\\mathbf{e}^{i} = \\nabla u^{i}$。\n-   坐标系性质：不假定为正交。\n-   雅可比定义：$\\mathcal{J} = (\\nabla\\psi \\cdot \\nabla\\theta \\times \\nabla\\phi)^{-1}$。\n-   MHD 建模假设：存在嵌套磁面，并且磁场 $\\mathbf{B}$ 与 $\\psi$ 为常数的曲面相切。\n-   任务 1：推导标量 $f(\\psi, \\theta, \\phi)$ 的梯度和矢量场 $\\mathbf{A}(\\psi, \\theta, \\phi) = A^{i}\\mathbf{e}_{i}$ 的散度的坐标表达式，并展示雅可比 $\\mathcal{J}$ 如何出现。推导必须从第一性原理（链式法则、基矢的几何定义以及散度的极限定义）出发。\n-   任务 2：考虑 Clebsch 表示下的磁场 $\\mathbf{B} = \\nabla\\psi \\times \\nabla\\alpha(\\psi, \\theta, \\phi)$。\n-   $\\alpha$ 的性质：$\\alpha$ 是一个光滑标量场，在固定的 $\\psi$ 下，其在 $(\\theta, \\phi)$ 上的二阶混合偏导数连续。\n-   任务 3：在 $(\\psi, \\theta, \\phi)$ 坐标系中显式计算 $\\nabla \\cdot \\mathbf{B}$，并展示所有步骤。\n-   最终答案格式：一个无单位的实数。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学基础：** 该问题设置在用于磁约束等离子体的成熟的磁流体动力学 (MHD) 框架内，特别使用了仿星器理论中常见的磁通坐标。曲线坐标、协变和逆变基矢、雅可比以及磁场的 Clebsch 表示等概念在该领域是标准和基础的。恒等式 $\\nabla \\cdot \\mathbf{B} = 0$ 是麦克斯韦方程组和 MHD 的基石。该问题要求在特定的坐标表示下推导和验证这一事实。这在科学上是合理的。\n-   **适定性：** 该问题结构清晰，分为两部分。第一部分要求推导曲线坐标中的基本微分算子。起始点和所需方法都已指明。第二部分是将第一部分的结果直接应用于一个特定的、良定义的矢量场。提供了关于 $\\alpha$ 光滑性的条件，这是完成计算最后一步所必需的。存在唯一且有意义的解。\n-   **客观性：** 该问题以精确的数学语言陈述，没有歧义、主观性或观点。所有术语在矢量微积分和理论物理中都是标准的。\n\n### 步骤 3：结论和行动\n该问题是有效的。这是理论等离子体物理学中一个标准的、严谨的练习，旨在检验对一般曲线坐标下矢量微积分的理解。现在将提供解答。\n\n### 解答\n\n按照题目要求，解答分为两部分。\n\n**第一部分：梯度和散度算子的推导**\n\n**标量场 $f(\\psi, \\theta, \\phi)$ 的梯度**\n\n设 $f(\\psi, \\theta, \\phi)$ 为一个标量场。根据链式法则，其全微分 $df$ 由下式给出：\n$$\ndf = \\frac{\\partial f}{\\partial \\psi} d\\psi + \\frac{\\partial f}{\\partial \\theta} d\\theta + \\frac{\\partial f}{\\partial \\phi} d\\phi\n$$\n$f$ 的梯度，记为 $\\nabla f$，其定义满足 $df = \\nabla f \\cdot d\\mathbf{r}$，其中 $d\\mathbf{r}$ 是微分位移矢量。在我们的坐标系中，$d\\mathbf{r}$ 可以用协变基矢 $\\mathbf{e}_i = \\frac{\\partial\\mathbf{r}}{\\partial u^i}$ 表示：\n$$\nd\\mathbf{r} = \\frac{\\partial \\mathbf{r}}{\\partial \\psi} d\\psi + \\frac{\\partial \\mathbf{r}}{\\partial \\theta} d\\theta + \\frac{\\partial \\mathbf{r}}{\\partial \\phi} d\\phi = \\mathbf{e}_{\\psi} d\\psi + \\mathbf{e}_{\\theta} d\\theta + \\mathbf{e}_{\\phi} d\\phi\n$$\n我们将梯度矢量 $\\nabla f$ 在逆变基底 $\\mathbf{e}^i = \\nabla u^i$ 中表示：\n$$\n\\nabla f = (\\nabla f)_{\\psi} \\mathbf{e}^{\\psi} + (\\nabla f)_{\\theta} \\mathbf{e}^{\\theta} + (\\nabla f)_{\\phi} \\mathbf{e}^{\\phi}\n$$\n然后使用对偶基的基本性质 $\\mathbf{e}^{i} \\cdot \\mathbf{e}_{j} = \\delta^{i}_{j}$（克罗内克 δ）计算点积 $\\nabla f \\cdot d\\mathbf{r}$：\n$$\n\\nabla f \\cdot d\\mathbf{r} = ((\\nabla f)_{\\psi} \\mathbf{e}^{\\psi} + \\dots) \\cdot (\\mathbf{e}_{\\psi} d\\psi + \\dots) = (\\nabla f)_{\\psi} d\\psi + (\\nabla f)_{\\theta} d\\theta + (\\nabla f)_{\\phi} d\\phi\n$$\n将此与 $df$ 的链式法则表达式进行比较，我们确定梯度的分量：\n$$\n(\\nabla f)_{\\psi} = \\frac{\\partial f}{\\partial \\psi}, \\quad (\\nabla f)_{\\theta} = \\frac{\\partial f}{\\partial \\theta}, \\quad (\\nabla f)_{\\phi} = \\frac{\\partial f}{\\partial \\phi}\n$$\n因此，梯度的表达式为：\n$$\n\\nabla f = \\frac{\\partial f}{\\partial \\psi} \\mathbf{e}^{\\psi} + \\frac{\\partial f}{\\partial \\theta} \\mathbf{e}^{\\theta} + \\frac{\\partial f}{\\partial \\phi} \\mathbf{e}^{\\phi} = \\sum_{i} \\frac{\\partial f}{\\partial u^i} \\mathbf{e}^{i}\n$$\n雅可比 $\\mathcal{J}$ 通过逆变基矢和协变基矢之间的关系进入此表达式。根据定义，$\\mathcal{J}^{-1} = \\mathbf{e}^{\\psi} \\cdot (\\mathbf{e}^{\\theta} \\times \\mathbf{e}^{\\phi})$。曲线坐标中的一个标准恒等式将逆变基矢与协变基矢的叉积联系起来：\n$$\n\\mathbf{e}^{\\psi} = \\frac{\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}}{\\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})} = \\frac{1}{\\mathcal{J}}(\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})\n$$\n通过轮换，我们也有：\n$$\n\\mathbf{e}^{\\theta} = \\frac{1}{\\mathcal{J}}(\\mathbf{e}_{\\phi} \\times \\mathbf{e}_{\\psi}), \\quad \\mathbf{e}^{\\phi} = \\frac{1}{\\mathcal{J}}(\\mathbf{e}_{\\psi} \\times \\mathbf{e}_{\\theta})\n$$\n将这些代入 $\\nabla f$ 的表达式中，可以显式地显示出雅可比的作用：\n$$\n\\nabla f = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial f}{\\partial \\psi} (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) + \\frac{\\partial f}{\\partial \\theta} (\\mathbf{e}_{\\phi} \\times \\mathbf{e}_{\\psi}) + \\frac{\\partial f}{\\partial \\phi} (\\mathbf{e}_{\\psi} \\times \\mathbf{e}_{\\theta}) \\right)\n$$\n\n**矢量场 $\\mathbf{A} = A^i\\mathbf{e}_i$ 的散度**\n\n散度由无穷小体积元极限下的单位体积通量定义：\n$$\n\\nabla \\cdot \\mathbf{A} = \\lim_{\\Delta V \\to 0} \\frac{1}{\\Delta V} \\oint_{\\partial(\\Delta V)} \\mathbf{A} \\cdot d\\mathbf{S}\n$$\n我们考虑一个由矢量 $\\mathbf{e}_{\\psi}d\\psi$、$\\mathbf{e}_{\\theta}d\\theta$ 和 $\\mathbf{e}_{\\phi}d\\phi$ 构成的无穷小平​​行六面体。其体积为 $\\Delta V = |\\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})| d\\psi d\\theta d\\phi = \\mathcal{J} d\\psi d\\theta d\\phi$，因为对于右手坐标系，$\\mathcal{J} = \\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})  0$。\n\n流出该体积的总通量是穿过其六个面的通量之和。我们来计算通过常数 $\\psi$ 和 $\\psi+d\\psi$ 处的一对面元的净通量。在 $\\psi+d\\psi$ 面上，向外指的面元矢量是 $d\\mathbf{S}_{\\psi} = \\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi} d\\theta d\\phi$。穿过该面的通量是 $\\mathbf{A}(\\psi+d\\psi, \\theta, \\phi) \\cdot d\\mathbf{S}_{\\psi}$。\n穿过 $\\psi$ 处的面的通量具有方向相反的面矢量，因此净通量为：\n$$\n\\Delta\\Phi_{\\psi} = \\left[ \\mathbf{A}(\\psi+d\\psi) \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) d\\theta d\\phi \\right] - \\left[ \\mathbf{A}(\\psi) \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) d\\theta d\\phi \\right]\n$$\n（基矢也是坐标的函数，但在这种表述中我们可以使用乘积法则。）这可以写成：\n$$\n\\Delta\\Phi_{\\psi} = \\frac{\\partial}{\\partial \\psi} \\left( \\mathbf{A} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) \\right) d\\psi d\\theta d\\phi\n$$\n我们来计算点积。给定 $\\mathbf{A} = A^{\\psi}\\mathbf{e}_{\\psi} + A^{\\theta}\\mathbf{e}_{\\theta} + A^{\\phi}\\mathbf{e}_{\\phi}$。\n$$\n\\mathbf{A} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) = (A^{\\psi}\\mathbf{e}_{\\psi} + A^{\\theta}\\mathbf{e}_{\\theta} + A^{\\phi}\\mathbf{e}_{\\phi}) \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi}) = A^{\\psi} (\\mathbf{e}_{\\psi} \\cdot (\\mathbf{e}_{\\theta} \\times \\mathbf{e}_{\\phi})) = A^{\\psi} \\mathcal{J}\n$$\n因此，通过 $\\psi$-面的净通量为 $\\frac{\\partial}{\\partial \\psi}(\\mathcal{J} A^{\\psi}) d\\psi d\\theta d\\phi$。通过对坐标 $(\\psi, \\theta, \\phi)$ 进行轮换，通过其他对面元的净通量分别为 $\\frac{\\partial}{\\partial \\theta}(\\mathcal{J} A^{\\theta}) d\\psi d\\theta d\\phi$ 和 $\\frac{\\partial}{\\partial \\phi}(\\mathcal{J} A^{\\phi}) d\\psi d\\theta d\\phi$。\n\n总通量是这三项贡献之和：\n$$\n\\oint \\mathbf{A} \\cdot d\\mathbf{S} = \\left( \\frac{\\partial(\\mathcal{J} A^{\\psi})}{\\partial \\psi} + \\frac{\\partial(\\mathcal{J} A^{\\theta})}{\\partial \\theta} + \\frac{\\partial(\\mathcal{J} A^{\\phi})}{\\partial \\phi} \\right) d\\psi d\\theta d\\phi\n$$\n除以体积 $\\Delta V = \\mathcal{J} d\\psi d\\theta d\\phi$，我们得到散度的表达式：\n$$\n\\nabla \\cdot \\mathbf{A} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial(\\mathcal{J} A^{\\psi})}{\\partial \\psi} + \\frac{\\partial(\\mathcal{J} A^{\\theta})}{\\partial \\theta} + \\frac{\\partial(\\mathcal{J} A^{\\phi})}{\\partial \\phi} \\right)\n$$\n该表达式明确显示了对于用逆变分量和协变基底表示的矢量，雅可比 $\\mathcal{J}$ 如何进入散度算子。\n\n**第二部分：$\\nabla \\cdot \\mathbf{B}$ 的计算**\n\n磁场由 Clebsch 表示给出 $\\mathbf{B} = \\nabla\\psi \\times \\nabla\\alpha$。\n首先，我们必须找到 $\\mathbf{B}$ 的逆变分量（$B^{\\psi}$、$B^{\\theta}$、$B^{\\phi}$），使得 $\\mathbf{B} = B^{\\psi}\\mathbf{e}_{\\psi} + B^{\\theta}\\mathbf{e}_{\\theta} + B^{\\phi}\\mathbf{e}_{\\phi}$。为此，我们在逆变基底中表示梯度：\n$$\n\\nabla\\psi = \\mathbf{e}^{\\psi}\n$$\n$$\n\\nabla\\alpha = \\frac{\\partial \\alpha}{\\partial \\psi} \\mathbf{e}^{\\psi} + \\frac{\\partial \\alpha}{\\partial \\theta} \\mathbf{e}^{\\theta} + \\frac{\\partial \\alpha}{\\partial \\phi} \\mathbf{e}^{\\phi}\n$$\n现在我们计算它们的叉积：\n$$\n\\mathbf{B} = \\mathbf{e}^{\\psi} \\times \\left( \\frac{\\partial \\alpha}{\\partial \\psi} \\mathbf{e}^{\\psi} + \\frac{\\partial \\alpha}{\\partial \\theta} \\mathbf{e}^{\\theta} + \\frac{\\partial \\alpha}{\\partial \\phi} \\mathbf{e}^{\\phi} \\right)\n$$\n利用叉积的线性性质以及 $\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\psi} = \\mathbf{0}$ 这一事实：\n$$\n\\mathbf{B} = \\frac{\\partial \\alpha}{\\partial \\theta} (\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\theta}) + \\frac{\\partial \\alpha}{\\partial \\phi} (\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\phi})\n$$\n我们使用恒等式 $\\mathbf{e}^{i} \\times \\mathbf{e}^{j} = \\frac{1}{\\mathcal{J}}\\epsilon^{ijk}\\mathbf{e}_{k}$ 将此表达式从逆变基底转换为协变基底，其中 $\\epsilon^{ijk}$ 是列维-奇维塔符号。采用排序 $(\\psi, \\theta, \\phi) \\leftrightarrow (1, 2, 3)$：\n$$\n\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\theta} = \\frac{1}{\\mathcal{J}}\\epsilon^{12k}\\mathbf{e}_{k} = \\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\phi}\n$$\n$$\n\\mathbf{e}^{\\psi} \\times \\mathbf{e}^{\\phi} = \\frac{1}{\\mathcal{J}}\\epsilon^{13k}\\mathbf{e}_{k} = -\\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\theta}\n$$\n将这些代回 $\\mathbf{B}$ 的表达式中：\n$$\n\\mathbf{B} = \\frac{\\partial \\alpha}{\\partial \\theta} \\left( \\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\phi} \\right) + \\frac{\\partial \\alpha}{\\partial \\phi} \\left( -\\frac{1}{\\mathcal{J}}\\mathbf{e}_{\\theta} \\right) = 0 \\cdot \\mathbf{e}_{\\psi} - \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\phi} \\mathbf{e}_{\\theta} + \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\theta} \\mathbf{e}_{\\phi}\n$$\n通过将其与 $\\mathbf{B} = B^{\\psi}\\mathbf{e}_{\\psi} + B^{\\theta}\\mathbf{e}_{\\theta} + B^{\\phi}\\mathbf{e}_{\\phi}$ 进行比较，我们确定 $\\mathbf{B}$ 的逆变分量：\n$$\nB^{\\psi} = 0\n$$\n$$\nB^{\\theta} = -\\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\phi}\n$$\n$$\nB^{\\phi} = \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\theta}\n$$\n现在我们将这些分量代入第一部分推导出的散度公式中：\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial(\\mathcal{J} B^{\\psi})}{\\partial \\psi} + \\frac{\\partial(\\mathcal{J} B^{\\theta})}{\\partial \\theta} + \\frac{\\partial(\\mathcal{J} B^{\\phi})}{\\partial \\phi} \\right)\n$$\n让我们计算括号内的各项：\n$$\n\\mathcal{J} B^{\\psi} = \\mathcal{J}(0) = 0\n$$\n$$\n\\mathcal{J} B^{\\theta} = \\mathcal{J} \\left( -\\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\phi} \\right) = -\\frac{\\partial \\alpha}{\\partial \\phi}\n$$\n$$\n\\mathcal{J} B^{\\phi} = \\mathcal{J} \\left( \\frac{1}{\\mathcal{J}}\\frac{\\partial \\alpha}{\\partial \\theta} \\right) = \\frac{\\partial \\alpha}{\\partial \\theta}\n$$\n将这些代回散度表达式中：\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial(0)}{\\partial \\psi} + \\frac{\\partial}{\\partial \\theta}\\left(-\\frac{\\partial \\alpha}{\\partial \\phi}\\right) + \\frac{\\partial}{\\partial \\phi}\\left(\\frac{\\partial \\alpha}{\\partial \\theta}\\right) \\right)\n$$\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( 0 - \\frac{\\partial^2 \\alpha}{\\partial \\theta \\partial \\phi} + \\frac{\\partial^2 \\alpha}{\\partial \\phi \\partial \\theta} \\right)\n$$\n题目说明 $\\alpha$ 具有连续的二阶混合偏导数。根据 Clairaut 定理（混合偏导数相等），如果二阶偏导数是连续的，那么它们的求导次序可以交换：\n$$\n\\frac{\\partial^2 \\alpha}{\\partial \\theta \\partial \\phi} = \\frac{\\partial^2 \\alpha}{\\partial \\phi \\partial \\theta}\n$$\n因此，括号中的表达式为零：\n$$\n\\nabla \\cdot \\mathbf{B} = \\frac{1}{\\mathcal{J}} \\left( \\frac{\\partial^2 \\alpha}{\\partial \\phi \\partial \\theta} - \\frac{\\partial^2 \\alpha}{\\partial \\theta \\partial \\phi} \\right) = \\frac{1}{\\mathcal{J}}(0) = 0\n$$\n这个结果证实了以 Clebsch 表示法表示的磁场具有无散性（$\\nabla\\cdot\\mathbf{B}=0$），这是 MHD 中的一个基本要求。最终值为实数 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "掌握了必要的数学工具后，我们将注意力转向不稳定性的物理机制。本实践探讨了仿星器稳定性的一个核心概念：局域几何特征的主导作用。您将学习为何简单的磁面平均会掩盖关键信息，并设计一个计算诊断程序来评估由“坏”曲率局域区域引起的风险。这个练习突显了一个重要原理——不稳定性会利用并放大磁约束位形中的最薄弱环节，从而让您对气球模的物理本质有更深刻的认识。",
            "id": "4049461",
            "problem": "给定一个仿星器的单个闭合磁通面，该磁通面由角向角 $\\theta$（单位为弧度）参数化，其中 $\\theta \\in [0,2\\pi)$。考虑理想磁流体动力学（MHD），它被定义为等离子体的理想导电流体模型。其稳定性可以通过MHD能量原理进行评估：势能的二阶变分 $\\delta W$ 决定了稳定性，当对于所有扰动 $\\delta W  0$ 时，系统是稳定的。在如仿星器此类的非轴对称系统中，局域法向曲率 $\\kappa_n(\\theta)$、磁场强度 $B(\\theta)$ 和磁剪切 $s(\\theta)$ 会沿着位于磁通面上的磁力线随 $\\theta$ 发生剧烈变化。磁通面平均常被用来概括这些物理量，但它们可能会掩盖对于气球模和交换模不稳定性至关重要的局域极值。\n\n从理想磁流体动力学（MHD）的能量原理和磁通面平均的定义出发，推导为什么局域驱动项 $f(\\theta)$ 的磁通面平均 $\\langle f \\rangle$ 会遗漏那些主导高模数气球模扰动稳定性的局域去稳区。你的推导必须仅使用基本定律和经过充分检验的公式，并从以下几点开始：(i) 理想磁流体动力学（MHD）能量原理在其局域磁力线表示下的形式，(ii) 磁通面平均作为对 $\\theta$ 的积分的定义，以及 (iii) 仿星器中曲率-压力驱动和磁剪切稳定化的概念性作用。不要使用任何简化的最终公式；请解释将这些基础与结合了平均值和极值的诊断设计联系起来的推理过程。\n\n使用压力梯度大小 $p'$、法向曲率 $\\kappa_n(\\theta)$、磁场强度 $B(\\theta)$ 和磁剪切 $s(\\theta)$ 定义一个无量纲的局域不稳定性驱动项 $g(\\theta)$。对此驱动项进行归一化，使得正的 $g(\\theta)$ 表示去稳，负的 $g(\\theta)$ 表示稳定。构建一个风险诊断指标 $R$，该指标聚合了 $g(\\theta)$ 正部的磁通面平均值、其最大值以及其在 $\\theta$ 上的标准差。你的诊断指标必须由推导证明其合理性，并且必须表示为这三个量的加权组合。明确定义所使用的所有权重和阈值，并确保该诊断指标是无量纲的。角度单位必须是弧度。\n\n你的程序必须实现你推导的诊断指标，并在以下涵盖不同机制的五个案例测试集上对其进行评估。使用在 $[0,2\\pi)$ 上至少 $N \\ge 2048$ 个点的均匀离散化来表示角向角 $\\theta$。在所有案例中，$B(\\theta)$、$\\kappa_n(\\theta)$ 和 $s(\\theta)$ 由平滑周期函数加上一个局域化的 $\\kappa_n(\\theta)$ 尖峰定义，该尖峰通过具有选定中心和宽度的周期性高斯函数建模。周期性高斯函数必须使用圆上的最短角距离构建，以使其平滑且以 $2\\pi$ 为周期。\n\n对于每个案例，角度单位均为弧度，所有量均为无量纲。使用以下函数形式，所有常数如下所示：\n- $B(\\theta) = B_0 \\left(1 + \\epsilon_B \\cos(N_B \\theta)\\right)$。\n- $\\kappa_n(\\theta) = \\kappa_0 \\left(1 + \\epsilon_\\kappa \\cos(N_\\kappa \\theta)\\right) + A \\exp\\left(-\\frac{d(\\theta,\\theta_0)^2}{2\\sigma^2}\\right)$，其中 $d(\\theta,\\theta_0)$ 是圆上 $\\theta$ 和 $\\theta_0$ 之间的最短周期角距离，定义为 $d(\\theta,\\theta_0) = \\min\\left(|\\theta - \\theta_0|, 2\\pi - |\\theta - \\theta_0|\\right)$。\n- $s(\\theta) = s_0 \\left(1 + \\epsilon_s \\cos(N_s \\theta)\\right)$。\n\n令压力梯度大小为 $p' = 0.3$，磁剪切稳定化系数为 $\\gamma_s = 0.5$。将驱动项的正部定义为 $g_+(\\theta) = \\max(g(\\theta), 0)$。令风险诊断指标为\n$$\nR = w_m \\max_{\\theta} g_+(\\theta) + w_a \\langle g_+ \\rangle + w_v \\sigma_g,\n$$\n其中 $\\langle g_+ \\rangle$ 是在 $\\theta$ 上的磁通面平均，而 $\\sigma_g$ 是 $g(\\theta)$ 在 $\\theta$ 上的标准差。使用权重 $w_m = 0.6$、$w_a = 0.3$、$w_v = 0.1$ 和风险阈值 $T = 0.2$。如果 $R \\ge T$，则将案例分类为有风险，否则为无风险。\n\n实现上述诊断指标并评估以下五个案例。所有角度单位均为弧度；所有量均为无量纲。\n\n- 案例 1（基线，弱变化，无尖峰）：$B_0 = 1.0$, $\\epsilon_B = 0.1$, $N_B = 1$, $\\kappa_0 = 0.3$, $\\epsilon_\\kappa = 0.05$, $N_\\kappa = 1$, $A = 0.0$, $\\theta_0 = \\pi/3$, $\\sigma = 0.05$, $s_0 = 0.8$, $\\epsilon_s = 0.0$, $N_s = 1$。\n- 案例 2（局域坏曲率尖峰）：$B_0 = 1.0$, $\\epsilon_B = 0.1$, $N_B = 1$, $\\kappa_0 = 0.3$, $\\epsilon_\\kappa = 0.05$, $N_\\kappa = 1$, $A = 1.2$, $\\theta_0 = \\pi/3$, $\\sigma = 0.05$, $s_0 = 0.8$, $\\epsilon_s = 0.0$, $N_s = 1$。\n- 案例 3（均匀；零方差边界）：$B_0 = 1.0$, $\\epsilon_B = 0.0$, $N_B = 1$, $\\kappa_0 = 0.15$, $\\epsilon_\\kappa = 0.0$, $N_\\kappa = 1$, $A = 0.0$, $\\theta_0 = \\pi/2$, $\\sigma = 0.05$, $s_0 = 1.0$, $\\epsilon_s = 0.0$, $N_s = 1$。\n- 案例 4（极端窄尖峰）：$B_0 = 1.0$, $\\epsilon_B = 0.05$, $N_B = 2$, $\\kappa_0 = 0.25$, $\\epsilon_\\kappa = 0.05$, $N_\\kappa = 2$, $A = 3.0$, $\\theta_0 = \\pi/2$, $\\sigma = 0.02$, $s_0 = 0.6$, $\\epsilon_s = 0.0$, $N_s = 1$。\n- 案例 5（强磁剪切稳定化）：$B_0 = 1.0$, $\\epsilon_B = 0.1$, $N_B = 1$, $\\kappa_0 = 0.3$, $\\epsilon_\\kappa = 0.05$, $N_\\kappa = 1$, $A = 1.2$, $\\theta_0 = \\pi/3$, $\\sigma = 0.05$, $s_0 = 2.5$, $\\epsilon_s = 0.0$, $N_s = 1$。\n\n你的程序应该生成单行输出，其中包含这五个案例的结果，格式为一个由方括号括起来的逗号分隔列表，每个条目都是一个布尔值，指示该案例是否有风险。例如，输出格式必须与 $[{\\text{结果}_1},{\\text{结果}_2},{\\text{结果}_3},{\\text{结果}_4},{\\text{结果}_5}]$ 完全一样。",
            "solution": "该问题是有效的，因为它在科学上基于理想磁流体动力学（MHD），问题陈述清晰且信息充分，可得到唯一的数值解，并以客观、正式的语言表述。我们将首先提供所要求的推导，然后定义不稳定性诊断指标，最后给出评估该指标的代码。\n\n### 推导：磁通面平均在气球模不稳定性分析中的不充分性\n\n在理想MHD模型中，等离子体的稳定性由势能的二阶变分 $\\delta W$ 对于所有可能的流体扰动 $\\mathbf{\\xi}(\\mathbf{r})$ 的符号决定。一个位形是稳定的当且仅当对于所有非平凡的 $\\mathbf{\\xi}$，$\\delta W  0$。能量泛函 $\\delta W$ 可以表示为在等离子体体积 $V$ 上的积分：\n$$\n\\delta W = \\frac{1}{2} \\int_V \\left[ \\frac{|\\mathbf{Q}|^2}{\\mu_0} + (\\mathbf{j} \\times \\mathbf{\\xi}) \\cdot \\mathbf{Q} + (\\nabla \\cdot \\mathbf{\\xi})(\\mathbf{\\xi} \\cdot \\nabla p_0) + \\gamma_H p_0 (\\nabla \\cdot \\mathbf{\\xi})^2 \\right] dV\n$$\n其中 $\\mathbf{Q} = \\nabla \\times (\\mathbf{\\xi} \\times \\mathbf{B}_0)$ 是扰动磁场，$\\mathbf{B}_0$、$\\mathbf{j}_0$ 和 $p_0$ 分别是平衡态的磁场、电流密度和压力，$\\gamma_H$ 是比热容比。\n\n对于缺乏轴对称性的仿星器而言，等离子体抵抗高模数“气球模”不稳定性的稳定性是一个主要问题。这些模式的特点是在垂直于磁力线的方向上波长短，但在平行于磁力线的方向上波长长。这一特性允许扰动弯曲磁力线（这会消耗能量），但同时也使其能够与场的螺旋结构对齐，并局域化在不稳定性驱动最强的区域。\n\n对这类模式的分析可以通过变换到与磁场对齐的坐标系来简化。在这种“气球模形式”下，三维稳定性问题被简化为沿单条磁力线的一维特征值问题。闭合磁通面上的磁力线可以由角向角 $\\theta \\in [0, 2\\pi)$ 参数化。稳定性判据随后取决于沿该磁力线的积分。示意性地，来自单条磁力线的能量贡献具有以下形式：\n$$\n\\delta W_{\\text{line}} \\propto \\int_{-\\infty}^{\\infty} d\\theta \\left\\{ (\\text{稳定项}) \\left| \\frac{d\\xi_n}{d\\theta} \\right|^2 - (\\text{驱动项}) |\\xi_n|^2 \\right\\}\n$$\n此处，$\\xi_n(\\theta)$ 表示沿磁力线法向于磁通面的等离子体位移幅度。\n\n被积函数有两个主要组成部分：\n1.  **稳定项**：该项主要与弯曲磁力线所需的能量相关。它总是正的，并受到磁剪切 $s(\\theta) = (1/q) d(q)/dr$ 的强烈影响，磁剪切衡量安全因子 $q$ 的径向变化。大的磁剪切 $s$ 会增加磁力线弯曲的能量代价，从而提供一种强大的稳定机制。该项与 $|d\\xi_n/d\\theta|^2$ 成正比，意味着它会抑制扰动的急剧变化。\n\n2.  **驱动项**：该项源于等离子体压力梯度与磁场曲率的相互作用。对于理想MHD，主导的驱动是压力-曲率项，其局域地可表示为与 $-p' \\kappa_n(\\theta)$ 成比例，其中 $p' = dp/dr  0$ 是径向压力梯度（注意：问题将 $p'$ 定义为正值的大小），$\\kappa_n(\\theta)$ 是磁力线曲率在磁通面法向上的分量。按照惯例，$\\kappa_n  0$ 代表“坏曲率”（去稳），而 $\\kappa_n  0$ 代表“好曲率”（稳定）。因此，正的局域驱动对应于 $p' \\kappa_n  0$ 的区域（使用问题中对 $p'$ 的符号定义）。\n\n如果能找到一个扰动 $\\xi_n(\\theta)$ 使得 $\\delta W_{\\text{line}}  0$，则系统是不稳定的。变分积分的性质至关重要。气球模的幅度无需是均匀的。它可以“选择”一个形状 $\\xi_n(\\theta)$ 来最小化 $\\delta W_{\\text{line}}$。具体来说，它可以在驱动项为强正值（去稳）的区域发展出较大的幅度，而在驱动项为负值（稳定）的区域保持较小的幅度。\n\n现在，考虑一个局域量 $f(\\theta)$ 的磁通面平均，其定义为 $\\langle f \\rangle = \\frac{1}{2\\pi} \\int_0^{2\\pi} f(\\theta) d\\theta$。如果我们将 $f(\\theta)$ 作为局域不稳定性驱动项，其平均值 $\\langle f \\rangle$ 提供了该磁通面整体稳定性趋势的度量。然而，谬误正在于此。一个磁通面可能具有很小甚至为负（稳定）的平均驱动项，即 $\\langle f \\rangle \\le 0$，但却拥有一个局域驱动项 $f(\\theta)$ 极强的狭窄区域。气球模随后可以局域化在这个“坏”的狭窄区域中。虽然急剧的局域化会增加起稳定作用的磁力线弯曲项（因为 $|d\\xi_n/d\\theta|^2$ 变大），但如果该区域的驱动足够强，净能量变化 $\\delta W_{\\text{line}}$ 仍然可以为负，从而导致不稳定性。\n\n因此，稳定性不是由平均条件决定的，而是由一种对最坏情况下的局域条件高度敏感的权衡决定的。局域驱动项的最大值 $\\max_{\\theta} f(\\theta)$ 是一个比平均值 $\\langle f \\rangle$ 好得多的、用于衡量局域气球模不稳定性潜力的指标。平均值可能会产生误导，因为它“抹平”了对于非空间均匀模式至关重要的局域极值。\n\n### 诊断定义与论证\n\n基于上述推导，一个用于评估气球模不稳定性风险的稳健诊断指标必须同时考虑局域极值和不稳定性驱动的整体特征。我们首先结合所提供的物理要素，定义一个无量纲的局域不稳定性驱动项 $g(\\theta)$。一个符合物理直觉且与能量原理一致的形式，是将与 $p' \\kappa_n / B^2$ 成比例的压力-曲率驱动项和与 $s^2$ 成比例的磁剪切稳定项结合起来。\n$$\ng(\\theta) = \\frac{p' \\kappa_n(\\theta)}{B(\\theta)^2} - \\gamma_s s(\\theta)^2\n$$\n此处，$p'$ 是压力梯度的大小，$\\kappa_n(\\theta)$ 是法向曲率，$B(\\theta)$ 是磁场强度，$s(\\theta)$ 是磁剪切，$\\gamma_s$ 是一个代表磁剪切稳定化效率的系数。正的 $g(\\theta)$ 表示一个净的局域去稳驱动。\n\n我们现在可以论证所规定的风险诊断指标 $R$ 的结构的合理性：\n$$\nR = w_m \\max_{\\theta} g_+(\\theta) + w_a \\langle g_+ \\rangle + w_v \\sigma_g\n$$\n其中 $g_+(\\theta) = \\max(g(\\theta), 0)$，$\\langle g_+ \\rangle$ 是 $g_+(\\theta)$ 的磁通面平均值，而 $\\sigma_g$ 是 $g(\\theta)$ 的标准差。\n\n*   $\\max_{\\theta} g_+(\\theta)$：该项被赋予最高权重（$w_m=0.6$），直接解决了平均方法的根本弱点。它捕捉了磁通面上最去稳点的幅度，而该点是气球模的主要目标。\n*   $\\langle g_+ \\rangle$：该项的权重为 $w_a=0.3$，量化了整个磁通面上的平均去稳趋势。一个大的值表明磁通面的大部分区域是不稳定的，这比单个尖锐的峰值代表了更全局性的风险。\n*   $\\sigma_g$：总驱动项 $g(\\theta)$ 的标准差，权重为 $w_v=0.1$，用于衡量整体的变化性。高方差表明存在强烈的局域变化（包括峰和谷），这是易受气球模影响的位形的典型特征，因为气球模正是利用了这种变化。\n\n因此，这个复合诊断指标 $R$ 通过结合最坏情况下的局域驱动、平均驱动和非均匀度，提供了一个比任何单一指标都更全面的评估。如果 $R$ 超过指定的阈值 $T$，则该案例被归类为“有风险”。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and evaluates a risk diagnostic for stellarator MHD ballooning stability.\n    \"\"\"\n    #\n    # --- Problem Constants and Diagnostic Parameters ---\n    #\n    p_prime = 0.3\n    gamma_s = 0.5\n    w_m = 0.6  # Weight for maximum of positive drive\n    w_a = 0.3  # Weight for average of positive drive\n    w_v = 0.1  # Weight for standard deviation of total drive\n    T = 0.2    # Risk threshold\n    N = 4096   # Discretization points for the poloidal angle\n\n    #\n    # --- Test Case Definitions ---\n    #\n    test_cases = [\n        # Case 1 (baseline, weak variation, no spike)\n        {'B0': 1.0, 'eps_B': 0.1, 'N_B': 1, 'k0': 0.3, 'eps_k': 0.05, 'N_k': 1, 'A': 0.0, 'theta0': np.pi/3, 'sigma': 0.05, 's0': 0.8, 'eps_s': 0.0, 'N_s': 1},\n        # Case 2 (localized bad-curvature spike)\n        {'B0': 1.0, 'eps_B': 0.1, 'N_B': 1, 'k0': 0.3, 'eps_k': 0.05, 'N_k': 1, 'A': 1.2, 'theta0': np.pi/3, 'sigma': 0.05, 's0': 0.8, 'eps_s': 0.0, 'N_s': 1},\n        # Case 3 (uniform; zero variance boundary)\n        {'B0': 1.0, 'eps_B': 0.0, 'N_B': 1, 'k0': 0.15, 'eps_k': 0.0, 'N_k': 1, 'A': 0.0, 'theta0': np.pi/2, 'sigma': 0.05, 's0': 1.0, 'eps_s': 0.0, 'N_s': 1},\n        # Case 4 (extreme narrow spike)\n        {'B0': 1.0, 'eps_B': 0.05, 'N_B': 2, 'k0': 0.25, 'eps_k': 0.05, 'N_k': 2, 'A': 3.0, 'theta0': np.pi/2, 'sigma': 0.02, 's0': 0.6, 'eps_s': 0.0, 'N_s': 1},\n        # Case 5 (strong shear stabilization)\n        {'B0': 1.0, 'eps_B': 0.1, 'N_B': 1, 'k0': 0.3, 'eps_k': 0.05, 'N_k': 1, 'A': 1.2, 'theta0': np.pi/3, 'sigma': 0.05, 's0': 2.5, 'eps_s': 0.0, 'N_s': 1},\n    ]\n\n    #\n    # --- Main Calculation Loop ---\n    #\n    theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    results = []\n\n    for case in test_cases:\n        # Extract parameters for clarity\n        B0, eps_B, N_B = case['B0'], case['eps_B'], case['N_B']\n        k0, eps_k, N_k = case['k0'], case['eps_k'], case['N_k']\n        A, theta0, sigma = case['A'], case['theta0'], case['sigma']\n        s0, eps_s, N_s = case['s0'], case['eps_s'], case['N_s']\n\n        # Calculate periodic angular distance for the Gaussian spike\n        d_theta = np.abs(theta - theta0)\n        d = np.minimum(d_theta, 2 * np.pi - d_theta)\n\n        # Calculate B(theta), kappa_n(theta), and s(theta)\n        B = B0 * (1 + eps_B * np.cos(N_B * theta))\n        kappa_n = k0 * (1 + eps_k * np.cos(N_k * theta)) + A * np.exp(-d**2 / (2 * sigma**2))\n        s = s0 * (1 + eps_s * np.cos(N_s * theta))\n\n        # Define the local instability drive g(theta)\n        g = (p_prime * kappa_n) / (B**2) - gamma_s * s**2\n\n        # Define the positive part of the drive g_+(theta)\n        g_plus = np.maximum(g, 0)\n\n        # Calculate the components of the risk diagnostic\n        max_g_plus = np.max(g_plus)\n        avg_g_plus = np.mean(g_plus)\n        std_g = np.std(g)\n\n        # Calculate the final risk diagnostic value R\n        R = w_m * max_g_plus + w_a * avg_g_plus + w_v * std_g\n\n        # Classify the case based on the risk threshold T\n        is_risky = R = T\n        results.append(is_risky)\n\n    # Format and print the final output exactly as specified\n    print(f\"[{','.join(map(lambda x: str(x).lower(), results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后的这个实践练习将前面的概念综合成一个全局稳定性模型，这是理解仿星器特有不稳定性的关键一步。我们将局域稳定化效应（如磁剪切）与由复杂三维几何引起的全局耦合效应之间的竞争关系形式化。通过将MHD能量原理表示为一个矩阵的本征值问题，您将通过计算清晰地证明仿星器物理学的一个基石：一个在所有局部点都满足稳定判据的位形，仍可能因为全局耦合而整体失稳。这项练习为理解全局MHD模的整体性提供了一个具体而深刻的模型。",
            "id": "4049501",
            "problem": "请考虑在三维环形位形（如仿星器）中，局域Mercier稳定性与全局交换稳定性之间的区别。在理想磁流体力学（MHD）中，能量原理指出，如果势能的二阶变分（记为$\\delta W$）对于所有容许的微扰都为正，则等离子体平衡是线性稳定的。局域Mercier稳定性判据评估一个由平衡几何量（包括压强梯度、磁曲率和磁剪切）在给定磁面上构建的局域参数$D_{\\mathrm{M}}$的符号；在气球模极限下，$D_{\\mathrm{M}}  0$表示局域交换稳定性。相比之下，全局交换稳定性要求，当考虑到整个位形中的全局耦合时（包括相邻傅里叶分量、场周期或磁通管段之间的耦合），与$\\delta W$相关的二次型是正定的。即使在每个位置都满足局域Mercier判据，这些耦合也可能使全局模变得不稳定。\n\n从理想磁流体力学能量原理出发，将全局稳定性问题建模为一个有限维实对称矩阵$\\mathbf{A}$，该矩阵代表$\\delta W$的离散化二次型。$\\mathbf{A}$的对角元是在位置$i$的局域Mercier参数$D_{\\mathrm{M},i}$，非对角元$C_{ij}$表示由于磁场非轴对称性、几何耦合或模式相互作用导致的位置$i$和$j$之间的守恒能量耦合。在这个玩具模型中，全局交换稳定性等价于$\\mathbf{A}$的所有特征值都严格为正，而局域Mercier稳定性对应于每个对角元$D_{\\mathrm{M},i}  0$。当且仅当$\\mathbf{A}$的最小特征值为负时，存在全局不稳定性。\n\n您的任务是：\n- 基于理想磁流体力学能量原理，推导出一个算法，用于从矩阵$\\mathbf{A}$判断全局交换稳定性。\n- 实现一个程序，对于提供的一组测试矩阵$\\mathbf{A}$，计算每个矩阵的最小特征值$\\lambda_{\\min}$。将$\\lambda_{\\min}  0$解释为全局稳定，$\\lambda_{\\min} = 0$解释为临界稳定，$\\lambda_{\\min}  0$解释为全局不稳定。\n- 构建并包含至少一个测试用例，其中所有局域$D_{\\mathrm{M},i}  0$，但由于足够强的耦合$C_{ij}$，导致一个全局模不稳定。\n\n在此问题中，所有量均为无量纲。不使用角度。算法必须从理想磁流体力学能量原理的陈述（稳定性要求对所有微扰$\\delta W  0$）开始，通过离散化推导至对称矩阵$\\mathbf{A}$，其特征值决定稳定性。\n\n使用以下测试矩阵套件：\n1.  案例1（理想情况，局域和全局均稳定）：$2 \\times 2$矩阵，其中$D_{\\mathrm{M}} = [1.0, 1.0]$，耦合$C_{01} = 0.3$。\n2.  案例2（临界情况，临界全局稳定）：$2 \\times 2$矩阵，其中$D_{\\mathrm{M}} = [1.0, 1.0]$，耦合$C_{01} = 1.0$。\n3.  案例3（所要求的现象，局域稳定但全局不稳定）：$2 \\times 2$矩阵，其中$D_{\\mathrm{M}} = [1.0, 1.0]$，耦合$C_{01} = 2.0$。\n4.  案例4（边缘情况，违反局域Mercier稳定性）：$3 \\times 3$矩阵，其中$D_{\\mathrm{M}} = [1.0, -0.2, 0.8]$，耦合$C_{01} = 0.1$和$C_{12} = 0.1$。\n\n对于每个案例，按如下方式构建$\\mathbf{A}$：设置$\\mathbf{A}_{ii} = D_{\\mathrm{M},i}$，对于每个指定的耦合，设置$\\mathbf{A}_{ij} = \\mathbf{A}_{ji} = C_{ij}$，所有其他非对角元为零。计算每个案例中$\\mathbf{A}$的最小特征值$\\lambda_{\\min}$并报告。\n\n最终输出规范：\n- 生成单行输出，其中包含所有四个测试用例的结果，形式为方括号内以逗号分隔的浮点数列表，每个浮点数四舍五入到六位小数（例如，$\\left[0.123456,-0.000001,0.000000,2.000000\\right]$）。",
            "solution": "该问题要求基于理想磁流体力学（MHD）能量原理的离散化模型，推导并实现一个评估等离子体位形全局交换稳定性的算法。分析始于对问题陈述的验证。\n\n### 步骤1：提取给定信息\n- **原理**：如果势能的二阶变分$\\delta W$对于所有容许的微扰都为正，即$\\delta W  0$，则等离子体平衡是线性稳定的。\n- **模型**：全局稳定性问题被建模为一个有限维实对称矩阵$\\mathbf{A}$，该矩阵代表$\\delta W$的离散化二次型。\n- **矩阵构造**：对角元是局域Mercier参数，$\\mathbf{A}_{ii} = D_{\\mathrm{M},i}$。非对角元是耦合项，$\\mathbf{A}_{ij} = C_{ij}$（当$i \\neq j$时）。矩阵$\\mathbf{A}$是对称的，因此$\\mathbf{A}_{ij} = \\mathbf{A}_{ji}$。\n- **局域稳定性**：位置$i$的局域Mercier稳定性对应于$D_{\\mathrm{M},i}  0$。\n- **全局稳定性**：全局交换稳定性等价于矩阵$\\mathbf{A}$的所有特征值都严格为正。\n- **全局不稳定性**：当且仅当$\\mathbf{A}$的最小特征值$\\lambda_{\\min}$为负时，存在全局不稳定性。临界稳定性对应于$\\lambda_{\\min} = 0$。\n- **任务**：从能量原理出发，推导出一个通过$\\mathbf{A}$判断全局稳定性的算法，并加以实现。\n- **测试用例**：\n    1.  $2 \\times 2$矩阵：$D_{\\mathrm{M}} = [1.0, 1.0]$, $C_{01} = 0.3$。\n    2.  $2 \\times 2$矩阵：$D_{\\mathrm{M}} = [1.0, 1.0]$, $C_{01} = 1.0$。\n    3.  $2 \\times 2$矩阵：$D_{\\mathrm{M}} = [1.0, 1.0]$, $C_{01} = 2.0$。\n    4.  $3 \\times 3$矩阵：$D_{\\mathrm{M}} = [1.0, -0.2, 0.8]$, 耦合$C_{01} = 0.1, C_{12} = 0.1$。\n- **输出**：一个单行的、以逗号分隔的列表，包含四个案例的最小特征值，用方括号括起，并四舍五入到六位小数。\n\n### 步骤2：使用提取的给定信息进行验证\n根据既定标准评估问题陈述。\n- **科学基础**：该问题在理想磁流体力学稳定性理论中有坚实的基础。能量原理$\\delta W  0$是线性磁流体力学稳定性分析的基石。将$\\delta W$算符离散化为矩阵是计算等离子体物理学中分析全局模的一种标准且有效的方法。局域稳定性判据（如Mercier判据）与全局稳定性之间的区别是研究复杂三维磁位形（如仿星器）的核心主题。该模型虽然经过简化，但正确地捕捉了局域稳定性（对角项）和全局耦合效应（非对角项）的基本物理。\n- **适定性**：该问题是适定的。对于任何给定的实对称矩阵$\\mathbf{A}$，其特征值是实数且唯一确定。寻找最小特征值$\\lambda_{\\min}$是线性代数中一个标准的、明确定义的问题。稳定性判据$\\lambda_{\\min}  0$是明确无误的。\n- **客观性**：问题陈述使用了精确、客观、形式化的科学语言。所有术语都得到了清晰的定义。\n\n该问题不存在任何指定的缺陷。它在科学上是合理的、适定的、完整的，并且可以形式化。\n\n### 步骤3：结论与行动\n该问题有效。一个合理的解法如下。\n\n理想磁流体力学线性稳定性的基本原则是能量原理。一个磁约束等离子体平衡是稳定的，当且仅当与等离子体的任何物理上容许的无穷小位移$\\vec{\\xi}(\\vec{r})$相关的势能变化$\\delta W$为正。在数学上，这表示为：\n$$ \\delta W[\\vec{\\xi}, \\vec{\\xi}]  0 $$\n对于所有非平凡的位移场$\\vec{\\xi}$。$\\delta W$项是$\\vec{\\xi}$的二次泛函，意味着它与位移场及其空间导数呈二次关系。\n\n为了将这个原理转化为一个计算上可处理的问题，所有可能的位移场$\\vec{\\xi}(\\vec{r})$的无限维空间被投影到一个有限维子空间上。这是通过将$\\vec{\\xi}(\\vec{r})$表示为一组有限的$N$个基函数$\\{\\vec{f}_i(\\vec{r})\\}_{i=1}^N$的线性组合来实现的：\n$$ \\vec{\\xi}(\\vec{r}) = \\sum_{i=1}^{N} x_i \\vec{f}_i(\\vec{r}) $$\n在这里，$x_i$是基函数的标量振幅。将此展开式代入能量泛函并利用其双线性特性，我们得到一个关于未知振幅$x_i$的二次型：\n$$ \\delta W = \\sum_{i=1}^{N} \\sum_{j=1}^{N} x_i x_j \\delta W[\\vec{f}_i, \\vec{f}_j] $$\n该表达式可以写成矩阵形式：\n$$ \\delta W = \\mathbf{x}^T \\mathbf{A} \\mathbf{x} $$\n其中$\\mathbf{x}$是振幅的列向量$[x_1, x_2, \\dots, x_N]^T$，$\\mathbf{A}$是一个$N \\times N$矩阵，其元素由基函数对的能量积分给出：\n$$ A_{ij} = \\delta W[\\vec{f}_i, \\vec{f}_j] $$\n理想磁流体力学中的$\\delta W$泛函算符是自伴的，这意味着所得到的矩阵$\\mathbf{A}$是实对称的，即$A_{ij} = A_{ji}$。\n\n问题陈述提供了这样一个矩阵$\\mathbf{A}$。对角元$\\mathbf{A}_{ii} = D_{\\mathrm{M},i}$被认为是局域稳定性判据，代表局域化微扰$x_i \\vec{f}_i$的能量成本。非对角元$\\mathbf{A}_{ij} = C_{ij}$（当$i \\neq j$时）代表不同基函数（模式）之间的能量耦合，这是非轴对称系统中全局稳定性的一个关键特征。\n\n稳定性条件$\\delta W  0$（对于所有非平凡微扰$\\vec{\\xi}$）转化为条件$\\mathbf{x}^T \\mathbf{A} \\mathbf{x}  0$（对于所有非零向量$\\mathbf{x} \\in \\mathbb{R}^N$）。这正是正定矩阵的定义。\n\n线性代数的一个基本定理指出，一个实对称矩阵是正定的，当且仅当其所有特征值都严格为正。因此，由矩阵$\\mathbf{A}$描述的系统的稳定性可以通过检查其特征值谱来确定。如果我们将$\\mathbf{A}$的特征值表示为$\\lambda_1, \\lambda_2, \\dots, \\lambda_N$，则系统是：\n- **全局稳定**，如果最小特征值$\\lambda_{\\min} = \\min(\\{\\lambda_k\\})$为正（$\\lambda_{\\min}  0$）。\n- **临界稳定**，如果最小特征值为零（$\\lambda_{\\min} = 0$）。\n- **全局不稳定**，如果最小特征值为负（$\\lambda_{\\min}  0$）。\n\n矩阵$\\mathbf{A}$的特征值代表了与相应特征向量（系统的全局本征模）相关的势能。一个负特征值表示存在一个会降低系统势能的全局模，从而导致不稳定性。\n\n因此，推导出的算法如下：\n1.  根据提供的局域稳定性参数$D_{\\mathrm{M},i}$和耦合系数$C_{ij}$，构造实对称矩阵$\\mathbf{A}$。\n2.  计算矩阵$\\mathbf{A}$的特征值。由于$\\mathbf{A}$是实对称的，其所有特征值都是实数。标准的数值线性代数程序非常适合此任务。\n3.  在计算出的特征值中找到最小值$\\lambda_{\\min}$。\n4.  根据$\\lambda_{\\min}$的符号评估稳定性。\n\n该算法将被实现以解决所提供的测试用例。案例3具有特别的物理意义，因为它旨在表明，即使所有局域稳定性判据都满足（对所有$i$，$D_{\\mathrm{M},i}  0$），强耦合（$C_{ij}$）也可以驱动一个全局模变得不稳定，导致$\\lambda_{\\min}  0$。这表明局域稳定性分析不足以确定整个系统的稳定性。案例4展示了一个更直接的情况，其中存在局域Mercier违例（$D_{\\mathrm{M},1} = -0.2  0$），这是不稳定性的一个强有力指标，通常直接导致一个负特征值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives global MHD interchange stability by computing the minimum eigenvalue\n    of a matrix representing the discretized potential energy functional delta W.\n    \"\"\"\n\n    # The problem defines test cases in terms of diagonal elements (D_M) and\n    # off-diagonal couplings (C_ij). We construct the corresponding matrices.\n\n    # Case 1: 2x2, DM=[1.0, 1.0], C01=0.3. Locally and globally stable.\n    A1 = np.array([\n        [1.0, 0.3],\n        [0.3, 1.0]\n    ])\n\n    # Case 2: 2x2, DM=[1.0, 1.0], C01=1.0. Marginally stable.\n    # The coupling is exactly equal to the local stabilizing term.\n    A2 = np.array([\n        [1.0, 1.0],\n        [1.0, 1.0]\n    ])\n\n    # Case 3: 2x2, DM=[1.0, 1.0], C01=2.0. Locally stable, globally unstable.\n    # This case demonstrates that strong coupling can overcome local stability.\n    # All diagonal elements (D_M) are positive, but a global mode is unstable.\n    A3 = np.array([\n        [1.0, 2.0],\n        [2.0, 1.0]\n    ])\n\n    # Case 4: 3x3, DM=[1.0, -0.2, 0.8], C01=0.1, C12=0.1.\n    # A local Mercier violation (D_M,1 = -0.2) leads to global instability.\n    A4 = np.array([\n        [1.0, 0.1, 0.0],\n        [0.1, -0.2, 0.1],\n        [0.0, 0.1, 0.8]\n    ])\n\n    test_matrices = [A1, A2, A3, A4]\n    min_eigenvalues = []\n\n    for A in test_matrices:\n        # For a real symmetric matrix, numpy.linalg.eigvalsh is an efficient\n        # and numerically stable choice to compute the eigenvalues.\n        eigenvalues = np.linalg.eigvalsh(A)\n        \n        # The minimum eigenvalue determines the stability of the system.\n        lambda_min = np.min(eigenvalues)\n        min_eigenvalues.append(lambda_min)\n\n    # Format the results as specified: a list of floats, each rounded to\n    # six decimal places, in a single line.\n    formatted_results = [f\"{val:.6f}\" for val in min_eigenvalues]\n    output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}