{
    "hands_on_practices": [
        {
            "introduction": "惯性约束聚变（ICF）内爆过程始于一道或多道强激波对燃料的压缩。因此，理解燃料在被第一道激波压缩后的状态是分析整个内爆动力学的基础。这项练习将引导您运用描述激波前后物理量守恒的兰金-雨贡纽关系，推导理想气体在强激波极限下的压缩比，并探讨真实稠密等离子体的物态方程（EOS）与理想模型的关键差异。",
            "id": "3995233",
            "problem": "一道平面、定常正激波传播进入初始静止的氘-氚 (DT) 混合物，其温度$T_0=20\\,\\mathrm{K}$，质量密度$\\rho_0=0.25\\,\\mathrm{g/cm^3}$。这些参数代表了惯性约束聚变 (ICF) 靶丸中的低温DT。激波速度为$u_s=30\\,\\mathrm{km/s}$。假设下游的DT可以用理想$\\gamma$律状态方程 (EOS) $p=(\\gamma-1)\\rho e$ 来建模，其中$\\gamma$取适用于单原子理想气体的值。并假设与激波后状态相比，上游的压力和内能可以忽略不计。从跨越定常平面激波的质量、动量和能量守恒（即Rankine–Hugoniot关系）以及理想$\\gamma$律状态方程出发，推导压缩比，并用它计算此强激波下被压缩的密度$\\rho_1$。将最终的数值密度四舍五入到四位有效数字，并以$\\mathrm{g/cm^3}$为单位表示。简要地、定性地讨论，在这些条件下，一个表格式DT状态方程会如何修正理想气体的预测，并说明原因。",
            "solution": "该问题要求推导强激波条件下氘-氚 (DT) 混合物被激波压缩后的密度。首先使用理想气体模型进行计算，然后定性地讨论一个更真实的表格式状态方程 (EOS) 会引入怎样的修正。\n\n首先，我们陈述Rankine–Hugoniot关系，该关系表达了跨越一个定常、平面的激波阵面时的质量、动量和能量守恒。我们在激波静止的参考系中分析这个问题。在此参考系中，上游流体（状态0）以速度$v_0 = u_s$向激波移动，其中$u_s$是实验室参考系中的激波速度。下游流体（状态1）以速度$v_1$远离激波。这些关系如下：\n1.  质量守恒：$\\rho_0 v_0 = \\rho_1 v_1$\n2.  动量守恒：$p_0 + \\rho_0 v_0^2 = p_1 + \\rho_1 v_1^2$\n3.  能量守恒：$h_0 + \\frac{1}{2}v_0^2 = h_1 + \\frac{1}{2}v_1^2$，其中$h = e + p/\\rho$是比焓。\n\n问题指明了使用强激波近似，即上游压力$p_0$和内能$e_0$（因此也包括焓$h_0$）与它们在激波后的对应量相比可以忽略不计。应用此近似（$p_0 \\to 0$，$h_0 \\to 0$），Rankine–Hugoniot关系简化为：\n$$ \\rho_0 v_0 = \\rho_1 v_1 \\quad (1) $$\n$$ \\rho_0 v_0^2 = p_1 + \\rho_1 v_1^2 \\quad (2) $$\n$$ \\frac{1}{2}v_0^2 = h_1 + \\frac{1}{2}v_1^2 \\quad (3) $$\n\n我们对下游状态使用理想$\\gamma$律状态方程，$p_1 = (\\gamma-1)\\rho_1 e_1$。比焓为$h_1 = e_1 + p_1/\\rho_1$。代入$e_1$，我们得到$h_1 = \\frac{p_1}{(\\gamma-1)\\rho_1} + \\frac{p_1}{\\rho_1} = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1}$。\n将这个$h_1$的表达式代入能量方程（3）：\n$$ \\frac{1}{2}v_0^2 = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1} + \\frac{1}{2}v_1^2 \\quad (4) $$\n\n现在我们求解这个方程组，以得到压缩比$\\eta = \\rho_1 / \\rho_0$。\n由（1）式可得，$v_1 = \\frac{\\rho_0}{\\rho_1} v_0 = \\frac{v_0}{\\eta}$。\n由（2）式，我们可以将激波后压力$p_1$表示为：\n$$ p_1 = \\rho_0 v_0^2 - \\rho_1 v_1^2 = \\rho_0 v_0^2 - (\\eta \\rho_0) \\left(\\frac{v_0}{\\eta}\\right)^2 = \\rho_0 v_0^2 - \\frac{\\rho_0 v_0^2}{\\eta} = \\rho_0 v_0^2 \\left(1 - \\frac{1}{\\eta}\\right) $$\n或者，由（1）和（2）式可得：$p_1 = \\rho_0 v_0 (v_0 - v_1)$。\n\n让我们对这些方程进行处理，以找到一个简单的速度关系。我们将动量方程中的$p_1$表达式代入能量方程（4）。一个更直接的方法是先从能量方程中表达$p_1$：\n$p_1 = \\frac{(\\gamma-1)\\rho_1}{\\gamma} \\left(\\frac{1}{2}v_0^2 - \\frac{1}{2}v_1^2\\right) = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0^2 - v_1^2)$。\n现在，我们令两个$p_1$的表达式相等：\n$$ \\rho_0 v_0 (v_0 - v_1) = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0 - v_1)(v_0 + v_1) $$\n因为必须存在激波，$v_1 \\neq v_0$，所以我们可以除以$(v_0 - v_1)$：\n$$ \\rho_0 v_0 = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0 + v_1) $$\n使用质量守恒关系$\\rho_0 v_0 = \\rho_1 v_1$：\n$$ \\rho_1 v_1 = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0 + v_1) $$\n由于$\\rho_1$非零，我们可以消去它：\n$$ v_1 = \\frac{\\gamma-1}{2\\gamma}(v_0 + v_1) $$\n$$ 2\\gamma v_1 = (\\gamma-1)v_0 + (\\gamma-1)v_1 $$\n$$ v_1 (2\\gamma - (\\gamma-1)) = v_0 (\\gamma-1) $$\n$$ v_1 (\\gamma+1) = v_0 (\\gamma-1) $$\n这给出了速度比：\n$$ \\frac{v_1}{v_0} = \\frac{\\gamma-1}{\\gamma+1} $$\n压缩比为$\\eta = \\rho_1 / \\rho_0$。由质量守恒（1），$\\eta = v_0 / v_1$。因此，对于理想气体中的强激波：\n$$ \\eta = \\frac{\\rho_1}{\\rho_0} = \\frac{\\gamma+1}{\\gamma-1} $$\n问题指出DT是单原子理想气体。在激波后的高温高压下，DT将完全电离成由D$^+$、T$^+$和电子组成的等离子体。这些粒子只有三个平动自由度，这对应于单原子气体。单原子气体的绝热指数为$\\gamma = 5/3$。\n将该值代入压缩比的表达式：\n$$ \\eta = \\frac{5/3 + 1}{5/3 - 1} = \\frac{8/3}{2/3} = 4 $$\n压缩比恰好是$4$。\n初始密度为$\\rho_0 = 0.25\\,\\mathrm{g/cm^3}$。\n激波压缩后的密度$\\rho_1$是：\n$$ \\rho_1 = \\eta \\cdot \\rho_0 = 4 \\times 0.25\\,\\mathrm{g/cm^3} = 1.0\\,\\mathrm{g/cm^3} $$\n问题要求答案保留四位有效数字。因此，数值结果是$\\rho_1 = 1.000\\,\\mathrm{g/cm^3}$。\n\n关于表格式状态方程影响的定性讨论：\n理想气体模型提供了一个有用的初步近似，但忽略了稠密等离子体中发生的几个重要物理过程。一个真实的、表格式的状态方程（例如ICF模拟中使用的SESAME表）则考虑了这些效应。对于给定条件（激波速度$u_s=30\\,\\mathrm{km/s}$进入低温DT），与理想气体模型最显著的偏差源于电离的能量代价。\n\n1.  **电离能**：$\\gamma=5/3$的理想气体模型隐含地假设气体已是完全电离的单原子粒子集合。实际上，激波传递的能量必须首先用于解离任何分子（例如$D_2$），然后用于电离氘和氚原子。这个电离过程代表了一个巨大的能量汇。对于沉积在激波后的给定总能量，一大部分被分配到电离势能中，而不是粒子的动能（热能）中。这使得材料比理想气体模型预测的更“软”或更易压缩。这种效应可以用一个有效绝热指数$\\gamma_{\\text{eff}} = 1 + p/(\\rho e)$来描述，在电离过程中该指数会低于$5/3$。由于压缩比为$\\eta = (\\gamma_{\\text{eff}}+1)/(\\gamma_{\\text{eff}}-1)$，一个较小的$\\gamma_{\\text{eff}}$会导致一个较高的压缩比。\n\n2.  **其他效应**：在由此产生的高密度（$\\rho_1=1.000\\,\\mathrm{g/cm^3}$）和高温（数百万开尔文）下，其他非理想效应也存在。\n    *   **电子简并**：高电子密度可能导致部分费米简并，此时泡利不相容原理变得重要。这为压力增加了一个分量（简并压力），该分量强烈依赖于密度而不依赖于温度。这种效应提供了额外的压力支撑，使材料变得更“硬”，从而与经典气体相比*减小*了压缩。\n    *   **库仑相互作用**：等离子体足够稠密，使得带电粒子（离子和电子）之间的相互作用不可忽略。与相同密度和温度下的无相互作用粒子的理想气体相比，这些静电相互作用通常会降低总压力，这倾向于*增加*压缩。\n\n**讨论结论**：对于在这些条件下ICF内爆中的第一道激波，区分真实状态方程和理想气体模型的主要效应是电离的能量代价。该效应显著地使状态方程变“软”，导致预测的压缩比远大于理想气体的极限值$4$。其他效应（简并和库仑相互作用）也包含在表格式状态方程中，但对于这个特定的物理区间，它们相对于电离效应是次要的。因此，一个真实的表格式状态方程会预测最终密度$\\rho_1$高于此处计算出的$1.000\\,\\mathrm{g/cm^3}$。",
            "answer": "$$\\boxed{1.000}$$"
        },
        {
            "introduction": "内爆的最终目标是高效地将内聚燃料壳的动能转化为中心热斑的热能，从而达到点火条件。一个简洁而深刻的“能量耦合”模型是分析这一过程效率的核心工具。在这项练习中，您将应用一个联系热斑热力学功（$P_{hs}V_{hs}$）与燃料壳动能（$E_k$）的简化模型，并通过分析给定数据来量化能量耦合效率 $\\eta$。这使您能亲身体验如何用物理模型来解释和评估内爆性能。",
            "id": "3995195",
            "problem": "一位研究人员正在对惯性约束聚变（ICF）中的停滞和热点形成进行建模。在一维球对称条件下，考虑一个减速并将其动能传递给内部热点的质量壳层。从能量守恒、理想气体内能关系和功的力学定义出发。使用以下基本陈述作为起点：功能定理、热力学第一定律以及单原子等离子体的理想气体内能关系。假设球对称性、停滞时存在单一均匀的热点压力，并且热点体积可以很好地近似为球体体积。研究人员寻求一个紧凑模型，以捕捉入射壳层动能如何耦合到热点热力学功中。推导热点热力学功项与入射壳层动能之间的比例关系，并将比例参数定义为一个包含所有损失和非理想性的效率。然后，使用测量数据，为每个数据集估算该效率，并通过约束通过原点的线性回归推断出单一的最佳拟合效率。\n\n您实现的程序必须按顺序执行以下操作：\n1. 对于每个数据集，使用球体几何从测量的热点半径计算热点体积。\n2. 以国际单位制（SI）计算热点热力学功项，其值为测量的热点压力与计算的热点体积的乘积。\n3. 对于每个数据集，以小数形式估算效率参数，该参数为热点热力学功项与测量的壳层动能之间的比例常数。\n4. 通过最小化热点热力学功项与与壳层动能成比例的建模值之间的平方差之和，拟合一个适用于所有数据集的单一全局效率参数，其中比例关系约束为通过原点。\n5. 计算拟合的均方根误差。当残差由所提出模型中的壳层动能尺度进行归一化时，该误差是一个无量纲量。\n\n在整个过程中使用以下定义和单位：\n- 令热点半径为 $R_{hs}$，热点体积为 $V_{hs}$，热点压力为 $P_{hs}$，入射壳层动能为 $E_{k}$。\n- 使用球体体积公式 $V_{hs} = \\dfrac{4}{3}\\pi R_{hs}^{3}$，其中 $R_{hs}$ 的单位为米。\n- 使用帕斯卡（pascals）作为 $P_{hs}$ 的单位，焦耳（joules）作为 $E_{k}$ 的单位，立方米（cubic meters）作为 $V_{hs}$ 的单位。\n- 使用 $1\\,\\mu\\mathrm{m} = 10^{-6}\\,\\mathrm{m}$ 将微米转换为米。\n- 效率参数是无量纲的；报告时以小数形式表示，并四舍五入到六位有效数字。\n\n实现程序以处理以下测试数据集，每个数据集以 $\\left(E_{k}\\, [\\mathrm{J}],\\, P_{hs}\\, [\\mathrm{Pa}],\\, R_{hs}\\, [\\mu\\mathrm{m}]\\right)$ 的形式给出：\n- 案例 A（理想路径）：$\\left(1.5\\times 10^{4},\\, 3.0\\times 10^{13},\\, 30\\right)$\n- 案例 B（中等耦合）：$\\left(8.0\\times 10^{3},\\, 1.5\\times 10^{13},\\, 25\\right)$\n- 案例 C（高压、小半径）：$\\left(2.0\\times 10^{4},\\, 5.0\\times 10^{13},\\, 15\\right)$\n- 案例 D（低能边界）：$\\left(2.0\\times 10^{3},\\, 5.0\\times 10^{12},\\, 20\\right)$\n- 案例 E（大半径）：$\\left(1.2\\times 10^{4},\\, 1.0\\times 10^{13},\\, 40\\right)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须按顺序包括五个按案例估算的效率、全局拟合效率和均方根误差，所有值都表示为四舍五入到六位有效数字的小数。例如，输出格式必须与 $\\left[\\eta_{A},\\eta_{B},\\eta_{C},\\eta_{D},\\eta_{E},\\eta_{\\mathrm{fit}},\\mathrm{RMSE}\\right]$ 完全一样，但使用实际数值。RMSE 必须按如下方式计算\n$$\n\\mathrm{RMSE} = \\sqrt{\\dfrac{1}{N}\\sum_{i=1}^{N}\\left(W_{i}-\\hat{\\eta} E_{k,i}\\right)^{2}},\n$$\n其中 $W_{i}$ 是案例 $i$ 的热点热力学功项，$\\hat{\\eta}$ 是拟合效率，而 $N$ 是数据集的数量。报告 $\\mathrm{RMSE}$ 时，以小数形式表示，四舍五入到六位有效数字，与所有其他结果保持一致。",
            "solution": "所提出的问题要求推导和应用一个用于惯性约束聚变（ICF）热点中能量耦合的简化模型。该模型将内爆壳层的入射动能 $E_k$ 与压缩后热点的热力学状态联系起来，该状态由其压力-体积乘积 $P_{hs}V_{hs}$ 表征。这个乘积具有能量单位，将表示为热力学功项 $W$。问题在于通过估算耦合效率参数 $\\eta$ 来针对几个数据集验证该模型。\n\n基本前提是热力学功项与动能之间存在直接比例关系：\n$$W = \\eta E_k$$\n其中 $W = P_{hs}V_{hs}$。参数 $\\eta$ 是一个无量纲效率，它量化了壳层动能中在停滞时转换为由 $P_{hs}V_{hs}$ 乘积表示的热能的比例。该参数隐含地解释了所有复杂的、非理想的过程，包括辐射损失、热传导以及未明确建模的流体动力学不稳定性。\n\n分析所提供数据的过程结构如下：\n\n首先，对于由 $(E_{k,i}, P_{hs,i}, R_{hs,i})$ 组成的每个数据集 $i$，我们必须确保所有量都采用国际单位制（SI）单位。热点半径 $R_{hs}$ 以微米（$\\mu\\mathrm{m}$）为单位给出，必须使用关系式 $1\\,\\mu\\mathrm{m} = 10^{-6}\\,\\mathrm{m}$ 转换为米（$m$）。\n\n其次，在球形几何的假设下计算热点体积 $V_{hs,i}$：\n$$V_{hs,i} = \\frac{4}{3}\\pi R_{hs,i}^3$$\n$V_{hs,i}$ 的单位将是立方米（$m^3$）。\n\n第三，热力学功项 $W_i$ 计算为热点压力和体积的乘积：\n$$W_i = P_{hs,i} V_{hs,i}$$\n给定 $P_{hs,i}$ 的单位为帕斯卡（$Pa = N/m^2$），$V_{hs,i}$ 的单位为 $m^3$，则 $W_i$ 的结果单位为焦耳（$J$），与能量单位一致。\n\n第四，通过重新排列核心模型方程，为每个数据集估算一个按案例计算的效率 $\\eta_i$：\n$$\\eta_i = \\frac{W_i}{E_{k,i}}$$\n\n第五，通过对 $W_i$ 关于 $E_{k,i}$ 进行线性回归，并约束回归线必须通过原点，来确定一个单一的、具有全局代表性的效率 $\\hat{\\eta}$。这对应于找到最小化误差平方和（SSE） $S(\\hat{\\eta})$ 的 $\\hat{\\eta}$ 值：\n$$S(\\hat{\\eta}) = \\sum_{i=1}^{N} (W_i - \\hat{\\eta} E_{k,i})^2$$\n其中 $N$ 是数据集的数量。为了最小化 $S(\\hat{\\eta})$，我们将其关于 $\\hat{\\eta}$ 的导数设为零：\n$$\\frac{dS}{d\\hat{\\eta}} = \\frac{d}{d\\hat{\\eta}}\\sum_{i=1}^{N} (W_i - \\hat{\\eta} E_{k,i})^2 = \\sum_{i=1}^{N} 2(W_i - \\hat{\\eta} E_{k,i})(-E_{k,i}) = 0$$\n求解 $\\hat{\\eta}$ 得到通过原点的回归斜率的标准公式：\n$$\\hat{\\eta} = \\frac{\\sum_{i=1}^{N} W_i E_{k,i}}{\\sum_{i=1}^{N} E_{k,i}^2}$$\n\n最后，拟合优度通过均方根误差（RMSE）来量化，该误差使用问题陈述中提供的特定公式计算：\n$$\\mathrm{RMSE} = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left(W_{i}-\\hat{\\eta} E_{k,i}\\right)^{2}}$$\n该值表示测量的热力学功项 $W_i$ 与线性模型 $\\hat{\\eta}E_{k,i}$ 预测值之间的偏差的典型量级，单位为焦耳。\n\n将系统地实施这些步骤来处理五个提供的数据集。所有结果数值——五个按案例计算的效率、全局拟合效率和均方根误差——都将报告至六位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef round_to_six_sig_figs(value):\n    \"\"\"\n    Rounds a number to six significant figures and returns it as a float.\n    This is achieved using the 'g' format specifier.\n    \"\"\"\n    return float(f\"{value:.6g}\")\n\ndef solve():\n    \"\"\"\n    Solves the ICF hot-spot energy coupling problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (E_k [J], P_hs [Pa], R_hs [microns])\n    test_cases = [\n        (1.5e4, 3.0e13, 30),  # Case A\n        (8.0e3, 1.5e13, 25),  # Case B\n        (2.0e4, 5.0e13, 15),  # Case C\n        (2.0e3, 5.0e12, 20),  # Case D\n        (1.2e4, 1.0e13, 40),  # Case E\n    ]\n    \n    N = len(test_cases)\n    individual_efficiencies = []\n    kinetic_energies = []\n    work_terms = []\n\n    # Step 1-3: Calculate per-case volume, work, and efficiency\n    for E_k, P_hs, R_hs_microns in test_cases:\n        # Convert radius from micrometers to meters\n        R_hs_m = R_hs_microns * 1e-6\n        \n        # Compute hot-spot volume\n        V_hs = (4.0 / 3.0) * np.pi * (R_hs_m ** 3)\n        \n        # Compute hot-spot thermodynamic work term\n        W = P_hs * V_hs\n        \n        # Estimate per-case efficiency\n        eta = W / E_k\n        \n        individual_efficiencies.append(eta)\n        kinetic_energies.append(E_k)\n        work_terms.append(W)\n\n    work_terms_arr = np.array(work_terms)\n    kinetic_energies_arr = np.array(kinetic_energies)\n\n    # Step 4: Fit a single global efficiency parameter (regression through origin)\n    # eta_fit = (sum(W_i * E_k_i)) / (sum(E_k_i^2))\n    sum_W_Ek = np.sum(work_terms_arr * kinetic_energies_arr)\n    sum_Ek_sq = np.sum(kinetic_energies_arr ** 2)\n    eta_fit = sum_W_Ek / sum_Ek_sq\n\n    # Step 5: Compute the root-mean-square error of the fit\n    residuals = work_terms_arr - eta_fit * kinetic_energies_arr\n    sum_sq_residuals = np.sum(residuals ** 2)\n    rmse = np.sqrt(sum_sq_residuals / N)\n    \n    # Collate all results\n    final_results = individual_efficiencies + [eta_fit, rmse]\n\n    # Format results to six significant figures\n    formatted_results = [round_to_six_sig_figs(res) for res in final_results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, formatted_results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "理想的一维球对称内爆是理解ICF物理的基石，但在现实中，驱动的不均匀性是导致内爆性能下降的关键因素。系统地分析和控制这些不均匀性对于实现点火至关重要。这项练习将指导您使用勒让德多项式分解方法，量化X射线驱动的非对称性，并建立一个模型来计算这些非对称性如何在烧蚀前端转化为扰动。通过这个过程，您将深入理解驱动对称性如何影响内爆的稳定性和最终性能。",
            "id": "3995271",
            "problem": "您需要对一个轴对称的惯性约束聚变 (ICF) 靶腔-靶丸构型进行建模，并计算烧蚀前沿上产生的扰动谱。入射到靶丸表面的X射线驱动表示为极角 $\\,\\theta\\,$ (单位为弧度) 的函数，由一个基线均匀通量加上一组有限的轴对称亮环构成，这些亮环近似了壁再发射和激光入口孔 (LEH) 的贡献。您的任务是构建靶丸上驱动的 Legendre 模式分解，并使用第一性原理线性响应，计算每个 Legendre 模式的时间相关烧蚀前沿扰动振幅。\n\n基本原理：\n- 单位球面上的轴对称标量场可以分解为 Legendre 多项式 $\\,P_\\ell(\\mu)\\,$, 其中 $\\,\\mu = \\cos\\theta\\,$, 其正交性为 $\\int_{-1}^{1} P_\\ell(\\mu) P_m(\\mu)\\,d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}$。\n- 与辐射驱动相关的烧蚀运动学对烧蚀前沿速度 $\\,v_a\\,$ 使用局部幂律定标关系 $\\,v_a = C_v F^\\beta\\,$，其中 $\\,F\\,$ 是局部入射通量，$\\,C_v\\,$ 是一个与材料相关的比例常数，$\\,\\beta\\,$ 是一个在 $\\,\\left[\\frac{1}{3},\\frac{1}{2}\\right]\\,$ 范围内的定标指数，该关系由自相似辐射热波定标证明是合理的。\n- 在半径为 $\\,R\\,$、热扩散率为 $\\,D\\,$ 的球面上，横向热光滑遵循热方程 $\\,\\partial_t T = D \\nabla_s^2 T\\,$。对于轴对称 Legendre 模式 $\\,P_\\ell\\,$，表面拉普拉斯算子的特征值为 $\\,\\ell(\\ell+1)/R^2\\,$，这意味着角度扰动随时间 $\\,t\\,$ 的扩散衰减因子为 $\\,\\exp\\!\\big(-D\\,\\ell(\\ell+1)\\,t/R^2\\big)\\,$。\n\n几何与驱动定义：\n- 设靶丸为半径 $\\,R\\,$（单位为 $\\,\\mathrm{m}\\,$）的球体。\n- 入射通量参数化为\n$$\nF(\\theta) = F_0\\Big(1 + \\sum_{i=1}^{N_r} w_i \\exp\\!\\Big[-\\frac{(\\theta - \\theta_i)^2}{2\\sigma_i^2}\\Big]\\Big),\n$$\n其中 $\\,F_0\\,$（单位为 $\\,\\mathrm{W/m^2}\\,$）是基线均匀驱动，每个环由中心极角 $\\,\\theta_i\\,$（单位为弧度）、无量纲亮度权重 $\\,w_i\\,$ 和角半宽 $\\,\\sigma_i\\,$（单位为弧度）指定。求和索引 $\\,i\\,$ 遍历 $\\,N_r\\,$ 个环。\n\nLegendre 模式分解：\n- 定义 $\\,\\mu = \\cos\\theta\\,$ 和 Legendre 系数 $\\,a_\\ell\\,$ 通过\n$$\na_\\ell = \\frac{2\\ell+1}{2} \\int_{-1}^{1} F(\\mu)\\,P_\\ell(\\mu)\\,d\\mu,\n$$\n其中 $\\,F(\\mu)\\equiv F(\\theta=\\arccos\\mu)\\,$。相对于平均值的模式振幅为 $\\,b_\\ell = \\frac{a_\\ell}{a_0}\\,$，其中 $\\,a_0\\,$ 是球面上的平均通量 $\\,\\big(a_0 = \\frac{1}{2}\\int_{-1}^{1}F(\\mu)\\,d\\mu\\big)\\,$。\n\n烧蚀前沿扰动谱：\n- 使用关于平均驱动的线性化运动学响应 $\\,v_a = C_v F^\\beta\\,$ 和由表面热方程所蕴含的扩散横向光滑，推导并计算 $\\,\\ell \\ge 1\\,$ 的时间相关烧蚀前沿位移振幅 $\\,\\delta R_\\ell(t)\\,$（单位为 $\\,\\mathrm{m}\\,$），作为 $\\,R\\,$, $\\,D\\,$, $\\,t\\,$, $\\,C_v\\,$, $\\,\\beta\\,$ 和驱动谱 $\\,b_\\ell\\,$ 的函数。\n\n数值实现要求：\n- 使用阶数至少为 $\\,N_q = 512\\,$ 的 Gaussian-Legendre 求积法在区间 $\\,\\mu\\in[-1,1]\\,$ 上计算 Legendre 积分。角度必须以弧度为单位。\n- 使用 $\\,P_\\ell(\\mu)\\,$ 的三项递推关系生成最高到 $\\,\\ell_{\\max}\\,$ 的多项式。\n- 确保所有带有物理量纲的输出都以指定的单位表示。\n\n测试套件：\n为以下四个参数集实现计算。每个情况定义了 $\\,F_0\\,$、环列表 $\\,(\\theta_i,w_i,\\sigma_i)\\,$、$\\,\\ell_{\\max}\\,$、$\\,R\\,$、$\\,D\\,$、$\\,\\beta\\,$、$\\,t\\,$ 和 $\\,C_v\\,$。所有角度均以弧度为单位；位移振幅以 $\\,\\mathrm{m}\\,$ 表示。\n\n- 情况 $\\,1\\,$（平衡的近 LEH 环，理想路径）：\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - 环：$\\,[ (\\,\\theta_1=0.3\\,,\\,w_1=0.2\\,,\\,\\sigma_1=0.25\\,), (\\,\\theta_2=\\pi-0.3\\,,\\,w_2=0.2\\,,\\,\\sigma_2=0.25\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 8\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-6}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = \\frac{1}{3}\\,$, $\\,t = 5.0\\times 10^{-9}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.375\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n- 情况 $\\,2\\,$（非对称环主导）：\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - 环：$\\,[ (\\,\\theta_1=0.2\\,,\\,w_1=0.3\\,,\\,\\sigma_1=0.15\\,), (\\,\\theta_2=\\pi-0.6\\,,\\,w_2=0.05\\,,\\,\\sigma_2=0.20\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 10\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-6}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = 0.4\\,$, $\\,t = 5.0\\times 10^{-9}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.35\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n- 情况 $\\,3\\,$（强横向光滑，边缘情况）：\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - 环：$\\,[ (\\,\\theta_1=0.4\\,,\\,w_1=0.25\\,,\\,\\sigma_1=0.10\\,), (\\,\\theta_2=\\pi-0.4\\,,\\,w_2=0.25\\,,\\,\\sigma_2=0.10\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 12\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-4}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = \\frac{1}{3}\\,$, $\\,t = 5.0\\times 10^{-9}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.375\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n- 情况 $\\,4\\,$（短时极限，边界条件）：\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - 环：$\\,[ (\\,\\theta_1=0.3\\,,\\,w_1=0.15\\,,\\,\\sigma_1=0.25\\,), (\\,\\theta_2=\\pi-0.3\\,,\\,w_2=0.15\\,,\\,\\sigma_2=0.25\\,), (\\,\\theta_3=\\frac{\\pi}{2}\\,,\\,w_3=0.05\\,,\\,\\sigma_3=0.20\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 6\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-6}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = 0.33\\,$, $\\,t = 1.0\\times 10^{-12}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.375\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n答案规范：\n- 对每种情况，输出一个浮点数列表 $\\,\\big[\\delta R_1, \\delta R_2, \\dots, \\delta R_{\\ell_{\\max}}\\big]\\,$，单位为 $\\,\\mathrm{m}\\,$。\n- 您的程序应生成单行输出，其中包含所有情况的结果，形式为一个用方括号括起来的逗号分隔列表，其中每个元素是特定情况的列表（例如，$\\,[ [x_1,x_2], [y_1,y_2] ]\\,$）。不应打印任何附加文本。",
            "solution": "## 问题验证\n\n### 步骤 1：提取给定条件\n问题提供了以下数据、定义和条件：\n\n**基本原理：**\n- **分解：** 单位球面上的轴对称标量场使用 Legendre 多项式 $P_\\ell(\\mu)$ 进行分解，其中 $\\mu = \\cos\\theta$。\n- **正交性：** $\\int_{-1}^{1} P_\\ell(\\mu) P_m(\\mu)\\,d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}$。\n- **烧蚀运动学：** 烧蚀前沿速度 $v_a$ 遵循幂律定标关系 $v_a = C_v F^\\beta$，其中 $F$ 是局部入射通量，$C_v$ 是一个常数，$\\beta \\in \\left[\\frac{1}{3},\\frac{1}{2}\\right]$。\n- **热光滑：** 横向热光滑由半径为 $R$、热扩散率为 $D$ 的球面上的表面热方程 $\\partial_t T = D \\nabla_s^2 T$ 控制。模式 $\\ell$ 对应的扩散衰减因子为 $\\exp(-D\\,\\ell(\\ell+1)\\,t/R^2)$。\n\n**几何与驱动：**\n- **靶丸半径：** $R$ (单位为 $\\mathrm{m}$)。\n- **入射通量：** $F(\\theta) = F_0\\Big(1 + \\sum_{i=1}^{N_r} w_i \\exp\\!\\Big[-\\frac{(\\theta - \\theta_i)^2}{2\\sigma_i^2}\\Big]\\Big)$，其中 $F_0$ 是基线均匀驱动 (单位为 $\\mathrm{W/m^2}$)，$N_r$ 个环中的每一个都由中心角 $\\theta_i$、权重 $w_i$ 和宽度 $\\sigma_i$ 定义。\n\n**数学定义：**\n- **Legendre 系数：** $a_\\ell = \\frac{2\\ell+1}{2} \\int_{-1}^{1} F(\\mu)\\,P_\\ell(\\mu)\\,d\\mu$，其中 $F(\\mu)\\equiv F(\\theta=\\arccos\\mu)$。\n- **相对振幅：** $b_\\ell = \\frac{a_\\ell}{a_0}$，其中 $a_0 = \\frac{1}{2}\\int_{-1}^{1}F(\\mu)\\,d\\mu$ 是平均通量。\n\n**数值要求：**\n- **求积阶数：** 阶数为 $N_q = 512$ 的 Gaussian-Legendre 求积。\n- **Legendre 多项式生成：** 使用三项递推关系为 $P_\\ell(\\mu)$ 生成高达指定 $\\ell_{\\max}$ 的多项式。\n\n**任务：**\n计算时间相关的烧蚀前沿位移振幅 $\\delta R_\\ell(t)$ (单位为 $\\mathrm{m}$)，其中 $\\ell \\in [1, \\ell_{\\max}]$。\n\n**测试套件（4 种情况）：**\n- **情况 1：** $F_0 = 5.0\\times 10^{14}$, 环: $[(0.3, 0.2, 0.25), (\\pi-0.3, 0.2, 0.25)]$, $\\ell_{\\max} = 8$, $R = 10^{-3}$, $D = 5\\times 10^{-6}$, $\\beta = 1/3$, $t = 5\\times 10^{-9}$, $C_v = 0.375$。\n- **情况 2：** $F_0 = 5.0\\times 10^{14}$, 环: $[(0.2, 0.3, 0.15), (\\pi-0.6, 0.05, 0.20)]$, $\\ell_{\\max} = 10$, $R = 10^{-3}$, $D = 5\\times 10^{-6}$, $\\beta = 0.4$, $t = 5\\times 10^{-9}$, $C_v = 0.35$。\n- **情况 3：** $F_0 = 5.0\\times 10^{14}$, 环: $[(0.4, 0.25, 0.10), (\\pi-0.4, 0.25, 0.10)]$, $\\ell_{\\max} = 12$, $R = 10^{-3}$, $D = 5\\times 10^{-4}$, $\\beta = 1/3$, $t = 5\\times 10^{-9}$, $C_v = 0.375$。\n- **情况 4：** $F_0 = 5.0\\times 10^{14}$, 环: $[(0.3, 0.15, 0.25), (\\pi-0.3, 0.15, 0.25), (\\pi/2, 0.05, 0.20)]$, $\\ell_{\\max} = 6$, $R = 10^{-3}$, $D = 5\\times 10^{-6}$, $\\beta = 0.33$, $t = 10^{-12}$, $C_v = 0.375$。\n\n### 步骤 2：使用提取的给定条件进行验证\n根据指定标准对问题进行评估：\n- **科学依据：** 该问题基于计算等离子体物理和惯性约束聚变的既定原理。所提出的模型——轴对称场的 Legendre 分解、辐射烧蚀的幂律定标和热输运的扩散光滑——是相关物理的标准（尽管是简化的）表示。参数值在 ICF 场景的物理合理范围内。该问题不违反任何科学原理。\n- **良态性：** 该问题是良态的。它提供了所有必需的输入参数和一个明确的目标：计算一组特定的物理量（$\\delta R_\\ell(t)$）。推导路径由所提供的物理模型唯一确定，每个测试用例都存在唯一解。\n- **客观性：** 问题以精确、客观和正式的语言陈述，不含任何主观或基于意见的内容。术语定义清晰。\n- **完整性与一致性：** 问题是自洽的。求解所需的所有常数、方程和参数都为每种情况明确提供。没有内部矛盾。\n- **真实性与可行性：** 物理场景是该领域的标准理想化。所提供的数据在量纲上一致且物理上合理。\n- **结构：** 问题结构良好，通过逻辑步骤序列引导求解者从初始驱动定义到最终的扰动振幅。\n\n### 步骤 3：结论与行动\n问题被判定为 **有效**。这是一个在计算聚变科学领域中合理、良态且自洽的问题。可以开始求解过程。\n\n---\n\n### 推导与求解策略\n\n求解需要一个多步骤过程，从入射通量分布开始，最终计算出每个 Legendre 模式的烧蚀前沿位移振幅。\n\n**1. X射线驱动的 Legendre 分解**\n入射通量 $F(\\theta)$ 是靶丸表面的一个轴对称函数。它可以分解为一系列 Legendre 多项式 $P_\\ell(\\mu)$，其中 $\\mu = \\cos\\theta$：\n$$\nF(\\mu) = \\sum_{\\ell=0}^{\\infty} a_\\ell P_\\ell(\\mu)\n$$\n系数 $a_\\ell$ 可通过利用 Legendre 多项式的正交性求得：\n$$\na_\\ell = \\frac{2\\ell+1}{2} \\int_{-1}^{1} F(\\mu) P_\\ell(\\mu) \\,d\\mu\n$$\n问题提供了 $F(\\theta)$ 的函数形式，我们可以将其写为 $F(\\mu) = F(\\theta=\\arccos \\mu)$。$a_\\ell$ 的积分必须按规定使用 Gaussian-Legendre 求积法进行数值计算。系数 $a_0$ 对应于球面的平均通量。对于每个模式 $\\ell \\geq 1$，归一化扰动振幅由 $b_\\ell = a_\\ell / a_0$ 给出。\n\n**2. 扰动的时间相关演化**\n问题指出，角度扰动会受到横向热光滑的影响。给定模式 $\\ell$ 在烧蚀前沿的有效通量扰动不是静态的，而是由于这种扩散过程而随时间衰减。衰减由因子 $\\exp(-D\\,\\ell(\\ell+1)\\,t/R^2)$ 描述。因此，模式 $\\ell$ 在时间 $t$ 的通量扰动振幅为：\n$$\n\\delta F_\\ell(t) = a_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right)\n$$\n烧蚀前沿的总通量作为角度和时间的函数是平均通量与随时间演化的扰动之和：\n$$\nF(\\mu, t) = a_0 + \\sum_{\\ell=1}^{\\ell_{\\max}} \\delta F_\\ell(t) P_\\ell(\\mu) = a_0 + \\sum_{\\ell=1}^{\\ell_{\\max}} a_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right) P_\\ell(\\mu)\n$$\n\n**3. 线性化烧蚀速度**\n烧蚀前沿速度 $v_a$ 通过幂律 $v_a = C_v F^\\beta$ 与通量 $F$ 相关。为了找到对小扰动的响应，我们在平均通量 $a_0$ 附近对该表达式进行线性化。设 $F(\\mu, t) = a_0(1 + \\epsilon(\\mu, t))$，其中 $\\epsilon(\\mu, t) = (F(\\mu, t) - a_0) / a_0 \\ll 1$。\n$$\nv_a(\\mu, t) = C_v [a_0(1 + \\epsilon(\\mu, t))]^\\beta = C_v a_0^\\beta (1 + \\epsilon(\\mu, t))^\\beta\n$$\n对小的 $x$ 使用二项式近似 $(1+x)^k \\approx 1+kx$：\n$$\nv_a(\\mu, t) \\approx C_v a_0^\\beta (1 + \\beta \\epsilon(\\mu, t)) = v_{a,0} + \\beta v_{a,0} \\frac{F(\\mu, t) - a_0}{a_0}\n$$\n其中 $v_{a,0} = C_v a_0^\\beta$ 是平均烧蚀速度。烧蚀速度的扰动 $\\delta v_a(\\mu, t) = v_a(\\mu, t) - v_{a,0}$ 为：\n$$\n\\delta v_a(\\mu, t) \\approx \\frac{\\beta v_{a,0}}{a_0} \\sum_{\\ell=1}^{\\ell_{\\max}} a_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right) P_\\ell(\\mu)\n$$\n因此，模式 $\\ell$ 的烧蚀速度扰动振幅为：\n$$\n\\delta v_{a,\\ell}(t) = \\frac{\\beta v_{a,0}}{a_0} a_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right) = \\beta v_{a,0} b_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right)\n$$\n\n**4. 烧蚀前沿位移振幅**\n烧蚀前沿的位移 $\\delta R(\\mu,t)$ 是速度扰动 $\\delta v_a(\\mu,t)$ 的时间积分。每个模式的振幅 $\\delta R_\\ell(t)$ 是速度振幅 $\\delta v_{a,\\ell}(t)$ 的时间积分：\n$$\n\\delta R_\\ell(t) = \\int_0^t \\delta v_{a,\\ell}(t') \\,dt' = \\int_0^t \\beta v_{a,0} b_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t'}{R^2}\\right) \\,dt'\n$$\n进行积分：\n$$\n\\delta R_\\ell(t) = \\beta v_{a,0} b_\\ell \\left[ -\\frac{R^2}{D\\ell(\\ell+1)} \\exp\\left(-\\frac{D\\ell(\\ell+1)t'}{R^2}\\right) \\right]_0^t\n$$\n$$\n\\delta R_\\ell(t) = \\beta v_{a,0} b_\\ell \\frac{R^2}{D\\ell(\\ell+1)} \\left(1 - \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right)\\right)\n$$\n这是模式 $\\ell \\ge 1$ 的烧蚀前沿位移振幅的最终表达式。\n\n**5. 数值实现细节**\n对于每个测试用例，算法按以下步骤进行：\n1.  使用 `numpy.polynomial.legendre.leggauss` 在 $[-1, 1]$ 上设置一个包含 $N_q=512$ 个求积点 $\\mu_j$ 和权重 $w_j$ 的网格。\n2.  使用三项递推关系在所有求积点上生成 $\\ell = 0, \\dots, \\ell_{\\max}$ 的 Legendre 多项式 $P_\\ell(\\mu_j)$ 的值。\n3.  在所有求积点上评估通量函数 $F(\\mu_j)$。\n4.  通过数值计算积分 $a_\\ell = \\frac{2\\ell+1}{2} \\sum_{j=1}^{N_q} w_j F(\\mu_j) P_\\ell(\\mu_j)$ 来计算系数 $a_\\ell$。\n5.  提取平均通量 $a_0$。\n6.  计算平均烧蚀速度 $v_{a,0} = C_v a_0^\\beta$。\n7.  对于每个模式 $\\ell = 1, \\dots, \\ell_{\\max}$，计算相对振幅 $b_\\ell = a_\\ell/a_0$，然后使用推导出的公式计算位移 $\\delta R_\\ell(t)$。\n8.  为了数值稳定性，当指数参数 $x = \\frac{D\\ell(\\ell+1)t}{R^2}$ 非常小时，项 $(1 - e^{-x}) / x$ 趋近于 1。积分项 $\\frac{R^2}{D\\ell(\\ell+1)}(1-e^{-x})$ 趋近于 $t$。将处理此极限以避免浮点抵消错误，例如，通过使用 `numpy.expm1` 或对小参数进行条件检查。\n\n此结构化过程将在 Python 中实现，以求解测试套件中给出的参数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ablation-front perturbation spectrum for an ICF capsule\n    driven by an axisymmetric x-ray flux.\n    \"\"\"\n\n    # Numerical quadrature order as specified\n    N_q = 512\n\n    # Test cases from the problem statement\n    test_cases = [\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.3, 0.2, 0.25), (np.pi - 0.3, 0.2, 0.25)],\n            \"ell_max\": 8, \"R\": 1.0e-3, \"D\": 5.0e-6, \"beta\": 1.0/3.0,\n            \"t\": 5.0e-9, \"Cv\": 0.375\n        },\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.2, 0.3, 0.15), (np.pi - 0.6, 0.05, 0.20)],\n            \"ell_max\": 10, \"R\": 1.0e-3, \"D\": 5.0e-6, \"beta\": 0.4,\n            \"t\": 5.0e-9, \"Cv\": 0.35\n        },\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.4, 0.25, 0.10), (np.pi - 0.4, 0.25, 0.10)],\n            \"ell_max\": 12, \"R\": 1.0e-3, \"D\": 5.0e-4, \"beta\": 1.0/3.0,\n            \"t\": 5.0e-9, \"Cv\": 0.375\n        },\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.3, 0.15, 0.25), (np.pi - 0.3, 0.15, 0.25), (np.pi/2.0, 0.05, 0.20)],\n            \"ell_max\": 6, \"R\": 1.0e-3, \"D\": 5.0e-6, \"beta\": 0.33,\n            \"t\": 1.0e-12, \"Cv\": 0.375\n        }\n    ]\n\n    all_results = []\n    \n    # Get Gaussian-Legendre quadrature nodes (mu) and weights\n    mu_nodes, weights = np.polynomial.legendre.leggauss(N_q)\n\n    for case in test_cases:\n        F0 = case[\"F0\"]\n        rings = case[\"rings\"]\n        ell_max = case[\"ell_max\"]\n        R = case[\"R\"]\n        D = case[\"D\"]\n        beta = case[\"beta\"]\n        t = case[\"t\"]\n        Cv = case[\"Cv\"]\n\n        # 1. Generate Legendre polynomials P_l(mu) using three-term recurrence\n        P_l_mu = np.zeros((ell_max + 1, N_q))\n        P_l_mu[0, :] = 1.0\n        if ell_max  0:\n            P_l_mu[1, :] = mu_nodes\n        for l in range(1, ell_max):\n            P_l_mu[l + 1, :] = ((2 * l + 1) * mu_nodes * P_l_mu[l, :] - l * P_l_mu[l - 1, :]) / (l + 1)\n\n        # 2. Define and evaluate the flux function F(mu)\n        theta_nodes = np.arccos(mu_nodes)\n        flux_perturbation = np.zeros(N_q)\n        for theta_i, w_i, sigma_i in rings:\n            flux_perturbation += w_i * np.exp(-(theta_nodes - theta_i)**2 / (2 * sigma_i**2))\n        \n        F_mu = F0 * (1.0 + flux_perturbation)\n\n        # 3. Compute Legendre coefficients a_l\n        a_coeffs = np.zeros(ell_max + 1)\n        l_range = np.arange(ell_max + 1)\n        # Numerical integration: integral(F * P_l) dmu ~= sum(weights * F * P_l)\n        integrals = np.sum(weights[:, np.newaxis] * F_mu[:, np.newaxis] * P_l_mu.T, axis=0)\n        a_coeffs = (2 * l_range + 1) / 2.0 * integrals\n\n        # 4. Calculate perturbation displacements delta_R_l\n        a0 = a_coeffs[0]\n        v_a0 = Cv * (a0**beta)\n\n        delta_R_l_list = []\n        for l in range(1, ell_max + 1):\n            b_l = a_coeffs[l] / a0\n\n            # Calculate the time-integrated-and-smoothed term\n            exponent_arg = D * l * (l + 1) * t / (R**2)\n            \n            # For small arguments x = exponent_arg, the term (1 - exp(-x)) can lead to\n            # catastrophic cancellation, making the calculation unstable.\n            # The limit of the integral as x -> 0 is t. We use this for small arguments.\n            if exponent_arg  1e-8: # For small arguments, use the limit to ensure stability.\n                time_integral_term = t\n            else: # For larger arguments, the full formula is stable.\n                time_integral_term = (R**2 / (D * l * (l + 1))) * (1.0 - np.exp(-exponent_arg))\n\n            delta_R_l = beta * v_a0 * b_l * time_integral_term\n            delta_R_l_list.append(delta_R_l)\n            \n        all_results.append(delta_R_l_list)\n\n    # Format output as a list of lists, matching the example format logic\n    # e.g., [[val1, val2],[val3,val4]]\n    # This is achieved by creating a string from each inner list, joining them with commas,\n    # and enclosing the result in brackets.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}