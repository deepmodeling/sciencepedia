{
    "hands_on_practices": [
        {
            "introduction": "The journey of an ICF implosion begins with the launching of powerful shock waves that compress the fuel. This first practice delves into the fundamental physics governing this process by applying the Rankine-Hugoniot relations to a strong shock, a cornerstone of fluid dynamics . By deriving the compression for an idealized plasma and contrasting it with the behavior of real materials, you'll build a foundational understanding of shock heating and the critical role of ionization in the initial stages of compression.",
            "id": "3995233",
            "problem": "A planar, steady normal shock propagates into initially quiescent deuterium–tritium (DT) at temperature $T_0=20\\,\\mathrm{K}$ and mass density $\\rho_0=0.25\\,\\mathrm{g/cm^3}$, representative of cryogenic DT in an Inertial Confinement Fusion (ICF) target. The shock speed is $u_s=30\\,\\mathrm{km/s}$. Assume the downstream DT can be modeled by an ideal $\\gamma$-law Equation of State (EOS), $p=(\\gamma-1)\\rho e$, with $\\gamma$ appropriate for a monatomic ideal gas, and treat the upstream pressure and internal energy as negligible compared to the post-shock state. Starting from the conservation of mass, momentum, and energy across a steady planar shock (the Rankine–Hugoniot relations) and the ideal $\\gamma$-law EOS, derive the compression ratio and use it to compute the shock-compressed density $\\rho_1$ for this strong shock. Round your final numerical density to four significant figures and express it in $\\mathrm{g/cm^3}$. Briefly discuss, in qualitative terms, how a tabular DT EOS would modify the ideal-gas prediction under these conditions and why.",
            "solution": "The problem requires the derivation of the shock-compressed density of a deuterium-tritium (DT) mixture under strong shock conditions, first using an ideal gas model and then discussing qualitatively the modifications introduced by a more realistic tabular Equation of State (EOS).\n\nFirst, we state the Rankine–Hugoniot relations, which express the conservation of mass, momentum, and energy across a steady, planar shock front. We analyze the shock in a frame of reference where the shock is stationary. In this frame, the upstream fluid (state $0$) moves towards the shock with speed $v_0 = u_s$, where $u_s$ is the shock speed in the lab frame. The downstream fluid (state $1$) moves away from the shock with speed $v_1$. The relations are:\n1.  Conservation of mass: $\\rho_0 v_0 = \\rho_1 v_1$\n2.  Conservation of momentum: $p_0 + \\rho_0 v_0^2 = p_1 + \\rho_1 v_1^2$\n3.  Conservation of energy: $h_0 + \\frac{1}{2}v_0^2 = h_1 + \\frac{1}{2}v_1^2$, where $h = e + p/\\rho$ is the specific enthalpy.\n\nThe problem specifies the strong shock approximation, where the upstream pressure $p_0$ and internal energy $e_0$ (and thus enthalpy $h_0$) are considered negligible compared to their post-shock counterparts. Applying this approximation ($p_0 \\to 0$, $h_0 \\to 0$), the Rankine–Hugoniot relations simplify to:\n$$ \\rho_0 v_0 = \\rho_1 v_1 \\quad (1) $$\n$$ \\rho_0 v_0^2 = p_1 + \\rho_1 v_1^2 \\quad (2) $$\n$$ \\frac{1}{2}v_0^2 = h_1 + \\frac{1}{2}v_1^2 \\quad (3) $$\n\nWe use the ideal $\\gamma$-law EOS for the downstream state, $p_1 = (\\gamma-1)\\rho_1 e_1$. The specific enthalpy is $h_1 = e_1 + p_1/\\rho_1$. Substituting for $e_1$, we get $h_1 = \\frac{p_1}{(\\gamma-1)\\rho_1} + \\frac{p_1}{\\rho_1} = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1}$.\nSubstituting this expression for $h_1$ into the energy equation ($3$):\n$$ \\frac{1}{2}v_0^2 = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1} + \\frac{1}{2}v_1^2 \\quad (4) $$\n\nNow we solve this system of equations for the compression ratio, $\\eta = \\rho_1 / \\rho_0$.\nFrom ($1$), we have $v_1 = \\frac{\\rho_0}{\\rho_1} v_0 = \\frac{v_0}{\\eta}$.\nFrom ($2$), we can express the post-shock pressure $p_1$ as:\n$$ p_1 = \\rho_0 v_0^2 - \\rho_1 v_1^2 = \\rho_0 v_0^2 - (\\eta \\rho_0) \\left(\\frac{v_0}{\\eta}\\right)^2 = \\rho_0 v_0^2 - \\frac{\\rho_0 v_0^2}{\\eta} = \\rho_0 v_0^2 \\left(1 - \\frac{1}{\\eta}\\right) $$\nAlternatively, from ($1$) and ($2$): $p_1 = \\rho_0 v_0 (v_0 - v_1)$.\n\nLet's manipulate the equations to find a simple relation between velocities. We substitute the expression for $p_1$ from the momentum equation into the energy equation ($4$). It is more direct to first express $p_1$ from the energy equation:\n$p_1 = \\frac{(\\gamma-1)\\rho_1}{\\gamma} \\left(\\frac{1}{2}v_0^2 - \\frac{1}{2}v_1^2\\right) = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0^2 - v_1^2)$.\nNow, we equate the two expressions for $p_1$:\n$$ \\rho_0 v_0 (v_0 - v_1) = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0 - v_1)(v_0 + v_1) $$\nSince a shock must exist, $v_1 \\neq v_0$, so we can divide by $(v_0 - v_1)$:\n$$ \\rho_0 v_0 = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0 + v_1) $$\nUsing the mass conservation relation $\\rho_0 v_0 = \\rho_1 v_1$:\n$$ \\rho_1 v_1 = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0 + v_1) $$\nWe can cancel $\\rho_1$ as it is non-zero:\n$$ v_1 = \\frac{\\gamma-1}{2\\gamma}(v_0 + v_1) $$\n$$ 2\\gamma v_1 = (\\gamma-1)v_0 + (\\gamma-1)v_1 $$\n$$ v_1 (2\\gamma - (\\gamma-1)) = v_0 (\\gamma-1) $$\n$$ v_1 (\\gamma+1) = v_0 (\\gamma-1) $$\nThis gives the velocity ratio:\n$$ \\frac{v_1}{v_0} = \\frac{\\gamma-1}{\\gamma+1} $$\nThe compression ratio is $\\eta = \\rho_1 / \\rho_0$. From mass conservation ($1$), $\\eta = v_0 / v_1$. Therefore, for a strong shock in an ideal gas:\n$$ \\eta = \\frac{\\rho_1}{\\rho_0} = \\frac{\\gamma+1}{\\gamma-1} $$\nThe problem states the DT is a monatomic ideal gas. Under the high temperatures and pressures behind the shock, the DT will be fully ionized into a plasma of D$^+$, T$^+$, and electrons. These particles have only three translational degrees of freedom, which corresponds to a monatomic gas. The adiabatic index for a monatomic gas is $\\gamma = 5/3$.\nSubstituting this value into the expression for the compression ratio:\n$$ \\eta = \\frac{5/3 + 1}{5/3 - 1} = \\frac{8/3}{2/3} = 4 $$\nThe compression ratio is exactly $4$.\nThe initial density is given as $\\rho_0 = 0.25\\,\\mathrm{g/cm^3}$.\nThe shock-compressed density $\\rho_1$ is:\n$$ \\rho_1 = \\eta \\cdot \\rho_0 = 4 \\times 0.25\\,\\mathrm{g/cm^3} = 1.0\\,\\mathrm{g/cm^3} $$\nThe problem asks for the answer to four significant figures. Thus, the numerical result is $\\rho_1 = 1.000\\,\\mathrm{g/cm^3}$.\n\nQualitative discussion on the effect of a tabular EOS:\nThe ideal gas model provides a useful first approximation but neglects several important physical processes that occur in dense plasmas. A real, tabular EOS, such as those used in ICF simulations (e.g., SESAME tables), accounts for these effects. For the given conditions (shock speed $u_s=30\\,\\mathrm{km/s}$ into cryogenic DT), the most significant deviation from the ideal gas model arises from the energy cost of ionization.\n\n1.  **Ionization Energy**: The ideal gas model with $\\gamma=5/3$ implicitly assumes the gas is already a fully ionized collection of monatomic particles. In reality, the energy delivered by the shock must first be used to dissociate any molecules (e.g., $D_2$) and then to ionize the deuterium and tritium atoms. This ionization process represents a large energy sink. For a given total energy deposited behind the shock, a significant fraction is partitioned into potential energy of ionization rather than kinetic energy (thermal energy) of the particles. This makes the material \"softer\" or more compressible than the ideal gas model predicts. This effect can be described by an effective adiabatic index, $\\gamma_{\\text{eff}} = 1 + p/(\\rho e)$, which would be lower than $5/3$ during the ionization process. As the compression is $\\eta = (\\gamma_{\\text{eff}}+1)/(\\gamma_{\\text{eff}}-1)$, a lower $\\gamma_{\\text{eff}}$ results in a higher compression ratio.\n\n2.  **Other Effects**: At the resulting high densities ($\\rho_1=1.000\\,\\mathrm{g/cm^3}$) and temperatures (several million Kelvin), other non-ideal effects are also present.\n    *   **Electron Degeneracy**: The high density of electrons can lead to partial Fermi degeneracy, where the Pauli exclusion principle becomes important. This adds a component to the pressure (degeneracy pressure) that depends strongly on density but not temperature. This effect provides additional pressure support, making the material \"stiffer\" and thus *reducing* compression compared to a classical gas.\n    - **Coulomb Interactions**: The plasma is dense enough that interactions between charged particles (ions and electrons) are non-negligible. These electrostatic interactions typically lower the total pressure compared to an ideal gas of non-interacting particles at the same density and temperature, which would tend to *increase* compression.\n\n**Conclusion of Discussion**: For the first shock in an ICF implosion under these conditions, the dominant effect differentiating the real EOS from the ideal gas model is the energy cost of ionization. This effect significantly softens the EOS, leading to a predicted compression ratio that is substantially greater than the ideal gas limit of $4$. The other effects (degeneracy and Coulomb interactions) are also included in a tabular EOS but are secondary to the ionization effect for this specific physical regime. Therefore, a real tabular EOS would predict a final density $\\rho_1$ that is higher than the $1.000\\,\\mathrm{g/cm^3}$ calculated here.",
            "answer": "$$\\boxed{1.000}$$"
        },
        {
            "introduction": "A perfectly uniform implosion is the ideal, but in reality, the X-ray drive inside a hohlraum is never perfectly symmetric. This practice explores how to quantify these crucial drive asymmetries and predict their initial consequences for the capsule . You will use Legendre polynomials to decompose a model drive profile and then apply a linear physics model, incorporating thermal smoothing, to calculate the resulting perturbation spectrum at the ablation front, providing direct insight into the origins of hydrodynamic instabilities.",
            "id": "3995271",
            "problem": "You are to model an axisymmetric Inertial Confinement Fusion (ICF) hohlraum-capsule configuration and compute the resulting perturbation spectrum at the ablation front. The incident x-ray drive on the capsule surface is represented as a function of the polar angle $\\,\\theta\\,$ (in radians) by a baseline uniform flux plus a finite set of axisymmetric bright rings that approximate wall re-emission and Laser Entrance Hole (LEH) contributions. Your tasks are to construct a Legendre-mode decomposition of the drive on the capsule and, using first-principles linear response, compute the time-dependent ablation-front perturbation amplitudes for each Legendre mode.\n\nFundamental base:\n- Axisymmetric scalar fields on the unit sphere admit a decomposition in Legendre polynomials $\\,P_\\ell(\\mu)\\,$, where $\\,\\mu = \\cos\\theta\\,$, with orthogonality $\\int_{-1}^{1} P_\\ell(\\mu) P_m(\\mu)\\,d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}$.\n- Radiative drive-dependent ablation kinematics use a local power-law scaling $\\,v_a = C_v F^\\beta\\,$ for ablation-front speed $\\,v_a\\,$, with $\\,F\\,$ the local incident flux, $\\,C_v\\,$ a material-dependent proportionality constant, and $\\,\\beta\\,$ a scaling exponent in the range $\\,\\left[\\frac{1}{3},\\frac{1}{2}\\right]\\,$, justified by self-similar radiative heat wave scalings.\n- Lateral thermal smoothing on a spherical surface with radius $\\,R\\,$ and thermal diffusivity $\\,D\\,$ follows the heat equation $\\,\\partial_t T = D \\nabla_s^2 T\\,$. For axisymmetric Legendre modes $\\,P_\\ell\\,$, the surface Laplacian eigenvalue is $\\,\\ell(\\ell+1)/R^2\\,$, implying diffusive decay factor $\\,\\exp\\!\\big(-D\\,\\ell(\\ell+1)\\,t/R^2\\big)\\,$ of angular perturbations over time $\\,t\\,$.\n\nGeometry and drive definition:\n- Let the capsule be a sphere of radius $\\,R\\,$ (in $\\,\\mathrm{m}\\,$).\n- The incident flux is parameterized as\n$$\nF(\\theta) = F_0\\Big(1 + \\sum_{i=1}^{N_r} w_i \\exp\\!\\Big[-\\frac{(\\theta - \\theta_i)^2}{2\\sigma_i^2}\\Big]\\Big),\n$$\nwhere $\\,F_0\\,$ (in $\\,\\mathrm{W/m^2}\\,$) is the baseline uniform drive, each ring is specified by center polar angle $\\,\\theta_i\\,$ (in radians), dimensionless brightness weight $\\,w_i\\,$, and angular half-width $\\,\\sigma_i\\,$ (in radians). The summation index $\\,i\\,$ runs over $\\,N_r\\,$ rings.\n\nLegendre-mode decomposition:\n- Define $\\,\\mu = \\cos\\theta\\,$ and the Legendre coefficients $\\,a_\\ell\\,$ via\n$$\na_\\ell = \\frac{2\\ell+1}{2} \\int_{-1}^{1} F(\\mu)\\,P_\\ell(\\mu)\\,d\\mu,\n$$\nwith $\\,F(\\mu)\\equiv F(\\theta=\\arccos\\mu)\\,$. The mode amplitudes relative to the mean are $\\,b_\\ell = \\frac{a_\\ell}{a_0}\\,$, where $\\,a_0\\,$ is the mean flux on the sphere $\\,\\big(a_0 = \\frac{1}{2}\\int_{-1}^{1}F(\\mu)\\,d\\mu\\big)\\,$.\n\nAblation-front perturbation spectrum:\n- Using the linearized kinematic response $\\,v_a = C_v F^\\beta\\,$ about the mean drive and the diffusive lateral smoothing implied by the surface heat equation, derive and compute the time-dependent ablation-front displacement amplitudes $\\,\\delta R_\\ell(t)\\,$ (in $\\,\\mathrm{m}\\,$) for $\\,\\ell \\ge 1\\,$, as functions of $\\,R\\,$, $\\,D\\,$, $\\,t\\,$, $\\,C_v\\,$, $\\,\\beta\\,$, and the drive spectrum $\\,b_\\ell\\,$.\n\nNumerical implementation requirements:\n- Compute the Legendre integrals using Gaussian-Legendre quadrature of order at least $\\,N_q = 512\\,$ on the interval $\\,\\mu\\in[-1,1]\\,$. Angles must be in radians.\n- Use the three-term recurrence for $\\,P_\\ell(\\mu)\\,$ to generate polynomials up to $\\,\\ell_{\\max}\\,$.\n- Ensure all outputs that carry physical dimensions are expressed in the specified units.\n\nTest suite:\nImplement the computation for the following four parameter sets. Each case defines $\\,F_0\\,$, the list of rings $\\,(\\theta_i,w_i,\\sigma_i)\\,$, $\\,\\ell_{\\max}\\,$, $\\,R\\,$, $\\,D\\,$, $\\,\\beta\\,$, $\\,t\\,$, and $\\,C_v\\,$. All angles are in radians; express displacement amplitudes in $\\,\\mathrm{m}\\,$.\n\n- Case $\\,1\\,$ (balanced near-LEH rings, happy path):\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - Rings: $\\,[ (\\,\\theta_1=0.3\\,,\\,w_1=0.2\\,,\\,\\sigma_1=0.25\\,), (\\,\\theta_2=\\pi-0.3\\,,\\,w_2=0.2\\,,\\,\\sigma_2=0.25\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 8\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-6}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = \\frac{1}{3}\\,$, $\\,t = 5.0\\times 10^{-9}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.375\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n- Case $\\,2\\,$ (asymmetric ring dominance):\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - Rings: $\\,[ (\\,\\theta_1=0.2\\,,\\,w_1=0.3\\,,\\,\\sigma_1=0.15\\,), (\\,\\theta_2=\\pi-0.6\\,,\\,w_2=0.05\\,,\\,\\sigma_2=0.20\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 10\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-6}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = 0.4\\,$, $\\,t = 5.0\\times 10^{-9}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.35\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n- Case $\\,3\\,$ (strong lateral smoothing, edge case):\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - Rings: $\\,[ (\\,\\theta_1=0.4\\,,\\,w_1=0.25\\,,\\,\\sigma_1=0.10\\,), (\\,\\theta_2=\\pi-0.4\\,,\\,w_2=0.25\\,,\\,\\sigma_2=0.10\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 12\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-4}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = \\frac{1}{3}\\,$, $\\,t = 5.0\\times 10^{-9}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.375\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n- Case $\\,4\\,$ (short-time limit, boundary condition):\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - Rings: $\\,[ (\\,\\theta_1=0.3\\,,\\,w_1=0.15\\,,\\,\\sigma_1=0.25\\,), (\\,\\theta_2=\\pi-0.3\\,,\\,w_2=0.15\\,,\\,\\sigma_2=0.25\\,), (\\,\\theta_3=\\frac{\\pi}{2}\\,,\\,w_3=0.05\\,,\\,\\sigma_3=0.20\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 6\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-6}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = 0.33\\,$, $\\,t = 1.0\\times 10^{-12}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.375\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\nAnswer specification:\n- For each case, output a list $\\,\\big[\\delta R_1, \\delta R_2, \\dots, \\delta R_{\\ell_{\\max}}\\big]\\,$ of floating-point numbers in $\\,\\mathrm{m}\\,$.\n- Your program should produce a single line of output containing the results of all cases as a comma-separated list enclosed in square brackets, where each element is the case-specific list (for example, $\\,[ [x_1,x_2], [y_1,y_2] ]\\,$). No additional text should be printed.",
            "solution": "## PROBLEM VALIDATION\n\n### Step 1: Extract Givens\nThe problem provides the following data, definitions, and conditions:\n\n**Fundamental Principles:**\n- **Decomposition:** Axisymmetric scalar fields on a unit sphere are decomposed using Legendre polynomials $P_\\ell(\\mu)$, where $\\mu = \\cos\\theta$.\n- **Orthogonality:** $\\int_{-1}^{1} P_\\ell(\\mu) P_m(\\mu)\\,d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}$.\n- **Ablation Kinematics:** Ablation-front speed $v_a$ follows a power-law scaling $v_a = C_v F^\\beta$, where $F$ is the local incident flux, $C_v$ is a constant, and $\\beta \\in \\left[\\frac{1}{3},\\frac{1}{2}\\right]$.\n- **Thermal Smoothing:** Lateral thermal smoothing is governed by the surface heat equation $\\partial_t T = D \\nabla_s^2 T$ on a sphere of radius $R$ with thermal diffusivity $D$. The corresponding diffusive decay factor for mode $\\ell$ is $\\exp(-D\\,\\ell(\\ell+1)\\,t/R^2)$.\n\n**Geometry and Drive:**\n- **Capsule Radius:** $R$ (in $\\mathrm{m}$).\n- **Incident Flux:** $F(\\theta) = F_0\\Big(1 + \\sum_{i=1}^{N_r} w_i \\exp\\!\\Big[-\\frac{(\\theta - \\theta_i)^2}{2\\sigma_i^2}\\Big]\\Big)$, where $F_0$ is the baseline uniform drive (in $\\mathrm{W/m^2}$), and each of the $N_r$ rings is defined by a center angle $\\theta_i$, weight $w_i$, and width $\\sigma_i$.\n\n**Mathematical Definitions:**\n- **Legendre Coefficients:** $a_\\ell = \\frac{2\\ell+1}{2} \\int_{-1}^{1} F(\\mu)\\,P_\\ell(\\mu)\\,d\\mu$, with $F(\\mu)\\equiv F(\\theta=\\arccos\\mu)$.\n- **Relative Amplitudes:** $b_\\ell = \\frac{a_\\ell}{a_0}$, where $a_0 = \\frac{1}{2}\\int_{-1}^{1}F(\\mu)\\,d\\mu$ is the mean flux.\n\n**Numerical Requirements:**\n- **Quadrature Order:** Gaussian-Legendre quadrature of order $N_q = 512$.\n- **Legendre Polynomial Generation:** Use the three-term recurrence relation for $P_\\ell(\\mu)$ up to a specified $\\ell_{\\max}$.\n\n**Task:**\nCompute the time-dependent ablation-front displacement amplitudes $\\delta R_\\ell(t)$ (in $\\mathrm{m}$) for $\\ell \\in [1, \\ell_{\\max}]$.\n\n**Test Suite (4 Cases):**\n- **Case 1:** $F_0 = 5.0\\times 10^{14}$, Rings: $[(0.3, 0.2, 0.25), (\\pi-0.3, 0.2, 0.25)]$, $\\ell_{\\max} = 8$, $R = 10^{-3}$, $D = 5\\times 10^{-6}$, $\\beta = 1/3$, $t = 5\\times 10^{-9}$, $C_v = 0.375$.\n- **Case 2:** $F_0 = 5.0\\times 10^{14}$, Rings: $[(0.2, 0.3, 0.15), (\\pi-0.6, 0.05, 0.20)]$, $\\ell_{\\max} = 10$, $R = 10^{-3}$, $D = 5\\times 10^{-6}$, $\\beta = 0.4$, $t = 5\\times 10^{-9}$, $C_v = 0.35$.\n- **Case 3:** $F_0 = 5.0\\times 10^{14}$, Rings: $[(0.4, 0.25, 0.10), (\\pi-0.4, 0.25, 0.10)]$, $\\ell_{\\max} = 12$, $R = 10^{-3}$, $D = 5\\times 10^{-4}$, $\\beta = 1/3$, $t = 5\\times 10^{-9}$, $C_v = 0.375$.\n- **Case 4:** $F_0 = 5.0\\times 10^{14}$, Rings: $[(0.3, 0.15, 0.25), (\\pi-0.3, 0.15, 0.25), (\\pi/2, 0.05, 0.20)]$, $\\ell_{\\max} = 6$, $R = 10^{-3}$, $D = 5\\times 10^{-6}$, $\\beta = 0.33$, $t = 10^{-12}$, $C_v = 0.375$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the specified criteria:\n- **Scientifically Grounded:** The problem is based on established principles of computational plasma physics and inertial confinement fusion. The models presented—Legendre decomposition for axisymmetric fields, power-law scaling for radiative ablation, and diffusive smoothing for thermal transport—are standard, albeit simplified, representations of the relevant physics. The parameter values are within physically plausible ranges for ICF scenarios. The problem does not violate any scientific principles.\n- **Well-Posed:** The problem is well-posed. It provides all necessary input parameters and a clear objective: to compute a specific set of physical quantities ($\\delta R_\\ell(t)$). The derivation path is uniquely determined by the provided physical models, and a unique solution exists for each test case.\n- **Objective:** The problem is stated in precise, objective, and formal language, free of any subjective or opinion-based content. Terms are clearly defined.\n- **Completeness and Consistency:** The problem is self-contained. All constants, equations, and parameters required for the solution are explicitly provided for each case. There are no internal contradictions.\n- **Realism and Feasibility:** The physical scenario is a standard idealization in the field. The provided data are dimensionally consistent and physically plausible.\n- **Structure:** The problem is well-structured, guiding the solver from the initial drive definition to the final perturbation amplitudes through a logical sequence of steps.\n\n### Step 3: Verdict and Action\nThe problem is declared **valid**. It is a sound, well-posed, and self-contained problem in computational fusion science. The solution process may proceed.\n\n---\n\n### Derivation and Solution Strategy\n\nThe solution requires a multi-step procedure, starting from the incident flux distribution and culminating in the calculation of ablation-front displacement amplitudes for each Legendre mode.\n\n**1. Legendre Decomposition of the X-ray Drive**\nThe incident flux $F(\\theta)$ is an axisymmetric function on the surface of the capsule. It can be decomposed into a series of Legendre polynomials $P_\\ell(\\mu)$, where $\\mu = \\cos\\theta$:\n$$\nF(\\mu) = \\sum_{\\ell=0}^{\\infty} a_\\ell P_\\ell(\\mu)\n$$\nThe coefficients $a_\\ell$ are found by exploiting the orthogonality of the Legendre polynomials:\n$$\na_\\ell = \\frac{2\\ell+1}{2} \\int_{-1}^{1} F(\\mu) P_\\ell(\\mu) \\,d\\mu\n$$\nThe problem provides the functional a form for $F(\\theta)$, which we can write as $F(\\mu) = F(\\theta=\\arccos \\mu)$. The integral for $a_\\ell$ must be computed numerically using Gaussian-Legendre quadrature as specified. The coefficient $a_0$ corresponds to the mean flux across the spherical surface. The normalized perturbation amplitudes for each mode $\\ell \\geq 1$ are given by $b_\\ell = a_\\ell / a_0$.\n\n**2. Time-Dependent Perturbation Evolution**\nThe problem states that angular perturbations are subject to lateral thermal smoothing. The effective flux perturbation at the ablation front for a given mode $\\ell$ is not static but decays over time due to this diffusive process. The decay is described by the factor $\\exp(-D\\,\\ell(\\ell+1)\\,t/R^2)$. Therefore, the flux perturbation amplitude for mode $\\ell$ at time $t$ is:\n$$\n\\delta F_\\ell(t) = a_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right)\n$$\nThe total flux at the ablation front as a function of angle and time is the sum of the mean flux and the time-evolved perturbations:\n$$\nF(\\mu, t) = a_0 + \\sum_{\\ell=1}^{\\ell_{\\max}} \\delta F_\\ell(t) P_\\ell(\\mu) = a_0 + \\sum_{\\ell=1}^{\\ell_{\\max}} a_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right) P_\\ell(\\mu)\n$$\n\n**3. Linearized Ablation Velocity**\nThe ablation-front speed $v_a$ is related to the flux $F$ by the power law $v_a = C_v F^\\beta$. To find the response to small perturbations, we linearize this expression around the mean flux $a_0$. Let $F(\\mu, t) = a_0(1 + \\epsilon(\\mu, t))$, where $\\epsilon(\\mu, t) = (F(\\mu, t) - a_0) / a_0 \\ll 1$.\n$$\nv_a(\\mu, t) = C_v [a_0(1 + \\epsilon(\\mu, t))]^\\beta = C_v a_0^\\beta (1 + \\epsilon(\\mu, t))^\\beta\n$$\nUsing the binomial approximation $(1+x)^k \\approx 1+kx$ for small $x$:\n$$\nv_a(\\mu, t) \\approx C_v a_0^\\beta (1 + \\beta \\epsilon(\\mu, t)) = v_{a,0} + \\beta v_{a,0} \\frac{F(\\mu, t) - a_0}{a_0}\n$$\nwhere $v_{a,0} = C_v a_0^\\beta$ is the mean ablation speed. The perturbation in ablation speed, $\\delta v_a(\\mu, t) = v_a(\\mu, t) - v_{a,0}$, is:\n$$\n\\delta v_a(\\mu, t) \\approx \\frac{\\beta v_{a,0}}{a_0} \\sum_{\\ell=1}^{\\ell_{\\max}} a_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right) P_\\ell(\\mu)\n$$\nThe amplitude of the ablation velocity perturbation for mode $\\ell$ is therefore:\n$$\n\\delta v_{a,\\ell}(t) = \\frac{\\beta v_{a,0}}{a_0} a_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right) = \\beta v_{a,0} b_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right)\n$$\n\n**4. Ablation-Front Displacement Amplitudes**\nThe displacement of the ablation front, $\\delta R(\\mu,t)$, is the time integral of the velocity perturbation, $\\delta v_a(\\mu,t)$. The amplitude for each mode, $\\delta R_\\ell(t)$, is the time integral of the velocity amplitude $\\delta v_{a,\\ell}(t)$:\n$$\n\\delta R_\\ell(t) = \\int_0^t \\delta v_{a,\\ell}(t') \\,dt' = \\int_0^t \\beta v_{a,0} b_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t'}{R^2}\\right) \\,dt'\n$$\nPerforming the integration:\n$$\n\\delta R_\\ell(t) = \\beta v_{a,0} b_\\ell \\left[ -\\frac{R^2}{D\\ell(\\ell+1)} \\exp\\left(-\\frac{D\\ell(\\ell+1)t'}{R^2}\\right) \\right]_0^t\n$$\n$$\n\\delta R_\\ell(t) = \\beta v_{a,0} b_\\ell \\frac{R^2}{D\\ell(\\ell+1)} \\left(1 - \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right)\\right)\n$$\nThis is the final expression for the ablation-front displacement amplitude for mode $\\ell \\ge 1$.\n\n**5. Numerical Implementation Details**\nThe algorithm proceeds as follows for each test case:\n1.  Set up a grid of $N_q=512$ quadrature points $\\mu_j$ and weights $w_j$ on $[-1, 1]$ using `numpy.polynomial.legendre.leggauss`.\n2.  Generate values of Legendre polynomials $P_\\ell(\\mu_j)$ for $\\ell = 0, \\dots, \\ell_{\\max}$ at all quadrature points using the three-term recurrence relation.\n3.  Evaluate the flux function $F(\\mu_j)$ at all quadrature points.\n4.  Compute the coefficients $a_\\ell$ by numerically evaluating the integral $a_\\ell = \\frac{2\\ell+1}{2} \\sum_{j=1}^{N_q} w_j F(\\mu_j) P_\\ell(\\mu_j)$.\n5.  Extract the mean flux $a_0$.\n6.  Calculate the mean ablation velocity $v_{a,0} = C_v a_0^\\beta$.\n7.  For each mode $\\ell = 1, \\dots, \\ell_{\\max}$, calculate the relative amplitude $b_\\ell = a_\\ell/a_0$ and then the displacement $\\delta R_\\ell(t)$ using the derived formula.\n8.  For numerical stability when the exponent argument $x = \\frac{D\\ell(\\ell+1)t}{R^2}$ is very small, the term $(1 - e^{-x}) / x$ approaches $1$. The integral term $\\frac{R^2}{D\\ell(\\ell+1)}(1-e^{-x})$ approaches $t$. This limit will be handled to avoid floating-point cancellation errors, e.g., by using `numpy.expm1` or a conditional check for small arguments.\n\nThis structured procedure will be implemented in Python to solve for the parameters given in the test suite.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ablation-front perturbation spectrum for an ICF capsule\n    driven by an axisymmetric x-ray flux.\n    \"\"\"\n\n    # Numerical quadrature order as specified\n    N_q = 512\n\n    # Test cases from the problem statement\n    test_cases = [\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.3, 0.2, 0.25), (np.pi - 0.3, 0.2, 0.25)],\n            \"ell_max\": 8, \"R\": 1.0e-3, \"D\": 5.0e-6, \"beta\": 1.0/3.0,\n            \"t\": 5.0e-9, \"Cv\": 0.375\n        },\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.2, 0.3, 0.15), (np.pi - 0.6, 0.05, 0.20)],\n            \"ell_max\": 10, \"R\": 1.0e-3, \"D\": 5.0e-6, \"beta\": 0.4,\n            \"t\": 5.0e-9, \"Cv\": 0.35\n        },\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.4, 0.25, 0.10), (np.pi - 0.4, 0.25, 0.10)],\n            \"ell_max\": 12, \"R\": 1.0e-3, \"D\": 5.0e-4, \"beta\": 1.0/3.0,\n            \"t\": 5.0e-9, \"Cv\": 0.375\n        },\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.3, 0.15, 0.25), (np.pi - 0.3, 0.15, 0.25), (np.pi/2.0, 0.05, 0.20)],\n            \"ell_max\": 6, \"R\": 1.0e-3, \"D\": 5.0e-6, \"beta\": 0.33,\n            \"t\": 1.0e-12, \"Cv\": 0.375\n        }\n    ]\n\n    all_results = []\n    \n    # Get Gaussian-Legendre quadrature nodes (mu) and weights\n    mu_nodes, weights = np.polynomial.legendre.leggauss(N_q)\n\n    for case in test_cases:\n        F0 = case[\"F0\"]\n        rings = case[\"rings\"]\n        ell_max = case[\"ell_max\"]\n        R = case[\"R\"]\n        D = case[\"D\"]\n        beta = case[\"beta\"]\n        t = case[\"t\"]\n        Cv = case[\"Cv\"]\n\n        # 1. Generate Legendre polynomials P_l(mu) using three-term recurrence\n        P_l_mu = np.zeros((ell_max + 1, N_q))\n        P_l_mu[0, :] = 1.0\n        if ell_max > 0:\n            P_l_mu[1, :] = mu_nodes\n        for l in range(1, ell_max):\n            P_l_mu[l + 1, :] = ((2 * l + 1) * mu_nodes * P_l_mu[l, :] - l * P_l_mu[l - 1, :]) / (l + 1)\n\n        # 2. Define and evaluate the flux function F(mu)\n        theta_nodes = np.arccos(mu_nodes)\n        flux_perturbation = np.zeros(N_q)\n        for theta_i, w_i, sigma_i in rings:\n            flux_perturbation += w_i * np.exp(-(theta_nodes - theta_i)**2 / (2 * sigma_i**2))\n        \n        F_mu = F0 * (1.0 + flux_perturbation)\n\n        # 3. Compute Legendre coefficients a_l\n        a_coeffs = np.zeros(ell_max + 1)\n        l_range = np.arange(ell_max + 1)\n        # Numerical integration: integral(F * P_l) dmu ~= sum(weights * F * P_l)\n        integrals = np.sum(weights[:, np.newaxis] * F_mu[:, np.newaxis] * P_l_mu.T, axis=0)\n        a_coeffs = (2 * l_range + 1) / 2.0 * integrals\n\n        # 4. Calculate perturbation displacements delta_R_l\n        a0 = a_coeffs[0]\n        v_a0 = Cv * (a0**beta)\n\n        delta_R_l_list = []\n        for l in range(1, ell_max + 1):\n            b_l = a_coeffs[l] / a0\n\n            # Calculate the time-integrated-and-smoothed term\n            exponent_arg = D * l * (l + 1) * t / (R**2)\n            \n            # Use numerically stable method for the integral part to avoid 0/0 or cancellation\n            if exponent_arg  1e-8: # for small arguments, integral is approximately t\n                time_integral_term = t\n            else:\n                # integral is (1 - exp(-x)) / (x/t) = t * (1 - exp(-x))/x\n                # where x = exponent_arg\n                time_integral_term = (R**2 / (D * l * (l + 1))) * (1.0 - np.exp(-exponent_arg))\n\n            delta_R_l = beta * v_a0 * b_l * time_integral_term\n            delta_R_l_list.append(delta_R_l)\n            \n        all_results.append(delta_R_l_list)\n\n    # Format output as a list of lists, matching the example format logic\n    # e.g., [[val1, val2],[val3,val4]]\n    # This is achieved by creating a string from each inner list, joining them with commas,\n    # and enclosing the result in brackets.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Ultimately, ICF performance is determined by the conditions achieved in the central hot spot at peak compression. This final practice introduces a reduced-order model to analyze the hot spot energy balance and, more importantly, to quantify how uncertainties in our physical models and experimental conditions propagate to the final yield prediction . By applying linear error propagation, you will construct an error budget, a powerful tool for identifying the most critical parameters that dominate the uncertainty in fusion performance.",
            "id": "3995266",
            "problem": "You are given a reduced-order stagnation model for inertial confinement fusion (ICF) implosion hot spots to propagate uncertainties from drive and material parameters into a dimensionless yield proxy. The goal is to construct a program that, for each test case, computes the error budget for the relative yield by linear uncertainty propagation and identifies the dominant contributor among the parameters. The context is inertial confinement fusion fundamentals with implosion dynamics and hot spot formation, and the derivation starts from first principles of thermodynamics and transport.\n\nAssumptions and model specification:\n- The hot spot is modeled as a uniform spherical plasma of radius $R$, mass density $\\rho_h$, and confinement time $\\tau$.\n- The plasma is a deuterium–tritium (DT) mixture; the mean ion mass is $m_i$ and the effective particle number density is $n_{\\mathrm{eff}} = (1+Z) n_i$ with $Z=1$, so $n_{\\mathrm{eff}} = 2 \\rho_h / m_i$.\n- Use the ideal-gas equation of state (EOS; Equation of State) for a fully ionized DT plasma, $P = n_{\\mathrm{eff}} k_B T$.\n- The First Law of Thermodynamics gives $U = P V / (\\gamma - 1)$ for the hot spot internal energy, where $\\gamma$ is the effective adiabatic index.\n- The compression work delivered to the hot spot is modeled as $W_{\\mathrm{in}} = \\eta_w P_a V$, where $P_a$ is the absorbed drive pressure and $\\eta_w \\in (0,1)$ is a coupling efficiency that accounts for hydrodynamic partition and shock heating.\n- Thermal conduction loss is modeled by Fourier heat conduction over the confinement time, $Q_{\\mathrm{cond}} \\approx \\kappa \\, A \\, \\Delta T \\, \\tau / L$, with $A = 4 \\pi R^2$ the area, $L \\approx R$ a characteristic gradient length, $\\kappa$ the thermal conductivity, and $\\Delta T \\approx T$ for a steep gradient. Thus $Q_{\\mathrm{cond}} \\approx \\kappa \\, (4 \\pi R) \\, \\tau \\, T$.\n\nEnergy balance at stagnation is\n$$\n\\frac{n_{\\mathrm{eff}} k_B T \\, V}{\\gamma - 1} \\;=\\; \\eta_w P_a V \\;-\\; \\kappa \\, (4 \\pi R) \\, \\tau \\, T.\n$$\nSolve for $T$ to obtain the reduced-order stagnation temperature\n$$\nT(P_a,\\gamma,\\kappa) \\;=\\; \\frac{\\eta_w P_a V}{\\displaystyle \\frac{n_{\\mathrm{eff}} k_B V}{\\gamma - 1} \\;+\\; \\kappa \\,(4 \\pi R)\\, \\tau } \\;=\\; \\frac{\\eta_w P_a V}{A(\\gamma) + B \\kappa},\n$$\nwith definitions $A(\\gamma) = C_V / (\\gamma - 1)$, $C_V = n_{\\mathrm{eff}} k_B V$, and $B = 4 \\pi R \\tau$.\n\nDefine a dimensionless yield proxy $Y_{\\mathrm{rel}}$ using a local power-law approximation to the reaction-rate factor for deuterium–tritium fusion, $Y \\propto \\langle \\sigma v \\rangle(T)$, with $\\langle\\sigma v\\rangle(T) \\approx C_s T^{n_r}$ for temperatures around a given mean. Let the relative yield be\n$$\nY_{\\mathrm{rel}}(P_a,\\gamma,\\kappa) \\;=\\; \\left( \\frac{ T(P_a,\\gamma,\\kappa) }{ T_\\mu } \\right)^{n_r},\n$$\nwhere $T_\\mu = T(P_{a,\\mu},\\gamma_\\mu,\\kappa_\\mu)$ is the mean temperature for the test case, and $n_r$ is a local exponent (take $n_r = 2$).\n\nUncertainty propagation:\n- Assume independent, normally distributed uncertainties on $P_a$, $\\gamma$, and $\\kappa$ with given means and standard deviations.\n- Use first-order linear uncertainty propagation for $Y_{\\mathrm{rel}}$:\n$$\n\\sigma_Y^2 \\;\\approx\\; \\left( \\frac{\\partial Y}{\\partial P_a} \\right)^2 \\sigma_{P_a}^2 \\;+\\; \\left( \\frac{\\partial Y}{\\partial \\gamma} \\right)^2 \\sigma_{\\gamma}^2 \\;+\\; \\left( \\frac{\\partial Y}{\\partial \\kappa} \\right)^2 \\sigma_{\\kappa}^2,\n$$\nevaluated at the parameter means of each test case. The partial derivatives follow from the chain rule,\n$$\n\\frac{\\partial Y}{\\partial \\theta} \\;=\\; \\frac{n_r}{T_\\mu} \\, \\frac{\\partial T}{\\partial \\theta}, \\quad \\theta \\in \\{P_a,\\gamma,\\kappa\\},\n$$\nwith\n$$\n\\frac{\\partial T}{\\partial P_a} = \\frac{\\eta_w V}{A(\\gamma)+B\\kappa}, \\quad\n\\frac{\\partial T}{\\partial \\kappa} = -\\frac{\\eta_w P_a V \\, B}{\\left[A(\\gamma)+B\\kappa\\right]^2}, \\quad\n\\frac{\\partial T}{\\partial \\gamma} = \\frac{\\eta_w P_a V }{\\left[A(\\gamma)+B\\kappa\\right]^2} \\, \\frac{C_V}{(\\gamma - 1)^2}.\n$$\n\nError budget and dominant contributor:\n- Define contribution components $C_{P_a} = \\left( \\frac{\\partial Y}{\\partial P_a} \\right)^2 \\sigma_{P_a}^2$, $C_{\\gamma} = \\left( \\frac{\\partial Y}{\\partial \\gamma} \\right)^2 \\sigma_{\\gamma}^2$, and $C_{\\kappa} = \\left( \\frac{\\partial Y}{\\partial \\kappa} \\right)^2 \\sigma_{\\kappa}^2$, and total variance $\\sigma_Y^2 = C_{P_a} + C_{\\gamma} + C_{\\kappa}$.\n- The fractional contributions are $f_{P_a} = C_{P_a}/\\sigma_Y^2$, $f_{\\gamma} = C_{\\gamma}/\\sigma_Y^2$, $f_{\\kappa} = C_{\\kappa}/\\sigma_Y^2$.\n- The dominant contributor is the index of the largest $C_i$ with the tie broken by the lowest index. Use the index mapping $0 \\rightarrow P_a$, $1 \\rightarrow \\gamma$, $2 \\rightarrow \\kappa$.\n\nPhysical constants and geometry to use in all cases:\n- Boltzmann constant $k_B = 1.380649 \\times 10^{-23} \\,\\mathrm{J/K}$.\n- Atomic mass unit $m_u = 1.66053906660 \\times 10^{-27} \\,\\mathrm{kg}$.\n- Mean ion mass $m_i = 2.5 \\, m_u$.\n- Hot spot density $\\rho_h = 10 \\,\\mathrm{kg/m^3}$.\n- Radius $R = 30 \\,\\mu\\mathrm{m} = 30 \\times 10^{-6} \\,\\mathrm{m}$.\n- Confinement time $\\tau = 100 \\,\\mathrm{ps} = 100 \\times 10^{-12} \\,\\mathrm{s}$.\n- Volume $V = \\frac{4}{3} \\pi R^3$.\n- Coupling efficiency $\\eta_w = 0.6$.\n- Reactivity exponent $n_r = 2$.\n\nUnits:\n- Use $P_a$ in $\\mathrm{Pa}$, $\\gamma$ dimensionless, and $\\kappa$ in $\\mathrm{W/(m \\cdot K)}$. The program must output a dimensionless standard deviation for $Y_{\\mathrm{rel}}$ and dimensionless fractional contributions expressed as decimals.\n\nTest suite:\n- Case $1$: Means $P_{a,\\mu} = 2.0 \\times 10^{13} \\,\\mathrm{Pa}$, $\\gamma_\\mu = 1.35$, $\\kappa_\\mu = 10.0 \\,\\mathrm{W/(m \\cdot K)}$. Standard deviations $\\sigma_{P_a} = 0.05 \\, P_{a,\\mu}$, $\\sigma_{\\gamma} = 0.02$, $\\sigma_{\\kappa} = 0.10 \\, \\kappa_\\mu$.\n- Case $2$: Means $P_{a,\\mu} = 2.0 \\times 10^{13} \\,\\mathrm{Pa}$, $\\gamma_\\mu = 1.35$, $\\kappa_\\mu = 100.0 \\,\\mathrm{W/(m \\cdot K)}$. Standard deviations $\\sigma_{P_a} = 0.05 \\, P_{a,\\mu}$, $\\sigma_{\\gamma} = 0.02$, $\\sigma_{\\kappa} = 30.0$.\n- Case $3$: Means $P_{a,\\mu} = 2.5 \\times 10^{13} \\,\\mathrm{Pa}$, $\\gamma_\\mu = 1.15$, $\\kappa_\\mu = 10.0 \\,\\mathrm{W/(m \\cdot K)}$. Standard deviations $\\sigma_{P_a} = 0.05 \\, P_{a,\\mu}$, $\\sigma_{\\gamma} = 0.03$, $\\sigma_{\\kappa} = 0.50$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of three inner lists, each inner list corresponding to a test case and containing five elements in order: $[\\sigma_Y, f_{P_a}, f_{\\gamma}, f_{\\kappa}, \\text{dominant\\_index}]$, with $\\sigma_Y$, $f_{P_a}$, $f_{\\gamma}$, and $f_{\\kappa}$ rounded to six decimal places and $\\text{dominant\\_index}$ an integer. For example: $[[0.123456,0.4,0.5,0.1,1],[...],[...]]$.",
            "solution": "The user has provided a problem in computational fusion science, focusing on uncertainty quantification for a reduced-order model of an inertial confinement fusion (ICF) hot spot. The problem is to calculate the error budget for a relative yield proxy, identifying the dominant source of uncertainty among several input parameters.\n\n### Step 1: Problem Validation\n\nFirst, the problem statement is meticulously validated against the required criteria.\n\n**Extracted Givens:**\n-   **Model:** A uniform spherical hot spot with radius $R$, density $\\rho_h$, and confinement time $\\tau$.\n-   **Physics:** Ideal-gas equation of state $P = n_{\\mathrm{eff}} k_B T$ with $n_{\\mathrm{eff}} = 2 \\rho_h / m_i$, and internal energy $U = PV / (\\gamma-1)$.\n-   **Energy Balance:** Work in $W_{\\mathrm{in}} = \\eta_w P_a V$ balanced by internal energy gain and thermal conduction loss $Q_{\\mathrm{cond}} = \\kappa (4 \\pi R) \\tau T$.\n-   **Stagnation Temperature:** $T(P_a,\\gamma,\\kappa) = \\frac{\\eta_w P_a V}{A(\\gamma) + B \\kappa}$, where $A(\\gamma) = C_V / (\\gamma - 1)$, $C_V = n_{\\mathrm{eff}} k_B V$, and $B = 4 \\pi R \\tau$.\n-   **Relative Yield Proxy:** $Y_{\\mathrm{rel}} = (T/T_\\mu)^{n_r}$ with $n_r=2$, evaluated at the mean parameter values.\n-   **Uncertainty Analysis:** First-order linear propagation for independent, normally distributed uncertainties in $P_a$, $\\gamma$, and $\\kappa$. Total variance $\\sigma_Y^2$ is the sum of contributions $C_\\theta = (\\partial Y_{\\mathrm{rel}}/\\partial \\theta)^2 \\sigma_\\theta^2$ for $\\theta \\in \\{P_a, \\gamma, \\kappa\\}$, all evaluated at the mean parameter values.\n-   **Derivatives:** The required partial derivatives for the analysis are provided and have been verified as mathematically correct.\n-   **Constants:** Values for $k_B$, $m_u$, $m_i$, $\\rho_h$, $R$, $\\tau$, $\\eta_w$, and $n_r$ are given and are in appropriate SI units.\n-   **Test Cases:** Three distinct sets of mean parameters ($P_{a,\\mu}, \\gamma_\\mu, \\kappa_\\mu$) and their corresponding standard deviations ($\\sigma_{P_a}, \\sigma_{\\gamma}, \\sigma_{\\kappa}$) are provided.\n-   **Output:** The program must compute for each case: the standard deviation of the yield proxy $\\sigma_Y$, the fractional variance contributions $f_{P_a}, f_{\\gamma}, f_{\\kappa}$, and the index of the dominant contributor ($0$ for $P_a$, $1$ for $\\gamma$, $2$ for $\\kappa$). The output format is a precisely specified single-line string.\n\n**Validation Verdict:**\n1.  **Scientifically Grounded:** The problem uses a simplified but physically valid reduced-order model based on first principles of thermodynamics and heat transfer, common in ICF research. The parameter values are in a realistic range.\n2.  **Well-Posed:** All equations, constants, and test case data are provided. The objective is clear and the procedure for determining the result is unambiguous. A unique, meaningful solution exists for each test case.\n3.  **Objective:** The problem is stated in precise, quantitative terms, free of subjectivity.\n4.  **Flaws:** The problem statement is inspected for flaws and none are found. It is self-contained, consistent, and scientifically sound. The denominators in the expressions, such as $\\gamma-1$ and $A(\\gamma)+B\\kappa$, are confirmed to be non-zero and positive for the given parameter ranges, precluding singularities.\n\n**Conclusion:** The problem is **valid**. A solution will be developed and implemented.\n\n### Step 2: Solution Derivation and Algorithmic Design\n\nThe core of the problem is to compute the variance contributions $C_\\theta$. A more robust and computationally efficient form of these contributions can be derived. The variance in $Y_{\\mathrm{rel}}$ is given by $\\sigma_Y^2 \\approx \\sum_\\theta C_\\theta$, where $C_\\theta = (\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial \\theta} \\sigma_\\theta)^2$. The derivatives are evaluated at the mean parameter values, where $T=T_\\mu$ and $Y_{\\mathrm{rel}}=1$.\n\nFrom the chain rule, $\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial \\theta} = \\frac{\\partial Y_{\\mathrm{rel}}}{\\partial T} \\frac{\\partial T}{\\partial \\theta}$.\n$\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial T} = n_r \\frac{T^{n_r-1}}{T_\\mu^{n_r}}$. Evaluated at $T=T_\\mu$, this is $\\frac{n_r}{T_\\mu}$.\nThus, $\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial \\theta} |_\\mu = \\frac{n_r}{T_\\mu} \\frac{\\partial T}{\\partial \\theta} |_\\mu$.\n\nThe variance contributions can be expressed using logarithmic derivatives for clarity and stability:\n$C_\\theta = \\left( n_r \\frac{\\partial \\ln T}{\\partial \\ln \\theta} \\frac{\\sigma_\\theta}{\\theta_\\mu} \\right)^2$, where the derivatives are evaluated at the means.\n\n1.  **Contribution from $P_a$**:\n    $T \\propto P_a$, so $\\frac{\\partial \\ln T}{\\partial \\ln P_a} = 1$.\n    $$C_{P_a} = \\left( n_r \\frac{\\sigma_{P_a}}{P_{a,\\mu}} \\right)^2$$\n\n2.  **Contribution from $\\gamma$**:\n    $\\frac{\\partial T}{\\partial \\gamma} = \\frac{\\partial}{\\partial \\gamma} \\left( \\frac{C_0}{C_V/(\\gamma-1) + C_1} \\right) = - \\frac{C_0}{(A(\\gamma)+B\\kappa)^2} \\left( - \\frac{C_V}{(\\gamma-1)^2} \\right) = T \\frac{A(\\gamma)}{A(\\gamma)+B\\kappa} \\frac{1}{\\gamma-1}$.\n    $\\frac{\\partial \\ln T}{\\partial \\ln \\gamma} = \\frac{\\gamma}{T} \\frac{\\partial T}{\\partial \\gamma} = \\frac{A(\\gamma)}{A(\\gamma)+B\\kappa} \\frac{\\gamma}{\\gamma-1}$.\n    This is slightly more complex than necessary. Using the direct derivative:\n    $\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial \\gamma} \\sigma_\\gamma = \\frac{n_r}{T_\\mu} \\left( T_\\mu \\frac{A_\\mu}{A_\\mu+B\\kappa_\\mu} \\frac{1}{\\gamma_\\mu-1} \\right) \\sigma_\\gamma = n_r \\frac{A_\\mu}{A_\\mu+B\\kappa_\\mu} \\frac{\\sigma_\\gamma}{\\gamma_\\mu-1}$.\n    $$C_{\\gamma} = \\left( n_r \\frac{A_\\mu}{A_\\mu+B\\kappa_\\mu} \\frac{\\sigma_\\gamma}{\\gamma_\\mu-1} \\right)^2$$\n\n3.  **Contribution from $\\kappa$**:\n    $\\frac{\\partial T}{\\partial \\kappa} = \\frac{\\partial}{\\partial \\kappa} \\left( \\frac{C_0}{A+B\\kappa} \\right) = - \\frac{C_0 B}{(A+B\\kappa)^2} = - T \\frac{B}{A+B\\kappa}$.\n    $\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial \\kappa} \\sigma_\\kappa = \\frac{n_r}{T_\\mu} \\left( - T_\\mu \\frac{B}{A_\\mu+B\\kappa_\\mu} \\right) \\sigma_\\kappa = - n_r \\frac{B\\kappa_\\mu}{A_\\mu+B\\kappa_\\mu} \\frac{\\sigma_\\kappa}{\\kappa_\\mu}$.\n    $$C_{\\kappa} = \\left( n_r \\frac{B\\kappa_\\mu}{A_\\mu+B\\kappa_\\mu} \\frac{\\sigma_\\kappa}{\\kappa_\\mu} \\right)^2$$\n\nThe algorithm proceeds as follows:\n\n**1. Pre-computation:**\n-   Define all physical and model constants: $k_B, m_u, m_i, \\rho_h, R, \\tau, \\eta_w, n_r$.\n-   Calculate geometric and derived constants that are the same for all test cases:\n    -   Hot spot volume $V = \\frac{4}{3}\\pi R^3$.\n    -   Effective number density $n_{\\mathrm{eff}} = 2 \\rho_h / m_i$.\n    -   Heat capacity term $C_V = n_{\\mathrm{eff}} k_B V$.\n    -   Conduction loss geometry/time factor $B = 4\\pi R \\tau$.\n\n**2. Per-case computation:**\n-   For each test case defined by ($\\{P_{a,\\mu}, \\gamma_\\mu, \\kappa_\\mu\\}, \\{\\sigma_{P_a}, \\sigma_{\\gamma}, \\sigma_{\\kappa}\\}$):\n    a. Calculate the EOS term $A_\\mu = C_V / (\\gamma_\\mu - 1)$.\n    b. Compute the individual variance contributions $C_{P_a}$, $C_{\\gamma}$, and $C_{\\kappa}$ using the derived formulas. Note that standard deviations $\\sigma_{P_a}$ and $\\sigma_\\kappa$ are sometimes given relative to the mean, and must be converted to absolute values first.\n    c. Sum the contributions to get the total variance: $\\sigma_Y^2 = C_{P_a} + C_{\\gamma} + C_{\\kappa}$.\n    d. Take the square root to find the standard deviation of the relative yield: $\\sigma_Y = \\sqrt{\\sigma_Y^2}$.\n    e. If $\\sigma_Y^2  0$, calculate the fractional contributions: $f_\\theta = C_\\theta / \\sigma_Y^2$. If $\\sigma_Y^2=0$, all contributions are $0$.\n    f. Determine the dominant contributor by finding the index of the maximum value in the array $[C_{P_a}, C_{\\gamma}, C_{\\kappa}]$. Standard library functions for this purpose naturally break ties by selecting the first occurrence (lowest index).\n    g. Collate the results $[\\sigma_Y, f_{P_a}, f_{\\gamma}, f_{\\kappa}, \\text{dominant\\_index}]$, rounding the floating-point numbers to six decimal places.\n\n**3. Final Output:**\n-   Assemble the results from all test cases into a list of lists.\n-   Construct the final output string to match the specified format `[[...],[...],[...]]` exactly, ensuring no extraneous spaces.\n\nThis structured approach ensures correctness and numerical stability by using simplified, physically insightful expressions for the variance contributions.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ICF hot spot uncertainty propagation problem.\n\n    The function computes the error budget for a relative yield proxy based on a\n    reduced-order stagnation model. It uses first-order linear uncertainty\n    propagation to determine the contributions from uncertainties in drive\n    pressure (P_a), adiabatic index (gamma), and thermal conductivity (kappa).\n    \"\"\"\n\n    # Physical constants and geometry (SI units)\n    k_B = 1.380649e-23  # Boltzmann constant, J/K\n    m_u = 1.66053906660e-27  # Atomic mass unit, kg\n    m_i = 2.5 * m_u  # Mean ion mass for DT plasma, kg\n    rho_h = 10.0  # Hot spot density, kg/m^3\n    R = 30.0e-6  # Hot spot radius, m\n    tau = 100.0e-12  # Confinement time, s\n    eta_w = 0.6  # Coupling efficiency, dimensionless\n    n_r = 2.0  # Reactivity exponent, dimensionless\n\n    # Derived constants independent of test cases\n    V = (4.0 / 3.0) * np.pi * R**3\n    n_eff = 2.0 * rho_h / m_i\n    C_V = n_eff * k_B * V\n    B = 4.0 * np.pi * R * tau\n\n    # Test suite: [(P_a_mu, gamma_mu, kappa_mu), (sigma_Pa_info, sigma_gamma, sigma_kappa_info)]\n    # Info is (value, is_relative_flag)\n    test_cases = [\n        ((2.0e13, 1.35, 10.0), ((0.05, True), 0.02, (0.10, True))),\n        ((2.0e13, 1.35, 100.0), ((0.05, True), 0.02, (30.0, False))),\n        ((2.5e13, 1.15, 10.0), ((0.05, True), 0.03, (0.50, False))),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        means, std_dev_info = case\n        P_a_mu, gamma_mu, kappa_mu = means\n        \n        # Unpack and calculate absolute standard deviations\n        sigma_Pa_info, sigma_gamma, sigma_kappa_info = std_dev_info\n        \n        sigma_Pa = sigma_Pa_info[0] * P_a_mu if sigma_Pa_info[1] else sigma_Pa_info[0]\n        sigma_kappa = sigma_kappa_info[0] * kappa_mu if sigma_kappa_info[1] else sigma_kappa_info[0]\n\n        # Calculate terms evaluated at mean values\n        A_mu = C_V / (gamma_mu - 1.0)\n        denom = A_mu + B * kappa_mu\n\n        # Calculate variance contributions using derived formulas\n        \n        # Contribution from P_a\n        C_Pa = (n_r * (sigma_Pa / P_a_mu))**2\n\n        # Contribution from gamma\n        C_gamma = (n_r * (A_mu / denom) * (sigma_gamma / (gamma_mu - 1.0)))**2\n\n        # Contribution from kappa\n        C_kappa = (n_r * (B * kappa_mu / denom) * (sigma_kappa / kappa_mu))**2\n\n        # Total variance and standard deviation\n        contributions = np.array([C_Pa, C_gamma, C_kappa])\n        sigma_Y_sq = np.sum(contributions)\n        sigma_Y = np.sqrt(sigma_Y_sq) if sigma_Y_sq > 0 else 0.0\n\n        # Fractional contributions\n        if sigma_Y_sq > 0:\n            f_Pa = C_Pa / sigma_Y_sq\n            f_gamma = C_gamma / sigma_Y_sq\n            f_kappa = C_kappa / sigma_Y_sq\n        else:\n            f_Pa, f_gamma, f_kappa = 0.0, 0.0, 0.0\n\n        # Dominant contributor index\n        dominant_index = int(np.argmax(contributions))\n        \n        # Format results for the current case\n        case_results = [\n            round(sigma_Y, 6),\n            round(f_Pa, 6),\n            round(f_gamma, 6),\n            round(f_kappa, 6),\n            dominant_index\n        ]\n        all_results.append(case_results)\n\n    # Construct the final output string per exact specification\n    result_strings = []\n    for res in all_results:\n        # Convert each item in the inner list to its string representation\n        # and join with commas. This avoids spaces that str(list) would add.\n        inner_str = '[' + ','.join(map(str, res)) + ']'\n        result_strings.append(inner_str)\n    \n    final_output = '[' + ','.join(result_strings) + ']'\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}