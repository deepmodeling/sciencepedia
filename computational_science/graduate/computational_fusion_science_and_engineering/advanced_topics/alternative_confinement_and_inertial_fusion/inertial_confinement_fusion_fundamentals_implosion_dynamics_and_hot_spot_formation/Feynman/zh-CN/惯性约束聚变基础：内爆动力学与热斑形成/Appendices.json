{
    "hands_on_practices": [
        {
            "introduction": "ICF内爆的初始阶段由一个或多个冲击波驱动，这些冲击波压缩燃料并为其后续加速设定初始热力学状态。这个练习将带你回到流体动力学的基石，通过应用Rankine-Hugoniot关系来分析进入低温DT燃料的强冲击波。通过这个实践，你将推导出理想气体模型下的压缩极限，并探讨真实材料（如在表格化状态方程中描述的）中发生的更复杂物理过程（如电离）是如何显著改变这一结果的。",
            "id": "3995233",
            "problem": "一道平面、定常正激波在初始静止的氘-氚(DT)中传播，其初始温度为 $T_0=20\\,\\mathrm{K}$，质量密度为 $\\rho_0=0.25\\,\\mathrm{g/cm^3}$。这些条件代表了惯性约束聚变(ICF)靶丸中的低温DT。激波速度为 $u_s=30\\,\\mathrm{km/s}$。假设下游的DT可以用理想的 $\\gamma$ 律物态方程(EOS) $p=(\\gamma-1)\\rho e$ 来建模，其中 $\\gamma$ 取适用于单原子理想气体的值。并假设与激波后状态相比，上游的压力和内能可以忽略不计。从跨越定常平面激波的质量、动量和能量守恒（朗金-雨贡纽关系）以及理想 $\\gamma$ 律物态方程出发，推导压缩比，并用它计算此强激波的激波压缩后密度 $\\rho_1$。将最终的数值密度四舍五入到四位有效数字，并以 $\\mathrm{g/cm^3}$ 为单位表示。简要地定性讨论，在这些条件下，表格式DT物态方程将如何修正理想气体模型的预测，并说明原因。",
            "solution": "该问题要求在强激波条件下，推导氘-氚(DT)混合物的激波压缩后密度。首先使用理想气体模型，然后定性讨论更真实的表格式物态方程(EOS)会带来哪些修正。\n\n首先，我们陈述朗金-雨贡纽关系，它表示了跨越一个定常、平面激波阵面的质量、动量和能量守恒。我们在激波静止的参考系中分析激波。在此参考系中，上游流体（状态 $0$）以速度 $v_0 = u_s$ 朝激波移动，其中 $u_s$ 是实验室参考系中的激波速度。下游流体（状态 $1$）以速度 $v_1$ 离开激波。这些关系是：\n1.  质量守恒: $\\rho_0 v_0 = \\rho_1 v_1$\n2.  动量守恒: $p_0 + \\rho_0 v_0^2 = p_1 + \\rho_1 v_1^2$\n3.  能量守恒: $h_0 + \\frac{1}{2}v_0^2 = h_1 + \\frac{1}{2}v_1^2$，其中 $h = e + p/\\rho$ 是比焓。\n\n问题指定了强激波近似，即上游压力 $p_0$ 和内能 $e_0$（以及比焓 $h_0$）与激波后的对应量相比可以忽略不计。应用此近似 ($p_0 \\to 0$, $h_0 \\to 0$)，朗金-雨贡纽关系简化为：\n$$ \\rho_0 v_0 = \\rho_1 v_1 \\quad (1) $$\n$$ \\rho_0 v_0^2 = p_1 + \\rho_1 v_1^2 \\quad (2) $$\n$$ \\frac{1}{2}v_0^2 = h_1 + \\frac{1}{2}v_1^2 \\quad (3) $$\n\n我们对下游状态使用理想 $\\gamma$ 律物态方程 $p_1 = (\\gamma-1)\\rho_1 e_1$。比焓为 $h_1 = e_1 + p_1/\\rho_1$。代入 $e_1$，我们得到 $h_1 = \\frac{p_1}{(\\gamma-1)\\rho_1} + \\frac{p_1}{\\rho_1} = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1}$。\n将 $h_1$ 的表达式代入能量方程($3$)：\n$$ \\frac{1}{2}v_0^2 = \\frac{\\gamma p_1}{(\\gamma-1)\\rho_1} + \\frac{1}{2}v_1^2 \\quad (4) $$\n\n现在我们求解这个方程组以得到压缩比 $\\eta = \\rho_1 / \\rho_0$。\n从($1$)式，我们有 $v_1 = \\frac{\\rho_0}{\\rho_1} v_0 = \\frac{v_0}{\\eta}$。\n从($2$)式，我们可以将激波后压力 $p_1$ 表示为：\n$$ p_1 = \\rho_0 v_0^2 - \\rho_1 v_1^2 = \\rho_0 v_0^2 - (\\eta \\rho_0) \\left(\\frac{v_0}{\\eta}\\right)^2 = \\rho_0 v_0^2 - \\frac{\\rho_0 v_0^2}{\\eta} = \\rho_0 v_0^2 \\left(1 - \\frac{1}{\\eta}\\right) $$\n或者，从($1$)和($2$)式可得：$p_1 = \\rho_0 v_0 (v_0 - v_1)$。\n\n让我们对方程进行变换以找到速度之间的简单关系。我们将动量方程中的 $p_1$ 表达式代入能量方程($4$)。更直接的方法是先从能量方程中表达 $p_1$：\n$p_1 = \\frac{(\\gamma-1)\\rho_1}{\\gamma} \\left(\\frac{1}{2}v_0^2 - \\frac{1}{2}v_1^2\\right) = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0^2 - v_1^2)$。\n现在，我们将 $p_1$ 的两个表达式相等：\n$$ \\rho_0 v_0 (v_0 - v_1) = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0 - v_1)(v_0 + v_1) $$\n因为激波必须存在，所以 $v_1 \\neq v_0$，我们可以除以 $(v_0 - v_1)$：\n$$ \\rho_0 v_0 = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0 + v_1) $$\n使用质量守恒关系 $\\rho_0 v_0 = \\rho_1 v_1$：\n$$ \\rho_1 v_1 = \\frac{\\gamma-1}{2\\gamma}\\rho_1(v_0 + v_1) $$\n我们可以消去非零的 $\\rho_1$：\n$$ v_1 = \\frac{\\gamma-1}{2\\gamma}(v_0 + v_1) $$\n$$ 2\\gamma v_1 = (\\gamma-1)v_0 + (\\gamma-1)v_1 $$\n$$ v_1 (2\\gamma - (\\gamma-1)) = v_0 (\\gamma-1) $$\n$$ v_1 (\\gamma+1) = v_0 (\\gamma-1) $$\n这给出了速度比：\n$$ \\frac{v_1}{v_0} = \\frac{\\gamma-1}{\\gamma+1} $$\n压缩比为 $\\eta = \\rho_1 / \\rho_0$。从质量守恒($1$)，$\\eta = v_0 / v_1$。因此，对于理想气体中的强激波：\n$$ \\eta = \\frac{\\rho_1}{\\rho_0} = \\frac{\\gamma+1}{\\gamma-1} $$\n问题指出DT是单原子理想气体。在激波后的高温高压下，DT将完全电离成由D$^+$、T$^+$和电子组成的等离子体。这些粒子只有三个平动自由度，这对应于单原子气体。单原子气体的绝热指数为 $\\gamma = 5/3$。\n将该值代入压缩比的表达式中：\n$$ \\eta = \\frac{5/3 + 1}{5/3 - 1} = \\frac{8/3}{2/3} = 4 $$\n压缩比恰好为$4$。\n给定初始密度为 $\\rho_0 = 0.25\\,\\mathrm{g/cm^3}$。\n激波压缩后的密度 $\\rho_1$ 是：\n$$ \\rho_1 = \\eta \\cdot \\rho_0 = 4 \\times 0.25\\,\\mathrm{g/cm^3} = 1.0\\,\\mathrm{g/cm^3} $$\n问题要求答案保留四位有效数字。因此，数值结果是 $\\rho_1 = 1.000\\,\\mathrm{g/cm^3}$。\n\n关于表格式物态方程影响的定性讨论：\n理想气体模型提供了一个有用的初步近似，但忽略了在稠密等离子体中发生的几个重要物理过程。一个真实的、表格式的物态方程，例如在ICF模拟中使用的那些（如SESAME表），则考虑了这些效应。对于给定条件（激波速度 $u_s=30\\,\\mathrm{km/s}$ 射入低温DT），与理想气体模型最显著的偏差来自于电离的能量成本。\n\n1.  **电离能**：$\\gamma=5/3$的理想气体模型含蓄地假设气体已经是完全电离的单原子粒子集合。实际上，激波传递的能量必须首先用于解离任何分子（例如$D_2$），然后用于电离氘和氚原子。这个电离过程代表了一个巨大的能量耗散项。对于激波后沉积的给定总能量，很大一部分被分配到电离的势能中，而不是粒子的动能（热能）中。这使得材料比理想气体模型预测的更“软”或更易压缩。这种效应可以用一个有效绝热指数 $\\gamma_{\\text{eff}} = 1 + p/(\\rho e)$ 来描述，在电离过程中该指数会低于$5/3$。由于压缩比为 $\\eta = (\\gamma_{\\text{eff}}+1)/(\\gamma_{\\text{eff}}-1)$，较低的 $\\gamma_{\\text{eff}}$ 会导致较高的压缩比。\n\n2.  **其他效应**：在由此产生的高密度（$\\rho_1=1.000\\,\\mathrm{g/cm^3}$）和高温（数百万开尔文）下，还存在其他非理想效应。\n    *   **电子简并**：电子的高密度会导致部分费米简并，此时泡利不相容原理变得重要。这会在压力中增加一个分量（简并压力），该分量强烈依赖于密度而非温度。这种效应提供了额外的压力支撑，使得材料比经典气体更“硬”，从而*减小*了压缩。\n    - **库仑相互作用**：等离子体足够稠密，以至于带电粒子（离子和电子）之间的相互作用不可忽略。与相同密度和温度下无相互作用粒子的理想气体相比，这些静电相互作用通常会降低总压力，这倾向于*增加*压缩。\n\n**讨论结论**：对于ICF内爆中在此条件下的第一道激波，区分真实物态方程和理想气体模型的主导效应是电离的能量成本。该效应显著地软化了物态方程，导致预测的压缩比远大于理想气体极限值$4$。其他效应（简并和库仑相互作用）也包含在表格式物态方程中，但对于这个特定的物理区域，它们次于电离效应。因此，一个真实的表格式物态方程会预测最终密度 $\\rho_1$ 高于此处计算出的 $1.000\\,\\mathrm{g/cm^3}$。",
            "answer": "$$\\boxed{1.000}$$"
        },
        {
            "introduction": "在ICF中，完美的球形对称是一个难以企及的理想状态，驱动的不均匀性是流体动力学不稳定性增长的主要来源。本练习旨在让你深入探究内爆稳定性的一个关键方面：模拟来自环空室的非均匀X射线驱动如何在烧蚀靶丸表面产生扰动的初始“种子”。你将学习使用勒让德多项式分解这些不对称性，并预测它们在烧蚀阵面上的初始印记，这对于理解和控制内爆至关重要。",
            "id": "3995271",
            "problem": "您的任务是为一个轴对称的惯性约束聚变 (ICF) 靶腔-靶丸构型建模，并计算烧蚀前沿上产生的扰动谱。入射到靶丸表面的X射线驱动表示为极角 $\\,\\theta\\,$ (单位为弧度) 的函数，由一个基线均匀通量加上一组有限的轴对称亮环组成，这些亮环近似了壁再发射和激光入口孔 (LEH) 的贡献。您的任务是构建靶丸上驱动的勒让德模式分解，并利用第一性原理线性响应，计算每个勒让德模式下随时间变化的烧蚀前沿扰动振幅。\n\n基本原理：\n- 单位球面上的轴对称标量场可以分解为勒让德多项式 $\\,P_\\ell(\\mu)\\,$，其中 $\\,\\mu = \\cos\\theta\\,$，其正交性为 $\\int_{-1}^{1} P_\\ell(\\mu) P_m(\\mu)\\,d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}$。\n- 辐射驱动相关的烧蚀运动学对烧蚀前沿速度 $\\,v_a\\,$ 使用局域幂律标度关系 $\\,v_a = C_v F^\\beta\\,$，其中 $\\,F\\,$ 是局域入射通量，$\\,C_v\\,$ 是一个与材料相关的比例常数，$\\,\\beta\\,$ 是一个在 $\\,\\left[\\frac{1}{3},\\frac{1}{2}\\right]\\,$ 范围内的标度指数，该关系由自相似辐射热波标度关系证明。\n- 在半径为 $\\,R\\,$、热扩散率为 $\\,D\\,$ 的球面上，横向热平滑遵循热方程 $\\,\\partial_t T = D \\nabla_s^2 T\\,$。对于轴对称勒让德模式 $\\,P_\\ell\\,$，曲面拉普拉斯算子的本征值为 $\\,\\ell(\\ell+1)/R^2\\,$，这意味着角向扰动随时间 $\\,t\\,$ 的扩散衰减因子为 $\\,\\exp\\!\\big(-D\\,\\ell(\\ell+1)\\,t/R^2\\big)\\,$。\n\n几何与驱动定义：\n- 设靶丸为半径为 $\\,R\\,$ (单位 $\\,\\mathrm{m}\\,$) 的球体。\n- 入射通量参数化为\n$$\nF(\\theta) = F_0\\Big(1 + \\sum_{i=1}^{N_r} w_i \\exp\\!\\Big[-\\frac{(\\theta - \\theta_i)^2}{2\\sigma_i^2}\\Big]\\Big),\n$$\n其中 $\\,F_0\\,$ (单位 $\\,\\mathrm{W/m^2}\\,$) 是基线均匀驱动，每个环由中心极角 $\\,\\theta_i\\,$ (单位为弧度)、无量纲亮度权重 $\\,w_i\\,$ 和角向半宽 $\\,\\sigma_i\\,$ (单位为弧度) 指定。求和索引 $\\,i\\,$ 遍历 $\\,N_r\\,$ 个环。\n\n勒让德模式分解：\n- 定义 $\\,\\mu = \\cos\\theta\\,$ 并通过以下方式定义勒让德系数 $\\,a_\\ell\\,$\n$$\na_\\ell = \\frac{2\\ell+1}{2} \\int_{-1}^{1} F(\\mu)\\,P_\\ell(\\mu)\\,d\\mu,\n$$\n其中 $\\,F(\\mu)\\equiv F(\\theta=\\arccos\\mu)\\,$。相对于平均值的模式振幅为 $\\,b_\\ell = \\frac{a_\\ell}{a_0}\\,$，其中 $\\,a_0\\,$ 是球面上的平均通量 $\\,\\big(a_0 = \\frac{1}{2}\\int_{-1}^{1}F(\\mu)\\,d\\mu\\big)\\,$。\n\n烧蚀前沿扰动谱：\n- 使用关于平均驱动的线性化运动学响应 $\\,v_a = C_v F^\\beta\\,$ 以及由曲面热方程所蕴含的扩散横向平滑，推导并计算对于 $\\,\\ell \\ge 1\\,$ 的随时间变化的烧蚀前沿位移振幅 $\\,\\delta R_\\ell(t)\\,$ (单位 $\\,\\mathrm{m}\\,$)，作为 $\\,R\\,$, $\\,D\\,$, $\\,t\\,$, $\\,C_v\\,$, $\\,\\beta\\,$ 和驱动谱 $\\,b_\\ell\\,$ 的函数。\n\n数值实现要求：\n- 在区间 $\\,\\mu\\in[-1,1]\\,$ 上，使用阶数至少为 $\\,N_q = 512\\,$ 的高斯-勒让德求积计算勒让德积分。角度必须使用弧度。\n- 使用 $\\,P_\\ell(\\mu)\\,$ 的三项递推关系生成最高到 $\\,\\ell_{\\max}\\,$ 的多项式。\n- 确保所有带有物理量纲的输出都以指定的单位表示。\n\n测试套件：\n针对以下四组参数集实现计算。每个案例定义了 $\\,F_0\\,$、环的列表 $\\,(\\theta_i,w_i,\\sigma_i)\\,$、$\\,\\ell_{\\max}\\,$、$\\,R\\,$、$\\,D\\,$、$\\,\\beta\\,$、$\\,t\\,$ 和 $\\,C_v\\,$。所有角度均以弧度为单位；位移振幅以 $\\,\\mathrm{m}\\,$ 表示。\n\n- 案例 $\\,1\\,$ (平衡的近LEH环，理想路径):\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - 环: $\\,[ (\\,\\theta_1=0.3\\,,\\,w_1=0.2\\,,\\,\\sigma_1=0.25\\,), (\\,\\theta_2=\\pi-0.3\\,,\\,w_2=0.2\\,,\\,\\sigma_2=0.25\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 8\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-6}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = \\frac{1}{3}\\,$, $\\,t = 5.0\\times 10^{-9}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.375\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n- 案例 $\\,2\\,$ (非对称环主导):\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - 环: $\\,[ (\\,\\theta_1=0.2\\,,\\,w_1=0.3\\,,\\,\\sigma_1=0.15\\,), (\\,\\theta_2=\\pi-0.6\\,,\\,w_2=0.05\\,,\\,\\sigma_2=0.20\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 10\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-6}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = 0.4\\,$, $\\,t = 5.0\\times 10^{-9}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.35\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n- 案例 $\\,3\\,$ (强横向平滑，边缘情况):\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - 环: $\\,[ (\\,\\theta_1=0.4\\,,\\,w_1=0.25\\,,\\,\\sigma_1=0.10\\,), (\\,\\theta_2=\\pi-0.4\\,,\\,w_2=0.25\\,,\\,\\sigma_2=0.10\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 12\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-4}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = \\frac{1}{3}\\,$, $\\,t = 5.0\\times 10^{-9}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.375\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n- 案例 $\\,4\\,$ (短时间极限，边界条件):\n  - $\\,F_0 = 5.0\\times 10^{14}\\,$ $\\,\\mathrm{W/m^2}\\,$\n  - 环: $\\,[ (\\,\\theta_1=0.3\\,,\\,w_1=0.15\\,,\\,\\sigma_1=0.25\\,), (\\,\\theta_2=\\pi-0.3\\,,\\,w_2=0.15\\,,\\,\\sigma_2=0.25\\,), (\\,\\theta_3=\\frac{\\pi}{2}\\,,\\,w_3=0.05\\,,\\,\\sigma_3=0.20\\,) ]\\,$\n  - $\\,\\ell_{\\max} = 6\\,$, $\\,R = 1.0\\times 10^{-3}\\,$ $\\,\\mathrm{m}\\,$, $\\,D = 5.0\\times 10^{-6}\\,$ $\\,\\mathrm{m^2/s}\\,$\n  - $\\,\\beta = 0.33\\,$, $\\,t = 1.0\\times 10^{-12}\\,$ $\\,\\mathrm{s}\\,$, $\\,C_v = 0.375\\,$ $\\,\\mathrm{m\\,s^{-1}\\,(W/m^2)^{-\\beta}}\\,$\n\n答案规格：\n- 对于每个案例，输出一个由 $\\,\\mathrm{m}\\,$ 为单位的浮点数组成的列表 $\\,\\big[\\delta R_1, \\delta R_2, \\dots, \\delta R_{\\ell_{\\max}}\\big]\\,$。\n- 您的程序应生成单行输出，其中包含所有案例的结果，形式为一个用方括号括起来的逗号分隔列表，其中每个元素是特定案例的列表（例如，$\\,[ [x_1,x_2], [y_1,y_2] ]\\,$）。不应打印任何附加文本。",
            "solution": "### 推导与解题策略\n\n该解决方案需要一个多步骤的程序，从入射通量分布开始，最终计算每个勒让德模式的烧蚀前沿位移振幅。\n\n**1. X射线驱动的勒让德分解**\n入射通量 $F(\\theta)$ 是靶丸表面的一个轴对称函数，可以分解为勒让德多项式 $P_\\ell(\\mu)$ 的级数，其中 $\\mu = \\cos\\theta$:\n$$ F(\\mu) = \\sum_{\\ell=0}^{\\infty} a_\\ell P_\\ell(\\mu) $$\n利用勒让德多项式的正交性，可以求得系数 $a_\\ell$:\n$$ a_\\ell = \\frac{2\\ell+1}{2} \\int_{-1}^{1} F(\\mu) P_\\ell(\\mu) \\,d\\mu $$\n问题给出了 $F(\\theta)$ 的函数形式，我们可以将其写为 $F(\\mu) = F(\\theta=\\arccos \\mu)$。$a_\\ell$ 的积分必须按规定使用高斯-勒让德求积法进行数值计算。系数 $a_0$ 对应于球面上的平均通量。对于每个模式 $\\ell \\geq 1$，归一化的扰动振幅为 $b_\\ell = a_\\ell / a_0$。\n\n**2. 扰动的时间演化**\n问题指出，角向扰动会受到横向热平滑的影响。因此，给定模式 $\\ell$ 在烧蚀前沿的有效通量扰动不是静态的，而是由于这种扩散过程而随时间衰减。该衰减由因子 $\\exp(-D\\,\\ell(\\ell+1)\\,t/R^2)$ 描述。因此，模式 $\\ell$ 在时间 $t$ 的通量扰动振幅为：\n$$ \\delta F_\\ell(t) = a_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right) $$\n烧蚀前沿的总通量是平均通量与随时间演化的扰动之和：\n$$ F(\\mu, t) = a_0 + \\sum_{\\ell=1}^{\\ell_{\\max}} \\delta F_\\ell(t) P_\\ell(\\mu) $$\n\n**3. 线性化的烧蚀速度**\n烧蚀前沿速度 $v_a$ 与通量 $F$ 通过幂律关系 $v_a = C_v F^\\beta$ 相关。为了找到对小扰动的响应，我们在平均通量 $a_0$ 附近线性化此表达式。令 $F(\\mu, t) = a_0(1 + \\epsilon(\\mu, t))$，其中 $\\epsilon(\\mu, t) = (F(\\mu, t) - a_0) / a_0 \\ll 1$。\n$$ v_a(\\mu, t) = C_v [a_0(1 + \\epsilon(\\mu, t))]^\\beta \\approx C_v a_0^\\beta (1 + \\beta \\epsilon(\\mu, t)) = v_{a,0} + \\beta v_{a,0} \\epsilon(\\mu, t) $$\n其中 $v_{a,0} = C_v a_0^\\beta$ 是平均烧蚀速度。烧蚀速度的扰动 $\\delta v_a(\\mu, t) = v_a(\\mu, t) - v_{a,0}$ 为：\n$$ \\delta v_a(\\mu, t) \\approx \\frac{\\beta v_{a,0}}{a_0} \\sum_{\\ell=1}^{\\ell_{\\max}} a_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right) P_\\ell(\\mu) $$\n因此，模式 $\\ell$ 的烧蚀速度扰动振幅为：\n$$ \\delta v_{a,\\ell}(t) = \\beta v_{a,0} b_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right) $$\n\n**4. 烧蚀前沿位移振幅**\n烧蚀前沿的位移振幅 $\\delta R_\\ell(t)$ 是速度扰动振幅 $\\delta v_{a,\\ell}(t)$ 的时间积分：\n$$ \\delta R_\\ell(t) = \\int_0^t \\delta v_{a,\\ell}(t') \\,dt' = \\int_0^t \\beta v_{a,0} b_\\ell \\exp\\left(-\\frac{D\\ell(\\ell+1)t'}{R^2}\\right) \\,dt' $$\n进行积分得到最终表达式：\n$$ \\delta R_\\ell(t) = \\beta v_{a,0} b_\\ell \\frac{R^2}{D\\ell(\\ell+1)} \\left(1 - \\exp\\left(-\\frac{D\\ell(\\ell+1)t}{R^2}\\right)\\right) $$\n这就是模式 $\\ell \\ge 1$ 的烧蚀前沿位移振幅的最终表达式。\n\n**5. 数值实现**\n对于每个测试案例，算法如下：\n1.  使用高斯-勒让德求积设置 $N_q=512$ 个求积点 $\\mu_j$ 和权重 $w_j$。\n2.  使用三项递推关系生成勒让德多项式 $P_\\ell(\\mu_j)$ 的值。\n3.  在所有求积点上计算通量函数 $F(\\mu_j)$。\n4.  通过数值积分计算系数 $a_\\ell$。\n5.  提取平均通量 $a_0$ 并计算平均烧蚀速度 $v_{a,0}$。\n6.  对于每个模式 $\\ell = 1, \\dots, \\ell_{\\max}$，计算相对振幅 $b_\\ell$ 和位移 $\\delta R_\\ell(t)$。为避免数值误差，对于指数项参数很小的情况，使用泰勒展开近似或 `expm1` 等稳定计算方法。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ablation-front perturbation spectrum for an ICF capsule\n    driven by an axisymmetric x-ray flux.\n    \"\"\"\n\n    # Numerical quadrature order as specified\n    N_q = 512\n\n    # Test cases from the problem statement\n    test_cases = [\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.3, 0.2, 0.25), (np.pi - 0.3, 0.2, 0.25)],\n            \"ell_max\": 8, \"R\": 1.0e-3, \"D\": 5.0e-6, \"beta\": 1.0/3.0,\n            \"t\": 5.0e-9, \"Cv\": 0.375\n        },\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.2, 0.3, 0.15), (np.pi - 0.6, 0.05, 0.20)],\n            \"ell_max\": 10, \"R\": 1.0e-3, \"D\": 5.0e-6, \"beta\": 0.4,\n            \"t\": 5.0e-9, \"Cv\": 0.35\n        },\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.4, 0.25, 0.10), (np.pi - 0.4, 0.25, 0.10)],\n            \"ell_max\": 12, \"R\": 1.0e-3, \"D\": 5.0e-4, \"beta\": 1.0/3.0,\n            \"t\": 5.0e-9, \"Cv\": 0.375\n        },\n        {\n            \"F0\": 5.0e14,\n            \"rings\": [(0.3, 0.15, 0.25), (np.pi - 0.3, 0.15, 0.25), (np.pi/2.0, 0.05, 0.20)],\n            \"ell_max\": 6, \"R\": 1.0e-3, \"D\": 5.0e-6, \"beta\": 0.33,\n            \"t\": 1.0e-12, \"Cv\": 0.375\n        }\n    ]\n\n    all_results = []\n    \n    # Get Gaussian-Legendre quadrature nodes (mu) and weights\n    mu_nodes, weights = np.polynomial.legendre.leggauss(N_q)\n\n    for case in test_cases:\n        F0 = case[\"F0\"]\n        rings = case[\"rings\"]\n        ell_max = case[\"ell_max\"]\n        R = case[\"R\"]\n        D = case[\"D\"]\n        beta = case[\"beta\"]\n        t = case[\"t\"]\n        Cv = case[\"Cv\"]\n\n        # 1. Generate Legendre polynomials P_l(mu) using three-term recurrence\n        P_l_mu = np.zeros((ell_max + 1, N_q))\n        P_l_mu[0, :] = 1.0\n        if ell_max > 0:\n            P_l_mu[1, :] = mu_nodes\n        for l in range(1, ell_max):\n            P_l_mu[l + 1, :] = ((2 * l + 1) * mu_nodes * P_l_mu[l, :] - l * P_l_mu[l - 1, :]) / (l + 1)\n\n        # 2. Define and evaluate the flux function F(mu)\n        theta_nodes = np.arccos(mu_nodes)\n        flux_perturbation = np.zeros(N_q)\n        for theta_i, w_i, sigma_i in rings:\n            flux_perturbation += w_i * np.exp(-(theta_nodes - theta_i)**2 / (2 * sigma_i**2))\n        \n        F_mu = F0 * (1.0 + flux_perturbation)\n\n        # 3. Compute Legendre coefficients a_l\n        a_coeffs = np.zeros(ell_max + 1)\n        l_range = np.arange(ell_max + 1)\n        # Numerical integration: integral(F * P_l) dmu ~= sum(weights * F * P_l)\n        integrals = np.sum(weights[:, np.newaxis] * F_mu[:, np.newaxis] * P_l_mu.T, axis=0)\n        a_coeffs = (2 * l_range + 1) / 2.0 * integrals\n\n        # 4. Calculate perturbation displacements delta_R_l\n        a0 = a_coeffs[0]\n        v_a0 = Cv * (a0**beta)\n\n        delta_R_l_list = []\n        for l in range(1, ell_max + 1):\n            b_l = a_coeffs[l] / a0\n\n            # Calculate the time-integrated-and-smoothed term\n            exponent_arg = D * l * (l + 1) * t / (R**2)\n            \n            # Use numerically stable method for the integral part to avoid 0/0 or cancellation\n            if exponent_arg  1e-8: # for small arguments, integral is approximately t\n                time_integral_term = t\n            else:\n                # integral is (1 - exp(-x)) / (x/t) = t * (1 - exp(-x))/x\n                # where x = exponent_arg\n                time_integral_term = (R**2 / (D * l * (l + 1))) * (1.0 - np.exp(-exponent_arg))\n\n            delta_R_l = beta * v_a0 * b_l * time_integral_term\n            delta_R_l_list.append(delta_R_l)\n            \n        all_results.append(delta_R_l_list)\n\n    # Format output as a list of lists, matching the example format logic\n    # e.g., [[val1, val2],[val3,val4]]\n    # This is achieved by creating a string from each inner list, joining them with commas,\n    -    # and enclosing the result in brackets.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "内爆的最终阶段是停滞，此时靶丸壳层的动能转化为高压高温的热斑，从而引发聚变反应。这个最后的练习使用一个降阶模型来探索停滞阶段精细的能量平衡，更关键的是，它将引导你量化驱动压力和材料属性（如热导率 $\\kappa$ 和绝热指数 $\\gamma$）的不确定性如何传播并最终影响聚变产额。这项实践介绍了在复杂物理模型中进行不确定性量化（UQ）这一前沿且至关重要的技能。",
            "id": "3995266",
            "problem": "给定一个用于惯性约束聚变（ICF）内爆热斑的降阶滞止模型，用于将驱动和材料参数的不确定性传播到无量纲产额代理中。目标是构建一个程序，对于每个测试案例，通过线性不确定性传播计算相对产额的误差预算，并确定参数中的主要贡献者。背景是惯性约束聚变的基本原理，涉及内爆动力学和热斑形成，其推导始于热力学和输运的第一性原理。\n\n假设和模型规范：\n- 热斑被建模为一个均匀的球形等离子体，半径为 $R$，质量密度为 $\\rho_h$，约束时间为 $\\tau$。\n- 等离子体是氘-氚（DT）混合物；平均离子质量为 $m_i$，有效粒子数密度为 $n_{\\mathrm{eff}} = (1+Z) n_i$，其中 $Z=1$，因此 $n_{\\mathrm{eff}} = 2 \\rho_h / m_i$。\n- 对完全电离的DT等离子体使用理想气体状态方程（EOS），$P = n_{\\mathrm{eff}} k_B T$。\n- 热力学第一定律给出热斑内能为 $U = P V / (\\gamma - 1)$，其中 $\\gamma$ 是有效绝热指数。\n- 传递给热斑的压缩功建模为 $W_{\\mathrm{in}} = \\eta_w P_a V$，其中 $P_a$ 是吸收的驱动压力，$\\eta_w \\in (0,1)$ 是一个考虑了流体动力学分配和激波加热的耦合效率。\n- 热传导损失通过傅里叶热传导在约束时间内建模，$Q_{\\mathrm{cond}} \\approx \\kappa \\, A \\, \\Delta T \\, \\tau / L$，其中面积 $A = 4 \\pi R^2$，特征梯度长度 $L \\approx R$，$\\kappa$ 是热导率，对于陡峭梯度 $\\Delta T \\approx T$。因此 $Q_{\\mathrm{cond}} \\approx \\kappa \\, (4 \\pi R) \\, \\tau \\, T$。\n\n滞止时的能量平衡为\n$$\n\\frac{n_{\\mathrm{eff}} k_B T \\, V}{\\gamma - 1} \\;=\\; \\eta_w P_a V \\;-\\; \\kappa \\, (4 \\pi R) \\, \\tau \\, T.\n$$\n求解 $T$ 以获得降阶滞止温度\n$$\nT(P_a,\\gamma,\\kappa) \\;=\\; \\frac{\\eta_w P_a V}{\\displaystyle \\frac{n_{\\mathrm{eff}} k_B V}{\\gamma - 1} \\;+\\; \\kappa \\,(4 \\pi R)\\, \\tau } \\;=\\; \\frac{\\eta_w P_a V}{A(\\gamma) + B \\kappa},\n$$\n其中定义 $A(\\gamma) = C_V / (\\gamma - 1)$，$C_V = n_{\\mathrm{eff}} k_B V$ 和 $B = 4 \\pi R \\tau$。\n\n使用对氘-氚聚变反应率因子 $\\langle \\sigma v \\rangle(T)$ 的局部幂律近似来定义一个无量纲产额代理 $Y_{\\mathrm{rel}}$，其中对于给定平均值附近的温度，$\\langle\\sigma v\\rangle(T) \\approx C_s T^{n_r}$。令相对产额为\n$$\nY_{\\mathrm{rel}}(P_a,\\gamma,\\kappa) \\;=\\; \\left( \\frac{ T(P_a,\\gamma,\\kappa) }{ T_\\mu } \\right)^{n_r},\n$$\n其中 $T_\\mu = T(P_{a,\\mu},\\gamma_\\mu,\\kappa_\\mu)$ 是测试案例的平均温度，$n_r$ 是一个局部指数（取 $n_r = 2$）。\n\n不确定性传播：\n- 假设 $P_a$、$\\gamma$ 和 $\\kappa$ 上的不确定性是独立的、正态分布的，具有给定的均值和标准差。\n- 对 $Y_{\\mathrm{rel}}$ 使用一阶线性不确定性传播：\n$$\n\\sigma_Y^2 \\;\\approx\\; \\left( \\frac{\\partial Y}{\\partial P_a} \\right)^2 \\sigma_{P_a}^2 \\;+\\; \\left( \\frac{\\partial Y}{\\partial \\gamma} \\right)^2 \\sigma_{\\gamma}^2 \\;+\\; \\left( \\frac{\\partial Y}{\\partial \\kappa} \\right)^2 \\sigma_{\\kappa}^2,\n$$\n在每个测试案例的参数均值处求值。偏导数根据链式法则得出，\n$$\n\\frac{\\partial Y}{\\partial \\theta} \\;=\\; \\frac{n_r}{T_\\mu} \\, \\frac{\\partial T}{\\partial \\theta}, \\quad \\theta \\in \\{P_a,\\gamma,\\kappa\\},\n$$\n其中\n$$\n\\frac{\\partial T}{\\partial P_a} = \\frac{\\eta_w V}{A(\\gamma)+B\\kappa}, \\quad\n\\frac{\\partial T}{\\partial \\kappa} = -\\frac{\\eta_w P_a V \\, B}{\\left[A(\\gamma)+B\\kappa\\right]^2}, \\quad\n\\frac{\\partial T}{\\partial \\gamma} = \\frac{\\eta_w P_a V }{\\left[A(\\gamma)+B\\kappa\\right]^2} \\, \\frac{C_V}{(\\gamma - 1)^2}.\n$$\n\n误差预算和主要贡献者：\n- 定义贡献分量 $C_{P_a} = \\left( \\frac{\\partial Y}{\\partial P_a} \\right)^2 \\sigma_{P_a}^2$、$C_{\\gamma} = \\left( \\frac{\\partial Y}{\\partial \\gamma} \\right)^2 \\sigma_{\\gamma}^2$ 和 $C_{\\kappa} = \\left( \\frac{\\partial Y}{\\partial \\kappa} \\right)^2 \\sigma_{\\kappa}^2$，以及总方差 $\\sigma_Y^2 = C_{P_a} + C_{\\gamma} + C_{\\kappa}$。\n- 分数贡献为 $f_{P_a} = C_{P_a}/\\sigma_Y^2$，$f_{\\gamma} = C_{\\gamma}/\\sigma_Y^2$，$f_{\\kappa} = C_{\\kappa}/\\sigma_Y^2$。\n- 主要贡献者是最大 $C_i$ 的索引，若出现平局，则由最低的索引决定。使用索引映射 $0 \\rightarrow P_a$，$1 \\rightarrow \\gamma$，$2 \\rightarrow \\kappa$。\n\n所有案例中使用的物理常数和几何参数：\n- 玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23} \\,\\mathrm{J/K}$。\n- 原子质量单位 $m_u = 1.66053906660 \\times 10^{-27} \\,\\mathrm{kg}$。\n- 平均离子质量 $m_i = 2.5 \\, m_u$。\n- 热斑密度 $\\rho_h = 10 \\,\\mathrm{kg/m^3}$。\n- 半径 $R = 30 \\,\\mu\\mathrm{m} = 30 \\times 10^{-6} \\,\\mathrm{m}$。\n- 约束时间 $\\tau = 100 \\,\\mathrm{ps} = 100 \\times 10^{-12} \\,\\mathrm{s}$。\n- 体积 $V = \\frac{4}{3} \\pi R^3$。\n- 耦合效率 $\\eta_w = 0.6$。\n- 反应性指数 $n_r = 2$。\n\n单位：\n- $P_a$ 使用 $\\mathrm{Pa}$，$\\gamma$ 无量纲，$\\kappa$ 使用 $\\mathrm{W/(m \\cdot K)}$。程序必须输出 $Y_{\\mathrm{rel}}$ 的无量纲标准差和表示为小数的无量纲分数贡献。\n\n测试套件：\n- 案例 1：均值 $P_{a,\\mu} = 2.0 \\times 10^{13} \\,\\mathrm{Pa}$，$\\gamma_\\mu = 1.35$，$\\kappa_\\mu = 10.0 \\,\\mathrm{W/(m \\cdot K)}$。标准差 $\\sigma_{P_a} = 0.05 \\, P_{a,\\mu}$，$\\sigma_{\\gamma} = 0.02$，$\\sigma_{\\kappa} = 0.10 \\, \\kappa_\\mu$。\n- 案例 2：均值 $P_{a,\\mu} = 2.0 \\times 10^{13} \\,\\mathrm{Pa}$，$\\gamma_\\mu = 1.35$，$\\kappa_\\mu = 100.0 \\,\\mathrm{W/(m \\cdot K)}$。标准差 $\\sigma_{P_a} = 0.05 \\, P_{a,\\mu}$，$\\sigma_{\\gamma} = 0.02$，$\\sigma_{\\kappa} = 30.0$。\n- 案例 3：均值 $P_{a,\\mu} = 2.5 \\times 10^{13} \\,\\mathrm{Pa}$，$\\gamma_\\mu = 1.15$，$\\kappa_\\mu = 10.0 \\,\\mathrm{W/(m \\cdot K)}$。标准差 $\\sigma_{P_a} = 0.05 \\, P_{a,\\mu}$，$\\sigma_{\\gamma} = 0.03$，$\\sigma_{\\kappa} = 0.50$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，包含结果，格式为一个逗号分隔的列表，其中包含三个内部列表。每个内部列表对应一个测试案例，并按顺序包含五个元素：$[\\sigma_Y, f_{P_a}, f_{\\gamma}, f_{\\kappa}, \\text{dominant\\_index}]$，其中 $\\sigma_Y$、$f_{P_a}$、$f_{\\gamma}$ 和 $f_{\\kappa}$ 四舍五入到六位小数，$\\text{dominant\\_index}$ 是一个整数。例如：$[[0.123456,0.4,0.5,0.1,1],[...],[...]]$.",
            "solution": "### 解题思路与算法设计\n\n这个问题的核心是计算不确定性对产额代理 $Y_{\\mathrm{rel}}$ 方差的贡献 $C_\\theta$。$Y_{\\mathrm{rel}}$ 的总方差由 $\\sigma_Y^2 \\approx \\sum_\\theta C_\\theta$ 给出，其中 $C_\\theta = (\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial \\theta} \\sigma_\\theta)^2$。所有导数都在参数的平均值处计算，此时 $T=T_\\mu$ 且 $Y_{\\mathrm{rel}}=1$。\n\n根据链式法则，$\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial \\theta} = \\frac{\\partial Y_{\\mathrm{rel}}}{\\partial T} \\frac{\\partial T}{\\partial \\theta}$。\n其中 $\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial T} = n_r \\frac{T^{n_r-1}}{T_\\mu^{n_r}}$。在 $T=T_\\mu$ 处计算，该导数值为 $\\frac{n_r}{T_\\mu}$。\n因此，$\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial \\theta} |_\\mu = \\frac{n_r}{T_\\mu} \\frac{\\partial T}{\\partial \\theta} |_\\mu$。\n\n我们可以推导各项方差贡献的表达式：\n1.  **$P_a$ 的贡献**:\n    由于 $T \\propto P_a$，可以推断 $\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial P_a} \\sigma_{P_a} = n_r \\frac{\\sigma_{P_a}}{P_{a,\\mu}}$。\n    $$C_{P_a} = \\left( n_r \\frac{\\sigma_{P_a}}{P_{a,\\mu}} \\right)^2$$\n\n2.  **$\\gamma$ 的贡献**:\n    利用问题中给出的 $\\frac{\\partial T}{\\partial \\gamma}$ 表达式：\n    $\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial \\gamma} \\sigma_\\gamma |_\\mu = \\frac{n_r}{T_\\mu} \\left( \\frac{\\eta_w P_a V C_V}{(A(\\gamma)+B\\kappa)^2 (\\gamma - 1)^2} \\right) \\sigma_\\gamma = n_r \\frac{A_\\mu}{A_\\mu+B\\kappa_\\mu} \\frac{\\sigma_\\gamma}{\\gamma_\\mu-1}$。\n    $$C_{\\gamma} = \\left( n_r \\frac{A_\\mu}{A_\\mu+B\\kappa_\\mu} \\frac{\\sigma_\\gamma}{\\gamma_\\mu-1} \\right)^2$$\n\n3.  **$\\kappa$ 的贡献**:\n    利用问题中给出的 $\\frac{\\partial T}{\\partial \\kappa}$ 表达式：\n    $\\frac{\\partial Y_{\\mathrm{rel}}}{\\partial \\kappa} \\sigma_\\kappa |_\\mu = \\frac{n_r}{T_\\mu} \\left( -\\frac{\\eta_w P_a V B}{(A(\\gamma)+B\\kappa)^2} \\right) \\sigma_\\kappa = -n_r \\frac{B\\kappa_\\mu}{A_\\mu+B\\kappa_\\mu} \\frac{\\sigma_\\kappa}{\\kappa_\\mu}$。\n    $$C_{\\kappa} = \\left( n_r \\frac{B\\kappa_\\mu}{A_\\mu+B\\kappa_\\mu} \\frac{\\sigma_\\kappa}{\\kappa_\\mu} \\right)^2$$\n\n**算法流程如下：**\n\n1.  **预计算**：\n    - 定义所有物理和模型常数 ($k_B, m_u, \\rho_h, R, \\tau, \\eta_w, n_r$ 等)。\n    - 计算所有测试案例中通用的派生常数，如热斑体积 $V$、热容项 $C_V$ 和传导几何因子 $B$。\n\n2.  **逐案例计算**：\n    - 对每个测试案例，首先确定各参数的平均值和绝对标准差。\n    - 计算在平均值处的项 $A_\\mu = C_V / (\\gamma_\\mu - 1)$。\n    - 使用上述推导出的公式计算单个方差贡献 $C_{P_a}$、$C_{\\gamma}$ 和 $C_{\\kappa}$。\n    - 将各贡献相加得到总方差 $\\sigma_Y^2$，然后取平方根得到标准差 $\\sigma_Y$。\n    - 计算各参数的相对贡献分数 $f_\\theta = C_\\theta / \\sigma_Y^2$。\n    - 查找 $[C_{P_a}, C_{\\gamma}, C_{\\kappa}]$ 中的最大值，其索引即为主要贡献者。\n\n3.  **格式化输出**：\n    - 整理每个案例的结果，按要求四舍五入，并组合成最终的字符串格式。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ICF hot spot uncertainty propagation problem.\n\n    The function computes the error budget for a relative yield proxy based on a\n    reduced-order stagnation model. It uses first-order linear uncertainty\n    propagation to determine the contributions from uncertainties in drive\n    pressure (P_a), adiabatic index (gamma), and thermal conductivity (kappa).\n    \"\"\"\n\n    # Physical constants and geometry (SI units)\n    k_B = 1.380649e-23  # Boltzmann constant, J/K\n    m_u = 1.66053906660e-27  # Atomic mass unit, kg\n    m_i = 2.5 * m_u  # Mean ion mass for DT plasma, kg\n    rho_h = 10.0  # Hot spot density, kg/m^3\n    R = 30.0e-6  # Hot spot radius, m\n    tau = 100.0e-12  # Confinement time, s\n    eta_w = 0.6  # Coupling efficiency, dimensionless\n    n_r = 2.0  # Reactivity exponent, dimensionless\n\n    # Derived constants independent of test cases\n    V = (4.0 / 3.0) * np.pi * R**3\n    n_eff = 2.0 * rho_h / m_i\n    C_V = n_eff * k_B * V\n    B = 4.0 * np.pi * R * tau\n\n    # Test suite: [(P_a_mu, gamma_mu, kappa_mu), (sigma_Pa_info, sigma_gamma, sigma_kappa_info)]\n    # Info is (value, is_relative_flag)\n    test_cases = [\n        ((2.0e13, 1.35, 10.0), ((0.05, True), 0.02, (0.10, True))),\n        ((2.0e13, 1.35, 100.0), ((0.05, True), 0.02, (30.0, False))),\n        ((2.5e13, 1.15, 10.0), ((0.05, True), 0.03, (0.50, False))),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        means, std_dev_info = case\n        P_a_mu, gamma_mu, kappa_mu = means\n        \n        # Unpack and calculate absolute standard deviations\n        sigma_Pa_info, sigma_gamma, sigma_kappa_info = std_dev_info\n        \n        sigma_Pa = sigma_Pa_info[0] * P_a_mu if sigma_Pa_info[1] else sigma_Pa_info[0]\n        sigma_kappa = sigma_kappa_info[0] * kappa_mu if sigma_kappa_info[1] else sigma_kappa_info[0]\n\n        # Calculate terms evaluated at mean values\n        A_mu = C_V / (gamma_mu - 1.0)\n        denom = A_mu + B * kappa_mu\n\n        # Calculate variance contributions using derived formulas\n        \n        # Contribution from P_a\n        C_Pa = (n_r * (sigma_Pa / P_a_mu))**2\n\n        # Contribution from gamma\n        C_gamma = (n_r * (A_mu / denom) * (sigma_gamma / (gamma_mu - 1.0)))**2\n\n        # Contribution from kappa\n        C_kappa = (n_r * (B * kappa_mu / denom) * (sigma_kappa / kappa_mu))**2\n\n        # Total variance and standard deviation\n        contributions = np.array([C_Pa, C_gamma, C_kappa])\n        sigma_Y_sq = np.sum(contributions)\n        sigma_Y = np.sqrt(sigma_Y_sq) if sigma_Y_sq > 0 else 0.0\n\n        # Fractional contributions\n        if sigma_Y_sq > 0:\n            f_Pa = C_Pa / sigma_Y_sq\n            f_gamma = C_gamma / sigma_Y_sq\n            f_kappa = C_kappa / sigma_Y_sq\n        else:\n            f_Pa, f_gamma, f_kappa = 0.0, 0.0, 0.0\n\n        # Dominant contributor index\n        dominant_index = int(np.argmax(contributions))\n        \n        # Format results for the current case\n        case_results = [\n            round(sigma_Y, 6),\n            round(f_Pa, 6),\n            round(f_gamma, 6),\n            round(f_kappa, 6),\n            dominant_index\n        ]\n        all_results.append(case_results)\n\n    # Construct the final output string per exact specification\n    result_strings = []\n    for res in all_results:\n        # Convert each item in the inner list to its string representation\n        # and join with commas. This avoids spaces that str(list) would add.\n        inner_str = '[' + ','.join(map(str, res)) + ']'\n        result_strings.append(inner_str)\n    \n    final_output = '[' + ','.join(result_strings) + ']'\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}