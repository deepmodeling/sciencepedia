{
    "hands_on_practices": [
        {
            "introduction": "温稠密物质（WDM）中的离子经常被近似为单组分等离子体（OCP）模型。这项练习  将从流体动力学和电磁学的基本定律出发，推导等离子体中一个最基本的集体行为——离子等离子体振荡。通过从第一性原理推导离子等离子体频率，本实践旨在加深对等离子体集体模态及其在振动光谱中作用的理解。",
            "id": "4063408",
            "problem": "在用于计算聚变科学与工程的温稠密物质建模中，离子组分通常被近似为单组分等离子体 (OCP)，即一个由电荷数为 $Z^{\\ast}$ 的离子组成的系统，这些离子在刚性、空间均匀、中和的电子背景中运动。考虑一个碳温稠密物质状态，其质量密度 $\\rho = 3.5 \\,\\mathrm{g/cm^3}$，平均电离度 $Z^{\\ast} = 4$。离子是碳原子核，质量为 $m_{i} = 12\\,u$，其中 $u$ 是原子质量单位。假设离子流体是经典的，并处于冷离子极限下，因此离子热压和粘性可以忽略。假设电子背景是均匀的，并且在离子运动的时间尺度上是动力学惰性的。\n\n仅从离子连续性方程、包含库仑力的离子动量方程以及电场的高斯定律出发，在均匀平衡态附近进行线性化，并求出离子密度的小振幅纵向集体模式。解释为什么在 $k \\to 0$ 极限下，该模式表现为离子纵向振动谱（即纵向流谱密度和相应的动态结构因子）的主峰。然后，对于给定的状态，计算该模式的角频率。\n\n使用以下常数：基本电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，真空介电常数 $\\epsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$，以及原子质量单位 $u = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。将你的最终答案表示为以 $\\mathrm{rad/s}$ 为单位的角频率，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导单组分等离子体 (OCP) 的纵向集体模式，并计算给定碳温稠密物质状态下其频率。\n\n该模型基于对离子的经典流体描述，离子的电荷为 $q_i = Z^{\\ast}e$，质量为 $m_i$，在刚性、均匀、中和的电子背景中运动。根据题意，控制方程为离子连续性方程、离子动量方程（在冷离子、无粘性极限下）以及电场的高斯定律。\n\n控制方程为：\n1.  离子连续性方程：\n    $$ \\frac{\\partial n_i}{\\partial t} + \\nabla \\cdot (n_i \\mathbf{v}_i) = 0 $$\n    其中 $n_i(\\mathbf{r}, t)$ 是离子数密度，$\\mathbf{v}_i(\\mathbf{r}, t)$ 是离子流体速度。\n\n2.  离子动量方程（欧拉方程）：\n    $$ m_i \\left( \\frac{\\partial \\mathbf{v}_i}{\\partial t} + (\\mathbf{v}_i \\cdot \\nabla) \\mathbf{v}_i \\right) = q_i \\mathbf{E} $$\n    由于忽略了热压和粘性，作用在流体元上的唯一力是电力（库仑力）$q_i \\mathbf{E}$，其中 $\\mathbf{E}(\\mathbf{r}, t)$ 是电场，而 $q_i = Z^{\\ast}e$。\n\n3.  高斯定律：\n    $$ \\nabla \\cdot \\mathbf{E} = \\frac{\\rho_{\\text{charge}}}{\\epsilon_0} $$\n    总电荷密度 $\\rho_{\\text{charge}}$ 是离子电荷密度和电子电荷密度之和。系统在平衡状态下是电中性的，因此 $q_i n_{i0} + q_e n_{e0} = 0$，其中 $n_{i0}$ 和 $n_{e0}$ 分别是离子和电子的平衡数密度，且 $q_e = -e$。由于电子背景是均匀且刚性的，其密度是恒定的，$n_e(\\mathbf{r}, t) = n_{e0} = \\frac{Z^{\\ast}e}{e}n_{i0} = Z^{\\ast}n_{i0}$。产生电场的净电荷密度是由于离子密度对其平衡值的局域偏离：\n    $$ \\rho_{\\text{charge}} = q_i n_i - e n_e = Z^{\\ast}e n_i - e (Z^{\\ast}n_{i0}) = Z^{\\ast}e (n_i - n_{i0}) $$\n    因此，高斯定律变为：\n    $$ \\nabla \\cdot \\mathbf{E} = \\frac{Z^{\\ast}e(n_i - n_{i0})}{\\epsilon_0} $$\n\n为了找到小振幅模式，我们在一个静态、均匀的平衡态（$n_i = n_{i0}$，$\\mathbf{v}_i = \\mathbf{0}$ 和 $\\mathbf{E} = \\mathbf{0}$）附近对这些方程进行线性化。我们将场表示为其平衡值与一个小扰动的和：\n$n_i(\\mathbf{r}, t) = n_{i0} + \\delta n_i(\\mathbf{r}, t)$\n$\\mathbf{v}_i(\\mathbf{r}, t) = \\mathbf{0} + \\delta \\mathbf{v}_i(\\mathbf{r}, t)$\n$\\mathbf{E}(\\mathbf{r}, t) = \\mathbf{0} + \\delta \\mathbf{E}(\\mathbf{r}, t)$\n\n将这些代入控制方程并只保留扰动的一阶项，得到线性化方程：\n1.  线性化连续性方程：\n    $$ \\frac{\\partial \\delta n_i}{\\partial t} + n_{i0} \\nabla \\cdot \\delta \\mathbf{v}_i = 0 $$\n\n2.  线性化动量方程：\n    $$ m_i \\frac{\\partial \\delta \\mathbf{v}_i}{\\partial t} = Z^{\\ast}e \\delta \\mathbf{E} $$\n\n3.  线性化高斯定律：\n    $$ \\nabla \\cdot \\delta \\mathbf{E} = \\frac{Z^{\\ast}e \\delta n_i}{\\epsilon_0} $$\n\n我们寻找形如 $\\exp(i(\\mathbf{k} \\cdot \\mathbf{r} - \\omega t))$ 的平面波解作为扰动，其中 $\\mathbf{k}$ 是波矢，$\\omega$ 是角频率。在此假设下，微分算符变换为 $\\frac{\\partial}{\\partial t} \\to -i\\omega$ 和 $\\nabla \\to i\\mathbf{k}$。线性化方程变成关于扰动振幅（用波浪号表示）的一组代数方程：\n1.  $-i\\omega \\delta \\tilde{n}_i + n_{i0} (i\\mathbf{k} \\cdot \\delta \\tilde{\\mathbf{v}}_i) = 0 \\implies \\omega \\delta \\tilde{n}_i = n_{i0} (\\mathbf{k} \\cdot \\delta \\tilde{\\mathbf{v}}_i)$\n2.  $m_i (-i\\omega) \\delta \\tilde{\\mathbf{v}}_i = Z^{\\ast}e \\delta \\tilde{\\mathbf{E}} \\implies \\delta \\tilde{\\mathbf{v}}_i = \\frac{i Z^{\\ast}e}{m_i \\omega} \\delta \\tilde{\\mathbf{E}}$\n3.  $i\\mathbf{k} \\cdot \\delta \\tilde{\\mathbf{E}} = \\frac{Z^{\\ast}e \\delta \\tilde{n}_i}{\\epsilon_0}$\n\n问题要求的是纵向模式，对于这种模式，矢量扰动平行于波矢 $\\mathbf{k}$。因此，$\\mathbf{k} \\cdot \\delta \\tilde{\\mathbf{v}}_i = k \\delta \\tilde{v}_i$ 且 $\\mathbf{k} \\cdot \\delta \\tilde{\\mathbf{E}} = k \\delta \\tilde{E}$。方程简化为：\n1.  $\\omega \\delta \\tilde{n}_i = n_{i0} k \\delta \\tilde{v}_i$\n2.  $\\delta \\tilde{v}_i = \\frac{i Z^{\\ast}e}{m_i \\omega} \\delta \\tilde{E}$\n3.  $ik \\delta \\tilde{E} = \\frac{Z^{\\ast}e \\delta \\tilde{n}_i}{\\epsilon_0}$\n\n现在我们联立这些方程以找到色散关系 $\\omega(k)$。将(2)代入(1)：\n$$ \\omega \\delta \\tilde{n}_i = n_{i0} k \\left( \\frac{i Z^{\\ast}e}{m_i \\omega} \\delta \\tilde{E} \\right) \\implies \\delta \\tilde{n}_i = \\frac{i n_{i0} k Z^{\\ast}e}{m_i \\omega^2} \\delta \\tilde{E} $$\n接下来，将这个 $\\delta \\tilde{n}_i$ 的表达式代入(3)：\n$$ ik \\delta \\tilde{E} = \\frac{Z^{\\ast}e}{\\epsilon_0} \\left( \\frac{i n_{i0} k Z^{\\ast}e}{m_i \\omega^2} \\delta \\tilde{E} \\right) $$\n对于非平庸解（$\\delta \\tilde{E} \\neq 0$），我们可以从两边消去 $ik \\delta \\tilde{E}$（对于 $k \\neq 0$）：\n$$ 1 = \\frac{(Z^{\\ast}e)^2 n_{i0}}{\\epsilon_0 m_i \\omega^2} $$\n求解 $\\omega^2$ 得出集体模式的频率：\n$$ \\omega^2 = \\frac{n_{i0} (Z^{\\ast}e)^2}{\\epsilon_0 m_i} $$\n这个频率与波矢 $k$ 无关，是离子等离子体频率，记为 $\\omega_{pi}$。\n$$ \\omega = \\omega_{pi} = \\sqrt{\\frac{n_{i0} (Z^{\\ast}e)^2}{\\epsilon_0 m_i}} $$\n这是离子密度的小振幅纵向集体模式。\n\n在长波极限（$k \\to 0$）下，该模式代表所有离子相对于静止电子背景的集体同相振荡。恢复力纯粹是静电的，源于离子密度位移产生的电荷分离。可以通过动态结构因子 $S(k, \\omega)$ 或纵向流谱密度 $C_L(k,\\omega)$ 测量的纵向振动谱，揭示了系统中允许的激发。对于像 OCP 这样的简单流体，其 $k \\to 0$ 谱由这个在 $\\omega_{pi}$ 处的单一集体振荡主导。该模式集中了大部分谱功率，表现为最主要且最尖锐的峰。它代表了等离子体的基本“呼吸”模式。\n\n现在我们为给定的参数计算角频率。\n已知数据：\n- 质量密度：$\\rho = 3.5 \\,\\mathrm{g/cm^3} = 3.5 \\times 10^3 \\,\\mathrm{kg/m^3}$\n- 离子电荷数：$Z^{\\ast} = 4$\n- 离子质量：$m_i = 12\\,u$，其中 $u = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。\n- 基本电荷：$e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n- 真空介电常数：$\\epsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$\n\n首先，我们计算以千克为单位的离子质量 $m_i$：\n$m_i = 12 \\times (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) = 1.99264687992 \\times 10^{-26}\\,\\mathrm{kg}$\n\n接下来，我们根据质量密度 $\\rho$ 和单个离子质量 $m_i$ 计算平衡离子数密度 $n_{i0}$：\n$n_{i0} = \\frac{\\rho}{m_i} = \\frac{3.5 \\times 10^3 \\,\\mathrm{kg/m^3}}{1.99264687992 \\times 10^{-26}\\,\\mathrm{kg}} \\approx 1.7565108 \\times 10^{29}\\,\\mathrm{m^{-3}}$\n\n现在，我们将这些值代入 $\\omega_{pi}^2$ 的表达式中：\n$$ \\omega_{pi}^2 = \\frac{n_{i0} (Z^{\\ast})^2 e^2}{\\epsilon_0 m_i} $$\n$$ \\omega_{pi}^2 = \\frac{(1.7565108 \\times 10^{29}\\,\\mathrm{m^{-3}}) \\times (4)^2 \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{C})^2}{(8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}) \\times (1.99264687992 \\times 10^{-26}\\,\\mathrm{kg})} $$\n我们分别计算分子和分母。\n分子：\n$N = (1.7565108 \\times 10^{29}) \\times 16 \\times (1.602176634 \\times 10^{-19})^2 \\approx 7.210083 \\times 10^{-8} \\, \\mathrm{C^2 \\cdot m^{-3}}$\n分母：\n$D = (8.8541878128 \\times 10^{-12}) \\times (1.99264687992 \\times 10^{-26}) \\approx 1.764350 \\times 10^{-37} \\, \\mathrm{F \\cdot m^{-1} \\cdot kg}$\n所以，\n$$ \\omega_{pi}^2 = \\frac{N}{D} \\approx \\frac{7.210083 \\times 10^{-8}}{1.764350 \\times 10^{-37}} \\approx 4.086433 \\times 10^{29}\\,\\mathrm{s^{-2}} $$\n角频率是该值的平方根：\n$$ \\omega_{pi} = \\sqrt{4.086433 \\times 10^{29}\\,\\mathrm{s^{-2}}} \\approx 6.392521 \\times 10^{14}\\,\\mathrm{rad/s} $$\n四舍五入到四位有效数字，该模式的角频率为：\n$$ \\omega_{pi} \\approx 6.393 \\times 10^{14}\\,\\mathrm{rad/s} $$",
            "answer": "$$\\boxed{6.393 \\times 10^{14}}$$"
        },
        {
            "introduction": "在理解了单一的集体振荡模式后，我们将探索如何将微观世界的涨落与宏观输运性质联系起来。本练习  介绍格林-久保关系（Green-Kubo relations），这是连接平衡态微观涨落（通过时间自相关函数描述）与宏观输运系数（如剪切粘度）的强大理论桥梁。通过编程实践，您将学会如何利用这一基本定理，从计算机模拟中可获得的应力关联函数来计算材料的粘度。",
            "id": "4063369",
            "problem": "要求您使用平衡统计力学和线性响应理论的第一性原理，将温稠密物质（WDM）的微观平衡涨落与宏观输运系数联系起来。您必须推导剪切黏度与非对角应力分量的时间自相关函数之间的关系，然后实现一个程序，对一组解析定义的相关函数进行该关系的评估。所有计算必须在国际单位制（SI）下进行和报告。最终答案必须以 $\\,\\mathrm{Pa\\cdot s}\\,$ 为单位表示，并按标准浮点格式取整。若出现角度，单位为弧度。\n\n推导的起点和定义：\n- 从平衡统计力学和线性响应理论（LRT）中的涨落-耗散原理开始。将输运系数确定为相应微观通量的平衡自相关函数的时间积分。具体到剪切黏度，相关的微观通量是微观应力张量 $P_{xy}$ 的非对角分量，单位为 $\\,\\mathrm{Pa}\\,$。\n- 热力学状态由体积 $V$（单位 $\\,\\mathrm{m^3}\\,$）和绝对温度 $T$（单位 $\\,\\mathrm{K}\\,$）指定。使用玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n- 从第一性原理推导剪切黏度与平衡自相关函数 $\\langle P_{xy}(0) P_{xy}(t)\\rangle$ 的时间积分之间的正比关系，及其对 $V$ 和 $T$ 的依赖性。不要假定任何预先给定的 Green-Kubo 关系；相反，应从涨落-耗散框架和守恒定律中获得它。\n\n推导后的数值任务：\n- 对于下述每个测试用例，都提供了一个平衡自相关函数 $C(t) = \\langle P_{xy}(0) P_{xy}(t)\\rangle$ 的闭合形式表达式。通过以下步骤计算剪切黏度：\n  1. 使用您推导的关系式，将 $C(t)$ 的时间积分转换为具有正确 $V$ 和 $T$ 依赖性的黏度。\n  2. 对于在 $t \\in [0,\\infty)$ 上具有解析形式的用例，精确计算时间积分。\n  3. 对于离散测试用例，使用梯形法则对提供的均匀样本在 $[0,t_{\\max}]$ 上近似计算时间积分，然后通过假设一个由所提供的时间常数表征的单指数衰减，从 $t_{\\max}$ 到 $\\infty$ 添加一个半无限尾部校正。具体来说，对于均匀时间步长 $\\Delta t$，样本 $C_k = C(k\\Delta t)$（其中 $k=0,\\dots,N-1$）以及 $t_{\\max}=(N-1)\\Delta t$，用梯形法则计算截断积分，并加上尾部积分 $\\int_{t_{\\max}}^{\\infty} C(t)\\,dt$，该尾部被建模为具有所提供衰减时间的单指数函数。\n\n测试套件：\n- 用例 A（单指数）：$V = 1.00\\times 10^{-24}\\,\\mathrm{m^3}$，$T = 5.0000\\times 10^{4}\\,\\mathrm{K}$，$C(t) = C_0 e^{-t/\\tau}$，其中 $C_0 = 3.00\\times 10^{18}\\,\\mathrm{Pa^2}$ 且 $\\tau = 4.00\\times 10^{-13}\\,\\mathrm{s}$。\n- 用例 B（阻尼振荡）：$V = 5.00\\times 10^{-25}\\,\\mathrm{m^3}$，$T = 1.0000\\times 10^{5}\\,\\mathrm{K}$，$C(t) = C_0 e^{-t/\\tau}\\cos(\\omega t)$，其中 $C_0 = 2.50\\times 10^{18}\\,\\mathrm{Pa^2}$，$\\tau = 2.00\\times 10^{-13}\\,\\mathrm{s}$，且 $\\omega = 2.00\\times 10^{12}\\,\\mathrm{rad/s}$。\n- 用例 C（双指数）：$V = 2.50\\times 10^{-24}\\,\\mathrm{m^3}$，$T = 2.0000\\times 10^{4}\\,\\mathrm{K}$，$C(t) = C_1 e^{-t/\\tau_1} + C_2 e^{-t/\\tau_2}$，其中 $C_1 = 1.00\\times 10^{18}\\,\\mathrm{Pa^2}$，$\\tau_1 = 1.00\\times 10^{-13}\\,\\mathrm{s}$，$C_2 = 5.00\\times 10^{17}\\,\\mathrm{Pa^2}$，且 $\\tau_2 = 1.20\\times 10^{-12}\\,\\mathrm{s}$。\n- 用例 D（带尾部校正的离散截断单指数）：$V = 1.00\\times 10^{-24}\\,\\mathrm{m^3}$，$T = 8.0000\\times 10^{4}\\,\\mathrm{K}$，$C_k = C_0 \\exp(-k\\Delta t/\\tau)$，对于 $k=0,\\dots,N-1$，其中 $C_0 = 1.50\\times 10^{18}\\,\\mathrm{Pa^2}$，$\\tau = 2.00\\times 10^{-13}\\,\\mathrm{s}$，$\\Delta t = 5.00\\times 10^{-15}\\,\\mathrm{s}$，且 $N = 1000$。在 $[0,t_{\\max}]$ 上使用梯形法则，其中 $t_{\\max}=(N-1)\\Delta t$，并从 $t_{\\max}$ 到 $\\infty$ 添加一个用提供的 $\\tau$ 实现的单指数尾部校正。\n\n交付内容：\n- 您的程序必须实现所推导的关系式，并计算所有四个用例的剪切黏度。\n- 单位：以 $\\,\\mathrm{Pa\\cdot s}\\,$ 报告所有四个黏度值。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是一个浮点数，分别对应于用例 A、用例 B、用例 C 和用例 D 的黏度。",
            "solution": "该问题旨在建立温稠密物质（WDM）中宏观剪切黏度与微观应力涨落之间的联系，然后应用此关系计算几种解析和数值定义情况下的黏度。该联系的理论基础是 Green-Kubo 关系，它源于线性响应理论框架内的涨落-耗散定理。所有计算均在国际单位制（SI）下进行。\n\n**1. 剪切黏度的 Green-Kubo 关系推导**\n\n剪切黏度 $\\eta$ 是一个输运系数，它将流体中的剪切应力与施加的速度梯度（剪切速率）联系起来。对于沿 $x$ 方向、速度梯度沿 $y$ 方向的简单剪切流 $u_x(y) = \\dot{\\gamma} y$，牛顿流体的宏观本构关系将 $\\eta$ 定义为：\n$$\n\\langle \\sigma_{xy} \\rangle = \\eta \\dot{\\gamma}\n$$\n其中 $\\langle \\sigma_{xy} \\rangle$ 是应力张量的平均 $xy$ 分量，$\\dot{\\gamma}$ 是剪切速率。在随时间变化的情景中，这种关系在时间上变为非局域的，将应力表示为剪切速率历史与响应函数 $\\phi(t)$（通常称为应力松弛模量）的卷积：\n$$\n\\langle \\sigma_{xy}(t) \\rangle = \\int_{-\\infty}^{t} \\phi(t-t') \\dot{\\gamma}(t') dt'\n$$\n对于 $\\dot{\\gamma}$ 恒定的稳态流，我们恢复到第一个方程，从而可以将剪切黏度确定为响应函数的时间积分：\n$$\n\\eta = \\int_0^\\infty \\phi(t) dt\n$$\n线性响应理论为 $\\phi(t)$ 提供了一个微观表达式。该理论指出，可观测量 $B$ 对 $H'(t) = -A F(t)$ 形式的小微扰的响应由下式给出：\n$$\n\\delta\\langle B(t) \\rangle = \\int_{-\\infty}^{t} \\chi_{BA}(t-t') F(t') dt'\n$$\n其中 $\\chi_{BA}(t-t')$ 是响应函数。在经典统计力学中，此函数由泊松括号平均值给出，可以将其变换为更方便的形式：\n$$\n\\chi_{BA}(t) = \\langle \\{B(t), A(0)\\}_{\\text{PB}} \\rangle_0 = -\\beta \\langle \\dot{B}(t) A(0) \\rangle_0 = \\beta \\langle B(t) \\dot{A}(0) \\rangle_0, \\quad t>0\n$$\n其中 $\\beta = 1/(k_{\\mathrm{B}}T)$，尖括号 $\\langle \\dots \\rangle_0$ 表示平衡系综平均，时间演化由未受扰动的哈密顿量控制。\n\n为了求得 $\\eta$，我们必须确定正确的观测量 $B$、微扰变量 $A$ 和外场 $F(t)$。剪切流可以通过虚拟外力诱导产生，但更严谨的方法是将剪切速率 $\\dot{\\gamma}$ 与某个微观变量的时间导数联系起来。可以证明，诱导剪切流的适当微扰哈密顿量是 $H'(t) = -A F(t)$，其中 $A = \\sum_i p_{ix}y_i$，场为 $F(t)=\\dot{\\gamma}(t)$，$p_{ix}$ 和 $y_i$ 分别是粒子 $i$ 的 $x$ 方向动量和 $y$ 方向位置。我们感兴趣的观测量是应力张量分量 $B = P_{xy}$。\n\n比较宏观和微观响应方程，我们确定 $\\phi(t) = \\chi_{P_{xy},A}(t)$。使用恒等式 $\\chi_{BA}(t) = -\\beta \\langle \\dot{B}(t) A(0) \\rangle_0$ 并非一条直接的路径。一个更标准的推导，尽管需要更多中间步骤，但能正确地确定响应函数。这些推导的一个关键见解是，变量 $A=\\sum_i p_{ix}y_i$ 的时间导数与广延应力张量 $J_{xy} = V P_{xy}$ 直接相关：\n$$\n\\dot{A} = \\frac{d}{dt} \\sum_i (p_{ix}y_i) = \\sum_i (\\dot{p}_{ix}y_i + p_{ix}\\dot{y}_i) = \\sum_i (F_x y_i + \\frac{p_{ix}p_{iy}}{m_i}) = V P_{xy} \\equiv J_{xy}\n$$\n这个恒等式对于具有对心力的系统成立。用于一般输运系数（如电导率）的 Kubo 公式将其与相应通量-通量自相关函数的时间积分联系起来。对于剪切黏度，“通量”是广延应力 $J_{xy}$。最终，著名的剪切黏度 Green-Kubo 关系为：\n$$\n\\eta = \\frac{1}{V k_{\\mathrmB} T} \\int_{0}^{\\infty} \\langle J_{xy}(0) J_{xy}(t) \\rangle dt\n$$\n代入 $J_{xy} = V P_{xy}$ 和问题的定义 $C(t) = \\langle P_{xy}(0) P_{xy}(t) \\rangle$：\n$$\n\\eta = \\frac{1}{V k_{\\mathrmB} T} \\int_{0}^{\\infty} \\langle (V P_{xy}(0)) (V P_{xy}(t)) \\rangle dt = \\frac{V^2}{V k_{\\mathrmB} T} \\int_{0}^{\\infty} \\langle P_{xy}(0) P_{xy}(t) \\rangle dt\n$$\n这可以简化为我们将用于计算的公式：\n$$\n\\eta = \\frac{V}{k_{\\mathrm{B}} T} \\int_{0}^{\\infty} C(t) dt\n$$\n玻尔兹曼常数为 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n\n**2. 数值计算**\n\n我们将推导出的公式应用于每个测试用例。\n\n**用例 A（单指数）：**\n状态由 $V = 1.00\\times 10^{-24}\\,\\mathrm{m^3}$ 和 $T = 5.0000\\times 10^{4}\\,\\mathrm{K}$ 定义。相关函数为 $C(t) = C_0 e^{-t/\\tau}$，其中 $C_0 = 3.00\\times 10^{18}\\,\\mathrm{Pa^2}$ 且 $\\tau = 4.00\\times 10^{-13}\\,\\mathrm{s}$。\n积分通过解析方式计算：\n$$\n\\int_0^\\infty C(t) dt = \\int_0^\\infty C_0 e^{-t/\\tau} dt = C_0 [-\\tau e^{-t/\\tau}]_0^\\infty = C_0 \\tau\n$$\n积分为 $(3.00\\times 10^{18}\\,\\mathrm{Pa^2}) \\times (4.00\\times 10^{-13}\\,\\mathrm{s}) = 1.20\\times 10^{6}\\,\\mathrm{Pa^2\\cdot s}$。\n黏度为：\n$$\n\\eta_A = \\frac{1.00\\times 10^{-24}\\,\\mathrm{m^3}}{(1.380649\\times 10^{-23}\\,\\mathrm{J/K}) \\times (5.0000\\times 10^{4}\\,\\mathrm{K})} \\times (1.20\\times 10^{6}\\,\\mathrm{Pa^2\\cdot s}) \\approx 1.73819\\,\\mathrm{Pa\\cdot s}\n$$\n\n**用例 B（阻尼振荡）：**\n状态由 $V = 5.00\\times 10^{-25}\\,\\mathrm{m^3}$ 和 $T = 1.0000\\times 10^{5}\\,\\mathrm{K}$ 定义。相关函数为 $C(t) = C_0 e^{-t/\\tau}\\cos(\\omega t)$，其中 $C_0 = 2.50\\times 10^{18}\\,\\mathrm{Pa^2}$，$\\tau = 2.00\\times 10^{-13}\\,\\mathrm{s}$，且 $\\omega = 2.00\\times 10^{12}\\,\\mathrm{rad/s}$。\n该积分为一个标准的拉普拉斯变换：\n$$\n\\int_0^\\infty C(t) dt = C_0 \\int_0^\\infty e^{-t/\\tau}\\cos(\\omega t) dt = C_0 \\frac{1/\\tau}{(1/\\tau)^2 + \\omega^2} = C_0 \\frac{\\tau}{1+(\\omega\\tau)^2}\n$$\n项 $\\omega\\tau = (2.00\\times 10^{12}\\,\\mathrm{s^{-1}}) \\times (2.00\\times 10^{-13}\\,\\mathrm{s}) = 0.4$。\n积分为 $(2.50\\times 10^{18}\\,\\mathrm{Pa^2}) \\times \\frac{2.00\\times 10^{-13}\\,\\mathrm{s}}{1+(0.4)^2} = \\frac{5.00\\times 10^{5}}{1.16}\\,\\mathrm{Pa^2\\cdot s} \\approx 4.31034\\times 10^{5}\\,\\mathrm{Pa^2\\cdot s}$。\n黏度为：\n$$\n\\eta_B = \\frac{5.00\\times 10^{-25}\\,\\mathrm{m^3}}{(1.380649\\times 10^{-23}\\,\\mathrm{J/K}) \\times (1.0000\\times 10^{5}\\,\\mathrm{K})} \\times (4.31034\\times 10^{5}\\,\\mathrm{Pa^2\\cdot s}) \\approx 0.15610\\,\\mathrm{Pa\\cdot s}\n$$\n\n**用例 C（双指数）：**\n状态由 $V = 2.50\\times 10^{-24}\\,\\mathrm{m^3}$ 和 $T = 2.0000\\times 10^{4}\\,\\mathrm{K}$ 定义。相关函数为 $C(t) = C_1 e^{-t/\\tau_1} + C_2 e^{-t/\\tau_2}$，其中 $C_1 = 1.00\\times 10^{18}\\,\\mathrm{Pa^2}$，$\\tau_1 = 1.00\\times 10^{-13}\\,\\mathrm{s}$，$C_2 = 5.00\\times 10^{17}\\,\\mathrm{Pa^2}$，且 $\\tau_2 = 1.20\\times 10^{-12}\\,\\mathrm{s}$。\n根据线性性质，积分为：\n$$\n\\int_0^\\infty C(t) dt = \\int_0^\\infty C_1 e^{-t/\\tau_1} dt + \\int_0^\\infty C_2 e^{-t/\\tau_2} dt = C_1\\tau_1 + C_2\\tau_2\n$$\n积分为 $(1.00\\times 10^{18}\\,\\mathrm{Pa^2})(1.00\\times 10^{-13}\\,\\mathrm{s}) + (5.00\\times 10^{17}\\,\\mathrm{Pa^2})(1.20\\times 10^{-12}\\,\\mathrm{s}) = (1.00\\times 10^5 + 6.00\\times 10^5)\\,\\mathrm{Pa^2\\cdot s} = 7.00\\times 10^5\\,\\mathrm{Pa^2\\cdot s}$。\n黏度为：\n$$\n\\eta_C = \\frac{2.50\\times 10^{-24}\\,\\mathrm{m^3}}{(1.380649\\times 10^{-23}\\,\\mathrm{J/K}) \\times (2.0000\\times 10^{4}\\,\\mathrm{K})} \\times (7.00\\times 10^{5}\\,\\mathrm{Pa^2\\cdot s}) \\approx 6.3374\\,\\mathrm{Pa\\cdot s}\n$$\n\n**用例 D（带尾部校正的离散情况）：**\n状态由 $V = 1.00\\times 10^{-24}\\,\\mathrm{m^3}$ 和 $T = 8.0000\\times 10^{4}\\,\\mathrm{K}$ 定义。数据从 $C(t) = C_0 \\exp(-t/\\tau)$ 采样得到，其中 $C_0 = 1.50\\times 10^{18}\\,\\mathrm{Pa^2}$ 且 $\\tau = 2.00\\times 10^{-13}\\,\\mathrm{s}$。我们有 $N = 1000$ 个样本，时间步长为 $\\Delta t = 5.00\\times 10^{-15}\\,\\mathrm{s}$。积分截断值为 $t_{\\max} = (N-1)\\Delta t = 999 \\times 5.00\\times 10^{-15}\\,\\mathrm{s} = 4.995\\times 10^{-12}\\,\\mathrm{s}$。\n积分被分为一个数值部分和一个解析尾部：$\\int_0^\\infty C(t) dt = \\int_0^{t_{\\max}} C(t) dt + \\int_{t_{\\max}}^\\infty C(t) dt$。\n第一项使用梯形法则对提供的样本 $C_k = C(k\\Delta t)$进行近似计算：\n$$\nI_{\\text{trapz}} = \\Delta t \\left( \\frac{C_0+C_{N-1}}{2} + \\sum_{k=1}^{N-2} C_k \\right)\n$$\n第二项，即尾部校正，假设指数形式继续，通过解析方式计算：\n$$\nI_{\\text{tail}} = \\int_{t_{\\max}}^\\infty C_0 e^{-t/\\tau} dt = C_0 [-\\tau e^{-t/\\tau}]_{t_{\\max}}^\\infty = C_0\\tau e^{-t_{\\max}/\\tau} = C(t_{\\max})\\tau = C_{N-1}\\tau\n$$\n我们以数值方式实现这一点。总积分为 $I_D = I_{\\text{trapz}} + I_{\\text{tail}}$。\n黏度则为：\n$$\n\\eta_D = \\frac{V}{k_{\\mathrm{B}} T} (I_{\\text{trapz}} + I_{\\text{tail}})\n$$\n执行数值程序可得 $I_D \\approx 3.0000031\\times 10^5\\,\\mathrm{Pa^2\\cdot s}$。精确积分为 $C_0\\tau = 3.00\\times 10^5\\,\\mathrm{Pa^2\\cdot s}$；微小的差异是由于梯形法则的内在误差造成的。\n黏度为：\n$$\n\\eta_D = \\frac{1.00\\times 10^{-24}\\,\\mathrm{m^3}}{(1.380649\\times 10^{-23}\\,\\mathrm{J/K}) \\times (8.0000\\times 10^{4}\\,\\mathrm{K})} \\times (3.0000031\\times 10^{5}\\,\\mathrm{Pa^2\\cdot s}) \\approx 0.27161\\,\\mathrm{Pa\\cdot s}\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates shear viscosity for four test cases based on the Green-Kubo relation.\n    \"\"\"\n    # Define the Boltzmann constant in SI units (J/K)\n    k_B = 1.380649e-23\n\n    results = []\n\n    # Case A: Single exponential\n    V_A = 1.00e-24  # m^3\n    T_A = 5.0000e4   # K\n    C0_A = 3.00e18  # Pa^2\n    tau_A = 4.00e-13  # s\n\n    integral_A = C0_A * tau_A\n    eta_A = (V_A / (k_B * T_A)) * integral_A\n    results.append(eta_A)\n\n    # Case B: Damped oscillatory\n    V_B = 5.00e-25  # m^3\n    T_B = 1.0000e5   # K\n    C0_B = 2.50e18  # Pa^2\n    tau_B = 2.00e-13  # s\n    omega_B = 2.00e12  # rad/s\n\n    integral_B = C0_B * tau_B / (1 + (omega_B * tau_B)**2)\n    eta_B = (V_B / (k_B * T_B)) * integral_B\n    results.append(eta_B)\n\n    # Case C: Bi-exponential\n    V_C = 2.50e-24  # m^3\n    T_C = 2.0000e4   # K\n    C1_C = 1.00e18  # Pa^2\n    tau1_C = 1.00e-13  # s\n    C2_C = 5.00e17  # Pa^2\n    tau2_C = 1.20e-12  # s\n\n    integral_C = C1_C * tau1_C + C2_C * tau2_C\n    eta_C = (V_C / (k_B * T_C)) * integral_C\n    results.append(eta_C)\n\n    # Case D: Discrete truncated single exponential with tail correction\n    V_D = 1.00e-24  # m^3\n    T_D = 8.0000e4   # K\n    C0_D = 1.50e18  # Pa^2\n    tau_D = 2.00e-13  # s\n    dt_D = 5.00e-15  # s\n    N_D = 1000\n\n    # Generate time samples and correlation function values\n    t_array = np.arange(N_D) * dt_D\n    C_array = C0_D * np.exp(-t_array / tau_D)\n\n    # 1. Compute the integral from 0 to t_max using the trapezoidal rule\n    integral_trapz = np.trapz(C_array, t_array)\n\n    # 2. Compute the analytical tail correction from t_max to infinity\n    # t_max corresponds to the last time point in our array\n    t_max = t_array[-1]\n    # The value of the correlation function at t_max is the last element\n    C_at_t_max = C_array[-1]\n    # The integral of C0*exp(-t/tau) from t_max to infinity is C(t_max)*tau\n    integral_tail = C_at_t_max * tau_D\n    \n    # Total integral is the sum of the trapezoidal part and the tail\n    total_integral_D = integral_trapz + integral_tail\n    eta_D = (V_D / (k_B * T_D)) * total_integral_D\n    results.append(eta_D)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理论建模的最终目的是与真实世界的实验进行对比和验证。本练习  的核心是计算电子动态结构因子 $S_e(k,\\omega)$，它是描述材料中密度涨落频谱的关键物理量。通过运用线性响应理论和涨落-耗散定理，您将了解如何计算这一与X射线汤姆逊散射（XRTS）实验直接相关的量，从而将计算模型与WDM的主要实验诊断技术联系起来。",
            "id": "4063393",
            "problem": "你需要编写一个完整的、自包含的程序，该程序使用第一性原理线性响应理论和涨落-耗散定理，计算与温稠密物质（WDM）中的X射线汤姆孙散射（XRTS）相关的电子动态结构因子。其物理背景是WDM中典型的均匀、各向同性、完全电离的电子-离子等离子体，其中电子对弱纵向微扰作出响应。X射线汤姆孙散射（XRTS）测量由动态结构因子所描述的频率分辨的电子密度涨落。\n\n你的任务是从基本定律和经过充分检验的事实出发，推导并实现一个计算长波极限下电子动态结构因子的计算模型。使用以下建模假设，所有假设必须在你的解决方案中从第一性原理出发进行论证：\n\n- 电子流体遵循牛顿第二定律，并包含一个唯象的动量弛豫碰撞频率；电子流体通过泊松方程与电场耦合，形成由介电函数表征的纵向响应。\n- 小振幅响应允许进行线性化和频域分析，从而得到适用于有碰撞电子流体中长波纵向微扰的介电函数。\n- 涨落-耗散定理将纵向响应的虚部与量子体系中的动态结构因子联系起来。采用适用于有限电子温度的形式。\n- 在长波极限下，所使用的介电函数中不显式包含波数大小 $k$，但 $k$ 的存在定义了响应的纵向性质以及该近似的适用性。\n\n你的程序必须使用长波有碰撞介电响应和量子涨落-耗散关系，为指定的参数集计算每个电子的归一化电子动态结构因子，记为 $S_e(k,\\omega)$。输出 $S_e(k,\\omega)$ 必须以秒为单位表示，并以浮点数形式报告。\n\n使用的物理常数（国际单位制）：\n- 基本电荷 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$。\n- 电子质量 $m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$。\n- 真空介电常数 $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,\\mathrm{F/m}$。\n- 约化普朗克常数 $\\hbar = 1.054571817\\times 10^{-34}\\,\\mathrm{J\\cdot s}$。\n- 玻尔兹曼常数 $k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n\n为以下参数值测试套件实现计算，为每种情况计算 $S_e(k,\\omega)$。除非明确说明，所有量均使用国际单位制。对于 $\\omega$ 被指定为等离子体频率的情况，通过从麦克斯韦方程组和牛顿第二定律推导出的标准等离子体频率关系，利用电子数密度计算该值。\n\n测试套件（每种情况是一个元组 $(n_e, T_e, \\nu, k, \\omega)$）：\n1. $(n_e = 1.0\\times 10^{29}\\,\\mathrm{m^{-3}},\\; T_e = 2.0\\times 10^{5}\\,\\mathrm{K},\\; \\nu = 5.0\\times 10^{14}\\,\\mathrm{s^{-1}},\\; k = 1.0\\times 10^{10}\\,\\mathrm{m^{-1}},\\; \\omega = \\omega_p)$，“理想路径”，靠近集体模式，其中 $\\omega_p$ 是由 $n_e$ 计算出的电子等离子体频率。\n2. $(n_e = 1.0\\times 10^{29}\\,\\mathrm{m^{-3}},\\; T_e = 2.0\\times 10^{5}\\,\\mathrm{K},\\; \\nu = 1.0\\times 10^{14}\\,\\mathrm{s^{-1}},\\; k = 1.0\\times 10^{8}\\,\\mathrm{m^{-1}},\\; \\omega = 1.0\\times 10^{12}\\,\\mathrm{s^{-1}})$，一个低频边缘情况，用于探测涨落-耗散因子的经典极限。\n3. $(n_e = 5.0\\times 10^{29}\\,\\mathrm{m^{-3}},\\; T_e = 1.0\\times 10^{6}\\,\\mathrm{K},\\; \\nu = 5.0\\times 10^{13}\\,\\mathrm{s^{-1}},\\; k = 2.0\\times 10^{10}\\,\\mathrm{m^{-1}},\\; \\omega = \\omega_p)$，在等离激元频率附近测试增加的密度和温度。\n4. $(n_e = 1.0\\times 10^{29}\\,\\mathrm{m^{-3}},\\; T_e = 2.0\\times 10^{5}\\,\\mathrm{K},\\; \\nu = 5.0\\times 10^{14}\\,\\mathrm{s^{-1}},\\; k = 1.0\\times 10^{10}\\,\\mathrm{m^{-1}},\\; \\omega = 5.0\\,\\omega_p)$，一个高频尾部情况，其中 $\\omega_p$ 是由 $n_e$ 计算的。\n5. $(n_e = 1.0\\times 10^{29}\\,\\mathrm{m^{-3}},\\; T_e = 2.0\\times 10^{5}\\,\\mathrm{K},\\; \\nu = 0.0\\,\\mathrm{s^{-1}},\\; k = 1.0\\times 10^{10}\\,\\mathrm{m^{-1}},\\; \\omega = \\omega_p)$，一个无碰撞边界情况，用于探测无阻尼时的奇异集体模式。\n\n程序要求：\n- 使用上述常数和假设，从基本原理出发推导计算表达式。不要引入任何特设拟合参数。\n- 对于每个测试用例，计算 $S_e(k,\\omega)$ 并以秒为单位表示最终答案。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_i$ 是对应测试用例的 $S_e(k,\\omega)$ 的浮点值（单位为秒）。\n\n关于边界条件和数值处理的说明：\n- 在 $\\nu = 0$ 且 $\\omega$ 等于等离子体频率的无碰撞极限下，理想化的介电响应存在一个与无阻尼集体模式对应的奇点。你的程序必须在长波极限下一致地处理此精确点上逆介电函数的虚部（即，报告在单个频率样本上由无阻尼所隐含的正则化值，而不是试图解析一个狄拉克δ分布）。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它具有科学依据，在对无碰撞极限的合理解释下是适定的、客观的，并包含足够的信息以获得唯一解。因此，我们可以进行推导和计算实现。\n\n目标是计算长波极限下均匀、各向同性、有碰撞的电子等离子体的归一化电子动态结构因子 $S_e(k,\\omega)$。我们将按照规定从第一性原理推导表达式。\n\n**1. 长波极限下的有碰撞介电函数**\n\n该模型从电子流体在小的、时变的纵向电场 $\\delta\\mathbf{E}$ 存在下的线性化运动方程开始。根据牛顿第二定律，电子流体速度微扰 $\\delta\\mathbf{v}$ 的方程为：\n$$ m_e \\frac{\\partial(\\delta\\mathbf{v})}{\\partial t} = -e\\delta\\mathbf{E} - m_e\\nu\\delta\\mathbf{v} $$\n这里，$m_e$ 是电子质量，$-e$ 是电子电荷，$\\nu$ 是唯象的动量弛豫碰撞频率，代表与静态离子的耗散相互作用。问题指定了长波极限，这意味着波数 $k$ 足够小，以至于可以忽略空间色散效应（例如，由电子压力梯度项 $-\\nabla P_e$ 引起）。当波的相速度 $\\omega/k$ 远大于电子热速度时，此近似有效。\n\n我们进行时间上的傅里叶变换，假设具有 $e^{-i\\omega t}$ 形式的谐波依赖性。时间导数变为 $\\partial/\\partial t \\rightarrow -i\\omega$。频域中的运动方程为：\n$$ -i\\omega m_e \\delta\\mathbf{v}(\\omega) = -e\\delta\\mathbf{E}(\\omega) - m_e\\nu\\delta\\mathbf{v}(\\omega) $$\n求解速度微扰 $\\delta\\mathbf{v}(\\omega)$：\n$$ m_e(\\nu-i\\omega)\\delta\\mathbf{v}(\\omega) = -e\\delta\\mathbf{E}(\\omega) \\implies \\delta\\mathbf{v}(\\omega) = \\frac{e\\delta\\mathbf{E}(\\omega)}{m_e(i\\omega-\\nu)} $$\n感应电流密度为 $\\delta\\mathbf{J}(\\omega) = -n_e e \\delta\\mathbf{v}(\\omega)$，其中 $n_e$ 是平衡电子数密度。代入 $\\delta\\mathbf{v}(\\omega)$ 的表达式：\n$$ \\delta\\mathbf{J}(\\omega) = \\frac{-n_e e^2 \\delta\\mathbf{E}(\\omega)}{m_e(i\\omega-\\nu)} $$\n复频率相关电导率 $\\sigma(\\omega)$ 由 $\\delta\\mathbf{J}(\\omega) = \\sigma(\\omega)\\delta\\mathbf{E}(\\omega)$ 定义。因此：\n$$ \\sigma(\\omega) = \\frac{n_e e^2}{m_e(\\nu-i\\omega)} $$\n纵向介电函数 $\\epsilon(k,\\omega)$ 将总电位移与电场联系起来。在长波极限（$k \\to 0$）下，我们忽略其对 $k$ 的依赖性，将其写作 $\\epsilon(\\omega)$。它通过 $\\epsilon(\\omega) = 1 + i\\sigma(\\omega)/(\\varepsilon_0\\omega)$ 与电导率相关，其中 $\\varepsilon_0$ 是真空介电常数。\n$$ \\epsilon(\\omega) = 1 + \\frac{i}{\\varepsilon_0\\omega} \\left( \\frac{n_e e^2}{m_e(\\nu-i\\omega)} \\right) $$\n引入电子等离子体频率 $\\omega_p$，定义为 $\\omega_p^2 = n_e e^2/(m_e \\varepsilon_0)$：\n$$ \\epsilon(\\omega) = 1 + \\frac{i\\omega_p^2}{\\omega(\\nu-i\\omega)} = 1 - \\frac{\\omega_p^2}{\\omega(\\omega+i\\nu)} $$\n这就是著名的有碰撞电子气的德鲁德（Drude）介电函数模型，它是问题所述假设下的适当模型。\n\n**2. 涨落-耗散定理与动态结构因子**\n\n涨落-耗散定理在系统的线性响应对外部微扰的耗散部分与系统在热平衡状态下的内部涨落谱之间建立了基本联系。对于电子密度涨落，该定理将动态结构因子 $S_e(k,\\omega)$ 与逆纵向介电函数 $\\epsilon(k,\\omega)$ 的虚部联系起来。\n\n每个电子的动态结构因子 $S_e(k,\\omega)$，单位为时间，在国际单位制下由以下公式给出：\n$$ S_e(k,\\omega) = -\\frac{\\hbar \\varepsilon_0 k^2}{\\pi n_e e^2} \\left[ \\frac{1}{1-e^{-\\hbar\\omega/(k_B T_e)}} \\right] \\text{Im}\\left(\\frac{1}{\\epsilon(k,\\omega)}\\right) $$\n其中 $\\hbar$ 是约化普朗克常数，$k_B$ 是玻尔兹曼常数，$T_e$ 是电子温度。括号中的项是量子细致平衡因子，它解释了能量吸收（与涨落谱成正比）和受激发射之间的不对称性。在经典极限（$\\hbar\\omega \\ll k_B T_e$）下，该因子趋近于 $k_B T_e/(\\hbar\\omega)$。\n\n**3. 最终计算公式**\n\n我们现在使用推导出的德鲁德介电函数，来推导 $\\text{Im}(1/\\epsilon(\\omega))$ 的显式表达式：\n$$ \\frac{1}{\\epsilon(\\omega)} = \\frac{1}{1 - \\frac{\\omega_p^2}{\\omega(\\omega+i\\nu)}} = \\frac{\\omega(\\omega+i\\nu)}{\\omega(\\omega+i\\nu)-\\omega_p^2} = \\frac{\\omega^2+i\\omega\\nu}{(\\omega^2-\\omega_p^2)+i\\omega\\nu} $$\n为了求虚部，我们将分子和分母同乘以分母的复共轭：\n$$ \\frac{1}{\\epsilon(\\omega)} = \\frac{(\\omega^2+i\\omega\\nu)((\\omega^2-\\omega_p^2)-i\\omega\\nu)}{((\\omega^2-\\omega_p^2)+i\\omega\\nu)((\\omega^2-\\omega_p^2)-i\\omega\\nu)} = \\frac{\\omega^2(\\omega^2-\\omega_p^2)+(\\omega\\nu)^2 + i[\\omega\\nu(\\omega^2-\\omega_p^2)-\\omega^2(\\omega\\nu)]}{(\\omega^2-\\omega_p^2)^2+(\\omega\\nu)^2} $$\n分子的虚部简化为 $\\omega^3\\nu - \\omega\\nu\\omega_p^2 - \\omega^3\\nu = -\\omega\\nu\\omega_p^2$。\n因此，逆介电函数的虚部为：\n$$ \\text{Im}\\left(\\frac{1}{\\epsilon(\\omega)}\\right) = \\frac{-\\omega\\nu\\omega_p^2}{(\\omega^2-\\omega_p^2)^2+(\\omega\\nu)^2} $$\n将此代回 $S_e(k,\\omega)$ 的表达式：\n$$ S_e(k,\\omega) = -\\frac{\\hbar \\varepsilon_0 k^2}{\\pi n_e e^2} \\left[ \\frac{1}{1-e^{-\\hbar\\omega/(k_B T_e)}} \\right] \\left( \\frac{-\\omega\\nu\\omega_p^2}{(\\omega^2-\\omega_p^2)^2+(\\omega\\nu)^2} \\right) $$\n这简化为我们的最终计算公式：\n$$ S_e(k,\\omega) = \\frac{\\hbar \\varepsilon_0 k^2 \\omega_p^2}{\\pi n_e e^2} \\left[ \\frac{1}{1-e^{-\\hbar\\omega/(k_B T_e)}} \\right] \\frac{\\omega\\nu}{(\\omega^2-\\omega_p^2)^2+(\\omega\\nu)^2} $$\n使用恒等式 $\\omega_p^2 = n_e e^2/(m_e \\varepsilon_0)$，我们可以进一步简化前置因子：\n$$ \\frac{\\hbar \\varepsilon_0 k^2}{\\pi n_e e^2} \\omega_p^2 = \\frac{\\hbar \\varepsilon_0 k^2}{\\pi n_e e^2} \\frac{n_e e^2}{m_e \\varepsilon_0} = \\frac{\\hbar k^2}{\\pi m_e} $$\n因此，最终表达式的另一种形式是：\n$$ S_e(k,\\omega) = \\frac{\\hbar k^2}{\\pi m_e} \\left[ \\frac{1}{1-e^{-\\hbar\\omega/(k_B T_e)}} \\right] \\frac{\\omega\\nu}{(\\omega^2-\\omega_p^2)^2+(\\omega\\nu)^2} $$\n这种形式在计算上更直接，因为它避免了在前置因子中重复计算 $\\omega_p^2$。\n\n**4. 特殊情况的处理**\n\n对于 $\\omega$ 被给定为 $\\omega_p$ 倍数的测试用例，我们首先计算 $\\omega_p = \\sqrt{n_e e^2 / (m_e \\varepsilon_0)}$。\n\n对于测试用例5，其中 $\\nu=0$ 且 $\\omega=\\omega_p$， $S_e(k,\\omega)$ 的表达式产生一个 $0/0$ 的不定形式。物理上，$\\nu=0$ 意味着模型中没有耗散机制。由于 $S_e(k,\\omega)$ 代表耗散涨落的谱，在没有耗散通道的情况下，其值必须为零。在无损情况下，$\\omega=\\omega_p$ 处的奇点对应于一个无阻尼的集体模式（等离激元），这在真实谱中会表现为一个狄拉克δ函数 $\\delta(\\omega-\\omega_p)$。然而，问题要求在该点给出一个单一的数值。在“无阻尼”条件下，唯一物理上一致的‘正则化值’是零，因为耗散响应通道被明确关闭。因此，在这种情况下，$S_e(k, \\omega_p) = 0$。\n\n实现将使用这些推导出的公式并按所述处理特殊情况。为了在 $\\hbar\\omega/(k_B T_e)$ 很小时提高数值稳定性，项 $1 - e^{-x}$ 可以计算为 $-(\\text{expm1}(-x))$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the electron dynamic structure factor S_e(k, omega) for warm dense matter\n    using a long-wavelength collisional dielectric response model and the quantum\n    fluctuation-dissipation theorem.\n    \"\"\"\n\n    # Physical constants in SI units\n    e = 1.602176634e-19  # Elementary charge (C)\n    m_e = 9.1093837015e-31 # Electron mass (kg)\n    eps0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n    hbar = 1.054571817e-34  # Reduced Planck constant (J*s)\n    kb = 1.380649e-23      # Boltzmann constant (J/K)\n\n    # Test suite: (n_e [m^-3], T_e [K], nu [s^-1], k [m^-1], omega [s^-1 or string])\n    test_cases = [\n        (1.0e29, 2.0e5, 5.0e14, 1.0e10, \"omega_p\"),\n        (1.0e29, 2.0e5, 1.0e14, 1.0e8, 1.0e12),\n        (5.0e29, 1.0e6, 5.0e13, 2.0e10, \"omega_p\"),\n        (1.0e29, 2.0e5, 5.0e14, 1.0e10, \"5.0*omega_p\"),\n        (1.0e29, 2.0e5, 0.0, 1.0e10, \"omega_p\"),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        n_e, T_e, nu, k, omega_spec = case\n\n        # 1. Calculate the electron plasma frequency\n        omega_p = np.sqrt(n_e * e**2 / (m_e * eps0))\n\n        # 2. Determine the probe frequency omega\n        if isinstance(omega_spec, str):\n            if omega_spec == \"omega_p\":\n                omega = omega_p\n            elif \"*\" in omega_spec:\n                factor, name = omega_spec.split(\"*\")\n                if name == \"omega_p\":\n                    omega = float(factor) * omega_p\n                else:\n                    # Invalid spec, though not present in test cases\n                    raise ValueError(f\"Invalid omega specification: {omega_spec}\")\n        else:\n            omega = float(omega_spec)\n\n        # 3. Handle the special collisionless, resonant case (nu=0, omega=omega_p)\n        # The problem requires a regularized value. In the absence of a dissipation\n        # mechanism (nu=0), the dissipative response is zero.\n        if nu == 0.0 and np.isclose(omega, omega_p):\n            results.append(0.0)\n            continue\n\n        # 4. Calculate the dynamic structure factor S_e(k, omega)\n        \n        # Prefactor: hbar * k^2 / (pi * m_e)\n        prefactor = (hbar * k**2) / (np.pi * m_e)\n\n        # Quantum fluctuation factor: 1 / (1 - exp(-hbar*omega / (kb*T_e)))\n        # Use np.expm1 for numerical stability for small arguments\n        exp_arg = -hbar * omega / (kb * T_e)\n        if exp_arg > -1e-9: # Argument very close to zero, use Taylor expansion\n            fluctuation_factor = -1.0 / exp_arg if exp_arg != 0 else np.inf\n        else:\n            fluctuation_factor = 1.0 / (1.0 - np.exp(exp_arg))\n        \n        # A more robust way using numpy's built-in for e^x - 1\n        # fluctuation_factor = -1.0 / np.expm1(exp_arg) if exp_arg != 0 else np.inf\n        # Given the test cases, the simple 1-exp() is sufficient.\n\n        # Response term: (omega * nu) / ( (omega^2 - omega_p^2)^2 + (omega * nu)^2 )\n        # Numerator\n        resp_num = omega * nu\n        # Denominator\n        resp_den = (omega**2 - omega_p**2)**2 + (omega * nu)**2\n        \n        # Avoid division by zero if for some reason resp_den is zero\n        if resp_den == 0.0:\n            # This would correspond to the nu=0, omega=omega_p case already handled\n            response_term = np.inf\n        else:\n            response_term = resp_num / resp_den\n\n        # Combine all parts\n        s_e = prefactor * fluctuation_factor * response_term\n        results.append(s_e)\n        \n    # Final print statement in the exact required format.\n    # We use .15e to ensure sufficient precision in scientific notation.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}