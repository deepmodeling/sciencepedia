{
    "hands_on_practices": [
        {
            "introduction": "To build robust computational tools, one must first have a firm grasp of the underlying analytical principles. This exercise returns to first principles, requiring a derivation of the magnetic field for one of the most fundamental coil geometries: a single circular loop. By starting from Maxwell's equations and deriving the on-axis magnetic field from the vector potential, you will solidify your understanding of how the foundational laws of magnetostatics translate into a concrete, solvable problem, a skill essential for validating more complex numerical models .",
            "id": "3970920",
            "problem": "In magnetostatic vacuum, the magnetic field $\\mathbf{B}$ satisfies $\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}$ and $\\nabla \\cdot \\mathbf{B} = 0$, where $\\mu_{0}$ is the vacuum permeability, and $\\mathbf{J}$ is the steady current density. Consider a single-turn circular coil used as an idealized element of a toroidal field coil pack in a fusion device. The coil is modeled as an infinitesimally thin filamentary ring of radius $a$ lying in the plane $z=0$, centered on the origin, and carrying a constant current $I$ in the $\\hat{\\boldsymbol{\\phi}}$ direction. The vacuum region is the entire space outside the conductor. The current density $\\mathbf{J}(\\mathbf{r})$ is a distribution concentrated on the circular curve $\\mathbf{r}'(\\psi) = a \\cos \\psi \\,\\hat{\\mathbf{x}} + a \\sin \\psi \\,\\hat{\\mathbf{y}} + 0 \\,\\hat{\\mathbf{z}}$, with the filament direction given by $\\mathrm{d}\\mathbf{l}' = a \\left( -\\sin \\psi \\,\\hat{\\mathbf{x}} + \\cos \\psi \\,\\hat{\\mathbf{y}} \\right) \\mathrm{d}\\psi$ and current $I$.\n\nStarting from the magnetostatic Maxwell equations and introducing the vector potential $\\mathbf{A}$ with $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ in the Coulomb gauge $\\nabla \\cdot \\mathbf{A} = 0$, derive from first principles an analytic expression for the axial magnetic field component $B_{z}(z)$ on the symmetry axis (the $z$-axis, i.e., at $\\mathbf{r} = (0,0,z)$). Express your final answer in terms of $\\mu_{0}$, $I$, $a$, and $z$. Use only the foundational laws stated; do not invoke pre-tabulated results. Express the final magnetic field in Tesla in the International System of Units (SI). The final answer must be a single closed-form analytic expression.",
            "solution": "The problem as stated constitutes a valid, well-posed problem in classical electromagnetism. It is scientifically grounded, self-contained, and free of contradictions or ambiguities. We may therefore proceed with a rigorous derivation.\n\nThe analysis begins with the fundamental equations of magnetostatics in a vacuum, as provided:\n1. Ampère's Law (in differential form):\n$$ \\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J} $$\n2. Gauss's Law for magnetism:\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\nHere, $\\mathbf{B}$ is the magnetic field, $\\mathbf{J}$ is the steady current density, and $\\mu_{0}$ is the vacuum permeability.\n\nThe condition $\\nabla \\cdot \\mathbf{B} = 0$ implies that $\\mathbf{B}$ can be expressed as the curl of a vector potential, $\\mathbf{A}$:\n$$ \\mathbf{B} = \\nabla \\times \\mathbf{A} $$\nThis definition is not unique, as one can add the gradient of any scalar field to $\\mathbf{A}$ without changing $\\mathbf{B}$. We impose the Coulomb gauge condition, $\\nabla \\cdot \\mathbf{A} = 0$, to make the choice of $\\mathbf{A}$ unique under appropriate boundary conditions.\n\nSubstituting $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ into Ampère's Law yields:\n$$ \\nabla \\times (\\nabla \\times \\mathbf{A}) = \\mu_{0} \\mathbf{J} $$\nUsing the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{V}) = \\nabla(\\nabla \\cdot \\mathbf{V}) - \\nabla^2 \\mathbf{V}$, we obtain:\n$$ \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A} = \\mu_{0} \\mathbf{J} $$\nApplying the Coulomb gauge, $\\nabla \\cdot \\mathbf{A} = 0$, this simplifies to Poisson's equation for the vector potential:\n$$ \\nabla^2 \\mathbf{A} = - \\mu_{0} \\mathbf{J} $$\nThe solution to this equation in an unbounded domain is given by the integral:\n$$ \\mathbf{A}(\\mathbf{r}) = \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\frac{\\mathbf{J}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\mathrm{d}V' $$\nwhere $\\mathbf{r}$ is the field point and $\\mathbf{r}'$ is the source point over which the integration is performed.\n\nTo find the magnetic field $\\mathbf{B}$, we compute its curl, $\\mathbf{B} = \\nabla \\times \\mathbf{A}$:\n$$ \\mathbf{B}(\\mathbf{r}) = \\nabla \\times \\left( \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\frac{\\mathbf{J}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\mathrm{d}V' \\right) $$\nThe curl operator $\\nabla$ acts on the unprimed coordinates of $\\mathbf{r}$, so it can be moved inside the integral:\n$$ \\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\nabla \\times \\left( \\frac{\\mathbf{J}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\right) \\mathrm{d}V' $$\nUsing the vector product rule $\\nabla \\times (f\\mathbf{C}) = f(\\nabla \\times \\mathbf{C}) + (\\nabla f) \\times \\mathbf{C}$ with $f = 1/|\\mathbf{r} - \\mathbf{r}'|$ and $\\mathbf{C} = \\mathbf{J}(\\mathbf{r}')$, we note that $\\mathbf{J}(\\mathbf{r}')$ depends only on the primed coordinates, so $\\nabla \\times \\mathbf{J}(\\mathbf{r}') = \\mathbf{0}$. This leads to:\n$$ \\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\left( \\nabla \\frac{1}{|\\mathbf{r} - \\mathbf{r}'|} \\right) \\times \\mathbf{J}(\\mathbf{r}') \\mathrm{d}V' $$\nThe gradient of the scalar function is $\\nabla (1/|\\mathbf{r} - \\mathbf{r}'|) = -\\frac{\\mathbf{r} - \\mathbf{r}'}{|\\mathbf{r} - \\mathbf{r}'|^3}$. Substituting this gives:\n$$ \\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\left( -\\frac{\\mathbf{r} - \\mathbf{r}'}{|\\mathbf{r} - \\mathbf{r}'|^3} \\right) \\times \\mathbf{J}(\\mathbf{r}') \\mathrm{d}V' = \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\frac{\\mathbf{J}(\\mathbf{r}') \\times (\\mathbf{r} - \\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|^3} \\mathrm{d}V' $$\nFor an infinitesimally thin filamentary wire carrying a current $I$, the term $\\mathbf{J}(\\mathbf{r}') \\mathrm{d}V'$ is replaced by $I \\mathrm{d}\\mathbf{l}'$, where $\\mathrm{d}\\mathbf{l}'$ is a differential vector element along the wire. This yields the Biot-Savart Law, derived here from first principles as required:\n$$ \\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}I}{4\\pi} \\oint_{C} \\frac{\\mathrm{d}\\mathbf{l}' \\times (\\mathbf{r} - \\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|^3} $$\nWe now apply this law to the specific geometry of the problem. The current loop is a circle of radius $a$ in the $z=0$ plane, centered at the origin. We wish to calculate the field at a point on the symmetry axis, $\\mathbf{r} = (0,0,z)$. We use a Cartesian coordinate system.\n\nThe position vector of the field point is:\n$$ \\mathbf{r} = z \\hat{\\mathbf{z}} $$\nThe source points lie on the circular loop, parameterized by the angle $\\psi$:\n$$ \\mathbf{r}'(\\psi) = a \\cos \\psi \\,\\hat{\\mathbf{x}} + a \\sin \\psi \\,\\hat{\\mathbf{y}} $$\nThe differential line element along the current path is given as:\n$$ \\mathrm{d}\\mathbf{l}' = a(-\\sin \\psi \\,\\hat{\\mathbf{x}} + \\cos \\psi \\,\\hat{\\mathbf{y}}) \\mathrm{d}\\psi $$\nThe displacement vector from a source point to the field point is:\n$$ \\mathbf{R} \\equiv \\mathbf{r} - \\mathbf{r}' = -a \\cos \\psi \\,\\hat{\\mathbf{x}} - a \\sin \\psi \\,\\hat{\\mathbf{y}} + z \\hat{\\mathbf{z}} $$\nThe magnitude of this vector is:\n$$ |\\mathbf{R}| = \\sqrt{(-a \\cos \\psi)^{2} + (-a \\sin \\psi)^{2} + z^{2}} = \\sqrt{a^{2}(\\cos^{2}\\psi + \\sin^{2}\\psi) + z^{2}} = \\sqrt{a^{2} + z^{2}} $$\nNote that this distance is constant for all points on the loop.\n\nNext, we compute the cross product $\\mathrm{d}\\mathbf{l}' \\times \\mathbf{R}$:\n$$ \\mathrm{d}\\mathbf{l}' \\times \\mathbf{R} = \\begin{vmatrix} \\hat{\\mathbf{x}} & \\hat{\\mathbf{y}} & \\hat{\\mathbf{z}} \\\\ -a \\sin \\psi \\, \\mathrm{d}\\psi & a \\cos \\psi \\, \\mathrm{d}\\psi & 0 \\\\ -a \\cos \\psi & -a \\sin \\psi & z \\end{vmatrix} $$\nExpanding the determinant:\n$$ \\mathrm{d}\\mathbf{l}' \\times \\mathbf{R} = ((a \\cos \\psi)(z) - (0)(-a \\sin \\psi))\\,\\hat{\\mathbf{x}}\\,\\mathrm{d}\\psi - ((-a \\sin \\psi)(z) - (0)(-a \\cos \\psi))\\,\\hat{\\mathbf{y}}\\,\\mathrm{d}\\psi + ((-a \\sin \\psi)(-a \\sin \\psi) - (a \\cos \\psi)(-a \\cos \\psi))\\,\\hat{\\mathbf{z}}\\,\\mathrm{d}\\psi $$\n$$ \\mathrm{d}\\mathbf{l}' \\times \\mathbf{R} = (az \\cos \\psi \\,\\hat{\\mathbf{x}} + az \\sin \\psi \\,\\hat{\\mathbf{y}} + a^{2}(\\sin^{2}\\psi + \\cos^{2}\\psi)\\,\\hat{\\mathbf{z}}) \\mathrm{d}\\psi $$\n$$ \\mathrm{d}\\mathbf{l}' \\times \\mathbf{R} = (az \\cos \\psi \\,\\hat{\\mathbf{x}} + az \\sin \\psi \\,\\hat{\\mathbf{y}} + a^{2}\\,\\hat{\\mathbf{z}}) \\mathrm{d}\\psi $$\nNow, we substitute these expressions into the Biot-Savart integral, integrating over the full circle from $\\psi=0$ to $\\psi=2\\pi$:\n$$ \\mathbf{B}(0,0,z) = \\frac{\\mu_{0}I}{4\\pi} \\int_{0}^{2\\pi} \\frac{(az \\cos \\psi \\,\\hat{\\mathbf{x}} + az \\sin \\psi \\,\\hat{\\mathbf{y}} + a^{2}\\,\\hat{\\mathbf{z}})}{(a^{2} + z^{2})^{3/2}} \\mathrm{d}\\psi $$\nThe denominator is constant with respect to the integration variable $\\psi$ and can be factored out:\n$$ \\mathbf{B}(0,0,z) = \\frac{\\mu_{0}I}{4\\pi(a^{2} + z^{2})^{3/2}} \\int_{0}^{2\\pi} (az \\cos \\psi \\,\\hat{\\mathbf{x}} + az \\sin \\psi \\,\\hat{\\mathbf{y}} + a^{2}\\,\\hat{\\mathbf{z}}) \\mathrm{d}\\psi $$\nWe integrate term by term:\n$$ \\int_{0}^{2\\pi} az \\cos \\psi \\,\\mathrm{d}\\psi = az [\\sin \\psi]_{0}^{2\\pi} = az(0-0) = 0 $$\n$$ \\int_{0}^{2\\pi} az \\sin \\psi \\,\\mathrm{d}\\psi = az [-\\cos \\psi]_{0}^{2\\pi} = az(-1 - (-1)) = 0 $$\n$$ \\int_{0}^{2\\pi} a^{2} \\,\\mathrm{d}\\psi = a^{2} [\\psi]_{0}^{2\\pi} = 2\\pi a^{2} $$\nThe integrals for the $\\hat{\\mathbf{x}}$ and $\\hat{\\mathbf{y}}$ components vanish, confirming by explicit calculation the expectation from cylindrical symmetry that the magnetic field on the axis must point along the axis.\nThe only non-zero component is in the $\\hat{\\mathbf{z}}$ direction. Substituting the result of the integration:\n$$ \\mathbf{B}(0,0,z) = \\frac{\\mu_{0}I}{4\\pi(a^{2} + z^{2})^{3/2}} (2\\pi a^{2} \\hat{\\mathbf{z}}) $$\n$$ \\mathbf{B}(0,0,z) = \\frac{\\mu_{0}I a^{2}}{2(a^{2} + z^{2})^{3/2}} \\hat{\\mathbf{z}} $$\nThe problem asks for the axial magnetic field component $B_{z}(z)$, which is the scalar coefficient of the $\\hat{\\mathbf{z}}$ unit vector:\n$$ B_{z}(z) = \\frac{\\mu_{0} I a^{2}}{2(a^{2} + z^{2})^{3/2}} $$\nThis is the final analytical expression for the axial magnetic field component on the symmetry axis of the circular current loop. The result is given in the International System of Units (SI), so the resulting field strength is in Tesla (T).",
            "answer": "$$\\boxed{\\frac{\\mu_{0} I a^{2}}{2(a^{2} + z^{2})^{3/2}}}$$"
        },
        {
            "introduction": "Coil systems in fusion devices rarely operate in an idealized free space; they interact with surrounding conductive structures like vacuum vessels and support structures. This practice introduces the method of images, an elegant analytical technique for modeling the influence of planar perfect conductors on magnetic fields. By determining the correct image current configuration, you will learn how to simplify complex boundary value problems and gain physical intuition for how conductive surfaces modify the fields generated by nearby coils .",
            "id": "3970970",
            "problem": "In a magnetostatic approximation relevant to computational fusion science and engineering, consider the local interaction between a straight coil segment and a nearby conductive wall. Model the wall as an infinite planar Perfect Electric Conductor (PEC) occupying the region $x \\leq 0$, and free space with magnetic permeability $\\mu_0$ occupying $x > 0$. A straight, infinitely long wire representing the coil segment runs parallel to the $z$-axis and carries a steady current $I$ in the $+\\hat{\\mathbf{z}}$ direction. The wire is located at $(x,y) = (h,0)$ with $h > 0$. Assume quasi-static conditions such that skin depth in the PEC is negligible and the interior electromagnetic fields vanish. Use the magnetostatic Maxwell equations, the PEC boundary conditions, and the method of images to construct a physically consistent solution for the magnetic field in the region $x > 0$.\n\nTasks:\n1. Starting from the magnetostatic Maxwell equations $\\nabla \\times \\mathbf{H} = \\mathbf{J}$, $\\nabla \\cdot \\mathbf{B} = 0$, and $\\mathbf{B} = \\mu_0 \\mathbf{H}$ in free space, and enforcing the PEC boundary conditions at $x = 0$, justify the placement, orientation, and magnitude of a single image current that ensures the magnetic field satisfies the boundary condition at the PEC interface.\n2. Using the constructed image configuration, compute the magnetic flux density magnitude $|\\mathbf{B}|$ at a point on the PEC surface in free space, i.e., at $(x,y) = (0,a)$ with $a \\in \\mathbb{R}$. Express your final result in terms of $\\mu_0$, $I$, $h$, and $a$. Express the final magnetic flux density in Tesla (T). No numerical substitution is required; provide a closed-form analytic expression. No rounding is required.",
            "solution": "The problem is deemed valid as it is scientifically grounded in magnetostatics, well-posed with sufficient information and clear objectives, and objectively stated.\n\nThe problem asks for the justification of an image current configuration and the resulting magnetic flux density at a specific point on the surface of a Perfect Electric Conductor (PEC).\n\n### Part 1: Justification of the Image Current\n\nThe physical system consists of an infinitely long, straight wire carrying a steady current $I$ in the $+\\hat{\\mathbf{z}}$ direction, located at $(x,y) = (h,0)$ with $h>0$. The region $x \\le 0$ is a PEC, and the region $x > 0$ is free space with magnetic permeability $\\mu_0$. The analysis is governed by the magnetostatic Maxwell equations in free space:\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} \\\\\n\\nabla \\cdot \\mathbf{B} = 0\n$$\nwhere $\\mathbf{B}$ is the magnetic flux density and $\\mathbf{J}$ is the current density. For our region of interest, $x > 0$, the source current density is $\\mathbf{J} = I \\delta(x-h)\\delta(y)\\hat{\\mathbf{z}}$.\n\nThe boundary condition for the magnetic field at the surface of a PEC is that the component of $\\mathbf{B}$ normal to the surface must be zero. The PEC surface is the plane $x=0$, and the normal vector pointing into the free space region is $\\hat{\\mathbf{n}} = \\hat{\\mathbf{x}}$. The boundary condition is therefore:\n$$\n\\mathbf{B} \\cdot \\hat{\\mathbf{n}} |_{x=0} = B_x(0, y) = 0\n$$\nThis condition must hold for all values of $y$.\n\nWe use the method of images to solve this problem. We replace the PEC with a fictitious \"image\" current, positioned in the region $x < 0$. The total magnetic field in the region $x > 0$ is then the superposition of the field from the original current and the field from the image current. The configuration of the image current (position, magnitude, direction) must be chosen such that the boundary condition $B_x(0, y) = 0$ is satisfied.\n\nThe magnetic field produced by an infinitely long straight wire with current $I$ along the $\\hat{\\mathbf{z}}$-axis is given by Ampere's law. For a wire at a general position $(x_0, y_0)$, the field at a point $(x,y)$ is:\n$$\n\\mathbf{B}(x,y) = \\frac{\\mu_0 I}{2\\pi} \\frac{-(y-y_0)\\hat{\\mathbf{x}} + (x-x_0)\\hat{\\mathbf{y}}}{(x-x_0)^2 + (y-y_0)^2}\n$$\n\nThe field from the original wire at $(h,0)$ carrying current $I$ is:\n$$\n\\mathbf{B}_{\\text{orig}}(x,y) = \\frac{\\mu_0 I}{2\\pi} \\frac{-y\\hat{\\mathbf{x}} + (x-h)\\hat{\\mathbf{y}}}{(x-h)^2 + y^2}\n$$\nThe $x$-component of this field at the boundary $x=0$ is:\n$$\nB_{\\text{orig},x}(0,y) = \\frac{\\mu_0 I}{2\\pi} \\frac{-y}{(-h)^2 + y^2} = -\\frac{\\mu_0 I y}{2\\pi (h^2 + y^2)}\n$$\nThis is non-zero, so an image current is required. Let us postulate an image current $I'$ located at $(x', y')$. Its field is:\n$$\n\\mathbf{B}_{\\text{image}}(x,y) = \\frac{\\mu_0 I'}{2\\pi} \\frac{-(y-y')\\hat{\\mathbf{x}} + (x-x')\\hat{\\mathbf{y}}}{(x-x')^2 + (y-y')^2}\n$$\nThe $x$-component of the image field at $x=0$ is:\n$$\nB_{\\text{image},x}(0,y) = \\frac{\\mu_0 I'}{2\\pi} \\frac{-(y-y')}{(-x')^2 + (y-y')^2}\n$$\nThe total $x$-component of the field at the boundary must be zero:\n$$\nB_{\\text{total},x}(0,y) = B_{\\text{orig},x}(0,y) + B_{\\text{image},x}(0,y) = 0\n$$\n$$\n-\\frac{\\mu_0 I y}{2\\pi (h^2 + y^2)} + \\frac{-\\mu_0 I' (y-y')}{2\\pi ((x')^2 + (y-y')^2)} = 0\n$$\nTo satisfy this equation for all $y$, we need the denominators to have the same functional form. A symmetric placement suggests itself. Let's place the image wire at the mirror position across the $y-z$ plane, so $x' = -h$ and $y' = 0$. The equation becomes:\n$$\n-\\frac{\\mu_0 I y}{2\\pi (h^2 + y^2)} + \\frac{-\\mu_0 I' y}{2\\pi ((-(-h))^2 + y^2)} = 0\n$$\n$$\n-\\frac{\\mu_0 y}{2\\pi (h^2 + y^2)} (I + I') = 0\n$$\nFor this to hold true for any $y \\neq 0$, we must have $I+I' = 0$, which implies $I' = -I$.\n\nThus, the image current required to satisfy the boundary conditions is:\n1.  **Placement**: Located at $(x,y)=(-h,0)$, the mirror image of the original current's position.\n2.  **Magnitude**: Equal in magnitude to the original current, $|I'| = |I|$.\n3.  **Orientation**: Opposite in direction, flowing in the $-\\hat{\\mathbf{z}}$ direction.\n\n### Part 2: Magnetic Flux Density at $(0,a)$\n\nThe total magnetic field in the region $x > 0$ is the superposition of the fields from the original current $I$ at $(h,0)$ and the image current $-I$ at $(-h,0)$.\n$$\n\\mathbf{B}_{\\text{total}}(x,y) = \\mathbf{B}_{\\text{orig}}(x,y) + \\mathbf{B}_{\\text{image}}(x,y)\n$$\n$$\n\\mathbf{B}_{\\text{total}}(x,y) = \\frac{\\mu_0 I}{2\\pi} \\frac{-y\\hat{\\mathbf{x}} + (x-h)\\hat{\\mathbf{y}}}{(x-h)^2 + y^2} + \\frac{\\mu_0 (-I)}{2\\pi} \\frac{-y\\hat{\\mathbf{x}} + (x-(-h))\\hat{\\mathbf{y}}}{(x-(-h))^2 + y^2}\n$$\n$$\n\\mathbf{B}_{\\text{total}}(x,y) = \\frac{\\mu_0 I}{2\\pi} \\left( \\frac{-y\\hat{\\mathbf{x}} + (x-h)\\hat{\\mathbf{y}}}{(x-h)^2 + y^2} - \\frac{-y\\hat{\\mathbf{x}} + (x+h)\\hat{\\mathbf{y}}}{(x+h)^2 + y^2} \\right)\n$$\nWe need to evaluate this field at the point $(x,y)=(0,a)$ on the PEC surface.\nSubstituting $x=0$ and $y=a$:\n$$\n\\mathbf{B}_{\\text{total}}(0,a) = \\frac{\\mu_0 I}{2\\pi} \\left( \\frac{-a\\hat{\\mathbf{x}} + (-h)\\hat{\\mathbf{y}}}{(-h)^2 + a^2} - \\frac{-a\\hat{\\mathbf{x}} + h\\hat{\\mathbf{y}}}{h^2 + a^2} \\right)\n$$\n$$\n\\mathbf{B}_{\\text{total}}(0,a) = \\frac{\\mu_0 I}{2\\pi (h^2 + a^2)} \\left( (-a\\hat{\\mathbf{x}} - h\\hat{\\mathbf{y}}) - (-a\\hat{\\mathbf{x}} + h\\hat{\\mathbf{y}}) \\right)\n$$\n$$\n\\mathbf{B}_{\\text{total}}(0,a) = \\frac{\\mu_0 I}{2\\pi (h^2 + a^2)} (-a\\hat{\\mathbf{x}} - h\\hat{\\mathbf{y}} + a\\hat{\\mathbf{x}} - h\\hat{\\mathbf{y}})\n$$\n$$\n\\mathbf{B}_{\\text{total}}(0,a) = \\frac{\\mu_0 I}{2\\pi (h^2 + a^2)} (-2h\\hat{\\mathbf{y}}) = -\\frac{\\mu_0 I h}{\\pi (h^2 + a^2)} \\hat{\\mathbf{y}}\n$$\nThe magnetic field vector at $(0,a)$ is purely in the $-\\hat{\\mathbf{y}}$ direction. Its components are $B_x=0$, $B_y = -\\frac{\\mu_0 I h}{\\pi (h^2 + a^2)}$, and $B_z=0$. The magnitude of the magnetic flux density is the absolute value of this vector:\n$$\n|\\mathbf{B}(0,a)| = \\sqrt{B_x^2 + B_y^2 + B_z^2} = \\sqrt{0^2 + \\left(-\\frac{\\mu_0 I h}{\\pi (h^2 + a^2)}\\right)^2 + 0^2}\n$$\n$$\n|\\mathbf{B}(0,a)| = \\frac{\\mu_0 |I| h}{\\pi (h^2 + a^2)}\n$$\nAssuming $I$ is a positive quantity representing the current magnitude, as is conventional when a direction is specified, we can write the final expression.",
            "answer": "$$\\boxed{\\frac{\\mu_0 I h}{\\pi (h^2 + a^2)}}$$"
        },
        {
            "introduction": "This practice bridges the gap between analytical theory and practical, high-fidelity computation. While the Biot-Savart law provides a clear integral expression for the magnetic field, its numerical evaluation is challenged by singularities when the observation point is near the current-carrying wire. This exercise guides you through implementing an advanced, endpoint-adaptive quadrature scheme to accurately compute the field from a straight wire segment, a core task in codes that model complex coils as a series of such segments. This is a direct, hands-on application of numerical analysis to solve a real-world problem in computational electromagnetics .",
            "id": "3970911",
            "problem": "You are tasked with computing the magnetic field produced by a single straight current-carrying segment using a robust endpoint-adaptive quadrature that maintains high accuracy when the observation point is close to the segment endpoints. The magnetic field in magnetostatics is governed by Maxwell's equations under steady currents, specifically $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$, and the magnetic field due to a filamentary conductor carrying current $I$ can be derived from the Biot–Savart law. For a straight segment parameterized by $\\mathbf{r}'(s) = \\mathbf{r}_1 + s (\\mathbf{r}_2 - \\mathbf{r}_1)$ for $s \\in [0,1]$, the magnetic field at an observation point $\\mathbf{r}$ is\n$$\n\\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_0 I}{4\\pi} \\int_0^1 \\frac{d\\boldsymbol{\\ell}' \\times \\mathbf{R}(s)}{\\|\\mathbf{R}(s)\\|^3},\n$$\nwhere $d\\boldsymbol{\\ell}' = (\\mathbf{r}_2 - \\mathbf{r}_1) ds$, $\\mathbf{R}(s) = \\mathbf{r} - \\mathbf{r}'(s)$, and $\\|\\cdot\\|$ denotes the Euclidean norm.\n\nStandard uniform quadrature over $s \\in [0,1]$ suffers near-endpoint singular behavior because $\\|\\mathbf{R}(s)\\|$ can become small as $s \\to 0$ or $s \\to 1$ when $\\mathbf{r}$ is near $\\mathbf{r}_1$ or $\\mathbf{r}_2$. To address this, you must implement endpoint-adaptive quadrature via a Double-Exponential (DE) transformation that maps $t \\in (-\\infty,\\infty)$ to $s \\in [0,1]$,\n$$\ns(t) = \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{\\pi}{2}\\sinh t\\right)\\right), \\quad \\frac{ds}{dt} = \\frac{\\pi}{4}\\cosh t \\cdot \\operatorname{sech}^2\\!\\left(\\frac{\\pi}{2} \\sinh t\\right),\n$$\nso that the integral becomes\n$$\n\\int_0^1 f(s)\\,ds = \\int_{-\\infty}^{\\infty} f\\!\\left(s(t)\\right)\\,\\frac{ds}{dt}\\,dt,\n$$\nwith $f(s) = \\dfrac{(\\mathbf{r}_2 - \\mathbf{r}_1) \\times \\mathbf{R}(s)}{\\|\\mathbf{R}(s)\\|^3}$. The DE mapping clusters quadrature nodes near $s=0$ and $s=1$, improving accuracy near endpoints.\n\nYour program must:\n- Implement the above DE-transformed quadrature with symmetric truncation and step refinement until convergence to integrate each Cartesian component of $\\mathbf{B}(\\mathbf{r})$.\n- Use physical constants $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$ and current $I$ as specified in the test suite.\n- Parameterize a straight segment of length $L$ with endpoints $\\mathbf{r}_1$ and $\\mathbf{r}_2$ as given, and compute $\\mathbf{B}(\\mathbf{r})$ in Tesla for the specified observation points.\n\nThe geometry and parameters for the test suite are:\n- Segment endpoints in meters: $\\mathbf{r}_1 = (0,\\,0,\\,-0.3)$, $\\mathbf{r}_2 = (0,\\,0,\\,0.3)$, so the segment length is $L = 0.6$.\n- Current in Amperes: $I = 10000$.\n- Magnetic permeability: $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n- Observation points (each in meters):\n    1. $\\mathbf{r} = (0.001,\\,0.0,\\,0.301)$ near the upper endpoint.\n    2. $\\mathbf{r} = (0.001,\\,0.0,\\,-0.3005)$ near the lower endpoint.\n    3. $\\mathbf{r} = (0.003,\\,0.0,\\,0.0)$ near the segment midpoint.\n    4. $\\mathbf{r} = (0.5,\\,0.4,\\,0.3)$ in the far field.\n    5. $\\mathbf{r} = (0.001,\\,0.0,\\,0.30001)$ extremely close to the upper endpoint.\n\nYour implementation must:\n- Use the DE mapping $s(t)$ with step $h$ progressively refined until the change in the integral vector between successive refinements is below a tolerance (e.g., absolute difference $< 10^{-10}$ in the Euclidean norm).\n- Truncate the symmetric sum over $t = \\pm k h$ where the contribution weights $\\frac{ds}{dt}h$ and the integrand norm are sufficiently small.\n- Ensure numerical stability and avoid division by zero by guaranteeing $\\|\\mathbf{R}(s)\\| > 0$ for all evaluation points.\n\nRequired output:\n- Compute the magnetic field vector components $\\mathbf{B}(\\mathbf{r})$ for each observation point in Tesla.\n- Your program should produce a single line of output containing the results as a comma-separated list of per-case 3-element lists, with each component as a float, enclosed in square brackets, in Tesla.\n- The exact output format must be a single line without spaces, for example: `[[Bx1,By1,Bz1],[Bx2,By2,Bz2],...]`.\n\nYour program must use the following test suite of observation points and output the magnetic field vectors in Tesla:\n- Case $1$: $\\mathbf{r} = (0.001,\\,0.0,\\,0.301)$.\n- Case $2$: $\\mathbf{r} = (0.001,\\,0.0,\\,-0.3005)$.\n- Case $3$: $\\mathbf{r} = (0.003,\\,0.0,\\,0.0)$.\n- Case $4$: $\\mathbf{r} = (0.5,\\,0.4,\\,0.3)$.\n- Case $5$: $\\mathbf{r} = (0.001,\\,0.0,\\,0.30001)$.\n\nAll outputs must be in Tesla, with the final result printed only as the single line described above.",
            "solution": "The user has provided a valid, well-posed problem in computational physics. The problem is scientifically grounded in the principles of magnetostatics, specifically the Biot-Savart law, and requests a solution using a specified advanced numerical technique, the Double-Exponential (DE) quadrature. All necessary parameters, constants, and boundary conditions are provided, and the problem is free of contradictions or ambiguities.\n\nHerein, a principled, step-by-step solution is developed.\n\n### 1. Governing Principle: The Biot-Savart Law\nThe fundamental principle governing the magnetic field $\\mathbf{B}$ generated by a steady current $I$ is the Biot-Savart law. For a thin wire (filamentary conductor), the magnetic field at an observation point $\\mathbf{r}$ is given by the line integral along the path $C$ of the wire:\n$$\n\\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_0 I}{4\\pi} \\int_C \\frac{d\\boldsymbol{\\ell}' \\times \\mathbf{R}}{\\|\\mathbf{R}\\|^3}\n$$\nwhere $\\mu_0$ is the magnetic permeability of free space, $d\\boldsymbol{\\ell}'$ is an infinitesimal vector element of the wire in the direction of the current, and $\\mathbf{R} = \\mathbf{r} - \\mathbf{r}'$ is the vector from a source point $\\mathbf{r}'$ on the wire to the observation point $\\mathbf{r}$.\n\n### 2. Problem Formalization\nThe problem defines a straight wire segment with endpoints $\\mathbf{r}_1$ and $\\mathbf{r}_2$. This segment can be parameterized using a scalar variable $s \\in [0, 1]$:\n$$\n\\mathbf{r}'(s) = \\mathbf{r}_1 + s(\\mathbf{r}_2 - \\mathbf{r}_1)\n$$\nThe corresponding infinitesimal vector element is $d\\boldsymbol{\\ell}' = (\\mathbf{r}_2 - \\mathbf{r}_1) ds$. Substituting this into the Biot-Savart law yields the specific integral to be solved:\n$$\n\\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_0 I}{4\\pi} \\int_0^1 \\frac{(\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r} - \\mathbf{r}'(s))}{\\|\\mathbf{r} - \\mathbf{r}'(s)\\|^3} ds\n$$\nFor brevity, let the vector integrand be $\\mathbf{F}(s) = \\frac{(\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r} - \\mathbf{r}'(s))}{\\|\\mathbf{r} - \\mathbf{r}'(s)\\|^3}$.\n\n### 3. Numerical Challenge and Endpoint-Adaptive Quadrature\nA direct numerical evaluation of the integral over $s$ using standard methods like the trapezoidal or Simpson's rule with uniform spacing is inefficient. The denominator, $\\|\\mathbf{R}(s)\\| = \\|\\mathbf{r} - \\mathbf{r}'(s)\\|$, approaches zero if the observation point $\\mathbf{r}$ is near one of the endpoints $\\mathbf{r}_1$ (where $s=0$) or $\\mathbf{r}_2$ (where $s=1$). This creates sharp peaks in the integrand $\\mathbf{F}(s)$ near the endpoints, a form of near-singularity that severely degrades the accuracy of uniform-grid quadrature.\n\nThe problem prescribes a Double-Exponential (DE) transformation to overcome this. This method uses a change of variables from $s \\in [0, 1]$ to $t \\in (-\\infty, \\infty)$:\n$$\ns(t) = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{\\pi}{2}\\sinh t\\right)\\right)\n$$\nThe differential element $ds$ is transformed as $ds = \\frac{ds}{dt} dt$, where the derivative is:\n$$\n\\frac{ds}{dt} = \\frac{\\pi}{4}\\cosh t \\cdot \\operatorname{sech}^2\\left(\\frac{\\pi}{2} \\sinh t\\right)\n$$\nThe integral becomes:\n$$\n\\int_0^1 \\mathbf{F}(s) ds = \\int_{-\\infty}^{\\infty} \\mathbf{F}(s(t)) \\frac{ds}{dt} dt\n$$\nThe key feature of this transformation is that the transformed integrand, $\\mathbf{G}(t) = \\mathbf{F}(s(t)) \\frac{ds}{dt}$, decays to zero at a double-exponential rate as $|t| \\to \\infty$. This rapid decay makes the trapezoidal rule exceptionally accurate for approximating the infinite integral.\n\n### 4. Algorithmic Implementation\nThe numerical algorithm proceeds as follows:\n\n1.  **Approximation by Trapezoidal Rule:** The infinite integral is approximated by a finite sum using the trapezoidal rule with a uniform step size $h$:\n    $$\n    \\int_{-\\infty}^{\\infty} \\mathbf{G}(t) dt \\approx h \\sum_{k=-N}^{N} \\mathbf{G}(kh)\n    $$\n    Due to the rapid decay of $\\mathbf{G}(t)$, the summation can be truncated at a moderate value of $N$ such that $t_{max} = Nh$ is sufficiently large (e.g., $t_{max} \\approx 6$) without significant loss of accuracy.\n\n2.  **Adaptive Step Refinement:** To ensure convergence to a desired tolerance, an adaptive scheme is used.\n    a.  Start with an initial step size, e.g., $h_0 = 1.0$.\n    b.  In each iteration, the step size is halved: $h_{j+1} = h_j/2$.\n    c.  The integral $\\mathbf{I}_{j+1}$ is computed using the new step size $h_{j+1}$.\n    d.  The process terminates when the Euclidean norm of the difference between successive integral approximations falls below a specified tolerance $\\epsilon$:\n        $$\n        \\|\\mathbf{I}_{j+1} - \\mathbf{I}_{j}\\| < \\epsilon\n        $$\n    For this problem, the tolerance is $\\epsilon = 10^{-10}$.\n\n3.  **Numerical Stability:** The calculation of $\\frac{ds}{dt}$ involves `cosh` of terms that grow exponentially with $t$. For large $|t|$, `cosh` can overflow standard floating-point types. However, $\\operatorname{sech}^2(x) = (1/\\cosh(x))^2$ simultaneously underflows to zero even more rapidly. The implementation must handle this gracefully. The summation range for $t = kh$ can be safely truncated where $|t| > 6.0$, as the derivative $\\frac{ds}{dt}$ becomes numerically indistinguishable from zero.\n\n4.  **Final Calculation:** Once the integral vector $\\mathbf{I}_{conv} = \\int_0^1 \\mathbf{F}(s) ds$ has converged, the magnetic field is calculated by multiplying by the physical constants:\n    $$\n    \\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_0 I}{4\\pi} \\mathbf{I}_{conv}\n    $$\n    The constant prefactor simplifies to $\\frac{4\\pi \\times 10^{-7} \\cdot 10000}{4\\pi} = 10^{-3}$.\n\nThis methodology results in a robust and highly accurate computation of the magnetic field, even for observation points extremely close to the current segment's endpoints, as required by the test suite. The implementation will be encapsulated in a class for clarity, handling each observation point as a separate computation.",
            "answer": "```python\nimport numpy as np\nfrom scipy.constants import mu_0\n\nclass BiotSavartSolverDE:\n    \"\"\"\n    Computes the magnetic field of a straight current segment using\n    Double-Exponential (DE) quadrature to handle endpoint singularities.\n    \"\"\"\n    def __init__(self, r1, r2, current):\n        \"\"\"\n        Initializes the solver with the segment geometry and current.\n        \n        Args:\n            r1 (tuple/list): Coordinates of the start point of the segment (meters).\n            r2 (tuple/list): Coordinates of the end point of the segment (meters).\n            current (float): Current in the segment (Amperes).\n        \"\"\"\n        self.r1 = np.array(r1, dtype=float)\n        self.r2 = np.array(r2, dtype=float)\n        self.current = float(current)\n        self.coeff = mu_0 * self.current / (4.0 * np.pi)\n        self.ds_vec = self.r2 - self.r1\n\n    def _g_vec_t(self, t, r_minus_r1):\n        \"\"\"\n        Calculates the transformed integrand vector G(t) = F(s(t)) * ds/dt.\n        \n        Args:\n            t (float): The transformed integration variable.\n            r_minus_r1 (np.ndarray): Pre-computed vector from r1 to obs point.\n\n        Returns:\n            np.ndarray: The vector value of the transformed integrand at t.\n        \"\"\"\n        # The argument to sinh/tanh/cosh in the DE transform\n        arg_sinh = 0.5 * np.pi * np.sinh(t)\n\n        # For large |t|, sinh(t) -> inf, cosh(arg_sinh) -> inf.\n        # This causes overflow. However, ds/dt rapidly vanishes.\n        # For |t| > 6, the contribution is numerically zero.\n        if abs(t) > 6.0:\n            return np.zeros(3)\n\n        # DE coordinate transformation s(t)\n        s = 0.5 * (1.0 + np.tanh(arg_sinh))\n\n        # Derivative ds/dt, implemented carefully to avoid overflow/underflow issues.\n        try:\n            cosh_arg_sinh = np.cosh(arg_sinh)\n            if np.isinf(cosh_arg_sinh): # Handle overflow explicitly\n                return np.zeros(3)\n            dsdt = 0.25 * np.pi * np.cosh(t) / (cosh_arg_sinh**2)\n        except OverflowError:\n            return np.zeros(3)\n\n        # If ds/dt is negligible, no further computation is necessary.\n        if dsdt < 1e-300:\n            return np.zeros(3)\n\n        # Biot-Savart integrand F(s)\n        R_vec = r_minus_r1 - s * self.ds_vec\n        R_norm_sq = np.dot(R_vec, R_vec)\n        \n        # The problem statement guarantees r_obs is not on the segment.\n        # R_norm will be > 0.\n        R_norm_cubed = R_norm_sq * np.sqrt(R_norm_sq)\n        \n        integrand_s = np.cross(self.ds_vec, R_vec) / R_norm_cubed\n        \n        return integrand_s * dsdt\n\n    def compute_B(self, r_obs, tol=1e-10):\n        \"\"\"\n        Computes the magnetic field vector B at a given observation point.\n        \n        Args:\n            r_obs (tuple/list): The observation point coordinates (meters).\n            tol (float): The absolute error tolerance for convergence.\n\n        Returns:\n            np.ndarray: The computed magnetic field vector (Bx, By, Bz) in Tesla.\n        \"\"\"\n        r_obs = np.array(r_obs, dtype=float)\n        r_minus_r1 = r_obs - self.r1\n        \n        h = 1.0  # Initial step size for quadrature\n        integral_val = np.zeros(3)\n        \n        # Iteratively refine step size h until integral converges\n        while True:\n            prev_integral_val = integral_val\n            h /= 2.0\n            \n            # Since DE quadrature converges very fast, a safety break on h\n            # is a good idea to prevent potential infinite loops.\n            if h < 1e-5:\n                break\n                \n            t_max = 6.0  # Truncation limit for the \"infinite\" integral\n            num_steps = int(t_max / h)\n            \n            # Trapezoidal rule summation, exploiting symmetry of interval\n            # Add k=0 term\n            current_sum = self._g_vec_t(0.0, r_minus_r1)\n            \n            # Add k > 0 and k < 0 terms\n            for k in range(1, num_steps + 1):\n                t = k * h\n                current_sum += self._g_vec_t(t, r_minus_r1) + self._g_vec_t(-t, r_minus_r1)\n                \n            integral_val = h * current_sum\n            \n            # Check for convergence based on the norm of the vector difference\n            if np.linalg.norm(integral_val - prev_integral_val) < tol:\n                break\n                \n        return self.coeff * integral_val\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n    # Problem parameters\n    r1 = (0.0, 0.0, -0.3)\n    r2 = (0.0, 0.0, 0.3)\n    current = 10000.0\n\n    # Observation points from the test suite\n    test_cases = [\n        (0.001, 0.0, 0.301),\n        (0.001, 0.0, -0.3005),\n        (0.003, 0.0, 0.0),\n        (0.5, 0.4, 0.3),\n        (0.001, 0.0, 0.30001)\n    ]\n\n    solver = BiotSavartSolverDE(r1, r2, current)\n    \n    results = []\n    for r_obs in test_cases:\n        B_vector = solver.compute_B(r_obs)\n        results.append(B_vector.tolist())\n\n    # Format the output string exactly as required, removing all spaces.\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}