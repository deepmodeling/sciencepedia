{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础但至关重要的练习开始。计算一个简单的圆形载流线圈在其轴线上产生的磁场，是理解更复杂线圈系统电磁特性的第一步。这个实践不仅是一个经典的电磁学问题，它还能加深我们对基本定律（如麦克斯韦方程组）如何通过矢量势等数学工具，最终导出用于工程计算的毕奥-萨伐尔定律的理解。",
            "id": "3970920",
            "problem": "在静磁真空中，磁场 $\\mathbf{B}$ 满足 $\\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J}$ 和 $\\nabla \\cdot \\mathbf{B} = 0$，其中 $\\mu_{0}$ 是真空磁导率，$\\mathbf{J}$ 是稳恒电流密度。考虑一个单匝圆形线圈，用作聚变装置中环向场线圈组的理想化元件。该线圈被建模为一个半径为 $a$ 的无限细的线环，位于 $z=0$ 平面内，以原点为中心，并沿 $\\hat{\\boldsymbol{\\phi}}$ 方向载有恒定电流 $I$。真空区域是指导体外的整个空间。电流密度 $\\mathbf{J}(\\mathbf{r})$ 是一个集中在圆形曲线 $\\mathbf{r}'(\\psi) = a \\cos \\psi \\,\\hat{\\mathbf{x}} + a \\sin \\psi \\,\\hat{\\mathbf{y}} + 0 \\,\\hat{\\mathbf{z}}$ 上的分布，其线元方向由 $\\mathrm{d}\\mathbf{l}' = a \\left( -\\sin \\psi \\,\\hat{\\mathbf{x}} + \\cos \\psi \\,\\hat{\\mathbf{y}} \\right) \\mathrm{d}\\psi$ 给出，电流为 $I$。\n\n从静磁学麦克斯韦方程组出发，在库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$ 下引入矢量势 $\\mathbf{A}$ (其中 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$)，从第一性原理推导对称轴（$z$ 轴，即 $\\mathbf{r} = (0,0,z)$ 处）上的轴向磁场分量 $B_{z}(z)$ 的解析表达式。最终答案需用 $\\mu_{0}$、$I$、$a$ 和 $z$ 表示。仅使用所述的基本定律；不要引用已有的结果。以国际单位制 (SI) 中的特斯拉 (Tesla) 为单位表示最终磁场。最终答案必须是单一的闭合形式解析表达式。",
            "solution": "所述问题构成经典电磁学中一个有效的、适定的问题。它具有科学依据、内容自洽，且没有矛盾或歧义。因此，我们可以进行严格的推导。\n\n分析从所提供的真空静磁学基本方程开始：\n1. 安培定律（微分形式）：\n$$ \\nabla \\times \\mathbf{B} = \\mu_{0} \\mathbf{J} $$\n2. 磁高斯定律：\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\n这里，$\\mathbf{B}$ 是磁场，$\\mathbf{J}$ 是稳恒电流密度，$\\mu_{0}$ 是真空磁导率。\n\n条件 $\\nabla \\cdot \\mathbf{B} = 0$ 意味着 $\\mathbf{B}$ 可以表示为某个矢量势 $\\mathbf{A}$ 的旋度：\n$$ \\mathbf{B} = \\nabla \\times \\mathbf{A} $$\n这个定义不是唯一的，因为可以在 $\\mathbf{A}$ 上加上任意标量场的梯度而不会改变 $\\mathbf{B}$。我们施加库仑规范条件 $\\nabla \\cdot \\mathbf{A} = 0$，以在适当的边界条件下使 $\\mathbf{A}$ 的选择唯一。\n\n将 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 代入安培定律得到：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{A}) = \\mu_{0} \\mathbf{J} $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{V}) = \\nabla(\\nabla \\cdot \\mathbf{V}) - \\nabla^2 \\mathbf{V}$，我们得到：\n$$ \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A} = \\mu_{0} \\mathbf{J} $$\n应用库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$，上式简化为矢量势的泊松方程：\n$$ \\nabla^2 \\mathbf{A} = - \\mu_{0} \\mathbf{J} $$\n在无界域中，该方程的解由以下积分给出：\n$$ \\mathbf{A}(\\mathbf{r}) = \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\frac{\\mathbf{J}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\mathrm{d}V' $$\n其中 $\\mathbf{r}$ 是场点，$\\mathbf{r}'$ 是进行积分的源点。\n\n为求磁场 $\\mathbf{B}$，我们计算其旋度 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$：\n$$ \\mathbf{B}(\\mathbf{r}) = \\nabla \\times \\left( \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\frac{\\mathbf{J}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\mathrm{d}V' \\right) $$\n旋度算符 $\\nabla$ 作用于 $\\mathbf{r}$ 的未加撇坐标，因此可以将其移到积分号内：\n$$ \\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\nabla \\times \\left( \\frac{\\mathbf{J}(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\right) \\mathrm{d}V' $$\n使用矢量积法则 $\\nabla \\times (f\\mathbf{C}) = f(\\nabla \\times \\mathbf{C}) + (\\nabla f) \\times \\mathbf{C}$，其中 $f = 1/|\\mathbf{r} - \\mathbf{r}'|$ 且 $\\mathbf{C} = \\mathbf{J}(\\mathbf{r}')$。我们注意到 $\\mathbf{J}(\\mathbf{r}')$ 只依赖于加撇的坐标，所以 $\\nabla \\times \\mathbf{J}(\\mathbf{r}') = \\mathbf{0}$。这得到：\n$$ \\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\left( \\nabla \\frac{1}{|\\mathbf{r} - \\mathbf{r}'|} \\right) \\times \\mathbf{J}(\\mathbf{r}') \\mathrm{d}V' $$\n标量函数的梯度为 $\\nabla (1/|\\mathbf{r} - \\mathbf{r}'|) = -\\frac{\\mathbf{r} - \\mathbf{r}'}{|\\mathbf{r} - \\mathbf{r}'|^3}$。代入此式可得：\n$$ \\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\left( -\\frac{\\mathbf{r} - \\mathbf{r}'}{|\\mathbf{r} - \\mathbf{r}'|^3} \\right) \\times \\mathbf{J}(\\mathbf{r}') \\mathrm{d}V' = \\frac{\\mu_{0}}{4\\pi} \\int_{V'} \\frac{\\mathbf{J}(\\mathbf{r}') \\times (\\mathbf{r} - \\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|^3} \\mathrm{d}V' $$\n对于载有电流 $I$ 的无限细导线，$\\mathbf{J}(\\mathbf{r}') \\mathrm{d}V'$ 项被替换为 $I \\mathrm{d}\\mathbf{l}'$，其中 $\\mathrm{d}\\mathbf{l}'$ 是沿导线的微分矢量元。这就得到了按要求从第一性原理推导出的毕奥-萨伐尔定律：\n$$ \\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}I}{4\\pi} \\oint_{C} \\frac{\\mathrm{d}\\mathbf{l}' \\times (\\mathbf{r} - \\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|^3} $$\n现在我们将此定律应用于问题的特定几何结构。电流环路是位于 $z=0$ 平面内、以原点为中心、半径为 $a$ 的一个圆。我们希望计算对称轴上一点 $\\mathbf{r} = (0,0,z)$ 处的磁场。我们使用笛卡尔坐标系。\n\n场点的位置矢量是：\n$$ \\mathbf{r} = z \\hat{\\mathbf{z}} $$\n源点位于圆形环路上，由角度 $\\psi$ 参数化：\n$$ \\mathbf{r}'(\\psi) = a \\cos \\psi \\,\\hat{\\mathbf{x}} + a \\sin \\psi \\,\\hat{\\mathbf{y}} $$\n沿电流路径的微分线元为：\n$$ \\mathrm{d}\\mathbf{l}' = a(-\\sin \\psi \\,\\hat{\\mathbf{x}} + \\cos \\psi \\,\\hat{\\mathbf{y}}) \\mathrm{d}\\psi $$\n从源点到场点的位移矢量是：\n$$ \\mathbf{R} \\equiv \\mathbf{r} - \\mathbf{r}' = -a \\cos \\psi \\,\\hat{\\mathbf{x}} - a \\sin \\psi \\,\\hat{\\mathbf{y}} + z \\hat{\\mathbf{z}} $$\n该矢量的模长是：\n$$ |\\mathbf{R}| = \\sqrt{(-a \\cos \\psi)^{2} + (-a \\sin \\psi)^{2} + z^{2}} = \\sqrt{a^{2}(\\cos^{2}\\psi + \\sin^{2}\\psi) + z^{2}} = \\sqrt{a^{2} + z^{2}} $$\n注意，对于环路上的所有点，此距离是恒定的。\n\n接下来，我们计算叉积 $\\mathrm{d}\\mathbf{l}' \\times \\mathbf{R}$：\n$$ \\mathrm{d}\\mathbf{l}' \\times \\mathbf{R} = \\begin{vmatrix} \\hat{\\mathbf{x}}  \\hat{\\mathbf{y}}  \\hat{\\mathbf{z}} \\\\ -a \\sin \\psi \\, \\mathrm{d}\\psi  a \\cos \\psi \\, \\mathrm{d}\\psi  0 \\\\ -a \\cos \\psi  -a \\sin \\psi  z \\end{vmatrix} $$\n展开行列式：\n$$ \\mathrm{d}\\mathbf{l}' \\times \\mathbf{R} = ((a \\cos \\psi)(z) - (0)(-a \\sin \\psi))\\,\\hat{\\mathbf{x}}\\,\\mathrm{d}\\psi - ((-a \\sin \\psi)(z) - (0)(-a \\cos \\psi))\\,\\hat{\\mathbf{y}}\\,\\mathrm{d}\\psi + ((-a \\sin \\psi)(-a \\sin \\psi) - (a \\cos \\psi)(-a \\cos \\psi))\\,\\hat{\\mathbf{z}}\\,\\mathrm{d}\\psi $$\n$$ \\mathrm{d}\\mathbf{l}' \\times \\mathbf{R} = (az \\cos \\psi \\,\\hat{\\mathbf{x}} + az \\sin \\psi \\,\\hat{\\mathbf{y}} + a^{2}(\\sin^{2}\\psi + \\cos^{2}\\psi)\\,\\hat{\\mathbf{z}}) \\mathrm{d}\\psi $$\n$$ \\mathrm{d}\\mathbf{l}' \\times \\mathbf{R} = (az \\cos \\psi \\,\\hat{\\mathbf{x}} + az \\sin \\psi \\,\\hat{\\mathbf{y}} + a^{2}\\,\\hat{\\mathbf{z}}) \\mathrm{d}\\psi $$\n现在，我们将这些表达式代入毕奥-萨伐尔积分，对整个圆从 $\\psi=0$ 到 $\\psi=2\\pi$ 进行积分：\n$$ \\mathbf{B}(0,0,z) = \\frac{\\mu_{0}I}{4\\pi} \\int_{0}^{2\\pi} \\frac{(az \\cos \\psi \\,\\hat{\\mathbf{x}} + az \\sin \\psi \\,\\hat{\\mathbf{y}} + a^{2}\\,\\hat{\\mathbf{z}})}{(a^{2} + z^{2})^{3/2}} \\mathrm{d}\\psi $$\n分母相对于积分变量 $\\psi$ 是一个常数，可以提取出来：\n$$ \\mathbf{B}(0,0,z) = \\frac{\\mu_{0}I}{4\\pi(a^{2} + z^{2})^{3/2}} \\int_{0}^{2\\pi} (az \\cos \\psi \\,\\hat{\\mathbf{x}} + az \\sin \\psi \\,\\hat{\\mathbf{y}} + a^{2}\\,\\hat{\\mathbf{z}}) \\mathrm{d}\\psi $$\n我们逐项积分：\n$$ \\int_{0}^{2\\pi} az \\cos \\psi \\,\\mathrm{d}\\psi = az [\\sin \\psi]_{0}^{2\\pi} = az(0-0) = 0 $$\n$$ \\int_{0}^{2\\pi} az \\sin \\psi \\,\\mathrm{d}\\psi = az [-\\cos \\psi]_{0}^{2\\pi} = az(-1 - (-1)) = 0 $$\n$$ \\int_{0}^{2\\pi} a^{2} \\,\\mathrm{d}\\psi = a^{2} [\\psi]_{0}^{2\\pi} = 2\\pi a^{2} $$\n$\\hat{\\mathbf{x}}$ 和 $\\hat{\\mathbf{y}}$ 分量的积分为零，这通过显式计算证实了从圆柱对称性得出的预期，即轴上的磁场必须沿轴向。\n唯一非零的分量是 $\\hat{\\mathbf{z}}$ 方向。代入积分结果：\n$$ \\mathbf{B}(0,0,z) = \\frac{\\mu_{0}I}{4\\pi(a^{2} + z^{2})^{3/2}} (2\\pi a^{2} \\hat{\\mathbf{z}}) $$\n$$ \\mathbf{B}(0,0,z) = \\frac{\\mu_{0}I a^{2}}{2(a^{2} + z^{2})^{3/2}} \\hat{\\mathbf{z}} $$\n问题要求的是轴向磁场分量 $B_{z}(z)$，即单位矢量 $\\hat{\\mathbf{z}}$ 的标量系数：\n$$ B_{z}(z) = \\frac{\\mu_{0} I a^{2}}{2(a^{2} + z^{2})^{3/2}} $$\n这就是圆形电流环路对称轴上轴向磁场分量的最终解析表达式。结果以国际单位制 (SI) 给出，因此所得场强单位为特斯拉 (T)。",
            "answer": "$$\\boxed{\\frac{\\mu_{0} I a^{2}}{2(a^{2} + z^{2})^{3/2}}}$$"
        },
        {
            "introduction": "理想化的无限细导线模型是分析的起点，但现实中的线圈具有有限的半径，这对其自身能量储存和电路行为至关重要。计算线圈的自感是电路建模和能量分析的核心，但直接应用诺伊曼公式于单个线圈会导致数学上的奇异性。这项实践旨在揭示这种奇异性的物理根源，并展示如何通过考虑导线的有限半径来解决这个问题，从而得到一个有限且物理意义明确的自感值。",
            "id": "3970928",
            "problem": "一个由半径为 $a$（$a \\ll R$）的圆形导线制成的单匝圆形极向场线圈，其半径为 $R$，在真空中用于在环形聚变装置中产生磁场。设电流是稳恒的，并在导线横截面上均匀分布。自感 $L$ 由磁能关系式 $W = \\frac{1}{2} L I^{2}$ 定义，其中 $I$ 是电流，外部磁能可以通过细丝电流的矢量势表示为沿线圈中心线的线积分。从毕奥-萨伐尔定律和磁能的定义出发，两个不相交的细丝回路的互感可以用诺伊曼双重积分表示：\n$$\nM = \\frac{\\mu_{0}}{4\\pi} \\int_{\\mathcal{C}_{1}} \\int_{\\mathcal{C}_{2}} \\frac{\\mathrm{d}\\boldsymbol{\\ell} \\cdot \\mathrm{d}\\boldsymbol{\\ell}'}{|\\boldsymbol{r} - \\boldsymbol{r}'|},\n$$\n其中 $\\mu_{0}$ 是自由空间磁导率，$\\boldsymbol{r}$ 和 $\\boldsymbol{r}'$ 是细丝上的位置，$\\mathrm{d}\\boldsymbol{\\ell}$ 和 $\\mathrm{d}\\boldsymbol{\\ell}'$ 是切向线元。对于单个回路，当 $\\mathcal{C}_{1}=\\mathcal{C}_{2}$ 时，同样的积分在 $\\boldsymbol{r} \\to \\boldsymbol{r}'$ 时表现出奇异性。在计算聚变科学与工程中，这种奇异性通过柯西主值 (PV) 处理，而有限导线半径 $a$ 的效应作为修正项引入，使得自感变为有限值。\n\n仅使用基本定律和核心定义，完成以下任务：\n\n1. 通过分析光滑细丝在 $\\boldsymbol{r} \\to \\boldsymbol{r}'$ 附近被积函数的局部行为，证明用于自感的诺伊曼双重积分的柯西主值处理方法的合理性，并从物理上解释为何发散的贡献与导线横截面内部的近场相关，且必须用有限半径修正来代替。\n\n2. 对于半径为 $R$ 的圆形线圈，在 $a \\ll R$ 的情况下，计算有限半径修正的主导项，并推导出一个外部自感的闭式表达式，其阶数为 $\\mathcal{O}((a/R)^{0})$，用 $\\mu_{0}$、$R$ 和 $a$ 表示。\n\n将最终的电感用亨利（国际单位制 SI）表示。提供一个单一的闭式解析表达式。不需要进行数值取整。",
            "solution": "该问题是有效的，因为它在经典电磁学中有科学依据，问题提法适定，具有清晰的物理设置和目标，并包含足够的信息以进行严格的推导。它代表了静磁学中一个标准的、非平凡的问题。\n\n按照要求，该问题分两部分解决：首先，证明数学处理方法的合理性及其物理解释；其次，详细推导指定线圈的外部自感。\n\n### 第1部分：柯西主值和有限半径修正的合理性证明\n\n单个细丝回路 $\\mathcal{C}$ 的自感 $L$ 由诺伊曼公式给出：\n$$\nL = \\frac{\\mu_{0}}{4\\pi} \\oint_{\\mathcal{C}} \\oint_{\\mathcal{C}} \\frac{\\mathrm{d}\\boldsymbol{\\ell} \\cdot \\mathrm{d}\\boldsymbol{\\ell}'}{|\\boldsymbol{r} - \\boldsymbol{r}'|}\n$$\n其中 $\\boldsymbol{r}$ 和 $\\boldsymbol{r}'$ 是指向细丝 $\\mathcal{C}$ 上点的位矢，$\\mathrm{d}\\boldsymbol{\\ell}$ 和 $\\mathrm{d}\\boldsymbol{\\ell}'$ 是这些点处的矢量线元。该积分是奇异的，因为当曲线上的两点重合时，分母 $|\\boldsymbol{r} - \\boldsymbol{r}'|$ 趋于零。\n\n为了分析被积函数的局部行为，设曲线由弧长 $s$ 参数化。设 $\\boldsymbol{r} = \\boldsymbol{r}(s)$ 和 $\\boldsymbol{r}' = \\boldsymbol{r}(s')$。切矢量为 $\\mathrm{d}\\boldsymbol{\\ell} = \\boldsymbol{t}(s)\\mathrm{d}s$ 和 $\\mathrm{d}\\boldsymbol{\\ell}'=\\boldsymbol{t}(s')\\mathrm{d}s'$。我们考察 $s' \\to s$ 时的行为。设 $s' = s + \\epsilon$，其中 $\\epsilon$ 是一个小位移。\n\n我们对 $\\boldsymbol{r}(s')$ 和 $\\boldsymbol{t}(s')$ 在 $s$ 附近进行泰勒展开：\n$$\n\\boldsymbol{r}(s') \\approx \\boldsymbol{r}(s) + \\boldsymbol{t}(s)\\epsilon + \\frac{1}{2}\\boldsymbol{t}'(s)\\epsilon^2 + \\dots\n$$\n$$\n\\boldsymbol{t}(s') \\approx \\boldsymbol{t}(s) + \\boldsymbol{t}'(s)\\epsilon + \\dots\n$$\n其中 $\\boldsymbol{t}(s) = \\frac{\\mathrm{d}\\boldsymbol{r}}{\\mathrm{d}s}$ 是单位切矢量，$\\boldsymbol{t}'(s) = \\frac{\\mathrm{d}\\boldsymbol{t}}{\\mathrm{d}s} = \\kappa(s)\\boldsymbol{n}(s)$，$\\kappa(s)$ 是局部曲率，$\\boldsymbol{n}(s)$ 是主法矢量。\n\n被积函数的分子变为：\n$$\n\\mathrm{d}\\boldsymbol{\\ell} \\cdot \\mathrm{d}\\boldsymbol{\\ell}' = \\boldsymbol{t}(s) \\cdot \\boldsymbol{t}(s') \\mathrm{d}s \\mathrm{d}s' \\approx \\boldsymbol{t}(s) \\cdot (\\boldsymbol{t}(s) + \\boldsymbol{t}'(s)\\epsilon) \\mathrm{d}s \\mathrm{d}s' = (|\\boldsymbol{t}(s)|^2 + \\epsilon (\\boldsymbol{t}(s) \\cdot \\boldsymbol{t}'(s))) \\mathrm{d}s \\mathrm{d}s'\n$$\n由于 $|\\boldsymbol{t}(s)|^2 = 1$，它对 $s$ 的导数为零：$\\frac{\\mathrm{d}}{\\mathrm{d}s}(\\boldsymbol{t} \\cdot \\boldsymbol{t}) = 2\\boldsymbol{t} \\cdot \\boldsymbol{t}' = 0$。因此，分子在 $\\epsilon$ 的一阶近似下就是 $\\mathrm{d}s \\mathrm{d}s'$。\n\n分母变为：\n$$\n|\\boldsymbol{r}(s') - \\boldsymbol{r}(s)| \\approx |\\boldsymbol{t}(s)\\epsilon + \\frac{1}{2}\\boldsymbol{t}'(s)\\epsilon^2| = |\\epsilon \\boldsymbol{t}(s) + \\frac{1}{2}\\epsilon^2 \\kappa(s) \\boldsymbol{n}(s)| = \\sqrt{\\epsilon^2 + \\frac{1}{4}\\epsilon^4 \\kappa(s)^2} \\approx |\\epsilon|\n$$\n因此，当 $s' \\to s$ 时，被积函数的行为如同 $\\frac{1}{|\\epsilon|} = \\frac{1}{|s-s'|}$。这是一个不可积的奇异点。然而，可以通过柯西主值（Cauchy Principal Value）方法来处理这种发散积分，从而得到一个有限的数学结果。\n\n从物理上讲，细丝模型是一种不符合物理实际的理想化。真实的导体具有有限的横截面半径 $a$。积分的发散是假设电流元可以无限靠近的人为结果，这对应于无限大的能量密度。系统的磁能是能量密度 $\\frac{B^2}{2\\mu_0}$ 在整个空间上的体积积分。这可以分为储存在导体内部的能量 $W_{\\text{int}}$ 和外部的能量 $W_{\\text{ext}}$。总自感为 $L = L_{\\text{int}} + L_{\\text{ext}}$。细丝的诺伊曼公式旨在计算由电流源外部的磁通量产生的外部电感 $L_{\\text{ext}}$。奇异性的出现是因为该公式不正确地处理了近场贡献，而这恰恰是区分导线内外至关重要的区域。细丝模型的发散贡献是对导线内部及紧邻导线区域的场的能量的一种不符合物理实际的表示。用有限半径修正替换这个发散部分是物理上的正则化方法。这种修正有效地将来自一小段奇异细丝的贡献替换为来自一小段但有厚度的导线的实际、有限的贡献，后者取决于导线半径 $a$ 及其内部的电流分布。这个过程正确地计算出有限的外部自感。\n\n### 第2部分：外部自感的推导\n\n我们希望推导一个由次半径为 $a$ 的导线制成、主半径为 $R$ 的圆形线圈的外部自感，其中 $a \\ll R$。我们使用基于磁通量 $\\Phi$ 的电感表达式 $L = \\Phi/I$。磁通量通过斯托克斯定理从矢量势 $\\boldsymbol{A}$ 计算得出：$\\Phi = \\oint_{\\mathcal{C}} \\boldsymbol{A} \\cdot \\mathrm{d}\\boldsymbol{\\ell}$。\n$$\nL = \\frac{1}{I} \\oint_{\\mathcal{C}} \\boldsymbol{A} \\cdot \\mathrm{d}\\boldsymbol{\\ell}\n$$\n为了正确考虑有限的导线半径并获得外部自感，对于细导线（$a \\ll R$），积分可以沿导线的中心线（$\\mathcal{C}$）进行，但矢量势 $\\boldsymbol{A}$ 必须在导线表面上计算。这是一个标准的近似方法，能够正确地捕捉主导阶的行为。\n\n设圆形线圈位于 $x$-$y$ 平面，以原点为中心。我们用角度 $\\phi'$ 参数化中心线：$\\boldsymbol{r}' = (R\\cos\\phi', R\\sin\\phi', 0)$。线元为 $\\mathrm{d}\\boldsymbol{\\ell}' = R(-\\sin\\phi', \\cos\\phi', 0)\\mathrm{d}\\phi'$。在场点 $\\boldsymbol{r}$ 处的矢量势 $\\boldsymbol{A}$ 为：\n$$\n\\boldsymbol{A}(\\boldsymbol{r}) = \\frac{\\mu_0 I}{4\\pi} \\oint_{\\mathcal{C}} \\frac{\\mathrm{d}\\boldsymbol{\\ell}'}{|\\boldsymbol{r} - \\boldsymbol{r}'|}\n$$\n我们在导线表面的一个点上计算 $\\boldsymbol{A}$，例如 $\\boldsymbol{r} = (R-a, 0, 0)$。根据对称性，该点的矢量势将纯粹沿 $y$ 轴（$\\phi$ 方向）方向。我们计算它的 $y$ 分量：\n$$\nA_y = \\frac{\\mu_0 I}{4\\pi} \\int_0^{2\\pi} \\frac{R\\cos\\phi'}{|\\boldsymbol{r} - \\boldsymbol{r}'|} \\mathrm{d}\\phi'\n$$\n距离项为：\n$$\n|\\boldsymbol{r} - \\boldsymbol{r}'|^2 = ((R-a) - R\\cos\\phi')^2 + (0 - R\\sin\\phi')^2 = (R-a)^2 - 2R(R-a)\\cos\\phi' + R^2\\cos^2\\phi' + R^2\\sin^2\\phi'\n$$\n$$\n|\\boldsymbol{r} - \\boldsymbol{r}'|^2 = R^2 - 2Ra + a^2 - 2(R^2-Ra)\\cos\\phi' + R^2 = 2R^2 - 2Ra + a^2 - (2R^2-2Ra)(1 - 2\\sin^2(\\phi'/2))\n$$\n$$\n|\\boldsymbol{r} - \\boldsymbol{r}'|^2 = a^2 + (4R^2 - 4Ra)\\sin^2(\\phi'/2) \\approx a^2 + 4R^2\\sin^2(\\phi'/2)\n$$\n其中我们利用 $a \\ll R$ 忽略了 $4Ra$ 项。电感为 $L = \\frac{2\\pi R A_y}{I}$。\n$$\nL = \\frac{2\\pi R}{I} \\left(\\frac{\\mu_0 I}{4\\pi} \\int_0^{2\\pi} \\frac{R\\cos\\phi'}{\\sqrt{a^2 + 4R^2\\sin^2(\\phi'/2)}} \\mathrm{d}\\phi' \\right) = \\frac{\\mu_0 R^2}{2} \\int_0^{2\\pi} \\frac{\\cos\\phi'}{\\sqrt{a^2 + 4R^2\\sin^2(\\phi'/2)}} \\mathrm{d}\\phi'\n$$\n由于被积函数满足 $f(2\\pi - \\phi') = f(\\phi')$，积分可以写为 $2 \\int_0^{\\pi} f(\\phi') \\mathrm{d}\\phi'$。\n$$\nL = \\mu_0 R^2 \\int_0^{\\pi} \\frac{\\cos\\phi'}{\\sqrt{a^2 + 4R^2\\sin^2(\\phi'/2)}} \\mathrm{d}\\phi'\n$$\n我们在一个小角度 $\\epsilon$ 处将积分分开，使得 $a/R \\ll \\epsilon \\ll 1$。\n$$\nL = \\mu_0 R^2 \\left( \\int_0^{\\epsilon} \\frac{\\cos\\phi'}{\\sqrt{a^2 + 4R^2\\sin^2(\\phi'/2)}} \\mathrm{d}\\phi' + \\int_{\\epsilon}^{\\pi} \\frac{\\cos\\phi'}{\\sqrt{a^2 + 4R^2\\sin^2(\\phi'/2)}} \\mathrm{d}\\phi' \\right)\n$$\n对于第一个积分（小 $\\phi'$），我们近似 $\\cos\\phi' \\approx 1$ 和 $\\sin(\\phi'/2) \\approx \\phi'/2$：\n$$\nI_1 = \\int_0^{\\epsilon} \\frac{\\mathrm{d}\\phi'}{\\sqrt{a^2 + R^2\\phi'^2}} = \\left[ \\frac{1}{R}\\ln(R\\phi' + \\sqrt{a^2+R^2\\phi'^2}) \\right]_0^{\\epsilon} = \\frac{1}{R} \\left( \\ln(R\\epsilon + \\sqrt{a^2+R^2\\epsilon^2}) - \\ln(a) \\right)\n$$\n由于 $\\epsilon \\gg a/R$，$R\\epsilon \\gg a$，所以 $\\sqrt{a^2+R^2\\epsilon^2} \\approx R\\epsilon$。\n$$\nI_1 \\approx \\frac{1}{R} (\\ln(2R\\epsilon) - \\ln(a)) = \\frac{1}{R}\\ln\\left(\\frac{2R\\epsilon}{a}\\right)\n$$\n对于第二个积分，$\\phi' \\geq \\epsilon \\gg a/R$，所以 $2R\\sin(\\phi'/2) \\gg a$。我们可以忽略 $a^2$：\n$$\nI_2 = \\int_{\\epsilon}^{\\pi} \\frac{\\cos\\phi'}{2R\\sin(\\phi'/2)} \\mathrm{d}\\phi' = \\frac{1}{2R} \\int_{\\epsilon}^{\\pi} \\frac{1-2\\sin^2(\\phi'/2)}{\\sin(\\phi'/2)} \\mathrm{d}\\phi' = \\frac{1}{2R} \\left( \\int_{\\epsilon}^{\\pi} \\frac{\\mathrm{d}\\phi'}{\\sin(\\phi'/2)} - \\int_{\\epsilon}^{\\pi} 2\\sin(\\phi'/2) \\mathrm{d}\\phi' \\right)\n$$\n第一项是 $\\int_{\\epsilon}^{\\pi} \\frac{\\mathrm{d}\\phi'}{\\sin(\\phi'/2)} = [2\\ln(\\tan(\\phi'/4))]_{\\epsilon}^{\\pi} = 2\\ln(\\tan(\\pi/4)) - 2\\ln(\\tan(\\epsilon/4)) \\approx -2\\ln(\\epsilon/4) = 2\\ln(4/\\epsilon)$。\n第二项是 $\\int_{\\epsilon}^{\\pi} -2\\sin(\\phi'/2) \\mathrm{d}\\phi' = [4\\cos(\\phi'/2)]_{\\epsilon}^{\\pi} = 4\\cos(\\pi/2) - 4\\cos(\\epsilon/2) \\approx -4(1) = -4$。\n所以，$I_2 \\approx \\frac{1}{2R} (2\\ln(4/\\epsilon) - 4) = \\frac{1}{R}(\\ln(4/\\epsilon) - 2)$。\n\n结合各部分，我们得到：\n$$\nL = \\mu_0 R^2 (I_1 + I_2) \\approx \\mu_0 R^2 \\left( \\frac{1}{R}\\ln\\left(\\frac{2R\\epsilon}{a}\\right) + \\frac{1}{R}(\\ln(4/\\epsilon) - 2) \\right)\n$$\n$$\nL = \\mu_0 R \\left( \\ln\\left(\\frac{2R\\epsilon}{a}\\right) + \\ln\\left(\\frac{4}{\\epsilon}\\right) - 2 \\right) = \\mu_0 R \\left( \\ln\\left(\\frac{2R\\epsilon}{a} \\cdot \\frac{4}{\\epsilon}\\right) - 2 \\right)\n$$\n$$\nL = \\mu_0 R \\left( \\ln\\left(\\frac{8R}{a}\\right) - 2 \\right)\n$$\n这个表达式代表了圆形线圈在指定阶数下的外部自感。",
            "answer": "$$\n\\boxed{\\mu_{0} R \\left( \\ln\\left(\\frac{8R}{a}\\right) - 2 \\right)}\n$$"
        },
        {
            "introduction": "对于聚变装置中常见的复杂三维线圈几何，解析计算往往不再可行，我们必须依赖于数值方法，如边界元法 (BEM)。在BEM中，线圈表面被离散为许多小的单元（通常是三角形）。这项实践将探讨BEM中的一个核心计算难题：如何处理奇异积分，以精确计算一个三角形单元对其自身产生的势场贡献。通过运用矢量微积分，我们将推导出一个解析解，这个“自元素”积分的精确处理对于保证整个数值模拟的准确性和稳定性至关重要。",
            "id": "3970968",
            "problem": "在计算聚变科学与工程中，线圈系统的高保真度电磁场计算经常在三角化的线圈表面上使用边界元法（BEM）。考虑在无电流区域中由势表示产生的静磁单层核。设单个平坦的三角面板 $T$ 位于一个平面内，其顶点 $\\mathbf{v}_{1}$、$\\mathbf{v}_{2}$ 和 $\\mathbf{v}_{3}$ 按逆时针顺序排列，并设 $\\mathbf{r}$ 是一个严格位于 $T$ 内部且在同一平面内的点。定义积分\n$$\nI_{T}(\\mathbf{r}) \\equiv \\int_{T} \\frac{1}{|\\mathbf{r}-\\mathbf{r}'|} \\, dS' .\n$$\n对于每条边 $e \\in \\{1,2,3\\}$（其端点为 $(\\mathbf{v}_{e},\\mathbf{v}_{e+1})$，且 $\\mathbf{v}_{4} \\equiv \\mathbf{v}_{1}$），引入单位切向量\n$$\n\\hat{\\mathbf{t}}_{e} \\equiv \\frac{\\mathbf{v}_{e+1}-\\mathbf{v}_{e}}{\\|\\mathbf{v}_{e+1}-\\mathbf{v}_{e}\\|} ,\n$$\n以及平面内的向外单位法向量 $\\hat{\\mathbf{n}}_{e}$，其选择需满足\n$$\n\\hat{\\mathbf{n}}_{e} \\cdot \\hat{\\mathbf{t}}_{e} = 0\n\\quad \\text{且} \\quad\n\\hat{\\mathbf{n}}_{e} \\text{ 从 } T \\text{ 跨过边 } (\\mathbf{v}_{e},\\mathbf{v}_{e+1}) \\text{ 指向外部 } .\n$$\n设从点 $\\mathbf{r}$ 到边 $e$ 支撑线的垂足，沿切线方向到各端点的有向距离为\n$$\ns_{e1} \\equiv (\\mathbf{v}_{e}-\\mathbf{r})\\cdot \\hat{\\mathbf{t}}_{e},\n\\qquad\ns_{e2} \\equiv (\\mathbf{v}_{e+1}-\\mathbf{r})\\cdot \\hat{\\mathbf{t}}_{e},\n$$\n并设从 $\\mathbf{r}$ 到该边支撑线的有向垂直距离为\n$$\nd_{e} \\equiv (\\mathbf{v}_{e}-\\mathbf{r})\\cdot \\hat{\\mathbf{n}}_{e},\n$$\n根据上述向外法线的约定，对于严格位于 $T$ 内部的 $\\mathbf{r}$，该距离为正。\n\n从无电流区域的静磁势表示和基本矢量微积分出发，推导 $I_{T}(\\mathbf{r})$ 关于 $e \\in \\{1,2,3\\}$ 的 $\\{s_{e1}, s_{e2}, d_{e}\\}$ 的解析闭式表达式，并明确证明尽管核 $|\\mathbf{r}-\\mathbf{r}'|^{-1}$ 在 $\\mathbf{r}'=\\mathbf{r}$ 处看似奇异，但 $I_{T}(\\mathbf{r})$ 是有限的。你的最终答案必须是 $I_{T}(\\mathbf{r})$ 的单个闭式解析表达式。最终表达式中不应包含单位。",
            "solution": "所述问题具有科学依据、是适定的、客观且内部一致的。它提出了势论中的一个标准的、非平凡的计算，这是计算电磁学中边界元法的核心。所有必要的数据和定义都已提供。因此，该问题是有效的，并且可以推导出解。\n\n该问题要求计算积分\n$$\nI_{T}(\\mathbf{r}) = \\int_{T} \\frac{1}{|\\mathbf{r}-\\mathbf{r}'|} \\, dS'\n$$\n其中 $T$ 是一个平面三角形，求值点 $\\mathbf{r}$ 严格位于 $T$ 内部且在同一平面内。核 $|\\mathbf{r}-\\mathbf{r}'|^{-1}$ 在 $\\mathbf{r}'=\\mathbf{r}$ 处是奇异的，但该奇点是弱奇点（可积的），本推导将正式证明这一事实。\n\n核心策略是应用二维散度定理（格林定理的一个特例），将三角形 $T$ 上的面积分转换为其三条边上的线积分之和。设所有矢量和微分算子都在三角形所在的平面内进行考虑。我们寻找一个矢量场 $\\mathbf{F}(\\mathbf{r}')$，使其散度 $\\nabla' \\cdot \\mathbf{F}(\\mathbf{r}')$ 等于被积函数。考虑矢量场\n$$\n\\mathbf{F}(\\mathbf{r}') = \\frac{\\mathbf{r}'-\\mathbf{r}}{|\\mathbf{r}'-\\mathbf{r}|}\n$$\n这是一个从 $\\mathbf{r}$ 点径向向外指出的单位矢量场。对于 $\\mathbf{r}' \\neq \\mathbf{r}$，其在二维平面内的散度由下式给出\n$$\n\\nabla' \\cdot \\mathbf{F}(\\mathbf{r}') = \\nabla' \\cdot \\left(\\frac{\\mathbf{r}'-\\mathbf{r}}{|\\mathbf{r}'-\\mathbf{r}|}\\right) = \\frac{1}{|\\mathbf{r}'-\\mathbf{r}|}\n$$\n因此，该积分可以表示为 $I_{T}(\\mathbf{r}) = \\int_{T} (\\nabla' \\cdot \\mathbf{F}) \\, dS'$。\n\n由于场 $\\mathbf{F}(\\mathbf{r}')$ 及其散度在 $\\mathbf{r}' = \\mathbf{r}$ 处是奇异的，我们不能直接对整个三角形 $T$ 应用散度定理。我们通过从积分域中切除一个以 $\\mathbf{r}$ 为中心、半径为 $\\epsilon$ 的无穷小圆盘 $D_{\\epsilon}$ 来处理这个问题。令 $T_{\\epsilon} = T \\setminus D_{\\epsilon}$。在这个非奇异域 $T_{\\epsilon}$ 上，散度定理成立：\n$$\n\\int_{T_{\\epsilon}} (\\nabla' \\cdot \\mathbf{F}) \\, dS' = \\oint_{\\partial T_{\\epsilon}} \\mathbf{F} \\cdot \\hat{\\mathbf{n}}' \\, dl'\n$$\n修改后域的边界 $\\partial T_{\\epsilon}$ 由三角形的边界 $\\partial T$ 和圆盘的边界 $\\partial D_{\\epsilon}$ 组成。对于 $T_{\\epsilon}$，其向外单位法向量 $\\hat{\\mathbf{n}}'$ 沿 $\\partial T$ 从三角形向外指出，并沿 $\\partial D_{\\epsilon}$ 朝向中心 $\\mathbf{r}$ 指向内部。\n\n边界积分分为两部分：\n$$\n\\oint_{\\partial T_{\\epsilon}} \\mathbf{F} \\cdot \\hat{\\mathbf{n}}' \\, dl' = \\oint_{\\partial T} \\mathbf{F} \\cdot \\hat{\\mathbf{n}}' \\, dl' + \\oint_{\\partial D_{\\epsilon}} \\mathbf{F} \\cdot \\hat{\\mathbf{n}}' \\, dl'\n$$\n我们来计算圆形边界 $\\partial D_{\\epsilon}$ 上的积分。在这个圆上，有 $|\\mathbf{r}'-\\mathbf{r}| = \\epsilon$。矢量场为 $\\mathbf{F}(\\mathbf{r}') = (\\mathbf{r}'-\\mathbf{r})/\\epsilon$。从 $T_{\\epsilon}$ 指出的单位法向量为 $\\hat{\\mathbf{n}}' = -(\\mathbf{r}'-\\mathbf{r})/\\epsilon$。被积函数中的点积为\n$$\n\\mathbf{F} \\cdot \\hat{\\mathbf{n}}' = \\left(\\frac{\\mathbf{r}'-\\mathbf{r}}{\\epsilon}\\right) \\cdot \\left(-\\frac{\\mathbf{r}'-\\mathbf{r}}{\\epsilon}\\right) = -\\frac{|\\mathbf{r}'-\\mathbf{r}|^2}{\\epsilon^2} = -\\frac{\\epsilon^2}{\\epsilon^2} = -1\n$$\n因此，$\\partial D_{\\epsilon}$ 上的积分是 $\\oint_{\\partial D_{\\epsilon}} (-1) \\, dl' = -(2\\pi\\epsilon)$，即周长的负值。\n\n通过取极限 $\\epsilon \\to 0$，可以恢复积分 $I_T(\\mathbf{r})$：\n$$\nI_T(\\mathbf{r}) = \\lim_{\\epsilon \\to 0} \\int_{T_{\\epsilon}} \\frac{1}{|\\mathbf{r}-\\mathbf{r}'|} \\, dS' = \\lim_{\\epsilon \\to 0} \\left( \\oint_{\\partial T} \\mathbf{F} \\cdot \\hat{\\mathbf{n}}' \\, dl' - 2\\pi\\epsilon \\right) = \\oint_{\\partial T} \\mathbf{F} \\cdot \\hat{\\mathbf{n}}' \\, dl'\n$$\n来自奇点的贡献在极限情况下消失，这明确证明了原始积分 $I_T(\\mathbf{r})$ 是有限的。\n\n剩下的任务是计算三角形边界 $\\partial T$ 上的线积分。该边界由三条边组成，用 $e \\in \\{1,2,3\\}$ 索引。\n$$\nI_T(\\mathbf{r}) = \\sum_{e=1}^{3} \\int_{e} \\frac{\\mathbf{r}'-\\mathbf{r}}{|\\mathbf{r}'-\\mathbf{r}|} \\cdot \\hat{\\mathbf{n}}_{e} \\, dl'\n$$\n其中 $\\hat{\\mathbf{n}}_{e}$ 是问题中定义的边 $e$ 的向外单位法向量。\n\n我们来计算单条一般边 $e$ 的积分，该边从顶点 $\\mathbf{v}_{e}$ 延伸到 $\\mathbf{v}_{e+1}$。对于包含该边的直线上的任意点 $\\mathbf{r}'$，矢量 $\\mathbf{r}'-\\mathbf{r}$ 可以在与该边相关联的标准正交基 $\\{\\hat{\\mathbf{t}}_{e}, \\hat{\\mathbf{n}}_{e}\\}$ 中分解。设 $s$ 是沿切线方向 $\\hat{\\mathbf{t}}_e$ 的坐标，从 $\\mathbf{r}$ 到该直线的垂足开始测量。设 $d_e$ 是从 $\\mathbf{r}$ 到该直线的垂直距离。那么，对于直线上的一点 $\\mathbf{r}'$，我们有：\n$$\n\\mathbf{r}' - \\mathbf{r} = s \\, \\hat{\\mathbf{t}}_{e} + d_{e} \\, \\hat{\\mathbf{n}}_{e}\n$$\n被积函数的分子项为 $(\\mathbf{r}'-\\mathbf{r}) \\cdot \\hat{\\mathbf{n}}_{e} = (s \\, \\hat{\\mathbf{t}}_{e} + d_{e} \\, \\hat{\\mathbf{n}}_{e}) \\cdot \\hat{\\mathbf{n}}_{e} = d_e$，它沿该直线为常数。分母项为 $|\\mathbf{r}'-\\mathbf{r}| = \\sqrt{s^2 + d_e^2}$。无穷小线元为 $dl' = ds$。\n\n$s$ 的积分限对应于边段的端点 $\\mathbf{v}_e$ 和 $\\mathbf{v}_{e+1}$。这些正是问题中定义的有向距离 $s_{e1}$ 和 $s_{e2}$：\n$s_{e1} = (\\mathbf{v}_{e}-\\mathbf{r})\\cdot \\hat{\\mathbf{t}}_{e}$\n$s_{e2} = (\\mathbf{v}_{e+1}-\\mathbf{r})\\cdot \\hat{\\mathbf{t}}_{e}$\n这些表示顶点 $\\mathbf{v}_e$ 和 $\\mathbf{v}_{e+1}$ 沿切线方向 $\\hat{\\mathbf{t}}_e$ 的坐标，相对于从 $\\mathbf{r}$ 所作垂线的垂足。\n\n边 $e$ 的积分变为：\n$$\n\\int_{\\mathbf{v}_e}^{\\mathbf{v}_{e+1}} \\frac{d_e}{|\\mathbf{r}'-\\mathbf{r}|} \\, dl' = \\int_{s_{e1}}^{s_{e2}} \\frac{d_e}{\\sqrt{s^2+d_e^2}} \\, ds\n$$\n问题指出 $\\mathbf{r}$ 严格位于内部，因此 $d_e  0$。这是一个标准积分：\n$$\n\\int \\frac{1}{\\sqrt{s^2+a^2}} \\, ds = \\ln(s + \\sqrt{s^2+a^2}) + C\n$$\n使用对数形式，我们计算该定积分：\n$$\nd_e \\left[ \\ln(s + \\sqrt{s^2+d_e^2}) \\right]_{s_{e1}}^{s_{e2}} = d_e \\left( \\ln(s_{e2} + \\sqrt{s_{e2}^2+d_e^2}) - \\ln(s_{e1} + \\sqrt{s_{e1}^2+d_e^2}) \\right)\n$$\n这可以简洁地写成：\n$$\nd_{e} \\ln\\left( \\frac{s_{e2} + \\sqrt{s_{e2}^{2} + d_{e}^{2}}}{s_{e1} + \\sqrt{s_{e1}^{2} + d_{e}^{2}}} \\right)\n$$\n总积分 $I_T(\\mathbf{r})$ 是这些表达式在三角形三条边上的和：\n$$\nI_{T}(\\mathbf{r}) = \\sum_{e=1}^{3} d_{e} \\ln\\left( \\frac{s_{e2} + \\sqrt{s_{e2}^{2} + d_{e}^{2}}}{s_{e1} + \\sqrt{s_{e1}^{2} + d_{e}^{2}}} \\right)\n$$\n我们还可以认识到 $\\sqrt{s_{e1}^2 + d_e^2} = |\\mathbf{v}_e - \\mathbf{r}|$ 和 $\\sqrt{s_{e2}^2 + d_e^2} = |\\mathbf{v}_{e+1} - \\mathbf{r}|$。由于 $\\mathbf{r}$ 与任何边都不共线，对数的参数为正。该表达式是良定义的且是有限的，符合要求。",
            "answer": "$$ \\boxed{\\sum_{e=1}^{3} d_{e} \\ln\\left( \\frac{s_{e2} + \\sqrt{s_{e2}^{2} + d_{e}^{2}}}{s_{e1} + \\sqrt{s_{e1}^{2} + d_{e}^{2}}} \\right)} $$"
        }
    ]
}