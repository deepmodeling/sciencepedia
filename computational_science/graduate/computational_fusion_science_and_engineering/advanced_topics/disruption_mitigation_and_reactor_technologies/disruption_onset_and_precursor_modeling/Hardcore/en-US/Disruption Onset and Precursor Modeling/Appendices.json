{
    "hands_on_practices": [
        {
            "introduction": "Understanding the onset of disruptions often begins with analyzing the stability of the plasma equilibrium. The tearing mode, driven by the release of magnetic energy through reconnection, is a primary culprit. This exercise  takes you to the heart of tearing mode theory by having you calculate the classical stability index, $\\Delta'$, for a foundational magnetic field profile, providing direct insight into what makes a plasma configuration prone to this critical instability.",
            "id": "3967937",
            "problem": "Consider a local slab approximation to a rational surface in a tokamak plasma used in disruption precursor modeling. The equilibrium magnetic field is taken to be $\\mathbf{B}_{0}(x) = B_{y}(x)\\,\\hat{\\mathbf{y}}$ with $B_{y}(x) = B_{0}\\,\\tanh(x/L)$, where $L$ is the current-sheet half-width and $B_{0}$ is a constant. A tearing-perturbation of magnetic flux is represented by a flux function $\\psi(x)$ such that the perturbed magnetic field is $\\delta \\mathbf{B} = \\hat{\\mathbf{z}} \\times \\nabla \\psi$, with perturbations varying as $\\exp(i k_{y} y)$ in the ignorable direction $y$.\n\nIn the ideal outer region, the scalar flux function $\\psi(x)$ obeys the well-tested Newcomb equation for slab ideal Magnetohydrodynamics (MHD):\n$$\n\\frac{d^{2}\\psi}{d x^{2}} - k_{y}^{2}\\,\\psi - \\frac{B_{y}''(x)}{B_{y}(x)}\\,\\psi = 0,\n$$\nvalid for $x \\neq 0$. Impose the outer boundary conditions that $\\psi(x)$ decays as $|x| \\to \\infty$ on each side of the current sheet. Define the classical tearing-mode stability parameter\n$$\n\\Delta' \\equiv \\frac{\\psi'(0^{+}) - \\psi'(0^{-})}{\\psi(0)},\n$$\nwhere the prime denotes differentiation with respect to $x$, and adopt the constant-$\\psi$ approximation across the inner resistive layer.\n\nCompute $\\Delta'$ for the given equilibrium profile $B_{y}(x) = B_{0}\\,\\tanh(x/L)$ by solving the outer-region equation separately on $x0$ and $x0$, matching the solutions at $x=0$ as required by the constant-$\\psi$ approximation, and applying the decay conditions at infinity. Express your final result as a closed-form analytic expression in terms of $k_{y}$ and $L$.\n\nThen, using your expression, estimate the sign of $\\Delta'$ and its scaling with $k_{y} L$ in the long-wavelength limit $k_{y} L \\ll 1$, and briefly state the implication for magnetic island growth in resistive tearing onset. No numerical rounding is required; provide the analytic expression for $\\Delta'$ as your final answer.",
            "solution": "The problem statement is evaluated for validity before attempting a solution.\n\n### Step 1: Extract Givens\n- **Equilibrium Magnetic Field:** $\\mathbf{B}_{0}(x) = B_{y}(x)\\,\\hat{\\mathbf{y}}$, where $B_{y}(x) = B_{0}\\,\\tanh(x/L)$.\n- **Constants:** $L$ is the current-sheet half-width; $B_{0}$ is a constant magnetic field amplitude.\n- **Perturbation:** The perturbed magnetic field is $\\delta \\mathbf{B} = \\hat{\\mathbf{z}} \\times \\nabla \\psi$, with perturbations varying as $\\exp(i k_{y} y)$.\n- **Governing Equation:** The flux function $\\psi(x)$ obeys the ideal MHD Newcomb equation in the outer region ($x \\neq 0$):\n$$\n\\frac{d^{2}\\psi}{d x^{2}} - k_{y}^{2}\\,\\psi - \\frac{B_{y}''(x)}{B_{y}(x)}\\,\\psi = 0\n$$\n- **Boundary Conditions:** $\\psi(x) \\to 0$ as $|x| \\to \\infty$.\n- **Approximation:** The constant-$\\psi$ approximation is used, implying $\\psi(x)$ is continuous across the inner layer at $x=0$.\n- **Definition:** The tearing-mode stability parameter is defined as:\n$$\n\\Delta' \\equiv \\frac{\\psi'(0^{+}) - \\psi'(0^{-})}{\\psi(0)}\n$$\n- **Objective:** Compute $\\Delta'$ as a function of $k_y$ and $L$, and analyze the long-wavelength limit.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a classic formulation of the tearing mode instability in slab geometry for a Harris sheet equilibrium ($B_y \\propto \\tanh(x/L)$). All elements—the equilibrium, the governing equation (Newcomb's equation in slab form), the constant-$\\psi$ approximation, and the definition of $\\Delta'$—are cornerstones of resistive magnetohydrodynamics and disruption modeling. The problem is scientifically and factually sound.\n- **Well-Posed:** The problem provides a second-order linear ordinary differential equation with well-defined boundary conditions at infinity and a matching condition at the origin. This structure ensures a unique solution up to a normalization constant, which is sufficient as $\\Delta'$ is a normalized quantity. The problem is well-posed.\n- **Objective:** The problem is stated in precise, formal mathematical and physical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. A solution will be derived.\n\nThe first step is to compute the term $\\frac{B_{y}''(x)}{B_{y}(x)}$ for the given equilibrium profile $B_{y}(x) = B_{0}\\,\\tanh(x/L)$. Let $\\xi = x/L$.\nThe first derivative with respect to $x$ is:\n$$\nB_{y}'(x) = \\frac{d}{dx} \\left( B_{0} \\tanh\\left(\\frac{x}{L}\\right) \\right) = \\frac{B_{0}}{L} \\text{sech}^{2}\\left(\\frac{x}{L}\\right)\n$$\nThe second derivative is:\n$$\nB_{y}''(x) = \\frac{d}{dx} \\left( \\frac{B_{0}}{L} \\text{sech}^{2}\\left(\\frac{x}{L}\\right) \\right) = \\frac{B_{0}}{L} \\left( 2\\,\\text{sech}\\left(\\frac{x}{L}\\right) \\cdot \\left(-\\text{sech}\\left(\\frac{x}{L}\\right)\\tanh\\left(\\frac{x}{L}\\right)\\right) \\cdot \\frac{1}{L} \\right) = -\\frac{2B_{0}}{L^{2}} \\text{sech}^{2}\\left(\\frac{x}{L}\\right) \\tanh\\left(\\frac{x}{L}\\right)\n$$\nThe ratio is then:\n$$\n\\frac{B_{y}''(x)}{B_{y}(x)} = \\frac{-\\frac{2B_{0}}{L^{2}} \\text{sech}^{2}\\left(\\frac{x}{L}\\right) \\tanh\\left(\\frac{x}{L}\\right)}{B_{0} \\tanh\\left(\\frac{x}{L}\\right)} = -\\frac{2}{L^{2}} \\text{sech}^{2}\\left(\\frac{x}{L}\\right)\n$$\nThis expression is valid for $x \\neq 0$. Substituting this into the Newcomb equation yields:\n$$\n\\frac{d^{2}\\psi}{d x^{2}} - k_{y}^{2}\\,\\psi - \\left(-\\frac{2}{L^{2}} \\text{sech}^{2}\\left(\\frac{x}{L}\\right)\\right)\\,\\psi = 0\n$$\n$$\n\\frac{d^{2}\\psi}{d x^{2}} - \\left( k_{y}^{2} - \\frac{2}{L^{2}} \\text{sech}^{2}\\left(\\frac{x}{L}\\right) \\right)\\,\\psi = 0\n$$\nThis is a Schrödinger-like equation with a Pöschl-Teller potential. The independent solutions to this equation are known. We need to construct a solution that satisfies the boundary condition $\\psi(x) \\to 0$ as $|x| \\to \\infty$. This requires selecting different linear combinations of the fundamental solutions for the regions $x0$ and $x0$.\n\nThe solution that decays for $x \\to \\infty$ is given by:\n$$\n\\psi_{1}(x) = \\left(\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(-k_{y}x)\n$$\nThe solution that decays for $x \\to -\\infty$ is given by:\n$$\n\\psi_{2}(x) = \\left(-\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(k_{y}x)\n$$\nWe construct the global solution piecewise, with an arbitrary constant $C$:\n$$\n\\psi(x) = \\begin{cases} C \\left(\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(-k_{y}x)  \\text{for } x  0 \\\\ C \\left(-\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(k_{y}x)  \\text{for } x  0 \\end{cases}\n$$\nThe constant-$\\psi$ approximation implies that $\\psi(x)$ is continuous at $x=0$.\nFor $x \\to 0^{+}$, $\\psi(0^{+}) = C (\\tanh(0) + k_{y}L) \\exp(0) = C k_{y}L$.\nFor $x \\to 0^{-}$, $\\psi(0^{-}) = C (-\\tanh(0) + k_{y}L) \\exp(0) = C k_{y}L$.\nThe continuity is satisfied with this choice of solutions. We identify $\\psi(0) = C k_{y}L$, which implies $C = \\frac{\\psi(0)}{k_{y}L}$ for $k_{y}L \\neq 0$.\n\nNext, we calculate the derivatives $\\psi'(0^{+})$ and $\\psi'(0^{-})$.\nFor $x0$:\n$$\n\\psi'(x) = C \\frac{d}{dx} \\left[ \\left(\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(-k_{y}x) \\right]\n$$\n$$\n\\psi'(x) = C \\left[ \\left(\\frac{1}{L}\\text{sech}^{2}\\left(\\frac{x}{L}\\right)\\right)\\exp(-k_{y}x) + \\left(\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right)(-k_{y})\\exp(-k_{y}x) \\right]\n$$\nEvaluating as $x \\to 0^{+}$:\n$$\n\\psi'(0^{+}) = C \\left[ \\frac{1}{L}\\text{sech}^{2}(0) - k_{y}(\\tanh(0) + k_{y}L) \\right] = C \\left( \\frac{1}{L} - k_{y}^{2}L \\right)\n$$\nSubstituting $C=\\frac{\\psi(0)}{k_{y}L}$:\n$$\n\\psi'(0^{+}) = \\frac{\\psi(0)}{k_{y}L} \\left( \\frac{1}{L} - k_{y}^{2}L \\right) = \\psi(0) \\left( \\frac{1}{k_{y}L^{2}} - k_{y} \\right)\n$$\nFor $x0$:\n$$\n\\psi'(x) = C \\frac{d}{dx} \\left[ \\left(-\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right) \\exp(k_{y}x) \\right]\n$$\n$$\n\\psi'(x) = C \\left[ \\left(-\\frac{1}{L}\\text{sech}^{2}\\left(\\frac{x}{L}\\right)\\right)\\exp(k_{y}x) + \\left(-\\tanh\\left(\\frac{x}{L}\\right) + k_{y}L\\right)(k_{y})\\exp(k_{y}x) \\right]\n$$\nEvaluating as $x \\to 0^{-}$:\n$$\n\\psi'(0^{-}) = C \\left[ -\\frac{1}{L}\\text{sech}^{2}(0) + k_{y}(-\\tanh(0) + k_{y}L) \\right] = C \\left( -\\frac{1}{L} + k_{y}^{2}L \\right)\n$$\nSubstituting $C=\\frac{\\psi(0)}{k_{y}L}$:\n$$\n\\psi'(0^{-}) = \\frac{\\psi(0)}{k_{y}L} \\left( -\\frac{1}{L} + k_{y}^{2}L \\right) = \\psi(0) \\left( -\\frac{1}{k_{y}L^{2}} + k_y \\right)\n$$\nNow, we compute $\\Delta'$ using its definition:\n$$\n\\Delta' = \\frac{\\psi'(0^{+}) - \\psi'(0^{-})}{\\psi(0)} = \\frac{\\psi(0) \\left( \\frac{1}{k_{y}L^{2}} - k_{y} \\right) - \\psi(0) \\left( -\\frac{1}{k_{y}L^{2}} + k_y \\right)}{\\psi(0)}\n$$\n$$\n\\Delta' = \\left( \\frac{1}{k_{y}L^{2}} - k_{y} \\right) - \\left( -\\frac{1}{k_{y}L^{2}} + k_y \\right) = \\frac{1}{k_{y}L^{2}} - k_{y} + \\frac{1}{k_{y}L^{2}} - k_y\n$$\n$$\n\\Delta' = \\frac{2}{k_{y}L^{2}} - 2k_{y}\n$$\nThis is the closed-form analytic expression for $\\Delta'$.\n\nFor the analysis in the long-wavelength limit, we consider $k_{y}L \\ll 1$. Let $\\alpha = k_{y}L$. Then the expression can be written as $\\Delta' = \\frac{2}{L\\alpha} - \\frac{2\\alpha}{L} = \\frac{2}{L}\\left(\\frac{1}{\\alpha} - \\alpha\\right)$.\nWhen $\\alpha \\ll 1$, the term $1/\\alpha$ is much larger than $\\alpha$.\nThus, $\\Delta' \\approx \\frac{2}{k_{y}L^2}$.\nIn this limit, $\\Delta'$ is positive, and it scales as $(k_{y}L)^{-1}$.\nThe implication for magnetic island growth is that a positive value of $\\Delta'$ indicates that the plasma configuration is unstable to the tearing mode. There is free magnetic energy available to be released through magnetic reconnection. In the linear phase of resistive MHD, this instability leads to the exponential growth of the tearing perturbation, which nonlinearly evolves into a magnetic island chain at the rational surface $x=0$. Therefore, for long-wavelength perturbations, the Harris sheet equilibrium is strongly unstable to tearing.",
            "answer": "$$\n\\boxed{\\frac{2}{k_{y}L^{2}} - 2k_{y}}\n$$"
        },
        {
            "introduction": "Once an instability like a tearing mode begins to grow, its interaction with the surrounding environment governs its evolution and its potential to trigger a disruption. A key dynamic precursor event is 'mode locking,' where the rotating magnetic island slows down and locks in phase with a static error field. This practice  challenges you to model this process using a simplified but powerful torque balance equation, allowing you to infer the magnitude of the braking electromagnetic torque from a given slowdown trajectory.",
            "id": "3967872",
            "problem": "A magnetohydrodynamics (MHD) tearing mode in a tokamak exhibits phase slippage relative to a static error field. Suppose the measured phase slip rate, modeled as the island angular frequency relative to the wall, decreases linearly from an initial value $\\,\\omega_{0}\\,$ to zero over the last $\\,t_{L}\\,$ prior to locking. In this interval, assume $\\,\\omega(t) = \\omega_{0}\\left(1 - \\frac{t}{t_{L}}\\right)\\,$ for $\\,0 \\leq t \\leq t_{L}\\,$, with $\\,\\omega_{0} = 60\\ \\mathrm{rad/s}\\,$ and $\\,t_{L} = 50\\ \\mathrm{ms}\\,$. Model the island rotation dynamics using Newton’s second law for rotation with a single-degree-of-freedom effective inertia $\\,I\\,$ and linear friction coefficient $\\,\\Gamma\\,$ such that the torque balance is given by\n$$\nI\\,\\frac{d\\omega}{dt} = -\\,\\Gamma\\,\\omega - T_{\\mathrm{EM}}(t),\n$$\nwhere $\\,T_{\\mathrm{EM}}(t)\\ge 0\\,$ is the electromagnetic torque that acts to retard the rotation and promote locking. Take $\\,I = 0.020\\ \\mathrm{N\\cdot m\\cdot s^{2}}\\,$ and $\\,\\Gamma = 0.20\\ \\mathrm{N\\cdot m\\cdot s}\\,$.\n\nUsing this model and the measured $\\,\\omega(t)\\,$, derive an expression for $\\,T_{\\mathrm{EM}}(t)\\,$ and compute the increase in the electromagnetic torque magnitude, $\\,\\Delta T_{\\mathrm{EM}} = T_{\\mathrm{EM}}(t_{L}) - T_{\\mathrm{EM}}(0)\\,$, over the $\\,50\\ \\mathrm{ms}\\,$ interval. Based on the sign and magnitude of $\\,T_{\\mathrm{EM}}(t_{L})\\,$, infer whether imminent locking is consistent with the dynamics. Express the final torque increase in $\\mathrm{N\\cdot m}$ and round your numerical answer to three significant figures. The final answer must be a single real-valued number.",
            "solution": "The problem statement must first be validated for scientific soundness, consistency, and completeness.\n\n**Step 1: Extract Givens**\nThe givens are:\n- The measured phase slip rate (island angular frequency) is modeled as $\\omega(t) = \\omega_{0}\\left(1 - \\frac{t}{t_{L}}\\right)$ for the time interval $0 \\leq t \\leq t_{L}$.\n- Initial angular frequency: $\\omega_{0} = 60\\ \\mathrm{rad/s}$.\n- Locking time interval: $t_{L} = 50\\ \\mathrm{ms}$.\n- Torque balance equation: $I\\,\\frac{d\\omega}{dt} = -\\,\\Gamma\\,\\omega - T_{\\mathrm{EM}}(t)$.\n- Effective inertia: $I = 0.020\\ \\mathrm{N\\cdot m\\cdot s^{2}}$.\n- Linear friction coefficient: $\\Gamma = 0.20\\ \\mathrm{N\\cdot m\\cdot s}$.\n- The electromagnetic torque $T_{\\mathrm{EM}}(t) \\ge 0$ acts to retard rotation.\n- The objective is to compute the increase in electromagnetic torque magnitude, $\\Delta T_{\\mathrm{EM}} = T_{\\mathrm{EM}}(t_{L}) - T_{\\mathrm{EM}}(0)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem uses a simplified but standard single-degree-of-freedom model (Newton's second law for rotation) to describe the dynamics of a tearing mode locking to an error field in a tokamak. This is a common approach in computational fusion science for analyzing mode locking dynamics. The phenomenon of tearing modes, their rotation, and locking are well-established concepts in magnetohydrodynamics (MHD).\n- **Well-Posed:** The problem provides a specific functional form for $\\omega(t)$ and a differential equation relating it to the unknown torque $T_{\\mathrm{EM}}(t)$. Since $\\omega(t)$ is fully specified, $T_{\\mathrm{EM}}(t)$ can be determined directly. All necessary constants ($I$, $\\Gamma$, $\\omega_{0}$, $t_{L}$) are provided with consistent units. The task is clearly defined.\n- **Objective:** The problem is stated using precise physical quantities and mathematical relations, free from subjective language.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically valid, well-posed, and self-contained. I will proceed with the solution.\n\nThe solution begins with the provided torque balance equation:\n$$\nI\\,\\frac{d\\omega}{dt} = -\\,\\Gamma\\,\\omega - T_{\\mathrm{EM}}(t)\n$$\nThe goal is to find an expression for the electromagnetic torque, $T_{\\mathrm{EM}}(t)$. Rearranging the equation yields:\n$$\nT_{\\mathrm{EM}}(t) = -I\\,\\frac{d\\omega}{dt} - \\Gamma\\,\\omega(t)\n$$\nWe are given the functional form for the island's angular frequency:\n$$\n\\omega(t) = \\omega_{0}\\left(1 - \\frac{t}{t_{L}}\\right)\n$$\nTo use the expression for $T_{\\mathrm{EM}}(t)$, we must first compute the time derivative of $\\omega(t)$:\n$$\n\\frac{d\\omega}{dt} = \\frac{d}{dt}\\left[\\omega_{0}\\left(1 - \\frac{t}{t_{L}}\\right)\\right] = \\frac{d}{dt}\\left[\\omega_{0} - \\frac{\\omega_{0}}{t_{L}}t\\right]\n$$\nSince $\\omega_{0}$ and $t_{L}$ are constants, the derivative is:\n$$\n\\frac{d\\omega}{dt} = -\\frac{\\omega_{0}}{t_{L}}\n$$\nThis result indicates that the angular deceleration is constant over the interval $0 \\leq t \\leq t_{L}$.\n\nNow, we can substitute the expressions for $\\omega(t)$ and $\\frac{d\\omega}{dt}$ back into the equation for $T_{\\mathrm{EM}}(t)$:\n$$\nT_{\\mathrm{EM}}(t) = -I\\left(-\\frac{\\omega_{0}}{t_{L}}\\right) - \\Gamma\\left[\\omega_{0}\\left(1 - \\frac{t}{t_{L}}\\right)\\right]\n$$\n$$\nT_{\\mathrm{EM}}(t) = \\frac{I\\,\\omega_{0}}{t_{L}} - \\Gamma\\,\\omega_{0} + \\frac{\\Gamma\\,\\omega_{0}}{t_{L}}t\n$$\nThis expression gives the electromagnetic torque as a linear function of time $t$.\n\nThe problem requires calculating the increase in the electromagnetic torque, $\\Delta T_{\\mathrm{EM}}$, from $t=0$ to $t=t_{L}$.\n$$\n\\Delta T_{\\mathrm{EM}} = T_{\\mathrm{EM}}(t_{L}) - T_{\\mathrm{EM}}(0)\n$$\nFirst, let's evaluate $T_{\\mathrm{EM}}(t)$ at $t=0$:\n$$\nT_{\\mathrm{EM}}(0) = \\frac{I\\,\\omega_{0}}{t_{L}} - \\Gamma\\,\\omega_{0} + \\frac{\\Gamma\\,\\omega_{0}}{t_{L}}(0) = \\frac{I\\,\\omega_{0}}{t_{L}} - \\Gamma\\,\\omega_{0}\n$$\nNext, let's evaluate $T_{\\mathrm{EM}}(t)$ at $t=t_{L}$:\n$$\nT_{\\mathrm{EM}}(t_{L}) = \\frac{I\\,\\omega_{0}}{t_{L}} - \\Gamma\\,\\omega_{0} + \\frac{\\Gamma\\,\\omega_{0}}{t_{L}}(t_{L}) = \\frac{I\\,\\omega_{0}}{t_{L}} - \\Gamma\\,\\omega_{0} + \\Gamma\\,\\omega_{0} = \\frac{I\\,\\omega_{0}}{t_{L}}\n$$\nNow, we compute the difference:\n$$\n\\Delta T_{\\mathrm{EM}} = T_{\\mathrm{EM}}(t_{L}) - T_{\\mathrm{EM}}(0) = \\left(\\frac{I\\,\\omega_{0}}{t_{L}}\\right) - \\left(\\frac{I\\,\\omega_{0}}{t_{L}} - \\Gamma\\,\\omega_{0}\\right)\n$$\n$$\n\\Delta T_{\\mathrm{EM}} = \\frac{I\\,\\omega_{0}}{t_{L}} - \\frac{I\\,\\omega_{0}}{t_{L}} + \\Gamma\\,\\omega_{0}\n$$\n$$\n\\Delta T_{\\mathrm{EM}} = \\Gamma\\,\\omega_{0}\n$$\nThe increase in the electromagnetic torque depends only on the friction coefficient and the initial angular frequency.\n\nNow, we substitute the given numerical values:\n$\\Gamma = 0.20\\ \\mathrm{N\\cdot m\\cdot s}$\n$\\omega_{0} = 60\\ \\mathrm{rad/s}$\nThe unit of radians is dimensionless, so it can be omitted in the unit analysis.\n$$\n\\Delta T_{\\mathrm{EM}} = (0.20\\ \\mathrm{N\\cdot m\\cdot s}) \\times (60\\ \\mathrm{s^{-1}}) = 12\\ \\mathrm{N\\cdot m}\n$$\nThe problem requires the answer to be rounded to three significant figures. The calculated value is $12$, which can be written as $12.0$.\n\nFinally, the problem asks to infer whether imminent locking is consistent with the dynamics based on the sign and magnitude of $T_{\\mathrm{EM}}(t_{L})$. At $t=t_{L}$, the island rotation has ceased, i.e., $\\omega(t_{L}) = 0$. The electromagnetic torque at this moment is:\n$$\nT_{\\mathrm{EM}}(t_{L}) = \\frac{I\\,\\omega_{0}}{t_{L}} = \\frac{(0.020\\ \\mathrm{N\\cdot m\\cdot s^{2}}) \\times (60\\ \\mathrm{rad/s})}{50 \\times 10^{-3}\\ \\mathrm{s}} = \\frac{1.2\\ \\mathrm{N\\cdot m\\cdot s}}{0.050\\ \\mathrm{s}} = 24\\ \\mathrm{N\\cdot m}\n$$\nThis is a positive, and therefore retarding, torque. The existence of a non-zero retarding torque on a stationary object ($\\omega=0$) is the definition of a locked state. The external field is exerting a torque that prevents the mode from spinning up, holding it at a fixed phase. Thus, the positive sign and significant magnitude of $T_{\\mathrm{EM}}(t_{L})$ are fully consistent with the mode having locked at $t=t_{L}$.\n\nThe final requested quantity is the numerical value for $\\Delta T_{\\mathrm{EM}}$.\n$$\n\\Delta T_{\\mathrm{EM}} = 12.0\\ \\mathrm{N\\cdot m}\n$$",
            "answer": "$$\n\\boxed{12.0}\n$$"
        },
        {
            "introduction": "Identifying precursors in real-world tokamak data is a significant challenge in computational fusion science, as faint coherent signals are often masked by strong broadband turbulence. Effective precursor detection requires moving beyond simple spectral analysis to employ multi-channel, phase-sensitive techniques. This advanced practice  guides you through designing a sophisticated algorithm that combines energy concentration, inter-signal coherence, and phase-locking criteria to robustly distinguish a locked mode precursor from a noisy background.",
            "id": "3967823",
            "problem": "You are given two synthetic time series representing poloidal magnetic pickup coil signals from a toroidal device. The goal is to separate an $n=1$ locked mode precursor from broadband turbulence using time-frequency filters and coherence measures and to produce a decision for each case in a test suite. The scenario is motivated by disruption onset and precursor modeling in computational fusion science and engineering, where locked modes manifest as low-frequency, phase-consistent oscillations across poloidal sensors, contrasted with broadband turbulence which is spectrally spread and exhibits weaker cross-sensor coherence.\n\nStarting from fundamental definitions, consider the Short-Time Fourier Transform (STFT) of a discrete-time signal $x[k]$ with a window $w[\\cdot]$:\n$$\nX(t_m,f_\\ell) = \\sum_{k=0}^{N-1} x[k]\\,w[k - t_m]\\,e^{-i 2\\pi f_\\ell k / f_s},\n$$\nwhere $t_m$ are window center indices, $f_\\ell$ are discrete frequency bins, $N$ is the signal length, and $f_s$ is the sampling frequency in $\\mathrm{Hz}$. For two channels $x_1[k]$ and $x_2[k]$, define their time-frequency auto-spectral densities and cross-spectral density at $(t_m,f_\\ell)$ as\n$$\nP_{11}(t_m,f_\\ell) = |X_1(t_m,f_\\ell)|^2,\\quad\nP_{22}(t_m,f_\\ell) = |X_2(t_m,f_\\ell)|^2,\\quad\nP_{12}(t_m,f_\\ell) = X_1(t_m,f_\\ell)\\,X_2^*(t_m,f_\\ell).\n$$\nThe Magnitude-Squared Coherence (MSC) in time-frequency form is\n$$\nC(t_m,f_\\ell) = \\frac{|P_{12}(t_m,f_\\ell)|^2}{P_{11}(t_m,f_\\ell)\\,P_{22}(t_m,f_\\ell) + \\epsilon},\n$$\nwith $\\epsilon0$ to avoid division by zero. The phase difference estimate is $\\phi_{\\mathrm{meas}}(t_m,f_\\ell)=\\arg(P_{12}(t_m,f_\\ell))$. For poloidal sensors separated by an angle $\\Delta\\theta$ in radians, an $n=1$ mode implies an expected phase difference $\\phi_{\\mathrm{exp}} = n\\,\\Delta\\theta$. The Phase-Locking Value (PLV) in a time-frequency band $\\mathcal{B}$ is\n$$\n\\mathrm{PLV}(t_m)=\\left|\\frac{1}{|\\mathcal{B}|}\\sum_{f_\\ell\\in \\mathcal{B}} e^{i\\left(\\phi_{\\mathrm{meas}}(t_m,f_\\ell)-\\phi_{\\mathrm{exp}}\\right)}\\right|.\n$$\n\nYour task is to design an algorithm that, given two channels and a target frequency $f_0$ for the candidate locked mode, performs the following steps:\n\n- Compute the Short-Time Fourier Transform (STFT) for both channels and identify a narrow band $\\mathcal{B}=\\{f_\\ell: |f_\\ell-f_0|\\le \\Delta f\\}$ about $f_0$, where $\\Delta f$ is a prescribed half-width in $\\mathrm{Hz}$.\n- Form a time-dependent narrowband energy ratio that quantifies how concentrated the signal energy is within $\\mathcal{B}$ compared to a broader analysis band $\\mathcal{A}$:\n$$\nR(t_m) = \\frac{\\sum_{f_\\ell\\in \\mathcal{B}} \\left(P_{11}(t_m,f_\\ell)+P_{22}(t_m,f_\\ell)\\right)}{\\sum_{f_\\ell\\in \\mathcal{A}} \\left(P_{11}(t_m,f_\\ell)+P_{22}(t_m,f_\\ell)\\right)}.\n$$\n- Compute the time-dependent band-averaged Magnitude-Squared Coherence:\n$$\n\\overline{C}(t_m) = \\frac{1}{|\\mathcal{B}|}\\sum_{f_\\ell\\in \\mathcal{B}} C(t_m,f_\\ell).\n$$\n- Compute the Phase-Locking Value $\\mathrm{PLV}(t_m)$ using the expected phase $\\phi_{\\mathrm{exp}} = n\\,\\Delta\\theta$ with $n=1$.\n- Combine these measures into a composite detection statistic\n$$\nD(t_m) = R(t_m)^\\alpha\\,\\overline{C}(t_m)^\\beta\\,\\mathrm{PLV}(t_m)^\\gamma,\n$$\nwith exponents $\\alpha$, $\\beta$, $\\gamma$ chosen as positive constants and a decision threshold $\\tau0$. A locked mode precursor is deemed present if $\\max_m D(t_m)  \\tau$.\n\nUnits and numerical conventions:\n- Sampling frequency $f_s$ in $\\mathrm{Hz}$, time in $\\mathrm{s}$, angles in $\\mathrm{radians}$, and the STFT frequency axis in $\\mathrm{Hz}$.\n- Express any numerical outputs as booleans or floats without unit annotations.\n- Angles must be interpreted in radians.\n\nSynthetic data generation for testing:\n- Each channel is a sum of three components: an $n=1$ locked-mode sinusoid at frequency $f_0$ with amplitude $A_{\\mathrm{LM}}$, a linear chirp whose instantaneous frequency sweeps from $f_{\\mathrm{ch,start}}$ to $f_{\\mathrm{ch,end}}$ with amplitude $A_{\\mathrm{CH}}$, and band-limited turbulence generated by passing white noise through a low-pass filter with amplitude $A_{\\mathrm{TB}}$ and cutoff $f_{\\mathrm{lp}}$.\n- Channel $x_1(t)$ uses phase $0$ for the locked mode. Channel $x_2(t)$ uses phase $\\phi_{\\mathrm{LM}}$, which equals $\\phi_{\\mathrm{exp}}$ unless specified otherwise. The chirp and turbulence components may have independent random phases between channels.\n\nTest suite specification:\nUse the following four cases, each defined by the tuple $(f_s, T, f_0, \\Delta f, \\Delta\\theta, A_{\\mathrm{LM}}, A_{\\mathrm{CH}}, f_{\\mathrm{ch,start}}, f_{\\mathrm{ch,end}}, A_{\\mathrm{TB}}, f_{\\mathrm{lp}}, \\alpha, \\beta, \\gamma, \\tau, \\text{phase\\_mismatch})$ where all symbols are defined above, $T$ is the record duration in $\\mathrm{s}$, and $\\text{phase\\_mismatch}$ is an added phase offset in radians applied only to the locked-mode component of $x_2$:\n\n- Case $1$ (happy path): $(1000, 8, 5, 1, \\pi/3, 1.0, 0.4, 2, 12, 0.3, 60, 1, 1, 1, 0.15, 0.0)$\n- Case $2$ (no locked mode): $(1000, 8, 5, 1, \\pi/3, 0.0, 0.4, 2, 12, 0.4, 60, 1, 1, 1, 0.15, 0.0)$\n- Case $3$ (near threshold with overlap): $(1000, 8, 5, 1, \\pi/3, 0.25, 0.3, 4, 10, 0.5, 60, 1, 1, 1, 0.10, 0.0)$\n- Case $4$ (strong narrowband but wrong phase): $(1000, 8, 5, 1, \\pi/3, 1.0, 0.3, 6, 14, 0.3, 60, 1, 1, 1, 0.15, 1.2)$\n\nYour program must:\n- Generate the synthetic signals for each case using the parameters above.\n- Compute the detection statistic $D(t_m)$ as specified and decide whether a locked mode precursor is present in each case by comparing $\\max_m D(t_m)$ to $\\tau$.\n- Produce a single line of output containing the detection results for the four cases as a comma-separated list enclosed in square brackets, for example $[{\\text{True}},{\\text{False}},{\\text{True}},{\\text{False}}]$.\n\nYour method must be universally applicable and framed in purely mathematical terms, relying only on the definitions provided and scientifically sound reasoning. No external data or user input is allowed; all signals must be generated internally. Ensure the design covers overlapping bands and evaluates both energy concentration and cross-channel phase-coherent structure to discriminate the locked mode from turbulence.",
            "solution": "The problem requires the design and implementation of an algorithm to detect an $n=1$ locked mode precursor in synthetic magnetometer signals from a toroidal fusion device. The solution involves separating the coherent, narrowband mode signature from broadband turbulence and other non-stationary signals using time-frequency analysis. The problem is well-defined, scientifically grounded in plasma physics and signal processing, and provides a clear set of test cases for validation. A few implementation details, such as Short-Time Fourier Transform (STFT) window parameters, are unspecified; therefore, standard and justifiable choices will be made and documented.\n\nThe methodology proceeds in three stages: first, generation of synthetic two-channel time-series data according to the problem specification; second, application of time-frequency analysis to compute several discriminating features; and third, combination of these features into a single detection statistic for a final decision.\n\n**1. Synthetic Signal Generation**\n\nFor each test case, two time-series signals, $x_1[k]$ and $x_2[k]$, are synthesized. The total number of samples is $N = f_s T$, where $f_s$ is the sampling frequency and $T$ is the duration. The discrete time points are $t_k = k/f_s$ for $k = 0, 1, \\dots, N-1$. Each signal is a linear superposition of three components: a locked mode, a linear chirp, and band-limited turbulence.\n\n- **Locked Mode (LM):** This is a sinusoidal signal at a target frequency $f_0$ with amplitude $A_{\\mathrm{LM}}$. The phase relationship between the two channels is critical. For channel $1$, the signal is $s_{\\mathrm{LM},1}(t) = A_{\\mathrm{LM}} \\sin(2\\pi f_0 t)$. For channel $2$, the signal is $s_{\\mathrm{LM},2}(t) = A_{\\mathrm{LM}} \\sin(2\\pi f_0 t + \\phi_{\\mathrm{LM}})$, where the phase $\\phi_{\\mathrm{LM}} = \\phi_{\\mathrm{exp}} + \\phi_{\\mathrm{mismatch}}$. The expected phase difference for an $n=1$ mode is $\\phi_{\\mathrm{exp}} = n \\Delta\\theta = 1 \\cdot \\Delta\\theta$.\n- **Linear Chirp (CH):** This component simulates another non-stationary signal. It is a sinusoid of amplitude $A_{\\mathrm{CH}}$ whose frequency changes linearly from $f_{\\mathrm{ch,start}}$ to $f_{\\mathrm{ch,end}}$ over the duration $T$. Independent random initial phases are assigned to the chirp on each channel to model a process that is not phase-locked between the sensors.\n- **Turbulence (TB):** This component models the plasma turbulence background. It is generated by creating two independent white Gaussian noise signals, which are then passed through a digital low-pass filter. For this implementation, a $4^{th}$-order Butterworth filter with a cutoff frequency of $f_{\\mathrm{lp}}$ is used. The resulting filtered signals are then scaled to have a standard deviation of $A_{\\mathrm{TB}}$.\n\nFor reproducibility, the random number generator is seeded before the synthesis of each pair of signals.\n\n**2. Time-Frequency Analysis and Feature Extraction**\n\nThe core of the analysis lies in the Short-Time Fourier Transform (STFT), which maps the one-dimensional time-series signals $x_1[k]$ and $x_2[k]$ into two-dimensional time-frequency representations, $X_1(t_m, f_\\ell)$ and $X_2(t_m, f_\\ell)$.\n\n- **STFT Implementation:** We use a Hann window, a standard choice for reducing spectral leakage. The window length `nperseg` is set to $1024$ samples, and the overlap `noverlap` is set to $512$ samples ($50\\%$). For a sampling frequency $f_s=1000$ Hz, this window length of $1.024$ s provides a frequency resolution of $f_s/\\text{nperseg} \\approx 0.977$ Hz. This resolution is sufficient to resolve the narrow band $\\mathcal{B}$ of half-width $\\Delta f=1$ Hz around the mode frequency $f_0=5$ Hz using multiple frequency bins, which is necessary for meaningful band-averaging.\n\nFrom the STFT outputs, we compute the auto-spectral densities $P_{11}(t_m, f_\\ell) = |X_1(t_m, f_\\ell)|^2$ and $P_{22}(t_m, f_\\ell) = |X_2(t_m, f_\\ell)|^2$, and the cross-spectral density $P_{12}(t_m, f_\\ell) = X_1(t_m, f_\\ell) X_2^*(t_m, f_\\ell)$.\n\nThree key features are then extracted for each time step $t_m$:\n\n- **Narrowband Energy Ratio, $R(t_m)$:** This metric, defined as $R(t_m) = \\frac{\\sum_{f_\\ell\\in \\mathcal{B}} (P_{11}+P_{22})}{\\sum_{f_\\ell\\in \\mathcal{A}} (P_{11}+P_{22})}$, quantifies the concentration of signal power within the target frequency band $\\mathcal{B} = \\{f_\\ell: |f_\\ell - f_0| \\le \\Delta f\\}$. The broad analysis band $\\mathcal{A}$ is taken to be the entire positive frequency range provided by the STFT. A high value of $R(t_m)$ indicates the presence of a strong narrowband signal component.\n\n- **Band-Averaged Magnitude-Squared Coherence, $\\overline{C}(t_m)$:** Coherence measures the linear correlation between two signals as a function of frequency. The Magnitude-Squared Coherence is $C(t_m, f_\\ell) = \\frac{|P_{12}(t_m, f_\\ell)|^2}{P_{11}(t_m, f_\\ell) P_{22}(t_m, f_\\ell) + \\epsilon}$. We compute the average coherence $\\overline{C}(t_m) = \\frac{1}{|\\mathcal{B}|}\\sum_{f_\\ell\\in \\mathcal{B}} C(t_m,f_\\ell)$ over the band $\\mathcal{B}$. A value near $1$ signifies a strong, consistent linear relationship between the two channels in the target band, characteristic of a coherent mode. A small regularization term $\\epsilon=10^{-15}$ is used for numerical stability.\n\n- **Phase-Locking Value, $\\mathrm{PLV}(t_m)$:** This is the most specific metric. It verifies if the phase difference between the channels matches the theoretical expectation for an $n=1$ mode. It is calculated as $\\mathrm{PLV}(t_m)=\\left|\\frac{1}{|\\mathcal{B}|}\\sum_{f_\\ell\\in \\mathcal{B}} e^{i\\left(\\phi_{\\mathrm{meas}}(t_m,f_\\ell)-\\phi_{\\mathrm{exp}}\\right)}\\right|$, where $\\phi_{\\mathrm{meas}} = \\arg(P_{12})$ is the measured phase difference and $\\phi_{\\mathrm{exp}} = \\Delta\\theta$. A PLV near $1$ indicates that the measured phase difference is consistently close to the expected phase difference across the band $\\mathcal{B}$, strongly supporting the hypothesis of an $n=1$ mode. A low PLV, even with high coherence, would suggest a different mode structure or a coherent artifact with the wrong phase relationship.\n\n**3. Composite Statistic and Decision**\n\nThese three metrics are combined into a single composite detection statistic, $D(t_m) = R(t_m)^\\alpha \\overline{C}(t_m)^\\beta \\mathrm{PLV}(t_m)^\\gamma$. This multiplicative form ensures that a high detection value requires the simultaneous satisfaction of all three conditions: concentrated energy (high $R$), strong inter-channel coherence (high $\\overline{C}$), and the correct phase structure (high PLV). This provides robustness, as a signal that is merely narrowband but incoherent (e.g., noise filtered into a narrow band) or coherent but with the wrong phase relationship will result in a low value of $D(t_m)$.\n\nThe final decision for each test case is made by comparing the maximum value of the detection statistic over the entire time window against a prescribed threshold $\\tau$. A locked mode precursor is declared present if $\\max_m D(t_m)  \\tau$. This procedure is applied to each of the four test cases specified in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef solve():\n    \"\"\"\n    Main function to run the locked mode detection algorithm on the test suite.\n    \"\"\"\n    # Test suite specification:\n    # (fs, T, f0, df, dtheta, A_LM, A_CH, f_ch_start, f_ch_end, A_TB, f_lp, \n    #  alpha, beta, gamma, tau, phase_mismatch)\n    test_cases = [\n        (1000, 8, 5, 1, np.pi/3, 1.0, 0.4, 2, 12, 0.3, 60, 1, 1, 1, 0.15, 0.0),\n        (1000, 8, 5, 1, np.pi/3, 0.0, 0.4, 2, 12, 0.4, 60, 1, 1, 1, 0.15, 0.0),\n        (1000, 8, 5, 1, np.pi/3, 0.25, 0.3, 4, 10, 0.5, 60, 1, 1, 1, 0.10, 0.0),\n        (1000, 8, 5, 1, np.pi/3, 1.0, 0.3, 6, 14, 0.3, 60, 1, 1, 1, 0.15, 1.2)\n    ]\n\n    results = []\n    \n    # STFT parameters (chosen for good frequency resolution around f0)\n    NPERSEG = 1024\n    NOVERLAP = NPERSEG // 2\n    EPSILON = 1e-15 # Regularization for division\n\n    for i, case in enumerate(test_cases):\n        # Unpack parameters\n        (fs, T, f0, df, dtheta, A_LM, A_CH, f_ch_start, f_ch_end, A_TB, f_lp, \n         alpha, beta, gamma, tau, phase_mismatch) = case\n\n        # Seed random generator for reproducibility for each case\n        np.random.seed(i)\n\n        # 1. Generate Synthetic Signals\n        N = int(fs * T)\n        t = np.arange(N) / fs\n\n        # Locked Mode component\n        phi_exp = 1.0 * dtheta\n        s_lm1 = A_LM * np.sin(2 * np.pi * f0 * t)\n        s_lm2 = A_LM * np.sin(2 * np.pi * f0 * t + phi_exp + phase_mismatch)\n\n        # Chirp component\n        s_ch1 = A_CH * signal.chirp(t, f_ch_start, t[-1], f_ch_end, method='linear', \n                                    phi=np.random.rand() * 360)\n        s_ch2 = A_CH * signal.chirp(t, f_ch_start, t[-1], f_ch_end, method='linear',\n                                    phi=np.random.rand() * 360)\n\n        # Turbulence component\n        sos = signal.butter(4, f_lp, 'low', fs=fs, output='sos')\n        noise1 = np.random.randn(N)\n        noise2 = np.random.randn(N)\n        s_tb1_unscaled = signal.sosfilt(sos, noise1)\n        s_tb2_unscaled = signal.sosfilt(sos, noise2)\n        s_tb1 = A_TB * (s_tb1_unscaled / np.std(s_tb1_unscaled))\n        s_tb2 = A_TB * (s_tb2_unscaled / np.std(s_tb2_unscaled))\n        \n        # Combine components\n        x1 = s_lm1 + s_ch1 + s_tb1\n        x2 = s_lm2 + s_ch2 + s_tb2\n\n        # 2. Time-Frequency Analysis\n        f_stft, t_stft, X1 = signal.stft(x1, fs=fs, window='hann', nperseg=NPERSEG, noverlap=NOVERLAP)\n        _, _, X2 = signal.stft(x2, fs=fs, window='hann', nperseg=NPERSEG, noverlap=NOVERLAP)\n        \n        # Auto- and Cross-Spectral Densities\n        P11 = np.abs(X1)**2\n        P22 = np.abs(X2)**2\n        P12 = X1 * np.conj(X2)\n\n        # Identify frequency bands\n        band_B_indices = np.where(np.abs(f_stft - f0) = df)[0]\n        # Broad band A is the full STFT frequency range\n\n        # 3. Compute Detection Metrics\n        # Energy Ratio R(t_m)\n        num_R = np.sum(P11[band_B_indices, :] + P22[band_B_indices, :], axis=0)\n        den_R = np.sum(P11 + P22, axis=0)\n        R = num_R / (den_R + EPSILON)\n\n        # Band-Averaged Coherence C_bar(t_m)\n        C = (np.abs(P12)**2) / (P11 * P22 + EPSILON)\n        C_bar = np.mean(C[band_B_indices, :], axis=0)\n\n        # Phase-Locking Value PLV(t_m)\n        phi_meas = np.angle(P12)\n        phase_diff_term = np.exp(1j * (phi_meas - phi_exp))\n        PLV = np.abs(np.mean(phase_diff_term[band_B_indices, :], axis=0))\n\n        # 4. Composite Statistic and Decision\n        D = (R**alpha) * (C_bar**beta) * (PLV**gamma)\n        \n        is_precursor_detected = np.max(D) > tau\n        results.append(str(is_precursor_detected))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results).replace('True', 'True').replace('False', 'False')}]\")\n\nsolve()\n```"
        }
    ]
}