{
    "hands_on_practices": [
        {
            "introduction": "Before tackling complex solution methodologies, it is essential to build a solid foundation by understanding the physical quantities that govern neutron transport. This first practice focuses on dimensional analysis, a powerful tool for verifying the physical and mathematical consistency of our models. By deriving the units of key quantities such as angular flux, macroscopic cross-sections, and source terms from their fundamental definitions, you will develop a deeper intuition for their physical meaning and how they relate within the transport equation .",
            "id": "4020714",
            "problem": "In a simplified model of a deuteriumâ€“tritium (DT) fusion blanket segment, consider a steady-state, monoenergetic neutron field in an infinite, homogeneous, isotropically scattering medium with no fission and no leakage. The monoenergetic angular flux is denoted by $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$, where $\\mathbf{r}$ is position and $\\boldsymbol{\\Omega}$ is flight direction. The scalar flux is $\\phi(\\mathbf{r}) \\equiv \\int_{4\\pi} \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) \\,\\mathrm{d}\\boldsymbol{\\Omega}$. The macroscopic total and scattering cross sections are $\\Sigma_{t}$ and $\\Sigma_{s}$, respectively, with absorption cross section defined by $\\Sigma_{a} \\equiv \\Sigma_{t} - \\Sigma_{s}$. An isotropic external volumetric source of neutrons is present with strength $Q$ (neutrons created per unit volume per unit time). All quantities are to be expressed in the International System of Units (SI), with steradian (sr) as the unit of solid angle. The energy unit used is the megalelectronvolt (MeV), where $1\\,\\mathrm{eV}$ is the electronvolt.\n\nTasks:\n1) Starting from first principles and core definitions, use dimensional analysis to determine the SI units of the following monoenergetic quantities: the angular flux $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$, the scalar flux $\\phi(\\mathbf{r})$, the macroscopic total and scattering cross sections $\\Sigma_{t}$ and $\\Sigma_{s}$, and the volumetric isotropic source $Q$ that appears in the angle-integrated steady-state balance. Explicitly justify each unit by referring to its defining rate or probability interpretation.\n\n2) From the steady-state, angle-integrated neutron balance in an infinite, homogeneous medium without leakage and without fission, show that all terms have consistent dimensions and write the balance in terms of $\\Sigma_{t}$, $\\Sigma_{s}$, $\\phi$, and $Q$.\n\n3) Using only the balance derived in part 2, obtain an expression for the scalar flux $\\phi$ in terms of $Q$ and $\\Sigma_{a}$. Then write the absorption reaction rate density $R_{a}$ in terms of these quantities and verify its units via dimensional analysis.\n\n4) For the parameter set\n- $\\Sigma_{t} = 1.20\\,\\mathrm{m}^{-1}$,\n- $\\Sigma_{s} = 0.95\\,\\mathrm{m}^{-1}$,\n- $Q = 2.50 \\times 10^{18}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$,\n- deposited energy per absorption $E_{\\mathrm{dep}} = 14.1\\,\\mathrm{MeV}$,\nwith the exact SI conversion $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$,\ncompute the volumetric power density $p$ defined by $p = R_{a} \\, E_{\\mathrm{dep}}$.\n\nRound your final numerical answer for $p$ to four significant figures. Express the final power density in $\\mathrm{W}\\,\\mathrm{m}^{-3}$. The final answer must be a single real-valued number.",
            "solution": "The problem statement has been analyzed and is determined to be valid. It is a well-posed problem in the field of neutron transport theory, grounded in established physical principles, with all necessary information provided for a unique solution. The solution proceeds by addressing each of the four specified tasks in order.\n\n**Task 1: Dimensional Analysis of Quantities**\n\nThe SI units for the specified quantities are determined from their fundamental definitions.\n\n1.  **Angular Flux, $\\psi(\\mathbf{r}, \\boldsymbol{\\Omega})$**: The angular flux is defined as the number of neutrons passing through a unit area perpendicular to the direction of motion, per unit time, per unit solid angle. Let $\\mathrm{d}N$ be the number of neutrons, $\\mathrm{d}A$ the unit area, $\\mathrm{d}t$ the unit time, and $\\mathrm{d}\\boldsymbol{\\Omega}$ the unit solid angle. The relationship is $\\mathrm{d}N = \\psi \\, \\mathrm{d}A \\, \\mathrm{d}t \\, \\mathrm{d}\\boldsymbol{\\Omega}$. The unit of $\\psi$, denoted $[\\psi]$, is therefore:\n    $$[\\psi] = \\frac{[\\mathrm{d}N]}{[\\mathrm{d}A][\\mathrm{d}t][\\mathrm{d}\\boldsymbol{\\Omega}]} = \\frac{1}{(\\mathrm{m}^{2})(\\mathrm{s})(\\mathrm{sr})} = \\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\\,\\mathrm{sr}^{-1}$$\n\n2.  **Scalar Flux, $\\phi(\\mathbf{r})$**: The scalar flux is defined by the integral of the angular flux over all $4\\pi$ steradians of solid angle: $\\phi(\\mathbf{r}) \\equiv \\int_{4\\pi} \\psi(\\mathbf{r}, \\boldsymbol{\\Omega}) \\,\\mathrm{d}\\boldsymbol{\\Omega}$. Thus, its unit is that of angular flux multiplied by that of solid angle:\n    $$[\\phi] = [\\psi] \\times [\\mathrm{d}\\boldsymbol{\\Omega}] = (\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\\,\\mathrm{sr}^{-1})(\\mathrm{sr}) = \\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$$\n\n3.  **Macroscopic Cross Sections, $\\Sigma_t$ and $\\Sigma_s$**: A macroscopic cross section $\\Sigma$ represents the probability of a specific type of neutron interaction per unit path length. Consequently, its dimension is inverse length.\n    $$[\\Sigma_t] = [\\Sigma_s] = \\mathrm{m}^{-1}$$\n    This is consistent with the fact that the product $\\Sigma \\phi$ yields a reaction rate density (reactions per unit volume per unit time): $[\\Sigma][\\phi] = (\\mathrm{m}^{-1})(\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}) = \\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$.\n\n4.  **Volumetric Source, $Q$**: The problem defines $Q$ as the number of neutrons created per unit volume per unit time.\n    $$[Q] = \\frac{[\\text{neutrons}]}{[\\text{volume}][\\text{time}]} = \\frac{1}{\\mathrm{m}^{3}\\,\\mathrm{s}} = \\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$$\n\n**Task 2: Angle-Integrated Neutron Balance**\n\nThe steady-state neutron transport equation describes the balance of neutrons. For the specified conditions (steady-state, infinite, homogeneous medium), the leakage term, which involves the spatial gradient of the flux ($\\nabla \\psi$), is zero. The angle-integrated balance equation equates the total rate of neutron loss per unit volume to the total rate of neutron gain per unit volume.\n\n*   Rate of neutron loss per unit volume is the total collision rate density: $\\Sigma_t \\phi$.\n*   Rate of neutron gain per unit volume consists of two parts:\n    1.  Neutrons scattering into the volume element. For isotropic scattering, this a rate of $\\Sigma_s \\phi$.\n    2.  Neutrons from the external source, with a rate of $Q$.\n\nEquating loss to gain gives the balance equation:\n$$ \\Sigma_t \\phi = \\Sigma_s \\phi + Q $$\nTo verify dimensional consistency, we use the units derived in Task 1. Each term has units of a rate density:\n$$ [\\Sigma_t \\phi] = (\\mathrm{m}^{-1})(\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}) = \\mathrm{m}^{-3}\\,\\mathrm{s}^{-1} $$\n$$ [\\Sigma_s \\phi] = (\\mathrm{m}^{-1})(\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}) = \\mathrm{m}^{-3}\\,\\mathrm{s}^{-1} $$\n$$ [Q] = \\mathrm{m}^{-3}\\,\\mathrm{s}^{-1} $$\nAll terms have consistent units ($\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$), confirming the validity of the balance equation.\n\n**Task 3: Scalar Flux and Absorption Rate**\n\nThe expression for the scalar flux $\\phi$ is obtained by rearranging the balance equation from Task 2:\n$$ \\Sigma_t \\phi - \\Sigma_s \\phi = Q $$\n$$ (\\Sigma_t - \\Sigma_s) \\phi = Q $$\nUsing the definition of the macroscopic absorption cross section, $\\Sigma_a \\equiv \\Sigma_t - \\Sigma_s$, we get:\n$$ \\Sigma_a \\phi = Q $$\nSolving for the scalar flux $\\phi$ yields:\n$$ \\phi = \\frac{Q}{\\Sigma_a} $$\nThe absorption reaction rate density, $R_a$, is the number of absorption reactions per unit volume per unit time. It is defined as the product of the macroscopic absorption cross section and the scalar flux:\n$$ R_a = \\Sigma_a \\phi $$\nBy substituting the result from our balance equation, $\\Sigma_a \\phi = Q$, we find:\n$$ R_a = Q $$\nThis result is physically expected: in a steady-state system without leakage or internal multiplication (fission), the rate of neutron absorption must exactly balance the rate at which neutrons are introduced by the external source. The units of $R_a$ are $[\\Sigma_a][\\phi] = (\\mathrm{m}^{-1})(\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}) = \\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$, which are the same as the units of $Q$, confirming consistency.\n\n**Task 4: Volumetric Power Density Calculation**\n\nThe volumetric power density, $p$, is the product of the absorption rate density, $R_a$, and the energy deposited per absorption, $E_{\\mathrm{dep}}$:\n$$ p = R_a E_{\\mathrm{dep}} $$\nFrom Task 3, we have $R_a = Q$, so:\n$$ p = Q E_{\\mathrm{dep}} $$\nThe given parameters are:\n$Q = 2.50 \\times 10^{18}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$\n$E_{\\mathrm{dep}} = 14.1\\,\\mathrm{MeV}$\n$1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$\n\nFirst, we convert the energy $E_{\\mathrm{dep}}$ to the SI unit of Joules ($\\mathrm{J}$):\n$$ E_{\\mathrm{dep}} = 14.1\\,\\mathrm{MeV} = 14.1 \\times 10^{6}\\,\\mathrm{eV} $$\n$$ E_{\\mathrm{dep}} = (14.1 \\times 10^{6}\\,\\mathrm{eV}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J}/\\mathrm{eV}) $$\n$$ E_{\\mathrm{dep}} \\approx 2.259069 \\times 10^{-12}\\,\\mathrm{J} $$\nNow we calculate $p$. The values for $\\Sigma_t$ and $\\Sigma_s$ are extraneous for this calculation.\n$$ p = (2.50 \\times 10^{18}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}) \\times (14.1 \\times 1.602176634 \\times 10^{-19}\\,\\mathrm{J}) $$\n$$ p = (2.50 \\times 10^{18}) \\times (2.25906905394 \\times 10^{-12}) \\,\\mathrm{J}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1} $$\n$$ p = 5.64767263485 \\times 10^{6} \\,\\mathrm{J}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1} $$\nSince $1\\,\\mathrm{W} = 1\\,\\mathrm{J}\\,\\mathrm{s}^{-1}$, the unit for power density is $\\mathrm{W}\\,\\mathrm{m}^{-3}$.\n$$ p = 5.64767263485 \\times 10^{6} \\,\\mathrm{W}\\,\\mathrm{m}^{-3} $$\nRounding to four significant figures as requested:\n$$ p \\approx 5.648 \\times 10^{6} \\,\\mathrm{W}\\,\\mathrm{m}^{-3} $$\nThis is the final numerical value for the volumetric power density.",
            "answer": "$$\\boxed{5.648 \\times 10^{6}}$$"
        },
        {
            "introduction": "While many transport problems require numerical approximation, analytical solutions for simplified scenarios provide invaluable physical insight. This exercise employs the method of characteristics to derive the exact scalar flux in an infinite, purely absorbing medium . This approach elegantly illustrates the integral nature of the transport equation, framing the flux at any point as the sum of source contributions along all possible paths, attenuated by their journey through the medium.",
            "id": "4020698",
            "problem": "Consider a three-dimensional, infinite, homogeneous, one-speed neutron medium that is purely absorbing, with macroscopic absorption cross section $\\Sigma_{a} > 0$ and no scattering or fission. A spatially uniform, steady, isotropic volumetric source of neutrons of strength $q_{0}$ (units $\\mathrm{cm^{-3}\\,s^{-1}}$) acts throughout the medium. Let $\\psi(\\mathbf{r},\\boldsymbol{\\Omega})$ denote the angular flux and $\\phi(\\mathbf{r})$ the scalar flux.\n\nStarting from first principles appropriate to neutron transport, specifically the definition of the macroscopic cross section and the one-speed, steady neutron transport balance for pure absorption, use the method of characteristics to:\n\n1. Derive the path-length distribution $p(s)$ for the distance to absorption along a straight-line characteristic parameterized by path length $s$.\n2. Use this distribution to obtain a characteristic integral representation for the angular flux $\\psi(\\mathbf{r},\\boldsymbol{\\Omega})$ in this medium.\n3. From your representation, compute the scalar flux $\\phi(\\mathbf{r})$ due to the volumetric isotropic source $q_{0}$.\n\nExpress the final scalar flux as a closed-form analytic expression in terms of $q_{0}$ and $\\Sigma_{a}$. If you choose to evaluate a numerical value for any specific parameters, round your result to four significant figures and express the scalar flux in $\\mathrm{cm^{-2}\\,s^{-1}}$. Otherwise, provide the exact analytic expression.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and complete. It is a standard, fundamental problem in neutron transport theory. We shall proceed with the derivation as requested.\n\nThe derivation is structured in three parts as per the problem statement: first, the derivation of the path-length distribution; second, the derivation of the angular flux; and third, the calculation of the scalar flux.\n\n**1. Derivation of the Path-Length Distribution $p(s)$**\n\nThe macroscopic absorption cross section, $\\Sigma_a$, represents the probability of absorption per unit path length for a neutron. Consider a neutron traveling along a straight-line path parameterized by path length $s$. Let $P(s)$ be the probability that the neutron travels a distance $s$ without being absorbed.\n\nThe probability of absorption occurring in an infinitesimal path length $ds$ is given by $\\Sigma_a ds$. Consequently, the probability of the neutron *not* being absorbed (i.e., surviving) in this path length is $1 - \\Sigma_a ds$.\n\nThe probability of surviving a path of length $s+ds$ is the product of the probability of surviving a path of length $s$ and the probability of surviving the subsequent infinitesimal path $ds$. This can be expressed as:\n$$\nP(s+ds) = P(s) (1 - \\Sigma_a ds)\n$$\nExpanding the left side using a Taylor series, $P(s+ds) \\approx P(s) + \\frac{dP}{ds} ds$, we have:\n$$\nP(s) + \\frac{dP(s)}{ds} ds \\approx P(s) - P(s) \\Sigma_a ds\n$$\nThis simplifies to the first-order ordinary differential equation:\n$$\n\\frac{dP(s)}{ds} = -\\Sigma_a P(s)\n$$\nThis equation is solved subject to the initial condition that the probability of traveling a zero distance without absorption is unity, i.e., $P(0) = 1$. The solution is:\n$$\nP(s) = \\exp(-\\Sigma_a s)\n$$\nThis function $P(s)$ is the survival probability.\n\nThe path-length distribution, $p(s)$, is the probability density function for the location of the first absorption event. The probability that an absorption occurs between path length $s$ and $s+ds$, which is $p(s)ds$, is equal to the decrease in the survival probability over that interval: $p(s)ds = P(s) - P(s+ds) = -dP(s)$. Thus,\n$$\np(s) = -\\frac{dP(s)}{ds}\n$$\nSubstituting the expression for $P(s)$:\n$$\np(s) = -\\frac{d}{ds} \\left( \\exp(-\\Sigma_a s) \\right) = -(-\\Sigma_a) \\exp(-\\Sigma_a s) = \\Sigma_a \\exp(-\\Sigma_a s)\n$$\nThis is the path-length distribution for the distance to absorption. It is correctly normalized, as $\\int_0^\\infty p(s) ds = \\int_0^\\infty \\Sigma_a \\exp(-\\Sigma_a s) ds = 1$.\n\n**2. Characteristic Integral Representation for the Angular Flux $\\psi(\\mathbf{r},\\boldsymbol{\\Omega})$**\n\nThe one-speed, steady-state neutron transport equation describes the balance of neutrons in a differential phase space volume $d^3r d\\boldsymbol{\\Omega}$. For a purely absorbing medium ($\\Sigma_s = 0$) with a volumetric source $q(\\mathbf{r}, \\boldsymbol{\\Omega})$, it is:\n$$\n\\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\mathbf{r},\\boldsymbol{\\Omega}) + \\Sigma_t \\psi(\\mathbf{r},\\boldsymbol{\\Omega}) = q(\\mathbf{r}, \\boldsymbol{\\Omega})\n$$\nIn this problem, the total macroscopic cross section is purely absorptive, so $\\Sigma_t = \\Sigma_a$. The source is given as uniform in space and isotropic in direction, with a total strength per unit volume of $q_0$. The source density in angular and spatial coordinates is therefore $q(\\mathbf{r}, \\boldsymbol{\\Omega}) = \\frac{q_0}{4\\pi}$. The transport equation becomes:\n$$\n\\boldsymbol{\\Omega} \\cdot \\nabla \\psi(\\mathbf{r},\\boldsymbol{\\Omega}) + \\Sigma_a \\psi(\\mathbf{r},\\boldsymbol{\\Omega}) = \\frac{q_0}{4\\pi}\n$$\nThe angular flux $\\psi(\\mathbf{r},\\boldsymbol{\\Omega})$ at a point $\\mathbf{r}$ in direction $\\boldsymbol{\\Omega}$ can be physically interpreted as the sum of all source contributions along the line-of-sight extending from $\\mathbf{r}$ in the direction $-\\boldsymbol{\\Omega}$.\n\nConsider a source point $\\mathbf{r}'$ located at a distance $s$ from $\\mathbf{r}$ along this line: $\\mathbf{r}' = \\mathbf{r} - s\\boldsymbol{\\Omega}$. A differential volume element $d^3r'$ at $\\mathbf{r}'$ contains a source of strength $q_0 d^3r'$ neutrons/s. Since the source is isotropic, the number of neutrons emitted per second into a solid angle $d\\boldsymbol{\\Omega}$ about $\\boldsymbol{\\Omega}$ is $\\frac{q_0 d^3r'}{4\\pi} d\\boldsymbol{\\Omega}$. We can express the volume element as $d^3r' = dA ds$, where $dA$ is the differential area perpendicular to the path. The source emission per unit path length $ds$, per unit area $dA$, and per unit solid angle is $\\frac{q_0}{4\\pi} ds$.\n\nThe probability that a neutron emitted from $\\mathbf{r}'$ travels the distance $s$ to $\\mathbf{r}$ without being absorbed is given by the survival probability $P(s) = \\exp(-\\Sigma_a s)$, derived in the first part.\n\nThe contribution $d\\psi$ to the angular flux at $(\\mathbf{r}, \\boldsymbol{\\Omega})$ from the source in the differential path length $ds$ at distance $s$ is the product of the source strength per unit area and solid angle, and the survival probability:\n$$\nd\\psi(\\mathbf{r},\\boldsymbol{\\Omega}) = \\left(\\frac{q_0}{4\\pi} ds\\right) \\exp(-\\Sigma_a s)\n$$\nTo obtain the total angular flux, we integrate this contribution over all possible distances $s$ from which a neutron could have originated. Since the medium is infinite, we integrate from $s=0$ to $s=\\infty$:\n$$\n\\psi(\\mathbf{r},\\boldsymbol{\\Omega}) = \\int_0^\\infty \\frac{q_0}{4\\pi} \\exp(-\\Sigma_a s) ds\n$$\nThis is the characteristic integral representation for the angular flux.\n\n**3. Computation of the Scalar Flux $\\phi(\\mathbf{r})$**\n\nThe scalar flux $\\phi(\\mathbf{r})$ is defined as the integral of the angular flux $\\psi(\\mathbf{r},\\boldsymbol{\\Omega})$ over all solid angles:\n$$\n\\phi(\\mathbf{r}) = \\int_{4\\pi} \\psi(\\mathbf{r},\\boldsymbol{\\Omega}) d\\boldsymbol{\\Omega}\n$$\nSubstituting the expression for $\\psi(\\mathbf{r},\\boldsymbol{\\Omega})$:\n$$\n\\phi(\\mathbf{r}) = \\int_{4\\pi} \\left( \\int_0^\\infty \\frac{q_0}{4\\pi} \\exp(-\\Sigma_a s) ds \\right) d\\boldsymbol{\\Omega}\n$$\nThe integrand of the outer integral (over $d\\boldsymbol{\\Omega}$) is the inner integral (over $ds$). Let's evaluate the inner integral first. Since $q_0$, $\\Sigma_a$, and $4\\pi$ are constants, we have:\n$$\n\\int_0^\\infty \\frac{q_0}{4\\pi} \\exp(-\\Sigma_a s) ds = \\frac{q_0}{4\\pi} \\int_0^\\infty \\exp(-\\Sigma_a s) ds\n$$\nThe integral evaluates to:\n$$\n\\int_0^\\infty \\exp(-\\Sigma_a s) ds = \\left[ -\\frac{1}{\\Sigma_a} \\exp(-\\Sigma_a s) \\right]_0^\\infty = 0 - \\left(-\\frac{1}{\\Sigma_a}\\right) = \\frac{1}{\\Sigma_a}\n$$\nThis implies that the angular flux itself is constant and independent of both position $\\mathbf{r}$ and direction $\\boldsymbol{\\Omega}$:\n$$\n\\psi(\\mathbf{r},\\boldsymbol{\\Omega}) = \\frac{q_0}{4\\pi} \\left(\\frac{1}{\\Sigma_a}\\right) = \\frac{q_0}{4\\pi\\Sigma_a}\n$$\nThe uniformity in $\\mathbf{r}$ and isotropy in $\\boldsymbol{\\Omega}$ are direct consequences of the infinite, homogeneous medium and the uniform, isotropic source.\n\nNow, we substitute this constant value of the angular flux back into the definition of the scalar flux:\n$$\n\\phi(\\mathbf{r}) = \\int_{4\\pi} \\left( \\frac{q_0}{4\\pi\\Sigma_a} \\right) d\\boldsymbol{\\Omega}\n$$\nThe constant term can be factored out of the integral:\n$$\n\\phi(\\mathbf{r}) = \\frac{q_0}{4\\pi\\Sigma_a} \\int_{4\\pi} d\\boldsymbol{\\Omega}\n$$\nThe integral of the solid angle element $d\\boldsymbol{\\Omega}$ over the entire sphere is $4\\pi$:\n$$\n\\int_{4\\pi} d\\boldsymbol{\\Omega} = 4\\pi\n$$\nTherefore, the scalar flux is:\n$$\n\\phi(\\mathbf{r}) = \\frac{q_0}{4\\pi\\Sigma_a} (4\\pi) = \\frac{q_0}{\\Sigma_a}\n$$\nThe scalar flux $\\phi$ is constant throughout the medium. This result is physically intuitive: in an infinite medium with a uniform source, every point is equivalent, and for every neutron absorbed in a given volume, another is created, leading to a steady state where the local absorption rate per unit volume, $\\Sigma_a \\phi$, equals the local source rate per unit volume, $q_0$.",
            "answer": "$$ \\boxed{\\frac{q_{0}}{\\Sigma_{a}}} $$"
        },
        {
            "introduction": "Real-world fusion engineering problems are rarely simple enough for analytical solutions, necessitating the use of robust numerical methods. This practice dives into the heart of the Discrete Ordinates ($S_N$) method by tasking you with building a 1D transport sweep algorithm from the ground up . You will implement the diamond-difference spatial discretization scheme and a source iteration strategy, gaining direct experience with the computational logic of causality, upwinding, and convergence that underpins modern transport codes.",
            "id": "4020684",
            "problem": "Consider a one-dimensional slab of nondimensionalized length $L$ discretized into $N_x$ uniform cells, with $x \\in [0,L]$. The steady-state neutron transport equation in one-dimensional slab geometry for the angular flux $\\psi(x,\\mu)$ with direction cosine $\\mu \\in [-1,1]$ is given by the fundamental balance law: \n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = q + \\frac{\\Sigma_s}{2}\\,\\phi(x),\n$$\nwhere $\\Sigma_t$ is the nondimensionalized total cross section, $\\Sigma_s$ is the nondimensionalized scattering cross section, $q$ is a nondimensionalized isotropic internal source, and $\\phi(x)$ is the scalar flux defined by\n$$\n\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu)\\, d\\mu.\n$$\nUse the discrete ordinates method (discrete ordinates, $\\text{S}_N$) with Gaussian quadrature directions and weights $\\{\\mu_m, w_m\\}_{m=1}^{N}$ to approximate the angular integral in the scalar flux. Spatially discretize the angular transport equation using diamond-difference within each cell, and construct a transport sweep algorithm that respects causality and upwinding: for each discrete direction with $\\mu_m > 0$, sweep left-to-right; for each $\\mu_m < 0$, sweep right-to-left. Employ source iteration to handle isotropic scattering, and use consistent nondimensional units throughout (no physical units required).\n\nYour program must implement:\n- The discrete ordinates approximation with $N$ Gaussian quadrature directions.\n- Diamond-difference spatial discretization over a structured $1$D grid.\n- Correct upwind boundary conditions: vacuum boundaries set incoming angular flux to zero; incident boundaries set a prescribed incoming angular flux for directions entering the domain.\n- Source iteration to converge the scalar flux $\\phi(x)$.\n- Checks for causality and upwinding through qualitative metrics: nonnegativity of angular and cell-centered fluxes over the domain, and monotonicity of the scalar flux profile in boundary-driven absorptive cases.\n\nDesign the algorithm starting from the fundamental conservation law above and the definition of $\\phi(x)$, ensuring numerical causality (information propagates along characteristics) and proper upwinding. Do not introduce any shortcut formulas in the problem statement; derive all update relations based on the stated base laws.\n\nTest Suite:\nUse the following nondimensionalized parameter sets to validate different facets of the solution.\n\n- Test $1$ (scattering with internal source, vacuum boundaries, general case):\n  - $L = 5.0$, $N_x = 50$, $\\Sigma_t = 1.0$, $\\Sigma_s = 0.9$, $q = 0.2$,\n  - Left boundary: vacuum, Right boundary: vacuum,\n  - Quadrature: $\\text{S}_4$.\n\n- Test $2$ (left-incident beam, pure absorption, monotonicity and causality emphasis):\n  - $L = 2.0$, $N_x = 40$, $\\Sigma_t = 1.0$, $\\Sigma_s = 0.0$, $q = 0.0$,\n  - Left boundary: incident incoming angular flux amplitude $1.0$ for directions with $\\mu>0$, Right boundary: vacuum,\n  - Quadrature: $\\text{S}_4$.\n\n- Test $3$ (pure absorption with internal source, vacuum boundaries, baseline check):\n  - $L = 1.0$, $N_x = 20$, $\\Sigma_t = 2.0$, $\\Sigma_s = 0.0$, $q = 1.0$,\n  - Left boundary: vacuum, Right boundary: vacuum,\n  - Quadrature: $\\text{S}_2$.\n\n- Test $4$ (left-incident beam, highly coarse and optically thick pure absorber to stress diamond-difference positivity):\n  - $L = 10.0$, $N_x = 10$, $\\Sigma_t = 5.0$, $\\Sigma_s = 0.0$, $q = 0.0$,\n  - Left boundary: incident incoming angular flux amplitude $1.0$ for directions with $\\mu>0$, Right boundary: vacuum,\n  - Quadrature: $\\text{S}_4$.\n\nFor each test case, compute:\n- The scalar flux at the center cell index $\\lfloor N_x/2 \\rfloor$ as a floating-point number.\n- A boolean indicating whether all computed angular and cell-centered fluxes are nonnegative over the domain (nonnegativity flag).\n- A boolean indicating whether the scalar flux is nonincreasing from left to right (monotonicity flag), evaluated as a causality/upwinding indicator; this is most physically meaningful for boundary-driven absorptive cases.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list of three entries $[\\text{phi\\_center}, \\text{nonnegativity\\_flag}, \\text{monotonicity\\_flag}]$. For all four tests, print a list of these lists in the order given above, for example:\n$$\n[[\\text{t1\\_phi}, \\text{t1\\_nonneg}, \\text{t1\\_mono}], [\\text{t2\\_phi}, \\text{t2\\_nonneg}, \\text{t2\\_mono}], [\\text{t3\\_phi}, \\text{t3\\_nonneg}, \\text{t3\\_mono}], [\\text{t4\\_phi}, \\text{t4\\_nonneg}, \\text{t4\\_mono}]].\n$$\nAll numerical results are dimensionless floats or booleans. Your program must be fully self-contained and require no user input.",
            "solution": "The user has provided a well-posed problem in computational transport theory. The task is to implement a one-dimensional, steady-state discrete ordinates ($S_N$) solver with diamond-difference spatial discretization and source iteration.\n\nThe problem is valid as it is scientifically grounded in the principles of neutron transport, is well-posed with sufficient data and clear objectives, and is free of ambiguities or contradictions. We will proceed with a full derivation and solution.\n\n### 1. Derivation of the Discretized Transport Equation\n\nThe starting point is the one-dimensional, steady-state transport equation for the angular flux $\\psi(x,\\mu)$:\n$$\n\\mu \\frac{\\partial \\psi(x,\\mu)}{\\partial x} + \\Sigma_t \\psi(x,\\mu) = q + \\frac{\\Sigma_s}{2}\\,\\phi(x)\n$$\nwhere the scalar flux $\\phi(x)$ is defined as:\n$$\n\\phi(x) = \\int_{-1}^{1} \\psi(x,\\mu)\\, d\\mu\n$$\n\n#### 1.1. Discrete Ordinates ($S_N$) Approximation\n\nThe continuous angular variable $\\mu$ is replaced by a set of $N$ discrete directions $\\{\\mu_m\\}_{m=1}^N$ with corresponding weights $\\{w_m\\}_{m=1}^N$, obtained from a Gauss-Legendre quadrature rule. The integral for the scalar flux is approximated by a weighted sum:\n$$\n\\phi(x) \\approx \\sum_{m=1}^{N} w_m \\psi(x, \\mu_m) = \\sum_{m=1}^{N} w_m \\psi_m(x)\n$$\nThis transforms the single partial differential equation into a system of $N$ coupled ordinary differential equations, one for each discrete direction $\\mu_m$:\n$$\n\\mu_m \\frac{d \\psi_m(x)}{d x} + \\Sigma_t \\psi_m(x) = Q_m(x)\n$$\nwhere $\\psi_m(x) \\equiv \\psi(x, \\mu_m)$ and the source term $Q_m(x)$ is isotropic (independent of $m$):\n$$\nQ_m(x) = Q(x) = q + \\frac{\\Sigma_s}{2} \\phi(x) = q + \\frac{\\Sigma_s}{2} \\sum_{m'=1}^{N} w_{m'} \\psi_{m'}(x)\n$$\nThe coupling between directions occurs through the scattering term, which depends on the scalar flux $\\phi(x)$.\n\n#### 1.2. Spatial Discretization and the Diamond-Difference Relation\n\nThe spatial domain $x \\in [0, L]$ is discretized into $N_x$ uniform cells. Cell $i$ spans the interval $[x_{i-1/2}, x_{i+1/2}]$, with width $\\Delta x = L/N_x$ and center $x_i$. Integrating the ODE for direction $m$ over cell $i$ yields:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\left( \\mu_m \\frac{d \\psi_m(x)}{d x} + \\Sigma_t \\psi_m(x) \\right) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} Q(x) dx\n$$\n$$\n\\mu_m [\\psi_m(x_{i+1/2}) - \\psi_m(x_{i-1/2})] + \\Sigma_t \\int_{x_{i-1/2}}^{x_{i+1/2}} \\psi_m(x) dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} Q(x) dx\n$$\nWe introduce discrete variables: $\\psi_{m, i\\pm 1/2} = \\psi_m(x_{i\\pm 1/2})$ for edge fluxes and $\\psi_{m,i}$ for the cell-average flux. The source $Q(x)$ is assumed to be constant within the cell, $Q_i = q + \\frac{1}{2}\\Sigma_s \\phi_i$. The balance equation becomes:\n$$\n\\mu_m (\\psi_{m, i+1/2} - \\psi_{m, i-1/2}) + \\Sigma_t \\psi_{m,i} \\Delta x = Q_i \\Delta x\n$$\nThe diamond-difference scheme provides a closure relation by assuming a linear variation of the flux within the cell, which implies that the cell-center flux is the arithmetic mean of the cell-edge fluxes:\n$$\n\\psi_{m,i} = \\frac{\\psi_{m, i+1/2} + \\psi_{m, i-1/2}}{2} \\quad \\text{(Diamond Relation)}\n$$\nWe now have a system of two algebraic equations for each cell $i$ and direction $m$.\n\n#### 1.3. The Transport Sweep Algorithm\n\nThe solution proceeds by sweeping through the spatial mesh in the direction of neutron travel, respecting causality. This means the upwind flux (at the edge from which a neutron enters a cell) is known, and we solve for the cell-average flux and the downwind flux.\n\n**Case 1: $\\mu_m > 0$ (Left-to-Right Sweep)**\nThe incoming flux is at the left edge, $\\psi_{m,i-1/2}$. We solve for $\\psi_{m,i}$ and $\\psi_{m,i+1/2}$.\nFrom the diamond relation, we have $\\psi_{m, i+1/2} = 2\\psi_{m,i} - \\psi_{m,i-1/2}$. Substituting this into the balance equation:\n$$\n\\mu_m ((2\\psi_{m,i} - \\psi_{m,i-1/2}) - \\psi_{m,i-1/2}) + \\Sigma_t \\psi_{m,i} \\Delta x = Q_i \\Delta x\n$$\n$$\n(2\\mu_m + \\Sigma_t \\Delta x) \\psi_{m,i} = 2\\mu_m \\psi_{m,i-1/2} + Q_i \\Delta x\n$$\nThis gives the update formula for the cell-average flux:\n$$\n\\psi_{m,i} = \\frac{2\\mu_m \\psi_{m,i-1/2} + Q_i \\Delta x}{2\\mu_m + \\Sigma_t \\Delta x}\n$$\nThe outgoing flux is then found from the diamond relation:\n$$\n\\psi_{m,i+1/2} = 2\\psi_{m,i} - \\psi_{m,i-1/2}\n$$\n\n**Case 2: $\\mu_m < 0$ (Right-to-Left Sweep)**\nThe incoming flux is at the right edge, $\\psi_{m,i+1/2}$. We solve for $\\psi_{m,i}$ and $\\psi_{m,i-1/2}$.\nFrom the diamond relation, $\\psi_{m, i-1/2} = 2\\psi_{m,i} - \\psi_{m,i+1/2}$. Substituting this into the balance equation:\n$$\n\\mu_m (\\psi_{m,i+1/2} - (2\\psi_{m,i} - \\psi_{m,i+1/2})) + \\Sigma_t \\psi_{m,i} \\Delta x = Q_i \\Delta x\n$$\n$$\n(2\\mu_m - \\Sigma_t \\Delta x) \\psi_{m,i} = 2\\mu_m \\psi_{m,i+1/2} - Q_i \\Delta x\n$$\nSince $\\mu_m < 0$, we can rewrite this using $|\\mu_m| = -\\mu_m$:\n$$\n(-2|\\mu_m| - \\Sigma_t \\Delta x) \\psi_{m,i} = -2|\\mu_m| \\psi_{m,i+1/2} - Q_i \\Delta x\n$$\n$$\n(2|\\mu_m| + \\Sigma_t \\Delta x) \\psi_{m,i} = 2|\\mu_m| \\psi_{m,i+1/2} + Q_i \\Delta x\n$$\nThis gives the update formula for the cell-average flux:\n$$\n\\psi_{m,i} = \\frac{2|\\mu_m| \\psi_{m,i+1/2} + Q_i \\Delta x}{2|\\mu_m| + \\Sigma_t \\Delta x} = \\frac{-2\\mu_m \\psi_{m,i+1/2} + Q_i \\Delta x}{-2\\mu_m + \\Sigma_t \\Delta x}\n$$\nThe outgoing flux is then found from the diamond relation:\n$$\n\\psi_{m,i-1/2} = 2\\psi_{m,i} - \\psi_{m,i+1/2}\n$$\n\n### 2. Source Iteration Scheme\n\nThe source term $Q_i = q + \\frac{1}{2}\\Sigma_s \\phi_i$ depends on the scalar flux $\\phi_i$, which in turn depends on all angular fluxes $\\psi_{m,i}$. This inter-dependency is resolved using source iteration.\n\nLet $k$ be the iteration index.\n1.  **Initialize**: Make an initial guess for the scalar flux, e.g., $\\phi_i^{(0)} = 0$ for all cells $i$.\n2.  **Iterate**: For $k=1, 2, \\dots$ until convergence:\n    a.  **Compute Source**: Calculate the total source using the scalar flux from the previous iteration, $\\phi^{(k-1)}$:\n        $$ Q_i^{(k)} = q + \\frac{\\Sigma_s}{2} \\phi_i^{(k-1)} $$\n    b.  **Transport Sweep**: For each discrete direction $\\mu_m$, perform a full spatial sweep using the appropriate boundary conditions and the update formulas derived above to calculate the angular fluxes $\\psi_{m,i}^{(k)}$ for all cells $i$.\n    c.  **Update Scalar Flux**: Compute the new scalar flux:\n        $$ \\phi_i^{(k)} = \\sum_{m=1}^{N} w_m \\psi_{m,i}^{(k)} $$\n    d.  **Check Convergence**: The process terminates when the relative difference between successive scalar flux iterates is below a specified tolerance $\\epsilon$:\n        $$ \\frac{\\|\\phi^{(k)} - \\phi^{(k-1)}\\|_2}{\\|\\phi^{(k)}\\|_2} < \\epsilon $$\n\n### 3. Boundary Conditions\n\nBoundary conditions are applied to the incoming angular fluxes at the domain edges.\n-   **Vacuum Boundary**: The incoming angular flux is zero.\n    -   At $x=0$: $\\psi_{m, -1/2} = 0$ for all $\\mu_m > 0$.\n    -   At $x=L$: $\\psi_{m, N_x-1/2} = 0$ for all $\\mu_m < 0$. (Note: my implementation uses indices $0, ..., N_x$, so the right boundary is at index $N_x$)\n-   **Incident Boundary**: The incoming angular flux has a prescribed value.\n    -   At $x=0$: $\\psi_{m, -1/2} = \\text{Amplitude}$ for all $\\mu_m > 0$.\n\n### 4. Qualitative Metrics\n\nThe problem requires checking two qualitative metrics:\n-   **Non-negativity**: All computed angular fluxes ($\\psi_{m,i}$ and $\\psi_{m, i\\pm 1/2}$) must be non-negative. Diamond-difference is known to fail this condition for optically thick cells ($\\Sigma_t \\Delta x \\gg 1$), producing unphysical negative fluxes.\n-   **Monotonicity**: For purely absorbing, boundary-driven problems, the scalar flux $\\phi(x)$ is expected to be a non-increasing function of $x$. This is checked by verifying if $\\phi_i \\geq \\phi_{i+1}$ for all $i$.\n\nThe implementation will now follow this derived structure.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    # Test Suite:\n    # (L, Nx, sigma_t, sigma_s, q, left_bc_type, left_bc_val, right_bc_type, right_bc_val, N)\n    test_cases = [\n        # Test 1: Scattering with internal source, vacuum boundaries\n        {'L': 5.0, 'Nx': 50, 'sigma_t': 1.0, 'sigma_s': 0.9, 'q': 0.2, \n         'left_bc': ('vacuum', 0.0), 'right_bc': ('vacuum', 0.0), 'N_quad': 4},\n        \n        # Test 2: Left-incident beam, pure absorption\n        {'L': 2.0, 'Nx': 40, 'sigma_t': 1.0, 'sigma_s': 0.0, 'q': 0.0, \n         'left_bc': ('incident', 1.0), 'right_bc': ('vacuum', 0.0), 'N_quad': 4},\n\n        # Test 3: Pure absorption with internal source\n        {'L': 1.0, 'Nx': 20, 'sigma_t': 2.0, 'sigma_s': 0.0, 'q': 1.0, \n         'left_bc': ('vacuum', 0.0), 'right_bc': ('vacuum', 0.0), 'N_quad': 2},\n\n        # Test 4: Coarse, optically thick pure absorber to test diamond-difference positivity\n        {'L': 10.0, 'Nx': 10, 'sigma_t': 5.0, 'sigma_s': 0.0, 'q': 0.0, \n         'left_bc': ('incident', 1.0), 'right_bc': ('vacuum', 0.0), 'N_quad': 4}\n    ]\n\n    results = []\n    for params in test_cases:\n        result = run_transport_solve(**params)\n        results.append(result)\n\n    # Format the final output string manually to avoid spaces and use correct boolean representation\n    output_strings = []\n    for res in results:\n        # res is a list like [phi_val, nonneg_flag, mono_flag]\n        s = f\"[{res[0]},{res[1]},{res[2]}]\"\n        output_strings.append(s)\n    \n    final_string = f\"[{','.join(output_strings)}]\"\n    print(final_string)\n\ndef run_transport_solve(L, Nx, sigma_t, sigma_s, q, left_bc, right_bc, N_quad):\n    \"\"\"\n    Solves the 1D steady-state neutron transport equation for a given set of parameters.\n    \"\"\"\n    # 1. Grid and Quadrature Setup\n    dx = L / Nx\n    mus, weights = np.polynomial.legendre.leggauss(N_quad)\n    \n    # Indices for positive and negative directions\n    pos_mu_indices = np.where(mus > 0)[0]\n    neg_mu_indices = np.where(mus < 0)[0]\n\n    # 2. Initialization\n    phi = np.zeros(Nx)\n    psi_center = np.zeros((N_quad, Nx))\n    psi_edge = np.zeros((N_quad, Nx + 1))\n    \n    # Iteration parameters\n    TOLERANCE = 1e-8\n    MAX_ITERATIONS = 2000\n    \n    # 3. Source Iteration Loop\n    for k in range(MAX_ITERATIONS):\n        phi_old = np.copy(phi)\n        \n        # Calculate isotropic scattering source from previous iteration's flux\n        scattering_source = 0.5 * sigma_s * phi_old\n        total_source = q + scattering_source  # Array of size Nx\n\n        # 3a. Transport Sweeps for all discrete ordinates\n        # Positive mu (Left-to-Right Sweep)\n        for m in pos_mu_indices:\n            mu_m = mus[m]\n            \n            # Apply left boundary condition\n            if left_bc[0] == 'vacuum':\n                psi_edge[m, 0] = 0.0\n            elif left_bc[0] == 'incident':\n                psi_edge[m, 0] = left_bc[1]\n            \n            # Sweep through spatial cells\n            for i in range(Nx):\n                psi_incoming = psi_edge[m, i]\n                Q_i = total_source[i]\n                \n                # Diamond-difference update for cell-center flux\n                psi_center[m, i] = (2.0 * mu_m * psi_incoming + Q_i * dx) / (2.0 * mu_m + sigma_t * dx)\n                \n                # Diamond relation for outgoing edge flux\n                psi_edge[m, i + 1] = 2.0 * psi_center[m, i] - psi_incoming\n\n        # Negative mu (Right-to-Left Sweep)\n        for m in neg_mu_indices:\n            mu_m = mus[m]  # This value is negative\n            \n            # Apply right boundary condition\n            if right_bc[0] == 'vacuum':\n                psi_edge[m, Nx] = 0.0\n            elif right_bc[0] == 'incident':\n                psi_edge[m, Nx] = right_bc[1]\n            \n            # Sweep through spatial cells (in reverse)\n            for i in range(Nx - 1, -1, -1):\n                psi_incoming = psi_edge[m, i + 1]\n                Q_i = total_source[i]\n\n                # Diamond-difference update (using -mu_m makes the term positive)\n                psi_center[m, i] = (-2.0 * mu_m * psi_incoming + Q_i * dx) / (-2.0 * mu_m + sigma_t * dx)\n                \n                # Diamond relation for outgoing edge flux\n                psi_edge[m, i] = 2.0 * psi_center[m, i] - psi_incoming\n\n        # 3b. Update Scalar Flux\n        phi = np.dot(weights, psi_center)\n        \n        # 3c. Check for Convergence\n        phi_norm = np.linalg.norm(phi)\n        if phi_norm > 0:\n            error = np.linalg.norm(phi - phi_old) / phi_norm\n        else:\n            error = np.linalg.norm(phi - phi_old) # For pure vacuum problems\n        \n        if error < TOLERANCE:\n            break\n\n    # 4. Post-processing and Metric Calculation\n    center_idx = int(np.floor(Nx / 2))\n    phi_center_val = phi[center_idx]\n    \n    # Check non-negativity for all computed fluxes\n    nonnegativity_flag = bool(np.all(psi_center >= 0.0) and np.all(psi_edge >= 0.0))\n    \n    # Check monotonicity (non-increasing profile) of the scalar flux\n    # np.diff(phi)[i] = phi[i+1] - phi[i]. We need this to be <= 0.\n    # Use a small tolerance for floating point comparisons.\n    monotonicity_flag = bool(np.all(np.diff(phi) <= 1e-9))\n\n    return [phi_center_val, nonnegativity_flag, monotonicity_flag]\n\nsolve()\n```",
            "answer": "[[2.593796593922718,True,False],[0.1584969245136979,True,True],[0.3703270404097419,True,False],[0.002241530939527961,False,True]]"
        }
    ]
}