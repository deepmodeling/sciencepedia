{
    "hands_on_practices": [
        {
            "introduction": "在分析氚渗透问题时，首要步骤是量化氚在材料中的溶解能力。本练习将引导你从热力学平衡的基本原理出发，推导气体压力与溶解浓度之间的基本关系（即西弗茨定律, Sieverts' law），并将其应用于具体情景，计算钨中的氚溶解度。这项实践为所有后续的输运计算奠定了核心基础 。",
            "id": "4058630",
            "problem": "一块体心立方 (BCC) 钨膜暴露于总压 $p = 100$ Pa、温度 $T = 800$ K 的纯氚气 $\\mathrm{T_2}$ 环境中。假设为稀溶液条件，溶解的氚原子独立地占据间隙位置，气体为理想气体，且界面处于热力学平衡状态。从解离反应 $\\mathrm{T_2(g)} \\rightleftharpoons 2\\,\\mathrm{T(s)}$ 的化学势相等条件以及固溶体的理想混合形式出发，推导钨中溶解氚的数密度 $n_T$ 对气体压力 $p$ 和温度 $T$ 的依赖关系。已知溶解度因子遵循阿伦尼乌斯形式\n$$S(T) = S_0 \\exp\\!\\left(-\\frac{E_S}{k_B T}\\right),$$\n其中 $S_0 = 2.0 \\times 10^{21}$ m$^{-3}$ Pa$^{-1/2}$，$E_S = 1.30$ eV，$k_B$ 是玻尔兹曼常数。使用这些数据，计算在给定 $p$ 和 $T$ 条件下溶解氚的数密度 $n_T$（以 m$^{-3}$ 为单位）。使用精确值 $k_B = 1.380649 \\times 10^{-23}$ J/K 和 $1$ eV $= 1.602176634 \\times 10^{-19}$ J。将最终数值答案四舍五入至三位有效数字，并以 m$^{-3}$ 为单位表示。",
            "solution": "这个问题需要分两步解答。首先，我们必须从基本热力学原理出发，推导出溶解氚的数密度 $n_T$、气体压力 $p$ 和温度 $T$ 之间的关系。其次，我们必须利用这个关系和所提供的数据来计算 $n_T$ 的数值。\n\n该系统处于热力学平衡状态，这意味着参与反应的物种的化学势是平衡的。氚气分子解离并被固态钨吸收的反应如下：\n$$ \\mathrm{T_2(g)} \\rightleftharpoons 2\\,\\mathrm{T(s)} $$\n其中 $\\mathrm{T_2(g)}$ 代表气相中的一个氚分子，$\\mathrm{T(s)}$ 代表溶解在固相（钨）中的一个氚原子。该反应的化学平衡条件是：\n$$ \\mu_{\\mathrm{T_2, gas}} = 2 \\mu_{\\mathrm{T, solid}} $$\n其中 $\\mu_{\\mathrm{T_2, gas}}$ 是气相中氚分子的化学势，$\\mu_{\\mathrm{T, solid}}$ 是溶解在固体中氚原子的化学势。\n\n假设氚气为理想气体，其化学势可以写成：\n$$ \\mu_{\\mathrm{T_2, gas}}(T, p) = \\mu_{\\mathrm{T_2, gas}}^0(T) + k_B T \\ln\\left(\\frac{p}{p^0}\\right) $$\n其中 $\\mu_{\\mathrm{T_2, gas}}^0(T)$ 是气体在温度 $T$ 和参考压力 $p^0$ (为方便起见，可设 $p^0 = 1$ Pa) 下的标准化学势，$k_B$ 是玻尔兹曼常数。\n\n溶解在固体中的氚原子的化学势由将一个原子置于间隙位置的焓和在可用位置上排列原子的熵决定。对于稀溶液，化学势由下式给出：\n$$ \\mu_{\\mathrm{T, solid}}(T, n_T) = \\mu_{\\mathrm{T, solid}}^\\infty(T) + k_B T \\ln\\left(\\frac{n_T}{n_{sites}}\\right) $$\n其中 $\\mu_{\\mathrm{T, solid}}^\\infty(T)$ 是无限稀释时的标准化学势（包括焓和振动的贡献），$n_T$ 是溶解氚原子的数密度，$n_{sites}$ 是钨晶格中可用间隙位置的数密度。$\\ln(n_T/n_{sites})$ 项源于稀溶液（$n_T \\ll n_{sites}$）的理想混合熵。\n\n现在，我们将这些表达式代入平衡条件：\n$$ \\mu_{\\mathrm{T_2, gas}}^0(T) + k_B T \\ln(p) = 2 \\left[ \\mu_{\\mathrm{T, solid}}^\\infty(T) + k_B T \\ln\\left(\\frac{n_T}{n_{sites}}\\right) \\right] $$\n重新整理各项以求解 $n_T$：\n$$ k_B T \\ln(p) - 2 k_B T \\ln\\left(\\frac{n_T}{n_{sites}}\\right) = 2 \\mu_{\\mathrm{T, solid}}^\\infty(T) - \\mu_{\\mathrm{T_2, gas}}^0(T) $$\n$$ \\ln(p) - \\ln\\left(\\left(\\frac{n_T}{n_{sites}}\\right)^2\\right) = \\frac{2 \\mu_{\\mathrm{T, solid}}^\\infty(T) - \\mu_{\\mathrm{T_2, gas}}^0(T)}{k_B T} $$\n$$ \\ln\\left(\\frac{p \\cdot n_{sites}^2}{n_T^2}\\right) = \\frac{\\Delta G_{sol}^0(T)}{k_B T} $$\n其中 $\\Delta G_{sol}^0(T) = 2 \\mu_{\\mathrm{T, solid}}^\\infty(T) - \\mu_{\\mathrm{T_2, gas}}^0(T)$ 是每 $\\mathrm{T_2}$ 分子的标准溶解吉布斯自由能。\n对两边取指数：\n$$ \\frac{p \\cdot n_{sites}^2}{n_T^2} = \\exp\\left(\\frac{\\Delta G_{sol}^0(T)}{k_B T}\\right) $$\n求解 $n_T$：\n$$ n_T^2 = p \\cdot n_{sites}^2 \\cdot \\exp\\left(-\\frac{\\Delta G_{sol}^0(T)}{k_B T}\\right) $$\n$$ n_T = \\sqrt{p} \\left[ n_{sites} \\exp\\left(-\\frac{\\Delta G_{sol}^0(T)}{2 k_B T}\\right) \\right] $$\n这个推导表明，溶解氚的数密度 $n_T$ 与气体压力 $p$ 的平方根成正比，这一关系被称为 Sieverts 定律。方括号中的项仅是温度的函数，定义为溶解度 $S(T)$：\n$$ S(T) = n_{sites} \\exp\\left(-\\frac{\\Delta G_{sol}^0(T)}{2 k_B T}\\right) $$\n因此，我们推导出了关系式 $n_T = S(T)\\sqrt{p}$。\n\n题目提供了一个经验性的阿伦尼乌斯形式的溶解度公式：\n$$ S(T) = S_0 \\exp\\left(-\\frac{E_S}{k_B T}\\right) $$\n其中 $S_0$ 是指前因子，$E_S$ 是溶解能。通过将推导出的 $S(T)$ 形式与经验形式进行比较，我们可以将 $S_0$ 和 $E_S$ 与其背后的热力学量联系起来。具体来说，$E_S$ 对应于每 $\\mathrm{T_2}$ 分子标准溶解焓的一半。\n\n现在，我们进行数值计算。\n题目给出：\n气体压力, $p = 100$ Pa。\n温度, $T = 800$ K。\n溶解度指前因子, $S_0 = 2.0 \\times 10^{21}$ m$^{-3}$ Pa$^{-1/2}$。\n溶解能, $E_S = 1.30$ eV。\n玻尔兹曼常数, $k_B = 1.380649 \\times 10^{-23}$ J/K。\n能量转换, $1$ eV $= 1.602176634 \\times 10^{-19}$ J。\n\n数密度的最终表达式为：\n$$ n_T = S_0 \\exp\\left(-\\frac{E_S}{k_B T}\\right) \\sqrt{p} $$\n\n首先，我们计算无量纲指数 $\\frac{E_S}{k_B T}$。我们必须使用一致的单位（国际单位制）。\n将 $E_S$ 从 eV 转换为焦耳：\n$$ E_S = 1.30 \\text{ eV} \\times \\frac{1.602176634 \\times 10^{-19} \\text{ J}}{1 \\text{ eV}} = 2.0828296242 \\times 10^{-19} \\text{ J} $$\n计算热能 $k_B T$：\n$$ k_B T = (1.380649 \\times 10^{-23} \\text{ J/K}) \\times (800 \\text{ K}) = 1.1045192 \\times 10^{-20} \\text{ J} $$\n现在，计算指数：\n$$ \\frac{E_S}{k_B T} = \\frac{2.0828296242 \\times 10^{-19} \\text{ J}}{1.1045192 \\times 10^{-20} \\text{ J}} \\approx 18.857683 $$\n接下来，我们计算溶解度 $S(T)$：\n$$ S(T) = (2.0 \\times 10^{21} \\text{ m}^{-3} \\text{Pa}^{-1/2}) \\times \\exp(-18.857683) $$\n$$ S(T) \\approx (2.0 \\times 10^{21}) \\times (6.46010 \\times 10^{-9}) \\text{ m}^{-3} \\text{Pa}^{-1/2} $$\n$$ S(T) \\approx 1.29202 \\times 10^{13} \\text{ m}^{-3} \\text{Pa}^{-1/2} $$\n最后，我们计算溶解氚的数密度 $n_T$：\n$$ n_T = S(T) \\sqrt{p} = (1.29202 \\times 10^{13} \\text{ m}^{-3} \\text{Pa}^{-1/2}) \\times \\sqrt{100 \\text{ Pa}} $$\n$$ n_T = (1.29202 \\times 10^{13} \\text{ m}^{-3} \\text{Pa}^{-1/2}) \\times (10 \\text{ Pa}^{1/2}) $$\n$$ n_T \\approx 1.29202 \\times 10^{14} \\text{ m}^{-3} $$\n题目要求答案四舍五入到三位有效数字。\n$$ n_T \\approx 1.29 \\times 10^{14} \\text{ m}^{-3} $$",
            "answer": "$$ \\boxed{1.29 \\times 10^{14}} $$"
        },
        {
            "introduction": "在建立了扩散系数 $D$ 和溶解度 $S$ 的概念之后，我们便可以模拟氚在材料中随时间的迁移过程。本练习要求你运用解析方法求解一个经典的扩散场景下的菲克定律（Fick's laws），从而推导出随时间变化的渗透通量。掌握这项技能对于预测聚变装置中氚的穿透时间和释放速率至关重要 。",
            "id": "4058537",
            "problem": "我们考虑一个由体心立方金属（例如钨合金）制成的厚度为 $L$ 的平板，其在一维坐标 $x \\in [0,L]$ 上发生扩散。该平板初始不含氚，因此对于所有 $x \\in (0,L)$，氢同位素浓度 $c(x,0)=0$。在时间 $t \\ge 0$ 时，位于 $x=0$ 的上游表面突然暴露于压力恒为 $p_1$ 的含氚气体中，而位于 $x=L$ 的下游表面则保持压力 $p_2=0$。假设在固定温度下为等温条件，使得氚扩散系数 $D$ 和 Sieverts 常数 $K$ 在体相中不随时间变化且空间均匀。在每个表面，界面平衡遵循 Sieverts 定律，即 $c_s = K \\sqrt{p}$，因此对于所有 $t \\ge 0$，有 $c(0,t) = K \\sqrt{p_1}$ 和 $c(L,t) = 0$。不存在体相捕获、对流和反应，输运过程完全由扩散控制。\n\n从 Fick 第二定律和 Fick 第一定律出发，利用特征函数展开法求解具有给定初始条件和边界条件的相应偏微分方程（PDE），推导出在 $x=L$ 处的瞬态下游摩尔通量 $J(t)$ 的闭合形式级数表达式，其中 $J(t) \\equiv -D \\, \\partial c/\\partial x\\vert_{x=L}$。请用 $D$、$K$、$p_1$、$L$ 和 $t$ 将最终答案表示为单一解析表达式。将 $J(t)$ 表述为精确的解析级数；不要提供任何数值近似。您的最终答案应代表摩尔通量（物理单位为 mol m$^{-2}$ s$^{-1}$），但必须按要求以符号形式提供表达式。",
            "solution": "该问题陈述已经过验证，被认为是输运现象学中一个适定且有科学依据的问题。它提出了一个具有特定初始条件和边界条件的经典一维扩散场景，该问题可以解析求解。\n\n平板内氚的输运受一维扩散的 Fick 第二定律控制：\n$$\n\\frac{\\partial c(x,t)}{\\partial t} = D \\frac{\\partial^2 c(x,t)}{\\partial x^2}\n$$\n其中 $c(x,t)$ 是位置 $x$ 和时间 $t$ 处的氚浓度，$D$ 是扩散系数。问题定义在域 $x \\in [0, L]$ 和时间 $t \\ge 0$ 上。\n\n初始条件和边界条件如下：\n初始条件 (IC)：对于 $x \\in (0,L)$，$c(x,0) = 0$。\n边界条件 (BCs)：对于 $t \\ge 0$，\n$c(0,t) = K \\sqrt{p_1}$，其中 $K$ 是 Sieverts 常数，$p_1$ 是上游气体压力。\n$c(L,t) = 0$。\n\n边界条件是非齐次的。为求解此线性偏微分方程（PDE），我们采用叠加原理。解 $c(x,t)$ 可以表示为稳态解 $c_{ss}(x)$ 和瞬态解 $c_{tr}(x,t)$ 的和：\n$$\nc(x,t) = c_{ss}(x) + c_{tr}(x,t)\n$$\n稳态解 $c_{ss}(x)$ 是长时间极限（$t \\to \\infty$）下的解，此时浓度分布不再随时间变化，即 $\\frac{\\partial c}{\\partial t} = 0$。稳态的控制偏微分方程简化为常微分方程：\n$$\n\\frac{d^2 c_{ss}}{dx^2} = 0\n$$\n通解是 $x$ 的线性函数：$c_{ss}(x) = Ax + B$。常数 $A$ 和 $B$ 通过应用边界条件来确定，稳态解也必须满足这些边界条件：\n$c_{ss}(0) = B = K \\sqrt{p_1}$\n$c_{ss}(L) = AL + B = 0 \\implies A = - \\frac{B}{L} = - \\frac{K \\sqrt{p_1}}{L}$\n因此，稳态浓度分布为：\n$$\nc_{ss}(x) = K \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right)\n$$\n现在，我们为瞬态部分 $c_{tr}(x,t)$ 建立问题。将 $c(x,t) = c_{ss}(x) + c_{tr}(x,t)$ 代入原始偏微分方程，并利用 $c(x,t)$ 和 $c_{ss}(x)$ 都满足扩散方程这一事实，我们发现 $c_{tr}(x,t)$ 也必须满足齐次扩散方程：\n$$\n\\frac{\\partial c_{tr}}{\\partial t} = D \\frac{\\partial^2 c_{tr}}{\\partial x^2}\n$$\n$c_{tr}(x,t)$ 的边界条件变为齐次的：\n$c(0,t) = c_{ss}(0) + c_{tr}(0,t) = K \\sqrt{p_1} \\implies c_{tr}(0,t) = 0$\n$c(L,t) = c_{ss}(L) + c_{tr}(L,t) = 0 \\implies c_{tr}(L,t) = 0$\n瞬态分量的初始条件由总的初始条件得出：\n$c(x,0) = c_{ss}(x) + c_{tr}(x,0) = 0 \\implies c_{tr}(x,0) = -c_{ss}(x) = -K \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right)$\n\n$c_{tr}(x,t)$ 的问题是一个具有齐次边界条件的齐次偏微分方程，可以使用分离变量法（或特征函数展开法）求解。我们寻求形式为 $c_{tr}(x,t) = X(x)T(t)$ 的解。将其代入偏微分方程得到：\n$$\n\\frac{1}{D} \\frac{T'(t)}{T(t)} = \\frac{X''(x)}{X(x)} = -\\lambda^2\n$$\n其中 $-\\lambda^2$ 是分离常数。这得到两个常微分方程：\n$T'(t) + D \\lambda^2 T(t) = 0 \\implies T(t) = C \\exp(-D \\lambda^2 t)$\n$X''(x) + \\lambda^2 X(x) = 0 \\implies X(x) = C_1 \\sin(\\lambda x) + C_2 \\cos(\\lambda x)$\n\n对 $X(x)$ 应用齐次边界条件：\n$X(0) = 0 \\implies C_2 = 0$\n$X(L) = 0 \\implies C_1 \\sin(\\lambda L) = 0$。为得到非平凡解（$C_1 \\ne 0$），我们需要 $\\sin(\\lambda L) = 0$，这意味着对于整数 $n$，有 $\\lambda L = n \\pi$。\n特征值为 $\\lambda_n = \\frac{n \\pi}{L}$，其中 $n = 1, 2, 3, \\dots$。相应的特征函数为 $X_n(x) = \\sin\\left(\\frac{n \\pi x}{L}\\right)$。\n\n一般瞬态解是所有可能解的叠加：\n$$\nc_{tr}(x,t) = \\sum_{n=1}^{\\infty} B_n \\sin\\left(\\frac{n \\pi x}{L}\\right) \\exp\\left(-D \\left(\\frac{n \\pi}{L}\\right)^2 t\\right)\n$$\n系数 $B_n$ 是根据 $c_{tr}(x,t)$ 的初始条件，利用正弦函数的正交性确定的。这是 $c_{tr}(x,0)$ 的傅里叶正弦级数展开：\n$$\nc_{tr}(x,0) = \\sum_{n=1}^{\\infty} B_n \\sin\\left(\\frac{n \\pi x}{L}\\right) = -K \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right)\n$$\n系数 $B_n$ 通过积分计算：\n$$\nB_n = \\frac{2}{L} \\int_0^L c_{tr}(x,0) \\sin\\left(\\frac{n \\pi x}{L}\\right) dx = \\frac{2}{L} \\int_0^L \\left[-K \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right)\\right] \\sin\\left(\\frac{n \\pi x}{L}\\right) dx\n$$\n$$\nB_n = -\\frac{2K \\sqrt{p_1}}{L} \\left[ \\int_0^L \\sin\\left(\\frac{n \\pi x}{L}\\right) dx - \\frac{1}{L} \\int_0^L x \\sin\\left(\\frac{n \\pi x}{L}\\right) dx \\right]\n$$\n计算积分：\n$\\int_0^L \\sin\\left(\\frac{n \\pi x}{L}\\right) dx = \\left[-\\frac{L}{n \\pi} \\cos\\left(\\frac{n \\pi x}{L}\\right)\\right]_0^L = -\\frac{L}{n \\pi}(\\cos(n\\pi) - 1) = \\frac{L}{n \\pi}(1 - (-1)^n)$\n$\\int_0^L x \\sin\\left(\\frac{n \\pi x}{L}\\right) dx = \\left[-\\frac{Lx}{n \\pi} \\cos\\left(\\frac{n \\pi x}{L}\\right) + \\left(\\frac{L}{n \\pi}\\right)^2 \\sin\\left(\\frac{n \\pi x}{L}\\right)\\right]_0^L = -\\frac{L^2}{n \\pi}\\cos(n\\pi) = -\\frac{L^2}{n \\pi}(-1)^n$\n将这些结果代回 $B_n$ 的表达式中：\n$$\nB_n = -\\frac{2K \\sqrt{p_1}}{L} \\left[ \\frac{L}{n \\pi}(1 - (-1)^n) - \\frac{1}{L}\\left(-\\frac{L^2}{n \\pi}(-1)^n\\right) \\right]\n$$\n$$\nB_n = -\\frac{2K \\sqrt{p_1}}{L} \\left[ \\frac{L}{n \\pi} - \\frac{L(-1)^n}{n \\pi} + \\frac{L(-1)^n}{n \\pi} \\right] = -\\frac{2K \\sqrt{p_1}}{L} \\left(\\frac{L}{n \\pi}\\right) = -\\frac{2K \\sqrt{p_1}}{n \\pi}\n$$\n浓度分布 $c(x,t)$ 的完整解是：\n$$\nc(x,t) = K \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right) - \\frac{2K \\sqrt{p_1}}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n \\pi x}{L}\\right) \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right)\n$$\n问题要求在 $x=L$ 处的下游摩尔通量 $J(t)$。通量由 Fick 第一定律定义：$J(t) = -D \\frac{\\partial c}{\\partial x}\\big|_{x=L}$。\n首先，我们求浓度梯度 $\\frac{\\partial c}{\\partial x}$：\n$$\n\\frac{\\partial c}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ K \\sqrt{p_1} \\left(1 - \\frac{x}{L}\\right) - \\frac{2K \\sqrt{p_1}}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\sin\\left(\\frac{n \\pi x}{L}\\right) \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right) \\right]\n$$\n$$\n\\frac{\\partial c}{\\partial x} = -\\frac{K \\sqrt{p_1}}{L} - \\frac{2K \\sqrt{p_1}}{\\pi} \\sum_{n=1}^{\\infty} \\frac{1}{n} \\left(\\frac{n \\pi}{L}\\right) \\cos\\left(\\frac{n \\pi x}{L}\\right) \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right)\n$$\n$$\n\\frac{\\partial c}{\\partial x} = -\\frac{K \\sqrt{p_1}}{L} - \\frac{2K \\sqrt{p_1}}{L} \\sum_{n=1}^{\\infty} \\cos\\left(\\frac{n \\pi x}{L}\\right) \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right)\n$$\n现在，在下游表面 $x=L$ 处计算梯度：\n$$\n\\frac{\\partial c}{\\partial x}\\bigg|_{x=L} = -\\frac{K \\sqrt{p_1}}{L} - \\frac{2K \\sqrt{p_1}}{L} \\sum_{n=1}^{\\infty} \\cos(n \\pi) \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right)\n$$\n由于 $\\cos(n \\pi) = (-1)^n$，上式变为：\n$$\n\\frac{\\partial c}{\\partial x}\\bigg|_{x=L} = -\\frac{K \\sqrt{p_1}}{L} \\left[ 1 + 2 \\sum_{n=1}^{\\infty} (-1)^n \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right) \\right]\n$$\n最后，下游通量 $J(t)$ 为：\n$$\nJ(t) = -D \\left( -\\frac{K \\sqrt{p_1}}{L} \\left[ 1 + 2 \\sum_{n=1}^{\\infty} (-1)^n \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right) \\right] \\right)\n$$\n$$\nJ(t) = \\frac{D K \\sqrt{p_1}}{L} \\left[ 1 + 2 \\sum_{n=1}^{\\infty} (-1)^n \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right) \\right]\n$$\n这就是瞬态下游通量的最终闭合形式级数表达式。",
            "answer": "$$\n\\boxed{\\frac{D K \\sqrt{p_1}}{L} \\left( 1 + 2 \\sum_{n=1}^{\\infty} (-1)^n \\exp\\left(-\\frac{D n^2 \\pi^2 t}{L^2}\\right) \\right)}\n$$"
        },
        {
            "introduction": "在实际工程应用中，材料的物性参数通常不是先验已知的，而必须通过实验来确定。最后的这项练习模拟了这一过程，指导你开发一个计算工具，利用模拟的实验数据（渗透通量和时间延迟）来确定扩散系数和溶解度的阿伦尼乌斯（Arrhenius）参数。这项任务综合了物理建模、数值优化和不确定性分析，构成了一个完整的计算材料科学工作流程 。",
            "id": "4058637",
            "problem": "您的任务是根据瞬态和稳态组合实验，利用基本输运原理，为工程材料中的氚渗透特性构建一个计算估计器。氚被建模为在表面遵循解离吸附平衡的氢同位素。您的估计器必须对多个温度进行联合非线性回归，以推断以阿伦尼乌斯形式表示的扩散系数和溶解度的温度依赖性，然后传播不确定性，为指定报告温度下的这两个量提供置信区间。\n\n此任务的基本基础包括：Fick扩散第一和第二定律、一维空间中的质量守恒，以及根据Sieverts定律在表面溶解的氢浓度与气体压力之间的平衡关系。具体而言，一维摩尔通量密度定义为 $J = - D \\, \\partial c / \\partial x$，其中 $J$ 是摩尔通量密度（单位为 $\\text{mol} \\, \\text{m}^{-2} \\, \\text{s}^{-1}$），$D$ 是扩散系数（单位为 $\\text{m}^2 \\, \\text{s}^{-1}$），$c$ 是溶解的氢原子浓度（单位为 $\\text{mol} \\, \\text{m}^{-3}$），$x$ 是空间坐标（单位为 $\\text{m}$）。Sieverts定律将平衡溶解浓度与气体压力关联起来：$c = S \\, \\sqrt{p}$，其中 $p$ 是气体压力（单位为 $\\text{Pa}$），$S$ 是溶解度（单位为 $\\text{mol} \\, \\text{m}^{-3} \\, \\text{Pa}^{-1/2}$）。对于厚度为 $L$、上游压力为 $p_{\\text{in}}$、下游压力为 $p_{\\text{out}}$ 的薄膜，在瞬态效应衰减后，稳态渗透会产生一个穿过薄膜的恒定通量，该通量由Sieverts定律所蕴含的 $c$ 的边界值以及在 $L$ 上的恒定梯度驱动。上游边界发生阶跃变化后的瞬态“时间滞后”定义为下游穿透曲线线性渐近线的截距，并由相同边界条件下厚度为 $L$ 的平板中的Fick扩散所控制。\n\n假设扩散系数 $D(T)$ 和溶解度 $S(T)$ 的温度依赖性遵循阿伦尼乌斯型关系，\n$$\nD(T) = D_0 \\, \\exp\\!\\left(-\\frac{E_D}{R T}\\right), \\quad\nS(T) = S_0 \\, \\exp\\!\\left(-\\frac{E_S}{R T}\\right),\n$$\n其中 $D_0$ 是扩散的指前因子（单位为 $\\text{m}^2 \\, \\text{s}^{-1}$），$E_D$ 是扩散活化能（单位为 $\\text{J} \\, \\text{mol}^{-1}$），$S_0$ 是溶解度的指前因子（单位为 $\\text{mol} \\, \\text{m}^{-3} \\, \\text{Pa}^{-1/2}$），$E_S$ 是溶解活化能（单位为 $\\text{J} \\, \\text{mol}^{-1}$），$T$ 是绝对温度（单位为 $\\text{K}$），$R$ 是普适气体常数（单位为 $\\text{J} \\, \\text{mol}^{-1} \\, \\text{K}^{-1}$）。\n\n您的程序必须：\n- 使用所提供的稳态通量 $J$ 和瞬态时间滞后 $\\tau$ 的多温度测量数据，对阿伦尼乌斯参数 $\\theta = \\{\\ln D_0, E_D, \\ln S_0, E_S\\}$ 构建一个联合加权非线性最小二乘回归。加权必须使用为每个数据点提供的测量标准差，以形成由其不确定性归一化的残差。\n- 使用一维Fick平板模型以及在两个表面的Sieverts定律，将稳态通量 $J$ 与 $D(T)$、$S(T)$、$L$、$p_{\\text{in}}$ 和 $p_{\\text{out}}$ 关联起来，并将时间滞后 $\\tau$ 与 $D(T)$ 和 $L$ 关联起来。\n- 在加权最小二乘的标准渐近正态近似下，根据回归的雅可比矩阵和残差方差估计参数协方差矩阵。\n- 通过一阶（delta方法）线性化，传播参数不确定性，以获得在指定报告温度 $T^\\star$ 下 $D(T^\\star)$ 和 $S(T^\\star)$ 的 $95\\%$ 置信区间。\n\n科学真实性约束：\n- 所有量必须使用国际单位制 (SI) 处理。扩散系数必须以 $\\text{m}^2 \\, \\text{s}^{-1}$ 为单位报告。溶解度必须以 $\\text{mol} \\, \\text{m}^{-3} \\, \\text{Pa}^{-1/2}$ 为单位报告。温度必须以 $\\text{K}$ 为单位。压力必须以 $\\text{Pa}$ 为单位。时间滞后必须以 $\\text{s}$ 为单位。薄膜厚度必须以 $\\text{m}$ 为单位。\n\n测试套件和数据规范：\n对于每个测试用例，您将获得温度数组 $T_i$、上游和下游压力 $p_{\\text{in},i}$ 和 $p_{\\text{out},i}$、薄膜厚度 $L$、测量的稳态通量 $J^{\\text{meas}}_i$ 及其标准差 $\\sigma_{J,i}$，以及测量的时间滞后 $\\tau^{\\text{meas}}_i$ 及其标准差 $\\sigma_{\\tau,i}$。要使用的普适气体常数为 $R = 8.314 \\, \\text{J} \\, \\text{mol}^{-1} \\, \\text{K}^{-1}$。\n\n- 测试用例1（正常路径，中等压力，中等温度范围）：\n  - $T = [550, 650, 750]$\n  - $p_{\\text{in}} = [20000, 20000, 20000]$, $p_{\\text{out}} = [2000, 2000, 2000]$\n  - $L = 1.0 \\times 10^{-3}$\n  - $J^{\\text{meas}} = [8.95 \\times 10^{-7}, 2.51 \\times 10^{-6}, 5.95 \\times 10^{-6}]$\n  - $\\sigma_{J} = [4.48 \\times 10^{-8}, 1.26 \\times 10^{-7}, 2.98 \\times 10^{-7}]$ (代表 $5$ %的相对不确定度)\n  - $\\tau^{\\text{meas}} = [39.3, 17.5, 9.00]$\n  - $\\sigma_{\\tau} = [0.5, 0.5, 0.5]$\n  - 报告温度 $T^\\star = 650$。\n\n- 测试用例2（边缘情况，压力差小，通过时间滞后保证可辨识性）：\n  - $T = [600, 700, 800]$\n  - $p_{\\text{in}} = [9500, 10000, 11000]$, $p_{\\text{out}} = [9000, 9500, 10000]$\n  - $L = 1.0 \\times 10^{-3}$\n  - $J^{\\text{meas}} = [4.51 \\times 10^{-8}, 9.95 \\times 10^{-8}, 4.07 \\times 10^{-7}]$\n  - $\\sigma_{J} = [4.51 \\times 10^{-9}, 9.95 \\times 10^{-9}, 4.07 \\times 10^{-8}]$ (代表 $10$ %的相对不确定度)\n  - $\\tau^{\\text{meas}} = [25.75, 12.06, 7.19]$\n  - $\\sigma_{\\tau} = [0.4, 0.4, 0.4]$\n  - 报告温度 $T^\\star = 700$。\n\n- 测试用例3（边界情况，高温，大驱动力）：\n  - $T = [800, 900, 1000]$\n  - $p_{\\text{in}} = [20000, 20000, 20000]$, $p_{\\text{out}} = [1000, 1000, 1000]$\n  - $L = 1.0 \\times 10^{-3}$\n  - $J^{\\text{meas}} = [8.80 \\times 10^{-6}, 1.59 \\times 10^{-5}, 2.37 \\times 10^{-5}]$\n  - $\\sigma_{J} = [2.64 \\times 10^{-7}, 4.77 \\times 10^{-7}, 7.11 \\times 10^{-7}]$ (代表 $3$ %的相对不确定度)\n  - $\\tau^{\\text{meas}} = [6.76, 4.85, 3.26]$\n  - $\\sigma_{\\tau} = [0.2, 0.2, 0.2]$\n  - 报告温度 $T^\\star = 900$。\n\n答案规范：\n- 对于每个测试用例，计算 $D(T^\\star)$ 和 $S(T^\\star)$ 及其 $95$ %置信区间，使用通过一阶线性化传播的参数协方差。置信区间必须表示为每个量的下界和上界。\n- $D$ 以 $\\text{m}^2 \\, \\text{s}^{-1}$ 表示，$S$ 以 $\\text{mol} \\, \\text{m}^{-3} \\, \\text{Pa}^{-1/2}$ 表示。最终输出必须是不带单位字符串的数值浮点数，但它们必须对应指定的单位。\n- 您的程序应生成一行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个测试用例的结果本身是一个包含六个浮点数的列表，顺序为 $[D(T^\\star), S(T^\\star), D_{\\text{lo}}(T^\\star), D_{\\text{hi}}(T^\\star), S_{\\text{lo}}(T^\\star), S_{\\text{hi}}(T^\\star)]$。例如，输出格式必须为 $[[d_1,s_1,d_{1,\\text{lo}},d_{1,\\text{hi}},s_{1,\\text{lo}},s_{1,\\text{hi}}],[d_2,s_2,\\dots],[d_3,s_3,\\dots]]$ 的形式。",
            "solution": "该问题要求开发一种计算方法，从一组实验测量中估计材料中氚的扩散系数 $D$ 和溶解度 $S$ 及其不确定性。该估计是通过联合拟合在多个温度下进行的稳态渗透通量和瞬态时间滞后实验的数据来完成的。$D$ 和 $S$ 的温度依赖性使用阿伦尼乌斯关系建模。\n\n### 1. 物理和数学模型\n氚在材料中的输运由一维扩散模型描述。\n\n**可观测量的前向模型：**\n通过厚度为 $L$ 的薄膜的稳态摩尔通量密度 $J$ 由Fick第一定律和Sieverts定律控制。在稳态下，浓度分布 $c(x)$ 是线性的。边界浓度为 $c(0) = S\\sqrt{p_{\\text{in}}}$ 和 $c(L) = S\\sqrt{p_{\\text{out}}}$，通量为：\n$$\nJ = -D \\frac{\\partial c}{\\partial x} = -D \\frac{S\\sqrt{p_{\\text{out}}} - S\\sqrt{p_{\\text{in}}}}{L} = \\frac{D(T)S(T)}{L}(\\sqrt{p_{\\text{in}}} - \\sqrt{p_{\\text{out}}})\n$$\n通过平板扩散的瞬态时间滞后 $\\tau$ 与扩散系数通过一个公认的公式相关联：\n$$\n\\tau = \\frac{L^2}{6D(T)}\n$$\n这两个方程构成了前向模型，将物理参数 $D$ 和 $S$ 与实验可观测的量 $J$ 和 $\\tau$ 联系起来。\n\n**阿伦尼乌斯温度依赖性：**\n$D(T)$ 和 $S(T)$ 的温度依赖性由阿伦尼乌斯方程描述：\n$$\nD(T) = D_0 \\exp\\left(-\\frac{E_D}{RT}\\right) \\quad \\text{和} \\quad S(T) = S_0 \\exp\\left(-\\frac{E_S}{RT}\\right)\n$$\n其中 $D_0$ 和 $S_0$ 是指前因子，$E_D$ 和 $E_S$ 是活化能，$R$ 是普适气体常数，$T$ 是绝对温度。为保证数值稳定性并使指前因子线性化，我们使用它们的自然对数。因此，待估计的参数向量为 $\\vec{\\theta} = [\\ln D_0, E_D, \\ln S_0, E_S]^T$。用 $\\vec{\\theta}$ 表示，这些性质为：\n$$\n\\ln D(T; \\vec{\\theta}) = \\theta_1 - \\frac{\\theta_2}{RT} \\quad \\implies \\quad D(T; \\vec{\\theta}) = \\exp\\left(\\theta_1 - \\frac{\\theta_2}{RT}\\right)\n$$\n$$\n\\ln S(T; \\vec{\\theta}) = \\theta_3 - \\frac{\\theta_4}{RT} \\quad \\implies \\quad S(T; \\vec{\\theta}) = \\exp\\left(\\theta_3 - \\frac{\\theta_4}{RT}\\right)\n$$\n\n### 2. 通过加权非线性最小二乘 (WNLS) 进行参数估计\n我们给定一组 $N$ 个实验条件，每个条件都在一个温度 $T_i$ 下，提供通量 $J^{\\text{meas}}_i$ 和时间滞后 $\\tau^{\\text{meas}}_i$ 的测量值，以及相应的标准差 $\\sigma_{J,i}$ 和 $\\sigma_{\\tau,i}$。目标是找到参数向量 $\\vec{\\theta}$，使其能最好地同时拟合所有 $2N$ 个数据点。\n\n我们采用 WNLS 方法，该方法最小化加权残差平方和 $\\chi^2$。每个测量的残差是测量值与模型预测值之差，并由测量的标准差归一化。\n令所有模型预测值的向量为 $\\vec{y}_{\\text{model}}(\\vec{\\theta}) = [J_{\\text{model}}(T_1), \\dots, J_{\\text{model}}(T_N), \\tau_{\\text{model}}(T_1), \\dots, \\tau_{\\text{model}}(T_N)]^T$，测量向量为 $\\vec{y}_{\\text{meas}} = [J^{\\text{meas}}_1, \\dots, J^{\\text{meas}}_N, \\tau^{\\text{meas}}_1, \\dots, \\tau^{\\text{meas}}_N]^T$。相应的标准差向量为 $\\vec{\\sigma}$。\n加权残差向量为 $\\vec{r}(\\vec{\\theta})$，其分量为：\n$$\nr_i(\\vec{\\theta}) = \\frac{y_{\\text{meas},i} - y_{\\text{model},i}(\\vec{\\theta})}{\\sigma_i}\n$$\n目标是找到使成本函数 $\\chi^2(\\vec{\\theta})$ 最小化的 $\\vec{\\theta}_{\\text{opt}}$：\n$$\n\\vec{\\theta}_{\\text{opt}} = \\arg\\min_{\\vec{\\theta}} \\chi^2(\\vec{\\theta}) = \\arg\\min_{\\vec{\\theta}} \\sum_{i=1}^{2N} r_i(\\vec{\\theta})^2 = \\arg\\min_{\\vec{\\theta}} \\|\\vec{r}(\\vec{\\theta})\\|_2^2\n$$\n这是一个非线性优化问题，可以使用迭代算法（如Levenberg-Marquardt，在`scipy.optimize.least_squares`中实现）进行数值求解。\n\n### 3. 不确定性量化\n一旦找到最优参数向量 $\\vec{\\theta}_{\\text{opt}}$，我们必须量化其不确定性，并将其传播到指定报告温度 $T^\\star$ 下的导出量 $D(T^\\star)$ 和 $S(T^\\star)$。\n\n**参数协方差矩阵：**\n根据最小二乘法的渐近理论，估计参数的协方差矩阵 $\\text{Cov}(\\vec{\\theta})$ 可以从加权残差的雅可比矩阵近似得到。雅可比矩阵 $\\mathbf{J}$ 的元素为 $J_{ij} = \\partial r_i / \\partial \\theta_j$。协方差矩阵由以下公式给出：\n$$\n\\text{Cov}(\\vec{\\theta}_{\\text{opt}}) \\approx s^2 (\\mathbf{J}^T \\mathbf{J})^{-1}\n$$\n其中 $\\mathbf{J}$ 在 $\\vec{\\theta}_{\\text{opt}}$ 处求值，而 $s^2$ 是残差方差（或均方误差），是误差方差的估计量：\n$$\ns^2 = \\frac{\\chi^2_{\\text{min}}}{m-p} = \\frac{\\|\\vec{r}(\\vec{\\theta}_{\\text{opt}})\\|_2^2}{2N - 4}\n$$\n这里，$m=2N$ 是数据点的数量，$p=4$ 是参数的数量。$m-p$ 项代表拟合的自由度。\n\n**使用Delta方法进行不确定性传播：**\n为了找到参数函数 $f(\\vec{\\theta})$ 的不确定性，我们使用一阶泰勒展开（delta方法）。$f$ 的方差近似为：\n$$\n\\text{Var}(f(\\vec{\\theta})) \\approx (\\nabla f)^T \\text{Cov}(\\vec{\\theta}) (\\nabla f)\n$$\n其中 $\\nabla f$ 是 $f$ 关于 $\\vec{\\theta}$ 的梯度，在 $\\vec{\\theta}_{\\text{opt}}$ 处求值。\n\n对于 $D(T^\\star) = \\exp(\\theta_1 - \\theta_2 / (RT^\\star))$，梯度为：\n$$\n\\nabla D(T^\\star) = \\left[ \\frac{\\partial D}{\\partial\\theta_1}, \\frac{\\partial D}{\\partial\\theta_2}, \\frac{\\partial D}{\\partial\\theta_3}, \\frac{\\partial D}{\\partial\\theta_4} \\right]^T = \\left[ D(T^\\star), -\\frac{D(T^\\star)}{RT^\\star}, 0, 0 \\right]^T\n$$\n对于 $S(T^\\star) = \\exp(\\theta_3 - \\theta_4 / (RT^\\star))$，梯度为：\n$$\n\\nabla S(T^\\star) = \\left[ \\frac{\\partial S}{\\partial\\theta_1}, \\frac{\\partial S}{\\partial\\theta_2}, \\frac{\\partial S}{\\partial\\theta_3}, \\frac{\\partial S}{\\partial\\theta_4} \\right]^T = \\left[ 0, 0, S(T^\\star), -\\frac{S(T^\\star)}{RT^\\star} \\right]^T\n$$\n然后标准差为 $\\sigma_D = \\sqrt{\\text{Var}(D(T^\\star))}$ 和 $\\sigma_S = \\sqrt{\\text{Var}(S(T^\\star))}$。\n\n**置信区间：**\n假设其估计量近似服从正态分布，可以为某个量（例如 $D(T^\\star)$）构建一个 $95\\%$ 的置信区间。该区间为：\n$$\n[D_{\\text{lo}}(T^\\star), D_{\\text{hi}}(T^\\star)] = [D(T^\\star) - z_{\\alpha/2} \\sigma_D, D(T^\\star) + z_{\\alpha/2} \\sigma_D]\n$$\n其中 $z_{\\alpha/2}$ 是标准正态分布在 $95\\%$ 置信水平（即 $\\alpha=0.05$）下的临界值。$z_{0.025} \\approx 1.95996$。为 $S(T^\\star)$ 构建类似的区间。\n\n这完成了估计过程的理论框架。实施将对每个提供的测试用例遵循这些步骤。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves for diffusion and solubility parameters from permeation data\n    and calculates confidence intervals at a reporting temperature.\n    \"\"\"\n    R = 8.314  # J / (mol * K)\n\n    test_cases = [\n        {\n            \"T\": np.array([550, 650, 750]),\n            \"p_in\": np.array([20000, 20000, 20000]),\n            \"p_out\": np.array([2000, 2000, 2000]),\n            \"L\": 1.0e-3,\n            \"J_meas\": np.array([8.95e-7, 2.51e-6, 5.95e-6]),\n            \"sigma_J\": np.array([4.48e-8, 1.26e-7, 2.98e-7]),\n            \"tau_meas\": np.array([39.3, 17.5, 9.00]),\n            \"sigma_tau\": np.array([0.5, 0.5, 0.5]),\n            \"T_star\": 650,\n            \"initial_theta\": [-13.7, 25000, -4.5, 7000]\n        },\n        {\n            \"T\": np.array([600, 700, 800]),\n            \"p_in\": np.array([9500, 10000, 11000]),\n            \"p_out\": np.array([9000, 9500, 10000]),\n            \"L\": 1.0e-3,\n            \"J_meas\": np.array([4.51e-8, 9.95e-8, 4.07e-7]),\n            \"sigma_J\": np.array([4.51e-9, 9.95e-9, 4.07e-8]),\n            \"tau_meas\": np.array([25.75, 12.06, 7.19]),\n            \"sigma_tau\": np.array([0.4, 0.4, 0.4]),\n            \"T_star\": 700,\n            \"initial_theta\": [-13.7, 25000, -4.9, 5500]\n        },\n        {\n            \"T\": np.array([800, 900, 1000]),\n            \"p_in\": np.array([20000, 20000, 20000]),\n            \"p_out\": np.array([1000, 1000, 1000]),\n            \"L\": 1.0e-3,\n            \"J_meas\": np.array([8.80e-6, 1.59e-5, 2.37e-5]),\n            \"sigma_J\": np.array([2.64e-7, 4.77e-7, 7.11e-7]),\n            \"tau_meas\": np.array([6.76, 4.85, 3.26]),\n            \"sigma_tau\": np.array([0.2, 0.2, 0.2]),\n            \"T_star\": 900,\n            \"initial_theta\": [-13.0, 30000, -4.0, 15000]\n        }\n    ]\n\n    all_results = []\n    z_score = norm.ppf(0.975)\n\n    for case in test_cases:\n        T = case[\"T\"]\n        p_in, p_out = case[\"p_in\"], case[\"p_out\"]\n        L, T_star = case[\"L\"], case[\"T_star\"]\n        J_meas, sigma_J = case[\"J_meas\"], case[\"sigma_J\"]\n        tau_meas, sigma_tau = case[\"tau_meas\"], case[\"sigma_tau\"]\n        \n        y_meas = np.concatenate([J_meas, tau_meas])\n        sigma_y = np.concatenate([sigma_J, sigma_tau])\n\n        def model(theta, T_vals, p_in_vals, p_out_vals, L_val):\n            ln_D0, E_D, ln_S0, E_S = theta\n            D_vals = np.exp(ln_D0 - E_D / (R * T_vals))\n            S_vals = np.exp(ln_S0 - E_S / (R * T_vals))\n            \n            J_model = (D_vals * S_vals / L_val) * (np.sqrt(p_in_vals) - np.sqrt(p_out_vals))\n            tau_model = L_val**2 / (6 * D_vals)\n            \n            return np.concatenate([J_model, tau_model])\n\n        def residuals(theta, T_vals, p_in_vals, p_out_vals, L_val, y_meas, sigma_y):\n            y_model = model(theta, T_vals, p_in_vals, p_out_vals, L_val)\n            return (y_meas - y_model) / sigma_y\n        \n        res = least_squares(\n            residuals,\n            case[\"initial_theta\"],\n            args=(T, p_in, p_out, L, y_meas, sigma_y),\n            jac='2-point'\n        )\n        theta_opt = res.x\n\n        # Parameter Covariance\n        jac = res.jac\n        chi2 = np.sum(res.fun**2)\n        m = len(y_meas)\n        p = len(theta_opt)\n        dof = m - p\n        \n        # Residual variance scaling\n        res_var = chi2 / dof if dof > 0 else 1.0\n        cov_matrix = res_var * np.linalg.inv(jac.T @ jac)\n\n        # Propagate uncertainty to D(T*) and S(T*)\n        ln_D0_opt, E_D_opt, ln_S0_opt, E_S_opt = theta_opt\n        \n        # Calculate D(T*) and its variance\n        D_star = np.exp(ln_D0_opt - E_D_opt / (R * T_star))\n        grad_D = np.array([D_star, -D_star / (R * T_star), 0, 0])\n        var_D = grad_D.T @ cov_matrix @ grad_D\n        std_D = np.sqrt(var_D)\n        \n        D_lo = D_star - z_score * std_D\n        D_hi = D_star + z_score * std_D\n        \n        # Calculate S(T*) and its variance\n        S_star = np.exp(ln_S0_opt - E_S_opt / (R * T_star))\n        grad_S = np.array([0, 0, S_star, -S_star / (R * T_star)])\n        var_S = grad_S.T @ cov_matrix @ grad_S\n        std_S = np.sqrt(var_S)\n\n        S_lo = S_star - z_score * std_S\n        S_hi = S_star + z_score * std_S\n        \n        all_results.append([D_star, S_star, D_lo, D_hi, S_lo, S_hi])\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}