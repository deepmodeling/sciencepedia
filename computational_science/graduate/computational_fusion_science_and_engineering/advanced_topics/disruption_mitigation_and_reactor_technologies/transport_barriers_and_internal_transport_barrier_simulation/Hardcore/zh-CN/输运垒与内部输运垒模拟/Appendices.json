{
    "hands_on_practices": [
        {
            "introduction": "内部输运垒（ITB）形成的核心原理是剪切抑制湍流。本练习  将通过一个简化的解析模型来探索这一原理，它将外部控制器（中性束注入，NBI）与径向电场（$E_r$）的产生以及由此产生的 $E \\times B$ 速度剪切联系起来。通过推导形成输运垒所需的阈值力矩，您将对所需的外部驱动与必须被抑制的湍流之间的平衡获得具体、定量的理解，从而掌握我们如何主动控制等离子体输运的基本方法。",
            "id": "4056882",
            "problem": "在磁约束等离子体中，当电场叉磁场（$E \\times B$）剪切率抑制了微观湍流涡时，可以观察到内部输运垒。考虑一个简化的圆柱形托卡马克模型，其中中性束注入（NBI）驱动环向旋转，从而改变径向电场。假设以下物理模型和参数：\n\n- 磁场主要由均匀的环向分量 $B_{\\phi}$ 和均匀的极向分量 $B_{\\theta}$ 构成。\n- 径向电场 $E_{r}$ 遵循稳态离子径向力平衡，其中离子压力梯度和极向流可以忽略不计，因此 $E_{r}(r) \\approx V_{\\phi}(r)\\,B_{\\theta}$，其中 $V_{\\phi}(r)$ 是环向流速。\n- 局域 $E \\times B$ 速度为 $v_{E}(r) = E_{r}(r)/B_{\\phi}$，$E \\times B$ 剪切率定义为 $\\gamma_{E}(r) = \\left|\\frac{d v_{E}}{d r}\\right|$。\n- 当 $\\gamma_{E}$ 等于给定的线性微观不稳定性增长率 $\\gamma_{c}$ 时，即 $\\gamma_{E} = \\gamma_{c}$，输运垒形成。\n- 在稳态下，径向宽度为 $\\Delta r$ 的剪切层中满足一维环向动量平衡，其中由NBI扭矩产生的动量源密度 $S_{\\phi}$ 与环向动量的粘性扩散相平衡：$S_{\\phi} \\approx \\rho\\,\\nu_{\\phi}\\,\\frac{d^{2} V_{\\phi}}{d r^{2}}$，其中 $\\rho = m_{i}\\,n_{i}$ 是离子质量密度，$m_{i}$ 是离子质量，$n_{i}$ 是离子数密度，$\\nu_{\\phi}$ 是有效环向动量扩散系数。\n- 使用标度近似 $\\frac{d^{2} V_{\\phi}}{d r^{2}} \\sim \\frac{V_{\\phi}}{\\Delta r^{2}}$ 和 $\\frac{d V_{\\phi}}{d r} \\sim \\frac{V_{\\phi}}{\\Delta r}$。\n\n给定以下参数：\n- $B_{\\phi} = 2.5\\ \\mathrm{T}$，\n- $B_{\\theta} = 0.25\\ \\mathrm{T}$，\n- $\\Delta r = 0.020\\ \\mathrm{m}$，\n- $n_{i} = 7.5 \\times 10^{19}\\ \\mathrm{m}^{-3}$，\n- 氘离子质量 $m_{i} = 3.344 \\times 10^{-27}\\ \\mathrm{kg}$，\n- $\\nu_{\\phi} = 1.2\\ \\mathrm{m}^{2}\\mathrm{s}^{-1}$，\n- $\\gamma_{c} = 8.0 \\times 10^{4}\\ \\mathrm{s}^{-1}$，\n\n请从第一性原理出发，推导在该模型中实现 $\\gamma_{E} = \\gamma_{c}$ 所需的阈值NBI动量源密度 $S_{\\phi}^{\\mathrm{th}}$ 的表达式，然后计算其数值。将最终答案表示为扭矩密度，单位为 $\\mathrm{N}\\ \\mathrm{m}^{-3}$，并四舍五入到三位有效数字。",
            "solution": "问题陈述有效。所提出的模型是 $E \\times B$ 剪切驱动的内部输运垒形成机制的一个简化但物理上自洽的表示。所有必要的参数和关系均已提供。\n\n阈值NBI动量源密度 $S_{\\phi}^{\\mathrm{th}}$ 的推导过程如下。\n\n首先，我们将 $E \\times B$ 剪切率 $\\gamma_{E}$ 用环向流速 $V_{\\phi}(r)$ 表示。$E \\times B$ 速度 $v_{E}$ 由下式给出：\n$$v_{E}(r) = \\frac{E_{r}(r)}{B_{\\phi}}$$\n该模型提供了一个简化的径向力平衡方程来确定径向电场 $E_{r}(r)$：\n$$E_{r}(r) \\approx V_{\\phi}(r)B_{\\theta}$$\n将 $E_{r}(r)$ 的表达式代入 $v_{E}(r)$ 的方程，我们得到：\n$$v_{E}(r) \\approx \\frac{V_{\\phi}(r)B_{\\theta}}{B_{\\phi}}$$\n$E \\times B$ 剪切率 $\\gamma_{E}$ 定义为 $v_{E}(r)$ 径向导数的绝对值：\n$$\\gamma_{E}(r) = \\left|\\frac{d v_{E}}{d r}\\right|$$\n由于 $B_{\\phi}$ 和 $B_{\\theta}$ 给定为均匀的，因此它们被视为关于径向坐标 $r$ 的常数：\n$$\\gamma_{E}(r) = \\left|\\frac{d}{dr}\\left(\\frac{V_{\\phi}(r)B_{\\theta}}{B_{\\phi}}\\right)\\right| = \\frac{B_{\\theta}}{B_{\\phi}}\\left|\\frac{d V_{\\phi}}{d r}\\right|$$\n问题指定在剪切层宽度 $\\Delta r$ 上使用标度近似 $\\frac{d V_{\\phi}}{d r} \\sim \\frac{V_{\\phi}}{\\Delta r}$。应用此近似，我们得到 $\\gamma_{E}$ 的标度关系：\n$$\\gamma_{E} \\sim \\frac{B_{\\theta}}{B_{\\phi}}\\frac{V_{\\phi}}{\\Delta r}$$\n\n当 $E \\times B$ 剪切率达到临界微观不稳定性增长率 $\\gamma_{c}$ 时，内部输运垒形成。这个条件，$\\gamma_{E} = \\gamma_{c}$，定义了输运垒形成所需的阈值环向流速 $V_{\\phi}^{\\mathrm{th}}$。\n$$\\frac{B_{\\theta}}{B_{\\phi}}\\frac{V_{\\phi}^{\\mathrm{th}}}{\\Delta r} = \\gamma_{c}$$\n求解 $V_{\\phi}^{\\mathrm{th}}$ 可得：\n$$V_{\\phi}^{\\mathrm{th}} = \\gamma_{c} \\Delta r \\frac{B_{\\phi}}{B_{\\theta}}$$\n\n接下来，我们使用所提供的稳态环向动量平衡方程，将环向流 $V_{\\phi}$ 与动量源密度 $S_{\\phi}$ 联系起来：\n$$S_{\\phi} \\approx \\rho \\nu_{\\phi} \\frac{d^{2} V_{\\phi}}{d r^{2}}$$\n其中 $\\rho = m_{i}n_{i}$ 是离子质量密度。我们对二阶导数使用标度近似 $\\frac{d^{2} V_{\\phi}}{d r^{2}} \\sim \\frac{V_{\\phi}}{\\Delta r^{2}}$。动量平衡方程于是变为：\n$$S_{\\phi} \\sim \\rho \\nu_{\\phi} \\frac{V_{\\phi}}{\\Delta r^{2}}$$\n\n阈值动量源密度 $S_{\\phi}^{\\mathrm{th}}$ 是维持阈值速度 $V_{\\phi}^{\\mathrm{th}}$ 所需的源。我们将 $V_{\\phi}^{\\mathrm{th}}$ 的表达式代入 $S_{\\phi}$ 的标度关系中，求得 $S_{\\phi}^{\\mathrm{th}}$：\n$$S_{\\phi}^{\\mathrm{th}} \\sim \\rho \\nu_{\\phi} \\frac{V_{\\phi}^{\\mathrm{th}}}{\\Delta r^{2}} = \\rho \\nu_{\\phi} \\frac{1}{\\Delta r^{2}} \\left(\\gamma_{c} \\Delta r \\frac{B_{\\phi}}{B_{\\theta}}\\right)$$\n简化此表达式，得到阈值动量源密度的最终符号公式：\n$$S_{\\phi}^{\\mathrm{th}} = \\frac{\\rho \\nu_{\\phi} \\gamma_{c} B_{\\phi}}{B_{\\theta} \\Delta r}$$\n\n现在，我们使用给定的参数计算 $S_{\\phi}^{\\mathrm{th}}$ 的数值。首先，我们计算离子质量密度 $\\rho$：\n$$\\rho = m_{i} n_{i} = (3.344 \\times 10^{-27}\\ \\mathrm{kg}) \\times (7.5 \\times 10^{19}\\ \\mathrm{m}^{-3}) = 2.508 \\times 10^{-7}\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$$\n将所有数值代入 $S_{\\phi}^{\\mathrm{th}}$ 的表达式中：\n$$B_{\\phi} = 2.5\\ \\mathrm{T}$$\n$$B_{\\theta} = 0.25\\ \\mathrm{T}$$\n$$\\Delta r = 0.020\\ \\mathrm{m}$$\n$$\\nu_{\\phi} = 1.2\\ \\mathrm{m}^{2}\\mathrm{s}^{-1}$$\n$$\\gamma_{c} = 8.0 \\times 10^{4}\\ \\mathrm{s}^{-1}$$\n$$S_{\\phi}^{\\mathrm{th}} = \\frac{(2.508 \\times 10^{-7}\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}) (1.2\\ \\mathrm{m}^{2}\\mathrm{s}^{-1}) (8.0 \\times 10^{4}\\ \\mathrm{s}^{-1}) (2.5\\ \\mathrm{T})}{(0.25\\ \\mathrm{T}) (0.020\\ \\mathrm{m})}$$\n单位为 $(\\mathrm{kg}\\ \\mathrm{m}^{-3}) (\\mathrm{m}^{2}\\mathrm{s}^{-1}) (\\mathrm{s}^{-1}) (\\mathrm{T}) / (\\mathrm{T}\\ \\mathrm{m}) = \\mathrm{kg}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-2}$，这对应于 $\\mathrm{N}\\ \\mathrm{m}^{-3}$。题目中提到的“扭矩密度”，其指定单位为 $\\mathrm{N}\\ \\mathrm{m}^{-3}$，指的就是这个力密度。\n$$S_{\\phi}^{\\mathrm{th}} = \\frac{6.0192 \\times 10^{-2}}{0.005} \\ \\mathrm{N}\\ \\mathrm{m}^{-3}$$\n$$S_{\\phi}^{\\mathrm{th}} = 12.0384\\ \\mathrm{N}\\ \\mathrm{m}^{-3}$$\n根据要求，将结果四舍五入到三位有效数字，得到：\n$$S_{\\phi}^{\\mathrm{th}} \\approx 12.0\\ \\mathrm{N}\\ \\mathrm{m}^{-3}$$",
            "answer": "$$ \\boxed{12.0} $$"
        },
        {
            "introduction": "在掌握了剪切抑制的基本概念之后，我们现在转向对湍流输运更真实的描述。在实际情况中，输运并非简单的“开启”或“关闭”，而是各种等离子体参数的连续函数。本练习  将指导您实现一个简化的准线性输运模型，这是聚变模拟中的常用工具。您将通过编程来体现热扩散系数（$\\chi$）如何源于各种物理效应的竞争：温度和密度梯度（ITG/TEM模）的驱动，以及磁剪切和 $E \\times B$ 剪切的抑制。这项计算实践将揭示复杂的输运物理如何被转化为大型模拟程序的基本模块，从而提高您建模和解释输运现象的能力。",
            "id": "4056830",
            "problem": "考虑一个简化的准线性输运闭合模型，以估算具有内部输运垒（ITB）的托卡马克等离子体中的离子和电子热扩散系数。目标是利用一个带有剪切抑制的简化准线性混合长度模型，根据给定的无量纲输入 $R/L_T$、$R/L_n$、$\\hat{s}$ 和 $\\gamma_E$，计算以 gyro-Bohm 单位归一化的离子和电子热扩散系数，分别表示为 $\\chi_i$ 和 $\\chi_e$。该任务还要求根据一个定量准则，识别输运垒形成的区域。\n\n您的程序必须实现以下建模假设，这些假设源于第一性原理和广泛使用的简化物理闭合模型：\n\n1. 基本基础与归一化：\n   - 准线性扩散系数通过混合长度闭合模型估算，其中退相关时间是有效增长率的倒数，径向相关长度由特征垂直波数的倒数设定。这意味着一个标度关系 $\\chi \\sim \\tau_c^{-1} \\ell_c^2$，其中 $\\tau_c$ 是相关时间，$\\ell_c$ 是相关长度。\n   - 以 gyro-Bohm 单位对输运进行归一化，使得输出的 $\\chi_i$ 和 $\\chi_e$ 是无量纲的。\n   - 假设一个固定的副法向波数 $k_y \\rho_s = 0.3$，其中 $\\rho_s$ 是离子声回旋半径。使用该值来设定特征抗磁频率标度和垂直波数标度。\n   - 使用磁剪切依赖性对有效垂直波数进行建模，即 $k_\\perp \\rho_s = k_y \\rho_s \\sqrt{1 + \\hat{s}^2}$。\n\n2. 线性驱动与阈值：\n   - 考虑两种微观不稳定性分支：离子温度梯度（ITG）模和捕获电子模（TEM）。\n   - ITG 模由 $R/L_T$ 超过一个依赖于剪切的临界梯度驱动。TEM 模由 $R/L_n$ 超过一个依赖于剪切的临界梯度驱动。假设阈值如下：\n     - $(R/L_T)_{\\mathrm{crit}}(\\hat{s}) = 2.0 + 1.0 \\, \\hat{s}$,\n     - $(R/L_n)_{\\mathrm{crit}}(\\hat{s}) = 1.0 + 0.5 \\, \\hat{s}$.\n   - 在所采用的归一化中，令特征抗磁频率标度由 $\\omega_* = k_y \\rho_s$ 设定。\n\n3. 有效线性增长率与剪切抑制：\n   - ITG 和 TEM 分支的无剪切线性增长率与相应梯度超过其阈值的量成正比：\n     - $\\gamma_{\\mathrm{ITG,lin}} = \\omega_* \\, \\max\\{ 0, \\, (R/L_T) - (R/L_T)_{\\mathrm{crit}}(\\hat{s}) \\}$,\n     - $\\gamma_{\\mathrm{TEM,lin}} = \\omega_* \\, \\max\\{ 0, \\, (R/L_n) - (R/L_n)_{\\mathrm{crit}}(\\hat{s}) \\}$.\n   - ExB（电场叉乘磁场）剪切率 $\\gamma_E$ 通过线性退相关来降低有效增长：\n     - $\\gamma_{\\mathrm{eff}} = \\max\\{ 0, \\, \\gamma_{\\mathrm{lin}} - \\gamma_E \\}$.\n\n4. 分离各粒子种类的扩散系数与交叉耦合：\n   - 对于离子，将其输运与 ITG 分支关联：\n     - $\\gamma_{i,\\mathrm{eff}} = \\max\\{ 0, \\, \\gamma_{\\mathrm{ITG,lin}} - \\gamma_E \\}$.\n   - 对于电子，允许来自两个分支的贡献，其中来自 ITG 分支的交叉耦合分数为固定值 $\\alpha = 0.3$：\n     - $\\gamma_{e,\\mathrm{lin}} = \\max\\{ \\gamma_{\\mathrm{TEM,lin}}, \\, \\alpha \\, \\gamma_{\\mathrm{ITG,lin}} \\}$,\n     - $\\gamma_{e,\\mathrm{eff}} = \\max\\{ 0, \\, \\gamma_{e,\\mathrm{lin}} - \\gamma_E \\}$.\n\n5. 混合长度闭合：\n   - 采用混合长度前因子 $C_{\\mathrm{mix}} = 0.5$ 并使用上述垂直波数模型。计算各粒子种类的扩散系数如下：\n     - $\\chi_i = C_{\\mathrm{mix}} \\, \\gamma_{i,\\mathrm{eff}} / (k_\\perp \\rho_s)^2$,\n     - $\\chi_e = C_{\\mathrm{mix}} \\, \\gamma_{e,\\mathrm{eff}} / (k_\\perp \\rho_s)^2$.\n\n6. 输运垒识别准则：\n   - 定义当 $\\chi_i$ 和 $\\chi_e$ 两者都严格小于 $\\chi_{\\mathrm{bar}} = 0.05$（无量纲，以 gyro-Bohm 单位计）时，形成输运垒。当输运垒形成时返回一个等于 $1$ 的输运垒标志，否则返回 $0$。\n\n7. 数值与单位：\n   - 所有输入均为无量纲。输出 $\\chi_i$ 和 $\\chi_e$ 必须以 gyro-Bohm 归一化单位（无量纲）报告。\n   - 在最终输出中，将 $\\chi_i$ 和 $\\chi_e$ 四舍五入到六位小数。\n\n8. 测试套件：\n   - 您的程序必须评估以下有序测试用例，每个用例指定为 [$R/L_T$, $R/L_n$, $\\hat{s}$, $\\gamma_E$]：\n     - $ [ 8.0, \\, 2.5, \\, 0.5, \\, 1.8 ] $\n     - $ [ 6.0, \\, 2.0, \\, 0.2, \\, 0.1 ] $\n     - $ [ 2.6, \\, 1.2, \\, 0.5, \\, 0.05 ] $\n     - $ [ 4.0, \\, 1.5, \\, 2.0, \\, 0.3 ] $\n     - $ [ 3.0, \\, 3.0, \\, 0.3, \\, 0.2 ] $\n\n9. 最终输出格式：\n   - 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个元素对应一个测试用例，并且其本身必须是 [$\\chi_i, \\chi_e, b$] 形式的列表，其中 $b$ 是整数形式的输运垒标志。例如：\n   - `[ [$\\chi_{i,1}, \\chi_{e,1}, b_1$], [$\\chi_{i,2}, \\chi_{e,2}, b_2$], \\dots ]`.\n\n您的任务是：实现一个完整的程序，根据上述建模假设，为每个指定的测试用例计算 $\\chi_i$、$\\chi_e$ 和输运垒标志，并完全按照所述格式打印最终的汇总结果行。不应从用户读取任何输入。所有常数和模型选择必须完全按照规定实现。",
            "solution": "该问题提出了一个有效的、适定的计算任务，其基础是等离子体物理和聚变科学的原理。它要求实现一个简化的准线性输运模型，以计算托卡马克等离子体中的离子和电子热扩散系数。该模型捕捉了关键物理过程，包括由温度和密度梯度驱动的不稳定性、临界梯度阈值、磁剪切效应以及由$E \\times B$速度剪切引起的输运抑制。该问题是自洽的，所有必要的方程、常数和输入参数都已指定。我们将基于这些指定的原理，进行分步求解。\n\n问题的核心是，对于一组给定的无量纲等离子体参数：归一化温度梯度 $R/L_T$、归一化密度梯度 $R/L_n$、磁剪切 $\\hat{s}$ 和归一化的 $E \\times B$ 剪切率 $\\gamma_E$，计算以 gyro-Bohm 单位归一化的离子热扩散系数 $\\chi_i$ 和电子热扩散系数 $\\chi_e$，以及一个输运垒标志 $b$。\n\n算法过程直接遵循所概述的物理模型：\n\n1.  **基本常数与标度**：该模型建立在几个固定参数之上。\n    -   假设一个特征副法向波数 $k_y \\rho_s = 0.3$，其中 $\\rho_s$ 是离子声回旋半径。在我们的归一化单位中，该值设定了抗磁频率的标度，我们表示为 $\\omega_* = k_y \\rho_s = 0.3$。\n    -   混合长度前因子为 $C_{\\mathrm{mix}} = 0.5$。\n    -   ITG 驱动的输运耦合到电子通道的交叉耦合分数为 $\\alpha = 0.3$。\n    -   输运垒由扩散系数阈值 $\\chi_{\\mathrm{bar}} = 0.05$ 定义。\n\n2.  **磁几何效应**：湍流输运受磁场几何结构的影响，特别是磁剪切 $\\hat{s}$。\n    -   有效垂直波数 $k_\\perp$ 被建模为受磁剪切增强。其归一化值的平方出现在扩散系数的分母中，计算如下：\n        $$ (k_\\perp \\rho_s)^2 = (k_y \\rho_s)^2 (1 + \\hat{s}^2) = (0.3)^2 (1 + \\hat{s}^2) $$\n    -   磁剪切还通过改变模结构来稳定微观不稳定性，这通过提高驱动它们所需的临界梯度来体现。离子温度梯度（ITG）和捕获电子模（TEM）不稳定性的临界梯度由下式给出：\n        $$ (R/L_T)_{\\mathrm{crit}}(\\hat{s}) = 2.0 + 1.0 \\, \\hat{s} $$\n        $$ (R/L_n)_{\\mathrm{crit}}(\\hat{s}) = 1.0 + 0.5 \\, \\hat{s} $$\n\n3.  **线性增长率计算**：湍流的主要驱动力是等离子体梯度超过其各自临界阈值的程度。\n    -   ITG 模的线性增长率 $\\gamma_{\\mathrm{ITG,lin}}$ 与“超额”的温度梯度成正比：\n        $$ \\gamma_{\\mathrm{ITG,lin}} = \\omega_* \\, \\max\\{ 0, \\, (R/L_T) - (R/L_T)_{\\mathrm{crit}}(\\hat{s}) \\} $$\n    -   类似地，TEM 的线性增长率 $\\gamma_{\\mathrm{TEM,lin}}$ 由密度梯度驱动：\n        $$ \\gamma_{\\mathrm{TEM,lin}} = \\omega_* \\, \\max\\{ 0, \\, (R/L_n) - (R/L_n)_{\\mathrm{crit}}(\\hat{s}) \\} $$\n    $\\max\\{0, \\dots\\}$ 函数强制执行阈值条件，确保当梯度低于临界值时增长率为零。\n\n4.  **$E \\times B$ 剪切抑制与分离各粒子种类的输运**：$E \\times B$ 剪切率 $\\gamma_E$ 通过使湍流涡旋退相关，提供了一种关键的输运抑制机制。该效应被建模为对线性增长率的直接削减。然后对离子和电子的输运进行分别解析。\n    -   **离子通道**：假设离子输运仅由 ITG 模驱动。离子通道的有效增长率 $\\gamma_{i,\\mathrm{eff}}$ 是 ITG 线性增长率被 $E \\times B$ 剪切削减后的值：\n        $$ \\gamma_{i,\\mathrm{eff}} = \\max\\{ 0, \\, \\gamma_{\\mathrm{ITG,lin}} - \\gamma_E \\} $$\n    -   **电子通道**：电子输运由 TEM 模驱动和 ITG 模驱动的一部分（分数 $\\alpha$）中较强者驱动。这个复合的线性驱动 $\\gamma_{e,\\mathrm{lin}}$ 随后也受到 $E \\times B$ 剪切的抑制：\n        $$ \\gamma_{e,\\mathrm{lin}} = \\max\\{ \\gamma_{\\mathrm{TEM,lin}}, \\, \\alpha \\, \\gamma_{\\mathrm{ITG,lin}} \\} $$\n        $$ \\gamma_{e,\\mathrm{eff}} = \\max\\{ 0, \\, \\gamma_{e,\\mathrm{lin}} - \\gamma_E \\} $$\n\n5.  **准线性混合长度扩散系数**：最后一步是应用混合长度闭合模型，该模型将扩散系数 $\\chi$ 与有效增长率 $\\gamma_{\\mathrm{eff}}$ 和由 $1/k_\\perp$ 近似的垂直相关长度联系起来。这是标准的 $\\chi \\sim \\gamma/k^2$ 标度关系。\n    -   离子热扩散系数 $\\chi_i$ 为：\n        $$ \\chi_i = C_{\\mathrm{mix}} \\frac{\\gamma_{i,\\mathrm{eff}}}{(k_\\perp \\rho_s)^2} $$\n    -   电子热扩散系数 $\\chi_e$ 为：\n        $$ \\chi_e = C_{\\mathrm{mix}} \\frac{\\gamma_{e,\\mathrm{eff}}}{(k_\\perp \\rho_s)^2} $$\n\n6.  **输运垒识别**：内部输运垒（ITB）是一个输运显著降低的区域。使用一个定量准则来识别其形成。\n    -   如果离子和电子的扩散系数都严格低于阈值 $\\chi_{\\mathrm{bar}} = 0.05$，则认为形成了输运垒。\n    -   如果 $(\\chi_i  \\chi_{\\mathrm{bar}}) \\land (\\chi_e  \\chi_{\\mathrm{bar}})$，则输运垒标志 $b$ 设为 $1$，否则设为 $0$。\n\n对每个提供的测试用例都执行这一系列的计算。根据最终输出的要求，将得到的 $\\chi_i$ 和 $\\chi_e$ 值四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the reduced quasilinear transport model for a series of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is in the format: [R/L_T, R/L_n, s_hat, gamma_E]\n    test_cases = [\n        [8.0, 2.5, 0.5, 1.8],\n        [6.0, 2.0, 0.2, 0.1],\n        [2.6, 1.2, 0.5, 0.05],\n        [4.0, 1.5, 2.0, 0.3],\n        [3.0, 3.0, 0.3, 0.2]\n    ]\n\n    # --- Model Constants ---\n    # These values are fixed as per the problem description.\n    _ky_rhos = 0.3      # Normalized binormal wavenumber and diamagnetic frequency scale (omega_*)\n    _alpha = 0.3        # Cross-coupling fraction from ITG to electron channel\n    _C_mix = 0.5        # Mixing-length prefactor\n    _chi_bar = 0.05     # Diffusivity threshold for barrier identification\n\n    def calculate_diffusivities(params):\n        \"\"\"\n        Calculates chi_i, chi_e, and the barrier flag for a single parameter set.\n\n        Args:\n            params (list): A list of four floats [R/L_T, R/L_n, s_hat, gamma_E].\n\n        Returns:\n            tuple: A tuple containing (chi_i, chi_e, b) where chi_i and chi_e are\n                   unrounded floats and b is the integer barrier flag.\n        \"\"\"\n        RLT, RLn, s_hat, gamma_E = params\n\n        # 1. Calculate shear-dependent quantities\n        # Effective perpendicular wavenumber squared\n        k_perp_rhos_sq = (_ky_rhos**2) * (1 + s_hat**2)\n        # Critical gradients\n        RLT_crit = 2.0 + 1.0 * s_hat\n        RLn_crit = 1.0 + 0.5 * s_hat\n\n        # 2. Calculate unsheared linear growth rates\n        gamma_ITG_lin = _ky_rhos * max(0.0, RLT - RLT_crit)\n        gamma_TEM_lin = _ky_rhos * max(0.0, RLn - RLn_crit)\n\n        # 3. Calculate species-resolved effective growth rates with ExB shear suppression\n        # Ion channel (driven by ITG)\n        gamma_i_eff = max(0.0, gamma_ITG_lin - gamma_E)\n        \n        # Electron channel (driven by max of TEM and a fraction of ITG)\n        gamma_e_lin = max(gamma_TEM_lin, _alpha * gamma_ITG_lin)\n        gamma_e_eff = max(0.0, gamma_e_lin - gamma_E)\n\n        # 4. Calculate diffusivities using the mixing-length formula\n        # The denominator k_perp_rhos_sq is always > 0 since ky_rhos > 0.\n        chi_i = _C_mix * gamma_i_eff / k_perp_rhos_sq\n        chi_e = _C_mix * gamma_e_eff / k_perp_rhos_sq\n\n        # 5. Identify transport barrier formation\n        # The criterion is strictly less than chi_bar for both species.\n        barrier_flag = 1 if (chi_i  _chi_bar and chi_e  _chi_bar) else 0\n\n        return chi_i, chi_e, barrier_flag\n\n    # Process all test cases and format for output\n    results_for_print = []\n    for case in test_cases:\n        # Calculate the raw diffusivity values and the barrier flag\n        chi_i_raw, chi_e_raw, b = calculate_diffusivities(case)\n\n        # Format the diffusivity values to six decimal places as required.\n        # This formatting handles rounding correctly.\n        chi_i_str = f\"{chi_i_raw:.6f}\"\n        chi_e_str = f\"{chi_e_raw:.6f}\"\n        \n        # Create the string representation for a single case's result list\n        results_for_print.append(f\"[{chi_i_str},{chi_e_str},{b}]\")\n\n    # Final print statement in the exact required format.\n    # The output is a string representing a list of lists.\n    print(f\"[{','.join(results_for_print)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "我们的最终实践将前面练习中的概念整合到一个自洽的模拟中，这反映了聚变反应堆预测性建模所面临的挑战。在这里，等离子体剖面与其所决定的输运过程不再是分离的，而是构成一个耦合的非线性系统的一部分。您将求解一个非线性扩散方程，其中输运系数 $\\chi_{\\text{eff}}$ 动态地依赖于您正在求解的温度梯度 。这形成了一个对ITB物理至关重要的反馈回路：陡峭的梯度可以产生强剪切，而强剪切反过来又会降低输运，从而允许形成更陡峭的梯度。通过进行灵敏度分析，您将研究加热功率、磁剪切和碰撞率等外部“控制旋钮”如何影响输运垒的形成。这个练习能让您对输运垒复杂的系统级动力学以及优化等离子体性能的方法，获得关键的洞察。",
            "id": "4056917",
            "problem": "您需要实现一个关于环形等离子体中内部输运垒形成的自洽数值研究，该研究使用一维、磁通面平均的输运模型。任务是根据一个非线性扩散方程的稳态解计算一个标量垒强度指数，然后对该指数相对于三个输入参数（热源幅度、安全因子剖面形状参数和碰撞率）进行局域敏感性分析。您的程序必须通过一个一致的、定量的敏感性度量，为每个指定情况识别出哪个参数是局域影响最大的，并产生所要求的输出。\n\n物理基础是沿着小半径 $r \\in [0,1]$（归一化到边界）的径向一维、磁通面平均的稳态能量平衡。该平衡将热通量的散度与外部加热源相等同。在没有对流且具有各向同性垂直输运的情况下，稳态方程为\n$$\n\\frac{d}{dr}\\left(\\chi_{\\mathrm{eff}}(r)\\,\\frac{dT}{dr}\\right) + S(r) = 0\n$$\n其中温度 $T(r)$ 归一化到一个任意尺度，有效扩散系数 $\\chi_{\\mathrm{eff}}(r)$ 模拟了由 $\\mathbf{E}\\times \\mathbf{B}$ 剪切引起的湍流抑制，并包含一个不可约的剩余输运本底。边界条件是在磁轴处的对称性和固定的边界温度：\n$$\n\\left.\\frac{dT}{dr}\\right|_{r=0} = 0,\\quad T(r=1) = 0\n$$\n\n模型组件定义如下，使用无量纲量：\n\n- 热源被设定为一个中心峰化的髙斯分布\n$$\nS(r) = S_0 \\exp\\left(-\\frac{r^2}{w^2}\\right)\n$$\n其中 $S_0$ 为源幅度，$w$ 为宽度。使用 $w = 0.25$。\n\n- 安全因子剖面由以下公式参数化\n$$\nq(r) = q_0 + \\alpha r^2\n$$\n其中 $q_0 = 1.0$，$\\alpha \\ge 0$ 为形状参数。局域磁剪切被建模为\n$$\n\\hat{s}(r) = \\frac{r}{q(r)}\\frac{dq}{dr} = \\frac{2 \\alpha r^2}{q(r)}\n$$\n\n- 类离子温度梯度（ITG）湍流的线性增长率由以下公式参数化\n$$\n\\gamma_{\\mathrm{lin}}(r) = \\gamma_0 \\,\\frac{1 + b_s \\hat{s}(r)^2}{1 + \\nu_*}\n$$\n其中 $\\gamma_0$、$b_s$ 和无量纲碰撞率 $\\nu_*$ 是常数或如下文指定的输入。\n\n- $\\mathbf{E}\\times \\mathbf{B}$ 剪切率通过局域温度梯度的大小来建模：\n$$\n\\gamma_E(r) = C_E \\left|\\frac{dT}{dr}\\right|\n$$\n\n- 有效扩散系数由一个带有剩余本底的 Biglari–Diamond–Terry 类型的抑制形式给出：\n$$\n\\chi_{\\mathrm{eff}}(r) = \\chi_{\\min} + \\frac{\\chi_0}{1 + \\left(\\dfrac{\\gamma_E(r)}{\\gamma_{\\mathrm{lin}}(r)}\\right)^2}\n$$\n其中 $\\chi_0$ 和 $\\chi_{\\min}$ 是常数，且在计算中对该比率进行正则化以避免除以零。\n\n对于一个收敛解，垒强度指数取为最大抑制比\n$$\nB = \\max_{r \\in [0,1]}\\left(\\frac{\\gamma_E(r)}{\\gamma_{\\mathrm{lin}}(r)}\\right)\n$$\n当剪切抑制在局域上主导线性驱动时，这个无量纲标量会更大。\n\n您必须通过中心有限差分计算 $B$ 对每个输入参数 $p \\in \\{S_0, \\alpha, \\nu_*\\}$ 的局域、无量纲敏感性。对于一个给定的基准参数三元组，定义\n$$\n\\left.\\frac{\\partial B}{\\partial p}\\right|_{\\mathrm{FD}} \\approx \\frac{B(p + \\Delta p) - B(p - \\Delta p)}{2 \\Delta p}\n$$\n其中相对步长 $\\Delta p = \\eta \\max(p, \\epsilon_p)$，使用 $\\eta = 0.05$ 和 $\\epsilon_p = 10^{-6}$。将参数 $p$ 的局域、归一化的绝对敏感性定义为\n$$\n\\mathcal{S}_p = \\left|\\frac{p}{\\max(B,\\epsilon_B)} \\frac{\\partial B}{\\partial p}\\right|\n$$\n其中 $\\epsilon_B = 10^{-8}$。对于每种情况，您必须根据以下映射，以整数形式报告具有最大 $\\mathcal{S}_p$ 的参数索引\n$$\n0 \\mapsto S_0,\\quad 1 \\mapsto \\alpha,\\quad 2 \\mapsto \\nu_*\n$$\n\n算法和数值要求：\n\n- 将 $r \\in [0,1]$ 均匀离散化，至少使用 $N=128$ 个点，并通过不动点迭代求解非线性边值问题：从 $T(r)$ 的一个初始猜测开始，评估 $\\chi_{\\mathrm{eff}}(r)$，然后求解得到的线性变系数扩散方程以获得更新的 $T(r)$，进行欠松弛，并迭代直至收敛。使用上述指定的边界条件。使用带有三对角线性系统的标准二阶有限体积或有限差分方法是可以接受的。\n\n- 使用参数 $\\chi_0 = 1.0$、$\\chi_{\\min} = 0.05$、$\\gamma_0 = 0.30$、$b_s = 2.0$、$C_E = 2.0$、$q_0 = 1.0$、$w = 0.25$。\n\n- 使用 $\\omega = 0.5$ 的欠松弛因子，最大范数下的非线性迭代容差 $\\delta_T = 10^{-6}$，以及最多 $500$ 次迭代。\n\n- 所有量都是无量纲的；不需要进行单位转换。最终结果是根据上述敏感性度量和映射定义的整数，没有物理单位。\n\n测试套件：\n\n对于以下五个基准参数集 $(S_0, \\alpha, \\nu_*)$ 中的每一个，计算如上定义的影响最大因素的索引。\n\n1. 情况 A（基准，中等驱动与剪切，低碰撞率）：$(S_0, \\alpha, \\nu_*) = (5.0, 1.0, 0.2)$。\n2. 情况 B（更强的核心加热）：$(S_0, \\alpha, \\nu_*) = (8.0, 1.0, 0.2)$。\n3. 情况 C（更强的磁剪切整形）：$(S_0, \\alpha, \\nu_*) = (5.0, 3.0, 0.2)$。\n4. 情况 D（更高的碰撞率）：$(S_0, \\alpha, \\nu_*) = (5.0, 1.0, 1.5)$。\n5. 情况 E（弱加热，弱剪切，极低碰撞率）：$(S_0, \\alpha, \\nu_*) = (2.0, 0.5, 0.05)$。\n\n您的程序应生成单行输出，其中包含按上述测试套件顺序排列的结果，格式为方括号括起来的逗号分隔列表。每个条目必须是该情况下影响最大的参数的整数索引，根据映射 $0 \\mapsto S_0$，$1 \\mapsto \\alpha$，$2 \\mapsto \\nu_*$。例如，一个有效的输出格式是\n`[$i_A, i_B, i_C, i_D, i_E$]`，\n其中每个 $i_\\bullet$ 是 $\\{0,1,2\\}$ 中的一个整数。",
            "solution": "用户提供的问题是计算等离子体物理学中一个适定的数值任务，具体是模拟内部输运垒（ITB）的形成。该问题具有科学依据，使用了标准的简化一维输运模型。所有必需的方程、常数和数值步骤都以自洽且一致的方式给出。因此，该问题被认为是有效的，并在下面提供了一个解决方案。\n\n问题的核心是求解一个关于稳态温度剖面 $T(r)$ 的非线性边值问题（BVP），然后对一个派生量，即垒强度指数 $B$，进行局域敏感性分析。解决方案分为三个主要部分：(1) 用于非线性BVP的数值求解器，(2) 从收敛的温度剖面计算垒强度指数 $B$，以及 (3) 对 $B$ 相对于输入参数 $S_0$、$\\alpha$ 和 $\\nu_*$ 进行敏感性分析。\n\n**1. 非线性边值问题的数值解法**\n\n控制方程是一个一维、稳态的反应扩散方程：\n$$\n\\frac{d}{dr}\\left(\\chi_{\\mathrm{eff}}(r, |dT/dr|)\\,\\frac{dT}{dr}\\right) + S(r) = 0, \\quad r \\in [0,1]\n$$\n边界条件为 $dT/dr|_{r=0} = 0$ 和 $T(1) = 0$。非线性来源于有效扩散系数 $\\chi_{\\text{eff}}$ 依赖于温度梯度的大小 $|dT/dr|$。\n\n这个非线性BVP在一个均匀的、以顶点为中心的网格上使用不动点迭代格式求解。径向域 $r \\in [0,1]$ 被离散为 $N$ 个段，产生 $N+1$ 个网格点 $r_i = i \\cdot h$（其中 $i=0, 1, \\dots, N$），$h=1/N$ 是网格间距。这些点上的温度记为 $T_i = T(r_i)$。\n\n迭代过程如下：\n1.  初始化温度剖面，例如 $T^{(0)}(r) = 0$。\n2.  对于每次迭代 $k=0, 1, 2, \\dots$：\n    a.  给定当前的温度剖面 $T^{(k)}(r)$，计算温度梯度 $|dT/dr|^{(k)}$。对于内部点使用二阶中心差分，而边界条件决定了端点处的梯度。\n    b.  计算所有依赖于梯度的量，包括 $\\mathbf{E}\\times\\mathbf{B}$ 剪切率 $\\gamma_E^{(k)}(r) = C_E |dT/dr|^{(k)}$。\n    c.  使用给定的公式，基于第 $k$ 次迭代的值，评估有效扩散系数剖面 $\\chi_{\\mathrm{eff}}^{(k)}(r)$。量 $q(r)$、$\\hat{s}(r)$ 和 $\\gamma_{\\mathrm{lin}}(r)$ 与温度无关，只计算一次。\n    d.  求解现在的*线性*变系数BVP，以获得一个临时的新的剖面 $\\tilde{T}(r)$：\n        $$\n        \\frac{d}{dr}\\left(\\chi_{\\mathrm{eff}}^{(k)}(r) \\frac{d\\tilde{T}}{dr}\\right) + S(r) = 0.\n        $$\n        该方程使用二阶有限差分格式进行离散化，得到一个关于内部网格点上未知温度 $\\tilde{T}_i$ 的三对角线性代数方程组。边界条件按如下方式并入：\n        -   在 $r=1$ 处，直接设置狄利克雷条件 $T_N=0$。\n        -   在 $r=0$ 处，通过使用一个虚拟点使得 $T_{-1}=T_1$ 来实现诺伊曼条件 $dT/dr|_0=0$，这简化了在 $i=0$ 处的有限差分方程。\n        得到的关于未知数 $\\tilde{T}_0, \\dots, \\tilde{T}_{N-1}$ 的 $N \\times N$ 三对角系统可以使用 `scipy.linalg.solve_banded` 高效求解。\n    e.  使用欠松弛因子 $\\omega$ 更新温度剖面：\n        $$\n        T^{(k+1)} = (1-\\omega) T^{(k)} + \\omega \\tilde{T}.\n        $$\n    f.  迭代持续进行，直到连续温度剖面之间的最大范数差小于指定的容差 $\\|T^{(k+1)} - T^{(k)}\\|_\\infty  \\delta_T$，或达到最大迭代次数。\n\n**2. 垒强度指数（$B$）的计算**\n\n一旦迭代求解器收敛到一个稳态解 $T(r)$，就计算垒强度指数 $B$。\n1.  最终的温度梯度 $|dT/dr|$ 从收敛的剖面 $T(r)$ 计算得出。\n2.  确定最终的 $\\mathbf{E}\\times\\mathbf{B}$ 剪切率剖面 $\\gamma_E(r)$。\n3.  在整个径向域上计算抑制比 $\\gamma_E(r) / \\gamma_{\\mathrm{lin}}(r)$。\n4.  垒强度指数 $B$ 是该比率的最大值：\n    $$\n    B = \\max_{r \\in [0,1]}\\left(\\frac{\\gamma_E(r)}{\\gamma_{\\mathrm{lin}}(r)}\\right).\n    $$\n\n**3. 敏感性分析**\n\n最后一步是确定哪个输入参数 $p \\in \\{S_0, \\alpha, \\nu_*\\}$ 对垒强度 $B$ 具有最显著的局域影响。这通过使用一个归一化的绝对敏感性度量来量化。\n1.  对于每个参数 $p$，其偏导数使用中心有限差分公式进行近似：\n    $$\n    \\frac{\\partial B}{\\partial p} \\approx \\frac{B(p + \\Delta p) - B(p - \\Delta p)}{2 \\Delta p},\n    $$\n    其中 $B(p \\pm \\Delta p)$ 是通过用被一个微小量 $\\Delta p$ 扰动过的参数 $p$ 重新运行整个BVP求解器计算得到的垒指数。步长由 $\\Delta p = \\eta \\max(p, \\epsilon_p)$ 确定，以确保一个稳定的相对扰动。\n2.  然后为每个参数计算无量纲、归一化的绝对敏感性 $\\mathcal{S}_p$：\n    $$\n    \\mathcal{S}_p = \\left|\\frac{p}{\\max(B,\\epsilon_B)} \\frac{\\partial B}{\\partial p}\\right|,\n    $$\n    其中 $B$ 是在未扰动的基准参数集下的值。\n3.  对于每个测试用例，比较敏感性 $\\mathcal{S}_{S_0}$、$\\mathcal{S}_{\\alpha}$ 和 $\\mathcal{S}_{\\nu_*}$。与最大的 $\\mathcal{S}_p$ 对应的索引（$S_0$ 为 $0$，$\\alpha$ 为 $1$，$\\nu_*$ 为 $2$）作为结果报告。\n\n整个过程在提供的Python代码中实现，该代码系统地评估每个测试用例，并按要求格式化最终结果。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\n# This script is self-contained and requires no external files or user input.\n# All constants and parameters are defined within the solve() function.\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the final result.\n    \"\"\"\n\n    # --- Global physical and numerical parameters from the problem statement ---\n    # Physical constants\n    CHI_0 = 1.0\n    CHI_MIN = 0.05\n    GAMMA_0 = 0.30\n    B_S = 2.0\n    C_E = 2.0\n    Q_0 = 1.0\n    W = 0.25\n\n    # Numerical parameters\n    N = 256  # Number of grid segments (N+1 points), satisfying N >= 128\n    OMEGA = 0.5  # Under-relaxation factor\n    DELTA_T = 1e-6  # Convergence tolerance\n    MAX_ITER = 500  # Maximum number of nonlinear iterations\n\n    # Sensitivity analysis parameters\n    ETA = 0.05\n    EPS_P = 1e-6\n    EPS_B = 1e-8\n    \n    # --- Test suite from the problem statement ---\n    test_cases = [\n        (5.0, 1.0, 0.2),    # Case A\n        (8.0, 1.0, 0.2),    # Case B\n        (5.0, 3.0, 0.2),    # Case C\n        (5.0, 1.0, 1.5),    # Case D\n        (2.0, 0.5, 0.05),   # Case E\n    ]\n    \n    # --- Helper function to solve the BVP for a given parameter set ---\n    def solve_bvp(S0, alpha, nu_star):\n        \"\"\"\n        Solves the nonlinear BVP for the temperature profile and returns the barrier strength B.\n        \"\"\"\n        # Grid setup\n        r = np.linspace(0, 1, N + 1)\n        h = 1.0 / N\n\n        # Profiles that do not depend on temperature T\n        S_profile = S0 * np.exp(-r**2 / W**2)\n        q_profile = Q_0 + alpha * r**2\n        s_hat_profile = np.divide(2 * alpha * r**2, q_profile, where=q_profile!=0)\n        gamma_lin_profile = GAMMA_0 * (1 + B_S * s_hat_profile**2) / (1 + nu_star)\n        \n        # Regularization to prevent division by zero, although gamma_lin > 0 for this model\n        gamma_lin_reg = np.maximum(gamma_lin_profile, 1e-12)\n\n        # Fixed-point iteration\n        # T_full includes the boundary point T(1)=0. We solve for T_sol = T[0...N].\n        T_sol = np.zeros(N) # Solving for T_0, ..., T_{N-1}\n        \n        for _ in range(MAX_ITER):\n            T_sol_old = T_sol.copy()\n            T_full_old = np.append(T_sol_old, 0.0)\n\n            # Calculate T-dependent quantities from the previous iteration\n            dTdr = np.zeros(N + 1)\n            dTdr[1:-1] = (T_full_old[2:] - T_full_old[:-2]) / (2 * h) # Centered difference\n            dTdr[0] = 0.0  # Boundary condition\n            dTdr[-1] = (T_full_old[-1] - T_full_old[-2]) / h  # Backward difference\n\n            gamma_E = C_E * np.abs(dTdr)\n            suppression_ratio = gamma_E / gamma_lin_reg\n            chi_eff = CHI_MIN + CHI_0 / (1 + suppression_ratio**2)\n            chi_half = 0.5 * (chi_eff[:-1] + chi_eff[1:]) # Averaged at cell interfaces\n\n            # Set up the tridiagonal linear system A*T_tilde = b\n            A_band = np.zeros((3, N))\n            b = np.zeros(N)\n\n            # Equation for i=0 (center, r=0)\n            A_band[1, 0] = -2.0 * chi_half[0] / h**2\n            A_band[0, 1] = 2.0 * chi_half[0] / h**2\n            b[0] = -S_profile[0]\n            \n            # Equations for i=1 to N-2 (interior)\n            A_band[1, 1:-1] = -(chi_half[:-2] + chi_half[1:-1]) / h**2\n            A_band[2, :-2] = chi_half[:-2] / h**2\n            A_band[0, 2:] = chi_half[1:-1] / h**2\n            b[1:-1] = -S_profile[1:-1]\n            \n            # Equation for i=N-1 (near edge)\n            A_band[1, -1] = -(chi_half[-2] + chi_half[-1]) / h**2\n            A_band[2, -2] = chi_half[-2] / h**2\n            b[-1] = -S_profile[-1] - chi_half[-1] * 0 / h**2 # T_N=0\n            \n            # Solve the linear system for the temporary profile\n            T_tilde = solve_banded((1, 1), A_band, b)\n\n            # Apply under-relaxation\n            T_sol = (1 - OMEGA) * T_sol_old + OMEGA * T_tilde\n\n            # Check for convergence\n            if np.max(np.abs(T_sol - T_sol_old))  DELTA_T:\n                break\n        \n        # After convergence, calculate the barrier strength B\n        T_full_final = np.append(T_sol, 0.0)\n        dTdr_final = np.zeros(N + 1)\n        dTdr_final[1:-1] = (T_full_final[2:] - T_full_final[:-2]) / (2 * h)\n        dTdr_final[0] = 0.0\n        dTdr_final[-1] = (T_full_final[-1] - T_full_final[-2]) / h\n        \n        gamma_E_final = C_E * np.abs(dTdr_final)\n        final_suppression_ratio = gamma_E_final / gamma_lin_reg\n        B = np.max(final_suppression_ratio)\n        \n        return B\n\n    # --- Helper function for sensitivity analysis ---\n    def calculate_sensitivities_and_max_idx(case):\n        \"\"\"\n        Performs sensitivity analysis for a given test case and returns the index\n        of the most influential parameter.\n        \"\"\"\n        params = list(case)\n        \n        # Calculate baseline barrier strength\n        B_base = solve_bvp(*params)\n        \n        sensitivities = []\n        for i in range(len(params)):\n            p_base = params[i]\n            \n            # Calculate perturbation step\n            dp = ETA * max(p_base, EPS_P)\n            \n            # Plus perturbation\n            params_plus = params.copy()\n            params_plus[i] += dp\n            B_plus = solve_bvp(*params_plus)\n            \n            # Minus perturbation\n            params_minus = params.copy()\n            params_minus[i] -= dp\n            B_minus = solve_bvp(*params_minus)\n            \n            # Centered finite difference derivative\n            dB_dp = (B_plus - B_minus) / (2 * dp)\n            \n            # Normalized absolute sensitivity\n            S_p = np.abs((p_base / max(B_base, EPS_B)) * dB_dp)\n            sensitivities.append(S_p)\n            \n        return np.argmax(sensitivities)\n\n    # --- Main execution loop ---\n    results = []\n    for case in test_cases:\n        most_influential_idx = calculate_sensitivities_and_max_idx(case)\n        results.append(most_influential_idx)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}