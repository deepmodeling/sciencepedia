{
    "hands_on_practices": [
        {
            "introduction": "超导体的热稳定性从根本上取决于其在不产生大幅温升的情况下吸收能量的能力。本练习将探讨铜（一种关键的稳定体材料）的比焓，它是其随温度变化的质量比热容的积分。通过使用德拜模型等物理模型对焓进行数值计算，您将深刻理解为何超导体在低温下具有极低的能量裕度，以及这对失超的初始阶段有何影响 。",
            "id": "4035639",
            "problem": "超导电缆中的铜稳定体在发生失超期间，会从低温工况转变到环境温度。从初始温度 $T_0$ 到最终温度 $T$ 的质量比焓增量，定义为质量比定压热容对温度的积分。从单位质量焓变满足的基本热力学定义出发\n$$\nh(T) - h(T_0) = \\int_{T_0}^{T} c_p(\\tau)\\, d\\tau,\n$$\n其中 $c_p(T)$ 是质量比定压热容。对于铜，一个有物理动机且被广泛接受的模型将摩尔热容分解为声子贡献和电子贡献。声子贡献由德拜模型描述，\n$$\nc_{p,\\mathrm{phonon}}(T) = 9 R \\left(\\frac{T}{\\Theta_D}\\right)^3 \\int_0^{\\Theta_D/T} \\frac{x^4 e^x}{\\left(e^x - 1\\right)^2}\\, dx,\n$$\n导电电子的贡献在低温下可以很好地近似为\n$$\nc_{p,\\mathrm{electron}}(T) = \\gamma T,\n$$\n因此摩尔热容为\n$$\nc_{p,\\mathrm{molar}}(T) = c_{p,\\mathrm{phonon}}(T) + c_{p,\\mathrm{electron}}(T).\n$$\n从摩尔基准转换为质量基准需要除以摩尔质量 $M$，因此质量比热容为 $c_p(T) = c_{p,\\mathrm{molar}}(T)/M$。一个能够捕捉低温 $T^3$ 声子标度律和高温饱和特性的解析拟合替代模型是\n$$\nc_{p,\\mathrm{fit,molar}}(T) = 3R\\frac{T^3}{T^3 + \\Theta_D^3} + \\gamma T,\n$$\n相应的质量比热容 $c_p(T)$ 同样通过除以 $M$ 得到。\n\n使用上述基于物理的定义，分别采用德拜加电子模型和解析拟合模型，计算铜从 $T_0 = 4.2\\,\\mathrm{K}$ 到 $T = 300\\,\\mathrm{K}$ 的质量比焓增量。假设摩尔质量 $M = 63.546\\times 10^{-3}\\,\\mathrm{kg/mol}$，普适气体常数 $R = 8.314\\,\\mathrm{J/(mol\\cdot K)}$，德拜温度 $\\Theta_D = 343\\,\\mathrm{K}$，以及电子系数 $\\gamma = 0.695\\times 10^{-3}\\,\\mathrm{J/(mol\\cdot K^2)}$。所有焓增量以 $\\mathrm{J/kg}$ 为单位表示，并四舍五入到三位小数。\n\n在超导电缆失超传播的背景下，从 $c_p(T)$ 的结构和上述积分关系出发，讨论焓-温曲线中低温平台的意义。解释 $c_p(T)$ 的哪些特征导致了在约 $20\\,\\mathrm{K}$ 以下焓的缓慢累积，以及这如何影响能量裕度和正常区的初始动力学。\n\n测试套件和要求的输出：\n- 使用以下五个测试用例：\n    1. 德拜加电子模型，$T_0=4.2\\,\\mathrm{K}$ 且 $T=300\\,\\mathrm{K}$。\n    2. 解析拟合模型，$T_0=4.2\\,\\mathrm{K}$ 且 $T=300\\,\\mathrm{K}$。\n    3. 德拜加电子模型，$T_0=4.2\\,\\mathrm{K}$ 且 $T=4.2\\,\\mathrm{K}$ (边界情况)。\n    4. 德拜加电子模型，$T_0=4.2\\,\\mathrm{K}$ 且 $T=20\\,\\mathrm{K}$ (低温区域)。\n    5. 解析拟合模型，$T_0=4.2\\,\\mathrm{K}$ 且 $T=20\\,\\mathrm{K}$ (低温区域)。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果顺序与测试用例相同，例如 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 是以 $\\mathrm{J/kg}$ 为单位的焓增量，四舍五入到三位小数。",
            "solution": "问题陈述具有科学依据，提法恰当且客观，满足所有有效性标准。它提出了一个低温工程和固态物理领域的标准问题，使用了成熟的物理模型和公认的铜参数值。任务定义清晰，可以利用所提供的信息解决。\n\n从初始温度 $T_0$ 到最终温度 $T$ 的质量比焓增量 $\\Delta h$，其基本定义为质量比定压热容 $c_p(T)$ 在该温度范围内的积分：\n$$\n\\Delta h = h(T) - h(T_0) = \\int_{T_0}^{T} c_p(\\tau)\\, d\\tau\n$$\n这一关系表明，焓是热容的累积。$c_p(T)$ 值小的区域对总焓增量的贡献很小。我们需要计算铜的这个量，其质量比热容 $c_p(T)$ 是通过摩尔热容 $c_{p,\\mathrm{molar}}(T)$ 除以摩尔质量 $M = 63.546 \\times 10^{-3}\\,\\mathrm{kg/mol}$ 得出的。摩尔热容是晶格振动（声子）和导电电子贡献的总和，$c_{p,\\mathrm{molar}}(T) = c_{p,\\mathrm{phonon}}(T) + c_{p,\\mathrm{electron}}(T)$。\n\n在低温下（$T \\ll \\Theta_D$，其中铜的德拜温度为 $\\Theta_D = 343\\,\\mathrm{K}$），完整的德拜模型和声子贡献的解析拟合都表现出众所周知的德拜 $T^3$ 定律，即 $c_{p,\\mathrm{phonon}}(T) \\propto T^3$。对于解析拟合模型，这一点是明确的：当 $T \\ll \\Theta_D$ 时，摩尔热容 $c_{p,\\mathrm{fit,molar}}(T) = 3R\\frac{T^3}{T^3 + \\Theta_D^3} + \\gamma T \\approx \\frac{3R}{\\Theta_D^3}T^3 + \\gamma T$。导电电子的贡献与温度成线性关系，$c_{p,\\mathrm{electron}}(T) = \\gamma T$，其中电子系数为 $\\gamma = 0.695 \\times 10^{-3}\\,\\mathrm{J/(mol\\cdot K^2)}$。\n\n因此，在极低温度下（通常低于 $20\\,\\mathrm{K}$），总质量比热容的形式为 $c_p(T) \\approx (A T^3 + \\gamma T)/M$，其中 $A$ 是一个常数。在这个区域内，$T^3$ 和 $T$ 这两项都非常小，导致总热容极小。\n\n从低温工作点 $T_0 = 4.2\\,\\mathrm{K}$ 开始，随着温度升高，焓的累积非常缓慢，其直接原因就是 $c_p(T)$ 的这个低值。在 $h(T)$ 对 $T$ 的图上，这表现为一个斜率非常低的区域，因为斜率恰好是 $dh/dT = c_p(T)$。这个特征有时被不严格地称为“低温平台”，尽管更准确的描述是焓含量接近于零且焓增长缓慢的区域。焓并非稳定在某个非零值上，而是保持在其参考值 $h(T_0)=0$ 附近。\n\n这种行为的物理意义对超导磁体的稳定性至关重要。\n\n$1$. **能量裕度**：超导电缆的能量裕度是指它在不发生温度升高超过临界温度的情况下，能够从瞬态扰动中吸收的最大能量密度。一旦超过临界温度，它就会转变为正常电阻态（即“失超”）。由吸收的能量密度 $\\Delta E$ 引起的温升 $\\Delta T$ 近似为 $\\Delta T \\approx \\Delta E / c_p(T)$，前提是能量沉积的速度快于其传导散失的速度。因为在工作温度 $4.2\\,\\mathrm{K}$ 附近，$c_p(T)$ 非常小，即使是极微小的能量沉积也可能导致巨大且可能是临界性的温度漂移。这导致能量裕度非常小，使得超导体对机械振动或磁通跳跃等扰动高度敏感。\n\n$2$. **失超传播动力学**：如果局部扰动足以产生一个小的正常区，该区域将开始产生电阻焦耳热（$P = I^2 R$）。这些热量必须被周围的材料吸收。在这些低温下，铜稳定体的焓含量非常低（且 $c_p(T)$ 值很低），这意味着它无法有效吸收这些热量。因此，正常区的温度会非常迅速地上升。这种快速的温度升高会产生陡峭的热梯度，将热量驱入相邻的超导区域，使其温度升高，并导致正常区扩大。因此，在约 $20\\,\\mathrm{K}$ 以下焓的缓慢累积，促进了初始温度的快速上升和失超的快速传播，这是磁体保护系统设计中的一个关键考虑因素。\n\n接下来的计算解答将通过使用严格的德拜加电子模型和方便的解析拟合模型，计算指定温度范围内的焓增量，从而量化这些效应。所需的积分将进行数值计算。德拜模型需要一个嵌套的数值积分，因为其 $c_{p,\\mathrm{phonon}}(T)$ 的定义本身就包含一个积分。解析模型的 $c_p(T)$ 允许更直接的对温度的单次积分。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the mass-specific enthalpy increment for copper using\n    two different models for specific heat capacity and for several\n    temperature ranges.\n    \"\"\"\n\n    # Define physical constants as per the problem statement.\n    M = 63.546e-3      # Molar mass of copper (kg/mol)\n    R = 8.314          # Universal gas constant (J/(mol*K))\n    THETA_D = 343.0    # Debye temperature of copper (K)\n    GAMMA = 0.695e-3   # Electronic specific heat coefficient (J/(mol*K^2))\n\n    # --- Model Definitions ---\n\n    def debye_integrand(x):\n        \"\"\"Integrand for the Debye integral part of the phonon heat capacity.\"\"\"\n        if x == 0:\n            return 0.0\n        # The expression is numerically stable for x>0. np.exp handles large x.\n        return (x**4 * np.exp(x)) / (np.exp(x) - 1)**2\n\n    def cp_molar_debye(T):\n        \"\"\"\n        Calculates the molar heat capacity of copper at temperature T\n        using the Debye-plus-electron model.\n        \"\"\"\n        if T == 0:\n            return 0.0\n        \n        # Phonon contribution (Debye model)\n        # The integral is computed numerically using quad.\n        integral_val, _ = quad(debye_integrand, 0, THETA_D / T)\n        cp_phonon = 9 * R * (T / THETA_D)**3 * integral_val\n        \n        # Conduction electron contribution\n        cp_electron = GAMMA * T\n        \n        return cp_phonon + cp_electron\n\n    def cp_mass_debye(T):\n        \"\"\"Mass-specific heat capacity for the Debye-plus-electron model.\"\"\"\n        return cp_molar_debye(T) / M\n\n    def cp_molar_analytic(T):\n        \"\"\"\n        Calculates the molar heat capacity of copper at temperature T\n        using the analytic fitted model.\n        \"\"\"\n        if T == 0:\n            return 0.0\n            \n        # Phonon contribution (fitted model)\n        cp_phonon_fit = 3 * R * (T**3) / (T**3 + THETA_D**3)\n        \n        # Conduction electron contribution\n        cp_electron = GAMMA * T\n        \n        return cp_phonon_fit + cp_electron\n\n    def cp_mass_analytic(T):\n        \"\"\"Mass-specific heat capacity for the analytic fitted model.\"\"\"\n        return cp_molar_analytic(T) / M\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'model': 'debye', 'T_start': 4.2, 'T_end': 300.0},\n        {'model': 'analytic', 'T_start': 4.2, 'T_end': 300.0},\n        {'model': 'debye', 'T_start': 4.2, 'T_end': 4.2},\n        {'model': 'debye', 'T_start': 4.2, 'T_end': 20.0},\n        {'model': 'analytic', 'T_start': 4.2, 'T_end': 20.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        T_start = case['T_start']\n        T_end = case['T_end']\n\n        # Handle the trivial case where the integral is zero.\n        if T_end == T_start:\n            enthalpy_increment = 0.0\n            results.append(enthalpy_increment)\n            continue\n\n        # Select the appropriate specific heat function based on the model.\n        if case['model'] == 'debye':\n            integrand_func = cp_mass_debye\n        else:  # 'analytic'\n            integrand_func = cp_mass_analytic\n\n        # Perform numerical integration to find the enthalpy increment.\n        # quad returns the integral result and an estimated absolute error.\n        h_increment, _ = quad(integrand_func, T_start, T_end, limit=100)\n        results.append(h_increment)\n\n    # Round all results to three decimal places.\n    rounded_results_str = [f\"{res:.3f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(rounded_results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "要为像管内电缆导体（CICC）这样的复杂系统建立易于处理的模型，我们必须做出合理的简化。本练习介绍毕渥数（Biot number），这是一个无量纲数，用于比较物体内部的导热热阻与外部的对流换热热阻。通过推导和计算超导股线的毕渥数，您将学习如何严格地判断空间上温度均匀的集总电容模型是否为有效近似，这是热工水力学建模中的一项关键技能 。",
            "id": "4035655",
            "problem": "托卡马克磁体中的一根“管内电缆导体”（CICC）内的单股导线经历一次初始失超，在此期间，一小块区域转变为正常态并开始发热。考虑该导线早期的径向热响应，此时轴向热输运和氦流体动力学与径向扩散以及与周围强制流动氦浴的界面传热相比可以忽略不计。假设在所关注的短时间尺度内，该导线可被视为性质恒定的均匀介质，并且远离导线的氦气温度保持均匀。\n\n从固体的瞬态能量守恒定律、热传导的本构关系以及导线-氦界面处的对流边界条件出发，使用特征长度 $L$ 对径向热传导问题进行无量纲化，并确定量化了边界处界面（外部）热阻与内部传导热阻之比的无量纲数群。在评估给定参数时，该数群传统上用于评估集总热容近似法的有效性。\n\n使用以下代表CICC导线在低温下初始失超条件的代表性数据：\n- 复合导线的有效径向热导率：$k = 600 \\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n- 与周围氦的有效对流换热系数：$h = 7.5 \\times 10^{3} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$。\n- 导线的特征长度（基于几何形状和表面暴露情况）：$L = 2.0 \\times 10^{-4} \\,\\mathrm{m}$。\n\n计算所确定的无量纲数群在给定 $L$ 下的值，并根据其大小，论证集总热容模型对于“管内电缆导体”（CICC）的初始失超分析是否合理。\n\n将该无量纲数群的数值报告为纯数（无单位），四舍五入至三位有效数字。在你的推理中，明确陈述你所引用的任何附加假设，并基于第一性原理证明集总电容模型的适用性，而不是引用任何未从控制方程推导出的简化公式。",
            "solution": "该问题要求对超导导线的径向热传导方程进行无量纲化，以确定控制边界条件的无量纲数群，计算其值，并评估集总热容模型的适用性。\n\n分析从瞬态传热的基本原理开始。在没有内部热源的情况下，性质恒定的固体内的能量守恒由热扩散方程描述。为简单起见，我们考虑一个一维笛卡尔坐标系，其中 $x$ 代表沿特征长度 $L$ 的空间变量。温度场表示为 $T(x, t)$。控制方程为：\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} $$\n其中 $\\rho$ 是密度，$c_p$ 是比热容，$k$ 是导线材料的热导率。这可以利用热扩散率 $\\alpha = k/(\\rho c_p)$ 重写为：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\n\n在导线的边界（不失一般性，我们可将其置于 $x=L$），热量通过对流传递到周围的氦浴中。假设氦浴处于恒定、均匀的温度 $T_\\infty$。边界条件将来自固体的传导热通量与进入流体的对流热通量相等：\n$$ -k \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=L} = h (T(L,t) - T_\\infty) $$\n这里，$h$ 是对流换热系数。\n\n为了对问题进行无量纲化，我们引入无量纲变量。设 $T_i$ 为导线的参考初始温度。\n定义无量纲温度 $\\theta$ 为：\n$$ \\theta = \\frac{T - T_\\infty}{T_i - T_\\infty} $$\n使用特征长度 $L$ 定义无量纲空间坐标 $X$：\n$$ X = \\frac{x}{L} $$\n现在我们将使用这些新变量变换边界条件。导数变换如下：\n$$ \\frac{\\partial}{\\partial x} = \\frac{\\partial}{\\partial X} \\frac{dX}{dx} = \\frac{1}{L} \\frac{\\partial}{\\partial X} $$\n将变换代入边界条件方程：\n$$ -k \\left( \\frac{1}{L} \\frac{\\partial}{\\partial X} \\left[ \\theta(T_i - T_\\infty) + T_\\infty \\right] \\right)_{X=1} = h \\left( \\left[ \\theta(T_i - T_\\infty) + T_\\infty \\right] - T_\\infty \\right)_{X=1} $$\n由于 $T_i$ 和 $T_\\infty$ 是常数，这可以简化为：\n$$ -k \\frac{T_i - T_\\infty}{L} \\left. \\frac{\\partial \\theta}{\\partial X} \\right|_{X=1} = h \\left( \\theta(1,t) (T_i - T_\\infty) \\right) $$\n假设 $T_i \\neq T_\\infty$，我们可以从两边消去 $(T_i - T_\\infty)$ 项：\n$$ -\\frac{k}{L} \\left. \\frac{\\partial \\theta}{\\partial X} \\right|_{X=1} = h \\, \\theta(1,t) $$\n重新整理以组合物理参数，得到边界条件的无量纲形式：\n$$ \\left. \\frac{\\partial \\theta}{\\partial X} \\right|_{X=1} = - \\left( \\frac{hL}{k} \\right) \\theta(1,t) $$\n从此过程中自然产生的无量纲数群是 $\\frac{hL}{k}$。这被称为毕渥数，用 $Bi$ 表示。\n$$ Bi = \\frac{hL}{k} $$\n\n问题的陈述要求确定量化“界面（外部）热阻与内部传导热阻之比”的数群。让我们分析毕渥数的物理意义。对于特征长度 $L$ 和横截面积 $A$，内部传导热阻 $R_{cond}$ 可表征为 $R_{cond} \\sim \\frac{L}{kA}$。表面的外部对流热阻 $R_{conv}$ 为 $R_{conv} = \\frac{1}{hA}$。这两种阻力的比值为：\n$$ \\frac{R_{cond}}{R_{conv}} = \\frac{L/kA}{1/hA} = \\frac{hL}{k} = Bi $$\n因此，毕渥数代表内部传导热阻与外部对流热阻的比值。问题的措辞要求的是这个比率的倒数，$R_{conv}/R_{cond}$。然而，毕渥数是在此背景下控制热响应的常规和基本参数，其值是评估集总电容近似法的基础。我们将毕渥数 $Bi = \\frac{hL}{k}$ 确定为相关的无量纲数群。\n\n集总热容近似法假设物体内部的温度在空间上是均匀的，即 $T(x,t) \\approx T(t)$。当内部传热阻力与外部传热阻力相比可以忽略不计时，此假设有效。用毕渥数表示，此条件为 $Bi \\ll 1$。该近似法有效性的一个普遍接受的工程标准是 $Bi  0.1$。如果此条件成立，则固体内部的温度梯度极小，整个物体可以被视为处于均匀温度的单个集总体。\n\n我们现在计算给定参数下的毕渥数值：\n- 有效径向热导率，$k = 600 \\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$\n- 有效对流换热系数，$h = 7.5 \\times 10^{3} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$\n- 特征长度，$L = 2.0 \\times 10^{-4} \\,\\mathrm{m}$\n\n$$ Bi = \\frac{hL}{k} = \\frac{(7.5 \\times 10^{3} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}) \\times (2.0 \\times 10^{-4} \\,\\mathrm{m})}{600 \\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}} $$\n$$ Bi = \\frac{1.5}{600} = \\frac{1.5}{6 \\times 10^2} = 0.25 \\times 10^{-2} = 0.0025 $$\n该无量纲数群的值为 $0.0025$。\n\n为将该值报告为三位有效数字，我们将其写为 $2.50 \\times 10^{-3}$。\n\n基于此值，我们可以评估集总电容模型的适用性。计算出的毕渥数为 $Bi = 0.0025$。这个值远小于 $0.1$ 的阈值。\n$$ 0.0025 \\ll 0.1 $$\n这表明内部传导热阻（$L/k$）远小于外部对流热阻（$1/h$）。具体来说，该比率为 $1:400$。因此，传导到导线表面的热量通过对流被带走的速度远慢于从内部供应的速度。这导致导线内部的温度梯度非常小。空间均匀温度分布的假设是完全合理的。因此，对于分析给定CICC导线在失超期间的早期热响应，集总热容模型是一个合适且准确的简化方法。",
            "answer": "$$\\boxed{2.50 \\times 10^{-3}}$$"
        },
        {
            "introduction": "模拟失超传播需要求解一个非线性、多物理场的偏微分方程，该方程将热扩散与高度非线性的焦耳热耦合在一起。本练习将指导您实现算子分裂格式，这是一种强大的数值技术，可将刚性的扩散算子与非线性源项解耦。通过构建和验证此求解器，您将获得处理瞬态问题的高级计算方法的实践经验，并开发出分析失超动态演化的实用工具 。",
            "id": "4035613",
            "problem": "考虑一个一维超导电缆段，其空间域模型为 $x \\in [0,L]$，并带有狄利克雷边界条件 $T(0,t)=T_b$ 和 $T(L,t)=T_b$。热场 $T(x,t)$ 的演化由热传导和由电场 $E(J,T)$ 产生的焦耳热引起，其中传输电流密度 $J$ 已指定。该模型基于能量守恒和傅里叶热传导，得到以下偏微分方程 (PDE)\n$$\nC \\,\\frac{\\partial T}{\\partial t} \\;=\\; k \\,\\frac{\\partial^2 T}{\\partial x^2} \\;+\\; q(J,T),\n$$\n其中 $C$ 是体积热容，$k$ 是热导率，$q(J,T)$ 是由 $q(J,T) = E(J,T)\\,J$ 定义的体积焦耳热。所有物理量和单位必须一致处理：温度单位为开尔文 (K)，长度单位为米 (m)，时间单位为秒 (s)，电场单位为伏特/米 (V/m)，电流密度单位为安培/平方米 (A/m$^2$)。电缆长度为 $L$，浴温为 $T_b$。\n\n电学本构关系 $E(J,T)$ 捕捉了从超导态到正常态的转变。临界电流密度 $J_c(T)$ 定义为\n$$\nJ_c(T) \\;=\\; J_{c0} \\,\\max\\!\\left(0, 1 - \\frac{T}{T_c}\\right),\n$$\n其中 $J_{c0}$ 是零温临界电流密度，$T_c$ 是临界温度。对于 $T  T_c$，采用幂律电场\n$$\nE_{\\mathrm{sc}}(J,T) \\;=\\; E_c \\,\\left(\\frac{J}{\\max(J_c(T),\\epsilon)}\\right)^n,\n$$\n其中临界电场为 $E_c$，幂律指数为 $n$，还有一个小的安全值 $\\epsilon>0$，单位为 A/m$^2$。对于 $T \\ge T_c$，使用有效正常态电阻率 $\\rho_{\\mathrm{eff}}(T)$，使得\n$$\nE_{\\mathrm{n}}(J,T) \\;=\\; \\rho_{\\mathrm{eff}}(T)\\,J, \\qquad \\rho_{\\mathrm{eff}}(T) \\;=\\; \\rho_0 \\left(1 + \\beta\\,\\max\\!\\big(T - T_b, 0\\big)\\right),\n$$\n其中 $\\rho_0$ 的单位是 $\\Omega\\cdot\\mathrm{m}$，$\\beta$ 的单位是 $\\mathrm{K}^{-1}$。为避免在 $T\\approx T_c$ 附近出现非物理发散，令\n$$\nE(J,T) \\;=\\; \\begin{cases}\n\\min\\!\\big(E_{\\mathrm{sc}}(J,T), \\rho_{\\mathrm{eff}}(T)\\,J\\big),   T  T_c, \\\\\n\\rho_{\\mathrm{eff}}(T)\\,J,   T \\ge T_c.\n\\end{cases}\n$$\n\n实施一个李算子分裂格式，在每个时间步 $\\Delta t$ 内交替更新热场 $T$ 和电场 $E(J,T)$，方法是将演化过程分裂为两个算子：\n- 热扩散算子 $A$：在时间间隔 $\\Delta t$ 内，用狄利克雷边界求解 $C\\,\\partial_t T = k\\,\\partial_{xx} T$。\n- 源加热算子 $B$：在时间间隔 $\\Delta t$ 内，对空间逐点求解 $\\partial_t T = q(J,T)/C$。\n\n从 $T^n$ 到 $T^{n+1}$ 的李分裂步骤为\n$$\nT^{n+1/2} \\;=\\; \\Phi_A(\\Delta t)\\,T^n, \\qquad T^{n+1} \\;=\\; \\Phi_B(\\Delta t)\\,T^{n+1/2},\n$$\n其中 $\\Phi_A$ 和 $\\Phi_B$ 分别是 $A$ 和 $B$ 的解算子。对 $\\Phi_A$ 使用隐式有限差分法，时间步长为 $\\Delta t$，空间网格间距为 $\\Delta x = L/(N_x-1)$，网格为均匀网格 $x_i=i\\,\\Delta x$，$i=0,\\dots,N_x-1$。具体来说，对内部节点 $i=1,\\dots,N_x-2$ 使用后向欧拉离散进行扩散计算：\n$$\nT^{n+1/2}_i - r \\left(T^{n+1/2}_{i+1} - 2\\,T^{n+1/2}_i + T^{n+1/2}_{i-1}\\right) \\;=\\; T^n_i, \\qquad r = \\frac{k\\,\\Delta t}{C\\,\\Delta x^2},\n$$\n其中 $T^{n+1/2}_0 = T_b$ 且 $T^{n+1/2}_{N_x-1} = T_b$。对于 $\\Phi_B$，在每个内部节点使用二阶显式方法（例如，休恩方法）对 $\\partial_t T = q(J,T)/C$ 进行积分，并在源更新后强制施加 $T(0,t)=T_b$ 和 $T(L,t)=T_b$。\n\n初始条件：叠加在浴温上的局部热点，\n$$\nT(x,0) \\;=\\; T_b + \\Delta T \\,\\exp\\!\\left(-\\frac{(x - L/2)^2}{2\\,\\sigma^2}\\right).\n$$\n\n您的实现必须计算在指定参数和时间步长下直至最终时间 $T_{\\mathrm{end}}$ 的数值解，并通过将不同 $\\Delta t$ 值下的解与使用一个更小时间步长 $\\Delta t_{\\mathrm{ref}}$ 得到的参考解进行比较，来评估分裂收敛性。使用空间均方根误差\n$$\n\\mathrm{RMS} \\;=\\; \\left(\\frac{1}{N_x}\\sum_{i=0}^{N_x-1}\\left(T_i^{\\mathrm{coarse}} - T_i^{\\mathrm{ref}}\\right)^2\\right)^{1/2}\n$$\n以开尔文 (K) 为单位表示。使用连续的误差对和时间步长比率 $r_t$ 通过以下公式估算观测收敛阶 $p$\n$$\np \\;=\\; \\frac{\\log\\!\\left(\\mathrm{RMS}_{1}/\\mathrm{RMS}_{2}\\right)}{\\log\\!\\left(r_t\\right)}.\n$$\n\n在您的解答中从理论上论证分裂误差和收敛准则：从算子 $A$ 和 $B$ 的定义出发，讨论贝克-坎贝尔-豪斯多夫展开和对易子 $[A,B]$，并推导李分裂的局部和全局误差阶。\n\n所有测试案例的物理和数值参数：\n- 电缆长度 $L = 0.1\\,\\mathrm{m}$，浴温 $T_b = 4.2\\,\\mathrm{K}$。\n- 热导率 $k = 50\\,\\mathrm{W/(m\\cdot K)}$，体积热容 $C = 3.0\\times 10^6\\,\\mathrm{J/(m^3\\cdot K)}$。\n- 电学参数：$T_c = 9.2\\,\\mathrm{K}$，$J_{c0} = 3.0\\times 10^8\\,\\mathrm{A/m^2}$，$E_c = 1.0\\times 10^{-4}\\,\\mathrm{V/m}$，$n = 15$，$\\epsilon = 10^{-3}\\,\\mathrm{A/m^2}$，$\\rho_0 = 1.0\\times 10^{-9}\\,\\Omega\\cdot\\mathrm{m}$，$\\beta = 5.0\\times 10^{-3}\\,\\mathrm{K^{-1}}$。\n- 空间网格尺寸 $N_x = 81$。\n- 初始热点：$\\Delta T = 20.0\\,\\mathrm{K}$，$\\sigma = 0.004\\,\\mathrm{m}$。\n- 最终时间 $T_{\\mathrm{end}} = 2.0\\times 10^{-4}\\,\\mathrm{s}$。\n- 参考时间步长 $\\Delta t_{\\mathrm{ref}} = 2.5\\times 10^{-6}\\,\\mathrm{s}$。\n- 待测试的粗时间步长：$\\Delta t \\in \\{4.0\\times 10^{-5},\\, 2.0\\times 10^{-5},\\, 1.0\\times 10^{-5}\\}\\,\\mathrm{s}$，连续值之间的比率 $r_t = 2$。\n\n测试套件：\n- 案例 1（典型电流）：$J = 1.0\\times 10^8\\,\\mathrm{A/m^2}$。\n- 案例 2（无源边界情况）：$J = 0.0\\,\\mathrm{A/m^2}$。\n- 案例 3（刚性源机制）：$J = 4.0\\times 10^8\\,\\mathrm{A/m^2}$。\n\n对于每个案例，计算在 $T_{\\mathrm{end}}$ 时刻，三个粗时间步长与参考解相比的空间均方根误差，记为 $\\mathrm{RMS}_{\\Delta t_1}$、$\\mathrm{RMS}_{\\Delta t_2}$、$\\mathrm{RMS}_{\\Delta t_3}$，以及从连续对（$r_t=2$）计算出的观测阶 $p_{12}$ 和 $p_{23}$。所有误差必须以开尔文 (K) 表示，阶数是无量纲的。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下\n$$\n\\big[ \\mathrm{RMS}^{(1)}_{\\Delta t_1}, \\mathrm{RMS}^{(1)}_{\\Delta t_2}, \\mathrm{RMS}^{(1)}_{\\Delta t_3}, p^{(1)}_{12}, p^{(1)}_{23}, \\mathrm{RMS}^{(2)}_{\\Delta t_1}, \\mathrm{RMS}^{(2)}_{\\Delta t_2}, \\mathrm{RMS}^{(2)}_{\\Delta t_3}, p^{(2)}_{12}, p^{(2)}_{23}, \\mathrm{RMS}^{(3)}_{\\Delta t_1}, \\mathrm{RMS}^{(3)}_{\\Delta t_2}, \\mathrm{RMS}^{(3)}_{\\Delta t_3}, p^{(3)}_{12}, p^{(3)}_{23} \\big],\n$$\n其中上标 $(c)$ 表示案例 $c \\in \\{1,2,3\\}$。数值必须打印为纯十进制浮点数，误差单位为开尔文 (K)，观测阶为无量纲。",
            "solution": "该问题要求实现并验证一种数值格式，用于求解模拟超导电缆中热演化的一维非线性偏微分方程(PDE)。验证必须通过分析数值解的收敛性来完成。\n\n### **问题表述**\n长度为 $L$ 的超导电缆中温度场 $T(x,t)$ 的演化由一个带有非线性源项的热扩散方程决定：\n$$\nC \\,\\frac{\\partial T}{\\partial t} \\;=\\; k \\,\\frac{\\partial^2 T}{\\partial x^2} \\;+\\; q(J,T) \\quad \\text{for } x \\in (0, L), t > 0\n$$\n其中 $C$ 是体积热容，$k$ 是热导率，$q(J,T) = E(J,T)J$ 是体积焦耳热。传输电流密度为 $J$。电缆受狄利克雷边界条件 $T(0,t) = T(L,t) = T_b$ 的约束，其中 $T_b$ 是恒定的浴温。\n\n电场 $E(J,T)$ 由一个分段模型定义，该模型捕捉了超导到正常态的转变：\n$$\nE(J,T) \\;=\\; \\begin{cases}\n\\min\\!\\big(E_{\\mathrm{sc}}(J,T), \\rho_{\\mathrm{eff}}(T)\\,J\\big),   T  T_c, \\\\\n\\rho_{\\mathrm{eff}}(T)\\,J,   T \\ge T_c,\n\\end{cases}\n$$\n其中 $T_c$ 是临界温度。各项为：\n- 临界电流密度：$J_c(T) = J_{c0} \\,\\max(0, 1 - T/T_c)$\n- 超导电场（幂律）：$E_{\\mathrm{sc}}(J,T) = E_c \\left(J/\\max(J_c(T),\\epsilon)\\right)^n$\n- 有效正常态电阻率：$\\rho_{\\mathrm{eff}}(T) = \\rho_0 (1 + \\beta\\,\\max(T - T_b, 0))$\n\n初始条件是一个高斯热点：$T(x,0) = T_b + \\Delta T \\,\\exp\\!\\left(-(x - L/2)^2/(2\\,\\sigma^2)\\right)$。\n\n### **数值方法：李算子分裂**\n\n该偏微分方程可以写成抽象形式 $\\partial_t T = \\mathcal{A}(T) + \\mathcal{B}(T)$，其中：\n- $\\mathcal{A}(T) = \\alpha_T \\frac{\\partial^2 T}{\\partial x^2}$ 是线性热扩散算子，其中热扩散系数为 $\\alpha_T = k/C$。\n- $\\mathcal{B}(T) = \\frac{q(J,T)}{C}$ 是非线性热源算子。\n\n李分裂格式通过顺序求解两个子问题来近似一个时间步 $\\Delta t$ 内的演化：\n$$\nT^{n+1} = \\Phi_B(\\Delta t) \\Phi_A(\\Delta t) T^n\n$$\n其中 $\\Phi_A$ 和 $\\Phi_B$ 分别是 $\\partial_t T = \\mathcal{A}(T)$ 和 $\\partial_t T = \\mathcal{B}(T)$ 的解算子。\n\n**理论误差分析：**\n在时间步 $\\Delta t$ 内，$\\partial_t T = (\\mathcal{A} + \\mathcal{B})T$ 的形式解为 $T(t+\\Delta t) = e^{(\\mathcal{A}+\\mathcal{B})\\Delta t} T(t)$。李分裂格式将其近似为 $e^{\\mathcal{B}\\Delta t}e^{\\mathcal{A}\\Delta t}T(t)$。该近似的误差可以使用贝克-坎贝尔-豪斯多夫（BCH）公式进行分析，对于非对易算子，该公式表述为：\n$$\ne^{\\mathcal{B}\\Delta t}e^{\\mathcal{A}\\Delta t} = e^{(\\mathcal{A}+\\mathcal{B})\\Delta t + \\frac{1}{2}[\\mathcal{B},\\mathcal{A}]\\Delta t^2 + O(\\Delta t^3)}\n$$\n其中 $[\\mathcal{B},\\mathcal{A}] = \\mathcal{B}\\mathcal{A} - \\mathcal{A}\\mathcal{B}$ 是算子的对易子。分裂的局部截断误差是精确传播子与近似传播子之差：\n$$\ne^{(\\mathcal{A}+\\mathcal{B})\\Delta t} - e^{\\mathcal{B}\\Delta t}e^{\\mathcal{A}\\Delta t} \\approx -\\frac{1}{2}[\\mathcal{B},\\mathcal{A}]\\Delta t^2.\n$$\n局部误差是 $O(\\Delta t^2)$ 阶。对于总模拟时间 $T_{\\mathrm{end}}$，步数为 $N = T_{\\mathrm{end}}/\\Delta t$。因此，作为局部误差累积的全局误差是 $N \\times O(\\Delta t^2) = (T_{\\mathrm{end}}/\\Delta t) \\times O(\\Delta t^2) = O(\\Delta t)$ 阶。这意味着李分裂格式是一阶方法，观测到的收敛阶 $p$ 应约等于 $1$。对易子 $[\\mathcal{B},\\mathcal{A}]$ 非零，因为源算子 $\\mathcal{B}$ 依赖于 $T$，而扩散算子 $\\mathcal{A}$ 涉及 $T$ 的空间导数。加热会改变温度分布，进而改变驱动扩散的温度曲率，因此操作的顺序很重要。一个例外是案例2，其中 $J = 0$，导致 $q=0$ 和 $\\mathcal{B}=0$。在这种情况下，$[\\mathcal{B},\\mathcal{A}]=0$，分裂误差消失，总误差仅由子问题的离散化方法决定。\n\n### **离散化与实现**\n\n空间域 $x \\in [0, L]$ 被离散为 $N_x$ 个网格点 $x_i = i \\Delta x$，其中 $i=0, \\dots, N_x-1$，间距为 $\\Delta x = L/(N_x-1)$。\n\n**1. 扩散步（算子 $\\Phi_A$）：**\n我们使用隐式后向欧拉方法求解 $C\\,\\partial_t T = k\\,\\partial_{xx} T$。对于内部节点 $i=1, \\dots, N_x-2$，离散方程为：\n$$\n\\frac{T^{n+1/2}_i - T^n_i}{\\Delta t} = \\frac{k}{C} \\frac{T^{n+1/2}_{i+1} - 2T^{n+1/2}_i + T^{n+1/2}_{i-1}}{\\Delta x^2}\n$$\n整理后得到关于未知温度 $T^{n+1/2}_i$ 的线性系统：\n$$\n-r T^{n+1/2}_{i-1} + (1+2r) T^{n+1/2}_i - r T^{n+1/2}_{i+1} = T^n_i\n$$\n其中 $r = \\frac{k\\,\\Delta t}{C\\,\\Delta x^2}$ 是无量纲扩散数。这为内部节点构成了一个包含 $N_x-2$ 个线性方程的三对角系统。狄利克雷边界条件 $T^{n+1/2}_0 = T_b$ 和 $T^{n+1/2}_{N_x-1} = T_b$ 通过将其贡献移到节点 $i=1$ 和 $i=N_x-2$ 方程的右侧来并入系统。得到的系统可以使用标准的三对角矩阵求解器（如 `scipy.linalg.solve_banded`）高效求解。后向欧拉方法是A-稳定的，这对于处理可能存在的刚性扩散项而无须对 $\\Delta t_s$ 施加严格限制至关重要。\n\n**2. 源项步（算子 $\\Phi_B$）：**\n我们对每个内部节点 $i=1, \\dots, N_x-2$ 求解常微分方程(ODEs)组 $\\partial_t T_i = \\mathcal{B}(T_i) = q(J,T_i)/C$。这通过二阶显式休恩方法完成。对于每个节点，给定步初的温度 $T_i^{\\text{in}} = T^{n+1/2}_i$，更新过程如下：\n- **预测步：** $\\tilde{T}_i = T_i^{\\text{in}} + \\Delta t \\cdot \\frac{q(J, T_i^{\\text{in}})}{C}$\n- **校正步：** $T^{n+1}_i = T_i^{\\text{in}} + \\frac{\\Delta t}{2C} \\left( q(J, T_i^{\\text{in}}) + q(J, \\tilde{T}_i) \\right)$\n此方法逐点应用于所有内部节点。更新后，重新强制施加边界条件：$T^{n+1}_0 = T_b$ 和 $T^{n+1}_{N_x-1} = T_b$。\n\n**3. 收敛性分析：**\n使用几个粗时间步长 $\\Delta t_k$ 计算数值解，并与一个使用更小时间步长 $\\Delta t_{\\mathrm{ref}}$ 得到的参考解进行比较。误差通过最终时间 $T_{\\mathrm{end}}$ 的空间均方根（RMS）误差来量化：\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N_x}\\sum_{i=0}^{N_x-1}\\left(T_i^{\\mathrm{coarse}} - T_i^{\\mathrm{ref}}\\right)^2}\n$$\n观测到的收敛阶 $p$ 根据两次误差计算（$\\mathrm{RMS}_1$ 和 $\\mathrm{RMS}_2$），对应于时间步长 $\\Delta t_1$ 和 $\\Delta t_2 = \\Delta t_1 / r_t$ 来估算：\n$$\np = \\frac{\\log(\\mathrm{RMS}_1 / \\mathrm{RMS}_2)}{\\log(r_t)}\n$$\n对于一阶方法，我们预期 $p \\approx 1$。\n\n整个算法通过初始化温度分布，然后迭代执行两步（扩散-源）更新直至达到 $T_{\\mathrm{end}}$ 来进行。对每个测试案例重复此过程，以计算所需的RMS误差和收敛阶。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D quench propagation problem using a Lie operator splitting scheme\n    and analyzes its convergence for three different test cases.\n    \"\"\"\n\n    # Physical and numerical parameters\n    L = 0.1  # m\n    Tb = 4.2  # K\n    k = 50.0  # W/(m.K)\n    C = 3.0e6  # J/(m^3.K)\n    Tc = 9.2  # K\n    Jc0 = 3.0e8  # A/m^2\n    Ec = 1.0e-4  # V/m\n    n = 15.0\n    epsilon = 1.0e-3  # A/m^2\n    rho0 = 1.0e-9  # Ohm.m\n    beta = 5.0e-3  # K^-1\n    Nx = 81\n    delta_T_init = 20.0  # K\n    sigma_init = 0.004  # m\n    T_end = 2.0e-4  # s\n    dt_ref = 2.5e-6  # s\n    coarse_dts = [4.0e-5, 2.0e-5, 1.0e-5] # s\n    time_step_ratio = 2.0\n\n    # Test cases for current density J\n    test_cases_J = [\n        1.0e8,  # Case 1: typical current\n        0.0,    # Case 2: no source edge case\n        4.0e8   # Case 3: stiff source regime\n    ]\n\n    # Helper functions for the source term q(J, T)\n    def get_Jc(T):\n        return Jc0 * np.maximum(0.0, 1.0 - T / Tc)\n\n    def get_rho_eff(T):\n        return rho0 * (1.0 + beta * np.maximum(T - Tb, 0.0))\n\n    def get_E(J, T):\n        if J == 0.0:\n            return np.zeros_like(T)\n        \n        Jc = get_Jc(T)\n        rho_eff = get_rho_eff(T)\n        \n        E_n = rho_eff * J\n        \n        # Guard against division by zero or very small Jc\n        safe_Jc = np.maximum(Jc, epsilon)\n        E_sc = Ec * (J / safe_Jc)**n\n        \n        # Piecewise definition of E\n        E = np.where(T  Tc, np.minimum(E_sc, E_n), E_n)\n        return E\n\n    def get_q(J, T):\n        return get_E(J, T) * J\n\n    # Main simulation function\n    def compute_evolution(J, dt):\n        \"\"\"\n        Computes the temperature evolution up to T_end for a given J and dt.\n        \"\"\"\n        x = np.linspace(0, L, Nx)\n        dx = L / (Nx - 1)\n        \n        # Initial condition\n        T = Tb + delta_T_init * np.exp(-(x - L / 2)**2 / (2 * sigma_init**2))\n        \n        num_steps = int(np.ceil(T_end / dt))\n        actual_dt = T_end / num_steps\n\n        # --- Diffusion Step Setup (Backward Euler) ---\n        r = (k * actual_dt) / (C * dx**2)\n        \n        A_banded = np.zeros((3, Nx - 2))\n        A_banded[0, 1:] = -r  # Upper diagonal\n        A_banded[1, :] = 1.0 + 2.0 * r  # Main diagonal\n        A_banded[2, :-1] = -r  # Lower diagonal\n\n        # --- Time-stepping loop ---\n        for _ in range(num_steps):\n            # Step A: Diffusion\n            # Setup RHS b for Ax=b, with boundary conditions\n            b = T[1:-1].copy()\n            b[0] += r * Tb\n            b[-1] += r * Tb\n            \n            # Solve the tridiagonal system for interior nodes\n            T_half_interior = solve_banded((1, 1), A_banded, b)\n            \n            # Reconstruct T_half with boundary conditions\n            T_half = np.full(Nx, Tb)\n            T_half[1:-1] = T_half_interior\n\n            # Step B: Source (Heun's Method)\n            T_in_interior = T_half[1:-1]\n            \n            # Predictor\n            q_in = get_q(J, T_in_interior)\n            k1 = q_in / C\n            T_pred_interior = T_in_interior + actual_dt * k1\n            \n            # Corrector\n            q_pred = get_q(J, T_pred_interior)\n            k2 = q_pred / C\n            T_new_interior = T_in_interior + 0.5 * actual_dt * (k1 + k2)\n            \n            # Update temperature profile and enforce BCs\n            T[1:-1] = T_new_interior\n            T[0] = Tb\n            T[-1] = Tb\n            \n        return T\n\n    # Main logic to run test cases and compute errors\n    all_results = []\n    \n    for J_case in test_cases_J:\n        # Compute reference solution with fine time step\n        T_ref = compute_evolution(J_case, dt_ref)\n        \n        rms_errors = []\n        # Compute solutions with coarse time steps and find errors\n        for dt_coarse in coarse_dts:\n            T_coarse = compute_evolution(J_case, dt_coarse)\n            rms = np.sqrt(np.mean((T_coarse - T_ref)**2))\n            rms_errors.append(rms)\n        \n        all_results.extend(rms_errors)\n        \n        # Compute observed convergence orders\n        # Handle cases where error is zero to avoid log(0)\n        if rms_errors[0] > 0 and rms_errors[1] > 0:\n            p12 = np.log(rms_errors[0] / rms_errors[1]) / np.log(time_step_ratio)\n        else:\n            p12 = np.nan\n\n        if rms_errors[1] > 0 and rms_errors[2] > 0:\n            p23 = np.log(rms_errors[1] / rms_errors[2]) / np.log(time_step_ratio)\n        else:\n            p23 = np.nan\n        \n        all_results.append(p12)\n        all_results.append(p23)\n\n    # Print the final results in the required format\n    print(f\"[{','.join(f'{val:.8f}' for val in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}