{
    "hands_on_practices": [
        {
            "introduction": "Modeling the complex thermal behavior of a superconducting strand during a quench often begins with a critical question: can we simplify the problem? If heat diffuses within the strand much faster than it is removed at its surface, we can treat the strand as a single \"lump\" with a uniform temperature, simplifying a partial differential equation to an ordinary one. This exercise  guides you through the derivation of the Biot number, the dimensionless group that rigorously justifies this lumped capacitance approximation by comparing internal and external thermal resistances.",
            "id": "4035655",
            "problem": "A single strand within a Cable-in-Conduit Conductor (CICC) for a tokamak magnet experiences an incipient quench, during which a small region transitions to the normal state and begins to heat. Consider the early-time radial thermal response of the strand, when axial heat transport and helium hydrodynamics are negligible compared to radial diffusion and interfacial heat transfer to the surrounding forced-flow helium bath. Assume the strand can be treated as a homogeneous medium with constant properties over the short timescale of interest, and that the helium temperature far from the strand remains uniform.\n\nStarting from the transient energy conservation law for a solid, the constitutive relation for heat conduction, and a convective boundary condition at the strand–helium interface, non-dimensionalize the radial heat conduction problem using a characteristic length $L$ and identify the dimensionless group that quantifies the ratio of interfacial (external) thermal resistance to internal conduction resistance at the boundary. This group, when evaluated for the given parameters, is traditionally used to assess the validity of the lumped thermal capacitance approximation.\n\nUse the following data representative of initial quench conditions in a CICC strand at cryogenic temperature:\n- Effective radial thermal conductivity of the composite strand: $k = 600 \\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n- Effective convective heat transfer coefficient to the surrounding helium: $h = 7.5 \\times 10^{3} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$.\n- Characteristic length of the strand (based on geometry and surface exposure): $L = 2.0 \\times 10^{-4} \\,\\mathrm{m}$.\n\nCompute the value of the identified dimensionless group for the strand with the given $L$, and, based on its magnitude, argue whether a lumped thermal capacitance model is justified for initial quench analyses in Cable-in-Conduit Conductors (CICCs).\n\nReport the numerical value of the dimensionless group as a pure number (no units), rounded to three significant figures. In your reasoning, clearly state any additional assumptions you invoke and justify the applicability of the lumped capacitance model on the basis of first principles without invoking any shortcut formulas not derived from the governing equations.",
            "solution": "The problem requires the non-dimensionalization of the radial heat conduction equation for a superconducting strand to identify the dimensionless group governing the boundary condition, calculation of its value, and an assessment of the lumped thermal capacitance model's applicability.\n\nThe analysis begins with the fundamental principles of transient heat transfer. The conservation of energy within a solid with constant properties and no internal heat generation is described by the heat diffusion equation. For simplicity, we consider a one-dimensional Cartesian coordinate system, where $x$ represents the spatial variable along the characteristic length $L$. The temperature field is denoted by $T(x, t)$. The governing equation is:\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} $$\nwhere $\\rho$ is the density, $c_p$ is the specific heat capacity, and $k$ is the thermal conductivity of the strand material. This can be rewritten using the thermal diffusivity, $\\alpha = k/(\\rho c_p)$, as:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\n\nAt the boundary of the strand (which we can place at $x=L$ without loss of generality), heat is transferred to the surrounding helium bath via convection. The helium bath is assumed to be at a constant, uniform temperature $T_\\infty$. The boundary condition equates the conductive heat flux from the solid to the convective heat flux into the fluid:\n$$ -k \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=L} = h (T(L,t) - T_\\infty) $$\nHere, $h$ is the convective heat transfer coefficient.\n\nTo non-dimensionalize the problem, we introduce dimensionless variables. Let $T_i$ be a reference initial temperature of the strand.\nA dimensionless temperature $\\theta$ is defined as:\n$$ \\theta = \\frac{T - T_\\infty}{T_i - T_\\infty} $$\nA dimensionless spatial coordinate $X$ is defined using the characteristic length $L$:\n$$ X = \\frac{x}{L} $$\nWe will now transform the boundary condition using these new variables. The derivatives transform as:\n$$ \\frac{\\partial}{\\partial x} = \\frac{\\partial}{\\partial X} \\frac{dX}{dx} = \\frac{1}{L} \\frac{\\partial}{\\partial X} $$\nSubstituting the transformations into the boundary condition equation:\n$$ -k \\left( \\frac{1}{L} \\frac{\\partial}{\\partial X} \\left[ \\theta(T_i - T_\\infty) + T_\\infty \\right] \\right)_{X=1} = h \\left( \\left[ \\theta(T_i - T_\\infty) + T_\\infty \\right] - T_\\infty \\right)_{X=1} $$\nSince $T_i$ and $T_\\infty$ are constants, this simplifies to:\n$$ -k \\frac{T_i - T_\\infty}{L} \\left. \\frac{\\partial \\theta}{\\partial X} \\right|_{X=1} = h \\left( \\theta(1,t) (T_i - T_\\infty) \\right) $$\nAssuming $T_i \\neq T_\\infty$, we can cancel the term $(T_i - T_\\infty)$ from both sides:\n$$ -\\frac{k}{L} \\left. \\frac{\\partial \\theta}{\\partial X} \\right|_{X=1} = h \\, \\theta(1,t) $$\nRearranging to group the physical parameters yields the dimensionless form of the boundary condition:\n$$ \\left. \\frac{\\partial \\theta}{\\partial X} \\right|_{X=1} = - \\left( \\frac{hL}{k} \\right) \\theta(1,t) $$\nThe dimensionless group that naturally arises from this process is $\\frac{hL}{k}$. This is known as the Biot number, symbolized as $Bi$.\n$$ Bi = \\frac{hL}{k} $$\n\nThe problem statement asks to identify the group quantifying the \"ratio of interfacial (external) thermal resistance to internal conduction resistance\". Let us analyze the physical meaning of the Biot number. The internal conduction resistance, $R_{\\text{cond}}$, over a characteristic length $L$ and for a cross-sectional area $A$ can be characterized as $R_{\\text{cond}} \\sim \\frac{L}{kA}$. The external convection resistance, $R_{\\text{conv}}$, at the surface is $R_{\\text{conv}} = \\frac{1}{hA}$. The ratio of these two resistances is:\n$$ \\frac{R_{\\text{cond}}}{R_{\\text{conv}}} = \\frac{L/kA}{1/hA} = \\frac{hL}{k} = Bi $$\nThus, the Biot number represents the ratio of the internal resistance to heat conduction to the external resistance to heat convection. The problem's phrasing asks for the reciprocal of this, $R_{\\text{conv}}/R_{\\text{cond}}$. However, the Biot number is the conventional and fundamental parameter that governs the thermal response in this context, and its value is the basis for assessing the lumped capacitance approximation. We identify the Biot number, $Bi = \\frac{hL}{k}$, as the relevant dimensionless group.\n\nThe lumped thermal capacitance approximation assumes that the temperature within the body is spatially uniform, i.e., $T(x,t) \\approx T(t)$. This assumption is valid when the internal resistance to heat transfer is negligible compared to the external resistance. In terms of the Biot number, this condition is expressed as $Bi \\ll 1$. A commonly accepted engineering criterion for the validity of this approximation is $Bi  0.1$. If this condition holds, the temperature gradients within the solid are minimal, and the entire body can be treated as a single lump at a uniform temperature.\n\nWe now compute the value of the Biot number for the given parameters:\n- Effective radial thermal conductivity, $k = 600 \\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$\n- Effective convective heat transfer coefficient, $h = 7.5 \\times 10^{3} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$\n- Characteristic length, $L = 2.0 \\times 10^{-4} \\,\\mathrm{m}$\n\n$$ Bi = \\frac{hL}{k} = \\frac{(7.5 \\times 10^{3} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}) \\times (2.0 \\times 10^{-4} \\,\\mathrm{m})}{600 \\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}} $$\n$$ Bi = \\frac{1.5}{600} = \\frac{1.5}{6 \\times 10^2} = 0.25 \\times 10^{-2} = 0.0025 $$\nThe value of the dimensionless group is $0.0025$.\n\nTo report the value to three significant figures, we write it as $2.50 \\times 10^{-3}$.\n\nBased on this value, we can assess the applicability of the lumped capacitance model. The calculated Biot number is $Bi = 0.0025$. This value is significantly smaller than the threshold of $0.1$.\n$$ 0.0025 \\ll 0.1 $$\nThis indicates that the internal conduction resistance ($L/k$) is much smaller than the external convection resistance ($1/h$). Specifically, the ratio is $1:400$. Therefore, heat conducted to the surface of the strand is removed by convection far more slowly than it is supplied from the interior. This results in very small temperature gradients within the strand. The assumption of a spatially uniform temperature profile is well-justified. Consequently, a lumped thermal capacitance model is an appropriate and accurate simplification for analyzing the early-time thermal response of the given CICC strand during a quench.",
            "answer": "$$\\boxed{2.50 \\times 10^{-3}}$$"
        },
        {
            "introduction": "A superconductor's stability against transient energy disturbances is determined by its \"energy margin\"—how much energy it can absorb before its temperature rises critically. This energy buffer is quantified by the material's enthalpy, which is the integral of its specific heat capacity, $c_p(T)$. This practice  involves a hands-on computational exercise to calculate the enthalpy of copper, revealing why even tiny energy depositions can cause large temperature spikes at cryogenic conditions and exploring the profound implications for quench initiation.",
            "id": "4035639",
            "problem": "A copper stabilizer in a superconducting cable transitions from cryogenic conditions to ambient temperature during a quench. The mass-specific enthalpy increment from an initial temperature $T_0$ to a final temperature $T$ is defined by the integral of the mass-specific isobaric heat capacity with respect to temperature. Begin from the fundamental thermodynamic definition that the enthalpy change per unit mass satisfies\n$$\nh(T) - h(T_0) = \\int_{T_0}^{T} c_p(\\tau)\\, d\\tau,\n$$\nwhere $c_p(T)$ is the mass-specific isobaric heat capacity. For copper, a physically motivated and widely accepted model decomposes the molar heat capacity into phonon and electronic contributions. The phonon contribution is described by the Debye model,\n$$\nc_{p,\\mathrm{phonon}}(T) = 9 R \\left(\\frac{T}{\\Theta_D}\\right)^3 \\int_0^{\\Theta_D/T} \\frac{x^4 e^x}{\\left(e^x - 1\\right)^2}\\, dx,\n$$\nand the conduction electron contribution is well approximated at low temperature by\n$$\nc_{p,\\mathrm{electron}}(T) = \\gamma T,\n$$\nso that the molar heat capacity is\n$$\nc_{p,\\mathrm{molar}}(T) = c_{p,\\mathrm{phonon}}(T) + c_{p,\\mathrm{electron}}(T).\n$$\nConverting from molar to mass basis requires division by the molar mass $M$, so the mass-specific heat capacity is $c_p(T) = c_{p,\\mathrm{molar}}(T)/M$. An analytic fitted alternative that captures the low-temperature $T^3$ phonon scaling and the high-temperature saturation is\n$$\nc_{p,\\mathrm{fit,molar}}(T) = 3R\\frac{T^3}{T^3 + \\Theta_D^3} + \\gamma T,\n$$\nwith the corresponding mass-specific $c_p(T)$ again given by division by $M$.\n\nUse the above physically grounded definitions to compute the mass-specific enthalpy increment from $T_0 = 4.2\\,\\mathrm{K}$ to $T = 300\\,\\mathrm{K}$ for copper using both the Debye-plus-electron model and the analytic fitted model. Assume the molar mass $M = 63.546\\times 10^{-3}\\,\\mathrm{kg/mol}$, the universal gas constant $R = 8.314\\,\\mathrm{J/(mol\\cdot K)}$, Debye temperature $\\Theta_D = 343\\,\\mathrm{K}$, and electronic coefficient $\\gamma = 0.695\\times 10^{-3}\\,\\mathrm{J/(mol\\cdot K^2)}$. Express all enthalpy increments in $\\mathrm{J/kg}$, rounded to three decimal places.\n\nIn the context of quench propagation in superconducting cables, discuss the significance of the low-temperature plateau in the enthalpy–temperature curve, starting from the structure of $c_p(T)$ and the above integral relationship. Explain what features in $c_p(T)$ produce slow enthalpy accumulation below approximately $20\\,\\mathrm{K}$ and how this affects the energy margin and the initial dynamics of a normal zone.\n\nTest suite and required output:\n- Use the following five test cases:\n    1. Debye-plus-electron model with $T_0=4.2\\,\\mathrm{K}$ and $T=300\\,\\mathrm{K}$.\n    2. Analytic fitted model with $T_0=4.2\\,\\mathrm{K}$ and $T=300\\,\\mathrm{K}$.\n    3. Debye-plus-electron model with $T_0=4.2\\,\\mathrm{K}$ and $T=4.2\\,\\mathrm{K}$ (boundary case).\n    4. Debye-plus-electron model with $T_0=4.2\\,\\mathrm{K}$ and $T=20\\,\\mathrm{K}$ (low-temperature regime).\n    5. Analytic fitted model with $T_0=4.2\\,\\mathrm{K}$ and $T=20\\,\\mathrm{K}$ (low-temperature regime).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the same order as the test cases, for example, $[r_1,r_2,r_3,r_4,r_5]$, where each $r_i$ is the enthalpy increment in $\\mathrm{J/kg}$ rounded to three decimal places.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective, meeting all criteria for validity. It presents a standard problem in cryogenic engineering and solid-state physics, using established physical models and accepted parameter values for copper. The tasks are clearly defined and solvable with the information provided.\n\nThe mass-specific enthalpy increment, $\\Delta h$, from an initial temperature $T_0$ to a final temperature $T$ is fundamentally defined by the integral of the mass-specific isobaric heat capacity, $c_p(T)$, over that temperature range:\n$$\n\\Delta h = h(T) - h(T_0) = \\int_{T_0}^{T} c_p(\\tau)\\, d\\tau\n$$\nThis relationship shows that the enthalpy is the accumulated heat capacity. Regions where $c_p(T)$ is small will contribute little to the total enthalpy increment. We are asked to compute this quantity for copper, whose mass-specific heat capacity $c_p(T)$ is derived from the molar heat capacity $c_{p,\\mathrm{molar}}(T)$ by division with the molar mass $M = 63.546 \\times 10^{-3}\\,\\mathrm{kg/mol}$. The molar heat capacity is the sum of contributions from lattice vibrations (phonons) and conduction electrons, $c_{p,\\mathrm{molar}}(T) = c_{p,\\mathrm{phonon}}(T) + c_{p,\\mathrm{electron}}(T)$.\n\nAt low temperatures ($T \\ll \\Theta_D$, where the Debye temperature for copper is $\\Theta_D = 343\\,\\mathrm{K}$), both the full Debye model and the analytic fit for the phonon contribution exhibit the well-known Debye $T^3$ law, meaning $c_{p,\\mathrm{phonon}}(T) \\propto T^3$. For the analytic fitted model, this is explicit: for $T \\ll \\Theta_D$, the molar heat capacity $c_{p,\\mathrm{fit,molar}}(T) = 3R\\frac{T^3}{T^3 + \\Theta_D^3} + \\gamma T \\approx \\frac{3R}{\\Theta_D^3}T^3 + \\gamma T$. The conduction electron contribution is linear in temperature, $c_{p,\\mathrm{electron}}(T) = \\gamma T$, where the electronic coefficient is $\\gamma = 0.695 \\times 10^{-3}\\,\\mathrm{J/(mol\\cdot K^2)}$.\n\nTherefore, at very low temperatures, typically below $20\\,\\mathrm{K}$, the total mass-specific heat capacity has the form $c_p(T) \\approx (A T^3 + \\gamma T)/M$, where $A$ is a constant. Both terms, $T^3$ and $T$, are very small in this regime, resulting in an extremely small overall heat capacity.\n\nThis low value of $c_p(T)$ is the direct cause of the very slow accumulation of enthalpy with increasing temperature, starting from the cryogenic operating point of $T_0 = 4.2\\,\\mathrm{K}$. On a plot of $h(T)$ versus $T$, this manifests as a region of very low slope, as the slope is precisely $dh/dT = c_p(T)$. This feature is sometimes loosely referred to as a \"low-temperature plateau,\" although it is more accurately described as a region of near-zero enthalpy content and slow enthalpy growth. The enthalpy does not plateau at a non-zero value; rather, it remains close to its reference value of $h(T_0)=0$.\n\nThe physical significance of this behavior is profound for the stability of superconducting magnets.\n\n$1$. **Energy Margin**: The energy margin of a superconducting cable is the maximum energy density it can absorb from a transient disturbance without its temperature rising above the critical temperature, at which point it transitions to the normal, resistive state (a \"quench\"). The temperature rise $\\Delta T$ resulting from an absorbed energy density $\\Delta E$ is approximately $\\Delta T \\approx \\Delta E / c_p(T)$, assuming the energy is deposited faster than it can be conducted away. Because $c_p(T)$ is exceptionally small near the operating temperature of $4.2\\,\\mathrm{K}$, even a minuscule energy deposition can cause a large, and potentially critical, temperature excursion. This results in a very small energy margin, making the superconductor highly susceptible to disturbances like mechanical vibrations or flux jumps.\n\n$2$. **Quench Propagation Dynamics**: If a local disturbance is sufficient to create a small normal zone, this zone will begin to generate resistive Joule heat ($P = I^2 R$). This heat must be absorbed by the surrounding material. The very low enthalpy content (and low $c_p(T)$) of the copper stabilizer at these cryogenic temperatures means it cannot effectively absorb this heat. Consequently, the temperature of the normal zone rises very rapidly. This rapid temperature increase creates a steep thermal gradient, driving heat into adjacent superconducting regions, raising their temperature, and causing the normal zone to grow. The slow accumulation of enthalpy below approximately $20\\,\\mathrm{K}$ thus facilitates a rapid initial temperature rise and fast propagation of the quench, a critical consideration in the design of magnet protection systems.\n\nThe following computational solution will quantify these effects by calculating the enthalpy increment for the specified temperature ranges using both the rigorous Debye-plus-electron model and the convenient analytic fit. The integrals required are computed numerically. The Debye model requires a nested numerical integration, as its definition of $c_{p,\\mathrm{phonon}}(T)$ contains an integral itself. The analytic model's $c_p(T)$ allows for a more direct single integration with respect to temperature.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the mass-specific enthalpy increment for copper using\n    two different models for specific heat capacity and for several\n    temperature ranges.\n    \"\"\"\n\n    # Define physical constants as per the problem statement.\n    M = 63.546e-3      # Molar mass of copper (kg/mol)\n    R = 8.314          # Universal gas constant (J/(mol*K))\n    THETA_D = 343.0    # Debye temperature of copper (K)\n    GAMMA = 0.695e-3   # Electronic specific heat coefficient (J/(mol*K^2))\n\n    # --- Model Definitions ---\n\n    def debye_integrand(x):\n        \"\"\"Integrand for the Debye integral part of the phonon heat capacity.\"\"\"\n        if x == 0:\n            return 0.0\n        # The expression is numerically stable for x0. np.exp handles large x.\n        return (x**4 * np.exp(x)) / (np.exp(x) - 1)**2\n\n    def cp_molar_debye(T):\n        \"\"\"\n        Calculates the molar heat capacity of copper at temperature T\n        using the Debye-plus-electron model.\n        \"\"\"\n        if T = 0:\n            return 0.0\n        \n        # Phonon contribution (Debye model)\n        # The integral is computed numerically using quad.\n        integral_val, _ = quad(debye_integrand, 0, THETA_D / T)\n        cp_phonon = 9 * R * (T / THETA_D)**3 * integral_val\n        \n        # Conduction electron contribution\n        cp_electron = GAMMA * T\n        \n        return cp_phonon + cp_electron\n\n    def cp_mass_debye(T):\n        \"\"\"Mass-specific heat capacity for the Debye-plus-electron model.\"\"\"\n        return cp_molar_debye(T) / M\n\n    def cp_molar_analytic(T):\n        \"\"\"\n        Calculates the molar heat capacity of copper at temperature T\n        using the analytic fitted model.\n        \"\"\"\n        if T = 0:\n            return 0.0\n            \n        # Phonon contribution (fitted model)\n        cp_phonon_fit = 3 * R * (T**3) / (T**3 + THETA_D**3)\n        \n        # Conduction electron contribution\n        cp_electron = GAMMA * T\n        \n        return cp_phonon_fit + cp_electron\n\n    def cp_mass_analytic(T):\n        \"\"\"Mass-specific heat capacity for the analytic fitted model.\"\"\"\n        return cp_molar_analytic(T) / M\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'model': 'debye', 'T_start': 4.2, 'T_end': 300.0},\n        {'model': 'analytic', 'T_start': 4.2, 'T_end': 300.0},\n        {'model': 'debye', 'T_start': 4.2, 'T_end': 4.2},\n        {'model': 'debye', 'T_start': 4.2, 'T_end': 20.0},\n        {'model': 'analytic', 'T_start': 4.2, 'T_end': 20.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        T_start = case['T_start']\n        T_end = case['T_end']\n\n        # Handle the trivial case where the integral is zero.\n        if T_end == T_start:\n            enthalpy_increment = 0.0\n            results.append(enthalpy_increment)\n            continue\n\n        # Select the appropriate specific heat function based on the model.\n        if case['model'] == 'debye':\n            integrand_func = cp_mass_debye\n        else:  # 'analytic'\n            integrand_func = cp_mass_analytic\n\n        # Perform numerical integration to find the enthalpy increment.\n        # quad returns the integral result and an estimated absolute error.\n        h_increment, _ = quad(integrand_func, T_start, T_end, limit=100)\n        results.append(h_increment)\n\n    # Round all results to three decimal places.\n    rounded_results_str = [f\"{res:.3f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(rounded_results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "To capture the full dynamics of quench propagation, we must solve the coupled, non-linear equations governing heat diffusion and resistive heating. This advanced practice  culminates our study by building a complete 1D numerical simulation of a quench event from first principles. You will implement a powerful operator splitting scheme to handle the distinct physics of thermal diffusion and non-linear heat generation, and critically, you will learn to verify your simulation's accuracy through a convergence analysis—an essential skill in computational science.",
            "id": "4035613",
            "problem": "Consider a one-dimensional superconducting cable segment modeled on the spatial domain $x \\in [0,L]$ with Dirichlet boundary conditions $T(0,t)=T_b$ and $T(L,t)=T_b$. The thermal field $T(x,t)$ evolves due to conduction and Joule heating generated by an electric field $E(J,T)$ with a specified transport current density $J$. The model is based on energy conservation and Fourier heat conduction, yielding the Partial Differential Equation (PDE)\n$$\nC \\,\\frac{\\partial T}{\\partial t} \\;=\\; k \\,\\frac{\\partial^2 T}{\\partial x^2} \\;+\\; q(J,T),\n$$\nwhere $C$ is the volumetric heat capacity, $k$ is the thermal conductivity, and $q(J,T)$ is the volumetric Joule heating defined by $q(J,T) = E(J,T)\\,J$. All physical quantities and units must be handled consistently: temperature in kelvin (K), length in meters (m), time in seconds (s), electric field in volts per meter (V/m), and current density in amperes per square meter (A/m$^2$). The cable length is $L$, and the bath temperature is $T_b$.\n\nThe electrical constitutive relation $E(J,T)$ captures the transition from superconducting to normal behavior. Define the critical current density $J_c(T)$ by\n$$\nJ_c(T) \\;=\\; J_{c0} \\,\\max\\!\\left(0, 1 - \\frac{T}{T_c}\\right),\n$$\nwhere $J_{c0}$ is the zero-temperature critical current density and $T_c$ is the critical temperature. For $T  T_c$, adopt a power-law electric field\n$$\nE_{\\mathrm{sc}}(J,T) \\;=\\; E_c \\,\\left(\\frac{J}{\\max(J_c(T),\\epsilon)}\\right)^n,\n$$\nwith critical electric field $E_c$, power-law index $n$, and a small safeguard $\\epsilon0$ in A/m$^2$. For $T \\ge T_c$, use an effective normal-state resistivity $\\rho_{\\mathrm{eff}}(T)$ such that\n$$\nE_{\\mathrm{n}}(J,T) \\;=\\; \\rho_{\\mathrm{eff}}(T)\\,J, \\qquad \\rho_{\\mathrm{eff}}(T) \\;=\\; \\rho_0 \\left(1 + \\beta\\,\\max\\!\\big(T - T_b, 0\\big)\\right),\n$$\nwith $\\rho_0$ in $\\Omega\\cdot\\mathrm{m}$ and $\\beta$ in $\\mathrm{K}^{-1}$. To avoid unphysical divergence near $T\\approx T_c$, let\n$$\nE(J,T) \\;=\\; \\begin{cases}\n\\min\\!\\big(E_{\\mathrm{sc}}(J,T), \\rho_{\\mathrm{eff}}(T)\\,J\\big),  T  T_c, \\\\\n\\rho_{\\mathrm{eff}}(T)\\,J,  T \\ge T_c.\n\\end{cases}\n$$\n\nImplement a Lie operator splitting scheme that alternates updates of the thermal field $T$ and the electric field $E(J,T)$ at each time step $\\Delta t$ by splitting the evolution into two operators:\n- Thermal diffusion operator $A$: solve $C\\,\\partial_t T = k\\,\\partial_{xx} T$ over a time interval $\\Delta t$ with Dirichlet boundaries.\n- Source heating operator $B$: solve $\\partial_t T = q(J,T)/C$ over a time interval $\\Delta t$ pointwise in space.\n\nThe Lie splitting step from $T^n$ to $T^{n+1}$ is\n$$\nT^{n+1/2} \\;=\\; \\Phi_A(\\Delta t)\\,T^n, \\qquad T^{n+1} \\;=\\; \\Phi_B(\\Delta t)\\,T^{n+1/2},\n$$\nwhere $\\Phi_A$ and $\\Phi_B$ are the solution operators of $A$ and $B$, respectively. Use an implicit finite difference method for $\\Phi_A$ with time step $\\Delta t$ and spatial mesh spacing $\\Delta x = L/(N_x-1)$ on a uniform grid $x_i=i\\,\\Delta x$, $i=0,\\dots,N_x-1$. Specifically, use the backward Euler discretization for diffusion at interior nodes $i=1,\\dots,N_x-2$:\n$$\nT^{n+1/2}_i - r \\left(T^{n+1/2}_{i+1} - 2\\,T^{n+1/2}_i + T^{n+1/2}_{i-1}\\right) \\;=\\; T^n_i, \\qquad r = \\frac{k\\,\\Delta t}{C\\,\\Delta x^2},\n$$\nwith $T^{n+1/2}_0 = T_b$ and $T^{n+1/2}_{N_x-1} = T_b$. For $\\Phi_B$, integrate $\\partial_t T = q(J,T)/C$ using a second-order explicit method (for example, the Heun method) at each interior node while enforcing $T(0,t)=T_b$ and $T(L,t)=T_b$ after the source update.\n\nInitial condition: a localized hot spot superimposed on the bath,\n$$\nT(x,0) \\;=\\; T_b + \\Delta T \\,\\exp\\!\\left(-\\frac{(x - L/2)^2}{2\\,\\sigma^2}\\right).\n$$\n\nYour implementation must compute the numerical solution up to final time $T_{\\mathrm{end}}$ for specified parameters and time steps, and assess splitting convergence by comparing solutions at different $\\Delta t$ values to a reference solution obtained with a much smaller time step $\\Delta t_{\\mathrm{ref}}$. Use the spatial root-mean-square error\n$$\n\\mathrm{RMS} \\;=\\; \\left(\\frac{1}{N_x}\\sum_{i=0}^{N_x-1}\\left(T_i^{\\mathrm{coarse}} - T_i^{\\mathrm{ref}}\\right)^2\\right)^{1/2}\n$$\nexpressed in kelvin (K). Estimate observed convergence orders $p$ using consecutive error pairs and the time step ratio $r_t$ via\n$$\np \\;=\\; \\frac{\\log\\!\\left(\\mathrm{RMS}_{1}/\\mathrm{RMS}_{2}\\right)}{\\log\\!\\left(r_t\\right)}.\n$$\n\nJustify the splitting error and convergence criteria theoretically in your solution: start from the definition of operators $A$ and $B$, discuss the Baker–Campbell–Hausdorff expansion and the commutator $[A,B]$, and derive the local and global error orders for Lie splitting.\n\nPhysical and numerical parameters for all test cases:\n- Cable length $L = 0.1\\,\\mathrm{m}$, bath temperature $T_b = 4.2\\,\\mathrm{K}$.\n- Thermal conductivity $k = 50\\,\\mathrm{W/(m\\cdot K)}$, volumetric heat capacity $C = 3.0\\times 10^6\\,\\mathrm{J/(m^3\\cdot K)}$.\n- Electrical parameters: $T_c = 9.2\\,\\mathrm{K}$, $J_{c0} = 3.0\\times 10^8\\,\\mathrm{A/m^2}$, $E_c = 1.0\\times 10^{-4}\\,\\mathrm{V/m}$, $n = 15$, $\\epsilon = 10^{-3}\\,\\mathrm{A/m^2}$, $\\rho_0 = 1.0\\times 10^{-9}\\,\\Omega\\cdot\\mathrm{m}$, $\\beta = 5.0\\times 10^{-3}\\,\\mathrm{K^{-1}}$.\n- Spatial grid size $N_x = 81$.\n- Initial hot spot: $\\Delta T = 20.0\\,\\mathrm{K}$, $\\sigma = 0.004\\,\\mathrm{m}$.\n- Final time $T_{\\mathrm{end}} = 2.0\\times 10^{-4}\\,\\mathrm{s}$.\n- Reference time step $\\Delta t_{\\mathrm{ref}} = 2.5\\times 10^{-6}\\,\\mathrm{s}$.\n- Coarse time steps to test: $\\Delta t \\in \\{4.0\\times 10^{-5},\\, 2.0\\times 10^{-5},\\, 1.0\\times 10^{-5}\\}\\,\\mathrm{s}$ with ratio $r_t = 2$ between consecutive values.\n\nTest suite:\n- Case $1$ (typical current): $J = 1.0\\times 10^8\\,\\mathrm{A/m^2}$.\n- Case $2$ (no source edge case): $J = 0.0\\,\\mathrm{A/m^2}$.\n- Case $3$ (stiff source regime): $J = 4.0\\times 10^8\\,\\mathrm{A/m^2}$.\n\nFor each case, compute the spatial root-mean-square errors at $T_{\\mathrm{end}}$ for the three coarse time steps compared to the reference, denoted $\\mathrm{RMS}_{\\Delta t_1}$, $\\mathrm{RMS}_{\\Delta t_2}$, $\\mathrm{RMS}_{\\Delta t_3}$, and the observed orders $p_{12}$ and $p_{23}$ computed from consecutive pairs with $r_t=2$. All errors must be expressed in kelvin (K), and the orders are dimensionless.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n\\big[ \\mathrm{RMS}^{(1)}_{\\Delta t_1}, \\mathrm{RMS}^{(1)}_{\\Delta t_2}, \\mathrm{RMS}^{(1)}_{\\Delta t_3}, p^{(1)}_{12}, p^{(1)}_{23}, \\mathrm{RMS}^{(2)}_{\\Delta t_1}, \\mathrm{RMS}^{(2)}_{\\Delta t_2}, \\mathrm{RMS}^{(2)}_{\\Delta t_3}, p^{(2)}_{12}, p^{(2)}_{23}, \\mathrm{RMS}^{(3)}_{\\Delta t_1}, \\mathrm{RMS}^{(3)}_{\\Delta t_2}, \\mathrm{RMS}^{(3)}_{\\Delta t_3}, p^{(3)}_{12}, p^{(3)}_{23} \\big],\n$$\nwhere the superscript $(c)$ denotes Case $c \\in \\{1,2,3\\}$. The numerical values must be printed as plain decimal floats, with errors in kelvin (K) and observed orders dimensionless.",
            "solution": "The problem requires the implementation and validation of a numerical scheme to solve a one-dimensional, non-linear partial differential equation (PDE) modeling thermal evolution in a superconducting cable. The validation must be performed by analyzing the convergence of the numerical solution.\n\n### **Problem Formulation**\nThe evolution of the temperature field $T(x,t)$ in a superconducting cable of length $L$ is governed by the heat diffusion equation with a non-linear source term:\n$$\nC \\,\\frac{\\partial T}{\\partial t} \\;=\\; k \\,\\frac{\\partial^2 T}{\\partial x^2} \\;+\\; q(J,T) \\quad \\text{for } x \\in (0, L), t  0\n$$\nwhere $C$ is the volumetric heat capacity, $k$ is the thermal conductivity, and $q(J,T) = E(J,T)J$ is the volumetric Joule heating. The transport current density is $J$. The cable is subject to Dirichlet boundary conditions $T(0,t) = T(L,t) = T_b$, where $T_b$ is the constant bath temperature.\n\nThe electric field $E(J,T)$ is defined by a piecewise model that captures the superconducting-to-normal transition:\n$$\nE(J,T) \\;=\\; \\begin{cases}\n\\min\\!\\big(E_{\\mathrm{sc}}(J,T), \\rho_{\\mathrm{eff}}(T)\\,J\\big),  T  T_c, \\\\\n\\rho_{\\mathrm{eff}}(T)\\,J,  T \\ge T_c,\n\\end{cases}\n$$\nwhere $T_c$ is the critical temperature. The terms are:\n- Critical current density: $J_c(T) = J_{c0} \\,\\max(0, 1 - T/T_c)$\n- Superconducting E-field (power-law): $E_{\\mathrm{sc}}(J,T) = E_c \\left(J/\\max(J_c(T),\\epsilon)\\right)^n$\n- Effective normal-state resistivity: $\\rho_{\\mathrm{eff}}(T) = \\rho_0 (1 + \\beta\\,\\max(T - T_b, 0))$\n\nThe initial condition is a Gaussian hot spot: $T(x,0) = T_b + \\Delta T \\,\\exp\\!\\left(-(x - L/2)^2/(2\\,\\sigma^2)\\right)$.\n\n### **Numerical Method: Lie Operator Splitting**\n\nThe PDE can be written in the abstract form $\\partial_t T = \\mathcal{A}(T) + \\mathcal{B}(T)$, where:\n- $\\mathcal{A}(T) = \\alpha_T \\frac{\\partial^2 T}{\\partial x^2}$ is the linear thermal diffusion operator, with thermal diffusivity $\\alpha_T = k/C$.\n- $\\mathcal{B}(T) = \\frac{q(J,T)}{C}$ is the non-linear heat source operator.\n\nThe Lie splitting scheme approximates the evolution over a time step $\\Delta t$ by solving the two sub-problems sequentially:\n$$\nT^{n+1} = \\Phi_B(\\Delta t) \\Phi_A(\\Delta t) T^n\n$$\nwhere $\\Phi_A$ and $\\Phi_B$ are the solution operators for $\\partial_t T = \\mathcal{A}(T)$ and $\\partial_t T = \\mathcal{B}(T)$, respectively.\n\n**Theoretical Error Analysis:**\nThe formal solution to $\\partial_t T = (\\mathcal{A} + \\mathcal{B})T$ over a time step $\\Delta t$ is given by $T(t+\\Delta t) = e^{(\\mathcal{A}+\\mathcal{B})\\Delta t} T(t)$. The Lie splitting scheme approximates this as $e^{\\mathcal{B}\\Delta t}e^{\\mathcal{A}\\Delta t}T(t)$. The error of this approximation can be analyzed using the Baker–Campbell–Hausdorff (BCH) formula, which for non-commuting operators states:\n$$\ne^{\\mathcal{B}\\Delta t}e^{\\mathcal{A}\\Delta t} = e^{(\\mathcal{A}+\\mathcal{B})\\Delta t + \\frac{1}{2}[\\mathcal{B},\\mathcal{A}]\\Delta t^2 + O(\\Delta t^3)}\n$$\nwhere $[\\mathcal{B},\\mathcal{A}] = \\mathcal{B}\\mathcal{A} - \\mathcal{A}\\mathcal{B}$ is the commutator of the operators. The local truncation error of the splitting is the difference between the exact and approximate propagators:\n$$\ne^{(\\mathcal{A}+\\mathcal{B})\\Delta t} - e^{\\mathcal{B}\\Delta t}e^{\\mathcal{A}\\Delta t} \\approx -\\frac{1}{2}[\\mathcal{B},\\mathcal{A}]\\Delta t^2.\n$$\nThe local error is of order $O(\\Delta t^2)$. For a total simulation time $T_{\\mathrm{end}}$, the number of steps is $N = T_{\\mathrm{end}}/\\Delta t$. The global error, which is the accumulation of local errors, is therefore of order $N \\times O(\\Delta t^2) = (T_{\\mathrm{end}}/\\Delta t) \\times O(\\Delta t^2) = O(\\Delta t)$. This means the Lie splitting scheme is a first-order method, and the observed convergence order $p$ should be approximately $1$. The commutator $[\\mathcal{B},\\mathcal{A}]$ is non-zero because the source operator $\\mathcal{B}$ depends on $T$, and the diffusion operator $\\mathcal{A}$ involves spatial derivatives of $T$. Applying heat changes the temperature profile, which in turn alters the temperature curvature that drives diffusion, so the order of operations matters. An exception is Case 2 where $J = 0$, leading to $q=0$ and $\\mathcal{B}=0$. In this case, $[\\mathcal{B},\\mathcal{A}]=0$, the splitting error vanishes, and the total error is governed solely by the discretization methods for the sub-problems.\n\n### **Discretization and Implementation**\n\nThe spatial domain $x \\in [0, L]$ is discretized into $N_x$ grid points $x_i = i \\Delta x$ for $i=0, \\dots, N_x-1$, with spacing $\\Delta x = L/(N_x-1)$.\n\n**1. Diffusion Step (Operator $\\Phi_A$):**\nWe solve $C\\,\\partial_t T = k\\,\\partial_{xx} T$ using the implicit backward Euler method. For interior nodes $i=1, \\dots, N_x-2$, the discretized equation is:\n$$\n\\frac{T^{n+1/2}_i - T^n_i}{\\Delta t} = \\frac{k}{C} \\frac{T^{n+1/2}_{i+1} - 2T^{n+1/2}_i + T^{n+1/2}_{i-1}}{\\Delta x^2}\n$$\nRearranging gives a linear system for the unknown temperatures $T^{n+1/2}_i$:\n$$\n-r T^{n+1/2}_{i-1} + (1+2r) T^{n+1/2}_i - r T^{n+1/2}_{i+1} = T^n_i\n$$\nwhere $r = \\frac{k\\,\\Delta t}{C\\,\\Delta x^2}$ is the dimensionless diffusion number. This forms a tridiagonal system of $N_x-2$ linear equations for the interior nodes. The Dirichlet boundary conditions $T^{n+1/2}_0 = T_b$ and $T^{n+1/2}_{N_x-1} = T_b$ are incorporated by moving their contributions to the right-hand side of the equations for nodes $i=1$ and $i=N_x-2$. The resulting system is solved efficiently using a standard tridiagonal matrix solver, such as `scipy.linalg.solve_banded`. The backward Euler method is A-stable, which is crucial for handling the potentially stiff diffusion term without severe restrictions on $\\Delta t_s$.\n\n**2. Source Step (Operator $\\Phi_B$):**\nWe solve the system of Ordinary Differential Equations (ODEs) $\\partial_t T_i = \\mathcal{B}(T_i) = q(J,T_i)/C$ for each interior node $i=1, \\dots, N_x-2$. This is done using the second-order explicit Heun's method. For each node, given the temperature $T_i^{\\text{in}} = T^{n+1/2}_i$ at the beginning of the step, the update proceeds as:\n- **Predictor:** $\\tilde{T}_i = T_i^{\\text{in}} + \\Delta t \\cdot \\frac{q(J, T_i^{\\text{in}})}{C}$\n- **Corrector:** $T^{n+1}_i = T_i^{\\text{in}} + \\frac{\\Delta t}{2C} \\left( q(J, T_i^{\\text{in}}) + q(J, \\tilde{T}_i) \\right)$\nThis method is applied pointwise to all interior nodes. After the update, the boundary conditions are re-enforced: $T^{n+1}_0 = T_b$ and $T^{n+1}_{N_x-1} = T_b$.\n\n**3. Convergence Analysis:**\nThe numerical solution is computed for several coarse time steps $\\Delta t_k$ and compared against a reference solution obtained with a much smaller time step $\\Delta t_{\\mathrm{ref}}$. The error is quantified by the spatial root-mean-square (RMS) error at the final time $T_{\\mathrm{end}}$:\n$$\n\\mathrm{RMS} = \\sqrt{\\frac{1}{N_x}\\sum_{i=0}^{N_x-1}\\left(T_i^{\\mathrm{coarse}} - T_i^{\\mathrm{ref}}\\right)^2}\n$$\nThe observed order of convergence $p$ is estimated from two error calculations, $\\mathrm{RMS}_1$ and $\\mathrm{RMS}_2$, corresponding to time steps $\\Delta t_1$ and $\\Delta t_2 = \\Delta t_1 / r_t$:\n$$\np = \\frac{\\log(\\mathrm{RMS}_1 / \\mathrm{RMS}_2)}{\\log(r_t)}\n$$\nFor a first-order method, we expect $p \\approx 1$.\n\nThe overall algorithm proceeds by initializing the temperature profile and then iterating the two-step (diffusion-source) update until $T_{\\mathrm{end}}$ is reached. The procedure is repeated for each test case to calculate the required RMS errors and convergence orders.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D quench propagation problem using a Lie operator splitting scheme\n    and analyzes its convergence for three different test cases.\n    \"\"\"\n\n    # Physical and numerical parameters\n    L = 0.1  # m\n    Tb = 4.2  # K\n    k = 50.0  # W/(m.K)\n    C = 3.0e6  # J/(m^3.K)\n    Tc = 9.2  # K\n    Jc0 = 3.0e8  # A/m^2\n    Ec = 1.0e-4  # V/m\n    n = 15.0\n    epsilon = 1.0e-3  # A/m^2\n    rho0 = 1.0e-9  # Ohm.m\n    beta = 5.0e-3  # K^-1\n    Nx = 81\n    delta_T_init = 20.0  # K\n    sigma_init = 0.004  # m\n    T_end = 2.0e-4  # s\n    dt_ref = 2.5e-6  # s\n    coarse_dts = [4.0e-5, 2.0e-5, 1.0e-5] # s\n    time_step_ratio = 2.0\n\n    # Test cases for current density J\n    test_cases_J = [\n        1.0e8,  # Case 1: typical current\n        0.0,    # Case 2: no source edge case\n        4.0e8   # Case 3: stiff source regime\n    ]\n\n    # Helper functions for the source term q(J, T)\n    def get_Jc(T):\n        return Jc0 * np.maximum(0.0, 1.0 - T / Tc)\n\n    def get_rho_eff(T):\n        return rho0 * (1.0 + beta * np.maximum(T - Tb, 0.0))\n\n    def get_E(J, T):\n        if J == 0.0:\n            return np.zeros_like(T)\n        \n        Jc = get_Jc(T)\n        rho_eff = get_rho_eff(T)\n        \n        E_n = rho_eff * J\n        \n        # Guard against division by zero or very small Jc\n        safe_Jc = np.maximum(Jc, epsilon)\n        E_sc = Ec * (J / safe_Jc)**n\n        \n        # Piecewise definition of E\n        E = np.where(T  Tc, np.minimum(E_sc, E_n), E_n)\n        return E\n\n    def get_q(J, T):\n        return get_E(J, T) * J\n\n    # Main simulation function\n    def compute_evolution(J, dt):\n        \"\"\"\n        Computes the temperature evolution up to T_end for a given J and dt.\n        \"\"\"\n        x = np.linspace(0, L, Nx)\n        dx = L / (Nx - 1)\n        \n        # Initial condition\n        T = Tb + delta_T_init * np.exp(-(x - L / 2)**2 / (2 * sigma_init**2))\n        \n        num_steps = int(np.ceil(T_end / dt))\n        actual_dt = T_end / num_steps\n\n        # --- Diffusion Step Setup (Backward Euler) ---\n        r = (k * actual_dt) / (C * dx**2)\n        \n        A_banded = np.zeros((3, Nx - 2))\n        A_banded[0, 1:] = -r  # Upper diagonal\n        A_banded[1, :] = 1.0 + 2.0 * r  # Main diagonal\n        A_banded[2, :-1] = -r  # Lower diagonal\n\n        # --- Time-stepping loop ---\n        for _ in range(num_steps):\n            # Step A: Diffusion\n            # Setup RHS b for Ax=b, with boundary conditions\n            b = T[1:-1].copy()\n            b[0] += r * Tb\n            b[-1] += r * Tb\n            \n            # Solve the tridiagonal system for interior nodes\n            T_half_interior = solve_banded((1, 1), A_banded, b)\n            \n            # Reconstruct T_half with boundary conditions\n            T_half = np.full(Nx, Tb)\n            T_half[1:-1] = T_half_interior\n\n            # Step B: Source (Heun's Method)\n            T_in_interior = T_half[1:-1]\n            \n            # Predictor\n            q_in = get_q(J, T_in_interior)\n            k1 = q_in / C\n            T_pred_interior = T_in_interior + actual_dt * k1\n            \n            # Corrector\n            q_pred = get_q(J, T_pred_interior)\n            k2 = q_pred / C\n            T_new_interior = T_in_interior + 0.5 * actual_dt * (k1 + k2)\n            \n            # Update temperature profile and enforce BCs\n            T[1:-1] = T_new_interior\n            T[0] = Tb\n            T[-1] = Tb\n            \n        return T\n\n    # Main logic to run test cases and compute errors\n    all_results = []\n    \n    for J_case in test_cases_J:\n        # Compute reference solution with fine time step\n        T_ref = compute_evolution(J_case, dt_ref)\n        \n        rms_errors = []\n        # Compute solutions with coarse time steps and find errors\n        for dt_coarse in coarse_dts:\n            T_coarse = compute_evolution(J_case, dt_coarse)\n            rms = np.sqrt(np.mean((T_coarse - T_ref)**2))\n            rms_errors.append(rms)\n        \n        all_results.extend(rms_errors)\n        \n        # Compute observed convergence orders\n        p12 = np.log(rms_errors[0] / rms_errors[1]) / np.log(time_step_ratio)\n        p23 = np.log(rms_errors[1] / rms_errors[2]) / np.log(time_step_ratio)\n        \n        all_results.append(p12)\n        all_results.append(p23)\n\n    # Print the final results in the required format\n    print(f\"[{','.join(f'{val:.8f}' for val in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}