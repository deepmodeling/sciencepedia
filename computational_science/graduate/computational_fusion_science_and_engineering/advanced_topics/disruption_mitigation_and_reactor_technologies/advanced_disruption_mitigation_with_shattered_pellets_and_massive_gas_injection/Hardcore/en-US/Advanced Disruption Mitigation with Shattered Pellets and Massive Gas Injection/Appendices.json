{
    "hands_on_practices": [
        {
            "introduction": "The effectiveness of Shattered Pellet Injection (SPI) hinges on delivering impurities deep into the plasma. This requires the injected fragments to survive the intense heat of the plasma edge and penetrate to the core. This practice explores the fundamental physics of pellet ablation by balancing the incident heat flux against the energy of sublimation. By building a model that accounts for classical heat conduction and kinetic saturation effects, you will compute a fragment's lifetime and its final penetration depth, a critical first step in designing any SPI system .",
            "id": "3947697",
            "problem": "You are tasked with deriving, implementing, and validating a computational model for the ablation of a spherical fragment used in advanced disruption mitigation via Shattered Pellet Injection (SPI) and Massive Gas Injection (MGI) in a tokamak. The fragment of initial radius $a$ enters a plasma characterized by tokamak safety factor $q$, electron density $n_e$, and electron temperature $T_e$. The goal is to compute the ablation lifetime and to assess whether the fragment reaches a specified target flux surface located at minor radius $r_{\\mathrm{target}}$. The analysis must be based on fundamental physical laws and well-tested formulas. All quantities that are mathematical entities must be in LaTeX.\n\nStarting from conservation of energy, consider the ablation of a spherical fragment of uniform solid density $\\rho_s$ and latent heat of sublimation $L_v$. Treat the fragment as a sphere of radius $a$ that shrinks due to an energy flux $F_e$ incident on its surface. The fragment is injected at a minor radius $r_0$ and moves radially inward with constant speed $v_r$ (the sign convention is that decreasing $r$ denotes inward motion). The effective parallel connection length is approximated as $L_{\\parallel} = q 2 \\pi R$, where $R$ is the tokamak major radius. The electron temperature $T_e$ is provided in electronvolts and must be converted to kelvin before use in thermal conduction expressions.\n\nUse the following foundation:\n- Conservation of energy at the fragment surface equates the incident heat power to the sublimation energy: the ablation mass rate is the incident power divided by the latent heat, and the radius evolution is obtained by relating volume change to mass change via density.\n- Electron heat transport to the fragment may be limited by parallel thermal conduction along magnetic field lines or may saturate at a free-streaming limit. Model the effective heat flux as the minimum of a conduction-limited flux and a saturated free-streaming flux, multiplied by a neutral gas shielding factor $S_{\\mathrm{shield}} \\in (0,1]$.\n\nYour program shall implement the following steps:\n1. Convert $T_e$ from electronvolts to kelvin using Boltzmann’s constant $k_B$ and the elementary charge $e$.\n2. Compute the Spitzer–Härm (SH) parallel thermal conductivity for a fully ionized plasma with ion charge $Z$ and Coulomb logarithm $\\ln \\Lambda$, using the well-tested form $$\\kappa_{\\parallel}(T) = \\frac{1.84 \\times 10^{-5}}{Z \\ln \\Lambda} T^{5/2} \\quad \\text{in } \\mathrm{W\\, m^{-1}\\, K^{-1}},$$ where $T$ is in kelvin.\n3. Define the conduction-limited heat flux to the fragment as $$F_{\\mathrm{cond}} = \\frac{\\kappa_{\\parallel}(T)}{L_{\\parallel}} T,$$ where $L_{\\parallel} = q 2 \\pi R$.\n4. Define the saturated (free-streaming) heat flux using kinetic theory with Maxwellian electrons. For the electron thermal speed, use the mean thermal speed $$v_{\\mathrm{th}} = \\sqrt{\\frac{8 k_B T}{\\pi m_e}},$$ where $m_e$ is the electron mass. Then, use the saturated flux $$F_{\\mathrm{sat}} = \\alpha\\, n_e\\, k_B T\\, v_{\\mathrm{th}},$$ where $\\alpha$ is a dimensionless coefficient of order unity representing the proportionality between energy per particle and flux; set $\\alpha = 1.5$.\n5. Apply neutral gas shielding via $$F_e = S_{\\mathrm{shield}} \\min\\left(F_{\\mathrm{cond}}, F_{\\mathrm{sat}}\\right).$$\n6. Using conservation of energy and mass for a sphere, derive the radius evolution law and obtain the ablation lifetime $t_{\\mathrm{life}}$:\n   - The incident power is $P = F_e \\cdot 4 \\pi a^2$.\n   - The mass ablation rate is $\\dot{m} = P / L_v$.\n   - The volume change rate is $\\dot{V} = \\dot{m} / \\rho_s$.\n   - For a sphere $V = \\frac{4}{3} \\pi a^3$, so $\\dot{V} = 4 \\pi a^2 \\dot{a}$.\n   - Therefore obtain $\\dot{a} = - \\frac{F_e}{\\rho_s L_v}$, which for constant $F_e$ yields $$t_{\\mathrm{life}} = \\frac{a}{F_e/(\\rho_s L_v)} = \\frac{a \\rho_s L_v}{F_e}.$$\n7. The fragment travels inward a distance $d = v_r t_{\\mathrm{life}}$ before complete ablation. The final minor radius is $$r_{\\mathrm{final}} = r_0 - v_r t_{\\mathrm{life}}.$$ The fragment reaches the target flux surface if and only if $$r_{\\mathrm{final}} \\le r_{\\mathrm{target}}.$$\n\nYour implementation must produce results for the test suite below. All inputs and outputs must use International System of Units (SI) unless explicitly specified:\n- $a$ in meters ($\\mathrm{m}$).\n- $q$ dimensionless.\n- $n_e$ in inverse cubic meters ($\\mathrm{m^{-3}}$).\n- $T_e$ in electronvolts ($\\mathrm{eV}$), converted internally to kelvin.\n- $R$ in meters ($\\mathrm{m}$).\n- $\\rho_s$ in kilograms per cubic meter ($\\mathrm{kg\\, m^{-3}}$).\n- $L_v$ in joules per kilogram ($\\mathrm{J\\, kg^{-1}}$).\n- $S_{\\mathrm{shield}}$ dimensionless in $(0,1]$.\n- $\\ln \\Lambda$ dimensionless.\n- $Z$ dimensionless.\n- $v_r$ in meters per second ($\\mathrm{m\\, s^{-1}}$).\n- $r_0$ and $r_{\\mathrm{target}}$ in meters ($\\mathrm{m}$).\n\nFor each test case, your program must output a list containing three elements in the order: $t_{\\mathrm{life}}$ in seconds (as a float), $r_{\\mathrm{final}}$ in meters (as a float), and a boolean indicating whether the fragment reaches the target flux surface (true if reached, false otherwise). Aggregate the results of all test cases into a single line of output containing the list of these per-case lists, as a comma-separated list enclosed in square brackets.\n\nTest suite:\n- Case $1$: $a = 1.0 \\times 10^{-3}\\, \\mathrm{m}$, $q = 3.5$, $n_e = 8.0 \\times 10^{19}\\, \\mathrm{m^{-3}}$, $T_e = 2000\\, \\mathrm{eV}$, $R = 3.0\\, \\mathrm{m}$, $\\rho_s = 200\\, \\mathrm{kg\\, m^{-3}}$, $L_v = 4.5 \\times 10^{5}\\, \\mathrm{J\\, kg^{-1}}$, $S_{\\mathrm{shield}} = 0.3$, $\\ln \\Lambda = 17$, $Z = 1$, $v_r = 100\\, \\mathrm{m\\, s^{-1}}$, $r_0 = 1.0\\, \\mathrm{m}$, $r_{\\mathrm{target}} = 0.85\\, \\mathrm{m}$.\n- Case $2$: $a = 2.0 \\times 10^{-3}\\, \\mathrm{m}$, $q = 9.0$, $n_e = 5.0 \\times 10^{19}\\, \\mathrm{m^{-3}}$, $T_e = 100\\, \\mathrm{eV}$, $R = 2.5\\, \\mathrm{m}$, $\\rho_s = 200\\, \\mathrm{kg\\, m^{-3}}$, $L_v = 4.5 \\times 10^{5}\\, \\mathrm{J\\, kg^{-1}}$, $S_{\\mathrm{shield}} = 0.5$, $\\ln \\Lambda = 17$, $Z = 1$, $v_r = 80\\, \\mathrm{m\\, s^{-1}}$, $r_0 = 0.95\\, \\mathrm{m}$, $r_{\\mathrm{target}} = 0.70\\, \\mathrm{m}$.\n- Case $3$: $a = 5.0 \\times 10^{-4}\\, \\mathrm{m}$, $q = 2.0$, $n_e = 1.0 \\times 10^{20}\\, \\mathrm{m^{-3}}$, $T_e = 10000\\, \\mathrm{eV}$, $R = 3.0\\, \\mathrm{m}$, $\\rho_s = 200\\, \\mathrm{kg\\, m^{-3}}$, $L_v = 4.5 \\times 10^{5}\\, \\mathrm{J\\, kg^{-1}}$, $S_{\\mathrm{shield}} = 0.2$, $\\ln \\Lambda = 17$, $Z = 1$, $v_r = 120\\, \\mathrm{m\\, s^{-1}}$, $r_0 = 1.0\\, \\mathrm{m}$, $r_{\\mathrm{target}} = 0.90\\, \\mathrm{m}$.\n- Case $4$: $a = 1.5 \\times 10^{-3}\\, \\mathrm{m}$, $q = 5.0$, $n_e = 3.0 \\times 10^{19}\\, \\mathrm{m^{-3}}$, $T_e = 1500\\, \\mathrm{eV}$, $R = 3.5\\, \\mathrm{m}$, $\\rho_s = 200\\, \\mathrm{kg\\, m^{-3}}$, $L_v = 4.5 \\times 10^{5}\\, \\mathrm{J\\, kg^{-1}}$, $S_{\\mathrm{shield}} = 1.0$, $\\ln \\Lambda = 17$, $Z = 1$, $v_r = 30\\, \\mathrm{m\\, s^{-1}}$, $r_0 = 1.1\\, \\mathrm{m}$, $r_{\\mathrm{target}} = 0.95\\, \\mathrm{m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list formatted as $[t_{\\mathrm{life}}, r_{\\mathrm{final}}, \\text{boolean}]$.",
            "solution": "We begin from conservation of energy and mass for a spherical fragment ablated by a plasma heat flux. Let the fragment be a sphere of radius $a$, solid density $\\rho_s$, and latent heat of sublimation $L_v$. The incident heat flux $F_e$ deposits power $P = F_e \\cdot 4 \\pi a^2$ onto the surface. The power required to ablate mass at rate $\\dot{m}$ is $P = \\dot{m} L_v$. The corresponding volume change rate is $\\dot{V} = \\dot{m} / \\rho_s$, so\n$$\n\\dot{V} = \\frac{P}{\\rho_s L_v} = \\frac{F_e \\cdot 4 \\pi a^2}{\\rho_s L_v}.\n$$\nThe volume of a sphere is $V = \\frac{4}{3} \\pi a^3$, thus $\\dot{V} = 4 \\pi a^2 \\dot{a}$. Equating the two expressions for $\\dot{V}$ yields\n$$\n4 \\pi a^2 \\dot{a} = \\frac{F_e \\cdot 4 \\pi a^2}{\\rho_s L_v} \\quad \\Rightarrow \\quad \\dot{a} = - \\frac{F_e}{\\rho_s L_v},\n$$\nwith the minus sign indicating shrinkage. If $F_e$ is treated as constant in time under the given plasma conditions and shielding, the ablation lifetime is\n$$\nt_{\\mathrm{life}} = \\int_{a}^{0} \\frac{da'}{\\dot{a'}} = \\frac{a}{F_e/(\\rho_s L_v)} = \\frac{a \\rho_s L_v}{F_e}.\n$$\n\nNext, we model $F_e$ using well-tested transport theories. Electron heat transport along magnetic field lines can be characterized by Spitzer–Härm (SH) thermal conduction and by a saturated free-streaming limit. The effective parallel connection length from the fragment to a heat reservoir is taken as $L_{\\parallel} = q 2 \\pi R$, reflecting that the magnetic field line pitch, determined by tokamak safety factor $q$, sets the parallel length coupling and thereby the temperature gradient scale. Here, $R$ is the tokamak major radius.\n\nFor SH conduction, the parallel conductivity for a fully ionized plasma is\n$$\n\\kappa_{\\parallel}(T) = \\frac{1.84 \\times 10^{-5}}{Z \\ln \\Lambda} T^{5/2} \\quad \\text{in } \\mathrm{W\\, m^{-1}\\, K^{-1}},\n$$\nwhere $Z$ is the ion charge number and $\\ln \\Lambda$ is the Coulomb logarithm. The conduction-limited heat flux is\n$$\nF_{\\mathrm{cond}} = \\kappa_{\\parallel}(T) \\frac{T}{L_{\\parallel}} = \\frac{1.84 \\times 10^{-5}}{Z \\ln \\Lambda} \\frac{T^{7/2}}{L_{\\parallel}}.\n$$\nWe must convert electron temperature from electronvolts to kelvin: $T = T_e \\times \\frac{e}{k_B}$, with $e$ the elementary charge and $k_B$ Boltzmann’s constant.\n\nAt high temperature gradients, heat flux can saturate at a free-streaming limit governed by kinetic theory. For Maxwellian electrons, the mean thermal speed is\n$$\nv_{\\mathrm{th}} = \\sqrt{\\frac{8 k_B T}{\\pi m_e}},\n$$\nwhere $m_e$ is the electron mass. A saturated heat flux can be parameterized as\n$$\nF_{\\mathrm{sat}} = \\alpha\\, n_e\\, k_B T\\, v_{\\mathrm{th}},\n$$\nwhere $n_e$ is electron density and $\\alpha$ is a dimensionless coefficient of order unity encapsulating the proportionality between energy per electron and the directed flux (we use $\\alpha = 1.5$ as a physically reasonable choice consistent with Cowie–McKee–type saturation estimates).\n\nNeutral gas shielding reduces the effective electron heat flux incident on the fragment. We include a shielding factor $S_{\\mathrm{shield}} \\in (0,1]$:\n$$\nF_e = S_{\\mathrm{shield}} \\cdot \\min\\left(F_{\\mathrm{cond}}, F_{\\mathrm{sat}}\\right).\n$$\n\nWith $F_e$ so defined, the ablation lifetime is\n$$\nt_{\\mathrm{life}} = \\frac{a \\rho_s L_v}{F_e}.\n$$\nAssuming the fragment moves inward at constant speed $v_r$, the final minor radius after complete ablation is\n$$\nr_{\\mathrm{final}} = r_0 - v_r\\, t_{\\mathrm{life}}.\n$$\nThe fragment reaches the target flux surface if and only if\n$$\nr_{\\mathrm{final}} \\le r_{\\mathrm{target}}.\n$$\n\nAlgorithmic steps for implementation:\n1. For each test case, parse inputs $(a, q, n_e, T_e, R, \\rho_s, L_v, S_{\\mathrm{shield}}, \\ln \\Lambda, Z, v_r, r_0, r_{\\mathrm{target}})$ in SI units, except $T_e$ in electronvolts.\n2. Convert $T_e$ to $T$ in kelvin via $T = T_e \\times \\frac{e}{k_B}$.\n3. Compute $L_{\\parallel} = q \\cdot 2 \\pi R$.\n4. Compute $\\kappa_{\\parallel}(T)$ using the SH formula above.\n5. Compute $F_{\\mathrm{cond}} = \\kappa_{\\parallel}(T) \\cdot \\frac{T}{L_{\\parallel}}$.\n6. Compute $v_{\\mathrm{th}} = \\sqrt{ \\frac{8 k_B T}{\\pi m_e} }$ and $F_{\\mathrm{sat}} = \\alpha\\, n_e\\, k_B T\\, v_{\\mathrm{th}}$ with $\\alpha = 1.5$.\n7. Compute $F_e = S_{\\mathrm{shield}} \\cdot \\min(F_{\\mathrm{cond}}, F_{\\mathrm{sat}})$. If $F_e \\le 0$, set $t_{\\mathrm{life}} = +\\infty$ and $r_{\\mathrm{final}} = r_0$.\n8. Otherwise compute $t_{\\mathrm{life}} = \\frac{a \\rho_s L_v}{F_e}$ and $r_{\\mathrm{final}} = r_0 - v_r t_{\\mathrm{life}}$.\n9. Determine the boolean $r_{\\mathrm{final}} \\le r_{\\mathrm{target}}$.\n10. Output for each case the list $[t_{\\mathrm{life}}, r_{\\mathrm{final}}, \\text{boolean}]$ and aggregate all case lists into a single list printed on one line, formatted exactly as specified.\n\nScientific realism and edge coverage:\n- Case $1$ probes typical SPI fragment conditions in a hot plasma with significant shielding and moderate $q$, likely yielding short lifetimes and limited penetration.\n- Case $2$ examines high-$q$ and low-$T_e$ conditions with stronger connection length and reduced heat flux, increasing lifetime and penetration.\n- Case $3$ represents very hot plasma with low $q$ and high $n_e$, where saturated transport dominates and lifetime is extremely short.\n- Case $4$ removes shielding ($S_{\\mathrm{shield}}=1$) and uses modest $v_r$ to challenge the conduction versus saturation interplay and assess penetration under stronger heat loading.\n\nAll outputs are floats for $t_{\\mathrm{life}}$ in seconds and $r_{\\mathrm{final}}$ in meters, and a boolean for reachability of $r_{\\mathrm{target}}$, aggregated into the single-line, bracketed, comma-separated list required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_ablation_lifetime_and_reach(a, q, n_e, T_e_eV, R, rho_s, L_v,\n                                        S_shield, lnLambda, Z, v_r, r0, r_target,\n                                        alpha_sat=1.5):\n    \"\"\"\n    Compute ablation lifetime t_life, final minor radius r_final, and whether the fragment\n    reaches the target flux surface, based on energy balance and heat transport limits.\n\n    Parameters:\n    - a: fragment radius [m]\n    - q: tokamak safety factor [-]\n    - n_e: electron density [m^-3]\n    - T_e_eV: electron temperature [eV]\n    - R: tokamak major radius [m]\n    - rho_s: solid density [kg/m^3]\n    - L_v: latent heat of sublimation [J/kg]\n    - S_shield: neutral gas shielding factor (0,1]\n    - lnLambda: Coulomb logarithm [-]\n    - Z: ion charge number [-]\n    - v_r: inward radial speed [m/s]\n    - r0: initial minor radius [m]\n    - r_target: target flux surface minor radius [m]\n    - alpha_sat: proportionality constant for saturated heat flux [-]\n\n    Returns:\n    - t_life [s], r_final [m], reached (bool)\n    \"\"\"\n\n    # Physical constants (SI)\n    k_B = 1.380649e-23      # Boltzmann constant [J/K]\n    e_charge = 1.602176634e-19  # Elementary charge [C]\n    m_e = 9.1093837015e-31  # Electron mass [kg]\n\n    # Convert electron temperature from eV to Kelvin\n    T_K = T_e_eV * e_charge / k_B\n\n    # Parallel connection length\n    L_parallel = q * 2.0 * np.pi * R\n\n    # Spitzer-Härm parallel thermal conductivity: kappa_parallel(T) = (1.84e-5 / (Z lnΛ)) * T^(5/2)\n    kappa_parallel = (1.84e-5 / (Z * lnLambda)) * (T_K ** 2.5)  # [W m^-1 K^-1]\n\n    # Conduction-limited heat flux\n    F_cond = kappa_parallel * T_K / L_parallel  # [W/m^2]\n\n    # Electron mean thermal speed for Maxwellian\n    v_th = np.sqrt(8.0 * k_B * T_K / (np.pi * m_e))  # [m/s]\n\n    # Saturated (free-streaming) heat flux\n    F_sat = alpha_sat * n_e * k_B * T_K * v_th  # [W/m^2]\n\n    # Effective heat flux with neutral gas shielding\n    F_e = S_shield * min(F_cond, F_sat)\n\n    if F_e = 0.0 or not np.isfinite(F_e):\n        # No ablation if flux non-positive or invalid\n        t_life = float('inf')\n        r_final = r0\n        reached = r_final = r_target\n        return t_life, r_final, reached\n\n    # Ablation lifetime from energy balance\n    t_life = a * rho_s * L_v / F_e  # [s]\n\n    # Final minor radius after ablation\n    r_final = r0 - v_r * t_life  # [m]\n\n    # Check reachability\n    reached = (r_final = r_target)\n\n    return t_life, r_final, reached\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple:\n    # (a [m], q [-], n_e [m^-3], T_e [eV], R [m], rho_s [kg/m^3], L_v [J/kg],\n    #  S_shield [-], lnLambda [-], Z [-], v_r [m/s], r0 [m], r_target [m])\n    test_cases = [\n        (1.0e-3, 3.5, 8.0e19, 2000.0, 3.0, 200.0, 4.5e5, 0.3, 17.0, 1.0, 100.0, 1.0, 0.85),\n        (2.0e-3, 9.0, 5.0e19, 100.0, 2.5, 200.0, 4.5e5, 0.5, 17.0, 1.0, 80.0, 0.95, 0.70),\n        (5.0e-4, 2.0, 1.0e20, 10000.0, 3.0, 200.0, 4.5e5, 0.2, 17.0, 1.0, 120.0, 1.0, 0.90),\n        (1.5e-3, 5.0, 3.0e19, 1500.0, 3.5, 200.0, 4.5e5, 1.0, 17.0, 1.0, 30.0, 1.1, 0.95),\n    ]\n\n    results = []\n    for case in test_cases:\n        (a, q, n_e, T_e_eV, R, rho_s, L_v,\n         S_shield, lnLambda, Z, v_r, r0, r_target) = case\n\n        t_life, r_final, reached = compute_ablation_lifetime_and_reach(\n            a, q, n_e, T_e_eV, R, rho_s, L_v, S_shield, lnLambda, Z, v_r, r0, r_target\n        )\n\n        results.append([t_life, r_final, reached])\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once impurities are present in the plasma, they must rapidly radiate away its thermal energy to initiate a controlled shutdown. This process, known as the thermal quench, is the primary goal of disruption mitigation. This exercise guides you through building a dynamic zero-dimensional (0D) model to simulate the \"radiative collapse\" of the plasma temperature . By solving coupled equations for temperature and impurity density, you will gain insight into the conditions needed to trigger a successful quench, exploring the interplay between impurity injection, transport, and a realistic, temperature-dependent cooling rate.",
            "id": "3947742",
            "problem": "You are tasked with constructing a Zero-Dimensional (0D) model for the electron temperature time evolution in a tokamak plasma undergoing impurity injection during advanced disruption mitigation, such as Shattered Pellet Injection (SPI) or Massive Gas Injection (MGI). The 0D model assumes spatial uniformity and follows the electron energy balance per particle, with temperature expressed in electronvolts. The fundamental starting point is the electron energy balance law,\n$$\n\\frac{d}{dt}\\left(\\frac{3}{2} n_e k_B T_e\\right) = - P_{\\mathrm{rad}}(t),\n$$\nwhere $n_e$ is the electron number density, $k_B$ is the Boltzmann constant, $T_e$ is the electron temperature, and $P_{\\mathrm{rad}}(t)$ is the volumetric radiative power density due to impurities. Dividing both sides by $n_e k_B$ and expressing temperature in electronvolts introduces the conversion constant from Joules to electronvolts. Using $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$, where $e$ is the elementary charge, the evolution equation for $T_e(t)$ in electronvolts is\n$$\n\\frac{d T_e}{dt} = -\\frac{2}{3} \\frac{P_{\\mathrm{rad}}(t)}{n_e} \\frac{1}{e}.\n$$\nThe radiative power density is modeled as\n$$\nP_{\\mathrm{rad}}(t) = n_e \\, n_Z(t) \\, \\Lambda_Z\\!\\left(T_e(t)\\right),\n$$\nwhere $n_Z(t)$ is the impurity number density and $\\Lambda_Z(T_e)$ is the impurity cooling coefficient. The impurity density evolves under a source-loss model that captures the physics of SPI/MGI deposition and post-injection transport loss:\n$$\n\\frac{d n_Z}{dt} = S_0 \\exp\\!\\left(-\\frac{(t-t_0)^2}{2 \\tau_{\\mathrm{inj}}^2}\\right) - \\frac{n_Z}{\\tau_{\\mathrm{loss}}},\n$$\nwith $S_0$ representing the peak source strength, $t_0$ the injection center time, $\\tau_{\\mathrm{inj}}$ the characteristic duration of the injection pulse, and $\\tau_{\\mathrm{loss}}$ the impurity loss time. The impurity cooling coefficient is modeled as a physically motivated combination of line radiation (peaked around tens of electronvolts) and bremsstrahlung at higher temperatures:\n$$\n\\Lambda_Z(T_e) = \\Lambda_{\\mathrm{line}}(T_e) + \\Lambda_{\\mathrm{brem}}(T_e),\n$$\nwith\n$$\n\\Lambda_{\\mathrm{line}}(T_e) = \\Lambda_{\\mathrm{peak}} \\exp\\!\\left(-\\frac{\\left[\\ln\\!\\left(\\frac{T_e}{T_{\\mathrm{peak}}}\\right)\\right]^2}{2 \\sigma^2}\\right),\n\\qquad\n\\Lambda_{\\mathrm{brem}}(T_e) = C_{\\mathrm{brem}} \\, Z_{\\mathrm{eff}} \\, \\sqrt{T_e},\n$$\nwhere $\\Lambda_{\\mathrm{peak}}$ sets the peak line radiation strength, $T_{\\mathrm{peak}}$ sets the temperature at which line radiation peaks, $\\sigma$ sets the width of the peak in log-temperature, $C_{\\mathrm{brem}}$ is the bremsstrahlung coefficient, and $Z_{\\mathrm{eff}}$ is an effective charge parameter representing impurity ion charge state impact on bremsstrahlung. All temperatures $T_e$ are in electronvolts, number densities are in $\\mathrm{m}^{-3}$, time is in seconds, and power density is in $\\mathrm{W \\cdot m^{-3}}$. The electron temperature must be computed in electronvolts (eV) and evolves according to the above model.\n\nRadiative collapse is deemed to occur when the electron temperature $T_e(t)$ falls below a specified floor $T_{\\mathrm{floor}}$ in electronvolts. The objective is to implement a computational solver for the coupled system for $T_e(t)$ and $n_Z(t)$, determine whether a radiative collapse occurs within a specified maximum simulation time, and if so, report the collapse time.\n\nImplement the model numerically with a fixed time step and evaluate the following four test cases. For each test case, start from $T_e(0)=T_{e0}$ and $n_Z(0)=0$ and integrate forward in time using a uniform time step $\\Delta t$. Detect collapse when $T_e(t) \\le T_{\\mathrm{floor}}$. If collapse does not occur within the maximum time $t_{\\max}$, report $-1.0$ for the collapse time. Use the following constants in all cases:\n- $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}$,\n- $\\Lambda_{\\mathrm{peak}} = 3.0 \\times 10^{-32}\\,\\mathrm{W\\,m^3}$,\n- $T_{\\mathrm{peak}} = 50\\,\\mathrm{eV}$,\n- $\\sigma = 0.7$ (dimensionless),\n- $C_{\\mathrm{brem}} = 1.69 \\times 10^{-38}\\,\\mathrm{W\\,m^3\\,eV^{-1/2}}$.\n\nTest suite (all units are explicitly indicated; angles are not used):\n1. General strong injection (happy path):\n   - $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$,\n   - $T_{e0} = 2000\\,\\mathrm{eV}$,\n   - $Z_{\\mathrm{eff}} = 18$,\n   - $S_0 = 5.0 \\times 10^{22}\\,\\mathrm{m^{-3}\\,s^{-1}}$,\n   - $t_0 = 0.010\\,\\mathrm{s}$,\n   - $\\tau_{\\mathrm{inj}} = 0.005\\,\\mathrm{s}$,\n   - $\\tau_{\\mathrm{loss}} = 0.020\\,\\mathrm{s}$,\n   - $T_{\\mathrm{floor}} = 5\\,\\mathrm{eV}$,\n   - $t_{\\max} = 0.100\\,\\mathrm{s}$,\n   - $\\Delta t = 1.0 \\times 10^{-5}\\,\\mathrm{s}$.\n2. No injection (boundary case):\n   - Same as case 1, except $S_0 = 0$.\n3. Weak injection (near-boundary case):\n   - $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$,\n   - $T_{e0} = 2000\\,\\mathrm{eV}$,\n   - $Z_{\\mathrm{eff}} = 18$,\n   - $S_0 = 1.0 \\times 10^{20}\\,\\mathrm{m^{-3}\\,s^{-1}}$,\n   - $t_0 = 0.010\\,\\mathrm{s}$,\n   - $\\tau_{\\mathrm{inj}} = 0.003\\,\\mathrm{s}$,\n   - $\\tau_{\\mathrm{loss}} = 0.030\\,\\mathrm{s}$,\n   - $T_{\\mathrm{floor}} = 5\\,\\mathrm{eV}$,\n   - $t_{\\max} = 0.100\\,\\mathrm{s}$,\n   - $\\Delta t = 1.0 \\times 10^{-5}\\,\\mathrm{s}$.\n4. Fast impurity loss (edge case):\n   - $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$,\n   - $T_{e0} = 2000\\,\\mathrm{eV}$,\n   - $Z_{\\mathrm{eff}} = 18$,\n   - $S_0 = 5.0 \\times 10^{21}\\,\\mathrm{m^{-3}\\,s^{-1}}$,\n   - $t_0 = 0.010\\,\\mathrm{s}$,\n   - $\\tau_{\\mathrm{inj}} = 0.005\\,\\mathrm{s}$,\n   - $\\tau_{\\mathrm{loss}} = 5.0 \\times 10^{-4}\\,\\mathrm{s}$,\n   - $T_{\\mathrm{floor}} = 5\\,\\mathrm{eV}$,\n   - $t_{\\max} = 0.100\\,\\mathrm{s}$,\n   - $\\Delta t = 1.0 \\times 10^{-5}\\,\\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a two-element list $[b, t]$, where $b$ is a boolean indicating whether radiative collapse occurred and $t$ is the collapse time in seconds as a float; if no collapse occurs, $t$ must be $-1.0$. For example, the output formatting must be identical to\n[b_1, t_1],[b_2, t_2],[b_3, t_3],[b_4, t_4].\nAll times in the output must be expressed in seconds and rounded to six decimal places (using standard rounding of floats).",
            "solution": "The user has provided a problem requiring the construction of a Zero-Dimensional (0D) computational model to simulate the time evolution of electron temperature $T_e(t)$ and impurity number density $n_Z(t)$ in a tokamak plasma during a disruption mitigation event. The task is to solve the governing coupled ordinary differential equations (ODEs), determine if a \"radiative collapse\" occurs, and report the time of collapse.\n\nFirst, the problem's validity is confirmed. It is scientifically grounded in plasma physics principles, constituting a well-posed initial value problem with all necessary parameters, equations, and initial conditions provided. The language is objective and the parameters are physically plausible for the scenario being modeled. Therefore, a solution can be formulated.\n\nThe core of the problem is to solve the following system of two coupled first-order ODEs:\n$$\n\\frac{d n_Z}{dt} = S_0 \\exp\\!\\left(-\\frac{(t-t_0)^2}{2 \\tau_{\\mathrm{inj}}^2}\\right) - \\frac{n_Z}{\\tau_{\\mathrm{loss}}}\n$$\n$$\n\\frac{d T_e}{dt} = -\\frac{2}{3e} n_Z(t) \\, \\Lambda_Z\\!\\left(T_e(t)\\right)\n$$\nThe variables and functions are:\n- $t$: time in seconds ($s$).\n- $n_Z(t)$: impurity number density in $m^{-3}$.\n- $T_e(t)$: electron temperature in electronvolts ($eV$).\n- $S_0, t_0, \\tau_{\\mathrm{inj}}, \\tau_{\\mathrm{loss}}$: parameters defining the impurity injection source and loss.\n- $e$: elementary charge, $1.602176634 \\times 10^{-19} \\, J/eV$.\n- $\\Lambda_Z(T_e)$: the total impurity cooling coefficient in $W m^3$, which is the sum of line radiation and bremsstrahlung radiation components.\n\nThe cooling coefficient $\\Lambda_Z(T_e)$ is given by:\n$$\n\\Lambda_Z(T_e) = \\Lambda_{\\mathrm{line}}(T_e) + \\Lambda_{\\mathrm{brem}}(T_e)\n$$\nwhere the line radiation term, which dominates at lower temperatures, is modeled by a log-normal function:\n$$\n\\Lambda_{\\mathrm{line}}(T_e) = \\Lambda_{\\mathrm{peak}} \\exp\\!\\left(-\\frac{\\left[\\ln\\!\\left(\\frac{T_e}{T_{\\mathrm{peak}}}\\right)\\right]^2}{2 \\sigma^2}\\right)\n$$\nand the bremsstrahlung radiation term, which becomes more significant at higher temperatures, is modeled as:\n$$\n\\Lambda_{\\mathrm{brem}}(T_e) = C_{\\mathrm{brem}} \\, Z_{\\mathrm{eff}} \\, \\sqrt{T_e}\n$$\nThe parameters $\\Lambda_{\\mathrm{peak}}$, $T_{\\mathrm{peak}}$, $\\sigma$, $C_{\\mathrm{brem}}$, and $Z_{\\mathrm{eff}}$ are provided constants that characterize the radiative properties of the specific impurity. Note that the electron density $n_e$ cancels out of the final equation for $\\frac{dT_e}{dt}$, but is used alongside the other parameters in the problem statement for completeness of the physical context.\n\nThe problem specifies a numerical solution using a fixed time step $\\Delta t$, with initial conditions $T_e(0) = T_{e0}$ and $n_Z(0) = 0$. The most direct method to implement this is the Forward Euler scheme. For a system of ODEs of the form $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(t, \\mathbf{y})$, where $\\mathbf{y} = [n_Z, T_e]^T$, the state at time $t_{i+1} = t_i + \\Delta t$ is approximated from the state at time $t_i$:\n$$\n\\mathbf{y}_{i+1} = \\mathbf{y}_i + \\Delta t \\, \\mathbf{F}(t_i, \\mathbf{y}_i)\n$$\nApplying this to our specific system, the update rules for each time step are:\n$$\nn_{Z, i+1} = n_{Z, i} + \\Delta t \\left[ S_0 \\exp\\!\\left(-\\frac{(t_i-t_0)^2}{2 \\tau_{\\mathrm{inj}}^2}\\right) - \\frac{n_{Z, i}}{\\tau_{\\mathrm{loss}}} \\right]\n$$\n$$\nT_{e, i+1} = T_{e, i} - \\Delta t \\left[ \\frac{2}{3e} n_{Z, i} \\, \\Lambda_Z(T_{e, i}) \\right]\n$$\nwhere $t_i = i \\cdot \\Delta t$, $n_{Z,i} = n_Z(t_i)$, and $T_{e,i} = T_e(t_i)$.\n\nThe algorithm proceeds as follows for each test case:\n1. Initialize the state variables at time $t=0$: $t_0 = 0$, $T_{e,0} = T_{e0}$ (from the specific test case), and $n_{Z,0}=0$.\n2. Determine the total number of simulation steps, $N = \\text{int}(t_{\\max}/\\Delta t)$.\n3. Iterate from $i=0$ to $N-1$. In each iteration, representing a step forward in time:\n    a. Let the current time be $t_i = i \\cdot \\Delta t$.\n    b. Check the collapse condition: If $T_{e,i} \\le T_{\\mathrm{floor}}$, the simulation for this case terminates. The collapse is considered to have occurred, and the collapse time is recorded as $t_i$.\n    c. If no collapse has occurred, calculate the derivatives $\\frac{dn_Z}{dt}$ and $\\frac{dT_e}{dt}$ using the values $t_i$, $n_{Z,i}$, and $T_{e,i}$.\n    d. Update the state variables to $n_{Z,i+1}$ and $T_{e,i+1}$ using the Forward Euler formulas described above.\n4. If the loop completes without the collapse condition being met, it means the temperature remained above $T_{\\mathrm{floor}}$ for the entire duration $t_{\\max}$. In this scenario, no collapse occurred, and the collapse time is reported as $-1.0$.\n5. The final result for each case is a pair $[b, t]$, where $b$ is a boolean (`True` for collapse, `False` otherwise) and $t$ is the collapse time rounded to six decimal places (or $-1.0$).\n\nThis procedure is applied to all four specified test cases, which are designed to probe different physical regimes: a standard successful thermal quench (case 1), a baseline with no impurity injection (case 2), a scenario with weak injection that may not be sufficient to cause collapse (case 3), and a case where rapid impurity transport loss counteracts the cooling effect (case 4).",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 0D plasma thermal quench model for the given test cases.\n    \"\"\"\n    # Define physical and model constants\n    E_CHARGE = 1.602176634e-19  # J/eV\n    LAMBDA_PEAK = 3.0e-32       # W m^3\n    T_PEAK = 50.0               # eV\n    SIGMA = 0.7                 # dimensionless\n    C_BREM = 1.69e-38           # W m^3 eV^(-1/2)\n\n    # Define test suite\n    test_cases = [\n        # Case 1: General strong injection\n        {\n            \"n_e\": 5.0e19, \"T_e0\": 2000.0, \"Z_eff\": 18,\n            \"S0\": 5.0e22, \"t0\": 0.010, \"tau_inj\": 0.005, \"tau_loss\": 0.020,\n            \"T_floor\": 5.0, \"t_max\": 0.100, \"dt\": 1.0e-5\n        },\n        # Case 2: No injection\n        {\n            \"n_e\": 5.0e19, \"T_e0\": 2000.0, \"Z_eff\": 18,\n            \"S0\": 0.0, \"t0\": 0.010, \"tau_inj\": 0.005, \"tau_loss\": 0.020,\n            \"T_floor\": 5.0, \"t_max\": 0.100, \"dt\": 1.0e-5\n        },\n        # Case 3: Weak injection\n        {\n            \"n_e\": 5.0e19, \"T_e0\": 2000.0, \"Z_eff\": 18,\n            \"S0\": 1.0e20, \"t0\": 0.010, \"tau_inj\": 0.003, \"tau_loss\": 0.030,\n            \"T_floor\": 5.0, \"t_max\": 0.100, \"dt\": 1.0e-5\n        },\n        # Case 4: Fast impurity loss\n        {\n            \"n_e\": 5.0e19, \"T_e0\": 2000.0, \"Z_eff\": 18,\n            \"S0\": 5.0e21, \"t0\": 0.010, \"tau_inj\": 0.005, \"tau_loss\": 5.0e-4,\n            \"T_floor\": 5.0, \"t_max\": 0.100, \"dt\": 1.0e-5\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        # Unpack parameters\n        T_e0 = case[\"T_e0\"]\n        Z_eff = case[\"Z_eff\"]\n        S0 = case[\"S0\"]\n        t0 = case[\"t0\"]\n        tau_inj = case[\"tau_inj\"]\n        tau_loss = case[\"tau_loss\"]\n        T_floor = case[\"T_floor\"]\n        t_max = case[\"t_max\"]\n        dt = case[\"dt\"]\n        \n        # Initialize state variables\n        t = 0.0\n        T_e = T_e0\n        n_Z = 0.0\n        \n        num_steps = int(t_max / dt)\n        \n        collapse_occurred = False\n        collapse_time = -1.0\n        \n        for i in range(num_steps):\n            t = i * dt\n            \n            # Check for radiative collapse\n            if T_e = T_floor:\n                collapse_occurred = True\n                collapse_time = round(t, 6)\n                break\n            \n            # Calculate derivatives at current time step\n            # Impurity source term\n            source_term = S0 * np.exp(-((t - t0)**2) / (2 * tau_inj**2))\n            \n            # Impurity density derivative\n            dnZ_dt = source_term - n_Z / tau_loss\n            \n            # Radiation terms\n            # Note: np.log can handle T_e=0, but our T_floor  0 ensures T_e is positive\n            log_term = np.log(T_e / T_PEAK)\n            lambda_line = LAMBDA_PEAK * np.exp(-(log_term**2) / (2 * SIGMA**2))\n            lambda_brem = C_BREM * Z_eff * np.sqrt(T_e)\n            lambda_Z = lambda_line + lambda_brem\n            \n            # Electron temperature derivative\n            dTe_dt = -(2 / (3 * E_CHARGE)) * n_Z * lambda_Z\n            \n            # Update state variables using Forward Euler method\n            n_Z += dnZ_dt * dt\n            T_e += dTe_dt * dt\n\n        # Handle the case where the loop finishes without collapse\n        if not collapse_occurred and T_e = T_floor:\n            t = num_steps * dt\n            collapse_occurred = True\n            collapse_time = round(t, 6)\n            \n        all_results.append([collapse_occurred, collapse_time])\n\n    # Format the final output string exactly as required\n    result_strings = []\n    for res in all_results:\n        # Manually format to avoid extra spaces from standard list-to-string conversion\n        result_strings.append(f\"[{res[0]},{res[1]}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "A major challenge in disruption mitigation is the prevention of runaway electron beams, which can be generated by the large electric field induced during the current quench. This final practice focuses on modeling the conditions for runaway suppression, the hallmark of an advanced mitigation system. You will develop a model to track the evolution of the ratio of the accelerating electric field, $E_\\parallel$, to the critical Dreicer field, $E_c$ . This will allow you to quantitatively assess how injecting a massive amount of impurities can keep the ratio $E_\\parallel/E_c  1$, ensuring the plasma remains collisional and avoiding the formation of a damaging runaway beam.",
            "id": "3947754",
            "problem": "You are asked to construct, analyze, and implement a zero-dimensional (0D) model to quantify the parallel electric field to Connor–Hastie critical field ratio during a current quench driven by impurity assimilation from Massive Gas Injection (MGI) or Shattered Pellet Injection (SPI). Use the following principled bases: Faraday’s law for a toroidal circuit, resistive magnetohydrodynamics relations, and the Connor–Hastie critical field. The objective is to compute the time evolution of the dimensionless ratio $E/E_c$ and determine whether impurity-induced collisionality drives the system into the collisional regime $E/E_c  1$ during the quench.\n\nModel assumptions and definitions to be used:\n- Treat the plasma as a single toroidal circuit of self-inductance $L$ carrying current $I(t)$ around a loop of length $l = 2\\pi R_0$, where $R_0$ is the major radius, and with an effective current-carrying cross-sectional area $A = \\pi a^2$, where $a$ is the minor radius.\n- The loop voltage is $V = L\\,dI/dt$, and the spatially averaged parallel electric field is $E_\\parallel = V/l$.\n- The resistive Ohm’s law is $E_\\parallel = \\eta(T_e,Z_{\\mathrm{eff}})\\,I/A$, where the Spitzer resistivity is modeled as\n$$\n\\eta(T_e,Z_{\\mathrm{eff}}) = C_\\eta\\,\\frac{Z_{\\mathrm{eff}}\\,\\ln\\Lambda}{T_e^{3/2}},\n$$\nwith $T_e$ in electronvolts and $C_\\eta = 5.2\\times 10^{-5}\\ \\mathrm{\\Omega\\cdot m\\cdot eV^{3/2}}$ a commonly used constant for fully ionized plasmas.\n- The Connor–Hastie critical field is\n$$\nE_c(n_e,\\ln\\Lambda)=\\frac{n_e\\,e^3\\,\\ln\\Lambda}{4\\pi\\,\\varepsilon_0^2\\,m_e\\,c^2},\n$$\nwhere $n_e$ is the electron number density (in $\\mathrm{m^{-3}}$), $e$ is the elementary charge, $\\varepsilon_0$ is the vacuum permittivity, $m_e$ is the electron mass, $c$ is the speed of light, and $\\ln\\Lambda$ is the Coulomb logarithm.\n\nDynamics and parametrizations:\n- The plasma current obeys the circuit equation:\n$$\n\\frac{dI}{dt} = -\\frac{R_p(t)}{L}\\,I(t),\\qquad R_p(t) = \\frac{\\eta(T_e(t),Z_{\\mathrm{eff}}(t))\\,l}{A}.\n$$\n- Represent impurity-driven cooling and ionization by the following time-dependent functions (starting at $t=0$):\n$$\nT_e(t) = T_{e0}\\,\\exp\\!\\left(-\\frac{t}{\\tau_T}\\right),\\quad Z_{\\mathrm{eff}}(t) = Z_0 + \\Delta Z\\left(1 - e^{-t/\\tau_Z}\\right),\\quad n_e(t) = n_{e0} + \\Delta n\\left(1 - e^{-t/\\tau_n}\\right).\n$$\nThese capture strong radiative cooling and rapid density rise due to impurity assimilation during MGI/SPI, as well as an increase in effective charge state.\n\nComputational target:\n- Numerically integrate the above 0D model over a fixed window $t\\in[0,t_{\\mathrm{end}}]$ with a uniform time step $\\Delta t$, compute $E_\\parallel(t)=\\eta(T_e(t),Z_{\\mathrm{eff}}(t))\\,I(t)/A$, compute $E_c(t)$, and form the ratio $r(t)=E_\\parallel(t)/E_c(t)$.\n- For each test case, report two quantities:\n  1. The maximum value of $r(t)$ over the modeled window, as a float rounded to three decimals.\n  2. A binary indicator (integer $0$ or $1$) answering whether collisional suppression is achieved after a short transient: define $t_{\\mathrm{check}}$ as the start of the evaluation window and return $1$ if $r(t)\\le 1$ for all $t\\in[t_{\\mathrm{check}},t_{\\mathrm{end}}]$, else return $0$.\n\nRequired units and numerical specifications:\n- Use International System of Units (SI) for all physical quantities except $T_e$, which must be in electronvolts when used in the resistivity formula.\n- All distances in meters, time in seconds, current in amperes, resistivity in $\\mathrm{\\Omega\\cdot m}$, and electric field in $\\mathrm{V/m}$.\n- Use $t_{\\mathrm{end}} = 0.02$ (seconds), $\\Delta t = 1.0\\times 10^{-5}$ (seconds), and $t_{\\mathrm{check}} = 0.002$ (seconds). When evaluating the resistivity, enforce a floor $T_e(t)\\ge 1$ (electronvolts) to avoid divergence as $T_e\\to 0$.\n\nTest suite:\nProvide results for the following three parameter sets, designed to probe distinct regimes:\n\n- Case A (strong assimilation and cooling; expected collisional regime):\n  - $R_0 = 3.0$, $a = 1.0$, $L = 1.0\\times 10^{-6}$, $I_0 = 5.0\\times 10^6$,\n  - $T_{e0} = 3.0\\times 10^3$, $\\tau_T = 1.0\\times 10^{-3}$,\n  - $Z_0 = 2.0$, $\\Delta Z = 10.0$, $\\tau_Z = 1.5\\times 10^{-3}$,\n  - $n_{e0} = 7.0\\times 10^{19}$, $\\Delta n = 5.0\\times 10^{20}$, $\\tau_n = 1.0\\times 10^{-3}$,\n  - $\\ln\\Lambda = 15.0$.\n\n- Case B (weak assimilation; likely runaway-favorable):\n  - $R_0 = 3.0$, $a = 1.0$, $L = 1.0\\times 10^{-6}$, $I_0 = 5.0\\times 10^6$,\n  - $T_{e0} = 3.0\\times 10^3$, $\\tau_T = 3.0\\times 10^{-3}$,\n  - $Z_0 = 2.0$, $\\Delta Z = 3.0$, $\\tau_Z = 3.0\\times 10^{-3}$,\n  - $n_{e0} = 7.0\\times 10^{19}$, $\\Delta n = 5.0\\times 10^{19}$, $\\tau_n = 3.0\\times 10^{-3}$,\n  - $\\ln\\Lambda = 15.0$.\n\n- Case C (very strong assimilation and ultra-fast cooling; robust suppression):\n  - $R_0 = 3.0$, $a = 1.0$, $L = 1.0\\times 10^{-6}$, $I_0 = 5.0\\times 10^6$,\n  - $T_{e0} = 3.0\\times 10^3$, $\\tau_T = 5.0\\times 10^{-4}$,\n  - $Z_0 = 2.0$, $\\Delta Z = 20.0$, $\\tau_Z = 8.0\\times 10^{-4}$,\n  - $n_{e0} = 7.0\\times 10^{19}$, $\\Delta n = 1.0\\times 10^{21}$, $\\tau_n = 6.0\\times 10^{-4}$,\n  - $\\ln\\Lambda = 15.0$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by test case and flattened such that for Case A the pair appears first, then Case B, then Case C. The list must contain six entries: $[r_{\\max}^{(A)},\\mathrm{flag}^{(A)},r_{\\max}^{(B)},\\mathrm{flag}^{(B)},r_{\\max}^{(C)},\\mathrm{flag}^{(C)}]$, where each $r_{\\max}$ is rounded to three decimals and each flag is the integer $1$ or $0$ as defined above.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and self-contained. The task is to construct and solve a zero-dimensional ($0$D) model for the evolution of plasma current and key parameters during a tokamak disruption mitigated by impurity injection. The solution will proceed by numerically integrating the governing equations.\n\nThe core of the model is the circuit equation for the total plasma current, $I(t)$, where the plasma is treated as a single toroidal inductor with self-inductance $L$ and resistance $R_p(t)$. From Faraday's law, the evolution of the current is described by the first-order ordinary differential equation:\n$$\n\\frac{dI(t)}{dt} = -\\frac{R_p(t)}{L}I(t)\n$$\nwith an initial condition $I(t=0) = I_0$. The plasma resistance $R_p(t)$ is time-dependent due to the rapid evolution of plasma parameters during the disruption. For a torus of major radius $R_0$ and minor radius $a$, the resistance is given by:\n$$\nR_p(t) = \\frac{\\eta(t)l}{A}\n$$\nwhere $l = 2\\pi R_0$ is the toroidal circumference and $A = \\pi a^2$ is the current-carrying cross-sectional area. The plasma resistivity, $\\eta(t)$, is described by the Spitzer model, which is a function of the electron temperature $T_e(t)$ and the effective ionic charge $Z_{\\mathrm{eff}}(t)$:\n$$\n\\eta(T_e(t), Z_{\\mathrm{eff}}(t)) = C_\\eta\\,\\frac{Z_{\\mathrm{eff}}(t)\\,\\ln\\Lambda}{T_e(t)^{3/2}}\n$$\nHere, $C_\\eta = 5.2\\times 10^{-5}\\ \\mathrm{\\Omega\\cdot m\\cdot eV^{3/2}}$ is a constant, and $T_e$ must be in units of electronvolts. The dynamics of the disruption are modeled through prescribed functions for the evolution of temperature, effective charge, and electron density, capturing the effects of impurity-driven cooling and ionization:\n$$\nT_e(t) = T_{e0}\\,\\exp\\!\\left(-\\frac{t}{\\tau_T}\\right)\n$$\n$$\nZ_{\\mathrm{eff}}(t) = Z_0 + \\Delta Z\\left(1 - e^{-t/\\tau_Z}\\right)\n$$\n$$\nn_e(t) = n_{e0} + \\Delta n\\left(1 - e^{-t/\\tau_n}\\right)\n$$\nThe primary quantity of interest is the ratio of the parallel electric field, $E_\\parallel(t)$, to the Connor-Hastie critical field, $E_c(t)$. The parallel electric field is driven by the plasma's resistivity and is calculated using Ohm's law:\n$$\nE_\\parallel(t) = \\eta(t)\\frac{I(t)}{A}\n$$\nThe Connor-Hastie critical field is the threshold above which electrons are continually accelerated, becoming \"runaway\" electrons. It depends on the electron density $n_e(t)$ and the Coulomb logarithm $\\ln\\Lambda$:\n$$\nE_c(t)=\\frac{n_e(t)\\,e^3\\,\\ln\\Lambda}{4\\pi\\,\\varepsilon_0^2\\,m_e\\,c^2}\n$$\nwhere $e$, $\\varepsilon_0$, $m_e$, and $c$ are fundamental physical constants. We are tasked with computing the ratio $r(t) = E_\\parallel(t)/E_c(t)$.\n\nTo solve the system, we employ a numerical approach. The ODE for the current $I(t)$ is solved using the forward Euler method, consistent with the problem's specification of a fixed time step $\\Delta t$. Discretizing time as $t_k = k\\Delta t$, the current at step $k+1$ is updated from step $k$ as:\n$$\nI_{k+1} = I_k + \\Delta t \\left(-\\frac{R_p(t_k)}{L}I_k\\right) = I_k \\left(1 - \\frac{R_p(t_k)\\Delta t}{L}\\right)\n$$\nThe algorithm proceeds as follows:\nFirst, we establish the time grid from $t=0$ to $t=t_{\\mathrm{end}}$ with spacing $\\Delta t=1.0\\times 10^{-5}\\ \\mathrm{s}$. All time-dependent parameters ($T_e, Z_{\\mathrm{eff}}, n_e, \\eta, R_p$) are evaluated at each point on this grid, forming arrays of values. The required temperature floor of $T_e \\ge 1\\ \\mathrm{eV}$ is enforced.\nSecond, the current $I(t)$ is calculated iteratively. Starting with $I_0$, the forward Euler scheme is applied step-by-step to find the current at all subsequent time points. This part of the calculation is inherently sequential.\nThird, once the time series for $I(t)$ is known, the arrays for the parallel electric field $E_\\parallel(t_k)$ and the critical field $E_c(t_k)$ are computed.\nFinally, the ratio $r(t_k) = E_\\parallel(t_k)/E_c(t_k)$ is calculated for all time points. From this final array, two metrics are extracted for each test case:\n1. The maximum value of the ratio, $r_{\\max} = \\max_k \\{r(t_k)\\}$, over the entire simulation window $t \\in [0, t_{\\mathrm{end}}]$.\n2. A binary flag indicating whether collisional runaway electron suppression is achieved. This flag is set to $1$ if $r(t_k) \\le 1$ for all time points $t_k \\ge t_{\\mathrm{check}} = 0.002\\ \\mathrm{s}$, and $0$ otherwise.\n\nThe implementation is carried out in Python, leveraging the `numpy` library for efficient vectorized computations where possible (e.g., evaluating the analytical functions for plasma parameters). The physical constants are taken from standard sources in SI units. The procedure is repeated for each of the three parameter sets provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 0D model for current quench dynamics and evaluates the\n    E/Ec ratio for three different test cases.\n    \"\"\"\n\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    M_E = 9.10938356e-31       # Electron mass in kg\n    EPS0 = 8.854187817e-12      # Vacuum permittivity in F/m\n    C_LIGHT = 299792458         # Speed of light in m/s\n    PI = np.pi\n\n    # Model-specific constant\n    C_ETA = 5.2e-5  # Resistivity constant in Omega*m*eV^(3/2)\n\n    def run_simulation(params):\n        \"\"\"\n        Runs the simulation for a single set of parameters.\n        \"\"\"\n        # Unpack parameters\n        R0, a, L, I0 = params['geo']\n        Te0, tau_T = params['Te']\n        Z0, dZ, tau_Z = params['Zeff']\n        ne0, dn, tau_n = params['ne']\n        ln_Lambda = params['lnL']\n\n        # Numerical specifications from the problem\n        t_end = 0.02\n        dt = 1.0e-5\n        t_check = 0.002\n        Te_floor = 1.0\n\n        # Derived geometric parameters\n        l = 2 * PI * R0  # Toroidal circumference\n        A = PI * a**2    # Cross-sectional area\n\n        # Create time array\n        t_array = np.arange(0, t_end + dt, dt)\n        n_steps = len(t_array)\n\n        # Calculate time-dependent plasma parameters in a vectorized manner\n        Te_array = Te0 * np.exp(-t_array / tau_T)\n        Te_array = np.maximum(Te_array, Te_floor)  # Apply temperature floor\n\n        Zeff_array = Z0 + dZ * (1 - np.exp(-t_array / tau_Z))\n        ne_array = ne0 + dn * (1 - np.exp(-t_array / tau_n))\n\n        # Calculate time-dependent Spitzer resistivity and plasma resistance\n        eta_array = C_ETA * Zeff_array * ln_Lambda / (Te_array**1.5)\n        Rp_array = eta_array * l / A\n\n        # Solve for current I(t) using the forward Euler method\n        I_array = np.zeros(n_steps)\n        I_array[0] = I0\n        for k in range(n_steps - 1):\n            I_array[k+1] = I_array[k] * (1 - Rp_array[k] * dt / L)\n\n        # Calculate the parallel electric field from Ohm's law\n        E_parallel_array = eta_array * I_array / A\n        \n        # Calculate the Connor-Hastie critical field\n        Ec_const = (E_CHARGE**3) / (4 * PI * EPS0**2 * M_E * C_LIGHT**2)\n        Ec_array = Ec_const * ne_array * ln_Lambda\n\n        # Calculate the ratio r(t) = E_parallel / E_c\n        r_array = E_parallel_array / Ec_array\n\n        # Compute the two required output quantities\n        # 1. Maximum value of r(t) over the full time window\n        r_max = np.max(r_array)\n\n        # 2. Collisional suppression flag for t = t_check\n        check_idx = np.searchsorted(t_array, t_check)\n        is_suppressed = np.all(r_array[check_idx:] = 1.0)\n        flag = 1 if is_suppressed else 0\n        \n        return round(r_max, 3), flag\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: strong assimilation and cooling\n        {\n            'geo': (3.0, 1.0, 1.0e-6, 5.0e6), 'Te': (3.0e3, 1.0e-3),\n            'Zeff': (2.0, 10.0, 1.5e-3), 'ne': (7.0e19, 5.0e20, 1.0e-3),\n            'lnL': 15.0\n        },\n        # Case B: weak assimilation\n        {\n            'geo': (3.0, 1.0, 1.0e-6, 5.0e6), 'Te': (3.0e3, 3.0e-3),\n            'Zeff': (2.0, 3.0, 3.0e-3), 'ne': (7.0e19, 5.0e19, 3.0e-3),\n            'lnL': 15.0\n        },\n        # Case C: very strong assimilation and ultra-fast cooling\n        {\n            'geo': (3.0, 1.0, 1.0e-6, 5.0e6), 'Te': (3.0e3, 5.0e-4),\n            'Zeff': (2.0, 20.0, 8.0e-4), 'ne': (7.0e19, 1.0e21, 6.0e-4),\n            'lnL': 15.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        r_max_val, flag_val = run_simulation(case)\n        results.extend([r_max_val, flag_val])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}