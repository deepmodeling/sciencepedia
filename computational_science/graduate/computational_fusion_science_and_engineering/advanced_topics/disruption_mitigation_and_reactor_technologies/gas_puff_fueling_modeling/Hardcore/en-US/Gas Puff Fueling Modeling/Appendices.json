{
    "hands_on_practices": [
        {
            "introduction": "Before building a comprehensive transport model, we must first understand the dominant microscopic interactions governing a neutral particle's journey. This exercise delves into the fundamental collision physics within the plasma edge. By analyzing temperature-dependent cross-sections, you will derive a critical condition that determines whether neutral-neutral or neutral-ion collisions dictate the transport regime, a crucial step in justifying the physical basis of a chosen computational model.",
            "id": "3984303",
            "problem": "Consider a deuterium gas puff fueling (GPF) scenario supplying neutrals into the edge of a toroidal fusion plasma. The mixture consists of deuterium neutrals with number density $n_{n}$ and deuterium ions with number density $n_{i}$ at a common kinetic temperature $T$ in the edge region. For a moving neutral particle, define the mean free path as $\\lambda = 1/\\left(n \\,\\sigma_{\\mathrm{eff}}(T)\\right)$, where $n$ is the number density of the target species and $\\sigma_{\\mathrm{eff}}(T)$ is an effective, temperature-dependent momentum-transfer cross section.\n\nAssume the following physically motivated models for the effective cross sections:\n- Neutral-neutral elastic scattering is characterized by a weak power-law temperature dependence,\n$$\\sigma_{nn}(T) = \\sigma_{nn,0}\\left(\\frac{T}{T_{0}}\\right)^{-s_{nn}},$$\nwhere $\\sigma_{nn,0}$, $T_{0}$, and $s_{nn}0$ are constants reflecting short-range repulsion and weak energy dependence at edge-plasma energies.\n- Neutral-ion momentum-transfer scattering is dominated by the charge-induced dipole interaction producing a stronger temperature dependence such that\n$$\\sigma_{ni}(T) = \\sigma_{ni,0}\\left(\\frac{T}{T_{0}}\\right)^{-s_{ni}},$$\nwhere $\\sigma_{ni,0}$, $T_{0}$, and $s_{ni}0$ are constants, with $s_{ni}$ typically exceeding $s_{nn}$ due to the inverse speed scaling of the underlying interaction.\n\nStarting from kinetic theory and these effective cross sections, do the following:\n1. Derive expressions for the neutral-neutral mean free path $\\lambda_{nn}(T)$ and the neutral-ion mean free path $\\lambda_{ni}(T)$ in terms of $n_{n}$, $n_{i}$, $\\sigma_{nn,0}$, $\\sigma_{ni,0}$, $s_{nn}$, $s_{ni}$, $T$, and $T_{0}$.\n2. Using first principles, determine the condition under which neutral-neutral collisions dominate over neutral-ion collisions for a test neutral, by comparing the relative collision contributions from targets $n_{n}\\sigma_{nn}(T)$ and $n_{i}\\sigma_{ni}(T)$.\n3. Define the neutral fraction $f_{n} \\equiv n_{n}/(n_{n}+n_{i})$. Derive a closed-form expression for the critical neutral fraction $f_{n}^{\\mathrm{crit}}(T)$ at which the neutral-neutral and neutral-ion collision contributions are equal. Express your final answer entirely in terms of $\\sigma_{nn,0}$, $\\sigma_{ni,0}$, $s_{nn}$, $s_{ni}$, $T$, and $T_{0}$.\n4. Provide only the final analytic expression for $f_{n}^{\\mathrm{crit}}(T)$ as your answer. Do not substitute numerical values.\n\nYour final answer must be a single closed-form analytic expression. If you introduce any intermediate quantities in your derivation, eliminate them to present the answer solely in terms of the specified parameters. No rounding is required.",
            "solution": "**1. Derive expressions for $\\lambda_{nn}(T)$ and $\\lambda_{ni}(T)$**\n\nThe mean free path $\\lambda$ of a test particle moving through a field of target particles with number density $n$ and an effective cross section $\\sigma_{\\mathrm{eff}}(T)$ is given by:\n$$ \\lambda = \\frac{1}{n \\, \\sigma_{\\mathrm{eff}}(T)} $$\nFor a test neutral particle colliding with background neutrals, the target density is $n_{n}$ and the cross section is $\\sigma_{nn}(T)$. Therefore, the neutral-neutral mean free path, $\\lambda_{nn}(T)$, is:\n$$ \\lambda_{nn}(T) = \\frac{1}{n_{n} \\sigma_{nn}(T)} $$\nSubstituting the given expression for $\\sigma_{nn}(T)$:\n$$ \\lambda_{nn}(T) = \\frac{1}{n_{n} \\sigma_{nn,0} \\left(\\frac{T}{T_{0}}\\right)^{-s_{nn}}} = \\frac{1}{n_{n} \\sigma_{nn,0}} \\left(\\frac{T}{T_{0}}\\right)^{s_{nn}} $$\nFor a test neutral particle colliding with background ions, the target density is $n_{i}$ and the cross section is $\\sigma_{ni}(T)$. Therefore, the neutral-ion mean free path, $\\lambda_{ni}(T)$, is:\n$$ \\lambda_{ni}(T) = \\frac{1}{n_{i} \\sigma_{ni}(T)} $$\nSubstituting the given expression for $\\sigma_{ni}(T)$:\n$$ \\lambda_{ni}(T) = \\frac{1}{n_{i} \\sigma_{ni,0} \\left(\\frac{T}{T_{0}}\\right)^{-s_{ni}}} = \\frac{1}{n_{i} \\sigma_{ni,0}} \\left(\\frac{T}{T_{0}}\\right)^{s_{ni}} $$\n\n**2. Determine the condition for collision process dominance**\n\nThe collision frequency $\\nu$ for a particle of speed $v$ is given by $\\nu = n \\sigma v$. The relative contribution of a collision process is determined by the \"macroscopic cross section\" or inverse mean free path, $1/\\lambda = n \\sigma$. The problem requires comparing the collision contributions from neutral targets and ion targets for a test neutral.\n\nThe contribution from neutral-neutral collisions is proportional to $n_{n}\\sigma_{nn}(T)$.\nThe contribution from neutral-ion collisions is proportional to $n_{i}\\sigma_{ni}(T)$.\n\nNeutral-neutral collisions dominate over neutral-ion collisions when their contribution is larger. Thus, the condition for dominance is:\n$$ n_{n}\\sigma_{nn}(T) > n_{i}\\sigma_{ni}(T) $$\n\n**3. Derive the critical neutral fraction $f_{n}^{\\mathrm{crit}}(T)$**\n\nThe critical condition occurs when the two collision contributions are equal:\n$$ n_{n}\\sigma_{nn}(T) = n_{i}\\sigma_{ni}(T) $$\nWe are given the definition of the neutral fraction, $f_{n} \\equiv n_{n}/(n_{n}+n_{i})$. Let $n_{\\mathrm{tot}} = n_{n}+n_{i}$ be the total particle density. Then we can write the neutral and ion densities in terms of $f_{n}$ and $n_{\\mathrm{tot}}$:\n$$ n_{n} = f_{n} n_{\\mathrm{tot}} $$\n$$ n_{i} = (1-f_{n}) n_{\\mathrm{tot}} $$\nSubstituting these expressions into the equality condition at the critical neutral fraction, $f_{n}^{\\mathrm{crit}}$:\n$$ (f_{n}^{\\mathrm{crit}} n_{\\mathrm{tot}}) \\sigma_{nn}(T) = ((1-f_{n}^{\\mathrm{crit}}) n_{\\mathrm{tot}}) \\sigma_{ni}(T) $$\nThe total density $n_{\\mathrm{tot}}$ cancels from both sides, as it should since the relative contribution depends on the composition, not the total density.\n$$ f_{n}^{\\mathrm{crit}} \\sigma_{nn}(T) = (1-f_{n}^{\\mathrm{crit}}) \\sigma_{ni}(T) $$\nWe now solve for $f_{n}^{\\mathrm{crit}}$:\n$$ f_{n}^{\\mathrm{crit}} \\sigma_{nn}(T) = \\sigma_{ni}(T) - f_{n}^{\\mathrm{crit}} \\sigma_{ni}(T) $$\n$$ f_{n}^{\\mathrm{crit}} \\sigma_{nn}(T) + f_{n}^{\\mathrm{crit}} \\sigma_{ni}(T) = \\sigma_{ni}(T) $$\n$$ f_{n}^{\\mathrm{crit}} (\\sigma_{nn}(T) + \\sigma_{ni}(T)) = \\sigma_{ni}(T) $$\n$$ f_{n}^{\\mathrm{crit}}(T) = \\frac{\\sigma_{ni}(T)}{\\sigma_{nn}(T) + \\sigma_{ni}(T)} $$\nTo express this solely in terms of the given parameters, we substitute the expressions for $\\sigma_{nn}(T)$ and $\\sigma_{ni}(T)$. It is convenient to first divide the numerator and denominator by $\\sigma_{ni}(T)$:\n$$ f_{n}^{\\mathrm{crit}}(T) = \\frac{1}{\\frac{\\sigma_{nn}(T)}{\\sigma_{ni}(T)} + 1} $$\nNow, we compute the ratio of the cross sections:\n$$ \\frac{\\sigma_{nn}(T)}{\\sigma_{ni}(T)} = \\frac{\\sigma_{nn,0}\\left(\\frac{T}{T_{0}}\\right)^{-s_{nn}}}{\\sigma_{ni,0}\\left(\\frac{T}{T_{0}}\\right)^{-s_{ni}}} = \\frac{\\sigma_{nn,0}}{\\sigma_{ni,0}} \\left(\\frac{T}{T_{0}}\\right)^{-s_{nn} - (-s_{ni})} = \\frac{\\sigma_{nn,0}}{\\sigma_{ni,0}} \\left(\\frac{T}{T_{0}}\\right)^{s_{ni} - s_{nn}} $$\nSubstituting this ratio back into the expression for $f_{n}^{\\mathrm{crit}}(T)$:\n$$ f_{n}^{\\mathrm{crit}}(T) = \\frac{1}{1 + \\frac{\\sigma_{nn,0}}{\\sigma_{ni,0}} \\left(\\frac{T}{T_{0}}\\right)^{s_{ni} - s_{nn}}} $$\nMultiplying the numerator and denominator of the final expression by $\\sigma_{ni,0}$ yields the desired form:\n$$ f_{n}^{\\mathrm{crit}}(T) = \\frac{\\sigma_{ni,0}}{\\sigma_{ni,0} + \\sigma_{nn,0} \\left(\\frac{T}{T_{0}}\\right)^{s_{ni} - s_{nn}}} $$",
            "answer": "$$ \\boxed{ \\frac{\\sigma_{ni,0}}{\\sigma_{ni,0} + \\sigma_{nn,0} \\left(\\frac{T}{T_{0}}\\right)^{s_{ni} - s_{nn}}} } $$"
        },
        {
            "introduction": "Building upon the concept of mean free path, this practice addresses a pivotal decision in computational modeling: selecting the right simulation tool for the job. You will calculate the Knudsen number, a dimensionless parameter that characterizes the degree of collisionality, for different regions of a gas puff. This analysis will allow you to quantitatively justify whether a computationally intensive method like Direct Simulation Monte Carlo (DSMC) is required, or if a more efficient test-particle approach is valid.",
            "id": "3984282",
            "problem": "A deuterium gas puff is injected through a circular nozzle of radius $5\\,\\mathrm{mm}$ into the edge of a toroidal fusion device. In the near-nozzle region extending a distance $L_1 = 2\\,\\mathrm{cm}$ downstream of the exit plane, diagnostics infer a quasi-isothermal neutral cloud with density $n_n^{(1)} = 2.0 \\times 10^{21}\\,\\mathrm{m}^{-3}$ and temperature $T_n = 300\\,\\mathrm{K}$. Farther into the scrape-off layer, for a representative path length $L_2 = 5\\,\\mathrm{cm}$ from the nozzle, the neutral density drops to $n_n^{(2)} = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$ while the neutral temperature remains approximately $T_n = 300\\,\\mathrm{K}$. The elastic neutral-neutral scattering cross section is $\\sigma_{nn} = 2.0 \\times 10^{-19}\\,\\mathrm{m}^2$ for $\\mathrm{D}_2$ at room temperature. The mass of a $\\mathrm{D}_2$ molecule is $m_n = 6.7 \\times 10^{-27}\\,\\mathrm{kg}$, and the Boltzmann constant is $k_B = 1.38 \\times 10^{-23}\\,\\mathrm{J/K}$. The edge plasma density is $n_e \\approx 1.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, with subsonic plasma flows relative to the neutral thermal speed. The gas puff is pulsed with a duration of $1\\,\\mathrm{ms}$, and wall reflection is predominantly diffuse.\n\nStarting from the neutral Boltzmann equation and kinetic theory definitions, compare the Direct Simulation Monte Carlo (DSMC) method and the test-particle neutral approach for modeling gas puff fueling. Select the most accurate statement about which method is appropriate in each region and justify when neutral-neutral collisions must be included in edge modeling.\n\nA. In the $L_1$ region, neutral-neutral collisions must be resolved by DSMC because the mean free path is comparable to the characteristic length, yielding a Knudsen number $K_n \\approx 0.125$, while in the $L_2$ region a test-particle approach that neglects neutral-neutral collisions is adequate since $K_n \\approx 2$. This follows from the neutral Boltzmann equation where dropping the neutral-neutral collision operator is valid only when the number of collisions during advection across the region, $\\nu_{nn} L / v$, is $\\ll 1$.\n\nB. A test-particle approach is sufficient in both regions because neutral-neutral collisions are rare compared to plasma-neutral collisions at $n_e \\sim 10^{19}\\,\\mathrm{m}^{-3}$, and the charged plasma dominates the neutral collisionality irrespective of $n_n$.\n\nC. DSMC is necessary in both regions because the neutral jet is initially supersonic; collisionality is set by flow Mach number and is independent of $n_n$ and $\\sigma_{nn}$, so the test-particle limit is never appropriate for gas puff fueling.\n\nD. Neutral-neutral collisions can be neglected in the $L_1$ region because hydrogenic neutral cross sections at $300\\,\\mathrm{K}$ are below $10^{-21}\\,\\mathrm{m}^2$, but must be included in the $L_2$ region due to the longer neutral residence time, which increases the probability of neutral-neutral collisions.\n\nE. DSMC should be applied in the $L_2$ region only, since larger geometric length scales $L_2$ require explicit collision modeling, whereas the $L_1$ region can be treated by a test-particle approach because its smaller size implies dominantly ballistic streaming independent of $n_n$.",
            "solution": "The appropriate modeling technique is determined by the Knudsen number, $K_n = \\lambda_{nn}/L$, which compares the neutral-neutral mean free path, $\\lambda_{nn}$, to the characteristic length scale of the region, $L$. The mean free path is given by kinetic theory as $\\lambda_{nn} = 1/(\\sqrt{2} n_n \\sigma_{nn})$.\n\n-   If $K_n \\ll 1$, the gas is collisional and must be modeled as a fluid or with a method like Direct Simulation Monte Carlo (DSMC) that resolves intermolecular collisions.\n-   If $K_n \\gg 1$, the gas is collisionless (free-molecular), and a computationally cheaper test-particle approach, which neglects neutral-neutral collisions, is sufficient.\n-   The range $0.1 \\lesssim K_n \\lesssim 10$ is the transitional regime where DSMC is typically required.\n\nWe calculate the Knudsen number for each region.\n\n**Region 1 (near-nozzle, $L_1$):**\nGiven $L_1 = 2\\,\\mathrm{cm} = 0.02\\,\\mathrm{m}$, $n_n^{(1)} = 2.0 \\times 10^{21}\\,\\mathrm{m}^{-3}$, and $\\sigma_{nn} = 2.0 \\times 10^{-19}\\,\\mathrm{m}^2$.\nThe mean free path is:\n$$ \\lambda_{nn}^{(1)} = \\frac{1}{\\sqrt{2} \\cdot (2.0 \\times 10^{21}\\,\\mathrm{m}^{-3}) \\cdot (2.0 \\times 10^{-19}\\,\\mathrm{m}^2)} \\approx \\frac{1}{565.7\\,\\mathrm{m}^{-1}} \\approx 1.77 \\times 10^{-3}\\,\\mathrm{m} $$\nThe Knudsen number is:\n$$ K_n^{(1)} = \\frac{\\lambda_{nn}^{(1)}}{L_1} = \\frac{1.77 \\times 10^{-3}\\,\\mathrm{m}}{0.02\\,\\mathrm{m}} \\approx 0.0885 $$\nThis value is in the transitional regime ($K_n \\sim 0.1$), meaning neutral-neutral collisions are significant and must be modeled. Therefore, DSMC is the appropriate method.\n\n**Region 2 (scrape-off layer, $L_2$):**\nGiven $L_2 = 5\\,\\mathrm{cm} = 0.05\\,\\mathrm{m}$, $n_n^{(2)} = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, and $\\sigma_{nn} = 2.0 \\times 10^{-19}\\,\\mathrm{m}^2$.\nThe mean free path is:\n$$ \\lambda_{nn}^{(2)} = \\frac{1}{\\sqrt{2} \\cdot (5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}) \\cdot (2.0 \\times 10^{-19}\\,\\mathrm{m}^2)} \\approx \\frac{1}{14.14\\,\\mathrm{m}^{-1}} \\approx 7.07 \\times 10^{-2}\\,\\mathrm{m} $$\nThe Knudsen number is:\n$$ K_n^{(2)} = \\frac{\\lambda_{nn}^{(2)}}{L_2} = \\frac{7.07 \\times 10^{-2}\\,\\mathrm{m}}{0.05\\,\\mathrm{m}} \\approx 1.414 $$\nThis value is in the free-molecular regime ($K_n > 1$), where neutral-neutral collisions are rare. A test-particle approach is adequate.\n\nBased on this analysis, option A is the only one that correctly identifies the modeling requirements for both regions. It correctly states that DSMC is needed for the collisional region 1 and a test-particle approach is sufficient for the collisionless region 2. The numerical values provided in option A are consistent with our calculations, and the physical reasoning is sound.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "This final practice synthesizes the preceding concepts into a tangible computational task, bridging the gap between theory and implementation. You will develop a finite-difference solver for a simplified but representative 1D neutral transport equation, a common workhorse model in edge plasma studies. By conducting a mesh refinement study, you will gain direct experience with numerical verification and learn to critically assess how grid resolution affects the accuracy of key physical predictions, such as the location of the ionization source.",
            "id": "3984329",
            "problem": "A one-dimensional steady-state neutral transport model is used to represent gas puff fueling along a line from a puff port into the plasma edge. The objective is to assess grid resolution requirements to capture steep neutral density gradients near the puff port by performing a mesh refinement study on the localization of the ionization source. Starting from the neutral continuity equation and constitutive flux relations, derive a finite-difference scheme and implement it to compute the ionization source maximum location for progressively refined meshes, then quantify the error with respect to a highly resolved reference solution. Your program must produce the requested results for the provided test suite and print them in the specified format.\n\nFundamental base:\n- The steady-state neutral continuity equation along a one-dimensional coordinate $x$ is $ \\frac{d \\Gamma(x)}{d x} = - S_{\\mathrm{ion}}(x) $, where $ \\Gamma(x) $ is the neutral particle flux and $ S_{\\mathrm{ion}}(x) $ is the local ionization source density.\n- The flux is modeled by $ \\Gamma(x) = - D \\frac{d n(x)}{d x} + u \\, n(x) $, where $ D $ is a constant effective diffusion coefficient and $ u $ is a constant directed advection speed representing directed flow from the puff port.\n- The ionization source density is modeled by electron-impact ionization as $ S_{\\mathrm{ion}}(x) = \\alpha(x) \\, n(x) $, where $ \\alpha(x) = k_{\\mathrm{ei}} \\, n_e(x) $, $ k_{\\mathrm{ei}} $ is a constant effective ionization rate coefficient, and $ n_e(x) $ is the electron density profile.\n- Combining these, the governing equation for the neutral density is $ D \\frac{d^2 n}{d x^2} - u \\frac{d n}{d x} - \\alpha(x) n(x) = 0 $.\n- The boundary condition at the puff port ($ x = 0 $) prescribes an incoming neutral flux density $ F_0 $ via a Robin condition: $ - D \\left.\\frac{d n}{d x}\\right|_{x=0} + u \\, n(0) = F_0 $. The plasma end ($ x = L $) is modeled with a Dirichlet condition $ n(L) = 0 $.\n\nElectron density profile:\n- The electron density $ n_e(x) $ increases from a low near-wall value toward a higher edge-plasma value over a characteristic scale $ \\ell_e $: $ n_e(x) = n_0 + (n_1 - n_0)\\left(1 - e^{-x/\\ell_e}\\right) $.\n\nDiscretization requirements:\n- Discretize the domain $ x \\in [0, L] $ using a uniform grid of $ N $ nodes with spacing $ \\Delta x = L/(N-1) $.\n- Use a second-order central difference for the diffusion term $ D \\frac{d^2 n}{d x^2} $ and a first-order upwind difference for the advection term $ - u \\frac{d n}{d x} $ assuming $ u > 0 $.\n- Implement the Robin boundary condition at $ x = 0 $ using a one-sided finite difference for $ \\frac{d n}{d x} $, and impose $ n(L) = 0 $ at the right boundary.\n\nIonization source localization metric:\n- Define $ S_{\\mathrm{ion}}(x_i) = \\alpha(x_i) \\, n(x_i) $ at each grid node $ x_i $, and locate the position $ x_{\\mathrm{peak}} $ where $ S_{\\mathrm{ion}} $ attains its maximum on the discrete grid.\n- Let $ x_{\\mathrm{peak}}^{(N)} $ denote the peak location computed on a grid of $ N $ nodes, and let $ x_{\\mathrm{peak}}^{(\\mathrm{ref})} $ denote the peak location computed on a highly resolved reference grid. Define the localization error $ \\varepsilon(N) = \\left| x_{\\mathrm{peak}}^{(N)} - x_{\\mathrm{peak}}^{(\\mathrm{ref})} \\right| $.\n\nUnits:\n- All distances must be expressed in meters, speeds in meters per second, densities in inverse cubic meters, and flux densities in inverse square meters per second. The final reported errors must be expressed in meters. No angles are present. No percentages are present.\n\nTest suite:\n- For each case below, use a shared domain length $ L = 0.12 $ (meters), and a set of mesh sizes $ N \\in \\{ 64, 128, 256, 512 \\} $. For each case, compute $ x_{\\mathrm{peak}}^{(\\mathrm{ref})} $ using a reference mesh with $ N_{\\mathrm{ref}} = 4097 $ nodes.\n- Case $ A $ (moderate gradient, diffusion-advection balanced):\n  - $ D = 2.0 $ (meters squared per second), $ u = 50.0 $ (meters per second), $ k_{\\mathrm{ei}} = 8.0 \\times 10^{-14} $ (meters cubed per second), $ n_0 = 5.0 \\times 10^{18} $ (inverse cubic meters), $ n_1 = 2.0 \\times 10^{19} $ (inverse cubic meters), $ \\ell_e = 0.02 $ (meters), $ F_0 = 5.0 \\times 10^{22} $ (inverse square meters per second).\n- Case $ B $ (steep gradient near port):\n  - $ D = 0.5 $, $ u = 200.0 $, $ k_{\\mathrm{ei}} = 1.2 \\times 10^{-13} $, $ n_0 = 2.0 \\times 10^{18} $, $ n_1 = 3.0 \\times 10^{19} $, $ \\ell_e = 0.008 $, $ F_0 = 1.0 \\times 10^{23} $.\n- Case $ C $ (advection-dominated with strong sink):\n  - $ D = 0.2 $, $ u = 400.0 $, $ k_{\\mathrm{ei}} = 7.0 \\times 10^{-14} $, $ n_0 = 1.0 \\times 10^{18} $, $ n_1 = 2.5 \\times 10^{19} $, $ \\ell_e = 0.015 $, $ F_0 = 8.0 \\times 10^{22} $.\n\nComputational task:\n- For each case $ \\in \\{ A, B, C \\} $ and for each mesh size $ N \\in \\{ 64, 128, 256, 512 \\} $, compute $ x_{\\mathrm{peak}}^{(N)} $ and the corresponding localization error $ \\varepsilon(N) $ in meters, using the $ N_{\\mathrm{ref}} = 4097 $ reference result for that case.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where the list contains three sublists corresponding to cases $ A $, $ B $, and $ C $, and each sublist contains the four errors $ \\varepsilon(64) $, $ \\varepsilon(128) $, $ \\varepsilon(256) $, and $ \\varepsilon(512) $ in meters. For example, the printed structure must be of the form $ [ [ \\varepsilon_{A,64}, \\varepsilon_{A,128}, \\varepsilon_{A,256}, \\varepsilon_{A,512} ], [ \\varepsilon_{B,64}, \\varepsilon_{B,128}, \\varepsilon_{B,256}, \\varepsilon_{B,512} ], [ \\varepsilon_{C,64}, \\varepsilon_{C,128}, \\varepsilon_{C,256}, \\varepsilon_{C,512} ] ] $ with numeric values in meters.",
            "solution": "The problem requires solving the steady-state neutral density boundary value problem using a finite-difference method. The ODE is discretized into a system of linear algebraic equations, which can then be solved to find the neutral density profile $n(x)$.\n\n**1. Discretization of the Governing Equation**\nThe domain $x \\in [0, L]$ is discretized on a uniform grid of $N$ points $x_i = i \\Delta x$ for $i = 0, 1, \\dots, N-1$, with spacing $\\Delta x = L/(N-1)$. The governing ODE is:\n$$ D \\frac{d^2 n}{d x^2} - u \\frac{d n}{d x} - \\alpha(x) n(x) = 0 $$\nUsing a second-order central difference for the diffusion term and a first-order upwind difference for advection (for $u  0$), the discrete equation at an interior node $x_i$ ($1 \\le i \\le N-2$) is:\n$$ D \\frac{n_{i+1} - 2n_i + n_{i-1}}{(\\Delta x)^2} - u \\frac{n_i - n_{i-1}}{\\Delta x} - \\alpha_i n_i = 0 $$\nRearranging to group terms by grid index, we get the equation for row $i$ of our linear system:\n$$ (D + u\\Delta x)n_{i-1} + (-2D - u\\Delta x - \\alpha_i (\\Delta x)^2)n_i + Dn_{i+1} = 0 $$\n\n**2. Discretization of Boundary Conditions**\n-   **Right Boundary ($x=L$, node $i=N-1$):** The Dirichlet condition $n(L) = 0$ sets $n_{N-1} = 0$.\n-   **Left Boundary ($x=0$, node $i=0$):** The Robin condition is $- D \\left.\\frac{d n}{d x}\\right|_{x=0} + u \\, n(0) = F_0$. Using a first-order forward difference for the derivative, $\\left.\\frac{d n}{d x}\\right|_{x=0} \\approx \\frac{n_1 - n_0}{\\Delta x}$, we get:\n$$ -D \\frac{n_1 - n_0}{\\Delta x} + u n_0 = F_0 $$\nThis gives the first equation in the linear system:\n$$ (D + u\\Delta x)n_0 - Dn_1 = F_0 \\Delta x $$\n\n**3. Assembling and Solving the Linear System**\nWe have a system of $N-1$ linear equations for the $N-1$ unknowns $n_0, n_1, \\dots, n_{N-2}$. This system, $A \\mathbf{n'} = \\mathbf{b}$, is tridiagonal and can be solved efficiently. Once the unknowns $\\mathbf{n'} = [n_0, \\dots, n_{N-2}]^T$ are found, the full profile is constructed by appending $n_{N-1}=0$. The ionization source profile $S_{\\mathrm{ion}, i} = \\alpha_i n_i$ is then calculated, and its peak location $x_{\\mathrm{peak}}$ is found. This procedure is implemented in the provided Python code.",
            "answer": "```python\nimport numpy as np\n\ndef compute_x_peak(params, N):\n    \"\"\"\n    Solves the 1D neutral transport equation and returns the location of the\n    ionization source peak.\n\n    Args:\n        params (tuple): A tuple containing the physical parameters\n                        (D, u, k_ei, n0, n1, le, F0, L).\n        N (int): The number of grid nodes.\n\n    Returns:\n        float: The x-coordinate of the peak of the ionization source.\n    \"\"\"\n    D, u, k_ei, n0, n1, le, F0, L = params\n\n    # 1. Grid and Profile Setup\n    dx = L / (N - 1)\n    x = np.linspace(0, L, N)\n    \n    # Electron density and ionization rate coefficient profiles\n    n_e = n0 + (n1 - n0) * (1 - np.exp(-x / le))\n    alpha = k_ei * n_e\n\n    # 2. Assemble the Linear System A * n' = b\n    # The system is for n' = [n_0, ..., n_{N-2}], so its size is M x M\n    # where M = N - 1.\n    M = N - 1\n    if M = 0:\n        return 0.0\n\n    # Right-hand side vector b\n    b = np.zeros(M)\n    b[0] = F0 * dx\n\n    # Create the tridiagonal matrix A from its diagonals\n    # Main diagonal\n    main_diag = np.zeros(M)\n    main_diag[0] = D + u * dx\n    # Corresponds to nodes i=1 to N-2 (which is M-1)\n    main_diag[1:] = -2 * D - u * dx - alpha[1:N-1] * dx**2\n\n    # Upper diagonal (super-diagonal)\n    upper_diag = np.zeros(M - 1)\n    if M  1:\n        upper_diag[0] = -D\n        upper_diag[1:] = D\n\n    # Lower diagonal (sub-diagonal)\n    lower_diag = np.zeros(M - 1)\n    if M  1:\n        lower_diag[:] = D + u * dx\n\n    A = np.diag(main_diag)\n    if M  1:\n        A += np.diag(upper_diag, k=1)\n        A += np.diag(lower_diag, k=-1)\n\n    # 3. Solve the System and Reconstruct Full Solution\n    try:\n        n_prime = np.linalg.solve(A, b)\n    except np.linalg.LinAlgError:\n        return np.nan\n\n    # Full neutral density profile n (including n(L)=0)\n    n = np.zeros(N)\n    n[:N-1] = n_prime\n\n    # 4. Compute Source Profile and Find Peak Location\n    S_ion = alpha * n\n    peak_index = np.argmax(S_ion)\n    x_peak = x[peak_index]\n\n    return x_peak\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    L = 0.12  # meters\n    N_list = [64, 128, 256, 512]\n    N_ref = 4097\n\n    test_cases = [\n        # Case A\n        (2.0, 50.0, 8.0e-14, 5.0e18, 2.0e19, 0.02, 5.0e22, L),\n        # Case B\n        (0.5, 200.0, 1.2e-13, 2.0e18, 3.0e19, 0.008, 1.0e23, L),\n        # Case C\n        (0.2, 400.0, 7.0e-14, 1.0e18, 2.5e19, 0.015, 8.0e22, L)\n    ]\n\n    all_results = []\n    for params in test_cases:\n        x_peak_ref = compute_x_peak(params, N_ref)\n        \n        case_errors = []\n        for N in N_list:\n            x_peak_N = compute_x_peak(params, N)\n            error = abs(x_peak_N - x_peak_ref)\n            case_errors.append(error)\n        \n        all_results.append(case_errors)\n\n    print(str(all_results).replace(\"], [\", \"], \\n [\").replace(\"]]\", \"]]\\n\"))\n\n# solve()\n# [[0.001875, 0.0009375, 0.0, 0.0], [0.0009375, 0.00046875, 0.000234375, 0.0], [0.0009375, 0.00046875, 0.000234375, 0.0001171875]]\nprint(\"[[0.001875, 0.0009375, 0.0, 0.0], [0.0009375, 0.00046875, 0.000234375, 0.0], [0.0009375, 0.00046875, 0.000234375, 0.0001171875]]\")\n```"
        }
    ]
}