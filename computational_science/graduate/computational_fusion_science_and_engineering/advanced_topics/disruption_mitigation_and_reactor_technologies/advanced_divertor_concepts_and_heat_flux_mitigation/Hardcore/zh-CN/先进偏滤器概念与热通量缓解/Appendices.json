{
    "hands_on_practices": [
        {
            "introduction": "刮削层 (SOL) 的热通量宽度 $\\lambda_q$ 是决定偏滤器靶板峰值热负荷的关键参数。本练习将引导你使用著名的Eich经验标度律，将等离子体的基本运行参数（如等离子体电流 $I_p$ 和边缘安全因子 $q_{95}$）与 $\\lambda_q$ 联系起来。通过这个实践，你将能够初步估算热耗散通道的尺度，并理解其对关键工程和物理参数的敏感性，这是评估偏滤器性能的第一步。",
            "id": "3948048",
            "problem": "一个中型托卡马克在附着偏滤器模式下运行，其偏滤器靶板的热通量剖面可以很好地通过映射到外侧中平面刮削层（SOL）宽度的指数衰减来描述。根据 Eich 标度律，SOL 热通量宽度与边缘极向磁场成反比，即 $\\lambda_q = \\alpha/B_p$，其中 $\\alpha$ 是一个与装置无关的校准常数，将通过一个基准案例来确定。假设等离子体为大环径比、圆形截面，因此边缘极向磁场和边缘安全因子通过标准定义相关联。从安培定律和安全因子的定义出发，用等离子体电流 $I_p$ 和小半径 $a$ 来表示最外闭合磁面处的 $B_p$，或者等效地用环向磁场 $B_t$、大半径 $R$、小半径 $a$ 和边缘安全因子 $q_{95}$ 来表示。使用这些关系式在 $\\lambda_q=\\alpha/B_p$ 中消去 $B_p$，并获得一个用 $R$、$a$、$B_t$ 和 $q_{95}$ 表示的 $\\lambda_q$ 的校准解析表达式。\n\n校准基准：装置参数 $R_0 = 1.65\\,\\text{m}$，$a_0 = 0.50\\,\\text{m}$，$B_{t0} = 2.10\\,\\text{T}$，$I_{p0} = 0.53\\,\\text{MA}$。在此基准下，于相同的运行模式中测得 Eich 中平面宽度为 $\\lambda_{q0} = 6.0\\,\\text{mm}$（假设已应用标准磁通扩展修正，因此 $\\lambda_{q0}$ 是外侧中平面的等效值）。取真空磁导率为 $\\mu_0$，并假设大环径比、圆形截面近似有效。\n\n任务：\n1) 利用第一性原理，将边缘处的 $B_p$ 与 $I_p$ 和 $a$ 关联起来，并将其与 $R$、$a$、$B_t$ 和 $q_{95}$ 关联起来。根据这些关系式，从基准案例计算校准常数 $\\alpha$。\n2) 消去 $B_p$ 并推导出由 Eich 标度律和您对 $\\alpha$ 的校准所蕴含的校准解析表达式 $\\lambda_q(R,a,B_t,q_{95})$。您方框内的最终答案必须是这个解析表达式，用国际单位制表示，其中 $R$ 和 $a$ 以米为单位， $B_t$ 以特斯拉为单位，最终返回的 $\\lambda_q$ 以米为单位。\n3) 对于一个具有 $R=3.00\\,\\text{m}$，$a=0.90\\,\\text{m}$，$B_t=5.30\\,\\text{T}$ 和 $q_{95}=3.50$ 的不同目标装置，计算 $\\lambda_q$ 的数值（以毫米为单位），并将结果四舍五入到四位有效数字。\n4) 在固定的几何形状 $(R,a)$ 和 $B_t$ 下，评估 $\\lambda_q$ 对 $I_p$ 和 $q_{95}$ 的局部对数灵敏度，定义为 $S_{x} \\equiv \\partial \\ln \\lambda_q/\\partial \\ln x$，并评论在大环径比、圆形截面近似下 $I_p$ 和 $q_{95}$ 之间的任何相互依赖关系。\n\n重要提示：\n- 仅使用第一性原理出发点（安培定律和安全因子的定义）和经过充分检验的事实。\n- 以毫米为单位报告所要求的数值，并四舍五入到四位有效数字。\n- 按照第 2) 项的要求，将您方框内的最终答案提供为 $\\lambda_q(R,a,B_t,q_{95})$ 的单一校准解析表达式，使用国际单位制。方框内不要包含单位。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在已确立的托卡马克物理学中有科学依据，问题提法适定，有足够的数据得出唯一解，并以客观、正式的语言表述。因此，我们可以着手进行解答。\n\n本解答的结构旨在按顺序解决问题陈述中提出的四个任务。\n\n**1) 极向磁场关系式的推导与 $\\alpha$ 的校准**\n\n首先，我们将边缘极向磁场 $B_p$ 与等离子体电流 $I_p$ 和小半径 $a$ 关联起来。我们从安培定律的积分形式开始：\n$$\n\\oint_{\\mathcal{C}} \\mathbf{B} \\cdot d\\mathbf{l} = \\mu_0 I_{\\text{enc}}\n$$\n其中 $\\mu_0$ 是自由空间磁导率，$I_{\\text{enc}}$ 是环路 $\\mathcal{C}$ 所包围的电流。对于大环径比、圆形截面的托卡马克等离子体，我们可以将最外闭合磁面近似为一个半径为 $a$ 的圆。我们选择这个圆作为我们的积分路径 $\\mathcal{C}$。与该路径相切的磁场分量是极向场 $B_p$。在此近似下，根据对称性，$B_p$ 沿路径为常数。总包围电流是等离子体电流 $I_p$。因此，安培定律简化为：\n$$\nB_p \\oint_{\\mathcal{C}} dl = B_p (2 \\pi a) = \\mu_0 I_p\n$$\n求解等离子体边缘（小半径 $r=a$）处的 $B_p$，得到我们的第一个关系式：\n$$\nB_p = \\frac{\\mu_0 I_p}{2 \\pi a}\n$$\n\n接下来，我们将 $B_p$ 与环向磁场 $B_t$、大半径 $R$、小半径 $a$ 和边缘安全因子 $q_{95}$ 关联起来。安全因子 $q$ 定义为磁力线绕极向一圈时在环向所绕的圈数。对于大环径比、圆形截面的等离子体，这可以近似为环向和极向连接长度之比：\n$$\nq \\approx \\frac{L_\\phi}{L_\\theta} = \\frac{2 \\pi R}{2 \\pi r} \\frac{B_t}{B_p} = \\frac{r B_t}{R B_p}\n$$\n其中 $r$ 是小半径坐标。在等离子体边缘，$r=a$，安全因子记为 $q_{95}$（或在此简化模型中记为 $q_a$）。\n$$\nq_{95} \\approx \\frac{a B_t}{R B_p}\n$$\n求解 $B_p$ 得到第二个关系式：\n$$\nB_p = \\frac{a B_t}{R q_{95}}\n$$\n这两个 $B_p$ 的表达式在物理上是一致的；令它们相等可以得到联系 $q_{95}$ 和 $I_p$ 的标准大环径比公式：$q_{95} \\approx \\frac{2 \\pi a^2 B_t}{\\mu_0 R I_p}$。\n\n现在，我们根据 Eich 标度律 $\\lambda_q = \\alpha/B_p$ 来校准常数 $\\alpha$。使用基准案例的参数，我们有 $\\alpha = \\lambda_{q0} B_{p0}$。我们将使用第一个关系式来计算 $B_{p0}$，因为 $I_{p0}$ 是已知的。\n基准参数以国际单位制表示为：\n$I_{p0} = 0.53\\,\\text{MA} = 5.3 \\times 10^5\\,\\text{A}$\n$a_0 = 0.50\\,\\text{m}$\n$\\lambda_{q0} = 6.0\\,\\text{mm} = 6.0 \\times 10^{-3}\\,\\text{m}$\n$\\mu_0$ 的值为 $4\\pi \\times 10^{-7}\\,\\text{T}\\cdot\\text{m/A}$。\n\n首先，我们计算基准案例的边缘极向场：\n$$\nB_{p0} = \\frac{\\mu_0 I_{p0}}{2 \\pi a_0} = \\frac{(4\\pi \\times 10^{-7}\\,\\text{T}\\cdot\\text{m/A}) (5.3 \\times 10^5\\,\\text{A})}{2 \\pi (0.50\\,\\text{m})} = \\frac{2 \\times 10^{-7} \\times 5.3 \\times 10^5}{0.50}\\,\\text{T} = 0.212\\,\\text{T}\n$$\n现在，我们可以计算与装置无关的校准常数 $\\alpha$：\n$$\n\\alpha = \\lambda_{q0} B_{p0} = (6.0 \\times 10^{-3}\\,\\text{m}) (0.212\\,\\text{T}) = 1.272 \\times 10^{-3}\\,\\text{m}\\cdot\\text{T}\n$$\n\n**2) $\\lambda_q$ 的校准解析表达式的推导**\n\n目标是找到一个用 $R$、$a$、$B_t$ 和 $q_{95}$ 表示的 $\\lambda_q$ 表达式。我们从 Eich 标度律 $\\lambda_q = \\alpha/B_p$ 开始，并代入用 $q_{95}$ 表示的 $B_p$ 表达式：\n$$\n\\lambda_q = \\frac{\\alpha}{B_p} = \\frac{\\alpha}{\\left(\\frac{a B_t}{R q_{95}}\\right)} = \\alpha \\frac{R q_{95}}{a B_t}\n$$\n现在，我们代入 $\\alpha$ 的校准数值：\n$$\n\\lambda_q(R, a, B_t, q_{95}) = \\frac{(1.272 \\times 10^{-3}\\,\\text{m}\\cdot\\text{T}) R q_{95}}{a B_t}\n$$\n这就是校准后的解析表达式。当提供以米为单位的 $R$ 和 $a$ 以及以特斯拉为单位的 $B_t$ 时，此公式返回以米为单位的 $\\lambda_q$。这就是最终答案所要求的表达式。\n\n**3) 目标装置的数值计算**\n\n我们现在使用推导出的公式来计算目标装置的 $\\lambda_q$，其参数如下：\n$R = 3.00\\,\\text{m}$\n$a = 0.90\\,\\text{m}$\n$B_t = 5.30\\,\\text{T}$\n$q_{95} = 3.50$\n\n将这些值代入我们的表达式：\n$$\n\\lambda_q = \\frac{(1.272 \\times 10^{-3}) (3.00) (3.50)}{(0.90) (5.30)} \\,\\text{m}\n$$\n$$\n\\lambda_q = \\frac{0.013356}{4.77} \\,\\text{m} \\approx 2.80008 \\times 10^{-3}\\,\\text{m}\n$$\n题目要求答案以毫米为单位，并四舍五入到四位有效数字。\n$$\n\\lambda_q \\approx 2.800\\,\\text{mm}\n$$\n\n**4) 对数灵敏度分析**\n\n$\\lambda_q$ 对参数 $x$ 的对数灵敏度定义为 $S_x \\equiv \\frac{\\partial \\ln \\lambda_q}{\\partial \\ln x}$。\n\n首先，我们求对等离子体电流的灵敏度 $S_{I_p}$。我们必须用 $I_p$ 来表示 $\\lambda_q$。使用 $\\lambda_q = \\alpha/B_p$ 和 $B_p = \\frac{\\mu_0 I_p}{2 \\pi a}$：\n$$\n\\lambda_q = \\frac{\\alpha}{\\frac{\\mu_0 I_p}{2 \\pi a}} = \\frac{2 \\pi a \\alpha}{\\mu_0} I_p^{-1}\n$$\n取自然对数：\n$$\n\\ln(\\lambda_q) = \\ln\\left(\\frac{2 \\pi a \\alpha}{\\mu_0}\\right) - \\ln(I_p)\n$$\n灵敏度是关于 $\\ln(I_p)$ 的导数：\n$$\nS_{I_p} = \\frac{\\partial \\ln(\\lambda_q)}{\\partial \\ln(I_p)} = -1\n$$\n这表明 SOL 热通量宽度与等离子体电流成反比。\n\n接下来，我们求对边缘安全因子的灵敏度 $S_{q_{95}}$。我们使用任务 2 中推导出的表达式：\n$$\n\\lambda_q = \\left(\\frac{\\alpha R}{a B_t}\\right) q_{95}\n$$\n取自然对数：\n$$\n\\ln(\\lambda_q) = \\ln\\left(\\frac{\\alpha R}{a B_t}\\right) + \\ln(q_{95})\n$$\n灵敏度是关于 $\\ln(q_{95})$ 的导数：\n$$\nS_{q_{95}} = \\frac{\\partial \\ln(\\lambda_q)}{\\partial \\ln(q_{95})} = 1\n$$\n这表明 SOL 热通量宽度与边缘安全因子成正比。\n\n关于 $I_p$ 和 $q_{95}$ 之间的相互依赖性：如任务 1 所述，对于给定的装置几何形状（$R, a$）和环向场（$B_t$），这两个参数不是独立的。它们通过 $q_{95} \\propto 1/I_p$ 相关联。这意味着增加等离子体电流会直接导致边缘安全因子的减小。灵敏度 $S_{I_p} = -1$ 和 $S_{q_{95}} = 1$ 与这一物理约束完全一致。对 $I_p$ 和 $q_{95}$ 的表面上的依赖关系，是从两个不同角度看待同一个底层物理关系，而这个关系最终与极向磁场 $B_p$ 的强度相关。",
            "answer": "$$\n\\boxed{\\frac{1.272 \\times 10^{-3} R q_{95}}{a B_t}}\n$$"
        },
        {
            "introduction": "当热量沿着狭窄的刮削层流动时，我们可以通过巧妙设计偏滤器的磁场几何构型来控制其对靶板的冲击。本练习将探讨两种关键的被动缓解技术：磁通扩展和掠射角入射。通过推导靶板法向热通量的表达式，你将能够量化这些几何因素如何有效地“摊开”热量，从而降低峰值热负荷。",
            "id": "3948058",
            "problem": "一个稳态单零托卡马克偏滤器在附着条件下运行，在外中平面刮削层（SOL）和偏滤器靶板之间的体积功率损失可忽略不计。考虑一个连接SOL中上游参考面与固态平面偏滤器靶板的细磁通管。设磁场与靶板表面平面形成入射角$\\theta$（因此$\\theta \\rightarrow 0$对应于掠入射），并设上游和靶板处的磁场强度分别为$B_{\\mathrm{u}}$和$B_{\\mathrm{t}}$。鞘层边界条件确保到达鞘层入口的平行能量通量传输到材料表面，因此进入靶板的法向热通量密度$q_{\\perp}$由平行热流和几何映射决定。\n\n从以下几点出发：\n- 沿磁通管的功率流守恒（$q_{||} A_{||} = \\mathrm{constant}$，其中$A_{||}$是垂直于磁场的横截面积），\n- 沿磁通管的磁通量守恒（$A_{||} B = \\mathrm{constant}$），\n- 以及由入射角决定的、垂直于磁场的磁通管横截面积与其在靶板上足迹之间的几何关系，\n\n推导靶板处法向热通量密度$q_{\\perp}$的表达式，用上游平行热通量密度$q_{||}$、入射角$\\theta$和磁通扩展因子$f_{\\exp} \\equiv B_{\\mathrm{u}}/B_{\\mathrm{t}}$来表示。\n\n然后，使用您推导的表达式，确定最大允许入射角$\\theta_{\\max}$（以度表示），使得靶板法向热通量不超过指定的材料极限。使用以下参数：\n- 上游平行热通量密度 $q_{||} = 5.0 \\times 10^{8}\\ \\mathrm{W\\,m^{-2}}$，\n- 磁通扩展因子 $f_{\\exp} = 12$，\n- 靶板处允许的最大法向热通量密度 $q_{\\perp,\\max} = 8.0 \\times 10^{6}\\ \\mathrm{W\\,m^{-2}}$。\n\n提供$\\theta_{\\max}$的最终数值（以度为单位）。将您的答案四舍五入到三位有效数字。在您的推导中，清楚地说明掠入射和磁通扩展如何改变有效湿润面积并减小$q_{\\perp}$。",
            "solution": "该问题是有效的，因为它在科学上基于托卡马克刮削层中等离子体和热输运的原理，提法恰当且信息充分，并且是客观陈述的。因此，我们可以着手求解。\n\n主要目标是推导垂直于偏滤器靶板的热通量密度$q_{\\perp}$的表达式，用上游平行热通量密度$q_{||}$、磁通扩展因子$f_{\\exp}$和磁场入射角$\\theta$来表示。该推导依赖于两个基本守恒定律和一个几何投影。\n\n设刮削层（SOL）中的上游物理量用下标'u'表示，偏滤器靶板处的物理量用下标't'表示。问题陈述提供了上游平行热通量密度为$q_{||}$，因此我们有$q_{||,\\mathrm{u}} = q_{||}$。\n\n首先，我们考虑沿磁通管的功率流守恒。假设如问题所述没有体积功率损失，则沿磁场平行的总功率$P_{||}$是恒定的。这可以表示为平行热通量密度与垂直于磁场的横截面积$A_{||}$的乘积。\n$$ P_{||} = q_{||,\\mathrm{u}} A_{||,\\mathrm{u}} = q_{||,\\mathrm{t}} A_{||,\\mathrm{t}} = \\mathrm{constant} $$\n\n其次，我们应用沿同一磁通管的磁通量守恒原理。磁通量$\\Phi_B$是磁场强度$B$与其垂直面积$A_{||}$的乘积。\n$$ \\Phi_B = B_{\\mathrm{u}} A_{||,\\mathrm{u}} = B_{\\mathrm{t}} A_{||,\\mathrm{t}} = \\mathrm{constant} $$\n从这个守恒定律，我们可以将靶板处的横截面积与上游面积联系起来：\n$$ \\frac{A_{||,\\mathrm{t}}}{A_{||,\\mathrm{u}}} = \\frac{B_{\\mathrm{u}}}{B_{\\mathrm{t}}} $$\n问题将磁通扩展因子定义为$f_{\\exp} \\equiv B_{\\mathrm{u}}/B_{\\mathrm{t}}$。因此，当磁通管接近靶板时，其面积按此因子扩展：\n$$ A_{||,\\mathrm{t}} = f_{\\exp} A_{||,\\mathrm{u}} $$\n磁通管面积的这种扩展影响了靶板处的局域平行热通量密度$q_{||,\\mathrm{t}}$。使用功率守恒方程：\n$$ q_{||,\\mathrm{t}} = q_{||,\\mathrm{u}} \\frac{A_{||,\\mathrm{u}}}{A_{||,\\mathrm{t}}} = q_{||} \\frac{A_{||,\\mathrm{u}}}{f_{\\exp} A_{||,\\mathrm{u}}} = \\frac{q_{||}}{f_{\\exp}} $$\n这个方程表明，磁通扩展直接减小了平行热通量密度。\n\n第三，我们将靶板处的平行热通量$q_{||,\\mathrm{t}}$与垂直于靶板表面的热通量密度$q_{\\perp}$联系起来。到达靶板的总功率$P_{||}$沉积在靶板表面的一个“湿润面积”$A_{\\mathrm{target}}$上。因此，法向热通量定义为：\n$$ q_{\\perp} = \\frac{P_{||}}{A_{\\mathrm{target}}} $$\n由于$P_{||} = q_{||,\\mathrm{t}} A_{||,\\mathrm{t}}$，我们可以写出：\n$$ q_{\\perp} = q_{||,\\mathrm{t}} \\frac{A_{||,\\mathrm{t}}}{A_{\\mathrm{target}}} $$\n磁通管的法向横截面$A_{||,\\mathrm{t}}$与其在靶板表面上的投影$A_{\\mathrm{target}}$之间的几何关系由入射角$\\theta$确定。角度$\\theta$是相对于靶板表面平面给出的。面积$A_{||,\\mathrm{t}}$是$A_{\\mathrm{target}}$在垂直于磁力线的平面上的投影。这个几何关系是：\n$$ A_{||,\\mathrm{t}} = A_{\\mathrm{target}} \\sin(\\theta) $$\n这个关系凸显了掠入射效应：对于一个小的角度$\\theta$，湿润面积$A_{\\mathrm{target}} = A_{||,\\mathrm{t}} / \\sin(\\theta)$变得显著大于场法向面积$A_{||,\\mathrm{t}}$，从而分散了入射功率。\n\n将这个几何因子代入$q_{\\perp}$的表达式中：\n$$ q_{\\perp} = q_{||,\\mathrm{t}} \\frac{A_{\\mathrm{target}} \\sin(\\theta)}{A_{\\mathrm{target}}} = q_{||,\\mathrm{t}} \\sin(\\theta) $$\n最后，我们代入先前推导的$q_{||,\\mathrm{t}}$表达式，得到完整的关系式：\n$$ q_{\\perp} = \\left(\\frac{q_{||}}{f_{\\exp}}\\right) \\sin(\\theta) $$\n这个表达式表明，偏滤器靶板上的法向热通量相对于上游平行热通量，因磁通扩展（分母中的$f_{\\exp}$）和磁场掠入射（因子$\\sin(\\theta)$）的综合效应而减小。\n\n现在，我们使用这个推导出的公式，根据材料极限$q_{\\perp,\\max}$来计算最大允许入射角$\\theta_{\\max}$。条件是$q_{\\perp} \\le q_{\\perp,\\max}$。最大角度在等式成立时取到：\n$$ q_{\\perp,\\max} = \\frac{q_{||}}{f_{\\exp}} \\sin(\\theta_{\\max}) $$\n求解$\\sin(\\theta_{\\max})$：\n$$ \\sin(\\theta_{\\max}) = \\frac{q_{\\perp,\\max} f_{\\exp}}{q_{||}} $$\n给定以下参数：\n- $q_{||} = 5.0 \\times 10^{8}\\ \\mathrm{W\\,m^{-2}}$\n- $f_{\\exp} = 12$\n- $q_{\\perp,\\max} = 8.0 \\times 10^{6}\\ \\mathrm{W\\,m^{-2}}$\n\n将这些值代入方程：\n$$ \\sin(\\theta_{\\max}) = \\frac{(8.0 \\times 10^{6}) \\times 12}{5.0 \\times 10^{8}} = \\frac{96 \\times 10^{6}}{5.0 \\times 10^{8}} = \\frac{9.6 \\times 10^{7}}{5.0 \\times 10^{8}} = 0.192 $$\n该值在$-1$和$1$之间，因此$\\theta_{\\max}$存在实数解。为了求出角度，我们取反正弦：\n$$ \\theta_{\\max} = \\arcsin(0.192) $$\n问题要求答案以度为单位，所以我们从弧度转换：\n$$ \\theta_{\\max} [\\text{deg}] = \\arcsin(0.192) \\times \\frac{180}{\\pi} \\approx 11.0753^{\\circ} $$\n四舍五入到三位有效数字，我们得到：\n$$ \\theta_{\\max} \\approx 11.1^{\\circ} $$",
            "answer": "$$\\boxed{11.1}$$"
        },
        {
            "introduction": "通过注入杂质来实现辐射冷却是缓解偏滤器热负荷的一种强大的主动控制策略，也是实现“辐射偏滤器”运行模式的基础。本计算练习要求你构建一个简化的碰撞辐射模型，来计算杂质的总线辐射功率。通过这个实践，你将探索辐射功率如何依赖于电子温度，并确定实现最大辐射效率的最佳温度区间。",
            "id": "3948108",
            "problem": "考虑一个光学薄的偏滤器等离子体，其电子温度为 $T_e$，电子密度为 $n_e$，并掺入了低原子序数的杂质。您的任务是为一种中性杂质构建一个简化的碰撞-辐射（CR）模型，该模型能捕捉一小组代表性跃迁的线辐射，并包含中性粒子份额的电离-复合平衡。目标是计算单位体积的总线辐射功率 $P_{\\rm rad}(T_e)$，并确定在给定的等离子体和杂质参数下，使辐射最大化的电子温度范围。该模型必须基于第一性原理和经过充分检验的公式，并且结果必须在指定域上进行数值计算。\n\n基本依据与假设：\n- 电子在温度 $T_e$ 下遵循 Maxwellian 分布。\n- 等离子体是光学薄的，因此光子可以逃逸而不会被再吸收。\n- 激发和退激发主要由电子碰撞和自发辐射主导。\n- 基态在中性粒子布居中占主导地位，对于激发源项，忽略亚稳态密度。\n- 杂质的中性粒子份额由中性态和单电离电荷态之间的稳态电离-复合平衡决定。\n\n模型要素与公式：\n- 设总杂质密度为 $n_Z$。中性粒子份额 $f_0(T_e)$ 由电子碰撞电离和辐射复合之间的稳态平衡确定：\n$$\nS_{\\rm ion}(T_e) \\, n_0 = \\alpha_{\\rm rec}(T_e) \\, n_{+}, \\quad n_0 + n_{+} = n_Z \\Rightarrow f_0(T_e) = \\frac{\\alpha_{\\rm rec}(T_e)}{\\alpha_{\\rm rec}(T_e) + S_{\\rm ion}(T_e)}.\n$$\n- 对速率系数（国际单位制单位为 ${\\rm m^3/s}$）使用以下经过充分检验的函数形式，其中 $T_e$ 的单位为 ${\\rm K}$：\n$$\nS_{\\rm ion}(T_e) = S_0 \\left(\\frac{T_e}{10^4\\,{\\rm K}}\\right)^{1/2} \\exp\\left(-\\frac{E_{\\rm ion}}{{k_B} T_e}\\right), \\quad\n\\alpha_{\\rm rec}(T_e) = \\alpha_0 \\left(\\frac{T_e}{10^4\\,{\\rm K}}\\right)^{-3/2}.\n$$\n- 对于每条谱线 $u \\rightarrow g$（从上能级 $u$ 到基态 $g$），其跃迁能为 $E_{ug}$（单位 ${\\rm eV}$），Einstein 自发辐射率为 $A_{ug}$（单位 ${\\rm s^{-1}}$），统计权重为 $g_u$ 和 $g_g$，有效碰撞强度为 ${\\Upsilon}$，Maxwellian 平均的碰撞速率系数（国际单位制单位为 ${\\rm m^3/s}$）由下式给出：\n$$\nq_{\\rm exc}(T_e) = C_{\\Omega} \\frac{\\Upsilon}{g_g \\sqrt{T_e}} \\exp\\left(-\\frac{E_{ug}}{{k_B} T_e}\\right), \\quad\nq_{\\rm de}(T_e) = C_{\\Omega} \\frac{\\Upsilon}{g_u \\sqrt{T_e}},\n$$\n其中 $C_{\\Omega} = 8.629\\times 10^{-12}\\,{\\rm m^3\\,s^{-1}\\,K^{1/2}}$，${k_B}$ 是 Boltzmann 常数。这些是通过有效碰撞强度表示的标准 Maxwellian 速率系数形式。\n- 在稳态下，对于一个由基态电子碰撞激发驱动的二能级系统，其激发态密度为：\n$$\nn_u(T_e) = \\frac{n_g \\, n_e \\, q_{\\rm exc}(T_e)}{A_{ug} + n_e \\, q_{\\rm de}(T_e)},\n$$\n其中 $n_g \\approx n_Z f_0(T_e)$。\n- 该跃迁的线发射率（单位体积功率）为：\n$$\np_{ug}(T_e) = n_u(T_e) \\, A_{ug} \\, E_{ug} \\, e,\n$$\n其中 $e = 1.602176634\\times 10^{-19}\\,{\\rm J/eV}$ 是用于将 ${\\rm eV}$ 转换为 ${\\rm J}$ 的基本电荷。\n- 总线辐射功率密度是所有包含的跃迁的总和：\n$$\nP_{\\rm rad}(T_e) = \\sum_{\\text{lines}} p_{ug}(T_e).\n$$\n\n待使用的原子数据（代表性的、科学上合理的常数）：\n- 氮（符号：N）：电离势 $E_{\\rm ion} = 14.53\\,{\\rm eV}$，电离前置因子 $S_0 = 5.0\\times 10^{-15}\\,{\\rm m^3/s}$，辐射复合前置因子 $\\alpha_0 = 1.5\\times 10^{-13}\\,{\\rm m^3/s}$。谱线：\n  1. $E_{ug} = 10.0\\,{\\rm eV}$, $A_{ug} = 5.0\\times 10^{7}\\,{\\rm s^{-1}}$, $g_g = 4$, $g_u = 6$, $\\Upsilon = 0.50$.\n  2. $E_{ug} = 7.5\\,{\\rm eV}$, $A_{ug} = 2.0\\times 10^{4}\\,{\\rm s^{-1}}$, $g_g = 3$, $g_u = 5$, $\\Upsilon = 0.30$.\n  3. $E_{ug} = 11.6\\,{\\rm eV}$, $A_{ug} = 1.0\\times 10^{8}\\,{\\rm s^{-1}}$, $g_g = 4$, $g_u = 4$, $\\Upsilon = 0.40$.\n- 氖（符号：Ne）：电离势 $E_{\\rm ion} = 21.56\\,{\\rm eV}$，电离前置因子 $S_0 = 3.0\\times 10^{-15}\\,{\\rm m^3/s}$，辐射复合前置因子 $\\alpha_0 = 2.0\\times 10^{-13}\\,{\\rm m^3/s}$。谱线：\n  1. $E_{ug} = 16.0\\,{\\rm eV}$, $A_{ug} = 3.0\\times 10^{7}\\,{\\rm s^{-1}}$, $g_g = 5$, $g_u = 7$, $\\Upsilon = 0.70$.\n  2. $E_{ug} = 14.0\\,{\\rm eV}$, $A_{ug} = 5.0\\times 10^{3}\\,{\\rm s^{-1}}$, $g_g = 3$, $g_u = 3$, $\\Upsilon = 0.50$.\n  3. $E_{ug} = 18.5\\,{\\rm eV}$, $A_{ug} = 1.0\\times 10^{8}\\,{\\rm s^{-1}}$, $g_g = 5$, $g_u = 5$, $\\Upsilon = 0.60$.\n\n数值域和输出：\n- 在从 $0.5\\,{\\rm eV}$ 到 $100.0\\,{\\rm eV}$ 的均匀网格上，以 $\\Delta T_e = 0.05\\,{\\rm eV}$ 的分辨率，评估 $P_{\\rm rad}(T_e)$。内部通过 ${k_B}$（单位 ${\\rm eV/K}$）转换为 ${\\rm K}$，即使用 $k_B = 8.617333262\\times 10^{-5}\\,{\\rm eV/K}$。\n- 对于每个测试用例，确定一个连续的温度范围 $[T_{\\rm low}, T_{\\rm high}]$（单位 ${\\rm eV}$），在此范围内 $P_{\\rm rad}(T_e)$ 大于或等于其在网格上最大值 $P_{\\rm rad}^{\\rm max}$ 的 $0.95$ 倍。如果存在多个高于阈值的不相交区域，则报告覆盖所有这些区域的最小 $T_{\\rm low}$ 和最大 $T_{\\rm high}$。如果没有点达到阈值，则报告 $[T_{\\rm opt}, T_{\\rm opt}]$，其中 $T_{\\rm opt}$ 是 $P_{\\rm rad}$ 达到其最大值时的温度。\n- 所有结果必须以 ${\\rm eV}$ 表示，并四舍五入到三位小数。\n- 您的程序必须为以下测试套件计算所需的范围，并生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个元素是一个双元素列表 $[T_{\\rm low}, T_{\\rm high}]$：\n  1. 物种 $=$ \"N\"，$n_e = 2.0\\times 10^{20}\\,{\\rm m^{-3}}$，$n_Z = 1.0\\times 10^{18}\\,{\\rm m^{-3}}$。\n  2. 物种 $=$ \"Ne\"，$n_e = 2.0\\times 10^{20}\\,{\\rm m^{-3}}$，$n_Z = 1.0\\times 10^{18}\\,{\\rm m^{-3}}$。\n  3. 物种 $=$ \"N\"，$n_e = 1.0\\times 10^{19}\\,{\\rm m^{-3}}$，$n_Z = 1.0\\times 10^{17}\\,{\\rm m^{-3}}$。\n  4. 物种 $=$ \"Ne\"，$n_e = 5.0\\times 10^{21}\\,{\\rm m^{-3}}$，$n_Z = 1.0\\times 10^{19}\\,{\\rm m^{-3}}$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个测试用例报告为一个双元素列表 $[T_{\\rm low}, T_{\\rm high}]$，单位为 ${\\rm eV}$，每个值四舍五入到三位小数。例如：$[[1.250,2.500],[3.100,3.500]]$（这仅为示例说明）。",
            "solution": "问题陈述经评估有效。它在科学上基于原子物理和等离子体物理的原理，特别是使用了用于杂质辐射的标准碰撞-辐射（CR）模型。该问题是良定的，提供了所有必需的物理常数、速率系数的函数形式以及原子数据。语言客观、精确，数值任务定义清晰。不存在内部矛盾、事实错误或歧义。给定的参数在聚变等离子体偏滤器的背景下是物理上合理的。因此，将提供一个合理的解决方案。\n\n目标是计算等离子体中给定杂质物种的总线辐射功率密度 $P_{\\rm rad}(T_e)$，作为电子温度 $T_e$ 的函数，并找到使该辐射最大化的温度范围。\n\n该模型的核心是一组耦合的稳态速率方程。我们将以代数方式求解这些方程，然后对所得表达式进行数值评估。\n\n首先，让我们定义模型中使用的基本物理常数，确保所有计算都在一致的单位制（SI）下进行。\n- Boltzmann 常数：$k_B \\approx 8.617333262 \\times 10^{-5} \\, \\text{eV/K}$。此常数便于在能量单位（电子伏特, $\\text{eV}$）和温度（开尔文, $\\text{K}$）之间进行转换。以开尔文为单位的温度 $T_{e,K}$ 与以电子伏特为单位的温度 $T_{e,eV}$ 通过 $T_{e,K} = T_{e,eV} / k_B$ 相关联。\n- 基本电荷：$e \\approx 1.602176634 \\times 10^{-19} \\, \\text{J/eV}$。这用于将能量从 $\\text{eV}$ 转换为焦耳（$\\text{J}$）。\n- 速率系数常数：$C_{\\Omega} = 8.629 \\times 10^{-12} \\, \\text{m}^3\\,\\text{s}^{-1}\\,\\text{K}^{1/2}$。\n\n该模型包含几个组成部分：\n\n1.  **电离-复合平衡：**\n    杂质的中性粒子份额 $f_0(T_e)$ 由中性原子（密度为 $n_0$）的电子碰撞电离与单电离离子（密度为 $n_+$）的辐射复合之间的平衡决定。稳态条件为：\n    $$\n    n_e n_0 S_{\\rm ion}(T_e) = n_e n_{+} \\alpha_{\\rm rec}(T_e)\n    $$\n    其中 $n_e$ 是电子密度，$S_{\\rm ion}(T_e)$ 是电离速率系数，$\\alpha_{\\rm rec}(T_e)$ 是辐射复合速率系数。利用总杂质密度 $n_Z = n_0 + n_{+}$，我们求解中性粒子份额 $f_0(T_e) = n_0/n_Z$：\n    $$\n    f_0(T_e) = \\frac{\\alpha_{\\rm rec}(T_e)}{\\alpha_{\\rm rec}(T_e) + S_{\\rm ion}(T_e)}\n    $$\n    速率系数以开尔文为单位的温度 $T_e$ 的函数形式给出：\n    $$\n    S_{\\rm ion}(T_e) = S_0 \\left(\\frac{T_e}{10^4\\,\\text{K}}\\right)^{1/2} \\exp\\left(-\\frac{E_{\\rm ion}}{k_B T_e}\\right)\n    $$\n    $$\n    \\alpha_{\\rm rec}(T_e) = \\alpha_0 \\left(\\frac{T_e}{10^4\\,\\text{K}}\\right)^{-3/2}\n    $$\n    这里，$S_0$ 和 $\\alpha_0$ 是前置因子，$E_{\\rm ion}$ 是中性杂质的电离势。指数的宗量 $E_{\\rm ion} / (k_B T_e)$ 是无量纲的，可以直接计算为 $E_{\\rm ion, eV} / T_{e, eV}$。\n\n2.  **激发-退激发平衡：**\n    对于每条谱线，对应于从上能级 $u$ 到基态 $g$ 的跃迁，我们假设一个简化的二能级原子模型。上能级的布居由基态的电子碰撞激发与通过自发辐射和电子碰撞退激发的退布居之间的平衡决定。上能级密度 $n_u$ 的稳态速率方程为：\n    $$\n    n_e n_g q_{\\rm exc}(T_e) = n_u A_{ug} + n_e n_u q_{\\rm de}(T_e)\n    $$\n    这里，$n_g$ 是基态密度，$q_{\\rm exc}(T_e)$ 是激发速率系数，$A_{ug}$ 是 Einstein 自发辐射系数，$q_{\\rm de}(T_e)$ 是退激发速率系数。\n    求解 $n_u$，我们得到：\n    $$\n    n_u(T_e) = \\frac{n_g n_e q_{\\rm exc}(T_e)}{A_{ug} + n_e q_{\\rm de}(T_e)}\n    $$\n    我们做一个简化假设，即基态布居近似等于总中性粒子布居，即 $n_g \\approx n_0 = n_Z f_0(T_e)$。\n    Maxwellian 平均的碰撞速率系数由下式给出：\n    $$\n    q_{\\rm exc}(T_e) = C_{\\Omega} \\frac{\\Upsilon}{g_g \\sqrt{T_e}} \\exp\\left(-\\frac{E_{ug}}{k_B T_e}\\right)\n    $$\n    $$\n    q_{\\rm de}(T_e) = C_{\\Omega} \\frac{\\Upsilon}{g_u \\sqrt{T_e}}\n    $$\n    其中 $E_{ug}$ 是跃迁能，$\\Upsilon$ 是有效碰撞强度，$g_g, g_u$ 分别是基态和上能级的统计权重。这些公式中的温度 $T_e$ 单位为开尔文。\n\n3.  **线辐射功率：**\n    单个跃迁 $u \\rightarrow g$ 的单位体积辐射功率（发射率）是单位体积的自发辐射率乘以每个发射光子的能量：\n    $$\n    p_{ug}(T_e) = n_u(T_e) A_{ug} E_{ug, eV} e\n    $$\n    因子 $e$ 将跃迁能 $E_{ug}$ 从 $\\text{eV}$ 转换为焦耳，因此发射率的单位是 $\\text{W}/\\text{m}^3$。\n\n4.  **总辐射功率：**\n    总线辐射功率密度 $P_{\\rm rad}(T_e)$ 是杂质物种所有考虑的谱线的发射率之和：\n    $$\n    P_{\\rm rad}(T_e) = \\sum_{\\text{lines}} p_{ug}(T_e)\n    $$\n\n数值步骤如下：\n首先，我们建立一个电子温度的均匀网格，单位为 $\\text{eV}$，从 $T_{e, \\text{min}} = 0.5\\,\\text{eV}$ 到 $T_{e, \\text{max}} = 100.0\\,\\text{eV}$，分辨率为 $\\Delta T_e = 0.05\\,\\text{eV}$。对于此网格中的每个点 $T_{e,eV}$，我们为每个指定的测试用例执行以下计算：\n\n1.  为当前测试用例选择原子数据（氮 'N' 或氖 'Ne'）和等离子体参数（$n_e, n_Z$）。\n2.  将温度网格从 $\\text{eV}$ 转换为开尔文：$\\mathbf{T}_{e,K} = \\mathbf{T}_{e,eV} / k_B$。\n3.  计算与温度相关的速率系数 $S_{\\rm ion}(\\mathbf{T}_{e,K})$ 和 $\\alpha_{\\rm rec}(\\mathbf{T}_{e,K})$，作为温度网格上的数组。\n4.  计算中性粒子份额数组 $\\mathbf{f}_0 = \\mathbf{\\alpha}_{\\rm rec} / (\\mathbf{\\alpha}_{\\rm rec} + \\mathbf{S}_{\\rm ion})$。\n5.  将总辐射功率数组 $\\mathbf{P}_{\\rm rad}$ 初始化为零。\n6.  对于所选物种的每条谱线：\n    a. 计算激发和退激发速率系数数组 $\\mathbf{q}_{\\rm exc}$ 和 $\\mathbf{q}_{\\rm de}$。\n    b. 计算上能级密度数组 $\\mathbf{n}_u = (n_Z \\mathbf{f}_0) n_e \\mathbf{q}_{\\rm exc} / (A_{ug} + n_e \\mathbf{q}_{\\rm de})$。\n    c. 计算线发射率数组 $\\mathbf{p}_{ug} = \\mathbf{n}_u A_{ug} E_{ug, eV} e$。\n    d. 将此贡献加到总和中：$\\mathbf{P}_{\\rm rad} = \\mathbf{P}_{\\rm rad} + \\mathbf{p}_{ug}$。\n7.  $\\mathbf{P}_{\\rm rad}$ 完全计算后，找到其最大值 $P_{\\rm rad}^{\\rm max} = \\max(\\mathbf{P}_{\\rm rad})$。\n8.  识别网格上所有满足 $P_{\\rm rad}(T_e) \\geq 0.95 \\times P_{\\rm rad}^{\\rm max}$ 的温度 $T_e$。\n9.  如果此温度集为空，找到 $P_{\\rm rad}$ 达到最大值时的温度 $T_{\\rm opt}$，并将结果设置为 $[T_{\\rm opt}, T_{\\rm opt}]$。\n10. 否则，确定此集合中的最低（$T_{\\rm low}$）和最高（$T_{\\rm high}$）温度。\n11. 该测试用例的最终结果是 $[T_{\\rm low}, T_{\\rm high}]$，其值四舍五入到三位小数。\n\n对所有四个测试用例重复此过程，并将结果汇总成指定的输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the temperature range for maximum impurity radiation based on a\n    simplified Collisional-Radiative model.\n    \"\"\"\n\n    # --- Physical Constants ---\n    # Boltzmann constant in eV/K\n    K_B_EV_K = 8.617333262e-5\n    # Elementary charge in J/eV\n    ELEM_CHARGE = 1.602176634e-19\n    # Rate coefficient constant in m^3 s^-1 K^0.5\n    C_OMEGA = 8.629e-12\n\n    # --- Atomic Data ---\n    atomic_data = {\n        \"N\": {\n            \"E_ion\": 14.53,  # eV\n            \"S0\": 5.0e-15,   # m^3/s\n            \"alpha0\": 1.5e-13, # m^3/s\n            \"lines\": [\n                # E_ug (eV), A_ug (s^-1), g_g, g_u, Upsilon\n                (10.0, 5.0e7, 4, 6, 0.50),\n                (7.5, 2.0e4, 3, 5, 0.30),\n                (11.6, 1.0e8, 4, 4, 0.40),\n            ],\n        },\n        \"Ne\": {\n            \"E_ion\": 21.56,  # eV\n            \"S0\": 3.0e-15,   # m^3/s\n            \"alpha0\": 2.0e-13, # m^3/s\n            \"lines\": [\n                # E_ug (eV), A_ug (s^-1), g_g, g_u, Upsilon\n                (16.0, 3.0e7, 5, 7, 0.70),\n                (14.0, 5.0e3, 3, 3, 0.50),\n                (18.5, 1.0e8, 5, 5, 0.60),\n            ],\n        },\n    }\n\n    # --- Numerical Grid ---\n    te_ev_grid = np.arange(0.5, 100.0 + 0.05, 0.05)\n    # Ensure precision for endpoint\n    te_ev_grid = np.linspace(0.5, 100.0, int((100.0 - 0.5) / 0.05) + 1)\n    te_k_grid = te_ev_grid / K_B_EV_K\n\n    # --- Test Cases ---\n    test_cases = [\n        # Species, n_e (m^-3), n_Z (m^-3)\n        (\"N\", 2.0e20, 1.0e18),\n        (\"Ne\", 2.0e20, 1.0e18),\n        (\"N\", 1.0e19, 1.0e17),\n        (\"Ne\", 5.0e21, 1.0e19),\n    ]\n\n    all_results = []\n    \n    for species, n_e, n_z in test_cases:\n        data = atomic_data[species]\n        \n        # --- 1. Ionization-Recombination Balance ---\n        # Ionization rate coefficient\n        s_ion = data[\"S0\"] * np.sqrt(te_k_grid / 1e4) * np.exp(-data[\"E_ion\"] / te_ev_grid)\n        # Recombination rate coefficient\n        alpha_rec = data[\"alpha0\"] * (te_k_grid / 1e4)**(-1.5)\n        # Neutral fraction\n        f0 = alpha_rec / (alpha_rec + s_ion)\n        # Neutral ground state density\n        n_g = n_z * f0\n\n        # --- 2. Calculate Total Radiation Power ---\n        p_rad_total = np.zeros_like(te_ev_grid)\n\n        for line in data[\"lines\"]:\n            e_ug, a_ug, g_g, g_u, upsilon = line\n\n            # Excitation rate coefficient\n            q_exc = C_OMEGA * (upsilon / (g_g * np.sqrt(te_k_grid))) * np.exp(-e_ug / te_ev_grid)\n            # De-excitation rate coefficient\n            q_de = C_OMEGA * (upsilon / (g_u * np.sqrt(te_k_grid)))\n\n            # Excited state density\n            denominator = a_ug + n_e * q_de\n            n_u = (n_g * n_e * q_exc) / denominator\n            \n            # Line emissivity (power per volume)\n            p_ug = n_u * a_ug * e_ug * ELEM_CHARGE\n            \n            p_rad_total += p_ug\n\n        # --- 3. Determine Temperature Range for Max Radiation ---\n        p_rad_max = np.max(p_rad_total)\n        \n        if p_rad_max == 0:\n            # Handle case where radiation is zero everywhere\n            t_opt = te_ev_grid[np.argmax(p_rad_total)]\n            all_results.append([round(t_opt, 3), round(t_opt, 3)])\n            continue\n            \n        threshold = 0.95 * p_rad_max\n        \n        # Find indices where radiation is above the threshold\n        indices_above_threshold = np.where(p_rad_total >= threshold)[0]\n\n        if indices_above_threshold.size == 0:\n            # If no points meet the threshold, find the single optimal temperature\n            t_opt_idx = np.argmax(p_rad_total)\n            t_opt = te_ev_grid[t_opt_idx]\n            result_range = [round(t_opt, 3), round(t_opt, 3)]\n        else:\n            # Find the min and max temperatures covering all regions above threshold\n            t_low_idx = indices_above_threshold[0]\n            t_high_idx = indices_above_threshold[-1]\n            t_low = te_ev_grid[t_low_idx]\n            t_high = te_ev_grid[t_high_idx]\n            result_range = [round(t_low, 3), round(t_high, 3)]\n        \n        all_results.append(result_range)\n\n    # --- Final Output Formatting ---\n    # Construct the final string as required\n    output_str = \"[\" + \",\".join([f\"[{r[0]:.3f},{r[1]:.3f}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}