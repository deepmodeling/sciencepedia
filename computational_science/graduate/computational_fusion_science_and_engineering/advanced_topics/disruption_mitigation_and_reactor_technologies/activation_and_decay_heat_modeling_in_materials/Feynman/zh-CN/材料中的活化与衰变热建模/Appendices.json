{
    "hands_on_practices": [
        {
            "introduction": "任何活化分析的第一步都是确定放射性新核素的产生速率。本练习将引导你从最基本的物理量——中子通量、靶核密度和反应截面——出发，计算这个初始活化率。掌握这项计算是理解活化动力学方程中“源项”的关键，也是所有后续衰变热分析的基础。",
            "id": "3946321",
            "problem": "聚变包层中的一种均匀、各向同性的结构材料初始不含活化产物，并暴露于稳态快中子场中。中子注量率定义为单位时间内穿过单位面积的中子数，测得其值为 $\\phi = 1.0\\times 10^{14}\\,\\mathrm{n\\,cm^{-2}\\,s^{-1}}$。一个主要单一活化道的靶核素具有均匀的原子核数密度，其值为 $N = 8.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$。该主要活化反应的有效微观截面（在快中子能谱上平均）为 $\\sigma = 0.5\\,\\mathrm{b}$，其中 $\\mathrm{b}$ 表示靶恩单位。\n\n请使用适用于材料中活化与衰变热模拟的第一性原理——具体而言，即粒子注量率和微观截面的定义以及它们与单位程长反应概率的关系——推导该主要反应的单位体积内活化产物初始生成率（初始活化率密度）的表达式。然后使用所提供的数据计算其数值。\n\n将最终的单位体积活化率以 $\\mathrm{reactions\\,cm^{-3}\\,s^{-1}}$ 为单位表示，并将您的答案四舍五入到三位有效数字。",
            "solution": "该问题要求推导并计算在稳态中子场作用下，材料中单位体积内活化产物的初始生成率。该量等同于指定活化道的初始反应率密度。推导将基于所提供物理量的基本定义。\n\n关键的物理量如下：\n1.  **中子注量率 ($\\phi$)**: 定义为单位时间内穿过垂直于中子运动方向的单位面积的中子数。其单位通常为 $\\mathrm{n\\,cm^{-2}\\,s^{-1}}$。给定值为 $\\phi = 1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}$。请注意，表示中子的'n'是一个描述符，在量纲分析中不是一个正式的单位。\n\n2.  **靶原子核数密度 ($N$)**: 这是材料单位体积内的靶原子核数量。其单位为 $\\mathrm{cm^{-3}}$。给定值为 $N = 8.0 \\times 10^{22}\\,\\mathrm{cm^{-3}}$。\n\n3.  **微观截面 ($\\sigma$)**: 此量表示单个原子核针对特定类型的反应向入射中子呈现的有效靶面积。它具有面积的单位，通常用靶恩（$\\mathrm{b}$）表示，其中 $1\\,\\mathrm{b} = 10^{-24}\\,\\mathrm{cm^2}$。它实质上是反应发生概率的一种度量。给定值为 $\\sigma = 0.5\\,\\mathrm{b}$。\n\n为了推导反应率密度，我们考虑材料的一个均匀薄片，其表面积为 $A$，无穷小厚度为 $dx$。该薄片的体积为 $dV = A \\cdot dx$。\n\n此体积薄片内的靶原子核总数由原子核数密度与体积的乘积给出：\n$$ \\text{Number of target nuclei} = N \\cdot dV = N A \\, dx $$\n\n这些原子核中的每一个都为活化反应提供了一个有效面积 $\\sigma$。假设该薄片足够薄，以至于原子核之间不会相互“屏蔽”，那么该薄片中所有原子核为反应提供的总有效面积为：\n$$ \\text{Total effective area} = (N A \\, dx) \\cdot \\sigma $$\n\n中子注量率 $\\phi$ 表示单位时间内入射到单位面积上的中子数。因此，单位时间内入射到我们薄片面积 $A$ 上的中子总数为 $\\phi A$。\n\n体积薄片 $dV$ 内的反应率是单位时间内的总入射中子数与被原子核有效靶面积“覆盖”的面积分数的乘积。这个面积分数是总有效面积与总面积 $A$ 的比值：\n$$ \\text{Fractional area} = \\frac{(N A \\, dx) \\sigma}{A} = N \\sigma \\, dx $$\n这个量 $N \\sigma \\, dx$ 是一个中子穿过厚度 $dx$ 时发生反应的概率。\n\n因此，体积 $dV$ 中的反应率（反应次数/秒）为：\n$$ \\text{Reaction rate in } dV = (\\text{neutrons per second on } A) \\times (\\text{reaction probability per neutron}) $$\n$$ \\text{Reaction rate in } dV = (\\phi A) \\times (N \\sigma \\, dx) $$\n\n我们用 $R$ 表示的反应率密度，定义为单位体积的反应率。为求得此值，我们将无穷小体积内的反应率除以该体积 $dV$：\n$$ R = \\frac{\\text{Reaction rate in } dV}{dV} = \\frac{\\phi A N \\sigma \\, dx}{A \\, dx} = \\phi N \\sigma $$\n\n这个表达式 $R = \\phi N \\sigma$ 给出了单位时间单位体积内的活化反应率。乘积 $\\Sigma = N\\sigma$ 通常被称为宏观截面，表示中子在单位程长内发生反应的概率。因此，$R = \\phi \\Sigma$。\n\n问题指明材料初始不含活化产物。在一般情况下，如果活化产物（其核数密度为 $N_p$，衰变常数为 $\\lambda_p$）也在衰变，则产物浓度的净变化率由适用于此简单链的贝特曼方程给出：\n$$ \\frac{dN_p(t)}{dt} = (\\text{Formation Rate}) - (\\text{Decay Rate}) = \\phi N \\sigma - \\lambda_p N_p(t) $$\n初始生成率（在时间 $t=0$ 时）可以通过代入初始条件 $N_p(0) = 0$ 来计算该表达式得到：\n$$ \\left. \\frac{dN_p}{dt} \\right|_{t=0} = \\phi N \\sigma - \\lambda_p N_p(0) = \\phi N \\sigma - 0 = \\phi N \\sigma $$\n因此，初始活化率密度恰好就是反应率密度 $R = \\phi N \\sigma$。\n\n现在，我们使用提供的数据计算其数值：\n已知：\n- 中子注量率, $\\phi = 1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}$\n- 靶原子核数密度, $N = 8.0 \\times 10^{22}\\,\\mathrm{cm^{-3}}$\n- 微观截面, $\\sigma = 0.5\\,\\mathrm{b}$\n\n首先，我们必须将截面单位从靶恩转换为 $\\mathrm{cm}^2$：\n$$ \\sigma = 0.5\\,\\mathrm{b} \\times \\frac{10^{-24}\\,\\mathrm{cm^2}}{1\\,\\mathrm{b}} = 0.5 \\times 10^{-24}\\,\\mathrm{cm^2} $$\n\n现在，将这些值代入推导出的反应率密度 $R$ 的公式中：\n$$ R = \\phi N \\sigma $$\n$$ R = (1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}) \\times (8.0 \\times 10^{22}\\,\\mathrm{cm^{-3}}) \\times (0.5 \\times 10^{-24}\\,\\mathrm{cm^2}) $$\n\n让我们先计算数值部分：\n$$ 1.0 \\times 8.0 \\times 0.5 = 4.0 $$\n接下来，我们计算 10 的幂：\n$$ 10^{14} \\times 10^{22} \\times 10^{-24} = 10^{14+22-24} = 10^{12} $$\n\n综合这些结果：\n$$ R = 4.0 \\times 10^{12} $$\n\n现在，我们来验证单位：\n$$ (\\mathrm{cm^{-2}\\,s^{-1}}) \\times (\\mathrm{cm^{-3}}) \\times (\\mathrm{cm^2}) = \\mathrm{cm}^{-2-3+2}\\,\\mathrm{s^{-1}} = \\mathrm{cm^{-3}\\,s^{-1}} $$\n得到的单位是 $\\mathrm{cm^{-3}\\,s^{-1}}$，这对应于题目所要求的单位时间单位体积内的反应次数。\n\n问题要求答案四舍五入到三位有效数字。计算出的值为 $4.0 \\times 10^{12}$。为了用三位有效数字表示，我们将其写作 $4.00 \\times 10^{12}$。\n\n因此，初始活化率密度为 $4.00 \\times 10^{12}\\,\\mathrm{reactions\\,cm^{-3}\\,s^{-1}}$。",
            "answer": "$$\\boxed{4.00 \\times 10^{12}}$$"
        },
        {
            "introduction": "在计算了瞬时活化率之后，下一步是理解整个过程随时间的变化。本练习将引导你模拟一个更完整的场景：放射性核素在中子辐照期间的累积，以及停堆后在冷却阶段的衰减。通过解决这个综合性问题，你将学会如何计算反应堆停堆等关键时刻的衰变热功率，这是反应堆安全分析中的一项核心技能。",
            "id": "3946336",
            "problem": "一个质量为 $m=1.00\\,\\mathrm{kg}$ 的单一同位素钨样品，被放置在聚变相关的中子环境中，中子通量恒定为 $\\phi=1.0\\times 10^{14}\\,\\mathrm{n\\,cm^{-2}\\,s^{-1}}$，辐照时间为 $t_{\\mathrm{irr}}=1.0\\times 10^{5}\\,\\mathrm{s}$。 (n,2n)反应的有效微观截面为 $\\sigma=0.20\\,\\mathrm{b}$，其中 $1\\,\\mathrm{b}=10^{-24}\\,\\mathrm{cm^{2}}$。该反应产生单一的主要活化产物，此产物通过单一渠道衰变，衰变常数为 $\\lambda=1.0\\times 10^{-6}\\,\\mathrm{s^{-1}}$。每次衰变在材料中局部沉积的平均能量为 $E_{\\mathrm{dep}}=2.0\\,\\mathrm{MeV}$。假设如下：\n- 在辐照期间，中子通量在样品上空间和时间上是均匀的。\n- 靶钨原子数保持有效恒定（在所考虑的时间尺度上，燃耗和嬗变损耗可忽略不计）。\n- 有效截面 $\\sigma$ 和衰变参数与时间无关。\n- 所有衰变能量 $E_{\\mathrm{dep}}$ 都局部沉积（无逃逸）。\n- 只有单一活化产物对衰变热有贡献。\n\n使用阿伏伽德罗常数 $N_{\\mathrm{A}}=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$，钨的摩尔质量 $M_{\\mathrm{W}}=183.84\\,\\mathrm{g\\,mol^{-1}}$，以及能量转换关系 $1\\,\\mathrm{eV}=1.602176634\\times 10^{-19}\\,\\mathrm{J}$。\n\n从活化和衰变动力学的第一性原理出发，计算停照时（辐照结束后 $t=0^{+}$）的瞬时衰变热功率，以及经过 $t_{\\mathrm{cool}}=1.0\\times 10^{6}\\,\\mathrm{s}$ 冷却时间后的衰变热功率。将两个答案都以 $\\mathrm{W}$ 为单位表示，并四舍五入到三位有效数字。按所述顺序将两个答案成对给出。",
            "solution": "该问题要求计算钨样品在两个不同时间的衰变热功率：辐照停止后即刻以及经过指定的冷却期后。我们必须首先验证问题的陈述。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 材料：单一同位素钨\n- 质量：$m=1.00\\,\\mathrm{kg}$\n- 中子通量：$\\phi=1.0\\times 10^{14}\\,\\mathrm{n\\,cm^{-2}\\,s^{-1}}$\n- 辐照时间：$t_{\\mathrm{irr}}=1.0\\times 10^{5}\\,\\mathrm{s}$\n- 反应：$(n,2n)$\n- 微观截面：$\\sigma=0.20\\,\\mathrm{b}$\n- 靶恩定义：$1\\,\\mathrm{b}=10^{-24}\\,\\mathrm{cm^{2}}$\n- 衰变常数：$\\lambda=1.0\\times 10^{-6}\\,\\mathrm{s^{-1}}$\n- 每次衰变平均沉积能量：$E_{\\mathrm{dep}}=2.0\\,\\mathrm{MeV}$\n- 阿伏伽德罗常数：$N_{\\mathrm{A}}=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$\n- 钨的摩尔质量：$M_{\\mathrm{W}}=183.84\\,\\mathrm{g\\,mol^{-1}}$\n- 能量转换：$1\\,\\mathrm{eV}=1.602176634\\times 10^{-19}\\,\\mathrm{J}$\n- 假设：均匀通量、可忽略的燃耗、时间无关的参数、局部能量沉积、单一主要活化产物。\n- 待计算量：停照时（$t=0^{+}$）和冷却时间 $t_{\\mathrm{cool}}=1.0\\times 10^{6}\\,\\mathrm{s}$ 后的衰变热功率。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了与聚变工程相关的标准核活化和衰变过程。所提供的参数，如中子通量、截面和衰变常数，在此背景下是物理上合理的。该问题提法明确，提供了所有必要的数据和明确的简化假设（例如，可忽略的燃耗、单一同位素靶），使其具有唯一解。语言客观而精确。该问题没有违反任何基本原理，不基于错误的前提，并且完全属于指定的科学领域。它是完整的、一致的并且是可解的。\n\n**第3步：结论与行动**\n问题有效。我们开始求解。\n\n### 解题推导\n\n在任意时刻 $t$ 的衰变热功率 $P(t)$ 是样品放射性活度 $A(t)$ 与每次衰变沉积能量 $E_{\\mathrm{dep}}$ 的乘积。活度的定义为 $A(t) = \\lambda N(t)$，其中 $N(t)$ 是时刻 $t$ 的放射性核素数量，$\\lambda$ 是衰变常数。\n$$\nP(t) = A(t)E_{\\mathrm{dep}} = \\lambda N(t) E_{\\mathrm{dep}}\n$$\n为了求出衰变热，我们必须首先确定活化核素的数量 $N(t)$。\n\n**1. 辐照期间的活化**\n在从 $t=0$ 到 $t=t_{\\mathrm{irr}}$ 的辐照期间，活化核素数量 $N(t)$ 因产生和衰变而变化。其变化率由以下一阶线性常微分方程给出：\n$$\n\\frac{dN(t)}{dt} = R_{\\mathrm{prod}} - \\lambda N(t)\n$$\n其中 $R_{\\mathrm{prod}}$ 是活化物种的恒定产生率，$\\lambda N(t)$ 是衰变率。产生率是靶钨原子总数 $N_T$、(n,2n)反应的微观截面 $\\sigma$ 和中子通量 $\\phi$ 的乘积。\n$$\nR_{\\mathrm{prod}} = N_T\\sigma\\phi\n$$\n靶原子数 $N_T$ 由样品的质量 $m$、摩尔质量 $M_W$ 和阿伏伽德罗常数 $N_A$ 计算得出。\n$$\nN_T = \\frac{m}{M_W}N_A\n$$\n活化的微分方程为：\n$$\n\\frac{dN(t)}{dt} + \\lambda N(t) = N_T\\sigma\\phi\n$$\n在初始条件 $N(0)=0$（辐照前没有活化核素）下，该方程的解为：\n$$\nN(t) = \\frac{N_T\\sigma\\phi}{\\lambda}\\left(1 - \\exp(-\\lambda t)\\right)\n$$\n在辐照期结束时，即 $t=t_{\\mathrm{irr}}$ 时，活化核素的数量（我们记为 $N_{\\mathrm{shut}}$）为：\n$$\nN_{\\mathrm{shut}} = N(t_{\\mathrm{irr}}) = \\frac{N_T\\sigma\\phi}{\\lambda}\\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right)\n$$\n\n**2. 冷却期间的衰变**\n在 $t=t_{\\mathrm{irr}}$ 停止辐照后，产生项 $R_{\\mathrm{prod}}$ 变为零。设 $t'$ 为冷却时间，其中 $t'=0$ 对应于停照时刻。冷却期间活化核素的数量 $N(t')$ 由纯放射性衰变决定：\n$$\n\\frac{dN(t')}{dt'} = -\\lambda N(t')\n$$\n此阶段的初始条件是 $N(t'=0) = N_{\\mathrm{shut}}$。解为：\n$$\nN(t') = N_{\\mathrm{shut}}\\exp(-\\lambda t') = \\frac{N_T\\sigma\\phi}{\\lambda}\\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right)\\exp(-\\lambda t')\n$$\n\n**3. 衰变热功率计算**\n在冷却时间 $t' = t_{\\mathrm{cool}}$ 的衰变热功率由下式给出：\n$$\nP(t_{\\mathrm{cool}}) = \\lambda N(t_{\\mathrm{cool}}) E_{\\mathrm{dep}} = N_T\\sigma\\phi E_{\\mathrm{dep}} \\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right)\\exp(-\\lambda t_{\\mathrm{cool}})\n$$\n\n**4. 数值计算**\n首先，我们将所有给定值转换为一组一致的单位（在适用的情况下使用国际单位制）。\n- $m = 1.00\\,\\mathrm{kg} = 1000\\,\\mathrm{g}$\n- $\\sigma = 0.20\\,\\mathrm{b} = 0.20 \\times 10^{-24}\\,\\mathrm{cm^2} = 2.0 \\times 10^{-25}\\,\\mathrm{cm^2}$\n- $\\phi = 1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}$\n- $E_{\\mathrm{dep}} = 2.0\\,\\mathrm{MeV} = 2.0 \\times 10^6\\,\\mathrm{eV} \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 3.204353268 \\times 10^{-13}\\,\\mathrm{J}$\n\n靶钨原子数为：\n$$\nN_T = \\frac{1000\\,\\mathrm{g}}{183.84\\,\\mathrm{g\\,mol^{-1}}} \\times (6.02214076 \\times 10^{23}\\,\\mathrm{mol^{-1}}) \\approx 3.2758 \\times 10^{24}\\,\\text{atoms}\n$$\n在饱和状态下（$t_{\\mathrm{irr}} \\to \\infty$），衰变热的总产生率是系数 $P_{\\mathrm{sat}} = N_T\\sigma\\phi E_{\\mathrm{dep}}$：\n$$\nP_{\\mathrm{sat}} = (3.2758 \\times 10^{24}) \\times (2.0 \\times 10^{-25}\\,\\mathrm{cm^{2}}) \\times (1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}) \\times (3.20435... \\times 10^{-13}\\,\\mathrm{J}) \\approx 20.993\\,\\mathrm{W}\n$$\n指数参数为：\n- $\\lambda t_{\\mathrm{irr}} = (1.0 \\times 10^{-6}\\,\\mathrm{s^{-1}}) \\times (1.0 \\times 10^{5}\\,\\mathrm{s}) = 0.1$\n- $\\lambda t_{\\mathrm{cool}} = (1.0 \\times 10^{-6}\\,\\mathrm{s^{-1}}) \\times (1.0 \\times 10^{6}\\,\\mathrm{s}) = 1.0$\n\n**停照时的功率 ($t_{\\mathrm{cool}}=0$)**\n停照时的衰变热功率 $P_{\\mathrm{shut}}$，通过设置 $t_{\\mathrm{cool}}=0$ 得到，因此 $\\exp(-\\lambda t_{\\mathrm{cool}})=1$。\n$$\nP_{\\mathrm{shut}} = P_{\\mathrm{sat}} \\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right) = 20.993\\,\\mathrm{W} \\times \\left(1 - \\exp(-0.1)\\right)\n$$\n$$\nP_{\\mathrm{shut}} \\approx 20.993 \\times (1 - 0.904837) = 20.993 \\times 0.095163 \\approx 1.9978\\,\\mathrm{W}\n$$\n四舍五入到三位有效数字，$P_{\\mathrm{shut}} = 2.00\\,\\mathrm{W}$。\n\n**冷却后的功率 ($t_{\\mathrm{cool}}=1.0\\times 10^{6}\\,\\mathrm{s}$)**\n冷却时间后的衰变热功率 $P_{\\mathrm{cool}}$ 为：\n$$\nP_{\\mathrm{cool}} = P_{\\mathrm{shut}} \\exp(-\\lambda t_{\\mathrm{cool}}) = 1.9978\\,\\mathrm{W} \\times \\exp(-1.0)\n$$\n$$\nP_{\\mathrm{cool}} \\approx 1.9978 \\times 0.367879 \\approx 0.7350\\,\\mathrm{W}\n$$\n四舍五入到三位有效数字，$P_{\\mathrm{cool}} = 0.735\\,\\mathrm{W}$。\n所要求的两个值是停照时和指定冷却时间后的衰变热。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.00  0.735 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现实世界中的活化问题往往涉及复杂的衰变链和多变的辐照历史，必须依赖数值方法求解。这项高级实践将带你深入计算科学的核心：验证与确认（Verification and Validation, VV）",
            "id": "3946331",
            "problem": "考虑材料在经受中子辐照及后续冷却过程中核素存量的时变演化。其控制方程是基于第一性原理推导出的线性常微分方程（ODE）：放射性衰变和恒定速率的活化。设 $N_i(t)$ 表示在时间 $t$ 时核素 $i$ 的原子数量，$\\lambda_i$ 为其衰变常数，定义为 $\\lambda_i = \\ln(2)/T_{1/2,i}$，其中 $T_{1/2,i}$ 是以秒为单位表示的半衰期。核素 $i$ 的活度 $A_i(t)$ 为 $A_i(t) = \\lambda_i N_i(t)$。以瓦特为单位的衰变热功率 $P(t)$ 计算公式为 $P(t) = \\sum_i \\lambda_i N_i(t) Q_i^{\\mathrm{J}}$，其中 $Q_i^{\\mathrm{J}}$ 是每次衰变释放的平均能量，以焦耳为单位，通过给定的平均衰变能 $Q_i^{\\mathrm{MeV}}$（兆电子伏特）经由 $Q_i^{\\mathrm{J}} = Q_i^{\\mathrm{MeV}} \\times 10^{6} \\times 1.602176634 \\times 10^{-19}$ 换算得到。假设辐照期间中子通量和截面恒定，因此进入母核素的活化源项是恒定的。\n\n模型构建的基本原理如下：\n- 单个核素的放射性衰变：$dN/dt = -\\lambda N$。\n- 从核素 A 到核素 B 的放射性衰变链：$dN_A/dt = -\\lambda_A N_A$, $dN_B/dt = \\lambda_A N_A - \\lambda_B N_B$。\n- 在辐照期间，恒定速率的活化源 $S_A$ 补给核素 A：$dN_A/dt = S_A - \\lambda_A N_A$，其中 $S_A = \\sigma \\phi N_T$，$\\sigma$ 是微观截面，$\\phi$ 是中子通量，$N_T$ 是靶原子数量。在冷却阶段，$S_A$ 设为 0。\n\n使用这些基本原理，为选定的一阶隐式时间积分方案构建一个验证测试。目标是评估其相对于三种情景下已知的 Bateman 精确解的收敛性。通过将后向欧拉法应用于线性系统 $d\\mathbf{N}/dt = \\mathbf{A}\\mathbf{N} + \\mathbf{s}$ 来定义数值方案，其中 $\\mathbf{A}$ 是常数矩阵，$\\mathbf{s}$ 是分段常数向量。从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的后向欧拉更新公式为 $(\\mathbf{I} - \\Delta t \\,\\mathbf{A}) \\mathbf{N}_{n+1} = \\mathbf{N}_n + \\Delta t \\,\\mathbf{s}$，其中 $\\mathbf{I}$ 是单位矩阵。使用均匀的时间步长 $\\Delta t$，该步长能精确划分每个情景的区间。\n\n对于下文的每个情景，计算在指定的最终时刻：(i) 每个被建模核素的存量，以及 (ii) 总衰变热功率。对于每个量，通过比较在三个递减的时间步长 $\\Delta t_1  \\Delta t_2  \\Delta t_3$ 下，数值结果与 Bateman 精确解之间的相对误差来估计观测到的精度阶。对于一个量 $X$，在 $\\Delta t$ 下的相对误差定义为 $e(\\Delta t) = |X_{\\mathrm{num}} - X_{\\mathrm{exact}}| / \\max(|X_{\\mathrm{exact}}|, \\epsilon)$，其中 $\\epsilon = 10^{-30}$，并通过对两个局部阶 $p_{12} = \\ln\\left(e(\\Delta t_1)/e(\\Delta t_2)\\right)/\\ln\\left(\\Delta t_1/\\Delta t_2\\right)$ 和 $p_{23} = \\ln\\left(e(\\Delta t_2)/e(\\Delta t_3)\\right)/\\ln\\left(\\Delta t_2/\\Delta t_3\\right)$ 取平均来估计阶数 $p$。\n\n情景和参数（除非另有说明，所有数值均采用国际单位制（SI））：\n\n- 情景 1（纯衰变，单个核素）：\n  - 初始条件：$N_0 = 10^{20}$ 个原子。\n  - 半衰期：$T_{1/2} = 1$ 秒，因此 $\\lambda = \\ln(2)/1$。\n  - 平均衰变能：$Q^{\\mathrm{MeV}} = 0.5$。\n  - 最终时间：$t_{\\mathrm{f}} = 10$ 秒。\n  - 时间步长：$\\Delta t_1 = 1.0$ 秒, $\\Delta t_2 = 0.5$ 秒, $\\Delta t_3 = 0.25$ 秒。\n\n- 情景 2（无源双核素衰变链）：\n  - 初始条件：$N_A(0) = 10^{19}$ 个原子, $N_B(0) = 0$ 个原子。\n  - 半衰期：$T_{1/2,A} = 5$ 秒, $T_{1/2,B} = 20$ 秒，因此 $\\lambda_A = \\ln(2)/5$, $\\lambda_B = \\ln(2)/20$。\n  - 平均衰变能：$Q_A^{\\mathrm{MeV}} = 0.3$, $Q_B^{\\mathrm{MeV}} = 0.8$。\n  - 最终时间：$t_{\\mathrm{f}} = 50$ 秒。\n  - 时间步长：$\\Delta t_1 = 2.0$ 秒, $\\Delta t_2 = 1.0$ 秒, $\\Delta t_3 = 0.5$ 秒。\n\n- 情景 3（辐照与冷却，活化源补给母核素 A，双核素衰变链 $A \\rightarrow B \\rightarrow$ 稳定）：\n  - 初始条件：$N_A(0) = 0$ 个原子, $N_B(0) = 0$ 个原子。\n  - 活化源：$S_A = \\sigma \\phi N_T$，其中 $\\sigma = 10^{-24}$ 平方厘米（一靶），$\\phi = 10^{14}$ 中子每平方厘米每秒，$N_T = 10^{22}$ 个原子，因此在辐照期间 $S_A = 10^{12}$ 原子每秒，在冷却期间 $S_A = 0$。\n  - 半衰期：$T_{1/2,A} = 50$ 秒, $T_{1/2,B} = 200$ 秒，因此 $\\lambda_A = \\ln(2)/50$, $\\lambda_B = \\ln(2)/200$。\n  - 平均衰变能：$Q_A^{\\mathrm{MeV}} = 0.4$, $Q_B^{\\mathrm{MeV}} = 1.2$。\n  - 辐照时间：$t_{\\mathrm{irr}} = 100$ 秒，然后冷却至最终时间 $t_{\\mathrm{f}} = 300$ 秒。\n  - 时间步长：$\\Delta t_1 = 5.0$ 秒, $\\Delta t_2 = 2.5$ 秒, $\\Delta t_3 = 1.25$ 秒。\n\n程序要求：\n- 按照规定，为带有分段常数 $\\mathbf{s}$ 的线性系统 $d\\mathbf{N}/dt = \\mathbf{A}\\mathbf{N} + \\mathbf{s}$ 实现后向欧拉方案。\n- 对于每个情景，计算在要求时间点的精确解（Bateman 解）以供比较。\n- 计算以下各量的观测精度阶 $p$：\n  - 情景 1：最终存量 $N(t_{\\mathrm{f}})$ 和最终衰变热功率 $P(t_{\\mathrm{f}})$。\n  - 情景 2：最终存量 $N_A(t_{\\mathrm{f}})$、$N_B(t_{\\mathrm{f}})$ 和最终总衰变热功率 $P(t_{\\mathrm{f}})$。\n  - 情景 3：最终存量 $N_A(t_{\\mathrm{f}})$、$N_B(t_{\\mathrm{f}})$ 和最终总衰变热功率 $P(t_{\\mathrm{f}})$。\n- 您的程序应生成单行输出，其中包含按以下确切顺序排列的结果，形式为用方括号括起来的逗号分隔列表：$[p_{1,N}, p_{1,P}, p_{2,N_A}, p_{2,N_B}, p_{2,P}, p_{3,N_A}, p_{3,N_B}, p_{3,P}]$。所有条目必须是 Python 浮点数值。根据设计，衰变热功率以瓦特计算，但仅需打印无量纲的观测阶 $p$。\n\n不允许外部输入。问题必须完全在程序内部解决。确保参数的科学真实性和自洽性。用于获得精确解和数值方案的数学推导必须遵循上述基本原理，而不能依赖问题陈述中直接提供的简化公式。",
            "solution": "该问题要求对用于求解核素活化与衰变常微分方程（ODE）的一阶隐式时间积分方案——后向欧拉法——进行验证。验证通过将数值结果与三种不同情景下已知的精确解析解进行比较来执行。此验证的主要度量标准是观测到的精度阶，对于一阶方法，其预期值应接近 $1$。\n\n一组核素的原子数量（由向量 $\\mathbf{N}(t)$ 表示）的时间演化由一个线性一阶常系数常微分方程组描述：\n$$\n\\frac{d\\mathbf{N}(t)}{dt} = \\mathbf{A}\\mathbf{N}(t) + \\mathbf{s}\n$$\n这里，$\\mathbf{N}(t)$ 是核素存量向量 $[N_1(t), N_2(t), \\dots]^T$。矩阵 $\\mathbf{A}$ 包含衰变常数（$\\lambda_i$）和分支比，代表嬗变与衰变的速率。向量 $\\mathbf{s}$ 代表恒定外部源，例如来自中子诱发的活化反应的源。\n\n后向欧拉法将此常微分方程组在时间上离散化。给定一个时间步长 $\\Delta t$，从时间 $t_n$ 的状态出发，通过在新的时间点 $t_{n+1}$ 处计算导数，来近似得到时间 $t_{n+1} = t_n + \\Delta t$ 的状态：\n$$\n\\frac{\\mathbf{N}_{n+1} - \\mathbf{N}_n}{\\Delta t} = \\mathbf{A}\\mathbf{N}_{n+1} + \\mathbf{s}\n$$\n重排该方程可得到更新规则，该规则要求解一个关于 $\\mathbf{N}_{n+1}$ 的线性系统：\n$$\n(\\mathbf{I} - \\Delta t \\mathbf{A}) \\mathbf{N}_{n+1} = \\mathbf{N}_n + \\Delta t \\mathbf{s}\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。在每个时间步求解此系统以推进解。\n\n总衰变热功率 $P(t)$（单位：瓦特）由核素存量 $N_i(t)$ 和它们各自的活度 $A_i(t) = \\lambda_i N_i(t)$ 计算得出：\n$$\nP(t) = \\sum_i A_i(t) Q_i^{\\mathrm{J}} = \\sum_i \\lambda_i N_i(t) Q_i^{\\mathrm{J}}\n$$\n其中 $Q_i^{\\mathrm{J}}$ 是每次衰变的平均能量（单位：焦耳），由给定的能量（单位：兆电子伏特，$Q_i^{\\mathrm{MeV}}$）通过转换因子 $1 \\text{ MeV} = 10^6 \\times 1.602176634 \\times 10^{-19} \\text{ J}$ 换算而来。衰变常数 $\\lambda_i$ 与半衰期 $T_{1/2,i}$ 的关系为 $\\lambda_i = \\ln(2) / T_{1/2,i}$。\n\n为评估精度，我们使用相对误差 $e(\\Delta t)$ 来比较数值解（$X_{\\mathrm{num}}$）和精确解（$X_{\\mathrm{exact}}$）：\n$$\ne(\\Delta t) = \\frac{|X_{\\mathrm{num}} - X_{\\mathrm{exact}}|}{\\max(|X_{\\mathrm{exact}}|, \\epsilon)}\n$$\n其中有一个小的下限值 $\\epsilon = 10^{-30}$ 以防止除以零。观测精度阶 $p$ 是根据三个时间步长 $\\Delta t_1  \\Delta t_2  \\Delta t_3$ 的结果估算得出的，每次步长减半（$\\Delta t_1 = 2\\Delta t_2 = 4\\Delta t_3$）。它等于两个局部阶估计值的平均值：\n$$\np = \\frac{1}{2} \\left( p_{12} + p_{23} \\right) \\quad \\text{其中} \\quad p_{12} = \\frac{\\ln(e(\\Delta t_1)/e(\\Delta t_2))}{\\ln(\\Delta t_1/\\Delta t_2)}, \\quad p_{23} = \\frac{\\ln(e(\\Delta t_2)/e(\\Delta t_3))}{\\ln(\\Delta t_2/\\Delta t_3)}\n$$\n\n下面我们详细说明每个情景的具体公式。\n\n### 情景 1：单个核素的纯衰变\n该情景模拟了无源情况下单个核素的衰变。\n- **控制方程**：$dN/dt = -\\lambda N$，初始条件为 $N(0) = N_0 = 10^{20}$ 个原子。\n- **系统矩阵**：$\\mathbf{N} = [N]$，$\\mathbf{A} = [-\\lambda]$，$\\mathbf{s} = [0]$。\n- **精确解**：解为指数衰变：\n$$\nN(t) = N_0 e^{-\\lambda t}\n$$\n- **数值实现**：后向欧拉更新公式为 $N_{n+1} = N_n / (1 + \\lambda \\Delta t)$。\n- **参数**：$\\lambda = \\ln(2)/1.0 \\text{ s}^{-1}$，$t_f = 10$ 秒。\n\n### 情景 2：双核素衰变链\n该情景模拟了无外部源的衰变链 $A \\rightarrow B \\rightarrow \\text{稳定}$。\n- **控制方程**：\n$$\n\\frac{dN_A}{dt} = -\\lambda_A N_A\n$$\n$$\n\\frac{dN_B}{dt} = \\lambda_A N_A - \\lambda_B N_B\n$$\n- **系统矩阵**：$\\mathbf{N} = [N_A, N_B]^T$，$\\mathbf{s} = [0, 0]^T$，以及 $\\mathbf{A} = \\begin{pmatrix} -\\lambda_A  0 \\\\ \\lambda_A  -\\lambda_B \\end{pmatrix}$。\n- **精确解（Bateman 方程）**：对于初始条件 $N_A(0)$ 和 $N_B(0)=0$，且假设 $\\lambda_A \\neq \\lambda_B$：\n$$\nN_A(t) = N_A(0) e^{-\\lambda_A t}\n$$\n$$\nN_B(t) = \\frac{\\lambda_A N_A(0)}{\\lambda_B - \\lambda_A} (e^{-\\lambda_A t} - e^{-\\lambda_B t})\n$$\n- **数值实现**：求解系统 $(\\mathbf{I} - \\Delta t \\mathbf{A}) \\mathbf{N}_{n+1} = \\mathbf{N}_n$。由于该矩阵是下三角矩阵，可以通过前向代入高效求解。\n- **参数**：$N_A(0) = 10^{19}$，$N_B(0)=0$，$\\lambda_A = \\ln(2)/5 \\text{ s}^{-1}$，$\\lambda_B = \\ln(2)/20 \\text{ s}^{-1}$，$t_f = 50$ 秒。\n\n### 情景 3：辐照与冷却\n该情景涉及活化产生核素 A，然后衰变为 B（$A \\rightarrow B \\rightarrow \\text{稳定}$），过程分为两个阶段：一个带有恒定源的辐照期，随后是一个无源的冷却期。\n- **控制方程（辐照，$0 \\le t \\le t_{irr}$）**：\n$$\n\\frac{dN_A}{dt} = S_A - \\lambda_A N_A\n$$\n$$\n\\frac{dN_B}{dt} = \\lambda_A N_A - \\lambda_B N_B\n$$\n这里，$\\mathbf{s} = [S_A, 0]^T$，其中 $S_A = 10^{12} \\text{ 原子/秒}$。对于冷却阶段（$t  t_{irr}$），$S_A=0$，方程与情景 2 相同。\n- **精确解**：\n  1.  **辐照阶段（$0 \\le t \\le t_{irr}$）**：初始条件为 $N_A(0)=0, N_B(0)=0$ 且 $\\lambda_A \\neq \\lambda_B$：\n      $$\n      N_A(t) = \\frac{S_A}{\\lambda_A}(1 - e^{-\\lambda_A t})\n      $$\n      $$\n      N_B(t) = S_A \\left( \\frac{1-e^{-\\lambda_B t}}{\\lambda_B} - \\frac{e^{-\\lambda_A t}-e^{-\\lambda_B t}}{\\lambda_B - \\lambda_A} \\right)\n      $$\n      我们首先计算辐照结束时的存量 $N_A(t_{irr})$ 和 $N_B(t_{irr})$。\n  2.  **冷却阶段（$t' = t - t_{irr}$，对于 $0  t' \\le t_f - t_{irr}$）**：这些存量作为冷却阶段的初始条件，该阶段是一个纯衰变问题。\n      $$\n      N_A(t) = N_A(t_{irr}) e^{-\\lambda_A (t - t_{irr})}\n      $$\n      $$\n      N_B(t) = \\frac{\\lambda_A N_A(t_{irr})}{\\lambda_B - \\lambda_A} (e^{-\\lambda_A (t-t_{irr})} - e^{-\\lambda_B (t-t_{irr})}) + N_B(t_{irr}) e^{-\\lambda_B (t-t_{irr})}\n      $$\n- **数值实现**：模拟分两个阶段运行。首先，求解器使用源项 $\\mathbf{s} = [S_A, 0]^T$ 迭代 $t_{irr}/\\Delta t$ 步。然后，使用得到的存量作为初始状态，在源项设为零（$\\mathbf{s} = [0, 0]^T$）的情况下，继续迭代 $(t_f - t_{irr})/\\Delta t$ 步。\n- **参数**：$N_A(0)=0, N_B(0)=0$，$S_A=10^{12} \\text{ 原子/秒}$，$\\lambda_A=\\ln(2)/50 \\text{ s}^{-1}$，$\\lambda_B=\\ln(2)/200 \\text{ s}^{-1}$，$t_{irr}=100$ 秒，$t_f=300$ 秒。\n\n代码实现了这些解析解和通用的后向欧拉求解器。对于每个情景，它使用两种方法在三种不同的时间步长下计算最终时刻的核素存量和衰变热。然后计算相对误差，并最终估计每个所需量的精度阶。正如后向欧拉法所预期的那样，观测到的阶数应约等于 1.0。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Global constants\nLOG2 = np.log(2)\nEV_TO_J = 1.602176634e-19\nMEV_TO_J = EV_TO_J * 1e6\nEPSILON = 1e-30 # For relative error calculation\n\ndef run_numerical_solver(N0, A_matrix, s_vector, t_final, dt):\n    \"\"\"\n    Solves dN/dt = A*N + s using the Backward Euler method.\n    \"\"\"\n    if dt == 0 or t_final == 0:\n        return np.copy(N0)\n    num_steps = round(t_final / dt)\n    N = np.copy(N0)\n    I = np.identity(len(N0))\n    \n    M = I - dt * A_matrix\n    \n    for _ in range(num_steps):\n        b = N + dt * s_vector\n        N = np.linalg.solve(M, b)\n        \n    return N\n\ndef get_rel_error(num_val, exact_val):\n    \"\"\"Calculates relative error.\"\"\"\n    return np.abs(num_val - exact_val) / np.max([np.abs(exact_val), EPSILON])\n\ndef calculate_order(errors, dts):\n    \"\"\"Calculates the observed order of accuracy.\"\"\"\n    dt_ratio12 = dts[0] / dts[1]\n    dt_ratio23 = dts[1] / dts[2]\n    \n    # Handle cases where error is near zero, which may give unstable p\n    if errors[0]  EPSILON or errors[1]  EPSILON:\n        p12 = 0.0 # Cannot determine order, assume it's not converging as expected\n    else:\n        p12 = np.log(errors[0] / errors[1]) / np.log(dt_ratio12)\n    \n    if errors[1]  EPSILON or errors[2]  EPSILON:\n        p23 = 0.0\n    else:\n        p23 = np.log(errors[1] / errors[2]) / np.log(dt_ratio23)\n\n    return (p12 + p23) / 2.0\n\ndef scenario_1():\n    \"\"\"Handler for Scenario 1: Pure Decay.\"\"\"\n    N0_val = 1e20\n    T_half = 1.0\n    Q_MeV = 0.5\n    t_f = 10.0\n    dts = [1.0, 0.5, 0.25]\n    \n    lam = LOG2 / T_half\n    Q_J = Q_MeV * MEV_TO_J\n    \n    # Analytical solution\n    N_exact = N0_val * np.exp(-lam * t_f)\n    P_exact = lam * N_exact * Q_J\n    \n    errors_N = []\n    errors_P = []\n    \n    # System definition\n    N0 = np.array([N0_val])\n    A = np.array([[-lam]])\n    s = np.array([0.0])\n    \n    for dt in dts:\n        N_final_num = run_numerical_solver(N0, A, s, t_f, dt)\n        N_num = N_final_num[0]\n        P_num = lam * N_num * Q_J\n        \n        errors_N.append(get_rel_error(N_num, N_exact))\n        errors_P.append(get_rel_error(P_num, P_exact))\n        \n    p_N = calculate_order(errors_N, dts)\n    p_P = calculate_order(errors_P, dts)\n    \n    return [p_N, p_P]\n\ndef scenario_2():\n    \"\"\"Handler for Scenario 2: Two-Nuclide Decay Chain.\"\"\"\n    NA0_val = 1e19\n    NB0_val = 0.0\n    T_half_A = 5.0\n    T_half_B = 20.0\n    Q_A_MeV = 0.3\n    Q_B_MeV = 0.8\n    t_f = 50.0\n    dts = [2.0, 1.0, 0.5]\n    \n    lam_A = LOG2 / T_half_A\n    lam_B = LOG2 / T_half_B\n    Q_A_J = Q_A_MeV * MEV_TO_J\n    Q_B_J = Q_B_MeV * MEV_TO_J\n    \n    # Analytical solution\n    NA_exact = NA0_val * np.exp(-lam_A * t_f)\n    if np.abs(lam_A - lam_B)  EPSILON:\n        NB_exact = lam_A * NA0_val * t_f * np.exp(-lam_A * t_f)\n    else:\n        term1 = lam_A / (lam_B - lam_A) * NA0_val\n        term2 = np.exp(-lam_A * t_f) - np.exp(-lam_B * t_f)\n        NB_exact = term1 * term2\n    P_exact = lam_A * NA_exact * Q_A_J + lam_B * NB_exact * Q_B_J\n    \n    errors_NA = []\n    errors_NB = []\n    errors_P = []\n\n    # System definition\n    N0 = np.array([NA0_val, NB0_val])\n    A = np.array([[-lam_A, 0.0], [lam_A, -lam_B]])\n    s = np.array([0.0, 0.0])\n    \n    for dt in dts:\n        N_final_num = run_numerical_solver(N0, A, s, t_f, dt)\n        NA_num, NB_num = N_final_num\n        P_num = lam_A * NA_num * Q_A_J + lam_B * NB_num * Q_B_J\n        \n        errors_NA.append(get_rel_error(NA_num, NA_exact))\n        errors_NB.append(get_rel_error(NB_num, NB_exact))\n        errors_P.append(get_rel_error(P_num, P_exact))\n        \n    p_NA = calculate_order(errors_NA, dts)\n    p_NB = calculate_order(errors_NB, dts)\n    p_P = calculate_order(errors_P, dts)\n    \n    return [p_NA, p_NB, p_P]\n\ndef scenario_3():\n    \"\"\"Handler for Scenario 3: Irradiation and Cooling.\"\"\"\n    S_A = 1e12\n    T_half_A, T_half_B = 50.0, 200.0\n    Q_A_MeV, Q_B_MeV = 0.4, 1.2\n    t_irr, t_f = 100.0, 300.0\n    dts = [5.0, 2.5, 1.25]\n    \n    t_cool = t_f - t_irr\n    lam_A = LOG2 / T_half_A\n    lam_B = LOG2 / T_half_B\n    Q_A_J = Q_A_MeV * MEV_TO_J\n    Q_B_J = Q_B_MeV * MEV_TO_J\n\n    # Analytical solution\n    # Phase 1: Irradiation\n    NA_irr = (S_A / lam_A) * (1 - np.exp(-lam_A * t_irr))\n    if np.abs(lam_A - lam_B)  EPSILON:\n        # Not applicable here, but for completeness\n        NB_irr = S_A * (1 - (1 + lam_A * t_irr)*np.exp(-lam_A * t_irr)) / lam_A\n    else:    \n        term1_NB = S_A * (1 - np.exp(-lam_B * t_irr)) / lam_B\n        term2_NB = S_A * (np.exp(-lam_A * t_irr) - np.exp(-lam_B * t_irr)) / (lam_B - lam_A)\n        NB_irr = term1_NB - term2_NB\n\n    # Phase 2: Cooling\n    NA_exact = NA_irr * np.exp(-lam_A * t_cool)\n    if np.abs(lam_A - lam_B)  EPSILON:\n        # Not applicable here\n        NB_exact = (NB_irr + lam_A * NA_irr * t_cool) * np.exp(-lam_A * t_cool)\n    else:\n        term1 = lam_A / (lam_B - lam_A) * NA_irr\n        term2 = np.exp(-lam_A * t_cool) - np.exp(-lam_B * t_cool)\n        NB_exact = term1 * term2 + NB_irr * np.exp(-lam_B * t_cool)\n    \n    P_exact = lam_A * NA_exact * Q_A_J + lam_B * NB_exact * Q_B_J\n\n    errors_NA, errors_NB, errors_P = [], [], []\n\n    # System definition (A matrix is constant)\n    N0 = np.array([0.0, 0.0])\n    A = np.array([[-lam_A, 0.0], [lam_A, -lam_B]])\n    s_irr = np.array([S_A, 0.0])\n    s_cool = np.array([0.0, 0.0])\n\n    for dt in dts:\n        # Numerical solution\n        N_at_irr_end = run_numerical_solver(N0, A, s_irr, t_irr, dt)\n        N_final_num = run_numerical_solver(N_at_irr_end, A, s_cool, t_cool, dt)\n        NA_num, NB_num = N_final_num\n        P_num = lam_A * NA_num * Q_A_J + lam_B * NB_num * Q_B_J\n\n        errors_NA.append(get_rel_error(NA_num, NA_exact))\n        errors_NB.append(get_rel_error(NB_num, NB_exact))\n        errors_P.append(get_rel_error(P_num, P_exact))\n        \n    p_NA = calculate_order(errors_NA, dts)\n    p_NB = calculate_order(errors_NB, dts)\n    p_P = calculate_order(errors_P, dts)\n    \n    return [p_NA, p_NB, p_P]\n\ndef solve():\n    \"\"\"\n    Main function to run all scenarios and print the results.\n    \"\"\"\n    results_s1 = scenario_1()\n    results_s2 = scenario_2()\n    results_s3 = scenario_3()\n    \n    all_results = results_s1 + results_s2 + results_s3\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}