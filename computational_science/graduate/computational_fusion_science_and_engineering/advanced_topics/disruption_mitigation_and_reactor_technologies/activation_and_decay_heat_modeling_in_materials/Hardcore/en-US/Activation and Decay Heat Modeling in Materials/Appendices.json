{
    "hands_on_practices": [
        {
            "introduction": "The first step in modeling material activation is to quantify the rate at which new radioactive nuclides are formed. This exercise  provides a hands-on opportunity to calculate this fundamental quantity, the initial activation rate density, from first principles. By working through this problem, you will solidify your understanding of how neutron flux ($\\phi$), target nuclide density ($N$), and microscopic cross section ($\\sigma$) combine to determine the reaction rate, which serves as the source term in activation-decay kinetic equations.",
            "id": "3946321",
            "problem": "A homogeneous, isotropic structural material in a fusion blanket is initially free of activation products and is exposed to a steady-state fast-neutron field. The neutron flux, defined as the number of neutrons crossing a unit area per unit time, is measured to be $\\phi = 1.0\\times 10^{14}\\,\\mathrm{n\\,cm^{-2}\\,s^{-1}}$. The target nuclide for a dominant single activation channel has a uniform atomic number density of $N = 8.0\\times 10^{22}\\,\\mathrm{cm^{-3}}$. The effective microscopic cross section for this dominant activation reaction, averaged over the fast-neutron spectrum, is $\\sigma = 0.5\\,\\mathrm{b}$, where $\\mathrm{b}$ denotes the barn unit.\n\nUsing first principles appropriate to activation and decay heat modeling in materials—specifically, the definitions of particle flux and microscopic cross section and their relationship to reaction probability per unit path length—derive the expression for the initial rate of formation of activation products per unit volume (the initial activation rate density) for this dominant reaction. Then compute its numerical value using the provided data.\n\nExpress the final activation rate per unit volume in $\\mathrm{reactions\\,cm^{-3}\\,s^{-1}}$, and round your answer to three significant figures.",
            "solution": "The problem asks for the derivation and calculation of the initial rate of formation of activation products per unit volume in a material subjected to a steady-state neutron field. This quantity is equivalent to the initial reaction rate density for the specified activation channel. The derivation will be based on the fundamental definitions of the quantities provided.\n\nThe key physical quantities are:\n1.  **Neutron Flux ($\\phi$)**: This is defined as the number of neutrons passing through a unit area perpendicular to the direction of neutron motion, per unit time. Its units are typically $\\mathrm{n\\,cm^{-2}\\,s^{-1}}$. The given value is $\\phi = 1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}$. Note that the 'n' for neutron is a descriptor, not a formal unit in dimensional analysis.\n\n2.  **Target Atomic Number Density ($N$)**: This is the number of target nuclei per unit volume of the material. Its units are $\\mathrm{cm^{-3}}$. The given value is $N = 8.0 \\times 10^{22}\\,\\mathrm{cm^{-3}}$.\n\n3.  **Microscopic Cross Section ($\\sigma$)**: This quantity represents the effective target area a single nucleus presents to an incident neutron for a specific type of reaction. It has units of area, commonly expressed in barns ($\\mathrm{b}$), where $1\\,\\mathrm{b} = 10^{-24}\\,\\mathrm{cm^2}$. It is essentially a measure of the probability of the reaction occurring. The given value is $\\sigma = 0.5\\,\\mathrm{b}$.\n\nTo derive the reaction rate density, let's consider a thin, homogeneous slice of the material with a surface area $A$ and an infinitesimal thickness $dx$. The volume of this slice is $dV = A \\cdot dx$.\n\nThe total number of target nuclei within this volume slice is given by the product of the atomic number density and the volume:\n$$ \\text{Number of target nuclei} = N \\cdot dV = N A \\, dx $$\n\nEach of these nuclei presents an effective area $\\sigma$ for the activation reaction. Assuming the slab is thin enough that nuclei do not \"shadow\" each other, the total effective area for the reaction presented by all nuclei in the slice is:\n$$ \\text{Total effective area} = (N A \\, dx) \\cdot \\sigma $$\n\nThe neutron flux $\\phi$ represents the number of neutrons impinging on a unit area per unit time. Therefore, the total number of neutrons impinging on the area $A$ of our slice per unit time is $\\phi A$.\n\nThe reaction rate within the volume slice $dV$ is the product of the total number of incident neutrons per unit time and the fraction of the area that is \"covered\" by the effective target areas of the nuclei. This fractional area is the ratio of the total effective area to the total area $A$:\n$$ \\text{Fractional area} = \\frac{(N A \\, dx) \\sigma}{A} = N \\sigma \\, dx $$\nThis quantity, $N \\sigma \\, dx$, is the probability that a neutron transiting the thickness $dx$ will undergo the reaction.\n\nThe reaction rate (reactions per second) in the volume $dV$ is thus:\n$$ \\text{Reaction rate in } dV = (\\text{neutrons per second on } A) \\times (\\text{reaction probability per neutron}) $$\n$$ \\text{Reaction rate in } dV = (\\phi A) \\times (N \\sigma \\, dx) $$\n\nThe reaction rate density, which we will denote by $R$, is defined as the reaction rate per unit volume. To find this, we divide the reaction rate in our infinitesimal volume by the volume $dV$:\n$$ R = \\frac{\\text{Reaction rate in } dV}{dV} = \\frac{\\phi A N \\sigma \\, dx}{A \\, dx} = \\phi N \\sigma $$\n\nThis expression, $R = \\phi N \\sigma$, gives the rate of activation reactions per unit volume per unit time. The product $\\Sigma = N\\sigma$ is often called the macroscopic cross section, representing the probability of a reaction per unit path length of a neutron. Thus, $R = \\phi \\Sigma$.\n\nThe problem specifies that the material is initially free of activation products. In a general case where the activation product (with number density $N_p$ and decay constant $\\lambda_p$) is also decaying, the net rate of change of the product concentration is given by the Bateman equation for this simple chain:\n$$ \\frac{dN_p(t)}{dt} = (\\text{Formation Rate}) - (\\text{Decay Rate}) = \\phi N \\sigma - \\lambda_p N_p(t) $$\nThe initial rate of formation, at time $t=0$, is found by evaluating this expression with the initial condition $N_p(0) = 0$.\n$$ \\left. \\frac{dN_p}{dt} \\right|_{t=0} = \\phi N \\sigma - \\lambda_p N_p(0) = \\phi N \\sigma - 0 = \\phi N \\sigma $$\nThus, the initial activation rate density is precisely the reaction rate density $R = \\phi N \\sigma$.\n\nNow, we compute the numerical value using the provided data:\nGiven:\n- Neutron flux, $\\phi = 1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}$\n- Target atomic number density, $N = 8.0 \\times 10^{22}\\,\\mathrm{cm^{-3}}$\n- Microscopic cross section, $\\sigma = 0.5\\,\\mathrm{b}$\n\nFirst, we must convert the cross section from barns to $\\mathrm{cm}^2$:\n$$ \\sigma = 0.5\\,\\mathrm{b} \\times \\frac{10^{-24}\\,\\mathrm{cm^2}}{1\\,\\mathrm{b}} = 0.5 \\times 10^{-24}\\,\\mathrm{cm^2} $$\n\nNow, substitute the values into the derived formula for the reaction rate density $R$:\n$$ R = \\phi N \\sigma $$\n$$ R = (1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}) \\times (8.0 \\times 10^{22}\\,\\mathrm{cm^{-3}}) \\times (0.5 \\times 10^{-24}\\,\\mathrm{cm^2}) $$\n\nLet's first evaluate the numerical part:\n$$ 1.0 \\times 8.0 \\times 0.5 = 4.0 $$\nNext, let's evaluate the powers of $10$:\n$$ 10^{14} \\times 10^{22} \\times 10^{-24} = 10^{14+22-24} = 10^{12} $$\n\nCombining these results:\n$$ R = 4.0 \\times 10^{12} $$\n\nNow, let's verify the units:\n$$ (\\mathrm{cm^{-2}\\,s^{-1}}) \\times (\\mathrm{cm^{-3}}) \\times (\\mathrm{cm^2}) = \\mathrm{cm}^{-2-3+2}\\,\\mathrm{s^{-1}} = \\mathrm{cm^{-3}\\,s^{-1}} $$\nThe resulting units are $\\mathrm{cm^{-3}\\,s^{-1}}$, which correspond to reactions per unit volume per unit time, as required.\n\nThe problem requires the answer to be rounded to three significant figures. The calculated value is $4.0 \\times 10^{12}$. To express this with three significant figures, we write it as $4.00 \\times 10^{12}$.\n\nTherefore, the initial activation rate density is $4.00 \\times 10^{12}\\,\\mathrm{reactions\\,cm^{-3}\\,s^{-1}}$.",
            "answer": "$$\\boxed{4.00 \\times 10^{12}}$$"
        },
        {
            "introduction": "Building upon the initial activation rate, this practice  models a complete, realistic operational cycle involving both irradiation and subsequent cooling. You will apply the principles of activation kinetics to determine the inventory of a radioactive product at the moment of reactor shutdown and then track its decay over time. This exercise is crucial for developing the skills to predict decay heat, a critical parameter for fusion reactor safety analyses, maintenance planning, and waste management.",
            "id": "3946336",
            "problem": "A monoisotopic tungsten sample of mass $m=1.00\\,\\mathrm{kg}$ is placed in a fusion-relevant neutron environment with constant neutron flux $\\phi=1.0\\times 10^{14}\\,\\mathrm{n\\,cm^{-2}\\,s^{-1}}$ for an irradiation time $t_{\\mathrm{irr}}=1.0\\times 10^{5}\\,\\mathrm{s}$. An effective microscopic cross section for the $(n,2n)$ reaction is $\\sigma=0.20\\,\\mathrm{b}$, where $1\\,\\mathrm{b}=10^{-24}\\,\\mathrm{cm^{2}}$. This reaction produces a single dominant activation product that decays via a single channel with decay constant $\\lambda=1.0\\times 10^{-6}\\,\\mathrm{s^{-1}}$. Each decay deposits an average energy $E_{\\mathrm{dep}}=2.0\\,\\mathrm{MeV}$ locally in the material. Assume the following:\n- The neutron flux is spatially and temporally uniform over the sample during irradiation.\n- The number of target tungsten atoms remains effectively constant (negligible burn-up and transmutation depletion on the timescale considered).\n- The effective cross section $\\sigma$ and decay parameters are time-independent.\n- All decay energy $E_{\\mathrm{dep}}$ is deposited locally (no escape).\n- Only the single activation product contributes to decay heat.\n\nUse the Avogadro constant $N_{\\mathrm{A}}=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$, tungsten molar mass $M_{\\mathrm{W}}=183.84\\,\\mathrm{g\\,mol^{-1}}$, and the energy conversion $1\\,\\mathrm{eV}=1.602176634\\times 10^{-19}\\,\\mathrm{J}$.\n\nStarting from first principles for activation and decay kinetics, compute the instantaneous decay heat power at shutdown ($t=0^{+}$ after irradiation ends) and the decay heat power after a cooling time $t_{\\mathrm{cool}}=1.0\\times 10^{6}\\,\\mathrm{s}$. Express both answers in $\\mathrm{W}$, and round your answers to three significant figures. Provide the two answers as a pair in the order described.",
            "solution": "The decay heat power $P(t)$ at any time $t$ is the product of the activity of the sample, $A(t)$, and the energy deposited per decay, $E_{\\mathrm{dep}}$. The activity is defined as $A(t) = \\lambda N(t)$, where $N(t)$ is the number of radioactive nuclei at time $t$ and $\\lambda$ is the decay constant.\n$$\nP(t) = A(t)E_{\\mathrm{dep}} = \\lambda N(t) E_{\\mathrm{dep}}\n$$\nTo find the decay heat, we must first determine the number of activated nuclei, $N(t)$.\n\n**1. Activation during Irradiation**\nDuring the irradiation period, from $t=0$ to $t=t_{\\mathrm{irr}}$, the number of activated nuclei $N(t)$ changes due to production and decay. The rate of change is given by the following first-order linear ordinary differential equation:\n$$\n\\frac{dN(t)}{dt} = R_{\\mathrm{prod}} - \\lambda N(t)\n$$\nwhere $R_{\\mathrm{prod}}$ is the constant production rate of the activated species and $\\lambda N(t)$ is the decay rate. The production rate is the product of the total number of target tungsten atoms, $N_T$, the microscopic cross section for the $(n,2n)$ reaction, $\\sigma$, and the neutron flux, $\\phi$.\n$$\nR_{\\mathrm{prod}} = N_T\\sigma\\phi\n$$\nThe number of target atoms $N_T$ is calculated from the sample's mass $m$, molar mass $M_W$, and Avogadro's constant $N_A$.\n$$\nN_T = \\frac{m}{M_W}N_A\n$$\nThe differential equation for activation is:\n$$\n\\frac{dN(t)}{dt} + \\lambda N(t) = N_T\\sigma\\phi\n$$\nWith the initial condition $N(0)=0$ (no activated nuclei before irradiation), the solution to this equation is:\n$$\nN(t) = \\frac{N_T\\sigma\\phi}{\\lambda}\\left(1 - \\exp(-\\lambda t)\\right)\n$$\nAt the end of the irradiation period, at $t=t_{\\mathrm{irr}}$, the number of activated nuclei, which we denote as $N_{\\mathrm{shut}}$, is:\n$$\nN_{\\mathrm{shut}} = N(t_{\\mathrm{irr}}) = \\frac{N_T\\sigma\\phi}{\\lambda}\\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right)\n$$\n\n**2. Decay during Cooling**\nAfter irradiation stops at $t=t_{\\mathrm{irr}}$, the production term $R_{\\mathrm{prod}}$ becomes zero. Let $t'$ be the cooling time, with $t'=0$ corresponding to the moment of shutdown. The number of activated nuclei $N(t')$ during cooling is governed by pure radioactive decay:\n$$\n\\frac{dN(t')}{dt'} = -\\lambda N(t')\n$$\nThe initial condition for this phase is $N(t'=0) = N_{\\mathrm{shut}}$. The solution is:\n$$\nN(t') = N_{\\mathrm{shut}}\\exp(-\\lambda t') = \\frac{N_T\\sigma\\phi}{\\lambda}\\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right)\\exp(-\\lambda t')\n$$\n\n**3. Decay Heat Power Calculation**\nThe decay heat power at a cooling time $t' = t_{\\mathrm{cool}}$ is given by:\n$$\nP(t_{\\mathrm{cool}}) = \\lambda N(t_{\\mathrm{cool}}) E_{\\mathrm{dep}} = N_T\\sigma\\phi E_{\\mathrm{dep}} \\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right)\\exp(-\\lambda t_{\\mathrm{cool}})\n$$\n\n**4. Numerical Evaluation**\nFirst, we convert all given values to a consistent set of units (SI units where appropriate).\n- $m = 1.00\\,\\mathrm{kg} = 1000\\,\\mathrm{g}$\n- $\\sigma = 0.20\\,\\mathrm{b} = 0.20 \\times 10^{-24}\\,\\mathrm{cm^2} = 2.0 \\times 10^{-25}\\,\\mathrm{cm^2}$\n- $\\phi = 1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}$\n- $E_{\\mathrm{dep}} = 2.0\\,\\mathrm{MeV} = 2.0 \\times 10^6\\,\\mathrm{eV} \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 3.204353268 \\times 10^{-13}\\,\\mathrm{J}$\n\nThe number of target tungsten atoms is:\n$$\nN_T = \\frac{1000\\,\\mathrm{g}}{183.84\\,\\mathrm{g\\,mol^{-1}}} \\times (6.02214076 \\times 10^{23}\\,\\mathrm{mol^{-1}}) \\approx 3.2758 \\times 10^{24}\\,\\text{atoms}\n$$\nThe overall production rate of decay heat at saturation ($t_{\\mathrm{irr}} \\to \\infty$) is the coefficient $P_{\\mathrm{sat}} = N_T\\sigma\\phi E_{\\mathrm{dep}}$:\n$$\nP_{\\mathrm{sat}} = (3.2758 \\times 10^{24}) \\times (2.0 \\times 10^{-25}\\,\\mathrm{cm^{2}}) \\times (1.0 \\times 10^{14}\\,\\mathrm{cm^{-2}\\,s^{-1}}) \\times (3.20435... \\times 10^{-13}\\,\\mathrm{J}) \\approx 20.993\\,\\mathrm{W}\n$$\nThe exponential arguments are:\n- $\\lambda t_{\\mathrm{irr}} = (1.0 \\times 10^{-6}\\,\\mathrm{s^{-1}}) \\times (1.0 \\times 10^{5}\\,\\mathrm{s}) = 0.1$\n- $\\lambda t_{\\mathrm{cool}} = (1.0 \\times 10^{-6}\\,\\mathrm{s^{-1}}) \\times (1.0 \\times 10^{6}\\,\\mathrm{s}) = 1.0$\n\n**Power at Shutdown ($t_{\\mathrm{cool}}=0$)**\nThe decay heat power at shutdown, $P_{\\mathrm{shut}}$, is found by setting $t_{\\mathrm{cool}}=0$, so $\\exp(-\\lambda t_{\\mathrm{cool}})=1$.\n$$\nP_{\\mathrm{shut}} = P_{\\mathrm{sat}} \\left(1 - \\exp(-\\lambda t_{\\mathrm{irr}})\\right) = 20.993\\,\\mathrm{W} \\times \\left(1 - \\exp(-0.1)\\right)\n$$\n$$\nP_{\\mathrm{shut}} \\approx 20.993 \\times (1 - 0.904837) = 20.993 \\times 0.095163 \\approx 1.9978\\,\\mathrm{W}\n$$\nRounding to three significant figures, $P_{\\mathrm{shut}} = 2.00\\,\\mathrm{W}$.\n\n**Power after Cooling ($t_{\\mathrm{cool}}=1.0\\times 10^{6}\\,\\mathrm{s}$)**\nThe decay heat power after the cooling time, $P_{\\mathrm{cool}}$, is:\n$$\nP_{\\mathrm{cool}} = P_{\\mathrm{shut}} \\exp(-\\lambda t_{\\mathrm{cool}}) = 1.9978\\,\\mathrm{W} \\times \\exp(-1.0)\n$$\n$$\nP_{\\mathrm{cool}} \\approx 1.9978 \\times 0.367879 \\approx 0.7350\\,\\mathrm{W}\n$$\nRounding to three significant figures, $P_{\\mathrm{cool}} = 0.735\\,\\mathrm{W}$.\nThe two requested values are the decay heat at shutdown and after the specified cooling time.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.00 & 0.735 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While analytical solutions are powerful for simple cases, modeling activation in real fusion systems—with hundreds of nuclides and complex operational histories—requires robust numerical solvers. This advanced practice  bridges theory and computation by tasking you with verifying a numerical solver against exact Bateman equation solutions. Engaging in this exercise will provide essential experience in the critical process of Verification and Validation (V), ensuring that the computational tools used for complex safety calculations are accurate and reliable.",
            "id": "3946331",
            "problem": "Consider the time evolution of nuclide inventories in a material exposed to neutron irradiation and subsequent cooling. The governing equations are linear Ordinary Differential Equations (ODE) derived from first principles: radioactive decay and constant-rate activation. Let $N_i(t)$ denote the number of atoms of nuclide $i$ at time $t$, and let $\\lambda_i$ be its decay constant, defined by $\\lambda_i = \\ln(2)/T_{1/2,i}$, where $T_{1/2,i}$ is the half-life expressed in seconds. The activity $A_i(t)$ of nuclide $i$ is $A_i(t) = \\lambda_i N_i(t)$. The decay heat power $P(t)$ in Watts is computed as $P(t) = \\sum_i \\lambda_i N_i(t) Q_i^{\\mathrm{J}}$, with $Q_i^{\\mathrm{J}}$ the average energy released per decay expressed in Joules, obtained from the specified average decay energy $Q_i^{\\mathrm{MeV}}$ (mega-electron-volt) via $Q_i^{\\mathrm{J}} = Q_i^{\\mathrm{MeV}} \\times 10^{6} \\times 1.602176634 \\times 10^{-19}$. Assume constant neutron flux and cross section during irradiation so that the activation source term into a parent nuclide is constant.\n\nThe fundamental base for model construction is:\n- Radioactive decay of a single nuclide: $dN/dt = -\\lambda N$.\n- Radioactive decay chain from nuclide $A$ to nuclide $B$: $dN_A/dt = -\\lambda_A N_A$, $dN_B/dt = \\lambda_A N_A - \\lambda_B N_B$.\n- Constant-rate activation source $S_A$ feeding nuclide $A$ during irradiation: $dN_A/dt = S_A - \\lambda_A N_A$, with $S_A = \\sigma \\phi N_T$, where $\\sigma$ is the microscopic cross section, $\\phi$ is the neutron flux, and $N_T$ is the number of target atoms. The cooling phase sets $S_A = 0$.\n\nUsing these fundamentals, construct a verification test for a chosen first-order implicit time integration scheme. The goal is to assess convergence against known exact Bateman solutions for three scenarios. Define the numerical scheme by applying backward Euler to the linear system $d\\mathbf{N}/dt = \\mathbf{A}\\mathbf{N} + \\mathbf{s}$ with constant $\\mathbf{A}$ and piecewise constant $\\mathbf{s}$. The backward Euler update from time $t_n$ to $t_{n+1} = t_n + \\Delta t$ is $(\\mathbf{I} - \\Delta t \\,\\mathbf{A}) \\mathbf{N}_{n+1} = \\mathbf{N}_n + \\Delta t \\,\\mathbf{s}$, where $\\mathbf{I}$ is the identity. Use uniform time steps $\\Delta t$ that exactly partition each scenario’s interval(s).\n\nFor each scenario below, compute at the specified final time: (i) the inventory of each modeled nuclide and (ii) the total decay heat power. For each quantity, estimate the observed order of accuracy by comparing the relative error between numerical results and exact Bateman solutions at three decreasing time steps $\\Delta t_1 > \\Delta t_2 > \\Delta t_3$. Define the relative error for a quantity $X$ at $\\Delta t$ as $e(\\Delta t) = |X_{\\mathrm{num}} - X_{\\mathrm{exact}}| / \\max(|X_{\\mathrm{exact}}|, \\epsilon)$ with $\\epsilon = 10^{-30}$, and estimate the order $p$ by averaging the two local orders $p_{12} = \\ln(e(\\Delta t_1)/e(\\Delta t_2))/\\ln(\\Delta t_1/\\Delta t_2)$ and $p_{23} = \\ln(e(\\Delta t_2)/e(\\Delta t_3))/\\ln(\\Delta t_2/\\Delta t_3)$.\n\nScenarios and parameters (all numbers are in the International System of Units (SI) unless otherwise stated):\n\n- Scenario $1$ (pure decay, single nuclide):\n  - Initial condition: $N_0 = 10^{20}$ atoms.\n  - Half-life: $T_{1/2} = 1$ second, so $\\lambda = \\ln(2)/1$.\n  - Average decay energy: $Q^{\\mathrm{MeV}} = 0.5$.\n  - Final time: $t_{\\mathrm{f}} = 10$ seconds.\n  - Time steps: $\\Delta t_1 = 1.0$ seconds, $\\Delta t_2 = 0.5$ seconds, $\\Delta t_3 = 0.25$ seconds.\n\n- Scenario $2$ (two-nuclide decay chain without source):\n  - Initial conditions: $N_A(0) = 10^{19}$ atoms, $N_B(0) = 0$ atoms.\n  - Half-lives: $T_{1/2,A} = 5$ seconds, $T_{1/2,B} = 20$ seconds, so $\\lambda_A = \\ln(2)/5$, $\\lambda_B = \\ln(2)/20$.\n  - Average decay energies: $Q_A^{\\mathrm{MeV}} = 0.3$, $Q_B^{\\mathrm{MeV}} = 0.8$.\n  - Final time: $t_{\\mathrm{f}} = 50$ seconds.\n  - Time steps: $\\Delta t_1 = 2.0$ seconds, $\\Delta t_2 = 1.0$ seconds, $\\Delta t_3 = 0.5$ seconds.\n\n- Scenario $3$ (irradiation and cooling, activation source feeding parent $A$, two-nuclide chain $A \\rightarrow B \\rightarrow$ stable):\n  - Initial conditions: $N_A(0) = 0$ atoms, $N_B(0) = 0$ atoms.\n  - Activation source: $S_A = \\sigma \\phi N_T$ with $\\sigma = 10^{-24}$ square centimeters (one barn), $\\phi = 10^{14}$ neutrons per square centimeter per second, $N_T = 10^{22}$ atoms, so $S_A = 10^{12}$ atoms per second during irradiation and $S_A = 0$ during cooling.\n  - Half-lives: $T_{1/2,A} = 50$ seconds, $T_{1/2,B} = 200$ seconds, so $\\lambda_A = \\ln(2)/50$, $\\lambda_B = \\ln(2)/200$.\n  - Average decay energies: $Q_A^{\\mathrm{MeV}} = 0.4$, $Q_B^{\\mathrm{MeV}} = 1.2$.\n  - Irradiation time: $t_{\\mathrm{irr}} = 100$ seconds, then cooling to final time $t_{\\mathrm{f}} = 300$ seconds.\n  - Time steps: $\\Delta t_1 = 5.0$ seconds, $\\Delta t_2 = 2.5$ seconds, $\\Delta t_3 = 1.25$ seconds.\n\nRequirements for the program:\n- Implement the backward Euler scheme for the linear system $d\\mathbf{N}/dt = \\mathbf{A}\\mathbf{N} + \\mathbf{s}$ with piecewise constant $\\mathbf{s}$ as specified.\n- For each scenario, compute the exact solutions (Bateman solutions) at the required times for comparison.\n- Compute the observed order of accuracy $p$ for each of the following quantities:\n  - Scenario $1$: final inventory $N(t_{\\mathrm{f}})$ and final decay heat power $P(t_{\\mathrm{f}})$.\n  - Scenario $2$: final inventories $N_A(t_{\\mathrm{f}})$, $N_B(t_{\\mathrm{f}})$, and final total decay heat power $P(t_{\\mathrm{f}})$.\n  - Scenario $3$: final inventories $N_A(t_{\\mathrm{f}})$, $N_B(t_{\\mathrm{f}})$, and final total decay heat power $P(t_{\\mathrm{f}})$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the exact order: $[p_{1,N}, p_{1,P}, p_{2,N_A}, p_{2,N_B}, p_{2,P}, p_{3,N_A}, p_{3,N_B}, p_{3,P}]$. All entries must be Python float values. The decay heat power is by construction computed in Watts, but only the dimensionless observed orders $p$ are to be printed.\n\nNo external input is permitted. The problem must be solved entirely within the program. Ensure scientific realism and self-consistency of the parameters. The mathematical derivations used to obtain exact solutions and the numerical scheme must follow from the above fundamental base and not rely on shortcut formulas provided directly in the problem statement.",
            "solution": "The problem requires the verification of a first-order implicit time integration scheme, Backward Euler, for solving the Ordinary Differential Equations (ODEs) that govern nuclide activation and decay. The verification is performed by comparing the numerical results against known exact analytical solutions for three distinct scenarios. The primary metric for this verification is the observed order of accuracy, which is expected to be close to $1$ for a first-order method.\n\nThe time evolution of the number of atoms for a set of nuclides, represented by the vector $\\mathbf{N}(t)$, is described by a system of linear first-order ODEs with constant coefficients:\n$$\n\\frac{d\\mathbf{N}(t)}{dt} = \\mathbf{A}\\mathbf{N}(t) + \\mathbf{s}\n$$\nHere, $\\mathbf{N}(t)$ is the vector of nuclide inventories $[N_1(t), N_2(t), \\dots]^T$. The matrix $\\mathbf{A}$ contains the decay constants ($\\lambda_i$) and branching ratios, representing the rates of transmutation and decay. The vector $\\mathbf{s}$ represents constant external sources, such as those from neutron-induced activation reactions.\n\nThe Backward Euler method discretizes this ODE system in time. Given a time step $\\Delta t$, the state at time $t_{n+1} = t_n + \\Delta t$ is approximated from the state at time $t_n$ by evaluating the derivative at the new time point $t_{n+1}$:\n$$\n\\frac{\\mathbf{N}_{n+1} - \\mathbf{N}_n}{\\Delta t} = \\mathbf{A}\\mathbf{N}_{n+1} + \\mathbf{s}\n$$\nRearranging this equation gives the update rule, which requires solving a linear system for $\\mathbf{N}_{n+1}$:\n$$\n(\\mathbf{I} - \\Delta t \\mathbf{A}) \\mathbf{N}_{n+1} = \\mathbf{N}_n + \\Delta t \\mathbf{s}\n$$\nwhere $\\mathbf{I}$ is the identity matrix. This system is solved at each time step to advance the solution.\n\nThe total decay heat power $P(t)$ in Watts is calculated from the nuclide inventories $N_i(t)$ and their respective activities $A_i(t) = \\lambda_i N_i(t)$:\n$$\nP(t) = \\sum_i A_i(t) Q_i^{\\mathrm{J}} = \\sum_i \\lambda_i N_i(t) Q_i^{\\mathrm{J}}\n$$\nwhere $Q_i^{\\mathrm{J}}$ is the average energy per decay in Joules, converted from the given energy in Mega-electron-volts ($Q_i^{\\mathrm{MeV}}$) using the conversion factor $1 \\text{ MeV} = 10^6 \\times 1.602176634 \\times 10^{-19} \\text{ J}$. The decay constant $\\lambda_i$ is related to the half-life $T_{1/2,i}$ by $\\lambda_i = \\ln(2) / T_{1/2,i}$.\n\nTo assess the accuracy, we compare the numerical solution ($X_{\\mathrm{num}}$) with the exact solution ($X_{\\mathrm{exact}}$) using the relative error $e(\\Delta t)$:\n$$\ne(\\Delta t) = \\frac{|X_{\\mathrm{num}} - X_{\\mathrm{exact}}|}{\\max(|X_{\\mathrm{exact}}|, \\epsilon)}\n$$\nwith a small flooring value $\\epsilon = 10^{-30}$ to prevent division by zero. The observed order of accuracy $p$ is estimated from results at three time steps $\\Delta t_1 > \\Delta t_2 > \\Delta t_3$, where the step size is halved each time ($\\Delta t_1 = 2\\Delta t_2 = 4\\Delta t_3$). It is the average of two local order estimates:\n$$\np = \\frac{1}{2} \\left( p_{12} + p_{23} \\right) \\quad \\text{where} \\quad p_{12} = \\frac{\\ln(e(\\Delta t_1)/e(\\Delta t_2))}{\\ln(\\Delta t_1/\\Delta t_2)}, \\quad p_{23} = \\frac{\\ln(e(\\Delta t_2)/e(\\Delta t_3))}{\\ln(\\Delta t_2/\\Delta t_3)}\n$$\n\nBelow we detail the specific formulation for each scenario.\n\n### Scenario 1: Pure Decay of a Single Nuclide\nThis scenario models the decay of a single nuclide with no source.\n- **Governing Equation**: $dN/dt = -\\lambda N$, with initial condition $N(0) = N_0 = 10^{20}$ atoms.\n- **System Matrices**: $\\mathbf{N} = [N]$, $\\mathbf{A} = [-\\lambda]$, $\\mathbf{s} = [0]$.\n- **Exact Solution**: The solution is an exponential decay:\n$$\nN(t) = N_0 e^{-\\lambda t}\n$$\n- **Numerical Implementation**: The Backward Euler update is $N_{n+1} = N_n / (1 + \\lambda \\Delta t)$.\n- **Parameters**: $\\lambda = \\ln(2)/1.0 \\text{ s}^{-1}$, $t_f = 10$ s.\n\n### Scenario 2: Two-Nuclide Decay Chain\nThis scenario models the decay chain $A \\rightarrow B \\rightarrow \\text{stable}$ without an external source.\n- **Governing Equations**:\n$$\n\\frac{dN_A}{dt} = -\\lambda_A N_A\n$$\n$$\n\\frac{dN_B}{dt} = \\lambda_A N_A - \\lambda_B N_B\n$$\n- **System Matrices**: $\\mathbf{N} = [N_A, N_B]^T$, $\\mathbf{s} = [0, 0]^T$, and $\\mathbf{A} = \\begin{pmatrix} -\\lambda_A & 0 \\\\ \\lambda_A & -\\lambda_B \\end{pmatrix}$.\n- **Exact Solution (Bateman Equations)**: For initial conditions $N_A(0)$ and $N_B(0)=0$, and assuming $\\lambda_A \\neq \\lambda_B$:\n$$\nN_A(t) = N_A(0) e^{-\\lambda_A t}\n$$\n$$\nN_B(t) = \\frac{\\lambda_A N_A(0)}{\\lambda_B - \\lambda_A} (e^{-\\lambda_A t} - e^{-\\lambda_B t})\n$$\n- **Numerical Implementation**: The system $(\\mathbf{I} - \\Delta t \\mathbf{A}) \\mathbf{N}_{n+1} = \\mathbf{N}_n$ is solved. Since the matrix is lower-triangular, this is done efficiently via forward substitution.\n- **Parameters**: $N_A(0) = 10^{19}$, $N_B(0)=0$, $\\lambda_A = \\ln(2)/5 \\text{ s}^{-1}$, $\\lambda_B = \\ln(2)/20 \\text{ s}^{-1}$, $t_f = 50$ s.\n\n### Scenario 3: Irradiation and Cooling\nThis scenario involves activation creating nuclide $A$, which then decays to $B$ ($A \\rightarrow B \\rightarrow \\text{stable}$), over two phases: an irradiation period with a constant source followed by a cooling period with no source.\n- **Governing Equations (Irradiation, $0 \\le t \\le t_{irr}$)**:\n$$\n\\frac{dN_A}{dt} = S_A - \\lambda_A N_A\n$$\n$$\n\\frac{dN_B}{dt} = \\lambda_A N_A - \\lambda_B N_B\n$$\nHere, $\\mathbf{s} = [S_A, 0]^T$ with $S_A = 10^{12} \\text{ atoms/s}$. For the cooling phase ($t > t_{irr}$), $S_A=0$, and the equations are identical to Scenario 2.\n- **Exact Solution**:\n  1.  **Irradiation Phase ($0 \\le t \\le t_{irr}$)**: With initial conditions $N_A(0)=0, N_B(0)=0$ and $\\lambda_A \\neq \\lambda_B$:\n      $$\n      N_A(t) = \\frac{S_A}{\\lambda_A}(1 - e^{-\\lambda_A t})\n      $$\n      $$\n      N_B(t) = S_A \\left( \\frac{1-e^{-\\lambda_B t}}{\\lambda_B} - \\frac{e^{-\\lambda_A t}-e^{-\\lambda_B t}}{\\lambda_B - \\lambda_A} \\right)\n      $$\n      We first compute inventories at the end of irradiation, $N_A(t_{irr})$ and $N_B(t_{irr})$.\n  2.  **Cooling Phase ($t' = t - t_{irr}$, for $0 < t' \\le t_f - t_{irr}$)**: These inventories serve as initial conditions for the cooling phase, which is a pure decay problem.\n      $$\n      N_A(t) = N_A(t_{irr}) e^{-\\lambda_A (t - t_{irr})}\n      $$\n      $$\n      N_B(t) = \\frac{\\lambda_A N_A(t_{irr})}{\\lambda_B - \\lambda_A} (e^{-\\lambda_A (t-t_{irr})} - e^{-\\lambda_B (t-t_{irr})}) + N_B(t_{irr}) e^{-\\lambda_B (t-t_{irr})}\n      $$\n- **Numerical Implementation**: The simulation is run in two stages. First, the solver iterates for $t_{irr}/\\Delta t$ steps with the source term $\\mathbf{s} = [S_A, 0]^T$. Then, using the resulting inventories as the initial state, it continues for an additional $(t_f - t_{irr})/\\Delta t$ steps with the source term set to zero, $\\mathbf{s} = [0, 0]^T$.\n- **Parameters**: $N_A(0)=0, N_B(0)=0$, $S_A=10^{12} \\text{ atoms/s}$, $\\lambda_A=\\ln(2)/50 \\text{ s}^{-1}$, $\\lambda_B=\\ln(2)/200 \\text{ s}^{-1}$, $t_{irr}=100$ s, $t_f=300$ s.\n\nThe code implements these analytical solutions and the generalized Backward Euler solver. For each scenario, it calculates the nuclide inventories and decay heat at the final time using both methods for three different time steps. It then computes the relative errors and finally estimates the order of accuracy for each required quantity. As expected for the Backward Euler method, the observed orders should be approximately $1.0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Global constants\nLOG2 = np.log(2)\nEV_TO_J = 1.602176634e-19\nMEV_TO_J = EV_TO_J * 1e6\nEPSILON = 1e-30 # For relative error calculation\n\ndef run_numerical_solver(N0, A_matrix, s_vector, t_final, dt):\n    \"\"\"\n    Solves dN/dt = A*N + s using the Backward Euler method.\n    \"\"\"\n    if dt == 0 or t_final == 0:\n        return np.copy(N0)\n    num_steps = round(t_final / dt)\n    N = np.copy(N0)\n    I = np.identity(len(N0))\n    \n    M = I - dt * A_matrix\n    \n    for _ in range(num_steps):\n        b = N + dt * s_vector\n        N = np.linalg.solve(M, b)\n        \n    return N\n\ndef get_rel_error(num_val, exact_val):\n    \"\"\"Calculates relative error.\"\"\"\n    return np.abs(num_val - exact_val) / np.max([np.abs(exact_val), EPSILON])\n\ndef calculate_order(errors, dts):\n    \"\"\"Calculates the observed order of accuracy.\"\"\"\n    dt_ratio12 = dts[0] / dts[1]\n    dt_ratio23 = dts[1] / dts[2]\n    \n    # Handle cases where error is near zero, which may give unstable p\n    if errors[0] < EPSILON or errors[1] < EPSILON:\n        p12 = 0.0 # Cannot determine order, assume it's not converging as expected\n    else:\n        p12 = np.log(errors[0] / errors[1]) / np.log(dt_ratio12)\n    \n    if errors[1] < EPSILON or errors[2] < EPSILON:\n        p23 = 0.0\n    else:\n        p23 = np.log(errors[1] / errors[2]) / np.log(dt_ratio23)\n\n    return (p12 + p23) / 2.0\n\ndef scenario_1():\n    \"\"\"Handler for Scenario 1: Pure Decay.\"\"\"\n    N0_val = 1e20\n    T_half = 1.0\n    Q_MeV = 0.5\n    t_f = 10.0\n    dts = [1.0, 0.5, 0.25]\n    \n    lam = LOG2 / T_half\n    Q_J = Q_MeV * MEV_TO_J\n    \n    # Analytical solution\n    N_exact = N0_val * np.exp(-lam * t_f)\n    P_exact = lam * N_exact * Q_J\n    \n    errors_N = []\n    errors_P = []\n    \n    # System definition\n    N0 = np.array([N0_val])\n    A = np.array([[-lam]])\n    s = np.array([0.0])\n    \n    for dt in dts:\n        N_final_num = run_numerical_solver(N0, A, s, t_f, dt)\n        N_num = N_final_num[0]\n        P_num = lam * N_num * Q_J\n        \n        errors_N.append(get_rel_error(N_num, N_exact))\n        errors_P.append(get_rel_error(P_num, P_exact))\n        \n    p_N = calculate_order(errors_N, dts)\n    p_P = calculate_order(errors_P, dts)\n    \n    return [p_N, p_P]\n\ndef scenario_2():\n    \"\"\"Handler for Scenario 2: Two-Nuclide Decay Chain.\"\"\"\n    NA0_val = 1e19\n    NB0_val = 0.0\n    T_half_A = 5.0\n    T_half_B = 20.0\n    Q_A_MeV = 0.3\n    Q_B_MeV = 0.8\n    t_f = 50.0\n    dts = [2.0, 1.0, 0.5]\n    \n    lam_A = LOG2 / T_half_A\n    lam_B = LOG2 / T_half_B\n    Q_A_J = Q_A_MeV * MEV_TO_J\n    Q_B_J = Q_B_MeV * MEV_TO_J\n    \n    # Analytical solution\n    NA_exact = NA0_val * np.exp(-lam_A * t_f)\n    if np.abs(lam_A - lam_B) < EPSILON:\n        NB_exact = lam_A * NA0_val * t_f * np.exp(-lam_A * t_f)\n    else:\n        term1 = lam_A / (lam_B - lam_A) * NA0_val\n        term2 = np.exp(-lam_A * t_f) - np.exp(-lam_B * t_f)\n        NB_exact = term1 * term2\n    P_exact = lam_A * NA_exact * Q_A_J + lam_B * NB_exact * Q_B_J\n    \n    errors_NA = []\n    errors_NB = []\n    errors_P = []\n\n    # System definition\n    N0 = np.array([NA0_val, NB0_val])\n    A = np.array([[-lam_A, 0.0], [lam_A, -lam_B]])\n    s = np.array([0.0, 0.0])\n    \n    for dt in dts:\n        N_final_num = run_numerical_solver(N0, A, s, t_f, dt)\n        NA_num, NB_num = N_final_num\n        P_num = lam_A * NA_num * Q_A_J + lam_B * NB_num * Q_B_J\n        \n        errors_NA.append(get_rel_error(NA_num, NA_exact))\n        errors_NB.append(get_rel_error(NB_num, NB_exact))\n        errors_P.append(get_rel_error(P_num, P_exact))\n        \n    p_NA = calculate_order(errors_NA, dts)\n    p_NB = calculate_order(errors_NB, dts)\n    p_P = calculate_order(errors_P, dts)\n    \n    return [p_NA, p_NB, p_P]\n\ndef scenario_3():\n    \"\"\"Handler for Scenario 3: Irradiation and Cooling.\"\"\"\n    S_A = 1e12\n    T_half_A, T_half_B = 50.0, 200.0\n    Q_A_MeV, Q_B_MeV = 0.4, 1.2\n    t_irr, t_f = 100.0, 300.0\n    dts = [5.0, 2.5, 1.25]\n    \n    t_cool = t_f - t_irr\n    lam_A = LOG2 / T_half_A\n    lam_B = LOG2 / T_half_B\n    Q_A_J = Q_A_MeV * MEV_TO_J\n    Q_B_J = Q_B_MeV * MEV_TO_J\n\n    # Analytical solution\n    # Phase 1: Irradiation\n    NA_irr = (S_A / lam_A) * (1 - np.exp(-lam_A * t_irr))\n    if np.abs(lam_A - lam_B) < EPSILON:\n        # Not applicable here, but for completeness\n        NB_irr = S_A * (1 - (1 + lam_A * t_irr)*np.exp(-lam_A * t_irr)) / lam_A\n    else:    \n        term1_NB = S_A * (1 - np.exp(-lam_B * t_irr)) / lam_B\n        term2_NB = S_A * (np.exp(-lam_A * t_irr) - np.exp(-lam_B * t_irr)) / (lam_B - lam_A)\n        NB_irr = term1_NB - term2_NB\n\n    # Phase 2: Cooling\n    NA_exact = NA_irr * np.exp(-lam_A * t_cool)\n    if np.abs(lam_A - lam_B) < EPSILON:\n        # Not applicable here\n        NB_exact = (NB_irr + lam_A * NA_irr * t_cool) * np.exp(-lam_A * t_cool)\n    else:\n        term1 = lam_A / (lam_B - lam_A) * NA_irr\n        term2 = np.exp(-lam_A * t_cool) - np.exp(-lam_B * t_cool)\n        NB_exact = term1 * term2 + NB_irr * np.exp(-lam_B * t_cool)\n    \n    P_exact = lam_A * NA_exact * Q_A_J + lam_B * NB_exact * Q_B_J\n\n    errors_NA, errors_NB, errors_P = [], [], []\n\n    # System definition (A matrix is constant)\n    N0 = np.array([0.0, 0.0])\n    A = np.array([[-lam_A, 0.0], [lam_A, -lam_B]])\n    s_irr = np.array([S_A, 0.0])\n    s_cool = np.array([0.0, 0.0])\n\n    for dt in dts:\n        # Numerical solution\n        N_at_irr_end = run_numerical_solver(N0, A, s_irr, t_irr, dt)\n        N_final_num = run_numerical_solver(N_at_irr_end, A, s_cool, t_cool, dt)\n        NA_num, NB_num = N_final_num\n        P_num = lam_A * NA_num * Q_A_J + lam_B * NB_num * Q_B_J\n\n        errors_NA.append(get_rel_error(NA_num, NA_exact))\n        errors_NB.append(get_rel_error(NB_num, NB_exact))\n        errors_P.append(get_rel_error(P_num, P_exact))\n        \n    p_NA = calculate_order(errors_NA, dts)\n    p_NB = calculate_order(errors_NB, dts)\n    p_P = calculate_order(errors_P, dts)\n    \n    return [p_NA, p_NB, p_P]\n\ndef solve():\n    \"\"\"\n    Main function to run all scenarios and print the results.\n    \"\"\"\n    results_s1 = scenario_1()\n    results_s2 = scenario_2()\n    results_s3 = scenario_3()\n    \n    all_results = results_s1 + results_s2 + results_s3\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```"
        }
    ]
}