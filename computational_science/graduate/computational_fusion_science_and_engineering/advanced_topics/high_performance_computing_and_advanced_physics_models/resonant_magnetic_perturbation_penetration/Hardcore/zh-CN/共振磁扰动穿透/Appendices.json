{
    "hands_on_practices": [
        {
            "introduction": "在我们研究等离子体对共振磁扰动（RMP）的响应之前，我们必须首先了解如何精确地产生所需的外部磁场。本练习将引导你完成一项实际任务：将RMP线圈中的电流与它们在等离子体边缘产生的真空磁场联系起来。这是一个在任何RMP实验中都至关重要的校准步骤，它连接了工程控制与核心物理现象。",
            "id": "4040824",
            "problem": "一个环向对称的托卡马克配备了一套谐振磁扰动（RMP）线圈，设计用于主要产生单一的环向谐波。考虑一个由$N$个相同线圈组成的线圈阵列，这些线圈均匀分布在环向角 $\\varphi_k = \\frac{2\\pi k}{N}$ 的位置上，其中 $k = 0, 1, \\dots, N-1$。通过将每个线圈的电流设置为\n$$\nI_k = I_0 \\cos\\big(n \\varphi_k - \\varphi_0\\big),\n$$\n驱动其产生纯粹的环向谐波$n$，其中 $I_0$ 是每个线圈共同的电流幅值，$\\varphi_0$ 是共同的相位。\n\n在真空（无等离子体响应）中，磁场满足麦克斯韦方程组 $\\nabla \\times \\mathbf{B} = \\mathbf{0}$ 和 $\\nabla \\cdot \\mathbf{B} = 0$，因此电流产生的磁场可以线性叠加，并且边缘径向场谐波可以展开为关于环向角的傅里叶级数。在95%极向磁通处的安全因子，记为 $q_{95}$，通过 $m/n \\approx q_{95}$ 确定了主导的谐振极向谐波 $m$，但对于本问题，不需要 $m$ 的精确值。一个校准实验测量了在 $q_{95}$ 处，线圈阵列的环向-$n$复数电流幅值与边缘径向磁场谐波幅值之间的真空传递函数。传递函数定义为复数比\n$$\nH \\equiv \\frac{\\delta b_r^{\\mathrm{vac}}(q_{95})}{I^{(n)}},\n$$\n其中 $I^{(n)}$ 是线圈阵列第$n$个环向电流分量的复傅里叶幅值，$\\delta b_r^{\\mathrm{vac}}(q_{95})$ 是在 $q_{95}$ 处的边缘径向场谐波的复幅值。对于您的设备和相位设置，测量值为\n$$\nH = h \\exp(i \\alpha), \\quad h = 1.85 \\times 10^{-7} \\ \\mathrm{T/A}, \\quad \\alpha = 28^{\\circ},\n$$\n其中相角 $\\alpha$ 以度为单位。\n\n您的任务是在 $q_{95}$ 处产生一个目标真空边缘径向场谐波幅值，其值为\n$$\n\\delta b_r^{\\mathrm{vac}}(q_{95}) = B_{\\mathrm{tgt}} = 1.34 \\times 10^{-3} \\ \\mathrm{T},\n$$\n且场相位与谐振条件对齐（即，一个实的正的复幅值）。假设：\n- 磁场响应与线圈电流呈线性关系。\n- 测量的传递函数 $H$ 适用于线圈阵列的 $n$ 次谐波电流幅值 $I^{(n)}$。\n- 线圈阵列在 $n = 3$ 的条件下运行，共有 $N = 12$ 个线圈。\n- 准静态操作（忽略电感动态），并忽略无源结构。\n\n从真空静磁方程和线圈电流分布的环向傅里叶分解出发，推导一个为达到目标 $B_{\\mathrm{tgt}}$ 所需的每个线圈的电流幅值 $I_0$ 的表达式，并根据给定参数计算其数值。将您的答案四舍五入到四位有效数字。最终电流以安培（A）为单位表示。",
            "solution": "首先对问题进行验证，以确保其科学上合理、内容自洽且提法恰当。\n\n### 第1步：提取已知条件\n- 线圈数量：$N = 12$\n- 线圈的环向位置：$\\varphi_k = \\frac{2\\pi k}{N}$，其中 $k = 0, 1, \\dots, N-1$\n- 第$k$个线圈中的电流：$I_k = I_0 \\cos(n \\varphi_k - \\varphi_0)$\n- 每个线圈的电流幅值：$I_0$\n- 共同相位：$\\varphi_0$\n- 目标环向谐波：$n = 3$\n- 真空磁场方程：$\\nabla \\times \\mathbf{B} = \\mathbf{0}$，$\\nabla \\cdot \\mathbf{B} = 0$\n- 传递函数定义：$H \\equiv \\frac{\\delta b_r^{\\mathrm{vac}}(q_{95})}{I^{(n)}}$\n- 电流的复傅里叶幅值：$I^{(n)}$\n- 真空边缘径向场的复幅值：$\\delta b_r^{\\mathrm{vac}}(q_{95})$\n- 测量的传递函数：$H = h \\exp(i \\alpha)$\n- 传递函数的模：$h = 1.85 \\times 10^{-7} \\ \\mathrm{T/A}$\n- 传递函数的相位：$\\alpha = 28^{\\circ}$\n- 目标真空边缘径向场幅值：$B_{\\mathrm{tgt}} = 1.34 \\times 10^{-3} \\ \\mathrm{T}$\n- 目标场的相位：实数且为正，意味着其复数表示为 $B_{\\mathrm{tgt}} \\exp(i \\cdot 0)$。\n- 假设：线性响应、准静态操作、可忽略的无源结构。\n\n### 第2步：使用提取的已知条件进行验证\n该问题设定在聚变装置中磁流体动力学和等离子体控制的既定框架内。所使用的概念——谐振磁扰动、傅里叶分解、安全因子和传递函数——在计算聚变科学中是标准的。物理和数学原理是合理的。提供的场强、线圈数量和传递函数模的数值对于托卡马克来说是物理上现实的。问题定义清晰，提供了所有必要的参数和明确的目标。它没有歧义、矛盾和主观内容。该问题需要离散傅里叶分析和复数操作的标准应用，代表了一项有效且不平凡的工程计算。\n\n### 第3步：结论与行动\n问题被确定为**有效**。将提供一个完整、合理的解答。\n\n### 解答推导\n目标是找到产生指定边缘径向磁场谐波幅值 $B_{\\mathrm{tgt}}$ 所需的每个线圈的电流幅值 $I_0$。解答需要将离散的线圈电流 $I_k$ 与总的电流复傅里叶幅值 $I^{(n)}$ 联系起来，然后使用提供的传递函数 $H$ 将 $I^{(n)}$ 与产生的磁场联系起来。\n\n首先，我们必须确定每个线圈的电流幅值 $I_0$ 与电流阵列的第$n$个环向谐波的复幅值 $I^{(n)}$ 之间的关系。总电流分布可以被看作是一组离散源。第$n$次谐波的复幅值通过执行离散傅里叶变换得到。来自一组$N$个离散源的第$n$次谐波的未归一化复幅值的标准定义是来自每个源的相量的相干和：\n$$\nI^{(n)} = \\sum_{k=0}^{N-1} I_k \\exp(-in\\varphi_k)\n$$\n$N$个线圈中每个线圈的电流由 $I_k = I_0 \\cos(n \\varphi_k - \\varphi_0)$ 给出。我们使用欧拉公式 $\\cos(x) = \\frac{\\exp(ix) + \\exp(-ix)}{2}$，将 $I_k$ 表示为复指数形式：\n$$\nI_k = I_0 \\frac{\\exp\\big(i(n\\varphi_k - \\varphi_0)\\big) + \\exp\\big(-i(n\\varphi_k - \\varphi_0)\\big)}{2} = \\frac{I_0}{2} \\left[ \\exp(-i\\varphi_0) \\exp(in\\varphi_k) + \\exp(i\\varphi_0) \\exp(-in\\varphi_k) \\right]\n$$\n将此代入 $I^{(n)}$ 的表达式中：\n$$\nI^{(n)} = \\sum_{k=0}^{N-1} \\frac{I_0}{2} \\left[ \\exp(-i\\varphi_0) \\exp(in\\varphi_k) + \\exp(i\\varphi_0) \\exp(-in\\varphi_k) \\right] \\exp(-in\\varphi_k)\n$$\n分配 $\\exp(-in\\varphi_k)$ 项并分离求和：\n$$\nI^{(n)} = \\frac{I_0}{2} \\left[ \\exp(-i\\varphi_0) \\sum_{k=0}^{N-1} \\exp\\big(i(n-n)\\varphi_k\\big) + \\exp(i\\varphi_0) \\sum_{k=0}^{N-1} \\exp\\big(-i(n+n)\\varphi_k\\big) \\right]\n$$\n$$\nI^{(n)} = \\frac{I_0}{2} \\left[ \\exp(-i\\varphi_0) \\sum_{k=0}^{N-1} \\exp(0) + \\exp(i\\varphi_0) \\sum_{k=0}^{N-1} \\exp(-i2n\\varphi_k) \\right]\n$$\n第一个和是 $\\sum_{k=0}^{N-1} 1 = N$。第二个和是形式为 $\\sum_{k=0}^{N-1} (r)^k$ 的几何级数，其中 $r = \\exp(-i2n \\frac{2\\pi}{N})$。如果 $r=1$（即指数的参数是 $2\\pi i$ 的整数倍），则该级数的和为 $N$，否则为 $0$。在这里，如果 $2n/N$ 是整数，则 $r=1$。\n使用给定值 $n=3$ 和 $N=12$，我们得到 $2n/N = 6/12 = 1/2$，这不是一个整数。因此，第二个和为零。\n$$\n\\sum_{k=0}^{N-1} \\exp(-i2n\\varphi_k) = \\sum_{k=0}^{N-1} \\exp\\left(-i \\frac{4\\pi n k}{N}\\right) = 0\n$$\n因此，$I^{(n)}$ 的表达式简化为：\n$$\nI^{(n)} = \\frac{I_0}{2} \\left[ \\exp(-i\\varphi_0) \\cdot N + \\exp(i\\varphi_0) \\cdot 0 \\right] = \\frac{N I_0}{2} \\exp(-i\\varphi_0)\n$$\n现在，我们使用传递函数 $H = \\frac{\\delta b_r^{\\mathrm{vac}}}{I^{(n)}}$ 将电流与磁场关联起来。\n$$\n\\delta b_r^{\\mathrm{vac}} = H \\cdot I^{(n)}\n$$\n代入 $H$ 和 $I^{(n)}$ 的复数形式：\n$$\n\\delta b_r^{\\mathrm{vac}} = \\big(h \\exp(i\\alpha)\\big) \\cdot \\left(\\frac{N I_0}{2} \\exp(-i\\varphi_0)\\right) = \\frac{N h I_0}{2} \\exp\\big(i(\\alpha - \\varphi_0)\\big)\n$$\n问题要求产生的场谐波 $\\delta b_r^{\\mathrm{vac}}$ 是一个等于 $B_{\\mathrm{tgt}}$ 的实数、正数量。这对复数表达式的相位施加了一个条件。\n$$\n\\delta b_r^{\\mathrm{vac}} = B_{\\mathrm{tgt}}\n$$\n为使右侧为实数且为正，其复相位必须为零。这要求 $\\exp\\big(i(\\alpha - \\varphi_0)\\big) = 1$，这意味着对于某个整数 $j$，$\\alpha - \\varphi_0 = 2\\pi j$。这确定了线圈电流必需的共同相位为 $\\varphi_0 = \\alpha = 28^{\\circ}$（或一个等效角）。\n在满足此相位条件的情况下，幅值之间的关系是：\n$$\nB_{\\mathrm{tgt}} = \\frac{N h I_0}{2}\n$$\n我们现在可以解出每个线圈的电流幅值 $I_0$：\n$$\nI_0 = \\frac{2 B_{\\mathrm{tgt}}}{N h}\n$$\n现在，我们代入给定的数值：\n- $B_{\\mathrm{tgt}} = 1.34 \\times 10^{-3} \\ \\mathrm{T}$\n- $N = 12$\n- $h = 1.85 \\times 10^{-7} \\ \\mathrm{T/A}$\n$$\nI_0 = \\frac{2 \\times (1.34 \\times 10^{-3})}{12 \\times (1.85 \\times 10^{-7})} = \\frac{2.68 \\times 10^{-3}}{2.22 \\times 10^{-6}} \\ \\mathrm{A}\n$$\n$$\nI_0 = \\frac{2.68}{2.22} \\times 10^3 \\ \\mathrm{A} \\approx 1207.207207... \\ \\mathrm{A}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\nI_0 \\approx 1207 \\ \\mathrm{A}\n$$\n最终答案是电流幅值 $I_0$ 的数值，单位为安培。",
            "answer": "$$\n\\boxed{1207}\n$$"
        },
        {
            "introduction": "有理面上复杂的等离子体响应可以通过一个简洁的电路类比来直观地理解。本练习将探讨共振层如何像一个具有电阻和电感的电路一样，抵抗外部施加的RMP场。通过这个模型，我们可以推导出磁场渗透的阈值条件，从而深刻理解等离子体的屏蔽机制。",
            "id": "4040848",
            "problem": "考虑一个位于半径为 $r_{s}$ 的单个有理面附近的柱形托卡马克平衡。施加了一个环向模数为 $n$ 的外部单螺旋共振磁扰动 (RMP)。该扰动在实验室参考系中是静态的，因此其实验室角频率为 $\\omega_{\\text{RMP}}=0$。等离子体以角频率 $\\omega_{E}$ 进行均匀的环向旋转，为驱动响应产生一个相对的螺旋频率 $\\omega=n\\,\\omega_{E}$。假设采用单流体磁流体力学 (MHD) 模型，并使用沿螺旋连接长度 $L_{\\parallel}$ 积分的广义欧姆定律的平行分量，结合麦克斯韦-法拉第定律，将共振层模拟为一个等效的单匝电路。在频域中，平行电场 $E_{\\parallel}$ 驱动一个屏蔽电流 $I$，该电流受到一个复阻抗 $Z=R+i\\,\\omega L$ 的作用，其中 $R=\\eta\\,L_{\\parallel}/A$ 是该层的等效电阻（$\\eta$ 是斯皮策电阻率，$A$ 是该层中平行电流可用的横截面积），$L=g\\,\\mu_{0}\\,L_{\\parallel}$ 是螺旋电流路径的等效自感（其中 $g$ 是一个无量纲几何因子，$\\mu_{0}$ 是真空磁导率）。所施加的线积分电动势 (EMF) 为 $E_{\\parallel}L_{\\parallel}$。\n\n将穿透阈值定义为最小施加平行电场幅值 $E_{\\parallel,\\text{th}}$，在该阈值下，屏蔽电流的幅值等于在有理面上抵消 RMP 的真空共振径向磁场所需的电流幅值。通过几何关系 $I_{\\text{sh}}=(2\\pi r_{s}/\\mu_{0})\\,b_{r}^{\\text{vac}}$ 来模拟所需的屏蔽电流，其中 $b_{r}^{\\text{vac}}$ 是 $r_{s}$ 处真空共振径向磁场的幅值。\n\n给定以下参数：\n- $r_{s}=1.6\\,\\mathrm{m}$，\n- $L_{\\parallel}=25\\,\\mathrm{m}$，\n- $\\delta=0.015\\,\\mathrm{m}$，并取 $A=2\\pi r_{s}\\,\\delta$，\n- $\\eta=1.2\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$，\n- $g=0.5$，\n- $\\mu_{0}=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$，\n- $n=3$，\n- $\\omega_{E}=3.0\\times 10^{4}\\,\\mathrm{s}^{-1}$，\n- $b_{r}^{\\text{vac}}=4.0\\times 10^{-4}\\,\\mathrm{T}$，\n\n从麦克斯韦-法拉第定律、安培定律和广义欧姆定律的基本关系出发，推导 $E_{\\parallel,\\text{th}}$ 的表达式，然后计算其数值。最终答案以 $\\mathrm{V/m}$ 为单位表示，并四舍五入到 $4$ 位有效数字。",
            "solution": "该问题要求推导并计算柱形托卡马克中，共振磁扰动 (RMP) 的穿透阈值，该阈值定义为最小施加平行电场幅值 $E_{\\parallel,\\text{th}}$。该物理系统被模拟为一个等效的单匝电路，这是分析有理面上等离子体屏蔽响应的标准方法。\n\n推导从问题陈述中提供的电路类比开始。在频域中，作为电压 $V$ 的线积分电动势 (EMF)、产生的屏蔽电流 $I$ 以及共振层的复阻抗 $Z$ 之间的关系由欧姆定律给出：\n$$V = I Z$$\n电动势是平行电场 $E_{\\parallel}$ 沿螺旋连接长度 $L_{\\parallel}$ 的积分，因此 $V = E_{\\parallel} L_{\\parallel}$。阻抗 $Z$ 是复数，包含一个电阻部分 $R$ 和一个电感部分 $i\\omega L$，其中 $\\omega$ 是扰动在等离子体参考系中的相对频率。因此，电路方程为：\n$$E_{\\parallel} L_{\\parallel} = I (R + i\\omega L)$$\n为了关联这些复数量的幅值，我们取方程两边的模：\n$$|E_{\\parallel} L_{\\parallel}| = |I (R + i\\omega L)|$$\n由于 $E_{\\parallel}$ 被定义为平行电场的幅值，我们可以写成 $|E_{\\parallel}| = E_{\\parallel}$。类似地，$I$ 代表电流的幅值，所以 $|I| = I$。长度 $L_{\\parallel}$ 是一个正实数。复阻抗的模为 $|Z| = |R + i\\omega L| = \\sqrt{R^2 + (\\omega L)^2}$。这导出了幅值之间的关系：\n$$E_{\\parallel} L_{\\parallel} = I \\sqrt{R^2 + (\\omega L)^2}$$\n由此，我们可以表示出由给定的施加电场 $E_{\\parallel}$ 驱动的屏蔽电流幅值 $I$：\n$$I = \\frac{E_{\\parallel} L_{\\parallel}}{\\sqrt{R^2 + (\\omega L)^2}}$$\n问题将穿透阈值条件定义为屏蔽电流幅值 $I$ 等于在有理面上完全屏蔽真空 RMP 场所需的电流幅值 $I_{\\text{sh}}$ 的点。在此阈值下，$E_{\\parallel} = E_{\\parallel,\\text{th}}$ 且 $I = I_{\\text{sh}}$。将这些代入方程得到：\n$$I_{\\text{sh}} = \\frac{E_{\\parallel,\\text{th}} L_{\\parallel}}{\\sqrt{R^2 + (\\omega L)^2}}$$\n求解阈值电场幅值 $E_{\\parallel,\\text{th}}$ 得到最终的符号表达式：\n$$E_{\\parallel,\\text{th}} = \\frac{I_{\\text{sh}}}{L_{\\parallel}} \\sqrt{R^2 + (\\omega L)^2}$$\n为了计算数值，我们首先使用提供的参数计算中间量：\n$r_{s}=1.6\\,\\mathrm{m}$，$L_{\\parallel}=25\\,\\mathrm{m}$，$\\delta=0.015\\,\\mathrm{m}$，$\\eta=1.2\\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$，$g=0.5$，$\\mu_{0}=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$，$n=3$，$\\omega_{E}=3.0\\times 10^{4}\\,\\mathrm{s}^{-1}$，以及 $b_{r}^{\\text{vac}}=4.0\\times 10^{-4}\\,\\mathrm{T}$。\n\n平行电流的横截面积 $A$ 为：\n$$A = 2\\pi r_{s} \\delta = 2\\pi (1.6) (0.015) = 0.048\\pi\\,\\mathrm{m}^2 \\approx 0.1508\\,\\mathrm{m}^2$$\n该层的等效电阻 $R$ 为：\n$$R = \\frac{\\eta L_{\\parallel}}{A} = \\frac{(1.2\\times 10^{-6})(25)}{0.048\\pi} = \\frac{3 \\times 10^{-5}}{0.048\\pi} \\approx 1.989 \\times 10^{-4}\\,\\Omega$$\nRMP 在等离子体参考系中的相对角频率 $\\omega$ 为：\n$$\\omega = n \\omega_{E} = (3)(3.0\\times 10^{4}) = 9.0 \\times 10^{4}\\,\\mathrm{s}^{-1}$$\n螺旋电流的等效自感 $L$ 为：\n$$L = g \\mu_{0} L_{\\parallel} = (0.5)(4\\pi\\times 10^{-7})(25) = 5\\pi \\times 10^{-6}\\,\\mathrm{H} \\approx 1.571 \\times 10^{-5}\\,\\mathrm{H}$$\n所需屏蔽电流的幅值 $I_{\\text{sh}}$ 为：\n$$I_{\\text{sh}} = \\frac{2\\pi r_{s}}{\\mu_{0}} b_{r}^{\\text{vac}} = \\frac{2\\pi (1.6)}{4\\pi\\times 10^{-7}} (4.0\\times 10^{-4}) = \\frac{0.8}{10^{-7}} (4.0\\times 10^{-4}) = 3200\\,\\mathrm{A}$$\n现在，我们计算阻抗模的两个项：\n电阻项的平方为 $R^2 \\approx (1.989\\times 10^{-4})^2 \\approx 3.958 \\times 10^{-8}\\,\\Omega^2$。\n感抗为 $\\omega L = (9.0 \\times 10^{4})(5\\pi \\times 10^{-6}) = 0.45\\pi\\,\\Omega \\approx 1.414\\,\\Omega$。\n电感项的平方为 $(\\omega L)^2 \\approx (1.414)^2 \\approx 1.999\\,\\Omega^2$。\n阻抗的模为：\n$$|Z| = \\sqrt{R^2 + (\\omega L)^2} = \\sqrt{(1.989 \\times 10^{-4})^2 + (1.414)^2} \\approx \\sqrt{3.958 \\times 10^{-8} + 1.999} \\approx 1.414\\,\\Omega$$\n注意，由于 $(\\omega L)^2 \\gg R^2$，电感项在阻抗中占主导地位。\n\n最后，我们将这些值代入 $E_{\\parallel,\\text{th}}$ 的表达式中：\n$$E_{\\parallel,\\text{th}} = \\frac{3200\\,\\mathrm{A}}{25\\,\\mathrm{m}} \\times (1.4137167\\,\\Omega) = 128 \\times 1.4137167\\,\\mathrm{V/m} \\approx 180.9557\\,\\mathrm{V/m}$$\n根据要求，将结果四舍五入到 $4$ 位有效数字，得到 $181.0\\,\\mathrm{V/m}$。",
            "answer": "$$\n\\boxed{181.0}\n$$"
        },
        {
            "introduction": "虽然简化模型有助于建立物理直觉，但更深入的理解需要求解核心的磁流体动力学（MHD）方程。这项高级练习要求你通过数值方法求解强迫磁扩散方程。你将亲手绘制出等离子体的屏蔽效率如何随电阻率和旋转等关键参数变化，从而清晰地观察到从强屏蔽到完全渗透的转变过程。",
            "id": "4040825",
            "problem": "您必须编写一个完整且可运行的程序，用于在简化电阻磁流体力学（MHD）模型中，计算有理面附近单螺旋度扰动的复共振响应振幅，并用它来评估几组参数集下的无量纲共振响应比 $R_{mn}$。其目的是将电阻率、旋转和平衡梯度作为函数，识别从 $\\lvert R_{mn}\\rvert \\ll 1$（强屏蔽）到 $\\lvert R_{mn}\\rvert \\sim 1$（穿透）的穿透转变。该模型和所有变量均为无量纲。\n\n其基本基础是电阻磁流体力学（MHD）感应方程，结合了傅里叶时间依赖性和一个代表外部共振磁扰动（RMP）的局域源。从线性化欧姆定律 $ \\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{j} $ 和感应方程 $ \\partial_t \\psi = \\eta \\nabla^2 \\psi + s(x) $ 出发，假设存在单谐波时间依赖性 $\\psi(x,t) = \\Re\\{\\psi(x) e^{i \\omega t}\\}$，可以得到简化的一维受迫扩散方程：\n$$\n\\eta \\frac{d^2 \\psi}{dx^2} - i \\Omega \\psi = s(x),\n$$\n其中 $x$ 是类径向坐标，经过归一化后有理面位于 $x=0$ 处；$\\eta$ 是无量纲电阻率；$\\omega$ 是无量纲旋转/角频率；$\\Omega$ 是有效频率，它通过以下方式包含了来自平衡梯度的抗磁性贡献：\n$$\n\\Omega = \\omega - \\omega_\\ast, \\quad \\omega_\\ast = k_y \\left( C_p \\, p' + C_j \\, j' \\right),\n$$\n其中 $k_y = \\frac{m}{r_s}$ 是由极向模数 $m$ 和有理面半径 $r_s$ 构建的副法向波数；$p'$ 和 $j'$ 是有理面处的无量纲平衡压力梯度和电流梯度；$C_p$ 和 $C_j$ 是表示梯度与抗磁频率之间比例关系的无量纲系数。外部驱动局域化在有理面周围，并被建模为：\n$$\ns(x) = S_0 \\exp\\left(-\\frac{x^2}{\\sigma^2}\\right),\n$$\n其中振幅为 $S_0$，宽度为 $\\sigma$。\n\n对于模数 $(m,n)$，响应比 $R_{mn}$ 被定义为有理面处的等离子体响应与没有旋转/漂移效应的参考响应的相对大小，\n$$\nR_{mn} = \\frac{\\left\\lvert \\psi(x=0; \\eta, \\Omega) \\right\\rvert}{\\left\\lvert \\psi_{\\mathrm{ref}}(x=0; \\eta) \\right\\rvert},\n$$\n其中 $\\psi$ 是上述完整受迫方程在 $\\Omega = \\omega - \\omega_\\ast$ 时的解，而 $\\psi_{\\mathrm{ref}}$ 是在 $\\Omega = 0$（即禁用旋转/漂移）时，对于相同的 $\\eta$ 和 $s(x)$ 所求解的同一问题的解。这种归一化将 $\\Omega$ 的效应从由 $\\eta$ 设定的扩散基线中分离出来。\n\n您必须用 $N$ 个等间距点离散化定义域 $x \\in [-L, L]$，并施加齐次狄利克雷边界条件 $\\psi(-L) = 0$ 和 $\\psi(L) = 0$。使用二阶中心有限差分近似来计算 $\\frac{d^2 \\psi}{dx^2}$。使用直接求解器为 $\\psi$ 和 $\\psi_{\\mathrm{ref}}$ 构建并求解所得到的线性系统。包括常数在内的所有数学实体都是无量纲的。\n\n请完全按照给定值实现以下常量：\n- $L = 5.0$, $N = 1001$, $S_0 = 1.0$, $\\sigma = 0.5$,\n- $C_p = 0.03$, $C_j = 0.02$, $r_s = 1.0$。\n\n请实现以下参数集测试套件，每个参数集指定为 $(\\eta, \\omega, p', j', m, n)$:\n- 测试 $1$: $(\\eta = 10^{-5}, \\ \\omega = 10.0, \\ p' = 0.5, \\ j' = 0.5, \\ m = 6, \\ n = 2)$,\n- 测试 $2$: $(\\eta = 10^{-5}, \\ \\omega = 0.1, \\ p' = 0.5, \\ j' = 0.5, \\ m = 6, \\ n = 2)$,\n- 测试 $3$: $(\\eta = 10^{-3}, \\ \\omega = 5.0, \\ p' = 0.5, \\ j' = 0.5, \\ m = 6, \\ n = 2)$,\n- 测试 $4$: $(\\eta = 10^{-4}, \\ \\omega = 5.0, \\ p' = 3.3333333333, \\ j' = 3.3333333333, \\ m = 6, \\ n = 2)$,\n- 测试 $5$: $(\\eta = 10^{-4}, \\ \\omega = 5.0, \\ p' = 2.0, \\ j' = 2.0, \\ m = 6, \\ n = 2)$,\n- 测试 $6$: $(\\eta = 10^{-4}, \\ \\omega = 20.0, \\ p' = 0.5, \\ j' = 0.5, \\ m = 6, \\ n = 2)$。\n\n对于每个测试用例，将 $\\lvert R_{mn} \\rvert$ 计算为一个浮点数。然后，使用阈值 $\\tau = 0.8$，在有序的测试用例中找出满足 $\\lvert R_{mn} \\rvert \\ge \\tau$ 的第一个索引（从零开始）。如果不存在这样的用例，则返回 -1 作为索引。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含六个计算出的 $\\lvert R_{mn} \\rvert$ 值，后面跟着满足 $\\lvert R_{mn} \\rvert \\ge \\tau$ 的第一个用例的整数索引（如果没有，则为 -1）。例如，一个有效的输出格式为 $\\left[ r_1, r_2, r_3, r_4, r_5, r_6, k \\right]$，其中每个 $r_i$ 是一个浮点数， $k$ 是一个整数。所有输出均为无量纲。",
            "solution": "该问题要求计算等离子体对单螺旋度磁扰动的共振响应振幅。这通过一个从电阻磁流体力学（MHD）推导出来的一维复数受迫扩散方程进行建模。我们将使用有限差分法对该方程进行数值求解。\n\n控制方程为：\n$$\n\\eta \\frac{d^2 \\psi}{dx^2} - i \\Omega \\psi = s(x)\n$$\n这是一个在空间域 $x \\in [-L, L]$ 上定义的边值问题，其齐次狄利克雷边界条件为 $\\psi(-L) = 0$ 和 $\\psi(L) = 0$。此处，$\\psi(x)$ 是复磁通扰动，$\\eta$ 是无量纲电阻率，而 $\\Omega = \\omega - \\omega_\\ast$ 是在包含抗磁漂移效应的旋转等离子体参考系中，扰动所感受到的有效频率。源项 $s(x) = S_0 \\exp\\left(-x^2/\\sigma^2\\right)$ 代表外部施加的、局域化在有理面 $x=0$ 处的共振磁扰动。\n\n求解过程将通过在均匀网格上对方程进行离散化，并求解所得到的线性代数方程组来完成。\n\n**步骤 1：离散化**\n\n我们将域 $x \\in [-L, L]$ 离散化为 $N=1001$ 个等间距点，$x_j = -L + j \\Delta x$，$j = 0, 1, \\dots, N-1$。网格间距为 $\\Delta x = \\frac{2L}{N-1}$。由于 $N$ 是奇数，位于 $x=0$ 的有理面对应于中心网格点 $x_{j_{\\mathrm{center}}}$，其中 $j_{\\mathrm{center}} = (N-1)/2 = 500$。\n\n在网格点 $x_j$ 处的二阶导数 $\\frac{d^2\\psi}{dx^2}$ 使用二阶精度中心有限差分公式来近似：\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x_j} \\approx \\frac{\\psi(x_{j+1}) - 2\\psi(x_j) + \\psi(x_{j-1})}{(\\Delta x)^2} = \\frac{\\psi_{j+1} - 2\\psi_j + \\psi_{j-1}}{(\\Delta x)^2}\n$$\n其中 $\\psi_j = \\psi(x_j)$。\n\n将此近似代入每个内部网格点（$j=1, 2, \\dots, N-2$）的控制方程，可得到一个包含 $N-2$ 个线性方程的方程组：\n$$\n\\eta \\left( \\frac{\\psi_{j+1} - 2\\psi_j + \\psi_{j-1}}{(\\Delta x)^2} \\right) - i \\Omega \\psi_j = s(x_j)\n$$\n\n**步骤 2：线性系统构建**\n\n重排离散化后的方程，我们得到：\n$$\n\\frac{\\eta}{(\\Delta x)^2} \\psi_{j-1} + \\left( -\\frac{2\\eta}{(\\Delta x)^2} - i\\Omega \\right) \\psi_j + \\frac{\\eta}{(\\Delta x)^2} \\psi_{j+1} = s_j\n$$\n其中 $s_j = s(x_j)$。该方程对 $j=1, \\dots, N-2$ 成立。边界条件为 $\\psi_0 = 0$ 和 $\\psi_{N-1} = 0$。这些条件会影响 $j=1$ 和 $j=N-2$ 的方程，因为 $\\psi_0$ 和 $\\psi_{N-1}$ 是已知值（均为零）。\n\n这个包含 $N-2$ 个方程、求解 $N-2$ 个未知内部值 $\\psi_1, \\dots, \\psi_{N-2}$ 的方程组可以写成矩阵形式 $A \\vec{\\psi}_{\\mathrm{int}} = \\vec{b}$，其中：\n- $\\vec{\\psi}_{\\mathrm{int}} = [\\psi_1, \\psi_2, \\dots, \\psi_{N-2}]^T$ 是内部点处未知复磁通值的向量。\n- $\\vec{b} = [s_1, s_2, \\dots, s_{N-2}]^T$ 是内部点处源项值的向量。\n- $A$ 是一个 $(N-2) \\times (N-2)$ 的复值三对角矩阵：\n$$\nA_{jk} =\n\\begin{cases}\n-\\frac{2\\eta}{(\\Delta x)^2} - i\\Omega  \\text{如果 } j=k \\\\\n\\frac{\\eta}{(\\Delta x)^2}  \\text{如果 } |j-k|=1 \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n\n**步骤 3：求解与响应比计算**\n\n对于每个参数集 $(\\eta, \\omega, p', j', m, n)$，我们执行以下计算：\n1.  计算副法向波数 $k_y = m/r_s$。\n2.  计算抗磁频率 $\\omega_\\ast = k_y(C_p p' + C_j j')$。\n3.  计算有效频率 $\\Omega = \\omega - \\omega_\\ast$。\n4.  为给定的 $\\eta$ 和 $\\Omega$ 构建矩阵 $A$ 和向量 $\\vec{b}$。使用直接线性求解器求解线性系统 $A \\vec{\\psi}_{\\mathrm{int}} = \\vec{b}$ 以得到 $\\vec{\\psi}_{\\mathrm{int}}$。有理面处的解是 $\\psi(x=0) = \\psi_{j_{\\mathrm{center}}}$，它对应于解向量 $\\vec{\\psi}_{\\mathrm{int}}$ 中索引为 $j_{\\mathrm{center}}-1 = 499$ 的元素。\n5.  为了找到参考响应 $\\psi_{\\mathrm{ref}}$，将 $\\Omega=0$ 并重复步骤 4。这将得到 $\\psi_{\\mathrm{ref}}(x=0)$。\n6.  计算无量纲共振响应比 $\\lvert R_{mn} \\rvert$：\n$$\n\\lvert R_{mn} \\rvert = \\frac{\\left\\lvert \\psi(x=0) \\right\\rvert}{\\left\\lvert \\psi_{\\mathrm{ref}}(x=0) \\right\\rvert}\n$$\n该值量化了由等离子体旋转和抗磁效应引起的扰动的屏蔽或放大。\n\n**步骤 4：最终分析**\n\n在为所有六个测试用例计算出 $\\lvert R_{mn} \\rvert$ 后，我们遍历有序结果，找到第一个满足 $\\lvert R_{mn} \\rvert \\ge \\tau$ 的从零开始的索引 $k$，其中阈值给定为 $\\tau = 0.8$。如果未找到此类用例，则报告索引为 -1。最终输出将是一个列表，其中包含六个计算出的 $\\lvert R_{mn} \\rvert$ 值，后跟整数索引 $k$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless resonant response ratio R_mn for several\n    parameter sets and identifies the penetration transition.\n    \"\"\"\n    \n    # Define constants from the problem statement.\n    L = 5.0\n    N = 1001\n    S0 = 1.0\n    sigma = 0.5\n    Cp = 0.03\n    Cj = 0.02\n    rs = 1.0\n    tau = 0.8\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (eta, omega, p', j', m, n)\n        (1e-5, 10.0, 0.5, 0.5, 6, 2),\n        (1e-5, 0.1, 0.5, 0.5, 6, 2),\n        (1e-3, 5.0, 0.5, 0.5, 6, 2),\n        (1e-4, 5.0, 10.0/3.0, 10.0/3.0, 6, 2),\n        (1e-4, 5.0, 2.0, 2.0, 6, 2),\n        (1e-4, 20.0, 0.5, 0.5, 6, 2)\n    ]\n\n    def create_phys_solver(L_val, N_val, S0_val, sigma_val):\n        \"\"\"\n        Factory function to create a specialized solver for the given\n        geometry and source term.\n        \"\"\"\n        N_int = N_val - 2\n        dx = 2 * L_val / (N_val - 1)\n        dx2 = dx**2\n        \n        x_grid = np.linspace(-L_val, L_val, N_val)\n        source_vec_interior = S0_val * np.exp(-(x_grid[1:-1]**2) / sigma_val**2)\n        \n        # Index of x=0 in the interior points vector\n        center_idx_interior = (N_val - 1) // 2 - 1\n\n        def solve_response(eta, Omega):\n            \"\"\"\n            Solves eta * psi'' - 1j * Omega * psi = s(x)\n            \"\"\"\n            # Construct the tridiagonal matrix A\n            A = np.zeros((N_int, N_int), dtype=np.complex128)\n            \n            main_diag_val = -2.0 * eta / dx2 - 1j * Omega\n            off_diag_val = eta / dx2\n            \n            # Fill diagonals\n            np.fill_diagonal(A, main_diag_val)\n            np.fill_diagonal(A[1:, :-1], off_diag_val) # Lower diagonal\n            np.fill_diagonal(A[:-1, 1:], off_diag_val) # Upper diagonal\n            \n            # Solve the linear system A * psi_interior = b\n            psi_interior = np.linalg.solve(A, source_vec_interior)\n            \n            # Return the complex solution at x=0\n            return psi_interior[center_idx_interior]\n\n        return solve_response\n\n    # Instantiate the solver\n    solver = create_phys_solver(L, N, S0, sigma)\n    \n    r_mn_values = []\n    \n    for case in test_cases:\n        eta, omega, p_prime, j_prime, m, n = case\n        \n        # Calculate intermediate physical parameters\n        ky = m / rs\n        omega_star = ky * (Cp * p_prime + Cj * j_prime)\n        Omega = omega - omega_star\n        \n        # Get solution at x=0 for the full problem\n        psi_val = solver(eta, Omega)\n        \n        # Get solution at x=0 for the reference problem (Omega=0)\n        psi_ref_val = solver(eta, 0.0)\n        \n        # The reference solution should be non-zero for a non-trivial source\n        # but check for robustness\n        if np.abs(psi_ref_val)  1e-15:\n            # This case is not expected with the given problem parameters\n            r_mn_abs = np.inf\n        else:\n            r_mn_abs = np.abs(psi_val) / np.abs(psi_ref_val)\n            \n        r_mn_values.append(r_mn_abs)\n    \n    # Find the index of the first case that meets the penetration threshold\n    penetration_idx = -1\n    for i, r_val in enumerate(r_mn_values):\n        if r_val = tau:\n            penetration_idx = i\n            break\n            \n    # Combine results into a single list for output\n    final_results = r_mn_values + [penetration_idx]\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        }
    ]
}