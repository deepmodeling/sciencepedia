{
    "hands_on_practices": [
        {
            "introduction": "在计算磁流体动力学（MHD）中，维持磁场的无散度条件（$\\nabla \\cdot \\mathbf{B} = 0$）至关重要。然而，许多看似直接的数值离散格式会人为地产生不为零的磁散度，从而导致非物理效应。本练习通过一个简化的平流问题，直接揭示了这一数值错误的根源，要求您分析性地计算一个简单的同位网格（collocated grid）格式在一个时间步后产生的磁散度误差 。通过将其与约束输运（Constrained Transport, CT）方法进行对比，您将深刻理解为何交错网格（staggered grid）和特定的离散方式对于精确保持无散度约束是必不可少的。",
            "id": "3968369",
            "problem": "考虑理想磁流体力学（MHD）在二维空间中均匀平流速度下的感应方程的两种有限差分离散格式。连续感应方程为\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}),\n$$\n其中理想欧姆定律为 $\\mathbf{E} = -\\mathbf{u} \\times \\mathbf{B}$，磁场为 $\\mathbf{B} = (B_x, B_y, 0)$。假设速度在空间上是均匀的 $\\mathbf{u} = (U, 0, 0)$，其中 $U$ 为常数，采用周期性边界条件，以及在两个方向上间距均为 $\\Delta$ 的均匀笛卡尔网格。网格中心位于 $(x_i, y_j) = (i\\,\\Delta, j\\,\\Delta)$，其中 $i, j$ 为整数。\n\n通过引入流函数 $\\psi(x,y)$ 来定义初始磁场，使其严格满足离散无散条件，并设\n$$\nB_x(x,y) = \\frac{\\partial \\psi}{\\partial y}(x,y), \\qquad B_y(x,y) = -\\frac{\\partial \\psi}{\\partial x}(x,y),\n$$\n其中\n$$\n\\psi(x,y) = \\psi_0 \\sin(k x) \\sin(k y),\n$$\n$\\psi_0$ 和 $k$ 是实常数。在网格上，于网格中心进行逐点采样：在时间 $t^n$ 时，$B_x^n(i,j) = \\psi_0 k \\cos(k y_j) \\sin(k x_i)$ 且 $B_y^n(i,j) = -\\psi_0 k \\cos(k x_i) \\sin(k y_j)$。\n\n你需要比较以下两种格式在单个时间步长 $\\Delta t$ 内的单步更新：\n\n1. 一种在网格中心配置的破坏散度条件的格式（collocated divergence-violating scheme），通过对感应方程右侧的 $B_y$ 直接应用单边（迎风）差分来进行各分量更新得到：\n$$\nB_x^{n+1}(i,j) = B_x^{n}(i,j) + U\\,\\Delta t\\, D_y^{-}\\!\\left[B_y^{n}\\right](i,j),\n$$\n$$\nB_y^{n+1}(i,j) = B_y^{n}(i,j) - U\\,\\Delta t\\, D_x^{-}\\!\\left[B_y^{n}\\right](i,j),\n$$\n其中后向差分算子为\n$$\nD_x^{-}[f](i,j) = \\frac{f(i,j) - f(i-1,j)}{\\Delta}, \\qquad D_y^{-}[f](i,j) = \\frac{f(i,j) - f(i,j-1)}{\\Delta}.\n$$\n通过中心差分定义网格中心的同位离散散度\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}(i,j) = D_x^{c}\\!\\left[B_x\\right](i,j) + D_y^{c}\\!\\left[B_y\\right](i,j),\n$$\n其中\n$$\nD_x^{c}[f](i,j) = \\frac{f(i+1,j) - f(i-1,j)}{2\\,\\Delta}, \\qquad D_y^{c}[f](i,j) = \\frac{f(i,j+1) - f(i,j-1)}{2\\,\\Delta}.\n$$\n\n2. 一种面心约束输运（Constrained Transport, CT）格式，该格式通过边心电场更新面法向分量，以确保离散无散演化。设 $B_x$ 存储在 $x$ 面上，记为 $B_x(i+\\tfrac{1}{2}, j)$，$B_y$ 存储在 $y$ 面上，记为 $B_y(i, j+\\tfrac{1}{2})$。CT 更新格式为\n$$\nB_x^{n+1}\\!\\left(i+\\tfrac{1}{2}, j\\right) = B_x^{n}\\!\\left(i+\\tfrac{1}{2}, j\\right) - \\frac{\\Delta t}{\\Delta}\\left[E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right) - E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j-\\tfrac{1}{2}\\right)\\right],\n$$\n$$\nB_y^{n+1}\\!\\left(i, j+\\tfrac{1}{2}\\right) = B_y^{n}\\!\\left(i, j+\\tfrac{1}{2}\\right) + \\frac{\\Delta t}{\\Delta}\\left[E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right) - E_z^{n}\\!\\left(i-\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right)\\right],\n$$\n其中 $E_z^{n} = -U\\,B_y^{n}$ 是通过对 $B_y$ 进行任意二阶相容的插值在边中心 $(i\\pm\\tfrac{1}{2}, j\\pm\\tfrac{1}{2})$ 处采样得到的。CT 离散散度在网格中心定义为面法向通量差分\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}(i,j) = \\frac{B_x\\!\\left(i+\\tfrac{1}{2}, j\\right) - B_x\\!\\left(i-\\tfrac{1}{2}, j\\right)}{\\Delta} + \\frac{B_y\\!\\left(i, j+\\tfrac{1}{2}\\right) - B_y\\!\\left(i, j-\\tfrac{1}{2}\\right)}{\\Delta}.\n$$\n\n从给定的初始场出发，对每种格式执行单个时间步长 $\\Delta t$ 的计算，并计算在网格中心 $(i,j)$ 处得到的离散散度。请用 $\\Delta t$, $U$, $\\psi_0$, $k$, $\\Delta$, $x_i$ 和 $y_j$ 表示你的答案，给出闭式解析表达式。提供时间步结束后的 $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j)$ 和 $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{\\,n+1}(i,j)$。无需进行舍入，最终表达式中也无需单位。",
            "solution": "所述问题是有效的。它在科学上基于计算磁流体力学的原理，是适定的，具有一套完整且一致的给定条件，并以客观、正式的语言表述。所有必要的方程、初始条件和数值格式定义都已提供，以找到唯一的解析解。该问题不违反任何指定的无效标准。因此，我们可以着手求解。\n\n问题要求从指定的初始条件出发，计算两种不同数值格式在单个大小为 $\\Delta t$ 的时间步后磁场的离散散度 $(\\nabla \\cdot \\mathbf{B})$。对于均匀速度 $\\mathbf{u} = (U, 0, 0)$，连续感应方程简化为：\n$$\n\\frac{\\partial B_x}{\\partial t} = U \\frac{\\partial B_y}{\\partial y}\n$$\n$$\n\\frac{\\partial B_y}{\\partial t} = -U \\frac{\\partial B_y}{\\partial x}\n$$\n初始磁场由流函数 $\\psi(x,y) = \\psi_0 \\sin(k x) \\sin(k y)$ 导出，根据其构造，该函数给出了一个连续无散场，$\\nabla \\cdot \\mathbf{B} = \\frac{\\partial B_x}{\\partial x} + \\frac{\\partial B_y}{\\partial y} = \\frac{\\partial^2 \\psi}{\\partial x \\partial y} - \\frac{\\partial^2 \\psi}{\\partial y \\partial x} = 0$。\n问题指定了在时间 $t^n$ 的离散采样初始场：\n对于同位格式，在网格中心 $(x_i, y_j) = (i\\Delta, j\\Delta)$ 处：\n$$\nB_x^n(i,j) = \\psi_0 k \\sin(k x_i) \\cos(k y_j)\n$$\n$$\nB_y^n(i,j) = -\\psi_0 k \\cos(k x_i) \\sin(k y_j)\n$$\n正如在验证过程中所证明的，该初始场对于指定的中心差分算子也是离散无散的，即 $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n}(i,j) = 0$。\n\n### 格式 1：破坏散度条件的同位格式\n\n磁场分量在一个时间步长 $\\Delta t$ 内的更新由下式给出：\n$$\nB_x^{n+1}(i,j) = B_x^{n}(i,j) + U\\,\\Delta t\\, D_y^{-}\\!\\left[B_y^{n}\\right](i,j)\n$$\n$$\nB_y^{n+1}(i,j) = B_y^{n}(i,j) - U\\,\\Delta t\\, D_x^{-}\\!\\left[B_y^{n}\\right](i,j)\n$$\n在时间 $t^{n+1}$ 的离散散度定义为：\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = D_x^{c}\\!\\left[B_x^{n+1}\\right](i,j) + D_y^{c}\\!\\left[B_y^{n+1}\\right](i,j)\n$$\n将更新方程代入散度定义：\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = D_x^{c}\\!\\left[B_x^{n} + U\\,\\Delta t\\, D_y^{-}\\!B_y^{n}\\right](i,j) + D_y^{c}\\!\\left[B_y^{n} - U\\,\\Delta t\\, D_x^{-}\\!B_y^{n}\\right](i,j)\n$$\n根据差分算子的线性性质：\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = \\left(D_x^{c}\\!B_x^{n} + D_y^{c}\\!B_y^{n}\\right) + U\\,\\Delta t \\left(D_x^{c} D_y^{-}\\!B_y^{n} - D_y^{c} D_x^{-}\\!B_y^{n}\\right)\n$$\n第一项是初始离散散度 $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n}(i,j)$，其值为 $0$。因此，一步之后的散度完全是由离散差分算子的非对易性产生的：\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = U\\,\\Delta t\\, \\left[D_x^{c}, D_y^{-}\\right]B_y^{n}(i,j)\n$$\n让我们计算对易子 $[D_x^c, D_y^-] = D_x^c D_y^- - D_y^c D_x^-$ 对 $B_y^n(i,j) = -\\psi_0 k \\cos(k x_i) \\sin(k y_j)$ 的作用。设 $C = -\\psi_0 k$。\n$$\nD_x^c D_y^- [B_y^n] = D_x^c \\left[ \\frac{B_y^n(i,j) - B_y^n(i,j-1)}{\\Delta} \\right] = \\frac{1}{\\Delta} \\left( D_x^c [B_y^n(i,j)] - D_x^c [B_y^n(i,j-1)] \\right)\n$$\n$$\nD_x^c[B_y^n(i,j)] = C \\sin(ky_j) D_x^c[\\cos(kx_i)] = C \\sin(ky_j) \\frac{\\cos(k(x_i+\\Delta)) - \\cos(k(x_i-\\Delta))}{2\\Delta}\n$$\n使用恒等式 $\\cos(A) - \\cos(B) = -2\\sin(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$，上式变为：\n$$\nD_x^c[B_y^n(i,j)] = C \\sin(ky_j) \\frac{-2\\sin(kx_i)\\sin(k\\Delta)}{2\\Delta}\n$$\n类似地，$D_y^c D_x^- [B_y^n] = D_y^c \\left[ \\frac{B_y^n(i,j) - B_y^n(i-1,j)}{\\Delta} \\right]$。\n让我们更直接地计算对易子项 $D_x^c D_y^- [B_y^n] - D_y^c D_x^- [B_y^n]$。设 $f(i,j) = B_y^n(i,j) = C \\cos(kx_i)\\sin(ky_j)$。\n$$\nD_x^c D_y^- [f] = D_x^c\\left[\\frac{f(i,j)-f(i,j-1)}{\\Delta}\\right] = \\frac{C}{2\\Delta^2}\\left( \\sin(ky_j)-\\sin(ky_{j-1}) \\right)\\left( \\cos(kx_{i+1})-\\cos(kx_{i-1}) \\right)\n$$\n$$\nD_y^c D_x^- [f] = D_y^c\\left[\\frac{f(i,j)-f(i-1,j)}{\\Delta}\\right] = \\frac{C}{2\\Delta^2}\\left( \\cos(kx_i)-\\cos(kx_{i-1}) \\right)\\left( \\sin(ky_{j+1})-\\sin(ky_{j-1}) \\right)\n$$\n使用三角和差化积恒等式：\n$\\sin(A) - \\sin(B) = 2\\cos(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$\n$\\cos(A) - \\cos(B) = -2\\sin(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$\n我们得到：\n$\\sin(ky_j)-\\sin(ky_{j-1}) = 2\\cos(k(y_j - \\Delta/2))\\sin(k\\Delta/2)$\n$\\cos(kx_{i+1})-\\cos(kx_{i-1}) = -2\\sin(kx_i)\\sin(k\\Delta)$\n$\\cos(kx_i)-\\cos(kx_{i-1}) = -2\\sin(k(x_i - \\Delta/2))\\sin(k\\Delta/2)$\n$\\sin(ky_{j+1})-\\sin(ky_{j-1}) = 2\\cos(ky_j)\\sin(k\\Delta)$\n将这些代入对易子表达式：\n$$\n[D_x^c, D_y^-]B_y^n = \\frac{C}{2\\Delta^2} \\left[ (2\\cos(k(y_j-\\frac{\\Delta}{2}))\\sin(\\frac{k\\Delta}{2}))(-2\\sin(kx_i)\\sin(k\\Delta)) - (-2\\sin(k(x_i-\\frac{\\Delta}{2}))\\sin(\\frac{k\\Delta}{2}))(2\\cos(ky_j)\\sin(k\\Delta)) \\right]\n$$\n$$\n= \\frac{-2C \\sin(\\frac{k\\Delta}{2})\\sin(k\\Delta)}{\\Delta^2} \\left[ \\sin(kx_i)\\cos(k(y_j-\\frac{\\Delta}{2})) - \\cos(ky_j)\\sin(k(x_i-\\frac{\\Delta}{2})) \\right]\n$$\n括号中的项可以通过展开移位参数的函数来简化：\n$\\sin(kx_i)\\cos(ky_j-\\frac{k\\Delta}{2}) = \\sin(kx_i)[\\cos(ky_j)\\cos(\\frac{k\\Delta}{2}) + \\sin(ky_j)\\sin(\\frac{k\\Delta}{2})]$\n$\\cos(ky_j)\\sin(kx_i-\\frac{k\\Delta}{2}) = \\cos(ky_j)[\\sin(kx_i)\\cos(\\frac{k\\Delta}{2}) - \\cos(kx_i)\\sin(\\frac{k\\Delta}{2})]$\n用第一项减去第二项得到：\n$\\sin(\\frac{k\\Delta}{2}) [\\sin(kx_i)\\sin(ky_j) + \\cos(kx_i)\\cos(ky_j)] = \\sin(\\frac{k\\Delta}{2})\\cos(k(x_i-y_j))$\n所以对易子为：\n$$\n[D_x^c, D_y^-]B_y^n = \\frac{-2C \\sin(\\frac{k\\Delta}{2})\\sin(k\\Delta)}{\\Delta^2} \\left[ \\sin(\\frac{k\\Delta}{2})\\cos(k(x_i-y_j)) \\right] = \\frac{-2C}{\\Delta^2} \\sin^2(\\frac{k\\Delta}{2})\\sin(k\\Delta)\\cos(k(x_i-y_j))\n$$\n最后，代入 $C = -\\psi_0 k$ 并使用 $\\sin(k\\Delta) = 2\\sin(k\\Delta/2)\\cos(k\\Delta/2)$：\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = U\\Delta t \\frac{-2(-\\psi_0 k)}{\\Delta^2} \\sin^2(\\frac{k\\Delta}{2})[2\\sin(\\frac{k\\Delta}{2})\\cos(\\frac{k\\Delta}{2})]\\cos(k(x_i-y_j))\n$$\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{col}}^{\\,n+1}(i,j) = \\frac{4 U \\Delta t \\psi_0 k}{\\Delta^2} \\sin^3\\left(\\frac{k\\Delta}{2}\\right)\\cos\\left(\\frac{k\\Delta}{2}\\right) \\cos(k(x_i-y_j))\n$$\n\n### 格式 2：面心约束输运（CT）格式\n\n约束输运（CT）格式被设计用于在初始散度为零的情况下，在所有时间上将磁场的离散散度精确地保持为零（达到机器精度）。在网格中心 $(i,j)$ 的离散散度使用其面上的通量定义：\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}(i,j) = \\frac{B_x\\!\\left(i+\\tfrac{1}{2}, j\\right) - B_x\\!\\left(i-\\tfrac{1}{2}, j\\right)}{\\Delta} + \\frac{B_y\\!\\left(i, j+\\tfrac{1}{2}\\right) - B_y\\!\\left(i, j-\\tfrac{1}{2}\\right)}{\\Delta}\n$$\n更新方程为：\n$$\nB_x^{n+1}\\!\\left(i+\\tfrac{1}{2}, j\\right) = B_x^{n}\\!\\left(i+\\tfrac{1}{2}, j\\right) - \\frac{\\Delta t}{\\Delta}\\left[E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right) - E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j-\\tfrac{1}{2}\\right)\\right]\n$$\n$$\nB_y^{n+1}\\!\\left(i, j+\\tfrac{1}{2}\\right) = B_y^{n}\\!\\left(i, j+\\tfrac{1}{2}\\right) + \\frac{\\Delta t}{\\Delta}\\left[E_z^{n}\\!\\left(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right) - E_z^{n}\\!\\left(i-\\tfrac{1}{2}, j+\\tfrac{1}{2}\\right)\\right]\n$$\n为了求出时间 $t^{n+1}$ 的散度，我们计算散度在一个时间步内的变化量，$(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n}$。我们将此差值乘以 $\\Delta$，得到：\n$$\n\\Delta \\left((\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n}\\right) = \\left[\\delta B_x(i+\\tfrac{1}{2},j) - \\delta B_x(i-\\tfrac{1}{2},j)\\right] + \\left[\\delta B_y(i,j+\\tfrac{1}{2}) - \\delta B_y(i,j-\\tfrac{1}{2})\\right]\n$$\n其中 $\\delta B_x = B_x^{n+1}-B_x^n$，等等。代入更新规则：\n$$\n-\\frac{\\Delta t}{\\Delta}\\left[E_z(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}) - E_z(i+\\tfrac{1}{2}, j-\\tfrac{1}{2})\\right] - \\left(-\\frac{\\Delta t}{\\Delta}\\left[E_z(i-\\tfrac{1}{2}, j+\\tfrac{1}{2}) - E_z(i-\\tfrac{1}{2}, j-\\tfrac{1}{2})\\right]\\right)\n$$\n$$\n+ \\frac{\\Delta t}{\\Delta}\\left[E_z(i+\\tfrac{1}{2}, j+\\tfrac{1}{2}) - E_z(i-\\tfrac{1}{2}, j+\\tfrac{1}{2})\\right] - \\left(\\frac{\\Delta t}{\\Delta}\\left[E_z(i+\\tfrac{1}{2}, j-\\tfrac{1}{2}) - E_z(i-\\tfrac{1}{2}, j-\\tfrac{1}{2})\\right]\\right)\n$$\n按电场位置对各项进行分组，表明所有项在一个裂项求和中相互抵消：\n$$\n\\frac{\\Delta t}{\\Delta} \\left[ (-E_z + E_z)_{i+\\frac{1}{2}, j+\\frac{1}{2}} + (E_z - E_z)_{i+\\frac{1}{2}, j-\\frac{1}{2}} + (E_z - E_z)_{i-\\frac{1}{2}, j+\\frac{1}{2}} + (-E_z + E_z)_{i-\\frac{1}{2}, j-\\frac{1}{2}} \\right] = 0\n$$\n这证明了 $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n+1}(i,j) = (\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n}(i,j)$。离散散度是精确保守的。\nCT 格式的初始场是从连续定义在面中心采样得到的。如验证过程中所证明，这个初始的交错场对于 CT 散度算子是离散无散的，即 $(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{n}(i,j) = 0$。\n因此，在一个时间步之后（以及所有后续时间步），散度保持为零。\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\mathrm{CT}}^{\\,n+1}(i,j) = 0\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4 U \\Delta t \\psi_0 k}{\\Delta^2} \\sin^3\\left(\\frac{k\\Delta}{2}\\right)\\cos\\left(\\frac{k\\Delta}{2}\\right) \\cos(k(x_i-y_j)), & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "认识到数值磁散度误差的来源后，下一步是探索如何控制或消除它。Powell 的八波模型是最早提出的散度清理方法之一，其思想是在磁流体方程组中引入与 $\\nabla \\cdot \\mathbf{B}$ 成正比的源项来传播误差。本练习旨在揭示这种简化方法背后隐藏的代价：当 $\\nabla \\cdot \\mathbf{B} \\neq 0$ 时，这些源项会破坏系统的能量守恒 。通过推导由 Powell 源项引起的伪能量产生率，并构思能量修正项或更先进的投影清理方案，您将学会批判性地评估不同清理方法的物理保真度，并理解为何能量守恒在长期模拟中至关重要。",
            "id": "3968350",
            "problem": "考虑一个周期性的单连通区域 $\\Omega \\subset \\mathbb{R}^{3}$，它代表了聚变装置中环形约束的等离子体。设 $\\rho(\\mathbf{x},t)$ 为质量密度，$\\mathbf{v}(\\mathbf{x},t)$ 为流速，$\\mathbf{B}(\\mathbf{x},t)$ 为磁场，$p(\\mathbf{x},t)$ 为热压强，$\\gamma>1$ 为比热比。总能量密度为 $E(\\mathbf{x},t) = \\tfrac{1}{2}\\rho|\\mathbf{v}|^{2} + \\tfrac{p}{\\gamma-1} + \\tfrac{1}{2}|\\mathbf{B}|^{2}$。假设为理想磁流体动力学 (MHD)，具有质量、动量、磁感应和总能量的常规守恒通量，但数值公式采用了 Powell 八波格式，该格式通过与离散散度误差 $\\nabla\\cdot\\mathbf{B}\\neq 0$ 成正比的非守恒源项来增强理想 MHD 系统。\n\n从理想 MHD 的基本守恒定律和标准矢量微积分恒等式出发，并假设在 $\\partial\\Omega$ 上采用周期性边界条件，推导当存在 Powell 源项时，仅由非零 $\\nabla\\cdot\\mathbf{B}$ 引起的总能量的区域积分变化率。然后，构造一个局域能量修正源密度 $s_{\\mathrm{corr}}(\\mathbf{v},\\mathbf{B},\\nabla\\cdot\\mathbf{B})$，当它被添加到总能量方程中时，可以抵消 $\\Omega$ 中这种伪能量的产生。作为一种替代的缓解方法，描述一种形式为 $\\mathbf{B}^{\\star} = \\mathbf{B} - \\nabla\\phi$ 的磁场散度清理投影方法，其中选择标量势 $\\phi(\\mathbf{x},t)$ 以在主导阶上强制实现 $\\nabla\\cdot\\mathbf{B}^{\\star}=0$。\n\n将您的最终答案表示为局域能量修正源密度 $s_{\\mathrm{corr}}(\\mathbf{v},\\mathbf{B},\\nabla\\cdot\\mathbf{B})$ 的单个闭式解析表达式。无需进行数值计算。最终答案中无需单位。",
            "solution": "首先验证问题的有效性。给定条件为一个周期性的单连通区域 $\\Omega \\subset \\mathbb{R}^{3}$；变量为质量密度 $\\rho$、速度 $\\mathbf{v}$、磁场 $\\mathbf{B}$ 和热压强 $p$；比热比 $\\gamma$；以及总能量密度的定义 $E = \\tfrac{1}{2}\\rho|\\mathbf{v}|^{2} + \\tfrac{p}{\\gamma-1} + \\tfrac{1}{2}|\\mathbf{B}|^{2}$。物理模型是理想磁流体动力学 (MHD)，并增加了 Powell 源项，这些源项与非零磁散度 $\\nabla\\cdot\\mathbf{B}$ 成正比。边界条件是周期性的。任务是推导伪能量产生率，找到一个局域修正项 $s_{\\mathrm{corr}}$ 以抵消它，并描述一种替代的基于投影的缓解策略。该问题在计算磁流体力学中有科学依据，是适定的、客观的，并且包含足够的信息以进行推导。它没有违反任何无效性标准。因此，该问题是有效的，可以推导出解。\n\n守恒形式的理想 MHD 方程组由以下各式给出：\n质量守恒：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}) = 0\n$$\n动量守恒：\n$$\n\\frac{\\partial (\\rho \\mathbf{v})}{\\partial t} + \\nabla \\cdot \\left(\\rho \\mathbf{v} \\mathbf{v} - \\mathbf{B} \\mathbf{B} + \\left(p + \\frac{1}{2}|\\mathbf{B}|^{2}\\right)\\mathbf{I}\\right) = 0\n$$\n磁感应（法拉第定律）：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} + \\nabla \\cdot (\\mathbf{v} \\mathbf{B} - \\mathbf{B} \\mathbf{v}) = 0\n$$\n总能量守恒：\n$$\n\\frac{\\partial E}{\\partial t} + \\nabla \\cdot \\left[ \\left(E + p + \\frac{1}{2}|\\mathbf{B}|^{2}\\right) \\mathbf{v} - (\\mathbf{v} \\cdot \\mathbf{B})\\mathbf{B} \\right] = 0\n$$\n这里，$\\mathbf{I}$ 是单位张量。感应方程的旋度意味着 $\\frac{\\partial}{\\partial t}(\\nabla\\cdot\\mathbf{B}) + \\nabla\\cdot(\\mathbf{v}(\\nabla\\cdot\\mathbf{B})) = 0$，这意味着如果初始时 $\\nabla\\cdot\\mathbf{B}=0$，它将永远保持为零。然而，数值离散化误差可能引入非零的 $\\nabla\\cdot\\mathbf{B}$，这可能导致非物理的结果。\n\nPowell 八波格式通过向 MHD 方程添加与 $\\nabla\\cdot\\mathbf{B}$ 成正比的源项来解决这个问题。设计这些项的目的是将散度误差传播出模拟区域。增强后的方程组为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}) = 0\n$$\n$$\n\\frac{\\partial (\\rho \\mathbf{v})}{\\partial t} + \\nabla \\cdot \\left(\\rho \\mathbf{v} \\mathbf{v} - \\mathbf{B} \\mathbf{B} + \\left(p + \\frac{1}{2}|\\mathbf{B}|^{2}\\right)\\mathbf{I}\\right) = -(\\nabla \\cdot \\mathbf{B})\\mathbf{B}\n$$\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} + \\nabla \\cdot (\\mathbf{v} \\mathbf{B} - \\mathbf{B} \\mathbf{v}) = -(\\nabla \\cdot \\mathbf{B})\\mathbf{v}\n$$\n$$\n\\frac{\\partial E}{\\partial t} + \\nabla \\cdot \\mathbf{F}_{E} = -(\\nabla \\cdot \\mathbf{B})(\\mathbf{v} \\cdot \\mathbf{B})\n$$\n其中 $\\mathbf{F}_{E} = \\left(E + p + \\frac{1}{2}|\\mathbf{B}|^{2}\\right) \\mathbf{v} - (\\mathbf{v} \\cdot \\mathbf{B})\\mathbf{B}$ 是能量通量。能量方程中的源项 $-(\\nabla \\cdot \\mathbf{B})(\\mathbf{v} \\cdot \\mathbf{B})$ 表示由添加到动量方程中的伪类洛伦兹力 $-(\\nabla \\cdot \\mathbf{B})\\mathbf{B}$ 所做的功的速率。\n\n第一个任务是找出由这些源项引起的总能量 $\\mathcal{E}(t) = \\int_{\\Omega} E(\\mathbf{x},t) dV$ 的区域积分变化率。我们计算 $\\mathcal{E}(t)$ 的时间导数：\n$$\n\\frac{d\\mathcal{E}}{dt} = \\frac{d}{dt} \\int_{\\Omega} E \\, dV = \\int_{\\Omega} \\frac{\\partial E}{\\partial t} \\, dV\n$$\n代入经 Powell 方法增强的能量方程：\n$$\n\\frac{d\\mathcal{E}}{dt} = \\int_{\\Omega} \\left[ -\\nabla \\cdot \\mathbf{F}_{E} - (\\nabla \\cdot \\mathbf{B})(\\mathbf{v} \\cdot \\mathbf{B}) \\right] dV\n$$\n这可以分解为两个积分：\n$$\n\\frac{d\\mathcal{E}}{dt} = - \\int_{\\Omega} \\nabla \\cdot \\mathbf F_{E} \\, dV - \\int_{\\Omega} (\\nabla \\cdot \\mathbf{B})(\\mathbf{v} \\cdot \\mathbf{B}) \\, dV\n$$\n第一项可以使用散度定理转换为一个面积分：\n$$\n\\int_{\\Omega} \\nabla \\cdot \\mathbf{F}_{E} \\, dV = \\oint_{\\partial\\Omega} \\mathbf{F}_{E} \\cdot d\\mathbf{S}\n$$\n问题指定了在区域 $\\partial\\Omega$ 上的周期性边界条件。对于任何具有周期性边界条件的矢量场，其边界上的通量积分为零，因为来自区域相对两面的贡献会相互抵消。因此，$\\oint_{\\partial\\Omega} \\mathbf{F}_{E} \\cdot d\\mathbf{S} = 0$。\n\n这样只剩下源项的贡献。总能量的区域积分变化率为：\n$$\n\\frac{d\\mathcal{E}}{dt} = - \\int_{\\Omega} (\\nabla \\cdot \\mathbf{B})(\\mathbf{v} \\cdot \\mathbf{B}) \\, dV\n$$\n当 $\\nabla \\cdot \\mathbf{B} \\neq 0$ 时，此表达式表示由于 Powell 源项，在区域 $\\Omega$ 中每单位时间产生（或耗散）的总伪能量。\n\n第二个任务是构造一个局域能量修正源密度 $s_{\\mathrm{corr}}(\\mathbf{v},\\mathbf{B},\\nabla\\cdot\\mathbf{B})$，以抵消这种伪能量的产生。我们用这个新项来增强 Powell 能量方程：\n$$\n\\frac{\\partial E}{\\partial t} + \\nabla \\cdot \\mathbf{F}_{E} = -(\\nabla \\cdot \\mathbf{B})(\\mathbf{v} \\cdot \\mathbf{B}) + s_{\\mathrm{corr}}\n$$\n为了确保总能量 $\\mathcal{E}$ 守恒（即 $\\frac{d\\mathcal{E}}{dt} = 0$），源项的总区域积分必须为零，考虑到边界通量为零：\n$$\n\\int_{\\Omega} \\left[ -(\\nabla \\cdot \\mathbf{B})(\\mathbf{v} \\cdot \\mathbf{B}) + s_{\\mathrm{corr}} \\right] dV = 0\n$$\n问题要求一个*局域*能量修正，这是一个更强的条件。它要求修正在区域中的每一点都抵消伪项，而不仅仅是平均意义上的抵消。这意味着被积函数本身必须恒等于零：\n$$\n-(\\nabla \\cdot \\mathbf{B})(\\mathbf v \\cdot \\mathbf B) + s_{\\mathrm{corr}} = 0\n$$\n求解 $s_{\\mathrm{corr}}$ 得到所需的局域能量修正源密度：\n$$\ns_{\\mathrm{corr}}(\\mathbf{v},\\mathbf{B},\\nabla\\cdot\\mathbf{B}) = (\\nabla \\cdot \\mathbf{B})(\\mathbf{v} \\cdot \\mathbf{B})\n$$\n将此项添加到 Powell 能量方程中，使得该格式在局域上是能量守恒的，其代价是与动量方程和感应方程不一致。\n\n第三个任务是描述一种替代的缓解策略：散度清理投影。这种方法直接修正磁场 $\\mathbf{B}$，使其变为无散场。修正后场的建议形式为 $\\mathbf{B}^{\\star} = \\mathbf{B} - \\nabla\\phi$，其中 $\\phi(\\mathbf{x},t)$ 是一个标量势。这种形式的灵感来自于矢量场的亥姆霍兹分解。我们强制要求新场 $\\mathbf{B}^{\\star}$ 是无散的：\n$$\n\\nabla \\cdot \\mathbf{B}^{\\star} = 0\n$$\n代入 $\\mathbf{B}^{\\star}$ 的表达式：\n$$\n\\nabla \\cdot (\\mathbf{B} - \\nabla\\phi) = 0\n$$\n$$\n\\nabla \\cdot \\mathbf{B} - \\nabla \\cdot (\\nabla\\phi) = 0\n$$\n这就得到了关于标量势 $\\phi$ 的泊松方程：\n$$\n\\nabla^2 \\phi = \\nabla \\cdot \\mathbf{B}\n$$\n这个椭圆方程的源项正是我们旨在消除的散度误差。在数值实现中，人们会周期性地（例如，在每个时间步）执行以下过程：\n1. 使用离散散度算子计算磁场的散度，$d = \\nabla \\cdot \\mathbf{B}$。\n2. 使用适当的数值求解器（例如，对于周期性区域使用快速傅里叶变换）求解泊松方程 $\\nabla^2 \\phi = d$ 以得到势 $\\phi$。\n3. 计算势的梯度 $\\nabla\\phi$。\n4. 修正磁场：$\\mathbf{B} \\leftarrow \\mathbf{B} - \\nabla\\phi$。\n得到的磁场 $\\mathbf{B}$ 现在是无散的（达到机器精度，或求解器的精度）。这种投影方法通常比 Powell 源项方法更准确、更稳健，尽管由于需要求解一个全局椭圆方程，其计算成本更高。",
            "answer": "$$\n\\boxed{(\\nabla \\cdot \\mathbf{B})(\\mathbf{v} \\cdot \\mathbf{B})}\n$$"
        },
        {
            "introduction": "实际的等离子体（如聚变装置中的等离子体）通常被物理边界（如理想导电壁）所限制，这给数值模拟带来了新的挑战。在理想导电壁上，磁场的法向分量 $\\boldsymbol{n} \\cdot \\boldsymbol{B}$ 必须保持恒定。本练习将探讨不同的散度清理方法——广义拉格朗日乘子（GLM）方法、椭圆投影法和约束输运（CT）法——如何与这一关键的物理边界条件相互作用 。通过为 GLM 和投影法中的标量势推导必需的边界条件，本练习将帮助您掌握在实际应用中确保数值格式与物理现实一致的关键实现细节，这是从理论走向真实世界模拟的重要一步。",
            "id": "3968332",
            "problem": "考虑一个由静止的、理想导电壁包围的单连通等离子体区域中的理想磁流体动力学（MHD），其向外的单位法向量为 $\\boldsymbol{n}$。磁场为 $\\boldsymbol{B}(\\boldsymbol{x},t)$，速度为 $\\boldsymbol{v}(\\boldsymbol{x},t)$，电场为 $\\boldsymbol{E}(\\boldsymbol{x},t)$。其基本出发点是麦克斯韦-法拉第定律和理想欧姆定律：\n$$\\partial_{t}\\boldsymbol{B}=-\\nabla\\times\\boldsymbol{E},\\qquad \\boldsymbol{E}+\\boldsymbol{v}\\times\\boldsymbol{B}=\\boldsymbol{0}.$$\n在理想导电壁上，切向电场为零，即 $\\boldsymbol{n}\\times\\boldsymbol{E}=\\boldsymbol{0}$，且壁是静止的，因此在壁上 $\\boldsymbol{v}=\\boldsymbol{0}$。在数值磁流体动力学（MHD）中，通常使用散度清理方法来控制对无散约束 $\\nabla\\cdot\\boldsymbol{B}=0$ 的数值违背。一种广泛使用的方法是广义拉格朗日乘子（GLM）双曲-抛物线清理法，它通过引入一个标量场 $\\psi(\\boldsymbol{x},t)$ 来修正感应方程，以传播和衰减 $\\nabla\\cdot\\boldsymbol{B}$ 误差：\n$$\\partial_{t}\\boldsymbol{B}+\\nabla\\times(\\boldsymbol{v}\\times\\boldsymbol{B})+\\nabla\\psi=\\boldsymbol{0},\\qquad \\partial_{t}\\psi+c_{h}^{2}\\,\\nabla\\cdot\\boldsymbol{B}=-c_{p}^{2}\\,\\psi,$$\n其中 $c_{h}$ 是清理波速，$c_{p}$ 是衰减率。另一种常用方法是椭圆投影（也称为泊松投影），它通过求解泊松方程得到一个标量势 $\\phi(\\boldsymbol{x},t)$，并应用 $\\boldsymbol{B}\\leftarrow\\boldsymbol{B}-\\nabla\\phi$ 来修正磁场。约束输运（CT）方法通过使用边中心的电场来更新面中心的磁通量，从而保持离散的无散条件。\n\n从上述基本定律和事实出发，执行以下操作：\n\n- 推导在理想导电壁上的边界条件，该条件确保法向磁分量 $\\boldsymbol{n}\\cdot\\boldsymbol{B}$ 在壁上随时间保持不变。\n- 使用 GLM 清理方程，推导标量清理场 $\\psi$ 的边界条件，该条件足以在壁上强制执行 $\\partial_{t}(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$。\n- 对于椭圆投影清理法，证明在修正 $\\boldsymbol{B}\\leftarrow\\boldsymbol{B}-\\nabla\\phi$ 后，投影势 $\\phi$ 的何种边界条件能够保持壁上 $\\boldsymbol{n}\\cdot\\boldsymbol{B}$ 的值。\n- 基于以上推导，用文字解释约束输运（CT）、GLM 和椭圆投影清理法在实践中是如何强制执行或遵守在理想导电壁上 $\\boldsymbol{n}\\cdot\\boldsymbol{B}$ 固定的约束的。\n\n你最终报告的答案必须是壁上 $\\psi$ 的边界条件的单一解析表达式，该条件强制执行 $\\partial_{t}(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$。不需要进行数值计算，最终报告的表达式中不应包含任何单位。定义 $\\partial_{n}$ 表示 $\\boldsymbol{n}\\cdot\\nabla$。",
            "solution": "该问题陈述是理论和计算磁流体动力学（MHD）领域一个有效练习。它具有科学依据，问题提法恰当且客观。所有必要的方程、定义和边界条件都已提供，以进行所要求的推导和解释。该问题没有说明中列出的任何使其无效的缺陷。因此，我们可以着手解决。\n\n该问题要求就理想 MHD 中静止、理想导电壁上磁场的行为进行四项相互关联的推导和解释，特别是在数值散度清理方法的背景下。\n\n首先，我们根据基本定律推导壁上法向磁场分量 $\\boldsymbol{n}\\cdot\\boldsymbol{B}$ 的时间行为。$\\boldsymbol{n}\\cdot\\boldsymbol{B}$ 的变化率由 $\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B})$ 给出。由于壁是静止的，向外的单位法向量 $\\boldsymbol{n}$ 不随时间变化，所以我们有：\n$$\n\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B}) = \\boldsymbol{n}\\cdot\\partial_t\\boldsymbol{B}\n$$\n根据麦克斯韦-法拉第感应定律，$\\partial_t\\boldsymbol{B} = -\\nabla\\times\\boldsymbol{E}$。将此代入上式，得到：\n$$\n\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B}) = -\\boldsymbol{n}\\cdot(\\nabla\\times\\boldsymbol{E})\n$$\n我们可以使用矢量恒等式 $\\nabla\\cdot(\\boldsymbol{A}\\times\\boldsymbol{C}) = \\boldsymbol{C}\\cdot(\\nabla\\times\\boldsymbol{A}) - \\boldsymbol{A}\\cdot(\\nabla\\times\\boldsymbol{C})$。令 $\\boldsymbol{A}=\\boldsymbol{E}$ 和 $\\boldsymbol{C}=\\boldsymbol{n}$（在边界上对位置求导的语境下，$\\boldsymbol{n}$ 是一个常矢量场），我们有 $\\nabla\\times\\boldsymbol{n} = \\boldsymbol{0}$。因此，该恒等式简化为 $\\nabla\\cdot(\\boldsymbol{E}\\times\\boldsymbol{n}) = -\\boldsymbol{n}\\cdot(\\nabla\\times\\boldsymbol{E})$。这个关系也称为斯托克斯定理的切向部分，其中 $\\boldsymbol{n}\\cdot(\\nabla\\times\\boldsymbol{E})$ 表示 $\\boldsymbol{E}$ 的切向分量的表面旋度。因此，我们可以写出：\n$$\n\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B}) = \\nabla\\cdot(\\boldsymbol{E}\\times\\boldsymbol{n})\n$$\n边界是理想导电壁，其上电场的切向分量为零，即 $\\boldsymbol{n}\\times\\boldsymbol{E}=\\boldsymbol{0}$。这等价于 $\\boldsymbol{E}\\times\\boldsymbol{n} = - (\\boldsymbol{n}\\times\\boldsymbol{E}) = \\boldsymbol{0}$。由于矢量场 $\\boldsymbol{E}\\times\\boldsymbol{n}$ 在整个边界面上恒为零，其表面散度 $\\nabla\\cdot(\\boldsymbol{E}\\times\\boldsymbol{n})$ 也必定为零。因此：\n$$\n\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B}) = 0\n$$\n这表明，理想 MHD 的基本定律和理想导电壁上的边界条件自然地意味着壁上磁场的法向分量随时间保持不变。\n\n第二，我们分析广义拉格朗日乘子（GLM）清理法。修正后的感应方程为：\n$$\n\\partial_{t}\\boldsymbol{B}+\\nabla\\times(\\boldsymbol{v}\\times\\boldsymbol{B})+\\nabla\\psi=\\boldsymbol{0}\n$$\n我们希望找到标量场 $\\psi$ 的一个边界条件，以在静止壁上强制执行 $\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$。将 GLM 方程与 $\\boldsymbol{n}$ 做点积可得：\n$$\n\\boldsymbol{n}\\cdot\\partial_t\\boldsymbol{B} + \\boldsymbol{n}\\cdot(\\nabla\\times(\\boldsymbol{v}\\times\\boldsymbol{B})) + \\boldsymbol{n}\\cdot\\nabla\\psi = 0\n$$\n为了强制执行 $\\boldsymbol{n}\\cdot\\partial_t\\boldsymbol{B} = \\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B}) = 0$，我们需要：\n$$\n\\boldsymbol{n}\\cdot(\\nabla\\times(\\boldsymbol{v}\\times\\boldsymbol{B})) + \\boldsymbol{n}\\cdot\\nabla\\psi = 0\n$$\n在壁上，流体速度为零，即 $\\boldsymbol{v}=\\boldsymbol{0}$。因此，矢量场 $\\boldsymbol{F} = \\boldsymbol{v}\\times\\boldsymbol{B}$ 在边界面上恒为零。在 $\\boldsymbol{F}=\\boldsymbol{0}$ 的表面上计算 $\\boldsymbol{n}\\cdot(\\nabla\\times\\boldsymbol{F})$ 项，结果为零。这可以从恒等式 $\\boldsymbol{n}\\cdot(\\nabla\\times\\boldsymbol{F}) = \\nabla_S \\cdot (\\boldsymbol{F} \\times \\boldsymbol{n})$ 看出，其中 $\\nabla_S \\cdot$ 是表面散度算子。由于在表面上 $\\boldsymbol{F}=\\boldsymbol{0}$，因此 $\\boldsymbol{F}\\times\\boldsymbol{n}=\\boldsymbol{0}$，其表面散度也为零。于是，条件简化为：\n$$\n\\boldsymbol{n}\\cdot\\nabla\\psi = 0\n$$\n使用所提供的法向导数定义 $\\partial_n \\equiv \\boldsymbol{n}\\cdot\\nabla$，对 $\\psi$ 所需的边界条件是一个齐次 Neumann 条件：\n$$\n\\partial_n\\psi = 0\n$$\n\n第三，我们考虑椭圆投影法。在一个时间步后，可能已经产生一些数值散度的磁场表示为 $\\boldsymbol{B}_{\\text{old}}$。通过减去一个标量势 $\\phi$ 的梯度来对其进行修正：\n$$\n\\boldsymbol{B}_{\\text{new}} \\leftarrow \\boldsymbol{B}_{\\text{old}} - \\nabla\\phi\n$$\n其中 $\\phi$ 是通过求解 Poisson 方程 $\\nabla^2\\phi = \\nabla\\cdot\\boldsymbol{B}_{\\text{old}}$ 得到的。我们想找到 $\\phi$ 的边界条件，以保持壁上磁场的法向分量不变，即 $\\boldsymbol{n}\\cdot\\boldsymbol{B}_{\\text{new}} = \\boldsymbol{n}\\cdot\\boldsymbol{B}_{\\text{old}}$。将修正步骤与 $\\boldsymbol{n}$ 做点积，得到：\n$$\n\\boldsymbol{n}\\cdot\\boldsymbol{B}_{\\text{new}} = \\boldsymbol{n}\\cdot\\boldsymbol{B}_{\\text{old}} - \\boldsymbol{n}\\cdot\\nabla\\phi\n$$\n为了保持法向分量不变，我们必须有 $\\boldsymbol{n}\\cdot\\nabla\\phi = 0$。再次使用法向导数的定义，这导致了投影势 $\\phi$ 的齐次 Neumann 边界条件：\n$$\n\\partial_n\\phi = 0\n$$\n\n第四，我们提供一个比较性解释，说明这三种方法如何处理约束 $\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$。\n- **约束输运（CT）**方法旨在将 $\\nabla\\cdot\\boldsymbol{B}=0$ 的离散版本保持到机器精度。它们通过使用边中心的电场更新面中心的磁场来实现这一点，其方式模仿了 Stokes' theorem。在理想导电壁上，物理边界条件是切向电场为零。在 CT 方案中，这意味着将壁边界上的边中心电场设置为零。壁面上法向磁场分量的更新取决于这些边电场的线积分。由于它们都为零，法向磁通量的时间导数精确为零。因此，CT 内在地、精确地强制执行 $\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$，这是其公式和物理边界条件实施的直接结果。\n- **广义拉格朗日乘子（GLM）**本身不保持该条件。如上所述，为了在 $\\boldsymbol{v}=\\boldsymbol{0}$ 的壁上强制执行 $\\partial_t(\\boldsymbol{n}\\cdot\\boldsymbol{B})=0$，必须为标量清理场 $\\psi$ 显式地施加一个齐次 Neumann 边界条件 $\\partial_n\\psi=0$。这个条件确保了修正项 $\\nabla\\psi$ 没有垂直于壁的分量，因此不会改变 $\\boldsymbol{n}\\cdot\\boldsymbol{B}$。这样，散度清理机制就被迫只在边界上沿切向运作。\n- **椭圆投影**是一种修正性而非预防性的方法。它在一个时间步之后应用，以消除任何累积的散度。如我们的推导所示，为了在修正过程中保持壁上 $\\boldsymbol{n}\\cdot\\boldsymbol{B}$ 的物理常数值，必须使用齐次 Neumann 边界条件 $\\partial_n\\phi = 0$ 来求解势 $\\phi$ 的 Poisson 方程。这确保了修正场 $-\\nabla\\phi$ 在壁上是纯切向的，因此投影只修改了那里 $\\boldsymbol{B}$ 的切向分量，而法向分量保持不变。\n\n总而言之，CT 通过其基本结构强制执行该约束，而 GLM 和椭圆投影则需要对其各自的标量势（$\\psi$ 和 $\\phi$）显式地施加齐次 Neumann 边界条件，以遵守理想导电壁上的物理约束。",
            "answer": "$$\n\\boxed{\\partial_n \\psi = 0}\n$$"
        }
    ]
}