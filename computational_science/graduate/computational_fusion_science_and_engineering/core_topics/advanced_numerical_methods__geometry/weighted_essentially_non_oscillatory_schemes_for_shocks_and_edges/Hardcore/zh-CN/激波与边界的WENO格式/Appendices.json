{
    "hands_on_practices": [
        {
            "introduction": "为了掌握WENO等先进格式，我们必须首先理解它们旨在解决的核心问题：激波。本练习将我们带回守恒律的基本积分形式，推导控制激波传播速度的著名Rankine-Hugoniot跳跃条件。通过这个推导，您将深入理解激波速度与其两侧物理状态之间的精确数学关系，这是所有激波捕捉格式的理论基石。",
            "id": "4065381",
            "problem": "在计算聚变科学与工程中，当非线性对流占主导地位时，边缘等离子体的简化输运模型中会出现激波状前沿和陡峭边缘。加权基本无振荡（WENO）格式被设计用于捕捉此类间断而无伪振荡，并且其激波传感器和通量分裂与底层的守恒结构一致。考虑对流量 $u(x,t)$ 的无量纲一维标量守恒律，\n$$\nu_{t} + f(u)_{x} = 0,\n$$\n其定义在整个实轴上，并具有黎曼初值数据\n$$\nu(x,0) = \\begin{cases} u_{L},  x  0, \\\\ u_{R},  x > 0, \\end{cases}\n$$\n其中 $u_{L}$ 和 $u_{R}$ 是恒定的左态和右态。假设弱解形成一个以恒定速度 $s$ 运动的单一移动间断，其位置在 $x = s\\,t$。\n\n从 $u_{t} + f(u)_{x} = 0$ 所蕴含的积分守恒陈述以及跨越移动间断的弱解定义出发，推导郎肯-雨果尼奥（Rankine–Hugoniot）跳跃条件，该条件将激波速度 $s$ 与前沿两侧的跳跃量 $[u]$ 和 $[f(u)]$ 联系起来。然后，将其特化为无粘性伯格斯（Burgers）通量 $f(u) = u^{2}/2$，并针对上述黎曼数据，计算激波速度 $s$ 作为 $u_{L}$ 和 $u_{R}$ 的闭式解析函数。\n\n将 $s$ 的最终答案表示为 $u_{L}$ 和 $u_{R}$ 的单个解析表达式。无需四舍五入。所有变量均为无量纲。",
            "solution": "所述问题具有科学依据，内容完备且提法恰当。它展示了双曲型偏微分方程理论中的一个标准推导，该理论是流体动力学和输运现象（包括聚变科学中的现象）计算建模的基本工具。所有必要的组成部分都已提供。\n\n该问题要求两个主要结果：首先，推导一般标量守恒律的郎肯-雨果尼奥跳跃条件；其次，给出无粘性伯格斯方程的激波速度的具体形式。\n\n让我们从一般的一维标量守恒律开始，\n$$\nu_{t} + f(u)_{x} = 0,\n$$\n其中 $u = u(x,t)$ 是守恒量，$f(u)$ 是通量函数。下标表示偏微分。对于光滑解，此微分方程是守恒的一种陈述。对于包含间断的解，我们必须回到守恒律的积分形式。将方程在一个固定的空间区间 $[x_{1}, x_{2}]$ 上积分，得到：\n$$\n\\int_{x_{1}}^{x_{2}} u_{t} \\, dx + \\int_{x_{1}}^{x_{2}} f(u)_{x} \\, dx = 0.\n$$\n假设有足够的光滑性，我们可以对第一项交换积分和微分的次序，并对第二项应用微积分基本定理：\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx + \\left[ f(u(x,t)) \\right]_{x=x_{1}}^{x=x_{2}} = 0.\n$$\n这得出了积分守恒律：\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = f(u(x_{1}, t)) - f(u(x_{2}, t)).\n$$\n即使对于包含间断的弱解，该方程也成立。\n\n给定解由一个位于 $x_{s}(t) = s\\,t$ 的单一移动间断构成，其中 $s$ 是恒定速度。对于给定的黎曼初值数据，解是分段常数：\n$$\nu(x,t) = \\begin{cases} u_{L},  x  s\\,t, \\\\ u_{R},  x > s\\,t. \\end{cases}\n$$\n此处，$u_{L}$ 和 $u_{R}$ 分别是间断左侧和右侧的恒定状态。\n\n考虑一个包含间断的区间 $[x_{1}, x_{2}]$，因此有 $x_{1}  s\\,t  x_{2}$。我们计算积分守恒律的左侧。积分必须在间断点处分开：\n$$\n\\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = \\int_{x_{1}}^{s\\,t} u(x,t) \\, dx + \\int_{s\\,t}^{x_{2}} u(x,t) \\, dx.\n$$\n代入分段常数解，我们有：\n$$\n\\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = \\int_{x_{1}}^{s\\,t} u_{L} \\, dx + \\int_{s\\,t}^{x_{2}} u_{R} \\, dx = u_{L}(s\\,t - x_{1}) + u_{R}(x_{2} - s\\,t).\n$$\n现在，我们对时间 $t$ 求导，注意 $x_{1}$ 和 $x_{2}$ 是固定的：\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = \\frac{d}{dt} \\left( u_{L}s\\,t - u_{L}x_{1} + u_{R}x_{2} - u_{R}s\\,t \\right) = u_{L}s - u_{R}s = s(u_{L} - u_{R}).\n$$\n获得此结果的另一种更通用的方法是使用适用于移动区域的莱布尼茨（Leibniz）积分法则。对于形式为 $\\int_{a(t)}^{b(t)} g(x,t) \\, dx$ 的积分，其时间导数为 $\\int_{a(t)}^{b(t)} g_{t} \\, dx + g(b(t),t)b'(t) - g(a(t),t)a'(t)$。将此应用于我们的分段积分，并注意到在光滑区域 $u_{t}=0$，我们得到：\n$$\n\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u \\, dx = \\left( u_L \\frac{d(st)}{dt} - 0 \\right) + \\left( 0 - u_R \\frac{d(st)}{dt} \\right) = u_{L}s - u_{R}s = s(u_{L} - u_{R}).\n$$\n\n接下来，我们在区间 $[x_{1}, x_{2}]$ 收缩至间断点的极限情况下，计算积分守恒律的右侧。我们令 $x_{1} \\to (s\\,t)^{-}$ 且 $x_{2} \\to (s\\,t)^{+}$。在此极限下：\n$$\nf(u(x_{1}, t)) - f(u(x_{2}, t)) \\to f(u_{L}) - f(u_{R}).\n$$\n令左右两边相等，得到：\n$$\ns(u_{L} - u_{R}) = f(u_{L}) - f(u_{R}).\n$$\n该方程将间断速度 $s$ 与守恒量的跳跃 $[u] = u_{L} - u_{R}$ 以及通量的跳跃 $[f(u)] = f(u_{L}) - f(u_{R})$ 联系起来。假设 $u_{L} \\neq u_{R}$，对 $s$ 重新整理，我们得到郎肯-雨果尼奥跳跃条件：\n$$\ns = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}} = \\frac{[f(u)]}{[u]}.\n$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们特化为无粘性伯格斯方程，其通量函数由下式给出：\n$$\nf(u) = \\frac{u^{2}}{2}.\n$$\n左态和右态对应的通量值为 $f(u_{L}) = \\frac{u_{L}^{2}}{2}$ 和 $f(u_{R}) = \\frac{u_{R}^{2}}{2}$。将这些代入郎肯-雨果尼奥条件，得出：\n$$\ns = \\frac{\\frac{u_{L}^{2}}{2} - \\frac{u_{R}^{2}}{2}}{u_{L} - u_{R}}.\n$$\n我们可以通过对分子进行因式分解来简化此表达式：\n$$\ns = \\frac{\\frac{1}{2}(u_{L}^{2} - u_{R}^{2})}{u_{L} - u_{R}} = \\frac{\\frac{1}{2}(u_{L} - u_{R})(u_{L} + u_{R})}{u_{L} - u_{R}}.\n$$\n由于存在间断，我们必有 $u_{L} \\neq u_{R}$，这意味着项 $(u_{L} - u_{R})$ 非零，可以从分子和分母中消去。这给出了激波速度 $s$ 的最终闭式表达式：\n$$\ns = \\frac{1}{2}(u_{L} + u_{R}).\n$$\n激波速度是间断两侧特征速度的算术平均值。注意，要从给定的黎曼数据形成一个物理上可接受的激波，我们必须满足熵条件 $u_L > u_R$。如果 $u_L  u_R$，解将是一个连续的稀疏波。然而，题目要求在假设形成激波的条件下推导激波速度，我们的推导正确地提供了这一点。",
            "answer": "$$\\boxed{\\frac{u_{L} + u_{R}}{2}}$$"
        },
        {
            "introduction": "理解了激波的数学性质后，我们来探究为何传统的高阶方法难以胜任。本练习将指导您从基本原理出发，构建一个三阶的线性重构格式。您将亲眼见证，这个在光滑区域表现良好的格式在遇到不连续时会产生非物理的振荡（即吉布斯现象），从而深刻理解为何需要像WENO这样更复杂的非线性方法。",
            "id": "4065325",
            "problem": "一个一维双曲守恒律 $\\partial_t u + \\partial_x f(u) = 0$ 使用有限体积法在均匀网格上进行离散化，该网格的间距为 $\\Delta x$，单元中心为 $x_i$，界面为 $x_{i\\pm 1/2}$。单元 $i$ 内的单元平均值为 $\\bar{u}_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) \\, dx$。在存在陡峭梯度和激波的聚变边缘输运模拟中，为了计算高阶界面通量，需要进行分段多项式重构以获得左侧点值 $u_{i+1/2}^- = \\lim_{x \\to x_{i+1/2}^-} u_h(x)$。\n\n从单元平均值的基本有限体积定义以及重构必须与之匹配的要求出发，在单元 $i$ 内，基于三个相邻单元平均值 $\\{\\bar{u}_{i-1}, \\bar{u}_i, \\bar{u}_{i+1}\\}$ 的模板，构造一个二次多项式 $p_i(x)$，使得 $p_i(x)$ 在每个单元 $i-1$、$i$ 和 $i+1$ 上的平均值等于相应的 $\\bar{u}_j$。仅使用均匀网格的几何形状和平均值约束来确定系数。然后，将左侧界面值 $u_{i+1/2}^- = p_i(x_{i+1/2})$ 显式地计算为 $\\bar{u}_{i-1}$、$\\bar{u}_i$ 和 $\\bar{u}_{i+1}$ 的闭式函数。\n\n最后，为了突显当模板跨越激波时产生的振荡，考虑一个带有间断的无量纲聚变边缘剖面：取 $\\bar{u}_{i-1} = 1$、$\\bar{u}_i = 0$ 和 $\\bar{u}_{i+1} = 0$，并计算重构值 $u_{i+1/2}^-$ 的数值。简要解释为什么这个结果表明了线性三阶重构在跨越间断时的振荡行为，并（定性地）评论加权基本无振荡（WENO）格式在这种情况下会如何修改模板的贡献。\n\n将你的最终答案表述为 $u_{i+1/2}^-$ 关于 $\\bar{u}_{i-1}$、$\\bar{u}_i$ 和 $\\bar{u}_{i+1}$ 的显式闭式表达式。无需四舍五入，也无需单位。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它在双曲守恒律的数值方法领域提出了一个标准的、非平凡的问题，特别关注高阶多项式重构，这是计算科学与工程中使用的WENO等格式的一个基本概念。\n\n解决该问题的过程包括三个主要步骤：1) 定义一个二次多项式，并根据给定的单元平均值约束建立一个线性方程组；2) 解此方程组，以单元平均值表示多项式的系数；3) 在单元界面处对多项式求值，以找到所需的重构值。\n\n设均匀网格的单元间距为 $\\Delta x$。我们定义一个以单元 $i$ 为中心的局部坐标 $\\xi$，使得 $x = x_i + \\xi \\Delta x$。在这个局部坐标系中，单元 $i$ 对应于 $\\xi \\in [-\\frac{1}{2}, \\frac{1}{2}]$，单元 $i-1$ 对应于 $\\xi \\in [-\\frac{3}{2}, -\\frac{1}{2}]$，单元 $i+1$ 对应于 $\\xi \\in [\\frac{1}{2}, \\frac{3}{2}]$。\n\n我们寻求一个二次多项式 $p_i(x)$，我们用局部坐标 $\\xi$ 将其写为：\n$$\np_i(\\xi) = a_0 + a_1 \\xi + a_2 \\xi^2\n$$\n系数 $a_0$、$a_1$ 和 $a_2$ 由以下约束条件确定：这个单一多项式在模板中三个单元 $\\{\\text{单元 } i-1, \\text{单元 } i, \\text{单元 } i+1\\}$ 上的平均值必须等于相应的已知单元平均值 $\\{\\bar{u}_{i-1}, \\bar{u}_i, \\bar{u}_{i+1}\\}$。\n\n函数 $g(\\xi)$ 在区间 $[\\alpha, \\beta]$ 上的平均值为 $\\frac{1}{\\beta-\\alpha} \\int_\\alpha^\\beta g(\\xi) d\\xi$。由于在 $\\xi$ 坐标中我们的区间长度为1，所以平均值就是积分。\n\n1.  **对单元 $i$ 的约束**：$p_i(\\xi)$ 在单元 $i$ ($[-\\frac{1}{2}, \\frac{1}{2}]$) 上的平均值必须是 $\\bar{u}_i$。\n    $$\n    \\bar{u}_i = \\int_{-1/2}^{1/2} (a_0 + a_1 \\xi + a_2 \\xi^2) \\, d\\xi = [a_0 \\xi + \\frac{a_1}{2}\\xi^2 + \\frac{a_2}{3}\\xi^3]_{-1/2}^{1/2}\n    $$\n    $$\n    \\bar{u}_i = a_0(\\frac{1}{2} - (-\\frac{1}{2})) + \\frac{a_1}{2}((\\frac{1}{2})^2 - (-\\frac{1}{2})^2) + \\frac{a_2}{3}((\\frac{1}{2})^3 - (-\\frac{1}{2})^3) = a_0(1) + \\frac{a_1}{2}(0) + \\frac{a_2}{3}(\\frac{1}{8} + \\frac{1}{8})\n    $$\n    $$\n    \\bar{u}_i = a_0 + \\frac{a_2}{12} \\quad (1)\n    $$\n\n2.  **对单元 $i+1$ 的约束**：$p_i(\\xi)$ 在单元 $i+1$ ($[\\frac{1}{2}, \\frac{3}{2}]$) 上的平均值必须是 $\\bar{u}_{i+1}$。\n    $$\n    \\bar{u}_{i+1} = \\int_{1/2}^{3/2} (a_0 + a_1 \\xi + a_2 \\xi^2) \\, d\\xi = [a_0 \\xi + \\frac{a_1}{2}\\xi^2 + \\frac{a_2}{3}\\xi^3]_{1/2}^{3/2}\n    $$\n    $$\n    \\bar{u}_{i+1} = a_0(\\frac{3}{2} - \\frac{1}{2}) + \\frac{a_1}{2}((\\frac{3}{2})^2 - (\\frac{1}{2})^2) + \\frac{a_2}{3}((\\frac{3}{2})^3 - (\\frac{1}{2})^3) = a_0(1) + \\frac{a_1}{2}(\\frac{9}{4} - \\frac{1}{4}) + \\frac{a_2}{3}(\\frac{27}{8} - \\frac{1}{8})\n    $$\n    $$\n    \\bar{u}_{i+1} = a_0 + a_1 + \\frac{13}{12} a_2 \\quad (2)\n    $$\n\n3.  **对单元 $i-1$ 的约束**：$p_i(\\xi)$ 在单元 $i-1$ ($[-\\frac{3}{2}, -\\frac{1}{2}]$) 上的平均值必须是 $\\bar{u}_{i-1}$。\n    $$\n    \\bar{u}_{i-1} = \\int_{-3/2}^{-1/2} (a_0 + a_1 \\xi + a_2 \\xi^2) \\, d\\xi = [a_0 \\xi + \\frac{a_1}{2}\\xi^2 + \\frac{a_2}{3}\\xi^3]_{-3/2}^{-1/2}\n    $$\n    $$\n    \\bar{u}_{i-1} = a_0(-\\frac{1}{2} - (-\\frac{3}{2})) + \\frac{a_1}{2}((-\\frac{1}{2})^2 - (-\\frac{3}{2})^2) + \\frac{a_2}{3}((-\\frac{1}{2})^3 - (-\\frac{3}{2})^3) = a_0(1) + \\frac{a_1}{2}(\\frac{1}{4} - \\frac{9}{4}) + \\frac{a_2}{3}(-\\frac{1}{8} + \\frac{27}{8})\n    $$\n    $$\n    \\bar{u}_{i-1} = a_0 - a_1 + \\frac{13}{12} a_2 \\quad (3)\n    $$\n\n我们现在求解线性方程组 $(1)$、$(2)$ 和 $(3)$，以得到 $a_0, a_1, a_2$。\n从方程 $(2)$ 中减去方程 $(3)$：\n$$\n\\bar{u}_{i+1} - \\bar{u}_{i-1} = (a_0 + a_1 + \\frac{13}{12} a_2) - (a_0 - a_1 + \\frac{13}{12} a_2) = 2 a_1\n$$\n$$\na_1 = \\frac{1}{2}(\\bar{u}_{i+1} - \\bar{u}_{i-1})\n$$\n将方程 $(2)$ 和 $(3)$ 相加：\n$$\n\\bar{u}_{i+1} + \\bar{u}_{i-1} = (a_0 + a_1 + \\frac{13}{12} a_2) + (a_0 - a_1 + \\frac{13}{12} a_2) = 2 a_0 + \\frac{13}{6} a_2\n$$\n根据方程 $(1)$，我们有 $a_0 = \\bar{u}_i - \\frac{a_2}{12}$。将此代入相加后的方程中：\n$$\n\\bar{u}_{i+1} + \\bar{u}_{i-1} = 2(\\bar{u}_i - \\frac{a_2}{12}) + \\frac{13}{6} a_2 = 2\\bar{u}_i - \\frac{1}{6} a_2 + \\frac{13}{6} a_2 = 2\\bar{u}_i + \\frac{12}{6} a_2 = 2\\bar{u}_i + 2 a_2\n$$\n重新整理以求解 $a_2$：\n$$\n2 a_2 = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}\n$$\n$$\na_2 = \\frac{1}{2}(\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1})\n$$\n求得 $a_1$ 和 $a_2$ 后，我们可以从方程 (1) 中求得 $a_0$：\n$$\na_0 = \\bar{u}_i - \\frac{1}{12} a_2 = \\bar{u}_i - \\frac{1}{24}(\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1})\n$$\n问题要求在界面 $x_{i+1/2}$ 处的左侧点值，即 $u_{i+1/2}^- = p_i(x_{i+1/2})$。在局部坐标系中，$x_{i+1/2}$ 对应于 $\\xi = \\frac{1}{2}$。我们计算 $p_i(\\frac{1}{2})$：\n$$\nu_{i+1/2}^- = p_i(\\xi=\\frac{1}{2}) = a_0 + a_1(\\frac{1}{2}) + a_2(\\frac{1}{2})^2 = a_0 + \\frac{1}{2} a_1 + \\frac{1}{4} a_2\n$$\n代入系数的表达式：\n$$\nu_{i+1/2}^- = \\left( \\bar{u}_i - \\frac{1}{24}(\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1}) \\right) + \\frac{1}{2} \\left( \\frac{1}{2}(\\bar{u}_{i+1} - \\bar{u}_{i-1}) \\right) + \\frac{1}{4} \\left( \\frac{1}{2}(\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1}) \\right)\n$$\n$$\nu_{i+1/2}^- = \\bar{u}_i - \\frac{1}{24}(\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1}) + \\frac{1}{4}(\\bar{u}_{i+1} - \\bar{u}_{i-1}) + \\frac{1}{8}(\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1})\n$$\n对每个单元平均值 $\\bar{u}_j$ 合并同类项：\n- 对于 $\\bar{u}_{i-1}$：$-\\frac{1}{24} - \\frac{1}{4} + \\frac{1}{8} = \\frac{-1 - 6 + 3}{24} = -\\frac{4}{24} = -\\frac{1}{6}$\n- 对于 $\\bar{u}_i$：$1 - \\frac{-2}{24} - \\frac{2}{8} = 1 + \\frac{1}{12} - \\frac{1}{4} = \\frac{12 + 1 - 3}{12} = \\frac{10}{12} = \\frac{5}{6}$\n- 对于 $\\bar{u}_{i+1}$：$-\\frac{1}{24} + \\frac{1}{4} + \\frac{1}{8} = \\frac{-1 + 6 + 3}{24} = \\frac{8}{24} = \\frac{1}{3}$\n\n将这些系数组合起来，得到重构值的闭式表达式：\n$$\nu_{i+1/2}^- = -\\frac{1}{6}\\bar{u}_{i-1} + \\frac{5}{6}\\bar{u}_i + \\frac{1}{3}\\bar{u}_{i+1}\n$$\n\n对于问题的最后一部分，我们考虑一个带有间断的剖面，其中 $\\bar{u}_{i-1} = 1$，$\\bar{u}_i = 0$，$\\bar{u}_{i+1} = 0$。将这些值代入公式：\n$$\nu_{i+1/2}^- = -\\frac{1}{6}(1) + \\frac{5}{6}(0) + \\frac{1}{3}(0) = -\\frac{1}{6}\n$$\n这个结果表明了振荡行为。输入的单元平均值都是非负的（1 和 0）。然而，高阶多项式重构产生了一个负值 $-\\frac{1}{6}$，这是一个下冲（undershoot）。对于像密度或温度这样的物理量，这将是一个不符合物理实际的结果。这是吉布斯现象（Gibbs phenomenon）的一种表现，即光滑函数（多项式）试图逼近一个间断时会导致振荡。\n\n加权基本无振荡（WENO）格式就是为防止这种情况而设计的。WENO不使用一个固定的模板，而是考虑多个候选模板（例如，$\\{\\bar{u}_{i-2}, \\bar{u}_{i-1}, \\bar{u}_i\\}$、$\\{\\bar{u}_{i-1}, \\bar{u}_i, \\bar{u}_{i+1}\\}$、$\\{\\bar{u}_i, \\bar{u}_{i+1}, \\bar{u}_{i+2}\\}$）。它为每个模板计算一个“光滑度指示子”。跨越激波的模板 $\\{\\bar{u}_{i-1}, \\bar{u}_i, \\bar{u}_{i+1}\\} = \\{1, 0, 0\\}$ 是高度非光滑的，其光滑度指示子会很大。位于光滑区域的模板，例如 $\\{\\bar{u}_i, \\bar{u}_i, \\bar{u}_{i+2}\\} = \\{0, 0, 0\\}$（假设激波已经过去），是完全光滑的，并且具有一个小的指示子。然后，WENO为每个模板的重构分配一个非线性权重，给振荡的模板一个非常小的权重，而给光滑的模板一个大的权重。最终的重构值是一个加权平均值，其中最光滑模板的贡献占主导地位，从而有效抑制振荡，并在本例中产生一个接近0的值。\n\n要求提供的最终答案是 $u_{i+1/2}^-$ 的闭式表达式。",
            "answer": "$$\\boxed{-\\frac{1}{6}\\bar{u}_{i-1} + \\frac{5}{6}\\bar{u}_i + \\frac{1}{3}\\bar{u}_{i+1}}$$"
        },
        {
            "introduction": "在明确了非线性格式的必要性之后，我们将深入WENO方法的核心机制。在这个计算实践中，您将亲手实现五阶WENO-JS重构，并将其应用于一个包含陡峭梯度的剖面，模拟聚变等离子体边缘的物理情景。通过计算和分析该格式的关键组成部分——光滑度指示因子和非线性权重，您将直观地理解WENO如何智能地抑制跨越间断的模板的贡献以消除振荡，同时在光滑区域恢复高阶精度。",
            "id": "4065296",
            "problem": "考虑由守恒律 $u_t + a u_x = 0$ 控制的一维标量平流，其中平流速度 $a$ 为常数。在计算聚变科学与工程中，例如在台基状剖面中，会出现陡峭但连续的边缘梯度。加权基本无振荡 (Weighted Essentially Non-Oscillatory, WENO) 格式旨在重构高阶界面值，同时抑制激波或尖锐边缘附近的伪振荡。\n\n从守恒律的基本定义和在均匀网格上为数值通量重构界面状态的需求出发，推导并实现五阶加权基本无振荡-Jiang-Shu (WENO-JS) 过程，以便在具有周期性边界条件和网格间距 $\\Delta x$ 的均匀网格上，根据点样本 $u_i = u(x_i)$ 重构界面 $x_{i+1/2}$ 处的左状态。使用标准的左偏三模板重构，由候选模板上的局部多项式近似推导出的 WENO-JS 光滑度指示子 $\\beta_k$ ($k \\in \\{0,1,2\\}$)，由 $\\alpha_k = d_k / (\\varepsilon + \\beta_k)^p$ 和 $\\omega_k = \\alpha_k / \\sum_{m=0}^2 \\alpha_m$ 定义的非线性权重，以及理想线性权重 $d_0 = 1/10$, $d_1 = 6/10$, $d_2 = 3/10$。选择 $p = 2$ 和 $\\varepsilon = 10^{-6}$。除了左状态重构之外，不使用任何通量分裂。\n\n通过在周期性域 $x \\in [0,1]$ 上采用剖面 $u(x) = \\tanh\\!\\left(\\dfrac{x - x_0}{\\delta}\\right)$ 来研究尖锐但连续边缘的影响。对于每个测试用例，设 $N$ 为均匀间隔的网格点数，$x_j = j \\Delta x$（其中 $j \\in \\{0,1,\\dots,N-1\\}$），$x_0$ 为边缘位置，$\\delta$ 为梯度控制参数。将所有量视为无量纲；不涉及物理单位。\n\n对每个测试用例，执行以下步骤：\n- 计算离散样本 $u_j = u(x_j)$，其中 $j = 0,1,\\dots,N-1$。\n- 确定使 $|x_i - x_0|$ 最小化的索引 $i^\\ast$（“边缘单元”）。\n- 确定一个“光滑单元”索引 $i_s$，其 $x_i$ 最接近 $0.1$。\n- 在 $i^\\ast$ 和 $i_s$ 处，使用周期性索引获取必要的相邻值，计算 WENO-JS 光滑度指示子 $\\beta_0$、$\\beta_1$、$\\beta_2$。\n- 在 $i^\\ast$ 和 $i_s$ 处，根据 $\\beta_k$ 和给定的 $(p,\\varepsilon,d_k)$ 计算非线性权重 $\\omega_k$。\n- 定义以下三个测试度量：\n  1. $R = \\dfrac{\\beta_0 + \\beta_1 + \\beta_2 \\ \\text{at}\\ i^\\ast}{\\beta_0 + \\beta_1 + \\beta_2 \\ \\text{at}\\ i_s}$，该度量衡量边缘附近光滑度指示子的相对放大程度。\n  2. $D_{\\text{edge}} = \\sum_{k=0}^2 \\left|\\omega_k(i^\\ast) - d_k\\right|$，该度量衡量边缘附近非线性权重与理想线性权重的偏差。\n  3. $D_{\\text{smooth}} = \\sum_{k=0}^2 \\left|\\omega_k(i_s) - d_k\\right|$，该度量衡量光滑区域中非线性权重与理想线性权重的偏差。\n\n解释要求：使用多项式重构和光滑度指示子的第一性原理来解释，为什么对于一个尖锐但连续的边缘，光滑度指示子会惩罚跨越边缘的模板（增加 $\\beta_k$），从而减小相应的非线性权重并抑制振荡，而在光滑区域，指示子在所有模板上都保持较小且数值相近，从而得到 $\\omega_k \\approx d_k$ 并恢复高阶精度。\n\n测试套件：\n- 测试用例 1：$N = 200$, $x_0 = 0.5$, $\\delta = 0.02$。\n- 测试用例 2：$N = 200$, $x_0 = 0.47$, $\\delta = 0.05$。\n- 测试用例 3：$N = 200$, $x_0 = 0.5$, $\\delta = 0.20$。\n\n答案规格：\n- 对于每个测试用例，计算三个度量 $(R, D_{\\text{edge}}, D_{\\text{smooth}})$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按测试用例和度量排序：$[R_1, D_{\\text{edge},1}, D_{\\text{smooth},1}, R_2, D_{\\text{edge},2}, D_{\\text{smooth},2}, R_3, D_{\\text{edge},3}, D_{\\text{smooth},3}]$。",
            "solution": "该问题要求推导并实现五阶加权基本无振荡-Jiang-Shu (WENO-JS) 重构过程，以分析其在尖锐但连续的边缘剖面上的行为，这一研究受到计算聚变科学应用的启发。分析将通过计算与该格式的光滑度指示子和非线性权重相关的特定度量来进行。\n\n### 1. 理论框架：WENO-JS 重构\n\n我们考虑在一维标量平流方程 $u_t + a u_x = 0$ 上，使用间距为 $\\Delta x$ 的均匀网格 $\\{x_i\\}$。用于该方程的数值格式，特别是基于有限体积法或有限差分法的格式，需要在单元界面（例如 $x_{i+1/2} = x_i + \\Delta x/2$）处重构解值。WENO 方法通过自适应地组合多个低阶重构，提供了一种高阶、无振荡的重构。\n\n对于一个五阶精度格式，我们使用一个包含五个点的全局模板。为从左侧重构界面 $x_{i+1/2}$ 处的状态（假设平流速度 $a  0$），我们使用左偏模板 $\\{u_{i-2}, u_{i-1}, u_i, u_{i+1}, u_{i+2}\\}$。这个全局模板被划分为三个各包含三个点的候选模板：\n-   $S_0 = \\{x_{i-2}, x_{i-1}, x_i\\}$\n-   $S_1 = \\{x_{i-1}, x_i, x_{i+1}\\}$\n-   $S_2 = \\{x_i, x_{i+1}, x_{i+2}\\}$\n\n在每个模板 $S_k$ 上，构建一个唯一的二次多项式 $p_k(x)$，该多项式在相应的网格点上对解值进行插值。这些多项式提供了界面值 $u_{i+1/2}$ 的三阶候选重构，记为 $\\hat{u}_{i+1/2}^{(k)}$。这些重构的显式公式为：\n$$ \\hat{u}_{i+1/2}^{(0)} = \\frac{1}{3}u_{i-2} - \\frac{7}{6}u_{i-1} + \\frac{11}{6}u_i $$\n$$ \\hat{u}_{i+1/2}^{(1)} = -\\frac{1}{6}u_{i-1} + \\frac{5}{6}u_{i} + \\frac{1}{3}u_{i+1} $$\n$$ \\hat{u}_{i+1/2}^{(2)} = \\frac{1}{3}u_{i} + \\frac{5}{6}u_{i+1} - \\frac{1}{6}u_{i+2} $$\n\n最终的五阶重构是这些候选值的凸组合：\n$$ u_{i+1/2} = \\sum_{k=0}^{2} \\omega_k \\hat{u}_{i+1/2}^{(k)} $$\n其中 $\\omega_k$ 是非线性权重。\n\n### 2. 光滑度指示子与非线性权重\n\nWENO 格式的核心在于权重 $\\omega_k$ 的定义。它们被设计为依赖于插值多项式 $p_k(x)$ 在其相应模板 $S_k$ 上所表示函数的光滑性。\n\n**光滑度指示子 ($\\beta_k$)**: 每个多项式 $p_k(x)$ 的光滑性由一个光滑度指示子 $\\beta_k$ 来衡量。$\\beta_k$ 的标准定义是对 $p_k(x)$ 的各阶导数在区间 $[x_{i-1/2}, x_{i+1/2}]$ 上的归一化平方 $L^2$ 范数进行求和：\n$$ \\beta_k = \\sum_{l=1}^{2} \\int_{x_{i-1/2}}^{x_{i+1/2}} (\\Delta x)^{2l-1} \\left( \\frac{d^l p_k(x)}{dx^l} \\right)^2 dx $$\n对于均匀网格，这些积分可以根据点值 $u_j$ 显式地计算出来。得到的公式为：\n$$ \\beta_0 = \\frac{13}{12}(u_{i-2} - 2u_{i-1} + u_i)^2 + \\frac{1}{4}(u_{i-2} - 4u_{i-1} + 3u_i)^2 $$\n$$ \\beta_1 = \\frac{13}{12}(u_{i-1} - 2u_i + u_{i+1})^2 + \\frac{1}{4}(u_{i-1} - u_{i+1})^2 $$\n$$ \\beta_2 = \\frac{13}{12}(u_i - 2u_{i+1} + u_{i+2})^2 + \\frac{1}{4}(3u_i - 4u_{i+1} + u_{i+2})^2 $$\n$\\beta_k$ 表达式中的每一项都近似于解的缩放导数。例如，$(u_{i-1} - 2u_i + u_{i+1})$ 与二阶导数成正比，而 $(u_{i+1} - u_{i-1})$ 与一阶导数成正比。因此，如果解在模板 $S_k$ 上表现出大的导数（即非光滑），$\\beta_k$ 的值就很大。\n\n**非线性权重 ($\\omega_k$)**: 非线性权重 $\\omega_k$ 是根据光滑度指示子 $\\beta_k$ 计算得出的。该过程从理想线性权重 $d_k$ 开始，这些权重的选择是为了在 $\\omega_k = d_k$ 时，重构在光滑区域能达到五阶精度。问题指定 $d_0 = 1/10$，$d_1 = 6/10$，$d_2 = 3/10$。注意 $\\sum d_k = 1$。\n\n非线性权重按以下方式计算：\n1.  定义未归一化权重 $\\alpha_k$：\n    $$ \\alpha_k = \\frac{d_k}{(\\varepsilon + \\beta_k)^p} $$\n    此处，$\\varepsilon$ 是一个很小的正数，用以防止在完全光滑的区域（此时 $\\beta_k=0$）出现除以零的情况，$p$ 是一个正整数，用于控制权重对光滑度指示子的敏感度。问题指定 $p=2$ 和 $\\varepsilon=10^{-6}$。\n\n2.  最终的归一化权重 $\\omega_k$ 通过以下方式计算：\n    $$ \\omega_k = \\frac{\\alpha_k}{\\sum_{m=0}^{2} \\alpha_m} $$\n    这确保了 $\\sum \\omega_k = 1$，使得最终的重构成为一个凸组合。\n\n### 3. WENO-JS 行为的解释\n\nWENO-JS 权重的设计赋予了其自适应、无振荡的特性。\n\n-   **在光滑区域**: 当解 $u(x)$ 光滑时，其导数很小。因此，所有三个重叠模板的光滑度指示子 $\\beta_k$ 都会很小且量级相近（$\\beta_k \\approx 0$）。在这种情况下，$\\alpha_k \\approx d_k / \\varepsilon^p$。随后的归一化步骤得出：\n    $$ \\omega_k = \\frac{d_k/\\varepsilon^p}{\\sum_m d_m/\\varepsilon^p} = \\frac{d_k}{\\sum_m d_m} = d_k $$\n    非线性权重近似于理想线性权重，格式恢复了底层线性重构的最佳五阶精度。用于衡量偏差 $|\\omega_k - d_k|$ 的度量 $D_{\\text{smooth}}$ 将会非常小。\n\n-   **在尖锐边缘附近**: 在陡峭梯度或间断附近，至少会有一个模板跨越该特征。对于那个模板（比如 $S_j$），插值多项式 $p_j(x)$ 必须适应一个大的变化，从而导致大的导数。这使得对应的光滑度指示子 $\\beta_j$ 的值变得非常大，即 $\\beta_j \\gg \\varepsilon$。未归一化的权重 $\\alpha_j = d_j/(\\varepsilon+\\beta_j)^p$ 会变得极小。因此，最终权重 $\\omega_j$ 也几乎变为零。该格式有效地“关闭”了来自非光滑模板的贡献，并将其权重分配给位于更光滑区域的模板。这种动态重加权过程防止了跨越尖锐特征使用高阶多项式，否则会引入伪振荡（吉布斯现象）。度量 $R$ 和 $D_{\\text{edge}}$ 将会很大，反映了大的 $\\beta$ 值以及 $\\omega_k$ 与理想权重 $d_k$ 之间的显著偏差。\n\n### 4. 测试用例的实现\n\n所提供的测试用例在周期性域 $[0,1]$ 上使用剖面 $u(x) = \\tanh((x - x_0)/\\delta)$。我们将在一个包含 $N$ 个点的网格上将此函数离散化，并计算靠近边缘中心点 ($i^\\ast$) 和光滑区域中的一个点 ($i_s$) 的光滑度指示子和权重。对于给定的索引 $j$，计算需要访问五个相邻点 $\\{u_{j-2}, \\dots, u_{j+2}\\}$。在周期性域上，索引通过模运算符处理，例如 $u_{j \\pmod N}$。然后基于这些量计算指定的度量 $R$、 $D_{\\text{edge}}$ 和 $D_{\\text{smooth}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Computes WENO-JS metrics for given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (200, 0.5, 0.02),  # Test Case 1: N, x0, delta\n        (200, 0.47, 0.05), # Test Case 2\n        (200, 0.5, 0.20),  # Test Case 3\n    ]\n\n    # WENO-JS parameters\n    d_k = np.array([0.1, 0.6, 0.3])\n    p = 2\n    epsilon = 1e-6\n\n    full_results = []\n\n    def compute_weno_quantities(i, u_data, N):\n        \"\"\"\n        Computes WENO smoothness indicators and nonlinear weights for index i.\n        \n        Args:\n            i (int): The index for which to compute the reconstruction stencil.\n            u_data (np.array): The array of discrete solution values.\n            N (int): The number of grid points.\n\n        Returns:\n            tuple: A tuple containing (betas, omegas) as numpy arrays.\n        \"\"\"\n        # Get the 5-point stencil using periodic boundary conditions\n        # The modulo operator handles periodicity correctly.\n        um2 = u_data[(i - 2) % N]\n        um1 = u_data[(i - 1) % N]\n        ui0 = u_data[i % N]\n        up1 = u_data[(i + 1) % N]\n        up2 = u_data[(i + 2) % N]\n\n        # Calculate smoothness indicators (beta_k)\n        beta0 = (13./12.) * (um2 - 2*um1 + ui0)**2 + (1./4.) * (um2 - 4*um1 + 3*ui0)**2\n        beta1 = (13./12.) * (um1 - 2*ui0 + up1)**2 + (1./4.) * (um1 - up1)**2\n        beta2 = (13./12.) * (ui0 - 2*up1 + up2)**2 + (1./4.) * (3*ui0 - 4*up1 + up2)**2\n        betas = np.array([beta0, beta1, beta2])\n\n        # Calculate nonlinear weights (omega_k)\n        alphas = d_k / (epsilon + betas)**p\n        alpha_sum = np.sum(alphas)\n        omegas = alphas / alpha_sum\n        \n        return betas, omegas\n\n    for case in test_cases:\n        N, x0, delta = case\n        \n        # 1. Compute discrete samples\n        dx = 1.0 / N\n        x = np.linspace(0, 1.0 - dx, N)\n        u = np.tanh((x - x0) / delta)\n        \n        # 2. Identify indices i_star (edge) and i_s (smooth)\n        i_star = np.argmin(np.abs(x - x0))\n        i_s = np.argmin(np.abs(x - 0.1))\n\n        # 3. Compute smoothness indicators and weights at i_star and i_s\n        betas_edge, omegas_edge = compute_weno_quantities(i_star, u, N)\n        betas_smooth, omegas_smooth = compute_weno_quantities(i_s, u, N)\n        \n        # 4. Compute the three test metrics\n        # Metric 1: R\n        sum_beta_edge = np.sum(betas_edge)\n        sum_beta_smooth = np.sum(betas_smooth)\n        R = sum_beta_edge / sum_beta_smooth if sum_beta_smooth != 0 else float('inf')\n\n        # Metric 2: D_edge\n        D_edge = np.sum(np.abs(omegas_edge - d_k))\n\n        # Metric 3: D_smooth\n        D_smooth = np.sum(np.abs(omegas_smooth - d_k))\n\n        full_results.extend([R, D_edge, D_smooth])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{val:.8e}' for val in full_results)}]\")\n\nsolve()\n```"
        }
    ]
}