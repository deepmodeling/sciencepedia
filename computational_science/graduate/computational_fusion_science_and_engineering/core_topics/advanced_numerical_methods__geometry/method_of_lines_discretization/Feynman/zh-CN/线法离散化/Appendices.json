{
    "hands_on_practices": [
        {
            "introduction": "在使用线方法（Method of Lines）时，时间积分方案的稳定性是首要关注点。第一个实践练习将通过分析平流和扩散方程的空间离散化算子的特征值，深入探讨基本的 Courant-Friedrichs-Lewy (CFL) 条件 。掌握这一分析对于选择有效的时间步长 $\\Delta t$ 至关重要，以确保您的模拟不会产生不合物理的、发散的结果。",
            "id": "4010125",
            "problem": "考虑一个长度为 $L$ 的均匀、周期性等离子体柱中的一维线性输运和扩散，采用线法 (MoL) 进行建模。输运方程为 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\neq 0$ 为常数；扩散方程为 $u_{t} = \\alpha\\,u_{xx}$，其中扩散系数 $\\alpha > 0$ 为常数。设空间网格有 $N$ 个点，均匀间距为 $h = L/N$，并采用周期性边界条件。对于平流，使用与 $a$ 的符号一致的一阶迎风空间离散格式；对于扩散，使用二阶中心差分拉普拉斯算子。在这两种情况下，都使用具有恒定时间步长 $\\Delta t$ 的显式向前欧拉法进行时间推进。\n\n从标量线性常微分方程 $y'(t) = \\lambda\\,y(t)$ 采用显式向前欧拉法推进的基本稳定性条件出发，即放大因子 $1 + \\Delta t\\,\\lambda$ 必须满足 $|1 + \\Delta t\\,\\lambda| \\leq 1$，将 MoL 半离散系统视为线性系统 $U'(t) = A\\,U(t)$ (平流) 和 $U'(t) = L\\,U(t)$ (扩散)。利用周期性网格上循环离散平流和扩散矩阵的谱特性，确定由最大稳定时间步长的无量纲界限定义的精确 Courant–Friedrichs–Lewy (CFL) 稳定性常数 $C_{\\mathrm{adv}}$ 和 $C_{\\mathrm{diff}}$，其形式分别为用于迎风平流的 $\\Delta t_{\\max} = C_{\\mathrm{adv}}\\,h/|a|$ 和用于显式扩散的 $\\Delta t_{\\max} = C_{\\mathrm{diff}}\\,h^{2}/\\alpha$。您的答案必须是精确值对 $(C_{\\mathrm{adv}}, C_{\\mathrm{diff}})$，不得四舍五入，以行矩阵形式呈现。不需要单位。",
            "solution": "问题要求确定在周期性一维网格上对半离散化的线性平流和扩散方程使用显式向前欧拉法进行时间积分的稳定性常数。线法 (MoL) 将偏微分方程 (PDE) 转换为一个常微分方程组 (ODE)，$U'(t) = M U(t)$，其中 $U(t)$ 是网格点上解值的向量，$M$ 是空间离散化矩阵。\n\n向前欧拉法 $U_{n+1} = U_n + \\Delta t M U_n = (I + \\Delta t M) U_n$ 的稳定性由矩阵 $M$ 的特征值决定。对于标量 ODE $y'(t) = \\lambda y(t)$，如果放大因子 $g = 1 + \\Delta t \\lambda$ 满足 $|g| \\le 1$，则向前欧拉步是稳定的。对于系统 $U'(t) = M U(t)$，这个条件必须对矩阵 $M$ 的所有特征值 $\\lambda_k$ 都成立。也就是说，对于所有的 $k$，我们必须有 $|1 + \\Delta t \\lambda_k| \\le 1$。\n\n空间网格是周期性的，这意味着指定格式的离散化矩阵是循环矩阵。一个第一行为 $(c_0, c_1, \\dots, c_{N-1})$ 的 $N \\times N$ 循环矩阵的特征值由以下公式给出：\n$$ \\lambda_k = \\sum_{j=0}^{N-1} c_j \\omega^{kj} \\quad \\text{for } k = 0, 1, \\dots, N-1 $$\n其中 $\\omega = \\exp(2\\pi i/N)$ 是 $N$ 次单位主根。\n\n我们将分别分析平流和扩散问题。\n\n**第一部分：使用一阶迎风格式的线性平流**\n\nPDE 为 $u_t = -a u_x$。空间离散化必须是迎风格式，这意味着它取决于平流速度 $a$ 的符号。\n\n情况 1：$a > 0$。信息沿正 $x$ 方向传播。迎风格式对空间导数使用后向差分：$(u_x)_j \\approx (U_j - U_{j-1})/h$。网格点 $j$ 的半离散 ODE 为：\n$$ \\frac{dU_j}{dt} = -a \\frac{U_j - U_{j-1}}{h} $$\n这构成了系统 $U'(t) = A U(t)$。矩阵 $A$ 是循环矩阵。为了找到它的第一行，我们考虑 $j=0$ 的方程：由于周期性，$dU_0/dt = (-a/h)U_0 + (a/h)U_{N-1}$。矩阵元素为 $A_{j,j} = -a/h$ 和 $A_{j,j-1} = a/h$ (下标对 $N$ 取模)。\n$A$ 的第一行为 $( -a/h, 0, \\dots, 0, a/h )$。特征值公式对应的系数为 $c_0 = -a/h$ 和 $c_{N-1} = a/h$。\n特征值 $\\lambda_k(A)$ 为：\n$$ \\lambda_k(A) = c_0 \\omega^{k \\cdot 0} + c_{N-1} \\omega^{k(N-1)} = -\\frac{a}{h} + \\frac{a}{h} \\omega^{k(N-1)} $$\n使用 $\\omega^{k(N-1)} = \\omega^{-k} = \\exp(-2\\pi i k/N)$，我们得到：\n$$ \\lambda_k(A) = \\frac{a}{h} (\\omega^{-k} - 1) = \\frac{a}{h} \\left( \\cos\\left(\\frac{2\\pi k}{N}\\right) - 1 - i \\sin\\left(\\frac{2\\pi k}{N}\\right) \\right) $$\n稳定性条件是 $|1 + \\Delta t \\lambda_k(A)| \\le 1$。令 $C_{\\mathrm{num}} = a \\Delta t/h$ 为数值 Courant 数 (因为 $a>0$，所以 $C_{\\mathrm{num}} = |a|\\Delta t/h$)。\n$$ \\left|1 + C_{\\mathrm{num}} \\left(\\cos\\theta_k - 1 - i\\sin\\theta_k \\right)\\right|^2 \\le 1 $$\n其中 $\\theta_k = 2\\pi k/N$。\n$$ (1 + C_{\\mathrm{num}}(\\cos\\theta_k - 1))^2 + (-C_{\\mathrm{num}}\\sin\\theta_k)^2 \\le 1 $$\n$$ 1 + 2C_{\\mathrm{num}}(\\cos\\theta_k - 1) + C_{\\mathrm{num}}^2(\\cos\\theta_k - 1)^2 + C_{\\mathrm{num}}^2\\sin^2\\theta_k \\le 1 $$\n$$ 2C_{\\mathrm{num}}(\\cos\\theta_k - 1) + C_{\\mathrm{num}}^2(\\cos^2\\theta_k - 2\\cos\\theta_k + 1 + \\sin^2\\theta_k) \\le 0 $$\n$$ 2C_{\\mathrm{num}}(\\cos\\theta_k - 1) + C_{\\mathrm{num}}^2(2 - 2\\cos\\theta_k) \\le 0 $$\n$$ -2C_{\\mathrm{num}}(1 - \\cos\\theta_k) + 2C_{\\mathrm{num}}^2(1 - \\cos\\theta_k) \\le 0 $$\n$$ 2C_{\\mathrm{num}}(1 - \\cos\\theta_k)(C_{\\mathrm{num}} - 1) \\le 0 $$\n因为 $C_{\\mathrm{num}} > 0$ 且 $1 - \\cos\\theta_k \\ge 0$，这个不等式必须对所有 $k$ 成立。对于 $k \\ne 0$，我们需要 $C_{\\mathrm{num}} - 1 \\le 0$，这意味着 $C_{\\mathrm{num}} \\le 1$。\n\n情况 2：$a < 0$。信息沿负 $x$ 方向传播。迎风格式使用前向差分：$(u_x)_j \\approx (U_{j+1} - U_j)/h$。半离散 ODE 为：\n$$ \\frac{dU_j}{dt} = -a \\frac{U_{j+1} - U_j}{h} $$\n矩阵 $A$ 的元素为 $A_{j,j} = a/h$ 和 $A_{j,j+1} = -a/h$。$A$ 的第一行为 $( a/h, -a/h, 0, \\dots, 0 )$。系数为 $c_0 = a/h$ 和 $c_1 = -a/h$。\n特征值 $\\lambda_k(A)$ 为：\n$$ \\lambda_k(A) = c_0 + c_1 \\omega^k = \\frac{a}{h} (1 - \\omega^k) = \\frac{a}{h} \\left( 1 - \\cos\\theta_k - i\\sin\\theta_k \\right) $$\n令 Courant 数为 $C = |a|\\Delta t/h = -a\\Delta t/h > 0$。则 $a\\Delta t/h = -C$。\n稳定性条件变为：\n$$ |1 - C(1 - \\cos\\theta_k - i\\sin\\theta_k)|^2 \\le 1 $$\n$$ (1-C(1-\\cos\\theta_k))^2 + (C\\sin\\theta_k)^2 \\le 1 $$\n这导致与情况 1 相同的代数步骤，结果为：\n$$ 2C(1-\\cos\\theta_k)(C-1) \\le 0 $$\n同样地，因为 $C > 0$ 且 $1-\\cos\\theta_k \\ge 0$，我们必须有 $C-1 \\le 0$，所以 $C \\le 1$。\n\n在两种情况下，稳定性条件都是 $C = |a|\\Delta t/h \\le 1$，所以 $\\Delta t \\le h/|a|$。\n问题定义了 $\\Delta t_{\\max} = C_{\\mathrm{adv}} h/|a|$。比较这些可得 $C_{\\mathrm{adv}} = 1$。\n\n**第二部分：使用二阶中心差分格式的扩散**\n\nPDE 为 $u_t = \\alpha u_{xx}$。拉普拉斯算子的二阶中心差分为 $(u_{xx})_j \\approx (U_{j+1} - 2U_j + U_{j-1})/h^2$。半离散 ODE 为：\n$$ \\frac{dU_j}{dt} = \\alpha \\frac{U_{j+1} - 2U_j + U_{j-1}}{h^2} $$\n这构成了系统 $U'(t) = L U(t)$。矩阵 $L$ 的对角元素为 $L_{j,j} = -2\\alpha/h^2$，非对角元素为 $L_{j,j\\pm 1} = \\alpha/h^2$。\n由于周期性，$L$ 的第一行为 $( -2\\alpha/h^2, \\alpha/h^2, 0, \\dots, 0, \\alpha/h^2 )$。特征值公式的系数为 $c_0 = -2\\alpha/h^2$，$c_1 = \\alpha/h^2$ 和 $c_{N-1} = \\alpha/h^2$。\n特征值 $\\lambda_k(L)$ 为：\n$$ \\lambda_k(L) = c_0 + c_1 \\omega^k + c_{N-1} \\omega^{k(N-1)} = \\frac{\\alpha}{h^2} (-2 + \\omega^k + \\omega^{-k}) $$\n使用 $\\omega^k + \\omega^{-k} = 2\\cos(2\\pi k/N)$，我们发现：\n$$ \\lambda_k(L) = \\frac{\\alpha}{h^2} (2\\cos(2\\pi k/N) - 2) = -\\frac{2\\alpha}{h^2} (1 - \\cos(2\\pi k/N)) $$\n使用半角恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$：\n$$ \\lambda_k(L) = -\\frac{4\\alpha}{h^2} \\sin^2\\left(\\frac{\\pi k}{N}\\right) $$\n特征值是实数且非正。稳定性条件 $|1 + \\Delta t \\lambda_k| \\le 1$ 简化为 $-1 \\le 1 + \\Delta t \\lambda_k \\le 1$。右侧不等式 $\\Delta t \\lambda_k \\le 0$ 总是满足的，因为 $\\alpha, \\Delta t, h^2 > 0$，所以 $\\lambda_k \\le 0$。左侧不等式施加了约束条件：\n$$ -2 \\le \\Delta t \\lambda_k $$\n$$ -2 \\le -\\Delta t \\frac{4\\alpha}{h^2} \\sin^2\\left(\\frac{\\pi k}{N}\\right) $$\n$$ \\Delta t \\frac{4\\alpha}{h^2} \\sin^2\\left(\\frac{\\pi k}{N}\\right) \\le 2 $$\n$$ \\Delta t \\le \\frac{h^2}{2\\alpha \\sin^2(\\pi k/N)} $$\n这个条件必须对所有 $k = 0, \\dots, N-1$ 成立。最严格的条件 (最小的 $\\Delta t$) 出现在分母最小时，也就是当 $\\sin^2(\\pi k/N)$ 最大时。$\\sin^2(\\pi k/N)$ 的最大值为 $1$，这发生在网格能支持的最高频率模式下，例如，当 $N$为偶数时 $k=N/2$。这对应于 $2h$ 的最短波长。取这个最大值可以得到稳定性极限：\n$$ \\Delta t \\le \\frac{h^2}{2\\alpha} $$\n最大稳定时间步长为 $\\Delta t_{\\max} = h^2/(2\\alpha)$。问题定义了 $\\Delta t_{\\max} = C_{\\mathrm{diff}} h^2/\\alpha$。比较这些可得 $C_{\\mathrm{diff}} = 1/2$。\n\n稳定性常数对为 $(C_{\\mathrm{adv}}, C_{\\mathrm{diff}}) = (1, 1/2)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1 & \\frac{1}{2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "从理想化的周期性区域转向实际问题时，精确地实现物理边界条件对于进行真实的模拟至关重要。本练习  演示了如何离散化一个具有重要物理意义的 Robin 边界条件，该条件用于模拟等离子体与壁相互作用中的表面效应。您将学习如何在边界上构建一个高阶精确的近似，并将其整合到线方法系统中，从而将离散方程与真实世界的物理过程联系起来。",
            "id": "4010183",
            "problem": "考虑一个标量粒子密度场 $u(x,t)$ 在磁约束聚变等离子体刮削层中沿坐标 $x \\in [0,L]$ 的一维跨场扩散，该过程由 Fickian 扩散控制，\n$$\n\\frac{\\partial u}{\\partial t} = k\\,\\frac{\\partial^{2}u}{\\partial x^{2}},\n$$\n其中 $k>0$ 是扩散系数。在材料壁（$x=0$）处，表面复合施加了一个 Robin 边界条件，该条件使扩散通量等于线性表面复合，\n$$\n-k\\,\\frac{\\partial u}{\\partial x}(0,t) = \\beta\\left(u(0,t) - u_{\\infty}\\right),\n$$\n其中 $\\beta \\ge 0$ 是表面复合率，$u_{\\infty}$ 是一个给定的远场饱和密度。在芯部侧（$x=L$），假设一个对称（零通量）边界条件，但在此推导中不显式使用它。\n\n使用均匀网格 $x_{i} = i\\,h$（$i=0,1,\\dots,N$）对空间域进行离散化，网格间距为 $h=L/N$，并应用方法线法（Method of Lines, MOL）。对于内部节点 $i=1,\\dots,N-1$，使用标准的二阶中心差分来近似二阶导数。在壁面处，通过使用关于 $u_{0}(t)$、$u_{1}(t)$ 和 $u_{2}(t)$ 的单边二阶有限差分来近似 $\\frac{\\partial u}{\\partial x}(0,t)$，从而构造 Robin 边界的二阶精确离散表示。使用这个离散边界条件来消去 $u_{0}(t)$，并将其影响整合到节点 $i=1$ 的半离散方程中，\n$$\n\\frac{d u_{1}}{dt} = \\frac{k}{h^{2}}\\left(u_{2} - 2u_{1} + u_{0}\\right).\n$$\n\n从第一性原理和所述近似出发，推导由于 $u_{\\infty}$ 而出现在节点 $i=1$ 的半离散方程右侧的、由边界引起的常数项的解析表达式。将您的最终答案表示为仅含 $k$、$\\beta$、$h$ 和 $u_{\\infty}$ 的单个闭式表达式。不需要进行数值近似或四舍五入。",
            "solution": "目标是推导节点 $i=1$ 的半离散 MOL 方程中由边界条件引起的常数项。\n\n标量密度场 $u(x,t)$ 的控制偏微分方程（PDE）是 Fick 扩散定律：\n$$\n\\frac{\\partial u}{\\partial t} = k\\,\\frac{\\partial^{2}u}{\\partial x^{2}}\n$$\n其中 $k > 0$ 是扩散系数。区域为 $x \\in [0,L]$。\n\n在材料壁 $x=0$ 处的 Robin 边界条件由下式给出：\n$$\n-k\\,\\frac{\\partial u}{\\partial x}(0,t) = \\beta\\left(u(0,t) - u_{\\infty}\\right)\n$$\n其中 $\\beta \\ge 0$ 是表面复合率，$u_{\\infty}$ 是一个恒定的远场密度。\n\n空间域通过均匀网格 $x_i = i h$（$i=0, 1, \\dots, N$）进行离散化，网格间距为 $h=L/N$。我们将这些网格点上的函数值表示为 $u_i(t) = u(x_i, t)$。\n\n方法线法（MOL）将偏微分方程（PDE）转换为关于时间的常微分方程组（ODEs）。对于内部节点，二阶空间导数使用标准的二阶中心差分进行近似。具体来说，在节点 $i=1$ 处，半离散方程为：\n$$\n\\frac{d u_{1}}{dt} = \\frac{k}{h^{2}}\\left(u_{2} - 2u_{1} + u_{0}\\right)\n$$\n为了完善这个方程，我们必须通过离散化 Robin 边界条件来找到边界值 $u_0$ 的表达式。\n\n该问题要求使用点 $u_0$、$u_1$ 和 $u_2$ 来对 $x=0$ 处的空间导数 $\\frac{\\partial u}{\\partial x}$ 使用单边二阶有限差分近似。我们使用 $u(h)$ 和 $u(2h)$ 在 $x=0$ 附近的泰勒级数展开，从第一性原理推导这个近似：\n$$\nu_1 = u(h) = u(0) + h \\frac{\\partial u}{\\partial x}\\bigg|_{x=0} + \\frac{h^2}{2} \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x=0} + O(h^3)\n$$\n$$\nu_2 = u(2h) = u(0) + 2h \\frac{\\partial u}{\\partial x}\\bigg|_{x=0} + \\frac{(2h)^2}{2} \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x=0} + O(h^3) = u(0) + 2h \\frac{\\partial u}{\\partial x}\\bigg|_{x=0} + 2h^2 \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x=0} + O(h^3)\n$$\n我们寻求 $u_0$、$u_1$ 和 $u_2$ 的一个线性组合，以二阶精度近似 $\\frac{\\partial u}{\\partial x}\\big|_{x=0}$。我们可以消去二阶导数项。将第一个展开式乘以 $4$ 并减去第二个展开式，得到：\n$$\n4u_1 - u_2 = \\left(4u_0 + 4h \\frac{\\partial u}{\\partial x}\\bigg|_{x=0} + 2h^2 \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x=0}\\right) - \\left(u_0 + 2h \\frac{\\partial u}{\\partial x}\\bigg|_{x=0} + 2h^2 \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x=0}\\right) + O(h^3)\n$$\n$$\n4u_1 - u_2 = 3u_0 + 2h \\frac{\\partial u}{\\partial x}\\bigg|_{x=0} + O(h^3)\n$$\n求解导数：\n$$\n2h \\frac{\\partial u}{\\partial x}\\bigg|_{x=0} = -3u_0 + 4u_1 - u_2 + O(h^3)\n$$\n$$\n\\frac{\\partial u}{\\partial x}\\bigg|_{x=0} = \\frac{-3u_0 + 4u_1 - u_2}{2h} + O(h^2)\n$$\n这就是所要求的二阶精确单边差分公式。\n\n现在，我们将这个离散近似代入 Robin 边界条件：\n$$\n-k \\left( \\frac{-3u_0 + 4u_1 - u_2}{2h} \\right) = \\beta (u_0 - u_{\\infty})\n$$\n我们接下来解这个关于 $u_0$ 的方程，以便从 $u_1$ 的常微分方程中消去它。\n$$\nk(3u_0 - 4u_1 + u_2) = 2h\\beta(u_0 - u_{\\infty})\n$$\n$$\n3ku_0 - 4ku_1 + ku_2 = 2h\\beta u_0 - 2h\\beta u_{\\infty}\n$$\n将含有 $u_0$ 的项归并：\n$$\n3ku_0 - 2h\\beta u_0 = 4ku_1 - ku_2 - 2h\\beta u_{\\infty}\n$$\n$$\nu_0(3k - 2h\\beta) = 4ku_1 - ku_2 - 2h\\beta u_{\\infty}\n$$\n假设 $3k - 2h\\beta \\neq 0$，我们可以将 $u_0$ 表示为：\n$$\nu_0 = \\frac{4ku_1 - ku_2 - 2h\\beta u_{\\infty}}{3k - 2h\\beta}\n$$\n接下来，我们将 $u_0$ 的这个表达式代入 $u_1$ 的半离散方程中：\n$$\n\\frac{d u_{1}}{dt} = \\frac{k}{h^{2}}\\left(u_{2} - 2u_{1} + \\left(\\frac{4ku_1 - ku_2 - 2h\\beta u_{\\infty}}{3k - 2h\\beta}\\right)\\right)\n$$\n问题要求的是右侧由边界引起的常数项，也就是包含 $u_{\\infty}$ 的项。我们可以从上面的表达式中分离出这一项：\n$$\n\\text{常数项} = \\frac{k}{h^{2}} \\left( \\frac{-2h\\beta u_{\\infty}}{3k - 2h\\beta} \\right)\n$$\n化简此表达式得到最终结果：\n$$\n\\text{常数项} = \\frac{-2kh\\beta u_{\\infty}}{h^2(3k - 2h\\beta)} = -\\frac{2k\\beta u_{\\infty}}{h(3k - 2h\\beta)}\n$$\n该表达式也可以写成 $\\frac{2k\\beta u_{\\infty}}{h(2h\\beta - 3k)}$。我们将使用前一种表示形式。这一项代表了在节点 $i=1$ 处的恒定源/汇效应，它源于边界 $x=0$ 处的物理表面复合过程。",
            "answer": "$$\n\\boxed{-\\frac{2k\\beta u_{\\infty}}{h(3k - 2h\\beta)}}\n$$"
        },
        {
            "introduction": "最后的这项实践将线方法的概念综合到一个完整的、与研究相关的聚变等离子体物理应用中。您将为一个用于研究离子温度梯度 (ITG) 不稳定性的半离散模型编写程序，这是托卡马克中驱动湍流输运的关键机制 。该练习涉及为系统构建演化矩阵，求解生成的常微分方程组，并对随时间变化的解进行数据分析，以提取该模式的线性增长率，从而将数值方法与物理发现联系起来。",
            "id": "4010196",
            "problem": "考虑在静电、无碰撞、单离子种类极限下，具有绝热电子响应的线性离子温度梯度（ITG）模。从离子的线性回旋动理学方程和准中性闭合出发。在局域、板模型、单$k_y$近似下，径向坐标$x$上具有简化的一维空间变化和周期性边界条件，为标量回旋中心微扰场$f(x,t)$和静电势$\\phi(x,t)$的演化提出了以下半离散线方法模型：\n1. 空间域为 $x \\in [0,2\\pi]$，具有周期性边界条件。\n2. 空间离散化使用包含$N$个点、间距为$\\Delta x$的均匀网格，并对空间导数采用二阶中心有限差分近似。这将空间算子转换为矩阵，并产生一个关于时间的常微分方程组（ODE）。\n3. 在每一时刻，势$\\phi(x,t)$由一个线性的椭圆型准中性闭合确定。该闭合通过作用于$\\phi$的算子$A$来包含有限拉莫尔半径（FLR）和极化效应，其结果等于瞬时的$f$：\n$$\nA \\phi \\equiv \\big( D - \\rho_s^2 \\,\\partial_{xx} \\big)\\,\\phi = f,\n$$\n其中 $D \\equiv \\tau + 1 - \\Gamma_0(b)$，$\\tau \\equiv T_i/T_e$，$\\rho_s^2$ 是一个无量纲极化系数，$b \\equiv (k_y \\rho_i)^2$（$k_y$是副法线波数，$\\rho_i$是离子回旋半径），以及 $\\Gamma_0(b) \\equiv I_0(b)\\,e^{-b}$（$I_0$是第一类修正贝塞尔函数）。\n4. $f(x,t)$的时间演化是线性的，由一个扩散加驱动模型给出：\n$$\n\\partial_t f = \\chi\\,\\partial_{xx} f + \\sigma\\, \\phi,\n$$\n其中 $\\chi$ 是一个模拟碰撞/回旋粘性扩散的无量纲扩散系数，$\\sigma$ 是一个与离子逆磁频率和离子温度梯度参数成正比的无量纲线性ITG驱动系数。\n\n该模型是与静电回旋动理学基础一致的线性ITG物理的一种简化且计算上易于处理的表示。线方法离散化将空间算子转换为矩阵：设$L$为具有周期性边界条件的离散二阶导数（拉普拉斯）矩阵，$A \\equiv D\\,I - \\rho_s^2 L$（其中$I$为单位矩阵），以及$K \\equiv A^{-1}$。那么，网格向量$f(t) \\in \\mathbb{R}^N$的半离散ODE为\n$$\n\\frac{d}{dt} f(t) = \\chi\\,L f(t) + \\sigma\\,K f(t).\n$$\n在任何时刻，势可通过以下方式恢复：\n$$\n\\phi(t) = K f(t).\n$$\n\n你的任务是：\n- 为上述模型实现线方法离散化，并使用一个鲁棒的ODE求解器对所得的ODE进行时间积分。\n- 在网格上使用小振幅单模微扰$f(x,0) = A_0 \\sin(k_0 x)$（其中$k_0=1$，$A_0=10^{-3}$）进行初始化。\n- 演化至最终时间$t_{\\text{end}}$，并通过从波数$k_0=1$处$\\phi(x,t)$的基频傅里叶模振幅的时间序列中提取指数增长（或衰减）率来计算线性增长率$\\gamma$。具体来说，计算复傅里叶系数\n$$\n\\Phi_{k_0}(t) = \\frac{1}{N} \\sum_{j=0}^{N-1} \\phi(x_j,t)\\,e^{-i k_0 x_j},\n$$\n并通过对模拟区间后半部分的$\\ln |\\Phi_{k_0}(t)|$与$t$进行最小二乘拟合来估计$\\gamma$，以减少瞬态效应。增长率$\\gamma$必须以无量纲浮点数的形式报告。\n\n使用以下科学上一致的参数值作为测试套件。对于所有情况，均使用$N=64$，域长度$2\\pi$，以及$t_{\\text{end}}=20$：\n- 情况1（名义上不稳定，正常路径）：$\\tau=1.0$, $k_y \\rho_i = 0.3$, $\\rho_s^2 = 0.1$, $\\chi=0.02$, $\\sigma=0.30$。\n- 情况2（接近临界，边界情况）：$\\tau=1.0$, $k_y \\rho_i = 0.5$, $\\rho_s^2 = 0.2$, $\\chi=0.10$, $\\sigma=0.12$。\n- 情况3（已稳定，边缘情况）：$\\tau=1.0$, $k_y \\rho_i = 1.0$, $\\rho_s^2 = 0.5$, $\\chi=0.20$, $\\sigma=0.08$。\n\n所有量均为无量纲。你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3]”），每个结果是对应测试用例的估计增长率$\\gamma$，以无量纲单位的浮点数表示。\n\n确保数值方法是稳定的，并且增长率估计对瞬态动力学具有鲁棒性。",
            "solution": "求解方法如下：首先，我们对空间域和算子进行离散化，将控制偏微分方程（PDE）转换为关于时间的常微分方程组（ODE）。其次，我们从指定的初始条件开始，对该ODE系统进行时间上的向前积分。最后，我们分析解的时间演化，以提取特征增长率。\n\n该模型由两个耦合场组成：回旋中心微扰$f(x,t)$和静电势$\\phi(x,t)$。它们定义在具有周期性边界条件的一维空间域$x \\in [0, 2\\pi]$上。\n\n$\\phi$和$f$之间的关系由一个线性椭圆方程给出，该方程表示包含有限拉莫尔半径（FLR）效应的准中性条件：\n$$\nA \\phi \\equiv \\big( D - \\rho_s^2 \\,\\partial_{xx} \\big)\\,\\phi = f\n$$\n此处，$D$是一个常数，定义为$D \\equiv \\tau + 1 - \\Gamma_0(b)$，其中$\\tau = T_i/T_e$是离子与电子的温度比，$b \\equiv (k_y \\rho_i)^2$是归一化的垂直波数的平方，而$\\Gamma_0(b) \\equiv I_0(b)\\,e^{-b}$涉及第一类修正贝塞尔函数$I_0$。项$\\rho_s^2$是离子极化漂移效应的系数。\n\n回旋中心微扰$f$的时间演化由一个线性反应扩散方程控制：\n$$\n\\partial_t f = \\chi\\,\\partial_{xx} f + \\sigma\\, \\phi\n$$\n其中$\\chi$是扩散系数，$\\sigma$代表ITG驱动的强度。\n\n我们可以通过对算子$A$求逆来用$f$表示$\\phi$，即$\\phi = A^{-1}f$。将此代入$f$的演化方程，得到一个单一的闭合方程：\n$$\n\\partial_t f = \\chi\\,\\partial_{xx} f + \\sigma\\,A^{-1} f = (\\chi\\,\\partial_{xx} + \\sigma\\,A^{-1}) f\n$$\n\n为了数值求解该系统，我们采用线方法。将空间域$x \\in [0, 2\\pi]$离散化为一个包含$N=64$个点的均匀网格，$x_j = j \\Delta x$，$j = 0, 1, \\dots, N-1$，其中网格间距为$\\Delta x = 2\\pi/N$。场$f(x,t)$和$\\phi(x,t)$由它们在这些网格点上的值的向量表示，记为$f(t)$和$\\phi(t)$。\n\n空间导数算子$\\partial_{xx}$通过带有周期性边界条件的二阶中心有限差分格式来近似。这产生一个$N \\times N$的矩阵$L$，即离散拉普拉斯算子。$L$的每一行都具有$[\\dots, 1/\\Delta x^2, -2/\\Delta x^2, 1/\\Delta x^2, \\dots]$的结构，其中非对角元素会环绕以施加周期性。\n\n通过这种离散化，算子$A$变成一个$N \\times N$的矩阵$A_{\\text{mat}} = D\\,I - \\rho_s^2 L$，其中$I$是单位矩阵。算子$A^{-1}$由矩阵的逆$K = A_{\\text{mat}}^{-1}$表示。因此，PDE系统被转换为一个关于向量$f(t)$的$N$个线性耦合ODE系统：\n$$\n\\frac{d}{dt} f(t) = (\\chi L + \\sigma K) f(t)\n$$\n这是一个标准线性ODE系统，形式为$\\frac{d}{dt} f(t) = M f(t)$，其中演化矩阵$M = \\chi L + \\sigma K$不随时间变化。\n\n问题指定了一个单一正弦模的初始条件：$f(x,0) = A_0 \\sin(k_0 x)$，其中振幅$A_0 = 10^{-3}$，模数$k_0=1$。相应的初始向量$f(0)$的分量为$f_j(0) = A_0 \\sin(k_0 x_j)$。我们使用一个鲁棒的数值求解器（具体为`scipy.integrate.solve_ivp`）从这个初始状态开始，将ODE系统积分到最终时间$t_{\\text{end}} = 20$。\n\n在一系列时间点上获得解$f(t)$。在每个时间点$t_k$，我们计算相应的势向量$\\phi(t_k) = K f(t_k)$。为了找到增长率$\\gamma$，我们分析势$\\phi$中初始傅里叶模$k_0=1$的振幅的时间演化。我们通过离散傅里叶变换计算复傅里叶系数$\\Phi_{k_0}(t)$：\n$$\n\\Phi_{k_0}(t_k) = \\frac{1}{N} \\sum_{j=0}^{N-1} \\phi_j(t_k)\\,e^{-i k_0 x_j}\n$$\n对于具有单模初始条件的线性系统，该模式的振幅预期会呈指数级演化，即$|\\Phi_{k_0}(t)| \\propto e^{\\gamma t}$。因此，振幅的自然对数应为时间的线性函数：$\\ln|\\Phi_{k_0}(t)| \\approx \\gamma t + C$。为了确定$\\gamma$，我们对数据点$(t_k, \\ln|\\Phi_{k_0}(t_k)|)$进行线性最小二乘拟合。按照规定，我们仅使用模拟后半段（$t \\in [10, 20]$）的数据，以最小化由数值初始化引起的任何潜在瞬态效应。所得直线的斜率即为我们对线性增长率$\\gamma$的估计。对所提供的三组参数集中的每一组都重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import i0\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the given problem for all test cases and prints the results.\n    \"\"\"\n    \n    # Common parameters for all test cases\n    N = 64\n    domain_length = 2 * np.pi\n    t_end = 20.0\n    A0 = 1e-3\n    k0 = 1\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case 1 (nominally unstable, happy path)\n        {'tau': 1.0, 'ky_rho_i': 0.3, 'rho_s_sq': 0.1, 'chi': 0.02, 'sigma': 0.30},\n        # Case 2 (near marginality, boundary)\n        {'tau': 1.0, 'ky_rho_i': 0.5, 'rho_s_sq': 0.2, 'chi': 0.10, 'sigma': 0.12},\n        # Case 3 (stabilized, edge case)\n        {'tau': 1.0, 'ky_rho_i': 1.0, 'rho_s_sq': 0.5, 'chi': 0.20, 'sigma': 0.08},\n    ]\n\n    results = []\n    for params in test_cases:\n        gamma = calculate_growth_rate(params, N, domain_length, t_end, A0, k0)\n        results.append(gamma)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\ndef calculate_growth_rate(params, N, domain_length, t_end, A0, k0):\n    \"\"\"\n    Calculates the linear growth rate for a single set of parameters.\n    \"\"\"\n    # 1. Setup grid and spatial operators\n    dx = domain_length / N\n    x = np.linspace(0, domain_length - dx, N)\n    \n    # Construct the second-order centered finite-difference Laplacian matrix L with periodic BCs\n    L = np.zeros((N, N))\n    dx_sq_inv = 1.0 / (dx**2)\n    \n    diag_val = -2.0 * dx_sq_inv\n    off_diag_val = 1.0 * dx_sq_inv\n    \n    np.fill_diagonal(L, diag_val)\n    np.fill_diagonal(L[1:], off_diag_val)\n    np.fill_diagonal(L[:, 1:], off_diag_val)\n    L[0, N - 1] = off_diag_val\n    L[N - 1, 0] = off_diag_val\n\n    # 2. Construct model-specific matrices\n    tau = params['tau']\n    ky_rho_i = params['ky_rho_i']\n    rho_s_sq = params['rho_s_sq']\n    chi = params['chi']\n    sigma = params['sigma']\n    \n    b = ky_rho_i**2\n    Gamma0_b = i0(b) * np.exp(-b)\n    D = tau + 1.0 - Gamma0_b\n    \n    I = np.identity(N)\n    A_mat = D * I - rho_s_sq * L\n    K = np.linalg.inv(A_mat)\n    \n    # Evolution matrix M for df/dt = Mf\n    M = chi * L + sigma * K\n    \n    # 3. Time integration\n    # Initial condition: f(x, 0) = A0 * sin(k0 * x)\n    f0 = A0 * np.sin(k0 * x)\n    \n    t_span = [0, t_end]\n    # Evaluate at enough points for a good fit\n    t_eval = np.linspace(t_span[0], t_span[1], 200)\n    \n    # Define the ODE system for the solver\n    def ode_system(t, f):\n        return M @ f\n        \n    sol = solve_ivp(ode_system, t_span, f0, t_eval=t_eval, method='RK45', rtol=1e-8, atol=1e-11)\n    \n    # 4. Post-processing and growth rate extraction\n    # Get the solution f(t)\n    f_t = sol.y\n    \n    # Calculate potential phi(t) = K * f(t)\n    phi_t = K @ f_t\n    \n    # Calculate the Fourier coefficient for k=k0\n    # The DFT coefficient for k is at index k in the output of np.fft.fft\n    # phi_k(t) = (1/N) * sum(phi_j(t) * exp(-i*k*x_j))\n    # We use axis=0 to perform FFT over the spatial dimension for all time points\n    phi_k_t = np.fft.fft(phi_t, axis=0) / N\n    Phi_k0_t = phi_k_t[k0, :]\n    \n    # Get the amplitude time series\n    log_abs_Phi = np.log(np.abs(Phi_k0_t))\n    \n    # Perform a linear fit on the latter half of the simulation\n    t_points = sol.t\n    fit_mask = t_points >= t_end / 2.0\n    \n    t_fit = t_points[fit_mask]\n    y_fit = log_abs_Phi[fit_mask]\n    \n    # Use polyfit to find the slope (gamma)\n    # The model is y = gamma*t + intercept\n    gamma, _ = np.polyfit(t_fit, y_fit, 1)\n    \n    return gamma\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}