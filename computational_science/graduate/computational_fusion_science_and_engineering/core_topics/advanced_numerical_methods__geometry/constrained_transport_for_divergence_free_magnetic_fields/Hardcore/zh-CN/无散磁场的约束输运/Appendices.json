{
    "hands_on_practices": [
        {
            "introduction": "在深入研究离散数值格式之前，掌握其背后的连续理论至关重要。无散度条件 $\\nabla \\cdot \\mathbf{B} = 0$ 是对任何物理磁场的基本约束。此练习  要求您将亥姆霍兹分解定理应用于一个给定的矢量场。通过计算其螺线（无散度）投影，您将具体理解如何“净化”一个非物理场以满足麦克斯韦方程，并探索规范自由度在定义矢量势中的作用。",
            "id": "3958543",
            "problem": "在计算聚变科学与工程的磁流体动力学建模中，约束输运范式通过在无散子空间内演化或投影场来强制执行磁场的无散条件。考虑一个在所有方向上都具有周期性边界条件的周期性立方体域 $\\Omega=[0,2\\pi]^{3}$。设一个原始磁场样本 $\\mathbf{F}:\\Omega\\to\\mathbb{R}^{3}$ 由下式给出\n$$\n\\mathbf{F}(x,y,z)=\\big(\\sin x+\\cos y,\\ \\sin y+\\cos z,\\ \\sin z+\\cos x\\big).\n$$\n仅使用以下基本事实：物理磁场必须满足 $\\nabla\\cdot\\mathbf{B}=0$，周期域上的任何足够光滑的矢量场都允许进行亥姆霍兹分解，以及无散场可以表示为矢量势的旋度 $\\mathbf{B}=\\nabla\\times\\mathbf{A}$，完成以下任务：\n\n1. 在库仑规范 $\\nabla\\cdot\\mathbf{A}=0$ 和空间平均值为零的周期性边界条件下，推导矢量势 $\\mathbf{A}$ 必须满足的控制方程，使得 $\\mathbf{B}=\\nabla\\times\\mathbf{A}$ 是 $\\mathbf{F}$ 的无散投影。\n\n2. 求解满足您推导的控制方程以及给定 $\\mathbf{F}$ 的规范和边界条件的矢量势 $\\mathbf{A}(x,y,z)$，并计算相应的无散磁场 $\\mathbf{B}(x,y,z)=\\nabla\\times\\mathbf{A}(x,y,z)$。\n\n3. 通过将您的 $\\mathbf{B}$ 与 $\\mathbf{F}-\\nabla\\phi$ 进行比较，来验证它确实是 $\\mathbf{F}$ 的无散投影，其中 $\\phi$ 解一个从亥姆霍兹分解推导出的泊松方程。除了从亥姆霍兹分解和给定条件得出的结论外，不要假设任何快捷的投影公式。\n\n4. 简要解释在此设置中矢量势的规范自由度，以及库仑规范和周期性零均值数据如何对其进行限制。\n\n最后，计算投影场的体平均平方模的精确值，\n$$\n\\langle|\\mathbf{B}|^{2}\\rangle \\equiv \\frac{1}{|\\Omega|}\\int_{\\Omega}|\\mathbf{B}(x,y,z)|^{2}\\,dV,\n$$\n其中 $|\\Omega|$ 是 $\\Omega$ 的体积。将您的最终答案表示为一个无单位的精确数值。",
            "solution": "该问题陈述被评估为有效。它在科学上基于矢量微积分和磁流体动力学的原理，问题设定良好，具有充分且一致的条件以获得唯一解，并使用客观、正式的语言陈述。该问题是计算物理中的一个标准练习，特别是关于对磁场施加无散约束。因此，我们可以进行完整解答。\n\n解答分为问题要求的四个部分，最后是最终计算。\n\n**1. 矢量势 $\\mathbf{A}$ 的控制方程的推导**\n\n此问题的基础是亥姆霍兹分解定理，该定理指出，周期域上的任何足够光滑的矢量场 $\\mathbf{F}$ 都可以唯一地分解为一个无散（散度为零）分量 $\\mathbf{B}$ 和一个无旋（旋度为零）分量 $\\nabla\\phi$。\n$$\n\\mathbf{F} = \\mathbf{B} + \\nabla\\phi\n$$\n这里，$\\mathbf{B}$ 是 $\\mathbf{F}$ 的无散投影，满足 $\\nabla\\cdot\\mathbf{B}=0$，而 $\\nabla\\phi$ 是无旋部分。\n\n物理磁场是无散的，因此我们将目标场 $\\mathbf{B}$ 等同于原始场 $\\mathbf{F}$ 的无散部分。问题陈述指出 $\\mathbf{B}$ 可以表示为矢量势 $\\mathbf{A}$ 的旋度：\n$$\n\\mathbf{B} = \\nabla \\times \\mathbf{A}\n$$\n这种表示自动满足条件 $\\nabla\\cdot\\mathbf{B}=0$，因为旋度的散度恒为零：$\\nabla\\cdot(\\nabla\\times\\mathbf{A})=0$。\n\n将此表示代入亥姆霍兹分解中，得到：\n$$\n\\mathbf{F} = \\nabla \\times \\mathbf{A} + \\nabla\\phi\n$$\n为了找到 $\\mathbf{A}$ 的方程，我们可以对整个表达式取旋度。旋度算子会消去梯度项，因为 $\\nabla \\times (\\nabla\\phi) = 0$。\n$$\n\\nabla \\times \\mathbf{F} = \\nabla \\times (\\nabla \\times \\mathbf{A}) + \\nabla \\times (\\nabla\\phi) = \\nabla \\times (\\nabla \\times \\mathbf{A})\n$$\n接下来，我们使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2\\mathbf{A}$，其中 $\\nabla^2\\mathbf{A}$ 是矢量拉普拉斯算子。\n$$\n\\nabla \\times \\mathbf{F} = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2\\mathbf{A}\n$$\n此方程将 $\\mathbf{A}$ 与给定的场 $\\mathbf{F}$ 联系起来。为了获得 $\\mathbf{A}$ 的唯一解，我们必须施加一个规范条件。问题指定了库仑规范，即 $\\nabla \\cdot \\mathbf{A} = 0$。应用此条件可显著简化方程：\n$$\n\\nabla \\times \\mathbf{F} = \\nabla(0) - \\nabla^2\\mathbf{A} = - \\nabla^2\\mathbf{A}\n$$\n整理后得到矢量势 $\\mathbf{A}$ 的控制方程，这是一个矢量泊松方程：\n$$\n\\nabla^2\\mathbf{A} = -\\nabla \\times \\mathbf{F}\n$$\n这就是 $\\mathbf{A}$ 必须满足的方程，以使其旋度 $\\mathbf{B}=\\nabla\\times\\mathbf{A}$ 成为 $\\mathbf{F}$ 的无散投影。\n\n**2. 矢量势 $\\mathbf{A}$ 和磁场 $\\mathbf{B}$ 的求解**\n\n首先，我们必须计算给定原始场 $\\mathbf{F}(x,y,z)=\\big(\\sin x+\\cos y,\\ \\sin y+\\cos z,\\ \\sin z+\\cos x\\big)$ 的旋度。\n设 $\\mathbf{F} = (F_x, F_y, F_z)$，其中 $F_x = \\sin x + \\cos y$，$F_y = \\sin y + \\cos z$，$F_z = \\sin z + \\cos x$。\n旋度 $\\nabla \\times \\mathbf{F}$ 为：\n$$\n\\nabla \\times \\mathbf{F} = \\left( \\frac{\\partial F_z}{\\partial y} - \\frac{\\partial F_y}{\\partial z}, \\frac{\\partial F_x}{\\partial z} - \\frac{\\partial F_z}{\\partial x}, \\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y} \\right)\n$$\n$$\n= \\left( 0 - (-\\sin z), 0 - (-\\sin x), 0 - (-\\sin y) \\right)\n$$\n$$\n= (\\sin z, \\sin x, \\sin y)\n$$\n现在我们求解矢量泊松方程 $\\nabla^2\\mathbf{A} = -(\\sin z, \\sin x, \\sin y)$。这可以解耦为三个标量泊松方程：\n$$\n\\nabla^2 A_x = -\\sin z\n$$\n$$\n\\nabla^2 A_y = -\\sin x\n$$\n$$\n\\nabla^2 A_z = -\\sin y\n$$\n考虑到域的周期性和源项的形式，我们可以通过观察找到一个特解。对于第一个方程，$\\nabla^2 A_x = (\\partial_x^2 + \\partial_y^2 + \\partial_z^2)A_x = -\\sin z$。我们可以尝试一个形如 $A_x = C \\sin z$ 的解。应用拉普拉斯算子得到 $\\nabla^2(C \\sin z) = -C \\sin z$。与 $-\\sin z$ 比较，我们发现 $C=1$。所以，一个解是 $A_x = \\sin z$。\n根据对称性，其他分量的解为 $A_y = \\sin x$ 和 $A_z = \\sin y$。\n因此，矢量势为：\n$$\n\\mathbf{A}(x,y,z) = (\\sin z, \\sin x, \\sin y)\n$$\n我们必须验证该解满足所述的规范和边界条件。\n- **库仑规范 ($\\nabla \\cdot \\mathbf{A} = 0$):**\n$$\n\\nabla \\cdot \\mathbf{A} = \\frac{\\partial}{\\partial x}(\\sin z) + \\frac{\\partial}{\\partial y}(\\sin x) + \\frac{\\partial}{\\partial z}(\\sin y) = 0 + 0 + 0 = 0\n$$\n规范条件得到满足。\n- **周期性边界条件:** 每个分量都是简单的正弦函数，在 $[0, 2\\pi]$ 上是周期的。该条件得到满足。\n- **空间平均值为零 ($\\langle \\mathbf{A} \\rangle = \\mathbf{0}$):** 任何分量（例如 $A_x=\\sin z$）在域 $\\Omega=[0,2\\pi]^3$ 上的空间平均值为：\n$$\n\\langle A_x \\rangle = \\frac{1}{(2\\pi)^3} \\int_{0}^{2\\pi}\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} \\sin z \\,dx\\,dy\\,dz = \\frac{(2\\pi)^2}{(2\\pi)^3} \\int_{0}^{2\\pi} \\sin z \\,dz = \\frac{1}{2\\pi} [-\\cos z]_0^{2\\pi} = 0\n$$\n同样地，$\\langle A_y \\rangle = 0$ 和 $\\langle A_z \\rangle = 0$。零均值条件得到满足。\n\n现在我们根据 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 计算磁场 $\\mathbf{B}$：\n$$\n\\mathbf{B} = \\nabla \\times (\\sin z, \\sin x, \\sin y) = \\left( \\frac{\\partial}{\\partial y}(\\sin y) - \\frac{\\partial}{\\partial z}(\\sin x), \\frac{\\partial}{\\partial z}(\\sin z) - \\frac{\\partial}{\\partial x}(\\sin y), \\frac{\\partial}{\\partial x}(\\sin x) - \\frac{\\partial}{\\partial y}(\\sin z) \\right)\n$$\n$$\n= (\\cos y - 0, \\cos z - 0, \\cos x - 0)\n$$\n$$\n\\mathbf{B}(x,y,z) = (\\cos y, \\cos z, \\cos x)\n$$\n\n**3. 通过亥姆霍兹分解进行验证**\n\n为了验证 $\\mathbf{B}=(\\cos y, \\cos z, \\cos x)$ 是 $\\mathbf{F}$ 的正确无散投影，我们可以计算无旋部分 $\\nabla\\phi$ 并证明 $\\mathbf{B} = \\mathbf{F} - \\nabla\\phi$。标量势 $\\phi$ 是通过对亥姆霍兹分解 $\\mathbf{F} = \\mathbf{B} + \\nabla\\phi$ 取散度来找到的：\n$$\n\\nabla \\cdot \\mathbf{F} = \\nabla \\cdot \\mathbf{B} + \\nabla \\cdot (\\nabla\\phi)\n$$\n因为 $\\nabla \\cdot \\mathbf{B} = 0$，这得到了一个关于 $\\phi$ 的泊松方程：\n$$\n\\nabla^2\\phi = \\nabla \\cdot \\mathbf{F}\n$$\n首先，我们计算 $\\mathbf{F}$ 的散度：\n$$\n\\nabla \\cdot \\mathbf{F} = \\frac{\\partial}{\\partial x}(\\sin x + \\cos y) + \\frac{\\partial}{\\partial y}(\\sin y + \\cos z) + \\frac{\\partial}{\\partial z}(\\sin z + \\cos x)\n$$\n$$\n= \\cos x + \\cos y + \\cos z\n$$\n所以，$\\phi$ 的泊松方程是 $\\nabla^2\\phi = \\cos x + \\cos y + \\cos z$。我们寻求一个周期性的、零均值的解。通过观察，我们尝试一个形如 $\\phi = c_x \\cos x + c_y \\cos y + c_z \\cos z$ 的解。\n$$\n\\nabla^2 \\phi = -c_x \\cos x - c_y \\cos y - c_z \\cos z\n$$\n与 $\\cos x + \\cos y + \\cos z$ 比较，我们发现 $c_x = c_y = c_z = -1$。因此：\n$$\n\\phi(x,y,z) = -\\cos x - \\cos y - \\cos z\n$$\n现在我们计算其梯度 $\\nabla\\phi$：\n$$\n\\nabla\\phi = \\left( \\frac{\\partial\\phi}{\\partial x}, \\frac{\\partial\\phi}{\\partial y}, \\frac{\\partial\\phi}{\\partial z} \\right) = (\\sin x, \\sin y, \\sin z)\n$$\n无散投影是 $\\mathbf{F} - \\nabla\\phi$：\n$$\n\\mathbf{B} = (\\sin x + \\cos y, \\sin y + \\cos z, \\sin z + \\cos x) - (\\sin x, \\sin y, \\sin z)\n$$\n$$\n= ((\\sin x - \\sin x) + \\cos y, (\\sin y - \\sin y) + \\cos z, (\\sin z - \\sin z) + \\cos x)\n$$\n$$\n= (\\cos y, \\cos z, \\cos x)\n$$\n此结果与第二部分计算出的场 $\\mathbf{B}$ 相符。验证成功。\n\n**4. 规范自由度的解释**\n\n对于任何给定的磁场 $\\mathbf{B}$，矢量势 $\\mathbf{A}$ 不是唯一的。如果 $\\mathbf{A}$ 是一个有效的势，使得 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$，那么一个新的势 $\\mathbf{A}' = \\mathbf{A} + \\nabla\\psi$（其中 $\\psi$ 是任意标量场）会产生相同的磁场：$\\nabla \\times \\mathbf{A}' = \\nabla \\times (\\mathbf{A} + \\nabla\\psi) = \\nabla \\times \\mathbf{A} + \\nabla \\times (\\nabla\\psi) = \\mathbf{B} + \\mathbf{0} = \\mathbf{B}$。这种选择 $\\psi$ 的自由度称为规范自由度。\n\n为了获得唯一的矢量势，必须施加一个额外的约束，称为规范选择。在本问题中，我们施加了库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$。如果我们有两个势 $\\mathbf{A}_1$ 和 $\\mathbf{A}_2$ 都满足库仑规范并产生相同的 $\\mathbf{B}$，那么它们的差 $\\mathbf{A}_d = \\mathbf{A}_1 - \\mathbf{A}_2$ 必须满足：\n1. $\\nabla \\times \\mathbf{A}_d = \\nabla \\times \\mathbf{A}_1 - \\nabla \\times \\mathbf{A}_2 = \\mathbf{B} - \\mathbf{B} = \\mathbf{0}$。这意味着 $\\mathbf{A}_d = \\nabla\\chi$ 对于某个标量 $\\chi$ 成立。\n2. $\\nabla \\cdot \\mathbf{A}_d = \\nabla \\cdot \\mathbf{A}_1 - \\nabla \\cdot \\mathbf{A}_2 = 0 - 0 = 0$。\n将 (1) 代入 (2) 得到 $\\nabla \\cdot (\\nabla\\chi) = \\nabla^2\\chi = 0$。在像环面 $[0, 2\\pi]^3$ 这样的紧致域上，拉普拉斯方程的唯一周期解是常数，即 $\\chi=C$。这意味着 $\\mathbf{A}_d = \\nabla C = \\mathbf{0}$，所以 $\\mathbf{A}_1 = \\mathbf{A}_2$。\n这个推理表明，在周期域上，库仑规范将矢量势固定到相差一个常数矢量。空间平均值为零的最终条件，即 $\\langle \\mathbf{A} \\rangle = \\mathbf{0}$，消除了这个常数偏移，从而确定了唯一的矢量势 $\\mathbf{A}$。\n\n**最终计算：$\\mathbf{B}$ 的体平均平方模**\n\n最后的任务是计算 $\\langle|\\mathbf{B}|^{2}\\rangle$。域是 $\\Omega=[0,2\\pi]^{3}$，其体积为 $|\\Omega|=(2\\pi)^3 = 8\\pi^3$。投影场是 $\\mathbf{B} = (\\cos y, \\cos z, \\cos x)$。其平方模为：\n$$\n|\\mathbf{B}|^2 = B_x^2 + B_y^2 + B_z^2 = (\\cos y)^2 + (\\cos z)^2 + (\\cos x)^2 = \\cos^2 x + \\cos^2 y + \\cos^2 z\n$$\n体平均值为：\n$$\n\\langle|\\mathbf{B}|^{2}\\rangle = \\frac{1}{|\\Omega|}\\int_{\\Omega} |\\mathbf{B}(x,y,z)|^{2}\\,dV = \\frac{1}{8\\pi^3} \\int_{0}^{2\\pi}\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} (\\cos^2 x + \\cos^2 y + \\cos^2 z) \\,dx\\,dy\\,dz\n$$\n我们可以将积分分成三部分：\n$$\n\\langle|\\mathbf{B}|^{2}\\rangle = \\frac{1}{8\\pi^3} \\left( \\int_{\\Omega}\\cos^2 x\\,dV + \\int_{\\Omega}\\cos^2 y\\,dV + \\int_{\\Omega}\\cos^2 z\\,dV \\right)\n$$\n让我们评估第一项。对 $y$ 和 $z$ 的积分是平凡的。\n$$\n\\int_{\\Omega}\\cos^2 x\\,dV = \\int_{0}^{2\\pi}\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} \\cos^2 x \\,dx\\,dy\\,dz = \\left(\\int_{0}^{2\\pi} \\cos^2 x \\,dx\\right) \\left(\\int_{0}^{2\\pi} dy\\right) \\left(\\int_{0}^{2\\pi} dz\\right)\n$$\n$\\cos^2 x$ 在一个周期上的积分是一个标准结果。使用恒等式 $\\cos^2 x = \\frac{1}{2}(1 + \\cos(2x))$：\n$$\n\\int_{0}^{2\\pi} \\cos^2 x \\,dx = \\int_{0}^{2\\pi} \\frac{1}{2}(1 + \\cos(2x)) \\,dx = \\left[\\frac{x}{2} + \\frac{\\sin(2x)}{4}\\right]_{0}^{2\\pi} = \\left(\\frac{2\\pi}{2} + 0\\right) - (0+0) = \\pi\n$$\n另外两个积分是 $\\int_{0}^{2\\pi} dy = 2\\pi$ 和 $\\int_{0}^{2\\pi} dz = 2\\pi$。\n所以，第一个积分项是 $\\pi \\cdot 2\\pi \\cdot 2\\pi = 4\\pi^3$。根据对称性，另外两个积分也等于 $4\\pi^3$。\n总积分为 $4\\pi^3 + 4\\pi^3 + 4\\pi^3 = 12\\pi^3$。\n最后，我们计算平均值：\n$$\n\\langle|\\mathbf{B}|^{2}\\rangle = \\frac{1}{8\\pi^3} (12\\pi^3) = \\frac{12}{8} = \\frac{3}{2}\n$$",
            "answer": "$$\\boxed{\\frac{3}{2}}$$"
        },
        {
            "introduction": "从连续理论转向计算实践，我们会遇到离散化带来的挑战。在网格上定义和测量物理量的方式决定了我们数值格式的性质。此练习  探究了约束输运方法中交错网格的一个关键精妙之处。您将推导并比较两种不同的离散散度算子，证明尽管CT方法完美守恒一种形式的离散散度，但另一种看似有效的测量值将不为零，这揭示了场插值中固有的截断误差。",
            "id": "3958563",
            "problem": "考虑一个用于磁流体力学 (MHD) 求解器的三维均匀笛卡尔网格，该求解器采用约束输运 (Constrained Transport, CT) 方法来确保磁场无散度。网格在 $\\,x\\,$, $\\,y\\,$ 和 $\\,z\\,$ 方向上的间距分别为 $\\,\\Delta x\\,$, $\\,\\Delta y\\,$ 和 $\\,\\Delta z\\,$。磁场分量以面心方式存储：$\\,B_{x,i+\\frac{1}{2},j,k}\\,$ 存储在垂直于 $\\,\\hat{\\boldsymbol{x}}\\,$ 的面心，$\\,B_{y,i,j+\\frac{1}{2},k}\\,$ 存储在垂直于 $\\,\\hat{\\boldsymbol{y}}\\,$ 的面心，而 $\\,B_{z,i,j,k+\\frac{1}{2}}\\,$ 存储在垂直于 $\\,\\hat{\\boldsymbol{z}}\\,$ 的面心，其中 $\\,i\\,$, $\\,j\\,$ 和 $\\,k\\,$ 是单元中心的索引。假设边界条件为周期性，且 $\\,\\boldsymbol{B}\\,$ 足够光滑以进行泰勒展开。\n\n从 Faraday 定律和无散度约束 $\\,\\nabla\\cdot\\boldsymbol{B} = 0\\,$ 出发，通过在控制体上应用散度定理来解释 CT 方法中离散无散度条件的强制执行：即，在单元中心 $\\,\\left(i,j,k\\right)\\,$ 定义的离散散度\n$$\nD_{f}(i,j,k) \\equiv \\frac{B_{x,i+\\frac{1}{2},j,k} - B_{x,i-\\frac{1}{2},j,k}}{\\Delta x} + \\frac{B_{y,i,j+\\frac{1}{2},k} - B_{y,i,j-\\frac{1}{2},k}}{\\Delta y} + \\frac{B_{z,i,j,k+\\frac{1}{2}} - B_{z,i,j,k-\\frac{1}{2}}}{\\Delta z}\n$$\n当初始场无散度时，在 CT 更新过程中被强制保持恒等于零。\n\n现在，通过对相邻面心值进行算术平均来定义磁场的体心表示，\n$$\nB_{x,i,j,k}^{c} \\equiv \\frac{1}{2}\\left(B_{x,i+\\frac{1}{2},j,k} + B_{x,i-\\frac{1}{2},j,k}\\right),\\quad\nB_{y,i,j,k}^{c} \\equiv \\frac{1}{2}\\left(B_{y,i,j+\\frac{1}{2},k} + B_{y,i,j-\\frac{1}{2},k}\\right),\\quad\nB_{z,i,j,k}^{c} \\equiv \\frac{1}{2}\\left(B_{z,i,j,k+\\frac{1}{2}} + B_{z,i,j,k-\\frac{1}{2}}\\right).\n$$\n对此体心场 $\\,\\boldsymbol{B}^{c}\\,$ 使用二阶中心差分，定义体心离散散度\n$$\nD_{c}(i,j,k) \\equiv \\frac{B_{x,i+1,j,k}^{c} - B_{x,i-1,j,k}^{c}}{2\\Delta x} + \\frac{B_{y,i,j+1,k}^{c} - B_{y,i,j-1,k}^{c}}{2\\Delta y} + \\frac{B_{z,i,j,k+1}^{c} - B_{z,i,j,k-1}^{c}}{2\\Delta z}.\n$$\n从第一性原理推导算术平均映射，然后将 $\\,D_{c}(i,j,k)\\,$ 完全用面心磁场分量 $\\,B_{x,i\\pm\\frac{1}{2},j,k}\\,$, $\\,B_{y,i,j\\pm\\frac{1}{2},k}\\,$ 和 $\\,B_{z,i,j,k\\pm\\frac{1}{2}}\\,$ 以及间距 $\\,\\Delta x\\,$, $\\,\\Delta y\\,$, $\\,\\Delta z\\,$ 表示。使用关于单元中心的泰勒展开，解释 $\\,\\boldsymbol{B}^{c}\\,$ 的精度阶数，以及在 CT 方法下当 $\\,D_{f}\\equiv 0\\,$ 时，采用 $\\,D_{c}\\,$（而非 $\\,D_{f}\\,$）对测量散度的影响。\n\n你的最终答案必须是 $\\,D_{c}(i,j,k)\\,$ 的单个闭式解析表达式，用面心场和 $\\,\\Delta x\\,$, $\\,\\Delta y\\,$, $\\,\\Delta z\\,$ 书写。最终答案需以无单位的符号形式表示。不要提供不等式或方程组；只提供所要求的表达式作为最终答案。",
            "solution": "所述问题是有效的。它在计算磁流体力学 (MHD) 领域具有科学依据，特别是关于使用约束输运 (CT) 方法来强制执行磁场无散度条件。为面心场、体心平均和离散散度算子提供的定义在有限体积法和有限差分法中是标准的。该问题是适定的、客观的和自洽的，为获得唯一的解析解提供了所有必要信息。\n\n该问题要求三个主要部分：对体心磁场 $\\,\\boldsymbol{B}^c\\,$ 的算术平均映射进行推导（论证），推导以面心场表示的体心散度 $\\,D_c\\,$ 的表达式，以及分析在面心散度 $\\,D_f\\,$ 保持为零时使用 $\\,D_c\\,$ 的精度和影响。\n\n首先，我们分析用于定义体心磁场分量（如 $\\,B_{x,i,j,k}^{c}\\,$）的算术平均映射。问题陈述给出了其定义：\n$$\nB_{x,i,j,k}^{c} \\equiv \\frac{1}{2}\\left(B_{x,i+\\frac{1}{2},j,k} + B_{x,i-\\frac{1}{2},j,k}\\right)\n$$\n在此背景下，“从第一性原理推导”应理解为通过确定其精度来论证这一选择的合理性。我们对位于单元中心 $\\,(x_i, y_j, z_k)\\,$ 处的面心场使用泰勒级数展开。面心场 $\\,B_{x,i\\pm\\frac{1}{2},j,k}\\,$ 表示在位置 $\\,(x_i \\pm \\frac{\\Delta x}{2}, y_j, z_k)\\,$ 处的连续场 $\\,B_x\\,$。\n将 $\\,B_x(x,y,z)\\,$ 在 $\\,x\\,$ 方向上围绕 $\\,(x_i, y_j, z_k)\\,$ 展开，得到：\n$$\nB_{x,i+\\frac{1}{2},j,k} = B_x(x_i,y_j,z_k) + \\left(\\frac{\\Delta x}{2}\\right)\\frac{\\partial B_x}{\\partial x} + \\frac{1}{2!}\\left(\\frac{\\Delta x}{2}\\right)^2\\frac{\\partial^2 B_x}{\\partial x^2} + \\frac{1}{3!}\\left(\\frac{\\Delta x}{2}\\right)^3\\frac{\\partial^3 B_x}{\\partial x^3} + \\mathcal{O}((\\Delta x)^4)\n$$\n$$\nB_{x,i-\\frac{1}{2},j,k} = B_x(x_i,y_j,z_k) - \\left(\\frac{\\Delta x}{2}\\right)\\frac{\\partial B_x}{\\partial x} + \\frac{1}{2!}\\left(\\frac{\\Delta x}{2}\\right)^2\\frac{\\partial^2 B_x}{\\partial x^2} - \\frac{1}{3!}\\left(\\frac{\\Delta x}{2}\\right)^3\\frac{\\partial^3 B_x}{\\partial x^3} + \\mathcal{O}((\\Delta x)^4)\n$$\n其中所有导数均在单元中心 $\\,(i,j,k)\\,$ 处求值。将这些展开式代入 $\\,B_{x,i,j,k}^{c}\\,$ 的定义中：\n$$\nB_{x,i,j,k}^{c} = \\frac{1}{2} \\left[ \\left(B_x + \\frac{\\Delta x}{2}\\frac{\\partial B_x}{\\partial x} + \\frac{(\\Delta x)^2}{8}\\frac{\\partial^2 B_x}{\\partial x^2}\\right) + \\left(B_x - \\frac{\\Delta x}{2}\\frac{\\partial B_x}{\\partial x} + \\frac{(\\Delta x)^2}{8}\\frac{\\partial^2 B_x}{\\partial x^2}\\right) + \\mathcal{O}((\\Delta x)^4) \\right]\n$$\n$$\nB_{x,i,j,k}^{c} = \\frac{1}{2} \\left[ 2B_x + 2\\frac{(\\Delta x)^2}{8}\\frac{\\partial^2 B_x}{\\partial x^2} + \\mathcal{O}((\\Delta x)^4) \\right] = B_x(x_i,y_j,z_k) + \\frac{(\\Delta x)^2}{8}\\frac{\\partial^2 B_x}{\\partial x^2} + \\mathcal{O}((\\Delta x)^4)\n$$\n这表明，算术平均 $\\,B_{x,i,j,k}^{c}\\,$ 是单元中心处真实磁场值 $\\,B_x(x_i,y_j,z_k)\\,$ 的一个二阶精确近似。其主阶误差与 $\\,(\\Delta x)^2\\,$ 以及该场分量的二阶偏导数成正比。\n\n接下来，我们推导用面心磁场分量表示的体心离散散度 $\\,D_{c}(i,j,k)\\,$ 的表达式。其定义如下：\n$$\nD_{c}(i,j,k) \\equiv \\frac{B_{x,i+1,j,k}^{c} - B_{x,i-1,j,k}^{c}}{2\\Delta x} + \\frac{B_{y,i,j+1,k}^{c} - B_{y,i,j-1,k}^{c}}{2\\Delta y} + \\frac{B_{z,i,j,k+1}^{c} - B_{z,i,j,k-1}^{c}}{2\\Delta z}\n$$\n我们必须代入相邻单元处体心场的表达式。对于 $\\,x\\,$ 分量项，我们需要 $\\,B_{x,i+1,j,k}^{c}\\,$ 和 $\\,B_{x,i-1,j,k}^{c}\\,$。使用平均定义：\n$$\nB_{x,i+1,j,k}^{c} = \\frac{1}{2}\\left(B_{x,i+1+\\frac{1}{2},j,k} + B_{x,i+1-\\frac{1}{2},j,k}\\right) = \\frac{1}{2}\\left(B_{x,i+\\frac{3}{2},j,k} + B_{x,i+\\frac{1}{2},j,k}\\right)\n$$\n$$\nB_{x,i-1,j,k}^{c} = \\frac{1}{2}\\left(B_{x,i-1+\\frac{1}{2},j,k} + B_{x,i-1-\\frac{1}{2},j,k}\\right) = \\frac{1}{2}\\left(B_{x,i-\\frac{1}{2},j,k} + B_{x,i-\\frac{3}{2},j,k}\\right)\n$$\n将这些代入 $\\,D_c\\,$ 的 $\\,x\\,$ 导数项中：\n$$\n\\frac{B_{x,i+1,j,k}^{c} - B_{x,i-1,j,k}^{c}}{2\\Delta x} = \\frac{1}{2\\Delta x} \\left[ \\frac{1}{2}\\left(B_{x,i+\\frac{3}{2},j,k} + B_{x,i+\\frac{1}{2},j,k}\\right) - \\frac{1}{2}\\left(B_{x,i-\\frac{1}{2},j,k} + B_{x,i-\\frac{3}{2},j,k}\\right) \\right]\n$$\n$$\n= \\frac{1}{4\\Delta x} \\left( B_{x,i+\\frac{3}{2},j,k} + B_{x,i+\\frac{1}{2},j,k} - B_{x,i-\\frac{1}{2},j,k} - B_{x,i-\\frac{3}{2},j,k} \\right)\n$$\n根据对称性，$\\,y\\,$ 和 $\\,z\\,$ 分量的表达式是类似的：\n$$\n\\frac{B_{y,i,j+1,k}^{c} - B_{y,i,j-1,k}^{c}}{2\\Delta y} = \\frac{1}{4\\Delta y} \\left( B_{y,i,j+\\frac{3}{2},k} + B_{y,i,j+\\frac{1}{2},k} - B_{y,i,j-\\frac{1}{2},k} - B_{y,i,j-\\frac{3}{2},k} \\right)\n$$\n$$\n\\frac{B_{z,i,j,k+1}^{c} - B_{z,i,j,k-1}^{c}}{2\\Delta z} = \\frac{1}{4\\Delta z} \\left( B_{z,i,j,k+\\frac{3}{2}} + B_{z,i,j,k+\\frac{1}{2}} - B_{z,i,j,k-\\frac{1}{2}} - B_{z,i,j,k-\\frac{3}{2}} \\right)\n$$\n将这些项组合起来，就得到了用面心场表示的 $\\,D_{c}(i,j,k)\\,$ 的完整表达式。该表达式在最终答案中给出。\n\n最后，我们分析当 CT 条件 $\\,D_f \\equiv 0\\,$ 被严格执行时，使用 $\\,D_c\\,$ 测量散度的效果。CT 条件 $\\,D_f=0\\,$ 是无散度条件的积分形式 $\\,\\oint_V (\\nabla \\cdot \\boldsymbol{B}) dV = \\oint_{\\partial V} \\boldsymbol{B} \\cdot d\\boldsymbol{A} = 0\\,$ 应用于每个网格单元的离散表示。它的构造使得算法能够将其维持在机器精度。\n相比之下，$\\,D_c\\,$ 是一个不同的离散算子。如前所示，它是 $\\,\\nabla \\cdot \\boldsymbol{B}^c\\,$ 的一个二阶有限差分近似。我们来分析连续量 $\\,\\nabla \\cdot \\boldsymbol{B}^c\\,$。使用 $\\,\\boldsymbol{B}^c\\,$ 的泰勒展开：\n$$\n\\nabla \\cdot \\boldsymbol{B}^c = \\frac{\\partial B_x^c}{\\partial x} + \\frac{\\partial B_y^c}{\\partial y} + \\frac{\\partial B_z^c}{\\partial z}\n$$\n$$\n= \\frac{\\partial}{\\partial x}\\left(B_x + \\frac{(\\Delta x)^2}{8}\\frac{\\partial^2 B_x}{\\partial x^2}\\right) + \\frac{\\partial}{\\partial y}\\left(B_y + \\frac{(\\Delta y)^2}{8}\\frac{\\partial^2 B_y}{\\partial y^2}\\right) + \\frac{\\partial}{\\partial z}\\left(B_z + \\frac{(\\Delta z)^2}{8}\\frac{\\partial^2 B_z}{\\partial z^2}\\right) + \\mathcal{O}(\\Delta^4)\n$$\n$$\n= \\left(\\frac{\\partial B_x}{\\partial x} + \\frac{\\partial B_y}{\\partial y} + \\frac{\\partial B_z}{\\partial z}\\right) + \\frac{(\\Delta x)^2}{8}\\frac{\\partial^3 B_x}{\\partial x^3} + \\frac{(\\Delta y)^2}{8}\\frac{\\partial^3 B_y}{\\partial y^3} + \\frac{(\\Delta z)^2}{8}\\frac{\\partial^3 B_z}{\\partial z^3} + \\mathcal{O}(\\Delta^4)\n$$\n根据基础物理学，连续散度为零：$\\,\\nabla \\cdot \\boldsymbol{B} = 0\\,$。因此：\n$$\n\\nabla \\cdot \\boldsymbol{B}^c = \\frac{(\\Delta x)^2}{8}\\frac{\\partial^3 B_x}{\\partial x^3} + \\frac{(\\Delta y)^2}{8}\\frac{\\partial^3 B_y}{\\partial y^3} + \\frac{(\\Delta z)^2}{8}\\frac{\\partial^3 B_z}{\\partial z^3} + \\mathcal{O}(\\Delta^4)\n$$\n体心场 $\\,\\boldsymbol{B}^c\\,$ 的散度不为零，而是一个 $\\,\\mathcal{O}(\\Delta^2)\\,$ 阶的量，它取决于磁场的三阶导数。由于 $\\,D_c(i,j,k)\\,$ 是 $\\,\\nabla \\cdot \\boldsymbol{B}^c\\,$ 的二阶近似，它也将是一个 $\\,\\mathcal{O}(\\Delta^2)\\,$ 阶的非零量：\n$$\nD_c(i,j,k) = \\nabla \\cdot \\boldsymbol{B}^c|_{(i,j,k)} + \\mathcal{O}(\\Delta^2) = \\mathcal{O}(\\Delta^2)\n$$\n这揭示了一个关键点：即使 CT 方法完美地保持了离散无散度条件 $\\,D_f=0\\,$，像 $\\,D_c\\,$ 这样的不同离散散度算子通常会产生一个非零值。这个非零散度并非 CT 方案的失败，而是从面心场构造体心场 $\\,\\boldsymbol{B}^c\\,$ 时所使用的算术平均中固有的截断误差的表现。因此，使用 $\\,D_c\\,$ 作为一种诊断工具，实际上是在测量这个截断误差，而随着网格的细化，该误差会收敛到零。",
            "answer": "$$\n\\boxed{\n\\frac{1}{4\\Delta x} \\left( B_{x,i+\\frac{3}{2},j,k} + B_{x,i+\\frac{1}{2},j,k} - B_{x,i-\\frac{1}{2},j,k} - B_{x,i-\\frac{3}{2},j,k} \\right) + \\frac{1}{4\\Delta y} \\left( B_{y,i,j+\\frac{3}{2},k} + B_{y,i,j+\\frac{1}{2},k} - B_{y,i,j-\\frac{1}{2},k} - B_{y,i,j-\\frac{3}{2},k} \\right) + \\frac{1}{4\\Delta z} \\left( B_{z,i,j,k+\\frac{3}{2}} + B_{z,i,j,k+\\frac{1}{2}} - B_{z,i,j,k-\\frac{1}{2}} - B_{z,i,j,k-\\frac{3}{2}} \\right)\n}\n$$"
        },
        {
            "introduction": "约束输运方法的威力在于其数学上保证零散度守恒的结构。但是，如果输入到算法中的数据不一致，会发生什么呢？此问题  通过研究一个失效模式，有力地展示了CT方法的核心原理。通过在电动势中引入一个局部不一致性，您将见证一个数值“磁单极子”的产生，并证明一旦这个误差被创造出来，它将被后续一致的CT更新“冻结”，这突显了该方法强大的保散特性。",
            "id": "3958555",
            "problem": "考虑一个用于磁流体力学 (MHD) 约束输运 (CT) 模拟的二维均匀笛卡尔网格。磁场分量以交错方式存储：$B_{x}$ 分量位于 $(i+\\frac{1}{2}, j)$ 处的面心，$B_{y}$ 分量位于 $(i, j+\\frac{1}{2})$ 处的面心，网格间距分别为 $\\Delta x$ 和 $\\Delta y$。电场（电动势, EMF）分量 $E_{z}$ 位于 $(i+\\frac{1}{2}, j+\\frac{1}{2})$ 处的边心，$B_{x}$ 和 $B_{y}$ 的更新遵循 Maxwell–Faraday 定律 $\\partial \\mathbf{B}/\\partial t = -\\nabla \\times \\mathbf{E}$ 的有限体积离散化。\n\n假设在时间 $t^{n}$，磁场的离散散度，\n$$\n(\\nabla \\cdot \\mathbf{B})_{i,j} \\equiv \\frac{B_{x}\\left(i+\\frac{1}{2}, j\\right) - B_{x}\\left(i-\\frac{1}{2}, j\\right)}{\\Delta x} + \\frac{B_{y}\\left(i, j+\\frac{1}{2}\\right) - B_{y}\\left(i, j-\\frac{1}{2}\\right)}{\\Delta y},\n$$\n在每个单元 $(i,j)$ 处都为零。\n\n现在，您在一个时间步长 $\\Delta t$ 内执行一次 CT 更新，其中 EMF 仅在 $(i_{0}+\\frac{1}{2}, j_{0}+\\frac{1}{2})$ 处的一条边上非零。然而，用于更新 $B_{x}$ 和 $B_{y}$ 的 EMF 在该边上是不一致的：用于 $B_{x}$ 更新的值是 $\\tilde{E}_{z}$，而用于 $B_{y}$ 更新的值是 $\\hat{E}_{z}$。所有其他边上的 EMF 均为零。随后，您使用一致的 EMF 执行 $K \\geq 1$ 次进一步的 CT 更新（即，无论该边对任何磁场面更新有贡献，都使用单一、相同的边值），但不应用任何散度清理或非 CT 校正。\n\n从 Maxwell–Faraday 定律和上述交错网格 CT 框架出发，推导由单边不一致性引起的单元 $(i_{0}, j_{0})$ 处 $(\\nabla \\cdot \\mathbf{B})$ 的离散变化，并展示其在随后的 $K$ 次一致 CT 更新下的演化过程。将您的最终答案表示为整个更新序列后 $(\\nabla \\cdot \\mathbf{B})_{i_{0}, j_{0}}$ 的单一闭合形式解析表达式，单位为国际单位制中的特斯拉/米。不需要数值。",
            "solution": "该问题要求我们确定在约束输运 (CT) 方案中，经过一系列特定的更新后，磁场离散散度 $(\\nabla \\cdot \\mathbf{B})_{i_{0}, j_{0}}$ 的值。该序列包含一个在单条边上使用不一致电动势 (EMF) 的更新步骤，随后是 $K$ 个使用一致 EMF 的更新步骤。初始条件是离散散度处处为零。\n\n首先，我们基于 Maxwell–Faraday 定律 $\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}$，建立磁场分量 $B_x$ 和 $B_y$ 的离散更新方程。在一个只有平面外电场分量 $E_z$ 的二维笛卡尔坐标系中，该定律简化为：\n$$\n\\frac{\\partial B_x}{\\partial t} = -\\frac{\\partial E_z}{\\partial y}\n$$\n$$\n\\frac{\\partial B_y}{\\partial t} = \\frac{\\partial E_z}{\\partial x}\n$$\n我们使用前向欧拉法处理时间导数，中心差分处理空间导数，在指定的交错网格上对这些方程进行离散化。$B_x$ 在面 $(i+\\frac{1}{2}, j)$ 上，从时间 $t^n$ 到 $t^{n+1}$ 经过一个时间步长 $\\Delta t$ 的更新为：\n$$\n\\frac{B_x^{n+1}(i+\\frac{1}{2}, j) - B_x^n(i+\\frac{1}{2}, j)}{\\Delta t} = - \\frac{E_z(i+\\frac{1}{2}, j+\\frac{1}{2}) - E_z(i+\\frac{1}{2}, j-\\frac{1}{2})}{\\Delta y}\n$$\n类似地，$B_y$ 在面 $(i, j+\\frac{1}{2})$ 上的更新为：\n$$\n\\frac{B_y^{n+1}(i, j+\\frac{1}{2}) - B_y^n(i, j+\\frac{1}{2})}{\\Delta t} = \\frac{E_z(i+\\frac{1}{2}, j+\\frac{1}{2}) - E_z(i-\\frac{1}{2}, j+\\frac{1}{2})}{\\Delta x}\n$$\n这些方程可以重排以表示时间 $t^{n+1}$ 时的场：\n$$\nB_x^{n+1}\\left(i+\\frac{1}{2}, j\\right) = B_x^n\\left(i+\\frac{1}{2}, j\\right) - \\frac{\\Delta t}{\\Delta y} \\left[ E_z\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right]\n$$\n$$\nB_y^{n+1}\\left(i, j+\\frac{1}{2}\\right) = B_y^n\\left(i, j+\\frac{1}{2}\\right) + \\frac{\\Delta t}{\\Delta x} \\left[ E_z\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) \\right]\n$$\n问题将单元 $(i,j)$ 中心的离散散度定义为：\n$$\n(\\nabla \\cdot \\mathbf{B})_{i,j} \\equiv \\frac{B_{x}\\left(i+\\frac{1}{2}, j\\right) - B_{x}\\left(i-\\frac{1}{2}, j\\right)}{\\Delta x} + \\frac{B_{y}\\left(i, j+\\frac{1}{2}\\right) - B_{y}\\left(i, j-\\frac{1}{2}\\right)}{\\Delta y}\n$$\n让我们分析这个散度在单个时间步长内（从 $t^n$ 到 $t^{n+1}$）的变化。\n$$\n(\\nabla \\cdot \\mathbf{B})_{i,j}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{i,j}^{n} = \\frac{B_x^{n+1} - B_x^n}{\\Delta x}\\bigg|_{i+\\frac{1}{2}, j} - \\frac{B_x^{n+1} - B_x^n}{\\Delta x}\\bigg|_{i-\\frac{1}{2}, j} + \\frac{B_y^{n+1} - B_y^n}{\\Delta y}\\bigg|_{i, j+\\frac{1}{2}} - \\frac{B_y^{n+1} - B_y^n}{\\Delta y}\\bigg|_{i, j-\\frac{1}{2}}\n$$\n将更新方程中 $B_x$ 和 $B_y$ 的变化表达式代入：\n$$\n\\frac{(\\nabla \\cdot \\mathbf{B})_{i,j}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{i,j}^{n}}{\\Delta t} = \\frac{1}{\\Delta x} \\left( -\\frac{1}{\\Delta y} \\left[ E_z\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right] \\right) \\\\- \\frac{1}{\\Delta x} \\left( -\\frac{1}{\\Delta y} \\left[ E_z\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z\\left(i-\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right] \\right) \\\\+ \\frac{1}{\\Delta y} \\left( \\frac{1}{\\Delta x} \\left[ E_z\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) \\right] \\right) \\\\- \\frac{1}{\\Delta y} \\left( \\frac{1}{\\Delta x} \\left[ E_z\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) - E_z\\left(i-\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right] \\right)\n$$\n乘以 $\\Delta x \\Delta y$ 并对每个边心 $E_z$ 合并同类项：\n$$\n\\frac{\\Delta x \\Delta y}{\\Delta t} \\left( (\\nabla \\cdot \\mathbf{B})_{i,j}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{i,j}^{n} \\right) = \\\\\nE_z\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) [-1+1] + E_z\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) [1-1] \\\\\n+ E_z\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) [1-1] + E_z\\left(i-\\frac{1}{2}, j-\\frac{1}{2}\\right) [-1+1] = 0\n$$\n这证明了一致 CT 方案的核心性质：如果给定边上的同一个 $E_z$ 值用于所有相邻面的更新，则离散散度被精确地保持，即 $(\\nabla \\cdot \\mathbf{B})_{i,j}^{n+1} = (\\nabla \\cdot \\mathbf{B})_{i,j}^{n}$。\n\n现在，我们考虑问题中描述的第一个更新步骤 ($t^n \\to t^{n+1}$)。更新是不一致的：在边 $(i_0+\\frac{1}{2}, j_0+\\frac{1}{2})$ 处的 EMF 值，当用于 $B_x$ 更新时为 $\\tilde{E}_z$，当用于 $B_y$ 更新时为 $\\hat{E}_z$。所有其他 EMF 均为零。我们必须在这些特定条件下重新评估单元 $(i_0, j_0)$ 处散度的变化。\n令 $E_z^{B_x}$ 为用于 $B_x$ 更新的 EMF 场，$E_z^{B_y}$ 为用于 $B_y$ 更新的 EMF 场。散度的变化变为：\n$$\n\\frac{\\Delta x \\Delta y}{\\Delta t} \\left( (\\nabla \\cdot \\mathbf{B})_{i,j}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{i,j}^{n} \\right) = \\\\\n- \\left[ E_z^{B_x}\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z^{B_x}\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right] \\\\\n+ \\left[ E_z^{B_x}\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z^{B_x}\\left(i-\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right] \\\\\n+ \\left[ E_z^{B_y}\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z^{B_y}\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) \\right] \\\\\n- \\left[ E_z^{B_y}\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) - E_z^{B_y}\\left(i-\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right]\n$$\n在单元 $(i_0, j_0)$ 处，我们代入 $i=i_0$ 和 $j=j_0$。给定条件是：\n$E_z^{B_x}(i_0+\\frac{1}{2}, j_0+\\frac{1}{2}) = \\tilde{E}_z$\n$E_z^{B_y}(i_0+\\frac{1}{2}, j_0+\\frac{1}{2}) = \\hat{E}_z$\n在任何其他位置的所有其他 EMF 值均为零。\n将这些条件应用于 $(i_0, j_0)$ 处散度变化的方程：\n$$\n\\frac{\\Delta x \\Delta y}{\\Delta t} \\left( (\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n} \\right) = \\\\\n- \\left[ \\tilde{E}_z - 0 \\right] + \\left[ 0 - 0 \\right] + \\left[ \\hat{E}_z - 0 \\right] - \\left[ 0 - 0 \\right] \\\\\n= \\hat{E}_z - \\tilde{E}_z\n$$\n问题指出，初始时 $(\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n} = 0$。因此，在第一次不一致的更新之后，单元 $(i_0, j_0)$ 处的散度是：\n$$\n(\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n+1} = \\frac{\\Delta t}{\\Delta x \\Delta y} ( \\hat{E}_z - \\tilde{E}_z )\n$$\n这代表了由于 EMF 的不一致应用，在单元 $(i_0, j_0)$ 中产生了一个数值“磁单极子”源。\n\n接下来，我们分析随后的 $K$ 次更新，从 $t^{n+1}$ 到 $t^{n+1+K}$。问题指出这些更新是使用一致的 EMF 执行的。正如我们前面证明的，一致的 CT 更新精确地保持了每个单元的离散散度。\n因此，对于任何满足 $n+1 \\leq k  n+1+K$ 的步骤 $k$：\n$$\n(\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{k+1} = (\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{k}\n$$\n这意味着在第一次不一致步骤中产生的非零散度，在随后的 $K$ 次一致步骤中保持不变。该误差被“冻结”在数值解中，并且不会被 CT 算法本身耗散掉。\n$$\n(\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n+1+K} = (\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n+K} = \\dots = (\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n+1}\n$$\n因此，在完整的 $1+K$ 次更新序列之后，单元 $(i_0, j_0)$ 处的离散散度值等于第一次更新后的值。\n\n散度演化的最终表达式是，它由不一致的步骤产生，然后保持恒定。所有更新结束时的值为：\n$$\n(\\nabla \\cdot \\mathbf{B})_{i_0,j_0} = \\frac{\\Delta t}{\\Delta x \\Delta y} ( \\hat{E}_z - \\tilde{E}_z )\n$$\n这个表达式的单位是 $(\\text{s} \\cdot (\\text{V}/\\text{m})) / (\\text{m}^2) = (\\text{V} \\cdot \\text{s}) / \\text{m}^3$。由于特斯拉定义为 $1 \\text{ T} = 1 (\\text{V} \\cdot \\text{s}) / \\text{m}^2$，所以单位是 $\\text{T}/\\text{m}$，这是磁场散度的正确单位。",
            "answer": "$$\n\\boxed{\\frac{\\Delta t}{\\Delta x \\Delta y} (\\hat{E}_{z} - \\tilde{E}_{z})}\n$$"
        }
    ]
}