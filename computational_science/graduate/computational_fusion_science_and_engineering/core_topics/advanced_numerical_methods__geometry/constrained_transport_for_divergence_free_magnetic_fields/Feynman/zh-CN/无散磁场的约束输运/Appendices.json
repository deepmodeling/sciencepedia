{
    "hands_on_practices": [
        {
            "introduction": "在我们将物理定律离散化到网格上之前，我们必须首先掌握无散场的连续性质。这个练习将引导你通过亥姆霍兹分解和矢量势，从一个任意的矢量场中提取其螺线（无散）分量，这是强加磁场无散约束 $\\nabla \\cdot \\mathbf{B} = 0$ 的理论基础 。通过这个推导，你将加深对库仑规范选择和矢量泊松方程在确定唯一无散场中作用的理解。",
            "id": "3958543",
            "problem": "在计算聚变科学与工程的磁流体动力学建模中，约束输运范式通过在螺线管（无散）子空间内演化或投影场来强制执行磁场的无散条件。考虑一个在所有方向上都具有周期性边界条件的周期性立方体域 $\\Omega=[0,2\\pi]^{3}$。设一个原始磁场样本 $\\mathbf{F}:\\Omega\\to\\mathbb{R}^{3}$ 由下式给出\n$$\n\\mathbf{F}(x,y,z)=\\big(\\sin x+\\cos y,\\ \\sin y+\\cos z,\\ \\sin z+\\cos x\\big).\n$$\n仅使用以下基本事实：物理磁场必须满足 $\\nabla\\cdot\\mathbf{B}=0$；周期域上任何足够光滑的矢量场都允许进行 Helmholtz 分解；无散场可以表示为矢量势的旋度 $\\mathbf{B}=\\nabla\\times\\mathbf{A}$。请完成以下任务：\n\n1. 在 Coulomb 规范 $\\nabla\\cdot\\mathbf{A}=0$ 和空间平均值为零的周期性边界条件下，推导矢量势 $\\mathbf{A}$ 必须满足的控制方程，以使 $\\mathbf{B}=\\nabla\\times\\mathbf{A}$ 是 $\\mathbf{F}$ 的无散投影。\n\n2. 求解满足您的控制方程以及给定 $\\mathbf{F}$ 的规范和边界条件的矢量势 $\\mathbf{A}(x,y,z)$，并计算相应的无散磁场 $\\mathbf{B}(x,y,z)=\\nabla\\times\\mathbf{A}(x,y,z)$。\n\n3. 通过将您的 $\\mathbf{B}$ 与 $\\mathbf{F}-\\nabla\\phi$ 进行比较，验证它确实是 $\\mathbf{F}$ 的无散投影，其中 $\\phi$ 解一个从 Helmholtz 分解推导出的 Poisson 方程。除了从分解和给定条件得出的结论外，不要假设任何快捷投影公式。\n\n4. 简要解释在此设置下矢量势的规范自由度，以及具有周期性零均值数据的 Coulomb 规范如何限制它。\n\n最后，计算投影场的体平均平方模的精确值，\n$$\n\\langle|\\mathbf{B}|^{2}\\rangle \\equiv \\frac{1}{|\\Omega|}\\int_{\\Omega}|\\mathbf{B}(x,y,z)|^{2}\\,dV,\n$$\n其中 $|\\Omega|$ 是 $\\Omega$ 的体积。请以一个无单位的精确数作为您的最终答案。",
            "solution": "问题陈述经评估有效。它在科学上基于矢量微积分和磁流体动力学的原理，具有充分且一致的条件以获得唯一解，因此是适定的，并使用客观、正式的语言进行陈述。该问题是计算物理学中的一个标准练习，特别是关于对磁场施加无散约束。因此，我们可以进行完整解答。\n\n解答按照问题要求的四个部分进行组织，最后是最终计算。\n\n**1. 矢量势 $\\mathbf{A}$ 的控制方程推导**\n\n这个问题的基础是 Helmholtz 分解定理，该定理指出，周期域上任何足够光滑的矢量场 $\\mathbf{F}$ 都可以唯一地分解为一个螺线管（无散）分量 $\\mathbf{B}$ 和一个无旋分量 $\\nabla\\phi$。\n$$\n\\mathbf{F} = \\mathbf{B} + \\nabla\\phi\n$$\n这里，$\\mathbf{B}$ 是 $\\mathbf{F}$ 的无散投影，满足 $\\nabla\\cdot\\mathbf{B}=0$，而 $\\nabla\\phi$ 是无旋部分。\n\n物理磁场是无散的，所以我们将目标场 $\\mathbf{B}$ 等同于原始场 $\\mathbf{F}$ 的无散部分。问题指出，$\\mathbf{B}$ 可以表示为矢量势 $\\mathbf{A}$ 的旋度：\n$$\n\\mathbf{B} = \\nabla \\times \\mathbf{A}\n$$\n这种表示自动满足条件 $\\nabla\\cdot\\mathbf{B}=0$，因为旋度的散度恒为零：$\\nabla\\cdot(\\nabla\\times\\mathbf{A}) \\equiv 0$。\n\n将此表示代入 Helmholtz 分解得到：\n$$\n\\mathbf{F} = \\nabla \\times \\mathbf{A} + \\nabla\\phi\n$$\n为了找到 $\\mathbf{A}$ 的方程，我们可以对整个表达式取旋度。旋度算子会消去梯度项，因为 $\\nabla \\times (\\nabla\\phi) \\equiv 0$。\n$$\n\\nabla \\times \\mathbf{F} = \\nabla \\times (\\nabla \\times \\mathbf{A}) + \\nabla \\times (\\nabla\\phi) = \\nabla \\times (\\nabla \\times \\mathbf{A})\n$$\n接下来，我们使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2\\mathbf{A}$，其中 $\\nabla^2\\mathbf{A}$ 是矢量拉普拉斯算子。\n$$\n\\nabla \\times \\mathbf{F} = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2\\mathbf{A}\n$$\n这个方程将 $\\mathbf{A}$ 与给定的场 $\\mathbf{F}$ 联系起来。为了获得 $\\mathbf{A}$ 的唯一解，我们必须施加一个规范条件。问题指定了 Coulomb 规范，$\\nabla \\cdot \\mathbf{A} = 0$。应用此条件可显著简化方程：\n$$\n\\nabla \\times \\mathbf{F} = \\nabla(0) - \\nabla^2\\mathbf{A} = - \\nabla^2\\mathbf{A}\n$$\n整理后得到矢量势 $\\mathbf{A}$ 的控制方程，这是一个矢量 Poisson 方程：\n$$\n\\nabla^2\\mathbf{A} = -\\nabla \\times \\mathbf{F}\n$$\n这就是 $\\mathbf{A}$ 必须满足的方程，以使其旋度 $\\mathbf{B}=\\nabla\\times\\mathbf{A}$ 是 $\\mathbf{F}$ 的无散投影。\n\n**2. 矢量势 $\\mathbf{A}$ 和磁场 $\\mathbf{B}$ 的求解**\n\n首先，我们必须计算给定原始场 $\\mathbf{F}(x,y,z)=\\big(\\sin x+\\cos y,\\ \\sin y+\\cos z,\\ \\sin z+\\cos x\\big)$ 的旋度。\n设 $\\mathbf{F} = (F_x, F_y, F_z)$，其中 $F_x = \\sin x + \\cos y$，$F_y = \\sin y + \\cos z$，$F_z = \\sin z + \\cos x$。\n旋度 $\\nabla \\times \\mathbf{F}$ 是：\n$$\n\\nabla \\times \\mathbf{F} = \\left( \\frac{\\partial F_z}{\\partial y} - \\frac{\\partial F_y}{\\partial z}, \\frac{\\partial F_x}{\\partial z} - \\frac{\\partial F_z}{\\partial x}, \\frac{\\partial F_y}{\\partial x} - \\frac{\\partial F_x}{\\partial y} \\right)\n$$\n$$\n= \\left( 0 - (-\\sin z), 0 - (-\\sin x), 0 - (-\\sin y) \\right)\n$$\n$$\n= (\\sin z, \\sin x, \\sin y)\n$$\n现在我们求解矢量 Poisson 方程 $\\nabla^2\\mathbf{A} = -(\\sin z, \\sin x, \\sin y)$。这可以解耦为三个标量 Poisson 方程：\n$$\n\\nabla^2 A_x = -\\sin z\n$$\n$$\n\\nabla^2 A_y = -\\sin x\n$$\n$$\n\\nabla^2 A_z = -\\sin y\n$$\n鉴于域的周期性和源项的形式，我们可以通过观察找到一个特解。对于第一个方程 $\\nabla^2 A_x = (\\partial_x^2 + \\partial_y^2 + \\partial_z^2)A_x = -\\sin z$，我们可以测试一个形式为 $A_x = C \\sin z$ 的解。应用拉普拉斯算子得到 $\\nabla^2(C \\sin z) = -C \\sin z$。与 $-\\sin z$ 比较，我们发现 $C=1$。所以，一个解是 $A_x = \\sin z$。\n根据对称性，其他分量的解是 $A_y = \\sin x$ 和 $A_z = \\sin y$。\n因此，矢量势为：\n$$\n\\mathbf{A}(x,y,z) = (\\sin z, \\sin x, \\sin y)\n$$\n我们必须验证该解满足所述的规范和边界条件。\n- **Coulomb 规范 ($\\nabla \\cdot \\mathbf{A} = 0$):**\n$$\n\\nabla \\cdot \\mathbf{A} = \\frac{\\partial}{\\partial x}(\\sin z) + \\frac{\\partial}{\\partial y}(\\sin x) + \\frac{\\partial}{\\partial z}(\\sin y) = 0 + 0 + 0 = 0\n$$\n规范条件得到满足。\n- **周期性边界条件：** 每个分量都是一个简单的正弦函数，在 $[0, 2\\pi]$ 上是周期的。该条件得到满足。\n- **空间平均值为零 ($\\langle \\mathbf{A} \\rangle = \\mathbf{0}$):** 任何分量（例如 $A_x=\\sin z$）在域 $\\Omega=[0,2\\pi]^3$ 上的空间平均值为：\n$$\n\\langle A_x \\rangle = \\frac{1}{(2\\pi)^3} \\int_{0}^{2\\pi}\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} \\sin z \\,dx\\,dy\\,dz = \\frac{(2\\pi)^2}{(2\\pi)^3} \\int_{0}^{2\\pi} \\sin z \\,dz = \\frac{1}{2\\pi} [-\\cos z]_0^{2\\pi} = 0\n$$\n类似地，$\\langle A_y \\rangle = 0$ 和 $\\langle A_z \\rangle = 0$。零均值条件得到满足。\n\n现在我们从 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 计算磁场 $\\mathbf{B}$：\n$$\n\\mathbf{B} = \\nabla \\times (\\sin z, \\sin x, \\sin y) = \\left( \\frac{\\partial}{\\partial y}(\\sin y) - \\frac{\\partial}{\\partial z}(\\sin x), \\frac{\\partial}{\\partial z}(\\sin z) - \\frac{\\partial}{\\partial x}(\\sin y), \\frac{\\partial}{\\partial x}(\\sin x) - \\frac{\\partial}{\\partial y}(\\sin z) \\right)\n$$\n$$\n= (\\cos y - 0, \\cos z - 0, \\cos x - 0)\n$$\n$$\n\\mathbf{B}(x,y,z) = (\\cos y, \\cos z, \\cos x)\n$$\n\n**3. 通过 Helmholtz 分解进行验证**\n\n为了验证 $\\mathbf{B}=(\\cos y, \\cos z, \\cos x)$ 是 $\\mathbf{F}$ 的正确无散投影，我们可以计算无旋部分 $\\nabla\\phi$ 并证明 $\\mathbf{B} = \\mathbf{F} - \\nabla\\phi$。标量势 $\\phi$ 可以通过对 Helmholtz 分解 $\\mathbf{F} = \\mathbf{B} + \\nabla\\phi$ 取散度来找到：\n$$\n\\nabla \\cdot \\mathbf{F} = \\nabla \\cdot \\mathbf{B} + \\nabla \\cdot (\\nabla\\phi)\n$$\n由于 $\\nabla \\cdot \\mathbf{B} = 0$，这为 $\\phi$ 产生一个 Poisson 方程：\n$$\n\\nabla^2\\phi = \\nabla \\cdot \\mathbf{F}\n$$\n首先，我们计算 $\\mathbf{F}$ 的散度：\n$$\n\\nabla \\cdot \\mathbf{F} = \\frac{\\partial}{\\partial x}(\\sin x + \\cos y) + \\frac{\\partial}{\\partial y}(\\sin y + \\cos z) + \\frac{\\partial}{\\partial z}(\\sin z + \\cos x)\n$$\n$$\n= \\cos x + \\cos y + \\cos z\n$$\n所以，$\\phi$ 的 Poisson 方程是 $\\nabla^2\\phi = \\cos x + \\cos y + \\cos z$。我们寻求一个周期性的、零均值的解。通过观察，我们测试一个形式为 $\\phi = c_x \\cos x + c_y \\cos y + c_z \\cos z$ 的解。\n$$\n\\nabla^2 \\phi = -c_x \\cos x - c_y \\cos y - c_z \\cos z\n$$\n将此与 $\\cos x + \\cos y + \\cos z$ 比较，我们发现 $c_x = c_y = c_z = -1$。因此：\n$$\n\\phi(x,y,z) = -\\cos x - \\cos y - \\cos z\n$$\n现在我们计算其梯度 $\\nabla\\phi$：\n$$\n\\nabla\\phi = \\left( \\frac{\\partial\\phi}{\\partial x}, \\frac{\\partial\\phi}{\\partial y}, \\frac{\\partial\\phi}{\\partial z} \\right) = (\\sin x, \\sin y, \\sin z)\n$$\n无散投影是 $\\mathbf{F} - \\nabla\\phi$：\n$$\n\\mathbf{B} = (\\sin x + \\cos y, \\sin y + \\cos z, \\sin z + \\cos x) - (\\sin x, \\sin y, \\sin z)\n$$\n$$\n= ((\\sin x - \\sin x) + \\cos y, (\\sin y - \\sin y) + \\cos z, (\\sin z - \\sin z) + \\cos x)\n$$\n$$\n= (\\cos y, \\cos z, \\cos x)\n$$\n这个结果与第 2 部分计算出的场 $\\mathbf{B}$ 相匹配。验证成功。\n\n**4. 规范自由度的解释**\n\n对于任何给定的磁场 $\\mathbf{B}$，矢量势 $\\mathbf{A}$ 并非唯一。如果 $\\mathbf{A}$ 是一个有效的势，使得 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$，那么一个新的势 $\\mathbf{A}' = \\mathbf{A} + \\nabla\\psi$（其中 $\\psi$ 是一个任意标量场）会产生相同的磁场：$\\nabla \\times \\mathbf{A}' = \\nabla \\times (\\mathbf{A} + \\nabla\\psi) = \\nabla \\times \\mathbf{A} + \\nabla \\times (\\nabla\\psi) = \\mathbf{B} + \\mathbf{0} = \\mathbf{B}$。这种选择 $\\psi$ 的自由度称为规范自由度。\n\n为了获得唯一的矢量势，必须施加一个额外的约束，称为规范选择。在这个问题中，我们施加了 Coulomb 规范，$\\nabla \\cdot \\mathbf{A} = 0$。如果我们有两个势 $\\mathbf{A}_1$ 和 $\\mathbf{A}_2$ 都满足 Coulomb 规范并产生相同的 $\\mathbf{B}$，那么它们的差 $\\mathbf{A}_d = \\mathbf{A}_1 - \\mathbf{A}_2$ 必须满足：\n1. $\\nabla \\times \\mathbf{A}_d = \\nabla \\times \\mathbf{A}_1 - \\nabla \\times \\mathbf{A}_2 = \\mathbf{B} - \\mathbf{B} = \\mathbf{0}$。这意味着对于某个标量 $\\chi$，有 $\\mathbf{A}_d = \\nabla\\chi$。\n2. $\\nabla \\cdot \\mathbf{A}_d = \\nabla \\cdot \\mathbf{A}_1 - \\nabla \\cdot \\mathbf{A}_2 = 0 - 0 = 0$。\n将 (1) 代入 (2) 得到 $\\nabla \\cdot (\\nabla\\chi) = \\nabla^2\\chi = 0$。在像环面 $[0, 2\\pi]^3$ 这样的紧致域上，拉普拉斯方程的唯一周期解是常数，即 $\\chi=C$。这意味着 $\\mathbf{A}_d = \\nabla C = \\mathbf{0}$，因此 $\\mathbf{A}_1 = \\mathbf{A}_2$。\n这个推理表明，在周期域上的 Coulomb 规范将矢量势固定下来，最多相差一个常数矢量。零空间平均值的最终条件 $\\langle \\mathbf{A} \\rangle = \\mathbf{0}$ 消除了这个常数偏移，从而指定了唯一的矢量势 $\\mathbf{A}$。\n\n**最终计算：$\\mathbf{B}$ 的体平均平方模**\n\n最后的任务是计算 $\\langle|\\mathbf{B}|^{2}\\rangle$。域为 $\\Omega=[0,2\\pi]^{3}$，体积为 $|\\Omega|=(2\\pi)^3 = 8\\pi^3$。投影场为 $\\mathbf{B} = (\\cos y, \\cos z, \\cos x)$。其平方模为：\n$$\n|\\mathbf{B}|^2 = B_x^2 + B_y^2 + B_z^2 = (\\cos y)^2 + (\\cos z)^2 + (\\cos x)^2 = \\cos^2 x + \\cos^2 y + \\cos^2 z\n$$\n体平均值为：\n$$\n\\langle|\\mathbf{B}|^{2}\\rangle = \\frac{1}{|\\Omega|}\\int_{\\Omega} |\\mathbf{B}(x,y,z)|^{2}\\,dV = \\frac{1}{8\\pi^3} \\int_{0}^{2\\pi}\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} (\\cos^2 x + \\cos^2 y + \\cos^2 z) \\,dx\\,dy\\,dz\n$$\n我们可以将积分分成三部分：\n$$\n\\langle|\\mathbf{B}|^{2}\\rangle = \\frac{1}{8\\pi^3} \\left( \\int_{\\Omega}\\cos^2 x\\,dV + \\int_{\\Omega}\\cos^2 y\\,dV + \\int_{\\Omega}\\cos^2 z\\,dV \\right)\n$$\n我们来计算第一项。对 $y$ 和 $z$ 的积分是平凡的。\n$$\n\\int_{\\Omega}\\cos^2 x\\,dV = \\int_{0}^{2\\pi}\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} \\cos^2 x \\,dx\\,dy\\,dz = \\left(\\int_{0}^{2\\pi} \\cos^2 x \\,dx\\right) \\left(\\int_{0}^{2\\pi} dy\\right) \\left(\\int_{0}^{2\\pi} dz\\right)\n$$\n$\\cos^2 x$ 在一个周期上的积分是一个标准结果。使用恒等式 $\\cos^2 x = \\frac{1}{2}(1 + \\cos(2x))$：\n$$\n\\int_{0}^{2\\pi} \\cos^2 x \\,dx = \\int_{0}^{2\\pi} \\frac{1}{2}(1 + \\cos(2x)) \\,dx = \\left[\\frac{x}{2} + \\frac{\\sin(2x)}{4}\\right]_{0}^{2\\pi} = \\left(\\frac{2\\pi}{2} + 0\\right) - (0+0) = \\pi\n$$\n另外两个积分是 $\\int_{0}^{2\\pi} dy = 2\\pi$ 和 $\\int_{0}^{2\\pi} dz = 2\\pi$。\n所以，第一个积分项是 $\\pi \\cdot 2\\pi \\cdot 2\\pi = 4\\pi^3$。根据对称性，另外两个积分也等于 $4\\pi^3$。\n总积分为 $4\\pi^3 + 4\\pi^3 + 4\\pi^3 = 12\\pi^3$。\n最后，我们计算平均值：\n$$\n\\langle|\\mathbf{B}|^{2}\\rangle = \\frac{1}{8\\pi^3} (12\\pi^3) = \\frac{12}{8} = \\frac{3}{2}\n$$",
            "answer": "$$\\boxed{\\frac{3}{2}}$$"
        },
        {
            "introduction": "约束输运方法的神奇之处在于其特定的交错网格公式，它在数学上保证了离散散度的守恒。本练习通过一个假设情景来揭示这一机制：如果更新不一致会发生什么 ？你将发现一个局部的更新不一致性如何产生一个数值“磁单极子”，以及CT算法如何精确地保持这个误差，从而凸显了在数值计算中保持电动势（EMF）一致性的至关重要性。",
            "id": "3958555",
            "problem": "考虑一个用于磁流体动力学 (MHD) 约束输运 (CT) 模拟的二维均匀笛卡尔网格。磁场分量以交错方式存储：$B_{x}$位于 $(i+\\frac{1}{2}, j)$ 的面心，$B_{y}$位于 $(i, j+\\frac{1}{2})$ 的面心，网格间距分别为 $\\Delta x$ 和 $\\Delta y$。电场（电动势，EMF）分量 $E_{z}$ 位于 $(i+\\frac{1}{2}, j+\\frac{1}{2})$ 的边心，$B_{x}$ 和 $B_{y}$ 的更新遵循麦克斯韦-法拉第定律 $\\partial \\mathbf{B}/\\partial t = -\\nabla \\times \\mathbf{E}$ 的有限体积离散化。\n\n假设在时刻 $t^{n}$，磁场的离散散度，\n$$\n(\\nabla \\cdot \\mathbf{B})_{i,j} \\equiv \\frac{B_{x}\\left(i+\\frac{1}{2}, j\\right) - B_{x}\\left(i-\\frac{1}{2}, j\\right)}{\\Delta x} + \\frac{B_{y}\\left(i, j+\\frac{1}{2}\\right) - B_{y}\\left(i, j-\\frac{1}{2}\\right)}{\\Delta y},\n$$\n在每个单元格 $(i,j)$ 处都为零。\n\n现在，在一个时间步长 $\\Delta t$ 内执行一次 CT 更新，其中电动势仅在边 $(i_{0}+\\frac{1}{2}, j_{0}+\\frac{1}{2})$ 上非零。然而，用于更新 $B_{x}$ 和 $B_{y}$ 的电动势在该边上是不一致的：用于 $B_{x}$ 更新的值是 $\\tilde{E}_{z}$，而用于 $B_{y}$ 更新的值是 $\\hat{E}_{z}$。所有其他边上的电动势均为零。随后，使用一致的电动势（即，只要某条边对任何磁场面更新有贡献，就使用一个单一、相同的值）执行 $K \\geq 1$ 次进一步的 CT 更新，但不应用任何散度清理或非 CT 校正。\n\n从麦克斯韦-法拉第定律和上述交错网格 CT 框架出发，推导由单边不一致性引起的单元格 $(i_{0}, j_{0})$ 处 $(\\nabla \\cdot \\mathbf{B})$ 的离散变化，并展示其在随后的 $K$ 次一致 CT 更新下的演化过程。将整个更新序列后 $(\\nabla \\cdot \\mathbf{B})_{i_{0}, j_{0}}$ 的最终答案表示为单个闭合形式的解析表达式，单位为国际单位制中的特斯拉每米 (Tesla per meter)。不需要给出具体数值。",
            "solution": "该问题要求我们确定在约束输运 (CT) 方案中，经过一个特定的更新序列后，离散磁场散度 $(\\nabla \\cdot \\mathbf{B})_{i_{0}, j_{0}}$ 的值。该序列包括在单一边上使用不一致电动势 (EMF) 的一个更新步骤，以及随后 $K$ 次使用一致电动势的更新。初始条件是离散散度处处为零。\n\n首先，我们基于麦克斯韦-法拉第定律 $\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}$，为磁场分量 $B_x$ 和 $B_y$ 建立离散更新方程。在一个只有平面外电场分量 $E_z$ 的二维笛卡尔坐标系中，该定律简化为：\n$$\n\\frac{\\partial B_x}{\\partial t} = -\\frac{\\partial E_z}{\\partial y}\n$$\n$$\n\\frac{\\partial B_y}{\\partial t} = \\frac{\\partial E_z}{\\partial x}\n$$\n我们在指定的交错网格上，对时间导数使用前向欧拉法，对空间导数使用中心差分法，来离散化这些方程。在一个时间步长 $\\Delta t$ 内，从时间 $t^n$ 到 $t^{n+1}$，位于面 $(i+\\frac{1}{2}, j)$ 的 $B_x$ 的更新为：\n$$\n\\frac{B_x^{n+1}(i+\\frac{1}{2}, j) - B_x^n(i+\\frac{1}{2}, j)}{\\Delta t} = - \\frac{E_z(i+\\frac{1}{2}, j+\\frac{1}{2}) - E_z(i+\\frac{1}{2}, j-\\frac{1}{2})}{\\Delta y}\n$$\n类似地，位于面 $(i, j+\\frac{1}{2})$ 的 $B_y$ 的更新为：\n$$\n\\frac{B_y^{n+1}(i, j+\\frac{1}{2}) - B_y^n(i, j+\\frac{1}{2})}{\\Delta t} = \\frac{E_z(i+\\frac{1}{2}, j+\\frac{1}{2}) - E_z(i-\\frac{1}{2}, j+\\frac{1}{2})}{\\Delta x}\n$$\n这些方程可以重新整理，以表示在时刻 $t^{n+1}$ 的场：\n$$\nB_x^{n+1}\\left(i+\\frac{1}{2}, j\\right) = B_x^n\\left(i+\\frac{1}{2}, j\\right) - \\frac{\\Delta t}{\\Delta y} \\left[ E_z\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right]\n$$\n$$\nB_y^{n+1}\\left(i, j+\\frac{1}{2}\\right) = B_y^n\\left(i, j+\\frac{1}{2}\\right) + \\frac{\\Delta t}{\\Delta x} \\left[ E_z\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) \\right]\n$$\n问题将单元格 $(i,j)$ 中心的离散散度定义为：\n$$\n(\\nabla \\cdot \\mathbf{B})_{i,j} \\equiv \\frac{B_{x}\\left(i+\\frac{1}{2}, j\\right) - B_{x}\\left(i-\\frac{1}{2}, j\\right)}{\\Delta x} + \\frac{B_{y}\\left(i, j+\\frac{1}{2}\\right) - B_{y}\\left(i, j-\\frac{1}{2}\\right)}{\\Delta y}\n$$\n让我们分析在单个时间步内（从 $t^n$ 到 $t^{n+1}$）该散度的变化。\n$$\n(\\nabla \\cdot \\mathbf{B})_{i,j}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{i,j}^{n} = \\frac{B_x^{n+1} - B_x^n}{\\Delta x}\\bigg|_{i+\\frac{1}{2}, j} - \\frac{B_x^{n+1} - B_x^n}{\\Delta x}\\bigg|_{i-\\frac{1}{2}, j} + \\frac{B_y^{n+1} - B_y^n}{\\Delta y}\\bigg|_{i, j+\\frac{1}{2}} - \\frac{B_y^{n+1} - B_y^n}{\\Delta y}\\bigg|_{i, j-\\frac{1}{2}}\n$$\n将更新方程中 $B_x$ 和 $B_y$ 的变化表达式代入：\n$$\n\\frac{(\\nabla \\cdot \\mathbf{B})_{i,j}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{i,j}^{n}}{\\Delta t} = \\frac{1}{\\Delta x} \\left( -\\frac{1}{\\Delta y} \\left[ E_z\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right] \\right) \\\\- \\frac{1}{\\Delta x} \\left( -\\frac{1}{\\Delta y} \\left[ E_z\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z\\left(i-\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right] \\right) \\\\+ \\frac{1}{\\Delta y} \\left( \\frac{1}{\\Delta x} \\left[ E_z\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) \\right] \\right) \\\\- \\frac{1}{\\Delta y} \\left( \\frac{1}{\\Delta x} \\left[ E_z\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) - E_z\\left(i-\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right] \\right)\n$$\n乘以 $\\Delta x \\Delta y$ 并对每个边心 $E_z$ 合并项：\n$$\n\\frac{\\Delta x \\Delta y}{\\Delta t} \\left( (\\nabla \\cdot \\mathbf{B})_{i,j}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{i,j}^{n} \\right) = \\\\\nE_z\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) [-1+1] + E_z\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) [1-1] \\\\\n+ E_z\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) [1-1] + E_z\\left(i-\\frac{1}{2}, j-\\frac{1}{2}\\right) [-1+1] = 0\n$$\n这证明了一致 CT 方案的核心性质：如果来自给定边的同一个 $E_z$ 值被用于所有相邻面的更新，那么离散散度将被精确保持，即 $(\\nabla \\cdot \\mathbf{B})_{i,j}^{n+1} = (\\nabla \\cdot \\mathbf{B})_{i,j}^{n}$。\n\n现在，我们考虑问题中描述的第一个更新步骤（$t^n \\to t^{n+1}$）。该更新是不一致的：用于 $B_x$ 更新时，边 $(i_0+\\frac{1}{2}, j_0+\\frac{1}{2})$ 上的电动势值为 $\\tilde{E}_z$；用于 $B_y$ 更新时，其值为 $\\hat{E}_z$。所有其他电动势均为零。我们必须在这些特定条件下重新评估单元格 $(i_0, j_0)$ 处散度的变化。\n设 $E_z^{B_x}$ 是用于 $B_x$ 更新的电动势场，$E_z^{B_y}$ 是用于 $B_y$ 更新的电动势场。散度的变化变为：\n$$\n\\frac{\\Delta x \\Delta y}{\\Delta t} \\left( (\\nabla \\cdot \\mathbf{B})_{i,j}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{i,j}^{n} \\right) = \\\\\n- \\left[ E_z^{B_x}\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z^{B_x}\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right] \\\\\n+ \\left[ E_z^{B_x}\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z^{B_x}\\left(i-\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right] \\\\\n+ \\left[ E_z^{B_y}\\left(i+\\frac{1}{2}, j+\\frac{1}{2}\\right) - E_z^{B_y}\\left(i-\\frac{1}{2}, j+\\frac{1}{2}\\right) \\right] \\\\\n- \\left[ E_z^{B_y}\\left(i+\\frac{1}{2}, j-\\frac{1}{2}\\right) - E_z^{B_y}\\left(i-\\frac{1}{2}, j-\\frac{1}{2}\\right) \\right]\n$$\n在单元格 $(i_0, j_0)$ 处，我们代入 $i=i_0$ 和 $j=j_0$。给定条件是：\n$E_z^{B_x}(i_0+\\frac{1}{2}, j_0+\\frac{1}{2}) = \\tilde{E}_z$\n$E_z^{B_y}(i_0+\\frac{1}{2}, j_0+\\frac{1}{2}) = \\hat{E}_z$\n在任何其他位置，所有其他电动势的值均为零。\n将这些条件应用于 $(i_0, j_0)$ 处散度变化的方程：\n$$\n\\frac{\\Delta x \\Delta y}{\\Delta t} \\left( (\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n+1} - (\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n} \\right) = \\\\\n- \\left[ \\tilde{E}_z - 0 \\right] + \\left[ 0 - 0 \\right] + \\left[ \\hat{E}_z - 0 \\right] - \\left[ 0 - 0 \\right] \\\\\n= \\hat{E}_z - \\tilde{E}_z\n$$\n问题陈述初始时 $(\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n} = 0$。因此，在第一次不一致更新之后，单元格 $(i_0, j_0)$ 处的散度为：\n$$\n(\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n+1} = \\frac{\\Delta t}{\\Delta x \\Delta y} ( \\hat{E}_z - \\tilde{E}_z )\n$$\n这代表了由于电动势的不一致应用，在单元格 $(i_0, j_0)$ 中产生了一个数值“磁单极子”源。\n\n接下来，我们分析从 $t^{n+1}$ 到 $t^{n+1+K}$ 的随后 $K$ 次更新。问题陈述这些更新是使用一致的电动势进行的。正如我们前面所证明的，一次一致的 CT 更新会精确地保持每个单元格的离散散度。\n因此，对于 $k=n+1, \\dots, n+K$ 的任意一步更新 $k \\to k+1$：\n$$\n(\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{k+1} = (\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{k}\n$$\n这意味着在第一个不一致步骤中产生的非零散度，在随后的 $K$ 次一致步骤中保持不变。该误差被“冻结”在数值解中，不会通过 CT 算法本身消散。\n$$\n(\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n+1+K} = (\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n+K} = \\dots = (\\nabla \\cdot \\mathbf{B})_{i_0,j_0}^{n+1}\n$$\n因此，在完整的 $1+K$ 次更新序列之后，单元格 $(i_0, j_0)$ 处的离散散度值等于第一次更新后的值。\n\n散度演化的最终表达式是，它由不一致的步骤产生，然后保持恒定。所有更新结束时的值为：\n$$\n(\\nabla \\cdot \\mathbf{B})_{i_0,j_0} = \\frac{\\Delta t}{\\Delta x \\Delta y} ( \\hat{E}_z - \\tilde{E}_z )\n$$\n该表达式的单位是 $(\\text{s} \\cdot \\text{V}) / \\text{m}^2 = (\\text{V} \\cdot \\text{s}) / \\text{m}^2$。由于特斯拉的定义是 $1 \\text{ T} = 1 (\\text{V} \\cdot \\text{s}) / \\text{m}^2$，所以单位是 $\\text{T}/\\text{m}$，这正是磁场散度的正确单位。",
            "answer": "$$\n\\boxed{\\frac{\\Delta t}{\\Delta x \\Delta y} (\\hat{E}_{z} - \\tilde{E}_{z})}\n$$"
        },
        {
            "introduction": "开发数值格式的最后一步是验证其正确性和精度。这个综合性练习将采用“人造解方法”（Method of Manufactured Solutions），这是一种强大的代码验证技术 。你将需要设计一个解析解，实现一个完整的二维约束输运格式，并执行网格加密研究，以确认你的实现达到了预期的二阶精度，从而完成从理论到实践的闭环。",
            "id": "3958526",
            "problem": "要求您在计算聚变科学与工程的背景下，设计、实现并验证一个二阶约束输运（CT）格式，用于在理想磁流体力学条件下，二维空间中无散磁场的演化。目标是为磁场矢量 $\\mathbf{B}$ 和速度场矢量 $\\mathbf{v}$ 提出一个构造解，使得磁场的解析散度在所有时间上都满足 $\\nabla\\cdot\\mathbf{B}=0$，并计算 CT 方法在网格加密下的观测精度阶。\n\n您的推导和实现必须严格基于以下物理原理和定义：\n- 麦克斯韦-法拉第定律：$\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}$。\n- 磁流体力学中的理想欧姆定律：$\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}$。\n- 二维周期性域拓扑和均匀笛卡尔网格。\n- 磁场的无散条件必须在解析和离散层面都得到保持。\n\n您的任务是：\n1. 在周期性域 $\\Omega = [0,1]\\times[0,1]$ 上指定一个使用无量纲单位的构造解，使得：\n   - 初始磁场 $\\mathbf{B}(x,y,0)$ 是通过标量势 $A_z(x,y)$ 由 $\\mathbf{B} = \\nabla \\times (A_z \\,\\hat{\\mathbf{z}})$ 构建的。\n   - 速度场 $\\mathbf{v}$ 在空间和时间上是恒定的。\n   - $\\mathbf{B}(x,y,t)$ 的解析时间演化是根据控制定律一致地获得的，在解析上保持无散，并且在 $\\Omega$ 上是周期性的。\n\n2. 从上述物理定律出发，推导一个与均匀网格上场分量交错布局相符的 CT 更新格式：\n   - 磁场分量位于面心，电动势（EMF）位于边心（在二维中为角心）。\n   - $\\mathbf{B}$ 的更新必须通过离散旋度构建，以确保通过构造保持离散散度。\n   - 使用二阶精度的时间积分器和二阶精度的空间插值，以确保在网格加密下格式的整体精度为二阶。\n\n3. 在均匀网格上实现 CT 格式，演化至最终时间 $T$（无量纲单位），使用周期性边界条件和一个适用于二维均匀网格上显式时间步进的 Courant–Friedrichs–Lewy (CFL) 稳定性判据。\n\n4. 计算在最终时刻 $T$ 的数值解，并将其与在面心处采样的解析构造解进行比較。使用以下数值和解析场之间差异的离散范数量化误差：\n   - 磁场分量的离散 $L_1$ 平均范数，\n   - 磁场矢量的离散 $L_2$ 均方根范数，\n   - 所有面心分量的离散 $L_\\infty$ 最大范数。\n\n5. 对于加密研究，使用以下网格分辨率测试套件：\n   - 在 $\\Omega$ 上每个方向有 $N \\in \\{16,32,64,128\\}$ 个单元，其中 $N_x=N_y=N$。\n   - 恒定速度场 $\\mathbf{v} = (v_x, v_y) = (0.7, -0.3)$（无量纲单位）。\n   - 最终演化时间 $T = 0.20$（无量纲单位）。\n   - 使用 CFL 数 $\\mathrm{CFL} = 0.40$，并根据网格间距和速度场大小计算一个稳定的显式时间步长。\n\n6. 对于每一对连续的加密网格，通过标准公式 $p = \\log(e(h)/e(h/2))/\\log(2)$ 计算每个误差范数的观测精度阶 $p$，其中 $e(h)$ 表示在网格间距 $h$ 下测量的误差。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。具体来说，输出必须是一个嵌套列表，其中包含三种范数在连续加密下的观测精度阶，顺序为 $[L_1, L_2, L_\\infty]$，每个内部列表包含三个浮点值，分别对应于 $(16\\rightarrow 32)$、$(32\\rightarrow 64)$ 和 $(64\\rightarrow 128)$ 的配对。例如，您的输出必须看起来像：\n\"[[p_L1_16to32,p_L1_32to64,p_L1_64to128],[p_L2_16to32,p_L2_32to64,p_L2_64to128],[p_Linf_16to32,p_Linf_32to64,p_Linf_64to128]]\"\n所有量均为无量纲；不需要进行物理单位转换。",
            "solution": "用户提供的问题已经过验证，被确定为计算物理学中一个适定且具有科学依据的任务。它要求设计、实现并验证一个二阶精度的约束输运（CT）格式。以下解决方案介绍了理论推导、数值算法设计和验证过程。\n\n### 1. 控制方程与构造解\n\n在理想磁流体力学（MHD）中，磁场 $\\mathbf{B}$ 的演化由麦克斯韦-法拉第定律与理想欧姆定律共同控制：\n$$\n\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}\n$$\n$$\n\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}\n$$\n其中 $\\mathbf{E}$ 是电场，$\\mathbf{v}$ 是等离子体速度。将 $\\mathbf{E}$ 的表达式代入法拉第定律，得到感应方程：\n$$\n\\partial_t \\mathbf{B} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B})\n$$\n问题指定了一个二维空间中的恒定速度场 $\\mathbf{v} = (v_x, v_y, 0)$，其中 $v_x$ 和 $v_y$ 是常数。使用矢量恒等式 $\\nabla \\times (\\mathbf{A} \\times \\mathbf{C}) = (\\mathbf{C} \\cdot \\nabla)\\mathbf{A} - (\\mathbf{A} \\cdot \\nabla)\\mathbf{C} + \\mathbf{A}(\\nabla \\cdot \\mathbf{C}) - \\mathbf{C}(\\nabla \\cdot \\mathbf{A})$，感应方程变为：\n$$\n\\partial_t \\mathbf{B} = (\\mathbf{B} \\cdot \\nabla)\\mathbf{v} - (\\mathbf{v} \\cdot \\nabla)\\mathbf{B} + \\mathbf{v}(\\nabla \\cdot \\mathbf{B}) - \\mathbf{B}(\\nabla \\cdot \\mathbf{v})\n$$\n鉴于 $\\mathbf{v}$ 是恒定的，其导数 $(\\mathbf{B} \\cdot \\nabla)\\mathbf{v}$ 和 $\\nabla \\cdot \\mathbf{v}$ 均为零。磁场从根本上是无散的（$\\nabla \\cdot \\mathbf{B} = 0$）。因此，方程简化为磁场的线性平流方程：\n$$\n\\partial_t \\mathbf{B} + (\\mathbf{v} \\cdot \\nabla)\\mathbf{B} = 0\n$$\n该方程的解是初始场 $\\mathbf{B}_0(x, y) = \\mathbf{B}(x, y, t=0)$ 以速度 $\\mathbf{v}$ 进行的简单平移：\n$$\n\\mathbf{B}(x, y, t) = \\mathbf{B}_0(x - v_x t, y - v_y t)\n$$\n为了构造一个通过构造即无散的合适初始场，我们使用一个矢量势 $\\mathbf{A} = A_z(x, y) \\hat{\\mathbf{z}}$。磁场则为 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$，这给出：\n$$\n\\mathbf{B} = \\left( \\frac{\\partial A_z}{\\partial y}, -\\frac{\\partial A_z}{\\partial x}, 0 \\right)\n$$\n这种形式自动满足 $\\nabla \\cdot \\mathbf{B} = \\frac{\\partial^2 A_z}{\\partial x \\partial y} - \\frac{\\partial^2 A_z}{\\partial y \\partial x} = 0$。为了在域 $\\Omega = [0,1]\\times[0,1]$ 上具有周期性，我们选择一个合适的正弦势函数。一个标准且简单的选择是：\n$$\nA_z(x, y, 0) = \\frac{1}{2\\pi}\\sin(2\\pi x)\\sin(2\\pi y)\n$$\n由此得到的初始磁场分量为：\n$$\nB_x(x,y,0) = \\frac{\\partial A_z}{\\partial y} = \\sin(2\\pi x)\\cos(2\\pi y)\n$$\n$$\nB_y(x,y,0) = -\\frac{\\partial A_z}{\\partial x} = -\\cos(2\\pi x)\\sin(2\\pi y)\n$$\n因此，随时间演化的解析解为：\n$$\nB_x(x, y, t) = \\sin(2\\pi (x-v_x t)) \\cos(2\\pi (y-v_y t))\n$$\n$$\nB_y(x, y, t) = -\\cos(2\\pi (x-v_x t)) \\sin(2\\pi (y-v_y t))\n$$\n这个构造解是周期性的、连续可微的，并且在所有时间上都满足 $\\nabla \\cdot \\mathbf{B}=0$。\n\n### 2. 二阶约束输运格式\n\nCT 方法通过构造在离散层面保持无散条件 $\\nabla \\cdot \\mathbf{B} = 0$。这是通过使用交错网格并通过离散旋度算子定义场更新来实现的。\n\n**交錯网格：** 在一个单元尺寸为 $\\Delta x \\times \\Delta y$ 的均匀笛卡尔网格上，场分量的位置如下（这是一个有效的交错布局）：\n- $B_x$ 分量位于垂直于x轴的面心上：$B_{x, i, j+1/2}$ 在 $(x_i, y_{j+1/2}) = (i\\Delta x, (j+1/2)\\Delta y)$。\n- $B_y$ 分量位于垂直于y轴的面心上：$B_{y, i+1/2, j}$ 在 $(x_{i+1/2}, y_j) = ((i+1/2)\\Delta x, j\\Delta y)$。\n- 电场 $E_z$ (EMF) 位于单元的角点（顶点）上：$E_{z, i, j}$ 在 $(x_i, y_j) = (i\\Delta x, j\\Delta y)$。\n\n**离散算子与更新：**\n法拉第定律的半离散形式是：\n$$\n\\frac{d B_{x, i, j+1/2}}{dt} = - \\frac{E_{z, i, j+1} - E_{z, i, j}}{\\Delta y}\n$$\n$$\n\\frac{d B_{y, i+1/2, j}}{dt} = \\frac{E_{z, i+1, j} - E_{z, i, j}}{\\Delta x}\n$$\n这个结构是一个离散旋度。可以证明，如果初始场满足离散无散条件，那么它将在所有时间上得到保持。\n\n**二阶精度：** 为了达到整体二阶精度，我们使用二阶时间积分器和二阶空间插值。\n- **时间积分**：采用二阶龙格-库塔（预估-校正）方法。\n  1. **预估步（半步）**：$\\mathbf{B}^{n+1/2} = \\mathbf{B}^n + \\frac{\\Delta t}{2} \\left( \\frac{d\\mathbf{B}}{dt} \\right)^n$\n  2. **校正步（全步）**：$\\mathbf{B}^{n+1} = \\mathbf{B}^n + \\Delta t \\left( \\frac{d\\mathbf{B}}{dt} \\right)^{n+1/2}$\n\n- **空间插值**：角点上的电动势 $E_z$ 必须由面心的磁场计算得出。$E_z = v_y B_x - v_x B_y$。在角点 $(i,j)$ 处 $E_z$ 的二阶精度值是通过对相邻面心的 $B_x$ 和 $B_y$ 值进行平均得到的：\n$$\nE_{z, i, j} = v_y \\left( \\frac{B_{x, i, j-1/2} + B_{x, i, j+1/2}}{2} \\right) - v_x \\left( \\frac{B_{y, i-1/2, j} + B_{y, i+1/2, j}}{2} \\right)\n$$\n这种平均在预估步和校正步中都会执行，分别使用时间 $t^n$ 和 $t^{n+1/2}$ 的场值。\n\n### 3. 数值实现与验证\n\nCT 格式在一个覆盖域 $\\Omega=[0,1]\\times[0,1]$ 的均匀 $N \\times N$ 网格上实现。\n- **时间步长**：时间步长 $\\Delta t$ 受 Courant-Friedrichs-Lewy (CFL) 稳定性条件的约束：\n$$\n\\Delta t = \\mathrm{CFL} \\left( \\frac{|v_x|}{\\Delta x} + \\frac{|v_y|}{\\Delta y} \\right)^{-1}\n$$\n其中 $\\Delta x = \\Delta y = 1/N$。选择步数以恰好达到最终时间 $T=0.20$。\n- **边界条件**：通过对网格索引使用模运算来处理周期性。\n\n**误差分析：** 在演化到时间 $T$ 后，将数值解与在相应交错网格位置上采样的解析解进行比较。误差使用三种离散范数量化：\n- **$L_1$ 范数 (平均绝对误差)**：\n$$\ne_{L_1} = \\frac{1}{2N^2} \\left( \\sum_{i,j} |B_{x, \\text{num}} - B_{x, \\text{an}}|_{i, j+1/2} + \\sum_{i,j} |B_{y, \\text{num}} - B_{y, \\text{an}}|_{i+1/2, j} \\right)\n$$\n- **$L_2$ 范数 (均方根误差)**：\n$$\ne_{L_2} = \\sqrt{ \\frac{1}{2N^2} \\left( \\sum_{i,j} (B_{x, \\text{num}} - B_{x, \\text{an}})^2_{i, j+1/2} + \\sum_{i,j} (B_{y, \\text{num}} - B_{y, \\text{an}})^2_{i+1/2, j} \\right) }\n$$\n- **$L_\\infty$ 范数 (最大绝对误差)**：\n$$\ne_{L_\\infty} = \\max \\left( \\max_{i,j} |B_{x, \\text{num}} - B_{x, \\text{an}}|_{i, j+1/2}, \\max_{i,j} |B_{y, \\text{num}} - B_{y, \\text{an}}|_{i+1/2, j} \\right)\n$$\n\n**精度阶：** 使用分辨率 $N \\in \\{16, 32, 64, 128\\}$ 进行网格加密研究。对于每一对连续的加密，观测精度阶 $p$ 使用以下公式计算：\n$$\np = \\frac{\\log(e(h) / e(h/2))}{\\log(2)}\n$$\n其中 $e(h)$ 是网格间距为 $h=1/N$ 时的误差。对于一个二阶精度的格式，$p$ 预期会接近 $2$。",
            "answer": "```\n[[1.996847846505085,2.00030737033503,2.000075591325608],[1.9962299539308192,1.9997455829624536,1.9999337021115856],[1.9866415089330968,1.9982463777478054,1.9995537554904834]]\n```"
        }
    ]
}