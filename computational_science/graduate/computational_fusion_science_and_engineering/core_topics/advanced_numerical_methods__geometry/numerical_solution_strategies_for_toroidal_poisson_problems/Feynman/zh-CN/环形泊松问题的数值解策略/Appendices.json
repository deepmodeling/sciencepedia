{
    "hands_on_practices": [
        {
            "introduction": "求解环形几何中的三维泊松方程通常始于简化问题。一个关键的策略是利用环形等离子体的周期性，通过傅里叶级数将偏微分方程(PDE)分解为一组更易于处理的常微分方程(ODE)。这项实践将指导您应用大环径比近似，并通过变量分离法推导出各个傅里叶模式所满足的径向方程，这是许多环磁约束聚变模拟代码的基础步骤。",
            "id": "4024013",
            "problem": "考虑一个被建模为同心圆环面的大环径比托卡马克中的静电势。使用正交环坐标 $(r,\\theta,\\phi)$，其中 $r \\in [0,a]$ 是小半径，$\\theta \\in [0,2\\pi)$ 是极向角，$\\phi \\in [0,2\\pi)$ 是环向角。假设磁通量面是圆形的、同心的，由 $R(r,\\theta) = R_0 + r \\cos\\theta$ 和 $Z(r,\\theta) = r \\sin\\theta$ 给出，其中 $R_0 \\gg a$ 是大半径，$a$ 是小半径。线元为 $ds^2 = dr^2 + r^2 d\\theta^2 + (R_0 + r \\cos\\theta)^2 d\\phi^2$。静电势 $\\Phi(r,\\theta,\\phi)$ 满足泊松方程 $- \\nabla^2 \\Phi = S(r,\\theta,\\phi)$，其中源项 $S$ 在 $\\theta$ 和 $\\phi$ 上是光滑、平方可积且双周期的。施加在 $r=0$ 处的正则性条件和在 $r=a$ 处的理想导电壁条件，即 $\\Phi(a,\\theta,\\phi)=0$。\n\n从正交坐标中拉普拉斯算子的曲线坐标定义出发，其尺度因子为 $h_r$、$h_\\theta$、$h_\\phi$，\n$$\n\\nabla^2 \\Phi \\;=\\; \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial r}\\!\\left(\\frac{h_\\theta h_\\phi}{h_r}\\,\\frac{\\partial \\Phi}{\\partial r}\\right)\n\\;+\\; \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\theta}\\!\\left(\\frac{h_r h_\\phi}{h_\\theta}\\,\\frac{\\partial \\Phi}{\\partial \\theta}\\right)\n\\;+\\; \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\phi}\\!\\left(\\frac{h_r h_\\theta}{h_\\phi}\\,\\frac{\\partial \\Phi}{\\partial \\phi}\\right).\n$$\n对于同心圆环面，尺度因子为 $h_r=1$、$h_\\theta=r$ 和 $h_\\phi=R_0 + r \\cos\\theta$。将 $\\Phi$ 和 $S$ 展开为关于角度的双重傅里叶级数，\n$$\n\\Phi(r,\\theta,\\phi) \\;=\\; \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} R_{mn}(r)\\,\\exp\\!\\big(i m \\theta\\big)\\,\\exp\\!\\big(i n \\phi\\big), \n\\qquad\nS(r,\\theta,\\phi) \\;=\\; \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} S_{mn}(r)\\,\\exp\\!\\big(i m \\theta\\big)\\,\\exp\\!\\big(i n \\phi\\big),\n$$\n并采用大环径比近似，取 $\\epsilon = a/R_0 \\ll 1$ 的主导阶，使得度规中依赖于 $\\theta$ 的系数可以被它们在 $R_0$ 中的主导阶常数值所替代。在此近似下，进行变量分离，推导每个模式 $(m,n)$ 的解耦径向常微分方程，并将其改写为守恒自伴形式以及一种除以 $r$ 的形式，后者便于在 $r \\in [0,a]$ 上进行逐模式的数值离散化。\n\n最后，在除以 $r$ 的方程中，确定乘以 $R_{mn}(r)$ 的有效径向波数平方函数 $k_{mn}^2(r)$，\n$$\n-\\,\\frac{1}{r}\\,\\frac{d}{dr}\\!\\left(r\\,\\frac{d R_{mn}}{dr}\\right) \\;+\\; k_{mn}^2(r)\\,R_{mn}(r) \\;=\\; S_{mn}(r),\n$$\n并给出 $k_{mn}^2(r)$ 作为 $r$、$m$、$n$ 和 $R_0$ 的显式符号函数。\n\n将你的最终答案表示为 $k_{mn}^2(r)$ 的无单位显式表达式。最终答案中不要包含任何中间方程。",
            "solution": "该问题需要进行验证。\n\n### 步骤1：提取已知条件\n-   **系统**：大环径比托卡马克中的静电势 $\\Phi$。\n-   **坐标**：正交环坐标 $(r,\\theta,\\phi)$，其中 $r \\in [0,a]$，$\\theta \\in [0,2\\pi)$，$\\phi \\in [0,2\\pi)$。\n-   **几何**：$R(r,\\theta) = R_0 + r \\cos\\theta$，$Z(r,\\theta) = r \\sin\\theta$，大半径为 $R_0 \\gg a$，小半径为 a。\n-   **线元**：$ds^2 = dr^2 + r^2 d\\theta^2 + (R_0 + r \\cos\\theta)^2 d\\phi^2$。\n-   **尺度因子**：$h_r=1$，$h_\\theta=r$，$h_\\phi=R_0 + r \\cos\\theta$。\n-   **控制方程**：$-\\nabla^2 \\Phi = S(r,\\theta,\\phi)$，其中 $S$ 是光滑、平方可积、双周期的源。\n-   **边界条件**：在 $r=0$ 处正则，且 $\\Phi(a,\\theta,\\phi)=0$。\n-   **拉普拉斯算子形式**：$\\nabla^2 \\Phi = \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial r}\\!\\left(\\frac{h_\\theta h_\\phi}{h_r}\\,\\frac{\\partial \\Phi}{\\partial r}\\right) + \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\theta}\\!\\left(\\frac{h_r h_\\phi}{h_\\theta}\\,\\frac{\\partial \\Phi}{\\partial \\theta}\\right) + \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\phi}\\!\\left(\\frac{h_r h_\\theta}{h_\\phi}\\,\\frac{\\partial \\Phi}{\\partial \\phi}\\right)$。\n-   **傅里叶展开**：$\\Phi(r,\\theta,\\phi) = \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} R_{mn}(r)\\,\\exp(i m \\theta)\\,\\exp(i n \\phi)$ 和 $S(r,\\theta,\\phi) = \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} S_{mn}(r)\\,\\exp(i m \\theta)\\,\\exp(i n \\phi)$。\n-   **近似**：“采用大环径比近似，取 $\\epsilon = a/R_0 \\ll 1$ 的主导阶，使得度规中依赖于 $\\theta$ 的系数可以被它们在 $R_0$ 中的主导阶常数值所替代。”\n-   **最终目标**：在径向常微分方程中找到函数 $k_{mn}^2(r)$：$-\\,\\frac{1}{r}\\,\\frac{d}{dr}\\!\\left(r\\,\\frac{d R_{mn}}{dr}\\right) + k_{mn}^2(r)\\,R_{mn}(r) = S_{mn}(r)$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于托卡马克中等离子体约束的标准数学物理。简化环坐标系、泊松方程、傅里叶分析以及大环径比近似的使用都是该领域中标准的、成熟的方法。该问题是适定的，提供了清晰的控制方程、边界条件和一个具体的、定义明确的近似方案。所有必要信息都已提供，且没有内部矛盾。这项任务是计算物理学中一个不简单但标准的推导。\n\n### 步骤3：结论与行动\n该问题是有效的。将推导一个严谨的解。\n\n求解过程首先将指定的近似应用于拉普拉斯算子，然后使用给定的傅里叶级数进行变量分离，最后重新整理得到的常微分方程以确定所求项。\n\n给定环坐标系的尺度因子为 $h_r=1$、$h_\\theta=r$ 和 $h_\\phi = R_0 + r \\cos\\theta$。体积元为 $J = h_r h_\\theta h_\\phi = r(R_0 + r \\cos\\theta)$。拉普拉斯算子由下式给出：\n$$\n\\nabla^2 \\Phi = \\frac{1}{r(R_0 + r \\cos\\theta)} \\left[ \\frac{\\partial}{\\partial r}\\left( r(R_0 + r \\cos\\theta) \\frac{\\partial\\Phi}{\\partial r} \\right) + \\frac{\\partial}{\\partial \\theta}\\left( \\frac{R_0 + r \\cos\\theta}{r} \\frac{\\partial\\Phi}{\\partial \\theta} \\right) + \\frac{\\partial}{\\partial \\phi}\\left( \\frac{r}{R_0 + r \\cos\\theta} \\frac{\\partial\\Phi}{\\partial \\phi} \\right) \\right]\n$$\n题目指定了大环径比近似，即“度规中依赖于 $\\theta$ 的系数可以被它们在 $R_0$ 中的主导阶常数值所替代。”唯一这样的系数是尺度因子 $h_\\phi$，它依赖于 $\\theta$。由于 $r \\le a$ 且 $a/R_0 \\ll 1$，我们有 $r/R_0 \\ll 1$。$h_\\phi = R_0 + r \\cos\\theta$ 的主导阶常数值是 $R_0$。\n因此，我们将 $R_0 + r \\cos\\theta \\approx R_0$ 代入拉普拉斯算子的系数中。这一简化至关重要，因为它消除了度规分量中对 $\\theta$ 的显式依赖，从而使得傅里叶模式可以解耦。\n\n近似的拉普拉斯算子，记作 $\\nabla_{approx}^2$，变为：\n$$\n\\nabla_{approx}^2 \\Phi = \\frac{1}{r R_0} \\left[ \\frac{\\partial}{\\partial r}\\left( r R_0 \\frac{\\partial\\Phi}{\\partial r} \\right) + \\frac{\\partial}{\\partial \\theta}\\left( \\frac{R_0}{r} \\frac{\\partial\\Phi}{\\partial \\theta} \\right) + \\frac{\\partial}{\\partial \\phi}\\left( \\frac{r}{R_0} \\frac{\\partial\\Phi}{\\partial \\phi} \\right) \\right]\n$$\n方括号内前两项分子中的 $R_0$ 与总的前置因子中的 $R_0$ 相消：\n$$\n\\nabla_{approx}^2 \\Phi = \\frac{1}{r} \\frac{\\partial}{\\partial r}\\left( r \\frac{\\partial\\Phi}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2\\Phi}{\\partial \\theta^2} + \\frac{1}{R_0^2} \\frac{\\partial^2\\Phi}{\\partial \\phi^2}\n$$\n这是柱坐标 $(r, \\theta, z)$ 下的拉普拉斯算子，其中坐标 $z$ 被弧长坐标 $R_0\\phi$ 替代。\n\n现在，我们将 $\\Phi$ 和 $S$ 的傅里叶级数展开代入泊松方程 $-\\nabla_{approx}^2 \\Phi = S$：\n$$\n-\\sum_{m,n} \\left[ \\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) + \\frac{1}{r^2} (im)^2 R_{mn} + \\frac{1}{R_0^2} (in)^2 R_{mn} \\right] e^{im\\theta} e^{in\\phi} = \\sum_{m,n} S_{mn}(r) e^{im\\theta} e^{in\\phi}\n$$\n角向导数已被其对傅里叶模式的相应作用所替代：$\\frac{\\partial^2}{\\partial \\theta^2} \\to -m^2$ 和 $\\frac{\\partial^2}{\\partial \\phi^2} \\to -n^2$。\n\n基函数 $e^{im\\theta} e^{in\\phi}$ 是正交的。因此，我们可以独立地令每个模式 $(m, n)$ 的系数相等：\n$$\n-\\left[ \\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) - \\frac{m^2}{r^2} R_{mn}(r) - \\frac{n^2}{R_0^2} R_{mn}(r) \\right] = S_{mn}(r)\n$$\n将负号分配到左侧，我们得到模式振幅 $R_{mn}(r)$ 的解耦径向常微分方程：\n$$\n-\\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) + \\frac{m^2}{r^2} R_{mn}(r) + \\frac{n^2}{R_0^2} R_{mn}(r) = S_{mn}(r)\n$$\n该方程可以通过乘以 $r$ 写成“守恒自伴形式”：\n$$\n-\\frac{d}{dr}\\left(r\\,\\frac{d R_{mn}}{dr}\\right) + \\left(\\frac{m^2}{r} + \\frac{n^2 r}{R_0^2}\\right) R_{mn}(r) = rS_{mn}(r)\n$$\n然而，题目要求从“除以 $r$”的形式中确定项 $k_{mn}^2(r)$：\n$$\n-\\frac{1}{r}\\,\\frac{d}{dr}\\!\\left(r\\,\\frac{d R_{mn}}{dr}\\right) + k_{mn}^2(r)\\,R_{mn}(r) = S_{mn}(r)\n$$\n通过合并我们推导的方程中乘以 $R_{mn}(r)$ 的项，我们得到：\n$$\n-\\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) + \\left( \\frac{m^2}{r^2} + \\frac{n^2}{R_0^2} \\right) R_{mn}(r) = S_{mn}(r)\n$$\n将此方程与目标形式直接比较，即可得出有效径向波数平方 $k_{mn}^2(r)$ 的表达式。该项包含了依赖于小半径 $r$ 的极向贡献，以及在此近似下相对于 $r$ 为常数的环向贡献。\n$$\nk_{mn}^2(r) = \\frac{m^2}{r^2} + \\frac{n^2}{R_0^2}\n$$",
            "answer": "$$\n\\boxed{\\frac{m^2}{r^2} + \\frac{n^2}{R_0^2}}\n$$"
        },
        {
            "introduction": "将环形泊松问题简化为径向常微分方程后，我们面临着数值离散化的挑战，特别是在磁轴（$r=0$）处。由于坐标系的性质，标准的有限差分法在此处会遇到奇异性。本练习旨在解决这一关键问题，通过分析轴对称解在原点的正则性条件，推导出一个能够避免奇异性并保持二阶精度的离散格式。",
            "id": "4023945",
            "problem": "在计算聚变科学与工程中，诸如 tokamak 的环形位形会形成一个磁轴，在该磁轴周围，磁通量面在局部极向截面上近似为圆形。考虑在磁轴附近的极向平面中，一个光滑轴对称势 $\\phi$ 的静电泊松方程，以极坐标 $r$ 和 $\\theta$ 写出为\n$$\n\\nabla^2 \\phi \\;=\\; \\frac{1}{r}\\,\\frac{\\partial}{\\partial r}\\!\\left(r\\,\\frac{\\partial \\phi}{\\partial r}\\right) \\;+\\; \\frac{1}{r^2}\\,\\frac{\\partial^2 \\phi}{\\partial \\theta^2} \\;=\\; s(r)\\,,\n$$\n其中 $s(r)$ 是一个给定的光滑源。对于磁轴附近的轴对称情况，假设 $\\partial \\phi/\\partial \\theta = 0$ 且 $\\partial^2 \\phi/\\partial \\theta^2 = 0$, 因此算子简化为\n$$\n\\mathcal{L}\\phi(r) \\;=\\; \\frac{1}{r}\\,\\frac{\\partial}{\\partial r}\\!\\left(r\\,\\frac{\\partial \\phi}{\\partial r}\\right)\\,.\n$$\n设均匀径向网格由 $r_i = i\\Delta r$ 定义，其中整数 $i \\ge 0$, 且 $\\phi_i = \\phi(r_i)$。在磁轴 $r_0 = 0$ 处，坐标因子 $1/r$ 是奇异的，必须构建一个自洽的离散化方案，该方案要满足光滑轴对称场的正则性，特别是 $\\partial \\phi/\\partial r|_{r=0} = 0$, 并且保持 $2$ 阶精度。\n\n从极坐标中拉普拉斯算子的基本定义以及光滑轴对称解在 $r=0$ 处的正则性出发，以下哪种用于轴节点 $i=0$ 处 $\\mathcal{L}\\phi$ 的离散格式能够避免坐标奇点并达到二阶精度？必要时，假设使用镜像虚点值 $\\phi_{-1} = \\phi_1$ 来施加 $\\partial \\phi/\\partial r|_{r=0} = 0$ 条件。\n\nA. $\\mathcal{L}\\phi|_{i=0} = \\dfrac{4(\\phi_1 - \\phi_0)}{\\Delta r^2}$\n\nB. $\\mathcal{L}\\phi|_{i=0} = \\dfrac{\\phi_1 - 2\\phi_0 + \\phi_{-1}}{\\Delta r^2}$\n\nC. $\\mathcal{L}\\phi|_{i=0} = \\dfrac{\\phi_1 - \\phi_0}{\\Delta r^2}$\n\nD. $\\mathcal{L}\\phi|_{i=0} = \\dfrac{1}{r_0}\\dfrac{1}{\\Delta r}\\left[r_{1/2}\\dfrac{\\phi_1 - \\phi_0}{\\Delta r} - r_{-1/2}\\dfrac{\\phi_0 - \\phi_{-1}}{\\Delta r}\\right]$, 其中 $r_{\\pm 1/2} = r_0 \\pm \\dfrac{\\Delta r}{2}$",
            "solution": "### 第一步：提取已知条件\n- **控制方程**: 极坐标 $(r, \\theta)$ 中的轴对称泊松方程由 $\\nabla^2 \\phi = s(r)$ 给出。\n- **算子定义**: 轴对称势 $\\phi(r)$ 的拉普拉斯算子为 $\\mathcal{L}\\phi(r) = \\frac{1}{r}\\,\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial \\phi}{\\partial r}\\right)$。\n- **网格**: 均匀径向网格由 $r_i = i\\Delta r$ 定义，其中整数 $i \\ge 0$。网格点上的势记为 $\\phi_i = \\phi(r_i)$。\n- **关注点**: 需要在磁轴 $r_0 = 0$ 处进行离散化。\n- **奇点**: 由于 $1/r$ 因子，算子 $\\mathcal{L}$ 在 $r_0=0$ 处存在坐标奇点。\n- **正则性条件**: 对于光滑的轴对称解，势的径向导数在轴上必须为零：$\\frac{\\partial \\phi}{\\partial r}|_{r=0} = 0$。\n- **虚点条件**: 假设可以使用镜像虚点值 $\\phi_{-1} = \\phi_1$ 来施加正则性条件。\n- **要求**: $i=0$ 处的 $\\mathcal{L}\\phi$ 的离散格式必须避免奇点、是自洽的，并达到二阶精度，即截断误差必须为 $O(\\Delta r^2)$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题陈述在科学上和数学上都是合理的。它提出了在非笛卡尔坐标系中求解偏微分方程数值解时的一个标准挑战，特别是坐标奇点的处理。控制方程、算子、边界/正则性条件以及对数值格式的要求都得到了清晰和正确的定义。该问题是适定的、客观的，并且完全属于计算物理和数值分析的范畴。它不是自相矛盾的、不完整的或微不足道的。因此，该问题是有效的。\n\n### 第三步：推导正确的离散格式\n算子由 $\\mathcal{L}\\phi(r) = \\frac{1}{r}\\,\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial \\phi}{\\partial r}\\right)$ 给出。展开导数，我们得到：\n$$ \\mathcal{L}\\phi(r) = \\frac{1}{r} \\left( \\frac{\\partial \\phi}{\\partial r} + r\\,\\frac{\\partial^2 \\phi}{\\partial r^2} \\right) = \\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r} + \\frac{\\partial^2 \\phi}{\\partial r^2} $$\n我们需要计算此表达式在 $r=0$ 处的值。在这一点，项 $\\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r}$ 是一个 $0/0$ 型的不定式，因为光滑轴对称解的正则性条件是 $\\frac{\\partial \\phi}{\\partial r}|_{r=0} = 0$。为了解决这个不定式，我们应用洛必达法则：\n$$ \\lim_{r \\to 0} \\left( \\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r} \\right) = \\lim_{r \\to 0} \\frac{\\frac{\\partial}{\\partial r}\\left(\\frac{\\partial \\phi}{\\partial r}\\right)}{\\frac{\\partial}{\\partial r}(r)} = \\lim_{r \\to 0} \\frac{\\frac{\\partial^2 \\phi}{\\partial r^2}}{1} = \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} $$\n将此结果代回 $r=0$ 处的算子表达式中：\n$$ \\mathcal{L}\\phi|_{r=0} = \\left( \\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r} \\right)\\bigg|_{r=0} + \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} = \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} + \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} = 2\\,\\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} $$\n这是算子在轴上精确的、非奇异的形式。现在的任务是为 $\\frac{\\partial^2 \\phi}{\\partial r^2}|_{r=0}$ 找到一个二阶精度的有限差分近似。\n\n$\\phi$ 在 $r_0=0$ 处的二阶导数的标准二阶中心差分近似是：\n$$ \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} \\approx \\frac{\\phi(r_0 + \\Delta r) - 2\\phi(r_0) + \\phi(r_0 - \\Delta r)}{\\Delta r^2} = \\frac{\\phi_1 - 2\\phi_0 + \\phi_{-1}}{\\Delta r^2} $$\n问题提供了可以使用镜像虚点值 $\\phi_{-1} = \\phi_1$ 的条件。这个条件是正则性条件 $\\frac{\\partial \\phi}{\\partial r}|_{r=0} = 0$ 的一个离散施加方式，因为一阶导数的中心差分近似为 $\\frac{\\phi_1 - \\phi_{-1}}{2\\Delta r} = 0$，这意味着 $\\phi_1 = \\phi_{-1}$。\n\n将 $\\phi_{-1} = \\phi_1$ 代入二阶导数的近似式中：\n$$ \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} \\approx \\frac{\\phi_1 - 2\\phi_0 + \\phi_1}{\\Delta r^2} = \\frac{2\\phi_1 - 2\\phi_0}{\\Delta r^2} = \\frac{2(\\phi_1 - \\phi_0)}{\\Delta r^2} $$\n最后，我们将此近似式代回轴上算子的表达式中：\n$$ \\mathcal{L}\\phi|_{r=0} \\approx 2 \\left( \\frac{2(\\phi_1 - \\phi_0)}{\\Delta r^2} \\right) = \\frac{4(\\phi_1 - \\phi_0)}{\\Delta r^2} $$\n\n为了验证二阶精度，我们使用泰勒级数展开。对于一个光滑的轴对称函数，$\\phi(r)$ 在 $r=0$ 附近的展开式只包含 $r$ 的偶数次幂：\n$$ \\phi(r) = \\phi(0) + \\frac{\\phi''(0)}{2!}r^2 + \\frac{\\phi''''(0)}{4!}r^4 + O(r^6) $$\n令 $\\phi_0 = \\phi(0)$ 且 $\\phi_1 = \\phi(\\Delta r)$。则：\n$$ \\phi_1 = \\phi_0 + \\frac{\\phi''(0)}{2}\\Delta r^2 + \\frac{\\phi''''(0)}{24}\\Delta r^4 + O(\\Delta r^6) $$\n提出的离散算子是：\n$$ \\frac{4(\\phi_1 - \\phi_0)}{\\Delta r^2} = \\frac{4}{\\Delta r^2} \\left[ \\frac{\\phi''(0)}{2}\\Delta r^2 + \\frac{\\phi''''(0)}{24}\\Delta r^4 + O(\\Delta r^6) \\right] = 2\\phi''(0) + \\frac{\\phi''''(0)}{6}\\Delta r^2 + O(\\Delta r^4) $$\n精确算子是 $\\mathcal{L}\\phi|_{r=0} = 2\\phi''(0)$。截断误差是离散算子与精确算子之差：\n$$ \\text{误差} = \\left( 2\\phi''(0) + \\frac{\\phi''''(0)}{6}\\Delta r^2 + \\dots \\right) - 2\\phi''(0) = \\frac{\\phi''''(0)}{6}\\Delta r^2 + O(\\Delta r^4) $$\n误差与 $\\Delta r^2$ 成正比，这证实了该格式是二阶精度的。\n\n### 选项评估\n\n**A. $\\mathcal{L}\\phi|_{i=0} = \\dfrac{4(\\phi_1 - \\phi_0)}{\\Delta r^2}$**\n该表达式与我们推导出的格式相符。推导过程表明，它通过计算算子在 $r=0$ 处的解析极限来正确处理奇点，然后应用了与正则性条件一致的二阶精度有限差分近似。\n结论：**正确**。\n\n**B. $\\mathcal{L}\\phi|_{i=0} = \\dfrac{\\phi_1 - 2\\phi_0 + \\phi_{-1}}{\\Delta r^2}$**\n这是二阶导数 $\\frac{\\partial^2 \\phi}{\\partial r^2}|_{r=0}$ 的标准中心差分近似。然而，我们的分析表明 $\\mathcal{L}\\phi|_{r=0} = 2\\frac{\\partial^2 \\phi}{\\partial r^2}|_{r=0}$。因此，该格式缺少一个因子 $2$。使用虚点条件 $\\phi_{-1}=\\phi_1$，该式变为 $\\frac{2(\\phi_1 - \\phi_0)}{\\Delta r^2}$，这与正确结果仍然相差一个因子 $2$。\n结论：**不正确**。\n\n**C. $\\mathcal{L}\\phi|_{i=0} = \\dfrac{\\phi_1 - \\phi_0}{\\Delta r^2}$**\n该格式比正确结果小一个因子 $4$。由泰勒级数确定的其主阶行为将近似于 $\\frac{1}{2}\\phi''(0)$，而正确值为 $2\\phi''(0)$。当 $\\Delta r \\to 0$ 时，该差异不会消失，因此该格式不自洽（即，它有 $O(1)$ 的误差，甚至不是零阶精度）。\n结论：**不正确**。\n\n**D. $\\mathcal{L}\\phi|_{i=0} = \\dfrac{1}{r_0}\\dfrac{1}{\\Delta r}\\left[r_{1/2}\\dfrac{\\phi_1 - \\phi_0}{\\Delta r} - r_{-1/2}\\dfrac{\\phi_0 - \\phi_{-1}}{\\Delta r}\\right]$, 其中 $r_{\\pm 1/2} = r_0 \\pm \\dfrac{\\Delta r}{2}$**\n这是算子 $\\mathcal{L}\\phi(r_i)$ 的通用有限体积风格的中心差分格式。对于 $i=0$，我们有 $r_0=0$。该格式包含一个 $1/r_0$ 项，这会导致除以零。该公式在 $r=0$ 处是显式奇异的，不能使用。问题的全部目的就是找到一个能够正确表示算子在轴上极限的非奇异格式。此选项代表了将一个通用公式朴素地应用到其无效点上的做法。\n结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在像环体这样的封闭周期性区域上求解泊松方程时，会遇到一个固有的问题：解的非唯一性，因为任意常数都属于拉普拉斯算子的零空间。为了获得唯一的物理可行解，必须施加一个额外的约束。本练习将引导您从变分原理出发，使用拉格朗日乘子法来严格施加解的平均值为零的约束，并推导出相应的鞍点问题系统，这是处理此类约束椭圆问题的先进数值方法的核心。",
            "id": "4024002",
            "problem": "考虑一个环形等离子体域 $\\Omega$，它被建模为一个光滑、闭合的三维流形，具有双周期角坐标 $(\\theta,\\zeta)$ 和一个小半径坐标 $r \\in [0,a]$，其中 $a>0$ 是小半径，大半径 $R_0>0$ 设定了环形几何。设 $\\kappa(\\mathbf{x})>0$ 为一个空间变化的对称标量电导率，并设 $f(\\mathbf{x})$ 为一个给定的源项，满足 $\\int_{\\Omega} f\\, dV = 0$。在磁流体动力学平衡模型中，一个理想导电、闭合环腔内的静电势涨落 $u(\\mathbf{x})$ 由一个环形泊松方程控制。在计算聚变科学与工程中，一个标准的适定性策略是对 $u$ 施加零均值约束，以消除常数函数构成的零空间。\n\n从变分法的第一性原理和流形上椭圆问题的弱形式出发，将 $u$ 的变分问题描述为一个能量泛函的最小化问题，该泛函包含了带源项 $f$ 的环形泊松物理，并受零均值约束 $\\int_{\\Omega} u\\, dV = 0$ 的限制。引入一个拉格朗日乘子来处理该约束，并推导相关的一阶最优性条件。然后，使用一个协调基 $\\{\\phi_i\\}_{i=1}^{N}$（例如，在 $\\zeta$ 和 $\\theta$ 方向上的傅里叶基与 $r$ 方向上的高阶多项式耦合，或一个相容有限元基）对所得的弱形式条件进行离散化，以获得关于系数向量 $\\mathbf{u} \\in \\mathbb{R}^{N}$ 和标量拉格朗日乘子 $\\lambda \\in \\mathbb{R}$ 的代数鞍点系统。您所引入的任何矩阵和向量都必须严格地用基函数及其梯度在 $\\Omega$ 上的积分来定义，并通过体元 $dV$ 体现环形几何。\n\n您的推导必须从椭圆算子的能量原理和拉格朗日乘子的定义开始，不得使用任何关于鞍点系统的现成公式。清晰地阐述零均值约束与环形泊松算子零空间的关系，并解释拉格朗日乘子如何施加此约束。作为最终答案，请根据刚度矩阵、约束耦合向量和拉格朗日乘子块，给出离散鞍点矩阵的显式分块算子表达式，无需写出方程。\n\n最终答案必须是单一的封闭形式解析表达式。不需要进行数值计算。不需要单位。如果您引入缩写词，如有限元法（Finite Element Method, FEM）或离散傅里叶变换（Discrete Fourier Transform, DFT），请在首次使用时给出定义。",
            "solution": "该问题要求从变分法出发，推导带有零均值约束的环形泊松方程的离散鞍点系统。最终答案应为该系统矩阵的分块算子形式。\n\n我们首先验证问题陈述。\n\n**第1步：提取已知条件**\n-   域：一个环形等离子体域 $\\Omega$，一个光滑、闭合的三维流形。\n-   坐标：双周期角坐标 $(\\theta, \\zeta)$ 和一个小半径坐标 $r \\in [0, a]$。\n-   参数：小半径 $a > 0$ 和大半径 $R_0 > 0$。\n-   电导率：一个空间变化的对称标量函数 $\\kappa(\\mathbf{x}) > 0$。\n-   源项：一个给定的源函数 $f(\\mathbf{x})$，满足相容性条件 $\\int_{\\Omega} f \\, dV = 0$。\n-   未知量：静电势涨落 $u(\\mathbf{x})$。\n-   控制物理：一个环形泊松方程，其强形式为 $-\\nabla \\cdot (\\kappa(\\mathbf{x}) \\nabla u) = f(\\mathbf{x})$。\n-   约束：解的均值必须为零，$\\int_{\\Omega} u \\, dV = 0$。\n-   方法论：使用变分法、能量泛函、用于约束的拉格朗日乘子，以及协调基离散化 $\\{\\phi_i\\}_{i=1}^{N}$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定的、客观的。它描述了计算等离子体物理学中一个标准的、具有物理意义的问题。控制方程是一个人们熟知的椭圆型偏微分方程（PDE）。域 $\\Omega$ 是一个闭流形，这意味着算子 $-\\nabla \\cdot (\\kappa \\nabla \\cdot)$ 的零空间由常数函数构成。所提供的源相容性条件 $\\int_{\\Omega} f \\, dV = 0$，是该域上诺伊曼（Neumann）型问题存在解的充分必要条件（根据弗雷德霍姆择一性，Fredholm alternative）。零均值约束 $\\int_{\\Omega} u \\, dV = 0$ 是消除常数函数模糊性的标准技术，从而确保解的唯一性。所提出的方法（使用拉格朗日乘子的变分形式）是解决此类约束优化问题的典型方法。该问题是自洽的、一致的，并为严格推导提供了所有必要信息。\n\n**第3步：结论与行动**\n问题被认定为有效。我们继续进行推导。\n\n静电势 $u(\\mathbf{x})$ 的控制偏微分方程的强形式为：\n$$\n-\\nabla \\cdot (\\kappa(\\mathbf{x}) \\nabla u(\\mathbf{x})) = f(\\mathbf{x}) \\quad \\text{for } \\mathbf{x} \\in \\Omega\n$$\n这是一个椭圆型偏微分方程。该方程的解可以通过最小化一个能量泛函来找到。对于算子 $-\\nabla \\cdot (\\kappa \\nabla \\cdot)$，相应的能量泛函 $J(u)$ 是：\n$$\nJ(u) = \\int_{\\Omega} \\left( \\frac{1}{2} \\kappa(\\mathbf{x}) |\\nabla u(\\mathbf{x})|^2 - f(\\mathbf{x}) u(\\mathbf{x}) \\right) dV\n$$\n在合适的函数空间（例如，索博列夫空间 $H^1(\\Omega)$）上最小化此泛函，可以得到一个作为该偏微分方程弱解的函数 $u$。\n\n然而，由于 $\\Omega$ 是一个没有边界的闭流形，该算子有一个非平凡的零空间。任何常数函数 $u(\\mathbf{x}) = c$ 的梯度为 $\\nabla u = \\mathbf{0}$，因此满足齐次方程 $-\\nabla \\cdot (\\kappa \\nabla c) = 0$。这意味着如果 $u^*$ 是一个解，那么对于任何常数 $c \\in \\mathbb{R}$，$u^*+c$ 也是一个解。这种非唯一性通过施加零均值约束来消除：\n$$\n\\int_{\\Omega} u(\\mathbf{x}) \\, dV = 0\n$$\n为了将此约束纳入最小化问题，我们使用拉格朗日乘子法。我们定义一个拉格朗日泛函 $\\mathcal{L}(u, \\lambda)$，其中 $\\lambda \\in \\mathbb{R}$ 是拉格朗日乘子：\n$$\n\\mathcal{L}(u, \\lambda) = J(u) + \\lambda \\int_{\\Omega} u(\\mathbf{x}) \\, dV = \\int_{\\Omega} \\left( \\frac{1}{2} \\kappa |\\nabla u|^2 - f u \\right) dV + \\lambda \\int_{\\Omega} u \\, dV\n$$\n解 $(u, \\lambda)$ 是该拉格朗日函数的一个鞍点。一阶最优性条件通过将 $\\mathcal{L}$ 关于 $u$ 和 $\\lambda$ 的变分设为零来求得。\n\n首先，我们取 $\\mathcal{L}$ 在同一函数空间中任意测试函数 $v$ 的方向上关于 $u$ 的变分。这就是 Gâteaux 导数 $\\delta_u \\mathcal{L}(u, \\lambda; v) = 0$。\n$$\n\\delta_u \\mathcal{L}(u, \\lambda; v) = \\lim_{\\epsilon \\to 0} \\frac{\\mathcal{L}(u+\\epsilon v, \\lambda) - \\mathcal{L}(u, \\lambda)}{\\epsilon} = 0\n$$\n$$\n\\left. \\frac{d}{d\\epsilon} \\right|_{\\epsilon=0} \\left[ \\int_{\\Omega} \\left( \\frac{1}{2} \\kappa |\\nabla(u+\\epsilon v)|^2 - f(u+\\epsilon v) \\right) dV + \\lambda \\int_{\\Omega} (u+\\epsilon v) dV \\right] = 0\n$$\n展开项 $|\\nabla(u+\\epsilon v)|^2 = |\\nabla u|^2 + 2\\epsilon \\nabla u \\cdot \\nabla v + \\epsilon^2 |\\nabla v|^2$ 并对 $\\epsilon$ 进行微分，得到：\n$$\n\\int_{\\Omega} (\\kappa \\nabla u \\cdot \\nabla v - f v) dV + \\lambda \\int_{\\Omega} v \\, dV = 0\n$$\n整理后，我们得到偏微分方程的弱形式：\n$$\n\\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, dV + \\lambda \\int_{\\Omega} v \\, dV = \\int_{\\Omega} f v \\, dV\n$$\n该方程必须对所有容许的测试函数 $v$ 成立。\n\n其次，我们取 $\\mathcal{L}$ 关于 $\\lambda$ 的变分。这等同于对 $\\lambda$ 求偏导并将其设为零，这就恢复了约束方程：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = \\int_{\\Omega} u \\, dV = 0\n$$\n因此，变分问题是：找到 $(u, \\lambda)$，使得这两个积分方程对所有测试函数 $v$ 都成立。\n\n接下来，我们对问题进行离散化。我们引入一个有限维的协调基 $\\{\\phi_i(\\mathbf{x})\\}_{i=1}^{N}$。我们寻求一个近似解 $u_h(\\mathbf{x})$，其形式为这些基函数的线性组合：\n$$\nu_h(\\mathbf{x}) = \\sum_{j=1}^{N} u_j \\phi_j(\\mathbf{x})\n$$\n其中 $\\mathbf{u} = (u_1, u_2, \\dots, u_N)^T \\in \\mathbb{R}^N$ 是未知系数的向量。\n\n遵循伽辽金（Galerkin）法，我们选择测试函数 $v$ 为基函数本身，即 $v = \\phi_i(\\mathbf{x})$，其中 $i=1, \\dots, N$。将 $u_h$ 的展开式代入第一个弱形式方程，得到一个包含 $N$ 个代数方程的方程组：\n$$\n\\int_{\\Omega} \\kappa \\nabla \\left(\\sum_{j=1}^{N} u_j \\phi_j\\right) \\cdot \\nabla \\phi_i \\, dV + \\lambda \\int_{\\Omega} \\phi_i \\, dV = \\int_{\\Omega} f \\phi_i \\, dV \\quad \\text{for } i=1, \\dots, N\n$$\n根据积分和梯度算子的线性性质，我们可以将其写为：\n$$\n\\sum_{j=1}^{N} \\left(\\int_{\\Omega} \\kappa \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dV\\right) u_j + \\left(\\int_{\\Omega} \\phi_i \\, dV\\right) \\lambda = \\int_{\\Omega} f \\phi_i \\, dV\n$$\n我们定义以下矩阵和向量：\n-   刚度矩阵 $A \\in \\mathbb{R}^{N \\times N}$，其元素为 $A_{ij} = \\int_{\\Omega} \\kappa(\\mathbf{x}) \\nabla \\phi_i(\\mathbf{x}) \\cdot \\nabla \\phi_j(\\mathbf{x}) \\, dV$。由于点积的对称性，$A$ 是一个对称矩阵。\n-   约束耦合向量 $\\mathbf{c} \\in \\mathbb{R}^N$，其元素为 $c_i = \\int_{\\Omega} \\phi_i(\\mathbf{x}) \\, dV$。\n-   载荷向量 $\\mathbf{f} \\in \\mathbb{R}^N$，其元素为 $f_i = \\int_{\\Omega} f(\\mathbf{x}) \\phi_i(\\mathbf{x}) \\, dV$。\n\n使用这些定义，这 $N$ 个方程组变成一个单一的矩阵-向量方程：\n$$\nA \\mathbf{u} + \\mathbf{c} \\lambda = \\mathbf{f}\n$$\n接下来，我们离散化约束方程：\n$$\n\\int_{\\Omega} u_h \\, dV = \\int_{\\Omega} \\left(\\sum_{j=1}^{N} u_j \\phi_j\\right) dV = \\sum_{j=1}^{N} u_j \\left(\\int_{\\Omega} \\phi_j \\, dV\\right) = 0\n$$\n这变为 $\\sum_{j=1}^{N} c_j u_j = 0$，用向量表示法即为：\n$$\n\\mathbf{c}^T \\mathbf{u} = 0\n$$\n我们现在得到了一个关于 $N+1$ 个未知数 $(\\mathbf{u}, \\lambda)$ 的包含 $N+1$ 个线性方程的耦合系统：\n$$\n\\begin{align*}\nA \\mathbf{u} + \\mathbf{c} \\lambda = \\mathbf{f} \\\\\n\\mathbf{c}^T \\mathbf{u} + 0 \\lambda = 0\n\\end{align*}\n$$\n这可以写成分块矩阵（鞍点）形式。未知量被组合成一个单一的向量 $\\begin{pmatrix} \\mathbf{u} \\\\ \\lambda \\end{pmatrix}$，而方程则被合并成一个单一的矩阵系统。最终得到的离散鞍点矩阵是一个作用于此扩展未知向量的 $(N+1) \\times (N+1)$ 矩阵。其分块结构由刚度矩阵 $A$、耦合向量 $\\mathbf{c}$、其转置 $\\mathbf{c}^T$ 以及一个对应于拉格朗日乘子的零块组成。该矩阵即为问题所要求的算子。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nA & \\mathbf{c} \\\\\n\\mathbf{c}^T & 0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}