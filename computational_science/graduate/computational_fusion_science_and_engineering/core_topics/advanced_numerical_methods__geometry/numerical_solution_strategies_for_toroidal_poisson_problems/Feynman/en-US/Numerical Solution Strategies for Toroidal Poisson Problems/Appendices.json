{
    "hands_on_practices": [
        {
            "introduction": "The first step in tackling the complex, three-dimensional toroidal Poisson equation is often to simplify it through analytical techniques. This practice demonstrates a powerful method using Fourier analysis to separate the angular dependencies under the common large-aspect-ratio approximation. By transforming the single 3D partial differential equation into a more manageable set of one-dimensional ordinary differential equations, you will gain fundamental insight into the modal structure of solutions in toroidal geometry .",
            "id": "4024013",
            "problem": "Consider electrostatic potential in a large-aspect-ratio tokamak modeled as a concentric circular torus. Use orthogonal toroidal coordinates $(r,\\theta,\\phi)$, where $r \\in [0,a]$ is the minor radius, $\\theta \\in [0,2\\pi)$ is the poloidal angle, and $\\phi \\in [0,2\\pi)$ is the toroidal angle. Assume circular, concentric magnetic flux surfaces given by $R(r,\\theta) = R_0 + r \\cos\\theta$ and $Z(r,\\theta) = r \\sin\\theta$, where $R_0 \\gg a$ is the major radius and $a$ is the minor radius. The line element is $ds^2 = dr^2 + r^2 d\\theta^2 + (R_0 + r \\cos\\theta)^2 d\\phi^2$. The electrostatic potential $\\Phi(r,\\theta,\\phi)$ satisfies the Poisson equation $- \\nabla^2 \\Phi = S(r,\\theta,\\phi)$ with a smooth, square-integrable, doubly periodic source $S$ in $\\theta$ and $\\phi$. Impose regularity at $r=0$ and a perfectly conducting wall at $r=a$, i.e., $\\Phi(a,\\theta,\\phi)=0$.\n\nStart from the curvilinear coordinate definition of the Laplacian in orthogonal coordinates with scale factors $h_r$, $h_\\theta$, $h_\\phi$,\n$$\n\\nabla^2 \\Phi \\;=\\; \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial r}\\!\\left(\\frac{h_\\theta h_\\phi}{h_r}\\,\\frac{\\partial \\Phi}{\\partial r}\\right)\n\\;+\\; \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\theta}\\!\\left(\\frac{h_r h_\\phi}{h_\\theta}\\,\\frac{\\partial \\Phi}{\\partial \\theta}\\right)\n\\;+\\; \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\phi}\\!\\left(\\frac{h_r h_\\theta}{h_\\phi}\\,\\frac{\\partial \\Phi}{\\partial \\phi}\\right).\n$$\nFor the concentric circular torus, the scale factors are $h_r=1$, $h_\\theta=r$, and $h_\\phi=R_0 + r \\cos\\theta$. Expand $\\Phi$ and $S$ in a double Fourier series in the angles,\n$$\n\\Phi(r,\\theta,\\phi) \\;=\\; \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} R_{mn}(r)\\,\\exp\\!\\big(i m \\theta\\big)\\,\\exp\\!\\big(i n \\phi\\big), \n\\qquad\nS(r,\\theta,\\phi) \\;=\\; \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} S_{mn}(r)\\,\\exp\\!\\big(i m \\theta\\big)\\,\\exp\\!\\big(i n \\phi\\big),\n$$\nand adopt the large-aspect-ratio approximation to leading order in $\\epsilon = a/R_0 \\ll 1$ so that coefficients depending on $\\theta$ in the metric can be replaced by their leading-order constant values in $R_0$. Under this approximation, perform separation of variables, derive the decoupled radial ordinary differential equation for each mode $(m,n)$, and rewrite it in conservative self-adjoint form and in a form divided by $r$ that is convenient for mode-wise numerical discretization on $r \\in [0,a]$.\n\nFinally, identify the effective squared radial wavenumber function $k_{mn}^2(r)$ that multiplies $R_{mn}(r)$ in the equation divided by $r$,\n$$\n-\\,\\frac{1}{r}\\,\\frac{d}{dr}\\!\\left(r\\,\\frac{d R_{mn}}{dr}\\right) \\;+\\; k_{mn}^2(r)\\,R_{mn}(r) \\;=\\; S_{mn}(r),\n$$\nand provide $k_{mn}^2(r)$ as an explicit symbolic function of $r$, $m$, $n$, and $R_0$.\n\nExpress your final answer as the explicit expression for $k_{mn}^2(r)$ with no units. Do not include any intermediate equations in the final answer.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n-   **System**: Electrostatic potential $\\Phi$ in a large-aspect-ratio tokamak.\n-   **Coordinates**: Orthogonal toroidal coordinates $(r,\\theta,\\phi)$ with $r \\in [0,a]$, $\\theta \\in [0,2\\pi)$, $\\phi \\in [0,2\\pi)$.\n-   **Geometry**: $R(r,\\theta) = R_0 + r \\cos\\theta$, $Z(r,\\theta) = r \\sin\\theta$, with major radius $R_0 \\gg a$, the minor radius.\n-   **Line element**: $ds^2 = dr^2 + r^2 d\\theta^2 + (R_0 + r \\cos\\theta)^2 d\\phi^2$.\n-   **Scale factors**: $h_r=1$, $h_\\theta=r$, $h_\\phi=R_0 + r \\cos\\theta$.\n-   **Governing equation**: $-\\nabla^2 \\Phi = S(r,\\theta,\\phi)$, where $S$ is a smooth, square-integrable, doubly periodic source.\n-   **Boundary conditions**: Regularity at $r=0$ and $\\Phi(a,\\theta,\\phi)=0$.\n-   **Laplacian form**: $\\nabla^2 \\Phi = \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial r}\\!\\left(\\frac{h_\\theta h_\\phi}{h_r}\\,\\frac{\\partial \\Phi}{\\partial r}\\right) + \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\theta}\\!\\left(\\frac{h_r h_\\phi}{h_\\theta}\\,\\frac{\\partial \\Phi}{\\partial \\theta}\\right) + \\frac{1}{h_r h_\\theta h_\\phi}\\,\\frac{\\partial}{\\partial \\phi}\\!\\left(\\frac{h_r h_\\theta}{h_\\phi}\\,\\frac{\\partial \\Phi}{\\partial \\phi}\\right)$.\n-   **Fourier expansions**: $\\Phi(r,\\theta,\\phi) = \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} R_{mn}(r)\\,\\exp(i m \\theta)\\,\\exp(i n \\phi)$ and $S(r,\\theta,\\phi) = \\sum_{m\\in\\mathbb{Z}} \\sum_{n\\in\\mathbb{Z}} S_{mn}(r)\\,\\exp(i m \\theta)\\,\\exp(i n \\phi)$.\n-   **Approximation**: \"adopt the large-aspect-ratio approximation to leading order in $\\epsilon = a/R_0 \\ll 1$ so that coefficients depending on $\\theta$ in the metric can be replaced by their leading-order constant values in $R_0$.\"\n-   **Final Goal**: Find the function $k_{mn}^2(r)$ in the radial ODE: $-\\,\\frac{1}{r}\\,\\frac{d}{dr}\\!\\left(r\\,\\frac{d R_{mn}}{dr}\\right) + k_{mn}^2(r)\\,R_{mn}(r) = S_{mn}(r)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the standard mathematical physics of plasma confinement in a tokamak. The use of a simplified toroidal coordinate system, Poisson's equation, Fourier analysis, and the large-aspect-ratio approximation are all standard, well-established methods in this field. The problem is well-posed, providing a clear governing equation, boundary conditions, and a specific, well-defined approximation scheme. All necessary information is provided, and there are no internal contradictions. The task is a non-trivial but standard derivation in computational physics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A rigorous solution will be derived.\n\nThe solution proceeds by first applying the specified approximation to the Laplacian operator, then performing a separation of variables using the provided Fourier series, and finally rearranging the resulting ordinary differential equation to identify the requested term.\n\nThe scale factors for the given toroidal coordinate system are $h_r=1$, $h_\\theta=r$, and $h_\\phi = R_0 + r \\cos\\theta$. The volume element is $J = h_r h_\\theta h_\\phi = r(R_0 + r \\cos\\theta)$. The Laplacian operator is given by:\n$$\n\\nabla^2 \\Phi = \\frac{1}{r(R_0 + r \\cos\\theta)} \\left[ \\frac{\\partial}{\\partial r}\\left( r(R_0 + r \\cos\\theta) \\frac{\\partial\\Phi}{\\partial r} \\right) + \\frac{\\partial}{\\partial \\theta}\\left( \\frac{R_0 + r \\cos\\theta}{r} \\frac{\\partial\\Phi}{\\partial \\theta} \\right) + \\frac{\\partial}{\\partial \\phi}\\left( \\frac{r}{R_0 + r \\cos\\theta} \\frac{\\partial\\Phi}{\\partial \\phi} \\right) \\right]\n$$\nThe problem specifies the large-aspect-ratio approximation, where \"coefficients depending on $\\theta$ in the metric can be replaced by their leading-order constant values in $R_0$.\" The only such coefficient is the scale factor $h_\\phi$, which depends on $\\theta$. Since $r \\le a$ and $a/R_0 \\ll 1$, we have $r/R_0 \\ll 1$. The leading-order constant value of $h_\\phi = R_0 + r \\cos\\theta$ is $R_0$.\nWe therefore substitute $R_0 + r \\cos\\theta \\approx R_0$ into the coefficients of the Laplacian operator. This simplification is crucial as it removes the explicit $\\theta$-dependence from the metric components, which in turn allows for the decoupling of the Fourier modes.\n\nThe approximated Laplacian, denoted $\\nabla_{approx}^2$, becomes:\n$$\n\\nabla_{approx}^2 \\Phi = \\frac{1}{r R_0} \\left[ \\frac{\\partial}{\\partial r}\\left( r R_0 \\frac{\\partial\\Phi}{\\partial r} \\right) + \\frac{\\partial}{\\partial \\theta}\\left( \\frac{R_0}{r} \\frac{\\partial\\Phi}{\\partial \\theta} \\right) + \\frac{\\partial}{\\partial \\phi}\\left( \\frac{r}{R_0} \\frac{\\partial\\Phi}{\\partial \\phi} \\right) \\right]\n$$\nThe term $R_0$ in the first two numerators within the brackets cancels with the $R_0$ in the overall prefactor:\n$$\n\\nabla_{approx}^2 \\Phi = \\frac{1}{r} \\frac{\\partial}{\\partial r}\\left( r \\frac{\\partial\\Phi}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2\\Phi}{\\partial \\theta^2} + \\frac{1}{R_0^2} \\frac{\\partial^2\\Phi}{\\partial \\phi^2}\n$$\nThis is the Laplacian in cylindrical coordinates $(r, \\theta, z)$ where the coordinate $z$ is replaced by the arc-length coordinate $R_0\\phi$.\n\nNow, we substitute the Fourier series expansions for $\\Phi$ and $S$ into the Poisson equation, $-\\nabla_{approx}^2 \\Phi = S$:\n$$\n-\\sum_{m,n} \\left[ \\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) + \\frac{1}{r^2} (im)^2 R_{mn}(r) + \\frac{1}{R_0^2} (in)^2 R_{mn}(r) \\right] e^{im\\theta} e^{in\\phi} = \\sum_{m,n} S_{mn}(r) e^{im\\theta} e^{in\\phi}\n$$\nThe angular derivatives have been replaced by their corresponding actions on the Fourier modes: $\\frac{\\partial^2}{\\partial \\theta^2} \\to -m^2$ and $\\frac{\\partial^2}{\\partial \\phi^2} \\to -n^2$.\n\nThe basis functions $e^{im\\theta} e^{in\\phi}$ are orthogonal. Thus, we can equate the coefficients for each mode $(m, n)$ independently:\n$$\n-\\left[ \\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) - \\frac{m^2}{r^2} R_{mn}(r) - \\frac{n^2}{R_0^2} R_{mn}(r) \\right] = S_{mn}(r)\n$$\nDistributing the negative sign on the left-hand side, we obtain the decoupled radial ordinary differential equation for the mode amplitude $R_{mn}(r)$:\n$$\n-\\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) + \\frac{m^2}{r^2} R_{mn}(r) + \\frac{n^2}{R_0^2} R_{mn}(r) = S_{mn}(r)\n$$\nThis equation can be written in the \"conservative self-adjoint form\" by multiplying by $r$:\n$$\n-\\frac{d}{dr}\\left(r\\,\\frac{d R_{mn}}{dr}\\right) + \\left(\\frac{m^2}{r} + \\frac{n^2 r}{R_0^2}\\right) R_{mn}(r) = rS_{mn}(r)\n$$\nThe problem, however, asks to identify the term $k_{mn}^2(r)$ from the form \"divided by $r$\":\n$$\n-\\frac{1}{r}\\,\\frac{d}{dr}\\!\\left(r\\,\\frac{d R_{mn}}{dr}\\right) + k_{mn}^2(r)\\,R_{mn}(r) = S_{mn}(r)\n$$\nBy combining the terms multiplying $R_{mn}(r)$ in our derived equation, we have:\n$$\n-\\frac{1}{r} \\frac{d}{dr}\\left( r \\frac{d R_{mn}}{dr} \\right) + \\left( \\frac{m^2}{r^2} + \\frac{n^2}{R_0^2} \\right) R_{mn}(r) = S_{mn}(r)\n$$\nDirect comparison of this equation with the target form reveals the expression for the effective squared radial wavenumber $k_{mn}^2(r)$. This term comprises the poloidal contribution, which is dependent on the minor radius $r$, and the toroidal contribution, which is constant with respect to $r$ in this approximation.\n$$\nk_{mn}^2(r) = \\frac{m^2}{r^2} + \\frac{n^2}{R_0^2}\n$$",
            "answer": "$$\n\\boxed{\\frac{m^2}{r^2} + \\frac{n^2}{R_0^2}}\n$$"
        },
        {
            "introduction": "After reducing the problem to a set of radial ordinary differential equations, the next challenge is constructing a valid numerical discretization. This exercise focuses on a critical and common difficulty: the coordinate singularity that appears at the magnetic axis ($r=0$) in cylindrical and toroidal systems. You will learn to derive a stable and accurate numerical stencil by correctly handling the analytical limit of the operator at the origin, a vital skill for building robust solvers for axisymmetric or near-axisymmetric problems .",
            "id": "4023945",
            "problem": "In computational fusion science and engineering, toroidal configurations such as a tokamak admit a magnetic axis around which flux surfaces are approximately circular in a local poloidal cross-section. Consider the electrostatic Poisson equation for a smooth axisymmetric potential $\\,\\phi\\,$ in the poloidal plane near the magnetic axis, written in polar coordinates $\\,r\\,$ and $\\,\\theta\\,$ as\n$$\n\\nabla^2 \\phi \\;=\\; \\frac{1}{r}\\,\\frac{\\partial}{\\partial r}\\!\\left(r\\,\\frac{\\partial \\phi}{\\partial r}\\right) \\;+\\; \\frac{1}{r^2}\\,\\frac{\\partial^2 \\phi}{\\partial \\theta^2} \\;=\\; s(r)\\,,\n$$\nwhere $\\,s(r)\\,$ is a given smooth source. For the axisymmetric case near the magnetic axis, assume $\\,\\partial \\phi/\\partial \\theta = 0\\,$ and $\\,\\partial^2 \\phi/\\partial \\theta^2 = 0\\,$, so the operator reduces to\n$$\n\\mathcal{L}\\phi(r) \\;=\\; \\frac{1}{r}\\,\\frac{\\partial}{\\partial r}\\!\\left(r\\,\\frac{\\partial \\phi}{\\partial r}\\right)\\,.\n$$\nLet a uniform radial grid be defined by $\\,r_i = i\\,\\Delta r\\,$ for integers $\\,i \\ge 0\\,$, with $\\,\\phi_i = \\phi(r_i)\\,$. At the magnetic axis $\\,r_0 = 0\\,$, the coordinate factor $\\,1/r\\,$ is singular, and a consistent discretization must be constructed that respects the regularity of smooth axisymmetric fields, specifically $\\,\\partial \\phi/\\partial r\\big|_{r=0} = 0\\,$, and maintains accuracy of order $\\,2\\,$.\n\nStarting from the fundamental definition of the Laplacian in polar coordinates and the regularity of smooth axisymmetric solutions at $\\,r=0\\,$, which of the following discrete stencils for $\\,\\mathcal{L}\\phi\\,$ at the axis node $\\,i=0\\,$ avoids the coordinate singularity and achieves second-order accuracy? Assume a mirrored ghost value $\\,\\phi_{-1} = \\phi_1\\,$ to enforce $\\,\\partial \\phi/\\partial r\\big|_{r=0} = 0\\,$ when needed.\n\nA. $\\,\\mathcal{L}\\phi\\big|_{i=0} \\;=\\; \\dfrac{4\\,(\\phi_1 - \\phi_0)}{\\Delta r^2}\\,$.\n\nB. $\\,\\mathcal{L}\\phi\\big|_{i=0} \\;=\\; \\dfrac{\\phi_1 - 2\\,\\phi_0 + \\phi_{-1}}{\\Delta r^2}\\,$.\n\nC. $\\,\\mathcal{L}\\phi\\big|_{i=0} \\;=\\; \\dfrac{\\phi_1 - \\phi_0}{\\Delta r^2}\\,$.\n\nD. $\\,\\mathcal{L}\\phi\\big|_{i=0} \\;=\\; \\dfrac{1}{r_0}\\,\\dfrac{1}{\\Delta r}\\left[r_{1/2}\\,\\dfrac{\\phi_1 - \\phi_0}{\\Delta r} - r_{-1/2}\\,\\dfrac{\\phi_0 - \\phi_{-1}}{\\Delta r}\\right]\\,$ with $\\,r_{\\pm 1/2} = r_0 \\pm \\dfrac{\\Delta r}{2}\\,$.",
            "solution": "### Step 1: Extract Givens\n- **Governing Equation**: The axisymmetric Poisson equation in polar coordinates $(r, \\theta)$ is given by $\\nabla^2 \\phi = s(r)$.\n- **Operator Definition**: The Laplacian operator for an axisymmetric potential $\\phi(r)$ is $\\mathcal{L}\\phi(r) = \\frac{1}{r}\\,\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial \\phi}{\\partial r}\\right)$.\n- **Grid**: A uniform radial grid is defined by $r_i = i\\,\\Delta r$ for integers $i \\ge 0$. The potential at grid points is denoted by $\\phi_i = \\phi(r_i)$.\n- **Point of Interest**: The discretization is required at the magnetic axis, $r_0 = 0$.\n- **Singularity**: The operator $\\mathcal{L}$ has a coordinate singularity at $r_0=0$ due to the $1/r$ factor.\n- **Regularity Condition**: For a smooth axisymmetric solution, the radial derivative of the potential must be zero at the axis: $\\frac{\\partial \\phi}{\\partial r}\\big|_{r=0} = 0$.\n- **Ghost Point Condition**: A mirrored ghost value $\\phi_{-1} = \\phi_1$ is assumed to be available to enforce the regularity condition.\n- **Requirement**: The discrete stencil for $\\mathcal{L}\\phi$ at $i=0$ must avoid the singularity, be consistent, and achieve second-order accuracy, i.e., the truncation error must be $O(\\Delta r^2)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically and mathematically sound. It presents a standard challenge in the numerical solution of partial differential equations in non-Cartesian coordinate systems, specifically the treatment of coordinate singularities. The governing equation, the operator, the boundary/regularity conditions, and the requirements for the numerical stencil are all clearly and correctly defined. The problem is well-posed, objective, and resides firmly within the domain of computational physics and numerical analysis. It is not self-contradictory, incomplete, or trivial. Therefore, the problem is valid.\n\n### Step 3: Derivation of the Correct Stencil\nThe operator is given by $\\mathcal{L}\\phi(r) = \\frac{1}{r}\\,\\frac{\\partial}{\\partial r}\\left(r\\,\\frac{\\partial \\phi}{\\partial r}\\right)$. Expanding the derivative, we have:\n$$ \\mathcal{L}\\phi(r) = \\frac{1}{r} \\left( \\frac{\\partial \\phi}{\\partial r} + r\\,\\frac{\\partial^2 \\phi}{\\partial r^2} \\right) = \\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r} + \\frac{\\partial^2 \\phi}{\\partial r^2} $$\nWe need to evaluate this expression at $r=0$. At this point, the term $\\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r}$ is an indeterminate form of type $0/0$, because the regularity condition for a smooth axisymmetric solution is $\\frac{\\partial \\phi}{\\partial r}\\big|_{r=0} = 0$. To resolve this indeterminate form, we apply L'HÃ´pital's rule:\n$$ \\lim_{r \\to 0} \\left( \\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r} \\right) = \\lim_{r \\to 0} \\frac{\\frac{\\partial}{\\partial r}\\left(\\frac{\\partial \\phi}{\\partial r}\\right)}{\\frac{\\partial}{\\partial r}(r)} = \\lim_{r \\to 0} \\frac{\\frac{\\partial^2 \\phi}{\\partial r^2}}{1} = \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} $$\nSubstituting this result back into the expression for the operator at $r=0$:\n$$ \\mathcal{L}\\phi\\big|_{r=0} = \\left( \\frac{1}{r}\\,\\frac{\\partial \\phi}{\\partial r} \\right)\\bigg|_{r=0} + \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} = \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} + \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} = 2\\,\\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} $$\nThis is the exact, non-singular form of the operator at the axis. The task now is to find a second-order accurate finite-difference approximation for $\\frac{\\partial^2 \\phi}{\\partial r^2}\\big|_{r=0}$.\n\nThe standard second-order central difference approximation for the second derivative of $\\phi$ at $r_0=0$ is:\n$$ \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} \\approx \\frac{\\phi(r_0 + \\Delta r) - 2\\phi(r_0) + \\phi(r_0 - \\Delta r)}{\\Delta r^2} = \\frac{\\phi_1 - 2\\phi_0 + \\phi_{-1}}{\\Delta r^2} $$\nThe problem provides the condition that a mirrored ghost value $\\phi_{-1} = \\phi_1$ can be used. This condition is a discrete enforcement of the regularity condition $\\frac{\\partial \\phi}{\\partial r}\\big|_{r=0} = 0$, since a central difference approximation of the first derivative is $\\frac{\\phi_1 - \\phi_{-1}}{2\\Delta r} = 0$, which implies $\\phi_1 = \\phi_{-1}$.\n\nSubstituting $\\phi_{-1} = \\phi_1$ into the approximation for the second derivative:\n$$ \\frac{\\partial^2 \\phi}{\\partial r^2}\\bigg|_{r=0} \\approx \\frac{\\phi_1 - 2\\phi_0 + \\phi_1}{\\Delta r^2} = \\frac{2\\phi_1 - 2\\phi_0}{\\Delta r^2} = \\frac{2(\\phi_1 - \\phi_0)}{\\Delta r^2} $$\nFinally, we substitute this approximation back into our expression for the operator at the axis:\n$$ \\mathcal{L}\\phi\\big|_{r=0} \\approx 2 \\left( \\frac{2(\\phi_1 - \\phi_0)}{\\Delta r^2} \\right) = \\frac{4(\\phi_1 - \\phi_0)}{\\Delta r^2} $$\n\nTo confirm the second-order accuracy, we use Taylor series expansions. For a smooth, axisymmetric function, the expansion of $\\phi(r)$ around $r=0$ contains only even powers of $r$:\n$$ \\phi(r) = \\phi(0) + \\frac{\\phi''(0)}{2!}r^2 + \\frac{\\phi''''(0)}{4!}r^4 + O(r^6) $$\nLet $\\phi_0 = \\phi(0)$ and $\\phi_1 = \\phi(\\Delta r)$. Then:\n$$ \\phi_1 = \\phi_0 + \\frac{\\phi''(0)}{2}\\Delta r^2 + \\frac{\\phi''''(0)}{24}\\Delta r^4 + O(\\Delta r^6) $$\nThe proposed discrete operator is:\n$$ \\frac{4(\\phi_1 - \\phi_0)}{\\Delta r^2} = \\frac{4}{\\Delta r^2} \\left[ \\frac{\\phi''(0)}{2}\\Delta r^2 + \\frac{\\phi''''(0)}{24}\\Delta r^4 + O(\\Delta r^6) \\right] = 2\\phi''(0) + \\frac{\\phi''''(0)}{6}\\Delta r^2 + O(\\Delta r^4) $$\nThe exact operator is $\\mathcal{L}\\phi\\big|_{r=0} = 2\\phi''(0)$. The truncation error is the difference between the discrete and exact operators:\n$$ \\text{Error} = \\left( 2\\phi''(0) + \\frac{\\phi''''(0)}{6}\\Delta r^2 + \\dots \\right) - 2\\phi''(0) = \\frac{\\phi''''(0)}{6}\\Delta r^2 + O(\\Delta r^4) $$\nThe error is proportional to $\\Delta r^2$, confirming that the stencil is second-order accurate.\n\n### Evaluation of Options\n\n**A. $\\,\\mathcal{L}\\phi\\big|_{i=0} \\;=\\; \\dfrac{4\\,(\\phi_1 - \\phi_0)}{\\Delta r^2}\\,$**\nThis expression matches our derived stencil. The derivation shows that it correctly handles the singularity by evaluating the analytical limit of the operator at $r=0$ and then applies a second-order accurate finite difference approximation consistent with the regularity condition.\nVerdict: **Correct**.\n\n**B. $\\,\\mathcal{L}\\phi\\big|_{i=0} \\;=\\; \\dfrac{\\phi_1 - 2\\,\\phi_0 + \\phi_{-1}}{\\Delta r^2}\\,$**\nThis is the standard central difference approximation for the second derivative, $\\frac{\\partial^2 \\phi}{\\partial r^2}\\big|_{r=0}$. However, our analysis showed that $\\mathcal{L}\\phi\\big|_{r=0} = 2\\,\\frac{\\partial^2 \\phi}{\\partial r^2}\\big|_{r=0}$. This stencil is therefore missing a factor of $2$. Using the ghost point condition $\\phi_{-1}=\\phi_1$, this becomes $\\frac{2(\\phi_1 - \\phi_0)}{\\Delta r^2}$, which still differs from the correct result by a factor of $2$.\nVerdict: **Incorrect**.\n\n**C. $\\,\\mathcal{L}\\phi\\big|_{i=0} \\;=\\; \\dfrac{\\phi_1 - \\phi_0}{\\Delta r^2}\\,$**\nThis stencil is a factor of $4$ smaller than the correct result. Its leading-order behavior, as determined by Taylor series, would approximate $\\frac{1}{2}\\phi''(0)$, whereas the correct value is $2\\phi''(0)$. The discrepancy does not vanish as $\\Delta r \\to 0$, so the stencil is not consistent (i.e., it has an $O(1)$ error and is not even zeroth-order accurate).\nVerdict: **Incorrect**.\n\n**D. $\\,\\mathcal{L}\\phi\\big|_{i=0} \\;=\\; \\dfrac{1}{r_0}\\,\\dfrac{1}{\\Delta r}\\left[r_{1/2}\\,\\dfrac{\\phi_1 - \\phi_0}{\\Delta r} - r_{-1/2}\\,\\dfrac{\\phi_0 - \\phi_{-1}}{\\Delta r}\\right]\\,$ with $\\,r_{\\pm 1/2} = r_0 \\pm \\dfrac{\\Delta r}{2}\\,$**\nThis is the general finite-volume-style central difference stencil for the operator $\\mathcal{L}\\phi(r_i)$. For $i=0$, we have $r_0=0$. The stencil contains a $1/r_0$ term, which results in a division by zero. This formula is explicitly singular at $r=0$ and cannot be used. The entire purpose of the problem is to find a non-singular stencil that correctly represents the limit of the operator at the axis. This option represents a naive application of a general formula to a point where it is invalid.\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once the problem is fully discretized, we are left with a large system of linear equations, often represented as $K u = f$. This practice explores the crucial final step: solving the system and guaranteeing the quality of the numerical solution. You will investigate the relationship between the residual, which iterative solvers monitor, and the true error in the energy norm, providing practical insight into how to set a rigorous stopping criterion for a simulation to ensure the result meets a desired accuracy threshold .",
            "id": "4023942",
            "problem": "Consider the toroidal Poisson problem for an electrostatic potential $\\,\\phi\\,$ on a circular tokamak of major radius $\\,R_0\\,$ and minor radius $\\,a\\,$, modeled by the constant-conductivity operator $\\,\\nabla \\cdot (\\kappa \\nabla \\phi)=s\\,$ with $\\,\\kappa=1\\,$, in straight-field-line flux coordinates $\\,(\\rho,\\theta,\\zeta)\\,$, where $\\,\\rho\\in[0,1]\\,$ is a normalized minor radius, $\\,\\theta\\,$ is the poloidal angle, and $\\,\\zeta\\,$ is the toroidal angle. After Fourier decomposition in $\\,\\theta\\,$ and $\\,\\zeta\\,$ for a single $(m,n)$ mode and a Galerkin projection in $\\,\\rho\\,$ using three $\\,H^{1}\\,$-conforming, piecewise-linear basis functions, the weak form yields a symmetric positive definite linear system $\\,K u = f\\,$. For this $(m,n)$ block, suppose the stiffness matrix $\\,K\\,$ and the load vector $\\,f\\,$ are\n$$\nK \\;=\\;\n\\begin{pmatrix}\n6  -1  0 \\\\\n-1  6  -1 \\\\\n0  -1  6\n\\end{pmatrix},\n\\qquad\nf \\;=\\;\n\\begin{pmatrix}\n1 \\\\\n1 \\\\\n1\n\\end{pmatrix}.\n$$\nA numerical iterative solver such as Conjugate Gradient (CG) currently holds an iterate $\\,u_h^{(k)}\\,$. The total residual is defined by $\\,r^{(k)} = f - K u_h^{(k)}\\,$, with the Euclidean norm $\\,\\|r^{(k)}\\|_{2}\\,$ used by the solver. The energy norm of the error is defined by $\\,\\|e^{(k)}\\|_{E}=\\sqrt{\\int_{\\Omega} |\\nabla(\\phi-\\phi_h^{(k)})|^{2}\\,dV}\\,$, which, for the discrete system, coincides with $\\,\\|e^{(k)}\\|_{E}=\\sqrt{(e^{(k)})^{\\top} K\\, e^{(k)}}\\,$ where $\\,e^{(k)}=u-u_h^{(k)}\\,$.\n\nAssume that the current iterate is $\\,u_h^{(k)}=\\begin{pmatrix}0 \\\\ 0 \\\\ 0\\end{pmatrix}\\,$. Perform the following:\n\n1. Compute the total residual $\\,r^{(k)}\\,$ and its Euclidean norm $\\,\\|r^{(k)}\\|_{2}\\,$.\n2. Compute the energy norm of the error $\\,\\|e^{(k)}\\|_{E}\\,$ using only quantities available from the discrete system and the current residual.\n3. Using the spectral characterization of symmetric positive definite matrices, derive a rigorous inequality that relates $\\,\\|e^{(k)}\\|_{E}\\,$ to $\\,\\|r^{(k)}\\|_{2}\\,$ and the smallest eigenvalue of $\\,K\\,$, denoted $\\,\\lambda_{\\min}(K)\\,$.\n4. The solver applies an absolute stopping criterion of the form $\\,\\|r^{(k)}\\|_{2} \\le \\varepsilon_{\\text{stop}}\\,$. Determine the minimal absolute residual tolerance $\\,\\varepsilon_{\\text{stop}}\\,$ that guarantees $\\,\\|e^{(k)}\\|_{E} \\le \\tau_{E}\\,$ with $\\,\\tau_{E} = 5 \\times 10^{-2}\\,$.\n\nRound your final numerical stopping tolerance to four significant figures and express it as a dimensionless quantity.",
            "solution": "The problem statement is critically validated as follows.\n\n**Step 1: Extracted Givens**\n-   The linear system is $K u = f$, where $K$ is a symmetric positive definite (SPD) matrix and $f$ is a load vector.\n-   Stiffness matrix: $K = \\begin{pmatrix} 6  -1  0 \\\\ -1  6  -1 \\\\ 0  -1  6 \\end{pmatrix}$.\n-   Load vector: $f = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$.\n-   Current iterate: $u_h^{(k)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$.\n-   Residual definition: $r^{(k)} = f - K u_h^{(k)}$.\n-   Residual norm: Euclidean norm, $\\|r^{(k)}\\|_{2}$.\n-   Error definition: $e^{(k)} = u - u_h^{(k)}$, where $K u = f$.\n-   Error norm (energy norm): $\\|e^{(k)}\\|_{E} = \\sqrt{(e^{(k)})^{\\top} K e^{(k)}}$.\n-   Target error tolerance: $\\tau_{E} = 5 \\times 10^{-2}$.\n-   Stopping criterion form: $\\|r^{(k)}\\|_{2} \\le \\varepsilon_{\\text{stop}}$.\n\n**Step 2: Validation of Givens**\n-   **Scientific Grounding**: The problem is well-grounded in the field of numerical analysis, specifically the study of iterative solvers for linear systems arising from the finite element discretization of partial differential equations (the Poisson problem). The concepts of residual, error, norms, and eigenvalues are central to this field. The physical context of computational fusion science is appropriate.\n-   **Well-Posedness**: The problem states that $K$ is symmetric positive definite. This can be verified. $K$ is obviously symmetric. The leading principal minors of $K$ are:\n    -   $|6| = 6  0$\n    -   $\\det \\begin{pmatrix} 6  -1 \\\\ -1  6 \\end{pmatrix} = (6)(6) - (-1)(-1) = 36 - 1 = 35  0$\n    -   $\\det(K) = 6(35) - (-1)((-1)(6) - (-1)(0)) = 210 - 6 = 204  0$\n    Since all leading principal minors are positive, $K$ is indeed positive definite. This ensures a unique solution $u=K^{-1}f$ exists, making the problem well-posed.\n-   **Objectivity and Completeness**: The problem is stated objectively with precise mathematical definitions and provides all necessary data to perform the required tasks.\n\n**Step 3: Verdict**\nThe problem is valid. A solution will be furnished.\n\n**Solution Derivation**\n\n**Part 1: Compute the residual and its Euclidean norm**\n\nThe residual at iteration $k$ is defined as $r^{(k)} = f - K u_h^{(k)}$.\nGiven the current iterate $u_h^{(k)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$, the matrix $K$, and the vector $f$, we have:\n$$\nr^{(k)} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 6  -1  0 \\\\ -1  6  -1 \\\\ 0  -1  6 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\nThe Euclidean norm of the residual, $\\|r^{(k)}\\|_{2}$, is calculated as:\n$$\n\\|r^{(k)}\\|_{2} = \\sqrt{1^{2} + 1^{2} + 1^{2}} = \\sqrt{3}\n$$\n\n**Part 2: Compute the energy norm of the error**\n\nThe energy norm of the error $e^{(k)} = u - u_h^{(k)}$ is defined as $\\|e^{(k)}\\|_{E} = \\sqrt{(e^{(k)})^{\\top} K e^{(k)}}$.\nWe can relate the error $e^{(k)}$ to the residual $r^{(k)}$. By definition, the exact solution $u$ satisfies $K u = f$.\n$$\nr^{(k)} = f - K u_h^{(k)} = K u - K u_h^{(k)} = K (u - u_h^{(k)}) = K e^{(k)}\n$$\nSince $K$ is SPD, it is invertible, so we can write the error as $e^{(k)} = K^{-1} r^{(k)}$.\nSubstituting this into the definition of the energy norm squared:\n$$\n\\|e^{(k)}\\|_E^2 = (e^{(k)})^{\\top} K e^{(k)} = (K^{-1} r^{(k)})^{\\top} K (K^{-1} r^{(k)})\n$$\nSince $K$ is symmetric, $(K^{-1})^{\\top} = (K^{\\top})^{-1} = K^{-1}$.\n$$\n\\|e^{(k)}\\|_E^2 = (r^{(k)})^{\\top} (K^{-1})^{\\top} K K^{-1} r^{(k)} = (r^{(k)})^{\\top} K^{-1} K K^{-1} r^{(k)} = (r^{(k)})^{\\top} K^{-1} r^{(k)}\n$$\nTo compute this, we need the inverse of $K$. The determinant of $K$ is $\\det(K) = 204$. The inverse is $K^{-1} = \\frac{1}{\\det(K)} \\text{adj}(K)$. The adjugate matrix is the transpose of the cofactor matrix.\n$$\n\\text{adj}(K) = \\begin{pmatrix} 35  6  1 \\\\ 6  36  6 \\\\ 1  6  35 \\end{pmatrix}\n$$\nSo, the inverse is:\n$$\nK^{-1} = \\frac{1}{204} \\begin{pmatrix} 35  6  1 \\\\ 6  36  6 \\\\ 1  6  35 \\end{pmatrix}\n$$\nNow we compute $\\|e^{(k)}\\|_E^2$ with $r^{(k)} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$:\n$$\n\\|e^{(k)}\\|_E^2 = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\frac{1}{204} \\begin{pmatrix} 35  6  1 \\\\ 6  36  6 \\\\ 1  6  35 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{204} \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} 35+6+1 \\\\ 6+36+6 \\\\ 1+6+35 \\end{pmatrix}\n$$\n$$\n\\|e^{(k)}\\|_E^2 = \\frac{1}{204} \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} 42 \\\\ 48 \\\\ 42 \\end{pmatrix} = \\frac{1}{204} (42 + 48 + 42) = \\frac{132}{204} = \\frac{11}{17}\n$$\nTherefore, the energy norm of the error is:\n$$\n\\|e^{(k)}\\|_{E} = \\sqrt{\\frac{11}{17}}\n$$\n\n**Part 3: Derive the inequality relating the norms**\n\nWe wish to derive an inequality relating $\\|e^{(k)}\\|_{E}$ to $\\|r^{(k)}\\|_{2}$ and $\\lambda_{\\min}(K)$, the smallest eigenvalue of $K$.\nWe utilize the expression for the energy norm squared derived in Part 2: $\\|e^{(k)}\\|_{E}^2 = (r^{(k)})^{\\top} K^{-1} r^{(k)}$.\nFor any real symmetric matrix $A$ and any non-zero vector $x$, the Rayleigh-Ritz quotient $\\frac{x^{\\top} A x}{x^{\\top} x}$ is bounded by the eigenvalues of $A$. Specifically, $\\lambda_{\\min}(A) \\le \\frac{x^{\\top} A x}{x^{\\top} x} \\le \\lambda_{\\max}(A)$.\nWe apply this theorem to the symmetric matrix $K^{-1}$ and the vector $r^{(k)}$:\n$$\n\\frac{(r^{(k)})^{\\top} K^{-1} r^{(k)}}{(r^{(k)})^{\\top} r^{(k)}} \\le \\lambda_{\\max}(K^{-1})\n$$\nThe eigenvalues of $K^{-1}$ are the reciprocals of the eigenvalues of $K$. Since all eigenvalues of the SPD matrix $K$ are positive, the largest eigenvalue of $K^{-1}$ corresponds to the reciprocal of the smallest eigenvalue of $K$:\n$$\n\\lambda_{\\max}(K^{-1}) = \\frac{1}{\\lambda_{\\min}(K)}\n$$\nSubstituting the norm definitions, $\\|e^{(k)}\\|_{E}^2 = (r^{(k)})^{\\top} K^{-1} r^{(k)}$ and $\\|r^{(k)}\\|_{2}^2 = (r^{(k)})^{\\top} r^{(k)}$, into the Rayleigh quotient inequality, we get:\n$$\n\\frac{\\|e^{(k)}\\|_{E}^2}{\\|r^{(k)}\\|_{2}^2} \\le \\frac{1}{\\lambda_{\\min}(K)}\n$$\nRearranging gives the inequality for the squared norms:\n$$\n\\|e^{(k)}\\|_{E}^2 \\le \\frac{1}{\\lambda_{\\min}(K)} \\|r^{(k)}\\|_{2}^2\n$$\nTaking the square root of both sides (all quantities are non-negative) yields the desired inequality:\n$$\n\\|e^{(k)}\\|_{E} \\le \\frac{1}{\\sqrt{\\lambda_{\\min}(K)}} \\|r^{(k)}\\|_{2}\n$$\n\n**Part 4: Determine the stopping tolerance**\n\nWe need to find the minimal absolute residual tolerance $\\varepsilon_{\\text{stop}}$ such that if $\\|r^{(k)}\\|_{2} \\le \\varepsilon_{\\text{stop}}$, it is guaranteed that $\\|e^{(k)}\\|_{E} \\le \\tau_{E}$, where $\\tau_{E} = 5 \\times 10^{-2}$.\nUsing the inequality from Part 3:\n$$\n\\|e^{(k)}\\|_{E} \\le \\frac{\\|r^{(k)}\\|_{2}}{\\sqrt{\\lambda_{\\min}(K)}}\n$$\nIf we enforce the condition $\\|r^{(k)}\\|_{2} \\le \\varepsilon_{\\text{stop}}$, the upper bound on the energy norm of the error becomes:\n$$\n\\|e^{(k)}\\|_{E} \\le \\frac{\\varepsilon_{\\text{stop}}}{\\sqrt{\\lambda_{\\min}(K)}}\n$$\nTo guarantee that $\\|e^{(k)}\\|_{E} \\le \\tau_{E}$, we must require that this upper bound is itself less than or equal to $\\tau_{E}$:\n$$\n\\frac{\\varepsilon_{\\text{stop}}}{\\sqrt{\\lambda_{\\min}(K)}} \\le \\tau_{E}\n$$\nTo find the minimal (least restrictive) tolerance $\\varepsilon_{\\text{stop}}$ that satisfies this, we set the terms equal:\n$$\n\\varepsilon_{\\text{stop}} = \\tau_{E} \\sqrt{\\lambda_{\\min}(K)}\n$$\nFirst, we must find the eigenvalues of $K$ by solving the characteristic equation $\\det(K - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix} 6-\\lambda  -1  0 \\\\ -1  6-\\lambda  -1 \\\\ 0  -1  6-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(6-\\lambda) \\left( (6-\\lambda)^{2} - 1 \\right) - (-1) \\left( -(6-\\lambda) - 0 \\right) = 0\n$$\n$$\n(6-\\lambda) \\left( (6-\\lambda)^{2} - 1 \\right) - (6-\\lambda) = 0\n$$\n$$\n(6-\\lambda) \\left( (6-\\lambda)^{2} - 1 - 1 \\right) = 0\n$$\n$$\n(6-\\lambda) \\left( (6-\\lambda)^{2} - 2 \\right) = 0\n$$\nThis gives three solutions for $\\lambda$:\n1.  $6 - \\lambda = 0 \\implies \\lambda_1 = 6$\n2.  $(6 - \\lambda)^{2} = 2 \\implies 6 - \\lambda = \\pm\\sqrt{2} \\implies \\lambda = 6 \\mp \\sqrt{2}$\nThe eigenvalues are $\\lambda = 6$, $\\lambda = 6 - \\sqrt{2}$, and $\\lambda = 6 + \\sqrt{2}$. Since $\\sqrt{2} \\approx 1.414$, the smallest eigenvalue is $\\lambda_{\\min}(K) = 6 - \\sqrt{2}$.\n\nNow, we can calculate $\\varepsilon_{\\text{stop}}$:\n$$\n\\varepsilon_{\\text{stop}} = (5 \\times 10^{-2}) \\sqrt{6 - \\sqrt{2}}\n$$\nNumerically, this is:\n$$\n\\varepsilon_{\\text{stop}} \\approx (0.05) \\sqrt{6 - 1.41421356} = (0.05) \\sqrt{4.58578644} \\approx (0.05) (2.14144499) \\approx 0.10707225\n$$\nRounding to four significant figures, we get:\n$$\n\\varepsilon_{\\text{stop}} \\approx 1.071 \\times 10^{-1}\n$$",
            "answer": "$$\\boxed{1.071 \\times 10^{-1}}$$"
        }
    ]
}