{
    "hands_on_practices": [
        {
            "introduction": "The first step in verifying any numerical simulation is to test it against a problem with a known analytical solution. This practice centers on the numerical solution of the shear Alfvén wave equation, a fundamental mode in magnetized plasmas which reduces to a simple advection equation in the linear limit. By implementing both periodic and simple absorbing (\"sponge layer\") boundary conditions, you will directly measure the numerical dispersion and dissipation inherent in the chosen finite-difference scheme . This exercise builds the crucial skill of validating a simulation by comparing its output against exact theoretical predictions.",
            "id": "3946071",
            "problem": "You are to implement a one-dimensional numerical experiment for the linear shear Alfvén wave using a first-order upwind scheme and evaluate the effects of boundary conditions and solver accuracy through phase error and amplitude decay. The physical base is ideal magnetohydrodynamics (MHD), linearized about a uniform magnetic field, which yields the Elsässer form for shear Alfvén waves. For a constant background magnetic field $B_0$ and mass density $\\rho_0$, the Alfvén speed is given by the well-tested formula $v_A = B_0 / \\sqrt{\\mu_0 \\rho_0}$, where $\\mu_0$ is the magnetic permeability of free space. In the linear regime for a one-dimensional shear Alfvén wave, the Elsässer variable $z^+$ satisfies the pure advection equation $\\partial_t z^+ + v_A \\partial_x z^+ = 0$, whose plane-wave solutions have dispersion relation $\\omega = k v_A$. For a single-mode periodic wave $u(x,t) = \\sin(k x - \\omega t)$ or $u(x,t) = \\cos(k x - \\omega t)$, the exact amplitude is constant and the phase advances linearly with time.\n\nYour program must:\n- Discretize $\\partial_t u + v_A \\partial_x u = 0$ using a first-order upwind scheme on a uniform grid in one spatial dimension.\n- Implement two types of boundary conditions:\n  - Periodic boundary conditions.\n  - Absorbing boundary conditions via a damping \"sponge\" layer near the outflow boundary, modeled by adding a term $- \\sigma(x) u$ to the right-hand side, where $\\sigma(x)$ is nonzero only in the sponge region and smoothly increases toward the boundary.\n- Use the Fourier transform to extract the phase of a chosen periodic mode and compute the phase error in radians against the exact dispersion relation at the final simulation time. The angle unit must be radians.\n- Compute the amplitude decay (ratio of final to initial amplitude) of the fundamental mode for periodic runs. For the absorbing case, compute the residual interior amplitude ratio after the pulse has exited the domain (excluding the sponge region). All amplitude ratios are dimensionless.\n\nStart from the following fundamental base:\n- Ideal magnetohydrodynamics (MHD) linearized about a uniform field.\n- The Alfvén speed $v_A = B_0 / \\sqrt{\\mu_0 \\rho_0}$.\n- The linear advection equation $\\partial_t u + v_A \\partial_x u = 0$.\n- The exact dispersion relation $\\omega = k v_A$ and period $T = 2\\pi / \\omega$.\n- The Courant-Friedrichs-Lewy (CFL) number $C = v_A \\Delta t / \\Delta x$ for stability in the upwind scheme.\n\nNumerical method requirements:\n- For a positive Alfvén speed $v_A > 0$, update the solution on grid index $i$ by $u_i^{n+1} = u_i^n - C (u_i^n - u_{i-1}^n)$.\n- For periodic boundary conditions, set $u_{-1}^n \\equiv u_{N-1}^n$.\n- For absorbing boundary conditions, use outflow on the right boundary and include a sponge layer damping update $u_i^{n+1} \\leftarrow u_i^{n+1} (1 - \\sigma_i \\Delta t)$ with a smooth $\\sigma_i$ over the last portion of the domain.\n\nDefine the phase error as the wrapped difference between the measured phase advance of the chosen Fourier mode and the exact phase advance $-\\omega t_{\\text{end}}$, expressed in radians. Define the amplitude ratio as the ratio of the magnitude of the chosen Fourier mode at $t_{\\text{end}}$ to its magnitude at $t = 0$ for periodic runs. For the absorbing case, define the residual amplitude ratio as the maximum absolute interior amplitude (excluding the sponge region) at $t_{\\text{end}}$ divided by the initial maximum interior amplitude.\n\nPhysical and numerical units:\n- Use meters for length, seconds for time, kilograms per cubic meter for mass density, and Tesla for magnetic field.\n- Express the phase error in radians.\n- Express amplitude ratios as dimensionless floats.\n\nTest suite and parameters:\n- Case $1$ (periodic, moderate stability).\n  - Domain length $L = 2\\pi$ meters, grid points $N = 256$.\n  - Background magnetic field $B_0 = 3$ Tesla, mass density $\\rho_0 = 1.67 \\times 10^{-7}$ kilograms per cubic meter, magnetic permeability $\\mu_0 = 4\\pi \\times 10^{-7}$ newton per ampere squared.\n  - Mode number $m = 3$ (so $k = m$ on $[0, 2\\pi)$), initial condition $u(x,0) = \\sin(m x)$.\n  - Courant-Friedrichs-Lewy (CFL) number $C = 0.2$.\n  - Final time $t_{\\text{end}}$ equal to the smallest multiple of $\\Delta t$ not less than the exact period $T = 2\\pi / (v_A m)$.\n  - Outputs: phase error in radians and amplitude ratio for the fundamental mode.\n\n- Case $2$ (periodic, near-CFL limit).\n  - Same as Case $1$ except $C = 0.9$.\n  - Outputs: phase error in radians and amplitude ratio for the fundamental mode.\n\n- Case $3$ (absorbing, outgoing pulse).\n  - Domain length $L = 10$ meters, grid points $N = 512$.\n  - Background magnetic field $B_0 = 0.1$ Tesla, mass density $\\rho_0 = 10^{-6}$ kilograms per cubic meter, magnetic permeability $\\mu_0 = 4\\pi \\times 10^{-7}$ newton per ampere squared.\n  - Courant-Friedrichs-Lewy (CFL) number $C = 0.5$.\n  - Initial condition: a right-going localized Alfvén pulse $u(x,0) = \\sin(k_0 x) \\exp\\left(-\\frac{(x - x_c)^2}{2 w^2}\\right)$ with $k_0 = 6$ radians per meter, center $x_c = L/4$, and envelope width $w = 0.5$ meters.\n  - Absorbing sponge region of width $L_s = 2$ meters adjacent to the right boundary, with damping profile $\\sigma(x) = \\sigma_0 \\left(\\frac{x - (L - L_s)}{L_s}\\right)^2$ for $x \\ge L - L_s$ and $\\sigma(x) = 0$ otherwise, where $\\sigma_0 = 50$ per second.\n  - Final time $t_{\\text{end}}$ sufficient for the pulse to exit the interior domain: $t_{\\text{end}} = \\left( L - x_c + 3 w \\right) / v_A$ rounded up to the nearest multiple of $\\Delta t$.\n  - Output: residual interior amplitude ratio excluding the sponge region.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order: $[\\text{phase\\_error\\_case1}, \\text{amplitude\\_ratio\\_case1}, \\text{phase\\_error\\_case2}, \\text{amplitude\\_ratio\\_case2}, \\text{residual\\_amplitude\\_ratio\\_case3}]$. All phase errors must be in radians, and all amplitude ratios are dimensionless floats. No additional text should be printed.",
            "solution": "The problem is valid. It presents a well-posed numerical experiment in computational plasma physics, grounded in the established principles of linearized ideal magnetohydrodynamics (MHD). All parameters and conditions are scientifically sound, consistent, and sufficient to obtain a unique numerical solution.\n\nThe core of the problem is to solve the one-dimensional linear advection equation for a shear Alfvén wave, given by:\n$$\n\\partial_t u + v_A \\partial_x u = 0\n$$\nwhere $u$ represents the magnitude of a field perturbation (e.g., a component of the Elsässer variable $z^+$), and $v_A$ is the constant Alfvén speed. The Alfvén speed is determined by the background magnetic field $B_0$ and mass density $\\rho_0$ through the relation:\n$$\nv_A = \\frac{B_0}{\\sqrt{\\mu_0 \\rho_0}}\n$$\nwhere $\\mu_0$ is the permeability of free space. Since $v_A$ is given to be positive, the wave propagates in the positive $x$ direction.\n\nWe will discretize this equation on a uniform spatio-temporal grid. The spatial domain of length $L$ is divided into $N$ grid cells of width $\\Delta x = L/N$, with grid points $x_i = i \\Delta x$ for $i = 0, 1, \\dots, N-1$. Time is advanced in discrete steps of $\\Delta t$, such that $t_n = n \\Delta t$.\n\nThe numerical scheme specified is the first-order upwind method. For $v_A > 0$, the spatial derivative $\\partial_x u$ at grid point $x_i$ is approximated using a first-order backward difference:\n$$\n\\left. \\partial_x u \\right|_{i} \\approx \\frac{u_i - u_{i-1}}{\\Delta x}\n$$\nwhere $u_i$ denotes the value of $u$ at $x_i$. Using a forward Euler method for the time derivative $\\partial_t u \\approx (u_i^{n+1} - u_i^n)/\\Delta t$, the fully discretized equation becomes:\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} + v_A \\frac{u_i^n - u_{i-1}^n}{\\Delta x} = 0\n$$\nRearranging for the solution at the next time step, $u_i^{n+1}$, we obtain the specified update rule:\n$$\nu_i^{n+1} = u_i^n - \\frac{v_A \\Delta t}{\\Delta x} (u_i^n - u_{i-1}^n) = u_i^n - C (u_i^n - u_{i-1}^n)\n$$\nHere, $C = v_A \\Delta t / \\Delta x$ is the Courant-Friedrichs-Lewy (CFL) number. For this explicit scheme, stability is guaranteed for $C \\le 1$.\n\nThe problem requires implementing two types of boundary conditions:\n\n1.  **Periodic Boundary Conditions**: For a domain periodic in $x$, the grid points are topologically connected in a ring. The value $u_{-1}^n$ required for the stencil at $i=0$ is taken from the other end of the domain: $u_{-1}^n \\equiv u_{N-1}^n$. This is efficiently implemented using a circular shift operation on the solution array.\n\n2.  **Absorbing Boundary Conditions**: To prevent unphysical reflections from the outflow boundary ($x=L$), a \"sponge\" layer is introduced. This is achieved by adding a damping term to the PDE, making it $\\partial_t u + v_A \\partial_x u = - \\sigma(x) u$. The damping coefficient $\\sigma(x)$ is non-zero only in a \"sponge\" region near the boundary. The problem specifies an operator-split approach for the update. First, the advection step is performed, yielding an intermediate state $u_i^{\\star}$. Then, the damping is applied:\n    $$\n    u_i^{\\star} = u_i^n - C (u_i^n - u_{i-1}^n)\n    $$\n    $$\n    u_i^{n+1} = u_i^{\\star} (1 - \\sigma_i \\Delta t)\n    $$\n    The damping coefficient $\\sigma_i = \\sigma(x_i)$ is zero outside the sponge region. For the inflow boundary at $x=0$, since the initial wave packet is localized far from it and moves away, a simple zero-gradient condition, $u_{-1}^n = u_0^n$, is a reasonable and sufficient choice. This simplifies the advection update at $i=0$ to $u_0^{n+1} = u_0^n$.\n\nThe analysis of the numerical results involves two key metrics:\n\n-   **Phase Error**: The upwind scheme introduces numerical dispersion, causing waves of different wavelengths to travel at slightly different speeds. The exact dispersion relation is $\\omega = k v_A$, which implies a phase advance of $\\Delta \\phi_{\\text{exact}} = -\\omega t_{\\text{end}}$ over a time $t_{\\text{end}}$. We measure the numerical phase advance by tracking a specific Fourier mode $m$. The initial phase $\\phi_m(0)$ and final phase $\\phi_m(t_{\\text{end}})$ are computed as the argument of the $m$-th coefficient of the Fast Fourier Transform (FFT) of the solution at $t=0$ and $t=t_{\\text{end}}$, respectively. The measured phase advance is $\\Delta \\phi_{\\text{num}} = \\phi_m(t_{\\text{end}}) - \\phi_m(0)$. The phase error is the wrapped difference: $\\epsilon_\\phi = \\text{wrap}(\\Delta \\phi_{\\text{num}} - \\Delta \\phi_{\\text{exact}})$, where $\\text{wrap}(x)$ maps $x$ to the interval $(-\\pi, \\pi]$.\n\n-   **Amplitude Ratio**: The first-order upwind scheme is also dissipative, causing the amplitude of waves to decay over time. For periodic cases, this is measured as the ratio of the final to initial amplitude of the fundamental mode, $|c_m(t_{\\text{end}})| / |c_m(0)|$. For the absorbing case, the metric is the residual interior amplitude ratio, defined as the maximum absolute amplitude in the domain (excluding the sponge region) at $t_{\\text{end}}$, divided by the initial maximum absolute amplitude in the same region. This quantifies the effectiveness of the sponge layer in absorbing the wave and preventing reflections.\n\nThe implementation will proceed by setting up the grid and parameters for each of the three test cases, running the time-stepping loop with the appropriate boundary conditions, and then performing the specified analysis to compute the required outputs.\n\n**Case 1 & 2**: These cases compare a moderately stable CFL number ($C=0.2$) with one near the stability limit ($C=0.9$) for a single-mode sinusoidal wave on a periodic domain. The final time is one exact wave period, $T = 2\\pi/(m v_A)$. This allows for a direct assessment of the scheme's cumulative phase error and dissipation over a characteristic timescale.\n\n**Case 3**: This case tests the absorbing boundary condition. A localized Gaussian-modulated wave packet is initialized and evolved for a time sufficient for it to propagate across the domain and into the sponge layer. The analysis focuses on the residual wave energy left in the physical domain, indicating the performance of the absorbing layer.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves a 1D linear advection equation for shear Alfvén waves\n    using a first-order upwind scheme, evaluating phase error and\n    amplitude decay under periodic and absorbing boundary conditions.\n    \"\"\"\n\n    def wrap_phase(phi):\n        \"\"\"Wraps a phase angle to the interval (-pi, pi].\"\"\"\n        return (phi + np.pi) % (2 * np.pi) - np.pi\n\n    def run_case_periodic(C_val):\n        \"\"\"\n        Runs a simulation for the periodic boundary condition case.\n\n        Args:\n            C_val (float): The Courant-Friedrichs-Lewy (CFL) number.\n\n        Returns:\n            tuple: A tuple containing the phase error (radians) and\n                   the amplitude ratio (dimensionless).\n        \"\"\"\n        # Parameters\n        L = 2.0 * np.pi\n        N = 256\n        B0 = 3.0\n        rho0 = 1.67e-7\n        mu0 = 4.0 * np.pi * 1e-7\n        m = 3\n\n        # Derived quantities\n        dx = L / N\n        x = np.linspace(0, L, N, endpoint=False)\n        vA = B0 / np.sqrt(mu0 * rho0)\n        k = float(m)  # Wave number is integer 'm' for domain [0, 2*pi)\n        omega = k * vA\n        T_period = 2.0 * np.pi / omega\n        \n        dt = C_val * dx / vA\n        num_steps = int(np.ceil(T_period / dt))\n        t_end = num_steps * dt\n\n        # Initial condition\n        u0 = np.sin(k * x)\n\n        # FFT of initial condition for analysis\n        fft_u0 = np.fft.fft(u0)\n        initial_amp_mode_m = np.abs(fft_u0[m])\n        initial_phase_mode_m = np.angle(fft_u0[m])\n        \n        # Time evolution\n        u = u0.copy()\n        for _ in range(num_steps):\n            u_prev = np.roll(u, 1)  # Implements periodic u_{i-1}\n            u = u - C_val * (u - u_prev)\n            \n        # FFT of final condition\n        fft_u_final = np.fft.fft(u)\n        final_amp_mode_m = np.abs(fft_u_final[m])\n        final_phase_mode_m = np.angle(fft_u_final[m])\n\n        # Analysis\n        measured_phase_advance = final_phase_mode_m - initial_phase_mode_m\n        exact_phase_advance = -omega * t_end\n        phase_error = wrap_phase(measured_phase_advance - exact_phase_advance)\n        \n        amplitude_ratio = final_amp_mode_m / initial_amp_mode_m\n        \n        return phase_error, amplitude_ratio\n\n    def run_case_absorbing():\n        \"\"\"\n        Runs a simulation for the absorbing boundary condition case.\n\n        Returns:\n            float: The residual interior amplitude ratio (dimensionless).\n        \"\"\"\n        # Parameters\n        L = 10.0\n        N = 512\n        B0 = 0.1\n        rho0 = 1e-6\n        mu0 = 4.0 * np.pi * 1e-7\n        C = 0.5\n        k0 = 6.0\n        xc = L / 4.0\n        w = 0.5\n        Ls = 2.0\n        sigma0 = 50.0\n\n        # Derived quantities\n        dx = L / N\n        x = np.linspace(0, L, N, endpoint=False)\n        vA = B0 / np.sqrt(mu0 * rho0)\n        \n        dt = C * dx / vA\n        t_end_raw = (L - xc + 3.0 * w) / vA\n        num_steps = int(np.ceil(t_end_raw / dt))\n\n        # Initial condition\n        u0 = np.sin(k0 * x) * np.exp(-((x - xc)**2) / (2 * w**2))\n\n        # Sponge layer setup\n        sigma = np.zeros(N)\n        sponge_start_x = L - Ls\n        sponge_indices = np.where(x >= sponge_start_x)\n        x_sponge = x[sponge_indices]\n        sigma[sponge_indices] = sigma0 * (((x_sponge - sponge_start_x) / Ls)**2)\n        damping_factor = 1.0 - sigma * dt\n\n        # Interior region for analysis\n        interior_indices = np.where(x  sponge_start_x)[0]\n        initial_max_interior_amp = np.max(np.abs(u0[interior_indices]))\n\n        # Time evolution\n        u = u0.copy()\n        for _ in range(num_steps):\n            u_i_minus_1 = np.roll(u, 1)\n            # Left boundary (inflow): zero-gradient condition u_{-1}=u_0\n            # This makes the update at i=0 trivial: u_0^{n+1} = u_0^n.\n            u_i_minus_1[0] = u[0]\n            \n            u = u - C * (u - u_i_minus_1)\n            \n            # Apply sponge layer damping\n            u = u * damping_factor\n\n        # Analysis\n        final_max_interior_amp = np.max(np.abs(u[interior_indices]))\n        if initial_max_interior_amp == 0:\n            residual_amplitude_ratio = 0.0\n        else:\n            residual_amplitude_ratio = final_max_interior_amp / initial_max_interior_amp\n        \n        return residual_amplitude_ratio\n\n    # Define test cases implicitly through function calls\n    test_cases = [\n        {\"type\": \"periodic\", \"C\": 0.2},\n        {\"type\": \"periodic\", \"C\": 0.9},\n        {\"type\": \"absorbing\"}\n    ]\n    \n    results = []\n    for case in test_cases:\n        if case[\"type\"] == \"periodic\":\n            phase_error, amp_ratio = run_case_periodic(case[\"C\"])\n            results.extend([phase_error, amp_ratio])\n        elif case[\"type\"] == \"absorbing\":\n            residual_ratio = run_case_absorbing()\n            results.append(residual_ratio)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Periodic boundary conditions are essential for modeling a small, representative volume of a much larger system, but they inherently limit the spectrum of phenomena that can be captured. This exercise explores this limitation in the context of the classic two-stream instability, a fundamental kinetic process in plasmas. Instead of running a full Particle-In-Cell simulation, you will use the analytical dispersion relation to calculate how the discrete wavenumber spectrum, imposed by the finite domain size, affects the instability's growth rate . This practice provides critical insight into how simulation parameters must be chosen to correctly resolve the physical scales of interest.",
            "id": "3946029",
            "problem": "Consider a one-dimensional, electrostatic, collisionless plasma comprised of two cold electron beams with equal number density streaming through each other with drift velocities $\\pm v_0$ in the presence of a uniform, immobile ion background that ensures overall charge neutrality. Assume periodic boundary conditions over a finite-length domain of size $L$ as is standard in Particle-In-Cell (PIC) simulations, so that admissible Fourier modes are discretized and given by $k_m = 2\\pi m/L$ for integer mode index $m$. Let $N$ denote the number of spatial grid points used to represent the fields in the PIC discretization; the resolvable wavenumber range is limited by the Nyquist wavenumber, so that only modes with $m = 1,2,\\ldots,\\lfloor N/2 \\rfloor$ are admissible.\n\nStarting from the linearized Vlasov–Poisson system, assume cold beams so that the unperturbed distribution functions are $f_{0,1}(v) = \\tfrac{n_0}{2}\\,\\delta(v - v_0)$ and $f_{0,2}(v) = \\tfrac{n_0}{2}\\,\\delta(v + v_0)$, where $\\delta(\\cdot)$ denotes the Dirac delta function and $n_0$ is the total electron number density. Using Fourier analysis with perturbations proportional to $\\exp(i k x - i \\omega t)$, the cold-beam electrostatic dispersion relation for the two-stream system is\n$$\n1 - \\frac{\\omega_{b}^2}{\\left(\\omega - k v_0\\right)^2} - \\frac{\\omega_{b}^2}{\\left(\\omega + k v_0\\right)^2} = 0,\n$$\nwhere $\\omega_b^2 = \\tfrac{n_0 e^2}{2 \\varepsilon_0 m_e}$ is the squared electron plasma frequency of a single beam, $e$ is the elementary charge, $\\varepsilon_0$ is the vacuum permittivity, and $m_e$ is the electron mass. Define the total electron plasma frequency $\\omega_p^2 = \\tfrac{n_0 e^2}{\\varepsilon_0 m_e}$ so that $\\omega_p^2 = 2 \\omega_b^2$. Let $a(k) = k^2 v_0^2$ and $X \\equiv \\omega^2$. Show that the dispersion reduces to a quadratic equation in $X$,\n$$\nX^2 - \\left(2 a + \\omega_p^2\\right) X + \\left(a^2 - \\omega_p^2 a\\right) = 0,\n$$\nand that the unstable branch exists for $0  a  \\omega_p^2$, with the growth rate $\\gamma(k)$ given by the purely imaginary root $\\omega = i \\gamma$ built from the negative solution $X_{-}$:\n$$\nX_{-}(k) = \\frac{\\left(2 a + \\omega_p^2\\right) - \\omega_p \\sqrt{\\omega_p^2 + 8 a}}{2}, \\quad \\gamma(k) = \\sqrt{-X_{-}(k)}.\n$$\nIn the continuum (unbounded) limit, the fastest growing mode occurs at $a^\\star = \\tfrac{3}{8} \\omega_p^2$, yielding the maximum growth rate\n$$\n\\gamma_{\\mathrm{max,\\,cont}} = \\frac{\\omega_p}{2 \\sqrt{2}}.\n$$\n\nUnder periodic boundary conditions with a finite box of length $L$ and a finite grid resolution $N$, the allowed wavenumbers are discretized as $k_m = 2\\pi m/L$ with $m = 1,2,\\ldots,\\lfloor N/2 \\rfloor$. The box size and discretization jointly determine both the spacing $\\Delta k = 2\\pi/L$ and the maximum resolvable wavenumber $k_{\\mathrm{Nyquist}} = \\pi N/L$. This affects whether the fastest growing continuum mode is representable and how closely its growth rate is approximated.\n\nYour task is to implement a complete, runnable program that, for each test case listed below, computes:\n1. The discrete maximum growth rate $\\gamma_{\\mathrm{max,\\,disc}}$ over all admissible $k_m$ with $m = 1,2,\\ldots,\\lfloor N/2 \\rfloor$, using the above cold-beam dispersion relation.\n2. The continuum maximum growth rate $\\gamma_{\\mathrm{max,\\,cont}} = \\omega_p/(2\\sqrt{2})$ for the same physical parameters.\n3. The sensitivity ratio $R = \\gamma_{\\mathrm{max,\\,disc}} / \\gamma_{\\mathrm{max,\\,cont}}$.\n\nUse the following physical constants in the International System of Units (SI): $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$, $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$, and $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$. All quantities must be handled in SI units. The final program output must be the list of sensitivity ratios for all test cases, each formatted as a floating-point decimal rounded to six decimal places. No percentage signs are permitted.\n\nTest Suite (each case is a tuple $(n_0, v_0, L, N)$):\n- Case 1 (happy path, high resolution, broad wavenumber coverage): $n_0 = 10^{16}\\,\\mathrm{m^{-3}}$, $v_0 = 10^{6}\\,\\mathrm{m/s}$, $L = 1.0\\,\\mathrm{m}$, $N = 8192$.\n- Case 2 (finite box size with limited high-$k$ representation): $n_0 = 10^{16}\\,\\mathrm{m^{-3}}$, $v_0 = 10^{6}\\,\\mathrm{m/s}$, $L = 10.0\\,\\mathrm{m}$, $N = 2048$.\n- Case 3 (edge case: no unstable discrete mode due to box-induced minimum wavenumber exceeding the instability threshold): $n_0 = 10^{16}\\,\\mathrm{m^{-3}}$, $v_0 = 10^{6}\\,\\mathrm{m/s}$, $L = 9.0 \\times 10^{-4}\\,\\mathrm{m}$, $N = 64$.\n- Case 4 (near-threshold box where only the lowest mode lies in the unstable band): $n_0 = 10^{16}\\,\\mathrm{m^{-3}}$, $v_0 = 10^{6}\\,\\mathrm{m/s}$, $L = \\frac{2\\pi}{5500}\\,\\mathrm{m}$, $N = 16$.\n\nRequired final output format: Your program should produce a single line of output containing the sensitivity ratios for the four test cases as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is a floating-point number rounded to six decimal places, expressed in pure decimal form.",
            "solution": "The problem is valid as it is scientifically grounded in the established theory of the two-stream instability in plasma physics, is well-posed with a clear objective and sufficient data, and is presented in an objective, formal manner free of contradictions or ambiguities.\n\nThe solution proceeds by implementing the provided physical model to compare the maximum instability growth rate in an idealized continuum system with that of a discretized system, which is representative of numerical simulations. The core of the problem lies in understanding how finite domain size $L$ and finite grid resolution $N$ in a Particle-In-Cell (PIC) simulation constrain the spectrum of representable wavenumbers $k$, thereby affecting the observed growth rate of physical instabilities.\n\nThe fundamental physical model is the cold-beam electrostatic dispersion relation for two counter-streaming electron beams:\n$$\n1 - \\frac{\\omega_{b}^2}{\\left(\\omega - k v_0\\right)^2} - \\frac{\\omega_{b}^2}{\\left(\\omega + k v_0\\right)^2} = 0\n$$\nwhere $\\omega$ is the frequency, $k$ is the wavenumber, $\\pm v_0$ are the beam velocities, and $\\omega_b$ is the plasma frequency of a single beam. Using the total electron plasma frequency $\\omega_p$ where $\\omega_p^2 = 2\\omega_b^2$, this relation leads to a condition for purely growing modes (instability), where $\\omega = i\\gamma$ for a real growth rate $\\gamma > 0$. The instability exists for wavenumbers $k$ such that $0  k^2 v_0^2  \\omega_p^2$.\n\nThe growth rate $\\gamma(k)$ is derived from the dispersion relation and is given by $\\gamma(k) = \\sqrt{-X_{-}(k)}$, where $X_{-} \\equiv \\omega^2$ is the negative root of the corresponding quadratic equation. The formula for the growth rate squared is:\n$$\n\\gamma(k)^2 = -X_{-}(k) = \\frac{\\omega_p \\sqrt{\\omega_p^2 + 8 k^2 v_0^2} - (2 k^2 v_0^2 + \\omega_p^2)}{2}\n$$\n\nThe algorithmic procedure to solve the problem for each test case $(n_0, v_0, L, N)$ is as follows:\n\n1.  **Calculate Physical Constants**: From the given fundamental constants ($e, \\varepsilon_0, m_e$) and the input parameter for total electron density $n_0$, we first compute the squared total electron plasma frequency, $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$. We then take its square root to find $\\omega_p$.\n\n2.  **Compute Continuum Maximum Growth Rate**: The problem states that in the continuum limit (where all $k$ are allowed), the maximum growth rate $\\gamma_{\\mathrm{max,\\,cont}}$ occurs at a specific wavenumber and has the value $\\gamma_{\\mathrm{max,\\,cont}} = \\frac{\\omega_p}{2\\sqrt{2}}$. This value serves as the ideal benchmark.\n\n3.  **Compute Discrete Maximum Growth Rate**: This step accounts for the constraints of a numerical simulation.\n    a.  **Generate Admissible Wavenumbers**: In a periodic domain of length $L$ discretized with $N$ grid points, the resolvable wavenumbers are given by $k_m = \\frac{2\\pi m}{L}$, for positive integer mode numbers $m = 1, 2, \\ldots, \\lfloor N/2 \\rfloor$. The upper limit $m_{max} = \\lfloor N/2 \\rfloor$ arises from the Nyquist-Shannon sampling theorem, where $k_{Nyquist} = \\frac{\\pi N}{L}$ is the maximum resolvable wavenumber. A vector of these $k_m$ values is generated.\n    b.  **Identify Unstable Modes**: The instability condition is $k^2 v_0^2  \\omega_p^2$. We apply this filter to our vector of admissible wavenumbers $k_m$ to find the subset of modes that are physically unstable.\n    c.  **Calculate Growth Rates**: For each unstable wavenumber $k_m$ in the filtered subset, we calculate the corresponding growth rate $\\gamma(k_m)$ using the formula for $\\gamma(k)^2$ provided above.\n    d.  **Find Maximum**: If the set of unstable modes is empty (which can occur if the fundamental mode $k_1 = 2\\pi/L$ is already beyond the instability cutoff, i.e., $k_1 > \\omega_p/v_0$), the discrete maximum growth rate $\\gamma_{\\mathrm{max,\\,disc}}$ is $0$. Otherwise, $\\gamma_{\\mathrm{max,\\,disc}}$ is the maximum value found among the calculated growth rates $\\gamma(k_m)$.\n\n4.  **Compute Sensitivity Ratio**: The final step is to compute the ratio $R = \\frac{\\gamma_{\\mathrm{max,\\,disc}}}{\\gamma_{\\mathrm{max,\\,cont}}}$. This ratio quantifies how well the discretized system can capture the fastest-growing mode of the physical instability. A ratio close to $1$ indicates high fidelity, while a ratio close to $0$ suggests that the simulation parameters ($L$ and $N$) are poorly chosen to study this particular instability.\n\nThis entire procedure is implemented for each test case. Vectorized operations using the `numpy` library are employed for efficiency in handling the arrays of wavenumbers and their corresponding growth rates.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity ratio of discrete vs. continuum maximum growth rates\n    for the two-stream instability under various simulation parameters.\n    \"\"\"\n    \n    # Physical Constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge (C)\n    EPSILON_0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n    M_E = 9.1093837015e-31       # Electron mass (kg)\n\n    # Test Suite: (n0, v0, L, N)\n    # n0: total electron number density (m^-3)\n    # v0: beam drift velocity (m/s)\n    # L: domain length (m)\n    # N: number of grid points\n    test_cases = [\n        (1.0e16, 1.0e6, 1.0, 8192),\n        (1.0e16, 1.0e6, 10.0, 2048),\n        (1.0e16, 1.0e6, 9.0e-4, 64),\n        (1.0e16, 1.0e6, 2 * np.pi / 5500, 16),\n    ]\n\n    results = []\n    \n    for n0, v0, L, N in test_cases:\n        # 1. Calculate physical parameters\n        omega_p_sq = (n0 * E_CHARGE**2) / (EPSILON_0 * M_E)\n        omega_p = np.sqrt(omega_p_sq)\n        \n        # 2. Compute continuum maximum growth rate\n        gamma_max_cont = omega_p / (2 * np.sqrt(2))\n        \n        # 3. Compute discrete maximum growth rate\n        m_max = int(np.floor(N / 2))\n        \n        gamma_max_disc = 0.0\n        if m_max >= 1:\n            # 3a. Generate admissible wavenumbers\n            m_values = np.arange(1, m_max + 1)\n            k_values = 2 * np.pi * m_values / L\n            \n            # Helper variable a = k^2 * v0^2\n            a_values = k_values**2 * v0**2\n            \n            # 3b. Identify unstable modes (0  a  omega_p^2)\n            unstable_mask = a_values  omega_p_sq\n            \n            if np.any(unstable_mask):\n                unstable_a = a_values[unstable_mask]\n                \n                # 3c. Calculate growth rates for unstable modes\n                # gamma^2 = -X_minus = 0.5 * (omega_p * sqrt(omega_p^2 + 8a) - (2a + omega_p^2))\n                gamma_sq_unstable = 0.5 * (\n                    omega_p * np.sqrt(omega_p_sq + 8 * unstable_a) - (2 * unstable_a + omega_p_sq)\n                )\n                \n                # Clip to 0 before sqrt to handle potential floating point inaccuracies near boundary\n                gamma_unstable = np.sqrt(np.maximum(0, gamma_sq_unstable))\n                \n                # 3d. Find maximum discrete growth rate\n                gamma_max_disc = np.max(gamma_unstable)\n\n        # 4. Compute sensitivity ratio\n        if gamma_max_cont > 1e-9: # Avoid division by zero, though not expected here\n            ratio = gamma_max_disc / gamma_max_cont\n        else:\n            ratio = 0.0\n\n        results.append(ratio)\n        \n    # Final print statement in the exact required format.\n    formatted_results = [\"{:.6f}\".format(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In Particle-In-Cell (PIC) simulations, implementing an absorbing boundary requires handling not just waves but also the charged particles themselves. The abrupt removal of a particle at a boundary can violate discrete charge conservation, injecting spurious high-frequency noise that causes unphysical numerical heating. This practice tasks you with modeling this effect by analyzing the Fourier spectrum of a discontinuous current signal and then implementing several common mitigation techniques, such as fade-out windows and low-pass filters . Mastering these methods is essential for conducting high-fidelity PIC simulations where controlling numerical artifacts is paramount.",
            "id": "3946059",
            "problem": "Consider a one-dimensional electrostatic Particle-In-Cell (PIC) discretization near a boundary. A single macro-particle with charge $q$ and velocity $v_x$ deposits current on the grid each time step by a standard shape-preserving scheme. Absorbing boundary conditions remove the particle when it reaches the wall, while periodic boundary conditions reintroduce the particle on the opposite side. Sudden removal can violate discrete charge-continuity and inject high-frequency components into the current signal, which couple to grid-scale modes and lead to numerical heating. The objective is to quantify the high-frequency content induced by sudden particle removal and to evaluate mitigation schemes.\n\nStart from the charge-continuity equation in its continuous form, $\\partial \\rho / \\partial t + \\nabla \\cdot \\mathbf{J} = 0$, and the definition of the discrete current time series $j[n]$ obtained by domain-integrated current deposition from one macro-particle across time steps $n = 0, 1, \\dots, N-1$ with uniform time step $\\Delta t$. In a simplified one-dimensional scenario with constant particle velocity $v_x$ and uniform shape deposition, the domain-integrated current contributed by that particle is constant, with magnitude $j_0 = q v_x / L$, where $L$ is a characteristic length scale that cancels out in the final fraction-based metric. Under absorbing boundary conditions, a sudden removal at time index $n_0$ produces a discrete-time step change where $j[n] = j_0$ for $n \\le n_0$ and $j[n] = 0$ for $n > n_0$. Under periodic boundary conditions, removal does not occur and the contribution remains $j[n] = j_0$ for all $n$. The high-frequency content can be quantified by the fraction of the discrete Fourier-domain power above a prescribed angular-frequency cutoff $\\omega_c$ relative to the total power, where the angular frequency grid is defined by $\\omega_k = 2 \\pi f_k$ and $f_k = k / (N \\Delta t)$ for $k = 0, 1, \\dots, N/2$, and the Nyquist angular frequency is $\\omega_N = \\pi / \\Delta t$.\n\nYour task is to implement the following, using only mathematical and logical constructs and computing dimensionless quantities:\n\n1. For each test case described below, construct the raw current time series $j_{\\text{raw}}[n]$ according to the boundary condition type:\n   - Absorbing boundary: sudden removal at index $n_0$ so that $j_{\\text{raw}}[n] = j_0$ for $n \\le n_0$ and $j_{\\text{raw}}[n] = 0$ for $n > n_0$.\n   - Periodic boundary: $j_{\\text{raw}}[n] = j_0$ for all $n$.\n\n2. Implement three mitigation variants that produce modified current series $j[n]$ from $j_{\\text{raw}}[n]$:\n   - Linear ramp fade-out over $R$ steps after removal: for absorbing boundary, define $j_{\\text{ramp}}[n] = j_0 \\cdot \\max\\{0, 1 - (n - n_0)/R\\}$ for $n > n_0$ up to $n = n_0 + R$, and $j_{\\text{ramp}}[n] = 0$ for $n > n_0 + R$. For periodic boundary, this mitigation leaves the constant current unchanged.\n   - Hann-taper fade-out over $R$ steps after removal: for absorbing boundary, define $j_{\\text{hann}}[n] = j_0 \\cdot \\tfrac{1}{2}\\left(1 + \\cos\\left(\\pi (n - n_0)/R\\right)\\right)$ for integer $n$ with $n_0  n \\le n_0 + R$, and $j_{\\text{hann}}[n] = 0$ for $n > n_0 + R$. For periodic boundary, this mitigation leaves the constant current unchanged.\n   - First-order exponential low-pass filter applied causally to the raw series: define $j_{\\text{exp}}[n] = \\alpha \\, j_{\\text{exp}}[n-1] + (1 - \\alpha) \\, j_{\\text{raw}}[n]$ for $n \\ge 1$, with $j_{\\text{exp}}[0] = j_{\\text{raw}}[0]$, where $0  \\alpha  1$ controls smoothing strength.\n\n3. For each series $j[n]$ (raw and mitigated), compute the one-sided discrete Fourier transform and its power $P_k = \\left| \\mathcal{F}\\{j\\}[k] \\right|^2$ at angular frequencies $\\omega_k = 2 \\pi f_k$. Let the cutoff be $\\omega_c = \\eta \\, \\omega_N$, for a prescribed fraction $\\eta$ of the Nyquist angular frequency. Define the high-frequency power fraction\n   $$\n   \\phi = \\frac{\\sum_{\\{k: \\omega_k \\ge \\omega_c\\}} P_k}{\\sum_{k} P_k},\n   $$\n   with the convention that if $\\sum_k P_k = 0$, then $\\phi = 0$.\n\n4. Output, for each test case, the four values $\\phi_{\\text{raw}}$, $\\phi_{\\text{ramp}}$, $\\phi_{\\text{hann}}$, and $\\phi_{\\text{exp}}$, as real numbers. These values are dimensionless fractions and must be reported as floating-point numbers.\n\nUse the following test suite of parameter values, designed to probe different aspects of the problem:\n\n- Test case A (happy path, absorbing boundary, mid-series removal): $N = 512$, $\\Delta t = 1$ (dimensionless time step), $n_0 = 256$, $j_0 = 1.0$ (dimensionless current magnitude), $R = 32$, $\\alpha = 0.9$, $\\eta = 0.6$.\n- Test case B (early removal, absorbing boundary, shorter series): $N = 64$, $\\Delta t = 1$, $n_0 = 4$, $j_0 = 1.0$, $R = 4$, $\\alpha = 0.7$, $\\eta = 0.6$.\n- Test case C (periodic boundary, no removal): $N = 256$, $\\Delta t = 1$, $n_0 = 128$ (irrelevant under periodic boundary), $j_0 = 1.0$, $R = 16$, $\\alpha = 0.9$, $\\eta = 0.6$.\n- Test case D (absorbing boundary, zero-velocity macro-particle): $N = 128$, $\\Delta t = 1$, $n_0 = 50$, $j_0 = 0.0$, $R = 16$, $\\alpha = 0.8$, $\\eta = 0.6$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\"), where the values appear in the order\n$$[\\phi_{\\text{raw}}^{A}, \\phi_{\\text{ramp}}^{A}, \\phi_{\\text{hann}}^{A}, \\phi_{\\text{exp}}^{A}, \\phi_{\\text{raw}}^{B}, \\phi_{\\text{ramp}}^{B}, \\phi_{\\text{hann}}^{B}, \\phi_{\\text{exp}}^{B}, \\phi_{\\text{raw}}^{C}, \\phi_{\\text{ramp}}^{C}, \\phi_{\\text{hann}}^{C}, \\phi_{\\text{exp}}^{C}, \\phi_{\\text{raw}}^{D}, \\phi_{\\text{ramp}}^{D}, \\phi_{\\text{hann}}^{D}, \\phi_{\\text{exp}}^{D}].$ All quantities are dimensionless fractions; no physical units are required.",
            "solution": "The problem statement is scientifically grounded, self-contained, and well-posed. It describes a clear computational task rooted in the established principles of Particle-In-Cell (PIC) simulations and Fourier analysis for signal processing. The physical motivation concerns the numerical artifacts introduced by boundary conditions in plasma simulations, a valid and important topic in computational physics. All parameters, mathematical models for current time series, and the analysis metric are defined explicitly and unambiguously, which allows for a unique and verifiable solution. Thus, we proceed to solve the problem as stated.\n\nThe solution methodology consists of three main steps for each test case:\n1.  Construction of the four current time series: the raw series ($j_{\\text{raw}}$) and three mitigated series ($j_{\\text{ramp}}$, $j_{\\text{hann}}$, $j_{\\text{exp}}$).\n2.  Calculation of the high-frequency power fraction, $\\phi$, for each series.\n3.  Aggregation of the results for all test cases into the specified output format.\n\n**1. Time Series Construction**\n\nFor each test case, we are given a total number of time steps $N$, a time step size $\\Delta t$, a current magnitude $j_0$, a removal time index $n_0$, and parameters for the mitigation schemes ($R$ and $\\alpha$). The discrete time domain is indexed by $n = 0, 1, \\dots, N-1$.\n\n-   **Raw Current ($j_{\\text{raw}}$):** The construction depends on the boundary condition.\n    -   For an absorbing boundary, the current is a step function. It is constant up to the removal time and zero thereafter:\n        $$\n        j_{\\text{raw}}[n] = \\begin{cases} j_0  \\text{if } n \\le n_0 \\\\ 0  \\text{if } n > n_0 \\end{cases}\n        $$\n    -   For a periodic boundary, the particle is never removed, so the current contribution is constant for all time:\n        $$\n        j_{\\text{raw}}[n] = j_0 \\quad \\text{for all } n \\in [0, N-1].\n        $$\n\n-   **Linear Ramp Fade-out ($j_{\\text{ramp}}$):** This mitigation smooths the sharp cutoff of the absorbing boundary case. The series is identical to $j_{\\text{raw}}$ up to $n=n_0$. After the removal time, the current is faded to zero linearly over $R$ steps. For $n_0  n \\le n_0+R$, the current is given by:\n    $$\n    j_{\\text{ramp}}[n] = j_0 \\cdot \\left( 1 - \\frac{n - n_0}{R} \\right)\n    $$\n    For $n > n_0+R$, $j_{\\text{ramp}}[n]=0$. This scheme does not alter the constant current of the periodic boundary case.\n\n-   **Hann-Taper Fade-out ($j_{\\text{hann}}$):** This is an alternative smoothing scheme using a cosine-based window function. Similar to the linear ramp, it modifies the series only after $n_0$ for the absorbing boundary case. For $n_0  n \\le n_0+R$, the current is:\n    $$\n    j_{\\text{hann}}[n] = j_0 \\cdot \\frac{1}{2} \\left( 1 + \\cos\\left(\\frac{\\pi (n - n_0)}{R}\\right) \\right)\n    $$\n    For $n > n_0+R$, $j_{\\text{hann}}[n]=0$. This also leaves the periodic case unchanged.\n\n-   **Exponential Low-Pass Filter ($j_{\\text{exp}}$):** This mitigation is a first-order infinite impulse response (IIR) filter applied causally to the raw series $j_{\\text{raw}}[n]$. The filtered series $j_{\\text{exp}}[n]$ is defined by the recurrence relation:\n    $$\n    j_{\\text{exp}}[n] = \\alpha \\, j_{\\text{exp}}[n-1] + (1 - \\alpha) \\, j_{\\text{raw}}[n]\n    $$\n    with the initial condition $j_{\\text{exp}}[0] = j_{\\text{raw}}[0]$. The parameter $\\alpha \\in (0, 1)$ controls the degree of smoothing. This filter is applied to both absorbing and periodic boundary condition cases.\n\n**2. High-Frequency Power Fraction ($\\phi$) Calculation**\n\nThe metric $\\phi$ quantifies the proportion of a signal's power that lies in the high-frequency range. Its calculation for any given time series $j[n]$ proceeds as follows:\n\n-   **Discrete Fourier Transform (DFT):** Since the input signal $j[n]$ is real-valued, we compute its one-sided DFT, $\\mathcal{F}\\{j\\}[k]$, for non-negative frequencies.\n\n-   **Power Spectrum:** The power spectrum, $P_k$, is the squared magnitude of the DFT coefficients: $P_k = \\left| \\mathcal{F}\\{j\\}[k] \\right|^2$. The total power in the signal is the sum over all components, $\\sum_k P_k$.\n\n-   **Frequency Grid:** The DFT coefficients correspond to a grid of discrete frequencies. The physical frequencies are $f_k = k / (N \\Delta t)$ for $k = 0, 1, \\dots, N/2$. The corresponding angular frequencies are $\\omega_k = 2 \\pi f_k$. The highest frequency in this grid is the Nyquist frequency, $f_{N/2} = 1/(2\\Delta t)$, corresponding to the Nyquist angular frequency $\\omega_N = \\pi / \\Delta t$.\n\n-   **Power Fraction Calculation:** The high-frequency cutoff is defined as a fraction $\\eta$ of the Nyquist angular frequency, $\\omega_c = \\eta \\, \\omega_N$. The high-frequency power fraction $\\phi$ is the ratio of the power at frequencies greater than or equal to the cutoff to the total power:\n    $$\n    \\phi = \\frac{\\sum_{\\{k: \\omega_k \\ge \\omega_c\\}} P_k}{\\sum_{k} P_k}\n    $$\n    A special condition is given: if the total power $\\sum_{k} P_k$ is zero (which occurs only for a signal that is zero for all time), then $\\phi$ must be defined as $0$.\n\n**3. Implementation for Test Cases**\n\nThe procedure is applied to each of the four test cases.\n-   **Cases A and B** represent typical absorbing boundary scenarios where the abrupt stop in $j_{\\text{raw}}$ is expected to generate significant high-frequency content. The mitigation schemes are expected to reduce this, resulting in smaller $\\phi$ values.\n-   **Case C** (periodic boundary) serves as a control. The raw current is a constant $j_0$. The ramp and Hann mitigations have no effect. The exponential filter, when applied to a constant input, also produces a constant output. Therefore, all four time series are identical constant signals. The DFT of a constant signal has power only at the DC component ($\\omega_0 = 0$). Since the cutoff fraction is $\\eta = 0.6 > 0$, the cutoff frequency $\\omega_c$ will be greater than $0$. Thus, there is no power at or above $\\omega_c$, and we expect $\\phi = 0$ for all four schemes in this case.\n-   **Case D** (zero-velocity particle) is a null-signal test. Since $j_0 = 0.0$, all time series are identically zero. The total power is zero, and by the problem's definition, $\\phi=0$ for all schemes. These predictable outcomes for Cases C and D serve as essential sanity checks for the correctness of the implementation.\n\nThe code will systematically generate these series, compute their respective $\\phi$ values, and format them into the required list.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational physics problem of quantifying high-frequency\n    content in PIC simulation current signals due to boundary conditions.\n    \"\"\"\n\n    test_cases = [\n        # Case A: Absorbing BC, happy path\n        {'type': 'absorbing', 'N': 512, 'dt': 1.0, 'n0': 256, 'j0': 1.0, 'R': 32, 'alpha': 0.9, 'eta': 0.6},\n        # Case B: Absorbing BC, early removal\n        {'type': 'absorbing', 'N': 64, 'dt': 1.0, 'n0': 4, 'j0': 1.0, 'R': 4, 'alpha': 0.7, 'eta': 0.6},\n        # Case C: Periodic BC\n        {'type': 'periodic', 'N': 256, 'dt': 1.0, 'n0': 128, 'j0': 1.0, 'R': 16, 'alpha': 0.9, 'eta': 0.6},\n        # Case D: Absorbing BC, zero current\n        {'type': 'absorbing', 'N': 128, 'dt': 1.0, 'n0': 50, 'j0': 0.0, 'R': 16, 'alpha': 0.8, 'eta': 0.6},\n    ]\n\n    all_results = []\n\n    def calculate_phi(j_series, N, dt, eta):\n        \"\"\"\n        Calculates the high-frequency power fraction phi for a given time series.\n        \"\"\"\n        j_fft = np.fft.rfft(j_series)\n        power_spectrum = np.abs(j_fft)**2\n        total_power = np.sum(power_spectrum)\n\n        if total_power == 0.0:\n            return 0.0\n\n        freqs = np.fft.rfftfreq(N, d=dt)\n        omega_k = 2 * np.pi * freqs\n        \n        omega_N = np.pi / dt\n        omega_c = eta * omega_N\n        \n        high_freq_power = np.sum(power_spectrum[omega_k >= omega_c])\n        \n        phi = high_freq_power / total_power\n        return phi\n\n    for case in test_cases:\n        N = case['N']\n        dt = case['dt']\n        n0 = case['n0']\n        j0 = case['j0']\n        R = case['R']\n        alpha = case['alpha']\n        eta = case['eta']\n        bc_type = case['type']\n        \n        # 1. Construct raw current series j_raw\n        if bc_type == 'absorbing':\n            j_raw = np.zeros(N)\n            # Set current to j0 up to and including n0\n            j_raw[:n0 + 1] = j0\n        else: # periodic\n            j_raw = np.full(N, j0)\n\n        # 2. Implement mitigation schemes\n        \n        # Linear ramp fade-out\n        j_ramp = np.copy(j_raw)\n        if bc_type == 'absorbing' and j0 != 0.0:\n            fade_start_idx = n0 + 1\n            fade_end_idx = min(N, n0 + R + 1)\n            indices = np.arange(fade_start_idx, fade_end_idx, dtype=int)\n            if len(indices) > 0:\n                ramp_values = j0 * (1.0 - (indices - n0) / R)\n                j_ramp[indices] = ramp_values\n\n        # Hann-taper fade-out\n        j_hann = np.copy(j_raw)\n        if bc_type == 'absorbing' and j0 != 0.0:\n            fade_start_idx = n0 + 1\n            fade_end_idx = min(N, n0 + R + 1)\n            indices = np.arange(fade_start_idx, fade_end_idx, dtype=int)\n            if len(indices) > 0:\n                hann_values = j0 * 0.5 * (1.0 + np.cos(np.pi * (indices - n0) / R))\n                j_hann[indices] = hann_values\n\n        # Exponential low-pass filter\n        j_exp = np.zeros(N)\n        if N > 0:\n            j_exp[0] = j_raw[0]\n            for n in range(1, N):\n                j_exp[n] = alpha * j_exp[n-1] + (1 - alpha) * j_raw[n]\n        \n        # 3. Calculate phi for each series\n        phi_raw = calculate_phi(j_raw, N, dt, eta)\n        phi_ramp = calculate_phi(j_ramp, N, dt, eta)\n        phi_hann = calculate_phi(j_hann, N, dt, eta)\n        phi_exp = calculate_phi(j_exp, N, dt, eta)\n        \n        all_results.extend([phi_raw, phi_ramp, phi_hann, phi_exp])\n\n    # 4. Print results in the specified format\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}