{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any Riemann solver lies in understanding the characteristic wave structure of the underlying equations. For ideal MHD, this means identifying the speeds of the seven distinct wave families that propagate from an initial discontinuity. This practice  challenges you to determine these crucial speeds—the eigenvalues of the system—and to analyze their ordering and potential degeneracies, which occur in specific physical regimes and are a primary source of complexity in numerical simulations.",
            "id": "4041206",
            "problem": "Consider the one-dimensional ideal Magnetohydrodynamics (MHD) system for a compressible, perfectly conducting plasma with an ideal gas equation of state, posed along the $x$-direction. The conservative state is $(\\rho, \\rho u, \\rho v, \\rho w, B_x, B_y, B_z, E)$, where $\\rho$ is the mass density, $(u,v,w)$ are velocity components, $(B_x,B_y,B_z)$ are magnetic field components, and $E$ is the total energy density. Assume $B_x$ is constant in $x$ and $t$ by the divergence-free constraint and flux conservation in one dimension. Let $a \\equiv \\sqrt{\\gamma p/\\rho}$ denote the adiabatic sound speed for ratio of specific heats $\\gamma$, let $c_A \\equiv |B_x|/\\sqrt{\\rho}$ denote the Alfvén speed based on the normal field, and let $c_f$ and $c_s$ denote the fast and slow magnetosonic speeds for propagation along $x$ (both nonnegative by definition). In the context of constructing approximate Riemann solvers for the one-dimensional ideal MHD equations, which of the following statements correctly gives the full set of characteristic speeds (eigenvalues) in terms of $u$, $c_f$, $c_s$, and $c_A$, together with their ordering and a correct description of the possible degeneracies?\n\nChoose one option.\n\nA. The seven eigenvalues are $u - c_f$, $u - c_A$, $u - c_s$, $u$, $u + c_s$, $u + c_A$, $u + c_f$. For $|B_x|  0$ and $\\sqrt{B_y^2 + B_z^2}  0$ one has $c_f \\ge c_A \\ge c_s \\ge 0$, hence $u - c_f \\le u - c_A \\le u - c_s \\le u \\le u + c_s \\le u + c_A \\le u + c_f$, with strict inequalities if $a  0$ and $\\sqrt{B_y^2 + B_z^2}  0$. If $\\sqrt{B_y^2 + B_z^2} = 0$ then $c_f = \\max(a,c_A)$ and $c_s = \\min(a,c_A)$, so $c_A$ coincides with $c_f$ or $c_s$. If $B_x = 0$ then $c_A = 0$ and $c_s = 0$, so the two Alfvén and two slow waves and the contact wave all travel at $u$.\n\nB. The seven eigenvalues are $u - c_f$, $u - c_{A,\\mathrm{tot}}$, $u - c_s$, $u$, $u + c_s$, $u + c_{A,\\mathrm{tot}}$, $u + c_f$, where $c_{A,\\mathrm{tot}} \\equiv |B|/\\sqrt{\\rho}$ with $|B| = \\sqrt{B_x^2 + B_y^2 + B_z^2}$. The ordering satisfies $c_f \\ge c_s \\ge c_{A,\\mathrm{tot}} \\ge 0$ for all states, and degeneracy can only occur when $|B| = 0$.\n\nC. The seven eigenvalues are $u - c_f$, $u - a$, $u - c_s$, $u$, $u + c_s$, $u + a$, $u + c_f$, where $a \\equiv \\sqrt{\\gamma p/\\rho}$. The ordering satisfies $c_f \\ge a \\ge c_s \\ge 0$ for all states, and degeneracy occurs if and only if $a = c_s$.\n\nD. The seven eigenvalues are $u - c_f$, $u - c_A$, $u - c_s$, $u$, $u + c_s$, $u + c_A$, $u + c_f$. The ordering satisfies $c_f \\ge c_s \\ge c_A \\ge 0$ for all states, with strict inequalities whenever $a  0$. If $B_x = 0$ then $c_A = 0$ but $c_s = a  0$, so no coalescence with the contact wave occurs.\n\nE. There are six distinct wave speeds: $u \\pm c_f$, $u \\pm c_A$, $u \\pm c_s$. The contact (entropy) mode does not contribute a separate characteristic speed in ideal MHD, and therefore no degeneracies involving $u$ can occur.",
            "solution": "We begin from the governing conservation laws for ideal Magnetohydrodynamics (MHD) in one dimension, along with the ideal gas closure. In one dimension, the normal magnetic field $B_x$ is constant by $\\nabla \\cdot \\mathbf{B} = 0$ and Faraday’s law with ideal Ohm’s law, and the flux Jacobian admits seven characteristic fields. To obtain the characteristic speeds, we linearize about a uniform state and consider small-amplitude plane waves $\\propto \\exp\\{ i (k x - \\omega t) \\}$.\n\nA standard decoupling of polarizations yields three families in the fluid rest frame ($u = 0$): entropy/contact, Alfvén, and magnetosonic. The entropy/contact mode corresponds to perturbations in $\\rho$ and $p$ advected with the flow, giving characteristic speed $u$ in the laboratory frame. The Alfvén waves correspond to transverse velocity–magnetic field perturbations with $\\delta \\rho = \\delta p = \\delta u = \\delta B_x = 0$, satisfying $\\omega^2 = k^2 c_A^2$ with $c_A \\equiv |B_x|/\\sqrt{\\rho}$, so the two Alfvén speeds are $u \\pm c_A$ in the laboratory frame. The remaining compressive modes are the fast and slow magnetosonic waves, with dispersion in the fluid frame\n$$\n\\frac{\\omega^2}{k^2} = c_{f,s}^2 = \\frac{1}{2}\\Big( a^2 + b^2 \\pm \\sqrt{(a^2 + b^2)^2 - 4 a^2 c_A^2} \\Big),\n$$\nwhere $a \\equiv \\sqrt{\\gamma p/\\rho}$ is the adiabatic sound speed and $b^2 \\equiv |\\mathbf{B}|^2/\\rho = (B_x^2 + B_y^2 + B_z^2)/\\rho$. Transforming to the laboratory frame by Galilean invariance of the hyperbolic system adds $u$, so the magnetosonic speeds are $u \\pm c_f$ and $u \\pm c_s$.\n\nThus, the full set of seven eigenvalues is\n$$\nu - c_f,\\quad u - c_A,\\quad u - c_s,\\quad u,\\quad u + c_s,\\quad u + c_A,\\quad u + c_f.\n$$\n\nWe next establish the ordering and degeneracies from first principles. The fast and slow squared speeds are the two positive roots of\n$$\nX^2 - (a^2 + b^2)\\,X + a^2 c_A^2 = 0,\n$$\nso they satisfy\n$$\nc_f^2 + c_s^2 = a^2 + b^2,\\qquad c_f^2\\,c_s^2 = a^2 c_A^2.\n$$\nDefine $b_t^2 \\equiv (B_y^2 + B_z^2)/\\rho = b^2 - c_A^2 \\ge 0$. Evaluate the quadratic at $X = c_A^2$:\n$$\nP(c_A^2) = c_A^4 - (a^2 + b^2)\\,c_A^2 + a^2 c_A^2 = c_A^2(c_A^2 - b^2) = -\\,c_A^2 b_t^2 \\le 0.\n$$\nBecause $P$ is a convex parabola in $X$ with roots at $X = c_s^2$ and $X = c_f^2$, the inequality $P(c_A^2) \\le 0$ implies\n$$\nc_s^2 \\le c_A^2 \\le c_f^2,\n$$\nwith strict inequalities if and only if $b_t^2 > 0$ (that is, if the tangential magnetic field is nonzero). Since $c_s, c_A, c_f \\ge 0$, the ordering of the characteristic speeds in the laboratory frame is\n$$\nu - c_f \\le u - c_A \\le u - c_s \\le u \\le u + c_s \\le u + c_A \\le u + c_f,\n$$\nwith strict inequalities when $a > 0$, $|B_x| > 0$, and $\\sqrt{B_y^2 + B_z^2} > 0$.\n\nWe now characterize degeneracies:\n- If $\\sqrt{B_y^2 + B_z^2} = 0$ (field purely normal to the direction of propagation), then $b^2 = c_A^2$ and the fast/slow speeds reduce to $c_f = \\max(a, c_A)$ and $c_s = \\min(a, c_A)$. In that case, $c_A$ equals one of $c_f$ or $c_s$ and the corresponding Alfvén mode is degenerate with a magnetosonic mode.\n- If $B_x = 0$, then $c_A = 0$. The quadratic gives $c_s = 0$ and $c_f^2 = a^2 + b_t^2$. Consequently, both Alfvén speeds collapse to $u$, and both slow speeds also collapse to $u$. Together with the contact wave at $u$, this produces a fivefold degeneracy at $u$.\n- If $a = 0$ (cold plasma), then $c_s = 0$ and $c_f^2 = b^2$, so the two slow speeds coincide with the contact at $u$.\n\nThese conclusions provide the correct eigenvalue set, ordering, and degeneracy structure used in Riemann solvers for ideal MHD.\n\nOption-by-option analysis:\n- Option A matches the derived eigenvalues, correctly states the ordering $c_f \\ge c_A \\ge c_s \\ge 0$ under generic conditions with strictness when $a > 0$ and nonzero tangential field, and lists the correct degeneracies for $\\sqrt{B_y^2 + B_z^2} = 0$ and for $B_x = 0$. This is Correct.\n- Option B uses $c_{A,\\mathrm{tot}} \\equiv |B|/\\sqrt{\\rho}$ for the Alfvén speeds, which is incorrect for propagation along the $x$-direction; the relevant Alfvén speed is $c_A = |B_x|/\\sqrt{\\rho}$. Its ordering and degeneracy claims are also incorrect. Incorrect.\n- Option C replaces the intermediate Alfvén speeds with acoustic speeds $a$, which is not the structure of ideal MHD characteristics; the intermediate waves are Alfvénic, not acoustic. Incorrect.\n- Option D gives the correct eigenvalue set but the ordering $c_f \\ge c_s \\ge c_A$ contradicts the established $c_s \\le c_A \\le c_f$. It also misstates the $B_x = 0$ degeneracy: in fact $c_s = 0$ and coincides with the contact at $u$. Incorrect.\n- Option E incorrectly asserts there is no contact eigenvalue; ideal MHD has seven waves including the contact (entropy) wave. Incorrect.\n\nTherefore, the correct choice is Option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once the wave structure is understood, the next practical step is to construct a numerical flux that can be used in a finite-volume code. This exercise  guides you through the calculation of a flux using the robust Harten-Lax-van Leer-Einfeldt (HLLE) method, which cleverly avoids resolving the full wave structure by only using the fastest signal speeds. You will apply this to a challenging case where the normal magnetic field is zero, a common scenario in which the wave structure degenerates and many advanced solvers can fail, demonstrating the practical importance of robust schemes.",
            "id": "4041169",
            "problem": "Consider the one-dimensional ideal Magnetohydrodynamics (MHD) Riemann problem in Cartesian geometry along the $x$-direction, with nondimensional units where magnetic permeability is unity and all quantities are expressed in code units. The ideal MHD conserved state vector and flux in the $x$-direction are defined by the standard conservation laws with total energy, momentum, and magnetic field consistent with divergence-free magnetic field ($\\partial B_x/\\partial x = 0$). The adiabatic index is $\\gamma = 5/3$. The left and right primitive states at the interface $x=0$ are symmetric and given by\n$$\n\\rho_L = 1,\\quad p_L = 1,\\quad u_{x,L} = \\frac{1}{2},\\quad u_{y,L} = 0,\\quad u_{z,L} = 0,\\quad B_{x} = 0,\\quad B_{y,L} = 1,\\quad B_{z,L} = 0,\n$$\n$$\n\\rho_R = 1,\\quad p_R = 1,\\quad u_{x,R} = -\\frac{1}{2},\\quad u_{y,R} = 0,\\quad u_{z,R} = 0,\\quad B_{x} = 0,\\quad B_{y,R} = -1,\\quad B_{z,R} = 0.\n$$\nStarting from the conservation form of the ideal MHD equations and the characteristic wave families, explain the degeneracy and expected compound wave behavior in the limit $B_x \\to 0$, and justify the use of a two-wave Harten–Lax–van Leer–Einfeldt (HLLE) Riemann solver for robustness in this degenerate limit. Then, using fast magnetosonic bounding speeds computed self-consistently from the given left/right states, compute the HLLE numerical flux vector at $x=0$ for the conserved variables ordered as\n$$\n\\left[\\rho,\\ \\rho u_x,\\ \\rho u_y,\\ \\rho u_z,\\ B_y,\\ B_z,\\ E\\right],\n$$\nwhere the total energy is $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho\\left(u_x^2 + u_y^2 + u_z^2\\right) + \\frac{1}{2}\\left(B_x^2 + B_y^2 + B_z^2\\right)$ and the $x$-flux of total energy is $(E + p_t)u_x - B_x(u_x B_x + u_y B_y + u_z B_z)$ with $p_t = p + \\frac{1}{2}(B_x^2 + B_y^2 + B_z^2)$. Express your final flux in exact analytical form. Do not include units in the final answer and do not round.",
            "solution": "The solution proceeds in two parts. First, an explanation of the wave degeneracy in the limit of zero guide field ($B_x \\to 0$) and the justification for using an HLLE solver. Second, a detailed calculation of the HLLE flux vector for the given initial conditions.\n\nThe one-dimensional ideal MHD equations in conservation form are given by:\n$$\n\\frac{\\partial \\mathbf{U}}{\\partial t} + \\frac{\\partial \\mathbf{F}}{\\partial x} = 0\n$$\nwhere $\\mathbf{U}$ is the vector of conserved variables and $\\mathbf{F}$ is the flux vector. For this problem, they are:\n$$\n\\mathbf{U} = \\begin{pmatrix} \\rho \\\\ \\rho u_x \\\\ \\rho u_y \\\\ \\rho u_z \\\\ B_y \\\\ B_z \\\\ E \\end{pmatrix}, \\quad \n\\mathbf{F} = \\begin{pmatrix} \\rho u_x \\\\ \\rho u_x^2 + p_t - B_x^2 \\\\ \\rho u_x u_y - B_x B_y \\\\ \\rho u_x u_z - B_x B_z \\\\ u_x B_y - u_y B_x \\\\ u_x B_z - u_z B_x \\\\ (E + p_t) u_x - B_x (\\mathbf{u} \\cdot \\mathbf{B}) \\end{pmatrix}\n$$\nThe system contains seven characteristic wave families. The speeds of these waves are the eigenvalues of the Jacobian matrix $\\mathbf{A} = \\partial \\mathbf{F} / \\partial \\mathbf{U}$. The seven characteristic speeds are: $u_x \\mp c_f$ (fast magnetosonic), $u_x \\mp c_A$ (Alfvén), $u_x \\mp c_s$ (slow magnetosonic), and $u_x$ (contact/entropy). Here $c_A = |B_x|/\\sqrt{\\rho}$ is the Alfvén speed. The fast ($c_f$) and slow ($c_s$) magnetosonic speeds are given by:\n$$\nc_{f,s}^2 = \\frac{1}{2} \\left( a^2 + c_b^2 \\pm \\sqrt{(a^2 + c_b^2)^2 - 4 a^2 c_A^2} \\right)\n$$\nwith sound speed $a^2 = \\gamma p / \\rho$ and total magnetic speed $c_b^2 = |\\mathbf{B}|^2/\\rho = c_A^2 + (B_y^2 + B_z^2)/\\rho$.\n\nIn the limit $B_x \\to 0$, the Alfvén speed $c_A$ vanishes. This leads to a critical degeneracy in the wave speeds:\n1. The square root term becomes $\\sqrt{(a^2 + c_b^2)^2} = a^2 + c_b^2$.\n2. The fast magnetosonic speed simplifies to $c_f^2 = a^2 + c_b^2 = a^2 + (B_y^2 + B_z^2)/\\rho$.\n3. The slow magnetosonic speed becomes $c_s^2 = 0$.\n4. The Alfvén speed becomes $c_A = 0$.\n\nAs a result, the set of seven characteristic speeds collapses:\n$$\n\\{u_x - c_f, u_x, u_x, u_x, u_x, u_x, u_x + c_f\\}\n$$\nThe two Alfvén waves, two slow waves, and the entropy wave all propagate at the fluid velocity $u_x$. This five-fold degeneracy means that the corresponding eigenvectors are no longer linearly independent, and the system's Jacobian is non-diagonalizable. Exact Riemann solvers and approximate solvers that rely on a full characteristic decomposition (like the Roe solver) will fail in this limit, as they require a complete set of linearly independent eigenvectors to project the state vector jumps.\n\nThe Harten–Lax–van Leer–Einfeldt (HLLE) solver is a robust alternative. It does not attempt to resolve the detailed wave structure of the Riemann fan. Instead, it assumes a simplified two-wave structure bounded by the fastest left-going ($S_L$) and right-going ($S_R$) signal speeds. The region between these two signals is treated as a single, averaged state. The HLLE flux formula is:\n$$\n\\mathbf{F}_{HLLE} = \\frac{S_R \\mathbf{F}_L - S_L \\mathbf{F}_R + S_L S_R (\\mathbf{U}_R - \\mathbf{U}_L)}{S_R - S_L}\n$$\nThis formulation only requires estimates for the bounding speeds, typically the fastest magnetosonic speeds, and does not depend on the eigenvectors of the intermediate waves. Its robustness stems from this simplification, which makes it insensitive to the wave degeneracies that occur when $B_x=0$.\n\nNow, we compute the HLLE flux for the given problem.\n\n**Step 1: Compute Left/Right State and Flux Vectors**\nThe adiabatic index is $\\gamma = 5/3$.\nThe Left State ($L$) primitives are: $\\rho_L=1, p_L=1, u_{x,L}=1/2, u_{y,L}=0, u_{z,L}=0, B_x=0, B_{y,L}=1, B_{z,L}=0$.\nThe Right State ($R$) primitives are: $\\rho_R=1, p_R=1, u_{x,R}=-1/2, u_{y,R}=0, u_{z,R}=0, B_x=0, B_{y,R}=-1, B_{z,R}=0$.\n\nThe total energy $E$ for each state is:\n$E_L = \\frac{p_L}{\\gamma-1} + \\frac{1}{2}\\rho_L(u_{x,L}^2+u_{y,L}^2+u_{z,L}^2) + \\frac{1}{2}(B_x^2+B_{y,L}^2+B_{z,L}^2) = \\frac{1}{2/3} + \\frac{1}{2}(1)(\\frac{1}{4}) + \\frac{1}{2}(1) = \\frac{3}{2} + \\frac{1}{8} + \\frac{1}{2} = \\frac{17}{8}$.\nDue to symmetry, $E_R = E_L = 17/8$.\n\nThe conserved state vectors $\\mathbf{U}_L$ and $\\mathbf{U}_R$ are:\n$\\mathbf{U}_L = [1, 1/2, 0, 0, 1, 0, 17/8]^T$.\n$\\mathbf{U}_R = [1, -1/2, 0, 0, -1, 0, 17/8]^T$.\n\nThe total pressure $p_t = p + \\frac{1}{2}(B_x^2+B_y^2+B_z^2)$:\n$p_{t,L} = 1 + \\frac{1}{2}(0^2+1^2+0^2) = 3/2$.\n$p_{t,R} = 1 + \\frac{1}{2}(0^2+(-1)^2+0^2) = 3/2$.\n\nThe flux vectors $\\mathbf{F}_L$ and $\\mathbf{F}_R$ (with $B_x=0$):\n$\\mathbf{F}_L = [\\rho_L u_{x,L}, \\rho_L u_{x,L}^2+p_{t,L}, \\dots]^T = [1/2, 1(1/2)^2+3/2, 0, 0, (1/2)(1), 0, (17/8+3/2)(1/2)]^T = [1/2, 7/4, 0, 0, 1/2, 0, 29/16]^T$.\n$\\mathbf{F}_R = [\\rho_R u_{x,R}, \\rho_R u_{x,R}^2+p_{t,R}, \\dots]^T = [-1/2, 1(-1/2)^2+3/2, 0, 0, (-1/2)(-1), 0, (17/8+3/2)(-1/2)]^T = [-1/2, 7/4, 0, 0, 1/2, 0, -29/16]^T$.\n\n**Step 2: Compute Signal Speeds**\nThe bounding speeds $S_L$ and $S_R$ are determined by the fast magnetosonic speeds.\n$S_L = \\min(u_{x,L} - c_{f,L}, u_{x,R} - c_{f,R})$\n$S_R = \\max(u_{x,L} + c_{f,L}, u_{x,R} + c_{f,R})$\nFor $B_x=0$, $c_f^2 = a^2 + (B_y^2 + B_z^2)/\\rho = (\\gamma p + B_y^2 + B_z^2)/\\rho$.\n$c_{f,L}^2 = ((5/3)(1) + 1^2)/1 = 8/3$. So $c_{f,L} = \\sqrt{8/3}$.\n$c_{f,R}^2 = ((5/3)(1) + (-1)^2)/1 = 8/3$. So $c_{f,R} = \\sqrt{8/3}$.\n$S_L = \\min(1/2 - \\sqrt{8/3}, -1/2 - \\sqrt{8/3}) = -1/2 - \\sqrt{8/3}$.\n$S_R = \\max(1/2 + \\sqrt{8/3}, -1/2 + \\sqrt{8/3}) = 1/2 + \\sqrt{8/3}$.\nNote that due to symmetry, $S_L = -S_R$.\n\n**Step 3: Compute HLLE Flux**\nUsing $S_L = -S_R$, the HLLE flux formula simplifies to:\n$$\n\\mathbf{F}_{HLLE} = \\frac{S_R \\mathbf{F}_L + S_R \\mathbf{F}_R - S_R^2 (\\mathbf{U}_R - \\mathbf{U}_L)}{2S_R} = \\frac{1}{2}(\\mathbf{F}_L + \\mathbf{F}_R) - \\frac{S_R}{2}(\\mathbf{U}_R - \\mathbf{U}_L)\n$$\nFirst, compute the vector sums/differences:\n$\\mathbf{F}_L + \\mathbf{F}_R = [1/2 - 1/2, 7/4 + 7/4, 0, 0, 1/2 + 1/2, 0, 29/16 - 29/16]^T = [0, 7/2, 0, 0, 1, 0, 0]^T$.\n$\\mathbf{U}_R - \\mathbf{U}_L = [1-1, -1/2 - 1/2, 0, 0, -1 - 1, 0, 17/8 - 17/8]^T = [0, -1, 0, 0, -2, 0, 0]^T$.\n\nNow, substitute these into the simplified HLLE flux formula:\n$$\n\\mathbf{F}_{HLLE} = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ 7/2 \\\\ 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{1/2 + \\sqrt{8/3}}{2} \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ -2 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{F}_{HLLE} = \\begin{pmatrix} 0 \\\\ 7/4 \\\\ 0 \\\\ 0 \\\\ 1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1/2 + \\sqrt{8/3}}{2} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 7/4 + 1/4 + \\frac{1}{2}\\sqrt{8/3} \\\\ 0 \\\\ 0 \\\\ 1/2 + 1/2 + \\sqrt{8/3} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nSimplifying the non-zero components:\nFlux of $\\rho u_x$: $7/4 + 1/4 + \\frac{1}{2}\\frac{2\\sqrt{2}}{\\sqrt{3}} = 2 + \\frac{\\sqrt{2}}{\\sqrt{3}} = 2 + \\frac{\\sqrt{6}}{3}$.\nFlux of $B_y$: $1/2 + 1/2 + \\sqrt{8/3} = 1 + \\frac{2\\sqrt{2}}{\\sqrt{3}} = 1 + \\frac{2\\sqrt{6}}{3}$.\n\nThe final HLLE numerical flux vector is:\n$$\n\\mathbf{F}_{HLLE} = \\left[ 0, \\ 2 + \\frac{\\sqrt{6}}{3}, \\ 0, \\ 0, \\ 1 + \\frac{2\\sqrt{6}}{3}, \\ 0, \\ 0 \\right]^T\n$$\nThe components correspond to the fluxes of $(\\rho, \\rho u_x, \\rho u_y, \\rho u_z, B_y, B_z, E)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  2 + \\frac{\\sqrt{6}}{3}  0  0  1 + \\frac{2\\sqrt{6}}{3}  0  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While robust, simple solvers are safe, higher-resolution methods like the Roe solver are often preferred for their accuracy, yet they are susceptible to creating non-physical solutions (entropy-violating shocks) near sonic points where wave speeds vanish. This final practice  puts you in the shoes of a numerical code developer, asking you to reason through the correct implementation of an \"entropy fix.\" The core challenge is to modify the solver's dissipation to cure the pathology while rigorously upholding the fundamental principle of conservation, a critical design consideration for any reliable simulation tool.",
            "id": "4041240",
            "problem": "Consider a one-dimensional interface at location $x_{i+\\frac{1}{2}}$ in a finite-volume discretization of the ideal Magnetohydrodynamics (MHD) equations, written in conservative form as $\\partial_t U + \\partial_x F(U) = 0$, where $U$ is the vector of conserved variables and $F(U)$ is the flux vector. The interface has left and right reconstructed states $U_L$ and $U_R$, and the finite-volume update of the cell-averaged conserved variables $U_i$ is of the form $U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)$. A Roe-type solver uses a linearization of the flux Jacobian $A = \\partial F/\\partial U$ about a Roe-averaged state $\\tilde{U}$ at the interface and its right-eigenvector matrix $R(\\tilde{U})$ and eigenvalues $\\{\\tilde{\\lambda}_p\\}$ to construct a numerical flux\n$$\nF_{i+\\frac{1}{2}} = \\frac{1}{2}\\left(F(U_L) + F(U_R)\\right) - \\frac{1}{2}\\, R(\\tilde{U})\\, \\Phi(\\Lambda)\\, R(\\tilde{U})^{-1}\\, (U_R - U_L),\n$$\nwhere $\\Lambda = \\mathrm{diag}(\\tilde{\\lambda}_1,\\dots,\\tilde{\\lambda}_m)$ and $m$ is the number of waves in the one-dimensional MHD Riemann problem, and $\\Phi(\\Lambda)$ is a diagonal matrix that reduces to $\\mathrm{diag}(|\\tilde{\\lambda}_1|,\\dots,|\\tilde{\\lambda}_m|)$ in the absence of any special treatment. It is observed in computational fusion plasma simulations that near sonic or Alfvénic degeneracy where $\\tilde{\\lambda}_p \\approx 0$, Roe-type solvers can admit entropy-violating expansion shocks unless an entropy fix is applied. An entropy fix can be achieved by locally modifying the characteristic speeds used in the dissipation term, for example replacing $|\\tilde{\\lambda}_p|$ by a smoothed magnitude $\\phi(\\tilde{\\lambda}_p;\\delta)$ that depends on a local threshold $\\delta  0$ computed from interface states, with $\\phi(\\tilde{\\lambda}_p;\\delta) = |\\tilde{\\lambda}_p|$ for $|\\tilde{\\lambda}_p| \\ge \\delta$ and $\\phi(\\tilde{\\lambda}_p;\\delta)$ a strictly increasing, even function for $|\\tilde{\\lambda}_p|  \\delta$ to avoid vanishing dissipation.\n\nFrom the fundamental base consisting of the conservation law $\\partial_t U + \\partial_x F(U) = 0$, the finite-volume update $U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)$, and the Roe linearization of $A$ with eigen-decomposition, reason through how an entropy fix implemented by modifying eigenvalues near degeneracies must be coupled to corresponding flux corrections to preserve conservation of $U$. In particular, explain what objects in the numerical flux must be altered and which must be left unchanged to ensure that the resulting update remains conservative and respects the entropy condition.\n\nWhich of the following prescriptions correctly implements an entropy fix by locally modifying eigenvalues and ensures conservation through appropriate flux corrections in a one-dimensional ideal MHD Roe-type solver?\n\nA. Replace each $|\\tilde{\\lambda}_p|$ in the dissipation term by $\\phi(\\tilde{\\lambda}_p;\\delta)$ at the interface, leaving $R(\\tilde{U})$ and $R(\\tilde{U})^{-1}$ as computed from the Roe-averaged state, and recompute the single interface flux $F_{i+\\frac{1}{2}}$ using the modified diagonal matrix $\\Phi(\\Lambda) = \\mathrm{diag}(\\phi(\\tilde{\\lambda}_1;\\delta),\\dots,\\phi(\\tilde{\\lambda}_m;\\delta))$ without altering $U_L$ or $U_R$; update $U_i$ via the conservative flux difference. \n\nB. Modify the primitive variables near the interface by adding a small offset to velocity components when $|\\tilde{\\lambda}_p|$ is small, then compute $F_{i+\\frac{1}{2}}$ from these altered states using the original dissipation matrix with $|\\tilde{\\lambda}_p|$, and finally project back to conserved variables for the update.\n\nC. Globally floor the magnitudes of all eigenvalues by enforcing $|\\tilde{\\lambda}_p| \\ge \\delta$ in every cell, but keep the original dissipation matrix at interfaces; to offset the excess dissipation near sonic points, add a non-conservative source term $S_i$ to the update $U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right) + \\Delta t\\, S_i$.\n\nD. Adjust the right-eigenvectors $R(\\tilde{U})$ by an ad hoc rotation near degeneracy to avoid close alignment of slow and Alfvén waves, keep $|\\tilde{\\lambda}_p|$ unchanged in the dissipation term, and compute $F_{i+\\frac{1}{2}}$ as usual.\n\nE. Switch to the Harten–Lax–van Leer (HLL) flux by estimating left and right signal speeds $S_L$ and $S_R$ from the minimum and maximum of locally modified eigenvalues, and then add the Roe-type dissipation term with unmodified $|\\tilde{\\lambda}_p|$ on top of the HLL flux at each interface to ensure conservation.\n\nSelect the option that is consistent with the stated requirements and justify how it follows from the conservation law, finite-volume formulation, and eigen-decomposition principles for the one-dimensional MHD Riemann problem.",
            "solution": "The problem asks to identify the correct procedure for implementing an entropy fix in a one-dimensional ideal Magnetohydrodynamics (MHD) Roe-type solver while ensuring the numerical scheme remains conservative.\n\nThe fundamental requirement of a conservative numerical scheme for a law of the form $\\partial_t U + \\partial_x F(U) = 0$ is that the update can be written in \"flux-difference\" form:\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)\n$$\nThis form guarantees that when the total change of the quantity $U$ is summed over a domain of cells, the internal fluxes cancel in a telescoping series, leaving only the fluxes at the domain boundaries. This numerically mimics the integral form of the conservation law, $\\frac{d}{dt} \\int_{x_a}^{x_b} U dx = F(U(x_a)) - F(U(x_b))$. This cancellation requires that the numerical flux $F_{i+\\frac{1}{2}}$ is a single-valued function computed at the interface between cell $i$ and cell $i+1$, based on the states on either side. That is, the flux leaving cell $i$ must be identical to the flux entering cell $i+1$.\n\nThe Roe numerical flux is given as:\n$$\nF_{i+\\frac{1}{2}} = \\frac{1}{2}\\left(F(U_L) + F(U_R)\\right) - \\frac{1}{2} D_{i+\\frac{1}{2}}\n$$\nwhere the second term, $D_{i+\\frac{1}{2}} = R(\\tilde{U})\\, \\Phi(\\Lambda)\\, R(\\tilde{U})^{-1}\\, (U_R - U_L)$, represents the numerical dissipation.\n\nThe problem states that an entropy fix is needed for cases where an eigenvalue $\\tilde{\\lambda}_p$ approaches zero, causing the corresponding dissipation $|\\tilde{\\lambda}_p|$ to vanish and admitting an unphysical expansion shock. The fix involves replacing $|\\tilde{\\lambda}_p|$ with a function $\\phi(\\tilde{\\lambda}_p;\\delta)$ that ensures dissipation does not vanish within a certain range $|\\tilde{\\lambda}_p|  \\delta$. This modification directly affects the dissipation matrix, which becomes:\n$$\n\\Phi(\\Lambda) \\to \\Phi_{\\mathrm{fix}}(\\Lambda) = \\mathrm{diag}(\\phi(\\tilde{\\lambda}_1;\\delta),\\dots,\\phi(\\tilde{\\lambda}_m;\\delta))\n$$\nTo maintain the conservative property of the scheme, this modification must be contained entirely within the calculation of the single numerical flux value, $F_{i+\\frac{1}{2}}$. The procedure must be:\n1.  Obtain the reconstructed states $U_L$ and $U_R$ at the interface $x_{i+\\frac{1}{2}}$.\n2.  From $U_L$ and $U_R$, compute the Roe-averaged state $\\tilde{U}$ and its eigen-decomposition: eigenvalues $\\{\\tilde{\\lambda}_p\\}$ and eigenvector matrices $R(\\tilde{U})$ and $R(\\tilde{U})^{-1}$.\n3.  Construct the modified diagonal matrix of eigenvalue magnitudes, $\\Phi_{\\mathrm{fix}}(\\Lambda)$.\n4.  Assemble the new numerical flux $F_{i+\\frac{1}{2}}^{\\mathrm{fix}}$ using the modified dissipation term:\n    $$\n    F_{i+\\frac{1}{2}}^{\\mathrm{fix}} = \\frac{1}{2}\\left(F(U_L) + F(U_R)\\right) - \\frac{1}{2}\\, R(\\tilde{U})\\, \\Phi_{\\mathrm{fix}}(\\Lambda)\\, R(\\tilde{U})^{-1}\\, (U_R - U_L)\n    $$\n5.  Use this single, well-defined flux value $F_{i+\\frac{1}{2}}^{\\mathrm{fix}}$ in the standard finite-volume update formula for cells $i$ and $i+1$.\n\nAny method that deviates from this structure—for example, by adding non-conservative source terms or by altering the states $U_L$ and $U_R$ in an ad-hoc manner—will violate the conservation principle. Altering the eigenvectors $R(\\tilde{U})$ would break the physical basis of the characteristic decomposition.\n\n### Option-by-Option Analysis\n\n**A. Replace each $|\\tilde{\\lambda}_p|$ in the dissipation term by $\\phi(\\tilde{\\lambda}_p;\\delta)$ at the interface, leaving $R(\\tilde{U})$ and $R(\\tilde{U})^{-1}$ as computed from the Roe-averaged state, and recompute the single interface flux $F_{i+\\frac{1}{2}}$ using the modified diagonal matrix $\\Phi(\\Lambda) = \\mathrm{diag}(\\phi(\\tilde{\\lambda}_1;\\delta),\\dots,\\phi(\\tilde{\\lambda}_m;\\delta))$ without altering $U_L$ or $U_R$; update $U_i$ via the conservative flux difference.**\nThis option precisely follows the logic derived above. The modification is correctly localized within the dissipation term of the flux calculation. It leaves the fundamental components ($U_L$, $U_R$, $R(\\tilde{U})$) untouched and uses the resulting single flux value in the standard conservative update. This is the canonical method for implementing such an entropy fix while preserving conservation.\n**Verdict: Correct.**\n\n**B. Modify the primitive variables near the interface by adding a small offset to velocity components when $|\\tilde{\\lambda}_p|$ is small, then compute $F_{i+\\frac{1}{2}}$ from these altered states using the original dissipation matrix with $|\\tilde{\\lambda}_p|$, and finally project back to conserved variables for the update.**\nThis is an incorrect and non-standard approach. Arbitrarily modifying the reconstructed states $U_L$ and $U_R$ can violate the Roe property ($\\Delta F = \\tilde{A} \\Delta U$) upon which the solver is based. More critically, it makes the flux a function of artificially altered states, which breaks the direct relationship between the flux and the actual cell-average evolution, potentially compromising conservation and consistency.\n**Verdict: Incorrect.**\n\n**C. Globally floor the magnitudes of all eigenvalues by enforcing $|\\tilde{\\lambda}_p| \\ge \\delta$ in every cell, but keep the original dissipation matrix at interfaces; to offset the excess dissipation near sonic points, add a non-conservative source term $S_i$ to the update $U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right) + \\Delta t\\, S_i$.**\nThis option is fundamentally flawed. The addition of a source term $S_i$ that is not part of the original physical model explicitly breaks the conservative nature of the scheme. The purpose of a conservative scheme is to approximate a conservation law; adding artificial sources defeats this purpose.\n**Verdict: Incorrect.**\n\n**D. Adjust the right-eigenvectors $R(\\tilde{U})$ by an ad hoc rotation near degeneracy to avoid close alignment of slow and Alfvén waves, keep $|\\tilde{\\lambda}_p|$ unchanged in the dissipation term, and compute $F_{i+\\frac{1}{2}}$ as usual.**\nThis is incorrect. The right-eigenvectors represent the physical wave modes of the system and are uniquely determined by the governing equations (via the Jacobian). An \"ad hoc rotation\" breaks this connection and is physically unmotivated. Furthermore, this approach does not address the core problem of vanishing dissipation for a single wave family (e.g., a sonic point in the slow wave), which is determined by the eigenvalue magnitude, not the eigenvector direction.\n**Verdict: Incorrect.**\n\n**E. Switch to the Harten–Lax–van Leer (HLL) flux by estimating left and right signal speeds $S_L$ and $S_R$ from the minimum and maximum of locally modified eigenvalues, and then add the Roe-type dissipation term with unmodified $|\\tilde{\\lambda}_p|$ on top of the HLL flux at each interface to ensure conservation.**\nThis option describes a confused and incorrectly constructed hybrid scheme. The HLL flux is inherently entropy-satisfying but also highly dissipative. More advanced solvers like HLLC or HLLD restore missing waves; they do not simply \"add the Roe-type dissipation term\". Moreover, adding the original Roe dissipation (with *unmodified* $|\\tilde{\\lambda}_p|$) on top of an HLL flux would re-introduce the very entropy-violating potential the fix is meant to cure. This prescription is nonsensical.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}