{
    "hands_on_practices": [
        {
            "introduction": "要构建稳健的数值方法，我们必须首先理解基本方法的缺陷。本练习为平流问题提供了一个基础性的比较，对比了中心差分和迎风差分的表现。通过将这两种格式应用于一个急剧的阶跃函数，您将直接观察到非物理振荡和过度数值扩散之间的权衡，这为本文后续讨论的更先进的限制器方法奠定了基础。",
            "id": "4061462",
            "problem": "考虑一维线性平流方程 $\\partial_t u + a\\,\\partial_x u = 0$，该方程用于模拟一个聚变边缘输运基准问题中标量边缘剖面的被动平流，其中平流速度为 $a = 10^{4}\\,\\mathrm{m/s}$。计算网格是均匀的，间距为 $\\Delta x = 1\\,\\mathrm{mm}$，网格中心位于 $x_j = j\\,\\Delta x$，其中 $j$ 为整数。初始数据是在界面 $x=0$ 处的一个单位阶跃，在网格中心上定义为：当 $j \\geq 0$ 时，$u_j^{0} = 1$；当 $j  0$ 时，$u_j^{0} = 0$。使用单个向前欧拉时间步长 $\\Delta t = 5.0 \\times 10^{-8}\\,\\mathrm{s}$。\n\n从控制方程和空间导数离散近似的标准定义出发，推导以下方法的单步更新公式：\n- 用于 $\\partial_x u$ 的向前欧拉法与空间中心差分，以及\n- 用于正 $a$ 的向前欧拉法与迎风差分。\n\n将每种格式应用于给定的初始数据，并计算在不连续点及其附近的新值 $u_j^{1}$。然后，使用网格上全变分的定义 $TV(u) = \\sum_{j} |u_{j+1} - u_j|$，计算每种格式在一步之后的全变分变化量，即 $\\Delta TV_{\\mathrm{central}} = TV(u^{1}_{\\mathrm{central}}) - TV(u^{0})$ 和 $\\Delta TV_{\\mathrm{upwind}} = TV(u^{1}_{\\mathrm{upwind}}) - TV(u^{0})$。\n\n最后，报告单个无量纲量 $\\Delta TV_{\\mathrm{central}} - \\Delta TV_{\\mathrm{upwind}}$。这个差值可作为过冲（非单调振荡）与抹平（扩散性展宽）的定量比较。将最终答案表示为单个实数。无需四舍五入。在首次提及时定义所使用的任何首字母缩略词（例如，Courant–Friedrichs–Lewy (CFL) 或全变分递减 (Total Variation Diminishing, TVD)）。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观和完整的。所有必要的数据和定义都已提供，没有内部矛盾或违反物理原理之处。我们可以开始求解。\n\n该问题要求分析用于一维线性平流方程的两种数值格式：\n$$\n\\partial_t u + a\\,\\partial_x u = 0\n$$\n其中平流速度为 $a = 10^{4}\\,\\mathrm{m/s}$。离散化参数给定为网格间距 $\\Delta x = 1\\,\\mathrm{mm} = 10^{-3}\\,\\mathrm{m}$ 和时间步长 $\\Delta t = 5.0 \\times 10^{-8}\\,\\mathrm{s}$。一个关键的无量纲参数是 Courant–Friedrichs–Lewy (CFL) 数，用 $\\nu$ 表示，定义为：\n$$\n\\nu = a \\frac{\\Delta t}{\\Delta x}\n$$\n代入给定值：\n$$\n\\nu = (10^{4}\\,\\mathrm{m/s}) \\frac{5.0 \\times 10^{-8}\\,\\mathrm{s}}{10^{-3}\\,\\mathrm{m}} = 10^{4} \\times 5.0 \\times 10^{-8} \\times 10^{3} = 5.0 \\times 10^{-1} = 0.5\n$$\nCFL 数的值为 $\\nu = 0.5$。\n\n我们将使用向前欧拉时间离散。平流方程在网格点 $x_j$ 的半离散形式为 $\\frac{du_j}{dt} = -a (\\partial_x u)_j$。应用向前欧拉法，其中 $u_j^n$ 是在时间 $t_n = n\\Delta t$ 处解的近似值，可得：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -a (\\partial_x u)_j^n\n$$\n其中 $(\\partial_x u)_j^n$ 是在时间 $t_n$ 处空间导数的离散近似。这可以重新整理为通用的单步更新公式：\n$$\nu_j^{n+1} = u_j^n - a \\frac{\\Delta t}{\\Delta x} (\\Delta x (\\partial_x u)_j^n) = u_j^n - \\nu (\\Delta x (\\partial_x u)_j^n)\n$$\n\n首先，我们推导两种指定的空间离散格式的更新公式。\n\n1.  **向前欧拉法与中心差分：**\n    在 $x_j$ 处空间导数的二阶精度中心差分近似为：\n    $$\n    (\\partial_x u)_j^n \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x}\n    $$\n    将其代入通用更新公式可得：\n    $$\n    u_j^{n+1} = u_j^n - \\nu \\left( \\Delta x \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x} \\right) \\right) = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n)\n    $$\n\n2.  **向前欧拉法与迎风差分：**\n    对于正平流速度（$a > 0$），“迎风”方向是 x 负方向（来自较小的索引 $j$）。一阶精度的迎风格式使用后向差分：\n    $$\n    (\\partial_x u)_j^n \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}\n    $$\n    将其代入通用更新公式可得：\n    $$\n    u_j^{n+1} = u_j^n - \\nu \\left( \\Delta x \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) \\right) = u_j^n - \\nu (u_j^n - u_{j-1}^n)\n    $$\n    这也可以写成 $u_j^{n+1} = (1-\\nu)u_j^n + \\nu u_{j-1}^n$。\n\n接下来，我们将每种格式应用一个时间步到给定的初始数据上。初始条件是一个阶跃函数：\n$$\nu_j^0 = \\begin{cases} 0  \\text{for } j  0 \\\\ 1  \\text{for } j \\geq 0 \\end{cases}\n$$\n因此，初始网格值为 $... , u_{-2}^0=0, u_{-1}^0=0, u_0^0=1, u_1^0=1, u_2^0=1, ...$。我们使用 $\\nu=0.5$。\n\n- **中心格式的应用 ($u_j^{1, \\mathrm{central}}$)：**\n  $u_j^1 = u_j^0 - \\frac{0.5}{2}(u_{j+1}^0 - u_{j-1}^0) = u_j^0 - 0.25(u_{j+1}^0 - u_{j-1}^0)$。我们计算不连续点及其附近的新值：\n  - 对于 $j \\leq -2$：$u_{j+1}^0=0$ 且 $u_{j-1}^0=0$，所以 $u_j^1 = u_j^0 - 0.25(0-0) = 0$。\n  - 对于 $j = -1$：$u_{-1}^1 = u_{-1}^0 - 0.25(u_0^0 - u_{-2}^0) = 0 - 0.25(1 - 0) = -0.25$。这显示了一个非物理的下冲。\n  - 对于 $j = 0$：$u_0^1 = u_0^0 - 0.25(u_1^0 - u_{-1}^0) = 1 - 0.25(1 - 0) = 0.75$。\n  - 对于 $j \\geq 1$：$u_{j+1}^0=1$ 且 $u_{j-1}^0=1$（因为 $j-1 \\ge 0$），所以 $u_j^1 = u_j^0 - 0.25(1-1) = u_j^0 = 1$。\n  一步之后的状态为 $u^1_{\\mathrm{central}}: ..., 0, 0, -0.25, 0.75, 1, 1, ...$\n\n- **迎风格式的应用 ($u_j^{1, \\mathrm{upwind}}$)：**\n  $u_j^1 = u_j^0 - 0.5(u_j^0 - u_{j-1}^0)$。\n  - 对于 $j \\leq -1$：$u_j^0=0$ 且 $u_{j-1}^0=0$，所以 $u_j^1 = 0 - 0.5(0-0) = 0$。\n  - 对于 $j = 0$：$u_0^1 = u_0^0 - 0.5(u_0^0 - u_{-1}^0) = 1 - 0.5(1 - 0) = 0.5$。阶跃被抹平了。\n  - 对于 $j \\geq 1$：$u_j^0=1$ 且 $u_{j-1}^0=1$（因为 $j-1 \\ge 0$），所以 $u_j^1 = 1 - 0.5(1-1) = 1$。\n  一步之后的状态为 $u^1_{\\mathrm{upwind}}: ..., 0, 0, 0, 0.5, 1, 1, ...$\n\n现在，我们计算每种状态的全变分 (Total Variation, TV)。TV 定义为 $TV(u) = \\sum_{j} |u_{j+1} - u_j|$。\n- **初始全变分 $TV(u^0)$：**\n  唯一的非零差值出现在 $j=-1$ 和 $j=0$ 之间。\n  $$ TV(u^0) = \\sum_j |u_{j+1}^0 - u_j^0| = |u_0^0 - u_{-1}^0| = |1 - 0| = 1 $$\n\n- **中心格式的全变分 $TV(u^1_{\\mathrm{central}})$：**\n  非零差值出现在原始阶跃周围。\n  $|u_{-1}^1 - u_{-2}^1| = |-0.25 - 0| = 0.25$。\n  $|u_0^1 - u_{-1}^1| = |0.75 - (-0.25)| = |1.0| = 1.0$。\n  $|u_1^1 - u_0^1| = |1 - 0.75| = 0.25$。\n  所有其他差值为零。\n  $$ TV(u^1_{\\mathrm{central}}) = 0.25 + 1.0 + 0.25 = 1.5 $$\n  全变分的变化量为 $\\Delta TV_{\\mathrm{central}} = TV(u^1_{\\mathrm{central}}) - TV(u^0) = 1.5 - 1 = 0.5$。TV 的增加是产生新极值（下冲）的直接后果。\n\n- **迎风格式的全变分 $TV(u^1_{\\mathrm{upwind}})$：**\n  非零差值为：\n  $|u_0^1 - u_{-1}^1| = |0.5 - 0| = 0.5$。\n  $|u_1^1 - u_0^1| = |1 - 0.5| = 0.5$。\n  所有其他差值为零。\n  $$ TV(u^1_{\\mathrm{upwind}}) = 0.5 + 0.5 = 1.0 $$\n  全变分的变化量为 $\\Delta TV_{\\mathrm{upwind}} = TV(u^1_{\\mathrm{upwind}}) - TV(u^0) = 1.0 - 1 = 0$。在这种情况下，全变分是守恒的。满足 $TV(u^{n+1}) \\leq TV(u^n)$ 的数值格式称为全变分递减 (Total Variation Diminishing, TVD)。对于 $\\nu \\in [0, 1]$，一阶迎风格式是 TVD 的。\n\n最后，我们计算所求的量：\n$$\n\\Delta TV_{\\mathrm{central}} - \\Delta TV_{\\mathrm{upwind}} = 0.5 - 0 = 0.5\n$$\n这个正值量化了中心差分格式产生伪振荡（增加 TV）的程度，与之相比，迎风格式是单调的但更具扩散性（抹平阶跃而不增加 TV）。",
            "answer": "$$\\boxed{0.5}$$"
        },
        {
            "introduction": "在了解了基本格式的不足之后，我们现在来探究基于限制器方法的理论优势。一个“高分辨率”格式的关键要求是，它必须在解的光滑区域保持高精度，以避免一阶方法的涂抹效应。本练习要求您证明，对于一个光滑的二次函数剖面，一个构造合理的、带有minmod限制器的MUSCL格式确实能够恢复二阶精度，从而展示了限制器在远离急剧梯度时是如何被设计为“不激活”的。",
            "id": "4061509",
            "problem": "考虑一个代表聚变装置中磁化等离子体通量管内平行温度输运的一维线性无源标量平流问题，该问题由守恒律 $\\partial_t u + a \\,\\partial_x u = 0$ 控制，其中平流速度 $a>0$ 为常数。在一个均匀网格上，采用有限体积迎风法，网格中心位于 $x_i = x_0 + i\\,h$，间距为 $h>0$。该方法使用保持单调性的限制斜率，通过 Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) 方法重构左右界面状态。网格单元 $i$ 处的限制斜率由广义 minmod 限制器定义为\n$$\ns_i \\;=\\; \\mathrm{minmod}\\!\\left(2\\,d_i^{-},\\,d_{c,i},\\,2\\,d_i^{+}\\right),\n$$\n其中 $d_i^{-} = \\dfrac{u_i - u_{i-1}}{h}$，$d_i^{+} = \\dfrac{u_{i+1}-u_i}{h}$，$d_{c,i} = \\dfrac{u_{i+1}-u_{i-1}}{2h}$，且三个参数的 minmod 函数定义为\n$$\n\\mathrm{minmod}(a,b,c) \\;=\\;\n\\begin{cases}\n\\mathrm{sign}(a)\\,\\min\\!\\left(|a|,|b|,|c|\\right),   \\text{if } \\mathrm{sign}(a)=\\mathrm{sign}(b)=\\mathrm{sign}(c),\\\\\n0,   \\text{otherwise}.\n\\end{cases}\n$$\n假设一个光滑的二次函数剖面 $u(x) = \\alpha x^2 + \\beta x + \\gamma$，其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 为实常数。关注一个固定的网格单元索引 $i$，并假设该单元的三个候选斜率没有符号变化，同时满足局部光滑性条件\n$$|\\alpha| h \\le \\frac{1}{2} |2\\alpha x_i + \\beta|$$\n从给定的定义和均匀网格几何出发，确定由网格单元 $i$ 处的 minmod 算子返回的限制斜率 $s_i$ 的闭式解析表达式，并用 $\\alpha$、$\\beta$ 和 $x_i$ 简化表示。请以单一解析表达式的形式给出最终答案。无需四舍五入，也无需单位。",
            "solution": "该问题的目标是，在给定的光滑二次函数剖面和局部光滑性假设下，确定由 MUSCL 方法中特定 minmod 限制器计算出的限制斜率 $s_i$。\n\n首先，我们计算在二次剖面 $u(x) = \\alpha x^2 + \\beta x + \\gamma$ 下，三个用于构造限制器的差分斜率：后向差分 $d_i^{-}$，前向差分 $d_i^{+}$，以及中心差分 $d_{c,i}$。网格是均匀的，间距为 $h$。\n\n$u_i = u(x_i) = \\alpha x_i^2 + \\beta x_i + \\gamma$\n$u_{i-1} = u(x_i-h) = \\alpha(x_i-h)^2 + \\beta(x_i-h) + \\gamma$\n$u_{i+1} = u(x_i+h) = \\alpha(x_i+h)^2 + \\beta(x_i+h) + \\gamma$\n\n代入定义可得：\n$$\nd_i^{-} = \\frac{u_i - u_{i-1}}{h} = \\frac{\\alpha(2x_ih - h^2) + \\beta h}{h} = 2\\alpha x_i + \\beta - \\alpha h\n$$\n$$\nd_i^{+} = \\frac{u_{i+1} - u_i}{h} = \\frac{\\alpha(2x_ih + h^2) + \\beta h}{h} = 2\\alpha x_i + \\beta + \\alpha h\n$$\n$$\nd_{c,i} = \\frac{u_{i+1} - u_{i-1}}{2h} = \\frac{\\alpha(4x_ih) + 2\\beta h}{2h} = 2\\alpha x_i + \\beta\n$$\n值得注意的是，对于二次函数，中心差分 $d_{c,i}$ 给出了在点 $x_i$ 处的精确导数 $u'(x_i)$。\n\n接下来，我们分析 minmod 限制器的三个参数：$A = 2d_i^{-}$，$B = d_{c,i}$ 和 $C = 2d_i^{+}$。\n$$\nA = 2(2\\alpha x_i + \\beta - \\alpha h) = 2(d_{c,i} - \\alpha h)\n$$\n$$\nB = d_{c,i}\n$$\n$$\nC = 2(2\\alpha x_i + \\beta + \\alpha h) = 2(d_{c,i} + \\alpha h)\n$$\n\n问题假设这三个参数的符号相同。因此，minmod 函数将返回符号与三者相同、绝对值最小的那个参数。\n$$\ns_i = \\mathrm{sign}(B) \\min(|A|, |B|, |C|)\n$$\n\n现在，我们利用局部光滑性条件来比较这三个参数的绝对值：\n$$\n|\\alpha| h \\le \\frac{1}{2} |2\\alpha x_i + \\beta| \\quad \\Rightarrow \\quad |d_{c,i}| \\ge 2|\\alpha h|\n$$\n这个条件保证了 $|d_{c,i}|, |d_{c,i} - \\alpha h|, |d_{c,i} + \\alpha h|$ 的符号都与 $d_{c,i}$ 相同。\n\n比较 $|B|$ 与 $|A|$ 和 $|C|$：\n我们需要证明 $|B| \\le |A|$ 和 $|B| \\le |C|$。\n$|B| \\le |A| \\Leftrightarrow |d_{c,i}| \\le 2|d_{c,i} - \\alpha h|$。由于符号相同，这等价于 $(d_{c,i})^2 \\le 4(d_{c,i} - \\alpha h)^2$，展开后得到 $3(d_{c,i})^2 - 8d_{c,i}(\\alpha h) + 4(\\alpha h)^2 \\ge 0$。这个关于 $d_{c,i}$ 的二次不等式在 $|d_{c,i}| \\ge 2|\\alpha h|$ 时成立。给定的光滑性条件恰好满足此要求。\n同理可证，不等式 $|B| \\le |C| \\Leftrightarrow |d_{c,i}| \\le 2|d_{c,i} + \\alpha h|$ 也在光滑性条件下成立。\n\n因此，$|B| = |d_{c,i}|$ 是三个参数绝对值中的最小值。\n代入 $s_i$ 的表达式：\n$$\ns_i = \\mathrm{sign}(d_{c,i}) \\cdot |d_{c,i}| = d_{c,i}\n$$\n\n最终，限制斜率等于中心差分斜率，也就是在 $x_i$ 处的精确导数：\n$$\ns_i = 2\\alpha x_i + \\beta\n$$\n这表明，对于光滑的二次函数剖面，该限制器能够恢复二阶精度，因为它选择了能够精确表示导数的中心差分，而没有被单边差分不必要地限制。",
            "answer": "$$ \\boxed{2\\alpha x_i + \\beta} $$"
        },
        {
            "introduction": "理论和动机最终必须转化为可行的算法。这最后一个练习将迎风和斜率限制器的概念整合到一个完整的二阶MUSCL有限体积格式中。通过计算一个时间步内的数值通量并更新解，您将获得在计算聚变科学中广泛使用的这种方法的实际实现经验。",
            "id": "4061484",
            "problem": "考虑在托卡马克芯部，一个归一化标量 $n(s,t)$ 沿闭合磁通量面的场向一维平流，其由守恒形式的偏微分方程（PDE）建模\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{\\partial}{\\partial s}\\!\\left(v_{\\parallel}\\,n\\right) \\;=\\; S(s,t),\n$$\n其中 $s$ 是沿磁场的弧长坐标，$v_{\\parallel}$ 是恒定的平行平流速度，$S$ 是一个源项。在一个包含三个宽度为 $\\Delta s$ 的单元的均匀有限体积网格上，设初始的单元中心值为\n$$\nn_1 = 1,\\quad n_2 = 0.5,\\quad n_3 = 0.2,\n$$\n采用周期性边界条件，因此 $n_0 \\equiv n_3$ 且 $n_4 \\equiv n_1$。使用带有 minmod 限制器的二阶守恒律单调上游中心格式（MUSCL）重构来获得界面值。具体来说，定义限制斜率\n$$\n\\sigma_i \\;=\\; \\operatorname{minmod}\\!\\left(\\frac{n_i - n_{i-1}}{\\Delta s},\\,\\frac{n_{i+1} - n_i}{\\Delta s}\\right),\n$$\n其中\n$$\n\\operatorname{minmod}(a,b) \\;=\\; \\begin{cases}\n\\phantom{-}\\min(|a|,|b|),  \\text{if } a>0 \\text{ and } b>0, \\\\[4pt]\n-\\min(|a|,|b|),  \\text{if } a0 \\text{ and } b0, \\\\[4pt]\n0,  \\text{otherwise},\n\\end{cases}\n$$\n并从单元 $i$ 重构在界面 $i+\\tfrac{1}{2}$ 处的左状态为\n$$\nn_{i+\\frac{1}{2}}^{L} \\;=\\; n_i + \\frac{\\Delta s}{2}\\,\\sigma_i,\n$$\n并从单元 $i+1$ 重构在界面 $i+\\tfrac{1}{2}$ 处的右状态为\n$$\nn_{i+\\frac{1}{2}}^{R} \\;=\\; n_{i+1} - \\frac{\\Delta s}{2}\\,\\sigma_{i+1}.\n$$\n对于恒定的正平行速度 $v_{\\parallel}>0$，使用迎风格式定义界面 $i+\\tfrac{1}{2}$ 处的数值通量为\n$$\nF_{i+\\frac{1}{2}} \\;=\\; v_{\\parallel}\\,n_{i+\\frac{1}{2}}^{L}.\n$$\n使用以下公式将有限体积解推进一个时间步长\n$$\nn_i^{\\text{new}} \\;=\\; n_i^{\\text{old}} \\;-\\; \\frac{\\Delta t}{\\Delta s}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right) \\;+\\; \\Delta t\\,S_i,\n$$\n其中对所有 $i$ 都有 $S_i=0$。\n\n给定 $v_{\\parallel} = 2\\times 10^{4}\\,\\mathrm{m/s}$，$\\Delta s = 5\\,\\mathrm{mm}$，$\\Delta t = 0.1\\,\\mu\\mathrm{s}$，以及初始的 $n=\\{1,\\,0.5,\\,0.2\\}$（带周期性索引），计算：\n- 迎风通量 $F_{1+\\frac{1}{2}}$，$F_{2+\\frac{1}{2}}$ 和 $F_{3+\\frac{1}{2}}$（均以 $\\mathrm{m/s}$ 为单位表示），以及\n- 更新后的单元中心值 $n_1^{\\text{new}}$，$n_2^{\\text{new}}$ 和 $n_3^{\\text{new}}$（无量纲）。\n\n请按以下顺序以单行矩阵的形式提供最终答案\n$$\n\\left(F_{1+\\frac{1}{2}},\\;F_{2+\\frac{1}{2}},\\;F_{3+\\frac{1}{2}},\\;n_1^{\\text{new}},\\;n_2^{\\text{new}},\\;n_3^{\\text{new}}\\right),\n$$\n无需舍入说明。",
            "solution": "我们继续进行求解。目标是计算一个时间步长后的数值通量 $F_{1+\\frac{1}{2}}$、$F_{2+\\frac{1}{2}}$ 和 $F_{3+\\frac{1}{2}}$，以及更新后的单元中心值 $n_1^{\\text{new}}$、$n_2^{\\text{new}}$ 和 $n_3^{\\text{new}}$。\n\n给定的初始单元中心值为：\n$$\nn_1 = 1, \\quad n_2 = 0.5, \\quad n_3 = 0.2\n$$\n问题指定了一个 3 单元域上的周期性边界条件。为了计算斜率，我们需要来自相邻单元的值。我们定义“虚拟”单元 $n_0$ 和 $n_4$ 为：\n$$\nn_0 \\equiv n_3 = 0.2\n$$\n$$\nn_4 \\equiv n_1 = 1\n$$\n因此，扩展的单元中心值数组为 $(n_0, n_1, n_2, n_3, n_4) = (0.2, 1, 0.5, 0.2, 1)$。\n\n给定的物理和数值参数为：\n$$\nv_{\\parallel} = 2 \\times 10^4 \\, \\mathrm{m/s}\n$$\n$$\n\\Delta s = 5 \\, \\mathrm{mm} = 5 \\times 10^{-3} \\, \\mathrm{m}\n$$\n$$\n\\Delta t = 0.1 \\, \\mu\\mathrm{s} = 1 \\times 10^{-7} \\, \\mathrm{s}\n$$\n\n计算分四步进行。\n\n**第一步：计算 $i=1, 2, 3$ 的限制斜率 $\\sigma_i$。**\n单元 $i$ 中的限制斜率由 $\\sigma_i = \\operatorname{minmod}(\\frac{n_i - n_{i-1}}{\\Delta s}, \\frac{n_{i+1} - n_i}{\\Delta s})$ 给出。\n\n对于单元 $i=1$：\nminmod 函数的两个参数是：\n$$\na = \\frac{n_1 - n_0}{\\Delta s} = \\frac{1 - 0.2}{\\Delta s} = \\frac{0.8}{\\Delta s} > 0\n$$\n$$\nb = \\frac{n_2 - n_1}{\\Delta s} = \\frac{0.5 - 1}{\\Delta s} = \\frac{-0.5}{\\Delta s}  0\n$$\n由于 $a$ 和 $b$ 符号相反，限制斜率为零：\n$$\n\\sigma_1 = \\operatorname{minmod}(a,b) = 0\n$$\n\n对于单元 $i=2$：\nminmod 函数的两个参数是：\n$$\na = \\frac{n_2 - n_1}{\\Delta s} = \\frac{0.5 - 1}{\\Delta s} = \\frac{-0.5}{\\Delta s}  0\n$$\n$$\nb = \\frac{n_3 - n_2}{\\Delta s} = \\frac{0.2 - 0.5}{\\Delta s} = \\frac{-0.3}{\\Delta s}  0\n$$\n由于 $a$ 和 $b$ 均为负，限制斜率为：\n$$\n\\sigma_2 = -\\min\\left(\\left|\\frac{-0.5}{\\Delta s}\\right|, \\left|\\frac{-0.3}{\\Delta s}\\right|\\right) = -\\min\\left(\\frac{0.5}{\\Delta s}, \\frac{0.3}{\\Delta s}\\right) = -\\frac{0.3}{\\Delta s}\n$$\n\n对于单元 $i=3$：\nminmod 函数的两个参数是：\n$$\na = \\frac{n_3 - n_2}{\\Delta s} = \\frac{0.2 - 0.5}{\\Delta s} = \\frac{-0.3}{\\Delta s}  0\n$$\n$$\nb = \\frac{n_4 - n_3}{\\Delta s} = \\frac{1 - 0.2}{\\Delta s} = \\frac{0.8}{\\Delta s} > 0\n$$\n由于 $a$ 和 $b$ 符号相反，限制斜率为零：\n$$\n\\sigma_3 = \\operatorname{minmod}(a,b) = 0\n$$\n\n**第二步：重构左偏界面值 $n_{i+\\frac{1}{2}}^{L}$。**\n由于平流速度 $v_{\\parallel}$ 为正，界面 $i+\\frac{1}{2}$ 处的迎风通量由从左侧单元 $i$ 重构的状态确定。单元 $i$ 右界面的重构值为 $n_{i+\\frac{1}{2}}^{L} = n_i + \\frac{\\Delta s}{2}\\sigma_i$。\n\n对于界面 $1+\\frac{1}{2}$：\n$$\nn_{1+\\frac{1}{2}}^{L} = n_1 + \\frac{\\Delta s}{2}\\sigma_1 = 1 + \\frac{\\Delta s}{2}(0) = 1\n$$\n\n对于界面 $2+\\frac{1}{2}$：\n$$\nn_{2+\\frac{1}{2}}^{L} = n_2 + \\frac{\\Delta s}{2}\\sigma_2 = 0.5 + \\frac{\\Delta s}{2}\\left(-\\frac{0.3}{\\Delta s}\\right) = 0.5 - \\frac{0.3}{2} = 0.5 - 0.15 = 0.35\n$$\n\n对于界面 $3+\\frac{1}{2}$：\n$$\nn_{3+\\frac{1}{2}}^{L} = n_3 + \\frac{\\Delta s}{2}\\sigma_3 = 0.2 + \\frac{\\Delta s}{2}(0) = 0.2\n$$\n\n**第三步：计算迎风数值通量 $F_{i+\\frac{1}{2}}$。**\n数值通量为 $F_{i+\\frac{1}{2}} = v_{\\parallel}\\,n_{i+\\frac{1}{2}}^{L}$。\n\n对于界面 $1+\\frac{1}{2}$：\n$$\nF_{1+\\frac{1}{2}} = v_{\\parallel}\\,n_{1+\\frac{1}{2}}^{L} = (2 \\times 10^4 \\, \\mathrm{m/s})(1) = 20000 \\, \\mathrm{m/s}\n$$\n\n对于界面 $2+\\frac{1}{2}$：\n$$\nF_{2+\\frac{1}{2}} = v_{\\parallel}\\,n_{2+\\frac{1}{2}}^{L} = (2 \\times 10^4 \\, \\mathrm{m/s})(0.35) = 7000 \\, \\mathrm{m/s}\n$$\n\n对于界面 $3+\\frac{1}{2}$：\n$$\nF_{3+\\frac{1}{2}} = v_{\\parallel}\\,n_{3+\\frac{1}{2}}^{L} = (2 \\times 10^4 \\, \\mathrm{m/s})(0.2) = 4000 \\, \\mathrm{m/s}\n$$\n\n**第四步：更新单元中心值 $n_i^{\\text{new}}$。**\n时间更新公式为 $n_i^{\\text{new}} = n_i^{\\text{old}} - \\frac{\\Delta t}{\\Delta s}(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}})$。由于周期性，单元 1 左界面的通量 $F_{1-\\frac{1}{2}}$ 与单元 3 右界面的通量 $F_{3+\\frac{1}{2}}$ 相同。\n更新的前置因子为：\n$$\n\\frac{\\Delta t}{\\Delta s} = \\frac{1 \\times 10^{-7} \\, \\mathrm{s}}{5 \\times 10^{-3} \\, \\mathrm{m}} = 2 \\times 10^{-5} \\, \\mathrm{s/m}\n$$\n\n对于单元 $i=1$：\n$$\nn_1^{\\text{new}} = n_1 - \\frac{\\Delta t}{\\Delta s}(F_{1+\\frac{1}{2}} - F_{3+\\frac{1}{2}}) = 1 - (2 \\times 10^{-5})(20000 - 4000) = 1 - (2 \\times 10^{-5})(16000) = 1 - 0.32 = 0.68\n$$\n\n对于单元 $i=2$：\n$$\nn_2^{\\text{new}} = n_2 - \\frac{\\Delta t}{\\Delta s}(F_{2+\\frac{1}{2}} - F_{1+\\frac{1}{2}}) = 0.5 - (2 \\times 10^{-5})(7000 - 20000) = 0.5 - (2 \\times 10^{-5})(-13000) = 0.5 + 0.26 = 0.76\n$$\n\n对于单元 $i=3$：\n$$\nn_3^{\\text{new}} = n_3 - \\frac{\\Delta t}{\\Delta s}(F_{3+\\frac{1}{2}} - F_{2+\\frac{1}{2}}) = 0.2 - (2 \\times 10^{-5})(4000 - 7000) = 0.2 - (2 \\times 10^{-5})(-3000) = 0.2 + 0.06 = 0.26\n$$\n\n计算出的值为：\n通量：$F_{1+\\frac{1}{2}} = 20000 \\, \\mathrm{m/s}$，$F_{2+\\frac{1}{2}} = 7000 \\, \\mathrm{m/s}$，$F_{3+\\frac{1}{2}} = 4000 \\, \\mathrm{m/s}$。\n更新后的密度：$n_1^{\\text{new}} = 0.68$，$n_2^{\\text{new}} = 0.76$，$n_3^{\\text{new}} = 0.26$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 20000  7000  4000  0.68  0.76  0.26 \\end{pmatrix}}\n$$"
        }
    ]
}