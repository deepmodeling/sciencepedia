{
    "hands_on_practices": [
        {
            "introduction": "Before exploring advanced methods, it's crucial to understand the fundamental challenges of discretizing advection equations. This first practice directly compares two basic approaches: central differencing and first-order upwinding. By applying these schemes to a sharp step-function profile, you will observe and quantify the classic numerical artifacts of non-physical oscillations and excessive diffusion, setting the stage for why more sophisticated, monotonicity-preserving schemes are essential in computational science .",
            "id": "4061462",
            "problem": "Consider the one-dimensional linear advection equation $\\partial_t u + a\\,\\partial_x u = 0$ modeling the passive advection of a scalar edge profile in a fusion edge-transport benchmark, where the advection speed is $a = 10^{4}\\,\\mathrm{m/s}$. The computational grid is uniform with spacing $\\Delta x = 1\\,\\mathrm{mm}$ and cell centers located at $x_j = j\\,\\Delta x$, for integer $j$. The initial data are a unit step located at the interface $x=0$, defined on cell centers by $u_j^{0} = 1$ for $j \\geq 0$ and $u_j^{0} = 0$ for $j  0$. Use a single forward Euler time step $\\Delta t = 5.0 \\times 10^{-8}\\,\\mathrm{s}$.\n\nStarting from the governing equation and the standard definitions of discrete approximations to spatial derivatives, derive the one-step update formulas for:\n- the forward Euler method with spatial central differencing for $\\partial_x u$, and\n- the forward Euler method with upwind differencing appropriate for positive $a$.\n\nApply each scheme to the given initial data and compute the new values $u_j^{1}$ at and near the discontinuity. Then, using the definition of total variation $TV(u) = \\sum_{j} |u_{j+1} - u_j|$ on the grid, compute the change in total variation after one step for each scheme, $\\Delta TV_{\\mathrm{central}} = TV(u^{1}_{\\mathrm{central}}) - TV(u^{0})$ and $\\Delta TV_{\\mathrm{upwind}} = TV(u^{1}_{\\mathrm{upwind}}) - TV(u^{0})$.\n\nFinally, report the single dimensionless quantity $\\Delta TV_{\\mathrm{central}} - \\Delta TV_{\\mathrm{upwind}}$. This difference serves as a quantitative comparison of overshoot (non-monotone oscillations) versus smearing (diffusive spreading). Express the final answer as a single real number. No rounding is required. Define any acronym you use at first mention (for example, Courant–Friedrichs–Lewy (CFL) or Total Variation Diminishing (TVD)).",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and complete. All necessary data and definitions are provided, and there are no internal contradictions or violations of physical principles. We may proceed with the solution.\n\nThe problem asks for an analysis of two numerical schemes for the one-dimensional linear advection equation:\n$$\n\\partial_t u + a\\,\\partial_x u = 0\n$$\nwhere the advection speed is $a = 10^{4}\\,\\mathrm{m/s}$. The discretization parameters are given as grid spacing $\\Delta x = 1\\,\\mathrm{mm} = 10^{-3}\\,\\mathrm{m}$ and time step $\\Delta t = 5.0 \\times 10^{-8}\\,\\mathrm{s}$. A key dimensionless parameter is the Courant–Friedrichs–Lewy (CFL) number, $\\nu$, defined as:\n$$\n\\nu = a \\frac{\\Delta t}{\\Delta x}\n$$\nSubstituting the given values:\n$$\n\\nu = (10^{4}\\,\\mathrm{m/s}) \\frac{5.0 \\times 10^{-8}\\,\\mathrm{s}}{10^{-3}\\,\\mathrm{m}} = 10^{4} \\times 5.0 \\times 10^{-8} \\times 10^{3} = 5.0 \\times 10^{-1} = 0.5\n$$\nThe value of the CFL number is $\\nu = 0.5$.\n\nWe will use a forward Euler time discretization. The semi-discrete form of the advection equation at grid point $x_j$ is $\\frac{du_j}{dt} = -a (\\partial_x u)_j$. Applying the forward Euler method, where $u_j^n$ approximates the solution at time $t_n = n\\Delta t$, gives:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -a (\\partial_x u)_j^n\n$$\nwhere $(\\partial_x u)_j^n$ is the discrete approximation to the spatial derivative at time $t_n$. This can be rearranged to the general one-step update formula:\n$$\nu_j^{n+1} = u_j^n - a \\frac{\\Delta t}{\\Delta x} (\\Delta x (\\partial_x u)_j^n) = u_j^n - \\nu (\\Delta x (\\partial_x u)_j^n)\n$$\n\nFirst, we derive the update formula for the two specified spatial discretization schemes.\n\n1.  **Forward Euler with Central Differencing:**\n    The second-order accurate central difference approximation for the spatial derivative at $x_j$ is:\n    $$\n    (\\partial_x u)_j^n \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x}\n    $$\n    Substituting this into the general update formula yields:\n    $$\n    u_j^{n+1} = u_j^n - \\nu \\left( \\Delta x \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x} \\right) \\right) = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n)\n    $$\n\n2.  **Forward Euler with Upwind Differencing:**\n    For a positive advection speed ($a > 0$), the \"upwind\" direction is the negative $x$-direction (from smaller index $j$). The first-order accurate upwind scheme uses a backward difference:\n    $$\n    (\\partial_x u)_j^n \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}\n    $$\n    Substituting this into the general update formula gives:\n    $$\n    u_j^{n+1} = u_j^n - \\nu \\left( \\Delta x \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) \\right) = u_j^n - \\nu (u_j^n - u_{j-1}^n)\n    $$\n    This can also be written as $u_j^{n+1} = (1-\\nu)u_j^n + \\nu u_{j-1}^n$.\n\nNext, we apply each scheme for one time step to the given initial data. The initial condition is a step function:\n$$\nu_j^0 = \\begin{cases} 0  \\text{for } j  0 \\\\ 1  \\text{for } j \\geq 0 \\end{cases}\n$$\nSo, the initial grid values are $... , u_{-2}^0=0, u_{-1}^0=0, u_0^0=1, u_1^0=1, u_2^0=1, ...$. We use $\\nu=0.5$.\n\n- **Application of the Central Scheme ($u_j^{1, \\mathrm{central}}$):**\n  $u_j^1 = u_j^0 - \\frac{0.5}{2}(u_{j+1}^0 - u_{j-1}^0) = u_j^0 - 0.25(u_{j+1}^0 - u_{j-1}^0)$. We compute the new values at and near the discontinuity:\n  - For $j \\leq -2$: $u_{j+1}^0=0$ and $u_{j-1}^0=0$, so $u_j^1 = u_j^0 - 0.25(0-0) = 0$.\n  - For $j = -1$: $u_{-1}^1 = u_{-1}^0 - 0.25(u_0^0 - u_{-2}^0) = 0 - 0.25(1 - 0) = -0.25$. This shows a non-physical undershoot.\n  - For $j = 0$: $u_0^1 = u_0^0 - 0.25(u_1^0 - u_{-1}^0) = 1 - 0.25(1 - 0) = 0.75$.\n  - For $j \\geq 1$: $u_{j+1}^0=1$ and $u_{j-1}^0=1$ (since $j-1 \\ge 0$), so $u_j^1 = u_j^0 - 0.25(1-1) = u_j^0 = 1$.\n  The state after one step is $u^1_{\\mathrm{central}}: ..., 0, 0, -0.25, 0.75, 1, 1, ...$\n\n- **Application of the Upwind Scheme ($u_j^{1, \\mathrm{upwind}}$):**\n  $u_j^1 = u_j^0 - 0.5(u_j^0 - u_{j-1}^0)$.\n  - For $j \\leq -1$: $u_j^0=0$ and $u_{j-1}^0=0$, so $u_j^1 = 0 - 0.5(0-0) = 0$.\n  - For $j = 0$: $u_0^1 = u_0^0 - 0.5(u_0^0 - u_{-1}^0) = 1 - 0.5(1 - 0) = 0.5$. The step is smeared.\n  - For $j \\geq 1$: $u_j^0=1$ and $u_{j-1}^0=1$ (since $j-1 \\ge 0$), so $u_j^1 = 1 - 0.5(1-1) = 1$.\n  The state after one step is $u^1_{\\mathrm{upwind}}: ..., 0, 0, 0, 0.5, 1, 1, ...$\n\nNow, we compute the Total Variation (TV) for each state. The TV is defined as $TV(u) = \\sum_{j} |u_{j+1} - u_j|$.\n- **Initial Total Variation $TV(u^0)$:**\n  The only non-zero difference is between $j=-1$ and $j=0$.\n  $$ TV(u^0) = \\sum_j |u_{j+1}^0 - u_j^0| = |u_0^0 - u_{-1}^0| = |1 - 0| = 1 $$\n\n- **Total Variation for Central Scheme $TV(u^1_{\\mathrm{central}})$:**\n  The non-zero differences occur around the original step.\n  $|u_{-1}^1 - u_{-2}^1| = |-0.25 - 0| = 0.25$.\n  $|u_0^1 - u_{-1}^1| = |0.75 - (-0.25)| = |1.0| = 1.0$.\n  $|u_1^1 - u_0^1| = |1 - 0.75| = 0.25$.\n  All other differences are zero.\n  $$ TV(u^1_{\\mathrm{central}}) = 0.25 + 1.0 + 0.25 = 1.5 $$\n  The change in total variation is $\\Delta TV_{\\mathrm{central}} = TV(u^1_{\\mathrm{central}}) - TV(u^0) = 1.5 - 1 = 0.5$. The increase in TV is a direct consequence of the creation of new extrema (the undershoot).\n\n- **Total Variation for Upwind Scheme $TV(u^1_{\\mathrm{upwind}})$:**\n  The non-zero differences are:\n  $|u_0^1 - u_{-1}^1| = |0.5 - 0| = 0.5$.\n  $|u_1^1 - u_0^1| = |1 - 0.5| = 0.5$.\n  All other differences are zero.\n  $$ TV(u^1_{\\mathrm{upwind}}) = 0.5 + 0.5 = 1.0 $$\n  The change in total variation is $\\Delta TV_{\\mathrm{upwind}} = TV(u^1_{\\mathrm{upwind}}) - TV(u^0) = 1.0 - 1 = 0$. The total variation is conserved in this case. A numerical scheme for which $TV(u^{n+1}) \\leq TV(u^n)$ is called Total Variation Diminishing (TVD). The first-order upwind scheme is TVD for $\\nu \\in [0, 1]$.\n\nFinally, we compute the requested quantity:\n$$\n\\Delta TV_{\\mathrm{central}} - \\Delta TV_{\\mathrm{upwind}} = 0.5 - 0 = 0.5\n$$\nThis positive value quantifies the degree to which the central difference scheme generates spurious oscillations (increasing TV) compared to the upwind scheme, which is monotone but more diffusive (smearing the step without increasing TV).",
            "answer": "$$\\boxed{0.5}$$"
        },
        {
            "introduction": "To overcome the dilemma of choosing between oscillatory and diffusive schemes, high-resolution methods employ \"flux limiters\" that dynamically adjust the scheme's accuracy. This exercise introduces the core mechanics of this approach by examining several widely-used limiter functions—minmod, van Leer, MC, and superbee. By calculating their effect on a smooth, linear profile, you will see how these limiters are designed to revert to higher-order accuracy in regions where the solution is well-behaved, thereby minimizing numerical errors without introducing spurious oscillations .",
            "id": "4061467",
            "problem": "A one-dimensional model for parallel convective transport of a passively advected scalar along magnetic field lines in the scrape-off layer of a tokamak can be represented by the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant speed $a0$. Consider a uniform grid with spacing $\\Delta x$ and explicit time step $\\Delta t$, and denote the Courant–Friedrichs–Lewy (CFL) number by $\\lambda = a\\,\\Delta t/\\Delta x$. A high-resolution Total Variation Diminishing (TVD) method augments the first-order upwind Godunov flux with a conservative, limiter-controlled antidiffusive correction. For $a0$, define the ratio of successive gradients at cell $i$ by\n$r_{i} = \\dfrac{u_{i} - u_{i-1}}{u_{i+1} - u_{i}}$\nwhenever the denominator is nonzero. The limited high-order correction that enters the numerical flux at the interface $x_{i+1/2}$ is proportional to the slope-like quantity\n$s_{i} = \\dfrac{1}{2}\\,\\phi(r_{i})\\,(1 - \\lambda)\\,(u_{i+1} - u_{i})$,\nwhere $\\phi(r)$ is a limiter function chosen from a TVD-admissible family.\n\nAt a given time level, suppose the discrete sequence satisfies $u_{i-1} = 0$, $u_{i} = 1$, $u_{i+1} = 2$, and the Courant–Friedrichs–Lewy (CFL) number is $\\lambda = 0.8$. Using the standard definitions of the minmod, van Leer, monotonized central (MC), and superbee limiters, compute $r_{i}$ and the corresponding limited correction $s_{i}$ for each of these four limiters. Report, as your final answer, the sum of the four limited corrections\n$S = s_{i}^{\\text{minmod}} + s_{i}^{\\text{van Leer}} + s_{i}^{\\text{MC}} + s_{i}^{\\text{superbee}}$.\nProvide the exact value; no rounding is required. The final answer must be a single real number without units.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It provides a standard exercise in the application of flux limiters within the context of high-resolution Total Variation Diminishing (TVD) schemes for hyperbolic conservation laws, a core topic in computational science and engineering.\n\nThe problem asks for the sum of limited high-order corrections, $S = s_{i}^{\\text{minmod}} + s_{i}^{\\text{van Leer}} + s_{i}^{\\text{MC}} + s_{i}^{\\text{superbee}}$, for the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$, given a specific discrete data profile and Courant–Friedrichs–Lewy (CFL) number.\n\nThe solution proceeds in several steps. First, we compute the ratio of successive gradients, $r_{i}$. Second, we evaluate the four specified limiter functions, $\\phi(r_{i})$, at this value. Finally, we compute the corresponding correction terms, $s_{i}$, and sum them.\n\nThe problem provides the following data:\n- The discrete sequence of the scalar field $u$ at cells $i-1$, $i$, and $i+1$: $u_{i-1} = 0$, $u_{i} = 1$, and $u_{i+1} = 2$.\n- The CFL number: $\\lambda = 0.8$.\n- The advection speed is positive, $a0$.\n\nThe ratio of successive gradients at cell $i$ is defined as:\n$$r_{i} = \\dfrac{u_{i} - u_{i-1}}{u_{i+1} - u_{i}}$$\nSubstituting the given values, we compute $r_{i}$:\n$$r_{i} = \\dfrac{1 - 0}{2 - 1} = \\dfrac{1}{1} = 1$$\nThe value of the gradient ratio is $r_{i} = 1$. This indicates that the discrete solution profile is locally linear, with a constant slope across the cells $i-1$, $i$, and $i+1$.\n\nThe limited high-order correction term, $s_{i}$, is given by the formula:\n$$s_{i} = \\dfrac{1}{2}\\,\\phi(r_{i})\\,(1 - \\lambda)\\,(u_{i+1} - u_{i})$$\nWe need to evaluate this expression for each of the four specified limiter functions $\\phi(r)$. The common factor in the expression for $s_i$ can be calculated first:\n$$(1 - \\lambda) = (1 - 0.8) = 0.2$$\n$$(u_{i+1} - u_{i}) = (2 - 1) = 1$$\nThus, the expression for $s_i$ simplifies to:\n$$s_{i} = \\dfrac{1}{2}\\,\\phi(1)\\,(0.2)\\,(1) = 0.1\\,\\phi(1)$$\n\nNow, we evaluate each limiter function at $r=1$.\n1.  **Minmod limiter:** The standard definition is $\\phi_{\\text{minmod}}(r) = \\max(0, \\min(1, r))$.\n    At $r=1$:\n    $$\\phi_{\\text{minmod}}(1) = \\max(0, \\min(1, 1)) = \\max(0, 1) = 1$$\n    The corresponding correction is:\n    $$s_{i}^{\\text{minmod}} = 0.1 \\times \\phi_{\\text{minmod}}(1) = 0.1 \\times 1 = 0.1$$\n\n2.  **Van Leer limiter:** The standard definition for $r  0$ is $\\phi_{\\text{van Leer}}(r) = \\dfrac{2r}{1+r}$.\n    At $r=1$:\n    $$\\phi_{\\text{van Leer}}(1) = \\dfrac{2 \\times 1}{1 + 1} = \\dfrac{2}{2} = 1$$\n    The corresponding correction is:\n    $$s_{i}^{\\text{van Leer}} = 0.1 \\times \\phi_{\\text{van Leer}}(1) = 0.1 \\times 1 = 0.1$$\n\n3.  **Monotonized Central (MC) limiter:** The standard definition is $\\phi_{\\text{MC}}(r) = \\max(0, \\min(2r, \\frac{1+r}{2}, 2))$.\n    At $r=1$:\n    $$\\phi_{\\text{MC}}(1) = \\max\\left(0, \\min\\left(2 \\times 1, \\dfrac{1+1}{2}, 2\\right)\\right) = \\max(0, \\min(2, 1, 2)) = \\max(0, 1) = 1$$\n    The corresponding correction is:\n    $$s_{i}^{\\text{MC}} = 0.1 \\times \\phi_{\\text{MC}}(1) = 0.1 \\times 1 = 0.1$$\n\n4.  **Superbee limiter:** The standard definition is $\\phi_{\\text{superbee}}(r) = \\max(0, \\min(2r, 1), \\min(r, 2))$.\n    At $r=1$:\n    $$\\phi_{\\text{superbee}}(1) = \\max(0, \\min(2 \\times 1, 1), \\min(1, 2)) = \\max(0, \\min(2, 1), \\min(1, 2)) = \\max(0, 1, 1) = 1$$\n    The corresponding correction is:\n    $$s_{i}^{\\text{superbee}} = 0.1 \\times \\phi_{\\text{superbee}}(1) = 0.1 \\times 1 = 0.1$$\n\nAll four limiters evaluate to $\\phi(1) = 1$. This is a fundamental property of standard limiters, ensuring that for smooth, monotonic regions of the solution (where $r \\approx 1$), the scheme reverts to a second-order accurate method, thereby minimizing numerical diffusion.\n\nFinally, we compute the required sum $S$:\n$$S = s_{i}^{\\text{minmod}} + s_{i}^{\\text{van Leer}} + s_{i}^{\\text{MC}} + s_{i}^{\\text{superbee}}$$\n$$S = 0.1 + 0.1 + 0.1 + 0.1 = 0.4$$\nThe sum of the four limited corrections is $0.4$.",
            "answer": "$$\\boxed{0.4}$$"
        },
        {
            "introduction": "This final practice integrates the concepts of upwinding and slope limiting into a complete, practical calculation using the Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) method. You will perform a full time step for a plasma advection problem, from calculating slopes and applying the minmod limiter to reconstructing interface states and updating cell-averaged values. This comprehensive exercise provides a concrete, step-by-step demonstration of how these components work in concert to produce a stable and accurate solution in the presence of sharp gradients .",
            "id": "4061484",
            "problem": "Consider a one-dimensional field-aligned advection of a normalized scalar $n(s,t)$ along a closed magnetic flux surface in a tokamak core modeled by the conservation form Partial Differential Equation (PDE)\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{\\partial}{\\partial s}\\!\\left(v_{\\parallel}\\,n\\right) \\;=\\; S(s,t),\n$$\nwhere $s$ is the arc-length coordinate along the magnetic field, $v_{\\parallel}$ is the constant parallel advection speed, and $S$ is a source term. On a uniform finite-volume mesh with three cells of width $\\Delta s$, let the initial cell-centered values be\n$$\nn_1 = 1,\\quad n_2 = 0.5,\\quad n_3 = 0.2,\n$$\nwith periodic boundary conditions, so that $n_0 \\equiv n_3$ and $n_4 \\equiv n_1$. Use the second-order Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) reconstruction with the minmod limiter to obtain face values. Specifically, define the limited slope\n$$\n\\sigma_i \\;=\\; \\operatorname{minmod}\\!\\left(\\frac{n_i - n_{i-1}}{\\Delta s},\\,\\frac{n_{i+1} - n_i}{\\Delta s}\\right),\n$$\nwhere\n$$\n\\operatorname{minmod}(a,b) \\;=\\; \\begin{cases}\n\\phantom{-}\\min(|a|,|b|),  \\text{if } a>0 \\text{ and } b>0, \\\\\n-\\min(|a|,|b|),  \\text{if } a0 \\text{ and } b0, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\nand reconstruct the left state at interface $i+\\tfrac{1}{2}$ from cell $i$ as\n$$\nn_{i+\\frac{1}{2}}^{L} \\;=\\; n_i + \\frac{\\Delta s}{2}\\,\\sigma_i,\n$$\nand the right state at interface $i+\\tfrac{1}{2}$ from cell $i+1$ as\n$$\nn_{i+\\frac{1}{2}}^{R} \\;=\\; n_{i+1} - \\frac{\\Delta s}{2}\\,\\sigma_{i+1}.\n$$\nWith a constant positive parallel speed $v_{\\parallel}0$, use upwinding to define the numerical flux at interface $i+\\tfrac{1}{2}$ as\n$$\nF_{i+\\frac{1}{2}} \\;=\\; v_{\\parallel}\\,n_{i+\\frac{1}{2}}^{L}.\n$$\nAdvance the finite-volume solution by one time step using\n$$\nn_i^{\\text{new}} \\;=\\; n_i^{\\text{old}} \\;-\\; \\frac{\\Delta t}{\\Delta s}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right) \\;+\\; \\Delta t\\,S_i,\n$$\nwith $S_i=0$ for all $i$.\n\nGiven $v_{\\parallel} = 2\\times 10^{4}\\,\\mathrm{m/s}$, $\\Delta s = 5\\,\\mathrm{mm}$, $\\Delta t = 0.1\\,\\mu\\mathrm{s}$, and the initial $n=\\{1,\\,0.5,\\,0.2\\}$ with periodic indexing, compute:\n- the upwind fluxes $F_{1+\\frac{1}{2}}$, $F_{2+\\frac{1}{2}}$, and $F_{3+\\frac{1}{2}}$ (express each in $\\mathrm{m/s}$), and\n- the updated cell-centered values $n_1^{\\text{new}}$, $n_2^{\\text{new}}$, and $n_3^{\\text{new}}$ (dimensionless).\n\nProvide your final answer as a single row matrix in the order\n$$\n\\left(F_{1+\\frac{1}{2}},\\;F_{2+\\frac{1}{2}},\\;F_{3+\\frac{1}{2}},\\;n_1^{\\text{new}},\\;n_2^{\\text{new}},\\;n_3^{\\text{new}}\\right),\n$$\nwith no rounding instructions required.",
            "solution": "The problem statement has been rigorously validated and is deemed valid. It is scientifically grounded in the principles of computational fluid dynamics and plasma physics, specifically the finite-volume method for solving hyperbolic conservation laws. The problem is well-posed, with all necessary data, initial conditions, boundary conditions, and numerical scheme parameters provided. The units are consistent, and the parameters ($v_{\\parallel}$, $\\Delta s$, $\\Delta t$) are physically plausible and satisfy the Courant-Friedrichs-Lewy (CFL) stability condition for explicit advection schemes, as the Courant number $C = v_{\\parallel} \\Delta t / \\Delta s = (2 \\times 10^4 \\, \\mathrm{m/s})(0.1 \\times 10^{-6} \\, \\mathrm{s}) / (5 \\times 10^{-3} \\, \\mathrm{m}) = 0.4 \\le 1$. The problem is objective, unambiguous, and requires a direct application of the specified MUSCL method.\n\nWe proceed with the solution. The goal is to compute the numerical fluxes $F_{1+\\frac{1}{2}}$, $F_{2+\\frac{1}{2}}$, and $F_{3+\\frac{1}{2}}$, and the updated cell-centered values $n_1^{\\text{new}}$, $n_2^{\\text{new}}$, and $n_3^{\\text{new}}$ after one time step.\n\nThe given initial cell-centered values are:\n$$\nn_1 = 1, \\quad n_2 = 0.5, \\quad n_3 = 0.2\n$$\nThe problem specifies periodic boundary conditions on a $3$-cell domain. To compute the slopes, we require values from neighboring cells. We define \"ghost\" cells $n_0$ and $n_4$ as:\n$$\nn_0 \\equiv n_3 = 0.2\n$$\n$$\nn_4 \\equiv n_1 = 1\n$$\nThe extended array of cell-centered values is thus $(n_0, n_1, n_2, n_3, n_4) = (0.2, 1, 0.5, 0.2, 1)$.\n\nThe given physical and numerical parameters are:\n$$\nv_{\\parallel} = 2 \\times 10^4 \\, \\mathrm{m/s}\n$$\n$$\n\\Delta s = 5 \\, \\mathrm{mm} = 5 \\times 10^{-3} \\, \\mathrm{m}\n$$\n$$\n\\Delta t = 0.1 \\, \\mu\\mathrm{s} = 1 \\times 10^{-7} \\, \\mathrm{s}\n$$\n\nThe calculation proceeds in four steps.\n\n**Step 1: Compute the limited slopes $\\sigma_i$ for $i=1, 2, 3$.**\nThe limited slope in cell $i$ is given by $\\sigma_i = \\operatorname{minmod}(\\frac{n_i - n_{i-1}}{\\Delta s}, \\frac{n_{i+1} - n_i}{\\Delta s})$.\n\nFor cell $i=1$:\nThe two arguments for the minmod function are:\n$$\na = \\frac{n_1 - n_0}{\\Delta s} = \\frac{1 - 0.2}{\\Delta s} = \\frac{0.8}{\\Delta s}  0\n$$\n$$\nb = \\frac{n_2 - n_1}{\\Delta s} = \\frac{0.5 - 1}{\\Delta s} = \\frac{-0.5}{\\Delta s}  0\n$$\nSince $a$ and $b$ have opposite signs, the limited slope is zero:\n$$\n\\sigma_1 = \\operatorname{minmod}(a,b) = 0\n$$\n\nFor cell $i=2$:\nThe two arguments for the minmod function are:\n$$\na = \\frac{n_2 - n_1}{\\Delta s} = \\frac{0.5 - 1}{\\Delta s} = \\frac{-0.5}{\\Delta s}  0\n$$\n$$\nb = \\frac{n_3 - n_2}{\\Delta s} = \\frac{0.2 - 0.5}{\\Delta s} = \\frac{-0.3}{\\Delta s}  0\n$$\nSince both $a$ and $b$ are negative, the limited slope is:\n$$\n\\sigma_2 = -\\min\\left(\\left|\\frac{-0.5}{\\Delta s}\\right|, \\left|\\frac{-0.3}{\\Delta s}\\right|\\right) = -\\min\\left(\\frac{0.5}{\\Delta s}, \\frac{0.3}{\\Delta s}\\right) = -\\frac{0.3}{\\Delta s}\n$$\n\nFor cell $i=3$:\nThe two arguments for the minmod function are:\n$$\na = \\frac{n_3 - n_2}{\\Delta s} = \\frac{0.2 - 0.5}{\\Delta s} = \\frac{-0.3}{\\Delta s}  0\n$$\n$$\nb = \\frac{n_4 - n_3}{\\Delta s} = \\frac{1 - 0.2}{\\Delta s} = \\frac{0.8}{\\Delta s}  0\n$$\nSince $a$ and $b$ have opposite signs, the limited slope is zero:\n$$\n\\sigma_3 = \\operatorname{minmod}(a,b) = 0\n$$\n\n**Step 2: Reconstruct the left-biased interface values $n_{i+\\frac{1}{2}}^{L}$.**\nSince the advection speed $v_{\\parallel}$ is positive, the upwind flux at interface $i+\\frac{1}{2}$ is determined by the state reconstructed from the left cell, $i$. The reconstructed value at the right face of cell $i$ is $n_{i+\\frac{1}{2}}^{L} = n_i + \\frac{\\Delta s}{2}\\sigma_i$.\n\nFor interface $1+\\frac{1}{2}$:\n$$\nn_{1+\\frac{1}{2}}^{L} = n_1 + \\frac{\\Delta s}{2}\\sigma_1 = 1 + \\frac{\\Delta s}{2}(0) = 1\n$$\n\nFor interface $2+\\frac{1}{2}$:\n$$\nn_{2+\\frac{1}{2}}^{L} = n_2 + \\frac{\\Delta s}{2}\\sigma_2 = 0.5 + \\frac{\\Delta s}{2}\\left(-\\frac{0.3}{\\Delta s}\\right) = 0.5 - \\frac{0.3}{2} = 0.5 - 0.15 = 0.35\n$$\n\nFor interface $3+\\frac{1}{2}$:\n$$\nn_{3+\\frac{1}{2}}^{L} = n_3 + \\frac{\\Delta s}{2}\\sigma_3 = 0.2 + \\frac{\\Delta s}{2}(0) = 0.2\n$$\n\n**Step 3: Compute the upwind numerical fluxes $F_{i+\\frac{1}{2}}$.**\nThe numerical flux is $F_{i+\\frac{1}{2}} = v_{\\parallel}\\,n_{i+\\frac{1}{2}}^{L}$.\n\nFor interface $1+\\frac{1}{2}$:\n$$\nF_{1+\\frac{1}{2}} = v_{\\parallel}\\,n_{1+\\frac{1}{2}}^{L} = (2 \\times 10^4 \\, \\mathrm{m/s})(1) = 20000 \\, \\mathrm{m/s}\n$$\n\nFor interface $2+\\frac{1}{2}$:\n$$\nF_{2+\\frac{1}{2}} = v_{\\parallel}\\,n_{2+\\frac{1}{2}}^{L} = (2 \\times 10^4 \\, \\mathrm{m/s})(0.35) = 7000 \\, \\mathrm{m/s}\n$$\n\nFor interface $3+\\frac{1}{2}$:\n$$\nF_{3+\\frac{1}{2}} = v_{\\parallel}\\,n_{3+\\frac{1}{2}}^{L} = (2 \\times 10^4 \\, \\mathrm{m/s})(0.2) = 4000 \\, \\mathrm{m/s}\n$$\n\n**Step 4: Update the cell-centered values $n_i^{\\text{new}}$.**\nThe time update formula is $n_i^{\\text{new}} = n_i^{\\text{old}} - \\frac{\\Delta t}{\\Delta s}(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}})$. Due to periodicity, the flux at the left face of cell $1$, $F_{1-\\frac{1}{2}}$, is the same as the flux at the right face of cell $3$, $F_{3+\\frac{1}{2}}$.\nThe update prefactor is:\n$$\n\\frac{\\Delta t}{\\Delta s} = \\frac{1 \\times 10^{-7} \\, \\mathrm{s}}{5 \\times 10^{-3} \\, \\mathrm{m}} = 2 \\times 10^{-5} \\, \\mathrm{s/m}\n$$\n\nFor cell $i=1$:\n$$\nn_1^{\\text{new}} = n_1 - \\frac{\\Delta t}{\\Delta s}(F_{1+\\frac{1}{2}} - F_{3+\\frac{1}{2}}) = 1 - (2 \\times 10^{-5})(20000 - 4000) = 1 - (2 \\times 10^{-5})(16000) = 1 - 0.32 = 0.68\n$$\n\nFor cell $i=2$:\n$$\nn_2^{\\text{new}} = n_2 - \\frac{\\Delta t}{\\Delta s}(F_{2+\\frac{1}{2}} - F_{1+\\frac{1}{2}}) = 0.5 - (2 \\times 10^{-5})(7000 - 20000) = 0.5 - (2 \\times 10^{-5})(-13000) = 0.5 + 0.26 = 0.76\n$$\n\nFor cell $i=3$:\n$$\nn_3^{\\text{new}} = n_3 - \\frac{\\Delta t}{\\Delta s}(F_{3+\\frac{1}{2}} - F_{2+\\frac{1}{2}}) = 0.2 - (2 \\times 10^{-5})(4000 - 7000) = 0.2 - (2 \\times 10^{-5})(-3000) = 0.2 + 0.06 = 0.26\n$$\n\nThe computed values are:\nFluxes: $F_{1+\\frac{1}{2}} = 20000 \\, \\mathrm{m/s}$, $F_{2+\\frac{1}{2}} = 7000 \\, \\mathrm{m/s}$, $F_{3+\\frac{1}{2}} = 4000 \\, \\mathrm{m/s}$.\nUpdated densities: $n_1^{\\text{new}} = 0.68$, $n_2^{\\text{new}} = 0.76$, $n_3^{\\text{new}} = 0.26$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 20000  7000  4000  0.68  0.76  0.26 \\end{pmatrix}}\n$$"
        }
    ]
}