{
    "hands_on_practices": [
        {
            "introduction": "运动论蒙特卡洛（KMC）方法的核心在于将物理过程转化为一系列概率事件。所有事件的基础是碰撞频率，或称风险率。本练习旨在通过一个基础但至关重要的问题，将您带回第一性原理：从等离子体密度 $n_i$、能量依赖的碰撞截面 $\\sigma(E)$ 和中性粒子速度 $v$ 等基本物理量，推导并计算出用于 KMC 模拟的核心参数——碰撞率 $\\lambda$。通过这个练习，您不仅能巩固对碰撞过程物理本质的理解，还能掌握在科学计算中至关重要的单位转换和量纲分析技能。",
            "id": "3999899",
            "problem": "一个在聚变等离子体边缘运动的中性氘原子通过动力学蒙特卡洛（KMC）方法进行模拟，其中下一个事件的时间从指数分布中抽取，其速率参数（风险率）由碰撞频率给出。根据动力学理论，双体碰撞的碰撞频率可以表示为靶离子数密度、依赖于能量的截面和相对速度的函数。考虑一个中性氘原子与数密度为 $n_{i} = 7.5 \\times 10^{19}\\ \\mathrm{m}^{-3}$ 的氘离子发生电荷交换。其依赖于能量的截面由 $\\sigma(E) = \\sigma_{0}\\left(E/E_{0}\\right)^{-1/2}$ 描述，其中 $\\sigma_{0} = 1.8 \\times 10^{-16}\\ \\mathrm{cm}^{2}$ 且 $E_{0} = 1\\ \\mathrm{eV}$。一个单能中性粒子的动能为 $E = 20\\ \\mathrm{eV}$，质量为 $m_{D} = 3.344 \\times 10^{-27}\\ \\mathrm{kg}$。假设相对速度等于中性粒子的速度。从动能的基本定义和动力学理论中的标准碰撞频率表达式出发，推导KMC所使用的速率 $\\lambda$ 作为离子数密度 $n_{i}$、截面 $\\sigma(E)$ 和中性粒子速度 $v$ 的函数，并通过将截面从 $\\mathrm{cm}^{2}$ 显式转换为 $\\mathrm{m}^{2}$、能量从 $\\mathrm{eV}$ 转换为 $\\mathrm{J}$ 来验证量纲一致性。计算 $\\lambda$ 的数值，并证明其单位为 $\\mathrm{s}^{-1}$。将最终速率四舍五入至四位有效数字。以 $\\mathrm{s}^{-1}$ 为单位表示最终答案。",
            "solution": "该问题经评估为有效，因为它在动力学理论上具有科学依据，所有必要信息均已提供，问题设置良好，且其语言和表述客观。因此，我们可以着手求解。\n\n在动力学蒙特卡洛（KMC）模拟中，碰撞事件的速率参数 $\\lambda$ 等效于总碰撞频率。对于一个测试粒子与一个靶粒子群之间的双体碰撞，碰撞频率由以下表达式给出：\n$$ \\lambda = n_{\\text{target}} \\langle \\sigma v_{\\text{rel}} \\rangle $$\n其中 $n_{\\text{target}}$ 是靶粒子的数密度，$\\sigma$ 是碰撞截面， $v_{\\text{rel}}$ 是碰撞粒子间的相对速度，尖括号 $\\langle \\dots \\rangle$ 表示对两个粒子群速度分布的平均。\n\n问题指定了一个单能中性氘原子，这意味着其速度是固定的。它还提供了一个简化假设，即相对速度等于中性粒子的速度，$v_{\\text{rel}} = v$。这等效于假设靶氘离子是静止的。在这些条件下，平均是不必要的，速率 $\\lambda$ 的表达式简化为：\n$$ \\lambda = n_{i} \\sigma(E) v $$\n该方程即为按要求推导出的 $\\lambda$ 作为离子密度 $n_{i}$、依赖于能量的截面 $\\sigma(E)$ 和中性粒子速度 $v$ 的函数。\n\n为了计算 $\\lambda$ 的数值，我们必须首先根据给定数据确定中性粒子速度 $v$ 和特定截面 $\\sigma(E)$。\n\n中性氘原子的动能为 $E = 20\\ \\mathrm{eV}$，其质量为 $m_{D} = 3.344 \\times 10^{-27}\\ \\mathrm{kg}$。动能与速度之间的关系是：\n$$ E = \\frac{1}{2} m_{D} v^2 $$\n求解速度 $v$ 得到：\n$$ v = \\sqrt{\\frac{2E}{m_{D}}} $$\n\n依赖于能量的电荷交换截面由以下公式给出：\n$$ \\sigma(E) = \\sigma_{0}\\left(\\frac{E}{E_{0}}\\right)^{-1/2} $$\n其中 $\\sigma_{0} = 1.8 \\times 10^{-16}\\ \\mathrm{cm}^{2}$ 且 $E_{0} = 1\\ \\mathrm{eV}$。\n\n在进行数值计算之前，我们必须确保所有量都在一个一致的单位制中，即国际单位制（SI）。\n给定值为：\n- 离子密度: $n_{i} = 7.5 \\times 10^{19}\\ \\mathrm{m}^{-3}$ (SI 单位)\n- 中性粒子质量: $m_{D} = 3.344 \\times 10^{-27}\\ \\mathrm{kg}$ (SI 单位)\n- 中性粒子能量: $E = 20\\ \\mathrm{eV}$\n- 截面常数: $\\sigma_{0} = 1.8 \\times 10^{-16}\\ \\mathrm{cm}^{2}$\n- 参考能量: $E_{0} = 1\\ \\mathrm{eV}$\n\n我们对能量和截面进行必要的单位转换。电子伏特（$\\mathrm{eV}$）和焦耳（$\\mathrm{J}$）之间的转换因子是元电荷，$e \\approx 1.602177 \\times 10^{-19}\\ \\mathrm{C}$。\n$$ E = 20\\ \\mathrm{eV} = 20 \\times (1.602177 \\times 10^{-19})\\ \\mathrm{J} = 3.204354 \\times 10^{-18}\\ \\mathrm{J} $$\n从平方厘米（$\\mathrm{cm}^{2}$）到平方米（$\\mathrm{m}^{2}$）的转换是 $1\\ \\mathrm{m}^{2} = (100\\ \\mathrm{cm})^{2} = 10^{4}\\ \\mathrm{cm}^{2}$，这得到 $1\\ \\mathrm{cm}^{2} = 10^{-4}\\ \\mathrm{m}^{2}$。\n$$ \\sigma_{0} = 1.8 \\times 10^{-16}\\ \\mathrm{cm}^{2} = 1.8 \\times 10^{-16} \\times 10^{-4}\\ \\mathrm{m}^{2} = 1.8 \\times 10^{-20}\\ \\mathrm{m}^{2} $$\n\n现在我们可以计算 $v$ 和 $\\sigma(E)$ 的数值：\n中性原子的速度是：\n$$ v = \\sqrt{\\frac{2 \\times (3.204354 \\times 10^{-18}\\ \\mathrm{J})}{3.344 \\times 10^{-27}\\ \\mathrm{kg}}} \\approx \\sqrt{1.91648 \\times 10^{9}\\ \\frac{\\mathrm{m}^{2}}{\\mathrm{s}^{2}}} \\approx 4.37776 \\times 10^{4}\\ \\frac{\\mathrm{m}}{\\mathrm{s}} $$\n碰撞的截面是：\n$$ \\sigma(E) = (1.8 \\times 10^{-20}\\ \\mathrm{m}^{2}) \\left(\\frac{20\\ \\mathrm{eV}}{1\\ \\mathrm{eV}}\\right)^{-1/2} = \\frac{1.8 \\times 10^{-20}\\ \\mathrm{m}^{2}}{\\sqrt{20}} $$\n$$ \\sigma(E) \\approx \\frac{1.8 \\times 10^{-20}\\ \\mathrm{m}^{2}}{4.472136} \\approx 4.02492 \\times 10^{-21}\\ \\mathrm{m}^{2} $$\n\n在所有分量都以国际单位制计算后，我们可以计算速率 $\\lambda$：\n$$ \\lambda = n_{i} \\sigma(E) v $$\n$$ \\lambda \\approx (7.5 \\times 10^{19}\\ \\mathrm{m}^{-3}) \\times (4.02492 \\times 10^{-21}\\ \\mathrm{m}^{2}) \\times (4.37776 \\times 10^{4}\\ \\frac{\\mathrm{m}}{\\mathrm{s}}) $$\n$$ \\lambda \\approx (7.5 \\times 4.02492 \\times 4.37776) \\times 10^{19-21+4}\\ \\mathrm{s}^{-1} $$\n$$ \\lambda \\approx 132.147 \\times 10^{2}\\ \\mathrm{s}^{-1} = 1.32147 \\times 10^{4}\\ \\mathrm{s}^{-1} $$\n\n量纲一致性验证如下：\n$$ [\\lambda] = [n_i] [\\sigma(E)] [v] = (\\mathrm{m}^{-3}) \\cdot (\\mathrm{m}^{2}) \\cdot (\\mathrm{m} \\cdot \\mathrm{s}^{-1}) = \\mathrm{m}^{-3+2+1} \\cdot \\mathrm{s}^{-1} = \\mathrm{m}^{0} \\cdot \\mathrm{s}^{-1} = \\mathrm{s}^{-1} $$\n这证实了得到的速率 $\\lambda$ 的单位是秒的倒数，正如频率所预期的那样。\n\n最后，按要求将数值结果四舍五入至四位有效数字：\n$$ \\lambda \\approx 1.321 \\times 10^{4}\\ \\mathrm{s}^{-1} $$",
            "answer": "$$\\boxed{1.321 \\times 10^{4}}$$"
        },
        {
            "introduction": "在真实的聚变等离子体环境中，介质的属性（如密度和温度）很少是均匀不变的。本练习将我们从均质介质的简化模型推进到更贴近实际的非均质情况，旨在教会您如何处理空间变化的碰撞率 $\\nu(x)$。您将学习并应用“光学深度” $\\tau$ 这一关键概念，它是碰撞率沿粒子运动路径的积分。通过计算粒子在一个具有分段常数碰撞系数的平板中的碰撞位置，您将掌握在非均匀介质中抽样粒子自由程的核心 KMC 技术。",
            "id": "3999930",
            "problem": "在中性粒子输运的动力学蒙特卡洛（KMC）方法背景下，一个中性粒子在一维板中被输运。该板在坐标 $x$ 上占据区间 $[0, L]$，包含两个相邻的材料区域：区域 1 跨越 $[0, L_1]$，区域 2 跨越 $[L_1, L_1 + L_2]$，因此 $L = L_1 + L_2$。该中性粒子从位置 $x_0$ 开始，沿着 $x$ 增加的方向行进，并无反射地穿过该板。每个区域中单位长度的宏观碰撞系数是恒定的：对于 $x \\in [0, L_1]$，$\\nu(x) = \\nu_1$；对于 $x \\in [L_1, L_1 + L_2]$，$\\nu(x) = \\nu_2$，其中 $\\nu_1 > 0$ 且 $\\nu_2 > 0$。到下一次碰撞的自由程 $s$ 的定义条件是：沿路径的积分碰撞风险等于一个抽样得到的光学深度 $\\tau$。其中，光学深度 $\\tau$ 是通过一个均匀随机变量 $R \\in (0,1)$ 根据指数定律抽样得到的，即 $\\tau = -\\ln(R)$。碰撞位置为 $x_{\\mathrm{coll}} = x_0 + s$。\n\n假设 $L_1 = 0.06\\,\\mathrm{m}$，$L_2 = 0.04\\,\\mathrm{m}$，$x_0 = 0.02\\,\\mathrm{m}$，$\\nu_1 = 20\\,\\mathrm{m}^{-1}$，$\\nu_2 = 5\\,\\mathrm{m}^{-1}$，以及 $R = 0.5$。定义从起点沿飞行方向到界面和到板出口的进入距离分别为 $d_1 = L_1 - x_0$ 和 $d_2 = L_2$。使用以上定义并从第一性原理出发，确定 $x_{\\mathrm{coll}}$。\n\n将您的答案四舍五入至四位有效数字。以米为单位表示最终的碰撞位置。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、良构且客观。\n\n**步骤 1：提取已知条件**\n-   一维板几何结构：$x \\in [0, L]$。\n-   区域 1：$x \\in [0, L_1]$，宏观碰撞系数为 $\\nu(x) = \\nu_1$。\n-   区域 2：$x \\in [L_1, L_1 + L_2]$，宏观碰撞系数为 $\\nu(x) = \\nu_2$。\n-   板尺寸关系：$L = L_1 + L_2$。\n-   粒子初始位置：$x_0 = 0.02\\,\\mathrm{m}$。\n-   粒子初始方向：朝向 $x$ 增加的方向。\n-   数值：$L_1 = 0.06\\,\\mathrm{m}$，$L_2 = 0.04\\,\\mathrm{m}$，$\\nu_1 = 20\\,\\mathrm{m}^{-1}$，$\\nu_2 = 5\\,\\mathrm{m}^{-1}$。\n-   用于抽样的随机变量：$R = 0.5$，其中 $R \\in (0,1)$。\n-   光学深度的定义：$\\tau = -\\ln(R)$。\n-   自由程 $s$ 的条件：沿路径的积分碰撞风险等于 $\\tau$。\n-   碰撞位置的定义：$x_{\\mathrm{coll}} = x_0 + s$。\n-   辅助定义：$d_1 = L_1 - x_0$ 和 $d_2 = L_2$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它描述了一个使用动力学蒙特卡洛方法求解的标准一维、双区域输运问题。宏观碰撞系数（截面）、光学深度和逆变换采样（$\\tau = -\\ln(R)$）的使用都是输运理论中基本且正确的概念。该问题是良构的，因为提供了所有必要的数据（$x_0$、$\\nu_1$、$\\nu_2$、$L_1$、$R$）和清晰的规则来确定唯一的碰撞位置 $x_{\\mathrm{coll}}$。初始位置 $x_0 = 0.02\\,\\mathrm{m}$ 正确地位于区域 1（$[0, 0.06\\,\\mathrm{m}]$）内。物理单位是一致的。对于给定的输入，该问题是客观的且没有歧义。\n\n**步骤 3：结论与行动**\n该问题被认为是有效的。将提供完整的解答。\n\n**求解推导**\n用于粒子输运的动力学蒙特卡洛方法的基本原理是，粒子在自由程路径上穿过的光学深度是从一个指数概率分布中抽样的。光学深度 $\\tau$ 的累积分布函数为 $P(\\tau'  \\tau) = 1 - \\exp(-\\tau)$。使用逆变换采样法，并用一个均匀随机变量 $R \\in (0,1)$，我们设 $R = P(\\tau'  \\tau)$，这得到 $R = 1 - \\exp(-\\tau)$，并导出给定的关系 $\\tau = -\\ln(1-R)$。由于 $R$ 是 $(0,1)$ 上的均匀随机变量，那么 $1-R$ 也是 $(0,1)$ 上的均匀随机变量。因此，为了抽样，我们可以使用 $\\tau = -\\ln(R)$。\n\n对于给定的随机变量 $R=0.5$，到下一次碰撞的抽样光学深度为：\n$$ \\tau = -\\ln(0.5) = -(\\ln(2^{-1})) = \\ln(2) $$\n光学深度的值约为 $\\tau \\approx 0.6931$。\n\n光学深度也定义为宏观碰撞系数 $\\nu(x)$ 沿着粒子路径从其起点 $x_0$到碰撞点 $x_{\\mathrm{coll}} = x_0 + s$ 的积分：\n$$ \\tau = \\int_{x_0}^{x_0+s} \\nu(x') \\, dx' $$\n\n粒子从区域 1 中的 $x_0 = 0.02\\,\\mathrm{m}$ 处开始，此时 $\\nu(x) = \\nu_1 = 20\\,\\mathrm{m}^{-1}$。它朝着 $x$ 的正方向行进。我们必须首先确定碰撞是发生在区域 1 内，还是粒子穿过 $x = L_1 = 0.06\\,\\mathrm{m}$ 处的界面进入区域 2。\n\n为此，我们计算到达界面所需的光学深度 $\\tau_{\\text{interface}}$。到界面的路径长度为 $s_1 = L_1 - x_0$。\n$$ s_1 = 0.06\\,\\mathrm{m} - 0.02\\,\\mathrm{m} = 0.04\\,\\mathrm{m} $$\n在区域 1 中穿过此路径的光学深度为：\n$$ \\tau_{\\text{interface}} = \\int_{x_0}^{L_1} \\nu_1 \\, dx' = \\nu_1 (L_1 - x_0) = \\nu_1 s_1 $$\n代入给定值：\n$$ \\tau_{\\text{interface}} = (20\\,\\mathrm{m}^{-1}) \\times (0.04\\,\\mathrm{m}) = 0.8 $$\n\n我们现在将抽样得到的光学深度 $\\tau$ 与到达界面的光学深度 $\\tau_{\\text{interface}}$ 进行比较：\n$$ \\tau = \\ln(2) \\approx 0.6931 $$\n$$ \\tau_{\\text{interface}} = 0.8 $$\n由于 $\\tau  \\tau_{\\text{interface}}$，粒子没有足够的“光程”来到达界面。因此，碰撞发生在区域 1 内。\n\n对于区域 1 内的碰撞，飞行距离 $s$ 由以下方程确定：\n$$ \\tau = \\int_{x_0}^{x_0+s} \\nu_1 \\, dx' = \\nu_1 s $$\n求解 $s$：\n$$ s = \\frac{\\tau}{\\nu_1} = \\frac{\\ln(2)}{\\nu_1} $$\n那么碰撞的位置是：\n$$ x_{\\mathrm{coll}} = x_0 + s = x_0 + \\frac{\\ln(2)}{\\nu_1} $$\n代入数值：\n$$ x_{\\mathrm{coll}} = 0.02\\,\\mathrm{m} + \\frac{\\ln(2)}{20\\,\\mathrm{m}^{-1}} $$\n使用近似值 $\\ln(2) \\approx 0.693147$：\n$$ x_{\\mathrm{coll}} \\approx 0.02\\,\\mathrm{m} + \\frac{0.693147}{20}\\,\\mathrm{m} \\approx 0.02\\,\\mathrm{m} + 0.034657\\,\\mathrm{m} $$\n$$ x_{\\mathrm{coll}} \\approx 0.054657\\,\\mathrm{m} $$\n问题要求将答案四舍五入到四位有效数字。从第一个非零数字开始数，有效数字是 $5, 4, 6, 5$。下一位数字是 $7$，需要将最后一位有效数字向上取整。\n$$ x_{\\mathrm{coll}} \\approx 0.05466\\,\\mathrm{m} $$\n这个位置在区域 1 ($x \\in [0, 0.06\\,\\mathrm{m}]$)内，这与我们发现的碰撞发生在界面之前的结论相符。",
            "answer": "$$\\boxed{0.05466}$$"
        },
        {
            "introduction": "除了物理碰撞，粒子在离散化计算网格中的运动还包含另一种关键事件：穿越网格边界。本练习将您的注意力从物理相互作用转移到计算几何上，这是任何 KMC 输运代码的基石。您将学习如何计算一个粒子沿直线轨迹运动到下一个笛卡尔网格平面的路径长度。更重要的是，本练习引入了处理“掠射角”和“近平面位置”等数值挑战的公差概念，这些是确保模拟程序在面对极端情况时依然保持稳健和准确的关键工程实践。",
            "id": "3999891",
            "problem": "在用于计算聚变科学与工程的动力学蒙特卡洛（KMC）中性粒子输运中，一个中性粒子会沿着一条直线特征线前进，直到它穿过一个笛卡尔网格平面或发生一次相互作用。考虑一个均匀的笛卡尔网格，其平面位于 $x = i\\,\\Delta x$、$y = j\\,\\Delta y$ 和 $z = k\\,\\Delta z$ 处，其中 $i$、$j$ 和 $k$ 为整数。一个位于位置 $\\boldsymbol{r}_0 = (x_0, y_0, z_0)$ 的中性粒子，沿着由弧长 $s$ 参数化的直线路径 $\\boldsymbol{r}(s) = \\boldsymbol{r}_0 + s\\,\\hat{\\boldsymbol{n}}$ 前进，其中 $\\hat{\\boldsymbol{n}}$ 是一个单位方向向量。\n\n为了在存在掠射角和近边界位置的情况下确保数值稳健性，采用以下容差：\n1. 掠射角容差 $\\delta$：对于任意分量 $i \\in \\{x,y,z\\}$，如果 $|n_i|  \\delta$，则将对应的轴向平面穿越视为不存在，方法是将其轴向穿越路径长度设置为 $+\\infty$。\n2. 近平面邻近容差 $\\eta$：如果中性粒子与一个平面的距离小于 $\\eta$ 并且正朝该平面移动，则跳过该平面，并以同一轴向的下一个平面为目标，以防止因浮点舍入而导致的立即反向穿越。\n\n给定网格间距 $\\Delta x = 0.03\\,\\mathrm{m}$、$\\Delta y = 0.02\\,\\mathrm{m}$、$\\Delta z = 0.04\\,\\mathrm{m}$，当前位置 $(x_0, y_0, z_0) = (0.09597\\,\\mathrm{m}, 0.10001\\,\\mathrm{m}, 0.11998\\,\\mathrm{m})$，以及由下式定义的单位方向向量分量\n$$\nn_x = 3.0 \\times 10^{-5}, \\quad\nn_y = \\frac{3}{5}\\,\\sqrt{1 - n_x^{2}}, \\quad\nn_z = \\frac{4}{5}\\,\\sqrt{1 - n_x^{2}},\n$$\n使用 $\\delta = 1.0 \\times 10^{-4}$ 和 $\\eta = 5.0 \\times 10^{-5}\\,\\mathrm{m}$。根据上述容差规则，确定到下一个网格平面穿越的路径长度 $s$，该长度定义为沿 $x$、$y$ 和 $z$ 轴的正轴向穿越距离中的最小值。\n\n以米为单位表示最终的 $s$，并将您的答案四舍五入到七位有效数字。",
            "solution": "基本原理是一个不发生相互作用的中性粒子的直线运动学，$\\boldsymbol{r}(s) = \\boldsymbol{r}_0 + s\\,\\hat{\\boldsymbol{n}}$，其中因为 $\\hat{\\boldsymbol{n}}$ 是单位向量，所以 $s$ 是弧长。笛卡尔网格平面由 $x = i\\,\\Delta x$、$y = j\\,\\Delta y$、$z = k\\,\\Delta z$ 定义，而沿 $i$ 轴穿越下一个平面的路径长度可通过求解标量形式的直线-平面相交方程获得：\n$$\nx_0 + s\\,n_x = x_{\\text{plane}}, \\quad y_0 + s\\,n_y = y_{\\text{plane}}, \\quad z_0 + s\\,n_z = z_{\\text{plane}}.\n$$\n对于给定的轴，根据当前单元索引和 $\\hat{\\boldsymbol{n}}$ 相应分量的符号，并遵循容差规则，来选择运动方向上的下一个平面。\n\n第1步：确定当前单元索引。\n对于 $x$ 轴，有 $\\Delta x = 0.03\\,\\mathrm{m}$ 和 $x_0 = 0.09597\\,\\mathrm{m}$：\n$$\n\\frac{x_0}{\\Delta x} = \\frac{0.09597}{0.03} = 3.199, \\quad i = \\lfloor 3.199 \\rfloor = 3,\n$$\n因此，边界平面位于 $x = 0.09\\,\\mathrm{m}$ 和 $x = 0.12\\,\\mathrm{m}$。\n\n对于 $y$ 轴，有 $\\Delta y = 0.02\\,\\mathrm{m}$ 和 $y_0 = 0.10001\\,\\mathrm{m}$：\n$$\n\\frac{y_0}{\\Delta y} = \\frac{0.10001}{0.02} = 5.0005, \\quad j = \\lfloor 5.0005 \\rfloor = 5,\n$$\n因此，边界平面位于 $y = 0.10\\,\\mathrm{m}$ 和 $y = 0.12\\,\\mathrm{m}$。\n\n对于 $z$ 轴，有 $\\Delta z = 0.04\\,\\mathrm{m}$ 和 $z_0 = 0.11998\\,\\mathrm{m}$：\n$$\n\\frac{z_0}{\\Delta z} = \\frac{0.11998}{0.04} = 2.9995, \\quad k = \\lfloor 2.9995 \\rfloor = 2,\n$$\n因此，边界平面位于 $z = 0.08\\,\\mathrm{m}$ 和 $z = 0.12\\,\\mathrm{m}$。\n\n第2步：方向分量和掠射角容差。\n给定的方向分量为\n$$\nn_x = 3.0 \\times 10^{-5}, \\quad n_y = \\frac{3}{5}\\,\\sqrt{1 - n_x^{2}}, \\quad n_z = \\frac{4}{5}\\,\\sqrt{1 - n_x^{2}}.\n$$\n根据掠射角容差 $\\delta = 1.0 \\times 10^{-4}$，我们有\n$$\n|n_x| = 3.0 \\times 10^{-5}  \\delta,\n$$\n因此，根据规则，$x$ 轴的穿越距离被设置为 $s_x = +\\infty$。\n\n由于 $n_y > 0$ 且 $n_z > 0$，沿 $y$ 轴和 $z$ 轴的下一个平面是上边界平面 $y = (j+1)\\Delta y$ 和 $z = (k+1)\\Delta z$，但这需要遵循近平面邻近容差规则。\n\n第3步：应用近平面邻近容差 $\\eta = 5.0 \\times 10^{-5}\\,\\mathrm{m}$。\n\n对于 $y$ 轴：\n对于 $n_y > 0$，朴素目标平面为 $y_{\\text{next}} = (j+1)\\Delta y = 0.12\\,\\mathrm{m}$。到该平面的朴素距离为\n$$\nd_y^{\\text{naive}} = y_{\\text{next}} - y_0 = 0.12 - 0.10001 = 0.01999\\,\\mathrm{m}.\n$$\n由于 $d_y^{\\text{naive}} = 0.01999\\,\\mathrm{m} \\gg \\eta$，不需要跳过，目标平面仍为 $y_{\\text{next}} = 0.12\\,\\mathrm{m}$。\n\n对于 $z$ 轴：\n对于 $n_z > 0$，朴素目标平面为 $z_{\\text{next}} = (k+1)\\Delta z = 0.12\\,\\mathrm{m}$。到该平面的朴素距离为\n$$\nd_z^{\\text{naive}} = z_{\\text{next}} - z_0 = 0.12 - 0.11998 = 0.00002\\,\\mathrm{m}.\n$$\n由于 $d_z^{\\text{naive}} = 2.0 \\times 10^{-5}\\,\\mathrm{m}  \\eta$，规则要求跳过此平面以避免立即反向穿越。因此，目标平面推进到\n$$\nz_{\\text{next}} = (k+2)\\Delta z = 0.16\\,\\mathrm{m},\n$$\n修正后的差值为\n$$\nd_z = z_{\\text{next}} - z_0 = 0.16 - 0.11998 = 0.04002\\,\\mathrm{m}.\n$$\n\n第4步：计算沿 $y$ 轴和 $z$ 轴的轴向穿越路径长度。\n因为 $\\hat{\\boldsymbol{n}}$ 是单位向量，所以 $s$ 等于物理距离。轴向穿越距离为\n$$\ns_y = \\frac{y_{\\text{next}} - y_0}{n_y} = \\frac{0.01999}{\\frac{3}{5}\\sqrt{1 - n_x^{2}}}, \\quad s_z = \\frac{z_{\\text{next}} - z_0}{n_z} = \\frac{0.04002}{\\frac{4}{5}\\sqrt{1 - n_x^{2}}}.\n$$\n当 $n_x = 3.0 \\times 10^{-5}$ 时，我们有 $n_x^{2} = 9.0 \\times 10^{-10}$ 且 $\\sqrt{1 - n_x^{2}} = \\sqrt{1 - 9.0 \\times 10^{-10}} \\approx 0.99999999955$。因此，\n$$\nn_y \\approx \\frac{3}{5} \\times 0.99999999955 \\approx 0.59999999973, \\quad n_z \\approx \\frac{4}{5} \\times 0.99999999955 \\approx 0.79999999964.\n$$\n因此，\n$$\ns_y \\approx \\frac{0.01999}{0.59999999973} \\approx 0.03331666668\\,\\mathrm{m}, \\quad s_z \\approx \\frac{0.04002}{0.79999999964} \\approx 0.05002500023\\,\\mathrm{m}.\n$$\n\n第5步：选择最小的正轴向穿越距离。\n根据掠射角规则，$s_x = +\\infty$，且 $s_y  s_z$，因此到下一个网格平面穿越的路径长度是\n$$\ns = \\min\\{s_x, s_y, s_z\\} = s_y \\approx 0.03331666668\\,\\mathrm{m}.\n$$\n\n最后，按要求四舍五入到七位有效数字，得到\n$$\ns \\approx 0.03331667\\,\\mathrm{m}.\n$$",
            "answer": "$$\\boxed{0.03331667}$$"
        }
    ]
}