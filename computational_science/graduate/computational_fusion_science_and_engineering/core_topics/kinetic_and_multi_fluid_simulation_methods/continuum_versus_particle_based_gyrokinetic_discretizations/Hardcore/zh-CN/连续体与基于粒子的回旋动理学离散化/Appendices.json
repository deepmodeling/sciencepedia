{
    "hands_on_practices": [
        {
            "introduction": "在我们比较不同的数值离散化方案之前，首先必须理解它们所适用的物理领域。本练习将引导您完成一项基本计算，以验证回旋动理学近似本身的合理性。通过为典型的托卡马克等离子体计算核心的排序参数 $\\epsilon = \\rho_i/L$，您将验证支撑连续介质和基于粒子的回旋动理学模型的尺度分离 。",
            "id": "3959024",
            "problem": "在磁化聚变等离子体的回旋动理学模拟中，保证其保真度的一个核心要求是，一个衡量回旋半径与宏观系统尺度之比的无量纲级数参数要足够小。考虑一个托卡马克装置中的氘离子，其磁场强度 $B=3\\,\\mathrm{T}$，离子温度 $T_i=2\\,\\mathrm{keV}$，大半径 $R=1.7\\,\\mathrm{m}$，以及由 $k_{\\perp}\\rho_i\\sim 0.3$ 表征的特征垂直涨落尺度。请仅使用基本定义，推导离子热速度 $v_{th,i}$、离子回旋频率 $\\Omega_i$ 和离子热回旋半径 $\\rho_i$，然后对氘离子进行数值计算。使用 $Z=1$，$m_i=2m_p$，其中质子质量 $m_p=1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$，元电荷 $e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$。将 $T_i$ 视为每个离子的能量，并通过 $1\\,\\mathrm{eV}=e\\,\\mathrm{J}$ 将 $\\mathrm{keV}$ 转换为焦耳。采用以下定义：$v_{th,i}\\equiv\\sqrt{2T_i/m_i}$，$\\Omega_i\\equiv ZeB/m_i$ 和 $\\rho_i\\equiv v_{th,i}/\\Omega_i$。然后，使用 $L=R$ 作为宏观尺度，构建回旋动理学级数参数 $\\epsilon\\equiv \\rho_i/L$ 并计算其值。请基于第一性原理简要论证，为什么在 $k_{\\perp}\\rho_i\\sim 0.3$ 的情况下，所得的 $\\epsilon$ 的大小能够支持回旋动理学近似对于连续介质和网格粒子（PIC）离散化方法的有效性。\n\n请仅报告 $\\epsilon$ 的最终数值，作为一个无量纲数，并四舍五入到三位有效数字。",
            "solution": "经评估，该问题陈述在科学上是成立的、表述清晰且客观的。它提出了一个等离子体物理学中的标准计算，与聚变装置的回旋动理学模拟相关。所有必要的数据和定义均已提供，并与既定原理一致。因此，有必要提供完整的解答。\n\n该问题要求计算托卡马克中氘等离子体的回旋动理学级数参数 $\\epsilon$。我们已知以下参数：\n磁场强度：$B=3\\,\\mathrm{T}$\n离子温度：$T_i=2\\,\\mathrm{keV}$\n大半径：$R=1.7\\,\\mathrm{m}$\n特征垂直涨落尺度：$k_{\\perp}\\rho_i\\sim 0.3$\n离子电荷态：$Z=1$\n离子质量（氘）：$m_i=2m_p$\n质子质量：$m_p=1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$\n元电荷：$e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$\n\n问题提供了以下定义：\n离子热速度：$v_{th,i}\\equiv\\sqrt{2T_i/m_i}$\n离子回旋频率：$\\Omega_i\\equiv ZeB/m_i$\n离子热回旋半径：$\\rho_i\\equiv v_{th,i}/\\Omega_i$\n回旋动理学级数参数：$\\epsilon\\equiv \\rho_i/L$，其中宏观尺度长度 $L=R$。\n\n首先，我们必须将所有量表示为国际单位制（SI）基本单位。离子温度 $T_i$ 以千电子伏特（$\\mathrm{keV}$）给出，必须转换为焦耳（$\\mathrm{J}$）。使用提供的转换关系 $1\\,\\mathrm{eV}=e\\,\\mathrm{J}$，其中 $e$ 是以库仑为单位的元电荷，我们有：\n$$T_i = 2\\,\\mathrm{keV} = 2 \\times 10^3\\,\\mathrm{eV} = (2 \\times 10^3) \\times (1.602176634\\times 10^{-19}) \\,\\mathrm{J}$$\n$$T_i = 3.204353268 \\times 10^{-16}\\,\\mathrm{J}$$\n\n接下来，我们计算氘离子质量 $m_i$：\n$$m_i = 2m_p = 2 \\times (1.67262192369\\times 10^{-27}\\,\\mathrm{kg}) = 3.34524384738 \\times 10^{-27}\\,\\mathrm{kg}$$\n\n在 $T_i$ 和 $m_i$ 使用SI单位后，我们现在可以推导和计算 $v_{th,i}$、$\\Omega_i$ 和 $\\rho_i$。\n\n1.  **离子热速度 ($v_{th,i}$)**\n    使用定义 $v_{th,i} = \\sqrt{2T_i/m_i}$：\n    $$v_{th,i} = \\sqrt{\\frac{2 \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{3.34524384738 \\times 10^{-27}\\,\\mathrm{kg}}} \\approx 4.37694 \\times 10^5\\,\\mathrm{m/s}$$\n\n2.  **离子回旋频率 ($\\Omega_i$)**\n    使用定义 $\\Omega_i = ZeB/m_i$：\n    $$\\Omega_i = \\frac{1 \\times (1.602176634\\times 10^{-19}\\,\\mathrm{C}) \\times (3\\,\\mathrm{T})}{3.34524384738 \\times 10^{-27}\\,\\mathrm{kg}} \\approx 1.43682 \\times 10^8\\,\\mathrm{rad/s}$$\n\n3.  **离子热回旋半径 ($\\rho_i$)**\n    使用定义 $\\rho_i = v_{th,i}/\\Omega_i$：\n    $$\\rho_i = \\frac{4.37694 \\times 10^5\\,\\mathrm{m/s}}{1.43682 \\times 10^8\\,\\mathrm{rad/s}} \\approx 3.0462 \\times 10^{-3}\\,\\mathrm{m}$$\n    或者，我们可以用基本参数直接表示 $\\rho_i$：\n    $$\\rho_i = \\frac{v_{th,i}}{\\Omega_i} = \\frac{\\sqrt{2T_i/m_i}}{ZeB/m_i} = \\frac{\\sqrt{2T_im_i}}{ZeB}$$\n    代入数值验证结果：\n    $$\\rho_i = \\frac{\\sqrt{2 \\times (3.20435... \\times 10^{-16}\\,\\mathrm{J}) \\times (3.34524... \\times 10^{-27}\\,\\mathrm{kg})}}{1 \\times (1.60217... \\times 10^{-19}\\,\\mathrm{C}) \\times (3\\,\\mathrm{T})} \\approx 3.0462 \\times 10^{-3}\\,\\mathrm{m}$$\n\n现在，我们计算回旋动理学级数参数 $\\epsilon$。问题指定使用大半径 $R$ 作为宏观尺度长度 $L$。\n$$L = R = 1.7\\,\\mathrm{m}$$\n级数参数 $\\epsilon$ 是离子热回旋半径与此宏观尺度长度之比：\n$$\\epsilon = \\frac{\\rho_i}{L} = \\frac{3.0462 \\times 10^{-3}\\,\\mathrm{m}}{1.7\\,\\mathrm{m}} \\approx 1.79188 \\times 10^{-3}$$\n\n按要求四舍五入到三位有效数字，得到：\n$$\\epsilon \\approx 1.79 \\times 10^{-3}$$\n\n最后，我们论证为什么这个结果支持回旋动理学近似的有效性。\n回旋动理学模型是基本弗拉索夫-麦克斯韦方程组的一个严格的渐近极限。其推导依赖于一个形式级数方案，在该方案中，回旋半径 $\\rho_i$ 远小于宏观平衡等离子体分布（如密度、温度和磁场）的特征尺度长度 $L$。无量纲参数 $\\epsilon \\equiv \\rho_i/L$ 量化了这种尺度分离。我们计算出的值 $\\epsilon \\approx 1.79 \\times 10^{-3}$ 非常小，满足了关键条件 $\\epsilon \\ll 1$。这种巨大的尺度分离验证了回旋动理学的核心步骤：将粒子运动在快速回旋运动轨道上进行平均。这个过程被称为回旋平均，其合理性在于背景物理量在单个回旋轨道所覆盖的空间范围内基本保持不变，从而允许将 $(\\mathbf{x}, \\mathbf{v})$ 相空间中复杂的六维粒子动力学简化为回旋中心坐标系下更易于处理的五维模型。\n\n问题还指出 $k_{\\perp}\\rho_i \\sim 0.3$。这个条件指明了湍流的垂直波长与离子回旋半径相当。这属于“有限拉莫尔半径”（FLR）效应的范畴，这对于描述驱动湍流输运的微观不稳定性（如离子温度梯度模）至关重要。回旋动理学模型正是为这一区域设计的，即 $\\rho_i/L \\ll 1$ 但 $k_{\\perp}\\rho_i \\sim \\mathcal{O}(1)$。更简单的模型，如理想磁流体动力学（MHD）或流体理论，在这一区域通常会失效。\n\n由 $\\epsilon \\ll 1$ 所证实的基本物理近似的有效性，是任何数值离散化方法的先决条件。连续介质（欧拉）方法和网格粒子（PIC，一种拉格朗日方法）方法都是为求解*同一套*回旋动理学方程而设计的数值技术。因此，$\\epsilon$ 的小量值支撑了这两种离散化策略的保真度，因为它证实了它们所求解的方程组为指定区域内的等离子体动力学提供了有效的物理描述。",
            "answer": "$$\\boxed{1.79 \\times 10^{-3}}$$"
        },
        {
            "introduction": "粒子模拟（PIC）方法的一个决定性特征是它使用离散的标记点来表示连续的相空间分布，这会引入统计采样噪声。本练习要求您从第一性原理出发，推导PIC密度估计器的相对误差，从而定量地理解这种噪声如何依赖于粒子数和网格参数。该分析对于评估PIC模拟中计算成本与精度之间的权衡至关重要 。",
            "id": "3959012",
            "problem": "考虑一个回旋动理学等离子体中的均匀回旋中心密度场，在一个体积为 $V$ 的三维周期性区域内，其连续介质密度为常数 $n_0$。在对回旋动理学密度进行质点网格 (PIC) 离散化时，从该区域的均匀分布中抽取 $N$ 个独立的标记粒子。在固定空间点 $\\boldsymbol{x}$ 处密度的 PIC 估计是使用一个紧支集、对称的形状函数 $S(\\boldsymbol{r})$ 构建的，该函数被归一化以满足 $\\int_{\\mathbb{R}^3} S(\\boldsymbol{r})\\,\\mathrm{d}^3\\boldsymbol{r} = 1$，并且其支撑域体积为 $V_s$，这意味着在一个体积为 $V_s$ 的区域之外 $S(\\boldsymbol{r}) = 0$。假设使用箱形形状函数，\n$$\nS(\\boldsymbol{r}) = \\begin{cases}\n\\frac{1}{V_s},  \\text{if } \\boldsymbol{r} \\in \\text{support region of volume } V_s, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n并且平移到 $\\boldsymbol{x}$ 的支撑域完全包含在周期性区域内（忽略边界重叠校正）。\n\n每个标记粒子携带相同的权重 $w$，选择该权重以使 PIC 估计量是无偏的，即 $\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = n_0$，其中\n$$\n\\tilde{n}(\\boldsymbol{x}) = \\sum_{i=1}^{N} w\\, S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right),\n$$\n且 $\\boldsymbol{X}_i$ 是独立的标记粒子位置。\n\n从独立抽样、无偏估计和独立随机变量之和的方差等第一性原理出发，推导在点 $\\boldsymbol{x}$ 处 PIC 密度估计量的相对均方根误差\n$$\n\\epsilon_{\\mathrm{rel}}(\\boldsymbol{x}) \\equiv \\frac{\\sqrt{\\mathrm{Var}(\\tilde{n}(\\boldsymbol{x}))}}{n_0},\n$$\n的解析表达式，该表达式是 $N$、$V$ 和 $V_s$ 的函数。你的推导应从上述定义开始，明确地计算所需的期望值，并且不应假设任何已知的 PIC 方差公式。请以 $N$、$V$ 和 $V_s$ 表示的单一闭式表达式给出最终答案。无需四舍五入。由于 $\\epsilon_{\\mathrm{rel}}$ 是无量纲的，因此最终表达式中不应包含单位。",
            "solution": "我们首先在给定假设下，对估计量及其统计特性进行形式化描述。该区域是周期性的，体积为 $V$，标记粒子 $\\{\\boldsymbol{X}_i\\}_{i=1}^{N}$ 是独立同分布的，在该区域上具有均匀概率密度 $p(\\boldsymbol{r}) = \\frac{1}{V}$。在固定点 $\\boldsymbol{x}$ 处密度的 PIC 估计量是\n$$\n\\tilde{n}(\\boldsymbol{x}) = \\sum_{i=1}^{N} w\\, S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right).\n$$\n我们首先选择权重 $w$ 以确保无偏性，即 $\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = n_0$。利用期望的线性性和独立性，\n$$\n\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = \\sum_{i=1}^{N} w\\, \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right) \\right] = N w\\, \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right],\n$$\n其中 $\\boldsymbol{X}$ 是区域内的一个泛指的均匀随机位置。在均匀分布下，$S$ 的期望为\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] = \\int_{V} \\frac{1}{V} S\\!\\left(\\boldsymbol{x} - \\boldsymbol{r}\\right)\\, \\mathrm{d}^3\\boldsymbol{r}.\n$$\n在假设平移到 $\\boldsymbol{x}$ 的形状函数支撑域完全位于该区域内，并使用归一化条件 $\\int_{\\mathbb{R}^3} S(\\boldsymbol{r})\\,\\mathrm{d}^3\\boldsymbol{r} = 1$ 的情况下，我们有\n$$\n\\int_{V} S\\!\\left(\\boldsymbol{x} - \\boldsymbol{r}\\right)\\, \\mathrm{d}^3\\boldsymbol{r} = 1,\n$$\n所以\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] = \\frac{1}{V}.\n$$\n那么，无偏性条件 $\\mathbb{E}[\\tilde{n}(\\boldsymbol{x})] = n_0$ 给出\n$$\nN w \\left( \\frac{1}{V} \\right) = n_0 \\quad \\Rightarrow \\quad w = \\frac{n_0 V}{N}.\n$$\n\n接下来，我们计算估计量的方差。因为标记粒子是独立同分布的，\n$$\n\\mathrm{Var}\\!\\left( \\tilde{n}(\\boldsymbol{x}) \\right) = \\sum_{i=1}^{N} \\mathrm{Var}\\!\\left( w\\, S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}_i\\right) \\right) = N w^2\\, \\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right).\n$$\n因此，\n$$\n\\mathrm{Var}\\!\\left( \\tilde{n}(\\boldsymbol{x}) \\right) = N \\left( \\frac{n_0 V}{N} \\right)^2 \\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right) = \\frac{n_0^2 V^2}{N} \\, \\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right).\n$$\n\n现在我们计算箱形形状函数的 $\\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right)$。定义指示随机变量 $I$，如果 $\\boldsymbol{X}$ 位于平移到 $\\boldsymbol{x}$ 的 $S$ 的支撑域内，则 $I$ 等于 $1$，否则等于 $0$。$\\boldsymbol{X}$ 位于支撑域内的概率为\n$$\np \\equiv \\mathbb{P}(I = 1) = \\frac{V_s}{V}.\n$$\n对于箱形形状函数，\n$$\nS\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) = \\begin{cases}\n\\frac{1}{V_s},  I = 1, \\\\\n0,  I = 0.\n\\end{cases}\n$$\n因此，$S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right)$ 是一个伯努利混合随机变量，它以概率 $p$ 取值 $\\frac{1}{V_s}$，以概率 $1-p$ 取值 $0$。其均值和二阶矩分别为\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] = p \\cdot \\frac{1}{V_s} = \\frac{V_s}{V} \\cdot \\frac{1}{V_s} = \\frac{1}{V},\n$$\n这与之前的计算结果一致，并且\n$$\n\\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right)^2 \\right] = p \\cdot \\left( \\frac{1}{V_s} \\right)^2 = \\frac{V_s}{V} \\cdot \\frac{1}{V_s^2} = \\frac{1}{V V_s}.\n$$\n因此方差为\n$$\n\\mathrm{Var}\\!\\left( S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right) = \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right)^2 \\right] - \\left( \\mathbb{E}\\!\\left[ S\\!\\left(\\boldsymbol{x} - \\boldsymbol{X}\\right) \\right] \\right)^2 = \\frac{1}{V V_s} - \\left( \\frac{1}{V} \\right)^2 = \\frac{V - V_s}{V^2 V_s}.\n$$\n代入估计量的方差表达式中，得到\n$$\n\\mathrm{Var}\\!\\left( \\tilde{n}(\\boldsymbol{x}) \\right) = \\frac{n_0^2 V^2}{N} \\cdot \\left( \\frac{1}{V V_s} - \\frac{1}{V^2} \\right) = \\frac{n_0^2}{N} \\left( \\frac{V}{V_s} - 1 \\right).\n$$\n相对均方根误差定义为\n$$\n\\epsilon_{\\mathrm{rel}}(\\boldsymbol{x}) \\equiv \\frac{\\sqrt{\\mathrm{Var}(\\tilde{n}(\\boldsymbol{x}))}}{n_0} = \\sqrt{ \\frac{1}{N} \\left( \\frac{V}{V_s} - 1 \\right) }.\n$$\n\n这个结果概括了连续介质与基于粒子的离散化之间的对比：连续介质密度精确为 $n_0$，而基于粒子的估计则表现出采样噪声，该噪声随 $N^{-1/2}$ 变化，并随着支撑域体积 $V_s$ 的缩小（平滑作用减弱）而增大，其对比例 $\\frac{V}{V_s}$ 的依赖性源于给定标记粒子对 $\\boldsymbol{x}$ 处估计值有贡献的概率。周期性区域的假设消除了边界修正；对于 $V \\gg V_s$ 的情况，主要的标度关系为 $\\epsilon_{\\mathrm{rel}} \\sim \\sqrt{\\frac{V}{N V_s}}$。",
            "answer": "$$\\boxed{\\sqrt{\\frac{1}{N}\\left(\\frac{V}{V_s}-1\\right)}}$$"
        },
        {
            "introduction": "与PIC方法中的统计噪声相比，连续介质或基于网格的求解器面临着其自身的数值约束，其中最主要的是显式时间步进格式的Courant–Friedrichs–Lewy（CFL）条件。本练习探讨了CFL限制在多维回旋动理学背景下的实际意义，要求您根据特征速度和网格分辨率确定最大稳定时间步长。这项技能对于确保连续介质回旋动理学代码的稳定性和效率至关重要 。",
            "id": "3959038",
            "problem": "考虑一个用于求解单一离子种类的无碰撞回旋动理学方程的显式有限体积连续介质求解器，该求解器在一个简化的四维相空间 $(x,y,z,v_{\\parallel})$ 中运行。该求解器使用守恒迎风通量、前向欧拉时间积分和维数分裂方法来推进分布函数 $f(x,y,z,v_{\\parallel},t)$。在没有源项和碰撞的情况下，控制方程可以写成线性平流形式\n$$\n\\frac{\\partial f}{\\partial t} + u_x \\frac{\\partial f}{\\partial x} + u_y \\frac{\\partial f}{\\partial y} + v_{\\parallel} \\frac{\\partial f}{\\partial z} + a_{\\parallel} \\frac{\\partial f}{\\partial v_{\\parallel}} = 0,\n$$\n其中 $u_x$ 和 $u_y$ 是最大可分辨的垂直漂移速度（例如，电场叉磁场漂移和磁漂移），$v_{\\parallel}$ 是最大可分辨的平行流速度，而 $a_{\\parallel}$ 是由平行电场引起的最大可分辨的平行加速度。对于显式方法，Courant–Friedrichs–Lewy (CFL) 条件约束了时间步长，以确保对于每个特征方向，数值依赖区域都包含物理依赖区域。\n\n假设在每个坐标上使用均匀网格，间距分别为 $\\Delta x$、$\\Delta y$、$\\Delta z$ 和 $\\Delta v_{\\parallel}$。在整个计算域和时间内，最大可分辨特征速度（或加速度）给出如下\n$u_x^{\\max} = 1.8 \\times 10^{4} \\, \\mathrm{m/s}$，$u_y^{\\max} = 2.2 \\times 10^{3} \\, \\mathrm{m/s}$，$v_{\\parallel}^{\\max} = 7.0 \\times 10^{4} \\, \\mathrm{m/s}$，以及 $a_{\\parallel}^{\\max} = 3.0 \\times 10^{6} \\, \\mathrm{m/s^2}$。网格间距为 $\\Delta x = 2.5 \\times 10^{-3} \\, \\mathrm{m}$，$\\Delta y = 1.5 \\times 10^{-3} \\, \\mathrm{m}$，$\\Delta z = 4.0 \\times 10^{-2} \\, \\mathrm{m}$，以及 $\\Delta v_{\\parallel} = 1.2 \\times 10^{4} \\, \\mathrm{m/s}$。\n\n从特征线的物理解释出发，并根据在一个时间步内信息在任何坐标方向上的传播不超过一个网格单元长度的要求，推导出相应的显式时间步长约束，并计算该求解器的最大稳定CFL时间步长 $\\Delta t_{\\mathrm{CFL}}$，取最严格的方向。请以秒为单位表示您的最终答案，并将结果四舍五入到四位有效数字。",
            "solution": "所提出的问题被判定为有效。它在科学上基于计算流体力学和等离子体物理学的原理，特别是关于显式平流格式的数值稳定性。该问题是适定的，提供了所有必要的数据和明确的目标。它没有歧义、矛盾和主观论断。因此，我们可以进行正式求解。\n\n问题要求基于 Courant–Friedrichs–Lewy (CFL) 条件，计算一个显式有限体积求解器的最大稳定时间步长 $\\Delta t_{\\mathrm{CFL}}$。该求解器用于求解无碰撞回旋动理学方程，在其四维相空间 $(x, y, z, v_{\\parallel})$ 中的线性平流形式如下：\n$$\n\\frac{\\partial f}{\\partial t} + u_x \\frac{\\partial f}{\\partial x} + u_y \\frac{\\partial f}{\\partial y} + v_{\\parallel} \\frac{\\partial f}{\\partial z} + a_{\\parallel} \\frac{\\partial f}{\\partial v_{\\parallel}} = 0\n$$\n此处，$f(x, y, z, v_{\\parallel}, t)$ 是分布函数。系数 $u_x$、$u_y$、$v_{\\parallel}$ 和 $a_{\\parallel}$ 分别代表相空间坐标 $x$、$y$、$z$ 和 $v_{\\parallel}$ 中的平流速度。请注意，$v_{\\parallel}$ 既是 $z$ 方向上的坐标，也是该方向上的平流速度，而 $a_{\\parallel}$ 是 $v_{\\parallel}$ 方向上的平流速度（即加速度）。\n\n对于网格间距为 $\\Delta \\xi$ 的显式、一阶、一维平流格式 $\\frac{\\partial f}{\\partial t} + c \\frac{\\partial f}{\\partial \\xi} = 0$，CFL 条件由库朗数 $C \\le 1$ 给出。库朗数定义为 $C = |c| \\frac{\\Delta t}{\\Delta \\xi}$。此条件确保网格点的数值依赖区域包含物理依赖区域。这意味着在单个时间步 $\\Delta t$ 内，信息传播不能超过一个网格单元。由此产生的时间步长约束为：\n$$\n\\Delta t \\le \\frac{\\Delta \\xi}{|c|}\n$$\n问题指明该求解器采用维数分裂。这意味着四个相空间维度中的平流是独立处理的。因此，时间步长 $\\Delta t$ 必须同时满足每个维度的 CFL 条件。为了保证稳定性，总的时间步长必须小于或等于每个维度所允许的最大时间步长中的最小值。我们必须使用整个计算域中每个方向上的最大平流速度，以确保处处稳定。\n\n让我们为每个维度建立独立的时间步长约束：\n\n1.  对于 $x$ 方向，平流速度为 $u_x$。网格间距为 $\\Delta x$。CFL 约束为：\n    $$\n    \\Delta t \\le \\frac{\\Delta x}{u_x^{\\max}}\n    $$\n2.  对于 $y$ 方向，平流速度为 $u_y$。网格间距为 $\\Delta y$。CFL 约束为：\n    $$\n    \\Delta t \\le \\frac{\\Delta y}{u_y^{\\max}}\n    $$\n3.  对于 $z$ 方向，平流速度为平行速度 $v_{\\parallel}$。网格间距为 $\\Delta z$。CFL 约束为：\n    $$\n    \\Delta t \\le \\frac{\\Delta z}{v_{\\parallel}^{\\max}}\n    $$\n4.  对于 $v_{\\parallel}$ 方向，平流“速度”为平行加速度 $a_{\\parallel}$。网格间距为 $\\Delta v_{\\parallel}$。CFL 约束为：\n    $$\n    \\Delta t \\le \\frac{\\Delta v_{\\parallel}}{a_{\\parallel}^{\\max}}\n    $$\n\n总体最大稳定时间步长 $\\Delta t_{\\mathrm{CFL}}$ 是这四个条件中最严格的一个，即它们的最小值：\n$$\n\\Delta t_{\\mathrm{CFL}} = \\min \\left( \\frac{\\Delta x}{u_x^{\\max}}, \\frac{\\Delta y}{u_y^{\\max}}, \\frac{\\Delta z}{v_{\\parallel}^{\\max}}, \\frac{\\Delta v_{\\parallel}}{a_{\\parallel}^{\\max}} \\right)\n$$\n给定以下数值：\n$u_x^{\\max} = 1.8 \\times 10^{4} \\, \\mathrm{m/s}$\n$u_y^{\\max} = 2.2 \\times 10^{3} \\, \\mathrm{m/s}$\n$v_{\\parallel}^{\\max} = 7.0 \\times 10^{4} \\, \\mathrm{m/s}$\n$a_{\\parallel}^{\\max} = 3.0 \\times 10^{6} \\, \\mathrm{m/s^2}$\n$\\Delta x = 2.5 \\times 10^{-3} \\, \\mathrm{m}$\n$\\Delta y = 1.5 \\times 10^{-3} \\, \\mathrm{m}$\n$\\Delta z = 4.0 \\times 10^{-2} \\, \\mathrm{m}$\n$\\Delta v_{\\parallel} = 1.2 \\times 10^{4} \\, \\mathrm{m/s}$\n\n现在我们计算最小值函数中的每一项：\n\n1.  $\\Delta t_x = \\frac{\\Delta x}{u_x^{\\max}} = \\frac{2.5 \\times 10^{-3} \\, \\mathrm{m}}{1.8 \\times 10^{4} \\, \\mathrm{m/s}} = \\frac{2.5}{1.8} \\times 10^{-7} \\, \\mathrm{s} \\approx 1.3888... \\times 10^{-7} \\, \\mathrm{s}$\n2.  $\\Delta t_y = \\frac{\\Delta y}{u_y^{\\max}} = \\frac{1.5 \\times 10^{-3} \\, \\mathrm{m}}{2.2 \\times 10^{3} \\, \\mathrm{m/s}} = \\frac{1.5}{2.2} \\times 10^{-6} \\, \\mathrm{s} \\approx 0.6818... \\times 10^{-6} \\, \\mathrm{s} = 6.8181... \\times 10^{-7} \\, \\mathrm{s}$\n3.  $\\Delta t_z = \\frac{\\Delta z}{v_{\\parallel}^{\\max}} = \\frac{4.0 \\times 10^{-2} \\, \\mathrm{m}}{7.0 \\times 10^{4} \\, \\mathrm{m/s}} = \\frac{4.0}{7.0} \\times 10^{-6} \\, \\mathrm{s} \\approx 0.5714... \\times 10^{-6} \\, \\mathrm{s} = 5.7142... \\times 10^{-7} \\, \\mathrm{s}$\n4.  $\\Delta t_{v_{\\parallel}} = \\frac{\\Delta v_{\\parallel}}{a_{\\parallel}^{\\max}} = \\frac{1.2 \\times 10^{4} \\, \\mathrm{m/s}}{3.0 \\times 10^{6} \\, \\mathrm{m/s^2}} = \\frac{1.2}{3.0} \\times 10^{-2} \\, \\mathrm{s} = 0.4 \\times 10^{-2} \\, \\mathrm{s} = 4.0 \\times 10^{-3} \\, \\mathrm{s}$\n\n比较这四个时间尺度：\n$\\Delta t_x \\approx 1.389 \\times 10^{-7} \\, \\mathrm{s}$\n$\\Delta t_y \\approx 6.818 \\times 10^{-7} \\, \\mathrm{s}$\n$\\Delta t_z \\approx 5.714 \\times 10^{-7} \\, \\mathrm{s}$\n$\\Delta t_{v_{\\parallel}} = 4000 \\times 10^{-7} \\, \\mathrm{s}$\n\n这些值中的最小值是 $\\Delta t_x$：\n$$\n\\Delta t_{\\mathrm{CFL}} = \\min(1.3888..., 6.8181..., 5.7142..., 4000) \\times 10^{-7} \\, \\mathrm{s} \\approx 1.3888... \\times 10^{-7} \\, \\mathrm{s}\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\n\\Delta t_{\\mathrm{CFL}} \\approx 1.389 \\times 10^{-7} \\, \\mathrm{s}\n$$\n对时间步长最严格的约束来自 $x$ 方向的平流。",
            "answer": "$$\n\\boxed{1.389 \\times 10^{-7}}\n$$"
        }
    ]
}