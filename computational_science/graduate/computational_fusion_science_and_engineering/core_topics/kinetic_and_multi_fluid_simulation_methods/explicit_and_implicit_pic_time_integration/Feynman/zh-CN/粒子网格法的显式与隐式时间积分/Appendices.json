{
    "hands_on_practices": [
        {
            "introduction": "第一个练习旨在揭示粒子模拟（PIC）算法的内在机制，它将指导您完成一个显式模拟的完整时间步。通过手动执行电荷分配、求解场、将场插值回粒子位置以及推动粒子等步骤，您将对PIC代码的核心力学建立具体而基础的理解。这项实践是掌握更复杂模拟技术的基石。",
            "id": "3977527",
            "problem": "考虑一个一维静电粒子模拟 (PIC; Particle-In-Cell) 模型，该模型采用归一化单位，其中电子质量 $m_{e}=1$，电子电荷大小 $e=1$，真空介电常数 $\\varepsilon_{0}=1$。区域是周期性的，长度为 $L=1$，由 $N_{g}=4$ 个等距网格节点离散化，节点位置为 $x_{i}=i\\Delta x$（$i=0,1,2,3$），其中 $\\Delta x=L/N_{g}$。电子是冷的，离子是固定的，提供了一个均匀的中性化背景电荷密度。在整数时间 $t^{n}$ 使用以下数据：\n\n- 两个电子宏粒子，每个电荷为 $q=-1$，位于位置 $x_{1}^{n}=0.125$ 和 $x_{2}^{n}=0.375$。它们在前一个半时间步的速度为 $v_{1}^{n-1/2}=0$ 和 $v_{2}^{n-1/2}=0$。\n- 固定的离子背景电荷密度是均匀的，其值为 $\\rho_{\\mathrm{ion}}=+2$（每单位长度）。\n- 时间步长为 $\\Delta t=0.1$。\n\n在时间 $t^{n}$ 使用标准显式时间积分执行一个完整的 PIC 循环：\n\n1. 使用网格云 (CIC) 方法将电子电荷密度分配到网格节点上。以节点 $x_{i}$ 为中心的线性形函数定义为 $S(x-x_{i})=\\max\\!\\left(0,1-\\frac{|x-x_{i}|}{\\Delta x}\\right)$。位于位置 $x_{p}^{n}$ 的电荷为 $q$ 的粒子对节点 $i$ 的电荷密度贡献为 $q\\,S(x_{p}^{n}-x_{i})/\\Delta x$。叠加来自两个电子和均匀离子背景的贡献，以获得每个节点上的总电荷密度 $\\rho_{i}^{n}$。\n2. 在具有周期性边界条件的网格上求解离散静电泊松方程，\n$$-\\frac{\\phi_{i+1}^{n}-2\\phi_{i}^{n}+\\phi_{i-1}^{n}}{\\Delta x^{2}}=\\frac{\\rho_{i}^{n}}{\\varepsilon_{0}},$$\n以求得静电势 $\\phi_{i}^{n}$，并强制执行规范条件 $\\sum_{i=0}^{N_{g}-1}\\phi_{i}^{n}=0$。然后通过中心差分计算节点上的电场，\n$$E_{i}^{n}=-\\frac{\\phi_{i+1}^{n}-\\phi_{i-1}^{n}}{2\\,\\Delta x}.$$\n3. 使用相同的线性形函数将电场从节点插值到粒子位置，以获得每个电子的 $E(x_{p}^{n})$。\n4. 使用牛顿第二定律和显式蛙跳格式更新来推进电子速度，\n$$v_{p}^{n+1/2}=v_{p}^{n-1/2}+\\frac{q}{m_{e}}\\,E(x_{p}^{n})\\,\\Delta t.$$\n\n计算经过这单个显式 PIC 时间步长后第一个电子的更新速度 $v_{1}^{n+1/2}$。用归一化单位表示你的最终答案，并将结果四舍五入到四位有效数字。",
            "solution": "该问题要求执行一个完整的一维静电粒子模拟 (PIC) 循环。该过程分为问题陈述中指定的四个不同步骤。物理和数值参数均以归一化单位给出。\n\n**参数和网格设置**\n- 区域长度: $L=1$.\n- 网格节点数: $N_g=4$.\n- 网格间距: $\\Delta x = L/N_g = 1/4 = 0.25$.\n- 网格节点位置: $x_i = i\\Delta x$ 对于 $i \\in \\{0, 1, 2, 3\\}$。这给出 $x_0=0$, $x_1=0.25$, $x_2=0.5$, 和 $x_3=0.75$。\n- 归一化物理常数: 电子质量 $m_e=1$，电子电荷大小 $e=1$，真空介电常数 $\\varepsilon_0=1$。\n- 在时间 $t^n$ 的粒子数据：\n    - 电子 1: 电荷 $q=-1$，位置 $x_1^n = 0.125$。\n    - 电子 2: 电荷 $q=-1$，位置 $x_2^n = 0.375$。\n- 在 $t^{n-1/2}$ 的初始速度: $v_1^{n-1/2}=0$ 和 $v_2^{n-1/2}=0$。\n- 背景离子电荷密度: $\\rho_{\\mathrm{ion}}=+2$.\n- 时间步长: $\\Delta t=0.1$.\n\n**第1步：电荷分配**\n\n我们使用网格云 (CIC) 方法将电子电荷分配到网格上。线性形函数为 $S(x-x_i) = \\max \\left(0, 1 - \\frac{|x-x_i|}{\\Delta x}\\right)$。来自粒子 $p$ 的对节点 $i$ 的电荷密度为 $\\rho_{p,i} = q_p S(x_p^n-x_i) / \\Delta x$。\n\n对于位于 $x_1^n=0.125$ 的粒子1：\n该粒子位于节点 $x_0=0$ 和 $x_1=0.25$ 之间。到两个节点的距离均为 0.125。\n插值权重为：\n$w_{1,0} = S(x_1^n-x_0) = 1 - \\frac{|0.125-0|}{0.25} = 1 - 0.5 = 0.5$。\n$w_{1,1} = S(x_1^n-x_1) = 1 - \\frac{|0.125-0.25|}{0.25} = 1 - 0.5 = 0.5$。\n节点 $x_2$ 和 $x_3$ 的权重为 $0$。\n来自粒子1的电荷密度贡献为：\n$\\rho_{1,0} = \\frac{q w_{1,0}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$。\n$\\rho_{1,1} = \\frac{q w_{1,1}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$。\n\n对于位于 $x_2^n=0.375$ 的粒子2：\n该粒子位于节点 $x_1=0.25$ 和 $x_2=0.5$ 之间。到两个节点的距离均为 0.125。\n插值权重为：\n$w_{2,1} = S(x_2^n-x_1) = 1 - \\frac{|0.375-0.25|}{0.25} = 1 - 0.5 = 0.5$。\n$w_{2,2} = S(x_2^n-x_2) = 1 - \\frac{|0.375-0.5|}{0.25} = 1 - 0.5 = 0.5$。\n节点 $x_0$ 和 $x_3$ 的权重为 $0$。\n来自粒子2的电荷密度贡献为：\n$\\rho_{2,1} = \\frac{q w_{2,1}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$。\n$\\rho_{2,2} = \\frac{q w_{2,2}}{\\Delta x} = \\frac{-1 \\times 0.5}{0.25} = -2$。\n\n网格上的总电子电荷密度 $\\rho_{e,i}$ 是两个粒子贡献的总和：\n$\\rho_{e,0} = \\rho_{1,0} + \\rho_{2,0} = -2 + 0 = -2$。\n$\\rho_{e,1} = \\rho_{1,1} + \\rho_{2,1} = -2 + (-2) = -4$。\n$\\rho_{e,2} = \\rho_{1,2} + \\rho_{2,2} = 0 + (-2) = -2$。\n$\\rho_{e,3} = \\rho_{1,3} + \\rho_{2,3} = 0 + 0 = 0$。\n\n总电荷密度 $\\rho_i^n$ 是电子密度和均匀离子背景密度 $\\rho_{\\mathrm{ion}}=+2$ 的总和：\n$\\rho_0^n = \\rho_{e,0} + \\rho_{\\mathrm{ion}} = -2 + 2 = 0$。\n$\\rho_1^n = \\rho_{e,1} + \\rho_{\\mathrm{ion}} = -4 + 2 = -2$。\n$\\rho_2^n = \\rho_{e,2} + \\rho_{\\mathrm{ion}} = -2 + 2 = 0$。\n$\\rho_3^n = \\rho_{e,3} + \\rho_{\\mathrm{ion}} = 0 + 2 = 2$。\n总电荷密度向量为 $\\vec{\\rho}^n = (0, -2, 0, 2)$。\n\n**第2步：场求解**\n\n我们求解具有周期性边界条件的离散泊松方程：$-\\frac{\\phi_{i+1}^n - 2\\phi_i^n + \\phi_{i-1}^n}{\\Delta x^2} = \\frac{\\rho_i^n}{\\varepsilon_0}$。当 $\\varepsilon_0=1$ 和 $\\Delta x=0.25$ 时，这变成了一个关于电势 $\\phi_i^n$ 的线性方程组：\n$$2\\phi_i^n - \\phi_{i+1}^n - \\phi_{i-1}^n = \\Delta x^2 \\rho_i^n = (0.25)^2 \\rho_i^n = 0.0625 \\rho_i^n$$\n索引以 $N_g=4$ 为模。该方程组为：\n$i=0: 2\\phi_0 - \\phi_1 - \\phi_3 = 0.0625 \\times 0 = 0$。\n$i=1: 2\\phi_1 - \\phi_2 - \\phi_0 = 0.0625 \\times (-2) = -0.125$。\n$i=2: 2\\phi_2 - \\phi_3 - \\phi_1 = 0.0625 \\times 0 = 0$。\n$i=3: 2\\phi_3 - \\phi_0 - \\phi_2 = 0.0625 \\times 2 = 0.125$。\n\n从第一个和第三个方程，我们推断出 $2\\phi_0 = \\phi_1 + \\phi_3$ 和 $2\\phi_2 = \\phi_1 + \\phi_3$，这意味着 $\\phi_0 = \\phi_2$。\n将 $\\phi_2 = \\phi_0$ 代入第二个和第四个方程得到：\n$2\\phi_1 - 2\\phi_0 = -0.125 \\implies \\phi_1 - \\phi_0 = -0.0625$。\n$2\\phi_3 - 2\\phi_0 = 0.125 \\implies \\phi_3 - \\phi_0 = 0.0625$。\n我们可以用 $\\phi_0$ 来表示 $\\phi_1$、$\\phi_2$ 和 $\\phi_3$：$\\phi_1 = \\phi_0 - 0.0625$，$\\phi_2 = \\phi_0$，$\\phi_3 = \\phi_0 + 0.0625$。\n使用规范条件 $\\sum_{i=0}^{3} \\phi_i^n = 0$：\n$\\phi_0 + (\\phi_0 - 0.0625) + \\phi_0 + (\\phi_0 + 0.0625) = 4\\phi_0 = 0$，这给出 $\\phi_0=0$。\n电势为：\n$\\phi_0^n = 0$。\n$\\phi_1^n = -0.0625$。\n$\\phi_2^n = 0$。\n$\\phi_3^n = 0.0625$。\n\n接下来，我们使用中心差分公式 $E_i^n = -\\frac{\\phi_{i+1}^n - \\phi_{i-1}^n}{2\\Delta x}$ （其中 $2\\Delta x = 0.5$）计算节点上的电场：\n$E_0^n = -\\frac{\\phi_1 - \\phi_3}{0.5} = -\\frac{-0.0625 - 0.0625}{0.5} = -\\frac{-0.125}{0.5} = 0.25$。\n$E_1^n = -\\frac{\\phi_2 - \\phi_0}{0.5} = -\\frac{0 - 0}{0.5} = 0$。\n$E_2^n = -\\frac{\\phi_3 - \\phi_1}{0.5} = -\\frac{0.0625 - (-0.0625)}{0.5} = -\\frac{0.125}{0.5} = -0.25$。\n$E_3^n = -\\frac{\\phi_0 - \\phi_2}{0.5} = -\\frac{0 - 0}{0.5} = 0$。\n电场向量为 $\\vec{E}^n = (0.25, 0, -0.25, 0)$。\n\n**第3步：电场插值**\n\n我们使用相同的线性形函数（即与第1步中相同的权重）将电场插值到粒子1的位置 $x_1^n=0.125$：\n$E(x_1^n) = \\sum_{i=0}^{3} E_i^n S(x_1^n - x_i) = E_0^n w_{1,0} + E_1^n w_{1,1}$。\n$E(x_1^n) = (0.25 \\times 0.5) + (0 \\times 0.5) = 0.125$。\n\n**第4步：推进电子速度**\n\n最后，我们使用显式蛙跳格式更新粒子1的速度：\n$v_p^{n+1/2} = v_p^{n-1/2} + \\frac{q}{m_e} E(x_p^n) \\Delta t$。\n对于粒子1，我们有 $v_1^{n-1/2}=0$，$q=-1$，$m_e=1$，$E(x_1^n)=0.125$ 和 $\\Delta t=0.1$。\n$v_1^{n+1/2} = 0 + \\frac{-1}{1} \\times 0.125 \\times 0.1$。\n$v_1^{n+1/2} = -0.0125$。\n\n问题要求将结果四舍五入到四位有效数字。计算出的值恰好是 $-0.0125$。为了用四位有效数字表示，我们添加一个尾随的零。\n$v_1^{n+1/2} \\approx -0.01250$。",
            "answer": "$$\\boxed{-0.01250}$$"
        },
        {
            "introduction": "显式PIC模拟功能强大，但受到严格稳定性条件的限制，这些条件决定了所允许的最大时间步长。本练习要求您从第一性原理出发，推导这些基本约束：针对电磁波传播的Courant-Friedrichs-Lewy（CFL）条件，以及解析等离子体振荡的限制。理解这些由光速 $c$ 和等离子体频率 $\\omega_p$ 等物理量决定的约束，对于建立和运行稳定、准确的显式模拟至关重要。",
            "id": "3977923",
            "problem": "一个磁约束聚变等离子体通过一个耦合的显式时域有限差分(FDTD)电磁求解器和一个在均匀三维Yee网格上的蛙跳式网格粒子(PIC)粒子推进器进行建模。电磁场更新在介电常数为 $\\varepsilon_0$、磁导率为 $\\mu_0$ 的真空区域中进行，粒子推进使用冷等离子体电子运动方程。计算域具有均匀的网格间距 $\\Delta x = \\Delta y = \\Delta z = 2 \\,\\text{mm}$。光速为 $c = 3 \\times 10^{8} \\,\\text{m/s}$，等离子体的特征电子等离子体角频率为 $\\omega_p = 5 \\times 10^{10} \\,\\text{s}^{-1}$。\n\n仅从基本定律和核心定义出发\n- 真空中的麦克斯韦方程组 $\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}$ 和 $\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}$，其中 $\\mathbf{D} = \\varepsilon_0 \\mathbf{E}$ 和 $\\mathbf{B} = \\mu_0 \\mathbf{H}$，以及 $c = \\frac{1}{\\sqrt{\\varepsilon_0 \\mu_0}}$，\n- 冷等离子体电子运动方程 $m_e \\frac{d \\mathbf{v}}{d t} = - e \\mathbf{E}$ 和电子等离子体角频率的定义 $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$，\n\n推导以下各项的显式时间积分稳定性约束：\n1. 给定网格上电磁场的 Yee FDTD 更新，以及\n2. 以 $\\omega_p$ 为特征的等离子体电子振荡的蛙跳法离散化，\n\n然后确定保证耦合 FDTD–PIC 更新稳定性的单一最大稳定时间步长 $\\Delta t_{\\max}$。使用给定的数值，以秒为单位表示最终答案，并将答案四舍五入到三位有效数字。",
            "solution": "该问题要求为耦合的网格粒子(PIC)和时域有限差分(FDTD)模拟推导两个独立的稳定性约束，并随后计算出最严格的最大稳定时间步长 $\\Delta t_{\\max}$。这两个约束分别源于电磁场更新(FDTD)和等离子体粒子动力学(PIC蛙跳推进器)。\n\n首先，我们推导在均匀三维Yee网格上真空中麦克斯韦方程组的FDTD更新的稳定性约束。控制方程是麦克斯韦旋度方程：\n$$\n\\nabla \\times \\mathbf{E} = - \\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\n使用真空的本构关系 $\\mathbf{D} = \\varepsilon_0 \\mathbf{E}$ 和 $\\mathbf{B} = \\mu_0 \\mathbf{H}$，这些方程变为：\n$$\n\\nabla \\times \\mathbf{E} = - \\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}\n$$\n为了获得波动方程，我们对第一个方程取旋度，并使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$。\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = - \\mu_0 \\frac{\\partial}{\\partial t} (\\nabla \\times \\mathbf{H})\n$$\n$$\n\\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E} = - \\mu_0 \\frac{\\partial}{\\partial t} \\left(\\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}\\right)\n$$\n在无源真空区域，高斯定律给出 $\\nabla \\cdot \\mathbf{E} = 0$。使用真空中光速的定义 $c = \\frac{1}{\\sqrt{\\varepsilon_0 \\mu_0}}$，该方程简化为齐次矢量波动方程：\n$$\n\\nabla^2 \\mathbf{E} - \\frac{1}{c^2} \\frac{\\partial^2 \\mathbf{E}}{\\partial t^2} = 0\n$$\n该方程的显式FDTD方法的稳定性由Courant-Friedrichs-Lewy (CFL)条件决定。对于间距为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 的均匀三维网格，CFL条件要求数值依赖域必须包含物理依赖域。对于Yee网格上的标准蛙跳FDTD格式，此条件为：\n$$\nc \\Delta t \\leq \\frac{1}{\\sqrt{\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} + \\frac{1}{(\\Delta z)^2}}}\n$$\n问题指定了一个均匀网格，其中 $\\Delta x = \\Delta y = \\Delta z = \\Delta s$。将此代入不等式得到：\n$$\nc \\Delta t \\leq \\frac{1}{\\sqrt{\\frac{1}{(\\Delta s)^2} + \\frac{1}{(\\Delta s)^2} + \\frac{1}{(\\Delta s)^2}}} = \\frac{1}{\\sqrt{\\frac{3}{(\\Delta s)^2}}} = \\frac{\\Delta s}{\\sqrt{3}}\n$$\n这给出了对时间步长的第一个稳定性约束 $\\Delta t_{\\text{CFL}}$：\n$$\n\\Delta t \\leq \\Delta t_{\\text{CFL}} = \\frac{\\Delta s}{c \\sqrt{3}}\n$$\n\n其次，我们推导等离子体电子振荡的蛙跳积分的稳定性约束。动力学由冷等离子体电子运动方程和电流密度定义 $\\mathbf{J} = -n_0 e \\mathbf{v}$ 描述，其中 $n_0$ 是平衡电子密度，$-e$ 是电子电荷，$\\mathbf{v}$ 是电子流体速度。\n运动方程由下式给出：\n$$\nm_e \\frac{d \\mathbf{v}}{d t} = - e \\mathbf{E}\n$$\n对电流密度定义求时间导数：\n$$\n\\frac{d \\mathbf{J}}{d t} = -n_0 e \\frac{d \\mathbf{v}}{d t}\n$$\n将运动方程代入此表达式得到：\n$$\n\\frac{d \\mathbf{J}}{d t} = -n_0 e \\left( -\\frac{e}{m_e} \\mathbf{E} \\right) = \\frac{n_0 e^2}{m_e} \\mathbf{E}\n$$\n我们使用给定的电子等离子体角频率定义 $\\omega_p^2 = \\frac{n_0 e^2}{\\varepsilon_0 m_e}$，将系数重写为 $\\frac{n_0 e^2}{m_e} = \\varepsilon_0 \\omega_p^2$。因此：\n$$\n\\frac{d \\mathbf{J}}{d t} = \\varepsilon_0 \\omega_p^2 \\mathbf{E}\n$$\n为了找到特征振荡，我们考虑磁场可以忽略的高频静电极限。在没有空间变化的情况下（即对于长波模式，其中 $\\nabla \\times \\mathbf{H} \\approx 0$），安培定律 $\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$ 简化为 $\\mathbf{J} + \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} \\approx 0$。这给出了 $\\frac{\\partial \\mathbf{E}}{\\partial t} \\approx -\\frac{1}{\\varepsilon_0}\\mathbf{J}$。\n对 $\\frac{d \\mathbf{J}}{d t} = \\varepsilon_0 \\omega_p^2 \\mathbf{E}$ 求时间导数得到：\n$$\n\\frac{d^2 \\mathbf{J}}{d t^2} = \\varepsilon_0 \\omega_p^2 \\frac{d \\mathbf{E}}{d t}\n$$\n代入 $\\frac{d \\mathbf{E}}{d t} \\approx -\\frac{1}{\\varepsilon_0}\\mathbf{J}$，我们得到等离子体电流的简谐振子方程：\n$$\n\\frac{d^2 \\mathbf{J}}{d t^2} = \\varepsilon_0 \\omega_p^2 \\left( -\\frac{1}{\\varepsilon_0} \\mathbf{J} \\right) = -\\omega_p^2 \\mathbf{J} \\quad \\implies \\quad \\frac{d^2 \\mathbf{J}}{d t^2} + \\omega_p^2 \\mathbf{J} = 0\n$$\n这个方程描述了在等离子体频率 $\\omega_p$ 上的振荡。对于一个蛙跳格式，在积分形式为 $\\ddot{x} + \\omega^2 x = 0$ 的振子方程时要保持数值稳定，时间步长 $\\Delta t$ 必须能解析该振荡。标准蛙跳积分器的稳定性极限是：\n$$\n\\omega \\Delta t \\le 2\n$$\n将此应用于等离子体振荡，其中最高频率为 $\\omega_p$，我们得到第二个稳定性约束 $\\Delta t_{\\text{plasma}}$：\n$$\n\\Delta t \\le \\Delta t_{\\text{plasma}} = \\frac{2}{\\omega_p}\n$$\n注意，为了保证精度，通常会使用一个更严格的条件（例如 $\\omega_p \\Delta t \\lesssim 0.2$），但问题要求的是基本的稳定性约束。\n\n最后，为了使耦合的 FDTD-PIC 模拟保持稳定，单个时间步长 $\\Delta t$ 必须同时满足这两个约束。因此，最大稳定时间步长 $\\Delta t_{\\max}$ 是两个单独极限中的较小者：\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\text{CFL}}, \\Delta t_{\\text{plasma}}) = \\min\\left(\\frac{\\Delta s}{c \\sqrt{3}}, \\frac{2}{\\omega_p}\\right)\n$$\n我们现在代入给定的数值：\n$\\Delta s = 2 \\,\\text{mm} = 2 \\times 10^{-3} \\,\\text{m}$\n$c = 3 \\times 10^{8} \\,\\text{m/s}$\n$\\omega_p = 5 \\times 10^{10} \\,\\text{s}^{-1}$\n\n计算 $\\Delta t_{\\text{CFL}}$：\n$$\n\\Delta t_{\\text{CFL}} = \\frac{2 \\times 10^{-3} \\,\\text{m}}{(3 \\times 10^{8} \\,\\text{m/s}) \\sqrt{3}} = \\frac{2}{3 \\sqrt{3}} \\times 10^{-11} \\,\\text{s} \\approx 0.38490 \\times 10^{-11} \\,\\text{s} = 3.8490 \\times 10^{-12} \\,\\text{s}\n$$\n计算 $\\Delta t_{\\text{plasma}}$：\n$$\n\\Delta t_{\\text{plasma}} = \\frac{2}{5 \\times 10^{10} \\,\\text{s}^{-1}} = 0.4 \\times 10^{-10} \\,\\text{s} = 4 \\times 10^{-11} \\,\\text{s}\n$$\n比较这两个值：\n$3.8490 \\times 10^{-12} \\,\\text{s}  4 \\times 10^{-11} \\,\\text{s}$\n因此，CFL条件更具限制性。最大稳定时间步长由 $\\Delta t_{\\text{CFL}}$ 确定。\n$$\n\\Delta t_{\\max} = 3.8490 \\times 10^{-12} \\,\\text{s}\n$$\n按要求将结果四舍五入到三位有效数字，我们得到：\n$$\n\\Delta t_{\\max} \\approx 3.85 \\times 10^{-12} \\,\\text{s}\n$$",
            "answer": "$$\\boxed{3.85 \\times 10^{-12}}$$"
        },
        {
            "introduction": "隐式方法为克服显式方案的严格时间步长限制提供了一条途径，但它们也引入了自身的数值特性。本练习针对粒子回旋运动这一重要的等离子体物理现象，比较了两种常见的隐式积分器——后向欧拉法和隐式中点法。通过分析它们的稳定性、数值耗散和相位精度，您将对选择隐式求解器时涉及的关键权衡（例如能量守恒与计算成本）形成深刻的直觉。",
            "id": "3977459",
            "problem": "考虑将质点网格法 (PIC) 应用于带电粒子在均匀磁场中的自由回旋运动。该粒子遵循无电场情况下的洛伦兹力，其运动方程在恒定磁场 $\\mathbf{B} = B \\, \\hat{\\mathbf{z}}$ 中由 $m \\, d\\mathbf{v}/dt = q \\, \\mathbf{v} \\times \\mathbf{B}$ 给出，其中 $m$ 是质量， $q$ 是电荷，$\\mathbf{v}$ 是速度。定义回旋频率 $\\Omega = q B / m$ 和离散时间步长 $\\Delta t$，并令 $a = \\Omega \\, \\Delta t$。在垂直于 $\\mathbf{B}$ 的平面内，连续动力学简化为以角速度 $\\Omega$ 进行的匀速率旋转。\n\n你需要分析和比较两种用于更新速度的隐式粒子推进格式：后向欧拉法和隐式中点法。从上述基本运动方程出发，完成以下任务：\n\n- 对于后向欧拉法和隐式中点法，推导在垂直于 $\\mathbf{B}$ 的平面内速度 $\\mathbf{v}^{n} \\mapsto \\mathbf{v}^{n+1}$ 的离散线性更新。\n- 对每种方法，确定其格式是否无条件稳定，并根据速度大小的单步放大因子来描述其数值耗散或能量守恒特性。\n- 对每种方法，确定其在平面内的单步数值旋转角，并将其与精确的角增量 $a$ 联系起来。\n- 设粒子演化 $K$ 个回旋周期，总连续时间为 $T = K \\, 2 \\pi / \\Omega$，时间步数为 $N = T / \\Delta t = K \\, 2 \\pi / a$。计算每种格式在 $K$ 个回旋周期内的累积相位误差（数值累积的旋转角与精确角度 $K \\, 2 \\pi$ 之间的差值），并用 $a$ 和 $K$ 的闭式解析表达式表示你的最终答案（单位为弧度）。\n\n以弧度为单位，给出后向欧拉法和隐式中点法的最终累积相位误差。无需进行数值计算；仅提供闭式表达式。最终答案必须是包含两种相位误差的单个复合表达式。",
            "solution": "该问题要求分析两种隐式数值积分格式——后向欧拉法和隐式中点法——应用于带电粒子在均匀磁场中回旋运动时的表现。粒子速度 $\\mathbf{v}$ 的控制方程是无电场情况下的洛伦兹力方程：\n$$m \\frac{d\\mathbf{v}}{dt} = q (\\mathbf{v} \\times \\mathbf{B})$$\n给定恒定磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$，该方程简化为：\n$$ \\frac{d\\mathbf{v}}{dt} = \\frac{qB}{m} (\\mathbf{v} \\times \\hat{\\mathbf{z}}) $$\n定义回旋频率 $\\Omega = \\frac{qB}{m}$，方程变为：\n$$ \\frac{d\\mathbf{v}}{dt} = \\Omega (\\mathbf{v} \\times \\hat{\\mathbf{z}}) $$\n设速度矢量为 $\\mathbf{v} = v_x \\hat{\\mathbf{x}} + v_y \\hat{\\mathbf{y}} + v_z \\hat{\\mathbf{z}}$。叉积为 $\\mathbf{v} \\times \\hat{\\mathbf{z}} = v_y \\hat{\\mathbf{x}} - v_x \\hat{\\mathbf{y}}$。分量形式的运动方程为：\n$$ \\frac{dv_x}{dt} = \\Omega v_y $$\n$$ \\frac{dv_y}{dt} = -\\Omega v_x $$\n$$ \\frac{dv_z}{dt} = 0 $$\n平行于磁场的速度分量 $v_z$ 是恒定的。我们关注垂直于 $\\mathbf{B}$ 的平面内的速度，记为 $\\mathbf{v}_{\\perp} = \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix}$。该系统可以写成矩阵形式：\n$$ \\frac{d\\mathbf{v}_{\\perp}}{dt} = \\begin{pmatrix} 0  \\Omega \\\\ -\\Omega  0 \\end{pmatrix} \\mathbf{v}_{\\perp} $$\n设 $\\mathbf{v}_{\\perp}^n$ 为时间 $t_n = n \\Delta t$ 时的速度。我们现在将为指定的两种方法推导更新规则 $\\mathbf{v}_{\\perp}^n \\mapsto \\mathbf{v}_{\\perp}^{n+1}$。\n\n首先，我们分析后向欧拉法。对于一般的常微分方程 $\\frac{d\\mathbf{y}}{dt} = f(\\mathbf{y})$，后向欧拉格式为 $\\mathbf{y}^{n+1} = \\mathbf{y}^n + \\Delta t f(\\mathbf{y}^{n+1})$。对于我们的线性系统，这变为：\n$$ \\mathbf{v}_{\\perp}^{n+1} = \\mathbf{v}_{\\perp}^n + \\Delta t \\begin{pmatrix} 0  \\Omega \\\\ -\\Omega  0 \\end{pmatrix} \\mathbf{v}_{\\perp}^{n+1} $$\n我们重排方程以求解 $\\mathbf{v}_{\\perp}^{n+1}$：\n$$ \\left( \\mathbf{I} - \\Delta t \\begin{pmatrix} 0  \\Omega \\\\ -\\Omega  0 \\end{pmatrix} \\right) \\mathbf{v}_{\\perp}^{n+1} = \\mathbf{v}_{\\perp}^n $$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。使用定义 $a = \\Omega \\Delta t$，该方程为：\n$$ \\begin{pmatrix} 1  -a \\\\ a  1 \\end{pmatrix} \\mathbf{v}_{\\perp}^{n+1} = \\mathbf{v}_{\\perp}^n $$\n通过对左侧矩阵求逆，可以得到离散线性更新。该矩阵的行列式为 $1 \\cdot 1 - (-a)(a) = 1+a^2$。其逆矩阵为 $\\frac{1}{1+a^2} \\begin{pmatrix} 1  a \\\\ -a  1 \\end{pmatrix}$。因此，后向欧拉法的更新规则是：\n$$ \\mathbf{v}_{\\perp}^{n+1} = \\mathbf{M}_{BE} \\mathbf{v}_{\\perp}^n = \\frac{1}{1+a^2} \\begin{pmatrix} 1  a \\\\ -a  1 \\end{pmatrix} \\mathbf{v}_{\\perp}^n $$\n为了评估稳定性，我们考察速度大小的放大情况。大小的平方为 $|\\mathbf{v}_{\\perp}^{n+1}|^2 = (\\mathbf{v}_{\\perp}^{n+1})^T \\mathbf{v}_{\\perp}^{n+1}$。\n$$ |\\mathbf{v}_{\\perp}^{n+1}|^2 = (\\mathbf{M}_{BE} \\mathbf{v}_{\\perp}^n)^T (\\mathbf{M}_{BE} \\mathbf{v}_{\\perp}^n) = (\\mathbf{v}_{\\perp}^n)^T \\mathbf{M}_{BE}^T \\mathbf{M}_{BE} \\mathbf{v}_{\\perp}^n $$\n$$ \\mathbf{M}_{BE}^T \\mathbf{M}_{BE} = \\frac{1}{(1+a^2)^2} \\begin{pmatrix} 1  -a \\\\ a  1 \\end{pmatrix} \\begin{pmatrix} 1  a \\\\ -a  1 \\end{pmatrix} = \\frac{1}{(1+a^2)^2} \\begin{pmatrix} 1+a^2  0 \\\\ 0  1+a^2 \\end{pmatrix} = \\frac{1}{1+a^2} \\mathbf{I} $$\n因此， $|\\mathbf{v}_{\\perp}^{n+1}|^2 = \\frac{1}{1+a^2} |\\mathbf{v}_{\\perp}^n|^2$。速度大小的单步放大因子为 $\\lambda_{BE} = \\sqrt{\\frac{1}{1+a^2}} = (1+a^2)^{-1/2}$。由于 $a^2 \\ge 0$，对于所有 $\\Delta t$，都有 $\\lambda_{BE} \\le 1$。该格式是无条件稳定的。对于任何非零时间步长，$\\lambda_{BE}  1$，这表明该格式是数值耗散的，会不断减小粒子的动能。\n每步的数值旋转角 $\\theta_{BE}$，可以通过将 $\\mathbf{M}_{BE}$ 写成一个缩放的旋转矩阵来找到。一个顺时针旋转角度 $\\theta$ 的矩阵表示为 $\\begin{pmatrix} \\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta \\end{pmatrix}$。我们有：\n$$ \\mathbf{M}_{BE} = (1+a^2)^{-1/2} \\begin{pmatrix} (1+a^2)^{-1/2}  a(1+a^2)^{-1/2} \\\\ -a(1+a^2)^{-1/2}  (1+a^2)^{-1/2} \\end{pmatrix} = \\lambda_{BE} \\begin{pmatrix} \\cos\\theta_{BE}  \\sin\\theta_{BE} \\\\ -\\sin\\theta_{BE}  \\cos\\theta_{BE} \\end{pmatrix} $$\n由此，我们识别出 $\\cos\\theta_{BE} = \\frac{1}{\\sqrt{1+a^2}}$ 和 $\\sin\\theta_{BE} = \\frac{a}{\\sqrt{1+a^2}}$。因此角度由 $\\tan\\theta_{BE} = a$ 给出，即 $\\theta_{BE} = \\arctan(a)$。一个时间步内的精确旋转角是 $a = \\Omega \\Delta t$。由于当 $a > 0$ 时 $\\arctan(a)  a$，后向欧拉法会产生相位滞后。\n\n接下来，我们分析隐式中点法。对于一般的常微分方程 $\\frac{d\\mathbf{y}}{dt} = f(\\mathbf{y})$，该格式为 $\\mathbf{y}^{n+1} = \\mathbf{y}^n + \\Delta t f\\left(\\frac{\\mathbf{y}^n + \\mathbf{y}^{n+1}}{2}\\right)$。对于我们的系统，它变为：\n$$ \\mathbf{v}_{\\perp}^{n+1} = \\mathbf{v}_{\\perp}^n + \\Delta t \\begin{pmatrix} 0  \\Omega \\\\ -\\Omega  0 \\end{pmatrix} \\left( \\frac{\\mathbf{v}_{\\perp}^n + \\mathbf{v}_{\\perp}^{n+1}}{2} \\right) $$\n重排以求解 $\\mathbf{v}_{\\perp}^{n+1}$：\n$$ \\left( \\mathbf{I} - \\frac{\\Omega \\Delta t}{2} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\right) \\mathbf{v}_{\\perp}^{n+1} = \\left( \\mathbf{I} + \\frac{\\Omega \\Delta t}{2} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\right) \\mathbf{v}_{\\perp}^n $$\n使用 $a = \\Omega \\Delta t$：\n$$ \\begin{pmatrix} 1  -a/2 \\\\ a/2  1 \\end{pmatrix} \\mathbf{v}_{\\perp}^{n+1} = \\begin{pmatrix} 1  a/2 \\\\ -a/2  1 \\end{pmatrix} \\mathbf{v}_{\\perp}^n $$\n更新矩阵 $\\mathbf{M}_{IM}$ 由以下乘积给出：\n$$ \\mathbf{M}_{IM} = \\begin{pmatrix} 1  -a/2 \\\\ a/2  1 \\end{pmatrix}^{-1} \\begin{pmatrix} 1  a/2 \\\\ -a/2  1 \\end{pmatrix} $$\n其逆矩阵为 $\\left(1+\\frac{a^2}{4}\\right)^{-1} \\begin{pmatrix} 1  a/2 \\\\ -a/2  1 \\end{pmatrix}$。所以，\n$$ \\mathbf{M}_{IM} = \\frac{1}{1+a^2/4} \\begin{pmatrix} 1  a/2 \\\\ -a/2  1 \\end{pmatrix} \\begin{pmatrix} 1  a/2 \\\\ -a/2  1 \\end{pmatrix} = \\frac{1}{1+a^2/4} \\begin{pmatrix} 1-a^2/4  a \\\\ -a  1-a^2/4 \\end{pmatrix} $$\n为了评估稳定性，我们检查 $\\mathbf{M}_{IM}$ 是否为正交矩阵。第一列的范数平方为 $\\frac{(1-a^2/4)^2 + (-a)^2}{(1+a^2/4)^2} = \\frac{1-a^2/2+a^4/16 + a^2}{(1+a^2/4)^2} = \\frac{1+a^2/2+a^4/16}{(1+a^2/4)^2} = 1$。第二列具有相同的范数。两列的点积为 $\\frac{(1-a^2/4)(a) + (-a)(1-a^2/4)}{(1+a^2/4)^2} = 0$。由于 $\\mathbf{M}_{IM}$ 是一个正交矩阵，它保持向量的范数不变。因此， $|\\mathbf{v}_{\\perp}^{n+1}|^2 = |\\mathbf{v}_{\\perp}^n|^2$。放大因子为 $\\lambda_{IM} = 1$。隐式中点法精确地守恒该系统的动能，并且是无条件稳定的。\n矩阵 $\\mathbf{M}_{IM}$ 是一个纯旋转矩阵。每步的数值旋转角 $\\theta_{IM}$ 可以通过识别以下各项来找到：\n$$ \\cos\\theta_{IM} = \\frac{1-a^2/4}{1+a^2/4} \\quad \\text{和} \\quad \\sin\\theta_{IM} = \\frac{a}{1+a^2/4} $$\n使用半角正切恒等式，令 $a/2 = \\tan(\\phi)$，我们发现 $\\cos\\theta_{IM} = \\frac{1-\\tan^2\\phi}{1+\\tan^2\\phi} = \\cos(2\\phi)$ 以及 $\\sin\\theta_{IM} = \\frac{2\\tan\\phi}{1+\\tan^2\\phi} = \\sin(2\\phi)$。因此，$\\theta_{IM} = 2\\phi = 2\\arctan(a/2)$。这是对精确角度 $a$ 的二阶精确近似，因为 $2\\arctan(a/2) = 2(a/2 - (a/2)^3/3 + \\dots) = a - a^3/12 + O(a^5)$。该格式同样会产生相位滞后，但对于较小的 $a$，其滞后远小于后向欧拉法。\n\n最后，我们计算在 $K$ 个回旋周期内的累积相位误差。总时间为 $T = K \\frac{2\\pi}{\\Omega}$，所以时间步数为 $N = \\frac{T}{\\Delta t} = \\frac{K 2\\pi / \\Omega}{\\Delta t} = \\frac{K 2\\pi}{a}$。精确的累积旋转角是 $N a = K 2\\pi$。\n\n对于后向欧拉法，累积的数值角度为 $N \\theta_{BE} = \\frac{K 2\\pi}{a} \\arctan(a)$。累积相位误差 $\\Delta \\Phi_{BE}$ 是数值角度与精确角度之间的差值：\n$$ \\Delta \\Phi_{BE} = \\frac{K 2\\pi}{a} \\arctan(a) - K 2\\pi = 2\\pi K \\left( \\frac{\\arctan a}{a} - 1 \\right) $$\n\n对于隐式中点法，累积的数值角度为 $N \\theta_{IM} = \\frac{K 2\\pi}{a} [2\\arctan(a/2)]$。累积相位误差 $\\Delta \\Phi_{IM}$ 是：\n$$ \\Delta \\Phi_{IM} = \\frac{K 4\\pi}{a} \\arctan(a/2) - K 2\\pi = 2\\pi K \\left( \\frac{2\\arctan(a/2)}{a} - 1 \\right) $$\n这些表达式代表了每种格式在 $K$ 个精确回旋周期后以弧度为单位的总相位滞后。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2\\pi K \\left( \\frac{\\arctan(a)}{a} - 1 \\right)  2\\pi K \\left( \\frac{2\\arctan\\left(\\frac{a}{2}\\right)}{a} - 1 \\right) \\end{pmatrix}}$$"
        }
    ]
}