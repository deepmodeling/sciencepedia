{
    "hands_on_practices": [
        {
            "introduction": "在将等离子体动力学方程付诸计算机求解之前，一个至关重要的步骤是无量纲化。这个过程不仅可以简化方程，还能揭示控制系统行为的关键物理参数。本练习将指导你对完整的符拉索夫-泊松（Vlasov-Poisson）方程组进行系统的无量纲化 ，通过此过程你将亲手推导出德拜长度与系统尺寸之比（$\\lambda_D/L_0$）和离子声速拉莫尔半径与系统尺寸之比（$\\rho_s/L_0$）等重要无量纲参数是如何自然地出现在方程中的。",
            "id": "3983063",
            "problem": "考虑一个磁化的、静电的、多组分等离子体，该等离子体在具有均匀磁场 $\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{b}}$ 的板状区域内，由全分布函数（“full-$f$”）动理学系统描述。等离子体包含电荷为 $-e$、质量为 $m_e$ 的电子，以及电荷为 $+e$、质量为 $m_i$ 的单电荷离子。其演化由无碰撞 Vlasov 方程与关于静电势的泊松方程耦合决定。令 $f_s(\\mathbf{x},\\mathbf{v},t)$ 表示组分 $s \\in \\{e,i\\}$ 的相空间密度，$n_s(\\mathbf{x},t) = \\int f_s(\\mathbf{x},\\mathbf{v},t)\\,\\mathrm{d}^3 v$ 表示数密度，$\\phi(\\mathbf{x},t)$ 表示静电势，电场为 $\\mathbf{E}(\\mathbf{x},t) = -\\nabla \\phi(\\mathbf{x},t)$。控制方程的有量纲形式为\n$$\n\\frac{\\partial f_s}{\\partial t} + \\mathbf{v}\\cdot\\nabla f_s + \\frac{q_s}{m_s}\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}_0\\right)\\cdot \\nabla_{\\mathbf{v}} f_s = 0,\n$$\n和\n$$\n-\\varepsilon_0 \\nabla^2 \\phi = \\sum_s q_s n_s,\n$$\n其中 $q_e = -e$ 且 $q_i = +e$。\n\n从这些定律出发，仅使用第一性原理定义，基于参考标度 $(n_0,T_0,B_0,L_0)$ 构造一个自洽的无量纲化。其中 $n_0$ 是特征密度，$T_0$ 是特征电子温度，$B_0$ 是均匀磁场的大小，$L_0$ 是特征宏观长度。通过为长度、时间、速度、分布函数和势指定物理标度，来定义无量纲变量 $\\mathbf{x}'$、$t'$、$\\mathbf{v}'$、$f_s'$ 和 $\\phi'$。使用由 $T_0$ 和 $m_i$ 构成的离子声速 $c_s$ 来设定速度标度，并选择静电势标度，使得电场标度与由 $T_0$ 在 $L_0$ 上构成的压力梯度一致。推导离子 Vlasov 方程和泊松方程的无量纲形式，并明确展示由德拜长度 $\\lambda_D$ 和离子声速回旋半径 $\\rho_s$ 构成的无量纲比率如何分别作为系数出现在泊松方程的拉普拉斯算子项前和 Vlasov 方程的磁场项前。\n\n将你的最终答案表示为两个无量纲系数的精确解析表达式，这两个系数分别乘以无量纲泊松方程中的拉普拉斯项和无量纲离子 Vlasov 方程中的 $(\\mathbf{v}'\\times \\hat{\\mathbf{b}})\\cdot \\nabla_{\\mathbf{v}'} f_i'$ 项。表达式应仅用 $(n_0,T_0,B_0,L_0)$ 和基本常数 $e$、$m_i$、$k_B$ 和 $\\varepsilon_0$ 书写。以行矩阵的形式提供最终答案，其中第一个元素是泊松方程中的系数，第二个元素是离子 Vlasov 方程磁场项中的系数。最终答案必须是单一的、无单位的闭合形式解析表达式。",
            "solution": "该问题陈述是等离子体物理中一个标准的推导练习。它基于基本的 Vlasov-泊松系统，具有科学依据、适定且客观。唯一推导所需的所有必要信息和约束条件均已提供。因此，该问题被认为是有效的。\n\n任务是无量纲化 Vlasov-泊松系统，并找出分别乘以泊松方程中拉普拉斯算子和离子 Vlasov 方程中磁力项的无量纲系数。无量纲化将基于参考标度 $(n_0, T_0, B_0, L_0)$。\n\n首先，我们为所有相关物理量建立特征物理标度。\n1.  长度标度：特征宏观长度 $L_0$ 已被给定为长度的参考标度，因此 $[x] = L_0$。\n2.  速度标度：问题指定使用由电子温度 $T_0$ 和离子质量 $m_i$ 定义的离子声速 $c_s$。因此，速度标度为 $v_{ref} = c_s = \\sqrt{k_B T_0 / m_i}$。\n3.  时间标度：一个自然的时间标度是以参考速度运动的粒子穿过参考长度标度的渡越时间，因此 $t_{ref} = L_0 / v_{ref} = L_0 / c_s$。\n4.  势和电场标度：问题要求选择静电势标度 $\\phi_{ref}$，使得电场标度 $E_{ref}$ 与由 $T_0$ 在 $L_0$ 上构成的压力梯度标度一致。热能密度（与压力成正比）的量级为 $n_0 k_B T_0$。由压力梯度产生的单位体积力为 $\\nabla p \\sim n_0 k_B T_0 / L_0$。单位体积电力为 $\\rho E \\sim (n_0 e) E$。令这些力密度相等，得到电场的标度：$E_{ref} = \\frac{k_B T_0}{e L_0}$。由于 $\\mathbf{E} = -\\nabla \\phi$，我们有 $E_{ref} = \\phi_{ref} / L_0$，这给出了势标度 $\\phi_{ref} = E_{ref} L_0 = \\frac{k_B T_0}{e}$。\n5.  分布函数标度：数密度 $n_s$ 是分布函数 $f_s$ 在速度空间上的积分，$n_s = \\int f_s d^3v$。因此，这些标度之间的关系为 $n_{ref} \\sim f_{ref} v_{ref}^3$。使用参考密度 $n_0$，我们得到 $f_{ref} = n_0 / v_{ref}^3 = n_0 / c_s^3$。\n\n我们现在定义无量纲（带撇）变量：\n$$ \\mathbf{x} = L_0 \\mathbf{x}', \\quad t = \\frac{L_0}{c_s} t', \\quad \\mathbf{v} = c_s \\mathbf{v}', \\quad \\phi = \\frac{k_B T_0}{e} \\phi' $$\n$$ n_s = n_0 n_s', \\quad f_s = \\frac{n_0}{c_s^3} f_s', \\quad \\mathbf{E} = \\frac{k_B T_0}{e L_0} \\mathbf{E}' $$\n微分算子变换如下：\n$$ \\nabla = \\frac{1}{L_0} \\nabla', \\quad \\frac{\\partial}{\\partial t} = \\frac{c_s}{L_0} \\frac{\\partial}{\\partial t'}, \\quad \\nabla_{\\mathbf{v}} = \\frac{1}{c_s} \\nabla'_{\\mathbf{v}'} $$\n注意，关系式 $\\mathbf{E} = -\\nabla \\phi$ 变为 $\\frac{k_B T_0}{e L_0} \\mathbf{E}' = -\\frac{1}{L_0} \\nabla' \\left(\\frac{k_B T_0}{e} \\phi'\\right) = -\\frac{k_B T_0}{e L_0} \\nabla' \\phi'$，这证实了 $\\mathbf{E}' = -\\nabla'\\phi'$。\n\n接下来，我们对泊松方程进行无量纲化：\n$$ -\\varepsilon_0 \\nabla^2 \\phi = \\sum_s q_s n_s = e(n_i - n_e) $$\n代入无量纲变量和标度：\n$$ -\\varepsilon_0 \\left(\\frac{1}{L_0^2} \\nabla'^2\\right) \\left(\\frac{k_B T_0}{e} \\phi'\\right) = e (n_0 n_i' - n_0 n_e') $$\n$$ -\\frac{\\varepsilon_0 k_B T_0}{e L_0^2} \\nabla'^2 \\phi' = e n_0 (n_i' - n_e') $$\n为了找到乘以拉普拉斯项的系数，我们重新整理方程。一个常见的约定是将归一化的电荷密度放在右侧。\n$$ \\left(\\frac{\\varepsilon_0 k_B T_0}{n_0 e^2 L_0^2}\\right) \\nabla'^2 \\phi' = -(n_i' - n_e') $$\n问题要求的是乘以拉普拉斯项 $\\nabla'^2 \\phi'$ 的系数。因此，该系数是：\n$$ C_{Poisson} = \\frac{\\varepsilon_0 k_B T_0}{n_0 e^2 L_0^2} $$\n这可以被看作是 $(\\lambda_D/L_0)^2$，其中 $\\lambda_D = \\sqrt{\\varepsilon_0 k_B T_0 / (n_0 e^2)}$ 是基于参考参数的电子德拜长度。\n\n现在，我们对离子的 Vlasov 方程（$s=i$, $q_i=+e$）进行无量纲化：\n$$ \\frac{\\partial f_i}{\\partial t} + \\mathbf{v}\\cdot\\nabla f_i + \\frac{e}{m_i}\\left(\\mathbf{E} + \\mathbf{v}\\times \\mathbf{B}_0\\right)\\cdot \\nabla_{\\mathbf{v}} f_i = 0 $$\n代入无量纲变量和微分算子：\n$$ \\left(\\frac{c_s}{L_0}\\frac{\\partial}{\\partial t'}\\right)\\left(\\frac{n_0}{c_s^3}f_i'\\right) + (c_s\\mathbf{v}')\\cdot\\left(\\frac{1}{L_0}\\nabla'\\right)\\left(\\frac{n_0}{c_s^3}f_i'\\right) + \\frac{e}{m_i}\\left(\\frac{k_B T_0}{eL_0}\\mathbf{E}' + (c_s\\mathbf{v}')\\times (B_0\\hat{\\mathbf{b}})\\right)\\cdot \\left(\\frac{1}{c_s}\\nabla'_{\\mathbf{v}'}\\right)\\left(\\frac{n_0}{c_s^3}f_i'\\right) = 0 $$\n提出公因子 $\\frac{n_0}{c_s^3} \\frac{c_s}{L_0} = \\frac{n_0}{c_s^2 L_0}$：\n$$ \\frac{\\partial f_i'}{\\partial t'} + \\mathbf{v}'\\cdot\\nabla' f_i' + \\frac{L_0}{c_s} \\frac{e}{m_i} \\left(\\frac{k_B T_0}{eL_0}\\mathbf{E}' + c_s B_0 (\\mathbf{v}'\\times \\hat{\\mathbf{b}})\\right)\\cdot \\frac{1}{c_s}\\nabla'_{\\mathbf{v}'}f_i' = 0 $$\n我们来分析力算子中的各项。\n电场项的系数为：\n$$ \\frac{L_0}{c_s} \\frac{e}{m_i} \\frac{k_B T_0}{eL_0} \\frac{1}{c_s} = \\frac{L_0 e k_B T_0}{m_i c_s^2 e L_0} = \\frac{k_B T_0}{m_i c_s^2} $$\n使用定义 $c_s^2 = k_B T_0 / m_i$，该系数为 $\\frac{k_B T_0}{m_i (k_B T_0 / m_i)} = 1$。这证实了我们标度选择的自洽性。\n磁场项的系数为：\n$$ \\frac{L_0}{c_s} \\frac{e}{m_i} (c_s B_0) \\frac{1}{c_s} = \\frac{L_0 e B_0}{m_i c_s} $$\n完整的无量纲离子 Vlasov 方程为：\n$$ \\frac{\\partial f_i'}{\\partial t'} + \\mathbf{v}'\\cdot\\nabla' f_i' + \\left( \\mathbf{E}' + \\frac{L_0 e B_0}{m_i c_s} (\\mathbf{v}'\\times \\hat{\\mathbf{b}}) \\right) \\cdot \\nabla'_{\\mathbf{v}'}f_i' = 0 $$\n所要求的系数是乘以 $(\\mathbf{v}'\\times \\hat{\\mathbf{b}})\\cdot \\nabla'_{\\mathbf{v}'} f_i'$ 项的系数，即：\n$$ C_{Vlasov} = \\frac{L_0 e B_0}{m_i c_s} $$\n代入 $c_s = \\sqrt{k_B T_0 / m_i}$：\n$$ C_{Vlasov} = \\frac{L_0 e B_0}{m_i \\sqrt{k_B T_0 / m_i}} = \\frac{L_0 e B_0}{\\sqrt{m_i^2 (k_B T_0 / m_i)}} = \\frac{L_0 e B_0}{\\sqrt{m_i k_B T_0}} $$\n该系数可以写成 $L_0/\\rho_s$，其中 $\\rho_s = c_s/\\Omega_{ci} = (c_s m_i)/(e B_0)$ 是离子声速回旋半径。\n\n所求的两个系数是：\n1.  泊松方程系数：$\\frac{\\varepsilon_0 k_B T_0}{n_0 e^2 L_0^2}$\n2.  离子 Vlasov 方程磁场项系数：$\\frac{L_0 e B_0}{\\sqrt{m_i k_B T_0}}$",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{\\varepsilon_0 k_B T_0}{n_0 e^{2} L_0^{2}}  \\frac{L_0 e B_0}{\\sqrt{m_i k_B T_0}} \\end{pmatrix}} $$"
        },
        {
            "introduction": "从连续的物理方程到离散的数值算法，是计算物理学的核心。本练习聚焦于全$f$动力学模拟中最常用的方法之一——云中粒子（Particle-In-Cell, PIC）法。通过分析PIC模拟中基础的电荷分配函数（Cloud-in-Cell），你将深入理解数值离散化如何影响模拟的精度，并推导出网格混叠误差（grid aliasing error）的表达式 ，这是评估和优化任何PIC代码性能的关键一步。",
            "id": "3983108",
            "problem": "考虑一个二维、周期性的静电质点网格（PIC）程序，该程序在具有 $N_{x} \\times N_{y}$ 个节点的均匀笛卡尔网格上运行，区域长度为 $L_{x}$ 和 $L_{y}$，网格间距为 $\\Delta x = L_{x}/N_{x}$ 和 $\\Delta y = L_{y}/N_{y}$。在一个全分布函数（full-$f$）动理学表示中，每个宏粒子使用网格云（Cloud-in-Cell）分配法将电荷沉积到网格上，其中一维分配函数是1次B样条（三角形）函数。定义一维形函数\n$$\ns_{x}(x) = \\frac{1}{\\Delta x}\\,\\Lambda\\!\\left(\\frac{x}{\\Delta x}\\right), \\quad\ns_{y}(y) = \\frac{1}{\\Delta y}\\,\\Lambda\\!\\left(\\frac{y}{\\Delta y}\\right),\n$$\n其中，当 $|u|\\leq 1$ 时 $\\Lambda(u) = 1 - |u|$，否则 $\\Lambda(u)=0$，因此 $\\int_{-\\infty}^{\\infty} s_{x}(x)\\,dx = 1$ 且 $\\int_{-\\infty}^{\\infty} s_{y}(y)\\,dy = 1$。二维连续分配函数为 $s(x,y) = s_{x}(x)\\,s_{y}(y)$。\n\n假设单个宏粒子位于位置 $(x_{p},y_{p})$。分配给位置 $(i\\Delta x, j\\Delta y)$ 处网格节点 $(i,j)$ 的无量纲权重为\n$$\nw_{ij} = \\Delta x\\,\\Delta y\\, s_{x}(i\\Delta x - x_{p})\\, s_{y}(j\\Delta y - y_{p}),\n$$\n因此 $\\sum_{i,j} w_{ij} = 1$。\n\n定义分配函数的二维连续傅里叶变换为\n$$\nS(k_{x},k_{y}) = \\int_{-\\infty}^{\\infty}\\!\\int_{-\\infty}^{\\infty} s(x,y)\\,\\exp\\!\\left(-i k_{x} x - i k_{y} y\\right)\\,dx\\,dy,\n$$\n以及网格权重数组的离散傅里叶变换为\n$$\nW_{d}(k_{x},k_{y};x_{p},y_{p}) = \\sum_{i=-\\infty}^{\\infty}\\sum_{j=-\\infty}^{\\infty} w_{ij}\\,\\exp\\!\\left(-i k_{x}\\, i\\Delta x - i k_{y}\\, j\\Delta y\\right),\n$$\n其中 $k_{x}$ 和 $k_{y}$ 是与物理空间坐标 $x$ 和 $y$ 相关联的连续傅里叶变量。\n\n从上述基本定义出发，仅使用傅里叶变换的经过充分检验的性质以及连续函数在格点上的采样，推导以下量的闭合解析形式：\n1. 在零粒子偏移 $(x_{p},y_{p})=(0,0)$ 处计算的离散粒子形状傅里叶变换 $W_{d}(k_{x},k_{y};0,0)$。\n2. 相应的网格混叠误差，定义为零偏移处的最大混叠偏差，\n$$\n\\mathcal{E}(k_{x},k_{y}) \\equiv \\frac{W_{d}(k_{x},k_{y};0,0)}{S(k_{x},k_{y})} - 1.\n$$\n\n将最终答案表示为关于 $\\Delta x$、$\\Delta y$、$k_{x}$ 和 $k_{y}$ 的闭合解析表达式。在推导过程中，定义归一化sinc函数为 $\\operatorname{sinc}(u) = \\sin(u)/u$。不需要进行数值计算或四舍五入。最终答案必须是计算结果，并仅以解析表达式的形式呈现，在最终的方框输出中不带单位。",
            "solution": "所述问题具有科学依据、是适定的、客观的且内部一致。它代表了计算等离子体物理领域中关于粒子-网格插值格式谱特性的一个标准推导。所有必要的定义都已提供。因此，该问题是有效的，我们可以进行求解。\n\n推导过程分三个主要阶段：首先，我们求出分配函数的连续傅里叶变换 $S(k_x, k_y)$；其次，我们推导零粒子偏移下网格权重数组的离散傅里叶变换 $W_d(k_x, k_y; 0, 0)$；第三，我们根据这两个量计算混叠误差 $\\mathcal{E}(k_x, k_y)$。\n\n**1. 分配函数的连续傅里叶变换, $S(k_x, k_y)$**\n\n二维分配函数被定义为可分离的：$s(x,y) = s_x(x)s_y(y)$。由于这种可分离性，其连续傅里叶变换 $S(k_x, k_y)$ 是其分量的一维傅里叶变换的乘积：\n$$\nS(k_x, k_y) = S_x(k_x) S_y(k_y)\n$$\n其中\n$$\nS_x(k_x) = \\int_{-\\infty}^{\\infty} s_x(x)\\,\\exp(-i k_x x)\\,dx \\quad \\text{和} \\quad S_y(k_y) = \\int_{-\\infty}^{\\infty} s_y(y)\\,\\exp(-i k_y y)\\,dy\n$$\n我们将计算 $S_x(k_x)$；$S_y(k_y)$ 的结果可依此类推。一维形函数为 $s_x(x) = \\frac{1}{\\Delta x} \\Lambda(\\frac{x}{\\Delta x})$，其中 $\\Lambda(u)$ 是三角形函数。我们首先求 $\\Lambda(u)$ 的傅里叶变换：\n$$\n\\mathcal{F}\\{\\Lambda(u)\\}(k) = \\int_{-\\infty}^{\\infty} \\Lambda(u) \\exp(-i k u)\\,du = \\int_{-1}^{1} (1-|u|) \\exp(-i k u)\\,du\n$$\n该积分可以计算为从 $0$ 到 $1$ 积分的实部的两倍：\n$$\n\\int_{-1}^{1} (1-|u|) \\exp(-i k u)\\,du = \\int_{-1}^{1} (1-|u|) \\cos(k u)\\,du - i\\int_{-1}^{1} (1-|u|) \\sin(k u)\\,du\n$$\n第二个积分为零，因为被积函数是奇函数。第一个被积函数是偶函数，所以：\n$$\n\\mathcal{F}\\{\\Lambda(u)\\}(k) = 2 \\int_{0}^{1} (1-u) \\cos(k u)\\,du\n$$\n使用分部积分法，令 $p = 1-u$ 且 $dq = \\cos(ku)du$：\n\\begin{align*}\n\\mathcal{F}\\{\\Lambda(u)\\}(k) = 2 \\left[ (1-u) \\frac{\\sin(ku)}{k} \\right]_{0}^{1} - 2 \\int_{0}^{1} (-1) \\frac{\\sin(ku)}{k}\\,du \\\\\n= 2 \\left[ 0 - 0 \\right] + \\frac{2}{k} \\int_{0}^{1} \\sin(ku)\\,du \\\\\n= \\frac{2}{k} \\left[ -\\frac{\\cos(ku)}{k} \\right]_{0}^{1} \\\\\n= \\frac{2}{k^2} (1-\\cos(k))\n\\end{align*}\n使用半角恒等式 $1-\\cos(k) = 2\\sin^2(k/2)$，我们得到：\n$$\n\\mathcal{F}\\{\\Lambda(u)\\}(k) = \\frac{4\\sin^2(k/2)}{k^2} = \\left(\\frac{\\sin(k/2)}{k/2}\\right)^2 = \\operatorname{sinc}^2(k/2)\n$$\n其中问题定义 $\\operatorname{sinc}(u) = \\sin(u)/u$。\n\n现在我们应用傅里叶变换的尺度变换性质：如果 $\\mathcal{F}\\{f(t)\\}(k) = F(k)$，那么 $\\mathcal{F}\\{f(at)\\}(k) = \\frac{1}{|a|}F(k/a)$。对于 $s_x(x) = \\frac{1}{\\Delta x} \\Lambda(\\frac{x}{\\Delta x})$，我们有尺度因子 $a = 1/\\Delta x$。\n$$\nS_x(k_x) = \\mathcal{F}\\left\\{\\frac{1}{\\Delta x}\\Lambda\\left(\\frac{x}{\\Delta x}\\right)\\right\\}(k_x) = \\frac{1}{\\Delta x} \\left(\\Delta x \\cdot \\operatorname{sinc}^2\\left(\\frac{k_x}{1/\\Delta x} \\cdot \\frac{1}{2}\\right)\\right) = \\operatorname{sinc}^2\\left(\\frac{k_x \\Delta x}{2}\\right)\n$$\n对于 $y$ 方向，以此类推：\n$$\nS_y(k_y) = \\operatorname{sinc}^2\\left(\\frac{k_y \\Delta y}{2}\\right)\n$$\n因此，连续二维形状因子为：\n$$\nS(k_x, k_y) = \\operatorname{sinc}^2\\left(\\frac{k_x \\Delta x}{2}\\right) \\operatorname{sinc}^2\\left(\\frac{k_y \\Delta y}{2}\\right)\n$$\n\n**2. 离散粒子形状傅里叶变换, $W_d(k_x, k_y; 0, 0)$**\n\n我们被要求求解 $W_d(k_x, k_y; 0, 0)$。我们从一般定义出发，并应用Poisson求和公式，该公式将采样函数的傅里叶变换与原始函数的连续傅里叶变换联系起来。$W_d$ 的一般定义是：\n$$\nW_d(k_x, k_y; x_p, y_p) = \\sum_{i,j} w_{ij} e^{-i(k_x i \\Delta x + k_y j \\Delta y)} = \\sum_{i,j} \\Delta x \\Delta y s(i\\Delta x - x_p, j\\Delta y - y_p) e^{-i(k_x i \\Delta x + k_y j \\Delta y)}\n$$\n这个表达式是中心在 $(x_p, y_p)$ 的采样形函数的离散傅里叶变换。PIC理论中的一个基本恒等式，由Poisson求和公式导出，指出这个离散变换是连续变换的无限个混叠副本之和：\n$$\nW_d(k_x, k_y; x_p, y_p) = \\sum_{m,n=-\\infty}^{\\infty} S\\left(k_x - \\frac{2\\pi m}{\\Delta x}, k_y - \\frac{2\\pi n}{\\Delta y}\\right) \\exp\\left[-i\\left(k_x - \\frac{2\\pi m}{\\Delta x}\\right)x_p -i\\left(k_y - \\frac{2\\pi n}{\\Delta y}\\right)y_p\\right]\n$$\n对于所要求的特定情况，粒子偏移为零，即 $(x_p, y_p) = (0,0)$。指数项变为 $\\exp(0) = 1$。\n$$\nW_d(k_x,k_y;0,0) = \\sum_{m,n=-\\infty}^{\\infty} S\\left(k_x - \\frac{2\\pi m}{\\Delta x}, k_y - \\frac{2\\pi n}{\\Delta y}\\right)\n$$\n代入我们得到的 $S(k_x, k_y)$ 的结果，并使用其可分离形式：\n$$\nW_d(k_x,k_y;0,0) = \\sum_{m,n=-\\infty}^{\\infty} \\operatorname{sinc}^2\\left(\\frac{(k_x - \\frac{2\\pi m}{\\Delta x})\\Delta x}{2}\\right) \\operatorname{sinc}^2\\left(\\frac{(k_y - \\frac{2\\pi n}{\\Delta y})\\Delta y}{2}\\right)\n$$\n简化sinc函数的自变量：\n$$\nW_d(k_x,k_y;0,0) = \\sum_{m,n=-\\infty}^{\\infty} \\operatorname{sinc}^2\\left(\\frac{k_x\\Delta x}{2} - m\\pi\\right) \\operatorname{sinc}^2\\left(\\frac{k_y\\Delta y}{2} - n\\pi\\right)\n$$\n该求和是可分离的：\n$$\nW_d(k_x,k_y;0,0) = \\left[\\sum_{m=-\\infty}^{\\infty} \\operatorname{sinc}^2\\left(\\frac{k_x\\Delta x}{2} - m\\pi\\right)\\right] \\left[\\sum_{n=-\\infty}^{\\infty} \\operatorname{sinc}^2\\left(\\frac{k_y\\Delta y}{2} - n\\pi\\right)\\right]\n$$\n让我们分析这个一维求和。令 $u = k_x\\Delta x/2$。我们需要计算 $\\sum_{m=-\\infty}^{\\infty} \\operatorname{sinc}^2(u - m\\pi)$。\n$$\n\\sum_{m=-\\infty}^{\\infty} \\operatorname{sinc}^2(u - m\\pi) = \\sum_{m=-\\infty}^{\\infty} \\left(\\frac{\\sin(u - m\\pi)}{u - m\\pi}\\right)^2 = \\sum_{m=-\\infty}^{\\infty} \\left(\\frac{(-1)^m \\sin(u)}{u - m\\pi}\\right)^2 = \\sin^2(u) \\sum_{m=-\\infty}^{\\infty} \\frac{1}{(u - m\\pi)^2}\n$$\n复分析中的一个标准结果，与余割函数的Mittag-Leffler展开相关，提供了以下恒等式：\n$$\n\\sum_{m=-\\infty}^{\\infty} \\frac{1}{(z+m\\pi)^2} = \\csc^2(z) = \\frac{1}{\\sin^2(z)}\n$$\n在求和式中将 $z$ 替换为 $-u$（由于 $m$ 遍历所有整数，这不会改变结果）得到 $\\sum_{m=-\\infty}^\\infty \\frac{1}{(-u+m\\pi)^2} = \\sum_{m=-\\infty}^\\infty \\frac{1}{(u-m\\pi)^2} = \\csc^2(-u) = \\csc^2(u)$。\n应用这个恒等式，求和变为：\n$$\n\\sum_{m=-\\infty}^{\\infty} \\operatorname{sinc}^2(u - m\\pi) = \\sin^2(u) \\cdot \\frac{1}{\\sin^2(u)} = 1\n$$\n这对关于 $m$ 的求和和关于 $n$ 的求和都成立。因此：\n$$\nW_d(k_x, k_y; 0, 0) = 1 \\cdot 1 = 1\n$$\n这个结果反映了B样条基函数的“单位分解”性质，它确保了对于正好位于网格节点上的粒子，混叠效应是良态的，其总和为一个与波矢无关的常数。\n\n**3. 网格混叠误差, $\\mathcal{E}(k_x, k_y)$**\n\n网格混叠误差定义为：\n$$\n\\mathcal{E}(k_{x},k_{y}) \\equiv \\frac{W_{d}(k_{x},k_{y};0,0)}{S(k_{x},k_{y})} - 1\n$$\n代入我们推导出的 $W_d(k_x, k_y; 0, 0)$ 和 $S(k_x, k_y)$ 的表达式：\n$$\n\\mathcal{E}(k_{x},k_{y}) = \\frac{1}{\\operatorname{sinc}^2\\left(\\frac{k_x \\Delta x}{2}\\right) \\operatorname{sinc}^2\\left(\\frac{k_y \\Delta y}{2}\\right)} - 1\n$$\n这是混叠误差的最终闭合形式表达式。它量化了由混叠项求和引起的、离散网格上的谱表示与理想连续表示之间的偏差。\n\n两个所求量的最终答案是：\n1. $W_d(k_x, k_y; 0, 0) = 1$\n2. $\\mathcal{E}(k_x, k_y) = \\frac{1}{\\operatorname{sinc}^2\\left(\\frac{k_x \\Delta x}{2}\\right) \\operatorname{sinc}^2\\left(\\frac{k_y \\Delta y}{2}\\right)} - 1$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\frac{1}{\\operatorname{sinc}^2\\left(\\frac{k_x \\Delta x}{2}\\right) \\operatorname{sinc}^2\\left(\\frac{k_y \\Delta y}{2}\\right)} - 1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在许多等离子体环境中，粒子间的碰撞效应不可忽略，而如何精确且高效地模拟碰撞是全$f$模拟中的一个高级课题。本练习是一个动手编程任务，旨在指导你为一个简化的朗道（Landau）碰撞算子构建一个有限体积离散格式 。此练习的核心挑战与学习目标在于，如何通过引入一个“场粒子”修正项，在离散层面严格保证粒子数和能量的守恒，这是构建一个物理上自洽的数值模型所必须掌握的关键技术。",
            "id": "3983092",
            "problem": "考虑作用于扰动分布函数 $g(v)$ 的各向同性、三维、线性化的 Landau 碰撞算子，该函数用速率 $v \\ge 0$ 表示，并围绕一个稳态、各向同性的麦克斯韦背景进行线性化。在各向同性速率坐标中，测试粒子贡献可以写成散度形式：\n$$\nC_{\\mathrm{TP}}[g](v) = \\frac{1}{v^2}\\frac{\\partial}{\\partial v}\\left(v^2\\left( D(v)\\frac{\\partial g}{\\partial v} + F(v) g \\right)\\right),\n$$\n其中 $D(v)$ 是一个正的扩散系数，$F(v)$ 是一个摩擦（阻力）系数。完全线性化的 Landau 算子包含一个场粒子项，该项强制执行碰撞不变量（粒子数、动量、能量）。对于此处考虑的各向同性子空间（在单物种、各向同性设定中没有动量输运），必须确保粒子数和能量的离散守恒。\n\n您的任务是为 $C[g] = C_{\\mathrm{TP}}[g] + C_{\\mathrm{FP}}[g]$ 实现一个速度空间有限体积离散化，并在一组具有零通量边界条件的测试扰动 $g(v)$ 上展示粒子数和能量的离散守恒。请使用无量纲单位：用热速率对速度 $v$ 进行归一化，因此 $v$ 是无量纲的，系数 $D(v)$ 和 $F(v)$ 也是无量纲函数。最终答案中不需要物理单位。\n\n基本依据：\n- 对于各向同性背景，线性化 Landau 碰撞算子允许一个具有正扩散和阻力的散度形式测试粒子部分，如上所示，该部分由麦克斯韦背景的 Rosenbluth 势导出。\n- 粒子数和能量的碰撞不变量意味着，对于任何足够光滑且衰减的 $g(v)$，当包含场粒子部分时，$\\int C[g] \\, \\mathrm{d}^3v = 0$ 和 $\\int v^2 C[g] \\, \\mathrm{d}^3v = 0$。\n\n有限体积离散化要求：\n- 将 $v \\in [0, v_{\\max}]$ 离散化为 $N$ 个均匀单元，单元中心速率为 $v_j$，单元宽度为 $\\Delta v$。单元体积度量为 $\\Delta V_j = v_j^2 \\Delta v$。\n- 单元 $j$ 中的离散算子必须具有以下形式：\n$$\nC_j = \\frac{J_{j+1/2} - J_{j-1/2}}{\\Delta V_j} + S_j,\n$$\n其中边通量为\n$$\nJ_{j+1/2} = -D_{j+1/2} \\, v_{j+1/2}^2 \\, \\frac{g_{j+1} - g_j}{\\Delta v} - F_{j+1/2} \\, v_{j+1/2}^2 \\, \\frac{g_{j+1} + g_j}{2},\n$$\n并采用零通量边界条件 $J_{1-1/2}=0$ 和 $J_{N+1/2}=0$。此处 $D_{j+1/2} = D(v_{j+1/2})$，$F_{j+1/2} = F(v_{j+1/2})$，而 $v_{j+1/2}$ 是边速率。\n- 选择一个场粒子源项 $S_j = A_0 + A_2 v_j^2$，其中常数 $A_0$ 和 $A_2$ 依赖于 $g$，通过强制执行离散粒子数和能量守恒条件来确定：\n$$\n\\sum_{j=1}^{N} \\Delta V_j \\, C_j = 0, \\qquad \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2 \\, C_j = 0.\n$$\n通过求解一个涉及测试粒子部分离散矩的 $2\\times 2$ 线性系统来推导 $A_0$ 和 $A_2$ 的公式。具体来说，定义离散矩\n$$\nM_0 = \\sum_{j=1}^{N} \\Delta V_j \\, L_j, \\quad M_2 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2 \\, L_j,\n$$\n其中 $L_j = (J_{j+1/2} - J_{j-1/2})/\\Delta V_j$ 是测试粒子贡献，以及基矩\n$$\nB_0 = \\sum_{j=1}^{N} \\Delta V_j, \\quad B_2 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2, \\quad B_4 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^4.\n$$\n施加 $\\sum \\Delta V_j (L_j + S_j) = 0$ 和 $\\sum \\Delta V_j v_j^2 (L_j + S_j) = 0$ 以获得一个关于 $(A_0, A_2)$ 的线性系统并求解它。\n\n程序规范：\n- 使用通用的 $D(v)$ 和 $F(v)$ 函数实现上述离散化。为进行测试，使用常见的线性化扩散-阻力模型 $D(v) = D_0$ 和 $F(v) = \\alpha v$，其中 $D_0$ 和 $\\alpha$ 是正常数，这再现了各向同性形式下的散度结构和麦克斯韦弛豫行为。这种选择可作为线性化 Landau 算子测试粒子部分的替代。\n- 使用零通量边界条件。\n- 计算离散算子 $C_j$ 并通过评估以下公式来验证不变量：\n$$\nR_0 = \\sum_{j=1}^{N} \\Delta V_j \\, C_j, \\qquad R_2 = \\sum_{j=1}^{N} \\Delta V_j \\, v_j^2 \\, C_j.\n$$\n- 对于每个测试用例，返回一个布尔值，指示 $|R_0|$ 和 $|R_2|$ 是否都低于预设容差。使用 $10^{-10}$ 的绝对容差，并按参考量级进行缩放以避免平凡的真值结果；具体而言，要求 $|R_0| \\le \\varepsilon (1 + \\sum_j \\Delta V_j |L_j|)$ 和 $|R_2| \\le \\varepsilon (1 + \\sum_j \\Delta V_j v_j^2 |L_j|)$，其中 $\\varepsilon = 10^{-10}$。\n\n测试套件：\n- 提供以下测试用例，每个用例指定为 $(N, v_{\\max}, D_0, \\alpha, g(v))$：\n    1. $(64, 6.0, 0.2, 1.0, g(v) = e^{-v^2} - 0.5 e^{-2 v^2})$ 作为一般光滑扰动（理想情况）。\n    2. $(16, 6.0, 0.1, 1.0, g(v) = (1 - 3 v^2) e^{-v^2/2})$ 以测试粗分辨率效应。\n    3. $(8, 4.0, 0.3, 1.0, g(v) = 1)$ 以测试常数扰动和边界伸缩求和（边界情况）。\n    4. $(64, 6.0, 0.2, 1.0, g(v) = v^2)$ 以测试与能量不变量相关的多项式行为（边界情况）。\n    5. $(64, 6.0, 0.05, 0.5, g(v) = e^{-(v-5)^2})$ 以测试在高速边界附近有尖峰的函数（边界情况）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试用例的布尔结果，格式为包含在方括号中的逗号分隔列表（例如，“[True,False,True,True,False]”）。",
            "solution": "经评估，问题陈述有效。它在计算等离子体物理学领域提出了一个清晰、有科学依据且定义明确的任务：实现线性化各向同性 Landau 碰撞算子的守恒有限体积离散化。其表述是标准的，基于动理学理论和守恒律数值方法的基本原理。所有必要的参数、方程和条件都已提供，不存在矛盾或模糊之处。\n\n我们开始求解。目标是构造一个与连续算子 $C[g](v)$ 相对应的数值算子 $C_j$，并验证它在离散意义下守恒粒子数和能量。该算子是测试粒子部分 $C_{\\mathrm{TP}}$ 和场粒子部分 $C_{\\mathrm{FP}}$ 的和，我们将分别将其离散化为 $L_j$ 和 $S_j$。\n\n**1. 离散化框架**\n\n速度域 $v \\in [0, v_{\\max}]$ 被离散化为 $N$ 个均匀单元。单元宽度为 $\\Delta v = v_{\\max} / N$。\n-   单元边界位于 $v_{j+1/2} = j \\Delta v$，其中 $j=0, 1, \\dots, N$。\n-   单元中心位于 $v_j = (j - 1/2) \\Delta v$，其中 $j=1, 2, \\dots, N$。\n-   离散扰动分布函数位于单元中心：$g_j = g(v_j)$。\n-   对应于单元 $j$ 的球壳的体积元近似为 $\\Delta V_j = 4\\pi v_j^2 \\Delta v$。由于因子 $4\\pi$ 是一个出现在所有守恒求和中的全局常数，为简化起见可以省略它。问题将离散体积度量定义为 $\\Delta V_j = v_j^2 \\Delta v$，这与此简化一致。\n\n**2. 测试粒子算子的离散化 ($L_j$)**\n\n测试粒子算子以散度形式给出：\n$$ C_{\\mathrm{TP}}[g](v) = \\frac{1}{v^2}\\frac{\\partial}{\\partial v} \\Phi(v), \\quad \\text{其中} \\quad \\Phi(v) = v^2 \\left( D(v)\\frac{\\partial g}{\\partial v} + F(v) g \\right) $$\n将此式在一个单元体积 $V_j$（从 $v_{j-1/2}$ 到 $v_{j+1/2}$）上积分并应用微积分基本定理，得到：\n$$ \\int_{v_{j-1/2}}^{v_{j+1/2}} C_{\\mathrm{TP}}[g] \\, v^2 dv = \\Phi(v_{j+1/2}) - \\Phi(v_{j-1/2}) $$\n使用中点法则近似左侧， $L_j \\Delta V_j \\approx \\Phi(v_{j+1/2}) - \\Phi(v_{j-1/2})$，给出有限体积公式：\n$$ L_j = \\frac{J_{j+1/2} - J_{j-1/2}}{\\Delta V_j} $$\n其中 $J_{j+1/2}$ 是在单元边界 $v_{j+1/2}$ 处的数值通量，近似于 $-\\Phi(v_{j+1/2})$。符号约定的选择使得 $J$ 表示正 $v$ 方向的通量。问题为通量指定了一个特定的中心差分格式：\n$$ J_{j+1/2} = -D(v_{j+1/2}) v_{j+1/2}^2 \\left(\\frac{g_{j+1} - g_j}{\\Delta v}\\right) - F(v_{j+1/2}) v_{j+1/2}^2 \\left(\\frac{g_{j+1} + g_j}{2}\\right) $$\n该格式是一个常见的选择，与 Chang-Cooper 方法相关，该方法对于扩散-平流问题具有良好的性质。边界条件为零通量，即 $J_{1/2} = 0$ 和 $J_{N+1/2} = 0$。原点处的通量 $J_{1/2}$ 由于通量公式中的因子 $v_{1/2}^2 = 0^2=0$ 而自然为零。\n\n这种表述的一个重要结果是，测试粒子算子在离散意义下守恒粒子数。粒子总数的变化是：\n$$ \\sum_{j=1}^{N} L_j \\Delta V_j = \\sum_{j=1}^{N} (J_{j+1/2} - J_{j-1/2}) $$\n这是一个伸缩求和，其结果等于 $J_{N+1/2} - J_{1/2}$。在零通量边界条件下，此和恰好为零。因此，测试粒子算子不产生或消灭粒子。\n\n**3. 场粒子算子与守恒 ($S_j$)**\n\n测试粒子算子通常不守恒能量。场粒子算子的作用是修正这一点。我们将场粒子源项 $S_j$ 建模为对碰撞算子离散各向同性零空间的投影，该空间由 $\\{1, v_j^2\\}$ 张成。\n$$ S_j = A_0 + A_2 v_j^2 $$\n系数 $A_0$ 和 $A_2$ 是依赖于整个分布 $g$ 的标量值，通过强制执行完整算子 $C_j = L_j + S_j$ 的离散守恒律来确定。两个守恒律分别是粒子数和能量守恒：\n$$ \\sum_{j=1}^{N} C_j \\Delta V_j = 0 \\quad \\text{和} \\quad \\sum_{j=1}^{N} C_j v_j^2 \\Delta V_j = 0 $$\n\n**4. 修正系数 ($A_0, A_2$) 的推导**\n\n将 $C_j = L_j + S_j$ 代入守恒律得到：\n1.  粒子数守恒：$\\sum_{j=1}^{N} (L_j + A_0 + A_2 v_j^2) \\Delta V_j = 0$\n2.  能量守恒：$\\sum_{j=1}^{N} (L_j + A_0 + A_2 v_j^2) v_j^2 \\Delta V_j = 0$\n\n整理这些方程，得到一个关于 $(A_0, A_2)$ 的线性系统：\n$$ \\sum_{j=1}^{N} L_j \\Delta V_j + A_0 \\sum_{j=1}^{N} \\Delta V_j + A_2 \\sum_{j=1}^{N} v_j^2 \\Delta V_j = 0 $$\n$$ \\sum_{j=1}^{N} L_j v_j^2 \\Delta V_j + A_0 \\sum_{j=1}^{N} v_j^2 \\Delta V_j + A_2 \\sum_{j=1}^{N} v_j^4 \\Delta V_j = 0 $$\n使用问题陈述中提供的矩定义：\n-   $M_k = \\sum_{j=1}^{N} L_j v_j^k \\Delta V_j$\n-   $B_k = \\sum_{j=1}^{N} v_j^k \\Delta V_j$\n该系统变为：\n$$ M_0 + A_0 B_0 + A_2 B_2 = 0 $$\n$$ M_2 + A_0 B_2 + A_2 B_4 = 0 $$\n如前所述，由于有限体积构造，$M_0 = 0$。系统得以简化，但为保证数值稳健性，我们以矩阵形式求解完整系统：\n$$ \\begin{pmatrix} B_0  B_2 \\\\ B_2  B_4 \\end{pmatrix} \\begin{pmatrix} A_0 \\\\ A_2 \\end{pmatrix} = \\begin{pmatrix} -M_0 \\\\ -M_2 \\end{pmatrix} $$\n这个 $2 \\times 2$ 系统可以解出 $A_0$ 和 $A_2$。该矩阵是一个 Gram 矩阵，对于 $N  1$ 是可逆的。\n\n**5. 守恒性验证**\n\n在计算 $L_j$、矩 $M_0, M_2, B_0, B_2, B_4$、求解 $A_0, A_2$ 并构造完整算子 $C_j = L_j + A_0 + A_2 v_j^2$ 之后，我们必须验证守恒性质是否成立。我们计算离散残差：\n$$ R_0 = \\sum_{j=1}^{N} C_j \\Delta V_j \\quad \\text{和} \\quad R_2 = \\sum_{j=1}^{N} C_j v_j^2 \\Delta V_j $$\n通过代数构造，这些残差应在浮点数精度范围内为零。为了进行稳健的检验，我们使用指定的相对容差准则：\n$$ |R_0| \\le \\varepsilon \\left(1 + \\sum_j \\Delta V_j |L_j|\\right) \\quad \\text{和} \\quad |R_2| \\le \\varepsilon \\left(1 + \\sum_j \\Delta V_j v_j^2 |L_j|\\right) $$\n其中 $\\varepsilon = 10^{-10}$。这种归一化可以防止在碰撞算子作用较弱（即 $L_j$ 处处很小）时出现错误的真值结果。\n\n下面的 Python 代码实现了这整个过程。",
            "answer": "```python\nimport numpy as np\n\ndef run_conservation_test(N, vmax, D0, alpha, g_func):\n    \"\"\"\n    Implements and tests a conservative finite-volume discretization of the\n    linearized isotropic Landau collision operator.\n    \n    Args:\n        N (int): Number of velocity cells.\n        vmax (float): Maximum speed in the domain [0, vmax].\n        D0 (float): Constant for the diffusion coefficient model D(v) = D0.\n        alpha (float): Constant for the friction coefficient model F(v) = alpha * v.\n        g_func (callable): The perturbation distribution function g(v).\n\n    Returns:\n        bool: True if both number and energy are conserved to the specified tolerance, False otherwise.\n    \"\"\"\n    # 1. Grid setup\n    dv = vmax / N\n    v_cell = (np.arange(N) + 0.5) * dv\n    v_edge = np.arange(N + 1) * dv\n\n    # 2. Evaluate g on cell centers\n    g_vals = g_func(v_cell)\n\n    # 3. Calculate numerical fluxes J at cell edges\n    J = np.zeros(N + 1)  # J[0] and J[N] are 0 by zero-flux BC\n\n    # Calculate internal fluxes J[1]...J[N-1] using vectorization\n    # These correspond to edges v_edge[1] through v_edge[N-1]\n    g_left = g_vals[:-1]   # g_0 to g_{N-2}\n    g_right = g_vals[1:]   # g_1 to g_{N-1}\n    v_internal_edges = v_edge[1:-1]\n\n    # D(v) = D0, F(v) = alpha * v\n    D_edge = D0 * np.ones_like(v_internal_edges)\n    F_edge = alpha * v_internal_edges\n\n    diff_term = -D_edge * v_internal_edges**2 * (g_right - g_left) / dv\n    drag_term = -F_edge * v_internal_edges**2 * (g_right + g_left) / 2.0\n    J[1:-1] = diff_term + drag_term\n\n    # 4. Calculate the discrete test-particle operator L_j\n    delta_V = v_cell**2 * dv\n    J_right_of_cell = J[1:]  # J_1 to J_N\n    J_left_of_cell = J[:-1]   # J_0 to J_{N-1}\n    \n    # Handle the case where v_cell[0] is close to zero leading to large L[0]\n    # In our staggered grid, v_cell is never zero, so delta_V is never zero.\n    L = (J_right_of_cell - J_left_of_cell) / delta_V\n\n    # 5. Calculate moments for the linear system\n    # Basis moments\n    v_cell_sq = v_cell**2\n    v_cell_4 = v_cell**4\n    B0 = np.sum(delta_V)\n    B2 = np.sum(delta_V * v_cell_sq)\n    B4 = np.sum(delta_V * v_cell_4)\n\n    # Test-particle moments\n    M0 = np.sum(delta_V * L)\n    M2 = np.sum(delta_V * v_cell_sq * L)\n    # M0 should be zero to machine precision due to the telescoping sum of fluxes and zero-flux BCs.\n    \n    # 6. Solve for the field-particle coefficients A0, A2\n    mat = np.array([[B0, B2], [B2, B4]])\n    rhs = np.array([-M0, -M2])\n    try:\n        A0, A2 = np.linalg.solve(mat, rhs)\n    except np.linalg.LinAlgError:\n        # This case should not be reached for N > 1\n        return False\n\n    # 7. Calculate the full discrete operator C_j and conservation residuals R0, R2\n    S = A0 + A2 * v_cell_sq\n    C = L + S\n\n    R0 = np.sum(delta_V * C)\n    R2 = np.sum(delta_V * v_cell_sq * C)\n\n    # 8. Perform the verification check against the specified tolerance\n    epsilon = 1e-10\n    norm0 = 1.0 + np.sum(delta_V * np.abs(L))\n    norm2 = 1.0 + np.sum(delta_V * v_cell_sq * np.abs(L))\n    \n    check0 = np.abs(R0) = epsilon * norm0\n    check2 = np.abs(R2) = epsilon * norm2\n    \n    return check0 and check2\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (64, 6.0, 0.2, 1.0, lambda v: np.exp(-v**2) - 0.5 * np.exp(-2 * v**2)),\n        (16, 6.0, 0.1, 1.0, lambda v: (1 - 3 * v**2) * np.exp(-v**2 / 2.0)),\n        (8, 4.0, 0.3, 1.0, lambda v: np.ones_like(v)),\n        (64, 6.0, 0.2, 1.0, lambda v: v**2),\n        (64, 6.0, 0.05, 0.5, lambda v: np.exp(-(v - 5.0)**2)),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Use str(bool(...)) to ensure it's 'True' or 'False'\n        is_conserved = bool(run_conservation_test(*case))\n        results.append(str(is_conserved))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}