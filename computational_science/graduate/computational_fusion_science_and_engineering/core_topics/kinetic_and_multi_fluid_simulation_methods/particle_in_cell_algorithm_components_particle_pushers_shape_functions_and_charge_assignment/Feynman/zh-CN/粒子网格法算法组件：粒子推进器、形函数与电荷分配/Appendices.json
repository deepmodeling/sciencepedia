{
    "hands_on_practices": [
        {
            "introduction": "在任何粒子模拟（PIC）算法中，最基本的步骤是将离散粒子携带的信息（如电荷）分配到网格上。这个练习将指导您从基本物理原理出发，推导广泛使用的一阶电荷分配方案——云中元（CIC）方法。通过确保电荷守恒和电偶极矩守恒，您将亲自构建连接拉格朗日粒子描述和欧拉网格描述的关键桥梁 ``。",
            "id": "4026835",
            "problem": "一维磁约束等离子体的粒子模拟 (PIC) 仿真使用一个均匀的网格，其节点位置为 $x_{j} = x_{0} + j \\Delta x$，间距 $\\Delta x$ 为常数。考虑一个电荷为 $q$ 的单个粒子，其位置 $x_{p}$ 位于单元 $i$ 内，该单元由两个最近的网格节点 $x_{i}$ 和 $x_{i+1}$ 界定。电荷分配采用云中粒子 (CIC) 方法，该方法使用一阶、紧支撑的连续形函数，仅将电荷分配到最近的两个网格节点，并分别保持了常数场和线性场的零阶矩和一阶矩。具体而言，CIC 分配权重 $w_{i}(x_{p})$ 和 $w_{i+1}(x_{p})$ 必须满足以下条件：\n- 总电荷守恒（单位分解）：$w_{i}(x_{p}) + w_{i+1}(x_{p}) = 1$。\n- 线性场的一阶一致性：对于任意线性函数 $f(x) = a + b x$，关系式 $w_{i}(x_{p}) f(x_{i}) + w_{i+1}(x_{p}) f(x_{i+1}) = f(x_{p})$ 成立。\n\n定义单元内的分数偏移为 $\\xi = (x_{p} - x_{i}) / \\Delta x$，其中 $0 \\leq \\xi \\leq 1$。推导 CIC 分配权重 $w_{i}(x_{p})$ 和 $w_{i+1}(x_{p})$ 关于 $\\xi$ 的解析表达式，确保它们满足上述约束，并在单元支撑域内为非负。将最终答案表示为包含这对权重的单个解析表达式。无需四舍五入。权重是无量纲的，应无单位表示。",
            "solution": "在进行求解之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   **仿真**：一维粒子模拟 (PIC) 仿真。\n-   **网格**：均匀网格，节点位置为 $x_{j} = x_{0} + j \\Delta x$，恒定间距为 $\\Delta x$。\n-   **粒子和单元**：一个电荷为 $q$ 的粒子位于单元 $i$ 内的位置 $x_{p}$，该单元由节点 $x_{i}$ 和 $x_{i+1}$ 界定。\n-   **方法**：云中粒子 (CIC) 电荷分配，它是一阶形函数。\n-   **分配权重**：$w_{i}(x_{p})$ 和 $w_{i+1}(x_{p})$ 分别是节点 $i$ 和 $i+1$ 的权重。\n-   **约束 1 (单位分解/电荷守恒)**：$w_{i}(x_{p}) + w_{i+1}(x_{p}) = 1$。\n-   **约束 2 (一阶一致性)**：对于任意线性函数 $f(x) = a + b x$，关系式 $w_{i}(x_{p}) f(x_{i}) + w_{i+1}(x_{p}) f(x_{i+1}) = f(x_{p})$ 必须成立。\n-   **分数位置**：粒子在单元内的归一化位置定义为 $\\xi = (x_{p} - x_{i}) / \\Delta x$，其中 $0 \\leq \\xi \\leq 1$。\n-   **隐式约束**：权重必须为非负值，$w_{i}(x_{p}) \\geq 0$ 且 $w_{i+1}(x_{p}) \\geq 0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题具有科学依据。云中粒子 (CIC) 方法，也称为一阶加权或线性插值，是计算等离子体物理和 PIC 仿真中的一个基本且标准的算法。电荷守恒（零阶矩保持）和线性场保持（一阶矩保持）的条件是该方法的定义性数学属性。\n-   **适定性**：该问题是适定的。它为两个未知变量（权重 $w_{i}$ 和 $w_{i+1}$）提供了两个线性约束，这足以确定一个唯一解。\n-   **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观性断言。\n-   **完整性和一致性**：该问题是自洽的，其约束条件相互一致。所提供的信息足以进行推导。\n-   **其他缺陷**：该问题没有验证标准中列出的缺陷。这是计算科学领域的一个标准推导。\n\n### 步骤 3：结论与行动\n问题有效。将进行求解。\n\n目标是求出分配权重 $w_{i}(x_{p})$ 和 $w_{i+1}(x_{p})$ 作为分数偏移 $\\xi$ 的函数表达式。为简化符号，令 $w_{i} = w_{i}(x_{p})$ 和 $w_{i+1} = w_{i+1}(x_{p})$。\n\n我们有两个基本约束。第一个是总电荷守恒，它要求权重之和为 1：\n$$w_{i} + w_{i+1} = 1 \\quad (1)$$\n这也被称为单位分解性质。\n\n第二个约束是一阶一致性，它确保线性场被精确插值。对于任何线性函数 $f(x) = a + b x$，以下关系必须成立：\n$$w_{i} f(x_{i}) + w_{i+1} f(x_{i+1}) = f(x_{p})$$\n将 $f(x) = a + b x$ 代入此关系式得到：\n$$w_{i} (a + b x_{i}) + w_{i+1} (a + b x_{i+1}) = a + b x_{p}$$\n展开左边的项：\n$$a w_{i} + b w_{i} x_{i} + a w_{i+1} + b w_{i+1} x_{i+1} = a + b x_{p}$$\n我们可以按任意常数 $a$ 和 $b$ 对各项进行分组：\n$$a(w_{i} + w_{i+1}) + b(w_{i} x_{i} + w_{i+1} x_{i+1}) = a + b x_{p}$$\n为使此等式对 $a$ 和 $b$ 的任意选择都成立，方程两边 $a$ 和 $b$ 的系数必须相等。\n\n令 $a$ 的系数相等：\n$$w_{i} + w_{i+1} = 1$$\n这与方程 $(1)$ 相同，证实了约束的一致性。此性质称为零阶矩保持。\n\n令 $b$ 的系数相等：\n$$w_{i} x_{i} + w_{i+1} x_{i+1} = x_{p} \\quad (2)$$\n此性质称为一阶矩保持。\n\n我们现在有一个包含两个未知数 $w_{i}$ 和 $w_{i+1}$ 的二元线性方程组：\n1.  $w_{i} + w_{i+1} = 1$\n2.  $w_{i} x_{i} + w_{i+1} x_{i+1} = x_{p}$\n\n从方程 $(1)$，我们可以用 $w_{i}$ 表示 $w_{i+1}$：\n$$w_{i+1} = 1 - w_{i}$$\n将此表达式代入方程 $(2)$：\n$$w_{i} x_{i} + (1 - w_{i}) x_{i+1} = x_{p}$$\n$$w_{i} x_{i} + x_{i+1} - w_{i} x_{i+1} = x_{p}$$\n现在，我们求解 $w_{i}$：\n$$w_{i} (x_{i} - x_{i+1}) = x_{p} - x_{i+1}$$\n网格间距为 $\\Delta x = x_{i+1} - x_{i}$，这意味着 $x_{i} - x_{i+1} = -\\Delta x$。\n$$w_{i} (-\\Delta x) = x_{p} - x_{i+1}$$\n$$w_{i} = \\frac{x_{p} - x_{i+1}}{-\\Delta x} = \\frac{x_{i+1} - x_{p}}{\\Delta x}$$\n现在我们用 $w_{i+1} = 1 - w_{i}$ 求 $w_{i+1}$：\n$$w_{i+1} = 1 - \\frac{x_{i+1} - x_{p}}{\\Delta x} = \\frac{\\Delta x - (x_{i+1} - x_{p})}{\\Delta x}$$\n使用关系式 $\\Delta x = x_{i+1} - x_{i}$：\n$$w_{i+1} = \\frac{(x_{i+1} - x_{i}) - x_{i+1} + x_{p}}{\\Delta x} = \\frac{x_{p} - x_{i}}{\\Delta x}$$\n所以我们得到了用粒子和网格位置表示的权重：\n$$w_{i}(x_{p}) = \\frac{x_{i+1} - x_{p}}{\\Delta x}$$\n$$w_{i+1}(x_{p}) = \\frac{x_{p} - x_{i}}{\\Delta x}$$\n这些表达式代表了线性插值。\n\n问题要求用分数偏移 $\\xi = (x_{p} - x_{i}) / \\Delta x$ 来表示这些权重。\n我们可以将这个定义直接代入 $w_{i+1}$ 的表达式中：\n$$w_{i+1}(x_{p}) = \\frac{x_{p} - x_{i}}{\\Delta x} = \\xi$$\n对于 $w_{i}$，我们可以将表达式重写为：\n$$w_{i}(x_{p}) = \\frac{x_{i+1} - x_{p}}{\\Delta x} = \\frac{x_{i+1} - x_{i} + x_{i} - x_{p}}{\\Delta x} = \\frac{(x_{i+1} - x_{i}) - (x_{p} - x_{i})}{\\Delta x}$$\n$$w_{i}(x_{p}) = \\frac{\\Delta x - (x_{p} - x_{i})}{\\Delta x} = 1 - \\frac{x_{p} - x_{i}}{\\Delta x} = 1 - \\xi$$\n因此，用分数偏移 $\\xi$ 表示的 CIC 分配权重为：\n$$w_{i}(x_{p}) = 1 - \\xi$$\n$$w_{i+1}(x_{p}) = \\xi$$\n这些是 CIC 方法的形函数，在更一般的背景下通常表示为 $S_1(x_p - x_i)$ 和 $S_1(x_p - x_{i+1})$。\n在条件 $0 \\leq \\xi \\leq 1$ 下，我们可以验证权重是非负的：\n-   $w_{i+1} = \\xi \\geq 0$。\n-   $w_{i} = 1 - \\xi \\geq 0$ 因为 $\\xi \\leq 1$。\n所有约束都得到满足。这对权重 $(w_i, w_{i+1})$ 是 $(1-\\xi, \\xi)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 - \\xi & \\xi\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在网格上计算出电磁场后，下一步是根据洛伦兹力更新粒子的速度和位置，这被称为“粒子推进”过程。本练习将深入探讨 Boris 推进器（Boris pusher）的数值特性，它是磁化等离子体模拟中的标准算法。通过分析其在匀强磁场中的回旋运动误差，您将理解该算法为何能在保持能量守恒的同时，实现出色的长期稳定性 ``。",
            "id": "4026898",
            "problem": "在一个磁化聚变等离子体模型中，使用标准的 Boris 推送器和细胞内粒子（PIC）方法，对单个带电粒子进行时间推进。考虑一个电荷大小为 $|q|$、质量为 $m$ 的粒子在均匀磁场 $\\mathbf{B} = B \\,\\hat{\\mathbf{z}}$ 和零电场 $\\mathbf{E}=\\mathbf{0}$ 中的非相对论性运动。其连续动力学遵循洛伦兹力定律，并导致以由磁场决定的回旋频率进行的圆周运动。在 Boris 推送器中，速度通过一系列旋转进行推进，这些旋转可以用磁场和时间步长来表示。\n\n从洛伦兹力定律和在 $\\mathbf{E}$ 不存在的情况下的标准 Boris 速度更新出发，推导由 Boris 推送器引起的离散速度旋转，并以连续回旋频率 $\\Omega$ 和时间步长 $\\Delta t$ 表示每时间步长的离散旋转角 $\\theta_{\\mathrm{Boris}}$。将每步的相位误差定义为 $\\delta \\theta = \\theta_{\\mathrm{Boris}} - \\Omega \\Delta t$。然后：\n- 对于小的 $\\Delta t$，推导相位误差 $\\delta \\theta$ 对 $\\Delta t$ 的主阶依赖关系。\n- 推导相对离散回旋频率误差 $(\\omega_{\\mathrm{Boris}} - \\Omega)/\\Omega$ 对 $\\Delta t$ 的主阶依赖关系，其中 $\\omega_{\\mathrm{Boris}} = \\theta_{\\mathrm{Boris}}/\\Delta t$。\n- 使用频率和周期之间的关系，推导对于小的 $\\Delta t$，相对回旋周期误差 $E_{T} \\equiv |T_{\\mathrm{Boris}} - T|/T$ 对 $\\Delta t$ 的主阶依赖关系，其中 $T = 2\\pi/\\Omega$ 且 $T_{\\mathrm{Boris}} = 2\\pi/\\omega_{\\mathrm{Boris}}$。\n\n最后，使用主阶相对回旋周期误差，计算使得 $E_{T} \\le 0.01$ 的最大允许时间步长 $\\Delta t_{\\max}$。请用 $|q|$、$B$ 和 $m$ 来表示你最终的 $\\Delta t_{\\max}$（单位为秒）。所有角度必须以弧度表示。最终答案必须是单一的解析表达式。不需要进行数值舍入。",
            "solution": "该问题要求分析 Boris 算法在均匀磁场中对带电粒子回旋运动引入的数值误差。我们被要求推导相位、频率和周期误差对时间步长 $\\Delta t$ 的主阶依赖关系，并最终计算使相对周期误差低于某一阈值的最大时间步长 $\\Delta t_{\\max}$。\n\n首先，我们建立背景。一个电荷为 $q$、质量为 $m$ 的粒子的连续运动由洛伦兹力定律描述。在均匀磁场 $\\mathbf{B} = B \\,\\hat{\\mathbf{z}}$ 和零电场 $\\mathbf{E} = \\mathbf{0}$ 的情况下，运动方程为：\n$$ m \\frac{d\\mathbf{v}}{dt} = q (\\mathbf{v} \\times \\mathbf{B}) $$\n该方程描述了在垂直于 $\\mathbf{B}$ 的平面内，以回旋频率进行的匀速圆周运动，其大小由 $\\Omega = \\frac{|q|B}{m}$ 给出。在一个时间间隔 $\\Delta t$ 内，粒子的速度矢量旋转一个精确的角度 $\\theta_{\\mathrm{exact}} = \\Omega_c \\Delta t$，其中 $\\Omega_c = qB/m$ 是带符号的回旋频率。该旋转的大小为 $|\\theta_{\\mathrm{exact}}| = \\Omega \\Delta t$。\n\nBoris 算法是一种将粒子速度从时间 $t_n$ 更新到 $t_{n+1} = t_n + \\Delta t$ 的数值方法。对于 $\\mathbf{E} = \\mathbf{0}$，从 $\\mathbf{v}^n$ 到 $\\mathbf{v}^{n+1}$ 的速度更新分两步执行：\n1.  计算一个中间速度 $\\mathbf{v}'$：\n    $$ \\mathbf{v}' = \\mathbf{v}^n + \\mathbf{v}^n \\times \\mathbf{t} $$\n2.  计算最终速度 $\\mathbf{v}^{n+1}$：\n    $$ \\mathbf{v}^{n+1} = \\mathbf{v}^n + \\frac{2}{1+t^2} (\\mathbf{v}' \\times \\mathbf{t}) $$\n这里，$\\mathbf{t}$ 是一个与磁场旋转相关的无量纲矢量：\n$$ \\mathbf{t} = \\frac{q\\mathbf{B}}{m} \\frac{\\Delta t}{2} $$\n$\\mathbf{t}$ 的大小为 $t = |\\mathbf{t}| = \\frac{|q|B}{m}\\frac{\\Delta t}{2} = \\frac{\\Omega \\Delta t}{2}$。\n\n让我们将这两步结合起来，找到用 $\\mathbf{v}^n$ 表示 $\\mathbf{v}^{n+1}$ 的单一表达式：\n$$ \\mathbf{v}^{n+1} = \\mathbf{v}^n + \\frac{2}{1+t^2} ((\\mathbf{v}^n + \\mathbf{v}^n \\times \\mathbf{t}) \\times \\mathbf{t}) $$\n$$ \\mathbf{v}^{n+1} = \\mathbf{v}^n + \\frac{2}{1+t^2} (\\mathbf{v}^n \\times \\mathbf{t} + (\\mathbf{v}^n \\times \\mathbf{t}) \\times \\mathbf{t}) $$\n使用矢量三重积恒等式 $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a} \\cdot \\mathbf{c}) - \\mathbf{c}(\\mathbf{a} \\cdot \\mathbf{b})$，我们得到：\n$$ (\\mathbf{v}^n \\times \\mathbf{t}) \\times \\mathbf{t} = \\mathbf{t}(\\mathbf{v}^n \\cdot \\mathbf{t}) - \\mathbf{v}^n(\\mathbf{t} \\cdot \\mathbf{t}) $$\n由于 $\\mathbf{B}$ 沿着 $\\hat{\\mathbf{z}}$ 方向，$\\mathbf{t}$ 也是如此。回旋运动发生在 $xy$ 平面内，所以 $\\mathbf{v}^n$ 垂直于 $\\mathbf{t}$，这意味着 $\\mathbf{v}^n \\cdot \\mathbf{t} = 0$。表达式简化为：\n$$ (\\mathbf{v}^n \\times \\mathbf{t}) \\times \\mathbf{t} = -t^2 \\mathbf{v}^n $$\n将此代回 $\\mathbf{v}^{n+1}$ 的方程中：\n$$ \\mathbf{v}^{n+1} = \\mathbf{v}^n + \\frac{2}{1+t^2} (\\mathbf{v}^n \\times \\mathbf{t} - t^2 \\mathbf{v}^n) = \\left(1 - \\frac{2t^2}{1+t^2}\\right)\\mathbf{v}^n + \\frac{2}{1+t^2}(\\mathbf{v}^n \\times \\mathbf{t}) $$\n$$ \\mathbf{v}^{n+1} = \\left(\\frac{1+t^2-2t^2}{1+t^2}\\right)\\mathbf{v}^n + \\frac{2\\mathbf{t}}{ (1+t^2)\\Delta t} \\times \\mathbf{v}^n $$\n这个方程表明 $\\mathbf{v}^{n+1}$ 是通过旋转 $\\mathbf{v}^n$ 得到的。设数值旋转角为 $\\phi_{\\mathrm{num}}$。这是一个围绕 $\\mathbf{t}$ 轴（即 $\\hat{\\mathbf{z}}$ 轴）的旋转。旋转的分量可以与标准的二维旋转矩阵进行比较。该变换等效于旋转一个角度 $\\phi_{\\mathrm{num}}$，其中 $\\cos(\\phi_{\\mathrm{num}}) = \\frac{1-t^2}{1+t^2}$ 且 $\\sin(\\phi_{\\mathrm{num}}) = \\frac{-2t_z}{1+t^2}$，其中 $t_z = \\mathbf{t} \\cdot \\hat{\\mathbf{z}} = \\frac{qB}{m}\\frac{\\Delta t}{2}$。\n使用半角正切恒等式 $\\tan(\\phi_{\\mathrm{num}}/2) = \\frac{\\sin(\\phi_{\\mathrm{num}})}{1+\\cos(\\phi_{\\mathrm{num}})}$，我们发现：\n$$ \\tan\\left(\\frac{\\phi_{\\mathrm{num}}}{2}\\right) = \\frac{-2t_z / (1+t^2)}{1 + (1-t^2)/(1+t^2)} = \\frac{-2t_z}{1+t^2+1-t^2} = -t_z = -\\frac{qB}{m}\\frac{\\Delta t}{2} $$\n问题将每步的离散旋转角 $\\theta_{\\mathrm{Boris}}$ 定义为一个正量，因此我们取角度的绝对值：\n$$ \\theta_{\\mathrm{Boris}} = |\\phi_{\\mathrm{num}}| = \\left| -2 \\arctan\\left(\\frac{qB}{m}\\frac{\\Delta t}{2}\\right) \\right| = 2 \\arctan\\left(\\left|\\frac{qB}{m}\\right|\\frac{\\Delta t}{2}\\right) $$\n使用定义 $\\Omega = \\frac{|q|B}{m}$，我们得到离散旋转角的表达式：\n$$ \\theta_{\\mathrm{Boris}} = 2 \\arctan\\left(\\frac{\\Omega \\Delta t}{2}\\right) $$\n\n现在我们推导相位误差 $\\delta \\theta$ 的主阶依赖关系。相位误差定义为 $\\delta \\theta = \\theta_{\\mathrm{Boris}} - \\Omega \\Delta t$。对于小的 $\\Delta t$，$\\arctan$ 的自变量很小。我们使用泰勒级数展开 $\\arctan(x) = x - \\frac{x^3}{3} + O(x^5)$：\n$$ \\theta_{\\mathrm{Boris}} = 2 \\left[ \\left(\\frac{\\Omega \\Delta t}{2}\\right) - \\frac{1}{3}\\left(\\frac{\\Omega \\Delta t}{2}\\right)^3 + O((\\Delta t)^5) \\right] = \\Omega \\Delta t - \\frac{2}{3}\\frac{\\Omega^3 (\\Delta t)^3}{8} + O((\\Delta t)^5) $$\n$$ \\theta_{\\mathrm{Boris}} = \\Omega \\Delta t - \\frac{\\Omega^3 (\\Delta t)^3}{12} + O((\\Delta t)^5) $$\n相位误差则为：\n$$ \\delta \\theta = \\left(\\Omega \\Delta t - \\frac{\\Omega^3 (\\Delta t)^3}{12} + O((\\Delta t)^5)\\right) - \\Omega \\Delta t = - \\frac{\\Omega^3 (\\Delta t)^3}{12} + O((\\Delta t)^5) $$\n$\\delta \\theta$ 的主阶依赖于 $(\\Delta t)^3$。\n\n接下来，我们推导相对离散回旋频率误差。离散回旋频率为 $\\omega_{\\mathrm{Boris}} = \\theta_{\\mathrm{Boris}}/\\Delta t$。\n$$ \\omega_{\\mathrm{Boris}} = \\frac{1}{\\Delta t} \\left(\\Omega \\Delta t - \\frac{\\Omega^3 (\\Delta t)^3}{12} + O((\\Delta t)^5)\\right) = \\Omega - \\frac{\\Omega^3 (\\Delta t)^2}{12} + O((\\Delta t)^4) $$\n相对误差为 $(\\omega_{\\mathrm{Boris}} - \\Omega)/\\Omega$：\n$$ \\frac{\\omega_{\\mathrm{Boris}} - \\Omega}{\\Omega} = \\frac{(\\Omega - \\frac{\\Omega^3 (\\Delta t)^2}{12} + O((\\Delta t)^4)) - \\Omega}{\\Omega} = - \\frac{\\Omega^2 (\\Delta t)^2}{12} + O((\\Delta t)^4) $$\n相对频率误差的主阶依赖于 $(\\Delta t)^2$。\n\n现在，我们推导相对回旋周期误差 $E_T$。连续周期和离散周期分别为 $T = 2\\pi/\\Omega$ 和 $T_{\\mathrm{Boris}} = 2\\pi/\\omega_{\\mathrm{Boris}}$。相对误差为 $E_{T} = |T_{\\mathrm{Boris}} - T|/T$。\n$$ E_T = \\left| \\frac{T_{\\mathrm{Boris}}}{T} - 1 \\right| = \\left| \\frac{2\\pi/\\omega_{\\mathrm{Boris}}}{2\\pi/\\Omega} - 1 \\right| = \\left| \\frac{\\Omega}{\\omega_{\\mathrm{Boris}}} - 1 \\right| $$\n根据前面的结果，我们有 $\\frac{\\omega_{\\mathrm{Boris}}}{\\Omega} = 1 - \\frac{\\Omega^2 (\\Delta t)^2}{12} + O((\\Delta t)^4)$。因此：\n$$ \\frac{\\Omega}{\\omega_{\\mathrm{Boris}}} = \\left(1 - \\frac{\\Omega^2 (\\Delta t)^2}{12} + O((\\Delta t)^4)\\right)^{-1} $$\n对于小的 $x = \\frac{\\Omega^2 (\\Delta t)^2}{12}$，使用几何级数展开 $(1-x)^{-1} = 1 + x + x^2 + \\dots$：\n$$ \\frac{\\Omega}{\\omega_{\\mathrm{Boris}}} = 1 + \\frac{\\Omega^2 (\\Delta t)^2}{12} + O((\\Delta t)^4) $$\n将此代入 $E_T$ 的表达式中：\n$$ E_T = \\left| \\left(1 + \\frac{\\Omega^2 (\\Delta t)^2}{12} + O((\\Delta t)^4)\\right) - 1 \\right| = \\frac{\\Omega^2 (\\Delta t)^2}{12} + O((\\Delta t)^4) $$\n主阶相对回旋周期误差为 $E_T \\approx \\frac{\\Omega^2 (\\Delta t)^2}{12}$，它依赖于 $(\\Delta t)^2$。\n\n最后，我们计算使得 $E_T \\le 0.01$ 的最大允许时间步长 $\\Delta t_{\\max}$。使用 $E_T$ 的主阶近似：\n$$ \\frac{\\Omega^2 (\\Delta t)^2}{12} \\le 0.01 $$\n求解 $\\Delta t$：\n$$ (\\Delta t)^2 \\le \\frac{12 \\times 0.01}{\\Omega^2} = \\frac{0.12}{\\Omega^2} $$\n$$ \\Delta t \\le \\frac{\\sqrt{0.12}}{\\Omega} $$\n因此，最大时间步长为 $\\Delta t_{\\max} = \\frac{\\sqrt{0.12}}{\\Omega}$。题目要求我们用 $|q|$、$B$ 和 $m$ 来表示。我们代入 $\\Omega = \\frac{|q|B}{m}$ 并简化数值常数：\n$$ \\sqrt{0.12} = \\sqrt{\\frac{12}{100}} = \\frac{\\sqrt{4 \\times 3}}{10} = \\frac{2\\sqrt{3}}{10} = \\frac{\\sqrt{3}}{5} $$\n所以，最大允许时间步长是：\n$$ \\Delta t_{\\max} = \\frac{\\sqrt{3}}{5} \\frac{1}{\\Omega} = \\frac{\\sqrt{3}}{5} \\frac{m}{|q|B} $$\n该表达式的单位是时间，符合要求。",
            "answer": "$$ \\boxed{\\frac{\\sqrt{3}}{5} \\frac{m}{|q|B}} $$"
        },
        {
            "introduction": "一个物理上自洽的 PIC 方案必须确保粒子不会对自己产生作用力，即自作用力（self-force）为零。这个高级练习将引导您在傅里叶空间中，推导消除这种非物理效应所需的条件，揭示电荷分配（scatter）和力插值（gather）方案之间的深刻联系。理解这一原理对于构建动量守恒的 PIC 代码至关重要，并展示了谱方法在分析算法一致性方面的强大能力 ``。",
            "id": "4026803",
            "problem": "在长度为 $L$ 的周期性域上的一维静电粒子模拟 (PIC) 算法中，考虑一个电荷为 $q$、位置为 $x_{p} \\in [0,L)$ 的单个宏粒子。该算法通过一个紧支撑、实值、偶函数形式的形状函数 $S(x)$ 将粒子电荷分配到均匀网格上，该函数被归一化以满足 $\\int_{-\\infty}^{\\infty} S(x)\\,dx = 1$。然后通过谱方法泊松求解器将电荷密度推进为电场，并使用一个（可能不同的）插值核 $G(x)$ 将电场收集回粒子。\n\n本题要求您从第一性原理出发，推导在谱空间中，由粒子自身沉积电荷产生的自作用力对任意 $x_{p}$ 均为零的条件。然后，利用此条件评估最终的自作用力。\n\n假设以下设置和约定。\n\n- 静电场由高斯定律和静电势 $\\phi(x)$ 控制，满足 $E(x) = -\\partial_{x}\\phi(x)$ 和 $\\partial_{x}E(x) = \\rho(x)/\\epsilon_{0}$。您可以将这些方程的谱解作为这些关系的结果，但不要假定任何预先推导的谱公式。\n- 对任意 $L$-周期函数 $f(x)$ 使用傅里叶级数约定：\n  $$f(x) = \\sum_{m=-\\infty}^{\\infty} \\hat{f}(k_{m}) \\,\\exp(i k_{m} x), \\quad \\hat{f}(k_{m}) = \\frac{1}{L}\\int_{0}^{L} f(x)\\,\\exp(-i k_{m} x)\\,dx,$$\n  其中波数为 $k_{m} = \\frac{2\\pi m}{L}$，$m \\in \\mathbb{Z}$。对于静电求解， $k_{0}$ 模式设为零。\n- 单个粒子沉积的电荷密度为 $\\rho(x) = q\\,S(x-x_{p})$，其傅里叶变换为 $\\hat{S}(k) = \\int_{-\\infty}^{\\infty} S(x)\\,\\exp(-ikx)\\,dx$。因为 $S(x)$ 是实偶函数，所以 $\\hat{S}(k)$ 也是实偶函数。\n- 将场收集回粒子使用插值核 $G(x)$，其傅里叶变换为 $\\hat{G}(k) = \\int_{-\\infty}^{\\infty} G(x)\\,\\exp(-ikx)\\,dx$。粒子受到的力为 $F = q\\,E_{\\mathrm{gather}}(x_{p})$。\n\n任务：\n\n$1.$ 仅从关系式 $E(x) = -\\partial_{x}\\phi(x)$ 和 $\\partial_{x}E(x) = \\rho(x)/\\epsilon_{0}$ 出发，推导由 $\\rho(x)$ 产生的电场的谱表示，用其傅里叶系数表示，适用于所有非零波数 $k_{m} \\neq 0$。\n\n$2.$ 使用上述傅里叶级数约定，将单个粒子沉积电荷密度的谱系数用 $q$、$L$、$\\hat{S}(k_{m})$ 和 $x_{p}$ 表示。\n\n$3.$ 将场收集回粒子的过程建模为与 $G(x)$ 的卷积，然后在 $x_{p}$ 处求值。推导一个显式的离散傅里叶和，表示仅由粒子自身沉积电荷引起的自场 $E_{\\mathrm{self}}(x_{p})$。然后求出粒子上相应的自作用力 $F_{\\mathrm{self}}$。\n\n$4.$ 从您得到的 $F_{\\mathrm{self}}$ 表达式中，推导出保证对任意 $x_{p}$ 和任意 $L$ 都有 $F_{\\mathrm{self}} = 0$ 的关于 $\\hat{S}(k)$ 和 $\\hat{G}(k)$ 的对称性和一致性条件。解释谱和中各因子的奇偶性以及移除 $k_{0}$ 模式的作用。\n\n最后，在推导出的条件下，自作用力 $F_{\\mathrm{self}}$ 的值是多少？用牛顿（Newtons）作为单位表达您的最终答案。不要四舍五入；请提供精确值。",
            "solution": "本题要求在一维静电粒子模拟（PIC）中推导自作用力为零的条件，并在该条件下评估此力。解题过程将遵循题目陈述中列出的具体任务。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}