{
    "hands_on_practices": [
        {
            "introduction": "有质动力并非一个基本力，而是在特定条件下从更基本的洛伦兹力定律中衍生出来的有效力。这项练习将引导你完成这一关键推导过程，首先通过时间尺度分离的方法，从牛顿-洛伦兹方程出发，系统地导出有质动力。通过亲手推导，你将深刻理解该力的物理起源，并比较其对电子和氘核的不同影响，从而揭示质荷比在等离子体动力学中的决定性作用 。",
            "id": "4031286",
            "problem": "考虑一个惯性约束聚变（ICF）激光-等离子体相互作用的一维模型，其中带电粒子受到一个具有空间缓变包络的线性偏振高频电场的作用。该电场由下式给出：\n$$\n\\mathbf{E}(x,t) = \\hat{\\mathbf{x}}\\, E(x)\\cos(\\omega t), \\quad E(x) = E_{0}\\exp\\!\\left(-\\frac{x^{2}}{L^{2}}\\right),\n$$\n其中 $E_{0}  0$ 是峰值振幅，$L  0$ 是包络尺度长度，$\\omega  0$ 是角频率。假设如下：\n- 运动是严格沿 $x$ 轴的一维运动且为非相对论性的，因此 $|\\dot{x}| \\ll c$。\n- 角频率 $\\,\\omega\\,$ 远大于任何粒子回旋频率和任何特征缓变率，从而确保频率为 $\\,\\omega\\,$ 的快速颤动与由包络梯度引起的慢漂移之间存在清晰的时间尺度分离。\n- 颤动振幅相对于包络尺度很小，即 $\\,\\left| \\frac{q E_{0}}{m \\omega^{2}} \\right| \\ll L$，因此多尺度展开法适用。\n\n两种粒子从 $x = L/2$ 处静止开始运动：一种是电荷为 $q_{e} = -e$、质量为 $m_{e}$ 的电子，另一种是电荷为 $q_{D} = +e$、质量为 $m_{D}$ 的氘核（包含一个质子和一个中子的氢原子核）。将每种粒子独立地视为在给定场中的测试粒子，并忽略集体等离子体响应和静磁场。\n\n从牛顿-洛伦兹方程出发：\n$$\nm\\,\\ddot{x}(t) = q\\,E\\big(x(t)\\big)\\cos(\\omega t),\n$$\n通过将 $x(t) = X(t) + \\xi(t)$ 的形式进行系统的尺度分离，其中 $X(t)$ 是一个在时间 $T$（满足 $\\,\\omega T \\gg 1$）上演化的慢变位置，而 $\\xi(t)$ 是一个频率为 $\\,\\omega\\,$ 且时间平均为零的快速振荡位移。在小参数 $\\,\\epsilon \\equiv \\left| \\frac{q E_{0}}{m \\omega^{2} L} \\right| \\ll 1\\,$ 的领先非平凡阶上进行计算，并确定由空间包络 $\\,E(x)\\,$ 引起的时间平均慢变加速度 $\\,\\ddot{X}\\,$。\n\n在此框架下，计算在 $\\,x = L/2\\,$ 点，电子的有质动力慢变加速度与氘核的有质动力慢变加速度之比。对于数值计算，使用国际单位制（SI）的数值：\n$$\nm_{e} = 9.109\\,383\\,7015 \\times 10^{-31}, \\quad m_{D} = 3.343\\,583\\,719 \\times 10^{-27}, \\quad e = 1.602\\,176\\,634 \\times 10^{-19},\n$$\n其中质量单位为千克，电荷单位为库仑。将最终比率四舍五入到四位有效数字。将最终答案表示为一个无量纲数（无单位）。",
            "solution": "该问题被认为是有效的，因为它科学地基于经典力学和等离子体物理学的原理，提法恰当且目标明确，并为得到唯一解提供了所有必要信息。\n\n质量为 $m$、电荷为 $q$ 的带电粒子在给定的一维电场 $\\mathbf{E}(x,t) = \\hat{\\mathbf{x}}\\, E(x)\\cos(\\omega t)$ 中的运动由牛顿-洛伦兹方程描述：\n$$\nm\\ddot{x}(t) = q E(x(t))\\cos(\\omega t)\n$$\n我们采用尺度分离法，假设粒子的轨迹 $x(t)$ 是慢漂移运动 $X(t)$ 和快速振荡运动 $\\xi(t)$ 的叠加：\n$$\nx(t) = X(t) + \\xi(t)\n$$\n在这里，$X(t)$ 在长时间尺度上变化，而 $\\xi(t)$ 以驱动频率 $\\omega$ 快速振荡，其时间平均为零，即 $\\langle \\xi(t) \\rangle = 0$。因此，$\\dot{x}(t) = \\dot{X}(t) + \\dot{\\xi}(t)$ 且 $\\ddot{x}(t) = \\ddot{X}(t) + \\ddot{\\xi}(t)$。\n\n颤动振幅远小于场包络的空间尺度 $L$ 的假设使我们能够将电场包络 $E(x)$ 在慢变位置 $X(t)$ 附近进行泰勒展开：\n$$\nE(x(t)) = E(X(t) + \\xi(t)) \\approx E(X(t)) + \\xi(t) \\frac{dE}{dX}\\bigg|_{X(t)} + \\mathcal{O}(\\xi^2)\n$$\n将这些代入运动方程得到：\n$$\nm(\\ddot{X} + \\ddot{\\xi}) = q \\left[ E(X) + \\xi \\frac{dE}{dX} \\right] \\cos(\\omega t)\n$$\n我们可以将这个方程分解为在快、慢时间尺度上变化的分量。主导的快速运动由电场的主要分量驱动。在领先阶上，快速运动 $\\xi(t)$ 的方程是：\n$$\nm\\ddot{\\xi} = q E(X) \\cos(\\omega t)\n$$\n由于 $X(t)$ 是缓变的，我们可以将 $E(X)$ 在快速振荡的单个周期内视为近似常数。为了求得 $\\xi(t)$，我们将此方程对时间 $t$ 积分两次，并只保留振荡部分，得到：\n$$\n\\dot{\\xi}(t) = \\int \\frac{q E(X)}{m} \\cos(\\omega t) dt = \\frac{q E(X)}{m\\omega} \\sin(\\omega t)\n$$\n$$\n\\xi(t) = \\int \\frac{q E(X)}{m\\omega} \\sin(\\omega t) dt = -\\frac{q E(X)}{m\\omega^2} \\cos(\\omega t)\n$$\n这个表达式描述了粒子在高频场中的快速颤动。\n\n为了找到慢漂移运动 $X(t)$ 的方程，我们将 $\\xi(t)$ 的表达式代回到展开的运动方程中：\n$$\nm(\\ddot{X} + \\ddot{\\xi}) = q E(X)\\cos(\\omega t) + q \\left(-\\frac{q E(X)}{m\\omega^2} \\cos(\\omega t)\\right) \\frac{dE}{dX} \\cos(\\omega t)\n$$\n使用我们的快速运动的领先阶方程 $m\\ddot{\\xi} = q E(X)\\cos(\\omega t)$，我们可以消去两边的快速振荡项：\n$$\nm\\ddot{X} = -\\frac{q^2 E(X)}{m\\omega^2} \\frac{dE}{dX} \\cos^2(\\omega t)\n$$\n该方程描述了慢变位置 $X(t)$ 的演化。右边的项既包含缓变的空间部分，也包含快速振荡的时间部分 $\\cos^2(\\omega t)$。为了找到净长期漂移，我们对该方程在一个快速振荡周期 $T=2\\pi/\\omega$ 上取平均。令 $\\langle\\cdot\\rangle$ 表示时间平均。\n$$\n\\langle m\\ddot{X} \\rangle = \\left\\langle -\\frac{q^2 E(X)}{m\\omega^2} \\frac{dE}{dX} \\cos^2(\\omega t) \\right\\rangle\n$$\n由于 $X(t)$ 及其导数是慢变量，我们可以在平均区间内将其视为常数，因此 $\\langle m\\ddot{X} \\rangle \\approx m\\ddot{X}$。空间项可以从时间平均中移出：\n$$\nm\\ddot{X} = -\\frac{q^2 E(X)}{m\\omega^2} \\frac{dE}{dX} \\langle\\cos^2(\\omega t)\\rangle\n$$\n$\\cos^2(\\omega t)$ 在一个周期内的时间平均值为 $\\frac{1}{2}$。\n$$\nm\\ddot{X} = -\\frac{q^2}{2m\\omega^2} E(X) \\frac{dE}{dX}\n$$\n这就是有质动力。由此产生的慢变加速度是：\n$$\n\\ddot{X} = -\\frac{q^2}{2m^2\\omega^2} E(X) \\frac{dE}{dX}\n$$\n我们可以使用恒等式 $E(X)\\frac{dE}{dX} = \\frac{1}{2}\\frac{d}{dX}(E(X)^2)$ 将其改写为：\n$$\n\\ddot{X} = -\\frac{q^2}{4m^2\\omega^2} \\frac{d}{dX}\\left(E(X)^2\\right)\n$$\n问题给出了场包络 $E(x) = E_{0}\\exp(-x^{2}/L^{2})$。所以，$E(X)^2 = E_0^2 \\exp(-2X^2/L^2)$。它对 $X$ 的导数是：\n$$\n\\frac{d}{dX}\\left(E(X)^2\\right) = E_0^2 \\exp\\left(-\\frac{2X^2}{L^2}\\right) \\left(-\\frac{4X}{L^2}\\right)\n$$\n将此代入 $\\ddot{X}$ 的表达式中：\n$$\n\\ddot{X}(X) = -\\frac{q^2}{4m^2\\omega^2} \\left[ -E_0^2 \\frac{4X}{L^2} \\exp\\left(-\\frac{2X^2}{L^2}\\right) \\right] = \\frac{q^2 E_0^2}{m^2 \\omega^2 L^2} X \\exp\\left(-\\frac{2X^2}{L^2}\\right)\n$$\n我们需要计算在特定点 $X = L/2$ 处的该加速度：\n$$\n\\ddot{X}|_{X=L/2} = \\frac{q^2 E_0^2}{m^2 \\omega^2 L^2} \\left(\\frac{L}{2}\\right) \\exp\\left(-\\frac{2(L/2)^2}{L^2}\\right) = \\frac{q^2 E_0^2}{2m^2 \\omega^2 L} \\exp\\left(-\\frac{2(L^2/4)}{L^2}\\right) = \\frac{q^2 E_0^2}{2m^2 \\omega^2 L} \\exp\\left(-\\frac{1}{2}\\right)\n$$\n此表达式表明，有质动力加速度与 $q^2/m^2$ 成正比。\n\n现在我们可以求出电子（$q_e = -e$, $m_e$）和氘核（$q_D = +e$, $m_D$）的加速度。\n$$\n\\ddot{X}_e = \\frac{(-e)^2 E_0^2}{2m_e^2 \\omega^2 L} \\exp\\left(-\\frac{1}{2}\\right) = \\frac{e^2 E_0^2}{2m_e^2 \\omega^2 L} \\exp\\left(-\\frac{1}{2}\\right)\n$$\n$$\n\\ddot{X}_D = \\frac{(+e)^2 E_0^2}{2m_D^2 \\omega^2 L} \\exp\\left(-\\frac{1}{2}\\right) = \\frac{e^2 E_0^2}{2m_D^2 \\omega^2 L} \\exp\\left(-\\frac{1}{2}\\right)\n$$\n电子加速度与氘核加速度之比为：\n$$\nR = \\frac{\\ddot{X}_e}{\\ddot{X}_D} = \\frac{\\frac{e^2 E_0^2}{2m_e^2 \\omega^2 L} \\exp(-1/2)}{\\frac{e^2 E_0^2}{2m_D^2 \\omega^2 L} \\exp(-1/2)} = \\frac{1/m_e^2}{1/m_D^2} = \\frac{m_D^2}{m_e^2} = \\left(\\frac{m_D}{m_e}\\right)^2\n$$\n所有其他参数都相互抵消。现在我们代入给定的质量数值：\n$m_e = 9.1093837015 \\times 10^{-31}$ kg\n$m_D = 3.343583719 \\times 10^{-27}$ kg\n$$\nR = \\left(\\frac{3.343583719 \\times 10^{-27}}{9.1093837015 \\times 10^{-31}}\\right)^2\n$$\n首先，我们计算质量比：\n$$\n\\frac{m_D}{m_e} = \\frac{3.343583719}{9.1093837015} \\times 10^{4} \\approx 3670.48275\n$$\n将该比率平方得到：\n$$\nR = (3670.48275)^2 \\approx 13472442.23\n$$\n用科学记数法表示，这是 $1.347244223 \\times 10^7$。四舍五入到四位有效数字，我们得到：\n$$\nR \\approx 1.347 \\times 10^7\n$$",
            "answer": "$$\n\\boxed{1.347 \\times 10^{7}}\n$$"
        },
        {
            "introduction": "有质动力最重要的应用之一是实现对粒子的非接触式囚禁和操控，这在等离子体物理和量子技术中至关重要。本练习探讨了一个实际情景：使用结构化的拉盖尔-高斯激光束来囚禁单个电子。你将通过分析有质势阱的稳定性来确定平衡点，并计算粒子在该势阱中的微小振荡频率，从而将抽象的势场概念与可测量的物理量联系起来 。",
            "id": "351449",
            "problem": "一个电子浸在一个均匀静磁场 $\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$ 中。一束模式指数为 $p=0$ 和 $l=1$ ($LG_{01}$)、频率为 $\\omega$、波数为 $k$ 的拉盖尔-高斯激光束沿 z 轴传播。磁场足够强，使得电子回旋频率 $\\Omega_c = e B_0 / m_e$ 大于激光频率 $\\omega$，其中 $e$ 和 $m_e$ 分别是电子电荷的绝对值和其质量。\n\n在此情况下，电子所受的时间平均有质动力势 $U_p$ 由下式给出：\n$$\nU_p(r, z) = \\frac{e^2}{2m_e(\\omega^2 - \\Omega_c^2)} |E(r,z)|^2\n$$\n其中 $|E(r,z)|^2$ 是激光的时间平均电场强度的平方。\n\n在焦点附近，$LG_{01}$ 光束的电场强度平方振幅可以很好地近似为：\n$$\n|E(r,z)|^2 = E_0^2 \\frac{w_0^2}{w^2(z)} \\frac{2r^2}{w^2(z)} \\exp\\left(-\\frac{2r^2}{w^2(z)}\\right)\n$$\n此处，$r$ 是距光束轴的径向距离，$z$ 是距焦平面的轴向距离，$E_0$ 是一个与峰值激光场相关的常数，$w_0$ 是焦点处的光束腰，$w(z) = w_0 \\sqrt{1 + (z/z_R)^2}$ 是在位置 $z$ 处的光束半径。参数 $z_R = k w_0^2/2$ 是瑞利范围。\n\n这个势为电子创建了一个稳定的三维陷阱。考虑电子围绕其稳定平衡点进行的微小振荡。设 $\\omega_r$ 为径向振荡频率，$\\omega_z$ 为轴向振荡频率。\n\n推导频率平方之比 $\\frac{\\omega_r^2}{\\omega_z^2}$ 的表达式。你的最终答案应以 $k$ 和 $w_0$ 表示。",
            "solution": "1. 写出有质动力势并确定平衡点\n给定的有质动力势为：\n$$\nU_p(r, z) = \\frac{e^2}{2m_e(\\omega^2 - \\Omega_c^2)} |E(r,z)|^2\n$$\n由于 $\\Omega_c > \\omega$，前置系数 $C_p = \\frac{e^2}{2m_e(\\omega^2 - \\Omega_c^2)}$ 为负。我们将势写为：\n$$\nU_p(r, z) = C_p E_0^2 \\frac{w_0^2}{w^2(z)} \\frac{2r^2}{w^2(z)} \\exp\\left(-\\frac{2r^2}{w^2(z)}\\right)\n$$\n这是一个稳定的势阱，其平衡点位于轴向焦点 $z=0$ 和径向强度峰值处。在 $z=0$ 处，$w(z)=w_0$。我们求径向平衡点 $r_0$，即势能对 $r$ 的导数为零的点。令 $\\alpha_0 = 2/w_0^2$：\n$$\n\\frac{\\partial U_p}{\\partial r}\\bigg|_{z=0} \\propto \\frac{\\partial}{\\partial r} \\left( r^2 e^{-\\alpha_0 r^2} \\right) = 2r e^{-\\alpha_0 r^2} - r^2 e^{-\\alpha_0 r^2} (2\\alpha_0 r) = 2r e^{-\\alpha_0 r^2} (1 - \\alpha_0 r^2) = 0\n$$\n非平凡解为 $1 - \\alpha_0 r_0^2 = 0$，即 $r_0^2 = 1/\\alpha_0 = w_0^2/2$。所以 $r_0 = w_0/\\sqrt{2}$。\n\n2. 计算径向振荡频率 $\\omega_r$\n振荡频率由势阱的曲率决定：$m_e \\omega_r^2 = \\frac{\\partial^2 U_p}{\\partial r^2} \\big|_{r_0, z=0}$。我们计算在 $z=0$ 处势对 $r$ 的二阶导数。\n令 $U_p(r,0) = C_0 \\cdot (r^2 e^{-\\alpha_0 r^2})$，其中 $C_0 = C_p E_0^2 \\alpha_0$ 是一个负常数。\n$$\n\\frac{\\partial^2 U_p}{\\partial r^2}\\bigg|_{z=0} = C_0 \\frac{\\partial}{\\partial r} \\left( 2r e^{-\\alpha_0 r^2} (1 - \\alpha_0 r^2) \\right)\n$$\n在 $r=r_0$ 处，$(1-\\alpha_0 r_0^2)=0$，所以我们只需要对不含此项的因子求导：\n$$\n\\frac{\\partial^2 U_p}{\\partial r^2}\\bigg|_{r_0, z=0} = C_0 \\left[ 2r e^{-\\alpha_0 r^2} (-2\\alpha_0 r) \\right]_{r=r_0} = -4 C_0 \\alpha_0 r_0^2 e^{-\\alpha_0 r_0^2}\n$$\n代入 $\\alpha_0 r_0^2 = 1$：\n$$\n\\frac{\\partial^2 U_p}{\\partial r^2}\\bigg|_{r_0, z=0} = -4 C_0 e^{-1} = -4 (C_p E_0^2 \\alpha_0) e^{-1} = -4 C_p E_0^2 (2/w_0^2) e^{-1} = -\\frac{8 C_p E_0^2 e^{-1}}{w_0^2}\n$$\n因此，$m_e \\omega_r^2 = -\\frac{8 C_p E_0^2 e^{-1}}{w_0^2}$。由于 $C_p$ 是负的，$\\omega_r^2$ 是正的。\n\n3. 计算轴向振荡频率 $\\omega_z$\n轴向振荡发生在平衡点 $(r_0, 0)$ 附近。我们考察 $r=r_0$ 处的轴向势 $U_{ax}(z) = U_p(r_0, z)$。\n$$\nU_{ax}(z) = C_p E_0^2 \\frac{w_0^2}{w^2(z)} \\frac{2r_0^2}{w^2(z)} \\exp\\left(-\\frac{2r_0^2}{w^2(z)}\\right)\n$$\n代入 $r_0^2 = w_0^2/2$ 和 $w^2(z) = w_0^2 (1+(z/z_R)^2)$:\n$$\nU_{ax}(z) = C_p E_0^2 \\frac{w_0^2}{w^2(z)} \\frac{w_0^2}{w^2(z)} \\exp\\left(-\\frac{w_0^2}{w^2(z)}\\right) = C_p E_0^2 \\left( \\frac{w_0^2}{w^2(z)} \\right)^2 \\exp\\left(-\\frac{w_0^2}{w^2(z)}\\right)\n$$\n为了计算 $m_e \\omega_z^2 = \\frac{d^2 U_{ax}}{dz^2} \\big|_{z=0}$，我们进行泰勒展开。令 $u = w_0^2/w^2(z) = (1+(z/z_R)^2)^{-1}$。在 $z=0$ 附近，$u \\approx 1 - (z/z_R)^2$。\n$$\nU_{ax}(z) \\approx C_p E_0^2 u^2 e^{-u} \\approx C_p E_0^2 (1 - (z/z_R)^2)^2 e^{-(1-(z/z_R)^2)}\n$$\n$$\nU_{ax}(z) \\approx C_p E_0^2 e^{-1} (1 - 2(z/z_R)^2) (1 + (z/z_R)^2) \\approx C_p E_0^2 e^{-1} (1 - (z/z_R)^2)\n$$\n势阱曲率为：\n$$\n\\frac{d^2 U_{ax}}{dz^2}\\bigg|_{z=0} = C_p E_0^2 e^{-1} \\left( -\\frac{2}{z_R^2} \\right) = -\\frac{2 C_p E_0^2 e^{-1}}{z_R^2}\n$$\n因此，$m_e \\omega_z^2 = -\\frac{2 C_p E_0^2 e^{-1}}{z_R^2}$。\n\n4. 构造比值\n现在我们计算频率平方之比：\n$$\n\\frac{\\omega_r^2}{\\omega_z^2} = \\frac{ m_e \\omega_r^2 }{ m_e \\omega_z^2 } = \\frac{-\\frac{8 C_p E_0^2 e^{-1}}{w_0^2}}{-\\frac{2 C_p E_0^2 e^{-1}}{z_R^2}} = \\frac{8/w_0^2}{2/z_R^2} = 4 \\frac{z_R^2}{w_0^2}\n$$\n代入瑞利范围 $z_R = k w_0^2/2$：\n$$\n\\frac{\\omega_r^2}{\\omega_z^2} = 4 \\frac{(k w_0^2/2)^2}{w_0^2} = 4 \\frac{k^2 w_0^4 / 4}{w_0^2} = k^2 w_0^2\n$$",
            "answer": "$$\\boxed{k^2 w_0^2}$$"
        },
        {
            "introduction": "尽管解析解能提供深刻的物理洞察，但在聚变科学研究中，许多真实世界的复杂场分布问题必须依赖数值计算来解决。这项最终的练习旨在连接理论与计算建模的鸿沟。你将首先推导有质力的通用矢量表达式，然后利用有限差分法实现一个数值算法，在计算网格上求解该力场，这为你将来解决更复杂的波-粒子相互作用问题打下坚实的基础 。",
            "id": "4031295",
            "problem": "在等离子体中，一个非相对论带电粒子受到一个快速振荡的线性偏振电场的作用，该电场的复相量振幅在空间中缓慢变化。在计算聚变科学与工程中，由这种快速振荡在粒子上产生的有效平均力对于模拟波-粒相互作用（例如电子回旋共振加热（ECRH）中使用的相互作用）非常重要。目标是设计并实现一种数值算法，使用适当的时间尺度分离和空间离散化，从第一性原理计算这种有效平均力。\n\n出发点和假设：使用标准的洛伦兹力定律、角频率下的快速振荡与慢漂移之间的时间尺度分离，以及在一个周期内进行时间平均的定义。该算法必须明确地从以下基本依据出发：\n- 洛伦兹力定律：$m \\, \\mathrm{d}\\mathbf{v}/\\mathrm{d}t = q \\left( \\mathbf{E}(t,\\mathbf{x}) + \\mathbf{v} \\times \\mathbf{B}(t,\\mathbf{x}) \\right)$，其中 $q$ 为电荷，$m$ 为质量。\n- 电场表示为一个具有缓慢变化的相量振幅的复指数的实部：$\\mathbf{E}(t,\\mathbf{x}) = \\Re\\left\\{ \\mathbf{\\tilde{E}}(\\mathbf{x}) \\, \\mathrm{e}^{- \\mathrm{i} \\, \\omega t} \\right\\}$，其中 $\\omega$ 是角频率，$\\mathbf{\\tilde{E}}(\\mathbf{x})$ 是随位置 $\\mathbf{x}$ 缓慢变化的复相量振幅。\n- 作用于慢（导心）运动的时间平均力是通过多尺度渐近法，在消除快速颤动并在一个振荡周期 $T = 2\\pi / \\omega$ 内进行平均而得到的。\n\n算法推导约束：\n- 您必须从上述基本定律出发，推导出一个关于场振幅空间变化的可计算表达式，用于描述作用于慢运动的有效平均力。您的推导过程必须通过将粒子运动分离为慢分量和快分量，求解快速振荡分量，然后对洛伦兹动力学进行时间平均以获得慢演化。\n- 您不得使用、引用或假设任何关于有效平均力的预先推导的简化公式；推导必须直接源于基本定律和时间尺度分离。\n- 然后，您必须在一个均匀的笛卡尔网格上使用有限差分法对得到的空间算子进行离散化。内部点必须用二阶中心差分进行近似，而边界点必须使用一阶单边差分。\n- 最终实现的算法必须根据给定的位置标量相量振幅函数，计算网格上的有效平均力矢量场，并评估在指定点上该力的模长。\n\n数值离散化要求：\n- 定义一个以原点为中心的方形计算域，边长 $L = 2.0 \\times 10^{-2} \\, \\mathrm{m}$，坐标范围为 $(x,y) \\in [-L/2,L/2] \\times [-L/2,L/2]$。\n- 使用一个均匀网格，每个方向有 $N_x = N_y = 201$ 个点，网格间距为 $\\Delta x = \\Delta y = L/(N_x-1)$。\n- 电场相量振幅是实值标量（代表线性偏振场的模长）；其空间依赖性在下面的每个测试用例中明确指定。\n\n物理参数：\n- 电荷 $q = 1.602176634 \\times 10^{-19} \\, \\mathrm{C}$。\n- 质量 $m = 9.1093837015 \\times 10^{-31} \\, \\mathrm{kg}$。\n- 角频率 $\\omega$ 取决于具体情况，并在每个测试中指定。\n\n测试套件：\n实现您的算法，并将其应用于以下四个科学上合理的案例，以计算在指定评估点上的有效平均力的模长：\n- 案例1（束中心对称性检查）：高斯包络，峰值振幅 $E_{\\mathrm{peak}} = 1.0 \\times 10^{6} \\, \\mathrm{V/m}$，空间宽度参数 $w = 5.0 \\times 10^{-3} \\, \\mathrm{m}$，定义为 $E_0(x,y) = E_{\\mathrm{peak}} \\, \\exp\\left( - (x^2 + y^2)/w^2 \\right)$。角频率 $\\omega = 2\\pi \\times 170.0 \\times 10^{9} \\, \\mathrm{rad/s}$。在 $(x,y) = (0.0 \\, \\mathrm{m}, 0.0 \\, \\mathrm{m})$ 处评估力的模长。\n- 案例2（内部梯度）：高斯包络和角频率与案例1相同。在 $(x,y) = (w/2, 0.0 \\, \\mathrm{m})$ 处评估力的模长。\n- 案例3（边界单边差分）：高斯包络和角频率与案例1相同。在右边界 $(x,y) = (L/2, 0.0 \\, \\mathrm{m})$ 处评估力的模长。\n- 案例4（边缘案例：均匀场）：均匀包络 $E_0(x,y) = E_{\\mathrm{uniform}}$，其中 $E_{\\mathrm{uniform}} = 1.0 \\times 10^{5} \\, \\mathrm{V/m}$。角频率 $\\omega = 2\\pi \\times 170.0 \\times 10^{9} \\, \\mathrm{rad/s}$。在 $(x,y) = (3.0 \\times 10^{-3} \\, \\mathrm{m}, -2.0 \\times 10^{-3} \\, \\mathrm{m})$ 处评估力的模长。\n\n输出规格：\n- 为每个案例计算指定点处有效平均力的模长。\n- 将每个模长以 $\\,\\mathrm{N}$ 为单位表示，并四舍五入到 $6$ 位有效数字。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\text{案例 1}, \\text{案例 2}, \\text{案例 3}, \\text{案例 4}]$。例如，格式必须与 $[r_1,r_2,r_3,r_4]$ 完全一样，其中 $r_k$ 是以 $\\,\\mathrm{N}$ 为单位的十进制浮点数（允许使用科学记数法）。",
            "solution": "该问题是有效的。这是一个定义明确的计算物理学练习，要求从第一性原理推导和数值实现有质动力。物理背景现实，参数合理，计算要求清晰且自成一体。\n\n### **有质动力的理论推导**\n\n目标是确定在快速振荡、空间非均匀电场中作用于带电粒子上的有效平均力。我们从洛伦兹力定律出发，采用多尺度分析方法，将粒子运动分为慢（导心）分量和快（颤动）分量。\n\n设粒子的位置为 $\\mathbf{x}(t)$，速度为 $\\mathbf{v}(t)$。我们将其分解为：\n$$\n\\mathbf{x}(t) = \\mathbf{X}(t) + \\boldsymbol{\\xi}(t)\n$$\n$$\n\\mathbf{v}(t) = \\mathbf{V}(t) + \\mathbf{v}_{\\xi}(t)\n$$\n其中 $\\mathbf{X}(t)$ 和 $\\mathbf{V}(t) = d\\mathbf{X}/dt$ 代表慢漂移运动，$\\boldsymbol{\\xi}(t)$ 和 $\\mathbf{v}_{\\xi}(t) = d\\boldsymbol{\\xi}/dt$ 代表快速振荡运动。根据定义，快分量在一个振荡周期 $T = 2\\pi/\\omega$ 内的时间平均值为零：$\\langle \\boldsymbol{\\xi} \\rangle = \\mathbf{0}$ 和 $\\langle \\mathbf{v}_{\\xi} \\rangle = \\mathbf{0}$。\n\n电场由 $\\mathbf{E}(t,\\mathbf{x}) = \\Re\\left\\{ \\mathbf{\\tilde{E}}(\\mathbf{x}) \\, e^{-i\\omega t} \\right\\}$ 给出，其中 $\\mathbf{\\tilde{E}}(\\mathbf{x})$ 是缓慢变化的复相量振幅。粒子的运动方程是洛伦兹力定律：\n$$\nm \\frac{d\\mathbf{v}}{dt} = q \\left( \\mathbf{E}(t,\\mathbf{x}) + \\mathbf{v} \\times \\mathbf{B}(t,\\mathbf{x}) \\right)\n$$\n场在粒子的瞬时位置 $\\mathbf{x} = \\mathbf{X} + \\boldsymbol{\\xi}$ 处求值。由于颤动振幅 $|\\boldsymbol{\\xi}|$ 很小，我们可以在慢位置 $\\mathbf{X}$ 附近对场进行泰勒展开：\n$$\n\\mathbf{E}(t, \\mathbf{X} + \\boldsymbol{\\xi}) \\approx \\mathbf{E}(t, \\mathbf{X}) + (\\boldsymbol{\\xi} \\cdot \\nabla) \\mathbf{E}(t, \\mathbf{X})\n$$\n根据法拉第定律 $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$，振荡电场会感生一个振荡磁场。对时间积分得到磁场相量 $\\mathbf{\\tilde{B}} = \\frac{i}{\\omega} (\\nabla \\times \\mathbf{\\tilde{E}})$，因此 $\\mathbf{B}(t, \\mathbf{x}) = \\Re\\{\\frac{i}{\\omega}(\\nabla \\times \\mathbf{\\tilde{E}}(\\mathbf{x})) e^{-i\\omega t}\\}$。\n\n将分解后的运动代入洛伦兹力定律，并保留小颤动量的一阶项，我们识别出描述颤动运动的主导快速振荡项：\n$$\nm \\frac{d\\mathbf{v}_{\\xi}}{dt} \\approx q \\mathbf{E}(t, \\mathbf{X})\n$$\n将此方程对时间积分两次，得到颤动速度和位置：\n$$\n\\mathbf{v}_{\\xi}(t) = \\Re\\left\\{ \\frac{q}{m(-i\\omega)} \\mathbf{\\tilde{E}}(\\mathbf{X}) e^{-i\\omega t} \\right\\} = \\frac{q}{m\\omega} \\Im\\left\\{ \\mathbf{\\tilde{E}}(\\mathbf{X}) e^{-i\\omega t} \\right\\}\n$$\n$$\n\\boldsymbol{\\xi}(t) = \\Re\\left\\{ \\frac{q}{m(-\\omega^2)} \\mathbf{\\tilde{E}}(\\mathbf{X}) e^{-i\\omega t} \\right\\} = -\\frac{q}{m\\omega^2} \\mathbf{E}(t, \\mathbf{X})\n$$\n\n慢运动方程通过对完整的洛伦兹力定律进行时间平均得到。平均力 $\\mathbf{F}_{eff}$ 由下式给出：\n$$\n\\mathbf{F}_{eff} = m \\frac{d\\mathbf{V}}{dt} = \\left\\langle q \\left( \\mathbf{E}(t, \\mathbf{X} + \\boldsymbol{\\xi}) + (\\mathbf{V} + \\mathbf{v}_{\\xi}) \\times \\mathbf{B}(t, \\mathbf{X} + \\boldsymbol{\\xi}) \\right) \\right\\rangle\n$$\n在时间平均过程中保留下来的项是两个振荡量的乘积。非零贡献来自场的空间变化：\n$$\n\\mathbf{F}_{eff} = q \\left\\langle (\\boldsymbol{\\xi} \\cdot \\nabla) \\mathbf{E}(t, \\mathbf{X}) \\right\\rangle + q \\left\\langle \\mathbf{v}_{\\xi} \\times \\mathbf{B}(t, \\mathbf{X}) \\right\\rangle\n$$\n我们计算这些平均值。使用两个谐振实矢量 $\\mathbf{A}(t) = \\Re\\{\\mathbf{\\tilde{A}} e^{-i\\omega t}\\}$ 和 $\\mathbf{B}(t) = \\Re\\{\\mathbf{\\tilde{B}} e^{-i\\omega t}\\}$ 乘积的时间平均恒等式会很方便，对于常矢量 $\\mathbf{C}$，有 $\\langle (\\mathbf{A}\\cdot\\mathbf{C})\\mathbf{B} \\rangle = \\frac{1}{2}\\Re\\{(\\mathbf{\\tilde{A}}^*\\cdot\\mathbf{C})\\mathbf{\\tilde{B}}\\}$，以及 $\\langle \\mathbf{A} \\times \\mathbf{B} \\rangle = \\frac{1}{2}\\Re\\{\\mathbf{\\tilde{A}} \\times \\mathbf{\\tilde{B}}^*\\}$。\n第一项是 $q\\langle(\\boldsymbol{\\xi} \\cdot \\nabla)\\mathbf{E}\\rangle = \\frac{q}{2}\\Re\\{(\\mathbf{\\tilde{\\xi}}^* \\cdot \\nabla)\\mathbf{\\tilde{E}}\\}$。代入 $\\mathbf{\\tilde{\\xi}} = -\\frac{q}{m\\omega^2}\\mathbf{\\tilde{E}}$，得到 $-\\frac{q^2}{2m\\omega^2} \\Re\\{(\\mathbf{\\tilde{E}}^* \\cdot \\nabla)\\mathbf{\\tilde{E}}\\}$。\n第二项是 $q\\langle\\mathbf{v}_{\\xi} \\times \\mathbf{B}\\rangle = \\frac{q}{2}\\Re\\{\\mathbf{\\tilde{v}}_{\\xi} \\times \\mathbf{\\tilde{B}}^*\\}$。代入 $\\mathbf{\\tilde{v}}_{\\xi} = \\frac{iq}{m\\omega}\\mathbf{\\tilde{E}}$ 和 $\\mathbf{\\tilde{B}} = \\frac{i}{\\omega}(\\nabla \\times \\mathbf{\\tilde{E}})$，得到 $\\frac{q}{2}\\Re\\{(\\frac{iq}{m\\omega}\\mathbf{\\tilde{E}}) \\times (-\\frac{i}{\\omega}(\\nabla \\times \\mathbf{\\tilde{E}})^*)\\} = \\frac{q^2}{2m\\omega^2}\\Re\\{\\mathbf{\\tilde{E}} \\times (\\nabla \\times \\mathbf{\\tilde{E}}^*)\\}$。\n\n合并各项：\n$$\n\\mathbf{F}_{eff} = -\\frac{q^2}{2m\\omega^2} \\Re \\left\\{ (\\mathbf{\\tilde{E}}^* \\cdot \\nabla)\\mathbf{\\tilde{E}} - \\mathbf{\\tilde{E}} \\times (\\nabla \\times \\mathbf{\\tilde{E}}^*) \\right\\}\n$$\n使用矢量恒等式 $\\nabla(\\mathbf{A} \\cdot \\mathbf{B}) = (\\mathbf{A}\\cdot\\nabla)\\mathbf{B} + (\\mathbf{B}\\cdot\\nabla)\\mathbf{A} + \\mathbf{A}\\times(\\nabla\\times\\mathbf{B}) + \\mathbf{B}\\times(\\nabla\\times\\mathbf{A})$，我们可以简化该表达式。设 $\\mathbf{A}=\\mathbf{\\tilde{E}}$ 和 $\\mathbf{B}=\\mathbf{\\tilde{E}}^*$，并假设 $\\nabla$ 仅作用于空间部分，我们发现括号中的项简化为 $\\frac{1}{2} \\nabla(\\mathbf{\\tilde{E}} \\cdot \\mathbf{\\tilde{E}}^*) = \\frac{1}{2} \\nabla|\\mathbf{\\tilde{E}}|^2$。\n因此，有质动力的最终表达式为：\n$$\n\\mathbf{F}_{eff} = -\\frac{q^2}{4m\\omega^2} \\nabla |\\mathbf{\\tilde{E}}(\\mathbf{x})|^2\n$$\n对于这个具体问题，相量振幅被指定为一个实标量函数 $E_0(x,y)$，这意味着 $\\mathbf{\\tilde{E}}(\\mathbf{x}) = E_0(x,y) \\mathbf{\\hat{p}}$，其中 $\\mathbf{\\hat{p}}$ 是一个满足 $|\\mathbf{\\hat{p}}|=1$ 的常数偏振矢量。因此，$|\\mathbf{\\tilde{E}}|^2 = E_0(x,y)^2$。需要计算的力是：\n$$\n\\mathbf{F}_{eff}(x,y) = -\\frac{q^2}{4m\\omega^2} \\nabla \\left( E_0(x,y)^2 \\right)\n$$\n这就是我们将要离散化的可计算表达式。\n\n### **数值离散化与算法设计**\n\n该问题要求在一个由 $(x_i, y_j)$ 定义的均匀笛卡尔网格上计算标量场 $U(x,y) = E_0(x,y)^2$ 的梯度，其中 $i \\in [0, N_x-1]$ 且 $j \\in [0, N_y-1]$。令 $U_{i,j} = U(x_i, y_j)$，$\\Delta x = L/(N_x-1)$，$\\Delta y = L/(N_y-1)$。力分量为 $F_x = C \\frac{\\partial U}{\\partial x}$ 和 $F_y = C \\frac{\\partial U}{\\partial y}$，其中 $C = -q^2/(4m\\omega^2)$。\n\n我们使用指定的有限差分格式对偏导数进行离散化：\n\n1.  **内部点** ($1 \\le i \\le N_x-2$, $1 \\le j \\le N_y-2$)：为获得更高精度，使用二阶中心差分。\n    $$\n    \\frac{\\partial U}{\\partial x}\\bigg|_{i,j} \\approx \\frac{U_{i+1, j} - U_{i-1, j}}{2 \\Delta x}\n    $$\n    $$\n    \\frac{\\partial U}{\\partial y}\\bigg|_{i,j} \\approx \\frac{U_{i, j+1} - U_{i, j-1}}{2 \\Delta y}\n    $$\n\n2.  **边界点**：使用一阶单边差分。\n    -   左边界 ($i=0$)：前向差分。\n        $$\n        \\frac{\\partial U}{\\partial x}\\bigg|_{0,j} \\approx \\frac{U_{1, j} - U_{0, j}}{\\Delta x}\n        $$\n    -   右边界 ($i=N_x-1$)：后向差分。\n        $$\n        \\frac{\\partial U}{\\partial x}\\bigg|_{N_x-1,j} \\approx \\frac{U_{N_x-1, j} - U_{N_x-2, j}}{\\Delta x}\n        $$\n    -   对于底边界 ($j=0$) 和顶边界 ($j=N_y-1$) 的 $\\partial U / \\partial y$，应用类似的前向/后向差分。\n\n算法流程如下：\n1.  建立计算网格和物理常数。\n2.  对每个测试用例，定义角频率 $\\omega$ 和场振幅 $E_0(x,y)$ 的空间分布。\n3.  计算常数前置因子 $C = -q^2/(4m\\omega^2)$。\n4.  在整个网格上计算矩阵 $U_{i,j} = E_0(x_i,y_j)^2$。\n5.  使用上述混合有限差分格式计算每个网格点上的梯度分量 $\\frac{\\partial U}{\\partial x}$ 和 $\\frac{\\partial U}{\\partial y}$。\n6.  计算力矢量分量 $F_x(x_i, y_j)$ 和 $F_y(x_i, y_j)$。\n7.  对于每个指定的评估点 $(x_{eval}, y_{eval})$，找到最近的网格索引 $(i^*, j^*)$。\n8.  提取力分量 $F_x(x_{i^*}, y_{j^*})$ 和 $F_y(x_{i^*}, y_{j^*})$.\n9.  计算力的模长 $|\\mathbf{F}| = \\sqrt{F_x^2 + F_y^2}$ 并将结果格式化为 $6$ 位有效数字。\n\n这种结构化方法确保了实现严格遵守问题的推导和离散化要求。",
            "answer": "$$\n\\boxed{[0.000000, 3.37689 \\times 10^{-15}, 6.13090 \\times 10^{-17}, 0.000000]}\n$$"
        }
    ]
}