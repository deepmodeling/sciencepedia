{
    "hands_on_practices": [
        {
            "introduction": "趋肤深度是理解交变电磁场如何穿透导体的基本概念。在本练习中，您将从第一性原理出发，推导磁扩散方程和趋肤深度公式 $\\delta = \\sqrt{2\\eta/(\\mu_0 \\omega)}$。这项实践对于掌握托卡马克放电在动态的启动和关闭阶段，等离子体电流剖面如何建立和控制至关重要，因为在这些阶段，施加的环路电压包含瞬态分量 。",
            "id": "4024658",
            "problem": "对于环向电场的瞬态穿透，大环径比托卡马克在欧姆启动和关断期间的等离子体柱可以被建模为一个占据 $x \\ge 0$ 的半无限、均匀、各向同性、电阻性平板。一个时谐环向回路电压被施加，使得等离子体边界（$x=0$）处的切向电场以角频率 $\\omega$ 正弦变化。等离子体具有均匀的电阻率 $\\eta$ 和等于真空值 $\\mu_{0}$ 的磁导率。假设等离子体处于准中性、碰撞、磁流体动力学状态，因此广义欧姆定律简化为电阻形式，并且在所关心的频率下，位移电流相对于传导电流可以忽略不计。\n\n从麦克斯韦方程组和欧姆定律出发，并施加一个角频率为 $\\omega$ 的正弦边界驱动，推导振荡磁场穿入等离子体时空间衰减的控制关系式，并求出趋肤深度作为 $\\eta$、$\\mu_{0}$ 和 $\\omega$ 的函数。然后，对于频率为 $f=100\\,\\mathrm{Hz}$（因此 $\\omega=2\\pi f$）的代表性欧姆驱动纹波，计算两种工作条件下的趋肤深度：\n- 早期启动（冷等离子体）：$\\eta_{\\mathrm{start}}=5.0\\times 10^{-5}\\,\\Omega\\cdot\\mathrm{m}$。\n- 晚期关断降流（仍为温等离子体）：$\\eta_{\\mathrm{shut}}=1.0\\times 10^{-5}\\,\\Omega\\cdot\\mathrm{m}$。\n\n使用 $\\mu_{0}=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$。将您计算的趋肤深度四舍五入至四位有效数字，并以米为单位表示。此外，请用文字解释这些值对于大环径比托卡马克在启动和关断瞬态过程中电流穿透和剖面演化的物理含义，并简要地与在更高频率下射频（RF）加热的预期情况进行对比。最终的数值答案必须以行矩阵的形式呈现，按顺序对应于 $\\eta_{\\mathrm{start}}$ 和 $\\eta_{\\mathrm{shut}}$。",
            "solution": "经评估，该问题是有效的，因为它的科学基础是电磁学和磁流体动力学原理，问题提法明确且信息充分，可得出唯一解，并且其表述是客观的。对于所描述的物理场景，该简化模型是一种标准且恰当的近似。\n\n我们从麦克斯韦方程组和电阻性欧姆定律开始。在位移电流可忽略的指定假设下，相关方程是法拉第电磁感应定律和安培定律：\n$$\n\\nabla \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t} \\quad (1)\n$$\n$$\n\\nabla \\times \\vec{B} = \\mu_{0} \\vec{J} \\quad (2)\n$$\n简化的电阻性欧姆定律通过等离子体电阻率 $\\eta$ 将电场 $\\vec{E}$ 与电流密度 $\\vec{J}$ 联系起来：\n$$\n\\vec{E} = \\eta \\vec{J} \\quad (3)\n$$\n我们寻求磁场 $\\vec{B}$ 的控制方程。为此，我们对安培定律（2）取旋度：\n$$\n\\nabla \\times (\\nabla \\times \\vec{B}) = \\mu_{0} (\\nabla \\times \\vec{J})\n$$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\vec{A}) = \\nabla(\\nabla \\cdot \\vec{A}) - \\nabla^2 \\vec{A}$ 和麦克斯韦方程 $\\nabla \\cdot \\vec{B} = 0$，左侧简化为 $-\\nabla^2 \\vec{B}$。方程变为：\n$$\n-\\nabla^2 \\vec{B} = \\mu_{0} (\\nabla \\times \\vec{J}) \\quad (4)\n$$\n接下来，我们用 $\\vec{B}$ 来表示 $\\nabla \\times \\vec{J}$。根据欧姆定律（3），假设电阻率 $\\eta$ 均匀，我们有 $\\nabla \\times \\vec{J} = \\nabla \\times (\\frac{1}{\\eta}\\vec{E}) = \\frac{1}{\\eta}(\\nabla \\times \\vec{E})$。代入法拉第定律（1）可得：\n$$\n\\nabla \\times \\vec{J} = \\frac{1}{\\eta} \\left(-\\frac{\\partial \\vec{B}}{\\partial t}\\right)\n$$\n将此结果代回方程（4），得到磁场的控制关系式：\n$$\n-\\nabla^2 \\vec{B} = \\mu_{0} \\left(-\\frac{1}{\\eta}\\frac{\\partial \\vec{B}}{\\partial t}\\right)\n$$\n这简化为磁扩散方程：\n$$\n\\nabla^2 \\vec{B} = \\frac{\\mu_{0}}{\\eta} \\frac{\\partial \\vec{B}}{\\partial t}\n$$\n该问题将等离子体建模为占据 $x \\ge 0$ 的半无限平板。施加的环向电场与 $x=0$ 处的表面相切，并且仅在垂直于表面的方向 $x$ 上变化。设环向为 $\\hat{z}$ 方向，则 $\\vec{E} = E_z(x, t)\\hat{z}$。根据法拉第定律，这意味着相应的磁场（在托卡马克中为极向场）在 $\\hat{y}$ 方向上，即 $\\vec{B} = B_y(x, t)\\hat{y}$。在这种一维几何结构中，拉普拉斯算子简化为 $\\nabla^2 \\to \\frac{\\partial^2}{\\partial x^2}$。磁场分量 $B_y$ 的扩散方程为：\n$$\n\\frac{\\partial^2 B_y}{\\partial x^2} = \\frac{\\mu_{0}}{\\eta} \\frac{\\partial B_y}{\\partial t}\n$$\n我们假设一个角频率为 $\\omega$ 的时谐解，这与边界条件一致。我们可以用复相量表示场：$B_y(x,t) = \\text{Re}\\{\\tilde{B}_y(x)e^{j\\omega t}\\}$。将此形式代入扩散方程，时间导数 $\\frac{\\partial}{\\partial t}$ 变为乘以 $j\\omega$。这将偏微分方程转换为关于复振幅 $\\tilde{B}_y(x)$ 的常微分方程：\n$$\n\\frac{d^2 \\tilde{B}_y}{dx^2} = \\frac{j\\omega\\mu_{0}}{\\eta} \\tilde{B}_y\n$$\n这是一个形如 $\\frac{d^2 \\tilde{B}_y}{dx^2} - k^2 \\tilde{B}_y = 0$ 的二阶线性常微分方程，其中复波数 $k$ 由 $k^2 = \\frac{j\\omega\\mu_{0}}{\\eta}$ 给出。我们可以解出 $k$：\n$$\nk = \\sqrt{\\frac{j\\omega\\mu_{0}}{\\eta}} = \\sqrt{j} \\sqrt{\\frac{\\omega\\mu_{0}}{\\eta}}\n$$\n使用恒等式 $\\sqrt{j} = \\sqrt{e^{j\\pi/2}} = e^{j\\pi/4} = \\cos(\\frac{\\pi}{4}) + j\\sin(\\frac{\\pi}{4}) = \\frac{1+j}{\\sqrt{2}}$，我们发现：\n$$\nk = \\frac{1+j}{\\sqrt{2}} \\sqrt{\\frac{\\omega\\mu_{0}}{\\eta}} = (1+j) \\sqrt{\\frac{\\omega\\mu_{0}}{2\\eta}}\n$$\n$\\tilde{B}_y(x)$ 的通解是 $\\tilde{B}_y(x) = C_1 e^{-kx} + C_2 e^{kx}$。为了使场在物理上是现实的，它在 $x \\to \\infty$ 时不能发散。由于 $k$ 的实部为正，项 $e^{kx}$ 将会无界增长。因此我们必须设置 $C_2=0$。于是解为：\n$$\n\\tilde{B}_y(x) = \\tilde{B}_y(0) e^{-kx} = \\tilde{B}_y(0) \\exp\\left(-(1+j)\\sqrt{\\frac{\\omega\\mu_{0}}{2\\eta}} x\\right)\n$$\n这可以分离为一个空间衰减项和一个空间相移项：\n$$\n\\tilde{B}_y(x) = \\tilde{B}_y(0) \\exp\\left(-\\frac{x}{\\sqrt{\\frac{2\\eta}{\\omega\\mu_{0}}}}\\right) \\exp\\left(-j\\frac{x}{\\sqrt{\\frac{2\\eta}{\\omega\\mu_{0}}}}\\right)\n$$\n振荡磁场空间衰减的控制关系是其振幅的指数衰减：$|\\tilde{B}_y(x)| = |\\tilde{B}_y(0)|e^{-x/\\delta}$。此衰减的特征长度标度是趋肤深度 $\\delta$。通过观察解的形式，趋肤深度为：\n$$\n\\delta = \\sqrt{\\frac{2\\eta}{\\omega\\mu_{0}}}\n$$\n现在，我们计算两种给定情况下的趋肤深度。驱动频率为 $f=100\\,\\mathrm{Hz}$，因此角频率为 $\\omega = 2\\pi f = 200\\pi\\,\\mathrm{rad/s}$。自由空间磁导率为 $\\mu_{0}=4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$。\n\n情况1：早期启动，$\\eta_{\\mathrm{start}}=5.0\\times 10^{-5}\\,\\Omega\\cdot\\mathrm{m}$。\n$$\n\\delta_{\\mathrm{start}} = \\sqrt{\\frac{2(5.0\\times 10^{-5})}{(200\\pi)(4\\pi\\times 10^{-7})}} = \\sqrt{\\frac{1.0\\times 10^{-4}}{8\\pi^2\\times 10^{-5}}} = \\sqrt{\\frac{10}{8\\pi^2}} = \\sqrt{\\frac{5}{4\\pi^2}} = \\frac{\\sqrt{5}}{2\\pi} \\approx 0.355866\\,\\mathrm{m}\n$$\n四舍五入至四位有效数字，$\\delta_{\\mathrm{start}} = 0.3559\\,\\mathrm{m}$。\n\n情况2：晚期关断，$\\eta_{\\mathrm{shut}}=1.0\\times 10^{-5}\\,\\Omega\\cdot\\mathrm{m}$。\n$$\n\\delta_{\\mathrm{shut}} = \\sqrt{\\frac{2(1.0\\times 10^{-5})}{(200\\pi)(4\\pi\\times 10^{-7})}} = \\sqrt{\\frac{2.0\\times 10^{-5}}{8\\pi^2\\times 10^{-5}}} = \\sqrt{\\frac{1}{4\\pi^2}} = \\frac{1}{2\\pi} \\approx 0.159155\\,\\mathrm{m}\n$$\n四舍五入至四位有效数字，$\\delta_{\\mathrm{shut}} = 0.1592\\,\\mathrm{m}$。\n\n物理含义：\n趋肤深度 $\\delta$ 决定了环向电场和相关的极向磁场能穿透到等离子体中的距离。这决定了欧姆电流在何处被驱动。\n- 在启动期间，等离子体是冷的，具有高电阻率（$\\eta_{\\mathrm{start}}$）。这导致了较大的趋肤深度（$\\delta_{\\mathrm{start}} \\approx 0.36\\,\\text{m}$）。这个值是典型托卡马克小半径（例如 $a \\sim 0.5 - 1.0\\,\\text{m}$）的很大一部分。这种深穿透是有利的，因为它从一开始就建立了一个宽的电流剖面，这通常更具有磁流体动力学（MHD）稳定性，并允许对整个等离子体体积进行更有效的加热。\n- 在关断期间，等离子体仍然是热的，具有低电阻率（$\\eta_{\\mathrm{shut}}$）。这导致了小得多的趋肤深度（$\\delta_{\\mathrm{shut}} \\approx 0.16\\,\\text{m}$）。外部回路电压的变化，例如在降流过程中，将只影响等离子体外部区域的电流。在热的、高电导率的核心区的电流是“冻结”的，并在其自身的更长的电阻扩散时间尺度（$\\tau_R \\sim \\mu_0 a^2 / \\eta$）上衰减。这导致电流从边缘“剥离”，使得电流剖面变得更尖锐，如果不仔细控制，可能会引发MHD不稳定性，如撕裂模和破裂。\n- 与射频（RF）加热的对比：射频系统在更高得多的频率（$f \\sim 10^7 - 10^{11}\\,\\mathrm{Hz}$）下运行，这意味着 $\\omega$ 要大好几个数量级。由于 $\\delta \\propto 1/\\sqrt{\\omega}$，在这些频率下的经典趋肤深度极小，通常为微米到毫米量级。电阻性MHD模型和简单的场扩散概念不再适用。相反，射频功率通过传播的等离子体波（例如，电子回旋波、低混杂波、快波）穿透等离子体。这些波的传播和吸收由复杂的色散关系控制，涉及等离子体密度、磁场强度以及特定的共振/截止条件，从而允许高度局域化的功率沉积，这与低频欧姆场的扩散穿透是一种根本上不同的物理机制。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3559  0.1592\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然趋肤深度提供了一个有价值的解析估计，但电流剖面的完整演化由电阻扩散过程决定，该过程对局域等离子体电阻率高度敏感。本练习在前一个练习的基础上，要求您为完整的电流扩散方程开发一个数值模拟程序，并引入与温度相关的斯皮策电阻率 $\\eta(r) \\propto T_e(r)^{-3/2}$。通过这项实践，您将研究不同的电子温度剖面如何影响电流穿透的速率以及电流密度剖面的最终形态 。",
            "id": "4024634",
            "problem": "考虑一个磁约束装置中，小半径为 $a$ 的环向轴对称等离子体柱，为研究平行电流扩散，将其建模为一直圆柱体。设平行（轴向）电流密度为 $J(r,t)$，其中 $r \\in [0,a]$ 为小半径，$t \\ge 0$ 为时间。假设环向电场 $E(r,t)$ 与电流密度方向一致，且等离子体是磁流体动力学稳定的和准中性的。磁导率为真空磁导率 $\\mu_0$。平行电场遵循广义欧姆定律 $E(r,t) = \\eta(r) J(r,t)$，其中电阻率 $\\eta(r)$ 为斯皮策电阻率，近似为\n$$\n\\eta(r) = C \\, Z_{\\mathrm{eff}} \\, \\ln \\Lambda \\, T_e(r)^{-3/2},\n$$\n其中 $C = 5.2 \\times 10^{-5} \\,\\mathrm{\\Omega \\cdot m \\cdot eV}^{3/2}$，有效电荷为 $Z_{\\mathrm{eff}}$，库仑对数为 $\\ln \\Lambda$，电子温度 $T_e(r)$ 以电子伏特为单位。全文使用国际单位制（SI）。\n\n使用麦克斯韦-法拉第定律 $\\partial \\mathbf{B}/\\partial t = -\\nabla \\times \\mathbf{E}$、安培定律 $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$、轴对称性以及柱坐标系 $(r,\\theta,z)$（其中 $\\mathbf{J} = J(r,t) \\hat{\\mathbf{z}}$ 且 $\\mathbf{B} = B_\\theta(r,t) \\hat{\\boldsymbol{\\theta}}$），从第一性原理推导守恒形式的电流扩散方程\n$$\n\\mu_0 \\frac{\\partial J(r,t)}{\\partial t} = \\frac{1}{r} \\frac{\\partial}{\\partial r}\\!\\left( r \\frac{\\partial}{\\partial r}\\big(\\eta(r) J(r,t)\\big) \\right).\n$$\n假设以下符合物理实际的边界条件和初始条件：\n- 磁轴处的对称性：$\\left. \\frac{\\partial}{\\partial r}\\big(\\eta(r) J(r,t)\\big) \\right|_{r=0} = 0$。\n- 等离子体边界处固定的环向电场：$E(a,t) = E_0$，为一常数，单位为 $\\mathrm{V/m}$，这意味着狄利克雷边界条件 $J(a,t) = E_0 / \\eta(a)$ 对所有 $t \\ge 0$ 成立。\n- 初始条件：$J(r,0) = 0$ 对所有 $r \\in [0,a]$ 成立。\n\n您的任务是使用一种能够顾及柱对称性和上述守恒形式的有限体积或有限差分方法，为在 $r \\in [0,a]$ 和 $t \\in [0,t_{\\mathrm{end}}]$ 上的 $J(r,t)$ 实现一个稳健的数值求解器。您必须：\n- 根据指定的 $T_e(r)$ 剖面，通过上述斯皮策公式显式计算 $\\eta(r)$。\n- 使用显式时间推进格式，并选择一个时间步长以满足与局域电阻扩散系数 $D(r) = \\eta(r)/\\mu_0$ 相关的稳定性判据。一个安全的选择是将时间步长 $\\Delta t$ 设置为 $\\mu_0 \\Delta r^2 / \\max_r \\eta(r)$ 的一小部分，其中 $\\Delta r$ 是均匀的径向网格间距。请清晰地陈述并实现您的选择。\n- 在 $r=0$ 和 $r=a$ 处施加与守恒算子和欧姆定律一致的边界条件。\n- 对每个测试案例，返回中心电流密度 $J(0,t_{\\mathrm{end}})$ 的值，单位为 $\\mathrm{A/m^2}$。\n\n此处不动态施加射频（RF）加热；但是，问题要求通过电阻率对 $T_e(r)$ 的依赖性及其对电流扩散时间尺度的影响，仔细考虑欧姆加热原理。您将通过三种不同的 $T_e(r)$ 剖面，分析空间变化的 $\\eta(r)$ 对 $J(r,t)$ 扩散的影响。\n\n测试套件。为覆盖不同情况，请评估以下三种案例。在所有案例中，取 $a = 1.0 \\,\\mathrm{m}$，$Z_{\\mathrm{eff}} = 1.5$，$\\ln \\Lambda = 17$，$E_0 = 0.02 \\,\\mathrm{V/m}$，以及 $t_{\\mathrm{end}} = 0.01 \\,\\mathrm{s}$。使用包含 $N$ 个点的均匀径向网格，并根据参数自动计算一个稳定的 $\\Delta t$。所有输出均以 $\\mathrm{A/m^2}$ 表示。\n\n- 案例 1 (芯部温度峰化): $N = 400$, $T_e(r) = T_{\\mathrm{edge}} + \\left(T_{\\mathrm{core}} - T_{\\mathrm{edge}}\\right) \\left(1 - (r/a)^2\\right)^\\alpha$, 其中 $T_{\\mathrm{core}} = 3000 \\,\\mathrm{eV}$, $T_{\\mathrm{edge}} = 150 \\,\\mathrm{eV}$, 且 $\\alpha = 2$。\n- 案例 2 (均匀温度): $N = 400$, $T_e(r) = 1000 \\,\\mathrm{eV}$ 对所有 $r$。\n- 案例 3 (空心温度剖面): $N = 400$, $T_e(r) = T_{\\mathrm{core}} + \\left(T_{\\mathrm{edge}} - T_{\\mathrm{core}}\\right) \\left(r/a\\right)^\\beta$, 其中 $T_{\\mathrm{core}} = 800 \\,\\mathrm{eV}$, $T_{\\mathrm{edge}} = 2000 \\,\\mathrm{eV}$, 且 $\\beta = 2$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，三个值按顺序分别对应案例 1、2 和 3 的中心电流密度 $J(0,t_{\\mathrm{end}})$，例如 $\\left[ \\text{result}_1, \\text{result}_2, \\text{result}_3 \\right]$。输出必须是单行打印的 Python 列表字面量，且每个条目都必须是单位为 $\\mathrm{A/m^2}$ 的浮点数。",
            "solution": "该问题是有效的，因为它在科学上基于等离子体物理学和磁流体动力学原理，对于一个抛物型偏微分方程给出了充分的初始和边界条件，问题陈述客观。我们现在开始求解。\n\n### 第一部分：电流扩散方程的推导\n\n我们首先在指定的圆柱几何内，从第一性原理，即麦克斯韦方程组和广义欧姆定律，推导平行电流密度 $J(r,t)$ 的控制偏微分方程（PDE）。\n\n问题假设一个具有环向轴对称性的直圆柱等离子体柱，其中电流沿轴向（$\\hat{\\mathbf{z}}$）流动，磁场在角向（$\\hat{\\boldsymbol{\\theta}}$）。\n相关的物理量为：\n- 电流密度：$\\mathbf{J}(r,t) = J(r,t) \\hat{\\mathbf{z}}$\n- 电场：$\\mathbf{E}(r,t) = E(r,t) \\hat{\\mathbf{z}}$（根据欧姆定律，必须与 $\\mathbf{J}$ 平行）\n- 磁场：$\\mathbf{B}(r,t) = B_\\theta(r,t) \\hat{\\boldsymbol{\\theta}}$\n\n控制方程为：\n1.  **麦克斯韦-法拉第定律**: $\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$\n2.  **安培定律**: $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$\n3.  **广义欧姆定律**: $E(r,t) = \\eta(r) J(r,t)$，其中 $\\eta(r)$ 是空间变化的等离子体电阻率。\n\n我们在柱坐标 $(r, \\theta, z)$ 下计算旋度算子。\n对于电场 $\\mathbf{E} = E(r,t) \\hat{\\mathbf{z}}$：\n$$\n\\nabla \\times \\mathbf{E} = \\left( \\frac{1}{r}\\frac{\\partial E_z}{\\partial \\theta} - \\frac{\\partial E_\\theta}{\\partial z} \\right) \\hat{\\mathbf{r}} + \\left( \\frac{\\partial E_r}{\\partial z} - \\frac{\\partial E_z}{\\partial r} \\right) \\hat{\\boldsymbol{\\theta}} + \\frac{1}{r}\\left( \\frac{\\partial(r E_\\theta)}{\\partial r} - \\frac{\\partial E_r}{\\partial \\theta} \\right) \\hat{\\mathbf{z}}\n$$\n由于 $E_r=0$，$E_\\theta=0$，以及轴对称性（$\\partial/\\partial\\theta = 0$），旋度简化为：\n$$\n\\nabla \\times \\mathbf{E} = -\\frac{\\partial E(r,t)}{\\partial r} \\hat{\\boldsymbol{\\theta}}\n$$\n将此代入麦克斯韦-法拉第定律，并注意到 $\\mathbf{B} = B_\\theta(r,t) \\hat{\\boldsymbol{\\theta}}$，我们得到方程的 $\\hat{\\boldsymbol{\\theta}}$ 分量：\n$$\n-\\frac{\\partial E(r,t)}{\\partial r} = -\\frac{\\partial B_\\theta(r,t)}{\\partial t} \\implies \\frac{\\partial B_\\theta(r,t)}{\\partial t} = \\frac{\\partial E(r,t)}{\\partial r}\n$$\n\n接下来，我们计算磁场 $\\mathbf{B} = B_\\theta(r,t) \\hat{\\boldsymbol{\\theta}}$ 的旋度：\n$$\n\\nabla \\times \\mathbf{B} = \\left( \\frac{1}{r}\\frac{\\partial B_z}{\\partial \\theta} - \\frac{\\partial B_\\theta}{\\partial z} \\right) \\hat{\\mathbf{r}} + \\left( \\frac{\\partial B_r}{\\partial z} - \\frac{\\partial B_z}{\\partial r} \\right) \\hat{\\boldsymbol{\\theta}} + \\frac{1}{r}\\left( \\frac{\\partial(r B_\\theta)}{\\partial r} - \\frac{\\partial B_r}{\\partial \\theta} \\right) \\hat{\\mathbf{z}}\n$$\n由于 $B_r=0$，$B_z=0$，轴对称性以及与 $z$ 无关（直圆柱近似），这简化为：\n$$\n\\nabla \\times \\mathbf{B} = \\frac{1}{r}\\frac{\\partial (r B_\\theta)}{\\partial r} \\hat{\\mathbf{z}}\n$$\n将此代入安培定律，我们得到 $\\hat{\\mathbf{z}}$ 分量：\n$$\n\\frac{1}{r}\\frac{\\partial (r B_\\theta)}{\\partial r} = \\mu_0 J(r,t)\n$$\n为了连接这些方程，我们对安培定律取时间导数：\n$$\n\\frac{\\partial}{\\partial t} \\left( \\frac{1}{r}\\frac{\\partial (r B_\\theta)}{\\partial r} \\right) = \\mu_0 \\frac{\\partial J}{\\partial t}\n$$\n假设有足够的光滑性，我们可以交换微分顺序：\n$$\n\\frac{1}{r}\\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial B_\\theta}{\\partial t} \\right) = \\mu_0 \\frac{\\partial J}{\\partial t}\n$$\n现在，从法拉第定律的结果中代入 $\\frac{\\partial B_\\theta}{\\partial t}$：\n$$\n\\frac{1}{r}\\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial E}{\\partial r} \\right) = \\mu_0 \\frac{\\partial J}{\\partial t}\n$$\n最后，我们使用欧姆定律 $E(r,t) = \\eta(r)J(r,t)$ 来消去电场 $E$：\n$$\n\\mu_0 \\frac{\\partial J}{\\partial t} = \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial}{\\partial r} (\\eta(r) J) \\right)\n$$\n这就是我们所求的守恒形式的电流扩散方程。\n\n### 第二部分：数值实现\n\n我们将使用有限差分法在均匀径向网格上求解推导出的偏微分方程。\n\n**2.1. 离散化**\n我们定义一个包含 $N$ 个点的均匀径向网格：$r_i = i \\cdot \\Delta r$，其中 $i=0, 1, \\dots, N-1$，网格间距为 $\\Delta r = a/(N-1)$。这使得节点位于磁轴（$r_0=0$）和等离子体边界（$r_{N-1}=a$）。令 $J_i(t)$ 为 $J(r_i, t)$ 的数值近似。令 $U(r,t) = \\eta(r)J(r,t)$，其离散化形式为 $U_i = \\eta_i J_i$，其中 $\\eta_i = \\eta(r_i)$。\n\n偏微分方程的右侧（RHS）是一个守恒形式的空间算子，$\\mathcal{L}[J] = \\frac{1}{\\mu_0 r} \\frac{\\partial F}{\\partial r}$，其中通量为 $F = r \\frac{\\partial U}{\\partial r}$。我们使用中心差分来离散化这个算子。\n\n对于内部点 $i=1, \\dots, N-2$：\n$$\n\\left. \\frac{\\partial F}{\\partial r} \\right|_{r_i} \\approx \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta r}\n$$\n其中 $F_{i\\pm1/2}$ 是在单元交界面 $r_{i\\pm1/2} = r_i \\pm \\Delta r/2$ 处的通量。我们将这些通量近似为：\n$$\nF_{i+1/2} = r_{i+1/2} \\left. \\frac{\\partial U}{\\partial r} \\right|_{r_{i+1/2}} \\approx r_{i+1/2} \\frac{U_{i+1} - U_i}{\\Delta r}\n$$\n$$\nF_{i-1/2} = r_{i-1/2} \\left. \\frac{\\partial U}{\\partial r} \\right|_{r_{i-1/2}} \\approx r_{i-1/2} \\frac{U_i - U_{i-1}}{\\Delta r}\n$$\n将这些代入偏微分方程，得到 $i=1, \\dots, N-2$ 的半离散化形式：\n$$\n\\frac{dJ_i}{dt} = \\frac{1}{\\mu_0 r_i (\\Delta r)^2} \\left[ r_{i+1/2}(U_{i+1} - U_i) - r_{i-1/2}(U_{i} - U_{i-1}) \\right]\n$$\n其中 $r_{i\\pm1/2} = (i \\pm 0.5)\\Delta r$。\n\n对于中心点 $r_0=0$：\n柱坐标算子有一个可去奇点。当 $r \\to 0$ 时，我们有 $\\frac{1}{r} \\frac{\\partial}{\\partial r} (r \\frac{\\partial U}{\\partial r}) \\to 2 \\frac{\\partial^2 U}{\\partial r^2}$。利用对称性条件 $\\left. \\frac{\\partial U}{\\partial r} \\right|_{r=0}=0$（这意味着 $U(-r)=U(r)$），我们可以将二阶导数离散化为：\n$$\n\\left. \\frac{\\partial^2 U}{\\partial r^2} \\right|_{r=0} \\approx \\frac{U_1 - 2U_0 + U_{-1}}{(\\Delta r)^2} = \\frac{2(U_1 - U_0)}{(\\Delta r)^2}\n$$\n因此，中心点的方程变为：\n$$\n\\frac{dJ_0}{dt} = \\frac{2}{\\mu_0} \\frac{2(U_1 - U_0)}{(\\Delta r)^2} = \\frac{4}{\\mu_0 (\\Delta r)^2}(U_1 - U_0)\n$$\n\n**2.2. 时间积分与稳定性**\n我们使用显式向前欧拉法进行时间积分。如果 $J_i^n$ 是在时间 $t_n = n \\Delta t$ 的解，则下一个时间步的解为：\n$$\nJ_i^{n+1} = J_i^n + \\Delta t \\cdot \\left( \\frac{dJ_i}{dt} \\right)^n\n$$\n为使显式方法稳定，时间步长 $\\Delta t$ 必须足够小。扩散方程的稳定性条件通常形式为 $\\Delta t \\le K \\frac{(\\Delta r)^2}{D_{\\max}}$，其中 $D(r) = \\eta(r)/\\mu_0$ 是扩散系数。按照建议，我们选择一个安全的时间步长：\n$$\n\\Delta t = f \\frac{\\mu_0 (\\Delta r)^2}{\\max_r \\eta(r)}\n$$\n安全因子 $f=0.4$，以确保整个网格的稳定性。\n\n**2.3. 初始条件和边界条件**\n- **初始条件**：在 $t=0$ 时，电流为零：$J_i^0 = 0$ 对所有 $i$ 成立。\n- **$r=0$ 处的边界条件**：对称性条件 $\\left. \\frac{\\partial U}{\\partial r} \\right|_{r=0}=0$ 已被 $i=0$ 处离散方程的特殊形式隐式地满足。\n- **$r=a$ 处的边界条件**：施加一个固定的电场 $E_0$，给出狄利克雷条件 $E(a,t) = \\eta(a)J(a,t) = E_0$。这决定了边界处的电流密度：\n$$\nJ_{N-1}(t) = \\frac{E_0}{\\eta(a)} \\quad \\text{对所有 } t \\ge 0.\n$$\n在整个模拟过程中，该值是恒定的。在对 $i=N-2$ 进行更新步骤时，需要项 $U_{N-1}$。该项就是 $U_{N-1} = \\eta_{N-1} J_{N-1} = E_0$。\n\n**2.4. 算法**\n总体算法如下：\n1.  设置常数（$\\mu_0, C, Z_{\\mathrm{eff}}, \\ln \\Lambda$）和问题参数（$a, N, E_0, t_{\\mathrm{end}}$）。\n2.  定义径向网格 $r_i$ 并计算 $\\Delta r$。\n3.  对于给定的温度剖面 $T_e(r)$，计算电阻率剖面 $\\eta_i = C Z_{\\mathrm{eff}} \\ln \\Lambda T_e(r_i)^{-3/2}$。\n4.  确定最大电阻率 $\\eta_{\\max} = \\max_i(\\eta_i)$ 并计算稳定的时间步长 $\\Delta t$。\n5.  初始化电流密度数组 $J_i = 0$ 对所有 $i$ 成立。\n6.  设置并固定边界值 $J_{N-1} = E_0 / \\eta_{N-1}$。\n7.  在时间步上从 $t=0$ 循环到 $t=t_{\\mathrm{end}}$：\n    a. 计算当前时间步的数组 $U_i = \\eta_i J_i$。注意 $U_{N-1} = E_0$。\n    b. 对每个内部网格点 $i=0, \\dots, N-2$，使用上面推导的离散方程计算电流密度的变化。\n    c. 使用向前欧拉步更新电流密度数组 $J^{n+1}$。保持 $J_{N-1}$ 固定。\n8.  在最后一个时间步之后，$J_0$ 的值即为中心电流密度 $J(0, t_{\\mathrm{end}})$。\n对三个测试案例中的每一个都重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the current diffusion equation in a cylindrical plasma\n    for three different electron temperature profiles.\n    \"\"\"\n    \n    # --- Physical and Numerical Constants ---\n    MU_0 = 4 * np.pi * 1e-7  # Vacuum permeability (H/m)\n    C_SPITZER = 5.2e-5       # Spitzer resistivity constant (Ohm.m.eV^3/2)\n    SAFETY_FACTOR = 0.4      # Safety factor for time step calculation\n    \n    # --- Common Parameters for all Test Cases ---\n    a = 1.0                  # Minor radius (m)\n    Z_eff = 1.5              # Effective ion charge\n    ln_Lambda = 17.0         # Coulomb logarithm\n    E_0 = 0.02               # Edge electric field (V/m)\n    t_end = 0.01             # End time of simulation (s)\n    N = 400                  # Number of radial grid points\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        {\n            \"name\": \"Peaked Temperature\",\n            \"T_core\": 3000.0, \"T_edge\": 150.0, \"alpha\": 2.0,\n            \"profile_type\": \"peaked\"\n        },\n        {\n            \"name\": \"Uniform Temperature\",\n            \"T_const\": 1000.0,\n            \"profile_type\": \"uniform\"\n        },\n        {\n            \"name\": \"Hollow Temperature\",\n            \"T_core\": 800.0, \"T_edge\": 2000.0, \"beta\": 2.0,\n            \"profile_type\": \"hollow\"\n        }\n    ]\n\n    results = []\n\n    def run_simulation(case_params):\n        \"\"\"\n        Runs a single simulation for a given set of parameters.\n        \"\"\"\n        # 1. Setup Grid and Profiles\n        r = np.linspace(0, a, N)\n        dr = a / (N - 1)\n        r_half = r[:-1] + dr / 2 # Cell interfaces for flux calculation\n\n        # Calculate Te(r) profile\n        if case_params[\"profile_type\"] == \"peaked\":\n            T_core, T_edge, alpha = case_params[\"T_core\"], case_params[\"T_edge\"], case_params[\"alpha\"]\n            Te = T_edge + (T_core - T_edge) * (1 - (r / a)**2)**alpha\n        elif case_params[\"profile_type\"] == \"uniform\":\n            T_const = case_params[\"T_const\"]\n            Te = np.full(N, T_const)\n        elif case_params[\"profile_type\"] == \"hollow\":\n            T_core, T_edge, beta = case_params[\"T_core\"], case_params[\"T_edge\"], case_params[\"beta\"]\n            Te = T_core + (T_edge - T_core) * (r / a)**beta\n\n        # Calculate resistivity profile eta(r)\n        # Add a small epsilon to Te to avoid division by zero if Te(r) could be 0\n        eta = C_SPITZER * Z_eff * ln_Lambda * (Te + 1e-9)**(-1.5)\n\n        # 2. Time Step Calculation\n        eta_max = np.max(eta)\n        dt = SAFETY_FACTOR * MU_0 * dr**2 / eta_max\n        num_steps = int(t_end / dt)\n\n        # 3. Initialization\n        J = np.zeros(N)  # J(r, 0) = 0\n        \n        # 4. Boundary Condition at r = a\n        J[N - 1] = E_0 / eta[N - 1]\n\n        # 5. Time Marching Loop\n        for _ in range(num_steps):\n            J_new = np.copy(J)\n            \n            # U = eta * J : This is proportional to the electric field E\n            U = eta * J\n            U[N - 1] = E_0 # E(a,t) is fixed\n            \n            # --- Update center point (i=0) ---\n            # dJ/dt = (4 / (mu0 * dr^2)) * (U1 - U0)\n            dJ_dt_0 = (4.0 / (MU_0 * dr**2)) * (U[1] - U[0])\n            J_new[0] = J[0] + dt * dJ_dt_0\n            \n            # --- Update interior points (i=1 to N-2) ---\n            # dJ/dt = (1/(mu0*r_i*dr^2)) * [ r_{i+1/2}(U_{i+1}-U_i) - r_{i-1/2}(U_i-U_{i-1}) ]\n            # Using vectorized operations for efficiency\n            i = np.arange(1, N - 1)\n            \n            # For i=1..N-2, r[i] is never zero.\n            term1 = r_half[i] * (U[i + 1] - U[i])\n            term2 = r_half[i - 1] * (U[i] - U[i - 1])\n            \n            dJ_dt_i = (1.0 / (MU_0 * r[i] * dr**2)) * (term1 - term2)\n            J_new[i] = J[i] + dt * dJ_dt_i\n\n            # Boundary value J[N-1] is already fixed and does not change\n            J = J_new\n\n        return J[0]\n\n    for case in test_cases:\n        result = run_simulation(case)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "现在我们将注意力从欧姆加热转向射频（RF）加热。一个关键区别是，射频功率由波携带，这些波必须从等离子体边缘传播到芯部的特定共振层。本练习探讨了电子回旋（EC）加热中的一个关键问题：当边缘等离子体密度超过波的截止密度时，会形成一个波无法传播的渐消区。您将构建一个计算模型来计算波穿过这个渐消势垒的透射率，从而量化边缘等离子体条件如何显著影响芯部加热的有效性 。",
            "id": "4024595",
            "problem": "一束频率为 $f$ 的平面电磁波（普通模，O-mode）从真空入射到磁化聚变等离子体中。等离子体边界区域存在一个台基，其输运过程可能使电子密度 $n_e$ 升高到超过O模截止密度，从而阻碍射频（RF）波的可及性。考虑一个简化的、计算上易于处理的模型，该模型能捕捉O模可及性和电子回旋（EC）能量沉积的基本物理过程：\n\n基本原理：\n- 在冷、无碰撞等离子体中，麦克斯韦方程组导出了O模的色散关系，其折射率 $n$ 由 $n^2 = 1 - \\omega_{pe}^2 / \\omega^2$ 描述，其中 $\\omega = 2\\pi f$ 且 $\\omega_{pe} = \\sqrt{n_e e^2 / (m_e \\epsilon_0)}$ 是电子等离子体频率。当 $\\omega \\le \\omega_{pe}$ 时，即等效于 $n^2 \\le 0$ 时，发生O模截止，产生倏逝和反射。\n- 沿射线路径坐标 $s$ 的吸收功率 $P(s)$ 的辐射转移遵循 $\\frac{dP}{ds} = -\\alpha(s) P(s)$，从而得到单程吸收分数 $F = 1 - \\exp\\left(-\\int \\alpha(s)\\, ds\\right)$。\n\n计算的模型假设：\n1. 台基被视为一个厚度为 $L$ 的平板，当 $n_{e,\\text{top}}  n_{\\text{cut}}$ 时，其顶部密度 $n_{e,\\text{top}}$ 在整个倏逝区内是均匀的，其中 $n_{\\text{cut}} = \\frac{m_e \\epsilon_0 \\omega^2}{e^2}$。如果 $n_{e,\\text{top}} \\le n_{\\text{cut}}$，则O模可以穿过边界区（沿边界路径各处 $n^2  0$），不存在倏逝垒。\n2. 相对于平板法线的入射角为 $\\theta$（以弧度为单位），因此穿过势垒的有效路径长度为 $L_{\\text{eff}} = \\frac{L}{\\cos \\theta}$。\n3. 在倏逝区，局域波数为虚数 $k = i k_i$，其中 $k_i = \\frac{\\omega}{c} \\sqrt{\\frac{\\omega_{pe}^2}{\\omega^2} - 1} = \\frac{\\omega}{c} \\sqrt{\\frac{n_{e,\\text{top}}}{n_{\\text{cut}}} - 1}$，穿过矩形势垒的WKB透射因子为 $T = \\exp\\left(-2 k_i L_{\\text{eff}}\\right)$。如果 $n_{e,\\text{top}} \\le n_{\\text{cut}}$，则设 $T = 1$。\n4. 芯部的EC吸收由一个吸收系数剖面 $\\alpha(s)$ 建模，该剖面局域在回旋共振层附近，近似为一个峰值为 $\\alpha_0$、宽度为 $\\sigma$ 的高斯分布，因此光学厚度为 $\\tau = \\int \\alpha(s)\\, ds \\approx \\alpha_0 \\sqrt{2\\pi}\\, \\sigma$。一个具有物理动机的标度关系是 $\\alpha_0 = K\\, n_{e,\\text{core}}$，其中 $K$ 是一个常数，$n_{e,\\text{core}}$ 是芯部电子密度。在没有势垒的情况下，单程芯部吸收分数为 $F_0 = 1 - e^{-\\tau}$。存在势垒时，可及功率被 $T$ 削减，因此芯部吸收分数变为 $F_1 = T\\, F_0$。\n5. 每个测试用例需要计算的量是，由于台基密度可能升高到O模截止密度以上而引起的芯部EC能量沉积分数的变化，定义为 $\\Delta F = F_1 - F_0$，此量无量纲。\n\n使用的常数：\n- 基本电荷 $e$（单位 $\\mathrm{C}$），电子质量 $m_e$（单位 $\\mathrm{kg}$），真空介电常数 $\\epsilon_0$（单位 $\\mathrm{F/m}$），以及光速 $c$（单位 $\\mathrm{m/s}$）。\n\n单位和角度说明：\n- 频率 $f$（单位 $\\mathrm{Hz}$）。\n- 密度 $n_{e,\\text{edge}}$、$n_{e,\\text{top}}$ 和 $n_{e,\\text{core}}$（单位 $\\mathrm{m^{-3}}$）。\n- 厚度 $L$ 和宽度 $\\sigma$（单位 $\\mathrm{m}$）。\n- 角度 $\\theta$（单位 弧度）。\n- 输出量 $\\Delta F$ 是无量纲的。\n\n测试套件：\n为以下参数集计算 $\\Delta F$。对所有情况，使用常数 $K = 1.0 \\times 10^{-18}\\ \\mathrm{m^2}$ 和 $\\sigma = 2.0 \\times 10^{-2}\\ \\mathrm{m}$，以及 $n_{e,\\text{core}} = 7.0 \\times 10^{19}\\ \\mathrm{m^{-3}}$。\n- 情况 1（基准可及）：$f = 1.70 \\times 10^{11}$, $n_{e,\\text{edge}} = 5.0 \\times 10^{19}$, $n_{e,\\text{top}} = 3.0 \\times 10^{20}$, $L = 3.0 \\times 10^{-2}$, $\\theta = 0.0$。\n- 情况 2（略高于截止密度的薄势垒）：$f = 1.70 \\times 10^{11}$, $n_{e,\\text{edge}} = 5.0 \\times 10^{19}$, $n_{e,\\text{top}} = 4.0 \\times 10^{20}$, $L = 1.0 \\times 10^{-3}$, $\\theta = 0.0$。\n- 情况 3（高于截止密度的典型势垒）：$f = 1.70 \\times 10^{11}$, $n_{e,\\text{edge}} = 5.0 \\times 10^{19}$, $n_{e,\\text{top}} = 4.0 \\times 10^{20}$, $L = 3.0 \\times 10^{-2}$, $\\theta = 0.0$。\n- 情况 4（掠射增加了路径长度）：$f = 1.70 \\times 10^{11}$, $n_{e,\\text{edge}} = 5.0 \\times 10^{19}$, $n_{e,\\text{top}} = 4.0 \\times 10^{20}$, $L = 1.0 \\times 10^{-3}$, $\\theta = 1.396263402$。\n- 情况 5（处于截止密度）：$f = 1.70 \\times 10^{11}$, $n_{e,\\text{edge}} = 5.0 \\times 10^{19}$, $n_{e,\\text{top}} = n_{\\text{cut}}$, $L = 3.0 \\times 10^{-2}$, $\\theta = 0.0$。在实现中，将 $n_{e,\\text{top}}$ 设置为根据给定 $f$ 计算出的 $n_{\\text{cut}}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如， $[$result$_1$,result$_2$,result$_3$,result$_4$,result$_5]$）。每个结果必须是一个浮点数，给出相应情况的 $\\Delta F$ 值，并按指定顺序排列。",
            "solution": "该问题已经过验证，被确定为一个适定且具有科学依据的等离子体物理问题。所有必要的参数和一个完整的物理模型均已提供，从而可以得到唯一且有意义的解。注意到测试套件中存在变量 $n_{e,\\text{edge}}$，但在所提供的模型方程中并未使用，该信息被视为无关信息，不影响计算。我们开始求解。\n\n目标是计算入射到磁化等离子体中的平面电磁波（普通模，O-mode）的芯部电子回旋（EC）功率吸收分数的变化量，记为 $\\Delta F$。这种变化源于等离子体边界处可能存在的倏逝垒。该问题提供了一个基于基本等离子体波理论的简化计算模型。\n\n计算过程首先确定在所有测试用例中保持不变的量，然后根据具体参数对每个用例进行逐一评估。\n\n首先，我们定义必要的物理常数：\n- 基本电荷：$e \\approx 1.602176634 \\times 10^{-19} \\, \\mathrm{C}$\n- 电子质量：$m_e \\approx 9.1093837 \\times 10^{-31} \\, \\mathrm{kg}$\n- 真空介电常数：$\\epsilon_0 \\approx 8.8541878128 \\times 10^{-12} \\, \\mathrm{F/m}$\n- 真空中的光速：$c = 299792458 \\, \\mathrm{m/s}$\n\n计算步骤如下：\n\n1.  **计算O模截止密度 ($n_{\\text{cut}}$)**：当波频率 $\\omega$ 等于电子等离子体频率 $\\omega_{pe}$ 时，发生O模截止。截止密度 $n_{\\text{cut}}$ 是满足此条件的电子密度。它由 $\\omega = \\omega_{pe} = \\sqrt{n_e e^2 / (m_e \\epsilon_0)}$ 推导得出。\n    角频率为 $\\omega = 2\\pi f$。对于给定的频率 $f = 1.70 \\times 10^{11} \\, \\mathrm{Hz}$：\n    $$ \\omega = 2\\pi (1.70 \\times 10^{11} \\, \\mathrm{Hz}) \\approx 1.06814 \\times 10^{12} \\, \\mathrm{rad/s} $$\n    那么截止密度为：\n    $$ n_{\\text{cut}} = \\frac{m_e \\epsilon_0 \\omega^2}{e^2} = \\frac{m_e \\epsilon_0 (2\\pi f)^2}{e^2} $$\n    代入常数和频率的值，我们得到：\n    $$ n_{\\text{cut}} \\approx 3.5743 \\times 10^{20} \\, \\mathrm{m^{-3}} $$\n    由于频率 $f$ 是固定的，因此该值对所有测试用例都是恒定的。\n\n2.  **计算基准吸收分数 ($F_0$)**: 波在芯部等离子体中的吸收由光学厚度 $\\tau$ 表征。问题陈述 $\\tau \\approx \\alpha_0 \\sqrt{2\\pi}\\, \\sigma$，其中峰值吸收系数由标度关系 $\\alpha_0 = K\\, n_{e,\\text{core}}$ 给出。值 $K = 1.0 \\times 10^{-18} \\, \\mathrm{m^2}$、$\\sigma = 2.0 \\times 10^{-2} \\, \\mathrm{m}$ 和 $n_{e,\\text{core}} = 7.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$ 对所有情况都是常数。\n    $$ \\tau = (1.0 \\times 10^{-18} \\, \\mathrm{m^2})(7.0 \\times 10^{19} \\, \\mathrm{m^{-3}}) \\sqrt{2\\pi} (2.0 \\times 10^{-2} \\, \\mathrm{m}) \\approx 3.5089 $$\n    基准单程吸收分数 $F_0$ 代表在没有边界势垒的情况下的吸收，由辐射转移定律给出：\n    $$ F_0 = 1 - e^{-\\tau} = 1 - e^{-3.5089} \\approx 0.97009 $$\n    该值对所有测试用例也都是恒定的。\n\n3.  **对每个案例评估透射因子 ($T$) 和 $\\Delta F$**：吸收分数的变化量为 $\\Delta F = F_1 - F_0$，其中 $F_1 = T F_0$ 是存在势垒时的吸收分数。这可以简化为：\n    $$ \\Delta F = T F_0 - F_0 = F_0(T - 1) $$\n    透射因子 $T$ 取决于台基密度 $n_{e,\\text{top}}$ 相对于 $n_{\\text{cut}}$ 的大小。\n\n    - 如果 $n_{e,\\text{top}} \\le n_{\\text{cut}}$，波是完全可及的。没有倏逝垒，透射因子 $T=1$。在这种情况下，$\\Delta F = F_0(1 - 1) = 0$。\n\n    - 如果 $n_{e,\\text{top}} > n_{\\text{cut}}$，则存在倏逝区。对于矩形势垒，WKB透射因子为 $T = \\exp(-2 k_i L_{\\text{eff}})$。\n      - 波数的虚部为 $k_i = \\frac{\\omega}{c} \\sqrt{\\frac{n_{e,\\text{top}}}{n_{\\text{cut}}} - 1}$。\n      - 在入射角为 $\\theta$ 时，穿过厚度为 $L$ 的势垒的有效路径长度为 $L_{\\text{eff}} = \\frac{L}{\\cos \\theta}$。\n\n现在我们将此过程应用于每个测试用例：\n\n- **情况 1**：$n_{e,\\text{top}} = 3.0 \\times 10^{20} \\, \\mathrm{m^{-3}}$。\n  此处，$n_{e,\\text{top}}  n_{\\text{cut}}$ ($3.0 \\times 10^{20}  3.5743 \\times 10^{20}$)。波是可及的。\n  $T = 1$。\n  $\\Delta F = F_0(1-1) = 0$。\n\n- **情况 2**：$n_{e,\\text{top}} = 4.0 \\times 10^{20} \\, \\mathrm{m^{-3}}$，$L = 1.0 \\times 10^{-3} \\, \\mathrm{m}$，$\\theta = 0.0 \\, \\mathrm{rad}$。\n  此处，$n_{e,\\text{top}} > n_{\\text{cut}}$。\n  $k_i = \\frac{1.06814 \\times 10^{12}}{2.9979 \\times 10^8} \\sqrt{\\frac{4.0 \\times 10^{20}}{3.5743 \\times 10^{20}} - 1} \\approx 1229.58 \\, \\mathrm{m^{-1}}$。\n  $L_{\\text{eff}} = \\frac{1.0 \\times 10^{-3}}{\\cos(0)} = 1.0 \\times 10^{-3} \\, \\mathrm{m}$。\n  $T = \\exp(-2 \\times 1229.58 \\times 1.0 \\times 10^{-3}) = \\exp(-2.459) \\approx 0.0855$。\n  $\\Delta F = 0.97009 \\times (0.0855 - 1) \\approx -0.8872$。\n\n- **情况 3**：$n_{e,\\text{top}} = 4.0 \\times 10^{20} \\, \\mathrm{m^{-3}}$，$L = 3.0 \\times 10^{-2} \\, \\mathrm{m}$，$\\theta = 0.0 \\, \\mathrm{rad}$。\n  此处，$n_{e,\\text{top}} > n_{\\text{cut}}$。$k_i$ 与情况 2 中相同。\n  $L_{\\text{eff}} = \\frac{3.0 \\times 10^{-2}}{\\cos(0)} = 3.0 \\times 10^{-2} \\, \\mathrm{m}$。\n  $T = \\exp(-2 \\times 1229.58 \\times 3.0 \\times 10^{-2}) = \\exp(-73.77) \\approx 0$。\n  $\\Delta F = 0.97009 \\times (0 - 1) = -0.97009$。\n\n- **情况 4**：$n_{e,\\text{top}} = 4.0 \\times 10^{20} \\, \\mathrm{m^{-3}}$，$L = 1.0 \\times 10^{-3} \\, \\mathrm{m}$，$\\theta = 1.396263402 \\, \\mathrm{rad}$。\n  此处，$n_{e,\\text{top}} > n_{\\text{cut}}$。$k_i$ 与情况 2 中相同。\n  $L_{\\text{eff}} = \\frac{1.0 \\times 10^{-3}}{\\cos(1.396263402)} \\approx \\frac{1.0 \\times 10^{-3}}{0.173648} \\approx 5.7588 \\times 10^{-3} \\, \\mathrm{m}$。\n  $T = \\exp(-2 \\times 1229.58 \\times 5.7588 \\times 10^{-3}) = \\exp(-14.16) \\approx 7.086 \\times 10^{-7}$。\n  $\\Delta F = 0.97009 \\times (7.086 \\times 10^{-7} - 1) \\approx -0.97009$。透射可以忽略不计。\n\n- **情况 5**：$n_{e,\\text{top}} = n_{\\text{cut}}$。\n  条件是 $n_{e,\\text{top}} \\le n_{\\text{cut}}$，在边界处满足。模型指定设置 $T=1$。\n  $T = 1$。\n  $\\Delta F = F_0(1 - 1) = 0$。这在物理上是一致的，因为当 $n_{e,\\text{top}} \\to n_{\\text{cut}}^{+}$ 时，虚波数 $k_i$ 趋近于 $0$，所以 $T \\to 1$。\n\n这些计算将在提供的代码结构中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the plasma wave accessibility problem based on the provided model.\n    \"\"\"\n    # Define physical constants with high precision\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in kg\n    EPS_0 = 8.8541878128e-12    # Vacuum permittivity in F/m\n    C_LIGHT = 299792458.0        # Speed of light in m/s\n\n    # Define problem-specific constants\n    K_CONST = 1.0e-18           # Absorption scaling constant in m^2\n    SIGMA = 2.0e-2              # Absorption profile width in m\n    N_E_CORE = 7.0e19           # Core electron density in m^-3\n\n    # Test cases from the problem statement\n    # Format: (f in Hz, n_e_top in m^-3, L in m, theta in radians)\n    # The n_e_edge value is provided but not used in the model, so it is omitted here.\n    test_cases = [\n        (1.70e11, 3.0e20, 3.0e-2, 0.0),\n        (1.70e11, 4.0e20, 1.0e-3, 0.0),\n        (1.70e11, 4.0e20, 3.0e-2, 0.0),\n        (1.70e11, 4.0e20, 1.0e-3, 1.396263402),\n        (1.70e11, \"n_cut\", 3.0e-2, 0.0) # Special case identifier for n_e_top = n_cut\n    ]\n\n    results = []\n\n    # --- Pre-calculate constant values ---\n    # Since frequency f is the same for all cases, omega and n_cut are constant.\n    f_const = test_cases[0][0]\n    omega = 2 * np.pi * f_const\n    n_cut = (M_ELECTRON * EPS_0 * omega**2) / E_CHARGE**2\n\n    # Since K, n_e_core, and sigma are constant, tau and F0 are also constant.\n    tau = K_CONST * N_E_CORE * np.sqrt(2 * np.pi) * SIGMA\n    f0 = 1.0 - np.exp(-tau)\n\n    for case in test_cases:\n        f, n_e_top_param, L, theta = case\n\n        # Handle the special case where n_e_top is set to n_cut\n        if isinstance(n_e_top_param, str) and n_e_top_param == \"n_cut\":\n            n_e_top = n_cut\n        else:\n            n_e_top = n_e_top_param\n\n        # --- Main logic to calculate the result for one case ---\n\n        # The model specifies T=1 if n_e_top is not strictly greater than n_cut\n        if n_e_top = n_cut:\n            T = 1.0\n        else: # n_e_top > n_cut, evanescent barrier exists\n            # Calculate imaginary wavenumber k_i\n            k_i = (omega / C_LIGHT) * np.sqrt(n_e_top / n_cut - 1.0)\n            \n            # Calculate effective path length L_eff\n            # Handle potential division by zero for theta = pi/2, though not in test cases\n            cos_theta = np.cos(theta)\n            if cos_theta == 0: # Physical path length must be positive\n                 # For grazing incidence at 90 deg, L_eff is infinite, T is 0\n                 T = 0.0\n            else:\n                L_eff = L / cos_theta\n                # Calculate transmission factor T\n                exponent = -2.0 * k_i * L_eff\n                T = np.exp(exponent)\n\n        # Calculate the change in absorption fraction\n        delta_f = f0 * (T - 1.0)\n        results.append(delta_f)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}