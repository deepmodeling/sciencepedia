{
    "hands_on_practices": [
        {
            "introduction": "碰撞输运模型的准确性通常取决于库仑对数，而该对数需要一个最小碰撞参数 $b_{\\min}$ 的截断。本练习深入探讨了决定该截断的基本物理机制，通过比较大角度散射的经典图像与量子力学的德布罗意波长 。通过计算这两种效应相当的能量阈值，您将更深刻地理解经典碰撞理论的适用范围。",
            "id": "4045187",
            "problem": "在磁约束的氘-氚等离子体中，快阿尔法粒子的慢化过程由小角度库仑碰撞主导。在动理学处理中，二元碰撞的库仑对数在小尺度上通过一个最小碰撞参数进行正则化。两种竞争的物理机制设定了这个下限截断：经典最近距离和量子衍射。对于一个速度为 $v$ 的阿尔法粒子与背景电子发生弹性碰撞，考虑其相对运动，其中约化质量为 $m_{r}$，背景电荷数（绝对值）为 $Z_{2}$，与阿尔法粒子电荷数 $Z_{1}=2$ 相互作用。\n\n- 从库仑散射和波粒二象性的第一性原理出发，使用卢瑟福散射中近似直角偏转的准则，写出经典小尺度截断 $b_{\\mathrm{c}}(v)$；并使用相对运动的德布罗意波长，写出量子衍射截断 $b_{\\mathrm{q}}(v)$。\n- 通过求解 $b_{\\mathrm{c}}(v_{\\ast})=b_{\\mathrm{q}}(v_{\\ast})$，确定使两个截断相等的阈值速度 $v_{\\ast}$。\n- 特别考虑电子靶（$Z_{2}=1$）的情况，并找出相应的阿尔法粒子动能阈值 $E_{\\ast}=\\frac{1}{2}m_{\\alpha}v_{\\ast}^{2}$。当能量高于此阈值时，量子衍射效应决定了最小碰撞参数。\n- 将 $E_{\\ast}$ 的最终答案以千电子伏特 (keV) 为单位表示，并四舍五入到四位有效数字。\n\n根据需要使用以下基本常数：精细结构常数 $\\alpha=\\frac{e^{2}}{4\\pi\\varepsilon_{0}\\hbar c}=7.2973525693\\times 10^{-3}$，以及阿尔法粒子静止能量 $m_{\\alpha}c^{2}=3727.379378~\\mathrm{MeV}$。假设在阈值处为非相对论性运动学，并且相对速度由阿尔法粒子的速度决定（即，在你确定的阈值 $v_{\\ast}$ 处，电子的热速度与之相比可以忽略不计）。",
            "solution": "问题陈述被认为是有效的。它具有科学依据、内部一致且适定，允许基于经典力学和量子力学的基本原理得出一个唯一且有意义的解。所提供的假设虽然是对真实等离子体环境的简化，但其陈述清晰，并允许对核心物理问题进行集中分析。\n\n我们首先推导库仑碰撞中最小碰撞参数的两个竞争截断的表达式。问题考虑一个阿尔法粒子（电荷 $Z_1 e$，质量 $m_{\\alpha}$）与一个背景电子（电荷 $-Z_2 e$，其中 $Z_2=1$，质量 $m_e$）碰撞。相互作用在双粒子系统的质心系中进行分析，该系统以约化质量 $m_r$ 和相对速度 $v$ 为特征。问题指明相对速度约等于阿尔法粒子的速度 $v$。\n\n首先，我们确定经典截断 $b_{\\mathrm{c}}(v)$。它被定义为导致大角度散射的碰撞参数，通常取偏转角为 $\\theta = \\frac{\\pi}{2}$ 弧度（$90^{\\circ}$）。根据卢瑟福散射公式，碰撞参数 $b$、质心散射角 $\\theta$ 和相对运动动能 $E_{r}$ 之间的关系是：\n$$ \\tan\\left(\\frac{\\theta}{2}\\right) = \\frac{Z_1 Z_2 e^2}{4\\pi\\varepsilon_0} \\frac{1}{2 E_{r} b} $$\n相对动能为 $E_{r} = \\frac{1}{2}m_{r}v^2$。对于 $90^{\\circ}$ 偏转，$\\theta = \\frac{\\pi}{2}$，且 $\\tan(\\frac{\\pi}{4}) = 1$。将这些值代入公式，得到经典截断 $b_{\\mathrm{c}}(v)$：\n$$ 1 = \\frac{Z_1 Z_2 e^2}{4\\pi\\varepsilon_0} \\frac{1}{2 \\left(\\frac{1}{2}m_{r}v^2\\right) b_{\\mathrm{c}}(v)} = \\frac{Z_1 Z_2 e^2}{4\\pi\\varepsilon_0 m_{r}v^2 b_{\\mathrm{c}}(v)} $$\n解出 $b_{\\mathrm{c}}(v)$：\n$$ b_{\\mathrm{c}}(v) = \\frac{Z_1 Z_2 e^2}{4\\pi\\varepsilon_0 m_{r} v^2} $$\n\n其次，我们确定量子衍射截断 $b_{\\mathrm{q}}(v)$。该截断由粒子的波动性决定。当碰撞参数小于相对运动的德布罗意波长时，由于不确定性原理，经典轨道概念失效。相关的长度尺度是与相对动量 $p_r = m_r v$ 相关的约化德布罗意波长 $\\bar{\\lambda}_r$。\n$$ b_{\\mathrm{q}}(v) = \\bar{\\lambda}_r = \\frac{\\hbar}{p_r} = \\frac{\\hbar}{m_r v} $$\n\n阈值速度 $v_{\\ast}$ 是使这两个截断相等的速度，即 $b_{\\mathrm{c}}(v_{\\ast}) = b_{\\mathrm{q}}(v_{\\ast})$。\n$$ \\frac{Z_1 Z_2 e^2}{4\\pi\\varepsilon_0 m_{r} v_{\\ast}^2} = \\frac{\\hbar}{m_r v_{\\ast}} $$\n我们可以从两边消去因子 $m_r v_{\\ast}$（因为 $m_r \\neq 0$ 且 $v_{\\ast} \\neq 0$）。值得注意的是，约化质量 $m_r$ 完全消去，这意味着阈值速度与粒子质量无关。\n$$ \\frac{Z_1 Z_2 e^2}{4\\pi\\varepsilon_0 v_{\\ast}} = \\hbar $$\n解出 $v_{\\ast}$：\n$$ v_{\\ast} = \\frac{Z_1 Z_2 e^2}{4\\pi\\varepsilon_0 \\hbar} $$\n这个表达式可以使用精细结构常数 $\\alpha = \\frac{e^2}{4\\pi\\varepsilon_0 \\hbar c}$ 巧妙地重写。\n$$ v_{\\ast} = Z_1 Z_2 \\left(\\frac{e^2}{4\\pi\\varepsilon_0 \\hbar c}\\right) c = Z_1 Z_2 \\alpha c $$\n\n问题要求计算在此阈值速度下阿尔法粒子的动能 $E_{\\ast}$。对于非相对论性速度，动能由 $E = \\frac{1}{2}m_{\\alpha}v^2$ 给出。\n$$ E_{\\ast} = \\frac{1}{2}m_{\\alpha}v_{\\ast}^2 = \\frac{1}{2}m_{\\alpha} (Z_1 Z_2 \\alpha c)^2 $$\n我们可以用阿尔法粒子的静止能量 $m_{\\alpha}c^2$ 来重新整理这个表达式：\n$$ E_{\\ast} = \\frac{1}{2} (Z_1 Z_2)^2 \\alpha^2 (m_{\\alpha}c^2) $$\n\n现在，我们专门考虑给定的碰撞粒子：一个阿尔法粒子（$Z_1=2$）和一个电子（$Z_2=1$）。\n$$ E_{\\ast} = \\frac{1}{2} (2 \\times 1)^2 \\alpha^2 (m_{\\alpha}c^2) = \\frac{1}{2} (4) \\alpha^2 (m_{\\alpha}c^2) = 2 \\alpha^2 (m_{\\alpha}c^2) $$\n对于阿尔法粒子能量 $E > E_{\\ast}$ 的情况，量子衍射效应占主导地位，因为更高的能量（因此更高的速度）使得经典最近距离 $b_c \\propto 1/v^2$ 的减小速度快于量子波长 $b_q \\propto 1/v$ 的减小速度。\n\n最后，我们代入所给的数值，以千电子伏特 (keV) 为单位计算 $E_{\\ast}$。\n已知：\n$m_{\\alpha}c^2 = 3727.379378~\\mathrm{MeV} = 3727379.378~\\mathrm{keV}$\n$\\alpha = 7.2973525693 \\times 10^{-3}$\n\n首先，我们计算 $\\alpha^2$：\n$$ \\alpha^2 = (7.2973525693 \\times 10^{-3})^2 \\approx 5.32513556 \\times 10^{-5} $$\n现在，我们计算 $E_{\\ast}$：\n$$ E_{\\ast} = 2 \\times (5.32513556 \\times 10^{-5}) \\times (3727379.378~\\mathrm{keV}) $$\n$$ E_{\\ast} \\approx (1.06502711 \\times 10^{-4}) \\times (3727379.378~\\mathrm{keV}) $$\n$$ E_{\\ast} \\approx 396.99641~\\mathrm{keV} $$\n按要求四舍五入到四位有效数字，得到：\n$$ E_{\\ast} \\approx 397.0~\\mathrm{keV} $$\n非相对论性假设是合理的，因为 $v_{\\ast} = 2 \\alpha c \\approx 0.0146 c$，远小于光速。",
            "answer": "$$\n\\boxed{397.0}\n$$"
        },
        {
            "introduction": "从单次碰撞的微观物理学过渡到粒子分布的宏观演化，需要求解一个动理学方程。本动手编程实践要求您构建一个数值求解器，用于求解描述经典慢化过程的简化福克-普朗克方程 。您将通过与已知的解析解进行基准比较来验证您的代码，这是计算科学中一个基本的验证步骤。",
            "id": "4045191",
            "problem": "考虑一个各向同性的快离子布居，它们以单能速率 $v_0$ 注入到均匀等离子体中。令 $f(v,t)$ 表示各向同性速度分布函数，其中 $v$ 是粒子速率。定义速率空间密度 $n(v,t) = 4\\pi v^2 f(v,t)$，因此粒子数密度为 $\\int_0^\\infty n(v,t)\\,\\mathrm{d}v$。忽略速度空间扩散和投掷角散射，并假设存在经典的库仑减速阻力。$n(v,t)$ 的时间演化由速率空间中的一维守恒律控制\n$$\n\\frac{\\partial n(v,t)}{\\partial t} + \\frac{\\partial}{\\partial v}\\Big(A(v)\\,n(v,t)\\Big) = S(v),\n$$\n其中 $A(v) = \\frac{\\mathrm{d}v}{\\mathrm{d}t}$ 是速率空间漂移（阻力），$S(v)$ 是单位速率的各向同性源密度。在经典临界速率模型中，取\n$$\nA(v) = -\\Gamma\\,\\frac{v^3 + v_c^3}{v^2},\n$$\n其中 $\\Gamma>0$ 是一个单位为 $\\mathrm{s}^{-1}$ 的常数，$v_c>0$ 是临界速率（单位为 $\\mathrm{m/s}$），它编码了从电子主导减速到离子主导减速的转变。单能各向同性源表示为\n$$\nS(v) = S_0\\,\\delta(v - v_0),\n$$\n其中 $S_0$ 是单位体积、单位时间的注入率，单位为 $\\mathrm{m}^{-3}\\mathrm{s}^{-1}$，$\\delta(\\cdot)$ 是狄拉克δ函数。假设在速率下限截止 $v_{\\min}>0$ 处为吸收边界，代表热化；并在上边界 $v_{\\max}$ 处为零流入，计算域为 $v\\in[v_{\\min},v_{\\max}]$。\n\n您的任务是设计并实现一个上述守恒律的数值求解器，以获得稳态解 $f(v)$，并将其与从相同模型推导出的解析稳态经典减速分布进行基准测试。具体而言：\n\n1. 从守恒律以及给定的 $A(v)$ 和 $S(v)$ 出发，使用第一性原理推导解析稳态解 $f(v)$。不要假设或引用任何目标公式；从基本方程出发进行逻辑推导。\n\n2. 在具有 $N$ 个单元的均匀网格上，实现一个有限体积、一阶迎风格式，在速率空间中对瞬态方程进行积分，直至达到稳态。使用以下边界条件：\n   - 在 $v=v_{\\min}$ 处：吸收性流出（无来自 $v  v_{\\min}$ 的流入）。\n   - 在 $v=v_{\\max}$ 处：零流入。\n\n3. 将您的数值稳态解与解析解进行比较，计算给定测试用例（在解答代码中定义）在 $v \\le v_0$ 区域的均方根相对误差（RMSE）和最大相对误差（$E_{\\infty}$）。您的程序应返回一个包含四个 `[RMSE, E_infinity]` 对的列表。",
            "solution": "用户提供了一个来自计算聚变科学的问题，涉及等离子体中快离子的减速过程。任务是推导快离子分布函数的解析稳态解，为瞬态控制方程实现一个数值求解器，并将数值稳态结果与解析解进行基准测试。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n- **控制方程：** 速率空间密度 $n(v,t)$ 的时间演化由守恒律给出：\n$$\n\\frac{\\partial n(v,t)}{\\partial t} + \\frac{\\partial}{\\partial v}\\Big(A(v)\\,n(v,t)\\Big) = S(v)\n$$\n- **分布函数：** 速率空间密度 $n(v,t)$ 与各向同性速度分布函数 $f(v,t)$ 的关系为 $n(v,t) = 4\\pi v^2 f(v,t)$。\n- **速率空间漂移（阻力）：** 阻力项由经典临界速率模型给出：\n$$\nA(v) = -\\Gamma\\,\\frac{v^3 + v_c^3}{v^2}\n$$\n其中常数 $\\Gamma  0$ 和 $v_c  0$。\n- **源项：** 单能各向同性源由以下公式给出：\n$$\nS(v) = S_0\\,\\delta(v - v_0)\n$$\n其中 $S_0$ 是注入率。\n- **计算域：** $v \\in [v_{\\min}, v_{\\max}]$，其中 $v_{\\min}  0$。\n- **边界条件：** 在 $v=v_{\\min}$ 处为吸收性流出，在 $v=v_{\\max}$ 处为零流入。\n- **数值格式：** 在具有 $N$ 个单元的均匀网格上采用一阶迎风有限体积法。\n- **源离散化：** 源项被离散化为 $S_i = S_0/\\Delta v$，其中 $i$ 是包含 $v_0$ 的单个单元，其他地方 $S_i=0$，$\\Delta v$ 是网格间距。\n- **时间步进：** 显式时间积分，步长 $\\Delta t$ 满足CFL条件 $\\Delta t \\le \\mathrm{CFL}\\cdot \\Delta v / \\max_v |A(v)|$，其中 $\\mathrm{CFL} \\le 1$。\n- **模拟时长：** 积分进行至平流渡越时间 $\\tau = \\int_{v_{\\min}}^{v_0}\\mathrm{d}v/|A(v)|$ 的一个倍数。\n- **误差度量：** 在 $v \\le v_0$ 的网格点上计算均方根相对误差（$\\mathrm{RMSE}$）和最大相对误差（$E_{\\infty}$）。\n- **测试用例：** 提供了四组参数 $(v_{\\min}, v_{\\max}, N, v_0, v_c, \\Gamma, S_0)$。\n\n**第2步：使用提取的已知条件进行验证**\n\n- **科学上合理：** 该问题基于等离子体中快离子通过库仑碰撞经典减速的标准、成熟模型。控制方程是简化的（仅含漂移项）Fokker-Planck方程，而阻力项 $A(v)$ 正确地表示了在背景离子（$v^3$ 项）和电子（$v_c^3$ 项）上的减速综合效应。整个设置是等离子体物理和聚变科学中的一个教科书级示例。\n- **适定性：** 该问题是一个带源项的线性一阶双曲偏微分方程。给定初始条件（例如，$n(v,0)=0$）、边界条件和源项，存在唯一解。相应的稳态问题是一个一阶常微分方程，可以直接求解。所给定的数值格式（一阶迎风）在指定的CFL条件下对此类方程是稳定的。\n- **客观性：** 所有参数和方程都以数学精度定义。没有主观性或模糊性。\n- **完整性与一致性：** 该问题是自洽的，提供了所有必要的物理和数值参数，包括域、边界条件、源的离散化方法以及误差度量。\n- **可行性：** 测试用例中给出的物理参数对于聚变环境（例如，中性束注入离子）是现实的。数值任务是标准的，并且在计算上是可行的。\n\n**第3步：结论与行动**\n\n该问题在科学上是合理的、适定的且完整的。它代表了计算物理学中一个标准的验证与确认练习。该问题是**有效的**。我们继续进行求解。\n\n---\n\n### 解答\n\n解答过程遵循问题陈述中概述的步骤。\n\n**1. 解析稳态解**\n\n在稳态下，$\\frac{\\partial n}{\\partial t} = 0$。守恒律简化为关于通量 $F(v) = A(v)n(v)$ 的常微分方程：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}v}\\Big(A(v)\\,n(v)\\Big) = S(v) = S_0\\,\\delta(v - v_0)\n$$\n我们将此方程对 $v$ 从速率 $v$ 积分到上边界 $v_{\\max}$。\n$$\n\\int_{v}^{v_{\\max}} \\frac{\\mathrm{d}}{\\mathrm{d}v'} \\Big(A(v')\\,n(v')\\Big) \\, \\mathrm{d}v' = \\int_{v}^{v_{\\max}} S_0\\,\\delta(v' - v_0) \\, \\mathrm{d}v'\n$$\n这得到：\n$$\n\\Big[A(v')\\,n(v')\\Big]_{v}^{v_{\\max}} = S_0 \\int_{v}^{v_{\\max}} \\delta(v' - v_0) \\, \\mathrm{d}v'\n$$\n$$\nA(v_{\\max})n(v_{\\max}) - A(v)n(v) = S_0 \\cdot \\begin{cases} 1  \\text{if } v  v_0  v_{\\max} \\\\ 0  \\text{if } v  v_0 \\end{cases}\n$$\n源在 $v=v_0$ 处注入粒子，而漂移 $A(v)=-\\Gamma(v^3+v_c^3)/v^2$ 对所有 $v0$ 始终为负，导致粒子减速（向更低的 $v$ 移动）。因此，在速率大于注入速率时，不应存在粒子，即对于 $v  v_0$ 有 $n(v) = 0$。这意味着 $n(v_{\\max}) = 0$，所以上边界的通量 $A(v_{\\max})n(v_{\\max})$ 为零。方程简化为：\n$$\n-A(v)n(v) = S_0 H(v_0 - v)\n$$\n其中 $H$ 是亥维赛阶跃函数。对于减速区 $v \\le v_0$，我们有：\n$$\nn(v) = -\\frac{S_0}{A(v)} = -\\frac{S_0}{-\\Gamma\\,\\frac{v^3 + v_c^3}{v^2}} = \\frac{S_0}{\\Gamma} \\frac{v^2}{v^3 + v_c^3} \\quad (\\text{对于 } v_{\\min} \\le v \\le v_0)\n$$\n对于 $vv_0$，$n(v) = 0$。使用关系式 $f(v) = n(v) / (4\\pi v^2)$，我们得到解析稳态经典减速分布 $f_{\\mathrm{cl}}(v)$：\n$$\nf_{\\mathrm{cl}}(v) = \\begin{cases} \\frac{S_0}{4\\pi\\Gamma} \\frac{1}{v^3 + v_c^3}  \\text{对于 } v_{\\min} \\le v \\le v_0 \\\\ 0  \\text{对于 } v  v_0 \\end{cases}\n$$\n在 $v=v_0$ 处，分布是不连续的。\n\n**2. 有限体积数值格式**\n\n我们将域 $[v_{\\min}, v_{\\max}]$ 离散化为 $N$ 个宽度为 $\\Delta v = (v_{\\max} - v_{\\min}) / N$ 的均匀单元。单元中心为 $v_i = v_{\\min} + (i+0.5)\\Delta v$，其中 $i=0, \\dots, N-1$。对单元 $i$ 上的控制方程进行积分，得到：\n$$\n\\frac{\\mathrm{d}n_i}{\\mathrm{d}t} \\Delta v + F_{i+1/2} - F_{i-1/2} = S_i \\Delta v\n$$\n其中 $n_i$ 是单元平均密度，$F_{i\\pm1/2}$ 是单元面的通量。半离散形式为 $\\frac{\\mathrm{d}n_i}{\\mathrm{d}t} = -\\frac{1}{\\Delta v}(F_{i+1/2} - F_{i-1/2}) + S_i$。\n对于一阶迎风格式，面上的数值通量由迎风单元的值决定。由于对所有 $v0$ 都有 $A(v)  0$，流动方向总是从较高的 $v$ 到较低的 $v$（在网格上从右到左）。因此，对于面 $j$，迎风单元是其右侧的单元 $j$。单元 $i$ 右侧面（面 $i+1/2$）的通量是 $F_{i+1/2} = A(v_{i+1/2})n_{i+1}$，而单元 $i$ 左侧面（面 $i-1/2$）的通量是 $F_{i-1/2} = A(v_{i-1/2})n_i$。\n位于 $v_j=v_{\\min}+j\\Delta v$ 处的面 $j$ 的数值通量为 $F_j = A(v_j)n_j$，其中 $j=0, \\dots, N-1$。对于最右侧的面 $v_N=v_{\\max}$，通过设置一个 $n_N=0$ 的虚单元来施加零流入边界条件，使得 $F_N=0$。\n使用时间上的前向欧拉法更新 $n_i$ 的格式为：\n$$\nn_i^{k+1} = n_i^k - \\frac{\\Delta t}{\\Delta v} (F_{i+1} - F_i) + \\Delta t S_i\n$$\n其中 $F_i$ 和 $F_{i+1}$ 是单元 $i$ 左右两侧面的通量。为提高效率，此过程以向量化方式实现。源 $S_0$ 被放置在包含 $v_0$ 的单个单元 $i_{\\mathrm{src}}$ 中，即 $S_{i_{\\mathrm{src}}} = S_0/\\Delta v$。\n\n**3. 时间步长和模拟时长**\n\n时间步长 $\\Delta t$ 必须满足此显式格式的 Courant–Friedrichs–Lewy (CFL) 稳定性条件：\n$$\n\\Delta t = \\mathrm{CFL} \\frac{\\Delta v}{\\max_{j} |A(v_{j})|}\n$$\n其中最大值取自域中所有单元面 $v_j$，为保证稳健性，我们选择 $\\mathrm{CFL}=0.5$。模拟运行的总时间 $T_{\\mathrm{sim}}$ 需足以达到稳态。我们估计此时间为粒子从 $v_0$ 减速到 $v_{\\min}$ 所需时间的倍数（例如，$k=5$）。此渡越时间 $\\tau$ 通过在 $v_{\\min}$ 和 $v_0$ 之间的网格单元上进行黎曼和来数值近似：\n$$\n\\tau = \\int_{v_{\\min}}^{v_0} \\frac{\\mathrm{d}v}{|A(v)|} \\approx \\sum_{i | v_i \\in [v_{\\min}, v_0]} \\frac{\\Delta v}{|A(v_i)|}\n$$\n总时间步数为 $N_t = \\lceil T_{\\mathrm{sim}} / \\Delta t \\rceil$。\n\n**4. 分布的计算**\n\n经过 $N_t$ 个时间步后，得到速率空间密度 $n_{\\mathrm{num}}$ 的数值解。然后在每个单元中心 $v_i$ 计算数值分布函数：\n$$\nf_{\\mathrm{num}}(v_i) = \\frac{n_{\\mathrm{num}}(v_i)}{4\\pi v_i^2}\n$$\n解析分布 $f_{\\mathrm{cl}}(v_i)$ 使用步骤1中推导的公式在相同的网格点上进行评估。在离散网格上，我们根据 $v_i \\le v_0$ 来定义 $f_{\\mathrm{cl}}(v_i)$，以与评估范围保持一致。\n\n**5. 误差量化**\n在 $v_i \\le v_0$ 的网格点子集上计算以下误差度量。设此点集的大小为 $M$。\n- 均方根相对误差：\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{M}\\sum_{i=1}^{M}\\left(\\frac{|f_{\\mathrm{num}}(v_i) - f_{\\mathrm{cl}}(v_i)|}{\\max(f_{\\mathrm{cl}}(v_i),\\varepsilon)}\\right)^2}\n$$\n- 最大相对误差：\n$$\nE_{\\infty} = \\max_{i\\in\\{v_i\\le v_0\\}}\\left(\\frac{|f_{\\mathrm{num}}(v_i) - f_{\\mathrm{cl}}(v_i)|}{\\max(f_{\\mathrm{cl}}(v_i),\\varepsilon)}\\right)\n$$\n使用一个小常数 $\\varepsilon=10^{-16}$ 以防止除以零，尽管在所有测试用例中，$v_i \\le v_0$ 处的 $f_{\\mathrm{cl}}(v_i)$ 均非零。这些度量量化了数值稳态解的准确性。",
            "answer": "```python\nimport numpy as np\n\ndef run_case(v_min, v_max, N, v0, vc, Gamma, S0):\n    \"\"\"\n    Solves the slowing-down problem for a single set of parameters.\n    \"\"\"\n    # --- 1. Setup Grid and Physical Parameters ---\n    dv = (v_max - v_min) / N\n    v_faces = np.linspace(v_min, v_max, N + 1)\n    v_centers = v_faces[:-1] + 0.5 * dv\n    \n    # Drag function A(v)\n    def A_func(v):\n        # Add a small epsilon to avoid division by zero if v can be zero\n        # In this problem v_min > 0, so it's safe.\n        return -Gamma * (v**3 + vc**3) / v**2\n\n    # Drag evaluated at cell faces\n    A_at_faces = A_func(v_faces)\n    \n    # --- 2. Time Step and Simulation Duration ---\n    CFL = 0.5\n    max_abs_A = np.max(np.abs(A_at_faces))\n    dt = CFL * dv / max_abs_A\n    \n    # Numerically approximate transit time from v0 to v_min\n    tau_mask = (v_centers >= v_min)  (v_centers = v0)\n    if not np.any(tau_mask):\n        # This case occurs if v0 is very close to v_min, falling outside any cell center.\n        # A single step transit time is a reasonable approximation.\n        tau = dv / np.abs(A_func(v0))\n    else:\n        v_for_tau = v_centers[tau_mask]\n        A_for_tau = A_func(v_for_tau)\n        tau = np.sum(dv / np.abs(A_for_tau))\n\n    # Simulate for 5 transit times to ensure steady state\n    T_sim = 5.0 * tau\n    N_t = int(np.ceil(T_sim / dt))\n    \n    # --- 3. Initialize Source and State Vector ---\n    S_arr = np.zeros(N)\n    # Find the cell index containing v0\n    # searchsorted finds the insertion point, subtract 1 for the cell index.\n    v0_idx = np.searchsorted(v_faces, v0, side='right') - 1\n    if 0 = v0_idx  N:\n        S_arr[v0_idx] = S0 / dv\n        \n    n = np.zeros(N) # Initial condition n(v, 0) = 0\n    \n    # --- 4. Time-Stepping Loop ---\n    for _ in range(N_t):\n        # Apply upwinding. Since A(v)  0, the wind is from the right (higher v).\n        # The flux at face j depends on n in cell j.\n        # Pad n with a ghost cell at the right (n_N = 0 for zero inflow at v_max)\n        n_padded_right = np.append(n, 0)\n        \n        # Calculate flux at all N+1 faces\n        F_at_faces = A_at_faces * n_padded_right\n        \n        # Calculate flux divergence for all cells\n        # F[i+1] - F[i] is the net flux out of cell i\n        flux_divergence = F_at_faces[1:] - F_at_faces[:-1]\n\n        # Update n using forward Euler\n        n = n - (dt / dv) * flux_divergence + dt * S_arr\n\n    # --- 5. Calculate Analytic and Numerical Solutions for f(v) ---\n    # Numerical solution for f(v)\n    f_num = n / (4 * np.pi * v_centers**2)\n    \n    # Analytic solution f_cl(v)\n    f_cl = np.zeros(N)\n    # Mask for the slowing-down region v = v0\n    analytic_mask = v_centers = v0\n    vc_cubed = vc**3\n    f_cl[analytic_mask] = (S0 / (4 * np.pi * Gamma)) / (v_centers[analytic_mask]**3 + vc_cubed)\n    \n    # --- 6. Compute Error Metrics ---\n    # Evaluation is restricted to v = v0\n    eval_mask = v_centers = v0\n    f_num_eval = f_num[eval_mask]\n    f_cl_eval = f_cl[eval_mask]\n    \n    if len(f_num_eval) == 0:\n        return [0.0, 0.0]\n\n    epsilon = 1e-16\n    \n    # Relative error\n    rel_err = np.abs(f_num_eval - f_cl_eval) / np.maximum(f_cl_eval, epsilon)\n    \n    # RMSE\n    rmse = np.sqrt(np.mean(rel_err**2))\n    \n    # Max relative error\n    e_inf = np.max(rel_err)\n    \n    return [rmse, e_inf]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Each test case: (v_min, v_max, N, v0, vc, Gamma, S0)\n    test_cases = [\n        (2.0e5, 2.0e6, 400, 1.2e6, 5.0e5, 50.0, 1.0e19),\n        (2.0e5, 2.0e6, 400, 1.9e6, 5.0e5, 50.0, 1.0e19),\n        (2.0e5, 2.0e6, 400, 1.2e6, 1.0e5, 50.0, 1.0e19),\n        (2.0e5, 2.0e6, 400, 2.3e5, 5.0e5, 50.0, 1.0e19),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_case(*case)\n        results.append(result)\n\n    # Format the output string exactly as specified\n    result_strings = [f\"[{r[0]},{r[1]}]\" for r in results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在真实的等离子体模拟中，边界条件的选择至关重要，因为它决定了粒子如何与计算域的边界相互作用。本练习探讨了不同物理边界条件（如吸收、反射或零梯度）对包含漂移和扩散的福克-普朗克方程稳态解的影响 。通过实施和比较这些情景，您将理解边界假设如何显著改变计算出的快离子布居。",
            "id": "4045195",
            "problem": "考虑在均匀背景等离子体中经历碰撞减速的快离子布居的稳态、速度空间各向同性的 Fokker–Planck (FP) 平衡。在无量纲变量中，令 $u = v/v_{\\mathrm{inj}}$ 表示归一化到注入速度的速度，令 $f(u)$ 表示无量纲、各向同性的分布函数。假设一个具有漂移系数 $b(u)$、扩散系数 $D$、各向同性源 $S(u)$ 和线性损失率 $\\lambda$ 的一维速度空间模型，则守恒形式的稳态 FP 方程为\n$$\n\\frac{d}{du}\\left(-D \\frac{df}{du} + b(u) f(u)\\right) + S(u) - \\lambda f(u) = 0,\n$$\n对于 $u \\in [u_{\\min}, u_{\\max}]$，其中 $u_{\\min}  0$ 和 $u_{\\max}  u_{\\min}$ 是归一化速度的固定边界。取碰撞漂移系数为\n$$\nb(u) = -\\frac{a_0}{u^2},\n$$\n其中 $a_0  0$ 为常数，取扩散系数为 $D = d_0$，其中 $d_0  0$ 为常数。源项局域在注入速度附近，并建模为高斯函数，\n$$\nS(u) = S_0 \\exp\\left(-\\frac{(u-1)^2}{2\\sigma^2}\\right),\n$$\n其幅度 $S_0  0$，宽度 $\\sigma  0$。损失项为 $\\lambda f(u)$，其中常数 $\\lambda  0$。\n\n必须在低能边界 $u=u_{\\min}$ 和高能边界 $u=u_{\\max}$ 处指定边界条件。考虑以下具有物理动机的边界条件类型，用 $f$ 及其导数表示：\n- 吸收（狄利克雷）边界：$f(u) = c$，通常在边界处取 $c=0$ 以表示吸收条件。\n- 零梯度（诺伊曼）边界：$\\frac{df}{du}(u) = 0$，表示边界处的梯度为零。\n- 反射（零净通量）边界：$b(u) f(u) - D \\frac{df}{du}(u) = 0$，强制边界处速度空间净通量为零。\n\n根据 FP 方程和这些边界类型，建立 $f(u)$ 的边值问题，并将其在均匀网格 $u_j = u_{\\min} + j \\Delta u$（$j=0,\\dots,N$，$\\Delta u = (u_{\\max} - u_{\\min})/N$）上离散化。对内部点 $j=1,\\dots,N-1$ 使用二阶中心差分：\n$$\nD \\frac{f_{j+1} - 2 f_j + f_{j-1}}{\\Delta u^2} - b(u_j) \\frac{f_{j+1} - f_{j-1}}{2 \\Delta u} - b'(u_j) f_j + \\lambda f_j = S(u_j),\n$$\n其中 $b'(u) = \\frac{db}{du}$。在 $u_{\\min}$ 和 $u_{\\max}$ 处，使用关于 $\\frac{df}{du}$ 的二阶精度单边公式来施加边界条件。对于诺伊曼边界，使用\n$$\n\\left.\\frac{df}{du}\\right|_{u_{\\min}} \\approx \\frac{-3 f_0 + 4 f_1 - f_2}{2 \\Delta u} = 0,\\quad\n\\left.\\frac{df}{du}\\right|_{u_{\\max}} \\approx \\frac{3 f_N - 4 f_{N-1} + f_{N-2}}{2 \\Delta u} = 0.\n$$\n对于反射边界，施加\n$$\nb(u_{\\min}) f_0 - D \\frac{-3 f_0 + 4 f_1 - f_2}{2 \\Delta u} = 0,\\quad\nb(u_{\\max}) f_N - D \\frac{3 f_N - 4 f_{N-1} + f_{N-2}}{2 \\Delta u} = 0.\n$$\n对于吸收（狄利克雷）边界，在 $u_{\\min}$ 处强制 $f_0 = c_{\\min}$，在 $u_{\\max}$ 处强制 $f_N = c_{\\max}$，其中 $c_{\\min}$ 和 $c_{\\max}$ 是指定的常数。\n\n定义无量纲的积分快离子含量\n$$\n\\mathcal{N} = \\int_{u_{\\min}}^{u_{\\max}} f(u)\\, u^2\\, du,\n$$\n此处它作为稳态分布的标量度量。以无量纲单位表示 $\\mathcal{N}$。\n\n你的任务是编写一个完整的程序，对下面测试套件中的每一组参数，组装并求解由离散化生成的关于 $f_j$ 的线性系统。使用 $N=400$ 个网格区间，并用梯形法则计算 $\\mathcal{N}$。所有变量和结果都是无量纲的。程序不得要求任何用户输入。\n\n测试套件（每个案例指定边界条件和参数）：\n- 案例 1 (基准)：$u_{\\min}=0.1$, $u_{\\max}=1.5$, $a_0=0.25$, $d_0=0.01$, $\\lambda=0.05$, $S_0=1.0$, $\\sigma=0.02$；低能边界为反射边界，高能边界为吸收边界，$f(u_{\\max})=0$。\n- 案例 2：参数与案例 1 相同，除了低能边界为吸收边界，$f(u_{\\min}) = \\exp\\left(-\\frac{u_{\\min}^2}{u_{\\mathrm{th}}^2}\\right)$，其中 $u_{\\mathrm{th}}=0.3$，高能边界为零梯度边界。\n- 案例 3：参数与案例 1 相同，两端均为反射边界。\n- 案例 4：参数与案例 1 相同，两端均为吸收边界，$f(u_{\\min})=0$ 且 $f(u_{\\max})=0$。\n- 案例 5 (边缘案例)：$u_{\\min}=0.1$, $u_{\\max}=1.5$, $a_0=0.25$, $d_0=10^{-4}$, $\\lambda=0.05$, $S_0=1.0$, $\\sigma=0.02$；低能边界为反射边界，高能边界为吸收边界，$f(u_{\\max})=0$。\n\n你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”），其中每个“result”是对应测试案例的 $\\mathcal{N}$ 值，以无量纲单位的浮点数表示。",
            "solution": "出发点是速度空间各向同性的守恒形式稳态 Fokker–Planck (FP) 方程，\n$$\n\\frac{d}{du}\\left(-D \\frac{df}{du} + b(u) f(u)\\right) + S(u) - \\lambda f(u) = 0,\n$$\n其中 $u = v/v_{\\mathrm{inj}}$ 是无量纲速度，$f(u)$ 是无量纲分布函数，$D$ 是扩散系数，$b(u)$ 是漂移系数，$S(u)$ 是源项，$\\lambda$ 是线性损失参数。该方程表示在漂移、扩散、注入和损失作用下速度空间中概率密度的守恒。\n\n我们用确定性漂移 $b(u) = - a_0 / u^2$ 和恒定扩散 $D=d_0$ 来模拟碰撞减速。源项 $S(u)$ 通过高斯函数 $S(u) = S_0 \\exp[-(u-1)^2/(2\\sigma^2)]$ 局域在 $u \\approx 1$ 处。损失项 $\\lambda f(u)$ 模拟了以速率 $\\lambda$ 发生的净移除。\n\n为计算稳态，我们在均匀网格 $u_j = u_{\\min} + j \\Delta u$（$j=0,\\dots,N$，$ \\Delta u = (u_{\\max}-u_{\\min})/N$）上进行离散化。对于内部节点 $j=1,\\dots,N-1$，我们应用二阶中心差分来近似导数。对守恒形式的方程求导可得\n$$\n-D \\frac{d^2 f}{du^2} + b'(u) f(u) + b(u) \\frac{df}{du} + S(u) - \\lambda f(u) = 0.\n$$\n将其重排为与问题陈述中一致的形式，\n$$\nD \\frac{d^2f}{du^2} - b(u)\\frac{df}{du} - (b'(u) - \\lambda)f(u) = S(u).\n$$\n其中 $b'(u) = 2 a_0 u^{-3}$。\n\n使用中心差分，离散的内部方程为\n$$\nD \\frac{f_{j+1} - 2 f_j + f_{j-1}}{\\Delta u^2}\n- b(u_j) \\frac{f_{j+1} - f_{j-1}}{2 \\Delta u}\n- (b'(u_j) - \\lambda) f_j\n= S(u_j).\n$$\n这产生了一个关于 $f_j$ 的三对角线性系统，其系数为：\n- 下对角线（与 $f_{j-1}$ 相关）：$c_{j,-} = \\frac{D}{\\Delta u^2} + \\frac{b(u_j)}{2 \\Delta u}$。\n- 主对角线（与 $f_j$ 相关）：$c_{j,0} = -\\frac{2D}{\\Delta u^2} - b'(u_j) + \\lambda$。\n- 上对角线（与 $f_{j+1}$ 相关）：$c_{j,+} = \\frac{D}{\\Delta u^2} - \\frac{b(u_j)}{2 \\Delta u}$。\n\n边界条件通过将 $j=0$ 和 $j=N$ 处的偏微分方程行替换为相应的离散边界方程来实现：\n\n1. 边界 $u_b$ 处的吸收（狄利克雷）条件：强制 $f(u_b) = c$，其离散形式在 $u_{\\min}$ 处为 $f_0 = c$，或在 $u_{\\max}$ 处为 $f_N = c$。\n\n2. $u_{\\min}$ 处的零梯度（诺伊曼）条件：通过二阶单边近似强制 $\\frac{df}{du} = 0$\n$$\n\\frac{-3 f_0 + 4 f_1 - f_2}{2 \\Delta u} = 0 \\quad \\Rightarrow \\quad -3 f_0 + 4 f_1 - f_2 = 0,\n$$\n在 $u_{\\max}$ 处类似：\n$$\n\\frac{3 f_N - 4 f_{N-1} + f_{N-2}}{2 \\Delta u} = 0 \\quad \\Rightarrow \\quad 3 f_N - 4 f_{N-1} + f_{N-2} = 0.\n$$\n这些边界方程替换了 $j=0$ 和 $j=N$ 处的偏微分方程行。\n\n3. 边界 $u_b$ 处的反射（零通量）条件：强制 $b(u_b) f(u_b) - D \\frac{df}{du}(u_b) = 0$。在 $u_{\\min}$ 处使用二阶单边差分近似导数，\n$$\nb(u_{\\min}) f_0 - D \\frac{-3 f_0 + 4 f_1 - f_2}{2 \\Delta u} = 0,\n$$\n在 $u_{\\max}$ 处，\n$$\nb(u_{\\max}) f_N - D \\frac{3 f_N - 4 f_{N-1} + f_{N-2}}{2 \\Delta u} = 0.\n$$\n这些是边界值与相邻值之间的线性关系。\n\n通过以下步骤组装完整的 $(N+1) \\times (N+1)$ 线性系统 $\\mathbf{A} \\mathbf{f} = \\mathbf{s}$：\n- 将内部行 $j=1,\\dots,N-1$ 设置为三对角系数，右端项为 $S(u_j)$。\n- 将边界行 $j=0$ 和 $j=N$ 替换为相应的边界条件方程，其右端项等于其常数（对于诺伊曼和反射边界为零；对于狄利克雷边界为指定值）。\n\n使用直接线性求解器求解 $\\mathbf{f}$。通过网格上的梯形法则计算积分快离子含量\n$$\n\\mathcal{N} = \\int_{u_{\\min}}^{u_{\\max}} f(u) u^2 \\, du\n$$\n所有物理量都是无量纲的；因此 $\\mathcal{N}$ 是一个无量纲标量。\n\n为了分析 $u_{\\min}$ 和 $u_{\\max}$ 处的边界条件对计算出的稳态的影响，我们为测试套件中的五个案例评估 $\\mathcal{N}$：\n- 案例 1 在低能端使用反射边界，在高能端使用吸收边界；这通常允许粒子在低 $u$ 附近累积，同时移除高能成分，从而产生比完全吸收边界相对更大的 $\\mathcal{N}$。\n- 案例 2 在低能端施加一个匹配麦克斯韦分布代理的有限狄利克雷值，并在高能端施加零梯度条件；这倾向于维持一个更平滑的尾部和一个非零的低 $u$ 基底，与高能吸收条件相比，可能会增加 $\\mathcal{N}$。\n- 案例 3 在两端都使用反射边界；由于存在损失 $\\lambda0$，解保持有界，并可能由于两端的粒子保留而产生更大的 $\\mathcal{N}$。\n- 案例 4 在两端都使用吸收边界，这抑制了在低 $u$ 和高 $u$ 处的累积，因此通常会相对于反射或零梯度条件减小 $\\mathcal{N}$。\n- 案例 5 显著减小了扩散 $d_0$，强调了平流漂移；边界条件因此对两端附近的形状有更强的影响，并且由于平滑效应减弱，积分的 $\\mathcal{N}$ 可能会发生变化。\n\n程序实现了这些案例，求解了边值问题，并以指定的格式输出了 $\\mathcal{N}$ 值的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_system(u_min, u_max, N, a0, d0, lam, S0, sigma, bc_left, bc_right, f_left=None, f_right=None, u_th=None):\n    \"\"\"\n    Build the (A, s) linear system for the steady-state FP equation with specified boundary conditions.\n\n    Parameters:\n        u_min, u_max: domain bounds (dimensionless)\n        N: number of intervals; there will be N+1 grid points\n        a0: drift coefficient parameter, b(u) = -a0/u^2\n        d0: diffusion coefficient (constant)\n        lam: loss coefficient\n        S0: source amplitude\n        sigma: source width\n        bc_left, bc_right: boundary condition types: 'dirichlet', 'neumann', 'reflecting'\n        f_left, f_right: values for Dirichlet boundaries (if applicable)\n        u_th: thermal scale for Maxwellian (used to calculate f_left for Case 2)\n\n    Returns:\n        A: (N+1)x(N+1) matrix\n        s: right-hand-side vector\n        u: grid points\n    \"\"\"\n    # Grid\n    u = np.linspace(u_min, u_max, N + 1)\n    du = (u_max - u_min) / N\n\n    # Coefficients and source\n    # Add epsilon to u to avoid division by zero if u_min=0, although here u_min > 0.\n    eps = 1e-12\n    b = -a0 / ((u + eps)**2)        # drift\n    bp = 2.0 * a0 / ((u + eps)**3)  # derivative of drift\n    S = S0 * np.exp(-((u - 1.0) ** 2) / (2.0 * sigma ** 2))\n\n    # Initialize system\n    A = np.zeros((N + 1, N + 1))\n    s = np.zeros(N + 1)\n\n    # Interior rows: j = 1..N-1\n    for j in range(1, N):\n        # Discretized form is D*f'' - b*f' - (b'-lambda)*f = S\n        c_minus = d0 / du**2 + b[j] / (2.0 * du)\n        c_diag  = -2.0 * d0 / du**2 - (bp[j] - lam)\n        c_plus  = d0 / du**2 - b[j] / (2.0 * du)\n        A[j, j - 1] = c_minus\n        A[j, j]     = c_diag\n        A[j, j + 1] = c_plus\n        s[j]        = S[j]\n\n    # Left boundary row j = 0\n    if bc_left == 'dirichlet':\n        A[0, 0] = 1.0\n        s[0] = f_left\n    elif bc_left == 'neumann':\n        # (-3 f0 + 4 f1 - f2)/(2 du) = 0 -> -3 f0 + 4 f1 - f2 = 0\n        A[0, 0] = -3.0\n        A[0, 1] =  4.0\n        A[0, 2] = -1.0\n        s[0] = 0.0\n    elif bc_left == 'reflecting':\n        # b(u_min) f0 - d0 * (-3 f0 + 4 f1 - f2)/(2 du) = 0\n        A[0, 0] = b[0] + (3.0 * d0) / (2.0 * du)\n        A[0, 1] = -2.0 * d0 / du\n        A[0, 2] =  d0 / (2.0 * du)\n        s[0] = 0.0\n\n    # Right boundary row j = N\n    if bc_right == 'dirichlet':\n        A[N, N] = 1.0\n        s[N] = f_right\n    elif bc_right == 'neumann':\n        # (3 fN - 4 f_{N-1} + f_{N-2})/(2 du) = 0 -> 3 fN - 4 f_{N-1} + f_{N-2} = 0\n        A[N, N]     =  3.0\n        A[N, N - 1] = -4.0\n        A[N, N - 2] =  1.0\n        s[N] = 0.0\n    elif bc_right == 'reflecting':\n        # b(u_max) fN - d0 * (3 fN - 4 f_{N-1} + f_{N-2})/(2 du) = 0\n        A[N, N]     = b[N] - (3.0 * d0) / (2.0 * du)\n        A[N, N - 1] =  2.0 * d0 / du\n        A[N, N - 2] = -d0 / (2.0 * du)\n        s[N] = 0.0\n        \n    return A, s, u\n\ndef solve_case(params):\n    # Unpack parameters\n    u_min, u_max, N = params['u_min'], params['u_max'], params['N']\n    a0, d0, lam, S0, sigma = params['a0'], params['d0'], params['lam'], params['S0'], params['sigma']\n    bc_left, bc_right = params['bc_left'], params['bc_right']\n    \n    # Handle optional parameters for specific BCs\n    f_left = params.get('f_left', None)\n    f_right = params.get('f_right', None)\n    u_th = params.get('u_th', None)\n\n    # For case 2, f_left depends on u_th and u_min\n    if 'u_th' in params and 'f_left' not in params and bc_left == 'dirichlet':\n        f_left = np.exp(-(u_min ** 2) / (u_th ** 2))\n\n    # Build system\n    A, s, u = build_system(u_min, u_max, N, a0, d0, lam, S0, sigma, bc_left, bc_right, f_left, f_right)\n    \n    # Solve\n    f = np.linalg.solve(A, s)\n    \n    # Compute integrated content N = ∫ f(u) u^2 du by trapezoidal rule\n    integrand = f * (u ** 2)\n    Nu = np.trapz(integrand, u)\n    return float(Nu)\n\ndef solve():\n    # Common settings from problem statement\n    base_params = {\n        'u_min': 0.1, 'u_max': 1.5, 'N': 400,\n        'a0': 0.25, 'lam': 0.05, 'S0': 1.0, 'sigma': 0.02\n    }\n\n    test_cases = [\n        # Case 1: baseline\n        {**base_params, 'd0': 0.01, 'bc_left': 'reflecting', 'bc_right': 'dirichlet', 'f_right': 0.0},\n        # Case 2: different BCs\n        {**base_params, 'd0': 0.01, 'bc_left': 'dirichlet', 'bc_right': 'neumann', 'u_th': 0.3},\n        # Case 3: both reflecting\n        {**base_params, 'd0': 0.01, 'bc_left': 'reflecting', 'bc_right': 'reflecting'},\n        # Case 4: both absorbing\n        {**base_params, 'd0': 0.01, 'bc_left': 'dirichlet', 'f_left': 0.0, 'bc_right': 'dirichlet', 'f_right': 0.0},\n        # Case 5: edge case (low diffusion)\n        {**base_params, 'd0': 1e-4, 'bc_left': 'reflecting', 'bc_right': 'dirichlet', 'f_right': 0.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}