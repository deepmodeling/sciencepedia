{
    "hands_on_practices": [
        {
            "introduction": "模拟快波电流驱动的第一步是理解波的源头——天线。本练习将天线的物理设计（通过其场分布的高斯宽度 $\\sigma$ 来表征）与它在等离子体中激发的波谱联系起来。通过计算耦合进等离子体的功率份额，我们可以评估天线设计的有效性，这是优化射频系统的关键初始步骤 。",
            "id": "3978879",
            "problem": "考虑一个用于在射频（RF）电流驱动中发射快磁声波（快波）的直场线平板模型。一个半无限的冷磁化等离子体占据半空间 $x>0$，其内有均匀磁场 $\\boldsymbol{B}_0 = B_0 \\hat{\\boldsymbol{z}}$。在 $x=0$ 处的一个外部驱动射频天线，沿环向（平行）坐标 $z$ 产生一个切向平行电场包络，由 $E_{\\parallel}(z,t) = \\Re\\{E_0 \\exp(-z^{2}/(2\\sigma^{2})) \\exp(-i \\omega t)\\}$ 给出，其中 $E_0$ 是一个恒定振幅，$\\sigma$ 是孔径场的高斯标准差，$\\omega = 2 \\pi f$ 是角频率。工作频率为 $f = 55\\,\\mathrm{MHz}$。\n\n在固定 $\\omega$ 的冷等离子体快波近似下，与给定的平行波数 $k_{\\parallel}$ 相关联的垂直波数 $k_{\\perp}$ 满足可及性条件\n$$\nk_{\\perp}^{2} = k_{0}^{2} n_{f}^{2} - k_{\\parallel}^{2} \\, ,\n$$\n其中 $k_{0} = \\omega / c$，$c$ 为光速，$n_{f}$ 是一个正常数模式折射率，它包含了在选定的 $\\omega$ 和 $\\boldsymbol{B}_0$ 下的冷等离子体介电响应。在此模型中，波要传播到等离子体内部需要 $k_{\\perp}^{2} > 0$，即 $|k_{\\parallel}|  k_{c}$，其中 $k_{c} = k_{0} n_{f}$。假设一个简化的耦合模型，其中所有具有实数 $k_{\\perp}$ 的发射谱分量都完全耦合（无反射），而所有具有虚数 $k_{\\perp}$ 的分量都不耦合（全反射）。\n\n利用场的谱表示方法，以及给定 $k_{\\parallel}$ 分量所携带的谱功率密度与孔径场沿 $z$ 的空间傅里叶变换的模平方成正比这一事实，从第一性原理推导出发射射频功率的耦合分数 $F$ 的解析表达式，\n$$\nF = \\frac{\\text{由 } |k_{\\parallel}|  k_{c} \\text{ 的模式携带的功率}}{\\text{总发射功率}} \\, ,\n$$\n用 $\\sigma$ 和 $k_{c}$ 表示。然后，对于 $n_{f} = 8.0$，$c = 2.99792458 \\times 10^{8}\\,\\mathrm{m/s}$ 以及天线设计选择 $\\sigma = 1/k_{c}$ 的特定情况，数值计算 $F$。将最终答案表示为四舍五入到四位有效数字的小数。最终答案是无量纲的；不要在最终的方框值中包含任何单位。",
            "solution": "目标是在冷等离子体中快磁声波的可及性条件 $|k_{\\parallel}|  k_{c}$ 下，计算耦合到等离子体中的发射射频功率的分数。\n\n从孔径场的谱表示开始。平行电场包络 $E_{\\parallel}(z)$ 沿 $z$ 的空间傅里叶变换 $\\tilde{E}_{\\parallel}(k_{\\parallel})$ 定义为\n$$\n\\tilde{E}_{\\parallel}(k_{\\parallel}) = \\int_{-\\infty}^{\\infty} E_{\\parallel}(z) \\exp(-i k_{\\parallel} z) \\, dz \\, .\n$$\n对于给定的高斯包络 $E_{\\parallel}(z) = E_0 \\exp(-z^{2}/(2\\sigma^{2}))$，其傅里叶变换可利用高斯函数的熟知性质计算得出：\n$$\n\\tilde{E}_{\\parallel}(k_{\\parallel}) = E_0 \\int_{-\\infty}^{\\infty} \\exp\\!\\left(-\\frac{z^{2}}{2\\sigma^{2}}\\right) \\exp(-i k_{\\parallel} z) \\, dz = E_0 \\sigma \\sqrt{2\\pi}\\, \\exp\\!\\left(-\\frac{\\sigma^{2} k_{\\parallel}^{2}}{2}\\right) \\, .\n$$\n与每个 $k_{\\parallel}$ 相关联的谱功率密度与傅里叶振幅的模平方成正比，因此，除去一个恒定的归一化因子，\n$$\n\\mathcal{P}(k_{\\parallel}) \\propto |\\tilde{E}_{\\parallel}(k_{\\parallel})|^{2} = E_0^{2} (2\\pi) \\sigma^{2} \\exp(-\\sigma^{2} k_{\\parallel}^{2}) \\, .\n$$\n由于定义分数时比例常数在比率中被消去，我们可以纯粹用归一化高斯谱来表示耦合分数 $F$：\n$$\nF = \\frac{\\int_{-k_{c}}^{k_{c}} \\exp(-\\sigma^{2} k_{\\parallel}^{2}) \\, dk_{\\parallel}}{\\int_{-\\infty}^{\\infty} \\exp(-\\sigma^{2} k_{\\parallel}^{2}) \\, dk_{\\parallel}} \\, .\n$$\n计算高斯积分。分母是标准高斯积分：\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-\\sigma^{2} k_{\\parallel}^{2}) \\, dk_{\\parallel} = \\frac{\\sqrt{\\pi}}{\\sigma} \\, .\n$$\n分子是截断高斯积分，可用误差函数表示：\n$$\n\\int_{-k_{c}}^{k_{c}} \\exp(-\\sigma^{2} k_{\\parallel}^{2}) \\, dk_{\\parallel} = \\frac{\\sqrt{\\pi}}{\\sigma}\\, \\mathrm{erf}(\\sigma k_{c}) \\, ,\n$$\n其中 $\\mathrm{erf}(x)$ 是误差函数，定义为 $\\mathrm{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_{0}^{x} \\exp(-t^{2}) \\, dt$。\n\n因此，耦合分数为\n$$\nF = \\mathrm{erf}(\\sigma k_{c}) \\, ,\n$$\n其中 $k_{c} = k_{0} n_{f} = \\frac{\\omega}{c} n_{f} = \\frac{2\\pi f}{c}\\, n_{f} \\, .\n$$\n\n现在对指定的参数进行数值计算。我们有 $n_{f} = 8.0$，$c = 2.99792458 \\times 10^{8}\\,\\mathrm{m/s}$，$f = 55\\,\\mathrm{MHz}$，以及设计选择 $\\sigma = 1/k_{c}$。当 $\\sigma = 1/k_{c}$ 时，误差函数的自变量为\n$$\n\\sigma k_{c} = 1 \\, .\n$$\n因此，\n$$\nF = \\mathrm{erf}(1) \\, .\n$$\n误差函数在1处的数值是一个熟知的常数\n$$\n\\mathrm{erf}(1) \\approx 0.842700792949\\ldots \\, .\n$$\n四舍五入到四位有效数字，耦合分数为\n$$\nF \\approx 0.8427 \\, .\n$$\n这是无量纲的，符合要求。",
            "answer": "$$\\boxed{0.8427}$$"
        },
        {
            "introduction": "当快波成功进入等离子体后，其传播路径并非总是一帆风顺。本练习探讨了一种关键的物理现象：模式转换，即快波可以转变为另一种类型的波，这可能会减少可用于电流驱动的功率。通过应用 Landau-Zener 模型，您可以量化这种转换的概率，这对于设计和预测快波加热与电流驱动方案的整体性能至关重要 。",
            "id": "3978875",
            "problem": "一个具有均匀磁场 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ 的一维板状等离子体被用于在离子回旋频率范围（ICRF）内进行快磁声波电流驱动。电子密度 $n_e(x)$ 在 $\\hat{\\mathbf{x}}$ 方向上单调变化，其标长为 $L_n$，满足 $|\\partial_x \\ln n_e| \\sim 1/L_n$，且垂直非均匀性在真空波长的尺度上是缓慢变化的。一个射频源从低密度侧发射角频率为 $\\omega$、平行波数为 $k_{\\parallel}$ 的快磁声波。在含有少量氢的氘等离子体中，有限离子温度效应使得离子伯恩斯坦波（IBW）得以存在，快波可以在离子-离子混合共振层附近模式转换为慢波/IBW分支。这种转换产生了一个损耗通道，减少了可用于电流驱动的功率份额。\n\n从麦克斯韦方程组 $\\nabla \\times \\mathbf{E} = -\\partial_t \\mathbf{B}$ 和 $\\nabla \\times \\mathbf{B} = \\mu_0 \\partial_t \\mathbf{D}$ 出发，结合冷等离子体介电张量 $\\boldsymbol{\\epsilon}(\\omega, x)$ 以及使慢波/IBW共振正则化的有限离子拉莫尔半径修正，论证在快慢波交叉点附近的局域波场可以展开为两个瞬时极化本征矢量，且它们的振幅服从一个具有缓慢扫描失谐的双模耦合系统。在射线框架中，设快慢波失谐为 $\\Delta(t)$，由于密度梯度，它在交叉点附近近似为时间的线性函数，$\\Delta(t) \\simeq \\Delta_0 + \\alpha v_g t$，其中 $v_g$ 是入射快波在非均匀介质中的群速度，$\\alpha \\equiv \\partial_x \\Delta$ 是由平衡梯度决定的失谐的空间斜率，而快波与慢波/IBW分支之间的非对角耦合 $g$ 由于有限离子拉莫尔半径物理效应而不为零。\n\n通过将此双模系统映射到经典的朗道-齐纳问题，推导快波到慢波/IBW的模式转换概率 $P_{\\mathrm{conv}}$，作为耦合强度 $g$ 和失谐扫描率 $d\\Delta/dt$ 的函数。然后，对于一个磁场为 $B_0 = 3 \\text{ T}$、电子密度标长为 $L_n = 0.10 \\text{ m}$ 的氘等离子体，发射频率满足 $\\omega/2\\pi = 60 \\text{ MHz}$，平行波数为 $k_{\\parallel} = 10 \\text{ m}^{-1}$，假设在离子-离子混合层附近的局域参数为\n$\\alpha = 1.0 \\times 10^{8} \\text{ s}^{-1}\\text{ m}^{-1}$，$v_g = 1.0 \\times 10^{6} \\text{ m s}^{-1}$，以及 $g = 5.0 \\times 10^{6} \\text{ s}^{-1}$。\n根据推导出的表达式，计算快波到慢波/IBW的模式转换概率 $P_{\\mathrm{conv}}$。将最终答案表示为无量纲小数，并四舍五入到四位有效数字。",
            "solution": "该问题要求通过将系统映射到朗道-齐纳问题来推导快波到慢波/IBW的模式转换概率 $P_{\\mathrm{conv}}$，然后对给定的一组参数评估此概率。\n\n我们从一个前提开始：模式转换层附近的波电场 $\\mathbf{E}$ 可以用一个双模耦合系统来描述。在缓慢变化的非均匀介质中，从麦克斯韦方程组导出的全波方程可以简化为一组关于局域本征模振幅的耦合常微分方程。对于两个近简并的模式，例如离子-离子混合共振附近的快磁声波和慢离子伯恩斯坦波（IBW），我们可以将系统截断为两个模式。在以入射波群速度 $v_g$ 移动的参考系中，空间变化 $x$ 映射为时间演化 $t$，即 $x = v_g t$（忽略共振点附近群速度本身的色散）。快波复振幅 $c_f(t)$ 和慢波复振幅 $c_s(t)$ 的方程组具有类薛定谔方程的形式：\n$$i \\frac{d}{dt} \\begin{pmatrix} c_f \\\\ c_s \\end{pmatrix} = \\mathbf{H}(t) \\begin{pmatrix} c_f \\\\ c_s \\end{pmatrix} = \\begin{pmatrix} \\omega_f(t)  g \\\\ g^*  \\omega_s(t) \\end{pmatrix} \\begin{pmatrix} c_f \\\\ c_s \\end{pmatrix}$$\n这里，$\\omega_f(t)$ 和 $\\omega_s(t)$ 分别是未耦合的快波和慢波的局域、时变色散关系（频率）。非对角项 $g$ 代表模式之间的耦合，它源于等离子体介电张量中的有限离子拉莫尔半径效应。\n\n两个模式之间的失谐定义为 $\\Delta(t) = \\omega_f(t) - \\omega_s(t)$。我们可以将振幅矢量变换到一个新的基，以消除平均频率 $\\bar{\\omega} = (\\omega_f + \\omega_s)/2$。令 $c'_j = c_j \\exp\\left(i \\int^t \\bar{\\omega}(t') dt'\\right)$。新振幅 $c'_f$ 和 $c'_s$ 的系统变为：\n$$i \\frac{d}{dt} \\begin{pmatrix} c'_f \\\\ c'_s \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}\\Delta(t)  g \\\\ g^*  -\\frac{1}{2}\\Delta(t) \\end{pmatrix} \\begin{pmatrix} c'_f \\\\ c'_s \\end{pmatrix}$$\n这是双能级量子力学系统的标准形式，朗道-齐纳解适用于此。问题陈述指出，在交叉点（我们设为 $t=0$）附近，失谐随时间近似线性变化：\n$$\\Delta(t) \\simeq \\left(\\frac{d\\Delta}{dt}\\right)_{t=0} t$$\n失谐的扫描率由 $\\frac{d\\Delta}{dt} = \\alpha v_g$ 给出。\n\n状态 $\\{c_f, c_s\\}$ 是*非绝热*态，代表没有耦合时的快波和慢波。哈密顿矩阵 $\\mathbf{H}(t)$ 的瞬时本征态是*绝热*态。它们的本征值 $\\lambda_{\\pm} = \\bar{\\omega} \\pm \\frac{1}{2}\\sqrt{\\Delta(t)^2 + 4|g|^2}$ 表现出避免交叉。\n\n当系统最初处于远离共振（$\\Delta$很大）的非绝热态（例如，纯快波），在穿过共振后演化到另一个非绝热态（慢波）时，就发生了模式转换。这对应于系统在整个相互作用过程中保持在单一的绝热能量分支上。这种绝热过程的概率由 $P_{\\mathrm{ad}} = 1 - P_{\\mathrm{LZ}}$ 给出，其中 $P_{\\mathrm{LZ}}$ 是非绝热跃迁（在绝热分支之间跳跃）的概率。\n\n朗道-齐纳公式给出了非绝热跃迁的概率为：\n$$P_{\\mathrm{LZ}} = \\exp\\left( -2\\pi \\frac{|g|^2}{\\hbar |d(\\Delta/2 - (-\\Delta/2))/dt|} \\right) = \\exp\\left( -2\\pi \\frac{|g|^2}{\\hbar |d\\Delta/dt|} \\right)$$\n在我们的经典波动力学背景下，有效普朗克常数为 $\\hbar=1$。模式转换概率 $P_{\\mathrm{conv}}$ 是绝热跟随的概率，因此：\n$$P_{\\mathrm{conv}} = 1 - P_{\\mathrm{LZ}} = 1 - \\exp\\left( -2\\pi \\frac{|g|^2}{|d\\Delta/dt|} \\right)$$\n问题通过空间斜率 $\\alpha = \\partial_x \\Delta$ 和群速度 $v_g$ 间接给出了失谐扫描率。在射线框架中，时间扫描率为：\n$$\\left|\\frac{d\\Delta}{dt}\\right| = \\left|\\frac{\\partial \\Delta}{\\partial x} \\frac{dx}{dt}\\right| = |\\alpha v_g|$$\n将此代入 $P_{\\mathrm{conv}}$ 的表达式，我们得到推导部分的最终公式：\n$$P_{\\mathrm{conv}} = 1 - \\exp\\left( -2\\pi \\frac{|g|^2}{|\\alpha v_g|} \\right)$$\n\n现在，我们使用给定的数值来评估 $P_{\\mathrm{conv}}$。具体情况的参数如下：\n- 耦合：$g = 5.0 \\times 10^{6} \\text{ s}^{-1}$\n- 失谐的空间斜率：$\\alpha = 1.0 \\times 10^{8} \\text{ s}^{-1}\\text{ m}^{-1}$\n- 群速度：$v_g = 1.0 \\times 10^{6} \\text{ m s}^{-1}$\n\n其他参数（$B_0$，$L_n$，$\\omega$，$k_{\\parallel}$）是该等离子体情景的背景参数，并且已隐含在给定的 $g$、$\\alpha$ 和 $v_g$ 的值中。\n\n首先，我们计算耦合强度的平方：\n$$|g|^2 = (5.0 \\times 10^{6} \\text{ s}^{-1})^2 = 25 \\times 10^{12} \\text{ s}^{-2} = 2.5 \\times 10^{13} \\text{ s}^{-2}$$\n接下来，我们计算失谐扫描率的大小：\n$$\\left|\\frac{d\\Delta}{dt}\\right| = |\\alpha v_g| = (1.0 \\times 10^{8} \\text{ s}^{-1}\\text{ m}^{-1}) \\times (1.0 \\times 10^{6} \\text{ m s}^{-1}) = 1.0 \\times 10^{14} \\text{ s}^{-2}$$\n现在我们计算指数的无量纲参数，记为 $\\gamma$：\n$$\\gamma = 2\\pi \\frac{|g|^2}{|\\alpha v_g|} = 2\\pi \\frac{2.5 \\times 10^{13} \\text{ s}^{-2}}{1.0 \\times 10^{14} \\text{ s}^{-2}} = 2\\pi (0.25) = \\frac{\\pi}{2}$$\n最后，我们计算模式转换概率：\n$$P_{\\mathrm{conv}} = 1 - \\exp(-\\gamma) = 1 - \\exp\\left(-\\frac{\\pi}{2}\\right)$$\n使用 $\\pi \\approx 3.14159$ 的值，我们得到 $\\pi/2 \\approx 1.57080$。\n$$P_{\\mathrm{conv}} = 1 - \\exp(-1.5707963...) = 1 - 0.2078795... \\approx 0.7921204...$$\n根据问题陈述的要求，将结果四舍五入到四位有效数字，我们得到：\n$$P_{\\mathrm{conv}} \\approx 0.7921$$\n这个结果表明，在这些条件下，大约 $79.21\\%$ 的入射快波功率被转换为了慢波/IBW分支。",
            "answer": "$$\\boxed{0.7921}$$"
        },
        {
            "introduction": "建模的最终目标是定量预测电流驱动的效率。本练习介绍了一种高效且强大的计算工具——伴随方法，用于实现这一目标。通过数值求解一个简化的动理学方程，您将亲手实现现代模拟程序中的核心算法，并分析不同等离子体参数对电流驱动效率 $\\eta$ 的影响，从而深入理解波与粒子相互作用的最终效果 。",
            "id": "3978893",
            "problem": "您正在使用伴随方法模拟均匀磁化等离子体中的快波电流驱动。目标是在一个一维速度空间模型内计算一个无量纲局域效率，该模型需遵循科学真实性，同时在数学上是适定的且在计算上是可行的。考虑平行速度坐标下的稳态、线性化电子动理学，该坐标由 $u$ 定义，并归一化为 $x = u / v_{\\text{th}}$，其中 $v_\\text{th}$ 是电子热速度。设伴随函数 $h(x)$ 是一个一维自伴二阶常微分方程的解，该方程源自线性化Fokker–Planck方程的伴随形式。$h(x)$ 的控制方程为\n$$\n- \\frac{d}{dx} \\left( D(x) \\frac{d h}{dx} \\right) + \\nu(x) h(x) = S_J(x),\n$$\n其中 $D(x)$ 和 $\\nu(x)$ 分别是模拟有效速度空间扩散和有效碰撞弛豫的严格正函数，$S_J(x)$ 是与电流矩相关的源项。假设以下物理上合理且简单的形式：\n$$\nD(x) = \\frac{D_0}{1 + x^3}, \\quad \\nu(x) = \\frac{\\nu_0}{1 + x^3}, \\quad S_J(x) = x,\n$$\n其中 $D_0  0$ 且 $\\nu_0  0$。边界条件为狄利克雷（Dirichlet）边界条件：$h(0) = 0$ 和 $h(x_{\\max}) = 0$，其中 $x_{\\max}  0$ 足够大，以表示对速度空间的截断。代表在共振点 $x_{\\mathrm{res}}$ 附近局域化的准线性快波相互作用的射频（RF）动量沉积剖面，被建模为\n$$\nS_{\\mathrm{RF}}(x) = A \\exp\\left( - \\frac{(x - x_{\\mathrm{res}})^2}{2 \\sigma^2} \\right),\n$$\n其中振幅 $A  0$，共振位置 $x_{\\mathrm{res}}  0$，宽度 $\\sigma  0$。伴随互易性给出了无量纲驱动电流泛函\n$$\nJ = \\int_{0}^{x_{\\max}} h(x)\\, S_{\\mathrm{RF}}(x)\\, dx,\n$$\n以及（在此简化模型中的）无量纲吸收功率为\n$$\nP_{\\mathrm{abs}} = \\int_{0}^{x_{\\max}} x\\, S_{\\mathrm{RF}}(x)\\, dx.\n$$\n将无量纲局域效率定义为\n$$\n\\eta = \\frac{J}{P_{\\mathrm{abs}}},\n$$\n在此归一化模型中，这是一个没有物理单位的纯数。您的任务是通过在均匀网格上使用微分算子的有限体积或保守有限差分离散格式，数值求解 $h(x)$，从而计算出多组参数下的 $\\eta$。使用在 $[0, x_{\\max}]$ 上的 $N$ 个点的网格，其中 $N \\ge 3$ 为整数，间距 $\\Delta x$ 均匀，中点扩散系数为 $D_{i+\\frac{1}{2}} = \\frac{1}{2}\\left(D(x_i) + D(x_{i+1})\\right)$。在节点 $i$（$i = 1, 2, \\ldots, N-2$）处的离散内部方程必须采用以下保守形式\n$$\n- \\frac{1}{\\Delta x} \\left[ D_{i+\\frac{1}{2}} \\frac{h_{i+1} - h_i}{\\Delta x} - D_{i-\\frac{1}{2}} \\frac{h_i - h_{i-1}}{\\Delta x} \\right] + \\nu(x_i) h_i = S_J(x_i),\n$$\n其中 $h_0 = 0$ 且 $h_{N-1} = 0$。使用与节点中心表示相一致的中点法则或梯形法则来计算积分的离散近似值。\n\n实现一个完整的、可运行的程序，该程序能够：\n- 构建网格和系数。\n- 求解生成的关于 $h(x)$ 的三对角线性系统。\n- 计算 $J$ 和 $P_{\\mathrm{abs}}$，并为每个测试用例返回 $\\eta$。\n\n使用以下测试套件，其中包括一般情况、强碰撞性、弱碰撞性、窄射频频谱和近热共振。在所有情况下，设置 $N = 400$ 个网格点。\n\n- 情况1（一般）：$D_0 = 1.0$, $\\nu_0 = 0.3$, $x_{\\mathrm{res}} = 2.0$, $\\sigma = 0.3$, $A = 1.0$, $x_{\\max} = 6.0$, $N = 400$。\n- 情况2（强碰撞性）：$D_0 = 2.0$, $\\nu_0 = 5.0$, $x_{\\mathrm{res}} = 2.0$, $\\sigma = 0.3$, $A = 1.0$, $x_{\\max} = 6.0$, $N = 400$。\n- 情况3（弱碰撞性）：$D_0 = 0.2$, $\\nu_0 = 0.05$, $x_{\\mathrm{res}} = 2.0$, $\\sigma = 0.3$, $A = 1.0$, $x_{\\max} = 6.0$, $N = 400$。\n- 情况4（高速下的窄射频频谱）：$D_0 = 1.0$, $\\nu_0 = 0.3$, $x_{\\mathrm{res}} = 4.0$, $\\sigma = 0.05$, $A = 1.0$, $x_{\\max} = 6.0$, $N = 400$。\n- 情况5（近热共振）：$D_0 = 1.0$, $\\nu_0 = 0.3$, $x_{\\mathrm{res}} = 0.5$, $\\sigma = 0.2$, $A = 1.0$, $x_{\\max} = 6.0$, $N = 400$。\n\n最终输出格式规范：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述五个情况的顺序排列结果，例如 $\\left[ \\eta_1, \\eta_2, \\eta_3, \\eta_4, \\eta_5 \\right]$。每个条目必须是无单位的浮点数。",
            "solution": "该问题要求计算无量纲电流驱动效率 $\\eta$，其定义为驱动电流 $J$ 与吸收功率 $P_{\\mathrm{abs}}$ 之比。这些量通过求解伴随函数 $h(x)$ 的一维二阶常微分方程（ODE），然后计算两个涉及 $h(x)$ 和给定的射频（RF）源项 $S_{\\mathrm{RF}}(x)$ 的积分来确定。\n\n在归一化速度域 $x \\in [0, x_{\\max}]$ 上，伴随函数 $h(x)$ 的控制ODE为：\n$$\n- \\frac{d}{dx} \\left( D(x) \\frac{d h}{dx} \\right) + \\nu(x) h(x) = S_J(x)\n$$\n其边界条件为齐次狄利克雷边界条件 $h(0) = 0$ 和 $h(x_{\\max}) = 0$。系数由 $D(x) = D_0/(1 + x^3)$ 和 $\\nu(x) = \\nu_0/(1 + x^3)$ 给出，源项为 $S_J(x) = x$。\n\n我们将按照以下四个步骤来数值求解此问题：\n1.  使用保守有限差分格式对区域和ODE进行离散化。\n2.  组装生成的三对角线性方程组。\n3.  求解该线性系统以找出网格上伴随函数 $h(x)$ 的值。\n4.  进行数值积分以计算 $J$ 和 $P_{\\mathrm{abs}}$ 及其比值 $\\eta$。\n\n**1. 区域和方程的离散化**\n\n我们将区域 $[0, x_{\\max}]$ 离散化为一个包含 $N$ 个点的均匀网格，$x_i = i \\cdot \\Delta x$，$i = 0, 1, \\dots, N-1$，其中网格间距为 $\\Delta x = x_{\\max} / (N-1)$。函数 $h$ 在每个网格点上的值记为 $h_i = h(x_i)$。边界条件要求 $h_0 = 0$ 和 $h_{N-1} = 0$，剩下 $N-2$ 个未知的内部值 $h_1, h_2, \\dots, h_{N-2}$。\n\n问题为自伴微分算子指定了一个保守有限差分（或有限体积）离散格式。在每个内部网格点 $x_i$（$i = 1, 2, \\dots, N-2$）处，ODE被近似为：\n$$\n- \\frac{1}{\\Delta x} \\left[ D_{i+\\frac{1}{2}} \\frac{h_{i+1} - h_i}{\\Delta x} - D_{i-\\frac{1}{2}} \\frac{h_i - h_{i-1}}{\\Delta x} \\right] + \\nu(x_i) h_i = S_J(x_i)\n$$\n此处，$D_{i \\pm \\frac{1}{2}}$ 表示在网格节点之间中点处计算的扩散系数，由 $D_{i+\\frac{1}{2}} = \\frac{1}{2}(D(x_i) + D(x_{i+1}))$ 给出。\n\n**2. 组装线性系统**\n\n重新整理离散化后的方程，可得到一个形式为 $\\mathbf{A} \\mathbf{h} = \\mathbf{b}$ 的线性系统，其中 $\\mathbf{h} = [h_1, h_2, \\dots, h_{N-2}]^T$ 是未知函数值的向量。对于每一行 $i$（对应于网格点 $x_i$，$i=1, \\dots, N-2$），方程可以写成：\n$$\n\\left(-\\frac{D_{i-\\frac{1}{2}}}{\\Delta x^2}\\right) h_{i-1} + \\left(\\frac{D_{i+\\frac{1}{2}} + D_{i-\\frac{1}{2}}}{\\Delta x^2} + \\nu_i\\right) h_i + \\left(-\\frac{D_{i+\\frac{1}{2}}}{\\Delta x^2}\\right) h_{i+1} = S_J(x_i)\n$$\n边界条件 $h_0=0$ 和 $h_{N-1}=0$ 通过以下方式并入：对于第一个方程（$i=1$），涉及 $h_0$ 的项为零；对于最后一个方程（$i=N-2$），涉及 $h_{N-1}$ 的项为零。\n\n这种结构定义了一个 $(N-2) \\times (N-2)$ 的矩阵 $\\mathbf{A}$，它具有以下特性：\n- **三对角**：每个方程只将 $h_i$ 与其直接相邻的 $h_{i-1}$ 和 $h_{i+1}$ 联系起来。\n- **对称**：第 $i$ 行中 $h_{i+1}$ 的系数是 $-D_{i+1/2}/\\Delta x^2$，而第 $i+1$ 行中 $h_i$ 的系数是 $-D_{(i+1)-1/2}/\\Delta x^2 = -D_{i+1/2}/\\Delta x^2$。非对角线元素是对称的，$A_{i,j} = A_{j,i}$。\n- **严格对角占优**：由于 $D(x)  0$ 和 $\\nu(x)  0$，主对角线元素的绝对值严格大于该行非对角线元素绝对值之和。这保证了矩阵 $\\mathbf{A}$ 是非奇异的，并且该系统有唯一且稳定的解。\n\n矩阵 $\\mathbf{A}$ 的三条非零对角线（对于矩阵索引 $k=0, \\dots, N-3$）为：\n- 主对角线：$A_{k,k} = \\frac{D_{k+3/2} + D_{k+1/2}}{\\Delta x^2} + \\nu_{k+1}$\n- 上对角线：$A_{k, k+1} = -D_{k+3/2}/\\Delta x^2$\n- 下对角线：$A_{k+1, k} = -D_{k+3/2}/\\Delta x^2$\n\n右端向量为 $\\mathbf{b} = [S_J(x_1), S_J(x_2), \\dots, S_J(x_{N-2})]^T$。\n\n**3. 求解线性系统**\n\n鉴于矩阵 $\\mathbf{A}$ 是三对角且对称正定的，系统 $\\mathbf{A} \\mathbf{h} = \\mathbf{b}$ 可以非常高效地求解。我们使用专为带状矩阵优化的数值库函数来求解。求解出内部点 $\\mathbf{h} = [h_1, \\dots, h_{N-2}]$ 后，我们通过在前面加上 $h_0=0$ 并在后面追加 $h_{N-1}=0$ 来重构完整的解向量。\n\n**4. 效率计算**\n\n获得 $h_i$ 的离散解后，我们计算总的无量纲电流 $J$ 和吸收功率 $P_{\\mathrm{abs}}$。积分使用梯形法则进行数值近似，这对于在离散网格点上已知数据的情况是合适的选择。\n首先在网格上计算射频源项：\n$$\nS_{\\mathrm{RF}}(x_i) = A \\exp\\left( - \\frac{(x_i - x_{\\mathrm{res}})^2}{2 \\sigma^2} \\right)\n$$\n然后，积分计算如下：\n$$\nJ = \\int_{0}^{x_{\\max}} h(x) S_{\\mathrm{RF}}(x) dx \\approx \\sum_{i=0}^{N-2} \\frac{h_i S_{\\mathrm{RF}}(x_i) + h_{i+1} S_{\\mathrm{RF}}(x_{i+1})}{2} \\Delta x\n$$\n$$\nP_{\\mathrm{abs}} = \\int_{0}^{x_{\\max}} x S_{\\mathrm{RF}}(x) dx \\approx \\sum_{i=0}^{N-2} \\frac{x_i S_{\\mathrm{RF}}(x_i) + x_{i+1} S_{\\mathrm{RF}}(x_{i+1})}{2} \\Delta x\n$$\n最后，通过比值 $\\eta = J / P_{\\mathrm{abs}}$ 计算无量纲效率。对所提供的五个测试用例中的每一个都重复此完整过程。",
            "answer": "[2.18182245, 0.50550414, 8.87522543, 4.10373408, 0.81230006]"
        }
    ]
}