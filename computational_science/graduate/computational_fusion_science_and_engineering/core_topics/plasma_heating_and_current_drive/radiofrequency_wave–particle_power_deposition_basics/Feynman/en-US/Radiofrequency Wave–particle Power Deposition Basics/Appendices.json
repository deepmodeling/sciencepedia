{
    "hands_on_practices": [
        {
            "introduction": "Before we can model the complex process of power deposition, we must first answer a more fundamental question: can the radiofrequency wave even propagate to the desired region in the plasma? This practice will guide you through a foundational calculation using the cold-plasma model to determine the wave's refractive index. By mastering this calculation, you'll gain insight into the critical concepts of wave propagation, cutoffs, and evanescence that govern wave accessibility in fusion plasmas. ",
            "id": "4037789",
            "problem": "An electromagnetic plane wave of angular frequency $\\omega$ is launched into a spatially uniform, magnetized, fully ionized deuterium plasma with equilibrium electron density $n_{e}$ and equilibrium magnetic field $\\mathbf{B}_{0}$ of magnitude $B$. The wave vector $\\mathbf{k}$ is perpendicular to $\\mathbf{B}_{0}$, so the propagation angle is $\\theta=90^{\\circ}$. Neglect collisions and assume a cold-plasma limit with linear electron-fluid response; further assume that the radiofrequency (RF) wave frequency is much greater than the deuterium ion cyclotron frequency so that ion motion can be neglected in the high-frequency electron response. Starting from Maxwell’s equations and the linearized cold electron-fluid equations, derive the cold-plasma dielectric response sufficient to identify the ordinary mode (O-mode) dispersion relation for $\\theta=90^{\\circ}$. Use this to compute the refractive index magnitude $n$ for the O-mode, and determine whether the O-mode is propagating or evanescent under the given parameters.\n\nUse the following parameters:\n- $\\omega = 2\\pi f$ with $f = 80.0~\\mathrm{GHz}$,\n- $B = 5.00~\\mathrm{T}$,\n- $n_{e} = 5.00 \\times 10^{19}~\\mathrm{m}^{-3}$.\n\nFundamental constants to be used are:\n- electron charge $e$,\n- electron mass $m_{e}$,\n- vacuum permittivity $\\varepsilon_{0}$.\n\nReport the final refractive index magnitude $n$ as a dimensionless number, rounded to four significant figures. State in your reasoning whether the O-mode is propagating or evanescent, based on the sign of the appropriate dispersion quantity at $\\theta=90^{\\circ}$, but provide only the refractive index as the final numerical answer.",
            "solution": "The problem asks for the derivation of the ordinary mode (O-mode) dispersion relation in a cold, magnetized plasma for perpendicular propagation, and the subsequent calculation of the refractive index for a given set of parameters.\n\nFirst, we validate the problem statement.\nThe givens are:\n- Wave angular frequency $\\omega = 2\\pi f$ where $f = 80.0~\\mathrm{GHz} = 8.00 \\times 10^{10}~\\mathrm{Hz}$.\n- Equilibrium electron density $n_{e} = 5.00 \\times 10^{19}~\\mathrm{m}^{-3}$.\n- Equilibrium magnetic field magnitude $B = 5.00~\\mathrm{T}$.\n- The wave vector $\\mathbf{k}$ is perpendicular to the equilibrium magnetic field $\\mathbf{B}_{0}$, so the propagation angle is $\\theta=90^{\\circ}$.\n- The plasma is a fully ionized deuterium plasma.\n- Assumptions: cold-plasma limit, collisionless, linear response, and ion motion is neglected.\nThe problem is scientifically grounded in established plasma physics theory (cold-plasma model and Maxwell's equations). It is well-posed, objective, and provides all necessary data for a unique solution. The parameters are physically realistic for a fusion-grade plasma. The assumption of neglecting ion motion is valid as the wave frequency $\\omega$ is much larger than the deuterium ion cyclotron frequency $\\Omega_D$. Given $\\omega \\approx 5 \\times 10^{11}~\\mathrm{rad/s}$ and $\\Omega_D = eB/m_D \\approx 2.4 \\times 10^8~\\mathrm{rad/s}$ (where $m_D \\approx 2 m_p$), we have $\\omega \\gg \\Omega_D$. Thus, the problem is deemed valid.\n\nWe begin the derivation from the linearized equation of motion for the electron fluid in a cold, collisionless plasma. For a wave with time dependence $\\exp(-i\\omega t)$, the equation is:\n$$ -i\\omega m_{e} \\mathbf{v}_{1} = -e(\\mathbf{E}_{1} + \\mathbf{v}_{1} \\times \\mathbf{B}_{0}) $$\nwhere $\\mathbf{v}_{1}$ and $\\mathbf{E}_{1}$ are the first-order perturbed electron velocity and electric field, respectively. $m_e$ is the electron mass, $e$ is the elementary charge, and $\\mathbf{B}_{0}$ is the equilibrium magnetic field.\n\nThe perturbed current density is given by $\\mathbf{J}_{1} = -n_{e} e \\mathbf{v}_{1}$. By solving the equation of motion for $\\mathbf{v}_{1}$ in terms of $\\mathbf{E}_{1}$, we can find the conductivity tensor $\\sigma$ defined by $\\mathbf{J}_{1} = \\sigma \\cdot \\mathbf{E}_{1}$. The dielectric tensor $\\epsilon$ is then related to the conductivity tensor by:\n$$ \\epsilon = \\mathbf{I} + \\frac{i}{\\omega \\varepsilon_{0}} \\sigma $$\nwhere $\\mathbf{I}$ is the identity tensor and $\\varepsilon_{0}$ is the vacuum permittivity.\n\nLet's establish a coordinate system where $\\mathbf{B}_{0} = B \\hat{\\mathbf{z}}$. The resulting dielectric tensor for a cold plasma is:\n$$ \\epsilon = \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix} $$\nThe components $S$, $D$, and $P$ are the Stix parameters, defined as:\n$$ S = 1 - \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} $$\n$$ D = \\frac{\\omega_{ce}}{\\omega} \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} $$\n$$ P = 1 - \\frac{\\omega_{pe}^2}{\\omega^2} $$\nHere, $\\omega_{pe} = \\sqrt{\\frac{n_{e}e^2}{m_{e}\\varepsilon_{0}}}$ is the electron plasma frequency and $\\omega_{ce} = \\frac{eB}{m_{e}}$ is the electron cyclotron frequency.\n\nThe wave equation derived from Maxwell's equations for a plane wave of the form $\\exp(i\\mathbf{k} \\cdot \\mathbf{r} - i\\omega t)$ in a medium described by $\\epsilon$ is:\n$$ \\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}_{1}) + \\frac{\\omega^2}{c^2} \\epsilon \\cdot \\mathbf{E}_{1} = 0 $$\nUsing the vector identity $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$ and defining the refractive index vector $\\mathbf{n} = \\frac{c}{\\omega}\\mathbf{k}$, the wave equation becomes:\n$$ \\left( \\mathbf{n}\\mathbf{n} - n^2 \\mathbf{I} + \\epsilon \\right) \\cdot \\mathbf{E}_{1} = 0 $$\nwhere $n = |\\mathbf{n}|$.\n\nFor propagation perpendicular to the magnetic field, $\\mathbf{k} \\perp \\mathbf{B}_{0}$. We chose $\\mathbf{B}_{0}$ along $\\hat{\\mathbf{z}}$, so $\\mathbf{k}$ must lie in the $xy$-plane. Without loss of generality, let $\\mathbf{k} = k \\hat{\\mathbf{x}}$. Then the refractive index vector is $\\mathbf{n} = n \\hat{\\mathbf{x}} = (n, 0, 0)$. The tensor $\\mathbf{n}\\mathbf{n}$ is:\n$$ \\mathbf{n}\\mathbf{n} = \\begin{pmatrix} n^2  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\nSubstituting this into the wave equation yields the matrix system for $\\mathbf{E}_{1} = (E_x, E_y, E_z)$:\n$$ \\begin{pmatrix} S  -iD  0 \\\\ iD  S-n^2  0 \\\\ 0  0  P-n^2 \\end{pmatrix} \\begin{pmatrix} E_x \\\\ E_y \\\\ E_z \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\nFor a non-trivial solution for $\\mathbf{E}_{1}$, the determinant of the matrix must be zero:\n$$ \\det \\begin{pmatrix} S  -iD  0 \\\\ iD  S-n^2  0 \\\\ 0  0  P-n^2 \\end{pmatrix} = (P - n^2) [S(S-n^2) - (-iD)(iD)] = (P - n^2)(S^2 - n^2S - D^2) = 0 $$\nThis equation yields two decoupled modes:\n1.  Ordinary mode (O-mode): $P - n^2 = 0$. This mode solution has $E_x=E_y=0$ and $E_z \\neq 0$. The electric field of the wave is parallel to the background magnetic field ($\\mathbf{E}_{1} \\parallel \\mathbf{B}_{0}$).\n2.  Extraordinary mode (X-mode): $S^2 - n^2S - D^2 = 0$. This mode solution has $E_z=0$ ($\\mathbf{E}_{1} \\perp \\mathbf{B}_{0}$).\n\nThe problem requests the analysis of the O-mode. The dispersion relation is:\n$$ n^2 = P = 1 - \\frac{\\omega_{pe}^2}{\\omega^2} $$\nThis relation shows that the O-mode is not affected by the magnetic field for perpendicular propagation, as the electron motion driven by $\\mathbf{E}_1$ is along the magnetic field lines, so the Lorentz force term $\\mathbf{v}_1 \\times \\mathbf{B}_0$ vanishes.\n\nA wave is propagating if its wave number is real, which corresponds to $n^2  0$. For the O-mode, this condition is:\n$$ 1 - \\frac{\\omega_{pe}^2}{\\omega^2}  0 \\implies \\omega^2  \\omega_{pe}^2 \\implies \\omega  \\omega_{pe} $$\nSo, the wave propagates if its frequency $\\omega$ is above the electron plasma frequency $\\omega_{pe}$, which serves as a cutoff frequency. If $\\omega  \\omega_{pe}$, $n^2$ is negative, $n$ is imaginary, and the wave is evanescent.\n\nNow we compute the numerical values.\nThe wave frequency is $\\omega = 2\\pi f = 2\\pi(8.00 \\times 10^{10}~\\mathrm{s}^{-1}) \\approx 5.0265 \\times 10^{11}~\\mathrm{rad/s}$.\nThe square of the wave frequency is $\\omega^2 \\approx 2.5266 \\times 10^{23}~\\mathrm{s}^{-2}$.\n\nThe square of the electron plasma frequency is:\n$$ \\omega_{pe}^2 = \\frac{n_{e}e^2}{m_{e}\\varepsilon_{0}} = \\frac{(5.00 \\times 10^{19}~\\mathrm{m}^{-3})(1.602177 \\times 10^{-19}~\\mathrm{C})^2}{(9.109384 \\times 10^{-31}~\\mathrm{kg})(8.854188 \\times 10^{-12}~\\mathrm{F/m})} $$\n$$ \\omega_{pe}^2 \\approx 1.5913 \\times 10^{23}~\\mathrm{s}^{-2} $$\nComparing the frequencies, we have $\\omega^2 \\approx 2.5266 \\times 10^{23}~\\mathrm{s}^{-2}$ and $\\omega_{pe}^2 \\approx 1.5913 \\times 10^{23}~\\mathrm{s}^{-2}$. Since $\\omega^2  \\omega_{pe}^2$, the condition for propagation is met. The O-mode is a propagating wave under these parameters.\n\nFinally, we calculate the refractive index magnitude $n$ for the O-mode:\n$$ n^2 = 1 - \\frac{\\omega_{pe}^2}{\\omega^2} \\approx 1 - \\frac{1.5913 \\times 10^{23}}{2.5266 \\times 10^{23}} \\approx 1 - 0.62985 $$\n$$ n^2 \\approx 0.37015 $$\nTaking the square root to find the magnitude of the refractive index:\n$$ n = \\sqrt{0.37015} \\approx 0.608399 $$\nRounding to four significant figures, the refractive index magnitude is $0.6084$.",
            "answer": "$$\\boxed{0.6084}$$"
        },
        {
            "introduction": "Once a wave gains access to the plasma, our focus shifts to modeling how its energy is absorbed by the particles. This hands-on coding exercise challenges you to implement a simplified but powerful model of power deposition based on the Beer-Lambert law for wave attenuation. By translating the governing equations for plasma profiles and absorption into a numerical algorithm, you will compute the ECRH power deposition profile, a critical quantity for designing and interpreting fusion experiments. ",
            "id": "4037839",
            "problem": "You are tasked with computing the deposited Electron Cyclotron Resonance Heating (ECRH) power profile using Beer–Lambert attenuation along a simplified straight radial ray trajectory in a toroidal plasma (tokamak) with given electron density and temperature profiles and launching geometry. The calculation must be performed from first principles grounded in conservation of electromagnetic energy flux and local absorption, using a physically plausible, self-consistent model.\n\nThe fundamental base to be used includes:\n- Conservation of energy flux for electromagnetic waves along a ray, leading to the Beer–Lambert law for attenuation.\n- Definition of local absorption described by an absorption coefficient that depends on local plasma conditions and resonance detuning.\n\nAssume a circular cross-section tokamak with minor radius $a$ in $\\mathrm{m}$, and model the electron density and electron temperature profiles as\n$$\nn_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\beta}, \\quad 0 \\le r \\le a,\n$$\n$$\nT_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\gamma}, \\quad 0 \\le r \\le a,\n$$\nwith $n_e(r) = 0$ and $T_e(r) = 0$ outside $0 \\le r \\le a$. Let the local absorption coefficient be modeled as\n$$\n\\alpha(r) = \\alpha_0 \\left(\\frac{n_e(r)}{n_{\\mathrm{ref}}}\\right) \\left(\\frac{T_{\\mathrm{ref}}}{T_e(r)}\\right) \\exp\\left(-\\frac{(r - r_{\\mathrm{res}})^2}{2\\sigma_{\\mathrm{res}}^2}\\right),\n$$\nwith $\\alpha(r)$ in $\\mathrm{m}^{-1}$, where $n_{\\mathrm{ref}}$ in $\\mathrm{m}^{-3}$ and $T_{\\mathrm{ref}}$ in $\\mathrm{eV}$ are reference values used to normalize the coefficient. The resonance center is at radius $r_{\\mathrm{res}}$ in $\\mathrm{m}$, with resonance width $\\sigma_{\\mathrm{res}}$ in $\\mathrm{m}$. This form captures the basic radiofrequency wave–particle resonance physics by modulating absorption with proximity to the cyclotron resonance and with local plasma parameters.\n\nAssume a single, straight radial ray is launched at the outboard edge with initial radius $r = a$, propagating inward toward $r = 0$ with path length parameter $s$ in $\\mathrm{m}$ satisfying $dr/ds = -1$. Let the initial beam power at launch be $P_0$ in $\\mathrm{W}$. Under Beer–Lambert attenuation, the power carried by the ray obeys\n$$\n\\frac{dI}{ds} = -\\alpha(r(s)) I(s),\n$$\nwhere $I(s)$ is the local wave power along the ray and $\\alpha(r)$ is as defined above. The absorbed power per unit path length is then $dP_{\\mathrm{abs}}/ds = \\alpha(r(s)) I(s)$. Discretize the path $s \\in [0, a]$ using $N_s$ uniform steps of size $ds = a/N_s$, and bin the deposited power into $N_r$ uniform radial bins covering $r \\in [0, a]$ of width $dr = a/N_r$ to form a deposited power density per unit radius profile $p(r)$ in $\\mathrm{W}/\\mathrm{m}$ such that its integral over $r$ equals the total absorbed power. In discrete form, at each step $i$ with mid-step radius $r_i$, the absorbed power is\n$$\n\\Delta P_{\\mathrm{abs}, i} = I_i \\left(1 - e^{-\\alpha(r_i) ds}\\right),\n$$\nwith the update $I_{i+1} = I_i - \\Delta P_{\\mathrm{abs}, i}$.\n\nFor each test case, compute:\n1. The absorbed fraction $f_{\\mathrm{abs}} = P_{\\mathrm{abs}}/P_0$ (dimensionless decimal).\n2. The radius of peak deposition $r_{\\mathrm{peak}}$ in $\\mathrm{m}$, defined as the bin center at which $p(r)$ attains its maximum value.\n3. The full width at half maximum $w_{\\mathrm{FWHM}}$ in $\\mathrm{m}$ of $p(r)$, computed using linear interpolation between radial bins to determine the two radii where $p(r)$ crosses half the peak value; if the profile does not cross on both sides, define $w_{\\mathrm{FWHM}} = 0$.\n\nYour program must implement this model and produce results for the following test suite. Use exactly these parameter values for each case.\n\nTest case $1$ (general \"happy path\"):\n- Minor radius: $a = 0.5\\,\\mathrm{m}$.\n- Launch power: $P_0 = 1.0 \\times 10^{6}\\,\\mathrm{W}$.\n- Electron density: $n_0 = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $\\beta = 0.8$.\n- Electron temperature: $T_0 = 3500\\,\\mathrm{eV}$, $\\gamma = 1.2$.\n- Absorption normalization: $n_{\\mathrm{ref}} = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_{\\mathrm{ref}} = 3500\\,\\mathrm{eV}$.\n- Absorption parameters: $\\alpha_0 = 1.2\\,\\mathrm{m}^{-1}$, $r_{\\mathrm{res}} = 0.1\\,\\mathrm{m}$, $\\sigma_{\\mathrm{res}} = 0.07\\,\\mathrm{m}$.\n- Discretization: $N_s = 4000$, $N_r = 800$.\n\nTest case $2$ (off-axis, narrower resonance):\n- Minor radius: $a = 0.5\\,\\mathrm{m}$.\n- Launch power: $P_0 = 0.75 \\times 10^{6}\\,\\mathrm{W}$.\n- Electron density: $n_0 = 5.5 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $\\beta = 1.0$.\n- Electron temperature: $T_0 = 3000\\,\\mathrm{eV}$, $\\gamma = 1.4$.\n- Absorption normalization: $n_{\\mathrm{ref}} = 5.5 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_{\\mathrm{ref}} = 3000\\,\\mathrm{eV}$.\n- Absorption parameters: $\\alpha_0 = 0.9\\,\\mathrm{m}^{-1}$, $r_{\\mathrm{res}} = 0.3\\,\\mathrm{m}$, $\\sigma_{\\mathrm{res}} = 0.05\\,\\mathrm{m}$.\n- Discretization: $N_s = 5000$, $N_r = 1000$.\n\nTest case $3$ (edge case: weak absorption, resonance outside plasma):\n- Minor radius: $a = 0.5\\,\\mathrm{m}$.\n- Launch power: $P_0 = 1.0 \\times 10^{6}\\,\\mathrm{W}$.\n- Electron density: $n_0 = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $\\beta = 0.8$.\n- Electron temperature: $T_0 = 3500\\,\\mathrm{eV}$, $\\gamma = 1.2$.\n- Absorption normalization: $n_{\\mathrm{ref}} = 6.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$, $T_{\\mathrm{ref}} = 3500\\,\\mathrm{eV}$.\n- Absorption parameters: $\\alpha_0 = 0.05\\,\\mathrm{m}^{-1}$, $r_{\\mathrm{res}} = 0.6\\,\\mathrm{m}$, $\\sigma_{\\mathrm{res}} = 0.08\\,\\mathrm{m}$.\n- Discretization: $N_s = 4000$, $N_r = 800$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case contributing a sub-list of the form $[f_{\\mathrm{abs}}, r_{\\mathrm{peak}}, w_{\\mathrm{FWHM}}]$ and no spaces, for example: $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3]]$. Express $r_{\\mathrm{peak}}$ and $w_{\\mathrm{FWHM}}$ in $\\mathrm{m}$ and $f_{\\mathrm{abs}}$ as a decimal. Angles are not used in this problem. Percentages must not be used; express $f_{\\mathrm{abs}}$ as a decimal between $0$ and $1$.",
            "solution": "### Problem Validation\n\n#### Step 1: Extract Givens\n\nThe problem provides the following explicit definitions, equations, and initial conditions:\n\n1.  **Tokamak and Plasma Profiles**:\n    -   Minor radius: $a$ in $\\mathrm{m}$.\n    -   Electron density profile: $n_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\beta}$ for $0 \\le r \\le a$.\n    -   Electron temperature profile: $T_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^{\\gamma}$ for $0 \\le r \\le a$.\n    -   Outside the plasma ($r  a$): $n_e(r) = 0$ and $T_e(r) = 0$.\n\n2.  **Absorption Coefficient**:\n    -   Local absorption coefficient model: $\\alpha(r) = \\alpha_0 \\left(\\frac{n_e(r)}{n_{\\mathrm{ref}}}\\right) \\left(\\frac{T_{\\mathrm{ref}}}{T_e(r)}\\right) \\exp\\left(-\\frac{(r - r_{\\mathrm{res}})^2}{2\\sigma_{\\mathrm{res}}^2}\\right)$, with units of $\\mathrm{m}^{-1}$.\n    -   Reference parameters: $n_{\\mathrm{ref}}$ (in $\\mathrm{m}^{-3}$), $T_{\\mathrm{ref}}$ (in $\\mathrm{eV}$), $\\alpha_0$ (in $\\mathrm{m}^{-1}$), $r_{\\mathrm{res}}$ (in $\\mathrm{m}$), and $\\sigma_{\\mathrm{res}}$ (in $\\mathrm{m}$).\n\n3.  **Wave Propagation and Power Deposition**:\n    -   Ray trajectory: Straight radial path from $r=a$ to $r=0$.\n    -   Path parameterization: $s$ in $\\mathrm{m}$, with $dr/ds = -1$.\n    -   Initial power: $P_0$ in $\\mathrm{W}$ at $s=0$ (i.e., $r=a$).\n    -   Power attenuation law (Beer–Lambert): $\\frac{dI}{ds} = -\\alpha(r(s)) I(s)$, where $I(s)$ is the local power.\n    -   Absorbed power per unit path length: $dP_{\\mathrm{abs}}/ds = \\alpha(r(s)) I(s)$.\n\n4.  **Numerical Discretization**:\n    -   Path discretization: $N_s$ uniform steps of size $ds = a/N_s$.\n    -   Radial binning: $N_r$ uniform bins of width $dr = a/N_r$.\n    -   Discrete absorbed power per step: $\\Delta P_{\\mathrm{abs}, i} = I_i \\left(1 - e^{-\\alpha(r_i) ds}\\right)$ at mid-step radius $r_i$.\n    -   Power update rule: $I_{i+1} = I_i - \\Delta P_{\\mathrm{abs}, i}$.\n\n5.  **Required Outputs**:\n    -   Absorbed fraction: $f_{\\mathrm{abs}} = P_{\\mathrm{abs}}/P_0$.\n    -   Radius of peak deposition: $r_{\\mathrm{peak}}$, the center of the bin where the power density profile $p(r)$ is maximum.\n    -   Full Width at Half Maximum: $w_{\\mathrm{FWHM}}$ of $p(r)$, with a special condition ($w_{\\mathrm{FWHM}}=0$) if the profile does not cross the half-maximum threshold on both sides of the peak.\n\n#### Step 2: Validate Using Extracted Givens\n\nThe problem is evaluated against the validation criteria:\n\n-   **Scientifically Grounded**: The problem is based on the fundamental principle of energy flux conservation leading to the Beer–Lambert law for wave attenuation, a core concept in physics. The application context is Electron Cyclotron Resonance Heating (ECRH) in a tokamak, a valid topic in computational fusion science. The plasma profiles ($n_e, T_e$) are standard, simplified models. The absorption coefficient $\\alpha(r)$ is a given phenomenological model. While its dependence on temperature as $1/T_e$ is not typical for standard ECRH theory (which often scales with positive powers of $T_e$), it does not violate any fundamental physical laws and is provided as an explicit definition for this problem. As such, the problem is a valid exercise in implementing a given, self-consistent physical model.\n\n-   **Well-Posed**: The problem is well-posed. The governing ordinary differential equation for power has a unique solution for the given initial condition. The numerical task is clearly defined with all necessary parameters, initial conditions, and discretization rules. The requested outputs are unambiguously defined.\n\n-   **Objective**: The problem statement is written in precise, objective language. All parameters are given as concrete numerical values, and all functional forms are explicit mathematical equations. There is no subjective or opinion-based content.\n\nThe problem does not exhibit any invalidity flaws. It is a self-contained, scientifically consistent, and well-posed numerical problem.\n\n#### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A solution will be provided.\n\n### Solution Design\n\nThe solution implements a numerical simulation of radiofrequency wave power deposition along a straight radial path in a tokamak plasma. The algorithm proceeds as follows:\n\n1.  **Discretization Setup**: The radial domain from $r=0$ to $r=a$ is discretized into $N_r$ uniform bins of width $dr = a/N_r$. The bin centers are stored. The ray path from $s=0$ (at $r=a$) to $s=a$ (at $r=0$) is discretized into $N_s$ steps of size $ds = a/N_s$. An array of mid-step radii, $r_{i} = a - (i+0.5)ds$ for $i=0, \\dots, N_s-1$, is created.\n\n2.  **Plasma and Absorption Profile Calculation**: To optimize the computation, the plasma parameters and the absorption coefficient are pre-calculated for all mid-step radii.\n    -   The electron density $n_e(r_i)$ and temperature $T_e(r_i)$ are computed for all $r_i$ using the given profile equations. This is done in a vectorized fashion using `numpy` for efficiency.\n    -   The absorption coefficient $\\alpha(r_i)$ is then computed for all $r_i$ using its definition, which depends on the pre-calculated $n_e(r_i)$ and $T_e(r_i)$ values. Since all $r_i$ are strictly within the domain $(0, a)$, singularities at $r=a$ (where $T_e=0$) are naturally avoided.\n\n3.  **Power Attenuation Simulation**: The core of the simulation is an iterative loop over the $N_s$ path steps.\n    -   The wave power $I$ is initialized to the launch power $P_0$. A variable for total absorbed power, $P_{\\mathrm{abs\\_total}}$, is initialized to $0$. An array to store the power deposited in each radial bin, `p_deposited_bins`, is initialized to zeros.\n    -   The loop iterates from $i=0$ to $N_s-1$. In each step $i$:\n        -   The power absorbed, $\\Delta P_{\\mathrm{abs}, i}$, is calculated. The discrete formula $I_i (1 - e^{-\\alpha(r_i) ds})$ is equivalent to solving the Beer-Lambert law exactly over a step with constant $\\alpha$. For numerical stability with small arguments, this is computed as $-I_i \\cdot \\mathrm{expm1}(-\\alpha(r_i) ds)$, where `expm1(x)` computes $e^x - 1$ accurately.\n        -   The ray power is updated for the next step: $I_{i+1} = I_i - \\Delta P_{\\mathrm{abs}, i}$.\n        -   The total absorbed power is accumulated: $P_{\\mathrm{abs\\_total}} = P_{\\mathrm{abs\\_total}} + \\Delta P_{\\mathrm{abs}, i}$.\n        -   The calculated $\\Delta P_{\\mathrm{abs}, i}$ is added to the corresponding radial bin. The bin index $j$ is determined by the mid-step radius $r_i$ via $j = \\lfloor r_i / dr \\rfloor$.\n\n4.  **Calculation of Output Metrics**: After the simulation loop completes, the final results are derived from the accumulated data.\n    -   **Power Density Profile**: The total power deposited in each bin is divided by the bin width $dr$ to obtain the power density profile $p(r)$ in $\\mathrm{W}/\\mathrm{m}$.\n    -   **Absorbed Fraction ($f_{\\mathrm{abs}}$)**: This is computed as the total absorbed power divided by the initial power: $f_{\\mathrm{abs}} = P_{\\mathrm{abs\\_total}} / P_0$.\n    -   **Peak Deposition Radius ($r_{\\mathrm{peak}}$)**: The index of the maximum value in the power density profile $p(r)$ is found. $r_{\\mathrm{peak}}$ is the radial coordinate of the center of this bin.\n    -   **Full Width at Half Maximum ($w_{\\mathrm{FWHM}}$)**:\n        -   The peak power density $p_{\\mathrm{max}}$ and the half-maximum value $p_{\\mathrm{half}} = p_{\\mathrm{max}}/2$ are determined.\n        -   If $p_{\\mathrm{max}} = 0$, $w_{\\mathrm{FWHM}}$ is $0$.\n        -   The algorithm searches for the two radii, $r_1  r_{\\mathrm{peak}}$ and $r_2  r_{\\mathrm{peak}}$, where the profile crosses $p_{\\mathrm{half}}$.\n        -   The left crossing $r_1$ is found by searching inward from the peak and performing linear interpolation between the two bin centers that straddle $p_{\\mathrm{half}}$.\n        -   The right crossing $r_2$ is found by searching outward from the peak and using similar linear interpolation.\n        -   If both crossings are successfully found, $w_{\\mathrm{FWHM}} = r_2 - r_1$. Otherwise, as per the problem definition, $w_{\\mathrm{FWHM}}=0$.\n\nThis structured approach ensures that all aspects of the problem are addressed correctly and efficiently, leading to an accurate computation of the required physical quantities.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the ECRH power deposition simulation for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: General \"happy path\"\n        {\n            'a': 0.5, 'P0': 1.0e6, 'n0': 6.0e19, 'beta': 0.8, 'T0': 3500.0, 'gamma': 1.2,\n            'n_ref': 6.0e19, 'T_ref': 3500.0, 'alpha0': 1.2, 'r_res': 0.1, 'sigma_res': 0.07,\n            'Ns': 4000, 'Nr': 800\n        },\n        # Case 2: Off-axis, narrower resonance\n        {\n            'a': 0.5, 'P0': 0.75e6, 'n0': 5.5e19, 'beta': 1.0, 'T0': 3000.0, 'gamma': 1.4,\n            'n_ref': 5.5e19, 'T_ref': 3000.0, 'alpha0': 0.9, 'r_res': 0.3, 'sigma_res': 0.05,\n            'Ns': 5000, 'Nr': 1000\n        },\n        # Case 3: Edge case: weak absorption, resonance outside plasma\n        {\n            'a': 0.5, 'P0': 1.0e6, 'n0': 6.0e19, 'beta': 0.8, 'T0': 3500.0, 'gamma': 1.2,\n            'n_ref': 6.0e19, 'T_ref': 3500.0, 'alpha0': 0.05, 'r_res': 0.6, 'sigma_res': 0.08,\n            'Ns': 4000, 'Nr': 800\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_deposition_profile(**params)\n        results.append(result)\n\n    formatted_sublists = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in results]\n    print(f\"[{','.join(formatted_sublists)}]\")\n\ndef compute_deposition_profile(a, P0, n0, beta, T0, gamma, n_ref, T_ref, alpha0, r_res, sigma_res, Ns, Nr):\n    \"\"\"\n    Computes the ECRH power deposition profile and derived metrics for a single case.\n    \"\"\"\n    # 1. Discretization Setup\n    ds = a / Ns\n    dr = a / Nr\n    \n    # Mid-points of path steps\n    s_mids = (np.arange(Ns) + 0.5) * ds\n    r_mids = a - s_mids\n    \n    # Centers of radial bins\n    r_bin_centers = (np.arange(Nr) + 0.5) * dr\n\n    # 2. Profile and Coefficient Calculation (Vectorized)\n    r_norm_sq = (r_mids / a)**2\n    \n    # The term 1 - r_norm_sq is always  0 for mid-points\n    # as r_mids is always in (0, a)\n    profile_factor = 1.0 - r_norm_sq\n    \n    ne_vals = n0 * (profile_factor**beta)\n    Te_vals = T0 * (profile_factor**gamma)\n    \n    # Ensure no division by zero, although not expected with this discretization\n    Te_vals[Te_vals  1e-12] = 1e-12\n\n    alpha_vals = alpha0 * (ne_vals / n_ref) * (T_ref / Te_vals) * \\\n                 np.exp(-((r_mids - r_res)**2) / (2 * sigma_res**2))\n\n    # 3. Power Attenuation Simulation\n    I = P0\n    p_abs_total = 0.0\n    p_deposited_bins = np.zeros(Nr)\n\n    for i in range(Ns):\n        alpha_r = alpha_vals[i]\n        \n        # Power absorbed in this step, using expm1 for numerical stability\n        delta_p_abs = I * (-np.expm1(-alpha_r * ds))\n        \n        I -= delta_p_abs\n        p_abs_total += delta_p_abs\n        \n        # Bin the deposited power\n        r_mid = r_mids[i]\n        bin_idx = int(r_mid / dr)\n        if 0 = bin_idx  Nr:\n            p_deposited_bins[bin_idx] += delta_p_abs\n\n    # 4. Calculation of Output Metrics\n    f_abs = p_abs_total / P0 if P0  0 else 0.0\n    \n    if p_abs_total  1e-9:\n        return [f_abs, 0.0, 0.0]\n\n    p_profile = p_deposited_bins / dr\n\n    # Radis of peak deposition\n    j_max = np.argmax(p_profile)\n    r_peak = r_bin_centers[j_max]\n    \n    # FWHM\n    p_max = p_profile[j_max]\n    if p_max == 0:\n        return [f_abs, r_peak, 0.0]\n\n    p_half = p_max / 2.0\n    \n    r1, r2 = None, None\n    \n    # Find left crossing point r1 (from peak towards core)\n    # Check if profile at r=0 is already below half max\n    if p_profile[0] = p_half:\n        for j in range(j_max, 0, -1):\n            if p_profile[j]  p_half and p_profile[j-1] = p_half:\n                p_hi, p_lo = p_profile[j], p_profile[j-1]\n                r_hi, r_lo = r_bin_centers[j], r_bin_centers[j-1]\n                r1 = r_lo + (r_hi - r_lo) * (p_half - p_lo) / (p_hi - p_lo)\n                break\n                \n    # Find right crossing point r2 (from peak towards edge)\n    # Check if profile at r=a is already below half max\n    if p_profile[-1] = p_half:\n        for j in range(j_max, Nr - 1):\n            if p_profile[j]  p_half and p_profile[j+1] = p_half:\n                p_hi, p_lo = p_profile[j], p_profile[j+1]\n                r_hi, r_lo = r_bin_centers[j], r_bin_centers[j+1]\n                r2 = r_hi + (r_lo - r_hi) * (p_half - p_hi) / (p_lo - p_hi)\n                break\n\n    w_fwhm = 0.0\n    if r1 is not None and r2 is not None:\n        w_fwhm = r2 - r1\n        \n    return [f_abs, r_peak, w_fwhm]\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "A computational model is only as reliable as our understanding of its inherent limitations, and this exercise moves from implementing a model to critically analyzing its fidelity. You will explore how discretizing Maxwell's equations on a grid introduces non-physical effects that can alter the simulated wave properties, a phenomenon known as numerical dispersion. Understanding this concept is crucial, as it can lead to significant errors in the predicted location and magnitude of power deposition, especially for the high-wavenumber waves common in RF scenarios. ",
            "id": "4037804",
            "problem": "Consider a magnetized plasma in which a high-wavenumber radiofrequency (RF) wave is launched parallel to the background magnetic field. The wave–particle interaction responsible for power deposition is dominated by a parallel Landau resonance, which occurs where the resonance condition $ \\omega - k_{\\parallel} v_{\\parallel} = 0 $ is met for electrons with parallel velocity $ v_{\\parallel} $, with RF frequency $ \\omega $ assumed fixed. A computational full-wave solver discretizes Maxwell’s equations on a uniform Cartesian grid using lowest-order central differences in space and a leapfrog time advance, such as in the standard Yee Finite-Difference Time-Domain (FDTD) scheme. \n\nStarting from Maxwell’s equations in vacuum, $ \\nabla \\times \\mathbf{E} = - \\partial_t \\mathbf{B} $ and $ \\nabla \\times \\mathbf{B} = \\mu_0 \\epsilon_0 \\partial_t \\mathbf{E} $, and the plane-wave ansatz $ \\mathbf{E}, \\mathbf{B} \\propto \\exp\\left(i(k x - \\omega t)\\right) $, the continuous dispersion relation is $ \\omega = c k $ for propagation along $ x $. In a discrete solver, the spatial and temporal operators are replaced by finite differences over grid spacing $ \\Delta x $ and time step $ \\Delta t $, respectively, which generally alter the phase relation between $ \\omega $ and $ k $. This alteration is referred to as numerical dispersion.\n\nIn what follows, focus on a one-dimensional vacuum propagation along $ x $ to isolate the effect of numerical dispersion arising from discretization. Do not introduce any model-specific short-cut relations; instead, reason from the above governing laws and definitions. Use the derived discrete plane-wave relation to estimate the effective wavenumber as seen by the discrete scheme, and then assess the impact of this effect on predicted wave–particle power deposition when $k \\Delta x$ is not asymptotically small.\n\nAssume a case where the physical wave has $ k \\Delta x = 0.6 $ on the chosen grid. From the discrete relations you derive, estimate the fractional error in the effective wavenumber $ k_{\\mathrm{eff}} $ relative to $ k $ and explain qualitatively how this error propagates into the spatial localization of the resonance $ \\omega - k_{\\parallel} v_{\\parallel} = 0 $ and hence the predicted power deposition profile. Then, select all statements that are consistent with a correct definition of numerical dispersion and its impact on full-wave solutions and power deposition for high-$k$ RF waves in discretized models:\n\nA. Numerical dispersion is the spurious dependence of the numerical $ \\omega(\\mathbf{k}) $ relation on $ \\Delta x $ and $ \\Delta t $, causing phase and group velocity errors that accumulate along propagation. When $k \\Delta x$ is not $\\ll 1$, these errors shift turning points and resonances, displacing the wave–particle interaction region and thereby the predicted power deposition.\n\nB. Numerical dispersion affects only amplitude through stability constraints and leaves phase propagation and ray trajectories unaffected, so power deposition predictions for high-$k$ waves remain accurate even when $ k \\Delta x $ is $ O(1) $.\n\nC. In a one-dimensional vacuum Yee FDTD scheme, the discrete plane-wave relation implies an effective wavenumber mapping $ k \\mapsto k_{\\mathrm{eff}}(k, \\Delta x) $ that underestimates $ k $ when $ k \\Delta x $ is finite. For $ k \\Delta x = 0.6 $, the fractional wavenumber error is a few percent negative, shifting the resonant velocity $ v_{\\parallel} $ inferred from $ \\omega - k_{\\parallel} v_{\\parallel} = 0 $ and hence altering the power deposition profile location and width.\n\nD. Numerical dispersion acts like a uniform, wavenumber-independent damping term in the equations, increasing predicted power deposition everywhere without changing its spatial distribution.\n\nE. Even with dispersion-reducing high-order spatial differencing, the grid can introduce direction-dependent phase errors in magnetized plasmas if the grid does not adequately resolve the field-aligned direction. For high-$k$ waves, insufficient alignment or resolution of the parallel direction can distort $ k_{\\parallel} $ and thereby the computed deposition profile, although accurate positioning of resonances is achievable when phase errors are controlled so that $k \\Delta x$ need not be $\\ll 1$.",
            "solution": "The problem statement is critically evaluated for validity before proceeding to a solution.\n\n### Step 1: Extract Givens\n-   **System:** A magnetized plasma.\n-   **Wave Properties:** A high-wavenumber radiofrequency (RF) wave with fixed frequency $ \\omega $. It is launched parallel to the background magnetic field.\n-   **Interaction Physics:** Wave-particle power deposition is dominated by parallel Landau resonance.\n-   **Resonance Condition:** $ \\omega - k_{\\parallel} v_{\\parallel} = 0 $, where $ k_{\\parallel} $ is the parallel wavenumber and $ v_{\\parallel} $ is the electron parallel velocity.\n-   **Computational Method:** A full-wave solver using a uniform Cartesian grid, lowest-order central differences in space, and a leapfrog time advance (Yee Finite-Difference Time-Domain, FDTD).\n-   **Governing Equations (Vacuum):** $ \\nabla \\times \\mathbf{E} = - \\partial_t \\mathbf{B} $ and $ \\nabla \\times \\mathbf{B} = \\mu_0 \\epsilon_0 \\partial_t \\mathbf{E} $.\n-   **Wave Ansatz:** $ \\mathbf{E}, \\mathbf{B} \\propto \\exp\\left(i(k x - \\omega t)\\right) $.\n-   **Continuous Dispersion Relation (1D Vacuum):** $ \\omega = c k $ for propagation along $ x $.\n-   **Numerical Discretization:** Finite differences over grid spacing $ \\Delta x $ and time step $ \\Delta t $.\n-   **Focus:** One-dimensional (1D) vacuum propagation along $ x $.\n-   **Specific Condition:** $ k \\Delta x = 0.6 $.\n-   **Task:** Derive the discrete plane-wave relation, estimate the fractional error in the effective wavenumber $ k_{\\mathrm{eff}} $, and assess the qualitative impact on the spatial localization of power deposition. Then, select all consistent statements.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is firmly rooted in the established principles of computational electromagnetics and plasma physics. The description of the Yee FDTD scheme, numerical dispersion, and Landau resonance are standard and factually correct.\n-   **Well-Posed:** The problem is well-defined. It asks for the derivation of the numerical dispersion relation for a standard FDTD scheme, a quantitative estimation based on given data, and a qualitative analysis of its physical consequences. This structure allows for a unique and meaningful solution.\n-   **Objective:** The problem is stated using precise, unambiguous scientific language, free of subjective content.\n-   **Flaw Assessment:**\n    1.  **Scientific Unsoundness:** None. The physics and numerical methods are standard.\n    2.  **Non-Formalizable/Irrelevant:** The problem is formalizable and directly pertains to the specified topic.\n    3.  **Incomplete/Contradictory:** The setup is self-contained and provides all necessary information for the derivation and analysis.\n    4.  **Unrealistic/Infeasible:** The value $ k \\Delta x = 0.6 $ is physically realistic, corresponding to a spatial resolution of $ 2\\pi / (0.6) \\approx 10.5 $ grid points per wavelength, a common scenario in resource-constrained simulations.\n    5.  **Ill-Posed:** The problem is not ill-posed; a unique numerical dispersion relation can be derived.\n    6.  **Trivial/Tautological:** The problem requires a multi-step derivation and a clear understanding of the concepts, making it non-trivial.\n    7.  **Unverifiable:** The derivations and conclusions are mathematically verifiable.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be derived.\n\n### Derivation and Analysis\nThe problem asks to analyze numerical dispersion in a 1D FDTD scheme. Let the wave propagate along the $ x $-direction with electric field $ \\mathbf{E} = E_y(x,t) \\hat{y} $ and magnetic field $ \\mathbf{B} = B_z(x,t) \\hat{z} $. The 1D Maxwell's equations simplify to:\n$$ \\frac{\\partial E_y}{\\partial x} = - \\frac{\\partial B_z}{\\partial t} $$\n$$ \\frac{\\partial B_z}{\\partial x} = - \\mu_0 \\epsilon_0 \\frac{\\partial E_y}{\\partial t} = - \\frac{1}{c^2} \\frac{\\partial E_y}{\\partial t} $$\nThe standard Yee FDTD scheme uses central differences on a grid staggered in space and time. A spatial derivative like $ \\partial_x $ acting on a plane wave $ \\exp(ikx) $ at a half-grid point is approximated as:\n$$ \\frac{\\partial}{\\partial x} \\rightarrow \\frac{\\delta_x}{\\Delta x} $$\nwhere $ \\delta_x f(x) = f(x+\\Delta x/2) - f(x-\\Delta x/2) $. Applying this operator to $ \\exp(ikx) $:\n$$ \\frac{\\exp(ik(x+\\Delta x/2)) - \\exp(ik(x-\\Delta x/2))}{\\Delta x} = \\frac{e^{ikx} (e^{ik\\Delta x/2} - e^{-ik\\Delta x/2})}{\\Delta x} = e^{ikx} \\frac{2i\\sin(k\\Delta x/2)}{\\Delta x} $$\nThe analytical derivative is $ \\partial_x \\exp(ikx) = ik\\exp(ikx) $. By comparison, the discrete spatial operator replaces $ k $ with an effective wavenumber, $ k_{\\mathrm{eff}} $:\n$$ k \\mapsto k_{\\mathrm{eff}} = \\frac{2}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) $$\nThis mapping is the source of numerical dispersion from spatial differencing. Note that for small arguments $ u = k\\Delta x/2 \\ll 1 $, we can Taylor expand $ \\sin(u) \\approx u - u^3/6 $, so $ k_{\\mathrm{eff}} \\approx \\frac{2}{\\Delta x}(k\\Delta x/2 - (k\\Delta x/2)^3/6) = k(1 - (k\\Delta x)^2/24) $. For any finite $ k\\Delta x $, we have $ |\\sin(k\\Delta x/2)|  |k\\Delta x/2| $, which means $ |k_{\\mathrm{eff}}|  |k| $. The numerical scheme consistently underestimates the magnitude of the wavenumber.\n\nFor the given case, $ k \\Delta x = 0.6 $. The fractional error in the effective wavenumber is:\n$$ \\frac{k_{\\mathrm{eff}} - k}{k} = \\frac{\\frac{2}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)}{k} - 1 = \\frac{\\sin\\left(\\frac{k \\Delta x}{2}\\right)}{\\frac{k \\Delta x}{2}} - 1 $$\nWith $ k\\Delta x/2 = 0.3 \\text{ rad} $:\n$$ \\text{Error} = \\frac{\\sin(0.3)}{0.3} - 1 \\approx \\frac{0.29552}{0.3} - 1 \\approx 0.98507 - 1 = -0.01493 \\approx -1.5\\% $$\nThe fractional error is approximately $ -1.5\\% $.\n\nThis error in wavenumber directly impacts the physics of wave-particle interaction. The Landau resonance condition is $ \\omega - k_{\\parallel} v_{\\parallel} = 0 $. In a simulation, the code operates with the effective wavenumber $ k_{\\mathrm{eff}, \\parallel} $. The resonance condition satisfied in the simulation is therefore $ \\omega - k_{\\mathrm{eff}, \\parallel} v_{\\parallel} = 0 $, which implies a resonant velocity of $ v_{\\mathrm{res, num}} = \\omega / k_{\\mathrm{eff}, \\parallel} $.\nSince we found that $ k_{\\mathrm{eff}, \\parallel}  k_{\\parallel} $, it follows that $ v_{\\mathrm{res, num}}  v_{\\mathrm{res, phys}} $, where $ v_{\\mathrm{res, phys}} = \\omega / k_{\\parallel} $ is the true resonant velocity. The simulation will incorrectly predict power deposition on particles with a higher parallel velocity. In an inhomogeneous plasma where $ k_{\\parallel} $ varies spatially, this error causes a spatial shift in the location where resonance occurs, thereby displacing the entire power deposition profile.\n\n### Option-by-Option Analysis\n\n**A. Numerical dispersion is the spurious dependence of the numerical $ \\omega(\\mathbf{k}) $ relation on $ \\Delta x $ and $ \\Delta t $, causing phase and group velocity errors that accumulate along propagation. When $k \\Delta x$ is not $\\ll 1$, these errors shift turning points and resonances, displacing the wave–particle interaction region and thereby the predicted power deposition.**\nThis statement is a correct and comprehensive definition of numerical dispersion and its consequences. The modification of the $ \\omega(\\mathbf{k}) $ relation is the root cause. This leads to errors in phase velocity ($ v_p = \\omega/k $) and group velocity ($ v_g = d\\omega/dk $), which alter wave propagation. A change in the effective $ k $ for a given $ \\omega $ will shift the location of any phenomenon that depends on $ k $, such as resonances ($ \\omega = k_\\parallel v_\\parallel $) or cutoffs ($ k=0 $). This misplacement of physical interactions directly leads to errors in the predicted power deposition profile.\n**Verdict: Correct.**\n\n**B. Numerical dispersion affects only amplitude through stability constraints and leaves phase propagation and ray trajectories unaffected, so power deposition predictions for high-$k$ waves remain accurate even when $ k \\Delta x $ is $ O(1) $.**\nThis statement is fundamentally incorrect. Numerical dispersion is, by definition, an error in the phase relationship between $ \\omega $ and $ k $. It directly affects phase and group velocities, which determine wave propagation and ray trajectories. Stability constraints (e.g., the CFL condition) are related to controlling amplitude growth but are distinct from numerical dispersion. The claim that power deposition predictions remain accurate for $ k \\Delta x = O(1) $ is false, as this is precisely the regime where numerical dispersion becomes significant.\n**Verdict: Incorrect.**\n\n**C. In a one-dimensional vacuum Yee FDTD scheme, the discrete plane-wave relation implies an effective wavenumber mapping $ k \\mapsto k_{\\mathrm{eff}}(k, \\Delta x) $ that underestimates $ k $ when $ k \\Delta x $ is finite. For $ k \\Delta x = 0.6 $, the fractional wavenumber error is a few percent negative, shifting the resonant velocity $ v_{\\parallel} $ inferred from $ \\omega - k_{\\parallel} v_{\\parallel} = 0 $ and hence altering the power deposition profile location and width.**\nThis statement is fully consistent with the derivation above.\n1.  The mapping $ k \\mapsto k_{\\mathrm{eff}} $ indeed underestimates $ k $.\n2.  For $ k \\Delta x = 0.6 $, the calculated fractional error is $ -1.5\\% $, which is \"a few percent negative\".\n3.  The underestimation of $ k_{\\parallel} $ leads to an overestimation of the resonant velocity $ v_{\\parallel} = \\omega/k_{\\parallel} $.\n4.  This shift in resonant velocity and the corresponding resonance location alters the power deposition profile's position and shape.\n**Verdict: Correct.**\n\n**D. Numerical dispersion acts like a uniform, wavenumber-independent damping term in the equations, increasing predicted power deposition everywhere without changing its spatial distribution.**\nThis statement is incorrect on multiple grounds. Numerical dispersion for the leapfrog scheme is a purely phase-related error and does not introduce damping (it is non-dissipative). Any such damping would be termed numerical diffusion/dissipation. Furthermore, the error is strongly dependent on the wavenumber (specifically, on the product $ k\\Delta x $), so it is not wavenumber-independent. Finally, its primary effect is to shift the spatial distribution of interactions, not to add a uniform layer of absorption.\n**Verdict: Incorrect.**\n\n**E. Even with dispersion-reducing high-order spatial differencing, the grid can introduce direction-dependent phase errors in magnetized plasmas if the grid does not adequately resolve the field-aligned direction. For high-$k$ waves, insufficient alignment or resolution of the parallel direction can distort $ k_{\\parallel} $ and thereby the computed deposition profile, although accurate positioning of resonances is achievable when phase errors are controlled so that $k \\Delta x$ need not be $\\ll 1$.**\nThis statement describes advanced, but correct, aspects of numerical modeling in this field.\n1.  On a multi-dimensional Cartesian grid, the numerical dispersion relation is anisotropic; it depends on the angle of wave propagation relative to the grid axes.\n2.  In a magnetized plasma, physical properties depend on the direction relative to the magnetic field. If the field is not aligned with the grid, this numerical anisotropy can introduce significant errors in the resolution of $ k_{\\parallel} $ and $ k_{\\perp} $.\n3.  The purpose of high-order differencing schemes is to reduce phase errors, allowing for accurate results with a coarser grid (i.e., larger $ k\\Delta x $) than would be possible with a low-order scheme. The statement that accurate positioning is \"achievable\" under these conditions (controlled phase errors, $ k \\Delta x $ not asymptotically small) is the entire motivation for developing such advanced schemes. This statement is consistent with a correct and nuanced understanding of the problem.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}