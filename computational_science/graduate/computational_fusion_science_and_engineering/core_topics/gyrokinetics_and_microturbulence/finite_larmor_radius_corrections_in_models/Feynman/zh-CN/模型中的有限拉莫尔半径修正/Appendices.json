{
    "hands_on_practices": [
        {
            "introduction": "在深入研究有限拉莫尔半径 (FLR) *修正* 之前，我们必须首先对拉莫尔半径本身有一个扎实的理解。本练习将指导您从基本的洛伦兹力定律出发，推导拉莫尔半径的表达式，并计算一个具体数值。这项基础实践有助于将抽象的拉莫尔半径概念与聚变等离子体中的实际物理尺度联系起来。",
            "id": "3963559",
            "problem": "一个电荷为 $q=+e$、质量为 $m=m_{p}$ 的单电离氢核（质子）在大小为 $B$ 的匀强磁场中运动，其垂直于磁场方向的速度分量为 $v_{\\perp}$。在与计算聚变科学与工程相关的磁化等离子体动力学和波-粒相互作用基础知识的背景下，由于洛伦兹力的作用，带电粒子在匀强磁场中的垂直运动是圆周运动。从洛伦兹力定律 $m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$ 和匀速圆周运动的运动学描述出发，推导用 $m$、$q$、$v_{\\perp}$ 和 $B$ 表示的回旋半径（也称拉莫尔半径）$r_{L}$ 的表达式。然后，计算一个质子在 $B = 6.00\\,\\mathrm{T}$ 的匀强磁场中，当 $v_{\\perp} = 2.50\\times 10^{6}\\,\\mathrm{m/s}$ 时的 $r_{L}$。使用 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$ 和 $m_{p} = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$。假设为非相对论性运动。将 $r_{L}$ 的最终数值答案以米为单位表示，并将结果四舍五入至四位有效数字。\n\n最后，根据你推导的表达式，讨论 $r_{L}$ 随粒子质量 $m$、电荷大小 $|q|$ 和磁场强度 $B$ 的标度关系，并将其与从第一性原理中出现的回旋频率概念联系起来。",
            "solution": "该问题要求推导带电粒子在匀强磁场中的回旋半径，计算一个特定情况下的数值，并讨论其标度性质。\n\n**问题验证**\n\n首先，我将验证所提供的问题陈述。\n\n**第 1 步：提取已知条件**\n-   粒子：单电离氢核（质子）。\n-   电荷：$q = +e$。\n-   质量：$m = m_p$。\n-   磁场：匀强磁场，大小为 $B$。\n-   速度：垂直于磁场的分量为 $v_{\\perp}$。\n-   控制方程：洛伦兹力定律，$m\\,d\\mathbf{v}/dt = q\\,\\mathbf{v}\\times\\mathbf{B}$。\n-   运动类型：垂直分量为匀速圆周运动。\n-   任务 1：推导用 $m$、$q$、$v_{\\perp}$ 和 $B$ 表示的回旋半径 $r_{L}$ 的表达式。\n-   任务 2：计算质子在 $B = 6.00\\,\\mathrm{T}$ 的匀强磁场中，$v_{\\perp} = 2.50\\times 10^{6}\\,\\mathrm{m/s}$ 时的 $r_{L}$。\n-   常量：$e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$，$m_{p} = 1.67262192369\\times 10^{-27}\\,\\mathrm{kg}$。\n-   假设：非相对论性运动。\n-   要求：数值答案以米为单位表示，并四舍五入至四位有效数字。\n-   任务 3：讨论 $r_L$ 随 $m$、 $|q|$ 和 $B$ 的标度关系，并与回旋频率建立联系。\n\n**第 2 步：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题是等离子体物理学和电磁学中一个经典且基础的练习，基于公认的洛伦兹力定律和牛顿力学。聚变科学的背景是恰当的，物理参数也符合实际。质子能量约为 $(1/2)m_p v_{\\perp}^2 \\approx 32.7\\,\\mathrm{keV}$，磁场强度 $6.00\\,\\mathrm{T}$ 是强场聚变实验中的典型值。速度 $v_{\\perp} = 2.50\\times 10^6\\,\\mathrm{m/s}$ 约等于光速的 $0.83\\%$，因此非相对论性假设是有效的。\n-   **适定性：** 问题陈述清晰，提供了推导唯一解析表达式和计算特定数值结果所需的所有数据和约束条件。\n-   **客观性：** 语言正式、精确，没有主观或模糊的陈述。\n\n**第 3 步：结论与行动**\n该问题有效。它在科学上是合理的，适定的，并且是客观的。我现在将继续进行解答。\n\n**第 1 部分：回旋半径 ($r_L$) 的推导**\n\n质量为 $m$、电荷为 $q$ 的带电粒子在磁场 $\\mathbf{B}$ 中的运动由洛伦兹力决定，根据牛顿第二定律可表示为：\n$$m \\frac{d\\mathbf{v}}{dt} = q(\\mathbf{v} \\times \\mathbf{B})$$\n我们将速度矢量 $\\mathbf{v}$ 分解为平行于磁场 $\\mathbf{B}$ 的分量 ($\\mathbf{v}_{\\parallel}$) 和垂直于磁场 $\\mathbf{B}$ 的分量 ($\\mathbf{v}_{\\perp}$)。因此，$\\mathbf{v} = \\mathbf{v}_{\\parallel} + \\mathbf{v}_{\\perp}$。\n将此代入运动方程：\n$$m \\frac{d}{dt}(\\mathbf{v}_{\\parallel} + \\mathbf{v}_{\\perp}) = q((\\mathbf{v}_{\\parallel} + \\mathbf{v}_{\\perp}) \\times \\mathbf{B})$$\n$$m \\frac{d\\mathbf{v}_{\\parallel}}{dt} + m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{v}_{\\parallel} \\times \\mathbf{B}) + q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\n由于 $\\mathbf{v}_{\\parallel}$ 平行于 $\\mathbf{B}$，它们的叉积为零：$\\mathbf{v}_{\\parallel} \\times \\mathbf{B} = \\mathbf{0}$。方程简化为：\n$$m \\frac{d\\mathbf{v}_{\\parallel}}{dt} + m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\n这表明没有平行于 $\\mathbf{B}$ 的力分量，因此平行速度 $\\mathbf{v}_{\\parallel}$ 保持不变。力完全作用在垂直于 $\\mathbf{B}$ 的平面内。垂直运动的方程是：\n$$m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\n力 $\\mathbf{F}_{\\perp} = q(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$ 始终垂直于 $\\mathbf{v}_{\\perp}$ 和 $\\mathbf{B}$。一个大小恒定且始终垂直于速度矢量的力会导致匀速圆周运动。该力的大小为：\n$$F_{\\perp} = |q| v_{\\perp} B \\sin(\\theta)$$\n其中 $v_{\\perp} = |\\mathbf{v}_{\\perp}|$，$\\theta$ 是 $\\mathbf{v}_{\\perp}$ 和 $\\mathbf{B}$ 之间的夹角。根据定义，$\\theta = \\frac{\\pi}{2}$，所以 $\\sin(\\theta) = 1$。因此，力的大小为：\n$$F_{\\perp} = |q| v_{\\perp} B$$\n对于半径为 $r_L$（回旋半径）、速率为 $v_{\\perp}$ 的匀速圆周运动，所需的向心力由下式给出：\n$$F_{c} = m a_{c} = m \\frac{v_{\\perp}^2}{r_L}$$\n将磁洛伦兹力的大小与所需的向心力相等：\n$$m \\frac{v_{\\perp}^2}{r_L} = |q| v_{\\perp} B$$\n假设 $v_{\\perp} \\neq 0$，我们可以用 $v_{\\perp}$ 除以等式两边，并求解 $r_L$：\n$$r_L = \\frac{m v_{\\perp}}{|q| B}$$\n这就是所求的回旋半径表达式。\n\n**第 2 部分：$r_L$ 的数值计算**\n\n我们已知质子的以下数值：\n-   质量 $m = m_p = 1.67262192369 \\times 10^{-27}\\,\\mathrm{kg}$\n-   电荷 $q = +e$，所以 $|q| = e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n-   垂直速度 $v_{\\perp} = 2.50 \\times 10^{6}\\,\\mathrm{m/s}$\n-   磁场强度 $B = 6.00\\,\\mathrm{T}$\n\n将这些值代入推导出的 $r_L$ 表达式中：\n$$r_L = \\frac{(1.67262192369 \\times 10^{-27}\\,\\mathrm{kg}) \\cdot (2.50 \\times 10^{6}\\,\\mathrm{m/s})}{(1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\cdot (6.00\\,\\mathrm{T})}$$\n$$r_L = \\frac{4.181554809225 \\times 10^{-21}}{9.613059804 \\times 10^{-19}}\\,\\mathrm{m}$$\n$$r_L = 0.43499039... \\times 10^{-2}\\,\\mathrm{m}$$\n$$r_L \\approx 0.0043499\\,\\mathrm{m}$$\n问题要求将结果四舍五入至四位有效数字。前四位有效数字是 $4$、$3$、$4$、$9$。第五位数字是 $9$，因此我们将第四位数字向上取整。\n$$r_L \\approx 0.004350\\,\\mathrm{m}$$\n用科学记数法表示，即为 $4.350 \\times 10^{-3}\\,\\mathrm{m}$。\n\n**第 3 部分：标度关系及与回旋频率的联系**\n\n推导出的回旋半径表达式为 $r_L = \\frac{m v_{\\perp}}{|q| B}$。\n从这个表达式中，我们可以分析 $r_L$ 的标度关系：\n-   **与质量 ($m$) 的标度关系：** $r_L \\propto m$。回旋半径与粒子质量成正比。质量更大的粒子具有更大的惯性，使其更能抵抗磁力的弯曲效应，因此在相同的速度和场强下会产生更大的轨道。\n-   **与电荷大小 ($|q|$) 的标度关系：** $r_L \\propto \\frac{1}{|q|}$。回旋半径与粒子电荷的大小成反比。更大的电荷导致更强的洛伦兹力 ($F_{\\perp} \\propto |q|$)，这会使粒子的路径弯曲得更急剧，从而导致更小的回旋半径。\n-   **与磁场强度 ($B$) 的标度关系：** $r_L \\propto \\frac{1}{B}$。回旋半径与磁场强度成反比。更强的磁场也会增加洛伦兹力 ($F_{\\perp} \\propto B$)，导致更紧密的约束和更小的回旋半径。\n\n**回旋频率** $\\omega_c$ 是粒子回旋运动的角频率。对于匀速圆周运动，切向速度 $v_{\\perp}$ 与角频率 $\\omega_c$ 和半径 $r_L$ 的关系为 $v_{\\perp} = \\omega_c r_L$。\n我们可以将此代入我们的回旋半径方程中：\n$$r_L = \\frac{m (\\omega_c r_L)}{|q| B}$$\n从等式两边消去 $r_L$（因为 $r_L \\neq 0$），我们可以解出 $\\omega_c$：\n$$\\omega_c = \\frac{|q| B}{m}$$\n这就是回旋频率。非相对论理论的一个关键结果是，$\\omega_c$ 与粒子的速度 $v_{\\perp}$ 及其能量无关。\n我们现在可以通过重新整理上述关系，用回旋频率来表示回旋半径：\n$$r_L = \\frac{v_{\\perp}}{\\omega_c}$$\n这种关系提供了一个清晰的物理图像：轨道的大小 ($r_L$) 取决于粒子在其旋转的一个特征弧度（发生时间为 $1/\\omega_c$）内以速度 $v_{\\perp}$ 行进的距离。更高的回旋频率（来自更强的磁场 $B$、更大的电荷 $|q|$ 或更小的质量 $m$）意味着粒子回旋得更快，在更短的时间内完成其圆形路径，对于给定的速度 $v_{\\perp}$，这对应于一个更小的半径。这巧妙地将回旋半径、粒子性质、场强和基本运动频率这些概念联系在了一起。",
            "answer": "$$\n\\boxed{4.350 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "回旋平均是处理 FLR 效应的核心数学工具，它描述了粒子在其回旋轨道上所感受到的平均场。本练习要求您编写一个程序，以数值方式计算一个平面波的回旋平均值，并将其与精确的解析解进行比较。通过这个编码实践，您将亲手验证粒子感受到的场与局部场之间的差异，并理解贝塞尔函数 $J_0$ 作为回旋平均算符的来源。",
            "id": "3980332",
            "problem": "给定一个匀强磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$，以及一个电荷为 $q$、质量为 $m$ 的带电粒子，该粒子在洛伦兹力的作用下，在垂直于 $\\mathbf{B}$ 的平面内做圆周运动。回旋角频率定义为 $\\Omega = \\lvert q \\rvert B / m$，拉莫尔半径定义为 $\\rho_{\\mathrm{L}} = v_{\\perp} / \\Omega$，其中 $v_{\\perp}$ 是垂直速度的大小。考虑一个二维实标量场 $f(x,y) = \\cos(k_x x + k_y y)$，其中 $k_x$ 和 $k_y$ 是垂直波矢 $\\mathbf{k}_{\\perp}$ 的分量，其大小为 $k_{\\perp} = \\sqrt{k_x^2 + k_y^2}$。设导心位置为 $\\mathbf{R} = (R_x, R_y)$，粒子的瞬时位置为 $\\mathbf{r}(\\theta) = \\mathbf{R} + \\rho_{\\mathrm{L}} (\\cos \\theta, \\sin \\theta)$，其中 $\\theta$ 是回旋相位角。\n\n$f$ 在导心 $\\mathbf{R}$ 处的回旋相位平均 $\\langle f \\rangle(\\mathbf{R})$ 定义为\n$$\\langle f \\rangle(\\mathbf{R}) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} f\\big(\\mathbf{r}(\\theta)\\big)\\, d\\theta,$$\n其中 $\\theta$ 以弧度表示。该量表示在计算聚变科学与工程领域中，回旋动理学（GK）和简化流体模型中常用的有限拉莫尔半径（FLR）修正。\n\n您的任务是编写一个完整、可运行的程序，该程序能够：\n- 使用对 $\\theta \\in [0,2\\pi)$ 的等间距求积法，以足够高的分辨率计算数值回旋相位平均 $\\langle f \\rangle(\\mathbf{R})$。\n- 计算您在解中从第一性原理推导出的精确解析回旋相位平均 $\\langle f \\rangle_{\\text{exact}}(\\mathbf{R})$。\n- 计算通过对 $f$ 在 $\\mathbf{R}$ 周围进行泰勒展开并对 $\\theta$ 进行圆周平均推导出的二阶小FLR近似 $\\langle f \\rangle_{\\text{FLR2}}(\\mathbf{R})$。\n\n对于每个测试用例，程序必须返回两个浮点数：\n- 数值回旋相位平均与精确解析结果之间的绝对误差，即 $\\lvert \\langle f \\rangle(\\mathbf{R}) - \\langle f \\rangle_{\\text{exact}}(\\mathbf{R}) \\rvert$。\n- 数值回旋相位平均与二阶小FLR近似之间的绝对误差，即 $\\lvert \\langle f \\rangle(\\mathbf{R}) - \\langle f \\rangle_{\\text{FLR2}}(\\mathbf{R}) \\rvert$。\n\n所有物理量均使用国际单位制（SI单位）：电荷单位为库仑，质量单位为千克，磁场单位为特斯拉，速度单位为米/秒，波矢分量单位为逆米，位置单位为米。角度必须以弧度为单位。\n\n实现对 $\\theta$ 的数值求积时，请使用至少 $M = 4096$ 个等间距点，以确保对所有测试用例都有足够的精度。\n\n测试套件：\n- 用例 $1$：$(q, m, B, v_{\\perp}, k_x, k_y, R_x, R_y) = (1.602176634\\times 10^{-19}, 3.344\\times 10^{-27}, 5, 1\\times 10^{5}, 200, 200, 0.01, -0.02)$。\n- 用例 $2$：$(q, m, B, v_{\\perp}, k_x, k_y, R_x, R_y) = (1.602176634\\times 10^{-19}, 9.10938356\\times 10^{-31}, 5, 2\\times 10^{6}, 2000, 0, 0.001, 0.002)$。\n- 用例 $3$：$(q, m, B, v_{\\perp}, k_x, k_y, R_x, R_y) = (1.602176634\\times 10^{-19}, 3.344\\times 10^{-27}, 5, 1\\times 10^{5}, 5000, 0, 0.0, 0.0)$。\n- 用例 $4$：$(q, m, B, v_{\\perp}, k_x, k_y, R_x, R_y) = (1.602176634\\times 10^{-19}, 3.344\\times 10^{-27}, 5, 0, 1000, 1000, 0.05, 0.05)$。\n- 用例 $5$：$(q, m, B, v_{\\perp}, k_x, k_y, R_x, R_y) = (1.602176634\\times 10^{-19}, 6.64\\times 10^{-27}, 1, 5\\times 10^{5}, 10, 10, -0.03, 0.04)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$$[\\;e_{\\text{exact},1},\\; e_{\\text{FLR2},1},\\; e_{\\text{exact},2},\\; e_{\\text{FLR2},2},\\; e_{\\text{exact},3},\\; e_{\\text{FLR2},3},\\; e_{\\text{exact},4},\\; e_{\\text{FLR2},4},\\; e_{\\text{exact},5},\\; e_{\\text{FLR2},5}\\;],$$\n其中，对于测试用例 $i$，$e_{\\text{exact},i} = \\lvert \\langle f \\rangle(\\mathbf{R}) - \\langle f \\rangle_{\\text{exact}}(\\mathbf{R}) \\rvert$ 且 $e_{\\text{FLR2},i} = \\lvert \\langle f \\rangle(\\mathbf{R}) - \\langle f \\rangle_{\\text{FLR2}}(\\mathbf{R}) \\rvert$。",
            "solution": "提交考虑的问题陈述是有效的。它在科学上基于等离子体物理学的原理，特别是带电粒子在磁场中的运动以及相关的有限拉莫尔半径（FLR）效应。该问题是适定的，提供了所有必要的定义、参数和约束，以得出一个唯一且有意义的解。所涉及的量和模型——回旋相位平均、贝塞尔函数解和泰勒级数近似——是计算聚变科学中的标准且可验证的范式。因此，我将继续提供完整的解决方案。\n\n中心任务是计算在匀强磁场中回旋的带电粒子所经历的标量场 $f(x,y) = \\cos(k_x x + k_y y)$ 的回旋相位平均。回旋相位平均，记为 $\\langle f \\rangle(\\mathbf{R})$，由以下积分定义：\n$$ \\langle f \\rangle(\\mathbf{R}) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} f\\big(\\mathbf{r}(\\theta)\\big)\\, d\\theta $$\n其中 $\\mathbf{R}=(R_x, R_y)$ 是导心位置，而 $\\mathbf{r}(\\theta)$ 是由下式给出的瞬时粒子位置：\n$$ \\mathbf{r}(\\theta) = (x(\\theta), y(\\theta)) = (R_x + \\rho_{\\mathrm{L}}\\cos\\theta, R_y + \\rho_{\\mathrm{L}}\\sin\\theta) $$\n这里，$\\rho_{\\mathrm{L}} = v_{\\perp} / \\Omega$ 是拉莫尔半径，其中 $v_{\\perp}$ 是粒子垂直于磁场的速度大小，$\\Omega = \\lvert q \\rvert B / m$ 是回旋频率。我们必须推导出该平均值的精确解析形式 $\\langle f \\rangle_{\\text{exact}}(\\mathbf{R})$ 和一个二阶近似 $\\langle f \\rangle_{\\text{FLR2}}(\\mathbf{R})$，并将它们与直接数值计算结果 $\\langle f \\rangle(\\mathbf{R})$ 进行比较。\n\n### 精确解析解 $\\langle f \\rangle_{\\text{exact}}(\\mathbf{R})$ 的推导\n\n为推导精确解，我们将粒子位置 $\\mathbf{r}(\\theta)$ 的表达式代入函数 $f(x,y)$。余弦函数的自变量变为：\n$$ k_x x(\\theta) + k_y y(\\theta) = k_x (R_x + \\rho_{\\mathrm{L}}\\cos\\theta) + k_y (R_y + \\rho_{\\mathrm{L}}\\sin\\theta) $$\n整理各项，我们得到：\n$$ (k_x R_x + k_y R_y) + \\rho_{\\mathrm{L}} (k_x \\cos\\theta + k_y \\sin\\theta) $$\n使用垂直波矢 $\\mathbf{k}_{\\perp} = (k_x, k_y)$ 和导心位置矢量 $\\mathbf{R} = (R_x, R_y)$，该表达式可以紧凑地写出。第一项是点积 $\\mathbf{k}_{\\perp} \\cdot \\mathbf{R}$。对于第二项，我们在极坐标中表示 $\\mathbf{k}_{\\perp}$，即 $k_x = k_{\\perp}\\cos\\alpha$ 和 $k_y = k_{\\perp}\\sin\\alpha$，其中 $k_{\\perp} = \\sqrt{k_x^2 + k_y^2}$ 是波矢的大小，$\\alpha$ 是其极角。该项变为：\n$$ \\rho_{\\mathrm{L}} (k_{\\perp}\\cos\\alpha \\cos\\theta + k_{\\perp}\\sin\\alpha \\sin\\theta) = k_{\\perp} \\rho_{\\mathrm{L}} \\cos(\\theta - \\alpha) $$\n因此，回旋相位平均积分为：\n$$ \\langle f \\rangle(\\mathbf{R}) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\cos\\left[ \\mathbf{k}_{\\perp} \\cdot \\mathbf{R} + k_{\\perp}\\rho_{\\mathrm{L}}\\cos(\\theta - \\alpha) \\right] d\\theta $$\n使用余弦和角恒等式 $\\cos(A+B) = \\cos A \\cos B - \\sin A \\sin B$，令 $A = \\mathbf{k}_{\\perp} \\cdot \\mathbf{R}$ 和 $B = k_{\\perp}\\rho_{\\mathrm{L}}\\cos(\\theta - \\alpha)$，我们得到：\n$$ \\langle f \\rangle(\\mathbf{R}) = \\cos(\\mathbf{k}_{\\perp} \\cdot \\mathbf{R}) \\left( \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\cos(k_{\\perp}\\rho_{\\mathrm{L}}\\cos(\\theta - \\alpha)) d\\theta \\right) - \\sin(\\mathbf{k}_{\\perp} \\cdot \\mathbf{R}) \\left( \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\sin(k_{\\perp}\\rho_{\\mathrm{L}}\\cos(\\theta - \\alpha)) d\\theta \\right) $$\n由于被积函数的对称性，第二个积分为零。在一个 $2\\pi$ 区间内，被积函数 $\\sin(z \\cos\\phi)$ 关于 $\\phi=\\pi$ 是反对称的，因此其积分为零。第一个积分是第一类零阶贝塞尔函数 $J_0(z)$ 的标准积分表示：\n$$ J_0(z) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\cos(z\\cos\\phi) d\\phi $$\n由于积分是在一个完整周期上进行的，相移 $\\alpha$ 不会改变积分的值。令 $z = k_{\\perp}\\rho_{\\mathrm{L}}$，我们便得到回旋相位平均的精确解析表达式：\n$$ \\langle f \\rangle_{\\text{exact}}(\\mathbf{R}) = J_0(k_{\\perp} \\rho_{\\mathrm{L}}) \\cos(\\mathbf{k}_{\\perp} \\cdot \\mathbf{R}) $$\n\n### 二阶小FLR近似 $\\langle f \\rangle_{\\text{FLR2}}(\\mathbf{R})$ 的推导\n\n二阶近似是通过将场 $f(\\mathbf{r})$ 在导心位置 $\\mathbf{R}$ 周围进行泰勒展开得到的。令 $\\boldsymbol{\\rho}(\\theta) = \\mathbf{r}(\\theta) - \\mathbf{R} = (\\rho_{\\mathrm{L}}\\cos\\theta, \\rho_{\\mathrm{L}}\\sin\\theta)$ 为回旋半径矢量。展开至二阶的结果是：\n$$  f(\\mathbf{R} + \\boldsymbol{\\rho}) \\approx f(\\mathbf{R}) + \\boldsymbol{\\rho} \\cdot \\nabla f(\\mathbf{R}) + \\frac{1}{2} (\\boldsymbol{\\rho} \\cdot \\nabla)^2 f(\\mathbf{R}) $$\n为了求回旋相位平均，我们对每一项在 $\\theta \\in [0, 2\\pi)$ 上进行平均。$f$ 的导数在 $\\mathbf{R}$ 处取值，并且相对于 $\\theta$ 是常数。我们需要 $\\boldsymbol{\\rho}$ 各分量的平均值：\n$$ \\langle \\rho_x \\rangle = \\langle \\rho_{\\mathrm{L}}\\cos\\theta \\rangle = 0 $$\n$$ \\langle \\rho_y \\rangle = \\langle \\rho_{\\mathrm{L}}\\sin\\theta \\rangle = 0 $$\n$$ \\langle \\rho_x^2 \\rangle = \\langle \\rho_{\\mathrm{L}}^2\\cos^2\\theta \\rangle = \\rho_{\\mathrm{L}}^2 \\langle \\frac{1+\\cos(2\\theta)}{2} \\rangle = \\frac{\\rho_{\\mathrm{L}}^2}{2} $$\n$$ \\langle \\rho_y^2 \\rangle = \\langle \\rho_{\\mathrm{L}}^2\\sin^2\\theta \\rangle = \\rho_{\\mathrm{L}}^2 \\langle \\frac{1-\\cos(2\\theta)}{2} \\rangle = \\frac{\\rho_{\\mathrm{L}}^2}{2} $$\n$$ \\langle \\rho_x \\rho_y \\rangle = \\langle \\rho_{\\mathrm{L}}^2\\cos\\theta\\sin\\theta \\rangle = \\rho_{\\mathrm{L}}^2 \\langle \\frac{\\sin(2\\theta)}{2} \\rangle = 0 $$\n对泰勒级数取平均值：\n$$ \\langle f(\\mathbf{R} + \\boldsymbol{\\rho}) \\rangle \\approx f(\\mathbf{R}) + \\frac{1}{2} \\left( \\langle \\rho_x^2 \\rangle \\frac{\\partial^2 f}{\\partial x^2} + 2\\langle \\rho_x \\rho_y \\rangle \\frac{\\partial^2 f}{\\partial x \\partial y} + \\langle \\rho_y^2 \\rangle \\frac{\\partial^2 f}{\\partial y^2} \\right) \\bigg|_{\\mathbf{R}} $$\n$$ \\langle f \\rangle_{\\text{FLR2}}(\\mathbf{R}) = f(\\mathbf{R}) + \\frac{1}{2} \\left( \\frac{\\rho_{\\mathrm{L}}^2}{2} \\frac{\\partial^2 f}{\\partial x^2} + 0 + \\frac{\\rho_{\\mathrm{L}}^2}{2} \\frac{\\partial^2 f}{\\partial y^2} \\right) \\bigg|_{\\mathbf{R}} = f(\\mathbf{R}) + \\frac{\\rho_{\\mathrm{L}}^2}{4} \\nabla^2_{\\perp} f(\\mathbf{R}) $$\n对于给定的函数 $f(x,y) = \\cos(k_x x + k_y y)$，其垂直拉普拉斯算子为：\n$$ \\nabla^2_{\\perp} f = \\frac{\\partial^2 f}{\\partial x^2} + \\frac{\\partial^2 f}{\\partial y^2} = -k_x^2 \\cos(k_x x + k_y y) - k_y^2 \\cos(k_x x + k_y y) = -(k_x^2 + k_y^2) f = -k_{\\perp}^2 f $$\n将此代入近似式中，得到：\n$$ \\langle f \\rangle_{\\text{FLR2}}(\\mathbf{R}) = f(\\mathbf{R}) - \\frac{k_{\\perp}^2 \\rho_{\\mathrm{L}}^2}{4} f(\\mathbf{R}) $$\n$$ \\langle f \\rangle_{\\text{FLR2}}(\\mathbf{R}) = \\left(1 - \\frac{k_{\\perp}^2 \\rho_{\\mathrm{L}}^2}{4}\\right) \\cos(\\mathbf{k}_{\\perp} \\cdot \\mathbf{R}) $$\n这个结果与 $J_0(k_{\\perp} \\rho_{\\mathrm{L}})$ 在小自变量情况下的二阶泰勒展开 $J_0(z) \\approx 1 - z^2/4$ 一致。\n\n### 数值实现\n\n数值回旋相位平均 $\\langle f \\rangle(\\mathbf{R})$ 是使用一个简单的求积法则计算的，具体来说是使用 $M=4096$ 个等间距点 $\\theta_j = 2\\pi j / M$（其中 $j=0, \\dots, M-1$）的矩形法。其离散平均为：\n$$ \\langle f \\rangle(\\mathbf{R}) \\approx \\frac{1}{M} \\sum_{j=0}^{M-1} f\\big(\\mathbf{r}(\\theta_j)\\big) = \\frac{1}{M} \\sum_{j=0}^{M-1} \\cos\\left( k_x(R_x+\\rho_{\\mathrm{L}}\\cos\\theta_j) + k_y(R_y+\\rho_{\\mathrm{L}}\\sin\\theta_j) \\right) $$\n该算法为每个提供的测试用例计算此数值，并将其与两个推导出的解析公式 $\\langle f \\rangle_{\\text{exact}}$ 和 $\\langle f \\rangle_{\\text{FLR2}}$ 的结果进行比较。然后报告绝对误差。在 $v_{\\perp}=0$ 的特殊情况下，意味着 $\\rho_{\\mathrm{L}}=0$，这将所有三个表达式都简化为 $f(\\mathbf{R}) = \\cos(\\mathbf{k}_{\\perp} \\cdot \\mathbf{R})$，从而如预期一样产生零误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import j0\n\ndef solve():\n    \"\"\"\n    Computes and compares numerical, analytical, and approximate gyrophase averages\n    for a charged particle in a magnetic field.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Deuteron, moderate k_perp * rho_L\n        (1.602176634e-19, 3.344e-27, 5, 1e5, 200, 200, 0.01, -0.02),\n        # Case 2: Electron/Positron, small k_perp * rho_L\n        (1.602176634e-19, 9.10938356e-31, 5, 2e6, 2000, 0, 0.001, 0.002),\n        # Case 3: Deuteron, large k_perp * rho_L\n        (1.602176634e-19, 3.344e-27, 5, 1e5, 5000, 0, 0.0, 0.0),\n        # Case 4: Deuteron, zero v_perp (zero rho_L)\n        (1.602176634e-19, 3.344e-27, 5, 0, 1000, 1000, 0.05, 0.05),\n        # Case 5: Alpha particle, moderate rho_L, small k_perp\n        (2 * 1.602176634e-19, 6.64e-27, 1, 5e5, 10, 10, -0.03, 0.04),\n    ]\n\n    results = []\n    \n    # Number of points for numerical quadrature\n    M = 4096\n\n    for case in test_cases:\n        q_charge, m_mass, B_field, v_perp, kx, ky, Rx, Ry = case\n\n        # Calculate cyclotron frequency and Larmor radius\n        q_abs = abs(q_charge)\n        if v_perp == 0.0:\n            rho_L = 0.0\n        elif q_abs == 0.0 or B_field == 0.0 or m_mass == 0.0:\n            rho_L = float('inf') # Should not happen in tests\n        else:\n            Omega = q_abs * B_field / m_mass\n            rho_L = v_perp / Omega\n        \n        # Calculate wavevector magnitude and dot product with guiding center position\n        k_perp = np.sqrt(kx**2 + ky**2)\n        k_dot_R = kx * Rx + ky * Ry\n\n        # 1. Numerical gyrophase average\n        theta = np.linspace(0, 2 * np.pi, M, endpoint=False)\n        particle_x = Rx + rho_L * np.cos(theta)\n        particle_y = Ry + rho_L * np.sin(theta)\n        \n        field_values = np.cos(kx * particle_x + ky * particle_y)\n        f_numeric = np.mean(field_values)\n\n        # 2. Exact analytical gyrophase average\n        f_exact = j0(k_perp * rho_L) * np.cos(k_dot_R)\n\n        # 3. Second-order small FLR approximation\n        k_rho_sq = (k_perp * rho_L)**2\n        f_flr2 = (1 - k_rho_sq / 4.0) * np.cos(k_dot_R)\n        \n        # Calculate absolute errors\n        error_exact = abs(f_numeric - f_exact)\n        error_flr2 = abs(f_numeric - f_flr2)\n        \n        results.extend([error_exact, error_flr2])\n\n    output_string = \"[\" + \", \".join(f\"{res:.8e}\" for res in results) + \"]\"\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "掌握了回旋平均的形式主义后，我们将其应用于一个实际的聚变研究问题：由等离子体细丝或“团块”引起的输运。本练习将展示 FLR 效应（通过一个近似的回旋平均算符来体现）如何修正这些结构的传播速度。这项计算将理论框架与等离子体行为中可观测的物理后果直接联系起来，揭示了 FLR 效应对惯性响应和动力学的重要影响。",
            "id": "4200222",
            "problem": "考虑一个磁化聚变等离子体边界区的二维板模型，其中笛卡尔坐标 $(x,y)$ 分别表示垂直于和沿着曲率漂移方向，磁场为均匀磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$。一个特征垂直波数为 $k_{\\perp}$、密度扰动幅度为 $\\delta n$ 的相干丝状结构（“斑”）由于静电势 $\\phi(x,y,t)$ 产生的电场叉磁场（$\\mathbf{E}\\times\\mathbf{B}$）漂移而径向移动。假设电子和离子为等温且温度相等，$T_e = T_i$，并定义离子声拉莫尔半径 $\\rho_s = c_s/\\Omega_i$，其中 $c_s = \\sqrt{T_e/m_i}$，$ \\Omega_i = eB/m_i$。电子响应沿磁场是绝热的，因此归一化电子密度扰动满足 $\\tilde{n}_e \\equiv \\delta n_e/n_0 \\approx \\tilde{\\phi} \\equiv e \\phi/T_e$。\n\n为了描述在垂直尺度 $k_{\\perp}$ 上的有限离子拉莫尔半径效应，在傅里叶空间中使用一个标准的回旋流体准中性闭合，其中包含零阶回旋平均算子 $\\Gamma_0(b)$，这里 $b \\equiv k_{\\perp}^{2}\\rho_s^{2}$。对于单一 $k_{\\perp}$ 扰动，准中性条件得出\n$$\n\\tilde{n}_e - \\tilde{n}_i = \\left(1 - \\Gamma_0(b)\\right)\\tilde{\\phi} \\, ,\n$$\n这意味着当 $\\tilde{n}_e = \\tilde{\\phi}$ 成立时，有 $\\tilde{n}_i = \\Gamma_0(b)\\tilde{\\phi}$。\n\n在漂移排序极限 $k_{\\perp}\\rho_s \\ll 1$下，基线惯性斑速度标度 $V_0$ 可由 $\\phi_0$ 引起的 $\\mathbf{E}\\times\\mathbf{B}$ 平流推导得出，其中 $\\phi_0$ 是在 $\\Gamma_0(b) \\to 1$ 的条件下确定的。现在，通过估算当 $k_{\\perp}\\rho_s \\sim 0.5$ 时的修正，来测试此斑速度标度对漂移排序失效的敏感性。具体而言：\n\n- 从上述准中性条件和 $\\mathbf{E}\\times\\mathbf{B}$ 漂移速度大小 $V \\sim (c/B) k_{\\perp}\\phi$ 出发，推导乘法修正因子 $F(b)$，使得 $V = F(b) V_0$，并用 $b$ 表示。\n- 为了得到 $F(b)$ 的显式表达式，对回旋平均算子使用广泛应用的 Padé 近似，$\\Gamma_0(b) \\approx \\frac{1}{1+b}$。\n- 计算在 $b = (0.5)^2$ 时 $F(b)$ 的值。\n\n此外，（定性地，无需计算）指出在漂移简化的 Braginskii 流体方程中，当 $k_{\\perp}\\rho_s$ 接近 0.5 时，哪些在漂移排序下被忽略的项变得不可忽略，重点关注涡度（极化）和连续性动力学。\n\n将 $b = (0.5)^2$ 时的乘法修正因子 $F(b)$ 作为一个单一的无量纲数给出。无需四舍五入；提供精确值。最终数值答案中不要包含任何单位。",
            "solution": "该问题被评估为有效，因为它在科学上基于等离子体物理学的原理，特别是磁化等离子体中的漂移波湍流和输运理论。该问题是适定的、客观的、且内部一致的，提供了推导唯一解所需的所有必要关系和近似。其模型和参数，包括回旋流体闭合和 Padé 近似，在聚变等离子体模拟领域是标准的。\n\n主要目标是找到斑速度标度的乘法修正因子 $F(b)$，该因子考虑了超出严格漂移排序极限的有限拉莫尔半径（FLR）效应。斑的速度 $V$ 由 $\\mathbf{E} \\times \\mathbf{B}$ 漂移驱动，其大小标度为 $V \\sim (c/B) k_{\\perp}\\phi$。电势 $\\phi$ 由等离子体动力学决定，特别是电荷分离源项与等离子体惯性响应之间的平衡，这由涡度方程描述。\n\n涡度方程从根本上源于准中性条件，或更精确地说，是电荷守恒定律 $\\nabla \\cdot \\mathbf{J} = 0$。极化电流 $\\mathbf{J}_{pol}$ 代表了离子对时变电场的惯性响应。其散度由与介质极化相关的电荷密度的变化率给出。根据电荷守恒，这与离子密度演化相关：$\\nabla \\cdot \\mathbf{J}_{pol} = -e \\frac{\\partial(\\delta n_i)}{\\partial t}$。\n\n使用归一化量和给定的离子密度扰动的回旋流体关系式 $\\tilde{n}_i = \\Gamma_0(b)\\tilde{\\phi}$，我们可以将离子密度扰动写为 $\\delta n_i = n_0 \\tilde{n}_i = n_0 \\Gamma_0(b) \\tilde{\\phi}$。此处，$b = k_{\\perp}^2 \\rho_s^2$ 是归一化的垂直波数平方。极化电流的散度则为：\n$$\n\\nabla \\cdot \\mathbf{J}_{pol} = -e n_0 \\frac{\\partial}{\\partial t} \\left( \\Gamma_0(b) \\tilde{\\phi} \\right)\n$$\n假设一个类波扰动，其时间依赖性为 $\\partial/\\partial t \\rightarrow -i\\omega$，并通过 $\\omega \\sim k_x V$ 将斑的径向传播与此频率关联起来，我们得到极化响应的标度关系。然而，一个更直接的标度论证就足够了。决定 $\\phi$ 的动力学方程的涡度（或极化）部分与离子对电势的密度响应成正比。问题陈述了离子密度响应为 $\\tilde{n}_i = \\Gamma_0(b)\\tilde{\\phi}$。驱动极化电流的实际电荷分离由 $\\tilde{n}_i - \\tilde{n}_e = (\\Gamma_0(b)-1)\\tilde{\\phi}$ 给出。动力学平衡了一个源项（例如，来自曲率漂移，为此标度关系假定为常数）与此极化响应。在稳定传播的图像中，这种平衡得出了速度 $V$ 的一个标度关系：\n$$\nV \\propto \\frac{\\text{源项}}{\\text{惯性响应}} \\propto \\frac{1}{|\\Gamma_0(b) - 1|}\n$$\n问题定义了在漂移排序极限 $k_{\\perp}\\rho_s \\ll 1$（对应于 $b \\ll 1$）下的基线速度 $V_0$。在此极限下，回旋平均算子 $\\Gamma_0(b)$ 可以被展开。$\\Gamma_0(b)$ 的一个标准展开式是 $\\Gamma_0(b) \\approx 1 - b + \\mathcal{O}(b^2)$。因此，在小 $b$ 极限下，分母变为 $|\\Gamma_0(b) - 1| \\approx |(1-b)-1| = b$。\n因此，基线速度标度为：\n$$\nV_0 \\propto \\frac{1}{b}\n$$\n包含 FLR 效应的速度标度为：\n$$\nV \\propto \\frac{1}{1 - \\Gamma_0(b)}\n$$\n注意到由于 $\\Gamma_0(b) \\le 1$，我们可以写成 $1 - \\Gamma_0(b)$ 而不使用绝对值。乘法修正因子 $F(b) = V/V_0$ 是这些标度关系的比值：\n$$\nF(b) = \\frac{V}{V_0} = \\frac{1/(1-\\Gamma_0(b))}{1/b} = \\frac{b}{1-\\Gamma_0(b)}\n$$\n问题指定使用回旋平均算子的 Padé 近似：\n$$\n\\Gamma_0(b) \\approx \\frac{1}{1+b}\n$$\n将此近似代入 $F(b)$ 的表达式中：\n$$\nF(b) = \\frac{b}{1 - \\frac{1}{1+b}} = \\frac{b}{\\frac{(1+b) - 1}{1+b}} = \\frac{b}{\\frac{b}{1+b}} = 1+b\n$$\n所以修正因子就是 $F(b) = 1+b$。我们被要求计算在 $k_{\\perp}\\rho_s = 0.5$ 时的这个因子。首先，我们计算相应的 $b$ 值：\n$$\nb = (k_{\\perp}\\rho_s)^2 = (0.5)^2 = 0.25\n$$\n现在我们计算在此值下的 $F(b)$：\n$$\nF(0.25) = 1 + 0.25 = 1.25\n$$\n这表明对于 $k_{\\perp}\\rho_s = 0.5$，斑的速度比简单的漂移排序模型的预测值大 $25\\%$。这种增强是 FLR 效应降低了离子的有效惯性的结果。\n\n对于问题的第二部分，我们指出在漂移简化的 Braginskii 流体方程中，当 $k_{\\perp}\\rho_s$ 接近 0.5 时，在漂移排序（$k_{\\perp}\\rho_s \\ll 1$）下被忽略的哪些项变得不可忽略。\n\n在**涡度/极化动力学**中，主要被忽略的项是高阶有限拉莫尔半径（FLR）修正。标准的漂移流体极化项，与 $\\frac{d}{dt}\\nabla_{\\perp}^2\\phi$ 成正比，是对完整离子极化响应的一种近似，仅在长波长下有效。随着 $k_{\\perp}\\rho_s$ 的增加，这个近似失效。本问题第一部分中使用的回旋流体模型用一个基于 $\\Gamma_0(b)$ 的更精确形式替换了这一项，但一个完整的流体模型将需要包含高阶导数项。此外，负责动量输运的**离子回旋粘性应力张量**包含 $(k_{\\perp}\\rho_s)^2$ 的高阶 FLR 项，这些项通常被省略。这些项起到一种超粘性的作用，阻尼小尺度结构，并且对于在 $k_{\\perp}\\rho_s \\sim 0.5$ 的尺度上正确描述动力学至关重要。\n\n在**连续性动力学**中，密度的主要平流是由 $\\mathbf{E}\\times\\mathbf{B}$ 漂移 $\\mathbf{v}_E$ 引起的。在漂移排序中，假设离子和电子以相同的流体速度 $\\mathbf{v}_E$ 被平流。然而，离子具有有限的拉莫尔半径，因此经历的是一个回旋平均的电场。真实的离子平流速度是回旋平均的 $\\mathbf{E}\\times\\mathbf{B}$ 速度 $\\langle \\mathbf{v}_E \\rangle_{gyro}$，而不是局部值 $\\mathbf{v}_E$。这个差值 $\\langle \\mathbf{v}_E \\rangle_{gyro} - \\mathbf{v}_E$ 构成了对连续性方程中平流项（例如，在 $\\nabla \\cdot (n_i \\mathbf{v}_i)$ 中）的 FLR 修正，当 $k_{\\perp}\\rho_s \\to 0.5$ 时，这个修正变得显著。类似地，离子抗磁漂移也获得了在基本的漂移排序模型中被忽略的 FLR 修正。",
            "answer": "$$\\boxed{1.25}$$"
        }
    ]
}