{
    "hands_on_practices": [
        {
            "introduction": "任何回旋动理学模拟，无论是通量管模型还是全局模型，都始于一个给定的磁平衡构型。本练习将引导你从基本的 Grad-Shafranov 方程出发，通过动手实践推导一个简化但具有代表性的托卡马克平衡。完成此练习有助于你巩固对安全因子 $q$ 和磁场几何等关键概念的理解，这些都是回旋动理学模型的基本输入参数 。",
            "id": "3981627",
            "problem": "在轴对称、静态、理想磁流体力学 (MHD) 中，托卡马克内的平衡满足关于极向磁通函数 $\\psi(R,Z)$ 的 Grad–Shafranov 方程，\n$$\n\\Delta^{*}\\psi \\equiv R \\frac{\\partial}{\\partial R}\\left(\\frac{1}{R}\\frac{\\partial \\psi}{\\partial R}\\right) + \\frac{\\partial^{2}\\psi}{\\partial Z^{2}} = - \\mu_{0} R^{2} \\frac{d p}{d \\psi} - F(\\psi)\\,\\frac{d F}{d \\psi},\n$$\n其中 $R$ 是柱坐标大半径，$Z$ 是垂直坐标，$\\mu_{0}$ 是真空磁导率，$p(\\psi)$ 是标量压强，以及 $F(\\psi) \\equiv R B_{\\phi}$，其中 $B_{\\phi}$ 是环向磁场。\n\n通过指定线性压强分布 $p(\\psi) = p_{a} - \\alpha \\psi$（其中 $\\alpha > 0$ 为常数）和一个恒定的环向场函数 $F^{2}(\\psi) = F_{0}^{2}$（其中 $p_{a}$ 和 $F_{0}$ 为常数），构建一个简单的大环径比、同心圆形截面的托卡马克平衡。假设小逆环径比 $\\epsilon \\equiv r/R_{0} \\ll 1$，其中 $r$ 是标记同心磁面的小半径，$R_{0}$ 是磁轴处的大半径，并仅保留 $\\epsilon$ 的主阶项。对极向角为 $\\theta$ 的磁面，使用坐标关系 $R(\\theta) = R_{0} + r\\cos\\theta$ 和 $Z(\\theta) = r\\sin\\theta$。将 $\\psi$ 在主阶上视为 $r$ 的函数，并在 $r=0$ 处施加正则性条件。\n\n从 Grad–Shafranov 方程出发，推导与指定的 $p(\\psi)$ 和 $F(\\psi)$ 一致的主阶 $\\psi(r)$。然后，使用磁场表示法 $\\mathbf{B} = \\nabla\\psi \\times \\nabla\\phi + F(\\psi)\\,\\nabla\\phi$（其中 $\\phi$ 是环向角），从其作为磁力线螺距的第一性原理定义 $q = \\frac{1}{2\\pi}\\oint \\frac{d\\phi}{d\\theta}\\,d\\theta$（其中 $d\\phi/d\\theta = \\frac{\\mathbf{B}\\cdot\\nabla\\phi}{\\mathbf{B}\\cdot\\nabla\\theta}$）推导安全因子 $q(\\psi)$。在相同的阶数下，确定与磁通管回旋动理学最相关的几何因子的主阶表达式，即给定磁面上的 $|\\nabla\\psi|$ 和沿该磁面的磁场强度变化 $B(\\theta)$。\n\n给出 $q(\\psi)$ 关于 $\\mu_{0}$、$\\alpha$、$F_{0}$ 和 $R_{0}$ 的单个闭合形式解析表达式作为最终答案。安全因子是无量纲的；最终答案中无需单位。不要在最终答案中提供中间结果。",
            "solution": "该问题有科学依据、适定、客观，且属于指定领域。这是磁流体动力学理论中的一个标准推导。因此，该问题是有效的。\n\n首先，我们使用指定的压强分布 $p(\\psi)$ 和环向场函数 $F(\\psi)$ 来简化 Grad–Shafranov 方程。给定 $p(\\psi) = p_{a} - \\alpha \\psi$，压强梯度项为 $\\frac{dp}{d\\psi} = -\\alpha$。给定 $F^{2}(\\psi) = F_{0}^{2}$，其中 $F_0$ 是常数，对应的项为 $F(\\psi)\\frac{dF}{d\\psi} = \\frac{1}{2}\\frac{d(F^{2})}{d\\psi} = \\frac{1}{2}\\frac{d(F_{0}^{2})}{d\\psi} = 0$。将这些代入 Grad–Shafranov 方程，得到：\n$$\n\\Delta^{*}\\psi = - \\mu_{0} R^{2} (-\\alpha) - 0 = \\mu_{0} \\alpha R^{2}\n$$\n问题指明了大环径比展开 $\\epsilon \\equiv r/R_0 \\ll 1$，并且在主阶上应将 $\\psi$ 仅视为小半径 $r$ 的函数，即 $\\psi = \\psi(r)$。在环坐标 $(r, \\theta)$ 中，算符 $\\Delta^{*}$ 由下式给出：\n$$\n\\Delta^{*}\\psi = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial \\psi}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2\\psi}{\\partial\\theta^2} - \\frac{1}{R}\\left(\\cos\\theta\\frac{\\partial\\psi}{\\partial r} - \\frac{\\sin\\theta}{r}\\frac{\\partial\\psi}{\\partial\\theta}\\right)\n$$\n由于 $\\psi = \\psi(r)$，关于 $\\theta$ 的导数为零，因此 $\\frac{\\partial\\psi}{\\partial\\theta}=0$ 且 $\\frac{\\partial^2\\psi}{\\partial\\theta^2}=0$。该算符简化为：\n$$\n\\Delta^{*}\\psi = \\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{d\\psi}{dr}\\right) - \\frac{\\cos\\theta}{R}\\frac{d\\psi}{dr}\n$$\n于是完整的方程为：\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{d\\psi}{dr}\\right) - \\frac{\\cos\\theta}{R_0+r\\cos\\theta}\\frac{d\\psi}{dr} = \\mu_{0} \\alpha (R_0+r\\cos\\theta)^2\n$$\n为了得到主阶方程，我们仅保留 $\\epsilon = r/R_0$ 的最低阶项。我们在方程两边近似取 $R \\approx R_0$。左侧的 $\\cos\\theta$ 项相对于第一项是 $\\epsilon$ 阶的，右侧的 $\\cos\\theta$ 项也是 $\\epsilon$ 阶和 $\\epsilon^2$ 阶的。舍去这些项，得到主阶方程：\n$$\n\\frac{1}{r}\\frac{d}{dr}\\left(r \\frac{d\\psi}{dr}\\right) = \\mu_{0} \\alpha R_{0}^{2}\n$$\n将此常微分方程对 $r$ 积分一次：\n$$\nr \\frac{d\\psi}{dr} = \\int \\mu_{0} \\alpha R_{0}^{2} r \\,dr = \\frac{1}{2}\\mu_{0} \\alpha R_{0}^{2} r^2 + C_1\n$$\n除以 $r$ 得到 $\\frac{d\\psi}{dr} = \\frac{1}{2}\\mu_{0} \\alpha R_{0}^{2} r + \\frac{C_1}{r}$。磁轴（$r=0$）处的正则性条件要求像磁场这样的物理量不能发散。由于极向磁场与 $\\frac{1}{R}|\\nabla\\psi| \\sim \\frac{1}{R_0}\\frac{d\\psi}{dr}$ 成正比，我们必须要求 $\\frac{d\\psi}{dr}$ 在 $r=0$ 处是有限的。这意味着我们必须将积分常数 $C_1=0$。因此：\n$$\n\\frac{d\\psi}{dr} = \\frac{1}{2}\\mu_{0} \\alpha R_{0}^{2} r\n$$\n再次积分得到 $\\psi(r)$：\n$$\n\\psi(r) = \\int \\frac{1}{2}\\mu_{0} \\alpha R_{0}^{2} r \\,dr = \\frac{1}{4}\\mu_{0} \\alpha R_{0}^{2} r^2 + C_2\n$$\n我们可以将磁轴处的极向磁通定义为零，即 $\\psi(0)=0$，这使得 $C_2=0$。因此，主阶极向磁通函数为：\n$$\n\\psi(r) = \\frac{1}{4}\\mu_{0} \\alpha R_{0}^{2} r^2\n$$\n接下来，我们从其定义 $q = \\frac{1}{2\\pi}\\oint \\frac{d\\phi}{d\\theta}\\,d\\theta$ 推导安全因子 $q(\\psi)$，其中微分比沿着磁力线。该比率由 $\\frac{d\\phi}{d\\theta} = \\frac{\\mathbf{B}\\cdot\\nabla\\phi}{\\mathbf{B}\\cdot\\nabla\\theta}$ 给出。\n磁场为 $\\mathbf{B} = \\nabla\\psi \\times \\nabla\\phi + F(\\psi)\\nabla\\phi$。逆变基矢为 $\\nabla\\phi = \\frac{1}{R}\\hat{\\phi}$ 和 $\\nabla\\theta = \\frac{1}{r}(-\\sin\\theta\\hat{R}+\\cos\\theta\\hat{Z})$。\n分子是 $\\mathbf{B}\\cdot\\nabla\\phi = F(\\psi)|\\nabla\\phi|^2 = F(\\psi)/R^2$。\n对于分母，我们需要极向磁场 $\\mathbf{B}_p = \\nabla\\psi \\times \\nabla\\phi$。给定 $\\psi=\\psi(r)$，我们有 $\\nabla\\psi = \\frac{d\\psi}{dr}\\nabla r = \\frac{d\\psi}{dr}(\\cos\\theta\\hat{R} + \\sin\\theta\\hat{Z})$。\n于是，$\\mathbf{B}_p = \\frac{1}{R}\\nabla\\psi \\times \\hat{\\phi} = \\frac{1}{R}\\frac{d\\psi}{dr}(\\cos\\theta\\hat{Z} - \\sin\\theta\\hat{R})$。\n点积为 $\\mathbf{B}\\cdot\\nabla\\theta = \\mathbf{B}_p\\cdot\\nabla\\theta = \\frac{1}{R}\\frac{d\\psi}{dr}(\\cos\\theta\\hat{Z} - \\sin\\theta\\hat{R}) \\cdot \\frac{1}{r}(\\cos\\theta\\hat{Z} - \\sin\\theta\\hat{R}) = \\frac{1}{Rr}\\frac{d\\psi}{dr}$。\n因此，被积函数为 $\\frac{d\\phi}{d\\theta} = \\frac{F/R^2}{(1/Rr)(d\\psi/dr)} = \\frac{F r}{R (d\\psi/dr)}$。\n安全因子是在一个磁面（常数 $r$）上的积分：\n$$\nq(r) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\frac{F(r) r}{R(\\theta) \\frac{d\\psi}{dr}} \\,d\\theta\n$$\n代入 $F=F_0$, $R=R_0+r\\cos\\theta$, 和 $d\\psi/dr = \\frac{1}{2}\\mu_{0} \\alpha R_{0}^{2} r$：\n$$\nq(r) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\frac{F_0 r}{(R_0+r\\cos\\theta) (\\frac{1}{2}\\mu_0 \\alpha R_0^2 r)} \\,d\\theta = \\frac{2 F_0}{\\mu_0 \\alpha R_0^2} \\frac{1}{2\\pi} \\int_{0}^{2\\pi} \\frac{d\\theta}{R_0+r\\cos\\theta}\n$$\n该积分为 $\\int_{0}^{2\\pi} \\frac{d\\theta}{a+b\\cos\\theta} = \\frac{2\\pi}{\\sqrt{a^2-b^2}}$。这里 $a=R_0$ 且 $b=r$。\n$$\nq(r) = \\frac{2 F_0}{\\mu_0 \\alpha R_0^2} \\frac{1}{\\sqrt{R_0^2-r^2}} = \\frac{2 F_0}{\\mu_0 \\alpha R_0^3 \\sqrt{1-(r/R_0)^2}}\n$$\n题目要求我们给出 $\\epsilon=r/R_0$ 的主阶表达式。我们对小 $\\epsilon$ 展开结果：\n$$\nq(r) = \\frac{2 F_0}{\\mu_0 \\alpha R_0^3} (1 - \\epsilon^2)^{-1/2} = \\frac{2 F_0}{\\mu_0 \\alpha R_0^3} (1 + O(\\epsilon^2))\n$$\n在主阶上，安全因子是恒定的：\n$$\nq \\approx \\frac{2 F_0}{\\mu_0 \\alpha R_0^3}\n$$\n由于该表达式与 $r$ 无关，因此它也与 $\\psi$ 无关。所以，$q(\\psi)$ 就是这个常数值。\n\n为完整起见，我们确定其他要求的几何因子。\n磁面上的极向磁通梯度大小为：\n$$\n|\\nabla\\psi| = \\left|\\frac{d\\psi}{dr}\\right| = \\frac{1}{2}\\mu_{0} \\alpha R_{0}^{2} r\n$$\n沿磁面的磁场强度变化为 $B(\\theta) = |\\mathbf{B}| = \\sqrt{B_p^2 + B_T^2}$。\n$B_T = B_\\phi = \\frac{F_0}{R} = \\frac{F_0}{R_0+r\\cos\\theta}$。\n$B_p = \\frac{|\\nabla\\psi|}{R} = \\frac{(1/2)\\mu_0 \\alpha R_0^2 r}{R_0+r\\cos\\theta}$。\n在大环径比极限下，$B_p/B_T = \\frac{\\mu_0 \\alpha R_0^2 r}{2F_0} = \\frac{r}{R_0 q} = \\epsilon/q \\ll 1$。因此 $B_p^2$ 相对于 $B_T^2$ 可以忽略不计。\n$$\nB(\\theta) \\approx |B_T| = \\frac{F_0}{R_0+r\\cos\\theta} = \\frac{F_0}{R_0(1+\\epsilon\\cos\\theta)} \\approx \\frac{F_0}{R_0}(1-\\epsilon\\cos\\theta) = \\frac{F_0}{R_0}\\left(1-\\frac{r}{R_0}\\cos\\theta\\right)\n$$\n所要求的最终答案是 $q(\\psi)$ 的表达式。",
            "answer": "$$\n\\boxed{\\frac{2F_0}{\\mu_0 \\alpha R_0^3}}\n$$"
        },
        {
            "introduction": "在环形等离子体中，粒子俘获是驱动重要微观不稳定性的关键物理机制。本练习旨在通过推导粒子被磁场俘获的条件并计算被俘获粒子的比例，为你架起从单粒子运动到集体现象的桥梁。掌握这一概念对于解读回旋动理学模拟的结果至关重要，尤其是那些涉及俘获粒子模的模拟 。",
            "id": "3981597",
            "problem": "考虑一个圆形截面、同心、大环径比 (LAR) 的托卡马克，其大半径为 $R_{0}$，小半径为 $r \\ll R_{0}$，逆环径比为 $\\epsilon = r / R_{0}$。在局域磁通管 (FT) 回旋动理学 (GK) 框架中，我们研究给定磁面上的一条磁力线，该磁力线由极向角 $\\theta$ 参数化。该磁面上的磁场大小由环几何决定，表达式为\n$$\nB(\\theta) = \\frac{B_{0}}{1 + \\epsilon \\cos \\theta},\n$$\n其中 $B_{0}$ 是 $R_{0}$ 处的环向场。磁场最小值位于外侧中平面 $\\theta = 0$ 处，为 $B_{\\min} = B_{0}/(1+\\epsilon)$；磁场最大值位于内侧中平面 $\\theta = \\pi$ 处，为 $B_{\\max} = B_{0}/(1-\\epsilon)$。\n\n假设回旋动理学运动不变量沿磁力线成立：总动能 $E = \\tfrac{1}{2} m v^{2}$ 守恒和磁矩 $\\mu = \\tfrac{m v_{\\perp}^{2}}{2 B}$ 守恒。定义在外侧中平面参考位置 $\\theta = 0$ 处的螺距角参数为 $\\lambda \\equiv v_{\\perp}^{2}(\\theta=0)/v^{2}$，并引入归一化磁场\n$$\nb(\\theta) \\equiv \\frac{B(\\theta)}{B_{\\min}} = \\frac{1+\\epsilon}{1+\\epsilon \\cos \\theta},\n$$\n使得 $b_{\\min} = 1$ 且 $b_{\\max} = \\frac{1+\\epsilon}{1-\\epsilon}$。\n\n从上述不变量和定义出发，用 $\\lambda$ 和 $b_{\\max}$ 推导粒子沿磁力线被磁捕获的条件，证明在此处使用的归一化下，捕获条件可以写成 $\\lambda b_{\\max} > 1$。然后，假设在 $\\theta=0$ 处速度方向是各向同性的（因此螺距角的余弦 $u \\equiv \\cos \\alpha_{0}$ 在 $[-1,1]$ 上均匀分布），计算磁面上捕获粒子的精确份额 $f_{t}(\\epsilon)$ 作为 $\\epsilon$ 的函数。\n\n最后，计算当 $\\epsilon = 0.2$ 时 $f_{t}$ 的值，并将数值结果以无量纲小数的形式报告。将答案四舍五入到四位有效数字。",
            "solution": "问题要求从大环径比托卡马克中粒子运动的标准模型推导出两个主要结果：第一，粒子被磁捕获的条件；第二，在假设速度分布各向同性的情况下，给定磁面上捕获粒子的份额，并针对特定的逆环径比 $\\epsilon$ 进行计算。\n\n首先，我们推导磁捕获的条件。粒子沿磁力线的运动由其总动能 $E$ 和磁矩 $\\mu$ 的守恒所支配。表达式如下：\n$$\nE = \\frac{1}{2} m (v_{\\perp}^{2} + v_{\\|}^{2}) = \\text{常数}\n$$\n$$\n\\mu = \\frac{m v_{\\perp}^{2}}{2 B} = \\text{常数}\n$$\n此处，$m$ 是粒子质量，$v_{\\perp}$ 是垂直于磁场 $\\vec{B}$ 的速度分量，$v_{\\|}$ 是平行于 $\\vec{B}$ 的速度分量，且 $B=|\\vec{B}|$。根据 $\\mu$ 的定义，我们可以将垂直动能表示为 $\\frac{1}{2}m v_{\\perp}^{2} = \\mu B$。将此代入能量守恒方程可得：\n$$\nE = \\mu B(\\theta) + \\frac{1}{2} m v_{\\|}^{2}(\\theta)\n$$\n这里我们明确地指出了 $B$ 和 $v_{\\|}$ 对极向角 $\\theta$ 的依赖关系。我们可以解出 $v_{\\|}^{2}$：\n$$\nv_{\\|}^{2}(\\theta) = \\frac{2}{m}(E - \\mu B(\\theta))\n$$\n如果一个粒子的平行运动在完成一个完整的极向环绕之前，在沿磁力线的某一点反向，则该粒子被认为是“捕获”的。这个反转点，称为弹跳点或转折点 $\\theta_b$，是 $v_{\\|}(\\theta_b) = 0$ 的地方。从 $v_{\\|}^{2}$ 的方程可知，这发生在粒子的总能量等于其垂直能量的时候：\n$$\nE = \\mu B(\\theta_b)\n$$\n由于 $v_{\\|}^{2}$ 必须为非负值，一个具有给定 $E$ 和 $\\mu$ 的粒子只能进入满足 $E \\ge \\mu B(\\theta)$ 的区域。磁场 $B(\\theta)$ 沿磁力线变化，在内侧中平面 ($\\theta = \\pi$) 达到最大值 $B_{\\max}$。如果一个粒子的能量 $E$ 小于可能的最大“势能” $\\mu B_{\\max}$，它将在到达磁场最大点之前被反射。因此，粒子被捕获的条件是：\n$$\nE  \\mu B_{\\max}\n$$\n对于通行粒子，它们有足够的平行能量来克服磁镜，其条件是 $E \\ge \\mu B_{\\max}$。\n为了使这个条件更实用，我们用参考位置处的物理量来表示 $E$ 和 $\\mu$，该参考位置是磁场最小的外侧中平面 ($\\theta=0$)，$B(0) = B_{\\min}$。在这个位置，总速度为 $v$，垂直速度为 $v_{\\perp}(0)$。守恒量为：\n$$\nE = \\frac{1}{2} m v^{2}\n$$\n$$\n\\mu = \\frac{m v_{\\perp}^{2}(0)}{2 B_{\\min}}\n$$\n将这些表达式代入捕获不等式 $E  \\mu B_{\\max}$ 中，得到：\n$$\n\\frac{1}{2} m v^{2}  \\left(\\frac{m v_{\\perp}^{2}(0)}{2 B_{\\min}}\\right) B_{\\max}\n$$\n我们可以消去两边的 $\\frac{1}{2}m$ 项，因为 $m>0$，这样做是有效的：\n$$\nv^{2}  \\frac{v_{\\perp}^{2}(0)}{B_{\\min}} B_{\\max}\n$$\n重新整理这个不等式，将无量纲的量组合在一起，我们得到：\n$$\n1  \\frac{v_{\\perp}^{2}(0)}{v^{2}} \\frac{B_{\\max}}{B_{\\min}}\n$$\n问题将外侧中平面的螺距角参数定义为 $\\lambda \\equiv v_{\\perp}^{2}(0)/v^{2}$，归一化磁场最大值定义为 $b_{\\max} \\equiv B_{\\max}/B_{\\min}$。使用这些定义，粒子被捕获的条件变为：\n$$\n\\lambda b_{\\max} > 1\n$$\n这与问题要求证明的条件一致，完成了推导的第一部分。\n\n接下来，我们计算捕获粒子的份额 $f_t(\\epsilon)$。问题指明在参考位置 $\\theta=0$ 处速度分布是各向同性的。这意味着在 $\\theta=0$ 处的螺距角余弦，记为 $u \\equiv \\cos \\alpha_{0} = v_{\\|}(0)/v$，在区间 $[-1, 1]$ 上是均匀分布的。\n螺距角参数 $\\lambda$ 可以用 $u$ 表示：\n$$\n\\lambda = \\frac{v_{\\perp}^{2}(0)}{v^{2}} = \\frac{v^{2} - v_{\\|}^{2}(0)}{v^{2}} = 1 - \\frac{v_{\\|}^{2}(0)}{v^{2}} = 1 - \\left(\\frac{v_{\\|}(0)}{v}\\right)^{2} = 1 - u^{2}\n$$\n将此代入捕获条件 $\\lambda b_{\\max} > 1$ 中：\n$$\n(1 - u^{2}) b_{\\max} > 1\n$$\n我们求解与捕获粒子对应的 $u$ 的范围：\n$$\n1 - u^{2} > \\frac{1}{b_{\\max}}\n$$\n$$\nu^{2}  1 - \\frac{1}{b_{\\max}}\n$$\n该不等式在 $-\\sqrt{1 - 1/b_{\\max}}  u  \\sqrt{1 - 1/b_{\\max}}$ 时成立。\n捕获粒子的份额是 $u$ 落入此区间的概率。由于 $u$ 在 $[-1, 1]$ 上均匀分布，其概率密度函数为 $p(u) = 1/2$（当 $u \\in [-1, 1]$），否则为 $0$。捕获份额 $f_t$ 可通过在捕获区域上对此概率密度进行积分得到：\n$$\nf_t = \\int_{-\\sqrt{1 - 1/b_{\\max}}}^{\\sqrt{1 - 1/b_{\\max}}} p(u) \\, du = \\int_{-\\sqrt{1 - 1/b_{\\max}}}^{\\sqrt{1 - 1/b_{\\max}}} \\frac{1}{2} \\, du = \\frac{1}{2} \\left[ u \\right]_{-\\sqrt{1 - 1/b_{\\max}}}^{\\sqrt{1 - 1/b_{\\max}}}\n$$\n$$\nf_t = \\frac{1}{2} \\left[ \\sqrt{1 - \\frac{1}{b_{\\max}}} - \\left(-\\sqrt{1 - \\frac{1}{b_{\\max}}}\\right) \\right] = \\sqrt{1 - \\frac{1}{b_{\\max}}}\n$$\n现在，我们用逆环径比 $\\epsilon$ 来表示这个份额。归一化最大磁场由 $b_{\\max} = \\frac{1+\\epsilon}{1-\\epsilon}$ 给出。将此代入 $f_t$ 的表达式中：\n$$\nf_t(\\epsilon) = \\sqrt{1 - \\frac{1}{(1+\\epsilon)/(1-\\epsilon)}} = \\sqrt{1 - \\frac{1-\\epsilon}{1+\\epsilon}}\n$$\n化简平方根内的项：\n$$\nf_t(\\epsilon) = \\sqrt{\\frac{(1+\\epsilon) - (1-\\epsilon)}{1+\\epsilon}} = \\sqrt{\\frac{1+\\epsilon-1+\\epsilon}{1+\\epsilon}} = \\sqrt{\\frac{2\\epsilon}{1+\\epsilon}}\n$$\n这就是捕获粒子份额作为 $\\epsilon$ 函数的精确解析表达式。\n\n最后，我们计算给定值 $\\epsilon = 0.2$ 时的 $f_t$：\n$$\nf_t(0.2) = \\sqrt{\\frac{2 \\times 0.2}{1 + 0.2}} = \\sqrt{\\frac{0.4}{1.2}} = \\sqrt{\\frac{1}{3}}\n$$\n为了得到数值，我们计算：\n$$\nf_t(0.2) = \\frac{1}{\\sqrt{3}} \\approx 0.577350269...\n$$\n按要求将此结果四舍五入到四位有效数字，得到 $0.5774$。",
            "answer": "$$\n\\boxed{0.5774}\n$$"
        },
        {
            "introduction": "等离子体湍流的本质是能量在不同模式之间的非线性传递。最后一个练习将为你提供一次直接的计算体验，量化漂移波与纬向流之间的能量交换过程。通过亲手实现三波相互作用的计算，你将对如何利用通量管模拟来剖析复杂的湍流能量串级获得实践性的理解 。",
            "id": "3981576",
            "problem": "考虑一个静电、磁化等离子体的局域“磁通管”谱表示，其中垂直动力学在径向坐标 $x$ 和副法向坐标 $y$ 的二维周期性区域上进行处理。在静电、低频、回旋动理学极限下进行研究，其中垂直速度场由电叉磁（E×B）漂移给出，且垂直动力学可以由一个不可压缩流函数表示。在归一化的回旋动理学单位中，设静电势为流函数 $\\,\\phi(x,y,t)\\,$，并通过流函数的拉普拉斯算子定义涡量 $\\,\\zeta(x,y,t)\\,$。采用以下基本定义：\n- $\\,\\mathbf{v}_{E\\times B} = \\hat{\\mathbf{z}} \\times \\nabla \\phi\\,$，\n- $\\,\\zeta = \\nabla^2 \\phi\\,$，\n- $\\,J(\\phi,\\zeta) = \\partial_x \\phi\\,\\partial_y \\zeta - \\partial_y \\phi\\,\\partial_x \\zeta\\,$，\n- 与模式 $(k_x,k_y)$ 处的 E×B 流相关的垂直能量密度正比于 $\\,k_\\perp^2\\,|\\phi_{k_x,k_y}|^2\\,$，其中 $\\,k_\\perp^2 = k_x^2 + k_y^2\\,$。\n\n仅使用上述基本定义和周期性区域上傅里叶变换的性质，推导非线性项的谱三波相互作用形式，并由此推导出进入给定模式 $(k_x,k_y)$ 的非线性能量输运率的谱表达式。“三波”指的是满足 $\\,\\mathbf{k}=\\mathbf{p}+\\mathbf{q}\\,$ 的三个波矢 $(\\mathbf{k},\\mathbf{p},\\mathbf{q})$。“带状流”表示 $\\,k_y=0\\,$ 且 $\\,k_x\\neq 0\\,$ 的模式。“漂移波”表示 $\\,k_y\\neq 0\\,$ 的模式。你的任务是通过算法计算从漂移波到带状流的瞬时非线性能量输运率。为此，对每个带状流模式 $\\mathbf{k}$，仅对那些相互作用伙伴 $\\mathbf{p}$ 和 $\\mathbf{q}$ 均为漂移波模式的三波贡献进行求和。所有速率均以归一化的无量纲单位表示。\n\n需要遵守的实现细节：\n- 使用与 $x$ 和 $y$ 方向上 $\\,2\\pi\\,$ 周期性区域一致的整数波数 $\\,k_x, k_y \\in \\mathbb{Z}\\,$ 的离散谱集，从而使实空间中的导数对应于谱空间中的乘以 $\\,i k_x\\,$ 或 $\\,i k_y\\,$。\n- 设 $\\,\\phi_{k_x,k_y}\\,$ 为谱模式的复振幅。\n- 谱空间中的涡量满足 $\\,\\zeta_{k_x,k_y} = -k_\\perp^2\\,\\phi_{k_x,k_y}\\,$。\n- 进入带状流模式 $\\mathbf{k}$ 的非线性能量输运率，是通过将该模式的复振幅与从三波求和中得到的非线性谱项进行缩并，然后取实部来计算的，以产生一个有物理意义的速率。从漂移波到带状流的总输运是所有目标带状流模式输运率的总和。\n\n你的程序必须使用以下谱配置的测试套件，每个配置指定为模式元组 $\\,[(k_x,k_y),\\phi_{k_x,k_y}]\\,$ 的列表。对于所有情况，未列出的模式均视为零振幅。为每种情况计算一个标量，该标量表示从漂移波到该情况中存在的所有带状流模式的总非线性能量输运率，计算时仅使用其两个相互作用伙伴均为漂移波模式的三波组合。\n\n测试套件：\n1. 情况 A (两个漂移波形成一个带状流目标):\n   - 模式: $\\,[(1,1),\\,1.0+0.5i],\\,[(1,-1),\\,0.7-0.2i],\\,[(2,0),\\,0.05+0.01i]\\,$.\n2. 情况 B (仅带状流配置，无漂移波):\n   - 模式: $\\,[(1,0),\\,0.4+0.0i],\\,[(2,0),\\,-0.3+0.1i],\\,[(-1,0),\\,0.1-0.2i]\\,$.\n3. 情况 C (单个漂移波加一个带状流，不足以形成漂移-漂移三波):\n   - 模式: $\\,[(1,1),\\,0.6-0.5i],\\,[(2,0),\\,0.2+0.05i]\\,$.\n4. 情况 D (多个漂移波形成多个带状流目标，外加其他模式):\n   - 模式: $\\,[(2,2),\\,0.8+0.3i],\\,[(-1,-2),\\,-0.5+0.1i],\\,[(0,3),\\,0.4+0.9i],\\,[(1,-3),\\,0.3-0.6i],\\,[(1,2),\\,0.6-0.1i],\\,[(1,-2),\\,-0.2+0.4i],\\,[(3,2),\\,0.2+0.2i],\\,[(1,0),\\,0.15-0.05i],\\,[(2,0),\\,-0.1+0.05i],\\,[(3,0),\\,0.12-0.07i]\\,$.\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含情况 A-D 的四个标量结果，格式为方括号括起来的逗号分隔列表（例如，“[rA,rB,rC,rD]”）。每个标量必须是一个浮点数，表示该情况下从漂移波到带状流的非线性能量输运率，单位为归一化的无量纲单位。\n\n不允许外部输入。程序必须是自包含的，并直接根据提供的谱数据计算所要求的量。此问题不涉及角度；不需要角度单位。由于所有量都采用归一化的无量纲形式，因此不需要物理单位。",
            "solution": "该问题是有效的。这是一个计算等离子体物理学中的适定问题，具体涉及二维回旋动理学湍流中的非线性能量输运，该过程可通过 Hasegawa-Mima 方程或类似的涡量平流方程建模。所有定义都是标准的，计算目标清晰且可实现。\n\n解决方案需要推导非线性能量输运率的谱表达式，然后在指定的约束条件下为给定的测试用例实现数值计算。\n\n在此系统中，控制涡量 $\\,\\zeta(x,y,t)\\,$ 演化的基本方程是涡量平流方程，在没有线性和耗散项的情况下，其形式为：\n$$\n\\frac{\\partial \\zeta}{\\partial t} + \\mathbf{v}_{E\\times B} \\cdot \\nabla \\zeta = 0\n$$\n非线性平流项可以使用雅可比算子 $\\,J(\\phi,\\zeta)\\,$ 写成：\n$$\n\\mathbf{v}_{E\\times B} \\cdot \\nabla \\zeta = (\\hat{\\mathbf{z}} \\times \\nabla \\phi) \\cdot \\nabla \\zeta = \\frac{\\partial \\phi}{\\partial x}\\frac{\\partial \\zeta}{\\partial y} - \\frac{\\partial \\phi}{\\partial y}\\frac{\\partial \\zeta}{\\partial x} = J(\\phi, \\zeta)\n$$\n因此，控制方程为 $\\,\\partial_t \\zeta = -J(\\phi, \\zeta)\\,$。我们在一个大小为 $\\,2\\pi \\times 2\\pi\\,$ 的双周期区域上，用傅里叶复振幅表示场 $\\,\\phi\\,$ 和 $\\,\\zeta\\,$：\n$$\n\\phi(x,y) = \\sum_{\\mathbf{k}} \\phi_{\\mathbf{k}} e^{i(k_x x + k_y y)} \\quad , \\quad \\zeta(x,y) = \\sum_{\\mathbf{k}} \\zeta_{\\mathbf{k}} e^{i(k_x x + k_y y)}\n$$\n其中 $\\,\\mathbf{k}=(k_x, k_y)\\,$ 是具有整数分量的波矢。\n在谱空间中，空间导数变为代数乘法：$\\,\\partial_x \\rightarrow i k_x\\,$ 和 $\\,\\partial_y \\rightarrow i k_y\\,$。拉普拉斯算子变为 $\\,\\nabla^2 \\rightarrow -(k_x^2+k_y^2) = -k_\\perp^2\\,$。关系式 $\\,\\zeta = \\nabla^2\\phi\\,$ 变为：\n$$\n\\zeta_{\\mathbf{k}} = -k_\\perp^2 \\phi_{\\mathbf{k}}\n$$\n非线性雅可比项 $\\,J(\\phi, \\zeta)\\,$ 的傅里叶变换是关于波矢的卷积。让我们用 $\\,J_{\\mathbf{k}}\\,$ 表示雅可比算子的谱表示：\n$$\nJ_{\\mathbf{k}} = \\mathcal{F}[J(\\phi, \\zeta)]_{\\mathbf{k}} = \\sum_{\\mathbf{p}+\\mathbf{q}=\\mathbf{k}} (p_y q_x - p_x q_y) \\phi_{\\mathbf{p}} \\zeta_{\\mathbf{q}}\n$$\n求和遍及所有相加得到目标波矢 $\\,\\mathbf{k}\\,$ 的波矢对 $\\,(\\mathbf{p}, \\mathbf{q})\\,$。这种三波矢相互作用被称为三波相互作用。项 $\\,p_y q_x - p_x q_y\\,$ 是叉积 $\\,\\mathbf{q} \\times \\mathbf{p}\\,$ 的 z 分量。谱空间中的涡量演化方程为：\n$$\n\\frac{\\partial \\zeta_{\\mathbf{k}}}{\\partial t} = -J_{\\mathbf{k}}\n$$\n使用关系式 $\\,\\zeta_{\\mathbf{k}} = -k_\\perp^2 \\phi_{\\mathbf{k}}\\,$, 我们得到势 $\\,\\phi_{\\mathbf{k}}\\,$ 的演化方程（对于 $\\,k_\\perp \\neq 0\\,$）：\n$$\n-k_\\perp^2 \\frac{\\partial \\phi_{\\mathbf{k}}}{\\partial t} = -J_{\\mathbf{k}} \\implies \\frac{\\partial \\phi_{\\mathbf{k}}}{\\partial t} = \\frac{J_{\\mathbf{k}}}{k_\\perp^2}\n$$\n与模式 $\\,\\mathbf{k}\\,$ 相关的垂直动能密度被给出为正比于 $\\,k_\\perp^2 |\\phi_{\\mathbf{k}}|^2\\,$。让我们将能量定义为 $\\,E_{\\mathbf{k}} = \\frac{1}{2} k_\\perp^2 |\\phi_{\\mathbf{k}}|^2 = \\frac{1}{2} k_\\perp^2 \\phi_{\\mathbf{k}} \\phi_{\\mathbf{k}}^*\\,$. 该能量的变化率，即非线性能量输运率 $\\,T_{\\mathbf{k}}\\,$，为：\n$$\nT_{\\mathbf{k}} = \\frac{dE_{\\mathbf{k}}}{dt} = \\frac{1}{2} k_\\perp^2 \\left( \\frac{\\partial \\phi_{\\mathbf{k}}}{\\partial t} \\phi_{\\mathbf{k}}^* + \\phi_{\\mathbf{k}} \\frac{\\partial \\phi_{\\mathbf{k}}^*}{\\partial t} \\right) = k_\\perp^2 \\text{Re}\\left( \\frac{\\partial \\phi_{\\mathbf{k}}}{\\partial t} \\phi_{\\mathbf{k}}^* \\right)\n$$\n代入 $\\,\\partial_t \\phi_{\\mathbf{k}}\\,$ 的表达式：\n$$\nT_{\\mathbf{k}} = k_\\perp^2 \\text{Re}\\left( \\frac{J_{\\mathbf{k}}}{k_\\perp^2} \\phi_{\\mathbf{k}}^* \\right) = \\text{Re}( J_{\\mathbf{k}} \\phi_{\\mathbf{k}}^* )\n$$\n这个表达式与问题中将复振幅与非线性项进行缩并的指令是一致的。在这里，$\\,J_\\mathbf{k}\\,$ 是驱动能量动力学的相关非线性项。\n\n为了得到 $\\,J_{\\mathbf{k}}\\,$ 的一个计算上对称的形式，我们利用卷积和的性质。交换哑指标 $\\,\\mathbf{p}\\,$ 和 $\\,\\mathbf{q}\\,$，并使用 $\\,\\zeta_{\\mathbf{p}} = -p_\\perp^2 \\phi_{\\mathbf{p}}\\,$ 和 $\\,\\zeta_{\\mathbf{q}} = -q_\\perp^2 \\phi_{\\mathbf{q}}\\,$, 我们可以将 $\\,J_{\\mathbf{k}}\\,$ 写为：\n$$\nJ_{\\mathbf{k}} = \\frac{1}{2} \\sum_{\\mathbf{p}+\\mathbf{q}=\\mathbf{k}} (p_y q_x - p_x q_y) (\\phi_{\\mathbf{p}} \\zeta_{\\mathbf{q}} - \\phi_{\\mathbf{q}} \\zeta_{\\mathbf{p}})\n$$\n$$\nJ_{\\mathbf{k}} = \\frac{1}{2} \\sum_{\\mathbf{p}+\\mathbf{q}=\\mathbf{k}} (p_y q_x - p_x q_y) (\\phi_{\\mathbf{p}} (-q_\\perp^2 \\phi_{\\mathbf{q}}) - \\phi_{\\mathbf{q}} (-p_\\perp^2 \\phi_{\\mathbf{p}}))\n$$\n$$\nJ_{\\mathbf{k}} = \\frac{1}{2} \\sum_{\\mathbf{p}+\\mathbf{q}=\\mathbf{k}} (p_y q_x - p_x q_y) (p_\\perp^2 - q_\\perp^2) \\phi_{\\mathbf{p}} \\phi_{\\mathbf{q}}\n$$\n该问题要求计算从漂移波到带状流的总能量输运率。这涉及到对所有带状流模式 $\\,\\mathbf{k}\\,$（其中 $\\,k_y=0, k_x \\neq 0\\,$）的 $\\,T_{\\mathbf{k}}\\,$ 进行求和，其条件是相互作用的三波伙伴 $\\,\\mathbf{p}\\,$ 和 $\\,\\mathbf{q}\\,$ 必须都是漂移波模式（即 $\\,p_y \\neq 0\\,$ 且 $\\,q_y \\neq 0\\,$）。\n对于一个目标带状流模式 $\\,\\mathbf{k}=(k_x, 0)\\,$，三波条件 $\\,\\mathbf{k}=\\mathbf{p}+\\mathbf{q}\\,$ 意味着 $\\,p_y+q_y=0\\,$，或 $\\,q_y=-p_y\\,$。由于 $\\,\\mathbf{p}\\,$ 和 $\\,\\mathbf{q}\\,$ 都必须是漂移波，这意味着 $\\,p_y \\neq 0\\,$。\n\n要实现的算法如下：\n1. 对每个测试用例，将提供的谱数据解析到一个字典中，该字典将波矢 $\\,(k_x, k_y)\\,$ 映射到它们的复振幅 $\\,\\phi_{k_x, k_y}\\,$。\n2. 从该字典的键中识别出带状流模式集和漂移波模式集。\n3. 将从漂移波到带状流的总能量输运率初始化为零。\n4. 遍历每个带状流模式 $\\,\\mathbf{k}\\,$ 作为目标模式。\n5. 对于每个 $\\,\\mathbf{k}\\,$，通过对所有作为漂移波的可能相互作用伙伴 $\\,\\mathbf{p}\\,$ 进行求和来计算其非线性驱动 $\\,J_{\\mathbf{k}}\\,$。第二个伙伴 $\\,\\mathbf{q}\\,$ 由 $\\,\\mathbf{q} = \\mathbf{k}-\\mathbf{p}\\,$ 确定。我们必须验证这个 $\\,\\mathbf{q}\\,$ 也存在于给定的漂移波模式列表中。\n6. 该求和将每对 $\\,(\\mathbf{p},\\mathbf{q})\\,$ 计算两次（一次是 $\\,(\\mathbf{p},\\mathbf{q})\\,$，一次是 $\\,(\\mathbf{q},\\mathbf{p})\\,$），因此通过对所有有序对求和并将结果除以 2，可以正确实现带有因子 $\\,1/2\\,$ 的对称化公式。该算法将遍历 $\\,\\mathbf{p}\\,$，找到 $\\,\\mathbf{q}\\,$，并执行计算；这自然地将每次相互作用计数两次，因此最终除以 2 是合适的。\n7. 来自单个三波组合 $\\,(\\mathbf{k}, \\mathbf{p}, \\mathbf{q})\\,$ 对 $\\,J_{\\mathbf{k}}\\,$ 的贡献由求和内的项给出。\n8. 一旦对于一个带状流模式 $\\,\\mathbf{k}\\,$ 的 $\\,J_{\\mathbf{k}}\\,$ 被完全计算出来，进入该模式的能量输运率为 $\\,T_{\\mathbf{k}} = \\text{Re}(\\phi_{\\mathbf{k}}^* J_{\\mathbf{k}})\\,$。\n9. 对所有带状流模式 $\\,\\mathbf{k}\\,$ 的 $\\,T_{\\mathbf{k}}\\,$ 求和，以获得给定测试用例的总输运率。\n此过程将应用于所有四个测试用例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the nonlinear energy transfer rate from drift waves to zonal flows\n    for a series of test cases in a 2D gyrokinetic model.\n    \"\"\"\n\n    test_cases = [\n        # Case A: two drift waves forming a single zonal target\n        [((1, 1), 1.0 + 0.5j), ((1, -1), 0.7 - 0.2j), ((2, 0), 0.05 + 0.01j)],\n        # Case B: zonal-only configuration, no drift waves\n        [((1, 0), 0.4 + 0.0j), ((2, 0), -0.3 + 0.1j), ((-1, 0), 0.1 - 0.2j)],\n        # Case C: single drift wave plus a zonal, insufficient for a drift-drift triad\n        [((1, 1), 0.6 - 0.5j), ((2, 0), 0.2 + 0.05j)],\n        # Case D: multiple drift waves forming multiple zonal targets\n        [\n            ((2, 2), 0.8 + 0.3j), ((-1, -2), -0.5 + 0.1j), ((0, 3), 0.4 + 0.9j),\n            ((1, -3), 0.3 - 0.6j), ((1, 2), 0.6 - 0.1j), ((1, -2), -0.2 + 0.4j),\n            ((3, 2), 0.2 + 0.2j), ((1, 0), 0.15 - 0.05j), ((2, 0), -0.1 + 0.05j),\n            ((3, 0), 0.12 - 0.07j)\n        ],\n    ]\n\n    results = []\n    for case_modes in test_cases:\n        phi_map = {k_vec: amp for k_vec, amp in case_modes}\n        \n        all_k_vecs = set(phi_map.keys())\n        zonal_k_vecs = {k for k in all_k_vecs if k[1] == 0 and k[0] != 0}\n        drift_k_vecs = {k for k in all_k_vecs if k[1] != 0}\n\n        total_transfer_case = 0.0\n\n        if not drift_k_vecs:\n            results.append(0.0)\n            continue\n\n        for k_vec in zonal_k_vecs:\n            kx, ky = k_vec\n            \n            # This is the spectral representation of the Jacobian J(phi, zeta) for mode k.\n            J_k = 0.0j\n            \n            # Sum over all interacting drift-wave modes p.\n            for p_vec in drift_k_vecs:\n                px, py = p_vec\n                \n                # Determine the required partner mode q.\n                q_vec = (kx - px, ky - py)\n                \n                # Check if q is a drift wave and exists in the system.\n                # Since ky=0 and py!=0, qy=-py!=0, so q is automatically a drift wave.\n                # We only need to check if it's in the provided modes.\n                if q_vec not in drift_k_vecs:\n                    continue\n\n                qx, qy = q_vec\n                \n                phi_p = phi_map[p_vec]\n                phi_q = phi_map[q_vec]\n                \n                p_perp_sq = px**2 + py**2\n                q_perp_sq = qx**2 + qy**2\n                \n                # Symmetrized coupling coefficient for the triad (k, p, q)\n                # C(p,q) = (py*qx - px*qy) * (p_perp^2 - q_perp^2)\n                coupling_coeff = (py * qx - px * qy) * (p_perp_sq - q_perp_sq)\n                \n                J_k += coupling_coeff * phi_p * phi_q\n\n            # The loop over p_vec counts each (p,q) pair a second time as (q,p).\n            # The symmetric form of J_k requires a 1/2 factor to correct this.\n            J_k *= 0.5\n            \n            # Calculate energy transfer rate for mode k: T_k = Re(phi_k^* * J_k)\n            phi_k_conj = phi_map[k_vec].conjugate()\n            T_k = (phi_k_conj * J_k).real\n            \n            total_transfer_case += T_k\n\n        results.append(total_transfer_case)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}