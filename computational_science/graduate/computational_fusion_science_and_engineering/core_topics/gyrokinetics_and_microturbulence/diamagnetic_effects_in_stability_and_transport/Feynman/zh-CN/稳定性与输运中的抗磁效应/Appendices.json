{
    "hands_on_practices": [
        {
            "introduction": "在磁化等离子体中，压力梯度是驱动多种物理现象的关键因素。这项练习将引导我们从基本的磁流体动力学（MHD）离子动量平衡方程出发，推导出抗磁漂移速度的表达式。通过这个实践，我们不仅能深入理解压力梯度力与洛伦兹力平衡如何产生垂直于磁场的粒子漂移，还能在具体的托卡马克等离子体参数下，亲手计算出这一漂移速度的大小和方向 。",
            "id": "3965270",
            "problem": "考虑一个大环径比的托卡马克等离子体，其中的磁场以环向为主，且可以局部地模拟为均匀磁场 $\\mathbf{B} = +B\\,\\mathbf{e}_{\\phi}$，其正交归一基矢为 $\\{\\mathbf{e}_{r}, \\mathbf{e}_{\\phi}, \\mathbf{e}_{\\theta}\\}$，满足 $\\mathbf{e}_{r} \\times \\mathbf{e}_{\\phi} = \\mathbf{e}_{\\theta}$。假设离子为单电荷（$q_{i} = +e$），可忽略的碰撞摩擦、可忽略的惯性项以及可忽略的电场。离子压力随径向变化，其形式为 $\\nabla p_{i} = (\\partial_{r} p_{i})\\,\\mathbf{e}_{r}$。从磁流体动力学（MHD）的稳态离子动量平衡方程出发，推导垂直于 $\\mathbf{B}$ 的离子逆磁漂移速度的闭合表达式，并确定其相对于环向场方向的极向分量。给定 $B = 5\\,\\mathrm{T}$，$n_{i} = 10^{20}\\,\\mathrm{m^{-3}}$，以及 $\\partial_{r} p_{i} = -5 \\times 10^{5}\\,\\mathrm{Pa/m}$，计算带符号的极向离子逆磁漂移速度 $v_{*i,\\theta}$，其中符号约定为，当 $\\mathbf{B} = +B\\,\\mathbf{e}_{\\phi}$ 时，$v_{*i,\\theta} > 0$ 对应于沿 $+\\mathbf{e}_{\\theta}$ 方向的运动。用单位 $\\mathrm{m/s}$ 表示最终数值答案，并四舍五入到四位有效数字。",
            "solution": "首先对问题进行严格的验证过程。\n\n### 第1步：提取已知条件\n-   **系统**：大环径比托卡马克等离子体。\n-   **磁场**：$\\mathbf{B} = +B\\,\\mathbf{e}_{\\phi}$（局部均匀且为环向）。\n-   **坐标系**：正交归一基矢 $\\{\\mathbf{e}_{r}, \\mathbf{e}_{\\phi}, \\mathbf{e}_{\\theta}\\}$ 满足关系 $\\mathbf{e}_{r} \\times \\mathbf{e}_{\\phi} = \\mathbf{e}_{\\theta}$。\n-   **离子性质**：单电荷离子，$q_{i} = +e$。\n-   **假设**：\n    1.  稳态（$\\partial/\\partial t = 0$）。\n    2.  可忽略的碰撞摩擦。\n    3.  可忽略的惯性项（$m_i n_i (\\mathbf{v}_i \\cdot \\nabla) \\mathbf{v}_i \\approx 0$）。\n    4.  可忽略的电场（$\\mathbf{E} \\approx 0$）。\n-   **离子压力梯度**：$\\nabla p_{i} = (\\partial_{r} p_{i})\\,\\mathbf{e}_{r}$。\n-   **初始方程**：磁流体动力学（MHD）的稳态离子动量平衡方程。\n-   **任务1**：推导垂直于 $\\mathbf{B}$ 的离子逆磁漂移速度的闭合表达式。\n-   **任务2**：根据给定的坐标系，确定其极向分量 $v_{*i,\\theta}$。\n-   **任务3**：计算 $v_{*i,\\theta}$ 的带符号值。\n-   **数值数据**：\n    -   $B = 5\\,\\mathrm{T}$\n    -   $n_{i} = 10^{20}\\,\\mathrm{m^{-3}}$\n    -   $\\partial_{r} p_{i} = -5 \\times 10^{5}\\,\\mathrm{Pa/m}$\n-   **符号约定**：当 $\\mathbf{B} = +B\\,\\mathbf{e}_{\\phi}$ 时，$v_{*i,\\theta} > 0$ 对应于沿 $+\\mathbf{e}_{\\theta}$ 方向的运动。\n-   **输出格式**：最终数值答案以 $\\mathrm{m/s}$ 为单位，并四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在科学上基于应用于聚变等离子体的磁流体动力学（MHD）原理。逆磁漂移的概念是在有压力梯度的磁化等离子体中力平衡的一个基本结果。该问题提法恰当，提供了一个清晰的起点（MHD动量方程）、一套标准的简化假设以及所有必要的数据，以得出一个唯一的数值解。语言客观而精确。所指定的坐标系，尽管对于托卡马克来说是一个非标准的标记法，但在数学上是自洽的，并由关系式 $\\mathbf{e}_{r} \\times \\mathbf{e}_{\\phi} = \\mathbf{e}_{\\theta}$ 明确定义。给定的磁场强度、离子密度和压力梯度的数值对于现代托卡马克是物理上现实的。该问题没有违反任何基本原理，不是不完整或矛盾的，并且是核心等离子体物理概念的一个非平凡应用。\n\n### 第3步：结论与行动\n该问题被认为是有效的。将提供完整的解答。\n\n### 推导与计算\n起点是MHD模型中离子流体的稳态动量平衡方程：\n$$\nm_{i} n_{i} (\\mathbf{v}_{i} \\cdot \\nabla)\\mathbf{v}_{i} = n_{i} q_{i} (\\mathbf{E} + \\mathbf{v}_{i} \\times \\mathbf{B}) - \\nabla p_{i} - \\mathbf{R}\n$$\n其中 $m_{i}$ 是离子质量， $n_{i}$ 是离子数密度， $\\mathbf{v}_{i}$ 是离子流体速度， $q_{i}$ 是离子电荷， $\\mathbf{E}$ 是电场， $\\mathbf{B}$ 是磁场， $p_{i}$ 是离子压力， $\\mathbf{R}$ 代表由碰撞（摩擦）引起的动量传递。\n\n应用问题的假设：\n1.  惯性项可忽略：$m_{i} n_{i} (\\mathbf{v}_{i} \\cdot \\nabla)\\mathbf{v}_{i} \\approx 0$。\n2.  电场可忽略：$\\mathbf{E} \\approx 0$。\n3.  碰撞摩擦可忽略：$\\mathbf{R} \\approx 0$。\n并且给定 $q_{i} = +e$。\n\n动量方程简化为离子的理想力平衡方程：\n$$\n0 \\approx n_{i} e (\\mathbf{v}_{i} \\times \\mathbf{B}) - \\nabla p_{i}\n$$\n该方程建立了洛伦兹力与压力梯度力之间的平衡。重新整理以求解速度项，得到：\n$$\nn_{i} e (\\mathbf{v}_{i} \\times \\mathbf{B}) = \\nabla p_{i}\n$$\n在此方程中，速度 $\\mathbf{v}_{i}$ 必须垂直于 $\\mathbf{B}$，叉积才不为零。这个垂直速度就是逆磁漂移速度，我们记作 $\\mathbf{v}_{*i}$。因此，$\\mathbf{v}_{i} = \\mathbf{v}_{*i}$（在垂直平面内）。\n$$\nn_{i} e (\\mathbf{v}_{*i} \\times \\mathbf{B}) = \\nabla p_{i}\n$$\n为了分离出 $\\mathbf{v}_{*i}$，我们将整个方程从右侧与 $\\mathbf{B}$ 做叉积：\n$$\n(n_{i} e (\\mathbf{v}_{*i} \\times \\mathbf{B})) \\times \\mathbf{B} = \\nabla p_{i} \\times \\mathbf{B}\n$$\n$$\nn_{i} e ((\\mathbf{v}_{*i} \\times \\mathbf{B}) \\times \\mathbf{B}) = \\nabla p_{i} \\times \\mathbf{B}\n$$\n使用矢量三重积恒等式 $(\\mathbf{A} \\times \\mathbf{B}) \\times \\mathbf{C} = (\\mathbf{A} \\cdot \\mathbf{C})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{C})\\mathbf{A}$，其中 $\\mathbf{A} = \\mathbf{v}_{*i}$ 且 $\\mathbf{B} = \\mathbf{C} = \\mathbf{B}$，我们得到：\n$$\n(\\mathbf{v}_{*i} \\times \\mathbf{B}) \\times \\mathbf{B} = (\\mathbf{v}_{*i} \\cdot \\mathbf{B})\\mathbf{B} - (\\mathbf{B} \\cdot \\mathbf{B})\\mathbf{v}_{*i}\n$$\n根据定义，漂移速度 $\\mathbf{v}_{*i}$ 垂直于 $\\mathbf{B}$，因此 $\\mathbf{v}_{*i} \\cdot \\mathbf{B} = 0$。此外，$\\mathbf{B} \\cdot \\mathbf{B} = B^2$。该恒等式简化为：\n$$\n(\\mathbf{v}_{*i} \\times \\mathbf{B}) \\times \\mathbf{B} = -B^2 \\mathbf{v}_{*i}\n$$\n将此代入力平衡方程：\n$$\nn_{i} e (-B^2 \\mathbf{v}_{*i}) = \\nabla p_{i} \\times \\mathbf{B}\n$$\n求解 $\\mathbf{v}_{*i}$ 得到离子逆磁漂移速度的闭合表达式：\n$$\n\\mathbf{v}_{*i} = - \\frac{\\nabla p_{i} \\times \\mathbf{B}}{n_{i} e B^2} = \\frac{\\mathbf{B} \\times \\nabla p_{i}}{n_{i} e B^2}\n$$\n这完成了第一个任务。\n\n接下来，我们确定极向分量。问题提供了：\n-   $\\mathbf{B} = B\\,\\mathbf{e}_{\\phi}$\n-   $\\nabla p_{i} = (\\partial_{r} p_{i})\\,\\mathbf{e}_{r}$\n将这些代入 $\\mathbf{v}_{*i}$ 的表达式中：\n$$\n\\mathbf{v}_{*i} = \\frac{(B\\,\\mathbf{e}_{\\phi}) \\times ((\\partial_{r} p_{i})\\,\\mathbf{e}_{r})}{n_{i} e B^2} = \\frac{B (\\partial_{r} p_{i})}{n_{i} e B^2} (\\mathbf{e}_{\\phi} \\times \\mathbf{e}_{r}) = \\frac{\\partial_{r} p_{i}}{n_{i} e B} (\\mathbf{e}_{\\phi} \\times \\mathbf{e}_{r})\n$$\n坐标系由 $\\mathbf{e}_{r} \\times \\mathbf{e}_{\\phi} = \\mathbf{e}_{\\theta}$ 定义。利用叉积的反交换律，我们有 $\\mathbf{e}_{\\phi} \\times \\mathbf{e}_{r} = -(\\mathbf{e}_{r} \\times \\mathbf{e}_{\\phi}) = -\\mathbf{e}_{\\theta}$。\n将此方向矢量代回速度表达式中：\n$$\n\\mathbf{v}_{*i} = \\frac{\\partial_{r} p_{i}}{n_{i} e B} (-\\mathbf{e}_{\\theta}) = - \\frac{\\partial_{r} p_{i}}{n_{i} e B} \\mathbf{e}_{\\theta}\n$$\n矢量 $\\mathbf{v}_{*i}$ 完全在极向 $\\mathbf{e}_{\\theta}$ 方向上。标量极向分量 $v_{*i,\\theta}$ 是 $\\mathbf{e}_{\\theta}$ 的系数：\n$$\nv_{*i,\\theta} = - \\frac{\\partial_{r} p_{i}}{n_{i} e B}\n$$\n这完成了第二个任务。\n\n最后，我们使用所提供的数据计算 $v_{*i,\\theta}$ 的数值：\n-   $\\partial_{r} p_{i} = -5 \\times 10^{5}\\,\\mathrm{Pa/m}$\n-   $n_{i} = 10^{20}\\,\\mathrm{m^{-3}}$\n-   $B = 5\\,\\mathrm{T}$\n-   $e \\approx 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$（元电荷）\n\n代入这些值：\n$$\nv_{*i,\\theta} = - \\frac{-5 \\times 10^{5}\\,\\mathrm{Pa/m}}{(10^{20}\\,\\mathrm{m^{-3}}) (1.602176634 \\times 10^{-19}\\,\\mathrm{C}) (5\\,\\mathrm{T})}\n$$\n$$\nv_{*i,\\theta} = \\frac{5 \\times 10^{5}}{(10^{20}) (1.602176634 \\times 10^{-19}) (5)}\\,\\mathrm{m/s}\n$$\n$$\nv_{*i,\\theta} = \\frac{5 \\times 10^{5}}{(1.602176634 \\times 10^{1}) (5)}\\,\\mathrm{m/s}\n$$\n$$\nv_{*i,\\theta} = \\frac{5 \\times 10^{5}}{80.1088317}\\,\\mathrm{m/s}\n$$\n$$\nv_{*i,\\theta} = 6241.5090... \\,\\mathrm{m/s}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nv_{*i,\\theta} \\approx 6242\\,\\mathrm{m/s}\n$$\n正号表示漂移速度方向为 $+\\mathbf{e}_{\\theta}$，与问题的符号约定一致。",
            "answer": "$$\n\\boxed{6242}\n$$"
        },
        {
            "introduction": "理解了抗磁漂移速度后，下一步是探究其如何影响等离子体中的波动和不稳定性，这通常通过相关的频率来描述。这项练习将理论物理与计算模拟联系起来，我们首先会推导电子抗磁频率，然后学习如何将其转换为现代回旋动理学（gyrokinetic）代码中常用的无量纲单位 。掌握这种单位归一化方法，对于解读模拟结果并将其与真实物理参数相关联至关重要。",
            "id": "3965282",
            "problem": "考虑一个用于磁化等离子体微观不稳定性回旋动理学 (GK) 建模的局域平板平衡，其中均匀磁场 $B_0$ 沿 $\\hat{\\mathbf{z}}$ 方向，平衡梯度存在于径向坐标 $x$ 上。平衡密度 $n(x)$ 和电子温度 $T_e(x)$ 向外减小，并由特征长度 $L_n$ 和 $L_T$ 表征，其定义分别为 $L_n^{-1} = - \\frac{d \\ln n}{dx}$ 和 $L_T^{-1} = - \\frac{d \\ln T_e}{dx}$。抗磁效应通过各粒子种类的抗磁频率进入 GK 方程。从磁化漂移动理学的第一性原理出发，推导电子抗磁频率，并用 GK 程序中常用的归一化单位表示，其中 $\\hat{\\omega} \\equiv \\omega \\frac{a}{c_s}$ 且 $\\hat{k}_y \\equiv k_y \\rho_s$。此处，$a$ 是特征小半径，$c_s = \\sqrt{\\frac{T_e}{m_i}}$ 是用电子温度定义的离子声速，$\\rho_s = \\frac{c_s}{\\Omega_i}$ 是离子声速回旋半径，$\\Omega_i = \\frac{e B_0}{m_i}$ 是离子回旋频率。使用电子电荷 $q_e = - e$，并假设所求抗磁频率的粒子种类的温度等于 $c_s$ 中使用的参考温度 $T_e$。明确地展示抗磁频率如何依赖于归一化波数 $\\hat{k}_y$ 和无量纲梯度比 $\\frac{a}{L_n}$ 及 $\\frac{a}{L_T}$。\n\n然后，对于以下科学上合理的参数，计算归一化的电子抗磁频率：\n- $L_n = 0.30\\,\\mathrm{m}$，$L_T = 0.20\\,\\mathrm{m}$，\n- $a = 0.50\\,\\mathrm{m}$，\n- $\\hat{k}_y = k_y \\rho_s = 0.300$。\n\n将最终答案表示为一个无量纲数，并四舍五入至四位有效数字。",
            "solution": "题目陈述经评估具有科学依据、良定、客观且自洽。它没有科学缺陷、矛盾或歧义。所有给定的定义和参数在计算聚变科学领域都是标准的，并且在物理上是合理的。因此，我将进行推导和计算。\n\n主要任务是推导电子抗磁频率 $\\omega_{*e}$，并将其表示为回旋动理学 (GK) 模拟中的标准归一化形式。推导从平衡态下等离子体流体动力学的基本原理开始。\n\n由下标 $s$ 表示的磁化等离子体流体粒子种类的平衡态，由洛伦兹力与压力梯度力之间的平衡来描述。这可以从流体动量方程的稳态、零电场极限得到：\n$$q_s n_s (\\mathbf{u}_s \\times \\mathbf{B}) - \\nabla p_s = 0$$\n此处，$q_s$ 是粒子种类电荷，$n_s$ 是数密度，$\\mathbf{u}_s$ 是流体速度，$\\mathbf{B}$ 是磁场，$p_s$ 是标量压力。问题指定了均匀磁场 $\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$ 且梯度仅存在于 $x$ 方向，因此 $\\nabla p_s = \\frac{dp_s}{dx} \\hat{\\mathbf{x}}$。\n\n力平衡方程变为：\n$$q_s n_s (\\mathbf{u}_s \\times B_0 \\hat{\\mathbf{z}}) = \\frac{dp_s}{dx} \\hat{\\mathbf{x}}$$\n由此平衡产生的垂直于 $\\mathbf{B}$ 的速度分量是抗磁漂移速度 $\\mathbf{v}_{d,s}$。由于力在 $\\hat{\\mathbf{x}}$ 方向上，漂移必然在 $\\hat{\\mathbf{y}}$ 方向上。令 $\\mathbf{u}_s = v_{d,s} \\hat{\\mathbf{y}}$。方程为：\n$$q_s n_s (v_{d,s} \\hat{\\mathbf{y}} \\times B_0 \\hat{\\mathbf{z}}) = \\frac{dp_s}{dx} \\hat{\\mathbf{x}}$$\n使用矢量恒等式 $\\hat{\\mathbf{y}} \\times \\hat{\\mathbf{z}} = \\hat{\\mathbf{x}}$，我们得到：\n$$q_s n_s v_{d,s} B_0 \\hat{\\mathbf{x}} = \\frac{dp_s}{dx} \\hat{\\mathbf{x}}$$\n解出抗磁漂移速率 $v_{d,s}$ 得到：\n$$v_{d,s} = \\frac{1}{q_s n_s B_0} \\frac{dp_s}{dx}$$\n该漂移在副法线 ($y$) 方向上。\n\n抗磁频率 $\\omega_{*s}$ 是与以抗磁漂移速度传播的波模相关的频率。对于在副法线方向上具有波矢分量 $k_y$ 的模式，该频率由多普勒频移 $\\omega_{*s} = k_y v_{d,s}$ 给出。\n$$\\omega_{*s} = k_y \\left(\\frac{1}{q_s n_s B_0} \\frac{dp_s}{dx}\\right)$$\n我们现在将此通用表达式具体化用于电子 (s=e)。电子电荷为 $q_e = -e$，电子压力为 $p_e = n_e T_e$。问题陈述该粒子种类的温度是参考电子温度 $T_e$。\n$$\\omega_{*e} = k_y \\left(\\frac{1}{(-e) n_e B_0} \\frac{d(n_e T_e)}{dx}\\right)$$\n压力梯度项使用乘法法则展开：\n$$\\frac{d(n_e T_e)}{dx} = T_e \\frac{dn_e}{dx} + n_e \\frac{dT_e}{dx}$$\n问题给出了梯度特征长度的定义：$L_n^{-1} = - \\frac{1}{n_e} \\frac{dn_e}{dx}$ 和 $L_T^{-1} = - \\frac{1}{T_e} \\frac{dT_e}{dx}$。由此，我们将梯度表示为 $\\frac{dn_e}{dx} = -\\frac{n_e}{L_n}$ 和 $\\frac{dT_e}{dx} = -\\frac{T_e}{L_T}$。将这些代入压力梯度展开式：\n$$\\frac{d(n_e T_e)}{dx} = T_e \\left(-\\frac{n_e}{L_n}\\right) + n_e \\left(-\\frac{T_e}{L_T}\\right) = -n_e T_e \\left(\\frac{1}{L_n} + \\frac{1}{L_T}\\right)$$\n现在，我们将其代回 $\\omega_{*e}$ 的表达式中：\n$$\\omega_{*e} = k_y \\left(\\frac{1}{(-e) n_e B_0}\\right) \\left[-n_e T_e \\left(\\frac{1}{L_n} + \\frac{1}{L_T}\\right)\\right]$$\n项 $-1$ 和 $n_e$ 消去，得到物理电子抗磁频率：\n$$\\omega_{*e} = k_y \\frac{T_e}{e B_0} \\left(\\frac{1}{L_n} + \\frac{1}{L_T}\\right)$$\n该频率可以分解为由密度梯度引起的部分 $\\omega_{*ne} = k_y \\frac{T_e}{e B_0 L_n}$ 和由电子温度梯度引起的部分 $\\omega_{*Te} = k_y \\frac{T_e}{e B_0 L_T}$。\n\n接下来，我们按规定对此频率进行归一化。归一化频率为 $\\hat{\\omega}_{*e} = \\omega_{*e} \\frac{a}{c_s}$。\n$$\\hat{\\omega}_{*e} = \\left[ k_y \\frac{T_e}{e B_0} \\left(\\frac{1}{L_n} + \\frac{1}{L_T}\\right) \\right] \\frac{a}{c_s}$$\n重新排列各项以组合已知的归一化量：\n$$\\hat{\\omega}_{*e} = k_y \\left( \\frac{a T_e}{c_s e B_0} \\right) \\left(\\frac{1}{L_n} + \\frac{1}{L_T}\\right)$$\n我们必须使用给定的定义来化简括号中的项：$c_s = \\sqrt{\\frac{T_e}{m_i}}$，$\\Omega_i = \\frac{e B_0}{m_i}$ 和 $\\rho_s = \\frac{c_s}{\\Omega_i}$。让我们用基本参数表示 $\\rho_s$：\n$$\\rho_s = \\frac{c_s}{\\Omega_i} = \\frac{\\sqrt{T_e/m_i}}{e B_0/m_i} = \\frac{\\sqrt{T_e}}{\\sqrt{m_i}} \\frac{m_i}{e B_0} = \\frac{\\sqrt{T_e m_i}}{e B_0}$$\n现在考察项 $\\frac{T_e}{c_s e B_0}$：\n$$\\frac{T_e}{c_s e B_0} = \\frac{T_e}{\\sqrt{T_e/m_i} (e B_0)} = \\frac{\\sqrt{T_e} \\sqrt{m_i}}{e B_0}$$\n将此与 $\\rho_s$ 的表达式进行比较，我们发现 $\\frac{T_e}{c_s e B_0} = \\rho_s$。\n将此结果代回 $\\hat{\\omega}_{*e}$ 的表达式中：\n$$\\hat{\\omega}_{*e} = k_y (a \\rho_s) \\left(\\frac{1}{L_n} + \\frac{1}{L_T}\\right)$$\n最后，我们重新排列，使其对 $\\hat{k}_y$、$a/L_n$ 和 $a/L_T$ 的依赖关系显式化。使用定义 $\\hat{k}_y = k_y \\rho_s$：\n$$\\hat{\\omega}_{*e} = (k_y \\rho_s) a \\left(\\frac{1}{L_n} + \\frac{1}{L_T}\\right) = \\hat{k}_y \\left(\\frac{a}{L_n} + \\frac{a}{L_T}\\right)$$\n这是归一化电子抗磁频率的最终解析表达式。\n\n最后，我们使用给定的数值参数计算该表达式：\n- $L_n = 0.30\\,\\mathrm{m}$\n- $L_T = 0.20\\,\\mathrm{m}$\n- $a = 0.50\\,\\mathrm{m}$\n- $\\hat{k}_y = 0.300$\n\n首先，计算无量纲梯度比：\n$$\\frac{a}{L_n} = \\frac{0.50}{0.30} = \\frac{5}{3}$$\n$$\\frac{a}{L_T} = \\frac{0.50}{0.20} = \\frac{5}{2} = 2.5$$\n现在，将这些值代入归一化频率表达式中：\n$$\\hat{\\omega}_{*e} = 0.300 \\left(\\frac{5}{3} + \\frac{5}{2}\\right)$$\n$$\\hat{\\omega}_{*e} = 0.300 \\left(\\frac{10}{6} + \\frac{15}{6}\\right) = 0.300 \\left(\\frac{25}{6}\\right)$$\n$$\\hat{\\omega}_{*e} = \\frac{3}{10} \\times \\frac{25}{6} = \\frac{75}{60} = \\frac{5}{4} = 1.25$$\n题目要求答案四舍五入至四位有效数字。\n\n$$\\hat{\\omega}_{*e} = 1.250$$",
            "answer": "$$\\boxed{1.250}$$"
        },
        {
            "introduction": "最后的这项实践采用计算方法，旨在探究抗磁电流一个精妙但至关重要的性质。我们将在一个简化的磁流体动力学模型中，通过编程实现抗磁电流，并验证在理想的周期性边界条件下，它对系统的总能量收支没有净贡献 。这个练习不仅提供了宝贵的编程实践机会，还加深了我们对等离子体模型中能量守恒定律的理解，并揭示了当理想假设被打破时，能量交换是如何发生的。",
            "id": "3965262",
            "problem": "给定一个约化磁流体力学 (MHD) 的二维周期性平板模型，其中平面外磁场占主导地位，平面内动力学由标量场描述。目标是实现抗磁电流，并证明在科学标准条件下，当不存在扰动时，它既不注入也不耗散能量。使用基本的电磁能量平衡和抗磁漂移物理来指导您的实现。\n\n从以下基础出发：\n- 麦克斯韦方程组导出了电磁能量平衡（坡印廷定理）。在磁化等离子体中，若忽略位移电流，该定理简化为：总场能量的变化率等于电场做功的体积分的负值，即 $$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int \\frac{B^2}{2\\mu_0}\\,\\mathrm{d}V \\approx -\\int \\mathbf{E}\\cdot\\mathbf{J} \\,\\mathrm{d}V,$$ 其中 $B$ 是磁场强度，$\\mu_0$ 是真空磁导率，$\\mathbf{E}$ 是电场，$\\mathbf{J}$ 是电流密度。\n- 在强磁化等离子体中，抗磁漂移产生的垂直电流密度为 $$\\mathbf{J}_{\\mathrm{dia}} = \\frac{\\mathbf{B}\\times\\nabla p}{B^2},$$ 其中 $p$ 是压强，$\\mathbf{B}$ 是磁场。在一个具有均匀平面外磁场 $\\mathbf{B} = B_0 \\hat{\\mathbf{z}}$ 的平板中，这简化为 $$\\mathbf{J}_{\\mathrm{dia}} = \\frac{1}{B_0}\\,\\hat{\\mathbf{z}}\\times\\nabla p,$$ 在笛卡尔坐标系 $(x,y)$ 中可得 $$J_{\\mathrm{dia},x} = -\\frac{1}{B_0}\\frac{\\partial p}{\\partial y},\\quad J_{\\mathrm{dia},y} = \\frac{1}{B_0}\\frac{\\partial p}{\\partial x}.$$\n- 对于静电场，电场是标量势 $\\phi$ 的负梯度，即 $$\\mathbf{E} = -\\nabla\\phi.$$\n- 在没有扰动、周期性边界和均匀 $B_0$ 的情况下，抗磁电流在二维空间中是无散的，并且不对等离子体做净功，这意味着对于单值周期场，有 $$\\int \\mathbf{E}\\cdot\\mathbf{J}_{\\mathrm{dia}}\\,\\mathrm{d}V = 0$$。该论述依赖于在周期性域中，一个散度的域积分为零这一恒等式。\n\n你的任务是：\n- 实现一个计算程序，在给定大小为 $\\,L_x\\times L_y\\,$、网格间距均匀的矩形域上的二维周期性标量势 $\\,\\phi(x,y)\\,$ 和压强 $\\,p(x,y)\\,$ 的情况下，计算抗磁电流 $$\\mathbf{J}_{\\mathrm{dia}} = \\frac{1}{B}\\,\\hat{\\mathbf{z}}\\times\\nabla p,$$ 其中根据测试用例，$\\,B\\,$ 可以是均匀的 $\\,B_0\\,$ 或弱变化的 $\\,B(x,y)\\,$。\n- 计算静电场 $$\\mathbf{E} = -\\nabla \\phi.$$\n- 通过对面积分 $$P_{\\mathrm{dia}} = \\int \\mathbf{E}\\cdot\\mathbf{J}_{\\mathrm{dia}}\\,\\mathrm{d}A$$ 进行离散化来评估单位平面外长度的总抗磁功率注入。在周期性边界条件下，使用谱精确梯度，以使离散化遵循底层的微积分恒等式。\n\n物理和数值要求：\n- 答案必须以瓦特每米 (W/m) 表示，这是功率密度 $\\,\\mathbf{E}\\cdot\\mathbf{J}\\,$（单位为 $\\,\\mathrm{W/m}^3\\,$）在面积 $\\,\\mathrm{m}^2\\,$ 上积分的结果，因此是单位平面外长度的功率。将每个结果四舍五入到六位小数。\n- 对任何三角函数和空间参数均使用弧度。\n- 使用周期性域 $\\,x\\in[0,L_x),\\,y\\in[0,L_y)\\,$ 和 $\\,N_x\\times N_y\\,$ 个点的均匀网格。使用傅里叶谱导数计算 $\\,\\partial/\\partial x\\,$ 和 $\\,\\partial/\\partial y\\,$，以最小化数值耗散并保持周期性微积分恒等式。\n\n测试套件（按所列顺序生成输出）：\n1. 一般情况（正常路径），均匀场：\n   - $L_x = 2\\pi$, $L_y = 2\\pi$, $N_x = 256$, $N_y = 256$。\n   - $B_0 = 3.0\\,\\mathrm{T}$。\n   - $\\phi(x,y) = \\phi_0 \\sin(k_x x)\\cos(k_y y)$，其中 $\\phi_0 = 5.0\\,\\mathrm{V}$，$k_x = 2$，$k_y = 3$。\n   - $p(x,y) = p_0 \\cos(k_x x)\\sin(k_y y)$，其中 $p_0 = 1000.0\\,\\mathrm{Pa}$。\n   - 计算并报告以 $\\mathrm{W/m}$ 为单位的 $P_{\\mathrm{dia}}$。\n2. 边界情况，零抗磁电流：\n   - $L_x,L_y,N_x,N_y,B_0$ 与情况 1 相同。\n   - $\\phi(x,y)$ 与情况 1 相同。\n   - $p(x,y) = p_{\\mathrm{const}}$，其中 $p_{\\mathrm{const}} = 2500.0\\,\\mathrm{Pa}$（空间均匀）。\n   - 计算并报告以 $\\mathrm{W/m}$ 为单位的 $P_{\\mathrm{dia}}$。\n3. 具有弱非均匀磁场的边缘情况：\n   - $L_x = 2\\pi$, $L_y = 2\\pi$, $N_x = 256$, $N_y = 256$。\n   - $B(x,y) = B_0\\left[1+\\epsilon\\cos(k_B x)\\right]$，其中 $B_0 = 3.0\\,\\mathrm{T}$，$\\epsilon = 0.2$，$k_B = 1$。\n   - $\\phi(x,y)$ 与情况 1 相同。\n   - $p(x,y)$ 与情况 1 相同。\n   - 计算并报告以 $\\mathrm{W/m}$ 为单位的 $P_{\\mathrm{dia}}$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含三个结果，四舍五入到六位小数，以逗号分隔并用方括号括起来，例如，“[result1,result2,result3]”。",
            "solution": "我们从麦克斯韦方程组导出的电磁能量平衡开始。在忽略位移电流的磁化等离子体中，坡印廷定理简化为：场能量的变化率由电场对电流做功的负值的体积分给出，表示为 $$\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int \\frac{B^2}{2\\mu_0}\\,\\mathrm{d}V \\approx -\\int \\mathbf{E}\\cdot\\mathbf{J}\\,\\mathrm{d}V.$$ 在约化磁流体力学 (MHD) 中，我们考虑垂直于强引导场的动力学，抗磁电流是一种由压强梯度产生且经过充分检验的垂直漂移效应，其表达式为 $$\\mathbf{J}_{\\mathrm{dia}} = \\frac{\\mathbf{B}\\times\\nabla p}{B^2}.$$ 对于具有强而均匀的平面外磁场 $\\mathbf{B} = B_0\\hat{\\mathbf{z}}$ 的平板几何，这简化为 $$\\mathbf{J}_{\\mathrm{dia}} = \\frac{1}{B_0}\\,\\hat{\\mathbf{z}}\\times\\nabla p,$$ 在笛卡尔坐标系中给出 $$J_{\\mathrm{dia},x} = -\\frac{1}{B_0}\\frac{\\partial p}{\\partial y},\\qquad J_{\\mathrm{dia},y} = \\frac{1}{B_0}\\frac{\\partial p}{\\partial x}.$$ 静电场为 $\\mathbf{E} = -\\nabla\\phi$，其中 $\\phi$ 为标量势。单位平面外长度的抗磁功率注入是面积分 $$P_{\\mathrm{dia}} = \\int \\mathbf{E}\\cdot\\mathbf{J}_{\\mathrm{dia}}\\,\\mathrm{d}A,$$ 以瓦特每米 (W/m) 为单位。\n\n为证明在周期性边界和均匀 $B_0$ 条件下，当无扰动时，抗磁项不注入或耗散能量，我们观察以下恒等式。对于 $\\mathbf{E} = -\\nabla\\phi$ 和 $\\mathbf{J}_{\\mathrm{dia}} = \\frac{1}{B_0}\\hat{\\mathbf{z}}\\times\\nabla p$，被积函数变为 $$\\mathbf{E}\\cdot\\mathbf{J}_{\\mathrm{dia}} = -\\nabla\\phi \\cdot \\left( \\frac{1}{B_0}\\hat{\\mathbf{z}}\\times\\nabla p \\right) = -\\frac{1}{B_0}\\nabla\\phi\\cdot(\\hat{\\mathbf{z}}\\times\\nabla p).$$ 使用矢量微积分，我们注意到对于任意标量场 $\\phi$ 和 $p$，在二维空间和常数 $\\hat{\\mathbf{z}}$ 的情况下， $$\\nabla\\phi \\cdot (\\hat{\\mathbf{z}}\\times\\nabla p) = \\nabla\\cdot\\left( \\phi\\,\\hat{\\mathbf{z}}\\times\\nabla p \\right) - \\phi\\,\\nabla\\cdot(\\hat{\\mathbf{z}}\\times\\nabla p).$$ 在二维空间中，当 $\\hat{\\mathbf{z}}$ 为常数且 $B_0$ 均匀时，$\\hat{\\mathbf{z}}\\times\\nabla p = (-\\partial p/\\partial y,\\,\\partial p/\\partial x)$，其散度为 $$\\nabla\\cdot(\\hat{\\mathbf{z}}\\times\\nabla p) = -\\frac{\\partial^2 p}{\\partial x \\partial y} + \\frac{\\partial^2 p}{\\partial y \\partial x} = 0.$$ 因此，在周期性域中的域积分得到 $$\\int \\nabla\\phi \\cdot (\\hat{\\mathbf{z}}\\times\\nabla p)\\,\\mathrm{d}A = \\int \\nabla\\cdot\\left( \\phi\\,\\hat{\\mathbf{z}}\\times\\nabla p \\right)\\,\\mathrm{d}A = \\oint \\phi\\,\\hat{\\mathbf{z}}\\times\\nabla p \\cdot \\mathrm{d}\\mathbf{S} = 0,$$ 因为周期性边界意味着穿过边界的净通量为零。因此， $$\\int \\mathbf{E}\\cdot\\mathbf{J}_{\\mathrm{dia}}\\,\\mathrm{d}A = -\\frac{1}{B_0} \\int \\nabla\\phi \\cdot (\\hat{\\mathbf{z}}\\times\\nabla p)\\,\\mathrm{d}A = 0.$$ 这证明了在均匀引导场和周期性边界条件下，无论 $\\phi$ 和 $p$ 的具体形式如何，抗磁电流都不会贡献净功率注入或耗散：这是在没有破坏这些假设的扰动的情况下能量守恒的表述。\n\n算法实现：\n1. 将域 $[0,L_x)\\times[0,L_y)$ 用 $N_x\\times N_y$ 个点离散化，并构建周期性网格 $x_i = i\\,\\Delta x$，$y_j = j\\,\\Delta y$，其中 $\\Delta x = L_x/N_x$，$\\Delta y = L_y/N_y$。\n2. 将场 $\\phi(x,y)$ 和 $p(x,y)$ 在此网格上表示为数组。\n3. 使用傅里叶变换计算谱梯度，这种方法对于周期函数是精确的，并能保持散度定理背后的微积分恒等式：\n   - 计算二维离散傅里叶变换 $\\,\\mathcal{F}\\{\\phi\\}\\,$ 和 $\\,\\mathcal{F}\\{p\\}\\,$。\n   - 构建波数数组 $\\,k_x = 2\\pi\\,\\mathrm{fftfreq}(N_x,\\Delta x)\\,$ 和 $\\,k_y = 2\\pi\\,\\mathrm{fftfreq}(N_y,\\Delta y)\\,$。\n   - 计算谱导数： $$\\frac{\\partial f}{\\partial x} = \\mathcal{F}^{-1}\\{\\mathrm{i}k_x \\mathcal{F}\\{f\\}\\},\\qquad \\frac{\\partial f}{\\partial y} = \\mathcal{F}^{-1}\\{\\mathrm{i}k_y \\mathcal{F}\\{f\\}\\}.$$\n4. 计算静电场分量 $E_x = -\\partial\\phi/\\partial x$，$E_y = -\\partial\\phi/\\partial y$。\n5. 对于均匀 $B_0$，计算抗磁电流分量为 $J_{\\mathrm{dia},x} = -(1/B_0)\\,\\partial p/\\partial y$，$J_{\\mathrm{dia},y} = (1/B_0)\\,\\partial p/\\partial x$。对于弱变化的 $B(x,y)$，使用 $J_{\\mathrm{dia},x} = -(1/B(x,y))\\,\\partial p/\\partial y$，$J_{\\mathrm{dia},y} = (1/B(x,y))\\,\\partial p/\\partial x$。\n6. 通过数值积分计算单位平面外长度的抗磁功率注入 $$P_{\\mathrm{dia}} \\approx \\sum_{i,j}\\left[E_x(x_i,y_j)J_{\\mathrm{dia},x}(x_i,y_j) + E_y(x_i,y_j)J_{\\mathrm{dia},y}(x_i,y_j)\\right]\\Delta x\\,\\Delta y.$$\n7. 使用测试套件：\n   - 情况 1：均匀 $B_0$ 以及波数为 $k_x=2$，$k_y=3$ 的正弦形式 $\\phi$ 和 $p$；由于周期性散度恒等式，这应在数值公差范围内得出 $P_{\\mathrm{dia}} \\approx 0$。\n   - 情况 2：均匀 $B_0$，常数 $p$ 和非零 $\\phi$；此处 $\\,\\nabla p=0\\,$，因此 $\\,\\mathbf{J}_{\\mathrm{dia}}=0\\,$ 且 $\\,P_{\\mathrm{dia}}=0\\,$ 精确成立。\n   - 情况 3：弱非均匀的 $B(x,y) = B_0[1+\\epsilon\\cos(k_B x)]$，这破坏了 $\\hat{\\mathbf{z}}\\times\\nabla p/B$ 的无散性质，通常会产生非零的 $\\,P_{\\mathrm{dia}}\\,$；这测试了能量交换对偏离均匀场假设的敏感性。\n\n数值精度和单位：\n- 傅里叶谱导数对于与离散网格和周期域对齐的模式是精确的，这使得情况 1 和情况 2 的输出在浮点误差范围内为数值零。\n- 积分结果的单位是瓦特每米 (W/m)。最终输出应为三个四舍五入到六位小数的值，聚合为方括号内的单个逗号分隔列表。",
            "answer": "```python\nimport numpy as np\n\ndef spectral_gradient(field, Lx, Ly):\n    \"\"\"\n    Compute spectral gradients d(field)/dx and d(field)/dy on a periodic domain [0,Lx) x [0,Ly).\n    field: 2D numpy array of shape (Ny, Nx) with y as first axis and x as second axis.\n    Returns: (dfdx, dfdy) as real-valued arrays matching field shape.\n    \"\"\"\n    Ny, Nx = field.shape\n    dx = Lx / Nx\n    dy = Ly / Ny\n\n    # Fourier frequencies (cycles per unit length); convert to angular wavenumbers\n    kx = 2.0 * np.pi * np.fft.fftfreq(Nx, d=dx)\n    ky = 2.0 * np.pi * np.fft.fftfreq(Ny, d=dy)\n\n    # 2D grids of wavenumbers\n    KX, KY = np.meshgrid(kx, ky, indexing='xy')\n\n    # 2D FFT\n    F = np.fft.fft2(field)\n\n    # Spectral derivatives\n    dfdx = np.fft.ifft2(1j * KX * F).real\n    dfdy = np.fft.ifft2(1j * KY * F).real\n\n    return dfdx, dfdy\n\ndef compute_power(Lx, Ly, Nx, Ny, phi_func, p_func, B_func):\n    \"\"\"\n    Compute diamagnetic power injection per unit out-of-plane length:\n    P_dia = ∫ E · J_dia dA\n    where E = -∇φ, J_dia = (1/B) ẑ × ∇p = (-(1/B) ∂p/∂y, (1/B) ∂p/∂x)\n    \"\"\"\n    # Grid\n    x = np.linspace(0.0, Lx, Nx, endpoint=False)\n    y = np.linspace(0.0, Ly, Ny, endpoint=False)\n    X, Y = np.meshgrid(x, y, indexing='xy')\n\n    # Fields\n    phi = phi_func(X, Y)\n    p = p_func(X, Y)\n    B = B_func(X, Y)\n\n    # Gradients\n    dphidx, dphidy = spectral_gradient(phi, Lx, Ly)\n    dpdx, dpdy = spectral_gradient(p, Lx, Ly)\n\n    # E field (electrostatic)\n    Ex = -dphidx\n    Ey = -dphidy\n\n    # Diamagnetic current\n    invB = 1.0 / B\n    Jx = -invB * dpdy\n    Jy =  invB * dpdx\n\n    # Power density and integral\n    integrand = Ex * Jx + Ey * Jy\n    dx = Lx / Nx\n    dy = Ly / Ny\n    P = np.sum(integrand) * dx * dy  # W/m\n\n    return P\n\ndef solve():\n    # Constants for tests\n    Lx = 2.0 * np.pi\n    Ly = 2.0 * np.pi\n    Nx = 256\n    Ny = 256\n    B0 = 3.0  # Tesla\n\n    # Test 1: Uniform B, sinusoidal phi and p\n    phi0 = 5.0   # Volts\n    p0 = 1000.0  # Pascals\n    kx = 2\n    ky = 3\n\n    def phi1(X, Y):\n        return phi0 * np.sin(kx * X) * np.cos(ky * Y)\n\n    def p1(X, Y):\n        return p0 * np.cos(kx * X) * np.sin(ky * Y)\n\n    def B_uniform(X, Y):\n        return B0 * np.ones_like(X)\n\n    P1 = compute_power(Lx, Ly, Nx, Ny, phi1, p1, B_uniform)\n\n    # Test 2: Uniform B, constant p (zero diamagnetic current)\n    p_const = 2500.0\n\n    def phi2(X, Y):\n        return phi0 * np.sin(kx * X) * np.cos(ky * Y)\n\n    def p2(X, Y):\n        return p_const * np.ones_like(X)\n\n    P2 = compute_power(Lx, Ly, Nx, Ny, phi2, p2, B_uniform)\n\n    # Test 3: Weakly non-uniform B\n    eps = 0.2\n    kB = 1\n\n    def B_nonuniform(X, Y):\n        return B0 * (1.0 + eps * np.cos(kB * X))\n\n    P3 = compute_power(Lx, Ly, Nx, Ny, phi1, p1, B_nonuniform)\n\n    # Prepare results rounded to six decimal places\n    results = [P1, P2, P3]\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}