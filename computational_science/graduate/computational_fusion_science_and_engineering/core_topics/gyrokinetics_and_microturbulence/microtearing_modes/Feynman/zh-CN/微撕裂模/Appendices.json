{
    "hands_on_practices": [
        {
            "introduction": "电子温度梯度是微撕裂模（MTM）的主要能量来源。本练习将通过直接从等离子体剖面计算关键参数 $\\eta_e$ 来提供量化这种驱动力的实践经验。通过将剖面形状与不稳定性驱动联系起来，您将对何种等离子体易受MTM影响建立起基本理解 。",
            "id": "4200707",
            "problem": "考虑一个大环径比的托卡马克，其小半径为 $a$，且平衡仅在径向 $r \\in [0,a]$ 上变化。设电子密度分布为 $n_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^p$，电子温度分布为 $T_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^q$，其中 $n_0$、$T_0$、$p$ 和 $q$ 是正常数，$B$ 是均匀的环向磁场强度。假设微撕裂模不稳定的波数排序为 $k_y \\rho_e \\ll 1$ 和半碰撞电子，定义为 $k_{\\parallel} \\lambda_{\\mathrm{mfp}} \\sim 1$，其中 $\\lambda_{\\mathrm{mfp}} = v_{te}/\\nu_e$ 是平均自由程，$v_{te} = \\sqrt{2 T_e/m_e}$ 是电子热速度，$\\nu_e$ 是电子碰撞频率。设磁剪切弱但有限，并关注平行矢量势 $A_{\\parallel}$ 的重联宇称分量。\n\n从梯度标长 $L_n = -\\left(\\frac{d \\ln n_e}{dr}\\right)^{-1}$ 和 $L_{T_e} = -\\left(\\frac{d \\ln T_e}{dr}\\right)^{-1}$ 的基本定义出发，在给定 $p = 1.7$ 和 $q = 3.1$ 的条件下，构建半径 $r_0 = \\frac{a}{2}$ 处的局域电子温度梯度参数 $\\eta_e = \\frac{L_n}{L_{T_e}}$。然后，利用半碰撞机制下电子平行力平衡和能量方程的第一性原理线性化，并结合安培定律，确定在 $r_0$ 附近固定 $k_y$ 时 $\\frac{d \\gamma}{d \\eta_e}$ 的符号，其中 $\\gamma$ 是微撕裂模的线性增长率。如果增加 $\\eta_e$（在其他参数固定的情况下）会增加 $\\gamma$（使模式不稳定），则将您的定性稳定性预测数值编码为 $+1$；如果增加 $\\eta_e$ 会减小 $\\gamma$（使模式稳定），则编码为 $-1$。\n\n您必须给出一个包含两个条目的最终答案：第一个条目是 $\\eta_e(r_0)$ 的值（无量纲），四舍五入到四位有效数字；第二个条目是 $\\frac{d \\gamma}{d \\eta_e}$ 的符号，编码为 $+1$ 或 $-1$（无量纲）。提供最终答案时无需单位。",
            "solution": "该问题要求计算与托卡马克等离子体中的微撕裂模（MTM）相关的两个量。首先，我们必须计算在特定半径处的局域电子温度梯度参数 $\\eta_e$。其次，我们必须确定 MTM 线性增长率 $\\gamma$ 相对于 $\\eta_e$ 的导数符号，这表明增加 $\\eta_e$ 是起稳定作用还是不稳定作用。\n\n第一部分：计算 $\\eta_e(r_0)$\n\n参数 $\\eta_e$ 定义为电子密度梯度标长 $L_n$ 与电子温度梯度标长 $L_{T_e}$ 之比。\n$$\n\\eta_e = \\frac{L_n}{L_{T_e}}\n$$\n梯度标长定义为 $L_n = -\\left(\\frac{d \\ln n_e}{dr}\\right)^{-1}$ 和 $L_{T_e} = -\\left(\\frac{d \\ln T_e}{dr}\\right)^{-1}$。我们已知的电子密度和温度分布为：\n$$\nn_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^p\n$$\n$$\nT_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^q\n$$\n首先，我们计算电子密度 $n_e$ 的对数导数。$n_e(r)$ 的自然对数为：\n$$\n\\ln n_e(r) = \\ln n_0 + p \\ln\\left(1 - \\frac{r^2}{a^2}\\right)\n$$\n对小半径 $r$ 求导：\n$$\n\\frac{d \\ln n_e}{dr} = 0 + p \\cdot \\frac{1}{1 - \\frac{r^2}{a^2}} \\cdot \\left(-\\frac{2r}{a^2}\\right) = -\\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n因此，密度的逆梯度标长为 $\\frac{1}{L_n} = -\\frac{d \\ln n_e}{dr}$：\n$$\n\\frac{1}{L_n(r)} = \\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n通过直接类比，对于电子温度分布 $T_e(r)$，我们可以用参数 $q$ 替换参数 $p$：\n$$\n\\frac{d \\ln T_e}{dr} = -\\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n温度的逆梯度标长为 $\\frac{1}{L_{T_e}} = -\\frac{d \\ln T_e}{dr}$：\n$$\n\\frac{1}{L_{T_e}(r)} = \\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\n现在我们可以通过计算逆标长之比来计算 $\\eta_e(r)$：\n$$\n\\eta_e(r) = \\frac{L_n(r)}{L_{T_e}(r)} = \\frac{1/L_{T_e}(r)}{1/L_n(r)} = \\frac{\\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}}{\\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}} = \\frac{q}{p}\n$$\n对于这种特定的分布函数形式，参数 $\\eta_e$ 是一个常数，与径向位置 $r$ 无关。给定常数 $p = 1.7$ 和 $q = 3.1$。因此，在任何半径处（包括 $r_0 = a/2$）$\\eta_e$ 的值为：\n$$\n\\eta_e = \\frac{3.1}{1.7} \\approx 1.823529...\n$$\n按要求四舍五入到四位有效数字，我们得到：\n$$\n\\eta_e(r_0) \\approx 1.824\n$$\n\n第二部分：稳定性对 $\\eta_e$ 的依赖性\n\n接下来，我们必须确定 $\\frac{d\\gamma}{d\\eta_e}$ 的符号，其中 $\\gamma$ 是微撕裂模的线性增长率。这需要理解其基本的不稳定机制。\n\n微撕裂模是由储存在电子温度梯度中的自由能驱动的电磁不稳定性。该模式涉及磁场扰动，主要体现在平行矢量势 $\\tilde{A}_{\\parallel}$ 中，这会导致小磁岛的形成和磁力线的随机化。\n\n分析从三个基本方程开始：\n1.  **安培定律**：它将磁场扰动与电子电流扰动 $\\tilde{j}_{\\parallel e}$ 联系起来。在平板几何中，为 $-\\nabla^2 \\tilde{A}_{\\parallel} = \\mu_0 \\tilde{j}_{\\parallel e}$。扰动形式为 $\\exp(ik_y y - i\\omega t)$，其中 $\\omega = \\omega_r + i\\gamma$。增长模具有 $\\gamma > 0$。\n2.  **电子平行力平衡（广义欧姆定律）**：此方程确定平行电流。为响应平行电场 $\\tilde{E}_{\\parallel} = -\\frac{\\partial \\tilde{A}_{\\parallel}}{\\partial t} - \\nabla_{\\parallel} \\tilde{\\phi} = i\\omega \\tilde{A}_{\\parallel} - ik_{\\parallel} \\tilde{\\phi}$，电子会产生电流。该响应取决于碰撞性。此平衡中的一个关键项是热力，它与电子温度扰动的平行梯度 $\\nabla_{\\parallel} \\tilde{T}_e$ 成正比。\n3.  **电子能量平衡**：此方程确定温度扰动 $\\tilde{T}_e$。它平衡了来自场平行输运、磁力线漂移及其他源和汇的加热/冷却效应。\n\n在半碰撞机制 $k_{\\parallel} \\lambda_{\\mathrm{mfp}} \\sim 1$ 中，不稳定机制依赖于特定的相位关系。自由能来源是背景温度梯度 $\\nabla_r T_e = -T_e/L_{T_e}$。这种能量通过电子沿扰动磁力线运动产生的热量径向输运而释放。能量释放率与 $\\langle \\tilde{q}_r \\left(-\\nabla_r T_e\\right) \\rangle$ 成正比，其中 $\\tilde{q}_r = \\tilde{q}_{\\parallel e}(\\tilde{B}_r/B)$ 是由于平行热输运沿径向扰动磁力线 $\\tilde{B}_r = ik_y \\tilde{A}_{\\parallel}$ 产生的径向热通量。\n\n对于不稳定性（$\\gamma > 0$），必须有能量从背景热梯度净转移到电磁场扰动。当电子电流扰动 $\\tilde{j}_{\\parallel e}$ 与感应电场扰动 $\\tilde{E}_{\\parallel,ind} = i\\omega \\tilde{A}_{\\parallel}$ 部分同相时，就会发生这种情况。所需的相移由电子碰撞与热力共同提供。\n\n不稳定性的驱动强度与自由能来源的大小（即电子温度梯度）成正比。\n$$\n\\text{驱动} \\propto \\left| \\frac{dT_e}{dr} \\right| \\propto \\frac{1}{L_{T_e}}\n$$\n增长率 $\\gamma$ 是该驱动的函数，因此我们可以写出一级近似：\n$$\n\\gamma \\propto \\frac{1}{L_{T_e}}\n$$\n问题要求 $\\gamma$ 对 $\\eta_e = L_n/L_{T_e}$ 的依赖关系。我们可以用 $\\eta_e$ 和密度梯度标长 $L_n$ 来表示驱动：\n$$\n\\frac{1}{L_{T_e}} = \\frac{\\eta_e}{L_n}\n$$\n因此，增长率的依赖关系可以写成：\n$$\n\\gamma \\propto \\frac{\\eta_e}{L_n}\n$$\n问题要求在其他参数固定时 $\\frac{d\\gamma}{d\\eta_e}$ 的符号。在理论和实验背景中，“其他参数”通常指诸如 $L_n$、磁剪切、等离子体贝塔值和碰撞性等量。在此标准假设下（即保持 $L_n$ 不变），增长率 $\\gamma$ 与 $\\eta_e$ 成正比。\n$$\n\\frac{d\\gamma}{d\\eta_e} \\propto \\frac{1}{L_n}\n$$\n由于 $L_n = \\frac{a^2(1 - r_0^2/a^2)}{2pr_0}$ 是一个正量（给定 $p>0$ 和 $r_0 \\in (0,a)$），该导数必须为正。\n$$\n\\frac{d\\gamma}{d\\eta_e} > 0\n$$\n这表明，相对于密度梯度，增加电子温度梯度对微撕裂模起到了不稳定的作用。对于给定的密度分布，较大的 $\\eta_e$ 意味着更陡峭的温度分布，从而为驱动不稳定性提供更多的自由能。这个正号的数值编码是 $+1$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.824 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在复杂的模拟数据中，区分不同类型的微观不稳定性是一项关键任务。本练习将介绍一种强大的诊断技术：分析平行电流和磁矢势之间的互相关相位，该相位揭示了模的基本“撕裂”或“漂移波”特性。您将实现一个算法，根据这一特征对模进行分类，这是解读现代回旋动理学模拟结果的一项基本技能 。",
            "id": "4012368",
            "problem": "您的任务是编程计算平行电流密度谱与平行磁矢量势谱之间的交叉相位，并利用此交叉相位来区分与微撕裂模相关的电磁微观不稳定性中的撕裂模奇偶性与漂移波奇偶性。推导和设计必须从已有的物理定律和标准定义出发，且算法必须在数学上可靠且具有普适性。角度必须以度为单位表示。\n\n从以下基础开始。考虑与微撕裂模相关的磁化等离子体中的线性、低频、电磁涨落。磁场由磁矢量势表示，在 Coulomb 规范下 Ampère 定律的平行分量（低频时位移电流可忽略）通过 $-\\nabla^2 \\mathbf{A} = \\mu_0 \\mathbf{J}$ 将平行电流密度与平行矢量势联系起来。在平行分量的垂直梯度占主导的标度分析下，可得 $k_\\perp^2 A_\\parallel \\approx \\mu_0 J_\\parallel$。在谱表示中，我们分析复振幅 $\\tilde{A}_\\parallel(\\mathbf{k})$ 和 $\\tilde{J}_\\parallel(\\mathbf{k})$。广义电子平行动量（Ohm 定律）的线性化形式为 $E_\\parallel + \\eta J_\\parallel + \\frac{m_e}{n_e e^2} \\frac{\\partial J_\\parallel}{\\partial t} + \\frac{1}{n_e e} \\nabla_\\parallel p_e \\approx 0$，其中 $E_\\parallel = -\\frac{\\partial A_\\parallel}{\\partial t} - \\nabla_\\parallel \\phi$。在频域中，该关系意味着各项可以在 $\\tilde{J}_\\parallel$ 和 $\\tilde{A}_\\parallel$ 之间引入相移，尤其是在感应效应 $-\\partial A_\\parallel/\\partial t$ 和电子惯性显著时。\n\n将每个谱样本的交叉相位定义为复数乘积 $\\tilde{J}_\\parallel \\tilde{A}_\\parallel^\\ast$ 的辐角，即 $\\arg(\\tilde{J}_\\parallel \\tilde{A}_\\parallel^\\ast)$，其中 $\\arg(\\cdot)$ 表示复数辐角的主值。在 Ampère 定律的最简单低频极限下，且附加的动态相移可忽略时，撕裂模奇偶性对应于 $\\tilde{J}_\\parallel$ 与 $\\tilde{A}_\\parallel$ 同相或反相，即交叉相位接近 $0^\\circ$ 或 $180^\\circ$。当感生电场和电子惯性项在响应中占主导地位时，漂移波奇偶性导致 $\\tilde{J}_\\parallel$ 与 $\\tilde{A}_\\parallel$ 近似正交，即交叉相位接近 $90^\\circ$ 或 $270^\\circ$。\n\n您的程序必须：\n- 对于每个谱，计算所有谱样本 $i$ 的交叉相角 $\\theta_i = \\arg(\\tilde{J}_{\\parallel,i} \\tilde{A}_{\\parallel,i}^\\ast)$，以度为单位表示，范围在 $[0^\\circ, 360^\\circ)$ 内。\n- 计算这些角度的循环平均值，以获得谱的单个代表性交叉相位 $\\bar{\\theta}$。由于角度是周期性的，循环平均值必须通过单位相量计算：$\\bar{\\theta} = \\arg\\left(\\frac{1}{N} \\sum_{i=1}^{N} e^{i \\theta_i \\pi / 180}\\right)$，并转换为 $[0^\\circ, 360^\\circ)$ 范围内的度数。\n- 使用容差窗口对奇偶性进行分类：如果 $\\bar{\\theta}$ 在 $0^\\circ$ 或 $180^\\circ$ 的 $20^\\circ$ 范围内，则标记为撕裂模奇偶性；如果 $\\bar{\\theta}$ 在 $90^\\circ$ 或 $270^\\circ$ 的 $20^\\circ$ 范围内，则标记为漂移波奇偶性；否则标记为模糊。将分类表示为整数：撕裂模奇偶性为 $1$，漂移波奇偶性为 $0$，模糊为 $-1$。\n- 报告每个测试用例的 $\\bar{\\theta}$（以度为单位，四舍五入到一位小数）以及相应的整数分类。\n\n测试套件和合成谱的生成：\n- 每个测试用例包含 $N = 32$ 个谱样本，其复振幅 $\\tilde{A}_{\\parallel,i}$ 和 $\\tilde{J}_{\\parallel,i}$ 按以下方式构造。对于样本索引 $i$：\n  - 为 $\\tilde{A}_{\\parallel,i}$ 从 $[0, 2\\pi)$ 中均匀抽取一个基线随机相位 $\\psi_i$，并设置 $\\tilde{A}_{\\parallel,i} = A_0 e^{i \\psi_i}$，其中 $A_0 = 1$。\n  - 为测试用例指定一个基础交叉相位 $\\phi_0$（以度为单位），并设置无噪声关系 $\\tilde{J}_{\\parallel,i}^{(0)} = \\alpha e^{i(\\psi_i + \\phi_0 \\pi/180)}$，其中 $\\alpha = 0.8$。\n  - 添加两种小的、独立的噪声来模拟测量和模型的可变性：\n    - 幅度噪声：乘以 $(1 + \\delta_{a,i})$，其中 $\\delta_{a,i}$ 从均值为 $0$、标准差为 $\\sigma_a = 0.05$ 的正态分布中抽取。\n    - 相位噪声：将 $\\delta_{\\phi,i}$ 度添加到交叉相位中，其中 $\\delta_{\\phi,i}$ 从均值为 $0$、标准差为 $\\sigma_\\phi = 5$ 度的正态分布中抽取，并实现为附加相位因子 $e^{i \\delta_{\\phi,i} \\pi/180}$。\n  - 最终的 $\\tilde{J}_{\\parallel,i}$ 为 $\\tilde{J}_{\\parallel,i} = \\tilde{J}_{\\parallel,i}^{(0)} \\times (1 + \\delta_{a,i}) \\times e^{i \\delta_{\\phi,i} \\pi/180}$。\n- 使用固定的伪随机种子以确保可复现性，具体而言，所有随机抽取均使用种子 $12345$。\n\n提供五个测试用例，其基础交叉相位 $\\phi_0$ 如下：\n- 测试用例 1：$\\phi_0 = 0^\\circ$（典型的撕裂模奇偶性）。\n- 测试用例 2：$\\phi_0 = 90^\\circ$（典型的漂移波奇偶性）。\n- 测试用例 3：$\\phi_0 = 30^\\circ$（模糊，远离典型的奇偶性角度）。\n- 测试用例 4：$\\phi_0 = 170^\\circ$（边界接近 $180^\\circ$，测试撕裂模容差）。\n- 测试用例 5：$\\phi_0 = 110^\\circ$（边界接近 $90^\\circ$，测试漂移波容差）。\n\n角度单位规范：\n- 所有角度必须以度为单位计算和报告。\n- 将报告的循环平均交叉相位 $\\bar{\\theta}$ 四舍五入到一位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例表示为一个双元素列表 $[\\bar{\\theta},c]$，其中 $\\bar{\\theta}$ 是以度为单位的循环平均交叉相位，四舍五入到一位小数，而 $c$ 是整数分类。不允许有空格。例如，输出应类似于 $[[12.3,1],[95.0,0],\\dots]$。\n\n您的程序必须是自包含的，可直接运行，无需用户输入或外部文件，并且必须使用指定的库。",
            "solution": "该问题具有科学依据、是适定的，并为一项与聚变等离子体中微观不稳定性分析相关的计算任务提供了完整的规范。所有参数、定义和程序都得到了明确说明，从而能够开发出确定性且可验证的算法。因此，该问题被认为是有效的。\n\n该解决方案从第一性原理出发，始于电磁涨落的物理模型，并系统地将其转化为计算算法。问题的核心是通过分析平行电流密度 $\\tilde{J}_\\parallel$ 和平行磁矢量势 $\\tilde{A}_\\parallel$ 之间的相位关系，来区分两种基本的等离子体不稳定性行为——撕裂模奇偶性和漂移波奇偶性。\n\n交叉相位定义为 $\\theta = \\arg(\\tilde{J}_\\parallel \\tilde{A}_\\parallel^\\ast)$，它为这种关系提供了定量度量。设 $\\tilde{J}_\\parallel = |\\tilde{J}_\\parallel| e^{i\\phi_J}$ 和 $\\tilde{A}_\\parallel = |\\tilde{A}_\\parallel| e^{i\\phi_A}$。复数乘积为 $\\tilde{J}_\\parallel \\tilde{A}_\\parallel^\\ast = |\\tilde{J}_\\parallel| e^{i\\phi_J} |\\tilde{A}_\\parallel| e^{-i\\phi_A} = |\\tilde{J}_\\parallel||\\tilde{A}_\\parallel| e^{i(\\phi_J - \\phi_A)}$。该乘积的辐角正是相位差，即 $\\arg(\\tilde{J}_\\parallel \\tilde{A}_\\parallel^\\ast) = \\phi_J - \\phi_A$。\n-   **撕裂模奇偶性**：当响应中 $\\tilde{J}_\\parallel$ 相对于 $\\tilde{A}_\\parallel$ 基本上是实数时，意味着 $\\phi_J - \\phi_A \\approx 0^\\circ$ 或 $\\phi_J - \\phi_A \\approx 180^\\circ$。这种情况发生在广义 Ohm 定律中电阻项占主导时。\n-   **漂移波奇偶性**：当响应中感应或惯性效应显著时，会引入一个因子 $i$（来自频域中的时间导数，$\\partial/\\partial t \\rightarrow -i\\omega$），导致 $\\tilde{J}_\\parallel$ 与 $\\tilde{A}_\\parallel$ 正交。这意味着相位差 $\\phi_J - \\phi_A \\approx \\pm 90^\\circ$，即 $90^\\circ$ 或 $270^\\circ$。\n\n该算法分四个不同步骤进行：合成数据生成、单个交叉相位计算、循环平均值计算和最终分类。\n\n**步骤 1：合成谱数据生成**\n为了测试分类算法，我们生成模拟等离子体模拟或实验中谱测量的合成数据。对于五个测试用例中的每一个，我们构造一组 $N=32$ 个谱样本。使用固定的伪随机种子 $12345$ 来确保可复现性。\n\n对于每个样本 $i \\in \\{1, \\dots, N\\}$：\n1.  生成平行矢量势的复振幅 $\\tilde{A}_{\\parallel,i}$，其大小为常数 $A_0 = 1$，相位 $\\psi_i$ 从 $[0, 2\\pi)$ 中均匀随机抽取。\n    $$ \\tilde{A}_{\\parallel,i} = A_0 e^{i \\psi_i} = 1 \\cdot e^{i \\psi_i} $$\n2.  定义相应的无噪声平行电流密度 $\\tilde{J}_{\\parallel,i}^{(0)}$，其大小固定为 $\\alpha = 0.8$，相位与 $\\tilde{A}_{\\parallel,i}$ 相差一个预设的基础交叉相位 $\\phi_0$（每个测试用例不同）。\n    $$ \\tilde{J}_{\\parallel,i}^{(0)} = \\alpha e^{i(\\psi_i + \\phi_0 \\pi/180)} $$\n3.  为了模拟真实数据，引入了两种独立的噪声源。\n    -   幅度噪声：通过一个乘法因子 $(1 + \\delta_{a,i})$ 建模，其中 $\\delta_{a,i}$ 是从均值为 $0$、标准差为 $\\sigma_a = 0.05$ 的正态分布中抽取的随机变量。\n    -   相位噪声：通过一个附加相移 $\\delta_{\\phi,i}$（以度为单位）建模，该相移从均值为 $0$、标准差为 $\\sigma_\\phi = 5^\\circ$ 的正态分布中抽取。\n4.  最终平行电流密度的复振幅为：\n    $$ \\tilde{J}_{\\parallel,i} = \\tilde{J}_{\\parallel,i}^{(0)} (1 + \\delta_{a,i}) e^{i \\delta_{\\phi,i} \\pi/180} $$\n\n**步骤 2：单个交叉相位计算**\n对于每个谱样本 $i$，交叉相位 $\\theta_i$ 计算为复数乘积 $\\tilde{J}_{\\parallel,i} \\tilde{A}_{\\parallel,i}^\\ast$ 的辐角。\n$$ \\theta_i = \\arg(\\tilde{J}_{\\parallel,i} \\tilde{A}_{\\parallel,i}^\\ast) $$\n结果被转换为度数并映射到区间 $[0^\\circ, 360^\\circ)$。此计算分离出两个复数量之间的相位差，而与它们各自的相位 $\\psi_i$ 无关。\n\n**步骤 3：循环平均交叉相位计算**\n由于数据包含噪声，我们通过平均单个角度 $\\theta_i$ 来计算整个谱的代表性交叉相位。因为角度是周期量（例如，$359^\\circ$ 比 $350^\\circ$ 更接近 $1^\\circ$），所以简单的算术平均是不适用的。正确的方法是计算循环平均值。每个角度 $\\theta_i$ 都被转换为一个单位相量（单位圆上的复数），$z_i = e^{i \\theta_i \\pi/180}$。然后将这些相量作为复平面中的向量进行平均。\n$$ \\bar{z} = \\frac{1}{N} \\sum_{i=1}^{N} z_i $$\n循环平均角 $\\bar{\\theta}$ 是合向量 $\\bar{z}$ 的角度。\n$$ \\bar{\\theta} = \\arg(\\bar{z}) $$\n这个角度也被转换为 $[0^\\circ, 360^\\circ)$ 范围内的度数，并代表了相位分布的中心趋势。\n\n**步骤 4：奇偶性分类**\n计算出的循环平均交叉相位 $\\bar{\\theta}$ 用于对谱的奇偶性进行分类。在撕裂模和漂移波奇偶性的典范角度周围应用 $20^\\circ$ 的容差窗口。\n-   **撕裂模奇偶性（代码 $1$）**：如果 $\\bar{\\theta}$ 在 $0^\\circ$ 或 $180^\\circ$ 的 $20^\\circ$ 范围内，则分类为“撕裂模”。这对应于以下条件：\n    $$ (\\bar{\\theta} \\le 20^\\circ \\text{ or } \\bar{\\theta} \\ge 340^\\circ) \\quad \\text{or} \\quad (|\\bar{\\theta} - 180^\\circ| \\le 20^\\circ) $$\n-   **漂移波奇偶性（代码 $0$）**：如果 $\\bar{\\theta}$ 在 $90^\\circ$ 或 $270^\\circ$ 的 $20^\\circ$ 范围内，则分类为“漂移波”。这对应于以下条件：\n    $$ (|\\bar{\\theta} - 90^\\circ| \\le 20^\\circ) \\quad \\text{or} \\quad (|\\bar{\\theta} - 270^\\circ| \\le 20^\\circ) $$\n-   **模糊（代码 $-1$）**：如果以上两个条件都不满足，则奇偶性被认为是“模糊”的。\n\n最后，将计算出的 $\\bar{\\theta}$ 四舍五入到一位小数，并按规定格式为每个测试用例格式化成对的 $[\\bar{\\theta}, \\text{分类}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and classifies the cross-phase of synthetic spectra for microtearing modes.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each test case is defined by a base cross-phase phi_0 in degrees.\n    test_cases_phi0 = [0.0, 90.0, 30.0, 170.0, 110.0]\n\n    # Parameters for synthetic data generation\n    N = 32           # Number of spectral samples\n    A0 = 1.0         # Magnitude of A_parallel\n    alpha = 0.8      # Magnitude factor for J_parallel\n    sigma_a = 0.05   # Std deviation for amplitude noise\n    sigma_phi = 5.0  # Std deviation for phase noise (in degrees)\n    seed = 12345     # Pseudorandom seed for reproducibility\n    \n    # Initialize the pseudorandom number generator\n    rng = np.random.default_rng(seed)\n\n    results = []\n    \n    for phi0_deg in test_cases_phi0:\n        # Step 1: Generate synthetic spectral data\n        \n        # Baseline random phase for A_parallel\n        psi = rng.uniform(0, 2 * np.pi, N)\n        A_parallel = A0 * np.exp(1j * psi)\n\n        # Noiseless J_parallel with prescribed base cross-phase\n        phi0_rad = np.deg2rad(phi0_deg)\n        J_parallel_noiseless = alpha * np.exp(1j * (psi + phi0_rad))\n        \n        # Generate noise terms\n        amplitude_noise_factor = 1 + rng.normal(0, sigma_a, N)\n        phase_noise_deg = rng.normal(0, sigma_phi, N)\n        phase_noise_rad = np.deg2rad(phase_noise_deg)\n        \n        # Apply noise to create the final J_parallel spectrum\n        J_parallel = J_parallel_noiseless * amplitude_noise_factor * np.exp(1j * phase_noise_rad)\n        \n        # Step 2: Compute individual cross-phase angles\n        \n        # Compute the complex product J_parallel * A_parallel_conjugate\n        cross_product = J_parallel * np.conj(A_parallel)\n        \n        # The angle of the cross-product is the cross-phase\n        theta_rad = np.angle(cross_product)\n        \n        # Convert to degrees in the range [0, 360)\n        theta_deg = np.mod(np.rad2deg(theta_rad), 360)\n\n        # Step 3: Compute the circular mean of the cross-phase angles\n        \n        # Convert angles to unit phasors (complex numbers)\n        phasors = np.exp(1j * np.deg2rad(theta_deg))\n        \n        # Compute the mean of the phasors\n        mean_phasor = np.mean(phasors)\n        \n        # The angle of the mean phasor is the circular mean angle\n        bar_theta_rad = np.angle(mean_phasor)\n        bar_theta_deg = np.mod(np.rad2deg(bar_theta_rad), 360)\n\n        # Step 4: Classify the parity based on the circular mean\n        \n        tol = 20.0  # Tolerance in degrees\n        classification = -1 # Default to ambiguous\n\n        # Check for tearing parity (near 0 or 180 degrees)\n        is_tearing = (bar_theta_deg <= tol or bar_theta_deg >= 360 - tol) or \\\n                     (abs(bar_theta_deg - 180) <= tol)\n\n        # Check for drift-wave parity (near 90 or 270 degrees)\n        is_drift = (abs(bar_theta_deg - 90) <= tol) or \\\n                   (abs(bar_theta_deg - 270) <= tol)\n\n        if is_tearing:\n            classification = 1\n        elif is_drift:\n            classification = 0\n        \n        # Format the result for this test case\n        rounded_bar_theta = round(bar_theta_deg, 1)\n        results.append(f\"[{rounded_bar_theta},{classification}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "理解MTM是否是电子热量损失的主要原因，对于预测聚变反应堆的性能至关重要。本练习将指导您对MTM引起的磁随机化所产生的热输运与纯静电（ETG）湍流所产生的热输运进行定量比较。通过应用已建立的输运模型，您将学会评估在何种条件下MTM成为电子热输运的主要通道 。",
            "id": "4012345",
            "problem": "编写一个程序，用于在相同的梯度参数下，评估和比较由微撕裂模 (MTMs) 和电子温度梯度 (ETG) 驱动的湍流所产生的电子热通量，并识别磁力线随机性（由 $(\\delta B/B)^2$ 量化）超过静电混合的区域。您的推导和实现必须严格基于以下基本定义或经过充分检验的公式：\n\n1. 电子热速度：$v_{\\mathrm{te}} = \\sqrt{2 \\theta_e / m_e}$，其中 $\\theta_e = k_B T_e$ 是单个电子的热能。在计算中，将 $T_e$ 视为以千电子伏特 (keV) 为单位的能量，并使用 $1\\,\\mathrm{keV} = 10^3\\,\\mathrm{eV}$ 和 $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$（其中 $e$ 为元电荷）将其转换为焦耳。\n2. 电子回旋频率：$\\Omega_{ce} = e B / m_e$，对于磁场 $B$。\n3. 电子回旋半径：$\\rho_e = v_{\\mathrm{te}} / \\Omega_{ce}$。\n4. 静电湍流扩散系数的混合长度估算：$\\chi_{\\mathrm{ES}} \\approx \\gamma/k_\\perp^2$，结合峰值 ETG 假设 $k_\\perp \\rho_e \\approx 1$ 和 $\\gamma \\approx C_{\\mathrm{ETG}} v_{\\mathrm{te}}/L_{T_e}$，其中 $C_{\\mathrm{ETG}}$ 是一个量级为 1 的常数。由此，推导出用 $v_{\\mathrm{te}}$、$ \\rho_e$、$ L_{T_e}$ 和 $C_{\\mathrm{ETG}}$ 表示 $\\chi_{\\mathrm{ETG}}$ 的显式公式。\n5. 由随机磁力线引起的电子热扩散系数的 Rechester–Rosenbluth 估算：$\\chi_{\\mathrm{RR}} \\approx C_{\\mathrm{RR}} v_{\\mathrm{te}} L_c (\\delta B/B)^2$，其中平行相关长度 $L_c \\approx \\pi q R$，$q$ 是安全因子，$R$ 是大半径。$C_{\\mathrm{RR}}$ 是一个量级为 1 的常数。\n6. 电子传导热通量定义：$Q_e = - n_e \\chi_e \\nabla \\theta_e$，其中 $\\theta_e = k_B T_e$。假设温度梯度大小恒定，为 $\\lvert \\nabla \\theta_e \\rvert = \\theta_e / L_{T_e}$。使用 $Q_e \\ge 0$ 表示向外的热流，取其大小 $Q_e = n_e \\chi_e \\theta_e / L_{T_e}$。\n\n在计算中使用以下固定的数值常数：\n- 元电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$。\n- 电子质量 $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。\n- 数值系数 $C_{\\mathrm{ETG}} = 0.3$ 和 $C_{\\mathrm{RR}} = 1.0$。\n\n您的程序必须对每个测试用例计算：\n- 使用 $\\chi_e = \\chi_{\\mathrm{RR}}$ 计算的 $Q_{e,\\mathrm{MTM}}$，\n- 使用 $\\chi_e = \\chi_{\\mathrm{ETG}}$ 计算的 $Q_{e,\\mathrm{ETG}}$，\n- 一个布尔值，如果 $Q_{e,\\mathrm{MTM}} > Q_{e,\\mathrm{ETG}}$ 则为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n\n所有热通量必须以 $\\mathrm{W/m^2}$ 为单位表示。\n\n测试套件。对于下面的每个测试用例，除非另有说明，所有输入均采用国际单位制 (SI) 单位：\n- A用例 (基线核心区)：$B = 2.5\\,\\mathrm{T}$，$R = 3.0\\,\\mathrm{m}$，$q = 2.0$，$T_e = 5.0\\,\\mathrm{keV}$，$n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，$L_{T_e} = 0.30\\,\\mathrm{m}$，$(\\delta B/B) = 1.0 \\times 10^{-4}$。\n- B用例 (弱磁随机性)：$B = 2.5\\,\\mathrm{T}$，$R = 3.0\\,\\mathrm{m}$，$q = 2.0$，$T_e = 5.0\\,\\mathrm{keV}$，$n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，$L_{T_e} = 0.30\\,\\mathrm{m}$，$(\\delta B/B) = 1.0 \\times 10^{-5}$。\n- C用例 (通过构造接近平衡)：$B = 2.5\\,\\mathrm{T}$，$R = 3.0\\,\\mathrm{m}$，$q = 2.0$，$T_e = 5.0\\,\\mathrm{keV}$，$n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$，$L_{T_e} = 0.30\\,\\mathrm{m}$，$(\\delta B/B) = 2.2 \\times 10^{-5}$。\n- D用例 (强磁场，陡峭梯度)：$B = 5.0\\,\\mathrm{T}$，$R = 3.0\\,\\mathrm{m}$，$q = 2.0$，$T_e = 2.0\\,\\mathrm{keV}$，$n_e = 1.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$，$L_{T_e} = 0.10\\,\\mathrm{m}$，$(\\delta B/B) = 3.0 \\times 10^{-5}$。\n\n最终输出格式。您的程序应产生单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，每个项目对应一个测试用例，并且本身是一个形式为 $[Q_{e,\\mathrm{MTM}},Q_{e,\\mathrm{ETG}},\\mathrm{bool}]$ 的三元素列表。列表中不得包含任何空格。例如：$[[x_1,y_1,\\mathrm{True}],[x_2,y_2,\\mathrm{False}],\\dots]$，其中 $x_i$ 和 $y_i$ 是以 $\\mathrm{W/m^2}$ 为单位的浮点数。",
            "solution": "该问题被认为是有效的，因为它在科学上基于已建立的等离子体物理原理，问题提法明确，提供了足够的信息以获得唯一解，并以客观、正式的语言表述。所有参数和常数都在磁约束聚变装置的实际物理范围内。\n\n任务是比较由两种不同湍流机制驱动的电子热通量：微撕裂模 (MTMs)（导致磁力线随机化）和电子温度梯度 (ETG) 驱动的湍流（主要是静电性的）。此比较在相同的等离子体梯度参数下进行。\n\n首先，我们必须推导由 ETG 湍流引起的电子热扩散系数 $\\chi_{\\mathrm{ETG}}$ 的表达式。问题提供了静电扩散系数的通用混合长度估算：\n$$\n\\chi_{\\mathrm{ES}} \\approx \\frac{\\gamma}{k_\\perp^2}\n$$\n其中 $\\gamma$ 是不稳定性增长率，$k_\\perp$ 是特征垂直波数。对于峰值增长时的 ETG 湍流，我们已知以下标度关系：\n1.  $k_\\perp \\rho_e \\approx 1$，其中 $\\rho_e$ 是电子回旋半径。这意味着 $k_\\perp \\approx 1/\\rho_e$。\n2.  $\\gamma \\approx C_{\\mathrm{ETG}} v_{\\mathrm{te}}/L_{T_e}$，其中 $C_{\\mathrm{ETG}}$ 是一个量级为 1 的系数，$v_{\\mathrm{te}}$ 是电子热速度，$L_{T_e}$ 是电子温度梯度标长。\n\n将这些关系代入混合长度公式，得到 ETG 湍流的扩散系数：\n$$\n\\chi_{\\mathrm{ETG}} \\approx \\frac{C_{\\mathrm{ETG}} v_{\\mathrm{te}}/L_{T_e}}{(1/\\rho_e)^2} = C_{\\mathrm{ETG}} \\frac{v_{\\mathrm{te}}}{L_{T_e}} \\rho_e^2\n$$\n\n电子热通量 $Q_e$ 由菲克定律定义，$Q_e = -n_e \\chi_e \\nabla \\theta_e$。使用所给的幅度近似 $|\\nabla \\theta_e| = \\theta_e / L_{T_e}$，其中 $\\theta_e$ 是电子热能，$n_e$ 是电子密度，我们得到：\n$$\nQ_e = n_e \\chi_e \\frac{\\theta_e}{L_{T_e}}\n$$\n因此，由 ETG 湍流引起的热通量为：\n$$\nQ_{e,\\mathrm{ETG}} = n_e \\chi_{\\mathrm{ETG}} \\frac{\\theta_e}{L_{T_e}} = n_e \\left(C_{\\mathrm{ETG}} \\frac{v_{\\mathrm{te}}}{L_{T_e}} \\rho_e^2\\right) \\frac{\\theta_e}{L_{T_e}} = n_e C_{\\mathrm{ETG}} v_{\\mathrm{te}} \\theta_e \\frac{\\rho_e^2}{L_{T_e}^2}\n$$\n为了计算该值，我们需要中间量 $v_{\\mathrm{te}}$ 和 $\\rho_e$。电子热能 $\\theta_e$ 是通过将温度 $T_e$ 从千电子伏特 ($\\mathrm{keV}$) 转换为焦耳得到的：\n$$\n\\theta_e[\\mathrm{J}] = T_e[\\mathrm{keV}] \\times 10^3 \\times e[\\mathrm{C}]\n$$\n电子热速度 $v_{\\mathrm{te}}$ 和回旋半径 $\\rho_e$ 则由以下公式给出：\n$$\nv_{\\mathrm{te}} = \\sqrt{\\frac{2 \\theta_e}{m_e}} \\quad \\text{和} \\quad \\rho_e = \\frac{v_{\\mathrm{te}}}{\\Omega_{ce}} = \\frac{v_{\\mathrm{te}}}{e B / m_e} = \\frac{m_e v_{\\mathrm{te}}}{e B}\n$$\n其中 $m_e$ 是电子质量，$e$ 是元电荷，$B$ 是磁场强度。\n\n接下来，我们构建由 MTM 引起的磁随机性导致的热通量 $Q_{e,\\mathrm{MTM}}$ 的公式。该过程的扩散系数由 Rechester-Rosenbluth 公式给出：\n$$\n\\chi_{\\mathrm{RR}} = C_{\\mathrm{RR}} v_{\\mathrm{te}} L_c \\left(\\frac{\\delta B}{B}\\right)^2\n$$\n此处，$C_{\\mathrm{RR}}$ 是一个数值系数，$(\\delta B/B)$ 是归一化的磁涨落幅度，$L_c$ 是磁湍流的平行相关长度，估计为 $L_c = \\pi q R$，其中 $q$ 是安全因子，$R$ 是大半径。相应的热通量为：\n$$\nQ_{e,\\mathrm{MTM}} = n_e \\chi_{\\mathrm{RR}} \\frac{\\theta_e}{L_{T_e}} = n_e \\left( C_{\\mathrm{RR}} v_{\\mathrm{te}} (\\pi q R) \\left(\\frac{\\delta B}{B}\\right)^2 \\right) \\frac{\\theta_e}{L_{T_e}}\n$$\n\n每个测试用例的计算步骤如下：\n1.  从给定的以 $\\mathrm{keV}$ 为单位的 $T_e$ 计算 $\\theta_e$。\n2.  计算 $v_{\\mathrm{te}}$。\n3.  计算 $\\rho_e$。\n4.  计算 $\\chi_{\\mathrm{ETG}}$，然后计算 $Q_{e,\\mathrm{ETG}}$。\n5.  计算 $\\chi_{\\mathrm{RR}}$，然后计算 $Q_{e,\\mathrm{MTM}}$，确保对所提供的 $(\\delta B/B)$ 值进行平方。\n6.  比较通量以确定是否 $Q_{e,\\mathrm{MTM}} > Q_{e,\\mathrm{ETG}}$。\n\n这些步骤将针对每组指定的等离子体参数以编程方式实现，以生成最终结果。所有计算都必须使用提供的物理常数并以国际单位制 (SI) 单位进行。最终的热通量单位将是瓦特每平方米 ($\\mathrm{W/m^2}$)。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares electron heat flux for MTM and ETG turbulence.\n    \"\"\"\n    # Define physical constants and numerical coefficients\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in kg\n    C_ETG = 0.3  # Coefficient for ETG turbulence\n    C_RR = 1.0   # Coefficient for Rechester-Rosenbluth transport\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (baseline core)\n        {'B': 2.5, 'R': 3.0, 'q': 2.0, 'Te_keV': 5.0, 'ne': 5.0e19, 'LTe': 0.30, 'dB_B': 1.0e-4},\n        # Case B (weak magnetic stochasticity)\n        {'B': 2.5, 'R': 3.0, 'q': 2.0, 'Te_keV': 5.0, 'ne': 5.0e19, 'LTe': 0.30, 'dB_B': 1.0e-5},\n        # Case C (near balance by construction)\n        {'B': 2.5, 'R': 3.0, 'q': 2.0, 'Te_keV': 5.0, 'ne': 5.0e19, 'LTe': 0.30, 'dB_B': 2.2e-5},\n        # Case D (high field, sharp gradient)\n        {'B': 5.0, 'R': 3.0, 'q': 2.0, 'Te_keV': 2.0, 'ne': 1.0e20, 'LTe': 0.10, 'dB_B': 3.0e-5},\n    ]\n\n    results_data = []\n    for params in test_cases:\n        B = params['B']\n        R = params['R']\n        q = params['q']\n        Te_keV = params['Te_keV']\n        ne = params['ne']\n        LTe = params['LTe']\n        dB_B = params['dB_B']\n\n        # 1. Convert electron temperature to Joules\n        theta_e = Te_keV * 1000.0 * E_CHARGE\n\n        # 2. Calculate electron thermal speed\n        v_te = np.sqrt(2.0 * theta_e / M_ELECTRON)\n\n        # 3. Calculate ETG-related quantities\n        # Electron cyclotron frequency\n        Omega_ce = E_CHARGE * B / M_ELECTRON\n        # Electron gyroradius\n        rho_e = v_te / Omega_ce\n        # ETG diffusivity\n        chi_ETG = C_ETG * (v_te / LTe) * rho_e**2\n        # ETG heat flux\n        Q_e_ETG = ne * chi_ETG * theta_e / LTe\n\n        # 4. Calculate MTM-related quantities\n        # Parallel correlation length\n        L_c = np.pi * q * R\n        # Stochastic (Rechester-Rosenbluth) diffusivity\n        chi_RR = C_RR * v_te * L_c * (dB_B)**2\n        # MTM heat flux\n        Q_e_MTM = ne * chi_RR * theta_e / LTe\n\n        # 5. Compare fluxes\n        is_mtm_dominant = Q_e_MTM > Q_e_ETG\n\n        results_data.append([Q_e_MTM, Q_e_ETG, is_mtm_dominant])\n    \n    # Format the final output string exactly as required\n    output_strings = []\n    for res in results_data:\n        q_mtm, q_etg, is_dominant = res\n        # Format each sub-list string without whitespace\n        output_strings.append(f\"[{q_mtm},{q_etg},{is_dominant}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(output_strings)}]\")\n\nsolve()\n```"
        }
    ]
}