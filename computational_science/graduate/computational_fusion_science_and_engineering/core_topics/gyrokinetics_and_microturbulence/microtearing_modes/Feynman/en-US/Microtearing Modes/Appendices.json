{
    "hands_on_practices": [
        {
            "introduction": "Microtearing modes (MTMs) are fueled by the free energy stored in the electron temperature gradient. This first exercise provides a practical connection between the analytical shapes of plasma profiles and the key dimensionless parameter, $\\eta_e = L_n / L_{T_e}$, which quantifies the strength of this drive. By calculating $\\eta_e$ from given profiles, you will develop a direct intuition for how profile steepness translates into instability drive and predict how tuning this parameter affects MTM stability .",
            "id": "4200707",
            "problem": "Consider a large-aspect-ratio tokamak with minor radius $a$ and equilibria that vary only radially $r \\in [0,a]$. Let the electron density profile be $n_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^p$ and the electron temperature profile be $T_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^q$, where $n_0$, $T_0$, $p$, and $q$ are positive constants, and $B$ is a uniform toroidal magnetic field magnitude. Assume a microtearing-unstable wavenumber ordering $k_y \\rho_e \\ll 1$ and semi-collisional electrons, defined by $k_{\\parallel} \\lambda_{\\mathrm{mfp}} \\sim 1$, where $\\lambda_{\\mathrm{mfp}} = v_{te}/\\nu_e$, $v_{te} = \\sqrt{2 T_e/m_e}$ is the electron thermal speed, and $\\nu_e$ is the electron collision frequency. Let the magnetic shear be weak but finite, and focus on the reconnecting parity component of the parallel vector potential $A_{\\parallel}$.\n\nStarting from the fundamental definition of gradient scale lengths $L_n = -\\left(\\frac{d \\ln n_e}{dr}\\right)^{-1}$ and $L_{T_e} = -\\left(\\frac{d \\ln T_e}{dr}\\right)^{-1}$, construct the local electron temperature gradient parameter $\\eta_e = \\frac{L_n}{L_{T_e}}$ at the radius $r_0 = \\frac{a}{2}$, given $p = 1.7$ and $q = 3.1$. Then, using first-principles linearization of the electron parallel force balance and energy equations in the semi-collisional regime together with Ampère’s law, determine the sign of $\\frac{d \\gamma}{d \\eta_e}$ at fixed $k_y$ near $r_0$, where $\\gamma$ is the microtearing linear growth rate. Encode your qualitative stability prediction numerically as $+1$ if increasing $\\eta_e$ (at fixed other parameters) increases $\\gamma$ (destabilizes the mode), and $-1$ if increasing $\\eta_e$ decreases $\\gamma$ (stabilizes the mode).\n\nYou must produce a two-entry final answer: the first entry is the value of $\\eta_e(r_0)$ (dimensionless), rounded to four significant figures; the second entry is the sign of $\\frac{d \\gamma}{d \\eta_e}$ encoded as $+1$ or $-1$ (dimensionless). Provide the final answer without units.",
            "solution": "The problem asks for two quantities related to microtearing modes (MTM) in a tokamak plasma. First, we must calculate the local electron temperature gradient parameter, $\\eta_e$, at a specific radius. Second, we must determine the sign of the derivative of the MTM linear growth rate, $\\gamma$, with respect to $\\eta_e$, which indicates whether increasing $\\eta_e$ is stabilizing or destabilizing.\n\nPart 1: Calculation of $\\eta_e(r_0)$\n\nThe parameter $\\eta_e$ is defined as the ratio of the electron density gradient scale length, $L_n$, to the electron temperature gradient scale length, $L_{T_e}$.\n$$\n\\eta_e = \\frac{L_n}{L_{T_e}}\n$$\nThe gradient scale lengths are defined as $L_n = -\\left(\\frac{d \\ln n_e}{dr}\\right)^{-1}$ and $L_{T_e} = -\\left(\\frac{d \\ln T_e}{dr}\\right)^{-1}$. We are given the electron density and temperature profiles:\n$$\nn_e(r) = n_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^p\n$$\n$$\nT_e(r) = T_0 \\left(1 - \\left(\\frac{r}{a}\\right)^2\\right)^q\n$$\nFirst, we calculate the logarithmic derivative of the electron density, $n_e$. The natural logarithm of $n_e(r)$ is:\n$$\n\\ln n_e(r) = \\ln n_0 + p \\ln\\left(1 - \\frac{r^2}{a^2}\\right)\n$$\nDifferentiating with respect to the minor radius $r$:\n$$\n\\frac{d \\ln n_e}{dr} = 0 + p \\cdot \\frac{1}{1 - \\frac{r^2}{a^2}} \\cdot \\left(-\\frac{2r}{a^2}\\right) = -\\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\nThe inverse gradient scale length for density is thus $\\frac{1}{L_n} = -\\frac{d \\ln n_e}{dr}$:\n$$\n\\frac{1}{L_n(r)} = \\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\nBy direct analogy, for the electron temperature profile $T_e(r)$, we can replace the parameter $p$ with $q$:\n$$\n\\frac{d \\ln T_e}{dr} = -\\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\nAnd the inverse gradient scale length for temperature is $\\frac{1}{L_{T_e}} = -\\frac{d \\ln T_e}{dr}$:\n$$\n\\frac{1}{L_{T_e}(r)} = \\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}\n$$\nNow we can compute $\\eta_e(r)$ by taking the ratio of the inverse scale lengths:\n$$\n\\eta_e(r) = \\frac{L_n(r)}{L_{T_e}(r)} = \\frac{1/L_{T_e}(r)}{1/L_n(r)} = \\frac{\\frac{2qr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}}{\\frac{2pr}{a^2\\left(1 - \\frac{r^2}{a^2}\\right)}} = \\frac{q}{p}\n$$\nFor this specific functional form of the profiles, the parameter $\\eta_e$ is a constant, independent of the radial position $r$. We are given the constants $p = 1.7$ and $q = 3.1$. Therefore, the value of $\\eta_e$ at any radius, including $r_0 = a/2$, is:\n$$\n\\eta_e = \\frac{3.1}{1.7} \\approx 1.823529...\n$$\nRounding to four significant figures as required, we get:\n$$\n\\eta_e(r_0) \\approx 1.824\n$$\n\nPart 2: Stability Dependence on $\\eta_e$\n\nNext, we must determine the sign of $\\frac{d\\gamma}{d\\eta_e}$, where $\\gamma$ is the linear growth rate of the microtearing mode. This requires an understanding of the fundamental instability mechanism.\n\nMicrotearing modes are electromagnetic instabilities driven by the free energy stored in the electron temperature gradient. The mode involves a magnetic perturbation, primarily in the parallel vector potential $\\tilde{A}_{\\parallel}$, which leads to the formation of small magnetic islands and stochasticity in the magnetic field lines.\n\nThe analysis starts from three fundamental equations:\n1.  **Ampère's Law**: This relates the magnetic perturbation to the electron current perturbation, $\\tilde{j}_{\\parallel e}$. In slab geometry, this is $-\\nabla^2 \\tilde{A}_{\\parallel} = \\mu_0 \\tilde{j}_{\\parallel e}$. Perturbations are of the form $\\exp(ik_y y - i\\omega t)$, with $\\omega = \\omega_r + i\\gamma$. A growing mode has $\\gamma  0$.\n2.  **Electron Parallel Force Balance (Generalized Ohm's Law)**: This equation determines the parallel current. In response to a parallel electric field $\\tilde{E}_{\\parallel} = -\\frac{\\partial \\tilde{A}_{\\parallel}}{\\partial t} - \\nabla_{\\parallel} \\tilde{\\phi} = i\\omega \\tilde{A}_{\\parallel} - ik_{\\parallel} \\tilde{\\phi}$, electrons produce a current. The response depends on collisionality. A key term in this balance is the thermal force, proportional to the parallel gradient of the electron temperature perturbation, $\\nabla_{\\parallel} \\tilde{T}_e$.\n3.  **Electron Energy Balance**: This equation determines the temperature perturbation $\\tilde{T}_e$. It balances the heating/cooling from field-parallel transport, magnetic field line flutter, and other sources/sinks.\n\nThe instability mechanism in the semi-collisional regime, $k_{\\parallel} \\lambda_{\\mathrm{mfp}} \\sim 1$, relies on a specific phase relationship. The free energy source is the background temperature gradient, $\\nabla_r T_e = -T_e/L_{T_e}$. This energy is released through the radial transport of heat by electrons moving along perturbed magnetic field lines. The rate of energy release is proportional to $\\langle \\tilde{q}_r \\left(-\\nabla_r T_e\\right) \\rangle$, where $\\tilde{q}_r = \\tilde{q}_{\\parallel e}(\\tilde{B}_r/B)$ is the radial heat flux due to parallel heat transport along a radially perturbed magnetic field line, $\\tilde{B}_r = ik_y \\tilde{A}_{\\parallel}$.\n\nFor instability ($\\gamma  0$), there must be a net transfer of energy from the background thermal gradient to the electromagnetic field perturbation. This occurs when the electron current perturbation $\\tilde{j}_{\\parallel e}$ is partially in phase with the inductive electric field perturbation $\\tilde{E}_{\\parallel,ind} = i\\omega \\tilde{A}_{\\parallel}$. The required phase shift is provided by electron collisions in conjunction with the thermal force.\n\nThe strength of the instability drive is directly proportional to the magnitude of the free energy source, which is the electron temperature gradient.\n$$\n\\text{Drive} \\propto \\left| \\frac{dT_e}{dr} \\right| \\propto \\frac{1}{L_{T_e}}\n$$\nThe growth rate $\\gamma$ is a function of this drive, so we can write, to a first approximation:\n$$\n\\gamma \\propto \\frac{1}{L_{T_e}}\n$$\nThe problem asks for the dependence of $\\gamma$ on $\\eta_e = L_n/L_{T_e}$. We can express the drive in terms of $\\eta_e$ and the density gradient scale length $L_n$:\n$$\n\\frac{1}{L_{T_e}} = \\frac{\\eta_e}{L_n}\n$$\nTherefore, the growth rate dependence can be written as:\n$$\n\\gamma \\propto \\frac{\\eta_e}{L_n}\n$$\nThe question asks for the sign of $\\frac{d\\gamma}{d\\eta_e}$ at fixed other parameters. In theoretical and experimental contexts, \"other parameters\" are typically taken to mean quantities like $L_n$, the magnetic shear, plasma beta, and collisionality. Under this standard assumption (i.e., holding $L_n$ constant), the growth rate $\\gamma$ is directly proportional to $\\eta_e$.\n$$\n\\frac{d\\gamma}{d\\eta_e} \\propto \\frac{1}{L_n}\n$$\nSince $L_n = \\frac{a^2(1 - r_0^2/a^2)}{2pr_0}$ is a positive quantity (given $p0$ and $r_0 \\in (0,a)$), the derivative must be positive.\n$$\n\\frac{d\\gamma}{d\\eta_e}  0\n$$\nThis signifies that increasing the electron temperature gradient relative to the density gradient is destabilizing for the microtearing mode. A larger $\\eta_e$ implies a steeper temperature profile for a given density profile, providing more free energy to drive the instability. The numerical encoding for this positive sign is $+1$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.824  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "At their core, MTMs are a form of magnetic reconnection, where magnetic field lines break and re-join, a process that is localized to extremely thin current sheets. This exercise guides you through a first-principles derivation of the characteristic width of this layer in the collisionless, inertial regime . Understanding this scale—the electron skin depth, $d_e = c/\\omega_{pe}$—is fundamental to grasping the electromagnetic nature of MTMs and the physics governing their structure.",
            "id": "4012370",
            "problem": "Consider a collisionless microtearing mode (MTM) in a uniform slab plasma with equilibrium magnetic field $B_0$ aligned with the $z$-direction. Let the perturbation be dominated by a reconnecting parallel vector potential $A_{\\parallel}(x,t)$ varying across a narrow inner layer of width $\\delta$ in the $x$-direction, and assume low plasma beta such that displacement current is negligible. Take the electron density to be a constant $n_0$ and neglect collisions. In the inner layer, assume the electron parallel momentum balance is dominated by inertia and the inductive electric field, so that the parallel component of Ohm’s law is governed by the electron inertial term and the inductive part of the electric field. Treat the time dependence as harmonic, $A_{\\parallel}(x,t) = \\Re\\{ \\tilde{A}_{\\parallel}(x) \\exp(-\\mathrm{i}\\,\\omega t) \\}$.\n\nStarting from the electron parallel momentum equation, Maxwell–Ampère’s law, and Faraday’s law, and using the inner-layer ordering $\\nabla_{\\perp}^2 A_{\\parallel} \\sim A_{\\parallel}/\\delta^2$ with $\\nabla_{\\perp} \\equiv \\partial/\\partial x$, derive an analytical expression for the inertial inner-layer width $\\delta$ in terms of the electron mass $m_e$, the electron charge $e$, the electron number density $n_0$, and the magnetic permeability of free space $\\mu_0$. You may also express your final result equivalently using the speed of light $c$ and the electron plasma frequency $\\omega_{pe}$, defined by $\\omega_{pe}^2 = n_0 e^2 / (\\epsilon_0 m_e)$, where $\\epsilon_0$ is the vacuum permittivity. Express your final answer in meters. No numerical evaluation is required.",
            "solution": "The problem requires the derivation of the inertial inner-layer width, $\\delta$, for a collisionless microtearing mode. We begin with the three specified fundamental laws: the electron parallel momentum equation, Maxwell-Ampère’s law, and Faraday’s law, under the given assumptions.\n\nFirst, we consider the electron parallel momentum equation. The problem states that in the inner layer, the balance is dominated by electron inertia and the inductive electric field. The linearized parallel momentum equation for electrons is:\n$$m_e \\frac{\\partial v_{e\\parallel}}{\\partial t} = -e E_{\\parallel}$$\nHere, $m_e$ is the electron mass, $v_{e\\parallel}$ is the perturbed electron fluid velocity parallel to the equilibrium magnetic field, $e$ is the elementary charge, and $E_{\\parallel}$ is the parallel component of the perturbed electric field. We have used the fact that the equilibrium density is $n_0$ and divided it out.\n\nSecond, from Faraday's law, we relate the electric field $\\mathbf{E}$ to the scalar potential $\\phi$ and the vector potential $\\mathbf{A}$ via $\\mathbf{E} = -\\nabla\\phi - \\frac{\\partial \\mathbf{A}}{\\partial t}$. The problem directs us to consider only the \"inductive part of the electric field\" for the parallel component, which means we neglect the term from the scalar potential, $-\\nabla_{\\parallel}\\phi$. Thus, we have:\n$$E_{\\parallel} = -\\frac{\\partial A_{\\parallel}}{\\partial t}$$\nwhere $A_{\\parallel}$ is the parallel component of the vector potential.\n\nSubstituting this expression for $E_{\\parallel}$ into the momentum equation gives:\n$$m_e \\frac{\\partial v_{e\\parallel}}{\\partial t} = -e \\left(-\\frac{\\partial A_{\\parallel}}{\\partial t}\\right) = e \\frac{\\partial A_{\\parallel}}{\\partial t}$$\nThe problem specifies a harmonic time dependence for the perturbations, of the form $\\exp(-\\mathrm{i}\\omega t)$. For the complex amplitudes of the perturbed quantities (denoted with a tilde, e.g., $\\tilde{A}_{\\parallel}$), the time derivative operator $\\frac{\\partial}{\\partial t}$ is equivalent to multiplication by $-\\mathrm{i}\\omega$. Applying this to the momentum equation yields:\n$$m_e (-\\mathrm{i}\\omega) \\tilde{v}_{e\\parallel} = e (-\\mathrm{i}\\omega) \\tilde{A}_{\\parallel}$$\nFor a non-trivial mode where the frequency $\\omega \\neq 0$, we can divide by $-\\mathrm{i}\\omega$ to find a direct relation between the electron velocity and the vector potential:\n$$\\tilde{v}_{e\\parallel} = \\frac{e}{m_e} \\tilde{A}_{\\parallel}$$\nThe parallel current density, $j_{\\parallel}$, is primarily carried by the electrons (ions are much heavier and their response is negligible at the relevant frequencies). The perturbed parallel current density is therefore $\\tilde{j}_{\\parallel} = -n_0 e \\tilde{v}_{e\\parallel}$. Substituting the expression for $\\tilde{v}_{e\\parallel}$:\n$$\\tilde{j}_{\\parallel} = -n_0 e \\left(\\frac{e}{m_e} \\tilde{A}_{\\parallel}\\right) = -\\frac{n_0 e^2}{m_e} \\tilde{A}_{\\parallel}$$\nThis constitutes the effective parallel Ohm's law governed by electron inertia.\n\nThird, we use Maxwell-Ampère’s law, $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$. The problem states to neglect the displacement current term, $\\mu_0 \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}$, which is appropriate for low-beta, low-frequency phenomena. The law simplifies to:\n$$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$$\nExpressing the magnetic field in terms of the vector potential, $\\mathbf{B} = \\nabla \\times \\mathbf{A}$, and using the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2\\mathbf{A}$ with the Coulomb gauge choice $\\nabla \\cdot \\mathbf{A} = 0$, we obtain:\n$$-\\nabla^2\\mathbf{A} = \\mu_0\\mathbf{J}$$\nTaking the parallel component for the perturbed quantities, we have:\n$$-\\nabla^2 \\tilde{A}_{\\parallel} = \\mu_0 \\tilde{j}_{\\parallel}$$\nWe now combine this result with our derived Ohm's law by substituting the expression for $\\tilde{j}_{\\parallel}$:\n$$-\\nabla^2 \\tilde{A}_{\\parallel} = \\mu_0 \\left( -\\frac{n_0 e^2}{m_e} \\tilde{A}_{\\parallel} \\right)$$\n$$\\nabla^2 \\tilde{A}_{\\parallel} = \\left( \\frac{\\mu_0 n_0 e^2}{m_e} \\right) \\tilde{A}_{\\parallel}$$\nThis is the governing equation for the parallel vector potential within the inertial layer. The problem specifies the inner-layer ordering where the perpendicular gradient dominates, $\\nabla^2 \\approx \\nabla_{\\perp}^2 \\equiv \\frac{\\partial^2}{\\partial x^2}$. The equation becomes:\n$$\\frac{\\partial^2 \\tilde{A}_{\\parallel}}{\\partial x^2} = \\left( \\frac{\\mu_0 n_0 e^2}{m_e} \\right) \\tilde{A}_{\\parallel}$$\nThis is a standard second-order linear ordinary differential equation of the form $\\frac{d^2y}{dx^2} = k^2 y$, for which the characteristic scale length of the solution is $1/k$. The inertial inner-layer width $\\delta$ corresponds to this characteristic scale. By comparing the forms, we identify:\n$$\\frac{1}{\\delta^2} = \\frac{\\mu_0 n_0 e^2}{m_e}$$\nSolving for $\\delta$ yields:\n$$\\delta = \\sqrt{\\frac{m_e}{\\mu_0 n_0 e^2}}$$\nThe problem allows for expressing this result using the speed of light in vacuum, $c$, and the electron plasma frequency, $\\omega_{pe}$. The definitions are $c^2 = 1/(\\mu_0 \\epsilon_0)$ and $\\omega_{pe}^2 = n_0 e^2 / (m_e \\epsilon_0)$. We can write $\\mu_0 = 1/(\\epsilon_0 c^2)$ and substitute it into the expression for $\\delta^2$:\n$$\\delta^2 = \\frac{m_e}{(\\frac{1}{\\epsilon_0 c^2}) n_0 e^2} = \\frac{m_e \\epsilon_0 c^2}{n_0 e^2}$$\nRearranging the terms to use the definition of $\\omega_{pe}^2$:\n$$\\delta^2 = c^2 \\left( \\frac{m_e \\epsilon_0}{n_0 e^2} \\right) = \\frac{c^2}{\\omega_{pe}^2}$$\nTaking the square root provides the final expression for the inertial layer width, which is recognized as the electron skin depth:\n$$\\delta = \\frac{c}{\\omega_{pe}}$$",
            "answer": "$$\\boxed{\\frac{c}{\\omega_{pe}}}$$"
        },
        {
            "introduction": "Understanding an instability requires placing its impact in context. This computational practice addresses the critical question of how significant MTMs are for plasma confinement by comparing the heat transport they generate against that from another key electron-scale instability, the Electron Temperature Gradient (ETG) mode . By implementing and comparing canonical transport models, you will learn to identify the plasma parameter regimes where the magnetic flutter caused by MTMs becomes the dominant channel for electron heat loss.",
            "id": "4012345",
            "problem": "Construct a program that evaluates and compares electron heat flux for microtearing modes (MTMs) and electron temperature gradient (ETG) driven turbulence under identical gradient parameters, and identifies regimes where magnetic field-line stochasticity, quantified by $\\left(\\frac{\\delta B}{B}\\right)^2$, dominates over electrostatic mixing. Your derivation and implementation must start strictly from the following bases, which are either fundamental definitions or well-tested formulas:\n\n1. Electron thermal speed: $v_{\\mathrm{te}} = \\sqrt{2 \\theta_e / m_e}$, where $\\theta_e = k_B T_e$ is the electron thermal energy per particle. In computation, take $T_e$ as an energy given in kilo-electron-volts (keV) and convert to joules using $1\\,\\mathrm{keV} = 10^3\\,\\mathrm{eV}$ and $1\\,\\mathrm{eV} = e\\,\\mathrm{J}$ with elementary charge $e$.\n2. Electron cyclotron frequency: $\\Omega_{ce} = e B / m_e$ for magnetic field $B$.\n3. Electron gyroradius: $\\rho_e = v_{\\mathrm{te}} / \\Omega_{ce}$.\n4. Mixing-length estimate for electrostatic turbulent diffusivity: $\\chi_{\\mathrm{ES}} \\approx \\gamma/k_\\perp^2$, together with the peak-ETG assumptions $k_\\perp \\rho_e \\approx 1$ and $\\gamma \\approx C_{\\mathrm{ETG}} v_{\\mathrm{te}}/L_{T_e}$, where $C_{\\mathrm{ETG}}$ is an order-unity constant. From these, derive an explicit formula for $\\chi_{\\mathrm{ETG}}$ in terms of $v_{\\mathrm{te}}$, $\\rho_e$, $L_{T_e}$, and $C_{\\mathrm{ETG}}$.\n5. Rechester–Rosenbluth estimate for electron heat diffusivity due to stochastic magnetic field lines: $\\chi_{\\mathrm{RR}} \\approx C_{\\mathrm{RR}} v_{\\mathrm{te}} L_c \\left(\\frac{\\delta B}{B}\\right)^2$, with parallel correlation length $L_c \\approx \\pi q R$, where $q$ is the safety factor and $R$ is the major radius. $C_{\\mathrm{RR}}$ is an order-unity constant.\n6. Electron conductive heat flux definition: $Q_e = - n_e \\chi_e \\nabla \\theta_e$, with $\\theta_e = k_B T_e$. Assume a constant magnitude temperature gradient $\\lvert \\nabla \\theta_e \\rvert = \\theta_e / L_{T_e}$. Use $Q_e \\ge 0$ to signify outward heat flow by taking the magnitude $Q_e = n_e \\chi_e \\theta_e / L_{T_e}$.\n\nUse the following fixed numerical constants in the computation:\n- Elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$.\n- Electron mass $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$.\n- Numerical coefficients $C_{\\mathrm{ETG}} = 0.3$ and $C_{\\mathrm{RR}} = 1.0$.\n\nYour program must, for each test case, compute:\n- $Q_{e,\\mathrm{MTM}}$ using $\\chi_e = \\chi_{\\mathrm{RR}}$,\n- $Q_{e,\\mathrm{ETG}}$ using $\\chi_e = \\chi_{\\mathrm{ETG}}$,\n- A boolean that is $\\mathrm{True}$ if $Q_{e,\\mathrm{MTM}}  Q_{e,\\mathrm{ETG}}$ and $\\mathrm{False}$ otherwise.\n\nAll heat fluxes must be expressed in $\\mathrm{W/m^2}$.\n\nTest suite. For each test case below, all inputs are specified in SI units unless otherwise stated:\n- Case A (baseline core): $B = 2.5\\,\\mathrm{T}$, $R = 3.0\\,\\mathrm{m}$, $q = 2.0$, $T_e = 5.0\\,\\mathrm{keV}$, $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$, $L_{T_e} = 0.30\\,\\mathrm{m}$, $\\left(\\frac{\\delta B}{B}\\right) = 1.0 \\times 10^{-4}$.\n- Case B (weak magnetic stochasticity): $B = 2.5\\,\\mathrm{T}$, $R = 3.0\\,\\mathrm{m}$, $q = 2.0$, $T_e = 5.0\\,\\mathrm{keV}$, $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$, $L_{T_e} = 0.30\\,\\mathrm{m}$, $\\left(\\frac{\\delta B}{B}\\right) = 1.0 \\times 10^{-5}$.\n- Case C (near balance by construction): $B = 2.5\\,\\mathrm{T}$, $R = 3.0\\,\\mathrm{m}$, $q = 2.0$, $T_e = 5.0\\,\\mathrm{keV}$, $n_e = 5.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$, $L_{T_e} = 0.30\\,\\mathrm{m}$, $\\left(\\frac{\\delta B}{B}\\right) = 2.2 \\times 10^{-5}$.\n- Case D (high field, sharp gradient): $B = 5.0\\,\\mathrm{T}$, $R = 3.0\\,\\mathrm{m}$, $q = 2.0$, $T_e = 2.0\\,\\mathrm{keV}$, $n_e = 1.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$, $L_{T_e} = 0.10\\,\\mathrm{m}$, $\\left(\\frac{\\delta B}{B}\\right) = 3.0 \\times 10^{-5}$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each item corresponds to one test case and is itself a three-element list of the form $[Q_{e,\\mathrm{MTM}},Q_{e,\\mathrm{ETG}},\\mathrm{bool}]$. The lists must contain no whitespace. For example: $[[x_1,y_1,\\mathrm{True}],[x_2,y_2,\\mathrm{False}],\\dots]$ with $x_i$ and $y_i$ as floating-point numbers in $\\mathrm{W/m^2}$.",
            "solution": "The problem is deemed valid as it is scientifically grounded in established plasma physics principles, is well-posed with sufficient information for a unique solution, and is expressed in objective, formal language. All parameters and constants are within realistic physical ranges for magnetic confinement fusion devices.\n\nThe task is to compare the electron heat flux driven by two distinct turbulence mechanisms: microtearing modes (MTMs), which lead to stochastic magnetic field lines, and electron temperature gradient (ETG) driven turbulence, which is primarily electrostatic. The comparison is performed under identical plasma gradient parameters.\n\nFirst, we must derive the expression for the electron thermal diffusivity due to ETG turbulence, $\\chi_{\\mathrm{ETG}}$. The problem provides the general mixing-length estimate for electrostatic diffusivity:\n$$\n\\chi_{\\mathrm{ES}} \\approx \\frac{\\gamma}{k_\\perp^2}\n$$\nwhere $\\gamma$ is the instability growth rate and $k_\\perp$ is the characteristic perpendicular wavenumber. For ETG turbulence at its peak growth, we are given the scaling relations:\n1.  $k_\\perp \\rho_e \\approx 1$, where $\\rho_e$ is the electron gyroradius. This implies $k_\\perp \\approx 1/\\rho_e$.\n2.  $\\gamma \\approx C_{\\mathrm{ETG}} v_{\\mathrm{te}}/L_{T_e}$, where $C_{\\mathrm{ETG}}$ is an order-unity coefficient, $v_{\\mathrm{te}}$ is the electron thermal speed, and $L_{T_e}$ is the electron temperature gradient scale length.\n\nSubstituting these relations into the mixing-length formula yields the diffusivity for ETG turbulence:\n$$\n\\chi_{\\mathrm{ETG}} \\approx \\frac{C_{\\mathrm{ETG}} v_{\\mathrm{te}}/L_{T_e}}{(1/\\rho_e)^2} = C_{\\mathrm{ETG}} \\frac{v_{\\mathrm{te}}}{L_{T_e}} \\rho_e^2\n$$\n\nThe electron heat flux, $Q_e$, is defined by Fick's law, $Q_e = -n_e \\chi_e \\nabla \\theta_e$. Using the provided magnitude approximation, $|\\nabla \\theta_e| = \\theta_e / L_{T_e}$, where $\\theta_e$ is the electron thermal energy and $n_e$ is the electron density, we have:\n$$\nQ_e = n_e \\chi_e \\frac{\\theta_e}{L_{T_e}}\n$$\nThus, the heat flux due to ETG turbulence is:\n$$\nQ_{e,\\mathrm{ETG}} = n_e \\chi_{\\mathrm{ETG}} \\frac{\\theta_e}{L_{T_e}} = n_e \\left(C_{\\mathrm{ETG}} \\frac{v_{\\mathrm{te}}}{L_{T_e}} \\rho_e^2\\right) \\frac{\\theta_e}{L_{T_e}} = n_e C_{\\mathrm{ETG}} v_{\\mathrm{te}} \\theta_e \\frac{\\rho_e^2}{L_{T_e}^2}\n$$\nTo compute this, we need the intermediary quantities $v_{\\mathrm{te}}$ and $\\rho_e$. The electron thermal energy, $\\theta_e$, is obtained by converting the temperature $T_e$ from kilo-electron-volts ($\\mathrm{keV}$) to Joules:\n$$\n\\theta_e[\\mathrm{J}] = T_e[\\mathrm{keV}] \\times 10^3 \\times e[\\mathrm{C}]\n$$\nThe electron thermal speed $v_{\\mathrm{te}}$ and gyroradius $\\rho_e$ are then given by:\n$$\nv_{\\mathrm{te}} = \\sqrt{\\frac{2 \\theta_e}{m_e}} \\quad \\text{and} \\quad \\rho_e = \\frac{v_{\\mathrm{te}}}{\\Omega_{ce}} = \\frac{v_{\\mathrm{te}}}{e B / m_e} = \\frac{m_e v_{\\mathrm{te}}}{e B}\n$$\nwhere $m_e$ is the electron mass, $e$ is the elementary charge, and $B$ is the magnetic field strength.\n\nNext, we formulate the heat flux due to MTM-induced magnetic stochasticity, $Q_{e,\\mathrm{MTM}}$. The diffusivity for this process is given by the Rechester-Rosenbluth formula:\n$$\n\\chi_{\\mathrm{RR}} = C_{\\mathrm{RR}} v_{\\mathrm{te}} L_c \\left(\\frac{\\delta B}{B}\\right)^2\n$$\nHere, $C_{\\mathrm{RR}}$ is a numerical coefficient, $(\\delta B/B)$ is the normalized magnetic fluctuation amplitude, and $L_c$ is the parallel correlation length of the magnetic turbulence, estimated as $L_c = \\pi q R$, with $q$ being the safety factor and $R$ the major radius. The corresponding heat flux is:\n$$\nQ_{e,\\mathrm{MTM}} = n_e \\chi_{\\mathrm{RR}} \\frac{\\theta_e}{L_{T_e}} = n_e \\left( C_{\\mathrm{RR}} v_{\\mathrm{te}} (\\pi q R) \\left(\\frac{\\delta B}{B}\\right)^2 \\right) \\frac{\\theta_e}{L_{T_e}}\n$$\n\nThe computational procedure for each test case is as follows:\n1.  Calculate $\\theta_e$ from the given $T_e$ in $\\mathrm{keV}$.\n2.  Calculate $v_{\\mathrm{te}}$.\n3.  Calculate $\\rho_e$.\n4.  Calculate $\\chi_{\\mathrm{ETG}}$ and then $Q_{e,\\mathrm{ETG}}$.\n5.  Calculate $\\chi_{\\mathrm{RR}}$ and then $Q_{e,\\mathrm{MTM}}$, ensuring the provided $(\\delta B/B)$ value is squared.\n6.  Compare the fluxes to determine if $Q_{e,\\mathrm{MTM}}  Q_{e,\\mathrm{ETG}}$.\n\nThese steps will be implemented programmatically for each specified set of plasma parameters to produce the final results. All calculations must use the provided physical constants and be performed in SI units. The final heat fluxes will be in units of Watts per square meter ($\\mathrm{W/m^2}$).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares electron heat flux for MTM and ETG turbulence.\n    \"\"\"\n    # Define physical constants and numerical coefficients\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in kg\n    C_ETG = 0.3  # Coefficient for ETG turbulence\n    C_RR = 1.0   # Coefficient for Rechester-Rosenbluth transport\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (baseline core)\n        {'B': 2.5, 'R': 3.0, 'q': 2.0, 'Te_keV': 5.0, 'ne': 5.0e19, 'LTe': 0.30, 'dB_B': 1.0e-4},\n        # Case B (weak magnetic stochasticity)\n        {'B': 2.5, 'R': 3.0, 'q': 2.0, 'Te_keV': 5.0, 'ne': 5.0e19, 'LTe': 0.30, 'dB_B': 1.0e-5},\n        # Case C (near balance by construction)\n        {'B': 2.5, 'R': 3.0, 'q': 2.0, 'Te_keV': 5.0, 'ne': 5.0e19, 'LTe': 0.30, 'dB_B': 2.2e-5},\n        # Case D (high field, sharp gradient)\n        {'B': 5.0, 'R': 3.0, 'q': 2.0, 'Te_keV': 2.0, 'ne': 1.0e20, 'LTe': 0.10, 'dB_B': 3.0e-5},\n    ]\n\n    results_data = []\n    for params in test_cases:\n        B = params['B']\n        R = params['R']\n        q = params['q']\n        Te_keV = params['Te_keV']\n        ne = params['ne']\n        LTe = params['LTe']\n        dB_B = params['dB_B']\n\n        # 1. Convert electron temperature to Joules\n        theta_e = Te_keV * 1000.0 * E_CHARGE\n\n        # 2. Calculate electron thermal speed\n        v_te = np.sqrt(2.0 * theta_e / M_ELECTRON)\n\n        # 3. Calculate ETG-related quantities\n        # Electron cyclotron frequency\n        Omega_ce = E_CHARGE * B / M_ELECTRON\n        # Electron gyroradius\n        rho_e = v_te / Omega_ce\n        # ETG diffusivity\n        chi_ETG = C_ETG * (v_te / LTe) * rho_e**2\n        # ETG heat flux\n        Q_e_ETG = ne * chi_ETG * theta_e / LTe\n\n        # 4. Calculate MTM-related quantities\n        # Parallel correlation length\n        L_c = np.pi * q * R\n        # Stochastic (Rechester-Rosenbluth) diffusivity\n        chi_RR = C_RR * v_te * L_c * (dB_B)**2\n        # MTM heat flux\n        Q_e_MTM = ne * chi_RR * theta_e / LTe\n\n        # 5. Compare fluxes\n        is_mtm_dominant = Q_e_MTM  Q_e_ETG\n\n        results_data.append([Q_e_MTM, Q_e_ETG, is_mtm_dominant])\n    \n    # Format the final output string exactly as required\n    output_strings = []\n    for res in results_data:\n        q_mtm, q_etg, is_dominant = res\n        # Format each sub-list string without whitespace\n        output_strings.append(f\"[{q_mtm},{q_etg},{is_dominant}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(output_strings)}]\")\n\nsolve()\n```"
        }
    ]
}