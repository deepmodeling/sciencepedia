{
    "hands_on_practices": [
        {
            "introduction": "The concept of a zonal flow begins with its underlying electrostatic potential structure. This first exercise provides practice in the fundamental derivation connecting a radially varying potential, $\\phi(x)$, to the resulting $\\mathbf{E}\\times\\mathbf{B}$ flow . By starting from first principles in a simplified slab geometry, you will solidify your understanding of how a purely poloidal flow with a specific radial shear profile emerges, a crucial first step in analyzing its impact on turbulence.",
            "id": "4066228",
            "problem": "Consider a local sheared-slab representation of a large-aspect-ratio tokamak, with Cartesian coordinates $(x,y,z)$ corresponding respectively to the radial, poloidal, and toroidal directions. Let the magnetic field be uniform and aligned with the toroidal direction, $\\mathbf{B}=B\\,\\hat{\\mathbf{z}}$, so that the unit magnetic-field direction is $\\hat{\\mathbf{b}}=\\hat{\\mathbf{z}}$. Assume electrostatic turbulence and zonal-flow structure in the sense that the electrostatic potential $\\phi$ depends only on the radial coordinate $x$ and is constant on the poloidal and toroidal angles. Starting from the definition of the Electric field cross magnetic field ($\\mathbf{E}\\times\\mathbf{B}$) drift,\n$$\n\\mathbf{v}_{E}=\\frac{c}{B}\\,\\hat{\\mathbf{b}}\\times\\nabla \\phi,\n$$\nuse first principles (namely, $\\mathbf{E}=-\\nabla\\phi$ and the cross-product properties) to show that the drift produces a flow that is purely poloidal, and define the corresponding radial shear as $S(x)=\\partial v_{E,y}/\\partial x$, where $v_{E,y}$ is the poloidal (i.e., $y$) component of $\\mathbf{v}_{E}$. Then, for a zonal potential profile\n$$\n\\phi(x)=\\phi_{0}\\,\\cos(k_{x}x),\n$$\nwith uniform $B$, compute the analytic expression of the shear $S(x)$.\n\nWork in Gaussian centimeter-gram-second (cgs) electromagnetic units for dimensional consistency, where $c$ is in centimeters per second, $B$ is in Gauss, $\\phi_{0}$ is in statvolts, $x$ is in centimeters, and $k_{x}$ is in inverse centimeters. Express your final answer for the shear $S(x)$ in inverse seconds (s$^{-1}$). Provide the final answer as a single closed-form symbolic expression; no numerical substitution or rounding is required, and do not include units in the boxed expression.",
            "solution": "The problem statement has been validated and is deemed scientifically sound, well-posed, and self-contained. All provided information is consistent and sufficient to derive a unique solution. We may proceed with the solution.\n\nThe problem asks us to analyze the Electric field cross magnetic field (E$\\times$B) drift velocity in a simplified sheared-slab plasma model and to compute the shear of this flow for a specific potential profile.\n\nFirst, we will demonstrate that for the given conditions, the E$\\times$B drift velocity, $\\mathbf{v}_{E}$, corresponds to a purely poloidal flow. The definition of the drift is given as:\n$$\n\\mathbf{v}_{E} = \\frac{c}{B}\\,\\hat{\\mathbf{b}}\\times\\nabla \\phi\n$$\nThe problem specifies a Cartesian coordinate system where $(x,y,z)$ correspond to the radial, poloidal, and toroidal directions, respectively. The magnetic field is uniform and in the toroidal direction, so $\\mathbf{B}=B\\,\\hat{\\mathbf{z}}$, which implies the unit vector along the magnetic field is $\\hat{\\mathbf{b}}=\\hat{\\mathbf{z}}$.\n\nThe problem states that the electrostatic potential $\\phi$ is characteristic of a zonal structure, meaning it depends only on the radial coordinate $x$. Thus, $\\phi = \\phi(x)$. We now compute the gradient of this potential, $\\nabla \\phi$. In Cartesian coordinates, the gradient operator is $\\nabla = \\hat{\\mathbf{x}}\\frac{\\partial}{\\partial x} + \\hat{\\mathbf{y}}\\frac{\\partial}{\\partial y} + \\hat{\\mathbf{z}}\\frac{\\partial}{\\partial z}$. Since $\\phi$ is only a function of $x$, its partial derivatives with respect to $y$ and $z$ are zero.\n$$\n\\nabla \\phi(x) = \\hat{\\mathbf{x}}\\frac{\\partial \\phi(x)}{\\partial x} + \\hat{\\mathbf{y}}\\frac{\\partial \\phi(x)}{\\partial y} + \\hat{\\mathbf{z}}\\frac{\\partial \\phi(x)}{\\partial z} = \\hat{\\mathbf{x}}\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} + \\hat{\\mathbf{y}}(0) + \\hat{\\mathbf{z}}(0) = \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\hat{\\mathbf{x}}\n$$\nHere, we use the total derivative $\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}$ as $\\phi$ is a single-variable function. The electric field is given by $\\mathbf{E} = -\\nabla\\phi = -\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\hat{\\mathbf{x}}$, which is purely radial.\n\nNow, we substitute the expressions for $\\hat{\\mathbf{b}}$ and $\\nabla \\phi$ into the definition of $\\mathbf{v}_{E}$:\n$$\n\\mathbf{v}_{E} = \\frac{c}{B}\\,(\\hat{\\mathbf{z}}) \\times \\left(\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\hat{\\mathbf{x}}\\right)\n$$\nThe term $\\frac{c}{B}\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}$ is a scalar. Using the properties of the vector cross product, we can write:\n$$\n\\mathbf{v}_{E} = \\frac{c}{B}\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}})\n$$\nThe cross product of the Cartesian unit vectors follows the right-hand rule: $\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}} = \\hat{\\mathbf{y}}$. Substituting this result, we find the expression for the E$\\times$B drift velocity:\n$$\n\\mathbf{v}_{E} = \\frac{c}{B}\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\hat{\\mathbf{y}}\n$$\nThis vector has a component only in the $\\hat{\\mathbf{y}}$ (poloidal) direction. The radial ($x$) and toroidal ($z$) components are zero: $v_{E,x} = 0$ and $v_{E,z} = 0$. Therefore, the drift produces a flow that is purely poloidal, as was to be shown. The poloidal component of the velocity is:\n$$\nv_{E,y}(x) = \\frac{c}{B}\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\n$$\n\nNext, we are asked to compute the analytic expression for the radial shear of this poloidal flow, defined as $S(x) = \\partial v_{E,y}/\\partial x$, for a specific zonal potential profile:\n$$\n\\phi(x)=\\phi_{0}\\,\\cos(k_{x}x)\n$$\nwhere $\\phi_0$ is the potential amplitude and $k_x$ is the radial wavenumber.\n\nFirst, we calculate the derivative of $\\phi(x)$ with respect to $x$:\n$$\n\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\phi_{0}\\,\\cos(k_{x}x) \\right) = \\phi_{0} \\frac{\\mathrm{d}}{\\mathrm{d}x}(\\cos(k_{x}x)) = \\phi_{0} (-\\sin(k_{x}x) \\cdot k_{x}) = -k_{x}\\phi_{0}\\sin(k_{x}x)\n$$\nWe substitute this result into the expression for the poloidal velocity component $v_{E,y}$:\n$$\nv_{E,y}(x) = \\frac{c}{B}(-k_{x}\\phi_{0}\\sin(k_{x}x)) = -\\frac{c k_{x} \\phi_{0}}{B}\\sin(k_{x}x)\n$$\nNow, we compute the shear $S(x)$ by taking the partial derivative of $v_{E,y}(x)$ with respect to $x$. Since $v_{E,y}$ is a function of $x$ only, this is equivalent to a total derivative.\n$$\nS(x) = \\frac{\\partial v_{E,y}}{\\partial x} = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left(-\\frac{c k_{x} \\phi_{0}}{B}\\sin(k_{x}x)\\right)\n$$\nThe term $-\\frac{c k_{x} \\phi_{0}}{B}$ is a constant with respect to the differentiation.\n$$\nS(x) = -\\frac{c k_{x} \\phi_{0}}{B} \\frac{\\mathrm{d}}{\\mathrm{d}x}(\\sin(k_{x}x))\n$$\nThe derivative of $\\sin(k_{x}x)$ with respect to $x$ is $k_{x}\\cos(k_{x}x)$.\n$$\nS(x) = -\\frac{c k_{x} \\phi_{0}}{B} (k_{x}\\cos(k_{x}x))\n$$\nFinally, by combining terms, we arrive at the analytic expression for the shear:\n$$\nS(x) = -\\frac{c \\phi_{0} k_{x}^{2}}{B} \\cos(k_{x}x)\n$$\nThis expression gives the radial shear of the poloidal E$\\times$B flow as a function of the radial position $x$. The units are consistent, as was verified during the problem validation phase, resulting in inverse seconds (s$^{-1}$).",
            "answer": "$$\n\\boxed{-\\frac{c \\phi_{0} k_{x}^{2}}{B} \\cos(k_{x}x)}\n$$"
        },
        {
            "introduction": "Once we understand what a zonal flow is, the next critical question is *what it does*. Zonal flows are paramount in fusion science because their shear regulates turbulent transport. This practice  guides you through a classic phenomenological model to quantify this suppression, helping you derive how the effective turbulent diffusivity $D$ is reduced as the shearing rate $\\gamma_E$ becomes large compared to the intrinsic turbulence decorrelation rate.",
            "id": "4066192",
            "problem": "Consider electrostatic drift-wave turbulence in a slab model of a magnetically confined fusion plasma, in which zonal flows produce an $\\mathbf{E}\\times\\mathbf{B}$ shear that regulates turbulent transport. The radial turbulent diffusivity $D$ is defined from the Taylor-Green-Kubo (TGK) relation as the time integral of the Lagrangian velocity autocorrelation,\n$$\nD \\equiv \\int_{0}^{\\infty} C_{v}(t)\\,\\mathrm{d}t,\n$$\nwhere $C_{v}(t)$ is the autocorrelation of the radial component of the fluctuating $\\mathbf{E}\\times\\mathbf{B}$ velocity. Assume that in the absence of shear the autocorrelation is exponential,\n$$\nC_{v}^{(0)}(t) = v^{2}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{c}}\\right),\n$$\nwith $v$ the root-mean-square fluctuating radial velocity and $\\tau_{c}$ the characteristic correlation time of the underlying eddies. In the presence of zonal flow shear, suppose that advective decorrelation multiplies the correlation by an additional exponential factor $\\exp(-\\gamma_{E} t)$, where $\\gamma_{E}$ is the $\\mathbf{E}\\times\\mathbf{B}$ shear rate. Starting from these assumptions and the TGK relation, derive the functional dependence of $D$ on $v$, $\\tau_{c}$, and $\\gamma_{E}$, and evaluate $D$ for the parameters\n$$\nv = 4.00 \\times 10^{2}\\ \\mathrm{m/s},\\quad \\tau_{c} = 2.50 \\times 10^{-5}\\ \\mathrm{s},\\quad \\gamma_{E} = 3.20 \\times 10^{4}\\ \\mathrm{s}^{-1}.\n$$\nBriefly explain the limiting behaviors when $\\gamma_{E}\\tau_{c} \\ll 1$ and when $\\gamma_{E}\\tau_{c} \\gg 1$, in terms of how shear modifies the effective correlation time and, consequently, the diffusivity.\n\nExpress your final numerical answer for the sheared turbulent diffusivity $D$ in $\\mathrm{m^{2}/s}$, and round your answer to four significant figures.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and complete. It presents a standard, albeit simplified, model for the regulation of turbulent transport by sheared flows in plasma physics, a topic central to fusion science. All necessary components for a solution are provided, and there are no internal contradictions or factual inaccuracies. We may therefore proceed with the derivation and calculation.\n\nThe problem asks for the turbulent diffusivity $D$, defined by the Taylor-Green-Kubo relation:\n$$\nD \\equiv \\int_{0}^{\\infty} C_{v}(t)\\,\\mathrm{d}t\n$$\nwhere $C_{v}(t)$ is the Lagrangian velocity autocorrelation function of the radial fluctuating velocity.\n\nAccording to the problem statement, the autocorrelation function in the absence of shear is given by\n$$\nC_{v}^{(0)}(t) = v^{2}\\,\\exp\\left(-\\frac{t}{\\tau_{c}}\\right)\n$$\nwhere $v$ is the root-mean-square velocity and $\\tau_{c}$ is the intrinsic correlation time of the turbulence. The presence of an $\\mathbf{E}\\times\\mathbf{B}$ shear, with a shear rate $\\gamma_{E}$, introduces an additional decorrelation mechanism. This is modeled by multiplying the unsheared correlation function by an additional factor of $\\exp(-\\gamma_{E} t)$. The total, sheared autocorrelation function $C_{v}(t)$ is therefore:\n$$\nC_{v}(t) = C_{v}^{(0)}(t) \\exp(-\\gamma_{E} t) = v^{2}\\,\\exp\\left(-\\frac{t}{\\tau_{c}}\\right) \\exp(-\\gamma_{E} t)\n$$\nCombining the exponential terms, we get:\n$$\nC_{v}(t) = v^{2}\\,\\exp\\left(-\\left(\\frac{1}{\\tau_{c}} + \\gamma_{E}\\right)t\\right)\n$$\nNow, we substitute this expression for $C_{v}(t)$ into the definition of the diffusivity $D$:\n$$\nD = \\int_{0}^{\\infty} v^{2}\\,\\exp\\left(-\\left(\\frac{1}{\\tau_{c}} + \\gamma_{E}\\right)t\\right)\\,\\mathrm{d}t\n$$\nSince $v$, $\\tau_{c}$, and $\\gamma_{E}$ are constants with respect to time $t$, we can pull $v^{2}$ out of the integral:\n$$\nD = v^{2} \\int_{0}^{\\infty} \\exp\\left(-\\left(\\frac{1}{\\tau_{c}} + \\gamma_{E}\\right)t\\right)\\,\\mathrm{d}t\n$$\nThe integral is a standard exponential integral. Evaluating it gives:\n$$\nD = v^{2} \\left[ -\\frac{1}{\\frac{1}{\\tau_{c}} + \\gamma_{E}} \\exp\\left(-\\left(\\frac{1}{\\tau_{c}} + \\gamma_{E}\\right)t\\right) \\right]_{t=0}^{t=\\infty}\n$$\n$$\nD = v^{2} \\left( 0 - \\left( -\\frac{1}{\\frac{1}{\\tau_{c}} + \\gamma_{E}} \\exp(0) \\right) \\right) = v^{2} \\left(\\frac{1}{\\frac{1}{\\tau_{c}} + \\gamma_{E}}\\right)\n$$\nThis expression can be algebraically rearranged to better show the dependence on the dimensionless parameter $\\gamma_{E}\\tau_{c}$. Multiplying the numerator and denominator by $\\tau_c$:\n$$\nD = \\frac{v^{2}\\tau_{c}}{1 + \\gamma_{E}\\tau_{c}}\n$$\nThis is the required functional dependence of $D$ on $v$, $\\tau_{c}$, and $\\gamma_{E}$.\n\nNext, we analyze the limiting behaviors. The total decorrelation rate is $\\tau_{eff}^{-1} = \\tau_{c}^{-1} + \\gamma_{E}$, so the effective correlation time is $\\tau_{eff} = (\\tau_{c}^{-1} + \\gamma_{E})^{-1}$. The diffusivity can be expressed as $D = v^2 \\tau_{eff}$.\n1.  **Weak shear limit ($\\gamma_{E}\\tau_{c} \\ll 1$):**\n    In this case, $\\gamma_{E} \\ll 1/\\tau_{c}$. The shear decorrelation rate is much smaller than the intrinsic eddy decorrelation rate. The denominator $1 + \\gamma_{E}\\tau_{c} \\approx 1$. The diffusivity becomes:\n    $$\n    D \\approx v^{2}\\tau_{c}\n    $$\n    This is the quasilinear estimate of diffusivity, where transport is limited only by the intrinsic properties of the turbulence. The effective correlation time $\\tau_{eff} \\approx \\tau_{c}$.\n\n2.  **Strong shear limit ($\\gamma_{E}\\tau_{c} \\gg 1$):**\n    In this case, $\\gamma_{E} \\gg 1/\\tau_{c}$. The shear decorrelation rate dominates. The denominator $1 + \\gamma_{E}\\tau_{c} \\approx \\gamma_{E}\\tau_{c}$. The diffusivity becomes:\n    $$\n    D \\approx \\frac{v^{2}\\tau_{c}}{\\gamma_{E}\\tau_{c}} = \\frac{v^{2}}{\\gamma_{E}}\n    $$\n    Here, the effective correlation time is determined by the shear, $\\tau_{eff} \\approx \\gamma_{E}^{-1}$. The turbulent eddies are torn apart by the shear flow long before they can decorrelate naturally. This leads to a significant reduction in the turbulent diffusivity, representing the regulation of turbulence by the zonal flow shear.\n\nFinally, we evaluate $D$ for the given parameters:\n$$\nv = 4.00 \\times 10^{2}\\ \\mathrm{m/s}\n$$\n$$\n\\tau_{c} = 2.50 \\times 10^{-5}\\ \\mathrm{s}\n$$\n$$\n\\gamma_{E} = 3.20 \\times 10^{4}\\ \\mathrm{s}^{-1}\n$$\nFirst, we calculate the dimensionless parameter $\\gamma_{E}\\tau_{c}$:\n$$\n\\gamma_{E}\\tau_{c} = (3.20 \\times 10^{4}\\ \\mathrm{s}^{-1}) \\times (2.50 \\times 10^{-5}\\ \\mathrm{s}) = 0.800\n$$\nSince this value is of order unity, we are in an intermediate regime where both decorrelation mechanisms are important.\nNow, we substitute the values into the derived formula for $D$:\n$$\nD = \\frac{v^{2}\\tau_{c}}{1 + \\gamma_{E}\\tau_{c}} = \\frac{(4.00 \\times 10^{2}\\ \\mathrm{m/s})^{2} \\times (2.50 \\times 10^{-5}\\ \\mathrm{s})}{1 + 0.800}\n$$\n$$\nD = \\frac{(1.600 \\times 10^{5}\\ \\mathrm{m^{2}/s^{2}}) \\times (2.50 \\times 10^{-5}\\ \\mathrm{s})}{1.800}\n$$\n$$\nD = \\frac{4.00\\ \\mathrm{m^{2}/s}}{1.800} \\approx 2.2222...\\ \\mathrm{m^{2}/s}\n$$\nRounding the result to four significant figures as requested by the problem statement, we obtain:\n$$\nD = 2.222\\ \\mathrm{m^{2}/s}\n$$",
            "answer": "$$\n\\boxed{2.222}\n$$"
        },
        {
            "introduction": "Theory and simulation are intrinsically linked; theoretical predictions must be tested against computational data. This final exercise simulates the work of a computational plasma physicist, tasking you with analyzing mock simulation data to find a quantitative threshold for turbulence suppression . You will implement a robust criterion to determine the critical shear rate at which transport is significantly reduced, directly testing the theoretical principle that regulation becomes effective when the shearing rate $\\gamma_E$ is comparable to the linear growth rate $\\gamma_L$ of the turbulence.",
            "id": "4066226",
            "problem": "You are given sets of numerical simulation results of magnetized plasma turbulence where a mean $\\mathbf{E}\\times\\mathbf{B}$ flow with radial shear is imposed. The mean flow is represented by a scalar field $U(x)$, and the imposed shear is $U'(x)=\\mathrm{d}U/\\mathrm{d}x$. For each run $i$ at a distinct imposed shear value $U'_i$, the time-averaged turbulent transport (e.g., heat flux or particle flux) normalized to a fixed reference is provided as $Q_i$. A linear analysis of the underlying instability provides a characteristic linear growth rate $\\gamma_L$ for the system under the same background profiles.\n\nYour task is to design and implement a quantitative test to determine the threshold at which transport reduction occurs due to shear regulation. The test must be formulated using first-principles time-scale comparison, and then applied to the given simulation data. Specifically:\n\n- Use the mean shear to define the shear-induced decorrelation rate $\\gamma_E$ at run $i$ by $\\gamma_{E,i}=\\lvert U'_i\\rvert$. This reflects the rate at which the mean shear distorts turbulent eddies.\n- Define the baseline transport $Q_0$ as the transport in the run with the smallest imposed shear (i.e., the first element of the given $Q$ list for a test case).\n- Define a quantitative transport reduction criterion using two parameters $\\alpha\\in(0,1)$ and an integer $m\\ge 1$: transport reduction is deemed to occur at the earliest run index $i$ such that $Q_j\\le \\alpha\\,Q_0$ for all $j\\in\\{i,i+1,\\dots,i+m-1\\}$. This sustains the reduction over $m$ consecutive runs to avoid mistaking noise for a true transition.\n- For the earliest $i$ that meets the above criterion, report the dimensionless threshold ratio $R^\\star=\\gamma_{E,i}/\\gamma_L$. If no sequence of length $m$ meets the transport reduction criterion, report $-1.0$.\n\nAll $U'_i$ and $\\gamma_L$ must be treated in units of $\\mathrm{s}^{-1}$, and all $Q_i$ are dimensionless. Your program must apply the above test to the following test suite and produce the required outputs. Each result must be rounded to three decimal places.\n\nTest Suite (each tuple is structured as $(U', Q, \\gamma_L, \\alpha, m)$):\n1. Happy path with a clear reduction near the time-scale balance:\n   - $U'=\\{0.0,\\,0.2,\\,0.4,\\,0.6,\\,0.8,\\,0.9,\\,1.0,\\,1.2,\\,1.4,\\,1.6\\}$ in $\\mathrm{s}^{-1}$\n   - $Q=\\{0.98,\\,1.01,\\,1.00,\\,0.97,\\,0.92,\\,0.62,\\,0.58,\\,0.53,\\,0.50,\\,0.49\\}$\n   - $\\gamma_L=0.9$ in $\\mathrm{s}^{-1}$\n   - $\\alpha=0.7$, $m=2$\n2. Edge case with no observed reduction within the scanned shear range:\n   - $U'=\\{0.0,\\,0.05,\\,0.10,\\,0.15,\\,0.20,\\,0.25,\\,0.30,\\,0.35,\\,0.40,\\,0.50\\}$ in $\\mathrm{s}^{-1}$\n   - $Q=\\{0.99,\\,1.02,\\,0.98,\\,1.01,\\,1.00,\\,0.97,\\,1.00,\\,0.98,\\,0.95,\\,0.96\\}$\n   - $\\gamma_L=1.2$ in $\\mathrm{s}^{-1}$\n   - $\\alpha=0.7$, $m=2$\n3. Multi-stage reduction where the first sustained drop occurs at moderate shear:\n   - $U'=\\{0.0,\\,0.1,\\,0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.7,\\,0.8,\\,1.0,\\,1.2,\\,1.4\\}$ in $\\mathrm{s}^{-1}$\n   - $Q=\\{1.03,\\,1.01,\\,1.02,\\,0.99,\\,1.00,\\,0.98,\\,0.75,\\,0.68,\\,0.66,\\,0.58,\\,0.45,\\,0.40\\}$\n   - $\\gamma_L=0.5$ in $\\mathrm{s}^{-1}$\n   - $\\alpha=0.7$, $m=2$\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element must be the rounded threshold ratio $R^\\star$ (to three decimal places) for the corresponding test case, or $-1.000$ if no threshold is found. For example, an output line could look like \"[1.000,-1.000,1.400]\".",
            "solution": "We begin from the basic physics of magnetized plasma turbulence regulated by mean shear in the cross-field drift. In a strongly magnetized plasma with magnetic field $\\mathbf{B}$ and electrostatic potential $\\phi$, the $\\mathbf{E}\\times\\mathbf{B}$ velocity is given by $\\mathbf{v}_E=(\\mathbf{E}\\times\\mathbf{B})/B^2$, where $\\mathbf{E}=-\\nabla\\phi$. For a mean flow $U(x)$ representing a component of $\\mathbf{v}_E$ along a given coordinate, the shear $U'(x)=\\mathrm{d}U/\\mathrm{d}x$ quantifies spatial variation of advection across an eddy.\n\nThe central principle for turbulence regulation by mean shear is a competition of time scales. The mean shear advects and distorts eddies, producing decorrelation at a characteristic rate. The distortion of an eddy of size $\\ell$ under a linear shear $U'(x)$ occurs on a time scale proportional to $1/\\lvert U'(x)\\rvert$, because the relative advection between two points separated by $\\Delta x$ is $\\Delta v\\simeq U'(x)\\,\\Delta x$, and the shearing angle grows at a rate set by $U'(x)$. Approximating the shear-induced decorrelation rate for turbulence as\n$$\n\\gamma_E(x)=\\lvert U'(x)\\rvert,\n$$\nexpressed in $\\mathrm{s}^{-1}$, captures the rate at which turbulence is sheared apart by the mean flow. In parallel, the instability responsible for driving turbulence has a linear growth rate $\\gamma_L$ (in $\\mathrm{s}^{-1}$), which sets the time scale $\\tau_L=1/\\gamma_L$ for exponential growth of perturbations.\n\nA robust, physically grounded criterion for transport reduction (suppression of turbulence intensity and associated fluxes) emerges by comparing the shearing decorrelation time scale $\\tau_E=1/\\gamma_E$ against the linear growth time scale $\\tau_L=1/\\gamma_L$. When the shear decorrelation occurs faster than growth, i.e.,\n$$\n\\tau_E \\le \\tau_L \\quad \\Longleftrightarrow \\quad \\gamma_E \\ge \\gamma_L,\n$$\nthe mean shear can suppress or strongly reduce turbulence. This competition embodies the mechanism by which zonal flows (self-generated mean flows) and imposed mean shear regulate turbulence.\n\nTo translate this principle into a quantitative test on simulation data, we need a practical indicator of transport reduction that is resilient to noise. Let the measured time-averaged normalized turbulent transport be $Q_i$ for run $i$ at imposed shear $U'_i$. Define $Q_0$ as the baseline transport at the smallest shear, i.e., the first element of the $Q$ list. Choose a reduction fraction $\\alpha\\in(0,1)$ and a required consecutive count $m\\in\\mathbb{N}$ to define a sustained reduction. The earliest index $i$ satisfying\n$$\nQ_j \\le \\alpha\\,Q_0 \\quad \\text{for all } j\\in\\{i,i+1,\\dots,i+m-1\\}\n$$\nmarks the onset of transport reduction. The corresponding threshold ratio is\n$$\nR^\\star \\equiv \\frac{\\gamma_{E,i}}{\\gamma_L} = \\frac{\\lvert U'_i\\rvert}{\\gamma_L}.\n$$\nIf no $i$ in the scanned range satisfies the criterion, we report $-1.0$.\n\nAlgorithmic implementation:\n1. For each test case, read $U'$, $Q$, $\\gamma_L$, $\\alpha$, and $m$.\n2. Compute $Q_0=Q[0]$.\n3. Scan indices $i$ from $0$ to $N-m$, where $N$ is the number of runs. At each $i$, check whether $Q_j\\le \\alpha Q_0$ for all $j\\in[i,i+m-1]$.\n4. If found, compute $R^\\star=\\lvert U'_i\\rvert/\\gamma_L$ and return this value (rounded to three decimals). If not found, return $-1.000$.\n5. Aggregate the results for all cases into a single line list as specified.\n\nApplication to the provided test suite:\n- Case 1: $Q_0=0.98$. With $\\alpha=0.7$, the threshold level is $\\alpha Q_0=0.686$. The first index with two consecutive points below $0.686$ occurs at $i=5$ with $Q_5=0.62$ and $Q_6=0.58$. The associated shear is $\\lvert U'_5\\rvert=0.9\\,\\mathrm{s}^{-1}$ and $\\gamma_L=0.9\\,\\mathrm{s}^{-1}$, hence $R^\\star=0.9/0.9=1.0$, rounded to $1.000$.\n- Case 2: $Q_0=0.99$. The threshold level is $\\alpha Q_0=0.693$. None of the values in $Q$ meet two consecutive points at or below $0.693$. Therefore, the result is $-1.000$.\n- Case 3: $Q_0=1.03$. The threshold level is $\\alpha Q_0=0.721$. The first sustained reduction occurs at $i=7$ with $Q_7=0.68$ and $Q_8=0.66$, both $\\le 0.721$. The associated shear is $\\lvert U'_7\\rvert=0.7\\,\\mathrm{s}^{-1}$ and $\\gamma_L=0.5\\,\\mathrm{s}^{-1}$, hence $R^\\star=0.7/0.5=1.4$, rounded to $1.400$.\n\nThe final output thus aggregates these three results into the required single-line format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef find_threshold_ratio(Uprime, Q, gamma_L, alpha, m):\n    \"\"\"\n    Determine the earliest threshold index i where transport reduction is sustained\n    for m consecutive runs, and return the ratio R* = |U'(i)| / gamma_L.\n    If no threshold is found, return -1.0.\n    \"\"\"\n    Q0 = Q[0]\n    threshold_level = alpha * Q0\n    n = len(Q)\n    for i in range(0, n - m + 1):\n        window = Q[i:i + m]\n        if np.all(np.array(window) <= threshold_level):\n            ratio = abs(Uprime[i]) / gamma_L\n            return ratio\n    return -1.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Happy path\n        (\n            [0.0, 0.2, 0.4, 0.6, 0.8, 0.9, 1.0, 1.2, 1.4, 1.6],  # U' in s^-1\n            [0.98, 1.01, 1.00, 0.97, 0.92, 0.62, 0.58, 0.53, 0.50, 0.49],  # Q (dimensionless)\n            0.9,  # gamma_L in s^-1\n            0.7,  # alpha\n            2     # m\n        ),\n        # Case 2: Edge case - no reduction\n        (\n            [0.0, 0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.50],\n            [0.99, 1.02, 0.98, 1.01, 1.00, 0.97, 1.00, 0.98, 0.95, 0.96],\n            1.2,\n            0.7,\n            2\n        ),\n        # Case 3: Multi-stage reduction\n        (\n            [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 1.0, 1.2, 1.4],\n            [1.03, 1.01, 1.02, 0.99, 1.00, 0.98, 0.75, 0.68, 0.66, 0.58, 0.45, 0.40],\n            0.5,\n            0.7,\n            2\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        Uprime, Q, gamma_L, alpha, m = case\n        ratio = find_threshold_ratio(Uprime, Q, gamma_L, alpha, m)\n        # Round to three decimal places as specified\n        rounded = f\"{ratio:.3f}\"\n        results.append(rounded)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}