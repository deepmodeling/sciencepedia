{
    "hands_on_practices": [
        {
            "introduction": "要理解大地声学模 (Geodesic Acoustic Mode, GAM) 与湍流的耦合，首要任务是明确 GAM 的驱动机制。在流体描述的框架下，GAM 由湍流雷诺胁强的散度驱动。本练习将引导你通过一个具体的计算任务，深入理解这一基本过程，即将湍流的微观统计特性（由两点相关函数描述）与驱动 GAM 的宏观力（雷诺胁强）直接联系起来。通过从一个给定的合成湍流场计算 GAM 的有效源项，你将掌握湍流分析中的一项核心技能，并从第一性原理验证 GAM 驱动强度与湍流强度的标度关系 。",
            "id": "3984874",
            "problem": "考虑一个磁约束等离子体的局域通量管平板模型，其径向坐标为 $x$，类极向坐标为 $y$。测地声学模 (GAM) 是流动的振荡纬向分量，在流体极限下，它由湍流雷诺应力的散度驱动。在归一化的回旋玻姆单位制中，设 $(c/B)=1$，其中 $c$ 是光速，$B$ 是磁场强度，并通过一个恒定的参考值对静电势进行归一化，使得所有计算量均为无量纲。角度必须以弧度为单位。\n\n电场叉磁场 (E$\\times$B) 速度由 $v_x = -\\partial_y \\tilde{\\phi}$ 和 $v_y = \\partial_x \\tilde{\\phi}$ 给出，其中 $\\tilde{\\phi}(x,y,t)$ 是涨落静电势。雷诺应力定义为 $\\Pi_{xy}(x) = \\langle v_x v_y \\rangle$，有效的 GAM 源项是雷诺应力的径向导数，$S_{\\mathrm{GAM}}(x) = -\\partial_x \\Pi_{xy}(x)$，其中尖括号表示对湍流实现的系综平均。\n\n假设在 $(\\Delta x,\\Delta y)$ 上湍流统计是均匀的，并具有一个随径向缓慢变化的强度包络。静电势涨落的两点相关函数规定为\n$$\nC_{\\phi\\phi}(\\Delta x, \\Delta y; x) = \\langle \\tilde{\\phi}(x,y) \\tilde{\\phi}(x+\\Delta x, y+\\Delta y) \\rangle = I(x)^2 \\exp\\!\\left(-\\frac{\\Delta x^2}{\\lambda_x^2} - \\frac{\\Delta y^2}{\\lambda_y^2}\\right) \\cos\\!\\left(k_x \\Delta x + k_y \\Delta y + \\varphi\\right),\n$$\n其中 $I(x)$ 是湍流强度包络，$\\lambda_x$ 和 $\\lambda_y$ 是相关长度，$k_x$ 和 $k_y$ 是特征波数，$\\varphi$ 是一个恒定相位。径向包络为\n$$\nI(x) = I_0 \\exp\\!\\left(\\frac{\\gamma}{L_I}(x - x_c)\\right),\n$$\n其中 $I_0$ 是在 $x=x_c$ 处的参考强度，$L_I$ 是包络的径向尺度，$\\gamma$ 是一个无量纲斜率参数。\n\n仅从上述定义、连接 GAM 源项与雷诺应力散度的流体动量平衡方程，以及均匀相关的性质出发，推导一个用在零间距处计算的 $C_{\\phi\\phi}$ 的导数表示的 $S_{\\mathrm{GAM}}(x)$ 的可计算表达式。然后实现一个程序，对以下每个测试用例，在指定的求值半径 $x_{\\mathrm{eval}}$ 处数值计算 $S_{\\mathrm{GAM}}(x)$，并通过对一组除 $I_0$ 不同外其他参数均相同的三个案例进行 $\\log S_{\\mathrm{GAM}}$ 与 $\\log I_0$ 的最小二乘线性拟合，来评估标度指数 $\\alpha$，使得 $S_{\\mathrm{GAM}} \\propto I_0^\\alpha$。\n\n使用以下测试套件（角度以弧度为单位，所有量均如上所述已无量纲化）：\n\n- 测试用例 $1$（一般情况）：$I_0 = 0.5$，$\\gamma = 0.8$，$L_I = 0.3$，$x_c = 0.0$，$x_{\\mathrm{eval}} = 0.1$，$\\lambda_x = 0.2$，$\\lambda_y = 0.2$，$k_x = 1.2$，$k_y = 0.9$，$\\varphi = 0.3$。\n- 测试用例 $2$（相位相消边界情况）：与测试用例 $1$ 相同，但 $\\varphi = \\pi/2$。\n- 测试用例 $3$（波数各向异性边界情况）：与测试用例 $1$ 相同，但 $k_x = 0.0$。\n- 测试用例 $4$（强度均匀边界情况）：与测试用例 $1$ 相同，但 $\\gamma = 0.0$。\n- 测试用例组 $5$（随 $I_0$ 的标度关系）：三个与测试用例 $1$ 相同的案例，只是 $I_0 \\in \\{0.3, 0.6, 1.2\\}$。计算每个成员的 $S_{\\mathrm{GAM}}$，然后报告从 $\\log S_{\\mathrm{GAM}}$ 与 $\\log I_0$ 的最小二乘斜率获得的拟合标度指数 $\\alpha$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表：$[S_1,S_2,S_3,S_4,\\alpha]$，其中 $S_j$ 是测试用例 $j=1,2,3,4$ 在 $x_{\\mathrm{eval}}$ 处计算出的有效 GAM 源项，$\\alpha$ 是测试用例组 $5$ 的拟合标度指数。所有输出都必须表示为浮点数。",
            "solution": "首先对问题进行验证，以确保其在科学上是合理的、自洽的且适定的。提取并分析已知条件。\n\n**已知条件：**\n- 模型：局域通量管平板模型，坐标为 $x$ (径向) 和 $y$ (类极向)。\n- 归一化：$(c/B)=1$。\n- E$\\times$B 速度：$v_x = -\\partial_y \\tilde{\\phi}$ 和 $v_y = \\partial_x \\tilde{\\phi}$。\n- 雷诺应力：$\\Pi_{xy}(x) = \\langle v_x v_y \\rangle$。\n- GAM 源项：$S_{\\mathrm{GAM}}(x) = -\\partial_x \\Pi_{xy}(x)$。\n- 相关函数：$C_{\\phi\\phi}(\\Delta x, \\Delta y; x) = \\langle \\tilde{\\phi}(x,y) \\tilde{\\phi}(x+\\Delta x, y+\\Delta y) \\rangle = I(x)^2 \\exp\\!\\left(-\\frac{\\Delta x^2}{\\lambda_x^2} - \\frac{\\Delta y^2}{\\lambda_y^2}\\right) \\cos\\!\\left(k_x \\Delta x + k_y \\Delta y + \\varphi\\right)$。\n- 湍流强度包络：$I(x) = I_0 \\exp\\!\\left(\\frac{\\gamma}{L_I}(x - x_c)\\right)$。\n- 提供了五个测试用例的所有参数，且所有量均为无量纲。\n\n**验证结论：**\n问题是**有效**的。它在科学上基于已建立的等离子体湍流和流体动力学理论（特别是通过雷诺应力产生像 GAMs 这样的纬向流）。定义是标准的，所提供的函数在数学上是良态的，并且问题是自洽的，为计算指定了所有必要的参数。该任务是适定的，对于每个测试用例都有唯一的解。\n\n**$S_{\\mathrm{GAM}}(x)$ 的可计算表达式的推导**\n\n推导过程主要分三步：首先，将雷诺应力与两点相关函数联系起来；其次，计算给定相关函数的必要导数；第三，计算最终的 GAM 源项。\n\n1.  **雷诺应力与相关函数**\n    在径向位置 $x$ 处的雷诺应力 $\\Pi_{xy}(x)$ 定义为 $\\Pi_{xy}(x) = \\langle v_x v_y \\rangle$。代入 E$\\times$B 速度分量 $v_x = -\\partial_y \\tilde{\\phi}$ 和 $v_y = \\partial_x \\tilde{\\phi}$，我们得到：\n    $$\n    \\Pi_{xy}(x) = \\langle (-\\partial_y \\tilde{\\phi}) (\\partial_x \\tilde{\\phi}) \\rangle\n    $$\n    为了计算在单一点上导数乘积的平均值，我们将其表示为两点量在零间距时的极限。设 $\\mathbf{r}_1 = (x_1, y_1)$ 和 $\\mathbf{r}_2 = (x_2, y_2)$。在 $x_1$ 处的雷诺应力可以写为：\n    $$\n    \\Pi_{xy}(x_1) = -\\lim_{\\mathbf{r}_2 \\to \\mathbf{r}_1} \\langle (\\partial_{y_1} \\tilde{\\phi}(\\mathbf{r}_1)) (\\partial_{x_2} \\tilde{\\phi}(\\mathbf{r}_2)) \\rangle\n    $$\n    假设导数与系综平均算子 $\\langle \\cdot \\rangle$ 可交换，我们得到：\n    $$\n    \\Pi_{xy}(x_1) = -\\lim_{\\mathbf{r}_2 \\to \\mathbf{r}_1} \\frac{\\partial^2}{\\partial y_1 \\partial x_2} \\langle \\tilde{\\phi}(\\mathbf{r}_1) \\tilde{\\phi}(\\mathbf{r}_2) \\rangle\n    $$\n    项 $\\langle \\tilde{\\phi}(\\mathbf{r}_1) \\tilde{\\phi}(\\mathbf{r}_2) \\rangle$ 是两点相关函数，表示为 $C_{\\phi\\phi}(\\Delta x, \\Delta y; x_1)$，其中 $\\Delta x = x_2 - x_1$ 和 $\\Delta y = y_2 - y_1$。我们使用链式法则，用间距坐标 $(\\Delta x, \\Delta y)$ 来重新表示偏导数：$\\partial_{x_2} = \\partial_{\\Delta x}$ 和 $\\partial_{y_1} = -\\partial_{\\Delta y}$。混合导数算子变为 $\\frac{\\partial^2}{\\partial y_1 \\partial x_2} = -\\frac{\\partial^2}{\\partial \\Delta y \\partial \\Delta x}$。代入这个结果并取极限 $\\mathbf{r}_2 \\to \\mathbf{r}_1$ (即 $\\Delta x \\to 0$, $\\Delta y \\to 0$)，我们发现：\n    $$\n    \\Pi_{xy}(x) = -\\left[ -\\frac{\\partial^2 C_{\\phi\\phi}(\\Delta x, \\Delta y; x)}{\\partial \\Delta y \\partial \\Delta x} \\right]_{\\Delta x=0, \\Delta y=0} = \\left[ \\frac{\\partial^2 C_{\\phi\\phi}(\\Delta x, \\Delta y; x)}{\\partial \\Delta x \\partial \\Delta y} \\right]_{\\Delta x=0, \\Delta y=0}\n    $$\n\n2.  **相关函数导数的计算**\n    相关函数的形式为 $C_{\\phi\\phi}(\\Delta x, \\Delta y; x) = I(x)^2 G(\\Delta x, \\Delta y)$，其中 $G(\\Delta x, \\Delta y)$ 包含指数和余弦项。$G$ 关于 $\\Delta x$ 和 $\\Delta y$ 的混合偏导数必须在零间距处计算。设 $F = \\exp\\!\\left(-\\frac{\\Delta x^2}{\\lambda_x^2} - \\frac{\\Delta y^2}{\\lambda_y^2}\\right)$ 和 $H = \\cos\\!\\left(k_x \\Delta x + k_y \\Delta y + \\varphi\\right)$。我们需要计算 $\\left[ \\partial_{\\Delta x} \\partial_{\\Delta y} (FH) \\right]_{(0,0)}$。使用乘积法则进行微分，并在 $(\\Delta x, \\Delta y)=(0,0)$ 处求值，我们发现任何包含 $F$ 的一阶导数的项都为零，因为 $\\left.\\partial_{\\Delta x} F\\right|_{(0,0)} = 0$ 和 $\\left.\\partial_{\\Delta y} F\\right|_{(0,0)} = 0$。类似地，$\\left.\\partial_{\\Delta x}\\partial_{\\Delta y} F\\right|_{(0,0)} = 0$。表达式简化为：\n    $$\n    \\left[ \\frac{\\partial^2 G}{\\partial \\Delta x \\partial \\Delta y} \\right]_{(0,0)} = \\left[ F \\frac{\\partial^2 H}{\\partial \\Delta x \\partial \\Delta y} \\right]_{(0,0)} = F(0,0) \\left[ \\frac{\\partial^2 H}{\\partial \\Delta x \\partial \\Delta y} \\right]_{(0,0)}\n    $$\n    由于 $F(0,0) = 1$，我们只需要 $H$ 的二阶导数：\n    $$\n    \\frac{\\partial^2 H}{\\partial \\Delta x \\partial \\Delta y} = \\frac{\\partial^2}{\\partial \\Delta x \\partial \\Delta y} \\cos(k_x \\Delta x + k_y \\Delta y + \\varphi) = -k_x k_y \\cos(k_x \\Delta x + k_y \\Delta y + \\varphi)\n    $$\n    在 $(\\Delta x, \\Delta y)=(0,0)$ 处求值得出 $-k_x k_y \\cos(\\varphi)$。\n    因此，雷诺应力为：\n    $$\n    \\Pi_{xy}(x) = I(x)^2 (-k_x k_y \\cos(\\varphi)) = -k_x k_y \\cos(\\varphi) I(x)^2\n    $$\n\n3.  **GAM 源项的推导**\n    GAM 源项为 $S_{\\mathrm{GAM}}(x) = -\\partial_x \\Pi_{xy}(x)$。由于 $k_x$、$k_y$ 和 $\\varphi$ 是常数，径向导数只作用于 $I(x)^2$。\n    $$\n    S_{\\mathrm{GAM}}(x) = -\\frac{\\partial}{\\partial x} \\left[-k_x k_y \\cos(\\varphi) I(x)^2\\right] = k_x k_y \\cos(\\varphi) \\frac{d(I(x)^2)}{dx}\n    $$\n    给定 $I(x) = I_0 \\exp\\left(\\frac{\\gamma}{L_I}(x - x_c)\\right)$，我们有 $I(x)^2 = I_0^2 \\exp\\left(\\frac{2\\gamma}{L_I}(x - x_c)\\right)$。其导数为：\n    $$\n    \\frac{d(I(x)^2)}{dx} = I_0^2 \\cdot \\frac{2\\gamma}{L_I} \\exp\\left(\\frac{2\\gamma}{L_I}(x - x_c)\\right) = \\frac{2\\gamma}{L_I} I(x)^2\n    $$\n    将其代回，得到 GAM 源项的最终表达式：\n    $$\n    S_{\\mathrm{GAM}}(x) = k_x k_y \\cos(\\varphi) \\left(\\frac{2\\gamma}{L_I} I(x)^2\\right) = \\frac{2 \\gamma k_x k_y I_0^2}{L_I} \\cos(\\varphi) \\exp\\left(\\frac{2\\gamma}{L_I}(x - x_c)\\right)\n    $$\n    这就是需要实现的公式。值得注意的是，结果与相关长度 $\\lambda_x$ 和 $\\lambda_y$无关。从此公式可以明显看出标度关系 $S_{\\mathrm{GAM}} \\propto I_0^2$，这意味着标度指数 $\\alpha$ 精确为 $2$。取对数，$\\log(S_{\\mathrm{GAM}}) = \\log(\\text{const}) + 2 \\log(I_0)$，这证实了 $\\log(S_{\\mathrm{GAM}})$ 对 $\\log(I_0)$ 的最小二乘拟合必须得到斜率为 $2$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Geodesic Acoustic Mode (GAM) source term for several test cases\n    and determines the scaling exponent with respect to turbulence intensity.\n    \"\"\"\n\n    def calculate_s_gam(params):\n        \"\"\"\n        Computes the GAM source term S_GAM(x) based on the derived analytical formula.\n        \n        S_GAM(x) = (2 * gamma * k_x * k_y * I_0^2 / L_I) * cos(phi) * exp(2 * gamma * (x_eval - x_c) / L_I)\n        \n        Args:\n            params (dict): A dictionary of parameters for the calculation.\n        \n        Returns:\n            float: The calculated value of S_GAM at x_eval.\n        \"\"\"\n        I0 = params['I0']\n        gamma = params['gamma']\n        L_I = params['L_I']\n        x_c = params['x_c']\n        x_eval = params['x_eval']\n        k_x = params['k_x']\n        k_y = params['k_y']\n        phi = params['phi']\n\n        # Handle edge cases where the formula evaluates to zero to avoid unnecessary computation.\n        if gamma == 0.0 or k_x == 0.0 or k_y == 0.0 or np.cos(phi) == 0.0:\n            return 0.0\n\n        term1 = (2 * gamma * k_x * k_y * I0**2) / L_I\n        term2 = np.cos(phi)\n        exponent = (2 * gamma / L_I) * (x_eval - x_c)\n        term3 = np.exp(exponent)\n\n        return term1 * term2 * term3\n\n    # Define the common parameters for test cases 1-4 and group 5.\n    base_params = {\n        'I0': 0.5, 'gamma': 0.8, 'L_I': 0.3, 'x_c': 0.0, 'x_eval': 0.1,\n        'lambda_x': 0.2, 'lambda_y': 0.2, 'k_x': 1.2, 'k_y': 0.9, 'phi': 0.3\n    }\n    \n    # Test cases setup\n    params1 = base_params.copy()\n    \n    params2 = base_params.copy()\n    params2['phi'] = np.pi / 2\n    \n    params3 = base_params.copy()\n    params3['k_x'] = 0.0\n    \n    params4 = base_params.copy()\n    params4['gamma'] = 0.0\n\n    # Calculate results for test cases 1-4\n    s1 = calculate_s_gam(params1)\n    s2 = calculate_s_gam(params2)\n    s3 = calculate_s_gam(params3)\n    s4 = calculate_s_gam(params4)\n    \n    # Test case group 5: Scaling with I_0\n    I0_values = [0.3, 0.6, 1.2]\n    s_gam_values = []\n    \n    for i0_val in I0_values:\n        params5 = base_params.copy()\n        params5['I0'] = i0_val\n        s_gam_values.append(calculate_s_gam(params5))\n\n    # Perform a least-squares linear fit on the logs to find the scaling exponent alpha.\n    # The relationship is log(S_GAM) = alpha * log(I_0) + const.\n    # The slope of the fit is alpha.\n    log_I0 = np.log(np.array(I0_values))\n    log_S_gam = np.log(np.array(s_gam_values))\n    \n    # Use numpy.polyfit to find the slope of the line of best fit (degree 1 polynomial).\n    # The result is [slope, intercept]. We need the slope.\n    alpha = np.polyfit(log_I0, log_S_gam, 1)[0]\n    \n    # Assemble the final results list\n    results = [s1, s2, s3, s4, alpha]\n    \n    # Print the results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了湍流如何驱动 GAM 之后，下一个关键问题是它们之间如何相互作用并达到动态平衡。实验和模拟中普遍观察到，GAM 和湍流水平常常表现出间歇性的振荡行为。本练习通过一个简化的捕食者-猎物模型来阐释这一现象，其中湍流（猎物）为 GAM（捕食者）的生长提供能量，而 GAM 反过来通过其剪切流抑制湍流。通过分析这个非线性动力学系统的定点和稳定性，你将能够推导出系统发生 Hopf 分岔的条件，从而理解极限环振荡（即 GAM 的间歇性爆发）是如何产生的 。",
            "id": "3984893",
            "problem": "考虑一个简化的无量纲湍流-测地声模 (GAM) 系统，该系统通过雷诺胁强驱动和测地曲率动力学捕捉了漂移波湍流强度和 GAM 振荡之间的相互耦合。令 $I(t)$ 表示湍流强度，$A(t)$ 表示 GAM 势扰动，且 $B(t) \\equiv dA/dt$。假设基于自由能产生、剪切抑制和线性 GAM 振子动力学的以下最小模型：\n$$\n\\frac{dI}{dt} = \\left(\\gamma_{L} - c\\,A - b\\,I\\right) I,\n$$\n$$\n\\frac{dA}{dt} = B,\n$$\n$$\n\\frac{dB}{dt} = -\\omega_{g}^{2}\\,A - \\gamma_{g}\\,B + s\\,I,\n$$\n其中 $b>0$ 代表非线性湍流自阻尼，$c>0$ 代表 GAM 对湍流的剪切抑制，$\\gamma_{L}>0$ 是湍流的净线性驱动，$\\omega_{g}>0$ 是线性 GAM 频率，$\\gamma_{g}>0$ 是 GAM 的有效线性阻尼，$s>0$ 是湍流对 GAM 的有效雷诺胁强驱动。\n\n任务：\n- 识别具有 $I^{\\ast}>0$ 和 $B^{\\ast}=0$ 的非平凡稳态，并用参数表示 $A^{\\ast}$ 和 $I^{\\ast}$。\n- 在此稳态附近对系统进行线性化，并构建雅可比矩阵。由此推导出特征多项式，并将其写成标准三次形式 $ \\lambda^{3} + a_{1}\\lambda^{2} + a_{2}\\lambda + a_{3} = 0 $，其中系数用参数和稳态表示。\n- 使用劳斯-赫尔维茨判据获得对应于间歇性 GAM 爆发的极限环出现的霍普夫分岔阈值条件。在假设 $ \\gamma_{L} > \\gamma_{g} > 0$ 且所有其他参数均为正的情况下，显式地求解临界雷诺胁强耦合 $s_{H}$，得到一个关于模型参数的单一闭合形式表达式。以尽可能简化的无量纲形式报告最终的 $s_{H}$ 表达式。\n- 你的最终答案必须是 $s_{H}$ 的一个单一闭合形式解析表达式。",
            "solution": "该问题陈述具有科学依据，是适定的、客观的。它描述了一个 Lotka-Volterra 型的捕食者-猎物模型，这是等离子体物理中湍流-流相互作用的标准简化表示，例如漂移波湍流和测地声模 (GAMs) 的耦合。任务涉及非线性动力学的标准技术（稳态分析、线性化、稳定性分析和分岔理论）。所有参数和变量都已明确定义，且前提是自洽和一致的。因此，该问题是有效的。\n\n方程组由下式给出：\n$$ \\frac{dI}{dt} = \\left(\\gamma_{L} - cA - bI\\right) I $$\n$$ \\frac{dA}{dt} = B $$\n$$ \\frac{dB}{dt} = -\\omega_{g}^{2}A - \\gamma_{g}B + sI $$\n所有参数 $b, c, \\gamma_L, \\omega_g, \\gamma_g, s$ 均为正。\n\n首先，我们寻找 $I^{\\ast} > 0$ 的非平凡稳态 $(I^{\\ast}, A^{\\ast}, B^{\\ast})$。我们将所有时间导数设为零：\n$1.$ $\\frac{dI}{dt} = (\\gamma_{L} - cA^{\\ast} - bI^{\\ast}) I^{\\ast} = 0$\n$2.$ $\\frac{dA}{dt} = B^{\\ast} = 0$\n$3.$ $\\frac{dB}{dt} = -\\omega_{g}^{2}A^{\\ast} - \\gamma_{g}B^{\\ast} + sI^{\\ast} = 0$\n\n从方程 $(2)$，我们立即得到 $B^{\\ast} = 0$。\n将 $B^{\\ast} = 0$ 代入方程 $(3)$ 得到：\n$$ -\\omega_{g}^{2}A^{\\ast} + sI^{\\ast} = 0 \\implies \\omega_{g}^{2}A^{\\ast} = sI^{\\ast} $$\n对于 $I^{\\ast} > 0$ 的非平凡解，方程 $(1)$ 要求括号内的项为零：\n$$ \\gamma_{L} - cA^{\\ast} - bI^{\\ast} = 0 \\implies cA^{\\ast} + bI^{\\ast} = \\gamma_{L} $$\n我们现在有一个关于 $A^{\\ast}$ 和 $I^{\\ast}$ 的二元线性方程组：\n$$ A^{\\ast} = \\frac{s}{\\omega_{g}^{2}}I^{\\ast} $$\n$$ cA^{\\ast} + bI^{\\ast} = \\gamma_{L} $$\n将第一个方程代入第二个方程得出：\n$$ c\\left(\\frac{s}{\\omega_{g}^{2}}I^{\\ast}\\right) + bI^{\\ast} = \\gamma_{L} $$\n$$ I^{\\ast}\\left(\\frac{cs}{\\omega_{g}^{2}} + b\\right) = \\gamma_{L} \\implies I^{\\ast}\\left(\\frac{cs + b\\omega_{g}^{2}}{\\omega_{g}^{2}}\\right) = \\gamma_{L} $$\n求解 $I^{\\ast}$：\n$$ I^{\\ast} = \\frac{\\gamma_{L}\\omega_{g}^{2}}{cs + b\\omega_{g}^{2}} $$\n由于所有参数均为正，因此保证 $I^{\\ast} > 0$。现在我们求解 $A^{\\ast}$：\n$$ A^{\\ast} = \\frac{s}{\\omega_{g}^{2}}I^{\\ast} = \\frac{s}{\\omega_{g}^{2}}\\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{cs + b\\omega_{g}^{2}}\\right) = \\frac{s\\gamma_{L}}{cs + b\\omega_{g}^{2}} $$\n非平凡稳态为 $(I^{\\ast}, A^{\\ast}, B^{\\ast}) = \\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{cs + b\\omega_{g}^{2}}, \\frac{s\\gamma_{L}}{cs + b\\omega_{g}^{2}}, 0\\right)$。\n\n接下来，我们在此稳态附近对系统进行线性化。我们构建雅可比矩阵 $J$：\n$J = \\begin{pmatrix} \\frac{\\partial}{\\partial I}(\\frac{dI}{dt})  \\frac{\\partial}{\\partial A}(\\frac{dI}{dt})  \\frac{\\partial}{\\partial B}(\\frac{dI}{dt}) \\\\ \\frac{\\partial}{\\partial I}(\\frac{dA}{dt})  \\frac{\\partial}{\\partial A}(\\frac{dA}{dt})  \\frac{\\partial}{\\partial B}(\\frac{dA}{dt}) \\\\ \\frac{\\partial}{\\partial I}(\\frac{dB}{dt})  \\frac{\\partial}{\\partial A}(\\frac{dB}{dt})  \\frac{\\partial}{\\partial B}(\\frac{dB}{dt}) \\end{pmatrix} = \\begin{pmatrix} \\gamma_{L} - cA - 2bI  -cI  0 \\\\ 0  0  1 \\\\ s  -\\omega_{g}^{2}  -\\gamma_{g} \\end{pmatrix}$\n我们在稳态 $(I^{\\ast}, A^{\\ast}, B^{\\ast})$ 处计算雅可比矩阵。利用稳态条件 $\\gamma_{L} - cA^{\\ast} - bI^{\\ast} = 0$，元素 $J_{11}$ 可以简化为：\n$J_{11} = (\\gamma_{L} - cA^{\\ast} - bI^{\\ast}) - bI^{\\ast} = 0 - bI^{\\ast} = -bI^{\\ast}$。\n稳态下的雅可比矩阵 $J^{\\ast}$ 为：\n$$ J^{\\ast} = \\begin{pmatrix} -bI^{\\ast}  -cI^{\\ast}  0 \\\\ 0  0  1 \\\\ s  -\\omega_{g}^{2}  -\\gamma_{g} \\end{pmatrix} $$\n特征方程为 $\\det(J^{\\ast} - \\lambda I_{3}) = 0$，其中 $I_{3}$ 是 $3 \\times 3$ 单位矩阵。\n$$ \\det \\begin{pmatrix} -bI^{\\ast}-\\lambda  -cI^{\\ast}  0 \\\\ 0  -\\lambda  1 \\\\ s  -\\omega_{g}^{2}  -\\gamma_{g}-\\lambda \\end{pmatrix} = 0 $$\n沿第一列展开行列式：\n$$ (-bI^{\\ast}-\\lambda)\\left((-\\lambda)(-\\gamma_{g}-\\lambda) - (1)(-\\omega_{g}^{2})\\right) - 0 + s\\left((-cI^{\\ast})(1) - (0)(-\\lambda)\\right) = 0 $$\n$$ (-bI^{\\ast}-\\lambda)(\\lambda^{2} + \\gamma_{g}\\lambda + \\omega_{g}^{2}) - scI^{\\ast} = 0 $$\n$$ -\\lambda^{3} - \\gamma_{g}\\lambda^{2} - \\omega_{g}^{2}\\lambda - bI^{\\ast}\\lambda^{2} - bI^{\\ast}\\gamma_{g}\\lambda - bI^{\\ast}\\omega_{g}^{2} - scI^{\\ast} = 0 $$\n乘以 $-1$ 并按 $\\lambda$ 的幂次对各项进行分组：\n$$ \\lambda^{3} + (bI^{\\ast} + \\gamma_{g})\\lambda^{2} + (bI^{\\ast}\\gamma_{g} + \\omega_{g}^{2})\\lambda + (bI^{\\ast}\\omega_{g}^{2} + scI^{\\ast}) = 0 $$\n这是标准形式 $\\lambda^{3} + a_{1}\\lambda^{2} + a_{2}\\lambda + a_{3} = 0$ 的特征多项式，其系数为：\n$a_{1} = bI^{\\ast} + \\gamma_{g}$\n$a_{2} = bI^{\\ast}\\gamma_{g} + \\omega_{g}^{2}$\n$a_{3} = I^{\\ast}(b\\omega_{g}^{2} + sc)$\n\n对于稳态的稳定性，三次多项式的劳斯-赫尔维茨判据要求 $a_{1} > 0$，$a_{3} > 0$ 且 $a_{1}a_{2} > a_{3}$。当一对共轭复特征值穿过虚轴时，发生霍普夫分岔。这对应于第三个判据变为等式的阈值：$a_{1}a_{2} = a_{3}$。\n由于所有参数和 $I^{\\ast}$ 均为正，所以 $a_{1} > 0$ 和 $a_{3} > 0$ 总是满足的。因此，霍普夫分岔条件为：\n$$ (bI^{\\ast} + \\gamma_{g})(bI^{\\ast}\\gamma_{g} + \\omega_{g}^{2}) = I^{\\ast}(b\\omega_{g}^{2} + sc) $$\n我们正在寻找使该条件成立的临界值 $s_H$。令 $I_H^{\\ast}$ 为 $s=s_H$ 时 $I^{\\ast}$ 的值。\n$$ (bI_H^{\\ast} + \\gamma_{g})(bI_H^{\\ast}\\gamma_{g} + \\omega_{g}^{2}) = I_H^{\\ast}(b\\omega_{g}^{2} + s_H c) $$\n展开左侧：\n$ b^2(I_H^{\\ast})^2\\gamma_{g} + bI_H^{\\ast}\\omega_{g}^{2} + bI_H^{\\ast}\\gamma_{g}^{2} + \\gamma_{g}\\omega_{g}^{2} = bI_H^{\\ast}\\omega_{g}^{2} + I_H^{\\ast}cs_H $\n项 $bI_H^{\\ast}\\omega_{g}^{2}$ 被消去。重新整理得到：\n$ b^2(I_H^{\\ast})^2\\gamma_{g} + bI_H^{\\ast}\\gamma_{g}^{2} + \\gamma_{g}\\omega_{g}^{2} = I_H^{\\ast}cs_H $\n我们使用表达式 $I_H^{\\ast} = \\frac{\\gamma_{L}\\omega_{g}^{2}}{cs_H + b\\omega_{g}^{2}}$。令 $K = cs_H + b\\omega_{g}^{2}$，因此 $I_H^{\\ast} = \\frac{\\gamma_{L}\\omega_{g}^{2}}{K}$。将此代入前一个方程，得到一个关于 $K$ 的二次方程：\n$ b^2\\gamma_{g}\\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{K}\\right)^2 + b\\gamma_{g}^{2}\\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{K}\\right) + \\gamma_{g}\\omega_{g}^{2} = \\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{K}\\right) \\frac{K-b\\omega_g^2}{I_H^\\ast} = \\frac{cs_H}{I_H^\\ast} ...$ 这变得复杂了。\n让我们回到：$b^2(I_H^{\\ast})^2\\gamma_{g} + bI_H^{\\ast}\\gamma_{g}^{2} + \\gamma_{g}\\omega_{g}^{2} = I_H^{\\ast}cs_H$。\n且 $cs_H = \\frac{\\gamma_{L}\\omega_{g}^{2}}{I_H^{\\ast}} - b\\omega_{g}^{2}$。\n将 $cs_H$ 代入方程：\n$ b^2(I_H^{\\ast})^2\\gamma_{g} + bI_H^{\\ast}\\gamma_{g}^{2} + \\gamma_{g}\\omega_{g}^{2} = I_H^{\\ast}\\left(\\frac{\\gamma_{L}\\omega_{g}^{2}}{I_H^{\\ast}} - b\\omega_{g}^{2}\\right) = \\gamma_{L}\\omega_{g}^{2} - bI_H^{\\ast}\\omega_{g}^{2} $\n这给出了一个关于 $I_H^{\\ast}$ 的二次方程：\n$ b^2\\gamma_{g}(I_H^{\\ast})^2 + (b\\gamma_{g}^{2} + b\\omega_{g}^{2})I_H^{\\ast} + (\\gamma_{g}\\omega_{g}^{2} - \\gamma_{L}\\omega_{g}^{2}) = 0 $\n$ b^2\\gamma_{g}(I_H^{\\ast})^2 + b(\\gamma_{g}^{2} + \\omega_{g}^{2})I_H^{\\ast} + \\omega_{g}^{2}(\\gamma_{g} - \\gamma_{L}) = 0 $\n我们定义 $K=cs_H+b\\omega_g^2$。将 $I_H^{\\ast} = \\gamma_L\\omega_g^2/K$ 代入此方程：\n$ b^2\\gamma_g(\\frac{\\gamma_L\\omega_g^2}{K})^2 + b(\\gamma_g^2+\\omega_g^2)(\\frac{\\gamma_L\\omega_g^2}{K}) + \\omega_g^2(\\gamma_g-\\gamma_L) = 0$\n乘以 $K^2/(\\omega_g^2)$：\n$ b^2\\gamma_g\\gamma_L^2\\omega_g^2 + b\\gamma_L(\\gamma_g^2+\\omega_g^2)K + (\\gamma_g-\\gamma_L)K^2=0 $\n重新整理成关于 $K$ 的标准二次方程形式：\n$ (\\gamma_L-\\gamma_g)K^2 - b\\gamma_L(\\gamma_g^2+\\omega_g^2)K - b^2\\gamma_g\\gamma_L^2\\omega_g^2=0 $\n求解正的 $K$：\n$ K = \\frac{b\\gamma_L(\\gamma_g^2+\\omega_g^2) + \\sqrt{b^2\\gamma_L^2(\\gamma_g^2+\\omega_g^2)^2 + 4(\\gamma_L-\\gamma_g)b^2\\gamma_g\\gamma_L^2\\omega_g^2}}{2(\\gamma_L-\\gamma_g)} $\n负根被舍弃，因为 $K$ 必须是正的。我们化简平方根下的项：\n$\\sqrt{\\cdots} = b\\gamma_L \\sqrt{(\\gamma_g^2+\\omega_g^2)^2 + 4\\gamma_g\\omega_g^2(\\gamma_L-\\gamma_g)} = b\\gamma_L \\sqrt{(\\gamma_g^2-\\omega_g^2)^2 + 4\\gamma_g\\gamma_L\\omega_g^2}$\n所以，\n$ K = \\frac{b\\gamma_L \\left( \\gamma_g^2+\\omega_g^2 + \\sqrt{(\\gamma_g^2-\\omega_g^2)^2 + 4\\gamma_g\\gamma_L\\omega_g^2} \\right)}{2(\\gamma_L-\\gamma_g)} $\n最后，我们用 $K = cs_H + b\\omega_g^2$ 来求解 $s_H$：\n$ s_H = \\frac{K - b\\omega_g^2}{c} $\n$ s_H = \\frac{b\\gamma_L \\left( \\gamma_g^2+\\omega_g^2 + \\sqrt{(\\gamma_g^2-\\omega_g^2)^2 + 4\\gamma_g\\gamma_L\\omega_g^2} \\right)}{2c(\\gamma_L-\\gamma_g)} - \\frac{b\\omega_g^2}{c} $\n将所有项通分到共同分母 $2c(\\gamma_L-\\gamma_g)$ 上：\n$ s_H = \\frac{b\\gamma_L ( \\gamma_g^2+\\omega_g^2 + \\sqrt{\\dots}) - 2cb\\omega_g^2(\\gamma_L-\\gamma_g)/c}{2c(\\gamma_L-\\gamma_g)} $\n$ s_H = \\frac{b}{2c(\\gamma_L-\\gamma_g)} \\left[ \\gamma_L(\\gamma_g^2+\\omega_g^2) + \\gamma_L\\sqrt{\\dots} - 2\\omega_g^2(\\gamma_L-\\gamma_g) \\right] $\n$ s_H = \\frac{b}{2c(\\gamma_L-\\gamma_g)} \\left[ \\gamma_L\\gamma_g^2+\\gamma_L\\omega_g^2 - 2\\gamma_L\\omega_g^2 + 2\\gamma_g\\omega_g^2 + \\gamma_L\\sqrt{\\dots} \\right] $\n$ s_H = \\frac{b}{2c(\\gamma_L-\\gamma_g)} \\left[ \\gamma_L(\\gamma_g^2 - \\omega_g^2) + 2\\gamma_g\\omega_g^2 + \\gamma_L\\sqrt{(\\gamma_g^2 - \\omega_g^2)^2 + 4\\gamma_g\\gamma_L\\omega_g^2} \\right] $\n这就是霍普夫分岔阈值 $s_H$ 的最终闭合形式表达式。",
            "answer": "$$\n\\boxed{\\frac{b}{2c(\\gamma_{L} - \\gamma_{g})} \\left[ \\gamma_{L}(\\gamma_{g}^{2} - \\omega_{g}^{2}) + 2\\gamma_{g}\\omega_{g}^{2} + \\gamma_{L}\\sqrt{(\\gamma_{g}^{2} - \\omega_{g}^{2})^{2} + 4\\gamma_{g}\\gamma_{L}\\omega_{g}^{2}} \\right]}\n$$"
        },
        {
            "introduction": "最后，我们探讨一个带状流扰动在环形等离子体中的长期演化归宿。一个初始的轴对称电势扰动并不会完全衰减，也不会完全保持不变，而是会分裂为一个振荡的 GAM 部分和一个稳态的剩余带状流部分。本练习旨在通过动理学理论中的一个经典问题，即 Rosenbluth-Hinton 剩余流的计算，来阐明这种能量分配机制。通过这个练习，你将理解新经典极化屏蔽效应如何决定剩余流的水平，并定量计算出初始能量在振荡模态和稳态流之间的分配比例，这是理解环形约束等离子体中带状流物理的一个基石 。",
            "id": "3984894",
            "problem": "考虑一个具有圆形同心磁通面的大环径比托卡马克等离子体。逆环径比为 $\\epsilon$，安全因子为 $q$，平衡磁场强度为 $B$。在 $t=0^{+}$ 时，施加一个具有单一径向波数 $k_r$ 的轴对称带状电势扰动，产生一个磁通面平均的静电势 $\\phi(r,t)$，其初始条件为 $\\phi(r,0^{+})=\\phi_0 \\cos(k_r r)$ 且没有初始平行运动。假设无碰撞离子由漂移动理学理论描述，电子为绝热电子，并处于长波极限 $k_r \\rho_i \\ll 1$，其中 $\\rho_i$ 是离子拉莫尔半径。带状流通过测地曲率和离子可压缩性与测地声学模 (GAM) 耦合。\n\n使用动理学理论，推导在无碰撞极限下，初始带状电势扰动如何分配到一个非振荡的剩余带状流分量和一个振荡的测地声学模 (GAM) 分量中。采用以下建模选择：\n\n- 要分配的能量范数是带状流 $\\mathbf{E}\\times\\mathbf{B}$ 动能密度，定义为 $W_E = \\frac{n_i m_i}{2} |\\mathbf{u}_E|^2$，其中 $\\mathbf{u}_E = \\frac{c}{B}\\,\\hat{\\mathbf{b}}\\times\\nabla \\phi$，$\\hat{\\mathbf{b}}$ 是沿磁场的单位矢量，$n_i$ 是离子密度，$m_i$ 是离子质量。对于单一 $k_r$ 的带状扰动，$W_E \\propto k_r^2 \\phi^2$。\n- 在大环径比、圆形磁面的极限下，与捕获离子动力学相关的新经典极化惯性会增强静态带状流响应，其增强量由无量纲参数 $\\Lambda(q,\\epsilon)$ 表征。对于绝热电子和 $k_r \\rho_i \\ll 1$ 的情况，该参数正比于 $q^2/\\sqrt{\\epsilon}$。具体来说，对于圆形同心磁通面，取 $\\Lambda(q,\\epsilon) = \\alpha\\,\\frac{q^2}{\\sqrt{\\epsilon}}$，其中 $\\alpha=1.6$。\n\n从第一性原理出发，确定剩余带状流电势振幅 $\\phi_{\\infty}$（用 $\\phi_0$ 和 $\\Lambda$ 表示），然后使用指定的能量范数计算保留在剩余带状流中的初始 $\\mathbf{E}\\times\\mathbf{B}$ 动能的份额（记为 $f_{\\mathrm{res}}$），以及进入振荡 GAM 分量的互补份额（记为 $f_{\\mathrm{GAM}}$）。对于 $q=1.5$ 和 $\\epsilon=0.16$，对这些份额进行数值计算。\n\n将您的数值答案四舍五入到四位有效数字。将最终的能量份额表示为不带百分号的小数。最终答案应按顺序报告 $(f_{\\mathrm{res}}, f_{\\mathrm{GAM}})$ 这两个数字。",
            "solution": "用户提供的问题已经过验证，被确定为计算聚变科学与工程领域中一个有科学依据、定义明确且客观的问题。\n\n该问题要求计算初始带状电势扰动的能量如何分配到长时间的剩余带状流和振荡的测地声学模 (GAM) 中。问题的核心在于托卡马克等离子体中新经典极化屏蔽的概念。\n\n首先，我们讨论磁通面平均静电势 $\\phi(t)$ 的演化。在等离子体上施加一个初始电势扰动 $\\phi(r, 0^+) = \\phi_0 \\cos(k_r r)$。在环形几何中，对该扰动的响应由经典和新经典极化效应共同决定。在长时间极限 ($t \\rightarrow \\infty$) 下，当振荡的 GAM 分量通过无碰撞相混合衰减后，会留下一个稳态的剩余带状流电势 $\\phi_{\\infty}$。\n\n初始电势 $\\phi_0$ 和剩余电势 $\\phi_{\\infty}$ 之间的关系是动理学理论的一个经典结果（由 Rosenbluth 和 Hinton 推广）。它源于建立电势的初始电荷的守恒。最初，在 $t=0^+$ 时，等离子体还没有时间表现出由环形几何引起（新经典）的效应。系统的响应由高频或经典介电电容决定，这与经典离子极化漂移有关。我们将这个快速时间尺度上的有效介电常数表示为 $\\epsilon_{cl}$。初始的“未屏蔽”电荷密度扰动 $\\rho_0$ 正比于 $\\epsilon_{cl}\\nabla^2\\phi_0$。\n\n随着时间的推移，系统演化到一个新的稳态。在这个最终状态下，相同的初始电荷密度 $\\rho_0$ 现在被等离子体的完整静态介电响应 $\\epsilon_{st}$ 屏蔽。这个静态响应包括经典极化和由环形磁场中捕获离子的动力学引起的额外新经典极化。问题用因子 $\\Lambda$ 来参数化这种新经典增强。因此，静态介电常数被增强了一个因子 $(1+\\Lambda)$，所以 $\\epsilon_{st} = (1+\\Lambda)\\epsilon_{cl}$。最终电势 $\\phi_{\\infty}$ 通过 $\\rho_0 \\propto \\epsilon_{st}\\nabla^2\\phi_{\\infty}$ 与电荷 $\\rho_0$ 相关。\n\n根据极化电荷守恒，我们有：\n$$ \\epsilon_{cl}\\nabla^2\\phi_0 = \\epsilon_{st}\\nabla^2\\phi_{\\infty} = (1+\\Lambda)\\epsilon_{cl}\\nabla^2\\phi_{\\infty} $$\n对于单一径向模式，这简化为：\n$$ \\phi_0 = (1+\\Lambda)\\phi_{\\infty} $$\n由此，我们推导出剩余带状流电势的振幅：\n$$ \\phi_{\\infty} = \\frac{1}{1+\\Lambda}\\phi_0 $$\n\n接下来，我们计算能量的分配。问题指定能量范数为 $\\mathbf{E}\\times\\mathbf{B}$ 动能密度 $W_E$。对于单一 $k_r$ 扰动，该能量正比于电势振幅的平方：$W_E \\propto \\phi^2$。设比例常数为 $C$。\n\n在 $t=0^+$ 时的初始能量与电势 $\\phi_0$ 相关：\n$$ W_{E,0} = C \\phi_0^2 $$\n问题陈述没有初始平行运动，因此这代表了系统在 $t=0^+$ 时的总能量。\n\n在 $t \\rightarrow \\infty$ 极限下，保留在剩余带状流中的能量与电势 $\\phi_{\\infty}$ 相关：\n$$ W_{E,\\mathrm{res}} = C \\phi_{\\infty}^2 = C \\left(\\frac{1}{1+\\Lambda}\\phi_0\\right)^2 = \\frac{1}{(1+\\Lambda)^2} C \\phi_0^2 $$\n\n保留在剩余带状流中的初始能量份额 $f_{\\mathrm{res}}$ 是剩余能量与初始能量之比：\n$$ f_{\\mathrm{res}} = \\frac{W_{E,\\mathrm{res}}}{W_{E,0}} = \\frac{\\frac{1}{(1+\\Lambda)^2} C \\phi_0^2}{C \\phi_0^2} = \\frac{1}{(1+\\Lambda)^2} $$\n\n系统的总能量是守恒的。初始能量 $W_{E,0}$ 分配到最终的稳态剩余流能量 $W_{E,\\mathrm{res}}$ 和转移到振荡 GAM 分量的能量 $W_{E,\\mathrm{GAM}}$ 之间。因此，GAM 中的能量是初始能量与剩余能量之差。\n$$ W_{E,\\mathrm{GAM}} = W_{E,0} - W_{E,\\mathrm{res}} $$\n进入 GAM 的初始能量份额 $f_{\\mathrm{GAM}}$ 是：\n$$ f_{\\mathrm{GAM}} = \\frac{W_{E,\\mathrm{GAM}}}{W_{E,0}} = \\frac{W_{E,0} - W_{E,\\mathrm{res}}}{W_{E,0}} = 1 - \\frac{W_{E,\\mathrm{res}}}{W_{E,0}} = 1 - f_{\\mathrm{res}} $$\n代入 $f_{\\mathrm{res}}$ 的表达式：\n$$ f_{\\mathrm{GAM}} = 1 - \\frac{1}{(1+\\Lambda)^2} $$\n\n现在，我们根据给定的参数 $q=1.5$，$\\epsilon=0.16$ 和 $\\alpha=1.6$ 计算这些份额。\n首先，我们计算无量纲新经典极化参数 $\\Lambda$：\n$$ \\Lambda = \\alpha \\frac{q^2}{\\sqrt{\\epsilon}} = 1.6 \\times \\frac{(1.5)^2}{\\sqrt{0.16}} = 1.6 \\times \\frac{2.25}{0.4} $$\n$$ \\Lambda = 4 \\times 2.25 = 9 $$\n$\\Lambda$ 的值恰好是 $9$。\n\n现在我们可以计算能量份额：\n$$ f_{\\mathrm{res}} = \\frac{1}{(1+\\Lambda)^2} = \\frac{1}{(1+9)^2} = \\frac{1}{10^2} = \\frac{1}{100} = 0.01 $$\n$$ f_{\\mathrm{GAM}} = 1 - f_{\\mathrm{res}} = 1 - 0.01 = 0.99 $$\n\n问题要求将数值答案四舍五入到四位有效数字。\n$$ f_{\\mathrm{res}} = 0.01000 $$\n$$ f_{\\mathrm{GAM}} = 0.9900 $$\n\n最终答案是序对 $(f_{\\mathrm{res}}, f_{\\mathrm{GAM}})$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.01000  0.9900 \\end{pmatrix}}$$"
        }
    ]
}