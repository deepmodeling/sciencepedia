{
    "hands_on_practices": [
        {
            "introduction": "输运分析中的一项基本技能是能够根据标准的等离子体剖面测量数据计算 $E \\times B$ 剪切率。本练习将指导您完成将径向力平衡方程应用于真实（尽管经过简化）的台基剖面的过程。通过计算 $\\gamma_E$ 并将其与湍流阈值模型进行比较，您将获得评估建立输运垒所需条件的实践经验。",
            "id": "3969600",
            "problem": "一个大环径比的轴对称托卡马克具有占主导地位的环向磁场，其台基区从小半径 $r_{\\mathrm{ped,min}} = 0.45~\\mathrm{m}$ 延伸到 $r_{\\mathrm{ped,max}} = 0.50~\\mathrm{m}$。假设由于径向电场，电场叉乘磁场（$E \\times B$）流主要是极向的。极向$E \\times B$流速为 $v_{\\theta}(r) \\approx E_r(r)/B_{\\phi}$，其中 $B_{\\phi}$ 是环向磁场。将$E \\times B$剪切率定义为以下大小\n$$\\gamma_E(r) \\equiv \\left| r \\frac{d}{dr}\\left(\\frac{v_{\\theta}(r)}{r}\\right) \\right|.$$\n假设径向电场 $E_r(r)$ 由稳态离子径向力平衡给出，其中忽略了极向旋转和粘性，\n$$E_r(r) = \\frac{1}{n_i(r) e} \\frac{d p_i(r)}{dr} + V_{\\phi}(r) B_{\\theta}(r),$$\n其中离子压强为 $p_i(r) = n_i(r) k_B T_i(r)$。为方便起见，离子温度以电子伏特（eV）为单位指定，因此 $p_i(r) = n_i(r) e T_i(r)$，并且\n$$\\frac{1}{n_i e}\\frac{d p_i}{dr} = \\frac{d T_i}{dr} + \\frac{T_i}{n_i}\\frac{dn_i}{dr},$$\n当 $T_i$ 以 $\\mathrm{eV}$ 表示时，其数值单位为 $\\mathrm{V/m}$。极向场通过 $q(r) = r B_{\\phi}/(R B_{\\theta}(r))$ 与安全因子 $q(r)$ 相关，因此 $B_{\\theta}(r) = r B_{\\phi}/(q(r) R)$。\n\n当$E \\times B$剪切退相关率超过一个代表性的局域线性增长率时，预计会发生湍流输运的抑制。将该阈值建模为\n$$\\gamma_{\\mathrm{thr}}(r) = k_y \\frac{c_s(r)}{L_{T_i}(r)},$$\n其中 $k_y$ 是一个固定的副法向波数，$c_s(r) = \\sqrt{\\frac{e T_e(r)}{m_i}}$ 是离子声速，$T_e(r)$ 是电子温度（取 $T_e(r) = T_i(r)$），$m_i$ 是离子质量，$L_{T_i}(r) = \\frac{T_i(r)}{|dT_i/dr|}$ 是离子温度标长。\n\n使用以下台基剖面和常数：\n- 小半径坐标 $r \\in [0.45, 0.50]~\\mathrm{m}$。\n- 环向磁场 $B_{\\phi} = 2.5~\\mathrm{T}$，大半径 $R = 1.7~\\mathrm{m}$。\n- 离子质量 $m_i = 3.344 \\times 10^{-27}~\\mathrm{kg}$ (氘)，基本电荷 $e = 1.602 \\times 10^{-19}~\\mathrm{C}$。\n- 安全因子 $q(r) = q_0 + \\alpha_q (r - r_0)$，其中 $q_0 = 3.8$，$\\alpha_q = 4.0~\\mathrm{m}^{-1}$，$r_0 = 0.45~\\mathrm{m}$。\n- 离子密度 $n_i(r) = n_0 - \\alpha_n (r - r_0)$，其中 $n_0 = 6.0 \\times 10^{19}~\\mathrm{m}^{-3}$，$\\alpha_n = 2.0 \\times 10^{20}~\\mathrm{m}^{-4}$。\n- 离子温度 $T_i(r) = T_0 - \\alpha_T (r - r_0)$，其中 $T_0 = 1500~\\mathrm{eV}$，$\\alpha_T = 14000~\\mathrm{eV/m}$。\n- 环向旋转 $V_{\\phi}(r) = V_0 - \\alpha_V (r - r_0)$，其中 $V_0 = 1.20 \\times 10^{5}~\\mathrm{m/s}$，$\\alpha_V = 1.00 \\times 10^{6}~\\mathrm{s}^{-1}$。\n- 副法向波数 $k_y = 0.05~\\mathrm{m}^{-1}$。\n\n任务：\n1. 从上述定义出发，根据给定的剖面推导出 $\\gamma_E(r)$ 的显式表达式，并根据模型构建 $\\gamma_{\\mathrm{thr}}(r)$。\n2. 计算整个台基区的无量纲抑制比 $S(r) \\equiv \\gamma_E(r)/\\gamma_{\\mathrm{thr}}(r)$，并确定其在 $r \\in [0.45, 0.50]~\\mathrm{m}$ 上的最大值。\n\n将最终答案表示为单一的最大值 $\\max_{r \\in [0.45,0.50]} S(r)$，四舍五入到四位有效数字。由于这是一个比率，它是无量纲的，报告时无需单位。",
            "solution": "用户提供了一个计算聚变科学领域的问题，需要进行验证和求解。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   **定义域：** 轴对称托卡马克台基区，从 $r_{\\mathrm{ped,min}} = 0.45~\\mathrm{m}$ 到 $r_{\\mathrm{ped,max}} = 0.50~\\mathrm{m}$。\n-   **$E \\times B$流速：** $v_{\\theta}(r) \\approx E_r(r)/B_{\\phi}$。\n-   **$E \\times B$剪切率：** $\\gamma_E(r) \\equiv \\left| r \\frac{d}{dr}\\left(\\frac{v_{\\theta}(r)}{r}\\right) \\right|$。\n-   **径向电场：** $E_r(r) = \\frac{1}{n_i(r) e} \\frac{d p_i(r)}{dr} + V_{\\phi}(r) B_{\\theta}(r)$。\n-   **离子压强项：** $\\frac{1}{n_i e}\\frac{d p_i}{dr} = \\frac{d T_i}{dr} + \\frac{T_i}{n_i}\\frac{dn_i}{dr}$，其中 $T_i$ 以电子伏特（$\\mathrm{eV}$）为单位，结果以 $\\mathrm{V/m}$ 为单位。\n-   **极向磁场：** $B_{\\theta}(r) = r B_{\\phi}/(q(r) R)$。\n-   **湍流阈值：** $\\gamma_{\\mathrm{thr}}(r) = k_y \\frac{c_s(r)}{L_{T_i}(r)}$。\n-   **离子声速：** $c_s(r) = \\sqrt{\\frac{e T_e(r)}{m_i}}$ 且 $T_e(r) = T_i(r)$。因此 $c_s(r) = \\sqrt{e T_i(r) / m_i}$，其中 $T_i$ 以 $\\mathrm{eV}$ 表示，而 $e$ 是以库仑为单位的基本电荷。\n-   **离子温度标长：** $L_{T_i}(r) = \\frac{T_i(r)}{|dT_i/dr|}$。\n-   **常数：**\n    -   $B_{\\phi} = 2.5~\\mathrm{T}$\n    -   $R = 1.7~\\mathrm{m}$\n    -   $m_i = 3.344 \\times 10^{-27}~\\mathrm{kg}$\n    -   $e = 1.602 \\times 10^{-19}~\\mathrm{C}$\n    -   $k_y = 0.05~\\mathrm{m}^{-1}$\n-   **剖面 ($r_0 = 0.45~\\mathrm{m}$):**\n    -   $q(r) = q_0 + \\alpha_q (r - r_0)$，其中 $q_0 = 3.8$，$\\alpha_q = 4.0~\\mathrm{m}^{-1}$。\n    -   $n_i(r) = n_0 - \\alpha_n (r - r_0)$，其中 $n_0 = 6.0 \\times 10^{19}~\\mathrm{m}^{-3}$，$\\alpha_n = 2.0 \\times 10^{20}~\\mathrm{m}^{-4}$。\n    -   $T_i(r) = T_0 - \\alpha_T (r - r_0)$，其中 $T_0 = 1500~\\mathrm{eV}$，$\\alpha_T = 14000~\\mathrm{eV/m}$。\n    -   $V_{\\phi}(r) = V_0 - \\alpha_V (r - r_0)$，其中 $V_0 = 1.20 \\times 10^{5}~\\mathrm{m/s}$，$\\alpha_V = 1.00 \\times 10^{6}~\\mathrm{s}^{-1}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于托卡马克的标准等离子体输运理论。所提供的方程——用于 $E_r$ 的径向力平衡、$E \\times B$剪切率的定义，以及作为阈值的离子温度梯度（ITG）湍流增长率代理——都是标准模型。指定的剖面是线性的，这是台基建模中常见的简化方法。参数值对于中型托卡马克而言在物理上是现实的。问题是适定的，提供了所有必要信息，并要求计算一个特定的、可计算的量（区间上一个比率的最大值）。没有内部矛盾；单位和变量定义（例如，以 $\\mathrm{eV}$ 为单位的 $T_i$）都得到了明确处理。该问题是客观、有意义且可验证的。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将提供完整解答。\n\n### 解答\n\n任务是推导E×B剪切率 $\\gamma_E(r)$ 和湍流阈值率 $\\gamma_{\\mathrm{thr}}(r)$ 的表达式，然后计算它们的比率 $S(r) = \\gamma_E(r)/\\gamma_{\\mathrm{thr}}(r)$ 在径向域 $r \\in [0.45, 0.50]~\\mathrm{m}$ 上的最大值。\n\n**1. 阈值率 $\\gamma_{\\mathrm{thr}}(r)$ 的推导**\n\n阈值率由 $\\gamma_{\\mathrm{thr}}(r) = k_y \\frac{c_s(r)}{L_{T_i}(r)}$ 给出。\n离子温度剖面为 $T_i(r) = T_0 - \\alpha_T(r-r_0)$，因此其导数为 $\\frac{dT_i}{dr} = -\\alpha_T$。\n温度标长为 $L_{T_i}(r) = \\frac{T_i(r)}{|dT_i/dr|} = \\frac{T_i(r)}{\\alpha_T}$。\n离子声速为 $c_s(r) = \\sqrt{e T_i(r)/m_i}$，其中使用以 $\\mathrm{eV}$ 为单位的 $T_i(r)$ 数值和以库仑为单位的基本电荷 $e$ 来得到以焦耳为单位的能量。\n将这些代入 $\\gamma_{\\mathrm{thr}}(r)$ 的表达式中：\n$$ \\gamma_{\\mathrm{thr}}(r) = k_y \\frac{\\sqrt{e T_i(r)/m_i}}{T_i(r)/\\alpha_T} = \\frac{k_y \\alpha_T}{\\sqrt{T_i(r)}} \\sqrt{\\frac{e}{m_i}} $$\n由于 $T_i(r)$ 是 $r$ 的减函数，$\\gamma_{\\mathrm{thr}}(r)$ 是 $r$ 的单调增函数。\n\n**2. E×B剪切率 $\\gamma_E(r)$ 的推导**\n\n$E \\times B$剪切率定义为 $\\gamma_E(r) = \\left| r \\frac{d}{dr}\\left(\\frac{v_{\\theta}(r)}{r}\\right) \\right|$。\n使用 $v_{\\theta}(r) \\approx E_r(r)/B_{\\phi}$ 并假设 $B_{\\phi}$ 是常数：\n$$ \\gamma_E(r) = \\left| r \\frac{d}{dr}\\left(\\frac{E_r(r)}{r B_{\\phi}}\\right) \\right| = \\left| \\frac{r}{B_{\\phi}} \\left( \\frac{1}{r}\\frac{dE_r}{dr} - \\frac{E_r}{r^2} \\right) \\right| = \\left| \\frac{1}{B_{\\phi}} \\left( \\frac{dE_r}{dr} - \\frac{E_r(r)}{r} \\right) \\right| $$\n为了计算这个，我们需要 $E_r(r)$ 及其导数 $\\frac{dE_r}{dr}$ 的表达式。\n\n径向电场 $E_r(r)$ 由抗磁项和流动项组成：\n$$ E_r(r) = \\underbrace{\\left(\\frac{d T_i}{dr} + \\frac{T_i(r)}{n_i(r)}\\frac{dn_i}{dr}\\right)}_{E_{r,\\mathrm{dia}}(r)} + \\underbrace{V_{\\phi}(r) B_{\\theta}(r)}_{E_{r,V \\times B}(r)} $$\n剖面导数是常数：$\\frac{dn_i}{dr} = -\\alpha_n$，$\\frac{dT_i}{dr} = -\\alpha_T$，$\\frac{dV_{\\phi}}{dr} = -\\alpha_V$，以及 $\\frac{dq}{dr} = \\alpha_q$。\n所以，$E_r(r)$ 的分量是：\n$$ E_{r,\\mathrm{dia}}(r) = -\\alpha_T - \\alpha_n \\frac{T_i(r)}{n_i(r)} $$\n$$ E_{r,V \\times B}(r) = V_{\\phi}(r) \\frac{r B_{\\phi}}{R q(r)} $$\n接下来，我们求这些分量的导数：\n$$ \\frac{dE_{r,\\mathrm{dia}}}{dr} = -\\alpha_n \\frac{d}{dr}\\left(\\frac{T_i}{n_i}\\right) = -\\alpha_n \\frac{\\frac{dT_i}{dr}n_i(r) - T_i(r)\\frac{dn_i}{dr}}{n_i(r)^2} = -\\alpha_n \\frac{-\\alpha_T n_i(r) + \\alpha_n T_i(r)}{n_i(r)^2} $$\n$$ \\frac{dE_{r,V \\times B}}{dr} = \\frac{B_{\\phi}}{R} \\frac{d}{dr}\\left(\\frac{r V_\\phi(r)}{q(r)}\\right) = \\frac{B_{\\phi}}{R} \\left( \\frac{\\left(V_\\phi(r) + r \\frac{dV_{\\phi}}{dr}\\right)q(r) - rV_\\phi(r)\\frac{dq}{dr}}{q(r)^2} \\right) = \\frac{B_{\\phi}}{R} \\left( \\frac{(V_\\phi(r) - \\alpha_V r)q(r) - \\alpha_q r V_\\phi(r)}{q(r)^2} \\right) $$\n总导数是 $\\frac{dE_r}{dr} = \\frac{dE_{r,\\mathrm{dia}}}{dr} + \\frac{dE_{r,V \\times B}}{dr}$。\n\n**3. 抑制比 $S(r)$ 的最大化**\n\n抑制比为 $S(r) = \\gamma_E(r)/\\gamma_{\\mathrm{thr}}(r)$。$S(r)$ 的完整解析表达式很复杂。我们分析其行为以找到最大值。我们已经确定分母 $\\gamma_{\\mathrm{thr}}(r)$ 是 $r$ 的严格增函数。\n通过在区间边界和中点计算 $\\gamma_E(r)$，我们观察到它是 $r$ 的减函数。\n- 在 $r=0.45~\\mathrm{m}$ 处，$\\gamma_E \\approx 4.96 \\times 10^4~\\mathrm{s}^{-1}$。\n- 在 $r=0.475~\\mathrm{m}$ 处，$\\gamma_E \\approx 4.90 \\times 10^4~\\mathrm{s}^{-1}$。\n- 在 $r=0.50~\\mathrm{m}$ 处，$\\gamma_E \\approx 4.77 \\times 10^4~\\mathrm{s}^{-1}$。\n由于 $S(r)$ 是一个单调减函数（$\\gamma_E(r)$）与一个单调增函数（$\\gamma_{\\mathrm{thr}}(r)$）的比值，因此 $S(r)$ 在该区间上必定是一个单调减函数。因此，其最大值出现在 $r$ 的最小值处，即 $r = r_{\\mathrm{ped,min}} = 0.45~\\mathrm{m}$。\n\n**4. $S(0.45)$的计算**\n\n我们在 $r = 0.45~\\mathrm{m}$ 处计算所有量。在这一点，$r - r_0 = 0$，所以各剖面取其初始值：\n- $n_i(0.45) = n_0 = 6.0 \\times 10^{19}~\\mathrm{m}^{-3}$\n- $T_i(0.45) = T_0 = 1500~\\mathrm{eV}$\n- $V_{\\phi}(0.45) = V_0 = 1.20 \\times 10^{5}~\\mathrm{m/s}$\n- $q(0.45) = q_0 = 3.8$\n\n首先，计算 $\\gamma_{\\mathrm{thr}}(0.45)$：\n$$ \\gamma_{\\mathrm{thr}}(0.45) = \\frac{k_y \\alpha_T}{\\sqrt{T_0}} \\sqrt{\\frac{e}{m_i}} = \\frac{(0.05) (14000)}{\\sqrt{1500}} \\sqrt{\\frac{1.602 \\times 10^{-19}}{3.344 \\times 10^{-27}}} $$\n$$ \\gamma_{\\mathrm{thr}}(0.45) = \\frac{700}{38.7298} \\sqrt{4.7907 \\times 10^7} \\approx (18.073)(6921.5) \\approx 125090~\\mathrm{s}^{-1} $$\n接下来，计算 $E_r(0.45)$ 和 $\\frac{dE_r}{dr}(0.45)$：\n$$ E_r(0.45) = \\left(-\\alpha_T - \\alpha_n \\frac{T_0}{n_0}\\right) + V_0 \\frac{(0.45) B_{\\phi}}{R q_0} $$\n$$ E_r(0.45) = \\left(-14000 - (2.0 \\times 10^{20}) \\frac{1500}{6.0 \\times 10^{19}}\\right) + (1.20 \\times 10^5) \\frac{(0.45)(2.5)}{(1.7)(3.8)} $$\n$$ E_r(0.45) = (-14000 - 5000) + (1.20 \\times 10^5)(0.17415) \\approx -19000 + 20898 = 1898~\\mathrm{V/m} $$\n现在是导数：\n$$ \\frac{dE_r}{dr}(0.45) = -\\alpha_n \\frac{-\\alpha_T n_0 + \\alpha_n T_0}{n_0^2} + \\frac{B_{\\phi}}{R} \\left( \\frac{(V_0 - \\alpha_V(0.45))q_0 - \\alpha_q (0.45) V_0}{q_0^2} \\right) $$\n$$ \\frac{dE_{r,\\mathrm{dia}}}{dr}(0.45) = -2.0 \\times 10^{20} \\frac{-(14000)(6.0 \\times 10^{19}) + (2.0 \\times 10^{20})(1500)}{(6.0 \\times 10^{19})^2} = -2.0 \\times 10^{20} \\frac{-8.4 \\times 10^{23} + 3.0 \\times 10^{23}}{36 \\times 10^{38}} = 30000~\\mathrm{V/m^2} $$\n$$ V_0 - \\alpha_V(0.45) = 1.20 \\times 10^5 - (1.00 \\times 10^6)(0.45) = -3.3 \\times 10^5~\\mathrm{m/s} $$\n$$ \\frac{dE_{r,V \\times B}}{dr}(0.45) = \\frac{2.5}{1.7} \\left( \\frac{(-3.3 \\times 10^5)(3.8) - (4.0)(0.45)(1.20 \\times 10^5)}{3.8^2} \\right) $$\n$$ \\frac{dE_{r,V \\times B}}{dr}(0.45) = 1.4706 \\left( \\frac{-1.254 \\times 10^6 - 2.16 \\times 10^5}{14.44} \\right) = 1.4706 (-101800) \\approx -149707~\\mathrm{V/m^2} $$\n总导数：\n$$ \\frac{dE_r}{dr}(0.45) \\approx 30000 - 149707 = -119707~\\mathrm{V/m^2} $$\n现在组合出 $\\gamma_E(0.45)$：\n$$ \\gamma_E(0.45) = \\left| \\frac{1}{2.5} \\left( -119707 - \\frac{1898}{0.45} \\right) \\right| = \\left| 0.4 \\left( -119707 - 4218 \\right) \\right| = |0.4(-123925)| \\approx 49570~\\mathrm{s}^{-1} $$\n最后，计算比率 $S(0.45)$：\n$$ S(0.45) = \\frac{\\gamma_E(0.45)}{\\gamma_{\\mathrm{thr}}(0.45)} \\approx \\frac{49570}{125090} \\approx 0.39628 $$\n四舍五入到四位有效数字，抑制比的最大值为 $0.3963$。",
            "answer": "$$\\boxed{0.3963}$$"
        },
        {
            "introduction": "在任何真实世界的实验中，测量都存在不确定性，而所计算量的可靠性取决于其所源自的数据。本练习侧重于数据分析的一个关键方面：误差传播。您将学习如何量化由测量的压强梯度和流动速度的不确定性所引起的 $E \\times B$ 剪切率的不确定性。",
            "id": "3969584",
            "problem": "考虑一个托卡马克中的磁约束轴对称等离子体，在半径为 $r_0$ 的磁通面周围的一个窄径向区间内进行局域建模。电场叉磁场（$E \\times B$）剪切率 $ \\gamma_E(r) $ 定义为 $E \\times B$ 漂移流的极向分量的径向导数，在一个板状局域近似中，径向电场 $E_r(r)$ 驱动极向 $E \\times B$ 速度 $v_{E\\theta}(r) = E_r(r)/B_\\phi(r)$，于是有 $ \\gamma_E(r) \\equiv \\frac{d}{dr}\\left(\\frac{E_r(r)}{B_\\phi(r)}\\right) $。稳态下的离子径向力平衡将 $E_r(r)$ 与根据下式测量的剖面联系起来：\n$$\nE_r(r) = \\frac{1}{e\\,n_i(r)}\\frac{dp_i}{dr}(r) + V_\\phi(r)\\,B_\\theta(r) - V_\\theta(r)\\,B_\\phi(r)\n$$,\n其中 $e$ 是元电荷，$n_i(r)$ 是离子密度，$p_i(r)$ 是离子压强，$V_\\phi(r)$ 和 $V_\\theta(r)$ 分别是环向流和极向流，$B_\\phi(r)$ 和 $B_\\theta(r)$ 分别是环向和极向磁场分量。在许多运行模式中，对于所考虑的窄区间，离子极向流项 $V_\\theta(r)\\,B_\\phi(r)$ 相对于其他项可以忽略不计。假设情况如此。\n\n给定 $n_i(r)$、$B_\\phi(r)$ 和 $B_\\theta(r)$ 在该区间内变化缓慢，可在 $[r_0-\\Delta, r_0+\\Delta]$ 上被视作径向常数且已知。物理量 $\\frac{dp_i}{dr}(r)$ 和 $V_\\phi(r)$ 在两个半径 $r_0-\\Delta$ 和 $r_0+\\Delta$ 处进行测量，其不确定度是独立的、零均值的高斯分布，每个半径处的标准差分别为 $\\sigma_{p'}$（对应 $\\frac{dp_i}{dr}$）和 $\\sigma_V$（对应 $V_\\phi$）。利用这些测量值，定义标准的中心差分估计量：\n$$\n\\left.\\frac{d^2 p_i}{dr^2}\\right|_{r_0} \\approx \\frac{\\left.\\frac{dp_i}{dr}\\right|_{r_0+\\Delta} - \\left.\\frac{dp_i}{dr}\\right|_{r_0-\\Delta}}{2\\Delta},\n\\qquad\n\\left.\\frac{dV_\\phi}{dr}\\right|_{r_0} \\approx \\frac{V_\\phi(r_0+\\Delta)-V_\\phi(r_0-\\Delta)}{2\\Delta},\n$$\n并计算在 $r_0$ 处 $E \\times B$ 剪切率的相应估计量：\n$$\n\\hat{\\gamma}_E(r_0) = \\left.\\frac{d}{dr}\\left(\\frac{E_r}{B_\\phi}\\right)\\right|_{r_0} \\approx \\frac{1}{B_\\phi}\\left[\\frac{1}{e\\,n_i}\\left.\\frac{d^2 p_i}{dr^2}\\right|_{r_0} + B_\\theta \\left.\\frac{dV_\\phi}{dr}\\right|_{r_0}\\right].\n$$\n\n在上述假设下，将 $n_i$、$B_\\phi$、$B_\\theta$ 和 $\\Delta$ 视为精确常数，并假设四个测量值 $\\left.\\frac{dp_i}{dr}\\right|_{r_0\\pm\\Delta}$ 和 $V_\\phi(r_0\\pm\\Delta)$ 是统计独立的。传播测量不确定度，以获得由给定的 $\\frac{dp_i}{dr}$ 和 $V_\\phi$ 的不确定度引起的估计量 $\\hat{\\gamma}_E(r_0)$ 的标准差 $\\sigma_{\\gamma_E}$。用 $\\Delta$、$e$、$n_i$、$B_\\theta$、$B_\\phi$、$\\sigma_{p'}$ 和 $\\sigma_V$ 将你的最终答案表示为 $\\sigma_{\\gamma_E}$ 的单个闭式解析表达式。指明你的表达式的单位为 s$^{-1}$。不需要进行数值取整。",
            "solution": "所述问题具有科学依据、提法恰当、客观且内部一致。这是一个在聚变等离子体物理背景下有效的不确定度传播问题。因此，将推导其解。\n\n目标是计算 E×B 剪切率估计量 $\\hat{\\gamma}_E(r_0)$ 的标准差 $\\sigma_{\\gamma_E}$。该估计量由下式给出：\n$$\n\\hat{\\gamma}_E(r_0) = \\frac{1}{B_\\phi}\\left[\\frac{1}{e\\,n_i}\\left.\\frac{d^2 p_i}{dr^2}\\right|_{r_0} + B_\\theta \\left.\\frac{dV_\\phi}{dr}\\right|_{r_0}\\right]\n$$\n问题提供了在半径 $r_0$ 处离子压强的二阶导数和环向流的一阶导数的中心差分估计量：\n$$\n\\left.\\frac{d^2 p_i}{dr^2}\\right|_{r_0} \\approx \\frac{\\left.\\frac{dp_i}{dr}\\right|_{r_0+\\Delta} - \\left.\\frac{dp_i}{dr}\\right|_{r_0-\\Delta}}{2\\Delta}\n$$\n$$\n\\left.\\frac{dV_\\phi}{dr}\\right|_{r_0} \\approx \\frac{V_\\phi(r_0+\\Delta)-V_\\phi(r_0-\\Delta)}{2\\Delta}\n$$\n为清晰起见，我们将测量量表示如下：\n-   $p'_+ \\equiv \\left.\\frac{dp_i}{dr}\\right|_{r_0+\\Delta}$\n-   $p'_- \\equiv \\left.\\frac{dp_i}{dr}\\right|_{r_0-\\Delta}$\n-   $V_+ \\equiv V_\\phi(r_0+\\Delta)$\n-   $V_- \\equiv V_\\phi(r_0-\\Delta)$\n\n将这些代入 $\\hat{\\gamma}_E(r_0)$ 的表达式中：\n$$\n\\hat{\\gamma}_E(r_0) = \\frac{1}{B_\\phi}\\left[ \\frac{1}{e\\,n_i} \\left( \\frac{p'_+ - p'_-}{2\\Delta} \\right) + B_\\theta \\left( \\frac{V_+ - V_-}{2\\Delta} \\right) \\right]\n$$\n我们可以重新排列这个表达式，将 $\\hat{\\gamma}_E(r_0)$ 表示为四个测量量 $p'_+$, $p'_-$, $V_+$ 和 $V_-$ 的线性组合：\n$$\n\\hat{\\gamma}_E(r_0) = \\left( \\frac{1}{2 \\Delta B_\\phi e n_i} \\right) p'_+ - \\left( \\frac{1}{2 \\Delta B_\\phi e n_i} \\right) p'_- + \\left( \\frac{B_\\theta}{2 \\Delta B_\\phi} \\right) V_+ - \\left( \\frac{B_\\theta}{2 \\Delta B_\\phi} \\right) V_-\n$$\n问题陈述这四个测量值是统计独立的随机变量。对于由独立随机变量 $X_i$ 构成的通用函数 $f(X_1, X_2, \\dots, X_N)$，其方差 $\\sigma_f^2$ 由以下误差传播公式给出：\n$$\n\\sigma_f^2 = \\sum_{i=1}^{N} \\left(\\frac{\\partial f}{\\partial X_i}\\right)^2 \\sigma_{X_i}^2\n$$\n在我们的例子中，$\\hat{\\gamma}_E(r_0)$ 是测量值的线性函数。对于线性组合 $f = \\sum_{i} a_i X_i$，方差为 $\\sigma_f^2 = \\sum_{i} a_i^2 \\sigma_{X_i}^2$。偏导数就是每个变量的常数系数。\n\n测量值的标准差给定为：\n-   $\\sigma_{p'_+} = \\sigma_{p'_-} = \\sigma_{p'}$\n-   $\\sigma_{V_+} = \\sigma_{V_-} = \\sigma_V$\n\n常数 $e$、$n_i$、$B_\\phi$、$B_\\theta$ 和 $\\Delta$ 被视为精确值。因此，$\\hat{\\gamma}_E(r_0)$ 的方差（记为 $\\sigma_{\\gamma_E}^2$）为：\n$$\n\\sigma_{\\gamma_E}^2 = \\left( \\frac{\\partial \\hat{\\gamma}_E}{\\partial p'_+} \\right)^2 \\sigma_{p'}^2 + \\left( \\frac{\\partial \\hat{\\gamma}_E}{\\partial p'_-} \\right)^2 \\sigma_{p'}^2 + \\left( \\frac{\\partial \\hat{\\gamma}_E}{\\partial V_+} \\right)^2 \\sigma_V^2 + \\left( \\frac{\\partial \\hat{\\gamma}_E}{\\partial V_-} \\right)^2 \\sigma_V^2\n$$\n偏导数是线性组合中的系数：\n-   $\\frac{\\partial \\hat{\\gamma}_E}{\\partial p'_+} = \\frac{1}{2 \\Delta B_\\phi e n_i}$\n-   $\\frac{\\partial \\hat{\\gamma}_E}{\\partial p'_-} = -\\frac{1}{2 \\Delta B_\\phi e n_i}$\n-   $\\frac{\\partial \\hat{\\gamma}_E}{\\partial V_+} = \\frac{B_\\theta}{2 \\Delta B_\\phi}$\n-   $\\frac{\\partial \\hat{\\gamma}_E}{\\partial V_-} = -\\frac{B_\\theta}{2 \\Delta B_\\phi}$\n\n将这些代入方差公式中：\n$$\n\\sigma_{\\gamma_E}^2 = \\left(\\frac{1}{2 \\Delta B_\\phi e n_i}\\right)^2 \\sigma_{p'}^2 + \\left(-\\frac{1}{2 \\Delta B_\\phi e n_i}\\right)^2 \\sigma_{p'}^2 + \\left(\\frac{B_\\theta}{2 \\Delta B_\\phi}\\right)^2 \\sigma_V^2 + \\left(-\\frac{B_\\theta}{2 \\Delta B_\\phi}\\right)^2 \\sigma_V^2\n$$\n将系数平方得到：\n$$\n\\sigma_{\\gamma_E}^2 = \\frac{1}{4 \\Delta^2 B_\\phi^2 e^2 n_i^2}\\sigma_{p'}^2 + \\frac{1}{4 \\Delta^2 B_\\phi^2 e^2 n_i^2}\\sigma_{p'}^2 + \\frac{B_\\theta^2}{4 \\Delta^2 B_\\phi^2}\\sigma_V^2 + \\frac{B_ \\theta^2}{4 \\Delta^2 B_\\phi^2}\\sigma_V^2\n$$\n合并同类项：\n$$\n\\sigma_{\\gamma_E}^2 = 2 \\left( \\frac{\\sigma_{p'}^2}{4 \\Delta^2 B_\\phi^2 e^2 n_i^2} \\right) + 2 \\left( \\frac{B_\\theta^2 \\sigma_V^2}{4 \\Delta^2 B_\\phi^2} \\right)\n$$\n$$\n\\sigma_{\\gamma_E}^2 = \\frac{\\sigma_{p'}^2}{2 \\Delta^2 B_\\phi^2 e^2 n_i^2} + \\frac{B_\\theta^2 \\sigma_V^2}{2 \\Delta^2 B_\\phi^2}\n$$\n我们可以提出公分母：\n$$\n\\sigma_{\\gamma_E}^2 = \\frac{1}{2 \\Delta^2 B_\\phi^2} \\left( \\frac{\\sigma_{p'}^2}{e^2 n_i^2} + B_\\theta^2 \\sigma_V^2 \\right)\n$$\n所求量为标准差 $\\sigma_{\\gamma_E}$，即方差的平方根。假设 $\\Delta > 0$ 且 $B_\\phi$ 可取正值（按惯例），我们有：\n$$\n\\sigma_{\\gamma_E} = \\sqrt{\\frac{1}{2 \\Delta^2 B_\\phi^2} \\left( \\frac{\\sigma_{p'}^2}{e^2 n_i^2} + B_\\theta^2 \\sigma_V^2 \\right)}\n$$\n$$\n\\sigma_{\\gamma_E} = \\frac{1}{\\sqrt{2} \\Delta B_\\phi} \\sqrt{\\frac{\\sigma_{p'}^2}{e^2 n_i^2} + B_\\theta^2 \\sigma_V^2}\n$$\n这个表达式可以重写，以按照各项在径向电场方程中出现的形式进行分组：\n$$\n\\sigma_{\\gamma_E} = \\frac{1}{\\sqrt{2} \\Delta B_\\phi} \\sqrt{\\left(\\frac{\\sigma_{p'}}{e n_i}\\right)^2 + (B_\\theta \\sigma_V)^2}\n$$\n问题要求最终表达式的单位应为 s$^{-1}$。我们可以对此进行验证。在国际单位制（SI）中：$\\Delta$ 的单位是 m；$B_\\phi$ 和 $B_\\theta$ 的单位是 T；$e$ 的单位是 C；$n_i$ 的单位是 m$^{-3}$；$\\sigma_V$ 的单位是 m s$^{-1}$；而 $\\sigma_{p'}$（对应 $\\frac{dp_i}{dr}$）的单位是 Pa m$^{-1}$ 或 kg m$^{-2}$ s$^{-2}$。\n项 $\\frac{\\sigma_{p'}}{e n_i}$ 的单位是 $\\frac{\\text{kg m}^{-2} \\text{s}^{-2}}{\\text{C m}^{-3}} = \\frac{\\text{kg m s}^{-2}}{\\text{C}} = \\frac{\\text{N}}{\\text{C}}$，这是电场的单位。\n项 $B_\\theta \\sigma_V$ 的单位是 T m s$^{-1}$，根据洛伦兹力定律，这也等效于 N C$^{-1}$。\n因此，平方根下的项的单位是 (N C$^{-1})^2$。其平方根的单位是 N C$^{-1}$。\n前置因子 $\\frac{1}{\\Delta B_\\phi}$ 的单位是 (m T)$^{-1}$。由于 T = N C$^{-1}$ m$^{-1}$ s，该前置因子的单位是 (m (N C$^{-1}$ m$^{-1}$ s))$^{-1}$ = (N C$^{-1}$ s)$^{-1}$。\n总的单位是 (N C$^{-1}$ s)$^{-1} \\cdot $(N C$^{-1}$) = s$^{-1}$，这是正确的。\n最终表达式是 $\\sigma_{\\gamma_E}$ 关于指定参数的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{2} \\Delta B_\\phi} \\sqrt{\\left(\\frac{\\sigma_{p'}}{e n_i}\\right)^2 + \\left(B_\\theta \\sigma_V\\right)^2}}\n$$"
        },
        {
            "introduction": "除了直接计算，我们还可以通过观察物理参数对系统的影响来推断它们。这项高级练习引入了强大的贝叶斯推断技术，不是通过力平衡，而是通过其对湍流热通量的影响来估计 $E \\times B$ 剪切率。通过将剪切抑制的输运模型与实验数据进行拟合，您将学习如何将理论与观测联系起来，并量化您推断参数的不确定性。",
            "id": "3969578",
            "problem": "给定磁化等离子体中无量纲的离子热通量和离子温度梯度的实验数据对，以及一个简化的剪切抑制湍流输运闭合模型。您的任务是通过将模型与数据拟合来执行贝叶斯推断，以估计 $E\\times B$ 剪切率 $\\gamma_E$ 并量化不确定性。最终输出必须按照下文指定的方式，将多个数据集的结果汇总到一行中。\n\n$E\\times B$ 漂移（写作 $E\\times B$）剪切率 $\\gamma_E$ 被假定通过去相关来抑制湍流输运。从离子热通量定律 $Q_i = - n_i T_i \\chi_i \\nabla T_i$ 开始，定义归一化的无量纲通量 $q_i = Q_i / Q_{\\mathrm{gB}}$，其中 $Q_{\\mathrm{gB}}$ 表示回旋玻姆（gyro-Bohm, gB）归一化，并将无量纲离子温度梯度表示为 $\\kappa \\equiv R/L_{Ti}$，其中 $L_{Ti}^{-1} = - \\partial \\ln T_i / \\partial r$，$R$ 为主半径。采用以下剪切修正的湍流扩散率闭合模型，该模型直接用归一化通量表示：\n$$\nq_i(\\kappa; \\gamma_E) = A \\left[(\\kappa - \\kappa_c)_+\\right]^\\alpha \\left[1 + \\left(\\frac{\\gamma_E}{\\gamma_{\\mathrm{lin}}(\\kappa)}\\right)^\\beta\\right]^{-1},\n$$\n其中 $(x)_+ \\equiv \\max(x, 0)$，$\\gamma_{\\mathrm{lin}}(\\kappa) = B \\left[(\\kappa - \\kappa_c)_+\\right]$，并且 $A$、$\\alpha$、$\\beta$、$\\kappa_c$、$B$ 是已知的正常数模型常量。假设测量误差是独立的高斯分布：对于具有已知标准差 $\\sigma_j$ 的数据点 $(\\kappa_j, y_j)$，其似然函数为\n$$\ny_j \\sim \\mathcal{N}\\!\\left(q_i(\\kappa_j; \\gamma_E), \\sigma_j^2\\right).\n$$\n对 $\\gamma_E$ 在区间 $[0, \\gamma_{\\max}]$ 上使用均匀先验，区间外概率为零。推断 $\\gamma_E$ 的后验分布，并报告后验均值和中心 $95\\%$ 置信区间。\n\n在回旋玻姆归一化下，所有量都是无量纲的；报告的 $\\gamma_E$ 以 $c_s/R$ 为单位，是一个无量纲数。问题不涉及角度，因此不需要角度单位。置信区间的界限以小数形式表示。\n\n通过在 $[0, \\gamma_{\\max}]$ 上对 $\\gamma_E$ 网格上的后验分布进行数值积分来实现推断；不要使用马尔可夫链蒙特卡洛方法。对于每个数据集，您的程序必须计算：\n- 后验均值 $\\mathbb{E}[\\gamma_E \\mid \\{\\kappa_j, y_j, \\sigma_j\\}]$，\n- $\\gamma_E$ 的中心 $95\\%$ 置信区间的下界和上界。\n\n使用以下固定的模型常量和先验界限：\n- $A = 1.2$，\n- $\\alpha = 1.5$，\n- $\\beta = 2.0$，\n- $\\kappa_c = 5.0$，\n- $B = 0.3$，\n- $\\gamma_{\\max} = 4.0$。\n\n测试套件：\n为以下三个数据集提供结果，每个数据集包含三个点：\n- 数据集 1（中等驱动，中等抑制）：$\\kappa$ 值为 $[6.0, 7.0, 8.0]$，观测 $y$ 值为 $[0.12, 0.82, 2.85]$，标准差 $\\sigma$ 值为 $[0.10, 0.10, 0.10]$。\n- 数据集 2（接近阈值，弱驱动）：$\\kappa$ 值为 $[5.2, 5.5, 5.8]$，观测 $y$ 值为 $[0.02, 0.17, 0.49]$，标准差 $\\sigma$ 值为 $[0.05, 0.05, 0.05]$。\n- 数据集 3（强驱动，强抑制）：$\\kappa$ 值为 $[9.0, 10.0, 11.0]$，观测 $y$ 值为 $[1.90, 3.40, 6.30]$，标准差 $\\sigma$ 值为 $[0.20, 0.20, 0.20]$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个数据集，并且是包含三个浮点数的列表，顺序为 $[\\text{posterior\\_mean}, \\text{lower\\_95}, \\text{upper\\_95}]$。将每个浮点数四舍五入到三位小数。例如，输出应如下所示\n$$\n\\text{[[m_1,\\ell_1,u_1],[m_2,\\ell_2,u_2],[m_3,\\ell_3,u_3]]}.\n$$",
            "solution": "该问题在科学和数学上是适定的，提供了执行贝叶斯推断所需的一整套数据、一个物理模型和一个统计框架。用于剪切抑制湍流输运的模型是等离子体物理学中使用的标准简化形式，而从数据中推断模型参数是数据分析中的一个常规问题。因此，可以构建一个解决方案。\n\n问题的核心是，在给定一组实验测量值 $D = \\{(\\kappa_j, y_j, \\sigma_j)\\}_{j=1}^N$ 的情况下，确定 $E\\times B$ 剪切率 $\\gamma_E$ 的后验概率分布。根据贝叶斯定理，后验概率密度函数（PDF）$P(\\gamma_E | D)$ 正比于似然函数 $P(D | \\gamma_E)$ 和先验概率分布 $P(\\gamma_E)$ 的乘积：\n$$ P(\\gamma_E | D) \\propto P(D | \\gamma_E) P(\\gamma_E) $$\n完整的后验概率密度函数通过对此乘积进行归一化得到：\n$$ P(\\gamma_E | D) = \\frac{P(D | \\gamma_E) P(\\gamma_E)}{\\int P(D | \\gamma_E') P(\\gamma_E') d\\gamma_E'} $$\n其中分母中的积分，被称为边缘似然或证据，是在 $\\gamma_E$ 的整个参数空间上进行的。\n\n问题指定了 $\\gamma_E$ 在区间 $[0, \\gamma_{\\max}]$ 上的均匀先验。其概率密度函数为：\n$$ P(\\gamma_E) = \\begin{cases} 1/\\gamma_{\\max}  \\text{if } 0 \\le \\gamma_E \\le \\gamma_{\\max} \\\\ 0  \\text{otherwise} \\end{cases} $$\n其中 $\\gamma_{\\max} = 4.0$。由于先验在感兴趣的域上是常数，因此后验在此域内与似然函数成正比，$P(\\gamma_E|D) \\propto P(D|\\gamma_E)$。\n\n实验测量值 $y_j$ 被假定为独立的，并受到具有已知标准差 $\\sigma_j$ 的高斯噪声的干扰。对于给定的 $\\gamma_E$，观测到单个数据点 $y_j$ 的似然由高斯概率密度函数给出：\n$$ P(y_j | \\kappa_j, \\sigma_j, \\gamma_E) = \\frac{1}{\\sqrt{2\\pi}\\sigma_j^2} \\exp \\left( - \\frac{(y_j - q_i(\\kappa_j; \\gamma_E))^2}{2\\sigma_j^2} \\right) $$\n其中 $q_i(\\kappa_j; \\gamma_E)$ 是归一化热通量的模型预测值。该模型由以下公式给出：\n$$ q_i(\\kappa; \\gamma_E) = A \\left[(\\kappa - \\kappa_c)_+\\right]^\\alpha \\left[1 + \\left(\\frac{\\gamma_E}{\\gamma_{\\mathrm{lin}}(\\kappa)}\\right)^\\beta\\right]^{-1} $$\n其中 $\\gamma_{\\mathrm{lin}}(\\kappa) = B \\left[(\\kappa - \\kappa_c)_+\\right]$ 且 $(x)_+ \\equiv \\max(x, 0)$。常量为 $A=1.2$，$\\alpha=1.5$，$\\beta=2.0$，$\\kappa_c=5.0$，以及 $B=0.3$。对于 $\\kappa \\le \\kappa_c$ 的情况，项 $(\\kappa - \\kappa_c)_+$ 为零，这意味着不存在湍流驱动，通量必须为零，$q_i=0$。实现时必须正确处理这种情况，以避免在 $\\gamma_{\\mathrm{lin}}(\\kappa)$ 的表达式中出现除以零的错误。\n\n由于测量是独立的，整个数据集 $D$ 的总似然是各个似然的乘积：\n$$ P(D | \\gamma_E) = \\prod_{j=1}^N P(y_j | \\kappa_j, \\sigma_j, \\gamma_E) $$\n为了数值稳定性，最好使用对数似然。未归一化的后验与似然成正比，$\\mathcal{L}(\\gamma_E) = \\exp \\left( -\\frac{1}{2} \\sum_{j=1}^N \\frac{(y_j - q_i(\\kappa_j; \\gamma_E))^2}{\\sigma_j^2} \\right)$。由于采用均匀先验，对于 $\\gamma_E \\in [0, \\gamma_{\\max}]$，未归一化的后验概率密度函数 $\\tilde{P}(\\gamma_E|D)$ 就是 $\\mathcal{L}(\\gamma_E)$，否则为零。\n\n通过在跨越区间 $[0, \\gamma_{\\max}]$ 的精细点网格 $\\{\\gamma_{E,k}\\}$ 上计算 $\\tilde{P}(\\gamma_E|D)$ 来确定后验分布。为防止数值下溢，标准做法是计算对数似然，减去其最大值，然后取指数。令 $\\ln \\mathcal{L}_k = \\ln \\mathcal{L}(\\gamma_{E,k})$。我们计算数值稳定的未归一化后验值 $p_k = \\exp(\\ln \\mathcal{L}_k - \\max_i(\\ln \\mathcal{L}_i))$。\n\n一旦在网格上制表了未归一化的后验，我们就可以使用数值积分来计算所需的统计属性，其中梯形法则是一个合适的选择。\n\n后验均值 $\\mathbb{E}[\\gamma_E | D]$ 计算如下：\n$$ \\mathbb{E}[\\gamma_E | D] = \\frac{\\int_0^{\\gamma_{\\max}} \\gamma_E \\tilde{P}(\\gamma_E|D) d\\gamma_E}{\\int_0^{\\gamma_{\\max}} \\tilde{P}(\\gamma_E'|D) d\\gamma_E'} $$\n这可以使用网格值进行数值近似，例如使用 `numpy.trapz`。\n\n中心 $95\\%$ 置信区间 $[\\ell, u]$ 由包含 $95\\%$ 后验概率的值定义，每个尾部占 $2.5\\%$。这需要计算后验的累积分布函数（CDF）：\n$$ F(\\gamma) = \\frac{\\int_0^{\\gamma} \\tilde{P}(\\gamma_E'|D) d\\gamma_E'}{\\int_0^{\\gamma_{\\max}} \\tilde{P}(\\gamma_E'|D) d\\gamma_E'} $$\n通过求解 $F(\\ell) = 0.025$ 和 $F(u) = 0.975$ 来找到界限。在数值上，我们在网格上计算 CDF（为保证精度可使用 `scipy.integrate.cumulative_trapezoid`），将其归一化，然后使用线性插值（`numpy.interp`）来找到与所需分位数对应的 $\\gamma_E$ 值。下面的实现为所提供的三个数据集中的每一个执行此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Performs Bayesian inference to estimate the ExB shearing rate gamma_E\n    for three datasets and formats the results.\n    \"\"\"\n    # Model constants and prior bounds\n    A = 1.2\n    ALPHA = 1.5\n    BETA = 2.0\n    KAPPA_C = 5.0\n    B = 0.3\n    GAMMA_MAX = 4.0\n    \n    # Grid for numerical integration\n    N_GRID = 10000\n    gamma_grid = np.linspace(0, GAMMA_MAX, N_GRID)\n\n    def q_model(kappa_vals, gamma_E):\n        \"\"\"\n        Calculates the predicted normalized heat flux q_i.\n        Vectorized for an array of kappa values and a scalar gamma_E.\n        \"\"\"\n        # Ensure kappa_vals is a numpy array for vectorized operations\n        kappa_vals = np.asarray(kappa_vals)\n        \n        # Calculate effective kappa above the critical gradient\n        kappa_eff = np.maximum(0, kappa_vals - KAPPA_C)\n        q_pred = np.zeros_like(kappa_eff, dtype=float)\n        \n        # Identify indices where turbulence is driven (kappa > kappa_c)\n        driven_mask = kappa_eff > 0\n        \n        # If no points are above threshold, flux is zero everywhere\n        if not np.any(driven_mask):\n            return q_pred\n            \n        keff_driven = kappa_eff[driven_mask]\n        \n        # Calculate the linear growth rate proxy\n        gamma_lin = B * keff_driven\n        \n        # Calculate the suppression factor\n        suppression = 1.0 + (gamma_E / gamma_lin)**BETA\n        \n        # Calculate flux for the driven points\n        q_pred[driven_mask] = A * (keff_driven**ALPHA) / suppression\n        \n        return q_pred\n\n    def analyze_dataset(kappa, y, sigma):\n        \"\"\"\n        Computes the posterior mean and 95% credible interval for gamma_E\n        for a single dataset.\n        \"\"\"\n        log_likelihood = np.zeros_like(gamma_grid)\n\n        # Iterate over the parameter grid to compute the likelihood\n        for i, gamma_E in enumerate(gamma_grid):\n            q_pred = q_model(kappa, gamma_E)\n            # Sum of squared residuals, normalized by variance\n            chi2 = np.sum(((y - q_pred) / sigma)**2)\n            log_likelihood[i] = -0.5 * chi2\n\n        # Stabilize numerically by subtracting the max log-likelihood\n        # This makes the max of the unnormalized posterior equal to 1, preventing underflow\n        log_likelihood -= np.max(log_likelihood)\n        posterior_unnorm = np.exp(log_likelihood)\n\n        # Calculate posterior mean using trapezoidal rule for integration\n        # Normalization constant Z = integral of posterior_unnorm\n        Z = np.trapz(posterior_unnorm, x=gamma_grid)\n        # Mean = integral of gamma_E * posterior_unnorm / Z\n        posterior_mean = np.trapz(gamma_grid * posterior_unnorm, x=gamma_grid) / Z\n\n        # Calculate the cumulative distribution function (CDF)\n        cdf = cumulative_trapezoid(posterior_unnorm, x=gamma_grid, initial=0)\n        # Normalize the CDF to have a maximum value of 1\n        cdf /= cdf[-1]\n\n        # Interpolate the CDF to find the 2.5% and 97.5% quantiles\n        lower_95 = np.interp(0.025, cdf, gamma_grid)\n        upper_95 = np.interp(0.975, cdf, gamma_grid)\n\n        return [posterior_mean, lower_95, upper_95]\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Dataset 1\n        (np.array([6.0, 7.0, 8.0]), np.array([0.12, 0.82, 2.85]), np.array([0.10, 0.10, 0.10])),\n        # Dataset 2\n        (np.array([5.2, 5.5, 5.8]), np.array([0.02, 0.17, 0.49]), np.array([0.05, 0.05, 0.05])),\n        # Dataset 3\n        (np.array([9.0, 10.0, 11.0]), np.array([1.90, 3.40, 6.30]), np.array([0.20, 0.20, 0.20])),\n    ]\n\n    # Process all datasets\n    results = []\n    for case in test_cases:\n        kappa, y, sigma = case\n        result = analyze_dataset(kappa, y, sigma)\n        results.append(result)\n\n    # Format the final output string as specified\n    formatted_parts = []\n    for res in results:\n        # Format each float to three decimal places\n        formatted_res = f\"[{res[0]:.3f},{res[1]:.3f},{res[2]:.3f}]\"\n        formatted_parts.append(formatted_res)\n    \n    final_output = f\"[[{','.join(formatted_parts)}]]\"\n\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}