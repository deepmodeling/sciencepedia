{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the concept of gyroviscous stress, we must move from abstract definitions to concrete calculations. This first exercise provides a foundational workout by asking you to compute the gyroviscous stress tensor, $\\boldsymbol{\\Pi}^{\\text{gv}}$, and the resulting force for a simple, yet physically insightful, linear shear flow. Completing this practice will solidify your understanding of how the tensor components arise from velocity gradients and reveal an important property of the gyroviscous force in certain idealized configurations.",
            "id": "3989263",
            "problem": "Consider a single ion species fluid in the low-frequency, strongly magnetized limit appropriate to Braginskii-type closures. Let the magnetic field be uniform, $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$, the ion number density be uniform, $n = \\text{const}$, and the ion scalar pressure be uniform, $p_i = n T_i = \\text{const}$. Consider a steady, two-dimensional, incompressible flow with perpendicular velocity $\\mathbf{v}_\\perp = S\\,x\\,\\hat{\\mathbf{y}}$ and $v_\\parallel = 0$, where $S$ is a constant shear rate. The ion charge and mass are $q_i > 0$ and $m_i$, respectively, so the ion gyrofrequency is $\\Omega_i = q_i B / m_i$. In the strongly magnetized limit and to first order in the finite Larmor radius, the gyroviscous stress tensor for the ions is modeled by the standard nondissipative Braginskii gyroviscous closure\n$$\n\\Pi^{\\text{gv}} \\;=\\; \\frac{p_i}{\\Omega_i}\\,\\Big( \\hat{\\mathbf{b}} \\times W \\;+\\; (\\hat{\\mathbf{b}} \\times W)^{\\top} \\Big),\n$$\nwhere $\\hat{\\mathbf{b}} = \\mathbf{B}/B$ is the unit magnetic field vector, $\\top$ denotes transpose, $W$ is the symmetric, traceless rate-of-strain tensor\n$$\nW \\;=\\; \\frac{1}{2}\\Big(\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^{\\top}\\Big) \\;-\\; \\frac{1}{3}\\,(\\nabla\\cdot\\mathbf{v})\\,\\mathbb{I},\n$$\nand the cross product between a vector and a second-rank tensor is defined componentwise by $(\\hat{\\mathbf{b}} \\times W)_{ij} = \\epsilon_{ikl}\\,\\hat{b}_k\\,W_{lj}$ with $\\epsilon_{ikl}$ the Levi-Civita symbol. Starting from these definitions and the given flow, compute explicitly all nonzero components of $\\Pi^{\\text{gv}}$ and the resulting force density $\\nabla \\cdot \\Pi^{\\text{gv}}$. Then, as your final reported quantity, provide the component $\\Pi^{\\text{gv}}_{xx}$ expressed in terms of $p_i$, $S$, and $\\Omega_i$. Express the final reported $\\Pi^{\\text{gv}}_{xx}$ in Pascals. No numerical evaluation is required; a closed-form symbolic expression is expected.",
            "solution": "The problem asks for the nonzero components of the gyroviscous stress tensor $\\boldsymbol{\\Pi}^{\\text{gv}}$ and the gyroviscous force density $\\nabla \\cdot \\boldsymbol{\\Pi}^{\\text{gv}}$ for a specific fluid flow, and to report the component $\\boldsymbol{\\Pi}^{\\text{gv}}_{xx}$.\n\n### Step 1: Problem Validation\n\n**1. Extraction of Givens:**\n-   The fluid is a single ion species in the low-frequency, strongly magnetized limit.\n-   The magnetic field is uniform: $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$.\n-   The ion number density is uniform: $n = \\text{const}$.\n-   The ion scalar pressure is uniform: $p_i = n T_i = \\text{const}$.\n-   The flow is steady, two-dimensional, and incompressible: $\\mathbf{v} = S\\,x\\,\\hat{\\mathbf{y}}$, where $S$ is a constant shear rate.\n-   Ion charge is $q_i > 0$ and mass is $m_i$. The ion gyrofrequency is $\\Omega_i = q_i B / m_i$.\n-   The gyroviscous stress tensor is given by $\\Pi^{\\text{gv}} = \\frac{p_i}{\\Omega_i}\\,\\Big( \\hat{\\mathbf{b}} \\times W + (\\hat{\\mathbf{b}} \\times W)^{\\top} \\Big)$, where $\\hat{\\mathbf{b}} = \\mathbf{B}/B$.\n-   The rate-of-strain tensor is $W = \\frac{1}{2}\\Big(\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^{\\top}\\Big) - \\frac{1}{3}\\,(\\nabla\\cdot\\mathbf{v})\\,\\mathbb{I}$.\n-   The cross product definition is $(\\hat{\\mathbf{b}} \\times W)_{ij} = \\epsilon_{ikl}\\,\\hat{b}_k\\,W_{lj}$.\n\n**2. Validation using Extracted Givens:**\n-   **Scientifically Grounded:** The problem uses standard definitions and equations from Braginskii's fluid theory, a cornerstone of plasma physics for describing collisional plasmas. The setup is a standard model problem (linear shear flow) for studying transport and stability. The problem is scientifically sound.\n-   **Well-Posed:** The problem provides all necessary definitions and data to perform a direct calculation. The request is specific and unambiguous. A unique solution exists.\n-   **Objective:** The problem is stated in precise, formal mathematical and physical language, free of any subjectivity.\n-   **Completeness and Consistency:** The givens are self-consistent. The specified flow $\\mathbf{v} = (0, Sx, 0)$ has a divergence $\\nabla \\cdot \\mathbf{v} = \\frac{\\partial (0)}{\\partial x} + \\frac{\\partial (Sx)}{\\partial y} + \\frac{\\partial (0)}{\\partial z} = 0$, which is consistent with the stated condition of an incompressible flow. All required definitions are provided. The final request to express the answer in Pascals is clarified as a symbolic expression with units of pressure, which is dimensionally consistent with the variables involved ($p_i$ is pressure, $S$ and $\\Omega_i$ have units of inverse time, so their ratio is dimensionless).\n\n**3. Verdict:**\nThe problem is valid.\n\n### Step 2: Solution Derivation\n\nWe proceed with the calculation in a step-by-step manner.\n\n**1. Calculate the Velocity Gradient Tensor ($\\nabla \\mathbf{v}$)**\nThe velocity vector is given in Cartesian coordinates $(x, y, z)$ as $\\mathbf{v} = (v_x, v_y, v_z) = (0, Sx, 0)$. The velocity gradient tensor, $(\\nabla \\mathbf{v})_{ij} = \\frac{\\partial v_j}{\\partial x_i}$, is:\n$$\n\\nabla \\mathbf{v} =\n\\begin{pmatrix}\n\\frac{\\partial v_x}{\\partial x} & \\frac{\\partial v_y}{\\partial x} & \\frac{\\partial v_z}{\\partial x} \\\\\n\\frac{\\partial v_x}{\\partial y} & \\frac{\\partial v_y}{\\partial y} & \\frac{\\partial v_z}{\\partial y} \\\\\n\\frac{\\partial v_x}{\\partial z} & \\frac{\\partial v_y}{\\partial z} & \\frac{\\partial v_z}{\\partial z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & S & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n\n**2. Calculate the Rate-of-Strain Tensor ($W$)**\nThe divergence of the velocity field is $\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} + \\frac{\\partial v_z}{\\partial z} = 0 + 0 + 0 = 0$. This confirms the flow is incompressible, as stated. For an incompressible flow, the rate-of-strain tensor simplifies to:\n$$\nW = \\frac{1}{2}\\Big(\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^{\\top}\\Big)\n$$\nThe transpose of the velocity gradient is:\n$$\n(\\nabla \\mathbf{v})^{\\top} =\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\nS & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nSubstituting these into the expression for $W$:\n$$\nW = \\frac{1}{2} \\left( \\begin{pmatrix}\n0 & S & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix} + \\begin{pmatrix}\n0 & 0 & 0 \\\\\nS & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix} \\right) = \\frac{1}{2}\n\\begin{pmatrix}\n0 & S & 0 \\\\\nS & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nThe non-zero components of $W$ are $W_{xy} = W_{yx} = S/2$.\n\n**3. Calculate the Tensor $\\hat{\\mathbf{b}} \\times W$**\nThe magnetic field is $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$, so the unit vector is $\\hat{\\mathbf{b}} = (0, 0, 1)$. We use the component definition $(\\hat{\\mathbf{b}} \\times W)_{ij} = \\sum_{k,l} \\epsilon_{ikl}\\,\\hat{b}_k\\,W_{lj}$. Since $\\hat{b}_k = \\delta_{k3}$, this simplifies to $(\\hat{\\mathbf{b}} \\times W)_{ij} = \\sum_{l} \\epsilon_{i3l}\\,W_{lj}$.\n\nLet's compute the components of the resulting tensor, which we denote by $A = \\hat{\\mathbf{b}} \\times W$:\n-   $A_{11} = \\epsilon_{13l}W_{l1} = \\epsilon_{132}W_{21} = (-1)(S/2) = -S/2$.\n-   $A_{12} = \\epsilon_{13l}W_{l2} = \\epsilon_{132}W_{22} = (-1)(0) = 0$.\n-   $A_{21} = \\epsilon_{23l}W_{l1} = \\epsilon_{231}W_{11} = (1)(0) = 0$.\n-   $A_{22} = \\epsilon_{23l}W_{l2} = \\epsilon_{231}W_{12} = (1)(S/2) = S/2$.\nAll other components $A_{ij}$ are zero because either $\\epsilon_{i3l}$ is zero (e.g., if any index is repeated, or if $i=3$), or the corresponding component of $W$ is zero. The resulting tensor is:\n$$\n\\hat{\\mathbf{b}} \\times W =\n\\begin{pmatrix}\n-S/2 & 0 & 0 \\\\\n0 & S/2 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n\n**4. Calculate the Gyroviscous Stress Tensor ($\\Pi^{\\text{gv}}$)**\nThe transpose of $\\hat{\\mathbf{b}} \\times W$ is simply itself, as it is a diagonal matrix:\n$$\n(\\hat{\\mathbf{b}} \\times W)^{\\top} =\n\\begin{pmatrix}\n-S/2 & 0 & 0 \\\\\n0 & S/2 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nNow, we can assemble the gyroviscous stress tensor $\\Pi^{\\text{gv}}$:\n$$\n\\Pi^{\\text{gv}} = \\frac{p_i}{\\Omega_i}\\,\\Big( \\hat{\\mathbf{b}} \\times W + (\\hat{\\mathbf{b}} \\times W)^{\\top} \\Big)\n$$\n$$\n\\Pi^{\\text{gv}} = \\frac{p_i}{\\Omega_i} \\left( \\begin{pmatrix}\n-S/2 & 0 & 0 \\\\\n0 & S/2 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix} + \\begin{pmatrix}\n-S/2 & 0 & 0 \\\\\n0 & S/2 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix} \\right) = \\frac{p_i}{\\Omega_i} \\begin{pmatrix}\n-S & 0 & 0 \\\\\n0 & S & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nThe nonzero components of the gyroviscous stress tensor are:\n$$\n\\Pi^{\\text{gv}}_{xx} = - \\frac{p_i S}{\\Omega_i}\n$$\n$$\n\\Pi^{\\text{gv}}_{yy} = \\frac{p_i S}{\\Omega_i}\n$$\nNote that the tensor is symmetric and its trace, $\\text{Tr}(\\Pi^{\\text{gv}}) = \\Pi^{\\text{gv}}_{xx} + \\Pi^{\\text{gv}}_{yy} + \\Pi^{\\text{gv}}_{zz} = 0$, as required.\n\n**5. Calculate the Force Density ($\\nabla \\cdot \\Pi^{\\text{gv}}$)**\nThe gyroviscous force density is the divergence of the stress tensor, $\\mathbf{F}^{\\text{gv}} = \\nabla \\cdot \\Pi^{\\text{gv}}$. The $j$-th component is given by $(\\nabla \\cdot \\Pi^{\\text{gv}})_j = \\sum_i \\frac{\\partial \\Pi^{\\text{gv}}_{ij}}{\\partial x_i}$.\nThe components of $\\Pi^{\\text{gv}}$ depend on $p_i$, $S$, and $\\Omega_i$, which are all specified as constants. Therefore, all components of $\\Pi^{\\text{gv}}$ are constant throughout space. The partial derivatives of constants are zero.\n$$\n(\\nabla \\cdot \\Pi^{\\text{gv}})_x = \\frac{\\partial \\Pi^{\\text{gv}}_{xx}}{\\partial x} + \\frac{\\partial \\Pi^{\\text{gv}}_{yx}}{\\partial y} + \\frac{\\partial \\Pi^{\\text{gv}}_{zx}}{\\partial z} = \\frac{\\partial}{\\partial x}\\left(- \\frac{p_i S}{\\Omega_i}\\right) + 0 + 0 = 0\n$$\n$$\n(\\nabla \\cdot \\Pi^{\\text{gv}})_y = \\frac{\\partial \\Pi^{\\text{gv}}_{xy}}{\\partial x} + \\frac{\\partial \\Pi^{\\text{gv}}_{yy}}{\\partial y} + \\frac{\\partial \\Pi^{\\text{gv}}_{zy}}{\\partial z} = 0 + \\frac{\\partial}{\\partial y}\\left(\\frac{p_i S}{\\Omega_i}\\right) + 0 = 0\n$$\n$$\n(\\nabla \\cdot \\Pi^{\\text{gv}})_z = \\frac{\\partial \\Pi^{\\text{gv}}_{xz}}{\\partial x} + \\frac{\\partial \\Pi^{\\text{gv}}_{yz}}{\\partial y} + \\frac{\\partial \\Pi^{\\text{gv}}_{zz}}{\\partial z} = 0 + 0 + 0 = 0\n$$\nThus, the resulting gyroviscous force density is zero for this flow configuration:\n$$\n\\nabla \\cdot \\Pi^{\\text{gv}} = \\mathbf{0}\n$$\n\n**6. Final Reported Quantity**\nThe problem requests the component $\\Pi^{\\text{gv}}_{xx}$ expressed in terms of $p_i$, $S$, and $\\Omega_i$. From our calculation:\n$$\n\\Pi^{\\text{gv}}_{xx} = - \\frac{p_i S}{\\Omega_i}\n$$\nThe units of $p_i$ are pressure (Pascals), while both $S$ and $\\Omega_i$ have units of frequency ($1/s$). Their ratio $S/\\Omega_i$ is dimensionless, so the final expression has units of pressure, as noted in the problem statement.",
            "answer": "$$\\boxed{- \\frac{p_i S}{\\Omega_i}}$$"
        },
        {
            "introduction": "Having calculated the gyroviscous tensor for a specific flow, we now elevate our perspective to understand its general mathematical structure. This practice involves expressing the tensor in a coordinate system aligned with the magnetic field to reveal its intrinsic properties, such as symmetry and tracelessness, which are independent of the particular flow details. Mastering this more abstract representation is key to understanding why gyroviscosity acts anisotropically and how it influences plasma dynamics without causing dissipation.",
            "id": "3989287",
            "problem": "Consider a single-species, strongly magnetized, quasi-neutral plasma described by a fluid velocity field $\\boldsymbol{u}(\\boldsymbol{x},t)$ and a uniform magnetic field direction $\\hat{\\boldsymbol{b}}(\\boldsymbol{x},t)$ with $|\\hat{\\boldsymbol{b}}|=1$. Let the rate-of-strain tensor be the symmetric tensor $\\mathsf{S} \\equiv \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}}\\right)$ and define its traceless part $\\mathsf{D} \\equiv \\mathsf{S} - \\frac{1}{3}\\,(\\nabla \\cdot \\boldsymbol{u})\\,\\mathsf{I}$. The unit-vector cross operator $\\mathsf{C}$ associated with $\\hat{\\boldsymbol{b}}$ is defined by components $C_{ij} \\equiv \\epsilon_{ikj}\\,\\hat{b}_{k}$, so that $(\\mathsf{C}\\cdot \\boldsymbol{a})_{i} = (\\hat{\\boldsymbol{b}} \\times \\boldsymbol{a})_{i}$ for any vector $\\boldsymbol{a}$. Consider the leading-order finite Larmor radius gyroviscous closure for the stress tensor,\n$$\n\\boldsymbol{\\Pi}^{\\mathrm{gv}} \\equiv \\eta_{\\mathrm{g}}\\left(\\mathsf{C}\\cdot \\mathsf{D} + (\\mathsf{C}\\cdot \\mathsf{D})^{\\mathsf{T}}\\right),\n$$\nwhere $\\eta_{\\mathrm{g}}$ is a constant gyroviscous coefficient and $(\\cdot)^{\\mathsf{T}}$ denotes transpose. Let $\\mathsf{P}_{\\parallel} \\equiv \\hat{\\boldsymbol{b}}\\hat{\\boldsymbol{b}}$ and $\\mathsf{P}_{\\perp} \\equiv \\mathsf{I} - \\hat{\\boldsymbol{b}}\\hat{\\boldsymbol{b}}$ denote the parallel and perpendicular projection operators relative to $\\hat{\\boldsymbol{b}}$.\n\nWorking in a Cartesian basis aligned with $\\hat{\\boldsymbol{b}}$, namely $\\{\\hat{\\boldsymbol{e}}_{1}, \\hat{\\boldsymbol{e}}_{2}, \\hat{\\boldsymbol{e}}_{3}\\}$ with $\\hat{\\boldsymbol{e}}_{3}=\\hat{\\boldsymbol{b}}$, decompose $\\mathsf{D}$ into its parallel and perpendicular blocks using $\\mathsf{P}_{\\parallel}$ and $\\mathsf{P}_{\\perp}$ and compute all independent components of $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$. In this aligned basis, parameterize the symmetric traceless tensor $\\mathsf{D}$ by its independent components as\n$$\n\\mathsf{D}=\\begin{pmatrix}\nD_{11} & D_{12} & D_{13}\\\\\nD_{12} & D_{22} & D_{23}\\\\\nD_{13} & D_{23} & D_{33}\n\\end{pmatrix}, \\quad \\text{with} \\quad D_{33}=-(D_{11}+D_{22}).\n$$\nExpress your final answer for $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ as a single $3\\times 3$ matrix in terms of $\\eta_{\\mathrm{g}}$ and the components $D_{11}$, $D_{22}$, $D_{12}$, $D_{13}$, and $D_{23}$. Then, using the projection operators $\\mathsf{P}_{\\parallel}$ and $\\mathsf{P}_{\\perp}$, verify from your result that $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ is symmetric and traceless, and identify which projected blocks vanish. No numerical evaluation is required. Provide the matrix elements symbolically. The final answer must be the full matrix for $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ as a closed-form analytic expression.",
            "solution": "The problem statement is critically validated and found to be valid. It is scientifically grounded in the principles of plasma fluid dynamics, specifically concerning finite Larmor radius effects in magnetized plasmas. It is well-posed, objective, self-contained, and formalizable. All definitions and conditions are provided, allowing for a unique, deterministic solution.\n\nThe problem asks for the computation of the gyroviscous stress tensor $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ in a specific coordinate system and verification of its properties. We are given the definition:\n$$\n\\boldsymbol{\\Pi}^{\\mathrm{gv}} \\equiv \\eta_{\\mathrm{g}}\\left(\\mathsf{C}\\cdot \\mathsf{D} + (\\mathsf{C}\\cdot \\mathsf{D})^{\\mathsf{T}}\\right)\n$$\nwhere $\\mathsf{D}$ is the traceless rate-of-strain tensor and $\\mathsf{C}$ is an operator related to the magnetic field direction $\\hat{\\boldsymbol{b}}$.\n\nWe work in a Cartesian basis $\\{\\hat{\\boldsymbol{e}}_{1}, \\hat{\\boldsymbol{e}}_{2}, \\hat{\\boldsymbol{e}}_{3}\\}$ where the magnetic field is aligned with the third axis, so $\\hat{\\boldsymbol{b}} = \\hat{\\boldsymbol{e}}_{3}$. In this basis, the components of the vector $\\hat{\\boldsymbol{b}}$ are $\\hat{b}_k = \\delta_{k3}$.\n\nThe operator $\\mathsf{C}$ has components $C_{ij} = \\epsilon_{ikj}\\,\\hat{b}_{k}$. Substituting $\\hat{b}_k = \\delta_{k3}$, we get $C_{ij} = \\epsilon_{i3j}$. We can compute the components of the matrix representing $\\mathsf{C}$:\n$C_{11} = \\epsilon_{131} = 0$, $C_{12} = \\epsilon_{132} = -1$, $C_{13} = \\epsilon_{133} = 0$.\n$C_{21} = \\epsilon_{231} = 1$, $C_{22} = \\epsilon_{232} = 0$, $C_{23} = \\epsilon_{233} = 0$.\n$C_{31} = \\epsilon_{331} = 0$, $C_{32} = \\epsilon_{332} = 0$, $C_{33} = \\epsilon_{333} = 0$.\nThus, the matrix representation of $\\mathsf{C}$ in this basis is:\n$$\n\\mathsf{C} = \\begin{pmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe traceless rate-of-strain tensor $\\mathsf{D}$ is given in its component form, which is symmetric ($D_{ij}=D_{ji}$) and traceless ($D_{11}+D_{22}+D_{33}=0$):\n$$\n\\mathsf{D} = \\begin{pmatrix} D_{11} & D_{12} & D_{13} \\\\ D_{12} & D_{22} & D_{23} \\\\ D_{13} & D_{23} & D_{33} \\end{pmatrix}\n$$\nwhere we use the given relation $D_{33} = -(D_{11}+D_{22})$.\n\nFirst, we compute the product $\\mathsf{C}\\cdot\\mathsf{D}$ via matrix multiplication:\n$$\n\\mathsf{C}\\cdot\\mathsf{D} = \\begin{pmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} D_{11} & D_{12} & D_{13} \\\\ D_{12} & D_{22} & D_{23} \\\\ D_{13} & D_{23} & D_{33} \\end{pmatrix} = \\begin{pmatrix} -D_{12} & -D_{22} & -D_{23} \\\\ D_{11} & D_{12} & D_{13} \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nNext, we find the transpose of this result, $(\\mathsf{C}\\cdot\\mathsf{D})^{\\mathsf{T}}$:\n$$\n(\\mathsf{C}\\cdot\\mathsf{D})^{\\mathsf{T}} = \\begin{pmatrix} -D_{12} & D_{11} & 0 \\\\ -D_{22} & D_{12} & 0 \\\\ -D_{23} & D_{13} & 0 \\end{pmatrix}\n$$\nNow, we sum these two matrices to find the expression inside the parentheses in the definition of $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$:\n$$\n\\mathsf{C}\\cdot\\mathsf{D} + (\\mathsf{C}\\cdot\\mathsf{D})^{\\mathsf{T}} = \\begin{pmatrix} -D_{12} & -D_{22} & -D_{23} \\\\ D_{11} & D_{12} & D_{13} \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} -D_{12} & D_{11} & 0 \\\\ -D_{22} & D_{12} & 0 \\\\ -D_{23} & D_{13} & 0 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -2D_{12} & D_{11}-D_{22} & -D_{23} \\\\ D_{11}-D_{22} & 2D_{12} & D_{13} \\\\ -D_{23} & D_{13} & 0 \\end{pmatrix}\n$$\nFinally, we multiply by the gyroviscous coefficient $\\eta_{\\mathrm{g}}$ to obtain the full expression for the gyroviscous stress tensor $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$:\n$$\n\\boldsymbol{\\Pi}^{\\mathrm{gv}} = \\eta_{\\mathrm{g}} \\begin{pmatrix} -2D_{12} & D_{11}-D_{22} & -D_{23} \\\\ D_{11}-D_{22} & 2D_{12} & D_{13} \\\\ -D_{23} & D_{13} & 0 \\end{pmatrix}\n$$\nThis is the required matrix expression for $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ in terms of the independent components of $\\mathsf{D}$.\n\nNext, we verify the properties of $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$.\n1.  **Symmetry**: A tensor $\\mathsf{T}$ is symmetric if $\\mathsf{T} = \\mathsf{T}^{\\mathsf{T}}$. By inspection of our resulting matrix for $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$, we see that $\\Pi^{\\mathrm{gv}}_{12} = \\Pi^{\\mathrm{gv}}_{21} = \\eta_{\\mathrm{g}}(D_{11}-D_{22})$, $\\Pi^{\\mathrm{gv}}_{13} = \\Pi^{\\mathrm{gv}}_{31} = -\\eta_{\\mathrm{g}}D_{23}$, and $\\Pi^{\\mathrm{gv}}_{23} = \\Pi^{\\mathrm{gv}}_{32} = \\eta_{\\mathrm{g}}D_{13}$. The matrix is indeed symmetric. This is guaranteed by its construction, as the sum of any tensor and its transpose is always symmetric.\n\n2.  **Tracelessness**: The trace of a tensor is the sum of its diagonal elements.\n$$\n\\mathrm{Tr}(\\boldsymbol{\\Pi}^{\\mathrm{gv}}) = \\Pi^{\\mathrm{gv}}_{11} + \\Pi^{\\mathrm{gv}}_{22} + \\Pi^{\\mathrm{gv}}_{33} = \\eta_{\\mathrm{g}}(-2D_{12} + 2D_{12} + 0) = 0\n$$\nThe gyroviscous stress tensor is traceless. This property is also general, as $\\mathrm{Tr}(\\mathsf{C}\\cdot\\mathsf{D}) = C_{ij}D_{ji} = \\epsilon_{ikj}\\hat{b}_k D_{ji} = 0$ because $\\epsilon_{ikj}$ is antisymmetric in indices $(i,j)$ while $D_{ji}$ is symmetric in $(j,i)$. The trace of the transpose is the same, so the total trace is zero.\n\n3.  **Projected blocks**: We use the projection operators $\\mathsf{P}_{\\parallel} \\equiv \\hat{\\boldsymbol{b}}\\hat{\\boldsymbol{b}}$ and $\\mathsf{P}_{\\perp} \\equiv \\mathsf{I} - \\hat{\\boldsymbol{b}}\\hat{\\boldsymbol{b}}$. In our basis, their matrix forms are:\n$$\n\\mathsf{P}_{\\parallel} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad \\mathsf{P}_{\\perp} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nWe investigate the four projected blocks of $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$:\n-   **Parallel-parallel block**: $\\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel}$\n    $$\n    \\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n    $$\n    This operation isolates the $(3,3)$ component of $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ and places it in the $(3,3)$ position of a new matrix. Since $\\Pi^{\\mathrm{gv}}_{33}=0$, we find:\n    $$\n    \\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\mathsf{0}\n    $$\n    The parallel-parallel block vanishes. This is equivalent to the scalar relation $\\hat{\\boldsymbol{b}} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\hat{\\boldsymbol{b}} = 0$.\n\n-   **Perpendicular-perpendicular block**: $\\mathsf{P}_{\\perp} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\perp}$. This isolates the upper-left $2 \\times 2$ sub-matrix:\n    $$\n    \\mathsf{P}_{\\perp} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\perp} = \\eta_{\\mathrm{g}}\\begin{pmatrix} -2D_{12} & D_{11}-D_{22} & 0 \\\\ D_{11}-D_{22} & 2D_{12} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n    $$\n    This block is non-zero in general.\n\n-   **Off-diagonal blocks**: $\\mathsf{P}_{\\perp} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel}$ and $\\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\perp}$. These isolate the terms linking the parallel and perpendicular directions.\n    $$\n    \\mathsf{P}_{\\perp} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel} = \\eta_{\\mathrm{g}}\\begin{pmatrix} 0 & 0 & -D_{23} \\\\ 0 & 0 & D_{13} \\\\ 0 & 0 & 0 \\end{pmatrix}\n    $$\n    $$\n    \\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\perp} = \\eta_{\\mathrm{g}}\\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ -D_{23} & D_{13} & 0 \\end{pmatrix}\n    $$\n    These blocks are also non-zero in general.\n\nIn summary, the only projected block of the gyroviscous stress tensor that vanishes is the parallel-parallel block, $\\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel}$.",
            "answer": "$$\n\\boxed{\\eta_{\\mathrm{g}} \\begin{pmatrix} -2D_{12} & D_{11}-D_{22} & -D_{23} \\\\ D_{11}-D_{22} & 2D_{12} & D_{13} \\\\ -D_{23} & D_{13} & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The ultimate test of understanding for a computational scientist is to translate a physical concept into a robust numerical algorithm. This final practice challenges you to do just that by verifying a crucial property of the gyroviscous stress: it is non-dissipative and produces zero viscous heating. You will design and implement a numerical test to confirm that a discrete representation of the gyroviscous operator preserves this fundamental physical law, a critical step in building physically faithful simulation codes for fusion plasmas.",
            "id": "3989281",
            "problem": "You are tasked with designing and implementing a numerical test to verify that a discrete representation of the gyroviscous stress produces zero viscous heating in a strongly magnetized plasma. The physical setting is a two-dimensional periodic domain representing a cross-section perpendicular to a uniform magnetic field, and the mathematical property to be tested is the vanishing of the discrete inner product between the gyroviscous stress tensor and the velocity gradient.\n\nBegin from the fundamental mechanical energy balance for a continuum fluid with stress tensor, where the rate of change of kinetic energy due to a viscous stress contribution is governed by the double contraction between the stress tensor and the velocity gradient. In a strongly magnetized regime, the gyroviscous contribution is a non-dissipative correction associated with Finite Larmor Radius (FLR) effects, and therefore must produce no viscous heating.\n\nYou must:\n\n- Derive a discrete gyroviscous stress operator for a uniform magnetic field aligned with the out-of-plane direction. Let the domain be the plane spanned by the Cartesian coordinates $x$ and $y$, and let the magnetic field unit vector be $\\mathbf{b} = \\hat{\\mathbf{z}}$. Define the $2 \\times 2$ rotation tensor $J$ that rotates any in-plane vector by $90^\\circ$ clockwise as\n$$ J \\equiv \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix} $$\nLet the in-plane velocity be $\\mathbf{v}(x,y) = (v_x(x,y), v_y(x,y))$. Denote the in-plane velocity gradient by the matrix\n$$\nA(x,y) \\equiv \\nabla \\mathbf{v} = \\begin{pmatrix} \\partial_x v_x & \\partial_x v_y \\\\ \\partial_y v_x & \\partial_y v_y \\end{pmatrix}.\n$$\nConstruct a discrete gyroviscous stress tensor $\\Pi^{\\text{gv}}$ as a linear mapping from the discrete gradient $A$ that is symmetric and produces zero discrete viscous heating, meaning that the discrete domain integral of the double contraction $\\Pi^{\\text{gv}} : \\nabla \\mathbf{v}$ must be identically zero for periodic boundary conditions.\n\n- Use a uniform rectangular grid with periodic boundary conditions in both $x$ and $y$. Let $N_x$ and $N_y$ be the numbers of grid points in $x$ and $y$, respectively. The domain extents are $L_x$ and $L_y$. Place grid points at cell centers. Approximate spatial derivatives with second-order centered finite differences under periodic boundary conditions:\n$$\n\\partial_x f\\big|_{i,j} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2 \\Delta x}, \\qquad\n\\partial_y f\\big|_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2 \\Delta y},\n$$\nwhere $\\Delta x = L_x/N_x$ and $\\Delta y = L_y/N_y$, and indices wrap periodically.\n\n- Define the discrete inner product between two $2 \\times 2$ matrices $X$ and $Y$ at a grid point by the Frobenius inner product\n$$\nX : Y \\equiv \\sum_{i=1}^{2} \\sum_{j=1}^{2} X_{ij} Y_{ij},\n$$\nand the discrete viscous heating as the sum over all grid points multiplied by the cell area:\n$$\nH \\equiv \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} \\left( \\Pi^{\\text{gv}}_{ij} : A_{ij} \\right) \\Delta x \\Delta y,\n$$\nwhere $A_{ij}$ and $\\Pi^{\\text{gv}}_{ij}$ denote the $2 \\times 2$ matrices at grid point $(i,j)$.\n\nNon-dimensionalization requirement: Use non-dimensional variables throughout, with $L_x$, $L_y$, $N_x$, $N_y$, and the gyroviscous coefficient $\\mu_{gv}$ provided as dimensionless parameters. Therefore, the computed discrete viscous heating $H$ must be reported as a dimensionless number.\n\nImplement the following test suite. For each case, construct the specified velocity field and compute the discrete viscous heating $H$ using your discrete gyroviscous stress operator. The velocity fields are all periodic in $x$ and $y$:\n\n1. Case 1 (vortex flow, smooth incompressible): $L_x = 2\\pi$, $L_y = 2\\pi$, $N_x = 64$, $N_y = 64$, $\\mu_{gv} = 1.0$, $k_x = 3$, $k_y = 2$. Define\n$$\nv_x(x,y) = \\sin(k_x x)\\cos(k_y y), \\qquad v_y(x,y) = -\\cos(k_x x)\\sin(k_y y).\n$$\n\n2. Case 2 (sine shear): $L_x = 1.0$, $L_y = 1.0$, $N_x = 96$, $N_y = 80$, $\\mu_{gv} = 0.5$, amplitude $S = 1.3$. Define\n$$\nv_x(x,y) = S \\sin\\left( \\frac{2\\pi y}{L_y} \\right), \\qquad v_y(x,y) = 0.\n$$\n\n3. Case 3 (uniform flow): $L_x = 1.0$, $L_y = 1.0$, $N_x = 128$, $N_y = 128$, $\\mu_{gv} = 0.9$, $U_0 = 0.9$, $V_0 = -0.4$. Define\n$$\nv_x(x,y) = U_0, \\qquad v_y(x,y) = V_0.\n$$\n\n4. Case 4 (mixed periodic modes): $L_x = 2.0$, $L_y = 2.0$, $N_x = 48$, $N_y = 60$, $\\mu_{gv} = 1.0$. Define\n$$\nv_x(x,y) = \\sin\\left( \\frac{2\\pi x}{L_x} \\right) + 0.3 \\cos\\left( \\frac{3\\pi y}{L_y} \\right), \\qquad\nv_y(x,y) = \\cos\\left( \\frac{2\\pi y}{L_y} \\right) - 0.2 \\sin\\left( \\frac{3\\pi x}{L_x} \\right).\n$$\n\n5. Case 5 (vortex flow with different wavenumbers): $L_x = 2\\pi$, $L_y = 2\\pi$, $N_x = 32$, $N_y = 48$, $\\mu_{gv} = 2.5$, $k_x = 1$, $k_y = 5$. Define\n$$\nv_x(x,y) = \\sin(k_x x)\\cos(k_y y), \\qquad v_y(x,y) = -\\cos(k_x x)\\sin(k_y y).\n$$\n\n6. Case 6 (coarse grid mixed modes, edge case): $L_x = 2\\pi$, $L_y = 2\\pi$, $N_x = 3$, $N_y = 5$, $\\mu_{gv} = 1.0$. Define\n$$\nv_x(x,y) = \\sin\\left( \\frac{2\\pi x}{L_x} \\right) + 0.3 \\cos\\left( \\frac{3\\pi y}{L_y} \\right), \\qquad\nv_y(x,y) = \\cos\\left( \\frac{2\\pi y}{L_y} \\right) - 0.2 \\sin\\left( \\frac{3\\pi x}{L_x} \\right).\n$$\n\nYour program must compute $H$ for each case and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases given (for example, $[H_1,H_2,\\dots,H_6]$). All computations must be done in non-dimensional units, and each $H$ must be output as a floating-point number.\n\nThe program must be complete and runnable as-is, with no external inputs, using the grid, fields, and parameters specified above. The numerical method must be stable and consistent with the second-order centered differences and periodic boundary conditions described.",
            "solution": "The problem statement is a valid exercise in computational physics, specifically in verifying the non-dissipative property of a discrete gyroviscous stress tensor model in a magnetized plasma fluid. We will first derive the form of the gyroviscous stress tensor that satisfies the required properties and then outline the numerical procedure to verify that it produces zero viscous heating.\n\n**1. Gyroviscous Stress Tensor Formulation**\n\nThe viscous heating rate is given by the double contraction of the stress tensor $\\Pi$ with the velocity gradient tensor $A \\equiv \\nabla \\mathbf{v}$. For a symmetric stress tensor $\\Pi$, the heating rate simplifies to $\\Pi : W$, where $W = \\frac{1}{2}(A + A^T)$ is the symmetric rate-of-strain tensor. The gyroviscous stress, $\\Pi^{\\text{gv}}$, is a known non-dissipative component of the full viscous stress tensor in magnetized plasma. Its defining property is that the heating rate $\\Pi^{\\text{gv}} : \\nabla \\mathbf{v}$ is identically zero.\n\nWe are given an in-plane velocity field $\\mathbf{v} = (v_x, v_y)$ and a uniform magnetic field $\\mathbf{b} = \\hat{\\mathbf{z}}$. The velocity gradient, with components $A_{ij} = \\partial_i v_j$, is the $2 \\times 2$ matrix:\n$$\nA = \\nabla \\mathbf{v} = \\begin{pmatrix} \\partial_x v_x & \\partial_x v_y \\\\ \\partial_y v_x & \\partial_y v_y \\end{pmatrix}\n$$\nThe rate-of-strain tensor is:\n$$\nW = \\frac{1}{2}(A + A^T) = \\frac{1}{2} \\begin{pmatrix} 2 \\partial_x v_x & \\partial_x v_y + \\partial_y v_x \\\\ \\partial_y v_x + \\partial_x v_y & 2 \\partial_y v_y \\end{pmatrix}\n$$\nThe problem requires us to construct a symmetric tensor $\\Pi^{\\text{gv}}$ as a linear map of $A$ such that $\\Pi^{\\text{gv}}:\\nabla\\mathbf{v} = 0$. A standard form for the gyroviscous tensor in two dimensions that satisfies these properties is derived from the rate-of-strain tensor $W$ and the rotation tensor $J$:\n$$\n\\Pi^{\\text{gv}} = \\mu_{gv} (J W - W J)\n$$\nwhere $\\mu_{gv}$ is the gyroviscous coefficient and $J = \\begin{pmatrix} 0 & 1 \\\\ -1 & 0 \\end{pmatrix}$.\n\nLet's verify that this form meets the requirements.\n- **Linearity:** The operations mapping $A \\to W$ and then $W \\to \\Pi^{\\text{gv}}$ are both linear.\n- **Symmetry:** We verify that $(\\Pi^{\\text{gv}})^T = \\Pi^{\\text{gv}}$.\n$$\n(\\Pi^{\\text{gv}})^T = \\mu_{gv} (JW - WJ)^T = \\mu_{gv} ((JW)^T - (WJ)^T) = \\mu_{gv} (W^T J^T - J^T W^T)\n$$\nUsing $W^T = W$ (since $W$ is symmetric) and $J^T = -J$, we get:\n$$\n(\\Pi^{\\text{gv}})^T = \\mu_{gv} (W(-J) - (-J)W) = \\mu_{gv} (-WJ + JW) = \\Pi^{\\text{gv}}\n$$\nThus, $\\Pi^{\\text{gv}}$ is symmetric.\n- **Zero Heating Rate:** The heating rate is $\\Pi^{\\text{gv}} : A$. Since $\\Pi^{\\text{gv}}$ is symmetric, $\\Pi^{\\text{gv}} : A = \\Pi^{\\text{gv}} : W$.\n$$\n\\Pi^{\\text{gv}} : W = \\mu_{gv} (JW - WJ) : W = \\text{Tr}\\left( (JW - WJ) W^T \\right)\n$$\nUsing $W^T = W$ and the linearity of the trace operator:\n$$\n\\Pi^{\\text{gv}} : W = \\mu_{gv} \\left( \\text{Tr}(JWW) - \\text{Tr}(WJW) \\right)\n$$\nBy the cyclic property of the trace, $\\text{Tr}(WJW) = \\text{Tr}(JWW)$. Therefore:\n$$\n\\Pi^{\\text{gv}} : W = \\mu_{gv} (\\text{Tr}(JWW) - \\text{Tr}(JWW)) = 0\n$$\nThis result is purely algebraic and holds for any symmetric matrix $W$. Consequently, if we define the discrete tensors $A_{ij}$ and $\\Pi^{\\text{gv}}_{ij}$ at each grid point $(i, j)$ using the discrete derivative operators, the local heating rate $(\\Pi^{\\text{gv}} : A)_{ij}$ will be zero. The total discrete heating $H$, being a sum over these local zero values, must therefore also be zero, up to floating-point precision errors.\n\nThe explicit components of $\\Pi^{\\text{gv}}$ are:\n$$\n\\Pi^{\\text{gv}} = \\mu_{gv} \\begin{pmatrix}\n\\partial_y v_x + \\partial_x v_y & \\partial_y v_y - \\partial_x v_x \\\\\n\\partial_y v_y - \\partial_x v_x & -(\\partial_y v_x + \\partial_x v_y)\n\\end{pmatrix}\n$$\nSo, we have:\n- $\\Pi^{\\text{gv}}_{xx} = \\mu_{gv} (\\partial_y v_x + \\partial_x v_y)$\n- $\\Pi^{\\text{gv}}_{yy} = -\\mu_{gv} (\\partial_y v_x + \\partial_x v_y) = -\\Pi^{\\text{gv}}_{xx}$\n- $\\Pi^{\\text{gv}}_{xy} = \\Pi^{\\text{gv}}_{yx} = \\mu_{gv} (\\partial_y v_y - \\partial_x v_x)$\n\nThe total discrete viscous heating $H$ is calculated as:\n$$\nH = \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} \\left( \\Pi^{\\text{gv}}_{ij} : A_{ij} \\right) \\Delta x \\Delta y\n$$\nwhere $\\Pi^{\\text{gv}}_{ij} : A_{ij} = \\Pi^{\\text{gv}}_{xx} \\partial_x v_x + \\Pi^{\\text{gv}}_{xy} \\partial_x v_y + \\Pi^{\\text{gv}}_{yx} \\partial_y v_x + \\Pi^{\\text{gv}}_{yy} \\partial_y v_y$ at grid point $(i,j)$.\n\n**2. Numerical Implementation**\n\nThe verification test will be implemented as follows for each test case:\n1.  Define the simulation parameters: $L_x, L_y, N_x, N_y, \\mu_{gv}$, and any velocity field parameters.\n2.  Construct the cell-centered grid. The coordinates are $x_i = i \\cdot \\Delta x$ for $i=0, \\dots, N_x-1$ and $y_j = j \\cdot \\Delta y$ for $j=0, \\dots, N_y-1$, with $\\Delta x = L_x/N_x$ and $\\Delta y = L_y/N_y$.\n3.  Evaluate the velocity components $v_x(x_i, y_j)$ and $v_y(x_i, y_j)$ on the $2$D grid, creating $N_x \\times N_y$ arrays.\n4.  Compute the four components of the velocity gradient tensor, $A_{ij}$, using second-order centered finite differences with periodic wrap-around. For a generic field $f_{i,j}$:\n    $$\n    (\\partial_x f)_{ij} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2 \\Delta x}, \\quad (\\partial_y f)_{ij} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2 \\Delta y}\n    $$\n    The periodic indices can be efficiently handled using array-rolling operations.\n5.  Using the computed discrete derivatives, calculate the three unique components of the symmetric tensor $\\Pi^{\\text{gv}}_{ij}$ at each grid point based on the formulas derived above.\n6.  At each grid point $(i,j)$, compute the double contraction $\\Pi^{\\text{gv}}_{ij} : A_{ij}$.\n7.  Sum the values of the contraction over all grid points and multiply by the cell area $\\Delta x \\Delta y$ to obtain the total discrete viscous heating, $H$.\n\nAs established by the algebraic proof, the result for $H$ in each case is expected to be a value on the order of machine floating-point precision (e.g., $\\approx 10^{-14}$ or smaller), effectively zero. Any significant deviation would indicate an error in the implementation of the discrete operators or the tensor contractions.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the gyroviscous heating problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: vortex flow, smooth incompressible\n        {\n            \"Lx\": 2 * np.pi, \"Ly\": 2 * np.pi, \"Nx\": 64, \"Ny\": 64, \"mu_gv\": 1.0,\n            \"params\": {\"kx\": 3, \"ky\": 2},\n            \"vx_func\": lambda x, y, p: np.sin(p[\"kx\"] * x) * np.cos(p[\"ky\"] * y),\n            \"vy_func\": lambda x, y, p: -np.cos(p[\"kx\"] * x) * np.sin(p[\"ky\"] * y)\n        },\n        # Case 2: sine shear\n        {\n            \"Lx\": 1.0, \"Ly\": 1.0, \"Nx\": 96, \"Ny\": 80, \"mu_gv\": 0.5,\n            \"params\": {\"S\": 1.3},\n            \"vx_func\": lambda x, y, p: p[\"S\"] * np.sin(2 * np.pi * y / 1.0),\n            \"vy_func\": lambda x, y, p: np.zeros_like(x)\n        },\n        # Case 3: uniform flow\n        {\n            \"Lx\": 1.0, \"Ly\": 1.0, \"Nx\": 128, \"Ny\": 128, \"mu_gv\": 0.9,\n            \"params\": {\"U0\": 0.9, \"V0\": -0.4},\n            \"vx_func\": lambda x, y, p: p[\"U0\"] * np.ones_like(x),\n            \"vy_func\": lambda x, y, p: p[\"V0\"] * np.ones_like(x)\n        },\n        # Case 4: mixed periodic modes\n        {\n            \"Lx\": 2.0, \"Ly\": 2.0, \"Nx\": 48, \"Ny\": 60, \"mu_gv\": 1.0,\n            \"params\": {},\n            \"vx_func\": lambda x, y, p: np.sin(2 * np.pi * x / 2.0) + 0.3 * np.cos(3 * np.pi * y / 2.0),\n            \"vy_func\": lambda x, y, p: np.cos(2 * np.pi * y / 2.0) - 0.2 * np.sin(3 * np.pi * x / 2.0)\n        },\n        # Case 5: vortex flow with different wavenumbers\n        {\n            \"Lx\": 2 * np.pi, \"Ly\": 2 * np.pi, \"Nx\": 32, \"Ny\": 48, \"mu_gv\": 2.5,\n            \"params\": {\"kx\": 1, \"ky\": 5},\n            \"vx_func\": lambda x, y, p: np.sin(p[\"kx\"] * x) * np.cos(p[\"ky\"] * y),\n            \"vy_func\": lambda x, y, p: -np.cos(p[\"kx\"] * x) * np.sin(p[\"ky\"] * y)\n        },\n        # Case 6: coarse grid mixed modes, edge case\n        {\n            \"Lx\": 2 * np.pi, \"Ly\": 2 * np.pi, \"Nx\": 3, \"Ny\": 5, \"mu_gv\": 1.0,\n            \"params\": {},\n             \"vx_func\": lambda x, y, p: np.sin(2 * np.pi * x / (2*np.pi)) + 0.3 * np.cos(3 * np.pi * y / (2*np.pi)),\n             \"vy_func\": lambda x, y, p: np.cos(2 * np.pi * y / (2*np.pi)) - 0.2 * np.sin(3 * np.pi * x / (2*np.pi))\n        },\n    ]\n\n    results = []\n    for case_data in test_cases:\n        H = compute_heating(case_data)\n        results.append(H)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_heating(case_data: dict) -> float:\n    \"\"\"\n    Computes the discrete gyroviscous heating H for a given set of parameters.\n\n    Args:\n        case_data: A dictionary containing all necessary parameters for the case.\n\n    Returns:\n        The total discrete viscous heating H as a float.\n    \"\"\"\n    Lx, Ly = case_data[\"Lx\"], case_data[\"Ly\"]\n    Nx, Ny = case_data[\"Nx\"], case_data[\"Ny\"]\n    mu_gv = case_data[\"mu_gv\"]\n    vx_func = case_data[\"vx_func\"]\n    vy_func = case_data[\"vy_func\"]\n    func_params = case_data[\"params\"]\n\n    # 1. Set up grid\n    dx = Lx / Nx\n    dy = Ly / Ny\n    x = np.arange(Nx) * dx\n    y = np.arange(Ny) * dy\n    xx, yy = np.meshgrid(x, y, indexing='ij')\n\n    # 2. Define velocity fields on the grid\n    vx = vx_func(xx, yy, func_params)\n    vy = vy_func(xx, yy, func_params)\n\n    # 3. Compute velocity gradient tensor A = nabla(v)\n    # The gradient components are (A_xx, A_xy, A_yx, A_yy)\n    # A_xx = dvx_dx, A_xy = dvx_dy, A_yx = dvy_dx, A_yy = dvy_dy\n    # Using the problem's definition for A (which is nabla v, components d_i v_j):\n    # A = [[dvx_dx, dvy_dx], [dvx_dy, dvy_dy]] Transposed, so A_ij = d_i v_j\n    # So A11=dvx_dx, A12=dvy_dx, A21=dvx_dy, A22=dvy_dy.\n    # The standard definition is A_ij = d_i v_j, so A = [[dvx_dx, dvx_dy], [dvy_dx, dvy_dy]]. The code will use this standard definition.\n    # The double contraction is invariant to this notational choice as long as Pi is constructed consistently.\n\n    # Use second-order centered differences with periodic boundaries via np.roll\n    # axis=0 corresponds to x, axis=1 corresponds to y due to indexing='ij'\n    dvx_dx = (np.roll(vx, -1, axis=0) - np.roll(vx, 1, axis=0)) / (2 * dx)\n    dvx_dy = (np.roll(vx, -1, axis=1) - np.roll(vx, 1, axis=1)) / (2 * dy)\n    dvy_dx = (np.roll(vy, -1, axis=0) - np.roll(vy, 1, axis=0)) / (2 * dx)\n    dvy_dy = (np.roll(vy, -1, axis=1) - np.roll(vy, 1, axis=1)) / (2 * dy)\n\n    # 4. Compute gyroviscous stress tensor Pi_gv\n    # Pi_gv_xx = mu_gv * (dvx_dy + dvy_dx)\n    # Pi_gv_yy = -Pi_gv_xx\n    # Pi_gv_xy = mu_gv * (dvy_dy - dvx_dx)\n    Pi_gv_xx = mu_gv * (dvx_dy + dvy_dx)\n    Pi_gv_yy = -Pi_gv_xx\n    Pi_gv_xy = mu_gv * (dvy_dy - dvx_dx)\n    Pi_gv_yx = Pi_gv_xy # Tensor is symmetric\n\n    # 5. Compute the double contraction Pi_gv : A at each grid point\n    # A_ij = d_i v_j\n    # A = [[dvx_dx, dvx_dy], [dvy_dx, dvy_dy]]\n    contraction = (\n        Pi_gv_xx * dvx_dx +\n        Pi_gv_xy * dvy_dx +\n        Pi_gv_yx * dvx_dy +\n        Pi_gv_yy * dvy_dy\n    )\n\n    # 6. Compute total heating H by summing over the domain\n    cell_area = dx * dy\n    H = np.sum(contraction) * cell_area\n\n    return H\n\n# This block allows the script to be run directly.\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}