{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础练习开始。通过为一个简单的线性剪切流计算回旋粘性应力张量及其产生的力，你将获得应用Braginskii公式的实践经验。这个练习将具体展示速度梯度如何生成应力张量的各个分量，并揭示在这种常见流动构型中回旋粘性力的一个重要特性。",
            "id": "3989263",
            "problem": "考虑一种适用于 Braginskii 型闭合的低频、强磁化极限下的单离子流体。设磁场是均匀的，$\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$；离子数密度是均匀的，$n = \\text{const}$；离子标量压力是均匀的，$p_i = n T_i = \\text{const}$。考虑一个稳态、二维、不可压缩的流动，其垂直速度为 $\\mathbf{v}_\\perp = S\\,x\\,\\hat{\\mathbf{y}}$，$v_\\parallel = 0$，其中 $S$ 是一个恒定的剪切率。离子的电荷和质量分别为 $q_i > 0$ 和 $m_i$，因此离子回旋频率为 $\\Omega_i = q_i B / m_i$。在强磁化极限和有限拉莫尔半径的一阶近似下，离子的回旋粘性应力张量由标准的非耗散 Braginskii 回旋粘性闭合模型给出\n$$\n\\Pi^{gv} \\;=\\; \\frac{p_i}{\\Omega_i}\\,\\Big( \\hat{\\mathbf{b}} \\times W \\;+\\; (\\hat{\\mathbf{b}} \\times W)^{T} \\Big),\n$$\n其中 $\\hat{\\mathbf{b}} = \\mathbf{B}/B$ 是单位磁场矢量，$T$ 表示转置，$W$ 是对称、无迹的应变率张量\n$$\nW \\;=\\; \\frac{1}{2}\\Big(\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^{T}\\Big) \\;-\\; \\frac{1}{3}\\,(\\nabla\\cdot\\mathbf{v})\\,\\mathbb{I},\n$$\n矢量和二阶张量之间的叉乘按分量定义为 $(\\hat{\\mathbf{b}} \\times W)_{ij} = \\epsilon_{ikl}\\,\\hat{b}_k\\,W_{lj}$，其中 $\\epsilon_{ikl}$ 是 Levi-Civita 符号。从这些定义和给定的流出发，显式计算 $\\Pi^{gv}$ 的所有非零分量以及由此产生的力密度 $\\nabla \\cdot \\Pi^{gv}$。然后，请以符号表达式给出分量 $\\Pi^{gv}_{xx}$，并用 $p_i$、$S$ 和 $\\Omega_i$ 表示。注意，该表达式的量纲应为压力（帕斯卡）。不需要进行数值计算。",
            "solution": "我们一步步地进行计算。\n\n**1. 计算速度梯度张量 ($\\nabla \\mathbf{v}$)**\n在笛卡尔坐标系 $(x, y, z)$ 中，速度矢量为 $\\mathbf{v} = (v_x, v_y, v_z) = (0, Sx, 0)$。速度梯度张量 $(\\nabla \\mathbf{v})_{ij} = \\frac{\\partial v_j}{\\partial x_i}$ 为：\n$$\n\\nabla \\mathbf{v} =\n\\begin{pmatrix}\n\\frac{\\partial v_x}{\\partial x}  \\frac{\\partial v_y}{\\partial x}  \\frac{\\partial v_z}{\\partial x} \\\\\n\\frac{\\partial v_x}{\\partial y}  \\frac{\\partial v_y}{\\partial y}  \\frac{\\partial v_z}{\\partial y} \\\\\n\\frac{\\partial v_x}{\\partial z}  \\frac{\\partial v_y}{\\partial z}  \\frac{\\partial v_z}{\\partial z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  S  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n\n**2. 计算应变率张量 ($W$)**\n速度场的散度为 $\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} + \\frac{\\partial v_z}{\\partial z} = 0 + 0 + 0 = 0$。这证实了流动是不可压缩的，如题目所述。对于不可压缩流，应变率张量简化为：\n$$\nW = \\frac{1}{2}\\Big(\\nabla \\mathbf{v} + (\\nabla \\mathbf{v})^{T}\\Big)\n$$\n速度梯度的转置为：\n$$\n(\\nabla \\mathbf{v})^{T} =\n\\begin{pmatrix}\n0  0  0 \\\\\nS  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n将这些代入 $W$ 的表达式中：\n$$\nW = \\frac{1}{2} \\left( \\begin{pmatrix}\n0  S  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix} + \\begin{pmatrix}\n0  0  0 \\\\\nS  0  0 \\\\\n0  0  0\n\\end{pmatrix} \\right) = \\frac{1}{2}\n\\begin{pmatrix}\n0  S  0 \\\\\nS  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n$W$ 的非零分量是 $W_{xy} = W_{yx} = S/2$。\n\n**3. 计算张量 $\\hat{\\mathbf{b}} \\times W$**\n磁场为 $\\mathbf{B} = B\\,\\hat{\\mathbf{z}}$，因此单位矢量为 $\\hat{\\mathbf{b}} = (0, 0, 1)$。我们使用分量定义 $(\\hat{\\mathbf{b}} \\times W)_{ij} = \\sum_{k,l} \\epsilon_{ikl}\\,\\hat{b}_k\\,W_{lj}$。由于 $\\hat{b}_k = \\delta_{k3}$，这简化为 $(\\hat{\\mathbf{b}} \\times W)_{ij} = \\sum_{l} \\epsilon_{i3l}\\,W_{lj}$。\n\n让我们计算所得张量的分量，我们将其表示为 $A = \\hat{\\mathbf{b}} \\times W$：\n-   $A_{11} = \\epsilon_{13l}W_{l1} = \\epsilon_{132}W_{21} = (-1)(S/2) = -S/2$。\n-   $A_{12} = \\epsilon_{13l}W_{l2} = \\epsilon_{132}W_{22} = (-1)(0) = 0$。\n-   $A_{21} = \\epsilon_{23l}W_{l1} = \\epsilon_{231}W_{11} = (1)(0) = 0$。\n-   $A_{22} = \\epsilon_{23l}W_{l2} = \\epsilon_{231}W_{12} = (1)(S/2) = S/2$。\n所有其他分量 $A_{ij}$ 都为零，因为要么 $\\epsilon_{i3l}$ 为零（例如，如果任何索引重复，或如果 $i=3$），要么 $W$ 的相应分量为零。所得张量为：\n$$\n\\hat{\\mathbf{b}} \\times W =\n\\begin{pmatrix}\n-S/2  0  0 \\\\\n0  S/2  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n\n**4. 计算回旋粘性应力张量 ($\\Pi^{gv}$)**\n$\\hat{\\mathbf{b}} \\times W$ 的转置就是它本身，因为它是一个对角矩阵：\n$$\n(\\hat{\\mathbf{b}} \\times W)^{T} =\n\\begin{pmatrix}\n-S/2  0  0 \\\\\n0  S/2  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n现在，我们可以组装回旋粘性应力张量 $\\Pi^{gv}$：\n$$\n\\Pi^{gv} = \\frac{p_i}{\\Omega_i}\\,\\Big( \\hat{\\mathbf{b}} \\times W + (\\hat{\\mathbf{b}} \\times W)^{T} \\Big)\n$$\n$$\n\\Pi^{gv} = \\frac{p_i}{\\Omega_i} \\left( \\begin{pmatrix}\n-S/2  0  0 \\\\\n0  S/2  0 \\\\\n0  0  0\n\\end{pmatrix} + \\begin{pmatrix}\n-S/2  0  0 \\\\\n0  S/2  0 \\\\\n0  0  0\n\\end{pmatrix} \\right) = \\frac{p_i}{\\Omega_i} \\begin{pmatrix}\n-S  0  0 \\\\\n0  S  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n回旋粘性应力张量的非零分量是：\n$$\n\\Pi^{gv}_{xx} = - \\frac{p_i S}{\\Omega_i}\n$$\n$$\n\\Pi^{gv}_{yy} = \\frac{p_i S}{\\Omega_i}\n$$\n注意该张量是对称的，其迹 $\\text{Tr}(\\Pi^{gv}) = \\Pi^{gv}_{xx} + \\Pi^{gv}_{yy} + \\Pi^{gv}_{zz} = 0$，符合要求。\n\n**5. 计算力密度 ($\\nabla \\cdot \\Pi^{gv}$)**\n回旋粘性力密度是应力张量的散度，$\\mathbf{F}^{gv} = \\nabla \\cdot \\Pi^{gv}$。第 $j$ 个分量由 $(\\nabla \\cdot \\Pi^{gv})_j = \\sum_i \\frac{\\partial \\Pi^{gv}_{ij}}{\\partial x_i}$ 给出。\n$\\Pi^{gv}$ 的分量取决于 $p_i$、$S$ 和 $\\Omega_i$，这些都被指定为常数。因此，$\\Pi^{gv}$ 的所有分量在整个空间中都是常数。常数的偏导数为零。\n$$\n(\\nabla \\cdot \\Pi^{gv})_x = \\frac{\\partial \\Pi^{gv}_{xx}}{\\partial x} + \\frac{\\partial \\Pi^{gv}_{yx}}{\\partial y} + \\frac{\\partial \\Pi^{gv}_{zx}}{\\partial z} = \\frac{\\partial}{\\partial x}\\left(- \\frac{p_i S}{\\Omega_i}\\right) + 0 + 0 = 0\n$$\n$$\n(\\nabla \\cdot \\Pi^{gv})_y = \\frac{\\partial \\Pi^{gv}_{xy}}{\\partial x} + \\frac{\\partial \\Pi^{gv}_{yy}}{\\partial y} + \\frac{\\partial \\Pi^{gv}_{zy}}{\\partial z} = 0 + \\frac{\\partial}{\\partial y}\\left(\\frac{p_i S}{\\Omega_i}\\right) + 0 = 0\n$$\n$$\n(\\nabla \\cdot \\Pi^{gv})_z = \\frac{\\partial \\Pi^{gv}_{xz}}{\\partial x} + \\frac{\\partial \\Pi^{gv}_{yz}}{\\partial y} + \\frac{\\partial \\Pi^{gv}_{zz}}{\\partial z} = 0 + 0 + 0 = 0\n$$\n因此，对于这种流动构型，所产生的回旋粘性力密度为零：\n$$\n\\nabla \\cdot \\Pi^{gv} = \\mathbf{0}\n$$\n\n**6. 最终报告量**\n问题要求用 $p_i$、$S$ 和 $\\Omega_i$ 表示分量 $\\Pi^{gv}_{xx}$。根据我们的计算：\n$$\n\\Pi^{gv}_{xx} = - \\frac{p_i S}{\\Omega_i}\n$$\n$p_i$ 的单位是压力（帕斯卡），而 $S$ 和 $\\Omega_i$ 的单位都是频率（$1/s$）。它们的比值 $S/\\Omega_i$ 是无量纲的，因此最终表达式的单位是压力，正如问题陈述中指出的那样。",
            "answer": "$$\\boxed{- \\frac{p_i S}{\\Omega_i}}$$"
        },
        {
            "introduction": "在具体计算的基础上，我们现在转向更抽象地探索回旋粘性张量的内在结构。这个练习使用与磁场对齐的投影算子来分解张量，从而优雅地揭示其对称性、无迹性以及特定的块结构等基本性质。理解这些结构性质对于掌握其在等离子体流体模型中的作用至关重要。",
            "id": "3989287",
            "problem": "考虑一个单组分、强磁化、准中性等离子体，其由流体速度场 $\\boldsymbol{u}(\\boldsymbol{x},t)$ 和均匀磁场方向 $\\hat{\\boldsymbol{b}}(\\boldsymbol{x},t)$ 描述，其中 $|\\hat{\\boldsymbol{b}}|=1$。令应变率张量为对称张量 $\\mathsf{S} \\equiv \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}}\\right)$，并定义其无迹部分为 $\\mathsf{D} \\equiv \\mathsf{S} - \\frac{1}{3}\\,(\\nabla \\cdot \\boldsymbol{u})\\,\\mathsf{I}$。与 $\\hat{\\boldsymbol{b}}$ 相关的单位向量叉积算子 $\\mathsf{C}$ 由分量 $C_{ij} \\equiv \\epsilon_{ikj}\\,\\hat{b}_{k}$ 定义，因此对于任意向量 $\\boldsymbol{a}$，有 $(\\mathsf{C}\\cdot \\boldsymbol{a})_{i} = (\\hat{\\boldsymbol{b}} \\times \\boldsymbol{a})_{i}$。考虑应力张量的领头阶有限拉莫尔半径回旋粘性闭合，\n$$\n\\boldsymbol{\\Pi}^{\\mathrm{gv}} \\equiv \\eta_{\\mathrm{g}}\\left(\\mathsf{C}\\cdot \\mathsf{D} + (\\mathsf{C}\\cdot \\mathsf{D})^{\\mathsf{T}}\\right),\n$$\n其中 $\\eta_{\\mathrm{g}}$ 是一个常数回旋粘性系数，$(\\cdot)^{\\mathsf{T}}$ 表示转置。令 $\\mathsf{P}_{\\parallel} \\equiv \\hat{\\boldsymbol{b}}\\hat{\\boldsymbol{b}}$ 和 $\\mathsf{P}_{\\perp} \\equiv \\mathsf{I} - \\hat{\\boldsymbol{b}}\\hat{\\boldsymbol{b}}$ 分别表示相对于 $\\hat{\\boldsymbol{b}}$ 的平行和垂直投影算子。\n\n在一个与 $\\hat{\\boldsymbol{b}}$ 对齐的笛卡尔基底 $\\{\\hat{\\boldsymbol{e}}_{1}, \\hat{\\boldsymbol{e}}_{2}, \\hat{\\boldsymbol{e}}_{3}\\}$（其中 $\\hat{\\boldsymbol{e}}_{3}=\\hat{\\boldsymbol{b}}$）中，使用 $\\mathsf{P}_{\\parallel}$ 和 $\\mathsf{P}_{\\perp}$ 将 $\\mathsf{D}$ 分解为其平行和垂直块，并计算 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 的所有独立分量。在这个对齐的基底中，用其独立分量将对称无迹张量 $\\mathsf{D}$ 参数化为\n$$\n\\mathsf{D}=\\begin{pmatrix}\nD_{11}  D_{12}  D_{13}\\\\\nD_{12}  D_{22}  D_{23}\\\\\nD_{13}  D_{23}  D_{33}\n\\end{pmatrix}, \\quad \\text{其中} \\quad D_{33}=-(D_{11}+D_{22}).\n$$\n将 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 的最终答案表示为一个单一的 $3\\times 3$ 矩阵，以 $\\eta_{\\mathrm{g}}$ 和分量 $D_{11}$、$D_{22}$、$D_{12}$、$D_{13}$ 和 $D_{23}$ 表示。然后，使用投影算子 $\\mathsf{P}_{\\parallel}$ 和 $\\mathsf{P}_{\\perp}$，从你的结果中验证 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 是对称且无迹的，并确定哪些投影块为零。不需要数值计算。请以符号形式提供矩阵元素。最终答案必须是 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 的完整矩阵，以闭合形式的解析表达式给出。",
            "solution": "问题要求在一个特定的坐标系中计算回旋粘性应力张量 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 并验证其性质。我们得到定义：\n$$\n\\boldsymbol{\\Pi}^{\\mathrm{gv}} \\equiv \\eta_{\\mathrm{g}}\\left(\\mathsf{C}\\cdot \\mathsf{D} + (\\mathsf{C}\\cdot \\mathsf{D})^{\\mathsf{T}}\\right)\n$$\n其中 $\\mathsf{D}$ 是无迹应变率张量，$\\mathsf{C}$ 是一个与磁场方向 $\\hat{\\boldsymbol{b}}$ 相关的算子。\n\n我们在一个笛卡尔基底 $\\{\\hat{\\boldsymbol{e}}_{1}, \\hat{\\boldsymbol{e}}_{2}, \\hat{\\boldsymbol{e}}_{3}\\}$ 中进行计算，其中磁场与第三轴对齐，所以 $\\hat{\\boldsymbol{b}} = \\hat{\\boldsymbol{e}}_{3}$。在这个基底中，向量 $\\hat{\\boldsymbol{b}}$ 的分量是 $\\hat{b}_k = \\delta_{k3}$。\n\n算子 $\\mathsf{C}$ 的分量为 $C_{ij} = \\epsilon_{ikj}\\,\\hat{b}_{k}$。代入 $\\hat{b}_k = \\delta_{k3}$，我们得到 $C_{ij} = \\epsilon_{i3j}$。我们可以计算代表 $\\mathsf{C}$ 的矩阵的分量：\n$C_{11} = \\epsilon_{131} = 0$, $C_{12} = \\epsilon_{132} = -1$, $C_{13} = \\epsilon_{133} = 0$。\n$C_{21} = \\epsilon_{231} = 1$, $C_{22} = \\epsilon_{232} = 0$, $C_{23} = \\epsilon_{233} = 0$。\n$C_{31} = \\epsilon_{331} = 0$, $C_{32} = \\epsilon_{332} = 0$, $C_{33} = \\epsilon_{333} = 0$。\n因此，$\\mathsf{C}$ 在这个基底中的矩阵表示为：\n$$\n\\mathsf{C} = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n无迹应变率张量 $\\mathsf{D}$ 以其分量形式给出，它是对称的（$D_{ij}=D_{ji}$）且无迹的（$D_{11}+D_{22}+D_{33}=0$）：\n$$\n\\mathsf{D} = \\begin{pmatrix} D_{11}  D_{12}  D_{13} \\\\ D_{12}  D_{22}  D_{23} \\\\ D_{13}  D_{23}  D_{33} \\end{pmatrix}\n$$\n其中我们使用给定的关系式 $D_{33} = -(D_{11}+D_{22})$。\n\n首先，我们通过矩阵乘法计算乘积 $\\mathsf{C}\\cdot\\mathsf{D}$：\n$$\n\\mathsf{C}\\cdot\\mathsf{D} = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} D_{11}  D_{12}  D_{13} \\\\ D_{12}  D_{22}  D_{23} \\\\ D_{13}  D_{23}  D_{33} \\end{pmatrix} = \\begin{pmatrix} -D_{12}  -D_{22}  -D_{23} \\\\ D_{11}  D_{12}  D_{13} \\\\ 0  0  0 \\end{pmatrix}\n$$\n接下来，我们求这个结果的转置 $(\\mathsf{C}\\cdot\\mathsf{D})^{\\mathsf{T}}$：\n$$\n(\\mathsf{C}\\cdot\\mathsf{D})^{\\mathsf{T}} = \\begin{pmatrix} -D_{12}  D_{11}  0 \\\\ -D_{22}  D_{12}  0 \\\\ -D_{23}  D_{13}  0 \\end{pmatrix}\n$$\n现在，我们将这两个矩阵相加，以求得 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 定义中括号内的表达式：\n$$\n\\mathsf{C}\\cdot\\mathsf{D} + (\\mathsf{C}\\cdot\\mathsf{D})^{\\mathsf{T}} = \\begin{pmatrix} -D_{12}  -D_{22}  -D_{23} \\\\ D_{11}  D_{12}  D_{13} \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} -D_{12}  D_{11}  0 \\\\ -D_{22}  D_{12}  0 \\\\ -D_{23}  D_{13}  0 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -2D_{12}  D_{11}-D_{22}  -D_{23} \\\\ D_{11}-D_{22}  2D_{12}  D_{13} \\\\ -D_{23}  D_{13}  0 \\end{pmatrix}\n$$\n最后，我们乘以回旋粘性系数 $\\eta_{\\mathrm{g}}$ 来获得回旋粘性应力张量 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 的完整表达式：\n$$\n\\boldsymbol{\\Pi}^{\\mathrm{gv}} = \\eta_{\\mathrm{g}} \\begin{pmatrix} -2D_{12}  D_{11}-D_{22}  -D_{23} \\\\ D_{11}-D_{22}  2D_{12}  D_{13} \\\\ -D_{23}  D_{13}  0 \\end{pmatrix}\n$$\n这是用 $\\mathsf{D}$ 的独立分量表示的 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 所要求的矩阵表达式。\n\n接下来，我们验证 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 的性质。\n1.  **对称性**：如果一个张量 $\\mathsf{T}$ 满足 $\\mathsf{T} = \\mathsf{T}^{\\mathsf{T}}$，则它是对称的。通过检查我们得到的 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 矩阵，我们看到 $\\Pi^{\\mathrm{gv}}_{12} = \\Pi^{\\mathrm{gv}}_{21} = \\eta_{\\mathrm{g}}(D_{11}-D_{22})$，$\\Pi^{\\mathrm{gv}}_{13} = \\Pi^{\\mathrm{gv}}_{31} = -\\eta_{\\mathrm{g}}D_{23}$，以及 $\\Pi^{\\mathrm{gv}}_{23} = \\Pi^{\\mathrm{gv}}_{32} = \\eta_{\\mathrm{g}}D_{13}$。该矩阵确实是对称的。这由其构造所保证，因为任何张量与其转置之和总是对称的。\n\n2.  **无迹性**：张量的迹是其对角元素之和。\n$$\n\\mathrm{Tr}(\\boldsymbol{\\Pi}^{\\mathrm{gv}}) = \\Pi^{\\mathrm{gv}}_{11} + \\Pi^{\\mathrm{gv}}_{22} + \\Pi^{\\mathrm{gv}}_{33} = \\eta_{\\mathrm{g}}(-2D_{12} + 2D_{12} + 0) = 0\n$$\n回旋粘性应力张量是无迹的。这个性质也是普适的，因为 $\\mathrm{Tr}(\\mathsf{C}\\cdot\\mathsf{D}) = C_{ij}D_{ji} = \\epsilon_{ikj}\\hat{b}_k D_{ji} = 0$，这是因为 $\\epsilon_{ikj}$ 在索引 $(i,j)$ 上是反对称的，而 $D_{ji}$ 在 $(j,i)$ 上是对称的。转置的迹是相同的，所以总迹为零。\n\n3.  **投影块**：我们使用投影算子 $\\mathsf{P}_{\\parallel} \\equiv \\hat{\\boldsymbol{b}}\\hat{\\boldsymbol{b}}$ 和 $\\mathsf{P}_{\\perp} \\equiv \\mathsf{I} - \\hat{\\boldsymbol{b}}\\hat{\\boldsymbol{b}}$。在我们的基底中，它们的矩阵形式是：\n$$\n\\mathsf{P}_{\\parallel} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad \\mathsf{P}_{\\perp} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n我们研究 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 的四个投影块：\n-   **平行-平行块**：$\\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel}$\n    $$\n    \\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix} \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix}\n    $$\n    这个操作分离出 $\\boldsymbol{\\Pi}^{\\mathrm{gv}}$ 的 $(3,3)$ 分量，并将其置于一个新矩阵的 $(3,3)$ 位置。由于 $\\Pi^{\\mathrm{gv}}_{33}=0$，我们发现：\n    $$\n    \\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\mathsf{0}\n    $$\n    平行-平行块为零。这等价于标量关系 $\\hat{\\boldsymbol{b}} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\hat{\\boldsymbol{b}} = 0$。\n\n-   **垂直-垂直块**：$\\mathsf{P}_{\\perp} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\perp}$。这分离出左上角的 $2 \\times 2$ 子矩阵：\n    $$\n    \\mathsf{P}_{\\perp} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\perp} = \\eta_{\\mathrm{g}}\\begin{pmatrix} -2D_{12}  D_{11}-D_{22}  0 \\\\ D_{11}-D_{22}  2D_{12}  0 \\\\ 0  0  0 \\end{pmatrix}\n    $$\n    这个块通常不为零。\n\n-   **非对角块**：$\\mathsf{P}_{\\perp} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel}$ 和 $\\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\perp}$。这些分离出连接平行和垂直方向的项。\n    $$\n    \\mathsf{P}_{\\perp} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel} = \\eta_{\\mathrm{g}}\\begin{pmatrix} 0  0  -D_{23} \\\\ 0  0  D_{13} \\\\ 0  0  0 \\end{pmatrix}\n    $$\n    $$\n    \\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\perp} = \\eta_{\\mathrm{g}}\\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ -D_{23}  D_{13}  0 \\end{pmatrix}\n    $$\n    这些块通常也不为零。\n\n总而言之，回旋粘性应力张量中唯一为零的投影块是平行-平行块，即 $\\mathsf{P}_{\\parallel} \\cdot \\boldsymbol{\\Pi}^{\\mathrm{gv}} \\cdot \\mathsf{P}_{\\parallel}$。",
            "answer": "$$\n\\boxed{\\eta_{\\mathrm{g}} \\begin{pmatrix} -2D_{12}  D_{11}-D_{22}  -D_{23} \\\\ D_{11}-D_{22}  2D_{12}  D_{13} \\\\ -D_{23}  D_{13}  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "我们的最后一个实践练习将理论与计算实现联系起来，这是计算聚变科学中的一项关键技能。你将设计一个数值测试，以验证回旋粘性应力最重要的特性之一：它是非耗散的，不对粘性加热产生贡献。这个练习展示了如何确保模拟中的离散算子能正确地捕捉到其背后物理学的基本守恒性质。",
            "id": "3989281",
            "problem": "你的任务是设计并实现一个数值测试，以验证在强磁化等离子体中，回旋粘性应力的离散表示产生的粘性加热为零。物理背景是一个二维周期性区域，代表垂直于均匀磁场的横截面。待测试的数学性质是回旋粘性应力张量与速度梯度之间离散内积的消失。\n\n从带有应力张量的连续流体的基本机械能平衡方程出发，其中由粘性应力贡献引起的动能变化率由应力张量和速度梯度的双点积（double contraction）决定。在强磁化状态下，回旋粘性贡献是与有限拉莫尔半径（FLR）效应相关的非耗散修正项，因此必须不产生任何粘性加热。\n\n你必须：\n\n- 推导一个离散的回旋粘性应力算子，适用于沿平面外方向的均匀磁场。设区域为由笛卡尔坐标 $x$ 和 $y$ 张成的平面，磁场单位向量为 $\\mathbf{b} = \\hat{\\mathbf{z}}$。定义一个 $2 \\times 2$ 旋转张量 $J$，它将任何平面内向量顺时针旋转 $90^\\circ$，其形式为\n$$\nJ \\equiv \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}.\n$$\n设平面内速度为 $\\mathbf{v}(x,y) = (v_x(x,y), v_y(x,y))$。用矩阵表示平面内速度梯度\n$$\nA(x,y) \\equiv \\nabla \\mathbf{v} = \\begin{pmatrix} \\partial_x v_x  \\partial_y v_x \\\\ \\partial_x v_y  \\partial_y v_y \\end{pmatrix}.\n$$\n构建一个离散的回旋粘性应力张量 $\\Pi^{gv}$，作为离散梯度 $A$ 的线性映射。该张量需满足对称性，并产生零离散粘性加热，即在周期性边界条件下，双点积 $\\Pi^{gv} : \\nabla \\mathbf{v}$ 的离散区域积分必须恒等于零。\n\n- 在 $x$ 和 $y$ 方向上均使用带有周期性边界条件的均匀矩形网格。设 $N_x$ 和 $N_y$ 分别为 $x$ 和 $y$ 方向的网格点数。区域范围为 $L_x$ 和 $L_y$。将网格点置于单元中心。在周期性边界条件下，使用二阶中心有限差分来近似空间导数：\n$$\n\\partial_x f\\big|_{i,j} \\approx \\frac{f_{i+1,j} - f_{i-1,j}}{2 \\Delta x}, \\qquad\n\\partial_y f\\big|_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2 \\Delta y},\n$$\n其中 $\\Delta x = L_x/N_x$ 和 $\\Delta y = L_y/N_y$，且索引周期性循环。\n\n- 将两个 $2 \\times 2$ 矩阵 $X$ 和 $Y$ 在一个网格点上的离散内积定义为 Frobenius 内积\n$$\nX : Y \\equiv \\sum_{i=1}^{2} \\sum_{j=1}^{2} X_{ij} Y_{ij},\n$$\n并将离散粘性加热定义为所有网格点上的总和乘以单元面积：\n$$\nH \\equiv \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} \\left( \\Pi^{gv}_{ij} : A_{ij} \\right) \\Delta x \\Delta y,\n$$\n其中 $A_{ij}$ 和 $\\Pi^{gv}_{ij}$ 表示在网格点 $(i,j)$ 处的 $2 \\times 2$ 矩阵。\n\n无量纲化要求：在整个计算过程中使用无量纲变量，$L_x$、$L_y$、$N_x$、$N_y$ 和回旋粘性系数 $\\mu_{gv}$ 均作为无量纲参数提供。因此，计算出的离散粘性加热 $H$ 必须以无量纲数的形式报告。\n\n实现以下测试套件。对于每种情况，构建指定的速度场，并使用你的离散回旋粘性应力算子计算离散粘性加热 $H$。所有速度场在 $x$ 和 $y$ 方向上都是周期性的：\n\n1. 情况1（涡流，光滑不可压缩）：$L_x = 2\\pi$, $L_y = 2\\pi$, $N_x = 64$, $N_y = 64$, $\\mu_{gv} = 1.0$, $k_x = 3$, $k_y = 2$。定义\n$$\nv_x(x,y) = \\sin(k_x x)\\cos(k_y y), \\qquad v_y(x,y) = -\\cos(k_x x)\\sin(k_y y).\n$$\n\n2. 情况2（正弦剪切流）：$L_x = 1.0$, $L_y = 1.0$, $N_x = 96$, $N_y = 80$, $\\mu_{gv} = 0.5$，振幅 $S = 1.3$。定义\n$$\nv_x(x,y) = S \\sin\\left( \\frac{2\\pi y}{L_y} \\right), \\qquad v_y(x,y) = 0.\n$$\n\n3. 情况3（均匀流）：$L_x = 1.0$, $L_y = 1.0$, $N_x = 128$, $N_y = 128$, $\\mu_{gv} = 0.9$, $U_0 = 0.9$, $V_0 = -0.4$。定义\n$$\nv_x(x,y) = U_0, \\qquad v_y(x,y) = V_0.\n$$\n\n4. 情况4（混合周期模）：$L_x = 2.0$, $L_y = 2.0$, $N_x = 48$, $N_y = 60$, $\\mu_{gv} = 1.0$。定义\n$$\nv_x(x,y) = \\sin\\left( \\frac{2\\pi x}{L_x} \\right) + 0.3 \\cos\\left( \\frac{3\\pi y}{L_y} \\right), \\qquad\nv_y(x,y) = \\cos\\left( \\frac{2\\pi y}{L_y} \\right) - 0.2 \\sin\\left( \\frac{3\\pi x}{L_x} \\right).\n$$\n\n5. 情况5（不同波数的涡流）：$L_x = 2\\pi$, $L_y = 2\\pi$, $N_x = 32$, $N_y = 48$, $\\mu_{gv} = 2.5$, $k_x = 1$, $k_y = 5$。定义\n$$\nv_x(x,y) = \\sin(k_x x)\\cos(k_y y), \\qquad v_y(x,y) = -\\cos(k_x x)\\sin(k_y y).\n$$\n\n6. 情况6（粗网格混合模，边界情况）：$L_x = 2\\pi$, $L_y = 2\\pi$, $N_x = 3$, $N_y = 5$, $\\mu_{gv} = 1.0$。定义\n$$\nv_x(x,y) = \\sin\\left( \\frac{2\\pi x}{L_x} \\right) + 0.3 \\cos\\left( \\frac{3\\pi y}{L_y} \\right), \\qquad\nv_y(x,y) = \\cos\\left( \\frac{2\\pi y}{L_y} \\right) - 0.2 \\sin\\left( \\frac{3\\pi x}{L_x} \\right).\n$$\n\n你的程序必须计算每种情况下的 $H$，并生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按给定情况的顺序排列（例如，$[H_1,H_2,\\dots,H_6]$）。所有计算都必须以无量纲单位进行，并且每个 $H$ 都必须以浮点数形式输出。\n\n程序必须是完整且可直接运行的，无需外部输入，并使用上面指定的网格、场和参数。数值方法必须稳定，并与所描述的二阶中心差分和周期性边界条件一致。",
            "solution": "该练习的目标是数值验证回旋粘性应力的非耗散性质。为此，我们首先推导一个满足所需性质的回旋粘性应力张量的形式，然后概述用于验证其产生零粘性加热的数值程序。\n\n**1. 回旋粘性应力张量公式**\n\n粘性加热率由应力张量 $\\Pi$ 与速度梯度张量 $A \\equiv \\nabla \\mathbf{v}$ 的双点积给出。对于对称应力张量 $\\Pi$，加热率简化为 $\\Pi : W$，其中 $W = \\frac{1}{2}(A + A^T)$ 是对称的应变率张量。回旋粘性应力 $\\Pi^{gv}$ 是一个非耗散分量，其定义性质是加热率 $\\Pi^{gv} : \\nabla \\mathbf{v}$ 恒等于零。\n\n在二维情况下，满足这些性质的回旋粘性张量的一个标准形式是从应变率张量 $W$ 和旋转张量 $J$ 推导出来的：\n$$\n\\Pi^{gv} = \\mu_{gv} (J W - W J)\n$$\n其中 $\\mu_{gv}$ 是回旋粘性系数，且 $J = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$。\n\n这种形式满足所有要求：\n- **线性**：将 $A$ 映射到 $W$ 以及将 $W$ 映射到 $\\Pi^{gv}$ 的操作都是线性的。\n- **对称性**：$(\\Pi^{gv})^T = \\mu_{gv} (JW - WJ)^T = \\mu_{gv} (W^T J^T - J^T W^T) = \\mu_{gv} (W(-J) - (-J)W) = \\Pi^{gv}$。\n- **零加热率**：由于 $\\Pi^{gv}$ 是对称的，加热率 $\\Pi^{gv} : A = \\Pi^{gv} : W$。使用迹的循环性质 ($\\text{Tr}(XYZ) = \\text{Tr}(ZXY)$)，我们得到：\n$$\n\\Pi^{gv} : W = \\text{Tr}( (JW-WJ)^T W ) = \\text{Tr}( (JW-WJ) W ) = \\mu_{gv} (\\text{Tr}(JWW) - \\text{Tr}(WJW)) = 0\n$$\n这个结果是纯代数的，对任何对称矩阵 $W$ 都成立。因此，如果我们使用离散导数算子在每个网格点 $(i, j)$ 定义离散张量 $A_{ij}$ 和 $\\Pi^{gv}_{ij}$，则局部加热率 $(\\Pi^{gv} : A)_{ij}$ 将精确为零。总的离散加热 $H$ 是对这些局部零值的求和，因此也必须为零，误差在浮点精度范围内。\n\n$\\Pi^{gv}$ 的显式分量为：\n$$\n\\Pi^{gv} = \\mu_{gv} \\begin{pmatrix}\n\\partial_y v_x + \\partial_x v_y   \\partial_y v_y - \\partial_x v_x \\\\\n\\partial_y v_y - \\partial_x v_x   -(\\partial_y v_x + \\partial_x v_y)\n\\end{pmatrix}\n$$\n\n**2. 数值实现**\n\n对于每个测试用例，验证测试将按以下步骤实现：\n1.  定义模拟参数并构建单元中心网格。\n2.  在二维网格上评估速度分量 $v_x$ 和 $v_y$。\n3.  使用二阶中心有限差分和周期性环绕计算速度梯度张量 $A_{ij}$ 的四个分量。\n4.  使用计算出的离散导数，根据上面推导的公式，在每个网格点上计算对称张量 $\\Pi^{gv}_{ij}$ 的分量。\n5.  在每个网格点 $(i,j)$，计算双点积 $\\Pi^{gv}_{ij} : A_{ij}$。\n6.  将所有网格点上的双点积值求和，并乘以单元面积 $\\Delta x \\Delta y$ 以获得总的离散粘性加热 $H$。\n\n正如代数证明所确立的，每种情况下 $H$ 的计算结果都应是一个在机器浮点精度范围内的数值，实际上为零。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the gyroviscous heating problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: vortex flow, smooth incompressible\n        {\n            \"Lx\": 2 * np.pi, \"Ly\": 2 * np.pi, \"Nx\": 64, \"Ny\": 64, \"mu_gv\": 1.0,\n            \"vx_func\": lambda x, y: np.sin(3 * x) * np.cos(2 * y),\n            \"vy_func\": lambda x, y: -np.cos(3 * x) * np.sin(2 * y)\n        },\n        # Case 2: sine shear\n        {\n            \"Lx\": 1.0, \"Ly\": 1.0, \"Nx\": 96, \"Ny\": 80, \"mu_gv\": 0.5,\n            \"vx_func\": lambda x, y: 1.3 * np.sin(2 * np.pi * y / 1.0),\n            \"vy_func\": lambda x, y: np.zeros_like(x)\n        },\n        # Case 3: uniform flow\n        {\n            \"Lx\": 1.0, \"Ly\": 1.0, \"Nx\": 128, \"Ny\": 128, \"mu_gv\": 0.9,\n            \"vx_func\": lambda x, y: 0.9 * np.ones_like(x),\n            \"vy_func\": lambda x, y: -0.4 * np.ones_like(x)\n        },\n        # Case 4: mixed periodic modes\n        {\n            \"Lx\": 2.0, \"Ly\": 2.0, \"Nx\": 48, \"Ny\": 60, \"mu_gv\": 1.0,\n            \"vx_func\": lambda x, y: np.sin(2 * np.pi * x / 2.0) + 0.3 * np.cos(3 * np.pi * y / 2.0),\n            \"vy_func\": lambda x, y: np.cos(2 * np.pi * y / 2.0) - 0.2 * np.sin(3 * np.pi * x / 2.0)\n        },\n        # Case 5: vortex flow with different wavenumbers\n        {\n            \"Lx\": 2 * np.pi, \"Ly\": 2 * np.pi, \"Nx\": 32, \"Ny\": 48, \"mu_gv\": 2.5,\n            \"vx_func\": lambda x, y: np.sin(1 * x) * np.cos(5 * y),\n            \"vy_func\": lambda x, y: -np.cos(1 * x) * np.sin(5 * y)\n        },\n        # Case 6: coarse grid mixed modes, edge case\n        {\n            \"Lx\": 2 * np.pi, \"Ly\": 2 * np.pi, \"Nx\": 3, \"Ny\": 5, \"mu_gv\": 1.0,\n             \"vx_func\": lambda x, y: np.sin(2 * np.pi * x / (2 * np.pi)) + 0.3 * np.cos(3 * np.pi * y / (2 * np.pi)),\n             \"vy_func\": lambda x, y: np.cos(2 * np.pi * y / (2 * np.pi)) - 0.2 * np.sin(3 * np.pi * x / (2 * np.pi))\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        H = compute_heating(case)\n        results.append(H)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_heating(params: dict) - float:\n    \"\"\"\n    Computes the discrete gyroviscous heating H for a given set of parameters.\n\n    Args:\n        params: A dictionary containing all necessary parameters for the case.\n                Keys: Lx, Ly, Nx, Ny, mu_gv, vx_func, vy_func.\n\n    Returns:\n        The total discrete viscous heating H as a float.\n    \"\"\"\n    Lx, Ly = params[\"Lx\"], params[\"Ly\"]\n    Nx, Ny = params[\"Nx\"], params[\"Ny\"]\n    mu_gv = params[\"mu_gv\"]\n    vx_func = params[\"vx_func\"]\n    vy_func = params[\"vy_func\"]\n\n    # 1. Set up grid\n    dx = Lx / Nx\n    dy = Ly / Ny\n    x = np.arange(Nx) * dx\n    y = np.arange(Ny) * dy\n    xx, yy = np.meshgrid(x, y, indexing='ij')\n\n    # 2. Define velocity fields on the grid\n    vx = vx_func(xx, yy)\n    vy = vy_func(xx, yy)\n\n    # 3. Compute velocity gradient tensor A = nabla(v)\n    # Use second-order centered differences with periodic boundaries via np.roll\n    # axis=0 corresponds to x, axis=1 corresponds to y due to indexing='ij'\n    dvx_dx = (np.roll(vx, -1, axis=0) - np.roll(vx, 1, axis=0)) / (2 * dx)\n    dvx_dy = (np.roll(vx, -1, axis=1) - np.roll(vx, 1, axis=1)) / (2 * dy)\n    dvy_dx = (np.roll(vy, -1, axis=0) - np.roll(vy, 1, axis=0)) / (2 * dx)\n    dvy_dy = (np.roll(vy, -1, axis=1) - np.roll(vy, 1, axis=1)) / (2 * dy)\n\n    # 4. Compute gyroviscous stress tensor Pi_gv\n    # Pi_gv_xx = mu_gv * (dvx_dy + dvy_dx)\n    # Pi_gv_yy = -Pi_gv_xx\n    # Pi_gv_xy = mu_gv * (dvy_dy - dvx_dx)\n    Pi_gv_xx = mu_gv * (dvx_dy + dvy_dx)\n    Pi_gv_yy = -Pi_gv_xx\n    Pi_gv_xy = mu_gv * (dvy_dy - dvx_dx)\n    Pi_gv_yx = Pi_gv_xy # Tensor is symmetric\n\n    # 5. Compute the double contraction Pi_gv : A at each grid point\n    contraction = (\n        Pi_gv_xx * dvx_dx +\n        Pi_gv_xy * dvx_dy +\n        Pi_gv_yx * dvy_dx +  # or Pi_gv_xy * dvy_dx\n        Pi_gv_yy * dvy_dy\n    )\n\n    # 6. Compute total heating H by summing over the domain\n    cell_area = dx * dy\n    H = np.sum(contraction) * cell_area\n\n    return H\n\n# This block allows the script to be run directly.\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}