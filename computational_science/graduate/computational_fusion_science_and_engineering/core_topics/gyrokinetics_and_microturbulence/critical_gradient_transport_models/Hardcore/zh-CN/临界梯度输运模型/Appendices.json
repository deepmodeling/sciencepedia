{
    "hands_on_practices": [
        {
            "introduction": "临界梯度模型的核心是描述输运如何从新经典水平（低于临界值）急剧转变为湍流主导水平（高于临界值）的函数形式。一个理想的模型不仅应在物理上合理，还应在数学上“行为良好”，以便于解析分析和数值模拟。本练习旨在通过构建一个平滑的临界通量模型，来探索一个好的模型应具备的基本物理属性，例如正定性、单调性和正确的渐近行为 。",
            "id": "3962253",
            "problem": "考虑一个环形磁约束等离子体，其中的径向离子热通量由菲克定律 $q_{i}=-n_{i}\\chi\\,\\nabla T_{i}$ 建模，其中 $n_{i}$ 是离子密度，$T_{i}$ 是离子温度，$\\chi$ 是有效离子热扩散系数。在存在诸如离子温度梯度（ITG）驱动的湍流等微观不稳定性时，人们广泛观察到湍流输运表现出临界梯度行为：在无量纲梯度 $R/L_{T}$ 的一个阈值以下，湍流输运可忽略不计；而在该阈值以上，输运则表现为刚性且快速增加。这里 $R$ 是大半径，温度梯度标长 $L_{T}$ 定义为 $L_{T}\\equiv -T_{i}/(\\mathrm{d}T_{i}/\\mathrm{d}r)$。\n\n从这些基本思想和分解式 $\\chi=\\chi_{\\mathrm{neo}}+\\chi_{\\mathrm{turb}}$ 出发（其中 $\\chi_{\\mathrm{neo}}$ 是新经典基线，$\\chi_{\\mathrm{turb}}$ 是湍流驱动的贡献），提出并论证一个形如下式的平滑“临界通量定律”：\n$$\n\\chi\\!\\left(\\frac{R}{L_{T}}\\right)=\\chi_{\\mathrm{neo}}+\\alpha\\,\\ln\\!\\left\\{1+\\exp\\!\\left[\\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta}\\right]\\right\\},\n$$\n其中 $\\alpha0$ 设定了湍流幅度标度，$\\Delta0$ 设定了跃迁的平滑度（起始宽度），$R/L_{T,\\mathrm{crit}}$ 是临界梯度。您的论证应植根于上述原理，包括物理单调性、正定性、远低于阈值时与可忽略湍流的渐近一致性，以及阈值附近的有限刚度。\n\n然后，计算 $\\chi(R/L_{T})$ 关于小参数\n$$\nx\\equiv \\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta},\n$$\n的近阈值展开式，保留到并包括 $x^{4}$ 阶的项。用 $\\chi_{\\mathrm{neo}}$、$\\alpha$、$\\Delta$、$R/L_{T}$ 和 $R/L_{T,\\mathrm{crit}}$ 表示最终的展开式。最终答案必须是单一的解析表达式。您无需提供数值，因此不需要四舍五入说明。假设 $\\chi_{\\mathrm{neo}}$ 和 $\\alpha$ 的单位是热扩散系数，而 $\\Delta$ 是无量纲的；您无需在最终表达式中报告单位。",
            "solution": "解答按要求分为两部分：首先，论证所提出的热扩散系数 $\\chi$ 模型的物理性质；其次，计算其在临界梯度阈值附近的泰勒级数展开。\n\n为清晰起见，我们引入无量纲梯度变量 $g \\equiv R/L_{T}$ 及其临界值 $g_{\\mathrm{crit}} \\equiv R/L_{T,\\mathrm{crit}}$。展开参数为 $x \\equiv (g - g_{\\mathrm{crit}})/\\Delta$。热扩散系数的模型可以写为：\n$$\n\\chi(x) = \\chi_{\\mathrm{neo}} + \\alpha \\ln(1 + \\exp(x))\n$$\n\n**第1部分：模型形式的论证**\n\n我们验证该模型遵循指定的物理原理。\n\n1.  **正定性**：物理上的扩散系数必须为正。已知 $\\alpha  0$。新经典扩散系数 $\\chi_{\\mathrm{neo}}$ 本身也为正。自然对数的宗量是 $1 + \\exp(x)$。由于对于所有实数 $x$，$\\exp(x)  0$，因此 $1 + \\exp(x)  1$。大于1的数的自然对数为正，所以 $\\ln(1 + \\exp(x))  0$。因此，$\\chi(x) = \\chi_{\\mathrm{neo}} + (\\text{正项})$，确保 $\\chi(x)$ 始终为正且大于 $\\chi_{\\mathrm{neo}}$。\n\n2.  **渐近一致性**：模型必须在远低于和远高于临界梯度的极限情况下再现预期的物理行为。\n    -   **远低于阈值 ($g \\ll g_{\\mathrm{crit}}$)**：在此极限下，指数的宗量 $x = (g - g_{\\mathrm{crit}})/\\Delta$ 变为大的负数，即 $x \\to -\\infty$。因此，$\\exp(x) \\to 0$。模型变为：\n        $$\n        \\lim_{x \\to -\\infty} \\chi(x) = \\chi_{\\mathrm{neo}} + \\alpha \\ln(1 + 0) = \\chi_{\\mathrm{neo}}\n        $$\n        这正确地恢复了基线新经典输运，此时湍流贡献 $\\chi_{\\mathrm{turb}}$ 变得可以忽略不计，正如物理上所要求的那样。\n    -   **远高于阈值 ($g \\gg g_{\\mathrm{crit}}$)**：在此极限下，$x$ 变为大的正数，$x \\to +\\infty$。对于大的 $x$，$1 + \\exp(x) \\approx \\exp(x)$。模型变为：\n        $$\n        \\lim_{x \\to +\\infty} \\chi(x) \\approx \\chi_{\\mathrm{neo}} + \\alpha \\ln(\\exp(x)) = \\chi_{\\mathrm{neo}} + \\alpha x = \\chi_{\\mathrm{neo}} + \\frac{\\alpha}{\\Delta}(g - g_{\\mathrm{crit}})\n        $$\n        这表明，在远高于阈值时，湍流扩散系数随超额梯度 $g - g_{\\mathrm{crit}}$ 线性增长。这种线性增长代表了“刚性”输运区，在该区域，梯度驱动的微小增加会导致输运的大幅增加。刚度，定义为斜率 $\\mathrm{d}\\chi/\\mathrm{d}g$，趋近于常数值 $\\alpha/\\Delta$。\n\n3.  **物理单调性**：扩散系数 $\\chi$ 应该是梯度驱动 $g$ 的一个非减函数。我们通过计算 $\\chi$ 对 $g$ 的一阶导数来检验这一点：\n    $$\n    \\frac{\\mathrm{d}\\chi}{\\mathrm{d}g} = \\frac{\\mathrm{d}}{\\mathrm{d}g} \\left[ \\chi_{\\mathrm{neo}} + \\alpha \\ln\\left(1 + \\exp\\left(\\frac{g - g_{\\mathrm{crit}}}{\\Delta}\\right)\\right) \\right]\n    $$\n    使用链式法则：\n    $$\n    \\frac{\\mathrm{d}\\chi}{\\mathrm{d}g} = \\alpha \\cdot \\frac{1}{1 + \\exp\\left(\\frac{g - g_{\\mathrm{crit}}}{\\Delta}\\right)} \\cdot \\exp\\left(\\frac{g - g_{\\mathrm{crit}}}{\\Delta}\\right) \\cdot \\frac{1}{\\Delta} = \\frac{\\alpha}{\\Delta} \\frac{\\exp(x)}{1 + \\exp(x)}\n    $$\n    由于 $\\alpha  0$，$\\Delta  0$，且项 $\\exp(x)/(1 + \\exp(x))$ 始终为正，我们得到对于所有 $g$，$\\mathrm{d}\\chi/\\mathrm{d}g  0$。因此，该模型是严格单调递增的，这在物理上是正确的。\n\n4.  **阈值附近的有限刚度**：模型应提供从低输运区到高输运区的平滑过渡，这意味着在阈值 $g = g_{\\mathrm{crit}}$（或 $x=0$）处具有有限的刚度。阈值处的刚度是导数在该点的值：\n    $$\n    \\left. \\frac{\\mathrm{d}\\chi}{\\mathrm{d}g} \\right|_{g=g_{\\mathrm{crit}}} = \\left. \\frac{\\alpha}{\\Delta} \\frac{\\exp(x)}{1 + \\exp(x)} \\right|_{x=0} = \\frac{\\alpha}{\\Delta} \\frac{\\exp(0)}{1 + \\exp(0)} = \\frac{\\alpha}{\\Delta} \\frac{1}{2} = \\frac{\\alpha}{2\\Delta}\n    $$\n    阈值处的刚度是有限且为正的。参数 $\\Delta$ 控制了这种过渡的尖锐度：较小的 $\\Delta$ 对应于更刚性、更突然的湍流起始。这种平滑的开启是该模型的一个关键特征，将其与简单的阶跃函数区分开来。\n\n**第2部分：近阈值展开**\n\n我们被要求计算 $\\chi(x)$ 在 $x=0$ 附近直到 $x$ 四阶的泰勒级数展开。展开式由下式给出：\n$$\n\\chi(x) \\approx \\chi(0) + \\chi'(0)x + \\frac{\\chi''(0)}{2!}x^2 + \\frac{\\chi'''(0)}{3!}x^3 + \\frac{\\chi^{(4)}(0)}{4!}x^4\n$$\n设 $f(x) = \\ln(1 + \\exp(x))$。则 $\\chi(x) = \\chi_{\\mathrm{neo}} + \\alpha f(x)$。我们需要求出 $f(x)$ 在 $x=0$ 处的各阶导数。\n\n-   $f(x) = \\ln(1 + \\exp(x))$\n    $f(0) = \\ln(1 + \\exp(0)) = \\ln(2)$\n\n-   $f'(x) = \\frac{\\exp(x)}{1 + \\exp(x)}$\n    $f'(0) = \\frac{\\exp(0)}{1 + \\exp(0)} = \\frac{1}{2}$\n\n-   $f''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\exp(x)}{1 + \\exp(x)} \\right) = \\frac{\\exp(x)(1 + \\exp(x)) - \\exp(x)\\exp(x)}{(1 + \\exp(x))^2} = \\frac{\\exp(x)}{(1 + \\exp(x))^2}$\n    $f''(0) = \\frac{\\exp(0)}{(1 + \\exp(0))^2} = \\frac{1}{2^2} = \\frac{1}{4}$\n\n-   $f'''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\exp(x)}{(1 + \\exp(x))^2} \\right) = \\frac{\\exp(x)(1+\\exp(x))^2 - \\exp(x) \\cdot 2(1+\\exp(x))\\exp(x)}{(1 + \\exp(x))^4}$\n    $ = \\frac{\\exp(x)(1+\\exp(x)) - 2\\exp(2x)}{(1 + \\exp(x))^3} = \\frac{\\exp(x) - \\exp(2x)}{(1 + \\exp(x))^3}$\n    $f'''(0) = \\frac{\\exp(0) - \\exp(0)}{(1 + \\exp(0))^3} = \\frac{1 - 1}{8} = 0$\n\n-   $f^{(4)}(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\exp(x) - \\exp(2x)}{(1 + \\exp(x))^3} \\right)$\n    分子求导：$\\exp(x) - 2\\exp(2x)$。分母求导：$3(1 + \\exp(x))^2 \\exp(x)$。\n    使用商法则并在 $x=0$ 处求值：\n    $f^{(4)}(0) = \\frac{(\\exp(0)-2\\exp(0))(1+\\exp(0))^3 - (\\exp(0)-\\exp(0)) \\cdot 3(1+\\exp(0))^2\\exp(0)}{(1+\\exp(0))^6}$\n    $f^{(4)}(0) = \\frac{(1-2)(1+1)^3 - 0}{(1+1)^6} = \\frac{-1 \\cdot 8}{64} = -\\frac{8}{64} = -\\frac{1}{8}$\n\n现在我们组合 $f(x)$ 的泰勒级数：\n$$\nf(x) \\approx f(0) + f'(0)x + \\frac{f''(0)}{2!}x^2 + \\frac{f'''(0)}{3!}x^3 + \\frac{f^{(4)}(0)}{4!}x^4\n$$\n$$\nf(x) \\approx \\ln(2) + \\frac{1}{2}x + \\frac{1/4}{2}x^2 + \\frac{0}{6}x^3 + \\frac{-1/8}{24}x^4\n$$\n$$\nf(x) \\approx \\ln(2) + \\frac{1}{2}x + \\frac{1}{8}x^2 - \\frac{1}{192}x^4\n$$\n最后，我们将此结果代回 $\\chi(x)$ 的表达式，并用 $x$ 的定义替换 $x$：\n$$\n\\chi\\left(\\frac{R}{L_{T}}\\right) \\approx \\chi_{\\mathrm{neo}} + \\alpha \\left( \\ln(2) + \\frac{1}{2}x + \\frac{1}{8}x^2 - \\frac{1}{192}x^4 \\right)\n$$\n代入 $x = \\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta}$:\n$$\n\\chi\\left(\\frac{R}{L_{T}}\\right) \\approx \\chi_{\\mathrm{neo}} + \\alpha\\ln(2) + \\frac{\\alpha}{2\\Delta}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right) + \\frac{\\alpha}{8\\Delta^2}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^2 - \\frac{\\alpha}{192\\Delta^4}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^4\n$$\n这就是所求的热扩散系数直到四阶的近阈值展开。",
            "answer": "$$\n\\boxed{\\chi_{\\mathrm{neo}} + \\alpha\\ln(2) + \\frac{\\alpha}{2\\Delta}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right) + \\frac{\\alpha}{8\\Delta^2}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^2 - \\frac{\\alpha}{192\\Delta^4}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^4}\n$$"
        },
        {
            "introduction": "在真实的聚变等离子体中，临界梯度并不是一个固定的常数，而是由不稳定性驱动与各种阻尼机制之间复杂的竞争决定的。一个关键的阻尼机制是平衡径向电场引起的$E \\times B$流动剪切，它能有效地“撕裂”湍流涡旋，从而抑制湍流输运。本练习将通过一个简化的谱模型，带你深入理解流动剪切是如何与离子温度梯度（ITG）不稳定性竞争，从而提高湍流发生的阈值，即产生所谓的“非线性阈值” 。",
            "id": "3962265",
            "problem": "在磁约束聚变等离子体的临界梯度输运模型中，一个核心问题是平衡静电$E \\times B$流剪切如何改变由离子温度梯度驱动的湍流输运的起始。考虑一个简化的离子温度梯度 (ITG) 模线性增长的谱模型，其中对于固定的副法向波数 $k_y$（归一化到离子声回旋半径的倒数 $\\rho_s^{-1}$，其中 $\\rho_s = c_s / \\Omega_i$，$c_s$ 是离子声速，$\\Omega_i$ 是离子回旋频率），线性增长率由下式表示：\n$$\n\\gamma_{L}(k_y) = a \\left[\\frac{R}{L_T} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}\\right] k_y - b\\, k_y^{3},\n$$\n其中 $a0$ 且 $b0$，$R$ 是大半径，$L_T$ 是离子温度标长，定义为 $L_T^{-1} = -\\frac{1}{T_i}\\frac{dT_i}{dr}$。假设$E \\times B$流剪切引入一个与 $k_y$ 无关的退相干率 $\\gamma_{E}$，它通过剪切湍流涡与线性驱动相竞争，使得净增长率为 $\\Gamma(k_y) = \\gamma_{L}(k_y) - \\gamma_{E}$。在临界梯度输运模型中，当 $\\Gamma(k_y)$ 对 $k_y$ 的上确界等于零时，达到非线性阈值 $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}}$；而线性阈值 $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$ 则由 $\\gamma_L(k_y)$ 对 $k_y$ 的上确界等于零的条件定义。\n\n从这些定义和给定的谱模型出发，从机理上解释流剪切退相干如何与线性 ITG 驱动竞争以设定非线性阈值，然后推导偏移量\n$$\n\\Delta\\!\\left(\\frac{R}{L_T}\\right) \\equiv \\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}\n$$\n的解析表达式。\n对于 $a = 0.8$，$b = 0.2$ 和 $\\gamma_E = 0.05$ 的情况，数值计算该偏移量，其中所有速率都归一化到 $c_s/R$，$k_y$ 归一化到 $\\rho_s^{-1}$。将您得到的 $\\Delta\\!\\left(\\frac{R}{L_T}\\right)$ 的最终结果表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "### 解答\n该问题要求对$E \\times B$流剪切引起的临界离子温度梯度的上升提供机理上的解释和定量的推导。\n\n首先，我们分析其机理。线性增长率 $\\gamma_L(k_y)$ 模拟了 ITG 不稳定性的驱动与短波长处的稳定效应之间的平衡。$a \\left[\\frac{R}{L_T} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}\\right] k_y$ 项表示不稳定性驱动，它正比于归一化温度梯度 $\\frac{R}{L_T}$ 超出临界线性阈值 $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$ 的量。对于 $\\frac{R}{L_T}  \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$，该项为正，驱动不稳定性。$-b k_y^3$ 项表示一个在大的 $k_y$（短波长）处占主导地位的阻尼机制，确保增长率在有限的波数处有最大值。线性阈值 $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$ 是梯度的一个特定值，在该值下，最大可能的线性增长率 $\\sup_{k_y} \\gamma_L(k_y)$ 恰好为零。\n\n$E \\times B$流剪切引入了一个额外的稳定效应，由退相干率 $\\gamma_E$ 表示。该速率在所有波数上起到均匀的抑制作用，将净增长率降低为 $\\Gamma(k_y) = \\gamma_L(k_y) - \\gamma_E$。为了使湍流发展，至少有一个模的净增长率必须为正，即 $\\sup_{k_y} \\Gamma(k_y)  0$。这要求峰值线性增长率 $\\sup_{k_y} \\gamma_L(k_y)$ 大于剪切抑制率 $\\gamma_E$。由于在线性阈值 $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$ 处峰值线性增长率为零，因此必须进一步增加温度梯度 $\\frac{R}{L_T}$ 以产生足以克服 $\\gamma_E$ 的线性驱动。非线性阈值 $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}}$ 是梯度的一个值，在该值处峰值净增长率恰好为零，即 $\\sup_{k_y} \\Gamma(k_y) = 0$。这意味着在此阈值下，$\\sup_{k_y} \\gamma_L(k_y) = \\gamma_E$。差值 $\\Delta\\!\\left(\\frac{R}{L_T}\\right)$ 表示临界梯度必须比线性阈值增加多少才能克服流剪切的抑制作用。\n\n现在，我们推导 $\\Delta\\!\\left(\\frac{R}{L_T}\\right) = \\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$ 的解析表达式。\n非线性阈值由条件 $\\sup_{k_y} \\Gamma(k_y) = 0$ 定义。我们必须在 $\\frac{R}{L_T} = \\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}}$ 时评估此条件。让我们使用 $\\Delta\\!\\left(\\frac{R}{L_T}\\right)$ 的定义重写 $\\Gamma(k_y)$：\n$$\n\\Gamma(k_y) = a \\left[\\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}\\right] k_y - b k_y^3 - \\gamma_E = a \\Delta\\!\\left(\\frac{R}{L_T}\\right) k_y - b k_y^3 - \\gamma_E\n$$\n为了找到 $\\Gamma(k_y)$ 关于 $k_y$ 的上确界，我们通过将其导数设为零来找到使其最大化的波数 $k_{y, \\text{max}}$：\n$$\n\\frac{d\\Gamma}{dk_y} = a \\Delta\\!\\left(\\frac{R}{L_T}\\right) - 3 b k_y^2 = 0\n$$\n解出 $k_y^2$ 得到最大值的位置：\n$$\nk_{y, \\text{max}}^2 = \\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3b}\n$$\n由于 $a, b  0$，如果 $\\Delta\\!\\left(\\frac{R}{L_T}\\right)  0$，则存在 $k_{y, \\text{max}}$ 的实数解，这是符合预期的。\n$$\nk_{y, \\text{max}} = \\sqrt{\\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3b}}\n$$\n上确界的值是 $\\Gamma(k_{y, \\text{max}})$。将 $k_{y, \\text{max}}$ 代回 $\\Gamma(k_y)$ 的表达式中：\n$$\n\\sup_{k_y} \\Gamma(k_y) = a \\Delta\\!\\left(\\frac{R}{L_T}\\right) k_{y, \\text{max}} - b k_{y, \\text{max}}^3 - \\gamma_E\n$$\n我们可以化简前两项：\n$$\na \\Delta\\!\\left(\\frac{R}{L_T}\\right) k_{y, \\text{max}} - b k_{y, \\text{max}}^3 = k_{y, \\text{max}} \\left( a \\Delta\\!\\left(\\frac{R}{L_T}\\right) - b k_{y, \\text{max}}^2 \\right)\n$$\n代入 $k_{y, \\text{max}}^2 = \\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3b}$：\n$$\n= k_{y, \\text{max}} \\left( a \\Delta\\!\\left(\\frac{R}{L_T}\\right) - b \\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3b} \\right) = k_{y, \\text{max}} \\left( a \\Delta\\!\\left(\\frac{R}{L_T}\\right) - \\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3} \\right) = \\frac{2}{3} a \\Delta\\!\\left(\\frac{R}{L_T}\\right) k_{y, \\text{max}}\n$$\n再次代入 $k_{y, \\text{max}}$ 的表达式：\n$$\n= \\frac{2}{3} a \\Delta\\!\\left(\\frac{R}{L_T}\\right) \\sqrt{\\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3b}} = \\frac{2a\\sqrt{a}}{3\\sqrt{3b}} \\left(\\Delta\\!\\left(\\frac{R}{L_T}\\right)\\right)^{3/2}\n$$\n非线性阈值的定义是 $\\sup_{k_y} \\Gamma(k_y) = 0$，因此：\n$$\n\\frac{2a\\sqrt{a}}{3\\sqrt{3b}} \\left(\\Delta\\!\\left(\\frac{R}{L_T}\\right)\\right)^{3/2} - \\gamma_E = 0\n$$\n现在，我们求解 $\\Delta\\!\\left(\\frac{R}{L_T}\\right)$：\n$$\n\\left(\\Delta\\!\\left(\\frac{R}{L_T}\\right)\\right)^{3/2} = \\gamma_E \\frac{3\\sqrt{3b}}{2a\\sqrt{a}}\n$$\n为了分离出 $\\Delta\\!\\left(\\frac{R}{L_T}\\right)$，我们将两边平方，然后取立方根（或取 $2/3$ 次幂）：\n$$\n\\left(\\Delta\\!\\left(\\frac{R}{L_T}\\right)\\right)^3 = \\left( \\gamma_E \\frac{3\\sqrt{3b}}{2a\\sqrt{a}} \\right)^2 = \\gamma_E^2 \\frac{9(3b)}{4a^2(a)} = \\frac{27 b \\gamma_E^2}{4 a^3}\n$$\n取立方根得到最终的解析表达式：\n$$\n\\Delta\\!\\left(\\frac{R}{L_T}\\right) = \\left( \\frac{27 b \\gamma_E^2}{4 a^3} \\right)^{1/3}\n$$\n最后，我们使用给定的数值 $a = 0.8$、$b = 0.2$ 和 $\\gamma_E = 0.05$ 对此表达式进行数值计算。\n$$\n\\Delta\\!\\left(\\frac{R}{L_T}\\right) = \\left( \\frac{27 (0.2) (0.05)^2}{4 (0.8)^3} \\right)^{1/3}\n$$\n我们来计算立方根内的参数：\n分子：$27 \\times 0.2 \\times (0.05)^2 = 5.4 \\times 0.0025 = 0.0135$。\n分母：$4 \\times (0.8)^3 = 4 \\times 0.512 = 2.048$。\n比值为：\n$$\n\\frac{0.0135}{2.048} \\approx 0.006591796875\n$$\n或者，使用分数计算：$a = 4/5$，$b = 1/5$，$\\gamma_E = 1/20$。\n$$\n\\frac{27 b \\gamma_E^2}{4 a^3} = \\frac{27 \\left(\\frac{1}{5}\\right) \\left(\\frac{1}{20}\\right)^2}{4 \\left(\\frac{4}{5}\\right)^3} = \\frac{\\frac{27}{5 \\times 400}}{\\frac{4 \\times 64}{125}} = \\frac{\\frac{27}{2000}}{\\frac{256}{125}} = \\frac{27}{2000} \\times \\frac{125}{256} = \\frac{27}{16 \\times 125} \\times \\frac{125}{256} = \\frac{27}{16 \\times 256} = \\frac{3^3}{2^4 \\times 2^8} = \\frac{3^3}{2^{12}}\n$$\n现在，我们取立方根：\n$$\n\\Delta\\!\\left(\\frac{R}{L_T}\\right) = \\left( \\frac{3^3}{2^{12}} \\right)^{1/3} = \\frac{(3^3)^{1/3}}{(2^{12})^{1/3}} = \\frac{3^1}{2^4} = \\frac{3}{16}\n$$\n将这个精确分数转换为小数得到：\n$$\n\\Delta\\!\\left(\\frac{R}{L_T}\\right) = 0.1875\n$$\n这个值已经有四位有效数字，因此无需进一步四舍五入。",
            "answer": "$$\\boxed{0.1875}$$"
        },
        {
            "introduction": "将连续的输运方程转化为可在计算机上求解的离散形式，是计算聚变科学的核心任务。临界梯度模型由于其固有的“刚性”（即输运系数对梯度变化的剧烈响应），给数值求解带来了独特的挑战。本练习将指导你使用有限体积法对一个非线性热扩散方程进行离散化，并推导其显式时间推进格式的稳定性判据，让你亲身体验从理论模型到稳定数值算法的全过程 。",
            "id": "3962212",
            "problem": "考虑一个一维平板几何，其空间坐标为 $x \\in [0,L]$，并将其均匀地进行有限体积划分为 $N$ 个宽度为 $\\Delta x = L/N$ 的控制体积。令 $T(x,t)$ 表示以千电子伏特（keV）为单位的离子温度场。非线性湍流热传导算子被建模为 $\\nabla \\cdot \\left(\\chi\\left(\\frac{R}{L_T}\\right) \\nabla T\\right)$ 的形式，其中热扩散系数 $\\chi$ 通过临界梯度模型依赖于无量纲梯度比 $\\frac{R}{L_T}$。这里，$R$ 是托卡马克大半径，单位为米；$L_T$ 是局域温度梯度标长，定义为 $L_T = -\\frac{T}{\\partial T/\\partial x}$，单位为米。其演化方程为\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(\\chi\\left(\\frac{R}{L_T}\\right)\\frac{\\partial T}{\\partial x}\\right).\n$$\n边界条件为：$x=0$ 处为对称边界（零通量，即 $\\frac{\\partial T}{\\partial x}(0,t)=0$），$x=L$ 处为固定边界温度（狄利克雷条件 $T(L,t) = T_{\\text{edge}}$）。假设所有温度始终保持严格为正。\n\n有限体积离散化的构建方法如下：\n- 网格中心为 $x_i = \\left(i+\\frac{1}{2}\\right)\\Delta x$，其中 $i=0,1,\\dots,N-1$；网格面为 $x_{i+\\frac{1}{2}} = (i+1)\\Delta x$，其中 $i=0,1,\\dots,N-1$；左边界位于 $x_{-\\frac{1}{2}}=0$，右边界位于 $x_{N-\\frac{1}{2}}=L$。\n- 通过中心平均定义网格面温度：对于内部网格面 $i=0,\\dots,N-2$，有 $T_{i+\\frac{1}{2}} = \\frac{1}{2}\\left(T_{i+1}+T_i\\right)$。对于左边界网格面，使用 $T_{-\\frac{1}{2}} = T_0$；对于右边界网格面，使用 $T_{N-\\frac{1}{2}} = \\frac{1}{2}\\left(T_{N-1}+T_{\\text{edge}}\\right)$。\n- 定义网格面梯度：对于内部网格面 $i=0,\\dots,N-2$，有 $\\left(\\frac{\\partial T}{\\partial x}\\right)_{i+\\frac{1}{2}} = \\frac{T_{i+1}-T_i}{\\Delta x}$；对于左边界，有 $\\left(\\frac{\\partial T}{\\partial x}\\right)_{-\\frac{1}{2}}=0$；对于右边界，有 $\\left(\\frac{\\partial T}{\\partial x}\\right)_{N-\\frac{1}{2}} = \\frac{T_{\\text{edge}}-T_{N-1}}{\\Delta x}$。\n- 定义网格面处的无量纲梯度比为\n$$\ng_{i+\\frac{1}{2}} = \\frac{R}{L_T}\\bigg|_{i+\\frac{1}{2}} = -\\,\\frac{R}{T_{i+\\frac{1}{2}}}\\left(\\frac{\\partial T}{\\partial x}\\right)_{i+\\frac{1}{2}}.\n$$\n- 定义扩散系数的临界梯度模型为\n$$\n\\chi(g) = \\chi_{\\min} + \\chi_{\\text{amp}} \\,\\max\\!\\left(0,\\,g - g_c\\right)^{\\alpha},\n$$\n其中 $\\chi_{\\min}$ 和 $\\chi_{\\text{amp}}$ 的单位为 $\\text{m}^2/\\text{s}$，$g_c$ 为无量纲量，$\\alpha \\geq 1$ 也为无量纲量。\n- 网格单元 $i$ 的有限体积半离散算子必须实现为\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x}\\left[-F_{i+\\frac{1}{2}} + F_{i-\\frac{1}{2}}\\right],\n$$\n其中网格面热通量为\n$$\nF_{i+\\frac{1}{2}} = -\\,\\chi\\!\\left(g_{i+\\frac{1}{2}}\\right)\\left(\\frac{\\partial T}{\\partial x}\\right)_{i+\\frac{1}{2}}.\n$$\n\n任务 1 (推导)：从控制体积内的能量守恒和通量的定义出发，推导有限体积离散化的显式前向欧拉时间步进更新公式，该公式应以网格中心温度 $T_i^n$ 和网格面扩散系数 $\\chi_{i+\\frac{1}{2}}$ 表示。使用标准的单调性和正定性论证，推导出一个充分稳定性判据，其形式为\n$$\n\\Delta t \\le \\min_i \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}+\\chi_{i-\\frac{1}{2}}},\n$$\n该判据保证前向欧拉格式对任何网格单元 $i$ 都不会产生非物理的过冲。将 $\\Delta t$ 以秒为单位表示。\n\n任务 2 (实现)：实现一个完整的程序，该程序能够：\n- 根据给定的参数，构建有限体积的网格面、网格面温度、网格面梯度、网格面 $g_{i+\\frac{1}{2}}$ 和网格面扩散系数 $\\chi_{i+\\frac{1}{2}}$。\n- 对所有 $i$ 计算每个网格单元的稳定性分母 $\\chi_{i+\\frac{1}{2}}+\\chi_{i-\\frac{1}{2}}$，并考虑边界网格面（由于对称性，$\\chi_{-\\frac{1}{2}}=0$）。\n- 根据上述稳定性判据，返回允许的最大显式时间步长 $\\Delta t_{\\max}$，结果为浮点数，单位为秒。\n\n使用以下测试套件。对于所有情况，使用 $L=1.0$ 米，$N=128$ 个网格单元，$R=3.0$ 米，$\\chi_{\\min}=0.30$ $\\text{m}^2/\\text{s}$，$\\chi_{\\text{amp}}=1.50$ $\\text{m}^2/\\text{s}$，$g_c=6.0$ 和 $\\alpha=1$。定义边界温度 $T_{\\text{edge}}=1.0$ keV，并通过计算 $T(x_i)$ 来定义以网格中心为准的初始分布 $T_i$：\n\n- 情况 1 (平缓的二次方分布)：$T(x) = T_{\\text{edge}} + \\left(T_{\\text{core}}-T_{\\text{edge}}\\right)\\left(1-\\frac{x}{L}\\right)^2$，其中 $T_{\\text{core}} = 15.0$ keV。\n- 情况 2 (更陡峭的线性分布)：$T(x) = T_{\\text{edge}} + \\left(T_{\\text{core}}-T_{\\text{edge}}\\right)\\left(1-\\frac{x}{L}\\right)$，其中 $T_{\\text{core}} = 20.0$ keV。\n- 情况 3 (近乎平坦的分布)：$T(x) = T_{\\text{edge}} + \\left(T_{\\text{core}}-T_{\\text{edge}}\\right)\\left(1-\\frac{x}{L}\\right)^2$，其中 $T_{\\text{core}} = 2.0$ keV。\n- 情况 4 (均匀分布)：$T(x) \\equiv T_{\\text{edge}}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，\"[result1,result2,result3,result4]\"）。列表中的每个元素必须是对应情况的 $\\Delta t_{\\max}$，以秒为单位的浮点数表示。不应打印任何其他文本。\n\n所有物理量必须按其指定单位处理，最终输出必须以秒为单位。",
            "solution": "### 解决方案\n\n按要求，解决方案分为两部分：理论推导和实现方法说明。\n\n**任务 1：前向欧拉更新和稳定性判据的推导**\n\n控制体积 $i$ 中温度 $T_i$ 的半离散有限体积方程由守恒律给出：\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x}\\left(F_{i-\\frac{1}{2}} - F_{i+\\frac{1}{2}}\\right)\n$$\n其中 $F_{i\\pm\\frac{1}{2}}$ 是网格单元两侧面上的热通量。通量定义为 $F = -\\chi \\frac{\\partial T}{\\partial x}$。代入通量的离散表达式，我们得到：\n$$\nF_{i+\\frac{1}{2}} = -\\chi_{i+\\frac{1}{2}} \\left(\\frac{T_{i+1} - T_i}{\\Delta x}\\right)\n$$\n$$\nF_{i-\\frac{1}{2}} = -\\chi_{i-\\frac{1}{2}} \\left(\\frac{T_i - T_{i-1}}{\\Delta x}\\right)\n$$\n其中 $\\chi_{i\\pm\\frac{1}{2}}$ 是在相应网格面上计算的热扩散系数。将这些代入守恒律方程：\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x} \\left[ -\\chi_{i-\\frac{1}{2}} \\left(\\frac{T_i - T_{i-1}}{\\Delta x}\\right) - \\left(-\\chi_{i+\\frac{1}{2}} \\left(\\frac{T_{i+1} - T_i}{\\Delta x}\\right)\\right) \\right]\n$$\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x^2} \\left[ \\chi_{i+\\frac{1}{2}}(T_{i+1} - T_i) + \\chi_{i-\\frac{1}{2}}(T_{i-1} - T_i) \\right]\n$$\n现在，我们应用前向欧拉方法进行时间积分。令 $T_i^n$ 为时间步 $n$ 时网格单元 $i$ 的温度。时间导数近似为 $\\frac{d T_i}{dt} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}$。右侧所有项均在时间步 $n$ 进行计算。\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{1}{\\Delta x^2} \\left[ \\chi_{i+\\frac{1}{2}}^n(T_{i+1}^n - T_i^n) + \\chi_{i-\\frac{1}{2}}^n(T_{i-1}^n - T_i^n) \\right]\n$$\n求解 $T_i^{n+1}$，得到显式更新公式：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\Delta t}{\\Delta x^2} \\left[ \\chi_{i+\\frac{1}{2}}^n(T_{i+1}^n - T_i^n) + \\chi_{i-\\frac{1}{2}}^n(T_{i-1}^n - T_i^n) \\right]\n$$\n为了推导稳定性判据，我们重新整理更新公式，将 $T_i^{n+1}$ 表示为时间步 $n$ 时各温度的线性组合：\n$$\nT_i^{n+1} = T_{i-1}^n \\left(\\frac{\\Delta t}{\\Delta x^2} \\chi_{i-\\frac{1}{2}}^n\\right) + T_{i+1}^n \\left(\\frac{\\Delta t}{\\Delta x^2} \\chi_{i+\\frac{1}{2}}^n\\right) + T_i^n \\left(1 - \\frac{\\Delta t}{\\Delta x^2}(\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n)\\right)\n$$\n为保证格式是单调的（即不产生新的极值，这在给定 $T^n  0$ 的情况下能防止非物理振荡和负温度），一个充分条件是 $T_i^{n+1}$ 线性组合中的所有系数都为非负。\n扩散系数 $\\chi$ 始终为非负（因为 $\\chi \\ge \\chi_{\\min}  0$），并且 $\\Delta t, \\Delta x^2  0$。因此，$T_{i-1}^n$ 和 $T_{i+1}^n$ 的系数是非负的。唯一需要强制施加的条件是针对 $T_i^n$ 的系数：\n$$\n1 - \\frac{\\Delta t}{\\Delta x^2}(\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n) \\ge 0\n$$\n整理这个关于 $\\Delta t$ 的不等式，得到：\n$$\n\\Delta t \\le \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n}\n$$\n这个条件必须对每个计算网格单元 $i=0, 1, \\dots, N-1$ 都成立。因此，全局时间步长 $\\Delta t$ 必须受限于这些局部时间步长限制的最小值：\n$$\n\\Delta t \\le \\min_{i=0, \\dots, N-1} \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n}\n$$\n这就建立了所要求的稳定性判据。对于边界单元 $i=0$，通量 $F_{-\\frac{1}{2}}$ 对应于对称边界条件。问题陈述中指出 $(\\frac{\\partial T}{\\partial x})_{-\\frac{1}{2}}=0$，这意味着 $F_{-\\frac{1}{2}}=0$。单元 $i=0$ 的更新方程是：\n$$\n\\frac{d T_0}{dt} = \\frac{1}{\\Delta x^2} \\left[ \\chi_{\\frac{1}{2}}(T_1 - T_0) \\right]\n$$\n在前向欧拉更新中，对应的 $T_0^n$ 系数为 $1 - \\frac{\\Delta t}{\\Delta x^2}\\chi_{\\frac{1}{2}}^n$。稳定性条件为 $\\Delta t \\le \\frac{\\Delta x^2}{\\chi_{\\frac{1}{2}}^n}$。这与通用公式一致，如果我们按照问题陈述的明确指示设置 $\\chi_{-\\frac{1}{2}}^n = 0$。在 $x=L$ 处的固定温度意味着 $T_N=T_{\\text{edge}}$ 是一个常数参数，而不是一个变量，因此它本身不施加稳定性约束。单元 $i=N-1$ 是最后一个动态单元，其稳定性由 $i=N-1$ 时的通用公式覆盖。\n\n**任务 2：实现方法**\n\n目标是计算给定初始条件下的最大允许时间步长 $\\Delta t_{\\max}$。这对应于在时间 $t=0$ 时评估稳定性判据。\n$$\n\\Delta t_{\\max} = \\min_{i=0, \\dots, N-1} \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}} + \\chi_{i-\\frac{1}{2}}} = \\frac{\\Delta x^2}{\\max_{i=0, \\dots, N-1} (\\chi_{i+\\frac{1}{2}} + \\chi_{i-\\frac{1}{2}})}\n$$\n对于每个测试案例，算法按以下步骤进行：\n1.  **网格和初始分布设置**：设置物理和数值常数 $L, N, R, \\chi_{\\min}, \\chi_{\\text{amp}}, g_c, \\alpha, T_{\\text{edge}}$。计算网格间距 $\\Delta x = L/N$。创建一个网格中心数组 $x_i = (i+0.5)\\Delta x$，$i=0, \\dots, N-1$。在这些网格中心上计算给定的初始温度分布 $T(x)$，得到数组 $T_i$。\n\n2.  **计算网格面上的量**：我们需要在所有 $N+1$ 个网格面（从面 $-\\frac{1}{2}$（索引 $j=0$）到面 $N-\\frac{1}{2}$（索引 $j=N$））上计算扩散系数 $\\chi$。\n    - **网格面梯度**：计算一个大小为 $N+1$ 的数组。\n        - 左边界 $(j=0)$：$(\\frac{\\partial T}{\\partial x})_{-\\frac{1}{2}} = 0$。\n        - 内部网格面 $(j=1, \\dots, N-1)$：$(\\frac{\\partial T}{\\partial x})_{j-\\frac{1}{2}} = (T_j - T_{j-1})/\\Delta x$。\n        - 右边界 $(j=N)$：$(\\frac{\\partial T}{\\partial x})_{N-\\frac{1}{2}} = (T_{\\text{edge}} - T_{N-1})/\\Delta x$。\n    - **网格面温度**：计算一个大小为 $N+1$ 的数组。\n        - 左边界 $(j=0)$：$T_{-\\frac{1}{2}} = T_0$。\n        - 内部网格面 $(j=1, \\dots, N-1)$：$T_{j-\\frac{1}{2}} = \\frac{1}{2}(T_j + T_{j-1})$。\n        - 右边界 $(j=N)$：$T_{N-\\frac{1}{2}} = \\frac{1}{2}(T_{N-1} + T_{\\text{edge}})$。\n    - **网格面梯度比 $g$**：使用网格面梯度和温度，为所有 $j=0, \\dots, N$ 计算 $g_{j-\\frac{1}{2}} = -R/T_{j-\\frac{1}{2}} \\cdot (\\frac{\\partial T}{\\partial x})_{j-\\frac{1}{2}}$。假设所有温度都为正，因此不用担心除以零的问题。\n    - **网格面扩散系数 $\\chi$**：使用公式 $\\chi_{j-\\frac{1}{2}} = \\chi_{\\min} + \\chi_{\\text{amp}} \\,\\max(0, g_{j-\\frac{1}{2}} - g_c)^{\\alpha}$ 计算一个大小为 $N+1$ 的数组。计算后，根据问题指令，覆盖左边界网格面上的值：$\\chi_{-\\frac{1}{2}} = 0$。\n\n3.  **计算稳定性分母**：对于每个网格单元 $i=0, \\dots, N-1$，稳定性分母为 $D_i = \\chi_{i+\\frac{1}{2}} + \\chi_{i-\\frac{1}{2}}$。这可以使用网格面扩散系数数组上的数组操作同时为所有单元计算。如果网格面扩散系数数组是 `chi_faces`（索引为 $0, \\dots, N$），则单元 $0, \\dots, N-1$ 的分母数组是 `chi_faces[1:] + chi_faces[:-1]`。\n\n4.  **计算 $\\Delta t_{\\max}$**：找到稳定性分母数组中的最大值 $D_{\\max} = \\max_i D_i$。最大允许时间步长则为 $\\Delta t_{\\max} = \\Delta x^2 / D_{\\max}$。该值即为该测试案例的结果。\n\n对四个指定的初始温度分布中的每一个重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the maximum stable time step for a 1D nonlinear heat diffusion\n    problem using a finite-volume method with a critical gradient model.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    L = 1.0           # meters, slab width\n    N = 128           # number of cells\n    R = 3.0           # meters, major radius\n    chi_min = 0.30    # m^2/s, minimum diffusivity\n    chi_amp = 1.50    # m^2/s, turbulent diffusivity amplitude\n    gc = 6.0          # dimensionless, critical gradient\n    alpha = 1.0       # dimensionless, exponent\n    T_edge = 1.0      # keV, edge temperature\n\n    # --- Test Case Definitions ---\n    # Each tuple contains (T_core, profile_function_name)\n    test_cases = [\n        (15.0, \"quadratic\"),\n        (20.0, \"linear\"),\n        (2.0, \"quadratic\"),\n        (T_edge, \"uniform\") # For a uniform profile, T_core is the same as T_edge\n    ]\n\n    results = []\n\n    for T_core, profile_type in test_cases:\n        # --- Algorithm Implementation ---\n\n        # 1. Grid and Initial Profile Setup\n        dx = L / N\n        x_centers = (np.arange(N) + 0.5) * dx\n        \n        T_initial = np.zeros(N)\n        if profile_type == \"quadratic\":\n            T_initial = T_edge + (T_core - T_edge) * (1 - x_centers / L)**2\n        elif profile_type == \"linear\":\n            T_initial = T_edge + (T_core - T_edge) * (1 - x_centers / L)\n        elif profile_type == \"uniform\":\n            T_initial = np.full(N, T_edge)\n\n        # 2. Compute Face Quantities\n        # We define N+1 faces, indexed j=0...N, corresponding to\n        # physical faces at locations x_{-1/2}, x_{1/2}, ..., x_{N-1/2}.\n        grad_T_faces = np.zeros(N + 1)\n        T_faces = np.zeros(N + 1)\n\n        # Face Gradients\n        # j=0 (face -1/2): Left boundary\n        grad_T_faces[0] = 0.0\n        # j=1...N-1 (internal faces i+1/2 for i=0...N-2)\n        # Corresponds to faces x_{1/2} to x_{N-3/2}\n        grad_T_faces[1:N] = (T_initial[1:] - T_initial[:-1]) / dx\n        # j=N (face N-1/2): Right boundary\n        grad_T_faces[N] = (T_edge - T_initial[N - 1]) / dx\n        \n        # Face Temperatures\n        # j=0 (face -1/2): Left boundary\n        T_faces[0] = T_initial[0]\n        # j=1...N-1 (internal faces i+1/2 for i=0...N-2)\n        T_faces[1:N] = 0.5 * (T_initial[1:] + T_initial[:-1])\n        # j=N (face N-1/2): Right boundary\n        T_faces[N] = 0.5 * (T_initial[N - 1] + T_edge)\n        \n        # Face Gradient Ratio, g\n        # Problem assumes T > 0, so no division by zero check is needed.\n        g_faces = -R / T_faces * grad_T_faces\n\n        # Face Diffusivities, chi\n        g_factor = g_faces - gc\n        g_factor[g_factor  0] = 0.0 # This implements max(0, g - gc)\n        chi_faces = chi_min + chi_amp * (g_factor**alpha)\n\n        # Enforce special boundary condition from problem statement\n        chi_faces[0] = 0.0\n\n        # 3. Compute Stability Denominators\n        # For cell i=0...N-1, denominator is chi_{i+1/2} + chi_{i-1/2}.\n        # This maps to chi_faces[i+1] + chi_faces[i].\n        # In NumPy, this is a sum of shifted slices.\n        denominators = chi_faces[1:] + chi_faces[:-1]\n\n        # 4. Calculate dt_max\n        max_denominator = np.max(denominators)\n        \n        # Guard against division by zero, though unlikely with chi_min > 0.\n        if max_denominator > 1e-12:\n            dt_max = (dx**2) / max_denominator\n        else:\n            # If all gradients are zero, denominator is 2*chi_min (or chi_min at boundary),\n            # so this branch shouldn't be taken unless chi_min is also zero.\n            # An infinite dt implies unconditional stability.\n            dt_max = np.inf\n            \n        results.append(dt_max)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}