{
    "hands_on_practices": [
        {
            "introduction": "Critical gradient models are defined by a sharp transition from low to high transport, but a truly discontinuous model is often unphysical and numerically challenging. This first exercise guides you through the construction and analysis of a smooth \"critical flux law\" that captures the essential physics while ensuring mathematical regularity. By justifying its form and analyzing its behavior near the threshold, you will build a foundational understanding of how these models are designed. ",
            "id": "3962253",
            "problem": "Consider a toroidal magnetically confined plasma in which the radial ion heat flux is modeled by Fick’s law, $q_{i}=-n_{i}\\chi\\,\\nabla T_{i}$, where $n_{i}$ is the ion density, $T_{i}$ is the ion temperature, and $\\chi$ is the effective ion thermal diffusivity. In the presence of microinstabilities such as Ion Temperature Gradient (ITG) driven turbulence, it is widely observed that turbulent transport exhibits a critical-gradient behavior: negligible turbulent transport below a threshold in the dimensionless gradient $R/L_{T}$, and stiff, rapidly increasing transport above it. Here $R$ is the major radius, and the temperature gradient scale length $L_{T}$ is defined by $L_{T}\\equiv -T_{i}/(\\mathrm{d}T_{i}/\\mathrm{d}r)$.\n\nStarting from these foundational ideas and the decomposition $\\chi=\\chi_{\\mathrm{neo}}+\\chi_{\\mathrm{turb}}$, where $\\chi_{\\mathrm{neo}}$ is the neoclassical baseline and $\\chi_{\\mathrm{turb}}$ is the turbulence-driven contribution, propose and justify a smooth “critical flux law” of the form\n$$\n\\chi\\!\\left(\\frac{R}{L_{T}}\\right)=\\chi_{\\mathrm{neo}}+\\alpha\\,\\ln\\!\\left\\{1+\\exp\\!\\left[\\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta}\\right]\\right\\},\n$$\nwhere $\\alpha>0$ sets the turbulent amplitude scale, $\\Delta>0$ sets the smoothness (onset width) of the transition, and $R/L_{T,\\mathrm{crit}}$ is the critical gradient. Your justification should be rooted in the principles stated above, including physical monotonicity, positivity, asymptotic consistency with negligible turbulence well below threshold, and a finite stiffness near threshold.\n\nThen, compute a near-threshold expansion of $\\chi(R/L_{T})$ as a series in the small parameter\n$$\nx\\equiv \\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta},\n$$\nretaining terms up to and including order $x^{4}$. Express the final expansion in terms of $\\chi_{\\mathrm{neo}}$, $\\alpha$, $\\Delta$, $R/L_{T}$, and $R/L_{T,\\mathrm{crit}}$. The final answer must be a single analytical expression. You do not need to provide a numerical value, so no rounding instructions are required. Assume $\\chi_{\\mathrm{neo}}$ and $\\alpha$ have units of thermal diffusivity and $\\Delta$ is dimensionless; you do not need to report units in your final expression.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n- Ion heat flux model: $q_{i}=-n_{i}\\chi\\,\\nabla T_{i}$\n- Ion density: $n_{i}$\n- Ion temperature: $T_{i}$\n- Effective ion thermal diffusivity: $\\chi$\n- Dimensionless temperature gradient: $R/L_{T}$\n- Major radius: $R$\n- Temperature gradient scale length: $L_{T}\\equiv -T_{i}/(\\mathrm{d}T_{i}/\\mathrm{d}r)$\n- Decomposition of diffusivity: $\\chi=\\chi_{\\mathrm{neo}}+\\chi_{\\mathrm{turb}}$\n- Neoclassical diffusivity: $\\chi_{\\mathrm{neo}}$\n- Turbulent diffusivity: $\\chi_{\\mathrm{turb}}$\n- Proposed critical flux law: $\\chi\\!\\left(\\frac{R}{L_{T}}\\right)=\\chi_{\\mathrm{neo}}+\\alpha\\,\\ln\\!\\left\\{1+\\exp\\!\\left[\\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta}\\right]\\right\\}$\n- Turbulent amplitude scale: $\\alpha > 0$\n- Transition smoothness parameter: $\\Delta > 0$\n- Critical gradient threshold: $R/L_{T,\\mathrm{crit}}$\n- Expansion parameter: $x\\equiv \\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta}$\n- Task 1: Justify the proposed form based on physical principles: monotonicity, positivity, asymptotic consistency, and finite stiffness.\n- Task 2: Compute a near-threshold expansion of $\\chi(R/L_{T})$ as a series in $x$ up to order $x^{4}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the established field of critical gradient models for turbulent transport in fusion plasmas. The concepts, definitions ($L_{T}$), and functional form are standard representations used in computational fusion science. The problem is well-posed, providing a clearly defined mathematical model and asking for its justification and a specific series expansion. All terms are defined, and the premises are consistent. The task is neither trivial nor overly complex, requiring a solid application of calculus and physical reasoning.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will proceed.\n\nThe solution consists of two parts as requested: first, a justification of the physical properties of the proposed model for thermal diffusivity $\\chi$, and second, the calculation of its Taylor series expansion near the critical gradient threshold.\n\nFor clarity, we introduce the dimensionless gradient variable $g \\equiv R/L_{T}$ and its critical value $g_{\\mathrm{crit}} \\equiv R/L_{T,\\mathrm{crit}}$. The expansion parameter is $x \\equiv (g - g_{\\mathrm{crit}})/\\Delta$. The model for the thermal diffusivity can be written as:\n$$\n\\chi(x) = \\chi_{\\mathrm{neo}} + \\alpha \\ln(1 + \\exp(x))\n$$\n\n**Part 1: Justification of the Model Form**\n\nWe verify that the model adheres to the specified physical principles.\n\n1.  **Positivity**: A physical diffusivity must be positive. It is given that $\\alpha > 0$. The neoclassical diffusivity $\\chi_{\\mathrm{neo}}$ is also inherently positive. The argument of the natural logarithm is $1 + \\exp(x)$. Since $\\exp(x) > 0$ for all real $x$, it follows that $1 + \\exp(x) > 1$. The natural logarithm of a number greater than $1$ is positive, so $\\ln(1 + \\exp(x)) > 0$. Therefore, $\\chi(x) = \\chi_{\\mathrm{neo}} + (\\text{positive term})$, ensuring that $\\chi(x)$ is always positive and greater than $\\chi_{\\mathrm{neo}}$.\n\n2.  **Asymptotic Consistency**: The model must reproduce the expected physical behavior in the limits far below and far above the critical gradient.\n    -   **Well below threshold ($g \\ll g_{\\mathrm{crit}}$)**: In this limit, the argument of the exponent $x = (g - g_{\\mathrm{crit}})/\\Delta$ becomes large and negative, i.e., $x \\to -\\infty$. Consequently, $\\exp(x) \\to 0$. The model becomes:\n        $$\n        \\lim_{x \\to -\\infty} \\chi(x) = \\chi_{\\mathrm{neo}} + \\alpha \\ln(1 + 0) = \\chi_{\\mathrm{neo}}\n        $$\n        This correctly recovers the baseline neoclassical transport, with the turbulent contribution $\\chi_{\\mathrm{turb}}$ becoming negligible, as physically required.\n    -   **Well above threshold ($g \\gg g_{\\mathrm{crit}}$)**: In this limit, $x$ becomes large and positive, $x \\to +\\infty$. For large $x$, $1 + \\exp(x) \\approx \\exp(x)$. The model becomes:\n        $$\n        \\lim_{x \\to +\\infty} \\chi(x) \\approx \\chi_{\\mathrm{neo}} + \\alpha \\ln(\\exp(x)) = \\chi_{\\mathrm{neo}} + \\alpha x = \\chi_{\\mathrm{neo}} + \\frac{\\alpha}{\\Delta}(g - g_{\\mathrm{crit}})\n        $$\n        This shows that far above the threshold, the turbulent diffusivity grows linearly with the excess gradient $g - g_{\\mathrm{crit}}$. This linear growth represents the \"stiff\" transport regime, where a small increase in the gradient drive results in a large increase in transport. The stiffness, defined as the slope $\\mathrm{d}\\chi/\\mathrm{d}g$, approaches the constant value $\\alpha/\\Delta$.\n\n3.  **Physical Monotonicity**: The diffusivity $\\chi$ should be a non-decreasing function of the gradient drive $g$. We check this by computing the first derivative of $\\chi$ with respect to $g$:\n    $$\n    \\frac{\\mathrm{d}\\chi}{\\mathrm{d}g} = \\frac{\\mathrm{d}}{\\mathrm{d}g} \\left[ \\chi_{\\mathrm{neo}} + \\alpha \\ln\\left(1 + \\exp\\left(\\frac{g - g_{\\mathrm{crit}}}{\\Delta}\\right)\\right) \\right]\n    $$\n    Using the chain rule:\n    $$\n    \\frac{\\mathrm{d}\\chi}{\\mathrm{d}g} = \\alpha \\cdot \\frac{1}{1 + \\exp\\left(\\frac{g - g_{\\mathrm{crit}}}{\\Delta}\\right)} \\cdot \\exp\\left(\\frac{g - g_{\\mathrm{crit}}}{\\Delta}\\right) \\cdot \\frac{1}{\\Delta} = \\frac{\\alpha}{\\Delta} \\frac{\\exp(x)}{1 + \\exp(x)}\n    $$\n    Since $\\alpha > 0$, $\\Delta > 0$, and the term $\\exp(x)/(1 + \\exp(x))$ is always positive, we have $\\mathrm{d}\\chi/\\mathrm{d}g > 0$ for all $g$. Thus, the model is strictly monotonic increasing, which is physically correct.\n\n4.  **Finite Stiffness near Threshold**: The model should provide a smooth transition from the low-transport to the high-transport regime, implying a finite stiffness at the threshold $g = g_{\\mathrm{crit}}$ (or $x=0$). The stiffness at the threshold is the value of the derivative at this point:\n    $$\n    \\left. \\frac{\\mathrm{d}\\chi}{\\mathrm{d}g} \\right|_{g=g_{\\mathrm{crit}}} = \\left. \\frac{\\alpha}{\\Delta} \\frac{\\exp(x)}{1 + \\exp(x)} \\right|_{x=0} = \\frac{\\alpha}{\\Delta} \\frac{\\exp(0)}{1 + \\exp(0)} = \\frac{\\alpha}{\\Delta} \\frac{1}{2} = \\frac{\\alpha}{2\\Delta}\n    $$\n    The stiffness at the threshold is finite and positive. The parameter $\\Delta$ controls the sharpness of this transition: a smaller $\\Delta$ corresponds to a stiffer, more abrupt onset of turbulence. This smooth turn-on is a key feature of the model distinguishing it from a simple step-function.\n\n**Part 2: Near-Threshold Expansion**\n\nWe are asked to compute the Taylor series expansion of $\\chi(x)$ around $x=0$ up to the fourth order in $x$. The expansion is given by:\n$$\n\\chi(x) \\approx \\chi(0) + \\chi'(0)x + \\frac{\\chi''(0)}{2!}x^2 + \\frac{\\chi'''(0)}{3!}x^3 + \\frac{\\chi^{(4)}(0)}{4!}x^4\n$$\nLet $f(x) = \\ln(1 + \\exp(x))$. Then $\\chi(x) = \\chi_{\\mathrm{neo}} + \\alpha f(x)$. We need to find the derivatives of $f(x)$ at $x=0$.\n\n-   $f(x) = \\ln(1 + \\exp(x))$\n    $f(0) = \\ln(1 + \\exp(0)) = \\ln(2)$\n\n-   $f'(x) = \\frac{\\exp(x)}{1 + \\exp(x)}$\n    $f'(0) = \\frac{\\exp(0)}{1 + \\exp(0)} = \\frac{1}{2}$\n\n-   $f''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\exp(x)}{1 + \\exp(x)} \\right) = \\frac{\\exp(x)(1 + \\exp(x)) - \\exp(x)\\exp(x)}{(1 + \\exp(x))^2} = \\frac{\\exp(x)}{(1 + \\exp(x))^2}$\n    $f''(0) = \\frac{\\exp(0)}{(1 + \\exp(0))^2} = \\frac{1}{2^2} = \\frac{1}{4}$\n\n-   $f'''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\exp(x)}{(1 + \\exp(x))^2} \\right) = \\frac{\\exp(x)(1+\\exp(x))^2 - \\exp(x) \\cdot 2(1+\\exp(x))\\exp(x)}{(1 + \\exp(x))^4}$\n    $ = \\frac{\\exp(x)(1+\\exp(x)) - 2\\exp(2x)}{(1 + \\exp(x))^3} = \\frac{\\exp(x) - \\exp(2x)}{(1 + \\exp(x))^3}$\n    $f'''(0) = \\frac{\\exp(0) - \\exp(0)}{(1 + \\exp(0))^3} = \\frac{1 - 1}{8} = 0$\n\n-   $f^{(4)}(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\exp(x) - \\exp(2x)}{(1 + \\exp(x))^3} \\right)$\n    Numerator derivative: $\\exp(x) - 2\\exp(2x)$. Denominator derivative: $3(1 + \\exp(x))^2 \\exp(x)$.\n    Using the quotient rule and evaluating at $x=0$:\n    $f^{(4)}(0) = \\frac{(\\exp(0)-2\\exp(0))(1+\\exp(0))^3 - (\\exp(0)-\\exp(0)) \\cdot 3(1+\\exp(0))^2\\exp(0)}{(1+\\exp(0))^6}$\n    $f^{(4)}(0) = \\frac{(1-2)(1+1)^3 - 0}{(1+1)^6} = \\frac{-1 \\cdot 8}{64} = -\\frac{8}{64} = -\\frac{1}{8}$\n\nNow we assemble the Taylor series for $f(x)$:\n$$\nf(x) \\approx f(0) + f'(0)x + \\frac{f''(0)}{2!}x^2 + \\frac{f'''(0)}{3!}x^3 + \\frac{f^{(4)}(0)}{4!}x^4\n$$\n$$\nf(x) \\approx \\ln(2) + \\frac{1}{2}x + \\frac{1/4}{2}x^2 + \\frac{0}{6}x^3 + \\frac{-1/8}{24}x^4\n$$\n$$\nf(x) \\approx \\ln(2) + \\frac{1}{2}x + \\frac{1}{8}x^2 - \\frac{1}{192}x^4\n$$\nFinally, we substitute this back into the expression for $\\chi(x)$ and replace $x$ with its definition:\n$$\n\\chi\\left(\\frac{R}{L_{T}}\\right) \\approx \\chi_{\\mathrm{neo}} + \\alpha \\left( \\ln(2) + \\frac{1}{2}x + \\frac{1}{8}x^2 - \\frac{1}{192}x^4 \\right)\n$$\nSubstituting $x = \\frac{\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}}{\\Delta}$:\n$$\n\\chi\\left(\\frac{R}{L_{T}}\\right) \\approx \\chi_{\\mathrm{neo}} + \\alpha\\ln(2) + \\frac{\\alpha}{2\\Delta}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right) + \\frac{\\alpha}{8\\Delta^2}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^2 - \\frac{\\alpha}{192\\Delta^4}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^4\n$$\nThis is the desired near-threshold expansion of the thermal diffusivity up to fourth order.",
            "answer": "$$\n\\boxed{\\chi_{\\mathrm{neo}} + \\alpha\\ln(2) + \\frac{\\alpha}{2\\Delta}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right) + \\frac{\\alpha}{8\\Delta^2}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^2 - \\frac{\\alpha}{192\\Delta^4}\\left(\\frac{R}{L_{T}}-\\frac{R}{L_{T,\\mathrm{crit}}}\\right)^4}\n$$"
        },
        {
            "introduction": "The onset of turbulence is not solely determined by the gradient drive; it is a competition between this drive and stabilizing effects. This practice explores one of the most important stabilization mechanisms in tokamaks: the shearing of turbulent eddies by equilibrium $E \\times B$ flows. You will derive how this flow shear raises the effective critical gradient above the simple linear stability threshold, a crucial concept for explaining high-performance plasma regimes. ",
            "id": "3962265",
            "problem": "A central question in critical gradient transport modeling in magnetically confined fusion plasmas is how equilibrium electrostatic cross-field (E×B) flow shear modifies the onset of turbulent transport driven by the ion temperature gradient. Consider a simplified spectral model of ion temperature gradient (ITG) mode linear growth in which, for a fixed binormal wavenumber $k_y$ (normalized to the inverse ion sound gyroradius $\\rho_s^{-1}$, where $\\rho_s = c_s / \\Omega_i$ with $c_s$ the ion sound speed and $\\Omega_i$ the ion cyclotron frequency), the linear growth rate is represented by\n$$\n\\gamma_{L}(k_y) = a \\left[\\frac{R}{L_T} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}\\right] k_y - b\\, k_y^{3},\n$$\nwith $a>0$ and $b>0$, and where $R$ is the major radius and $L_T$ is the ion temperature scale length defined by $L_T^{-1} = -\\frac{1}{T_i}\\frac{dT_i}{dr}$. Assume the E×B flow shear introduces a $k_y$-independent decorrelation rate $\\gamma_{E}$ that competes with the linear drive by shearing turbulent eddies, such that the net growth rate is $\\Gamma(k_y) = \\gamma_{L}(k_y) - \\gamma_{E}$. In a critical gradient transport model, the nonlinear threshold $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}}$ is reached when the supremum over $k_y$ of $\\Gamma(k_y)$ equals zero, while the linear threshold $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$ is defined by the condition that the supremum over $k_y$ of $\\gamma_L(k_y)$ equals zero.\n\nStarting from these definitions and the given spectral model, explain mechanistically how flow shear decorrelation competes with the linear ITG drive to set a nonlinear threshold, and then derive an analytical expression for the offset\n$$\n\\Delta\\!\\left(\\frac{R}{L_T}\\right) \\equiv \\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}.\n$$\nEvaluate this offset numerically for $a = 0.8$, $b = 0.2$, and $\\gamma_E = 0.05$, where all rates are normalized to $c_s/R$ and $k_y$ is normalized to $\\rho_s^{-1}$. Express your final result for $\\Delta\\!\\left(\\frac{R}{L_T}\\right)$ as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n-   The linear growth rate of the ion temperature gradient (ITG) mode for a fixed binormal wavenumber $k_y$ is given by:\n    $$\n    \\gamma_{L}(k_y) = a \\left[\\frac{R}{L_T} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}\\right] k_y - b\\, k_y^{3}\n    $$\n-   The constants $a$ and $b$ are positive: $a>0$ and $b>0$.\n-   The ion temperature scale length is defined as $L_T^{-1} = -\\frac{1}{T_i}\\frac{dT_i}{dr}$.\n-   The E×B flow shear introduces a $k_y$-independent decorrelation rate $\\gamma_{E}$.\n-   The net growth rate is $\\Gamma(k_y) = \\gamma_{L}(k_y) - \\gamma_{E}$.\n-   The nonlinear threshold, $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}}$, is defined by the condition $\\sup_{k_y} \\Gamma(k_y) = 0$.\n-   The linear threshold, $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$, is defined by the condition $\\sup_{k_y} \\gamma_L(k_y) = 0$.\n-   The objective is to explain the competition mechanism and derive an analytical expression for the offset $\\Delta\\!\\left(\\frac{R}{L_T}\\right) \\equiv \\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$.\n-   Numerical values for evaluation: $a = 0.8$, $b = 0.2$, $\\gamma_E = 0.05$.\n-   All rates are normalized to $c_s/R$ and $k_y$ is normalized to $\\rho_s^{-1}$. The final answer should be a dimensionless number rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically-grounded, describing a canonical model for the E×B shear suppression of ITG turbulence, a cornerstone of transport physics in fusion plasmas. The functional form of the growth rate is a standard simplified spectral representation. The problem is well-posed, with clear definitions for the quantities to be derived and sufficient information to determine them. The language is objective and formal. The problem does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\n### Solution\nThe problem asks for both a mechanistic explanation and a quantitative derivation of the upshift in the critical ion temperature gradient caused by E×B flow shear.\n\nFirst, we analyze the mechanism. The linear growth rate $\\gamma_L(k_y)$ models the balance between the drive of the ITG instability and a stabilizing effect at short wavelengths. The term $a \\left[\\frac{R}{L_T} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}\\right] k_y$ represents the instability drive, which is proportional to the excess of the normalized temperature gradient $\\frac{R}{L_T}$ over a critical linear threshold $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$. For $\\frac{R}{L_T} > \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$, this term is positive, driving the instability. The term $-b k_y^3$ represents a damping mechanism that dominates at large $k_y$ (short wavelengths), ensuring that the growth rate has a maximum at a finite wavenumber. The linear threshold $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$ is the specific value of the gradient at which the maximum possible linear growth rate, $\\sup_{k_y} \\gamma_L(k_y)$, is exactly zero.\n\nThe E×B flow shear introduces an additional stabilizing effect, represented by the decorrelation rate $\\gamma_E$. This rate acts as a uniform suppression across all wavenumbers, reducing the net growth rate to $\\Gamma(k_y) = \\gamma_L(k_y) - \\gamma_E$. For turbulence to develop, the net growth rate for at least one mode must be positive, i.e., $\\sup_{k_y} \\Gamma(k_y) > 0$. This requires the peak linear growth rate $\\sup_{k_y} \\gamma_L(k_y)$ to be greater than the shear suppression rate $\\gamma_E$. Since the peak linear growth rate is zero at the linear threshold $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$, the temperature gradient $\\frac{R}{L_T}$ must be increased further to produce a linear drive sufficient to overcome $\\gamma_E$. The nonlinear threshold $\\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}}$ is the value of the gradient where the peak net growth rate is precisely zero, i.e., $\\sup_{k_y} \\Gamma(k_y) = 0$. This implies that at this threshold, $\\sup_{k_y} \\gamma_L(k_y) = \\gamma_E$. The difference, $\\Delta\\!\\left(\\frac{R}{L_T}\\right)$, represents how much the critical gradient must be increased above the linear threshold to overcome the flow shear suppression.\n\nNow, we derive the analytical expression for $\\Delta\\!\\left(\\frac{R}{L_T}\\right) = \\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}$.\nThe nonlinear threshold is defined by the condition $\\sup_{k_y} \\Gamma(k_y) = 0$. We must evaluate this at $\\frac{R}{L_T} = \\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}}$. Let's rewrite $\\Gamma(k_y)$ using the definition of $\\Delta\\!\\left(\\frac{R}{L_T}\\right)$:\n$$\n\\Gamma(k_y) = a \\left[\\left(\\frac{R}{L_T}\\right)_{\\mathrm{nl}} - \\left(\\frac{R}{L_T}\\right)_{\\mathrm{lin}}\\right] k_y - b k_y^3 - \\gamma_E = a \\Delta\\!\\left(\\frac{R}{L_T}\\right) k_y - b k_y^3 - \\gamma_E\n$$\nTo find the supremum of $\\Gamma(k_y)$ with respect to $k_y$, we find the wavenumber $k_{y, \\text{max}}$ that maximizes it by setting the derivative to zero:\n$$\n\\frac{d\\Gamma}{dk_y} = a \\Delta\\!\\left(\\frac{R}{L_T}\\right) - 3 b k_y^2 = 0\n$$\nSolving for $k_y^2$ gives the location of the maximum:\n$$\nk_{y, \\text{max}}^2 = \\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3b}\n$$\nSince $a, b > 0$, a real solution for $k_{y, \\text{max}}$ exists if $\\Delta\\!\\left(\\frac{R}{L_T}\\right) > 0$, which is expected.\n$$\nk_{y, \\text{max}} = \\sqrt{\\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3b}}\n$$\nThe value of the supremum is $\\Gamma(k_{y, \\text{max}})$. Substituting $k_{y, \\text{max}}$ back into the expression for $\\Gamma(k_y)$:\n$$\n\\sup_{k_y} \\Gamma(k_y) = a \\Delta\\!\\left(\\frac{R}{L_T}\\right) k_{y, \\text{max}} - b k_{y, \\text{max}}^3 - \\gamma_E\n$$\nWe can simplify the first two terms:\n$$\na \\Delta\\!\\left(\\frac{R}{L_T}\\right) k_{y, \\text{max}} - b k_{y, \\text{max}}^3 = k_{y, \\text{max}} \\left( a \\Delta\\!\\left(\\frac{R}{L_T}\\right) - b k_{y, \\text{max}}^2 \\right)\n$$\nSubstituting $k_{y, \\text{max}}^2 = \\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3b}$:\n$$\n= k_{y, \\text{max}} \\left( a \\Delta\\!\\left(\\frac{R}{L_T}\\right) - b \\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3b} \\right) = k_{y, \\text{max}} \\left( a \\Delta\\!\\left(\\frac{R}{L_T}\\right) - \\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3} \\right) = \\frac{2}{3} a \\Delta\\!\\left(\\frac{R}{L_T}\\right) k_{y, \\text{max}}\n$$\nSubstituting the expression for $k_{y, \\text{max}}$ again:\n$$\n= \\frac{2}{3} a \\Delta\\!\\left(\\frac{R}{L_T}\\right) \\sqrt{\\frac{a \\Delta\\!\\left(\\frac{R}{L_T}\\right)}{3b}} = \\frac{2a\\sqrt{a}}{3\\sqrt{3b}} \\left(\\Delta\\!\\left(\\frac{R}{L_T}\\right)\\right)^{3/2}\n$$\nThe definition of the nonlinear threshold is $\\sup_{k_y} \\Gamma(k_y) = 0$, so:\n$$\n\\frac{2a\\sqrt{a}}{3\\sqrt{3b}} \\left(\\Delta\\!\\left(\\frac{R}{L_T}\\right)\\right)^{3/2} - \\gamma_E = 0\n$$\nNow, we solve for $\\Delta\\!\\left(\\frac{R}{L_T}\\right)$:\n$$\n\\left(\\Delta\\!\\left(\\frac{R}{L_T}\\right)\\right)^{3/2} = \\gamma_E \\frac{3\\sqrt{3b}}{2a\\sqrt{a}}\n$$\nTo isolate $\\Delta\\!\\left(\\frac{R}{L_T}\\right)$, we square both sides and then take the cube root (or raise to the power of $2/3$):\n$$\n\\left(\\Delta\\!\\left(\\frac{R}{L_T}\\right)\\right)^3 = \\left( \\gamma_E \\frac{3\\sqrt{3b}}{2a\\sqrt{a}} \\right)^2 = \\gamma_E^2 \\frac{9(3b)}{4a^2(a)} = \\frac{27 b \\gamma_E^2}{4 a^3}\n$$\nTaking the cube root yields the final analytical expression:\n$$\n\\Delta\\!\\left(\\frac{R}{L_T}\\right) = \\left( \\frac{27 b \\gamma_E^2}{4 a^3} \\right)^{1/3}\n$$\nFinally, we evaluate this expression numerically with the given values $a = 0.8$, $b = 0.2$, and $\\gamma_E = 0.05$.\n$$\n\\Delta\\!\\left(\\frac{R}{L_T}\\right) = \\left( \\frac{27 (0.2) (0.05)^2}{4 (0.8)^3} \\right)^{1/3}\n$$\nLet's compute the argument of the cube root:\nNumerator: $27 \\times 0.2 \\times (0.05)^2 = 5.4 \\times 0.0025 = 0.0135$.\nDenominator: $4 \\times (0.8)^3 = 4 \\times 0.512 = 2.048$.\nThe ratio is:\n$$\n\\frac{0.0135}{2.048} \\approx 0.006591796875\n$$\nAlternatively, using fractions: $a = 4/5$, $b = 1/5$, $\\gamma_E = 1/20$.\n$$\n\\frac{27 b \\gamma_E^2}{4 a^3} = \\frac{27 \\left(\\frac{1}{5}\\right) \\left(\\frac{1}{20}\\right)^2}{4 \\left(\\frac{4}{5}\\right)^3} = \\frac{\\frac{27}{5 \\times 400}}{\\frac{4 \\times 64}{125}} = \\frac{\\frac{27}{2000}}{\\frac{256}{125}} = \\frac{27}{2000} \\times \\frac{125}{256} = \\frac{27}{16 \\times 125} \\times \\frac{125}{256} = \\frac{27}{16 \\times 256} = \\frac{3^3}{2^4 \\times 2^8} = \\frac{3^3}{2^{12}}\n$$\nNow, we take the cube root:\n$$\n\\Delta\\!\\left(\\frac{R}{L_T}\\right) = \\left( \\frac{3^3}{2^{12}} \\right)^{1/3} = \\frac{(3^3)^{1/3}}{(2^{12})^{1/3}} = \\frac{3^1}{2^4} = \\frac{3}{16}\n$$\nConverting this exact fraction to a decimal gives:\n$$\n\\Delta\\!\\left(\\frac{R}{L_T}\\right) = 0.1875\n$$\nThis value already has four significant figures, so no further rounding is needed.",
            "answer": "$$\\boxed{0.1875}$$"
        },
        {
            "introduction": "Ultimately, transport models are designed to be solved computationally within larger simulations of plasma behavior. This final hands-on practice bridges the gap between theory and application by asking you to implement a critical gradient model within a finite-volume numerical scheme. By discretizing the nonlinear heat diffusion equation and deriving the associated stability criterion for an explicit time-stepping method, you will confront the practical challenges of simulating stiff transport. ",
            "id": "3962212",
            "problem": "Consider a one-dimensional slab geometry with spatial coordinate $x \\in [0,L]$ and a uniform finite-volume partition into $N$ control volumes of width $\\Delta x = L/N$. Let $T(x,t)$ denote the ion temperature field in kilo-electronvolts (keV). The nonlinear turbulent heat conduction operator is modeled in the form $\\nabla \\cdot \\left(\\chi\\left(\\frac{R}{L_T}\\right) \\nabla T\\right)$, where the thermal diffusivity $\\chi$ depends on the dimensionless gradient ratio $\\frac{R}{L_T}$ through a critical-gradient prescription. Here $R$ is the tokamak major radius in meters, and $L_T$ is the local temperature gradient scale length defined by $L_T = -\\frac{T}{\\partial T/\\partial x}$ in meters. The evolution equation is\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(\\chi\\left(\\frac{R}{L_T}\\right)\\frac{\\partial T}{\\partial x}\\right).\n$$\nBoundary conditions are symmetry at $x=0$ (zero flux, i.e., $\\frac{\\partial T}{\\partial x}(0,t)=0$) and a fixed edge temperature at $x=L$ (Dirichlet condition $T(L,t) = T_{\\text{edge}}$). Assume all temperatures remain strictly positive.\n\nThe finite-volume discretization is to be constructed as follows:\n- Cell centers $x_i = \\left(i+\\frac{1}{2}\\right)\\Delta x$ for $i=0,1,\\dots,N-1$, and cell faces $x_{i+\\frac{1}{2}} = (i+1)\\Delta x$ for $i=0,1,\\dots,N-1$, with the left boundary at $x_{-\\frac{1}{2}}=0$ and right boundary at $x_{N-\\frac{1}{2}}=L$.\n- Define face temperatures by centered averaging $T_{i+\\frac{1}{2}} = \\frac{1}{2}\\left(T_{i+1}+T_i\\right)$ for internal faces $i=0,\\dots,N-2$. For the left boundary face use $T_{-\\frac{1}{2}} = T_0$, and for the right boundary face use $T_{N-\\frac{1}{2}} = \\frac{1}{2}\\left(T_{N-1}+T_{\\text{edge}}\\right)$.\n- Define face gradients by $\\left(\\frac{\\partial T}{\\partial x}\\right)_{i+\\frac{1}{2}} = \\frac{T_{i+1}-T_i}{\\Delta x}$ for internal faces $i=0,\\dots,N-2$, $\\left(\\frac{\\partial T}{\\partial x}\\right)_{-\\frac{1}{2}}=0$ for the left boundary, and $\\left(\\frac{\\partial T}{\\partial x}\\right)_{N-\\frac{1}{2}} = \\frac{T_{\\text{edge}}-T_{N-1}}{\\Delta x}$ for the right boundary.\n- Define the dimensionless gradient ratio at faces as\n$$\ng_{i+\\frac{1}{2}} = \\frac{R}{L_T}\\bigg|_{i+\\frac{1}{2}} = -\\,\\frac{R}{T_{i+\\frac{1}{2}}}\\left(\\frac{\\partial T}{\\partial x}\\right)_{i+\\frac{1}{2}}.\n$$\n- Define the critical-gradient model for the diffusivity as\n$$\n\\chi(g) = \\chi_{\\min} + \\chi_{\\text{amp}} \\,\\max\\!\\left(0,\\,g - g_c\\right)^{\\alpha},\n$$\nwhere $\\chi_{\\min}$ and $\\chi_{\\text{amp}}$ are in $\\text{m}^2/\\text{s}$, $g_c$ is dimensionless, and $\\alpha \\geq 1$ is dimensionless.\n- The finite-volume semi-discrete operator for cell $i$ must be implemented as\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x}\\left[-F_{i+\\frac{1}{2}} + F_{i-\\frac{1}{2}}\\right],\n$$\nwith face heat fluxes\n$$\nF_{i+\\frac{1}{2}} = -\\,\\chi\\!\\left(g_{i+\\frac{1}{2}}\\right)\\left(\\frac{\\partial T}{\\partial x}\\right)_{i+\\frac{1}{2}}.\n$$\n\nTask 1 (Derivation): Starting from conservation of energy in a control volume and the definition of flux, derive the explicit forward-Euler time-stepping update formula for the finite-volume discretization in terms of cell-centered temperatures $T_i^n$ and face diffusivities $\\chi_{i+\\frac{1}{2}}$. Using a standard monotonicity and positivity argument, derive a sufficient stability criterion of the form\n$$\n\\Delta t \\le \\min_i \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}+\\chi_{i-\\frac{1}{2}}},\n$$\nthat guarantees the forward-Euler scheme does not produce non-physical overshoots for any cell $i$. Express $\\Delta t$ in seconds.\n\nTask 2 (Implementation): Implement a complete program that:\n- Constructs the finite-volume faces, face temperatures, face gradients, face $g_{i+\\frac{1}{2}}$, and face diffusivities $\\chi_{i+\\frac{1}{2}}$ for given parameters.\n- Computes the cell-wise stability denominator $\\chi_{i+\\frac{1}{2}}+\\chi_{i-\\frac{1}{2}}$ for all $i$ accounting for boundary faces (with $\\chi_{-\\frac{1}{2}}=0$ due to symmetry).\n- Returns the maximum allowable explicit time step $\\Delta t_{\\max}$ according to the stability criterion above as a float in seconds.\n\nUse the following test suite. For all cases, use $L=1.0$ meters, $N=128$ cells, $R=3.0$ meters, $\\chi_{\\min}=0.30$ $\\text{m}^2/\\text{s}$, $\\chi_{\\text{amp}}=1.50$ $\\text{m}^2/\\text{s}$, $g_c=6.0$, and $\\alpha=1$. Define the edge temperature $T_{\\text{edge}}=1.0$ keV, and cell-centered initial profiles $T_i$ by evaluating $T(x_i)$:\n\n- Case 1 (gentle, quadratic profile): $T(x) = T_{\\text{edge}} + \\left(T_{\\text{core}}-T_{\\text{edge}}\\right)\\left(1-\\frac{x}{L}\\right)^2$ with $T_{\\text{core}} = 15.0$ keV.\n- Case 2 (steeper, linear profile): $T(x) = T_{\\text{edge}} + \\left(T_{\\text{core}}-T_{\\text{edge}}\\right)\\left(1-\\frac{x}{L}\\right)$ with $T_{\\text{core}} = 20.0$ keV.\n- Case 3 (near-flat profile): $T(x) = T_{\\text{edge}} + \\left(T_{\\text{core}}-T_{\\text{edge}}\\right)\\left(1-\\frac{x}{L}\\right)^2$ with $T_{\\text{core}} = 2.0$ keV.\n- Case 4 (uniform profile): $T(x) \\equiv T_{\\text{edge}}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each list element must be $\\Delta t_{\\max}$ for the corresponding case, expressed in seconds as a float. No other text should be printed.\n\nAll physical quantities must be handled in their specified units, and the final outputs must be in seconds.",
            "solution": "The user has provided a problem statement that requires the derivation of a numerical stability criterion and its implementation for a nonlinear heat diffusion equation used in computational plasma physics.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Governing Equation**: $\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(\\chi\\left(\\frac{R}{L_T}\\right)\\frac{\\partial T}{\\partial x}\\right)$, for temperature $T(x,t)$ in keV.\n- **Domain**: $x \\in [0,L]$.\n- **Boundary Conditions**: $\\frac{\\partial T}{\\partial x}(0,t)=0$ (zero flux) and $T(L,t) = T_{\\text{edge}}$ (Dirichlet).\n- **Definitions**:\n    - Major radius $R$ (meters).\n    - Temperature gradient scale length: $L_T = -T / (\\partial T/\\partial x)$ (meters).\n    - Dimensionless gradient ratio: $g = R/L_T = -R/T \\cdot \\partial T/\\partial x$.\n    - Diffusivity model: $\\chi(g) = \\chi_{\\min} + \\chi_{\\text{amp}} \\,\\max(0, g - g_c)^{\\alpha}$.\n- **Discretization**:\n    - $N$ cells of width $\\Delta x = L/N$.\n    - Cell centers: $x_i = (i+\\frac{1}{2})\\Delta x$ for $i=0,\\dots,N-1$.\n    - Cell faces: $x_{i+\\frac{1}{2}} = (i+1)\\Delta x$ for $i=0,\\dots,N-1$.\n    - Face temperatures: $T_{i+\\frac{1}{2}} = \\frac{1}{2}(T_{i+1}+T_i)$ for internal faces, $T_{-\\frac{1}{2}} = T_0$, $T_{N-\\frac{1}{2}} = \\frac{1}{2}(T_{N-1}+T_{\\text{edge}})$.\n    - Face gradients: $(\\frac{\\partial T}{\\partial x})_{i+\\frac{1}{2}} = \\frac{T_{i+1}-T_i}{\\Delta x}$ for internal faces, $(\\frac{\\partial T}{\\partial x})_{-\\frac{1}{2}}=0$, $(\\frac{\\partial T}{\\partial x})_{N-\\frac{1}{2}} = \\frac{T_{\\text{edge}}-T_{N-1}}{\\Delta x}$.\n    - Semi-discrete equation: $\\frac{d T_i}{dt} = \\frac{1}{\\Delta x}[-F_{i+\\frac{1}{2}} + F_{i-\\frac{1}{2}}]$.\n    - Face flux: $F_{i+\\frac{1}{2}} = -\\chi(g_{i+\\frac{1}{2}})(\\frac{\\partial T}{\\partial x})_{i+\\frac{1}{2}}$.\n- **Task 1**: Derive the forward-Euler update formula and the stability criterion $\\Delta t \\le \\min_i \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}+\\chi_{i-\\frac{1}{2}}}$.\n- **Task 2**: Implement a program to compute $\\Delta t_{\\max}$ for four specific initial temperature profiles.\n- **Parameters**: $L=1.0\\,\\text{m}$, $N=128$, $R=3.0\\,\\text{m}$, $\\chi_{\\min}=0.30\\,\\text{m}^2/\\text{s}$, $\\chi_{\\text{amp}}=1.50\\,\\text{m}^2/\\text{s}$, $g_c=6.0$, $\\alpha=1.0$, $T_{\\text{edge}}=1.0\\,\\text{keV}$.\n- **Special Instruction**: Account for boundary faces with $\\chi_{-\\frac{1}{2}}=0$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is scientifically grounded, describing a standard finite-volume discretization of a nonlinear parabolic partial differential equation commonly used in plasma transport modeling. All terms, parameters, and numerical procedures are defined precisely and are consistent with standard practices in computational physics. The problem is well-posed, objective, and contains all necessary information to perform the requested derivations and computations. There are no scientific flaws, ambiguities, or contradictions.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A complete solution will be provided.\n\n---\n\n### Solution\n\nThe solution is presented in two parts as requested: a theoretical derivation and an explanation of the implementation methodology.\n\n**Task 1: Derivation of the Forward-Euler Update and Stability Criterion**\n\nThe semi-discrete finite-volume equation for the temperature $T_i$ in control volume $i$ is given by the conservation law:\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x}\\left(F_{i-\\frac{1}{2}} - F_{i+\\frac{1}{2}}\\right)\n$$\nwhere $F_{i\\pm\\frac{1}{2}}$ are the heat fluxes at the cell faces. The flux is defined as $F = -\\chi \\frac{\\partial T}{\\partial x}$. Substituting the discrete expressions for the flux, we have:\n$$\nF_{i+\\frac{1}{2}} = -\\chi_{i+\\frac{1}{2}} \\left(\\frac{T_{i+1} - T_i}{\\Delta x}\\right)\n$$\n$$\nF_{i-\\frac{1}{2}} = -\\chi_{i-\\frac{1}{2}} \\left(\\frac{T_i - T_{i-1}}{\\Delta x}\\right)\n$$\nwhere $\\chi_{i\\pm\\frac{1}{2}}$ is the thermal diffusivity evaluated at the respective face. Substituting these into the conservation law gives:\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x} \\left[ -\\chi_{i-\\frac{1}{2}} \\left(\\frac{T_i - T_{i-1}}{\\Delta x}\\right) - \\left(-\\chi_{i+\\frac{1}{2}} \\left(\\frac{T_{i+1} - T_i}{\\Delta x}\\right)\\right) \\right]\n$$\n$$\n\\frac{d T_i}{dt} = \\frac{1}{\\Delta x^2} \\left[ \\chi_{i+\\frac{1}{2}}(T_{i+1} - T_i) + \\chi_{i-\\frac{1}{2}}(T_{i-1} - T_i) \\right]\n$$\nNow, we apply the forward-Euler method for time integration. Let $T_i^n$ be the temperature in cell $i$ at time step $n$. The time derivative is approximated as $\\frac{d T_i}{dt} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}$. All terms on the right-hand side are evaluated at time step $n$.\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{1}{\\Delta x^2} \\left[ \\chi_{i+\\frac{1}{2}}^n(T_{i+1}^n - T_i^n) + \\chi_{i-\\frac{1}{2}}^n(T_{i-1}^n - T_i^n) \\right]\n$$\nSolving for $T_i^{n+1}$ gives the explicit update formula:\n$$\nT_i^{n+1} = T_i^n + \\frac{\\Delta t}{\\Delta x^2} \\left[ \\chi_{i+\\frac{1}{2}}^n(T_{i+1}^n - T_i^n) + \\chi_{i-\\frac{1}{2}}^n(T_{i-1}^n - T_i^n) \\right]\n$$\nTo derive the stability criterion, we rearrange the update formula to express $T_i^{n+1}$ as a linear combination of temperatures at step $n$:\n$$\nT_i^{n+1} = T_{i-1}^n \\left(\\frac{\\Delta t}{\\Delta x^2} \\chi_{i-\\frac{1}{2}}^n\\right) + T_{i+1}^n \\left(\\frac{\\Delta t}{\\Delta x^2} \\chi_{i+\\frac{1}{2}}^n\\right) + T_i^n \\left(1 - \\frac{\\Delta t}{\\Delta x^2}(\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n)\\right)\n$$\nA sufficient condition for the scheme to be monotonic (i.e., not create new extrema, which prevents non-physical oscillations and negative temperatures, given that $T^n > 0$) is that all coefficients in the linear combination for $T_i^{n+1}$ are non-negative.\nThe diffusivity $\\chi$ is always non-negative (since $\\chi \\ge \\chi_{\\min} > 0$), and $\\Delta t, \\Delta x^2 > 0$. Thus, the coefficients for $T_{i-1}^n$ and $T_{i+1}^n$ are non-negative. The only condition to enforce is on the coefficient of $T_i^n$:\n$$\n1 - \\frac{\\Delta t}{\\Delta x^2}(\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n) \\ge 0\n$$\nRearranging this inequality for $\\Delta t$ gives:\n$$\n\\Delta t \\le \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n}\n$$\nThis condition must hold for every computational cell $i=0, 1, \\dots, N-1$. Therefore, the global time step $\\Delta t$ must be bounded by the minimum of these local time step limits:\n$$\n\\Delta t \\le \\min_{i=0, \\dots, N-1} \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}}^n + \\chi_{i-\\frac{1}{2}}^n}\n$$\nThis establishes the required stability criterion. For the boundary cell $i=0$, the flux $F_{-\\frac{1}{2}}$ corresponds to the symmetry boundary condition. The problem states $(\\frac{\\partial T}{\\partial x})_{-\\frac{1}{2}}=0$, which implies $F_{-\\frac{1}{2}}=0$. The update for cell $i=0$ is:\n$$\n\\frac{d T_0}{dt} = \\frac{1}{\\Delta x^2} \\left[ \\chi_{\\frac{1}{2}}(T_1 - T_0) \\right]\n$$\nThe corresponding coefficient for $T_0^n$ in the forward-Euler update is $1 - \\frac{\\Delta t}{\\Delta x^2}\\chi_{\\frac{1}{2}}^n$. The stability condition is $\\Delta t \\le \\frac{\\Delta x^2}{\\chi_{\\frac{1}{2}}^n}$. This is consistent with the general formula if we set $\\chi_{-\\frac{1}{2}}^n = 0$, as explicitly instructed in the problem statement. The fixed temperature at $x=L$ means $T_N=T_{\\text{edge}}$ is a constant parameter, not a variable, and does not impose a stability constraint on itself. The cell $i=N-1$ is the last dynamic cell and its stability is covered by the general formula for $i=N-1$.\n\n**Task 2: Implementation Methodology**\n\nThe goal is to compute the maximum allowed time step, $\\Delta t_{\\max}$, for given initial conditions. This corresponds to evaluating the stability criterion at time $t=0$.\n$$\n\\Delta t_{\\max} = \\min_{i=0, \\dots, N-1} \\frac{\\Delta x^2}{\\chi_{i+\\frac{1}{2}} + \\chi_{i-\\frac{1}{2}}} = \\frac{\\Delta x^2}{\\max_{i=0, \\dots, N-1} (\\chi_{i+\\frac{1}{2}} + \\chi_{i-\\frac{1}{2}})}\n$$\nThe algorithm proceeds as follows for each test case:\n1.  **Grid and Profile Setup**: Set the physical and numerical constants $L, N, R, \\chi_{\\min}, \\chi_{\\text{amp}}, g_c, \\alpha, T_{\\text{edge}}$. Compute the grid spacing $\\Delta x = L/N$. Create an array of cell centers $x_i = (i+0.5)\\Delta x$ for $i=0, \\dots, N-1$. Evaluate the given initial temperature profile $T(x)$ at these cell centers to obtain the array $T_i$.\n\n2.  **Compute Face Quantities**: We need to evaluate the diffusivity $\\chi$ at all $N+1$ faces, from face $-\\frac{1}{2}$ (index $j=0$) to face $N-\\frac{1}{2}$ (index $j=N$).\n    - **Face Gradients**: An array of size $N+1$ is computed.\n        - Left boundary $(j=0)$: $(\\frac{\\partial T}{\\partial x})_{-\\frac{1}{2}} = 0$.\n        - Internal faces $(j=1, \\dots, N-1)$: $(\\frac{\\partial T}{\\partial x})_{j-\\frac{1}{2}} = (T_j - T_{j-1})/\\Delta x$.\n        - Right boundary $(j=N)$: $(\\frac{\\partial T}{\\partial x})_{N-\\frac{1}{2}} = (T_{\\text{edge}} - T_{N-1})/\\Delta x$.\n    - **Face Temperatures**: An array of size $N+1$ is computed.\n        - Left boundary $(j=0)$: $T_{-\\frac{1}{2}} = T_0$.\n        - Internal faces $(j=1, \\dots, N-1)$: $T_{j-\\frac{1}{2}} = \\frac{1}{2}(T_j + T_{j-1})$.\n        - Right boundary $(j=N)$: $T_{N-\\frac{1}{2}} = \\frac{1}{2}(T_{N-1} + T_{\\text{edge}})$.\n    - **Face Gradient Ratio, $g$**: Using the face gradients and temperatures, compute $g_{j-\\frac{1}{2}} = -R/T_{j-\\frac{1}{2}} \\cdot (\\frac{\\partial T}{\\partial x})_{j-\\frac{1}{2}}$ for all $j=0, \\dots, N$. All temperatures are assumed positive, so division by zero is not a concern.\n    - **Face Diffusivities, $\\chi$**: An array of size $N+1$ is computed using the formula $\\chi_{j-\\frac{1}{2}} = \\chi_{\\min} + \\chi_{\\text{amp}} \\,\\max(0, g_{j-\\frac{1}{2}} - g_c)^{\\alpha}$. After this calculation, the value at the left boundary face is overwritten per the problem instruction: $\\chi_{-\\frac{1}{2}} = 0$.\n\n3.  **Compute Stability Denominators**: For each cell $i=0, \\dots, N-1$, the stability denominator is $D_i = \\chi_{i+\\frac{1}{2}} + \\chi_{i-\\frac{1}{2}}$. This can be computed for all cells simultaneously using array operations on the face diffusivity array. If the face diffusivity array is `chi_faces` (indices $0, \\dots, N$), the denominator array for cells $0, \\dots, N-1$ is `chi_faces[1:] + chi_faces[:-1]`.\n\n4.  **Calculate $\\Delta t_{\\max}$**: Find the maximum value in the stability denominator array, $D_{\\max} = \\max_i D_i$. The maximum allowed time step is then $\\Delta t_{\\max} = \\Delta x^2 / D_{\\max}$. This value is the result for the test case.\n\nThis procedure is repeated for each of the four specified initial temperature profiles.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the maximum stable time step for a 1D nonlinear heat diffusion\n    problem using a finite-volume method with a critical gradient model.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    L = 1.0           # meters, slab width\n    N = 128           # number of cells\n    R = 3.0           # meters, major radius\n    chi_min = 0.30    # m^2/s, minimum diffusivity\n    chi_amp = 1.50    # m^2/s, turbulent diffusivity amplitude\n    gc = 6.0          # dimensionless, critical gradient\n    alpha = 1.0       # dimensionless, exponent\n    T_edge = 1.0      # keV, edge temperature\n\n    # --- Test Case Definitions ---\n    # Each tuple contains (T_core, profile_function_name)\n    test_cases = [\n        (15.0, \"quadratic\"),\n        (20.0, \"linear\"),\n        (2.0, \"quadratic\"),\n        (T_edge, \"uniform\") # For a uniform profile, T_core is the same as T_edge\n    ]\n\n    results = []\n\n    for T_core, profile_type in test_cases:\n        # --- Algorithm Implementation ---\n\n        # 1. Grid and Initial Profile Setup\n        dx = L / N\n        x_centers = (np.arange(N) + 0.5) * dx\n        \n        T_initial = np.zeros(N)\n        if profile_type == \"quadratic\":\n            T_initial = T_edge + (T_core - T_edge) * (1 - x_centers / L)**2\n        elif profile_type == \"linear\":\n            T_initial = T_edge + (T_core - T_edge) * (1 - x_centers / L)\n        elif profile_type == \"uniform\":\n            T_initial = np.full(N, T_edge)\n\n        # 2. Compute Face Quantities\n        # We define N+1 faces, indexed j=0...N, corresponding to\n        # physical faces at locations x_{-1/2}, x_{1/2}, ..., x_{N-1/2}.\n        grad_T_faces = np.zeros(N + 1)\n        T_faces = np.zeros(N + 1)\n\n        # Face Gradients\n        # j=0 (face -1/2): Left boundary\n        grad_T_faces[0] = 0.0\n        # j=1...N-1 (internal faces i+1/2 for i=0...N-2)\n        # Corresponds to faces x_{1/2} to x_{N-3/2}\n        grad_T_faces[1:N] = (T_initial[1:] - T_initial[:-1]) / dx\n        # j=N (face N-1/2): Right boundary\n        grad_T_faces[N] = (T_edge - T_initial[N - 1]) / dx\n        \n        # Face Temperatures\n        # j=0 (face -1/2): Left boundary\n        T_faces[0] = T_initial[0]\n        # j=1...N-1 (internal faces i+1/2 for i=0...N-2)\n        T_faces[1:N] = 0.5 * (T_initial[1:] + T_initial[:-1])\n        # j=N (face N-1/2): Right boundary\n        T_faces[N] = 0.5 * (T_initial[N - 1] + T_edge)\n        \n        # Face Gradient Ratio, g\n        # Problem assumes T > 0, so no division by zero check is needed.\n        g_faces = -R / T_faces * grad_T_faces\n\n        # Face Diffusivities, chi\n        g_factor = g_faces - gc\n        g_factor[g_factor < 0] = 0.0 # This implements max(0, g - gc)\n        chi_faces = chi_min + chi_amp * (g_factor**alpha)\n\n        # Enforce special boundary condition from problem statement\n        chi_faces[0] = 0.0\n\n        # 3. Compute Stability Denominators\n        # For cell i=0...N-1, denominator is chi_{i+1/2} + chi_{i-1/2}.\n        # This maps to chi_faces[i+1] + chi_faces[i].\n        # In NumPy, this is a sum of shifted slices.\n        denominators = chi_faces[1:] + chi_faces[:-1]\n\n        # 4. Calculate dt_max\n        max_denominator = np.max(denominators)\n        \n        # Guard against division by zero, though unlikely with chi_min > 0.\n        if max_denominator > 1e-12:\n            dt_max = (dx**2) / max_denominator\n        else:\n            # If all gradients are zero, denominator is 2*chi_min (or chi_min at boundary),\n            # so this branch shouldn't be taken unless chi_min is also zero.\n            # An infinite dt implies unconditional stability.\n            dt_max = np.inf\n            \n        results.append(dt_max)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}