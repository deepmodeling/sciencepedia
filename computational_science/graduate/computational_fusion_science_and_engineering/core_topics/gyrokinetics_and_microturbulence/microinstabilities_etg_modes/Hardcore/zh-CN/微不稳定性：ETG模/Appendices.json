{
    "hands_on_practices": [
        {
            "introduction": "许多简化的电子温度梯度（ETG）模式模型都依赖于准中性假设。本练习将通过检验德拜屏蔽的作用，来阐明为什么对于ETG湍流的小空间尺度而言，这是一个有效的近似。这项实践对于理解回旋动理学和流体模型的基本假设非常有价值。",
            "id": "4011292",
            "problem": "在托卡马克的核心区域，电子温度梯度 (ETG) 微观不稳定性发生在由电子回旋半径物理学所表征的垂直尺度上。在回旋动理学和流体描述中，一个关键的简化是忽略德拜屏蔽，这通常被概括为条件 $k_{\\perp} \\lambda_{D} \\ll 1$，其中 $k_{\\perp}$ 是垂直波数，$\\lambda_{D}$ 是电子德拜长度。从第一性原理出发，使用泊松方程和线性化等温电子响应来解释，为什么在 $k_{\\perp} \\lambda_{D} \\ll 1$ 的条件下，代表静电真空极化的项与等离子体极化相比可以忽略不计，从而证明在该标度下ETG动力学中的准中性是合理的。\n\n然后，对于一个典型的托卡马克核心，其电子密度 $n_{e} = 2.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$，电子温度 $T_{e} = 2.0\\,\\mathrm{keV}$，磁场强度 $B = 1.5\\,\\mathrm{T}$，使用基本常数估算电子德拜长度 $\\lambda_{D}$。你可以取元电荷 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，真空介电常数 $\\epsilon_{0} = 8.854187817 \\times 10^{-12}\\,\\mathrm{F/m}$，玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$，以及电子质量 $m_{e} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。作为背景，假设 ETG 湍流满足 $k_{\\perp} \\rho_{e} \\approx 0.3$，其中 $\\rho_{e}$ 是电子拉莫尔半径，定义为 $\\rho_{e} = v_{\\mathrm{th},e}/\\Omega_{ce}$，$v_{\\mathrm{th},e} = \\sqrt{2 k_{B} T_{e}/m_{e}}$，且 $\\Omega_{ce} = e B/m_{e}$。使用你估算的 $\\lambda_{D}$ 值来计算 $k_{\\perp} \\lambda_{D}$，并说明标度关系 $k_{\\perp} \\lambda_{D} \\ll 1$ 是否满足。\n\n将你对 $\\lambda_{D}$ 的最终数值估算四舍五入到三位有效数字，并以米为单位表示。最终报告的答案必须仅为 $\\lambda_{D}$ 的值。",
            "solution": "该问题被评估为有效，因为它在科学上基于等离子体物理学原理，问题明确，客观且内部一致。它提出了一个与聚变等离子体中微观不稳定性研究相关的标准理论推导和实际数值计算。\n\n根据要求，解答分为两部分：首先，对准中性近似的理论论证；其次，基于所提供的托卡马克参数进行数值估算。\n\n### 准中性的论证\n\n等离子体中的静电势与电荷密度之间的关系由泊松方程决定。对于形式为 $\\tilde{\\phi}(\\mathbf{x}) = \\tilde{\\phi} \\exp(i \\mathbf{k} \\cdot \\mathbf{x})$ 的静电扰动，其中 $\\tilde{\\phi}$ 是势振幅，$\\mathbf{k}$ 是波矢，拉普拉斯算子 $\\nabla^2$ 变为 $-k^2$。我们关注垂直于磁场的动力学，因此使用垂直波数 $k_{\\perp}$。傅里叶空间中的泊松方程为：\n$$\n-k_{\\perp}^2 \\tilde{\\phi} = -\\frac{\\tilde{\\rho}_{\\text{charge}}}{\\epsilon_0}\n$$\n其中 $\\tilde{\\rho}_{\\text{charge}}$ 是扰动电荷密度，$\\epsilon_0$ 是真空介电常数。电荷密度由离子和电子贡献，对于含有单电荷离子 ($Z=1$) 的等离子体，$\\tilde{\\rho}_{\\text{charge}} = e(\\tilde{n}_i - \\tilde{n}_e)$。将此代入泊松方程得到：\n$$\n\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi} = e(\\tilde{n}_e - \\tilde{n}_i)\n$$\n该方程表明，等离子体中的净电荷分离 $e(\\tilde{n}_i - \\tilde{n}_e)$ 与项 $\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}$ 相平衡，后者可以解释为与真空中电势结构相关的电荷密度。问题将此项称为“静电真空极化”。目标是证明在 $k_{\\perp} \\lambda_D \\ll 1$ 的条件下，此项可以忽略不计。\n\n问题指定使用线性化等温电子响应。对于沿磁力线移动的电子，其密度扰动 $\\tilde{n}_e$ 通常假定遵循与静电势扰动 $\\tilde{\\phi}$ 的玻尔兹曼关系。该关系的线性化形式为：\n$$\n\\frac{\\tilde{n}_e}{n_{e0}} = \\frac{e \\tilde{\\phi}}{T_e}\n$$\n其中 $n_{e0}$ 是平衡电子密度，$T_e$ 是以能量单位（焦耳）表示的电子温度。这使我们能够用电势来表示扰动电子电荷密度 $\\rho_{e,k} = -e\\tilde{n}_e$：\n$$\n-e \\tilde{n}_e = - \\frac{n_{e0} e^2}{T_e} \\tilde{\\phi}\n$$\n右边的量是“等离子体极化”的一个组成部分。现在，让我们回到泊松方程，重写为：\n$$\ne(\\tilde{n}_i - \\tilde{n}_e) = \\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}\n$$\n右边的项 $\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}$ 代表傅里叶空间中的净电荷密度涨落。让我们将这个净电荷密度的量级与电子电荷密度涨落的量级 $|-e\\tilde{n}_e|$ 进行比较：\n$$\n\\frac{|\\text{net charge density}|}{|\\text{electron charge density}|} = \\frac{|\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}|}{|-e \\tilde{n}_e|} = \\frac{|\\epsilon_0 k_{\\perp}^2 \\tilde{\\phi}|}{|-\\frac{n_{e0} e^2}{T_e} \\tilde{\\phi}|} = \\frac{\\epsilon_0 k_{\\perp}^2 T_e}{n_{e0} e^2}\n$$\n我们识别出电子德拜长度 $\\lambda_D$，其定义关系为：\n$$\n\\lambda_D^2 = \\frac{\\epsilon_0 T_e}{n_{e0} e^2}\n$$\n将此定义代入我们的比值中，得到：\n$$\n\\frac{|\\text{net charge density}|}{|\\text{electron charge density}|} = k_{\\perp}^2 \\lambda_D^2 = (k_{\\perp} \\lambda_D)^2\n$$\n问题陈述了标度关系 $k_{\\perp} \\lambda_D \\ll 1$。在此极限下，$(k_{\\perp} \\lambda_D)^2 \\ll 1$。这意味着：\n$$\n|\\text{net charge density}| \\ll |\\text{electron charge density}|\n$$\n就粒子密度而言，这意味着 $|e(\\tilde{n}_i - \\tilde{n}_e)| \\ll |-e \\tilde{n}_e|$。这只有在离子和电子的电荷扰动几乎相互抵消时才成立，即 $e \\tilde{n}_i \\approx e \\tilde{n}_e$，从而导出准中性条件：\n$$\n\\tilde{n}_i \\approx \\tilde{n}_e\n$$\n因此，条件 $k_{\\perp} \\lambda_D \\ll 1$ 证明了与单个粒子种类的电荷扰动（“等离子体极化”）相比，可以忽略净电荷分离（“真空极化”项），这直接导出了许多流体和回旋动理学模型中使用的准中性近似。\n\n### 数值估算与验证\n\n接下来，我们针对给定的托卡马克核心参数计算相关量。给定的参数是：\n- 电子密度: $n_e = 2.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$\n- 电子温度: $T_e = 2.0\\,\\mathrm{keV}$\n- 磁场: $B = 1.5\\,\\mathrm{T}$\n\n首先，我们将电子温度转换为国际单位制（焦耳）。单位 keV 代表能量，因此我们使用元电荷进行转换。\n$$\nT_e [\\mathrm{J}] = (2.0 \\times 10^3\\,\\mathrm{eV}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 3.204353268 \\times 10^{-16}\\,\\mathrm{J}\n$$\n请注意，由于给定的 $T_e$ 是能量单位，标准公式中的 $k_B T_e$ 项将被此值取代。\n\n**1. 电子德拜长度 ($\\lambda_D$)**\n德拜长度的公式是 $\\lambda_D = \\sqrt{\\epsilon_0 T_e / (n_e e^2)}$，其中 $T_e$ 的单位是焦耳。\n$$\n\\lambda_D = \\sqrt{\\frac{(8.854187817 \\times 10^{-12}\\,\\mathrm{F/m}) \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{(2.0 \\times 10^{20}\\,\\mathrm{m}^{-3}) \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{C})^2}}\n$$\n$$\n\\lambda_D \\approx 2.35082 \\times 10^{-5}\\,\\mathrm{m}\n$$\n四舍五入到三位有效数字，电子德拜长度为 $\\lambda_D = 2.35 \\times 10^{-5}\\,\\mathrm{m}$。\n\n**2. 标度关系 $k_{\\perp} \\lambda_D \\ll 1$ 的验证**\n为了检验这个标度关系，我们首先需要估算 $k_{\\perp}$。根据给定的背景信息，对于 ETG 湍流，$k_{\\perp} \\rho_e \\approx 0.3$，其中 $\\rho_e$ 是电子拉莫尔半径。我们必须计算 $\\rho_e = v_{\\mathrm{th},e} / \\Omega_{ce}$。\n\n电子热速度由 $v_{\\mathrm{th},e} = \\sqrt{2 T_e / m_e}$ 给出（其中 $T_e$ 以焦耳为单位）：\n$$\nv_{\\mathrm{th},e} = \\sqrt{\\frac{2 \\times (3.204353268 \\times 10^{-16}\\,\\mathrm{J})}{9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}}} \\approx 2.65241 \\times 10^7\\,\\mathrm{m/s}\n$$\n电子回旋频率为 $\\Omega_{ce} = e B / m_e$：\n$$\n\\Omega_{ce} = \\frac{(1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\times (1.5\\,\\mathrm{T})}{9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}} \\approx 2.63819 \\times 10^{11}\\,\\mathrm{rad/s}\n$$\n因此，电子拉莫尔半径为：\n$$\n\\rho_e = \\frac{v_{\\mathrm{th},e}}{\\Omega_{ce}} = \\frac{2.65241 \\times 10^7\\,\\mathrm{m/s}}{2.63819 \\times 10^{11}\\,\\mathrm{s}^{-1}} \\approx 1.00539 \\times 10^{-4}\\,\\mathrm{m}\n$$\n使用 ETG 模式的典型值 $k_{\\perp} \\rho_e = 0.3$，我们求得 $k_{\\perp}$：\n$$\nk_{\\perp} = \\frac{0.3}{\\rho_e} = \\frac{0.3}{1.00539 \\times 10^{-4}\\,\\mathrm{m}} \\approx 2983.9\\,\\mathrm{m}^{-1}\n$$\n最后，我们可以计算乘积 $k_{\\perp} \\lambda_D$：\n$$\nk_{\\perp} \\lambda_D = (2983.9\\,\\mathrm{m}^{-1}) \\times (2.35082 \\times 10^{-5}\\,\\mathrm{m}) \\approx 0.07015\n$$\n结果是 $k_{\\perp} \\lambda_D \\approx 0.07$。由于 $0.07 \\ll 1$，对于托卡马克核心中这些典型的 ETG 不稳定性参数，该标度关系很好地满足。这证实了准中性近似是研究该区域 ETG 湍流的一个高度准确且合理的简化方法。\n\n最终答案要求的特定值是 $\\lambda_D$ 的数值估算。",
            "answer": "$$\n\\boxed{2.35 \\times 10^{-5}}\n$$"
        },
        {
            "introduction": "湍流并不会无限增长；它受到自发产生的结构（如纬向流）的调节。本练习通过计算 $\\boldsymbol{E} \\times \\boldsymbol{B}$ 流的剪切率，并将其与不稳定性的增长率进行比较，提供了一种量化这种效应的具体方法。这是理解非线性饱和机制的一项关键技能。",
            "id": "4011291",
            "problem": "考虑一个具有均匀磁场 $B \\hat{\\boldsymbol{z}}$ 的板状等离子体，这代表了托卡马克核心区的局域几何构型。在这种构型中，电子温度梯度（ETG）模是线性不稳定的，其特征增长率 $\\gamma$ 可通过线性回旋动理学计算独立获得。在存在径向变化的纬向静电势 $\\phi(x)$ 的情况下，相关的 $\\boldsymbol{E} \\times \\boldsymbol{B}$ 流会产生一个极向速度 $v_y(x)$ 和一个剪切率。如果该剪切率超过线性增长率，便可以抑制湍流。\n\n从静电学和横场漂移的基本关系式，即 $ \\boldsymbol{E} = -\\nabla \\phi $ 和 $ \\boldsymbol{v}_E = \\boldsymbol{E} \\times \\boldsymbol{B} / B^2 $ 出发，推导在特定情况 $\\phi(x) = \\phi_0 \\cos(k_x x)$ 下，纬向流剪切率 $\\omega_E$ 关于纬向势 $\\phi(x)$ 和磁场 $B$ 的表达式。利用此表达式计算剪切率的振幅，并将其与给定的ETG线性增长率进行比较。\n\n参数：\n- 磁场强度 $B = 3.2 \\ \\mathrm{T}$。\n- 纬向势振幅 $\\phi_0 = 0.85 \\ \\mathrm{V}$。\n- 纬向径向波数 $k_x = 4.2 \\times 10^{3} \\ \\mathrm{m}^{-1}$。\n- 线性ETG增长率 $\\gamma = 3.9 \\times 10^{6} \\ \\mathrm{s}^{-1}$。\n\n任务：\n1. 使用上述定义，推导与给定 $\\phi(x)$ 对应的剪切率 $\\omega_E$，并以 $\\mathrm{s}^{-1}$ 为单位计算其振幅。\n2. 计算无量纲比 $R = \\omega_E / \\gamma$，并判断纬向剪切是否能抑制ETG（启发式抑制判据为 $R \\geq 1$）。\n\n将您的最终答案表示为单一的无量纲比 $R$。将最终比值四舍五入到四位有效数字。由于该比值为无量纲，因此不需要单位。",
            "solution": "问题陈述已经过验证，被确定为科学上合理、内容完备且问题明确。其物理模型和参数在计算聚变科学领域是标准的。因此，我们可以进行推导和计算。\n\n目标是推导纬向流剪切率 $\\omega_E$ 的表达式，然后计算无量纲比 $R$。我们从给出的基本定义开始。\n\n静电势 $\\phi$ 仅依赖于径向坐标 $x$，因此 $\\phi = \\phi(x)$。电场 $\\boldsymbol{E}$ 由电势的负梯度给出：\n$$\n\\boldsymbol{E} = -\\nabla \\phi = -\\frac{d\\phi}{dx} \\hat{\\boldsymbol{x}}\n$$\n磁场是均匀的，并沿着 $\\hat{\\boldsymbol{z}}$ 轴方向，即 $\\boldsymbol{B} = B \\hat{\\boldsymbol{z}}$。$\\boldsymbol{E} \\times \\boldsymbol{B}$ 漂移速度 $\\boldsymbol{v}_E$ 定义为：\n$$\n\\boldsymbol{v}_E = \\frac{\\boldsymbol{E} \\times \\boldsymbol{B}}{B^2}\n$$\n代入 $\\boldsymbol{E}$ 和 $\\boldsymbol{B}$ 的表达式：\n$$\n\\boldsymbol{v}_E = \\frac{(-\\frac{d\\phi}{dx} \\hat{\\boldsymbol{x}}) \\times (B \\hat{\\boldsymbol{z}})}{B^2} = \\frac{-\\frac{d\\phi}{dx} B}{B^2} (\\hat{\\boldsymbol{x}} \\times \\hat{\\boldsymbol{z}})\n$$\n使用右手笛卡尔坐标系中的矢量叉乘恒等式 $\\hat{\\boldsymbol{x}} \\times \\hat{\\boldsymbol{z}} = -\\hat{\\boldsymbol{y}}$，我们得到：\n$$\n\\boldsymbol{v}_E = -\\frac{1}{B}\\frac{d\\phi}{dx}(-\\hat{\\boldsymbol{y}}) = \\frac{1}{B}\\frac{d\\phi}{dx} \\hat{\\boldsymbol{y}}\n$$\n该速度完全在极向（$\\hat{\\boldsymbol{y}}$）方向上，其大小随径向坐标 $x$ 变化。因此，极向速度分量为 $v_y(x) = \\frac{1}{B} \\frac{d\\phi}{dx}$。\n\n该速度场的剪切率是其对径向坐标 $x$ 的空间导数：\n$$\n\\text{剪切率} = \\frac{dv_y}{dx} = \\frac{d}{dx} \\left(\\frac{1}{B} \\frac{d\\phi}{dx}\\right)\n$$\n由于磁场强度 $B$ 是常数，我们可以写成：\n$$\n\\frac{dv_y}{dx} = \\frac{1}{B} \\frac{d^2\\phi}{dx^2}\n$$\n问题要求的是剪切率振幅 $\\omega_E$，即该量的最大绝对值。\n$$\n\\omega_E = \\max\\left| \\frac{dv_y}{dx} \\right| = \\frac{1}{B} \\max\\left| \\frac{d^2\\phi}{dx^2} \\right|\n$$\n我们已知纬向势的具体形式为：$\\phi(x) = \\phi_0 \\cos(k_x x)$。我们必须计算它的二阶导数。\n一阶导数是：\n$$\n\\frac{d\\phi}{dx} = \\frac{d}{dx} [\\phi_0 \\cos(k_x x)] = -\\phi_0 k_x \\sin(k_x x)\n$$\n二阶导数是：\n$$\n\\frac{d^2\\phi}{dx^2} = \\frac{d}{dx} [-\\phi_0 k_x \\sin(k_x x)] = -\\phi_0 k_x^2 \\cos(k_x x)\n$$\n二阶导数的最大绝对值出现在 $|\\cos(k_x x)| = 1$ 时。因此：\n$$\n\\max\\left| \\frac{d^2\\phi}{dx^2} \\right| = |-\\phi_0 k_x^2| = \\phi_0 k_x^2\n$$\n将此结果代入 $\\omega_E$ 的表达式中，我们得到剪切率振幅：\n$$\n\\omega_E = \\frac{\\phi_0 k_x^2}{B}\n$$\n这完成了任务的第一部分。现在，我们代入给定的数值来计算 $\\omega_E$，然后计算比值 $R$。\n参数为：\n- $B = 3.2 \\ \\mathrm{T}$\n- $\\phi_0 = 0.85 \\ \\mathrm{V}$\n- $k_x = 4.2 \\times 10^3 \\ \\mathrm{m}^{-1}$\n- $\\gamma = 3.9 \\times 10^6 \\ \\mathrm{s}^{-1}$\n\n首先，我们计算 $\\omega_E$：\n$$\n\\omega_E = \\frac{(0.85) \\times (4.2 \\times 10^3)^2}{3.2} = \\frac{0.85 \\times 17.64 \\times 10^6}{3.2} \\ \\mathrm{s}^{-1}\n$$\n$$\n\\omega_E = \\frac{14.994 \\times 10^6}{3.2} \\ \\mathrm{s}^{-1} = 4.685625 \\times 10^6 \\ \\mathrm{s}^{-1}\n$$\n第二个任务是计算无量纲比 $R = \\omega_E / \\gamma$：\n$$\nR = \\frac{4.685625 \\times 10^6 \\ \\mathrm{s}^{-1}}{3.9 \\times 10^6 \\ \\mathrm{s}^{-1}} = \\frac{4.685625}{3.9} \\approx 1.20144230769\n$$\n根据要求将结果四舍五入到四位有效数字：\n$$\nR \\approx 1.201\n$$\n根据启发式抑制判据 $R \\ge 1$，计算出的值表明纬向流剪切足够强，可以抑制ETG湍流。最终答案是 $R$ 的值。",
            "answer": "$$\n\\boxed{1.201}\n$$"
        },
        {
            "introduction": "托卡马克的几何构型对不稳定性有显著影响，而球形高阶模方法是研究这种影响的有力工具。本练习要求你为一个简化的ETG模式结构模型构建一个数值求解器，让你直接体验用于预测真实几何构型中模式特性的计算方法。",
            "id": "4011253",
            "problem": "要求您使用气球模形式论，在环形几何中设计并实现一个用于求解电子温度梯度（ETG）微观不稳定性模结构的数值求解器。任务是计算沿气球模坐标的模结构，并将该模分类为局域于外侧中平面附近或沿磁力线延伸。本问题中的所有量均采用无量纲的回旋动理学归一化表示，因此不需要物理单位。\n\n从均匀磁通管中静电ETG涨落的线性回旋动理学气球模简化出发，其中模结构是沿磁力线的气球模角坐标$\\theta$的函数。通常，由磁剪切引起的垂直波数变化通过以下关系式建模\n$k_{\\perp}(\\theta)^2 = k_y^2(1 + s^2\\theta^2),$\n其中 $k_y$ 是副法线波数，$s$ 是磁剪切。有限拉莫尔半径效应引入了一个与$k_{\\perp}(\\theta)^2$成正比的稳定项，而环向曲率和电子温度梯度则驱动一个有效的、局域在$\\theta = 0$附近的外侧中平面坏曲率区的不稳定贡献。\n\n利用这些具有物理动机的要素，构建并求解关于静电势模结构$\\phi(\\theta)$的一维类薛定谔本征值问题，\n$$\n-\\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}\\theta^2} + V(\\theta)\\,\\phi(\\theta) = \\lambda\\,\\phi(\\theta),\n$$\n该问题定义在有限区间$\\theta \\in [-\\theta_{\\max},\\theta_{\\max}]$上，并采用齐次狄利克雷边界条件$\\phi(-\\theta_{\\max}) = \\phi(\\theta_{\\max}) = 0$。有效势$V(\\theta)$定义为\n$$\nV(\\theta) = \\beta\\,\\big(1 + s^2\\,\\theta^2\\big) - D\\,\\exp\\left(-\\frac{\\theta^2}{\\theta_w^2}\\right),\n$$\n其中$\\beta = (k_y\\rho_e)^2$，$\\rho_e$是归一化中使用的电子拉莫尔半径，$D$是曲率和梯度驱动的幅度（较大的$D$会增强驱动），而$\\theta_w$是$\\theta=0$附近坏曲率驱动的特征宽度。该模型描述了由剪切和有限拉莫尔半径引起的稳定化垂直尺度增长与局域在$\\theta=0$附近的非稳定化曲率驱动之间的竞争。\n\n您的程序必须：\n- 使用二阶中心有限差分格式对二阶导数进行离散化，从而离散化算子$-\\mathrm{d}^2/\\mathrm{d}\\theta^2 + V(\\theta)$。仅在内部网格点上构建离散算子，以施加齐次狄利克雷边界条件。\n- 计算基态本征对$(\\lambda_0,\\phi_0(\\theta))$，其中$\\lambda_0$是最小的代数本征值，$\\phi_0$是其关联的归一化本征函数，满足\n$$\n\\sum_{i} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta = 1,\n$$\n其中$\\Delta\\theta$是网格间距，$\\theta_i$是网格点。\n- 使用以下规则将模分类为局域化或流光状：计算分数\n$$\n\\mathcal{F} = \\frac{\\sum_{|\\theta_i| \\le \\theta_c} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta}{\\sum_{\\text{all } i} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta},\n$$\n其中核心窗口为$|\\theta| \\le \\theta_c$。如果$\\mathcal{F} \\ge T$，则声明该模在$\\theta = 0$附近是局域化的；否则，声明它表现为延伸的流光。使用$\\theta_c = 0.8$和阈值$T = 0.55$。\n- 对于所有计算，使用一个包含端点在内的$N$个点的均匀网格，并使用内部点进行算子组装。您可以选择任何能够得到数值稳定解的合理$N$值，但该选择必须在所有测试用例中保持一致。\n\n测试套件：\n为以下四个参数集提供结果，每个参数集指定为$(s,\\;k_y\\rho_e,\\;D,\\;\\theta_w,\\;\\theta_{\\max})$：\n1. $s = 0.7$, $k_y\\rho_e = 0.4$, $D = 3.0$, $\\theta_w = 0.8$, $\\theta_{\\max} = 5.0$.\n2. $s = 0.05$, $k_y\\rho_e = 0.2$, $D = 1.2$, $\\theta_w = 2.5$, $\\theta_{\\max} = 8.0$.\n3. $s = 0.3$, $k_y\\rho_e = 0.3$, $D = 1.8$, $\\theta_w = 1.3$, $\\theta_{\\max} = 6.0$.\n4. $s = 0.8$, $k_y\\rho_e = 0.7$, $D = 2.0$, $\\theta_w = 0.7$, $\\theta_{\\max} = 5.0$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的分类结果，按顺序排列，格式为一个用方括号括起来的、逗号分隔的Python布尔值列表，例如 `[True,False,...]`，其中`True`表示在$\\theta = 0$附近局域化，`False`表示延伸的流光。不应打印任何额外文本。",
            "solution": "所提出的问题是计算等离子体物理学中一个有效、适定且科学上合理的练习。它要求数值求解一个一维类薛定谔本征值问题，这是使用气球模形式论研究环形聚变等离子体中电子温度梯度（ETG）微观不稳定性的标准简化模型。所有必要的参数、方程和边界条件均已提供，且没有违反任何科学原理。\n\n问题的核心是求解静电势模结构 $\\phi(\\theta)$ 的本征值方程：\n$$\n-\\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}\\theta^2} + V(\\theta)\\,\\phi(\\theta) = \\lambda\\,\\phi(\\theta)\n$$\n该方程定义在域 $\\theta \\in [-\\theta_{\\max}, \\theta_{\\max}]$上，边界条件为齐次狄利克雷条件 $\\phi(\\pm\\theta_{\\max}) = 0$。势 $V(\\theta)$ 由下式给出：\n$$\nV(\\theta) = \\beta\\,\\big(1 + s^2\\,\\theta^2\\big) - D\\,\\exp\\! \\left(-\\frac{\\theta^2}{\\theta_w^2}\\right)\n$$\n其中 $\\beta = (k_y\\,\\rho_e)^2$。该方程模拟了与 $\\beta(1 + s^2\\theta^2)$ 成正比的稳定项（代表由磁剪切引起的垂直波数 $k_\\perp$ 的增加）和与 $D$ 成正比的、局域在 $\\theta=0$ 附近坏曲率区的不稳定驱动项之间的竞争。\n\n为了数值求解此问题，我们将在均匀网格上离散化微分算子，并将微分方程转换为矩阵本征值问题。\n\n首先，我们在域 $[-\\theta_{\\max}, \\theta_{\\max}]$ 上定义一个包含 $N$ 个点的均匀网格。设网格点为 $\\theta_i = -\\theta_{\\max} + i\\,\\Delta\\theta$，其中 $i=0, 1, \\dots, N-1$，网格间距为 $\\Delta\\theta = \\frac{2\\theta_{\\max}}{N-1}$。为保证数值稳定性和准确性，需要足够多的网格点。我们选择 $N=1001$，这能确保所有测试用例都有一个精细的网格，并且包含 $\\theta=0$ 这个点。\n\n二阶导数 $\\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}\\theta^2}$ 在每个内部网格点 $\\theta_j$（$j=1, \\dots, N-2$）处使用二阶中心有限差分格式进行近似：\n$$\n\\frac{\\mathrm{d}^2 \\phi}{\\mathrm{d}\\theta^2} \\bigg|_{\\theta_j} \\approx \\frac{\\phi(\\theta_{j+1}) - 2\\phi(\\theta_j) + \\phi(\\theta_{j-1})}{(\\Delta\\theta)^2} = \\frac{\\phi_{j+1} - 2\\phi_j + \\phi_{j-1}}{(\\Delta\\theta)^2}\n$$\n将此近似代入内部点 $\\theta_j$ 的薛定谔方程，得到：\n$$\n-\\frac{\\phi_{j+1} - 2\\phi_j + \\phi_{j-1}}{(\\Delta\\theta)^2} + V(\\theta_j)\\phi_j = \\lambda \\phi_j\n$$\n整理各项，我们得到：\n$$\n-\\frac{1}{(\\Delta\\theta)^2}\\phi_{j-1} + \\left(\\frac{2}{(\\Delta\\theta)^2} + V(\\theta_j)\\right)\\phi_j - \\frac{1}{(\\Delta\\theta)^2}\\phi_{j+1} = \\lambda \\phi_j\n$$\n齐次狄利克雷边界条件为 $\\phi_0 = 0$ 和 $\\phi_{N-1} = 0$。这些条件通过仅为 $N-2$ 个内部点构建方程组来施加。$j=1$ 的方程涉及 $\\phi_0=0$，$j=N-2$ 的方程涉及 $\\phi_{N-1}=0$。这产生了一个矩阵本征值问题 $A\\mathbf{x} = \\lambda\\mathbf{x}$，其中 $\\mathbf{x} = [\\phi_1, \\phi_2, \\dots, \\phi_{N-2}]^T$ 是本征函数在内部点上的值构成的向量。矩阵 $A$ 是一个大小为 $(N-2) \\times (N-2)$ 的实对称三对角矩阵，其元素如下：\n$$\nA_{jj} = \\frac{2}{(\\Delta\\theta)^2} + V(\\theta_j)\n$$\n$$\nA_{j, j+1} = A_{j+1, j} = -\\frac{1}{(\\Delta\\theta)^2}\n$$\n我们求解基态本征对 $(\\lambda_0, \\phi_0)$，其中 $\\lambda_0$ 是 $A$ 的最小本征值。这可以使用数值线性代数库高效地计算。我们将使用 `scipy.linalg.eigh_tridiagonal`，它针对此类矩阵进行了优化。该函数返回按升序排列的本征值及其对应的本征向量。\n\n设对应于 $\\lambda_0$ 的本征向量为 $\\mathbf{v}_0$。该向量包含本征函数在内部点的值。根据边界条件，通过在两端用零填充来构建网格上的完整、未归一化的本征函数：$\\vec{\\phi}_{\\text{unnormalized}} = [0, v_{0,1}, \\dots, v_{0, N-2}, 0]^T$。\n\n下一步是根据条件 $\\sum_{i=0}^{N-1} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta = 1$ 对本征函数进行归一化。归一化常数 $C$ 通过要求 $C^2 \\sum_{i=0}^{N-1} |\\phi_{\\text{unnormalized},i}|^2\\,\\Delta\\theta = 1$ 来找到。归一化后的本征函数则为 $\\vec{\\phi}_0 = C \\cdot \\vec{\\phi}_{\\text{unnormalized}}$。\n\n最后，我们对模结构进行分类。我们计算在核心窗口 $|\\theta| \\le \\theta_c = 0.8$ 内包含的模的“概率密度”分数 $\\mathcal{F}$：\n$$\n\\mathcal{F} = \\frac{\\sum\\limits_{|\\theta_i| \\le \\theta_c} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta}{\\sum\\limits_{\\text{all } i} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta}\n$$\n由于我们的归一化，分母为1。因此，计算简化为 $\\mathcal{F} = \\sum_{|\\theta_i| \\le \\theta_c} |\\phi_0(\\theta_i)|^2\\,\\Delta\\theta$。如果 $\\mathcal{F} \\ge T=0.55$，则该模被分类为‘局域化’，否则为‘延伸’。对测试套件中提供的每个参数集重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Main function to solve the ETG mode structure problem for the given test cases.\n    \"\"\"\n    # Test Suite: Each tuple is (s, k_y*rho_e, D, theta_w, theta_max)\n    test_cases = [\n        (0.7, 0.4, 3.0, 0.8, 5.0),\n        (0.05, 0.2, 1.2, 2.5, 8.0),\n        (0.3, 0.3, 1.8, 1.3, 6.0),\n        (0.8, 0.7, 2.0, 0.7, 5.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        is_loc = is_mode_localized(*params)\n        results.append(is_loc)\n\n    # Final print statement in the exact required format.\n    # The map(str,...) converts boolean True/False to \"True\"/\"False\" string literals.\n    print(f\"[{','.join(map(str, results))}]\")\n\n\ndef is_mode_localized(s, ky_rho_e, D, theta_w, theta_max):\n    \"\"\"\n    Solves the 1D Schrödinger eigenvalue problem for a single parameter set and\n    classifies the ground state mode as localized or extended.\n\n    Args:\n        s (float): Magnetic shear.\n        ky_rho_e (float): Normalized binormal wavenumber.\n        D (float): Drive amplitude.\n        theta_w (float): Width of the drive.\n        theta_max (float): Boundary of the ballooning coordinate domain.\n\n    Returns:\n        bool: True if the mode is localized, False otherwise.\n    \"\"\"\n    # Numerical and classification parameters\n    N = 1001  # Number of grid points (must be odd to include theta=0)\n    theta_c = 0.8  # Core window half-width for classification\n    T = 0.55  # Threshold for localization classification\n\n    # 1. Set up the grid\n    theta = np.linspace(-theta_max, theta_max, N)\n    delta_theta = theta[1] - theta[0]\n\n    # We solve for the eigenfunction on the interior points\n    theta_interior = theta[1:-1]\n\n    # 2. Construct the potential V(theta)\n    beta = ky_rho_e**2\n    V = beta * (1.0 + s**2 * theta_interior**2) - D * np.exp(-(theta_interior**2) / theta_w**2)\n\n    # 3. Construct the tridiagonal matrix for the operator -d^2/d(theta)^2 + V\n    # The matrix A is defined by its diagonal (d) and off-diagonal (e) elements.\n    d = 2.0 / delta_theta**2 + V\n    e = -1.0 / delta_theta**2 * np.ones(N - 3) # Off-diagonal has N-3 elements\n\n    # 4. Solve the eigenvalue problem\n    # eigh_tridiagonal returns eigenvalues sorted in ascending order and corresponding\n    # normalized eigenvectors.\n    eigenvalues, eigenvectors = eigh_tridiagonal(d, e)\n\n    # The ground state is the one with the smallest eigenvalue (the first one)\n    ground_state_vector = eigenvectors[:, 0]\n\n    # 5. Reconstruct and normalize the full eigenfunction\n    # Add zeros at the boundaries for phi(-theta_max) and phi(theta_max)\n    phi_full = np.concatenate(([0.0], ground_state_vector, [0.0]))\n\n    # Normalize the eigenfunction such that sum(|phi|^2 * delta_theta) = 1\n    # This is a numerical integration of |phi|^2 over the domain.\n    norm_integral = np.sum(phi_full**2) * delta_theta\n    phi_normalized = phi_full / np.sqrt(norm_integral)\n\n    # 6. Classify the mode\n    # Find indices within the core window |theta| = theta_c\n    core_indices = np.where(np.abs(theta) = theta_c)[0]\n\n    # Calculate the fraction F. The denominator is 1 due to normalization.\n    F = np.sum(phi_normalized[core_indices]**2) * delta_theta\n\n    # Compare with a threshold T to classify\n    return F >= T\n\n# Execute the solver\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}