{
    "hands_on_practices": [
        {
            "introduction": "在我们能够校正误差场之前，必须首先确定哪些磁场分量最具危害性。本练习将我们的理解建立在磁流体动力学（MHD）的基本共振条件 $q = m/n$ 之上，帮助您识别哪些磁扰动谐波会与等离子体发生共振相互作用，并评估其潜在影响。这是设计有效校正策略的关键第一步。",
            "id": "3979168",
            "problem": "考虑一个环形、大环径比托卡马克的边界区域，该区域的静态固有误差场由外部误差场校正线圈校正。磁安全因子 $q$ 定义为磁力线每绕极向一圈所绕的环向圈数。有理面出现在磁力线经过有限次数的极向和环向穿越后映射闭合的位置，这意味着存在整数 $m$ 和 $n$，使得在该磁力线上磁力线满足 $q = m/n$。在线性磁流体力学（MHD）中，由整数极向模数 $m$ 和环向模数 $n$ 标记的螺旋磁扰动谐波，在扰动螺旋度与磁力线螺距相匹配的磁力面上与等离子体发生共振耦合，这个共振条件是等离子体旋转上增强的电磁制动转矩的来源。\n\n假设在主要的误差场-等离子体耦合发生的窄环带上，边缘安全因子为 $q = 2.5$。考虑外加的静态误差场谐波，其极向模数 $m \\in \\{1,2,3,4,5\\}$，环向模数为正整数 $n \\in \\mathbb{Z}^{+}$。仅使用安全因子的定义和有理面闭合条件，确定对于给定的 $m$ 值，哪些 $n$ 次谐波是精确共振的。此外，基于线性粘滞-电阻等离子体响应的第一性原理以及麦克斯韦应力的结构，论证哪个共振谐波最可能对维持环向旋转有害，并说明原因，同时参考有理层响应结构所隐含的关于 $n$ 的一般标度趋势。\n\n请将最终答案表示为在给定 $m$ 值中产生共振的单个整数 $n$。无需四舍五入。请将最终答案表示为一个无量纲整数。",
            "solution": "问题陈述经评估具有科学依据、良定，并包含足够信息以获得唯一解。因此，我们可以继续进行分析。\n\n该问题要求我们识别托卡马克等离子体中的共振磁扰动谐波，并为其对等离子体旋转的相对影响提供物理上的论证。当外部磁扰动（由极向模数 $m$ 和环向模数 $n$ 表征）的螺旋度与特定磁通面上磁力线的螺旋度相匹配时，就会发生共振相互作用。这一条件在数学上表示为该磁面上的安全因子 $q$ 等于模数之比。\n\n共振谐波的基本条件由下式给出：\n$$\nq = \\frac{m}{n}\n$$\n其中 $q$ 是安全因子， $m$ 是极向模数， $n$ 是环向模数。\n\n问题提供了以下数据：\n- 目标边缘区域的安全因子为 $q = 2.5$。\n- 可能的极向模数集合为 $m \\in \\{1, 2, 3, 4, 5\\}$。\n- 环向模数 $n$ 必须是正整数，即 $n \\in \\mathbb{Z}^{+}$。\n\n我们可以将 $q$ 的值代入共振条件。将 $q$ 的小数值表示为有理数会很方便：\n$$\nq = 2.5 = \\frac{5}{2}\n$$\n因此，共振条件变为：\n$$\n\\frac{5}{2} = \\frac{m}{n}\n$$\n我们可以重新整理这个方程，以 $m$ 来解 $n$：\n$$\nn = \\frac{2m}{5}\n$$\n现在，我们必须从给定的集合 $\\{1, 2, 3, 4, 5\\}$ 中找到使 $n$ 为正整数的 $m$ 值。我们测试每个可能的 $m$ 值：\n- 对于 $m=1$：$n = \\frac{2(1)}{5} = \\frac{2}{5}$。这不是一个整数。\n- 对于 $m=2$：$n = \\frac{2(2)}{5} = \\frac{4}{5}$。这不是一个整数。\n- 对于 $m=3$：$n = \\frac{2(3)}{5} = \\frac{6}{5}$。这不是一个整数。\n- 对于 $m=4$：$n = \\frac{2(4)}{5} = \\frac{8}{5}$。这不是一个整数。\n- 对于 $m=5$：$n = \\frac{2(5)}{5} = 2$。这是一个正整数。\n\n因此，在指定的约束条件下，只有一个共振谐波，即 $(m, n) = (5, 2)$ 模式。相应的环向模数是 $n=2$。\n\n问题的第二部分要求基于第一性原理，论证哪个共振谐波最可能对维持环向旋转有害，并参考关于 $n$ 的标度趋势。共振谐波之所以有害，是因为它能引起磁重联，在有理面上形成磁岛。这个磁岛与静态外部场相互作用，产生一个电磁转矩，使等离子体旋转减速。如果转矩足够大，它可以将模式锁定到壁参考系（即停止其旋转），这通常会导致等离子体破裂。\n\n这个制动转矩的大小是衡量一个谐波有害程度的主要指标。该转矩源于洛伦兹力 $\\mathbf{J} \\times \\mathbf{B}$ 的环向分量在等离子体体积上的积分。根据麦克斯韦方程组的结构和环向角 $\\phi$ 的定义，单个谐波螺旋扰动的环向依赖性表现为 $\\exp(-in\\phi)$。力密度的环向分量包含扰动场和电流的二次项。例如，径向电流 $J_r$ 与极向场扰动 $\\delta B_\\theta$ 的耦合会产生一个环向分量。在傅里叶空间中，像梯度这样的算子涉及到对空间坐标的求导。例如，旋度的环向分量（在安培定律中用于关联电流和磁场）涉及到算子 $\\frac{1}{R}\\frac{\\partial}{\\partial\\phi}$，当它作用于一个模式上时，会变成一个因子 $-\\frac{in}{R}$。因此，对于给定的谐波，所产生的电磁转矩 $T_{m,n}$ 与环向模数 $n$ 的平方成标度关系。线性响应转矩的一个简化标度关系通常具有以下形式：\n$$\nT_{m,n} \\propto n^2 |\\psi_{res, m,n}|^2\n$$\n其中 $|\\psi_{res, m,n}|$ 是在 $q=m/n$ 磁面上的重联磁通的幅度。这种 $n^2$ 标度关系表明，对于固定的重联磁通幅度，高 $n$ 模式会施加更强的转矩，因此更有害。\n\n然而，这只是物理过程的一部分。重联磁通 $|\\psi_{res, m,n}|$ 本身是等离子体对外部施加的误差场 $|\\psi_{ext, m,n}|$ 响应的结果。这些由磁体线圈缺陷引起的外部误差场的幅度在所有模数上并不是恒定的。根据局域源产生场的基本特性，场谐波的幅度随着模数 $m$ 和 $n$ 的增加而迅速衰减。这是因为更高的模数对应更短的波长，而这样的场更具倏逝性，意味着它们远离源时衰减得更快。外部场幅度的一个典型（尽管简化）的标度关系是指数量级衰减：$|\\psi_{ext, m,n}| \\propto \\exp(-m d/a)$，其中 $d$ 是从源线圈到有理面的特征距离，而 $a$ 是装置的尺度长度。\n\n因此，一个模式的总体有害性是两种相反效应竞争的结果：\n1. 电磁转矩的内在强度，它与 $n^2$ 成标度关系。\n2. 源误差场的幅度，它随着 $m$ 和 $n$ 的增加而迅速衰减。\n\n在几乎所有托卡马克的实际案例中，误差场谱的快速衰减是主导因素。这意味着，尽管转矩表达式中有 $n^2$ 因子，但最低 $m$ 和最低 $n$ 的共振谐波是幅度最大的，因此对等离子体的稳定性和约束构成最大威胁。\n\n在此特定问题的背景下，我们只找到了一个共振谐波，即 $(m, n)=(5, 2)$。虽然 $m=5$ 是允许集合中最高的极向模数，但相应的环向模数 $n=2$ 相对较低。例如，如果一个假设的 $(m, n) = (10, 4)$ 谐波也发生共振（它确实会，因为 $10/4=2.5$），那么 $(5, 2)$ 谐波几乎肯定会是两者中更有害的一个，因为 $(10, 4)$ 的外部误差场幅度将远小于 $(5, 2)$ 的。问题要求找出共振的单个整数 $n$，我们最初的计算已经唯一确定了它。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "计算校正线圈的最优电流是一个逆问题，而这类问题在实践中通常是病态的（ill-posed），意味着微小的测量误差可能导致解的巨大偏差。本练习介绍了两种强大的数值技术——截断奇异值分解（TSVD）和吉洪诺夫正则化（Tikhonov regularization）——用于寻找稳定且具有物理意义的解。通过比较这些方法，您将能深入理解如何在校正精度和所需线圈功率之间做出权衡。",
            "id": "3979121",
            "problem": "在计算聚变科学与工程中，环形装置上的磁场误差校正可以被描述为一个线性反问题。设 $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$ 是将线圈电流 $\\mathbf{x} \\in \\mathbb{R}^{n}$ 映射到测得的法向场误差 $\\mathbf{b} \\in \\mathbb{R}^{m}$ 的线性响应算子，并假设我们有一个误差场的测量值 $\\mathbf{b}^{\\ast} \\in \\mathbb{R}^{m}$，我们希望通过选择 $\\mathbf{x}$ 来抵消该误差场。考虑 $\\mathbf{A}$ 的奇异值分解 (SVD)，$\\mathbf{A} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\mathsf{T}}$，其中 $\\mathbf{U} = [\\mathbf{u}_{1}, \\mathbf{u}_{2}, \\mathbf{u}_{3}] \\in \\mathbb{R}^{m \\times 3}$ 和 $\\mathbf{V} = [\\mathbf{v}_{1}, \\mathbf{v}_{2}, \\mathbf{v}_{3}] \\in \\mathbb{R}^{n \\times 3}$ 具有标准正交列，且 $\\boldsymbol{\\Sigma} = \\operatorname{diag}(s_{1}, s_{2}, s_{3})$，奇异值满足 $s_{1} \\ge s_{2} \\ge s_{3} > 0$。假设主导可控子空间是三维的，其奇异值 $s = \\{5, 1, 0.1\\}$，测量投影为 $c_{i} \\equiv \\mathbf{u}_{i}^{\\top} \\mathbf{b}^{\\ast} = \\{2, 1, 1\\}$。\n\n考虑两种场误差校正策略：\n1. 截断奇异值分解 (TSVD)，其中只保留 $s_{i} \\ge 1$ 的分量。\n2. Tikhonov 正则化，通过最小化 $\\|\\mathbf{A}\\mathbf{x} - \\mathbf{b}^{\\ast}\\|_{2}^{2} + \\lambda \\|\\mathbf{x}\\|_{2}^{2}$ 获得，其中正则化参数 $\\lambda = 0.2$。\n\n从第一性原理出发，以最小二乘和正则化公式以及 SVD 为起点，推导在 $\\{\\mathbf{v}_{i}\\}$ 基下的校正线圈电流矢量 $\\mathbf{x}_{\\text{TSVD}}$ 和 $\\mathbf{x}_{\\lambda}$，然后计算它们差值的欧几里得范数 $\\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2}$。以安培为单位表示您的最终答案，并将其四舍五入到四位有效数字。不要提供中间的舍入值；仅对最终答案进行舍入。",
            "solution": "问题是找到两种不同的线圈电流 $\\mathbf{x}$ 的解，用以抵消测得的磁场误差 $\\mathbf{b}^{\\ast}$，然后计算它们差值的欧几里得范数。线圈电流 $\\mathbf{x} \\in \\mathbb{R}^{n}$ 和场误差 $\\mathbf{b} \\in \\mathbb{R}^{m}$ 之间的关系由线性系统 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ 给出。我们已知响应矩阵 $\\mathbf{A}$ 的奇异值分解 (SVD) 为 $\\mathbf{A} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\mathsf{T}}$。问题被置于一个三维主导子空间中，因此我们有 $\\mathbf{U} = [\\mathbf{u}_{1}, \\mathbf{u}_{2}, \\mathbf{u}_{3}]$，$\\mathbf{V} = [\\mathbf{v}_{1}, \\mathbf{v}_{2}, \\mathbf{v}_{3}]$，和 $\\boldsymbol{\\Sigma} = \\operatorname{diag}(s_{1}, s_{2}, s_{3})$。矢量 $\\{\\mathbf{u}_i\\}$ 和 $\\{\\mathbf{v}_i\\}$ 构成标准正交集。奇异值给定为 $s_1 = 5$，$s_2 = 1$ 和 $s_3 = 0.1$。测得的误差场 $\\mathbf{b}^{\\ast}$ 在左奇异矢量上的投影为 $c_i \\equiv \\mathbf{u}_{i}^{\\top} \\mathbf{b}^{\\ast}$，其给定值为 $c_1=2$，$c_2=1$ 和 $c_3=1$。\n\n我们在右奇异矢量 $\\{\\mathbf{v}_i\\}$ 的基中寻找解 $\\mathbf{x}$，因此我们写出 $\\mathbf{x} = \\sum_{j=1}^{3} \\alpha_j \\mathbf{v}_j$。系数 $\\alpha_j$ 待定。\n\n一般最小二乘问题是找到使 $\\|\\mathbf{A}\\mathbf{x} - \\mathbf{b}^{\\ast}\\|_{2}^{2}$ 最小化的 $\\mathbf{x}$。代入 $\\mathbf{A}$ 的 SVD 和 $\\mathbf{x}$ 的展开式：\n$$ \\mathbf{A}\\mathbf{x} = (\\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\mathsf{T}}) \\left(\\sum_{j=1}^{3} \\alpha_j \\mathbf{v}_j\\right) = \\mathbf{U} \\boldsymbol{\\Sigma} \\sum_{j=1}^{3} \\alpha_j (\\mathbf{V}^{\\mathsf{T}}\\mathbf{v}_j) $$\n由于 $\\mathbf{V}^{\\mathsf{T}}\\mathbf{v}_j = \\mathbf{e}_j$（第 $j$ 个标准基矢量），这简化为：\n$$ \\mathbf{A}\\mathbf{x} = \\mathbf{U} \\boldsymbol{\\Sigma} \\sum_{j=1}^{3} \\alpha_j \\mathbf{e}_j = \\mathbf{U} \\sum_{j=1}^{3} s_j \\alpha_j \\mathbf{e}_j = \\sum_{i=1}^{3} s_i \\alpha_i \\mathbf{u}_i $$\n测量矢量 $\\mathbf{b}^{\\ast}$ 可以在 $\\{\\mathbf{u}_i\\}$ 的基上展开，再加上一个与 $\\{\\mathbf{u}_i\\}$ 的张成空间正交的残余分量 $\\mathbf{b}^{\\ast}_{\\perp}$：$\\mathbf{b}^{\\ast} = \\sum_{i=1}^{3} (\\mathbf{u}_i^{\\top}\\mathbf{b}^{\\ast}) \\mathbf{u}_i + \\mathbf{b}^{\\ast}_{\\perp} = \\sum_{i=1}^{3} c_i \\mathbf{u}_i + \\mathbf{b}^{\\ast}_{\\perp}$。\n待最小化的范数平方变为：\n$$ \\|\\mathbf{A}\\mathbf{x} - \\mathbf{b}^{\\ast}\\|_{2}^{2} = \\left\\| \\sum_{i=1}^{3} s_i \\alpha_i \\mathbf{u}_i - \\left( \\sum_{i=1}^{3} c_i \\mathbf{u}_i + \\mathbf{b}^{\\ast}_{\\perp} \\right) \\right\\|_{2}^{2} = \\left\\| \\sum_{i=1}^{3} (s_i \\alpha_i - c_i) \\mathbf{u}_i - \\mathbf{b}^{\\ast}_{\\perp} \\right\\|_{2}^{2} $$\n由于 $\\{\\mathbf{u}_i\\}$ 和 $\\mathbf{b}^{\\ast}_{\\perp}$ 的正交性，范数平方可以分离：\n$$ \\|\\mathbf{A}\\mathbf{x} - \\mathbf{b}^{\\ast}\\|_{2}^{2} = \\sum_{i=1}^{3} (s_i \\alpha_i - c_i)^2 + \\|\\mathbf{b}^{\\ast}_{\\perp}\\|_{2}^{2} $$\n标准伪逆解通过为每个 $i$ 设置 $s_i \\alpha_i - c_i = 0$ 来最小化此表达式，得到 $\\alpha_i = c_i / s_i$。\n\n策略1：截断奇异值分解 (TSVD)\nTSVD 解仅保留奇异值 $s_i$ 大于或等于某个阈值的分量。在此，阈值为 $1$。奇异值为 $s_1=5$，$s_2=1$ 和 $s_3=0.1$。因此，我们保留 $i=1$ 和 $i=2$ 的分量，并截断 $i=3$ 的分量。\n$\\mathbf{x}_{\\text{TSVD}} = \\sum_{j=1}^{3} \\alpha_{j, \\text{TSVD}} \\mathbf{v}_j$ 的系数为：\n$$ \\alpha_{1, \\text{TSVD}} = \\frac{c_1}{s_1} = \\frac{2}{5} = 0.4 $$\n$$ \\alpha_{2, \\text{TSVD}} = \\frac{c_2}{s_2} = \\frac{1}{1} = 1 $$\n$$ \\alpha_{3, \\text{TSVD}} = 0 \\quad (\\text{截断}) $$\n所以，TSVD 解为 $\\mathbf{x}_{\\text{TSVD}} = 0.4 \\mathbf{v}_1 + 1 \\mathbf{v}_2 + 0 \\mathbf{v}_3$。\n\n策略2：Tikhonov 正则化\nTikhonov 正则化旨在最小化泛函 $J(\\mathbf{x}) = \\|\\mathbf{A}\\mathbf{x} - \\mathbf{b}^{\\ast}\\|_{2}^{2} + \\lambda \\|\\mathbf{x}\\|_{2}^{2}$，其中正则化参数 $\\lambda=0.2$。\n使用 SVD 展开，泛函变为：\n$$ J(\\{\\alpha_i\\}) = \\sum_{i=1}^{3} (s_i \\alpha_i - c_i)^2 + \\|\\mathbf{b}^{\\ast}_{\\perp}\\|_{2}^{2} + \\lambda \\left\\| \\sum_{j=1}^{3} \\alpha_j \\mathbf{v}_j \\right\\|_{2}^{2} $$\n由于矢量 $\\{\\mathbf{v}_j\\}$ 是标准正交的，$\\|\\sum_{j=1}^{3} \\alpha_j \\mathbf{v}_j\\|_{2}^{2} = \\sum_{j=1}^{3} \\alpha_j^2$。\n$$ J(\\{\\alpha_i\\}) = \\sum_{i=1}^{3} \\left[ (s_i \\alpha_i - c_i)^2 + \\lambda \\alpha_i^2 \\right] + \\|\\mathbf{b}^{\\ast}_{\\perp}\\|_{2}^{2} $$\n为最小化 $J$，我们可以通过对 $\\alpha_i$ 求导并令其为零，来独立地最小化和中的每一项：\n$$ \\frac{\\partial}{\\partial \\alpha_i} \\left[ (s_i \\alpha_i - c_i)^2 + \\lambda \\alpha_i^2 \\right] = 2(s_i \\alpha_i - c_i)s_i + 2\\lambda\\alpha_i = 0 $$\n$$ \\alpha_i(s_i^2 + \\lambda) = s_i c_i \\implies \\alpha_i = \\frac{s_i c_i}{s_i^2 + \\lambda} $$\n$\\mathbf{x}_{\\lambda} = \\sum_{j=1}^{3} \\alpha_{j, \\lambda} \\mathbf{v}_j$ 的系数为：\n$$ \\alpha_{1, \\lambda} = \\frac{s_1 c_1}{s_1^2 + \\lambda} = \\frac{5 \\times 2}{5^2 + 0.2} = \\frac{10}{25.2} = \\frac{100}{252} = \\frac{25}{63} $$\n$$ \\alpha_{2, \\lambda} = \\frac{s_2 c_2}{s_2^2 + \\lambda} = \\frac{1 \\times 1}{1^2 + 0.2} = \\frac{1}{1.2} = \\frac{10}{12} = \\frac{5}{6} $$\n$$ \\alpha_{3, \\lambda} = \\frac{s_3 c_3}{s_3^2 + \\lambda} = \\frac{0.1 \\times 1}{(0.1)^2 + 0.2} = \\frac{0.1}{0.01 + 0.2} = \\frac{0.1}{0.21} = \\frac{10}{21} $$\n所以，Tikhonov 解为 $\\mathbf{x}_{\\lambda} = \\frac{25}{63} \\mathbf{v}_1 + \\frac{5}{6} \\mathbf{v}_2 + \\frac{10}{21} \\mathbf{v}_3$。\n\n差值与范数\n我们需要计算 $\\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2}$。差分矢量为：\n$$ \\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda} = (\\alpha_{1, \\text{TSVD}} - \\alpha_{1, \\lambda})\\mathbf{v}_1 + (\\alpha_{2, \\text{TSVD}} - \\alpha_{2, \\lambda})\\mathbf{v}_2 + (\\alpha_{3, \\text{TSVD}} - \\alpha_{3, \\lambda})\\mathbf{v}_3 $$\n让我们计算系数的差值：\n$$ \\Delta\\alpha_1 = \\alpha_{1, \\text{TSVD}} - \\alpha_{1, \\lambda} = \\frac{2}{5} - \\frac{25}{63} = \\frac{2 \\times 63 - 25 \\times 5}{5 \\times 63} = \\frac{126 - 125}{315} = \\frac{1}{315} $$\n$$ \\Delta\\alpha_2 = \\alpha_{2, \\text{TSVD}} - \\alpha_{2, \\lambda} = 1 - \\frac{5}{6} = \\frac{1}{6} $$\n$$ \\Delta\\alpha_3 = \\alpha_{3, \\text{TSVD}} - \\alpha_{3, \\lambda} = 0 - \\frac{10}{21} = -\\frac{10}{21} $$\n由于基 $\\{\\mathbf{v}_i\\}$ 是标准正交的，差分矢量的欧几里得范数是其系数平方和的平方根：\n$$ \\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2} = \\sqrt{(\\Delta\\alpha_1)^2 + (\\Delta\\alpha_2)^2 + (\\Delta\\alpha_3)^2} $$\n$$ \\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2}^2 = \\left(\\frac{1}{315}\\right)^2 + \\left(\\frac{1}{6}\\right)^2 + \\left(-\\frac{10}{21}\\right)^2 $$\n$$ \\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2}^2 = \\frac{1}{99225} + \\frac{1}{36} + \\frac{100}{441} $$\n$$ \\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2}^2 \\approx 0.000010078 + 0.0277777... + 0.226757... \\approx 0.254545... $$\n$$ \\|\\mathbf{x}_{\\text{TSVD}} - \\mathbf{x}_{\\lambda}\\|_{2} = \\sqrt{0.254545...} \\approx 0.5045247519... $$\n四舍五入到四位有效数字，我们得到 $0.5045$。",
            "answer": "$$\\boxed{0.5045}$$"
        },
        {
            "introduction": "一个成功的校正策略不仅需要对单一、理想的等离子体状态有效，还必须在由于运行不确定性而导致的各种可能条件下都表现良好。这项计算练习要求您通过执行最坏情况分析，来评估一个给定校正方案在等离子体安全因子剖面存在不确定性时的性能。掌握这种评估方法对于为真实的聚变装置设计鲁棒的控制系统至关重要。",
            "id": "3979114",
            "problem": "考虑在环形聚变装置中进行磁静力学误差场校正评估，其中安全因子剖面的不确定性导致共振半径发生高达 $\\pm 2\\,\\mathrm{cm}$ 的偏移。在磁静力学近似和叠加原理下，校正线圈产生的磁场与线圈电流呈线性关系。我们定义一个标量残差，它将依赖于极向角的法向场投影到指定的权重函数上。任务是针对多个候选线圈电流矢量，计算在共振半径的不确定性集合和极向角的离散集合上的最坏情况残差。\n\n您将获得以下定义和数据。所有角度都必须以弧度处理。所有磁场值必须以 $\\mathrm{T}$ 表示。\n\n1. 基础和线性模型：\n   - 磁静力学的叠加原理指出，由多个线圈产生的磁场是每个线圈产生场的总和。对于一组 $m$ 个线圈，其电流矢量为 $\\mathbf{I} \\in \\mathbb{R}^m$，在极向角 $\\theta$ 和共振半径 $r$ 处的场的法向分量建模为\n     $$ b_n(\\theta, r; \\mathbf{I}) = \\sum_{i=1}^{m} h_i(r)\\,\\varphi_i(\\theta)\\,I_i, $$\n     其中 $h_i(r)$ 是依赖于半径的线圈有效性（单位为 $\\mathrm{T}/\\mathrm{A}$），$\\varphi_i(\\theta)$ 是线圈 $i$ 的无量纲角向形状函数。\n   - 在 $(\\theta, r)$ 处的残差度量定义为加权投影：\n     $$ e(\\theta, r; \\mathbf{I}) = G(\\theta)\\,\\Big( E(\\theta) + b_n(\\theta, r; \\mathbf{I}) \\Big), $$\n     其中 $E(\\theta)$ 是固有（未补偿）误差场，$G(\\theta)$ 是用于投影到目标模式上的指定权重。在共振半径的不确定性集合上的最坏情况残差是\n     $$ R(\\mathbf{I}) = \\max_{\\Delta r \\in \\mathcal{U}}\\,\\max_{\\theta \\in \\Theta}\\,\\big| e(\\theta, r_0+\\Delta r; \\mathbf{I}) \\big|, $$\n     其中 $\\mathcal{U}$ 是允许的半径偏移集合，$\\Theta$ 是采样的极向角的离散集合。\n\n2. 离散采样和不确定性：\n   - 标称共振半径 $r_0$ 为 $1.50\\,\\mathrm{m}$。\n   - 共振半径偏移的不确定性集合为 $\\mathcal{U} = \\{-0.02\\,\\mathrm{m},\\,0.00\\,\\mathrm{m},\\, +0.02\\,\\mathrm{m}\\}$，对应于 $\\pm 2\\,\\mathrm{cm}$。\n   - 极向角样本集合为\n     $$ \\Theta = \\{0,\\,\\tfrac{\\pi}{4},\\,\\tfrac{\\pi}{2},\\,\\tfrac{3\\pi}{4},\\,\\pi,\\,\\tfrac{5\\pi}{4},\\,\\tfrac{3\\pi}{2},\\,\\tfrac{7\\pi}{4}\\}. $$\n\n3. 线圈和场参数化：\n   - 线圈数量 $m$ 为 $4$。\n   - 线圈有效性函数与半径呈线性关系：\n     $$ h_i(r) = \\alpha_i + \\beta_i\\,r, $$\n     系数为\n     $$ \\boldsymbol{\\alpha} = [2.0\\times 10^{-7},\\,-1.5\\times 10^{-7},\\,1.0\\times 10^{-7},\\,-0.5\\times 10^{-7}]\\,\\mathrm{T}/\\mathrm{A}, $$\n     $$ \\boldsymbol{\\beta} = [1.0\\times 10^{-7},\\,0.5\\times 10^{-7},\\,-0.8\\times 10^{-7},\\,0.2\\times 10^{-7}]\\,\\mathrm{T}/(\\mathrm{A}\\cdot\\mathrm{m}). $$\n   - 线圈角向形状函数为\n     $$ \\varphi_i(\\theta) = \\cos(m_i\\,\\theta + \\phi_{0,i}), $$\n     谐波指数和相位为\n     $$ \\mathbf{m} = [1,\\,1,\\,2,\\,3], \\quad \\boldsymbol{\\phi_0} = [0,\\,\\tfrac{\\pi}{4},\\,-\\tfrac{\\pi}{6},\\,\\tfrac{\\pi}{3}]. $$\n   - 权重函数为\n     $$ G(\\theta) = \\cos(\\theta - \\theta_g), \\quad \\theta_g = \\tfrac{\\pi}{8}. $$\n   - 固有误差场为\n     $$ E(\\theta) = E_0\\,\\cos(\\theta - \\theta_e), \\quad E_0 = 2.0\\times 10^{-4}\\,\\mathrm{T}, \\quad \\theta_e = -\\tfrac{\\pi}{10}. $$\n\n4. 残差评估：\n   - 对于每个候选电流矢量 $\\mathbf{I}$，计算如上定义的 $R(\\mathbf{I})$，即取 $e(\\theta, r_0+\\Delta r; \\mathbf{I})$ 的绝对值在所有 $\\Delta r \\in \\mathcal{U}$ 和所有 $\\theta \\in \\Theta$ 上的最大值。\n   - 将每个最坏情况残差以 $\\mathrm{T}$ 为单位表示，并四舍五入到六位小数。\n\n5. 测试套件：\n   - 待评估的候选电流矢量（单位为 $\\mathrm{A}$）：\n     $$ \\mathbf{I}^{(1)} = [0,\\,0,\\,0,\\,0], $$\n     $$ \\mathbf{I}^{(2)} = [600,\\,-450,\\,300,\\,150], $$\n     $$ \\mathbf{I}^{(3)} = [800,\\,-600,\\,400,\\,200], $$\n     $$ \\mathbf{I}^{(4)} = [1500,\\,-1200,\\,900,\\,600]. $$\n\n您的程序必须使用上述定义为四个测试案例中的每一个实现 $R(\\mathbf{I})$ 的计算。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_j$ 是 $\\mathbf{I}^{(j)}$ 的最坏情况残差，以 $\\mathrm{T}$ 为单位，四舍五入到六位小数。整个计算过程中角度必须使用弧度，最终输出必须根据给定单位以 $\\mathrm{T}$ 表示。",
            "solution": "已对用户提供的问题进行了分析和验证。该问题在科学上是合理的，数学上是适定的，并包含了获得唯一解所需的所有信息。因此，我们可以进行推导和计算。\n\n目标是为四个候选线圈电流矢量 $\\mathbf{I}$ 计算最坏情况残差误差场 $R(\\mathbf{I})$。该度量量化了在考虑等离子体共振面位置不确定性的情况下，可能出现的最大残余磁场误差。计算遵循所提供的模型和参数。\n\n首先，我们构建残差度量函数 $e(\\theta, r; \\mathbf{I})$：\n$$ e(\\theta, r; \\mathbf{I}) = G(\\theta)\\,\\Big( E(\\theta) + b_n(\\theta, r; \\mathbf{I}) \\Big) $$\n其中固有误差场 $E(\\theta) = E_0\\,\\cos(\\theta - \\theta_e)$，权重函数 $G(\\theta) = \\cos(\\theta - \\theta_g)$，校正场 $b_n$ 是所有线圈贡献的总和：\n$$ b_n(\\theta, r; \\mathbf{I}) = \\sum_{i=1}^{m} h_i(r)\\,\\varphi_i(\\theta)\\,I_i = \\sum_{i=1}^{m} (\\alpha_i + \\beta_i r)\\,\\cos(m_i\\theta + \\phi_{0,i})\\,I_i $$\n\n最坏情况残差 $R(\\mathbf{I})$ 定义为在所有离散的半径偏移 $\\Delta r \\in \\mathcal{U}$ 和极向角 $\\theta \\in \\Theta$ 上的最大绝对残差：\n$$ R(\\mathbf{I}) = \\max_{\\Delta r \\in \\mathcal{U}}\\,\\max_{\\theta \\in \\Theta}\\,\\big| e(\\theta, r_0+\\Delta r; \\mathbf{I}) \\big| $$\n\n算法是为每个候选电流矢量 $\\mathbf{I}^{(j)}$ 遍历所有 $3 \\times 8 = 24$ 个 $(\\theta, r)$ 组合，计算 $|e(\\theta, r; \\mathbf{I}^{(j)})|$，并找出其中的最大值。将该最大值四舍五入到六位小数，便得到该电流矢量的最坏情况残差。对所有四个电流矢量重复此过程，将结果汇总成一个列表。",
            "answer": "$$\\boxed{[0.000192,0.000075,0.000050,0.000109]}$$"
        }
    ]
}