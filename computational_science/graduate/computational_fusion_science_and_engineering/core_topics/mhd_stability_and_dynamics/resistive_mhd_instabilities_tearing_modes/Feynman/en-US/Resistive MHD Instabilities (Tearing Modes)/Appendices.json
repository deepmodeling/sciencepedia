{
    "hands_on_practices": [
        {
            "introduction": "The tearing stability index, denoted as $\\Delta'$, serves as the primary criterion for determining the onset of a resistive tearing mode. While some magnetic configurations are inherently stable, many, like the classic Harris current sheet, possess free magnetic energy that can be released through this instability. This foundational exercise guides you through the analytical calculation of $\\Delta'$ for a Harris sheet equilibrium, allowing you to explore how the interplay between the current profile's geometry and the perturbation's wavelength dictates whether the system is stable or unstable .",
            "id": "4039489",
            "problem": "Consider a two-dimensional slab plasma equilibrium with a current sheet of half-thickness $a$ and magnetic field reversal modeled by $B_y(x) = B_0 \\tanh(x/a)$ with a uniform guide field $B_z$ and negligible plasma pressure. In the framework of resistive magnetohydrodynamics (MHD), the tearing instability can be analyzed by separating the plasma into an outer ideal-MHD region and an inner resistive layer. In the outer region, at marginal stability (zero frequency), the perturbed magnetic flux function $\\psi(x)$ for a perturbation $\\propto \\exp(i k y)$ satisfies the linearized ideal-MHD equation\n$$\n\\frac{d^2 \\psi}{dx^2} - k^2 \\psi - \\frac{B_y''(x)}{B_y(x)} \\psi = 0,\n$$\nand the tearing stability index is defined by\n$$\n\\Delta' \\equiv \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^+} - \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^-}.\n$$\nStarting from these fundamentals, solve the outer-region eigenfunction $\\psi(x)$ for the given equilibrium and compute the exact dimensionless index $\\Delta' a$ as a function of the dimensionless wavenumber $k a$. Then take the thin-sheet limit $k a \\ll 1$ and determine the leading-order asymptotic dependence of $\\Delta' a$ on $k a$. Explain the physical implications of your result for the accessibility of the resistive tearing instability as $k a$ varies. Your final answer must be a single closed-form analytic expression for the leading-order dependence of $\\Delta' a$ on $k a$ in the limit $k a \\ll 1$.",
            "solution": "The user wants me to solve for the tearing stability index in a specific plasma equilibrium.\n\n### Step 1: Extract Givens\n-   **Equilibrium Magnetic Field:** $B_y(x) = B_0 \\tanh(x/a)$\n-   **Perturbation form:** $\\propto \\exp(i k y)$\n-   **Outer Region Equation (marginal stability, zero frequency):**\n    $$ \\frac{d^2 \\psi}{dx^2} - k^2 \\psi - \\frac{B_y''(x)}{B_y(x)} \\psi = 0 $$\n-   **Tearing Stability Index Definition:**\n    $$ \\Delta' \\equiv \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^+} - \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^-} = \\frac{\\psi'(0^+)}{\\psi(0^+)} - \\frac{\\psi'(0^-)}{\\psi(0^-)} $$\n-   **Objective:**\n    1.  Solve for the outer-region eigenfunction $\\psi(x)$.\n    2.  Compute the exact dimensionless index $\\Delta' a$ as a function of the dimensionless wavenumber $k a$.\n    3.  Take the thin-sheet limit $k a \\ll 1$ to find the leading-order asymptotic dependence of $\\Delta' a$ on $k a$.\n    4.  Explain the physical implications.\n    5.  Provide the leading-order dependence as the final answer.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded:** The problem is a classic exercise in the theory of resistive magnetohydrodynamics (MHD). The Harris sheet equilibrium, $B_y(x) \\propto \\tanh(x/a)$, is a standard model for a magnetic field reversal. The provided differential equation for the perturbed magnetic flux $\\psi$ and the definition of the tearing stability index $\\Delta'$ are fundamental concepts from the seminal work of Furth, Killeen, and Rosenbluth (FKR). The problem is entirely grounded in established plasma physics theory.\n-   **Well-Posed:** The problem provides a second-order ordinary differential equation (ODE) with implicit boundary conditions that the solution must be physically well-behaved (i.e., vanish at infinity). This constitutes a well-posed boundary-value problem for which a unique, physically relevant eigenfunction exists. The subsequent calculation of $\\Delta'$ is a direct application of its definition to the derived solution.\n-   **Objective:** The problem is phrased in objective, technical language, free of ambiguity or subjective claims.\n-   **Completeness and Consistency:** All necessary information—the equilibrium field, the governing equation, and the definition of the quantity to be calculated—is provided. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is scientifically valid, well-posed, and self-contained. I will proceed with the solution.\n\n### Solution Derivation\n\nFirst, we must determine the potential term $\\frac{B_y''(x)}{B_y(x)}$ for the given equilibrium magnetic field $B_y(x) = B_0 \\tanh(x/a)$. We compute the first and second derivatives of $B_y(x)$ with respect to $x$:\n$$\nB_y'(x) = \\frac{d}{dx} \\left( B_0 \\tanh\\left(\\frac{x}{a}\\right) \\right) = \\frac{B_0}{a} \\text{sech}^2\\left(\\frac{x}{a}\\right)\n$$\n$$\nB_y''(x) = \\frac{d}{dx} \\left( \\frac{B_0}{a} \\text{sech}^2\\left(\\frac{x}{a}\\right) \\right) = \\frac{B_0}{a} \\cdot 2 \\text{sech}\\left(\\frac{x}{a}\\right) \\cdot \\left(-\\text{sech}\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right)\\right) \\cdot \\frac{1}{a} = -\\frac{2 B_0}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right)\n$$\nNow we can form the ratio:\n$$\n\\frac{B_y''(x)}{B_y(x)} = \\frac{-\\frac{2 B_0}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right)}{B_0 \\tanh\\left(\\frac{x}{a}\\right)} = -\\frac{2}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right)\n$$\nSubstituting this into the given outer-region equation yields:\n$$\n\\frac{d^2 \\psi}{dx^2} - k^2 \\psi - \\left(-\\frac{2}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right)\\right) \\psi = 0\n$$\n$$\n\\frac{d^2 \\psi}{dx^2} - \\left(k^2 - \\frac{2}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right)\\right) \\psi = 0\n$$\nThis is a Schrödinger-like equation. The solution must be physically realistic, meaning it must vanish as $|x| \\to \\infty$. The equation is symmetric with respect to $x \\to -x$, so we look for an eigenfunction with definite parity. The lowest energy (least stable) tearing mode corresponds to an even eigenfunction, $\\psi(x) = \\psi(-x)$. The solution to this equation that satisfies the boundary condition $\\psi(x) \\to 0$ as $|x| \\to \\infty$ is known to be:\n$$\n\\psi(x) = C \\exp(-k|x|) \\left( 1 + \\frac{\\tanh(|x|/a)}{ka} \\right)\n$$\nwhere $C$ is an arbitrary constant. This solution can be verified by direct substitution.\n\nNext, we compute the tearing stability index $\\Delta'$. We need the logarithmic derivatives of $\\psi$ on either side of the origin $x=0$. Due to the absolute value function, we must consider the cases $x > 0$ and $x < 0$ separately.\n\nFor $x > 0$, $|x| = x$, so the eigenfunction is:\n$$\n\\psi(x) = C \\exp(-kx) \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right)\n$$\nThe derivative with respect to $x$ is:\n$$\n\\psi'(x) = C \\left[ -k \\exp(-kx) \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right) + \\exp(-kx) \\left( \\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right]\n$$\nNow we evaluate $\\psi(x)$ and $\\psi'(x)$ in the limit $x \\to 0^+$.\n$$\n\\psi(0^+) = \\lim_{x \\to 0^+} C \\exp(-kx) \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right) = C (1) \\left( 1 + \\frac{0}{ka} \\right) = C\n$$\n$$\n\\psi'(0^+) = \\lim_{x \\to 0^+} C \\left[ -k \\exp(-kx) \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right) + \\exp(-kx) \\left( \\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right]\n$$\n$$\n\\psi'(0^+) = C \\left[ -k(1)\\left(1 + 0\\right) + (1)\\left(\\frac{1}{ka^2}\\right) \\right] = C \\left(\\frac{1}{ka^2} - k\\right)\n$$\nThus, the logarithmic derivative at $x=0^+$ is:\n$$\n\\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^+} = \\frac{\\psi'(0^+)}{\\psi(0^+)} = \\frac{C \\left(\\frac{1}{ka^2} - k\\right)}{C} = \\frac{1}{ka^2} - k\n$$\nFor $x < 0$, $|x| = -x$, so the eigenfunction is:\n$$\n\\psi(x) = C \\exp(kx) \\left( 1 + \\frac{\\tanh(-x/a)}{ka} \\right) = C \\exp(kx) \\left( 1 - \\frac{\\tanh(x/a)}{ka} \\right)\n$$\nThe derivative with respect to $x$ is:\n$$\n\\psi'(x) = C \\left[ k \\exp(kx) \\left( 1 - \\frac{\\tanh(x/a)}{ka} \\right) + \\exp(kx) \\left( -\\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right]\n$$\nNow we evaluate $\\psi(x)$ and $\\psi'(x)$ in the limit $x \\to 0^-$.\n$$\n\\psi(0^-) = \\lim_{x \\to 0^-} C \\exp(kx) \\left( 1 - \\frac{\\tanh(x/a)}{ka} \\right) = C (1) \\left( 1 - 0 \\right) = C\n$$\n(As expected, $\\psi(x)$ is continuous at $x=0$.)\n$$\n\\psi'(0^-) = \\lim_{x \\to 0^-} C \\left[ k \\exp(kx) \\left( 1 - \\frac{\\tanh(x/a)}{ka} \\right) - \\exp(kx) \\left( \\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right]\n$$\n$$\n\\psi'(0^-) = C \\left[ k(1)\\left(1-0\\right) - (1)\\left(\\frac{1}{ka^2}\\right) \\right] = C \\left(k - \\frac{1}{ka^2}\\right)\n$$\nThus, the logarithmic derivative at $x=0^-$ is:\n$$\n\\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^-} = \\frac{\\psi'(0^-)}{\\psi(0^-)} = \\frac{C \\left(k - \\frac{1}{ka^2}\\right)}{C} = k - \\frac{1}{ka^2}\n$$\nNow we can compute $\\Delta'$ using its definition:\n$$\n\\Delta' = \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^+} - \\left[\\frac{d \\ln \\psi}{dx}\\right]_{0^-} = \\left(\\frac{1}{ka^2} - k\\right) - \\left(k - \\frac{1}{ka^2}\\right) = \\frac{2}{ka^2} - 2k\n$$\nThe problem asks for the dimensionless index $\\Delta' a$. Multiplying by $a$ gives:\n$$\n\\Delta' a = 2 \\left( \\frac{1}{ka} - ka \\right)\n$$\nThis is the exact expression for the dimensionless stability index as a function of the dimensionless wavenumber $k a$.\n\nNext, we take the thin-sheet limit, $k a \\ll 1$. In this limit, the term $ka$ is much smaller than the term $1/(ka)$. Therefore, we can neglect the second term to find the leading-order asymptotic dependence:\n$$\n\\Delta' a \\approx 2 \\left( \\frac{1}{ka} \\right) \\quad \\text{for } ka \\ll 1\n$$\n\nFinally, we discuss the physical implications. The resistive tearing instability is driven by the free energy in the magnetic field and is unstable when $\\Delta' > 0$. Our full result, $\\Delta' a = 2((ka)^{-1} - ka)$, shows that $\\Delta' > 0$ when $(ka)^{-1} > ka$, which simplifies to $(ka)^2 < 1$, or $0 < ka < 1$ (since $k a$ must be positive). This means that tearing modes are unstable for wavelengths $\\lambda = 2\\pi/k$ that are longer than $2\\pi a$.\nIn the thin-sheet limit ($ka \\ll 1$), which corresponds to very long wavelengths compared to the current sheet half-thickness $a$, the stability index $\\Delta' a$ becomes large and positive, scaling as $(ka)^{-1}$. Since the growth rate of the tearing mode is a monotonically increasing function of $\\Delta'$ (e.g., $\\gamma \\propto (\\Delta')^{4/5}$ in standard theory), a large positive $\\Delta'$ implies a strong instability.\nTherefore, the tearing instability is most accessible and grows fastest for long-wavelength perturbations. As the wavelength decreases (i.e., as $ka$ increases towards $1$), $\\Delta' a$ decreases, weakening the instability drive. At $ka=1$, we find $\\Delta' = 0$, indicating marginal stability. For $ka > 1$ (short wavelengths), $\\Delta'$ becomes negative, which stabilizes the mode. This stabilization at short wavelengths is due to the significant energy required to bend the magnetic field lines, which overwhelms the energy released by magnetic reconnection.",
            "answer": "$$\n\\boxed{\\frac{2}{ka}}\n$$"
        },
        {
            "introduction": "While analytical solutions for $\\Delta'$ offer invaluable physical insight, they are limited to highly idealized equilibria. In practical fusion research, magnetic profiles are complex and require numerical evaluation. This practice bridges the gap between theory and computation by tasking you with building a \"shooting\" code, a standard numerical technique to solve the boundary value problem for the perturbed magnetic flux, $\\psi$. By numerically integrating the ideal MHD equations and comparing your results to known analytical cases, you will develop a tangible tool and a deeper understanding of the underlying mathematical structure of tearing mode stability .",
            "id": "4039453",
            "problem": "You are tasked with constructing a numerical method to compute the tearing-mode stability parameter $\\Delta'$ by integrating the outer (ideal) linearized equations and evaluating the jump in the logarithmic derivative of the perturbed magnetic flux at the rational surface. All quantities are dimensionless.\n\nThe foundational base for this task is as follows:\n- In the outer ideal region of Resistive Magnetohydrodynamics (MHD), the perturbed helical magnetic flux function $\\,\\psi\\,$ satisfies a second-order linear homogeneous ordinary differential equation whose form depends on geometry and symmetry but does not include resistivity.\n- The tearing-mode stability parameter is defined by the jump in the logarithmic derivative of $\\,\\psi\\,$ across the rational surface $\\,r_s\\,$ (or $\\,x=0\\,$ in slab), namely\n$$\n\\Delta' \\equiv \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^+} - \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^-}.\n$$\nThis definition removes dependence on the arbitrary normalization of $\\,\\psi\\,$.\n\nYou must build a program that:\n1. Numerically integrates the outer ideal equation from both sides of $\\,r_s\\,$ to compute $\\,\\Delta'\\,$ using the above definition.\n2. Validates the numerical result against analytic cases by computing an analytic $\\,\\Delta'\\,$ for each case and measuring the discrepancy.\n\nFor this problem, consider two geometries and their ideal outer equations:\n- Slab geometry with wavenumber $\\,k\\,$:\n  - Outer ideal equation for $\\,x\\neq 0\\,$: \n    $$\\frac{d^2\\psi}{dx^2} - k^2 \\psi = 0.$$\n  - Boundary conditions are specified at $\\,x=\\pm L\\,$ and are either Dirichlet ($\\,\\psi(\\pm L) = 0\\,$) or Neumann ($\\,d\\psi/dx|_{x=\\pm L}=0$). The rational surface is at $\\,x=0\\,$.\n\n- Cylindrical geometry with poloidal mode number $\\,m\\ge 1\\,$:\n  - Outer ideal equation for $\\,r\\neq r_s\\,$: \n    $$\n    \\frac{d}{dr}\\left(r \\frac{d\\psi}{dr}\\right) - \\frac{m^2}{r}\\,\\psi = 0,\n    $$\n    or equivalently \n    $$\n    \\psi''(r) = \\frac{m^2}{r^2}\\psi(r) - \\frac{1}{r}\\psi'(r).\n    $$\n  - Boundary conditions are regularity at the axis ($\\,\\psi \\sim r^m\\,$ as $\\,r\\to 0\\,$) and vacuum-like decay at large radius ($\\,\\psi \\sim r^{-m}\\,$ as $\\,r\\to \\infty\\,$). The rational surface is at $\\,r=r_s\\,$. In practice, you must integrate inward from a large but finite outer radius $\\,R\\,$ and outward from a small radius $\\,\\epsilon\\,$ that satisfies $\\,0<\\epsilon<r_s\\,$, using asymptotic initial conditions consistent with the stated behaviors.\n\nAlgorithmic requirements:\n- Implement numerical integration of the second-order equations by rewriting them as first-order systems and integrating from each boundary to the rational surface.\n- For slab cases, integrate from $\\,x=-L\\,$ to $\\,x=0\\,$ and from $\\,x=+L\\,$ to $\\,x=0\\,$. Use initial conditions consistent with the specified boundary type:\n  - Dirichlet: $\\,\\psi(-L)=0\\,$, $\\,d\\psi/dx|_{x=-L}=1\\,$ and $\\,\\psi(L)=0\\,$, $\\,d\\psi/dx|_{x=L}=-1\\,$.\n  - Neumann: $\\,d\\psi/dx|_{x=-L}=0\\,$, $\\,\\psi(-L)=1\\,$ and $\\,d\\psi/dx|_{x=L}=0\\,$, $\\,\\psi(L)=1\\,$.\n- For cylindrical cases, integrate from $\\,r=\\epsilon\\,$ to $\\,r=r_s\\,$ using $\\,\\psi(\\epsilon)=\\epsilon^m\\,$, $\\,\\psi'(\\epsilon)=m\\epsilon^{m-1}\\,$, and from $\\,r=R\\,$ to $\\,r=r_s\\,$ using $\\,\\psi(R)=R^{-m}\\,$, $\\,\\psi'(R)=-mR^{-m-1}\\,$.\n- Compute $\\,\\Delta'\\,$ via the difference of logarithmic derivatives evaluated at $\\,r_s\\,$ (or $\\,x=0\\,$ for slab), namely \n  $$\n  \\Delta' = \\left(\\frac{\\psi'_+}{\\psi_+}\\right)_{r_s} - \\left(\\frac{\\psi'_-}{\\psi_-}\\right)_{r_s}.\n  $$\n- For validation, derive analytic expressions for $\\,\\Delta'\\,$ for the specified cases and compare to your numerical result by reporting the relative error \n  $$\n  \\text{error} = \\frac{\\left|\\Delta'_{\\text{num}} - \\Delta'_{\\text{analytic}}\\right|}{\\left|\\Delta'_{\\text{analytic}}\\right|}.\n  $$\n\nTest suite:\n- Use the following five test cases covering different boundary types, domain sizes, and geometries:\n  1. Slab, Dirichlet boundaries, $\\,k=0.7\\,$, $\\,L=1.0\\,$.\n  2. Slab, Neumann boundaries, $\\,k=0.7\\,$, $\\,L=1.0\\,$.\n  3. Slab, Dirichlet boundaries, $\\,k=0.7\\,$, $\\,L=10.0\\,$ (to approximate decay at infinity).\n  4. Cylinder, vacuum decay and axis regularity, $\\,m=2\\,$, $\\,r_s=0.3\\,$, $\\,R=4.0\\,$.\n  5. Cylinder, vacuum decay and axis regularity, $\\,m=1\\,$, $\\,r_s=0.5\\,$, $\\,R=3.0\\,$.\n\nFinal output format:\n- Your program should produce a single line of output containing the relative errors for these five test cases, in the given order, as a comma-separated list enclosed in square brackets (for example, $[\\text{e}_1,\\text{e}_2,\\text{e}_3,\\text{e}_4,\\text{e}_5]$).",
            "solution": "The task is to numerically compute the tearing-mode stability parameter $\\Delta'$ for various plasma configurations and validate the results against analytical solutions. This involves numerically integrating the ideal MHD outer equation for the perturbed magnetic flux $\\psi$ from the boundaries of the domain to the rational surface, and then calculating the jump in the logarithmic derivative of $\\psi$ at that surface.\n\n**Analytical Derivation of $\\Delta'$**\n\nTo validate the numerical method, we first derive the exact analytical expressions for $\\Delta'$ for the specified test cases. The definition of $\\Delta'$ is:\n$$\n\\Delta' \\equiv \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^+} - \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^-}\n$$\nwhere the rational surface is located at $r=r_s$ (or $x=0$ in slab geometry). The solutions $\\psi_-$ and $\\psi_+$ correspond to the regions $r < r_s$ and $r > r_s$, respectively.\n\n**Slab Geometry**\nThe governing equation is $\\frac{d^2\\psi}{dx^2} - k^2 \\psi = 0$. The general solution is a linear combination of hyperbolic functions, $\\psi(x) = A \\cosh(kx) + B \\sinh(kx)$. The rational surface is at $x=0$.\n1.  **Dirichlet Boundary Conditions ($\\psi(\\pm L) = 0$):**\n    -   For the left-hand solution ($x \\in [-L, 0]$), the boundary condition $\\psi(-L) = 0$ requires the solution to be of the form $\\psi_-(x) = C_1 \\sinh(k(x+L))$. The logarithmic derivative is $\\frac{\\psi'_-(x)}{\\psi_-(x)} = k \\coth(k(x+L))$. At $x=0^-$, this becomes $k \\coth(kL)$.\n    -   For the right-hand solution ($x \\in [0, L]$), the boundary condition $\\psi(L) = 0$ requires a solution of the form $\\psi_+(x) = C_2 \\sinh(k(x-L))$. The logarithmic derivative is $\\frac{\\psi'_+(x)}{\\psi_+(x)} = k \\coth(k(x-L))$. At $x=0^+$, this evaluates to $k \\coth(-kL) = -k \\coth(kL)$.\n    -   Combining these gives $\\Delta' = (-k \\coth(kL)) - (k \\coth(kL)) = -2k \\coth(kL) = -\\frac{2k}{\\tanh(kL)}$.\n\n2.  **Neumann Boundary Conditions ($\\psi'(\\pm L) = 0$):**\n    -   For the left-hand solution ($x \\in [-L, 0]$), the condition $\\psi'(-L)=0$ selects the solution $\\psi_-(x) = C_1 \\cosh(k(x+L))$. The logarithmic derivative at $x=0^-$ is $k \\tanh(kL)$.\n    -   For the right-hand solution ($x \\in [0, L]$), the condition $\\psi'(L)=0$ selects the solution $\\psi_+(x) = C_2 \\cosh(k(x-L))$. The logarithmic derivative at $x=0^+$ is $k \\tanh(-kL) = -k \\tanh(kL)$.\n    -   Thus, for the Neumann case, $\\Delta' = (-k \\tanh(kL)) - (k \\tanh(kL)) = -2k \\tanh(kL)$.\n\n**Cylindrical Geometry**\nThe governing equation is a Cauchy-Euler equation: $r^2 \\psi'' + r \\psi' - m^2 \\psi = 0$. The general solution is $\\psi(r) = A r^m + B r^{-m}$, where $m \\ge 1$.\n-   For the inner solution ($r < r_s$), regularity at the axis ($r=0$) requires the solution to be well-behaved. The $r^{-m}$ term diverges, so we must have $B=0$. The solution is $\\psi_-(r) = A r^m$. The logarithmic derivative is $\\frac{\\psi'_-(r)}{\\psi_-(r)} = \\frac{m r^{m-1}}{r^m} = \\frac{m}{r}$. At $r=r_s^-$, this is $\\frac{m}{r_s}$.\n-   For the outer solution ($r > r_s$), we impose a vacuum-like decay condition, $\\psi(r) \\to 0$ as $r \\to \\infty$. The $r^m$ term grows, so we must have $A=0$. The solution is $\\psi_+(r) = B r^{-m}$. The logarithmic derivative is $\\frac{\\psi'_+(r)}{\\psi_+(r)} = \\frac{-m r^{-m-1}}{r^{-m}} = -\\frac{m}{r}$. At $r=r_s^+$, this is $-\\frac{m}{r_s}$.\n-   Combining these results yields $\\Delta' = (-\\frac{m}{r_s}) - (\\frac{m}{r_s}) = -\\frac{2m}{r_s}$. This analytic result assumes boundaries at $r=0$ and $r=\\infty$. The numerical calculation uses finite boundaries at $r=\\epsilon$ and $r=R$, introducing a small, expected discrepancy.\n\n**Numerical Integration Method**\n\nTo solve the second-order ordinary differential equations (ODEs) numerically, we first convert them into systems of first-order ODEs. We define a state vector $\\mathbf{y}(t) = [\\psi(t), \\psi'(t)]^T$. The system takes the form $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$. We use the `solve_ivp` function from the SciPy library for high-accuracy numerical integration.\n\n**Slab System:**\nFor the equation $\\psi'' = k^2 \\psi$, let $y_0 = \\psi$ and $y_1 = \\psi'$. The first-order system is:\n$$\n\\frac{d}{dx} \\begin{pmatrix} y_0 \\\\ y_1 \\end{pmatrix} = \\begin{pmatrix} y_1 \\\\ k^2 y_0 \\end{pmatrix}\n$$\nWe integrate this system from the boundaries at $x = \\pm L$ to the rational surface at $x=0$.\n-   Left integration: From $x=-L$ to $x=0$.\n    -   Dirichlet: Initial condition $\\mathbf{y}(-L) = [0, 1]^T$.\n    -   Neumann: Initial condition $\\mathbf{y}(-L) = [1, 0]^T$.\n-   Right integration: From $x=L$ to $x=0$.\n    -   Dirichlet: Initial condition $\\mathbf{y}(L) = [0, -1]^T$.\n    -   Neumann: Initial condition $\\mathbf{y}(L) = [1, 0]^T$.\n\n**Cylindrical System:**\nFor the equation $\\psi''(r) = \\frac{m^2}{r^2}\\psi(r) - \\frac{1}{r}\\psi'(r)$, let $y_0 = \\psi$ and $y_1 = \\psi'$. The first-order system is:\n$$\n\\frac{d}{dr} \\begin{pmatrix} y_0 \\\\ y_1 \\end{pmatrix} = \\begin{pmatrix} y_1 \\\\ \\frac{m^2}{r^2}y_0 - \\frac{1}{r}y_1 \\end{pmatrix}\n$$\n-   Inner integration: From a small radius $r=\\epsilon$ to $r=r_s$. The initial conditions are derived from the asymptotic behavior $\\psi \\sim r^m$: $\\mathbf{y}(\\epsilon) = [\\epsilon^m, m\\epsilon^{m-1}]^T$. We choose $\\epsilon = 10^{-8}$.\n-   Outer integration: From a large radius $r=R$ to $r=r_s$. The initial conditions are derived from the asymptotic behavior $\\psi \\sim r^{-m}$: $\\mathbf{y}(R) = [R^{-m}, -mR^{-m-1}]^T$.\n\n**Computation of $\\Delta'$ and Validation**\nFor each case, two integrations are performed, one from each side of the domain, terminating at the rational surface. Let the final state from the \"minus\" side (left or inner) be $[\\psi_-, \\psi'_-]^T$ and from the \"plus\" side (right or outer) be $[\\psi_+, \\psi'_+]^T$. The numerical stability parameter is then computed as:\n$$\n\\Delta'_{\\text{num}} = \\frac{\\psi'_+}{\\psi_+} - \\frac{\\psi'_-}{\\psi_-}\n$$\nThis numerical result is then compared against the corresponding analytical formula derived above by calculating the relative error:\n$$\n\\text{error} = \\frac{\\left|\\Delta'_{\\text{num}} - \\Delta'_{\\text{analytic}}\\right|}{\\left|\\Delta'_{\\text{analytic}}\\right|}\n$$\nThe program reports these errors for the five specified test cases. Tight integration tolerances ($rtol=10^{-12}$, $atol=10^{-12}$) are used to minimize numerical error.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to compute and validate the tearing-mode stability parameter Delta'\n    for a series of test cases in slab and cylindrical geometries.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Structure: (geometry_type, params_dict)\n    test_cases = [\n        ('slab_dirichlet', {'k': 0.7, 'L': 1.0}),\n        ('slab_neumann', {'k': 0.7, 'L': 1.0}),\n        ('slab_dirichlet', {'k': 0.7, 'L': 10.0}),\n        ('cylinder', {'m': 2, 'rs': 0.3, 'R': 4.0}),\n        ('cylinder', {'m': 1, 'rs': 0.5, 'R': 3.0})\n    ]\n\n    def get_analytic_delta_prime(case_type, params):\n        \"\"\"Calculates the analytical Delta' for a given case.\"\"\"\n        if 'slab' in case_type:\n            k, L = params['k'], params['L']\n            if 'dirichlet' in case_type:\n                # Delta' = -2*k*coth(k*L)\n                return -2 * k / np.tanh(k * L)\n            else:  # Neumann\n                # Delta' = -2*k*tanh(k*L)\n                return -2 * k * np.tanh(k * L)\n        elif 'cylinder' in case_type:\n            m, rs = params['m'], params['rs']\n            # Delta' = -2*m/rs\n            return -2 * m / rs\n        return None\n\n    def slab_ode(x, y, k):\n        \"\"\"First-order system for the slab geometry ideal equation.\"\"\"\n        psi, psi_prime = y\n        d_psi = psi_prime\n        d_psi_prime = k**2 * psi\n        return [d_psi, d_psi_prime]\n\n    def cylinder_ode(r, y, m):\n        \"\"\"First-order system for the cylindrical geometry ideal equation.\"\"\"\n        psi, psi_prime = y\n        d_psi = psi_prime\n        d_psi_prime = (m**2 / r**2) * psi - (1 / r) * psi_prime\n        return [d_psi, d_psi_prime]\n\n    def get_numerical_delta_prime(case_type, params):\n        \"\"\"\n        Numerically integrates the outer equations to compute Delta'.\n        High-precision tolerances are used for the ODE solver.\n        \"\"\"\n        rtol, atol = 1e-12, 1e-12\n\n        if 'slab' in case_type:\n            k, L = params['k'], params['L']\n            \n            # Left-side integration: from x=-L to x=0\n            if 'dirichlet' in case_type:\n                y0_left = [0.0, 1.0]\n            else: # Neumann\n                y0_left = [1.0, 0.0]\n            sol_left = solve_ivp(slab_ode, [-L, 0.0], y0_left, args=(k,), t_eval=[0.0], rtol=rtol, atol=atol)\n            psi_minus, psi_prime_minus = sol_left.y[:, 0]\n            \n            # Right-side integration: from x=L to x=0\n            if 'dirichlet' in case_type:\n                y0_right = [0.0, -1.0]\n            else: # Neumann\n                y0_right = [1.0, 0.0]\n            sol_right = solve_ivp(slab_ode, [L, 0.0], y0_right, args=(k,), t_eval=[0.0], rtol=rtol, atol=atol)\n            psi_plus, psi_prime_plus = sol_right.y[:, 0]\n\n        elif 'cylinder' in case_type:\n            m, rs, R = params['m'], params['rs'], params['R']\n            epsilon = 1e-8\n            \n            # Inner integration: from r=epsilon to r=rs\n            y0_inner = [epsilon**m, m * epsilon**(m-1)]\n            sol_inner = solve_ivp(cylinder_ode, [epsilon, rs], y0_inner, args=(m,), t_eval=[rs], rtol=rtol, atol=atol)\n            psi_minus, psi_prime_minus = sol_inner.y[:, 0]\n            \n            # Outer integration: from r=R to r=rs\n            y0_outer = [R**(-m), -m * R**(-m-1)]\n            sol_outer = solve_ivp(cylinder_ode, [R, rs], y0_outer, args=(m,), t_eval=[rs], rtol=rtol, atol=atol)\n            psi_plus, psi_prime_plus = sol_outer.y[:, 0]\n        \n        else:\n            return None\n\n        # Calculate numerical Delta' using standard definition\n        log_deriv_minus = psi_prime_minus / psi_minus\n        log_deriv_plus = psi_prime_plus / psi_plus\n        return log_deriv_plus - log_deriv_minus\n\n    results = []\n    for case_type, params in test_cases:\n        delta_prime_num = get_numerical_delta_prime(case_type, params)\n        delta_prime_analytic = get_analytic_delta_prime(case_type, params)\n        \n        # Calculate relative error\n        error = np.abs(delta_prime_num - delta_prime_analytic) / np.abs(delta_prime_analytic)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After calculating the stability index $\\Delta'$, the next crucial step is to determine its physical consequence: the instability's growth rate, $\\gamma$. The celebrated Furth-Killeen-Rosenbluth (FKR) dispersion relation provides the link between the ideal outer region physics, encapsulated by $\\Delta'$, and the resistive dynamics of the inner layer where reconnection occurs. This exercise explores the sensitivity of the growth rate to uncertainties in $\\Delta'$, a vital consideration for any numerical model and a key aspect of verification and validation in computational science .",
            "id": "4039517",
            "problem": "In linear resistive magnetohydrodynamics (MHD) for a slab plasma of half-width $a$ with uniform resistivity $\\eta$ and constant mass density $\\rho$, consider a single-helicity tearing mode with wavenumber $k$ along the ignorable direction. Let $V_A$ denote the Alfvén speed $V_A = B_0/\\sqrt{\\mu_0 \\rho}$, the Alfvén time be $\\tau_A = a/V_A$, and the Lundquist number be $S = \\mu_0 a V_A/\\eta$. In the so-called constant-$\\psi$ regime, matched asymptotic analysis of the inner resistive layer and the ideal outer region yields an implicit dispersion relation between the tearing growth rate $\\gamma$ and the stability parameter $\\Delta'$:\n$$\nG(\\gamma,\\Delta') \\equiv (\\gamma \\tau_A)^{5/4} - C\\,(\\Delta' a)\\,(k a)^{1/2}\\,S^{-3/4} = 0,\n$$\nwhere $C$ is a positive order-unity constant. Here $\\Delta'$ is the standard jump parameter obtained from the ideal outer-region solution, defined as $\\Delta' \\equiv \\left[\\frac{d \\ln \\tilde{\\psi}}{dx}\\right]_{x=0^+}^{x=0^-}$ for the perturbed flux function $\\tilde{\\psi}$ across the resonant surface at $x=0$.\n\nSuppose $\\Delta'$ is computed numerically from an ideal outer-region boundary value problem and is subject to a small error $\\delta \\Delta'$ (with $|\\delta \\Delta'| \\ll |\\Delta'|$), while all other parameters are known exactly. Using the implicit function theorem and first-order uncertainty propagation, derive the sensitivity of the growth rate $\\gamma$ to $\\Delta'$ by differentiating the dispersion relation $G(\\gamma,\\Delta')=0$, and obtain a first-order expression for the relative uncertainty in $\\gamma$ in terms of the relative uncertainty in $\\Delta'$. Express your final answer as a single simplified analytic expression for $\\delta \\gamma/\\gamma$ in terms of $\\delta \\Delta'/\\Delta'$. Do not include units in your final answer.",
            "solution": "The user wants me to solve the problem by following these steps.\n1.  **Problem Validation**: I need to check if the problem is scientifically sound, well-posed, and objective.\n2.  **Solution Derivation**: If the problem is valid, I'll provide a step-by-step solution.\n3.  **Formatting**: The entire output must adhere to strict formatting rules, including enclosing all mathematical entities in LaTeX.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **System**: A slab plasma of half-width $a$.\n*   **Parameters**:\n    *   Uniform resistivity: $\\eta$\n    *   Constant mass density: $\\rho$\n    *   Wavenumber: $k$\n*   **Definitions**:\n    *   Alfvén speed: $V_A = B_0/\\sqrt{\\mu_0 \\rho}$\n    *   Alfvén time: $\\tau_A = a/V_A$\n    *   Lundquist number: $S = \\mu_0 a V_A/\\eta$\n*   **Dispersion Relation**: In the constant-$\\psi$ regime, the growth rate $\\gamma$ and stability parameter $\\Delta'$ are related by $G(\\gamma,\\Delta') = 0$, where:\n    $$\n    G(\\gamma,\\Delta') \\equiv (\\gamma \\tau_A)^{5/4} - C\\,(\\Delta' a)\\,(k a)^{1/2}\\,S^{-3/4} = 0\n    $$\n*   **Constants**: $C$ is a positive order-unity constant.\n*   **Definition of $\\Delta'$**: $\\Delta' \\equiv \\left[\\frac{d \\ln \\tilde{\\psi}}{dx}\\right]_{x=0^+}^{x=0^-}$ for the perturbed flux function $\\tilde{\\psi}$ at the resonant surface $x=0$.\n*   **Constraint**: A small error $\\delta \\Delta'$ exists in $\\Delta'$, with $|\\delta \\Delta'| \\ll |\\Delta'|$. All other parameters ($a, \\eta, \\rho, k, C$) are known exactly.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded**: The problem is rooted in the established theory of resistive magnetohydrodynamics (MHD), specifically the FKR (Furth, Killeen, Rosenbluth) theory of tearing modes. The dispersion relation provided is a standard result for the constant-$\\psi$ tearing mode, and all defined quantities ($\\tau_A$, $S$, $\\Delta'$) are standard in plasma physics. The problem is scientifically sound.\n2.  **Well-Posed**: The problem asks for a specific, calculable quantity: the first-order relationship between the relative uncertainties of two variables linked by an implicit function. This is a standard sensitivity analysis problem with a unique solution.\n3.  **Objective**: The language is precise and technical, free of subjectivity or ambiguity.\n4.  **Completeness**: All necessary information (the functional form of the dispersion relation) is provided to solve the problem.\n5.  **Consistency**: The givens are self-consistent and do not contain contradictions.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. I will now proceed with the solution.\n\n### Solution Derivation\n\nThe objective is to find the first-order expression for the relative uncertainty in the tearing mode growth rate, $\\delta\\gamma/\\gamma$, as a function of the relative uncertainty in the stability parameter, $\\delta\\Delta'/\\Delta'$.\n\nThe given dispersion relation is:\n$$\n(\\gamma \\tau_A)^{5/4} - C\\,(\\Delta' a)\\,(k a)^{1/2}\\,S^{-3/4} = 0\n$$\nWe can rearrange this equation to isolate the terms involving $\\gamma$ and $\\Delta'$:\n$$\n(\\gamma \\tau_A)^{5/4} = C\\,a\\,(k a)^{1/2}\\,S^{-3/4}\\,\\Delta'\n$$\nThe problem states that all parameters except for $\\gamma$ and $\\Delta'$ are known exactly and are constant. We can group these constants into a single term. Let $K$ be a positive constant defined as:\n$$\nK = C\\,a\\,(k a)^{1/2}\\,S^{-3/4}\\,\\tau_A^{-5/4}\n$$\nThe dispersion relation simplifies to a direct proportionality between powers of $\\gamma$ and $\\Delta'$:\n$$\n\\gamma^{5/4} = K\\,\\Delta'\n$$\nTo find the relationship between the relative uncertainties, the most direct method is logarithmic differentiation. Taking the natural logarithm of both sides of the simplified equation yields:\n$$\n\\ln(\\gamma^{5/4}) = \\ln(K\\,\\Delta')\n$$\nUsing the properties of logarithms, we can expand both sides:\n$$\n\\frac{5}{4}\\ln(\\gamma) = \\ln(K) + \\ln(\\Delta')\n$$\nNow, we consider small perturbations (uncertainties) in $\\gamma$ and $\\Delta'$. We can find the relationship between these small changes by taking the total differential of the equation. Since $K$ is a constant, its differential is zero ($d(\\ln K) = 0$).\n$$\nd\\left(\\frac{5}{4}\\ln(\\gamma)\\right) = d(\\ln(K)) + d(\\ln(\\Delta'))\n$$\n$$\n\\frac{5}{4}\\,d(\\ln(\\gamma)) = d(\\ln(\\Delta'))\n$$\nThe differential of the natural logarithm of a variable $u$ is $d(\\ln u) = du/u$. Applying this rule, we get:\n$$\n\\frac{5}{4}\\frac{d\\gamma}{\\gamma} = \\frac{d\\Delta'}{\\Delta'}\n$$\nFor first-order uncertainty propagation, infinitesimal differentials ($d\\gamma$, $d\\Delta'$) can be approximated by small, finite uncertainties ($\\delta\\gamma$, $\\delta\\Delta'$). This gives the relationship between the relative uncertainties:\n$$\n\\frac{5}{4}\\frac{\\delta\\gamma}{\\gamma} = \\frac{\\delta\\Delta'}{\\Delta'}\n$$\nFinally, we solve for the relative uncertainty in the growth rate, $\\delta\\gamma/\\gamma$, as requested by the problem:\n$$\n\\frac{\\delta\\gamma}{\\gamma} = \\frac{4}{5}\\frac{\\delta\\Delta'}{\\Delta'}\n$$\nThis expression shows that the relative uncertainty in the growth rate is directly proportional to the relative uncertainty in the stability parameter $\\Delta'$, with a proportionality constant of $4/5$.",
            "answer": "$$\n\\boxed{\\frac{4}{5}\\frac{\\delta\\Delta^\\prime}{\\Delta^\\prime}}\n$$"
        }
    ]
}