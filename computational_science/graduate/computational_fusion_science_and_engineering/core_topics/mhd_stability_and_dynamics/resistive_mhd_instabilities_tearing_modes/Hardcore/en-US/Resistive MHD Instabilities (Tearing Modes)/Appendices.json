{
    "hands_on_practices": [
        {
            "introduction": "The tearing stability index, denoted as $\\Delta'$, is the central parameter that determines the stability of a plasma to tearing modes by quantifying the magnetic free energy available to the instability. This first exercise provides a foundational walkthrough of how to calculate $\\Delta'$ from first principles by solving the ideal outer equation for the simplest non-trivial case: a linear magnetic shear profile. Mastering this fundamental calculation is the first step toward analyzing more complex and realistic plasma equilibria.",
            "id": "4039447",
            "problem": "Consider a slab plasma in Cartesian geometry with coordinates $(x,y,z)$ and equilibrium magnetic field $\\mathbf{B}_0(x) = B_y(x)\\,\\hat{\\mathbf{y}} + B_z\\,\\hat{\\mathbf{z}}$, where $B_y(x) = B'_y x$ and $B_z$ is a uniform guide field. Assume uniform mass density, negligible equilibrium pressure gradients, and that the perturbations are incompressible. Focus on a tearing perturbation with spatial dependence $\\exp(i k y)$, with $k \\equiv |k_y| > 0$ and $k_z = 0$, and assume the resistive layer is asymptotically thin compared to macroscopic scales so that the outer region is governed by ideal Magnetohydrodynamics (MHD).\n\nDefine the perturbed in-plane magnetic field using a flux function $\\psi(x)$ such that $\\delta \\mathbf{B}_\\perp = \\hat{\\mathbf{z}} \\times \\nabla \\psi$; equivalently, $\\delta B_x = i k \\psi$ and $\\delta B_y = -\\frac{d\\psi}{dx}$. In the outer region, ideal MHD applies and the magnetic field lines are frozen into the plasma.\n\nStarting from the linearized ideal MHD equations and appropriate relations between the displacement and the perturbed magnetic field, derive the governing ordinary differential equation for the outer-region flux function $\\psi(x)$, solve it for the given equilibrium $B_y(x) = B'_y x$, and impose the boundary conditions that $\\psi(x)$ decays as $|x| \\to \\infty$. Using the standard definition of the tearing stability index\n$$\\Delta' \\equiv \\frac{\\psi'(+0) - \\psi'(-0)}{\\psi(0)},$$\nwhere $\\psi(0)$ is the continuous value of $\\psi$ at the resonant surface $x=0$ and $\\psi'(\\pm 0)$ denote the one-sided derivatives, compute $\\Delta'$ for this slab configuration.\n\nYour final answer must be a single closed-form analytic expression in terms of $k$. Express $k$ in $\\mathrm{m}^{-1}$. No numerical rounding is required.",
            "solution": "The problem requires the calculation of the tearing stability index, $\\Delta'$, for a given slab plasma equilibrium. The process involves deriving the governing equation for the perturbed magnetic flux function, $\\psi(x)$, in the ideal outer regions, solving this equation with appropriate boundary conditions, and then using the solution to compute $\\Delta'$.\n\nThe starting point is the linearized ideal Magnetohydrodynamic (MHD) equation for a static equilibrium ($\\partial_t = 0$, $\\mathbf{v}_0 = 0$), which represents marginal stability. The momentum equation reduces to the force balance equation:\n$$\n\\mathbf{J}_1 \\times \\mathbf{B}_0 + \\mathbf{J}_0 \\times \\mathbf{B}_1 - \\nabla p_1 = 0\n$$\nwhere $\\mathbf{B}_0$ and $\\mathbf{J}_0$ are the equilibrium magnetic field and current density, and $\\mathbf{B}_1$, $\\mathbf{J}_1$, and $p_1$ are the perturbed quantities.\n\nFirst, we define all vector quantities based on the problem statement.\nThe equilibrium magnetic field is given by $\\mathbf{B}_0(x) = B_y(x)\\,\\hat{\\mathbf{y}} + B_z\\,\\hat{\\mathbf{z}}$, with $B_y(x) = B'_y x$ and $B_z$ being a constant.\nThe equilibrium current density $\\mathbf{J}_0$ is found using Ampere's law, $\\mathbf{J}_0 = \\frac{1}{\\mu_0}\\nabla \\times \\mathbf{B}_0$:\n$$\n\\mathbf{J}_0 = \\frac{1}{\\mu_0} \\nabla \\times (B'_y x\\,\\hat{\\mathbf{y}} + B_z\\,\\hat{\\mathbf{z}}) = \\frac{1}{\\mu_0} \\frac{\\partial(B'_y x)}{\\partial x} \\hat{\\mathbf{z}} = \\frac{B'_y}{\\mu_0} \\hat{\\mathbf{z}}\n$$\nNote that $\\mathbf{J}_0$ is uniform in space.\n\nThe perturbations are assumed to have the form $f(x) \\exp(i k y)$. The perturbed magnetic field is expressed in terms of the flux function $\\psi(x)$ as $\\mathbf{B}_1 = \\delta \\mathbf{B}_\\perp = \\hat{\\mathbf{z}} \\times \\nabla (\\psi(x) \\exp(i k y))$. This yields components $\\delta B_x = i k \\psi(x) \\exp(i k y)$ and $\\delta B_y = - \\frac{d\\psi}{dx} \\exp(i k y)$. For simplicity, we will work with the amplitudes of the perturbations, so $\\mathbf{B}_1 = ik\\psi(x)\\,\\hat{\\mathbf{x}} - \\psi'(x)\\,\\hat{\\mathbf{y}}$, where the prime denotes differentiation with respect to $x$.\n\nThe perturbed current density is $\\mathbf{J}_1 = \\frac{1}{\\mu_0}\\nabla \\times \\mathbf{B}_1$:\n$$\n\\mathbf{J}_1 = \\frac{1}{\\mu_0} \\nabla \\times (ik\\psi\\,\\hat{\\mathbf{x}} - \\psi'\\,\\hat{\\mathbf{y}}) = \\frac{1}{\\mu_0} \\left( \\frac{\\partial(-\\psi')}{\\partial x} - \\frac{\\partial(ik\\psi)}{\\partial y} \\right) \\hat{\\mathbf{z}} = \\frac{1}{\\mu_0} \\left( -\\psi'' - (ik)(ik\\psi) \\right) \\hat{\\mathbf{z}} = \\frac{1}{\\mu_0} (k^2\\psi - \\psi'') \\hat{\\mathbf{z}}\n$$\n\nNow, we compute the Lorentz force terms in the momentum equation.\n$$\n\\mathbf{J}_0 \\times \\mathbf{B}_1 = \\left(\\frac{B'_y}{\\mu_0} \\hat{\\mathbf{z}}\\right) \\times \\left(ik\\psi\\,\\hat{\\mathbf{x}} - \\psi'\\,\\hat{\\mathbf{y}}\\right) = \\frac{B'_y}{\\mu_0} \\left( ik\\psi(\\hat{\\mathbf{z}}\\times\\hat{\\mathbf{x}}) - \\psi'(\\hat{\\mathbf{z}}\\times\\hat{\\mathbf{y}}) \\right) = \\frac{B'_y}{\\mu_0} \\left( ik\\psi\\,\\hat{\\mathbf{y}} + \\psi'\\,\\hat{\\mathbf{x}} \\right)\n$$\n$$\n\\mathbf{J}_1 \\times \\mathbf{B}_0 = \\left(\\frac{1}{\\mu_0} (k^2\\psi - \\psi'') \\hat{\\mathbf{z}}\\right) \\times \\left(B'_y x\\,\\hat{\\mathbf{y}} + B_z\\,\\hat{\\mathbf{z}}\\right) = \\frac{B'_y x}{\\mu_0} (k^2\\psi - \\psi'') (\\hat{\\mathbf{z}}\\times\\hat{\\mathbf{y}}) = -\\frac{B'_y x}{\\mu_0} (k^2\\psi - \\psi'') \\hat{\\mathbf{x}}\n$$\n\nThe force balance equation $\\mathbf{J}_1 \\times \\mathbf{B}_0 + \\mathbf{J}_0 \\times \\mathbf{B}_1 - \\nabla p_1 = 0$ can be written in component form. The perturbation $p_1$ has spatial dependence $p_1(x)\\exp(iky)$, so $\\nabla p_1 = p_1'(x)\\,\\hat{\\mathbf{x}} + ikp_1(x)\\,\\hat{\\mathbf{y}}$.\nThe $y$-component of the force balance equation is:\n$$\n(\\mathbf{J}_0 \\times \\mathbf{B}_1)_y - ikp_1 = 0 \\implies \\frac{ikB'_y}{\\mu_0}\\psi - ikp_1 = 0\n$$\nThis allows us to express the perturbed pressure in terms of the flux function: $p_1(x) = \\frac{B'_y}{\\mu_0}\\psi(x)$.\nTaking the derivative with respect to $x$, we get $p_1'(x) = \\frac{B'_y}{\\mu_0}\\psi'(x)$.\n\nThe $x$-component of the force balance equation is:\n$$\n(\\mathbf{J}_1 \\times \\mathbf{B}_0)_x + (\\mathbf{J}_0 \\times \\mathbf{B}_1)_x - p_1' = 0\n$$\nSubstituting the derived expressions:\n$$\n-\\frac{B'_y x}{\\mu_0} (k^2\\psi - \\psi'') + \\frac{B'_y}{\\mu_0}\\psi' - \\frac{B'_y}{\\mu_0}\\psi' = 0\n$$\nThe terms involving $\\psi'$ cancel out, leaving:\n$$\n-\\frac{B'_y x}{\\mu_0} (k^2\\psi - \\psi'') = 0\n$$\nIn the outer region, we are away from the resonant surface at $x=0$. Thus, for $x \\neq 0$, the governing ordinary differential equation (ODE) for $\\psi(x)$ must be:\n$$\n\\psi''(x) - k^2\\psi(x) = 0\n$$\nThis is the well-known equation for the perturbed flux function in the ideal outer regions.\n\nNext, we solve this ODE subject to the boundary condition that the perturbation vanishes at infinity, i.e., $\\psi(x) \\to 0$ as $|x| \\to \\infty$.\nThe general solution to the ODE is $\\psi(x) = A e^{kx} + B e^{-kx}$. We must solve this in two separate regions, $x>0$ and $x0$.\n\nFor $x > 0$: To satisfy $\\psi(x) \\to 0$ as $x \\to \\infty$, we must set the coefficient of the growing exponential $e^{kx}$ to zero (since $k>0$). The solution is of the form:\n$$\n\\psi_+(x) = C_+ e^{-kx} \\quad (x>0)\n$$\n\nFor $x  0$: To satisfy $\\psi(x) \\to 0$ as $x \\to -\\infty$, we must set the coefficient of the term $e^{-kx}$ to zero, as this term grows exponentially for negative $x$. The solution is of the form:\n$$\n\\psi_-(x) = C_- e^{kx} \\quad (x0)\n$$\n\nThe theory of tearing modes requires that the flux function $\\psi(x)$ be continuous across the resistive layer at $x=0$. Thus, we enforce $\\psi_+(0) = \\psi_-(0)$.\n$$\nC_+ e^0 = C_- e^0 \\implies C_+ = C_-\n$$\nLet's denote this common constant by $C$. This also sets the value $\\psi(0) = C$. The solution for $\\psi(x)$ in the entire outer region can be written compactly as:\n$$\n\\psi(x) = C e^{-k|x|}\n$$\n\nFinally, we compute the tearing stability index $\\Delta'$, defined as:\n$$\n\\Delta' \\equiv \\frac{\\psi'(+0) - \\psi'(-0)}{\\psi(0)}\n$$\nWe need to find the one-sided derivatives of $\\psi(x)$ at $x=0$.\nFor $x>0$, $\\psi(x) = C e^{-kx}$, so its derivative is $\\psi'(x) = -k C e^{-kx}$. The limit as $x$ approaches $0$ from the positive side is:\n$$\n\\psi'(+0) = \\lim_{x\\to 0^+} (-k C e^{-kx}) = -kC\n$$\nFor $x0$, $\\psi(x) = C e^{kx}$, so its derivative is $\\psi'(x) = k C e^{kx}$. The limit as $x$ approaches $0$ from the negative side is:\n$$\n\\psi'(-0) = \\lim_{x\\to 0^-} (k C e^{kx}) = kC\n$$\nSubstituting these values and $\\psi(0)=C$ into the definition of $\\Delta'$:\n$$\n\\Delta' = \\frac{(-kC) - (kC)}{C} = \\frac{-2kC}{C}\n$$\nAssuming a non-trivial perturbation ($C \\neq 0$), we arrive at the final result:\n$$\n\\Delta' = -2k\n$$\nThis result indicates that for the given linear shear profile, the plasma is stable to tearing modes ($\\Delta'  0$ since $k>0$) for all wavelengths. This is expected, as the uniform current profile lacks the free energy gradient necessary to drive the instability.",
            "answer": "$$\\boxed{-2k}$$"
        },
        {
            "introduction": "Building upon the basic methodology, we now apply our skills to the classic Harris sheet equilibrium, a much more realistic model for current layers found in fusion and space plasmas. This practice demonstrates how the spatial structure of the current provides the free energy necessary to drive the tearing instability, leading to a positive $\\Delta'$ for long-wavelength modes. Analyzing the behavior in the thin-sheet limit reveals a key scaling law and deepens your intuition for when these instabilities are most potent.",
            "id": "4039489",
            "problem": "Consider a two-dimensional slab plasma equilibrium with a current sheet of half-thickness $a$ and magnetic field reversal modeled by $B_y(x) = B_0 \\tanh(x/a)$ with a uniform guide field $B_z$ and negligible plasma pressure. In the framework of resistive magnetohydrodynamics (MHD), the tearing instability can be analyzed by separating the plasma into an outer ideal-MHD region and an inner resistive layer. In the outer region, at marginal stability (zero frequency), the perturbed magnetic flux function $\\psi(x)$ for a perturbation $\\propto \\exp(i k y)$ satisfies the linearized ideal-MHD equation\n$$\n\\frac{d^2 \\psi}{dx^2} - k^2 \\psi - \\frac{B_y''(x)}{B_y(x)} \\psi = 0,\n$$\nand the tearing stability index is defined by\n$$\n\\Delta' \\equiv \\left.\\frac{d \\ln \\psi}{dx}\\right|_{x=0^+} - \\left.\\frac{d \\ln \\psi}{dx}\\right|_{x=0^-}.\n$$\nStarting from these fundamentals, solve the outer-region eigenfunction $\\psi(x)$ for the given equilibrium and compute the exact dimensionless index $\\Delta' a$ as a function of the dimensionless wavenumber $k a$. Then take the thin-sheet limit $k a \\ll 1$ and determine the leading-order asymptotic dependence of $\\Delta' a$ on $k a$. Explain the physical implications of your result for the accessibility of the resistive tearing instability as $k a$ varies. Your final answer must be a single closed-form analytic expression for the leading-order dependence of $\\Delta' a$ on $k a$ in the limit $k a \\ll 1$.",
            "solution": "To find the tearing stability index $\\Delta'$, we must first solve the governing ordinary differential equation for the perturbed magnetic flux function, $\\psi(x)$, in the outer ideal region.\n\n**1. Derive the Governing Equation**\nThe equilibrium magnetic field is $B_y(x) = B_0 \\tanh(x/a)$. We need to calculate the term $B_y''(x)/B_y(x)$.\nThe first derivative is:\n$$\nB_y'(x) = \\frac{d}{dx} \\left( B_0 \\tanh\\left(\\frac{x}{a}\\right) \\right) = \\frac{B_0}{a} \\text{sech}^2\\left(\\frac{x}{a}\\right)\n$$\nThe second derivative is:\n$$\nB_y''(x) = \\frac{B_0}{a} \\cdot 2 \\text{sech}\\left(\\frac{x}{a}\\right) \\cdot \\left(-\\text{sech}\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right)\\right) \\cdot \\frac{1}{a} = -\\frac{2 B_0}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right)\n$$\nThe potential term in the ODE is therefore:\n$$\n\\frac{B_y''(x)}{B_y(x)} = \\frac{-\\frac{2 B_0}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right) \\tanh\\left(\\frac{x}{a}\\right)}{B_0 \\tanh\\left(\\frac{x}{a}\\right)} = -\\frac{2}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right)\n$$\nSubstituting this into the given outer equation gives:\n$$\n\\frac{d^2 \\psi}{dx^2} - \\left(k^2 - \\frac{2}{a^2} \\text{sech}^2\\left(\\frac{x}{a}\\right)\\right) \\psi = 0\n$$\n\n**2. Solve for the Eigenfunction $\\psi(x)$**\nThis SchrÃ¶dinger-like equation is symmetric in $x$. The lowest-order tearing mode corresponds to an even eigenfunction, $\\psi(x) = \\psi(-x)$, which must vanish as $|x| \\to \\infty$. The known solution that satisfies these conditions is:\n$$\n\\psi(x) = C \\exp(-k|x|) \\left( 1 + \\frac{\\tanh(|x|/a)}{ka} \\right)\n$$\nwhere $C$ is an arbitrary normalization constant.\n\n**3. Compute the Tearing Stability Index $\\Delta'$**\nThe stability index $\\Delta'$ is defined by the jump in the logarithmic derivative across the resonant surface at $x=0$.\nFor $x > 0$, the eigenfunction is $\\psi(x) = C e^{-kx} \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right)$. Its derivative is:\n$$\n\\psi'(x) = C \\left[ -k e^{-kx} \\left( 1 + \\frac{\\tanh(x/a)}{ka} \\right) + e^{-kx} \\left( \\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right]\n$$\nEvaluating the function and its derivative as $x \\to 0^+$:\n$$\n\\psi(0^+) = C \\quad \\text{and} \\quad \\psi'(0^+) = C \\left(-k + \\frac{1}{ka^2}\\right)\n$$\nThe logarithmic derivative on the right side is $\\frac{\\psi'(0^+)}{\\psi(0^+)} = \\frac{1}{ka^2} - k$.\n\nFor $x  0$, the eigenfunction is $\\psi(x) = C e^{kx} \\left( 1 - \\frac{\\tanh(x/a)}{ka} \\right)$. Its derivative is:\n$$\n\\psi'(x) = C \\left[ k e^{kx} \\left( 1 - \\frac{\\tanh(x/a)}{ka} \\right) - e^{kx} \\left( \\frac{\\text{sech}^2(x/a)}{ka^2} \\right) \\right]\n$$\nEvaluating as $x \\to 0^-$:\n$$\n\\psi(0^-) = C \\quad \\text{and} \\quad \\psi'(0^-) = C \\left(k - \\frac{1}{ka^2}\\right)\n$$\nThe logarithmic derivative on the left side is $\\frac{\\psi'(0^-)}{\\psi(0^-)} = k - \\frac{1}{ka^2}$.\n\nUsing the definition $\\Delta' = \\left.\\frac{d \\ln \\psi}{dx}\\right|_{0^+} - \\left.\\frac{d \\ln \\psi}{dx}\\right|_{0^-}$:\n$$\n\\Delta' = \\left(\\frac{1}{ka^2} - k\\right) - \\left(k - \\frac{1}{ka^2}\\right) = \\frac{2}{ka^2} - 2k\n$$\nThe dimensionless stability index is found by multiplying by $a$:\n$$\n\\Delta' a = 2 \\left( \\frac{1}{ka} - ka \\right)\n$$\n\n**4. Thin-Sheet Limit and Physical Implications**\nIn the thin-sheet limit, the wavelength of the perturbation is much longer than the current sheet thickness, i.e., $ka \\ll 1$. In this case, the term $1/(ka)$ is much larger than $ka$. We can therefore find the leading-order asymptotic dependence by neglecting the second term:\n$$\n\\Delta' a \\approx 2 \\left( \\frac{1}{ka} \\right) = \\frac{2}{ka}\n$$\n**Physical Implications:** The tearing instability occurs when $\\Delta' > 0$. From the exact expression, this condition is met when $\\frac{1}{ka} > ka$, or $ka  1$. This means the Harris sheet is unstable to tearing modes with wavelengths $\\lambda = 2\\pi/k$ longer than the characteristic scale $2\\pi a$. In the long-wavelength limit ($ka \\ll 1$), $\\Delta'$ is large and positive, indicating a strong instability drive. As the wavelength shortens and $ka$ approaches 1, the drive weakens. For short wavelengths ($ka > 1$), $\\Delta'$ becomes negative, and the mode is stable due to the energetic cost of field line bending.",
            "answer": "$$\n\\boxed{\\frac{2}{ka}}\n$$"
        },
        {
            "introduction": "While analytical solutions are invaluable for building intuition, most real-world fusion problems require numerical methods to handle complex geometries and equilibrium profiles. This final practice challenges you to bridge the gap between theory and computation by building a numerical solver to calculate $\\Delta'$. By implementing a shooting method for different geometries and validating your code against the analytical cases you have already mastered, you will gain practical skills in computational plasma physics and solidify your understanding of the underlying tearing mode theory.",
            "id": "4039453",
            "problem": "You are tasked with constructing a numerical method to compute the tearing-mode stability parameter $\\Delta'$ by integrating the outer (ideal) linearized equations and evaluating the jump in the logarithmic derivative of the perturbed magnetic flux at the rational surface. All quantities are dimensionless.\n\nThe foundational base for this task is as follows:\n- In the outer ideal region of Resistive Magnetohydrodynamics (MHD), the perturbed helical magnetic flux function $\\psi$ satisfies a second-order linear homogeneous ordinary differential equation whose form depends on geometry and symmetry but does not include resistivity.\n- The tearing-mode stability parameter is defined by the jump in the logarithmic derivative of $\\psi$ across the rational surface $r_s$ (or $x=0$ in slab), namely\n$$\n\\Delta' \\equiv \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^+} - \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^-}.\n$$\nThis definition removes dependence on the arbitrary normalization of $\\psi$.\n\nYou must build a program that:\n1. Numerically integrates the outer ideal equation from both sides of $r_s$ to compute $\\Delta'$ using the above definition.\n2. Validates the numerical result against analytic $\\Delta'$ for each case and measuring the discrepancy.\n\nFor this problem, consider two geometries and their ideal outer equations:\n- Slab geometry with wavenumber $k$:\n  - Outer ideal equation for $x\\neq 0$: \n    $$\\frac{d^2\\psi}{dx^2} - k^2 \\psi = 0.$$\n  - Boundary conditions are specified at $x=\\pm L$ and are either Dirichlet ($\\psi(\\pm L) = 0$) or Neumann ($d\\psi/dx|_{x=\\pm L}=0$). The rational surface is at $x=0$.\n\n- Cylindrical geometry with poloidal mode number $m\\ge 1$:\n  - Outer ideal equation for $r\\neq r_s$: \n    $$\n    \\frac{d}{dr}\\left(r \\frac{d\\psi}{dr}\\right) - \\frac{m^2}{r}\\,\\psi = 0,\n    $$\n    or equivalently \n    $$\n    \\psi''(r) = \\frac{m^2}{r^2}\\psi(r) - \\frac{1}{r}\\psi'(r).\n    $$\n  - Boundary conditions are regularity at the axis ($\\psi \\sim r^m$ as $r\\to 0$) and vacuum-like decay at large radius ($\\psi \\sim r^{-m}$ as $r\\to \\infty$). The rational surface is at $r=r_s$. In practice, you must integrate inward from a large but finite outer radius $R$ and outward from a small radius $\\epsilon$ that satisfies $0\\epsilonr_s$, using asymptotic initial conditions consistent with the stated behaviors.\n\nAlgorithmic requirements:\n- Implement numerical integration of the second-order equations by rewriting them as first-order systems and integrating from each boundary to the rational surface.\n- For slab cases, integrate from $x=-L$ to $x=0$ and from $x=+L$ to $x=0$. Use initial conditions consistent with the specified boundary type:\n  - Dirichlet: $\\psi(-L)=0$, $d\\psi/dx|_{x=-L}=1$ and $\\psi(L)=0$, $d\\psi/dx|_{x=L}=-1$.\n  - Neumann: $d\\psi/dx|_{x=-L}=0$, $\\psi(-L)=1$ and $d\\psi/dx|_{x=L}=0$, $\\psi(L)=1$.\n- For cylindrical cases, integrate from $r=\\epsilon$ to $r=r_s$ using $\\psi(\\epsilon)=\\epsilon^m$, $\\psi'(\\epsilon)=m\\epsilon^{m-1}$, and from $r=R$ to $r=r_s$ using $\\psi(R)=R^{-m}$, $\\psi'(R)=-mR^{-m-1}$.\n- Compute $\\Delta'$ via the difference of logarithmic derivatives evaluated at $r_s$ (or $x=0$ for slab), namely \n  $$\n  \\Delta' = \\left(\\frac{\\psi'_+}{\\psi_+}\\right)_{r_s} - \\left(\\frac{\\psi'_-}{\\psi_-}\\right)_{r_s}.\n  $$\n- For validation, derive analytic expressions for $\\Delta'$ for the specified cases and compare to your numerical result by reporting the relative error \n  $$\n  \\text{error} = \\frac{\\left|\\Delta'_{\\text{num}} - \\Delta'_{\\text{analytic}}\\right|}{\\left|\\Delta'_{\\text{analytic}}\\right|}.\n  $$\n\nTest suite:\n- Use the following five test cases covering different boundary types, domain sizes, and geometries:\n  1. Slab, Dirichlet boundaries, $k=0.7$, $L=1.0$.\n  2. Slab, Neumann boundaries, $k=0.7$, $L=1.0$.\n  3. Slab, Dirichlet boundaries, $k=0.7$, $L=10.0$ (to approximate decay at infinity).\n  4. Cylinder, vacuum decay and axis regularity, $m=2$, $r_s=0.3$, $R=4.0$.\n  5. Cylinder, vacuum decay and axis regularity, $m=1$, $r_s=0.5$, $R=3.0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the relative errors for these five test cases, in the given order, as a comma-separated list enclosed in square brackets (for example, $[\\text{e}_1,\\text{e}_2,\\text{e}_3,\\text{e}_4,\\text{e}_5]$).",
            "solution": "The task is to numerically compute the tearing-mode stability parameter $\\Delta'$ for various plasma configurations and validate the results against analytical solutions. This involves numerically integrating the ideal MHD outer equation for the perturbed magnetic flux $\\psi$ from the boundaries of the domain to the rational surface, and then calculating the jump in the logarithmic derivative of $\\psi$ at that surface.\n\n**Analytical Derivation of $\\Delta'$**\n\nTo validate the numerical method, we first derive the exact analytical expressions for $\\Delta'$ for the specified test cases. The standard definition of $\\Delta'$ is:\n$$\n\\Delta' \\equiv \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^+} - \\left.\\frac{d\\psi/dr}{\\psi}\\right|_{r=r_s^-}\n$$\nwhere the rational surface is at $r=r_s$ (or $x=0$ in slab geometry) and $\\psi_-$ and $\\psi_+$ correspond to the solutions in the regions $r  r_s$ and $r  r_s$, respectively. A positive $\\Delta'$ typically signifies instability.\n\n**Slab Geometry**\nThe governing equation is $\\frac{d^2\\psi}{dx^2} - k^2 \\psi = 0$. The general solution is a linear combination of hyperbolic functions, $\\psi(x) = A \\cosh(kx) + B \\sinh(kx)$. The rational surface is at $x=0$.\n1.  **Dirichlet Boundary Conditions ($\\psi(\\pm L) = 0$):**\n    -   For the left-hand solution ($x \\in [-L, 0]$), the boundary condition $\\psi(-L) = 0$ requires the solution to be of the form $\\psi_-(x) = C_1 \\sinh(k(x+L))$. The logarithmic derivative is $\\frac{\\psi'_-(x)}{\\psi_-(x)} = k \\coth(k(x+L))$. At $x=0^-$, this becomes $k \\coth(kL)$.\n    -   For the right-hand solution ($x \\in [0, L]$), the boundary condition $\\psi(L) = 0$ requires a solution of the form $\\psi_+(x) = C_2 \\sinh(k(x-L))$. The logarithmic derivative is $\\frac{\\psi'_+(x)}{\\psi_+(x)} = k \\coth(k(x-L))$. At $x=0^+$, this evaluates to $k \\coth(-kL) = -k \\coth(kL)$.\n    -   Combining these gives $\\Delta' = (-k \\coth(kL)) - (k \\coth(kL)) = -2k \\coth(kL) = \\frac{-2k}{\\tanh(kL)}$. This is always negative for $k,L>0$, indicating stability.\n\n2.  **Neumann Boundary Conditions ($\\psi'(\\pm L) = 0$):**\n    -   For the left-hand solution ($x \\in [-L, 0]$), the condition $\\psi'(-L)=0$ selects the solution $\\psi_-(x) = C_1 \\cosh(k(x+L))$. The logarithmic derivative at $x=0^-$ is $k \\tanh(kL)$.\n    -   For the right-hand solution ($x \\in [0, L]$), the condition $\\psi'(L)=0$ selects the solution $\\psi_+(x) = C_2 \\cosh(k(x-L))$. The logarithmic derivative at $x=0^+$ is $k \\tanh(-kL) = -k \\tanh(kL)$.\n    -   Thus, $\\Delta' = (-k \\tanh(kL)) - (k \\tanh(kL)) = -2k \\tanh(kL)$. This is also always negative, indicating stability.\n\n**Cylindrical Geometry**\nThe governing equation is a Cauchy-Euler equation: $r^2 \\psi'' + r \\psi' - m^2 \\psi = 0$. The general solution is $\\psi(r) = A r^m + B r^{-m}$, where $m \\ge 1$.\n-   For the inner solution ($r  r_s$), regularity at the axis ($r=0$) requires the $r^{-m}$ term to be zero. The solution is $\\psi_-(r) = A r^m$. The logarithmic derivative is $\\frac{\\psi'_-(r)}{\\psi_-(r)} = \\frac{m}{r}$. At $r=r_s^-$, this is $\\frac{m}{r_s}$.\n-   For the outer solution ($r > r_s$), vacuum-like decay at infinity requires the $r^m$ term to be zero. The solution is $\\psi_+(r) = B r^{-m}$. The logarithmic derivative is $\\frac{\\psi'_+(r)}{\\psi_+(r)} = -\\frac{m}{r}$. At $r=r_s^+$, this is $-\\frac{m}{r_s}$.\n-   Combining these gives $\\Delta' = (-\\frac{m}{r_s}) - (\\frac{m}{r_s}) = -\\frac{2m}{r_s}$. This is always negative, indicating stability.\n\n**Numerical Integration Method**\n\nTo solve the second-order ordinary differential equations (ODEs) numerically, we convert them into systems of first-order ODEs. We define a state vector $\\mathbf{y}(t) = [\\psi(t), \\psi'(t)]^T$. We use the `solve_ivp` function from the SciPy library for high-accuracy numerical integration.\n\n**Slab System:** For $\\psi'' = k^2 \\psi$, let $y_0 = \\psi, y_1 = \\psi'$. The system is: $\\frac{d}{dx} [y_0, y_1]^T = [y_1, k^2 y_0]^T$.\nWe integrate from $x = \\pm L$ to $x=0$.\n\n**Cylindrical System:** For $\\psi''(r) = \\frac{m^2}{r^2}\\psi(r) - \\frac{1}{r}\\psi'(r)$, let $y_0 = \\psi, y_1 = \\psi'$. The system is: $\\frac{d}{dr} [y_0, y_1]^T = [y_1, \\frac{m^2}{r^2}y_0 - \\frac{1}{r}y_1]^T$.\nWe integrate from $r=\\epsilon$ (a small radius) to $r=r_s$ and from $r=R$ (a large radius) to $r=r_s$.\n\n**Computation of $\\Delta'$ and Validation**\nFor each case, two integrations are performed, one from each side of the domain, terminating at the rational surface. Let the final state from the \"minus\" side (left or inner) be $[\\psi_-, \\psi'_-]^T$ and from the \"plus\" side (right or outer) be $[\\psi_+, \\psi'_+]^T$. The numerical stability parameter is then computed as:\n$$\n\\Delta'_{\\text{num}} = \\frac{\\psi'_+}{\\psi_+} - \\frac{\\psi'_-}{\\psi_-}\n$$\nThis numerical result is then compared against the corresponding analytical formula derived above by calculating the relative error. Tight integration tolerances ($rtol=10^{-12}$, $atol=10^{-12}$) are used to minimize numerical error.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to compute and validate the tearing-mode stability parameter Delta'\n    for a series of test cases in slab and cylindrical geometries.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Structure: (geometry_type, params_dict)\n    test_cases = [\n        ('slab_dirichlet', {'k': 0.7, 'L': 1.0}),\n        ('slab_neumann', {'k': 0.7, 'L': 1.0}),\n        ('slab_dirichlet', {'k': 0.7, 'L': 10.0}),\n        ('cylinder', {'m': 2, 'rs': 0.3, 'R': 4.0}),\n        ('cylinder', {'m': 1, 'rs': 0.5, 'R': 3.0})\n    ]\n\n    def get_analytic_delta_prime(case_type, params):\n        \"\"\"Calculates the analytical Delta' for a given case using the standard convention.\"\"\"\n        if 'slab' in case_type:\n            k, L = params['k'], params['L']\n            if 'dirichlet' in case_type:\n                # Delta' = -2*k*coth(k*L)\n                return -2 * k / np.tanh(k * L)\n            else:  # Neumann\n                # Delta' = -2*k*tanh(k*L)\n                return -2 * k * np.tanh(k * L)\n        elif 'cylinder' in case_type:\n            m, rs = params['m'], params['rs']\n            # Delta' = -2*m/rs\n            return -2 * m / rs\n        return None\n\n    def slab_ode(x, y, k):\n        \"\"\"First-order system for the slab geometry ideal equation.\"\"\"\n        psi, psi_prime = y\n        d_psi = psi_prime\n        d_psi_prime = k**2 * psi\n        return [d_psi, d_psi_prime]\n\n    def cylinder_ode(r, y, m):\n        \"\"\"First-order system for the cylindrical geometry ideal equation.\"\"\"\n        psi, psi_prime = y\n        # Add a small epsilon to r to avoid division by zero at r=0, although\n        # the integration interval should prevent this.\n        r_safe = r + 1e-15 \n        d_psi = psi_prime\n        d_psi_prime = (m**2 / r_safe**2) * psi - (1 / r_safe) * psi_prime\n        return [d_psi, d_psi_prime]\n\n    def get_numerical_delta_prime(case_type, params):\n        \"\"\"\n        Numerically integrates the outer equations to compute Delta'.\n        High-precision tolerances are used for the ODE solver.\n        \"\"\"\n        rtol, atol = 1e-12, 1e-12\n        psi_minus, psi_prime_minus = [np.nan, np.nan]\n        psi_plus, psi_prime_plus = [np.nan, np.nan]\n\n        if 'slab' in case_type:\n            k, L = params['k'], params['L']\n            \n            # Left-side integration: from x=-L to x=0 (\"minus\" side)\n            if 'dirichlet' in case_type:\n                y0_left = [0.0, 1.0]\n            else: # Neumann\n                y0_left = [1.0, 0.0]\n            sol_left = solve_ivp(slab_ode, [-L, 0.0], y0_left, args=(k,), t_eval=[0.0], rtol=rtol, atol=atol)\n            psi_minus, psi_prime_minus = sol_left.y[:, 0]\n            \n            # Right-side integration: from x=L to x=0 (\"plus\" side)\n            if 'dirichlet' in case_type:\n                y0_right = [0.0, -1.0]\n            else: # Neumann\n                y0_right = [1.0, 0.0]\n            sol_right = solve_ivp(slab_ode, [L, 0.0], y0_right, args=(k,), t_eval=[0.0], rtol=rtol, atol=atol)\n            # The integration is from L to 0, so the solution is effectively psi_plus at x=0.\n            # To get the conventional log_deriv_plus, we use the final values from this integration.\n            # Normalization ensures psi(+0) = psi(-0) if we were to match, but log-deriv is independent of it.\n            psi_plus_at_zero, psi_prime_plus_at_zero = sol_right.y[:, 0]\n            # Since the right solution is integrated from L to 0, its value at 0 is normalized differently\n            # from the left solution. We must scale one to match the other at psi(0) before computing Delta'.\n            # log_deriv_plus is independent of this normalization.\n            log_deriv_plus = psi_prime_plus_at_zero / psi_plus_at_zero\n\n        elif 'cylinder' in case_type:\n            m, rs, R = params['m'], params['rs'], params['R']\n            epsilon = 1e-8\n            \n            # Inner integration: from r=epsilon to r=rs (\"minus\" side)\n            y0_inner = [epsilon**m, m * epsilon**(m-1)]\n            sol_inner = solve_ivp(cylinder_ode, [epsilon, rs], y0_inner, args=(m,), t_eval=[rs], rtol=rtol, atol=atol)\n            psi_minus, psi_prime_minus = sol_inner.y[:, 0]\n            \n            # Outer integration: from r=R to r=rs (\"plus\" side)\n            y0_outer = [R**(-m), -m * R**(-m-1)]\n            sol_outer = solve_ivp(cylinder_ode, [R, rs], y0_outer, args=(m,), t_eval=[rs], rtol=rtol, atol=atol)\n            psi_plus_at_rs, psi_prime_plus_at_rs = sol_outer.y[:, 0]\n            log_deriv_plus = psi_prime_plus_at_rs / psi_plus_at_rs\n        \n        else:\n            return None\n\n        # Calculate numerical Delta' using the standard convention (right - left)\n        log_deriv_minus = psi_prime_minus / psi_minus\n        \n        # In the slab case, the right solution was integrated from L to 0. \n        # For log_deriv_plus, we use the result directly.\n        if 'slab' in case_type:\n             log_deriv_plus = (psi_prime_plus_at_zero / psi_plus_at_zero)\n        \n        return log_deriv_plus - log_deriv_minus\n\n    results = []\n    for case_type, params in test_cases:\n        delta_prime_num = get_numerical_delta_prime(case_type, params)\n        delta_prime_analytic = get_analytic_delta_prime(case_type, params)\n        \n        # Calculate relative error\n        error = np.abs(delta_prime_num - delta_prime_analytic) / np.abs(delta_prime_analytic)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}