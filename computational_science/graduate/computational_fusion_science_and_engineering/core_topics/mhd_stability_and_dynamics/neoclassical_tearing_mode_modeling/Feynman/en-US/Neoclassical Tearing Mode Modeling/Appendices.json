{
    "hands_on_practices": [
        {
            "introduction": "Before we can model the dynamics of a neoclassical tearing mode, we must first characterize the background plasma equilibrium where it might arise. This fundamental exercise involves calculating the precise location of the resonant rational surface and the local magnetic shear, which are critical parameters that determine the stability and structure of the mode. Mastering this calculation provides the essential geometric foundation for more advanced NTM modeling. ",
            "id": "4018196",
            "problem": "Consider a large-aspect-ratio, axisymmetric tokamak plasma with minor radius $a$ and a monotonically increasing safety factor profile $q(r)$, where $r$ is the radial coordinate measured from the magnetic axis. The safety factor is defined as the field-line pitch, i.e., the number of toroidal transits per poloidal transit, and rational magnetic surfaces are those for which $q(r)$ equals a rational value $m/n$ with integers $m,n$. In neoclassical tearing mode (NTM) modeling, inputs such as the location of the resonant rational surface and the local magnetic shear are required in reduced models such as the modified Rutherford equation (MRE). The local magnetic shear is defined, for large aspect ratio, by $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$.\n\nAssume a safety factor profile $q(r) = q_0 + \\left(\\frac{r}{a}\\right)^{2}$ with $q_0$ a positive constant such that the $m/n=3/2$ rational surface exists within the plasma column; that is, the conditions $q_0 \\leq \\frac{3}{2} \\leq q(a)$ are satisfied. Starting from the definitions above, determine the radial position $r_s$ of the $m/n=3/2$ rational surface and evaluate the local magnetic shear $s$ at that surface.\n\nExpress the radial position in meters using the parameter $a$ (which is measured in meters), and note that the magnetic shear is dimensionless. Provide the final answer as exact analytic expressions in terms of $q_0$ and $a$. No numerical rounding is required.",
            "solution": "The problem statement is first validated against the required criteria.\n\nThe givens are:\n1.  A large-aspect-ratio, axisymmetric tokamak plasma.\n2.  Minor radius: $a$.\n3.  Safety factor profile: $q(r) = q_0 + \\left(\\frac{r}{a}\\right)^{2}$, where $r$ is the radial coordinate.\n4.  $q_0$ is a positive constant.\n5.  Condition: The $m/n = 3/2$ rational surface exists, which implies $q_0 \\leq \\frac{3}{2} \\leq q(a)$.\n6.  Definition of local magnetic shear: $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$.\n\nThe problem is scientifically grounded, rooted in the principles of magnetohydrodynamics (MHD) and fusion plasma physics. The concepts of safety factor, rational surfaces, and magnetic shear are fundamental to the study of plasma stability and transport, particularly in the context of neoclassical tearing modes (NTMs). The parabolic $q$-profile is a common and valid model used in theoretical analyses. The problem is well-posed, providing all necessary definitions and a clear objective. The provided condition $q_0 \\leq \\frac{3}{2} \\leq q(a)$ guarantees the existence and uniqueness of a physically meaningful solution for the resonant surface location within the plasma radius $a$. The problem statement is objective, using precise, standard terminology without ambiguity. It does not violate any of the invalidity criteria. Therefore, the problem is deemed valid and a solution can be constructed.\n\nThe task is to determine the radial position $r_s$ of the $m/n=3/2$ rational surface and the local magnetic shear $s$ at that surface.\n\nFirst, we determine the radial position $r_s$. A rational magnetic surface is defined as the location where the safety factor $q(r)$ equals a rational number $m/n$. For the specified surface, we have:\n$$\nq(r_s) = \\frac{m}{n} = \\frac{3}{2}\n$$\nWe substitute the given safety factor profile, $q(r) = q_0 + \\left(\\frac{r}{a}\\right)^{2}$, into this condition:\n$$\nq_0 + \\left(\\frac{r_s}{a}\\right)^{2} = \\frac{3}{2}\n$$\nNow, we solve for $r_s$. Rearranging the equation, we get:\n$$\n\\left(\\frac{r_s}{a}\\right)^{2} = \\frac{3}{2} - q_0\n$$\nMultiplying by $a^2$ yields:\n$$\nr_s^2 = a^2 \\left(\\frac{3}{2} - q_0\\right)\n$$\nSince the radial position $r_s$ must be a non-negative value, we take the positive square root:\n$$\nr_s = \\sqrt{a^2 \\left(\\frac{3}{2} - q_0\\right)} = a \\sqrt{\\frac{3}{2} - q_0}\n$$\nThe problem statement guarantees that $q_0 \\leq 3/2$, which ensures the argument of the square root is non-negative, and thus a real solution for $r_s$ exists.\n\nNext, we evaluate the local magnetic shear $s$ at this surface, $r_s$. The magnetic shear is defined as $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$. We first need to compute the derivative of the safety factor profile with respect to $r$:\n$$\n\\frac{dq}{dr} = \\frac{d}{dr} \\left(q_0 + \\left(\\frac{r}{a}\\right)^{2}\\right) = \\frac{d}{dr} \\left(q_0 + \\frac{r^2}{a^2}\\right) = \\frac{2r}{a^2}\n$$\nSubstituting this derivative into the definition of $s(r)$ gives:\n$$\ns(r) = \\frac{r}{q(r)} \\left(\\frac{2r}{a^2}\\right) = \\frac{2r^2}{a^2 q(r)}\n$$\nWe need to evaluate this expression at the resonant surface $r = r_s$. Let's denote the magnetic shear at this surface as $s_s = s(r_s)$:\n$$\ns_s = \\frac{2 r_s^2}{a^2 q(r_s)}\n$$\nFrom our previous steps, we already have expressions for the two terms in the denominator. By definition, $q(r_s) = 3/2$. From the derivation of $r_s$, we found that $r_s^2 = a^2 \\left(\\frac{3}{2} - q_0\\right)$, which can be rewritten as $\\frac{r_s^2}{a^2} = \\frac{3}{2} - q_0$.\nSubstituting these two results into the expression for $s_s$:\n$$\ns_s = \\frac{2 \\left(\\frac{r_s^2}{a^2}\\right)}{q(r_s)} = \\frac{2 \\left(\\frac{3}{2} - q_0\\right)}{\\frac{3}{2}}\n$$\nWe can simplify this expression:\n$$\ns_s = 2 \\left(\\frac{3}{2} - q_0\\right) \\cdot \\frac{2}{3} = \\frac{4}{3} \\left(\\frac{3}{2} - q_0\\right)\n$$\nDistributing the constant $\\frac{4}{3}$ gives the final expression for the magnetic shear at the $q=3/2$ surface:\n$$\ns_s = \\left(\\frac{4}{3}\\right)\\left(\\frac{3}{2}\\right) - \\frac{4}{3} q_0 = 2 - \\frac{4}{3} q_0\n$$\nThe radial position $r_s$ is expressed in terms of $a$ and $q_0$, and the magnetic shear $s_s$ is expressed in terms of $q_0$. Both are exact analytic expressions as required.",
            "answer": "$$\n\\boxed{r_s = a \\sqrt{\\frac{3}{2} - q_0}, \\quad s_s = 2 - \\frac{4}{3} q_0}\n$$"
        },
        {
            "introduction": "A defining feature of a neoclassical tearing mode is the feedback loop between the magnetic island and the plasma profiles. This practice explores the core of this interaction: how the rapid transport of heat along magnetic field lines within an island leads to a flattening of the local temperature and pressure gradients. Understanding this pressure gradient quenching is essential, as it is the direct cause of the bootstrap current deficit that drives the NTM unstable. ",
            "id": "4018226",
            "problem": "Consider a toroidal plasma in which a single-helicity magnetic island forms at a rational surface located at $r = r_s$, where the safety factor $q$ satisfies $q(r_s) = m/n$ for integers $m$ and $n$. Near $r = r_s$, adopt a local slab representation with Cartesian coordinates $(x, y, z)$, where $x = r - r_s$ is the radial coordinate, $y$ is a coordinate aligned with the poloidal-like direction of the island, and $z$ labels the toroidal-like direction. In the constant-$\\psi$ approximation, represent the island by the helical flux function\n$$\n\\psi(x, \\zeta) = \\frac{x^2}{2 w^2} + \\cos(\\zeta),\n$$\nwhere $w$ is the island half-width and $\\zeta$ is the helical angle. Closed flux surfaces exist for $\\psi  1$, and the separatrix is located at $\\psi = 1$. Assume steady-state anisotropic heat conduction with heat flux\n$$\n\\mathbf{q} = - \\kappa_{\\parallel} \\, \\mathbf{b} \\, \\mathbf{b} \\cdot \\nabla T - \\kappa_{\\perp} \\, \\left( \\mathbf{I} - \\mathbf{b} \\, \\mathbf{b} \\right) \\cdot \\nabla T,\n$$\nwhere $\\kappa_{\\parallel} \\gg \\kappa_{\\perp}$, $\\mathbf{b} = \\mathbf{B}/|\\mathbf{B}|$ is the unit vector along the magnetic field $\\mathbf{B}$, $\\mathbf{I}$ is the identity tensor, and $T$ is the temperature. There are no volumetric sources or sinks, so the steady-state energy conservation is\n$$\n\\nabla \\cdot \\mathbf{q} = 0.\n$$\nAssume that the background temperature profile outside the island region is locally linear near $r = r_s$,\n$$\nT_0(r) = T_s + G \\, (r - r_s),\n$$\nwith constant gradient $G = \\left. \\frac{d T_0}{dr} \\right|_{r_s}$ and $T_s = T_0(r_s)$. For simplicity, assume the density $n$ is approximately constant on flux surfaces near $r = r_s$, so that the pressure is $p = n \\, T$.\n\nStarting from the fundamental anisotropic heat conduction law and the steady-state conservation equation, derive the steady-state temperature distribution across the magnetic island in the asymptotic limit $\\kappa_{\\parallel} \\gg \\kappa_{\\perp}$. In particular, justify the functional dependence of $T$ on the helical flux $\\psi$ inside the island, and use appropriate flux-surface arguments to determine the interior temperature. Then, compute the reduction factor in the pressure gradient at the resonant surface,\n$$\nR = \\frac{ \\left. \\frac{d p}{d r} \\right|_{\\text{with island at } r = r_s} }{ \\left. \\frac{d p}{d r} \\right|_{\\text{no island at } r = r_s} }.\n$$\nExpress your final answer as a dimensionless number. Give the exact value (no rounding).",
            "solution": "The user wants me to solve a problem in the field of computational fusion science and engineering, specifically concerning heat transport across a magnetic island and its effect on the local pressure gradient.\n\n### Step 1: Problem Validation\n\nI will first validate the problem statement against the required criteria.\n\n#### Extraction of Givens\n-   **Geometry**: A single-helicity magnetic island forms at a rational surface $r = r_s$, where $q(r_s) = m/n$.\n-   **Coordinates**: Local slab coordinates $(x, y, z)$ are used, with $x = r - r_s$.\n-   **Helical Flux Function**: The island is described by $\\psi(x, \\zeta) = \\frac{x^2}{2 w^2} + \\cos(\\zeta)$, where $w$ is the island half-width and $\\zeta$ is the helical angle.\n-   **Flux Surfaces**: Closed flux surfaces (island interior) exist for $\\psi  1$. The separatrix is at $\\psi = 1$. The island O-point is at $(x=0, \\zeta=\\pi)$, where $\\psi = -1$. The X-point is at $(x=0, \\zeta=0)$, where $\\psi=1$.\n-   **Heat Transport Model**:\n    -   Anisotropic heat flux: $\\mathbf{q} = - \\kappa_{\\parallel} \\, \\mathbf{b} \\, \\mathbf{b} \\cdot \\nabla T - \\kappa_{\\perp} \\, \\left( \\mathbf{I} - \\mathbf{b} \\, \\mathbf{b} \\right) \\cdot \\nabla T$.\n    -   Anisotropy condition: $\\kappa_{\\parallel} \\gg \\kappa_{\\perp}$.\n    -   Energy conservation: $\\nabla \\cdot \\mathbf{q} = 0$ (steady-state, no sources/sinks).\n-   **Boundary/Background Conditions**:\n    -   Background temperature profile: $T_0(r) = T_s + G \\, (r - r_s)$.\n    -   Background temperature gradient: $G = \\left. \\frac{d T_0}{dr} \\right|_{r_s}$.\n    -   Temperature at the rational surface: $T_s = T_0(r_s)$.\n-   **Thermodynamics**:\n    -   Pressure: $p = n \\, T$.\n    -   Density assumption: $n$ is approximately constant on flux surfaces near $r = r_s$.\n-   **Required Calculation**:\n    -   Derive the steady-state temperature distribution $T$ inside the island.\n    -   Compute the pressure gradient reduction factor: $R = \\frac{ \\left. \\frac{d p}{d r} \\right|_{\\text{with island at } r = r_s} }{ \\left. \\frac{d p}{d r} \\right|_{\\text{no island at } r = r_s} }$.\n\n#### Validation using Extracted Givens\n1.  **Scientific or Factual Unsoundness**: The problem is scientifically sound. It uses the standard Braginskii model for anisotropic heat transport in a magnetized plasma and a standard \"constant-$\\psi$\" model for a magnetic island. These are cornerstone models in tokamak and stellarator physics, particularly for studying tearing modes.\n2.  **Non-Formalizable or Irrelevant**: The problem is highly formalizable and directly relevant to the specified topic of *neoclassical tearing mode modeling*. The quenching of the pressure gradient is a key element of NTM theory.\n3.  **Incomplete or Contradictory Setup**: The problem is self-contained. It provides the governing equation ($\\nabla \\cdot \\mathbf{q} = 0$), the constitutive relation for the heat flux ($\\mathbf{q}(T)$), the geometry of the problem ($\\psi(x, \\zeta)$), and the boundary conditions (the background profile $T_0(r)$). There are no contradictions.\n4.  **Unrealistic or Infeasible**: The model is a simplification (slab geometry, no flows, constant-$\\psi$), but it is a standard and physically insightful idealization used extensively in theoretical plasma physics. It is not physically impossible or implausible within this theoretical context.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-posed. The physical condition $\\kappa_{\\parallel} \\gg \\kappa_{\\perp}$ provides the necessary closure to determine the temperature profile within the island, leading to a unique and meaningful solution for the pressure gradient.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem is a standard but non-trivial exercise in plasma transport theory. It requires applying fundamental principles to a specific geometry and understanding the physical implications, such as flux-surface averaging and profile flattening.\n7.  **Outside Scientific Verifiability**: The model's predictions can be, and have been, compared with results from more comprehensive numerical simulations and experimental observations. It is fully within the realm of scientific verifiability.\n\n#### Verdict and Action\nThe problem is valid. I will proceed with the detailed solution.\n\n### Step 2: Solution Derivation\n\nThe solution proceeds in three stages: first, determining the temperature profile inside the magnetic island; second, determining the corresponding pressure profile and its gradient; and third, calculating the reduction factor $R$.\n\n**1. Temperature Distribution within the Island**\n\nThe starting point is the steady-state energy conservation equation with no sources or sinks:\n$$\n\\nabla \\cdot \\mathbf{q} = 0\n$$\nThe heat flux $\\mathbf{q}$ is given by the anisotropic conduction law:\n$$\n\\mathbf{q} = - \\kappa_{\\parallel} (\\mathbf{b} \\cdot \\nabla T) \\mathbf{b} - \\kappa_{\\perp} \\nabla_{\\perp} T\n$$\nwhere $\\mathbf{b} = \\mathbf{B}/|\\mathbf{B}|$ is the unit vector along the magnetic field and $\\nabla_{\\perp} T = (\\mathbf{I} - \\mathbf{b}\\mathbf{b}) \\cdot \\nabla T$ is the component of the temperature gradient perpendicular to the magnetic field.\n\nThe problem states that the parallel thermal conductivity is much larger than the perpendicular one, $\\kappa_{\\parallel} \\gg \\kappa_{\\perp}$. In a steady state, any finite temperature gradient along a magnetic field line, $\\mathbf{b} \\cdot \\nabla T \\neq 0$, would drive an enormous parallel heat flux, $\\mathbf{q}_{\\parallel} \\propto \\kappa_{\\parallel} (\\mathbf{b} \\cdot \\nabla T)$. Without correspondingly large sources and sinks to balance this flux, such a large gradient cannot be sustained. Therefore, in the limit $\\kappa_{\\parallel} \\to \\infty$, the parallel temperature gradient must vanish to maintain a finite steady-state solution:\n$$\n\\mathbf{b} \\cdot \\nabla T = 0\n$$\nThis fundamental result implies that the temperature $T$ must be constant along magnetic field lines. Inside the magnetic island ($\\psi  1$), the magnetic field lines lie on nested, closed flux surfaces defined by $\\psi = \\text{constant}$. Since the field lines are generally ergodic on these surfaces (they cover the surface densely), the temperature must be constant over each entire flux surface. Mathematically, this means the temperature becomes a function of the helical flux function $\\psi$ only:\n$$\nT = T(\\psi) \\quad \\text{for } \\psi  1\n$$\nWith $\\mathbf{b} \\cdot \\nabla T = 0$, the heat flux equation simplifies to purely perpendicular transport: $\\mathbf{q} = - \\kappa_{\\perp} \\nabla_{\\perp} T$. Because $T=T(\\psi)$, we have $\\nabla T = \\frac{dT}{d\\psi} \\nabla \\psi$. Since $\\nabla \\psi$ is, by definition, perpendicular to the flux surface (and hence to $\\mathbf{b}$), we have $\\nabla_{\\perp} T = \\nabla T$. Thus,\n$$\n\\mathbf{q} = - \\kappa_{\\perp} \\frac{dT}{d\\psi} \\nabla \\psi \\quad \\text{for } \\psi  1\n$$\nSubstituting this into the conservation equation gives:\n$$\n\\nabla \\cdot \\left( - \\kappa_{\\perp} \\frac{dT}{d\\psi} \\nabla \\psi \\right) = 0\n$$\nTo solve for the functional form of $T(\\psi)$, we consider the physical consequence of having no heat sources or sinks within the volume enclosed by the separatrix ($\\psi=1$). The total heat flux integrated over the separatrix surface must be zero. The most direct physical conclusion from the efficient \"short-circuiting\" of heat by parallel transport is that the entire island interior equilibrates to a single temperature. The temperature profile becomes completely flat across the island.\n$$\nT(x, \\zeta) = T_{\\text{flat}} \\quad \\text{for } \\psi(x, \\zeta)  1\n$$\nTo determine the value of this constant temperature, $T_{\\text{flat}}$, we enforce continuity between the temperature profile inside the island and the background profile outside. The island region is centered on the rational surface $r=r_s$ (or $x=0$). By symmetry, the flattened temperature must equal the background temperature at this central location. The background temperature at $r=r_s$ is given as $T_s$.\n$$\nT_{\\text{flat}} = T_s\n$$\nThus, the steady-state temperature distribution inside the magnetic island is constant and equal to the unperturbed temperature at the resonant surface.\n\n**2. Pressure Gradient at the Resonant Surface**\n\nThe pressure is given by $p = nT$. The problem states that the density $n$ is constant on flux surfaces, so $n = n(\\psi)$ inside the island. Since the temperature is constant ($T=T_s$) throughout the island interior ($\\psi  1$), the pressure is also a function of $\\psi$ only:\n$$\np(x, \\zeta) = n(\\psi(x, \\zeta)) T_s = p(\\psi(x, \\zeta)) \\quad \\text{for } \\psi  1\n$$\nThe quantity $\\left. \\frac{dp}{dr} \\right|_{\\text{with island at } r=r_s}$ represents the effective macroscopic pressure gradient at the center of the island. This is obtained by first averaging the pressure over the helical angle $\\zeta$ to get a mean pressure profile as a function of the radial coordinate $x=r-r_s$, and then taking its derivative.\nLet $\\bar{p}(x)$ be the flux-surface-averaged pressure:\n$$\n\\bar{p}(x) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} p(\\psi(x,\\zeta)) d\\zeta\n$$\nWe need to evaluate the derivative of this function at $x=0$: $\\left. \\frac{d\\bar{p}}{dx} \\right|_{x=0}$.\n\nA key property of the helical flux function, $\\psi(x, \\zeta) = \\frac{x^2}{2 w^2} + \\cos(\\zeta)$, is its symmetry with respect to the radial coordinate $x$. It is an even function of $x$:\n$$\n\\psi(-x, \\zeta) = \\frac{(-x)^2}{2 w^2} + \\cos(\\zeta) = \\frac{x^2}{2 w^2} + \\cos(\\zeta) = \\psi(x, \\zeta)\n$$\nSince the averaged pressure $\\bar{p}(x)$ depends on $x$ only through the function $\\psi(x, \\zeta)$, this symmetry in $\\psi$ confers a symmetry on $\\bar{p}(x)$:\n$$\n\\bar{p}(-x) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} p(\\psi(-x,\\zeta)) d\\zeta = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} p(\\psi(x,\\zeta)) d\\zeta = \\bar{p}(x)\n$$\nThe averaged pressure profile $\\bar{p}(x)$ is an even function of $x$. The derivative of any differentiable even function is an odd function. A property of any odd function $f(x)$ is that $f(0) = 0$. Therefore, the gradient of the averaged pressure at $x=0$ must be zero:\n$$\n\\left. \\frac{d\\bar{p}}{dx} \\right|_{x=0} = 0\n$$\nSo, the numerator of the reduction factor is zero:\n$$\n\\left. \\frac{d p}{d r} \\right|_{\\text{with island at } r = r_s} = 0\n$$\nThis result is known as the \"quenching\" of the pressure gradient by the magnetic island.\n\n**3. Calculation of the Reduction Factor $R$**\n\nThe reduction factor $R$ is the ratio of the pressure gradient with the island to the pressure gradient without it, evaluated at the resonant surface.\n\nThe numerator, as derived above, is $0$.\n\nThe denominator is the pressure gradient in the absence of the island, evaluated at $r=r_s$:\n$$\n\\left. \\frac{d p}{d r} \\right|_{\\text{no island at } r = r_s} = \\left. \\frac{d p_0}{d r} \\right|_{r_s}\n$$\nThe background pressure is $p_0(r) = n_0(r) T_0(r)$. Its gradient is $\\frac{dp_0}{dr} = n_0 \\frac{dT_0}{dr} + T_0 \\frac{dn_0}{dr}$. At $r=r_s$:\n$$\n\\left. \\frac{dp_0}{dr} \\right|_{r_s} = n_0(r_s) G + T_s \\left. \\frac{dn_0}{dr} \\right|_{r_s}\n$$\nAssuming a typical plasma with a non-zero pressure gradient (i.e., the denominator is not zero), the reduction factor is:\n$$\nR = \\frac{0}{n_0(r_s) G + T_s \\left. \\frac{dn_0}{dr} \\right|_{r_s}} = 0\n$$\nThe final result is independent of the specific values of the background gradients, as long as they are not zero.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "The evolution of an NTM is governed by a delicate balance of competing physical effects, which are encapsulated in the Modified Rutherford Equation (MRE). This hands-on exercise moves from theory to practical estimation, guiding you to derive and apply scaling laws for the key destabilizing bootstrap current term and the stabilizing ion polarization current term. Developing the ability to estimate the relative importance of these terms is a crucial skill for predicting NTM stability in various tokamak operating regimes. ",
            "id": "4018187",
            "problem": "You are asked to construct a computational estimator for the relative importance of two terms that enter the Modified Rutherford Equation (MRE) for magnetic island evolution in a tokamak: the polarization current term and the bootstrap drive term. The derivation and implementation must start from a valid fundamental base and lead to a dimensionally consistent, testable calculation.\n\nStarting point and derivation requirements:\n- Begin from the single-fluid ion momentum balance and drift kinematics. Use the definition of ion polarization drift as the response to a time-varying perpendicular electric field. Use quasineutrality, the perpendicular diamagnetic current density definition, and the trapped particle fraction scaling in a large-aspect-ratio tokamak to establish a scaling for the bootstrap current relative to the diamagnetic current.\n- Treat the island as a rigidly rotating structure with angular frequency $\\omega$ in radians per second, with a characteristic electrostatic potential variation of amplitude $\\phi_0$ across a radial island half-width $W$. Estimate the perpendicular electric field magnitude as $E_\\perp \\sim \\phi_0 / W$ and its time derivative magnitude as $\\mathrm{d}E_\\perp/\\mathrm{d}t \\sim \\omega E_\\perp$.\n- Use the large-aspect-ratio approximation with inverse aspect ratio $\\epsilon = r/R$ and trapped fraction scaling $\\sqrt{\\epsilon}$ to estimate the magnitude of the bootstrap current density from the pressure gradient. Assume the bootstrap contribution aligns with the direction of the poloidal field and scales like the diamagnetic current magnitude projected appropriately.\n- The program must compute, for each provided test case, the following quantities:\n  1. The polarization current density magnitude $|j_{\\mathrm{pol}}|$ using only quantities provided in the test case and the fundamental laws you derive from.\n  2. The bootstrap current density magnitude $|j_{\\mathrm{bs}}|$ using the trapped fraction scaling and diamagnetic current magnitude based on the pressure gradient and the poloidal magnetic field.\n  3. The ratio $R = |j_{\\mathrm{pol}}| / |j_{\\mathrm{bs}}|$.\n- Classification rule: return an integer classification code $C$ for each case according to the following thresholds:\n  - If $R \\geq 1$, set $C = 2$ (polarization-dominant regime).\n  - If $R \\leq 0.1$, set $C = 0$ (polarization-negligible regime).\n  - Otherwise, set $C = 1$ (intermediate regime).\n- Physical units specification:\n  - Ion number density $n_i$ in $\\mathrm{m}^{-3}$.\n  - Ion mass $m_i$ in $\\mathrm{kg}$.\n  - Toroidal magnetic field magnitude $B$ in $\\mathrm{T}$.\n  - Poloidal magnetic field magnitude $B_\\theta$ in $\\mathrm{T}$.\n  - Island half-width $W$ in $\\mathrm{m}$.\n  - Electrostatic potential amplitude $\\phi_0$ in $\\mathrm{V}$.\n  - Angular frequency $\\omega$ in radians per second.\n  - Pressure gradient $\\mathrm{d}p/\\mathrm{d}r$ in $\\mathrm{Pa/m}$.\n  - Minor radius $r$ and major radius $R$ in $\\mathrm{m}$.\n- Angles: use radians consistently for any angular quantities.\n- Final output format: your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each result is itself a list of two elements $[R, C]$ (for example, $[[0.12,0],[5.3,2]]$ for two test cases).\n\nTest suite (five cases spanning typical, edge, and boundary regimes; all numbers are in the units specified above):\n- Case A (typical high-gradient, moderate rotation, polarization negligible): $n_i = 1.0 \\times 10^{20}$, $m_i = 3.344 \\times 10^{-27}$, $B = 3.0$, $B_\\theta = 0.30$, $W = 5.0 \\times 10^{-2}$, $\\phi_0 = 1.0 \\times 10^{2}$, $\\omega = 1.0 \\times 10^{4}$, $\\mathrm{d}p/\\mathrm{d}r = 1.0 \\times 10^{5}$, $r = 1.0$, $R = 3.0$.\n- Case B (low-gradient, strong rotation and potential, polarization dominant): $n_i = 1.0 \\times 10^{20}$, $m_i = 3.344 \\times 10^{-27}$, $B = 3.0$, $B_\\theta = 0.30$, $W = 5.0 \\times 10^{-2}$, $\\phi_0 = 1.0 \\times 10^{3}$, $\\omega = 1.0 \\times 10^{5}$, $\\mathrm{d}p/\\mathrm{d}r = 1.0 \\times 10^{1}$, $r = 1.0$, $R = 3.0$.\n- Case C (strong fields, large island, high gradient, polarization negligible): $n_i = 1.0 \\times 10^{20}$, $m_i = 3.344 \\times 10^{-27}$, $B = 6.0$, $B_\\theta = 0.60$, $W = 1.5 \\times 10^{-1}$, $\\phi_0 = 5.0 \\times 10^{1}$, $\\omega = 5.0 \\times 10^{3}$, $\\mathrm{d}p/\\mathrm{d}r = 5.0 \\times 10^{5}$, $r = 1.0$, $R = 3.0$.\n- Case D (narrow island, moderate fields, high rotation, moderate gradient, near or above unity ratio): $n_i = 5.0 \\times 10^{19}$, $m_i = 3.344 \\times 10^{-27}$, $B = 2.0$, $B_\\theta = 0.20$, $W = 5.0 \\times 10^{-3}$, $\\phi_0 = 2.0 \\times 10^{3}$, $\\omega = 2.0 \\times 10^{5}$, $\\mathrm{d}p/\\mathrm{d}r = 2.0 \\times 10^{3}$, $r = 3.0 \\times 10^{-1}$, $R = 3.0$.\n- Case E (same as Case D but with larger gradient to probe intermediate regime): $n_i = 5.0 \\times 10^{19}$, $m_i = 3.344 \\times 10^{-27}$, $B = 2.0$, $B_\\theta = 0.20$, $W = 5.0 \\times 10^{-3}$, $\\phi_0 = 2.0 \\times 10^{3}$, $\\omega = 2.0 \\times 10^{5}$, $\\mathrm{d}p/\\mathrm{d}r = 2.0 \\times 10^{4}$, $r = 3.0 \\times 10^{-1}$, $R = 3.0$.\n\nYour program must implement the derived expressions and, for the given test suite, output a single line in the exact format described containing the $[R, C]$ results for Cases A through E in order.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and internally consistent. It provides a clear path for deriving the necessary physical quantities from fundamental principles of plasma physics and provides all necessary data for the test cases. Therefore, the problem is deemed valid and a full solution is provided below.\n\nThe objective is to derive expressions for the polarization current density, $|j_{\\mathrm{pol}}|$, and the bootstrap current density, $|j_{\\mathrm{bs}}|$, and then compute their ratio $R = |j_{\\mathrm{pol}}| / |j_{\\mathrm{bs}}|$ to classify the plasma regime.\n\n**1. Derivation of Polarization Current Density Magnitude $|j_{\\mathrm{pol}}|$**\n\nThe polarization current arises from the inertia of ions as they respond to a time-varying electric field. The single-fluid ion momentum balance equation, when linearized for small perturbations, yields the polarization drift velocity, $\\mathbf{v}_{\\mathrm{pol}}$. For ions of mass $m_i$ and charge $q_i$, in a magnetic field $\\mathbf{B}$, this drift is given by:\n$$ \\mathbf{v}_{\\mathrm{pol}} = \\frac{m_i}{q_i B^2} \\frac{\\mathrm{d}\\mathbf{E}_\\perp}{\\mathrm{d}t} $$\nwhere $\\mathbf{E}_\\perp$ is the electric field perpendicular to $\\mathbf{B}$.\n\nThe polarization current density, $\\mathbf{j}_{\\mathrm{pol}}$, is the current carried by these drifting ions. With an ion number density of $n_i$, it is given by:\n$$ \\mathbf{j}_{\\mathrm{pol}} = n_i q_i \\mathbf{v}_{\\mathrm{pol}} = n_i q_i \\left( \\frac{m_i}{q_i B^2} \\frac{\\mathrm{d}\\mathbf{E}_\\perp}{\\mathrm{d}t} \\right) = \\frac{n_i m_i}{B^2} \\frac{\\mathrm{d}\\mathbf{E}_\\perp}{\\mathrm{d}t} $$\nWe are asked to estimate the magnitude of this current. The problem states that the magnetic island is treated as a rigidly rotating structure with angular frequency $\\omega$. The characteristic perpendicular electric field, $E_\\perp$, is associated with an electrostatic potential variation $\\phi_0$ across the island half-width $W$. This gives the estimation:\n$$ E_\\perp \\sim \\frac{\\phi_0}{W} $$\nThe time derivative is estimated based on the island rotation frequency $\\omega$:\n$$ \\left| \\frac{\\mathrm{d}\\mathbf{E}_\\perp}{\\mathrm{d}t} \\right| \\sim \\omega E_\\perp $$\nSubstituting these estimations into the expression for the polarization current density magnitude, we get:\n$$ |j_{\\mathrm{pol}}| \\sim \\frac{n_i m_i}{B^2} (\\omega E_\\perp) \\approx \\frac{n_i m_i \\omega \\phi_0}{B^2 W} $$\nHere, $B$ is the magnitude of the total magnetic field, which in a tokamak is dominated by the toroidal component, so we use the given toroidal field magnitude for $B$.\n\n**2. Derivation of Bootstrap Current Density Magnitude $|j_{\\mathrm{bs}}|$**\n\nThe bootstrap current is a self-generated current in toroidal plasmas driven by the pressure gradient via neoclassical effects related to trapped particles. The problem asks for an estimation based on the diamagnetic current and trapped particle fraction.\n\nThe diamagnetic current, $\\mathbf{j}_{\\mathrm{dia}}$, arises from the pressure gradient and is given by:\n$$ \\mathbf{j}_{\\mathrm{dia}} = \\frac{\\mathbf{B} \\times \\nabla p}{B^2} $$\nIts magnitude, assuming the pressure gradient $\\nabla p$ is predominantly radial and perpendicular to $\\mathbf{B}$, is:\n$$ |j_{\\mathrm{dia}}| \\approx \\frac{|\\nabla p|}{B} \\approx \\frac{|\\mathrm{d}p/\\mathrm{d}r|}{B} $$\nThe bootstrap current is a parallel current, $j_{bs, \\parallel}$, whose existence is tied to the viscosity between trapped and passing particles. In the large-aspect-ratio limit of a tokamak, the fraction of trapped particles scales with the square root of the inverse aspect ratio, $\\epsilon = r/R$, where $r$ is the minor radius and $R$ is the major radius.\n$$ f_{\\mathrm{trapped}} \\sim \\sqrt{\\epsilon} = \\sqrt{\\frac{r}{R}} $$\nThe bootstrap current is driven by the pressure gradient, and a standard result from neoclassical theory shows that its magnitude scales as:\n$$ |j_{\\mathrm{bs}}| \\sim f_{\\mathrm{trapped}} \\frac{|\\nabla p|}{B_\\theta} $$\nwhere $B_\\theta$ is the poloidal magnetic field. The use of $B_\\theta$ instead of the total field $B$ is a key feature of the bootstrap current derivation, related to the banana orbit widths and poloidal transit of particles.\n\nCombining these elements, we arrive at the desired estimation for the bootstrap current density magnitude:\n$$ |j_{\\mathrm{bs}}| \\approx \\sqrt{\\frac{r}{R}} \\frac{1}{B_\\theta} \\left| \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\right| $$\nWe will use the absolute value of the pressure gradient provided in the test cases.\n\n**3. Ratio and Classification**\n\nThe relative importance of the two terms is assessed by their ratio, $R$:\n$$ R = \\frac{|j_{\\mathrm{pol}}|}{|j_{\\mathrm{bs}}|} = \\frac{ \\frac{n_i m_i \\omega \\phi_0}{B^2 W} }{ \\sqrt{\\frac{r}{R}} \\frac{1}{B_\\theta} \\left| \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\right| } = \\frac{n_i m_i \\omega \\phi_0 B_\\theta}{B^2 W \\sqrt{r/R} \\left| \\frac{\\mathrm{d}p}{\\mathrm{d}r} \\right|} $$\nBased on the value of this ratio $R$, a classification code $C$ is assigned according to the rules:\n- If $R \\geq 1$, set $C = 2$ (polarization-dominant regime).\n- If $R \\leq 0.1$, set $C = 0$ (polarization-negligible regime).\n- Otherwise ($0.1  R  1$), set $C = 1$ (intermediate regime).\n\nThese derived expressions will be implemented to evaluate the provided test cases.",
            "answer": "```python\nimport numpy as np\nimport json\n\ndef solve():\n    \"\"\"\n    Calculates the relative importance of polarization and bootstrap currents\n    for neoclassical tearing mode modeling in a tokamak.\n    \"\"\"\n\n    # Test cases provided in the problem statement.\n    # All units are SI as specified.\n    test_cases = [\n        {  # Case A\n            \"n_i\": 1.0e20, \"m_i\": 3.344e-27, \"B\": 3.0, \"B_theta\": 0.30,\n            \"W\": 5.0e-2, \"phi_0\": 1.0e2, \"omega\": 1.0e4, \"dp_dr\": 1.0e5,\n            \"r\": 1.0, \"R_maj\": 3.0\n        },\n        {  # Case B\n            \"n_i\": 1.0e20, \"m_i\": 3.344e-27, \"B\": 3.0, \"B_theta\": 0.30,\n            \"W\": 5.0e-2, \"phi_0\": 1.0e3, \"omega\": 1.0e5, \"dp_dr\": 1.0e1,\n            \"r\": 1.0, \"R_maj\": 3.0\n        },\n        {  # Case C\n            \"n_i\": 1.0e20, \"m_i\": 3.344e-27, \"B\": 6.0, \"B_theta\": 0.60,\n            \"W\": 1.5e-1, \"phi_0\": 5.0e1, \"omega\": 5.0e3, \"dp_dr\": 5.0e5,\n            \"r\": 1.0, \"R_maj\": 3.0\n        },\n        {  # Case D\n            \"n_i\": 5.0e19, \"m_i\": 3.344e-27, \"B\": 2.0, \"B_theta\": 0.20,\n            \"W\": 5.0e-3, \"phi_0\": 2.0e3, \"omega\": 2.0e5, \"dp_dr\": 2.0e3,\n            \"r\": 3.0e-1, \"R_maj\": 3.0\n        },\n        {  # Case E\n            \"n_i\": 5.0e19, \"m_i\": 3.344e-27, \"B\": 2.0, \"B_theta\": 0.20,\n            \"W\": 5.0e-3, \"phi_0\": 2.0e3, \"omega\": 2.0e5, \"dp_dr\": 2.0e4,\n            \"r\": 3.0e-1, \"R_maj\": 3.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract parameters for clarity\n        n_i = case[\"n_i\"]\n        m_i = case[\"m_i\"]\n        B = case[\"B\"]\n        B_theta = case[\"B_theta\"]\n        W = case[\"W\"]\n        phi_0 = case[\"phi_0\"]\n        omega = case[\"omega\"]\n        dp_dr = case[\"dp_dr\"]\n        r = case[\"r\"]\n        R_maj = case[\"R_maj\"]\n\n        # Calculate polarization current density magnitude\n        # Formula: |j_pol| = (n_i * m_i * omega * phi_0) / (B^2 * W)\n        j_pol = (n_i * m_i * omega * phi_0) / (B**2 * W)\n\n        # Calculate bootstrap current density magnitude\n        # Formula: |j_bs| = sqrt(r / R_maj) * (1 / B_theta) * |dp/dr|\n        # The provided dp_dr is treated as the magnitude.\n        epsilon = r / R_maj\n        j_bs = np.sqrt(epsilon) * (1 / B_theta) * dp_dr\n\n        # Calculate the ratio R\n        # Handle case where j_bs is zero to avoid division by zero\n        if j_bs == 0:\n            # If j_bs is zero and j_pol is non-zero, the ratio is effectively infinite.\n            # If both are zero, the ratio is indeterminate, but we can define it as 1.\n            ratio_R = float('inf') if j_pol  0 else 1.0\n        else:\n            ratio_R = j_pol / j_bs\n\n        # Classify the regime based on the ratio R\n        classification_C = 0\n        if ratio_R = 1:\n            classification_C = 2\n        elif ratio_R  0.1:  # and ratio_R  1\n            classification_C = 1\n        # else C remains 0 (for ratio_R = 0.1)\n\n        results.append([ratio_R, classification_C])\n\n    # Format the output as a string representing a list of lists.\n    # json.dumps provides a compact, standard representation.\n    # It ensures no extra spaces and correct formatting.\n    formatted_results = json.dumps(results, separators=(',', ':'))\n    \n    print(formatted_results)\n\nsolve()\n```"
        }
    ]
}