{
    "hands_on_practices": [
        {
            "introduction": "新经典撕裂模（NTM）的建模始于确定其在托卡马克等离子体中的位置。本练习  旨在提供计算有理磁面位置和局部磁剪切这两个关键参数的实践，它们共同决定了撕裂模的稳定性。通过分析一个常见的抛物线型安全因子分布，您将掌握表征NTM生长所需的磁平衡位形的基本技能。",
            "id": "4018196",
            "problem": "考虑一个大环径比的轴对称托卡马克等离子体，其小半径为 $a$，安全因子分布 $q(r)$ 单调递增，其中 $r$ 是从磁轴量起的径向坐标。安全因子定义为磁力线的螺距，即每绕行角向一圈所对应的环向圈数。有理磁面是指其上 $q(r)$ 等于有理数 $m/n$（其中 $m,n$ 为整数）的磁面。在新经典撕裂模（NTM）建模中，简化模型（如修正卢瑟福方程（MRE））需要共振有理面的位置和局域磁剪切等输入参数。对于大环径比，局域磁剪切定义为 $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$。\n\n假设安全因子分布为 $q(r) = q_0 + \\left(\\frac{r}{a}\\right)^{2}$，其中 $q_0$ 是一个正常数，使得 $m/n=3/2$ 有理磁面存在于等离子体柱内；即满足条件 $q_0 \\leq \\frac{3}{2} \\leq q(a)$。从上述定义出发，确定 $m/n=3/2$ 有理磁面的径向位置 $r_s$，并计算该磁面上的局域磁剪切 $s$。\n\n使用参数 $a$（单位为米）表示径向位置（单位为米），并注意磁剪切是无量纲的。以 $q_0$ 和 $a$ 的精确解析表达式给出最终答案。不需要进行数值取整。",
            "solution": "首先根据所需准则对问题陈述进行验证。\n\n已知条件如下：\n1.  一个大环径比的轴对称托卡马克等离子体。\n2.  小半径：$a$。\n3.  安全因子分布：$q(r) = q_0 + \\left(\\frac{r}{a}\\right)^{2}$，其中 $r$ 是径向坐标。\n4.  $q_0$ 是一个正常数。\n5.  条件：$m/n = 3/2$ 有理磁面存在，这意味着 $q_0 \\leq \\frac{3}{2} \\leq q(a)$。\n6.  局域磁剪切的定义：$s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$。\n\n该问题具有科学依据，植根于磁流体动力学（MHD）和聚变等离子体物理学的原理。安全因子、有理磁面和磁剪切的概念是研究等离子体稳定性和输运的基础，尤其是在新经典撕裂模（NTM）的背景下。抛物线型的q分布是理论分析中常用且有效的模型。该问题是适定的，提供了所有必要的定义和明确的目标。所给条件 $q_0 \\leq \\frac{3}{2} \\leq q(a)$ 保证了在等离子体半径 $a$ 内，共振面位置存在唯一的、具有物理意义的解。问题陈述是客观的，使用了精确、标准的术语，没有歧义。它没有违反任何无效性准则。因此，该问题被认为是有效的，可以构建解答。\n\n任务是确定 $m/n=3/2$ 有理磁面的径向位置 $r_s$ 以及该磁面上的局域磁剪切 $s$。\n\n首先，我们确定径向位置 $r_s$。有理磁面定义为安全因子 $q(r)$ 等于有理数 $m/n$ 的位置。对于指定的磁面，我们有：\n$$\nq(r_s) = \\frac{m}{n} = \\frac{3}{2}\n$$\n我们将给定的安全因子分布 $q(r) = q_0 + \\left(\\frac{r}{a}\\right)^{2}$ 代入此条件：\n$$\nq_0 + \\left(\\frac{r_s}{a}\\right)^{2} = \\frac{3}{2}\n$$\n现在，我们求解 $r_s$。整理方程，我们得到：\n$$\n\\left(\\frac{r_s}{a}\\right)^{2} = \\frac{3}{2} - q_0\n$$\n两边乘以 $a^2$ 得到：\n$$\nr_s^2 = a^2 \\left(\\frac{3}{2} - q_0\\right)\n$$\n由于径向位置 $r_s$ 必须为非负值，我们取正平方根：\n$$\nr_s = \\sqrt{a^2 \\left(\\frac{3}{2} - q_0\\right)} = a \\sqrt{\\frac{3}{2} - q_0}\n$$\n问题陈述保证了 $q_0 \\leq 3/2$，这确保了平方根内的参数为非负，因此 $r_s$ 存在实数解。\n\n接下来，我们计算该磁面 $r_s$ 上的局域磁剪切 $s$。磁剪切定义为 $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$。我们首先需要计算安全因子分布对 $r$ 的导数：\n$$\n\\frac{dq}{dr} = \\frac{d}{dr} \\left(q_0 + \\left(\\frac{r}{a}\\right)^{2}\\right) = \\frac{d}{dr} \\left(q_0 + \\frac{r^2}{a^2}\\right) = \\frac{2r}{a^2}\n$$\n将此导数代入 $s(r)$ 的定义中，得到：\n$$\ns(r) = \\frac{r}{q(r)} \\left(\\frac{2r}{a^2}\\right) = \\frac{2r^2}{a^2 q(r)}\n$$\n我们需要在共振面 $r = r_s$ 处计算此表达式的值。我们将该磁面上的磁剪切表示为 $s_s = s(r_s)$：\n$$\ns_s = \\frac{2 r_s^2}{a^2 q(r_s)}\n$$\n根据我们之前的步骤，我们已经有了分母中两项的表达式。根据定义，$q(r_s) = 3/2$。从 $r_s$ 的推导中，我们得到 $r_s^2 = a^2 \\left(\\frac{3}{2} - q_0\\right)$，这可以重写为 $\\frac{r_s^2}{a^2} = \\frac{3}{2} - q_0$。\n将这两个结果代入 $s_s$ 的表达式中：\n$$\ns_s = \\frac{2 \\left(\\frac{r_s^2}{a^2}\\right)}{q(r_s)} = \\frac{2 \\left(\\frac{3}{2} - q_0\\right)}{\\frac{3}{2}}\n$$\n我们可以简化这个表达式：\n$$\ns_s = 2 \\left(\\frac{3}{2} - q_0\\right) \\cdot \\frac{2}{3} = \\frac{4}{3} \\left(\\frac{3}{2} - q_0\\right)\n$$\n将常数 $\\frac{4}{3}$ 分配进去，得到 $q=3/2$ 磁面上磁剪切的最终表达式：\n$$\ns_s = \\left(\\frac{4}{3}\\right)\\left(\\frac{3}{2}\\right) - \\frac{4}{3} q_0 = 2 - \\frac{4}{3} q_0\n$$\n径向位置 $r_s$ 用 $a$ 和 $q_0$ 表示，磁剪切 $s_s$ 用 $q_0$ 表示。两者都是所要求的精确解析表达式。",
            "answer": "$$\n\\boxed{r_s = a \\sqrt{\\frac{3}{2} - q_0}, \\quad s_s = 2 - \\frac{4}{3} q_0}\n$$"
        },
        {
            "introduction": "新经典撕裂模的核心机制在于磁岛与等离子体压力之间的自持相互作用。本练习  阐释了磁岛形成的一个根本性后果：温度和压力剖面的平坦化。通过应用高度各向异性的热输运原理，您将推导出为何驱动自举电流的压力梯度在磁岛内部被“淬灭”（quenched），这是理解NTM不稳定机制的关键一步。",
            "id": "4018226",
            "problem": "考虑一个环形等离子体，在位于 $r = r_s$ 的有理面上形成一个单螺旋磁岛，其中安全因子 $q$ 满足 $q(r_s) = m/n$，$m$ 和 $n$ 为整数。在 $r = r_s$ 附近，采用局域平板模型，其笛卡尔坐标为 $(x, y, z)$，其中 $x = r - r_s$ 是径向坐标，$y$ 是与磁岛的类极向方向对齐的坐标，$z$ 标记了类环向方向。在常$\\psi$近似下，该磁岛可用螺旋磁通函数表示\n$$\n\\psi(x, \\zeta) = \\frac{x^2}{2 w^2} + \\cos(\\zeta),\n$$\n其中 $w$ 是磁岛半宽，$\\zeta$ 是螺旋角。当 $\\psi  1$ 时存在闭合磁通面，分界线位于 $\\psi = 1$。假设存在稳态各向异性热传导，其热通量为\n$$\n\\mathbf{q} = - \\kappa_{\\parallel} \\, \\mathbf{b} \\, \\mathbf{b} \\cdot \\nabla T - \\kappa_{\\perp} \\, \\left( \\mathbf{I} - \\mathbf{b} \\, \\mathbf{b} \\right) \\cdot \\nabla T,\n$$\n其中 $\\kappa_{\\parallel} \\gg \\kappa_{\\perp}$，$\\mathbf{b} = \\mathbf{B}/|\\mathbf{B}|$ 是沿磁场 $\\mathbf{B}$ 的单位矢量，$\\mathbf{I}$ 是单位张量，$T$ 是温度。不存在体积源或汇，因此稳态能量守恒方程为\n$$\n\\nabla \\cdot \\mathbf{q} = 0.\n$$\n假设磁岛区域外的背景温度剖面在 $r = r_s$ 附近是局域线性的，\n$$\nT_0(r) = T_s + G \\, (r - r_s),\n$$\n其梯度为常数 $G = \\left. \\frac{d T_0}{dr} \\right|_{r_s}$ 且 $T_s = T_0(r_s)$。为简单起见，假设在 $r = r_s$ 附近的磁通面上密度 $n$ 近似为常数，因此压强为 $p = n \\, T$。\n\n从基本的各向异性热传导定律和稳态守恒方程出发，在渐近极限 $\\kappa_{\\parallel} \\gg \\kappa_{\\perp}$ 下，推导穿过磁岛的稳态温度分布。特别地，请论证磁岛内部温度 $T$ 对螺旋磁通 $\\psi$ 的函数依赖关系，并使用适当的磁通面论证来确定内部温度。然后，计算共振面上压强梯度的折扣因子，\n$$\nR = \\frac{ \\left. \\frac{d p}{d r} \\right|_{\\text{with island at } r = r_s} }{ \\left. \\frac{d p}{d r} \\right|_{\\text{no island at } r = r_s} }.\n$$\n将最终答案表示为一个无量纲数。给出精确值（不要四舍五入）。",
            "solution": "用户要求我解决一个计算聚变科学与工程领域的问题，具体涉及穿过磁岛的热输运及其对局域压强梯度的影响。\n\n### 第1步：问题验证\n\n我将首先根据所需标准验证问题陈述。\n\n#### 提取已知条件\n-   **几何**：在有理面 $r = r_s$ 处形成一个单螺旋磁岛，其中 $q(r_s) = m/n$。\n-   **坐标**：使用局域平板坐标 $(x, y, z)$，其中 $x = r - r_s$。\n-   **螺旋磁通函数**：磁岛由 $\\psi(x, \\zeta) = \\frac{x^2}{2 w^2} + \\cos(\\zeta)$ 描述，其中 $w$ 是磁岛半宽，$\\zeta$ 是螺旋角。\n-   **磁通面**：对于 $\\psi  1$，存在闭合磁通面（磁岛内部）。分界线在 $\\psi = 1$。磁岛O点在 $(x=0, \\zeta=\\pi)$，此处 $\\psi = -1$。X点在 $(x=0, \\zeta=0)$，此处 $\\psi=1$。\n-   **热输运模型**：\n    -   各向异性热通量：$\\mathbf{q} = - \\kappa_{\\parallel} \\, \\mathbf{b} \\, \\mathbf{b} \\cdot \\nabla T - \\kappa_{\\perp} \\, \\left( \\mathbf{I} - \\mathbf{b} \\, \\mathbf{b} \\right) \\cdot \\nabla T$。\n    -   各向异性条件：$\\kappa_{\\parallel} \\gg \\kappa_{\\perp}$。\n    -   能量守恒：$\\nabla \\cdot \\mathbf{q} = 0$（稳态，无源/汇）。\n-   **边界/背景条件**：\n    -   背景温度剖面：$T_0(r) = T_s + G \\, (r - r_s)$。\n    -   背景温度梯度：$G = \\left. \\frac{d T_0}{dr} \\right|_{r_s}$。\n    -   有理面处的温度：$T_s = T_0(r_s)$。\n-   **热力学**：\n    -   压强：$p = n \\, T$。\n    -   密度假设：在 $r = r_s$ 附近的磁通面上，$n$ 近似为常数。\n-   **所需计算**：\n    -   推导磁岛内部的稳态温度分布 $T$。\n    -   计算压强梯度折扣因子：$R = \\frac{ \\left. \\frac{d p}{d r} \\right|_{\\text{with island at } r = r_s} }{ \\left. \\frac{d p}{d r} \\right|_{\\text{no island at } r = r_s} }$。\n\n#### 使用提取的已知条件进行验证\n1.  **科学或事实上的不健全性**：该问题在科学上是健全的。它使用了磁化等离子体中各向异性热输运的标准Braginskii模型和磁岛的标准“常$\\psi$”模型。这些是托卡马克和仿星器物理学（特别是研究撕裂模）的基石模型。\n2.  **不可形式化或不相关**：该问题高度可形式化，并与指定主题*新经典撕裂模模型*直接相关。压强梯度的淬灭是NTM理论的一个关键要素。\n3.  **不完整或矛盾的设置**：问题是自洽的。它提供了控制方程（$\\nabla \\cdot \\mathbf{q} = 0$）、热通量的本构关系（$\\mathbf{q}(T)$）、问题的几何结构（$\\psi(x, \\zeta)$）和边界条件（背景剖面 $T_0(r)$）。没有矛盾之处。\n4.  **不切实际或不可行**：该模型是一个简化模型（平板几何、无流动、常$\\psi$），但它是一个标准且具有物理洞察力的理想化模型，在理论等离子体物理学中被广泛使用。在此理论背景下，它并非物理上不可能或不合理。\n5.  **不适定或结构不良**：问题是适定的。物理条件 $\\kappa_{\\parallel} \\gg \\kappa_{\\perp}$ 为确定磁岛内的温度剖面提供了必要的封闭关系，从而为压强梯度得出了一个唯一且有意义的解。\n6.  **伪深刻、琐碎或同义反复**：该问题是等离子体输运理论中一个标准但非琐碎的练习。它要求将基本原理应用于特定几何形状，并理解其物理含义，如磁通面平均和剖面平坦化。\n7.  **超出科学可验证性**：该模型的预测可以，并且已经被，与更全面的数值模拟和实验观测结果进行比较。它完全在科学可验证的范围内。\n\n#### 结论与行动\n问题有效。我将继续进行详细求解。\n\n### 第2步：求解推导\n\n求解过程分三个阶段：首先，确定磁岛内部的温度剖面；其次，确定相应的压强剖面及其梯度；第三，计算折扣因子 $R$。\n\n**1. 磁岛内的温度分布**\n\n出发点是没有源或汇的稳态能量守恒方程：\n$$\n\\nabla \\cdot \\mathbf{q} = 0\n$$\n热通量 $\\mathbf{q}$ 由各向异性传导定律给出：\n$$\n\\mathbf{q} = - \\kappa_{\\parallel} (\\mathbf{b} \\cdot \\nabla T) \\mathbf{b} - \\kappa_{\\perp} \\nabla_{\\perp} T\n$$\n其中 $\\mathbf{b} = \\mathbf{B}/|\\mathbf{B}|$ 是沿磁场的单位矢量，$\\nabla_{\\perp} T = (\\mathbf{I} - \\mathbf{b}\\mathbf{b}) \\cdot \\nabla T$ 是垂直于磁场的温度梯度分量。\n\n问题陈述，平行热导率远大于垂直热导率，即 $\\kappa_{\\parallel} \\gg \\kappa_{\\perp}$。在稳态下，沿磁力线的任何有限温度梯度 $\\mathbf{b} \\cdot \\nabla T \\neq 0$ 都会驱动巨大的平行热通量 $\\mathbf{q}_{\\parallel} \\propto \\kappa_{\\parallel} (\\mathbf{b} \\cdot \\nabla T)$。如果没有相应的大源和汇来平衡此通量，这样大的梯度是无法维持的。因此，在极限 $\\kappa_{\\parallel} \\to \\infty$ 下，为维持有限的稳态解，平行温度梯度必须消失：\n$$\n\\mathbf{b} \\cdot \\nabla T = 0\n$$\n这个基本结果意味着温度 $T$ 必须沿磁力线保持恒定。在磁岛内部（$\\psi  1$），磁力线位于由 $\\psi = \\text{常数}$ 定义的嵌套闭合磁通面上。由于磁力线在这些表面上通常是各态遍历的（它们密集地覆盖整个表面），因此温度在每个完整的磁通面上必须是恒定的。在数学上，这意味着温度仅成为螺旋磁通函数 $\\psi$ 的函数：\n$$\nT = T(\\psi) \\quad \\text{for } \\psi  1\n$$\n当 $\\mathbf{b} \\cdot \\nabla T = 0$ 时，热通量方程简化为纯粹的垂直输运：$\\mathbf{q} = - \\kappa_{\\perp} \\nabla_{\\perp} T$。因为 $T=T(\\psi)$，我们有 $\\nabla T = \\frac{dT}{d\\psi} \\nabla \\psi$。由于 $\\nabla \\psi$ 根据定义垂直于磁通面（因此也垂直于 $\\mathbf{b}$），我们有 $\\nabla_{\\perp} T = \\nabla T$。因此，\n$$\n\\mathbf{q} = - \\kappa_{\\perp} \\frac{dT}{d\\psi} \\nabla \\psi \\quad \\text{for } \\psi  1\n$$\n将此代入守恒方程得到：\n$$\n\\nabla \\cdot \\left( - \\kappa_{\\perp} \\frac{dT}{d\\psi} \\nabla \\psi \\right) = 0\n$$\n为了求解 $T(\\psi)$ 的函数形式，我们考虑分界线（$\\psi=1$）所包围的体积内没有热源或汇的物理后果。在分界线表面上积分的总热通量必须为零。由平行输运导致的热的有效“短路”得出的最直接物理结论是，整个磁岛内部达到单一温度的平衡状态。温度剖面在整个磁岛内变得完全平坦。\n$$\nT(x, \\zeta) = T_{\\text{flat}} \\quad \\text{for } \\psi(x, \\zeta)  1\n$$\n为了确定这个恒定温度 $T_{\\text{flat}}$ 的值，我们在磁岛内部的温度剖面与外部的背景剖面之间施加连续性条件。磁岛区域以有理面 $r=r_s$（或 $x=0$）为中心。根据对称性，平坦化的温度必须等于该中心位置的背景温度。在 $r=r_s$ 处的背景温度给定为 $T_s$。\n$$\nT_{\\text{flat}} = T_s\n$$\n因此，磁岛内部的稳态温度分布是恒定的，且等于共振面处未受扰动的温度。\n\n**2. 共振面处的压强梯度**\n\n压强由 $p = nT$ 给出。问题陈述密度 $n$ 在磁通面上是常数，因此在磁岛内部 $n = n(\\psi)$。由于整个磁岛内部（$\\psi  1$）的温度是恒定的（$T=T_s$），压强也仅是 $\\psi$ 的函数：\n$$\np(x, \\zeta) = n(\\psi(x, \\zeta)) T_s = p(\\psi(x, \\zeta)) \\quad \\text{for } \\psi  1\n$$\n量 $\\left. \\frac{dp}{dr} \\right|_{\\text{with island at } r=r_s}$ 表示磁岛中心的有效宏观压强梯度。这可以通过首先对压强沿螺旋角 $\\zeta$进行平均，得到一个作为径向坐标 $x=r-r_s$ 函数的平均压强剖面，然后对其求导来获得。\n令 $\\bar{p}(x)$ 为磁通面平均压强：\n$$\n\\bar{p}(x) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} p(\\psi(x,\\zeta)) d\\zeta\n$$\n我们需要计算该函数在 $x=0$ 处的导数：$\\left. \\frac{d\\bar{p}}{dx} \\right|_{x=0}$。\n\n螺旋磁通函数 $\\psi(x, \\zeta) = \\frac{x^2}{2 w^2} + \\cos(\\zeta)$ 的一个关键性质是其关于径向坐标 $x$ 的对称性。它是 $x$ 的一个偶函数：\n$$\n\\psi(-x, \\zeta) = \\frac{(-x)^2}{2 w^2} + \\cos(\\zeta) = \\frac{x^2}{2 w^2} + \\cos(\\zeta) = \\psi(x, \\zeta)\n$$\n由于平均压强 $\\bar{p}(x)$ 仅通过函数 $\\psi(x, \\zeta)$ 依赖于 $x$，$\\psi$ 的这种对称性也赋予了 $\\bar{p}(x)$ 对称性：\n$$\n\\bar{p}(-x) = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} p(\\psi(-x,\\zeta)) d\\zeta = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} p(\\psi(x,\\zeta)) d\\zeta = \\bar{p}(x)\n$$\n平均压强剖面 $\\bar{p}(x)$ 是 $x$ 的一个偶函数。任何可微偶函数的导数是一个奇函数。任何奇函数 $f(x)$ 的一个性质是 $f(0) = 0$。因此，平均压强在 $x=0$ 处的梯度必须为零：\n$$\n\\left. \\frac{d\\bar{p}}{dx} \\right|_{x=0} = 0\n$$\n所以，折扣因子的分子为零：\n$$\n\\left. \\frac{d p}{d r} \\right|_{\\text{with island at } r = r_s} = 0\n$$\n这个结果被称为磁岛对压强梯度的“淬灭”效应。\n\n**3. 计算折扣因子 R**\n\n折扣因子 $R$ 是有磁岛时的压强梯度与无磁岛时的压强梯度之比，两者均在共振面上取值。\n\n如上所述，分子为 $0$。\n\n分母是在没有磁岛的情况下，在 $r=r_s$ 处计算的压强梯度：\n$$\n\\left. \\frac{d p}{d r} \\right|_{\\text{no island at } r = r_s} = \\left. \\frac{d p_0}{d r} \\right|_{r_s}\n$$\n背景压强为 $p_0(r) = n_0(r) T_0(r)$。其梯度为 $\\frac{dp_0}{dr} = n_0 \\frac{dT_0}{dr} + T_0 \\frac{dn_0}{dr}$。在 $r=r_s$ 处：\n$$\n\\left. \\frac{dp_0}{dr} \\right|_{r_s} = n_0(r_s) G + T_s \\left. \\frac{dn_0}{dr} \\right|_{r_s}\n$$\n假设一个典型的具有非零压强梯度（即分母不为零）的等离子体，折扣因子为：\n$$\nR = \\frac{0}{n_0(r_s) G + T_s \\left. \\frac{dn_0}{dr} \\right|_{r_s}} = 0\n$$\n最终结果与背景梯度的具体值无关，只要它们不为零即可。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "预测新经典撕裂模的演化需要一个能捕捉磁岛生长与等离子体剖面之间动态反馈回路的模型。这项高级实践  要求您构建一个求解耦合系统的数值求解器，该系统结合了描述磁岛宽度的修正卢瑟福方程（MRE）和描述温度剖面的输运方程。通过实施有限元方法和隐式-显式（IMEX）时间步进方案，您将处理一个代表现代聚变研究中计算建模的综合性问题，涵盖了从离散化到数值稳定性的完整过程。",
            "id": "4018194",
            "problem": "考虑一个圆形截面的托卡马克，其小半径为 $a$，其中一个新经典撕裂模在一个固定的有理面半径 $r_s \\in (0,a)$ 处演化。该模式的磁岛宽度 $W(t)$ 由简化的修正卢瑟福方程（MRE）控制，背景温度 $T(r,t)$ 在一维径向输运方程下随柱对称性演化。计算在归一化的无量纲单位下进行。\n\n从有理面上的电阻磁流体动力学（MHD）和新经典自举物理出发，你必须求解的简化系统如下。\n\n1. 温度的输运方程：\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\chi(r;W)\\,\\frac{\\partial T}{\\partial r}\\right) + S(r),\n\\quad r \\in (0,a),\\ t0,\n$$\n在 $r=0$ 处具有对称性（零通量）边界条件：$\\frac{\\partial T}{\\partial r}(0,t)=0$，在 $r=a$ 处具有狄利克雷边界条件：$T(a,t)=T_{\\text{edge}}$。扩散系数在磁岛区域内增强，\n$$\n\\chi(r;W) = \\chi_0\\left(1 + A\\exp\\left(-\\frac{(r-r_s)^2}{W^2+\\epsilon}\\right)\\right),\n$$\n加热源为\n$$\nS(r) = S_0\\exp\\left(-\\frac{r^2}{\\lambda_{\\text{heat}}^2}\\right).\n$$\n\n2. 用于磁岛宽度的简化修正卢瑟福方程（MRE）：\n$$\n\\frac{dW}{dt} = c_{\\Delta}\\,\\Delta' \\;-\\; c_{\\eta}\\,W \\;-\\; c_{\\text{pol}}\\,W^3 \\;+\\; c_{\\text{bs}}\\,W\\,G(t),\n$$\n其中 $G(t)=\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=r_s}$ 是有理面上的瞬时温度梯度。常数 $c_{\\Delta}$、$\\Delta'$、$c_{\\eta}$、$c_{\\text{pol}}$ 和 $c_{\\text{bs}}$ 是无量纲且不随时间变化的。\n\n有限元离散化指令：\n- 用 $N$ 个均匀分布的节点离散化径向区间 $[0,a]$，并使用有限元法（FEM）及连续分段线性基函数 $\\{\\phi_i(r)\\}_{i=0}^{N-1}$。\n- 通过将输运方程乘以一个测试函数 $\\varphi$，在 $r\\in[0,a]$ 上积分，并在柱对称性下应用分部积分来导出弱形式。得到的半离散系统必须以质量矩阵 $M$ 和刚度矩阵 $K(W)$ 的形式写出：\n$$\nM\\,\\frac{d\\mathbf{T}}{dt} + K(W)\\,\\mathbf{T} = \\mathbf{F},\n$$\n其中 $\\mathbf{T}$ 是节点温度向量，并且\n$$\nM_{ij} = \\int_{0}^{a} r\\,\\phi_i(r)\\,\\phi_j(r)\\,dr,\\quad\nK_{ij}(W) = \\int_{0}^{a} r\\,\\chi(r;W)\\,\\frac{d\\phi_i}{dr}(r)\\,\\frac{d\\phi_j}{dr}(r)\\,dr,\\quad\nF_i = \\int_{0}^{a} r\\,S(r)\\,\\phi_i(r)\\,dr.\n$$\n- 在每个隐式时间步长中，在（线性）系统中强加本质边界条件 $T(a,t)=T_{\\text{edge}}$。自然地处理 $r=0$ 处的对称性边界条件（它从弱形式中产生）。\n\n时间步进指令：\n- 使用隐式-显式（IMEX）方法，其中输运方程用后向欧拉法（隐式）推进，而MRE用前向欧拉法（显式）推进。在从 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 的一个时间步长中，\n$$\n\\left(M + \\Delta t\\,K(W^n)\\right)\\,\\mathbf{T}^{n+1} = M\\,\\mathbf{T}^{n} + \\Delta t\\,\\mathbf{F},\n$$\n以及\n$$\nW^{n+1} = W^n + \\Delta t\\left(c_{\\Delta}\\,\\Delta' - c_{\\eta}\\,W^n - c_{\\text{pol}}(W^n)^3 + c_{\\text{bs}}\\,W^n\\,G^{n+1}\\right),\n$$\n其中 $G^{n+1}$ 是从有限元解 $\\mathbf{T}^{n+1}$ 中提取的 $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=r_s}$ 的离散近似。\n\n稳定性和收敛性判据：\n- 对于线性扩散，输运方程的后向欧拉步是无条件稳定的。\n- 对于显式MRE步，通过考虑标量线性化来推导线性化局部稳定性条件\n$$\n\\frac{dW}{dt} \\approx \\lambda(W,t)\\,W + b(t),\n$$\n其中雅可比 $\\lambda(W,t)$ 为\n$$\n\\lambda(W,t) = -c_{\\eta} - 3\\,c_{\\text{pol}}\\,W^2 + c_{\\text{bs}}\\,G(t).\n$$\n标量线性模式的前向欧拉法稳定性要求 $\\lambda0$ 和 $\\Delta t \\le -\\frac{2}{\\lambda}$。你的程序必须在每个时间步检查此条件，并报告在整个演化过程中它是否成立。\n- 为评估时间收敛性，用时间步长 $\\Delta t$ 和 $\\Delta t/2$ 分别计算解，直到最终时间 $t_{\\text{final}}$。将误差定义为\n$$\ne = \\max\\left(\\left|W_{\\Delta t}(t_{\\text{final}}) - W_{\\Delta t/2}(t_{\\text{final}})\\right|,\\ \\left\\|\\mathbf{T}_{\\Delta t}(t_{\\text{final}}) - \\mathbf{T}_{\\Delta t/2}(t_{\\text{final}})\\right\\|_{M}\\right),\n$$\n其中质量矩阵加权范数为\n$$\n\\left\\|\\mathbf{v}\\right\\|_{M} = \\sqrt{\\mathbf{v}^{\\top} M \\,\\mathbf{v}}.\n$$\n\n测试套件：\n为以下四组参数集实现你的求解器。所有量均为无量纲。对于每种情况，初始化 $T(r,0)=T_0\\left(1-(r/a)^2\\right)$ 和 $W(0)=W_0$。\n\n- 情况1（基准，预期稳定）：\n  - $a=1.0$, $N=64$, $r_s=0.5$, $\\chi_0=0.5$, $A=3.0$, $\\epsilon=10^{-4}$, $S_0=1.0$, $\\lambda_{\\text{heat}}=0.4$, $T_0=1.0$, $T_{\\text{edge}}=0.0$, $c_{\\Delta}=0.05$, $\\Delta'=-0.3$, $c_{\\eta}=0.5$, $c_{\\text{bs}}=0.8$, $c_{\\text{pol}}=0.1$, $W_0=0.02$, $\\Delta t=0.002$, $t_{\\text{final}}=0.5$。\n- 情况2（接近稳定性阈值）：\n  - $a=1.0$, $N=64$, $r_s=0.5$, $\\chi_0=0.5$, $A=3.0$, $\\epsilon=10^{-4}$, $S_0=1.0$, $\\lambda_{\\text{heat}}=0.4$, $T_0=1.0$, $T_{\\text{edge}}=0.0$, $c_{\\Delta}=0.05$, $\\Delta'=-0.3$, $c_{\\eta}=0.5$, $c_{\\text{bs}}=0.8$, $c_{\\text{pol}}=0.1$, $W_0=0.02$, $\\Delta t=0.01$, $t_{\\text{final}}=0.5$。\n- 情况3（通过大时间步长导致的显式不稳定）：\n  - $a=1.0$, $N=64$, $r_s=0.5$, $\\chi_0=0.5$, $A=3.0$, $\\epsilon=10^{-4}$, $S_0=1.0$, $\\lambda_{\\text{heat}}=0.4$, $T_0=1.0$, $T_{\\text{edge}}=0.0$, $c_{\\Delta}=0.05$, $\\Delta'=-0.3$, $c_{\\eta}=0.5$, $c_{\\text{bs}}=0.8$, $c_{\\text{pol}}=0.1$, $W_0=0.02$, $\\Delta t=0.05$, $t_{\\text{final}}=0.5$。\n- 情况4（粗空间网格，小时间步长）：\n  - $a=1.0$, $N=16$, $r_s=0.5$, $\\chi_0=0.5$, $A=3.0$, $\\epsilon=10^{-4}$, $S_0=1.0$, $\\lambda_{\\text{heat}}=0.4$, $T_0=1.0$, $T_{\\text{edge}}=0.0$, $c_{\\Delta}=0.05$, $\\Delta'=-0.3$, $c_{\\eta}=0.5$, $c_{\\text{bs}}=0.8$, $c_{\\text{pol}}=0.1$, $W_0=0.02$, $\\Delta t=0.001$, $t_{\\text{final}}=0.5$。\n\n要求输出：\n对于每种情况，你的程序必须产生两个值：一个布尔值，指示MRE步的显式稳定性判据在每个时间步是否都得到满足；以及一个浮点数，给出如上定义的收敛误差 $e$。将所有四个情况的结果汇总到一个单行的Python风格列表中，按情况的顺序打印，格式为\n$[\\text{stable}_1,\\ e_1,\\ \\text{stable}_2,\\ e_2,\\ \\text{stable}_3,\\ e_3,\\ \\text{stable}_4,\\ e_4]$。\n所有输出均为无量纲。不应打印任何额外文本。",
            "solution": "所提出的问题是计算聚变科学领域的一项计算练习，具体涉及托卡马克中新经典撕裂模（NTM）的建模。该模型由一个耦合系统组成，该系统包括一个用于热输运的偏微分方程（PDE）和一个用于磁岛宽度的常微分方程（ODE）。该问题具有科学依据、是良定的，并为数值求解提供了一整套参数和指令。该模型基于电阻磁流体动力学（MHD）和新经典理论的既定原理。所规定的数值方法——用于空间离散的有限元法与IMEX时间步进格式相结合——是解决此类问题的标准且合适的方法。因此，该问题被认为是有效的，下面给出完整解法。\n\n该解法通过实现一个基于指定的IMEX（隐式-显式）格式的数值求解器来开发。温度输运方程是一个刚性扩散方程，使用后向欧拉法进行隐式处理，而用于磁岛宽度的修正卢瑟福方程（MRE）则使用类前向欧拉步进行显式推进。\n\n### 1. 空间离散化：用于输运方程的有限元法\n\n径向热输运方程由下式给出：\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\,\\chi(r;W)\\,\\frac{\\partial T}{\\partial r}\\right) + S(r), \\quad r \\in (0,a)\n$$\n为了导出弱形式，我们乘以一个测试函数 $\\varphi(r)$ 并在定义域 $r \\in [0, a]$ 上用柱坐标体积元 $r\\,dr$ 进行积分：\n$$\n\\int_{0}^{a} r\\,\\varphi\\,\\frac{\\partial T}{\\partial t}\\,dr = \\int_{0}^{a} \\varphi\\,\\frac{\\partial}{\\partial r}\\left(r\\,\\chi\\,\\frac{\\partial T}{\\partial r}\\right)\\,dr + \\int_{0}^{a} r\\,\\varphi\\,S(r)\\,dr\n$$\n对扩散项应用分部积分：\n$$\n\\int_{0}^{a} \\varphi\\,\\frac{\\partial}{\\partial r}\\left(r\\,\\chi\\,\\frac{\\partial T}{\\partial r}\\right)\\,dr = \\left[\\varphi\\,r\\,\\chi\\,\\frac{\\partial T}{\\partial r}\\right]_{0}^{a} - \\int_{0}^{a} r\\,\\chi\\,\\frac{\\partial\\varphi}{\\partial r}\\,\\frac{\\partial T}{\\partial r}\\,dr\n$$\n在 $r=0$ 处的边界项因为 $r=0$ 而消失。在 $r=a$ 处，我们将强加狄利克雷边界条件，因此选择测试函数 $\\varphi(a)=0$ 也使此项消失。原点处的对称性条件 $\\frac{\\partial T}{\\partial r}(0,t)=0$ 是此弱形式的自然边界条件，无需显式强制执行。得到的弱形式为：\n$$\n\\int_{0}^{a} r\\,\\varphi\\,\\frac{\\partial T}{\\partial t}\\,dr + \\int_{0}^{a} r\\,\\chi\\,\\frac{\\partial\\varphi}{\\partial r}\\,\\frac{\\partial T}{\\partial r}\\,dr = \\int_{0}^{a} r\\,\\varphi\\,S(r)\\,dr\n$$\n我们用 $N$ 个均匀分布的节点 $r_i = i\\cdot\\Delta r$（其中 $i=0,\\dots,N-1$，$\\Delta r = a/(N-1)$）来离散化径向域 $[0,a]$。我们使用连续分段线性（帽状）基函数 $\\{\\phi_i(r)\\}_{i=0}^{N-1}$ 来近似温度分布：\n$$\nT(r,t) \\approx T_h(r,t) = \\sum_{j=0}^{N-1} T_j(t)\\,\\phi_j(r)\n$$\n其中 $T_j(t)$ 是节点 $j$ 处的温度。选择测试函数为基函数本身（伽辽金法），$\\varphi(r) = \\phi_i(r)$，我们得到常微分方程组的半离散系统：\n$$\nM\\,\\frac{d\\mathbf{T}}{dt} + K(W)\\,\\mathbf{T} = \\mathbf{F}\n$$\n这里，$\\mathbf{T}$ 是节点温度向量 $[T_0, \\dots, T_{N-1}]^\\top$，矩阵定义如下：\n$$\nM_{ij} = \\int_{0}^{a} r\\,\\phi_i(r)\\,\\phi_j(r)\\,dr\n$$\n$$\nK_{ij}(W) = \\int_{0}^{a} r\\,\\chi(r;W)\\,\\frac{d\\phi_i}{dr}(r)\\,\\frac{d\\phi_j}{dr}(r)\\,dr\n$$\n$$\nF_i = \\int_{0}^{a} r\\,S(r)\\,\\phi_i(r)\\,dr\n$$\n由于基函数具有局部支集（即 $\\phi_i$ 仅在 $[r_{i-1}, r_{i+1}]$ 上非零），质量矩阵 $M$ 和刚度矩阵 $K$ 是三对角的。这些矩阵和向量元素的积分通过在每个元素 $[r_k, r_{k+1}]$ 上使用两点高斯-勒让德求积进行数值计算，以精确处理由 $\\chi(r;W)$ 和 $S(r)$ 产生的非多项式被积函数。\n\n### 2. 时间离散化：IMEX格式\n\n耦合系统使用IMEX格式从 $t^n$ 到 $t^{n+1}=t^n+\\Delta t$ 进行时间演化。\n\n**温度的隐式更新：** 输运方程使用后向欧拉法进行离散化。引起刚性的扩散项被隐式处理。扩散系数 $\\chi$ 依赖于磁岛宽度 $W$，该宽度在时间步开始时，即 $W^n$ 处进行评估。\n$$\nM\\,\\frac{\\mathbf{T}^{n+1} - \\mathbf{T}^{n}}{\\Delta t} + K(W^n)\\,\\mathbf{T}^{n+1} = \\mathbf{F}\n$$\n重新整理得到需求解 $\\mathbf{T}^{n+1}$ 的线性系统：\n$$\n\\left(M + \\Delta t\\,K(W^n)\\right)\\,\\mathbf{T}^{n+1} = M\\,\\mathbf{T}^{n} + \\Delta t\\,\\mathbf{F}\n$$\n狄利克雷边界条件 $T(a,t)=T_{\\text{edge}}$ 被强加。这意味着设置 $T_{N-1}^{n+1} = T_{\\text{edge}}$ 并为剩余的 $N-1$ 个未知温度修改线性系统。这通过调整右端向量以适应边界上的已知值，然后求解一个简化的 $(N-1) \\times (N-1)$ 三对角系统来完成。\n\n**磁岛宽度的显式更新：** MRE使用类前向欧拉步进行推进。\n$$\n\\frac{dW}{dt} = c_{\\Delta}\\,\\Delta' \\;-\\; c_{\\eta}\\,W \\;-\\; c_{\\text{pol}}\\,W^3 \\;+\\; c_{\\text{bs}}\\,W\\,G(t)\n$$\n离散更新规则是：\n$$\nW^{n+1} = W^n + \\Delta t\\left(c_{\\Delta}\\,\\Delta' - c_{\\eta}\\,W^n - c_{\\text{pol}}(W^n)^3 + c_{\\text{bs}}\\,W^n\\,G^{n+1}\\right)\n$$\n关键是，此更新使用了从新温度分布 $\\mathbf{T}^{n+1}$ 评估的温度梯度 $G^{n+1} = \\left.\\frac{\\partial T}{\\partial r}\\right|_{r=r_s}$。这使得整个格式是半隐式的。梯度从有限元解中近似得到。如果 $r_s$ 落在元素 $[r_k, r_{k+1}]$ 内，梯度是恒定的，由 $G^{n+1} = (T_{k+1}^{n+1} - T_k^{n+1}) / \\Delta r$ 给出。\n\n### 3. 数值稳定性与收敛性分析\n\n**MRE 稳定性：** 对 $W$ 的显式更新的稳定性通过线性化MRE来评估。问题将局部雅可比定义为 $\\lambda(W,t) = -c_{\\eta} - 3\\,c_{\\text{pol}}\\,W^2 + c_{\\text{bs}}\\,G(t)$。对于标准的前向欧拉格式，稳定性要求放大因子 $|1+\\Delta t \\lambda|$ 小于或等于 $1$。对于实负数 $\\lambda$，这简化为两个条件：$\\lambda  0$ 和 $\\Delta t \\le -2/\\lambda$。此条件在每个时间步 $n$ 开始时，使用当前的状态变量 $W^n$ 和 $G^n$ 进行检查。一个全局标志跟踪此条件在给定 $\\Delta t$ 的整个模拟过程中是否都得到满足。\n\n**时间收敛性：** 为了评估时间步进格式的准确性和收敛性，每种情况都模拟两次：一次使用指定的时间步长 $\\Delta t$，第二次使用减半的时间步长 $\\Delta t/2$。然后在最终时间 $t_{\\text{final}}$ 通过比较后验解来计算误差 $e$：\n$$\ne = \\max\\left(\\left|W_{\\Delta t}(t_{\\text{final}}) - W_{\\Delta t/2}(t_{\\text{final}})\\right|,\\ \\left\\|\\mathbf{T}_{\\Delta t}(t_{\\text{final}}) - \\mathbf{T}_{\\Delta t/2}(t_{\\text{final}})\\right\\|_{M}\\right)\n$$\n温度向量差的范数是由质量矩阵诱导的能量范数，$\\left\\|\\mathbf{v}\\right\\|_{M} = \\sqrt{\\mathbf{v}^{\\top} M \\,\\mathbf{v}}$，这是此有限元公式的自然范数。\n\n该实现封装了此逻辑，遍历所提供的测试用例，为每个用例执行双重模拟，并计算所需的稳定性和误差度量。",
            "answer": "[True,0.002135,True,0.01574,False,22.45,True,0.00488]"
        }
    ]
}