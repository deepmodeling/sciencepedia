{
    "hands_on_practices": [
        {
            "introduction": "Before we can analyze the dynamic effects of error fields, we must first understand where they interact with the plasma. This interaction is not uniform; it is sharply peaked at \"resonant surfaces\" where the pitch of the error field's helical structure matches the pitch of the equilibrium magnetic field lines. This exercise  provides a first-principles derivation of the locations of these resonant surfaces for a simplified, but instructive, plasma equilibrium. Mastering this calculation is fundamental to identifying which error field harmonics are most dangerous for a given plasma configuration.",
            "id": "3976508",
            "problem": "Consider a large-aspect-ratio toroidal plasma approximated by a straight cylindrical equilibrium of minor radius $a$, in which the safety factor profile is linear, $q(r)=q_0+q_1 r$, with $q_0$ and $q_1$ positive constants. A static magnetic error field can be decomposed into Fourier harmonics with poloidal mode number $m \\in \\mathbb{Z}^{+}$ and toroidal mode number $n \\in \\mathbb{Z}^{+}$ (the \"spectrum\" of $n$ indicates that several distinct $n$ values may be present). In an ideal Magnetohydrodynamics (MHD) description, a helical perturbation labeled by $(m,n)$ resonates at radii $r=r_s$ where parallel phase stationarity along equilibrium magnetic field lines is satisfied.\n\nStarting from first principles, use the field-line phase condition for resonance and the definition of the safety factor $q(r)$ based on the ratio of toroidal to poloidal field-line advances to derive the closed-form expression for the set of resonant radii $r_s$ for a given $n$ and all integers $m$ that satisfy $0 \\le r_s \\le a$. Then, for a fixed $n$, estimate the radial separation $\\Delta r$ between adjacent resonant surfaces corresponding to consecutive poloidal mode numbers $m$ and $m+1$.\n\nYour derivation must begin from fundamental definitions of $q(r)$ and the resonance condition in terms of field-line phase advance, without invoking any pre-derived shortcuts. Express your final results as analytic expressions in terms of $q_0$, $q_1$, $m$, $n$, and (where needed to define the allowable set) $a$. Use meters for radii and separations. No numerical evaluation is required, and no rounding is needed. The final answer must be a single closed-form expression or a single row matrix of expressions.",
            "solution": "The objective is to derive the locations of resonant magnetic surfaces, $r_s$, and their radial separation, $\\Delta r$, within a cylindrical plasma model. The derivation must originate from first principles as specified: the definition of the safety factor, $q(r)$, and the condition for phase stationarity of a helical perturbation.\n\nFirst, we establish the fundamental concepts in a cylindrical coordinate system $(r, \\theta, z)$, where $r$ is the minor radius, $\\theta$ is the poloidal angle, and $z$ corresponds to the toroidal direction. The toroidal angle is $\\phi = z/R_0$, where $R_0$ is the major radius of the torus, which is taken to be large. The equilibrium magnetic field in a straight cylinder approximation has no radial component, $\\vec{B} = B_\\theta(r) \\hat{e}_\\theta + B_z(r) \\hat{e}_z$.\n\nThe safety factor, $q(r)$, characterizes the pitch of the magnetic field lines. It is defined as the rate of change of toroidal angle $\\phi$ with respect to poloidal angle $\\theta$ as one follows a field line. The trajectory of a field line is given by the equation $\\frac{r d\\theta}{B_\\theta} = \\frac{dz}{B_z}$. Using $\\phi = z/R_0$, we have $dz = R_0 d\\phi$. Substituting this into the field line equation gives $\\frac{r d\\theta}{B_\\theta} = \\frac{R_0 d\\phi}{B_z}$. Rearranging for the rate of change yields:\n$$\n\\frac{d\\phi}{d\\theta} = \\frac{r B_z}{R_0 B_\\theta}\n$$\nBy definition, this ratio is the safety factor $q(r)$:\n$$\nq(r) = \\frac{r B_z(r)}{R_0 B_\\theta(r)}\n$$\nThis definition quantifies the field line advance: for every full poloidal transit ($\\Delta\\theta=2\\pi$), the toroidal advance is $\\Delta\\phi = 2\\pi q(r)$.\n\nNext, we formalize the resonance condition. A static magnetic error field perturbation can be described as a sum of Fourier harmonics. A single harmonic with poloidal mode number $m \\in \\mathbb{Z}^+$ and toroidal mode number $n \\in \\mathbb{Z}^+$ has a helical structure. Its phase, $\\alpha$, is constant on helical paths defined by $m\\theta - n\\phi = \\text{constant}$. In the cylindrical system, this phase is $\\alpha(r, \\theta, z) = m\\theta - n(z/R_0)$.\n\nResonance occurs at radii $r_s$ where the helical perturbation has a constant phase along the equilibrium magnetic field lines. This condition of \"parallel phase stationarity\" is expressed mathematically as the directional derivative of the phase along the magnetic field being zero:\n$$\n\\vec{B} \\cdot \\nabla \\alpha = 0\n$$\nThe gradient of the phase $\\alpha$ in cylindrical coordinates is:\n$$\n\\nabla \\alpha = \\frac{\\partial \\alpha}{\\partial r} \\hat{e}_r + \\frac{1}{r} \\frac{\\partial \\alpha}{\\partial \\theta} \\hat{e}_\\theta + \\frac{\\partial \\alpha}{\\partial z} \\hat{e}_z = 0 \\cdot \\hat{e}_r + \\frac{m}{r} \\hat{e}_\\theta - \\frac{n}{R_0} \\hat{e}_z\n$$\nNow, we take the dot product with the equilibrium magnetic field $\\vec{B} = B_\\theta \\hat{e}_\\theta + B_z \\hat{e}_z$:\n$$\n\\vec{B} \\cdot \\nabla \\alpha = (B_\\theta \\hat{e}_\\theta + B_z \\hat{e}_z) \\cdot \\left(\\frac{m}{r} \\hat{e}_\\theta - \\frac{n}{R_0} \\hat{e}_z\\right) = \\frac{m B_\\theta}{r} - \\frac{n B_z}{R_0}\n$$\nSetting this to zero for resonance at a radius $r=r_s$:\n$$\n\\frac{m B_\\theta(r_s)}{r_s} - \\frac{n B_z(r_s)}{R_0} = 0\n$$\nRearranging this equation gives:\n$$\n\\frac{m}{n} = \\frac{r_s B_z(r_s)}{R_0 B_\\theta(r_s)}\n$$\nComparing this with the definition of the safety factor, we arrive at the fundamental resonance condition:\n$$\nq(r_s) = \\frac{m}{n}\n$$\n\nNow we can use this condition to find the resonant radii $r_s$. The problem specifies a linear safety factor profile:\n$$\nq(r) = q_0 + q_1 r\n$$\nwhere $q_0$ and $q_1$ are positive constants. Substituting this into the resonance condition:\n$$\nq_0 + q_1 r_s = \\frac{m}{n}\n$$\nWe solve for $r_s$:\n$$\nq_1 r_s = \\frac{m}{n} - q_0 = \\frac{m - nq_0}{n}\n$$\n$$\nr_s = \\frac{m - nq_0}{n q_1}\n$$\nThis is the closed-form expression for the resonant radius for a given pair of mode numbers $(m,n)$. These resonant surfaces are physically located within the plasma, which has a minor radius $a$. Therefore, we must enforce the condition $0 \\le r_s \\le a$.\n\nThe condition $r_s \\ge 0$ implies $\\frac{m - nq_0}{nq_1} \\ge 0$. Since $n \\in \\mathbb{Z}^{+}$, $q_1 > 0$, the denominator $nq_1$ is positive. Thus, we require $m - nq_0 \\ge 0$, or $m \\ge nq_0$.\nThe condition $r_s \\le a$ implies $\\frac{m - nq_0}{nq_1} \\le a$. This leads to $m - nq_0 \\le anq_1$, or $m \\le nq_0 + anq_1$.\nCombining these, for a given $n$, the poloidal mode numbers $m$ that correspond to resonant surfaces inside the plasma are integers satisfying $nq_0 \\le m \\le n(q_0 + q_1 a)$.\n\nThe second task is to estimate the radial separation, $\\Delta r$, between adjacent resonant surfaces. These correspond to a fixed toroidal mode number $n$ and consecutive poloidal mode numbers, $m$ and $m+1$. Let $r_s(m)$ denote the resonant radius for mode number $m$.\n$$\nr_s(m) = \\frac{m - nq_0}{n q_1}\n$$\nThe radius for the next mode, $m+1$, is:\n$$\nr_s(m+1) = \\frac{(m+1) - nq_0}{n q_1}\n$$\nThe separation $\\Delta r$ is the difference between these two radii:\n$$\n\\Delta r = r_s(m+1) - r_s(m) = \\frac{(m+1) - nq_0}{n q_1} - \\frac{m - nq_0}{n q_1}\n$$\n$$\n\\Delta r = \\frac{(m+1 - nq_0) - (m - nq_0)}{n q_1} = \\frac{1}{n q_1}\n$$\nThis result is an exact separation, not an estimate, due to the assumption of a linear $q(r)$ profile. For a general profile $q(r)$, the separation can be approximated as $\\Delta r \\approx \\frac{\\Delta m}{n |q'(r_s)|}$. With $\\Delta m = 1$ and $q'(r) = q_1$ (a constant), our exact result is recovered. This constant separation indicates that for a linear $q$ profile, the resonant surfaces are equally spaced.\n\nThe two required results are the expression for the resonant radii, $r_s$, and their separation, $\\Delta r$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{m - nq_0}{n q_1} & \\frac{1}{n q_1}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Once a resonant error field penetrates the plasma, it can exert an electromagnetic torque that opposes the plasma's natural rotation. This braking effect is a competition between the error field torque and the plasma's own inertia and viscous damping. The torque itself is non-linear, as a rapidly rotating plasma can partially \"shield\" itself from the external field, reducing the torque's magnitude. In this practice , you will implement a computational model to quantify this rotation slowdown and gain hands-on experience in modeling plasma dynamics.",
            "id": "3976478",
            "problem": "Consider a single-mode toroidal plasma in a toroidal confinement device subject to a static error field. The evolution of the toroidal rotation angular frequency is modeled by a one-dimensional angular momentum balance with an inertia, a neoclassical toroidal viscosity drag, and a nonlinear electromagnetic torque due to the error field. The governing equation, formulated from Newton's second law for rotation, is\n$$ I \\, \\frac{d\\Omega}{dt} = - \\Gamma \\, \\Omega - T_{\\mathrm{EF}}(\\Omega), $$\nwhere $I$ is the effective moment of inertia, $\\Omega$ is the toroidal rotation angular frequency, $\\Gamma$ is the linear drag coefficient due to Neoclassical Toroidal Viscosity (NTV), and $T_{\\mathrm{EF}}(\\Omega)$ is the nonlinear error-field torque. The error-field torque is approximated by a shielding-limited response,\n$$ T_{\\mathrm{EF}}(\\Omega) = \\alpha \\, b^2 \\, \\frac{1}{1 + \\left( \\frac{\\Omega}{\\Omega_c} \\right)^2 }, $$\nwhere $b$ is the vacuum radial error field amplitude at the resonant surface, $\\alpha$ is a torque proportionality constant capturing geometric and mode-response factors, and $\\Omega_c$ is a characteristic rotation frequency marking the onset of magnetic shielding.\n\nDefine $\\nu = \\Gamma/I$ and $\\tau = \\alpha b^2 / I$. The evolution equation can be written as\n$$ \\frac{d\\Omega}{dt} = - \\nu \\, \\Omega - \\frac{\\tau}{1 + \\left( \\frac{\\Omega}{\\Omega_c} \\right)^2 }. $$\nFor an initial rotation $\\Omega_0$ at time $t=0$, define the slowdown timescale $t_s$ as the first time at which the rotation reaches $\\Omega(t_s) = f \\, \\Omega_0$ with $0 < f < 1$. In this problem, take $f = 1/2$, so the target rotation is $\\Omega_f = \\frac{1}{2} \\Omega_0$. The slowdown time $t_s$ can be expressed by separation of variables as the integral\n$$ t_s(\\Omega_0; I, \\Gamma, \\alpha, b, \\Omega_c) = \\int_{\\Omega_f}^{\\Omega_0} \\frac{d\\Omega}{\\nu \\, \\Omega + \\dfrac{\\tau}{1 + \\left( \\dfrac{\\Omega}{\\Omega_c} \\right)^2 } }. $$\n\nYour task is to implement a program that, for the specified parameter sets, computes $t_s$ by numerically evaluating the integral above, and compares the model-predicted slowdown times to provided experimental observations to test model fidelity.\n\nAll physical quantities must be treated with the following units:\n- $I$ in $\\mathrm{kg \\cdot m^2}$,\n- $\\Gamma$ in $\\mathrm{N \\cdot m \\cdot s}$,\n- $\\alpha$ in $\\mathrm{N \\cdot m \\cdot T^{-2}}$,\n- $b$ in $\\mathrm{T}$,\n- $\\Omega_0$ and $\\Omega_c$ in $\\mathrm{rad/s}$,\n- All times $t$ in $\\mathrm{s}$.\n\nAngles and angular frequencies must be handled in radians.\n\nImplement the calculation for the following test suite. In each case, $I = 1.0 \\times 10^6 \\, \\mathrm{kg \\cdot m^2}$, $\\alpha = 1.0 \\times 10^{16} \\, \\mathrm{N \\cdot m \\cdot T^{-2}}$, and $\\Omega_c = 2000 \\, \\mathrm{rad/s}$.\n\nTest cases:\n1. General case with moderate error field and moderate drag:\n   - $\\Omega_0 = 2000 \\, \\mathrm{rad/s}$,\n   - $b = 1.0 \\times 10^{-4} \\, \\mathrm{T}$,\n   - $\\Gamma = 1.0 \\times 10^5 \\, \\mathrm{N \\cdot m \\cdot s}$,\n   - Experimental slowdown time $t_{\\mathrm{obs}} = 5.0 \\, \\mathrm{s}$.\n2. Viscous-dominated limit with very small error field:\n   - $\\Omega_0 = 2000 \\, \\mathrm{rad/s}$,\n   - $b = 1.0 \\times 10^{-7} \\, \\mathrm{T}$,\n   - $\\Gamma = 1.0 \\times 10^5 \\, \\mathrm{N \\cdot m \\cdot s}$,\n   - Experimental slowdown time $t_{\\mathrm{obs}} = 6.95 \\, \\mathrm{s}$.\n3. Strong-torque case with larger error field:\n   - $\\Omega_0 = 2000 \\, \\mathrm{rad/s}$,\n   - $b = 3.0 \\times 10^{-4} \\, \\mathrm{T}$,\n   - $\\Gamma = 1.0 \\times 10^5 \\, \\mathrm{N \\cdot m \\cdot s}$,\n   - Experimental slowdown time $t_{\\mathrm{obs}} = 1.6 \\, \\mathrm{s}$.\n4. High initial rotation with shielding suppression:\n   - $\\Omega_0 = 10000 \\, \\mathrm{rad/s}$,\n   - $b = 3.0 \\times 10^{-4} \\, \\mathrm{T}$,\n   - $\\Gamma = 1.0 \\times 10^5 \\, \\mathrm{N \\cdot m \\cdot s}$,\n   - Experimental slowdown time $t_{\\mathrm{obs}} = 5.2 \\, \\mathrm{s}$.\n\nFor each test case, compute the predicted $t_s$ and decide whether the model fidelity is acceptable by checking if the absolute fractional deviation from the observation,\n$$ \\delta = \\left| \\frac{t_s - t_{\\mathrm{obs}}}{t_{\\mathrm{obs}}} \\right|, $$\nis less than or equal to the threshold $0.25$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order for each test case, first the predicted slowdown time $t_s$ in $\\mathrm{s}$ rounded to three decimal places, followed by a boolean indicating whether the fidelity criterion $\\delta \\le 0.25$ is satisfied. Thus, the final output must be of the form\n$$ [t_{s,1}, \\mathrm{ok}_1, t_{s,2}, \\mathrm{ok}_2, t_{s,3}, \\mathrm{ok}_3, t_{s,4}, \\mathrm{ok}_4], $$\nwith $t_{s,i}$ rounded to three decimal places and $\\mathrm{ok}_i$ equal to either $\\mathrm{True}$ or $\\mathrm{False}$.",
            "solution": "The problem requires the calculation of the toroidal rotation slowdown time, $t_s$, for a single-mode plasma in a toroidal device, based on a provided model for angular momentum balance. This calculation will be performed for four distinct test cases, and the results will be compared against experimental observations to assess the model's fidelity.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe governing differential equation for the toroidal rotation angular frequency $\\Omega$ is:\n$$ I \\, \\frac{d\\Omega}{dt} = - \\Gamma \\, \\Omega - T_{\\mathrm{EF}}(\\Omega) $$\nwhere the error-field torque $T_{\\mathrm{EF}}(\\Omega)$ is given by:\n$$ T_{\\mathrm{EF}}(\\Omega) = \\alpha \\, b^2 \\, \\frac{1}{1 + \\left( \\frac{\\Omega}{\\Omega_c} \\right)^2 } $$\nThe normalized form of the evolution equation is:\n$$ \\frac{d\\Omega}{dt} = - \\nu \\, \\Omega - \\frac{\\tau}{1 + \\left( \\frac{\\Omega}{\\Omega_c} \\right)^2 } $$\nwith $\\nu = \\Gamma/I$ and $\\tau = \\alpha b^2 / I$.\n\nThe slowdown timescale $t_s$ is the time for the rotation to decrease from an initial value $\\Omega_0$ to a final value $\\Omega_f = f \\Omega_0$. For this problem, $f = 1/2$. The expression for $t_s$ is given by the integral:\n$$ t_s = \\int_{\\Omega_f}^{\\Omega_0} \\frac{d\\Omega}{\\nu \\, \\Omega + \\dfrac{\\tau}{1 + \\left( \\dfrac{\\Omega}{\\Omega_c} \\right)^2 } } $$\n\nFixed parameters:\n- Moment of inertia, $I = 1.0 \\times 10^6 \\, \\mathrm{kg \\cdot m^2}$\n- Torque proportionality constant, $\\alpha = 1.0 \\times 10^{16} \\, \\mathrm{N \\cdot m \\cdot T^{-2}}$\n- Characteristic rotation frequency, $\\Omega_c = 2000 \\, \\mathrm{rad/s}$\n\nTest cases (parameters $\\Omega_0$, $b$, $\\Gamma$, $t_{\\mathrm{obs}}$):\n1.  $\\Omega_0 = 2000 \\, \\mathrm{rad/s}$, $b = 1.0 \\times 10^{-4} \\, \\mathrm{T}$, $\\Gamma = 1.0 \\times 10^5 \\, \\mathrm{N \\cdot m \\cdot s}$, $t_{\\mathrm{obs}} = 5.0 \\, \\mathrm{s}$.\n2.  $\\Omega_0 = 2000 \\, \\mathrm{rad/s}$, $b = 1.0 \\times 10^{-7} \\, \\mathrm{T}$, $\\Gamma = 1.0 \\times 10^5 \\, \\mathrm{N \\cdot m \\cdot s}$, $t_{\\mathrm{obs}} = 6.95 \\, \\mathrm{s}$.\n3.  $\\Omega_0 = 2000 \\, \\mathrm{rad/s}$, $b = 3.0 \\times 10^{-4} \\, \\mathrm{T}$, $\\Gamma = 1.0 \\times 10^5 \\, \\mathrm{N \\cdot m \\cdot s}$, $t_{\\mathrm{obs}} = 1.6 \\, \\mathrm{s}$.\n4.  $\\Omega_0 = 10000 \\, \\mathrm{rad/s}$, $b = 3.0 \\times 10^{-4} \\, \\mathrm{T}$, $\\Gamma = 1.0 \\times 10^5 \\, \\mathrm{N \\cdot m \\cdot s}$, $t_{\\mathrm{obs}} = 5.2 \\, \\mathrm{s}$.\n\nFidelity criterion: The model is acceptable if the absolute fractional deviation, $\\delta = \\left| (t_s - t_{\\mathrm{obs}})/t_{\\mathrm{obs}} \\right|$, is less than or equal to $0.25$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is subjected to a rigorous validation procedure.\n-   **Scientifically Grounded**: The model is based on Newton's second law for rotation ($I \\dot{\\Omega} = \\sum T$) applied to a plasma. The torque terms—a linear drag representing Neoclassical Toroidal Viscosity (NTV) and a nonlinear torque from an external error field with a shielding-limited response—are standard, simplified models used in computational fusion science. The physics is sound and well-established within its domain.\n-   **Well-Posed**: The problem requires the evaluation of a definite integral. The integrand, $g(\\Omega) = 1 / (\\nu \\Omega + \\tau / (1 + (\\Omega/\\Omega_c)^2))$, is a continuous and positive function over the integration interval $[\\Omega_f, \\Omega_0]$, where $\\Omega_0 > 0$. All parameters ($\\nu$, $\\tau$, $\\Omega_c$) are positive constants. The denominator is therefore never zero, ensuring the integral is well-defined and has a unique, finite value.\n-   **Objective**: The problem is stated using precise mathematical formalism and asks for a quantitative calculation and comparison. It is free from subjective language.\n-   **Completeness and Consistency**: All required parameters ($I, \\alpha, \\Omega_c$) and case-specific data ($\\Omega_0, b, \\Gamma, t_{\\mathrm{obs}}$) are provided. The definitions and units are explicit and dimensionally consistent, as verified by dimensional analysis of the governing equation.\n-   **Realism**: The parameter values are physically plausible for a large tokamak experiment.\n-   **Non-Triviality**: The problem requires numerical evaluation of a non-trivial integral, which cannot be solved by simple inspection.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. We may proceed with the solution.\n\n### Solution\n\nThe solution requires the numerical computation of a definite integral for each of the four test cases. The core of the problem lies in evaluating the slowdown time $t_s$ from the provided integral expression.\n\nThe governing equation for the plasma's angular frequency $\\Omega$ is:\n$$ \\frac{d\\Omega}{dt} = -\\frac{\\Gamma}{I} \\Omega - \\frac{\\alpha b^2}{I} \\frac{1}{1 + (\\Omega/\\Omega_c)^2} $$\nLet us define the normalized drag coefficient $\\nu = \\Gamma/I$ and the normalized torque amplitude $\\tau = \\alpha b^2 / I$. The equation becomes:\n$$ \\frac{d\\Omega}{dt} = -\\left( \\nu \\Omega + \\frac{\\tau}{1 + (\\Omega/\\Omega_c)^2} \\right) $$\nTo find the time $t_s$ it takes for the rotation to slow from $\\Omega_0$ to $\\Omega_f = \\Omega_0/2$, we separate variables and integrate:\n$$ dt = -\\frac{d\\Omega}{\\nu \\Omega + \\frac{\\tau}{1 + (\\Omega/\\Omega_c)^2}} $$\nIntegrating both sides, the left from $t=0$ to $t=t_s$ and the right from $\\Omega=\\Omega_0$ to $\\Omega=\\Omega_f$, we get:\n$$ t_s = \\int_{0}^{t_s} dt = \\int_{\\Omega_0}^{\\Omega_f} \\frac{-d\\Omega}{\\nu \\Omega + \\frac{\\tau}{1 + (\\Omega/\\Omega_c)^2}} $$\nBy reversing the limits of integration, we absorb the negative sign, yielding the expression given in the problem statement:\n$$ t_s = \\int_{\\Omega_f}^{\\Omega_0} \\frac{d\\Omega}{\\nu \\Omega + \\frac{\\tau}{1 + (\\Omega/\\Omega_c)^2}} $$\nThe task is to numerically evaluate this integral for each set of parameters. We will use a standard numerical quadrature algorithm for this purpose. For each case, the procedure is as follows:\n\n1.  Identify the parameters for the specific test case: $\\Omega_0$, $b$, and $\\Gamma$. The global parameters are $I = 1.0 \\times 10^6 \\, \\mathrm{kg \\cdot m^2}$, $\\alpha = 1.0 \\times 10^{16} \\, \\mathrm{N \\cdot m \\cdot T^{-2}}$, and $\\Omega_c = 2000 \\, \\mathrm{rad/s}$.\n2.  Calculate the derived parameters $\\nu = \\Gamma/I$ and $\\tau = \\alpha b^2/I$.\n3.  Define the integrand function:\n    $$ g(\\Omega) = \\frac{1}{\\nu \\Omega + \\frac{\\tau}{1 + (\\Omega/\\Omega_c)^2}} $$\n4.  Set the integration limits: the lower limit is $\\Omega_f = \\Omega_0/2$ and the upper limit is $\\Omega_0$.\n5.  Compute the integral $t_s = \\int_{\\Omega_0/2}^{\\Omega_0} g(\\Omega) d\\Omega$ using a numerical integration routine.\n6.  Retrieve the observed slowdown time $t_{\\mathrm{obs}}$ for the case.\n7.  Calculate the absolute fractional deviation $\\delta = |(t_s - t_{\\mathrm{obs}}) / t_{\\mathrm{obs}}|$.\n8.  Determine if the model fidelity is acceptable by checking if $\\delta \\le 0.25$.\n9.  Store the calculated $t_s$ (rounded to three decimal places) and the boolean fidelity result.\n\nThis process is repeated for all four test cases.\n\n**Case 1: General case**\n- $\\Omega_0 = 2000$, $b = 1.0 \\times 10^{-4}$, $\\Gamma = 1.0 \\times 10^5$, $t_{\\mathrm{obs}} = 5.0$\n- $\\nu = 10^5 / 10^6 = 0.1 \\, \\mathrm{s^{-1}}$\n- $\\tau = 10^{16} (10^{-4})^2 / 10^6 = 100 \\, \\mathrm{s^{-2}}$\n- Integrate from $\\Omega_f = 1000$ to $\\Omega_0 = 2000$.\n\n**Case 2: Viscous-dominated limit**\n- $\\Omega_0 = 2000$, $b = 1.0 \\times 10^{-7}$, $\\Gamma = 1.0 \\times 10^5$, $t_{\\mathrm{obs}} = 6.95$\n- $\\nu = 0.1 \\, \\mathrm{s^{-1}}$\n- $\\tau = 10^{16} (10^{-7})^2 / 10^6 = 10^{-4} \\, \\mathrm{s^{-2}}$ (a very small value)\n- Integrate from $\\Omega_f = 1000$ to $\\Omega_0 = 2000$. In this limit, the equation approximates $d\\Omega/dt \\approx -\\nu\\Omega$, which gives $t_s = \\ln(2)/\\nu \\approx 6.931 \\, \\mathrm{s}$.\n\n**Case 3: Strong-torque case**\n- $\\Omega_0 = 2000$, $b = 3.0 \\times 10^{-4}$, $\\Gamma = 1.0 \\times 10^5$, $t_{\\mathrm{obs}} = 1.6$\n- $\\nu = 0.1 \\, \\mathrm{s^{-1}}$\n- $\\tau = 10^{16} (3 \\times 10^{-4})^2 / 10^6 = 900 \\, \\mathrm{s^{-2}}$\n- Integrate from $\\Omega_f = 1000$ to $\\Omega_0 = 2000$.\n\n**Case 4: High initial rotation**\n- $\\Omega_0 = 10000$, $b = 3.0 \\times 10^{-4}$, $\\Gamma = 1.0 \\times 10^5$, $t_{\\mathrm{obs}} = 5.2$\n- $\\nu = 0.1 \\, \\mathrm{s^{-1}}$\n- $\\tau = 900 \\, \\mathrm{s^{-2}}$\n- Integrate from $\\Omega_f = 5000$ to $\\Omega_0 = 10000$. Here, $\\Omega \\gg \\Omega_c$, so the error-field torque is suppressed by the $(\\Omega/\\Omega_c)^2$ term, a phenomenon known as shielding.\n\nThe implementation will utilize the `scipy.integrate.quad` function to perform the numerical integration with high precision.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the plasma rotation slowdown time based on a 1D angular momentum\n    balance model and compares it to experimental data.\n    \"\"\"\n    # Define fixed physical parameters\n    I = 1.0e6  # kg * m^2\n    alpha = 1.0e16  # N * m * T^-2\n    Omega_c = 2000  # rad/s\n\n    # Define the test suite\n    test_cases = [\n        {\n            \"name\": \"General case\",\n            \"Omega_0\": 2000,  # rad/s\n            \"b\": 1.0e-4,  # T\n            \"Gamma\": 1.0e5,  # N * m * s\n            \"t_obs\": 5.0,  # s\n        },\n        {\n            \"name\": \"Viscous-dominated limit\",\n            \"Omega_0\": 2000,  # rad/s\n            \"b\": 1.0e-7,  # T\n            \"Gamma\": 1.0e5,  # N * m * s\n            \"t_obs\": 6.95,  # s\n        },\n        {\n            \"name\": \"Strong-torque case\",\n            \"Omega_0\": 2000,  # rad/s\n            \"b\": 3.0e-4,  # T\n            \"Gamma\": 1.0e5,  # N * m * s\n            \"t_obs\": 1.6,  # s\n        },\n        {\n            \"name\": \"High initial rotation\",\n            \"Omega_0\": 10000,  # rad/s\n            \"b\": 3.0e-4,  # T\n            \"Gamma\": 1.0e5,  # N * m * s\n            \"t_obs\": 5.2,  # s\n        },\n    ]\n\n    results = []\n    fidelity_threshold = 0.25\n\n    for case in test_cases:\n        # Unpack case-specific parameters\n        Omega_0 = case[\"Omega_0\"]\n        b = case[\"b\"]\n        Gamma = case[\"Gamma\"]\n        t_obs = case[\"t_obs\"]\n\n        # Calculate derived parameters nu and tau\n        nu = Gamma / I\n        tau = alpha * b**2 / I\n\n        # Define the integrand for the slowdown time integral\n        def integrand(Omega):\n            \"\"\"\n            The function g(Omega) to be integrated, derived from dOmega/dt.\n            g(Omega) = 1 / (nu*Omega + tau / (1 + (Omega/Omega_c)^2))\n            \"\"\"\n            denominator = nu * Omega + tau / (1.0 + (Omega / Omega_c)**2)\n            return 1.0 / denominator\n\n        # Set integration limits\n        Omega_f = Omega_0 / 2.0\n        \n        # Numerically evaluate the integral for t_s\n        # quad returns (integral value, estimated error)\n        t_s, _ = quad(integrand, Omega_f, Omega_0)\n\n        # Calculate absolute fractional deviation\n        delta = np.abs((t_s - t_obs) / t_obs)\n\n        # Check model fidelity\n        is_ok = delta <= fidelity_threshold\n\n        # Append results to the list\n        results.append(f\"{t_s:.3f}\")\n        results.append(is_ok)\n\n    # Format the final output string as per requirements\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The interaction between error fields and plasma rotation is part of a more complex, coupled system where the error field can drive the growth of magnetic islands. These islands, in turn, mediate the braking torque, leading to a powerful feedback loop: a growing island slows the plasma, and the slower rotation can further destabilize the island, potentially causing it to \"lock\" to the external field. This advanced exercise  challenges you to simulate this fully coupled system by linking the Modified Rutherford Equation for island growth with a torque balance equation for rotation, exploring the critical dynamics that govern plasma stability.",
            "id": "3721653",
            "problem": "You are asked to derive a minimal, self-consistent, and dimensionless coupled system that models the evolution of a tearing-mode magnetic island in a toroidal plasma using the Modified Rutherford Equation (MRE) and a rotation equation including electromagnetic torque from externally applied static error fields. Then, you must implement a numerical solver for the derived system and evaluate a small test suite that probes locking transitions and their impact on the island half-width as a function of time, denoted by $w(t)$.\n\nThe objective is to start from fundamental balance laws and well-tested facts in resistive magnetohydrodynamics and rigid-body rotation, derive a reduced ordinary differential equation model that is scientifically plausible, and then simulate. You must not assume or use any prepackaged formula for the Modified Rutherford Equation. Instead, you must motivate each term in the reduced model by identifying which physical effect it represents.\n\nUse the following fundamental bases and constraints:\n\n- The helical magnetic flux evolution in a tearing layer is governed by resistive magnetohydrodynamics (MHD), where the resistive induction equation yields a slow evolution of the reconnected flux. In the Rutherford regime, this slow evolution can be related to the magnetic island half-width $w(t)$ and the stability parameter $\\Delta'$, with additional neoclassical (bootstrap current) and polarization current corrections.\n- The bulk toroidal plasma rotation is governed by Newton’s second law for rotational motion, with a net torque that includes both viscous damping and electromagnetic torque from a static error field interacting with the magnetic island.\n- The phase $\\phi(t)$ denotes the phase difference between the island and the static error field in the laboratory frame.\n\nFrom these bases, construct a minimal, dimensionless reduced model with the following structure:\n\n- A magnetic island evolution equation for $w(t)$ that includes:\n  - A linear tearing drive proportional to the stability parameter $\\Delta'$.\n  - A neoclassical bootstrap current drive that scales inversely with $w$.\n  - A dissipative term that scales linearly with $w$ to represent curvature and transport effects.\n  - A polarization current correction that weakens the island growth with increasing rotation, scaling like $-w\\,\\Omega^{2}$, where $\\Omega(t)$ is the toroidal rotation frequency.\n- A rigid-body rotation equation for $\\Omega(t)$ derived from torque balance that includes:\n  - Viscous damping proportional to $-\\Omega$.\n  - An error-field electromagnetic torque that scales as $-w^{2}\\sin\\phi$, capturing the resonant electromagnetic braking that drives locking.\n- A kinematic phase evolution equation for $\\phi(t)$ based on the relative motion of the island and the static error field:\n  - $d\\phi/dt = m\\Omega$, where $m$ is the poloidal mode number, and the error field is assumed stationary in the laboratory frame.\n\nExplicitly, you must implement the following dimensionless system, justified by the principles above:\n$$\n\\frac{dw}{dt} = a_{\\Delta}\\,\\Delta' + \\frac{a_{\\mathrm{bs}}}{\\max(w,w_{\\min})} - a_{\\mathrm{d}}\\,w - a_{\\mathrm{pol}}\\,w\\,\\Omega^{2},\n$$\n$$\nI\\,\\frac{d\\Omega}{dt} = -\\nu\\,\\Omega - K\\,w^{2}\\,\\sin\\phi,\n$$\n$$\n\\frac{d\\phi}{dt} = m\\,\\Omega,\n$$\nwhere $a_{\\Delta}$, $a_{\\mathrm{bs}}$, $a_{\\mathrm{d}}$, $a_{\\mathrm{pol}}$, $I$, $\\nu$, $K$, $m$ are nonnegative, dimensionless parameters, and $w_{\\min}>0$ is an imposed numerical floor to regularize the bootstrap term. All quantities are dimensionless. The choice of coefficients is constrained only by scientific plausibility and internal consistency with the qualitative physics described above.\n\nDefine the following fixed, dimensionless constants for all simulations:\n- $a_{\\Delta} = 2\\times 10^{-3}$,\n- $a_{\\mathrm{bs}} = 1\\times 10^{-6}$,\n- $a_{\\mathrm{d}} = 1\\times 10^{-2}$,\n- $a_{\\mathrm{pol}} = 5\\times 10^{-1}$,\n- $I = 1$,\n- $\\nu = 2\\times 10^{-2}$,\n- $m = 2$,\n- $w_{\\min} = 1\\times 10^{-4}$,\n- initial conditions $w(0) = 2\\times 10^{-2}$, $\\Omega(0) = 5\\times 10^{-1}$, $\\phi(0) = 0$,\n- final time $T = 2000$.\n\nDefine the locking criterion as follows: at time $t=T$, declare the mode to be locked if and only if both $|\\Omega(T)| < \\Omega_{\\mathrm{thr}}$ and $|\\sin(\\phi(T))| < s_{\\mathrm{thr}}$, where:\n- $\\Omega_{\\mathrm{thr}} = 1\\times 10^{-3}$,\n- $s_{\\mathrm{thr}} = 1\\times 10^{-3}$.\n\nNumerically integrate the system and report the diagnostics for the following test suite, which varies $\\Delta'$ and the error-field torque coefficient $K$:\n- Case $1$: $\\Delta' = 5\\times 10^{-1}$, $K = 0$.\n- Case $2$: $\\Delta' = 5\\times 10^{-1}$, $K = 5\\times 10^{-1}$.\n- Case $3$: $\\Delta' = -2\\times 10^{-1}$, $K = 2\\times 10^{-1}$.\n- Case $4$: $\\Delta' = 2\\times 10^{-1}$, $K = 8\\times 10^{-2}$.\n\nFor each case, you must compute two outputs:\n- The final island half-width $w(T)$, rounded to $6$ decimal places (dimensionless).\n- The locking indicator, represented as an integer, where $1$ means locked and $0$ means not locked, as defined above.\n\nYour program should produce a single line of output containing the results as a comma-separated flat list enclosed in square brackets, ordered as\n$[w_{1},b_{1},w_{2},b_{2},w_{3},b_{3},w_{4},b_{4}]$,\nwhere $w_{i}$ is $w(T)$ for case $i$ rounded to $6$ decimals, and $b_{i}\\in\\{0,1\\}$ is the corresponding locking indicator.\n\nImportant implementation notes:\n- The system is dimensionless, so no physical units are involved.\n- You must ensure numerical robustness by preventing division by zero via the floor $w_{\\min}$ in the bootstrap term.\n- Angles must be treated in radians.\n- The program must be self-contained, accept no input, read no files, and print only the described single-line output.",
            "solution": "The problem is valid as it presents a scientifically grounded, well-posed, and objective task based on established principles of plasma physics. It requires the derivation and numerical solution of a reduced model for magnetic island evolution and rotation, a standard problem in fusion research. The model, known as the Modified Rutherford Equation coupled with a torque balance equation, is a cornerstone for analyzing Neoclassical Tearing Modes (NTMs) and their interaction with external fields.\n\nThe task is to first provide a physical justification for the given system of coupled ordinary differential equations (ODEs), and then to implement a numerical solution. The system describes the temporal evolution of the magnetic island half-width, $w(t)$, the plasma's toroidal rotation frequency, $\\Omega(t)$, and the relative phase between the island and a static error field, $\\phi(t)$.\n\nThe dimensionless system to be analyzed is:\n$$\n\\frac{dw}{dt} = a_{\\Delta}\\,\\Delta' + \\frac{a_{\\mathrm{bs}}}{\\max(w,w_{\\min})} - a_{\\mathrm{d}}\\,w - a_{\\mathrm{pol}}\\,w\\,\\Omega^{2}\n$$\n$$\nI\\,\\frac{d\\Omega}{dt} = -\\nu\\,\\Omega - K\\,w^{2}\\,\\sin\\phi\n$$\n$$\n\\frac{d\\phi}{dt} = m\\,\\Omega\n$$\n\nBelow is a term-by-term derivation based on the fundamental principles of resistive magnetohydrodynamics (MHD) and rotational dynamics.\n\n**1. Magnetic Island Evolution Equation (Modified Rutherford Equation)**\n\nThis equation for $\\frac{dw}{dt}$ describes the rate of change of the magnetic island half-width. It can be viewed as a power balance equation for the island, where the terms on the right-hand side represent physical effects that either drive island growth or cause it to saturate or shrink.\n\n- **$a_{\\Delta}\\,\\Delta'$**: This is the classical tearing drive term. In resistive MHD, the parameter $\\Delta'$ represents the free energy available from the background magnetic shear to drive a tearing instability. If $\\Delta' > 0$, the magnetic equilibrium is unstable, and this term provides a drive for island growth. If $\\Delta' < 0$, it is a stabilizing term. In the \"Rutherford regime\" of slow, nonlinear growth, this drive is independent of the island width $w$. The constant $a_{\\Delta}$ normalizes the growth rate.\n\n- **$\\frac{a_{\\mathrm{bs}}}{\\max(w,w_{\\min})}$**: This term represents the neoclassical tearing mode (NTM) drive, originating from the bootstrap current. The bootstrap current is a self-generated current in toroidal plasmas sustained by particle transport in a non-uniform magnetic field. The formation of a magnetic island flattens the pressure profile within it, which locally suppresses the bootstrap current. This helical \"hole\" in the current profile perturbs the magnetic field in a way that reinforces the island, leading to growth. For small islands, this effect scales as $1/w$, making it a powerful destabilizing mechanism for small \"seed\" islands. The expression $\\max(w, w_{\\min})$ is a numerical regularization to prevent the singularity at $w=0$, representing small-scale physics (e.g., finite ion Larmor radius effects) that resolve this divergence in a physical plasma. The coefficient $a_{\\mathrm{bs}}$ sets the strength of this drive.\n\n- **$-a_{\\mathrm{d}}\\,w$**: This is a generic stabilizing term, representing various dissipative effects. It is often associated with the stabilizing influence of average favorable magnetic field curvature in a tokamak (the Glasser-Greene-Johnson effect), which becomes more effective for larger islands. It can also phenomenologically model enhanced energy transport across the island, which would damp the pressure gradient and thus weaken the bootstrap drive. A simple linear dependence on $w$ is a common and plausible model for such saturation effects.\n\n- **$-a_{\\mathrm{pol}}\\,w\\,\\Omega^{2}$**: This is the ion polarization current term. When the magnetic island rotates with a frequency $\\Omega$ relative to the bulk plasma ions, a differential velocity is established. This induces a polarization current via ion inertia. The interaction of this current with the magnetic field produces a force that opposes the island's growth. This effect is therefore stabilizing and scales with the island width $w$ and the square of the rotation frequency $\\Omega^2$. It is a critical term for explaining why sufficient plasma rotation can suppress NTMs.\n\n**2. Plasma Rotation Equation (Torque Balance)**\n\nThis equation for $\\frac{d\\Omega}{dt}$ is an expression of Newton's second law for rotation, $I \\frac{d\\Omega}{dt} = \\sum \\tau$, where $I$ is the moment of inertia and $\\tau$ represents torque.\n\n- **$I\\,\\frac{d\\Omega}{dt}$**: The left-hand side is the rate of change of the plasma's angular momentum, with $I$ being its dimensionless moment of inertia.\n\n- **$-\\nu\\,\\Omega$**: This term represents a viscous damping torque. It models the transport of momentum out of the plasma core (e.g., to the vessel wall or other plasma regions), which causes the rotation to slow down. This is typically modeled as a simple drag force proportional to the rotation frequency $\\Omega$, where $\\nu$ is the viscous damping rate.\n\n- **$-K\\,w^{2}\\,\\sin\\phi$**: This is the electromagnetic torque resulting from the interaction between the current perturbation associated with the magnetic island and an external, static, resonant magnetic field perturbation (an \"error field\"). The magnitude of the torque is proportional to the strength of the external field (contained in $K$) and the size of the island squared ($w^2$). The phase dependence, $\\sin\\phi$, is characteristic of such resonant interactions. This torque acts to align the island with the static field (i.e., drive $\\phi$ towards $0$), thus braking the plasma rotation. If this torque is strong enough, it can slow the rotation to a halt, a phenomenon known as \"mode locking\".\n\n**3. Phase Evolution Equation**\n\nThis equation for $\\frac{d\\phi}{dt}$ is a purely kinematic relationship.\n\n- **$\\frac{d\\phi}{dt} = m\\,\\Omega$**: The variable $\\phi(t)$ is the phase angle between the rotating island and the stationary laboratory frame (in which the error field is assumed to be static). The island's helical structure is characterized by a poloidal mode number $m$. This helical pattern rotates in the lab frame with an angular frequency given by $m\\Omega$, where $\\Omega$ is the toroidal fluid rotation frequency. Therefore, the rate of change of the relative phase $\\phi$ is simply this mode frequency.\n\nWith the physical basis of the model established, a numerical integration can be performed for the specified parameters and test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the coupled ODE system for tearing mode evolution and rotation\n    for a suite of test cases and reports the final state.\n    \"\"\"\n    # Define fixed, dimensionless constants for all simulations.\n    a_delta = 2e-3\n    a_bs = 1e-6\n    a_d = 1e-2\n    a_pol = 5e-1\n    I_val = 1.0  # Use I_val to avoid conflict with identity matrix 'I' common in numpy\n    nu = 2e-2\n    m = 2.0\n    w_min = 1e-4\n\n    # Define initial conditions and integration time.\n    w0 = 2e-2\n    Omega0 = 5e-1\n    phi0 = 0.0\n    y0 = [w0, Omega0, phi0]\n    t_span = [0.0, 2000.0]\n\n    # Define the locking criterion thresholds.\n    Omega_thr = 1e-3\n    s_thr = 1e-3\n\n    # Define the test suite of varying parameters.\n    # Each case is a tuple (delta_prime, K).\n    test_cases = [\n        (5e-1, 0.0),      # Case 1\n        (5e-1, 5e-1),      # Case 2\n        (-2e-1, 2e-1),     # Case 3\n        (2e-1, 8e-2)       # Case 4\n    ]\n\n    results = []\n\n    for delta_prime, K in test_cases:\n        # Define the system of ODEs for the current set of parameters.\n        def ode_system(t, y):\n            w, Omega, phi = y\n\n            # Regularize the bootstrap term to avoid division by zero.\n            w_eff = np.maximum(w, w_min)\n\n            # Equation for island half-width dw/dt\n            dw_dt = (a_delta * delta_prime + \n                     a_bs / w_eff - \n                     a_d * w - \n                     a_pol * w * Omega**2)\n\n            # Equation for rotation frequency dOmega/dt\n            dOmega_dt = (-nu * Omega - K * w**2 * np.sin(phi)) / I_val\n\n            # Equation for island phase dphi/dt\n            dphi_dt = m * Omega\n\n            return [dw_dt, dOmega_dt, dphi_dt]\n\n        # Numerically integrate the system of ODEs.\n        # Use a robust solver like RK45.\n        # dense_output=True allows evaluation at arbitrary time points.\n        # Tolerances are set for numerical stability and accuracy.\n        solution = solve_ivp(\n            ode_system,\n            t_span,\n            y0,\n            method='RK45',\n            dense_output=True,\n            atol=1e-10,\n            rtol=1e-7\n        )\n\n        # Extract the state variables at the final time T.\n        w_T, Omega_T, phi_T = solution.sol(t_span[1])\n\n        # Apply the locking criteria to determine the locking indicator.\n        is_locked_omega = np.abs(Omega_T) < Omega_thr\n        is_locked_phi = np.abs(np.sin(phi_T)) < s_thr\n        locking_indicator = 1 if is_locked_omega and is_locked_phi else 0\n\n        # Round the final island width to 6 decimal places.\n        final_w = round(w_T, 6)\n\n        # Append the results for the current case to the list.\n        results.extend([final_w, locking_indicator])\n\n    # Format the final output as a single comma-separated string in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver.\nsolve()\n```"
        }
    ]
}