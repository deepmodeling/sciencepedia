{
    "hands_on_practices": [
        {
            "introduction": "This first practice establishes the fundamental link between the theoretical description of a damped wave and its observable signal, for instance, in a time-domain simulation. Starting with a simple model of a damped oscillation characterized by a complex frequency $\\omega = \\omega_{R} - i \\gamma$, we will derive the precise relationship between the damping rate $\\gamma$ and the logarithmic decrement $\\delta$ of the wave's amplitude over successive cycles. This exercise () is crucial for developing the skills to extract quantitative physical parameters from the raw output of numerical simulations, a foundational task in computational plasma physics.",
            "id": "4040061",
            "problem": "Consider a time-domain simulation of a single, dominant Alfvénic oscillation in a nonuniform magnetized plasma, conducted within the framework of linear magnetohydrodynamics (MHD). Due to resonant absorption into the Alfvén continuum, the mode is damped. The temporal signal at a fixed spatial point is modeled as a single-mode response with complex angular frequency, where the observable displacement or magnetic field perturbation is well-approximated by a function of the form $x(t)$ whose leading-order time dependence arises from an eigenfrequency $\\omega$ satisfying $\\omega = \\omega_{R} - i \\gamma$, with $\\omega_{R} > 0$ the real oscillation frequency and $\\gamma > 0$ the damping rate. Assume the weak-damping regime $\\gamma / \\omega_{R} \\ll 1$, and that a single Fourier mode dominates the measured response over many cycles such that mode beating and chirps can be neglected to leading order.\n\nDefine the cycle-to-cycle logarithmic decrement $\\delta$ by extracting successive local maxima $\\{A_{n}\\}$ of $|x(t)|$ and setting $\\delta = \\ln\\!\\left(\\frac{A_{n}}{A_{n+1}}\\right)$ for any consecutive cycles. Starting from a valid linear-response base consistent with MHD normal-mode theory and the small-$\\gamma$ assumption, derive the relation between $\\delta$ and $\\gamma$ in terms of the real oscillation frequency $\\omega_{R}$. Briefly explain the conceptual steps needed to numerically extract $\\gamma$ from a simulated time series $x(t)$, including how to determine $\\omega_{R}$ and how to mitigate numerical bias when computing $\\delta$.\n\nProvide your final answer as a single closed-form analytic expression for $\\gamma$ in terms of $\\delta$ and $\\omega_{R}$. No numerical evaluation is required.",
            "solution": "The problem is scientifically grounded, well-posed, and objective, based on established principles of linear magnetohydrodynamics (MHD) and the theory of damped oscillations. All provided information is self-contained and consistent, allowing for a rigorous derivation. Therefore, the problem is valid and a solution can be constructed.\n\nThe temporal evolution of a single, linearly-damped MHD mode can be represented by a complex displacement or field perturbation $z(t)$ of the form\n$$z(t) = C \\exp(-i\\omega t)$$\nwhere $C$ is a complex amplitude and $\\omega$ is the complex angular frequency of the mode. The problem states that $\\omega = \\omega_{R} - i \\gamma$, where $\\omega_{R} > 0$ is the real oscillation frequency and $\\gamma > 0$ is the damping rate.\n\nSubstituting the complex frequency into the expression for $z(t)$, we get:\n$$z(t) = C \\exp(-i(\\omega_{R} - i\\gamma) t) = C \\exp(-i\\omega_{R}t - \\gamma t) = C \\exp(-\\gamma t) \\exp(-i\\omega_{R}t)$$\nAn observable physical quantity, such as the displacement $x(t)$, is the real part of $z(t)$. Let the complex constant $C$ be expressed in polar form as $C = A_{0} \\exp(i\\phi_{0})$, where $A_0$ is a real, positive initial amplitude and $\\phi_{0}$ is an initial phase.\n$$z(t) = A_{0} \\exp(i\\phi_{0}) \\exp(-\\gamma t) \\exp(-i\\omega_{R}t) = A_0 \\exp(-\\gamma t) \\exp(i(\\phi_{0} - \\omega_{R}t))$$\nTaking the real part gives the observable signal:\n$$x(t) = \\text{Re}[z(t)] = A_{0} \\exp(-\\gamma t) \\cos(\\omega_{R}t - \\phi_{0})$$\nThis equation describes a sinusoidal oscillation with angular frequency $\\omega_{R}$ whose amplitude decays exponentially with time. The amplitude envelope is given by $A(t) = A_{0} \\exp(-\\gamma t)$.\n\nThe problem defines the logarithmic decrement $\\delta$ based on successive local maxima $\\{A_n\\}$ of $|x(t)|$. The quantity $A_n$ is the amplitude of the $n$-th peak, occurring at time $t_n$. The term \"cycle-to-cycle\" implies that we are comparing the amplitudes of two consecutive peaks separated by one full period of oscillation, $T_{R} = 2\\pi / \\omega_{R}$.\n\nLet $A_n$ be the amplitude of a peak at time $t_n$. The next corresponding peak (e.g., the next positive maximum) will occur one period later, at time $t_{n+1} \\approx t_n + T_R$. The amplitudes of these peaks are given by the value of the envelope $A(t)$ at these times. This is an excellent approximation in the weak-damping regime, $\\gamma / \\omega_{R} \\ll 1$, specified in the problem, because the damping is slow over one cycle. A more pedantic calculation would involve finding the extrema of $x(t)$ by setting its derivative to zero, which shows a small shift in the peak times of order $\\gamma/\\omega_R^2$. However, the resulting correction to the final relation is of order $(\\gamma/\\omega_R)^2$ and is negligible under the weak-damping assumption.\n\nThus, we can state:\n$$A_{n} = A(t_n) = A_{0} \\exp(-\\gamma t_{n})$$\n$$A_{n+1} = A(t_{n+1}) = A(t_{n} + T_{R}) = A_{0} \\exp(-\\gamma (t_{n} + T_{R}))$$\nThe ratio of these two successive amplitudes is:\n$$\\frac{A_{n}}{A_{n+1}} = \\frac{A_{0} \\exp(-\\gamma t_{n})}{A_{0} \\exp(-\\gamma t_{n} - \\gamma T_{R})} = \\frac{\\exp(-\\gamma t_{n})}{\\exp(-\\gamma t_{n}) \\exp(-\\gamma T_{R})} = \\exp(\\gamma T_{R})$$\nThe logarithmic decrement $\\delta$ is defined as the natural logarithm of this ratio:\n$$\\delta = \\ln\\left(\\frac{A_{n}}{A_{n+1}}\\right) = \\ln(\\exp(\\gamma T_{R})) = \\gamma T_{R}$$\nSubstituting the expression for the period, $T_{R} = 2\\pi / \\omega_{R}$, we obtain the relationship between $\\delta$, $\\gamma$, and $\\omega_{R}$:\n$$\\delta = \\gamma \\frac{2\\pi}{\\omega_{R}}$$\nSolving for the damping rate $\\gamma$ yields the final expression:\n$$\\gamma = \\frac{\\delta \\omega_{R}}{2\\pi}$$\nTo numerically extract $\\gamma$ from a simulated time series $x(t)$, the following conceptual steps are necessary:\n1.  **Determine the real frequency $\\omega_{R}$**: The dominant real frequency $\\omega_{R}$ can be found by applying a Fast Fourier Transform (FFT) to the time series $x(t)$ and identifying the frequency at which the power spectrum $|\\tilde{x}(\\omega)|^2$ peaks. Alternatively, one could measure the average time interval between successive positive peaks or zero-crossings to find the period $T_{R}$, and then calculate $\\omega_{R} = 2\\pi/T_{R}$.\n\n2.  **Determine the logarithmic decrement $\\delta$**: A robust method is needed to mitigate numerical bias from noise or other artifacts. Instead of using just two consecutive peaks, one should first identify all positive local maxima, $\\{A_n\\}$, in the time series. According to the relation $A_n \\approx A_0 \\exp(-\\gamma n T_R)$, a plot of $\\ln(A_n)$ versus the cycle number $n$ should yield a straight line. The slope of this line is $m = -\\gamma T_R$. The logarithmic decrement is the amplitude reduction per cycle, so $\\delta = -m = \\gamma T_R$. Performing a linear least-squares fit to the data points $(n, \\ln(A_n))$ provides a statistically robust estimate for the slope $m$, and thus for $\\delta$. This regression-based approach averages over many cycles and is far more accurate than a two-point estimate.\n\n3.  **Calculate the damping rate $\\gamma$**: With the numerically determined values for $\\delta$ and $\\omega_{R}$, the damping rate is calculated using the derived formula $\\gamma = \\delta \\omega_{R} / (2\\pi)$.",
            "answer": "$$\\boxed{\\gamma = \\frac{\\delta \\omega_{R}}{2\\pi}}$$"
        },
        {
            "introduction": "Having established how to measure damping from an oscillatory signal, we now delve into the physics of the absorption process itself. Within the thin resonant layer where wave energy is converted to heat, both plasma resistivity and viscosity can contribute to dissipation. This practice () challenges you to calculate the partition of absorbed energy between these two channels by integrating the respective local dissipation densities, $Q_{\\eta}$ and $Q_{\\mathrm{v}}$, across a model resonant layer. This analytical exercise provides concrete insight into the microscopic mechanisms that underpin the macroscopic damping observed in simulations and experiments.",
            "id": "4040053",
            "problem": "Consider a monochromatic shear-Alfvén perturbation incident on a resonant layer in a one-dimensional slab plasma with equilibrium magnetic field $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{y}}$ and mass density $\\rho_{0}$ that vary slowly enough for matched asymptotics to apply. The resonance is located at $x=0$. Assume weak but finite dissipation due to an isotropic kinematic viscosity $\\nu$ and an electrical resistivity $\\eta$, and define the standard inner-layer coordinate $\\xi = x/\\delta$, where $\\delta$ is the thickness scale of the dissipative layer. In the inner region, let the leading-order tangential velocity and magnetic field perturbations be odd functions consistent with the shear-Alfvén polarization and smooth matching across the resonance:\n$$\nv_{y}(x) = V\\,\\tanh\\!\\left(\\frac{x}{\\delta}\\right) \\quad\\text{and}\\quad b_{y}(x) = B\\,\\tanh\\!\\left(\\frac{x}{\\delta}\\right),\n$$\nwhere $V$ and $B$ are real amplitudes set by the outer solution and the incoming wave.\n\nUse the fundamental energy balance implied by the Poynting theorem for Magnetohydrodynamics (MHD), which states that the absorbed power per unit area in steady state equals the integral of local dissipation densities across the layer. Model the local dissipation densities as\n$$\nQ_{\\mathrm{v}}(x) = \\rho_{0}\\,\\nu\\left|\\frac{\\partial v_{y}}{\\partial x}\\right|^{2}, \\qquad Q_{\\eta}(x) = \\eta\\,|\\mathbf{j}(x)|^{2},\n$$\nwith the current density $\\mathbf{j}$ obtained from Ampère’s law without displacement current, $\\,\\mu_{0}\\,\\mathbf{j} = \\nabla \\times \\mathbf{b}\\,$, so that in this geometry $\\,j_{z}(x) = -\\frac{1}{\\mu_{0}}\\,\\frac{\\partial b_{y}}{\\partial x}\\,$. Here $\\mu_{0}$ is the vacuum permeability. Assume the leading-order ideal shear-Alfvén polarization holds pointwise in the inner region, relating the tangential magnetic and velocity perturbations by\n$$\nb_{y}(x) = \\pm \\sqrt{\\mu_{0}\\,\\rho_{0}}\\,v_{y}(x),\n$$\nconsistent with the linearized ideal MHD momentum and induction equations evaluated at the resonance. Use this relation to eliminate $B$ in favor of $V$.\n\nCompute the absorbed energy per unit area in the viscous and resistive channels,\n$$\nE_{\\mathrm{v}} = \\int_{-\\infty}^{\\infty} Q_{\\mathrm{v}}(x)\\,dx, \\qquad E_{\\eta} = \\int_{-\\infty}^{\\infty} Q_{\\eta}(x)\\,dx,\n$$\nby integrating over the inner coordinate $\\xi$. Then determine the energy partition as the fractions\n$$\nf_{\\mathrm{v}} = \\frac{E_{\\mathrm{v}}}{E_{\\mathrm{v}}+E_{\\eta}}, \\qquad f_{\\eta} = \\frac{E_{\\eta}}{E_{\\mathrm{v}}+E_{\\eta}}.\n$$\nExpress your final answers as exact analytic expressions in terms of $\\nu$, $\\eta$, and $\\mu_{0}$ only. The fractions are dimensionless; do not use a percent sign. Provide both fractions together as your final answer.",
            "solution": "The problem statement will first be validated according to the specified procedure.\n\n### Step 1: Extract Givens\n- **Equilibrium:** One-dimensional slab plasma with magnetic field $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{y}}$ and mass density $\\rho_{0}$.\n- **Resonance Location:** The resonance is at $x=0$.\n- **Dissipation:** Isotropic kinematic viscosity $\\nu$ and electrical resistivity $\\eta$.\n- **Inner-layer Coordinate:** $\\xi = x/\\delta$, where $\\delta$ is the dissipative layer thickness.\n- **Perturbation Profiles:** The leading-order tangential velocity and magnetic field perturbations are given as:\n  $$\n  v_{y}(x) = V\\,\\tanh\\!\\left(\\frac{x}{\\delta}\\right)\n  $$\n  $$\n  b_{y}(x) = B\\,\\tanh\\!\\left(\\frac{x}{\\delta}\\right)\n  $$\n  where $V$ and $B$ are real amplitudes.\n- **Dissipation Densities:**\n  $$\n  Q_{\\mathrm{v}}(x) = \\rho_{0}\\,\\nu\\left|\\frac{\\partial v_{y}}{\\partial x}\\right|^{2}\n  $$\n  $$\n  Q_{\\eta}(x) = \\eta\\,|\\mathbf{j}(x)|^{2}\n  $$\n- **Current Density:** From Ampère's law, $\\mu_{0}\\,\\mathbf{j} = \\nabla \\times \\mathbf{b}$, which in this geometry yields:\n  $$\n  j_{z}(x) = -\\frac{1}{\\mu_{0}}\\,\\frac{\\partial b_{y}}{\\partial x}\n  $$\n- **Ideal MHD Polarization Relation:** At the resonance, the perturbations are related by:\n  $$\n  b_{y}(x) = \\pm \\sqrt{\\mu_{0}\\,\\rho_{0}}\\,v_{y}(x)\n  $$\n- **Quantities to Compute:**\n  1.  Total absorbed energy per unit area in the viscous channel:\n      $$\n      E_{\\mathrm{v}} = \\int_{-\\infty}^{\\infty} Q_{\\mathrm{v}}(x)\\,dx\n      $$\n  2.  Total absorbed energy per unit area in the resistive channel:\n      $$\n      E_{\\eta} = \\int_{-\\infty}^{\\infty} Q_{\\eta}(x)\\,dx\n      $$\n  3.  Energy partition fractions:\n      $$\n      f_{\\mathrm{v}} = \\frac{E_{\\mathrm{v}}}{E_{\\mathrm{v}}+E_{\\eta}}, \\qquad f_{\\eta} = \\frac{E_{\\eta}}{E_{\\mathrm{v}}+E_{\\eta}}\n      $$\n- **Final Expression:** The fractions $f_{\\mathrm{v}}$ and $f_{\\eta}$ should be expressed in terms of $\\nu$, $\\eta$, and $\\mu_{0}$ only.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem describes resonant absorption of shear-Alfvén waves in MHD, a cornerstone topic in plasma physics and fusion science. The equations for dissipation and the model profiles are standard representations used in the literature for analyzing such phenomena, particularly within the framework of matched asymptotic expansions. The problem is fundamentally sound.\n- **Well-Posed:** The problem provides all necessary information to compute the required quantities. The profiles are given, the dissipation models are explicit, and the relation between the fields is provided. The integrals are well-defined and convergent. A unique, meaningful solution exists.\n- **Objective:** The problem is stated in precise, quantitative terms using standard physics and mathematics notation. There are no subjective or opinion-based statements.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically grounded, self-contained, and well-posed. The solution process may proceed.\n\n### Solution Derivation\n\nThe goal is to compute the energy partition fractions $f_{\\mathrm{v}}$ and $f_{\\eta}$. We begin by expressing the dissipation densities and the integrals for total absorbed energy in terms of the inner-layer coordinate $\\xi = x/\\delta$.\n\n1.  **Express perturbations and their derivatives in terms of $\\xi$:**\n    The given perturbations are $v_{y}(x) = V\\,\\tanh(x/\\delta)$ and $b_{y}(x) = B\\,\\tanh(x/\\delta)$. In the inner-layer coordinate $\\xi$, these are:\n    $$\n    v_{y}(\\xi) = V\\,\\tanh(\\xi)\n    $$\n    $$\n    b_{y}(\\xi) = B\\,\\tanh(\\xi)\n    $$\n    We need the spatial derivatives with respect to $x$. Using the chain rule, $\\frac{\\partial}{\\partial x} = \\frac{d\\xi}{dx}\\frac{\\partial}{\\partial\\xi} = \\frac{1}{\\delta}\\frac{\\partial}{\\partial\\xi}$.\n    $$\n    \\frac{\\partial v_{y}}{\\partial x} = \\frac{1}{\\delta}\\frac{d}{d\\xi}\\left(V\\,\\tanh(\\xi)\\right) = \\frac{V}{\\delta}\\,\\mathrm{sech}^{2}(\\xi)\n    $$\n    $$\n    \\frac{\\partial b_{y}}{\\partial x} = \\frac{1}{\\delta}\\frac{d}{d\\xi}\\left(B\\,\\tanh(\\xi)\\right) = \\frac{B}{\\delta}\\,\\mathrm{sech}^{2}(\\xi)\n    $$\n\n2.  **Formulate the dissipation densities:**\n    The viscous dissipation density is:\n    $$\n    Q_{\\mathrm{v}}(x) = \\rho_{0}\\,\\nu\\left|\\frac{\\partial v_{y}}{\\partial x}\\right|^{2} = \\rho_{0}\\,\\nu\\left|\\frac{V}{\\delta}\\,\\mathrm{sech}^{2}(\\xi)\\right|^{2} = \\frac{\\rho_{0}\\,\\nu\\,V^{2}}{\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi)\n    $$\n    The current density is $j_{z}(x) = -\\frac{1}{\\mu_{0}}\\frac{\\partial b_{y}}{\\partial x} = -\\frac{B}{\\mu_{0}\\delta}\\,\\mathrm{sech}^{2}(\\xi)$.\n    The resistive dissipation density is:\n    $$\n    Q_{\\eta}(x) = \\eta\\,|j_{z}(x)|^{2} = \\eta\\left|-\\frac{B}{\\mu_{0}\\delta}\\,\\mathrm{sech}^{2}(\\xi)\\right|^{2} = \\frac{\\eta\\,B^{2}}{\\mu_{0}^{2}\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi)\n    $$\n\n3.  **Relate the amplitudes $B$ and $V$:**\n    The problem provides the ideal MHD polarization relation $b_{y}(x) = \\pm\\sqrt{\\mu_{0}\\rho_{0}}\\,v_{y}(x)$. This implies $B\\,\\tanh(x/\\delta) = \\pm\\sqrt{\\mu_{0}\\rho_{0}}\\,V\\,\\tanh(x/\\delta)$, which gives a direct relation between the amplitudes: $B = \\pm\\sqrt{\\mu_{0}\\rho_{0}}\\,V$.\n    Since $B$ is squared in the expression for $Q_{\\eta}$, the sign is irrelevant. We substitute $B^{2} = (\\mu_{0}\\rho_{0})V^{2}$ into the expression for $Q_{\\eta}$:\n    $$\n    Q_{\\eta}(x) = \\frac{\\eta\\,(\\mu_{0}\\rho_{0}V^{2})}{\\mu_{0}^{2}\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi) = \\frac{\\eta\\,\\rho_{0}\\,V^{2}}{\\mu_{0}\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi)\n    $$\n\n4.  **Compute the total absorbed energies $E_{\\mathrm{v}}$ and $E_{\\eta}$:**\n    The total absorbed energy per unit area for each channel is found by integrating the respective dissipation density from $x=-\\infty$ to $x=+\\infty$. We change the integration variable to $\\xi$ using $dx = \\delta\\,d\\xi$. The integration limits for $\\xi$ are also $-\\infty$ to $+\\infty$.\n    $$\n    E_{\\mathrm{v}} = \\int_{-\\infty}^{\\infty} Q_{\\mathrm{v}}(x)\\,dx = \\int_{-\\infty}^{\\infty} \\left(\\frac{\\rho_{0}\\,\\nu\\,V^{2}}{\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi)\\right) (\\delta\\,d\\xi) = \\frac{\\rho_{0}\\,\\nu\\,V^{2}}{\\delta} \\int_{-\\infty}^{\\infty} \\mathrm{sech}^{4}(\\xi)\\,d\\xi\n    $$\n    $$\n    E_{\\eta} = \\int_{-\\infty}^{\\infty} Q_{\\eta}(x)\\,dx = \\int_{-\\infty}^{\\infty} \\left(\\frac{\\eta\\,\\rho_{0}\\,V^{2}}{\\mu_{0}\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi)\\right) (\\delta\\,d\\xi) = \\frac{\\eta\\,\\rho_{0}\\,V^{2}}{\\mu_{0}\\delta} \\int_{-\\infty}^{\\infty} \\mathrm{sech}^{4}(\\xi)\\,d\\xi\n    $$\n    Both expressions depend on the definite integral $\\int_{-\\infty}^{\\infty} \\mathrm{sech}^{4}(\\xi)\\,d\\xi$. Let's evaluate it.\n    The indefinite integral of $\\mathrm{sech}^{4}(\\xi)$ can be found using the substitution $u=\\tanh(\\xi)$, for which $du = \\mathrm{sech}^{2}(\\xi)\\,d\\xi$, and the identity $\\mathrm{sech}^{2}(\\xi) = 1-\\tanh^{2}(\\xi)$:\n    $$\n    \\int \\mathrm{sech}^{4}(\\xi)\\,d\\xi = \\int \\mathrm{sech}^{2}(\\xi)\\,\\mathrm{sech}^{2}(\\xi)\\,d\\xi = \\int (1-\\tanh^{2}(\\xi))\\,\\mathrm{sech}^{2}(\\xi)\\,d\\xi = \\int (1-u^{2})\\,du = u - \\frac{u^{3}}{3} + C\n    $$\n    Substituting back $u=\\tanh(\\xi)$, we get $\\tanh(\\xi) - \\frac{1}{3}\\tanh^{3}(\\xi) + C$.\n    Now, we evaluate the definite integral:\n    $$\n    \\int_{-\\infty}^{\\infty} \\mathrm{sech}^{4}(\\xi)\\,d\\xi = \\left[\\tanh(\\xi) - \\frac{1}{3}\\tanh^{3}(\\xi)\\right]_{-\\infty}^{\\infty}\n    $$\n    As $\\xi \\to \\infty$, $\\tanh(\\xi) \\to 1$. As $\\xi \\to -\\infty$, $\\tanh(\\xi) \\to -1$.\n    $$\n    \\int_{-\\infty}^{\\infty} \\mathrm{sech}^{4}(\\xi)\\,d\\xi = \\left(1 - \\frac{1}{3}(1)^{3}\\right) - \\left(-1 - \\frac{1}{3}(-1)^{3}\\right) = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n    $$\n    Substituting this result back into the expressions for $E_{\\mathrm{v}}$ and $E_{\\eta}$:\n    $$\n    E_{\\mathrm{v}} = \\frac{\\rho_{0}\\,\\nu\\,V^{2}}{\\delta} \\left(\\frac{4}{3}\\right)\n    $$\n    $$\n    E_{\\eta} = \\frac{\\eta\\,\\rho_{0}\\,V^{2}}{\\mu_{0}\\delta} \\left(\\frac{4}{3}\\right)\n    $$\n\n5.  **Calculate the energy partition fractions:**\n    The total absorbed energy is $E_{\\mathrm{total}} = E_{\\mathrm{v}} + E_{\\eta}$.\n    $$\n    E_{\\mathrm{total}} = \\frac{4}{3}\\frac{\\rho_{0}\\,V^{2}}{\\delta}\\left(\\nu + \\frac{\\eta}{\\mu_{0}}\\right)\n    $$\n    The viscous fraction is:\n    $$\n    f_{\\mathrm{v}} = \\frac{E_{\\mathrm{v}}}{E_{\\mathrm{v}}+E_{\\eta}} = \\frac{\\frac{4}{3}\\frac{\\rho_{0}\\,\\nu\\,V^{2}}{\\delta}}{\\frac{4}{3}\\frac{\\rho_{0}\\,V^{2}}{\\delta}\\left(\\nu + \\frac{\\eta}{\\mu_{0}}\\right)} = \\frac{\\nu}{\\nu + \\frac{\\eta}{\\mu_{0}}}\n    $$\n    The resistive fraction is:\n    $$\n    f_{\\eta} = \\frac{E_{\\eta}}{E_{\\mathrm{v}}+E_{\\eta}} = \\frac{\\frac{4}{3}\\frac{\\eta\\,\\rho_{0}\\,V^{2}}{\\mu_{0}\\delta}}{\\frac{4}{3}\\frac{\\rho_{0}\\,V^{2}}{\\delta}\\left(\\nu + \\frac{\\eta}{\\mu_{0}}\\right)} = \\frac{\\frac{\\eta}{\\mu_{0}}}{\\nu + \\frac{\\eta}{\\mu_{0}}}\n    $$\n    As a check, $f_{\\mathrm{v}} + f_{\\eta} = \\frac{\\nu + \\frac{\\eta}{\\mu_{0}}}{\\nu + \\frac{\\eta}{\\mu_{0}}} = 1$. The parameters $\\rho_{0}$, $V$, and $\\delta$ all cancel, as expected for a partition ratio.\n\n    To simplify the expressions and avoid nested fractions, we can multiply the numerator and denominator by $\\mu_{0}$:\n    $$\n    f_{\\mathrm{v}} = \\frac{\\nu\\,\\mu_{0}}{\\nu\\,\\mu_{0} + \\eta}\n    $$\n    $$\n    f_{\\eta} = \\frac{\\eta}{\\nu\\,\\mu_{0} + \\eta}\n    $$\n    These are the final expressions for the energy partition fractions.",
            "answer": "$$\n\\boxed{\nf_{\\mathrm{v}} = \\frac{\\nu \\mu_0}{\\nu \\mu_0 + \\eta}, \\qquad f_{\\eta} = \\frac{\\eta}{\\nu \\mu_0 + \\eta}\n}\n$$"
        },
        {
            "introduction": "Finally, we apply our understanding of resonant absorption to a critical issue in fusion energy research: the stability of Toroidal Alfvén Eigenmodes (TAEs) in tokamaks. The damping of these modes, which can be driven unstable by energetic particles, is highly sensitive to the plasma's magnetic structure, described by the safety factor profile $q(r)$. In this computational exercise (), you will build a model to locate continuum resonances in a toroidal geometry and quantify the damping sensitivity. This practice demonstrates how theoretical concepts of resonant absorption are translated into essential computational tools for analyzing and ultimately controlling the stability of fusion plasmas.",
            "id": "4039996",
            "problem": "Consider a circular tokamak plasma where ideal MagnetoHydroDynamics (MHD) applies, with major radius $R_0$, minor radius $a$, magnetic field magnitude $B_0$ that is uniform, and mass density $\\rho_0$ that is uniform. The shear Alfvén wave has dispersion relation $\\omega^2 = k_\\parallel^2 v_A^2$ with the Alfvén speed $v_A = B_0 / \\sqrt{\\mu_0 \\rho_0}$, where $\\mu_0$ is the vacuum permeability. The Toroidal Alfvén Eigenmode (TAE) is a global mode of toroidal number $n$ and poloidal number $m$ that couples neighboring poloidal harmonics. The parallel wavenumber for a given poloidal harmonic in large aspect ratio tokamak geometry can be represented as $k_\\parallel(r) = \\left(n - \\frac{j}{q(r)}\\right)/R_0$, where $j$ equals either $m$ or $m+1$ for the neighboring harmonic. The safety factor profile is $q(r) = q_0 + q_s \\left(\\frac{r}{a}\\right)^p$, with $q_0  0$, $q_s  0$, and $p  0$, yielding a strictly monotonic increasing $q(r)$ on $r \\in [0,a]$. The continuum resonance condition for Alfvén waves is that the global mode frequency $\\omega$ equals the local shear Alfvén continuum frequency, which occurs where $\\omega^2 = v_A^2 k_\\parallel(r)^2$. The damping of the global TAE due to resonant absorption in the Alfvén continuum can be characterized by the slope of the detuning function $$D(\\omega,r) = \\omega^2 - v_A^2 k_\\parallel(r)^2,$$ at the resonance location $r^\\star$, where $D(\\omega,r^\\star)=0$. A sensitivity index for damping to $q$-profile shaping is defined as a dimensionless normalized measure $$S_{\\mathrm{damp}} = \\left(\\frac{v_A}{R_0}\\right)^2 \\left| \\frac{dD}{dr}\\bigg|_{r=r^\\star} \\right|^{-1},$$ which increases when the local slope of $D(\\omega,r)$ near the resonance is small. This index isolates the geometric and continuum-slope contribution to resonant absorption and is intended for sensitivity analysis rather than an absolute damping rate. Your task is to derive, from the given base relations, how to compute $r^\\star$ and $S_{\\mathrm{damp}}$ for a specified $q(r)$ and global $\\omega$, by identifying all possible resonances from the coupling between $j=m$ and $j=m+1$ harmonics and selecting the physically relevant resonance that produces the largest $S_{\\mathrm{damp}}$ (i.e., the strongest continuum damping sensitivity). For numerical robustness, if $|dq/dr|$ at the resonance vanishes, use a regularization floor $d_0$ for $|dq/dr|$ equal to $10^{-8}$ per meter when evaluating the slope. If no resonance exists within $r \\in [0,a]$ for the specified parameters, report the resonance location as $-1.0$ and the sensitivity index as $0.0$. Express the resonance location in meters and the sensitivity index as a dimensionless real number. The angular frequency $\\omega$ must be treated in radians per second.\n\nImplement a program that, given the parameters for four test cases, computes the resonance location $r^\\star$ and the sensitivity index $S_{\\mathrm{damp}}$ as follows:\n- Use the definitions of $v_A$, $k_\\parallel(r)$, and the resonance condition $\\omega^2 = v_A^2 k_\\parallel(r)^2$.\n- Identify candidate resonances by considering both $j=m$ and $j=m+1$, and both signs in the resonance condition for $k_\\parallel$ consistent with $\\omega^2 = v_A^2 k_\\parallel^2$. For each candidate, check if the corresponding $q$ value lies within the range of the given $q(r)$ on $[0,a]$. For valid candidates, compute the corresponding $r^\\star$ by inverting $q(r)$.\n- For each valid candidate $r^\\star$, compute the derivative $\\frac{dD}{dr}$ at $r^\\star$ using the chain rule and the provided forms for $k_\\parallel(r)$ and $q(r)$, and evaluate $S_{\\mathrm{damp}}$ using the regularization floor $d_0$ for $|dq/dr|$ if needed.\n- Select the candidate resonance that yields the largest $S_{\\mathrm{damp}}$ for reporting.\n\nUse the following test suite (all quantities in SI units unless otherwise stated):\n1. $R_0 = 3.0$, $a = 0.9$, $B_0 = 3.2$, $\\rho_0 = 2.0\\times 10^{-7}$, $q_0 = 1.1$, $q_s = 1.4$, $p = 2$, $m = 6$, $n = 6$, $\\omega = 1.0\\times 10^{6}$.\n2. $R_0 = 3.0$, $a = 0.9$, $B_0 = 3.2$, $\\rho_0 = 2.0\\times 10^{-7}$, $q_0 = 1.1$, $q_s = 1.4$, $p = 4$, $m = 6$, $n = 6$, $\\omega = 1.0\\times 10^{6}$.\n3. $R_0 = 3.0$, $a = 0.9$, $B_0 = 3.2$, $\\rho_0 = 2.0\\times 10^{-7}$, $q_0 = 1.1$, $q_s = 0.6$, $p = 1$, $m = 6$, $n = 6$, $\\omega = 1.0\\times 10^{6}$.\n4. $R_0 = 3.0$, $a = 0.9$, $B_0 = 3.2$, $\\rho_0 = 2.0\\times 10^{-7}$, $q_0 = 1.2$, $q_s = 1.8$, $p = 3$, $m = 8$, $n = 5$, $\\omega = 1.0\\times 10^{6}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where for each test case, you output the resonance location in meters (rounded to six decimal places) followed by the sensitivity index (rounded to six decimal places). For example, your output should have the form: \n\"[r1,S1,r2,S2,r3,S3,r4,S4]\".",
            "solution": "The problem is valid as it is scientifically grounded in the principles of MagnetoHydroDynamics (MHD) in fusion plasmas, is mathematically well-posed, and all necessary data and definitions are provided for a unique solution. We can therefore proceed with the derivation and algorithmic design.\n\nThe core task is to compute the resonance location $r^\\star$ and a sensitivity index $S_{\\mathrm{damp}}$ for Toroidal Alfvén Eigenmodes (TAEs) in a tokamak plasma. The solution is found by identifying all possible continuum resonances and selecting the one that maximizes $S_{\\mathrm{damp}}$, which corresponds to the strongest sensitivity to continuum damping.\n\nFirst, we establish the fundamental physical and geometric quantities. The plasma is characterized by its major radius $R_0$, minor radius $a$, magnetic field $B_0$, and mass density $\\rho_0$. The key velocity scale is the Alfvén speed, defined as:\n$$ v_A = \\frac{B_0}{\\sqrt{\\mu_0 \\rho_0}} $$\nwhere $\\mu_0$ is the vacuum permeability. The safety factor profile $q(r)$ is given by a monotonic function of the minor radius $r$:\n$$ q(r) = q_0 + q_s \\left(\\frac{r}{a}\\right)^p $$\nThe range of $q$ values within the plasma is therefore $[q(0), q(a)]$, which evaluates to $[q_0, q_0 + q_s]$. The parallel wavenumber $k_\\parallel$ for a mode with toroidal number $n$ and poloidal harmonics $j$ (where $j$ can be $m$ or $m+1$) is given in the large aspect ratio approximation as:\n$$ k_\\parallel(r) = \\frac{1}{R_0} \\left( n - \\frac{j}{q(r)} \\right) $$\nThe continuum resonance condition occurs when the global mode frequency $\\omega$ matches the local shear Alfvén continuum frequency $\\omega_A(r) = |k_\\parallel(r)| v_A$. The resonance condition is thus $\\omega^2 = \\omega_A(r)^2$, or:\n$$ \\omega^2 = v_A^2 k_\\parallel(r)^2 $$\nTaking the square root and noting that $\\omega  0$ and $v_A  0$, we get $\\omega = v_A |k_\\parallel(r)|$. Substituting the expression for $k_\\parallel(r)$:\n$$ \\omega = v_A \\left| \\frac{1}{R_0} \\left( n - \\frac{j}{q(r)} \\right) \\right| $$\nRearranging gives the condition on $q(r)$ at the resonance location $r^\\star$:\n$$ \\left| n - \\frac{j}{q(r^\\star)} \\right| = \\frac{\\omega R_0}{v_A} $$\nLet us define the dimensionless normalized frequency $\\Omega = \\omega R_0 / v_A$. The condition becomes $|n - j/q^\\star| = \\Omega$. This equation yields two possible solutions for $q^\\star$ for each value of $j$:\n1. $n - j/q^\\star = \\Omega \\implies q^\\star = \\frac{j}{n - \\Omega}$\n2. $n - j/q^\\star = -\\Omega \\implies q^\\star = \\frac{j}{n + \\Omega}$\n\nSince the problem involves coupling between poloidal harmonics $m$ and $m+1$, we must consider both $j=m$ and $j=m+1$. This leads to a total of four potential candidate values for the safety factor at a resonance, which we denote $q^\\star_{\\text{cand}}$. A candidate resonance is physically possible only if its corresponding $q^\\star_{\\text{cand}}$ falls within the physical range of the safety factor profile, i.e., $q_0 \\le q^\\star_{\\text{cand}} \\le q_0 + q_s$.\n\nFor each valid $q^\\star$ that satisfies this condition, we can find the corresponding resonance radius $r^\\star$ by inverting the $q(r)$ profile equation:\n$$ q^\\star = q_0 + q_s \\left(\\frac{r^\\star}{a}\\right)^p \\implies r^\\star = a \\left( \\frac{q^\\star - q_0}{q_s} \\right)^{1/p} $$\nThe condition $q_0 \\le q^\\star \\le q_0 + q_s$ ensures that $0 \\le r^\\star \\le a$.\n\nNext, we derive the expression for the sensitivity index $S_{\\mathrm{damp}}$. It is defined as:\n$$ S_{\\mathrm{damp}} = \\left(\\frac{v_A}{R_0}\\right)^2 \\left| \\frac{dD}{dr}\\bigg|_{r=r^\\star} \\right|^{-1} $$\nwhere $D(\\omega,r) = \\omega^2 - v_A^2 k_\\parallel(r)^2$. We compute the derivative of $D$ with respect to $r$ using the chain rule.\n$$ \\frac{dD}{dr} = -v_A^2 \\frac{d}{dr} \\left( k_\\parallel(r)^2 \\right) = -2 v_A^2 k_\\parallel(r) \\frac{dk_\\parallel}{dr} $$\nThe derivative of $k_\\parallel(r)$ is:\n$$ \\frac{dk_\\parallel}{dr} = \\frac{d}{dr} \\left[ \\frac{1}{R_0} \\left( n - \\frac{j}{q(r)} \\right) \\right] = \\frac{j}{R_0 q(r)^2} \\frac{dq}{dr} $$\nSubstituting this back, we get:\n$$ \\frac{dD}{dr} = -2 v_A^2 k_\\parallel(r) \\frac{j}{R_0 q(r)^2} \\frac{dq}{dr} $$\nAt the resonance location $r^\\star$, we have $k_\\parallel(r^\\star) = \\pm \\omega / v_A$. Substituting this and $q(r^\\star) = q^{\\star}$:\n$$ \\frac{dD}{dr}\\bigg|_{r=r^\\star} = -2 v_A^2 \\left( \\pm \\frac{\\omega}{v_A} \\right) \\frac{j}{R_0 (q^\\star)^2} \\frac{dq}{dr}\\bigg|_{r=r^\\star} = \\mp \\frac{2 v_A \\omega j}{R_0 (q^\\star)^2} \\frac{dq}{dr}\\bigg|_{r=r^\\star} $$\nThe sensitivity index depends on the magnitude of this slope:\n$$ \\left| \\frac{dD}{dr}\\bigg|_{r=r^\\star} \\right| = \\frac{2 v_A \\omega j}{R_0 (q^\\star)^2} \\left| \\frac{dq}{dr}\\bigg|_{r=r^\\star} \\right| $$\nSubstituting this into the definition of $S_{\\mathrm{damp}}$:\n$$ S_{\\mathrm{damp}} = \\left(\\frac{v_A}{R_0}\\right)^2 \\left( \\frac{2 v_A \\omega j}{R_0 (q^\\star)^2} \\left| \\frac{dq}{dr}\\bigg|_{r=r^\\star} \\right| \\right)^{-1} = \\frac{v_A^2}{R_0^2} \\frac{R_0 (q^\\star)^2}{2 v_A \\omega j \\left| \\frac{dq}{dr}\\bigg|_{r=r^\\star} \\right|} $$\nSimplifying yields the final expression for the sensitivity index:\n$$ S_{\\mathrm{damp}} = \\frac{v_A (q^\\star)^2}{2 R_0 \\omega j \\left| \\frac{dq}{dr}\\bigg|_{r=r^\\star} \\right|} $$\nTo evaluate this, we need the derivative of the safety factor profile:\n$$ \\frac{dq}{dr} = \\frac{d}{dr} \\left[ q_0 + q_s \\left(\\frac{r}{a}\\right)^p \\right] = q_s \\frac{p r^{p-1}}{a^p} $$\nThe problem specifies a regularization for the case where this derivative vanishes. This can happen at $r^\\star=0$ if $p  1$. Per the problem, if $|\\frac{dq}{dr}|_{r=r^\\star}$ is zero, we must use a floor value $d_0 = 10^{-8} \\, \\text{m}^{-1}$.\n\nThe overall algorithm is as follows:\n1. For a given set of parameters, calculate the constant terms $v_A$ and $\\Omega$.\n2. Determine the physical range of the safety factor, $[q_0, q_0 + q_s]$.\n3. Initialize the best found resonance as $(r^\\star, S_{\\mathrm{damp}}) = (-1.0, 0.0)$.\n4. Iterate through the two relevant poloidal harmonics, $j \\in \\{m, m+1\\}$.\n5. For each $j$, calculate the two candidate $q^\\star$ values from $q^\\star = j/(n \\pm \\Omega)$.\n6. For each candidate $q^\\star$, check if it lies within the physical range $[q_0, q_0 + q_s]$.\n7. If a candidate $q^\\star$ is valid:\n    a. Compute the resonance radius $r^\\star$ by inverting the $q(r)$ profile.\n    b. Compute the derivative $|\\frac{dq}{dr}|_{r=r^\\star}$ and apply the regularization floor $d_0$ if necessary.\n    c. Compute the sensitivity index $S_{\\mathrm{damp}}$ using the derived formula.\n    d. If the computed $S_{\\mathrm{damp}}$ is greater than the current maximum, update the best found resonance to the new $(r^\\star, S_{\\mathrm{damp}})$.\n8. After checking all four candidates, the stored $(r^\\star, S_{\\mathrm{damp}})$ is the result for the given parameters. If no valid resonances were found, the initial values of $(-1.0, 0.0)$ are the correct result.\nThis procedure ensures we identify all possible resonances and select the one with the maximum sensitivity index as required.",
            "answer": "```python\nimport numpy as np\nfrom scipy.constants import mu_0\n\ndef solve():\n    \"\"\"\n    Solves for the TAE resonance location and damping sensitivity index\n    for a suite of test cases.\n    \"\"\"\n\n    # Test cases defined in the problem statement\n    # R0, a, B0, rho0, q0, qs, p, m, n, omega\n    test_cases = [\n        (3.0, 0.9, 3.2, 2.0e-7, 1.1, 1.4, 2, 6, 6, 1.0e6),\n        (3.0, 0.9, 3.2, 2.0e-7, 1.1, 1.4, 4, 6, 6, 1.0e6),\n        (3.0, 0.9, 3.2, 2.0e-7, 1.1, 0.6, 1, 6, 6, 1.0e6),\n        (3.0, 0.9, 3.2, 2.0e-7, 1.2, 1.8, 3, 8, 5, 1.0e6),\n    ]\n\n    results = []\n    d0 = 1.0e-8  # Regularization floor for |dq/dr|\n\n    for params in test_cases:\n        R0, a, B0, rho0, q0, qs, p, m, n, omega = params\n\n        # Initialize results for this case\n        best_r_star = -1.0\n        max_S_damp = 0.0\n\n        # Step 1: Calculate ancillary quantities\n        v_A = B0 / np.sqrt(mu_0 * rho0)\n        Omega = omega * R0 / v_A\n        q_min, q_max = q0, q0 + qs\n\n        # Step 2: Iterate through harmonics j=m and j=m+1\n        for j in [m, m + 1]:\n            # Step 3: Calculate candidate q_star values\n            q_star_candidates = []\n            if not np.isclose(n - Omega, 0):\n                q_star_candidates.append(j / (n - Omega))\n            if not np.isclose(n + Omega, 0):\n                q_star_candidates.append(j / (n + Omega))\n\n            for q_star in q_star_candidates:\n                # Step 4: Check if candidate is in the physical range\n                if q_min = q_star = q_max:\n                    # This is a valid resonance\n                    # Step 5a: Compute resonance radius r_star\n                    if np.isclose(qs, 0): continue # Avoid division by zero if qs is zero\n                    \n                    # Handle r_star=0 case where q_star=q0\n                    if np.isclose(q_star, q0):\n                        r_star = 0.0\n                    else:\n                        r_star = a * ((q_star - q0) / qs)**(1.0 / p)\n\n                    # Step 5b: Compute |dq/dr| with regularization\n                    if np.isclose(r_star, 0.0) and p  1:\n                        dqdr_val = 0.0\n                    else:\n                        # This can produce inf if r_star=0 and 0p1, but not for given test cases\n                        dqdr_val = qs * p * r_star**(p - 1) / a**p\n                    \n                    dqdr_abs = max(np.abs(dqdr_val), d0)\n\n                    # Step 5c: Compute sensitivity index S_damp\n                    numerator = v_A * q_star**2\n                    denominator = 2 * R0 * omega * j * dqdr_abs\n                    if np.isclose(denominator, 0): continue # Should be prevented by dqdr_abs  d0\n                    \n                    S_damp = numerator / denominator\n\n                    # Step 5d: Update if this is the best resonance found so far\n                    if S_damp  max_S_damp:\n                        max_S_damp = S_damp\n                        best_r_star = r_star\n\n        results.extend([f\"{best_r_star:.6f}\", f\"{max_S_damp:.6f}\"])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}