{
    "hands_on_practices": [
        {
            "introduction": "理论与实践的结合是计算物理学的核心。一个关键的技能是从数值模拟数据中提取物理参数。这个练习将引导你完成一项基本任务：从等离子体波的时间序列输出中测量其阻尼率，将复频率的抽象概念与具体的测量过程联系起来。通过这个练习，你将学会如何从模拟的振荡信号中量化阻尼，这是分析磁流体力学（MHD）不稳定性的基础。",
            "id": "4040061",
            "problem": "考虑在线性磁流体力学（MHD）框架下，对非均匀磁化等离子体中单一、主导的阿尔芬振荡进行的​​一次时域模拟。由于被阿尔芬连续谱共振吸收，该模式发生阻尼。某一固定空间点上的时间信号被建模为具有复角频率的单模响应，其中可观测的位移或磁场扰动可以很好地用一个 $x(t)$ 形式的函数来近似，其主导阶的时间依赖性来自于一个满足 $\\omega = \\omega_{R} - i \\gamma$ 的本征频率 $\\omega$，其中 $\\omega_{R} > 0$ 是实振荡频率，$\\gamma > 0$ 是阻尼率。假设处于弱阻尼情况 $\\gamma / \\omega_{R} \\ll 1$，并且在多个周期内，单个傅里叶模式在测量响应中占主导地位，因此模式拍频和啁啾在主导阶上可以忽略不计。\n\n通过提取 $|x(t)|$ 在时间 $\\{t_{n}\\}$ 上的连续局部极大值 $\\{A_{n}\\}$，并将任意连续周期的逐周期对数衰减率 $\\delta$ 定义为 $\\delta = \\ln\\!\\left(\\frac{A_{n}}{A_{n+1}}\\right)$。从一个与MHD简正模理论和小 $\\gamma$ 假设相符的有效线性响应基础出发，推导出用实振荡频率 $\\omega_{R}$ 表示的 $\\delta$ 和 $\\gamma$ 之间的关系。简要说明从模拟的时间序列 $x(t)$ 中数值提取 $\\gamma$ 所需的概念性步骤，包括如何确定 $\\omega_{R}$ 以及在计算 $\\delta$ 时如何减小数值偏差。\n\n请以单一闭式解析表达式的形式，给出用 $\\delta$ 和 $\\omega_{R}$ 表示 $\\gamma$ 的最终答案。无需进行数值计算。",
            "solution": "该问题基于线性磁流体力学（MHD）的既定原理和阻尼振荡理论，具有科学依据，提法恰当且客观。所有提供的信息都是自洽且一致的，允许进行严格的推导。因此，该问题是有效的，可以构建解答。\n\n单个线性阻尼MHD模式的时间演化可以用以下形式的复位移或场扰动 $z(t)$ 来表示：\n$$z(t) = C \\exp(-i\\omega t)$$\n其中 $C$ 是复振幅，$\\omega$ 是该模式的复角频率。问题陈述 $\\omega = \\omega_{R} - i \\gamma$，其中 $\\omega_{R} > 0$ 是实振荡频率，$\\gamma > 0$ 是阻尼率。\n\n将复频率代入 $z(t)$ 的表达式，我们得到：\n$$z(t) = C \\exp(-i(\\omega_{R} - i\\gamma) t) = C \\exp(-i\\omega_{R}t - \\gamma t) = C \\exp(-\\gamma t) \\exp(-i\\omega_{R}t)$$\n一个可观测的物理量，例如位移 $x(t)$，是 $z(t)$ 的实部。设复常数 $C$ 用极坐标形式表示为 $C = A_{0} \\exp(i\\phi_{0})$，其中 $A_0$ 是一个实的正初始振幅，$\\phi_{0}$ 是一个初始相位。\n$$z(t) = A_{0} \\exp(i\\phi_{0}) \\exp(-\\gamma t) \\exp(-i\\omega_{R}t) = A_0 \\exp(-\\gamma t) \\exp(i(\\phi_{0} - \\omega_{R}t))$$\n取实部可得到可观测信号：\n$$x(t) = \\text{Re}[z(t)] = A_{0} \\exp(-\\gamma t) \\cos(\\omega_{R}t - \\phi_{0})$$\n该方程描述了一个角频率为 $\\omega_{R}$ 的正弦振荡，其振幅随时间指数衰减。振幅包络由 $A(t) = A_{0} \\exp(-\\gamma t)$ 给出。\n\n问题基于 $|x(t)|$ 的连续局部极大值 $\\{A_n\\}$ 来定义对数衰减率 $\\delta$。量 $A_n$ 是在时间 $t_n$ 出现的第 $n$ 个峰值的振幅。“逐周期”这个术语意味着我们在比较相隔一个完整振荡周期 $T_{R} = 2\\pi / \\omega_{R}$ 的两个连续峰值的振幅。\n\n设 $A_n$ 是在时间 $t_n$ 的一个峰值的振幅。下一个对应的峰值（例如，下一个正极大值）将在一个周期后出现，时间为 $t_{n+1} \\approx t_n + T_R$。这些峰值的振幅由包络 $A(t)$ 在这些时间点的值给出。在问题指定的弱阻尼情况 $\\gamma / \\omega_{R} \\ll 1$ 下，这是一个极好的近似，因为在一个周期内阻尼很慢。一个更严谨的计算会涉及通过将 $x(t)$ 的导数设为零来寻找其极值，这会显示出峰值时间存在一个量级为 $\\gamma/\\omega_R^2$ 的微小偏移。然而，由此对最终关系式产生的修正在弱阻尼假设下量级为 $(\\gamma/\\omega_R)^2$，可以忽略不计。\n\n因此，我们可以陈述：\n$$A_{n} = A(t_n) = A_{0} \\exp(-\\gamma t_{n})$$\n$$A_{n+1} = A(t_{n+1}) = A(t_{n} + T_{R}) = A_{0} \\exp(-\\gamma (t_{n} + T_{R}))$$\n这两个连续振幅的比值为：\n$$\\frac{A_{n}}{A_{n+1}} = \\frac{A_{0} \\exp(-\\gamma t_{n})}{A_{0} \\exp(-\\gamma t_{n} - \\gamma T_{R})} = \\frac{\\exp(-\\gamma t_{n})}{\\exp(-\\gamma t_{n}) \\exp(-\\gamma T_{R})} = \\exp(\\gamma T_{R})$$\n对数衰减率 $\\delta$ 定义为该比值的自然对数：\n$$\\delta = \\ln\\left(\\frac{A_{n}}{A_{n+1}}\\right) = \\ln(\\exp(\\gamma T_{R})) = \\gamma T_{R}$$\n代入周期表达式 $T_{R} = 2\\pi / \\omega_{R}$，我们得到 $\\delta$、$\\gamma$ 和 $\\omega_{R}$ 之间的关系：\n$$\\delta = \\gamma \\frac{2\\pi}{\\omega_{R}}$$\n解出阻尼率 $\\gamma$ 即可得到最终表达式：\n$$\\gamma = \\frac{\\delta \\omega_{R}}{2\\pi}$$\n为了从模拟的时间序列 $x(t)$ 中数值提取 $\\gamma$，需要以下概念性步骤：\n1.  **确定实频率 $\\omega_{R}$**：可以通过对时间序列 $x(t)$ 应用快速傅里叶变换（FFT）并识别功率谱 $|\\tilde{x}(\\omega)|^2$ 达到峰值的频率来找到主导实频率 $\\omega_{R}$。或者，也可以测量连续正峰值或过零点之间的平均时间间隔以求出周期 $T_{R}$，然后计算 $\\omega_{R} = 2\\pi/T_{R}$。\n\n2.  **确定对数衰减率 $\\delta$**：需要一种稳健的方法来减小由噪声或其他伪影引起的数值偏差。不应仅使用两个连续的峰值，而应首先识别出时间序列中所有的正局部极大值 $\\{A_n\\}$。根据关系式 $A_n \\approx A_0 \\exp(-\\gamma n T_R)$，绘制 $\\ln(A_n)$ 关于周期数 $n$ 的图应该得到一条直线。这条线的斜率是 $m = -\\gamma T_R$。对数衰减率是每个周期的振幅减少量，因此 $\\delta = -m = \\gamma T_R$。对数据点 $(n, \\ln(A_n))$ 进行线性最小二乘拟合，可以为斜率 $m$ 提供一个统计上稳健的估计，从而也为 $\\delta$ 提供了估计。这种基于回归的方法在多个周期上进行平均，比两点估计要精确得多。\n\n3.  **计算阻尼率 $\\gamma$**：利用数值确定的 $\\delta$ 和 $\\omega_{R}$ 的值，使用推导出的公式 $\\gamma = \\delta \\omega_{R} / (2\\pi)$ 来计算阻尼率。",
            "answer": "$$\\boxed{\\gamma = \\frac{\\delta \\omega_{R}}{2\\pi}}$$"
        },
        {
            "introduction": "在学会了如何测量阻尼之后，理解其背后的物理机制至关重要。这个练习将深入到共振层内部，让你通过计算来确定被吸收的波能量如何在粘性耗散和电阻耗散通道之间分配。这个解析练习将为你提供一个关于共振吸收微观过程的清晰物理图像，阐明等离子体参数（如粘性系数 $\\nu$ 和电阻率 $\\eta$）在能量转换中的作用。",
            "id": "4040053",
            "problem": "考虑一个单色剪切-阿尔芬微扰入射到一维板状等离子体中的一个共振层上。该等离子体的平衡磁场为 $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{y}}$，质量密度为 $\\rho_{0}$，它们的变化足够缓慢以适用匹配渐近法。共振位于 $x=0$ 处。假设由于各向同性运动学粘性 $\\nu$ 和电阻率 $\\eta$ 存在弱但有限的耗散，并定义标准的内层坐标 $\\xi = x/\\delta$，其中 $\\delta$ 是耗散层的厚度标度。在内区，设领头阶切向速度和磁场微扰为奇函数，与剪切-阿尔芬极化以及跨越共振的光滑匹配相一致：\n$$\nv_{y}(x) = V\\,\\tanh\\!\\left(\\frac{x}{\\delta}\\right) \\quad\\text{and}\\quad b_{y}(x) = B\\,\\tanh\\!\\left(\\frac{x}{\\delta}\\right),\n$$\n其中 $V$ 和 $B$ 是由外区解和入射波设定的实振幅。\n\n使用磁流体力学（MHD）的坡印亭定理所蕴含的基本能量平衡，该定理指出，稳态下单位面积的吸收功率等于局域耗散密度在整个层上的积分。将局域耗散密度建模为\n$$\nQ_{\\mathrm{v}}(x) = \\rho_{0}\\,\\nu\\left|\\frac{\\partial v_{y}}{\\partial x}\\right|^{2}, \\qquad Q_{\\eta}(x) = \\eta\\,|\\mathbf{j}(x)|^{2},\n$$\n其中电流密度 $\\mathbf{j}$ 由无位移电流的安培定律 $\\,\\mu_{0}\\,\\mathbf{j} = \\nabla \\times \\mathbf{b}\\,$ 得到，因此在此几何构型中 $\\,j_{z}(x) = -\\frac{1}{\\mu_{0}}\\,\\frac{\\partial b_{y}}{\\partial x}\\,$。这里 $\\mu_{0}$ 是真空磁导率。假设领头阶理想剪切-阿尔芬极化在内区逐点成立，将切向磁场和速度微扰联系起来：\n$$\nb_{y}(x) = \\pm \\sqrt{\\mu_{0}\\,\\rho_{0}}\\,v_{y}(x),\n$$\n这与在共振处求值的线性化理想磁流体力学动量和感应方程一致。使用该关系式，用 $V$ 消去 $B$。\n\n通过对内坐标 $\\xi$ 积分，计算在粘性通道和电阻性通道中单位面积吸收的能量：\n$$\nE_{\\mathrm{v}} = \\int_{-\\infty}^{\\infty} Q_{\\mathrm{v}}(x)\\,dx, \\qquad E_{\\eta} = \\int_{-\\infty}^{\\infty} Q_{\\eta}(x)\\,dx,\n$$\n然后确定能量分配，即以下分数：\n$$\nf_{\\mathrm{v}} = \\frac{E_{\\mathrm{v}}}{E_{\\mathrm{v}}+E_{\\eta}}, \\qquad f_{\\eta} = \\frac{E_{\\eta}}{E_{\\mathrm{v}}+E_{\\eta}}.\n$$\n将您的最终答案表示为仅含 $\\nu$、$\\eta$ 和 $\\mu_{0}$ 的精确解析表达式。这些分数是无量纲的；不要使用百分号。将两个分数一起作为最终答案给出。",
            "solution": "首先将根据指定程序验证问题陈述。\n\n### 步骤1：提取给定条件\n- **平衡：** 一维板状等离子体，磁场为 $\\mathbf{B}_{0} = B_{0}\\,\\hat{\\mathbf{y}}$，质量密度为 $\\rho_{0}$。\n- **共振位置：** 共振位于 $x=0$ 处。\n- **耗散：** 各向同性运动学粘性 $\\nu$ 和电阻率 $\\eta$。\n- **内层坐标：** $\\xi = x/\\delta$，其中 $\\delta$ 是耗散层厚度。\n- **微扰剖面：** 领头阶切向速度和磁场微扰由下式给出：\n  $$\n  v_{y}(x) = V\\,\\tanh\\!\\left(\\frac{x}{\\delta}\\right)\n  $$\n  $$\n  b_{y}(x) = B\\,\\tanh\\!\\left(\\frac{x}{\\delta}\\right)\n  $$\n  其中 $V$ 和 $B$ 是实振幅。\n- **耗散密度：**\n  $$\n  Q_{\\mathrm{v}}(x) = \\rho_{0}\\,\\nu\\left|\\frac{\\partial v_{y}}{\\partial x}\\right|^{2}\n  $$\n  $$\n  Q_{\\eta}(x) = \\eta\\,|\\mathbf{j}(x)|^{2}\n  $$\n- **电流密度：** 根据安培定律 $\\mu_{0}\\,\\mathbf{j} = \\nabla \\times \\mathbf{b}$，在此几何构型下可得：\n  $$\n  j_{z}(x) = -\\frac{1}{\\mu_{0}}\\,\\frac{\\partial b_{y}}{\\partial x}\n  $$\n- **理想MHD极化关系：** 在共振处，微扰由以下关系联系：\n  $$\n  b_{y}(x) = \\pm \\sqrt{\\mu_{0}\\,\\rho_{0}}\\,v_{y}(x)\n  $$\n- **待计算量：**\n  1.  粘性通道中单位面积的总吸收能量：\n      $$\n      E_{\\mathrm{v}} = \\int_{-\\infty}^{\\infty} Q_{\\mathrm{v}}(x)\\,dx\n      $$\n  2.  电阻性通道中单位面积的总吸收能量：\n      $$\n      E_{\\eta} = \\int_{-\\infty}^{\\infty} Q_{\\eta}(x)\\,dx\n      $$\n  3.  能量分配分数：\n      $$\n      f_{\\mathrm{v}} = \\frac{E_{\\mathrm{v}}}{E_{\\mathrm{v}}+E_{\\eta}}, \\qquad f_{\\eta} = \\frac{E_{\\eta}}{E_{\\mathrm{v}}+E_{\\eta}}\n      $$\n- **最终表达式：** 分数 $f_{\\mathrm{v}}$ 和 $f_{\\eta}$ 应仅用 $\\nu$、$\\eta$ 和 $\\mu_{0}$ 表示。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学依据：** 该问题描述了MHD中剪切-阿尔芬波的共振吸收，这是等离子体物理和聚变科学中的一个基石性课题。耗散方程和模型剖面是文献中用于分析此类现象的标准表示，尤其是在匹配渐近展开的框架内。该问题在根本上是合理的。\n- **适定性：** 该问题提供了计算所需量的所有必要信息。剖面已给出，耗散模型是明确的，场之间的关系也已提供。积分是良定义的且收敛。存在唯一且有意义的解。\n- **客观性：** 问题使用标准的物理和数学符号以精确、定量的术语陈述。没有主观或基于观点的陈述。\n\n### 步骤3：结论与行动\n问题有效。它具有科学依据、自洽且适定。可以进行求解过程。\n\n### 解题推导\n\n目标是计算能量分配分数 $f_{\\mathrm{v}}$ 和 $f_{\\eta}$。我们首先用内层坐标 $\\xi = x/\\delta$ 来表示耗散密度和总吸收能量的积分。\n\n1.  **用 $\\xi$ 表示微扰及其导数：**\n    给定的微扰是 $v_{y}(x) = V\\,\\tanh(x/\\delta)$ 和 $b_{y}(x) = B\\,\\tanh(x/\\delta)$。在内层坐标 $\\xi$ 中，它们是：\n    $$\n    v_{y}(\\xi) = V\\,\\tanh(\\xi)\n    $$\n    $$\n    b_{y}(\\xi) = B\\,\\tanh(\\xi)\n    $$\n    我们需要关于 $x$ 的空间导数。使用链式法则，$\\frac{\\partial}{\\partial x} = \\frac{d\\xi}{dx}\\frac{\\partial}{\\partial\\xi} = \\frac{1}{\\delta}\\frac{\\partial}{\\partial\\xi}$。\n    $$\n    \\frac{\\partial v_{y}}{\\partial x} = \\frac{1}{\\delta}\\frac{d}{d\\xi}\\left(V\\,\\tanh(\\xi)\\right) = \\frac{V}{\\delta}\\,\\mathrm{sech}^{2}(\\xi)\n    $$\n    $$\n    \\frac{\\partial b_{y}}{\\partial x} = \\frac{1}{\\delta}\\frac{d}{d\\xi}\\left(B\\,\\tanh(\\xi)\\right) = \\frac{B}{\\delta}\\,\\mathrm{sech}^{2}(\\xi)\n    $$\n\n2.  **构建耗散密度：**\n    粘性耗散密度为：\n    $$\n    Q_{\\mathrm{v}}(x) = \\rho_{0}\\,\\nu\\left|\\frac{\\partial v_{y}}{\\partial x}\\right|^{2} = \\rho_{0}\\,\\nu\\left|\\frac{V}{\\delta}\\,\\mathrm{sech}^{2}(\\xi)\\right|^{2} = \\frac{\\rho_{0}\\,\\nu\\,V^{2}}{\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi)\n    $$\n    电流密度为 $j_{z}(x) = -\\frac{1}{\\mu_{0}}\\frac{\\partial b_{y}}{\\partial x} = -\\frac{B}{\\mu_{0}\\delta}\\,\\mathrm{sech}^{2}(\\xi)$。\n    电阻性耗散密度为：\n    $$\n    Q_{\\eta}(x) = \\eta\\,|j_{z}(x)|^{2} = \\eta\\left|-\\frac{B}{\\mu_{0}\\delta}\\,\\mathrm{sech}^{2}(\\xi)\\right|^{2} = \\frac{\\eta\\,B^{2}}{\\mu_{0}^{2}\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi)\n    $$\n\n3.  **关联振幅 $B$ 和 $V$：**\n    问题提供了理想MHD极化关系 $b_{y}(x) = \\pm\\sqrt{\\mu_{0}\\rho_{0}}\\,v_{y}(x)$。这意味着 $B\\,\\tanh(x/\\delta) = \\pm\\sqrt{\\mu_{0}\\rho_{0}}\\,V\\,\\tanh(x/\\delta)$，从而给出了振幅之间的直接关系：$B = \\pm\\sqrt{\\mu_{0}\\rho_{0}}\\,V$。\n    由于在 $Q_{\\eta}$ 的表达式中 $B$ 是平方项，符号无关紧要。我们将 $B^{2} = (\\mu_{0}\\rho_{0})V^{2}$ 代入 $Q_{\\eta}$ 的表达式中：\n    $$\n    Q_{\\eta}(x) = \\frac{\\eta\\,(\\mu_{0}\\rho_{0}V^{2})}{\\mu_{0}^{2}\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi) = \\frac{\\eta\\,\\rho_{0}\\,V^{2}}{\\mu_{0}\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi)\n    $$\n\n4.  **计算总吸收能量 $E_{\\mathrm{v}}$ 和 $E_{\\eta}$：**\n    每个通道单位面积的总吸收能量可以通过对相应的耗散密度从 $x=-\\infty$ 到 $x=+\\infty$ 积分得到。我们使用 $dx = \\delta\\,d\\xi$ 将积分变量更改为 $\\xi$。$\\xi$ 的积分限也是 $-\\infty$ 到 $+\\infty$。\n    $$\n    E_{\\mathrm{v}} = \\int_{-\\infty}^{\\infty} Q_{\\mathrm{v}}(x)\\,dx = \\int_{-\\infty}^{\\infty} \\left(\\frac{\\rho_{0}\\,\\nu\\,V^{2}}{\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi)\\right) (\\delta\\,d\\xi) = \\frac{\\rho_{0}\\,\\nu\\,V^{2}}{\\delta} \\int_{-\\infty}^{\\infty} \\mathrm{sech}^{4}(\\xi)\\,d\\xi\n    $$\n    $$\n    E_{\\eta} = \\int_{-\\infty}^{\\infty} Q_{\\eta}(x)\\,dx = \\int_{-\\infty}^{\\infty} \\left(\\frac{\\eta\\,\\rho_{0}\\,V^{2}}{\\mu_{0}\\delta^{2}}\\,\\mathrm{sech}^{4}(\\xi)\\right) (\\delta\\,d\\xi) = \\frac{\\eta\\,\\rho_{0}\\,V^{2}}{\\mu_{0}\\delta} \\int_{-\\infty}^{\\infty} \\mathrm{sech}^{4}(\\xi)\\,d\\xi\n    $$\n    两个表达式都依赖于定积分 $\\int_{-\\infty}^{\\infty} \\mathrm{sech}^{4}(\\xi)\\,d\\xi$。我们来计算它。\n    $\\mathrm{sech}^{4}(\\xi)$ 的不定积分可以通过换元法 $u=\\tanh(\\xi)$ 得到，其中 $du = \\mathrm{sech}^{2}(\\xi)\\,d\\xi$，以及恒等式 $\\mathrm{sech}^{2}(\\xi) = 1-\\tanh^{2}(\\xi)$：\n    $$\n    \\int \\mathrm{sech}^{4}(\\xi)\\,d\\xi = \\int \\mathrm{sech}^{2}(\\xi)\\,\\mathrm{sech}^{2}(\\xi)\\,d\\xi = \\int (1-\\tanh^{2}(\\xi))\\,\\mathrm{sech}^{2}(\\xi)\\,d\\xi = \\int (1-u^{2})\\,du = u - \\frac{u^{3}}{3} + C\n    $$\n    代回 $u=\\tanh(\\xi)$，我们得到 $\\tanh(\\xi) - \\frac{1}{3}\\tanh^{3}(\\xi) + C$。\n    现在，我们计算该定积分：\n    $$\n    \\int_{-\\infty}^{\\infty} \\mathrm{sech}^{4}(\\xi)\\,d\\xi = \\left[\\tanh(\\xi) - \\frac{1}{3}\\tanh^{3}(\\xi)\\right]_{-\\infty}^{\\infty}\n    $$\n    当 $\\xi \\to \\infty$ 时，$\\tanh(\\xi) \\to 1$。当 $\\xi \\to -\\infty$ 时，$\\tanh(\\xi) \\to -1$。\n    $$\n    \\int_{-\\infty}^{\\infty} \\mathrm{sech}^{4}(\\xi)\\,d\\xi = \\left(1 - \\frac{1}{3}(1)^{3}\\right) - \\left(-1 - \\frac{1}{3}(-1)^{3}\\right) = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n    $$\n    将此结果代回 $E_{\\mathrm{v}}$ 和 $E_{\\eta}$ 的表达式中：\n    $$\n    E_{\\mathrm{v}} = \\frac{\\rho_{0}\\,\\nu\\,V^{2}}{\\delta} \\left(\\frac{4}{3}\\right)\n    $$\n    $$\n    E_{\\eta} = \\frac{\\eta\\,\\rho_{0}\\,V^{2}}{\\mu_{0}\\delta} \\left(\\frac{4}{3}\\right)\n    $$\n\n5.  **计算能量分配分数：**\n    总吸收能量为 $E_{\\mathrm{total}} = E_{\\mathrm{v}} + E_{\\eta}$。\n    $$\n    E_{\\mathrm{total}} = \\frac{4}{3}\\frac{\\rho_{0}\\,V^{2}}{\\delta}\\left(\\nu + \\frac{\\eta}{\\mu_{0}}\\right)\n    $$\n    粘性分数为：\n    $$\n    f_{\\mathrm{v}} = \\frac{E_{\\mathrm{v}}}{E_{\\mathrm{v}}+E_{\\eta}} = \\frac{\\frac{4}{3}\\frac{\\rho_{0}\\,\\nu\\,V^{2}}{\\delta}}{\\frac{4}{3}\\frac{\\rho_{0}\\,V^{2}}{\\delta}\\left(\\nu + \\frac{\\eta}{\\mu_{0}}\\right)} = \\frac{\\nu}{\\nu + \\frac{\\eta}{\\mu_{0}}}\n    $$\n    电阻性分数为：\n    $$\n    f_{\\eta} = \\frac{E_{\\eta}}{E_{\\mathrm{v}}+E_{\\eta}} = \\frac{\\frac{4}{3}\\frac{\\eta\\,\\rho_{0}\\,V^{2}}{\\mu_{0}\\delta}}{\\frac{4}{3}\\frac{\\rho_{0}\\,V^{2}}{\\delta}\\left(\\nu + \\frac{\\eta}{\\mu_{0}}\\right)} = \\frac{\\frac{\\eta}{\\mu_{0}}}{\\nu + \\frac{\\eta}{\\mu_{0}}}\n    $$\n    作为检验，$f_{\\mathrm{v}} + f_{\\eta} = \\frac{\\nu + \\frac{\\eta}{\\mu_{0}}}{\\nu + \\frac{\\eta}{\\mu_{0}}} = 1$。参数 $\\rho_{0}$、$V$ 和 $\\delta$ 都消掉了，这对于一个分配比率是符合预期的。\n\n    为简化表达式并避免嵌套分数，我们可以将分子和分母同乘以 $\\mu_{0}$：\n    $$\n    f_{\\mathrm{v}} = \\frac{\\nu\\,\\mu_{0}}{\\nu\\,\\mu_{0} + \\eta}\n    $$\n    $$\n    f_{\\eta} = \\frac{\\eta}{\\nu\\,\\mu_{0} + \\eta}\n    $$\n    这些就是能量分配分数的最终表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\nu \\mu_0}{\\nu \\mu_0 + \\eta}  \\frac{\\eta}{\\nu \\mu_0 + \\eta}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理解一个物理过程的最终目标往往是为了能够控制它。这项高级实践将挑战你运用共振吸收的知识来解决一个真实的设计问题：通过优化等离子体剖面来最小化连续谱阻尼。这是一个对于提高聚变装置稳定性至关重要的任务，它将分析与综合相结合，代表了从理解到工程设计的飞跃。",
            "id": "4040011",
            "problem": "考虑一个大环径比、圆形截面的环形等离子体的柱状模型，该模型在线性理想磁流体力学（MHD）框架下支持剪切阿尔芬波。设大半径归一化为 $R_0 = 1$，所有频率、速度和长度均以与 $R_0 = 1$ 和轴上阿尔芬速度归一化相一致的无量纲单位表示。一个目标全局模式具有给定的角向和环向整数 $m$ 和 $n$，以及一个实频率 $\\,\\omega_0\\,$。在此几何构型中，平行波数为 $\\,k_\\parallel(r) = \\left(n - \\frac{m}{q(r)}\\right) / R_0 = n - \\frac{m}{q(r)}\\,$，局域剪切阿尔芬连续谱频率为 $\\,\\omega_A(r) = \\left|\\,n - \\frac{m}{q(r)}\\,\\right|\\, v_A(r)\\,$。当 $\\,\\omega_0\\,$ 在一个或多个半径 $\\,r_a\\,$ 处与 $\\,\\omega_A(r)\\,$ 发生共振时，即满足 $\\,\\omega_A(r_a) = \\omega_0\\,$，会产生连续谱阻尼，这会形成一个内部奇异层，必须与外部正则解相匹配。\n\n请您使用匹配渐近分析推导一个可计算的连续谱阻尼泛函表达式，程序将通过调整安全因子剖面 $\\,q(r)\\,$ 和阿尔芬速度剖面 $\\,v_A(r)\\,$ 来最小化该泛函，同时满足以下约束条件。推导必须从线性化理想 MHD 方程、剪切阿尔芬连续谱 $\\,\\omega_A(r)\\,$ 的定义以及共振条件 $\\,\\omega_A(r_a) = \\omega_0\\,$ 出发。基于这些基础，推导出一个关于阻尼泛函的主导阶表达式，该表达式是所有共振半径上贡献的总和，且仅依赖于 $\\,r_a\\,$ 处的局域量和 $\\,\\omega_A(r)\\,$ 的局域梯度。然后，将该表达式具体化为以下允许的参数形式：\n- $\\,q(r) = q_0 + \\alpha\\, r^2\\,$，\n- $\\,v_A(r) = v_{A0}\\,\\left(1 + \\beta\\, r^2\\right)\\,$，\n并带有约束 $\\,q(r) \\ge q_{\\min}\\,$ 和 $\\,v_A(r) \\ge v_{A,\\min}\\,$ 对所有 $\\,r \\in [0,1]\\,$ 成立，以确保在优化域内剖面是物理上合理、单调且为正值的。参数 $\\,q_0\\,$ 和 $\\,v_{A0}\\,$ 是正常数，形变参数 $\\,\\alpha\\,$ 和 $\\,\\beta\\,$ 在指定区间内变化。您推导的阻尼泛函必须完全用 $\\,m\\,$, $\\,n\\,$, $\\,\\omega_0\\,$, $\\,q_0\\,$, $\\,v_{A0}\\,$, $\\,\\alpha\\,$, $\\,\\beta\\,$ 以及在共振位置处求值的 $\\,q(r)\\,$ 和 $\\,v_A(r)\\,$ 的局域导数来表示。采用一个无量纲耦合系数 $\\,\\kappa  0\\,$ 来缩放总阻尼幅度，并假设每个测试案例中 $\\,\\kappa\\,$ 都是给定的。\n\n您的程序必须实现以下计算步骤：\n1. 对于给定的 $\\,m\\,$, $\\,n\\,$, $\\,\\omega_0\\,$, $\\,q_0\\,$, $\\,v_{A0}\\,$, $\\,\\alpha\\,$ 和 $\\,\\beta\\,$，找出所有满足 $\\,\\omega_A(r_a) = \\omega_0\\,$ 的共振半径 $\\,r_a \\in [0,1]\\,$。如果不存在 $\\,r_a\\,$，则该剖面的连续谱阻尼为零。\n2. 使用您推导的匹配渐近表达式，评估每个共振的阻尼贡献，并将它们相加以获得该剖面的总阻尼泛函。评估必须依赖于每个 $\\,r_a\\,$ 处的 $\\,\\omega_A(r)\\,$ 的径向梯度，该梯度用 $\\,q(r)\\,$ 和 $\\,v_A(r)\\,$ 的局域导数表示。\n3. 在指定边界内对允许的 $\\,(\\alpha,\\beta)\\,$ 进行均匀网格搜索，丢弃任何在某个 $\\,r \\in [0,1]\\,$ 处违反 $\\,q(r) \\ge q_{\\min}\\,$ 或 $\\,v_A(r) \\ge v_{A,\\min}\\,$ 约束的 $\\,(\\alpha,\\beta)\\,$ 对。在允许的 $\\,(\\alpha,\\beta)\\,$ 中，选择使总阻尼泛函最小化的那一对。如果多个对的结果相同，则选择 $\\,\\alpha\\,$ 最小的；如果仍然相同，则选择 $\\,\\beta\\,$ 最小的。\n4. 报告最优的 $\\,\\alpha\\,$、最优的 $\\,\\beta\\,$ 和最小化的阻尼值，均为浮点数。\n\n所有量都是无量纲的，因此不需要物理单位。角度不出现。将最终结果表示为浮点数。\n\n使用以下三个测试案例组成的测试套件，它们探究了典型、边界和边缘条件。对于所有案例，使用一个均匀的参数网格，其中 $\\,N_\\alpha = 31\\,$ 和 $\\,N_\\beta = 31\\,$ 个样本跨越指定区间，并使用一个在 $\\,[0,1]\\,$ 上有 $\\,N_r = 2001\\,$ 个均匀间隔点的径向搜索网格来框定共振点：\n\n- 案例 $\\,1\\,$（可能存在共振的典型形变窗口）：\n  - $\\,m = 2\\,$, $\\,n = 1\\,$, $\\,\\omega_0 = 0.6\\,$,\n  - $\\,q_0 = 1.5\\,$, $\\,v_{A0} = 1.0\\,$,\n  - $\\,\\alpha \\in [-0.3,\\,0.7]\\,$, $\\,\\beta \\in [-0.2,\\,0.4]\\,$,\n  - $\\,q_{\\min} = 0.8\\,$, $\\,v_{A,\\min} = 0.6\\,$,\n  - $\\,\\kappa = 0.01\\,$.\n\n- 案例 $\\,2\\,$（具有更广泛共振可能性的更高驱动）：\n  - $\\,m = 3\\,$, $\\,n = 2\\,$, $\\,\\omega_0 = 0.9\\,$,\n  - $\\,q_0 = 1.2\\,$, $\\,v_{A0} = 1.1\\,$,\n  - $\\,\\alpha \\in [-0.2,\\,0.6]\\,$, $\\,\\beta \\in [-0.3,\\,0.5]\\,$,\n  - $\\,q_{\\min} = 0.8\\,$, $\\,v_{A,\\min} = 0.6\\,$,\n  - $\\,\\kappa = 0.015\\,$.\n\n- 案例 $\\,3\\,$（在边界内可实现无共振的边缘条件）：\n  - $\\,m = 1\\,$, $\\,n = 1\\,$, $\\,\\omega_0 = 0.05\\,$,\n  - $\\,q_0 = 2.2\\,$, $\\,v_{A0} = 0.9\\,$,\n  - $\\,\\alpha \\in [-0.4,\\,0.4]\\,$, $\\,\\beta \\in [-0.4,\\,0.4]\\,$,\n  - $\\,q_{\\min} = 0.8\\,$, $\\,v_{A,\\min} = 0.6\\,$,\n  - $\\,\\kappa = 0.02\\,$.\n\n您的程序应生成一行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。对于每个案例，按顺序附加三个浮点数：最优的 $\\,\\alpha\\,$、最优的 $\\,\\beta\\,$ 和最小化的阻尼值。因此，最终输出必须是以下形式\n$[\\alpha_1,\\beta_1,D_1,\\alpha_2,\\beta_2,D_2,\\alpha_3,\\beta_3,D_3]$,\n其中 $\\,D_i\\,$ 表示案例 $\\,i\\,$ 的最小化阻尼泛函。",
            "solution": "该问题要求推导柱状等离子体模型中剪切阿尔芬波的阻尼泛函，然后对该泛函进行计算优化。\n\n### 步骤1：问题验证\n\n**1.1. 已知条件提取**\n- **模型：** 大环径比、圆形截面、柱状等离子体，线性理想 MHD。\n- **归一化：** 大半径 $R_0 = 1$，轴上阿尔芬速度归一化。\n- **波属性：** 全局模式，具有角向和环向模数 $m, n$。实频率 $\\omega_0$。\n- **关键定义：**\n    - 平行波数：$k_\\parallel(r) = (n - m/q(r)) / R_0 = n - m/q(r)$。\n    - 剪切阿尔芬连续谱频率：$\\omega_A(r) = |k_\\parallel(r)| v_A(r) = |n - m/q(r)| v_A(r)$。\n    - 共振条件：$\\omega_A(r_a) = \\omega_0$ 在一个或多个半径 $r_a$ 处成立。\n- **剖面参数化：**\n    - 安全因子：$q(r) = q_0 + \\alpha r^2$。\n    - 阿尔芬速度：$v_A(r) = v_{A0}(1 + \\beta r^2)$。\n- **约束条件：**\n    - 对于 $r \\in [0,1]$，$q(r) \\ge q_{\\min}$。\n    - 对于 $r \\in [0,1]$，$v_A(r) \\ge v_{A,\\min}$。\n    - $q_0  0$，$v_{A0}  0$。\n- **阻尼泛函：**\n    - 通过匹配渐近分析推导。\n    - 表示为对所有共振半径 $r_a$ 的求和。\n    - 依赖于 $r_a$ 处的局域量和梯度 $\\omega'_A(r_a)$。\n    - 由给定的无量纲耦合系数 $\\kappa  0$ 进行缩放。\n- **计算任务：**\n    1. 对于给定的参数，找到所有满足 $\\omega_A(r_a) = \\omega_0$ 的 $r_a \\in [0,1]$。\n    2. 通过对每个 $r_a$ 的贡献求和来评估总阻尼泛函。\n    3. 在 $(\\alpha, \\beta)$ 上执行均匀网格搜索，找到使阻尼泛函最小化并满足约束的参数对。\n    4. 结果相同时的取舍规则：若阻尼值相同，则选择最小的 $\\alpha$，然后选择最小的 $\\beta$。\n    5. 报告最优的 $(\\alpha, \\beta)$ 和最小化的阻尼值。\n- **测试案例和网格参数：**\n    - 在指定区间上取 $N_\\alpha = 31$, $N_\\beta = 31$ 个样本。\n    - 使用 $N_r = 2001$ 个径向网格点进行共振搜索。\n    - 提供了三个包含所有必要参数的具体测试案例。\n\n**1.2. 验证与结论**\n该问题在科学上基于成熟的磁流体力学（MHD）理论，特别是剪切阿尔芬波的共振吸收，这是等离子体物理学中的一个经典课题。安全因子 $q(r)$、阿尔芬速度 $v_A(r)$ 和剪切阿尔芬连续谱 $\\omega_A(r)$ 的概念都是基础性的。使用匹配渐近分析来量化连续谱阻尼是一种标准的理论技术。该问题定义清晰，提供了一个明确的目标（最小化一个泛函）、一个确定的参数搜索空间、明确的约束条件以及清晰的取舍规则，从而保证了在指定的离散搜索下有唯一解。语言客观且数学上精确。剖面的参数化形式是理论和计算研究中使用的标准简化表示。该问题是自洽的，并且在计算上是可行的。\n\n**结论：该问题是有效的。**\n\n### 步骤2：阻尼泛函的推导与计算算法\n\n**2.1. 理论基础**\n在理想 MHD 中，剪切阿尔芬波扰动的方程在任何径向位置 $r_a$ 处都会出现奇异性，只要驱动频率 $\\omega_0$ 与局域连续谱频率 $\\omega_A(r_a)$ 相匹配。这就是共振条件 $\\omega_0 = \\omega_A(r_a)$。在这一点上，来自全局波模式的能量被共振地转移到连续谱并通过相混合耗散，这一过程称为连续谱阻尼。\n\n一个完整的匹配渐近分析通过引入一个小的非理想项（如电阻率或粘性）或使用动理学理论来解决奇异性，然后取非理想项趋于零的极限。这个过程的结果是，“外部”理想解在奇异层处经历一个相移和相应的能量吸收。总吸收功率是阻尼的度量，它被发现是来自每个共振面的贡献之和。对于在 $r_a$ 处的单个共振，吸收的功率与一个耦合项（与共振处的本征函数振幅有关）的平方成正比，并与阿尔芬连续谱的局域剪切，即梯度 $\\omega'_A(r_a) = d\\omega_A/dr|_{r_a}$，成反比。\n\n该问题指导我们构建一个可计算的阻尼泛函 $D$，并由给定的耦合常数 $\\kappa$ 进行缩放。基于共振吸收的原理，该泛函可以表示为所有共振半径 $r_a$ 贡献的总和。每个共振的贡献与局域连续谱频率梯度的绝对值成反比。因此，我们将总阻尼泛函 $D$ 定义为：\n$$\nD = \\sum_{r_a} \\frac{\\kappa}{|\\omega'_A(r_a)|}\n$$\n这个形式抓住了本质物理：在连续谱频率剖面平坦（低剪切， $|\\omega'_A(r_a)| \\approx 0$）的地方发生强阻尼，而在剖面陡峭（高剪切，大的 $|\\omega'_A(r_a)|$）的地方发生弱阻尼。如果不存在共振，则求和为空， $D=0$。\n\n**2.2. 连续谱频率梯度的推导**\n为了计算 $D$，我们需要 $\\omega'_A(r) = d\\omega_A/dr$ 的显式表达式。我们从定义开始：\n$$\n\\omega_A(r) = \\left|n - \\frac{m}{q(r)}\\right| v_A(r)\n$$\n令 $g(r) = n - m/q(r)$。则 $\\omega_A(r) = |g(r)| v_A(r) = \\text{sgn}(g(r)) g(r) v_A(r)$。共振条件 $\\omega_A(r_a) = \\omega_0  0$ 意味着 $g(r_a) \\neq 0$。因此，在任何共振点 $r_a$ 的邻域内，符号函数 $\\text{sgn}(g(r))$ 是常数。我们可以使用乘法法则对 $\\omega_A(r)$ 求导：\n$$\n\\omega'_A(r) = \\frac{d}{dr} \\left[ \\text{sgn}(g(r)) g(r) v_A(r) \\right] = \\text{sgn}(g(r)) \\left[ g'(r) v_A(r) + g(r) v'_A(r) \\right]\n$$\n接下来，我们求 $g(r)$、$q(r)$ 和 $v_A(r)$ 的导数：\n- $q(r) = q_0 + \\alpha r^2 \\implies q'(r) = 2\\alpha r$\n- $v_A(r) = v_{A0}(1 + \\beta r^2) \\implies v'_A(r) = v_{A0}(2\\beta r)$\n- $g'(r) = \\frac{d}{dr}\\left(n - \\frac{m}{q(r)}\\right) = -m \\left(-\\frac{1}{q(r)^2}\\right) q'(r) = \\frac{m q'(r)}{q(r)^2}$\n\n将这些代入 $\\omega'_A(r)$ 的表达式中：\n$$\n\\omega'_A(r) = \\text{sgn}\\left(n - \\frac{m}{q(r)}\\right) \\left[ \\left(\\frac{m q'(r)}{q(r)^2}\\right) v_A(r) + \\left(n - \\frac{m}{q(r)}\\right) v'_A(r) \\right]\n$$\n这个表达式可以在每个共振半径 $r_a$ 处，使用给定的 $q(r)$ 和 $v_A(r)$ 及其导数的参数化形式进行计算。注意，如果共振发生在 $r_a=0$ 处，则 $q'(0)=0$ 和 $v'_A(0)=0$，这意味着 $\\omega'_A(0)=0$。在这种情况下，阻尼泛函 $D$ 变为无穷大，这种情况必须在计算中处理。这反映了线性模型在零剪切点的失效。\n\n**2.3. 计算算法**\n程序将为每个测试案例实现以下步骤：\n1.  **参数网格设置：** 使用 $N_\\alpha$ 和 $N_\\beta$ 个点，在其指定区间上为形变参数 $\\alpha$ 和 $\\beta$ 创建均匀网格。\n2.  **网格搜索：** 遍历所创建网格中的每一对 $(\\alpha, \\beta)$。\n    a.  **约束验证：** 对于当前的 $(\\alpha, \\beta)$，检查物理约束。由于剖面 $q(r)$ 和 $v_A(r)$ 在 $r \\in [0,1]$ 上是单调的，它们的最小值出现在 $r=0$ 或 $r=1$ 处。如果 $\\alpha  0$，检查 $q(1) = q_0 + \\alpha \\ge q_{\\min}$ 是否成立。如果 $\\beta  0$，检查 $v_A(1) = v_{A0}(1+\\beta) \\ge v_{A,\\min}$ 是否成立。如果违反了约束，则丢弃该 $(\\alpha, \\beta)$ 对。（同时假设输入的 $q_0$ 和 $v_{A0}$ 已满足约束 $q_0 \\ge q_{\\min}$ 和 $v_{A0} \\ge v_{A,\\min}$）。\n    b.  **共振点寻找：** 对于一个有效的 $(\\alpha, \\beta)$ 对，定义函数 $f(r) = \\omega_A(r) - \\omega_0$。在 $r \\in [0,1]$ 上搜索 $f(r)=0$ 的根。这通过在一个精细的径向网格（包含 $N_r$ 个点）上评估 $f(r)$，并识别函数变号的区间来完成。在这些区间内使用线性插值来准确定位每个 $r_a$。\n    c.  **阻尼计算：** 初始化总阻尼 $D_{tot} = 0$。对于每个找到的共振点 $r_a$：\n        i. 使用上面推导的公式计算 $\\omega'_A(r_a)$。\n        ii. 如果 $r_a \\approx 0$ 或 $|\\omega'_A(r_a)|$ 接近于零，则阻尼贡献为无穷大。将 $D_{tot}$ 设为无穷大并停止求和。\n        iii. 否则，将贡献 $\\kappa/|\\omega'_A(r_a)|$ 加到 $D_{tot}$ 上。\n        如果没有找到共振点，则 $D_{tot} = 0$。\n    d.  **最小化：** 将计算出的 $D_{tot}$ 与迄今为止找到的最小阻尼进行比较。如果找到了更小的阻尼，则更新最优的 $(\\alpha, \\beta)$ 和最小阻尼值。循环结构使得 $\\alpha$ 为外循环，$\\beta$ 为内循环，两者都从小到大迭代。一个简单的检查 `if current_damping  min_damping` 会自动满足指定的取舍规则（最小的 $\\alpha$，然后是最小的 $\\beta$）。\n3.  **输出：** 在检查完所有 $(\\alpha, \\beta)$ 对后，存储该案例的最优 $\\alpha$、最优 $\\beta$ 和最小阻尼值。对所有测试案例重复此过程，并将最终结果格式化为单行输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the MHD continuum damping optimization problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"m\": 2, \"n\": 1, \"omega0\": 0.6, \"q0\": 1.5, \"vA0\": 1.0,\n            \"alpha_range\": [-0.3, 0.7], \"beta_range\": [-0.2, 0.4],\n            \"q_min\": 0.8, \"vA_min\": 0.6, \"kappa\": 0.01,\n        },\n        {\n            \"m\": 3, \"n\": 2, \"omega0\": 0.9, \"q0\": 1.2, \"vA0\": 1.1,\n            \"alpha_range\": [-0.2, 0.6], \"beta_range\": [-0.3, 0.5],\n            \"q_min\": 0.8, \"vA_min\": 0.6, \"kappa\": 0.015,\n        },\n        {\n            \"m\": 1, \"n\": 1, \"omega0\": 0.05, \"q0\": 2.2, \"vA0\": 0.9,\n            \"alpha_range\": [-0.4, 0.4], \"beta_range\": [-0.4, 0.4],\n            \"q_min\": 0.8, \"vA_min\": 0.6, \"kappa\": 0.02,\n        },\n    ]\n\n    N_alpha = 31\n    N_beta = 31\n    N_r = 2001\n    \n    final_results = []\n    \n    for case in test_cases:\n        m, n, omega0 = case[\"m\"], case[\"n\"], case[\"omega0\"]\n        q0, vA0 = case[\"q0\"], case[\"vA0\"]\n        alpha_min, alpha_max = case[\"alpha_range\"]\n        beta_min, beta_max = case[\"beta_range\"]\n        q_min, vA_min = case[\"q_min\"], case[\"vA_min\"]\n        kappa = case[\"kappa\"]\n\n        alphas = np.linspace(alpha_min, alpha_max, N_alpha)\n        betas = np.linspace(beta_min, beta_max, N_beta)\n        r_grid = np.linspace(0.0, 1.0, N_r)\n        r_step = r_grid[1] - r_grid[0]\n        \n        min_damping = np.inf\n        optimal_alpha = np.nan\n        optimal_beta = np.nan\n        \n        for alpha in alphas:\n            for beta in betas:\n                # 1. Validate constraints\n                if alpha > 0 and (q0 + alpha) > q_min:\n                    continue\n                if beta > 0 and (vA0 * (1 + beta)) > vA_min:\n                    continue\n\n                # 2. Find resonances\n                q_r = q0 + alpha * r_grid**2\n                vA_r = vA0 * (1 + beta * r_grid**2)\n                \n                # Avoid division by zero if q_r is ever zero (not expected with positive q0, q_min)\n                g_r = n - m / np.where(q_r == 0, np.inf, q_r)\n                omega_A_grid = np.abs(g_r) * vA_r\n                \n                y = omega_A_grid - omega0\n                \n                # Find where sign changes occur\n                sign_changes = np.where(np.diff(np.sign(y)))[0]\n                \n                resonances = []\n                if len(sign_changes) > 0:\n                    for i in sign_changes:\n                        # Linear interpolation to find root r_a\n                        y0, y1 = y[i], y[i+1]\n                        r0, r1 = r_grid[i], r_grid[i+1]\n                        if not np.isclose(y1, y0):\n                            r_a = r0 - y0 * (r1 - r0) / (y1 - y0)\n                            if 0.0 = r_a = 1.0:\n                                resonances.append(r_a)\n\n                # 3. Calculate damping\n                current_damping = 0.0\n                if resonances:\n                    for r_a in resonances:\n                        if np.isclose(r_a, 0.0):\n                            current_damping = np.inf\n                            break\n                        \n                        # Calculate omega_A_prime at r_a\n                        q_at_ra = q0 + alpha * r_a**2\n                        vA_at_ra = vA0 * (1 + beta * r_a**2)\n                        \n                        q_prime_at_ra = 2 * alpha * r_a\n                        vA_prime_at_ra = vA0 * 2 * beta * r_a\n                        \n                        g_at_ra = n - m / q_at_ra\n                        g_prime_at_ra = m * q_prime_at_ra / (q_at_ra**2)\n                        \n                        omega_A_prime = np.sign(g_at_ra) * (g_prime_at_ra * vA_at_ra + g_at_ra * vA_prime_at_ra)\n                        \n                        if np.isclose(omega_A_prime, 0.0):\n                            current_damping = np.inf\n                            break\n                        \n                        current_damping += kappa / np.abs(omega_A_prime)\n                \n                # 4. Update minimum\n                # The loop order (alpha, then beta) and strict inequality automatically handle tie-breaking.\n                if current_damping  min_damping:\n                    min_damping = current_damping\n                    optimal_alpha = alpha\n                    optimal_beta = beta\n\n        final_results.extend([optimal_alpha, optimal_beta, min_damping])\n        \n    print(f\"[{','.join(f'{val:.7f}' for val in final_results)}]\")\n\nsolve()\n```"
        }
    ]
}