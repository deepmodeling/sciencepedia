{
    "hands_on_practices": [
        {
            "introduction": "The behavior of magnetic reconnection is critically dependent on the Lundquist number, $S$, a dimensionless parameter comparing the timescale for magnetic diffusion to the Alfvén transit time. In astrophysical and fusion plasmas, where temperatures are high and length scales are large, $S$ can reach enormous values, a condition under which simple reconnection models often fail. This exercise  provides a concrete, hands-on calculation for a tokamak-relevant scenario, guiding you to connect fundamental plasma parameters like temperature and density to the value of $S$ and, crucially, to interpret what this value implies for the expected reconnection physics.",
            "id": "4204674",
            "problem": "A large-aspect-ratio tokamak plasma is modeled using single-fluid Magnetohydrodynamics (MHD). Consider a flux-tube of characteristic perpendicular scale $L$ embedded in a uniform magnetic field $B$ and mass density $\\rho$. In resistive MHD, magnetic reconnection dynamics depend on the Lundquist number $S$, defined as the ratio of the resistive magnetic diffusion time to the Alfvén crossing time. Assume a fully ionized hydrogenic plasma with effective charge $Z_{\\mathrm{eff}} = 1$ and classical Coulomb logarithm $\\ln\\Lambda = 17$, and take the electron temperature to be $T_e = 2\\,\\mathrm{keV}$. The vacuum permeability is $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{N/A^2}$. Use the classical Spitzer resistivity for a fully ionized plasma. The parameters are $B = 3\\,\\mathrm{T}$, $\\rho = 10^{-6}\\,\\mathrm{kg/m^3}$, and $L = 0.5\\,\\mathrm{m}$. \n\nStarting from first principles and well-tested formulas appropriate to MHD and collisional transport, compute the Lundquist number $S$ for this scenario. Then, using your result and a commonly cited resistive-MHD plasmoid-onset threshold $S_c \\approx 10^{4}$, provide a brief qualitative interpretation of the expected reconnection regime in this tokamak-relevant parameter range.\n\nRound your final numerical value of $S$ to three significant figures. Express $S$ as a dimensionless number (no units in the final answer).",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, objective, and self-contained. All provided parameters are within physically plausible ranges for a tokamak plasma, and the question pertains to a standard and important topic within magnetohydrodynamics (MHD). The problem is valid.\n\nThe central task is to compute the Lundquist number $S$ and interpret its value. The Lundquist number is a dimensionless parameter that quantifies the ratio of the resistive magnetic diffusion time, $\\tau_R$, to the Alfvén crossing time, $\\tau_A$. It is defined as:\n$$S = \\frac{\\tau_R}{\\tau_A}$$\n\nFirst, we determine the Alfvén crossing time, $\\tau_A$. This is the time it takes for an Alfvén wave to travel across the characteristic length scale of the system, $L$. The formula is:\n$$\\tau_A = \\frac{L}{v_A}$$\nwhere $v_A$ is the Alfvén speed. The Alfvén speed in a single-fluid MHD model is given by:\n$$v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}}$$\nwhere $B$ is the magnetic field strength, $\\mu_0$ is the vacuum permeability, and $\\rho$ is the plasma mass density.\nSubstituting the given values: $B = 3\\,\\text{T}$, $\\rho = 10^{-6}\\,\\text{kg/m}^3$, $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\text{N/A}^2$, and $L = 0.5\\,\\text{m}$.\nFirst, we calculate the Alfvén speed:\n$$v_A = \\frac{3}{\\sqrt{(4\\pi \\times 10^{-7}) (10^{-6})}} = \\frac{3}{\\sqrt{4\\pi \\times 10^{-13}}} \\approx 2.676 \\times 10^6\\,\\text{m/s}$$\nThen, we calculate the Alfvén crossing time:\n$$\\tau_A = \\frac{0.5\\,\\text{m}}{2.676 \\times 10^6\\,\\text{m/s}} \\approx 1.868 \\times 10^{-7}\\,\\text{s}$$\n\nNext, we determine the resistive magnetic diffusion time, $\\tau_R$. This is the characteristic time scale on which magnetic fields diffuse through a resistive plasma over the length scale $L$. It is given by:\n$$\\tau_R = \\frac{\\mu_0 L^2}{\\eta}$$\nwhere $\\eta$ is the plasma's electrical resistivity. The problem specifies the use of the classical Spitzer resistivity for a fully ionized plasma with effective charge $Z_{\\mathrm{eff}} = 1$. The standard formula for parallel Spitzer resistivity is:\n$$\\eta \\approx 5.2 \\times 10^{-5} \\frac{Z_{\\mathrm{eff}} \\ln \\Lambda}{T_e^{3/2}}$$\nwhere the electron temperature $T_e$ must be in units of electron-volts (eV), $\\ln \\Lambda$ is the Coulomb logarithm, and the resulting resistivity $\\eta$ is in units of $\\Omega\\cdot\\text{m}$.\nThe given parameters are $Z_{\\mathrm{eff}} = 1$, $\\ln \\Lambda = 17$, and $T_e = 2\\,\\text{keV}$. We must convert the temperature to eV:\n$$T_e = 2\\,\\text{keV} = 2 \\times 10^3\\,\\text{eV}$$\nNow, we can calculate the resistivity:\n$$\\eta \\approx 5.2 \\times 10^{-5} \\frac{(1)(17)}{(2 \\times 10^3)^{3/2}} = \\frac{8.84 \\times 10^{-4}}{(2000)^{1.5}} \\approx \\frac{8.84 \\times 10^{-4}}{89442.7} \\approx 9.883 \\times 10^{-9}\\,\\Omega\\cdot\\text{m}$$\nWith the resistivity calculated, we find the resistive diffusion time:\n$$\\tau_R = \\frac{(4\\pi \\times 10^{-7}\\,\\text{N/A}^2) (0.5\\,\\text{m})^2}{9.883 \\times 10^{-9}\\,\\Omega\\cdot\\text{m}} = \\frac{(4\\pi \\times 10^{-7}) (0.25)}{9.883 \\times 10^{-9}}\\,\\text{s} \\approx 31.78\\,\\text{s}$$\n\nFinally, we can compute the Lundquist number $S$ by taking the ratio of the two time scales:\n$$S = \\frac{\\tau_R}{\\tau_A} \\approx \\frac{31.78\\,\\text{s}}{1.868 \\times 10^{-7}\\,\\text{s}} \\approx 1.701 \\times 10^8$$\nA more direct calculation of $S$ can be performed using the combined expression, which avoids intermediate rounding:\n$$S = \\frac{\\mu_0 L v_A}{\\eta} = \\frac{(4\\pi \\times 10^{-7}) (0.5) (2.676 \\times 10^6)}{9.883 \\times 10^{-9}} \\approx 1.701 \\times 10^8$$\nRounding the result to three significant figures, as requested, we obtain:\n$$S \\approx 1.70 \\times 10^8$$\n\nFor the qualitative interpretation, we compare our calculated Lundquist number to the critical value for the onset of the plasmoid instability in a reconnection layer, given as $S_c \\approx 10^4$.\nWe find that our calculated value, $S \\approx 1.70 \\times 10^8$, is vastly larger than the critical value:\n$$S \\gg S_c$$\nThis has profound implications for the nature of magnetic reconnection. The classical steady-state model of reconnection (Sweet-Parker model) predicts a very slow reconnection rate for such high $S$ values. However, the condition $S > S_c$ indicates that the thin current sheet, which is central to the reconnection process, is unstable to a tearing-type instability. This instability breaks the monolithic current sheet into a chain of smaller magnetic islands, or \"plasmoids\". The formation, growth, and violent ejection of these plasmoids disrupt the simple Sweet-Parker layer, leading to a reconnection process that is much faster, bursty, and chaotic. This \"plasmoid-unstable\" regime is believed to be the dominant mode of fast reconnection in many high-$S$ systems, including tokamak plasmas and solar flares. Therefore, for the given tokamak-relevant parameters, one should expect a fast, plasmoid-mediated reconnection regime rather than slow, steady Sweet-Parker reconnection.",
            "answer": "$$\\boxed{1.70 \\times 10^8}$$"
        },
        {
            "introduction": "The immense Lundquist numbers found in fusion and astrophysical systems pose a major challenge to the classical Sweet-Parker model, which predicts unphysically slow reconnection rates scaling as $S^{-1/2}$. This discrepancy is resolved by the onset of the plasmoid instability, which fragments the current sheet and establishes a new, much faster reconnection regime that is nearly independent of $S$. In this fundamental exercise , you will derive the classic Sweet-Parker scaling from first principles and contrast it directly with the modern model for fast, plasmoid-mediated reconnection, quantifying the dramatic enhancement in the reconnection rate.",
            "id": "4030806",
            "problem": "A two-dimensional, steady reconnection layer forms in a resistive magnetohydrodynamics (MHD) plasma of uniform upstream magnetic field magnitude $B_{\\mathrm{up}}$ and mass density $\\rho$. The layer has half-length $L$ and half-thickness $\\delta$, with inflow speed $v_{\\mathrm{in}}$ and outflow speed $v_{\\mathrm{out}}$. Consider the standard Sweet–Parker configuration, where the reconnecting electric field $E$ is uniform across the layer and the upstream plasma is ideal, and a plasmoid-mediated configuration in which the global rate is set by a chain of marginal secondary current sheets.\n\nUse only the following foundational starting points:\n- Uniform-$E$ steady state and resistive Ohm’s law in resistive MHD: $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J}$, with constant scalar resistivity $\\eta$.\n- Mass conservation in steady two-dimensional incompressible flow: $\\rho v_{\\mathrm{in}} L \\simeq \\rho v_{\\mathrm{out}} \\delta$.\n- The Alfvén speed $V_{A} = B_{\\mathrm{up}} / \\sqrt{\\mu_{0} \\rho}$ and outflow scaling $v_{\\mathrm{out}} \\sim V_{A}$ in a reconnecting layer.\n- The Lundquist number $S = \\mu_{0} L V_{A} / \\eta$.\n- In the plasmoid-mediated regime for $S \\gg S_{c}$, the global reconnection electric field becomes approximately $S$-independent and may be modeled as $E_{\\mathrm{pl}} = c \\, B_{\\mathrm{up}} V_{A}$ with a constant $c$ of order $10^{-2}$.\n\nGiven $B_{\\mathrm{up}} = 0.2\\,\\mathrm{T}$, deuterium plasma with number density $n = 2.5 \\times 10^{19}\\,\\mathrm{m}^{-3}$, ion mass $m_{i} = 2 m_{p}$ with proton mass $m_{p} = 1.6726 \\times 10^{-27}\\,\\mathrm{kg}$, magnetic permeability $\\mu_{0} = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$, Lundquist number $S = 2.5 \\times 10^{5}$, and plasmoid prefactor $c = 0.01$:\n\n1. Starting from the above principles, derive the Sweet–Parker reconnection electric field $E_{\\mathrm{SP}}$ in terms of $B_{\\mathrm{up}}$, $V_{A}$, and $S$.\n2. Using the plasmoid-mediated model $E_{\\mathrm{pl}} = c \\, B_{\\mathrm{up}} V_{A}$, form the ratio $r(S,c) = E_{\\mathrm{pl}}/E_{\\mathrm{SP}}$ in closed form.\n3. Evaluate $r$ for the given $S$ and $c$. Also compute $V_{A}$, $E_{\\mathrm{pl}}$, and $E_{\\mathrm{SP}}$ numerically to demonstrate consistency, and express $E$ in $\\mathrm{V/m}$. Briefly comment on the applicability and limits of each scaling in high-$S$ fusion-relevant plasmas.\n\nProvide the final answer as the dimensionless ratio $r$. If numerical rounding is necessary, round to four significant figures.",
            "solution": "The problem statement has been validated and is deemed self-contained, scientifically grounded, and well-posed. It presents a standard problem in the theory of magnetic reconnection, drawing from foundational principles of resistive magnetohydrodynamics (MHD) and contrasting two primary models for the reconnection rate. All provided parameters are physically consistent and sufficient for a complete solution.\n\nThe solution proceeds by addressing the three tasks specified in the problem statement.\n\nTask 1: Derivation of the Sweet–Parker reconnection electric field $E_{\\mathrm{SP}}$.\n\nThe analysis begins with the steady-state resistive Ohm's law, $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J}$. In a two-dimensional reconnection geometry, we consider two distinct regions.\n\nIn the upstream ideal inflow region, the resistivity $\\eta$ is negligible. The reconnecting electric field $E$, which is uniform and directed out-of-plane, is determined by the convective term. With inflow velocity $\\mathbf{v}_{\\mathrm{in}}$ and upstream magnetic field $\\mathbf{B}_{\\mathrm{up}}$, Ohm's law simplifies to $\\mathbf{E} + \\mathbf{v}_{\\mathrm{in}} \\times \\mathbf{B}_{\\mathrm{up}} \\approx 0$. Since the inflow is largely perpendicular to the magnetic field, the magnitude of the electric field is given by:\n$$E = v_{\\mathrm{in}} B_{\\mathrm{up}}$$\nThis relationship holds globally due to the steady-state assumption ($\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B} / \\partial t = 0$).\n\nAt the center of the reconnection layer (the X-point), the velocity $\\mathbf{v}$ is ideally zero, and the magnetic field $\\mathbf{B}$ also passes through zero. Here, the resistive term dominates Ohm's law:\n$$E = \\eta J_z$$\nwhere $J_z$ is the out-of-plane current density. Via Ampere's law, $\\mu_{0} \\mathbf{J} = \\nabla \\times \\mathbf{B}$, we can estimate the current density from the magnetic field gradient across the layer. The magnetic field reverses from approximately $+B_{\\mathrm{up}}$ to $-B_{\\mathrm{up}}$ over the full thickness of the layer, $2 \\delta$. Thus, the current density scales as $J_z \\sim \\frac{B_{\\mathrm{up}}}{\\mu_{0} \\delta}$. Substituting this into the resistive form of Ohm's law gives:\n$$E \\approx \\frac{\\eta B_{\\mathrm{up}}}{\\mu_{0} \\delta}$$\nEquating the two expressions for the electric field $E$ yields a relationship between the inflow speed and the layer thickness:\n$$v_{\\mathrm{in}} B_{\\mathrm{up}} = \\frac{\\eta B_{\\mathrm{up}}}{\\mu_{0} \\delta} \\implies v_{\\mathrm{in}} = \\frac{\\eta}{\\mu_{0} \\delta}$$\nNext, we invoke the principle of mass conservation for an incompressible flow through the reconnection region. The mass flux into the layer must equal the mass flux out of the layer. This is expressed as $\\rho v_{\\mathrm{in}} L \\simeq \\rho v_{\\mathrm{out}} \\delta$, which simplifies to:\n$$v_{\\mathrm{in}} L \\simeq v_{\\mathrm{out}} \\delta$$\nThe problem states that the outflow is accelerated to a speed of the order of the upstream Alfvén speed, $v_{\\mathrm{out}} \\sim V_{A}$. Substituting this and our expression for $v_{\\mathrm{in}}$ into the mass conservation equation allows us to solve for the layer half-thickness $\\delta$:\n$$\\left(\\frac{\\eta}{\\mu_{0} \\delta}\\right) L \\simeq V_{A} \\delta \\implies \\delta^2 \\simeq \\frac{\\eta L}{\\mu_{0} V_{A}}$$\n$$\\delta \\simeq \\sqrt{\\frac{\\eta L}{\\mu_{0} V_{A}}} = L^{1/2} \\left(\\frac{\\eta}{\\mu_{0} V_{A}}\\right)^{1/2}$$\nNow we can determine the inflow speed $v_{\\mathrm{in}}$ by rearranging the mass conservation equation: $v_{\\mathrm{in}} \\simeq v_{\\mathrm{out}} (\\delta/L) \\simeq V_{A} (\\delta/L)$. Substituting our derived expression for $\\delta$:\n$$v_{\\mathrm{in}} \\simeq V_{A} \\frac{1}{L} \\left(L^{1/2} \\left(\\frac{\\eta}{\\mu_{0} V_{A}}\\right)^{1/2}\\right) = V_{A} \\left(\\frac{\\eta}{L \\mu_{0} V_{A}}\\right)^{1/2}$$\nThe reconnection electric field for the Sweet–Parker model, $E_{\\mathrm{SP}}$, is then $E_{\\mathrm{SP}} = v_{\\mathrm{in}} B_{\\mathrm{up}}$:\n$$E_{\\mathrm{SP}} \\simeq B_{\\mathrm{up}} V_{A} \\left(\\frac{\\eta}{L \\mu_{0} V_{A}}\\right)^{1/2}$$\nTo express this in terms of the Lundquist number $S = \\mu_{0} L V_{A} / \\eta$, we note that the term in the parentheses is the inverse of $S$: $(\\eta / (L \\mu_{0} V_{A})) = S^{-1}$.\nTherefore, the Sweet–Parker electric field is:\n$$E_{\\mathrm{SP}} = B_{\\mathrm{up}} V_{A} S^{-1/2}$$\n\nTask 2: Formation of the ratio $r(S,c)$.\n\nThe problem provides the model for the plasmoid-mediated reconnection electric field as $E_{\\mathrm{pl}} = c \\, B_{\\mathrm{up}} V_{A}$. The ratio $r(S,c)$ is defined as $E_{\\mathrm{pl}} / E_{\\mathrm{SP}}$.\nUsing the expressions for $E_{\\mathrm{pl}}$ and $E_{\\mathrm{SP}}$:\n$$r(S,c) = \\frac{E_{\\mathrm{pl}}}{E_{\\mathrm{SP}}} = \\frac{c \\, B_{\\mathrm{up}} V_{A}}{B_{\\mathrm{up}} V_{A} S^{-1/2}}$$\nThe terms $B_{\\mathrm{up}}$ and $V_{A}$ cancel, leaving:\n$$r(S,c) = \\frac{c}{S^{-1/2}} = c S^{1/2} = c \\sqrt{S}$$\n\nTask 3: Numerical evaluation and commentary.\n\nFirst, we calculate the necessary plasma parameters from the given values. The plasma is deuterium, so the ion mass is $m_{i} = 2 m_{p}$.\nThe mass density $\\rho$ is given by $\\rho = n m_{i} = n (2 m_{p})$:\n$$\\rho = (2.5 \\times 10^{19}\\,\\mathrm{m}^{-3}) \\times (2 \\times 1.6726 \\times 10^{-27}\\,\\mathrm{kg}) = 8.363 \\times 10^{-8}\\,\\mathrm{kg/m^3}$$\nNext, we compute the Alfvén speed $V_{A} = B_{\\mathrm{up}} / \\sqrt{\\mu_{0} \\rho}$:\n$$V_{A} = \\frac{0.2\\,\\mathrm{T}}{\\sqrt{(4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}) \\times (8.363 \\times 10^{-8}\\,\\mathrm{kg/m^3})}} \\approx \\frac{0.2}{\\sqrt{1.0508 \\times 10^{-13}}} \\approx 616954\\,\\mathrm{m/s}$$\nRounding to four significant figures, $V_{A} \\approx 6.170 \\times 10^{5}\\,\\mathrm{m/s}$.\n\nNow we can evaluate the ratio $r$ for the given Lundquist number $S = 2.5 \\times 10^{5}$ and prefactor $c = 0.01$.\n$$r = c \\sqrt{S} = 0.01 \\times \\sqrt{2.5 \\times 10^{5}} = 0.01 \\times \\sqrt{25 \\times 10^{4}} = 0.01 \\times (5 \\times 10^{2}) = 0.01 \\times 500 = 5$$\nAs this is an exact result, rounding gives $5.000$ to maintain four significant figures as requested for consistency.\n\nTo demonstrate consistency, we compute the electric fields numerically.\nPlasmoid-mediated electric field $E_{\\mathrm{pl}}$:\n$$E_{\\mathrm{pl}} = c \\, B_{\\mathrm{up}} V_{A} = 0.01 \\times 0.2\\,\\mathrm{T} \\times 616954\\,\\mathrm{m/s} \\approx 1233.9\\,\\mathrm{V/m}$$\nSweet–Parker electric field $E_{\\mathrm{SP}}$:\n$$E_{\\mathrm{SP}} = B_{\\mathrm{up}} V_{A} S^{-1/2} = \\frac{B_{\\mathrm{up}} V_{A}}{\\sqrt{S}} = \\frac{0.2\\,\\mathrm{T} \\times 616954\\,\\mathrm{m/s}}{\\sqrt{2.5 \\times 10^{5}}} = \\frac{123390.8}{500} \\approx 246.78\\,\\mathrm{V/m}$$\nThe ratio of these numerical values is $1233.9 / 246.78 \\approx 5.000$, confirming the derived expression for $r$.\n\nCommentary on applicability and limits:\nThe Sweet–Parker (SP) model assumes a stable, monolithic current sheet. Its prediction that the reconnection rate (proportional to $E$) scales as $S^{-1/2}$ implies extremely slow reconnection in high-$S$ plasmas, such as those in solar flares ($S \\sim 10^{12}$) or tokamak fusion devices ($S \\sim 10^{8}$). This prediction is inconsistent with observations of fast magnetic energy release in these systems.\n\nThe discrepancy arises because for Lundquist numbers exceeding a critical value $S_{c} \\sim 10^{4}$, the long, thin SP current sheet becomes violently unstable to the tearing instability, which fragments the sheet into a chain of magnetic islands, or plasmoids. This is the plasmoid instability. The dynamics of this \"plasmoid-mediated\" regime are fundamentally different. Reconnection proceeds at multiple, shorter current sheets between the plasmoids, leading to a much faster global reconnection rate that is nearly independent of $S$. The model $E_{\\mathrm{pl}} = c B_{\\mathrm{up}} V_A$ with $c \\approx 0.01$ is a widely cited result from numerical simulations that captures this fast, \"collisional but independent of S\" rate.\n\nTherefore, in the context of high-$S$ fusion-relevant plasmas, the plasmoid-mediated model is considered far more realistic for describing fast reconnection events than the classical Sweet-Parker model. The SP model is primarily of historical and theoretical importance, serving as a baseline and as a description of the state from which the plasmoid instability develops. The limitation of the plasmoid model is that the prefactor $c$ is an empirical parameter from simulations and may exhibit weak dependencies on other plasma parameters not captured in this simple scaling.",
            "answer": "$$\n\\boxed{5.000}\n$$"
        },
        {
            "introduction": "The transition from a smooth, laminar reconnection layer to a chaotic, plasmoid-filled one is not merely a change in rate but a fundamental shift in dynamics, characterized by intermittency and explosive bursts of activity. These physical behaviors leave distinct statistical fingerprints in the time series of electromagnetic fields and currents obtained from simulations or experiments. This advanced data analysis practice  challenges you to design a quantitative detector that uses sophisticated statistical tools, such as structure functions and extreme-value theory, to identify these signatures and distinguish the plasmoid-mediated regime from its laminar counterpart.",
            "id": "4031045",
            "problem": "You are given two synchronized time series representing the reconnection electric field and the out-of-plane current density measured near an X-point in a magnetized plasma: $E_{rec}(t)$ and $J_z(t)$, sampled uniformly with sampling interval $\\Delta t$ over simulation time $T$. The objective is to design and implement a principled, quantitative detector for the transition from a resistive, laminar magnetic reconnection regime to a plasmoid-mediated regime using intermittency measures and burst statistics derived from the signals.\n\nYou must base your method on fundamental plasma physics and statistical analysis principles, without relying on ad hoc or unmotivated heuristics. The physical starting points are:\n- Maxwell–Faraday law: $\\nabla \\times \\mathbf{E} = -\\,\\partial \\mathbf{B}/\\partial t$.\n- Generalized Magnetohydrodynamics (MHD) Ohm’s law: $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J} - \\nabla p_e/(n e) + \\text{Hall} + \\text{inertial} + \\text{turbulent terms}$, where $\\eta$ is the resistivity, $\\mathbf{J}$ is the current density, $p_e$ is the electron pressure, $n$ is the number density, and $e$ is the elementary charge. In a resistive, laminar regime near an X-point, it is commonly observed that $E_{rec} \\approx \\eta J_z$ (dominant resistive coupling). In a plasmoid-mediated regime, the reconnection layer fragments into multiple magnetic islands (plasmoids), producing intermittent bursts in $E_{rec}(t)$ and $J_z(t)$ and deviations from purely resistive coupling.\n\nThe detection must be driven by the following statistical constructs, motivated by intermittency and extreme-event theory:\n- For a signal $x(t)$, define the order-$p$ structure function at scale $\\tau$ by $S_p(\\tau) = \\langle |x(t+\\tau) - x(t)|^p \\rangle_t$, where $\\langle \\cdot \\rangle_t$ denotes averaging over time. Define the flatness (kurtosis of increments) $F(\\tau) = S_4(\\tau)/[S_2(\\tau)]^2$. For increments with Gaussian statistics, $F(\\tau) = 3$. Intermittency is indicated by $F(\\tau)$ increasing above $3$ and strengthening as $\\tau$ decreases.\n- Define a fused magnitude $M(t) = \\sqrt{E_{rec}(t)^2 + J_z(t)^2}$. Identify bursts by thresholding $M(t)$ at $T_h = \\text{median}(M) + \\kappa \\cdot \\text{MAD}(M)$, where $\\text{MAD}(M) = \\text{median}(|M - \\text{median}(M)|)$ and $\\kappa$ is a fixed constant. A burst is a contiguous time interval over which $M(t) > T_h$.\n- Let $N_b$ be the number of bursts detected in time $T$, the burst rate $r = N_b/T$ (express in $\\text{s}^{-1}$), and $\\{\\tau_b\\}$ the set of burst durations (in seconds). Let $\\{A_i\\}$ be the set of burst peak magnitudes $A_i = \\max_{t \\in \\text{burst } i} M(t)$. Assess heavy-tailedness of $\\{A_i\\}$ using the Hill estimator applied to the largest $k$ order statistics of $\\{A_i\\}$, yielding an estimate of the Pareto tail exponent $\\hat{\\alpha}$ for the upper tail. Heavy tails compatible with plasmoid-mediated bursts correspond to $\\hat{\\alpha}$ sufficiently small.\n\nDesign a detector that outputs a boolean for each time series pair: $1$ for “plasmoid regime detected” and $0$ otherwise. Your detector must combine:\n- An intermittency condition based on flatness at a small scale $\\tau_s$ and (optionally) its scale dependence relative to a larger scale $\\tau_\\ell$.\n- A burst activity condition based on $r$.\n- A heavy-tail condition based on $\\hat{\\alpha}$.\n\nYour implementation must respect scientific realism: the thresholds and method must be justified in your solution by connecting to the laminar resistive baseline and the expected properties of plasmoid-mediated reconnection. Angles do not appear in this problem. Time must be handled in seconds, and rates must be computed in $\\text{s}^{-1}$. All mathematical symbols in your explanation must appear in LaTeX.\n\nYour program must construct and analyze four synthetic test cases (test suite) by generating $E_{rec}(t)$ and $J_z(t)$ consistent with the following parameter sets. In each, define $J_z(t)$ as a superposition of a baseline noise plus a finite set of pulses with a Gaussian profile, and define $E_{rec}(t) \\approx \\eta J_z(t) + \\chi \\,\\partial J_z/\\partial t + \\epsilon_E(t)$, where $\\epsilon_E(t)$ is additional small noise, $\\eta$ is the effective resistivity coupling, and $\\chi$ represents non-resistive contributions. Pulse times are a Poisson process of rate $\\lambda$ and pulse widths are uniform on a specified range; pulse amplitudes follow the specified distribution.\n\n- Case A (laminar resistive baseline):\n    - $T = 1.0$ s, $\\Delta t = 5 \\times 10^{-4}$ s, $\\eta = 0.1$, $\\chi = 0.0$,\n    - Baseline noises: $\\sigma_E = 0.02$, $\\sigma_J = 0.02$,\n    - Burst process: $\\lambda = 0$ $\\text{s}^{-1}$ (no bursts), width range $[0.008, 0.012]$ s, amplitude distribution unused.\n\n- Case B (borderline transitional):\n    - $T = 1.0$ s, $\\Delta t = 5 \\times 10^{-4}$ s, $\\eta = 0.1$, $\\chi = 0.02$,\n    - Baseline noises: $\\sigma_E = 0.03$, $\\sigma_J = 0.03$,\n    - Burst process: $\\lambda = 2$ $\\text{s}^{-1}$, width range $[0.008, 0.015]$ s,\n    - Amplitudes: exponential distribution with mean $b = 0.25$ (i.e., density $f(a) = \\frac{1}{b} e^{-a/b}$ for $a \\ge 0$).\n\n- Case C (plasmoid-mediated regime):\n    - $T = 1.0$ s, $\\Delta t = 5 \\times 10^{-4}$ s, $\\eta = 0.1$, $\\chi = 0.05$,\n    - Baseline noises: $\\sigma_E = 0.03$, $\\sigma_J = 0.03$,\n    - Burst process: $\\lambda = 10$ $\\text{s}^{-1}$, width range $[0.004, 0.015]$ s,\n    - Amplitudes: Pareto distribution with shape $\\alpha = 2.0$ and minimum $a_{\\min} = 0.3$ (i.e., $P(A > a) = (a_{\\min}/a)^{\\alpha}$ for $a \\ge a_{\\min}$).\n\n- Case D (edge case with zero variability):\n    - $T = 0.5$ s, $\\Delta t = 5 \\times 10^{-4}$ s, $\\eta = 0.1$, $\\chi = 0.0$,\n    - Baseline noises: $\\sigma_E = 0.0$, $\\sigma_J = 0.0$,\n    - Burst process: $\\lambda = 0$ $\\text{s}^{-1}$.\n\nImplement the following steps for each case:\n1. Generate $J_z(t)$ by summing baseline Gaussian noise with the Gaussian pulses defined by the burst process. Use full width at half maximum $w$ for each pulse, converted to Gaussian standard deviation $\\sigma_w = w / 2.355$. Generate pulse centers uniformly over $[0, T]$ and construct $J_z(t)$ by adding $A \\exp[-(t - t_0)^2/(2 \\sigma_w^2)]$ for each burst with amplitude $A$.\n2. Construct $E_{rec}(t) = \\eta J_z(t) + \\chi \\,\\partial J_z/\\partial t + \\epsilon_E(t)$, where $\\partial J_z/\\partial t$ is computed consistently from discrete samples and $\\epsilon_E(t)$ is Gaussian noise with standard deviation $\\sigma_E$.\n3. Compute flatness $F_E(\\tau)$ and $F_J(\\tau)$ at two scales $\\tau_s = 5 \\Delta t$ and $\\tau_\\ell = 40 \\Delta t$. If $S_2(\\tau)$ is numerically indistinguishable from zero, treat the flatness as $3$ for that signal-scale combination to avoid division by zero.\n4. Form $M(t) = \\sqrt{E_{rec}(t)^2 + J_z(t)^2}$ and set the threshold $T_h = \\text{median}(M) + \\kappa \\cdot \\text{MAD}(M)$ with $\\kappa = 3$. Identify bursts as contiguous segments where $M(t) > T_h$, discard segments shorter than $3$ samples, and compute the burst rate $r = N_b/T$ in $\\text{s}^{-1}$. Compute the set of burst peak magnitudes $\\{A_i\\}$ and estimate the Pareto tail exponent $\\hat{\\alpha}$ using the Hill estimator on the largest $k = \\min(10, N_b)$ peaks, requiring at least $5$ peaks to attempt the estimate. If there are fewer than $5$ peaks, treat heavy-tail detection as false.\n5. Decide “plasmoid regime detected” if all of the following hold:\n   - Intermittency: $\\max(F_E(\\tau_s), F_J(\\tau_s)) > 5$ and at least one signal has $F(\\tau_s) > F(\\tau_\\ell)$.\n   - Burst activity: $r > 6$ $\\text{s}^{-1}$.\n   - Heavy tail: $\\hat{\\alpha} \\le 3$ and at least $k \\ge 5$ peaks used in the estimate.\n\nYour program should produce a single line of output containing the boolean results for the four cases as a comma-separated list enclosed in square brackets (e.g., \"[False,False,True,False]\"). Use a fixed random seed to ensure deterministic outputs. The intended classification is that Case A, Case B, and Case D are not plasmoid-mediated (output false), whereas Case C is plasmoid-mediated (output true).\n\nYour program must be a single, complete, runnable script, produce no additional text, and use the specified Python libraries only.",
            "solution": "We start from the generalized Magnetohydrodynamics (MHD) Ohm’s law\n$$\n\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J} - \\frac{\\nabla p_e}{n e} + \\text{Hall} + \\text{inertial} + \\text{turbulent},\n$$\nand Maxwell–Faraday law\n$$\n\\nabla \\times \\mathbf{E} = -\\,\\frac{\\partial \\mathbf{B}}{\\partial t}.\n$$\nNear an X-point in a laminar resistive regime, the reconnection electric field is approximately governed by the resistive term, yielding $E_{rec} \\approx \\eta J_z$. In a plasmoid-mediated regime, the formation of multiple magnetic islands (plasmoids) via tearing instability and nonlinear dynamics introduces intermittent, burst-like enhancements in $J_z$ and $E_{rec}$, and additional non-resistive contributions, including temporal variations that are captured by an effective $\\chi \\,\\partial J_z/\\partial t$ term. Thus, the transition to plasmoid mediation is associated with departures from Gaussian increments and the emergence of heavy-tailed burst statistics.\n\nTo detect this transition quantitatively, we combine intermittency and burst statistics:\n\n1. Intermittency via structure functions. For a signal $x(t)$, define\n$$\nS_p(\\tau) = \\left\\langle \\left|x(t+\\tau) - x(t)\\right|^p \\right\\rangle_t, \\quad F(\\tau) = \\frac{S_4(\\tau)}{\\left[S_2(\\tau)\\right]^2}.\n$$\nFor Gaussian increments, $F(\\tau)=3$; values $F(\\tau)>3$ indicate intermittency. Moreover, intermittency strengthens at smaller scales in bursty signals, so we expect $F(\\tau_s) > F(\\tau_\\ell)$ with $\\tau_s < \\tau_\\ell$. In a laminar resistive regime, $E_{rec}(t)$ and $J_z(t)$ are smooth with small, near-Gaussian fluctuations, giving $F(\\tau)\\approx 3$ at both scales. In a plasmoid regime, both $E_{rec}$ and $J_z$ exhibit intermittent spikes, making $F(\\tau)$ significantly larger than $3$ at small scales.\n\n2. Bursts via robust thresholding. We fuse the two signals into a single magnitude\n$$\nM(t) = \\sqrt{E_{rec}(t)^2 + J_z(t)^2}.\n$$\nWe set a robust threshold\n$$\nT_h = \\text{median}(M) + \\kappa \\cdot \\text{MAD}(M),\n$$\nwith $\\kappa = 3$. This choice is motivated by robust statistics: the median and median absolute deviation (MAD) have bounded influence and provide stable thresholds in the presence of outliers. A burst is a contiguous segment over which $M(t) > T_h$. We measure the burst rate\n$$\nr = \\frac{N_b}{T} \\quad \\text{in } \\text{s}^{-1},\n$$\nwhere $N_b$ is the number of bursts in the time interval of length $T$.\n\n3. Heavy-tailedness via extreme-value theory. Let $\\{A_i\\}$ be the set of peak magnitudes of the detected bursts. Plasmoid-mediated reconnection often produces heavy-tailed distributions of event sizes. We estimate the upper-tail Pareto exponent using the Hill estimator. Sort the peaks descending $A_{(1)} \\ge A_{(2)} \\ge \\dots \\ge A_{(N_b)}$ and select $k$ top values with $k=\\min(10, N_b)$ (requiring $k\\ge 5$ to attempt estimation). Using threshold $u = A_{(k+1)}$, the Hill estimator for the tail index $\\gamma$ is\n$$\n\\hat{\\gamma} = \\frac{1}{k} \\sum_{i=1}^k \\ln\\left(\\frac{A_{(i)}}{u}\\right), \\quad \\text{and} \\quad \\hat{\\alpha} = \\frac{1}{\\hat{\\gamma}}.\n$$\nSmall $\\hat{\\alpha}$ indicates heavy tails; $\\hat{\\alpha} \\le 3$ implies sufficiently heavy tails that are incompatible with purely Gaussian laminar behavior. We require $k\\ge 5$ to increase estimator stability; if fewer peaks exist, heavy-tail detection is set false.\n\nDetector design:\n- Intermittency condition: $\\max(F_E(\\tau_s), F_J(\\tau_s)) > 5$ and at least one of $F_E(\\tau_s) > F_E(\\tau_\\ell)$ or $F_J(\\tau_s) > F_J(\\tau_\\ell)$.\n- Burst activity condition: $r > 6$ $\\text{s}^{-1}$. This exceeds typical laminar fluctuation rates and matches frequent events in the plasmoid regime.\n- Heavy-tail condition: $\\hat{\\alpha} \\le 3$ with $k \\ge 5$. This captures heavy tails consistent with plasmoid bursting.\n\nThese thresholds are not arbitrary: $F(\\tau)=3$ is the Gaussian baseline, so $5$ indicates significant deviation; the rate $6$ $\\text{s}^{-1}$ distinguishes sparse bursts from frequent plasmoid-driven events in a $T=1$ s window; $\\hat{\\alpha}\\le 3$ detects tails where the third moment may diverge, indicating strong intermittency. The combined criteria reduce false positives by requiring both frequent, strong bursts and heavy tails alongside intermittent increments.\n\nSynthetic generation aligns with the physical model: we construct $J_z(t)$ as a superposition of a baseline noise (small-amplitude Gaussian, representing background fluctuations) and Gaussian-shaped pulses representing tearing-driven current filaments; $E_{rec}(t)$ is given by $E_{rec}(t) = \\eta J_z(t) + \\chi \\,\\partial J_z/\\partial t + \\epsilon_E(t)$, where the derivative term models non-resistive dynamics that grow in the plasmoid regime. Pulse times follow a Poisson process of rate $\\lambda$, widths are uniformly sampled from the specified ranges, and amplitudes follow either exponential (thin-tailed) or Pareto (heavy-tailed) distributions, consistent with laminar/transitional versus plasmoid scenarios.\n\nAlgorithmic steps:\n- Use a fixed random seed for reproducibility.\n- For each case, build $J_z(t)$ and $E_{rec}(t)$ according to the specified parameters.\n- Compute $S_2(\\tau)$ and $S_4(\\tau)$ at $\\tau_s = 5\\Delta t$ and $\\tau_\\ell = 40\\Delta t$, and compute flatness $F(\\tau)$. If $S_2(\\tau)$ is numerically zero, set $F(\\tau)=3$ to avoid instability.\n- Build $M(t)$, compute $T_h$ using median and MAD, extract bursts (discard segments shorter than $3$ samples), and compute $r$, durations, and peak magnitudes $\\{A_i\\}$.\n- Apply the Hill estimator to the top $k=\\min(10,N_b)$ peaks if $k\\ge 5$, otherwise set heavy-tail detection to false.\n- Combine conditions to classify each case.\n\nExpected behavior for the test suite:\n- Case A: No bursts, near-Gaussian fluctuations, $F\\approx 3$, $r=0$, heavy-tail false; detector outputs false.\n- Case B: Few bursts with thin tails, moderate intermittency but not strong, $r\\approx 2$ $\\text{s}^{-1}$, heavy-tail false; detector outputs false.\n- Case C: Frequent bursts with heavy-tailed amplitudes, strong intermittency ($F(\\tau_s)$ significantly above $3$), $r\\approx 10$ $\\text{s}^{-1}$, heavy-tail true; detector outputs true.\n- Case D: Constant signals, no variance, $F=3$ by convention, $r=0$, heavy-tail false; detector outputs false.\n\nThe program aggregates the four boolean results into a single line in the format \"[False,False,True,False]\" and prints it with no extra text.",
            "answer": "```python\nimport numpy as np\n\ndef generate_time_series(T, dt, eta, chi, sigma_E, sigma_J, lam, w_range, amp_dist):\n    \"\"\"\n    Generate synthetic J_z(t) and E_rec(t) time series.\n    - T: total time (s)\n    - dt: sampling interval (s)\n    - eta: resistive coupling coefficient\n    - chi: coefficient for dJ/dt contribution\n    - sigma_E: std dev of E noise\n    - sigma_J: std dev of J noise\n    - lam: Poisson rate of bursts (s^-1)\n    - w_range: (wmin, wmax) for pulse FWHM widths (s). If None, unused.\n    - amp_dist: dict specifying amplitude distribution type and parameters:\n        {\"type\": \"exp\", \"b\": float}\n        {\"type\": \"pareto\", \"alpha\": float, \"xmin\": float}\n        None if no bursts\n    Returns: t, E_rec, J_z\n    \"\"\"\n    n = int(np.round(T / dt))\n    t = np.arange(n) * dt\n    rng = np.random.default_rng(12345)  # local RNG for reproducibility per call\n\n    # Baseline noise\n    J = rng.normal(0.0, sigma_J, size=n)\n    # Generate bursts\n    N_bursts = rng.poisson(lam * T) if lam > 0 else 0\n    if N_bursts > 0 and w_range is not None and amp_dist is not None:\n        # Burst centers\n        centers = rng.uniform(0.0, T, size=N_bursts)\n        # Widths: FWHM uniform, convert to Gaussian sigma via sigma = FWHM / 2.355\n        widths_fwhm = rng.uniform(w_range[0], w_range[1], size=N_bursts)\n        sigmas = widths_fwhm / 2.355\n        # Amplitudes\n        if amp_dist[\"type\"] == \"exp\":\n            b = amp_dist[\"b\"]\n            amps = rng.exponential(b, size=N_bursts)\n        elif amp_dist[\"type\"] == \"pareto\":\n            alpha = amp_dist[\"alpha\"]\n            xmin = amp_dist[\"xmin\"]\n            # Use inverse CDF: A = xmin * U^{-1/alpha}, U in (0,1)\n            U = rng.uniform(0.0, 1.0, size=N_bursts)\n            # avoid 0\n            U = np.clip(U, 1e-12, 1.0)\n            amps = xmin * (U ** (-1.0 / alpha))\n        else:\n            amps = np.zeros(N_bursts)\n\n        # Add Gaussian pulses to J\n        for c, s, a in zip(centers, sigmas, amps):\n            # Gaussian shape\n            if s <= 0:\n                continue\n            g = a * np.exp(-((t - c) ** 2) / (2.0 * s ** 2))\n            J += g\n\n    # Compute dJ/dt via central differences where possible, else forward/backward\n    dJdt = np.zeros_like(J)\n    if n > 2:\n      dJdt[1:-1] = (J[2:] - J[:-2]) / (2.0 * dt)\n      dJdt[0] = (J[1] - J[0]) / dt\n      dJdt[-1] = (J[-1] - J[-2]) / dt\n    elif n == 2:\n      dJdt[0] = (J[1] - J[0]) / dt\n      dJdt[1] = (J[1] - J[0]) / dt\n\n    # E = eta*J + chi*dJ/dt + E-noise\n    E_noise = rng.normal(0.0, sigma_E, size=n)\n    E = eta * J + chi * dJdt + E_noise\n\n    return t, E, J\n\ndef structure_functions_flatness(x, dt, k_small, k_large):\n    \"\"\"\n    Compute structure functions S2 and S4 for increments at scales tau_s=k_small*dt and tau_l=k_large*dt.\n    Return flatness F_small and F_large for the series x.\n    If S2 ~ 0, return F = 3.0 to avoid division by zero.\n    \"\"\"\n    def flatness_at_k(k):\n        if k <= 0 or k >= len(x):\n            return 3.0\n        dx = x[k:] - x[:-k]\n        if len(dx) == 0:\n            return 3.0\n        S2 = np.mean(np.abs(dx) ** 2)\n        S4 = np.mean(np.abs(dx) ** 4)\n        if S2 <= 1e-12:\n            return 3.0\n        return S4 / (S2 ** 2)\n\n    F_s = flatness_at_k(k_small)\n    F_l = flatness_at_k(k_large)\n    return F_s, F_l\n\ndef mad_threshold(y, kappa=3.0):\n    \"\"\"\n    Robust threshold using median + kappa * MAD.\n    MAD = median(|y - median(y)|)\n    \"\"\"\n    if len(y) == 0:\n        return 0\n    med = np.median(y)\n    mad = np.median(np.abs(y - med))\n    return med + kappa * mad\n\ndef extract_bursts(y, thr, min_len=3):\n    \"\"\"\n    Extract contiguous segments where y > thr. Discard segments shorter than min_len samples.\n    Return list of (start_idx, end_idx) and list of peak magnitudes for each burst.\n    \"\"\"\n    above = y > thr\n    bursts = []\n    peaks = []\n    n = len(y)\n    i = 0\n    while i < n:\n        if above[i]:\n            start = i\n            while i < n and above[i]:\n                i += 1\n            end = i  # exclusive\n            if (end - start) >= min_len:\n                bursts.append((start, end))\n                peaks.append(float(np.max(y[start:end])))\n        else:\n            i += 1\n    return bursts, peaks\n\ndef hill_alpha(peaks, min_k=5, max_k=10):\n    \"\"\"\n    Hill estimator for Pareto tail exponent alpha on the top k peaks.\n    Returns (alpha_hat, valid_flag).\n    If not enough peaks, return (np.inf, False).\n    \"\"\"\n    n = len(peaks)\n    if n < min_k:\n        return float('inf'), False\n    # Sort descending\n    x = np.sort(np.array(peaks))[::-1]\n    k = min(max_k, n)\n    if k > n-1:\n        # not enough to define threshold u\n        return float('inf'), False\n    u = x[k]  # threshold: (k+1)th largest\n    # Ensure positivity above threshold\n    if u <= 0:\n        return float('inf'), False\n    logs = np.log(x[:k] / u)\n    gamma_hat = np.mean(logs)\n    if gamma_hat <= 1e-9:\n        return float('inf'), False\n    alpha_hat = 1.0 / gamma_hat\n    return alpha_hat, True\n\ndef detect_plasmoid(E, J, dt, T):\n    \"\"\"\n    Apply detection criteria:\n    - Intermittency: max(F_E(tau_s), F_J(tau_s)) > 5 and one of F(tau_s) > F(tau_l)\n    - Burst activity: r > 6 s^-1\n    - Heavy tail: alpha_hat <= 3 and valid Hill estimate with k>=5\n    \"\"\"\n    # Compute flatness at two scales\n    k_small = 5\n    k_large = 40\n    F_E_s, F_E_l = structure_functions_flatness(E, dt, k_small, k_large)\n    F_J_s, F_J_l = structure_functions_flatness(J, dt, k_small, k_large)\n    intermittency = (max(F_E_s, F_J_s) > 5.0) and ((F_E_s > F_E_l) or (F_J_s > F_J_l))\n\n    # Fused magnitude and bursts\n    M = np.sqrt(E**2 + J**2)\n    thr = mad_threshold(M, kappa=3.0)\n    bursts, peaks = extract_bursts(M, thr, min_len=3)\n    N_b = len(bursts)\n    r = N_b / T if T > 0 else 0 # s^-1\n    burst_active = (r > 6.0)\n\n    # Heavy tail via Hill estimator\n    alpha_hat, valid = hill_alpha(peaks, min_k=5, max_k=10)\n    heavy_tail = valid and (alpha_hat <= 3.0)\n\n    return intermittency and burst_active and heavy_tail\n\ndef solve():\n    # Define test cases as specified in the problem statement.\n    test_cases = [\n        # Case A: Laminar resistive baseline\n        {\n            \"T\": 1.0, \"dt\": 5e-4, \"eta\": 0.1, \"chi\": 0.0, \"sigma_E\": 0.02, \"sigma_J\": 0.02,\n            \"lam\": 0.0, \"w_range\": (0.008, 0.012), \"amp_dist\": None\n        },\n        # Case B: Borderline transitional (thin tails, few bursts)\n        {\n            \"T\": 1.0, \"dt\": 5e-4, \"eta\": 0.1, \"chi\": 0.02, \"sigma_E\": 0.03, \"sigma_J\": 0.03,\n            \"lam\": 2.0, \"w_range\": (0.008, 0.015), \"amp_dist\": {\"type\": \"exp\", \"b\": 0.25}\n        },\n        # Case C: Plasmoid-mediated regime (heavy tails, frequent bursts)\n        {\n            \"T\": 1.0, \"dt\": 5e-4, \"eta\": 0.1, \"chi\": 0.05, \"sigma_E\": 0.03, \"sigma_J\": 0.03,\n            \"lam\": 10.0, \"w_range\": (0.004, 0.015), \"amp_dist\": {\"type\": \"pareto\", \"alpha\": 2.0, \"xmin\": 0.3}\n        },\n        # Case D: Edge case, zero variability\n        {\n            \"T\": 0.5, \"dt\": 5e-4, \"eta\": 0.1, \"chi\": 0.0, \"sigma_E\": 0.0, \"sigma_J\": 0.0,\n            \"lam\": 0.0, \"w_range\": (0.008, 0.012), \"amp_dist\": None\n        },\n    ]\n\n    # Global RNG for reproducibility across all cases\n    np.random.seed(0)\n    results = []\n    for case in test_cases:\n        # Generate data\n        t, E, J = generate_time_series(**case)\n        # Detect plasmoid regime\n        is_plasmoid = detect_plasmoid(E, J, case[\"dt\"], case[\"T\"])\n        results.append(is_plasmoid)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}