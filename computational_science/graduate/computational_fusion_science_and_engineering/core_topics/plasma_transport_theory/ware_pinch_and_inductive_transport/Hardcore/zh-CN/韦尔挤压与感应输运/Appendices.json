{
    "hands_on_practices": [
        {
            "introduction": "在应用一个概念之前，理解其物理根源至关重要。本练习将引导您从第一性原理出发，推导Ware内收速度。通过从被捕获粒子的环向正则动量守恒入手，您将揭示感应环向电场与向内的径向漂移之间的直接联系，并理解为何在非感应驱动的情况下此效应会消失。",
            "id": "4062546",
            "problem": "考虑一个大环径比、圆形截面、轴对称的托卡马克等离子体，其在由外部施加的射频（RF）电流驱动维持的完全非感应状态下运行。在这种情况下，诊断确认在所关注的时间区间内，对于所有半径 $r$ 和时间 $t$，环向电场恒为零，即 $E_{\\phi}(r,t) = 0$。假设使用标准的磁通坐标，其中极向磁通量 $\\psi_{p}(r,t)$ 标记磁通面，大半径 $R$ 与极向角无关，且极向磁场 $B_{\\theta}(r)$ 是有限且平滑的。捕获粒子的导心运动是弹跳平均的，并且托卡马克是严格轴对称的，因此环向正则动量守恒适用。\n\n从第一性原理出发——具体来说，即麦克斯韦-法拉第感应定律、作为磁通面标签的极向磁通量定义，以及为了保持在给定磁通面上所需的 $\\psi_{p}$ 的时间演化与径向运动 $dr/dt$ 之间的关系——推导捕获粒子的 Ware 箍缩速度 $v_{W}(r,t)$。然后，在所述的非感应条件 $E_{\\phi}=0$ 下计算 $v_{W}$ 的值，并在相同的逻辑框架内解释，为何在此期间观测到的任何中心密度峰化现象都必须归因于非 Ware 机制。\n\n你最终计算出的答案必须是针对所述情况下的 $v_{W}$ 值，单位为 $\\mathrm{m/s}$。最终速度以 $\\mathrm{m/s}$ 表示。不需要进行数值近似。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、内容完备且提法恰当的。该问题是等离子体物理学中新经典输运理论的一个标准推导，并且所有给定的条件在托卡马克研究的背景下都具有物理意义。我现在开始进行解答。\n\nWare 箍缩速度的推导始于带电粒子在轴对称磁场中的环向正则动量 $P_{\\phi}$。对于一个电荷为 $q$、质量为 $m$ 的粒子，其环向正则动量由下式给出：\n$$P_{\\phi} = m R v_{\\phi} + q \\psi_{p}$$\n其中 $R$ 是大半径，$v_{\\phi}$ 是粒子的环向速度，$\\psi_{p}$ 是单位环向角的极向磁通量。在轴对称磁场中，环向正则动量 $P_{\\phi}$ 的变化率由环向广义力决定，即 $\\frac{d P_{\\phi}}{dt} = q R E_{\\phi}$。问题陈述的特定条件是完全非感应状态，即 $E_{\\phi}=0$。因此，在这种特殊情况下，跟随着导心的 $P_{\\phi}$ 的全时间导数为零：\n$$\\frac{d P_{\\phi}}{dt} = 0$$\n\nWare 箍缩专门描述捕获粒子的运动。捕获粒子的一个关键特征是它们被限制在磁阱中，并在两个反弹点之间振荡。它们在一个弹跳周期内平均的净环向运动为零。也就是说，弹跳平均的环向速度为 $\\langle v_{\\phi} \\rangle = 0$。\n\n对捕获粒子的 $P_{\\phi}$ 守恒应用弹跳平均算符，我们得到：\n$$\\left\\langle \\frac{d P_{\\phi}}{dt} \\right\\rangle = \\left\\langle \\frac{d}{dt} (m R v_{\\phi} + q \\psi_{p}) \\right\\rangle = 0$$\n由于 $\\langle \\frac{d}{dt}(m R v_{\\phi}) \\rangle \\approx 0$ 对于捕获粒子是一个很好的近似，并且 $q$ 是常数，我们得到：\n$$q \\left\\langle \\frac{d \\psi_{p}}{dt} \\right\\rangle \\approx 0 \\implies \\left\\langle \\frac{d \\psi_{p}}{dt} \\right\\rangle = 0$$\n这个结果表明，在没有感应电场的情况下，捕获粒子的弹跳平均导心保持在恒定极向磁通量 $\\psi_{p}$ 的表面上。\n\n跟随着具有径向速度分量 $v_{r}$ 的粒子导心的 $\\psi_{p}(r,t)$ 的全时间导数表示为：\n$$\\frac{d \\psi_{p}}{dt} = \\frac{\\partial \\psi_{p}}{\\partial t} + v_{r} \\frac{\\partial \\psi_{p}}{\\partial r}$$\n对其进行弹跳平均，并使用上面的结果 $\\langle \\frac{d\\psi_p}{dt} \\rangle = 0$，我们得到：\n$$0 = \\left\\langle \\frac{\\partial \\psi_{p}}{\\partial t} \\right\\rangle + \\left\\langle v_{r} \\frac{\\partial \\psi_{p}}{\\partial r} \\right\\rangle \\approx \\frac{\\partial \\psi_{p}}{\\partial t} + \\langle v_{r} \\rangle \\frac{\\partial \\psi_{p}}{\\partial r}$$\n由此，我们可以解出径向漂移速度，即 Ware 箍缩速度 $v_{W} = \\langle v_r \\rangle$：\n$$v_{W} = - \\frac{\\frac{\\partial \\psi_{p}}{\\partial t}}{\\frac{\\partial \\psi_{p}}{\\partial r}}$$\n\n接下来，我们将此表达式中的各项与物理场 $E_{\\phi}$ 和 $B_{\\theta}$ 联系起来。\n\n首先，我们使用麦克斯韦感应定律（法拉第定律），$\\nabla \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t}$。对于一个位于固定垂直位置、大半径为 $R$ 的环向回路，其积分形式为：\n$$\\oint \\vec{E} \\cdot d\\vec{l} = - \\frac{d}{dt} \\iint \\vec{B} \\cdot d\\vec{S}$$\n由于轴对称性，左边的线积分为 $2\\pi R E_{\\phi}$。右边是穿过该回路所包围圆盘的极向磁通量 $\\Psi_{p}$ 的时间变化率。使用 $\\psi_{p} = \\Psi_{p} / (2\\pi)$：\n$$2\\pi R E_{\\phi} = - \\frac{\\partial (2\\pi \\psi_{p})}{\\partial t} \\implies \\frac{\\partial \\psi_{p}}{\\partial t} = -R E_{\\phi}$$\n\n其次，我们将 $\\psi_{p}$ 的径向梯度与极向磁场 $B_{\\theta}$ 联系起来。极向磁场由极向磁通量函数通过 $\\vec{B}_{p} = \\frac{1}{R} \\nabla \\psi_{p} \\times \\hat{\\phi}$ 导出。对于大环径比、圆形截面几何，其中 $\\nabla \\psi_{p} \\approx \\frac{\\partial \\psi_{p}}{\\partial r} \\hat{r}$ 且 $\\hat{\\theta} = \\hat{\\phi} \\times \\hat{r}$，我们有：\n$$B_{\\theta} \\hat{\\theta} = \\frac{1}{R} \\left( \\frac{\\partial \\psi_{p}}{\\partial r} \\hat{r} \\right) \\times \\hat{\\phi} = -\\frac{1}{R} \\frac{\\partial \\psi_{p}}{\\partial r} (\\hat{\\phi} \\times \\hat{r}) = -\\frac{1}{R} \\frac{\\partial \\psi_{p}}{\\partial r} \\hat{\\theta}$$\n比较各个分量，我们发现：\n$$\\frac{\\partial \\psi_{p}}{\\partial r} = -R B_{\\theta}$$\n\n现在，我们将这两个推导出的关系式代回 $v_{W}$ 的表达式中：\n$$v_{W} = - \\frac{\\frac{\\partial \\psi_{p}}{\\partial t}}{\\frac{\\partial \\psi_{p}}{\\partial r}} = - \\frac{-R E_{\\phi}}{-R B_{\\theta}} = - \\frac{E_{\\phi}}{B_{\\theta}}$$\n这就是 Ware 箍缩速度 $v_{W}(r,t)$ 的通用表达式。\n\n现在，问题要求我们在一个完全非感应状态的特定条件下计算 $v_{W}$ 的值，在该条件下环向电场恒为零，即 $E_{\\phi}(r, t) = 0$。问题还指出极向磁场 $B_{\\theta}(r)$ 是有限的。将给定条件代入我们推导的公式中：\n$$v_{W} = - \\frac{0}{B_{\\theta}} = 0$$\n在指定条件下，等离子体中各处的 Ware 箍缩速度恒为零。\n\n最后，我们必须解释为什么任何观测到的中心密度峰化都必须归因于非 Ware 机制。Ware 箍缩是一种新经典输运效应，它驱动捕获粒子向内输运，其通量与 $E_{\\phi}$ 成正比。在常规的感应驱动托卡马克中，$E_{\\phi}$ 非零，用于驱动环向电流，因此 Ware 箍缩有助于等离子体芯部的密度峰化。然而，在所描述的情景中——一个 $E_{\\phi} = 0$ 的完全非感应等离子体——Ware 箍缩的驱动力消失了。正如我们刚刚计算的，$v_{W} = 0$。因此，Ware 箍缩机制不能将任何粒子向径向内或向外输运，它不可能是任何观测到的密度累积或峰化的原因。如果实验诊断同时确认了 $E_{\\phi} = 0$ 和中心峰化的密度剖面，那么从这个理论框架可以直接得出结论，必定是其他物理机制在起作用。这些机制可能包括湍流输运（例如，由微不稳定性驱动的反常向内箍缩）、其他新经典效应（如热电箍缩）或芯部粒子源（如中性束注入）。感应电场的缺失使得粒子输运与这一特定的新经典效应解耦，迫使我们必须考虑其他输运通道来解释所观测到的等离子体状态。\n\n在这种非感应情况下，Ware 箍缩速度 $v_{W}$ 的最终计算值为 $0 \\, \\mathrm{m/s}$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Ware内收不仅仅是一个理论概念，它通过影响密度分布对等离子体性能产生实际影响。本练习将理论与定量应用相结合。您将使用环电压和等离子体电流等宏观参数，在一个简化的输运模型中计算内收速度，并确定其对稳态密度峰化因子的影响。",
            "id": "3964879",
            "problem": "考虑一个轴对称托卡马克等离子体，其由柱坐标系下的一维（1D）简化粒子输运方程建模，小半径为 $a$，大半径为 $R$。该输运模型包含一个具有恒定扩散系数 $D_0$ 的扩散粒子通量，以及一个由环向电场驱动的新经典感应内向夹缩所引起的对流通量。假设等离子体具有圆形截面、大环径比和均匀的环向电流密度。环向电场由外部施加的环电压维持。在国际单位制（SI）下进行计算。\n\n从基本定律出发，使用 Faraday 定律将环向电场与所施加的环电压联系起来，并使用 Ampère 定律估计等离子体边界处的磁面平均极向磁场。在无体粒子源、边界密度固定以及磁轴处具有正则性的假设下，从连续性方程和本构关系出发，论证对流夹缩如何改变稳态密度分布。\n\n参数：\n- 大半径：$R = 3.0\\,\\mathrm{m}$。\n- 小半径：$a = 0.70\\,\\mathrm{m}$。\n- 总等离子体电流：$I_p = 1.8 \\times 10^6\\,\\mathrm{A}$。\n- 环电压：$V_{\\text{loop}} = 1.9\\,\\mathrm{V}$。\n- 恒定粒子扩散系数：$D_0 = 0.80\\,\\mathrm{m^2/s}$。\n- 自由空间磁导率：$\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$。\n\n利用这些参数，计算在此简化模型中由感应夹缩所决定的稳态密度尖峰因子 $n(0)/n(a)$。最终答案以无量纲数表示，并四舍五入至四位有效数字。",
            "solution": "通过遵循指定流程对问题进行验证。\n\n### 步骤1：提取已知条件\n-   **模型**：用于轴对称托卡马克等离子体的一维（1D）简化粒子输运方程，采用柱坐标系。\n-   **几何形状**：圆形截面，大环径比。\n-   **小半径**：$a = 0.70\\,\\mathrm{m}$。\n-   **大半径**：$R = 3.0\\,\\mathrm{m}$。\n-   **粒子通量**：由扩散通量和对流通量组成。\n-   **扩散系数**：恒定粒子扩散系数，$D_0 = 0.80\\,\\mathrm{m^2/s}$。\n-   **对流**：由环向电场驱动的新经典感应内向夹缩。\n-   **电流分布**：均匀环向电流密度。\n-   **总等离子体电流**：$I_p = 1.8 \\times 10^6\\,\\mathrm{A}$。\n-   **环电压**：$V_{\\text{loop}} = 1.9\\,\\mathrm{V}$。\n-   **磁导率**：$\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$。\n-   **假设**：稳态，无体粒子源，固定的边界密度 $n(a)$，磁轴（$r=0$）处的正则性。\n-   **目标**：计算稳态密度尖峰因子 $n(0)/n(a)$。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题坚实地植根于等离子体物理和输运理论的原理。它利用了 Faraday 定律、Ampère 定律和连续性方程等基本定律。感应（Ware）夹缩的概念是托卡马克中一个公认的新经典输运效应。在聚变科学中，使用带有简化假设（恒定扩散系数，均匀电流密度）的一维简化模型是进行解析估算的常规且有效的方法。\n-   **适定性**：该问题提供了一个微分方程（从输运模型导出）和足够数量的边界条件（在 $r=a$ 处密度固定和在 $r=0$ 处正则），以确定密度分布 $n(r)$ 的唯一解。所有必需的物理参数（$R$、$a$、$I_p$、$V_{\\text{loop}}$、$D_0$、$\\mu_0$）均已给出。\n-   **目标**：问题以精确、定量和无偏见的技术语言陈述。它要求基于所提供的模型和数据进行特定计算，没有主观解释的余地。\n\n该问题没有表现出说明中列出的任何缺陷（例如，科学上不健全、不完整、含糊不清）。一个潜在的模糊之处——如何处理磁轴处夹缩速度的奇点——通过指令“估计等离子体边界处的磁面平均极向磁场”得到了隐含的解决，这表明在简化模型中为避免此问题而使用了一种标准简化方法。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、附有推理过程的解答。\n\n分析始于柱坐标系 $(r, \\theta, \\phi)$ 下的粒子连续性方程，其中 $r$ 是小半径坐标。对于一个密度没有极向或环向变化的轴对称系统，其连续性方程为：\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{1}{r}\\frac{\\partial}{\\partial r}(r\\Gamma_r) = S\n$$\n其中 $n$ 是粒子密度，$\\Gamma_r$ 是径向粒子通量，$S$ 是粒子源/汇项。问题指定了稳态条件（$\\frac{\\partial n}{\\partial t}=0$）和无体粒子源（$S=0$）。因此，方程简化为：\n$$\n\\frac{d}{dr}(r\\Gamma_r) = 0\n$$\n对该方程关于 $r$ 积分，得到 $r\\Gamma_r = \\text{常数}$。“磁轴处的正则性”条件要求粒子通量 $\\Gamma_r$ 在 $r=0$ 处是有限的。为了使乘积 $r\\Gamma_r$ 在 $r \\to 0$ 时保持为常数，该常数必须为零。因此，对于无源稳态，等离子体中各处的粒子通量必须为零：\n$$\n\\Gamma_r(r) = 0\n$$\n问题陈述粒子通量由一个扩散分量和一个对流分量组成：\n$$\n\\Gamma_r(r) = -D_0 \\frac{dn}{dr} + n(r)v_r(r)\n$$\n其中 $D_0$ 是恒定扩散系数，$v_r(r)$ 是对流夹缩速度。将总通量设为零，得到扩散与对流之间的平衡关系：\n$$\nD_0 \\frac{dn}{dr} = n(r)v_r(r)\n$$\n对流速度是新经典感应夹缩（Ware 夹缩），由 $v_r = -E_\\phi/B_\\theta$ 给出，其中 $E_\\phi$ 是环向电场，$B_\\theta$ 是极向磁场。负号表示向内夹缩（对于 $E_\\phi$ 和 $B_\\theta$ 的标准符号约定）。\n\n首先，我们使用 Faraday 电磁感应定律将环向电场 $E_\\phi$ 与给定的环电压 $V_{\\text{loop}}$ 联系起来。对于一个大半径为 $R$ 的环路，环电压是电场沿环向的线积分：\n$$\nV_{\\text{loop}} = \\oint \\mathbf{E} \\cdot d\\mathbf{l} = E_\\phi (2\\pi R)\n$$\n假设环向电场是均匀的，我们有：\n$$\nE_\\phi = \\frac{V_{\\text{loop}}}{2\\pi R}\n$$\n接下来，我们估计极向磁场 $B_\\theta$。问题指示我们使用 Ampère 定律来估计等离子体边界（$r=a$）处的 $B_\\theta$。对一个半径为 $a$、包围整个等离子体电流 $I_p$ 的圆形回路应用 Ampère 定律：\n$$\n\\oint \\mathbf{B} \\cdot d\\mathbf{l} = \\mu_0 I_{\\text{enc}} \\implies B_\\theta(a) (2\\pi a) = \\mu_0 I_p\n$$\n这给出了边界处的极向磁场：\n$$\nB_\\theta(a) = \\frac{\\mu_0 I_p}{2\\pi a}\n$$\n在一维简化模型中，一个常见的简化是用一个恒定值来近似空间变化的夹缩速度。我们使用边界处的极向磁场值来定义一个特征性的、空间恒定的夹缩速度 $v_0$。这避免了因假设均匀电流密度（这意味着 $B_\\theta(r) \\propto r$）而在 $r=0$ 处产生的夹缩速度 $v_r \\propto 1/B_\\theta(r)$ 的奇点。\n$$\nv_r \\approx v_0 = -\\frac{E_\\phi}{B_\\theta(a)} = -\\frac{V_{\\text{loop}}/(2\\pi R)}{\\mu_0 I_p/(2\\pi a)} = -\\frac{V_{\\text{loop}} a}{\\mu_0 I_p R}\n$$\n现在我们可以将这个恒定的夹缩速度 $v_0$ 代入通量平衡方程：\n$$\nD_0 \\frac{dn}{dr} = n(r) v_0\n$$\n这是一个关于密度分布 $n(r)$ 的一阶可分离常微分方程：\n$$\n\\frac{dn}{n} = \\frac{v_0}{D_0} dr\n$$\n将两边从等离子体边界 $r=a$ 积分到任意半径 $r$：\n$$\n\\int_{n(a)}^{n(r)} \\frac{dn'}{n'} = \\int_a^r \\frac{v_0}{D_0} dr' \\implies \\ln\\left(\\frac{n(r)}{n(a)}\\right) = \\frac{v_0}{D_0}(r-a)\n$$\n求解 $n(r)$ 得到密度分布：\n$$\nn(r) = n(a) \\exp\\left(\\frac{v_0}{D_0}(r-a)\\right)\n$$\n我们需要计算密度尖峰因子，即中心密度 $n(0)$ 与边界密度 $n(a)$ 之比。我们在 $r=0$ 处计算该分布：\n$$\nn(0) = n(a) \\exp\\left(\\frac{v_0}{D_0}(0-a)\\right) = n(a) \\exp\\left(-\\frac{v_0 a}{D_0}\\right)\n$$\n因此，尖峰因子为：\n$$\n\\frac{n(0)}{n(a)} = \\exp\\left(-\\frac{v_0 a}{D_0}\\right)\n$$\n代入 $v_0$ 的表达式：\n$$\n\\frac{n(0)}{n(a)} = \\exp\\left(-\\left(-\\frac{V_{\\text{loop}} a}{\\mu_0 I_p R}\\right) \\frac{a}{D_0}\\right) = \\exp\\left(\\frac{V_{\\text{loop}} a^2}{\\mu_0 I_p R D_0}\\right)\n$$\n指数是一个无量纲量，通常称为夹缩佩克莱数。让我们使用给定的参数计算其值：\n$V_{\\text{loop}} = 1.9\\,\\mathrm{V}$\n$a = 0.70\\,\\mathrm{m}$\n$\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$\n$I_p = 1.8 \\times 10^6\\,\\mathrm{A}$\n$R = 3.0\\,\\mathrm{m}$\n$D_0 = 0.80\\,\\mathrm{m^2/s}$\n\n指数，我们称之为 $\\mathcal{S}$，是：\n$$\n\\mathcal{S} = \\frac{V_{\\text{loop}} a^2}{\\mu_0 I_p R D_0} = \\frac{(1.9) \\times (0.70)^2}{(4\\pi \\times 10^{-7}) \\times (1.8 \\times 10^6) \\times (3.0) \\times (0.80)}\n$$\n$$\n\\mathcal{S} = \\frac{1.9 \\times 0.49}{4\\pi \\times 1.8 \\times 3.0 \\times 0.80 \\times 10^{-1}} = \\frac{0.931}{5.42867\\ldots}\n$$\n$$\n\\mathcal{S} \\approx 0.17150\n$$\n那么密度尖峰因子是：\n$$\n\\frac{n(0)}{n(a)} = \\exp(\\mathcal{S}) = \\exp(0.17150) \\approx 1.187112\n$$\n将结果四舍五入到四位有效数字，得到 $1.187$。",
            "answer": "$$\n\\boxed{1.187}\n$$"
        },
        {
            "introduction": "真实的等离子体剖面是复杂的且随半径变化的。为了精确地模拟输运，我们必须超越简单的近似，计算具有空间分辨的物理量。本计算练习要求您通过引入安全因子剖面$q(r)$并考虑被捕获粒子份额，来计算Ware内收速度的径向剖面$v_W(r)$ 。这项练习将分析理论与实际输运建模联系起来。",
            "id": "4062613",
            "problem": "考虑一个大环径比、轴对称的托卡马克，其大半径为 $R_0$，小半径为 $a$，环向磁场为 $B_{\\phi}$，测得的环路电压为 $V_{\\text{loop}}$。环向电场 $E_{\\phi}(r)$ 由变压器作用感应产生，并通过法拉第电磁感应定律与环路电压相关。安全因子剖面 $q(r)$ 由磁测量给出。目标是在简化的新经典模型下，计算捕获粒子的Ware箍缩速度 $v_W(r)$ 的径向剖面，并量化由几何平均引起的不确定性。\n\n使用以下基本依据和定义：\n- 法拉第电磁感应定律：\n$$\\oint \\mathbf{E} \\cdot d\\mathbf{l} = - \\frac{d}{dt}\\int \\mathbf{B} \\cdot d\\mathbf{S}.$$\n假设存在稳态感应驱动，测得的环路电压为 $V_{\\text{loop}}$，使得环向电场的大小为\n$$E_{\\phi}(r) = \\frac{V_{\\text{loop}}}{2\\pi R_0}.$$\n由于大环径比近似，将 $E_{\\phi}$ 视为在磁通面上是均匀的。\n- 安全因子的定义：\n$$q(r) = \\frac{r B_{\\phi}}{R_0 B_{\\theta}(r)},$$\n这意味着\n$$B_{\\theta}(r) = \\frac{r B_{\\phi}}{R_0 q(r)}.$$\n- 在圆形截面、大环径比托卡马克的简化新经典捕获粒子模型下，Ware箍缩速度可以表示为\n$$v_W(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} G(\\varepsilon), \\quad \\varepsilon \\equiv \\frac{r}{R_0},$$\n其中 $G(\\varepsilon)$ 是一个几何因子，反映了捕获粒子的份额和弹跳平均漂移投影。在圆形截面、大环径比近似中，捕获粒子份额与 $\\sqrt{\\varepsilon}$ 成正比，即 $f_t \\propto \\sqrt{\\varepsilon}$；因此取\n$$G(\\varepsilon) = \\kappa \\sqrt{\\varepsilon},$$\n其中 $\\kappa$ 是一个不确定性系数，反映了几何平均、位形和弹跳平均近似的影响。为了进行不确定性量化，使用界限 $\\kappa_{\\min}$ 和 $\\kappa_{\\max}$ 来计算下限和上限估计值：\n$$v_W^{\\text{low}}(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} \\kappa_{\\min} \\sqrt{\\varepsilon}, \\quad v_W^{\\text{nom}}(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} \\kappa_{\\text{nom}} \\sqrt{\\varepsilon}, \\quad v_W^{\\text{high}}(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} \\kappa_{\\max} \\sqrt{\\varepsilon}.$$\n\n假设安全因子由以下函数形式给出\n$$q(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^n,$$\n指数 $n$ 在每个案例中指定。程序必须在指定的径向点 $r_i$ 处计算 $v_W(r)$。\n\n所有速度必须以 $\\text{m/s}$ 为单位报告。\n\n实现一个程序，针对下面的每个测试案例，在给定的径向网格上计算三个列表：名义Ware箍缩速度 $v_W^{\\text{nom}}(r_i)$、下限速度 $v_W^{\\text{low}}(r_i)$ 和上限速度 $v_W^{\\text{high}}(r_i)$。将所有测试案例的结果汇总到单行输出中，其中包含每个案例的串联列表，顺序如下：对于每个案例，首先列出所有 $r_i$ 的 $v_W^{\\text{nom}}(r_i)$，然后是所有 $r_i$ 的 $v_W^{\\text{low}}(r_i)$，最后是所有 $r_i$ 的 $v_W^{\\text{high}}(r_i)$。最终输出必须是单行，包含一个由方括号括起来的、逗号分隔的浮点数列表。\n\n测试套件：\n- 案例1（理想路径，中等参数）：\n    - $R_0 = 3.0\\,\\text{m}$, $a = 1.0\\,\\text{m}$, $B_{\\phi} = 5.3\\,\\text{T}$, $V_{\\text{loop}} = 1.2\\,\\text{V}$,\n    - $q_0 = 1.0$, $\\alpha = 1.8$, $n = 2$,\n    - $\\kappa_{\\min} = 0.9$, $\\kappa_{\\text{nom}} = 1.1$, $\\kappa_{\\max} = 1.3$,\n    - 径向点 $r_i \\in \\{0.1 a, 0.3 a, 0.5 a, 0.7 a, 0.9 a\\}$。\n- 案例2（边缘情况：感应驱动消失）：\n    - $R_0 = 3.0\\,\\text{m}$, $a = 1.0\\,\\text{m}$, $B_{\\phi} = 5.3\\,\\text{T}$, $V_{\\text{loop}} = 0.0\\,\\text{V}$,\n    - $q_0 = 1.0$, $\\alpha = 1.8$, $n = 2$,\n    - $\\kappa_{\\min} = 0.8$, $\\kappa_{\\text{nom}} = 1.0$, $\\kappa_{\\max} = 1.2$,\n    - 径向点 $r_i \\in \\{0.1 a, 0.3 a, 0.5 a, 0.7 a, 0.9 a\\}$。\n- 案例3（靠近磁轴的边界覆盖和更强的位形）：\n    - $R_0 = 6.0\\,\\text{m}$, $a = 2.0\\,\\text{m}$, $B_{\\phi} = 2.5\\,\\text{T}$, $V_{\\text{loop}} = 2.0\\,\\text{V}$,\n    - $q_0 = 0.9$, $\\alpha = 3.0$, $n = 2$,\n    - $\\kappa_{\\min} = 0.7$, $\\kappa_{\\text{nom}} = 1.0$, $\\kappa_{\\max} = 1.5$,\n    - 径向点 $r_i \\in \\{0.05 a, 0.2 a, 0.4 a, 0.6 a, 0.8 a, 0.95 a\\}$。\n- 案例4（剖面敏感性：具有四次变化的更平坦的 $q(r)$）：\n    - $R_0 = 3.5\\,\\text{m}$, $a = 0.8\\,\\text{m}$, $B_{\\phi} = 4.0\\,\\text{T}$, $V_{\\text{loop}} = 0.5\\,\\text{V}$,\n    - $q_0 = 1.2$, $\\alpha = 0.5$, $n = 4$,\n    - $\\kappa_{\\min} = 0.85$, $\\kappa_{\\text{nom}} = 1.0$, $\\kappa_{\\max} = 1.25$,\n    - 径向点 $r_i \\in \\{0.1 a, 0.3 a, 0.5 a, 0.7 a\\}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的列表。对于每个案例，列出 $N$ 个名义值 $[v_W^{\\text{nom}}(r_1), \\ldots, v_W^{\\text{nom}}(r_N)]$，然后是 $N$ 个下限值 $[v_W^{\\text{low}}(r_1), \\ldots, v_W^{\\text{low}}(r_N)]$，最后是 $N$ 个上限值 $[v_W^{\\text{high}}(r_1), \\ldots, v_W^{\\text{high}}(r_N)]$，并将所有案例的这些序列连接成一个单一的、由方括号括起来的列表。所有速度必须以 $\\text{m/s}$ 为单位。",
            "solution": "该问题被认为是有效的，因为它科学地基于托卡马克等离子体中的新经典输运原理，问题陈述清晰，参数集完整且一致，并以客观、正式的语言表述。所提供的模型虽然经过简化，但代表了Ware箍缩效应的标准教科书级别的描述。所有参数在物理上都是合理的，不存在内部矛盾或歧义。\n\n目标是在一组指定的径向坐标“$r_i$”上计算Ware箍缩速度剖面“$v_W(r)$”。推导始于在简化的、大环径比、圆形托卡马克模型中给出的Ware箍缩速度的定义：\n$$v_W(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} G(\\varepsilon)$$\n其中“$E_{\\phi}(r)$”是环向电场，“$B_{\\theta}(r)$”是极向磁场，“$G(\\varepsilon)$”是与捕获粒子份额相关的几何因子。反环径比定义为“$\\varepsilon \\equiv r/R_0$”。\n\n问题指定了此方程中每一项的形式。我们将系统地代入它们，以推导出最终的计算公式。\n\n首先，几何因子“$G(\\varepsilon)$”给出为：\n$$G(\\varepsilon) = \\kappa \\sqrt{\\varepsilon} = \\kappa \\sqrt{\\frac{r}{R_0}}$$\n此处，“$\\kappa$”是一个不确定性系数。\n\n其次，由于大环径比近似，环向电场“$E_{\\phi}(r)$”被假定为空间均匀的，并通过法拉第定律与环路电压“$V_{\\text{loop}}$”相关：\n$$E_{\\phi}(r) = E_{\\phi} = \\frac{V_{\\text{loop}}}{2\\pi R_0}$$\n\n第三，极向磁场“$B_{\\theta}(r)$”由安全因子“$q(r)$”的定义导出：\n$$q(r) = \\frac{r B_{\\phi}}{R_0 B_{\\theta}(r)} \\implies B_{\\theta}(r) = \\frac{r B_{\\phi}}{R_0 q(r)}$$\n\n将这三个表达式代入“$v_W(r)$”的初始方程：\n$$v_W(r) = - \\frac{\\left( \\frac{V_{\\text{loop}}}{2\\pi R_0} \\right)}{\\left( \\frac{r B_{\\phi}}{R_0 q(r)} \\right)} \\left( \\kappa \\sqrt{\\frac{r}{R_0}} \\right)$$\n\n此表达式可以通过代数方法简化。主分数中分子和分母的大半径“$R_0$”相互抵消：\n$$v_W(r) = - \\left( \\frac{V_{\\text{loop}}}{2\\pi} \\right) \\left( \\frac{q(r)}{r B_{\\phi}} \\right) \\left( \\kappa \\sqrt{\\frac{r}{R_0}} \\right)$$\n\n合并各项并分离出径向依赖关系：\n$$v_W(r) = - \\frac{V_{\\text{loop}} \\kappa}{2\\pi B_{\\phi} \\sqrt{R_0}} \\frac{q(r)}{r} \\sqrt{r} = - \\frac{V_{\\text{loop}} \\kappa}{2\\pi B_{\\phi} \\sqrt{R_0}} \\frac{q(r)}{\\sqrt{r}}$$\n验证此表达式的物理单位至关重要。当“$V_{\\text{loop}}$”的单位为伏特（“$V$”），“$B_{\\phi}$”的单位为特斯拉（“$T = V \\cdot s \\cdot m^{-2}$”），长度（“$R_0, r$”）的单位为米（“$m$”）时，最终得到的单位是“$m/s$”，这对于速度是正确的。\n\n最后一部分是安全因子剖面“$q(r)$”的函数形式：\n$$q(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^n$$\n将此代入我们简化的“$v_W(r)$”表达式中，得到用于计算的完整公式：\n$$v_W(r) = - \\frac{V_{\\text{loop}} \\kappa}{2\\pi B_{\\phi} \\sqrt{R_0}} \\frac{1}{\\sqrt{r}} \\left[ q_0 + \\alpha \\left(\\frac{r}{a}\\right)^n \\right]$$\n此公式在“$r > 0$”时有效。问题陈述提供的径向点“$r_i$”都严格为正，因此避免了在“$r=0$”处的奇点。\n\n为进行不确定性量化，我们通过代入给定的三个“$\\kappa$”值：“$\\kappa_{\\min}$”、“$\\kappa_{\\text{nom}}$”和“$\\kappa_{\\max}$”来计算三个速度剖面。这分别产生“$v_W^{\\text{low}}(r)$”、“$v_W^{\\text{nom}}(r)$”和“$v_W^{\\text{high}}(r)$”。\n\n算法实现过程如下：\n1.  定义一个函数来处理单个测试案例的计算。该函数将所有物理参数和剖面参数作为输入。\n2.  对于每个案例，首先根据小半径“$a$”和给定的半径分数计算径向网格点“$r_i$”。\n3.  为提高效率，对径向点“$r_i$”数组进行向量化计算。对所有“$r_i$”计算项“$q(r_i)$”。\n4.  然后对三个“$\\kappa$”值中的每一个评估主公式，生成分别对应于名义、下限和上限速度剖面的三个数组。\n5.  主脚本将四个测试案例定义为参数的结构化集合。它遍历每个案例，调用计算函数，并汇总结果。\n6.  最终输出通过按指定顺序连接每个案例的结果来构建：名义速度列表，后跟下限速度列表，然后是上限速度列表。对所有测试案例重复此序列，并将组合列表格式化为由方括号括起来的单个逗号分隔字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Ware pinch velocity profile across multiple test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path, moderate parameters)\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_phi\": 5.3, \"V_loop\": 1.2,\n            \"q0\": 1.0, \"alpha\": 1.8, \"n\": 2,\n            \"k_min\": 0.9, \"k_nom\": 1.1, \"k_max\": 1.3,\n            \"r_fractions\": np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n        },\n        # Case 2 (edge case: vanishing inductive drive)\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_phi\": 5.3, \"V_loop\": 0.0,\n            \"q0\": 1.0, \"alpha\": 1.8, \"n\": 2,\n            \"k_min\": 0.8, \"k_nom\": 1.0, \"k_max\": 1.2,\n            \"r_fractions\": np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n        },\n        # Case 3 (boundary coverage near magnetic axis and stronger shaping)\n        {\n            \"R0\": 6.0, \"a\": 2.0, \"B_phi\": 2.5, \"V_loop\": 2.0,\n            \"q0\": 0.9, \"alpha\": 3.0, \"n\": 2,\n            \"k_min\": 0.7, \"k_nom\": 1.0, \"k_max\": 1.5,\n            \"r_fractions\": np.array([0.05, 0.2, 0.4, 0.6, 0.8, 0.95]),\n        },\n        # Case 4 (profile sensitivity: flatter q(r) with quartic variation)\n        {\n            \"R0\": 3.5, \"a\": 0.8, \"B_phi\": 4.0, \"V_loop\": 0.5,\n            \"q0\": 1.2, \"alpha\": 0.5, \"n\": 4,\n            \"k_min\": 0.85, \"k_nom\": 1.0, \"k_max\": 1.25,\n            \"r_fractions\": np.array([0.1, 0.3, 0.5, 0.7]),\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Extract parameters for clarity\n        R0 = case[\"R0\"]\n        a = case[\"a\"]\n        B_phi = case[\"B_phi\"]\n        V_loop = case[\"V_loop\"]\n        q0 = case[\"q0\"]\n        alpha = case[\"alpha\"]\n        n = case[\"n\"]\n        k_values = {\"nom\": case[\"k_nom\"], \"low\": case[\"k_min\"], \"high\": case[\"k_max\"]}\n        r_fractions = case[\"r_fractions\"]\n\n        # Calculate radial grid in meters\n        r = r_fractions * a\n\n        # Handle the V_loop = 0 case to avoid unnecessary calculations and potential 0/0 issues if r=0 were allowed\n        if V_loop == 0.0:\n            num_points = len(r)\n            v_w_nom = np.zeros(num_points)\n            v_w_low = np.zeros(num_points)\n            v_w_high = np.zeros(num_points)\n        else:\n            # Calculate the safety factor profile q(r)\n            q_r = q0 + alpha * (r / a)**n\n\n            # Calculate the Ware pinch velocity v_W(r)\n            # v_W(r) = - (V_loop * k) / (2 * pi * B_phi * sqrt(R0)) * q(r) / sqrt(r)\n            constant_factor = -V_loop / (2.0 * np.pi * B_phi * np.sqrt(R0))\n            radial_dependent_factor = q_r / np.sqrt(r)\n            \n            # Note: np.sqrt(r) is safe as all r > 0 in test cases.\n            \n            v_w_nom = constant_factor * k_values[\"nom\"] * radial_dependent_factor\n            v_w_low = constant_factor * k_values[\"low\"] * radial_dependent_factor\n            v_w_high = constant_factor * k_values[\"high\"] * radial_dependent_factor\n\n        # Append results in the specified order: nom, low, high\n        all_results.extend(v_w_nom.tolist())\n        all_results.extend(v_w_low.tolist())\n        all_results.extend(v_w_high.tolist())\n\n    # Format output as a single comma-separated list of floats in brackets\n    print(f\"[{','.join(f'{val:.8f}' for val in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}