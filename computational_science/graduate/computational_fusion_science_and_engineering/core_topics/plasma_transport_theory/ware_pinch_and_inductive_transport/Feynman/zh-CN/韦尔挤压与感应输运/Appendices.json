{
    "hands_on_practices": [
        {
            "introduction": "第一个练习旨在建立对瓦尔内箍缩效应如何影响等离子体密度的基本理解。通过一个简化的理想一维模型，您将把法拉第感应定律和安培定律等基本物理原理与最终形成的稳态密度分布直接联系起来。这项实践对于培养关于外部施加场如何驱动内部等离子体输运并塑造其分布的物理直觉至关重要。",
            "id": "3964879",
            "problem": "考虑一个轴对称托卡马克等离子体，其由柱坐标系下的一维（1D）简化粒子输运方程描述，小半径为 $a$，大半径为 $R$。该输运模型包含一个具有恒定扩散系数 $D_0$ 的扩散粒子通量，以及一个由环向电场驱动的新经典感应箍缩引起的对流通量。假设等离子体具有圆形截面、大环径比和均匀的环向电流密度。环向电场由外部施加的环路电压维持。在国际单位制（SI）下进行计算。\n\n从基本定律出发，利用法拉第定律将环向电场与所施加的环路电压联系起来，并利用安培定律估算等离子体边缘的磁通面平均极向磁场。在无体粒子源、边缘密度固定和磁轴处正则性的假设下，从连续性方程和本构关系出发，论证对流箍缩如何改变稳态密度剖面。\n\n参数：\n- 大半径: $R = 3.0\\,\\mathrm{m}$。\n- 小半径: $a = 0.70\\,\\mathrm{m}$。\n- 总等离子体电流: $I_p = 1.8 \\times 10^6\\,\\mathrm{A}$。\n- 环路电压: $V_{\\text{loop}} = 1.9\\,\\mathrm{V}$。\n- 恒定粒子扩散系数: $D_0 = 0.80\\,\\mathrm{m^2/s}$。\n- 真空磁导率: $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$。\n\n利用这些参数，计算在该简化模型中由感应箍缩所决定的稳态密度尖峰因子 $n(0)/n(a)$。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "通过遵循指定程序对问题进行验证。\n\n### 步骤1：提取已知条件\n-   **模型**：针对轴对称托卡马克等离子体的一维（1D）简化粒子输运方程，采用柱坐标系。\n-   **几何**：圆形截面，大环径比。\n-   **小半径**：$a = 0.70\\,\\mathrm{m}$。\n-   **大半径**：$R = 3.0\\,\\mathrm{m}$。\n-   **粒子通量**：由扩散通量和对流通量组成。\n-   **扩散系数**：恒定粒子扩散系数，$D_0 = 0.80\\,\\mathrm{m^2/s}$。\n-   **对流**：由环向电场驱动的新经典感应箍缩。\n-   **电流剖面**：均匀环向电流密度。\n-   **总等离子体电流**：$I_p = 1.8 \\times 10^6\\,\\mathrm{A}$。\n-   **环路电压**：$V_{\\text{loop}} = 1.9\\,\\mathrm{V}$。\n-   **磁导率**：$\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$。\n-   **假设**：稳态，无体粒子源，边缘密度 $n(a)$ 固定，磁轴（$r=0$）处正则。\n-   **目标**：计算稳态密度尖峰因子 $n(0)/n(a)$。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题坚实地植根于等离子体物理和输运理论的原理。它利用了法拉第定律、安培定律和连续性方程等基本定律。感应（Ware）箍缩的概念是托卡马克中一个公认的新经典输运效应。在聚变科学中，使用带有简化假设（恒定扩散系数、均匀电流密度）的一维简化模型是进行解析估算的常规且有效的方法。\n-   **适定性**：该问题提供了一个微分方程（从输运模型导出）和足够数量的边界条件（在 $r=a$ 处密度固定，在 $r=0$ 处正则），以确定密度剖面 $n(r)$ 的唯一解。所有必要的物理参数（$R$、$a$、$I_p$、$V_{\\text{loop}}$、$D_0$、$\\mu_0$）都已给出。\n-   **目标**：问题以精确、定量且无偏见的技术语言陈述。它要求基于所提供的模型和数据进行特定计算，没有主观解释的余地。\n\n该问题没有表现出说明中列出的任何缺陷（例如，科学上不健全、不完整、含糊不清）。一个潜在的模糊之处——如何处理箍缩速度在磁轴处的奇异性——通过“估算等离子体边缘的磁通面平均极向磁场”的指令得到了隐含的解决，这表明在简化模型中为避免此问题而使用了一种标准简化方法。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n分析始于柱坐标系 $(r, \\theta, \\phi)$ 下的粒子连续性方程，其中 $r$ 是小半径坐标。对于一个密度没有极向或环向变化的轴对称系统，连续性方程为：\n$$\n\\frac{\\partial n}{\\partial t} + \\frac{1}{r}\\frac{\\partial}{\\partial r}(r\\Gamma_r) = S\n$$\n其中 $n$ 是粒子密度，$\\Gamma_r$ 是径向粒子通量，$S$ 是粒子源/汇项。问题指定了稳态条件（$\\frac{\\partial n}{\\partial t}=0$）和无体粒子源（$S=0$）。因此，方程简化为：\n$$\n\\frac{d}{dr}(r\\Gamma_r) = 0\n$$\n对该方程关于 $r$ 积分，得到 $r\\Gamma_r = \\text{constant}$。“磁轴处正则性”条件要求粒子通量 $\\Gamma_r$ 在 $r=0$ 处是有限的。为了使乘积 $r\\Gamma_r$ 在 $r \\to 0$ 时保持为常数，该常数必须为零。因此，对于无源稳态，等离子体中各处的粒子通量必须为零：\n$$\n\\Gamma_r(r) = 0\n$$\n问题陈述粒子通量由一个扩散分量和一个对流分量组成：\n$$\n\\Gamma_r(r) = -D_0 \\frac{dn}{dr} + n(r)v_r(r)\n$$\n其中 $D_0$ 是恒定扩散系数，$v_r(r)$ 是对流箍缩速度。将总通量设为零，得到扩散和对流之间的平衡关系：\n$$\nD_0 \\frac{dn}{dr} = n(r)v_r(r)\n$$\n对流速度是新经典感应箍缩（Ware箍缩），由 $v_r = -E_\\phi/B_\\theta$ 给出，其中 $E_\\phi$ 是环向电场，$B_\\theta$ 是极向磁场。负号表示向内的箍缩（对于 $E_\\phi$ 和 $B_\\theta$ 的标准符号约定）。\n\n首先，我们使用法拉第感应定律将环向电场 $E_\\phi$ 与给定的环路电压 $V_{\\text{loop}}$ 联系起来。对于一个大半径为 $R$ 的环路，环路电压是电场沿环的线积分：\n$$\nV_{\\text{loop}} = \\oint \\mathbf{E} \\cdot d\\mathbf{l} = E_\\phi (2\\pi R)\n$$\n假设环向电场是均匀的，我们有：\n$$\nE_\\phi = \\frac{V_{\\text{loop}}}{2\\pi R}\n$$\n接下来，我们估算极向磁场 $B_\\theta$。问题指导我们使用安培定律来估算等离子体边缘（$r=a$）处的 $B_\\theta$。将安培定律应用于一个半径为 $a$ 且包围整个等离子体电流 $I_p$ 的圆形回路：\n$$\n\\oint \\mathbf{B} \\cdot d\\mathbf{l} = \\mu_0 I_{\\text{enc}} \\implies B_\\theta(a) (2\\pi a) = \\mu_0 I_p\n$$\n这给出了边缘处的极向磁场：\n$$\nB_\\theta(a) = \\frac{\\mu_0 I_p}{2\\pi a}\n$$\n在一维简化模型中，一个常见的简化是用一个常数值来近似空间变化的箍缩速度。我们使用极向场的边缘值来定义一个特征性的、空间上恒定的箍缩速度 $v_0$。这避免了因均匀电流密度的假设（意味着 $B_\\theta(r) \\propto r$）而在 $r=0$ 处出现的箍缩速度 $v_r \\propto 1/B_\\theta(r)$ 的奇异性。\n$$\nv_r \\approx v_0 = -\\frac{E_\\phi}{B_\\theta(a)} = -\\frac{V_{\\text{loop}}/(2\\pi R)}{\\mu_0 I_p/(2\\pi a)} = -\\frac{V_{\\text{loop}} a}{\\mu_0 I_p R}\n$$\n现在我们可以将这个恒定的箍缩速度 $v_0$ 代入通量平衡方程：\n$$\nD_0 \\frac{dn}{dr} = n(r) v_0\n$$\n这是一个关于密度剖面 $n(r)$ 的一阶可分离常微分方程：\n$$\n\\frac{dn}{n} = \\frac{v_0}{D_0} dr\n$$\n将两边从等离子体边缘 $r=a$ 积分到一个任意半径 $r$：\n$$\n\\int_{n(a)}^{n(r)} \\frac{dn'}{n'} = \\int_a^r \\frac{v_0}{D_0} dr' \\implies \\ln\\left(\\frac{n(r)}{n(a)}\\right) = \\frac{v_0}{D_0}(r-a)\n$$\n求解 $n(r)$ 得到密度剖面：\n$$\nn(r) = n(a) \\exp\\left(\\frac{v_0}{D_0}(r-a)\\right)\n$$\n我们需要求的是密度尖峰因子，即中心密度 $n(0)$ 与边缘密度 $n(a)$ 之比。我们在 $r=0$ 处对剖面进行求值：\n$$\nn(0) = n(a) \\exp\\left(\\frac{v_0}{D_0}(0-a)\\right) = n(a) \\exp\\left(-\\frac{v_0 a}{D_0}\\right)\n$$\n因此，尖峰因子为：\n$$\n\\frac{n(0)}{n(a)} = \\exp\\left(-\\frac{v_0 a}{D_0}\\right)\n$$\n代入 $v_0$ 的表达式：\n$$\n\\frac{n(0)}{n(a)} = \\exp\\left(-\\left(-\\frac{V_{\\text{loop}} a}{\\mu_0 I_p R}\\right) \\frac{a}{D_0}\\right) = \\exp\\left(\\frac{V_{\\text{loop}} a^2}{\\mu_0 I_p R D_0}\\right)\n$$\n指数是一个无量纲量，通常称为箍缩佩克莱数。让我们用给定的参数计算它的值：\n$V_{\\text{loop}} = 1.9\\,\\mathrm{V}$\n$a = 0.70\\,\\mathrm{m}$\n$\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$\n$I_p = 1.8 \\times 10^6\\,\\mathrm{A}$\n$R = 3.0\\,\\mathrm{m}$\n$D_0 = 0.80\\,\\mathrm{m^2/s}$\n\n指数，我们称之为 $\\mathcal{S}$，为：\n$$\n\\mathcal{S} = \\frac{V_{\\text{loop}} a^2}{\\mu_0 I_p R D_0} = \\frac{(1.9) \\times (0.70)^2}{(4\\pi \\times 10^{-7}) \\times (1.8 \\times 10^6) \\times (3.0) \\times (0.80)}\n$$\n$$\n\\mathcal{S} = \\frac{1.9 \\times 0.49}{4\\pi \\times 1.8 \\times 3.0 \\times 0.80 \\times 10^{-1}} = \\frac{0.931}{5.42867\\ldots}\n$$\n$$\n\\mathcal{S} \\approx 0.17150\n$$\n那么密度尖峰因子就是：\n$$\n\\frac{n(0)}{n(a)} = \\exp(\\mathcal{S}) = \\exp(0.17150) \\approx 1.187112\n$$\n将结果四舍五入到四位有效数字，得到 $1.187$。",
            "answer": "$$\n\\boxed{1.187}\n$$"
        },
        {
            "introduction": "在基础模型的铺垫之上，下一个练习将引入更高程度的真实性。您将不再使用恒定的箍缩速度，而是通过引入安全因子径向分布$q(r)$来计算完整的瓦尔内箍缩速度径向剖面$v_W(r)$。这项计算任务不仅加深了您对磁场结构如何影响输运的理解，还引入了量化物理模型中不确定性的关键概念。",
            "id": "4062613",
            "problem": "考虑一个大环径比的轴对称托卡马克，其大半径为 $R_0$，小半径为 $a$，环向磁场为 $B_{\\phi}$，测得的环路电压为 $V_{\\text{loop}}$。环向电场 $E_{\\phi}(r)$ 由变压器作用感应产生，并通过法拉第电磁感应定律与环路电压相关。安全因子剖面 $q(r)$ 由磁测量提供。目标是在一个简化的新经典模型下，计算捕获粒子的 Ware 箍缩速度 $v_W(r)$ 的径向剖面，并量化由几何平均产生的不确定性。\n\n使用以下基本依据和定义：\n- 法拉第电磁感应定律：\n$$\\oint \\mathbf{E} \\cdot d\\mathbf{l} = - \\frac{d}{dt}\\int \\mathbf{B} \\cdot d\\mathbf{S}.$$\n假设存在稳态感应驱动，测得的环路电压为 $V_{\\text{loop}}$，使得环向电场的大小为\n$$E_{\\phi}(r) = \\frac{V_{\\text{loop}}}{2\\pi R_0}.$$\n由于大环径比近似，将 $E_{\\phi}$ 视为在磁通面上是均匀的。\n- 安全因子的定义：\n$$q(r) = \\frac{r B_{\\phi}}{R_0 B_{\\theta}(r)},$$\n这意味着\n$$B_{\\theta}(r) = \\frac{r B_{\\phi}}{R_0 q(r)}.$$\n- 在圆形截面、大环径比托卡马克的简化新经典捕获粒子模型下，Ware 箍缩速度可以表示为\n$$v_W(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} G(\\varepsilon), \\quad \\varepsilon \\equiv \\frac{r}{R_0},$$\n其中 $G(\\varepsilon)$ 是一个几何因子，描述了捕获粒子的份额和弹跳平均漂移投影。在圆形截面、大环径比近似中，捕获粒子份额 $f_t \\propto \\sqrt{\\varepsilon}$；因此取\n$$G(\\varepsilon) = \\kappa \\sqrt{\\varepsilon},$$\n其中 $\\kappa$ 是一个不确定性系数，反映了几何平均、截面形状和弹跳平均近似所带来的影响。为进行不确定性量化，使用边界 $\\kappa_{\\min}$ 和 $\\kappa_{\\max}$ 来计算下限和上限估计值：\n$$v_W^{\\text{low}}(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} \\kappa_{\\min} \\sqrt{\\varepsilon}, \\quad v_W^{\\text{nom}}(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} \\kappa_{\\text{nom}} \\sqrt{\\varepsilon}, \\quad v_W^{\\text{high}}(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} \\kappa_{\\max} \\sqrt{\\varepsilon}.$$\n\n假设安全因子由函数形式\n$$q(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^n,$$\n给出，其中指数 $n$ 在每个案例中指定。程序必须在指定的径向点 $r_i$ 处计算 $v_W(r)$。\n\n所有速度必须以 $\\text{m/s}$ 为单位报告。\n\n实现一个程序，对下述每个测试案例，在提供的径向网格上计算三个列表：名义 Ware 箍缩速度 $v_W^{\\text{nom}}(r_i)$、下限速度 $v_W^{\\text{low}}(r_i)$ 和上限速度 $v_W^{\\text{high}}(r_i)$。将所有测试案例的结果汇总到单行输出中，该输出包含按以下顺序为每个案例连接起来的列表：对于每个案例，首先是所有 $r_i$ 对应的 $v_W^{\\text{nom}}(r_i)$ 列表，然后是所有 $r_i$ 对应的 $v_W^{\\text{low}}(r_i)$ 列表，最后是所有 $r_i$ 对应的 $v_W^{\\text{high}}(r_i)$ 列表。最终输出必须是单个包含在方括号内、由逗号分隔的浮点数列表。\n\n测试套件：\n- 案例 1（理想路径，中等参数）：\n    - $R_0 = 3.0\\,\\text{m}$，$a = 1.0\\,\\text{m}$，$B_{\\phi} = 5.3\\,\\text{T}$，$V_{\\text{loop}} = 1.2\\,\\text{V}$，\n    - $q_0 = 1.0$，$\\alpha = 1.8$，$n = 2$，\n    - $\\kappa_{\\min} = 0.9$，$\\kappa_{\\text{nom}} = 1.1$，$\\kappa_{\\max} = 1.3$，\n    - 径向点 $r_i \\in \\{0.1 a, 0.3 a, 0.5 a, 0.7 a, 0.9 a\\}$。\n- 案例 2（边界情况：感应驱动消失）：\n    - $R_0 = 3.0\\,\\text{m}$，$a = 1.0\\,\\text{m}$，$B_{\\phi} = 5.3\\,\\text{T}$，$V_{\\text{loop}} = 0.0\\,\\text{V}$，\n    - $q_0 = 1.0$，$\\alpha = 1.8$，$n = 2$，\n    - $\\kappa_{\\min} = 0.8$，$\\kappa_{\\text{nom}} = 1.0$，$\\kappa_{\\max} = 1.2$，\n    - 径向点 $r_i \\in \\{0.1 a, 0.3 a, 0.5 a, 0.7 a, 0.9 a\\}$。\n- 案例 3（靠近磁轴的边界覆盖和更强的截面形状）：\n    - $R_0 = 6.0\\,\\text{m}$，$a = 2.0\\,\\text{m}$，$B_{\\phi} = 2.5\\,\\text{T}$，$V_{\\text{loop}} = 2.0\\,\\text{V}$，\n    - $q_0 = 0.9$，$\\alpha = 3.0$，$n = 2$，\n    - $\\kappa_{\\min} = 0.7$，$\\kappa_{\\text{nom}} = 1.0$，$\\kappa_{\\max} = 1.5$，\n    - 径向点 $r_i \\in \\{0.05 a, 0.2 a, 0.4 a, 0.6 a, 0.8 a, 0.95 a\\}$。\n- 案例 4（剖面敏感性：具有四次方变化的更平坦的 $q(r)$）：\n    - $R_0 = 3.5\\,\\text{m}$，$a = 0.8\\,\\text{m}$，$B_{\\phi} = 4.0\\,\\text{T}$，$V_{\\text{loop}} = 0.5\\,\\text{V}$，\n    - $q_0 = 1.2$，$\\alpha = 0.5$，$n = 4$，\n    - $\\kappa_{\\min} = 0.85$，$\\kappa_{\\text{nom}} = 1.0$，$\\kappa_{\\max} = 1.25$，\n    - 径向点 $r_i \\in \\{0.1 a, 0.3 a, 0.5 a, 0.7 a\\}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由逗号分隔、并用方括号括起来的列表。对于每个案例，列出 $N$ 个名义值 $[v_W^{\\text{nom}}(r_1), \\ldots, v_W^{\\text{nom}}(r_N)]$，然后是 $N$ 个下限值 $[v_W^{\\text{low}}(r_1), \\ldots, v_W^{\\text{low}}(r_N)]$，接着是 $N$ 个上限值 $[v_W^{\\text{high}}(r_1), \\ldots, v_W^{\\text{high}}(r_N)]$，并将所有案例的这些序列连接成一个单一的、用方括号括起来的列表。所有速度都必须以 $\\text{m/s}$ 为单位。",
            "solution": "该问题被认为是有效的，因为它的科学基础是托卡马克等离子体中的新经典输运原理，其提法是良定的，具有完整且一致的参数集，并以客观、正式的语言表述。所提供的模型虽然经过简化，但代表了对 Ware 箍缩效应的标准教科书级别的描述。所有参数在物理上都是合理的，不存在内部矛盾或歧义。\n\n目标是计算在一组指定的径向坐标 $r_i$ 上的 Ware 箍缩速度剖面 $v_W(r)$。推导从简化的、大环径比的圆形托卡马克模型中给出的 Ware 箍缩速度的定义开始：\n$$v_W(r) = - \\frac{E_{\\phi}(r)}{B_{\\theta}(r)} G(\\varepsilon)$$\n其中 $E_{\\phi}(r)$ 是环向电场，$B_{\\theta}(r)$ 是极向磁场，$G(\\varepsilon)$ 是一个与捕获粒子份额相关的几何因子。反环径比定义为 $\\varepsilon \\equiv r/R_0$。\n\n问题指定了该方程中每一项的形式。我们将系统地代入它们，以推导最终的计算公式。\n\n首先，几何因子 $G(\\varepsilon)$ 给出如下：\n$$G(\\varepsilon) = \\kappa \\sqrt{\\varepsilon} = \\kappa \\sqrt{\\frac{r}{R_0}}$$\n此处，$\\kappa$ 是一个不确定性系数。\n\n其次，由于大环径比近似，环向电场 $E_{\\phi}(r)$ 被假设为空间均匀的，并通过法拉第定律与环路电压 $V_{\\text{loop}}$ 相关：\n$$E_{\\phi}(r) = E_{\\phi} = \\frac{V_{\\text{loop}}}{2\\pi R_0}$$\n\n第三，极向磁场 $B_{\\theta}(r)$ 从安全因子 $q(r)$ 的定义中导出：\n$$q(r) = \\frac{r B_{\\phi}}{R_0 B_{\\theta}(r)} \\implies B_{\\theta}(r) = \\frac{r B_{\\phi}}{R_0 q(r)}$$\n\n将这三个表达式代入 $v_W(r)$ 的初始方程：\n$$v_W(r) = - \\frac{\\left( \\frac{V_{\\text{loop}}}{2\\pi R_0} \\right)}{\\left( \\frac{r B_{\\phi}}{R_0 q(r)} \\right)} \\left( \\kappa \\sqrt{\\frac{r}{R_0}} \\right)$$\n\n该表达式可以进行代数简化。主分数中的分子和分母中的大半径 $R_0$ 可以消去：\n$$v_W(r) = - \\left( \\frac{V_{\\text{loop}}}{2\\pi} \\right) \\left( \\frac{q(r)}{r B_{\\phi}} \\right) \\left( \\kappa \\sqrt{\\frac{r}{R_0}} \\right)$$\n\n合并各项并分离出径向依赖关系：\n$$v_W(r) = - \\frac{V_{\\text{loop}} \\kappa}{2\\pi B_{\\phi} \\sqrt{R_0}} \\frac{q(r)}{r} \\sqrt{r} = - \\frac{V_{\\text{loop}} \\kappa}{2\\pi B_{\\phi} \\sqrt{R_0}} \\frac{q(r)}{\\sqrt{r}}$$\n验证此表达式的物理单位至关重要。当 $V_{\\text{loop}}$ 的单位为伏特（$V$），$B_{\\phi}$ 的单位为特斯拉（$T = V \\cdot s \\cdot m^{-2}$），长度（$R_0, r$）的单位为米（$m$）时，最终得到的单位是 m/s，这对于速度是正确的。\n\n最后一部分是安全因子剖面 $q(r)$ 的函数形式：\n$$q(r) = q_0 + \\alpha \\left(\\frac{r}{a}\\right)^n$$\n将其代入我们简化的 $v_W(r)$ 表达式，得到完整的计算公式：\n$$v_W(r) = - \\frac{V_{\\text{loop}} \\kappa}{2\\pi B_{\\phi} \\sqrt{R_0}} \\frac{1}{\\sqrt{r}} \\left[ q_0 + \\alpha \\left(\\frac{r}{a}\\right)^n \\right]$$\n此公式在 $r > 0$ 时有效。问题陈述中提供的径向点 $r_i$ 均严格为正，因此避免了在 $r=0$ 处的奇点。\n\n为了进行不确定性量化，我们通过代入给定的三个 $\\kappa$ 值：$\\kappa_{\\min}$、$\\kappa_{\\text{nom}}$ 和 $\\kappa_{\\max}$，来计算三个速度剖面。这分别产生 $v_W^{\\text{low}}(r)$、$v_W^{\\text{nom}}(r)$ 和 $v_W^{\\text{high}}(r)$。\n\n算法实现如下：\n1.  定义一个函数来处理单个测试案例的计算。该函数将所有物理参数和剖面参数作为输入。\n2.  对于每个案例，首先根据小半径 $a$ 和提供的半径分数计算径向网格点 $r_i$。\n3.  为提高效率，对径向点 $r_i$ 数组的计算进行矢量化。对所有 $r_i$ 计算 $q(r_i)$ 项。\n4.  然后对三个 $\\kappa$ 值分别计算主公式，生成对应于名义、下限和上限速度剖面的三个数组。\n5.  一个主脚本将四个测试案例定义为一个结构化的参数集合。它遍历每个案例，调用计算函数，并汇总结果。\n6.  最终输出通过按指定顺序连接每个案例的结果来构建：名义速度列表，后跟下限速度列表，然后是上限速度列表。对所有测试案例重复此序列，并将合并后的列表格式化为单个包含在方括号内、由逗号分隔的字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Ware pinch velocity profile across multiple test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path, moderate parameters)\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_phi\": 5.3, \"V_loop\": 1.2,\n            \"q0\": 1.0, \"alpha\": 1.8, \"n\": 2,\n            \"k_min\": 0.9, \"k_nom\": 1.1, \"k_max\": 1.3,\n            \"r_fractions\": np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n        },\n        # Case 2 (edge case: vanishing inductive drive)\n        {\n            \"R0\": 3.0, \"a\": 1.0, \"B_phi\": 5.3, \"V_loop\": 0.0,\n            \"q0\": 1.0, \"alpha\": 1.8, \"n\": 2,\n            \"k_min\": 0.8, \"k_nom\": 1.0, \"k_max\": 1.2,\n            \"r_fractions\": np.array([0.1, 0.3, 0.5, 0.7, 0.9]),\n        },\n        # Case 3 (boundary coverage near magnetic axis and stronger shaping)\n        {\n            \"R0\": 6.0, \"a\": 2.0, \"B_phi\": 2.5, \"V_loop\": 2.0,\n            \"q0\": 0.9, \"alpha\": 3.0, \"n\": 2,\n            \"k_min\": 0.7, \"k_nom\": 1.0, \"k_max\": 1.5,\n            \"r_fractions\": np.array([0.05, 0.2, 0.4, 0.6, 0.8, 0.95]),\n        },\n        # Case 4 (profile sensitivity: flatter q(r) with quartic variation)\n        {\n            \"R0\": 3.5, \"a\": 0.8, \"B_phi\": 4.0, \"V_loop\": 0.5,\n            \"q0\": 1.2, \"alpha\": 0.5, \"n\": 4,\n            \"k_min\": 0.85, \"k_nom\": 1.0, \"k_max\": 1.25,\n            \"r_fractions\": np.array([0.1, 0.3, 0.5, 0.7]),\n        },\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Extract parameters for clarity\n        R0 = case[\"R0\"]\n        a = case[\"a\"]\n        B_phi = case[\"B_phi\"]\n        V_loop = case[\"V_loop\"]\n        q0 = case[\"q0\"]\n        alpha = case[\"alpha\"]\n        n = case[\"n\"]\n        k_values = {\"nom\": case[\"k_nom\"], \"low\": case[\"k_min\"], \"high\": case[\"k_max\"]}\n        r_fractions = case[\"r_fractions\"]\n\n        # Calculate radial grid in meters\n        r = r_fractions * a\n\n        # Handle the V_loop = 0 case to avoid unnecessary calculations and potential 0/0 issues if r=0 were allowed\n        if V_loop == 0.0:\n            num_points = len(r)\n            v_w_nom = np.zeros(num_points)\n            v_w_low = np.zeros(num_points)\n            v_w_high = np.zeros(num_points)\n        else:\n            # Calculate the safety factor profile q(r)\n            q_r = q0 + alpha * (r / a)**n\n\n            # Calculate the Ware pinch velocity v_W(r)\n            # v_W(r) = - (V_loop * k) / (2 * pi * B_phi * sqrt(R0)) * q(r) / sqrt(r)\n            constant_factor = -V_loop / (2.0 * np.pi * B_phi * np.sqrt(R0))\n            radial_dependent_factor = q_r / np.sqrt(r)\n            \n            # Note: np.sqrt(r) is safe as all r > 0 in test cases.\n            \n            v_w_nom = constant_factor * k_values[\"nom\"] * radial_dependent_factor\n            v_w_low = constant_factor * k_values[\"low\"] * radial_dependent_factor\n            v_w_high = constant_factor * k_values[\"high\"] * radial_dependent_factor\n\n        # Append results in the specified order: nom, low, high\n        all_results.extend(v_w_nom.tolist())\n        all_results.extend(v_w_low.tolist())\n        all_results.extend(v_w_high.tolist())\n\n    # Format output as a single comma-separated list of floats in brackets\n    print(f\"[{','.join(f'{val:.8f}' for val in all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后一个实践将您从理论计算带入计算建模的实际挑战中。您需要考虑如何在一个一维输运求解器中实现瓦尔内箍缩，这是任何计算聚变科学家的核心任务。这个问题要求您评估不同的数值策略，重点关注粒子数守恒、时间积分的稳定性以及物理上恰当的边界条件等关键方面，从而架起从物理方程到稳健模拟代码之间的桥梁。",
            "id": "4062556",
            "problem": "您正在一个一维（$1\\text{D}$）径向粒子输运求解器中实现与Ware pinch相关的感应输运，该求解器用于轴对称、大环径比、圆形托卡马克。该求解器在小半径坐标 $r \\in [0,a]$ 上推进粒子密度 $n(r,t)$，其中几何因子 $V'(r)$（等离子体体积对 $r$ 的导数）、已知的环向磁场 $B_{\\phi}$（在磁通面上近似恒定）和已知的安全因子剖面 $q(r)$ 均已给定。感应驱动由测量的环路电压 $V_{\\text{loop}}(t)$ 指定，在大环径比极限的主阶上，其在极向和环向上是空间均匀的。控制粒子连续性方程采用标准的守恒磁通面平均形式，包含扩散和任何其他模拟的通量，\n$$\n\\frac{\\partial}{\\partial t}\\big(V'(r)\\,n(r,t)\\big) + \\frac{\\partial}{\\partial r}\\big(V'(r)\\,\\Gamma(r,t)\\big) \\;=\\; V'(r)\\,S(r,t),\n$$\n其中 $S(r,t)$ 是已知的粒子源，$\\Gamma(r,t)$ 是径向粒子通量。感应Ware pinch应作为与电场叉乘磁场（$\\mathbf{E} \\times \\mathbf{B}$）漂移相关的平流贡献项，经过适当的磁通面平均后，进入通量 $\\Gamma$。环向电场 $E_{\\phi}(t)$ 通过法拉第定律与 $V_{\\text{loop}}(t)$ 相关联。极向磁场 $B_{\\theta}(r)$ 通过大环径比磁几何与 $q(r)$、$B_{\\phi}$ 和大半径 $R_{0}$ 相关联。\n\n您的任务是选择一个选项，该选项从第一性原理出发，并采用数值上稳健的选择，正确地概述了如何在通量 $\\Gamma$ 中实现具有时变感应驱动的感应Ware pinch，包括 $n(r,t)$ 在 $r=0$（磁轴）和 $r=a$（最外闭合磁通面）处的正确边界条件，以及对平流项的稳定时间离散化方法。假设扩散输运系数 $D(r,t)$ 和粒子源 $S(r,t)$ 已由其他模块提供。该实现必须是守恒的，与磁通面平均在物理上一致，并且对于时变感应驱动是稳定的。\n\n哪个选项是正确的？\n\nA. 使用所写的输运方程的守恒形式。将通量分解为 $\\Gamma(r,t)= -D(r,t)\\,\\partial n/\\partial r + n(r,t)\\,v_{\\text{pinch}}(r,t)$，其中Ware pinch速度 $v_{\\text{pinch}}(r,t)$ 通过以下方式获得：首先通过法拉第定律将磁通面平均的环向电场与环路电压关联起来，即 $\\langle E_{\\phi}\\rangle_{\\psi}(t)=V_{\\text{loop}}(t)/(2\\pi R_{0})$，然后使用大环径比磁几何来评估其与极向磁场 $B_{\\theta}(r)$ 的比值，其中 $B_{\\theta}(r)$ 与安全因子 $q(r)= r B_{\\phi}/(R_{0} B_{\\theta}(r))$ 一致地计算得出。在单元交界面处，使用基于 $v_{\\text{pinch}}$ 符号的迎风格式对平流项 $n\\,v_{\\text{pinch}}$ 进行离散化，并采用半隐式格式（例如，在时间中点 $t^{n+1/2}$ 处评估 $v_{\\text{pinch}}$）进行时间推进，以适应 $V_{\\text{loop}}(t)$ 的变化。通过施加零净通量 $V'(0)\\,\\Gamma(0,t)=0$ 来强制磁轴处的对称性，这转化为对最内层交界面处扩散项和平流项离散组合的约束。在边界 $r=a$ 处，根据 $v_{\\text{pinch}}$ 的符号应用迎风入流边界条件：对于向内pinch（负径向速度），规定边界密度（例如，将 $n(a,t)$ 设置为指定的最外闭合磁通面值）或等效的虚拟单元值；对于向外速度，使用零梯度（Neumann）条件，以免流出被非物理地反射。此实现可在源和边界通量的范围内保持全局粒子数守恒。\n\nB. 使用非守恒形式 $\\partial n/\\partial t + \\partial \\Gamma/\\partial r = S$，不带几何因子 $V'(r)$，因为Ware pinch主要是平流性质的。通过设置 $\\Gamma_{\\text{pinch}} = n\\,u$ 来计算pinch贡献，其中 $u$ 是一个用户指定的、与测量的环路电压成正比的常数，并使用中心差分来评估空间导数以获得二阶精度。在所有时间，对 $r=0$ 和 $r=a$ 均设置零通量边界条件，以避免边界层。使用在 $t^{n}$ 时刻计算的pinch速度进行显式时间积分推进。\n\nC. 保持守恒形式，但逐点计算环向电场 $E_{\\phi}(r,\\theta,t)=V_{\\text{loop}}(t)/(2\\pi R(r,\\theta))$，并将此逐点值直接代入pinch速度，不进行磁通面平均，以便 $1\\text{D}$ 代码使用单个选定的极向角 $\\theta=\\theta_{0}$ 来代表每个磁通面。对平流项使用一阶迎风格式，并采用带有Courant–Friedrichs–Lewy (CFL) 时间步长限制的显式时间步进。在 $r=0$ 处施加零通量，并在 $r=a$ 处对所有速度符号施加固定密度。\n\nD. 通过将扩散系数重新定义为 $D_{\\text{eff}}(r,t)=D(r,t)-\\ell\\,w(t)$ 来模拟Ware pinch，其中 $w(t)$ 与环路电压成正比，$\\ell$ 是用户选择的长度尺度，这样就不存在显式的平流项。对扩散通量保持中心差分，并在所有时间对 $r=0$ 和 $r=a$ 均使用齐次Neumann边界条件 $\\partial n/\\partial r=0$。时间积分器可以保持不变，因为其效应是扩散性的。\n\nE. 由于环路电压是时变的，通过在右侧源项 $S(r,t)$ 中增加一个与 $\\partial E_{\\phi}/\\partial t$ 成正比的项，将感应效应处理为极化电流。保持 $\\Gamma=-D\\,\\partial n/\\partial r$ 不变，因为平流pinches可以在连续性方程中表示为源项。为简单起见，在两个边界都使用零梯度密度，并采用显式时间步进。",
            "solution": "问题陈述描述了在一个用于托卡马克的一维（$1\\text{D}$）径向粒子输运代码中实现感应Ware pinch的方法。任务是从给定选项中确定正确的实现策略，涵盖物理模型、数值离散化和边界条件。\n\n### **问题验证**\n\n**步骤1：提取已知条件**\n-   **控制方程：** 粒子连续性方程以守恒形式给出：\n    $$\n    \\frac{\\partial}{\\partial t}\\big(V'(r)\\,n(r,t)\\big) + \\frac{\\partial}{\\partial r}\\big(V'(r)\\,\\Gamma(r,t)\\big) \\;=\\; V'(r)\\,S(r,t)\n    $$\n-   **变量与区域：** 求解器在小半径坐标 $r \\in [0,a]$ 上推进粒子密度 $n(r,t)$。\n-   **已知量：**\n    -   几何因子：$V'(r)$。\n    -   环向磁场：$B_{\\phi}$。\n    -   安全因子剖面：$q(r)$。\n    -   感应驱动：空间均匀的环路电压 $V_{\\text{loop}}(t)$。\n    -   粒子源：$S(r,t)$。\n    -   扩散系数：$D(r,t)$。\n-   **物理关系：**\n    -   Ware pinch源于电场叉乘磁场（E cross B）漂移。\n    -   环向电场 $E_{\\phi}(t)$ 通过法拉第定律与 $V_{\\text{loop}}(t)$ 相关联。\n    -   极向磁场 $B_{\\theta}(r)$ 通过大环径比几何与 $q(r)$、$B_{\\phi}$ 和大半径 $R_{0}$ 相关联。\n-   **实现要求：**\n    -   实现必须是守恒的。\n    -   必须与磁通面平均在物理上一致。\n    -   对于时变感应驱动必须是稳定的。\n    -   必须包含在 $r=0$ 和 $r=a$ 处的正确边界条件。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学基础扎实：** 该问题牢固地建立在托卡马克等离子体中新经典输运理论（Ware pinch）的既定原理以及计算物理学中求解偏微分方程（PDE）的标准数值方法之上。所有概念——磁通面平均、安全因子、环路电压、守恒输运方程——在聚变科学中都是标准的。\n-   **适定的：** 该问题提供了一个完整且自洽的物理和计算背景。它要求找到实现特定物理效应的正确方法，这是计算科学中一个明确定义的任务。\n-   **客观的：** 语言是技术性的、精确的，并且没有主观或模糊的术语。\n\n**步骤3：结论与行动**\n问题陈述是有效的。它在科学上是合理的、适定的和客观的。我现在将从第一性原理出发推导正确的实现方法，然后评估每个选项。\n\n### **从第一性原理推导**\n\n1.  **粒子数守恒：** 所提供的控制方程是守恒形式，其中 $V'(r)$ 是等离子体微元体积（$V'(r) = dV/dr$）。对于大环径比的圆形托卡马克，$V(r) = (2\\pi R_{0})(\\pi r^2)$，因此 $V'(r) = 2\\pi R_{0} \\cdot 2\\pi r = 4\\pi^2 R_0 r$。使用守恒形式 $\\frac{\\partial}{\\partial t}(V'n) + \\frac{\\partial}{\\partial r}(V'\\Gamma) = V'S$ 至关重要，以确保模拟体积中的总粒子数 $N = \\int_0^a V'(r) n(r,t) dr$ 仅因源 $S$ 和跨越边界 $r=a$ 的通量而改变。任何有效的数值格式都必须正确地离散化这种守恒形式。\n\n2.  **Ware Pinch通量：** 径向粒子通量 $\\Gamma$ 由扩散部分和平流部分组成：\n    $$\n    \\Gamma(r,t) = -D(r,t)\\,\\frac{\\partial n}{\\partial r} + \\Gamma_{\\text{pinch}}(r,t)\n    $$\n    Ware pinch源于导心 $\\vec{E} \\times \\vec{B}$ 漂移的径向分量在磁通面上的平均。漂移速度为 $\\vec{v}_E = (\\vec{E} \\times \\vec{B})/B^2$。对于环向电场 $\\vec{E} = E_{\\phi}\\hat{\\phi}$ 和磁场 $\\vec{B} = B_{\\theta}\\hat{\\theta} + B_{\\phi}\\hat{\\phi}$，漂移的径向分量为 $v_{E,r} = -E_{\\phi} B_{\\theta} / B^2$。对于大环径比托卡马克，$B \\approx B_{\\phi}$。磁通面平均的pinch速度近似为：\n    $$\n    v_{\\text{pinch}}(r,t) = -\\frac{E_{\\phi}(t)}{B_{\\theta}(r)}\n    $$\n    这是一个平流贡献项的有效速度，该贡献项写作 $\\Gamma_{\\text{pinch}}(r,t) = n(r,t) \\, v_{\\text{pinch}}(r,t)$。正的 $E_{\\phi}$（标准欧姆运行）和正的 $B_{\\theta}$ 会导致 $v_{\\text{pinch}}  0$，即一个向内的pinch，正如预期的那样。\n\n3.  **辅助关系：**\n    -   **环向电场：** 根据法拉第定律，环路电压是电场沿环向路径的线积分。对于磁轴处的环路，$V_{\\text{loop}}(t) = \\oint \\vec{E} \\cdot d\\vec{l}$。在轴对称托卡马克中，$E_\\phi$ 在磁通面上近似恒定，并且在主阶上空间均匀。因此，$V_{\\text{loop}}(t) \\approx E_{\\phi}(t) (2\\pi R_0)$，这给出：\n        $$\n        E_{\\phi}(t) = \\frac{V_{\\text{loop}}(t)}{2\\pi R_{0}}\n        $$\n    -   **极向磁场：** 在大环径比、圆形磁通面极限下，安全因子 $q(r)$ 定义为 $q(r) \\approx \\frac{r B_{\\phi}}{R_{0} B_{\\theta}(r)}$。这可以重排以求得 $B_{\\theta}(r)$：\n        $$\n        B_{\\theta}(r) = \\frac{r B_{\\phi}}{R_{0} q(r)}\n        $$\n\n4.  **数值格式：**\n    -   **空间离散化：** 守恒方程中的平流项 $\\frac{\\partial}{\\partial r}(V' n v_{\\text{pinch}})$，如果用中心差分格式离散化，容易产生数值不稳定性。**迎风格式**是标准的、稳健的选择。单元交界面 $r_{i+1/2}$ 处的通量由上游单元中的 $n$ 值确定：\n        $$\n        (V' n v_{\\text{pinch}})_{i+1/2} = \\begin{cases} (V' v_{\\text{pinch}})_{i+1/2} \\, n_i   \\text{若 } v_{\\text{pinch}, i+1/2} > 0 \\\\ (V' v_{\\text{pinch}})_{i+1/2} \\, n_{i+1}  \\text{若 } v_{\\text{pinch}, i+1/2}  0 \\end{cases}\n        $$\n        这能确保稳定性并保持密度剖面的正性。\n    -   **时间离散化：** 对平流项使用显式时间步进格式会受到Courant–Friedrichs–Lewy (CFL) 条件的限制，即 $\\Delta t \\le \\min(\\Delta r / |v_{\\text{pinch}}|)$，这可能限制性过强。鉴于 $V_{\\text{loop}}(t)$ 从而 $v_{\\text{pinch}}(t)$ 可能随时间变化，**半隐式或隐式格式**更优。例如，对平流项和扩散项使用Crank-Nicolson或后向欧拉格式可提供无条件线性稳定性。在新的时间步 $t^{n+1}$ 或中点 $t^{n+1/2}$ 处评估时变速度 $v_{\\text{pinch}}(t)$ 可以提高准确性和稳定性。\n\n5.  **边界条件：**\n    -   **磁轴（$r=0$）：** 物理对称性要求穿过磁轴的净粒子通量必须为零。通过半径为 $r$ 的表面的总通量与 $V'(r)\\Gamma(r)$ 成正比。当 $r \\to 0$ 时，$V'(r) \\propto r \\to 0$。我们必须有 $\\lim_{r\\to 0} V'(r)\\Gamma(r) = 0$。这通常通过将第一个单元交界面处的通量设置为零来实现，这通常对应于在 $r=0$ 处的零梯度条件 $\\partial n/\\partial r = 0$。\n    -   **最外闭合磁通面（$r=a$）：** 此处的边界条件模拟与刮削层的相互作用。对于一个平流-扩散方程，正确的边界条件取决于信息流动的方向，即速度的符号。\n        -   **入流（$v_{\\text{pinch}}(a,t)  0$）：** 信息流入区域。必须规定一个边界条件。Dirichlet条件，$n(a,t) = n_{\\text{edge}}(t)$，是一个物理上合适的选择，代表由边界物理过程维持的密度。\n        -   **出流（$v_{\\text{pinch}}(a,t) > 0$）：** 信息流出区域。边界处的解应由内部决定。强加一个值会导致非物理反射。零梯度（Neumann）条件，$\\partial n/\\partial r=0$（或更一般地，一个出流/外推条件），是合适的，因为它允许粒子自由离开区域。\n        因此，一个根据速度符号切换的**基于迎风或基于特征线的边界条件**是最稳健和物理上最正确的方法。\n\n### **逐项分析选项**\n\n**A. 使用守恒形式...**\n此选项正确地规定了：\n1.  输运方程的守恒形式。\n2.  通量 $\\Gamma = -D \\, \\partial n/\\partial r + n v_{\\text{pinch}}$ 的正确分解。\n3.  基于物理的、使用大环径比公式从 $V_{\\text{loop}}(t)$ 和 $q(r)$ 计算 $v_{\\text{pinch}}(r,t)$ 的正确方法。\n4.  用于平流通量的数值稳健的迎风格式。\n5.  适用于时变系数的稳定的半隐式时间积分格式。\n6.  磁轴（$r=0$）处正确的零净通量边界条件。\n7.  边界（$r=a$）处正确的、基于物理动机的、依赖于符号的“迎风”边界条件。\n此选项是对最先进实现方法的完整和正确的描述。\n**结论：正确**\n\n**B. 使用非守恒形式...**\n此选项因多个原因存在缺陷：\n1.  使用非守恒形式 $\\frac{\\partial n}{\\partial t} + \\frac{\\partial \\Gamma}{\\partial r} = S$，在体积元 $V'(r)$ 不恒定的曲线坐标系中违反了粒子数守恒。\n2.  将pinch速度建模为用户指定的空间常数在物理上是不正确的；$v_{\\text{pinch}}$ 从根本上通过 $B_{\\theta}(r)$ 依赖于半径。\n3.  对平流使用中心差分在数值上是不稳定的。\n4.  在 $r=a$ 处使用零通量边界条件在物理上是不正确的（会反射）。\n5.  仅依赖显式时间积分器是不稳健的。\n**结论：不正确**\n\n**C. 保持守恒形式但逐点计算环向电场...**\n此选项存在缺陷，因为：\n1.  它提议在单个任意的极向角 $\\theta_0$ 处计算 $E_{\\phi}$ 来代表一个磁通面。这违反了磁通面平均的原则，而该原则是 $1\\text{D}$ 输运建模的基础。物理量必须被正确平均，而不是在任意点采样。\n2.  它建议在 $r=a$ 处施加一个固定的密度，而不考虑速度的符号。这对于出流条件是不正确的，会导致非物理结果。\n3.  它建议使用显式时间步进，这不是一个稳健的选择。\n**结论：不正确**\n\n**D. 通过将扩散系数重新定义为 $D_{\\text{eff}}(r,t)=D(r,t)-\\ell\\,w(t)$ 来模拟Ware pinch...**\n此选项从根本上存在缺陷，因为：\n1.  它错误地表述了平流的数学结构。平流通量与密度 $n$ 成正比，而扩散通量与密度梯度 $\\partial n/\\partial r$ 成正比。将两者合并为一个有效扩散系数在物理上是不正确的。\n2.  这种“负扩散”模型可能使有效扩散系数为负，导致一个不适定的、指数级不稳定的反扩散问题。\n3.  它提议在两端都使用零梯度边界条件，这对于边界 $r=a$ 在物理上是错误的。\n**结论：不正确**\n\n**E. 将感应效应处理为极化电流...**\n此选项存在缺陷，因为：\n1.  它从根本上错误地识别了物理过程。Ware pinch是一个与 $E_{\\phi}$ 成正比的新经典漂移效应，而不是与 $\\partial E_{\\phi}/\\partial t$ 成正比的极化电流效应。这是两个截然不同的现象。\n2.  如果不加小心地将平流项移至源项 $S$，可能会破坏数值格式的守恒性质。虽然在数学上可以写成 $\\partial_r(nv) = v\\partial_r n + n\\partial_r v$，但在通量散度和源项之间移动项需要非常小心，并且不是实现平流通量的标准或最透明的方式。所提议的源项在物理上也是不正确的。\n3.  所提议的边界条件（两端均为零梯度）是不正确的。\n**结论：不正确**\n\n基于这一详细分析，选项A是唯一描述了物理上一致、数值上稳健且完整的实现策略的选项。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}