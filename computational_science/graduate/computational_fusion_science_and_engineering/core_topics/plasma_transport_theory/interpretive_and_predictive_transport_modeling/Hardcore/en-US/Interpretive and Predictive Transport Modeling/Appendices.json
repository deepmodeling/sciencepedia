{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of modern transport modeling is the concept that turbulent transport does not vary smoothly with plasma gradients, but instead exhibits a threshold behavior. This exercise delves into this critical gradient phenomenon by introducing a surrogate model for turbulent heat flux . By calculating the 'transport stiffness,' you will develop a quantitative understanding of how abruptly transport turns on once this critical gradient is surpassed, a key feature that governs plasma profile self-regulation.",
            "id": "3997874",
            "problem": "In interpretive and predictive transport modeling for magnetically confined fusion plasmas, the radial heat transport is modeled via an energy balance and flux-gradient relation. Let the ion temperature gradient drive be represented by the dimensionless parameter $x \\equiv R/L_T$, where $R$ is the major radius and $L_T \\equiv -\\left(\\mathrm{d}\\ln T/\\mathrm{d}r\\right)^{-1}$ is the ion temperature gradient scale length. Define the normalized turbulent heat flux $\\hat{Q}$ by dividing the physical heat flux $Q$ by a chosen gyro-Bohm reference $Q_{\\mathrm{gB}}$, so that $\\hat{Q} \\equiv Q/Q_{\\mathrm{gB}}$ is dimensionless. The transport stiffness is the sensitivity of the normalized turbulent heat flux to the drive near the critical gradient $x_c$, namely the right-hand derivative $\\left.\\partial \\hat{Q}/\\partial x\\right|_{x_c^{+}}$.\n\nConsider a surrogate closure for the onset and saturation of ion temperature gradient driven turbulence capturing threshold and stiffness effects:\n$$\n\\hat{Q}(x) \\;=\\; \\alpha \\,\\frac{\\left(x - x_c\\right)^{p}}{1 + \\beta \\left(x - x_c\\right)}\\,H\\!\\left(x - x_c\\right),\n$$\nwhere $H$ is the Heaviside function, $\\alpha0$ and $\\beta \\ge 0$ are dimensionless coefficients, $x_c0$ is the critical gradient, and $p0$ controls the onset sharpness. This form is intended to be used as a local closure in a flux-gradient relation within a transport solver.\n\nStarting from the conservation of energy and the definition of the gradient scale length, justify how the transport stiffness reduces to the right-hand derivative of $\\hat{Q}(x)$ at $x=x_c$, and then analytically compute $\\left.\\partial \\hat{Q}/\\partial x\\right|_{x_c^{+}}$ for the case $p=1$. Discuss, based on the exponent $p$, whether the model predicts an abrupt finite-slope onset, a supercritical ramp with vanishing initial slope, or a singular onset at threshold.\n\nEvaluate the final expression for the specific parameter values $\\alpha = 9.80665$, $\\beta = 0.60$, $x_c = 4.50$, and $p=1$. Express your final numerical result for the transport stiffness as a dimensionless number and round your answer to four significant figures.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of transport modeling in fusion plasma physics, is mathematically well-posed, objective, and self-contained. We may proceed with the solution.\n\nThe problem asks for three main tasks: first, to justify the definition of transport stiffness as the right-hand derivative of the normalized heat flux $\\hat{Q}$ with respect to the temperature gradient drive $x$; second, to compute this stiffness for a specific case and discuss the model's behavior; and third, to evaluate the stiffness for a given set of parameters.\n\nFirst, we justify the definition of transport stiffness. The problem statement qualitatively defines transport stiffness as \"the sensitivity of the normalized turbulent heat flux to the drive near the critical gradient $x_c$\". In mathematical terms, the sensitivity of a function $f(y)$ to changes in its independent variable $y$ is quantified by its derivative, $\\mathrm{d}f/\\mathrm{d}y$. In our context, the function is the normalized turbulent heat flux, $\\hat{Q}$, and the independent variable, or \"drive\", is the dimensionless temperature gradient, $x$. Thus, the sensitivity is given by the derivative $\\partial \\hat{Q}/\\partial x$.\n\nThe model for $\\hat{Q}(x)$ is given as\n$$\n\\hat{Q}(x) \\;=\\; \\alpha \\,\\frac{\\left(x - x_c\\right)^{p}}{1 + \\beta \\left(x - x_c\\right)}\\,H\\!\\left(x - x_c\\right)\n$$\nwhere $H(z)$ is the Heaviside step function, defined as $H(z)=0$ for $z0$ and $H(z)=1$ for $z \\ge 0$. This model embodies the critical gradient concept: for $x \\le x_c$, the term $x - x_c \\le 0$, so $H(x-x_c)=0$ and consequently $\\hat{Q}(x)=0$. This means turbulent transport is not \"turned on\" until the gradient drive $x$ exceeds the critical threshold $x_c$. The phrase \"near the critical gradient\" directs us to examine the behavior of $\\hat{Q}(x)$ in the immediate vicinity of $x=x_c$. Since we are interested in the onset of transport as the drive increases past the threshold, the relevant behavior is captured by the limit as $x$ approaches $x_c$ from above ($x \\to x_c^{+}$). This naturally leads to the definition of the right-hand derivative at $x_c$:\n$$\n\\text{Stiffness} \\equiv \\lim_{h \\to 0^{+}} \\frac{\\hat{Q}(x_c+h) - \\hat{Q}(x_c)}{h} = \\left.\\frac{\\partial \\hat{Q}}{\\partial x}\\right|_{x=x_c^{+}}\n$$\nThis formalizes the physical notion of how strongly the heat flux responds to a small increase in the drive just above the critical point, which is the essence of stiffness.\n\nSecond, we compute this stiffness for the specific case where the exponent $p=1$. For $x  x_c$, the Heaviside function is $H(x-x_c)=1$, and the model simplifies to:\n$$\n\\hat{Q}(x) = \\alpha \\frac{x - x_c}{1 + \\beta(x - x_c)}, \\quad \\text{for } x  x_c\n$$\nTo find the stiffness, we must compute the derivative $\\partial \\hat{Q}/\\partial x$. We use the quotient rule for differentiation, $\\frac{\\mathrm{d}}{\\mathrm{d}z}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^2}$, with $u(x) = \\alpha(x-x_c)$ and $v(x) = 1 + \\beta(x-x_c)$. The derivatives are $u'(x) = \\alpha$ and $v'(x) = \\beta$.\nApplying the rule, we get:\n$$\n\\frac{\\partial \\hat{Q}}{\\partial x} = \\frac{(\\alpha)\\left(1 + \\beta(x - x_c)\\right) - \\left(\\alpha(x - x_c)\\right)(\\beta)}{\\left(1 + \\beta(x - x_c)\\right)^2}\n$$\nSimplifying the numerator:\n$$\n\\alpha + \\alpha\\beta(x - x_c) - \\alpha\\beta(x - x_c) = \\alpha\n$$\nThus, the derivative for $x  x_c$ is:\n$$\n\\frac{\\partial \\hat{Q}}{\\partial x} = \\frac{\\alpha}{\\left(1 + \\beta(x - x_c)\\right)^2}\n$$\nTo find the stiffness, we evaluate this expression in the limit $x \\to x_c^{+}$:\n$$\n\\left.\\frac{\\partial \\hat{Q}}{\\partial x}\\right|_{x_c^{+}} = \\lim_{x \\to x_c^{+}} \\frac{\\alpha}{\\left(1 + \\beta(x - x_c)\\right)^2} = \\frac{\\alpha}{\\left(1 + \\beta(x_c - x_c)\\right)^2} = \\frac{\\alpha}{(1 + 0)^2} = \\alpha\n$$\nSo, for the case $p=1$, the transport stiffness is simply the parameter $\\alpha$.\n\nNext, we discuss the onset behavior based on the exponent $p0$. The stiffness, or the initial slope of $\\hat{Q}(x)$ at $x_c^{+}$, determines the nature of the transition. We analyze the derivative of the general form as $x \\to x_c^{+}$. Let $y = x-x_c$. For $y0$, $\\hat{Q}(y) = \\alpha y^p / (1+\\beta y)$. The derivative is:\n$$\n\\frac{\\partial \\hat{Q}}{\\partial y} = \\alpha \\frac{p y^{p-1}(1+\\beta y) - y^p(\\beta)}{(1+\\beta y)^2} = \\alpha \\frac{p y^{p-1} + (p-1)\\beta y^p}{(1+\\beta y)^2}\n$$\nWe examine the limit as $y \\to 0^{+}$:\n1.  If $p=1$: $\\lim_{y \\to 0^{+}} \\frac{\\partial \\hat{Q}}{\\partial y} = \\alpha \\frac{1\\cdot y^0 + 0}{(1+\\beta y)^2} = \\alpha$. Since $\\alpha0$, the stiffness is a finite, positive constant. This describes an **abrupt finite-slope onset**, where the flux begins to rise linearly with the excess gradient drive.\n2.  If $p1$: The exponent $p-1$ is positive. As $y \\to 0^{+}$, both $y^{p-1} \\to 0$ and $y^p \\to 0$. The numerator approaches $0$ while the denominator approaches $1$, so $\\lim_{y \\to 0^{+}} \\frac{\\partial \\hat{Q}}{\\partial y} = 0$. This describes a **supercritical ramp with vanishing initial slope**. The flux smoothly and gradually turns on, with an initial slope of zero.\n3.  If $0p1$: The exponent $p-1$ is negative. As $y \\to 0^{+}$, the term $y^{p-1} \\to \\infty$. The numerator becomes infinite, so $\\lim_{y \\to 0^{+}} \\frac{\\partial \\hatQ}{\\partial y} = \\infty$. This describes a **singular onset at threshold**, where the slope of the flux is infinite at the threshold, implying an extremely sensitive and rapid increase in transport for any infinitesimal drive above $x_c$.\n\nFinally, we evaluate the transport stiffness for the given parameter values: $\\alpha = 9.80665$, $\\beta = 0.60$, $x_c = 4.50$, and $p=1$.\nAs derived above, for the case $p=1$, the transport stiffness is equal to $\\alpha$.\n$$\n\\text{Stiffness} = \\alpha = 9.80665\n$$\nThe problem requires this result to be rounded to four significant figures.\n$$\n\\text{Stiffness} \\approx 9.807\n$$\nThis value is dimensionless, consistent with the definition $\\left.\\partial \\hat{Q}/\\partial x\\right|_{x_c^{+}}$ where both $\\hat{Q}$ and $x$ are dimensionless.",
            "answer": "$$\\boxed{9.807}$$"
        },
        {
            "introduction": "Once a physical model for transport fluxes is established, the next practical step is to formulate a well-posed mathematical problem that a computational solver can tackle. This requires specifying appropriate boundary conditions that reflect the physics at the edges of the simulation domain . This exercise challenges you to justify the standard boundary conditions at the magnetic axis and the plasma edge, grounding your reasoning in fundamental principles of symmetry and energy conservation.",
            "id": "3997906",
            "problem": "Consider an axisymmetric, low-collisionality tokamak plasma with minor radius $a$ and major radius $R_0$, and let $r$ be the flux-surface label proportional to the minor radius. The flux-surface averaged, one-dimensional, radial energy transport equation for the ion temperature $T(r,t)$ in the closed-field-line region ($0 \\le r \\le a$) is modeled as \n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{3}{2} n T\\right) + \\frac{1}{V'(r)}\\frac{\\partial}{\\partial r}\\left[V'(r)\\, q_r(r)\\right] = S_E(r),\n$$\nwhere $n(r)$ is the density, $V'(r) = \\frac{dV}{dr}$ is the derivative of the enclosed flux-surface volume $V(r)$, $q_r(r) = - n \\chi \\frac{\\partial T}{\\partial r} + n v_r T$ is the radial heat flux composed of diffusive ($\\chi$) and convective ($v_r$) parts, and $S_E(r)$ is the volumetric heating. Assume $n(r)$, $\\chi(r)$, $v_r(r)$ and $S_E(r)$ are smooth on $[0,a]$, $V'(r)$ behaves as $V'(r) \\sim C r$ as $r \\to 0^+$ for some constant $C  0$, and that there are no singular or point sources at $r=0$. The separatrix at $r=a$ connects to the Scrape-Off Layer (SOL), where open field lines carry heat to the divertor; the pedestal top is located just inside the separatrix on closed field lines.\n\nIn interpretive modeling, closed-field-line profiles are constrained by measured pedestal-top values; in predictive modeling, pedestal-top values are provided by an edge pedestal model or extrapolated from SOL physics. You are tasked with justifying boundary conditions at the magnetic axis ($r=0$) and at the separatrix ($r=a$) that ensure a mathematically well-posed and physically consistent solution of the above radial transport equation.\n\nWhich of the following statements correctly justify appropriate boundary conditions for $T(r)$ at $r=0$ and $r=a$?\n\nA. At the magnetic axis, impose $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = 0$ because rotational symmetry and regularity of the scalar field $T(\\mathbf{x})$ imply a vanishing gradient at the axis; any nonzero $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0}$ would select a preferred direction and, when combined with $V'(r)\\sim C r$, can lead to an unphysical $\\frac{1}{V'}\\frac{\\partial}{\\partial r}\\left[V' q_r\\right]$ behavior unless compensated by a singular source.\n\nB. At the separatrix ($r=a$), impose a Dirichlet condition $T(a) = T_{\\mathrm{ped,top}}$ where $T_{\\mathrm{ped,top}}$ is either experimentally measured (interpretive) or provided by an edge pedestal/Scrape-Off Layer model (predictive); this pins the closed-field-line boundary to a physically consistent pedestal-top state that matches parallel heat removal in the SOL.\n\nC. At the magnetic axis, impose $T(0)=0$ to eliminate unknown core heat flux; this guarantees uniqueness even with finite central heating.\n\nD. At the separatrix, impose $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=a} = 0$ because field lines inside the separatrix are closed, so there is no net heat loss across $r=a$ and the gradient should vanish there.\n\nSelect all that apply. Provide reasoning from first principles, grounded in symmetry, regularity, and energy conservation, not heuristic rules of thumb.",
            "solution": "The user has requested a critical validation of the problem statement, followed by a detailed solution and evaluation of the provided options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem provides the following information:\n-   **Governing Equation**: The one-dimensional, radial energy transport equation for ion temperature $T(r,t)$ in an axisymmetric tokamak:\n    $$\n    \\frac{\\partial}{\\partial t}\\left(\\frac{3}{2} n T\\right) + \\frac{1}{V'(r)}\\frac{\\partial}{\\partial r}\\left[V'(r)\\, q_r(r)\\right] = S_E(r)\n    $$\n-   **Domain**: The closed-field-line region, $0 \\le r \\le a$.\n-   **Definitions**:\n    -   $r$: flux-surface label proportional to the minor radius.\n    -   $a$: minor radius (location of the separatrix).\n    -   $n(r)$: particle density.\n    -   $T(r,t)$: ion temperature.\n    -   $V'(r) = \\frac{dV}{dr}$: derivative of the enclosed flux-surface volume $V(r)$.\n    -   $q_r(r)$: radial heat flux, given by $q_r(r) = - n \\chi \\frac{\\partial T}{\\partial r} + n v_r T$.\n    -   $\\chi(r)$: thermal diffusivity.\n    -   $v_r(r)$: radial convective velocity.\n    -   $S_E(r)$: volumetric heating source.\n-   **Assumptions and Conditions**:\n    -   The plasma is in a low-collisionality tokamak, is axisymmetric.\n    -   $n(r)$, $\\chi(r)$, $v_r(r)$, and $S_E(r)$ are smooth functions on the interval $[0,a]$.\n    -   The geometric factor $V'(r)$ behaves as $V'(r) \\sim C r$ as $r \\to 0^+$ for some constant $C  0$.\n    -   There are no singular or point sources at the magnetic axis, $r=0$.\n-   **Context**: The problem distinguishes between interpretive modeling (using measured data) and predictive modeling (using physics-based models) for the boundary condition at $r=a$.\n-   **Objective**: Justify the boundary conditions for $T(r)$ at $r=0$ and $r=a$ that ensure a mathematically well-posed and physically consistent solution.\n\n**Step 2: Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The problem is based on the standard, widely used formulation of neoclassical and turbulent transport in the core of a tokamak plasma. The transport equation is a direct consequence of taking moments of the kinetic equation and averaging over magnetic flux surfaces. The definitions of diffusive and convective fluxes are standard. The geometric assumption $V'(r) \\sim C r$ for small $r$ is correct for a toroidal plasma with a circular cross-section near the axis (where $V(r) \\approx (2\\pi R_0)(\\pi r^2)$, so $V'(r) \\approx 4\\pi^2 R_0 r$). The description of the separatrix, Scrape-Off Layer (SOL), and pedestal physics is accurate. The problem is scientifically sound.\n-   **Well-Posed**: The task is to establish the conditions under which the given partial differential equation is well-posed. The equation is a second-order (in space) parabolic PDE, which requires two spatial boundary conditions for a unique solution. The problem of identifying these conditions is a standard and crucial step in solving such equations. The problem is structured to address this directly.\n-   **Objective**: The terminology is precise and standard within computational fusion science. The problem statement is free of subjective or ambiguous language.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is scientifically sound, well-posed, objective, and complete. It accurately represents a fundamental challenge in transport modeling. Therefore, the problem is **valid**. We may proceed with the solution.\n\n### Solution Derivation and Option Analysis\n\nThe governing equation is a conservation law for energy. Let us analyze the requirements for a physically and mathematically consistent solution at the two boundaries of the domain: the magnetic axis ($r=0$) and the separatrix ($r=a$).\n\n**Analysis of the Boundary Condition at the Magnetic Axis ($r=0$)**\n\nThe spatial operator in the transport equation is the divergence of the heat flux, $\\nabla \\cdot \\mathbf{q}$, which in this flux-surface-averaged, one-dimensional form is $\\frac{1}{V'(r)}\\frac{\\partial}{\\partial r}\\left[V'(r)\\, q_r(r)\\right]$.\nThe problem states there are no singular sources at $r=0$. This implies that all terms in the equation must be finite at $r=0$.\n\nLet us analyze the divergence term. We can rewrite it as:\n$$\n\\frac{1}{V'(r)}\\frac{\\partial}{\\partial r}\\left[V'(r)\\, q_r(r)\\right] = \\frac{\\partial q_r}{\\partial r} + \\frac{V''(r)}{V'(r)} q_r(r)\n$$\nGiven $V'(r) \\sim Cr$ for $r \\to 0^+$, it follows that $V''(r) \\sim C$. Thus, the ratio $\\frac{V''(r)}{V'(r)} \\sim \\frac{C}{Cr} = \\frac{1}{r}$ for small $r$. The divergence term becomes:\n$$\n\\frac{\\partial q_r}{\\partial r} + \\frac{1}{r}q_r(r)\n$$\nThis is the standard form for the radial part of the divergence in cylindrical coordinates.\nFor this entire expression to be finite at $r=0$, we must not have a term that behaves as $1/r$. Let's examine the behavior of $q_r(r)$ as $r \\to 0$. We assume that $T(r)$ has a Taylor series expansion around $r=0$. Due to the axisymmetry of the physical system, the temperature $T$, as a scalar field in 2D space $(x,y)$ corresponding to the poloidal cross-section, must be a smooth function. A function $f(x,y)$ that is symmetric with respect to the origin (i.e., depends only on $r = \\sqrt{x^2+y^2}$) is smooth at the origin only if its Taylor expansion contains only even powers of $r$.\nThat is, $T(r) = T_0 + T_2 r^2 + T_4 r^4 + ...$, where $T_n$ are constants. Any term with an odd power of $r$, such as $T_1 r$, would correspond to a function like $T_1\\sqrt{x^2+y^2}$, which has a conical point (a cusp) at the origin and is not differentiable there.\nFrom this regularity requirement, the first derivative of temperature with respect to $r$ is:\n$$\n\\frac{\\partial T}{\\partial r} = 2 T_2 r + 4 T_4 r^3 + ...\n$$\nThis immediately implies that $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = 0$.\n\nLet's verify this from the equation itself. If we were to assume a non-zero gradient, $T(r) \\approx T_0 + T_1 r$, then $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = T_1 \\ne 0$. The heat flux near $r=0$ would be approximately $q_r(r) \\approx -n(0)\\chi(0)T_1 + n(0)v_r(0)T_0$. By symmetry, the radial velocity $v_r$ must be zero at the axis ($v_r(0)=0$), otherwise there would be a net source or sink of particles at a single point. So, $q_r(0) \\approx -n(0)\\chi(0)T_1$. This is a finite, non-zero constant.\nThe divergence term $\\frac{1}{r}q_r(r) + \\frac{\\partial q_r}{\\partial r}$ would then have a term $\\frac{-n(0)\\chi(0)T_1}{r}$, which diverges as $r \\to 0$. This would require a singular source term (a delta function, $\\delta(r)$) in $S_E(r)$ to balance it, which is explicitly ruled out by the problem statement.\nTherefore, to ensure the solution is regular and the equation is well-behaved at the axis, we must impose the condition $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = 0$. This is a natural (Neumann) boundary condition.\n\n**Analysis of the Boundary Condition at the Separatrix ($r=a$)**\n\nThe separatrix at $r=a$ is the boundary between the \"core\" plasma with closed magnetic field lines and the \"Scrape-Off Layer\" (SOL) with open field lines that terminate on material surfaces (divertor plates).\n1.  **Transport Mechanisms**: Inside the separatrix ($ra$), heat transport is slow and occurs primarily *across* magnetic field lines (via diffusion and convection). In the SOL ($ra$), heat transport is dominated by extremely fast flow *along* the open magnetic field lines to the divertor.\n2.  **Energy Balance**: In a steady state with core heating ($S_E(r) \\ge 0$), there must be a net outward flow of energy at all radii to transport the heat from where it is generated to where it is exhausted. The total power crossing the separatrix, $P_{sep} = V'(a) q_r(a)$, must balance the total heating power within the volume, $\\int_0^a S_E(r)V'(r)dr$. This means $q_r(a)$ must be non-zero (and positive, for outward flux).\n3.  **Boundary Condition Type**: A non-zero heat flux $q_r(a)$ implies that a zero-gradient condition, $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=a} = 0$, is incorrect, as this would set the diffusive part of the flux to zero. The alternative is to specify the value of the temperature itself, a Dirichlet boundary condition, $T(a) = T_{edge}$. This value, $T_{edge}$, is determined by the physics of the SOL. The efficient heat removal by the SOL clamps the temperature at the edge of the core plasma to a specific value.\n4.  **Interpretive vs. Predictive**:\n    -   In *interpretive* modeling, experimental data is available. A measurement of the temperature at the top of the edge pedestal, $T_{\\mathrm{ped,top}}$, provides a direct, physical value to impose: $T(a) = T_{\\mathrm{ped,top}}$.\n    -   In *predictive* modeling, where no experimental data is used, the value of $T_{\\mathrm{ped,top}}$ must be calculated by a separate, physics-based model for the edge pedestal and SOL. This model then provides the boundary value for the core transport simulation.\nIn both cases, a Dirichlet condition $T(a)=T_{\\mathrm{ped,top}}$ represents the physical coupling between the core and the edge plasma.\n\n### Option-by-Option Analysis\n\n**A. At the magnetic axis, impose $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0} = 0$ because rotational symmetry and regularity of the scalar field $T(\\mathbf{x})$ imply a vanishing gradient at the axis; any nonzero $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=0}$ would select a preferred direction and, when combined with $V'(r)\\sim C r$, can lead to an unphysical $\\frac{1}{V'}\\frac{\\partial}{\\partial r}\\left[V' q_r\\right]$ behavior unless compensated by a singular source.**\nThis statement is fully consistent with our analysis. It provides two correct and complementary justifications for the zero-gradient condition at the magnetic axis:\n1.  The physical argument from regularity: A smooth, axisymmetric scalar field cannot have a non-zero radial gradient at the axis of symmetry. A non-zero gradient would imply a cusp in the profile, which is unphysical.\n2.  The mathematical argument from the transport equation itself: A non-zero gradient at $r=0$ results in a term in the equation that diverges as $1/r$, which is inconsistent with the assumption of no singular sources.\n**Verdict: Correct.**\n\n**B. At the separatrix ($r=a$), impose a Dirichlet condition $T(a) = T_{\\mathrm{ped,top}}$ where $T_{\\mathrm{ped,top}}$ is either experimentally measured (interpretive) or provided by an edge pedestal/Scrape-Off Layer model (predictive); this pins the closed-field-line boundary to a physically consistent pedestal-top state that matches parallel heat removal in the SOL.**\nThis statement is fully consistent with our analysis of the outer boundary. It correctly identifies that a Dirichlet condition is the physically appropriate choice, representing the \"clamping\" effect of the highly efficient heat transport in the Scrape-Off Layer. It also correctly distinguishes the origin of this value in interpretive versus predictive modeling contexts.\n**Verdict: Correct.**\n\n**C. At the magnetic axis, impose $T(0)=0$ to eliminate unknown core heat flux; this guarantees uniqueness even with finite central heating.**\nThis statement is incorrect for multiple reasons.\n1.  **Physical Inconsistency**: $T(0)=0$ is physically absurd. The core of a tokamak plasma is where heating is typically strongest and temperatures are highest. The temperature profile should peak at or near $r=0$.\n2.  **Flawed Justification**: The core heat flux *through the axis* ($r=0$) is already known to be zero due to geometry ($V'(0)=0$), not because of a specific boundary condition on $T$. The choice of boundary condition helps determine the full temperature profile, which in turn determines the flux at $r0$.\n3.  **Uniqueness**: While a Dirichlet condition helps ensure uniqueness, it is the wrong physical condition. The physically correct Neumann condition from option A, when paired with the Dirichlet condition at $r=a$, also forms a well-posed problem with a unique solution.\n**Verdict: Incorrect.**\n\n**D. At the separatrix, impose $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=a} = 0$ because field lines inside the separatrix are closed, so there is no net heat loss across $r=a$ and the gradient should vanish there.**\nThis statement is fundamentally incorrect.\n1.  **Violation of Energy Conservation**: For a plasma in steady state with a central heat source ($S_E  0$), there *must* be a net outward flow of heat across every flux surface to exhaust the power being put in. This means the radial heat flux $q_r(a)$ cannot be zero.\n2.  **Incorrect physical reasoning**: A zero gradient $\\left.\\frac{\\partial T}{\\partial r}\\right|_{r=a} = 0$ would imply zero diffusive heat flux at the boundary. This would mean that either there is no heating in the plasma, or all heat is removed by a convective flux, which contradicts the general formulation and physical reality where diffusive transport is dominant. The fact that field lines are closed *necessitates* cross-field transport to move heat outwards; it does not prevent it.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "The equations governing plasma transport are notoriously 'stiff,' characterized by processes occurring on vastly different time and spatial scales, especially in regions with transport barriers. This stiffness poses a significant challenge for numerical time-stepping algorithms . Through a stability analysis of explicit and implicit methods, this practice illuminates why certain numerical schemes are essential for efficiently simulating stiff transport phenomena and allows you to quantify the stringent time-step limitations of simpler approaches.",
            "id": "3997886",
            "problem": "Consider axisymmetric radial heat transport in a magnetically confined fusion plasma, modeled in slab geometry by the one-dimensional diffusion equation for the temperature field $T(r,t)$,\n$$\n\\frac{\\partial T}{\\partial t} = \\chi(r)\\,\\frac{\\partial^{2} T}{\\partial r^{2}} + S(r,t),\n$$\nwhere $\\chi(r)$ is the turbulent thermal diffusivity and $S(r,t)$ is an externally applied heat source. In regimes with stiff transport, $\\chi(r)$ can become large in localized regions, and predictive transport solvers must choose time-stepping schemes that remain stable on fine radial meshes.\n\nYou will analyze the linear homogeneous diffusion operator (set $S=0$) and compare forward Euler (explicit) and backward Euler (implicit) time-stepping stability for the semi-discrete problem obtained with second-order central differences on a uniform mesh. Then, you will apply the resulting stability constraint to a nonuniform mesh and a spatially varying $\\chi(r)$ profile representative of a pedestal region.\n\nTasks:\n\n1. Starting from the linear diffusion operator, perform a von Neumann (Fourier) stability analysis on a uniform grid with spacing $\\Delta r$ for:\n   - Forward Euler (explicit) time-stepping discretization.\n   - Backward Euler (implicit) time-stepping discretization.\n   Derive the amplification factor $G(k)$ for each scheme for a Fourier mode $\\exp(\\mathrm{i} k r)$, and determine the corresponding stability requirement in terms of the non-dimensional parameter $\\mu = \\chi\\,\\Delta t/\\Delta r^{2}$. Explain, using the amplification factors, why backward Euler is unconditionally stable while forward Euler requires a time step constraint that becomes severe for stiff transport with large $\\chi$ and small $\\Delta r$.\n\n2. Consider a nonuniform radial mesh and diffusivity profile mimicking a core–pedestal–edge structure:\n   - Core region: uniform cell width $\\Delta r_{\\mathrm{core}} = 0.015\\,\\mathrm{m}$ with constant diffusivity $\\chi_{\\mathrm{core}} = 0.80\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n   - Pedestal region: uniform cell width $\\Delta r_{\\mathrm{ped}} = 0.003\\,\\mathrm{m}$ with constant diffusivity $\\chi_{\\mathrm{ped}} = 1.50\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n   - Edge region: uniform cell width $\\Delta r_{\\mathrm{edge}} = 0.012\\,\\mathrm{m}$ with constant diffusivity $\\chi_{\\mathrm{edge}} = 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n\n   Using the local diffusion Courant–Friedrichs–Lewy (CFL) condition obtained from your analysis, compute the maximum stable time step $\\Delta t_{\\max}$ for a forward Euler explicit scheme on this mesh by taking the minimum over regions. Express the final $\\Delta t_{\\max}$ in microseconds and round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The problem describes the one-dimensional diffusion equation, a standard model for heat transport in plasmas. It asks for a von Neumann stability analysis of two common numerical schemes, Forward and Backward Euler, which is a fundamental procedure in computational physics. All parameters and constants are clearly defined, and the values provided are physically plausible for a fusion plasma context. The tasks are specific, and the required data is complete. Therefore, the problem is deemed valid.\n\nWe begin the analysis with the linear homogeneous one-dimensional diffusion equation:\n$$\n\\frac{\\partial T}{\\partial t} = \\chi\\,\\frac{\\partial^{2} T}{\\partial r^{2}}\n$$\nHere, the thermal diffusivity $\\chi$ is treated as a constant for the von Neumann analysis on a uniform grid with spacing $\\Delta r$. The temperature at grid point $j$ and time step $n$ is denoted by $T_j^n \\equiv T(j\\Delta r, n\\Delta t)$. Using a second-order central difference for the spatial derivative, the semi-discrete equation is:\n$$\n\\frac{d T_j}{d t} = \\chi \\left( \\frac{T_{j+1} - 2T_j + T_{j-1}}{\\Delta r^2} \\right)\n$$\n\n### Task 1: Von Neumann Stability Analysis\n\nWe analyze the stability by considering a single Fourier mode, $T_j^n = G^n(k) \\exp(\\mathrm{i} k j \\Delta r)$, where $k$ is the wavenumber and $G(k)$ is the amplification factor per time step $\\Delta t$. A scheme is stable if $|G(k)| \\le 1$ for all possible wavenumbers $k$.\n\n#### 1a. Forward Euler (Explicit) Scheme\nThe Forward Euler discretization of the semi-discrete equation is:\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\chi \\left( \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{\\Delta r^2} \\right)\n$$\nRearranging and introducing the non-dimensional parameter $\\mu = \\chi \\Delta t / \\Delta r^2$, we get:\n$$\nT_j^{n+1} = T_j^n + \\mu (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\nSubstituting the Fourier mode ansatz $T_j^n = G^n(k) \\exp(\\mathrm{i} k j \\Delta r)$:\n$$\nG^{n+1}\\exp(\\mathrm{i}kj\\Delta r) = G^n\\exp(\\mathrm{i}kj\\Delta r) + \\mu \\left( G^n\\exp(\\mathrm{i}k(j+1)\\Delta r) - 2G^n\\exp(\\mathrm{i}kj\\Delta r) + G^n\\exp(\\mathrm{i}k(j-1)\\Delta r) \\right)\n$$\nDividing by $G^n \\exp(\\mathrm{i} k j \\Delta r)$, we find the amplification factor $G(k) = G^{n+1}/G^n$:\n$$\nG(k) = 1 + \\mu (\\exp(\\mathrm{i}k\\Delta r) - 2 + \\exp(-\\mathrm{i}k\\Delta r))\n$$\nUsing the identity $2\\cos(\\theta) = \\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta)$, this simplifies to:\n$$\nG(k) = 1 + \\mu (2\\cos(k\\Delta r) - 2) = 1 - 2\\mu(1 - \\cos(k\\Delta r))\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\nG(k) = 1 - 4\\mu \\sin^2\\left(\\frac{k\\Delta r}{2}\\right)\n$$\nFor stability, we require $|G(k)| \\le 1$, which for the real-valued $G(k)$ is $-1 \\le G(k) \\le 1$.\nThe condition $G(k) \\le 1$ is always satisfied since $\\mu  0$ and $\\sin^2(\\cdot) \\ge 0$.\nThe critical condition is $G(k) \\ge -1$:\n$$\n-1 \\le 1 - 4\\mu \\sin^2\\left(\\frac{k\\Delta r}{2}\\right)\n$$\n$$\n4\\mu \\sin^2\\left(\\frac{k\\Delta r}{2}\\right) \\le 2\n$$\nThis inequality must hold for all $k$. The most restrictive case occurs when $\\sin^2(k\\Delta r/2)$ is maximum, which is $1$ (for the highest frequency mode where $k\\Delta r = \\pi$). This yields the stability constraint:\n$$\n4\\mu(1) \\le 2 \\implies \\mu \\le \\frac{1}{2}\n$$\nThus, the Forward Euler scheme is conditionally stable, requiring $\\mu = \\chi \\Delta t / \\Delta r^2 \\le 1/2$.\n\n#### 1b. Backward Euler (Implicit) Scheme\nThe Backward Euler discretization evaluates the spatial derivative at the future time step $n+1$:\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\chi \\left( \\frac{T_{j+1}^{n+1} - 2T_j^{n+1} + T_{j-1}^{n+1}}{\\Delta r^2} \\right)\n$$\nRearranging gives:\n$$\nT_j^n = T_j^{n+1} - \\mu(T_{j+1}^{n+1} - 2T_j^{n+1} + T_{j-1}^{n+1})\n$$\nSubstituting the Fourier mode ansatz:\n$$\nG^n\\exp(\\mathrm{i}kj\\Delta r) = G^{n+1}\\exp(\\mathrm{i}kj\\Delta r) - \\mu \\left( G^{n+1}\\exp(\\mathrmi}k(j+1)\\Delta r) - 2G^{n+1}\\exp(\\mathrm{i}kj\\Delta r) + G^{n+1}\\exp(\\mathrm{i}k(j-1)\\Delta r) \\right)\n$$\nDividing by $G^{n+1} \\exp(\\mathrm{i} k j \\Delta r)$:\n$$\n\\frac{1}{G(k)} = 1 - \\mu(\\exp(\\mathrm{i}k\\Delta r) - 2 + \\exp(-\\mathrm{i}k\\Delta r)) = 1 - 2\\mu(\\cos(k\\Delta r) - 1) = 1 + 4\\mu\\sin^2\\left(\\frac{k\\Delta r}{2}\\right)\n$$\nSo, the amplification factor is:\n$$\nG(k) = \\frac{1}{1 + 4\\mu \\sin^2\\left(\\frac{k\\Delta r}{2}\\right)}\n$$\nFor stability, we require $|G(k)| \\le 1$. Since $\\mu  0$ and $\\sin^2(\\cdot) \\ge 0$, the denominator $1 + 4\\mu \\sin^2(k\\Delta r/2)$ is always greater than or equal to $1$. Therefore, $0  G(k) \\le 1$ for all values of $\\mu$ and $k$. The Backward Euler scheme is unconditionally stable.\n\n#### Explanation\nThe forward Euler stability constraint is $\\Delta t \\le \\frac{\\Delta r^2}{2\\chi}$. In stiff transport regimes, such as the pedestal of a fusion plasma, the turbulent thermal diffusivity $\\chi$ is very large. To resolve the sharp gradients in such regions, a fine radial mesh (small $\\Delta r$) is required. Both large $\\chi$ and small $\\Delta r$ severely restrict the maximum stable time step $\\Delta t$ for the explicit scheme, as $\\Delta t$ scales with $\\Delta r^2$ and $1/\\chi$. This makes the forward Euler scheme computationally prohibitive.\nIn contrast, the backward Euler scheme is unconditionally stable, meaning its amplification factor $|G(k)| \\le 1$ irrespective of the values of $\\Delta t$, $\\Delta r$, and $\\chi$. This allows for the selection of a much larger $\\Delta t$, limited only by a desired accuracy, not by stability. This property makes implicit schemes like backward Euler essential for efficiently simulating stiff transport problems.\n\n### Task 2: Maximum Stable Time Step Calculation\n\nFor a forward Euler scheme on a nonuniform mesh with spatially varying diffusivity, the stability condition must hold locally at every point in the domain. The global maximum stable time step, $\\Delta t_{\\max}$, is thus limited by the most restrictive region, i.e., the region with the minimum value of $\\Delta r^2 / (2\\chi)$.\nThe local stability condition is:\n$$\n\\Delta t \\le \\frac{\\Delta r_i^2}{2\\chi_i}\n$$\nwhere the index $i$ denotes a specific region (core, pedestal, or edge). The global maximum stable time step is:\n$$\n\\Delta t_{\\max} = \\min \\left( \\frac{\\Delta r_{\\mathrm{core}}^2}{2\\chi_{\\mathrm{core}}}, \\frac{\\Delta r_{\\mathrm{ped}}^2}{2\\chi_{\\mathrm{ped}}}, \\frac{\\Delta r_{\\mathrm{edge}}^2}{2\\chi_{\\mathrm{edge}}} \\right)\n$$\nWe compute this value for each region using the provided data:\n- **Core region:** $\\Delta r_{\\mathrm{core}} = 0.015\\,\\mathrm{m}$, $\\chi_{\\mathrm{core}} = 0.80\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n$$\n\\Delta t_{\\mathrm{core}} = \\frac{(0.015\\,\\mathrm{m})^2}{2 \\times 0.80\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}} = \\frac{0.000225}{1.6}\\,\\mathrm{s} = 0.000140625\\,\\mathrm{s} = 140.625\\,\\mu\\mathrm{s}\n$$\n- **Pedestal region:** $\\Delta r_{\\mathrm{ped}} = 0.003\\,\\mathrm{m}$, $\\chi_{\\mathrm{ped}} = 1.50\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n$$\n\\Delta t_{\\mathrm{ped}} = \\frac{(0.003\\,\\mathrm{m})^2}{2 \\times 1.50\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}} = \\frac{9 \\times 10^{-6}}{3.0}\\,\\mathrm{s} = 3 \\times 10^{-6}\\,\\mathrm{s} = 3.0\\,\\mu\\mathrm{s}\n$$\n- **Edge region:** $\\Delta r_{\\mathrm{edge}} = 0.012\\,\\mathrm{m}$, $\\chi_{\\mathrm{edge}} = 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n$$\n\\Delta t_{\\mathrm{edge}} = \\frac{(0.012\\,\\mathrm{m})^2}{2 \\times 0.30\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}} = \\frac{0.000144}{0.6}\\,\\mathrm{s} = 0.00024\\,\\mathrm{s} = 240.0\\,\\mu\\mathrm{s}\n$$\nThe global maximum stable time step is the minimum of these values:\n$$\n\\Delta t_{\\max} = \\min(140.625\\,\\mu\\mathrm{s}, 3.0\\,\\mu\\mathrm{s}, 240.0\\,\\mu\\mathrm{s}) = 3.0\\,\\mu\\mathrm{s}\n$$\nThe pedestal region, with its combination of high diffusivity and fine grid spacing, imposes the most severe constraint on the explicit time step.\nRounding the result to four significant figures gives $3.000\\,\\mu\\mathrm{s}$.",
            "answer": "$$\\boxed{3.000}$$"
        }
    ]
}