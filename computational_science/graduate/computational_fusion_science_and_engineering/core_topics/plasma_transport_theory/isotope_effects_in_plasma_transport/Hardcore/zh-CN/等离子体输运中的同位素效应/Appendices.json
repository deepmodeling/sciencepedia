{
    "hands_on_practices": [
        {
            "introduction": "理解能量如何从聚变等离子体中逃逸至关重要。热量损失的一个主要途径是沿磁力线的传导，这个过程由离子热导率 $\\kappa_{i\\parallel}$ 决定。第一个练习  将引导您从第一性原理出发，进行一次基础性的推导，揭示这个关键的输运系数如何随同位素质量变化，从而为理解重同位素如何影响等离子体性能提供一个基准预期。",
            "id": "3998934",
            "problem": "一个完全电离的磁化类氢等离子体，其沿磁场的碰撞输运采用 Braginskii 流体闭合模型进行建模。考虑一种离子，其电荷数为 $Z$，质量为 $m_i$，数密度为 $n_i$，温度为 $T_i$。在碰撞机制下，平行离子热流与平行温度梯度之间的关系为 $q_{i\\parallel}=-\\kappa_{i\\parallel}\\,\\partial_{\\parallel}T_i$，其中 $\\kappa_{i\\parallel}$ 是 Braginskii 闭合模型中的平行离子热导率。在动理学理论中，该热导率通过弛豫时间近似引入，其中\n$$\n\\kappa_{i\\parallel}\\propto n_i\\,T_i\\,\\frac{\\tau_i}{m_i},\n$$\n且离子-离子碰撞时间 $\\tau_i$ 是库仑碰撞频率的倒数。从库仑碰撞的 Landau (Fokker–Planck) 描述出发，使用经过充分检验的离子-离子碰撞频率标度关系，\n$$\n\\nu_{ii}\\propto \\frac{n_i\\,Z^{4}\\,e^{4}\\,\\ln\\Lambda}{\\varepsilon_{0}^{2}}\\,\\frac{1}{m_i^{1/2}\\,(k_{B}T_i)^{3/2}},\n$$\n其中 $e$ 是元电荷，$\\varepsilon_{0}$ 是真空介电常数，$k_{B}$ 是玻尔兹曼常数，$\\ln\\Lambda$ 是库仑对数。推导 $\\kappa_{i\\parallel}$ 以及沿磁场的 $q_{i\\parallel}$ 对质量的显式依赖关系。\n\n现在考虑两种 $Z=1$ 的同位素，它们具有相同的数密度 $n_i$、温度 $T_i$、库仑对数 $\\ln\\Lambda$ 以及相同的平行温度梯度 $\\partial_{\\parallel}T_i$。设这两种同位素为氘（质量 $m_{D}=2\\,m_{p}$）和氚（质量 $m_{T}=3\\,m_{p}$），其中 $m_{p}$ 是质子质量。使用您推导出的标度关系，计算它们的平行离子热流大小之比 $q_{T\\parallel}/q_{D\\parallel}$。将您的最终数值答案表示为一个纯数，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导平行离子热导率 $\\kappa_{i\\parallel}$ 的质量依赖关系，并随后计算两种氢同位素——氘和氚的平行离子热流之比。\n\n首先，我们验证问题陈述的有效性。\n已知条件如下：\n1.  平行离子热流：$q_{i\\parallel}=-\\kappa_{i\\parallel}\\,\\partial_{\\parallel}T_i$。\n2.  来自弛豫时间近似的平行离子热导率标度关系：$\\kappa_{i\\parallel}\\propto n_i\\,T_i\\,\\frac{\\tau_i}{m_i}$。\n3.  离子-离子碰撞时间是碰撞频率的倒数：$\\tau_i = \\nu_{ii}^{-1}$。\n4.  离子-离子碰撞频率的标度关系：$\\nu_{ii}\\propto \\frac{n_i\\,Z^{4}\\,e^{4}\\,\\ln\\Lambda}{\\varepsilon_{0}^{2}}\\,\\frac{1}{m_i^{1/2}\\,(k_{B}T_i)^{3/2}}$。\n5.  将在氘（$D$）和氚（$T$）这两种电荷数 $Z=1$ 的同位素之间进行比较。它们的质量分别为 $m_{D}=2\\,m_{p}$ 和 $m_{T}=3\\,m_{p}$，其中 $m_p$ 是质子质量。\n6.  比较在相同的数密度 $n_i$、温度 $T_i$、库仑对数 $\\ln\\Lambda$ 和平行温度梯度 $\\partial_{\\parallel}T_i$ 的条件下进行。\n\n该问题具有科学依据，植根于磁化等离子体的标准碰撞输运理论（Braginskii 模型，Fokker-Planck 碰撞）。问题提法清晰，信息充分，足以推导出所需的标度关系并计算比值。语言客观而精确。因此，该问题被认为是有效的，我们可以着手求解。\n\n我们的第一步是确定 $\\kappa_{i\\parallel}$ 对离子质量 $m_i$ 的显式依赖关系。我们从给定的热导率标度关系开始：\n$$\n\\kappa_{i\\parallel}\\propto n_i\\,T_i\\,\\frac{\\tau_i}{m_i}\n$$\n离子-离子碰撞时间 $\\tau_i$ 是离子-离子碰撞频率 $\\nu_{ii}$ 的倒数，因此我们有 $\\tau_i \\propto \\nu_{ii}^{-1}$。将此代入 $\\kappa_{i\\parallel}$ 的表达式中得到：\n$$\n\\kappa_{i\\parallel}\\propto \\frac{n_i\\,T_i}{m_i\\,\\nu_{ii}}\n$$\n接下来，我们使用给定的离子-离子碰撞频率 $\\nu_{ii}$ 的标度关系。为了分离出对等离子体参数（$n_i$、$T_i$、$Z$、$m_i$）的依赖性，我们可以将比例关系写为：\n$$\n\\nu_{ii}\\propto \\frac{n_i\\,Z^4}{m_i^{1/2}\\,T_i^{3/2}}\n$$\n这里我们已将所有物理常数（$e$、$\\varepsilon_0$、$k_B$）和弱相关的库仑对数 $\\ln\\Lambda$ 吸收到比例常数中。\n\n将 $\\nu_{ii}$ 的这个标度关系代入我们 $\\kappa_{i\\parallel}$ 的表达式中：\n$$\n\\kappa_{i\\parallel} \\propto \\frac{n_i\\,T_i}{m_i} \\left( \\frac{n_i\\,Z^4}{m_i^{1/2}\\,T_i^{3/2}} \\right)^{-1}\n$$\n现在我们可以通过对括号中的项取倒数来简化此表达式：\n$$\n\\kappa_{i\\parallel} \\propto \\frac{n_i\\,T_i}{m_i} \\cdot \\frac{m_i^{1/2}\\,T_i^{3/2}}{n_i\\,Z^4}\n$$\n合并同底项，我们得到：\n$$\n\\kappa_{i\\parallel} \\propto \\left(\\frac{n_i}{n_i}\\right) \\cdot \\left(\\frac{T_i \\cdot T_i^{3/2}}{Z^4}\\right) \\cdot \\left(\\frac{m_i^{1/2}}{m_i}\\right)\n$$\n$$\n\\kappa_{i\\parallel} \\propto (n_i)^0 \\cdot \\frac{T_i^{5/2}}{Z^4} \\cdot m_i^{1/2 - 1}\n$$\n$$\n\\kappa_{i\\parallel} \\propto \\frac{T_i^{5/2}}{Z^4} \\, m_i^{-1/2}\n$$\n此推导表明，平行离子热导率与离子质量的平方根成反比，即 $\\kappa_{i\\parallel} \\propto m_i^{-1/2}$。\n\n平行离子热流由 $q_{i\\parallel}=-\\kappa_{i\\parallel}\\,\\partial_{\\parallel}T_i$ 给出。为了比较大小，我们考虑 $|q_{i\\parallel}| = \\kappa_{i\\parallel}|\\partial_{\\parallel}T_i|$。由于我们是在所有其他参数（包括 $\\partial_{\\parallel}T_i$）保持不变的条件下比较同位素，热流大小的质量依赖关系与热导率的质量依赖关系相同：\n$$\n|q_{i\\parallel}| \\propto \\kappa_{i\\parallel} \\propto m_i^{-1/2}\n$$\n题目要求我们计算氚（$T$）和氘（$D$）的平行离子热流大小之比，分别表示为 $q_{T\\parallel}$ 和 $q_{D\\parallel}$。两者都是氢的同位素，因此 $Z=1$。它们具有相同的 $n_i$、$T_i$ 和 $\\partial_{\\parallel}T_i$。使用推导出的标度关系：\n$$\n\\frac{|q_{T\\parallel}|}{|q_{D\\parallel}|} = \\frac{C \\cdot m_T^{-1/2}}{C \\cdot m_D^{-1/2}}\n$$\n其中 $C$ 是比例常数。这可以简化为：\n$$\n\\frac{|q_{T\\parallel}|}{|q_{D\\parallel}|} = \\left(\\frac{m_T}{m_D}\\right)^{-1/2} = \\left(\\frac{m_D}{m_T}\\right)^{1/2} = \\sqrt{\\frac{m_D}{m_T}}\n$$\n问题给出了氘和氚的质量与质子质量 $m_p$ 的关系：$m_D = 2\\,m_p$ 和 $m_T = 3\\,m_p$。将这些值代入比率中：\n$$\n\\frac{|q_{T\\parallel}|}{|q_{D\\parallel}|} = \\sqrt{\\frac{2\\,m_p}{3\\,m_p}} = \\sqrt{\\frac{2}{3}}\n$$\n最后，我们计算数值，并按要求四舍五入到四位有效数字。\n$$\n\\sqrt{\\frac{2}{3}} \\approx \\sqrt{0.666666...} \\approx 0.81649658...\n$$\n四舍五入到四位有效数字，我们得到 $0.8165$。因此，在相同条件下，氚的平行热流约等于氘的 $81.65\\%$，这是氚质量较大导致碰撞频率较低，进而热导率较小的直接结果。",
            "answer": "$$\n\\boxed{0.8165}\n$$"
        },
        {
            "introduction": "虽然前一个练习为离子输运建立了一个清晰的质量标度关系，但认识到并非所有等离子体现象都以相同的方式依赖于同位素质量是至关重要的。这个实践  提出了一个关于两种过程的对比：计算决定电子输运的有效电荷数 $Z_{\\text{eff}}$，以及分析杂质离子的慢化过程。通过解决这个问题，您将发现为什么一个过程对同位素质量不敏感而另一个过程却非如此，从而磨练您辨别不同输运机制背后物理原理的能力。",
            "id": "3998960",
            "problem": "一个均匀磁约束等离子体由氘和氚同位素的类氢混合物，外加痕量的全剥离碳杂质组成。氘和氚同位素具有相同的电荷态 $Z_D = Z_T = 1$，但离子质量不同，分别为 $m_D = 2 m_p$ 和 $m_T = 3 m_p$，其中 $m_p$ 是质子质量。全剥离碳杂质的电荷态为 $Z_C = 6$，离子质量为 $m_C = 12 m_p$。各粒子数密度为 $n_D = 3.20 \\times 10^{19}\\,\\mathrm{m^{-3}}$，$n_T = 1.80 \\times 10^{19}\\,\\mathrm{m^{-3}}$ 和 $n_C = 1.25 \\times 10^{17}\\,\\mathrm{m^{-3}}$。假设电子是麦克斯韦分布的，并且准中性条件成立。\n\n仅使用基本的电子-离子电阻性动量平衡和准中性条件，推导混合物的有效电荷 $Z_{\\text{eff}}$ 的表达式，并根据给定的密度计算其数值。将 $Z_{\\text{eff}}$ 表示为一个无量纲数，并将最终结果四舍五入到四位有效数字。\n\n另外，从库仑相互作用的 Fokker–Planck (FP) 碰撞算符的 Landau 形式出发，分析同位素质量 $m_D$ 和 $m_T$ 是否会进入有效电荷 $Z_{\\text{eff}}$ 的表达式中，并解释在离子温度为 $T_i$ 的类氢背景中运动的电荷为 $Z_I$、质量为 $m_I$ 的重杂质测试离子的碰撞减速过程中，$m_i$ 的间接作用。在高速极限 $v \\gg v_{\\text{th},b}$（其中 $v_{\\text{th},b} = \\sqrt{2 k_B T_i/m_b}$ 是质量为 $m_b$ 的背景离子的热速度）下，给出通过折合质量 $m_r = \\frac{m_I m_b}{m_I + m_b}$ 和热速度 $v_{\\text{th},b}$ 进入减速时间的领先阶质量依赖关系。此部分无需进行数值计算。",
            "solution": "该问题经验证具有科学依据、适定、客观且自洽。它涉及等离子体物理学的标准概念，所提供的数据在物理上是现实的。解答将按要求分为两部分进行。\n\n第1部分：有效电荷 $Z_{\\text{eff}}$ 的计算\n\n有效电荷 $Z_{\\text{eff}}$ 是衡量等离子体中离子平均电荷的一个指标，该平均电荷是电子在诸如电阻率等碰撞过程中所感受到的。其定义源于总电子-离子碰撞频率的计算，该频率是等离子体中存在的所有离子种类的总和。从电阻性动量平衡的角度来看，这指向等离子体电阻率 $\\eta$，它与总电子-离子碰撞频率 $\\nu_{ei}$ 成正比。对于具有多种离子种类 $j$ 的等离子体，总频率是各单个碰撞频率之和，$\\nu_{ei} = \\sum_j \\nu_{ej}$。电子与离子种类 $j$ 的碰撞频率 $\\nu_{ej}$ 与离子密度 $n_j$ 和离子电荷态平方 $Z_j^2$ 的乘积成正比。因此，总电阻率与 $\\sum_j n_j Z_j^2$ 成正比。\n\n有效电荷 $Z_{\\text{eff}}$ 的形式定义为，每种离子种类的密度与电荷平方的乘积之和，与每种离子种类的密度与电荷的乘积之和的比值。分母代表来自离子的总正电荷密度，根据准中性原理，它必须等于电子密度 $n_e$。\n\n$Z_{\\text{eff}}$ 的表达式为：\n$$\nZ_{\\text{eff}} = \\frac{\\sum_{\\text{ions}, j} n_j Z_j^2}{n_e}\n$$\n使用准中性条件 $n_e = \\sum_{\\text{ions}, j} n_j Z_j$，我们得到用于计算的表达式：\n$$\nZ_{\\text{eff}} = \\frac{\\sum_{\\text{ions}, j} n_j Z_j^2}{\\sum_{\\text{ions}, j} n_j Z_j}\n$$\n该等离子体由三种离子组成：氘（D）、氚（T）和碳（C）。给定的参数为：\n- 氘：$n_D = 3.20 \\times 10^{19}\\,\\mathrm{m^{-3}}$，$Z_D = 1$\n- 氚：$n_T = 1.80 \\times 10^{19}\\,\\mathrm{m^{-3}}$，$Z_T = 1$\n- 碳：$n_C = 1.25 \\times 10^{17}\\,\\mathrm{m^{-3}}$，$Z_C = 6$\n\n首先，我们计算分子 $\\sum_j n_j Z_j^2$：\n$$\n\\sum_j n_j Z_j^2 = n_D Z_D^2 + n_T Z_T^2 + n_C Z_C^2\n$$\n$$\n\\sum_j n_j Z_j^2 = (3.20 \\times 10^{19}) (1)^2 + (1.80 \\times 10^{19}) (1)^2 + (1.25 \\times 10^{17}) (6)^2\n$$\n$$\n\\sum_j n_j Z_j^2 = 3.20 \\times 10^{19} + 1.80 \\times 10^{19} + (1.25 \\times 10^{17}) \\times 36\n$$\n$$\n\\sum_j n_j Z_j^2 = 5.00 \\times 10^{19} + 4.5 \\times 10^{18} = 5.00 \\times 10^{19} + 0.45 \\times 10^{19}\n$$\n$$\n\\sum_j n_j Z_j^2 = 5.45 \\times 10^{19}\\,\\mathrm{m^{-3}}\n$$\n接下来，我们计算分母 $\\sum_j n_j Z_j$，即电子密度 $n_e$：\n$$\n\\sum_j n_j Z_j = n_D Z_D + n_T Z_T + n_C Z_C\n$$\n$$\n\\sum_j n_j Z_j = (3.20 \\times 10^{19}) (1) + (1.80 \\times 10^{19}) (1) + (1.25 \\times 10^{17}) (6)\n$$\n$$\n\\sum_j n_j Z_j = 3.20 \\times 10^{19} + 1.80 \\times 10^{19} + 7.5 \\times 10^{17}\n$$\n$$\n\\sum_j n_j Z_j = 5.00 \\times 10^{19} + 0.075 \\times 10^{19}\n$$\n$$\n\\sum_j n_j Z_j = 5.075 \\times 10^{19}\\,\\mathrm{m^{-3}}\n$$\n最后，我们计算 $Z_{\\text{eff}}$：\n$$\nZ_{\\text{eff}} = \\frac{5.45 \\times 10^{19}}{5.075 \\times 10^{19}} = \\frac{5.45}{5.075} \\approx 1.0738916...\n$$\n将结果四舍五入到四位有效数字，得到 $1.074$。\n\n第2部分：$Z_{\\text{eff}}$ 中的同位素质量依赖性及杂质减速\n\n首先，我们分析同位素质量 $m_D$ 和 $m_T$ 是否会进入 $Z_{\\text{eff}}$ 的表达式中。如上所述，$Z_{\\text{eff}} = (\\sum_j n_j Z_j^2) / (\\sum_j n_j Z_j)$。此表达式仅依赖于离子种类的数密度 $n_j$ 和电荷态 $Z_j$。离子质量 $m_j$ 并未出现。\n\n这个结果可以从电子-离子碰撞的 Fokker-Planck 碰撞算符的 Landau 形式得到正式的理解。电子（种类 $a=e$）与离子种类（$j$）的碰撞项涉及 Rosenbluth 势 $h_j(\\mathbf{v}) = (1 + m_e/m_j) \\int |\\mathbf{v}-\\mathbf{v}'|^{-1} f_j(\\mathbf{v}')d^3\\mathbf{v}'$。由于质量比悬殊，$m_j \\gg m_e$，项 $m_e/m_j$ 可忽略不计，近似为零。这一简化有效地从电子-离子动量交换的控制方程中移除了离子质量 $m_j$。由于等离子体电阻率以及延伸而来的 $Z_{\\text{eff}}$ 是由电子-离子碰撞决定的，因此同位素质量 $m_D$ 和 $m_T$ 不会进入 $Z_{\\text{eff}}$ 的表达式中。\n\n接下来，我们分析离子质量 $m_i$ 在重杂质测试离子减速过程中的间接作用。与电子-离子碰撞不同，离子-离子碰撞涉及质量可比的粒子。在这种情况下，质量比不能忽略。测试离子（种类 $I$）在背景离子（种类 $b$）中的减速过程由碰撞拖曳力控制。此过程的特征时间尺度是减速时间 $\\tau_s$。\n\n速度为 $v$ 的测试粒子 $I$ 在温度为 $T_i$ 的麦克斯韦背景 $b$ 中的减速频率 $\\nu_s = 1/\\tau_s$ 的一般表达式为：\n$$\n\\nu_s^{I/b} = \\frac{n_b Z_I^2 Z_b^2 e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_I m_r v^3} \\left[ \\mathrm{erf}(x) - \\frac{2x}{\\sqrt{\\pi}}\\exp(-x^2) \\right]\n$$\n其中 $m_r = \\frac{m_I m_b}{m_I + m_b}$ 是折合质量，$x = v/v_{\\text{th},b}$，而 $v_{\\text{th},b} = \\sqrt{2 k_B T_i/m_b}$ 是背景离子的热速度。在此，背景离子质量 $m_b$（可以是 $m_D$ 或 $m_T$）在两个地方进入表达式：显式地出现在折合质量 $m_r$ 中，以及隐式地出现在热速度 $v_{\\text{th},b}$ 中。\n\n问题指定了高速极限，$v \\gg v_{\\text{th},b}$，这对应于 $x \\gg 1$。在此极限下，误差函数 $\\mathrm{erf}(x) \\to 1$，指数项 $\\exp(-x^2) \\to 0$。$\\nu_s$ 表达式中括号内的项趋近于 $1$。\n$$\n\\left[ \\mathrm{erf}(x) - \\frac{2x}{\\sqrt{\\pi}}\\exp(-x^2) \\right] \\to 1 \\quad \\text{for } x \\gg 1\n$$\n因此，在高速极限下，减速频率简化为：\n$$\n\\nu_s^{I/b} \\approx \\frac{n_b Z_I^2 Z_b^2 e^4 \\ln\\Lambda}{4\\pi\\epsilon_0^2 m_I m_r v^3}\n$$\n减速时间为 $\\tau_s = 1/\\nu_s$。\n$$\n\\tau_s^{I/b} \\approx \\frac{4\\pi\\epsilon_0^2 m_I m_r v^3}{n_b Z_I^2 Z_b^2 e^4 \\ln\\Lambda}\n$$\n从此表达式中，我们可以确定所要求的领先阶质量依赖关系。\n1. 对折合质量 $m_r$ 的依赖性：减速时间 $\\tau_s$ 与折合质量 $m_r$ 成正比。$m_r$ 的表达式为 $\\frac{m_I m_b}{m_I + m_b}$。因此，$\\tau_s \\propto m_r$。\n2. 对热速度 $v_{\\text{th},b}$ 的依赖性：在高速极限下，包含 $x=v/v_{\\text{th},b}$ 的项变为常数 $1$。因此，没有对背景热速度 $v_{\\text{th},b}$ 的领先阶依赖性。其依赖性为 $v_{\\text{th},b}^0$ 阶。从物理上看，这是因为一个速度非常快的测试粒子会将背景热离子视为基本静止的目标。\n\n总之，背景种类（D或T）的离子质量 $m_b$ 在离子-离子碰撞中起着关键作用，它进入了折合质量 $m_r$ 的计算中，而后者直接与减速时间成比例。",
            "answer": "$$\\boxed{1.074}$$"
        },
        {
            "introduction": "理论推导提供了物理上的洞见，但在聚变科学中，我们最终依赖实验和模拟数据来量化等离子体的性能。这最后一个实践  将带您进入数据驱动分析的领域，这是现代聚变研究的基石。您将构建一个综合回归研究，以确定全局能量约束时间 $\\tau_E$ 的同位素标度指数，学习如何将物理幂律模型转化为线性回归问题并从中提取有意义的参数——这是解读真实世界数据的一项基本技能。",
            "id": "3998921",
            "problem": "您需要设计一项人工合成回归研究，该研究模拟磁约束聚变等离子体中能量约束时间的类 gyro-Bohm 标度，并从假设的氢和氘数据集中定量提取同位素标度指数。此任务必须在纯数学和算法的层面上解决，同时保持科学上的真实性，并与计算聚变科学及工程原理保持一致。\n\n基本和核心定义：\n- 令能量约束时间表示为 $\\tau_E$，其根据全局能量平衡定义，为在没有加热的情况下储能衰减的特征时间尺度。gyro-Bohm 相似性假设导出了一个主导阶标度关系 $\\tau_E \\propto \\rho_*^{-3}$，其中 $\\rho_* \\equiv \\rho_i / a$ 是归一化离子回旋半径，$\\rho_i$ 是离子回旋半径，而 $a$ 是等离子体小半径。这导出了一个更通用的参数化标度关系，其中包含了碰撞性和压力效应。\n- 将归一化碰撞性定义为 $\\nu_*$（无量纲），等离子体比压定义为 $\\beta \\equiv 2 \\mu_0 p / B^2$（无量纲），其中 $p$ 是压强，$\\mu_0$ 是真空磁导率，$B$ 是磁场强度。\n- 将同位素质量数定义为 $A$（无量纲），氢（H）的 $A=1$，氘（D）的 $A=2$。\n- 我们将采用一个能量约束时间的参数化模型：\n$$\n\\tau_E = C \\, \\rho_*^{-3} \\, \\nu_*^{\\alpha} \\, \\beta^{\\delta} \\, A^{\\gamma},\n$$\n其中 $C$ 是一个单位为秒的常数，指数 $\\alpha$、$\\delta$ 和 $\\gamma$ 是无量纲的，需要从数据中推断。根据 gyro-Bohm 相似性，$\\rho_*$ 的指数固定为 $-3$，不进行拟合。参数 $\\gamma$ 是待提取的同位素指数。\n\n待实现的回归方法：\n- 使用对数变换将乘性模型转换为适合线性最小二乘估计的加性线性模型：\n$$\n\\ln \\tau_E = \\ln C - 3 \\ln \\rho_* + \\alpha \\ln \\nu_* + \\delta \\ln \\beta + \\gamma \\ln A.\n$$\n- 重新整理，将未知指数隔离在等式右侧：\n$$\ny \\equiv \\ln \\tau_E + 3 \\ln \\rho_* = \\ln C + \\alpha \\ln \\nu_* + \\delta \\ln \\beta + \\gamma \\ln A.\n$$\n- 构建设计矩阵，其列为 $\\{1, \\ln \\nu_*, \\ln \\beta, \\ln A\\}$，并使用标准方法求解参数矢量 $(\\ln C, \\alpha, \\delta, \\gamma)$ 的线性最小二乘问题。我们感兴趣的输出是同位素指数 $\\gamma$。\n\n数据规格和测试套件：\n您将合成三个独立的数据集。对于每个数据集，从指定的列表中形成 $(\\rho_*, \\nu_*, \\beta)$ 的所有组合，然后将该集合复制到两种同位素 $A \\in \\{1, 2\\}$ 上，以构成用于回归的组合数据集。对于每个数据点，使用该数据集特定的常数和指数从模型中计算 $\\tau_E$。目标是通过对每个数据集进行回归来恢复同位素指数 $\\gamma$。\n\n- 数据集 $\\mathsf{A}$ (通用“理想”路径)：\n  - 常数和指数：$C = 1.0 \\times 10^{-8}$ 秒，$\\alpha = 0.5$，$\\delta = -0.3$，$\\gamma = 0.2$。\n  - 参数列表：\n    - $\\rho_* \\in \\{3.0 \\times 10^{-3}, 4.0 \\times 10^{-3}, 5.0 \\times 10^{-3}, 6.0 \\times 10^{-3}\\}$，\n    - $\\nu_* \\in \\{0.05, 0.10, 0.20\\}$，\n    - $\\beta \\in \\{0.010, 0.020, 0.030\\}$。\n  - 同位素：$A \\in \\{1, 2\\}$。\n\n- 数据集 $\\mathsf{B}$ (无同位素依赖性的边界条件)：\n  - 常数和指数：$C = 8.0 \\times 10^{-9}$ 秒，$\\alpha = 0.5$，$\\delta = -0.3$，$\\gamma = 0.0$。\n  - 参数列表：\n    - $\\rho_* \\in \\{3.0 \\times 10^{-3}, 4.0 \\times 10^{-3}, 5.0 \\times 10^{-3}, 6.0 \\times 10^{-3}\\}$，\n    - $\\nu_* \\in \\{0.05, 0.10, 0.20\\}$，\n    - $\\beta \\in \\{0.010, 0.020, 0.030\\}$。\n  - 同位素：$A \\in \\{1, 2\\}$。\n\n- 数据集 $\\mathsf{C}$ ( $\\nu_*$ 和 $\\beta$ 之间存在强共线性的边缘情况)：\n  - 常数和指数：$C = 1.2 \\times 10^{-8}$ 秒，$\\alpha = 0.6$，$\\delta = -0.6$，$\\gamma = -0.1$。\n  - 参数列表：\n    - $\\rho_* \\in \\{4.0 \\times 10^{-3}, 5.0 \\times 10^{-3}, 6.0 \\times 10^{-3}\\}$，\n    - $\\nu_* \\in \\{0.06, 0.12, 0.18, 0.24\\}$，\n    - $\\beta \\in \\{0.012, 0.024, 0.036, 0.048\\}$。\n  - 同位素：$A \\in \\{1, 2\\}$。\n\n算法要求：\n- 对于每个数据集：\n  1. 生成 $(\\rho_*, \\nu_*, \\beta)$ 的所有组合，并为两种同位素 $A \\in \\{1, 2\\}$ 进行复制。\n  2. 使用该数据集指定的 $C$、$\\alpha$、$\\delta$ 和 $\\gamma$ 计算 $\\tau_E$。\n  3. 构成 $y = \\ln \\tau_E + 3 \\ln \\rho_*$ 和以 $(1, \\ln \\nu_*, \\ln \\beta, \\ln A)$ 为列的设计矩阵。\n  4. 求解最小二乘问题并提取拟合的同位素指数 $\\gamma$。\n- 不应添加随机噪声；所有值必须根据提供的列表和常数确定性地计算。\n\n单位和输出：\n- $\\tau_E$ 以秒为单位计算，但报告的指数是无量纲的。不涉及角度单位。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。该列表必须按顺序包含与数据集 $\\mathsf{A}$、数据集 $\\mathsf{B}$ 和数据集 $\\mathsf{C}$ 对应的三个拟合的同位素指数 $\\gamma$（以十进制形式）。\n\n最终输出格式：\n- 仅一行，格式为：$[\\gamma_{\\mathsf{A}},\\gamma_{\\mathsf{B}},\\gamma_{\\mathsf{C}}]$。",
            "solution": "问题陈述经评估有效。它在科学上基于等离子体约束物理学的原理，在数学上是适定的，并且在算法上是可处理的。该问题提供了一套完整且一致的定义、数据和程序要求，以执行人工合成回归研究并提取一个物理参数。包含一个带有共线性预测变量的案例（数据集 $\\mathsf{C}$）是对回归方法稳健性的一个复杂测试，但这并不会使问题无效，因为我们感兴趣的参数仍然是唯一可识别的。\n\n核心任务是从由能量约束时间 $\\tau_E$ 的幂律模型生成的人工合成数据中确定同位素标度指数 $\\gamma$。该模型由以下公式给出：\n$$\n\\tau_E = C \\, \\rho_*^{-3} \\, \\nu_*^{\\alpha} \\, \\beta^{\\delta} \\, A^{\\gamma}\n$$\n这里，$\\tau_E$ 是能量约束时间，$C$ 是一个比例常数，$\\rho_*$ 是归一化离子回旋半径，$\\nu_*$ 是归一化碰撞性，$\\beta$ 是等离子体比压，$A$ 是同位素质量数。指数 $\\alpha$、$\\delta$ 和 $\\gamma$ 有待确定，但我们的焦点仅在 $\\gamma$ 上。基于 gyro-Bohm 标度假设，$\\rho_*$ 的指数固定为 $-3$。\n\n为了提取这些指数，我们通过对等式两边取自然对数，将这个乘性模型转换为线性模型：\n$$\n\\ln \\tau_E = \\ln C - 3 \\ln \\rho_* + \\alpha \\ln \\nu_* + \\delta \\ln \\beta + \\gamma \\ln A\n$$\n这个方程可以重排以拟合标准线性回归形式 $y = \\mathbf{x}^T \\mathbf{b}$，其中 $\\mathbf{b}$ 是一个待估计的系数向量。我们定义一个新的响应变量 $y$，将所有已知项合并到左侧：\n$$\ny \\equiv \\ln \\tau_E + 3 \\ln \\rho_* = \\ln C + \\alpha \\ln \\nu_* + \\delta \\ln \\beta + \\gamma \\ln A\n$$\n这是一个关于未知系数 $[\\ln C, \\alpha, \\delta, \\gamma]$ 的线性方程。对于一组包含 $N$ 个数据点的集合，这可以表示为矩阵形式 $\\mathbf{y} = \\mathbf{X}\\mathbf{b}$，其中：\n- $\\mathbf{y}$ 是一个 $N \\times 1$ 的响应变量列向量，其元素为 $y_i = \\ln \\tau_{E,i} + 3 \\ln \\rho_{*,i}$。\n- $\\mathbf{X}$ 是一个 $N \\times 4$ 的设计矩阵，其中第 $i$ 行对应一个数据点，由 $[1, \\ln \\nu_{*,i}, \\ln \\beta_i, \\ln A_i]$ 给出。\n- $\\mathbf{b}$ 是待求解的 $4 \\times 1$ 系数列向量：$\\mathbf{b} = [\\ln C, \\alpha, \\delta, \\gamma]^T$。\n\n$\\mathbf{b}$ 的解是通过使用普通最小二乘法（OLS）求解这个线性方程组得到的。OLS 解最小化了观测值 $\\mathbf{y}$ 与预测值 $\\mathbf{X}\\mathbf{b}$ 之间残差的平方和。这通常通过使用稳健的数值方法（如 QR 分解或奇异值分解 (SVD)）来实现，这些方法已在标准科学库中实现。\n\n针对三个指定的数据集（$\\mathsf{A}$、$\\mathsf{B}$、$\\mathsf{C}$）的总体算法如下：\n1.  **数据生成**：通过对提供的 $\\rho_*$、$\\nu_*$、$\\beta$ 和 $A \\in \\{1, 2\\}$ 列表取笛卡尔积，创建一个全因子数据集。\n2.  **模型计算**：对于参数的每种组合 $(\\rho_*, \\nu_*, \\beta, A)$，使用该数据集的特定常数（$C, \\alpha, \\delta, \\gamma$）通过幂律模型计算“测量”的能量约束时间 $\\tau_E$。由于没有添加随机噪声，数据将完美地符合模型。\n3.  **矩阵构建**：按照上述定义构建响应向量 $\\mathbf{y}$ 和设计矩阵 $\\mathbf{X}$。$\\mathbf{y}$ 的每个元素是 $y_i = \\ln \\tau_{E,i} + 3 \\ln \\rho_{*,i}$，$\\mathbf{X}$ 的每一行是 $[1, \\ln \\nu_{*,i}, \\ln \\beta_i, \\ln A_i]$。\n4.  **最小二乘求解**：使用标准的线性最小二乘求解器求解线性系统 $\\mathbf{y} = \\mathbf{X}\\mathbf{b}$ 以得到系数向量 $\\mathbf{b}$。\n5.  **参数提取**：估计的同位素标度指数 $\\hat{\\gamma}$ 是解向量 $\\mathbf{b}$ 的第四个元素。\n\n对于数据集 $\\mathsf{A}$ 和 $\\mathsf{B}$，预测变量不是共线的，设计矩阵 $\\mathbf{X}$ 将具有满列秩。OLS 回归将完美地恢复用于生成数据的真实指数，对于数据集 $\\mathsf{A}$ 得出 $\\gamma = 0.2$，对于数据集 $\\mathsf{B}$ 得出 $\\gamma = 0.0$。\n\n数据集 $\\mathsf{C}$ 呈现了一个完全共线性的特殊情况。参数被指定为 $\\beta = 0.2 \\nu_*$。这意味着 $\\ln \\beta = \\ln(0.2) + \\ln \\nu_*$。因此，设计矩阵的第三列 $\\ln \\beta$ 是第一列（常数项）和第二列（$\\ln \\nu_*$）的线性组合。矩阵 $\\mathbf{X}$ 是秩亏的，因此无法唯一确定单个系数 $\\ln C$、$\\alpha$ 和 $\\delta$。然而，第四列 $\\ln A$ 与其他列线性无关，因为 $A$ 是独立变化的。因此，它的系数 $\\gamma$ 仍然可以通过回归被唯一且准确地确定。对于数据集 $\\mathsf{C}$，拟合将正确返回 $\\gamma = -0.1$。\n\n最终的实现将对三个数据集中的每一个执行此过程，并报告恢复的 $\\gamma$ 值。",
            "answer": "```python\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Synthesizes three datasets based on a gyro-Bohm-like scaling law for energy\n    confinement time, and then uses log-linear regression to recover the\n    isotope scaling exponent for each dataset.\n    \"\"\"\n\n    def run_regression(C_true, alpha_true, delta_true, gamma_true,\n                       rho_star_list, nu_star_list, beta_list, A_list):\n        \"\"\"\n        Generates synthetic data and performs linear regression to find gamma.\n\n        Args:\n            C_true (float): The true proportionality constant.\n            alpha_true (float): The true exponent for nu_*.\n            delta_true (float): The true exponent for beta.\n            gamma_true (float): The true exponent for A (isotope mass).\n            rho_star_list (list): List of rho_* values.\n            nu_star_list (list): List of nu_* values.\n            beta_list (list): List of beta values.\n            A_list (list): List of A values (isotope mass numbers).\n\n        Returns:\n            float: The fitted isotope exponent gamma_fit.\n        \"\"\"\n        # 1. Generate all combinations of parameters\n        param_combinations = itertools.product(rho_star_list, nu_star_list, beta_list, A_list)\n\n        y_vec_list = []\n        X_matrix_rows = []\n\n        # 2  3. Compute tau_E and form y and design matrix rows\n        for rho_star, nu_star, beta, A_val in param_combinations:\n            # Compute tau_E from the power-law model\n            tau_E = C_true * (rho_star**(-3)) * (nu_star**alpha_true) * \\\n                    (beta**delta_true) * (A_val**gamma_true)\n\n            # Define the response variable y = ln(tau_E) + 3*ln(rho_*)\n            y_val = np.log(tau_E) + 3 * np.log(rho_star)\n            y_vec_list.append(y_val)\n\n            # Define the design matrix row [1, ln(nu_*), ln(beta), ln(A)]\n            X_row = [1.0, np.log(nu_star), np.log(beta), np.log(A_val)]\n            X_matrix_rows.append(X_row)\n\n        y_vec = np.array(y_vec_list)\n        X_matrix = np.array(X_matrix_rows)\n\n        # 4. Solve the least squares problem y = Xb for b\n        # The solver returns b, residuals, rank, and singular values.\n        # b corresponds to [ln(C), alpha, delta, gamma]\n        b, _, _, _ = np.linalg.lstsq(X_matrix, y_vec, rcond=None)\n\n        # 5. Extract the fitted isotope exponent gamma\n        gamma_fit = b[3]\n\n        return gamma_fit\n\n    test_cases = [\n        # Dataset A: General case\n        {\n            \"C\": 1.0e-8, \"alpha\": 0.5, \"delta\": -0.3, \"gamma_true\": 0.2,\n            \"rho_star_list\": [3.0e-3, 4.0e-3, 5.0e-3, 6.0e-3],\n            \"nu_star_list\": [0.05, 0.10, 0.20],\n            \"beta_list\": [0.010, 0.020, 0.030],\n            \"A_list\": [1, 2]\n        },\n        # Dataset B: No isotope dependence\n        {\n            \"C\": 8.0e-9, \"alpha\": 0.5, \"delta\": -0.3, \"gamma_true\": 0.0,\n            \"rho_star_list\": [3.0e-3, 4.0e-3, 5.0e-3, 6.0e-3],\n            \"nu_star_list\": [0.05, 0.10, 0.20],\n            \"beta_list\": [0.010, 0.020, 0.030],\n            \"A_list\": [1, 2]\n        },\n        # Dataset C: Collinearity case\n        {\n            \"C\": 1.2e-8, \"alpha\": 0.6, \"delta\": -0.6, \"gamma_true\": -0.1,\n            \"rho_star_list\": [4.0e-3, 5.0e-3, 6.0e-3],\n            \"nu_star_list\": [0.06, 0.12, 0.18, 0.24],\n            \"beta_list\": [0.012, 0.024, 0.036, 0.048],\n            \"A_list\": [1, 2]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma_hat = run_regression(\n            C_true=case[\"C\"],\n            alpha_true=case[\"alpha\"],\n            delta_true=case[\"delta\"],\n            gamma_true=case[\"gamma_true\"],\n            rho_star_list=case[\"rho_star_list\"],\n            nu_star_list=case[\"nu_star_list\"],\n            beta_list=case[\"beta_list\"],\n            A_list=case[\"A_list\"]\n        )\n        results.append(gamma_hat)\n\n    # Format the output as a comma-separated list of floats with one decimal place.\n    # It is good practice to handle potential floating-point dust near zero.\n    formatted_results = []\n    for r in results:\n        if np.isclose(r, 0.0):\n            formatted_results.append(f\"{0.0:.1f}\")\n        else:\n            formatted_results.append(f\"{r:.1f}\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}