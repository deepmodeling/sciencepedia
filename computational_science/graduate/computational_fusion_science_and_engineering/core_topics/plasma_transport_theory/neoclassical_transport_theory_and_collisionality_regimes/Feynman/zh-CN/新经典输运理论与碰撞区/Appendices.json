{
    "hands_on_practices": [
        {
            "introduction": "在托卡马克这样复杂的环形几何中，许多物理量（如磁场强度）在单一磁面上并非恒定。为了描述宏观输运特性，我们必须采用一种能恰当反映磁面几何的平均方法，即磁面平均。本练习 () 将指导您掌握这项基本数学技能，通过在大环径比近似下计算基本的几何因子，为后续推导新经典输运理论中的公式（例如 Pfirsch-Schlüter 粒子流）打下坚实基础。",
            "id": "4019211",
            "problem": "考虑一个具有圆形同心磁通面的大环径比轴对称托卡马克，其小半径为 $r$，大半径为 $R_{0}$。定义逆环径比为 $\\varepsilon \\equiv r/R_{0}$，且 $\\varepsilon \\ll 1$。设极向角为 $\\theta$，环向角为 $\\phi$。在此极限下，磁通面上的大半径可取为 $R(\\theta) = R_{0} \\left(1 + \\varepsilon \\cos\\theta\\right)$，磁场大小主要由环向场决定，其大小与 $1/R(\\theta)$ 成正比，即 $B(\\theta) \\propto 1/R(\\theta)$。为明确起见，取 $B(\\theta) = B_{0} \\, R_{0}/R(\\theta) = B_{0}/\\left(1 + \\varepsilon \\cos\\theta\\right)$，其中 $B_{0}$ 是一个常数。\n\n标量场 $f(\\theta,\\phi)$ 的磁通面平均定义为\n$$\n\\langle f \\rangle \\equiv \\frac{\\displaystyle \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\frac{dS}{|\\nabla \\psi|} \\, f(\\theta,\\phi)}{\\displaystyle \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\frac{dS}{|\\nabla \\psi|}},\n$$\n其中 $\\psi$ 是一个磁通标签，$dS$ 是面元。对于大环径比圆形托卡马克，$dS/|\\nabla\\psi|$ 与 $R(\\theta)$ 成正比，因此磁通面平均简化为以 $R(\\theta)$ 为权重的归一化 $\\theta$ 平均：\n$$\n\\langle f \\rangle = \\frac{\\displaystyle \\int_{0}^{2\\pi} d\\theta \\, R(\\theta) \\, f(\\theta)}{\\displaystyle \\int_{0}^{2\\pi} d\\theta \\, R(\\theta)}.\n$$\n\n任务：\n1) 使用此大环径比雅可比，计算磁通面平均 $\\langle \\cos\\theta \\rangle$ 和 $\\langle \\cos^{2}\\theta \\rangle$。\n\n2) 在碰撞的 Pfirsch–Schlüter (PS) 区中，几何因子如 $\\langle B^{-2} \\cos\\theta \\rangle$ 和 $\\langle B^{-2} \\rangle$ 出现在PS平行流和电流的极向变化部分的公式中。定义无量纲几何因子\n$$\nG_{\\mathrm{PS}}(\\varepsilon) \\equiv \\frac{\\langle B^{-2} \\cos\\theta \\rangle}{\\langle B^{-2} \\rangle},\n$$\n其中磁通面平均使用相同的大环径比雅可比进行计算。使用你在第一部分得到的结果，并结合 $B(\\theta) = B_{0}/\\left(1 + \\varepsilon \\cos\\theta\\right)$，以 $\\varepsilon$ 的函数的闭合形式计算 $G_{\\mathrm{PS}}(\\varepsilon)$。\n\n你的最终答案必须是 $G_{\\mathrm{PS}}(\\varepsilon)$ 的单一解析表达式。不要在最终结果中包含任何单位。",
            "solution": "该问题提法明确，具有科学依据，并包含获得唯一解所需的所有信息。我们可以开始计算。\n\n首先，我们简化问题描述中提供的磁通面平均 $\\langle f \\rangle$ 的表达式。该平均值的分母是\n$$\n\\int_{0}^{2\\pi} d\\theta \\, R(\\theta) = \\int_{0}^{2\\pi} d\\theta \\, R_{0} (1 + \\varepsilon \\cos\\theta) = R_{0} \\left[ \\int_{0}^{2\\pi} d\\theta + \\varepsilon \\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta \\right]\n$$\n$\\cos\\theta$ 在一个周期内的积分为零，所以\n$$\n\\int_{0}^{2\\pi} d\\theta \\, R(\\theta) = R_{0} \\left( [\\theta]_{0}^{2\\pi} + \\varepsilon[\\sin\\theta]_{0}^{2\\pi} \\right) = R_{0} (2\\pi + 0) = 2\\pi R_{0}\n$$\n因此，磁通面平均简化为\n$$\n\\langle f \\rangle = \\frac{\\displaystyle \\int_{0}^{2\\pi} d\\theta \\, R_{0} (1 + \\varepsilon \\cos\\theta) \\, f(\\theta)}{2\\pi R_{0}} = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} d\\theta \\, (1 + \\varepsilon \\cos\\theta) \\, f(\\theta)\n$$\n\n现在我们处理第一个任务：计算 $\\langle \\cos\\theta \\rangle$ 和 $\\langle \\cos^{2}\\theta \\rangle$。\n\n对于 $\\langle \\cos\\theta \\rangle$，我们令 $f(\\theta) = \\cos\\theta$：\n$$\n\\langle \\cos\\theta \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} d\\theta \\, (1 + \\varepsilon \\cos\\theta) \\cos\\theta = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} (\\cos\\theta + \\varepsilon \\cos^{2}\\theta) \\, d\\theta\n$$\n我们使用标准定积分：$\\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta = 0$ 和 $\\int_{0}^{2\\pi} \\cos^{2}\\theta \\, d\\theta = \\pi$。\n$$\n\\langle \\cos\\theta \\rangle = \\frac{1}{2\\pi} (0 + \\varepsilon \\pi) = \\frac{\\varepsilon}{2}\n$$\n\n对于 $\\langle \\cos^{2}\\theta \\rangle$，我们令 $f(\\theta) = \\cos^{2}\\theta$：\n$$\n\\langle \\cos^{2}\\theta \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} d\\theta \\, (1 + \\varepsilon \\cos\\theta) \\cos^{2}\\theta = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} (\\cos^{2}\\theta + \\varepsilon \\cos^{3}\\theta) \\, d\\theta\n$$\n我们使用积分 $\\int_{0}^{2\\pi} \\cos^{2}\\theta \\, d\\theta = \\pi$ 和 $\\int_{0}^{2\\pi} \\cos^{3}\\theta \\, d\\theta = 0$（因为余弦的奇次幂在一个完整周期内的积分为零）。\n$$\n\\langle \\cos^{2}\\theta \\rangle = \\frac{1}{2\\pi} (\\pi + \\varepsilon \\cdot 0) = \\frac{1}{2}\n$$\n\n对于第二个任务，我们必须计算 $G_{\\mathrm{PS}}(\\varepsilon) = \\frac{\\langle B^{-2} \\cos\\theta \\rangle}{\\langle B^{-2} \\rangle}$。我们分别计算分子和分母。磁场由 $B(\\theta) = B_{0} / (1 + \\varepsilon \\cos\\theta)$ 给出，这意味着 $B^{-2}(\\theta) = B_{0}^{-2} (1 + \\varepsilon \\cos\\theta)^{2}$。\n\n首先，我们计算分母 $\\langle B^{-2} \\rangle$。需要求平均的函数是 $f(\\theta) = B^{-2}(\\theta)$。\n$$\n\\langle B^{-2} \\rangle = \\langle B_{0}^{-2} (1 + \\varepsilon \\cos\\theta)^{2} \\rangle = B_{0}^{-2} \\langle 1 + 2\\varepsilon \\cos\\theta + \\varepsilon^{2} \\cos^{2}\\theta \\rangle\n$$\n利用平均算符的线性和第一部分的结果：\n$$\n\\langle B^{-2} \\rangle = B_{0}^{-2} \\left[ \\langle 1 \\rangle + 2\\varepsilon \\langle \\cos\\theta \\rangle + \\varepsilon^{2} \\langle \\cos^{2}\\theta \\rangle \\right]\n$$\n常数的平均值是其本身，所以 $\\langle 1 \\rangle = 1$。代入先前计算的平均值：\n$$\n\\langle B^{-2} \\rangle = B_{0}^{-2} \\left[ 1 + 2\\varepsilon \\left(\\frac{\\varepsilon}{2}\\right) + \\varepsilon^{2} \\left(\\frac{1}{2}\\right) \\right] = B_{0}^{-2} \\left( 1 + \\varepsilon^{2} + \\frac{1}{2}\\varepsilon^{2} \\right) = B_{0}^{-2} \\left( 1 + \\frac{3}{2}\\varepsilon^{2} \\right)\n$$\n\n接下来，我们计算分子 $\\langle B^{-2} \\cos\\theta \\rangle$。需要求平均的函数是 $f(\\theta) = B^{-2}(\\theta)\\cos\\theta$。\n$$\n\\langle B^{-2} \\cos\\theta \\rangle = \\langle B_{0}^{-2} (1 + \\varepsilon \\cos\\theta)^{2} \\cos\\theta \\rangle = B_{0}^{-2} \\langle (1 + 2\\varepsilon\\cos\\theta + \\varepsilon^{2}\\cos^{2}\\theta)\\cos\\theta \\rangle\n$$\n$$\n= B_{0}^{-2} \\langle \\cos\\theta + 2\\varepsilon\\cos^{2}\\theta + \\varepsilon^{2}\\cos^{3}\\theta \\rangle = B_{0}^{-2} \\left[ \\langle \\cos\\theta \\rangle + 2\\varepsilon \\langle \\cos^{2}\\theta \\rangle + \\varepsilon^{2} \\langle \\cos^{3}\\theta \\rangle \\right]\n$$\n我们需要计算 $\\langle \\cos^{3}\\theta \\rangle$：\n$$\n\\langle \\cos^{3}\\theta \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} (1 + \\varepsilon \\cos\\theta) \\cos^{3}\\theta \\, d\\theta = \\frac{1}{2\\pi} \\left( \\int_{0}^{2\\pi} \\cos^{3}\\theta \\, d\\theta + \\varepsilon \\int_{0}^{2\\pi} \\cos^{4}\\theta \\, d\\theta \\right)\n$$\n$\\cos^3\\theta$ 的积分为 $0$。$\\cos^4\\theta$ 的积分为 $\\int_{0}^{2\\pi} \\cos^{4}\\theta \\, d\\theta = \\frac{3\\pi}{4}$。\n$$\n\\langle \\cos^{3}\\theta \\rangle = \\frac{1}{2\\pi} \\left( 0 + \\varepsilon \\frac{3\\pi}{4} \\right) = \\frac{3\\varepsilon}{8}\n$$\n现在，将平均值代入分子的表达式中：\n$$\n\\langle B^{-2} \\cos\\theta \\rangle = B_{0}^{-2} \\left[ \\frac{\\varepsilon}{2} + 2\\varepsilon\\left(\\frac{1}{2}\\right) + \\varepsilon^{2}\\left(\\frac{3\\varepsilon}{8}\\right) \\right] = B_{0}^{-2} \\left( \\frac{\\varepsilon}{2} + \\varepsilon + \\frac{3}{8}\\varepsilon^{3} \\right) = B_{0}^{-2} \\left( \\frac{3}{2}\\varepsilon + \\frac{3}{8}\\varepsilon^{3} \\right)\n$$\n\n最后，我们计算比值 $G_{\\mathrm{PS}}(\\varepsilon)$：\n$$\nG_{\\mathrm{PS}}(\\varepsilon) = \\frac{\\langle B^{-2} \\cos\\theta \\rangle}{\\langle B^{-2} \\rangle} = \\frac{B_{0}^{-2} \\left( \\frac{3}{2}\\varepsilon + \\frac{3}{8}\\varepsilon^{3} \\right)}{B_{0}^{-2} \\left( 1 + \\frac{3}{2}\\varepsilon^{2} \\right)} = \\frac{\\frac{3}{2}\\varepsilon + \\frac{3}{8}\\varepsilon^{3}}{1 + \\frac{3}{2}\\varepsilon^{2}}\n$$\n为简化表达式，我们可以将分子和分母同乘以 $8$：\n$$\nG_{\\mathrm{PS}}(\\varepsilon) = \\frac{8 \\left( \\frac{3}{2}\\varepsilon + \\frac{3}{8}\\varepsilon^{3} \\right)}{8 \\left( 1 + \\frac{3}{2}\\varepsilon^{2} \\right)} = \\frac{12\\varepsilon + 3\\varepsilon^{3}}{8 + 12\\varepsilon^{2}}\n$$\n提取公因式，得到最终的闭合形式表达式：\n$$\nG_{\\mathrm{PS}}(\\varepsilon) = \\frac{3\\varepsilon(4 + \\varepsilon^{2})}{4(2 + 3\\varepsilon^{2})}\n$$",
            "answer": "$$\n\\boxed{\\frac{3\\varepsilon(4 + \\varepsilon^{2})}{4(2 + 3\\varepsilon^{2})}}\n$$"
        },
        {
            "introduction": "理解了如何在单个磁面上进行平均之后，我们进一步探讨磁场结构如何从一个磁面过渡到相邻磁面。这种径向变化对粒子约束至关重要，而磁剪切（$s$）正是量化这种磁场线扭曲度径向变化的关键无量纲参数。本练习 () 不仅要求您推导磁剪切的表达式，更重要的是阐明它如何深刻影响捕获粒子轨道和香蕉区的新经典输运。通过这个实践，您将把磁场的抽象几何特性与粒子轨道的具体行为联系起来，这是理解低碰撞频率下输运机制的核心。",
            "id": "4019244",
            "problem": "考虑一个大环径比、圆形截面、轴对称的托卡马克，其大半径为 $R_0$，小半径为 $a$，使用直磁力线磁通坐标 $(\\psi, \\theta, \\phi)$，其中 $\\psi$ 是极向磁通，$\\theta$ 是极向角，$\\phi$ 是环向角。磁力线满足 $d\\phi/d\\theta = ( \\boldsymbol{B} \\cdot \\nabla \\phi ) / ( \\boldsymbol{B} \\cdot \\nabla \\theta )$，安全因子 $q(\\psi)$ 由极向环路平均定义为 $q(\\psi) = (1/2\\pi) \\oint ( \\boldsymbol{B} \\cdot \\nabla \\phi ) / ( \\boldsymbol{B} \\cdot \\nabla \\theta ) \\, d\\theta$。在大环径比极限下，可以认为在给定的磁面上 $R \\approx R_0$，并使用 $r$ 作为标记磁面的类小半径坐标。\n\n一个托卡马克平衡具有给定的安全因子剖面 $q(r)$，$q(r)$ 随 $r$ 单调递增且可微。取\n$$\nq(r) = q_0 + \\alpha \\left( \\frac{r}{a} \\right)^{2} + \\beta \\left( \\frac{r}{a} \\right)^{4},\n$$\n其中 $q_0 > 0$, $\\alpha > 0$ 和 $\\beta \\ge 0$ 是常数。仅使用给定的定义和标准大环径比几何，完成以下任务：\n\n1. 从磁力线关系式和安全因子作为磁面量的定义出发，推导一个描述磁力线扭曲径向变化的无量纲度量。然后，对给定的 $q(r)$ 计算该度量的值。\n\n2. 在导心运动的漂移动理学描述框架下，解释在存在小反环径比 $\\epsilon \\equiv r/R_0 \\ll 1$ 的情况下，磁力线扭曲的有限径向变化如何影响捕获粒子轨道的弹跳平均环向进动，并改变低碰撞（香蕉）区的新经典输运。您的解释应从导心漂移和弹跳平均的基本表达式出发，并清晰地阐述第1部分中推导出的度量如何影响进动和输运标度律。\n\n你的最终计算输出必须是针对给定 $q(r)$ 计算出的无量纲度量的单个闭式解析表达式。不需要进行数值计算。",
            "solution": "用户提供了一个托卡马克等离子体物理领域的问题，经过我的验证，该问题在科学上是合理的、适定的且内部一致。这是一个关于托卡马克磁几何及其对新经典输运影响的标准但高级的问题。我现在将开始进行形式化的解答。\n\n该问题分为两部分。第一部分要求推导磁力线扭曲径向变化的无量纲度量，并针对给定的安全因子剖面进行计算。第二部分要求物理解释该度量如何影响捕获粒子的进动和新经典输运。\n\n### 第1部分：磁力线扭曲变化的无量纲度量\n\n在托卡马克中，给定磁面上磁力线的结构由安全因子 $q$ 来表征。题目指出 $q(\\psi)$ 定义为局部磁力线螺距的极向环路平均，即 $q(\\psi) = \\frac{1}{2\\pi} \\oint \\frac{\\boldsymbol{B} \\cdot \\nabla \\phi}{\\boldsymbol{B} \\cdot \\nabla \\theta} d\\theta$。在大环径比近似下，极向磁通 $\\psi$ 是小半径坐标 $r$ 的函数，因此我们可以将安全因子视为函数 $q(r)$。安全因子 $q(r)$ 表示在由 $r$ 标记的磁面上，磁力线每绕极向一圈所绕的环向圈数。因此，$q(r)$ 是该磁面上磁力线扭曲的直接度量。\n\n“磁力线扭曲的径向变化”指的是当我们从一个磁面移动到相邻磁面时（即改变小半径 $r$ 时），这种扭曲如何变化。这种变化由安全因子的径向导数 $\\frac{dq}{dr}$ 来量化。\n\n然而，导数不是无量纲的。为了构造一个无量纲的度量，我们必须使用系统的特征量来归一化 $\\frac{dq}{dr}$。径向变化的自然局域长度标度是小半径 $r$ 本身。安全因子的自然标度是其局域值 $q(r)$。结合这些，我们构成了被称为**磁剪切**的无量纲量，通常用 $s$ 表示：\n$$\ns(r) \\equiv \\frac{r}{q(r)} \\frac{dq}{dr}\n$$\n这个量也可以写成 $s(r) = \\frac{d(\\ln q)}{d(\\ln r)}$，表示安全因子关于小半径的对数导数。它提供了一个归一化的、局域的度量，描述了磁力线螺距随半径的变化情况。这就是要求我们推导的无量纲度量。\n\n接下来，我们为给定的安全因子剖面计算这个度量：\n$$\nq(r) = q_0 + \\alpha \\left( \\frac{r}{a} \\right)^{2} + \\beta \\left( \\frac{r}{a} \\right)^{4}\n$$\n其中 $q_0$、$\\alpha$ 和 $\\beta$ 是常数，而 $a$ 是托卡马克的小半径。\n\n首先，我们计算 $q(r)$ 对 $r$ 的导数：\n$$\n\\frac{dq}{dr} = \\frac{d}{dr} \\left[ q_0 + \\frac{\\alpha r^2}{a^2} + \\frac{\\beta r^4}{a^4} \\right]\n$$\n应用幂函数求导法则，我们得到：\n$$\n\\frac{dq}{dr} = \\frac{\\alpha}{a^2} (2r) + \\frac{\\beta}{a^4} (4r^3) = \\frac{2\\alpha r}{a^2} + \\frac{4\\beta r^3}{a^4}\n$$\n现在，我们将这个导数和给定的 $q(r)$ 表达式代入磁剪切 $s(r)$ 的定义中：\n$$\ns(r) = \\frac{r}{q_0 + \\alpha \\left( \\frac{r}{a} \\right)^{2} + \\beta \\left( \\frac{r}{a} \\right)^{4}} \\left( \\frac{2\\alpha r}{a^2} + \\frac{4\\beta r^3}{a^4} \\right)\n$$\n如果需要，我们可以通过提取公因子来简化括号中的项，但为清晰起见，我们可以将前导因子 $r$ 乘进去：\n$$\ns(r) = \\frac{\\frac{2\\alpha r^2}{a^2} + \\frac{4\\beta r^4}{a^4}}{q_0 + \\alpha \\left( \\frac{r}{a} \\right)^{2} + \\beta \\left( \\frac{r}{a} \\right)^{4}}\n$$\n这就是给定 $q$ 剖面下磁剪切参数 $s(r)$ 的最终闭式表达式。\n\n### 第2部分：与进动和新经典输运的物理联系\n\n磁剪切 $s$ 在改变捕获粒子的动力学，并从而改变低碰撞（香蕉）区中的新经典输运方面，扮演着关键角色。通过遵循从粒子漂移到输运通量的逻辑链，可以理解这种联系。\n\n1.  **导心漂移与捕获粒子轨道：** 在托卡马克中，磁场强度是不均匀的，近似地变化为 $B \\approx B_0(1 - \\epsilon \\cos\\theta)$，其中 $\\epsilon = r/R_0$ 是反环径比。$B$ 的这种空间梯度以及磁力线的曲率，导致导心跨越磁力线漂移。主要的漂移是梯度B漂移和曲率漂移，它们主要在垂直方向上。平行速度 $v_\\parallel$ 较低的粒子无法克服强磁场区的磁镜力，而在环体的弱磁场侧被“捕获”。它们快速的回旋运动、较慢的沿磁力线运动以及缓慢的垂直漂移相结合，使其导心在极向截面上描绘出特征性的“香蕉”形状。\n\n2.  **有限轨道宽度与磁剪切：** 这些香蕉轨道的一个关键特征是其有限的径向宽度 $\\Delta r$。该宽度的一个标准估计是 $\\Delta r \\sim \\frac{v_\\parallel}{\\Omega_p} \\sim \\frac{q \\rho}{\\sqrt{\\epsilon}}$，其中 $\\Omega_p$ 是极向回旋频率，$\\rho$ 是拉莫尔半径。这意味着一个捕获粒子并非停留在单个磁面上，而是采样一个宽度为 $\\Delta r$ 的径向区域。安全因子 $q$ 是一个磁面量，$q=q(r)$。当粒子沿其香蕉轨道运动时，它在具有不同 $q$ 值的磁面之间移动。磁剪切 $s = \\frac{r}{q}\\frac{dq}{dr}$ 正是量化 $q$ 在此径向漂移范围内变化程度的参数。非零的剪切意味着香蕉轨道的内侧和外侧分支上的磁力线螺距是不同的。\n\n3.  **环向进动的修正：** 捕获粒子的香蕉轨道不是静止的；它们会环向进动。这种进动 $\\Omega_\\phi = \\langle \\dot{\\phi} \\rangle$ 是环向角的弹跳平均变化率。它主要由形成香蕉轨道的相同垂直漂移驱动。然而，粒子所经历的径向变化的磁力线螺距（由于非零剪切）为该进动提供了额外的贡献。粒子实际上对其所采样的磁面上的不同螺线路径进行了平均。这种轨道平均效应与磁剪切 $s$ 直接成正比，它修正了总的环向进动频率。对于具有正剪切（$s>0$）的典型托卡马克剖面，该效应会叠加在由 $\\nabla B$ 和曲率漂移引起的进动上，从而增加了总进动速率。\n\n4.  **对新经典输运的影响：** 香蕉区中的新经典输运源于粒子轨道和碰撞的相互作用。碰撞导致粒子在速度空间中散射，这可能将它们从一个香蕉轨道撞到另一个，从而产生一个净的径向步长。扩散系数的经典估计为 $D \\sim f_t (\\Delta r)^2 \\nu_{eff}$，其中 $f_t$ 是捕获粒子份额，$\\nu_{eff}$ 是有效碰撞频率。这给出了特征性的香蕉区标度律 $D \\propto \\epsilon^{-3/2}$。\n\n磁剪切通过修正碰撞所作用的底层轨道结构而介入。新经典输运系数（例如，扩散系数和热导率）的精确值是通过求解弹跳平均的漂移动理学方程来确定的。在这个方程中，出现了环向进动频率 $\\Omega_\\phi$（其中包含依赖于剪切的项）。进动有助于将香蕉轨道的径向位置在环向方向上平均掉。由剪切引起的 $\\Omega_\\phi$ 的变化会改变粒子极向运动和环向运动之间的相位关系，这反过来又改变了携带输运通量的微扰分布函数 $f_1$ 的结构。因此，尽管磁剪切通常不改变新经典输运的基本参数标度关系（例如，对 $\\epsilon$ 的依赖性），但它会定量地修正输运矩阵中的数值系数，从而改变粒子和能量通量的大小。这在精确建模和预测托卡马克中的输运时是一个至关重要的效应。",
            "answer": "$$ \\boxed{ \\frac{\\frac{2\\alpha r^2}{a^2} + \\frac{4\\beta r^4}{a^4}}{q_0 + \\alpha \\left( \\frac{r}{a} \\right)^{2} + \\beta \\left( \\frac{r}{a} \\right)^{4}} } $$"
        },
        {
            "introduction": "在掌握了核心的理论工具后，最后的这项实践将理论与实验观测联系起来。径向电场（$E_r$）是决定等离子体输运和约束的中心物理量。本计算练习 () 要求您运用两种不同的物理原理——径向粒子流的双极性约束和离子径向力平衡——来推断 $E_r$。您将应用随不同碰撞区（香蕉区、平台区、Pfirsch-Schlüter 区）变化的输运系数模型，从而获得处理和解释“测量”数据的宝贵经验，这是计算聚变科学家的必备技能。",
            "id": "4019216",
            "problem": "在磁约束等离子体中，给定您在几个半径位置上测得的离子和电子的径向粒子通量偏移量以及局部等离子体参数。目标是推斷出满足双极性条件的径向电场 $E_r$，并将其与使用测量的流和压力梯度从离子径向力平衡中获得的 $E_r$ 进行比较。问题背景是跨越不同碰撞机制的新经典输运理论，且必须以纯计算方式解决。\n\n使用的基本基础和建模假设：\n- 从漂移动力学描述开始，假设径向粒子通量对径向电场有线性响应。对于每种粒子 $s \\in \\{i,e\\}$，将径向粒子通量建模为 $ \\Gamma_s(E_r) = \\Gamma_s^0 + s_s \\mu_s n_s E_r $，其中 $ \\Gamma_s^0 $ 是测得的与 $E_r$ 无关的通量偏移量，$ s_s = \\mathrm{sign}(q_s) $ 且 $ s_i = +1 $ 和 $ s_e = -1 $，$ \\mu_s $ 是新经典迁移率系数，$ n_s $ 是粒子密度，$ q_s $ 是粒子电荷。假设准中性条件 $ n_e = Z_i n_i $ 成立，其中 $ Z_i $ 是离子电荷数。\n- 通过要求净径向电流密度为零来施加双极性条件，$ J_r = e( Z_i \\Gamma_i - \\Gamma_e ) = 0 $，其中 $ e $ 是以国际单位制（SI）中的库仑（Coulombs）表示的基本电荷。\n- 使用以下依赖于不同机制的标度关系，根据无量纲碰撞率 $ \\nu_* $ 确定 $ \\mu_s $，这是一种经过充分检验的输运系数新经典近似：\n  - 香蕉区 $ \\nu_* < 10^{-2} $: $ \\mu_s = C_s / \\max(\\nu_*, \\nu_{\\min}) $，其中 $ \\nu_{\\min} $ 是一个小的下限，以避免除以零。\n  - 平台区 $ 10^{-2} \\le \\nu_* \\le 1 $: $ \\mu_s = C_s $。\n  - Pfirsch-Schlüter区 $ \\nu_* > 1 $: $ \\mu_s = C_s \\nu_* $。\n  此处 $ C_s $ 是一个依赖于粒子种类的系数，在国际单位制（SI）中单位为 $ \\mathrm{m^2/(V\\,s)} $。\n- 将双极性 $ E_r $ 与离子径向力平衡 $ E_r $ 进行比较。后者通过忽略惯性项并使用轴对称几何形状获得，这将离子径向动量平衡简化为一种涉及径向压力梯度和来自测量流的跨场漂移贡献的形式。将最终的 $ E_r $ 以伏特/米（$ \\mathrm{V/m} $）表示。计算中不涉及角度。\n\n计算任务：\n- 对于下面列出的每个测试用例，计算：\n  1. 通过在上述线性通量模型和依赖于碰撞率的 $ \\mu_s $ 下求解 $ J_r = e( Z_i \\Gamma_i(E_r) - \\Gamma_e(E_r) ) = 0 $，计算双极性径向电场 $ E_r^{\\mathrm{amb}} $。\n  2. 使用轴对称、无惯性的径向动量平衡，结合测量的离子流、磁场和径向压力梯度 $ \\partial p_i / \\partial r $，计算离子径向力平衡电场 $ E_r^{\\mathrm{fb}} $。使用国际单位制（SI）并将结果以 $ \\mathrm{V/m} $ 表示。\n  3. 绝对差值 $ \\Delta = \\left| E_r^{\\mathrm{amb}} - E_r^{\\mathrm{fb}} \\right| $，单位为 $ \\mathrm{V/m} $。\n- 如果双极性条件不允许唯一解（例如，如果线性解的分母为零而分子不为零），则为 $ E_r^{\\mathrm{amb}} $ 返回“非数值”（Not-a-Number）值。\n\n物理单位：\n- 所有输入均以国际单位制（SI）单位提供，所有输出必须以伏特/米（$ \\mathrm{V/m} $）表示。返回四舍五入到六位小数的浮点数。不要使用任何百分号；任何分数数量必须是小数。\n\n测试套件：\n- 使用以下四种情况。在每种情况下，常数为 $ e = 1.602 \\times 10^{-19} \\, \\mathrm{C} $，碰撞率下限为 $ \\nu_{\\min} = 10^{-6} $。\n\n1. 香蕉区（正常路径）：\n  - $ Z_i = 1 $, $ n_i = 1.0 \\times 10^{19} \\, \\mathrm{m^{-3}} $, $ \\Gamma_i^0 = 2.0 \\times 10^{19} \\, \\mathrm{m^{-2}\\,s^{-1}} $, $ \\Gamma_e^0 = 0.2 \\times 10^{19} \\, \\mathrm{m^{-2}\\,s^{-1}} $,\n  - $ C_i = 1.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ C_e = 2.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ \\nu_* = 5.0 \\times 10^{-3} $,\n  - $ \\partial p_i / \\partial r = -2.0 \\times 10^{4} \\, \\mathrm{Pa/m} $, $ B_\\phi = 2.0 \\, \\mathrm{T} $, $ B_\\theta = 0.2 \\, \\mathrm{T} $, $ V_{\\phi i} = 1.0 \\times 10^{5} \\, \\mathrm{m/s} $, $ V_{\\theta i} = 2.0 \\times 10^{4} \\, \\mathrm{m/s} $。\n\n2. 平台区（边界覆盖）：\n  - $ Z_i = 1 $, $ n_i = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}} $, $ \\Gamma_i^0 = 1.5 \\times 10^{17} \\, \\mathrm{m^{-2}\\,s^{-1}} $, $ \\Gamma_e^0 = 6.0 \\times 10^{16} \\, \\mathrm{m^{-2}\\,s^{-1}} $,\n  - $ C_i = 1.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ C_e = 2.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ \\nu_* = 1.0 \\times 10^{-1} $,\n  - $ \\partial p_i / \\partial r = -5.0 \\times 10^{4} \\, \\mathrm{Pa/m} $, $ B_\\phi = 2.5 \\, \\mathrm{T} $, $ B_\\theta = 0.25 \\, \\mathrm{T} $, $ V_{\\phi i} = 5.0 \\times 10^{4} \\, \\mathrm{m/s} $, $ V_{\\theta i} = 1.0 \\times 10^{4} \\, \\mathrm{m/s} $。\n\n3. Pfirsch-Schlüter区（带符号反转的边缘情况）：\n  - $ Z_i = 1 $, $ n_i = 5.0 \\times 10^{18} \\, \\mathrm{m^{-3}} $, $ \\Gamma_i^0 = 1.2 \\times 10^{17} \\, \\mathrm{m^{-2}\\,s^{-1}} $, $ \\Gamma_e^0 = 3.0 \\times 10^{16} \\, \\mathrm{m^{-2}\\,s^{-1}} $,\n  - $ C_i = 1.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ C_e = 2.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ \\nu_* = 3.0 $,\n  - $ \\partial p_i / \\partial r = -1.0 \\times 10^{4} \\, \\mathrm{Pa/m} $, $ B_\\phi = 1.5 \\, \\mathrm{T} $, $ B_\\theta = 0.15 \\, \\mathrm{T} $, $ V_{\\phi i} = 2.0 \\times 10^{5} \\, \\mathrm{m/s} $, $ V_{\\theta i} = -1.0 \\times 10^{4} \\, \\mathrm{m/s} $。\n\n4. 平台区边界，双极性分子为零（简并性检查）：\n  - $ Z_i = 2 $, $ n_i = 2.0 \\times 10^{19} \\, \\mathrm{m^{-3}} $, $ \\Gamma_i^0 = 3.0 \\times 10^{18} \\, \\mathrm{m^{-2}\\,s^{-1}} $, $ \\Gamma_e^0 = 6.0 \\times 10^{18} \\, \\mathrm{m^{-2}\\,s^{-1}} $,\n  - $ C_i = 0.5 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ C_e = 1.0 \\times 10^{-7} \\, \\mathrm{m^2/(V\\,s)} $, $ \\nu_* = 1.0 \\times 10^{-2} $,\n  - $ \\partial p_i / \\partial r = -1.0 \\times 10^{3} \\, \\mathrm{Pa/m} $, $ B_\\phi = 2.0 \\, \\mathrm{T} $, $ B_\\theta = 0.2 \\, \\mathrm{T} $, $ V_{\\phi i} = 0.0 \\, \\mathrm{m/s} $, $ V_{\\theta i} = 0.0 \\, \\mathrm{m/s} $。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个包含三个浮点数 $[E_r^{\\mathrm{amb}}, E_r^{\\mathrm{fb}}, \\Delta]$ 的子列表，四舍五入到六位小数，外层列表按顺序包含这些子列表。例如：$[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$。",
            "solution": "该问题要求计算和比较磁约束等离子体中的径向电场 $E_r$。该电场从两个不同的物理原理推导得出：双极性输运和离子径向力平衡。解决方案将首先从每个原理中推导出电场的解析表达式，然后将这些公式应用于提供的特定测试用例。所有计算均遵循国际单位制（SI）。\n\n### 1. 双极性径向电场 ($E_r^{\\mathrm{amb}}$)\n\n确定径向电场 $E_r^{\\mathrm{amb}}$ 的第一种方法是施加双极性条件。在稳态等离子体中，净径向电流密度 $J_r$ 必须为零以防止电荷积累。径向电流由离子和电子携带。\n\n总径向电流密度由 $J_r = \\sum_s q_s \\Gamma_s$ 给出，其中 $q_s$ 是电荷，$\\Gamma_s$ 是粒子种类 $s$ 的径向粒子通量。对于离子-电子等离子体，离子电荷为 $q_i = Z_i e$，电子电荷为 $q_e = -e$，这变为：\n$$ J_r = e(Z_i \\Gamma_i - \\Gamma_e) = 0 $$\n这简化为条件 $Z_i \\Gamma_i = \\Gamma_e$。\n\n问题为每种粒子 $s \\in \\{i, e\\}$ 的径向粒子通量提供了关于径向电场 $E_r$ 的线性模型：\n$$ \\Gamma_s(E_r) = \\Gamma_s^0 + s_s \\mu_s n_s E_r $$\n其中 $\\Gamma_s^0$ 是本征（非电驱动）通量，$s_s = \\mathrm{sign}(q_s)$ 使得 $s_i = +1$ 和 $s_e = -1$，$\\mu_s$ 是新经典迁移率系数，$n_s$ 是粒子数密度。\n\n将此通量模型代入双极性条件 $Z_i \\Gamma_i(E_r) = \\Gamma_e(E_r)$：\n$$ Z_i (\\Gamma_i^0 + \\mu_i n_i E_r) = \\Gamma_e^0 - \\mu_e n_e E_r $$\n我们求解电场，记为 $E_r^{\\mathrm{amb}}$：\n$$ Z_i \\Gamma_i^0 + Z_i \\mu_i n_i E_r^{\\mathrm{amb}} = \\Gamma_e^0 - \\mu_e n_e E_r^{\\mathrm{amb}} $$\n$$ (Z_i \\mu_i n_i + \\mu_e n_e) E_r^{\\mathrm{amb}} = \\Gamma_e^0 - Z_i \\Gamma_i^0 $$\n使用准中性条件 $n_e = Z_i n_i$，我们可以简化乘以 $E_r^{\\mathrm{amb}}$ 的项：\n$$ (Z_i \\mu_i n_i + \\mu_e (Z_i n_i)) E_r^{\\mathrm{amb}} = Z_i n_i (\\mu_i + \\mu_e) E_r^{\\mathrm{amb}} = \\Gamma_e^0 - Z_i \\Gamma_i^0 $$\n最终，双极性径向电场的表达式为：\n$$ E_r^{\\mathrm{amb}} = \\frac{\\Gamma_e^0 - Z_i \\Gamma_i^0}{Z_i n_i (\\mu_i + \\mu_e)} $$\n只要分母不为零，$E_r^{\\mathrm{amb}}$ 就存在唯一解。如果分母为零而分子不为零，则该问题是不适定的，不存在解。\n\n迁移率系数 $\\mu_s$ 依赖于无量纲碰撞率 $\\nu_*$，根据指定的新经典机制：\n- 香蕉区 ($\\nu_* < 10^{-2}$): $\\mu_s = C_s / \\max(\\nu_*, \\nu_{\\min})$\n- 平台区 ($10^{-2} \\le \\nu_* \\le 1$): $\\mu_s = C_s$\n- Pfirsch-Schlüter区 ($\\nu_* > 1$): $\\mu_s = C_s \\nu_*$\n其中 $C_s$ 是给定的依赖于粒子种类的系数，而 $\\nu_{\\min} = 10^{-6}$ 是一个正则化参数，用于防止在低碰撞率极限下除以零。\n\n### 2. 离子力平衡径向电场 ($E_r^{\\mathrm{fb}}$)\n\n确定 $E_r$ 的第二种方法基于离子径向力平衡方程。在流体模型中，离子的动量方程为：\n$$ n_i m_i \\left( \\frac{\\partial \\mathbf{V}_i}{\\partial t} + (\\mathbf{V}_i \\cdot \\nabla) \\mathbf{V}_i \\right) = Z_i e n_i (\\mathbf{E} + \\mathbf{V}_i \\times \\mathbf{B}) - \\nabla p_i $$\n其中惯性项在左侧，洛伦兹力和压力梯度力在右侧。问题指定忽略惯性项（即左侧为零），对应于稳态动量平衡。\n$$ 0 = Z_i e n_i (\\mathbf{E} + \\mathbf{V}_i \\times \\mathbf{B}) - \\nabla p_i $$\n我们关心的是该方程的径向分量。在轴对称磁几何（如托卡马克）中，使用半径、极向角和环向角的坐标 $(r, \\theta, \\phi)$，场可以写为 $\\mathbf{E} = E_r \\mathbf{\\hat{r}}$，$\\mathbf{V}_i = V_{\\theta i} \\mathbf{\\hat{\\theta}} + V_{\\phi i} \\mathbf{\\hat{\\phi}}$（在力平衡中忽略径向速度），以及 $\\mathbf{B} = B_\\theta \\mathbf{\\hat{\\theta}} + B_\\phi \\mathbf{\\hat{\\phi}}$。洛伦兹力项的径向分量是：\n$$ (\\mathbf{V}_i \\times \\mathbf{B})_r = V_{\\theta i} B_\\phi - V_{\\phi i} B_\\theta $$\n因此，动量方程的径向分量变为：\n$$ Z_i e n_i (E_r + V_{\\theta i} B_\\phi - V_{\\phi i} B_\\theta) = \\frac{\\partial p_i}{\\partial r} $$\n求解电场，我们记为 $E_r^{\\mathrm{fb}}$：\n$$ E_r^{\\mathrm{fb}} = \\frac{1}{Z_i e n_i} \\frac{\\partial p_i}{\\partial r} - V_{\\theta i} B_\\phi + V_{\\phi i} B_\\theta $$\n该方程表明，径向电场平衡了离子抗磁漂移（压力梯度项）和由离子流体跨磁力线流动产生的洛伦兹力。右侧的所有量均在测试用例中提供。\n\n### 3. 计算步骤\n\n对于每个测试用例，执行以下步骤：\n1.  根据 $\\nu_*$ 的值确定碰撞机制区。\n2.  使用已确定机制区的相应公式计算离子和电子的迁移率 $\\mu_i$ 和 $\\mu_e$。\n3.  使用其推导公式计算 $E_r^{\\mathrm{amb}}$。实现一个检查来处理分母 $Z_i n_i (\\mu_i + \\mu_e)$ 为零的情况，这将导致 $E_r^{\\mathrm{amb}}$ 的值为非数值（NaN）。\n4.  使用其推导公式以及提供的流、磁场和压力梯度数据计算 $E_r^{\\mathrm{fb}}$。基本电荷为 $e = 1.602 \\times 10^{-19} \\, \\mathrm{C}$。\n5.  计算绝对差值 $\\Delta = |E_r^{\\mathrm{amb}} - E_r^{\\mathrm{fb}}|$。\n6.  每个用例的最终结果 $[E_r^{\\mathrm{amb}}, E_r^{\\mathrm{fb}}, \\Delta]$ 四舍五入到六位小数。\n\n此过程应用于所有四个指定的测试用例，涵盖不同的碰撞机制区和特殊条件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ambipolar and force-balance radial electric fields for a set of plasma test cases.\n    \"\"\"\n\n    # Define physical constants and problem parameters\n    E_CHARGE = 1.602e-19  # Elementary charge in Coulombs\n    NU_MIN = 1.0e-6       # Lower bound for collisionality\n\n    # Test cases as provided in the problem statement\n    test_cases = [\n        # 1. Banana regime\n        {\n            \"Zi\": 1, \"ni\": 1.0e19, \"Gamma_i0\": 2.0e19, \"Gamma_e0\": 0.2e19,\n            \"Ci\": 1.0e-7, \"Ce\": 2.0e-7, \"nu_star\": 5.0e-3,\n            \"dpdr_i\": -2.0e4, \"B_phi\": 2.0, \"B_theta\": 0.2, \"V_phi_i\": 1.0e5, \"V_theta_i\": 2.0e4\n        },\n        # 2. Plateau regime\n        {\n            \"Zi\": 1, \"ni\": 5.0e19, \"Gamma_i0\": 1.5e17, \"Gamma_e0\": 6.0e16,\n            \"Ci\": 1.0e-7, \"Ce\": 2.0e-7, \"nu_star\": 1.0e-1,\n            \"dpdr_i\": -5.0e4, \"B_phi\": 2.5, \"B_theta\": 0.25, \"V_phi_i\": 5.0e4, \"V_theta_i\": 1.0e4\n        },\n        # 3. Pfirsch-Schlüter regime\n        {\n            \"Zi\": 1, \"ni\": 5.0e18, \"Gamma_i0\": 1.2e17, \"Gamma_e0\": 3.0e16,\n            \"Ci\": 1.0e-7, \"Ce\": 2.0e-7, \"nu_star\": 3.0,\n            \"dpdr_i\": -1.0e4, \"B_phi\": 1.5, \"B_theta\": 0.15, \"V_phi_i\": 2.0e5, \"V_theta_i\": -1.0e4\n        },\n        # 4. Plateau regime boundary (degenerate case)\n        {\n            \"Zi\": 2, \"ni\": 2.0e19, \"Gamma_i0\": 3.0e18, \"Gamma_e0\": 6.0e18,\n            \"Ci\": 0.5e-7, \"Ce\": 1.0e-7, \"nu_star\": 1.0e-2,\n            \"dpdr_i\": -1.0e3, \"B_phi\": 2.0, \"B_theta\": 0.2, \"V_phi_i\": 0.0, \"V_theta_i\": 0.0\n        }\n    ]\n\n    results = []\n\n    def calculate_mobility(C_s, nu_star):\n        \"\"\"Calculates the mobility coefficient based on collisionality.\"\"\"\n        if nu_star  1.0e-2:\n            # Banana regime\n            return C_s / max(nu_star, NU_MIN)\n        elif 1.0e-2 = nu_star = 1.0:\n            # Plateau regime\n            return C_s\n        else: # nu_star > 1.0\n            # Pfirsch-Schlüter regime\n            return C_s * nu_star\n\n    for case in test_cases:\n        # Extract parameters for clarity\n        Zi, ni = case[\"Zi\"], case[\"ni\"]\n        Gamma_i0, Gamma_e0 = case[\"Gamma_i0\"], case[\"Gamma_e0\"]\n        Ci, Ce = case[\"Ci\"], case[\"Ce\"]\n        nu_star = case[\"nu_star\"]\n        dpdr_i = case[\"dpdr_i\"]\n        B_phi, B_theta = case[\"B_phi\"], case[\"B_theta\"]\n        V_phi_i, V_theta_i = case[\"V_phi_i\"], case[\"V_theta_i\"]\n\n        # --- 1. Compute Ambipolar Radial Electric Field (Er_amb) ---\n        mu_i = calculate_mobility(Ci, nu_star)\n        mu_e = calculate_mobility(Ce, nu_star)\n\n        numerator_amb = Gamma_e0 - Zi * Gamma_i0\n        denominator_amb = Zi * ni * (mu_i + mu_e)\n\n        if denominator_amb == 0:\n            # Handle ill-posed case (denominator is zero)\n            Er_amb = np.nan\n        else:\n            Er_amb = numerator_amb / denominator_amb\n\n        # --- 2. Compute Ion Force Balance Electric Field (Er_fb) ---\n        term_pressure = (1 / (Zi * E_CHARGE * ni)) * dpdr_i\n        term_flow = -V_theta_i * B_phi + V_phi_i * B_theta\n        Er_fb = term_pressure + term_flow\n        \n        # --- 3. Compute Absolute Difference ---\n        if np.isnan(Er_amb):\n            delta = np.nan\n        else:\n            delta = abs(Er_amb - Er_fb)\n\n        # Store rounded results\n        if not np.isnan(Er_amb):\n           results.append([round(Er_amb, 6), round(Er_fb, 6), round(delta, 6)])\n        else:\n           results.append(['nan', round(Er_fb, 6), 'nan']) # Not an expected case, but for correctness\n\n    # Format the final output string as specified\n    # Example format: [[-30000.0, -32484.394507, 2484.394507], [...]]\n    output_str = \"[\" + \",\".join(f\"[{r[0]},{r[1]},{r[2]}]\" for r in results) + \"]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}