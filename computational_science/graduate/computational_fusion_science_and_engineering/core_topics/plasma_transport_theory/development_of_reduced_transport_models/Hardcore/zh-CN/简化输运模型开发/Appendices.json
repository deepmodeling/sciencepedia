{
    "hands_on_practices": [
        {
            "introduction": "简化输运模型通常依赖于简化的物理定律，例如傅里叶热传导定律 $q = -\\kappa \\nabla T$。本练习将演示如何通过将此简单模型与更基本但计算成本高昂的回旋动理学模拟数据进行拟合，来推导关键参数——有效热导率 $\\kappa$。这种实践对于弥合第一性原理物理学与实用预测模型之间的差距至关重要。",
            "id": "3964885",
            "problem": "您的任务是构建并验证一个用于磁化聚变等离子体中热传导的简化输运模型，方法是使用代表固定等离子体贝塔值和归一化回旋半径下回旋动理学计算出的热通量的合成数据，来拟合一个有效热导率。您必须实现一个完整的、可运行的程序，该程序不读取任何外部输入，并使用程序内部提供的合成数据。\n\n基本原理：在简化输运模型中，傅里叶热传导定律假定热通量矢量由 $q = - \\kappa \\nabla T$ 给出，其中 $q$ 是热通量，$\\kappa$ 是标量各向同性热导率，$\\nabla T$ 是温度梯度。在由等离子体贝塔值 $\\beta$ 和归一化回旋半径 $\\rho_\\ast$ 表征的固定平衡中，假设回旋动理学热通量数据 $Q$ 通过一个有效的各向同性 $\\kappa$ 依赖于 $\\nabla T$，并可能包含非扩散分量。给定 $N$ 个样本 $\\{(\\nabla T_i, Q_i)\\}_{i=1}^N$，其中 $Q_i \\in \\mathbb{R}^d$ 且 $\\nabla T_i \\in \\mathbb{R}^d$，您将通过最小二乘法拟合单个标量 $\\kappa$，以最小化测量通量 $Q_i$ 与模型 $- \\kappa \\nabla T_i$ 之间的残差。\n\n数学目标：对于一个固定 $\\beta$ 和 $\\rho_\\ast$ 的数据集，定义最小二乘目标函数\n$$\nJ(\\kappa) = \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2,\n$$\n并找到使 $J(\\kappa)$ 最小化的 $\\kappa$ 值。计算并报告残差范数\n$$\n\\|r\\|_2 = \\left( \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2 \\right)^{1/2}。\n$$\n如果数据未提供关于 $\\kappa$ 的信息（即，如果 $\\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2 = 0$），则设 $\\kappa = 0$，并将残差范数计算为 $\\left( \\sum_{i=1}^{N} \\|Q_i\\|_2^2 \\right)^{1/2}$。\n\n单位：以国际单位制（SI）报告 $\\kappa$，单位为瓦特每米开尔文（$\\mathrm{W/(m \\cdot K)}$），残差范数的单位为瓦特每平方米（$\\mathrm{W/m^2}$）。程序应输出不带单位字符串的数值，但所有计算必须与这些单位保持一致。\n\n测试套件：实现以下四个数据集（每个数据集独立地处于固定的 $\\beta$ 和 $\\rho_\\ast$），均在二维空间 $d = 2$ 中：\n\n- 情况 1（理想情况，完全扩散）：固定 $\\beta = 0.02$ 和 $\\rho_\\ast = 10^{-3}$。使用 $N = 4$ 个样本：\n  - $\\nabla T_1 = (10.0, 0.0)$, $Q_1 = (-50.0, 0.0)$,\n  - $\\nabla T_2 = (0.0, 8.0)$, $Q_2 = (0.0, -40.0)$,\n  - $\\nabla T_3 = (6.0, 6.0)$, $Q_3 = (-30.0, -30.0)$,\n  - $\\nabla T_4 = (-4.0, 5.0)$, $Q_4 = (20.0, -25.0)$。\n  这些数据与精确值 $\\kappa_{\\text{true}} = 5.0$ 且无非扩散分量的情况一致。\n\n- 情况 2（垂直非扩散通量分量）：固定 $\\beta = 0.03$ 和 $\\rho_\\ast = 2 \\times 10^{-3}$。使用 $N = 4$ 个样本：\n  - $\\nabla T_1 = (12.0, 0.0)$, $Q_1 = (-24.0, 1.0)$,\n  - $\\nabla T_2 = (9.0, 0.0)$, $Q_2 = (-18.0, -1.0)$,\n  - $\\nabla T_3 = (6.0, 0.0)$, $Q_3 = (-12.0, 0.5)$,\n  - $\\nabla T_4 = (3.0, 0.0)$, $Q_4 = (-6.0, -0.5)$。\n  这些数据与 $\\kappa_{\\text{true}} = 2.0$ 且添加了垂直于 $\\nabla T$ 的非扩散分量的情况一致。\n\n- 情况 3（无梯度信息，纯非扩散通量）：固定 $\\beta = 0.015$ 和 $\\rho_\\ast = 8 \\times 10^{-4}$。使用 $N = 2$ 个样本：\n  - $\\nabla T_1 = (0.0, 0.0)$, $Q_1 = (1.0, -2.0)$,\n  - $\\nabla T_2 = (0.0, 0.0)$, $Q_2 = (-0.5, 0.5)$。\n\n- 情况 4（混合对齐，一个零梯度样本，少量非扩散分量）：固定 $\\beta = 0.025$ 和 $\\rho_\\ast = 1.5 \\times 10^{-3}$。使用 $N = 5$ 个样本：\n  - $\\nabla T_1 = (5.0, 1.0)$, $Q_1 = (-14.8, -3.1)$,\n  - $\\nabla T_2 = (-4.0, 2.0)$, $Q_2 = (12.0, -6.0)$,\n  - $\\nabla T_3 = (0.0, 0.0)$, $Q_3 = (1.0, -1.0)$,\n  - $\\nabla T_4 = (3.0, -3.0)$, $Q_4 = (-8.5, 9.5)$,\n  - $\\nabla T_5 = (2.0, 4.0)$, $Q_5 = (-6.2, -11.9)$。\n\n算法任务：对于每个数据集，计算使 $J(\\kappa)$ 最小化的最小二乘 $\\kappa$，然后计算残差范数 $\\|r\\|_2$，两者都以实数（浮点数）形式报告。所有数据集都是独立的，必须在程序中按顺序处理。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个数据集的结果表示为一个二元列表 $[\\kappa,\\|r\\|_2]$。因此，对于上述四种情况，输出必须采用以下格式\n$$\n[[\\kappa_1,\\|r_1\\|_2],[\\kappa_2,\\|r_2\\|_2],[\\kappa_3,\\|r_3\\|_2],[\\kappa_4,\\|r_4\\|_2]],\n$$\n不含空格。所有数值必须以上述指定的 SI 单位表示。",
            "solution": "在进行求解之前，首先评估问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- **模型：** 热通量矢量 $q$ 通过傅里叶定律 $q = - \\kappa \\nabla T$ 与温度梯度 $\\nabla T$ 相关，其中 $\\kappa$ 是一个标量各向同性热导率。\n- **数据：** 提供一组 $N$ 个样本 $\\{(\\nabla T_i, Q_i)\\}_{i=1}^N$，其中 $Q_i \\in \\mathbb{R}^d$ 是测量的热通量，$\\nabla T_i \\in \\mathbb{R}^d$ 是温度梯度。空间维度为 $d=2$。\n- **目标：** 找到使最小二乘目标函数 $J(\\kappa) = \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2$ 最小化的标量 $\\kappa$。\n- **待计算量：** 残差范数，定义为 $\\|r\\|_2 = \\left( \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2 \\right)^{1/2}$，其中 $\\kappa$ 是最优值。\n- **特殊条件：** 如果 $\\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2 = 0$，则设 $\\kappa = 0$，残差范数计算为 $\\|r\\|_2 = \\left( \\sum_{i=1}^{N} \\|Q_i\\|_2^2 \\right)^{1/2}$。\n- **单位：** $\\kappa$ 的单位为瓦特每米开尔文（$\\mathrm{W/(m \\cdot K)}$），$\\|r\\|_2$ 的单位为瓦特每平方米（$\\mathrm{W/m^2}$）。\n- **数据集 ($d=2$)：**\n    - **情况 1：** $N = 4$。数据点：$(\\nabla T_1, Q_1) = ((10.0, 0.0), (-50.0, 0.0))$，$(\\nabla T_2, Q_2) = ((0.0, 8.0), (0.0, -40.0))$，$(\\nabla T_3, Q_3) = ((6.0, 6.0), (-30.0, -30.0))$，$(\\nabla T_4, Q_4) = ((-4.0, 5.0), (20.0, -25.0))$。\n    - **情况 2：** $N = 4$。数据点：$(\\nabla T_1, Q_1) = ((12.0, 0.0), (-24.0, 1.0))$，$(\\nabla T_2, Q_2) = ((9.0, 0.0), (-18.0, -1.0))$，$(\\nabla T_3, Q_3) = ((6.0, 0.0), (-12.0, 0.5))$，$(\\nabla T_4, Q_4) = ((3.0, 0.0), (-6.0, -0.5))$。\n    - **情况 3：** $N = 2$。数据点：$(\\nabla T_1, Q_1) = ((0.0, 0.0), (1.0, -2.0))$，$(\\nabla T_2, Q_2) = ((0.0, 0.0), (-0.5, 0.5))$。\n    - **情况 4：** $N = 5$。数据点：$(\\nabla T_1, Q_1) = ((5.0, 1.0), (-14.8, -3.1))$，$(\\nabla T_2, Q_2) = ((-4.0, 2.0), (12.0, -6.0))$，$(\\nabla T_3, Q_3) = ((0.0, 0.0), (1.0, -1.0))$，$(\\nabla T_4, Q_4) = ((3.0, -3.0), (-8.5, 9.5))$，$(\\nabla T_5, Q_5) = ((2.0, 4.0), (-6.2, -11.9))$。\n- **要求的输出格式：** 单行字符串 `[[k1,r1],[k2,r2],[k3,r3],[k4,r4]]`。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定标准对问题进行验证。\n- **有科学依据：** 该问题基于传热学（傅里叶定律）和数值模型降阶的成熟原理，这是计算物理和工程领域的标准实践。使用回旋动理学数据为聚变等离子体拟合简化输运模型的背景具有科学真实性。\n- **良态性：** 任务是求解一个单参数的线性最小二乘问题。目标函数 $J(\\kappa)$ 是关于 $\\kappa$ 的二次函数，具有唯一的全局最小值。该问题明确处理了梯度数据为空的奇异情况，确保了对所有提供的输入都有明确定义的处理流程。\n- **客观性：** 问题使用精确的数学语言陈述，并提供了明确的数值数据。没有主观或基于观点的内容。\n- **完整性与一致性：** 所有必要的数据、公式和边界条件（以特殊情况的形式）都已提供。数据集是自洽的，与陈述的目标不矛盾。\n- **真实性：** 数值虽然是合成的，但在聚变科学领域的归一化模拟背景下是合理的。单位和物理量在物理上是一致的。\n\n### 步骤 3：结论与行动\n该问题在科学上和数学上是合理的、良态的且完整的。因此，它被判定为**有效**。将着手制定解决方案。\n\n### 基于原理的设计与求解\n\n问题的核心是找到标量热导率 $\\kappa$，以最小化观测热通量 $Q_i$ 与模型预测 $- \\kappa \\nabla T_i$ 之间残差的平方和。需要最小化的目标函数是：\n$$\nJ(\\kappa) = \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2\n$$\n为找到最小值，我们必须找到使 $J(\\kappa)$ 对 $\\kappa$ 的导数为零的 $\\kappa$ 值。首先，我们展开 L2 范数的平方项。一个矢量的平方范数是它与自身的点积。\n$$\n\\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2 = (Q_i + \\kappa \\nabla T_i) \\cdot (Q_i + \\kappa \\nabla T_i)\n$$\n利用点积的分配律：\n$$\n(Q_i + \\kappa \\nabla T_i) \\cdot (Q_i + \\kappa \\nabla T_i) = Q_i \\cdot Q_i + 2\\kappa (Q_i \\cdot \\nabla T_i) + \\kappa^2 (\\nabla T_i \\cdot \\nabla T_i)\n$$\n注意到 $v \\cdot v = \\|v\\|_2^2$，这变为：\n$$\n\\left\\| Q_i + \\kappa \\nabla T_i \\right\\|_2^2 = \\|Q_i\\|_2^2 + 2\\kappa (Q_i \\cdot \\nabla T_i) + \\kappa^2 \\|\\nabla T_i\\|_2^2\n$$\n将其代回 $J(\\kappa)$ 的表达式并分配求和：\n$$\nJ(\\kappa) = \\sum_{i=1}^{N} \\left( \\|Q_i\\|_2^2 + 2\\kappa (Q_i \\cdot \\nabla T_i) + \\kappa^2 \\|\\nabla T_i\\|_2^2 \\right) = \\left( \\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2 \\right) \\kappa^2 + 2 \\left( \\sum_{i=1}^{N} Q_i \\cdot \\nabla T_i \\right) \\kappa + \\left( \\sum_{i=1}^{N} \\|Q_i\\|_2^2 \\right)\n$$\n这是一个 $A\\kappa^2 + B\\kappa + C$ 形式的关于 $\\kappa$ 的标准二次函数。为找到最小值，我们计算其对 $\\kappa$ 的导数并令其为零：\n$$\n\\frac{dJ}{d\\kappa} = 2 \\left( \\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2 \\right) \\kappa + 2 \\left( \\sum_{i=1}^{N} Q_i \\cdot \\nabla T_i \\right) = 0\n$$\n求解 $\\kappa$：\n$$\n\\left( \\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2 \\right) \\kappa = - \\sum_{i=1}^{N} Q_i \\cdot \\nabla T_i\n$$\n在分母不为零的情况下，$\\kappa$ 的最优值为：\n$$\n\\kappa_{\\text{opt}} = - \\frac{\\sum_{i=1}^{N} Q_i \\cdot \\nabla T_i}{\\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2}\n$$\n分母 $\\sum_{i=1}^{N} \\|\\nabla T_i\\|_2^2$ 为零，当且仅当所有梯度矢量 $\\nabla T_i$ 都是零矢量。这个条件与问题陈述中定义的特殊情况完全对应。在这种情况下，数据没有提供任何信息来确定扩散输运系数，问题正确地规定了设 $\\kappa = 0$。\n\n一旦确定了最优 $\\kappa$，将该值代回其定义中，计算残差范数 $\\|r\\|_2$：\n$$\n\\|r\\|_2 = \\sqrt{J(\\kappa_{\\text{opt}})} = \\left( \\sum_{i=1}^{N} \\left\\| Q_i + \\kappa_{\\text{opt}} \\nabla T_i \\right\\|_2^2 \\right)^{1/2}\n$$\n如果特殊情况适用（$\\kappa=0$），则简化为：\n$$\n\\|r\\|_2 = \\left( \\sum_{i=1}^{N} \\|Q_i\\|_2^2 \\right)^{1/2}\n$$\n每种情况的算法如下：\n1. 初始化分子和 $S_{\\text{num}} = 0$ 与分母和 $S_{\\text{den}} = 0$。\n2. 对于每个样本 $(\\nabla T_i, Q_i)$：\n   a. 计算点积 $d_i = Q_i \\cdot \\nabla T_i$ 并将其加到 $S_{\\text{num}}$。\n   b. 计算平方范数 $n_i = \\|\\nabla T_i\\|_2^2$ 并将其加到 $S_{\\text{den}}$。\n3. 检查 $S_{\\text{den}}$ 是否实际为零。如果是，则设 $\\kappa = 0$。否则，计算 $\\kappa = -S_{\\text{num}} / S_{\\text{den}}$。\n4. 初始化残差平方和 $E^2 = 0$。\n5. 对于每个样本 $(\\nabla T_i, Q_i)$：\n   a. 计算残差矢量 $r_i = Q_i + \\kappa \\nabla T_i$。\n   b. 计算平方范数 $\\|r_i\\|_2^2$ 并将其加到 $E^2$。\n6. 最终的残差范数为 $\\|r\\|_2 = \\sqrt{E^2}$。\n此过程将应用于提供的四个数据集中的每一个。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effective thermal conductivity and residual error norm\n    for four different synthetic datasets from a fusion plasma simulation.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a list of tuples, where each tuple contains\n    # a temperature gradient vector and a heat flux vector.\n    test_cases = [\n        # Case 1: Happy path, perfectly diffusive\n        [\n            (np.array([10.0, 0.0]), np.array([-50.0, 0.0])),\n            (np.array([0.0, 8.0]), np.array([0.0, -40.0])),\n            (np.array([6.0, 6.0]), np.array([-30.0, -30.0])),\n            (np.array([(-4.0), 5.0]), np.array([20.0, -25.0])),\n        ],\n        # Case 2: Perpendicular non-diffusive flux\n        [\n            (np.array([12.0, 0.0]), np.array([-24.0, 1.0])),\n            (np.array([9.0, 0.0]), np.array([-18.0, -1.0])),\n            (np.array([6.0, 0.0]), np.array([-12.0, 0.5])),\n            (np.array([3.0, 0.0]), np.array([-6.0, -0.5])),\n        ],\n        # Case 3: No gradient information\n        [\n            (np.array([0.0, 0.0]), np.array([1.0, -2.0])),\n            (np.array([0.0, 0.0]), np.array([-0.5, 0.5])),\n        ],\n        # Case 4: Mixed alignment, non-diffusive components\n        [\n            (np.array([5.0, 1.0]), np.array([-14.8, -3.1])),\n            (np.array([-4.0, 2.0]), np.array([12.0, -6.0])),\n            (np.array([0.0, 0.0]), np.array([1.0, -1.0])),\n            (np.array([3.0, -3.0]), np.array([-8.5, 9.5])),\n            (np.array([2.0, 4.0]), np.array([-6.2, -11.9])),\n        ],\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        numerator_sum = 0.0\n        denominator_sum = 0.0\n\n        # Calculate sums for kappa\n        for grad_T, Q in case:\n            numerator_sum += np.dot(Q, grad_T)\n            denominator_sum += np.dot(grad_T, grad_T)\n\n        # Check for the special case where no gradient information is available.\n        # A small tolerance is used for floating-point comparison.\n        if abs(denominator_sum) > 1e-15:\n            kappa = -numerator_sum / denominator_sum\n        else:\n            # As per problem spec, if sum of ||grad T_i||^2 = 0, kappa is 0.\n            kappa = 0.0\n\n        # Calculate residual norm using the computed kappa\n        residual_sq_sum = 0.0\n        for grad_T, Q in case:\n            residual_vector = Q + kappa * grad_T\n            residual_sq_sum += np.dot(residual_vector, residual_vector)\n                \n        residual_norm = np.sqrt(residual_sq_sum)\n        \n        results.append([kappa, residual_norm])\n\n    # Format the output string to match the exact requirement:\n    # [[k1,r1],[k2,r2],...] with no spaces.\n    # Using a list comprehension and join is a clean way to achieve this.\n    output_str = f\"[{','.join([f'[{k},{r}]' for k, r in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "一旦确定了具有特定扩散和对流系数的简化输运模型，就可以用它来求解输运方程。本练习阐述了如何使用稳态粒子连续性方程来确定维持目标密度剖面所需的总粒子源（即燃料注入）。这展示了简化模型在连接局域输运特性与全局等离子体参数方面的强大能力。",
            "id": "3964888",
            "problem": "考虑一个大环径比、圆形截面的托卡马克，其大半径为 $R_{0}$，小半径坐标为 $r \\in [0,a]$。设 $\\mathcal{V}(r)$ 表示由小半径 $r$ 标记的磁通面所包围的体积，并设 $\\mathcal{V}'(r) \\equiv d\\mathcal{V}/dr$ 表示相应的磁通面面积。在大环径比、圆形几何近似下，取 $\\mathcal{V}'(r) = 4 \\pi^{2} R_{0} r$。磁通面平均的稳态粒子连续性方程将径向粒子通量的散度与体积粒子源密度联系起来。采用一种简化的输运闭合关系，其中径向粒子通量是扩散贡献和对流（箍缩）贡献之和，其系数可以依赖于 $r$。具体来说，设径向粒子通量的形式为 $\\Gamma_{r}(r) = - D(r) \\, d n(r)/dr + V(r) \\, n(r)$，其中 $n(r)$ 是目标密度剖面，$D(r)$ 是粒子扩散系数，$V(r)$ 是对流箍缩速度。\n\n给定以下剖面：\n- $D(r) = D_{0} \\left[ 1 + \\alpha \\left( \\frac{r}{a} \\right)^{2} \\right]$,\n- $V(r) = V_{0} \\left( \\frac{r}{a} \\right)$,\n- $n(r) = n_{0} \\left[ 1 - \\left( \\frac{r}{a} \\right)^{2} \\right]$,\n\n其中 $D_{0} > 0$, $\\alpha \\ge 0$, $V_{0}$, $n_{0} > 0$ 和 $a > 0$ 均为常数。假设在磁轴 $r=0$ 处满足正则性条件，使得径向粒子通量 $\\Gamma_{r}(r)$ 在 $r \\to 0$ 时保持有限，并取最外闭合磁通面（LCFS）位于 $r=a$ 处。\n\n从稳态磁通面平均的粒子连续性方程和上述关于 $\\Gamma_{r}(r)$ 的闭合关系出发，使用在 $0 \\le r \\le a$ 上的积分约束，确定维持给定目标密度剖面所需的总粒子源（总加料率）$\\Phi_{\\text{tot}} \\equiv \\int_{0}^{a} S(r) \\, \\mathcal{V}'(r) \\, dr$。将你的最终答案表示为关于 $n_{0}$、$D_{0}$、$\\alpha$、$V_{0}$、$a$ 和 $R_{0}$ 的单个闭式解析表达式。$\\Phi_{\\text{tot}}$ 的物理单位是 $\\text{s}^{-1}$（粒子数/秒）。不要代入任何数值，也不要在最终的方框答案中包含单位。",
            "solution": "该问题要求确定维持给定稳态密度剖面所需的总粒子源率 $\\Phi_{\\text{tot}}$。出发点是磁通面平均的稳态粒子连续性方程，它表示了局域粒子守恒：\n$$ \\frac{1}{\\mathcal{V}'(r)} \\frac{d}{dr} \\left( \\mathcal{V}'(r) \\Gamma_{r}(r) \\right) = S(r) $$\n这里，$r$ 是小半径坐标，$S(r)$ 是体积粒子源密度，$\\Gamma_{r}(r)$ 是径向粒子通量，$\\mathcal{V}'(r)$ 是磁通面面积，在大环径比、圆形几何近似下由 $\\mathcal{V}'(r) = 4 \\pi^{2} R_{0} r$ 给出。\n\n总粒子源率 $\\Phi_{\\text{tot}}$ 是体积源密度在整个等离子体体积上的积分，从磁轴（$r=0$）到最外闭合磁通面（LCFS）$r=a$。体积元为 $d\\mathcal{V} = \\mathcal{V}'(r) dr$。因此，$\\Phi_{\\text{tot}}$ 定义为：\n$$ \\Phi_{\\text{tot}} \\equiv \\int_{0}^{a} S(r) \\mathcal{V}'(r) dr $$\n将连续性方程中 $S(r)$ 的表达式代入此定义，我们得到：\n$$ \\Phi_{\\text{tot}} = \\int_{0}^{a} \\left[ \\frac{1}{\\mathcal{V}'(r)} \\frac{d}{dr} \\left( \\mathcal{V}'(r) \\Gamma_{r}(r) \\right) \\right] \\mathcal{V}'(r) dr $$\n$\\mathcal{V}'(r)$ 项相互抵消，留下一个全导数的简单积分：\n$$ \\Phi_{\\text{tot}} = \\int_{0}^{a} \\frac{d}{dr} \\left( \\mathcal{V}'(r) \\Gamma_{r}(r) \\right) dr $$\n根据微积分基本定理，该积分的值等于被积函数在积分域边界处的值之差：\n$$ \\Phi_{\\text{tot}} = \\left[ \\mathcal{V}'(r) \\Gamma_{r}(r) \\right]_{r=0}^{r=a} = \\mathcal{V}'(a) \\Gamma_{r}(a) - \\mathcal{V}'(0) \\Gamma_{r}(0) $$\n我们现在必须计算这两个边界项。\n在磁轴 $r=0$ 处，磁通面面积为 $\\mathcal{V}'(0) = 4 \\pi^{2} R_{0} (0) = 0$。问题还指出，径向粒子通量 $\\Gamma_{r}(r)$ 在 $r \\to 0$ 时必须保持有限。因此，下边界处的项为零：\n$$ \\mathcal{V}'(0) \\Gamma_{r}(0) = 0 $$\n这将总源率的表达式简化为流出 LCFS 的粒子通量乘以 LCFS 的面积：\n$$ \\Phi_{\\text{tot}} = \\mathcal{V}'(a) \\Gamma_{r}(a) $$\n这是稳态下全局粒子平衡的表述：在体积内产生的总粒子数必须等于流出其边界的总粒子数。\n\n接下来，我们必须计算量 $\\mathcal{V}'(a)$ 和 $\\Gamma_{r}(a)$。\n在 $r=a$ 处的磁通面面积为：\n$$ \\mathcal{V}'(a) = 4 \\pi^{2} R_{0} a $$\n径向粒子通量 $\\Gamma_{r}(r)$ 由输运闭合关系给出：\n$$ \\Gamma_{r}(r) = - D(r) \\frac{dn(r)}{dr} + V(r) n(r) $$\n我们需要使用给定的剖面在 $r=a$ 处计算该表达式的值。\n密度剖面为 $n(r) = n_{0} \\left[ 1 - \\left( \\frac{r}{a} \\right)^{2} \\right]$。在 LCFS 处，$r=a$，密度为：\n$$ n(a) = n_{0} \\left[ 1 - \\left( \\frac{a}{a} \\right)^{2} \\right] = n_{0} (1 - 1) = 0 $$\n密度梯度为 $\\frac{dn}{dr} = \\frac{d}{dr} \\left( n_{0} - \\frac{n_{0}r^{2}}{a^{2}} \\right) = - \\frac{2 n_{0} r}{a^{2}}$。在 $r=a$ 处，梯度为：\n$$ \\frac{dn}{dr}\\bigg|_{r=a} = - \\frac{2 n_{0} a}{a^{2}} = - \\frac{2 n_{0}}{a} $$\n在 $r=a$ 处的扩散系数由 $D(r) = D_{0} \\left[ 1 + \\alpha \\left( \\frac{r}{a} \\right)^{2} \\right]$ 得到：\n$$ D(a) = D_{0} \\left[ 1 + \\alpha \\left( \\frac{a}{a} \\right)^{2} \\right] = D_{0} (1 + \\alpha) $$\n在 $r=a$ 处的对流箍缩速度由 $V(r) = V_{0} \\frac{r}{a}$ 得到：\n$$ V(a) = V_{0} \\frac{a}{a} = V_{0} $$\n现在我们组合边界处通量 $\\Gamma_{r}(a)$ 的表达式：\n$$ \\Gamma_{r}(a) = - D(a) \\left( \\frac{dn}{dr}\\bigg|_{r=a} \\right) + V(a) n(a) $$\n代入计算出的值：\n$$ \\Gamma_{r}(a) = - \\left[ D_{0} (1 + \\alpha) \\right] \\left( - \\frac{2 n_{0}}{a} \\right) + (V_{0}) (0) $$\n$$ \\Gamma_{r}(a) = \\frac{2 n_{0} D_{0} (1 + \\alpha)}{a} $$\n注意，由于边界处的密度 $n(a)$ 为零，通量的对流部分 $V(r)n(r)$ 在边界处为零。\n\n最后，我们通过代入 $\\mathcal{V}'(a)$ 和 $\\Gamma_{r}(a)$ 的表达式来计算总粒子源率 $\\Phi_{\\text{tot}}$：\n$$ \\Phi_{\\text{tot}} = \\mathcal{V}'(a) \\Gamma_{r}(a) = \\left( 4 \\pi^{2} R_{0} a \\right) \\left( \\frac{2 n_{0} D_{0} (1 + \\alpha)}{a} \\right) $$\n小半径 $a$ 从表达式中消去：\n$$ \\Phi_{\\text{tot}} = 8 \\pi^{2} R_{0} n_{0} D_{0} (1 + \\alpha) $$\n这就是给定输运模型下，维持指定密度剖面所需的总加料率的最终闭式解析表达式。结果依赖于大半径、中心密度、中心扩散系数以及扩散系数形状参数 $\\alpha$，但由于特定的边界条件 $n(a)=0$，它与小半径 $a$ 和箍缩速度参数 $V_{0}$ 无关。",
            "answer": "$$ \\boxed{8 \\pi^{2} R_{0} n_{0} D_{0} (1 + \\alpha)} $$"
        },
        {
            "introduction": "任何输运模型的最终检验标准是其在已知不确定度范围内再现实验观测的能力。本练习介绍了卡方 ($\\chi^2$) 统计量，这是量化模型预测与测量数据之间拟合优度的基本工具。通过计算 $\\chi^2$ 值和相应的 p 值，你将学会如何对模型的有效性做出统计上合理的判断。",
            "id": "3964844",
            "problem": "一个简化输运模型针对单次稳态托卡马克放电进行了校准，以再现一组积分和剖面约束的诊断结果。该模型预测了一组与独立诊断通道相对应的可观测量。假设满足以下条件：每次测量的误差都是独立的，并服从标准差已知的高斯分布；简化模型通过在同一数据集上调整 $p$ 个标量校准参数进行了调节；模型的拟合优度通过高斯似然所蕴含的标准残差平方和进行评估。\n\n考虑一个固定时间片上的 $N=6$ 个独立诊断通道。测量值 $y_i^{\\mathrm{meas}}$、一倍标准差不确定度 $\\sigma_i$ 和模型预测值 $y_i^{\\mathrm{model}}$ 如下：\n- 来自汤姆逊散射(TS)的堆芯电子温度：$y_1^{\\mathrm{meas}}=4.5\\,\\mathrm{keV}$，$\\sigma_1=0.2\\,\\mathrm{keV}$，$y_1^{\\mathrm{model}}=4.7\\,\\mathrm{keV}$。\n- 来自干涉测量法的弦平均电子密度：$y_2^{\\mathrm{meas}}=6.0\\times 10^{19}\\,\\mathrm{m}^{-3}$，$\\sigma_2=0.3\\times 10^{19}\\,\\mathrm{m}^{-3}$，$y_2^{\\mathrm{model}}=6.3\\times 10^{19}\\,\\mathrm{m}^{-3}$。\n- 来自电荷交换复合光谱(CHERS)的堆芯离子温度：$y_3^{\\mathrm{meas}}=5.0\\,\\mathrm{keV}$，$\\sigma_3=0.2\\,\\mathrm{keV}$，$y_3^{\\mathrm{model}}=5.2\\,\\mathrm{keV}$。\n- 来自CHERS的堆芯环向旋转：$y_4^{\\mathrm{meas}}=150\\,\\mathrm{km/s}$，$\\sigma_4=10\\,\\mathrm{km/s}$，$y_4^{\\mathrm{model}}=160\\,\\mathrm{km/s}$。\n- 来自平衡重建的储能：$y_5^{\\mathrm{meas}}=1.20\\,\\mathrm{MJ}$，$\\sigma_5=0.05\\,\\mathrm{MJ}$，$y_5^{\\mathrm{model}}=1.20\\,\\mathrm{MJ}$。\n- 归一化小半径 $\\rho=0.5$ 处的中半径热通量：$y_6^{\\mathrm{meas}}=0.80\\,\\mathrm{MW/m^2}$，$\\sigma_6=0.10\\,\\mathrm{MW/m^2}$，$y_6^{\\mathrm{model}}=0.80\\,\\mathrm{MW/m^2}$。\n\n假设校准参数的数量为 $p=2$，因此相应的自由度为 $k=N-p$。从高斯误差模型和独立性假设出发，根据第一性原理推导出适当的失拟统计量，并利用上述数据集计算其值。然后，在模型与数据及不确定度一致的零假设下，使用该统计量的抽样分布，计算超出概率（即p值）。将p值以无量纲小数形式报告，并四舍五入至四位有效数字。",
            "solution": "该问题要求推导和计算拟合优度统计量及其对应的超出概率（p值），以评估一个简化输运模型与托卡马克放电诊断数据的一致性。\n\n首先，对问题陈述进行验证。\n已知条件：\n- 独立诊断通道数：$N=6$。\n- 校准模型参数的数量：$p=2$。\n- 假设：每次测量误差都是独立的，并服从标准差 $\\sigma_i$ 已知的高斯分布。\n- 每个通道 $i=1, \\dots, 6$ 的数据：测量值 $y_i^{\\mathrm{meas}}$、标准差 $\\sigma_i$ 和模型预测值 $y_i^{\\mathrm{model}}$。\n    - $y_1^{\\mathrm{meas}}=4.5$，$\\sigma_1=0.2$，$y_1^{\\mathrm{model}}=4.7$\n    - $y_2^{\\mathrm{meas}}=6.0\\times 10^{19}$，$\\sigma_2=0.3\\times 10^{19}$，$y_2^{\\mathrm{model}}=6.3\\times 10^{19}$\n    - $y_3^{\\mathrm{meas}}=5.0$，$\\sigma_3=0.2$，$y_3^{\\mathrm{model}}=5.2$\n    - $y_4^{\\mathrm{meas}}=150$，$\\sigma_4=10$，$y_4^{\\mathrm{model}}=160$\n    - $y_5^{\\mathrm{meas}}=1.20$，$\\sigma_5=0.05$，$y_5^{\\mathrm{model}}=1.20$\n    - $y_6^{\\mathrm{meas}}=0.80$，$\\sigma_6=0.10$，$y_6^{\\mathrm{model}}=0.80$\n- 统计量的自由度由 $k=N-p$ 给出。\n- 任务是推导失拟统计量，计算其值，然后计算p值。\n\n该问题具有科学依据，提法明确，客观且内部一致。它描述了物理学和工程学中数据分析和模型验证的标准流程。所有必要信息均已提供。因此，该问题被认定为有效，可以制定解决方案。\n\n**步骤1：失拟统计量的推导**\n\n零假设 $H_0$ 是：该模型是物理现实的正确表述，即模型预测值 $y_i^{\\mathrm{model}}$ 代表了被测量的真实平均值。\n鉴于每个通道 $i$ 的测量误差服从高斯分布，给定模型预测值 $y_i^{\\mathrm{model}}$，观测到测量值 $y_i^{\\mathrm{meas}}$ 的概率由高斯概率密度函数（PDF）描述：\n$$\nP(y_i^{\\mathrm{meas}} | y_i^{\\mathrm{model}}) = \\frac{1}{\\sigma_i \\sqrt{2\\pi}} \\exp\\left( -\\frac{(y_i^{\\mathrm{meas}} - y_i^{\\mathrm{model}})^2}{2\\sigma_i^2} \\right)\n$$\n问题陈述测量是独立的。因此，观测到全部 $N$ 个测量值的联合概率（即似然函数 $L$）是各个概率的乘积：\n$$\nL(\\{y_i^{\\mathrm{meas}}\\}) = \\prod_{i=1}^{N} P(y_i^{\\mathrm{meas}} | y_i^{\\mathrm{model}}) = \\prod_{i=1}^{N} \\frac{1}{\\sigma_i \\sqrt{2\\pi}} \\exp\\left( -\\frac{(y_i^{\\mathrm{meas}} - y_i^{\\mathrm{model}})^2}{2\\sigma_i^2} \\right)\n$$\n在统计推断中，处理负对数似然 $-\\ln(L)$ 通常更为方便：\n$$\n-\\ln(L) = -\\sum_{i=1}^{N} \\ln\\left[ \\frac{1}{\\sigma_i \\sqrt{2\\pi}} \\exp\\left( -\\frac{(y_i^{\\mathrm{meas}} - y_i^{\\mathrm{model}})^2}{2\\sigma_i^2} \\right) \\right]\n$$\n$$\n-\\ln(L) = -\\sum_{i=1}^{N} \\left[ -\\ln(\\sigma_i \\sqrt{2\\pi}) - \\frac{(y_i^{\\mathrm{meas}} - y_i^{\\mathrm{model}})^2}{2\\sigma_i^2} \\right]\n$$\n$$\n-\\ln(L) = \\sum_{i=1}^{N} \\ln(\\sigma_i \\sqrt{2\\pi}) + \\frac{1}{2} \\sum_{i=1}^{N} \\left( \\frac{y_i^{\\mathrm{meas}} - y_i^{\\mathrm{model}}}{\\sigma_i} \\right)^2\n$$\n拟合优度是通过最小化该函数相对于模型自由参数的值来评估的。由于第一项相对于模型是一个常数，这等效于最小化第二项。标准的残差平方和失拟统计量，记为$\\chi^2$（卡方），由这第二项定义：\n$$\n\\chi^2 = \\sum_{i=1}^{N} \\left( \\frac{y_i^{\\mathrm{meas}} - y_i^{\\mathrm{model}}}{\\sigma_i} \\right)^2\n$$\n这就是从所述的独立高斯误差第一性原理推导出的适当的失拟统计量。\n\n**步骤2：失拟统计量值的计算**\n\n现在我们使用提供的数据计算 $\\chi^2$ 的值。对每个通道，我们计算归一化残差的平方，$z_i^2 = \\left( (y_i^{\\mathrm{meas}} - y_i^{\\mathrm{model}})/\\sigma_i \\right)^2$。\n\n- 通道1：$z_1 = \\frac{4.5 - 4.7}{0.2} = \\frac{-0.2}{0.2} = -1.0$。因此，$z_1^2 = 1.0$。\n- 通道2：$z_2 = \\frac{(6.0 - 6.3)\\times 10^{19}}{0.3\\times 10^{19}} = \\frac{-0.3}{0.3} = -1.0$。因此，$z_2^2 = 1.0$。\n- 通道3：$z_3 = \\frac{5.0 - 5.2}{0.2} = \\frac{-0.2}{0.2} = -1.0$。因此，$z_3^2 = 1.0$。\n- 通道4：$z_4 = \\frac{150 - 160}{10} = \\frac{-10}{10} = -1.0$。因此，$z_4^2 = 1.0$。\n- 通道5：$z_5 = \\frac{1.20 - 1.20}{0.05} = \\frac{0.0}{0.05} = 0.0$。因此，$z_5^2 = 0.0$。\n- 通道6：$z_6 = \\frac{0.80 - 0.80}{0.10} = \\frac{0.0}{0.10} = 0.0$。因此，$z_6^2 = 0.0$。\n\n总 $\\chi^2$ 值是这些单项贡献的总和：\n$$\n\\chi^2_{\\mathrm{obs}} = \\sum_{i=1}^{6} z_i^2 = 1.0 + 1.0 + 1.0 + 1.0 + 0.0 + 0.0 = 4.0\n$$\n观测到的失拟统计量值为 $\\chi^2_{\\mathrm{obs}} = 4.0$。\n\n**步骤3：超出概率（p值）的计算**\n\n在零假设 $H_0$ 下，每个归一化残差 $z_i$ 是一个标准正态变量。$N$ 个独立标准正态变量的平方和服从自由度为 $N$ 的 $\\chi^2$ 分布。然而，问题陈述该模型通过调整 $p$ 个参数来拟合此数据集。这减少了系统的自由度。$\\chi^2$ 统计量的适当自由度数为 $k = N-p$。\n给定 $N=6$ 和 $p=2$，自由度为：\n$$\nk = 6 - 2 = 4\n$$\n因此，在 $H_0$ 下，我们观测到的统计量 $\\chi^2_{\\mathrm{obs}}$ 是一个来自自由度为4的 $\\chi^2$ 分布（记为 $\\chi^2_4$）的抽样。\n\np值是在假设 $H_0$ 为真的前提下，获得一个大于或等于观测值的 $\\chi^2$ 值的概率。这就是“超出概率”。\n$$\np\\text{-值} = P(\\chi^2_4 \\ge \\chi^2_{\\mathrm{obs}}) = P(\\chi^2_4 \\ge 4.0)\n$$\n这个概率通过将 $\\chi^2_4$ 分布的概率密度函数从 $\\chi^2_{\\mathrm{obs}}=4.0$ 积分到无穷大来计算。自由度为 $k$ 的 $\\chi^2$ 分布的概率密度函数是 $f(x; k) = \\frac{1}{2^{k/2}\\Gamma(k/2)} x^{k/2 - 1} \\exp(-x/2)$，其中 $\\Gamma$ 是伽马函数。\n对于 $k=4$，我们有 $\\Gamma(k/2) = \\Gamma(2) = (2-1)! = 1$。概率密度函数变为：\n$$\nf(x; 4) = \\frac{1}{4} x \\exp(-x/2)\n$$\np值是该积分：\n$$\np\\text{-值} = \\int_{4.0}^{\\infty} \\frac{1}{4} x \\exp(-x/2) dx\n$$\n我们使用分部积分法 $\\int u \\, dv = uv - \\int v \\, du$ 来求解此积分。令 $u = x$ 且 $dv = \\frac{1}{4}\\exp(-x/2)dx$。则 $du=dx$ 且 $v = \\int \\frac{1}{4}\\exp(-x/2)dx = -\\frac{1}{2}\\exp(-x/2)$。\n$$\n\\int \\frac{1}{4} x \\exp(-x/2) dx = x\\left(-\\frac{1}{2}\\exp(-x/2)\\right) - \\int \\left(-\\frac{1}{2}\\exp(-x/2)\\right) dx\n$$\n$$\n= -\\frac{x}{2}\\exp(-x/2) + \\frac{1}{2} \\int \\exp(-x/2) dx = -\\frac{x}{2}\\exp(-x/2) - \\exp(-x/2) = -\\left(\\frac{x}{2} + 1\\right)\\exp(-x/2)\n$$\n计算从 $4.0$ 到 $\\infty$ 的定积分：\n$$\np\\text{-值} = \\left[ -\\left(\\frac{x}{2} + 1\\right)\\exp(-x/2) \\right]_{4.0}^{\\infty}\n$$\n$x \\to \\infty$ 时的极限为 $0$。在下限 $x=4.0$ 处求值：\n$$\np\\text{-值} = 0 - \\left[ -\\left(\\frac{4.0}{2} + 1\\right)\\exp(-4.0/2) \\right] = (2.0 + 1)\\exp(-2.0) = 3\\exp(-2)\n$$\n现在，我们计算其数值：\n$$\np\\text{-值} = 3\\exp(-2) \\approx 0.406005849...\n$$\n按要求四舍五入到四位有效数字，得到：\n$$\np\\text{-值} \\approx 0.4060\n$$\n这个p值表示，一个正确的模型仅仅由于随机测量误差，便会产生一个至少与观测值（$\\chi^2=4.0$）一样大的失拟的概率。p值为 $0.4060$ 通常被认为是大的，这表明没有统计学证据来拒绝零假设。该模型与数据是一致的。",
            "answer": "$$ \\boxed{0.4060} $$"
        }
    ]
}