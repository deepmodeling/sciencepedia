{
    "hands_on_practices": [
        {
            "introduction": "在简单的圆柱形等离子体中，电阻率是一个相对直接的标量。然而，托卡马克独特的环形几何形状引入了新的物理学，从根本上改变了电流和输运的特性。这个练习将带你探究皮尔施-施吕特（Pfirsch-Schlüter）电流的起源，它是维持电荷守恒在环形几何中的直接产物。通过推导该电流并计算一个关键的几何因子，你将对磁场在磁通面上的变化如何影响等离子体行为获得基础性的理解 。",
            "id": "4017815",
            "problem": "一个圆形截面、同心的大环径比托卡马克，其大半径为 $R_{0}$，小半径为 $r$，反环径比为 $\\varepsilon \\equiv r/R_{0} \\ll 1$。假设系统轴对称，并且给定磁通面上的磁场主要由环向分量决定，因此，在 $\\varepsilon$ 的领头阶上，其大小随极向角 $\\theta$ 的变化关系为 $B(\\theta) = B_{0} R_{0}/R(\\theta)$，其中 $R(\\theta) = R_{0} \\left(1 + \\varepsilon \\cos\\theta\\right)$，$B_{0}$ 是磁轴处的环向场。标量 $g(\\theta)$ 的磁通面平均由磁通面上的面积平均定义，\n$$\n\\langle g \\rangle \\equiv \\frac{\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} g(\\theta)\\, dS}{\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} dS}, \\quad dS = r\\,R(\\theta)\\, d\\theta\\, d\\varphi,\n$$\n其中 $\\varphi$ 是环向角。\n\n从磁流体动力学力平衡和电流连续性方程出发，推导在轴对称托卡马克中，压力 $p = p(\\psi)$ 在每个极向磁通 $\\psi$ 的磁通面上为常数时，磁通面上的 Pfirsch–Schlüter 平行电流 $j_{\\mathrm{PS},\\parallel}$，并证明几何积分 $\\langle B^{-2} \\rangle$ 以 $B^{-2} - \\langle B^{-2} \\rangle$ 的组合形式出现。然后，在碰撞区中使用带有标量平行电阻率 $\\eta_{\\parallel}$ 的欧姆定律平行分量，说明 $\\langle B^{-2} \\rangle$ 如何进入回路电压驱动与净平行电流之间的磁通面平均关系（即有效平行电阻率）。\n\n对上述定义的圆形几何，明确计算磁通面平均 $\\langle B^{-2} \\rangle$，保留到并包括 $\\varepsilon^{2}$ 阶的项。将最终答案表示为以 $B_{0}$ 和 $\\varepsilon$ 表示的闭式解析表达式。无需进行数值取整。",
            "solution": "用户提供了一个关于托卡马克中新经典效应的等离子体物理问题。我将首先验证该问题，然后进行推导和计算。\n\n### 问题验证\n\n#### 第 1 步：提取已知条件\n-   **系统**：一个圆形截面、同心的大环径比托卡马克。\n-   **几何**：大半径 $R_{0}$，小半径 $r$，反环径比 $\\varepsilon \\equiv r/R_{0} \\ll 1$。\n-   **对称性**：轴对称。\n-   **磁场**：在 $\\varepsilon$ 的领头阶上，磁通面上的磁场大小由 $B(\\theta) = B_{0} R_{0}/R(\\theta)$ 给出，其中 $R(\\theta) = R_{0} \\left(1 + \\varepsilon \\cos\\theta\\right)$ 表示大半径坐标。$B_{0}$ 是磁轴（$r=0$）处的环向磁场。\n-   **压力**：压力 $p$ 是一个磁通函数，$p = p(\\psi)$，在极向磁通 $\\psi$ 的磁面上为常数。\n-   **磁通面平均**：标量 $g(\\theta)$ 的平均值定义为 $\\langle g \\rangle \\equiv \\frac{\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} g(\\theta)\\, dS}{\\int_{0}^{2\\pi}\\int_{0}^{2\\pi} dS}$，其中面元为 $dS = r\\,R(\\theta)\\, d\\theta\\, d\\varphi$。\n-   **任务 1**：推导 Pfirsch–Schlüter 平行电流 $j_{\\mathrm{PS},\\parallel}$，并证明项 $B^{-2} - \\langle B^{-2} \\rangle$ 的出现。\n-   **任务 2**：使用带有标量电阻率 $\\eta_{\\parallel}$ 的平行欧姆定律，说明 $\\langle B^{-2} \\rangle$ 如何进入回路电压与净平行电流之间的磁通面平均关系。\n-   **任务 3**：明确计算磁通面平均 $\\langle B^{-2} \\rangle$ 至 $\\varepsilon^{2}$ 阶。\n\n#### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题设置在磁流体动力学（MHD）和聚变等离子体中新经典输运理论的标准框架内。Pfirsch–Schlüter 电流、磁通面平均和有效电阻率等概念是托卡马克物理学的核心。所使用的近似和模型（大环径比、圆形截面、标量电阻率）是教学推导的标准出发点。该问题在根本上是合理的。\n2.  **适定性**：该问题要求基于定义明确的量进行特定的推导和计算。给定的条件足以完成这些任务。计算部分预期存在唯一的解析解。\n3.  **客观性**：语言精确、定量，没有主观成分。\n\n#### 第 3 步：结论与行动\n该问题有效。我现在开始解答。\n\n### 第 1 部分：Pfirsch–Schlüter 电流的推导\n\n出发点是稳态下的理想磁流体动力学力平衡方程和电流连续性方程：\n$$\n\\nabla p = \\mathbf{j} \\times \\mathbf{B}\n$$\n$$\n\\nabla \\cdot \\mathbf{j} = 0\n$$\n电流密度 $\\mathbf{j}$ 可以分解为平行于磁场 $\\mathbf{B}$ 和垂直于磁场 $\\mathbf{B}$ 的分量：$\\mathbf{j} = j_{\\parallel} \\frac{\\mathbf{B}}{B} + \\mathbf{j}_{\\perp}$。根据力平衡方程，垂直分量是抗磁电流：\n$$\n\\mathbf{j}_{\\perp} = \\frac{\\mathbf{B} \\times \\nabla p}{B^2}\n$$\n将 $\\mathbf{j}$ 的分解代入连续性方程得到：\n$$\n\\nabla \\cdot \\left(j_{\\parallel} \\frac{\\mathbf{B}}{B}\\right) + \\nabla \\cdot \\mathbf{j}_{\\perp} = 0\n$$\n由于 $\\nabla \\cdot \\mathbf{B} = 0$，第一项可以重写为 $\\mathbf{B} \\cdot \\nabla (j_{\\parallel}/B)$。这得到：\n$$\n\\mathbf{B} \\cdot \\nabla \\left( \\frac{j_{\\parallel}}{B} \\right) = - \\nabla \\cdot \\mathbf{j}_{\\perp} = - \\nabla \\cdot \\left(\\frac{\\mathbf{B} \\times \\nabla p}{B^2}\\right)\n$$\n对于一个轴对称系统，其中压力 $p$ 和环向磁通函数 $I \\equiv R B_{\\phi}$ 都是磁通函数（$p=p(\\psi)$, $I=I(\\psi)$），一个关键的恒等式是：\n$$\n\\nabla \\cdot \\left(\\frac{\\mathbf{B} \\times \\nabla p}{B^2}\\right) = -I(\\psi) p'(\\psi) \\left( \\mathbf{B} \\cdot \\nabla \\left( \\frac{1}{B^2} \\right) \\right)\n$$\n其中 $p'(\\psi) \\equiv dp/d\\psi$。将此代入 $j_{\\parallel}/B$ 的方程中：\n$$\n\\mathbf{B} \\cdot \\nabla \\left( \\frac{j_{\\parallel}}{B} \\right) = I p' \\left( \\mathbf{B} \\cdot \\nabla \\left( \\frac{1}{B^2} \\right) \\right)\n$$\n重新整理各项，我们得到：\n$$\n\\mathbf{B} \\cdot \\nabla \\left( \\frac{j_{\\parallel}}{B} - \\frac{I p'}{B^2} \\right) = 0\n$$\n该方程表明括号内的量沿着磁力线不发生变化。由于有理磁通面上的磁力线遍历地覆盖整个磁面，这个量必须是一个磁通函数，我们记为 $K(\\psi)$：\n$$\n\\frac{j_{\\parallel}}{B} - \\frac{I p'}{B^2} = K(\\psi)\n$$\n这给出了总平行电流密度的结构：\n$$\nj_{\\parallel} = K(\\psi) B + \\frac{I p'}{B}\n$$\n平行电流是两项之和。项 $K(\\psi)B$ 与由外部方式（如回路电压）或自举效应驱动的净电流有关。第二项与压力梯度 $p'$ 成正比，是在存在极向变化的抗磁电流的情况下维持电荷中性（$\\nabla \\cdot \\mathbf{j}=0$）所必需的。平行电流的这个压力驱动部分就是产生 Pfirsch–Schlüter 电流的原因。\n\nPfirsch–Schlüter 电流 $j_{\\mathrm{PS},\\parallel}$ 被定义为由压力梯度驱动的平行电流的极向变化分量。为了分离出这个变化部分，我们减去它的磁通面平均值。我们可以这样定义 $j_{\\mathrm{PS},\\parallel}$，使得对应的 $j_{\\mathrm{PS},\\parallel}/B$ 的磁通面平均为零：$\\langle j_{\\mathrm{PS},\\parallel}/B \\rangle = 0$。\n$j_{\\parallel}/B$ 的压力驱动部分是 $I p' / B^2$。我们可以将其分解为其平均部分和变化部分：\n$$\n\\frac{I p'}{B^2} = I p' \\langle B^{-2} \\rangle + I p' \\left( B^{-2} - \\langle B^{-2} \\rangle \\right)\n$$\n第一项是一个磁通函数，而第二项的磁通面平均为零。第一项可以被吸收到 $K(\\psi)$ 的定义中，代表净电流的压力驱动部分（自举电流）。第二项代表了为维持电荷守恒所需的平行电流的振荡部分。因此，与 Pfirsch-Schlüter 电流对应的量是：\n$$\n\\frac{j_{\\mathrm{PS},\\parallel}}{B} = I p' \\left( \\frac{1}{B^2} - \\left\\langle \\frac{1}{B^2} \\right\\rangle \\right)\n$$\n这表明在归一化的 Pfirsch-Schlüter 电流表达式中，几何积分 $\\langle B^{-2} \\rangle$ 以 $B^{-2} - \\langle B^{-2} \\rangle$ 的组合形式出现。\n\n### 第 2 部分：有效平行电阻率\n\n在碰撞区，欧姆定律的平行分量是 $E_{\\parallel} = \\eta_{\\parallel} j_{\\parallel}$，其中 $\\eta_{\\parallel}$ 是标量平行电阻率，这里假设它是一个磁通函数。平行电场 $E_{\\parallel}$ 是外部施加的电场（来自回路电压）$E_{\\mathrm{ext},\\parallel}$ 和由电荷分离电势产生的电场 $E_{\\Phi,\\parallel} = -\\mathbf{B} \\cdot \\nabla\\Phi / B = -\\nabla_{\\parallel}\\Phi$ 的总和。\n\n在给定磁通面上电流所耗散的总功率必须等于外部驱动所供给的功率。单位体积的局域功率耗散率为 $\\mathbf{j} \\cdot \\mathbf{E} = j_{\\parallel} E_{\\parallel} = \\eta_{\\parallel} j_{\\parallel}^2$。磁通面平均的功率耗散是 $P_{\\mathrm{diss}} = \\langle \\eta_{\\parallel} j_{\\parallel}^2 \\rangle$。由回路电压供给的功率是 $P_{\\mathrm{in}} = \\langle \\mathbf{j} \\cdot \\mathbf{E}_{\\mathrm{ext}} \\rangle = \\langle j_{\\parallel} E_{\\mathrm{ext},\\parallel} \\rangle$。\n\n从第一性原理出发对有效电阻率进行恰当的处理需要动理学理论来解决“Spitzer 佯谬”。然而，Pfirsch-Schlüter 效应增大了耗散。总平行电流 $j_{||}$ 包含了 PS 电流，这是净电流之外的额外电流。对于给定的净电流，这个更大的总电流导致了更多的欧姆加热。有效平行电阻率 $\\eta_{\\mathrm{eff}}$ 是通过将净驱动电流与施加的电压相关联来定义的，并考虑了这种额外的耗散。一个简化但富有洞察力的论证将总耗散等同于一个有效净电流 $J_{\\mathrm{net}}$ 的耗散：$P_{\\mathrm{diss}} = \\eta_{\\mathrm{eff}} J_{\\mathrm{net}}^2$。当 $p'=0$ 时，$j_{\\parallel}=j_{driven}$ 且 $j_{PS,||}=0$。则 $j_{driven}/B=K(\\psi)$。静电势 $\\Phi$ 进行调整，使得 $E_{||}/\\eta_{||}B$ 成为一个磁通函数。这导出了新经典电阻率增强因子，对于碰撞等离子体，其为 $\\eta_{\\mathrm{eff}}/\\eta_{\\parallel} = \\langle B^2 \\rangle \\langle 1/B^2 \\rangle$。这个表达式明确地显示了磁通面平均 $\\langle B^{-2} \\rangle$ 是如何进入有效电阻率的公式的。\n\n### 第 3 部分：$\\langle B^{-2} \\rangle$ 的明确计算\n\n首先，我们必须对给定的几何形状计算平均算符 $\\langle \\cdot \\rangle$。\n$$\n\\langle g \\rangle = \\frac{\\int_{0}^{2\\pi} d\\varphi \\int_{0}^{2\\pi} g(\\theta) r R(\\theta) d\\theta}{\\int_{0}^{2\\pi} d\\varphi \\int_{0}^{2\\pi} r R(\\theta) d\\theta} = \\frac{2\\pi r \\int_{0}^{2\\pi} g(\\theta) R_0(1+\\varepsilon\\cos\\theta) d\\theta}{2\\pi r \\int_{0}^{2\\pi} R_0(1+\\varepsilon\\cos\\theta) d\\theta}\n$$\n分母的积分为 $\\int_{0}^{2\\pi} (1+\\varepsilon\\cos\\theta) d\\theta = [\\theta + \\varepsilon\\sin\\theta]_0^{2\\pi} = 2\\pi$。因此，平均算符简化为：\n$$\n\\langle g \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} g(\\theta)(1+\\varepsilon\\cos\\theta) d\\theta\n$$\n我们需要计算 $\\langle B^{-2} \\rangle$。磁场强度为 $B = B_0(1+\\varepsilon\\cos\\theta)^{-1}$。\n因此，$B^{-2} = B_0^{-2}(1+\\varepsilon\\cos\\theta)^2$。\n展开此项：\n$$\nB^{-2} = B_0^{-2} (1 + 2\\varepsilon\\cos\\theta + \\varepsilon^2\\cos^2\\theta)\n$$\n现在，我们应用平均算符：\n$$\n\\langle B^{-2} \\rangle = \\frac{1}{2\\pi} \\int_{0}^{2\\pi} B_0^{-2} (1 + 2\\varepsilon\\cos\\theta + \\varepsilon^2\\cos^2\\theta) (1+\\varepsilon\\cos\\theta) d\\theta\n$$\n我们展开被积函数，保留到 $\\varepsilon^2$ 阶的项：\n$$\n(1 + 2\\varepsilon\\cos\\theta + \\varepsilon^2\\cos^2\\theta) (1+\\varepsilon\\cos\\theta) = 1 + 2\\varepsilon\\cos\\theta + \\varepsilon^2\\cos^2\\theta + \\varepsilon\\cos\\theta + 2\\varepsilon^2\\cos^2\\theta + O(\\varepsilon^3)\n$$\n$$\n= 1 + 3\\varepsilon\\cos\\theta + 3\\varepsilon^2\\cos^2\\theta + O(\\varepsilon^3)\n$$\n积分变为：\n$$\n\\langle B^{-2} \\rangle = \\frac{B_0^{-2}}{2\\pi} \\int_{0}^{2\\pi} (1 + 3\\varepsilon\\cos\\theta + 3\\varepsilon^2\\cos^2\\theta) d\\theta\n$$\n我们计算在 $[0, 2\\pi]$ 上三角函数项的积分：\n-   $\\int_{0}^{2\\pi} 1 \\, d\\theta = 2\\pi$\n-   $\\int_{0}^{2\\pi} \\cos\\theta \\, d\\theta = [\\sin\\theta]_0^{2\\pi} = 0$\n-   $\\int_{0}^{2\\pi} \\cos^2\\theta \\, d\\theta = \\int_{0}^{2\\pi} \\frac{1+\\cos(2\\theta)}{2} \\, d\\theta = \\frac{1}{2} \\left[\\theta + \\frac{\\sin(2\\theta)}{2}\\right]_0^{2\\pi} = \\pi$\n\n将这些结果代入 $\\langle B^{-2} \\rangle$ 的表达式中：\n$$\n\\langle B^{-2} \\rangle = \\frac{B_0^{-2}}{2\\pi} \\left( 1 \\cdot (2\\pi) + 3\\varepsilon \\cdot (0) + 3\\varepsilon^2 \\cdot (\\pi) \\right)\n$$\n$$\n\\langle B^{-2} \\rangle = \\frac{B_0^{-2}}{2\\pi} (2\\pi + 3\\pi\\varepsilon^2)\n$$\n$$\n\\langle B^{-2} \\rangle = B_0^{-2} \\left(1 + \\frac{3}{2}\\varepsilon^2\\right)\n$$\n这就是 $B^{-2}$ 的磁通面平均值到 $\\varepsilon^2$ 阶的最终表达式。",
            "answer": "$$\n\\boxed{B_0^{-2} \\left(1 + \\frac{3}{2}\\varepsilon^2\\right)}\n$$"
        },
        {
            "introduction": "托卡马克中的总平行电流是几种不同物理机制共同作用的结果。理解它们各自的贡献对于预测等离子体性能和实现稳态运行至关重要。这个实践要求你区分极向变化的电流（如皮尔施-施吕特电流）和驱动约束的净磁通面平均电流。你将在此基础上，量化外部驱动的欧姆电流和内部自举电流之间的平衡，后者是先进托卡马克运行模式的一个核心要素 。",
            "id": "4017785",
            "problem": "考虑一个大环径比、轴对称的稳态托卡马克，其具有圆形磁通面，小半径为 $a$，大半径为 $R$，因此反环径比为 $\\epsilon = a/R \\ll 1$。假设碰撞电子动力学由无惯性的平行力平衡描述，且系统是准中性的。设磁通面平均（FSA）算子用 $\\langle \\cdot \\rangle$ 表示，该算子在极向角上定义，并带有适用于轴对称几何的雅可比行列式。磁场主要是环向的，其大小为 $B$，安全因子为 $q$。平行电场由均匀的环向电场 $E_{\\phi}$ 产生，因此在大环径比级数下，$E_{\\parallel} \\approx E_{\\phi} B_{\\phi}/B \\approx E_{\\phi}$。在所关心的半径处，等离子体具有径向压力梯度 $dp/dr  0$。\n\n从稳态电荷连续性方程 $\\nabla \\cdot \\mathbf{j} = 0$ 和总电流在每个磁通面上都必须是无散的这一要求出发，从第一性原理论证为何在轴对称平衡中，Pfirsch–Schlüter (PS) 平行电流的磁通面平均值 $\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle$ 必须为零。然后，将磁通面平均的平行电流密度建模为一个 $E_{\\parallel}$ 驱动（欧姆）分量和一个梯度驱动的自举分量之和，\n$$\n\\langle j_{\\parallel} \\rangle = \\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle + \\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle,\n$$\n其中平行欧姆响应由新经典平行电导率 $\\sigma_{\\parallel}$ 通过以下公式给出\n$$\n\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle = \\sigma_{\\parallel} E_{\\parallel},\n$$\n而大环径比香蕉-平台区中的自举分量由以下闭合关系近似\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = - \\alpha \\frac{q}{\\epsilon B} \\frac{dp}{dr},\n$$\n其中 $\\alpha$ 是一个量级为1的无量纲系数，包含了捕获粒子物理和弱碰撞依赖性的信息。\n\n在所关心的磁通面上使用以下参数值：\n- $B = 3.0$ T,\n- $q = 2.0$,\n- $\\epsilon = 0.20$,\n- $E_{\\phi} = 0.050$ V/m,\n- $\\sigma_{\\parallel} = 2.0 \\times 10^{6}$ S/m,\n- $\\frac{dp}{dr} = -6.0 \\times 10^{4}$ Pa/m,\n- $\\alpha = 0.75$.\n\n计算由每种机制承载的磁通面平均平行电流密度的分数，\n$$\nf_{\\mathrm{Ohm}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle}{\\langle j_{\\parallel} \\rangle}, \\quad\nf_{\\mathrm{PS}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle}{\\langle j_{\\parallel} \\rangle}, \\quad\nf_{\\mathrm{bs}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle}{\\langle j_{\\parallel} \\rangle},\n$$\n并将最终答案表示为单个行向量 $\\left( f_{\\mathrm{Ohm}} \\ \\ f_{\\mathrm{PS}} \\ \\ f_{\\mathrm{bs}} \\right)$。\n\n将你的分数四舍五入到四位有效数字。分数是无量纲的；最终答案中不需要单位。",
            "solution": "首先验证问题，以确保其科学上合理、内容自洽且提法恰当。\n\n### 步骤1：提取已知条件\n- 系统：大环径比（$\\epsilon = a/R \\ll 1$）、轴对称、具有圆形磁通面的稳态托卡马克。\n- 动力学：碰撞电子，无惯性的平行力平衡，准中性。\n- 算子：磁通面平均（FSA），$\\langle \\cdot \\rangle$。\n- 磁场：大小为 $B$。\n- 安全因子：$q$。\n- 电场：$E_{\\parallel} \\approx E_{\\phi}$。\n- 压力梯度：$dp/dr  0$。\n- 基本定律：稳态电荷连续性，$\\nabla \\cdot \\mathbf{j} = 0$。\n- FSA 平行电流密度模型：$\\langle j_{\\parallel} \\rangle = \\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle + \\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle$。\n- 欧姆分量：$\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle = \\sigma_{\\parallel} E_{\\parallel}$。\n- 自举分量：$\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = - \\alpha \\frac{q}{\\epsilon B} \\frac{dp}{dr}$。\n- 参数值：\n  - $B = 3.0 \\text{ T}$\n  - $q = 2.0$\n  - $\\epsilon = 0.20$\n  - $E_{\\phi} = 0.050 \\text{ V/m}$\n  - $\\sigma_{\\parallel} = 2.0 \\times 10^{6} \\text{ S/m}$\n  - $\\frac{dp}{dr} = -6.0 \\times 10^{4} \\text{ Pa/m}$\n  - $\\alpha = 0.75$\n- 要求计算：分数 $f_{\\mathrm{Ohm}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle}{\\langle j_{\\parallel} \\rangle}$，$f_{\\mathrm{PS}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle}{\\langle j_{\\parallel} \\rangle}$，$f_{\\mathrm{bs}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle}{\\langle j_{\\parallel} \\rangle}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题提法恰当，并以托卡马克等离子体中新经典输运理论的既定原理为科学基础。欧姆电流和自举电流的模型是聚变科学中使用的标准简化形式。控制方程 $\\nabla \\cdot \\mathbf{j} = 0$ 是稳恒电流的电磁学基本定律。所有必要的参数都已提供，并且其数值对于托卡马克是物理上现实的。该问题的结构要求先进行第一性原理的论证，然后进行计算，这是一种有效的教学方法，可以测试概念理解和应用能力。$\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle$ 为零的前提是该理论的一个基石性结果，问题的结构旨在验证对此的理解。不存在科学缺陷、矛盾或含糊之处。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答推导\n\n按照问题要求，解答分为两部分：首先，论证磁通面平均的 Pfirsch–Schlüter 电流为零；其次，计算各电流组分的分数。\n\n**第一部分：关于 $\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle = 0$ 的论证**\n\n在稳态等离子体中，为保证电荷守恒，电流密度 $\\mathbf{j}$ 必须是无散的，如连续性方程 $\\nabla \\cdot \\mathbf{j} = 0$ 所述。总电流密度可以分解为平行于和垂直于磁场 $\\mathbf{B}$ 的分量：\n$$\n\\mathbf{j} = j_{\\parallel} \\mathbf{b} + \\mathbf{j}_{\\perp}\n$$\n其中 $\\mathbf{b} = \\mathbf{B}/B$ 是沿磁场方向的单位矢量。将此代入连续性方程得到：\n$$\n\\nabla \\cdot (j_{\\parallel} \\mathbf{b}) + \\nabla \\cdot \\mathbf{j}_{\\perp} = 0\n$$\n在一个简单的圆柱形等离子体中，磁场在磁通面上是均匀的，而垂直电流（主要由抗磁电流 $\\mathbf{j}_{\\perp} \\approx (\\mathbf{B} \\times \\nabla p)/B^2$ 主导）是无散的，因此不需要平行电流来维持电荷守恒。\n\n然而，在像托卡马克这样的环形几何中，磁场强度在磁通面上变化，通常为 $B \\propto 1/(1+\\epsilon \\cos\\theta)$，其中 $\\theta$ 是极向角。这种 $B$ 的变化以及磁力线的曲率，导致垂直电流的散度 $\\nabla \\cdot \\mathbf{j}_{\\perp}$ 不为零。该散度具有极向角依赖性（例如，与 $\\sin\\theta$ 成正比），但其磁通面平均值 $\\langle \\nabla \\cdot \\mathbf{j}_{\\perp} \\rangle$ 为零。\n\n为了在磁通面上的每一点都满足 $\\nabla \\cdot \\mathbf{j} = 0$，必须有一个随极向角变化的平行电流来局部抵消垂直电流的散度。这个电流被称为 Pfirsch–Schlüter (PS) 电流，即 $j_{\\parallel}^{\\mathrm{PS}}$。它被定义为以下方程的解：\n$$\n\\nabla \\cdot (j_{\\parallel}^{\\mathrm{PS}} \\mathbf{b}) = - \\nabla \\cdot \\mathbf{j}_{\\perp}\n$$\n总平行电流密度 $j_{\\parallel}$ 可以形式上分解为其磁通面平均值 $\\langle j_{\\parallel} \\rangle$ 和一个随极向角变化的部分 $\\tilde{j}_{\\parallel}$：\n$$\nj_{\\parallel}(\\psi, \\theta) = \\langle j_{\\parallel} \\rangle(\\psi) + \\tilde{j}_{\\parallel}(\\psi, \\theta)\n$$\n根据定义，变化部分的磁通面平均值为零：$\\langle \\tilde{j}_{\\parallel} \\rangle = 0$。\n\nPfirsch-Schlüter 电流正是这个随极向角变化的分量，即 $j_{\\parallel}^{\\mathrm{PS}} \\equiv \\tilde{j}_{\\parallel}$，它是为了响应随极向角变化的源项 $- \\nabla \\cdot \\mathbf{j}_{\\perp}$ 而产生的。磁通面平均电流 $\\langle j_{\\parallel} \\rangle$ 是由在磁通面上恒定的源驱动的，例如外部施加的环向电场（欧姆驱动）和捕获粒子轨道对压力梯度的净效应（自举电流）。\n\n因此，根据其定义——作为闭合垂直电流回路的、随极向角变化的平行电流分量——Pfirsch–Schlüter 电流的磁通面平均值必须为零。\n$$\n\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle = 0\n$$\n\n**第二部分：电流分数的计算**\n\n基于第一部分的结论，由 Pfirsch-Schlüter 机制承载的磁通面平均平行电流的分数为：\n$$\nf_{\\mathrm{PS}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{PS}} \\rangle}{\\langle j_{\\parallel} \\rangle} = \\frac{0}{\\langle j_{\\parallel} \\rangle} = 0\n$$\n总的磁通面平均平行电流是欧姆分量和自举分量之和：\n$$\n\\langle j_{\\parallel} \\rangle = \\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle + \\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle\n$$\n我们现在使用所提供的数据计算每个分量。\n\n问题陈述 $E_{\\parallel} \\approx E_{\\phi}$。欧姆分量为：\n$$\n\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle = \\sigma_{\\parallel} E_{\\phi}\n$$\n代入给定值：\n$$\n\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle = (2.0 \\times 10^{6} \\text{ S/m}) \\times (0.050 \\text{ V/m}) = 1.0 \\times 10^{5} \\text{ A/m}^2\n$$\n自举分量由下式给出：\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = - \\alpha \\frac{q}{\\epsilon B} \\frac{dp}{dr}\n$$\n代入给定值：\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = - (0.75) \\frac{2.0}{(0.20)(3.0 \\text{ T})} (-6.0 \\times 10^{4} \\text{ Pa/m})\n$$\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = - (0.75) \\frac{2.0}{0.60} (-6.0 \\times 10^{4}) \\text{ A/m}^2\n$$\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = (0.75) \\left(\\frac{1}{0.30}\\right) (6.0 \\times 10^{4}) \\text{ A/m}^2\n$$\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = (0.75) \\left(\\frac{10}{3}\\right) (6.0 \\times 10^{4}) \\text{ A/m}^2 = (0.25) \\times 10 \\times (6.0 \\times 10^{4}) \\text{ A/m}^2\n$$\n$$\n\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle = 1.5 \\times 10^{5} \\text{ A/m}^2\n$$\n总的磁通面平均平行电流密度为：\n$$\n\\langle j_{\\parallel} \\rangle = (1.0 \\times 10^{5} \\text{ A/m}^2) + (1.5 \\times 10^{5} \\text{ A/m}^2) = 2.5 \\times 10^{5} \\text{ A/m}^2\n$$\n现在我们可以计算所需的分数，并四舍五入到四位有效数字。\n\n欧姆分量的分数：\n$$\nf_{\\mathrm{Ohm}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{Ohm}} \\rangle}{\\langle j_{\\parallel} \\rangle} = \\frac{1.0 \\times 10^{5}}{2.5 \\times 10^{5}} = 0.4\n$$\n保留四位有效数字，即为 $0.4000$。\n\nPfirsch-Schlüter 分量的分数：\n$$\nf_{\\mathrm{PS}} = 0\n$$\n保留四位有效数字，即为 $0.0000$。\n\n自举分量的分数：\n$$\nf_{\\mathrm{bs}} = \\frac{\\langle j_{\\parallel}^{\\mathrm{bs}} \\rangle}{\\langle j_{\\parallel} \\rangle} = \\frac{1.5 \\times 10^{5}}{2.5 \\times 10^{5}} = 0.6\n$$\n保留四位有效数字，即为 $0.6000$。\n\n各分数之和为 $f_{\\mathrm{Ohm}} + f_{\\mathrm{PS}} + f_{\\mathrm{bs}} = 0.4 + 0 + 0.6 = 1.0$，这可作为一致性检验。\n\n最终答案是这三个分数的行向量。\n$$\n\\left( f_{\\mathrm{Ohm}} \\ \\ f_{\\mathrm{PS}} \\ \\ f_{\\mathrm{bs}} \\right) = \\left( 0.4000 \\ \\ 0.0000 \\ \\ 0.6000 \\right)\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.4000  0.0000  0.6000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "等离子体电阻率和电导率的宏观模型依赖于输运系数，而这些系数最终由微观粒子动理学决定。要构建具有预测能力的计算模型，理解如何从第一性原理推导这些系数是至关重要的。这项高级实践将指导你求解线性化漂移动理学方程，以计算平行电导率 $\\sigma_\\parallel$。通过实施一个基于勒让德多项式展开的数值方案，你将在动理学理论和一个可计算的宏观输运参数之间建立起桥梁 。",
            "id": "4017810",
            "problem": "您的任务是构建一个自洽的数值方案，使用投掷角展开和能量网格来计算强磁化、轴对称等离子体中电子的平行电导率 $\\,\\sigma_\\parallel\\,$。推导和算法必须从适用于计算聚变科学与工程的基本原理和定义出发，并且必须避免引用预先推导出的简化公式。程序必须实现该计算，并为指定的测试套件生成结果。\n\n考虑一个具有均匀磁场方向和空间均匀平行电场 $\\,E_\\parallel\\,$ 的均匀等离子体。令 $\\,f(\\boldsymbol{v}) = f_0(v) + f_1(v,\\xi)\\,$ 为电子分布函数，其中 $\\,f_0(v)\\,$ 是各向同性局域麦克斯韦分布，$\\,f_1(v,\\xi)\\,$ 是由 $\\,E_\\parallel\\,$ 引起的一阶微扰。投掷角变量为 $\\,\\xi = v_\\parallel / v \\in [-1,1]\\,$。在这些条件下，电子的线性漂移动理学方程 (DKE) 为\n$$\nv_\\parallel \\nabla_\\parallel f_1(v,\\xi) + \\frac{e E_\\parallel}{m_e} \\frac{\\partial f_0(v)}{\\partial v_\\parallel} = C[f_1],\n$$\n其中 $\\,e\\,$ 是元电荷，$\\,m_e\\,$ 是电子质量，$\\,C[\\cdot]\\,$ 是线性化碰撞算符。假设沿场线方向空间均匀，因此 $\\,\\nabla_\\parallel f_1 = 0\\,$。通过用于电子-离子偏转的 Lorentz 投掷角散射算符来模拟碰撞，\n$$\nC_L[f_1] = \\nu_D(v) \\frac{\\partial}{\\partial \\xi} \\left[(1-\\xi^2)\\frac{\\partial f_1}{\\partial \\xi}\\right],\n$$\n其中偏转频率 $\\,\\nu_D(v)\\,$ 取为\n$$\n\\nu_D(v) = \\frac{n_i Z_i^2 e^4 \\ln \\Lambda}{4\\pi \\varepsilon_0^2 m_e^2 v^3},\n$$\n其中 $\\,n_i\\,$ 是离子密度，$\\,Z_i\\,$ 是离子电荷态，$\\,\\ln \\Lambda\\,$ 是库仑对数，$\\,\\varepsilon_0\\,$ 是真空介电常数。\n\n将微扰展开为 Legendre 多项式 $\\,P_\\ell(\\xi)\\,$：\n$$\nf_1(v,\\xi) = \\sum_{\\ell=0}^{L_{\\max}} g_\\ell(v) P_\\ell(\\xi).\n$$\n利用 $\\,P_\\ell\\,$ 的正交性和 $\\,C_L\\,$ 对角谐波的作用，推导出 $\\,g_\\ell(v)\\,$ 的一维方程，并解释 $\\,\\ell=1\\,$ 分量如何通过 $\\,\\partial f_0/\\partial v_\\parallel\\,$ 被平行电场驱动。令 $\\,f_0(v)\\,$ 为各向同性麦克斯韦分布，\n$$\nf_0(v) = n_e \\left(\\frac{m_e}{2\\pi T_e}\\right)^{3/2} \\exp\\!\\left(-\\frac{m_e v^2}{2 T_e}\\right),\n$$\n其中 $\\,n_e\\,$ 是电子密度，$\\,T_e\\,$ 是以焦耳为单位的电子温度。\n\n定义平行电流密度 $\\,J_\\parallel\\,$ 为\n$$\nJ_\\parallel = -e \\int v_\\parallel f_1(\\boldsymbol{v})\\, d^3 v,\n$$\n并通过电子响应定义平行电导率\n$$\n\\sigma_\\parallel \\equiv -\\frac{J_\\parallel}{E_\\parallel},\n$$\n从而使 $\\,\\sigma_\\parallel\\,$ 在常规欧姆意义上为正。\n\n您必须：\n- 在 Lorentz 投掷角散射算符下，推导出 $\\,g_1(v)\\,$ 的解耦方程，并用 $\\,g_1(v)\\,$ 以及对 $\\,v\\,$ 和 $\\,\\xi\\,$ 的速度空间积分来表示 $\\,J_\\parallel\\,$。使用 $\\,P_\\ell(\\xi)\\,$ 的正交关系来进行角度积分。\n- 将剩余的速度积分变换为能量积分 $\\,\\varepsilon = m_e v^2 / 2\\,$，能量网格在 $\\,\\varepsilon \\in [0,\\varepsilon_{\\max}]\\,$ 上有 $\\,N_\\varepsilon\\,$ 个点，其中 $\\,\\varepsilon_{\\max} = \\alpha T_e\\,$ 且 $\\,\\alpha > 0\\,$ 是一个能量范围因子。指明 $\\,v\\,$ 和测度 $\\,dv\\,$ 如何映射到 $\\,\\varepsilon\\,$ 和 $\\,d\\varepsilon\\,$。\n- 在能量网格上构建一个梯形法则求积来计算 $\\,\\sigma_\\parallel\\,$，并保持量纲一致性。所有量必须采用国际单位制 (SI)，其中以电子伏特为单位提供的 $\\,T_e\\,$ 需通过 $\\,T_e^{(\\mathrm{J})} = T_e^{(\\mathrm{eV})} e\\,$ 转换为焦耳。\n\n收敛标准：\n- 能量网格细化：令 $\\,\\sigma_\\parallel(N_\\varepsilon)\\,$ 为用 $\\,N_\\varepsilon\\,$ 个点计算出的电导率。如果满足以下条件，则定义能量网格收敛布尔值为真：\n$$\n\\left|\\frac{\\sigma_\\parallel(2 N_\\varepsilon) - \\sigma_\\parallel(N_\\varepsilon)}{\\sigma_\\parallel(2 N_\\varepsilon)}\\right|  \\tau_N,\n$$\n容差 $\\,\\tau_N = 10^{-3}\\,$。\n- 投掷角展开阶数：用 $\\,L_{\\max}=1\\,$ 和 $\\,L_{\\max}=3\\,$ 计算 $\\,\\sigma_\\parallel\\,$，如果满足以下条件，则定义投掷角展开收敛布尔值为真：\n$$\n\\left|\\frac{\\sigma_\\parallel(L_{\\max}=3) - \\sigma_\\parallel(L_{\\max}=1)}{\\sigma_\\parallel(L_{\\max}=3)}\\right|  \\tau_L,\n$$\n容差 $\\,\\tau_L = 10^{-8}\\,$。\n- 能量范围因子：用 $\\,\\alpha\\,$ 和 $\\,1.3\\alpha\\,$ 计算 $\\,\\sigma_\\parallel\\,$，如果满足以下条件，则定义能量范围收敛布尔值为真：\n$$\n\\left|\\frac{\\sigma_\\parallel(1.3\\alpha) - \\sigma_\\parallel(\\alpha)}{\\sigma_\\parallel(1.3\\alpha)}\\right|  \\tau_R,\n$$\n容差 $\\,\\tau_R = 10^{-3}\\,$。\n\n您的程序必须实现上述数值方案，并为以下测试套件生成输出。每个测试用例以元组 $\\, (n_e, Z_i, T_e^{(\\mathrm{eV})}, \\ln \\Lambda, E_\\parallel, N_\\varepsilon, \\alpha)\\,$ 的形式给出：\n1. $\\, (1.0\\times 10^{20}\\,\\mathrm{m}^{-3}, 1.0, 5000.0\\,\\mathrm{eV}, 17.0, 0.1\\,\\mathrm{V/m}, 200, 5.0)\\,$\n2. $\\, (1.0\\times 10^{20}\\,\\mathrm{m}^{-3}, 1.0, 20000.0\\,\\mathrm{eV}, 17.0, 0.1\\,\\mathrm{V/m}, 50, 5.0)\\,$\n3. $\\, (1.0\\times 10^{18}\\,\\mathrm{m}^{-3}, 1.0, 500.0\\,\\mathrm{eV}, 15.0, 1.0\\,\\mathrm{V/m}, 32, 4.0)\\,$\n4. $\\, (5.0\\times 10^{19}\\,\\mathrm{m}^{-3}, 2.0, 10000.0\\,\\mathrm{eV}, 18.0, 0.5\\,\\mathrm{V/m}, 100, 6.0)\\,$\n\n最终输出格式：\n- 将每个计算出的 $\\,\\sigma_\\parallel\\,$ 以西门子/米 (S/m) 为单位表示，并四舍五入为六位有效数字的浮点数。\n- 对于每个测试用例，按顺序输出四个项目：$\\,\\sigma_\\parallel\\,$、能量网格收敛布尔值、投掷角展开收敛布尔值、能量范围收敛布尔值。\n- 您的程序应生成单行输出，其中包含所有测试用例的所有项目，形式为用逗号分隔并包含在方括号中的列表，例如 $\\, [\\sigma_1,\\text{bool}_{1,N},\\text{bool}_{1,L},\\text{bool}_{1,R},\\sigma_2,\\ldots]\\,$。\n\n您的实现必须是一个完整、可运行的程序，且不得需要任何外部输入或文件。仅使用 Python 标准库和执行环境中指定的库。确保您的常数和计算具有数值稳定性和科学合理性。",
            "solution": "该问题被认为是有效的，因为它科学地基于已建立的等离子体动理学理论，是适定的、客观的，并为可解的数值任务提供了一套完整且一致的定义和参数。\n\n分析始于均匀等离子体中具有均匀平行电场 $\\,E_\\parallel\\,$ 的线性化电子漂移动理学方程 (DKE)，并假设空间均匀性 ($\\,\\nabla_\\parallel f_1 = 0\\,$)：\n$$\n\\frac{e E_\\parallel}{m_e} \\frac{\\partial f_0(v)}{\\partial v_\\parallel} = C[f_1]\n$$\n此处，$\\,e\\,$ 是元电荷，$\\,m_e\\,$ 是电子质量，$\\,f_0(v)\\,$ 是各向同性麦克斯韦分布，$\\,f_1(v,\\xi)\\,$ 是动理学微擾。碰撞算符 $\\,C[\\cdot]\\,$ 是 Lorentz 投掷角散射算符 $\\,C_L[\\cdot]\\,$：\n$$\nC_L[f_1] = \\nu_D(v) \\frac{\\partial}{\\partial \\xi} \\left[(1-\\xi^2)\\frac{\\partial f_1}{\\partial \\xi}\\right]\n$$\n其中 $\\,\\xi = v_\\parallel/v\\,$ 是投掷角余弦，$\\,\\nu_D(v)\\,$ 是速度依赖的偏转频率。\n\n微擾 $\\,f_1\\,$ 在 Legendre 多项式 $\\,P_\\ell(\\xi)\\,$ 中展开：\n$$\nf_1(v,\\xi) = \\sum_{\\ell=0}^{L_{\\max}} g_\\ell(v) P_\\ell(\\xi)\n$$\n我们将 DKE 投影到 Legendre 基上，以寻找展开系数 $\\,g_\\ell(v)\\,$ 的方程。\n\n首先，我们分析源项（左侧）。麦克斯韦分布 $\\,f_0(v) = n_e (m_e/2\\pi T_e)^{3/2} \\exp(-m_e v^2/2T_e)\\,$ 仅依赖于速率 $\\,v\\,$。使用链式法则，关于平行速度 $\\,v_\\parallel\\,$ 的导数为：\n$$\n\\frac{\\partial f_0}{\\partial v_\\parallel} = \\frac{\\partial f_0}{\\partial v} \\frac{\\partial v}{\\partial v_\\parallel} = \\left(-\\frac{m_e v}{T_e} f_0(v)\\right) \\left(\\frac{v_\\parallel}{v}\\right) = -\\frac{m_e v}{T_e} f_0(v) \\xi\n$$\n由于 $\\,P_1(\\xi) = \\xi\\,$，DKE 的源项是：\n$$\n\\frac{e E_\\parallel}{m_e} \\frac{\\partial f_0}{\\partial v_\\parallel} = -\\frac{e E_\\parallel v}{T_e} f_0(v) P_1(\\xi)\n$$\n该源项纯粹处于 $\\,\\ell=1\\,$ Legendre 模。\n\n接下来，我们分析碰撞项（右侧）。$\\,C_L\\,$ 中的角算符是 Legendre 算符，对于该算符，$\\,P_\\ell(\\xi)\\,$ 是其本征函数，特征值为 $\\,-\\ell(\\ell+1)\\,$：\n$$\n\\frac{\\partial}{\\partial \\xi} \\left[(1-\\xi^2)\\frac{\\partial P_\\ell(\\xi)}{\\partial \\xi}\\right] = -\\ell(\\ell+1) P_\\ell(\\xi)\n$$\n将碰撞算符应用于 $\\,f_1\\,$ 的展开式，得到：\n$$\nC_L[f_1] = \\nu_D(v) \\sum_{\\ell=0}^{L_{\\max}} g_\\ell(v) [-\\ell(\\ell+1) P_\\ell(\\xi)]\n$$\n因此，DKE 变为：\n$$\n-\\frac{e E_\\parallel v}{T_e} f_0(v) P_1(\\xi) = -\\nu_D(v) \\sum_{\\ell=0}^{L_{\\max}} \\ell(\\ell+1) g_\\ell(v) P_\\ell(\\xi)\n$$\n根据 Legendre 多项式的正交性，我们可以令等式两边每个 $\\,P_\\ell(\\xi)\\,$ 的系数相等。\n对于 $\\,\\ell=0\\,$，两边的系数均为零，所以 $\\,g_0\\,$ 未定。然而，粒子数守恒要求 $\\,\\int f_1 d^3v = 0\\,$，这意味着 $\\,g_0(v) = 0\\,$。\n对于 $\\,\\ell=1\\,$，我们令系数相等：\n$$\n-\\frac{e E_\\parallel v}{T_e} f_0(v) = -1(1+1) \\nu_D(v) g_1(v) = -2 \\nu_D(v) g_1(v)\n$$\n解出 $\\,g_1(v)\\,$ 得：\n$$\ng_1(v) = \\frac{e E_\\parallel v}{2 T_e \\nu_D(v)} f_0(v)\n$$\n对于所有 $\\,\\ell > 1\\,$，源项系数为零，导致：\n$$\n0 = -\\ell(\\ell+1) \\nu_D(v) g_\\ell(v) \\implies g_\\ell(v) = 0 \\quad \\text{for } \\ell > 1\n$$\n这是一个关键结果：对于 Lorentz 碰撞算符，电场只驱动分布函数的 $\\,\\ell=1\\,$ 分量，并且与更高阶模没有耦合。因此，当截断在 $L_{\\max}=1$ 时，解是精确的。用 $L_{\\max}=3$ 进行的计算将产生相同的结果，使得投掷角展开收敛性测试平凡为真。\n\n平行电流密度 $\\,J_\\parallel\\,$ 定义为：\n$$\nJ_\\parallel = -e \\int v_\\parallel f_1(\\boldsymbol{v})\\, d^3 v\n$$\n使用球速度坐标系（$\\,v, \\xi, \\phi\\,$），体积元为 $\\,d^3v = 2\\pi v^2 dv d\\xi\\,$。代入 $\\,v_\\parallel = v\\xi = vP_1(\\xi)\\,$ 和 $\\,f_1(v,\\xi) = g_1(v)P_1(\\xi)\\,$：\n$$\nJ_\\parallel = -e \\int_0^\\infty dv \\int_{-1}^1 d\\xi \\, [v P_1(\\xi)] [g_1(v) P_1(\\xi)] (2\\pi v^2) = -2\\pi e \\int_0^\\infty v^3 g_1(v) dv \\int_{-1}^1 [P_1(\\xi)]^2 d\\xi\n$$\n使用正交关系 $\\,\\int_{-1}^1 [P_1(\\xi)]^2 d\\xi = 2/3\\,$，我们得到：\n$$\nJ_\\parallel = -2\\pi e \\left(\\frac{2}{3}\\right) \\int_0^\\infty v^3 g_1(v) dv = -\\frac{4\\pi e}{3} \\int_0^\\infty v^3 g_1(v) dv\n$$\n平行电导率 $\\,\\sigma_\\parallel\\,$ 由 $\\,J_\\parallel = -\\sigma_\\parallel E_\\parallel\\,$ 定义（问题中的定义是 $\\sigma_\\parallel = -J_\\parallel/E_\\parallel$ 以确保 $\\sigma_\\parallel>0$）。代入 $\\,g_1(v)\\,$ 的表达式：\n$$\n\\sigma_\\parallel = -\\frac{J_\\parallel}{E_\\parallel} = \\frac{4\\pi e}{3E_\\parallel} \\int_0^\\infty v^3 \\left(\\frac{e E_\\parallel v}{2 T_e \\nu_D(v)} f_0(v)\\right) dv = \\frac{2\\pi e^2}{3 T_e} \\int_0^\\infty \\frac{v^4}{\\nu_D(v)} f_0(v) dv\n$$\n为了进行数值积分，我们将积分从速度 $\\,v\\,$ 变换为动能 $\\,\\varepsilon = m_e v^2/2\\,$。\n变量映射为 $\\,v = \\sqrt{2\\varepsilon/m_e}\\,$。微分测度可以从麦克斯韦-玻尔兹曼能量分布 $\\,F(\\varepsilon)\\,$ 导出，其中 $\\,F(\\varepsilon)d\\varepsilon = f_0(v) 4\\pi v^2 dv\\,$。\n$$\nf_0(v) 4\\pi v^2 dv = n_e \\left(\\frac{m_e}{2\\pi T_e}\\right)^{3/2} \\exp(-\\varepsilon/T_e) \\cdot 4\\pi \\left(\\frac{2\\varepsilon}{m_e}\\right) \\frac{d\\varepsilon}{\\sqrt{2m_e\\varepsilon}} = \\frac{2n_e}{\\sqrt{\\pi}T_e^{3/2}} \\sqrt{\\varepsilon} \\exp(-\\varepsilon/T_e)d\\varepsilon\n$$\n将电导率积分重写为：\n$$\n\\sigma_\\parallel = \\frac{e^2}{3T_e} \\int_0^\\infty \\frac{v^2}{\\nu_D(v)} (4\\pi v^2 f_0(v))dv\n$$\n并代入 $\\,v^2\\,$ 和 $\\,(4\\pi v^2 f_0(v))dv\\,$ 的能量空间表达式：\n$$\n\\sigma_\\parallel = \\frac{e^2}{3T_e} \\int_0^\\infty \\frac{2\\varepsilon/m_e}{\\nu_D(\\varepsilon)} \\left(\\frac{2n_e}{\\sqrt{\\pi}T_e^{3/2}} \\sqrt{\\varepsilon} e^{-\\varepsilon/T_e}\\right)d\\varepsilon = \\frac{4n_e e^2}{3m_e\\sqrt{\\pi}T_e^{5/2}} \\int_0^\\infty \\frac{\\varepsilon^{3/2}}{\\nu_D(\\varepsilon)} e^{-\\varepsilon/T_e} d\\varepsilon\n$$\n偏转频率为 $\\,\\nu_D(v) = C_\\nu v^{-3}\\,$，其中 $\\,C_\\nu = \\frac{n_i Z_i^2 e^4 \\ln\\Lambda}{4\\pi\\varepsilon_0^2 m_e^2}\\,$。用能量表示，$\\,\\nu_D(\\varepsilon) = C_\\nu (2\\varepsilon/m_e)^{-3/2}\\,$。\n因此，$\\,\\frac{1}{\\nu_D(\\varepsilon)} = \\frac{(2\\varepsilon/m_e)^{3/2}}{C_\\nu}\\,$。将其代入积分中得到：\n$$\n\\sigma_\\parallel = \\frac{4n_e e^2}{3m_e\\sqrt{\\pi}T_e^{5/2}} \\int_0^\\infty \\varepsilon^{3/2} \\frac{(2\\varepsilon/m_e)^{3/2}}{C_\\nu} e^{-\\varepsilon/T_e} d\\varepsilon = \\frac{4n_e e^2}{3m_e\\sqrt{\\pi}T_e^{5/2}} \\frac{(2/m_e)^{3/2}}{C_\\nu} \\int_0^\\infty \\varepsilon^3 e^{-\\varepsilon/T_e} d\\varepsilon\n$$\n代入 $\\,C_\\nu\\,$ 并使用准中性条件 $\\,n_e = Z_i n_i\\,$ 可以简化前置因子：\n$$\n\\sigma_\\parallel = \\frac{16\\sqrt{2\\pi}\\varepsilon_0^2}{3 Z_i e^2 m_e^{1/2} \\ln \\Lambda \\cdot T_e^{5/2}} \\int_0^{\\varepsilon_{\\max}} \\varepsilon^3 e^{-\\varepsilon/T_e} d\\varepsilon\n$$\n这是需要数值计算的最终表达式。积分使用梯形法则在 $\\,N_\\varepsilon\\,$ 个点的均匀网格上从 $\\,0\\,$ 到 $\\,\\varepsilon_{\\max} = \\alpha T_e\\,$ 进行计算。被积函数 $\\,\\varepsilon^3 e^{-\\varepsilon/T_e}\\,$ 在 $\\,\\varepsilon=0\\,$ 处为零，因此在积分下限不会出现奇点。\n\n数值方案如下：\n1.  对于每个测试用例，定义一个函数，根据参数 $\\,(n_e, Z_i, T_e, \\ln\\Lambda, N_\\varepsilon, \\alpha)\\,$ 计算 $\\,\\sigma_\\parallel\\,$。该函数在内部将 $\\,T_e\\,$ 从 eV 转换为焦耳。\n2.  函数构建一个在 $\\,\\varepsilon \\in [0, \\alpha T_e]\\,$ 上有 $\\,N_\\varepsilon\\,$ 个点的均匀能量网格。\n3.  它在该网格上计算被积函数 $\\,I(\\varepsilon) = \\varepsilon^3 e^{-\\varepsilon/T_e}\\,$。\n4.  它使用梯形法则实现（例如 `numpy.trapz`）来计算积分。\n5.  它将积分结果乘以推导出的前置因子，以获得 $\\,\\sigma_\\parallel\\,$。\n6.  对于每个测试用例，主程序使用不同的参数（$\\,(N_\\varepsilon, \\alpha)\\,$、$\\,(2N_\\varepsilon, \\alpha)\\,$ 和 $\\,(N_\\varepsilon, 1.3\\alpha)\\,$）调用此函数三次，以执行能量网格和能量范围的收敛性测试。\n7.  基于对于 Lorentz 算符 $\\,g_\\ell=0\\,$（$\\ell>1$）的解析结果，投掷角展开收敛布尔值被设为 `True`。\n8.  所有测试用例的最终结果（电导率和三个布尔值）被收集并以指定格式打印。",
            "answer": "```python\nimport numpy as np\nimport math\n\n# Meticulous and exacting professor in the STEM fields.\n# Uncompromising about scientific correctness, logical consistency, and objectivity.\n\n# Physical constants in SI units\nE_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\nM_ELECTRON = 9.1093837015e-31  # Electron mass in kg\nEPSILON_0 = 8.8541878128e-12  # Vacuum permittivity in F/m\n\ndef format_sigfig(value, sigfigs):\n    \"\"\"\n    Rounds a float to a specified number of significant figures and returns a string.\n    This function is used for formatting the final output as requested.\n    \"\"\"\n    if value == 0:\n        return '0.0'\n    return f\"{value:.{sigfigs}g}\"\n\ndef compute_conductivity(n_e, Z_i, T_e_eV, ln_Lambda, N_eps, alpha):\n    \"\"\"\n    Computes the parallel electrical conductivity sigma_parallel.\n\n    The derivation shows that sigma_parallel for the Lorentz model is:\n    sigma = Prefactor * Integral\n\n    Prefactor = (16 * sqrt(2*pi) * eps0^2) / (3 * Z_i * e^2 * m_e^0.5 * ln_Lambda * T_e^2.5)\n    Integral = integral from 0 to eps_max of [eps^3 * exp(-eps/T_e)] d_eps\n\n    Note: The conductivity in this model is independent of electron density n_e,\n    a characteristic of the Spitzer-Härm problem. The parameter n_e is\n    retained for consistency with the problem statement's test case format.\n    \"\"\"\n    # 1. Convert temperature to Joules and define integration limit\n    T_e_J = T_e_eV * E_CHARGE\n    eps_max = alpha * T_e_J\n\n    # 2. Set up the energy grid for numerical integration\n    # The grid has N_eps points from 0 to eps_max, inclusive.\n    eps_grid = np.linspace(0, eps_max, N_eps)\n\n    # 3. Evaluate the integrand on the grid\n    # The integrand is I(eps) = eps^3 * exp(-eps / T_e_J).\n    integrand_values = eps_grid**3 * np.exp(-eps_grid / T_e_J)\n\n    # 4. Perform the numerical integration using the trapezoidal rule\n    integral_result = np.trapz(integrand_values, eps_grid)\n\n    # 5. Calculate the overall prefactor for sigma_parallel\n    prefactor_num = 16.0 * np.sqrt(2.0 * np.pi) * EPSILON_0**2\n    prefactor_den = 3.0 * Z_i * E_CHARGE**2 * np.sqrt(M_ELECTRON) * ln_Lambda\n    \n    # an additional factor of 1/T_e^2.5 is needed\n    conductivity = (prefactor_num / prefactor_den) * integral_result / (T_e_J**2.5)\n    \n    return conductivity\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and produce the final output.\n    \"\"\"\n    # Test cases from the problem statement:\n    # (n_e, Z_i, T_e_eV, ln_Lambda, E_parallel, N_eps, alpha)\n    test_cases = [\n        (1.0e20, 1.0, 5000.0, 17.0, 0.1, 200, 5.0),\n        (1.0e20, 1.0, 20000.0, 17.0, 0.1, 50, 5.0),\n        (1.0e18, 1.0, 500.0, 15.0, 1.0, 32, 4.0),\n        (5.0e19, 2.0, 10000.0, 18.0, 0.5, 100, 6.0),\n    ]\n\n    results = []\n    \n    # Convergence tolerances\n    TAU_N = 1e-3  # for energy-grid refinement\n    TAU_L = 1e-8  # for pitch-angle expansion order\n    TAU_R = 1e-3  # for energy-range factor\n\n    for case in test_cases:\n        n_e, Z_i, T_e_eV, ln_L, _, N_eps, alpha = case\n\n        # --- Base Calculation ---\n        sigma_base = compute_conductivity(n_e, Z_i, T_e_eV, ln_L, N_eps, alpha)\n\n        # --- Convergence Checks ---\n\n        # 1. Energy-grid convergence\n        sigma_N_refined = compute_conductivity(n_e, Z_i, T_e_eV, ln_L, 2 * N_eps, alpha)\n        # Avoid division by zero if conductivity is zero\n        if sigma_N_refined != 0:\n            rel_diff_N = abs((sigma_N_refined - sigma_base) / sigma_N_refined)\n            conv_N = rel_diff_N  TAU_N\n        else:\n            conv_N = (sigma_base == 0)\n\n        # 2. Pitch-angle expansion convergence\n        # As derived in the solution, for the Lorentz pitch-angle scattering operator, only the\n        # l=1 Legendre mode (g_1) is driven by the electric field, and it does not couple\n        # to higher-order modes (g_l=0 for l>1). Thus, the conductivity is identical\n        # for L_max=1 and L_max=3. The relative difference is analytically zero.\n        # sigma(L_max=3) == sigma(L_max=1), so diff is 0, which is  TAU_L.\n        conv_L = True\n\n        # 3. Energy-range convergence\n        sigma_R_extended = compute_conductivity(n_e, Z_i, T_e_eV, ln_L, N_eps, 1.3 * alpha)\n        # Avoid division by zero if conductivity is zero\n        if sigma_R_extended != 0:\n            rel_diff_R = abs((sigma_R_extended - sigma_base) / sigma_R_extended)\n            conv_R = rel_diff_R  TAU_R\n        else:\n            conv_R = (sigma_base == 0)\n\n        # --- Collect Results ---\n        results.append(format_sigfig(sigma_base, 6))\n        results.append(str(conv_N))\n        results.append(str(conv_L))\n        results.append(str(conv_R))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}