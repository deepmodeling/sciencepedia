{
    "hands_on_practices": [
        {
            "introduction": "侵蚀始于高能等离子体离子对材料表面的轰击。这项练习将为你奠定计算离子轰击能量的基础，该能量由等离子体鞘层电势决定。通过从第一性原理推导悬浮鞘层电势，你将深入理解等离子体边界条件如何决定驱动溅射的能量 ()。",
            "id": "3975718",
            "problem": "在磁约束聚变等离子体中，撞击面向等离子体部件（PFC）的离子的能量由紧邻材料表面形成的鞘层决定。从具有麦克斯韦分布的电子和以玻姆速度进入鞘层的离子的无碰撞鞘层模型出发，将鞘层电势 $\\phi_{s}$ 定义为准中性等离子体边界与材料表面之间的静电电势降，$\\phi_{s} \\equiv \\phi_{p} - \\phi_{w} > 0$。对于浮动表面（即流向壁的净电流为零且次级电子发射可忽略不计），通过设定流向壁的离子和电子粒子通量相等，从第一性原理推导 $\\phi_{s}$。然后计算离子撞击能量\n$$E_{i} \\approx Z e \\,\\phi_{s} + \\frac{1}{2} m_{i} c_{s}^{2},$$\n其中 $Z$ 是离子电荷态，$e$ 是元电荷，$m_{i}$ 是离子质量，$c_{s} = \\sqrt{k_{B} T_{e} / m_{i}}$ 是离子声速，$k_{B}$ 是玻尔兹曼常数，$T_{e}$ 是电子温度。假设为氘离子（$\\text{D}^{+}$），因此 $Z = 1$，$T_{e} = 20\\,\\mathrm{eV}$，并采用浮动电势边界条件。取电子质量 $m_{e} = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\mathrm{kg}$，氘核质量 $m_{i} = 3.343\\,583\\,719 \\times 10^{-27}\\,\\mathrm{kg}$，元电荷 $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{C}$，以及玻尔兹曼常数 $k_{B} = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}$。以电子伏特表示最终的离子撞击能量，并将答案四舍五入到四位有效数字。",
            "solution": "该问题陈述经评估具有科学依据、问题明确、客观且自成体系，因此有必要提供完整解答。\n\n该问题要求推导简单等离子体中浮动表面上的离子撞击能量。这涉及两个主要步骤：首先，通过令粒子通量相等来推导鞘层电势 $\\phi_s$；其次，将离子在鞘层中获得的势能与在鞘层边界的初始动能相加，计算总能量。\n\n浮动表面是电学上孤立的表面，意味着它不从等离子体中吸收净电流。在由电子和单一离子种类组成的简单等离子体中，此条件意味着电子粒子通量 $\\Gamma_e$ 的大小必须等于离子粒子通量 $\\Gamma_i$。为方便起见，我们设鞘层边界的等离子体电势为 $\\phi_p = 0$，因此壁电势为 $\\phi_w = -\\phi_s$。\n\n离子通量 $\\Gamma_i$ 由进入鞘层的离子决定。根据稳定鞘层的玻姆判据，离子必须以至少等于离子声速 $c_s$ 的速度进入鞘层。我们假设它们恰好以此速度进入。因此，离子通量由下式给出：\n$$ \\Gamma_i = n_s c_s $$\n其中 $n_s$ 是鞘层边界的等离子体密度，$c_s$ 是离子声速，在问题中定义为：\n$$ c_s = \\sqrt{\\frac{k_B T_e}{m_i}} $$\n此处，$k_B$ 是玻尔兹曼常数，$T_e$ 是电子温度，$m_i$ 是离子质量。\n\n假设电子具有麦克斯韦速度分布。在没有电势的情况下，流向表面的电子随机热通量为 $\\frac{1}{4} n_s \\bar{v}_{th,e}$，其中 $\\bar{v}_{th,e}$ 是平均电子热速度。然而，表面相对于等离子体处于负电势 $\\phi_w = -\\phi_s$。该电势排斥电子，因此只有分布中高能尾部的具有足够动能的电子才能克服势垒到达表面。因此，电子通量被玻尔兹曼因子 $\\exp(e \\phi_w / (k_B T_e)) = \\exp(-e \\phi_s / (k_B T_e))$ 减小。流向壁的电子通量为：\n$$ \\Gamma_e = \\frac{1}{4} n_s \\bar{v}_{th,e} \\exp\\left(-\\frac{e \\phi_s}{k_B T_e}\\right) $$\n对于麦克斯韦分布，平均电子热速度为：\n$$ \\bar{v}_{th,e} = \\sqrt{\\frac{8 k_B T_e}{\\pi m_e}} $$\n其中 $m_e$ 是电子质量。\n\n现在，我们施加浮动条件 $\\Gamma_i = \\Gamma_e$：\n$$ n_s c_s = \\frac{1}{4} n_s \\bar{v}_{th,e} \\exp\\left(-\\frac{e \\phi_s}{k_B T_e}\\right) $$\n等离子体密度 $n_s$ 被消去：\n$$ c_s = \\frac{1}{4} \\bar{v}_{th,e} \\exp\\left(-\\frac{e \\phi_s}{k_B T_e}\\right) $$\n代入 $c_s$ 和 $\\bar{v}_{th,e}$ 的表达式：\n$$ \\sqrt{\\frac{k_B T_e}{m_i}} = \\frac{1}{4} \\sqrt{\\frac{8 k_B T_e}{\\pi m_e}} \\exp\\left(-\\frac{e \\phi_s}{k_B T_e}\\right) $$\n我们可以解出指数项：\n$$ \\exp\\left(-\\frac{e \\phi_s}{k_B T_e}\\right) = \\frac{4 \\sqrt{k_B T_e / m_i}}{\\sqrt{8 k_B T_e / (\\pi m_e)}} = 4 \\sqrt{\\frac{k_B T_e}{m_i} \\cdot \\frac{\\pi m_e}{8 k_B T_e}} = 4 \\sqrt{\\frac{\\pi m_e}{8 m_i}} = \\sqrt{\\frac{16 \\pi m_e}{8 m_i}} = \\sqrt{\\frac{2 \\pi m_e}{m_i}} $$\n为了求解 $\\phi_s$，我们对两边取自然对数：\n$$ -\\frac{e \\phi_s}{k_B T_e} = \\ln\\left(\\sqrt{\\frac{2 \\pi m_e}{m_i}}\\right) = \\frac{1}{2} \\ln\\left(\\frac{2 \\pi m_e}{m_i}\\right) $$\n电荷为 $Z e$ 的离子通过鞘层加速获得的势能是 $Z e \\phi_s$。对于氘离子，$Z=1$。\n$$ e \\phi_s = -\\frac{1}{2} k_B T_e \\ln\\left(\\frac{2 \\pi m_e}{m_i}\\right) = \\frac{1}{2} k_B T_e \\ln\\left(\\left(\\frac{2 \\pi m_e}{m_i}\\right)^{-1}\\right) = \\frac{1}{2} k_B T_e \\ln\\left(\\frac{m_i}{2 \\pi m_e}\\right) $$\n由于 $m_i \\gg m_e$，对数的自变量为大的正数，因此 $\\phi_s > 0$，符合要求。\n\n总的离子撞击能量 $E_i$ 是离子在鞘层中加速获得的势能与进入鞘层时的初始动能之和。\n$$ E_{i} = Z e \\,\\phi_{s} + \\frac{1}{2} m_{i} v_{i,s}^2 $$\n当 $Z=1$ 且初始离子速度 $v_{i,s} = c_s$ 时，初始动能为：\n$$ E_{k,initial} = \\frac{1}{2} m_i c_s^2 = \\frac{1}{2} m_i \\left(\\frac{k_B T_e}{m_i}\\right) = \\frac{1}{2} k_B T_e $$\n结合势能和动能的贡献：\n$$ E_i = \\left( \\frac{1}{2} k_B T_e \\ln\\left(\\frac{m_i}{2 \\pi m_e}\\right) \\right) + \\left( \\frac{1}{2} k_B T_e \\right) $$\n$$ E_i = \\frac{1}{2} k_B T_e \\left[ \\ln\\left(\\frac{m_i}{2 \\pi m_e}\\right) + 1 \\right] $$\n这就是离子撞击能量的最终解析表达式。\n\n为了进行数值计算，我们使用所提供的值。最方便的是用电子伏特（$\\mathrm{eV}$）来表示能量。设 $T_{e, \\mathrm{eV}}$ 是电子温度以 $\\mathrm{eV}$ 为单位的数值，即 $T_{e, \\mathrm{eV}} = 20$。能量 $k_B T_e$ 与 $T_{e, \\mathrm{eV}}$ 的关系为 $k_B T_e = e T_{e, \\mathrm{eV}}$。我们可以通过除以元电荷 $e$ 将 $E_i$ 表示为以 $\\mathrm{eV}$ 为单位的能量：\n$$ E_{i, \\mathrm{eV}} = \\frac{E_i}{e} = \\frac{1}{2e} (e T_{e, \\mathrm{eV}}) \\left[ \\ln\\left(\\frac{m_i}{2 \\pi m_e}\\right) + 1 \\right] = \\frac{1}{2} T_{e, \\mathrm{eV}} \\left[ \\ln\\left(\\frac{m_i}{2 \\pi m_e}\\right) + 1 \\right] $$\n现在，代入给定值：\n$T_{e, \\mathrm{eV}} = 20$\n$m_i = m_D = 3.343\\,583\\,719 \\times 10^{-27}\\,\\mathrm{kg}$\n$m_e = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\mathrm{kg}$\n\n首先，计算对数的自变量：\n$$ \\frac{m_i}{2 \\pi m_e} = \\frac{3.343583719 \\times 10^{-27}\\,\\mathrm{kg}}{2 \\pi (9.1093837015 \\times 10^{-31}\\,\\mathrm{kg})} \\approx 584.18964 $$\n现在，计算方括号中的表达式：\n$$ \\ln(584.18964) + 1 \\approx 6.370013 + 1 = 7.370013 $$\n最后，计算以 $\\mathrm{eV}$ 为单位的能量：\n$$ E_{i, \\mathrm{eV}} = \\frac{1}{2} (20) [7.370013] = 10 \\times 7.370013 = 73.70013\\,\\mathrm{eV} $$\n将结果四舍五入到四位有效数字，得到 $73.70\\,\\mathrm{eV}$。\n\n能量的结构很有启发性。初始动能为 $\\frac{1}{2} T_{e, \\mathrm{eV}} = \\frac{1}{2}(20\\,\\mathrm{eV}) = 10\\,\\mathrm{eV}$。获得的势能以焦耳为单位是 $e \\phi_s$，或者说电势降为 $\\phi_s$ 伏特。“鞘层电势系数”为 $\\Lambda = \\frac{e \\phi_s}{k_B T_e} = \\frac{1}{2} \\ln\\left(\\frac{m_i}{2 \\pi m_e}\\right) \\approx 3.185$。以 eV 为单位获得的势能为 $\\Lambda T_{e, \\mathrm{eV}} \\approx 3.185 \\times 20\\,\\mathrm{eV} \\approx 63.7\\,\\mathrm{eV}$。总能量是二者之和 $10\\,\\mathrm{eV} + 63.7\\,\\mathrm{eV} = 73.7\\,\\mathrm{eV}$，这验证了计算结果。",
            "answer": "$$\\boxed{73.70}$$"
        },
        {
            "introduction": "并非所有被溅射的材料都会永久损失；其中大部分会再沉积，但随后可能被再次侵蚀。这项练习构建了一个概率模型来描述这种多程循环，通过几何级数推导最终被保留下来的原子有效份额 ()。这个练习突显了如何运用简单的概率规则来捕捉复杂的、重复的表面相互作用过程。",
            "id": "3975771",
            "problem": "在磁约束聚变装置中，一个面向等离子体部件（PFC）受到稳态等离子体的作用，通过物理溅射侵蚀材料。考虑一个足够长的时间间隔，以至于瞬态效应可以忽略不计，此间有 $N_{0}$ 个原子被侵蚀，并假设以下具有物理动机且统计上平稳的描述符成立：\n- 由于局部几何形状和跨场输运，一部分比例为 $f \\in [0,1)$ 的被侵蚀原子会返回并再沉积到任意 PFC 表面上。这个比例 $f$ 包含了几何返回和到达时立即附着的过程。\n- 在随后的等离子体暴露中，每个再沉积的原子在每一轮中有 $r \\in [0,1)$ 的概率被再侵蚀，此事件独立于所有过去事件，并且在各轮次中都相同。如果一个再沉积的原子在某一轮中未被再侵蚀，则认为它被最终滞留。\n- 如果一个再沉积的原子在一轮中被再侵蚀，它在该轮中的后续命运同样由 $f$ 和 $r$ 描述：它有 $f$ 的概率再沉积到 PFC 上，有 $1-f$ 的概率逃逸并从 PFC 系统中丢失。假设所有原子都经历相同的平稳无记忆过程，并且质量守恒在每个事件中都适用。\n\n从粒子数守恒和概率的链式法则出发，解释再侵蚀如何产生侵蚀和再沉积的多轮循环。然后，通过明确地计算所有以最终滞留为结局的再侵蚀和再沉积序列，推导有效再沉积-滞留分数 $f_{\\text{red,eff}}$ 的封闭形式解析表达式，其定义为，经过任意多轮次后，最初被侵蚀的 $N_{0}$ 个原子中最终留在 PFC 表面上的期望分数。\n\n用 $f$ 和 $r$ 将你的最终答案表示为单个符号表达式。无需四舍五入，最终表达式中不应包含单位。确保你构建的级数在所述物理约束下是收敛的。",
            "solution": "该问题提出了一个关于面向等离子体部件（PFC）原子侵蚀和再沉积的平稳、无记忆的概率模型。我们需要推导有效再沉积-滞留分数 $f_{\\text{red,eff}}$，它表示初始被侵蚀的 $N_0$ 个原子在经历可能无限次的再侵蚀和再沉积事件后，最终滞留在 PFC 表面上的总分数。\n\n首先，我们根据问题陈述阐明侵蚀和再沉积的多轮循环，追踪原子群体在每个阶段的数量。我们从 PFC 表面被侵蚀的 $N_0$ 个初始原子开始。\n\n根据给定条件，这些原子中有比例为 $f$ 的部分会返回并再沉积。因此，在第一轮中再沉积的原子数量为 $N_0 f$。剩余的 $N_0(1-f)$ 个原子从系统中丢失。这 $N_0 f$ 个再沉积的原子现在在 PFC 表面上形成一个层。\n\n这些再沉积的原子随后暴露于等离子体中。一个再沉积的原子可能面临两种命运之一：要么最终被滞留，要么被再侵蚀。再侵蚀的概率是 $r$。因此，一个再沉积的原子*不*被再侵蚀，从而最终被滞留的概率是 $1-r$。\n\n在第一轮中再沉积的 $N_0 f$ 个原子中，此阶段最终被滞留的原子数量为 $N_{\\text{retained},1} = (N_0 f)(1-r)$。\n被再侵蚀的原子数量为 $(N_0 f)r$。\n\n这个再侵蚀事件启动了第二轮。这 $N_0 f r$ 个被再侵蚀的原子行为与最初的 $N_0$ 个原子相同，但按 $fr$ 的比例缩放。在这些被再侵蚀的原子中，一部分比例为 $f$ 的会再次再沉积。第二次再沉积的原子数量为 $(N_0 f r)f = N_0 f^2 r$。\n这些新再沉积的原子现在受到相同的滞留/再侵蚀概率的影响。从这第二批再沉积的原子中最终被滞留的数量是 $N_{\\text{retained},2} = (N_0 f^2 r)(1-r) = N_0 f(1-r) (fr)^1$。\n再次被再侵蚀的原子数量是 $(N_0 f^2 r)r = N_0 f^2 r^2$。\n\n这个过程无限地继续下去，形成一个多轮循环。在每一轮 $k \\ge 1$ 中，一定数量的原子被再沉积，其中比例为 $(1-r)$ 的部分最终被滞留，而比例为 $r$ 的部分被再次溅射，开始第 $k+1$ 轮。\n\n让我们通过推导从第 $k$ 个再沉积循环中滞留的原子数量来将其形式化。\n对于 $k=1$：如上所示，$N_{\\text{retained},1} = N_0 f(1-r)$。\n对于 $k=2$：如上所示，$N_{\\text{retained},2} = N_0 f^2 r(1-r) = N_0 f(1-r) (fr)^1$。\n对于 $k=3$：进入第三轮的原子数量为 $N_0 f^2 r^2$。其中比例为 $f$ 的部分再沉积，得到 $N_0 f^3 r^2$ 个再沉积原子。这些原子中比例为 $1-r$ 的部分被滞留。所以，$N_{\\text{retained},3} = (N_0 f^3 r^2)(1-r) = N_0 f(1-r) (fr)^2$。\n\n通过归纳法，在第 $k$ 轮中最终滞留的原子数量由以下表达式给出：\n$$N_{\\text{retained},k} = N_0 f(1-r)(fr)^{k-1} \\quad \\text{for } k = 1, 2, 3, \\dots$$\n\n最终滞留的原子总数 $N_{\\text{retained,tot}}$ 是在所有可能的轮次中（从 $k=1$到无穷大）滞留的原子数量之和。\n$$N_{\\text{retained,tot}} = \\sum_{k=1}^{\\infty} N_{\\text{retained},k} = \\sum_{k=1}^{\\infty} N_0 f(1-r)(fr)^{k-1}$$\n\n我们可以将与求和指数 $k$ 无关的项提取出来：\n$$N_{\\text{retained,tot}} = N_0 f(1-r) \\sum_{k=1}^{\\infty} (fr)^{k-1}$$\n\n我们通过令 $j = k-1$ 来改变求和指数。当 $k$ 从 $1$ 趋于 $\\infty$ 时，$j$ 从 $0$ 趋于 $\\infty$。求和变为：\n$$\\sum_{j=0}^{\\infty} (fr)^j$$\n\n这是一个公比为 $x=fr$ 的标准几何级数。问题陈述指出 $f \\in [0,1)$ 且 $r \\in [0,1)$，这意味着 $0 \\le fr  1$。由于公比的绝对值小于 $1$，该级数是收敛的。无穷几何级数 $\\sum_{j=0}^{\\infty} x^j$ 的和等于 $\\frac{1}{1-x}$。\n因此，该和为：\n$$\\sum_{j=0}^{\\infty} (fr)^j = \\frac{1}{1-fr}$$\n\n将此结果代回 $N_{\\text{retained,tot}}$ 的表达式中：\n$$N_{\\text{retained,tot}} = N_0 f(1-r) \\left(\\frac{1}{1-fr}\\right) = N_0 \\frac{f(1-r)}{1-fr}$$\n\n有效再沉积-滞留分数 $f_{\\text{red,eff}}$ 定义为滞留的原子总数除以初始被侵蚀的原子数 $N_0$：\n$$f_{\\text{red,eff}} = \\frac{N_{\\text{retained,tot}}}{N_0}$$\n\n代入我们得到的 $N_{\\text{retained,tot}}$ 表达式，得出最终结果：\n$$f_{\\text{red,eff}} = \\frac{f(1-r)}{1-fr}$$\n这个封闭形式的解析表达式代表了在考虑所有可能的再侵蚀和再沉积序列后，最初被侵蚀的 $N_0$ 个原子中最终留在 PFC 表面上的期望分数。",
            "answer": "$$\\boxed{\\frac{f(1-r)}{1-fr}}$$"
        },
        {
            "introduction": "在局部再沉积模型的基础上，这项高级练习将模拟聚变装置中不同部件间的杂质全局迁移。你将构建一个强大的线性代数框架来追踪整个系统中被侵蚀粒子的最终去向 ()。这项练习将理论概念与现代聚变研究中使用的大规模计算方法联系起来，为你架起一座理论与实践的桥梁。",
            "id": "3975772",
            "problem": "您正在使用离散部件模型，对磁约束聚变装置中面向等离子体部件 (PFC) 之间的杂质迁移进行建模。考虑一组由索引 $i \\in \\{0,1,\\dots,N-1\\}$ 标记的 $N$ 个 PFC 位置。原子从这些位置被侵蚀出来，并进行一系列表面到表面的飞行，其再分布由一个迁移矩阵和每次着陆时的部分粘附决定。\n\n首先，仅使用粒子数守恒基本定律和标准概率法则，从概念上区分杂质的局域迁移与全局迁移，区分的依据是输运路径长度尺度和 PFC 之间的再分布拓扑结构。您的推导和算法必须从这些基础出发，不得假设任何捷径公式。\n\n使用的数学建模假设：\n\n- 该系统是离散的，有 $N$ 个 PFC 位置。一个列向量 $\\mathbf{q} \\in \\mathbb{R}^N_{\\ge 0}$ 指定了在蒙特卡洛轨迹开始时，考虑所有初级侵蚀事件，从每个位置初始侵蚀的原子数。发射的原子总数为 $Q = \\sum_{i=0}^{N-1} q_i$。\n\n- 迁移矩阵 $\\mathbf{M} \\in \\mathbb{R}^{N \\times N}$ 的元素 $M_{ij} \\in [0,1]$ 表示一个离开位置 $i$ 的原子在单次飞行中着陆于位置 $j$ 的概率。每行的和满足 $\\sum_{j=0}^{N-1} M_{ij} \\le 1$，任何不足部分对应于从模拟域中的损失（例如，抽运或逃逸）。\n\n- 在位置 $j$ 着陆后，一个原子有 $s_j \\in [0,1]$ 的概率粘附，否则立即被再次侵蚀并继续迁移。令 $\\mathbf{S} = \\mathrm{diag}(s_0,\\dots,s_{N-1})$ 表示粘附概率的对角矩阵。这里没有时间依赖性；只需要最终的净沉积结果。\n\n- 该过程持续进行，直到原子要么在某个位置粘附，要么从域中损失掉。\n\n您的任务：\n\n1. 使用粒子数守恒和全概率定律，根据 $\\mathbf{M}$ 的结构和粘附概率 $s_j$ 的大小，清晰地定义局域迁移和全局迁移之间的区别，并形式化一个与上述假设一致的、数学上合理的 PFC 位置间迁移矩阵 $\\mathbf{M}$ 的定义。\n\n2. 从第一性原理出发，不借助任何已有的“捷径”公式，推导出一个线性代数方法来计算净沉积向量 $\\mathbf{D} \\in \\mathbb{R}^N_{\\ge 0}$，其中 $D_j$ 是在给定初始源 $\\mathbf{q}$、迁移矩阵 $\\mathbf{M}$ 和粘附概率 $\\{s_j\\}$ 的情况下，最终粘附在位置 $j$ 的原子总数。仅使用由概率守恒和重复再发射事件的收敛性所证明的操作，用 $\\mathbf{M}$、$\\mathbf{S}$ 和 $\\mathbf{q}$ 表示最终结果。\n\n3. 实现一个程序，对于下面的每个测试用例，计算分数 $F = D_{j^\\ast} / Q$，其中 $j^\\ast$ 是一个指定的目标部件索引，$Q = \\sum_{i=0}^{N-1} q_i$ 是初始侵蚀的原子总数，$D_{j^\\ast}$ 是最终粘附在目标部件上的净数量。这个分数是无量纲的，必须作为一个浮点数返回。\n\n测试套件：\n\n- 用例 A（强调相对局域的迁移和中等的粘附）：$N = 3$, \n  $$\\mathbf{M} = \\begin{bmatrix} 0.6  0.35  0.0 \\\\ 0.2  0.6  0.15 \\\\ 0.0  0.3  0.6 \\end{bmatrix}, \\quad \\mathbf{s} = \\begin{bmatrix} 0.7 \\\\ 0.5 \\\\ 0.6 \\end{bmatrix}, \\quad \\mathbf{q} = \\begin{bmatrix} 1000 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad j^\\ast = 0.$$\n\n- 用例 B（全局迁移汇集到远程高粘附部件）：$N = 4$, \n  $$\\mathbf{M} = \\begin{bmatrix} 0.05  0.8  0.1  0.0 \\\\ 0.02  0.05  0.85  0.0 \\\\ 0.0  0.05  0.05  0.85 \\\\ 0.0  0.0  0.1  0.8 \\end{bmatrix}, \\quad \\mathbf{s} = \\begin{bmatrix} 0.1 \\\\ 0.05 \\\\ 0.1 \\\\ 0.9 \\end{bmatrix}, \\quad \\mathbf{q} = \\begin{bmatrix} 0 \\\\ 2000 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad j^\\ast = 3.$$\n\n- 用例 C（边界条件，撞击时完全粘附，因此只有第一次着陆重要）：$N = 2$, \n  $$\\mathbf{M} = \\begin{bmatrix} 0.2  0.7 \\\\ 0.6  0.3 \\end{bmatrix}, \\quad \\mathbf{s} = \\begin{bmatrix} 1.0 \\\\ 1.0 \\end{bmatrix}, \\quad \\mathbf{q} = \\begin{bmatrix} 500 \\\\ 500 \\end{bmatrix}, \\quad j^\\ast = 1.$$\n\n- 用例 D（边界条件，粘附非常弱且有显著逃逸）：$N = 3$, \n  $$\\mathbf{M} = \\begin{bmatrix} 0.2  0.2  0.2 \\\\ 0.2  0.1  0.2 \\\\ 0.15  0.1  0.1 \\end{bmatrix}, \\quad \\mathbf{s} = \\begin{bmatrix} 0.01 \\\\ 0.02 \\\\ 0.01 \\end{bmatrix}, \\quad \\mathbf{q} = \\begin{bmatrix} 100 \\\\ 100 \\\\ 100 \\end{bmatrix}, \\quad j^\\ast = 2.$$\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含对应于用例 A、B、C 和 D 的四个浮点数分数，按此顺序以逗号分隔的列表形式，并用方括号括起来。例如，输出必须类似于 $[x\\_A,x\\_B,x\\_C,x\\_D]$，不带任何附加文本。所有返回值必须表示为小数（无百分号）。",
            "solution": "该问题陈述经过了细致的验证，被确定为具有科学依据、适定且内部一致。它提出了一个基于既定原理的可解决的计算输运物理问题。因此，我们可以着手提供完整的解决方案。\n\n该问题要求对一个包含 $N$ 个面向等离子体部件 (PFC) 的离散系统中的杂质迁移进行分析和计算。我们有三个任务：首先，定义局域迁移与全局迁移；其次，从第一性原理推导计算杂质净沉积的方法；第三，实现该方法以解决一系列测试用例。\n\n首先，我们按要求形式化问题的组成部分以及局域迁移和全局迁移之间的概念区别。\n系统由 $N$ 个离散位置组成，索引为 $i \\in \\{0, 1, \\dots, N-1\\}$。\n粒子的迁移由迁移矩阵 $\\mathbf{M} \\in \\mathbb{R}^{N \\times N}$ 控制，其中元素 $M_{ij} \\in [0,1]$ 是一个粒子离开位置 $i$ 后将在位置 $j$ 发生下一次相互作用（着陆）的概率。根据全概率定律，一个离开位置 $i$ 的粒子到达所有可能目的地的概率之和不能超过1。这包括从系统中损失的可能性。我们可以定义 $p_{loss,i} = 1 - \\sum_{j=0}^{N-1} M_{ij} \\ge 0$ 作为离开位置 $i$ 的粒子在单次飞行中从模拟域中损失的概率。\n局域迁移和全局迁移之间的区别是对 $\\mathbf{M}$ 结构以及粘附概率 $s_j$ 影响的定性和定量表征。\n\n-   **局域迁移**：该机制的特点是迁移矩阵 $\\mathbf{M}$ 具有强对角占优性，即对于大多数 $j \\neq i$，有 $M_{ii} \\gg M_{ij}$。这种物理情况对应于被侵蚀的粒子有很大概率返回其起源位置的条件。当与中等到高粘附概率 $s_i$ 相结合时，这会导致“瞬时再沉积”，即绝大多数被侵蚀的材料会再沉积在其源附近。净效应是杂质污染主要局限于其起源的部件。\n\n-   **全局迁移**：该机制的特点是迁移矩阵 $\\mathbf{M}$ 具有显著的非对角元。离开位置 $i$ 的粒子有很大可能性到达其他遥远的位置 $j$。这可能是由于长平均自由程或等离子体流将粒子输运到很远距离所致。低粘附概率（$s_j \\ll 1$）会放大这种效应，它允许粒子在永久粘附之前经历多次飞行（一系列着陆和再发射）。每次飞行为进一步的输运提供了机会，导致杂质在许多 PFC 上广泛再分布，远离原始侵蚀点。问题陈述中的用例 B 就是一个例子，其中迁移优先将粒子汇集到位置 $j=3$ 的一个远程汇。\n\n接下来，我们从第一性原理推导计算净沉积向量 $\\mathbf{D}$ 的线性代数方法。该推导基于一个关于着陆于每个位置的粒子总数的自洽论证。\n\n令 $\\mathbf{q} \\in \\mathbb{R}^N_{\\ge 0}$ 为初始侵蚀原子的列向量，它代表了第一代飞行的源粒子群。令 $\\mathbf{M}$ 为所定义的迁移矩阵，令 $\\mathbf{S} = \\mathrm{diag}(s_0, s_1, \\dots, s_{N-1})$ 为粘附概率的对角矩阵。\n\n令 $\\mathbf{T} \\in \\mathbb{R}^N_{\\ge 0}$ 为列向量，其中 $T_j$ 是在过程的整个生命周期中（对所有代的飞行求和）着陆在位置 $j$ 上的原子总数。\n\n这些总着陆数 $\\mathbf{T}$ 可以表示为来自两个不同来源的着陆之和：\n1.  来自初始侵蚀源 $\\mathbf{q}$ 的着陆。从位置 $i$ 初始侵蚀的粒子数为 $q_i$。其中着陆在位置 $j$ 的数量为 $\\sum_{i=0}^{N-1} M_{ij} q_i$。以向量形式，对着陆的这一贡献是 $\\mathbf{M}^T \\mathbf{q}$。\n2.  来自再发射粒子的着陆。在着陆于位置 $j$ 的总共 $T_j$ 个粒子中，一部分 $s_j$ 粘附，剩余部分 $(1-s_j)$ 被再发射。从所有位置再发射的粒子总数由向量 $(\\mathbf{I}-\\mathbf{S})\\mathbf{T}$ 给出。这部分再发射的粒子成为后续飞行的源。这些粒子随后着陆在各个位置的数量由 $\\mathbf{M}^T ((\\mathbf{I}-\\mathbf{S})\\mathbf{T})$ 给出。\n\n根据粒子数守恒原理，总着陆数必须等于来自初始源的着陆数与来自所有后续再发射的着陆数之和。这为我们提供了关于 $\\mathbf{T}$ 的一个自洽方程：\n$$\n\\mathbf{T} = \\mathbf{M}^T \\mathbf{q} + \\mathbf{M}^T (\\mathbf{I}-\\mathbf{S})\\mathbf{T}\n$$\n这是一个关于未知向量 $\\mathbf{T}$ 的线性方程组。我们可以将其重新排列为标准形式 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$：\n$$\n\\mathbf{T} - \\mathbf{M}^T (\\mathbf{I}-\\mathbf{S})\\mathbf{T} = \\mathbf{M}^T \\mathbf{q}\n$$\n$$\n(\\mathbf{I} - \\mathbf{M}^T (\\mathbf{I}-\\mathbf{S})) \\mathbf{T} = \\mathbf{M}^T \\mathbf{q}\n$$\n这个线性系统可以求解 $\\mathbf{T}$。只要任何粒子最终都有非零概率从迁移循环中移除，无论是通过粘附（对于某个 $j$，$s_j > 0$）还是通过从域中损失（对于某个 $i$，$\\sum_j M_{ij}  1$），矩阵 $(\\mathbf{I} - \\mathbf{M}^T (\\mathbf{I}-\\mathbf{S}))$ 的可逆性就得到保证。所有测试用例都满足此条件。\n\n一旦找到总着陆向量 $\\mathbf{T}$，净沉积向量 $\\mathbf{D}$ 就是在每个位置粘附的粒子比例：\n$$\n\\mathbf{D} = \\mathbf{S} \\mathbf{T}\n$$\n代入 $\\mathbf{T}$ 的解，我们得到净沉积向量 $\\mathbf{D}$ 的最终表达式：\n$$\n\\mathbf{D} = \\mathbf{S} \\left( \\mathbf{I} - \\mathbf{M}^T (\\mathbf{I}-\\mathbf{S}) \\right)^{-1} \\mathbf{M}^T \\mathbf{q}\n$$\n这个公式提供了一种直接计算系统最终状态的方法，而无需单独模拟每个粒子的轨迹。\n\n最后，我们实现这个推导出的方法来计算每个测试用例所需的分数 $F = D_{j^\\ast} / Q$，其中 $Q = \\sum_i q_i$。实现将求解线性系统 $(\\mathbf{I} - \\mathbf{M}^T (\\mathbf{I}-\\mathbf{S})) \\mathbf{T} = \\mathbf{M}^T \\mathbf{q}$ 以得到 $\\mathbf{T}$，然后计算 $\\mathbf{D} = \\mathbf{S} \\mathbf{T}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the impurity migration problem for the given test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case A\n        {\n            \"N\": 3,\n            \"M\": np.array([\n                [0.6, 0.35, 0.0],\n                [0.2, 0.6, 0.15],\n                [0.0, 0.3, 0.6]\n            ]),\n            \"s\": np.array([0.7, 0.5, 0.6]),\n            \"q\": np.array([1000, 0, 0]),\n            \"j_star\": 0\n        },\n        # Case B\n        {\n            \"N\": 4,\n            \"M\": np.array([\n                [0.05, 0.8, 0.1, 0.0],\n                [0.02, 0.05, 0.85, 0.0],\n                [0.0, 0.05, 0.05, 0.85],\n                [0.0, 0.0, 0.1, 0.8]\n            ]),\n            \"s\": np.array([0.1, 0.05, 0.1, 0.9]),\n            \"q\": np.array([0, 2000, 0, 0]),\n            \"j_star\": 3\n        },\n        # Case C\n        {\n            \"N\": 2,\n            \"M\": np.array([\n                [0.2, 0.7],\n                [0.6, 0.3]\n            ]),\n            \"s\": np.array([1.0, 1.0]),\n            \"q\": np.array([500, 500]),\n            \"j_star\": 1\n        },\n        # Case D\n        {\n            \"N\": 3,\n            \"M\": np.array([\n                [0.2, 0.2, 0.2],\n                [0.2, 0.1, 0.2],\n                [0.15, 0.1, 0.1]\n            ]),\n            \"s\": np.array([0.01, 0.02, 0.01]),\n            \"q\": np.array([100, 100, 100]),\n            \"j_star\": 2\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N = case[\"N\"]\n        M = case[\"M\"]\n        s_vec = case[\"s\"]\n        q = case[\"q\"]\n        j_star = case[\"j_star\"]\n\n        # Construct matrices based on the derivation\n        S = np.diag(s_vec)\n        I = np.eye(N)\n        \n        # Transpose of the migration matrix M\n        # M_ij is given as from i to j. For left-multiplication on column vectors, \n        # we need a matrix where M'_ji is the probability from i to j, which is M^T.\n        M_T = M.T\n\n        # Define the matrix A for the linear system A*T = b\n        # A = I - M^T * (I - S)\n        A = I - M_T @ (I - S)\n        \n        # Define the vector b (right-hand side)\n        # b = M^T * q\n        b = M_T @ q\n        \n        # Solve the linear system A*T = b for T, the total landing vector.\n        # This is more numerically stable than computing the inverse of A.\n        try:\n            T = np.linalg.solve(A, b)\n        except np.linalg.LinAlgError:\n            # This case should not be reached for valid problems where the\n            # spectral radius of M^T*(I-S) is less than 1.\n            # Handle error gracefully if it occurs.\n            results.append(float('nan'))\n            continue\n\n        # Calculate the net deposition vector D\n        # D = S * T\n        D = S @ T\n        \n        # Get the deposition on the target component j_star\n        D_j_star = D[j_star]\n        \n        # Calculate the total initial source Q\n        Q = np.sum(q)\n        \n        # Calculate the fraction F. Handle Q=0 case to avoid division by zero.\n        if Q == 0:\n            fraction = 0.0\n        else:\n            fraction = D_j_star / Q\n            \n        results.append(fraction)\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}