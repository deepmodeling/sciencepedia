{
    "hands_on_practices": [
        {
            "introduction": "鞘层动理学理论的应用始于理解离子如何进入鞘层。这个入口条件由一个称为“预鞘”的区域建立，在这里，一个微弱的电场将离子从亚音速状态加速到满足玻姆判据的声速。本练习将引导您从第一性原理出发，通过平衡电场加速和离子-中性原子碰撞阻力，推导出预鞘的特征长度尺度 。这个实践有助于加深对动理学方程如何描述宏观输运过程的理解。",
            "id": "3999663",
            "problem": "考虑在与材料壁相邻的磁无约束聚变等离子体区域中，一个一维、稳态、弱碰撞的预鞘层，其中离子-中性粒子散射主导离子动量弛豫。电荷为 $q_{i}$、质量为 $m_{i}$ 的离子在空间均匀电场 $E$ 下运动，并与静止的中性粒子发生弹性碰撞。使用 Bhatnagar–Gross–Krook (BGK) 碰撞算符对离子动力学进行建模，采用恒定的离子-中性粒子碰撞频率 $\\nu_{in}$，并假设中性粒子的参考分布无漂移。设上游离子分布为近麦克斯韦分布，离子温度为 $T_{i}$，离子热速度定义为 $v_{Ti} = \\sqrt{\\frac{2 k_{B} T_{i}}{m_{i}}}$。\n\n在预鞘层入口处，离子的定向速度与 $v_{Ti}$ 相比很小，其定向运动由场驱动的加速和碰撞阻力之间的平衡所建立。在电加速 $q_{i} E$ 与终端定向速度 $u_{i} = v_{Ti}$ 时的碰撞阻力 $m_{i} \\nu_{in} u_{i}$ 相平衡的条件下，将预鞘层长度尺度 $\\ell_{p}$ 定义为电场所做的功等于速度 $v_{Ti}$ 对应的定向动能所需的特征距离。仅使用参数 $\\nu_{in}$ 和 $v_{Ti}$ 以及第一性原理的动力学和能量论证，推导 $\\ell_{p}$ 的闭合形式表达式。\n\n将最终答案表示为 $\\ell_{p}$ 关于 $v_{Ti}$ 和 $\\nu_{in}$ 的单一解析表达式。不需要进行数值计算，最终方框内的表达式不应包含单位。",
            "solution": "动力学出发点是带 Bhatnagar–Gross–Krook (BGK) 碰撞算符的稳态一维离子玻尔兹曼方程，\n$$\nv\\,\\frac{\\partial f_{i}}{\\partial x} + \\frac{q_{i}}{m_{i}} E\\,\\frac{\\partial f_{i}}{\\partial v}\n= -\\nu_{in}\\,\\bigl(f_{i} - f_{i}^{(M)}\\bigr),\n$$\n其中 $f_{i}(x,v)$ 是离子分布函数，$f_{i}^{(M)}$ 是 BGK 算符的麦克斯韦参考态，中性粒子是静止的，因此 BGK 算符以速率 $\\nu_{in}$ 将离子动量弛豫至零漂移。取速度一阶矩（乘以 $m_{i} v$ 并对 $v$ 积分），得到沿 $x$ 方向的稳态动量平衡方程，\n$$\nm_{i} n_{i} u_{i}\\,\\frac{d u_{i}}{d x} = q_{i} n_{i} E - m_{i} n_{i} \\nu_{in}\\,u_{i},\n$$\n其中 $n_{i}(x)$ 是离子密度，$u_{i}(x)$ 是离子漂移速度。在预鞘层入口区域，流动是亚声速的，$u_{i}$ 从一个很小的值开始增加。对于电场在碰撞作用下所能维持的特征终端漂移速度，我们考虑惯性项 $m_{i} n_{i} u_{i}\\,\\frac{d u_{i}}{d x}$ 与驱动力和阻力相比可以忽略不计的情况；此时局部力平衡得出\n$$\n\\frac{q_{i}}{m_{i}} E = \\nu_{in}\\,u_{i}.\n$$\n在终端定向速度 $u_{i} = v_{Ti}$ 处进行计算，得到电场强度为\n$$\nE = \\frac{m_{i}\\,\\nu_{in}\\,v_{Ti}}{q_{i}}.\n$$\n\n接下来，将预鞘层长度尺度 $\\ell_{p}$ 定义为电场所做的功等于与 $v_{Ti}$ 相关联的定向动能所需的距离。电场在距离 $\\ell_{p}$ 上所做的功是 $q_{i} E \\ell_{p}$，定向动能是 $\\frac{1}{2} m_{i} v_{Ti}^{2}$。令二者相等，\n$$\nq_{i} E\\,\\ell_{p} = \\frac{1}{2} m_{i} v_{Ti}^{2}.\n$$\n代入从加速-阻力平衡中得到的 $E$ 的表达式，\n$$\nq_{i} \\left(\\frac{m_{i}\\,\\nu_{in}\\,v_{Ti}}{q_{i}}\\right)\\,\\ell_{p} = \\frac{1}{2} m_{i} v_{Ti}^{2}.\n$$\n消去 $q_{i}$ 和 $m_{i}$ 并求解 $\\ell_{p}$，\n$$\n\\nu_{in}\\,v_{Ti}\\,\\ell_{p} = \\frac{1}{2} v_{Ti}^{2}\n\\quad\\Rightarrow\\quad\n\\ell_{p} = \\frac{v_{Ti}}{2\\,\\nu_{in}}.\n$$\n\n此结果仅依赖于离子热速度 $v_{Ti}$ 和离子-中性粒子碰撞频率 $\\nu_{in}$，符合要求。它可以被解释为在热速度下评估的离子-中性粒子平均自由程的一半，这与预鞘层长度由加速与碰撞动量弛豫之间的平衡以及建立与热速度相当的定向运动所需能量决定的观念相一致。",
            "answer": "$$\\boxed{\\frac{v_{Ti}}{2 \\nu_{in}}}$$"
        },
        {
            "introduction": "鞘层模型的一个关键组成部分是在壁面处施加的边界条件，它描述了粒子与材料表面的相互作用。电子的反射和吸收会直接改变壁面附近的分布函数，从而影响鞘层电势和流向壁面的热量。本练习将运用刘维尔定理，要求您构建一个考虑了弹性反射的电子分布函数，并由此计算出关键的宏观量 。通过这个练习，您将掌握如何将微观的边界物理整合到动理学模型中。",
            "id": "3999695",
            "problem": "考虑一个与理想平面壁相邻的稳态、一维 (1D)、无碰撞的平面等离子体鞘层。电子从 $x=0$ 处的准中性等离子体边界产生，其数密度为 $n_0$，电子温度为 $T_e$，具有一维麦克斯韦分布函数 $f_{\\infty}(v)$。壁面位于 $x=L$ 处，其相对于等离子体边界电势 $\\phi_0=0$ 的电势为 $\\phi_w$。我们将元电荷记为 $e0$，电子质量记为 $m_e$，玻尔兹曼常数记为 $k_\\mathrm{B}$。电子朝向壁面时，会经历一个单调的排斥性电势降 $\\Delta \\phi = \\phi_0 - \\phi_w  0$。入射到壁面上的电子中，有一部分 $R \\in [0,1]$ 会发生弹性镜面反射（没有能量损失，垂直于壁面的速度分量反向），而另一部分 $1-R$ 则被吸收。\n\n仅从以下基本原理出发：\n- 沿无碰撞轨迹的单粒子能量守恒，$\\mathcal{E} = \\frac{1}{2} m_e v^2 - e \\phi(x)$。\n- 用于无碰撞动力学的刘维尔定理（相空间密度沿轨迹恒定）。\n- 等离子体边界处的一维麦克斯韦定义，\n$$\nf_{\\infty}(v) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right),\n$$\n以及壁面处系数为 $R$ 的弹性镜面反射边界条件。\n\n通过在 $f_e(L,v)$ 中整合入射和弹性反射的电子轨迹，推导壁面处的电子数密度 $n_e^{\\mathrm{wall}}$ 和壁面吸收的电子电流密度 $J_e^{\\mathrm{abs}}$ 的表达式。您的推导必须明确展示能量守恒和刘维尔定理如何确定 $v0$ 时（入射电子）的 $f_{\\mathrm{in}}(L,v)$，以及反射边界条件如何确定 $v0$ 时（反射电子）的 $f_{\\mathrm{ref}}(L,v)$。然后，计算得出 $n_e^{\\mathrm{wall}}$ 和 $J_e^{\\mathrm{abs}}$ 的积分，并用 $n_0$、$T_e$、$\\Delta\\phi$、$R$、$m_e$、$e$ 和 $k_\\mathrm{B}$ 表示。\n\n数值实现要求：\n- 使用以电子伏特 (eV) 为单位给出的 $T_e$，并利用 $k_\\mathrm{B} T_e = e\\, T_e$ 将其一致地转换为能量。\n- 对于下面的每个测试用例，计算两个量：\n    1) $n_e^{\\mathrm{wall}}$，单位为 $\\mathrm{m}^{-3}$，\n    2) $J_e^{\\mathrm{abs}}$，单位为 $\\mathrm{A}\\,\\mathrm{m}^{-2}$。\n- 您的程序必须生成单行输出，其中包含一个以逗号分隔的列表，列表被方括号括起，每个测试用例对应一个包含两个元素的列表 $[n_e^{\\mathrm{wall}}, J_e^{\\mathrm{abs}}]$。例如：“[[n1,J1],[n2,J2],...]”。\n\n测试组参数集（每个集为 $(n_0, T_e, \\phi_w, R)$）：\n- 用例 1 (happy path): $(8.0\\times 10^{18}, 12.0, -25.0, 0.0)$。\n- 用例 2 (moderate reflection): $(8.0\\times 10^{18}, 12.0, -25.0, 0.3)$。\n- 用例 3 (full reflection boundary): $(8.0\\times 10^{18}, 12.0, -25.0, 1.0)$。\n- 用例 4 (boundary condition check, zero drop): $(1.0\\times 10^{19}, 5.0, 0.0, 0.0)$。\n- 用例 5 (edge case, strong depletion at low temperature): $(5.0\\times 10^{18}, 2.0, -10.0, 0.5)$。\n\n您的程序必须实现推导出的公式，并以上述确切格式生成输出。以 $\\mathrm{m}^{-3}$ 为单位表示 $n_e^{\\mathrm{wall}}$，以 $\\mathrm{A}\\,\\mathrm{m}^{-2}$ 为单位表示 $J_e^{\\mathrm{abs}}$，除标准双精度浮点表示外，没有取整约束。",
            "solution": "壁面处电子密度和吸收电流密度的推导基于刘维尔定理，该定理指出，在无碰撞系统中，分布函数 $f_e(x,v)$ 沿粒子轨迹保持不变。轨迹由总能量 $\\mathcal{E}$ 的守恒定律决定。\n\n步骤 1：定义能量和轨迹\n一个电荷为 $-e$（其中 $e$ 是元电荷，$e>0$）、质量为 $m_e$ 的电子的总能量由下式给出：\n$$ \\mathcal{E} = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\n沿连接等离子体边界点 $(0, v_0)$ 和鞘层中点 $(x, v)$ 的轨迹的能量守恒表示为：\n$$ \\frac{1}{2} m_e v_0^2 - e \\phi(0) = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\n给定 $\\phi(0) = \\phi_0 = 0$，上式简化为：\n$$ \\frac{1}{2} m_e v_0^2 = \\frac{1}{2} m_e v^2 - e \\phi(x) $$\n由此，我们可以找到位于 $(x,v)$ 的任意粒子在源头的速度 $v_0$：\n$$ v_0^2 = v^2 - \\frac{2e\\phi(x)}{m_e} $$\n由于源头（$x=0$）处的分布函数已知为一维麦克斯韦分布 $f_{\\infty}(v_0)$，根据刘维尔定理，我们可以将任意点 $(x,v)$ 的分布函数写为 $f_e(x,v) = f_{\\infty}(v_0)$。\n\n步骤 2：构建壁面处的分布函数\n在位于 $x=L$ 的壁面处，电势为 $\\phi(L) = \\phi_w$。问题陈述了一个对电子的排斥性电势降 $\\Delta\\phi = \\phi_0 - \\phi_w  0$，这意味着 $\\phi_w  0$。电子的势能 $-e\\phi$ 从边界处的 $0$ 增加到壁面处的 $-e\\phi_w  0$。\n\n壁面处的总电子分布函数 $f_e(L,v)$ 是入射电子（$v0$）和反射电子（$v>0$）的分布函数之和。\n$$ f_e(L,v) = \\begin{cases} f_{\\mathrm{in}}(L,v)  \\text{for } v  0 \\\\ f_{\\mathrm{ref}}(L,v)  \\text{for } v > 0 \\end{cases} $$\n\n对于壁面处的入射电子（$v0$），它们在源头的速度 $v_0$ 也必须为负。使用 $x=L$ 处的能量守恒方程：\n$$ v_0 = -\\sqrt{v^2 - \\frac{2e\\phi_w}{m_e}} $$\n应用刘维尔定理，我们得到 $f_{\\mathrm{in}}(L,v)$：\n$$ f_{\\mathrm{in}}(L,v) = f_{\\infty}(v_0) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e v_0^2}{2 k_\\mathrm{B} T_e}\\right) $$\n代入 $v_0^2$ 的表达式：\n$$ f_{\\mathrm{in}}(L,v) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(-\\frac{m_e (v^2 - 2e\\phi_w/m_e)}{2 k_\\mathrm{B} T_e}\\right) = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) $$\n此表达式对 $v0$ 有效。电子只有在具有足够初始动能以克服势垒时才能到达壁面：$\\frac{1}{2}m_e v_0^2 \\ge -e\\phi_w$。此条件确保了在壁面处速度 $v$ 是实数。\n\n对于反射电子（$v>0$），边界条件是系数为 $R$ 的镜面反射。这意味着以速度 $v_{\\mathrm{inc}}$ 入射的电子以速度 $v_{\\mathrm{ref}} = -v_{\\mathrm{inc}}$ 反射。粒子通量按 $R$ 比例缩放：\n$$ |v_{\\mathrm{ref}}| f_{\\mathrm{ref}}(L, v_{\\mathrm{ref}}) = R |v_{\\mathrm{inc}}| f_{\\mathrm{in}}(L, v_{\\mathrm{inc}}) $$\n对于一个反射速度 $v > 0$，相应的入射速度为 $-v  0$。因此，$v_{\\mathrm{ref}} = v$ 且 $v_{\\mathrm{inc}} = -v$。该方程变为：\n$$ v f_{\\mathrm{ref}}(L, v) = R |-v| f_{\\mathrm{in}}(L, -v) = R v f_{\\mathrm{in}}(L, -v) $$\n这得到 $f_{\\mathrm{ref}}(L,v) = R f_{\\mathrm{in}}(L,-v)$ 对于 $v>0$。由于 $f_{\\mathrm{in}}(L,v)$ 的表达式依赖于 $v^2$，所以它是 $v$ 的偶函数。因此，$f_{\\mathrm{in}}(L,-v) = f_{\\mathrm{in}}(L,v)$。\n$$ f_{\\mathrm{ref}}(L,v) = R \\left( n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) \\right) \\quad \\text{for } v>0 $$\n\n步骤 3：推导壁面处的电子数密度 $n_e^{\\mathrm{wall}}$\n数密度是分布函数的零阶矩：\n$$ n_e^{\\mathrm{wall}} = \\int_{-\\infty}^{\\infty} f_e(L,v) \\, dv = \\int_{-\\infty}^{0} f_{\\mathrm{in}}(L,v) \\, dv + \\int_{0}^{\\infty} f_{\\mathrm{ref}}(L,v) \\, dv $$\n我们定义一个常数因子 $C_w = n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right)$。\n$$ n_e^{\\mathrm{wall}} = C_w \\int_{-\\infty}^{0} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv + R C_w \\int_{0}^{\\infty} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv $$\n这些积分是标准的高斯积分。设 $a = \\frac{m_e}{2 k_\\mathrm{B} T_e}$。那么 $\\int_0^\\infty e^{-av^2}dv = \\int_{-\\infty}^0 e^{-av^2}dv = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$。\n$$ \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}} = \\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}} $$\n代回此结果：\n$$ n_e^{\\mathrm{wall}} = C_w \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) + R C_w \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) $$\n$$ n_e^{\\mathrm{wall}} = (1+R) \\left( n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\right) \\left(\\frac{1}{2}\\sqrt{\\frac{2\\pi k_\\mathrm{B} T_e}{m_e}}\\right) $$\n$$ n_e^{\\mathrm{wall}} = \\frac{1}{2} (1+R) n_0 \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\n\n步骤 4：推导吸收的电子电流密度 $J_e^{\\mathrm{abs}}$\n壁面处的净电子粒子通量 $\\Gamma_e$ 是分布函数的一阶矩：\n$$ \\Gamma_e = \\int_{-\\infty}^{\\infty} v f_e(L,v) \\, dv = \\int_{-\\infty}^{0} v f_{\\mathrm{in}}(L,v) \\, dv + \\int_{0}^{\\infty} v f_{\\mathrm{ref}}(L,v) \\, dv $$\n第一个积分是入射通量 $\\Gamma_{\\mathrm{in}}$，第二个是反射通量 $\\Gamma_{\\mathrm{ref}}$。\n$$ \\Gamma_{\\mathrm{in}} = C_w \\int_{-\\infty}^{0} v \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) dv $$\n该积分的计算结果为：\n$$ \\Gamma_{\\mathrm{in}} = C_w \\left[ -\\frac{k_\\mathrm{B} T_e}{m_e} \\exp\\left(-\\frac{m_e v^2}{2 k_\\mathrm{B} T_e}\\right) \\right]_{-\\infty}^{0} = C_w \\left( -\\frac{k_\\mathrm{B} T_e}{m_e} (1 - 0) \\right) = -C_w \\frac{k_\\mathrm{B} T_e}{m_e} $$\n代入 $C_w$：\n$$ \\Gamma_{\\mathrm{in}} = -n_0 \\sqrt{\\frac{m_e}{2\\pi k_\\mathrm{B} T_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\frac{k_\\mathrm{B} T_e}{m_e} = -n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\n反射通量为 $\\Gamma_{\\mathrm{ref}} = \\int_{0}^{\\infty} v R f_{\\mathrm{in}}(L,-v) \\, dv = R \\int_{0}^{\\infty} v f_{\\mathrm{in}}(L,v) \\, dv = -R \\Gamma_{\\mathrm{in}}$。\n净粒子通量为 $\\Gamma_e = \\Gamma_{\\mathrm{in}} + \\Gamma_{\\mathrm{ref}} = \\Gamma_{\\mathrm{in}} - R \\Gamma_{\\mathrm{in}} = (1-R)\\Gamma_{\\mathrm{in}}$。这个净通量对应于被吸收的粒子。\n$$ \\Gamma_e = -(1-R) n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\n吸收的电子电流密度 $J_e^{\\mathrm{abs}}$ 是电荷（$-e$）乘以净粒子通量：\n$$ J_e^{\\mathrm{abs}} = (-e) \\Gamma_e = (-e) \\left( -(1-R) n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) \\right) $$\n$$ J_e^{\\mathrm{abs}} = (1-R) e n_0 \\sqrt{\\frac{k_\\mathrm{B} T_e}{2\\pi m_e}} \\exp\\left(\\frac{e\\phi_w}{k_\\mathrm{B} T_e}\\right) $$\n问题陈述 $T_e$ 以电子伏特 (eV) 给出，这意味着使用转换关系 $k_\\mathrm{B} T_{e,K} = e T_{e,eV}$。因此，指数项变为 $\\exp(\\frac{e\\phi_w}{e T_{e,eV}}) = \\exp(\\frac{\\phi_w}{T_{e,eV}})$，其中 $\\phi_w$ 的单位是伏特。\n\n用于实现的最终表达式为：\n1.  $n_e^{\\mathrm{wall}} = \\frac{1}{2} (1+R) n_0 \\exp\\left(\\frac{\\phi_w}{T_e}\\right)$\n2.  $J_e^{\\mathrm{abs}} = (1-R) e n_0 \\sqrt{\\frac{e T_e}{2\\pi m_e}} \\exp\\left(\\frac{\\phi_w}{T_e}\\right)$\n此处，$T_e$ 是以 eV 为单位的数值，$\\phi_w$ 是以 V 为单位的数值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes electron number density and absorbed current density at a wall\n    in a plasma sheath based on a kinetic model.\n    \"\"\"\n\n    # Physical constants\n    e = 1.602176634e-19  # Elementary charge in Coulombs\n    m_e = 9.1093837015e-31 # Electron mass in kg\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (n0, Te, phi_w, R)\n    # n0: electron density at plasma edge (m^-3)\n    # Te: electron temperature (eV)\n    # phi_w: wall potential (V)\n    # R: reflection coefficient (dimensionless)\n    test_cases = [\n        (8.0e18, 12.0, -25.0, 0.0), # Case 1 (happy path)\n        (8.0e18, 12.0, -25.0, 0.3), # Case 2 (moderate reflection)\n        (8.0e18, 12.0, -25.0, 1.0), # Case 3 (full reflection boundary)\n        (1.0e19, 5.0, 0.0, 0.0),    # Case 4 (boundary condition check, zero drop)\n        (5.0e18, 2.0, -10.0, 0.5)   # Case 5 (edge case, strong depletion at low temp)\n    ]\n\n    results = []\n    for case in test_cases:\n        n0, Te_eV, phi_w, R = case\n\n        # The term e*phi_w / (k_B*T_e) simplifies to phi_w / T_e\n        # when Te is in eV and phi_w is in V.\n        # This is because k_B*T_e[J] = e*T_e[eV]\n        if Te_eV == 0:\n            # Avoid division by zero or non-physical temperature\n            # In this problem, all Te_eV > 0, so this is a safeguard.\n            exp_term = 0.0 if phi_w  0 else 1.0\n        else:\n            exp_term = np.exp(phi_w / Te_eV)\n\n        # 1. Calculate electron number density at the wall, n_e^wall\n        # Formula: n_e_wall = 0.5 * (1 + R) * n0 * exp(e*phi_w / (k_B*T_e))\n        n_wall = 0.5 * (1 + R) * n0 * exp_term\n\n        # 2. Calculate absorbed electron current density to the wall, J_e^abs\n        # Formula: J_e_abs = (1 - R) * e * n0 * sqrt(k_B*T_e / (2*pi*m_e)) * exp(e*phi_w / (k_B*T_e))\n        # where k_B*T_e is e*Te_eV\n        kBT_e_joules = e * Te_eV\n        thermal_velocity_term = np.sqrt(kBT_e_joules / (2 * np.pi * m_e))\n        J_abs = (1 - R) * e * n0 * thermal_velocity_term * exp_term\n\n        results.append([n_wall, J_abs])\n\n    # Format the final output string exactly as required: [[n1,J1],[n2,J2],...]\n    # without extra spaces inside the inner lists.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "虽然无碰撞鞘层是一个有用的理想模型，但在许多实际等离子体中，离子在穿过鞘层时会与背景中性气体发生碰撞。电荷交换（CX）碰撞尤为重要，因为它产生一个慢速离子和一个高能中性原子，深刻地改变了到达壁面的离子能量分布。本练习将引导您分析电荷交换碰撞对离子能量分布的影响，并最终估算由这些离子引起的材料溅射率 。这个实践将动理学模型与聚变和半导体应用中至关重要的实际问题——壁面侵蚀——直接联系起来。",
            "id": "3999685",
            "problem": "考虑在聚变相关等离子体中，平面壁前的一个一维稳态等离子体鞘层。在鞘层中，离子被静电势降加速，并与中性粒子发生碰撞。离子分布函数 $f(x,v)$ 的动理学演化由一维玻尔兹曼方程决定\n$$\nv \\frac{\\partial f}{\\partial x} + \\frac{q_i}{m_i} E(x) \\frac{\\partial f}{\\partial v} = C_{\\mathrm{BGK}}[f] + C_{\\mathrm{FP}}[f] + C_{\\mathrm{CX}}[f],\n$$\n其中，$x$ 是垂直于壁面的坐标（壁面处 $x=0$），$v$ 是离子速度，$q_i$ 是离子电荷，$m_i$ 是离子质量，$E(x) = -\\frac{d\\phi}{dx}$ 是与鞘层电势 $\\phi(x)$ 相关的电场，$C_{\\mathrm{BGK}}[f]$ 是 Bhatnagar–Gross–Krook (BGK) 碰撞算符（一种弛豫模型），$C_{\\mathrm{FP}}[f]$ 是 Fokker–Planck 算符（小角度散射和能量扩散），$C_{\\mathrm{CX}}[f]$ 是与中性原子的电荷交换碰撞算符。\n\n对于强偏压鞘层，我们做如下物理上合理的简化假设：\n- 电荷交换过程产生一个快中性粒子和一个新生离子，后者的动能近似为热能，即与鞘层势能尺度相比接近于零。因此，在位置 $x$ 发生最后一次电荷交换事件后，新生离子可视为从静止开始，被剩余的电势 $\\phi(x)$ 加速至壁面。\n- 鞘层内的中性粒子密度和电荷交换截面在空间上是均匀的，因此电荷交换的空间风险率是恒定的。从鞘层边界到壁面的路径上发生的电荷交换事件可以建模为一个平均自由程为 $\\lambda_{\\mathrm{cx}}$ 的均匀泊松过程。\n- 鞘层电势是单调的，可以参数化为\n$$\n\\phi(x) = \\Phi_s \\left(\\frac{x}{s}\\right)^{\\alpha},\n$$\n其中，壁面处 $\\phi(0)=0$，鞘层边界处 $\\phi(s)=\\Phi_s$，$s$ 是鞘层厚度，$\\Phi_s$ 是整个鞘层的总势降，$\\alpha0$ 是一个已知的位形指数。\n- 无碰撞离子到达壁面时的能量包括势能 $q_i \\Phi_s$ 和与鞘层边界处离子声速相关的初始动能，对于电子温度为 $T_e$ 的离子，该动能约为 $\\frac{1}{2} k_B T_e$；以电子伏特表示，即为 $\\frac{1}{2} T_e$。\n\n在这些假设下，离子到达壁面时的能量（单位：电子伏特，eV）可建模如下：\n- 如果离子在穿过鞘层时没有发生电荷交换碰撞（这是一个概率为 $P_0 = e^{-s/\\lambda_{\\mathrm{cx}}}$ 的离散事件），则\n$$\nE_{\\mathrm{no}} = \\Phi_s + \\frac{1}{2} T_e.\n$$\n- 如果离子经历了电荷交换，并且最后一次电荷交换事件发生在位置 $x \\in [0,s]$，那么离子到达壁面时的能量为\n$$\nE(x) = \\Phi_s \\left(\\frac{x}{s}\\right)^{\\alpha}.\n$$\n最后一次电荷交换事件位置的无条件概率密度为\n$$\nf_{\\mathrm{last}}(x) = \\frac{1}{\\lambda_{\\mathrm{cx}}} e^{-x/\\lambda_{\\mathrm{cx}}}, \\quad x \\in [0,s],\n$$\n并且对应于无碰撞事件有一个离散的概率质量 $P_0 = e^{-s/\\lambda_{\\mathrm{cx}}}$。\n\n定义溅射阈值能量 $E_{\\mathrm{th}}$（单位：电子伏特）。“壁面处的溅射撞击能量谱”被定义为壁面处离子撞击能量的分布，但仅限于那些能量大于或等于 $E_{\\mathrm{th}}$ 的离子。\n\n你的任务：\n1. 从一维玻尔兹曼方程和上述假设出发，推导出壁面处无条件平均离子能量 $\\langle E \\rangle$（单位：电子伏特）的表达式，该表达式是 $s$, $\\Phi_s$, $\\lambda_{\\mathrm{cx}}$, $\\alpha$, 和 $T_e$ 的函数。同时，推导每个离子因电荷交换引起的无条件平均能量损失 $\\langle \\Delta E \\rangle$，其定义为无碰撞能量 $E_{\\mathrm{no}}$ 与实际离子能量 $E$ 在系综上平均后的差值。\n2. 推导到达壁面时能量大于或等于溅射阈值 $E_{\\mathrm{th}}$ 的离子所占的比例（以小数表示）。然后，推导引起溅射的撞击离子（仅限于能量 $E \\ge E_{\\mathrm{th}}$ 的离子）的平均能量 $\\langle E \\rangle_{\\mathrm{sput}}$（单位：电子伏特）。\n3. 实现一个程序，为下面给出的测试套件计算这些量。你必须使用推导出的解析公式，而不是进行任何随机抽样。\n\n所有涉及能量的答案都必须以电子伏特（eV）表示。任何可能出现的角度（预计不会有）都必须以弧度表示。小数比例必须以纯小数或分数形式提供，不带百分号。\n\n测试套件：\n- A案例（碰撞稀疏，近无碰撞参考）：\n  - $s = 0.005 \\, \\mathrm{m}$,\n  - $\\Phi_s = 200 \\, \\mathrm{V}$,\n  - $\\lambda_{\\mathrm{cx}} = 0.5 \\, \\mathrm{m}$,\n  - $\\alpha = \\tfrac{4}{3}$,\n  - $T_e = 10 \\, \\mathrm{eV}$,\n  - $E_{\\mathrm{th}} = 30 \\, \\mathrm{eV}$。\n- B案例（碰撞主导）：\n  - $s = 0.005 \\, \\mathrm{m}$,\n  - $\\Phi_s = 200 \\, \\mathrm{V}$,\n  - $\\lambda_{\\mathrm{cx}} = 0.0005 \\, \\mathrm{m}$,\n  - $\\alpha = 1$,\n  - $T_e = 10 \\, \\mathrm{eV}$,\n  - $E_{\\mathrm{th}} = 50 \\, \\mathrm{eV}$。\n- C案例（中度碰撞，高阈值）：\n  - $s = 0.002 \\, \\mathrm{m}$,\n  - $\\Phi_s = 100 \\, \\mathrm{V}$,\n  - $\\lambda_{\\mathrm{cx}} = 0.001 \\, \\mathrm{m}$,\n  - $\\alpha = 2$,\n  - $T_e = 5 \\, \\mathrm{eV}$,\n  - $E_{\\mathrm{th}} = 75 \\, \\mathrm{eV}$。\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n- 对于每个测试案例，输出一个包含四个浮点数的列表：$[\\langle E \\rangle, \\langle \\Delta E \\rangle, \\text{fraction}_{\\ge E_{\\mathrm{th}}}, \\langle E \\rangle_{\\mathrm{sput}}]$。\n- 总输出应该是一个包含这些按案例划分的列表的单一列表，例如，$[[a_1,a_2,a_3,a_4],[b_1,b_2,b_3,b_4],[c_1,c_2,c_3,c_4]]$。\n- 在打印输出中，将所有浮点数四舍五入到六位小数。",
            "solution": "该问题要求基于一维等离子体鞘层的简化动理学模型，推导并计算与撞击壁面的离子能量相关的几个统计量。解答过程首先基于所提供的离子行为概率模型，完整地推导出所需统计量的解析表达式，然后通过实现这些公式来求解给定的测试案例。\n\n壁面（$x=0$）处的离子能量 $E$ 的模型是一个混合分布。一个离子的历史属于以下两个互斥类别之一：\n1.  **无碰撞轨迹**：离子穿过整个厚度为 $s$ 的鞘层而未发生电荷交换（CX）碰撞。这种情况发生的概率为 $P_0 = e^{-s/\\lambda_{\\mathrm{cx}}}$。其最终能量是一个固定值，$E_{\\mathrm{no}} = \\Phi_s + \\frac{1}{2} T_e$。\n2.  **碰撞轨迹**：离子至少经历一次 CX 碰撞。该模型通过仅考虑最后一次 CX 事件的位置 $x \\in [0,s]$ 来简化此过程。该位置的概率密度函数为 $f_{\\mathrm{last}}(x) = \\frac{1}{\\lambda_{\\mathrm{cx}}} e^{-x/\\lambda_{\\mathrm{cx}}}$。假设离子在位置 $x$ 处从静止状态产生，并被剩余的电势加速，到达壁面时的能量为 $E(x) = \\phi(x) = \\Phi_s (x/s)^\\alpha$。这种情况的总概率为 $\\int_0^s f_{\\mathrm{last}}(x) dx = 1 - e^{-s/\\lambda_{\\mathrm{cx}}}$。\n\n所有所需量的推导都基于概率论的基本原理，特别是用于计算混合分布均值的全期望定律。\n\n### 任务1：无条件平均能量和平均能量损失\n\n#### 无条件平均离子能量, $\\langle E \\rangle$\n壁面处的平均离子能量 $\\langle E \\rangle$ 是能量随机变量 $E$ 的期望值。它通过将无碰撞和有碰撞两种情况的贡献按其各自的概率加权求和来计算：\n$$\n\\langle E \\rangle = E[\\text{collisionless}] \\cdot P(\\text{collisionless}) + E[\\text{collisional}]\n$$\n更正式地，使用全期望定律：\n$$\n\\langle E \\rangle = E_{\\mathrm{no}} \\cdot P_0 + \\int_0^s E(x) f_{\\mathrm{last}}(x) dx\n$$\n代入 $E_{\\mathrm{no}}$、$P_0$、$E(x)$ 和 $f_{\\mathrm{last}}(x)$ 的给定表达式：\n$$\n\\langle E \\rangle = \\left(\\Phi_s + \\frac{1}{2} T_e\\right) e^{-s/\\lambda_{\\mathrm{cx}}} + \\int_0^s \\left(\\Phi_s \\left(\\frac{x}{s}\\right)^\\alpha\\right) \\left(\\frac{1}{\\lambda_{\\mathrm{cx}}} e^{-x/\\lambda_{\\mathrm{cx}}}\\right) dx\n$$\n积分项代表了所有碰撞轨迹的贡献。我们来计算这个积分：\n$$\nI_E = \\int_0^s \\frac{\\Phi_s}{s^\\alpha \\lambda_{\\mathrm{cx}}} x^\\alpha e^{-x/\\lambda_{\\mathrm{cx}}} dx = \\frac{\\Phi_s}{s^\\alpha \\lambda_{\\mathrm{cx}}} \\int_0^s x^\\alpha e^{-x/\\lambda_{\\mathrm{cx}}} dx\n$$\n我们进行变量替换。令 $t = x/\\lambda_{\\mathrm{cx}}$，这意味着 $x = \\lambda_{\\mathrm{cx}} t$ 且 $dx = \\lambda_{\\mathrm{cx}} dt$。积分限从 $x \\in [0,s]$ 变为 $t \\in [0, s/\\lambda_{\\mathrm{cx}}]$。\n$$\nI_E = \\frac{\\Phi_s}{s^\\alpha \\lambda_{\\mathrm{cx}}} \\int_0^{s/\\lambda_{\\mathrm{cx}}} (\\lambda_{\\mathrm{cx}} t)^\\alpha e^{-t} (\\lambda_{\\mathrm{cx}} dt) = \\frac{\\Phi_s \\lambda_{\\mathrm{cx}}^{\\alpha+1}}{s^\\alpha \\lambda_{\\mathrm{cx}}} \\int_0^{s/\\lambda_{\\mathrm{cx}}} t^\\alpha e^{-t} dt = \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\int_0^{s/\\lambda_{\\mathrm{cx}}} t^\\alpha e^{-t} dt\n$$\n剩余的积分是下不完全伽玛函数的定义，$\\gamma(a,z) = \\int_0^z t^{a-1} e^{-t} dt$。这里，被积函数中含有 $t^\\alpha$，所以函数的第一个参数是 $a = \\alpha+1$。\n$$\n\\int_0^{s/\\lambda_{\\mathrm{cx}}} t^\\alpha e^{-t} dt = \\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right)\n$$\n将此结果代回，我们得到无条件平均能量的最终表达式：\n$$\n\\langle E \\rangle = \\left(\\Phi_s + \\frac{1}{2} T_e\\right) e^{-s/\\lambda_{\\mathrm{cx}}} + \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right)\n$$\n\n#### 无条件平均能量损失, $\\langle \\Delta E \\rangle$\n平均能量损失 $\\langle \\Delta E \\rangle$ 定义为无碰撞能量 $E_{\\mathrm{no}}$ 与实际离子能量 $E$ 之间的平均差值。利用期望算子的线性性质：\n$$\n\\langle \\Delta E \\rangle = \\langle E_{\\mathrm{no}} - E \\rangle = \\langle E_{\\mathrm{no}} \\rangle - \\langle E \\rangle\n$$\n由于 $E_{\\mathrm{no}}$ 是一个常数，其期望就是其本身，$\\langle E_{\\mathrm{no}} \\rangle = E_{\\mathrm{no}} = \\Phi_s + \\frac{1}{2} T_e$。\n$$\n\\langle \\Delta E \\rangle = \\left(\\Phi_s + \\frac{1}{2} T_e\\right) - \\langle E \\rangle\n$$\n代入推导出的 $\\langle E \\rangle$ 表达式：\n$$\n\\langle \\Delta E \\rangle = \\left(\\Phi_s + \\frac{1}{2} T_e\\right) - \\left[ \\left(\\Phi_s + \\frac{1}{2} T_e\\right) e^{-s/\\lambda_{\\mathrm{cx}}} + \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right) \\right]\n$$\n提出 $E_{\\mathrm{no}}$ 项：\n$$\n\\langle \\Delta E \\rangle = \\left(\\Phi_s + \\frac{1}{2} T_e\\right) \\left(1 - e^{-s/\\lambda_{\\mathrm{cx}}}\\right) - \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right)\n$$\n\n### 任务2：与溅射相关的量\n\n#### 引起溅射的离子比例, $F_{\\mathrm{sput}} = P(E \\ge E_{\\mathrm{th}})$\n能量大于或等于溅射阈值 $E_{\\mathrm{th}}$ 并撞击壁面的离子比例是总概率 $P(E \\ge E_{\\mathrm{th}})$。我们再次将无碰撞和有碰撞两种情况的概率相加。\n$$\nF_{\\mathrm{sput}} = P(E \\ge E_{\\mathrm{th}}) = P(E \\ge E_{\\mathrm{th}} \\text{ and collisionless}) + P(E \\ge E_{\\mathrm{th}} \\text{ and collisional})\n$$\n来自无碰撞离子的贡献仅在其能量 $E_{\\mathrm{no}}$ 达到阈值时才非零：\n$$\nP(E \\ge E_{\\mathrm{th}} \\text{ and collisionless}) = P(\\text{collisionless}) \\cdot \\mathbb{I}(E_{\\mathrm{no}} \\ge E_{\\mathrm{th}}) = e^{-s/\\lambda_{\\mathrm{cx}}} \\cdot \\mathbb{I}\\left(\\Phi_s + \\frac{1}{2} T_e \\ge E_{\\mathrm{th}}\\right)\n$$\n其中 $\\mathbb{I}(\\cdot)$ 是指示函数。\n\n对于一个碰撞离子，其能量 $E(x) = \\Phi_s(x/s)^\\alpha$ 必须至少为 $E_{\\mathrm{th}}$。这个条件定义了一个最小产生位置 $x_{\\mathrm{th}}$：\n$$\n\\Phi_s \\left(\\frac{x}{s}\\right)^\\alpha \\ge E_{\\mathrm{th}} \\implies \\frac{x}{s} \\ge \\left(\\frac{E_{\\mathrm{th}}}{\\Phi_s}\\right)^{1/\\alpha} \\implies x \\ge s \\left(\\frac{E_{\\mathrm{th}}}{\\Phi_s}\\right)^{1/\\alpha} =: x_{\\mathrm{th}}\n$$\n在 $x \\in [0,s]$ 处由 CX 产生的离子，如果其产生点 $x \\ge x_{\\mathrm{th}}$，则会引起溅射。鞘层内这类位置的范围是 $[x_{\\mathrm{th}}^*, s]$，其中 $x_{\\mathrm{th}}^* = \\max(0, \\min(s, x_{\\mathrm{th}}))$ 确保了该位置在物理上是有效的。这种情况的概率是：\n$$\nP(E \\ge E_{\\mathrm{th}} \\text{ and collisional}) = \\int_{x_{\\mathrm{th}}^*}^s f_{\\mathrm{last}}(x) dx = \\int_{x_{\\mathrm{th}}^*}^s \\frac{1}{\\lambda_{\\mathrm{cx}}} e^{-x/\\lambda_{\\mathrm{cx}}} dx\n$$\n$$\n= \\left[-e^{-x/\\lambda_{\\mathrm{cx}}}\\right]_{x_{\\mathrm{th}}^*}^s = e^{-x_{\\mathrm{th}}^*/\\lambda_{\\mathrm{cx}}} - e^{-s/\\lambda_{\\mathrm{cx}}}\n$$\n总比例是两部分贡献之和：\n$$\nF_{\\mathrm{sput}} = e^{-s/\\lambda_{\\mathrm{cx}}} \\cdot \\mathbb{I}\\left(\\Phi_s + \\frac{1}{2} T_e \\ge E_{\\mathrm{th}}\\right) + e^{-x_{\\mathrm{th}}^*/\\lambda_{\\mathrm{cx}}} - e^{-s/\\lambda_{\\mathrm{cx}}}\n$$\n\n#### 引起溅射的离子的平均能量, $\\langle E \\rangle_{\\mathrm{sput}}$\n引起溅射的离子子群体的平均能量是条件期望 $E[E | E \\ge E_{\\mathrm{th}}]$。根据定义：\n$$\n\\langle E \\rangle_{\\mathrm{sput}} = \\frac{E[E \\cdot \\mathbb{I}(E \\ge E_{\\mathrm{th}})]}{P(E \\ge E_{\\mathrm{th}})} = \\frac{1}{F_{\\mathrm{sput}}} \\left( \\sum_{\\text{events}} E \\cdot P(E \\ge E_{\\mathrm{th}}) \\right)\n$$\n分子是能量分布的一阶矩，但仅限于能量 $E \\ge E_{\\mathrm{th}}$ 的部分。我们计算其组成部分：\n1.  **无碰撞贡献**: $E_{\\mathrm{no}} \\cdot P(E_{\\mathrm{no}} \\ge E_{\\mathrm{th}} \\text{ and collisionless}) = E_{\\mathrm{no}} \\cdot e^{-s/\\lambda_{\\mathrm{cx}}} \\cdot \\mathbb{I}(E_{\\mathrm{no}} \\ge E_{\\mathrm{th}})$。\n2.  **碰撞贡献**: $\\int_{x_{\\mathrm{th}}^*}^s E(x) f_{\\mathrm{last}}(x) dx$。这是一个与 $I_E$ 相似的积分，但下限不同。\n$$\nI_{\\mathrm{sput}} = \\int_{x_{\\mathrm{th}}^*}^s \\Phi_s \\left(\\frac{x}{s}\\right)^\\alpha \\frac{1}{\\lambda_{\\mathrm{cx}}} e^{-x/\\lambda_{\\mathrm{cx}}} dx = \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\int_{x_{\\mathrm{th}}^*/\\lambda_{\\mathrm{cx}}}^{s/\\lambda_{\\mathrm{cx}}} t^\\alpha e^{-t} dt\n$$\n该积分可以表示为不完全伽玛函数的差：\n$$\n\\int_{x_{\\mathrm{th}}^*/\\lambda_{\\mathrm{cx}}}^{s/\\lambda_{\\mathrm{cx}}} t^\\alpha e^{-t} dt = \\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right) - \\gamma\\left(\\alpha+1, \\frac{x_{\\mathrm{th}}^*}{\\lambda_{\\mathrm{cx}}}\\right)\n$$\n因此，分子中的碰撞贡献项为：\n$$\nI_{\\mathrm{sput}} = \\Phi_s \\left(\\frac{\\lambda_{\\mathrm{cx}}}{s}\\right)^\\alpha \\left[\\gamma\\left(\\alpha+1, \\frac{s}{\\lambda_{\\mathrm{cx}}}\\right) - \\gamma\\left(\\alpha+1, \\frac{x_{\\mathrm{th}}^*}{\\lambda_{\\mathrm{cx}}}\\right)\\right]\n$$\n综合这些部分，引起溅射的平均能量的完整表达式为：\n$$\n\\langle E \\rangle_{\\mathrm{sput}} = \\frac{1}{F_{\\mathrm{sput}}} \\left( \\left(\\Phi_s + \\frac{1}{2}T_e\\right) e^{-s/\\lambda_{\\mathrm{cx}}} \\mathbb{I}\\left(E_{\\mathrm{no}} \\ge E_{\\mathrm{th}}\\right) + I_{\\mathrm{sput}} \\right)\n$$\n如果 $F_{\\mathrm{sput}} = 0$，则没有离子引起溅射，平均能量未定义。在这种情况下，我们将返回 $0$。\n\n这些推导出的公式是纯解析的，可以直接实现用于计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammainc, gamma\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: (s, Phi_s, lambda_cx, alpha, T_e, E_th)\n        (0.005, 200.0, 0.5, 4.0/3.0, 10.0, 30.0),\n        # Case B\n        (0.005, 200.0, 0.0005, 1.0, 10.0, 50.0),\n        # Case C\n        (0.002, 100.0, 0.001, 2.0, 5.0, 75.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        s, Phi_s, lambda_cx, alpha, T_e, E_th = case\n        \n        # --- Task 1: Mean Energy and Mean Energy Loss ---\n\n        # Intermediate variables\n        s_over_lambda = s / lambda_cx\n        E_no = Phi_s + 0.5 * T_e\n        P0 = np.exp(-s_over_lambda)\n        \n        # The lower incomplete gamma function gamma(a,x) is implemented in scipy as\n        # gammainc(a,x) * gamma(a), where gammainc is the regularized version.\n        g_s = gammainc(alpha + 1, s_over_lambda) * gamma(alpha + 1)\n        \n        # Contribution to mean energy from collisional ions\n        coll_energy_contrib = Phi_s * (lambda_cx / s)**alpha * g_s\n        \n        # Unconditional mean ion energy\n        mean_E = E_no * P0 + coll_energy_contrib\n        \n        # Unconditional mean energy loss\n        mean_delta_E = E_no - mean_E\n        \n        # --- Task 2: Sputtering-related quantities ---\n\n        # Threshold position x_th and its clipped version x_th_star\n        x_th = s * (E_th / Phi_s)**(1/alpha) if Phi_s > 0 else float('inf')\n        x_th_star = np.clip(x_th, 0, s)\n\n        # Fraction of ions causing sputtering (F_sput)\n        sputter_frac_collisionless = 0\n        if E_no >= E_th:\n            sputter_frac_collisionless = P0\n\n        sputter_frac_collisional = 0\n        if E_th = Phi_s:\n             sputter_frac_collisional = np.exp(-x_th_star / lambda_cx) - P0\n        \n        F_sput = sputter_frac_collisionless + sputter_frac_collisional\n        \n        # Mean energy of sputtering ions\n        mean_E_sput = 0\n        if F_sput > 1e-12: # Avoid division by zero\n            # Collisionless contribution to the numerator of the expectation\n            num_contrib_collisionless = E_no * sputter_frac_collisionless\n            \n            # Collisional contribution\n            num_contrib_collisional = 0\n            if E_th = Phi_s:\n                g_x_th_star = gammainc(alpha + 1, x_th_star / lambda_cx) * gamma(alpha + 1)\n                I_sput = Phi_s * (lambda_cx / s)**alpha * (g_s - g_x_th_star)\n                num_contrib_collisional = I_sput\n\n            numerator = num_contrib_collisionless + num_contrib_collisional\n            mean_E_sput = numerator / F_sput\n\n        all_results.append([\n            round(mean_E, 6),\n            round(mean_delta_E, 6),\n            round(F_sput, 6),\n            round(mean_E_sput, 6)\n        ])\n\n    # Format output as a list of lists\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}