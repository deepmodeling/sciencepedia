{
    "hands_on_practices": [
        {
            "introduction": "The transition from the quasi-neutral bulk plasma to a material wall is not abrupt but is structured into distinct regions: a large-scale, quasi-neutral \"presheath\" where ions are accelerated, and a thin, non-neutral \"sheath\" at the wall itself. This practice introduces matched asymptotic expansion, a powerful mathematical technique used to connect solutions across different physical scales . By treating the ratio of the Debye length to the system size as a small parameter, you will construct a uniformly valid solution for the electrostatic potential, gaining insight into the fundamental structure of plasma boundary layers.",
            "id": "3971714",
            "problem": "Consider a one-dimensional, steady-state, electrostatic plasma in the vicinity of a planar wall within a fusion-relevant divertor-like configuration. Let $x$ denote the spatial coordinate normal to the wall, with $x=0$ at the wall and increasing into the plasma. The electron population is isothermal with temperature $T_{e}$, and the ions are cold but their density variation across the presheath is slow on the macroscopic length scale $L$. Let the dimensionless electrostatic potential be $y(x) = e \\phi(x) / (k_{B} T_{e})$, and nondimensionalize space via $x \\mapsto x/L$ so that the presheath scale is $\\mathcal{O}(1)$. The small parameter is $\\epsilon = \\lambda_{D}/L \\ll 1$, where $\\lambda_{D} = \\sqrt{\\varepsilon_{0} k_{B} T_{e} / (n_{\\infty} e^{2})}$ is the Debye length with $n_{\\infty}$ a characteristic density far from the wall. The dimensionless electron density is taken in the small-potential limit as $n_{e}(x) \\approx 1 + y(x)$, consistent with the linearized Boltzmann relation for $|y| \\ll 1$, and the ion density in the quasi-neutral presheath at leading order is specified as a slowly varying profile\n$$\nn_{i}(x) = g(x) = g_{s} + \\alpha x,\n$$\nwhere $g_{s} > 0$ and $\\alpha$ are dimensionless constants, with $|\\alpha| = \\mathcal{O}(1)$ and $g_{s}$ representing the sheath-edge ion density relative to $n_{\\infty}$. The governing equation across both the non-neutral sheath and quasi-neutral presheath is the nondimensional Poisson equation\n$$\n\\epsilon^{2} \\frac{d^{2} y}{dx^{2}} = n_{e}(x) - n_{i}(x) = 1 + y(x) - g(x),\n$$\nwith boundary condition at the wall $y(0) = y_{w}$, where $y_{w}$ is the specified dimensionless wall potential. Far into the plasma ($x \\gg \\epsilon$), the solution must remain bounded and consistent with quasi-neutrality.\n\nStarting from these premises, perform a matched asymptotic expansion between the outer quasi-neutral presheath solution and the inner non-neutral sheath boundary-layer solution by expanding in the small parameter $\\epsilon = \\lambda_{D}/L$. Use the stretched inner coordinate $\\xi = x/\\epsilon$ in the sheath layer, derive the leading-order outer and inner solutions, enforce the matching conditions, and construct a uniformly valid composite solution for the dimensionless potential $y_{\\text{comp}}(x)$ that is accurate to $\\mathcal{O}(\\epsilon)$ over $x \\in [0,1]$. Express your final answer as a single closed-form analytic expression in terms of $x$, $\\epsilon$, $g_{s}$, $\\alpha$, and $y_{w}$. No numerical evaluation is required.",
            "solution": "The user wants me to solve a problem regarding a one-dimensional, steady-state, electrostatic plasma.\n\n### Step 1: Extract Givens\n\n-   **System**: One-dimensional ($x$), steady-state, electrostatic plasma near a planar wall at $x=0$.\n-   **Dimensionless Potential**: $y(x) = e \\phi(x) / (k_{B} T_{e})$.\n-   **Nondimensionalization**: Space is $x/L$, small parameter is $\\epsilon = \\lambda_{D}/L \\ll 1$, where $\\lambda_{D} = \\sqrt{\\varepsilon_{0} k_{B} T_{e} / (n_{\\infty} e^{2})}$.\n-   **Dimensionless Electron Density**: $n_{e}(x) \\approx 1 + y(x)$.\n-   **Dimensionless Ion Density**: $n_{i}(x) = g(x) = g_{s} + \\alpha x$, where $g_{s} > 0$ and $\\alpha = \\mathcal{O}(1)$.\n-   **Governing Equation (Poisson's Equation)**: $\\epsilon^{2} \\frac{d^{2} y}{dx^{2}} = n_{e}(x) - n_{i}(x) = 1 + y(x) - g(x)$.\n-   **Boundary Conditions**:\n    1.  At the wall: $y(0) = y_{w}$.\n    2.  Far from the wall ($x \\gg \\epsilon$): The solution must be bounded and consistent with quasi-neutrality.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem describes a simplified but standard physical model of a plasma sheath and presheath. The governing equation is Poisson's equation, and the density models (linearized Boltzmann for electrons, prescribed slow variation for ions) are common approximations in plasma physics. All elements are based on established scientific principles.\n-   **Well-Posed**: The problem is a second-order linear ordinary differential equation (ODE) with a boundary condition at one end and a regularity/boundedness condition at the other. This constitutes a well-posed boundary value problem, particularly for a singular perturbation analysis.\n-   **Objective**: The problem is stated using precise, unambiguous mathematical language.\n-   **Conclusion**: All validation criteria are met. The problem is a standard, solvable exercise in matched asymptotic expansions. It does not contain any scientific falsehoods, contradictions, or ambiguities.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Solution\n\nThe problem requires constructing a uniformly valid composite solution for the dimensionless potential $y(x)$ using matched asymptotic expansions. The governing equation is a second-order linear ODE with a small parameter $\\epsilon$ multiplying the highest derivative, which indicates a boundary layer problem.\n\nThe governing ODE can be written as:\n$$\n\\epsilon^{2} \\frac{d^{2} y}{dx^{2}} - y = 1 - g(x) = 1 - (g_{s} + \\alpha x)\n$$\n\nWe will find separate solutions for the outer region (presheath) and the inner region (sheath) and then match them.\n\n**Outer Solution (Presheath, $x \\sim \\mathcal{O}(1)$)**\n\nIn the outer region, we assume $x$ and its derivatives are of order unity. We seek an outer solution of the form $y_{\\text{out}}(x) = y_0(x) + \\epsilon y_1(x) + \\epsilon^2 y_2(x) + \\dots$.\nSubstituting this into the governing equation:\n$$\n\\epsilon^{2} \\frac{d^{2}}{dx^{2}}(y_0 + \\epsilon y_1 + \\dots) - (y_0 + \\epsilon y_1 + \\dots) = 1 - g(x)\n$$\nWe collect terms order by order in $\\epsilon$.\n\nAt leading order, $\\mathcal{O}(\\epsilon^0)$:\n$$\n-y_0(x) = 1 - g(x)\n$$\nThis is the condition of quasi-neutrality, $n_e \\approx n_i$, which translates to $1+y_0 \\approx g(x)$.\nThe leading-order outer solution is:\n$$\ny_0(x) = g(x) - 1 = g_{s} + \\alpha x - 1\n$$\nThis solution satisfies the boundedness condition far from the wall but does not, in general, satisfy the wall boundary condition $y(0) = y_w$. This discrepancy is resolved by the inner boundary layer.\n\n**Inner Solution (Sheath, $x \\sim \\mathcal{O}(\\epsilon)$)**\n\nNear the wall at $x=0$, we introduce a stretched coordinate $\\xi = x/\\epsilon$. The derivatives transform as $\\frac{d}{dx} = \\frac{1}{\\epsilon}\\frac{d}{d\\xi}$ and $\\frac{d^2}{dx^2} = \\frac{1}{\\epsilon^2}\\frac{d^2}{d\\xi^2}$.\nSubstituting these into the governing ODE, we get:\n$$\n\\epsilon^{2} \\left(\\frac{1}{\\epsilon^2}\\frac{d^2 y}{d\\xi^2}\\right) - y = 1 - g(\\epsilon\\xi) = 1 - (g_{s} + \\alpha\\epsilon\\xi)\n$$\n$$\n\\frac{d^{2} y}{d\\xi^{2}} - y = 1 - g_s - \\alpha\\epsilon\\xi\n$$\nWe seek an inner solution of the form $y_{\\text{in}}(\\xi) = Y_0(\\xi) + \\epsilon Y_1(\\xi) + \\dots$.\nSubstituting and collecting terms:\n$$\n\\left(\\frac{d^2 Y_0}{d\\xi^2} + \\epsilon\\frac{d^2 Y_1}{d\\xi^2} + \\dots\\right) - (Y_0 + \\epsilon Y_1 + \\dots) = 1 - g_s - \\alpha\\epsilon\\xi\n$$\n\nAt leading order, $\\mathcal{O}(\\epsilon^0)$:\n$$\n\\frac{d^2 Y_0}{d\\xi^2} - Y_0 = 1 - g_s\n$$\nThis is a second-order linear ODE with constant coefficients. The general solution is the sum of a homogeneous solution ($C_1 e^{\\xi} + C_2 e^{-\\xi}$) and a particular solution (constant $g_s - 1$).\n$$\nY_0(\\xi) = C_1 e^{\\xi} + C_2 e^{-\\xi} + g_s - 1\n$$\n\n**Asymptotic Matching**\n\nTo determine the unknown constants, we apply the matching principle (Van Dyke's rule): the outer limit of the inner solution must equal the inner limit of the outer solution.\n$$\n\\lim_{\\xi \\to \\infty} Y_0(\\xi) = \\lim_{x \\to 0} y_0(x)\n$$\nThe inner limit of the leading-order outer solution is:\n$$\n\\lim_{x \\to 0} y_0(x) = \\lim_{x \\to 0} (g_s + \\alpha x - 1) = g_s - 1\n$$\nThe outer limit of the leading-order inner solution is:\n$$\n\\lim_{\\xi \\to \\infty} Y_0(\\xi) = \\lim_{\\xi \\to \\infty} (C_1 e^{\\xi} + C_2 e^{-\\xi} + g_s - 1)\n$$\nFor this limit to be finite and match $g_s - 1$, the exponentially growing term $C_1 e^{\\xi}$ must be eliminated. Thus, we must have $C_1=0$. The limit then becomes $g_s-1$, which matches the outer limit.\nThe leading-order inner solution is therefore:\n$$\nY_0(\\xi) = C_2 e^{-\\xi} + g_s - 1\n$$\n\n**Application of Boundary Condition**\n\nThe inner solution must satisfy the boundary condition at the wall, $y(0) = y_w$. At leading order, this means $Y_0(0) = y_w$.\n$$\nY_0(0) = C_2 e^{0} + g_s - 1 = C_2 + g_s - 1\n$$\nSetting this equal to $y_w$ gives:\n$$\ny_w = C_2 + g_s - 1 \\implies C_2 = y_w - g_s + 1\n$$\nSo, the full leading-order inner solution is:\n$$\nY_0(\\xi) = (y_w - g_s + 1)e^{-\\xi} + g_s - 1\n$$\n\n**Construction of the Composite Solution**\n\nA uniformly valid composite solution, accurate to $\\mathcal{O}(\\epsilon)$, is constructed by adding the outer and inner solutions and subtracting their common part (the matched part) to avoid double counting.\n$$\ny_{\\text{comp}}(x) = y_{\\text{out}}(x) + y_{\\text{in}}(x/\\epsilon) - y_{\\text{match}}(x)\n$$\nThe components are:\n-   Outer solution: $y_{\\text{out}}(x) \\approx y_0(x) = g_s + \\alpha x - 1$.\n-   Inner solution: $y_{\\text{in}}(x/\\epsilon) \\approx Y_0(x/\\epsilon) = (y_w - g_s + 1) e^{-x/\\epsilon} + g_s - 1$.\n-   Common part (matching term): $y_{\\text{match}}(x) = \\lim_{x \\to 0} y_0(x) = g_s - 1$.\n\nSubstituting these into the formula for the composite solution:\n$$\ny_{\\text{comp}}(x) = (g_s + \\alpha x - 1) + \\left[ (y_w - g_s + 1) e^{-x/\\epsilon} + g_s - 1 \\right] - (g_s - 1)\n$$\nCombining terms:\n$$\ny_{\\text{comp}}(x) = g_s + \\alpha x - 1 + (y_w - g_s + 1) e^{-x/\\epsilon} + (g_s - 1) - (g_s - 1)\n$$\n$$\ny_{\\text{comp}}(x) = (y_w - g_s + 1) e^{-x/\\epsilon} + g_s + \\alpha x - 1\n$$\nThis expression is the uniformly valid composite solution. It correctly reduces to the inner solution for $x \\ll 1$ and to the outer solution for $x \\gg \\epsilon$. For this specific linear problem, this leading-order composite solution happens to be the exact solution to the original ODE, thus it is accurate to all orders, far exceeding the requirement of $\\mathcal{O}(\\epsilon)$.",
            "answer": "$$\n\\boxed{(y_{w} - g_{s} + 1) \\exp\\left(-\\frac{x}{\\epsilon}\\right) + g_{s} + \\alpha x - 1}\n$$"
        },
        {
            "introduction": "Complex computational fluid codes used in fusion science are built upon physical models, but their accuracy must be rigorously verified against known solutions. This exercise places you in the role of a computational scientist tasked with creating an analytic benchmark for a scrape-off layer (SOL) simulation . Starting from the fundamental fluid equations and the Bohm criterion, you will derive the exact particle and heat fluxes at the sheath entrance, providing a concrete target for code validation and developing skills in translating theoretical physics into practical verification tests.",
            "id": "3971663",
            "problem": "You are tasked with designing and implementing a verification test for a Scrape-Off Layer (SOL) fluid code in the isothermal, collisionless sheath limit. The objective is to assess the fidelity of the simulated parallel fluxes at the sheath entrance against an analytic benchmark defined by the Bohm criterion and a known heat transmission coefficient. You must derive the benchmark formulas from first principles and then compute quantitative error metrics comparing given code-reported fluxes to the benchmark.\n\nAssumptions and fundamental bases:\n- The plasma is steady-state, one-dimensional, quasi-neutral, and isothermal along the field line between an upstream location and the sheath entrance.\n- The ions are singly charged, cold relative to electrons, and the electrons are isothermal with temperature $T_e$.\n- The ion flow at the sheath entrance satisfies the Bohm criterion with equality, i.e., $u_i = c_s$, where $c_s$ is the ion sound speed.\n- The ion sound speed is $c_s = \\sqrt{T_e/m_i}$, where $m_i$ is the ion mass and $T_e$ is expressed in Joules.\n- Mass conservation yields a constant particle flux $\\Gamma = n u$ along the field line.\n- Steady isothermal momentum balance gives $m_i u \\, du/dx = - T_e \\, d(\\ln n)/dx$.\n- At the sheath entrance, the total parallel heat flux to the wall is modeled as $q_\\parallel = \\gamma \\, n_s \\, T_e \\, c_s$, where $n_s$ is the density at the sheath entrance, and $\\gamma$ is a known, dimensionless heat transmission coefficient derived from kinetic theory for isothermal sheaths. The value of $\\gamma$ is provided for each test case.\n\nYour derivation must use the above fundamental relations only and must not invoke any other shortcut formulas. Let the upstream state be characterized by density $n_0$, ion Mach number $M_0 = u_0 / c_s$ with $0 < M_0 < 1$, and electron temperature $T_e$. Show that integrating the momentum balance implies the invariant\n$$\n\\frac{1}{2} m_i u^2 + T_e \\ln n = \\text{constant},\n$$\nand, using the Bohm condition $u_s = c_s$ at the sheath entrance, prove that\n$$\nn_s = n_0 \\exp\\!\\left(\\frac{1}{2}\\left(M_0^2 - 1\\right)\\right).\n$$\nThen deduce the analytic benchmark particle flux and heat flux at the sheath entrance as\n$$\n\\Gamma^\\star = n_s \\, c_s, \\quad q^\\star = \\gamma \\, n_s \\, T_e \\, c_s.\n$$\nAll instances of $T_e$ in formulas used for computation must be converted from electronvolts to Joules via $T_e \\, [\\text{J}] = T_e \\, [\\text{eV}] \\times e$, where $e = 1.602176634 \\times 10^{-19}$ is the elementary charge in Coulombs. All computed fluxes must be in International System of Units: $\\Gamma^\\star$ in $\\text{m}^{-2}\\,\\text{s}^{-1}$ and $q^\\star$ in $\\text{W}\\,\\text{m}^{-2}$.\n\nVerification and error metrics:\n- For each test case, you are given a pair of code-reported fluxes $(\\Gamma^{\\text{num}}, q^{\\text{num}})$ intended to represent the output of a SOL fluid code at the sheath entrance for the same upstream parameters.\n- Define the relative particle-flux error and relative heat-flux error as\n$$\n\\varepsilon_\\Gamma = \\frac{\\left|\\Gamma^{\\text{num}} - \\Gamma^\\star\\right|}{\\Gamma^\\star}, \\quad \n\\varepsilon_q = \\frac{\\left|q^{\\text{num}} - q^\\star\\right|}{q^\\star}.\n$$\n- Define the aggregate error metric as the root-mean-square of the two relative errors:\n$$\n\\varepsilon_{\\text{rms}} = \\sqrt{\\frac{\\varepsilon_\\Gamma^2 + \\varepsilon_q^2}{2}}.\n$$\nAll error metrics are dimensionless and must be reported as decimals (not percentages).\n\nTest suite:\nFor each case, the parameters are $(m_i \\, [\\text{kg}], \\, T_e \\, [\\text{eV}], \\, n_0 \\, [\\text{m}^{-3}], \\, M_0 \\, [\\text{dimensionless}], \\, \\gamma \\, [\\text{dimensionless}], \\, \\Gamma^{\\text{num}} \\, [\\text{m}^{-2}\\,\\text{s}^{-1}], \\, q^{\\text{num}} \\, [\\text{W}\\,\\text{m}^{-2}])$. Use the given values exactly.\n\n- Case A (happy path, modest subsonic inflow):\n  - $m_i = 3.345 \\times 10^{-27}$, $T_e = 20.0$, $n_0 = 1.0 \\times 10^{19}$, $M_0 = 0.10$, $\\gamma = 7.0$.\n  - Define the code-reported fluxes as multiplicative perturbations of the benchmark: $\\Gamma^{\\text{num}} = 1.02 \\, \\Gamma^\\star$, $q^{\\text{num}} = 0.97 \\, q^\\star$.\n- Case B (near-Bohm upstream, zero error):\n  - $m_i = 3.345 \\times 10^{-27}$, $T_e = 5.0$, $n_0 = 5.0 \\times 10^{18}$, $M_0 = 0.95$, $\\gamma = 7.0$.\n  - $\\Gamma^{\\text{num}} = 1.00 \\, \\Gamma^\\star$, $q^{\\text{num}} = 1.00 \\, q^\\star$.\n- Case C (different ion species and temperature, larger discrepancies):\n  - $m_i = 6.644657 \\times 10^{-27}$, $T_e = 3.0$, $n_0 = 2.0 \\times 10^{19}$, $M_0 = 0.50$, $\\gamma = 6.5$.\n  - $\\Gamma^{\\text{num}} = 0.90 \\, \\Gamma^\\star$, $q^{\\text{num}} = 1.15 \\, q^\\star$.\n- Case D (very subsonic upstream, no discrepancy):\n  - $m_i = 3.345 \\times 10^{-27}$, $T_e = 100.0$, $n_0 = 1.0 \\times 10^{18}$, $M_0 = 0.01$, $\\gamma = 7.0$.\n  - $\\Gamma^{\\text{num}} = 1.00 \\, \\Gamma^\\star$, $q^{\\text{num}} = 1.00 \\, q^\\star$.\n\nProgramming task and required output:\n- Implement a program that, for each test case, computes $c_s$, $n_s$, $\\Gamma^\\star$, and $q^\\star$ using the formulas above, constructs $(\\Gamma^{\\text{num}}, q^{\\text{num}})$ according to the specified multiplicative relations, and evaluates $\\varepsilon_\\Gamma$, $\\varepsilon_q$, and $\\varepsilon_{\\text{rms}}$.\n- Your program should produce a single line of output containing the results as a list of lists with three decimal floats per test case in the order $[\\varepsilon_\\Gamma, \\varepsilon_q, \\varepsilon_{\\text{rms}}]$. The final output must be formatted exactly as:\n\"[ [err_Gamma_A, err_q_A, err_rms_A], [err_Gamma_B, err_q_B, err_rms_B], [err_Gamma_C, err_q_C, err_rms_C], [err_Gamma_D, err_q_D, err_rms_D] ]\"\nbut without any spaces except those inherently produced inside the inner lists by Python’s default list-to-string conversion. The errors must be decimals, not percentages.\n\nAll intermediate quantities must be in coherent International System of Units, and all angles (if any) must be in radians, although no angles are expected in this problem. The program must use the test suite given here and must not request any user input.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in established principles of plasma fluid dynamics, specifically the isothermal, one-dimensional model of the scrape-off layer terminating at a sheath. The problem is well-posed, with all necessary data and definitions provided for a unique solution. The language is objective and the tasks are formalizable. We may therefore proceed with the solution.\n\nThe task is to derive analytic expressions for the particle and heat fluxes at the entrance to a collisionless sheath and to use these as benchmarks for verifying a numerical fluid code. This involves two main parts: first, the derivation of the necessary formulas from first principles, and second, the implementation of these formulas to compute error metrics for a given set of test cases.\n\n### Derivation of Analytic Benchmarks\n\nWe begin by deriving the required relations based on the provided assumptions. The plasma is in a steady state ($\\partial/\\partial t = 0$), one-dimensional ($1$D) along a magnetic field line (coordinate $x$), quasi-neutral ($n_i \\approx n_e = n$), and the electrons are isothermal with a constant temperature $T_e$.\n\n**1. Derivation of the Plasma Flow Invariant**\n\nThe steady-state, $1$D ion momentum balance equation is given as:\n$$\nm_i u \\frac{du}{dx} = - T_e \\frac{d(\\ln n)}{dx}\n$$\nwhere $m_i$ is the ion mass, $u$ is the ion fluid velocity, $n$ is the plasma density, and $T_e$ is the electron temperature in Joules. The electron temperature $T_e$ is constant along the field line.\n\nThe left-hand side of the equation can be expressed as the spatial derivative of the ion kinetic energy per particle:\n$$\nm_i u \\frac{du}{dx} = \\frac{d}{dx} \\left( \\frac{1}{2} m_i u^2 \\right)\n$$\nThe right-hand side involves the derivative of the natural logarithm of the density, which relates to the electron pressure gradient force, $-(1/n) \\nabla p_e = -(T_e/n) \\nabla n = -T_e \\nabla(\\ln n)$. Since $T_e$ is constant, it can be brought inside the derivative:\n$$\n-T_e \\frac{d(\\ln n)}{dx} = -\\frac{d}{dx} (T_e \\ln n)\n$$\nEquating the rewritten expressions gives:\n$$\n\\frac{d}{dx} \\left( \\frac{1}{2} m_i u^2 \\right) = -\\frac{d}{dx} (T_e \\ln n)\n$$\nThis can be rearranged into a single derivative:\n$$\n\\frac{d}{dx} \\left( \\frac{1}{2} m_i u^2 + T_e \\ln n \\right) = 0\n$$\nIntegrating this equation with respect to the spatial coordinate $x$ yields the desired invariant:\n$$\n\\frac{1}{2} m_i u^2 + T_e \\ln n = \\text{constant}\n$$\nThis expression is a form of Bernoulli's equation for the isothermal plasma flow, stating that the sum of the ion kinetic energy and the work done by the electron pressure is conserved along a streamline.\n\n**2. Derivation of the Sheath Entrance Density, $n_s$**\n\nThe derived invariant holds for any two points in the flow domain. We apply this relation between an upstream location, denoted by subscript $0$, and the sheath entrance, denoted by subscript $s$.\n$$\n\\frac{1}{2} m_i u_0^2 + T_e \\ln n_0 = \\frac{1}{2} m_i u_s^2 + T_e \\ln n_s\n$$\nThe problem specifies the following conditions:\n- The upstream ion flow is characterized by a Mach number $M_0 = u_0 / c_s$, so $u_0 = M_0 c_s$.\n- The flow at the sheath entrance satisfies the Bohm criterion with equality: $u_s = c_s$.\n- The ion sound speed is $c_s = \\sqrt{T_e/m_i}$.\n\nSubstituting these into the invariant equation:\n$$\n\\frac{1}{2} m_i (M_0 c_s)^2 + T_e \\ln n_0 = \\frac{1}{2} m_i c_s^2 + T_e \\ln n_s\n$$\nNow, we substitute the expression for the sound speed squared, $c_s^2 = T_e/m_i$:\n$$\n\\frac{1}{2} m_i M_0^2 \\left(\\frac{T_e}{m_i}\\right) + T_e \\ln n_0 = \\frac{1}{2} m_i \\left(\\frac{T_e}{m_i}\\right) + T_e \\ln n_s\n$$\nSimplifying the terms, we get:\n$$\n\\frac{1}{2} M_0^2 T_e + T_e \\ln n_0 = \\frac{1}{2} T_e + T_e \\ln n_s\n$$\nSince the electron temperature $T_e$ must be positive for a physical plasma, we can divide the entire equation by $T_e$:\n$$\n\\frac{1}{2} M_0^2 + \\ln n_0 = \\frac{1}{2} + \\ln n_s\n$$\nTo solve for $n_s$, we rearrange the equation to isolate the logarithmic terms:\n$$\n\\ln n_s - \\ln n_0 = \\frac{1}{2} M_0^2 - \\frac{1}{2}\n$$\nUsing the property of logarithms, $\\ln a - \\ln b = \\ln(a/b)$:\n$$\n\\ln \\left( \\frac{n_s}{n_0} \\right) = \\frac{1}{2} \\left( M_0^2 - 1 \\right)\n$$\nFinally, exponentiating both sides gives the expression for the density at the sheath entrance, $n_s$:\n$$\nn_s = n_0 \\exp\\left( \\frac{1}{2} \\left( M_0^2 - 1 \\right) \\right)\n$$\nThis derivation is complete and confirms the provided formula.\n\n**3. Benchmark Fluxes and Error Metrics**\n\nWith the expression for $n_s$, we can define the benchmark fluxes.\n- The particle flux, $\\Gamma$, is defined by mass conservation as $\\Gamma = n u$. At the sheath entrance, $n=n_s$ and $u=u_s=c_s$. Therefore, the benchmark particle flux is:\n  $$\n  \\Gamma^\\star = n_s c_s\n  $$\n- The parallel heat flux, $q_\\parallel$, at the sheath entrance is given by a kinetic closure model: $q_\\parallel = \\gamma n_s T_e c_s$, where $\\gamma$ is the sheath heat transmission coefficient. Thus, the benchmark heat flux is:\n  $$\n  q^\\star = \\gamma n_s T_e c_s\n  $$\nIn all computations, the electron temperature $T_e$ must be in units of Joules. The conversion from electronvolts (eV) is given by $T_e \\, [\\text{J}] = T_e \\, [\\text{eV}] \\times e$, where $e = 1.602176634 \\times 10^{-19} \\, \\text{C}$ is the elementary charge.\n\nThe error metrics comparing the numerical fluxes ($\\Gamma^{\\text{num}}, q^{\\text{num}}$) to the benchmarks ($\\Gamma^\\star, q^\\star$) are defined as:\n- Relative particle-flux error: $\\varepsilon_\\Gamma = \\frac{\\left|\\Gamma^{\\text{num}} - \\Gamma^\\star\\right|}{\\Gamma^\\star}$\n- Relative heat-flux error: $\\varepsilon_q = \\frac{\\left|q^{\\text{num}} - q^\\star\\right|}{q^\\star}$\n- Aggregate root-mean-square error: $\\varepsilon_{\\text{rms}} = \\sqrt{\\frac{\\varepsilon_\\Gamma^2 + \\varepsilon_q^2}{2}}$\n\n### Computational Procedure\n\nFor each test case, the following sequence of calculations will be performed:\n1.  Retrieve the input parameters: $m_i$, $T_e$ [eV], $n_0$, $M_0$, and $\\gamma$.\n2.  Convert the electron temperature to SI units: $T_{e, \\text{J}} = T_e \\, [\\text{eV}] \\times e$.\n3.  Calculate the ion sound speed: $c_s = \\sqrt{T_{e, \\text{J}} / m_i}$.\n4.  Calculate the sheath entrance density: $n_s = n_0 \\exp(0.5 \\times (M_0^2 - 1))$.\n5.  Calculate the benchmark particle flux: $\\Gamma^\\star = n_s c_s$.\n6.  Calculate the benchmark heat flux: $q^\\star = \\gamma n_s T_{e, \\text{J}} c_s$.\n7.  Construct the numerical fluxes, $\\Gamma^{\\text{num}}$ and $q^{\\text{num}}$, using the specified multiplicative factors for the specific test case.\n8.  Calculate the relative errors $\\varepsilon_\\Gamma$ and $\\varepsilon_q$. As the numerical values are given as $\\Gamma^{\\text{num}} = p_\\Gamma \\Gamma^\\star$ and $q^{\\text{num}} = p_q q^\\star$, where $p_\\Gamma$ and $p_q$ are the perturbation factors, the errors simplify to $\\varepsilon_\\Gamma = |p_\\Gamma - 1|$ and $\\varepsilon_q = |p_q - 1|$.\n9.  Calculate the aggregate error $\\varepsilon_{\\text{rms}}$.\n10. Collate the three error metrics for the final output.\n\nThis procedure will be implemented programmatically to process the test suite and generate the required output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes verification test error metrics for a SOL fluid code.\n\n    This function implements the derived analytic benchmarks for particle and\n    heat fluxes at the sheath entrance in an isothermal, collisionless plasma.\n    It then calculates relative and RMS errors against specified \"numerical\"\n    fluxes for a suite of test cases.\n    \"\"\"\n    # Define physical constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n\n    # Define the test suite.\n    # Each case: (m_i [kg], T_e [eV], n_0 [m^-3], M_0, gamma, pert_gamma, pert_q)\n    # pert_gamma is the factor for Gamma_num = pert_gamma * Gamma_star\n    # pert_q is the factor for q_num = pert_q * q_star\n    test_cases = [\n        # Case A: happy path, modest subsonic inflow\n        (3.345e-27, 20.0, 1.0e19, 0.10, 7.0, 1.02, 0.97),\n        # Case B: near-Bohm upstream, zero error\n        (3.345e-27, 5.0, 5.0e18, 0.95, 7.0, 1.00, 1.00),\n        # Case C: different ion species and temperature, larger discrepancies\n        (6.644657e-27, 3.0, 2.0e19, 0.50, 6.5, 0.90, 1.15),\n        # Case D: very subsonic upstream, no discrepancy\n        (3.345e-27, 100.0, 1.0e18, 0.01, 7.0, 1.00, 1.00),\n    ]\n\n    results = []\n    for case in test_cases:\n        m_i, T_e_eV, n_0, M_0, gamma, pert_gamma, pert_q = case\n\n        # 1. Convert Te to Joules\n        T_e_J = T_e_eV * E_CHARGE\n\n        # 2. Calculate ion sound speed (c_s)\n        c_s = np.sqrt(T_e_J / m_i)\n\n        # 3. Calculate sheath entrance density (n_s)\n        n_s = n_0 * np.exp(0.5 * (M_0**2 - 1.0))\n\n        # 4. Calculate benchmark fluxes (Gamma_star, q_star)\n        # These calculations are part of the required procedure, even if the\n        # errors can be computed directly from the perturbation factors.\n        gamma_star = n_s * c_s\n        q_star = gamma * n_s * T_e_J * c_s\n\n        # 5. Construct \"numerical\" fluxes\n        gamma_num = pert_gamma * gamma_star\n        q_num = pert_q * q_star\n\n        # 6. Calculate relative errors (epsilon_gamma, epsilon_q)\n        # This simplifies to abs(perturbation factor - 1)\n        err_gamma = np.abs(gamma_num - gamma_star) / gamma_star\n        err_q = np.abs(q_num - q_star) / q_star\n\n        # 7. Calculate aggregate RMS error (epsilon_rms)\n        err_rms = np.sqrt((err_gamma**2 + err_q**2) / 2.0)\n\n        results.append([err_gamma, err_q, err_rms])\n\n    # Final print statement in the exact required format.\n    # The format string produces output like [[a,b,c],[d,e,f]]\n    # which matches the problem description of a list of lists.\n    # Python's default str(list) produces spaces after commas, as required.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A successful plasma simulation requires not only a correct physical model but also a stable numerical implementation, which is often governed by the fastest time scales in the system. This practice explores the fundamental numerical stability constraints encountered when simulating sheath dynamics, focusing on the ubiquitous electron plasma oscillation . You will derive the famous Courant-like condition for an explicit time integration scheme and contrast it with the stability of an implicit scheme, providing essential knowledge for designing and troubleshooting time-dependent plasma codes.",
            "id": "3971597",
            "problem": "You are tasked with deriving and implementing numerical timestep constraints for one-dimensional electrostatic sheath dynamics by comparing an explicit and an implicit time integration of the linearized cold-electron fluid model coupled to electrostatics. Begin from first principles applicable to computational fusion science and engineering: Newton’s second law, the electron continuity equation, and the electrostatic Poisson equation. Assume a cold electron fluid, immobile ion background, and small perturbations about a uniform state, so that convection may be neglected to leading order. Your goals are: derive the discrete-time stability bound for an explicit central-difference time integrator applied to the linearized electron-plasma oscillation, identify any change to this bound when using a fully implicit time integrator for the same linearized dynamics, and derive a separate constraint linked to the maximum electric field in the sheath to prevent unresolved accelerated motion across a spatial cell. Translate these constraints into computable formulas for the maximum stable timestep.\n\nStarting point and modeling assumptions:\n- Use the one-dimensional cold-electron fluid continuity and momentum equations coupled to the electrostatic Poisson equation, linearized about a spatially uniform equilibrium electron number density $n_{0}$ with zero flow speed. Assume immobile ions with density $n_{i}=n_{0}$ at equilibrium. From these, obtain a linear ordinary differential equation for the temporal evolution of a representative electron density perturbation whose characteristic frequency is the electron plasma frequency $\\omega_{pe}$, where $\\omega_{pe}$ must be expressed in terms of $n_{0}$, the elementary charge $e$, the electron mass $m_{e}$, and the vacuum permittivity $\\varepsilon_{0}$.\n- For the explicit scheme, discretize time with a centered second-order finite difference for the second time derivative of the density perturbation (equivalent to a staggered-leapfrog for the first-order system), and perform a von Neumann stability analysis to determine the condition on the timestep $\\Delta t$ involving $\\omega_{pe}$ under which the amplification factor has magnitude less than or equal to one.\n- For the implicit scheme, apply a fully implicit time discretization to the same linear dynamics and analyze the amplification factor to determine whether there is a stability restriction on $\\Delta t$ in terms of $\\omega_{pe}$.\n- Separately, use Newton’s second law for an electron under a constant electric field of magnitude $E_{\\max}$ over a single timestep to bound the accelerated displacement within a spatial cell of size $\\Delta x$. Require that the magnitude of the displacement over one timestep be less than or equal to a prescribed fraction $f$ of $\\Delta x$, where $f \\in (0,1]$ is specified. Derive the resulting bound on $\\Delta t$ in terms of $E_{\\max}$, $\\Delta x$, $f$, $e$, and $m_{e}$. This bound must be interpreted as necessary to avoid unresolved free-fall motion across a cell in one timestep.\n- Combine the results to produce, for each parameter set, two numbers: the maximum explicit-stable timestep $\\Delta t_{\\text{explicit}}$ and a corresponding implicit-stable timestep limit $\\Delta t_{\\text{implicit}}$. The explicit maximum must be the minimum of the plasma-oscillation stability bound and the accelerated-motion bound. The implicit scheme for the linearized plasma oscillation is not limited by $\\omega_{pe}$ stability, but the accelerated-motion bound still applies as a practical resolution constraint; therefore report $\\Delta t_{\\text{implicit}}$ equal to the accelerated-motion bound.\n\nNumerical units and output requirements:\n- Use the International System of Units. Express all timesteps in seconds. Your program must output each timestep in seconds.\n- Angle units are not applicable in this problem.\n- The final program output must be a single line containing a list of pairs, one pair per test case, where each pair is ordered as $[\\Delta t_{\\text{explicit}}, \\Delta t_{\\text{implicit}}]$. The line must be a single Python-style list of lists with numbers formatted in scientific notation with exactly six significant digits (e.g., $1.234560\\mathrm{e}{-07}$), for example: $[[a_{1},b_{1}],[a_{2},b_{2}],\\ldots]$.\n\nPhysical constants to use:\n- Elementary charge $e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\mathrm{Coulomb}$.\n- Electron mass $m_{e} = 9.109\\,383\\,7015 \\times 10^{-31}\\ \\mathrm{kilogram}$.\n- Vacuum permittivity $\\varepsilon_{0} = 8.854\\,187\\,8128 \\times 10^{-12}\\ \\mathrm{Farad/meter}$.\n\nTest suite:\nFor each tuple $(n_{0}, E_{\\max}, \\Delta x, f)$ below, compute the two requested timestep limits and aggregate the results as specified.\n- Case $1$: $n_{0} = 1.0 \\times 10^{18}\\ \\mathrm{meter}^{-3}$, $E_{\\max} = 2.0 \\times 10^{5}\\ \\mathrm{Volt/meter}$, $\\Delta x = 5.0 \\times 10^{-5}\\ \\mathrm{meter}$, $f = 0.25$.\n- Case $2$: $n_{0} = 1.0 \\times 10^{17}\\ \\mathrm{meter}^{-3}$, $E_{\\max} = 1.0 \\times 10^{6}\\ \\mathrm{Volt/meter}$, $\\Delta x = 1.0 \\times 10^{-5}\\ \\mathrm{meter}$, $f = 0.50$.\n- Case $3$: $n_{0} = 1.0 \\times 10^{20}\\ \\mathrm{meter}^{-3}$, $E_{\\max} = 5.0 \\times 10^{4}\\ \\mathrm{Volt/meter}$, $\\Delta x = 1.0 \\times 10^{-4}\\ \\mathrm{meter}$, $f = 0.10$.\n- Case $4$: $n_{0} = 5.0 \\times 10^{18}\\ \\mathrm{meter}^{-3}$, $E_{\\max} = 1.0 \\times 10^{2}\\ \\mathrm{Volt/meter}$, $\\Delta x = 1.0 \\times 10^{-3}\\ \\mathrm{meter}$, $f = 1.00$.\n\nImplementation requirements:\n- Your program must compute, for each case, the electron plasma frequency $\\omega_{pe}$ from first principles and the two timestep bounds described above, then output a single line with the results formatted as a Python list of lists with each number in scientific notation with exactly six significant digits. Ensure your output line contains no additional text.",
            "solution": "The problem has been validated and is deemed scientifically sound, well-posed, and objective. It is based on fundamental principles of plasma physics and numerical analysis, with all necessary conditions and data provided for a unique solution.\n\nThe solution requires the derivation of two distinct timestep constraints for simulating one-dimensional electrostatic electron dynamics. The first arises from the numerical stability of integrating electron plasma oscillations, and the second from resolving electron acceleration in a strong electric field.\n\n**1. Derivation of the Electron Plasma Oscillation Equation**\n\nWe begin with the one-dimensional, linearized, cold-electron fluid equations. The assumptions are a uniform equilibrium with electron density $n_e = n_0$, ion density $n_i = n_0$, and zero flow velocity $v_e = 0$. We consider small perturbations: $n_e(t) = n_0 + n_1(t)$, $v_e(t) = v_1(t)$, and $E(t) = E_1(t)$.\n\nThe governing equations are:\n-   Continuity: $\\frac{\\partial n_e}{\\partial t} + \\frac{\\partial (n_e v_e)}{\\partial x} = 0$\n-   Momentum: $m_e \\left(\\frac{\\partial v_e}{\\partial t} + v_e \\frac{\\partial v_e}{\\partial x}\\right) = -e E$\n-   Poisson's equation: $\\frac{\\partial E}{\\partial x} = \\frac{e}{\\varepsilon_0} (n_i - n_e)$\n\nLinearizing these by keeping only first-order terms in perturbations yields:\n1.  $\\frac{\\partial n_1}{\\partial t} + n_0 \\frac{\\partial v_1}{\\partial x} = 0$\n2.  $m_e \\frac{\\partial v_1}{\\partial t} = -e E_1$\n3.  $\\frac{\\partial E_1}{\\partial x} = -\\frac{e}{\\varepsilon_0} n_1$\n\nTo obtain an equation solely for the density perturbation $n_1$, we take the time derivative of the continuity equation and the spatial derivative of the momentum equation:\n$$ \\frac{\\partial^2 n_1}{\\partial t^2} = -n_0 \\frac{\\partial^2 v_1}{\\partial t \\partial x} $$\n$$ m_e \\frac{\\partial^2 v_1}{\\partial t \\partial x} = -e \\frac{\\partial E_1}{\\partial x} $$\nSubstituting the second into the first gives:\n$$ \\frac{\\partial^2 n_1}{\\partial t^2} = -n_0 \\left( -\\frac{e}{m_e} \\frac{\\partial E_1}{\\partial x} \\right) = \\frac{n_0 e}{m_e} \\frac{\\partial E_1}{\\partial x} $$\nFinally, substituting for $\\frac{\\partial E_1}{\\partial x}$ using the linearized Poisson's equation gives:\n$$ \\frac{\\partial^2 n_1}{\\partial t^2} = \\frac{n_0 e}{m_e} \\left( -\\frac{e}{\\varepsilon_0} n_1 \\right) = -\\frac{n_0 e^2}{m_e \\varepsilon_0} n_1 $$\nThis yields the simple harmonic oscillator equation for electron density perturbations:\n$$ \\frac{d^2 n_1}{d t^2} + \\omega_{pe}^2 n_1 = 0 $$\nwhere the electron plasma frequency $\\omega_{pe}$ is defined as:\n$$ \\omega_{pe} = \\sqrt{\\frac{n_0 e^2}{m_e \\varepsilon_0}} $$\n\n**2. Stability of the Explicit Central Difference (Leapfrog) Scheme**\n\nWe discretize the oscillation equation using a centered second-order finite difference for the second derivative. Let $n^j$ denote the density perturbation at time $t = j \\Delta t$.\n$$ \\frac{n^{j+1} - 2n^j + n^{j-1}}{(\\Delta t)^2} + \\omega_{pe}^2 n^j = 0 $$\nFor von Neumann stability analysis, we assume a solution of the form $n^j = G^j n^0$, where $G$ is the amplification factor. Substituting this into the difference equation leads to a characteristic polynomial for $G$:\n$$ G^2 - (2 - (\\omega_{pe} \\Delta t)^2) G + 1 = 0 $$\nFor the numerical solution to remain bounded, the magnitude of the amplification factor must satisfy $|G| \\le 1$. The roots of this quadratic equation are given by:\n$$ G = \\frac{(2 - (\\omega_{pe} \\Delta t)^2) \\pm \\sqrt{(2 - (\\omega_{pe} \\Delta t)^2)^2 - 4}}{2} $$\nThe solution remains stable (i.e., $|G| \\le 1$) if and only if the discriminant is non-positive, ensuring the roots are complex conjugates on the unit circle, or are real with magnitude no greater than $1$. This condition is:\n$$ (2 - (\\omega_{pe} \\Delta t)^2)^2 - 4 \\le 0 $$\n$$ -2 \\le 2 - (\\omega_{pe} \\Delta t)^2 \\le 2 $$\nThis simplifies to $(\\omega_{pe} \\Delta t)^2 \\le 4$, which for positive $\\omega_{pe}$ and $\\Delta t$ gives the stability constraint:\n$$ \\omega_{pe} \\Delta t \\le 2 $$\nThe maximum stable timestep for the explicit scheme, based on resolving plasma oscillations, is thus:\n$$ \\Delta t_{pe} = \\frac{2}{\\omega_{pe}} = 2\\sqrt{\\frac{m_e \\varepsilon_0}{n_0 e^2}} $$\n\n**3. Stability of the Fully Implicit Scheme**\n\nA fully implicit discretization evaluates the non-derivative term at the future time level $j+1$:\n$$ \\frac{n^{j+1} - 2n^j + n^{j-1}}{(\\Delta t)^2} + \\omega_{pe}^2 n^{j+1} = 0 $$\nRearranging gives the recurrence relation:\n$$ (1 + (\\omega_{pe} \\Delta t)^2) n^{j+1} - 2n^j + n^{j-1} = 0 $$\nTo find the amplification factor $G$, we substitute the trial solution $n^j = G^j$ and divide by $G^{j-1}$ to get the characteristic equation for $G$:\n$$ (1 + (\\omega_{pe} \\Delta t)^2) G^2 - 2G + 1 = 0 $$\nThe roots of this quadratic equation are:\n$$ G = \\frac{2 \\pm \\sqrt{4 - 4(1+(\\omega_{pe}\\Delta t)^2)}}{2(1+(\\omega_{pe}\\Delta t)^2)} = \\frac{2 \\pm \\sqrt{-4(\\omega_{pe}\\Delta t)^2}}{2(1+(\\omega_{pe}\\Delta t)^2)} = \\frac{2 \\pm 2i\\omega_{pe}\\Delta t}{2(1+(\\omega_{pe}\\Delta t)^2)} = \\frac{1 \\pm i\\omega_{pe}\\Delta t}{1+(\\omega_{pe}\\Delta t)^2} $$\nThe magnitude squared of the amplification factor is:\n$$ |G|^2 = \\frac{1^2 + (\\omega_{pe}\\Delta t)^2}{(1 + (\\omega_{pe}\\Delta t)^2)^2} = \\frac{1 + (\\omega_{pe}\\Delta t)^2}{(1 + (\\omega_{pe}\\Delta t)^2)^2} = \\frac{1}{1 + (\\omega_{pe} \\Delta t)^2} $$\nSince $(\\omega_{pe} \\Delta t)^2 \\ge 0$, it follows that $|G|^2 \\le 1$ for any choice of $\\Delta t \\ge 0$. The implicit scheme is therefore unconditionally stable with respect to the plasma oscillation frequency. There is no upper limit on $\\Delta t$ from this linear stability analysis.\n\n**4. Derivation of the Accelerated Motion Constraint**\n\nThis constraint ensures that an electron does not travel more than a fraction $f$ of a spatial grid cell $\\Delta x$ in a single timestep $\\Delta t$ due to acceleration by the maximum electric field $E_{\\max}$. The force on an electron has magnitude $e E_{\\max}$, producing a constant acceleration $a = e E_{\\max} / m_e$. The displacement from rest over a time $\\Delta t$ is $\\delta x = \\frac{1}{2} a (\\Delta t)^2$.\nThe constraint is $\\delta x \\le f \\Delta x$:\n$$ \\frac{1}{2} \\frac{e E_{\\max}}{m_e} (\\Delta t)^2 \\le f \\Delta x $$\nSolving for $\\Delta t$ gives the accelerated motion timestep limit:\n$$ \\Delta t_{accel} = \\sqrt{\\frac{2 f \\Delta x m_e}{e E_{\\max}}} $$\nThis constraint is not about numerical stability but about resolving the physics of particle motion, and thus applies to both explicit and implicit schemes.\n\n**5. Final Timestep Calculation**\n\nFor each test case, we compute the following:\n-   $\\Delta t_{\\text{explicit}}$: The maximum stable timestep for the explicit scheme is the more restrictive of the two bounds:\n    $$ \\Delta t_{\\text{explicit}} = \\min(\\Delta t_{pe}, \\Delta t_{accel}) = \\min\\left(\\frac{2}{\\omega_{pe}}, \\sqrt{\\frac{2 f \\Delta x m_e}{e E_{\\max}}}\\right) $$\n-   $\\Delta t_{\\text{implicit}}$: The implicit scheme is unconditionally stable for plasma oscillations, but the physical resolution constraint on accelerated motion still applies. Therefore, its practical timestep limit is:\n    $$ \\Delta t_{\\text{implicit}} = \\Delta t_{accel} = \\sqrt{\\frac{2 f \\Delta x m_e}{e E_{\\max}}} $$\nThe following constants are used:\n-   $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n-   $m_e = 9.1093837015 \\times 10^{-31}\\ \\mathrm{kg}$\n-   $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}\\ \\mathrm{F/m}$\n\nThe provided parameter sets will be used with these formulas to generate the final numerical results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes numerical timestep constraints for one-dimensional\n    electrostatic sheath dynamics based on plasma oscillation stability and\n    an accelerated motion limit.\n    \"\"\"\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    M_ELECTRON = 9.1093837015e-31  # Electron mass in kilograms\n    EPS_0 = 8.8541878128e-12  # Vacuum permittivity in Farads/meter\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (n0, Emax, dx, f)\n    test_cases = [\n        (1.0e18, 2.0e5, 5.0e-5, 0.25),  # Case 1\n        (1.0e17, 1.0e6, 1.0e-5, 0.50),  # Case 2\n        (1.0e20, 5.0e4, 1.0e-4, 0.10),  # Case 3\n        (5.0e18, 1.0e2, 1.0e-3, 1.00),  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        n0, e_max, delta_x, f = case\n\n        # 1. Calculate timestep limit from electron plasma frequency (explicit scheme)\n        # omega_pe^2 = (n0 * e^2) / (me * epsilon0)\n        # omega_pe = sqrt(omega_pe^2)\n        # Stability condition for explicit central difference: dt <= 2 / omega_pe\n        omega_pe_sq = (n0 * E_CHARGE**2) / (M_ELECTRON * EPS_0)\n        omega_pe = np.sqrt(omega_pe_sq)\n        dt_pe = 2.0 / omega_pe\n\n        # 2. Calculate timestep limit from unresolved accelerated motion\n        # Displacement dx_accel = 0.5 * a * dt^2, where a = (e * E_max) / me\n        # Constraint: dx_accel <= f * delta_x\n        # 0.5 * (e * E_max / me) * dt^2 <= f * delta_x\n        # dt^2 <= (2 * f * delta_x * me) / (e * E_max)\n        # dt <= sqrt(...)\n        dt_accel_sq = (2.0 * f * delta_x * M_ELECTRON) / (E_CHARGE * e_max)\n        dt_accel = np.sqrt(dt_accel_sq)\n\n        # 3. Determine the final timesteps for explicit and implicit schemes\n        # For the explicit scheme, the timestep is the minimum of the two constraints.\n        dt_explicit = min(dt_pe, dt_accel)\n\n        # The implicit scheme is unconditionally stable for plasma oscillations,\n        # so only the accelerated motion constraint applies as a practical limit.\n        dt_implicit = dt_accel\n\n        results.append([dt_explicit, dt_implicit])\n\n    # Format the results into the required string format.\n    # Each number is in scientific notation with 6 digits after the decimal point.\n    formatted_pairs = []\n    for pair in results:\n        # Format: [val1,val2]\n        formatted_pair = f\"[{pair[0]:.6e},{pair[1]:.6e}]\"\n        formatted_pairs.append(formatted_pair)\n    \n    # Final print statement in the exact required format: [[pair1],[pair2],...]\n    print(f\"[{','.join(formatted_pairs)}]\")\n\nsolve()\n```"
        }
    ]
}