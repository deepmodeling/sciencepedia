{
    "hands_on_practices": [
        {
            "introduction": "Child-Langmuir 定律是描述空间电荷限制流的基石，它为真空二极管等设备中的最大电流密度设定了理论上限。本练习将引导你从第一性原理出发，推导出一个更具普适性的 Child-Langmuir 定律，其中载流子的速度与能量并非经典的平方根关系。通过这一过程，你不仅能深刻理解该定律的物理本质，还能探索其在非抛物线形能带半导体等前沿领域的应用。",
            "id": "3971660",
            "problem": "一个平面一维静电鞘层将位于 $x=0$ 处的位置（阴极）的发射表面与位于 $x=L$ 处的位置（阳极）的收集表面分离开来。阳极相对于阴极保持在正电势 $V0$。电子从阴极发射，初始动能可忽略不计，且在稳态下，流动是空间电荷限制的。假设电子流是无碰撞的、单一类型的，并忽略离子运动。电极之间的材料具有介电常数 $\\varepsilon$（不一定是真空介电常数）。设电子电荷大小为 $e$。定义静电势 $\\phi(x)$，其中 $\\phi(0)=0$ 且 $\\phi(L)=V$。\n\n在与高场半导体等离子体类似物相关的非抛物线能带输运机制中，假设载流子速度依赖于载流子动能 $\\mathcal{E}$，关系为 $v(\\mathcal{E})=B\\,\\mathcal{E}^{\\gamma}$，其中 $B0$ 和 $\\gamma$ 是材料参数，并且在稳态一维加速中 $\\mathcal{E}=e\\,\\phi(x)$。对于电场 $E(x)=-\\,d\\phi/dx$，采用空间电荷限制边界条件 $E(0)=0$。\n\n仅从静电学和一维稳态输运的基本关系，即高斯定律的微分形式和电荷守恒出发，推导出一个广义柴尔德-朗缪尔(CL)定律，该定律给出空间电荷限制电流密度 $J$ 作为 $V$、$L$、$\\varepsilon$、$B$、$e$ 和 $\\gamma$ 的函数。明确指出在所述边界条件下，您的推导在何种 $\\gamma$ 的取值范围内是数学上一致的，并通过确定合适的 $B$ 和 $\\gamma$ 来恢复经典的抛物线能带极限。\n\n用符号将 $J$ 的最终结果表示为 $\\mathrm{A\\,m^{-2}}$。不需要进行数值计算，也不需要四舍五入。最终答案必须是 $J$ 关于 $V$、$L$、$\\varepsilon$、$B$、$e$ 和 $\\gamma$ 的单个闭合形式解析表达式。",
            "solution": "该问题要求对于非抛物线型的能量-速度关系，推导广义的柴尔德-朗缪尔定律。推导将从静电学和一维稳态电流的基本方程出发。\n\n该系统的控制物理定律是泊松方程和电流连续性方程。\n一维泊松方程将静电势 $\\phi(x)$ 与空间电荷密度 $\\rho(x)$ 联系起来：\n$$\n\\frac{d^2\\phi}{dx^2} = -\\frac{\\rho(x)}{\\varepsilon}\n$$\n在稳态下，电流密度 $J$ 在整个区域内是恒定的。对于电荷密度为 $\\rho(x)$、速度为 $v(x)$ 的粒子流，电流密度的大小由 $J = |\\rho(x)| v(x)$ 给出。由于载流子是电荷为 $-e$ 的电子，电荷密度为 $\\rho(x) = -n_e(x) e  0$，其中 $n_e(x)$ 是电子数密度。电流密度为 $J = n_e(x) e v(x)$。因此，我们可以将电荷密度的大小表示为 $|\\rho(x)| = J/v(x)$，这意味着 $\\rho(x) = -J/v(x)$。\n\n将 $\\rho(x)$ 的这个表达式代入泊松方程，得到：\n$$\n\\frac{d^2\\phi}{dx^2} = -\\frac{1}{\\varepsilon} \\left(-\\frac{J}{v(x)}\\right) = \\frac{J}{\\varepsilon v(x)}\n$$\n题目说明电子从 $x=0$ 处的阴极发射，初始动能可忽略不计，该处的电势为 $\\phi(0)=0$。因此，电子在位置 $x$ 处的动能 $\\mathcal{E}$ 完全来自于电场做的功，$\\mathcal{E}(x) = e\\phi(x)$。\n\n载流子速度 $v$ 是动能的函数：$v(\\mathcal{E}) = B\\mathcal{E}^{\\gamma}$。代入 $\\mathcal{E}(x) = e\\phi(x)$，我们得到速度作为电势的函数：\n$$\nv(x) = B(e\\phi(x))^{\\gamma} = B e^{\\gamma} \\phi(x)^{\\gamma}\n$$\n现在我们可以将 $v(x)$ 的这个表达式代入我们关于 $\\phi(x)$ 的微分方程中：\n$$\n\\frac{d^2\\phi}{dx^2} = \\frac{J}{\\varepsilon B e^{\\gamma}} \\phi(x)^{-\\gamma}\n$$\n这是一个关于 $\\phi(x)$ 的二阶非线性常微分方程。让我们定义常数系数 $C = \\frac{J}{\\varepsilon B e^{\\gamma}}$。方程变为 $\\phi'' = C\\phi^{-\\gamma}$。为了求解这个方程，我们使用标准技巧，两边同乘以 $2\\phi'$（首次积分法）：\n$$\n2\\phi'\\phi'' = 2C\\phi'\\phi^{-\\gamma}\n$$\n认识到 $2\\phi'\\phi'' = \\frac{d}{dx}(\\phi')^2$ 且 $\\phi' = \\frac{d\\phi}{dx}$，我们可以对两边关于 $x$ 积分：\n$$\n\\int \\frac{d}{dx}(\\phi')^2 dx = \\int 2C\\phi^{-\\gamma} \\frac{d\\phi}{dx} dx\n$$\n$$\n(\\phi')^2 = 2C \\int \\phi^{-\\gamma} d\\phi\n$$\n积分的计算需要考虑 $\\gamma$ 的值。让我们首先假设 $\\gamma \\neq 1$。\n$$\n(\\phi')^2 = 2C \\frac{\\phi^{1-\\gamma}}{1-\\gamma} + K_1\n$$\n其中 $K_1$ 是一个积分常数。我们使用阴极（$x=0$）处的边界条件来确定 $K_1$。我们有 $\\phi(0)=0$。空间电荷限制条件指定为 $E(0)=0$。由于电场是 $E(x) = -d\\phi/dx = -\\phi'$，这意味着 $\\phi'(0)=0$。将这些条件代入积分后的方程：\n$$\n(0)^2 = 2C \\frac{(0)^{1-\\gamma}}{1-\\gamma} + K_1\n$$\n为了使该方程成立，$(0)^{1-\\gamma}$ 项必须是良定义的且等于零。这要求指数为正，即 $1-\\gamma > 0$，或 $\\gamma  1$。在这个条件下，方程得出 $K_1=0$。\n此外，为了使 $(\\phi')^2$ 为非负，并且由于 $C>0$ 和 $\\phi(x) \\geq 0$，分母 $1-\\gamma$也必须为正，这再次要求 $\\gamma  1$。如果 $\\gamma=1$，积分会产生对数 $\\ln(\\phi)$，它在 $\\phi=0$ 处发散，使得边界条件无法良定义。因此，该推导仅在 $\\gamma  1$ 时是一致的。\n\n当 $K_1=0$ 且 $\\gamma  1$ 时，方程变为：\n$$\n(\\phi')^2 = \\frac{2C}{1-\\gamma}\\phi^{1-\\gamma}\n$$\n开平方根，我们得到 $\\phi' = \\pm \\sqrt{\\frac{2C}{1-\\gamma}} \\phi^{(1-\\gamma)/2}$。作用在电子上的力是 $F = (-e)E = (-e)(-\\phi') = e\\phi'$。为了使电子从阴极加速到阳极，力必须沿正 $x$ 方向，要求 $F0$。由于 $e0$，我们必须有 $\\phi'  0$。因此，我们选择正根：\n$$\n\\frac{d\\phi}{dx} = \\sqrt{\\frac{2C}{1-\\gamma}} \\phi^{(1-\\gamma)/2}\n$$\n这是一个可分离的一阶微分方程。我们将其重新排列为：\n$$\n\\phi^{-(1-\\gamma)/2} d\\phi = \\sqrt{\\frac{2C}{1-\\gamma}} dx\n$$\n我们对两边进行积分。左边从 $\\phi(0)=0$ 积分到 $\\phi(x)$，右边从 $0$ 积分到 $x$：\n$$\n\\int_0^{\\phi(x)} \\tilde{\\phi}^{-(1-\\gamma)/2} d\\tilde{\\phi} = \\int_0^x \\sqrt{\\frac{2C}{1-\\gamma}} d\\tilde{x}\n$$\n为了计算左边的积分，我们必须确保指数不为 $-1$。$-(1-\\gamma)/2 = -1$ 的情况对应于 $1-\\gamma = 2$，即 $\\gamma = -1$。假设 $\\gamma \\neq -1$，积分为：\n$$\n\\left[ \\frac{\\tilde{\\phi}^{1 - (1-\\gamma)/2}}{1 - (1-\\gamma)/2} \\right]_0^{\\phi(x)} = \\left[ \\frac{\\tilde{\\phi}^{(1+\\gamma)/2}}{(1+\\gamma)/2} \\right]_0^{\\phi(x)}\n$$\n为了使在下限 $\\tilde{\\phi}=0$ 处的计算结果为零，指数必须为正：$(1+\\gamma)/2  0$，这意味着 $\\gamma  -1$。如果 $\\gamma=-1$，积分会得到一个对数，在下限处发散。\n因此，推导要求 $\\gamma  -1$。\n\n结合我们的约束条件，解在 $-1  \\gamma  1$ 给出的 $\\gamma$ 范围内是数学上一致的。对于这个范围，积分后的方程是：\n$$\n\\frac{2}{1+\\gamma} \\phi(x)^{(1+\\gamma)/2} = \\sqrt{\\frac{2C}{1-\\gamma}} x\n$$\n我们求解 $\\phi(x)$：\n$$\n\\phi(x) = \\left[ \\left( \\frac{1+\\gamma}{2} \\right) \\sqrt{\\frac{2C}{1-\\gamma}} x \\right]^{2/(1+\\gamma)}\n$$\n现在，我们应用阳极（$x=L$）处的最终边界条件，即 $\\phi(L)=V$：\n$$\nV = \\left[ \\left( \\frac{1+\\gamma}{2} \\right) \\sqrt{\\frac{2C}{1-\\gamma}} L \\right]^{2/(1+\\gamma)}\n$$\n为了求解 $J$，我们首先求解 $C$。将两边都取 $(1+\\gamma)/2$ 次方：\n$$\nV^{(1+\\gamma)/2} = \\left( \\frac{1+\\gamma}{2} \\right) \\sqrt{\\frac{2C}{1-\\gamma}} L\n$$\n分离出含有 $C$ 的项：\n$$\n\\sqrt{\\frac{2C}{1-\\gamma}} = \\frac{2}{1+\\gamma} \\frac{V^{(1+\\gamma)/2}}{L}\n$$\n两边平方：\n$$\n\\frac{2C}{1-\\gamma} = \\frac{4}{(1+\\gamma)^2} \\frac{V^{1+\\gamma}}{L^2}\n$$\n$$\nC = \\frac{2(1-\\gamma)}{(1+\\gamma)^2} \\frac{V^{1+\\gamma}}{L^2}\n$$\n最后，我们代回定义 $C = \\frac{J}{\\varepsilon B e^{\\gamma}}$ 并求解电流密度 $J$：\n$$\n\\frac{J}{\\varepsilon B e^{\\gamma}} = \\frac{2(1-\\gamma)}{(1+\\gamma)^2} \\frac{V^{1+\\gamma}}{L^2}\n$$\n$$\nJ = \\frac{2 \\varepsilon B e^{\\gamma} (1-\\gamma)}{(1+\\gamma)^2} \\frac{V^{1+\\gamma}}{L^2}\n$$\n这就是针对指定输运模型的广义柴尔德-朗缪尔定律。\n\n在给定的边界条件下，该推导在数学上一致的参数 $\\gamma$ 的范围是 $\\gamma \\in (-1, 1)$。\n\n为了恢复抛物线能带的经典结果，我们注意到动能为 $\\mathcal{E} = \\frac{1}{2}m_e v^2$，其中 $m_e$ 是电子质量。这给出了速度 $v = \\sqrt{2\\mathcal{E}/m_e} = (2/m_e)^{1/2} \\mathcal{E}^{1/2}$。将其与给定关系 $v = B\\mathcal{E}^{\\gamma}$进行比较，我们确定：\n$$\n\\gamma = \\frac{1}{2} \\quad \\text{and} \\quad B = \\sqrt{\\frac{2}{m_e}}\n$$\n值 $\\gamma=1/2$ 位于有效范围 $(-1, 1)$ 内。将这些值以及真空介电常数 $\\varepsilon = \\varepsilon_0$ 代入我们的广义定律中：\n$$\nJ = \\frac{2 \\varepsilon_0 \\left(\\sqrt{\\frac{2}{m_e}}\\right) e^{1/2} (1 - 1/2)}{(1 + 1/2)^2} \\frac{V^{1+1/2}}{L^2}\n$$\n$$\nJ = \\frac{2 \\varepsilon_0 \\sqrt{\\frac{2}{m_e}} e^{1/2} (1/2)}{(3/2)^2} \\frac{V^{3/2}}{L^2} = \\frac{\\varepsilon_0 \\sqrt{\\frac{2e}{m_e}}}{9/4} \\frac{V^{3/2}}{L^2}\n$$\n$$\nJ = \\frac{4}{9}\\varepsilon_0 \\sqrt{\\frac{2e}{m_e}} \\frac{V^{3/2}}{L^2}\n$$\n这就是众所周知的经典柴尔德-朗缪尔定律，它证实了我们广义推导的正确性。\n\n广义电流密度 $J$ 的最终表达式为：\n$$\nJ = \\frac{2 \\varepsilon B e^{\\gamma} (1-\\gamma) V^{1+\\gamma}}{(1+\\gamma)^2 L^2}\n$$",
            "answer": "$$\n\\boxed{\\frac{2 \\varepsilon B e^{\\gamma} (1-\\gamma) V^{1+\\gamma}}{(1+\\gamma)^{2} L^{2}}}\n$$"
        },
        {
            "introduction": "虽然等离子体在大部分区域内是准中性的，但在与材料表面接触的边界处会形成一个被称为“鞘层”的薄的非中性区域。本练习旨在将抽象的 Debye length（$\\lambda_D$）概念与一个宏观、可量化的问题联系起来：在有界等离子体中，鞘层究竟占据了多大的体积比例？通过对一个假设的圆柱形装置进行建模，你将学会如何评估准中性近似的有效性，并深入理解边界在等离子体全局行为中的关键作用。",
            "id": "3971642",
            "problem": "一个长度为 $L$、轴向均匀的单电离等离子体柱，其外部圆柱边界半径为 $R$，内部包含一个半径为 $a$ ($0aR$) 的同轴圆柱探针。该等离子体具有恒定的电子温度 $T_e$ 和体等离子体密度 $n_0$。所有与等离子体接触的表面（外部边界、同轴探针和两个轴向端盖）都会形成静电鞘层。假设鞘层厚度 $s$ 与等离子体德拜长度 $\\lambda_D$ 成正比，即 $s = \\alpha \\lambda_D$，其中 $\\alpha$ 是一个量级为1的无量纲常数。还假设 $a \\gg \\lambda_D$, $R \\gg \\lambda_D$ 且 $L \\gg \\lambda_D$，因此您可以忽略鞘层体积计算中的曲率修正和鞘层重叠。\n\n从第一性原理出发，为鞘层厚度与德拜长度的标度关系提供一个简要的物理论证。然后，推导出总等离子体体积中非中性部分（即所有鞘层的总体积）所占的分数 $f$ 的解析表达式。\n\n您的最终答案必须是一个关于 $\\alpha$、$\\lambda_D$、$L$、$R$ 和 $a$ 的单个闭合形式解析表达式。不需要进行数值计算。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确且客观。它代表了等离子体物理学中一个关于在确定几何形状中估算鞘层体积的标准问题。\n\n按照题目要求，解答分为两部分。首先，我们为鞘层厚度与德拜长度的标度关系提供一个第一性原理的论证。其次，我们计算鞘层占据的等离子体体积分数。\n\n**第一部分：鞘层厚度的第一性原理论证**\n\n在静电学中，电势 $\\phi$ 和电荷密度 $\\rho$ 之间的关系由泊松方程给出：\n$$ \\nabla^2 \\phi = -\\frac{\\rho}{\\epsilon_0} $$\n在由单电离离子和电子组成的等离子体中，电荷密度为 $\\rho = e(n_i - n_e)$，其中 $n_i$ 和 $n_e$ 分别是离子和电子的数密度， $e$ 是元电荷。因此，泊松方程变为：\n$$ \\nabla^2 \\phi = -\\frac{e(n_i - n_e)}{\\epsilon_0} $$\n在远离任何边界的体等离子体中，等离子体是准中性的，因此 $n_i \\approx n_e \\approx n_0$，并且电势可以设为 $\\phi=0$。在相对于体等离子体处于负电势的表面附近，电子被排斥。假设电子在温度 $T_e$ 下处于热平衡状态，它们的密度分布遵循玻尔兹曼关系：\n$$ n_e(\\phi) = n_0 \\exp\\left(\\frac{e\\phi}{k_B T_e}\\right) $$\n其中 $k_B$ 是玻尔兹曼常数。\n\n为了理解电势屏蔽的特征长度尺度，我们考虑一个偏离准中性状态的小扰动，使得 $|e\\phi/k_B T_e| \\ll 1$。我们可以将玻尔兹曼关系中的指数项线性化：\n$$ n_e \\approx n_0 \\left(1 + \\frac{e\\phi}{k_B T_e}\\right) $$\n假设离子重得多且移动性较差，在扰动的长度尺度上，它们的密度可以近似为常数，$n_i \\approx n_0$。那么净电荷密度为：\n$$ \\rho = e(n_i - n_e) \\approx e\\left[n_0 - n_0\\left(1 + \\frac{e\\phi}{k_B T_e}\\right)\\right] = -\\frac{n_0 e^2 \\phi}{k_B T_e} $$\n将这个线性化的电荷密度代回泊松方程，得到：\n$$ \\nabla^2 \\phi = -\\frac{1}{\\epsilon_0}\\left(-\\frac{n_0 e^2 \\phi}{k_B T_e}\\right) = \\left(\\frac{n_0 e^2}{\\epsilon_0 k_B T_e}\\right)\\phi $$\n括号中的项是德拜长度 $\\lambda_D = \\sqrt{\\frac{\\epsilon_0 k_B T_e}{n_0 e^2}}$ 的平方的倒数。该方程变为屏蔽泊松方程：\n$$ \\nabla^2 \\phi = \\frac{1}{\\lambda_D^2}\\phi $$\n在一维情况下，方程为 $\\frac{d^2\\phi}{dx^2} - \\frac{1}{\\lambda_D^2}\\phi = 0$。衰减到体等离子体中（即 $\\phi \\to 0$）的解的形式为 $\\phi(x) = \\phi_{\\text{wall}} \\exp(-x/\\lambda_D)$，其中 $x$ 是离表面的距离。这个结果表明，等离子体在 $\\lambda_D$ 的特征长度上屏蔽了电场。\n\n尽管这个线性理论仅对小电势有效，但它确立了基本的长度尺度。一个完整的、非线性的鞘层涉及显著的电势降和离子加速（由 Bohm 判据决定）。这些效应导致一个显著的电荷分离区域（即鞘层），其厚度通常是几个德拜长度。因此，将鞘层厚度建模为 $s = \\alpha \\lambda_D$（其中 $\\alpha$ 是一个量级为1的常数）是一种物理上合理的简化，它抓住了正确的标度关系。\n\n**第二部分：非中性体积分数的计算**\n\n等离子体被限制在一个长度为 $L$、内半径为 $a$、外半径为 $R$ 的空心圆柱体积内。等离子体的总体积为：\n$$ V_{\\text{plasma}} = (\\text{环形截面面积}) \\times (\\text{长度}) $$\n$$ V_{\\text{plasma}} = (\\pi R^2 - \\pi a^2)L = \\pi (R^2 - a^2)L $$\n\n非中性体积是所有与等离子体接触的表面上形成的鞘层的总体积。给定鞘层厚度 $s = \\alpha \\lambda_D$。题目要求我们忽略曲率修正和鞘层重叠，这在给定的假设 $a \\gg \\lambda_D$ 和 $R \\gg \\lambda_D$ 下是有效的。这使我们可以用每个鞘层的表面积乘以厚度 $s$ 来近似其体积。\n\n鞘层的总体积 $V_{\\text{sheath}}$ 是来自四个表面的贡献之和：\n1.  **内部探针侧壁（半径 $a$）上的鞘层：**\n    表面积为 $A_a = 2\\pi a L$。体积为 $V_{\\text{sheath}, a} \\approx A_a s = (2\\pi a L)(\\alpha \\lambda_D)$。\n2.  **外边界侧壁（半径 $R$）上的鞘层：**\n    表面积为 $A_R = 2\\pi R L$。体积为 $V_{\\text{sheath}, R} \\approx A_R s = (2\\pi R L)(\\alpha \\lambda_D)$。\n3.  **两个轴向端面上的鞘层：**\n    每个端面是一个环形，面积为 $A_{\\text{end}} = \\pi R^2 - \\pi a^2$。因为有两个端面，总面积为 $2 A_{\\text{end}}$。总体积为 $V_{\\text{sheath}, \\text{ends}} \\approx (2 A_{\\text{end}})s = 2\\pi(R^2 - a^2)(\\alpha \\lambda_D)$。\n\n鞘层的总体积是这些贡献的总和：\n$$ V_{\\text{sheath}} = V_{\\text{sheath}, a} + V_{\\text{sheath}, R} + V_{\\text{sheath}, \\text{ends}} $$\n$$ V_{\\text{sheath}} = 2\\pi a L \\alpha \\lambda_D + 2\\pi R L \\alpha \\lambda_D + 2\\pi(R^2 - a^2)\\alpha \\lambda_D $$\n提取公因式 $2\\pi \\alpha \\lambda_D$：\n$$ V_{\\text{sheath}} = 2\\pi \\alpha \\lambda_D \\left[ aL + RL + (R^2 - a^2) \\right] $$\n\n总等离子体体积中非中性的分数 $f$ 是总鞘层体积与总等离子体体积之比：\n$$ f = \\frac{V_{\\text{sheath}}}{V_{\\text{plasma}}} = \\frac{2\\pi \\alpha \\lambda_D [L(a+R) + (R^2 - a^2)]}{\\pi (R^2 - a^2)L} $$\n使用恒等式 $R^2 - a^2 = (R-a)(R+a)$，我们可以简化：\n$$ f = \\frac{2 \\alpha \\lambda_D [L(a+R) + (R-a)(R+a)]}{(R-a)(R+a)L} $$\n我们可以将方括号内的表达式分开：\n$$ f = \\frac{2 \\alpha \\lambda_D}{(R-a)(R+a)L} [L(R+a)] + \\frac{2 \\alpha \\lambda_D}{(R-a)(R+a)L} [(R-a)(R+a)] $$\n消去每一部分的项：\n$$ f = \\frac{2 \\alpha \\lambda_D}{R-a} + \\frac{2 \\alpha \\lambda_D}{L} $$\n提取公因式 $2 \\alpha \\lambda_D$ 得到最终表达式：\n$$ f = 2 \\alpha \\lambda_D \\left(\\frac{1}{R-a} + \\frac{1}{L}\\right) $$\n这个表达式是无量纲的，正如分数所预期的那样。项 $(\\frac{1}{R-a} + \\frac{1}{L})$ 的单位是长度的倒数，这被 $\\lambda_D$ 的长度单位所抵消。",
            "answer": "$$\\boxed{2 \\alpha \\lambda_{D} \\left(\\frac{1}{R-a} + \\frac{1}{L}\\right)}$$"
        },
        {
            "introduction": "在计算聚变科学中，确保模拟代码的准确性至关重要，而代码验证是实现这一目标的核心环节。本练习将理论与实践相结合，要求你利用关于鞘层入口处离子流速的 Bohm criterion 来推导一个解析基准解。随后，你将使用此基准来量化评估一个模拟刮削层（Scrape-Off Layer, SOL）的流体代码的精确度，从而掌握如何通过解析理论来验证复杂计算模型的关键技能。",
            "id": "3971663",
            "problem": "您的任务是为处于等温、无碰撞鞘层极限下的刮削层（SOL）流体程序设计并实现一个验证测试。其目标是根据由玻姆判据和已知热传输系数定义的解析基准，评估在鞘层入口处模拟的平行通量的保真度。您必须从第一性原理出发推导基准公式，然后计算给定的程序报告通量与基准值相比的定量误差度量。\n\n假设与基本依据：\n- 在从上游位置到鞘层入口的场线上，等离子体是稳态、一维、准中性且等温的。\n- 离子是单电荷的，相对于电子是冷的，而电子是等温的，温度为 $T_e$。\n- 鞘层入口处的离子流满足玻姆判据等式，即 $u_i = c_s$，其中 $c_s$ 是离子声速。\n- 离子声速为 $c_s = \\sqrt{T_e/m_i}$，其中 $m_i$ 是离子质量，$T_e$ 以焦耳为单位表示。\n- 质量守恒得出沿场线为常数的粒子通量 $\\Gamma = n u$。\n- 稳态等温动量平衡给出 $m_i u \\, du/dx = - T_e \\, d(\\ln n)/dx$。\n- 在鞘层入口处，朝向壁面的总平行热通量被建模为 $q_\\parallel = \\gamma \\, n_s \\, T_e \\, c_s$，其中 $n_s$ 是鞘层入口处的密度，$\\gamma$ 是一个已知的无量纲热传输系数，由等温鞘层的动理论推导得出。每个测试用例都会提供 $\\gamma$ 的值。\n\n您的推导必须仅使用上述基本关系，不得引用任何其他简化公式。设上游状态由密度 $n_0$、离子马赫数 $M_0 = u_0 / c_s$（其中 $0  M_0  1$）和电子温度 $T_e$ 来表征。证明对动量平衡进行积分可得到不变量\n$$\n\\frac{1}{2} m_i u^2 + T_e \\ln n = \\text{constant},\n$$\n并且，利用鞘层入口处的玻姆条件 $u_s = c_s$，证明\n$$\nn_s = n_0 \\exp\\!\\left(\\frac{1}{2}\\left(M_0^2 - 1\\right)\\right).\n$$\n然后推导出鞘层入口处的解析基准粒子通量和热通量为\n$$\n\\Gamma^\\star = n_s \\, c_s, \\quad q^\\star = \\gamma \\, n_s \\, T_e \\, c_s.\n$$\n用于计算的公式中所有 $T_e$ 的实例都必须通过 $T_e \\, [\\text{J}] = T_e \\, [\\text{eV}] \\times e$ 从电子伏特转换为焦耳，其中 $e = 1.602176634 \\times 10^{-19}$ 是以库仑为单位的基本电荷。所有计算出的通量必须采用国际单位制：$\\Gamma^\\star$ 的单位为 $\\text{m}^{-2}\\,\\text{s}^{-1}$，$q^\\star$ 的单位为 $\\text{W}\\,\\text{m}^{-2}$。\n\n验证与误差度量：\n- 对于每个测试用例，给定一对程序报告的通量 $(\\Gamma^{\\text{num}}, q^{\\text{num}})$，它们代表了具有相同上游参数的 SOL 流体程序在鞘层入口处的输出。\n- 将相对粒子通量误差和相对热通量误差定义为\n$$\n\\varepsilon_\\Gamma = \\frac{\\left|\\Gamma^{\\text{num}} - \\Gamma^\\star\\right|}{\\Gamma^\\star}, \\quad \n\\varepsilon_q = \\frac{\\left|q^{\\text{num}} - q^\\star\\right|}{q^\\star}.\n$$\n- 将聚合误差度量定义为两个相对误差的均方根：\n$$\n\\varepsilon_{\\text{rms}} = \\sqrt{\\frac{\\varepsilon_\\Gamma^2 + \\varepsilon_q^2}{2}}.\n$$\n所有误差度量均为无量纲，且必须以小数（而非百分比）形式报告。\n\n测试套件：\n对于每种情况，参数为 $(m_i \\, [\\text{kg}], \\, T_e \\, [\\text{eV}], \\, n_0 \\, [\\text{m}^{-3}], \\, M_0 \\, [\\text{无量纲}], \\, \\gamma \\, [\\text{无量纲}], \\, \\Gamma^{\\text{num}} \\, [\\text{m}^{-2}\\,\\text{s}^{-1}], \\, q^{\\text{num}} \\, [\\text{W}\\,\\text{m}^{-2}])$。请精确使用给定的值。\n\n- 情况 A（正常路径，适度亚音速流入）：\n  - $m_i = 3.345 \\times 10^{-27}$, $T_e = 20.0$, $n_0 = 1.0 \\times 10^{19}$, $M_0 = 0.10$, $\\gamma = 7.0$。\n  - 将程序报告的通量定义为基准值的乘法扰动：$\\Gamma^{\\text{num}} = 1.02 \\, \\Gamma^\\star$，$q^{\\text{num}} = 0.97 \\, q^\\star$。\n- 情况 B（上游接近玻姆条件，零误差）：\n  - $m_i = 3.345 \\times 10^{-27}$, $T_e = 5.0$, $n_0 = 5.0 \\times 10^{18}$, $M_0 = 0.95$, $\\gamma = 7.0$。\n  - $\\Gamma^{\\text{num}} = 1.00 \\, \\Gamma^\\star$，$q^{\\text{num}} = 1.00 \\, q^\\star$。\n- 情况 C（不同离子种类和温度，较大差异）：\n  - $m_i = 6.644657 \\times 10^{-27}$, $T_e = 3.0$, $n_0 = 2.0 \\times 10^{19}$, $M_0 = 0.50$, $\\gamma = 6.5$。\n  - $\\Gamma^{\\text{num}} = 0.90 \\, \\Gamma^\\star$，$q^{\\text{num}} = 1.15 \\, q^\\star$。\n- 情况 D（上游为极亚音速，无差异）：\n  - $m_i = 3.345 \\times 10^{-27}$, $T_e = 100.0$, $n_0 = 1.0 \\times 10^{18}$, $M_0 = 0.01$, $\\gamma = 7.0$。\n  - $\\Gamma^{\\text{num}} = 1.00 \\, \\Gamma^\\star$，$q^{\\text{num}} = 1.00 \\, q^\\star$。\n\n编程任务及要求输出：\n- 实现一个程序，对于每个测试用例，使用上述公式计算 $c_s$、$n_s$、$\\Gamma^\\star$ 和 $q^\\star$，根据指定的乘法关系构建 $(\\Gamma^{\\text{num}}, q^{\\text{num}})$，并评估 $\\varepsilon_\\Gamma$、$\\varepsilon_q$ 和 $\\varepsilon_{\\text{rms}}$。\n- 您的程序应生成单行输出，其中包含结果，形式为列表的列表，每个测试用例包含三个十进制浮点数，顺序为 $[\\varepsilon_\\Gamma, \\varepsilon_q, \\varepsilon_{\\text{rms}}]$。最终输出的格式必须与以下完全一致：\n\"[ [err_Gamma_A, err_q_A, err_rms_A], [err_Gamma_B, err_q_B, err_rms_B], [err_Gamma_C, err_q_C, err_rms_C], [err_Gamma_D, err_q_D, err_rms_D] ]\"\n除了 Python 默认的列表到字符串转换在内部列表中固有产生的空格外，不应有任何其他空格。误差必须是小数，而不是百分比。\n\n所有中间量必须采用一致的国际单位制，所有角度（如果有）必须以弧度为单位，尽管本问题中预计不会出现角度。程序必须使用此处给出的测试套件，不得请求任何用户输入。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于等离子体流体动力学的既定原理，特别是终止于鞘层的刮削层的等温一维模型。该问题是适定的，为获得唯一解提供了所有必要的数据和定义。语言客观，任务可形式化。因此，我们可以着手解决。\n\n任务是推导无碰撞鞘层入口处的粒子通量和热通量的解析表达式，并将其用作验证数值流体程序的基准。这包括两个主要部分：首先，从第一性原理推导必要的公式；其次，实现这些公式以计算一组给定测试用例的误差度量。\n\n### 解析基准的推导\n\n我们首先根据所提供的假设推导所需的关系。等离子体处于稳态（$\\partial/\\partial t = 0$），沿磁力线（坐标 $x$）是一维（$1$D）的，是准中性的（$n_i \\approx n_e = n$），且电子是等温的，具有恒定温度 $T_e$。\n\n**1. 等离子体流不变量的推导**\n\n稳态一维离子动量平衡方程如下所示：\n$$\nm_i u \\frac{du}{dx} = - T_e \\frac{d(\\ln n)}{dx}\n$$\n其中 $m_i$ 是离子质量，$u$ 是离子流体速度，$n$ 是等离子体密度，$T_e$ 是以焦耳为单位的电子温度。电子温度 $T_e$ 沿场线是恒定的。\n\n方程的左侧可以表示为单位粒子离子动能的空间导数：\n$$\nm_i u \\frac{du}{dx} = \\frac{d}{dx} \\left( \\frac{1}{2} m_i u^2 \\right)\n$$\n右侧涉及密度自然对数的导数，这与电子压力梯度力 $-(1/n) \\nabla p_e = -(T_e/n) \\nabla n = -T_e \\nabla(\\ln n)$ 有关。由于 $T_e$ 是常数，可以将其移入导数内部：\n$$\n-T_e \\frac{d(\\ln n)}{dx} = -\\frac{d}{dx} (T_e \\ln n)\n$$\n将重写的表达式相等，可得：\n$$\n\\frac{d}{dx} \\left( \\frac{1}{2} m_i u^2 \\right) = -\\frac{d}{dx} (T_e \\ln n)\n$$\n这可以重排为单个导数：\n$$\n\\frac{d}{dx} \\left( \\frac{1}{2} m_i u^2 + T_e \\ln n \\right) = 0\n$$\n将此方程对空间坐标 $x$ 积分，得到所需的不变量：\n$$\n\\frac{1}{2} m_i u^2 + T_e \\ln n = \\text{constant}\n$$\n该表达式是等温等离子体流的一种伯努利方程形式，它表明离子动能与电子压力所做的功之和沿流线守恒。\n\n**2. 鞘层入口密度 $n_s$ 的推导**\n\n推导出的不变量对流场中的任意两点都成立。我们将此关系应用于由下标 $0$ 表示的上游位置和由下标 $s$ 表示的鞘层入口之间。\n$$\n\\frac{1}{2} m_i u_0^2 + T_e \\ln n_0 = \\frac{1}{2} m_i u_s^2 + T_e \\ln n_s\n$$\n问题指定了以下条件：\n- 上游离子流由马赫数 $M_0 = u_0 / c_s$ 表征，因此 $u_0 = M_0 c_s$。\n- 鞘层入口处的流满足玻姆判据等式：$u_s = c_s$。\n- 离子声速为 $c_s = \\sqrt{T_e/m_i}$。\n\n将这些代入不变量方程：\n$$\n\\frac{1}{2} m_i (M_0 c_s)^2 + T_e \\ln n_0 = \\frac{1}{2} m_i c_s^2 + T_e \\ln n_s\n$$\n现在，我们代入声速的平方表达式 $c_s^2 = T_e/m_i$：\n$$\n\\frac{1}{2} m_i M_0^2 \\left(\\frac{T_e}{m_i}\\right) + T_e \\ln n_0 = \\frac{1}{2} m_i \\left(\\frac{T_e}{m_i}\\right) + T_e \\ln n_s\n$$\n简化各项，我们得到：\n$$\n\\frac{1}{2} M_0^2 T_e + T_e \\ln n_0 = \\frac{1}{2} T_e + T_e \\ln n_s\n$$\n由于物理等离子体的电子温度 $T_e$ 必须为正，我们可以将整个方程除以 $T_e$：\n$$\n\\frac{1}{2} M_0^2 + \\ln n_0 = \\frac{1}{2} + \\ln n_s\n$$\n为了求解 $n_s$，我们重排方程以分离对数项：\n$$\n\\ln n_s - \\ln n_0 = \\frac{1}{2} M_0^2 - \\frac{1}{2}\n$$\n使用对数性质 $\\ln a - \\ln b = \\ln(a/b)$：\n$$\n\\ln \\left( \\frac{n_s}{n_0} \\right) = \\frac{1}{2} \\left( M_0^2 - 1 \\right)\n$$\n最后，对两边取指数，得到鞘层入口密度 $n_s$ 的表达式：\n$$\nn_s = n_0 \\exp\\left( \\frac{1}{2} \\left( M_0^2 - 1 \\right) \\right)\n$$\n此推导已完成，并确认了所提供的公式。\n\n**3. 基准通量与误差度量**\n\n有了 $n_s$ 的表达式，我们就可以定义基准通量。\n- 粒子通量 $\\Gamma$ 由质量守恒定义为 $\\Gamma = n u$。在鞘层入口处，$n=n_s$ 且 $u=u_s=c_s$。因此，基准粒子通量为：\n  $$\n  \\Gamma^\\star = n_s c_s\n  $$\n- 鞘层入口处的平行热通量 $q_\\parallel$ 由一个动理学封闭模型给出：$q_\\parallel = \\gamma n_s T_e c_s$，其中 $\\gamma$ 是鞘层热传输系数。因此，基准热通量为：\n  $$\n  q^\\star = \\gamma n_s T_e c_s\n  $$\n在所有计算中，电子温度 $T_e$ 的单位必须是焦耳。从电子伏特（eV）的转换由 $T_e \\, [\\text{J}] = T_e \\, [\\text{eV}] \\times e$ 给出，其中 $e = 1.602176634 \\times 10^{-19} \\, \\text{C}$ 是基本电荷。\n\n比较数值通量（$\\Gamma^{\\text{num}}, q^{\\text{num}}$）与基准通量（$\\Gamma^\\star, q^\\star$）的误差度量定义为：\n- 相对粒子通量误差：$\\varepsilon_\\Gamma = \\frac{\\left|\\Gamma^{\\text{num}} - \\Gamma^\\star\\right|}{\\Gamma^\\star}$\n- 相对热通量误差：$\\varepsilon_q = \\frac{\\left|q^{\\text{num}} - q^\\star\\right|}{q^\\star}$\n- 聚合均方根误差：$\\varepsilon_{\\text{rms}} = \\sqrt{\\frac{\\varepsilon_\\Gamma^2 + \\varepsilon_q^2}{2}}$\n\n### 计算流程\n\n对于每个测试用例，将执行以下计算序列：\n1.  检索输入参数：$m_i$、$T_e$ [eV]、$n_0$、$M_0$ 和 $\\gamma$。\n2.  将电子温度转换为国际单位制（SI）单位：$T_{e, \\text{J}} = T_e \\, [\\text{eV}] \\times e$。\n3.  计算离子声速：$c_s = \\sqrt{T_{e, \\text{J}} / m_i}$。\n4.  计算鞘层入口密度：$n_s = n_0 \\exp(0.5 \\times (M_0^2 - 1))$。\n5.  计算基准粒子通量：$\\Gamma^\\star = n_s c_s$。\n6.  计算基准热通量：$q^\\star = \\gamma n_s T_{e, \\text{J}} c_s$。\n7.  使用特定测试用例指定的乘法因子，构建数值通量 $\\Gamma^{\\text{num}}$ 和 $q^{\\text{num}}$。\n8.  计算相对误差 $\\varepsilon_\\Gamma$ 和 $\\varepsilon_q$。由于数值由 $\\Gamma^{\\text{num}} = p_\\Gamma \\Gamma^\\star$ 和 $q^{\\text{num}} = p_q q^\\star$ 给出，其中 $p_\\Gamma$ 和 $p_q$ 是扰动因子，误差可简化为 $\\varepsilon_\\Gamma = |p_\\Gamma - 1|$ 和 $\\varepsilon_q = |p_q - 1|$。\n9.  计算聚合误差 $\\varepsilon_{\\text{rms}}$。\n10. 整理三个误差度量以供最终输出。\n\n该流程将以编程方式实现，以处理测试套件并生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes verification test error metrics for a SOL fluid code.\n\n    This function implements the derived analytic benchmarks for particle and\n    heat fluxes at the sheath entrance in an isothermal, collisionless plasma.\n    It then calculates relative and RMS errors against specified \"numerical\"\n    fluxes for a suite of test cases.\n    \"\"\"\n    # Define physical constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n\n    # Define the test suite.\n    # Each case: (m_i [kg], T_e [eV], n_0 [m^-3], M_0, gamma, pert_gamma, pert_q)\n    # pert_gamma is the factor for Gamma_num = pert_gamma * Gamma_star\n    # pert_q is the factor for q_num = pert_q * q_star\n    test_cases = [\n        # Case A: happy path, modest subsonic inflow\n        (3.345e-27, 20.0, 1.0e19, 0.10, 7.0, 1.02, 0.97),\n        # Case B: near-Bohm upstream, zero error\n        (3.345e-27, 5.0, 5.0e18, 0.95, 7.0, 1.00, 1.00),\n        # Case C: different ion species and temperature, larger discrepancies\n        (6.644657e-27, 3.0, 2.0e19, 0.50, 6.5, 0.90, 1.15),\n        # Case D: very subsonic upstream, no discrepancy\n        (3.345e-27, 100.0, 1.0e18, 0.01, 7.0, 1.00, 1.00),\n    ]\n\n    results = []\n    for case in test_cases:\n        m_i, T_e_eV, n_0, M_0, gamma, pert_gamma, pert_q = case\n\n        # 1. Convert Te to Joules\n        T_e_J = T_e_eV * E_CHARGE\n\n        # 2. Calculate ion sound speed (c_s)\n        c_s = np.sqrt(T_e_J / m_i)\n\n        # 3. Calculate sheath entrance density (n_s)\n        n_s = n_0 * np.exp(0.5 * (M_0**2 - 1.0))\n\n        # 4. Calculate benchmark fluxes (Gamma_star, q_star)\n        # These calculations are part of the required procedure, even if the\n        # errors can be computed directly from the perturbation factors.\n        gamma_star = n_s * c_s\n        q_star = gamma * n_s * T_e_J * c_s\n\n        # 5. Construct \"numerical\" fluxes\n        gamma_num = pert_gamma * gamma_star\n        q_num = pert_q * q_star\n\n        # 6. Calculate relative errors (epsilon_gamma, epsilon_q)\n        # This simplifies to abs(perturbation factor - 1)\n        err_gamma = np.abs(gamma_num - gamma_star) / gamma_star\n        err_q = np.abs(q_num - q_star) / q_star\n\n        # 7. Calculate aggregate RMS error (epsilon_rms)\n        err_rms = np.sqrt((err_gamma**2 + err_q**2) / 2.0)\n\n        results.append([err_gamma, err_q, err_rms])\n\n    # Final print statement in the exact required format.\n    # The format string produces output like [[a,b,c],[d,e,f]]\n    # which matches the problem description of a list of lists.\n    # Python's default str(list) produces spaces after commas, as required.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}