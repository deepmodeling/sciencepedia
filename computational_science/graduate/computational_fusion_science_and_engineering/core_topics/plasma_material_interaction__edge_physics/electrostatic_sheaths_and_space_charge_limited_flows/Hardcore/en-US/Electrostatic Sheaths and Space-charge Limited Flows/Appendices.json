{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of plasma physics is the concept of quasi-neutrality, yet this is an approximation. This exercise provides a practical way to assess the validity of that approximation in a bounded system. By estimating the volume occupied by non-neutral sheaths relative to the total plasma volume , you will reinforce your understanding of the Debye length, $\\lambda_D$, as the fundamental scale of charge separation and appreciate its importance in defining the boundary between the bulk plasma and its material interfaces.",
            "id": "3971642",
            "problem": "A long, axially uniform, singly ionized plasma column of length $L$ and outer cylindrical boundary of radius $R$ contains a coaxial cylindrical metallic probe of radius $a$ ($0aR$). The plasma has electron number density $n_{0}$ and electron temperature $T_{e}$ such that the Debye length is $\\lambda_{D}=\\sqrt{\\frac{\\epsilon_{0} k_{B} T_{e}}{n_{0} e^{2}}}$, where $\\epsilon_{0}$ is the vacuum permittivity, $k_{B}$ is the Boltzmann constant, and $e$ is the elementary charge. Assume steady-state, collisionless electrostatic sheaths form on all plasma-contacting surfaces with monotonic potential variation and that the interior (bulk) region remains approximately quasi-neutral.\n\nUsing first principles, argue that the sheath thickness adjacent to each plasma-contacting surface is of order $\\lambda_{D}$ and model the sheath thickness by $\\alpha \\lambda_{D}$, where $\\alpha$ is an order-unity dimensionless constant that parameterizes the dependence on the potential drop and ion flow (e.g., consistent with the Bohm criterion and Debye shielding). Under the geometric limit $a \\gg \\lambda_{D}$, estimate the fraction $f$ of the total plasma volume that is non-neutral (i.e., occupied by sheaths) by summing the contributions from the sidewall sheath on the probe, the sidewall sheath on the outer boundary, and the two axial end-face sheaths. Neglect any overlap of sheaths and curvature corrections beyond the leading-order cylindrical area scaling implied by $a \\gg \\lambda_{D}$ and $R \\gg \\lambda_{D}$.\n\nExpress your final answer for $f$ as a single closed-form analytic expression in terms of $a$, $R$, $L$, $\\lambda_{D}$, and $\\alpha$. The fraction $f$ is dimensionless; express it as a pure number (not a percentage).",
            "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, and objective. It represents a standard problem in plasma physics concerning the estimation of sheath volumes in a defined geometry.\n\nThe solution proceeds in two parts as requested by the problem statement. First, we provide a first-principles argument for the sheath thickness scaling with the Debye length. Second, we calculate the fraction of the plasma volume occupied by sheaths.\n\n**Part 1: First-Principles Argument for Sheath Thickness**\n\nIn electrostatics, the relationship between the electric potential $\\phi$ and the charge density $\\rho$ is given by Poisson's equation:\n$$ \\nabla^2 \\phi = -\\frac{\\rho}{\\epsilon_0} $$\nIn a plasma consisting of singly ionized ions and electrons, the charge density is $\\rho = e(n_i - n_e)$, where $n_i$ and $n_e$ are the ion and electron number densities, respectively, and $e$ is the elementary charge. Thus, Poisson's equation becomes:\n$$ \\nabla^2 \\phi = -\\frac{e(n_i - n_e)}{\\epsilon_0} $$\nIn the bulk plasma, far from any boundaries, the plasma is quasi-neutral, so $n_i \\approx n_e \\approx n_0$, and the potential can be set to $\\phi=0$. Near a surface that is at a negative potential with respect to the bulk plasma, electrons are repelled. Assuming the electrons are in thermal equilibrium at a temperature $T_e$, their density distribution follows the Boltzmann relation:\n$$ n_e(\\phi) = n_0 \\exp\\left(\\frac{e\\phi}{k_B T_e}\\right) $$\nwhere $k_B$ is the Boltzmann constant.\n\nTo understand the characteristic length scale of potential screening, we consider a small perturbation from the quasi-neutral state, such that $|e\\phi/k_B T_e| \\ll 1$. We can linearize the exponential in the Boltzmann relation:\n$$ n_e \\approx n_0 \\left(1 + \\frac{e\\phi}{k_B T_e}\\right) $$\nAssuming the ions are much heavier and less mobile, their density can be approximated as constant, $n_i \\approx n_0$, over the length scale of the perturbation. The net charge density is then:\n$$ \\rho = e(n_i - n_e) \\approx e\\left[n_0 - n_0\\left(1 + \\frac{e\\phi}{k_B T_e}\\right)\\right] = -\\frac{n_0 e^2 \\phi}{k_B T_e} $$\nSubstituting this linearized charge density back into Poisson's equation yields:\n$$ \\nabla^2 \\phi = -\\frac{1}{\\epsilon_0}\\left(-\\frac{n_0 e^2 \\phi}{k_B T_e}\\right) = \\left(\\frac{n_0 e^2}{\\epsilon_0 k_B T_e}\\right)\\phi $$\nThe term in the parenthesis is the inverse square of the Debye length, $\\lambda_D = \\sqrt{\\frac{\\epsilon_0 k_B T_e}{n_0 e^2}}$. The equation becomes the screened Poisson equation:\n$$ \\nabla^2 \\phi = \\frac{1}{\\lambda_D^2}\\phi $$\nIn one dimension, this is $\\frac{d^2\\phi}{dx^2} - \\frac{1}{\\lambda_D^2}\\phi = 0$. The solution that decays into the bulk plasma (where $\\phi \\to 0$) is of the form $\\phi(x) = \\phi_{\\text{wall}} \\exp(-x/\\lambda_D)$, where $x$ is the distance from the surface. This result demonstrates that the plasma screens out electric fields over a characteristic length of $\\lambda_D$.\n\nWhile this linear theory is valid only for small potentials, it establishes the fundamental length scale. A full, non-linear sheath involves a significant potential drop and ion acceleration (governed by the Bohm criterion). These effects result in a region of significant charge separation (the sheath) whose thickness is typically a few Debye lengths. Therefore, modeling the sheath thickness as $s = \\alpha \\lambda_D$, where $\\alpha$ is an order-unity constant, is a physically sound simplification that captures the correct scaling.\n\n**Part 2: Calculation of the Non-Neutral Volume Fraction**\n\nThe plasma is confined to a hollow cylindrical volume of length $L$, with inner radius $a$ and outer radius $R$. The total volume of the plasma is:\n$$ V_{\\text{plasma}} = (\\text{Area of annular cross-section}) \\times (\\text{Length}) $$\n$$ V_{\\text{plasma}} = (\\pi R^2 - \\pi a^2)L = \\pi (R^2 - a^2)L $$\n\nThe non-neutral volume is the total volume of the sheaths formed on all plasma-contacting surfaces. We are given a sheath thickness $s = \\alpha \\lambda_D$. We are instructed to neglect curvature corrections and sheath overlap, which is valid under the given assumptions $a \\gg \\lambda_D$ and $R \\gg \\lambda_D$. This allows us to approximate the volume of each sheath by its surface area multiplied by the thickness $s$.\n\nThe total sheath volume, $V_{\\text{sheath}}$, is the sum of contributions from four surfaces:\n1.  **Sheath on the inner probe sidewall (radius $a$):**\n    The surface area is $A_a = 2\\pi a L$. The volume is $V_{\\text{sheath}, a} \\approx A_a s = (2\\pi a L)(\\alpha \\lambda_D)$.\n2.  **Sheath on the outer boundary sidewall (radius $R$):**\n    The surface area is $A_R = 2\\pi R L$. The volume is $V_{\\text{sheath}, R} \\approx A_R s = (2\\pi R L)(\\alpha \\lambda_D)$.\n3.  **Sheaths on the two axial end-faces:**\n    Each end-face is an annulus with area $A_{\\text{end}} = \\pi R^2 - \\pi a^2$. Since there are two ends, the total area is $2 A_{\\text{end}}$. The total volume is $V_{\\text{sheath}, \\text{ends}} \\approx (2 A_{\\text{end}})s = 2\\pi(R^2 - a^2)(\\alpha \\lambda_D)$.\n\nThe total sheath volume is the sum of these contributions:\n$$ V_{\\text{sheath}} = V_{\\text{sheath}, a} + V_{\\text{sheath}, R} + V_{\\text{sheath}, \\text{ends}} $$\n$$ V_{\\text{sheath}} = 2\\pi a L \\alpha \\lambda_D + 2\\pi R L \\alpha \\lambda_D + 2\\pi(R^2 - a^2)\\alpha \\lambda_D $$\nFactoring out the common term $2\\pi \\alpha \\lambda_D$:\n$$ V_{\\text{sheath}} = 2\\pi \\alpha \\lambda_D \\left[ aL + RL + (R^2 - a^2) \\right] $$\n\nThe fraction $f$ of the total plasma volume that is non-neutral is the ratio of the total sheath volume to the total plasma volume:\n$$ f = \\frac{V_{\\text{sheath}}}{V_{\\text{plasma}}} = \\frac{2\\pi \\alpha \\lambda_D [L(a+R) + (R^2 - a^2)]}{\\pi (R^2 - a^2)L} $$\nUsing the identity $R^2 - a^2 = (R-a)(R+a)$, we can simplify:\n$$ f = \\frac{2 \\alpha \\lambda_D [L(a+R) + (R-a)(R+a)]}{(R-a)(R+a)L} $$\nWe can separate the expression inside the brackets:\n$$ f = \\frac{2 \\alpha \\lambda_D}{(R-a)(R+a)L} [L(R+a)] + \\frac{2 \\alpha \\lambda_D}{(R-a)(R+a)L} [(R-a)(R+a)] $$\nCanceling terms in each part:\n$$ f = \\frac{2 \\alpha \\lambda_D}{R-a} + \\frac{2 \\alpha \\lambda_D}{L} $$\nFactoring out the common term $2 \\alpha \\lambda_D$ gives the final expression:\n$$ f = 2 \\alpha \\lambda_D \\left(\\frac{1}{R-a} + \\frac{1}{L}\\right) $$\nThis expression is dimensionless, as expected for a fraction. The term $(\\frac{1}{R-a} + \\frac{1}{L})$ has units of inverse length, which is canceled by the units of length from $\\lambda_D$.",
            "answer": "$$\\boxed{2 \\alpha \\lambda_{D} \\left(\\frac{1}{R-a} + \\frac{1}{L}\\right)}$$"
        },
        {
            "introduction": "We now shift our focus from the static structure of the sheath to the dynamics of charge carriers flowing through it. The Child-Langmuir law provides the classic description of space-charge limited current, but its familiar $V^{3/2}$ scaling is tied to a specific assumption about carrier kinetics. This problem  challenges you to generalize this law by deriving it from first principles for a non-standard energy-velocity relationship, a task that deepens the understanding of the underlying physics and its applicability to different physical systems, such as semiconductors.",
            "id": "3971660",
            "problem": "A planar, one-dimensional electrostatic sheath separates an emitting surface at position $x=0$ (cathode) from a collecting surface at position $x=L$ (anode). The anode is held at a positive potential $V0$ relative to the cathode. Electrons are emitted from the cathode with negligible initial kinetic energy, and the flow is space-charge limited in steady state. Assume a collisionless, single-species electron flow and neglect ion motion. The material between the electrodes is characterized by a permittivity $\\varepsilon$ (not necessarily the vacuum permittivity). Let the electron charge magnitude be $e$. Define the electrostatic potential $\\phi(x)$ with $\\phi(0)=0$ and $\\phi(L)=V$.\n\nIn a non-parabolic band transport regime relevant to high-field semiconducting plasma analogs, assume the carrier speed depends on the carrier kinetic energy $\\mathcal{E}$ as $v(\\mathcal{E})=B\\,\\mathcal{E}^{\\gamma}$, where $B0$ and $\\gamma$ are material parameters, and $\\mathcal{E}=e\\,\\phi(x)$ in steady one-dimensional acceleration. Take the space-charge-limited boundary condition $E(0)=0$ for the electric field $E(x)=-\\,d\\phi/dx$.\n\nStarting only from the fundamental relations of electrostatics and steady transport in one dimension, namely Gauss’s law in differential form and charge conservation, derive a generalized Child–Langmuir (CL) law that gives the space-charge-limited current density $J$ as a function of $V$, $L$, $\\varepsilon$, $B$, $e$, and $\\gamma$. State clearly the range of $\\gamma$ for which your derivation is mathematically consistent under the stated boundary condition, and recover the classical parabolic-band limit by identifying the appropriate $B$ and $\\gamma$.\n\nExpress your final result for $J$ symbolically in $\\mathrm{A\\,m^{-2}}$. No numerical evaluation is required, and no rounding is needed. The final answer must be a single closed-form analytic expression for $J$ in terms of $V$, $L$, $\\varepsilon$, $B$, $e$, and $\\gamma$.",
            "solution": "The problem asks for a generalization of the Child-Langmuir law for a non-parabolic energy-speed relationship. The derivation will proceed from the fundamental equations of electrostatics and steady-state current flow in one dimension.\n\nThe governing physical laws for this system are Poisson's equation and the equation for current continuity.\nPoisson's equation in one dimension relates the electrostatic potential $\\phi(x)$ to the space charge density $\\rho(x)$:\n$$\n\\frac{d^2\\phi}{dx^2} = -\\frac{\\rho(x)}{\\varepsilon}\n$$\nIn steady state, the current density $J$ is constant throughout the domain. For a flow of particles with charge density $\\rho(x)$ and velocity $v(x)$, the current density magnitude is given by $J = |\\rho(x)| v(x)$. Since the carriers are electrons with charge $-e$, the charge density is $\\rho(x) = -n_e(x) e  0$, where $n_e(x)$ is the electron number density. The current density is $J = n_e(x) e v(x)$. Therefore, we can express the magnitude of the charge density as $|\\rho(x)| = J/v(x)$, which implies $\\rho(x) = -J/v(x)$.\n\nSubstituting this expression for $\\rho(x)$ into Poisson's equation gives:\n$$\n\\frac{d^2\\phi}{dx^2} = -\\frac{1}{\\varepsilon} \\left(-\\frac{J}{v(x)}\\right) = \\frac{J}{\\varepsilon v(x)}\n$$\nThe problem states that the electrons are emitted with negligible initial kinetic energy from the cathode at $x=0$, where the potential is $\\phi(0)=0$. The kinetic energy $\\mathcal{E}$ of an electron at a position $x$ is thus entirely due to the work done by the electric field, $\\mathcal{E}(x) = e\\phi(x)$.\n\nThe carrier speed $v$ is given as a function of kinetic energy: $v(\\mathcal{E}) = B\\mathcal{E}^{\\gamma}$. Substituting $\\mathcal{E}(x) = e\\phi(x)$, we get the speed as a function of potential:\n$$\nv(x) = B(e\\phi(x))^{\\gamma} = B e^{\\gamma} \\phi(x)^{\\gamma}\n$$\nWe can now insert this expression for $v(x)$ into our differential equation for $\\phi(x)$:\n$$\n\\frac{d^2\\phi}{dx^2} = \\frac{J}{\\varepsilon B e^{\\gamma}} \\phi(x)^{-\\gamma}\n$$\nThis is a second-order nonlinear ordinary differential equation for $\\phi(x)$. Let us define the constant coefficient $C = \\frac{J}{\\varepsilon B e^{\\gamma}}$. The equation becomes $\\phi'' = C\\phi^{-\\gamma}$. To solve this, we use the standard technique of multiplying by $2\\phi'$ (the first integral method):\n$$\n2\\phi'\\phi'' = 2C\\phi'\\phi^{-\\gamma}\n$$\nRecognizing that $2\\phi'\\phi'' = \\frac{d}{dx}(\\phi')^2$ and $\\phi' = \\frac{d\\phi}{dx}$, we can integrate both sides with respect to $x$:\n$$\n\\int \\frac{d}{dx}(\\phi')^2 dx = \\int 2C\\phi^{-\\gamma} \\frac{d\\phi}{dx} dx\n$$\n$$\n(\\phi')^2 = 2C \\int \\phi^{-\\gamma} d\\phi\n$$\nThe evaluation of the integral requires consideration of the value of $\\gamma$. Let us first assume $\\gamma \\neq 1$.\n$$\n(\\phi')^2 = 2C \\frac{\\phi^{1-\\gamma}}{1-\\gamma} + K_1\n$$\nwhere $K_1$ is an integration constant. We determine $K_1$ using the boundary conditions at the cathode ($x=0$). We have $\\phi(0)=0$. The space-charge limited condition is specified as $E(0)=0$. Since the electric field is $E(x) = -d\\phi/dx = -\\phi'$, this implies $\\phi'(0)=0$. Substituting these conditions into the integrated equation:\n$$\n(0)^2 = 2C \\frac{(0)^{1-\\gamma}}{1-\\gamma} + K_1\n$$\nFor this equation to hold, the term $(0)^{1-\\gamma}$ must be well-defined and equal to zero. This requires the exponent to be positive, i.e., $1-\\gamma  0$, or $\\gamma  1$. Under this condition, the equation yields $K_1=0$.\nFurthermore, for $(\\phi')^2$ to be non-negative, and since $C0$ and $\\phi(x) \\geq 0$, the denominator $1-\\gamma$ must also be positive, which again requires $\\gamma1$. If $\\gamma=1$, the integral yields a logarithm, $\\ln(\\phi)$, which diverges at $\\phi=0$, making the boundary condition ill-defined. Thus, the derivation is only consistent for $\\gamma  1$.\n\nWith $K_1=0$ and $\\gamma1$, the equation becomes:\n$$\n(\\phi')^2 = \\frac{2C}{1-\\gamma}\\phi^{1-\\gamma}\n$$\nTaking the square root, we get $\\phi' = \\pm \\sqrt{\\frac{2C}{1-\\gamma}} \\phi^{(1-\\gamma)/2}$. The force on an electron is $F = (-e)E = (-e)(-\\phi') = e\\phi'$. For the electrons to accelerate from the cathode to the anode, the force must be in the positive $x$ direction, requiring $F0$. Since $e0$, we must have $\\phi'  0$. Therefore, we choose the positive root:\n$$\n\\frac{d\\phi}{dx} = \\sqrt{\\frac{2C}{1-\\gamma}} \\phi^{(1-\\gamma)/2}\n$$\nThis is a separable first-order differential equation. We rearrange it as:\n$$\n\\phi^{-(1-\\gamma)/2} d\\phi = \\sqrt{\\frac{2C}{1-\\gamma}} dx\n$$\nWe integrate both sides. The left side is integrated from $\\phi(0)=0$ to $\\phi(x)$, and the right side from $0$ to $x$:\n$$\n\\int_0^{\\phi(x)} \\tilde{\\phi}^{-(1-\\gamma)/2} d\\tilde{\\phi} = \\int_0^x \\sqrt{\\frac{2C}{1-\\gamma}} d\\tilde{x}\n$$\nTo evaluate the integral on the left, we must ensure the exponent isn't $-1$. The case $-(1-\\gamma)/2 = -1$ corresponds to $1-\\gamma = 2$, or $\\gamma = -1$. Assuming $\\gamma \\neq -1$, the integral is:\n$$\n\\left[ \\frac{\\tilde{\\phi}^{1 - (1-\\gamma)/2}}{1 - (1-\\gamma)/2} \\right]_0^{\\phi(x)} = \\left[ \\frac{\\tilde{\\phi}^{(1+\\gamma)/2}}{(1+\\gamma)/2} \\right]_0^{\\phi(x)}\n$$\nFor the evaluation at the lower limit $\\tilde{\\phi}=0$ to be zero, the exponent must be positive: $(1+\\gamma)/2  0$, which implies $\\gamma  -1$. If $\\gamma=-1$, the integral results in a logarithm which diverges at the lower limit.\nThus, the derivation requires $\\gamma  -1$.\n\nCombining our constraints, the solution is mathematically consistent for the range of $\\gamma$ given by $-1  \\gamma  1$. For this range, the integrated equation is:\n$$\n\\frac{2}{1+\\gamma} \\phi(x)^{(1+\\gamma)/2} = \\sqrt{\\frac{2C}{1-\\gamma}} x\n$$\nWe solve for $\\phi(x)$:\n$$\n\\phi(x) = \\left[ \\left( \\frac{1+\\gamma}{2} \\right) \\sqrt{\\frac{2C}{1-\\gamma}} x \\right]^{2/(1+\\gamma)}\n$$\nNow, we apply the final boundary condition at the anode ($x=L$), which is $\\phi(L)=V$:\n$$\nV = \\left[ \\left( \\frac{1+\\gamma}{2} \\right) \\sqrt{\\frac{2C}{1-\\gamma}} L \\right]^{2/(1+\\gamma)}\n$$\nTo solve for $J$, we first solve for $C$. Raise both sides to the power of $(1+\\gamma)/2$:\n$$\nV^{(1+\\gamma)/2} = \\left( \\frac{1+\\gamma}{2} \\right) \\sqrt{\\frac{2C}{1-\\gamma}} L\n$$\nIsolate the term containing $C$:\n$$\n\\sqrt{\\frac{2C}{1-\\gamma}} = \\frac{2}{1+\\gamma} \\frac{V^{(1+\\gamma)/2}}{L}\n$$\nSquare both sides:\n$$\n\\frac{2C}{1-\\gamma} = \\frac{4}{(1+\\gamma)^2} \\frac{V^{1+\\gamma}}{L^2}\n$$\n$$\nC = \\frac{2(1-\\gamma)}{(1+\\gamma)^2} \\frac{V^{1+\\gamma}}{L^2}\n$$\nFinally, we substitute back the definition $C = \\frac{J}{\\varepsilon B e^{\\gamma}}$ and solve for the current density $J$:\n$$\n\\frac{J}{\\varepsilon B e^{\\gamma}} = \\frac{2(1-\\gamma)}{(1+\\gamma)^2} \\frac{V^{1+\\gamma}}{L^2}\n$$\n$$\nJ = \\frac{2 \\varepsilon B e^{\\gamma} (1-\\gamma)}{(1+\\gamma)^2} \\frac{V^{1+\\gamma}}{L^2}\n$$\nThis is the generalized Child-Langmuir law for the specified transport model.\n\nThe range of the parameter $\\gamma$ for which this derivation is mathematically consistent under the given boundary conditions is $\\gamma \\in (-1, 1)$.\n\nTo recover the classical result for a parabolic band, we note that the kinetic energy is $\\mathcal{E} = \\frac{1}{2}m_e v^2$, where $m_e$ is the electron mass. This gives a speed $v = \\sqrt{2\\mathcal{E}/m_e} = (2/m_e)^{1/2} \\mathcal{E}^{1/2}$. Comparing this to the given relation $v = B\\mathcal{E}^{\\gamma}$, we identify:\n$$\n\\gamma = \\frac{1}{2} \\quad \\text{and} \\quad B = \\sqrt{\\frac{2}{m_e}}\n$$\nThe value $\\gamma=1/2$ lies within the valid range $(-1, 1)$. Substituting these values, along with the vacuum permittivity $\\varepsilon = \\varepsilon_0$, into our generalized law:\n$$\nJ = \\frac{2 \\varepsilon_0 \\left(\\sqrt{\\frac{2}{m_e}}\\right) e^{1/2} (1 - 1/2)}{(1 + 1/2)^2} \\frac{V^{1+1/2}}{L^2}\n$$\n$$\nJ = \\frac{2 \\varepsilon_0 \\sqrt{\\frac{2}{m_e}} e^{1/2} (1/2)}{(3/2)^2} \\frac{V^{3/2}}{L^2} = \\frac{\\varepsilon_0 \\sqrt{\\frac{2e}{m_e}}}{9/4} \\frac{V^{3/2}}{L^2}\n$$\n$$\nJ = \\frac{4}{9}\\varepsilon_0 \\sqrt{\\frac{2e}{m_e}} \\frac{V^{3/2}}{L^2}\n$$\nThis is the well-known classical Child-Langmuir law, which confirms the correctness of our generalized derivation.\n\nThe final expression for the generalized current density $J$ is:\n$$\nJ = \\frac{2 \\varepsilon B e^{\\gamma} (1-\\gamma) V^{1+\\gamma}}{(1+\\gamma)^2 L^2}\n$$",
            "answer": "$$\n\\boxed{\\frac{2 \\varepsilon B e^{\\gamma} (1-\\gamma) V^{1+\\gamma}}{(1+\\gamma)^{2} L^{2}}}\n$$"
        },
        {
            "introduction": "Theoretical models of the sheath are not just academic; they are critical benchmarks for the complex computational codes used in fusion research. This practice puts you in the role of a computational scientist performing a verification test on a Scrape-Off Layer (SOL) fluid code. You will derive an exact analytical solution for plasma fluxes at the sheath entrance based on the Bohm criterion and use it to quantify the accuracy of a hypothetical numerical result , illustrating a crucial process for building confidence in simulation tools.",
            "id": "3971663",
            "problem": "You are tasked with designing and implementing a verification test for a Scrape-Off Layer (SOL) fluid code in the isothermal, collisionless sheath limit. The objective is to assess the fidelity of the simulated parallel fluxes at the sheath entrance against an analytic benchmark defined by the Bohm criterion and a known heat transmission coefficient. You must derive the benchmark formulas from first principles and then compute quantitative error metrics comparing given code-reported fluxes to the benchmark.\n\nAssumptions and fundamental bases:\n- The plasma is steady-state, one-dimensional, quasi-neutral, and isothermal along the field line between an upstream location and the sheath entrance.\n- The ions are singly charged, cold relative to electrons, and the electrons are isothermal with temperature $T_e$.\n- The ion flow at the sheath entrance satisfies the Bohm criterion with equality, i.e., $u_i = c_s$, where $c_s$ is the ion sound speed.\n- The ion sound speed is $c_s = \\sqrt{T_e/m_i}$, where $m_i$ is the ion mass and $T_e$ is expressed in Joules.\n- Mass conservation yields a constant particle flux $\\Gamma = n u$ along the field line.\n- Steady isothermal momentum balance gives $m_i u \\, du/dx = - T_e \\, d(\\ln n)/dx$.\n- At the sheath entrance, the total parallel heat flux to the wall is modeled as $q_\\parallel = \\gamma \\, n_s \\, T_e \\, c_s$, where $n_s$ is the density at the sheath entrance, and $\\gamma$ is a known, dimensionless heat transmission coefficient derived from kinetic theory for isothermal sheaths. The value of $\\gamma$ is provided for each test case.\n\nYour derivation must use the above fundamental relations only and must not invoke any other shortcut formulas. Let the upstream state be characterized by density $n_0$, ion Mach number $M_0 = u_0 / c_s$ with $0  M_0  1$, and electron temperature $T_e$. Show that integrating the momentum balance implies the invariant\n$$\n\\frac{1}{2} m_i u^2 + T_e \\ln n = \\text{constant},\n$$\nand, using the Bohm condition $u_s = c_s$ at the sheath entrance, prove that\n$$\nn_s = n_0 \\exp\\!\\left(\\frac{1}{2}\\left(M_0^2 - 1\\right)\\right).\n$$\nThen deduce the analytic benchmark particle flux and heat flux at the sheath entrance as\n$$\n\\Gamma^\\star = n_s \\, c_s, \\quad q^\\star = \\gamma \\, n_s \\, T_e \\, c_s.\n$$\nAll instances of $T_e$ in formulas used for computation must be converted from electronvolts to Joules via $T_e \\, [\\text{J}] = T_e \\, [\\text{eV}] \\times e$, where $e = 1.602176634 \\times 10^{-19}$ is the elementary charge in Coulombs. All computed fluxes must be in International System of Units: $\\Gamma^\\star$ in $\\text{m}^{-2}\\,\\text{s}^{-1}$ and $q^\\star$ in $\\text{W}\\,\\text{m}^{-2}$.\n\nVerification and error metrics:\n- For each test case, you are given a pair of code-reported fluxes $(\\Gamma^{\\text{num}}, q^{\\text{num}})$ intended to represent the output of a SOL fluid code at the sheath entrance for the same upstream parameters.\n- Define the relative particle-flux error and relative heat-flux error as\n$$\n\\varepsilon_\\Gamma = \\frac{\\left|\\Gamma^{\\text{num}} - \\Gamma^\\star\\right|}{\\Gamma^\\star}, \\quad \n\\varepsilon_q = \\frac{\\left|q^{\\text{num}} - q^\\star\\right|}{q^\\star}.\n$$\n- Define the aggregate error metric as the root-mean-square of the two relative errors:\n$$\n\\varepsilon_{\\text{rms}} = \\sqrt{\\frac{\\varepsilon_\\Gamma^2 + \\varepsilon_q^2}{2}}.\n$$\nAll error metrics are dimensionless and must be reported as decimals (not percentages).\n\nTest suite:\nFor each case, the parameters are $(m_i \\, [\\text{kg}], \\, T_e \\, [\\text{eV}], \\, n_0 \\, [\\text{m}^{-3}], \\, M_0 \\, [\\text{dimensionless}], \\, \\gamma \\, [\\text{dimensionless}], \\, \\Gamma^{\\text{num}} \\, [\\text{m}^{-2}\\,\\text{s}^{-1}], \\, q^{\\text{num}} \\, [\\text{W}\\,\\text{m}^{-2}])$. Use the given values exactly.\n\n- Case A (happy path, modest subsonic inflow):\n  - $m_i = 3.345 \\times 10^{-27}$, $T_e = 20.0$, $n_0 = 1.0 \\times 10^{19}$, $M_0 = 0.10$, $\\gamma = 7.0$.\n  - Define the code-reported fluxes as multiplicative perturbations of the benchmark: $\\Gamma^{\\text{num}} = 1.02 \\, \\Gamma^\\star$, $q^{\\text{num}} = 0.97 \\, q^\\star$.\n- Case B (near-Bohm upstream, zero error):\n  - $m_i = 3.345 \\times 10^{-27}$, $T_e = 5.0$, $n_0 = 5.0 \\times 10^{18}$, $M_0 = 0.95$, $\\gamma = 7.0$.\n  - $\\Gamma^{\\text{num}} = 1.00 \\, \\Gamma^\\star$, $q^{\\text{num}} = 1.00 \\, q^\\star$.\n- Case C (different ion species and temperature, larger discrepancies):\n  - $m_i = 6.644657 \\times 10^{-27}$, $T_e = 3.0$, $n_0 = 2.0 \\times 10^{19}$, $M_0 = 0.50$, $\\gamma = 6.5$.\n  - $\\Gamma^{\\text{num}} = 0.90 \\, \\Gamma^\\star$, $q^{\\text{num}} = 1.15 \\, q^\\star$.\n- Case D (very subsonic upstream, no discrepancy):\n  - $m_i = 3.345 \\times 10^{-27}$, $T_e = 100.0$, $n_0 = 1.0 \\times 10^{18}$, $M_0 = 0.01$, $\\gamma = 7.0$.\n  - $\\Gamma^{\\text{num}} = 1.00 \\, \\Gamma^\\star$, $q^{\\text{num}} = 1.00 \\, q^\\star$.\n\nProgramming task and required output:\n- Implement a program that, for each test case, computes $c_s$, $n_s$, $\\Gamma^\\star$, and $q^\\star$ using the formulas above, constructs $(\\Gamma^{\\text{num}}, q^{\\text{num}})$ according to the specified multiplicative relations, and evaluates $\\varepsilon_\\Gamma$, $\\varepsilon_q$, and $\\varepsilon_{\\text{rms}}$.\n- Your program should produce a single line of output containing the results as a list of lists with three decimal floats per test case in the order $[\\varepsilon_\\Gamma, \\varepsilon_q, \\varepsilon_{\\text{rms}}]$. The final output must be formatted exactly as:\n\"[ [err_Gamma_A, err_q_A, err_rms_A], [err_Gamma_B, err_q_B, err_rms_B], [err_Gamma_C, err_q_C, err_rms_C], [err_Gamma_D, err_q_D, err_rms_D] ]\"\nbut without any spaces except those inherently produced inside the inner lists by Python’s default list-to-string conversion. The errors must be decimals, not percentages.\n\nAll intermediate quantities must be in coherent International System of Units, and all angles (if any) must be in radians, although no angles are expected in this problem. The program must use the test suite given here and must not request any user input.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in established principles of plasma fluid dynamics, specifically the isothermal, one-dimensional model of the scrape-off layer terminating at a sheath. The problem is well-posed, with all necessary data and definitions provided for a unique solution. The language is objective and the tasks are formalizable. We may therefore proceed with the solution.\n\n### Derivation of Analytic Benchmarks\n\nWe begin by deriving the required relations based on the provided assumptions. The plasma is in a steady state ($\\partial/\\partial t = 0$), one-dimensional ($1$D) along a magnetic field line (coordinate $x$), quasi-neutral ($n_i \\approx n_e = n$), and the electrons are isothermal with a constant temperature $T_e$.\n\n**1. Derivation of the Plasma Flow Invariant**\n\nThe steady-state, $1$D ion momentum balance equation is given as:\n$$\nm_i u \\frac{du}{dx} = - T_e \\frac{d(\\ln n)}{dx}\n$$\nwhere $m_i$ is the ion mass, $u$ is the ion fluid velocity, $n$ is the plasma density, and $T_e$ is the electron temperature in Joules. The electron temperature $T_e$ is constant along the field line.\n\nThe left-hand side of the equation can be expressed as the spatial derivative of the ion kinetic energy per particle:\n$$\nm_i u \\frac{du}{dx} = \\frac{d}{dx} \\left( \\frac{1}{2} m_i u^2 \\right)\n$$\nThe right-hand side involves the derivative of the natural logarithm of the density, which relates to the electron pressure gradient force, $-(1/n) \\nabla p_e = -(T_e/n) \\nabla n = -T_e \\nabla(\\ln n)$. Since $T_e$ is constant, it can be brought inside the derivative:\n$$\n-T_e \\frac{d(\\ln n)}{dx} = -\\frac{d}{dx} (T_e \\ln n)\n$$\nEquating the rewritten expressions gives:\n$$\n\\frac{d}{dx} \\left( \\frac{1}{2} m_i u^2 \\right) = -\\frac{d}{dx} (T_e \\ln n)\n$$\nThis can be rearranged into a single derivative:\n$$\n\\frac{d}{dx} \\left( \\frac{1}{2} m_i u^2 + T_e \\ln n \\right) = 0\n$$\nIntegrating this equation with respect to the spatial coordinate $x$ yields the desired invariant:\n$$\n\\frac{1}{2} m_i u^2 + T_e \\ln n = \\text{constant}\n$$\nThis expression is a form of Bernoulli's equation for the isothermal plasma flow, stating that the sum of the ion kinetic energy and the work done by the electron pressure is conserved along a streamline.\n\n**2. Derivation of the Sheath Entrance Density, $n_s$**\n\nThe derived invariant holds for any two points in the flow domain. We apply this relation between an upstream location, denoted by subscript $0$, and the sheath entrance, denoted by subscript $s$.\n$$\n\\frac{1}{2} m_i u_0^2 + T_e \\ln n_0 = \\frac{1}{2} m_i u_s^2 + T_e \\ln n_s\n$$\nThe problem specifies the following conditions:\n- The upstream ion flow is characterized by a Mach number $M_0 = u_0 / c_s$, so $u_0 = M_0 c_s$.\n- The flow at the sheath entrance satisfies the Bohm criterion with equality: $u_s = c_s$.\n- The ion sound speed is $c_s = \\sqrt{T_e/m_i}$.\n\nSubstituting these into the invariant equation:\n$$\n\\frac{1}{2} m_i (M_0 c_s)^2 + T_e \\ln n_0 = \\frac{1}{2} m_i c_s^2 + T_e \\ln n_s\n$$\nNow, we substitute the expression for the sound speed squared, $c_s^2 = T_e/m_i$:\n$$\n\\frac{1}{2} m_i M_0^2 \\left(\\frac{T_e}{m_i}\\right) + T_e \\ln n_0 = \\frac{1}{2} m_i \\left(\\frac{T_e}{m_i}\\right) + T_e \\ln n_s\n$$\nSimplifying the terms, we get:\n$$\n\\frac{1}{2} M_0^2 T_e + T_e \\ln n_0 = \\frac{1}{2} T_e + T_e \\ln n_s\n$$\nSince the electron temperature $T_e$ must be positive for a physical plasma, we can divide the entire equation by $T_e$:\n$$\n\\frac{1}{2} M_0^2 + \\ln n_0 = \\frac{1}{2} + \\ln n_s\n$$\nTo solve for $n_s$, we rearrange the equation to isolate the logarithmic terms:\n$$\n\\ln n_s - \\ln n_0 = \\frac{1}{2} M_0^2 - \\frac{1}{2}\n$$\nUsing the property of logarithms, $\\ln a - \\ln b = \\ln(a/b)$:\n$$\n\\ln \\left( \\frac{n_s}{n_0} \\right) = \\frac{1}{2} \\left( M_0^2 - 1 \\right)\n$$\nFinally, exponentiating both sides gives the expression for the density at the sheath entrance, $n_s$:\n$$\nn_s = n_0 \\exp\\left( \\frac{1}{2} \\left( M_0^2 - 1 \\right) \\right)\n$$\nThis derivation is complete and confirms the provided formula.\n\n**3. Benchmark Fluxes and Error Metrics**\n\nWith the expression for $n_s$, we can define the benchmark fluxes.\n- The particle flux, $\\Gamma$, is defined by mass conservation as $\\Gamma = n u$. At the sheath entrance, $n=n_s$ and $u=u_s=c_s$. Therefore, the benchmark particle flux is:\n  $$\n  \\Gamma^\\star = n_s c_s\n  $$\n- The parallel heat flux, $q_\\parallel$, at the sheath entrance is given by a kinetic closure model: $q_\\parallel = \\gamma n_s T_e c_s$, where $\\gamma$ is the sheath heat transmission coefficient. Thus, the benchmark heat flux is:\n  $$\n  q^\\star = \\gamma n_s T_e c_s\n  $$\nIn all computations, the electron temperature $T_e$ must be in units of Joules. The conversion from electronvolts (eV) is given by $T_e \\, [\\text{J}] = T_e \\, [\\text{eV}] \\times e$, where $e = 1.602176634 \\times 10^{-19} \\, \\text{C}$ is the elementary charge.\n\nThe error metrics comparing the numerical fluxes ($\\Gamma^{\\text{num}}, q^{\\text{num}}$) to the benchmarks ($\\Gamma^\\star, q^\\star$) are defined as:\n- Relative particle-flux error: $\\varepsilon_\\Gamma = \\frac{\\left|\\Gamma^{\\text{num}} - \\Gamma^\\star\\right|}{\\Gamma^\\star}$\n- Relative heat-flux error: $\\varepsilon_q = \\frac{\\left|q^{\\text{num}} - q^\\star\\right|}{q^\\star}$\n- Aggregate root-mean-square error: $\\varepsilon_{\\text{rms}} = \\sqrt{\\frac{\\varepsilon_\\Gamma^2 + \\varepsilon_q^2}{2}}$\n\n### Computational Procedure\n\nFor each test case, the following sequence of calculations will be performed:\n1.  Retrieve the input parameters: $m_i$, $T_e$ [eV], $n_0$, $M_0$, and $\\gamma$.\n2.  Convert the electron temperature to SI units: $T_{e, \\text{J}} = T_e \\, [\\text{eV}] \\times e$.\n3.  Calculate the ion sound speed: $c_s = \\sqrt{T_{e, \\text{J}} / m_i}$.\n4.  Calculate the sheath entrance density: $n_s = n_0 \\exp(0.5 \\times (M_0^2 - 1))$.\n5.  Calculate the benchmark particle flux: $\\Gamma^\\star = n_s c_s$.\n6.  Calculate the benchmark heat flux: $q^\\star = \\gamma n_s T_{e, \\text{J}} c_s$.\n7.  Construct the numerical fluxes, $\\Gamma^{\\text{num}}$ and $q^{\\text{num}}$, using the specified multiplicative factors for the specific test case.\n8.  Calculate the relative errors $\\varepsilon_\\Gamma$ and $\\varepsilon_q$. As the numerical values are given as $\\Gamma^{\\text{num}} = p_\\Gamma \\Gamma^\\star$ and $q^{\\text{num}} = p_q q^\\star$, where $p_\\Gamma$ and $p_q$ are the perturbation factors, the errors simplify to $\\varepsilon_\\Gamma = |p_\\Gamma - 1|$ and $\\varepsilon_q = |p_q - 1|$.\n9.  Calculate the aggregate error $\\varepsilon_{\\text{rms}}$.\n10. Collate the three error metrics for the final output.\n\nThis procedure will be implemented programmatically to process the test suite and generate the required output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes verification test error metrics for a SOL fluid code.\n\n    This function implements the derived analytic benchmarks for particle and\n    heat fluxes at the sheath entrance in an isothermal, collisionless plasma.\n    It then calculates relative and RMS errors against specified \"numerical\"\n    fluxes for a suite of test cases.\n    \"\"\"\n    # Define physical constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n\n    # Define the test suite.\n    # Each case: (m_i [kg], T_e [eV], n_0 [m^-3], M_0, gamma, pert_gamma, pert_q)\n    # pert_gamma is the factor for Gamma_num = pert_gamma * Gamma_star\n    # pert_q is the factor for q_num = pert_q * q_star\n    test_cases = [\n        # Case A: happy path, modest subsonic inflow\n        (3.345e-27, 20.0, 1.0e19, 0.10, 7.0, 1.02, 0.97),\n        # Case B: near-Bohm upstream, zero error\n        (3.345e-27, 5.0, 5.0e18, 0.95, 7.0, 1.00, 1.00),\n        # Case C: different ion species and temperature, larger discrepancies\n        (6.644657e-27, 3.0, 2.0e19, 0.50, 6.5, 0.90, 1.15),\n        # Case D: very subsonic upstream, no discrepancy\n        (3.345e-27, 100.0, 1.0e18, 0.01, 7.0, 1.00, 1.00),\n    ]\n\n    results = []\n    for case in test_cases:\n        m_i, T_e_eV, n_0, M_0, gamma, pert_gamma, pert_q = case\n\n        # 1. Convert Te to Joules\n        T_e_J = T_e_eV * E_CHARGE\n\n        # 2. Calculate ion sound speed (c_s)\n        c_s = np.sqrt(T_e_J / m_i)\n\n        # 3. Calculate sheath entrance density (n_s)\n        n_s = n_0 * np.exp(0.5 * (M_0**2 - 1.0))\n\n        # 4. Calculate benchmark fluxes (Gamma_star, q_star)\n        # These calculations are part of the required procedure, even if the\n        # errors can be computed directly from the perturbation factors.\n        gamma_star = n_s * c_s\n        q_star = gamma * n_s * T_e_J * c_s\n\n        # 5. Construct \"numerical\" fluxes\n        gamma_num = pert_gamma * gamma_star\n        q_num = pert_q * q_star\n\n        # 6. Calculate relative errors (epsilon_gamma, epsilon_q)\n        # This simplifies to abs(perturbation factor - 1)\n        err_gamma = np.abs(gamma_num - gamma_star) / gamma_star\n        err_q = np.abs(q_num - q_star) / q_star\n\n        # 7. Calculate aggregate RMS error (epsilon_rms)\n        err_rms = np.sqrt((err_gamma**2 + err_q**2) / 2.0)\n\n        results.append([err_gamma, err_q, err_rms])\n\n    # Final print statement in the exact required format.\n    # The format string produces output like [[a,b,c],[d,e,f]]\n    # which matches the problem description of a list of lists.\n    # Python's default str(list) produces spaces after commas, as required.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}