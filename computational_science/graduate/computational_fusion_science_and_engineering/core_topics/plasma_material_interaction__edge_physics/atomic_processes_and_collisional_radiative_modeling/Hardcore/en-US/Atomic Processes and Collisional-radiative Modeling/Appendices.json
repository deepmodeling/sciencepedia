{
    "hands_on_practices": [
        {
            "introduction": "In plasma spectroscopy, the intensity of a spectral line provides information about the plasma conditions. However, interpreting this intensity requires understanding all pathways that populate the line's upper atomic level. This exercise demonstrates how to derive an effective photon emissivity coefficient ($ \\mathrm{PEC} $) by accounting not only for direct electron-impact excitation but also for the crucial contribution from radiative cascades from higher energy levels, a fundamental skill for building accurate diagnostic models .",
            "id": "3952271",
            "problem": "In a low-density edge plasma of a fusion device, consider a three-level atomic system with a ground state labeled $1$ and two excited states labeled $2$ and $3$. Electron-impact excitation from the ground populates levels $2$ and $3$ with Maxwellian-averaged excitation rate coefficients $q_{12}$ and $q_{13}$, respectively (units: $\\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$). The only radiative decays are spontaneous emissions with Einstein coefficients $A_{21}$, $A_{31}$, and $A_{32}$ (units: $\\mathrm{s}^{-1}$), corresponding to $2 \\to 1$, $3 \\to 1$, and $3 \\to 2$. Assume there are no other radiative channels. Assume the electron density $n_{e}$ is sufficiently low that collisional de-excitation from levels $2$ and $3$ is negligible, and that there is no collisional coupling between excited levels, no radiation trapping, and $n_{2}, n_{3} \\ll n_{1}$ (coronal limit). Work in steady state.\n\nStarting only from particle balance (rate) equations and the definitions of spontaneous emission and electron-impact excitation, derive an expression for the effective photon emissivity coefficient for the $2 \\to 1$ line, denoted $\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}}$, defined as the photon production rate in the $2 \\to 1$ line per unit $n_{e} n_{1}$ (units: photons $\\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$). Your derivation must explicitly capture how branching ratios and radiative cascades via level $3$ alter the apparent excitation rate for the $2 \\to 1$ line.\n\nThen evaluate your expression for the following parameter values:\n- $A_{21} = 5.0 \\times 10^{8}\\ \\mathrm{s}^{-1}$,\n- $A_{31} = 2.0 \\times 10^{8}\\ \\mathrm{s}^{-1}$,\n- $A_{32} = 8.0 \\times 10^{8}\\ \\mathrm{s}^{-1}$,\n- $q_{12} = 3.0 \\times 10^{-8}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$,\n- $q_{13} = 1.0 \\times 10^{-8}\\ \\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$.\n\nReport the final numerical value of $\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}}$ in photons $\\mathrm{cm}^{3}\\ \\mathrm{s}^{-1}$, rounded to three significant figures.",
            "solution": "The problem is first subjected to validation.\n\n### Step 1: Extract Givens\n-   **System:** A three-level atomic system with ground state $1$ and excited states $2$ and $3$.\n-   **Processes:**\n    -   Electron-impact excitation: $1 \\to 2$ with rate coefficient $q_{12}$ and $1 \\to 3$ with rate coefficient $q_{13}$.\n    -   Spontaneous radiative decay: $2 \\to 1$ with Einstein coefficient $A_{21}$, $3 \\to 1$ with $A_{31}$, and $3 \\to 2$ with $A_{32}$.\n-   **Assumptions and Conditions:**\n    -   Low-density edge plasma of a fusion device.\n    -   Maxwellian-averaged excitation rate coefficients.\n    -   No other radiative channels are present.\n    -   Electron density $n_e$ is sufficiently low that collisional de-excitation from levels $2$ and $3$ is negligible.\n    -   No collisional coupling between excited levels.\n    -   No radiation trapping.\n    -   $n_2, n_3 \\ll n_1$ (coronal limit).\n    -   System is in steady state.\n-   **Definition:** The effective photon emissivity coefficient for the $2 \\to 1$ line is defined as $\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}} = \\frac{\\text{photon production rate in } 2 \\to 1 \\text{ line}}{n_e n_1}$.\n-   **Numerical Values:**\n    -   $A_{21} = 5.0 \\times 10^8\\ \\mathrm{s}^{-1}$\n    -   $A_{31} = 2.0 \\times 10^8\\ \\mathrm{s}^{-1}$\n    -   $A_{32} = 8.0 \\times 10^8\\ \\mathrm{s}^{-1}$\n    -   $q_{12} = 3.0 \\times 10^{-8}\\ \\mathrm{cm}^3\\ \\mathrm{s}^{-1}$\n    -   $q_{13} = 1.0 \\times 10^{-8}\\ \\mathrm{cm}^3\\ \\mathrm{s}^{-1}$\n-   **Required Output:** An expression for $\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}}$ and its numerical value rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, representing a standard collisional-radiative model in the coronal limit, a common scenario in plasma physics and astrophysics. The assumptions are clearly stated and physically justified for the specified low-density plasma environment. The problem is well-posed, providing all necessary atomic data and constraints (steady state, negligible collisions for excited states) to determine a unique solution. The definitions and terminology are precise and objective. There are no internal contradictions or missing information.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be formulated.\n\nThe core of the problem is to determine the steady-state populations of the excited levels, $n_2$ and $n_3$, by writing and solving the particle balance (rate) equations.\n\nThe rate equation for a given atomic level $i$ in steady state is expressed as:\n$$\n\\frac{dn_i}{dt} = \\sum (\\text{Population fluxes into level } i) - \\sum (\\text{Population fluxes out of level } i) = 0\n$$\n\nLet us write the rate equations for the two excited states, $n_2$ and $n_3$, under the given assumptions.\n\nFor excited state $3$, the population processes are:\n-   Population source: Electron-impact excitation from the ground state ($1 \\to 3$). The rate is $n_e n_1 q_{13}$.\n-   Population sinks: Spontaneous radiative decay to level $1$ ($3 \\to 1$) and to level $2$ ($3 \\to 2$). The rates are $n_3 A_{31}$ and $n_3 A_{32}$, respectively.\n\nUnder the steady-state assumption, $\\frac{dn_3}{dt}=0$, so the population and depopulation rates must balance:\n$$\nn_e n_1 q_{13} - n_3 A_{31} - n_3 A_{32} = 0\n$$\n$$\nn_e n_1 q_{13} = n_3 (A_{31} + A_{32})\n$$\nSolving for the population density of level $3$, $n_3$, gives:\n$$\nn_3 = \\frac{n_e n_1 q_{13}}{A_{31} + A_{32}}\n$$\n\nFor excited state $2$, the population processes are:\n-   Population sources:\n    1.  Direct electron-impact excitation from the ground state ($1 \\to 2$). The rate is $n_e n_1 q_{12}$.\n    2.  Radiative cascade from level $3$ ($3 \\to 2$). The rate is $n_3 A_{32}$.\n-   Population sink: Spontaneous radiative decay to level $1$ ($2 \\to 1$). The rate is $n_2 A_{21}$.\n\nIn steady state, $\\frac{dn_2}{dt}=0$, so the balance equation is:\n$$\nn_e n_1 q_{12} + n_3 A_{32} - n_2 A_{21} = 0\n$$\nTo find $n_2$, we substitute the previously derived expression for $n_3$:\n$$\nn_e n_1 q_{12} + \\left( \\frac{n_e n_1 q_{13}}{A_{31} + A_{32}} \\right) A_{32} = n_2 A_{21}\n$$\nWe can solve this equation for $n_2$:\n$$\nn_2 = \\frac{1}{A_{21}} \\left( n_e n_1 q_{12} + n_e n_1 q_{13} \\frac{A_{32}}{A_{31} + A_{32}} \\right)\n$$\n$$\nn_2 = \\frac{n_e n_1}{A_{21}} \\left( q_{12} + q_{13} \\frac{A_{32}}{A_{31} + A_{32}} \\right)\n$$\n\nThe problem asks for the effective photon emissivity coefficient for the $2 \\to 1$ line, $\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}}$. This is defined as the photon production rate of the $2 \\to 1$ transition per unit electron density $n_e$ and ground state density $n_1$. The photon production rate (emissivity) for the $2 \\to 1$ transition, $\\mathcal{E}_{21}$, is given by the product of the population density of the upper level, $n_2$, and the spontaneous emission coefficient for that transition, $A_{21}$.\n$$\n\\mathcal{E}_{21} = n_2 A_{21} \\quad (\\text{units: photons } \\mathrm{cm}^{-3}\\ \\mathrm{s}^{-1})\n$$\nBy definition,\n$$\n\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}} = \\frac{\\mathcal{E}_{21}}{n_e n_1} = \\frac{n_2 A_{21}}{n_e n_1}\n$$\nSubstituting our expression for $n_2$ into this definition:\n$$\n\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}} = \\frac{1}{n_e n_1} \\left[ \\frac{n_e n_1}{A_{21}} \\left( q_{12} + q_{13} \\frac{A_{32}}{A_{31} + A_{32}} \\right) \\right] A_{21}\n$$\nSimplifying the expression yields the final analytical form for $\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}}$:\n$$\n\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}} = q_{12} + q_{13} \\left( \\frac{A_{32}}{A_{31} + A_{32}} \\right)\n$$\nThis expression explicitly shows how the apparent excitation rate for the $2 \\to 1$ line is the sum of the direct excitation rate coefficient, $q_{12}$, and a cascade contribution. The cascade term is the excitation rate coefficient to the higher level, $q_{13}$, multiplied by the radiative branching ratio, $B_{32} = \\frac{A_{32}}{A_{31} + A_{32}}$, which represents the fraction of decays from level $3$ that terminate in level $2$.\n\nNow, we evaluate this expression using the provided numerical values:\n-   $q_{12} = 3.0 \\times 10^{-8}\\ \\mathrm{cm}^3\\ \\mathrm{s}^{-1}$\n-   $q_{13} = 1.0 \\times 10^{-8}\\ \\mathrm{cm}^3\\ \\mathrm{s}^{-1}$\n-   $A_{31} = 2.0 \\times 10^8\\ \\mathrm{s}^{-1}$\n-   $A_{32} = 8.0 \\times 10^8\\ \\mathrm{s}^{-1}$\n\nFirst, calculate the branching ratio for the $3 \\to 2$ decay:\n$$\n\\frac{A_{32}}{A_{31} + A_{32}} = \\frac{8.0 \\times 10^8}{2.0 \\times 10^8 + 8.0 \\times 10^8} = \\frac{8.0 \\times 10^8}{10.0 \\times 10^8} = 0.8\n$$\nNow, substitute this value into the expression for $\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}}$:\n$$\n\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}} = (3.0 \\times 10^{-8}) + (1.0 \\times 10^{-8}) \\times (0.8)\n$$\n$$\n\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}} = 3.0 \\times 10^{-8} + 0.8 \\times 10^{-8}\n$$\n$$\n\\mathrm{PEC}_{2 \\to 1}^{\\mathrm{eff}} = 3.8 \\times 10^{-8}\\ \\mathrm{photons\\ cm}^3\\ \\mathrm{s}^{-1}\n$$\nRounding to three significant figures as required, the value is $3.80 \\times 10^{-8}$.",
            "answer": "$$\n\\boxed{3.80 \\times 10^{-8}}\n$$"
        },
        {
            "introduction": "A primary goal of collisional-radiative (CR) modeling is to accurately predict the ionization balance in a plasma, which governs its overall behavior. While direct ionization from the ground state is one pathway, a multi-step process known as stepwise ionization—where an atom is first excited and then ionized—can often be the dominant channel. This practice problem guides you through the derivation of an effective ionization rate that includes this critical stepwise pathway, highlighting a key advantage of CR models over simpler approximations .",
            "id": "3952324",
            "problem": "A single neutral species $X$ in a low-temperature fusion edge plasma is modeled using a minimal Collisional–Radiative (CR) description with two bound levels and the continuum: a ground state $g$, one excited state $e$, and an ionized state $X^{+}$. Electrons of number density $n_e$ collide with $X$ and induce the following binary processes characterized by rate coefficients: electron-impact excitation $g \\to e$ with coefficient $K_{ge}$, electron-impact de-excitation $e \\to g$ with coefficient $K_{eg}$, electron-impact ionization from the ground $g \\to X^{+}$ with coefficient $S_g$, and electron-impact ionization from the excited state $e \\to X^{+}$ with coefficient $S_e$. The excited state also decays radiatively $e \\to g$ with spontaneous rate $A_{eg}$. Assume a uniform electron temperature such that the given rate coefficients are valid, a low degree of ionization so that $n_{X,g}$ dominates the neutral density, and a quasi-steady-state for the excited state population $n_{X,e}$.\n\nStarting from particle balance principles for level populations and the definition of rate coefficients for binary collisions, derive an analytical expression for the effective ionization rate coefficient $k_{\\mathrm{eff}}$ that multiplies $n_e n_{X,g}$ to give the total volumetric ionization rate of $X$ by electrons when the stepwise path via the excited state is included. Then evaluate $k_{\\mathrm{eff}}$ for the following scientifically plausible parameter set:\n- Electron number density $n_e = 3.0 \\times 10^{19} \\, \\mathrm{m}^{-3}$,\n- Excitation coefficient $K_{ge} = 2.5 \\times 10^{-15} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$,\n- De-excitation coefficient $K_{eg} = 3.0 \\times 10^{-15} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$,\n- Spontaneous decay rate $A_{eg} = 5.0 \\times 10^{2} \\, \\mathrm{s}^{-1}$,\n- Ground-state ionization coefficient $S_g = 1.2 \\times 10^{-16} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$,\n- Excited-state ionization coefficient $S_e = 7.0 \\times 10^{-15} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$.\n\nExpress the final $k_{\\mathrm{eff}}$ in $\\mathrm{m}^{3}\\mathrm{s}^{-1}$ and round your answer to four significant figures.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of atomic physics and plasma modeling, is well-posed with a clear objective and sufficient data, and is expressed in objective, formal language. It presents a standard problem in collisional-radiative modeling without any scientific flaws, logical contradictions, or ambiguities.\n\nThe total volumetric ionization rate of the neutral species $X$, denoted $R_{\\mathrm{ion,tot}}$, is the sum of the ionization rates from the ground state $g$ and the excited state $e$. These rates are determined by binary collisions with electrons. The rate of a binary process is given by the product of the number densities of the reacting species and the corresponding rate coefficient.\n\nThe rate of ionization from the ground state is:\n$$R_{g \\to X^+} = n_{X,g} n_e S_g$$\nwhere $n_{X,g}$ is the number density of species $X$ in the ground state, $n_e$ is the electron number density, and $S_g$ is the electron-impact ionization rate coefficient from the ground state.\n\nThe rate of ionization from the excited state is:\n$$R_{e \\to X^+} = n_{X,e} n_e S_e$$\nwhere $n_{X,e}$ is the number density of species $X$ in the excited state and $S_e$ is the electron-impact ionization rate coefficient from the excited state.\n\nThe total ionization rate is the sum of these two contributions:\n$$R_{\\mathrm{ion,tot}} = R_{g \\to X^+} + R_{e \\to X^+} = n_{X,g} n_e S_g + n_{X,e} n_e S_e$$\nThe problem defines an effective ionization rate coefficient, $k_{\\mathrm{eff}}$, such that the total ionization rate can be expressed as:\n$$R_{\\mathrm{ion,tot}} = k_{\\mathrm{eff}} n_e n_{X,g}$$\nEquating the two expressions for $R_{\\mathrm{ion,tot}}$ yields:\n$$k_{\\mathrm{eff}} n_e n_{X,g} = n_{X,g} n_e S_g + n_{X,e} n_e S_e$$\nDividing by $n_e n_{X,g}$ (assuming $n_e \\neq 0$ and $n_{X,g} \\neq 0$), we obtain an expression for $k_{\\mathrm{eff}}$:\n$$k_{\\mathrm{eff}} = S_g + \\frac{n_{X,e}}{n_{X,g}} S_e$$\nThis equation shows that the effective ionization rate coefficient is the sum of the direct ionization coefficient from the ground state and a contribution from the stepwise ionization path ($g \\to e \\to X^+$), which depends on the population ratio of the excited state to the ground state, $\\frac{n_{X,e}}{n_{X,g}}$.\n\nTo determine this population ratio, we apply the quasi-steady-state (QSS) assumption for the excited state population $n_{X,e}$. This assumption, $\\frac{dn_{X,e}}{dt} = 0$, implies that the total rate of processes populating the excited state is equal to the total rate of processes depopulating it.\n\nThe processes populating state $e$ are:\n1.  Electron-impact excitation from the ground state ($g \\to e$): Rate is $n_{X,g} n_e K_{ge}$.\n\nThe processes depopulating state $e$ are:\n1.  Electron-impact de-excitation to the ground state ($e \\to g$): Rate is $n_{X,e} n_e K_{eg}$.\n2.  Spontaneous radiative decay to the ground state ($e \\to g$): Rate is $n_{X,e} A_{eg}$.\n3.  Electron-impact ionization from the excited state ($e \\to X^{+}$): Rate is $n_{X,e} n_e S_e$.\n\nThe QSS balance equation is therefore:\n$$n_{X,g} n_e K_{ge} = n_{X,e} n_e K_{eg} + n_{X,e} A_{eg} + n_{X,e} n_e S_e$$\nFactoring out $n_{X,e}$ on the right side gives:\n$$n_{X,g} n_e K_{ge} = n_{X,e} (n_e K_{eg} + A_{eg} + n_e S_e)$$\nWe can now solve for the population ratio $\\frac{n_{X,e}}{n_{X,g}}$:\n$$\\frac{n_{X,e}}{n_{X,g}} = \\frac{n_e K_{ge}}{n_e (K_{eg} + S_e) + A_{eg}}$$\nSubstituting this expression for the population ratio back into the equation for $k_{\\mathrm{eff}}$ provides the final analytical expression:\n$$k_{\\mathrm{eff}} = S_g + S_e \\left( \\frac{n_e K_{ge}}{n_e (K_{eg} + S_e) + A_{eg}} \\right)$$\n\nNow, we evaluate this expression using the provided numerical parameters:\n- $n_e = 3.0 \\times 10^{19} \\, \\mathrm{m}^{-3}$\n- $K_{ge} = 2.5 \\times 10^{-15} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$\n- $K_{eg} = 3.0 \\times 10^{-15} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$\n- $A_{eg} = 5.0 \\times 10^{2} \\, \\mathrm{s}^{-1}$\n- $S_g = 1.2 \\times 10^{-16} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$\n- $S_e = 7.0 \\times 10^{-15} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$\n\nFirst, calculate the terms within the expression for $k_{\\mathrm{eff}}$.\nThe numerator of the fractional part is:\n$$n_e K_{ge} = (3.0 \\times 10^{19} \\, \\mathrm{m}^{-3}) \\times (2.5 \\times 10^{-15} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}) = 7.5 \\times 10^{4} \\, \\mathrm{s}^{-1}$$\nThe denominator of the fractional part is:\n$$n_e (K_{eg} + S_e) + A_{eg} = (3.0 \\times 10^{19}) (3.0 \\times 10^{-15} + 7.0 \\times 10^{-15}) + 5.0 \\times 10^{2}$$\n$$= (3.0 \\times 10^{19}) (1.0 \\times 10^{-14}) + 5.0 \\times 10^{2}$$\n$$= 3.0 \\times 10^{5} + 5.0 \\times 10^{2} = 300000 + 500 = 300500 \\, \\mathrm{s}^{-1} = 3.005 \\times 10^{5} \\, \\mathrm{s}^{-1}$$\nNow, substitute these into the expression for $k_{\\mathrm{eff}}$:\n$$k_{\\mathrm{eff}} = 1.2 \\times 10^{-16} + (7.0 \\times 10^{-15}) \\left( \\frac{7.5 \\times 10^{4}}{3.005 \\times 10^{5}} \\right)$$\n$$k_{\\mathrm{eff}} = 1.2 \\times 10^{-16} + (7.0 \\times 10^{-15}) \\times (0.24958399...)$$\n$$k_{\\mathrm{eff}} = 1.2 \\times 10^{-16} + 1.7470879... \\times 10^{-15}$$\nTo perform the addition, we express both terms with the same power of $10$:\n$$k_{\\mathrm{eff}} = 0.12 \\times 10^{-15} + 1.7470879... \\times 10^{-15}$$\n$$k_{\\mathrm{eff}} = (0.12 + 1.7470879...) \\times 10^{-15}$$\n$$k_{\\mathrm{eff}} = 1.8670879... \\times 10^{-15} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$$\nRounding the result to four significant figures as requested:\n$$k_{\\mathrm{eff}} \\approx 1.867 \\times 10^{-15} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$$\nIt is noted that the direct ionization coefficient is $S_g = 1.2 \\times 10^{-16} \\, \\mathrm{m}^{3}\\mathrm{s}^{-1}$, whereas the effective coefficient $k_{\\mathrm{eff}}$ is more than an order of magnitude larger. This highlights the critical role of stepwise ionization through excited states in determining the overall ionization balance in many plasmas.",
            "answer": "$$\\boxed{1.867 \\times 10^{-15}}$$"
        },
        {
            "introduction": "The rate equations that form a collisional-radiative model constitute a system of ordinary differential equations (ODEs). These systems are notoriously \"stiff\" due to the vast disparity in timescales between fast radiative decays and slower collisional processes, posing a significant challenge for numerical solvers. This computational exercise provides hands-on practice implementing a backward Euler scheme, an implicit method ideal for stiff systems, and analyzing its stability and accuracy for a representative CR model .",
            "id": "3952265",
            "problem": "Consider a linear, time-invariant collisional-radiative population model for a three-state system representative of atomic processes in fusion plasmas. Let the population density vector be $\\mathbf{n}(t) = [n_1(t), n_2(t), n_3(t)]^\\top$ in units of $\\mathrm{m}^{-3}$, where state $1$ is the ground state of a neutral atom, state $2$ is an excited bound state, and state $3$ represents the ionized state. The evolution of $\\mathbf{n}(t)$ is given by the linear ordinary differential equation $\\dfrac{d\\mathbf{n}}{dt} = \\mathbf{R}\\,\\mathbf{n}$, where $\\mathbf{R}$ is the rate matrix constructed from physically plausible collisional and radiative rates. Assume a spatially uniform electron density $n_e$ with value $n_e = 1.0\\times 10^{19}\\ \\mathrm{m}^{-3}$, and the following rate coefficients:\n- Collisional excitation coefficient $k_{12} = 2\\times 10^{-14}\\ \\mathrm{m}^3/\\mathrm{s}$,\n- Collisional de-excitation coefficient $k_{21} = 1\\times 10^{-13}\\ \\mathrm{m}^3/\\mathrm{s}$,\n- Spontaneous radiative decay rate $A_{21} = 5\\times 10^{7}\\ \\mathrm{s}^{-1}$,\n- Collisional ionization coefficients $k_{13} = 3\\times 10^{-14}\\ \\mathrm{m}^3/\\mathrm{s}$ and $k_{23} = 1\\times 10^{-13}\\ \\mathrm{m}^3/\\mathrm{s}$,\n- Recombination coefficient $\\alpha_{31} = 5\\times 10^{-19}\\ \\mathrm{m}^3/\\mathrm{s}$.\n\nDefine the corresponding rates (in $\\mathrm{s}^{-1}$) as $C_{12} = k_{12}\\,n_e$, $C_{21} = k_{21}\\,n_e$, $S_{13} = k_{13}\\,n_e$, $S_{23} = k_{23}\\,n_e$, and $\\alpha_{31}^\\mathrm{(rate)} = \\alpha_{31}\\,n_e$. Using mass-action balancing for transitions, construct the rate matrix $\\mathbf{R}$ with rows\n$$\n\\left[\n- (C_{12} + S_{13}),\\quad (C_{21} + A_{21}),\\quad \\alpha_{31}^\\mathrm{(rate)}\n\\right],\n$$\n$$\n\\left[\nC_{12},\\quad - (C_{21} + A_{21} + S_{23}),\\quad 0\n\\right],\n$$\n$$\n\\left[\nS_{13},\\quad S_{23},\\quad - \\alpha_{31}^\\mathrm{(rate)}\n\\right].\n$$\nLet the initial condition be $\\mathbf{n}(0)=\\mathbf{n}_0=[1\\times 10^{16},\\,0,\\,0]^\\top\\ \\mathrm{m}^{-3}$. Using the fundamental definition of the backward Euler implicit time discretization derived from the governing ordinary differential equation, implement a time-stepping algorithm that advances the solution $\\mathbf{n}(t)$ over steps of size $\\Delta t$ (in $\\mathrm{s}$). At each step, the algorithm must solve the linear system implied by the backward Euler method for this autonomous linear system.\n\nYour program must also compute:\n- The one-step amplification matrix $\\mathbf{G}$ associated with the implemented backward Euler method for the linear system, and its spectral radius $\\rho(\\mathbf{G})$ (dimensionless).\n- The global error at final time $T = N\\,\\Delta t$, defined as the Euclidean norm $\\|\\mathbf{n}_\\mathrm{num}(T)-\\mathbf{n}_\\mathrm{exact}(T)\\|_2$, where $\\mathbf{n}_\\mathrm{num}(T)$ is the numerical solution after $N$ backward Euler steps and $\\mathbf{n}_\\mathrm{exact}(T)=\\exp(\\mathbf{R}\\,T)\\,\\mathbf{n}_0$ is the exact solution obtained via the matrix exponential. Express the global error in units of $\\mathrm{m}^{-3}$.\n\nYou must implement the above and run it on the following test suite, each test case being a tuple $(\\Delta t,\\ N)$ with $\\Delta t$ in $\\mathrm{s}$ and $N$ as a nonnegative integer:\n- Test $1$: $(\\Delta t, N) = (1\\times 10^{-9},\\ 1000)$, so $T = 1\\times 10^{-6}\\ \\mathrm{s}$,\n- Test $2$: $(\\Delta t, N) = (1\\times 10^{-7},\\ 1000)$, so $T = 1\\times 10^{-4}\\ \\mathrm{s}$,\n- Test $3$: $(\\Delta t, N) = (5\\times 10^{-6},\\ 1000)$, so $T = 5\\times 10^{-3}\\ \\mathrm{s}$,\n- Test $4$: $(\\Delta t, N) = (0,\\ 1)$, so $T = 0\\ \\mathrm{s}$ representing the boundary case of zero time-step.\n\nFor each test case, compute and return a list of two floats $[\\rho(\\mathbf{G}),\\ \\|\\mathbf{n}_\\mathrm{num}(T)-\\mathbf{n}_\\mathrm{exact}(T)\\|_2]$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases above. For example, your output must look like $[[r_1,e_1],[r_2,e_2],[r_3,e_3],[r_4,e_4]]$, where each $r_i$ is the spectral radius and each $e_i$ is the global error in $\\mathrm{m}^{-3}$.",
            "solution": "The problem requires the analysis of a three-state collisional-radiative model for atomic populations in a fusion plasma using the backward Euler numerical method. The task involves constructing the rate matrix, implementing the time-stepping algorithm, and evaluating its performance against an exact solution for several test cases.\n\n### 1. Model Formulation and Rate Matrix Construction\n\nThe evolution of the population densities for the three states, $\\mathbf{n}(t) = [n_1(t), n_2(t), n_3(t)]^\\top$, is governed by the linear system of ordinary differential equations (ODEs):\n$$\n\\frac{d\\mathbf{n}}{dt} = \\mathbf{R}\\,\\mathbf{n}(t)\n$$\nwhere $\\mathbf{R}$ is the $3 \\times 3$ rate matrix. The elements of $\\mathbf{R}$ are determined by the rates of the physical processes that transfer population between the states. The rates are calculated from the given rate coefficients and the constant electron density $n_e = 1.0 \\times 10^{19}\\ \\mathrm{m}^{-3}$.\n\nThe rates (in units of $\\mathrm{s}^{-1}$) are:\n- Collisional excitation rate ($1 \\to 2$): $C_{12} = k_{12}\\,n_e = (2\\times 10^{-14}\\ \\mathrm{m}^3/\\mathrm{s})(1.0\\times 10^{19}\\ \\mathrm{m}^{-3}) = 2\\times 10^{5}\\ \\mathrm{s}^{-1}$.\n- Collisional de-excitation rate ($2 \\to 1$): $C_{21} = k_{21}\\,n_e = (1\\times 10^{-13}\\ \\mathrm{m}^3/\\mathrm{s})(1.0\\times 10^{19}\\ \\mathrm{m}^{-3}) = 1\\times 10^{6}\\ \\mathrm{s}^{-1}$.\n- Spontaneous radiative decay rate ($2 \\to 1$): $A_{21} = 5\\times 10^{7}\\ \\mathrm{s}^{-1}$.\n- Collisional ionization rate from ground ($1 \\to 3$): $S_{13} = k_{13}\\,n_e = (3\\times 10^{-14}\\ \\mathrm{m}^3/\\mathrm{s})(1.0\\times 10^{19}\\ \\mathrm{m}^{-3}) = 3\\times 10^{5}\\ \\mathrm{s}^{-1}$.\n- Collisional ionization rate from excited ($2 \\to 3$): $S_{23} = k_{23}\\,n_e = (1\\times 10^{-13}\\ \\mathrm{m}^3/\\mathrm{s})(1.0\\times 10^{19}\\ \\mathrm{m}^{-3}) = 1\\times 10^{6}\\ \\mathrm{s}^{-1}$.\n- Recombination rate ($3 \\to 1$): $\\alpha_{31}^\\mathrm{(rate)} = \\alpha_{31}\\,n_e = (5\\times 10^{-19}\\ \\mathrm{m}^3/\\mathrm{s})(1.0\\times 10^{19}\\ \\mathrm{m}^{-3}) = 5\\ \\mathrm{s}^{-1}$.\n\nThe rate matrix $\\mathbf{R}$ is constructed by applying the principle of particle conservation for each state $i$:\n$$\n\\frac{dn_i}{dt} = \\sum_{j \\neq i} (\\text{rate of } j \\to i) - n_i \\sum_{j \\neq i} (\\text{rate of } i \\to j)\n$$\nFollowing the structure provided in the problem statement, which is consistent with this principle, we assemble the matrix.\nThe rate of change for each population density is:\n- $\\frac{dn_1}{dt} = (C_{21} + A_{21})n_2 + \\alpha_{31}^\\mathrm{(rate)}n_3 - (C_{12} + S_{13})n_1$\n- $\\frac{dn_2}{dt} = C_{12}n_1 - (C_{21} + A_{21} + S_{23})n_2$\n- $\\frac{dn_3}{dt} = S_{13}n_1 + S_{23}n_2 - \\alpha_{31}^\\mathrm{(rate)}n_3$\n\nThis corresponds to the rate matrix $\\mathbf{R}$:\n$$\n\\mathbf{R} = \\begin{pmatrix}\n-(C_{12} + S_{13})  C_{21} + A_{21}  \\alpha_{31}^\\mathrm{(rate)} \\\\\nC_{12}  -(C_{21} + A_{21} + S_{23})  0 \\\\\nS_{13}  S_{23}  -\\alpha_{31}^\\mathrm{(rate)}\n\\end{pmatrix}\n$$\nSubstituting the calculated values:\n$$\n\\mathbf{R} = \\begin{pmatrix}\n-(2\\times 10^5 + 3\\times 10^5)  1\\times 10^6 + 5\\times 10^7  5 \\\\\n2\\times 10^5  -(1\\times 10^6 + 5\\times 10^7 + 1\\times 10^6)  0 \\\\\n3\\times 10^5  1\\times 10^6  -5\n\\end{pmatrix}\n= \\begin{pmatrix}\n-5.0 \\times 10^5  5.1 \\times 10^7  5.0 \\\\\n2.0 \\times 10^5  -5.2 \\times 10^7  0.0 \\\\\n3.0 \\times 10^5  1.0 \\times 10^6  -5.0\n\\end{pmatrix} \\ \\mathrm{s}^{-1}\n$$\n\n### 2. Numerical Integration with Backward Euler\n\nThe backward Euler method is an implicit, first-order accurate numerical scheme for solving ODEs. For a time step $\\Delta t$, it approximates the time derivative at step $k+1$ as:\n$$\n\\frac{\\mathbf{n}_{k+1} - \\mathbf{n}_k}{\\Delta t} = \\mathbf{R}\\,\\mathbf{n}_{k+1}\n$$\nwhere $\\mathbf{n}_k \\approx \\mathbf{n}(t_k)$ and $\\mathbf{n}_{k+1} \\approx \\mathbf{n}(t_{k+1})$. To find the solution at the next time step, $\\mathbf{n}_{k+1}$, we must solve a linear system:\n$$\n\\mathbf{n}_{k+1} - \\Delta t \\mathbf{R}\\,\\mathbf{n}_{k+1} = \\mathbf{n}_k\n$$\n$$\n(\\mathbf{I} - \\Delta t \\mathbf{R})\\,\\mathbf{n}_{k+1} = \\mathbf{n}_k\n$$\nwhere $\\mathbf{I}$ is the $3 \\times 3$ identity matrix. The solution is obtained by inverting the matrix $(\\mathbf{I} - \\Delta t \\mathbf{R})$:\n$$\n\\mathbf{n}_{k+1} = (\\mathbf{I} - \\Delta t \\mathbf{R})^{-1} \\mathbf{n}_k\n$$\nThe matrix $\\mathbf{G} = (\\mathbf{I} - \\Delta t \\mathbf{R})^{-1}$ is the one-step amplification matrix. The numerical solution after $N$ steps is $\\mathbf{n}_{\\text{num}}(T) = \\mathbf{G}^N \\mathbf{n}_0$, where $T = N \\Delta t$ and $\\mathbf{n}_0$ is the initial condition $\\mathbf{n}(0)=[1\\times 10^{16},\\,0,\\,0]^\\top\\ \\mathrm{m}^{-3}$.\n\n### 3. Quantities for Evaluation\n\nThe problem requires the calculation of two specific quantities for each test case:\n1.  **Spectral Radius $\\rho(\\mathbf{G})$**: The spectral radius of the amplification matrix $\\mathbf{G}$ is defined as the maximum of the absolute values of its eigenvalues $\\lambda_i$: $\\rho(\\mathbf{G}) = \\max_i |\\lambda_i|$. For the backward Euler method applied to a stiff system like this one, the spectral radius indicates stability; unconditional stability implies $\\rho(\\mathbf{G}) \\leq 1$ for any $\\Delta t  0$. We compute the eigenvalues of $\\mathbf{G}$ and find the one with the largest magnitude.\n\n2.  **Global Error**: The global error measures the deviation of the numerical solution from the exact solution at the final time $T$. The exact solution to the linear autonomous system is given by the matrix exponential:\n    $$\n    \\mathbf{n}_{\\text{exact}}(T) = \\exp(\\mathbf{R}T)\\,\\mathbf{n}_0\n    $$\n    The global error is then computed as the Euclidean norm of the difference vector:\n    $$\n    E(T) = \\|\\mathbf{n}_{\\text{num}}(T) - \\mathbf{n}_{\\text{exact}}(T)\\|_2 = \\sqrt{\\sum_{i=1}^{3} (n_{i, \\text{num}}(T) - n_{i, \\text{exact}}(T))^2}\n    $$\n\n### 4. Special Case: $\\Delta t = 0$\n\nFor the test case $(\\Delta t, N) = (0, 1)$, we have $T = 0 \\ \\mathrm{s}$.\n- The amplification matrix becomes $\\mathbf{G} = (\\mathbf{I} - 0 \\cdot \\mathbf{R})^{-1} = \\mathbf{I}^{-1} = \\mathbf{I}$.\n- The eigenvalues of the identity matrix are all $1$, so its spectral radius is $\\rho(\\mathbf{G}) = 1$.\n- The numerical solution after one step of zero length is $\\mathbf{n}_{\\text{num}}(0) = \\mathbf{G} \\mathbf{n}_0 = \\mathbf{I} \\mathbf{n}_0 = \\mathbf{n}_0$.\n- The exact solution at $T=0$ is $\\mathbf{n}_{\\text{exact}}(0) = \\exp(\\mathbf{R} \\cdot 0) \\mathbf{n}_0 = \\exp(\\mathbf{0}) \\mathbf{n}_0 = \\mathbf{I} \\mathbf{n}_0 = \\mathbf{n}_0$.\n- The global error is $\\|\\mathbf{n}_0 - \\mathbf{n}_0\\|_2 = 0$.\nThus, for this boundary case, the result is $[\\rho(\\mathbf{G}), \\text{Error}] = [1.0, 0.0]$. The implementation will handle this case explicitly.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves the collisional-radiative model problem using the backward Euler method.\n    \"\"\"\n    # Define physical constants and initial conditions\n    n_e = 1.0e19  # Electron density in m^-3\n    \n    # Rate coefficients in m^3/s\n    k12 = 2e-14  # Collisional excitation 1->2\n    k21 = 1e-13  # Collisional de-excitation 2->1\n    k13 = 3e-14  # Collisional ionization 1->3\n    k23 = 1e-13  # Collisional ionization 2->3\n    alpha31 = 5e-19  # Recombination 3->1\n    \n    # Radiative rates in s^-1\n    A21 = 5e7  # Spontaneous decay 2->1\n\n    # Initial population density vector in m^-3\n    n0 = np.array([1.0e16, 0.0, 0.0])\n\n    # Calculate rates in s^-1\n    C12 = k12 * n_e\n    C21 = k21 * n_e\n    S13 = k13 * n_e\n    S23 = k23 * n_e\n    alpha31_rate = alpha31 * n_e\n\n    # Construct the rate matrix R (3x3)\n    R = np.array([\n        [-(C12 + S13), C21 + A21, alpha31_rate],\n        [C12, -(C21 + A21 + S23), 0],\n        [S13, S23, -alpha31_rate]\n    ])\n\n    # Define the test cases (dt in s, N as integer)\n    test_cases = [\n        (1e-9, 1000),\n        (1e-7, 1000),\n        (5e-6, 1000),\n        (0.0, 1),\n    ]\n\n    results = []\n    \n    I = np.identity(3)\n\n    for dt, N in test_cases:\n        \n        # Handle the special case where dt = 0\n        if dt == 0:\n            rho_G = 1.0\n            global_error = 0.0\n            results.append([rho_G, global_error])\n            continue\n            \n        # Final time T\n        T = N * dt\n\n        # --- Numerical Solution using Backward Euler ---\n        # 1. Compute the one-step amplification matrix G = (I - dt*R)^-1\n        try:\n            G = np.linalg.inv(I - dt * R)\n        except np.linalg.LinAlgError:\n            # This should not happen for this problem as (I - dt*R) is always invertible\n            # for dt >= 0, given the properties of R.\n            results.append([float('nan'), float('nan')])\n            continue\n\n        # 2. Compute its spectral radius rho(G)\n        eigenvalues_G = np.linalg.eigvals(G)\n        rho_G = np.max(np.abs(eigenvalues_G))\n\n        # 3. Time-step N times to find the numerical solution at T\n        n_num_T = np.linalg.matrix_power(G, N) @ n0\n\n        # --- Exact Solution ---\n        # 4. Compute the exact solution n_exact(T) = exp(R*T) * n0\n        exp_RT = expm(R * T)\n        n_exact_T = exp_RT @ n0\n\n        # --- Global Error ---\n        # 5. Compute the global error ||n_num(T) - n_exact(T)||_2\n        global_error = np.linalg.norm(n_num_T - n_exact_T)\n        \n        results.append([rho_G, global_error])\n\n    # Final print statement in the exact required format\n    # Convert each sublist to its string representation and join with commas\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}