{
    "hands_on_practices": [
        {
            "introduction": "The neutral recycling coefficient, $R$, is a cornerstone of divertor physics, quantifying the fraction of plasma ions returning from a surface as neutral particles. This first exercise provides practice with its fundamental definition as a ratio of particle fluxes. By calculating $R$ from given flux measurements and propagating the associated experimental uncertainties, you will develop a core skill for connecting theoretical models to real-world diagnostics. ",
            "id": "4019828",
            "problem": "A divertor plate in a magnetically confined fusion device receives an incident ion flux that, upon interaction with the surface, produces outgoing neutrals. In a steady-state particle balance for the divertor plate, the neutral recycling coefficient is defined as the fraction of incoming ions that are returned as neutrals. Under the standard definition, the neutral recycling coefficient is the ratio of the outgoing neutral particle flux to the incoming ion particle flux, both measured at the plate. Let the incoming ion flux be $j_i^{\\text{in}}$ and the outgoing neutral flux be $j_n^{\\text{out}}$, each defined as particle number per unit area per unit time.\n\nYou are given measurements $j_i^{\\text{in}} = 5 \\times 10^{22}\\,\\text{m}^{-2}\\text{s}^{-1}$ and $j_n^{\\text{out}} = 4.5 \\times 10^{22}\\,\\text{m}^{-2}\\text{s}^{-1}$. Assume the steady-state regime applies and that net retention in the plate is negligible on the measurement timescale so the measured fluxes reflect the recycling process. Treat the reported measurement errors on each flux as independent, normally distributed, one-standard-deviation relative uncertainties of $\\pm 0.10$.\n\nStarting from the flux definition and steady-state particle conservation at the surface, derive the neutral recycling coefficient $R$ in terms of $j_n^{\\text{out}}$ and $j_i^{\\text{in}}$. Then, using first-order uncertainty propagation, derive the general expression for the fractional standard uncertainty of $R$ allowing for possible statistical correlation between $j_n^{\\text{out}}$ and $j_i^{\\text{in}}$, expressed via a correlation coefficient $\\rho$. Finally, evaluate $R$ numerically for the given measurements and evaluate its one-standard-deviation fractional uncertainty for the special case of statistical independence $(\\rho = 0)$.\n\nRound your final reported numerical values to three significant figures. Report the final answer as a two-entry row matrix containing, in order, the nominal value of $R$ and the one-standard-deviation fractional uncertainty of $R$. Express the final dimensionless values without units.",
            "solution": "The problem has been validated and is determined to be sound. It is scientifically grounded in the principles of plasma-material interaction in fusion science, is well-posed with a complete and consistent set of givens, and is expressed in objective, formal language. We may therefore proceed with the solution.\n\nThe problem asks for three distinct results: the derivation of the neutral recycling coefficient $R$, the derivation of its general fractional uncertainty, and the numerical evaluation of $R$ and its fractional uncertainty under specific conditions.\n\nFirst, we address the definition of the neutral recycling coefficient, $R$. As stated in the problem, $R$ is the ratio of the outgoing neutral particle flux, $j_n^{\\text{out}}$, to the incoming ion particle flux, $j_i^{\\text{in}}$. Both fluxes are measured at the divertor plate. The steady-state particle conservation principle, with negligible net retention, implies that the total number of particles arriving at the plate per unit area per unit time must equal the total number leaving. The problem simplifies this by considering only the incident ions and the recycled neutrals. Thus, the definition is given directly by the ratio:\n$$R = \\frac{j_n^{\\text{out}}}{j_i^{\\text{in}}}$$\nThis is the required expression for $R$ in terms of the given fluxes.\n\nNext, we derive the general expression for the fractional standard uncertainty of $R$. The recycling coefficient $R$ is a function of two measured quantities, $j_n^{\\text{out}}$ and $j_i^{\\text{in}}$. Let us denote these variables as $x \\equiv j_n^{\\text{out}}$ and $y \\equiv j_i^{\\text{in}}$ for conciseness in a general derivation, so $R(x, y) = \\frac{x}{y}$. The uncertainty in $R$, denoted by its variance $\\sigma_R^2$, can be approximated to first order by the standard error propagation formula for a function of two correlated variables:\n$$\\sigma_R^2 \\approx \\left(\\frac{\\partial R}{\\partial x}\\right)^2 \\sigma_x^2 + \\left(\\frac{\\partial R}{\\partial y}\\right)^2 \\sigma_y^2 + 2 \\left(\\frac{\\partial R}{\\partial x}\\right) \\left(\\frac{\\partial R}{\\partial y}\\right) \\sigma_{xy}$$\nwhere $\\sigma_x^2$ and $\\sigma_y^2$ are the variances of $x$ and $y$, and $\\sigma_{xy}$ is their covariance. The covariance is related to the correlation coefficient $\\rho$ and the standard deviations $\\sigma_x$ and $\\sigma_y$ by $\\sigma_{xy} = \\rho \\sigma_x \\sigma_y$.\n\nWe first compute the partial derivatives of $R(x, y) = \\frac{x}{y}$ with respect to $x$ and $y$:\n$$\\frac{\\partial R}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{x}{y}\\right) = \\frac{1}{y}$$\n$$\\frac{\\partial R}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(\\frac{x}{y}\\right) = -\\frac{x}{y^2}$$\n\nSubstituting these derivatives into the variance formula:\n$$\\sigma_R^2 \\approx \\left(\\frac{1}{y}\\right)^2 \\sigma_x^2 + \\left(-\\frac{x}{y^2}\\right)^2 \\sigma_y^2 + 2 \\left(\\frac{1}{y}\\right) \\left(-\\frac{x}{y^2}\\right) \\rho \\sigma_x \\sigma_y$$\n$$\\sigma_R^2 \\approx \\frac{\\sigma_x^2}{y^2} + \\frac{x^2 \\sigma_y^2}{y^4} - \\frac{2 \\rho x \\sigma_x \\sigma_y}{y^3}$$\n\nThe problem requires the fractional standard uncertainty, $\\frac{\\sigma_R}{R}$. To find this, we divide the expression for $\\sigma_R^2$ by $R^2 = \\left(\\frac{x}{y}\\right)^2 = \\frac{x^2}{y^2}$.\n$$\\frac{\\sigma_R^2}{R^2} \\approx \\frac{y^2}{x^2} \\left(\\frac{\\sigma_x^2}{y^2} + \\frac{x^2 \\sigma_y^2}{y^4} - \\frac{2 \\rho x \\sigma_x \\sigma_y}{y^3}\\right)$$\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 \\approx \\frac{\\sigma_x^2}{x^2} + \\frac{\\sigma_y^2}{y^2} - \\frac{2 \\rho y^2 x \\sigma_x \\sigma_y}{x^2 y^3} = \\left(\\frac{\\sigma_x}{x}\\right)^2 + \\left(\\frac{\\sigma_y}{y}\\right)^2 - \\frac{2 \\rho \\sigma_x \\sigma_y}{xy}$$\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 \\approx \\left(\\frac{\\sigma_x}{x}\\right)^2 + \\left(\\frac{\\sigma_y}{y}\\right)^2 - 2 \\rho \\left(\\frac{\\sigma_x}{x}\\right) \\left(\\frac{\\sigma_y}{y}\\right)$$\n\nReverting to the original variable names, the squared fractional uncertainty is:\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 \\approx \\left(\\frac{\\sigma_{j_n^{\\text{out}}}}{j_n^{\\text{out}}}\\right)^2 + \\left(\\frac{\\sigma_{j_i^{\\text{in}}}}{j_i^{\\text{in}}}\\right)^2 - 2 \\rho \\left(\\frac{\\sigma_{j_n^{\\text{out}}}}{j_n^{\\text{out}}}\\right) \\left(\\frac{\\sigma_{j_i^{\\text{in}}}}{j_i^{\\text{in}}}\\right)$$\nThe fractional standard uncertainty is the square root of this expression:\n$$\\frac{\\sigma_R}{R} \\approx \\sqrt{\\left(\\frac{\\sigma_{j_n^{\\text{out}}}}{j_n^{\\text{out}}}\\right)^2 + \\left(\\frac{\\sigma_{j_i^{\\text{in}}}}{j_i^{\\text{in}}}\\right)^2 - 2 \\rho \\left(\\frac{\\sigma_{j_n^{\\text{out}}}}{j_n^{\\text{out}}}\\right) \\left(\\frac{\\sigma_{j_i^{\\text{in}}}}{j_i^{\\text{in}}}\\right)}$$\nThis is the general expression for the fractional uncertainty of $R$.\n\nFinally, we evaluate $R$ and its fractional uncertainty numerically. The given measurements are:\n$$j_i^{\\text{in}} = 5 \\times 10^{22}\\,\\text{m}^{-2}\\text{s}^{-1}$$\n$$j_n^{\\text{out}} = 4.5 \\times 10^{22}\\,\\text{m}^{-2}\\text{s}^{-1}$$\n\nThe nominal value of the recycling coefficient is:\n$$R = \\frac{j_n^{\\text{out}}}{j_i^{\\text{in}}} = \\frac{4.5 \\times 10^{22}}{5 \\times 10^{22}} = \\frac{4.5}{5} = 0.9$$\nRounding to three significant figures, we report $R = 0.900$.\n\nFor the uncertainty calculation, we are given the one-standard-deviation relative uncertainties for each flux:\n$$\\frac{\\sigma_{j_n^{\\text{out}}}}{j_n^{\\text{out}}} = 0.10$$\n$$\\frac{\\sigma_{j_i^{\\text{in}}}}{j_i^{\\text{in}}} = 0.10$$\nWe are also asked to evaluate this for the special case of statistical independence, which corresponds to a correlation coefficient $\\rho = 0$. Substituting these values into our derived formula for the fractional uncertainty:\n$$\\frac{\\sigma_R}{R} \\approx \\sqrt{(0.10)^2 + (0.10)^2 - 2 (0) (0.10) (0.10)}$$\n$$\\frac{\\sigma_R}{R} \\approx \\sqrt{(0.10)^2 + (0.10)^2} = \\sqrt{0.01 + 0.01} = \\sqrt{0.02}$$\nThe numerical value is:\n$$\\frac{\\sigma_R}{R} \\approx \\sqrt{2} \\times 10^{-1} \\approx 0.141421356...$$\nRounding to three significant figures, the fractional uncertainty is $0.141$.\n\nThe final answer comprises the nominal value of $R$ and its one-standard-deviation fractional uncertainty, both rounded to three significant figures.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.900 & 0.141 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Once neutrals are recycled from the divertor plate, their interaction with the plasma is governed by competing atomic processes. This practice explores the two most dominant channels for cold neutrals: charge exchange (CX) and electron-impact ionization. By comparing their respective mean free paths, $\\lambda_{cx}$ and $\\lambda_{ion}$, you will gain insight into why CX is the principal mechanism for coupling the momentum of the ion and neutral fluids, a process fundamental to achieving a dissipative, detached divertor state. ",
            "id": "4019691",
            "problem": "Consider a deuterium plasma in an attached divertor regime adjacent to a tokamak target plate. The plasma is approximately homogeneous over the neutral penetration scale, with ion number density $n_{i} = 5.0 \\times 10^{19}~\\mathrm{m}^{-3}$ and electron number density $n_{e} \\approx n_{i}$ due to quasineutrality. A stream of deuterium neutrals emerges from the plate into the plasma. At the characteristic energies relevant to this edge region, assume the charge exchange (CX) cross section for $\\mathrm{D}^{+} + \\mathrm{D} \\rightarrow \\mathrm{D} + \\mathrm{D}^{+}$ is $\\sigma_{cx} = 1.0 \\times 10^{-18}~\\mathrm{m}^{2}$, and the electron-impact ionization cross section for $\\mathrm{D} + e^{-} \\rightarrow \\mathrm{D}^{+} + 2e^{-}$ is $\\sigma_{ion} = 1.0 \\times 10^{-20}~\\mathrm{m}^{2}$. Use kinetic theory and the definition of a collision cross section in a dilute medium to derive the expressions for the neutral mean free path to charge exchange, $\\lambda_{cx}$, and the neutral mean free path to ionization, $\\lambda_{ion}$, in terms of the appropriate target density and cross section. Evaluate both mean free paths with the given parameters, and compute the dimensionless ratio $R = \\lambda_{cx} / \\lambda_{ion}$. Then, explain qualitatively why the relative magnitudes of $\\lambda_{cx}$ and $\\lambda_{ion}$ imply that charge exchange dominates neutral-ion momentum coupling near the plate under these conditions. Express the intermediate mean free paths in meters, and report the final ratio $R$ with no units. Round $R$ to three significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in plasma physics, well-posed, and provides all necessary information for a unique solution.\n\nThe mean free path, $\\lambda$, of a particle traveling through a medium of target particles is defined as the inverse of the product of the target number density, $n_t$, and the collision cross section, $\\sigma$. The general formula is $\\lambda = \\frac{1}{n_t \\sigma}$. We apply this fundamental definition to the two processes described: charge exchange and electron-impact ionization for a deuterium neutral in a deuterium plasma.\n\nFirst, we derive the expression for the neutral mean free path to charge exchange, $\\lambda_{cx}$. The process is $\\mathrm{D}^{+} + \\mathrm{D} \\rightarrow \\mathrm{D} + \\mathrm{D}^{+}$. The projectile is a deuterium neutral ($\\mathrm{D}$), and the target particles are deuterium ions ($\\mathrm{D}^{+}$). The number density of the target ions is given as $n_i$. The corresponding cross section is $\\sigma_{cx}$. Therefore, the mean free path for charge exchange is:\n$$ \\lambda_{cx} = \\frac{1}{n_i \\sigma_{cx}} $$\nNext, we derive the expression for the neutral mean free path to electron-impact ionization, $\\lambda_{ion}$. The process is $\\mathrm{D} + e^{-} \\rightarrow \\mathrm{D}^{+} + 2e^{-}$. The projectile is again a deuterium neutral ($\\mathrm{D}$), but the target particles are now electrons ($e^{-}$). The number density of the target electrons is given as $n_e$. The corresponding cross section is $\\sigma_{ion}$. Therefore, the mean free path for ionization is:\n$$ \\lambda_{ion} = \\frac{1}{n_e \\sigma_{ion}} $$\nNow, we evaluate these two mean free paths using the provided parameters:\nIon number density, $n_i = 5.0 \\times 10^{19}~\\mathrm{m}^{-3}$.\nElectron number density, $n_e \\approx n_i = 5.0 \\times 10^{19}~\\mathrm{m}^{-3}$.\nCharge exchange cross section, $\\sigma_{cx} = 1.0 \\times 10^{-18}~\\mathrm{m}^{2}$.\nElectron-impact ionization cross section, $\\sigma_{ion} = 1.0 \\times 10^{-20}~\\mathrm{m}^{2}$.\n\nSubstituting these values into the derived expressions:\n$$ \\lambda_{cx} = \\frac{1}{(5.0 \\times 10^{19}~\\mathrm{m}^{-3}) \\times (1.0 \\times 10^{-18}~\\mathrm{m}^{2})} = \\frac{1}{5.0 \\times 10^{1}~\\mathrm{m}^{-1}} = \\frac{1}{50}~\\mathrm{m} = 0.02~\\mathrm{m} $$\n$$ \\lambda_{ion} = \\frac{1}{(5.0 \\times 10^{19}~\\mathrm{m}^{-3}) \\times (1.0 \\times 10^{-20}~\\mathrm{m}^{2})} = \\frac{1}{5.0 \\times 10^{-1}~\\mathrm{m}^{-1}} = \\frac{1}{0.5}~\\mathrm{m} = 2.0~\\mathrm{m} $$\nThe mean free path to charge exchange is $0.02$ meters, and the mean free path to ionization is $2.0$ meters.\n\nNext, we compute the dimensionless ratio $R = \\lambda_{cx} / \\lambda_{ion}$.\nSymbolically, using the condition $n_i \\approx n_e$, the ratio is:\n$$ R = \\frac{\\lambda_{cx}}{\\lambda_{ion}} = \\frac{1/(n_i \\sigma_{cx})}{1/(n_e \\sigma_{ion})} = \\frac{n_e \\sigma_{ion}}{n_i \\sigma_{cx}} \\approx \\frac{\\sigma_{ion}}{\\sigma_{cx}} $$\nUsing the calculated numerical values for the mean free paths:\n$$ R = \\frac{0.02~\\mathrm{m}}{2.0~\\mathrm{m}} = 0.01 $$\nRounding this result to three significant figures gives $0.0100$, which in standard scientific notation is $1.00 \\times 10^{-2}$.\n\nFinally, we provide a qualitative explanation for why the relative magnitudes of $\\lambda_{cx}$ and $\\lambda_{ion}$ imply that charge exchange dominates neutral-ion momentum coupling.\nOur calculation shows that $\\lambda_{cx} = 0.02~\\mathrm{m}$ and $\\lambda_{ion} = 2.0~\\mathrm{m}$, which means $\\lambda_{cx} \\ll \\lambda_{ion}$. Specifically, $\\lambda_{ion} = 100 \\times \\lambda_{cx}$. The mean free path represents the average distance a particle travels before a specific type of collision occurs. A shorter mean free path implies a higher probability of collision per unit distance, or a higher collision frequency for a particle of a given speed.\n\nThe result $\\lambda_{cx} \\ll \\lambda_{ion}$ signifies that a neutral deuterium atom entering the plasma is approximately $100$ times more likely to undergo a charge exchange collision with an ion than it is to be ionized by an electron over any given path length.\n\nThe charge exchange reaction, $\\mathrm{D}_{\\text{neutral}} + \\mathrm{D}^{+}_{\\text{ion}} \\rightarrow \\mathrm{D}^{+}_{\\text{ion}} + \\mathrm{D}_{\\text{neutral}}$, is fundamentally a momentum exchange process between the neutral and ion populations. Typically, neutrals recycled from the cold divertor plate are slow, while ions flowing towards the plate carry significant momentum and energy. In a CX event, a slow neutral captures an electron from a fast ion, becoming a slow ion, while the originally fast ion is neutralized and becomes a fast neutral, retaining its original momentum. This direct transfer of momentum from the ion fluid to the neutral fluid is a highly effective coupling mechanism.\n\nBecause a neutral atom will, on average, undergo many charge exchange events before it is ionized, the momentum of the neutral gas becomes tightly coupled to the momentum of the ion fluid. This strong collisional coupling, occurring over the very short length scale defined by $\\lambda_{cx}$, efficiently transfers momentum from the plasma flow to the neutral population, which can then transport this momentum to the wall. This process is critical for dissipating momentum and creating the high-recycling and detached divertor conditions necessary for reducing heat loads on plasma-facing components. In contrast, ionization is primarily a particle source/sink process for the neutral/ion fluids, and it is a much less frequent event for the neutrals under these conditions.",
            "answer": "$$\\boxed{1.00 \\times 10^{-2}}$$"
        },
        {
            "introduction": "This final exercise moves from simple calculations to a complete computational problem, mirroring the work of a computational fusion scientist. Bayesian inference provides a powerful framework for combining a physical forward model with noisy experimental data and prior knowledge to produce a robust estimate of a parameter like $R$. By implementing a Bayesian estimation of the recycling coefficient from synthetic diagnostic data, you will practice the essential modern skill of model inversion and uncertainty quantification, bridging the gap between theoretical models and experimental observation. ",
            "id": "4019706",
            "problem": "Consider a simplified neutral recycling model for a divertor plate in a tokamak, posed as a statistically well-defined inference problem for the recycling coefficient. The divertor ion flux to the plate is denoted by $\\Gamma_i$ with units $\\mathrm{m}^{-2}\\mathrm{s}^{-1}$. The neutral source density near the plate is modeled as $S = R \\Gamma_i / \\Delta$, where $R$ is the dimensionless recycling coefficient satisfying $0 \\le R \\le 1$, and $\\Delta$ is a characteristic recycling layer thickness with units $\\mathrm{m}$. In a zero-dimensional steady-state slab approximation, the neutral density $n_n$ satisfies a source-loss balance\n$$\nS = \\frac{n_n}{\\tau_{\\mathrm{loss}}} + k_i n_e n_n,\n$$\nwhere $\\tau_{\\mathrm{loss}}$ is a neutral loss time with units $\\mathrm{s}$, $n_e$ is the electron density with units $\\mathrm{m}^{-3}$, and $k_i$ is an effective ionization rate coefficient with units $\\mathrm{m}^3\\mathrm{s}^{-1}$. The observable along chord $j$ is modeled as a line-integrated brightness $y_j$ that is proportional to the local neutral density with a known geometric weighting $\\alpha_j$ (dimensionless), plus additive measurement noise:\n$$\ny_j = \\alpha_j n_n + \\varepsilon_j.\n$$\nAssume independent Gaussian measurement noise with zero mean and variance $\\sigma^2$, i.e., $\\varepsilon_j \\sim \\mathcal{N}(0,\\sigma^2)$ and $\\mathrm{Cov}(\\varepsilon) = \\sigma^2 I$. Under the slab model above, $n_n$ is proportional to $R$ and one can write the forward model compactly as\n$$\n\\mathbf{y} = \\mathbf{c} R + \\boldsymbol{\\varepsilon},\n$$\nwhere the vector $\\mathbf{c}$ has components\n$$\nc_j = \\alpha_j \\frac{\\Gamma_i / \\Delta}{\\tau_{\\mathrm{loss}}^{-1} + k_i n_e},\n$$\nand $\\boldsymbol{\\varepsilon}$ is the noise vector.\n\nAssume a Gaussian prior on $R$, $R \\sim \\mathcal{N}(\\mu_0,\\sigma_0^2)$, which expresses prior knowledge that $R$ is near $\\mu_0$ with uncertainty $\\sigma_0$. Your task is to generate synthetic data for $\\mathbf{y}$ using known parameter values and a fixed true recycling coefficient $R_{\\mathrm{true}}$ for each test case, and then compute:\n- the maximum a posteriori (MAP) estimate of $R$, and\n- the posterior covariance of $R$ (for a scalar parameter, the covariance reduces to the posterior variance).\n\nUse the following physically plausible global parameters, common to all test cases:\n- $\\Gamma_i = 10^{22}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-1}$,\n- $\\Delta = 5 \\times 10^{-3}\\ \\mathrm{m}$,\n- $\\tau_{\\mathrm{loss}} = 10^{-3}\\ \\mathrm{s}$,\n- $n_e = 5 \\times 10^{19}\\ \\mathrm{m}^{-3}$,\n- $k_i = 10^{-13}\\ \\mathrm{m}^3\\mathrm{s}^{-1}$.\n\nSynthetic data generation must use a fixed pseudorandom number generator seed of $12345$ so results are reproducible. For each test case, construct $\\mathbf{y}$ via $y_j = c_j R_{\\mathrm{true}} + \\varepsilon_j$ with $\\varepsilon_j \\sim \\mathcal{N}(0,\\sigma^2)$ independently for each $j$.\n\nProvide the results for the following test suite of parameter sets, each specified by the tuple $(R_{\\mathrm{true}}, \\{\\alpha_j\\}_{j=1}^J, \\sigma, \\mu_0, \\sigma_0)$:\n\n- Test case A (moderate noise, multiple chords, data informative):\n  - $R_{\\mathrm{true}} = 0.95$,\n  - $\\{\\alpha_j\\} = \\{0.80, 1.10, 0.90, 1.20, 0.70\\}$ with $J=5$,\n  - $\\sigma = 1.0 \\times 10^{16}$,\n  - $\\mu_0 = 0.90$,\n  - $\\sigma_0 = 0.10$.\n\n- Test case B (high noise, few chords, strong prior):\n  - $R_{\\mathrm{true}} = 0.85$,\n  - $\\{\\alpha_j\\} = \\{0.50, 0.60\\}$ with $J=2$,\n  - $\\sigma = 5.0 \\times 10^{16}$,\n  - $\\mu_0 = 0.90$,\n  - $\\sigma_0 = 0.05$.\n\n- Test case C (low noise, many chords, weak prior):\n  - $R_{\\mathrm{true}} = 0.98$,\n  - $\\{\\alpha_j\\} = \\{0.90, 1.00, 1.10, 0.95, 1.05, 0.85, 1.15, 1.20, 0.80, 0.92\\}$ with $J=10$,\n  - $\\sigma = 5.0 \\times 10^{15}$,\n  - $\\mu_0 = 0.80$,\n  - $\\sigma_0 = 0.50$.\n\n- Test case D (very high noise, some zero-weight chords, tight prior):\n  - $R_{\\mathrm{true}} = 0.92$,\n  - $\\{\\alpha_j\\} = \\{1.00, 0.00, 1.00, 0.00, 1.00\\}$ with $J=5$,\n  - $\\sigma = 1.0 \\times 10^{17}$,\n  - $\\mu_0 = 0.95$,\n  - $\\sigma_0 = 0.02$.\n\nAll quantities involving $R$ and the estimates are dimensionless. Express the MAP estimate and the posterior uncertainty as decimal numbers with no units. Your program must:\n\n- Use the specified global physical parameters to construct $\\mathbf{c}$,\n- Generate synthetic $\\mathbf{y}$ using the fixed seed $12345$ and the noise level $\\sigma$ of each test,\n- Compute the MAP estimate of $R$ and the posterior variance of $R$ from the Gaussian posterior implied by the linear-Gaussian likelihood and the Gaussian prior,\n- Return, for each test case, the pair consisting of the MAP estimate and the posterior standard deviation (the square root of the posterior variance) in that order.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list should contain the pairs for the test cases in the order A, B, C, D, flattened into a single list. Concretely, the output must be of the form\n$$\n[\\widehat{R}_A, s_A, \\widehat{R}_B, s_B, \\widehat{R}_C, s_C, \\widehat{R}_D, s_D],\n$$\nwhere $\\widehat{R}$ denotes the MAP estimate and $s$ denotes the posterior standard deviation for each respective test case. No other text should be printed.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and self-contained. It describes a standard Bayesian parameter estimation task for a linear-Gaussian model, for which an analytical solution exists.\n\nThe problem requires us to estimate the recycling coefficient $R$ from a set of noisy measurements $\\mathbf{y}$. The relationship between the parameter $R$ and the measurements is given by the linear forward model:\n$$\n\\mathbf{y} = \\mathbf{c} R + \\boldsymbol{\\varepsilon}\n$$\nwhere $\\mathbf{y}$ is the vector of $J$ observations $\\{y_j\\}$, $\\mathbf{c}$ is a vector of known coefficients, $R$ is the scalar parameter to be inferred, and $\\boldsymbol{\\varepsilon}$ is the vector of measurement noise.\n\nThe problem is framed within a Bayesian context. We are given a prior distribution for $R$ and a likelihood function defined by the forward model and noise characteristics.\n\nThe prior distribution for $R$ is given as a Gaussian:\n$$\np(R) = \\mathcal{N}(R | \\mu_0, \\sigma_0^2) = \\frac{1}{\\sqrt{2\\pi\\sigma_0^2}} \\exp\\left(-\\frac{(R-\\mu_0)^2}{2\\sigma_0^2}\\right)\n$$\nwhere $\\mu_0$ and $\\sigma_0^2$ are the prior mean and variance, respectively.\n\nThe measurement noise for each channel $j$ is assumed to be independent and identically distributed according to a zero-mean Gaussian distribution, $\\varepsilon_j \\sim \\mathcal{N}(0, \\sigma^2)$. This leads to the likelihood function, which is the probability of observing the data $\\mathbf{y}$ given a value of $R$:\n$$\np(\\mathbf{y}|R) = \\mathcal{N}(\\mathbf{y} | \\mathbf{c}R, \\sigma^2 I) = \\frac{1}{(2\\pi\\sigma^2)^{J/2}} \\exp\\left(-\\frac{(\\mathbf{y}-\\mathbf{c}R)^T(\\mathbf{y}-\\mathbf{c}R)}{2\\sigma^2}\\right)\n$$\nwhere $I$ is the $J \\times J$ identity matrix.\n\nAccording to Bayes' theorem, the posterior distribution for $R$ is proportional to the product of the likelihood and the prior:\n$$\np(R|\\mathbf{y}) \\propto p(\\mathbf{y}|R) p(R)\n$$\nSince both the prior and the likelihood are Gaussian functions of $R$, their product (and thus the posterior) will also be a Gaussian distribution. Let the posterior be $p(R|\\mathbf{y}) = \\mathcal{N}(R | \\mu_N, \\sigma_N^2)$. Our goal is to find the posterior mean $\\mu_N$ and the posterior variance $\\sigma_N^2$.\n\nThe log-posterior is proportional to the sum of the log-likelihood and the log-prior, ignoring terms that do not depend on $R$:\n$$\n\\ln p(R|\\mathbf{y}) \\propto -\\frac{1}{2\\sigma^2}(\\mathbf{y}-\\mathbf{c}R)^T(\\mathbf{y}-\\mathbf{c}R) - \\frac{1}{2\\sigma_0^2}(R-\\mu_0)^2\n$$\nExpanding the quadratic terms in $R$:\n$$\n\\ln p(R|\\mathbf{y}) \\propto -\\frac{1}{2\\sigma^2}(\\mathbf{y}^T\\mathbf{y} - 2R\\mathbf{y}^T\\mathbf{c} + R^2\\mathbf{c}^T\\mathbf{c}) - \\frac{1}{2\\sigma_0^2}(R^2 - 2R\\mu_0 + \\mu_0^2)\n$$\nCollecting terms in $R^2$ and $R$:\n$$\n\\ln p(R|\\mathbf{y}) \\propto -\\frac{1}{2}\\left[ \\left(\\frac{\\mathbf{c}^T\\mathbf{c}}{\\sigma^2} + \\frac{1}{\\sigma_0^2}\\right)R^2 - 2\\left(\\frac{\\mathbf{y}^T\\mathbf{c}}{\\sigma^2} + \\frac{\\mu_0}{\\sigma_0^2}\\right)R \\right]\n$$\nBy comparing this to the exponent of a general Gaussian distribution $\\mathcal{N}(\\mu, \\sigma^2)$, which has the form $-\\frac{1}{2\\sigma^2}(R-\\mu)^2 = -\\frac{1}{2\\sigma^2}(R^2 - 2R\\mu + \\mu^2)$, we can identify the inverse posterior variance (also known as the posterior precision, $\\lambda_N$) and the posterior mean $\\mu_N$.\n\nThe term multiplying $R^2$ gives the posterior precision:\n$$\n\\lambda_N = \\sigma_N^{-2} = \\frac{\\mathbf{c}^T\\mathbf{c}}{\\sigma^2} + \\frac{1}{\\sigma_0^2}\n$$\nThis shows that the posterior precision is the sum of the data precision (from the likelihood) and the prior precision. The posterior variance is the reciprocal of the precision:\n$$\n\\sigma_N^2 = \\left( \\frac{\\mathbf{c}^T\\mathbf{c}}{\\sigma^2} + \\frac{1}{\\sigma_0^2} \\right)^{-1}\n$$\nThe posterior mean $\\mu_N$ is found from the term linear in $R$, such that $\\sigma_N^{-2}\\mu_N = \\left(\\frac{\\mathbf{y}^T\\mathbf{c}}{\\sigma^2} + \\frac{\\mu_0}{\\sigma_0^2}\\right)$. Thus:\n$$\n\\mu_N = \\sigma_N^2 \\left( \\frac{\\mathbf{y}^T\\mathbf{c}}{\\sigma^2} + \\frac{\\mu_0}{\\sigma_0^2} \\right)\n$$\nFor a Gaussian posterior, the maximum a posteriori (MAP) estimate is equal to the posterior mean, $\\widehat{R}_{\\mathrm{MAP}} = \\mu_N$. The posterior uncertainty required is the standard deviation, $s = \\sqrt{\\sigma_N^2} = \\sigma_N$.\n\nThe computational procedure is as follows:\n1.  Using the provided global physical parameters $\\Gamma_i=10^{22}$, $\\Delta=5\\times10^{-3}$, $\\tau_{\\mathrm{loss}}=10^{-3}$, $n_e=5\\times10^{19}$, and $k_i=10^{-13}$, we first calculate the constant factor $C_0$ that relates the components of $\\mathbf{c}$ to the geometric weights $\\alpha_j$:\n    $$\n    C_0 = \\frac{\\Gamma_i / \\Delta}{\\tau_{\\mathrm{loss}}^{-1} + k_i n_e} = \\frac{10^{22} / (5 \\times 10^{-3})}{1/10^{-3} + (10^{-13} \\times 5 \\times 10^{19})} \\approx 3.9992 \\times 10^{17}\n    $$\n2.  For each test case, specified by $(R_{\\mathrm{true}}, \\{\\alpha_j\\}_{j=1}^J, \\sigma, \\mu_0, \\sigma_0)$:\n    a. Construct the vector $\\mathbf{c}$ with components $c_j = \\alpha_j C_0$.\n    b. Initialize a pseudorandom number generator with a fixed seed of $12345$.\n    c. Generate a noise vector $\\boldsymbol{\\varepsilon}$ of size $J$ by drawing from $\\mathcal{N}(0, \\sigma^2)$.\n    d. Synthesize the measurement data vector $\\mathbf{y} = \\mathbf{c} R_{\\mathrm{true}} + \\boldsymbol{\\varepsilon}$.\n    e. Calculate the scalar products $\\mathbf{c}^T\\mathbf{c} = \\sum_{j=1}^J c_j^2$ and $\\mathbf{y}^T\\mathbf{c} = \\sum_{j=1}^J y_j c_j$.\n    f. Use these quantities and the given prior parameters $(\\mu_0, \\sigma_0^2)$ and noise variance $\\sigma^2$ to compute the posterior variance $\\sigma_N^2$ and the MAP estimate $\\widehat{R}_{\\mathrm{MAP}} = \\mu_N$ using the derived formulas.\n    g. The posterior standard deviation is $s_N = \\sqrt{\\sigma_N^2}$.\n3.  The results for each test case, $(\\widehat{R}_{\\mathrm{MAP}}, s_N)$, are collected and formatted into a single list as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a Bayesian inference problem for the recycling coefficient in a\n    simplified divertor model.\n    \"\"\"\n    # Define the global physical parameters as specified in the problem statement.\n    GAMMA_I = 1e22  # Divertor ion flux [m^-2 s^-1]\n    DELTA = 5e-3    # Characteristic recycling layer thickness [m]\n    TAU_LOSS = 1e-3 # Neutral loss time [s]\n    N_E = 5e19      # Electron density [m^-3]\n    K_I = 1e-13     # Effective ionization rate coefficient [m^3 s^-1]\n\n    # Initialize the pseudorandom number generator with a fixed seed for reproducibility.\n    RNG_SEED = 12345\n    rng = np.random.default_rng(RNG_SEED)\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (R_true, list of alpha_j, sigma, mu_0, sigma_0)\n    test_cases = [\n        # Test case A\n        (0.95, [0.80, 1.10, 0.90, 1.20, 0.70], 1.0e16, 0.90, 0.10),\n        # Test case B\n        (0.85, [0.50, 0.60], 5.0e16, 0.90, 0.05),\n        # Test case C\n        (0.98, [0.90, 1.00, 1.10, 0.95, 1.05, 0.85, 1.15, 1.20, 0.80, 0.92], 5.0e15, 0.80, 0.50),\n        # Test case D\n        (0.92, [1.00, 0.00, 1.00, 0.00, 1.00], 1.0e17, 0.95, 0.02),\n    ]\n\n    # Pre-calculate the constant factor C0 for constructing the c vector.\n    # c_j = alpha_j * C0, where C0 = (Gamma_i / Delta) / (1/tau_loss + k_i * n_e)\n    C0 = (GAMMA_I / DELTA) / (1.0 / TAU_LOSS + K_I * N_E)\n\n    results = []\n\n    # Process each test case.\n    for R_true, alphas, sigma, mu_0, sigma_0 in test_cases:\n        alphas_arr = np.array(alphas)\n        num_chords = len(alphas_arr)\n\n        # 1. Construct the vector c\n        c_vec = alphas_arr * C0\n\n        # 2. Generate synthetic measurement data y\n        # Generate the noise vector epsilon from N(0, sigma^2)\n        epsilon = rng.normal(loc=0.0, scale=sigma, size=num_chords)\n        # Generate the data vector y = c*R_true + epsilon\n        y_vec = c_vec * R_true + epsilon\n\n        # 3. Compute the parameters of the Gaussian posterior distribution.\n        # The posterior is N(R | mu_N, sigma_N^2), where mu_N is the MAP estimate.\n        \n        # Calculate intermediate scalar products.\n        c_T_c = np.dot(c_vec, c_vec) # c_transpose * c\n        y_T_c = np.dot(y_vec, c_vec) # y_transpose * c\n\n        # Calculate posterior precision (inverse variance): sigma_N^-2\n        # precision = precision_likelihood + precision_prior\n        # precision_likelihood = c^T*c / sigma^2\n        # precision_prior = 1 / sigma_0^2\n        # Use squares for variance in calculations to avoid negative numbers\n        sigma_sq = sigma**2\n        sigma_0_sq = sigma_0**2\n        \n        post_precision = c_T_c / sigma_sq + 1.0 / sigma_0_sq\n\n        # Posterior variance and standard deviation\n        post_variance = 1.0 / post_precision\n        post_std_dev = np.sqrt(post_variance)\n        \n        # Posterior mean (which is the MAP estimate for a Gaussian posterior)\n        # mu_N = sigma_N^2 * (y^T*c / sigma^2 + mu_0 / sigma_0^2)\n        map_estimate = post_variance * (y_T_c / sigma_sq + mu_0 / sigma_0_sq)\n\n        results.extend([map_estimate, post_std_dev])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}