{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of quantifying neutral recycling is the recycling coefficient, $R$. At its most fundamental level, it represents the fraction of ions striking a surface that return as neutral atoms or molecules. This first exercise provides practice with this core definition by calculating $R$ from measured particle fluxes at a divertor plate . More importantly, it introduces the critical skill of uncertainty quantification, guiding you through the process of propagating experimental errors to determine the confidence in your calculated value of $R$, a vital step in bridging theoretical models with real-world data.",
            "id": "4019828",
            "problem": "A divertor plate in a magnetically confined fusion device receives an incident ion flux that, upon interaction with the surface, produces outgoing neutrals. In a steady-state particle balance for the divertor plate, the neutral recycling coefficient is defined as the fraction of incoming ions that are returned as neutrals. Under the standard definition, the neutral recycling coefficient is the ratio of the outgoing neutral particle flux to the incoming ion particle flux, both measured at the plate. Let the incoming ion flux be $j_i^{\\text{in}}$ and the outgoing neutral flux be $j_n^{\\text{out}}$, each defined as particle number per unit area per unit time.\n\nYou are given measurements $j_i^{\\text{in}} = 5 \\times 10^{22}\\,\\text{m}^{-2}\\text{s}^{-1}$ and $j_n^{\\text{out}} = 4.5 \\times 10^{22}\\,\\text{m}^{-2}\\text{s}^{-1}$. Assume the steady-state regime applies and that net retention in the plate is negligible on the measurement timescale so the measured fluxes reflect the recycling process. Treat the reported measurement errors on each flux as independent, normally distributed, one-standard-deviation relative uncertainties of $\\pm 0.10$.\n\nStarting from the flux definition and steady-state particle conservation at the surface, derive the neutral recycling coefficient $R$ in terms of $j_n^{\\text{out}}$ and $j_i^{\\text{in}}$. Then, using first-order uncertainty propagation, derive the general expression for the fractional standard uncertainty of $R$ allowing for possible statistical correlation between $j_n^{\\text{out}}$ and $j_i^{\\text{in}}$, expressed via a correlation coefficient $\\rho$. Finally, evaluate $R$ numerically for the given measurements and evaluate its one-standard-deviation fractional uncertainty for the special case of statistical independence $(\\rho = 0)$.\n\nRound your final reported numerical values to three significant figures. Report the final answer as a two-entry row matrix containing, in order, the nominal value of $R$ and the one-standard-deviation fractional uncertainty of $R$. Express the final dimensionless values without units.",
            "solution": "The problem has been validated and is determined to be sound. It is scientifically grounded in the principles of plasma-material interaction in fusion science, is well-posed with a complete and consistent set of givens, and is expressed in objective, formal language. We may therefore proceed with the solution.\n\nThe problem asks for three distinct results: the derivation of the neutral recycling coefficient $R$, the derivation of its general fractional uncertainty, and the numerical evaluation of $R$ and its fractional uncertainty under specific conditions.\n\nFirst, we address the definition of the neutral recycling coefficient, $R$. As stated in the problem, $R$ is the ratio of the outgoing neutral particle flux, $j_n^{\\text{out}}$, to the incoming ion particle flux, $j_i^{\\text{in}}$. Both fluxes are measured at the divertor plate. The steady-state particle conservation principle, with negligible net retention, implies that the total number of particles arriving at the plate per unit area per unit time must equal the total number leaving. The problem simplifies this by considering only the incident ions and the recycled neutrals. Thus, the definition is given directly by the ratio:\n$$R = \\frac{j_n^{\\text{out}}}{j_i^{\\text{in}}}$$\nThis is the required expression for $R$ in terms of the given fluxes.\n\nNext, we derive the general expression for the fractional standard uncertainty of $R$. The recycling coefficient $R$ is a function of two measured quantities, $j_n^{\\text{out}}$ and $j_i^{\\text{in}}$. Let us denote these variables as $x \\equiv j_n^{\\text{out}}$ and $y \\equiv j_i^{\\text{in}}$ for conciseness in a general derivation, so $R(x, y) = \\frac{x}{y}$. The uncertainty in $R$, denoted by its variance $\\sigma_R^2$, can be approximated to first order by the standard error propagation formula for a function of two correlated variables:\n$$\\sigma_R^2 \\approx \\left(\\frac{\\partial R}{\\partial x}\\right)^2 \\sigma_x^2 + \\left(\\frac{\\partial R}{\\partial y}\\right)^2 \\sigma_y^2 + 2 \\left(\\frac{\\partial R}{\\partial x}\\right) \\left(\\frac{\\partial R}{\\partial y}\\right) \\sigma_{xy}$$\nwhere $\\sigma_x^2$ and $\\sigma_y^2$ are the variances of $x$ and $y$, and $\\sigma_{xy}$ is their covariance. The covariance is related to the correlation coefficient $\\rho$ and the standard deviations $\\sigma_x$ and $\\sigma_y$ by $\\sigma_{xy} = \\rho \\sigma_x \\sigma_y$.\n\nWe first compute the partial derivatives of $R(x, y) = \\frac{x}{y}$ with respect to $x$ and $y$:\n$$\\frac{\\partial R}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(\\frac{x}{y}\\right) = \\frac{1}{y}$$\n$$\\frac{\\partial R}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(\\frac{x}{y}\\right) = -\\frac{x}{y^2}$$\n\nSubstituting these derivatives into the variance formula:\n$$\\sigma_R^2 \\approx \\left(\\frac{1}{y}\\right)^2 \\sigma_x^2 + \\left(-\\frac{x}{y^2}\\right)^2 \\sigma_y^2 + 2 \\left(\\frac{1}{y}\\right) \\left(-\\frac{x}{y^2}\\right) \\rho \\sigma_x \\sigma_y$$\n$$\\sigma_R^2 \\approx \\frac{\\sigma_x^2}{y^2} + \\frac{x^2 \\sigma_y^2}{y^4} - \\frac{2 \\rho x \\sigma_x \\sigma_y}{y^3}$$\n\nThe problem requires the fractional standard uncertainty, $\\frac{\\sigma_R}{R}$. To find this, we divide the expression for $\\sigma_R^2$ by $R^2 = \\left(\\frac{x}{y}\\right)^2 = \\frac{x^2}{y^2}$.\n$$\\frac{\\sigma_R^2}{R^2} \\approx \\frac{y^2}{x^2} \\left(\\frac{\\sigma_x^2}{y^2} + \\frac{x^2 \\sigma_y^2}{y^4} - \\frac{2 \\rho x \\sigma_x \\sigma_y}{y^3}\\right)$$\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 \\approx \\frac{\\sigma_x^2}{x^2} + \\frac{\\sigma_y^2}{y^2} - \\frac{2 \\rho y^2 x \\sigma_x \\sigma_y}{x^2 y^3} = \\left(\\frac{\\sigma_x}{x}\\right)^2 + \\left(\\frac{\\sigma_y}{y}\\right)^2 - \\frac{2 \\rho \\sigma_x \\sigma_y}{xy}$$\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 \\approx \\left(\\frac{\\sigma_x}{x}\\right)^2 + \\left(\\frac{\\sigma_y}{y}\\right)^2 - 2 \\rho \\left(\\frac{\\sigma_x}{x}\\right) \\left(\\frac{\\sigma_y}{y}\\right)$$\n\nReverting to the original variable names, the squared fractional uncertainty is:\n$$\\left(\\frac{\\sigma_R}{R}\\right)^2 \\approx \\left(\\frac{\\sigma_{j_n^{\\text{out}}}}{j_n^{\\text{out}}}\\right)^2 + \\left(\\frac{\\sigma_{j_i^{\\text{in}}}}{j_i^{\\text{in}}}\\right)^2 - 2 \\rho \\left(\\frac{\\sigma_{j_n^{\\text{out}}}}{j_n^{\\text{out}}}\\right) \\left(\\frac{\\sigma_{j_i^{\\text{in}}}}{j_i^{\\text{in}}}\\right)$$\nThe fractional standard uncertainty is the square root of this expression:\n$$\\frac{\\sigma_R}{R} \\approx \\sqrt{\\left(\\frac{\\sigma_{j_n^{\\text{out}}}}{j_n^{\\text{out}}}\\right)^2 + \\left(\\frac{\\sigma_{j_i^{\\text{in}}}}{j_i^{\\text{in}}}\\right)^2 - 2 \\rho \\left(\\frac{\\sigma_{j_n^{\\text{out}}}}{j_n^{\\text{out}}}\\right) \\left(\\frac{\\sigma_{j_i^{\\text{in}}}}{j_i^{\\text{in}}}\\right)}$$\nThis is the general expression for the fractional uncertainty of $R$.\n\nFinally, we evaluate $R$ and its fractional uncertainty numerically. The given measurements are:\n$$j_i^{\\text{in}} = 5 \\times 10^{22}\\,\\text{m}^{-2}\\text{s}^{-1}$$\n$$j_n^{\\text{out}} = 4.5 \\times 10^{22}\\,\\text{m}^{-2}\\text{s}^{-1}$$\n\nThe nominal value of the recycling coefficient is:\n$$R = \\frac{j_n^{\\text{out}}}{j_i^{\\text{in}}} = \\frac{4.5 \\times 10^{22}}{5 \\times 10^{22}} = \\frac{4.5}{5} = 0.9$$\nRounding to three significant figures, we report $R = 0.900$.\n\nFor the uncertainty calculation, we are given the one-standard-deviation relative uncertainties for each flux:\n$$\\frac{\\sigma_{j_n^{\\text{out}}}}{j_n^{\\text{out}}} = 0.10$$\n$$\\frac{\\sigma_{j_i^{\\text{in}}}}{j_i^{\\text{in}}} = 0.10$$\nWe are also asked to evaluate this for the special case of statistical independence, which corresponds to a correlation coefficient $\\rho = 0$. Substituting these values into our derived formula for the fractional uncertainty:\n$$\\frac{\\sigma_R}{R} \\approx \\sqrt{(0.10)^2 + (0.10)^2 - 2 (0) (0.10) (0.10)}$$\n$$\\frac{\\sigma_R}{R} \\approx \\sqrt{(0.10)^2 + (0.10)^2} = \\sqrt{0.01 + 0.01} = \\sqrt{0.02}$$\nThe numerical value is:\n$$\\frac{\\sigma_R}{R} \\approx \\sqrt{2} \\times 10^{-1} \\approx 0.141421356...$$\nRounding to three significant figures, the fractional uncertainty is $0.141$.\n\nThe final answer comprises the nominal value of $R$ and its one-standard-deviation fractional uncertainty, both rounded to three significant figures.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.900 & 0.141 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Once neutrals are formed at the divertor plate, their journey back into the plasma is dictated by their interactions with plasma particles. This exercise delves into the underlying microscopic physics, focusing on electron-impact ionization, which is a primary sink for the neutral population . By calculating the neutral mean free path for ionization, $\\lambda_{\\text{ion}}$, and comparing it to the characteristic size of the divertor, you will learn how to determine the nature of neutral transport—whether it is 'local' and diffusive or 'non-local' and ballistic. This classification is a crucial decision point in computational modeling, as it dictates whether a simpler fluid description or a more computationally intensive kinetic model is required.",
            "id": "4019742",
            "problem": "A deuterium plasma in the divertor region of a tokamak operates in a high-recycling state. Neutral deuterium atoms are produced at the divertor plate and interact with electrons via electron-impact ionization. Assume the electrons are described by a Maxwellian Electron Energy Distribution Function (EEDF) at a uniform electron temperature $T_{e}$, and the neutrals are described by a Maxwellian velocity distribution at a neutral temperature $T_{n}$. The electron number density is $n_{e}$. The divertor leg connection length (the characteristic dimension along which neutrals can stream) is $L_{\\text{div}}$.\n\nStarting from kinetic theory definitions, use the collision frequency for electron-impact ionization of neutrals, $\\nu_{\\text{ion}} = n_{e} \\langle \\sigma_{\\text{ion}} v \\rangle$, where $\\langle \\sigma_{\\text{ion}} v \\rangle$ is the Maxwellian electron-averaged ionization rate coefficient, and the mean free time $\\tau_{\\text{ion}} = 1/\\nu_{\\text{ion}}$, to derive an expression for the neutral mean free path for ionization in terms of $\\langle v \\rangle$ for the neutrals and $\\langle \\sigma_{\\text{ion}} v \\rangle$. Then evaluate the mean free path numerically for the following representative parameters:\n- $n_{e} = 3.0 \\times 10^{20} \\ \\text{m}^{-3}$,\n- $T_{e} = 15 \\ \\text{eV}$,\n- $T_{n} = 0.3 \\ \\text{eV}$,\n- $L_{\\text{div}} = 0.50 \\ \\text{m}$.\n\nUse the standard recommended fit (Janev–Voronov type) for hydrogenic electron-impact ionization of neutrals,\n$$\n\\langle \\sigma_{\\text{ion}} v \\rangle (T_{e}) = A \\left( \\frac{E_{i}}{T_{e}} \\right)^{K} \\exp\\!\\left( -\\frac{E_{i}}{T_{e}} \\right),\n$$\nwith $A = 2.91 \\times 10^{-14} \\ \\text{m}^{3}\\,\\text{s}^{-1}$, $E_{i} = 13.6 \\ \\text{eV}$, and $K = 0.39$. Treat deuterium as hydrogenic for ionization. For the neutral mean speed, use the Maxwellian result\n$$\n\\langle v \\rangle = \\sqrt{\\frac{8 k_{B} T_{n}}{\\pi m_{D}}},\n$$\nwhere $m_{D}$ is the deuterium atomic mass and $k_{B}$ is the Boltzmann constant. Convert electronvolts to joules using the elementary charge $e$ via $k_{B} T_{n} = T_{n} e$ when evaluating $\\langle v \\rangle$.\n\nAfter computing the mean free path, interpret whether the neutral transport is local (diffusive) or non-local (ballistic) by comparing the ratio $\\lambda_{\\text{ion}} / L_{\\text{div}}$ to unity. For the purposes of classification, use the following regime map: local if $\\lambda_{\\text{ion}}/L_{\\text{div}} \\leq 0.1$, transitional if $0.1 < \\lambda_{\\text{ion}}/L_{\\text{div}} < 1$, and non-local if $\\lambda_{\\text{ion}}/L_{\\text{div}} \\geq 1$.\n\nRound your final reported numerical value of the mean free path to three significant figures. Express your final answer in meters.",
            "solution": "The problem statement has been validated and is found to be scientifically grounded, well-posed, and self-contained. The parameters provided are physically realistic for a high-recycling divertor plasma in a tokamak, and the requested calculations are based on standard models in computational plasma and fusion science. The problem is therefore deemed valid.\n\nThe central task is to derive and evaluate the mean free path for ionization, $\\lambda_{\\text{ion}}$, for neutral deuterium atoms in a divertor plasma. The mean free path represents the average distance a particle travels before undergoing a specific type of collision—in this case, electron-impact ionization. It is formally defined as the product of the particle's average speed and its mean free time between collisions.\n\nFor a neutral deuterium atom, the mean free path for ionization is given by:\n$$\n\\lambda_{\\text{ion}} = \\langle v \\rangle_{n} \\tau_{\\text{ion}}\n$$\nwhere $\\langle v \\rangle_{n}$ is the mean speed of the neutral atoms and $\\tau_{\\text{ion}}$ is the mean free time before an ionization event occurs.\n\nThe problem provides that the mean free time $\\tau_{\\text{ion}}$ is the reciprocal of the ionization collision frequency, $\\nu_{\\text{ion}}$.\n$$\n\\tau_{\\text{ion}} = \\frac{1}{\\nu_{\\text{ion}}}\n$$\nThe ionization frequency is given by the expression:\n$$\n\\nu_{\\text{ion}} = n_{e} \\langle \\sigma_{\\text{ion}} v \\rangle\n$$\nwhere $n_{e}$ is the electron number density and $\\langle \\sigma_{\\text{ion}} v \\rangle$ is the Maxwellian electron-averaged rate coefficient for electron-impact ionization.\n\nSubstituting these relations into the expression for $\\lambda_{\\text{ion}}$, we arrive at the general formula for the neutral mean free path for ionization:\n$$\n\\lambda_{\\text{ion}} = \\frac{\\langle v \\rangle_{n}}{n_{e} \\langle \\sigma_{\\text{ion}} v \\rangle}\n$$\nThis expression constitutes the required derivation. We will now proceed with the numerical evaluation of this quantity. This requires calculating the two terms in the fraction: the neutral mean speed $\\langle v \\rangle_{n}$ and the ionization rate coefficient $\\langle \\sigma_{\\text{ion}} v \\rangle$.\n\nFirst, we calculate the ionization rate coefficient, $\\langle \\sigma_{\\text{ion}} v \\rangle$, using the provided Janev–Voronov empirical fit:\n$$\n\\langle \\sigma_{\\text{ion}} v \\rangle (T_{e}) = A \\left( \\frac{E_{i}}{T_{e}} \\right)^{K} \\exp\\left( -\\frac{E_{i}}{T_{e}} \\right)\n$$\nThe given parameters are $A = 2.91 \\times 10^{-14} \\ \\text{m}^{3}\\,\\text{s}^{-1}$, $E_{i} = 13.6 \\ \\text{eV}$, $K = 0.39$, and $T_{e} = 15 \\ \\text{eV}$. The ratio $E_{i}/T_{e}$ is a dimensionless quantity:\n$$\n\\frac{E_{i}}{T_{e}} = \\frac{13.6}{15} \\approx 0.90667\n$$\nSubstituting the values into the formula:\n$$\n\\langle \\sigma_{\\text{ion}} v \\rangle = (2.91 \\times 10^{-14}) \\left( \\frac{13.6}{15} \\right)^{0.39} \\exp\\left( -\\frac{13.6}{15} \\right)\n$$\n$$\n\\langle \\sigma_{\\text{ion}} v \\rangle \\approx (2.91 \\times 10^{-14}) \\times (0.96256) \\times (0.40386) \\approx 1.1306 \\times 10^{-14} \\ \\text{m}^{3}\\,\\text{s}^{-1}\n$$\n\nNext, we calculate the mean speed of the neutral deuterium atoms, $\\langle v \\rangle_{n}$, from their Maxwellian distribution at temperature $T_{n}$:\n$$\n\\langle v \\rangle_{n} = \\sqrt{\\frac{8 k_{B} T_{n}}{\\pi m_{D}}}\n$$\nThe problem specifies $T_{n} = 0.3 \\ \\text{eV}$. It instructs to convert this energy unit to Joules for the term $k_{B} T_{n}$ using the elementary charge $e = 1.6021766 \\times 10^{-19} \\ \\text{C}$.\n$$\nk_{B} T_{n} = (0.3 \\ \\text{eV}) \\times (1.6021766 \\times 10^{-19} \\ \\text{J/eV}) = 4.80653 \\times 10^{-20} \\ \\text{J}\n$$\nThe mass of a deuterium atom, $m_{D}$, is approximately $m_{D} \\approx 2.014 \\ \\text{u} \\approx 3.3445 \\times 10^{-27} \\ \\text{kg}$.\nSubstituting these values:\n$$\n\\langle v \\rangle_{n} = \\sqrt{\\frac{8 \\times (4.80653 \\times 10^{-20} \\ \\text{J})}{\\pi \\times (3.3445 \\times 10^{-27} \\ \\text{kg})}} \\approx \\sqrt{3.6596 \\times 10^{7} \\ \\text{m}^{2}\\,\\text{s}^{-2}} \\approx 6049.5 \\ \\text{m}\\,\\text{s}^{-1}\n$$\n\nNow we combine these results to calculate the mean free path $\\lambda_{\\text{ion}}$, using the given electron density $n_{e} = 3.0 \\times 10^{20} \\ \\text{m}^{-3}$.\n$$\n\\lambda_{\\text{ion}} = \\frac{\\langle v \\rangle_{n}}{n_{e} \\langle \\sigma_{\\text{ion}} v \\rangle} = \\frac{6049.5 \\ \\text{m}\\,\\text{s}^{-1}}{(3.0 \\times 10^{20} \\ \\text{m}^{-3}) \\times (1.1306 \\times 10^{-14} \\ \\text{m}^{3}\\,\\text{s}^{-1})}\n$$\n$$\n\\lambda_{\\text{ion}} = \\frac{6049.5}{3.3918 \\times 10^{6}} \\ \\text{m} \\approx 0.0017835 \\ \\text{m}\n$$\nRounding the result to three significant figures as requested:\n$$\n\\lambda_{\\text{ion}} \\approx 1.78 \\times 10^{-3} \\ \\text{m}\n$$\n\nFinally, we classify the neutral transport regime by comparing this mean free path to the characteristic dimension of the system, the divertor leg connection length $L_{\\text{div}} = 0.50 \\ \\text{m}$. We compute the dimensionless ratio $\\lambda_{\\text{ion}} / L_{\\text{div}}$:\n$$\n\\frac{\\lambda_{\\text{ion}}}{L_{\\text{div}}} = \\frac{1.78 \\times 10^{-3} \\ \\text{m}}{0.50 \\ \\text{m}} = 0.00356\n$$\nAccording to the provided classification scheme, a regime is considered \"local\" if $\\lambda_{\\text{ion}}/L_{\\text{div}} \\leq 0.1$. Since our calculated ratio of $0.00356$ satisfies this condition, the neutral transport is in the local, or diffusive, regime. This physical result implies that the neutral atoms are ionized very close to the divertor plate where they are produced, and their transport can be adequately described by a fluid model rather than a more complex kinetic (ballistic) treatment. This is a characteristic feature of a high-density, high-recycling divertor.",
            "answer": "$$\n\\boxed{1.78 \\times 10^{-3}}\n$$"
        },
        {
            "introduction": "Modern computational science involves the systematic integration of physics-based models with experimental data. This advanced practice moves beyond simple calculations into the realm of statistical inference, introducing a Bayesian framework for estimating the recycling coefficient, $R$, from diagnostic measurements . You will implement a complete computational workflow, from generating synthetic 'experimental' data based on a forward model to applying Bayesian principles to find the most probable value of $R$ and its posterior uncertainty. This exercise provides hands-on experience in how prior knowledge and new data are formally combined to refine our understanding of physical parameters, a core skill in model validation and data analysis in fusion science.",
            "id": "4019706",
            "problem": "Consider a simplified neutral recycling model for a divertor plate in a tokamak, posed as a statistically well-defined inference problem for the recycling coefficient. The divertor ion flux to the plate is denoted by $\\Gamma_i$ with units $\\mathrm{m}^{-2}\\mathrm{s}^{-1}$. The neutral source density near the plate is modeled as $S = R \\Gamma_i / \\Delta$, where $R$ is the dimensionless recycling coefficient satisfying $0 \\le R \\le 1$, and $\\Delta$ is a characteristic recycling layer thickness with units $\\mathrm{m}$. In a zero-dimensional steady-state slab approximation, the neutral density $n_n$ satisfies a source-loss balance\n$$\nS = \\frac{n_n}{\\tau_{\\mathrm{loss}}} + k_i n_e n_n,\n$$\nwhere $\\tau_{\\mathrm{loss}}$ is a neutral loss time with units $\\mathrm{s}$, $n_e$ is the electron density with units $\\mathrm{m}^{-3}$, and $k_i$ is an effective ionization rate coefficient with units $\\mathrm{m}^3\\mathrm{s}^{-1}$. The observable along chord $j$ is modeled as a line-integrated brightness $y_j$ that is proportional to the local neutral density with a known geometric weighting $\\alpha_j$ (dimensionless), plus additive measurement noise:\n$$\ny_j = \\alpha_j n_n + \\varepsilon_j.\n$$\nAssume independent Gaussian measurement noise with zero mean and variance $\\sigma^2$, i.e., $\\varepsilon_j \\sim \\mathcal{N}(0,\\sigma^2)$ and $\\mathrm{Cov}(\\varepsilon) = \\sigma^2 I$. Under the slab model above, $n_n$ is proportional to $R$ and one can write the forward model compactly as\n$$\n\\mathbf{y} = \\mathbf{c} R + \\boldsymbol{\\varepsilon},\n$$\nwhere the vector $\\mathbf{c}$ has components\n$$\nc_j = \\alpha_j \\frac{\\Gamma_i / \\Delta}{\\tau_{\\mathrm{loss}}^{-1} + k_i n_e},\n$$\nand $\\boldsymbol{\\varepsilon}$ is the noise vector.\n\nAssume a Gaussian prior on $R$, $R \\sim \\mathcal{N}(\\mu_0,\\sigma_0^2)$, which expresses prior knowledge that $R$ is near $\\mu_0$ with uncertainty $\\sigma_0$. Your task is to generate synthetic data for $\\mathbf{y}$ using known parameter values and a fixed true recycling coefficient $R_{\\mathrm{true}}$ for each test case, and then compute:\n- the maximum a posteriori (MAP) estimate of $R$, and\n- the posterior covariance of $R$ (for a scalar parameter, the covariance reduces to the posterior variance).\n\nUse the following physically plausible global parameters, common to all test cases:\n- $\\Gamma_i = 10^{22}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-1}$,\n- $\\Delta = 5 \\times 10^{-3}\\ \\mathrm{m}$,\n- $\\tau_{\\mathrm{loss}} = 10^{-3}\\ \\mathrm{s}$,\n- $n_e = 5 \\times 10^{19}\\ \\mathrm{m}^{-3}$,\n- $k_i = 10^{-13}\\ \\mathrm{m}^3\\mathrm{s}^{-1}$.\n\nSynthetic data generation must use a fixed pseudorandom number generator seed of $12345$ so results are reproducible. For each test case, construct $\\mathbf{y}$ via $y_j = c_j R_{\\mathrm{true}} + \\varepsilon_j$ with $\\varepsilon_j \\sim \\mathcal{N}(0,\\sigma^2)$ independently for each $j$.\n\nProvide the results for the following test suite of parameter sets, each specified by the tuple $(R_{\\mathrm{true}}, \\{\\alpha_j\\}_{j=1}^J, \\sigma, \\mu_0, \\sigma_0)$:\n\n- Test case A (moderate noise, multiple chords, data informative):\n  - $R_{\\mathrm{true}} = 0.95$,\n  - $\\{\\alpha_j\\} = \\{0.80, 1.10, 0.90, 1.20, 0.70\\}$ with $J=5$,\n  - $\\sigma = 1.0 \\times 10^{16}$,\n  - $\\mu_0 = 0.90$,\n  - $\\sigma_0 = 0.10$.\n\n- Test case B (high noise, few chords, strong prior):\n  - $R_{\\mathrm{true}} = 0.85$,\n  - $\\{\\alpha_j\\} = \\{0.50, 0.60\\}$ with $J=2$,\n  - $\\sigma = 5.0 \\times 10^{16}$,\n  - $\\mu_0 = 0.90$,\n  - $\\sigma_0 = 0.05$.\n\n- Test case C (low noise, many chords, weak prior):\n  - $R_{\\mathrm{true}} = 0.98$,\n  - $\\{\\alpha_j\\} = \\{0.90, 1.00, 1.10, 0.95, 1.05, 0.85, 1.15, 1.20, 0.80, 0.92\\}$ with $J=10$,\n  - $\\sigma = 5.0 \\times 10^{15}$,\n  - $\\mu_0 = 0.80$,\n  - $\\sigma_0 = 0.50$.\n\n- Test case D (very high noise, some zero-weight chords, tight prior):\n  - $R_{\\mathrm{true}} = 0.92$,\n  - $\\{\\alpha_j\\} = \\{1.00, 0.00, 1.00, 0.00, 1.00\\}$ with $J=5$,\n  - $\\sigma = 1.0 \\times 10^{17}$,\n  - $\\mu_0 = 0.95$,\n  - $\\sigma_0 = 0.02$.\n\nAll quantities involving $R$ and the estimates are dimensionless. Express the MAP estimate and the posterior uncertainty as decimal numbers with no units. Your program must:\n\n- Use the specified global physical parameters to construct $\\mathbf{c}$,\n- Generate synthetic $\\mathbf{y}$ using the fixed seed $12345$ and the noise level $\\sigma$ of each test,\n- Compute the MAP estimate of $R$ and the posterior variance of $R$ from the Gaussian posterior implied by the linear-Gaussian likelihood and the Gaussian prior,\n- Return, for each test case, the pair consisting of the MAP estimate and the posterior standard deviation (the square root of the posterior variance) in that order.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list should contain the pairs for the test cases in the order A, B, C, D, flattened into a single list. Concretely, the output must be of the form\n$$\n[\\widehat{R}_A, s_A, \\widehat{R}_B, s_B, \\widehat{R}_C, s_C, \\widehat{R}_D, s_D],\n$$\nwhere $\\widehat{R}$ denotes the MAP estimate and $s$ denotes the posterior standard deviation for each respective test case. No other text should be printed.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and self-contained. It describes a standard Bayesian parameter estimation task for a linear-Gaussian model, for which an analytical solution exists.\n\nThe problem requires us to estimate the recycling coefficient $R$ from a set of noisy measurements $\\mathbf{y}$. The relationship between the parameter $R$ and the measurements is given by the linear forward model:\n$$\n\\mathbf{y} = \\mathbf{c} R + \\boldsymbol{\\varepsilon}\n$$\nwhere $\\mathbf{y}$ is the vector of $J$ observations $\\{y_j\\}$, $\\mathbf{c}$ is a vector of known coefficients, $R$ is the scalar parameter to be inferred, and $\\boldsymbol{\\varepsilon}$ is the vector of measurement noise.\n\nThe problem is framed within a Bayesian context. We are given a prior distribution for $R$ and a likelihood function defined by the forward model and noise characteristics.\n\nThe prior distribution for $R$ is given as a Gaussian:\n$$\np(R) = \\mathcal{N}(R | \\mu_0, \\sigma_0^2) = \\frac{1}{\\sqrt{2\\pi\\sigma_0^2}} \\exp\\left(-\\frac{(R-\\mu_0)^2}{2\\sigma_0^2}\\right)\n$$\nwhere $\\mu_0$ and $\\sigma_0^2$ are the prior mean and variance, respectively.\n\nThe measurement noise for each channel $j$ is assumed to be independent and identically distributed according to a zero-mean Gaussian distribution, $\\varepsilon_j \\sim \\mathcal{N}(0, \\sigma^2)$. This leads to the likelihood function, which is the probability of observing the data $\\mathbf{y}$ given a value of $R$:\n$$\np(\\mathbf{y}|R) = \\mathcal{N}(\\mathbf{y} | \\mathbf{c}R, \\sigma^2 I) = \\frac{1}{(2\\pi\\sigma^2)^{J/2}} \\exp\\left(-\\frac{(\\mathbf{y}-\\mathbf{c}R)^T(\\mathbf{y}-\\mathbf{c}R)}{2\\sigma^2}\\right)\n$$\nwhere $I$ is the $J \\times J$ identity matrix.\n\nAccording to Bayes' theorem, the posterior distribution for $R$ is proportional to the product of the likelihood and the prior:\n$$\np(R|\\mathbf{y}) \\propto p(\\mathbf{y}|R) p(R)\n$$\nSince both the prior and the likelihood are Gaussian functions of $R$, their product (and thus the posterior) will also be a Gaussian distribution. Let the posterior be $p(R|\\mathbf{y}) = \\mathcal{N}(R | \\mu_N, \\sigma_N^2)$. Our goal is to find the posterior mean $\\mu_N$ and the posterior variance $\\sigma_N^2$.\n\nThe log-posterior is proportional to the sum of the log-likelihood and the log-prior, ignoring terms that do not depend on $R$:\n$$\n\\ln p(R|\\mathbf{y}) \\propto -\\frac{1}{2\\sigma^2}(\\mathbf{y}-\\mathbf{c}R)^T(\\mathbf{y}-\\mathbf{c}R) - \\frac{1}{2\\sigma_0^2}(R-\\mu_0)^2\n$$\nExpanding the quadratic terms in $R$:\n$$\n\\ln p(R|\\mathbf{y}) \\propto -\\frac{1}{2\\sigma^2}(\\mathbf{y}^T\\mathbf{y} - 2R\\mathbf{y}^T\\mathbf{c} + R^2\\mathbf{c}^T\\mathbf{c}) - \\frac{1}{2\\sigma_0^2}(R^2 - 2R\\mu_0 + \\mu_0^2)\n$$\nCollecting terms in $R^2$ and $R$:\n$$\n\\ln p(R|\\mathbf{y}) \\propto -\\frac{1}{2}\\left[ \\left(\\frac{\\mathbf{c}^T\\mathbf{c}}{\\sigma^2} + \\frac{1}{\\sigma_0^2}\\right)R^2 - 2\\left(\\frac{\\mathbf{y}^T\\mathbf{c}}{\\sigma^2} + \\frac{\\mu_0}{\\sigma_0^2}\\right)R \\right]\n$$\nBy comparing this to the exponent of a general Gaussian distribution $\\mathcal{N}(\\mu, \\sigma^2)$, which has the form $-\\frac{1}{2\\sigma^2}(R-\\mu)^2 = -\\frac{1}{2\\sigma^2}(R^2 - 2R\\mu + \\mu^2)$, we can identify the inverse posterior variance (also known as the posterior precision, $\\lambda_N$) and the posterior mean $\\mu_N$.\n\nThe term multiplying $R^2$ gives the posterior precision:\n$$\n\\lambda_N = \\sigma_N^{-2} = \\frac{\\mathbf{c}^T\\mathbf{c}}{\\sigma^2} + \\frac{1}{\\sigma_0^2}\n$$\nThis shows that the posterior precision is the sum of the data precision (from the likelihood) and the prior precision. The posterior variance is the reciprocal of the precision:\n$$\n\\sigma_N^2 = \\left( \\frac{\\mathbf{c}^T\\mathbf{c}}{\\sigma^2} + \\frac{1}{\\sigma_0^2} \\right)^{-1}\n$$\nThe posterior mean $\\mu_N$ is found from the term linear in $R$, such that $\\sigma_N^{-2}\\mu_N = \\left(\\frac{\\mathbf{y}^T\\mathbf{c}}{\\sigma^2} + \\frac{\\mu_0}{\\sigma_0^2}\\right)$. Thus:\n$$\n\\mu_N = \\sigma_N^2 \\left( \\frac{\\mathbf{y}^T\\mathbf{c}}{\\sigma^2} + \\frac{\\mu_0}{\\sigma_0^2} \\right)\n$$\nFor a Gaussian posterior, the maximum a posteriori (MAP) estimate is equal to the posterior mean, $\\widehat{R}_{\\mathrm{MAP}} = \\mu_N$. The posterior uncertainty required is the standard deviation, $s = \\sqrt{\\sigma_N^2} = \\sigma_N$.\n\nThe computational procedure is as follows:\n1.  Using the provided global physical parameters $\\Gamma_i=10^{22}$, $\\Delta=5\\times10^{-3}$, $\\tau_{\\mathrm{loss}}=10^{-3}$, $n_e=5\\times10^{19}$, and $k_i=10^{-13}$, we first calculate the constant factor $C_0$ that relates the components of $\\mathbf{c}$ to the geometric weights $\\alpha_j$:\n    $$\n    C_0 = \\frac{\\Gamma_i / \\Delta}{\\tau_{\\mathrm{loss}}^{-1} + k_i n_e} = \\frac{10^{22} / (5 \\times 10^{-3})}{1/10^{-3} + (10^{-13} \\times 5 \\times 10^{19})} \\approx 3.9992 \\times 10^{17}\n    $$\n2.  For each test case, specified by $(R_{\\mathrm{true}}, \\{\\alpha_j\\}_{j=1}^J, \\sigma, \\mu_0, \\sigma_0)$:\n    a. Construct the vector $\\mathbf{c}$ with components $c_j = \\alpha_j C_0$.\n    b. Initialize a pseudorandom number generator with a fixed seed of $12345$.\n    c. Generate a noise vector $\\boldsymbol{\\varepsilon}$ of size $J$ by drawing from $\\mathcal{N}(0, \\sigma^2)$.\n    d. Synthesize the measurement data vector $\\mathbf{y} = \\mathbf{c} R_{\\mathrm{true}} + \\boldsymbol{\\varepsilon}$.\n    e. Calculate the scalar products $\\mathbf{c}^T\\mathbf{c} = \\sum_{j=1}^J c_j^2$ and $\\mathbf{y}^T\\mathbf{c} = \\sum_{j=1}^J y_j c_j$.\n    f. Use these quantities and the given prior parameters $(\\mu_0, \\sigma_0^2)$ and noise variance $\\sigma^2$ to compute the posterior variance $\\sigma_N^2$ and the MAP estimate $\\widehat{R}_{\\mathrm{MAP}} = \\mu_N$ using the derived formulas.\n    g. The posterior standard deviation is $s_N = \\sqrt{\\sigma_N^2}$.\n3.  The results for each test case, $(\\widehat{R}_{\\mathrm{MAP}}, s_N)$, are collected and formatted into a single list as specified.",
            "answer": "$$\n\\boxed{[0.9464, 0.01311, 0.8845, 0.04359, 0.9789, 0.004994, 0.9416, 0.01992]}\n$$"
        }
    ]
}