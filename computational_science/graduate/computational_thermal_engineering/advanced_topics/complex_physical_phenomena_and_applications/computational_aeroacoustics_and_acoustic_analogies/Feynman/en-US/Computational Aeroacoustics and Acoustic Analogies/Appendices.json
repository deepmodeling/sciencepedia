{
    "hands_on_practices": [
        {
            "introduction": "The fidelity of any aeroacoustic simulation hinges on its ability to accurately propagate waves. This foundational practice in numerical analysis for Computational Aeroacoustics (CAA) involves using Fourier analysis to derive the modified wavenumber for a standard finite-difference scheme. By quantifying the resulting numerical dispersion, you will gain a critical understanding of the errors inherent in discretizing the wave equation and how to assess the performance of wave propagation solvers .",
            "id": "3940989",
            "problem": "In Computational Aeroacoustics (CAA), accurate propagation of acoustic waves is fundamental for predicting sound generated by turbulent flows via acoustic analogies such as Lighthill’s analogy. Consider one-dimensional, small-amplitude acoustics in a uniform, quiescent medium where the acoustic pressure perturbation $p'(x,t)$ satisfies the linear wave equation derived from the linearized compressible Euler equations under isentropic assumptions,\n$$\\frac{\\partial^{2} p'}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} p'}{\\partial x^{2}},$$\nwith $c$ the speed of sound. On a uniform grid with spacing $\\Delta x$, let the spatial second derivative be approximated by the standard three-point, second-order central difference stencil,\n$$\\left.\\frac{\\partial^{2} p'}{\\partial x^{2}}\\right|_{x_i} \\approx \\frac{p'(x_{i+1},t) - 2\\,p'(x_{i},t) + p'(x_{i-1},t)}{\\Delta x^{2}},$$\nand adopt a semi-discrete formulation in which time remains continuous. For a plane acoustic wave\n$$p'(x,t) = \\cos(k x - \\omega t),$$\nwith real wavenumber $k$ and real angular frequency $\\omega$, assume the discrete Fourier mode $p'_i(t) = \\Re\\{\\hat{p}\\,\\exp(i(i\\,\\theta - \\omega t))\\}$, where $x_i = i\\,\\Delta x$, $\\theta = k\\,\\Delta x$, and $\\hat{p}$ is a complex amplitude. Starting from the above governing equation and stencil, and using Fourier analysis, derive the modified wavenumber $k^{*}$ defined by the semi-discrete dispersion relation $\\omega^{2} = c^{2} \\left(k^{*}\\right)^{2}$ and quantify the numerical phase speed error and amplitude (dissipation) error for the plane wave. Explicitly express the phase speed error in terms of $k$ and $\\Delta x$, and determine whether the semi-discrete scheme introduces any amplitude error.\n\nReport your final result as the closed-form analytic expression for $k^{*}$ in terms of $k$ and $\\Delta x$. No numerical evaluation is required, and no rounding is needed. Do not include units in the final expression.",
            "solution": "The problem is subjected to validation and is deemed valid as it is scientifically grounded, well-posed, and objective. It presents a standard problem in the analysis of numerical methods for wave propagation, a core topic in computational aeroacoustics. All necessary information is provided, and the problem is free of contradictions or vagueness.\n\nWe begin with the semi-discrete approximation of the 1-dimensional linear wave equation. The governing partial differential equation is\n$$\n\\frac{\\partial^{2} p'}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} p'}{\\partial x^{2}}\n$$\nwhere $p'(x,t)$ is the acoustic pressure perturbation and $c$ is the constant speed of sound.\nThe spatial domain is discretized on a uniform grid with points $x_i = i\\,\\Delta x$, where $i$ is an integer index and $\\Delta x$ is the grid spacing. The spatial second derivative at grid point $x_i$ is approximated by the 2nd-order, 3-point central difference stencil:\n$$\n\\left.\\frac{\\partial^{2} p'}{\\partial x^{2}}\\right|_{x_i} \\approx \\frac{p'(x_{i+1},t) - 2\\,p'(x_{i},t) + p'(x_{i-1},t)}{\\Delta x^{2}}\n$$\nSubstituting this approximation into the wave equation yields the semi-discrete ordinary differential equation for the pressure perturbation at each grid point, $p'_i(t) \\equiv p'(x_i, t)$:\n$$\n\\frac{d^{2} p'_i}{d t^{2}} = \\frac{c^{2}}{\\Delta x^{2}} \\left( p'_{i+1} - 2\\,p'_i + p'_{i-1} \\right)\n$$\nTo analyze the properties of this numerical scheme, we perform a Fourier analysis by substituting a single Fourier mode solution. The problem provides the form of a discrete Fourier mode as $p'_i(t) = \\Re\\{\\hat{p}\\,\\exp(i(i\\,\\theta - \\omega t))\\}$, where $\\theta = k\\,\\Delta x$. For linear equations, we can work with the complex form and take the real part at the end. Let the trial solution be:\n$$\np'_j(t) = \\hat{p} \\exp\\left(i(j k \\Delta x - \\omega t)\\right)\n$$\nfor any grid point index $j$. Here, $k$ is the wavenumber and $\\omega$ is the angular frequency.\nThe values at neighboring points are then:\n$$\np'_{i+1}(t) = \\hat{p} \\exp\\left(i((i+1)k \\Delta x - \\omega t)\\right) = p'_i(t) \\exp(i k \\Delta x)\n$$\n$$\np'_{i-1}(t) = \\hat{p} \\exp\\left(i((i-1)k \\Delta x - \\omega t)\\right) = p'_i(t) \\exp(-i k \\Delta x)\n$$\nThe time derivative on the left-hand side (LHS) is:\n$$\n\\frac{d^{2} p'_i}{d t^{2}} = \\frac{d^{2}}{d t^{2}} \\left[ \\hat{p} \\exp\\left(i(i k \\Delta x - \\omega t)\\right) \\right] = (-i\\omega)^{2} p'_i(t) = -\\omega^{2} p'_i(t)\n$$\nThe right-hand side (RHS) becomes:\n$$\n\\text{RHS} = \\frac{c^{2}}{\\Delta x^{2}} \\left( p'_i(t)\\exp(i k \\Delta x) - 2\\,p'_i(t) + p'_i(t)\\exp(-i k \\Delta x) \\right)\n$$\n$$\n\\text{RHS} = \\frac{c^{2} p'_i(t)}{\\Delta x^{2}} \\left( \\exp(i k \\Delta x) + \\exp(-i k \\Delta x) - 2 \\right)\n$$\nUsing Euler's formula, $\\exp(iz) + \\exp(-iz) = 2\\cos(z)$, the expression simplifies to:\n$$\n\\text{RHS} = \\frac{c^{2} p'_i(t)}{\\Delta x^{2}} \\left( 2\\cos(k \\Delta x) - 2 \\right) = \\frac{2c^{2} p'_i(t)}{\\Delta x^{2}} \\left( \\cos(k \\Delta x) - 1 \\right)\n$$\nEmploying the trigonometric half-angle identity $1 - \\cos(z) = 2\\sin^{2}(z/2)$, we get:\n$$\n\\text{RHS} = \\frac{2c^{2} p'_i(t)}{\\Delta x^{2}} \\left( -2\\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\right) = -\\frac{4c^{2} p'_i(t)}{\\Delta x^{2}} \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nEquating the LHS and RHS and dividing by $p'_i(t)$ (which is non-zero), we obtain the numerical dispersion relation for the semi-discrete scheme:\n$$\n-\\omega^{2} = -\\frac{4c^{2}}{\\Delta x^{2}} \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\omega^{2} = \\frac{4c^{2}}{\\Delta x^{2}} \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nThe problem defines the modified wavenumber, $k^{*}$, such that the numerical dispersion relation mimics the form of the exact dispersion relation, $\\omega^{2} = c^{2} k^{2}$, but with $k$ replaced by $k^{*}$:\n$$\n\\omega^{2} = c^{2} (k^{*})^{2}\n$$\nBy comparing this definition with our derived numerical dispersion relation, we can identify $(k^{*})^{2}$:\n$$\nc^{2} (k^{*})^{2} = \\frac{4c^{2}}{\\Delta x^{2}} \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\implies (k^{*})^{2} = \\frac{4}{\\Delta x^{2}} \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nTaking the principal square root (assuming $\\Delta x > 0$ and waves are spatially resolved, i.e., $0 \\le k \\Delta x \\le \\pi$, which ensures $\\sin(k\\Delta x/2) \\ge 0$), we find the expression for the modified wavenumber $k^{*}$:\n$$\nk^{*} = \\frac{2}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n\nNow we quantify the numerical errors.\nAmplitude (dissipation) error: The amplitude of a wave component changes if the modified wavenumber $k^{*}$ has a non-zero imaginary part. In our case, for any real wavenumber $k$ and real grid spacing $\\Delta x$, the sine function produces a real value. Thus, $k^{*}$ is purely real. This implies that the imaginary part of the modified wavenumber is zero, $\\Im(k^{*}) = 0$. Consequently, there is no artificial amplification or damping of the wave amplitude. The semi-discrete scheme using a central difference stencil is purely dispersive and introduces no amplitude (dissipation) error.\n\nPhase speed error: The exact physical system is non-dispersive, with a phase speed $c_{ph,exact} = \\omega/k = c$ for all wavenumbers. The numerical phase speed, $c_{ph,num}$, is given by $c_{ph,num} = \\omega/k$. Using the numerical dispersion relation $\\omega = c k^{*}$, we have:\n$$\nc_{ph,num} = \\frac{\\omega}{k} = \\frac{c k^{*}}{k} = \\frac{c}{k} \\left( \\frac{2}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right)\n$$\nRearranging this expression gives the phase speed error in terms of $k$ and $\\Delta x$, typically expressed as a ratio to the exact speed of sound $c$:\n$$\n\\frac{c_{ph,num}}{c} = \\frac{2}{k \\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) = \\frac{\\sin\\left(\\frac{k \\Delta x}{2}\\right)}{\\frac{k \\Delta x}{2}}\n$$\nThis ratio is the sinc function, $\\text{sinc}(k\\Delta x/2)$. Since for any argument $z > 0$, $\\text{sinc}(z) < 1$, the numerical phase speed is always less than the exact speed of sound $c$ (except in the limit $k\\Delta x \\to 0$). This is a lagging phase error. The error depends on the dimensionless group $k\\Delta x$, which signifies that the scheme is dispersive: different wavenumbers travel at different speeds, causing wave packets to distort as they propagate.\n\nThe problem asks for the closed-form analytic expression for $k^{*}$ as the final result.",
            "answer": "$$\n\\boxed{\\frac{2}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)}\n$$"
        },
        {
            "introduction": "With a grasp of numerical wave properties, we now turn to the physical interaction between sound and non-uniform mean flows. This practice delves into the phenomenon of acoustic refraction, where you will apply the high-frequency Wentzel–Kramers–Brillouin (WKB) approximation to derive the path of an acoustic ray through a shear layer. This analytical exercise illuminates a key physical effect that advanced CAA simulations must accurately predict, demonstrating how mean flow gradients can bend sound waves .",
            "id": "3948674",
            "problem": "Consider a two-dimensional, inviscid, isentropic, barotropic compressible flow with uniform mean density and a spatially uniform speed of sound $c$. The steady mean velocity field is $\\bar{\\mathbf{u}}(y) = S y\\,\\mathbf{e}_{x}$, where $S$ is a constant shear rate and $\\mathbf{e}_{x}$ is the unit vector in the streamwise direction. A small-amplitude, time-harmonic acoustic disturbance of angular frequency $\\omega$ is incident from $y=0$, where the mean flow is $\\bar{\\mathbf{u}}(0)=\\mathbf{0}$. At $y=0$, the acoustic wavevector $\\mathbf{k}_{0}$ makes an initial angle $\\theta_{0}$ with the $x$-axis, with $0<\\theta_{0}<\\pi/2$, and the wave subsequently traverses the shear layer over the interval $0\\le y\\le H$.\n\nStarting from the linearized Euler equations about the given mean flow and invoking a high-frequency (Wentzel–Kramers–Brillouin (WKB)) ray approximation appropriate to slowly varying bases, derive the leading-order dispersion relation for acoustic waves in a moving medium and the associated ray equations. Use these to show that spatial gradients of the mean flow $\\nabla\\bar{\\mathbf{u}}$ refract acoustic waves by rotating the local wavevector, and compute the bending angle $\\Delta\\theta$ of the wavevector as the net change in its direction between $y=0$ and $y=H$, to first order in the small parameter $|S|H/c\\ll 1$. Express the final bending angle $\\Delta\\theta$ in radians and as a closed-form analytic expression in terms of $S$, $H$, $c$, and $\\theta_{0}$. No numerical evaluation is required.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n-   **Flow conditions**: Two-dimensional, inviscid, isentropic, barotropic compressible flow.\n-   **Mean density**: Uniform, $\\bar{\\rho} = \\text{constant}$.\n-   **Speed of sound**: Spatially uniform, $c = \\text{constant}$.\n-   **Mean velocity field**: $\\bar{\\mathbf{u}}(y) = S y\\,\\mathbf{e}_{x}$, where $S$ is a constant shear rate.\n-   **Disturbance**: Small-amplitude, time-harmonic acoustic disturbance with angular frequency $\\omega$.\n-   **Initial condition**: At $y=0$, the mean flow is $\\bar{\\mathbf{u}}(0)=\\mathbf{0}$. The incident acoustic wavevector $\\mathbf{k}_{0}$ makes an angle $\\theta_{0}$ with the $x$-axis, where $0<\\theta_{0}<\\pi/2$.\n-   **Domain**: The wave propagates through the shear layer from $y=0$ to $y=H$.\n-   **Approximation**: A high-frequency Wentzel–Kramers–Brillouin (WKB) ray approximation is to be used.\n-   **Small parameter**: The analysis is to be performed to first order in $|S|H/c\\ll 1$.\n-   **Objective**: Derive the dispersion relation and ray equations, demonstrate refraction, and compute the net bending angle $\\Delta\\theta$ of the wavevector between $y=0$ and $y=H$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem is a standard exercise in aeroacoustics, concerning the propagation of sound through a non-uniform mean flow. It is based on the fundamental principles of fluid dynamics (Euler equations) and wave mechanics (WKB approximation, ray theory). The simple shear flow is a canonical model for studying such refraction effects. The problem is scientifically sound.\n2.  **Well-Posedness**: The physical setup, boundary conditions at incidence, and the specific approximations to be used are clearly defined. The objectives are specific and quantifiable, leading to a unique solution within the specified approximation.\n3.  **Objectivity**: The problem is stated using precise, objective, and standard terminology from physics and mathematics.\n4.  **Consistency**: The mean flow $\\bar{\\mathbf{u}}(y) = S y\\,\\mathbf{e}_{x}$ with constant mean density $\\bar{\\rho}$ and sound speed $c$ (implying constant mean pressure $\\bar{p}$) is a valid steady solution of the Euler equations, as $(\\bar{\\mathbf{u}}\\cdot\\nabla)\\bar{\\mathbf{u}} = \\mathbf{0}$, satisfying $\\bar{\\rho}(\\bar{\\mathbf{u}}\\cdot\\nabla)\\bar{\\mathbf{u}} = -\\nabla\\bar{p} = \\mathbf{0}$. The setup is internally consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nWe begin with the linearized Euler equations for an inviscid, barotropic compressible flow. The variables are decomposed into a steady mean component (overbar) and a small acoustic perturbation (prime): $\\rho = \\bar{\\rho} + \\rho'$, $p = \\bar{p} + p'$, $\\mathbf{u} = \\bar{\\mathbf{u}} + \\mathbf{u}'$. Given that the mean flow is steady with uniform $\\bar{\\rho}$ and $c$ (implying uniform $\\bar{p}$), the linearized continuity and momentum equations are:\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\bar{\\mathbf{u}} \\cdot \\nabla \\rho' + \\rho' \\nabla \\cdot \\bar{\\mathbf{u}} + \\bar{\\rho} \\nabla \\cdot \\mathbf{u}' + \\mathbf{u}' \\cdot \\nabla \\bar{\\rho} = 0\n$$\n$$\n\\bar{\\rho}\\left(\\frac{\\partial \\mathbf{u}'}{\\partial t} + \\bar{\\mathbf{u}} \\cdot \\nabla \\mathbf{u}' + (\\mathbf{u}' \\cdot \\nabla)\\bar{\\mathbf{u}}\\right) = -\\nabla p'\n$$\nFor the given mean flow $\\bar{\\mathbf{u}} = (Sy, 0, 0)$, we have $\\nabla \\cdot \\bar{\\mathbf{u}} = 0$. With $\\bar{\\rho}$ being constant, $\\nabla\\bar{\\rho}=\\mathbf{0}$. The barotropic relation $p' = c^2 \\rho'$ (with constant $c$) allows us to replace $\\rho'$. The equations simplify to:\n$$\n\\frac{1}{c^2}\\left(\\frac{\\partial p'}{\\partial t} + \\bar{\\mathbf{u}} \\cdot \\nabla p'\\right) + \\bar{\\rho} \\nabla \\cdot \\mathbf{u}' = 0\n$$\n$$\n\\bar{\\rho}\\left(\\frac{\\partial \\mathbf{u}'}{\\partial t} + \\bar{\\mathbf{u}} \\cdot \\nabla \\mathbf{u}' + (\\mathbf{u}' \\cdot \\nabla)\\bar{\\mathbf{u}}\\right) = -\\nabla p'\n$$\nThe term $(\\mathbf{u}' \\cdot \\nabla)\\bar{\\mathbf{u}}$ represents the interaction of the acoustic velocity with the mean flow gradient. For $\\bar{\\mathbf{u}} = Sy\\,\\mathbf{e}_x$, this term is $(u'_y \\partial_y (Sy)) \\mathbf{e}_x = S u'_y \\mathbf{e}_x$.\n\nWe now invoke the WKB approximation, assuming a locally plane wave solution of the form $f'(\\mathbf{x},t) \\propto \\exp(i(\\phi(\\mathbf{x}) - \\omega t))$, where the local wavevector is $\\mathbf{k}(\\mathbf{x}) = \\nabla\\phi$. In the high-frequency limit, derivatives are replaced by algebraic terms: $\\nabla \\to i\\mathbf{k}$ and $\\partial/\\partial t \\to -i\\omega$. The linearized equations become:\n$$\n\\frac{1}{c^2}(-i\\omega p' + i(\\mathbf{k} \\cdot \\bar{\\mathbf{u}})p') + \\bar{\\rho} (i\\mathbf{k} \\cdot \\mathbf{u}') = 0\n$$\n$$\n\\bar{\\rho}(-i\\omega \\mathbf{u}' + i(\\mathbf{k} \\cdot \\bar{\\mathbf{u}})\\mathbf{u}' + S u'_y \\mathbf{e}_x) = -i\\mathbf{k}p'\n$$\nLet $\\omega_e = \\omega - \\mathbf{k} \\cdot \\bar{\\mathbf{u}}$ be the intrinsic frequency in the frame moving with the local mean flow. The algebraic system is:\n$$\n(\\mathbf{k} \\cdot \\mathbf{u}') = \\frac{\\omega_e}{\\bar{\\rho}c^2} p'\n$$\n$$\n-\\omega_e \\mathbf{u}' - i S u'_y \\mathbf{e}_x = \\frac{\\mathbf{k}}{\\bar{\\rho}} p'\n$$\nWriting the momentum equation in components ($u'_x, u'_y$):\n$$\n-\\omega_e u'_x - i S u'_y = \\frac{k_x}{\\bar{\\rho}} p'\n$$\n$$\n-\\omega_e u'_y = \\frac{k_y}{\\bar{\\rho}} p' \\implies u'_y = -\\frac{k_y}{\\bar{\\rho}\\omega_e} p'\n$$\nSubstituting $u'_y$ into the $x$-momentum equation:\n$$\n-\\omega_e u'_x - i S \\left(-\\frac{k_y}{\\bar{\\rho}\\omega_e} p'\\right) = \\frac{k_x}{\\bar{\\rho}} p' \\implies u'_x = -\\frac{k_x}{\\bar{\\rho}\\omega_e} p' - i\\frac{S k_y}{\\bar{\\rho}\\omega_e^2} p'\n$$\nSubstitute $u'_x$ and $u'_y$ into the continuity equation:\n$$\nk_x \\left(-\\frac{k_x}{\\bar{\\rho}\\omega_e} - i\\frac{S k_y}{\\bar{\\rho}\\omega_e^2}\\right) p' + k_y \\left(-\\frac{k_y}{\\bar{\\rho}\\omega_e}\\right) p' = \\frac{\\omega_e}{\\bar{\\rho}c^2} p'\n$$\nDividing by $p'/\\bar{\\rho}$ and simplifying:\n$$\n-\\frac{k_x^2}{\\omega_e} - i\\frac{S k_x k_y}{\\omega_e^2} - \\frac{k_y^2}{\\omega_e} = \\frac{\\omega_e}{c^2}\n$$\n$$\n-\\frac{k^2}{\\omega_e} - i\\frac{S k_x k_y}{\\omega_e^2} = \\frac{\\omega_e}{c^2} \\quad \\text{where } k^2 = k_x^2+k_y^2\n$$\nIn the WKB (high-frequency) limit, the term arising from the mean flow gradient is considered a small correction. The leading-order dispersion relation is obtained by neglecting the term with $S$:\n$$\n-\\frac{k^2}{\\omega_e} = \\frac{\\omega_e}{c^2} \\implies \\omega_e^2 = c^2 k^2\n$$\nSubstituting back $\\omega_e = \\omega - \\mathbf{k} \\cdot \\bar{\\mathbf{u}}$:\n$$\nD(\\omega, \\mathbf{k}, \\mathbf{x}) = (\\omega - \\mathbf{k} \\cdot \\bar{\\mathbf{u}})^2 - c^2 k^2 = 0\n$$\nThis is the leading-order dispersion relation for acoustic waves in a moving medium.\n\nThe ray equations are derived from this relation, which acts as a Hamiltonian. In a time-invariant medium, $\\omega$ is constant along a ray. The ray equations are:\n$$\n\\frac{d\\mathbf{x}}{dt} = -\\frac{\\partial D / \\partial \\mathbf{k}}{\\partial D / \\partial \\omega} \\quad \\text{(group velocity)}\n$$\n$$\n\\frac{d\\mathbf{k}}{dt} = \\frac{\\partial D / \\partial \\mathbf{x}}{\\partial D / \\partial \\omega} \\quad \\text{(refraction)}\n$$\nWe calculate the necessary partial derivatives, with $\\bar{\\mathbf{u}} = (Sy, 0, 0)$ and $\\mathbf{k} \\cdot \\bar{\\mathbf{u}} = k_x S y$:\n$$\n\\frac{\\partial D}{\\partial \\omega} = 2(\\omega - k_x S y) = 2\\omega_e\n$$\n$$\n\\frac{\\partial D}{\\partial k_x} = 2(\\omega - k_x S y)(-Sy) - 2c^2 k_x = -2\\omega_e S y - 2c^2 k_x\n$$\n$$\n\\frac{\\partial D}{\\partial k_y} = -2c^2 k_y\n$$\n$$\n\\frac{\\partial D}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial D}{\\partial y} = 2(\\omega - k_x S y)(-k_x S) = -2\\omega_e k_x S\n$$\nThe ray equations are:\n$$\n\\frac{dx}{dt} = -\\frac{-2\\omega_e S y - 2c^2 k_x}{2\\omega_e} = Sy + \\frac{c^2 k_x}{\\omega_e}\n$$\n$$\n\\frac{dy}{dt} = -\\frac{-2c^2 k_y}{2\\omega_e} = \\frac{c^2 k_y}{\\omega_e}\n$$\n$$\n\\frac{dk_x}{dt} = \\frac{0}{2\\omega_e} = 0 \\implies k_x = \\text{constant}\n$$\n$$\n\\frac{dk_y}{dt} = \\frac{-2\\omega_e k_x S}{2\\omega_e} = -S k_x\n$$\nThe equation $dk_y/dt = -S k_x$ shows that the $y$-component of the wavevector changes in time as it propagates through the shear layer. Since $S$ is the only non-zero component of the mean velocity gradient tensor $\\nabla\\bar{\\mathbf{u}}$, this explicitly demonstrates that gradients of the mean flow cause refraction of the acoustic wave.\n\nTo find the bending angle, we relate the change in wavevector components to the change in the angle $\\theta(y)$ where $\\tan\\theta = k_y/k_x$. The conservation of $k_x$ is key (Snell's Law for a horizontally stratified medium). Let $k_x(y) = k_{x0}$.\nFrom the dispersion relation, $\\omega_e = \\omega - k_{x0}Sy = \\pm c k = \\pm c\\sqrt{k_{x0}^2 + k_y^2}$. For a wave incident from $y=0$ and propagating into $y>0$, we take the positive root, $\\omega_e = ck$.\nAt $y=0$, $\\bar{\\mathbf{u}}=0$, so $\\omega_e(0)=\\omega$. Thus $\\omega = ck_0$, where $k_0 = |\\mathbf{k}_0|$.\nThe constant $k_{x0}$ is given by its initial value: $k_{x0} = k_0 \\cos\\theta_0 = (\\omega/c)\\cos\\theta_0$.\nThe wavevector angle $\\theta(y)$ is defined by $k_{x0} = k(y)\\cos\\theta(y)$.\nFrom the dispersion relation, $k(y) = \\omega_e/c = (\\omega-k_{x0}Sy)/c$.\nSubstituting $k(y)$ into the conservation law for $k_x$:\n$$\nk_{x0} = \\frac{\\omega - k_{x0}Sy}{c} \\cos\\theta(y)\n$$\nSolving for $\\cos\\theta(y)$:\n$$\n\\cos\\theta(y) = \\frac{c k_{x0}}{\\omega - k_{x0}Sy}\n$$\nSubstituting $k_{x0} = (\\omega/c)\\cos\\theta_0$:\n$$\n\\cos\\theta(y) = \\frac{c (\\omega/c)\\cos\\theta_0}{\\omega - ((\\omega/c)\\cos\\theta_0)Sy} = \\frac{\\omega\\cos\\theta_0}{\\omega(1 - (S/c)y\\cos\\theta_0)} = \\frac{\\cos\\theta_0}{1 - (S/c)y\\cos\\theta_0}\n$$\nThis is the exact expression for the angle's cosine as a function of $y$ under the WKB approximation. We want to find the bending angle $\\Delta\\theta = \\theta(H) - \\theta_0$ to first order in the small parameter $\\epsilon = |S|H/c \\ll 1$. Let's evaluate the expression at $y=H$:\n$$\n\\cos\\theta(H) = \\frac{\\cos\\theta_0}{1 - (SH/c)\\cos\\theta_0}\n$$\nSince $|SH/c| \\ll 1$, the term $(SH/c)\\cos\\theta_0$ is small. We use the Taylor expansion $(1-x)^{-1} \\approx 1+x$ for small $x$:\n$$\n\\cos\\theta(H) \\approx \\cos\\theta_0 \\left(1 + \\frac{SH}{c}\\cos\\theta_0\\right) = \\cos\\theta_0 + \\frac{SH}{c}\\cos^2\\theta_0\n$$\nNow, let $\\theta(H) = \\theta_0 + \\Delta\\theta$. For a small bending angle $\\Delta\\theta$, we expand $\\cos(\\theta_0+\\Delta\\theta) \\approx \\cos\\theta_0 - \\Delta\\theta\\sin\\theta_0$.\nEquating the two first-order approximations for $\\cos\\theta(H)$:\n$$\n\\cos\\theta_0 - \\Delta\\theta\\sin\\theta_0 \\approx \\cos\\theta_0 + \\frac{SH}{c}\\cos^2\\theta_0\n$$\n$$\n-\\Delta\\theta\\sin\\theta_0 \\approx \\frac{SH}{c}\\cos^2\\theta_0\n$$\nSolving for the bending angle $\\Delta\\theta$:\n$$\n\\Delta\\theta \\approx -\\frac{SH}{c} \\frac{\\cos^2\\theta_0}{\\sin\\theta_0}\n$$\nThis is the net change in the wavevector's direction between $y=0$ and $y=H$, to first order in $SH/c$.",
            "answer": "$$\n\\boxed{-\\frac{SH \\cos^{2}(\\theta_{0})}{c \\sin(\\theta_{0})}}\n$$"
        },
        {
            "introduction": "This final practice synthesizes theory and computation into a modern aeroacoustic workflow. You are tasked with building a post-processing pipeline based on the Ffowcs Williams–Hawkings (FW-H) acoustic analogy to predict far-field noise from surface data. The exercise addresses the crucial, practical challenges of filtering non-radiating hydrodynamic pressures and implementing retarded-time evaluation, providing direct experience with the methods that transform raw CFD output into precise acoustic predictions .",
            "id": "3940991",
            "problem": "A Ffowcs Williams–Hawkings (FW-H) acoustic analogy post-processing pipeline is to be designed to compute far-field, one-sided power spectral densities from synthetic Large Eddy Simulation (LES) surface data that contains both acoustic and hydrodynamic contributions. The pipeline must include explicit filtering of hydrodynamic pressure using convective alignment and synchronization with retarded-time evaluation inherent to FW-H surface integrals. The computational task is to implement the following physically consistent steps, framed purely in mathematical terms, for each specified test case:\n\n1. Define a circular, permeable FW-H control surface of radius $a$ lying in the $x$-$y$ plane and centered at the origin. Discretize the surface as $N_s$ points uniformly distributed by angle, with point locations $\\mathbf{y}_i = \\left(a \\cos \\theta_i, a \\sin \\theta_i, 0\\right)$ and outward normals $\\mathbf{n}_i = \\left(\\cos \\theta_i, \\sin \\theta_i, 0\\right)$, where $\\theta_i = 2\\pi i/N_s$ for $i = 0,1,\\ldots,N_s-1$.\n\n2. Generate synthetic LES surface pressure signals $p_s(\\mathbf{y}_i,t)$ for each surface point. Let the acoustic plane-wave part propagate along the $+x$ direction at the speed of sound $c_0$, and let the hydrodynamic convective part propagate along $+x$ at the convection speed $U$ (with $U < c_0$ in general). Define the projection coordinate $s(\\mathbf{y}_i) = \\hat{\\mathbf{e}}_x \\cdot \\mathbf{y}_i = a \\cos \\theta_i$. The signal for each point is\n$$\np_s(\\mathbf{y}_i,t) = A_a \\cos\\left(2\\pi f_a \\left(t - \\frac{s(\\mathbf{y}_i)}{c_0}\\right)\\right) + A_h \\cos\\left(2\\pi f_h \\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\\right) + \\eta_i(t),\n$$\nwhere $A_a$ is the acoustic amplitude in Pascals, $f_a$ is the acoustic frequency in Hertz, $A_h$ is the hydrodynamic amplitude in Pascals, $f_h$ is the hydrodynamic frequency in Hertz, and $\\eta_i(t)$ is zero-mean additive stochastic noise with amplitude specified in Pascals. The sampling rate is $f_s$ in Hertz, and the duration is $T$ in seconds. The speed of sound is $c_0$ in meters per second.\n\n3. Construct a hydrodynamic pressure estimate by convective alignment across the surface and subtract it to filter the hydrodynamic content. Define the convectively aligned signals\n$$\nq_i(t) = p_s(\\mathbf{y}_i,\\, t + s(\\mathbf{y}_i)/U),\n$$\nand the surface-average aligned signal\n$$\n\\overline{q}(t) = \\frac{1}{N_s} \\sum_{i=0}^{N_s-1} q_i(t).\n$$\nThen define the hydrodynamic estimate at each point by de-aligning\n$$\n\\widehat{p}_h(\\mathbf{y}_i,t) = \\overline{q}\\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right),\n$$\nand construct the filtered pressure\n$$\np_f(\\mathbf{y}_i,t) = p_s(\\mathbf{y}_i,t) - \\widehat{p}_h(\\mathbf{y}_i,t).\n$$\nAll time shifts are to be evaluated by linear interpolation in time. This procedure aims to remove components convecting approximately at speed $U$ while retaining components traveling near $c_0$.\n\n4. Compute the FW-H far-field proxy pressure at a fixed observer location $\\mathbf{x}_o$ by retarded-time synchronization. For each surface point $\\mathbf{y}_i$, compute the acoustic retarded time\n$$\nt_r^{(i)}(t) = t - \\frac{R_i}{c_0}, \\quad R_i = \\|\\mathbf{x}_o - \\mathbf{y}_i\\|.\n$$\nApproximate the loading-only porous FW-H contribution by a discretized, dimensionless-weighted sum that preserves pressure units, using\n$$\np'(\\mathbf{x}_o,t) \\approx \\sum_{i=0}^{N_s-1} w_i \\, p_f\\left(\\mathbf{y}_i,\\, t_r^{(i)}(t)\\right),\n$$\nwith\n$$\nw_i = \\frac{R_{\\mathrm{ref}}}{4\\pi R_i N_s},\n$$\nwhere $R_{\\mathrm{ref}}$ is a fixed reference length set to $1\\,\\mathrm{m}$ to keep the summation dimensionless. The retarded-time synchronization is realized by linear interpolation of $p_f(\\mathbf{y}_i,t)$ at $t_r^{(i)}(t)$.\n\n5. Compute the one-sided power spectral density (PSD) $S_{p'p'}(f)$ of $p'(\\mathbf{x}_o,t)$ using a Hann window $w(t)$ and the Fast Fourier Transform (FFT). If $x[n]$ is the sampled signal, $w[n]$ is the window, $X[k]$ is the discrete Fourier transform of $w[n] x[n]$, $f_s$ is the sampling frequency, $N$ is the number of samples, and $U_w = \\frac{1}{N}\\sum_{n=0}^{N-1} w[n]^2$ is the window power, then the single-sided PSD is defined for frequencies $f_k = k f_s/N$ by\n$$\nS_{p'p'}(f_k) = \\begin{cases}\n\\frac{1}{f_s N U_w} |X[0]|^2, & k = 0 \\\\\n\\frac{2}{f_s N U_w} |X[k]|^2, & 1 \\le k \\le \\frac{N}{2}-1 \\\\\n\\frac{1}{f_s N U_w} |X[N/2]|^2, & k = \\frac{N}{2} \\text{ when } N \\text{ is even}\n\\end{cases}\n$$\nReport $S_{p'p'}(f)$ at the acoustic frequency $f_a$ and at the hydrodynamic frequency $f_h$ by taking the FFT bin closest to each target.\n\nAll physical answers must be expressed in Pascals squared per Hertz ($\\mathrm{Pa}^2/\\mathrm{Hz}$). Angles are to be in radians. When you report numerical values, round each to six decimal digits.\n\nTest Suite:\n- Case 1 (general case):\n  - $N_s = 64$, $a = 0.5\\,\\mathrm{m}$, $\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 800\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 200\\,\\mathrm{Hz}$, $A_h = 2.0\\,\\mathrm{Pa}$,\n  - $U = 100.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - noise amplitude $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\n- Case 2 (no hydrodynamic content):\n  - $N_s = 64$, $a = 0.5\\,\\mathrm{m}$, $\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 800\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 200\\,\\mathrm{Hz}$, $A_h = 0.0\\,\\mathrm{Pa}$,\n  - $U = 100.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - noise amplitude $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\n- Case 3 (near-sonic convection):\n  - $N_s = 64$, $a = 0.5\\,\\mathrm{m}$, $\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 800\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 200\\,\\mathrm{Hz}$, $A_h = 2.0\\,\\mathrm{Pa}$,\n  - $U = 320.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - noise amplitude $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\n- Case 4 (sparse surface sampling and smaller aperture):\n  - $N_s = 8$, $a = 0.1\\,\\mathrm{m}$, $\\mathbf{x}_o = (5.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 1200\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 300\\,\\mathrm{Hz}$, $A_h = 2.0\\,\\mathrm{Pa}$,\n  - $U = 150.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - noise amplitude $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, report two values in $\\mathrm{Pa}^2/\\mathrm{Hz}$ rounded to six decimals: first $S_{p'p'}(f_a)$, then $S_{p'p'}(f_h)$. The aggregate output should therefore contain eight numbers in total, in the order of Cases 1 through 4, for a total format\n$$\n[\\;S_{p'p'}(f_a)_{\\text{Case 1}},\\,S_{p'p'}(f_h)_{\\text{Case 1}},\\,S_{p'p'}(f_a)_{\\text{Case 2}},\\,S_{p'p'}(f_h)_{\\text{Case 2}},\\,S_{p'p'}(f_a)_{\\text{Case 3}},\\,S_{p'p'}(f_h)_{\\text{Case 3}},\\,S_{p'p'}(f_a)_{\\text{Case 4}},\\,S_{p'p'}(f_h)_{\\text{Case 4}}\\;].\n$$",
            "solution": "The problem requires the implementation of a computational pipeline for post-processing synthetic aeroacoustic data. This pipeline simulates the Ffowcs Williams–Hawkings (FW-H) method, including a crucial pre-processing step to filter out non-propagating hydrodynamic pressure fluctuations from the source data. The solution is structured by meticulously following the prescribed mathematical and algorithmic steps.\n\nFirst, we establish the computational domain and generate the source signals. A circular, permeable control surface of radius $a$ is defined in the $x$-$y$ plane, centered at the origin. This surface is discretized into $N_s$ points with locations given by $\\mathbf{y}_i = (a \\cos\\theta_i, a \\sin\\theta_i, 0)$ for $i = 0, 1, \\ldots, N_s-1$, where $\\theta_i = 2\\pi i/N_s$. The outward normal vector at each point is $\\mathbf{n}_i = (\\cos\\theta_i, \\sin\\theta_i, 0)$.\n\nFor each point $\\mathbf{y}_i$, a synthetic pressure signal $p_s(\\mathbf{y}_i,t)$ is generated over a duration $T$ with a sampling rate $f_s$. The number of time samples is $N = \\lfloor T f_s \\rfloor$. The signal is composed of an acoustic plane wave, a hydrodynamic convective disturbance, and additive stochastic noise. The acoustic wave propagates at the speed of sound $c_0$, while the hydrodynamic component convects at a different speed $U$. Both are defined to propagate in the $+x$ direction. The signal at each surface point $\\mathbf{y}_i$ is given by:\n$$\np_s(\\mathbf{y}_i,t) = A_a \\cos\\left(2\\pi f_a \\left(t - \\frac{s(\\mathbf{y}_i)}{c_0}\\right)\\right) + A_h \\cos\\left(2\\pi f_h \\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\\right) + \\eta_i(t)\n$$\nHere, $s(\\mathbf{y}_i) = \\hat{\\mathbf{e}}_x \\cdot \\mathbf{y}_i = a \\cos\\theta_i$ is the projection of the point's position onto the direction of propagation. $A_a$ and $f_a$ are the acoustic amplitude and frequency, $A_h$ and $f_h$ are the hydrodynamic amplitude and frequency, and $\\eta_i(t)$ is zero-mean stochastic noise with a specified amplitude $A_n$. For computational reproducibility, the noise is generated from a uniform distribution on $[-A_n, A_n]$ using a fixed random seed.\n\nThe second major step is to filter the hydrodynamic pressure component. This is achieved through a technique of convective alignment and subtraction. For each surface point $\\mathbf{y}_i$, the signal $p_s$ is time-shifted to align events that convect at speed $U$:\n$$\nq_i(t) = p_s\\left(\\mathbf{y}_i, t + \\frac{s(\\mathbf{y}_i)}{U}\\right)\n$$\nSubstituting the expression for $p_s$, the hydrodynamic part of $q_i(t)$ becomes $A_h \\cos(2\\pi f_h t)$, which is now synchronized across all surface points, independent of their position $s(\\mathbf{y}_i)$. The acoustic part, however, remains dependent on $s(\\mathbf{y}_i)$, as its phase is related to $c_0$. By averaging these aligned signals over the entire surface, the spatially incoherent acoustic and noise components are attenuated, while the coherent hydrodynamic component is preserved:\n$$\n\\overline{q}(t) = \\frac{1}{N_s} \\sum_{i=0}^{N_s-1} q_i(t) \\approx A_h \\cos(2\\pi f_h t)\n$$\nThis surface-averaged signal $\\overline{q}(t)$ serves as an estimate of the isolated hydrodynamic fluctuation at a reference location ($s=0$). This estimate is then time-shifted back to each point's original frame to construct the hydrodynamic pressure field estimate:\n$$\n\\widehat{p}_h(\\mathbf{y}_i,t) = \\overline{q}\\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\n$$\nFinally, this estimate is subtracted from the original signal to yield the filtered pressure, which ideally contains only the acoustic signal and residual noise:\n$$\np_f(\\mathbf{y}_i,t) = p_s(\\mathbf{y}_i,t) - \\widehat{p}_h(\\mathbf{y}_i,t)\n$$\nAll required time-shifts are performed numerically using linear interpolation on the discrete time-series data.\n\nThe third step is to compute the far-field observer pressure $p'(\\mathbf{x}_o,t)$ using a simplified, porous FW-H integral formulation. This involves summing the contributions from all surface points, with each contribution evaluated at its specific retarded time. The retarded time $t_r^{(i)}$ for a signal from point $\\mathbf{y}_i$ to be received at observer location $\\mathbf{x}_o$ at time $t$ is:\n$$\nt_r^{(i)}(t) = t - \\frac{R_i}{c_0}, \\quad \\text{where} \\quad R_i = \\|\\mathbf{x}_o - \\mathbf{y}_i\\|\n$$\nThe far-field proxy pressure is then a weighted sum of the filtered pressures evaluated at their respective retarded times:\n$$\np'(\\mathbf{x}_o,t) \\approx \\sum_{i=0}^{N_s-1} w_i \\, p_f\\left(\\mathbf{y}_i,\\, t_r^{(i)}(t)\\right)\n$$\nThe weights $w_i$ are given by $w_i = \\frac{R_{\\mathrm{ref}}}{4\\pi R_i N_s}$, where $R_{\\mathrm{ref}}=1\\,\\mathrm{m}$ is a reference length. This summation is performed by interpolating each filtered signal $p_f(\\mathbf{y}_i, t)$ at the required retarded time samples $t_r^{(i)}(t)$.\n\nThe final step is to analyze the frequency content of the resulting observer pressure signal $p'(\\mathbf{x}_o,t)$ by computing its one-sided power spectral density (PSD), $S_{p'p'}(f)$. The signal, of length $N$, is first multiplied by a Hann window $w[n]$ to reduce spectral leakage. The discrete Fourier transform (DFT), $X[k]$, of the windowed signal is computed. The one-sided PSD is then calculated according to the formula:\n$$\nS_{p'p'}(f_k) = \\begin{cases}\n\\frac{1}{f_s N U_w} |X[0]|^2, & k = 0 \\\\\n\\frac{2}{f_s N U_w} |X[k]|^2, & 1 \\le k \\le N/2 - 1 \\\\\n\\frac{1}{f_s N U_w} |X[N/2]|^2, & k = N/2 \\text{ (for even } N\\text{)}\n\\end{cases}\n$$\nwhere $f_k = k f_s/N$ are the discrete frequencies and $U_w = \\frac{1}{N}\\sum_{n=0}^{N-1} w[n]^2$ is the window power correction factor. The PSD values are reported at the frequency bins closest to the designated acoustic frequency $f_a$ and hydrodynamic frequency $f_h$.\n\nThis entire procedure is encapsulated in a Python script. Vectorized `numpy` operations are used for efficiency, while loops are employed for steps involving non-uniform time shifts across surface points (filtering and retarded-time evaluation). All interpolations are handled by `numpy.interp`. The script iterates through the provided test cases, calculates the two requested PSD values for each, and formats the output as a single list of rounded decimal numbers.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef process_case(Ns, a, xo, fa, Aa, fh, Ah, U, c0, An, fs, T):\n    \"\"\"\n    Implements the full aeroacoustic post-processing pipeline for a single test case.\n    \"\"\"\n    # Set seed for reproducibility of noise. Using a combination of inputs to\n    # ensure noise is different per case but reproducible for the same case.\n    # A simple seed like 0 is sufficient, but this is more robust if case parameters were permuted.\n    seed_val = Ns + int(a*10) + int(xo[0]) + int(fa) + int(fh)\n    np.random.seed(seed_val)\n\n    # Step 1: Define a circular, permeable FW-H control surface and time array\n    N = int(T * fs)\n    t = np.linspace(0, T, N, endpoint=False)\n    dt = T / N\n\n    theta_i = 2 * np.pi * np.arange(Ns) / Ns\n    y_i = np.zeros((Ns, 3))\n    y_i[:, 0] = a * np.cos(theta_i)\n    y_i[:, 1] = a * np.sin(theta_i)\n    \n    # Step 2: Generate synthetic LES surface pressure signals\n    s_i = y_i[:, 0]  # Projection coordinate s(y_i) = x-component\n    \n    # Use broadcasting for efficient signal generation\n    t_grid = t[np.newaxis, :]\n    s_grid = s_i[:, np.newaxis]\n\n    acoustic_part = Aa * np.cos(2 * np.pi * fa * (t_grid - s_grid / c0))\n    hydro_part = Ah * np.cos(2 * np.pi * fh * (t_grid - s_grid / U))\n    noise_part = np.random.uniform(-An, An, size=(Ns, N))\n    \n    p_s = acoustic_part + hydro_part + noise_part\n    \n    # Step 3: Construct a hydrodynamic pressure estimate and filter\n    q = np.zeros_like(p_s)\n    for i in range(Ns):\n        t_aligned = t + s_i[i] / U\n        # Interpolate p_s at aligned times. Extrapolate with 0.\n        q[i, :] = np.interp(t_aligned, t, p_s[i, :], left=0.0, right=0.0)\n        \n    q_bar = np.mean(q, axis=0)\n    \n    p_h_hat = np.zeros_like(p_s)\n    for i in range(Ns):\n        t_dealigned = t - s_i[i] / U\n        # Interpolate q_bar at de-aligned times. Extrapolate with 0.\n        p_h_hat[i, :] = np.interp(t_dealigned, t, q_bar, left=0.0, right=0.0)\n        \n    p_f = p_s - p_h_hat\n    \n    # Step 4: Compute the FW-H far-field proxy pressure\n    xo_vec = np.array(xo)\n    R_i = np.linalg.norm(xo_vec - y_i, axis=1)\n    \n    R_ref = 1.0\n    w_i = R_ref / (4 * np.pi * R_i * Ns)\n    \n    p_prime = np.zeros(N)\n    for i in range(Ns):\n        t_r = t - R_i[i] / c0\n        p_f_retarded = np.interp(t_r, t, p_f[i, :], left=0.0, right=0.0)\n        p_prime += w_i[i] * p_f_retarded\n        \n    # Step 5: Compute the one-sided power spectral density (PSD)\n    x = p_prime\n    win = np.hanning(N)\n    # Window power correction factor\n    Uw = np.mean(win**2)\n    \n    x_w = x * win\n    X = np.fft.fft(x_w)\n    \n    freqs = np.fft.fftfreq(N, d=dt)\n    \n    psd = np.abs(X)**2 / (fs * N * Uw)\n    \n    # Correct for one-sided PSD, handling N even or odd\n    psd_one_sided = psd[:N//2 + 1]\n    freqs_one_sided = freqs[:N//2 + 1]\n    \n    # Double the power for non-DC and non-Nyquist frequencies\n    if N % 2 == 0:\n        psd_one_sided[1:-1] *= 2\n    else: # N is odd\n        psd_one_sided[1:] *= 2\n\n    # Find PSD values at frequencies closest to fa and fh\n    idx_fa = np.argmin(np.abs(freqs_one_sided - fa))\n    S_fa = psd_one_sided[idx_fa]\n    \n    idx_fh = np.argmin(np.abs(freqs_one_sided - fh))\n    S_fh = psd_one_sided[idx_fh]\n    \n    return S_fa, S_fh\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general case)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 2.0, 'U': 100.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 2 (no hydrodynamic content)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 0.0, 'U': 100.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 3 (near-sonic convection)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 2.0, 'U': 320.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 4 (sparse surface sampling and smaller aperture)\n        {'Ns': 8, 'a': 0.1, 'xo': (5.0, 0.0, 0.0), 'fa': 1200, 'Aa': 1.0, \n         'fh': 300, 'Ah': 2.0, 'U': 150.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n    ]\n\n    results = []\n    for case in test_cases:\n        S_fa, S_fh = process_case(**case)\n        results.append(round(S_fa, 6))\n        results.append(round(S_fh, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}