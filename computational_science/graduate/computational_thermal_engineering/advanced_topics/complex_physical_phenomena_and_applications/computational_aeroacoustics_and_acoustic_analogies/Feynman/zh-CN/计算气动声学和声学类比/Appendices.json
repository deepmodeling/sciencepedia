{
    "hands_on_practices": [
        {
            "introduction": "计算气动声学 (CAA) 的一个核心挑战是如何在离散网格上准确地模拟声波的传播。当我们将连续的波动方程离散化时，数值格式本身会引入误差，导致不同波长的波以不同的速度传播，这种现象称为数值色散。本练习将通过傅里叶分析来量化一个标准的有限差分格式所引入的这种误差，推导出“修正波数”，这是分析 CAA 数值方法性能的基石。",
            "id": "3940989",
            "problem": "在计算航空声学 (CAA) 中，声波的精确传播是通过声学类比（如 Lighthill 类比）预测湍流产生的声音的基础。考虑均匀、静止介质中的一维小振幅声学问题，其中声压扰动 $p'(x,t)$ 满足线性波动方程。该方程是在等熵假设下从线性化可压缩欧拉方程导出的，\n$$\\frac{\\partial^{2} p'}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} p'}{\\partial x^{2}},$$\n其中 $c$ 是声速。在间距为 $\\Delta x$ 的均匀网格上，令空间二阶导数由标准三点二阶中心差分格式近似，\n$$\\left.\\frac{\\partial^{2} p'}{\\partial x^{2}}\\right|_{x_i} \\approx \\frac{p'(x_{i+1},t) - 2\\,p'(x_{i},t) + p'(x_{i-1},t)}{\\Delta x^{2}},$$\n并采用时间保持连续的半离散格式。对于一个平面声波\n$$p'(x,t) = \\cos(k x - \\omega t),$$\n其中波数 $k$ 和角频率 $\\omega$ 均为实数，假设离散傅里叶模态为 $p'_i(t) = \\Re\\{\\hat{p}\\,\\exp(i(i\\,\\theta - \\omega t))\\}$，其中 $x_i = i\\,\\Delta x$，$\\theta = k\\,\\Delta x$，$\\hat{p}$ 是一个复振幅。从上述控制方程和差分格式出发，使用傅里叶分析，推导由半离散色散关系 $\\omega^{2} = c^{2} \\left(k^{*}\\right)^{2}$ 定义的修正波数 $k^{*}$，并量化平面波的数值相速度误差和振幅（耗散）误差。\n\n用 $k$ 和 $\\Delta x$ 明确表示相速度误差，并确定该半离散格式是否引入任何振幅误差。\n\n将 $k^{*}$ 关于 $k$ 和 $\\Delta x$ 的闭式解析表达式作为最终结果报告。不需要进行数值计算，也不需要四舍五入。最终表达式中不要包含单位。",
            "solution": "该问题已经过验证，被认为是有效的，因为它具有科学依据、适定且客观。它提出了一个波动传播数值方法分析中的标准问题，这是计算航空声学的一个核心课题。所有必要信息均已提供，问题没有矛盾或模糊之处。\n\n我们从一维线性波动方程的半离散近似开始。控制偏微分方程为\n$$\n\\frac{\\partial^{2} p'}{\\partial t^{2}} = c^{2} \\frac{\\partial^{2} p'}{\\partial x^{2}}\n$$\n其中 $p'(x,t)$ 是声压扰动，$c$ 是恒定声速。\n空间域在均匀网格上离散化，网格点为 $x_i = i\\,\\Delta x$，其中 $i$ 是整数索引，$\\Delta x$ 是网格间距。在网格点 $x_i$ 处的空间二阶导数由二阶、三点中心差分格式近似：\n$$\n\\left.\\frac{\\partial^{2} p'}{\\partial x^{2}}\\right|_{x_i} \\approx \\frac{p'(x_{i+1},t) - 2\\,p'(x_{i},t) + p'(x_{i-1},t)}{\\Delta x^{2}}\n$$\n将此近似代入波动方程，得到每个网格点上压力扰动 $p'_i(t) \\equiv p'(x_i, t)$ 的半离散常微分方程：\n$$\n\\frac{d^{2} p'_i}{d t^{2}} = \\frac{c^{2}}{\\Delta x^{2}} \\left( p'_{i+1} - 2\\,p'_i + p'_{i-1} \\right)\n$$\n为了分析此数值格式的性质，我们通过代入单一傅里叶模态解来进行傅里叶分析。问题给出的离散傅里叶模态形式为 $p'_i(t) = \\Re\\{\\hat{p}\\,\\exp(i(i\\,\\theta - \\omega t))\\}$，其中 $\\theta = k\\,\\Delta x$。对于线性方程，我们可以使用复数形式进行计算，最后取实部。设试探解为：\n$$\np'_j(t) = \\hat{p} \\exp\\left(i(j k \\Delta x - \\omega t)\\right)\n$$\n对于任意网格点索引 $j$。这里，$k$ 是波数，$\\omega$ 是角频率。\n那么相邻点的值为：\n$$\np'_{i+1}(t) = \\hat{p} \\exp\\left(i((i+1)k \\Delta x - \\omega t)\\right) = p'_i(t) \\exp(i k \\Delta x)\n$$\n$$\np'_{i-1}(t) = \\hat{p} \\exp\\left(i((i-1)k \\Delta x - \\omega t)\\right) = p'_i(t) \\exp(-i k \\Delta x)\n$$\n左侧 (LHS) 的时间导数为：\n$$\n\\frac{d^{2} p'_i}{d t^{2}} = \\frac{d^{2}}{d t^{2}} \\left[ \\hat{p} \\exp\\left(i(i k \\Delta x - \\omega t)\\right) \\right] = (-i\\omega)^{2} p'_i(t) = -\\omega^{2} p'_i(t)\n$$\n右侧 (RHS) 变为：\n$$\n\\text{RHS} = \\frac{c^{2}}{\\Delta x^{2}} \\left( p'_i(t)\\exp(i k \\Delta x) - 2\\,p'_i(t) + p'_i(t)\\exp(-i k \\Delta x) \\right)\n$$\n$$\n\\text{RHS} = \\frac{c^{2} p'_i(t)}{\\Delta x^{2}} \\left( \\exp(i k \\Delta x) + \\exp(-i k \\Delta x) - 2 \\right)\n$$\n使用欧拉公式 $\\exp(iz) + \\exp(-iz) = 2\\cos(z)$，该表达式简化为：\n$$\n\\text{RHS} = \\frac{c^{2} p'_i(t)}{\\Delta x^{2}} \\left( 2\\cos(k \\Delta x) - 2 \\right) = \\frac{2c^{2} p'_i(t)}{\\Delta x^{2}} \\left( \\cos(k \\Delta x) - 1 \\right)\n$$\n使用半角三角恒等式 $1 - \\cos(z) = 2\\sin^{2}(z/2)$，我们得到：\n$$\n\\text{RHS} = \\frac{2c^{2} p'_i(t)}{\\Delta x^{2}} \\left( -2\\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\right) = -\\frac{4c^{2} p'_i(t)}{\\Delta x^{2}} \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n令 LHS 和 RHS 相等，并除以 $p'_i(t)$（其不为零），我们得到半离散格式的数值色散关系：\n$$\n-\\omega^{2} = -\\frac{4c^{2}}{\\Delta x^{2}} \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\omega^{2} = \\frac{4c^{2}}{\\Delta x^{2}} \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n问题将修正波数 $k^{*}$ 定义为，使数值色散关系模仿精确色散关系 $\\omega^{2} = c^{2} k^{2}$ 的形式，但用 $k^{*}$ 替换 $k$：\n$$\n\\omega^{2} = c^{2} (k^{*})^{2}\n$$\n通过将此定义与我们推导出的数值色散关系进行比较，我们可以确定 $(k^{*})^{2}$：\n$$\nc^{2} (k^{*})^{2} = \\frac{4c^{2}}{\\Delta x^{2}} \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\implies (k^{*})^{2} = \\frac{4}{\\Delta x^{2}} \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n取主平方根（假设 $\\Delta x > 0$ 且波在空间上是可分辨的，即 $0 \\le k \\Delta x \\le \\pi$，这确保了 $\\sin(k\\Delta x/2) \\ge 0$），我们得到修正波数 $k^{*}$ 的表达式：\n$$\nk^{*} = \\frac{2}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n\n现在我们来量化数值误差。\n振幅（耗散）误差：如果修正波数 $k^{*}$ 具有非零虚部，则波分量的振幅会发生变化。在我们的情况中，对于任意实数波数 $k$ 和实数网格间距 $\\Delta x$，正弦函数产生一个实数值。因此，$k^{*}$ 是纯实数。这意味着修正波数的虚部为零，$\\Im(k^{*}) = 0$。因此，波的振幅没有人为的放大或衰减。使用中心差分格式的半离散格式是纯色散的，不引入振幅（耗散）误差。\n\n相速度误差：精确的物理系统是非色散的，对于所有波数，其相速度为 $c_{ph,exact} = \\omega/k = c$。数值相速度 $c_{ph,num}$ 由 $c_{ph,num} = \\omega/k$ 给出。使用数值色散关系 $\\omega = c k^{*}$，我们有：\n$$\nc_{ph,num} = \\frac{\\omega}{k} = \\frac{c k^{*}}{k} = \\frac{c}{k} \\left( \\frac{2}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right)\n$$\n重新整理此表达式，得到用 $k$ 和 $\\Delta x$ 表示的相速度误差，通常表示为与精确声速 $c$ 的比率：\n$$\n\\frac{c_{ph,num}}{c} = \\frac{2}{k \\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) = \\frac{\\sin\\left(\\frac{k \\Delta x}{2}\\right)}{\\frac{k \\Delta x}{2}}\n$$\n这个比率是 sinc 函数，$\\text{sinc}(k\\Delta x/2)$。由于对于任何参数 $z > 0$，$\\text{sinc}(z) < 1$，因此数值相速度总是小于精确声速 $c$（除了在极限 $k\\Delta x \\to 0$ 的情况下）。这是一种滞后相误差。该误差取决于无量纲群 $k\\Delta x$，这表明该格式是色散的：不同波数以不同速度传播，导致波包在传播时发生畸变。\n\n问题要求将 $k^{*}$ 的闭式解析表达式作为最终结果。",
            "answer": "$$\n\\boxed{\\frac{2}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)}\n$$"
        },
        {
            "introduction": "在真实世界的复杂流动中，声波并非总是沿直线传播。当声波穿过速度不均匀的区域（如飞机机翼或喷气发动机尾流附近的剪切层）时，其传播路径会发生弯曲，这种现象被称为声折射。本练习将应用 WKB (Wentzel–Kramers–Brillouin) 近似方法，来探索这种关键的声-流相互作用，并计算声波在简单剪切流中的弯曲角度，从而揭示声传播的一个基本物理机制。",
            "id": "3948674",
            "problem": "考虑一个二维、无粘、等熵、正压的可压缩流，其平均密度均匀，声速 $c$ 在空间上均匀。稳定的平均速度场为 $\\bar{\\mathbf{u}}(y) = S y\\,\\mathbf{e}_{x}$，其中 $S$ 为恒定的剪切率，$\\mathbf{e}_{x}$ 是流向的单位矢量。一个角频率为 $\\omega$ 的小振幅、时谐声扰动从 $y=0$ 处入射，在该处平均流为 $\\bar{\\mathbf{u}}(0)=\\mathbf{0}$。在 $y=0$ 处，声波矢量 $\\mathbf{k}_{0}$ 与 $x$ 轴形成一个初始角 $\\theta_{0}$，其中 $0 < \\theta_{0} < \\pi/2$，随后波在区间 $0\\le y\\le H$ 上穿过剪切层。\n\n从给定平均流的线性化欧拉方程出发，并采用适用于缓变基底的高频（Wentzel–Kramers–Brillouin (WKB)）射线近似法，推导运动介质中声波的主阶色散关系及相关的射线方程。利用这些方程证明，平均流的空间梯度 $\\nabla\\bar{\\mathbf{u}}$ 通过旋转局部波矢量来折射声波，并计算在小参数 $|S|H/c\\ll 1$ 的一阶精度下，波矢量在 $y=0$ 和 $y=H$ 之间方向的净变化所产生的弯曲角 $\\Delta\\theta$。请将最终的弯曲角 $\\Delta\\theta$ 以弧度表示，并以 $S$、$H$、$c$ 和 $\\theta_{0}$ 的闭式解析表达式给出。无需进行数值计算。",
            "solution": "首先验证问题，以确保其在科学上是合理的、自洽的且适定的。\n\n### 第 1 步：提取已知条件\n-   **流动条件**：二维、无粘、等熵、正压可压缩流。\n-   **平均密度**：均匀，$\\bar{\\rho} = \\text{常数}$。\n-   **声速**：空间均匀， $c = \\text{常数}$。\n-   **平均速度场**：$\\bar{\\mathbf{u}}(y) = S y\\,\\mathbf{e}_{x}$，其中 $S$ 是一个恒定的剪切率。\n-   **扰动**：角频率为 $\\omega$ 的小振幅、时谐声扰动。\n-   **初始条件**：在 $y=0$ 处，平均流为 $\\bar{\\mathbf{u}}(0)=\\mathbf{0}$。入射声波矢量 $\\mathbf{k}_{0}$ 与 $x$ 轴形成一个角度 $\\theta_{0}$，其中 $0<\\theta_{0}<\\pi/2$。\n-   **区域**：波从 $y=0$ 传播到 $y=H$ 穿过剪切层。\n-   **近似**：将使用高频 Wentzel–Kramers–Brillouin (WKB) 射线近似法。\n-   **小参数**：分析将在 $|S|H/c\\ll 1$ 的一阶精度下进行。\n-   **目标**：推导色散关系和射线方程，证明折射现象，并计算波矢量在 $y=0$ 和 $y=H$ 之间的净弯曲角 $\\Delta\\theta$。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是航空声学中的一个标准练习，涉及声波在非均匀平均流中的传播。它基于流体动力学（欧拉方程）和波动力学（WKB 近似，射线理论）的基本原理。简单剪切流是研究此类折射效应的典型模型。该问题在科学上是合理的。\n2.  **适定性**：物理设置、入射边界条件以及要使用的具体近似都已明确定义。目标是具体且可量化的，在指定的近似范围内可以得到唯一解。\n3.  **客观性**：问题陈述使用了物理学和数学中精确、客观和标准的术语。\n4.  **一致性**：具有恒定平均密度 $\\bar{\\rho}$ 和声速 $c$（意味着恒定的平均压力 $\\bar{p}$）的平均流 $\\bar{\\mathbf{u}}(y) = S y\\,\\mathbf{e}_{x}$ 是欧拉方程的一个有效的稳态解，因为 $(\\bar{\\mathbf{u}}\\cdot\\nabla)\\bar{\\mathbf{u}} = \\mathbf{0}$，满足 $\\bar{\\rho}(\\bar{\\mathbf{u}}\\cdot\\nabla)\\bar{\\mathbf{u}} = -\\nabla\\bar{p} = \\mathbf{0}$。该设置是内部一致的。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整解答。\n\n### 求解过程推导\n\n我们从无粘、正压可压缩流的线性化欧拉方程开始。变量被分解为一个稳态平均分量（上划线）和一个小的声学扰动（撇号）：$\\rho = \\bar{\\rho} + \\rho'$，$p = \\bar{p} + p'$，$\\mathbf{u} = \\bar{\\mathbf{u}} + \\mathbf{u}'$。鉴于平均流是稳态的，且 $\\bar{\\rho}$ 和 $c$ 是均匀的（意味着 $\\bar{p}$ 均匀），线性化的连续性方程和动量方程为：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\bar{\\mathbf{u}} \\cdot \\nabla \\rho' + \\rho' \\nabla \\cdot \\bar{\\mathbf{u}} + \\bar{\\rho} \\nabla \\cdot \\mathbf{u}' + \\mathbf{u}' \\cdot \\nabla \\bar{\\rho} = 0\n$$\n$$\n\\bar{\\rho}\\left(\\frac{\\partial \\mathbf{u}'}{\\partial t} + \\bar{\\mathbf{u}} \\cdot \\nabla \\mathbf{u}' + (\\mathbf{u}' \\cdot \\nabla)\\bar{\\mathbf{u}}\\right) = -\\nabla p'\n$$\n对于给定的平均流 $\\bar{\\mathbf{u}} = (Sy, 0, 0)$，我们有 $\\nabla \\cdot \\bar{\\mathbf{u}} = 0$。由于 $\\bar{\\rho}$ 是常数，$\\nabla\\bar{\\rho}=\\mathbf{0}$。正压关系 $p' = c^2 \\rho'$（其中 $c$ 为常数）允许我们替换 $\\rho'$。方程简化为：\n$$\n\\frac{1}{c^2}\\left(\\frac{\\partial p'}{\\partial t} + \\bar{\\mathbf{u}} \\cdot \\nabla p'\\right) + \\bar{\\rho} \\nabla \\cdot \\mathbf{u}' = 0\n$$\n$$\n\\bar{\\rho}\\left(\\frac{\\partial \\mathbf{u}'}{\\partial t} + \\bar{\\mathbf{u}} \\cdot \\nabla \\mathbf{u}' + (\\mathbf{u}' \\cdot \\nabla)\\bar{\\mathbf{u}}\\right) = -\\nabla p'\n$$\n项 $(\\mathbf{u}' \\cdot \\nabla)\\bar{\\mathbf{u}}$ 代表声速与平均流梯度的相互作用。对于 $\\bar{\\mathbf{u}} = Sy\\,\\mathbf{e}_x$，该项为 $(u'_y \\partial_y (Sy)) \\mathbf{e}_x = S u'_y \\mathbf{e}_x$。\n\n我们现在使用 WKB 近似，假设一个局部平面波解的形式为 $f'(\\mathbf{x},t) \\propto \\exp(i(\\phi(\\mathbf{x}) - \\omega t))$，其中局部波矢量为 $\\mathbf{k}(\\mathbf{x}) = \\nabla\\phi$。在高频极限下，导数被代数项替换：$\\nabla \\to i\\mathbf{k}$ 和 $\\partial/\\partial t \\to -i\\omega$。线性化方程变为：\n$$\n\\frac{1}{c^2}(-i\\omega p' + i(\\mathbf{k} \\cdot \\bar{\\mathbf{u}})p') + \\bar{\\rho} (i\\mathbf{k} \\cdot \\mathbf{u}') = 0\n$$\n$$\n\\bar{\\rho}(-i\\omega \\mathbf{u}' + i(\\mathbf{k} \\cdot \\bar{\\mathbf{u}})\\mathbf{u}' + S u'_y \\mathbf{e}_x) = -i\\mathbf{k}p'\n$$\n令 $\\omega_e = \\omega - \\mathbf{k} \\cdot \\bar{\\mathbf{u}}$ 为随局部平均流移动的参考系中的本征频率。代数系统为：\n$$\n(\\mathbf{k} \\cdot \\mathbf{u}') = \\frac{\\omega_e}{\\bar{\\rho}c^2} p'\n$$\n$$\n-\\omega_e \\mathbf{u}' - i S u'_y \\mathbf{e}_x = \\frac{\\mathbf{k}}{\\bar{\\rho}} p'\n$$\n将动量方程写为分量形式 ($u'_x, u'_y$)：\n$$\n-\\omega_e u'_x - i S u'_y = \\frac{k_x}{\\bar{\\rho}} p'\n$$\n$$\n-\\omega_e u'_y = \\frac{k_y}{\\bar{\\rho}} p' \\implies u'_y = -\\frac{k_y}{\\bar{\\rho}\\omega_e} p'\n$$\n将 $u'_y$ 代入 $x$-动量方程：\n$$\n-\\omega_e u'_x - i S \\left(-\\frac{k_y}{\\bar{\\rho}\\omega_e} p'\\right) = \\frac{k_x}{\\bar{\\rho}} p' \\implies u'_x = -\\frac{k_x}{\\bar{\\rho}\\omega_e} p' - i\\frac{S k_y}{\\bar{\\rho}\\omega_e^2} p'\n$$\n将 $u'_x$ 和 $u'_y$ 代入连续性方程：\n$$\nk_x \\left(-\\frac{k_x}{\\bar{\\rho}\\omega_e} - i\\frac{S k_y}{\\bar{\\rho}\\omega_e^2}\\right) p' + k_y \\left(-\\frac{k_y}{\\bar{\\rho}\\omega_e}\\right) p' = \\frac{\\omega_e}{\\bar{\\rho}c^2} p'\n$$\n除以 $p'/\\bar{\\rho}$ 并化简：\n$$\n-\\frac{k_x^2}{\\omega_e} - i\\frac{S k_x k_y}{\\omega_e^2} - \\frac{k_y^2}{\\omega_e} = \\frac{\\omega_e}{c^2}\n$$\n$$\n-\\frac{k^2}{\\omega_e} - i\\frac{S k_x k_y}{\\omega_e^2} = \\frac{\\omega_e}{c^2} \\quad \\text{其中 } k^2 = k_x^2+k_y^2\n$$\n在 WKB（高频）极限下，由平均流梯度产生的项被视为一个小修正。通过忽略含 $S$ 的项，得到主阶色散关系：\n$$\n-\\frac{k^2}{\\omega_e} = \\frac{\\omega_e}{c^2} \\implies \\omega_e^2 = c^2 k^2\n$$\n代回 $\\omega_e = \\omega - \\mathbf{k} \\cdot \\bar{\\mathbf{u}}$：\n$$\nD(\\omega, \\mathbf{k}, \\mathbf{x}) = (\\omega - \\mathbf{k} \\cdot \\bar{\\mathbf{u}})^2 - c^2 k^2 = 0\n$$\n这就是运动介质中声波的主阶色散关系。\n\n射线方程从此关系式推导得出，该关系式充当哈密顿量。在时不变介质中，$\\omega$ 沿着一条射线是恒定的。射线方程为：\n$$\n\\frac{d\\mathbf{x}}{dt} = -\\frac{\\partial D / \\partial \\mathbf{k}}{\\partial D / \\partial \\omega} \\quad \\text{(群速度)}\n$$\n$$\n\\frac{d\\mathbf{k}}{dt} = \\frac{\\partial D / \\partial \\mathbf{x}}{\\partial D / \\partial \\omega} \\quad \\text{(折射)}\n$$\n我们计算必要的偏导数，其中 $\\bar{\\mathbf{u}} = (Sy, 0, 0)$ 且 $\\mathbf{k} \\cdot \\bar{\\mathbf{u}} = k_x S y$：\n$$\n\\frac{\\partial D}{\\partial \\omega} = 2(\\omega - k_x S y) = 2\\omega_e\n$$\n$$\n\\frac{\\partial D}{\\partial k_x} = 2(\\omega - k_x S y)(-Sy) - 2c^2 k_x = -2\\omega_e S y - 2c^2 k_x\n$$\n$$\n\\frac{\\partial D}{\\partial k_y} = -2c^2 k_y\n$$\n$$\n\\frac{\\partial D}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial D}{\\partial y} = 2(\\omega - k_x S y)(-k_x S) = -2\\omega_e k_x S\n$$\n射线方程为：\n$$\n\\frac{dx}{dt} = -\\frac{-2\\omega_e S y - 2c^2 k_x}{2\\omega_e} = Sy + \\frac{c^2 k_x}{\\omega_e}\n$$\n$$\n\\frac{dy}{dt} = -\\frac{-2c^2 k_y}{2\\omega_e} = \\frac{c^2 k_y}{\\omega_e}\n$$\n$$\n\\frac{dk_x}{dt} = \\frac{0}{2\\omega_e} = 0 \\implies k_x = \\text{常数}\n$$\n$$\n\\frac{dk_y}{dt} = \\frac{-2\\omega_e k_x S}{2\\omega_e} = -S k_x\n$$\n方程 $dk_y/dt = -S k_x$ 表明，当波在剪切层中传播时，波矢量的 $y$ 分量随时间变化。由于 $S$ 是平均速度梯度张量 $\\nabla\\bar{\\mathbf{u}}$ 中唯一非零的分量，这明确地证明了平均流的梯度引起声波的折射。\n\n为了求出弯曲角，我们将波矢量分量的变化与角度 $\\theta(y)$ 的变化联系起来，其中 $\\tan\\theta = k_y/k_x$。$k_x$ 的守恒是关键（对于水平分层介质的斯涅尔定律）。令 $k_x(y) = k_{x0}$。\n根据色散关系，$\\omega_e = \\omega - k_{x0}Sy = \\pm c k = \\pm c\\sqrt{k_{x0}^2 + k_y^2}$。对于从 $y=0$ 入射并传播到 $y>0$ 的波，我们取正根，$\\omega_e = ck$。\n在 $y=0$ 处，$\\bar{\\mathbf{u}}=0$，所以 $\\omega_e(0)=\\omega$。因此 $\\omega = ck_0$，其中 $k_0 = |\\mathbf{k}_0|$。\n常数 $k_{x0}$ 由其初始值给出：$k_{x0} = k_0 \\cos\\theta_0 = (\\omega/c)\\cos\\theta_0$。\n波矢量角 $\\theta(y)$ 由 $k_{x0} = k(y)\\cos\\theta(y)$ 定义。\n根据色散关系，$k(y) = \\omega_e/c = (\\omega-k_{x0}Sy)/c$。\n将 $k(y)$ 代入 $k_x$ 的守恒定律：\n$$\nk_{x0} = \\frac{\\omega - k_{x0}Sy}{c} \\cos\\theta(y)\n$$\n求解 $\\cos\\theta(y)$：\n$$\n\\cos\\theta(y) = \\frac{c k_{x0}}{\\omega - k_{x0}Sy}\n$$\n代入 $k_{x0} = (\\omega/c)\\cos\\theta_0$：\n$$\n\\cos\\theta(y) = \\frac{c (\\omega/c)\\cos\\theta_0}{\\omega - ((\\omega/c)\\cos\\theta_0)Sy} = \\frac{\\omega\\cos\\theta_0}{\\omega(1 - (S/c)y\\cos\\theta_0)} = \\frac{\\cos\\theta_0}{1 - (S/c)y\\cos\\theta_0}\n$$\n这是在 WKB 近似下，角度余弦作为 $y$ 的函数的精确表达式。我们想要求出弯曲角 $\\Delta\\theta = \\theta(H) - \\theta_0$，对于小参数 $\\epsilon = |S|H/c \\ll 1$ 精确到一阶。我们在 $y=H$ 处计算该表达式的值：\n$$\n\\cos\\theta(H) = \\frac{\\cos\\theta_0}{1 - (SH/c)\\cos\\theta_0}\n$$\n由于 $|SH/c| \\ll 1$，项 $(SH/c)\\cos\\theta_0$ 很小。我们对小 $x$ 使用泰勒展开 $(1-x)^{-1} \\approx 1+x$：\n$$\n\\cos\\theta(H) \\approx \\cos\\theta_0 \\left(1 + \\frac{SH}{c}\\cos\\theta_0\\right) = \\cos\\theta_0 + \\frac{SH}{c}\\cos^2\\theta_0\n$$\n现在，设 $\\theta(H) = \\theta_0 + \\Delta\\theta$。对于一个小的弯曲角 $\\Delta\\theta$，我们展开 $\\cos(\\theta_0+\\Delta\\theta) \\approx \\cos\\theta_0 - \\Delta\\theta\\sin\\theta_0$。\n将 $\\cos\\theta(H)$ 的两个一阶近似值相等：\n$$\n\\cos\\theta_0 - \\Delta\\theta\\sin\\theta_0 \\approx \\cos\\theta_0 + \\frac{SH}{c}\\cos^2\\theta_0\n$$\n$$\n-\\Delta\\theta\\sin\\theta_0 \\approx \\frac{SH}{c}\\cos^2\\theta_0\n$$\n求解弯曲角 $\\Delta\\theta$：\n$$\n\\Delta\\theta \\approx -\\frac{SH}{c} \\frac{\\cos^2\\theta_0}{\\sin\\theta_0}\n$$\n这是在 $y=0$ 和 $y=H$ 之间波矢量方向的净变化，精确到 $SH/c$ 的一阶。",
            "answer": "$$\n\\boxed{-\\frac{SH \\cos^{2}(\\theta_{0})}{c \\sin(\\theta_{0})}}\n$$"
        },
        {
            "introduction": "现代计算气动声学的一个中心任务是利用从复杂流动（如大涡模拟, LES）中获得的数值数据来预测远场的噪声。本练习模拟了这一典型工作流程，要求您基于 Ffowcs Williams-Hawkings (FW-H) 声学比拟，实现一个完整的后处理流程。该练习着重解决了区分真实声压与不辐射的“伪声”这一关键挑战，并演示了如何利用源表面的数据来计算远场的声学频谱。",
            "id": "3940991",
            "problem": "需要设计一个 Ffowcs Williams–Hawkings (FW-H) 声学比拟后处理流程，用于从包含声学和流体动力学贡献的合成大涡模拟 (LES) 表面数据中计算远场单边功率谱密度。该流程必须包括使用对流对齐的流体动力学压力显式滤波，并与 FW-H 面積分固有的推迟时间计算同步。对于每个指定的测试案例，计算任务是纯粹以数学术语实现以下物理上一致的步骤：\n\n1. 定义一个位于 $x$-$y$ 平面、以原点为中心、半径为 $a$ 的圆形可渗透 FW-H 控制面。将该表面离散化为 $N_s$ 个按角度均匀分布的点，点的位置为 $\\mathbf{y}_i = \\left(a \\cos \\theta_i, a \\sin \\theta_i, 0\\right)$，外法线为 $\\mathbf{n}_i = \\left(\\cos \\theta_i, \\sin \\theta_i, 0\\right)$，其中 $\\theta_i = 2\\pi i/N_s$，对于 $i = 0,1,\\ldots,N_s-1$。\n\n2. 为每个表面点生成合成的 LES 表面压力信号 $p_s(\\mathbf{y}_i,t)$。令声学平面波部分以声速 $c_0$ 沿 $+x$ 方向传播，流体动力学对流部分以对流速度 $U$（通常 $U \\ll c_0$）沿 $+x$ 方向传播。定义投影坐标 $s(\\mathbf{y}_i) = \\hat{\\mathbf{e}}_x \\cdot \\mathbf{y}_i = a \\cos \\theta_i$。每个点的信号为\n$$\np_s(\\mathbf{y}_i,t) = A_a \\cos\\left(2\\pi f_a \\left(t - \\frac{s(\\mathbf{y}_i)}{c_0}\\right)\\right) + A_h \\cos\\left(2\\pi f_h \\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\\right) + \\eta_i(t),\n$$\n其中 $A_a$ 是声学振幅（帕斯卡），$f_a$ 是声学频率（赫兹），$A_h$ 是流体动力学振幅（帕斯卡），$f_h$ 是流体动力学频率（赫兹），$\\eta_i(t)$ 是零均值附加随机噪声，其振幅以帕斯卡指定。采样率为 $f_s$（赫兹），持续时间为 $T$（秒）。声速为 $c_0$（米/秒）。\n\n3. 通过表面上的对流对齐构建流体动力学压力估计，并将其减去以滤除流体动力学内容。定义对流对齐信号\n$$\nq_i(t) = p_s(\\mathbf{y}_i,\\, t + s(\\mathbf{y}_i)/U),\n$$\n和表面平均对齐信号\n$$\n\\overline{q}(t) = \\frac{1}{N_s} \\sum_{i=0}^{N_s-1} q_i(t).\n$$\n然后通过取消对齐来定义每个点的流体动力学估计\n$$\n\\widehat{p}_h(\\mathbf{y}_i,t) = \\overline{q}\\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right),\n$$\n并构建滤波后的压力\n$$\np_f(\\mathbf{y}_i,t) = p_s(\\mathbf{y}_i,t) - \\widehat{p}_h(\\mathbf{y}_i,t).\n$$\n所有时间平移都将通过时间上的线性插值来计算。此过程旨在移除大致以速度 $U$ 对流的分量，同时保留以接近 $c_0$ 的速度传播的分量。\n\n4. 通过推迟时间同步，计算固定观察者位置 $\\mathbf{x}_o$ 处的 FW-H 远场代理压力。对于每个表面点 $\\mathbf{y}_i$，计算声学推迟时间\n$$\nt_r^{(i)}(t) = t - \\frac{R_i}{c_0}, \\quad R_i = \\|\\mathbf{x}_o - \\mathbf{y}_i\\|.\n$$\n通过使用一个离散化的、保持压力单位的无量纲加权和来近似仅载荷的多孔 FW-H 贡献，\n$$\np'(\\mathbf{x}_o,t) \\approx \\sum_{i=0}^{N_s-1} w_i \\, p_f\\left(\\mathbf{y}_i,\\, t_r^{(i)}(t)\\right),\n$$\n其中\n$$\nw_i = \\frac{R_{\\mathrm{ref}}}{4\\pi R_i N_s},\n$$\n$R_{\\mathrm{ref}}$ 是一个固定的参考长度，设置为 $1\\,\\mathrm{m}$，以保持求和的无量纲性。推迟时间同步是通过在 $t_r^{(i)}(t)$ 处对 $p_f(\\mathbf{y}_i,t)$ 进行线性插值来实现的。\n\n5. 使用 Hann 窗 $w(t)$ 和快速傅里叶变换 (FFT)，计算 $p'(\\mathbf{x}_o,t)$ 的单边功率谱密度 (PSD) $S_{p'p'}(f)$。如果 $x[n]$ 是采样信号，$w[n]$ 是窗函数，$X[k]$ 是 $w[n] x[n]$ 的离散傅里叶变换，$f_s$ 是采样频率，$N$ 是样本数，以及 $U_w = \\frac{1}{N}\\sum_{n=0}^{N-1} w[n]^2$ 是窗函数功率，则单边 PSD 对频率 $f_k = k f_s/N$ 定义为\n$$\nS_{p'p'}(f_k) = \\begin{cases}\n\\frac{1}{f_s N U_w} |X[0]|^2,   k = 0, \\\\\n\\frac{2}{f_s N U_w} |X[k]|^2,   1 \\le k \\le \\frac{N}{2}-1, \\\\\n\\frac{1}{f_s N U_w} |X[N/2]|^2,   k = \\frac{N}{2} \\text{ 当 $N$ 为偶数时。}\n\\end{cases}\n$$\n通过取最接近每个目标频率的 FFT 箱，报告在声学频率 $f_a$ 和流体动力学频率 $f_h$ 处的 $S_{p'p'}(f)$。\n\n所有物理答案必须以帕斯卡平方每赫兹 ($\\mathrm{Pa}^2/\\mathrm{Hz}$) 表示。角度单位为弧度。报告数值时，请将每个值四舍五入到六位小数。\n\n测试套件：\n- 案例 1（一般情况）：\n  - $N_s = 64$, $a = 0.5\\,\\mathrm{m}$, $\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 800\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 200\\,\\mathrm{Hz}$, $A_h = 2.0\\,\\mathrm{Pa}$,\n  - $U = 100.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - 噪声振幅 $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\n- 案例 2（无流体动力学内容）：\n  - $N_s = 64$, $a = 0.5\\,\\mathrm{m}$, $\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 800\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 200\\,\\mathrm{Hz}$, $A_h = 0.0\\,\\mathrm{Pa}$,\n  - $U = 100.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - 噪声振幅 $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\n- 案例 3（近声速对流）：\n  - $N_s = 64$, $a = 0.5\\,\\mathrm{m}$, $\\mathbf{x}_o = (10.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 800\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 200\\,\\mathrm{Hz}$, $A_h = 2.0\\,\\mathrm{Pa}$,\n  - $U = 320.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - 噪声振幅 $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\n- 案例 4（稀疏表面采样和较小孔径）：\n  - $N_s = 8$, $a = 0.1\\,\\mathrm{m}$, $\\mathbf{x}_o = (5.0,0.0,0.0)\\,\\mathrm{m}$,\n  - $f_a = 1200\\,\\mathrm{Hz}$, $A_a = 1.0\\,\\mathrm{Pa}$,\n  - $f_h = 300\\,\\mathrm{Hz}$, $A_h = 2.0\\,\\mathrm{Pa}$,\n  - $U = 150.0\\,\\mathrm{m/s}$, $c_0 = 340.0\\,\\mathrm{m/s}$,\n  - 噪声振幅 $A_n = 0.05\\,\\mathrm{Pa}$,\n  - $f_s = 20000\\,\\mathrm{Hz}$, $T = 0.5\\,\\mathrm{s}$.\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试案例，报告两个以 $\\mathrm{Pa}^2/\\mathrm{Hz}$ 为单位并四舍五入到六位小数的值：首先是 $S_{p'p'}(f_a)$，然后是 $S_{p'p'}(f_h)$。因此，总输出应包含八个数字，按案例 1 到 4 的顺序排列，总格式为\n$$\n[\\;S_{p'p'}(f_a)_{\\text{案例 1}},\\,S_{p'p'}(f_h)_{\\text{案例 1}},\\,S_{p'p'}(f_a)_{\\text{案例 2}},\\,S_{p'p'}(f_h)_{\\text{案例 2}},\\,S_{p'p'}(f_a)_{\\text{案例 3}},\\,S_{p'p'}(f_h)_{\\text{案例 3}},\\,S_{p'p'}(f_a)_{\\text{案例 4}},\\,S_{p'p'}(f_h)_{\\text{案例 4}}\\;].\n$$",
            "solution": "该问题要求实现一个用于后处理合成航空声学数据的计算流程。该流程模拟 Ffowcs Williams–Hawkings (FW-H) 方法，包括一个关键的预处理步骤，以从源数据中滤除非传播的流体动力学压力脉动。解决方案的构建 meticulously 遵循了规定的数学和算法步骤。\n\n首先，我们建立计算域并生成源信号。在 $x$-$y$ 平面中定义一个以原点为中心、半径为 $a$ 的圆形可渗透控制面。该表面被离散化为 $N_s$ 个点，其位置由 $\\mathbf{y}_i = (a \\cos\\theta_i, a \\sin\\theta_i, 0)$ 给出，其中 $i = 0, 1, \\ldots, N_s-1$ 且 $\\theta_i = 2\\pi i/N_s$。每个点的外法向量为 $\\mathbf{n}_i = (\\cos\\theta_i, \\sin\\theta_i, 0)$。\n\n对于每个点 $\\mathbf{y}_i$，在持续时间 $T$ 内以采样率 $f_s$ 生成一个合成压力信号 $p_s(\\mathbf{y}_i,t)$。时间样本数为 $N = \\lfloor T f_s \\rfloor$。该信号由一个声学平面波、一个流体动力学对流扰动和附加的随机噪声组成。声波以声速 $c_0$ 传播，而流体动力学分量以不同的速度 $U$ 对流。两者都被定义为沿 $+x$ 方向传播。每个表面点 $\\mathbf{y}_i$ 处的信号由下式给出：\n$$\np_s(\\mathbf{y}_i,t) = A_a \\cos\\left(2\\pi f_a \\left(t - \\frac{s(\\mathbf{y}_i)}{c_0}\\right)\\right) + A_h \\cos\\left(2\\pi f_h \\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\\right) + \\eta_i(t)\n$$\n这里，$s(\\mathbf{y}_i) = \\hat{\\mathbf{e}}_x \\cdot \\mathbf{y}_i = a \\cos\\theta_i$ 是该点位置在传播方向上的投影。$A_a$ 和 $f_a$ 是声学振幅和频率，$A_h$ 和 $f_h$ 是流体动力学振幅和频率，而 $\\eta_i(t)$ 是具有指定振幅 $A_n$ 的零均值随机噪声。为了计算的可复现性，噪声是使用固定的随机种子从 $[-A_n, A_n]$ 上的均匀分布生成的。\n\n第二个主要步骤是过滤流体动力学压力分量。这是通过一种对流对齐和相减的技术来实现的。对于每个表面点 $\\mathbf{y}_i$，信号 $p_s$ 被进行时间平移，以对齐以速度 $U$ 对流的事件：\n$$\nq_i(t) = p_s\\left(\\mathbf{y}_i, t + \\frac{s(\\mathbf{y}_i)}{U}\\right)\n$$\n代入 $p_s$ 的表达式，$q_i(t)$ 的流体动力学部分变为 $A_h \\cos(2\\pi f_h t)$，现在在所有表面点上都是同步的，与其位置 $s(\\mathbf{y}_i)$无关。然而，声学部分仍然依赖于 $s(\\mathbf{y}_i)$，因为其相位与 $c_0$ 相关。通过在整个表面上对这些对齐的信号进行平均，空间上不相干的声学和噪声分量被衰減，而相干的流体动力学分量被保留下来：\n$$\n\\overline{q}(t) = \\frac{1}{N_s} \\sum_{i=0}^{N_s-1} q_i(t) \\approx A_h \\cos(2\\pi f_h t)\n$$\n这个表面平均信号 $\\overline{q}(t)$ 作为参考位置（$s=0$）处孤立流体动力学脉动的估计。然后将此估计时间平移回到每个点的原始坐标系，以构建流体动力学压力场估计：\n$$\n\\widehat{p}_h(\\mathbf{y}_i,t) = \\overline{q}\\left(t - \\frac{s(\\mathbf{y}_i)}{U}\\right)\n$$\n最后，将此估计从原始信号中减去，得到滤波后的压力，理想情况下它只包含声学信号和残余噪声：\n$$\np_f(\\mathbf{y}_i,t) = p_s(\\mathbf{y}_i,t) - \\widehat{p}_h(\\mathbf{y}_i,t)\n$$\n所有需要的时间平移都是通过对离散时间序列数据使用线性插值来数值执行的。\n\n第三步是使用简化的多孔 FW-H 积分公式计算远场观察者压力 $p'(\\mathbf{x}_o,t)$。这涉及到对所有表面点的贡献求和，每个贡献都在其特定的推迟时间进行评估。从点 $\\mathbf{y}_i$ 发出的信号在时间 $t$ 被观察者位置 $\\mathbf{x}_o$ 接收到的推迟时间 $t_r^{(i)}$ 为：\n$$\nt_r^{(i)}(t) = t - \\frac{R_i}{c_0}, \\quad \\text{其中} \\quad R_i = \\|\\mathbf{x}_o - \\mathbf{y}_i\\|\n$$\n远场代理壓力是滤波后压力在其各自推迟时间下求值的加权和：\n$$\np'(\\mathbf{x}_o,t) \\approx \\sum_{i=0}^{N_s-1} w_i \\, p_f\\left(\\mathbf{y}_i,\\, t_r^{(i)}(t)\\right)\n$$\n权重 $w_i$ 由 $w_i = \\frac{R_{\\mathrm{ref}}}{4\\pi R_i N_s}$ 给出，其中 $R_{\\mathrm{ref}}=1\\,\\mathrm{m}$ 是一个参考长度。此求和是通过在所需的推迟时间样本 $t_r^{(i)}(t)$ 处对每个滤波信号 $p_f(\\mathbf{y}_i, t)$ 进行插值来执行的。\n\n最后一步是通过计算其单边功率谱密度 (PSD) $S_{p'p'}(f)$ 来分析所得观察者压力信号 $p'(\\mathbf{x}_o,t)$ 的频率内容。长度为 $N$ 的信号首先乘以一个 Hann 窗 $w[n]$ 以减少频谱泄漏。计算加窗信号的离散傅里叶变换 (DFT) $X[k]$。然后根据以下公式计算单边 PSD：\n$$\nS_{p'p'}(f_k) = \\begin{cases}\n\\frac{1}{f_s N U_w} |X[0]|^2,   k = 0 \\\\\n\\frac{2}{f_s N U_w} |X[k]|^2,   1 \\le k \\le N/2 - 1 \\\\\n\\frac{1}{f_s N U_w} |X[N/2]|^2,   k = N/2 \\text{ (对于偶数 } N\\text{)}\n\\end{cases}\n$$\n其中 $f_k = k f_s/N$ 是离散频率，$U_w = \\frac{1}{N}\\sum_{n=0}^{N-1} w[n]^2$ 是窗函数功率校正因子。在最接近指定声学频率 $f_a$ 和流体动力学频率 $f_h$ 的频率箱处报告 PSD 值。\n\n整个过程被封装在一个 Python 脚本中。为提高效率，使用了向量化的 `numpy` 操作，而对于涉及跨表面点非均匀时间平移的步骤（滤波和推迟时间评估），则使用了循环。所有插值都由 `numpy.interp` 处理。该脚本遍历所提供的测试案例，为每个案例计算两个要求的 PSD 值，并将输出格式化为包含四舍五入后小数的单个列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef process_case(Ns, a, xo, fa, Aa, fh, Ah, U, c0, An, fs, T):\n    \"\"\"\n    Implements the full aeroacoustic post-processing pipeline for a single test case.\n    \"\"\"\n    # Set seed for reproducibility of noise. Using a combination of inputs to\n    # ensure noise is different per case but reproducible for the same case.\n    # A simple seed like 0 is sufficient, but this is more robust if case parameters were permuted.\n    seed_val = Ns + int(a*10) + int(xo[0]) + int(fa) + int(fh)\n    np.random.seed(seed_val)\n\n    # Step 1: Define a circular, permeable FW-H control surface and time array\n    N = int(T * fs)\n    t = np.linspace(0, T, N, endpoint=False)\n    dt = T / N\n\n    theta_i = 2 * np.pi * np.arange(Ns) / Ns\n    y_i = np.zeros((Ns, 3))\n    y_i[:, 0] = a * np.cos(theta_i)\n    y_i[:, 1] = a * np.sin(theta_i)\n    \n    # Step 2: Generate synthetic LES surface pressure signals\n    s_i = y_i[:, 0]  # Projection coordinate s(y_i) = x-component\n    \n    # Use broadcasting for efficient signal generation\n    t_grid = t[np.newaxis, :]\n    s_grid = s_i[:, np.newaxis]\n\n    acoustic_part = Aa * np.cos(2 * np.pi * fa * (t_grid - s_grid / c0))\n    hydro_part = Ah * np.cos(2 * np.pi * fh * (t_grid - s_grid / U))\n    noise_part = np.random.uniform(-An, An, size=(Ns, N))\n    \n    p_s = acoustic_part + hydro_part + noise_part\n    \n    # Step 3: Construct a hydrodynamic pressure estimate and filter\n    q = np.zeros_like(p_s)\n    for i in range(Ns):\n        t_aligned = t + s_i[i] / U\n        # Interpolate p_s at aligned times. Extrapolate with 0.\n        q[i, :] = np.interp(t_aligned, t, p_s[i, :], left=0.0, right=0.0)\n        \n    q_bar = np.mean(q, axis=0)\n    \n    p_h_hat = np.zeros_like(p_s)\n    for i in range(Ns):\n        t_dealigned = t - s_i[i] / U\n        # Interpolate q_bar at de-aligned times. Extrapolate with 0.\n        p_h_hat[i, :] = np.interp(t_dealigned, t, q_bar, left=0.0, right=0.0)\n        \n    p_f = p_s - p_h_hat\n    \n    # Step 4: Compute the FW-H far-field proxy pressure\n    xo_vec = np.array(xo)\n    R_i = np.linalg.norm(xo_vec - y_i, axis=1)\n    \n    R_ref = 1.0\n    w_i = R_ref / (4 * np.pi * R_i * Ns)\n    \n    p_prime = np.zeros(N)\n    for i in range(Ns):\n        t_r = t - R_i[i] / c0\n        p_f_retarded = np.interp(t_r, t, p_f[i, :], left=0.0, right=0.0)\n        p_prime += w_i[i] * p_f_retarded\n        \n    # Step 5: Compute the one-sided power spectral density (PSD)\n    x = p_prime\n    win = np.hanning(N)\n    # Window power correction factor\n    Uw = np.mean(win**2)\n    \n    x_w = x * win\n    X = np.fft.fft(x_w)\n    \n    freqs = np.fft.fftfreq(N, d=dt)\n    \n    psd = np.abs(X)**2 / (fs * N * Uw)\n    \n    # Correct for one-sided PSD, handling N even or odd\n    psd_one_sided = psd[:N//2 + 1]\n    freqs_one_sided = freqs[:N//2 + 1]\n    \n    # Double the power for non-DC and non-Nyquist frequencies\n    if N % 2 == 0:\n        psd_one_sided[1:-1] *= 2\n    else: # N is odd\n        psd_one_sided[1:] *= 2\n\n    # Find PSD values at frequencies closest to fa and fh\n    idx_fa = np.argmin(np.abs(freqs_one_sided - fa))\n    S_fa = psd_one_sided[idx_fa]\n    \n    idx_fh = np.argmin(np.abs(freqs_one_sided - fh))\n    S_fh = psd_one_sided[idx_fh]\n    \n    return S_fa, S_fh\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general case)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 2.0, 'U': 100.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 2 (no hydrodynamic content)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 0.0, 'U': 100.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 3 (near-sonic convection)\n        {'Ns': 64, 'a': 0.5, 'xo': (10.0, 0.0, 0.0), 'fa': 800, 'Aa': 1.0, \n         'fh': 200, 'Ah': 2.0, 'U': 320.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n        # Case 4 (sparse surface sampling and smaller aperture)\n        {'Ns': 8, 'a': 0.1, 'xo': (5.0, 0.0, 0.0), 'fa': 1200, 'Aa': 1.0, \n         'fh': 300, 'Ah': 2.0, 'U': 150.0, 'c0': 340.0, 'An': 0.05, \n         'fs': 20000, 'T': 0.5},\n    ]\n\n    results = []\n    for case in test_cases:\n        S_fa, S_fh = process_case(**case)\n        results.append(round(S_fa, 6))\n        results.append(round(S_fh, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}