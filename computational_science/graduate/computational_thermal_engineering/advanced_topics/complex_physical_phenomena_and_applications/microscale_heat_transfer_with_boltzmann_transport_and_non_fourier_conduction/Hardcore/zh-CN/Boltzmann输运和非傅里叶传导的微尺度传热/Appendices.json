{
    "hands_on_practices": [
        {
            "introduction": "在模拟热量如何“运动”（输运）之前，我们必须首先理解能量是如何在材料的晶格振动中“储存”（热力学）的。本练习通过应用德拜模型，深入探讨了微尺度传热的热力学基础。通过从第一性原理推导体积比热，您将巩固对声子作为量子气体的理解，并获得一个关键的材料属性 $C(T)$，该属性决定了玻尔兹曼输运方程和其他高级热传导模型中的能量储存项 。",
            "id": "3970662",
            "problem": "将一个三维晶体电介质建模为各向同性的类德拜声子气体，其色散关系为 $\\omega = v k$，直至截止角频率 $\\omega_{D}$。存在三种声学极化，晶体在体积 $V$ 内包含 $N$ 个原子，从而得到原子数密度 $n = N/V$。德拜截止频率的定义要求是振动模式总数等于 $3N$。德拜温度定义为 $\\theta_{D} = \\hbar \\omega_{D}/k_{B}$，其中 $\\hbar$ 是约化普朗克常数，$k_{B}$ 是玻尔兹曼常数。在非傅里叶热传导的计算热工模型（如 Guyer–Krumhansl 框架）中，体积比热 $C(T)$ 为声子能量密度提供了平衡热力学封闭。\n\n从平衡状态下的声子玻尔兹曼输运方程和玻色-爱因斯坦占据数 $n_{B}(\\omega,T) = \\left[\\exp\\!\\left(\\hbar \\omega/k_{B}T\\right) - 1\\right]^{-1}$ 出发，仅使用各向同性色散和德拜截止归一化，推导恒定体积下的体积比热 $C(T)$。假设零点能不对 $C(T)$ 做出贡献。你的推导应：\n- 根据色散关系和模式计数约束，构建单位体积内的态密度 $g(\\omega)$。\n- 将内能密度 $u(T)$ 写成关于 $\\omega$ 的积分，然后对 $T$ 求导以获得 $C(T) = \\partial u/\\partial T$。\n\n用文字和方程讨论 $T \\ll \\theta_{D}$ 时的低温行为，并确定其主导项的 $T^{3}$ 定律及其以 $n$、$k_{B}$ 和 $\\theta_{D}$ 表示的前置因子。\n\n答案要求：\n- 以 $n$、$k_{B}$、$\\theta_{D}$、$T$ 以及标准数学常数和函数表示的单个闭合形式解析表达式报告 $C(T)$（单位体积）的最终答案。\n- 以焦耳每立方米-开尔文为单位表示 $C(T)$。\n- 最终答案不要求进行数值近似或四舍五入。",
            "solution": "该问题要求使用德拜模型推导晶体电介质的体积比热 $C(T)$，并分析其低温行为。该问题在科学上是合理的、提法明确，并包含了完整推导所需的所有必要信息。\n\n推导过程分为四个主要步骤：\n1.  构建单位体积内的声子态密度 $g(\\omega)$。\n2.  建立内能密度 $u(T)$ 的公式。\n3.  对 $u(T)$ 关于温度 $T$ 求导以获得比热 $C(T)$。\n4.  分析低温极限（$T \\ll \\theta_D$）以找到德拜 $T^3$ 定律。\n\n**步骤 1：声子态密度 $g(\\omega)$**\n\n在三维晶体中，允许的声子波矢 $\\vec{k}$ 在 $k$ 空间中形成一个密集的网格。$k$ 空间中一个微小体积元 $d^3k$ 内的允许态数为 $V \\frac{d^3k}{(2\\pi)^3}$，其中 $V$ 是晶体的体积。问题指明存在三种声学极化（两个横波，一个纵波），所以我们必须将态数乘以因子 $3$。\n\n在波矢元 $d^3k$ 内的振动模式数 $d\\mathcal{N}$ 为：\n$$\nd\\mathcal{N} = 3 \\cdot V \\frac{d^3k}{(2\\pi)^3}\n$$\n问题假设介质是各向同性的，其色散关系 $\\omega = vk$ 仅取决于波矢的大小 $k=|\\vec{k}|$。因此，我们可以用球坐标表示体积元为 $d^3k = 4\\pi k^2 dk$。半径为 $k$、厚度为 $dk$ 的球壳中的模式数为：\n$$\nd\\mathcal{N} = 3V \\frac{4\\pi k^2 dk}{(2\\pi)^3} = \\frac{3V}{2\\pi^2} k^2 dk\n$$\n为了找到作为角频率 $\\omega$ 函数的态密度，我们使用线性色散关系 $\\omega = vk$。由此可得 $k = \\omega/v$ 和 $dk = d\\omega/v$。将这些代入 $d\\mathcal{N}$ 的表达式中：\n$$\nd\\mathcal{N} = \\frac{3V}{2\\pi^2} \\left(\\frac{\\omega}{v}\\right)^2 \\left(\\frac{d\\omega}{v}\\right) = \\frac{3V\\omega^2}{2\\pi^2 v^3} d\\omega\n$$\n总态密度 $G(\\omega)$ 定义为 $d\\mathcal{N} = G(\\omega)d\\omega$。单位体积内的态密度 $g(\\omega)$ 为 $G(\\omega)/V$：\n$$\ng(\\omega) = \\frac{1}{V} \\frac{d\\mathcal{N}}{d\\omega} = \\frac{3\\omega^2}{2\\pi^2 v^3}\n$$\n该态密度在德拜截止频率 $\\omega_D$ 以下有效。$\\omega_D$ 的值由总模式数等于 $3N$ 的约束条件确定，其中 $N$ 是晶体中的原子数。单位体积内的总模式数为 $3N/V = 3n$。\n$$\n\\int_0^{\\omega_D} g(\\omega) d\\omega = 3n\n$$\n代入 $g(\\omega)$ 的表达式：\n$$\n\\int_0^{\\omega_D} \\frac{3\\omega^2}{2\\pi^2 v^3} d\\omega = \\frac{3}{2\\pi^2 v^3} \\left[\\frac{\\omega^3}{3}\\right]_0^{\\omega_D} = \\frac{\\omega_D^3}{2\\pi^2 v^3} = 3n\n$$\n这给出了 $\\omega_D$、$v$ 和原子数密度 $n$ 之间的关系：$\\omega_D^3 = 6\\pi^2 n v^3$。我们可以用这个关系从 $g(\\omega)$ 的表达式中消去声子速度 $v$：\n$$\n\\frac{1}{v^3} = \\frac{6\\pi^2 n}{\\omega_D^3}\n$$\n将此代回 $g(\\omega)$：\n$$\ng(\\omega) = \\frac{3\\omega^2}{2\\pi^2} \\left(\\frac{6\\pi^2 n}{\\omega_D^3}\\right) = \\frac{9n}{\\omega_D^3} \\omega^2\n$$\n这个单位体积态密度的表达式在 $0 \\le \\omega \\le \\omega_D$ 范围内有效，而在 $\\omega > \\omega_D$ 时为零。\n\n**步骤 2：内能密度 $u(T)$**\n\n频率为 $\\omega$ 的声子模式的能量为 $E(\\omega) = \\hbar\\omega$。在温度 $T$ 下，该模式的平均能量由其能量乘以玻色-爱因斯坦占据数 $n_B(\\omega, T)$ 给出。问题要求忽略零点能，因此我们只考虑能量中与温度相关的部分。\n$$\n\\langle E(\\omega, T) \\rangle = \\hbar\\omega \\, n_B(\\omega, T) = \\frac{\\hbar\\omega}{\\exp(\\hbar\\omega/k_B T) - 1}\n$$\n单位体积内的总内能 $u(T)$，是通过对所有可能的模式的平均能量进行积分得到的，并由态密度 $g(\\omega)$ 进行加权：\n$$\nu(T) = \\int_0^{\\omega_D} \\langle E(\\omega, T) \\rangle g(\\omega) d\\omega = \\int_0^{\\omega_D} \\frac{\\hbar\\omega}{\\exp(\\hbar\\omega/k_B T) - 1} \\left(\\frac{9n}{\\omega_D^3} \\omega^2\\right) d\\omega\n$$\n$$\nu(T) = \\frac{9n\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\frac{\\omega^3}{\\exp(\\hbar\\omega/k_B T) - 1} d\\omega\n$$\n\n**步骤 3：体积比热 $C(T)$**\n\n恒定体积下的体积比热 $C(T)$ 是内能密度对温度的导数：$C(T) = (\\partial u/\\partial T)_V$。由于积分限与 $T$ 无关，我们可以在积分号下进行微分。\n$$\nC(T) = \\frac{\\partial}{\\partial T} \\left[ \\frac{9n\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\frac{\\omega^3}{\\exp(\\hbar\\omega/k_B T) - 1} d\\omega \\right] = \\frac{9n\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\omega^3 \\frac{\\partial}{\\partial T} \\left( \\frac{1}{\\exp(\\hbar\\omega/k_B T) - 1} \\right) d\\omega\n$$\n占据因子的导数为：\n$$\n\\frac{\\partial}{\\partial T} \\left( \\frac{1}{\\exp(a/T) - 1} \\right) = - \\frac{1}{(\\exp(a/T) - 1)^2} \\cdot \\exp(a/T) \\cdot \\left(-\\frac{a}{T^2}\\right) = \\frac{a}{T^2} \\frac{\\exp(a/T)}{(\\exp(a/T) - 1)^2}\n$$\n其中 $a = \\hbar\\omega/k_B$。将此代回 $C(T)$ 的表达式：\n$$\nC(T) = \\frac{9n\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\omega^3 \\left( \\frac{\\hbar\\omega}{k_B T^2} \\frac{\\exp(\\hbar\\omega/k_B T)}{(\\exp(\\hbar\\omega/k_B T) - 1)^2} \\right) d\\omega\n$$\n$$\nC(T) = \\frac{9n\\hbar^2}{k_B T^2 \\omega_D^3} \\int_0^{\\omega_D} \\frac{\\omega^4 \\exp(\\hbar\\omega/k_B T)}{(\\exp(\\hbar\\omega/k_B T) - 1)^2} d\\omega\n$$\n为简化此积分，我们引入无量纲变量 $x = \\hbar\\omega/(k_B T)$。这意味着 $\\omega = x k_B T / \\hbar$ 且 $d\\omega = (k_B T / \\hbar) dx$。积分上限变为 $x_D = \\hbar\\omega_D/(k_B T) = \\theta_D/T$，其中 $\\theta_D$ 是德拜温度。\n$$\nC(T) = \\frac{9n\\hbar^2}{k_B T^2 \\omega_D^3} \\int_0^{\\theta_D/T} \\frac{(x k_B T / \\hbar)^4 \\exp(x)}{(\\exp(x) - 1)^2} \\left( \\frac{k_B T}{\\hbar} dx \\right)\n$$\n$$\nC(T) = \\frac{9n\\hbar^2}{k_B T^2 \\omega_D^3} \\left(\\frac{k_B T}{\\hbar}\\right)^5 \\int_0^{\\theta_D/T} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx\n$$\n$$\nC(T) = \\frac{9n k_B^4 T^3}{\\hbar^3 \\omega_D^3} \\int_0^{\\theta_D/T} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx\n$$\n使用德拜温度的定义 $\\hbar \\omega_D = k_B \\theta_D$，我们有 $\\hbar^3 \\omega_D^3 = k_B^3 \\theta_D^3$。将此代入前置因子：\n$$\nC(T) = \\frac{9n k_B^4 T^3}{k_B^3 \\theta_D^3} \\int_0^{\\theta_D/T} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx\n$$\n这简化为体积比热的最终表达式：\n$$\nC(T) = 9n k_B \\left( \\frac{T}{\\theta_D} \\right)^3 \\int_0^{\\theta_D/T} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx\n$$\n\n**步骤 4：低温行为（$T \\ll \\theta_D$）**\n\n在低温极限下，$T \\ll \\theta_D$，积分上限 $x_D = \\theta_D/T$ 趋于无穷大。物理上，这意味着在极低温度下，只有低频声学声子被激发，它们的能量与德拜能量（$k_B\\theta_D$）相比非常小，以至于频率截止的存在其影响可以忽略不计。因此，积分可以扩展到无穷大：\n$$\nC(T) \\approx 9n k_B \\left( \\frac{T}{\\theta_D} \\right)^3 \\int_0^{\\infty} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx \\quad \\text{当 } T \\ll \\theta_D \\text{ 时}\n$$\n这个定积分是一个标准形式。它可以通过分部积分法计算，其中 $u=x^4$ 且 $dv = \\frac{e^x}{(e^x-1)^2}dx$，结果为 $4\\int_0^\\infty \\frac{x^3}{e^x-1}dx$。这与黎曼zeta函数 $\\zeta(s)$ 和伽马函数 $\\Gamma(s)$ 相关，通过 $\\int_0^\\infty \\frac{t^{s-1}}{e^t-1}dt = \\Gamma(s)\\zeta(s)$。对于 $s=4$，积分为 $\\int_0^\\infty \\frac{x^3}{e^x-1}dx = \\Gamma(4)\\zeta(4) = 3! \\cdot \\frac{\\pi^4}{90} = \\frac{\\pi^4}{15}$。因此，原积分为：\n$$\n\\int_0^{\\infty} \\frac{x^4 \\exp(x)}{(\\exp(x) - 1)^2} dx = 4 \\times \\frac{\\pi^4}{15} = \\frac{4\\pi^4}{15}\n$$\n将该值代入 $C(T)$ 的表达式中：\n$$\nC(T) \\approx 9n k_B \\left( \\frac{T}{\\theta_D} \\right)^3 \\left( \\frac{4\\pi^4}{15} \\right) = \\frac{12\\pi^4}{5} n k_B \\left( \\frac{T}{\\theta_D} \\right)^3\n$$\n这就是著名的德拜 $T^3$ 定律，描述了固体在低温下的比热。其主导行为是 $C(T) \\propto T^3$。用指定变量表示的前置因子是 $\\frac{12\\pi^4 n k_B}{5 \\theta_D^3}$。",
            "answer": "$$\\boxed{9n k_{B} \\left( \\frac{T}{\\theta_{D}} \\right)^{3} \\int_{0}^{\\theta_{D}/T} \\frac{x^{4} \\exp(x)}{(\\exp(x) - 1)^{2}} dx}$$"
        },
        {
            "introduction": "当器件尺寸缩小至声子平均自由程的尺度时，傅里叶定律便会失效，这是一个众所周知的现象。本练习旨在解决此问题，引导您为薄膜的表观热导率构建一个简洁而强大的模型。通过应用马西森法则，结合内部散射（扩散极限）和边界散射（弹道极限）的热阻，您将推导出一个统一这两个机制的标度函数，并揭示克努森数 $Kn$ 的核心作用 。",
            "id": "3970685",
            "problem": "考虑一个厚度为 $L$ 的一维薄膜，其边界保持在等温 $T_{\\mathrm{hot}}$ 和 $T_{\\mathrm{cold}}$。假设在弛豫时间近似下，声子气体是各向同性的灰体。从玻尔兹曼输运方程 (BTE) 出发，推导体热导率和单位面积的弹道热导的表达式，然后将它们结合起来，得到与长度相关的表观热导率。目标是计算作为努森数函数的归一化表观热导率，然后拟合一个在弹道和扩散极限之间插值的标度函数。\n\n基本原理：\n- 基于能量载流子弛豫时间近似的玻尔兹曼输运方程 (BTE)。\n- 幅值为 $v$、弛豫时间为 $\\tau$ 的声子群速度的各向同性分布。\n- 体积热容 $C$。\n- 具有局部平衡发射的漫反射边界。\n\n定义和目标：\n- 平均自由程为 $\\Lambda = v \\tau$。\n- 努森数为 $Kn = \\Lambda / L$。\n- 体热导率为 $k_{\\mathrm{bulk}}$。\n- 单位面积的弹道热导为 $g_{\\mathrm{ball}}$。\n- 表观热导率为 $k_{\\mathrm{app}}(L)$，单位为 $\\mathrm{W/(m\\cdot K)}$。\n- 抑制函数为 $S(Kn) = k_{\\mathrm{app}}(L) / k_{\\mathrm{bulk}}$。\n\n您必须：\n1. 在各向同性灰体近似下，从玻尔兹曼输运方程 (BTE) 推导 $k_{\\mathrm{bulk}}$。\n2. 通过对具有微小温差的半空间中的能量通量进行积分来推导 $g_{\\mathrm{ball}}$。\n3. 通过将它们的单位面积热阻相加，来组合扩散和弹道贡献，从而得到与两种极限行为都一致的 $k_{\\mathrm{app}}(L)$：\n   - 弹道极限 ($Kn \\to \\infty$)：$k_{\\mathrm{app}}(L)$ 应与 $L$ 线性相关。\n   - 扩散极限 ($Kn \\to 0$)：$k_{\\mathrm{app}}(L) \\to k_{\\mathrm{bulk}}$。\n4. 对于每个测试用例，在 $L_{\\min}$ 和 $L_{\\max}$ 之间生成 $N$ 个对数间隔的厚度 $L$，计算单位为 $\\mathrm{W/(m\\cdot K)}$ 的 $k_{\\mathrm{app}}(L)$，构建 $S(Kn)$，并通过最小二乘法将标度函数\n   $$ s(Kn; \\alpha, \\beta) = \\frac{1}{1 + \\alpha \\, Kn^{\\beta}} $$\n   拟合到计算出的 $S(Kn)$ 数据上。报告拟合参数 $\\alpha$ 和 $\\beta$（以小数形式），在采样 $Kn$ 范围内 $s(Kn; \\alpha, \\beta)$ 与 $S(Kn)$ 之间的最大绝对偏差，以及通过数据集中可用的最大 $Kn$ 值数值计算得到的弹道前因子 $\\lim_{Kn \\to \\infty} Kn \\, S(Kn)$ 的估计值。\n\n物理单位和输出要求：\n- 以 $\\mathrm{W/(m\\cdot K)}$ 为单位表示 $k_{\\mathrm{app}}(L)$。\n- 所有输入材料参数必须使用其指定的单位。\n- 拟合参数 $\\alpha$ 和 $\\beta$ 是无量纲的，并且必须以小数形式报告。\n- 弹道前因子估计值必须以小数形式报告。\n\n测试套件：\n- 情况 1：$C = 2.0\\times 10^{6}\\,\\mathrm{J/(m^{3}\\cdot K)}$，$v = 6000\\,\\mathrm{m/s}$，$\\tau = 1.0\\times 10^{-9}\\,\\mathrm{s}$，$L_{\\min} = 1.0\\times 10^{-8}\\,\\mathrm{m}$，$L_{\\max} = 1.0\\times 10^{-3}\\,\\mathrm{m}$，$N = 30$。\n- 情况 2：$C = 1.5\\times 10^{6}\\,\\mathrm{J/(m^{3}\\cdot K)}$，$v = 4000\\,\\mathrm{m/s}$，$\\tau = 5.0\\times 10^{-10}\\,\\mathrm{s}$，$L_{\\min} = 5.0\\times 10^{-9}\\,\\mathrm{m}$，$L_{\\max} = 5.0\\times 10^{-2}\\,\\mathrm{m}$，$N = 35$。\n- 情况 3：$C = 3.0\\times 10^{6}\\,\\mathrm{J/(m^{3}\\cdot K)}$，$v = 10000\\,\\mathrm{m/s}$，$\\tau = 2.0\\times 10^{-10}\\,\\mathrm{s}$，$L_{\\min} = 1.0\\times 10^{-9}\\,\\mathrm{m}$，$L_{\\max} = 1.0\\times 10^{-4}\\,\\mathrm{m}$，$N = 40$。\n\n您的程序应生成单行输出，其中包含所有测试用例的结果，结果形式为方括号内以逗号分隔的列表。每个测试用例的结果本身必须是包含四个小数的列表 $[\\alpha, \\beta, \\text{max\\_abs\\_error}, \\text{ballistic\\_prefactor\\_estimate}]$，因此最终输出必须是像\n$[[\\alpha_{1}, \\beta_{1}, \\epsilon_{1}, c_{1}], [\\alpha_{2}, \\beta_{2}, \\epsilon_{2}, c_{2}], [\\alpha_{3}, \\beta_{3}, \\epsilon_{3}, c_{3}]]$ 这样的单个列表。",
            "solution": "该问题被认为是有效的，因为它科学地基于微尺度传热原理，并且提供了所有必要的信息，问题是适定且客观的。我们将继续进行求解，这包括从第一性原理进行推导，然后进行数值计算和拟合。\n\n### 第 1 步：体热导率 ($k_{\\mathrm{bulk}}$) 的推导\n\n起点是弛豫时间近似 (RTA) 下的稳态玻尔兹曼输运方程 (BTE)：\n$$ \\vec{v} \\cdot \\nabla f = -\\frac{f - f_0}{\\tau} $$\n此处，$f$ 是声子分布函数，$f_0$ 是局域平衡玻色-爱因斯坦分布，$\\vec{v}$ 是声子群速度，$\\tau$ 是弛豫时间。我们考虑沿 $x$ 轴的微小温度梯度 $\\frac{dT}{dx}$。分布函数 $f$ 可以近似为对平衡态的微小偏离：\n$$ f \\approx f_0 - \\tau (\\vec{v} \\cdot \\nabla f) \\approx f_0 - \\tau v_x \\frac{\\partial f_0}{\\partial T} \\frac{dT}{dx} $$\n$x$ 方向的热通量 $q_x$ 是由声子能量和速度加权的分布函数的一阶矩。在灰体模型中，我们可以用声子能量密度来表示它。热通量由下式给出：\n$$ q_x = \\int v_x (e - e_0) \\frac{d\\Omega}{4\\pi} = \\int v_x \\left( C(T) (T(\\vec{r}) - T_0) \\right) \\frac{d\\Omega}{4\\pi} $$\n一种更标准的动理学理论方法直接得出结果。热通量为 $q_x = \\sum_{\\vec{k},p} \\hbar\\omega v_x f$。代入 $f$ 的表达式：\n$$ q_x = \\sum_{\\vec{k},p} \\hbar\\omega v_x \\left( f_0 - \\tau v_x \\frac{\\partial f_0}{\\partial T} \\frac{dT}{dx} \\right) $$\n由于对称性，涉及 $f_0$ 的项积分为零。剩余项为：\n$$ q_x = - \\frac{dT}{dx} \\sum_{\\vec{k},p} \\tau \\hbar\\omega v_x^2 \\frac{\\partial f_0}{\\partial T} $$\n在各向同性灰体模型中，$\\tau$ 和速度大小 $v$ 是恒定的。在三维各向同性分布中，$v_x^2$ 的方向平均值为 $\\langle v_x^2 \\rangle = v^2/3$。求和项与体积热容相关，$C = \\frac{d}{dT} \\sum_{\\vec{k},p} \\hbar\\omega f_0 = \\sum_{\\vec{k},p} \\hbar\\omega \\frac{\\partial f_0}{\\partial T}$。\n将这些代入 $q_x$ 的表达式中：\n$$ q_x = - \\frac{dT}{dx} \\left( \\frac{1}{3} v^2 \\tau \\sum_{\\vec{k},p} \\hbar\\omega \\frac{\\partial f_0}{\\partial T} \\right) = - \\left( \\frac{1}{3} C v^2 \\tau \\right) \\frac{dT}{dx} $$\n通过与傅里叶定律 $q_x = -k_{\\mathrm{bulk}} \\frac{dT}{dx}$ 进行比较，我们确定体热导率：\n$$ k_{\\mathrm{bulk}} = \\frac{1}{3} C v^2 \\tau $$\n使用平均自由程的定义 $\\Lambda = v \\tau$，上式变为：\n$$ k_{\\mathrm{bulk}} = \\frac{1}{3} C v \\Lambda $$\n\n### 第 2 步：弹道热导 ($g_{\\mathrm{ball}}$) 的推导\n\n在弹道极限 ($L \\ll \\Lambda$)下，声子从一个边界传播到另一个边界而不发生散射。净热通量是热壁和冷壁发出的能量通量之差。对于一个温度为 $T$ 的表面向半空间漫反射发射，单位面积的能量通量由下式给出：\n$$ q_{\\text{emission}} = \\int_{\\text{hemisphere}} (v \\cos\\theta) \\frac{U(T)}{4\\pi} d\\Omega $$\n此处，$U(T)$ 是内能密度，$\\theta$ 是相对于表面法线的角度。$\\cos\\theta$ 在半球上的积分得到一个因子 $\\pi$。\n$$ q_{\\text{emission}} = (v \\frac{U(T)}{4\\pi}) \\int_0^{2\\pi} \\int_0^{\\pi/2} \\cos\\theta \\sin\\theta d\\theta d\\phi = \\frac{v U(T)}{4\\pi} (\\pi) = \\frac{1}{4} v U(T) $$\n温度为 $T_{\\mathrm{hot}}$ 和 $T_{\\mathrm{cold}}$ 的壁之间的净热通量 $q_{\\mathrm{net}}$ 是：\n$$ q_{\\mathrm{net}} = q_{\\mathrm{hot \\to cold}} - q_{\\mathrm{cold \\to hot}} = \\frac{1}{4} v U(T_{\\mathrm{hot}}) - \\frac{1}{4} v U(T_{\\mathrm{cold}}) = \\frac{1}{4} v [U(T_{\\mathrm{hot}}) - U(T_{\\mathrm{cold}})] $$\n对于一个微小的温差 $\\Delta T = T_{\\mathrm{hot}} - T_{\\mathrm{cold}}$，我们有 $U(T_{\\mathrm{hot}}) - U(T_{\\mathrm{cold}}) \\approx \\frac{dU}{dT} \\Delta T = C \\Delta T$。\n$$ q_{\\mathrm{net}} = \\frac{1}{4} C v \\Delta T $$\n单位面积的弹道热导 $g_{\\mathrm{ball}}$ 定义为 $q_{\\mathrm{net}} = g_{\\mathrm{ball}} \\Delta T$。因此：\n$$ g_{\\mathrm{ball}} = \\frac{1}{4} C v $$\n\n### 第 3 步：表观热导率 ($k_{\\mathrm{app}}(L)$) 的推导\n\n我们通过将它们的单位面积热阻相加来组合扩散（体）和弹道（边界）效应，这是 Matthiessen 法则的一个应用。体热阻为 $R''_{\\mathrm{bulk}} = L/k_{\\mathrm{bulk}}$，弹道/边界热阻为 $R''_{\\mathrm{ball}} = 1/g_{\\mathrm{ball}}$。\n单位面积的总热阻为：\n$$ R''_{\\mathrm{total}} = R''_{\\mathrm{bulk}} + R''_{\\mathrm{ball}} = \\frac{L}{k_{\\mathrm{bulk}}} + \\frac{1}{g_{\\mathrm{ball}}} $$\n表观热导率 $k_{\\mathrm{app}}(L)$ 通过总热阻定义为 $R''_{\\mathrm{total}} = L/k_{\\mathrm{app}}(L)$。\n$$ \\frac{L}{k_{\\mathrm{app}}(L)} = \\frac{L}{k_{\\mathrm{bulk}}} + \\frac{1}{g_{\\mathrm{ball}}} $$\n求解 $k_{\\mathrm{app}}(L)$：\n$$ \\frac{1}{k_{\\mathrm{app}}(L)} = \\frac{1}{k_{\\mathrm{bulk}}} + \\frac{1}{L g_{\\mathrm{ball}}} \\implies k_{\\mathrm{app}}(L) = \\left( \\frac{1}{k_{\\mathrm{bulk}}} + \\frac{1}{L g_{\\mathrm{ball}}} \\right)^{-1} $$\n代入 $k_{\\mathrm{bulk}}$ 和 $g_{\\mathrm{ball}}$ 的表达式：\n$$ k_{\\mathrm{app}}(L) = \\left( \\frac{1}{\\frac{1}{3} C v \\Lambda} + \\frac{1}{L (\\frac{1}{4} C v)} \\right)^{-1} = \\frac{k_{\\mathrm{bulk}}}{1 + \\frac{k_{\\mathrm{bulk}}}{L g_{\\mathrm{ball}}}} = \\frac{k_{\\mathrm{bulk}}}{1 + \\frac{\\frac{1}{3} C v \\Lambda}{L (\\frac{1}{4} C v)}} = \\frac{k_{\\mathrm{bulk}}}{1 + \\frac{4}{3} \\frac{\\Lambda}{L}} $$\n使用努森数 $Kn = \\Lambda/L$，我们得到抑制函数 $S(Kn)$：\n$$ S(Kn) = \\frac{k_{\\mathrm{app}}(L)}{k_{\\mathrm{bulk}}} = \\frac{1}{1 + \\frac{4}{3} Kn} $$\n\n### 第 4 步：数值计算和拟合\n\n对于每个测试用例，我们首先计算平均自由程 $\\Lambda = v\\tau$。然后，我们从 $L_{\\min}$ 到 $L_{\\max}$ 生成 $N$ 个对数间隔的薄膜厚度 $L$ 值。对于每个 $L$，我们计算相应的努森数 $Kn = \\Lambda/L$。使用推导出的抑制函数 $S(Kn)$，我们生成一组数据点 $(Kn_i, S(Kn_i))$。\n\n然后，我们对该数据执行模型函数 $s(Kn; \\alpha, \\beta) = \\frac{1}{1 + \\alpha \\, Kn^{\\beta}}$ 的非线性最小二乘拟合，以找到最优参数 $\\alpha$ 和 $\\beta$。由于我们推导的模型是 $S(Kn) = (1 + \\frac{4}{3} Kn^1)^{-1}$，我们预计对于所有测试用例，拟合将产生 $\\alpha \\approx 4/3$ 和 $\\beta \\approx 1$ 的结果，且误差极小。\n\n所需的输出是：\n1.  拟合的 $\\alpha$。\n2.  拟合的 $\\beta$。\n3.  最大绝对偏差：$\\max_i |S(Kn_i) - s(Kn_i; \\alpha, \\beta)|$。\n4.  弹道前因子估计值：$\\lim_{Kn \\to \\infty} Kn \\, S(Kn)$。这是使用我们数据集中的最大 $Kn$ 值 $Kn_{\\max} = \\Lambda / L_{\\min}$，通过 $Kn_{\\max} S(Kn_{\\max})$ 进行数值估计的。理论极限是 $\\lim_{Kn \\to \\infty} Kn \\frac{1}{1 + \\frac{4}{3}Kn} = \\frac{1}{4/3} = 0.75$。\n\n以下代码实现了这个过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Computes and fits the apparent thermal conductivity suppression function for\n    phonon transport in a thin film.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (C [J/(m^3 K)], v [m/s], tau [s], L_min [m], L_max [m], N)\n        (2.0e6, 6000.0, 1.0e-9, 1.0e-8, 1.0e-3, 30),\n        (1.5e6, 4000.0, 5.0e-10, 5.0e-9, 5.0e-2, 35),\n        (3.0e6, 10000.0, 2.0e-10, 1.0e-9, 1.0e-4, 40),\n    ]\n\n    results = []\n    for case in test_cases:\n        C, v, tau, L_min, L_max, N = case\n\n        # 1. Calculate physical constants based on the gray model.\n        # Mean free path (Lambda = v * tau)\n        Lambda = v * tau\n\n        # 2. Generate the dataset for fitting.\n        # Create N logarithmically spaced thicknesses from L_min to L_max.\n        L_values = np.logspace(np.log10(L_min), np.log10(L_max), N)\n        \n        # Calculate the corresponding Knudsen numbers (Kn = Lambda / L).\n        # This array will be sorted from largest Kn to smallest Kn.\n        Kn_values = Lambda / L_values\n\n        # Calculate the theoretical suppression function S(Kn) from the derived model.\n        # S(Kn) = k_app / k_bulk = 1 / (1 + (4/3) * Kn)\n        S_values = 1.0 / (1.0 + (4.0 / 3.0) * Kn_values)\n\n        # 3. Fit the scaling function s(Kn; alpha, beta) to the generated data.\n        def scaling_function(Kn, alpha, beta):\n            \"\"\"The generalized scaling function to be fitted.\"\"\"\n            return 1.0 / (1.0 + alpha * np.power(Kn, beta))\n\n        # Perform non-linear least squares fitting.\n        # Initial guess for [alpha, beta] is close to the expected theoretical values.\n        initial_guess = [4.0 / 3.0, 1.0]\n        # Allow for very high precision tolerance as the fit should be almost perfect.\n        params, _ = curve_fit(scaling_function, Kn_values, S_values, p0=initial_guess, ftol=1e-15, xtol=1e-15)\n        alpha_fit, beta_fit = params\n\n        # 4. Compute the required output metrics.\n        # Calculate the fitted suppression function values.\n        S_fit_values = scaling_function(Kn_values, alpha_fit, beta_fit)\n        \n        # Calculate the maximum absolute deviation between theoretical and fitted values.\n        max_abs_error = np.max(np.abs(S_values - S_fit_values))\n        \n        # Estimate the ballistic prefactor numerically from the largest Kn value.\n        # lim_{Kn->inf} Kn*S(Kn).\n        # Kn_values[0] is the largest Kn, corresponding to L_min.\n        Kn_max = Kn_values[0]\n        S_at_Kn_max = S_values[0]\n        ballistic_prefactor_estimate = Kn_max * S_at_Kn_max\n        \n        results.append([alpha_fit, beta_fit, max_abs_error, ballistic_prefactor_estimate])\n\n    # Format and print the final results as specified.\n    print(f\"{results}\")\n\nsolve()\n```"
        },
        {
            "introduction": "非傅里叶传热领域存在多种模型，每种模型都有其自身的优势和适用范围。这项综合性练习将挑战您扮演计算工程师的角色，为一个时变问题比较几种关键模型——从经典的傅里叶定律到玻尔兹曼输运方程——的预测结果。通过分析结果，您将学会如何根据主要的无量纲参数，即空间克努森数 ($Kn$) 和时间频率参数 ($\\omega\\tau$)，来辨别和选择合适的模型，这是实用模拟工作中的一项关键技能 。",
            "id": "3970710",
            "problem": "考虑厚度为 $L$ 的薄膜中的一维跨平面热传导，其在 $x=0$ 处受到空间均匀的正弦热通量 $q(x=0,t)=\\Re\\{q_0 e^{i \\omega t}\\}$，而在 $x=L$ 处保持参考温度 $T(L,t)=0$。假设材料是均匀、各向同性的，其热导率为 $k$，质量密度为 $\\rho$，比热容为 $c$，热扩散率为 $\\alpha=k/(\\rho c)$。设声子平均自由程为 $\\lambda$，因此克努森数 (Knudsen number) 为 $Kn=\\lambda/L$。并令 $\\tau$ 表示特征弛豫时间。目标是通过计算单位施加热通量幅值下的表面温度响应，并基于 $Kn$ 和 $\\omega \\tau$ 通过算法推荐合适的模型，来比较四种传导模型——经典傅里叶传导、Cattaneo-Vernotte (CV) 模型、双相滞后 (DPL) 模型以及灰体玻尔兹曼输运方程 (BTE) 近似。\n\n基本原理和控制方程：\n- 一维情况下，当体积热容为常数时，能量守恒方程为 $ \\rho c \\,\\partial T/\\partial t = -\\partial q/\\partial x$。\n- 本构关系：\n  - 傅里叶定律：$ q = -k \\,\\partial T/\\partial x$。\n  - Cattaneo-Vernotte (CV)：$ q + \\tau_q \\,\\partial q/\\partial t = -k \\,\\partial T/\\partial x$，其中 $\\tau_q$ 是热通量弛豫时间。\n  - 双相滞后 (DPL)：$ q + \\tau_q \\,\\partial q/\\partial t = -k \\left(\\partial T/\\partial x + \\tau_T \\,\\partial^2 T/\\partial x \\partial t\\right)$，其中 $\\tau_T$ 是温度梯度滞后时间。\n  - 灰体玻尔兹曼输运方程 (BTE) 近似，在弛豫时间近似和空间抑制下的频域形式：$ \\hat{q} = -k_\\mathrm{eff}(\\omega,Kn) \\,\\partial \\hat{T}/\\partial x$，其中 $ k_\\mathrm{eff}(\\omega,Kn) = \\dfrac{k}{1 + \\dfrac{4}{3} Kn}\\,\\dfrac{1}{1 + i \\omega \\tau}$。\n\n谐波分析：\n假设时间谐波响应为 $ T(x,t) = \\Re\\{\\hat{T}(x) e^{i \\omega t}\\}$ 和 $ q(x,t) = \\Re\\{\\hat{q}(x) e^{i \\omega t}\\}$。通过一个有效复数热导率 $k_\\mathrm{eff}(\\omega)$ 将每个模型的本构定律映射为 $ \\hat{q} = -k_\\mathrm{eff}(\\omega) \\,\\partial \\hat{T}/\\partial x$，频域能量方程变为 $ i \\omega \\rho c \\,\\hat{T} = k_\\mathrm{eff}(\\omega) \\,\\partial^2 \\hat{T}/\\partial x^2$。这得到了亥姆霍兹 (Helmholtz) 形式 $ \\dfrac{d^2 \\hat{T}}{dx^2} - s^2 \\hat{T} = 0$，其中复波数为 $ s^2 = \\dfrac{i \\omega \\rho c}{k_\\mathrm{eff}(\\omega)} = \\dfrac{i \\omega}{\\alpha} \\dfrac{k}{k_\\mathrm{eff}(\\omega)}$。对于这四种模型，有效热导率分别为：\n- 傅里叶：$ k_\\mathrm{eff}(\\omega) = k$。\n- CV：$ k_\\mathrm{eff}(\\omega) = \\dfrac{k}{1 + i \\omega \\tau_q}$。\n- DPL：$ k_\\mathrm{eff}(\\omega) = k \\dfrac{1 + i \\omega \\tau_T}{1 + i \\omega \\tau_q}$。\n- BTE (灰体，抑制)：$ k_\\mathrm{eff}(\\omega,Kn) = \\dfrac{k}{1 + \\dfrac{4}{3} Kn} \\dfrac{1}{1 + i \\omega \\tau}$。\n\n在边界条件 $ T(L)=0$ 和 $ -k_\\mathrm{eff}(\\omega)\\,\\left.\\dfrac{d \\hat{T}}{dx}\\right|_{x=0} = q_0$ 下，复数温度传递函数（表面温度幅值与施加的热通量幅值之比）的解为 $ H(\\omega) \\equiv \\dfrac{\\hat{T}(0)}{q_0} = \\dfrac{\\tanh(s L)}{k_\\mathrm{eff}(\\omega)\\, s}$。物理上可测量的量是其模 $|H(\\omega)|$，单位为开尔文每瓦特每平方米。\n\n模型推荐逻辑：\n设 $\\Pi \\equiv \\omega \\tau$。使用以下基于区域的决策逻辑：\n- 如果 $Kn  0.1$ 且 $\\Pi  0.1$，推荐傅里叶传导。\n- 如果 $Kn  0.1$ 且 $\\Pi \\ge 0.1$，若 $\\tau_T = 0$ 则推荐 CV；否则推荐 DPL。\n- 如果 $Kn \\ge 0.1$ 且 $\\Pi  0.1$，推荐 BTE。\n- 如果 $Kn \\ge 0.1$ 且 $\\Pi \\ge 0.1$，推荐 BTE。\n\n任务：\n编写一个程序，针对每个测试用例，计算傅里叶、CV、DPL和BTE模型的 $|H(\\omega)|$，并输出这四个浮点数以及整数推荐码（$0$ 代表傅里叶，$1$ 代表 Cattaneo-Vernotte，$2$ 代表双相滞后，$3$ 代表玻尔兹曼输运方程）。假设 $q_0 = 1\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$。\n\n单位：\n- $L$ 的单位为 $\\mathrm{m}$，$k$ 的单位为 $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$，$\\rho c$ 的单位为 $\\mathrm{J}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$，$\\lambda$ 的单位为 $\\mathrm{m}$，$\\tau$、$\\tau_q$、$\\tau_T$ 的单位为 $\\mathrm{s}$，$\\omega$ 的单位为 $\\mathrm{rad}\\,\\mathrm{s}^{-1}$。\n- $|H(\\omega)|$ 以 $\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{W}^{-1}$ 为单位表示为浮点数。\n- 推荐码为整数。\n\n测试套件：\n所有用例通用的材料参数：\n- $k = 100\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$，\n- $\\rho c = 2\\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$，\n- $\\lambda = 1\\times 10^{-7}\\,\\mathrm{m}$，\n- $\\tau_q = 1\\times 10^{-11}\\,\\mathrm{s}$，\n- $\\tau_T = 0.5\\times 10^{-11}\\,\\mathrm{s}$，\n- $\\tau = 1\\times 10^{-11}\\,\\mathrm{s}$。\n\n跨越不同区域的五个用例：\n1. 用例 A (扩散性，低频)：$L = 1\\times 10^{-5}\\,\\mathrm{m}$，$\\omega = 1\\times 10^{9}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$；因此 $Kn = 1\\times 10^{-2}$，$\\omega \\tau = 1\\times 10^{-2}$。\n2. 用例 B (低 $Kn$，高频)：$L = 1\\times 10^{-5}\\,\\mathrm{m}$，$\\omega = 1\\times 10^{12}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$；因此 $Kn = 1\\times 10^{-2}$，$\\omega \\tau = 1\\times 10^{1}$。\n3. 用例 C (高 $Kn$，低频)：$L = 1\\times 10^{-7}\\,\\mathrm{m}$，$\\omega = 1\\times 10^{9}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$；因此 $Kn = 1$，$\\omega \\tau = 1\\times 10^{-2}$。\n4. 用例 D (高 $Kn$，甚高频)：$L = 1\\times 10^{-7}\\,\\mathrm{m}$，$\\omega = 1\\times 10^{13}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$；因此 $Kn = 1$，$\\omega \\tau = 1\\times 10^{2}$。\n5. 用例 E (边界情况)：$L = 1\\times 10^{-6}\\,\\mathrm{m}$，$\\omega = 1\\times 10^{10}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$；因此 $Kn = 1\\times 10^{-1}$，$\\omega \\tau = 1\\times 10^{-1}$。\n\n最终输出格式：\n你的程序应生成一行输出，包含一个由五个单用例结果组成的列表，其中每个单用例结果本身是一个包含五个数字的列表，顺序为 $[|H|_\\mathrm{Fourier}, |H|_\\mathrm{CV}, |H|_\\mathrm{DPL}, |H|_\\mathrm{BTE}, \\text{model\\_code}]$。该行必须是一个逗号分隔、无空格的列表，并用方括号括起来。例如，对于两个用例，它看起来像 $[[a_1,b_1,c_1,d_1,e_1],[a_2,b_2,c_2,d_2,e_2]]$。",
            "solution": "该问题是有效的。它在科学上基于非平衡热传输原理，问题陈述清晰，为获得唯一解提供了足够的信息，并且表述客观。所有提供的方程和参数对于指定的微尺度热工程领域都是一致且物理上现实的。\n\n目标是通过计算四种不同热传导模型（经典傅里叶、Cattaneo-Vernotte (CV)、双相滞后 (DPL) 和灰体玻尔兹曼输运方程 (BTE) 近似）的表面温度响应，来分析厚度为 $L$ 的薄膜中的一维时间谐波热传导。该问题由一个表面的正弦热通量边界条件 $q(x=0,t)=\\Re\\{q_0 e^{i \\omega t}\\}$ 和另一个表面的固定参考温度 $T(L,t)=0$ 定义。根据由克努森数 $Kn$ 和无量纲频率 $\\Pi = \\omega\\tau$ 定义的物理区域，需要推荐一个合适的模型。\n\n分析在频域中进行，其中温度 $T(x,t)$ 和热通量 $q(x,t)$ 由复数相量 $\\hat{T}(x)$ 和 $\\hat{q}(x)$ 表示，使得 $T(x,t) = \\Re\\{\\hat{T}(x) e^{i \\omega t}\\}$ 和 $q(x,t) = \\Re\\{\\hat{q}(x) e^{i \\omega t}\\}$。将一维能量守恒方程 $\\rho c \\,\\partial T/\\partial t = -\\partial q/\\partial x$ 与形式为 $\\hat{q} = -k_\\mathrm{eff}(\\omega) \\,\\partial \\hat{T}/\\partial x$ 的广义本构定律相结合，得到复数温度幅值 $\\hat{T}(x)$ 的亥姆霍兹方程：\n$$\n\\frac{d^2 \\hat{T}}{dx^2} - s^2 \\hat{T} = 0\n$$\n参数 $s$ 是复波数，其平方由下式给出：\n$$\ns^2 = \\frac{i \\omega \\rho c}{k_\\mathrm{eff}(\\omega)} = \\frac{i \\omega}{\\alpha} \\frac{k}{k_\\mathrm{eff}(\\omega)}\n$$\n其中 $\\alpha = k/(\\rho c)$ 是体材料的热扩散率。项 $k_\\mathrm{eff}(\\omega)$ 是一个有效复数热导率，其取决于所选的热传导模型。\n\n对于这个二阶常微分方程，在边界条件 $\\hat{T}(L)=0$ 和 $-k_\\mathrm{eff}(\\omega)\\,\\left.\\frac{d \\hat{T}}{dx}\\right|_{x=0} = q_0$ 下的解，给出了复数温度传递函数 $H(\\omega)$，定义为表面温度幅值与施加的热通量幅值之比：\n$$\nH(\\omega) \\equiv \\frac{\\hat{T}(0)}{q_0} = \\frac{\\tanh(s L)}{k_\\mathrm{eff}(\\omega)\\, s}\n$$\n物理可测量是该复函数的模 $|H(\\omega)|$。\n\n计算任务涉及通过代入它们特定的 $k_\\mathrm{eff}(\\omega)$ 表达式来为四种模型中的每一种计算 $|H(\\omega)|$。令 $j$ 代表虚数单位 $i$。\n\n1.  **傅里叶定律**：这是经典模型，适用于低 $Kn$ 和低频情况。其本构定律为 $q = -k \\,\\partial T/\\partial x$。\n    - 有效热导率：$k_\\mathrm{eff,F} = k$。\n    - 波数平方：$s_\\mathrm{F}^2 = \\frac{j \\omega \\rho c}{k} = \\frac{j \\omega}{\\alpha}$。\n\n2.  **Cattaneo-Vernotte (CV) 模型**：该模型引入单个弛豫时间 $\\tau_q$ 来解释热惯性，从而得到一个双曲型热方程。其本构定律为 $q + \\tau_q \\,\\partial q/\\partial t = -k \\,\\partial T/\\partial x$。\n    - 有效热导率：$k_\\mathrm{eff,CV} = \\frac{k}{1 + j \\omega \\tau_q}$。\n    - 波数平方：$s_\\mathrm{CV}^2 = \\frac{j \\omega \\rho c}{k} (1 + j \\omega \\tau_q) = \\frac{j \\omega}{\\alpha} (1 + j \\omega \\tau_q)$。\n\n3.  **双相滞后 (DPL) 模型**：这是 CV 模型的推广，为温度梯度引入了第二个滞后时间 $\\tau_T$。其本构定律为 $q + \\tau_q \\,\\partial q/\\partial t = -k \\left(\\partial T/\\partial x + \\tau_T \\,\\partial^2 T/\\partial x \\partial t\\right)$。\n    - 有效热导率：$k_\\mathrm{eff,DPL} = k \\frac{1 + j \\omega \\tau_T}{1 + j \\omega \\tau_q}$。\n    - 波数平方：$s_\\mathrm{DPL}^2 = \\frac{j \\omega \\rho c}{k} \\frac{1 + j \\omega \\tau_q}{1 + j \\omega \\tau_T} = \\frac{j \\omega}{\\alpha} \\frac{1 + j \\omega \\tau_q}{1 + j \\omega \\tau_T}$。\n\n4.  **灰体玻尔兹曼输运方程 (BTE) 近似**：该模型通过克努森数 $Kn = \\lambda/L$ 捕捉空间非局域（弹道）效应，并通过弛豫时间捕捉时间非局域（弛豫）效应。给出的近似结合了空间抑制因子和频率相关的弛豫项。\n    - 有效热导率：$k_\\mathrm{eff,BTE}} = \\frac{k}{1 + \\frac{4}{3} Kn} \\frac{1}{1 + j \\omega \\tau}$。\n    - 波数平方：$s_\\mathrm{BTE}^2 = \\frac{j \\omega \\rho c (1 + \\frac{4}{3} Kn) (1 + j \\omega \\tau)}{k} = \\frac{j \\omega}{\\alpha} (1 + \\frac{4}{3} Kn) (1 + j \\omega \\tau)$。\n\n每个测试用例（由 $(L, \\omega)$ 定义）的算法流程如下：\n- 计算常数热扩散率 $\\alpha = k/(\\rho c)$ 和特定用例的克努森数 $Kn = \\lambda / L$。\n- 对于四种模型中的每一种：\n    - 计算模型特定的复数有效热导率 $k_\\mathrm{eff}$。\n    - 计算复波数的平方 $s^2$，然后计算 $s = \\sqrt{s^2}$。选择主根（其实部非负）。\n    - 评估复数传递函数 $H(\\omega) = \\frac{\\tanh(s L)}{s \\, k_\\mathrm{eff}}$。\n    - 计算并存储其模 $|H(\\omega)|$。\n- 根据提供的逻辑确定模型推荐。\n    - 计算 $\\Pi = \\omega \\tau$。\n    - 如果 $Kn  0.1$ 且 $\\Pi  0.1$：推荐傅里叶（代码 $0$）。\n    - 如果 $Kn  0.1$ 且 $\\Pi \\ge 0.1$：推荐 DPL（代码 $2$），因为给定的 $\\tau_T$ 非零。\n    - 如果 $Kn \\ge 0.1$：推荐 BTE（代码 $3$），无论 $\\Pi$ 值如何。\n- 将四个计算出的模和整数推荐码合并为一个列表。对所有五个测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes surface temperature response for four heat conduction models\n    and recommends a model based on physical regimes.\n    \"\"\"\n\n    # Common material parameters\n    k = 100.0  # W m^-1 K^-1\n    rho_c = 2e6  # J m^-3 K^-1\n    lambda_mfp = 1e-7  # m\n    tau_q = 1e-11  # s\n    tau_T = 0.5e-11  # s\n    tau = 1e-11  # s\n\n    # Thermal diffusivity\n    alpha = k / rho_c\n\n    # Test suite: (L in m, omega in rad/s)\n    test_cases = [\n        (1e-5, 1e9),   # Case A\n        (1e-5, 1e12),  # Case B\n        (1e-7, 1e9),   # Case C\n        (1e-7, 1e13),  # Case D\n        (1e-6, 1e10),  # Case E\n    ]\n\n    all_results = []\n\n    for L, omega in test_cases:\n        # Dimensionless numbers\n        kn = lambda_mfp / L\n        pi_val = omega * tau\n\n        # --- Model Calculations ---\n        # The core formula is H = tanh(s*L) / (k_eff * s)\n        # where s = sqrt(1j * omega * rho_c / k_eff)\n\n        # 1. Fourier Model\n        k_eff_f = k\n        s_f = np.sqrt(1j * omega / alpha)\n        h_f = np.tanh(s_f * L) / (k_eff_f * s_f)\n        mag_h_f = np.abs(h_f)\n\n        # 2. Cattaneo-Vernotte Model\n        k_eff_cv = k / (1 + 1j * omega * tau_q)\n        s_cv_sq = (1j * omega / alpha) * (1 + 1j * omega * tau_q)\n        s_cv = np.sqrt(s_cv_sq)\n        h_cv = np.tanh(s_cv * L) / (k_eff_cv * s_cv)\n        mag_h_cv = np.abs(h_cv)\n\n        # 3. Dual-Phase-Lag Model\n        k_eff_dpl = k * (1 + 1j * omega * tau_T) / (1 + 1j * omega * tau_q)\n        s_dpl_sq = (1j * omega / alpha) * (1 + 1j * omega * tau_q) / (1 + 1j * omega * tau_T)\n        s_dpl = np.sqrt(s_dpl_sq)\n        h_dpl = np.tanh(s_dpl * L) / (k_eff_dpl * s_dpl)\n        mag_h_dpl = np.abs(h_dpl)\n\n        # 4. BTE Model\n        k_eff_bte = (k / (1 + (4/3) * kn)) / (1 + 1j * omega * tau)\n        s_bte_sq = (1j * omega / alpha) * (1 + (4/3) * kn) * (1 + 1j * omega * tau)\n        s_bte = np.sqrt(s_bte_sq)\n        h_bte = np.tanh(s_bte * L) / (k_eff_bte * s_bte)\n        mag_h_bte = np.abs(h_bte)\n        \n        # --- Model Recommendation Logic ---\n        # Codes: 0=Fourier, 1=CV, 2=DPL, 3=BTE\n        model_code = -1 # Default/error\n        if kn  0.1 and pi_val  0.1:\n            model_code = 0  # Fourier\n        elif kn  0.1 and pi_val >= 0.1:\n            if tau_T == 0:\n                model_code = 1  # Cattaneo-Vernotte\n            else:\n                model_code = 2  # Dual-Phase-Lag\n        elif kn >= 0.1:\n            model_code = 3 # BTE\n        \n        # Store results for this case\n        case_results = [mag_h_f, mag_h_cv, mag_h_dpl, mag_h_bte, model_code]\n        all_results.append(case_results)\n\n    # Format the final output string as a list of lists with no spaces\n    # Example: [[v1,v2],[v3,v4]]\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}