{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础的一维稳态问题开始。通过求解一个具有均匀热源和固定边界温度的组织板的温度分布，我们将分析灌注率趋于零和无穷时的极限情况。这项练习旨在将彭纳斯模型与我们熟悉的纯热传导模型联系起来，并揭示高灌注率对组织温度的强大调节作用 。",
            "id": "3978100",
            "problem": "一块厚度为 $L$ 的均匀组织平板占据区域 $x \\in \\left[-\\frac{L}{2}, \\frac{L}{2}\\right]$，并使用一维（$1\\mathrm{D}$）Pennes生物热模型（PBM）进行建模。该平板具有恒定的热导率 $k$，血液灌注散热项由血液密度 $\\rho_b$、血液比热 $c_b$ 和单位体积血液灌注率 $\\omega_b$ 表征。组织以单位体积产热率 $q_0$（新陈代谢加热加任何外加源）均匀产热。动脉血温度为 $T_a$。平板表面 $x = \\pm \\frac{L}{2}$ 处维持在动脉血温度，因此 $T\\!\\left(-\\frac{L}{2}\\right) = T_a$ 且 $T\\!\\left(\\frac{L}{2}\\right) = T_a$。\n\n从微分控制体（CV）内的稳态能量守恒和傅里叶（Fourier）热传导定律出发，推导 Pennes 生物热模型下稳态温度场 $T(x)$ 的控制方程，并求解中心线温度 $T(0)$ 的精确闭式表达式，用 $k$、$L$、$q_0$、$\\rho_b c_b \\omega_b$ 和 $T_a$ 表示。然后，分析当单位体积血液灌注率趋于零（$\\omega_b \\to 0$）以恢复纯传导解，以及当 $\\omega_b \\to \\infty$ 以恢复在 $T_a$ 时的等温组织时，$T(0)$ 的极限行为。\n\n以开尔文为单位表示两个极限中心线温度。无需四舍五入。将你的最终答案表示为按 $\\left(\\omega_b \\to 0,\\ \\omega_b \\to \\infty\\right)$ 顺序排列的一对闭式解析表达式。",
            "solution": "根据验证标准对问题陈述进行评估。\n\n**第1步：提取已知条件**\n- **区域：** 厚度为 $L$ 的均匀组织平板，占据 $x \\in \\left[-\\frac{L}{2}, \\frac{L}{2}\\right]$。\n- **模型：** 一维（$1\\mathrm{D}$）稳态 Pennes 生物热模型（PBM）。\n- **组织属性：** 恒定热导率 $k$，均匀单位体积产热率 $q_0$。\n- **灌注属性：** 血液密度 $\\rho_b$，血液比热 $c_b$，单位体积血液灌注率 $\\omega_b$。\n- **动脉血温度：** $T_a$。\n- **边界条件：** $T\\!\\left(-\\frac{L}{2}\\right) = T_a$ 和 $T\\!\\left(\\frac{L}{2}\\right) = T_a$。\n- **目标：**\n  1. 推导稳态温度场 $T(x)$ 的控制微分方程。\n  2. 求解中心线温度 $T(0)$ 的精确闭式表达式。\n  3. 分析当 $\\omega_b \\to 0$ 和 $\\omega_b \\to \\infty$ 时 $T(0)$ 的极限行为。\n  4. 提供两个极限表达式作为最终答案。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于 Pennes 生物热模型，这是生物热工学中一个基础且被广泛接受的模型。它将傅里叶（Fourier）传导定律与新陈代谢产热和血液灌注项相结合，所有这些都是标准的物理概念。该问题在科学上是合理的。\n- **适定性：** 该问题在一个有限域上定义了一个带有两个狄利克雷（Dirichlet）边界条件的二阶线性常微分方程（ODE）。设置是对称的。这构成了一个适定的边值问题，其存在唯一且稳定的解。\n- **客观性：** 问题的表述使用了精确、客观和明确的术语。所有参数都有明确定义。\n- **缺陷核对表：** 该问题没有违反任何无效性标准。它在科学上是合理的、可形式化的、完整的、一致的、在模型假设下是物理上可信的，并且是适定的。这是一个需要推导和分析的实质性问题，而非一个微不足道的问题。\n\n**第3步：结论与行动**\n该问题是**有效的**。将提供完整解答。\n\n**控制方程的推导**\n我们首先对位于位置 $x$、横截面积为 $A$、厚度为 $dx$ 的微分控制体（CV）应用稳态能量守恒原理。能量平衡为：\n$$(\\text{能量进入速率}) - (\\text{能量流出速率}) + (\\text{能量生成速率}) = 0$$\n各项为：\n1.  在 $x$ 处传入的传导能量：$\\dot{E}_{cond, x} = q_x A$。\n2.  在 $x+dx$ 处传出的传导能量：$\\dot{E}_{cond, x+dx} = q_{x+dx} A$。\n3.  单位体积产热（新陈代谢 + 外加源）：$\\dot{E}_{gen} = q_0 (A \\, dx)$。\n4.  由血液灌注引起的能量交换（Pennes 源/汇项）：$\\dot{E}_{perf} = \\rho_b c_b \\omega_b (T_a - T) (A \\, dx)$。\n\n稳态能量平衡方程为：\n$$q_x A - q_{x+dx} A + q_0 A \\, dx + \\rho_b c_b \\omega_b (T_a - T) A \\, dx = 0$$\n除以控制体体积 $A \\, dx$，我们得到：\n$$-\\frac{q_{x+dx} - q_x}{dx} + q_0 + \\rho_b c_b \\omega_b (T_a - T) = 0$$\n取极限 $dx \\to 0$，第一项变为 $-\\frac{dq}{dx}$。使用傅里叶（Fourier）热传导定律 $q = -k \\frac{dT}{dx}$，我们有：\n$$-\\frac{d}{dx}\\left(-k \\frac{dT}{dx}\\right) + q_0 + \\rho_b c_b \\omega_b (T_a - T) = 0$$\n由于热导率 $k$ 是恒定的，这简化为 Pennes 生物热模型的控制方程：\n$$k \\frac{d^2T}{dx^2} - \\rho_b c_b \\omega_b (T - T_a) + q_0 = 0$$\n\n**控制方程的求解**\n为了求解这个二阶线性非齐次常微分方程，我们引入一个新变量 $\\theta(x)$ 来使方程齐次化。设 $W_b = \\rho_b c_b \\omega_b$ 为灌注热容率。方程为：\n$$k \\frac{d^2T}{dx^2} - W_b T = -W_b T_a - q_0$$\n设 $\\theta(x) = T(x) - \\left(T_a + \\frac{q_0}{W_b}\\right)$。这意味着 $\\frac{d^2\\theta}{dx^2} = \\frac{d^2T}{dx^2}$。代入常微分方程：\n$$k \\frac{d^2\\theta}{dx^2} - W_b \\left(\\theta + T_a + \\frac{q_0}{W_b}\\right) = -W_b T_a - q_0$$\n$$k \\frac{d^2\\theta}{dx^2} - W_b \\theta - W_b T_a - q_0 = -W_b T_a - q_0$$\n$$k \\frac{d^2\\theta}{dx^2} - W_b \\theta = 0$$\n这是一个齐次常微分方程，可以写成 $\\frac{d^2\\theta}{dx^2} - m^2 \\theta = 0$，其中 $m = \\sqrt{\\frac{W_b}{k}} = \\sqrt{\\frac{\\rho_b c_b \\omega_b}{k}}$。\n$\\theta(x)$ 的通解为 $\\theta(x) = C_1 e^{mx} + C_2 e^{-mx}$，或者对于对称问题，更方便地使用双曲函数：\n$$\\theta(x) = A \\cosh(mx) + B \\sinh(mx)$$\n问题的几何形状和边界条件关于 $x=0$ 对称。因此，温度分布 $T(x)$ 必须是一个偶函数，$T(x) = T(-x)$。这意味着包含奇函数 $\\sinh(mx)$ 的项必须为零，所以 $B=0$。\n$\\theta(x)$ 的解简化为 $\\theta(x) = A \\cosh(mx)$。\n那么温度分布为：\n$$T(x) = A \\cosh(mx) + T_a + \\frac{q_0}{W_b}$$\n我们应用边界条件 $T(\\frac{L}{2}) = T_a$：\n$$T\\left(\\frac{L}{2}\\right) = A \\cosh\\left(\\frac{mL}{2}\\right) + T_a + \\frac{q_0}{W_b} = T_a$$\n$$A \\cosh\\left(\\frac{mL}{2}\\right) = -\\frac{q_0}{W_b}$$\n$$A = -\\frac{q_0}{W_b \\cosh\\left(\\frac{mL}{2}\\right)}$$\n将 $A$ 代回到 $T(x)$ 的表达式中：\n$$T(x) = T_a + \\frac{q_0}{W_b} - \\frac{q_0}{W_b \\cosh\\left(\\frac{mL}{2}\\right)} \\cosh(mx)$$\n$$T(x) = T_a + \\frac{q_0}{W_b} \\left(1 - \\frac{\\cosh(mx)}{\\cosh\\left(\\frac{mL}{2}\\right)}\\right)$$\n\n**中心线温度**\n通过设 $x=0$ 来求得中心线温度 $T(0)$：\n$$T(0) = T_a + \\frac{q_0}{W_b} \\left(1 - \\frac{\\cosh(0)}{\\cosh\\left(\\frac{mL}{2}\\right)}\\right)$$\n因为 $\\cosh(0)=1$，我们有：\n$$T(0) = T_a + \\frac{q_0}{W_b} \\left(1 - \\frac{1}{\\cosh\\left(\\frac{mL}{2}\\right)}\\right)$$\n将 $W_b = \\rho_b c_b \\omega_b$ 和 $m = \\sqrt{\\frac{\\rho_b c_b \\omega_b}{k}}$ 代回：\n$$T(0) = T_a + \\frac{q_0}{\\rho_b c_b \\omega_b} \\left(1 - \\frac{1}{\\cosh\\left(\\frac{L}{2}\\sqrt{\\frac{\\rho_b c_b \\omega_b}{k}}\\right)}\\right)$$\n\n**当 $\\omega_b \\to 0$ 时的极限行为（纯传导）**\n我们必须计算当 $\\omega_b \\to 0$ 时第二项的极限。设 $z = \\frac{L}{2}\\sqrt{\\frac{\\rho_b c_b \\omega_b}{k}}$。当 $\\omega_b \\to 0$ 时，$z \\to 0$。表达式为 $\\frac{q_0}{k} \\frac{L^2}{4z^2} (1 - \\frac{1}{\\cosh(z)})$。\n我们在 $z=0$ 附近使用 $\\cosh(z)$ 的泰勒级数展开：$\\cosh(z) = 1 + \\frac{z^2}{2} + O(z^4)$。\n$$\\lim_{\\omega_b \\to 0} [T(0) - T_a] = \\lim_{z \\to 0} \\frac{q_0}{\\rho_b c_b \\omega_b} \\left(\\frac{\\cosh(z) - 1}{\\cosh(z)}\\right)$$\n$$= \\lim_{z \\to 0} \\frac{q_0}{\\rho_b c_b \\omega_b} \\left(\\frac{(1 + \\frac{z^2}{2} + \\dots) - 1}{1 + \\frac{z^2}{2} + \\dots}\\right) = \\lim_{z \\to 0} \\frac{q_0}{\\rho_b c_b \\omega_b} \\left(\\frac{z^2}{2}\\right)$$\n代入 $z^2 = \\frac{L^2}{4} \\frac{\\rho_b c_b \\omega_b}{k}$：\n$$\\lim_{\\omega_b \\to 0} [T(0) - T_a] = \\lim_{\\omega_b \\to 0} \\frac{q_0}{\\rho_b c_b \\omega_b} \\left(\\frac{1}{2} \\cdot \\frac{L^2}{4} \\frac{\\rho_b c_b \\omega_b}{k}\\right) = \\frac{q_0 L^2}{8k}$$\n所以，在零灌注极限下的中心线温度为：\n$$T(0)_{\\omega_b \\to 0} = T_a + \\frac{q_0 L^2}{8k}$$\n这个结果与具有均匀产热和对称狄利克雷（Dirichlet）边界条件的平板中的纯传导解相匹配。\n\n**当 $\\omega_b \\to \\infty$ 时的极限行为（等温组织）**\n我们计算当 $\\omega_b \\to \\infty$ 时 $T(0)$ 的极限：\n$$\\lim_{\\omega_b \\to \\infty} T(0) = T_a + \\lim_{\\omega_b \\to \\infty} \\left[ \\frac{q_0}{\\rho_b c_b \\omega_b} \\left(1 - \\frac{1}{\\cosh\\left(\\frac{L}{2}\\sqrt{\\frac{\\rho_b c_b \\omega_b}{k}}\\right)}\\right) \\right]$$\n当 $\\omega_b \\to \\infty$ 时，双曲余弦函数的自变量也趋于无穷大。\n$$\\lim_{\\omega_b \\to \\infty} \\cosh\\left(\\frac{L}{2}\\sqrt{\\frac{\\rho_b c_b \\omega_b}{k}}\\right) = \\infty$$\n因此，项 $\\frac{1}{\\cosh(\\dots)}$ 趋于 $0$。括号中的项 $ (1 - \\frac{1}{\\cosh(\\dots)})$ 趋于 $1$。\n前置因子 $\\frac{q_0}{\\rho_b c_b \\omega_b}$ 趋于 $0$。\n第二项的总体极限是 $0 \\times 1 = 0$。\n因此，在无限灌注极限下的中心线温度为：\n$$T(0)_{\\omega_b \\to \\infty} = T_a$$\n这在物理上对应于这样一种情况：灌注作用如此之强，以至于它冲刷掉了由新陈代谢产热引起的任何温升，有效地将组织温度钳制在动脉血温度。\n\n中心线温度的两个极限表达式是 $T_a + \\frac{q_0 L^2}{8k}$ 和 $T_a$。",
            "answer": "$$\n\\boxed{\\left(T_a + \\frac{q_0 L^2}{8k}, T_a\\right)}\n$$"
        },
        {
            "introduction": "接下来，我们转向一个更复杂的二维解析问题，研究嵌入在无限大组织中的圆柱形热源。这个问题不仅要求我们运用修正贝塞尔函数来求解，更重要的是，它引入了“灌注长度尺度”这一关键概念。理解这个尺度将帮助我们认识到血液灌注不仅能降低温度，还能在空间上限制热量的影响范围 。",
            "id": "3978103",
            "problem": "考虑一个半径为 $a$ 的无限长圆柱形区域，同心嵌入均匀、各向同性且近似无限的生物组织中。在圆柱体内部 ($0 \\le r  a$)，由于治疗设备的存在，存在大小为 $\\dot{q}_{0}$ 的均匀体积热生成。周围组织 ($r  a$) 没有内部热生成。组织由动脉温度为 $T_{a}$ 的血液灌注，血液灌注作为一个体积汇，其大小与局部温度和 $T_{a}$ 的温差成正比。假设导热系数 $k$、体积灌注率 $\\omega$ (单位为时间的倒数)、血液比热 $c_{b}$ 均为常数，并处于稳态。忽略对流和辐射；假设轴向对称且无轴向变化。\n\n从应用于灌注连续体的能量守恒出发，建立径向坐标 $r$ 下的稳态边值问题，并严格求解，以获得各处的温升 $\\theta(r) = T(r) - T_{a}$。施加以下具有物理动机的边界条件：当 $r \\to 0$ 时 $T(r)$ 的有限性，$\\lim_{r \\to \\infty} T(r) = T_{a}$，在 $r=a$ 处 $T(r)$ 的连续性，以及在 $r=a$ 处径向热通量 $-k \\,\\partial T/\\partial r$ 的连续性。\n\n你的任务是以闭合形式计算中心温度 $T(0)$，作为参数 $a$、$k$、$\\omega$、$c_{b}$、$\\dot{q}_{0}$ 和 $T_{a}$ 的函数。用这些符号将你的最终答案表示为单个解析表达式。此外，在你的推导和解释中，请指明特征灌注长度尺度，并定性解释它如何控制组织中 $\\theta(r)$ 的空间衰减。\n\n没有提供数值；不要进行任何数值代入。最终答案必须是单个闭合形式的表达式。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n-   **几何**：半径为 $a$ 的无限长圆柱体，同心嵌入近似无限的组织中。\n-   **区域 1 (圆柱体, $0 \\le r  a$)**：大小为 $\\dot{q}_{0}$ 的均匀体积热生成。\n-   **区域 2 (组织, $r  a$)**：无内部热生成，$\\dot{q} = 0$。\n-   **控制物理学 (Pennes 生物热模型假设)**：\n    -   稳态：$\\frac{\\partial}{\\partial t} = 0$。\n    -   恒定导热系数 $k$。\n    -   恒定体积灌注率 $\\omega$ (单位为时间的倒数)。\n    -   恒定血液比热 $c_{b}$。\n    -   血液灌注作为一个体积汇，其大小与 $T(r) - T_{a}$ 成正比，其中 $T_{a}$ 是动脉温度。该汇项为 $\\omega c_{b}(T - T_{a})$。\n    -   轴向对称且无轴向变化：$\\frac{\\partial}{\\partial \\phi} = 0$, $\\frac{\\partial}{\\partial z} = 0$。\n    -   热传递仅通过传导和灌注进行。\n-   **边界和界面条件**：\n    1.  温度有限性：当 $r \\to 0$ 时，$T(r)$ 是有限的。\n    2.  远场条件：$\\lim_{r \\to \\infty} T(r) = T_{a}$。\n    3.  界面处温度连续：$T(r=a^{-}) = T(r=a^{+})$。\n    4.  界面处热通量连续：$-k \\frac{\\partial T}{\\partial r}\\Big|_{r=a^{-}} = -k \\frac{\\partial T}{\\partial r}\\Big|_{r=a^{+}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于 Pennes 生物热方程，这是生物热传递领域分析灌注生物组织中热效应的基石模型。它在科学上是合理的，并广泛应用于计算热工程。\n-   **适定性**：该问题是一个标准的边值问题。它提供了一个（在两个域中的）二阶常微分方程和足够数量的边界/界面条件（总共四个，用于确定四个积分常数），以确保解的唯一性和稳定性。\n-   **客观性**：该问题使用物理学和工程学中常见的精确、正式和客观的语言陈述。它没有歧义、主观性或观点。灌注项的定义虽然使用了简化符号（$\\omega$，$c_b$），但它意味着标准形式，其中乘积 $\\omega c_b$ 代表由灌注引起的体积传热系数，通常表示为 $w_b c_b \\rho_b$，单位为 $\\text{W} \\cdot \\text{m}^{-3} \\cdot \\text{K}^{-1}$。这种解释是标准做法，不会使问题无效。\n\n### 步骤 3：结论和行动\n该问题是有效的。将进行严格求解。\n\n### 推导\n控制方程是柱坐标系下的稳态 Pennes 生物热方程。在给定的轴向对称和无轴向变化的假设下，拉普拉斯算子简化为 $\\nabla^2 T = \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{dT}{dr} \\right)$。通用方程为：\n$$ k \\nabla^2 T - \\omega c_b (T - T_a) + \\dot{q} = 0 $$\n其中 $\\dot{q}$ 是新陈代谢或外部热源项。我们将高于动脉温度的温升定义为 $\\theta(r) = T(r) - T_a$。通过此代换，$dT/dr = d\\theta/dr$，方程变为：\n$$ \\frac{1}{r} \\frac{d}{dr} \\left( r \\frac{d\\theta}{dr} \\right) - \\frac{\\omega c_b}{k} \\theta + \\frac{\\dot{q}}{k} = 0 $$\n该方程在两个区域内分别求解。我们定义参数 $\\lambda^2 = \\frac{\\omega c_b}{k}$。该参数的单位是长度的平方的倒数，因此 $\\lambda$ 的单位是长度的倒数。\n\n**区域 1：加热圆柱体 ($0 \\le r  a$)**\n在此区域中，$\\dot{q} = \\dot{q}_{0}$。温升 $\\theta_1(r)$ 的控制方程为：\n$$ \\frac{d^2\\theta_1}{dr^2} + \\frac{1}{r} \\frac{d\\theta_1}{dr} - \\lambda^2 \\theta_1 = -\\frac{\\dot{q}_{0}}{k} $$\n这是一个零阶非齐次修正贝塞尔方程。通解是齐次解与一个特解之和。齐次方程的解为 $I_0(\\lambda r)$ 和 $K_0(\\lambda r)$，它们是第一类和第二类零阶修正贝塞尔函数。对于特解，我们观察到常数 $\\theta_{1,p} = \\frac{\\dot{q}_{0}}{k \\lambda^2} = \\frac{\\dot{q}_{0}}{\\omega c_b}$ 是一个解。\n因此，区域 1 的通解为：\n$$ \\theta_1(r) = C_1 I_0(\\lambda r) + C_2 K_0(\\lambda r) + \\frac{\\dot{q}_{0}}{\\omega c_b} $$\n\n**区域 2：周围组织 ($r > a$)**\n在此区域中，$\\dot{q} = 0$。温升 $\\theta_2(r)$ 的控制方程为：\n$$ \\frac{d^2\\theta_2}{dr^2} + \\frac{1}{r} \\frac{d\\theta_2}{dr} - \\lambda^2 \\theta_2 = 0 $$\n这是零阶齐次修正贝塞尔方程。其通解为：\n$$ \\theta_2(r) = C_3 I_0(\\lambda r) + C_4 K_0(\\lambda r) $$\n\n现在，我们应用四个边界和界面条件来确定常数 $C_1, C_2, C_3, C_4$。\n\n1.  **在 $r \\to 0$ 处的有限性**：函数 $K_0(\\lambda r)$ 在 $r \\to 0$ 时发散。为确保 $\\theta_1(r)$ (以及 $T(r)$) 在圆柱中心保持有限，系数 $C_2$ 必须为零。\n    所以，$\\theta_1(r) = C_1 I_0(\\lambda r) + \\frac{\\dot{q}_{0}}{\\omega c_b}$。\n\n2.  **远场条件 $\\lim_{r \\to \\infty} T(r) = T_a$**：这意味着 $\\lim_{r \\to \\infty} \\theta_2(r) = 0$。函数 $I_0(\\lambda r)$ 在 $r \\to \\infty$ 时发散。为满足此边界条件，系数 $C_3$ 必须为零。\n    所以，$\\theta_2(r) = C_4 K_0(\\lambda r)$。\n\n3.  **在 $r=a$ 处温度连续**：$\\theta_1(a) = \\theta_2(a)$。\n    $$ C_1 I_0(\\lambda a) + \\frac{\\dot{q}_{0}}{\\omega c_b} = C_4 K_0(\\lambda a) \\quad \\quad (1) $$\n\n4.  **在 $r=a$ 处热通量连续**：$\\frac{d\\theta_1}{dr}\\Big|_{r=a} = \\frac{d\\theta_2}{dr}\\Big|_{r=a}$。我们使用关系式 $\\frac{d}{dx}I_0(x) = I_1(x)$ 和 $\\frac{d}{dx}K_0(x) = -K_1(x)$。\n    导数为：\n    $\\frac{d\\theta_1}{dr} = C_1 \\lambda I_1(\\lambda r)$\n    $\\frac{d\\theta_2}{dr} = -C_4 \\lambda K_1(\\lambda r)$\n    在 $r=a$ 处令二者相等：\n    $$ C_1 \\lambda I_1(\\lambda a) = -C_4 \\lambda K_1(\\lambda a) $$\n    $$ C_1 I_1(\\lambda a) = -C_4 K_1(\\lambda a) \\quad \\quad (2) $$\n\n现在我们得到了一个关于 $C_1$ 和 $C_4$ 的二元线性方程组。从方程 (2) 中，我们将 $C_4$ 用 $C_1$ 表示：\n$$ C_4 = -C_1 \\frac{I_1(\\lambda a)}{K_1(\\lambda a)} $$\n将此代入方程 (1)：\n$$ C_1 I_0(\\lambda a) + \\frac{\\dot{q}_{0}}{\\omega c_b} = \\left(-C_1 \\frac{I_1(\\lambda a)}{K_1(\\lambda a)}\\right) K_0(\\lambda a) $$\n重新整理以求解 $C_1$：\n$$ \\frac{\\dot{q}_{0}}{\\omega c_b} = -C_1 \\left( I_0(\\lambda a) + \\frac{I_1(\\lambda a) K_0(\\lambda a)}{K_1(\\lambda a)} \\right) $$\n$$ \\frac{\\dot{q}_{0}}{\\omega c_b} = -C_1 \\left( \\frac{I_0(\\lambda a) K_1(\\lambda a) + I_1(\\lambda a) K_0(\\lambda a)}{K_1(\\lambda a)} \\right) $$\n我们使用修正贝塞尔函数的朗斯基行列式恒等式 (Wronskian identity)：$I_\\nu(z)K_{\\nu+1}(z) + I_{\\nu+1}(z)K_\\nu(z) = 1/z$。对于 $\\nu=0$ 和 $z=\\lambda a$，该式为 $I_0(\\lambda a)K_1(\\lambda a) + I_1(\\lambda a)K_0(\\lambda a) = \\frac{1}{\\lambda a}$。\n将朗斯基行列式代入关于 $C_1$ 的方程中：\n$$ \\frac{\\dot{q}_{0}}{\\omega c_b} = -C_1 \\left( \\frac{1/(\\lambda a)}{K_1(\\lambda a)} \\right) $$\n求解 $C_1$：\n$$ C_1 = -\\frac{\\dot{q}_{0}}{\\omega c_b} \\lambda a K_1(\\lambda a) $$\n\n问题要求计算中心温度 $T(0)$。这可从 $\\theta_1(0)$ 求得。\n$$ T(0) = T_a + \\theta_1(0) = T_a + \\left( C_1 I_0(0) + \\frac{\\dot{q}_{0}}{\\omega c_b} \\right) $$\n由于 $I_0(0) = 1$，我们有：\n$$ T(0) = T_a + C_1 + \\frac{\\dot{q}_{0}}{\\omega c_b} $$\n代入 $C_1$ 的表达式：\n$$ T(0) = T_a - \\frac{\\dot{q}_{0}}{\\omega c_b} \\lambda a K_1(\\lambda a) + \\frac{\\dot{q}_{0}}{\\omega c_b} $$\n$$ T(0) = T_a + \\frac{\\dot{q}_{0}}{\\omega c_b} \\left( 1 - \\lambda a K_1(\\lambda a) \\right) $$\n最后，将 $\\lambda = \\sqrt{\\frac{\\omega c_b}{k}}$ 代回表达式，得到最终答案。\n\n**特征灌注长度尺度**\n参数 $\\lambda = \\sqrt{\\omega c_b/k}$ 的单位是长度的倒数。其倒数 $L_p = 1/\\lambda = \\sqrt{k/(\\omega c_b)}$ 是特征灌注长度尺度。\n该长度尺度控制着灌注组织（区域 2）中温度的空间衰减。此区域的解为 $\\theta_2(r) = C_4 K_0(\\lambda r) = C_4 K_0(r/L_p)$。对于大的自变量，$K_0(x)$ 近似按 $e^{-x}/\\sqrt{x}$ 衰减。因此，温升 $\\theta_2(r)$ 在距加热圆柱体与 $L_p$ 相当的距离上会显著减小。长度尺度 $L_p$ 代表了从热源传导出的热量被血液灌注有效带走的特征距离。高灌注率 ($\\omega$) 或高血液热容 ($c_b$) 会导致较小的 $L_p$，将温升限制在靠近热源的区域。相反，低灌注率使热量能更深地穿透组织，导致较大的 $L_p$。\n中心温度的最终表达式为：\n$$ T(0) = T_a + \\frac{\\dot{q}_{0}}{\\omega c_b} \\left( 1 - a \\sqrt{\\frac{\\omega c_b}{k}} K_1\\left(a \\sqrt{\\frac{\\omega c_b}{k}}\\right) \\right) $$",
            "answer": "$$ \\boxed{T_{a} + \\frac{\\dot{q}_{0}}{\\omega c_{b}} \\left( 1 - a \\sqrt{\\frac{\\omega c_{b}}{k}} K_1\\left(a \\sqrt{\\frac{\\omega c_{b}}{k}}\\right) \\right)} $$"
        },
        {
            "introduction": "最后，我们将理论付诸实践，通过一个计算练习来模拟真实世界中的热疗场景。您将为一个具有空间变化的特定吸收率（SAR）图谱的二维组织区域建立一个有限差分模型。通过比较包含和不包含血液灌注两种情况下的结果，您将亲眼见证并量化灌注是如何重塑温度分布的，从而将在前两个练习中学到的概念应用于实际问题中 。",
            "id": "3978085",
            "problem": "您的任务是构建并验证一个由空间变化的特定吸收率（SAR）驱动的活体组织内稳态热传递的计算模型。您必须从能量守恒和傅里叶热传导定律出发，推导出待求解的模型。考虑一个均匀、各向同性的组织，该组织占据一个边长为 $L_x = L_y = 0.1$ 米的二维方形区域。该组织具有恒定的热导率 $k$（单位 $\\mathrm{W \\cdot m^{-1} \\cdot K^{-1}}$）、组织密度 $\\rho_t$（单位 $\\mathrm{kg \\cdot m^{-3}}$）、血液密度 $\\rho_b$（单位 $\\mathrm{kg \\cdot m^{-3}}$）、血液比热 $c_b$（单位 $\\mathrm{J \\cdot kg^{-1} \\cdot K^{-1}}$）以及体积灌注率 $\\omega_b$（单位 $\\mathrm{s^{-1}}$）。动脉（参考）温度是均匀的，且等于边界温度，因此温升 $\\Delta T$ 的边界条件是齐次狄利克雷条件，即在 $\\partial \\Omega$ 上 $\\Delta T = 0$。\n\n从静止介质中的能量平衡和傅里叶定律出发，推导区域内部的稳态控制方程，该方程需包括作为体积热沉的灌注项以及由空间变化的特定吸收率（SAR）引起的外部体积加热项。您可以假设外部体积加热为 $q_{\\mathrm{ext}}(x,y) = \\rho_t S(x,y)$（单位 $\\mathrm{W \\cdot m^{-3}}$），其中 $S(x,y)$（单位 $\\mathrm{W \\cdot kg^{-1}}$）是 SAR 分布图。请勿使用任何预先推导出的离散化公式；需从第一性原理推导离散系统。\n\n在每个方向上至少有 $N_x = N_y = 129$ 个网格点的均匀网格上，对所得的边值问题进行数值求解，并对 $\\Delta T$ 采用齐次狄利克雷边界条件。使用与您的推导一致的五点有限差分格式。仔细组装线性系统，并以符合物理的方式施加边界条件。您可以使用任何稳定且合适的数值线性代数方法来求解所得的稀疏线性系统。\n\n对于以下每种情况，在相同的域、属性和 SAR 分布图上求解稳态问题两次：一次包含灌注（$\\omega_b  0$），一次忽略灌注（设置 $\\omega_b = 0$）以表示纯传导。然后，沿着中线 $y = L_y/2$，计算两个量化指标，以表征灌注相对于纯传导如何重新分布热量：\n- 振幅缩减因子 $r_{\\mathrm{amp}} = \\dfrac{\\max_{\\Omega} \\Delta T_{\\mathrm{perf}}}{\\max_{\\Omega} \\Delta T_{\\mathrm{cond}}}$，此为无量纲值。\n- 基于中线温度剖面均方根（RMS）宽度的宽度缩减因子 $r_{\\sigma} = \\dfrac{\\sigma_{\\mathrm{perf}}}{\\sigma_{\\mathrm{cond}}}$，其中对于剖面 $w(x) = \\Delta T(x, y=L_y/2)$，其质心为 $\\mu = \\dfrac{\\int_0^{L_x} x w(x) \\, dx}{\\int_0^{L_x} w(x) \\, dx}$，RMS 宽度为 $\\sigma = \\sqrt{\\dfrac{\\int_0^{L_x} (x-\\mu)^2 w(x) \\, dx}{\\int_0^{L_x} w(x) \\, dx}}$。以无量纲小数形式报告 $r_{\\mathrm{amp}}$ 和 $r_{\\sigma}$。\n\n除非另有说明，否则使用以下物理上合理的参数值：\n- 热导率 $k = 0.5$（单位 $\\mathrm{W \\cdot m^{-1} \\cdot K^{-1}}$）。\n- 组织密度 $\\rho_t = 1000$（单位 $\\mathrm{kg \\cdot m^{-3}}$）。\n- 血液密度 $\\rho_b = 1060$（单位 $\\mathrm{kg \\cdot m^{-3}}$）。\n- 血液比热 $c_b = 3600$（单位 $\\mathrm{J \\cdot kg^{-1} \\cdot K^{-1}}$）。\n- 对于包含灌注的求解，体积灌注率 $\\omega_b = 0.005$（单位 $\\mathrm{s^{-1}}$）。\n- 对于仅传导的求解，设置 $\\omega_b = 0$。\n\n为测试套件定义 SAR 分布图 $S(x,y)$ 如下，其中 $x \\in [0,L_x]$ 且 $y \\in [0,L_y]$：\n- 情况 A（窄热点）：一个以区域中心为中心的高斯分布，标准差 $\\sigma_A = 0.005$ 米，峰值振幅 $S_{0A} = 10$（单位 $\\mathrm{W \\cdot kg^{-1}}$），即 $S_A(x,y) = S_{0A} \\exp\\!\\left(-\\dfrac{(x - L_x/2)^2 + (y - L_y/2)^2}{2 \\sigma_A^2}\\right)$。\n- 情况 B（宽热点）：一个以区域中心为中心的高斯分布，标准差 $\\sigma_B = 0.03$ 米，峰值振幅 $S_{0B} = 5$（单位 $\\mathrm{W \\cdot kg^{-1}}$），即 $S_B(x,y) = S_{0B} \\exp\\!\\left(-\\dfrac{(x - L_x/2)^2 + (y - L_y/2)^2}{2 \\sigma_B^2}\\right)$。\n- 情况 C（双瓣）：两个等幅高斯分布的叠加，标准差 $\\sigma_C = 0.008$ 米，峰值振幅 $S_{0C} = 8$（单位 $\\mathrm{W \\cdot kg^{-1}}$），中心分别位于 $(x_{C1}, y_{C1}) = (0.035, L_y/2)$ 和 $(x_{C2}, y_{C2}) = (0.065, L_y/2)$，即 $S_C(x,y) = S_{0C} \\exp\\!\\left(-\\dfrac{(x - x_{C1})^2 + (y - y_{C1})^2}{2 \\sigma_C^2}\\right) + S_{0C} \\exp\\!\\left(-\\dfrac{(x - x_{C2})^2 + (y - y_{C2})^2}{2 \\sigma_C^2}\\right)$。\n\n对于每种情况，使用上述定义计算 $r_{\\mathrm{amp}}$ 和 $r_{\\sigma}}$。所有最终报告的量均为无量纲小数。您的程序应生成单行输出，包含六个结果，顺序为 $[r_{\\mathrm{amp},A}, r_{\\sigma,A}, r_{\\mathrm{amp},B}, r_{\\sigma,B}, r_{\\mathrm{amp},C}, r_{\\sigma,C}]$，每个结果四舍五入到六位小数，列表中不含空格。\n\n您的程序需要实现的测试套件摘要：\n- 情况 A：窄高斯 SAR，$\\sigma_A = 0.005$ 米，$S_{0A} = 10$（单位 $\\mathrm{W \\cdot kg^{-1}}$）。\n- 情况 B：宽高斯 SAR，$\\sigma_B = 0.03$ 米，$S_{0B} = 5$（单位 $\\mathrm{W \\cdot kg^{-1}}$）。\n- 情况 C：双瓣 SAR，$\\sigma_C = 0.008$ 米，$S_{0C} = 8$（单位 $\\mathrm{W \\cdot kg^{-1}}$），中心沿 $y = L_y/2$ 分别位于 $x_{C1} = 0.035$ 米和 $x_{C2} = 0.065$ 米。\n\n所有温升计算均以开尔文为单位，但要求的输出 $r_{\\mathrm{amp}}$ 和 $r_{\\sigma}$ 是无量纲小数。确保在域边界上施加 $\\Delta T = 0$ 的边界条件，并确保数值解是稳定的，且与所述物理过程一致。",
            "solution": "用户提供了一个计算热工学领域的问题，具体聚焦于在不同条件下求解 Pennes 生物热模型。该问题定义明确、科学上合理且计算上可行。所有必需的数据和参数均已提供，目标也已明确陈述。因此，该问题被认定为有效。\n\n### I. 控制方程的推导\n\n该问题要求从第一性原理推导控制方程。我们从应用于静止、产热介质内微分控制体 $dV$ 的能量守恒原理开始。在稳态下，能量累积率为零，这导致了进入该控制体的净热传导速率与该控制体内能量生成速率之间的平衡。\n\n进入控制体的净热传导速率由热通量矢量 $\\vec{q}$ 的散度在体积上积分给出：$-\\int_V \\nabla \\cdot \\vec{q} \\, dV$。\n体积热生成速率为 $\\int_V q_{gen} \\, dV$，其中 $q_{gen}$ 是单位体积的生成速率，单位为 $\\mathrm{W \\cdot m^{-3}}$。\n\n任意控制体的稳态能量平衡方程为：\n$$-\\int_V \\nabla \\cdot \\vec{q} \\, dV + \\int_V q_{gen} \\, dV = 0$$\n由于此式必须对任意体积 $V$ 成立，因此被积函数本身在每一点都必须为零：\n$$-\\nabla \\cdot \\vec{q} + q_{gen} = 0$$\n\n傅里叶热传导定律将热通量矢量 $\\vec{q}$ 与温度梯度 $\\nabla T$ 联系起来：\n$$\\vec{q} = -k \\nabla T$$\n其中 $k$ 是组织的热导率，单位为 $\\mathrm{W \\cdot m^{-1} \\cdot K^{-1}}$。假设组织是均匀和各向同性的，$k$ 是一个常数标量。将傅里叶定律代入能量平衡方程，得到：\n$$-\\nabla \\cdot (-k \\nabla T) + q_{gen} = 0$$\n$$k \\nabla^2 T + q_{gen} = 0$$\n其中 $\\nabla^2$ 是拉普拉斯算子。\n\n总体积热生成速率 $q_{gen}$ 是两项之和：\n1.  由特定吸收率（SAR）引起的外部加热，$q_{\\mathrm{ext}}$。\n2.  由血液灌注引起的热交换，$q_p$。\n\n外部加热项由 $q_{\\mathrm{ext}} = \\rho_t S(x,y)$ 给出，其中 $\\rho_t$ 是组织密度，$S(x,y)$ 是空间变化的 SAR。\n\n用于灌注的 Pennes 模型将血液视为一个分布式热沉。它假设血液以均匀的动脉温度 $T_a$ 进入组织毛细血管，并以与局部组织温度 $T(x,y)$ 处于热平衡的状态流出。因此，从组织中移除的热量与局部温差 $(T - T_a)$、血液的体积热容（$\\rho_b c_b$）以及体积灌注率（$\\omega_b$，单位 $\\mathrm{s^{-1}}$）成正比。\n$$q_p = \\rho_b c_b \\omega_b (T_a - T)$$\n\n合并这些项，总生成率为 $q_{gen} = q_{\\mathrm{ext}} + q_p = \\rho_t S(x,y) + \\rho_b c_b \\omega_b (T_a - T)$。将其代入热方程，得到稳态 Pennes 生物热方程：\n$$k \\nabla^2 T + \\rho_t S(x,y) + \\rho_b c_b \\omega_b (T_a - T) = 0$$\n最好用温升 $\\Delta T = T - T_a$ 来表述该问题。由于 $T_a$ 是常数，我们有 $\\nabla T = \\nabla(\\Delta T)$ 和 $\\nabla^2 T = \\nabla^2(\\Delta T)$。灌注项变为 $\\rho_b c_b \\omega_b (T_a - (\\Delta T + T_a)) = -\\rho_b c_b \\omega_b \\Delta T$。因此，温升的控制方程为：\n$$k \\nabla^2(\\Delta T) - \\rho_b c_b \\omega_b \\Delta T + \\rho_t S(x,y) = 0$$\n这是一个亥姆霍兹型椭圆偏微分方程。边界条件是齐次狄利克雷条件，即在域边界 $\\partial\\Omega$ 上 $\\Delta T = 0$。\n\n### II. 数值离散化\n\n为了数值求解此方程，我们使用一个具有 $N_x = N_y = N = 129$ 个点的均匀网格来离散化二维域 $[0, L_x] \\times [0, L_y]$。网格间距为 $h = L_x/(N-1) = L_y/(N-1)$。一个网格点表示为 $(x_i, y_j) = (i h, j h)$，其中 $i, j \\in \\{0, 1, \\dots, N-1\\}$。令 $\\Delta T_{i,j}$ 为 $\\Delta T(x_i, y_j)$ 的数值近似。\n\n在内部网格点 $(i,j)$ 处，拉普拉斯算子 $\\nabla^2(\\Delta T)$ 使用五点中心差分格式进行近似：\n$$\\nabla^2(\\Delta T)\\bigg|_{i,j} \\approx \\frac{\\Delta T_{i+1,j} - 2\\Delta T_{i,j} + \\Delta T_{i-1,j}}{h^2} + \\frac{\\Delta T_{i,j+1} - 2\\Delta T_{i,j} + \\Delta T_{i,j-1}}{h^2}$$\n$$\\nabla^2(\\Delta T)\\bigg|_{i,j} \\approx \\frac{1}{h^2} \\left( \\Delta T_{i+1,j} + \\Delta T_{i-1,j} + \\Delta T_{i,j+1} + \\Delta T_{i,j-1} - 4\\Delta T_{i,j} \\right)$$\n将此近似代入 $\\Delta T$ 的控制方程，得到每个内部节点 $(i,j)$ 的离散方程，其中 $i,j \\in \\{1, \\dots, N-2\\}$：\n$$\\frac{k}{h^2} \\left( \\Delta T_{i+1,j} + \\Delta T_{i-1,j} + \\Delta T_{i,j+1} + \\Delta T_{i,j-1} - 4\\Delta T_{i,j} \\right) - \\rho_b c_b \\omega_b \\Delta T_{i,j} + \\rho_t S_{i,j} = 0$$\n重新整理，将未知的 $\\Delta T$ 项归到左侧，得到每个内部节点的线性代数方程：\n$$\\frac{k}{h^2} (\\Delta T_{i-1,j} + \\Delta T_{i+1,j} + \\Delta T_{i,j-1} + \\Delta T_{i,j+1}) - \\left(\\frac{4k}{h^2} + \\rho_b c_b \\omega_b\\right) \\Delta T_{i,j} = -\\rho_t S_{i,j}$$\n问题简化为求解一个包含 $(N-2) \\times (N-2)$ 个线性方程的方程组，形式为 $A\\vec{u} = \\vec{b}$。向量 $\\vec{u}$ 包含内部网格点处的未知温升 $\\Delta T_{i,j}$，并被展平为一维数组。矩阵 $A$ 是一个大型、稀疏且对角占优的块三对角矩阵，$\\vec{b}$ 是从 SAR 分布图导出的源向量。齐次狄利克雷边界条件（对于边界上的任何 $i$ 或 $j$，$\\Delta T_{i,j}=0$）在该系统的组装过程中被整合。例如，对于邻近左边界的内部节点 $(1, j)$，项 $\\Delta T_{0,j}$ 已知为 $0$，因此从方程中消去。\n\n求解过程如下：\n1.  为每种情况在网格上构建 SAR 分布图 $S(x,y)$。\n2.  对每个 SAR 分布图求解两次问题：一次带灌注（$\\omega_b = 0.005 \\, s^{-1}$），一次不带灌注（$\\omega_b = 0$）。\n3.  对于每次求解，组装对应于内部节点的稀疏矩阵 $A$ 和源向量 $\\vec{b}$。使用像 `scipy.sparse.linalg.spsolve` 这样的稀疏线性求解器来求解系统。\n4.  通过用零值边界填充内部解，重构完整的二维温升场 $\\Delta T$。\n5.  从得到的两个温度场计算所需的指标（$r_{\\mathrm{amp}}$ 和 $r_{\\sigma}$）。RMS 宽度 $\\sigma$ 使用梯形法则进行数值积分计算。\n\n振幅缩减因子 $r_{\\mathrm{amp}}$ 量化了由灌注引起的峰值温度降低，而宽度缩减因子 $r_{\\sigma}$ 则量化了灌注如何影响中线上温度剖面的空间分布。灌注作为一个热沉，在温度较高的地方作用更强，从而降低峰值温度，并常常使分布“扁平化”，这可能会矛盾地导致有效剖面变宽，具体取决于定义和热源。数值评估将揭示其精确效果。",
            "answer": "```python\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to solve the bioheat problem for all test cases and print the results.\n    \"\"\"\n    # Define physical and numerical parameters\n    L = 0.1  # Domain side length [m]\n    k = 0.5  # Thermal conductivity [W/(m.K)]\n    rho_t = 1000  # Tissue density [kg/m^3]\n    rho_b = 1060  # Blood density [kg/m^3]\n    c_b = 3600  # Blood specific heat [J/(kg.K)]\n    omega_b_perf = 0.005  # Volumetric perfusion rate [1/s]\n    N = 129  # Number of grid points in each direction\n\n    test_cases = [\n        # (case_id, S0, sigma, centers)\n        ('A', 10.0, 0.005, None),\n        ('B', 5.0, 0.03, None),\n        ('C', 8.0, 0.008, [(0.035, L / 2.0), (0.065, L / 2.0)])\n    ]\n    \n    results = []\n\n    for case_id, S0, sigma, centers in test_cases:\n        S_map = _setup_sar_map(case_id, L, N, S0, sigma, centers)\n\n        # Solve for conduction-only case (omega_b = 0)\n        delta_T_cond = _solve_bvp(0.0, S_map, L, N, k, rho_t, rho_b, c_b)\n        \n        # Solve for perfusion case\n        delta_T_perf = _solve_bvp(omega_b_perf, S_map, L, N, k, rho_t, rho_b, c_b)\n\n        # Calculate and store metrics\n        r_amp, r_sigma = _calculate_metrics(delta_T_perf, delta_T_cond, L, N)\n        results.extend([r_amp, r_sigma])\n\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\ndef _setup_sar_map(case_id, L, N, S0, sigma, centers=None):\n    \"\"\"\n    Generates the 2D SAR map for a given case configuration.\n    \"\"\"\n    x = np.linspace(0, L, N)\n    y = np.linspace(0, L, N)\n    xx, yy = np.meshgrid(x, y)\n    \n    if case_id in ['A', 'B']:\n        x_c, y_c = L / 2.0, L / 2.0\n        S_map = S0 * np.exp(-((xx - x_c)**2 + (yy - y_c)**2) / (2.0 * sigma**2))\n    elif case_id == 'C':\n        (x_c1, y_c1) = centers[0]\n        (x_c2, y_c2) = centers[1]\n        S1 = S0 * np.exp(-((xx - x_c1)**2 + (yy - y_c1)**2) / (2.0 * sigma**2))\n        S2 = S0 * np.exp(-((xx - x_c2)**2 + (yy - y_c2)**2) / (2.0 * sigma**2))\n        S_map = S1 + S2\n    else:\n        raise ValueError(\"Unknown case ID\")\n        \n    return S_map\n\ndef _solve_bvp(omega_b, S_map, L, N, k, rho_t, rho_b, c_b):\n    \"\"\"\n    Solves the 2D steady-state bioheat BVP using a finite difference method.\n    \"\"\"\n    h = L / (N - 1.0)\n    N_int = N - 2\n    N_unk = N_int * N_int\n\n    # Coefficients from discretization\n    W_b = rho_b * c_b * omega_b\n    C_center = -(4.0 * k / h**2 + W_b)\n    C_neighbor = k / h**2\n\n    # Assemble the sparse matrix A using LIL format for clarity\n    A = sparse.lil_matrix((N_unk, N_unk))\n    for j_int in range(N_int):  # y-index of interior grid\n        for i_int in range(N_int):  # x-index of interior grid\n            p = j_int * N_int + i_int  # 1D index\n            \n            A[p, p] = C_center\n            \n            # West neighbor\n            if i_int > 0:\n                A[p, p - 1] = C_neighbor\n            # East neighbor\n            if i_int  N_int - 1:\n                A[p, p + 1] = C_neighbor\n            # South neighbor (y increases downwards in matrix indexing)\n            if j_int > 0:\n                A[p, p - N_int] = C_neighbor\n            # North neighbor\n            if j_int  N_int - 1:\n                A[p, p + N_int] = C_neighbor\n    \n    A = A.tocsr() # Convert to CSR for efficient solving\n\n    # Assemble the RHS vector b\n    S_interior = S_map[1:-1, 1:-1]\n    b = -rho_t * S_interior.flatten()\n\n    # Solve the linear system\n    delta_T_flat = spsolve(A, b)\n\n    # Reshape solution and pad with boundary zeros\n    delta_T_interior = delta_T_flat.reshape((N_int, N_int))\n    delta_T = np.zeros((N, N))\n    delta_T[1:-1, 1:-1] = delta_T_interior\n\n    return delta_T\n\ndef _calculate_metrics(delta_T_perf, delta_T_cond, L, N):\n    \"\"\"\n    Calculates the amplitude and width reduction factors.\n    \"\"\"\n    x_coords = np.linspace(0, L, N)\n    mid_y_idx = (N - 1) // 2\n\n    # Amplitude reduction factor\n    max_perf = np.max(delta_T_perf)\n    max_cond = np.max(delta_T_cond)\n    \n    if max_cond == 0:\n        r_amp = 0.0 if max_perf == 0.0 else np.inf\n    else:\n        r_amp = max_perf / max_cond\n\n    # RMS width calculation\n    def get_rms_width(w, x):\n        if np.all(w == 0): return 0.0\n        \n        # Using trapezoidal rule for integration\n        norm_integral = np.trapz(w, x)\n        if norm_integral == 0: return 0.0\n        \n        mu = np.trapz(x * w, x) / norm_integral\n        var_integral = np.trapz((x - mu)**2 * w, x)\n        \n        # Clamp to avoid sqrt of small negative number due to precision errors\n        variance = max(0, var_integral / norm_integral)\n        sigma = np.sqrt(variance)\n        return sigma\n\n    w_perf = delta_T_perf[mid_y_idx, :]\n    w_cond = delta_T_cond[mid_y_idx, :]\n\n    sigma_perf = get_rms_width(w_perf, x_coords)\n    sigma_cond = get_rms_width(w_cond, x_coords)\n\n    if sigma_cond == 0:\n        r_sigma = 0.0 if sigma_perf == 0 else np.inf\n    else:\n        r_sigma = sigma_perf / sigma_cond\n        \n    return r_amp, r_sigma\n\nsolve()\n```"
        }
    ]
}