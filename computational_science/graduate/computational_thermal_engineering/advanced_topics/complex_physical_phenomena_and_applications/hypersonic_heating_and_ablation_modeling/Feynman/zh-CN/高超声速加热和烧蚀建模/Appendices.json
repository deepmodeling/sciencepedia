{
    "hands_on_practices": [
        {
            "introduction": "该实践项目探讨了高超声速空气动力学的一个基石：“真实气体效应”。在高超声速激波后的极端温度下，简单的理想气体定律不再适用。本练习要求您对比量热完全气体模型与一个更真实的、考虑了化学离解的平衡空气模型，从而揭示动能的很大一部分是如何被化学反应吸收，而不是仅仅用于提高温度。通过这个动手实践 ，您将量化简化模型对温度的过高预测，并对激波层内的热化学过程建立起基本而深刻的理解。",
            "id": "3961341",
            "problem": "考虑一个由氮气和氧气（空气）组成的高速气流，其自由来流马赫数为 $M_{\\infty}$，自由来流静温为 $T_{\\infty}$。您将比较基于两种热力学模型的驻点温度预测值：(i) 具有恒定比热的量热完全气体模型，以及 (ii) 考虑了氮气和氧气随温度变化的分子离解效应的平衡空气模型。驻点温度 $T_0$ 通过驻点（总）焓守恒来定义，该总焓等于静焓与单位质量动能之和。您的推导和实现必须从热力学和力学的基本原理出发，不得依赖于已有的简化公式。\n\n定义和给定数据：\n- 驻点焓满足 $h_0 = h + \\tfrac{1}{2} V^2$，其中 $h$ 是静焓，$V$ 是气流速度。\n- 马赫数为 $M_{\\infty} = V_{\\infty} / a_{\\infty}$，其中 $a_{\\infty} = \\sqrt{\\gamma_{\\infty} R T_{\\infty}}$ 是当地声速，$R$ 是比气体常数，$\\gamma_{\\infty}$ 是自由来流中的比热比。\n- 对于量热完全气体模型，将空气视为具有恒定 $c_p$ 和 $\\gamma$ 的单一组分气体。\n- 对于平衡空气模型，将空气视为具有随温度变化的离解效应的氮气和氧气的二元混合物。将净焓模拟为基准显焓（来自一个恒定的参考比热）与双原子组分离解产生的潜焓之和。设氮气的摩尔分数为 $0.79$，氧气的摩尔分数为 $0.21$。设对应的质量分数为 $w_{\\mathrm{N_2}} = 0.766$ 和 $w_{\\mathrm{O_2}} = 0.234$。\n- 使用以下常数：$R = 287\\,\\mathrm{J/(kg\\cdot K)}$，$\\gamma_{\\infty} = 1.4$，以及恒定的基准比热 $c_{p,0} = \\gamma_{\\infty} R / (\\gamma_{\\infty} - 1)$。\n- 对于双原子组分，使用以下单位质量的离解能：\n  - 氮气：$L_{\\mathrm{N_2}} = \\dfrac{942\\times 10^3\\,\\mathrm{J/mol}}{28\\times 10^{-3}\\,\\mathrm{kg/mol}}$，\n  - 氧气：$L_{\\mathrm{O_2}} = \\dfrac{493\\times 10^3\\,\\mathrm{J/mol}}{32\\times 10^{-3}\\,\\mathrm{kg/mol}}$。\n- 将离解进度分数模拟为温度的 S 型函数：\n  $$X_{\\mathrm{O_2}}(T) = \\frac{1}{1 + \\exp\\!\\left(-\\dfrac{T - T_{\\mathrm{O_2}}}{a_{\\mathrm{O_2}}}\\right)},\\quad T_{\\mathrm{O_2}} = 3500\\,\\mathrm{K},\\ a_{\\mathrm{O_2}} = 700\\,\\mathrm{K},$$\n  $$X_{\\mathrm{N_2}}(T) = \\frac{1}{1 + \\exp\\!\\left(-\\dfrac{T - T_{\\mathrm{N_2}}}{a_{\\mathrm{N_2}}}\\right)},\\quad T_{\\mathrm{N_2}} = 9000\\,\\mathrm{K},\\ a_{\\mathrm{N_2}} = 1000\\,\\mathrm{K}.$$\n- 在温度 $T$ 下的平衡空气焓为\n  $$h_{\\mathrm{eq}}(T) = c_{p,0}\\,T + w_{\\mathrm{N_2}} L_{\\mathrm{N_2}} X_{\\mathrm{N_2}}(T) + w_{\\mathrm{O_2}} L_{\\mathrm{O_2}} X_{\\mathrm{O_2}}(T),$$\n  其中 $X_{\\mathrm{N_2}}(T)$ 和 $X_{\\mathrm{O_2}}(T)$ 的定义如上。为简化起见，此模型假设组分是可逆、绝热调整的，并忽略了压力对平衡的影响。您必须严格按照规定使用此模型。\n- 在温度 $T$ 下的量热完全气体焓为 $h_{\\mathrm{pg}}(T) = c_{p,0}\\,T$。\n\n任务：\n1. 从驻点焓和马赫数的定义出发，推导如何用 $T_{\\infty}$、$\\gamma_{\\infty}$、$R$ 和 $M_{\\infty}$ 表示量热完全气体模型的驻点温度 $T_{0,\\mathrm{pg}}$。\n2. 从相同的驻点焓定义出发，通过将 $h_{\\mathrm{eq}}(T_{0,\\mathrm{eq}})$ 与自由来流驻点焓相等，建立求解平衡空气驻点温度 $T_{0,\\mathrm{eq}}$ 的非线性方程，并描述一种求解该方程的稳健数值方法。为避免任意的参考偏移，将相对于自由来流的焓变表示为 $h_{\\mathrm{eq}}(T) - h_{\\mathrm{eq}}(T_{\\infty})$。\n3. 在一个程序中实现这两种模型，该程序针对每个给定的 $M_{\\infty}$ 计算：\n   - 以 $\\mathrm{K}$ 为单位的 $T_{0,\\mathrm{pg}}$，\n   - 以 $\\mathrm{K}$ 为单位的 $T_{0,\\mathrm{eq}}$，\n   - 绝对偏差 $\\Delta T_0 = T_{0,\\mathrm{pg}} - T_{0,\\mathrm{eq}}$，以 $\\mathrm{K}$ 为单位，\n   - 相对偏差 $\\delta = \\dfrac{\\Delta T_0}{T_{0,\\mathrm{pg}}}$，以无量纲小数表示（非百分比）。\n4. 采用自由来流静温 $T_{\\infty} = 220\\,\\mathrm{K}$。\n\n数值测试套件：\n- 使用以下自由来流马赫数：$M_{\\infty} \\in \\{5.0,\\,7.5,\\,10.0,\\,12.5,\\,15.0\\}$。\n- 这些值包括了高超声速范围内的边界情况和中间情况。确保您的求解器能够将平衡解置于区间内，并在所有情况下都能可靠收敛。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。每个条目对应一个测试用例，并且其本身必须是按顺序 $[T_{0,\\mathrm{pg}}, T_{0,\\mathrm{eq}}, \\Delta T_0, \\delta]$ 排列的、包含四个浮点数的列表。例如，包含两个测试用例的输出将如下所示：\n  ```\n  [ [t_{1,pg}, t_{1,eq}, d_1, \\delta_1], [t_{2,pg}, t_{2,eq}, d_2, \\delta_2] ]\n  ```\n所有温度都必须以 $\\mathrm{K}$ 为单位，且相对偏差必须是小数。",
            "solution": "该问题提法明确，具有科学依据，并包含了完整求解所需的所有信息。我们将首先在量热完全气体假设下推导驻点温度的解析表达式，然后建立平衡空气模型的非线性问题，并详细说明一种稳健的数值求解方法。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n\n- **气流组分**：氮气和氧气（空气）。\n- **自由来流条件**：马赫数 $M_{\\infty}$，静温 $T_{\\infty}$。\n- **驻点焓定义**：$h_0 = h + \\tfrac{1}{2} V^2$。\n- **马赫数定义**：$M_{\\infty} = V_{\\infty} / a_{\\infty}$，其中 $a_{\\infty} = \\sqrt{\\gamma_{\\infty} R T_{\\infty}}$。\n- **量热完全气体 (CPG) 模型**：空气作为具有恒定 $c_p$ 和 $\\gamma$ 的单一组分气体。\n- **平衡空气模型**：氮气（摩尔分数为 $0.79$，质量分数为 $w_{\\mathrm{N_2}} = 0.766$）和氧气（摩尔分数为 $0.21$，质量分数为 $w_{\\mathrm{O_2}} = 0.234$）的二元混合物。\n- **常数**：\n    - 比气体常数：$R = 287\\,\\mathrm{J/(kg\\cdot K)}$。\n    - 自由来流比热比：$\\gamma_{\\infty} = 1.4$。\n    - 基准恒定比热：$c_{p,0} = \\gamma_{\\infty} R / (\\gamma_{\\infty} - 1)$。\n- **单位质量的离解能**：\n    - 氮气：$L_{\\mathrm{N_2}} = \\dfrac{942\\times 10^3\\,\\mathrm{J/mol}}{28\\times 10^{-3}\\,\\mathrm{kg/mol}}$。\n    - 氧气：$L_{\\mathrm{O_2}} = \\dfrac{493\\times 10^3\\,\\mathrm{J/mol}}{32\\times 10^{-3}\\,\\mathrm{kg/mol}}$。\n- **离解进度分数 (S 型函数)**：\n    - $X_{\\mathrm{O_2}}(T) = \\dfrac{1}{1 + \\exp\\!\\left(-\\dfrac{T - T_{\\mathrm{O_2}}}{a_{\\mathrm{O_2}}}\\right)}$，其中 $T_{\\mathrm{O_2}} = 3500\\,\\mathrm{K}$，$a_{\\mathrm{O_2}} = 700\\,\\mathrm{K}$。\n    - $X_{\\mathrm{N_2}}(T) = \\dfrac{1}{1 + \\exp\\!\\left(-\\dfrac{T - T_{\\mathrm{N_2}}}{a_{\\mathrm{N_2}}}\\right)}$，其中 $T_{\\mathrm{N_2}} = 9000\\,\\mathrm{K}$，$a_{\\mathrm{N_2}} = 1000\\,\\mathrm{K}$。\n- **平衡空气焓模型**：$h_{\\mathrm{eq}}(T) = c_{p,0}\\,T + w_{\\mathrm{N_2}} L_{\\mathrm{N_2}} X_{\\mathrm{N_2}}(T) + w_{\\mathrm{O_2}} L_{\\mathrm{O_2}} X_{\\mathrm{O_2}}(T)$。\n- **CPG 焓模型**：$h_{\\mathrm{pg}}(T) = c_{p,0}\\,T$。\n- **自由来流静温**：$T_{\\infty} = 220\\,\\mathrm{K}$。\n- **数值测试套件**：$M_{\\infty} \\in \\{5.0,\\,7.5,\\,10.0,\\,12.5,\\,15.0\\}$。\n\n**步骤 2：使用提取的给定信息进行验证**\n\n该问题是高速气体动力学中的一个标准练习，旨在比较一个简化模型（CPG）与一个更精细的模型（考虑离解的平衡空气）。\n- **科学依据**：该问题基于应用于流体流动的能量守恒基本原理（热力学第一定律）。焓的模型虽然是简化的（例如，使用 S 型函数拟合离解、忽略压力效应），但具有物理动机，并且在高超声速现象的入门分析中很常见。所给常数和物理参数是符合实际的。\n- **提法明确**：该问题是适定的。CPG 模型的推导会得出一个唯一的显式解。平衡模型会得出一个形如 $f(T) = C$ 的非线性方程，其中代表焓的函数 $f(T)$ 是严格单调的，这保证了驻点温度有唯一解。求解指定测试用例所需的所有数据均已提供。\n- **目标**：该问题以精确、客观和定量的方式陈述。\n\n**步骤 3：结论与行动**\n\n该问题是**有效的**。将提供一个完整的、论证充分的解决方案。\n\n### 基于原理的推导与求解设计\n\n确定驻点性质的核心原理是绝热流中的总焓守恒。总焓 $h_0$ 在从自由来流到驻点的整个流动过程中是恒定的。其定义为：\n$$h_0 = h + \\frac{1}{2}V^2$$\n在驻点处，速度 $V$ 为零，因此总焓等于驻点温度 $T_0$ 下的静焓，即 $h_0 = h(T_0)$。$h_0$ 的值由自由来流条件（$T_{\\infty}$、$M_{\\infty}$）确定：\n$$h_0 = h(T_{\\infty}) + \\frac{1}{2}V_{\\infty}^2$$\n结合这两个式子，我们得到控制方程：\n$$h(T_0) = h(T_{\\infty}) + \\frac{1}{2}V_{\\infty}^2$$\n这个方程将未知的驻点温度 $T_0$ 与已知的自由来流条件联系起来。解的具体形式取决于焓模型 $h(T)$。\n\n#### 1. 量热完全气体 (CPG) 模型\n\n对于量热完全气体，静焓是温度的线性函数：$h(T) = c_p T$，其中定压比热 $c_p$ 是一个常数。问题指定使用基准值 $c_{p,0} = \\frac{\\gamma_{\\infty} R}{\\gamma_{\\infty} - 1}$。\n\n将此代入能量控制方程：\n$$c_{p,0} T_{0,\\mathrm{pg}} = c_{p,0} T_{\\infty} + \\frac{1}{2}V_{\\infty}^2$$\n求解 CPG 驻点温度 $T_{0,\\mathrm{pg}}$：\n$$T_{0,\\mathrm{pg}} = T_{\\infty} + \\frac{V_{\\infty}^2}{2 c_{p,0}}$$\n为了用马赫数 $M_{\\infty}$ 来表示，我们使用定义 $V_{\\infty} = M_{\\infty} a_{\\infty}$ 和 $a_{\\infty} = \\sqrt{\\gamma_{\\infty} R T_{\\infty}}$。对速度进行平方得到 $V_{\\infty}^2 = M_{\\infty}^2 \\gamma_{\\infty} R T_{\\infty}$。代入此式以及 $c_{p,0}$ 的表达式：\n$$T_{0,\\mathrm{pg}} = T_{\\infty} + \\frac{M_{\\infty}^2 \\gamma_{\\infty} R T_{\\infty}}{2 \\left( \\frac{\\gamma_{\\infty} R}{\\gamma_{\\infty} - 1} \\right)}$$\n$\\gamma_{\\infty}R$ 项相互消去，得到简化表达式：\n$$T_{0,\\mathrm{pg}} = T_{\\infty} + T_{\\infty} \\frac{\\gamma_{\\infty} - 1}{2} M_{\\infty}^2$$\n提取公因式 $T_{\\infty}$，得到最终的、众所周知的量热完全气体驻点温度关系式：\n$$T_{0,\\mathrm{pg}} = T_{\\infty} \\left( 1 + \\frac{\\gamma_{\\infty} - 1}{2} M_{\\infty}^2 \\right)$$\n\n#### 2. 平衡空气模型\n\n对于平衡空气模型，由于离解吸收能量，静焓 $h_{\\mathrm{eq}}(T)$ 是温度的非线性函数：\n$$h_{\\mathrm{eq}}(T) = c_{p,0}\\,T + w_{\\mathrm{N_2}} L_{\\mathrm{N_2}} X_{\\mathrm{N_2}}(T) + w_{\\mathrm{O_2}} L_{\\mathrm{O_2}} X_{\\mathrm{O_2}}(T)$$\n能量控制方程保持不变，但现在使用这个非线性焓函数：\n$$h_{\\mathrm{eq}}(T_{0,\\mathrm{eq}}) = h_{\\mathrm{eq}}(T_{\\infty}) + \\frac{1}{2}V_{\\infty}^2$$\n自由来流动能项和之前一样，为 $\\frac{1}{2}V_{\\infty}^2 = \\frac{1}{2} M_{\\infty}^2 \\gamma_{\\infty} R T_{\\infty}$。\n为了求根，我们重新整理方程，定义一个目标函数 $f(T)$，其根即为我们所求的驻点温度 $T_{0,\\mathrm{eq}}$：\n$$f(T) = h_{\\mathrm{eq}}(T) - \\left( h_{\\mathrm{eq}}(T_{\\infty}) + \\frac{1}{2} M_{\\infty}^2 \\gamma_{\\infty} R T_{\\infty} \\right) = 0$$\n这是一个关于 $T_{0,\\mathrm{eq}}$ 的非线性超越方程。我们必须采用数值求根算法。\n\n一种稳健的方法是二分法，或者更高效的 Brent 方法，这两种方法都要求将根置于一个区间内。我们来建立一个有效区间 $[T_{low}, T_{high}]$。\n一个自然的下界是自由来流温度，$T_{low} = T_{\\infty}$。在此温度下，目标函数的值为：\n$$f(T_{\\infty}) = h_{\\mathrm{eq}}(T_{\\infty}) - h_{\\mathrm{eq}}(T_{\\infty}) - \\frac{1}{2} M_{\\infty}^2 \\gamma_{\\infty} R T_{\\infty} = -\\frac{1}{2} V_{\\infty}^2 < 0$$\n一个合适的上界是 CPG 驻点温度，$T_{high} = T_{0,\\mathrm{pg}}$。在平衡模型中，部分本应提高温度的动能被离解过程吸收，因此我们预期 $T_{0,\\mathrm{eq}} \\le T_{0,\\mathrm{pg}}$。让我们在 $T_{0,\\mathrm{pg}}$ 处计算目标函数的值：\n$$f(T_{0,\\mathrm{pg}}) = h_{\\mathrm{eq}}(T_{0,\\mathrm{pg}}) - \\left( h_{\\mathrm{eq}}(T_{\\infty}) + \\frac{1}{2} M_{\\infty}^2 \\gamma_{\\infty} R T_{\\infty} \\right)$$\n从 CPG 的推导中，我们知道 $\\frac{1}{2} M_{\\infty}^2 \\gamma_{\\infty} R T_{\\infty} = c_{p,0}(T_{0,\\mathrm{pg}} - T_{\\infty})$。代入此式：\n$$f(T_{0,\\mathrm{pg}}) = h_{\\mathrm{eq}}(T_{0,\\mathrm{pg}}) - h_{\\mathrm{eq}}(T_{\\infty}) - c_{p,0}(T_{0,\\mathrm{pg}} - T_{\\infty})$$\n展开焓的定义：\n$$f(T_{0,\\mathrm{pg}}) = [c_{p,0}T_{0,\\mathrm{pg}} + \\sum_i w_i L_i X_i(T_{0,\\mathrm{pg}})] - [c_{p,0}T_{\\infty} + \\sum_i w_i L_i X_i(T_{\\infty})] - c_{p,0}T_{0,\\mathrm{pg}} + c_{p,0}T_{\\infty}$$\n温度的线性项相互抵消，剩下：\n$$f(T_{0,\\mathrm{pg}}) = \\sum_i w_i L_i X_i(T_{0,\\mathrm{pg}}) - \\sum_i w_i L_i X_i(T_{\\infty})$$\n由于 $T_{0,\\mathrm{pg}} > T_{\\infty}$ 且离解分数 $X_i(T)$ 是温度的非减函数，该表达式是非负的，即 $f(T_{0,\\mathrm{pg}}) \\ge 0$。\n因此，我们有了一个有效的区间 $[T_{\\infty}, T_{0,\\mathrm{pg}}]$，因为 $f(T_{\\infty}) < 0$ 且 $f(T_{0,\\mathrm{pg}}) \\ge 0$。函数 $h_{\\mathrm{eq}}(T)$ 随 $T$ 严格递增（因为 $c_{p,0} > 0$ 且 S 型函数是非减的），所以 $f(T)$ 也是单调的，这保证了区间内有唯一根。\n\n#### 3. 算法实现\n\n算法将按以下步骤进行：\n1.  定义所有物理和模型常数（$R$、$\\gamma_{\\infty}$、$w_i$、$L_i$ 等）。\n2.  实现离解分数函数 $X_{\\mathrm{N_2}}(T)$ 和 $X_{\\mathrm{O_2}}(T)$，以及平衡焓函数 $h_{\\mathrm{eq}}(T)$。\n3.  遍历每个给定的自由来流马赫数 $M_{\\infty}$。\n4.  对于每个 $M_{\\infty}$：\n    a. 使用推导出的公式计算 CPG 驻点温度 $T_{0,\\mathrm{pg}}$。\n    b. 计算单位质量的自由来流动能，$K.E._{\\infty} = \\frac{1}{2} M_{\\infty}^2 \\gamma_{\\infty} R T_{\\infty}$。\n    c. 计算总焓，$h_0 = h_{\\mathrm{eq}}(T_{\\infty}) + K.E._{\\infty}$。\n    d. 定义目标函数 $g(T) = h_{\\mathrm{eq}}(T) - h_0$。\n    e. 使用一个稳健的数值求解器，例如 `scipy.optimize.brentq`，在区间 $[T_{\\infty}, T_{0,\\mathrm{pg}}]$ 内找到 $g(T)=0$ 的根。此根即为 $T_{0,\\mathrm{eq}}$。\n    f. 计算绝对偏差 $\\Delta T_0 = T_{0,\\mathrm{pg}} - T_{0,\\mathrm{eq}}$。\n    g. 计算相对偏差 $\\delta = \\Delta T_0 / T_{0,\\mathrm{pg}}$。\n5.  收集每个马赫数的结果，并将输出格式化为列表的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes and compares stagnation temperatures for hypersonic flow using\n    a calorically perfect gas model and a simplified equilibrium-air model.\n    \"\"\"\n    # Define physical and model constants\n    R = 287.0  # Specific gas constant for air, J/(kg.K)\n    GAMMA_INF = 1.4  # Ratio of specific heats in the freestream\n    T_INF = 220.0  # Freestream static temperature, K\n\n    # Mass fractions for air composition\n    W_N2 = 0.766\n    W_O2 = 0.234\n\n    # Baseline constant specific heat at constant pressure\n    CP0 = GAMMA_INF * R / (GAMMA_INF - 1.0)\n\n    # Dissociation energies per unit mass (J/kg)\n    L_N2 = (942.0 * 1e3) / (28.0 * 1e-3)\n    L_O2 = (493.0 * 1e3) / (32.0 * 1e-3)\n\n    # Parameters for sigmoidal dissociation models\n    T_CHAR_O2 = 3500.0   # K\n    A_O2 = 700.0         # K\n    T_CHAR_N2 = 9000.0   # K\n    A_N2 = 1000.0        # K\n\n    def X_O2(T):\n        \"\"\"Dissociation progress fraction for O2.\"\"\"\n        arg = -(T - T_CHAR_O2) / A_O2\n        return 1.0 / (1.0 + np.exp(arg))\n\n    def X_N2(T):\n        \"\"\"Dissociation progress fraction for N2.\"\"\"\n        arg = -(T - T_CHAR_N2) / A_N2\n        return 1.0 / (1.0 + np.exp(arg))\n\n    def h_eq(T):\n        \"\"\"Equilibrium-air enthalpy model, h_eq(T).\"\"\"\n        h_diss_N2 = W_N2 * L_N2 * X_N2(T)\n        h_diss_O2 = W_O2 * L_O2 * X_O2(T)\n        return CP0 * T + h_diss_N2 + h_diss_O2\n\n    # Define the test cases from the problem statement.\n    test_cases_mach = [5.0, 7.5, 10.0, 12.5, 15.0]\n    \n    results = []\n    \n    for M_inf in test_cases_mach:\n        # 1. Calorically Perfect Gas (CPG) Model Calculation\n        t_0_pg = T_INF * (1.0 + (GAMMA_INF - 1.0) / 2.0 * M_inf**2)\n\n        # 2. Equilibrium-Air Model Calculation\n        # Calculate total enthalpy from freestream conditions\n        ke_inf = 0.5 * (M_inf**2) * GAMMA_INF * R * T_INF\n        h_inf = h_eq(T_INF)\n        h_total = h_inf + ke_inf\n\n        # Define the objective function for the root solver\n        # We need to find T such that h_eq(T) = h_total\n        def objective_func(T):\n            return h_eq(T) - h_total\n\n        # The root is bracketed by [T_inf, t_0_pg].\n        # The lower bound for the solver.\n        t_low = T_INF\n        # The upper bound for the solver. Add a small epsilon for robustness\n        # in case dissociation is zero and t_0_eq = t_0_pg.\n        t_high = t_0_pg + 1e-6 \n        \n        # Use Brent's method to find the equilibrium stagnation temperature\n        t_0_eq = brentq(objective_func, t_low, t_high, xtol=1e-6)\n        \n        # 3. Calculate deviations\n        delta_t_0 = t_0_pg - t_0_eq\n        # Avoid division by zero, although t_0_pg will be > T_INF > 0\n        fractional_delta = delta_t_0 / t_0_pg if t_0_pg != 0 else 0.0\n\n        # Assemble the results for this case\n        case_result = [t_0_pg, t_0_eq, delta_t_0, fractional_delta]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of lists is desired.\n    list_of_strings = [str(item) for item in results]\n    output_string = f\"[{','.join(list_of_strings)}]\"\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "在建立了极端的外部热环境模型后，我们现在转向飞行器表面的相互作用。本练习模拟了碳基热防护材料的烧蚀过程，该过程由反应性物质（如原子氧）从热气体到壁面的扩散速率与发生在材料表面的化学反应速率之间的竞争所主导。通过推导耦合烧蚀率，并将其与扩散限制和反应限制这两种极端情况进行比较 ，您将对这些竞争过程建立起量化理解，并学会识别主导机制，这是设计和分析热防护系统的一项关键技能。",
            "id": "3961401",
            "problem": "考虑在化学非平衡空气中，流经碳表面的高超声速边界层，其中烧蚀由原子氧的非均相氧化控制。目标是通过将原子氧通过近壁膜的扩散与一级表面反应耦合，计算壁面上的碳烧蚀质量通量，然后与两种极限情况进行比较，即单独由扩散或表面反应控制通量的情况。使用以下基本依据和定义。\n\n设自由来流是由原子氧、分子氧和氮气组成的气体混合物，其摩尔分数分别为 $x_{\\mathrm{O}}$、$x_{\\mathrm{O}_2}$ 和 $x_{\\mathrm{N}_2} = 1 - x_{\\mathrm{O}} - x_{\\mathrm{O}_2}$。设自由来流静压为 $P_{\\infty}$，静温为 $T_{\\infty}$。设壁面温度为 $T_w$，自由来流的流向速度为 $U_{\\infty}$，距前缘的流向距离为 $x$。假设使用层流边界层的传质关联式。\n\n使用理想气体定律和摩尔混合平均法计算混合物的摩尔质量 $M_{\\mathrm{mix}}$ 和密度 $\\rho$：\n$$\nM_{\\mathrm{mix}} = x_{\\mathrm{O}} M_{\\mathrm{O}} + x_{\\mathrm{O}_2} M_{\\mathrm{O}_2} + x_{\\mathrm{N}_2} M_{\\mathrm{N}_2},\n$$\n$$\nR_{\\mathrm{mix}} = \\frac{R_u}{M_{\\mathrm{mix}}}, \\quad \\rho = \\frac{P_{\\infty}}{R_{\\mathrm{mix}} T_{\\infty}},\n$$\n其中 $R_u$ 是普适气体常数，$M_{\\mathrmO}$、$M_{\\mathrm{O}_2}$、$M_{\\mathrm{N}_2}$ 是摩尔质量。\n\n使用空气的萨瑟兰定律估算 $T_{\\infty}$下的动力粘度 $\\mu$，并计算运动粘度 $\\nu$：\n$$\n\\mu(T_{\\infty}) = \\mu_{\\mathrm{ref}} \\left(\\frac{T_{\\infty}}{T_{\\mathrm{ref}}}\\right)^{3/2} \\frac{T_{\\mathrm{ref}} + S}{T_{\\infty} + S}, \\quad \\nu = \\frac{\\mu}{\\rho},\n$$\n其中 $\\mu_{\\mathrm{ref}}$ 是参考温度 $T_{\\mathrm{ref}}$ 下的参考动力粘度，$S$ 是萨瑟兰常数。\n\n使用参考状态 $(T_{\\mathrm{ref}}, P_{\\mathrm{ref}})$ 下的温度和压力比例关系，对空气中原子氧的二元扩散系数 $D_{\\mathrm{O}}$进行建模：\n$$\nD_{\\mathrm{O}}(T_{\\infty}, P_{\\infty}) = D_{\\mathrm{ref}} \\left(\\frac{T_{\\infty}}{T_{\\mathrm{ref}}}\\right)^{3/2} \\left(\\frac{P_{\\mathrm{ref}}}{P_{\\infty}}\\right).\n$$\n\n定义雷诺数和施密特数：\n$$\n\\mathrm{Re}_x = \\frac{\\rho U_{\\infty} x}{\\mu}, \\quad \\mathrm{Sc} = \\frac{\\nu}{D_{\\mathrm{O}}}.\n$$\n\n对于层流边界层，使用舍伍德数关联式求得传质系数 $k_m$：\n$$\n\\mathrm{Sh}_x = 0.664 \\, \\mathrm{Re}_x^{1/2} \\, \\mathrm{Sc}^{1/3}, \\quad k_m = \\frac{\\mathrm{Sh}_x D_{\\mathrm{O}}}{x}.\n$$\n\n假设壁面非均相氧化反应相对于壁面原子氧浓度为一级反应，并遵循阿伦尼乌斯动力学：\n$$\nk_s(T_w) = A \\exp\\!\\left(-\\frac{E_a}{R_u T_w}\\right),\n$$\n其中 $A$ 是指前因子，$E_a$ 是活化能。\n\n设 $c_{\\mathrm{O},\\infty}$ 为自由来流中原子氧的摩尔浓度：\n$$\nc_{\\mathrm{O},\\infty} = \\frac{x_{\\mathrm{O}} P_{\\infty}}{R_u T_{\\infty}}.\n$$\n\n在壁面应用稳态组分守恒，使扩散通量等于反应消耗。扩散过程使用膜理论，驱动力为自由来流与壁面浓度之差，壁面上的原子氧反应为一级反应。推导耦合作用下的壁面原子氧通量，并根据化学计量关系 $C(s) + O \\to CO(g)$，通过原子氧的摩尔通量乘以碳的摩尔质量来计算碳烧蚀质量通量。\n\n此外，推导并计算两种极限情况：\n- 扩散限制：表面反应无限快，因此壁面原子氧浓度可忽略不计，通量完全由扩散控制。\n- 反应限制：扩散无限快，因此壁面浓度与自由来流浓度相等，通量完全由表面反应控制。\n\n最终输出以千克/平方米·秒为单位的质量通量表示，并以科学记数法四舍五入至六位有效数字。\n\n您的程序必须实现上述物理模型，并为每个测试案例生成三个数值：耦合扩散-反应的碳烧蚀质量通量、扩散限制的碳烧蚀质量通量和反应限制的碳烧蚀质量通量。将所有测试案例的所有数值汇总到单行输出中，结果以逗号分隔，并用方括号括起来。\n\n在计算中使用以下常数：\n- $R_u = 8.31446261815324$ $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，\n- $M_{\\mathrm{O}} = 0.016$ $\\mathrm{kg\\,mol^{-1}}$，$M_{\\mathrm{O}_2} = 0.032$ $\\mathrm{kg\\,mol^{-1}}$，$M_{\\mathrm{N}_2} = 0.028$ $\\mathrm{kg\\,mol^{-1}}$，$M_{\\mathrm{C}} = 0.012$ $\\mathrm{kg\\,mol^{-1}}$，\n- $\\mu_{\\mathrm{ref}} = 1.716 \\times 10^{-5}$ $\\mathrm{Pa\\,s}$ 于 $T_{\\mathrm{ref}} = 273.15$ $\\mathrm{K}$，$S = 111$ $\\mathrm{K}$，\n- $D_{\\mathrm{ref}} = 1.0 \\times 10^{-4}$ $\\mathrm{m^2\\,s^{-1}}$ 于 $T_{\\mathrm{ref}} = 300$ $\\mathrm{K}$ 和 $P_{\\mathrm{ref}} = 101325$ $\\mathrm{Pa}$。\n\n测试套件（五个案例）：\n1) $x_{\\mathrm{O}} = 0.05$, $x_{\\mathrm{O}_2} = 0.15$, $P_{\\infty} = 15000$ $\\mathrm{Pa}$, $T_{\\infty} = 2500$ $\\mathrm{K}$, $U_{\\infty} = 4500$ $\\mathrm{m\\,s^{-1}}$, $x = 0.1$ $\\mathrm{m}$, $T_w = 3000$ $\\mathrm{K}$, $A = 100$ $\\mathrm{m\\,s^{-1}}$, $E_a = 80000$ $\\mathrm{J\\,mol^{-1}}$。\n2) $x_{\\mathrm{O}} = 0.03$, $x_{\\mathrm{O}_2} = 0.20$, $P_{\\infty} = 20000$ $\\mathrm{Pa}$, $T_{\\infty} = 1800$ $\\mathrm{K}$, $U_{\\infty} = 4000$ $\\mathrm{m\\,s^{-1}}$, $x = 0.05$ $\\mathrm{m}$, $T_w = 1800$ $\\mathrm{K}$, $A = 50$ $\\mathrm{m\\,s^{-1}}$, $E_a = 90000$ $\\mathrm{J\\,mol^{-1}}$。\n3) $x_{\\mathrm{O}} = 0.05$, $x_{\\mathrm{O}_2} = 0.10$, $P_{\\infty} = 15000$ $\\mathrm{Pa}$, $T_{\\infty} = 2500$ $\\mathrm{K}$, $U_{\\infty} = 4500$ $\\mathrm{m\\,s^{-1}}$, $x = 0.1$ $\\mathrm{m}$, $T_w = 3300$ $\\mathrm{K}$, $A = 10000$ $\\mathrm{m\\,s^{-1}}$, $E_a = 60000$ $\\mathrm{J\\,mol^{-1}}$。\n4) $x_{\\mathrm{O}} = 0.001$, $x_{\\mathrm{O}_2} = 0.20$, $P_{\\infty} = 10000$ $\\mathrm{Pa}$, $T_{\\infty} = 2200$ $\\mathrm{K}$, $U_{\\infty} = 3000$ $\\mathrm{m\\,s^{-1}}$, $x = 0.1$ $\\mathrm{m}$, $T_w = 2800$ $\\mathrm{K}$, $A = 150$ $\\mathrm{m\\,s^{-1}}$, $E_a = 80000$ $\\mathrm{J\\,mol^{-1}}$。\n5) $x_{\\mathrm{O}} = 0.04$, $x_{\\mathrm{O}_2} = 0.18$, $P_{\\infty} = 25000$ $\\mathrm{Pa}$, $T_{\\infty} = 2800$ $\\mathrm{K}$, $U_{\\infty} = 5000$ $\\mathrm{m\\,s^{-1}}$, $x = 0.01$ $\\mathrm{m}$, $T_w = 3200$ $\\mathrm{K}$, $A = 200$ $\\mathrm{m\\,s^{-1}}$, $E_a = 70000$ $\\mathrm{J\\,mol^{-1}}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个条目都必须是每个测试案例（从案例1到案例5）中三种模型（耦合、扩散限制、反应限制）之一的烧蚀质量通量，以 $\\mathrm{kg\\,m^{-2}\\,s^{-1}}$ 为单位表示，并以科学记数法四舍五入至六位有效数字，总共15个值。",
            "solution": "目标是计算高超声速飞行器表面的碳烧蚀质量通量。烧蚀是由原子氧的非均相氧化引起的。我们将推导一个模型，该模型将组分通过边界层的扩散与表面化学反应动力学耦合起来。然后，我们会将此耦合解与两种极限情况进行比较：一种是扩散为唯一速率限制步骤（扩散限制），另一种是表面反应为速率限制步骤（反应限制）。\n\n基本原理是壁面处的组分守恒。在稳态下，从自由来流扩散到表面的原子氧摩尔通量 $\\dot{n}''_{\\mathrm{O,diff}}$ 必须等于表面化学反应消耗的原子氧摩尔通量 $\\dot{n}''_{\\mathrm{O,reac}}$。这种平衡决定了壁面原子氧的平衡浓度 $c_{\\mathrm{O},w}$，从而决定了总烧蚀通量。\n\n扩散通量使用膜理论建模，其中传质系数 $k_m$ 将通量与自由来流 ($c_{\\mathrm{O},\\infty}$) 和壁面 ($c_{\\mathrm{O},w}$) 之间的浓度差关联起来：\n$$\n\\dot{n}''_{\\mathrm{O,diff}} = k_m (c_{\\mathrm{O},\\infty} - c_{\\mathrm{O},w})\n$$\n假设表面反应相对于壁面原子氧浓度为一级反应，其速率常数为 $k_s$：\n$$\n\\dot{n}''_{\\mathrm{O,reac}} = k_s(T_w) \\, c_{\\mathrm{O},w}\n$$\n令两个通量相等，可得：\n$$\nk_m (c_{\\mathrm{O},\\infty} - c_{\\mathrm{O},w}) = k_s c_{\\mathrm{O},w}\n$$\n我们求解这个代数方程以得到未知的壁面浓度 $c_{\\mathrm{O},w}$：\n$$\nk_m c_{\\mathrm{O},\\infty} = (k_m + k_s) c_{\\mathrm{O},w} \\implies c_{\\mathrm{O},w} = \\frac{k_m}{k_m + k_s} c_{\\mathrm{O},\\infty}\n$$\n将 $c_{\\mathrm{O},w}$ 的表达式代回反应速率方程，即可求得耦合摩尔通量 $\\dot{n}''_{\\mathrm{O,coupled}}$：\n$$\n\\dot{n}''_{\\mathrm{O,coupled}} = k_s \\left( \\frac{k_m}{k_m + k_s} \\right) c_{\\mathrm{O},\\infty} = \\left( \\frac{k_m k_s}{k_m + k_s} \\right) c_{\\mathrm{O},\\infty}\n$$\n这可以重写以突出耦合过程与作为串联电阻的各个速率过程之间的关系：\n$$\n\\dot{n}''_{\\mathrm{O,coupled}} = \\frac{1}{\\frac{1}{k_m} + \\frac{1}{k_s}} c_{\\mathrm{O},\\infty}\n$$\n总阻力是扩散阻力 ($1/k_m$) 和动力学阻力 ($1/k_s$) 的总和。\n\n从此耦合解中，我们可以推导出两种极限情况：\n\n1.  **扩散限制情况**：假设表面反应无限快，即 $k_s \\to \\infty$。在此极限下，动力学阻力 $1/k_s \\to 0$。壁面原子氧浓度降至零 ($c_{\\mathrm{O},w} \\to 0$)，通量完全由组分扩散到表面的速度控制。\n    $$\n    \\dot{n}''_{\\mathrm{O,diff-lim}} = \\lim_{k_s \\to \\infty} \\left( \\frac{1}{\\frac{1}{k_m} + \\frac{1}{k_s}} \\right) c_{\\mathrm{O},\\infty} = k_m c_{\\mathrm{O},\\infty}\n    $$\n\n2.  **反应限制情况**：假设扩散过程无限快，即 $k_m \\to \\infty$。在此极限下，扩散阻力 $1/k_m \\to 0$。边界层内没有浓度梯度，因此壁面浓度等于自由来流浓度 ($c_{\\mathrm{O},w} \\to c_{\\mathrm{O},\\infty}$)。通量完全由表面反应的内在速度控制。\n    $$\n    \\dot{n}''_{\\mathrm{O,reac-lim}} = \\lim_{k_m \\to \\infty} \\left( \\frac{1}{\\frac{1}{k_m} + \\frac{1}{k_s}} \\right) c_{\\mathrm{O},\\infty} = k_s c_{\\mathrm{O},\\infty}\n    $$\n碳氧化反应的化学计量关系指定为 $C(s) + O \\to CO(g)$。这表明一摩尔原子氧消耗一摩尔固态碳。因此，碳的摩尔烧蚀通量 $\\dot{n}''_{\\mathrm{C}}$ 等于原子氧的摩尔通量 $\\dot{n}''_{\\mathrm{O}}$。碳的质量烧蚀通量 $\\dot{m}''_{\\mathrm{C}}$ 是通过将摩尔通量乘以碳的摩尔质量 $M_{\\mathrm{C}}$ 得到的：\n$$\n\\dot{m}''_{\\mathrm{C}} = \\dot{n}''_{\\mathrm{O}} M_{\\mathrm{C}}\n$$\n因此，我们得到了碳质量烧蚀通量的三个最终表达式：\n-   耦合：$\\dot{m}''_{\\mathrm{C,coupled}} = \\left(\\frac{1}{\\frac{1}{k_m} + \\frac{1}{k_s}}\\right) c_{\\mathrm{O},\\infty} M_{\\mathrm{C}}$\n-   扩散限制：$\\dot{m}''_{\\mathrm{C,diff-lim}} = k_m c_{\\mathrm{O},\\infty} M_{\\mathrm{C}}$\n-   反应限制：$\\dot{m}''_{\\mathrm{C,reac-lim}} = k_s c_{\\mathrm{O},\\infty} M_{\\mathrm{C}}$\n\n确定这些通量的计算过程涉及根据给定的自由来流条件、壁面条件和材料属性计算中间量 $k_m$、$k_s$ 和 $c_{\\mathrm{O},\\infty}$。分步算法如下：\n\n1.  计算自由来流中氮气的摩尔分数：$x_{\\mathrm{N}_2} = 1 - x_{\\mathrm{O}} - x_{\\mathrm{O}_2}$。\n2.  计算自由来流气体的混合平均属性：\n    -   平均摩尔质量：$M_{\\mathrm{mix}} = x_{\\mathrm{O}} M_{\\mathrm{O}} + x_{\\mathrm{O}_2} M_{\\mathrm{O}_2} + x_{\\mathrm{N}_2} M_{\\mathrm{N}_2}$。\n    -   比气体常数：$R_{\\mathrm{mix}} = R_u / M_{\\mathrm{mix}}$。\n    -   密度：$\\rho = P_{\\infty} / (R_{\\mathrm{mix}} T_{\\infty})$。\n3.  计算自由来流的输运属性：\n    -   使用萨瑟兰定律计算 $T_{\\infty}$ 下的动力粘度 $\\mu$：$\\mu(T_{\\infty}) = \\mu_{\\mathrm{ref}} (T_{\\infty}/T_{\\mathrm{ref}})^{3/2} (T_{\\mathrm{ref}} + S)/(T_{\\infty} + S)$，其特定的参考温度为 $T_{\\mathrm{ref}} = 273.15$ $\\mathrm{K}$。\n    -   在 $(T_{\\infty}, P_{\\infty})$ 条件下，空气中原子氧的二元扩散系数 $D_{\\mathrm{O}}$：$D_{\\mathrm{O}} = D_{\\mathrm{ref}} (T_{\\infty}/T_{\\mathrm{ref}})^{3/2} (P_{\\mathrm{ref}}/P_{\\infty})$，其参考状态为 $(T_{\\mathrm{ref}} = 300$ $\\mathrm{K}, P_{\\mathrm{ref}} = 101325$ $\\mathrm{Pa})$。\n4.  计算相关的无量纲数：\n    -   运动粘度：$\\nu = \\mu / \\rho$。\n    -   距离 $x$ 处的雷诺数：$\\mathrm{Re}_x = \\rho U_{\\infty} x / \\mu$。\n    -   原子氧的施密特数：$\\mathrm{Sc} = \\nu / D_{\\mathrm{O}}$。\n5.  根据层流边界层的舍伍德数关联式确定传质系数 $k_m$：\n    -   $\\mathrm{Sh}_x = 0.664 \\, \\mathrm{Re}_x^{1/2} \\, \\mathrm{Sc}^{1/3}$。\n    -   $k_m = (\\mathrm{Sh}_x D_{\\mathrm{O}}) / x$。\n6.  使用阿伦尼乌斯定律计算壁面温度 $T_w$ 下的表面反应速率常数 $k_s$：\n    -   $k_s(T_w) = A \\exp(-E_a / (R_u T_w))$。\n7.  使用理想气体定律计算自由来流中原子氧的摩尔浓度 $c_{\\mathrm{O},\\infty}$：\n    -   $c_{\\mathrm{O},\\infty} = (x_{\\mathrm{O}} P_{\\infty}) / (R_u T_{\\infty})$。\n8.  最后，使用推导出的公式计算三种碳质量烧蚀通量：$\\dot{m}''_{\\mathrm{C,coupled}}$、$\\dot{m}''_{\\mathrm{C,diff-lim}}$ 和 $\\dot{m}''_{\\mathrm{C,reac-lim}}$。\n将此程序应用于每个测试案例以生成所需的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes carbon ablation mass flux for hypersonic boundary layer flow.\n    Calculates coupled diffusion-reaction flux and limiting cases.\n    \"\"\"\n    # Define constants\n    R_u = 8.31446261815324  # J mol^-1 K^-1\n    M_O = 0.016  # kg mol^-1\n    M_O2 = 0.032 # kg mol^-1\n    M_N2 = 0.028 # kg mol^-1\n    M_C = 0.012  # kg mol^-1\n\n    # Viscosity constants (Sutherland's Law)\n    mu_ref = 1.716e-5  # Pa s\n    T_ref_mu = 273.15    # K\n    S_suth = 111.0       # K\n\n    # Diffusivity constants\n    D_ref = 1.0e-4     # m^2 s^-1\n    T_ref_D = 300.0    # K\n    P_ref_D = 101325.0 # Pa\n\n    # Test cases from the problem statement\n    test_cases = [\n        # (x_O, x_O2, P_inf, T_inf, U_inf, x, T_w, A, E_a)\n        (0.05, 0.15, 15000, 2500, 4500, 0.1, 3000, 100, 80000),\n        (0.03, 0.20, 20000, 1800, 4000, 0.05, 1800, 50, 90000),\n        (0.05, 0.10, 15000, 2500, 4500, 0.1, 3300, 10000, 60000),\n        (0.001, 0.20, 10000, 2200, 3000, 0.1, 2800, 150, 80000),\n        (0.04, 0.18, 25000, 2800, 5000, 0.01, 3200, 200, 70000),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        x_O, x_O2, P_inf, T_inf, U_inf, x, T_w, A, E_a = case\n\n        # 1. Freestream mixture properties\n        x_N2 = 1.0 - x_O - x_O2\n        M_mix = x_O * M_O + x_O2 * M_O2 + x_N2 * M_N2\n        R_mix = R_u / M_mix\n        rho = P_inf / (R_mix * T_inf)\n\n        # 2. Freestream transport properties\n        # Dynamic viscosity via Sutherland's law\n        mu = mu_ref * (T_inf / T_ref_mu)**(1.5) * (T_ref_mu + S_suth) / (T_inf + S_suth)\n        \n        # Kinematic viscosity\n        nu = mu / rho\n        \n        # Binary diffusivity of O in air\n        D_O = D_ref * (T_inf / T_ref_D)**(1.5) * (P_ref_D / P_inf)\n\n        # 3. Dimensionless numbers\n        Re_x = rho * U_inf * x / mu\n        Sc = nu / D_O\n\n        # 4. Mass transfer coefficient (k_m)\n        Sh_x = 0.664 * Re_x**0.5 * Sc**(1.0/3.0)\n        k_m = Sh_x * D_O / x\n\n        # 5. Surface reaction rate constant (k_s) via Arrhenius law\n        k_s = A * np.exp(-E_a / (R_u * T_w))\n\n        # 6. Freestream molar concentration of atomic oxygen (c_O_inf)\n        c_O_inf = (x_O * P_inf) / (R_u * T_inf)\n\n        # 7. Calculate ablation mass fluxes\n        \n        # Diffusion-limited mass flux\n        m_dot_c_diff_lim = k_m * c_O_inf * M_C\n\n        # Reaction-limited mass flux\n        m_dot_c_reac_lim = k_s * c_O_inf * M_C\n\n        # Coupled diffusion-reaction mass flux\n        # Use the harmonic mean of rates: 1 / (1/k_m + 1/k_s)\n        # This is more numerically stable than (k_m * k_s) / (k_m + k_s)\n        if k_m == 0 or k_s == 0:\n            eff_rate = 0.0\n        else:\n            eff_rate = 1.0 / (1.0 / k_m + 1.0 / k_s)\n        \n        m_dot_c_coupled = eff_rate * c_O_inf * M_C\n        \n        results.append(m_dot_c_coupled)\n        results.append(m_dot_c_diff_lim)\n        results.append(m_dot_c_reac_lim)\n        \n    # Final print statement in the exact required format.\n    formatted_results = [f\"{res:.5e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "烧蚀模型的最后一块拼图位于材料内部。当热量渗透到多孔烧蚀材料中时，会引起固体基质的分解（即热解），在材料的孔隙内产生高温气体。本实践要求您对这种内部流动进行建模，求解热解气体向表面移动时的压力和速度分布。通过分析导致高内部压力的条件 ，您将深入了解热防护系统的一种关键失效模式——由内部超压引起的结构分层或剥落（spallation），并理解材料渗透率等属性在缓解此类风险中的重要性。",
            "id": "3961418",
            "problem": "考虑一个厚度为 $L$ 的一维 (1D) 多孔烧蚀层，该层受到高超声速气动热载荷作用，导致固体基质发生热分解，在孔隙内生成气体（挥发物）。假设多孔层内为稳态等温条件，气体的渗透率 $k$ 和动力粘度 $\\mu$ 恒定，并且热解气体表现为理想气体，其特征为比气体常数 $R$ 和温度 $T$。位于 $x=L$ 处的外表面承受已知的外部压力 $p_{\\text{ext}}$，而位于 $x=0$ 处的内边界对质量流不可渗透。该材料的孔隙率为 $\\varepsilon$，单位固体体积的均匀分解速率为 $\\dot{m}_d$，从而在孔隙内产生气体质量。单位总体积的质量生成速率为 $S_m=(1-\\varepsilon)\\,\\dot{m}_d$。假设所有生成的挥发物都立即直接进入气相，且孔隙内没有化学消耗。\n\n从以下基本关系式出发：\n- 理想气体定律 (IGL): $\\rho=\\dfrac{p}{R\\,T}$，\n- 多孔介质流动的 Darcy 定律: $u=-\\dfrac{k}{\\mu}\\,\\dfrac{dp}{dx}$，\n- 带体积源项的稳态一维质量守恒: $\\dfrac{d}{dx}(\\rho\\,u)=S_m$，\n\n建立并求解在 $x\\in[0,L]$ 范围内的内部压力 $p(x)$ 和气体速度 $u(x)$ 的边界值问题，其中 $x$ 是从不可渗透的内边界测量的坐标。使用边界条件 $u(0)=0$ 和 $p(L)=p_{\\text{ext}}$。然后，使用以下准则评估内部超压和分层的风险：\n- 如果 $\\max_{x\\in[0,L]} p(x) > p_{\\text{crit}}$，则认为存在超压风险。\n- 如果 $p(0) > p_{\\text{delam}}$，则认为存在分层风险。\n\n你的程序必须计算：\n- 最大内部压力 $\\max_{x\\in[0,L]} p(x)$，单位为帕斯卡 (Pa)，四舍五入到一位小数。\n- 在 $x\\in\\{0,\\,L/4,\\,L/2,\\,3L/4,\\,L\\}$ 处的气体速度值 $u(x)$，单位为米/秒 (m/s)，每个值都四舍五入到六位小数。\n- 分别用于表示超压风险和分层风险的两个布尔指标。\n\n使用以下参数集测试套件，涵盖正常情况、高生成/低渗透率情况以及无生成边缘情况。所有量均采用国际单位制 (SI)：\n- 测试用例 1：$L=0.02$, $k=1\\times 10^{-12}$, $\\mu=1.8\\times 10^{-5}$, $T=1200$, $R=287$, $p_{\\text{ext}}=50000$, $\\varepsilon=0.6$, $\\dot{m}_d=0.05$, $p_{\\text{crit}}=200000$, $p_{\\text{delam}}=100000$。\n- 测试用例 2：$L=0.02$, $k=1\\times 10^{-14}$, $\\mu=1.8\\times 10^{-5}$, $T=1500$, $R=287$, $p_{\\text{ext}}=20000$, $\\varepsilon=0.3$, $\\dot{m}_d=0.5$, $p_{\\text{crit}}=250000$, $p_{\\text{delam}}=280000$。\n- 测试用例 3：$L=0.02$, $k=1\\times 10^{-13}$, $\\mu=2.5\\times 10^{-5}$, $T=1000$, $R=300$, $p_{\\text{ext}}=30000$, $\\varepsilon=0.9$, $\\dot{m}_d=0.0$, $p_{\\text{crit}}=40000$, $p_{\\text{delam}}=35000$。\n\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个条目。每个条目必须是以下格式的列表：\n```\n[p_{max},[u(0),u(L/4),u(L/2),u(3L/4),u(L)],OverpressureRisk,DelaminationRisk]\n```\n其中 $p_{\\max}$ 的单位是帕斯卡 (Pa)，四舍五入到一位小数；速度的单位是米/秒 (m/s)，四舍五入到六位小数；布尔值为 $\\text{True}$ 或 $\\text{False}$。例如，整体输出格式应类似于 $[[\\dots],[\\dots],[\\dots]]$，行内任何地方都没有空格。",
            "solution": "用户提供了一个计算热工学领域的适定问题，具体涉及高超声速加热和烧蚀建模。该问题有科学依据、内容自洽，且没有任何矛盾或含糊不清之处。它要求推导和求解多孔分解材料内部压力场和速度场的边界值问题，然后基于计算出的压力进行风险评估。该问题是有效的。\n\n求解过程分三个阶段进行：\n1.  从所提供的基本原理出发，推导压力分布的控制常微分方程 (ODE)。\n2.  解析求解得到的边界值问题 (BVP)，以获得压力 $p(x)$ 和速度 $u(x)$ 的表达式。\n3.  应用这些解析解来计算给定测试用例所需的量。\n\n**1. 控制微分方程的建立**\n\n我们已知在等温条件下，热解气体在多孔介质中稳态一维流动的三个基本关系式：\n\n-   理想气体定律 (IGL)，它将气体密度 $\\rho$ 与其压力 $p$ 和温度 $T$ 联系起来：\n    $$ \\rho = \\frac{p}{RT} $$\n    其中 $R$ 是比气体常数。\n\n-   Darcy 定律，它描述了由压力梯度 $\\frac{dp}{dx}$ 驱动的表观气体速度 $u$：\n    $$ u = -\\frac{k}{\\mu} \\frac{dp}{dx} $$\n    其中 $k$ 是多孔介质的渗透率，$\\mu$ 是气体的动力粘度。\n\n-   质量守恒，它考虑了控制体积内质量的连续生成：\n    $$ \\frac{d}{dx}(\\rho u) = S_m $$\n    其中 $S_m = (1-\\varepsilon)\\dot{m}_d$ 是单位总体積的均匀质量生成速率，$\\varepsilon$ 是孔隙率，$\\dot{m}_d$ 是单位固体体积的分解速率。\n\n为了推导关于压力 $p(x)$ 的单个控制方程，我们将 $\\rho$ 和 $u$ 的表达式代入质量守恒方程。\n\n首先，将 IGL 代入质量守恒方程：\n$$ \\frac{d}{dx}\\left(\\frac{p}{RT} u\\right) = S_m $$\n由于温度 $T$ 和气体常数 $R$ 假定为常数，它们可以移到导数之外：\n$$ \\frac{1}{RT} \\frac{d}{dx}(p u) = S_m $$\n接下来，将 Darcy 定律代入速度 $u$：\n$$ \\frac{1}{RT} \\frac{d}{dx}\\left(p \\left(-\\frac{k}{\\mu} \\frac{dp}{dx}\\right)\\right) = S_m $$\n渗透率 $k$ 和粘度 $\\mu$ 也是常数，因此可以提出：\n$$ -\\frac{k}{\\mu RT} \\frac{d}{dx}\\left(p \\frac{dp}{dx}\\right) = S_m $$\n使用恒等式 $p \\frac{dp}{dx} = \\frac{1}{2} \\frac{d(p^2)}{dx}$，我们可以简化表达式：\n$$ -\\frac{k}{2\\mu RT} \\frac{d}{dx}\\left(\\frac{d(p^2)}{dx}\\right) = S_m $$\n$$ -\\frac{k}{2\\mu RT} \\frac{d^2(p^2)}{dx^2} = S_m $$\n整理此方程，得到一个关于变量 $p(x)^2$ 的二阶线性 ODE：\n$$ \\frac{d^2(p^2)}{dx^2} = -\\frac{2\\mu RT S_m}{k} $$\n该方程构成了我们边界值问题的基础。\n\n**2. 边界值问题的求解**\n\n边界条件给出如下：\n-   $x=0$ 处的不可渗透内边界：$u(0)=0$。\n-   $x=L$ 处的已知外部压力：$p(L)=p_{\\text{ext}}$。\n\n为方便起见，我们定义一个常数 $C = -\\frac{2\\mu RT S_m}{k}$。ODE 为 $\\frac{d^2(p^2)}{dx^2} = C$。\n\n对 $x$ 积分一次，得到：\n$$ \\frac{d(p^2)}{dx} = C x + C_1 $$\n其中 $C_1$ 是一个积分常数。\n\n第二次积分，得到 $p(x)^2$ 的通解：\n$$ p(x)^2 = \\frac{C}{2} x^2 + C_1 x + C_2 $$\n$$ p(x)^2 = -\\frac{\\mu RT S_m}{k} x^2 + C_1 x + C_2 $$\n其中 $C_2$ 是第二个积分常数。\n\n现在，我们应用边界条件来求解 $C_1$和 $C_2$。\n\n条件 $u(0)=0$ 必须与压力相关。根据 Darcy 定律 $u = -\\frac{k}{\\mu} \\frac{dp}{dx}$ 和链式法则关系 $\\frac{d(p^2)}{dx} = 2p \\frac{dp}{dx}$，我们得到：\n$$ u(x) = -\\frac{k}{\\mu} \\left(\\frac{1}{2p(x)}\\frac{d(p^2)}{dx}\\right) = -\\frac{k}{2\\mu p(x)} (C x + C_1) $$\n在 $x=0$ 处应用该条件：\n$$ u(0) = -\\frac{k}{2\\mu p(0)} (C \\cdot 0 + C_1) = -\\frac{k C_1}{2\\mu p(0)} = 0 $$\n由于 $k$、$\\mu$ 和 $p(0)$（物理压力必须为正）都不为零，这意味着 $C_1 = 0$。\n\n当 $C_1=0$ 时，解简化为：\n$$ p(x)^2 = -\\frac{\\mu RT S_m}{k} x^2 + C_2 $$\n现在我们应用第二个边界条件 $p(L)=p_{\\text{ext}}$：\n$$ p(L)^2 = p_{\\text{ext}}^2 = -\\frac{\\mu RT S_m}{k} L^2 + C_2 $$\n求解 $C_2$：\n$$ C_2 = p_{\\text{ext}}^2 + \\frac{\\mu RT S_m}{k} L^2 $$\n将 $C_2$ 代回 $p(x)^2$ 的解中，我们得到压力分布的最终解析表达式：\n$$ p(x)^2 = -\\frac{\\mu RT S_m}{k} x^2 + \\left( p_{\\text{ext}}^2 + \\frac{\\mu RT S_m}{k} L^2 \\right) $$\n$$ p(x)^2 = p_{\\text{ext}}^2 + \\frac{\\mu RT S_m}{k} (L^2 - x^2) $$\n取平方根（压力必须为正）：\n$$ p(x) = \\sqrt{p_{\\text{ext}}^2 + \\frac{\\mu RT (1-\\varepsilon)\\dot{m}_d}{k} (L^2 - x^2)} $$\n\n接下来，我们求解速度 $u(x)$ 的表达式。当 $C_1=0$ 时，速度方程为：\n$$ u(x) = -\\frac{k}{2\\mu p(x)} (C x) = -\\frac{k}{2\\mu p(x)} \\left(-\\frac{2\\mu RT S_m}{k} x\\right) $$\n$$ u(x) = \\frac{RT S_m}{p(x)} x = \\frac{RT(1-\\varepsilon)\\dot{m}_d}{p(x)} x $$\n\n**3. 所需量的计算**\n\n-   **最大内部压力 ($p_{\\max}$)**\n    $p(x)^2$ 表达式中的项 $(L^2 - x^2)$ 在定义域 $x \\in [0, L]$ 内于 $x=0$ 处取得最大值。因此，最大压力 $p_{\\max}$ 出现在不可渗透边界上。\n    $$ p_{\\max} = p(0) = \\sqrt{p_{\\text{ext}}^2 + \\frac{\\mu RT (1-\\varepsilon)\\dot{m}_d}{k} L^2} $$\n\n-   **气体速度 ($u(x)$)**\n    指定点 $x \\in \\{0, L/4, L/2, 3L/4, L\\}$ 处的速度可以使用推导出的 $u(x)$ 公式计算，但需先计算每个点的局部压力 $p(x)$。注意，根据边界条件，$u(0) = 0$。\n\n-   **风险评估**\n    -   超压风险：如果 $p_{\\max} > p_{\\text{crit}}$ 则存在。\n    -   分层风险：如果 $p(0) > p_{\\text{delam}}$ 则存在。由于 $p_{\\max} = p(0)$，这等价于 $p_{\\max} > p_{\\text{delam}}$。\n\n-   **特殊情况：无气体生成 ($\\dot{m}_d = 0$)**\n    如果 $\\dot{m}_d = 0$，则 $S_m = 0$。推导出的方程可以正确地简化为：\n    -   $p(x) = \\sqrt{p_{\\text{ext}}^2 + 0} = p_{\\text{ext}}$ (压力恒定)。\n    -   $p_{\\max} = p_{\\text{ext}}$。\n    -   $u(x) = \\frac{0}{p(x)} x = 0$ (无流动)。\n    因此，通用公式是稳健的，可用于所有测试用例，包括 $\\dot{m}_d = 0$ 的第三个用例。\n\n现在将应用这些公式到提供的测试用例中进行实现。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_case_results(L, k, mu, T, R, p_ext, epsilon, mdot_d, p_crit, p_delam):\n    \"\"\"\n    Solves the boundary value problem for a single set of parameters.\n\n    Args:\n        L (float): Thickness of the layer (m).\n        k (float): Permeability (m^2).\n        mu (float): Dynamic viscosity (Pa*s).\n        T (float): Temperature (K).\n        R (float): Specific gas constant (J/kg*K).\n        p_ext (float): External pressure (Pa).\n        epsilon (float): Porosity (dimensionless).\n        mdot_d (float): Decomposition rate per unit solid volume (kg/m^3*s).\n        p_crit (float): Critical pressure for overpressure risk (Pa).\n        p_delam (float): Critical pressure for delamination risk (Pa).\n\n    Returns:\n        tuple: A tuple containing the maximum pressure, a list of velocities,\n               and two booleans for overpressure and delamination risk.\n    \"\"\"\n    # Calculate mass source term per unit bulk volume\n    S_m = (1.0 - epsilon) * mdot_d\n\n    # Handle the no-generation case to avoid unnecessary computation\n    if S_m == 0.0:\n        p_max = p_ext\n        velocities = [0.0, 0.0, 0.0, 0.0, 0.0]\n        overpressure_risk = p_max > p_crit\n        delamination_risk = p_max > p_delam\n        return p_max, velocities, overpressure_risk, delamination_risk\n\n    # Constant coefficient from the derived ODE solution for p(x)^2\n    # p(x)^2 = p_ext^2 + B * (L^2 - x^2), where B = (mu * R * T * S_m) / k\n    B = (mu * R * T * S_m) / k\n\n    # 1. Calculate maximum internal pressure (at x=0)\n    p_max_sq = p_ext**2 + B * L**2\n    p_max = np.sqrt(p_max_sq)\n\n    # 2. Calculate gas velocities at specified points\n    velocities = []\n    x_points = [0, L/4, L/2, 3*L/4, L]\n    \n    # Pre-calculate the numerator for the velocity expression: u(x) = (R * T * S_m * x) / p(x)\n    vel_num_factor = R * T * S_m\n    \n    for x in x_points:\n        if x == 0:\n            velocities.append(0.0)\n            continue\n        \n        # Calculate local pressure p(x)\n        p_x_sq = p_ext**2 + B * (L**2 - x**2)\n        p_x = np.sqrt(p_x_sq)\n        \n        # Calculate velocity u(x)\n        u_x = (vel_num_factor * x) / p_x\n        velocities.append(u_x)\n\n    # 3. Assess risks\n    overpressure_risk = p_max > p_crit\n    delamination_risk = p_max > p_delam\n\n    return p_max, velocities, overpressure_risk, delamination_risk\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # (L, k, mu, T, R, p_ext, epsilon, mdot_d, p_crit, p_delam)\n        (0.02, 1e-12, 1.8e-5, 1200, 287, 50000, 0.6, 0.05, 200000, 100000),\n        (0.02, 1e-14, 1.8e-5, 1500, 287, 20000, 0.3, 0.5, 250000, 280000),\n        (0.02, 1e-13, 2.5e-5, 1000, 300, 30000, 0.9, 0.0, 40000, 35000)\n    ]\n\n    results_str_list = []\n    for case in test_cases:\n        p_max, velocities, overpressure_risk, delamination_risk = calculate_case_results(*case)\n\n        # Format the numbers to the required precision\n        p_max_rounded = round(p_max, 1)\n        velocities_rounded = [round(v, 6) for v in velocities]\n\n        # Format the output strings exactly as required\n        u_vals_str = f\"[{','.join([f'{v:.6f}' for v in velocities_rounded])}]\"\n        \n        # repr() on bool gives 'True'/'False' which is the required format\n        result_str = (\n            f\"[{p_max_rounded},\"\n            f\"{u_vals_str},\"\n            f\"{repr(overpressure_risk)},\"\n            f\"{repr(delamination_risk)}]\"\n        )\n        results_str_list.append(result_str)\n\n    # Combine all case results into a single string\n    final_output = f\"[{','.join(results_str_list)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}