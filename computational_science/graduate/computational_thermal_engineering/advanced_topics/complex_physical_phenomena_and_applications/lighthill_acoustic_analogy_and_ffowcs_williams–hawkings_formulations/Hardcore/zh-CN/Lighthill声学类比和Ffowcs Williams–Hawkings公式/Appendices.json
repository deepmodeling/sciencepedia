{
    "hands_on_practices": [
        {
            "introduction": "计算流体动力学（CFD）模拟可以提供物体表面的详细压力数据，但如何将这些数据转化为远场的声学预测呢？本练习将指导您通过数值实现 Curle 积分来解决这个问题，这是计算由静止表面上的非定常载荷产生的噪声的基石。通过为承受波动压力的平板编写代码，您将实践从表面压力数据计算远场声压的关键技能，并探讨信号采样频率等实际问题。",
            "id": "3968395",
            "problem": "一块平坦的刚性矩形板，尺寸为 $L_x \\times L_y$，位于 $z=0$ 平面内，其单位法向量 $\\mathbf{n}$ 与 $+z$ 轴对齐。一股稳定的横流在该板上产生波动的表面压力 $p(\\mathbf{x}_s,t)$。位于 $\\mathbf{x}_o$ 位置的观察者记录由板的载荷产生的远场声压 $p'(\\mathbf{x}_o,t)$。您必须从一个有效的基础出发，并且不得使用陈述中的任何简便公式，推导出一个适用于静态、不可渗透表面在低马赫数下的可计算的远场表达式 $p'(\\mathbf{x}_o,t)$，然后设计并实现一个数值算法，以利用离散采样的计算流体动力学 (CFD) 压力数据来评估该表达式。\n\n使用以下与上下文相符的基本原理和定义：\n- 围绕静态环境线性化的可压缩流方程可得到带有相应源项的非齐次声波方程 $p'(\\mathbf{x},t)$。\n- 声波方程的自由空间格林函数决定了从声源到观察者的迟滞时间辐射。\n- 对于静态、不可渗透的边界，在低马赫数远场辐射中，体积四极子项可以忽略不计，主要的载荷噪声贡献可以表示为作用在边界上的表面压力。\n\n基于这些原理，推导一个适用于该板的 $p'(\\mathbf{x}_o,t)$ 表达式，并清楚地说明所有假设。然后，根据您的推导，在一个完整的、可运行的程序中实现以下数值评估策略：\n- 将板离散为 $N_x \\times N_y$ 个矩形单元，使用中点求积法计算表面积分。\n- 对于每个中心为 $\\mathbf{x}_s$ 的表面单元，计算迟滞时间 $t_r = t - r/c_0$，其中 $r = \\lVert \\mathbf{x}_o - \\mathbf{x}_s \\rVert$， $c_0$ 是环境声速。\n- 假设 $p(\\mathbf{x}_s,t)$ 的 CFD 数据以均匀采样频率 $f_s$ 可用，使用对称有限差分和在 $t_r$ 处的线性插值，从离散样本中数值计算所需的 $p(\\mathbf{x}_s,t_r)$ 的时间导数。\n- 将所有单元的贡献相加，得到 $p'(\\mathbf{x}_o,t)$。\n\n讨论并在代码中计算，当在采样前应用具有分数过渡裕度 $\\eta$ 的因果抗混叠滤波器时，为解析高达 $f_{\\max}$ (Hz) 的声学带宽所需的最小采样频率 $f_s$。明确陈述您的假设，并基于奈奎斯特准则和滤波器过渡带约束，提供一个推荐的 $f_s$ 作为 $f_{\\max}$ 和 $\\eta$ 的函数公式。\n\n物理和数值单位：\n- 压力以帕斯卡 ($\\mathrm{Pa}$) 表示。\n- 距离以米 ($\\mathrm{m}$) 表示。\n- 时间以秒 ($\\mathrm{s}$) 表示。\n- 频率（包括采样频率）以赫兹 ($\\mathrm{Hz}$) 表示。\n- 不使用角度；不要引入角度单位。\n\n您的程序必须使用在板上定义的如下合成类 CFD 压力数据以进行测试：\n- 任何表面点的压力在空间上是均匀的，由 $p(\\mathbf{x}_s,t) = p_0 \\cos(2\\pi f t)$ 给出，其中 $p_0$ 是压力幅值 (单位 $\\mathrm{Pa}$)，$f$ 是单音频率 (单位 $\\mathrm{Hz}$)。\n- 离散样本是在一个足够大的时间窗口内以均匀采样频率 $f_s$ 获取的，以覆盖所有所需的迟滞时间评估，并使用线性插值来评估非网格时间点的值，用于有限差分导数计算。\n\n测试套件和最终输出规范：\n为以下四个测试案例实现该算法。对于每个案例，计算：\n- 在指定观测时间 $t$ 的远场声压 $p'(\\mathbf{x}_o,t)$ (单位 $\\mathrm{Pa}$)。\n- 指示给定的采样频率 $f_s$ 是否足以根据您推荐的采样准则以裕度 $\\eta$ 解析目标声学带宽 $f_{\\max}$ 的布尔值。\n- 推荐的采样频率 $f_{s,\\mathrm{rec}}$ (单位 $\\mathrm{Hz}$)。\n\n案例 1（正常路径）：\n- $c_0 = 343\\,\\mathrm{m/s}$，$L_x = 0.2\\,\\mathrm{m}$，$L_y = 0.1\\,\\mathrm{m}$，$N_x = 20$，$N_y = 10$，$\\mathbf{x}_o = (0,0,1)\\,\\mathrm{m}$，$p_0 = 2\\,\\mathrm{Pa}$，$f = 1000\\,\\mathrm{Hz}$，$f_s = 20000\\,\\mathrm{Hz}$，$t = 0.01\\,\\mathrm{s}$，$f_{\\max} = 5000\\,\\mathrm{Hz}$，$\\eta = 0.2$。\n\n案例 2（偶极子零点几何边缘情况）：\n- $c_0 = 343\\,\\mathrm{m/s}$，$L_x = 0.2\\,\\mathrm{m}$，$L_y = 0.1\\,\\mathrm{m}$，$N_x = 20$，$N_y = 10$，$\\mathbf{x}_o = (0.3,0,0)\\,\\mathrm{m}$，$p_0 = 2\\,\\mathrm{Pa}$，$f = 1000\\,\\mathrm{Hz}$，$f_s = 20000\\,\\mathrm{Hz}$，$t = 0.01\\,\\mathrm{s}$，$f_{\\max} = 5000\\,\\mathrm{Hz}$，$\\eta = 0.2$。\n\n案例 3（接近奈奎斯特的边界采样）：\n- $c_0 = 343\\,\\mathrm{m/s}$，$L_x = 0.2\\,\\mathrm{m}$，$L_y = 0.1\\,\\mathrm{m}$，$N_x = 10$，$N_y = 5$，$\\mathbf{x}_o = (0,0,1)\\,\\mathrm{m}$，$p_0 = 1\\,\\mathrm{Pa}$，$f = 8000\\,\\mathrm{Hz}$，$f_s = 16000\\,\\mathrm{Hz}$，$t = 0.005\\,\\mathrm{s}$，$f_{\\max} = 8000\\,\\mathrm{Hz}$，$\\eta = 0.25$。\n\n案例 4（采样裕度不足）：\n- $c_0 = 343\\,\\mathrm{m/s}$，$L_x = 0.2\\,\\mathrm{m}$，$L_y = 0.1\\,\\mathrm{m}$，$N_x = 20$，$N_y = 10$，$\\mathbf{x}_o = (0,0,0.5)\\,\\mathrm{m}$，$p_0 = 0.5\\,\\mathrm{Pa}$，$f = 3000\\,\\mathrm{Hz}$，$f_s = 6000\\,\\mathrm{Hz}$，$t = 0.003\\,\\mathrm{s}$，$f_{\\max} = 3000\\,\\mathrm{Hz}$，$\\eta = 0.1$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个逗号分隔的列表的列表，每个测试案例一个列表，每个内部列表的形式为 $[p',\\mathrm{bool},f_{s,\\mathrm{rec}}]$，例如，$[[p'_1,\\mathrm{bool}_1,f_{s,\\mathrm{rec},1}],[p'_2,\\mathrm{bool}_2,f_{s,\\mathrm{rec},2}],\\dots]$。$p'$ 以 $\\mathrm{Pa}$ 表示，布尔值表示为 $\\mathrm{True}$ 或 $\\mathrm{False}$，$f_{s,\\mathrm{rec}}$ 以 $\\mathrm{Hz}$ 表示。",
            "solution": "已对用户提供的问题陈述进行了严格验证，并被认为是科学上合理、适定、客观和自洽的。它提出了一个计算航空声学领域的标准问题，可以使用既定原理进行形式化和求解。所有必要的数据都已提供，约束条件一致且符合物理实际。因此，该问题是有效的。\n\n解决方案分为两部分：首先，推导远场声压的控制方程；其次，开发用于评估此方程的数值算法。\n\n### 第 1 部分：远场声压的推导\n\n物理问题是计算由承受波动表面压力载荷的静态刚性板所辐射的声。此分析的起点是声学类比，特别是 Curle 对 Lighthill 理论的扩展，以包含固体边界。对于流经静态、不可渗透表面的低马赫数流动，观察者位置 $\\mathbf{x}_o$ 和时间 $t$ 处的声压 $p'(\\mathbf{x}_o,t)$ 可以表示为厚度噪声和载荷噪声之和。\n\n厚度噪声源于运动表面对流体的排挤作用，对于问题陈述中给出的静态表面，该项为零。\n\n载荷噪声源于表面对流体施加的力，是主要的声源。来自静态表面 $S$ 的载荷噪声的通用表达式由 Curle 积分给出：\n$$\np'(\\mathbf{x}_o, t) = \\frac{1}{4\\pi} \\int_S \\left( \\frac{[\\dot{p}']_{t_r}}{r c_0} (\\mathbf{n} \\cdot \\hat{\\mathbf{r}}) + \\frac{[p']_{t_r}}{r^2} (\\mathbf{n} \\cdot \\hat{\\mathbf{r}}) \\right) dS(\\mathbf{x}_s)\n$$\n其中 $\\mathbf{x}_s$ 是表面 $S$ 上的点，$\\mathbf{r} = \\mathbf{x}_o - \\mathbf{x}_s$ 是从源点到观察者的矢量，$r = \\lVert\\mathbf{r}\\rVert$，且 $\\hat{\\mathbf{r}} = \\mathbf{r}/r$。表面上的压力波动为 $p'(\\mathbf{x}_s, t)$，符号 $[\\cdot]_{t_r}$ 表示在迟滞时间 $t_r = t - r/c_0$ 进行评估。声速为 $c_0$，$\\mathbf{n}$ 是表面上的单位法向量，指向流体域。时间导数用 $\\dot{p}'$ 表示。\n\n积分项中的第一项，与 $1/r$ 成正比，在远场（其中 $r \\gg \\lambda$，$\\lambda$ 为声波波长）中占主导地位，而第二项，与 $1/r^2$ 成正比，是近场流体动力学效应。由于问题要求一个“可计算的远场表达式”，我们只保留主导的远场项：\n$$\np'(\\mathbf{x}_o, t) \\approx \\frac{1}{4\\pi c_0} \\int_S \\frac{(\\mathbf{n} \\cdot \\hat{\\mathbf{r}})}{r} \\left[ \\frac{\\partial p(\\mathbf{x}_s, t)}{\\partial t} \\right]_{t_r} dS(\\mathbf{x}_s)\n$$\n在这里，我们将压力波动 $p'$ 替换为总表面压力 $p$，因为环境压力的时间导数为零。\n\n对于指定的几何形状，板位于 $z=0$ 平面，其法向量为 $\\mathbf{n} = (0, 0, 1)$。位于 $\\mathbf{x}_o = (x_o, y_o, z_o)$ 的观察者和位于 $\\mathbf{x}_s = (x_s, y_s, 0)$ 的源点给出的矢量为 $\\mathbf{r} = (x_o - x_s, y_o - y_s, z_o)$。点积 $\\mathbf{n} \\cdot \\mathbf{r}$ 仅为 $z_o$。因此，$\\mathbf{n} \\cdot \\hat{\\mathbf{r}} = z_o/r$。将此代入远场表达式，得到待实现的公式：\n$$\np'(\\mathbf{x}_o, t) = \\frac{1}{4\\pi c_0} \\int_S \\frac{z_o}{r(\\mathbf{x}_s)^2} \\left. \\frac{\\partial p(\\mathbf{x}_s, \\tau)}{\\partial \\tau} \\right|_{\\tau=t_r} dS(\\mathbf{x}_s)\n$$\n该表达式在以下假设下有效：\n1.  观察者位于源板的声学远场。\n2.  产生压力的流动的马赫数很低。\n3.  板是静态的、刚性的、不可渗透的。\n4.  周围介质是静止的均匀流体。\n\n### 第 2 部分：数值评估算法\n\n上述推导的积分按规定进行数值评估。\n\n**表面离散化：** 面积为 $L_x \\times L_y$ 的矩形板被离散化为 $N_x \\times N_y$ 个较小的矩形单元网格。每个单元的面积为 $\\Delta S = (L_x/N_x) \\cdot (L_y/N_y)$。表面积分使用中点求积法进行近似，该方法用所有单元上的求和代替积分，并在每个单元的中心评估被积函数。单元中心坐标为 $\\mathbf{x}_{s,ij}$，其中 $i \\in \\{0, \\dots, N_x-1\\}$ 且 $j \\in \\{0, \\dots, N_y-1\\}$。\n\n因此，积分公式变为离散和：\n$$\np'(\\mathbf{x}_o, t) \\approx \\frac{\\Delta S}{4\\pi c_0} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} \\frac{z_o}{r_{ij}^2} \\left. \\frac{\\partial p(\\mathbf{x}_{s,ij}, \\tau)}{\\partial \\tau} \\right|_{\\tau=t_{r,ij}}\n$$\n其中 $r_{ij} = \\lVert \\mathbf{x}_o - \\mathbf{x}_{s,ij} \\rVert$ 且 $t_{r,ij} = t - r_{ij}/c_0$。问题陈述表明板上的压力在空间上是均匀的，即 $p(\\mathbf{x}_s, t) = p(t)$，这进一步简化了评估。\n\n**数值微分：** 时间导数 $\\partial p / \\partial \\tau$ 使用二阶对称有限差分格式进行数值计算。对于在离散时间点（间距为 $T_s = 1/f_s$）已知的函数 $p(\\tau)$，其在任意时间 $\\tau$ 的导数可近似为：\n$$\n\\frac{dp}{d\\tau} \\approx \\frac{p(\\tau + h) - p(\\tau - h)}{2h}\n$$\n步长 $h$ 的一个合适选择是 $h = T_s$。所需的压力值 $p(\\tau + T_s)$ 和 $p(\\tau - T_s)$ 通过对以均匀采样频率 $f_s$ 提供的离散样本进行线性插值得到，因为评估时间 $t_{r,ij} \\pm T_s$ 通常不与采样点重合。\n\n### 第 3 部分：采样频率准则\n\n为了可靠地捕捉最大频率成分为 $f_{\\max}$ 的信号，奈奎斯特-香农采样定理指出，采样频率 $f_s$ 必须大于该最大频率的两倍，即 $f_s > 2 f_{\\max}$。这假设了一个理想的“砖墙”抗混叠滤波器。实际的滤波器在通带和阻带之间有一个非零的过渡带。\n\n设通带边缘为 $f_p = f_{\\max}$。为防止混叠，阻带边缘 $f_{stop}$ 必须不高于奈奎斯特频率 $f_s/2$。问题指定了一个分数过渡裕度 $\\eta$。我们将其解释为定义了相对于感兴趣的最大频率的过渡带宽度，因此过渡带宽为 $\\eta f_{\\max}$。\n\n因此，阻带从 $f_{stop} = f_p + \\eta f_{\\max} = f_{\\max}(1 + \\eta)$ 开始。防止混叠的条件是 $f_{stop} \\le f_s/2$。这导致了推荐的最小采样频率 $f_{s,\\mathrm{rec}}$ 的以下准则：\n$$\nf_{\\max}(1 + \\eta) \\le \\frac{f_s}{2} \\implies f_s \\ge 2 f_{\\max}(1 + \\eta)\n$$\n因此，我们定义推荐的采样频率为：\n$$\nf_{s,\\mathrm{rec}} = 2 f_{\\max}(1 + \\eta)\n$$\n如果 $f_s \\ge f_{s,\\mathrm{rec}}$，则给定的采样频率 $f_s$ 是足够的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the aeroacoustics problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            \"c0\": 343.0, \"Lx\": 0.2, \"Ly\": 0.1, \"Nx\": 20, \"Ny\": 10,\n            \"xo\": (0.0, 0.0, 1.0), \"p0\": 2.0, \"f\": 1000.0, \"fs\": 20000.0,\n            \"t\": 0.01, \"f_max\": 5000.0, \"eta\": 0.2\n        },\n        # Case 2\n        {\n            \"c0\": 343.0, \"Lx\": 0.2, \"Ly\": 0.1, \"Nx\": 20, \"Ny\": 10,\n            \"xo\": (0.3, 0.0, 0.0), \"p0\": 2.0, \"f\": 1000.0, \"fs\": 20000.0,\n            \"t\": 0.01, \"f_max\": 5000.0, \"eta\": 0.2\n        },\n        # Case 3\n        {\n            \"c0\": 343.0, \"Lx\": 0.2, \"Ly\": 0.1, \"Nx\": 10, \"Ny\": 5,\n            \"xo\": (0.0, 0.0, 1.0), \"p0\": 1.0, \"f\": 8000.0, \"fs\": 16000.0,\n            \"t\": 0.005, \"f_max\": 8000.0, \"eta\": 0.25\n        },\n        # Case 4\n        {\n            \"c0\": 343.0, \"Lx\": 0.2, \"Ly\": 0.1, \"Nx\": 20, \"Ny\": 10,\n            \"xo\": (0.0, 0.0, 0.5), \"p0\": 0.5, \"f\": 3000.0, \"fs\": 6000.0,\n            \"t\": 0.003, \"f_max\": 3000.0, \"eta\": 0.1\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        c0 = case[\"c0\"]\n        Lx, Ly = case[\"Lx\"], case[\"Ly\"]\n        Nx, Ny = case[\"Nx\"], case[\"Ny\"]\n        x_o_vec = np.array(case[\"xo\"])\n        p0, f, fs = case[\"p0\"], case[\"f\"], case[\"fs\"]\n        t_obs = case[\"t\"]\n        f_max, eta = case[\"f_max\"], case[\"eta\"]\n\n        # Part 1: Sampling frequency analysis\n        f_s_rec = 2 * f_max * (1 + eta)\n        is_sufficient = fs >= f_s_rec\n\n        # Part 2: Acoustic pressure calculation\n        p_prime = 0.0\n\n        # Handle dipole null case efficiently\n        if x_o_vec[2] == 0:\n            p_prime = 0.0\n        else:\n            delta_x = Lx / Nx\n            delta_y = Ly / Ny\n            delta_S = delta_x * delta_y\n            Ts = 1.0 / fs\n            \n            # Create grid of surface element centers\n            x_centers = np.linspace(-Lx/2 + delta_x/2, Lx/2 - delta_x/2, Nx)\n            y_centers = np.linspace(-Ly/2 + delta_y/2, Ly/2 - delta_y/2, Ny)\n            xs_grid, ys_grid = np.meshgrid(x_centers, y_centers)\n            \n            # Vectorized calculation of distances and retarded times\n            # Reshape for broadcasting\n            xs_flat = xs_grid.flatten()\n            ys_flat = ys_grid.flatten()\n\n            r_vecs = x_o_vec - np.vstack([xs_flat, ys_flat, np.zeros_like(xs_flat)]).T\n            r_mags = np.linalg.norm(r_vecs, axis=1)\n            retarded_times = t_obs - r_mags / c0\n\n            # Determine time window for synthetic signal\n            t_min_eval = np.min(retarded_times) - Ts\n            t_max_eval = np.max(retarded_times) + Ts\n            \n            # Generate discrete pressure signal for interpolation\n            # Use floor/ceil to ensure the range is fully covered\n            num_samples = int(np.ceil((t_max_eval - t_min_eval) * fs)) + 2\n            t_samples_start = np.floor(t_min_eval * fs) / fs\n            t_samples = t_samples_start + np.arange(num_samples) * Ts\n            p_samples = p0 * np.cos(2 * np.pi * f * t_samples)\n\n            # Times for finite difference\n            t1 = retarded_times - Ts\n            t2 = retarded_times + Ts\n\n            # Interpolate pressure at required times\n            p1 = np.interp(t1, t_samples, p_samples)\n            p2 = np.interp(t2, t_samples, p_samples)\n\n            # Compute numerical derivative\n            dp_dt_num = (p2 - p1) / (2 * Ts)\n\n            # Sum contributions from all elements\n            # The integrand is (z_o / r^2) * dp_dt\n            z_o = x_o_vec[2]\n            integrand_values = (z_o / (r_mags**2)) * dp_dt_num\n            \n            # Perform the summation\n            integral_sum = np.sum(integrand_values)\n\n            # Final pressure calculation\n            p_prime = (delta_S / (4 * np.pi * c0)) * integral_sum\n\n        results.append([p_prime, is_sufficient, f_s_rec])\n\n    # Format and print the final output\n    # `str()` on a list correctly formats it with brackets, and on a boolean with T/F.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "当声源在运动时，声学分析会变得更加复杂，其核心挑战在于确定信号的发射时间，即“延迟时间”。由于声波传播需要时间，在特定时刻和位置观测到的声音实际上是在更早的时刻从不同位置发出的。本练习将引导您为一个沿复杂螺旋轨迹运动的点声源，建立并求解其延迟时间方程，这是对螺旋桨、风扇或涡轮机等旋转机械进行气动声学预测的必备步骤。",
            "id": "3968410",
            "problem": "考虑在Lighthill声比拟和Ffowcs Williams–Hawkings (FW–H) 方程的框架内，预测来自移动声源的远场声学。从声速为常数 $c$ 的均匀、静止介质中声压脉动的非齐次标量波动方程开始：\n$$\n\\frac{1}{c^2}\\,\\frac{\\partial^2 p'}{\\partial t^2} - \\nabla^2 p' = s(\\boldsymbol{x},t),\n$$\n其中 $p'(\\boldsymbol{x},t)$ 是声压脉动，$\\boldsymbol{x}\\in\\mathbb{R}^3$ 是观测点位置， $t$ 是时间（单位：秒），而 $s(\\boldsymbol{x},t)$ 是由流动引起的应力产生的有效声源项，与Lighthill声比拟或Ffowcs Williams–Hawkings扩展一致。在自由空间中，左侧算子的因果格林函数支撑在声锥上。利用这一事实推导出一个约束条件：在源点位置 $\\boldsymbol{y}(\\tau)$ 和时间 $\\tau$ 发出的任何贡献，只有在满足一个通过声速 $c$ 将 $t$、$\\tau$、$\\boldsymbol{x}$ 和 $\\boldsymbol{y}(\\tau)$ 联系起来的因果关系时，才能在 $(\\boldsymbol{x},t)$ 处被观测到。从波动算子及其自由空间格林函数出发，依据第一性原理明确推导出此因果约束，而不要引用任何预先推导的声比拟辐射积分。\n\n然后，将问题特化为一个在螺旋轨迹上以恒定角速度和轴向速度前进的旋转叶片单元，该单元被建模为一个点运动源。声源轨迹为\n$$\n\\boldsymbol{y}(\\tau) = \n\\begin{bmatrix}\nR\\cos\\!\\left(\\psi_0 + \\Omega\\,\\tau\\right) \\\\\nR\\sin\\!\\left(\\psi_0 + \\Omega\\,\\tau\\right) \\\\\nz_0 + U\\,\\tau\n\\end{bmatrix},\n$$\n其中 $R$ 是叶片单元半径（单位：米），$\\Omega$ 是角速度（单位：弧度/秒），$\\psi_0$ 是初始方位角（单位：弧度），$U$ 是恒定轴向推进速度（单位：米/秒），$z_0$ 是初始轴向位置（单位：米），$\\tau$ 是发出时间（单位：秒）。观测点位于\n$$\n\\boldsymbol{x} = \\begin{bmatrix} x \\\\ y \\\\ z \\end{bmatrix}\\;\\;\\text{（单位：米），}\n$$\n观测时间为 $t$ （单位：秒）。仅使用您推导出的因果约束，为此移动声源建立一个非线性方程，该方程的解是与 $(\\boldsymbol{x},t)$ 相关联的延迟发出时间 $t_r$。\n\n您的任务是实现一个鲁棒的数值算法，对于给定的参数 $(c,R,\\Omega,\\psi_0,U,z_0,\\boldsymbol{x},t)$ 和一个有界搜索窗口 $[t-\\Delta T,\\,t]$（其中 $\\Delta T>0$），该算法能返回窗口内所有满足因果约束的延迟时间 $t_r$。该算法必须设计成能够检测存在的多重解（例如，当轨迹部分区域的切向速度超过 $c$ 时），并能处理求根函数斜率很小的近简并情况。该算法必须：\n- 通过在区间 $[t-\\Delta T,\\,t]$ 上使用 $N$ 个网格点进行均匀采样，构建变号区间。\n- 对每个检测到的区间，使用一种在连续性条件下保证收敛的区间法将根的精度提高。\n- 通过一个容差去除数值上重合的根，并返回一个排序后的唯一根列表。\n\n除了计算 $t_r$ 外，您的实现必须在内部计算相应的延迟源位置 $\\boldsymbol{y}(t_r)$ 以验证正确性，即使您不将这些位置包含在最终输出中。所有角度单位均为弧度。所有距离单位均为米。所有时间单位均为秒。声速 $c$ 的单位必须是米/秒。\n\n设计您的程序以评估以下测试套件。对于每个测试用例 $i$，程序必须使用 $N_i$ 个网格点在窗口 $[t_i-\\Delta T_i,\\,t_i]$ 中搜索 $t_r$，并以排序列表的形式返回找到的所有根。将返回的每个 $t_r$ 表示为秒，并四舍五入到恰好六位小数。\n\n- 测试用例A（亚声速，一般位置）：\n  - $c = 343.0$, $R = 0.75$, $\\Omega = 200.0$, $\\psi_0 = 0.0$, $U = 10.0$, $z_0 = 0.0$,\n  - $\\boldsymbol{x} = [\\,5.0,\\,0.0,\\,1.0\\,]$, $t = 0.04$,\n  - $\\Delta T = 0.05$, $N = 20000$.\n\n- 测试用例B（近掠射，高亚声速叶尖速度）：\n  - $c = 343.0$, $R = 1.0$, $\\Omega = 300.0$, $\\psi_0 = 1.2$, $U = 0.0$, $z_0 = 0.0$,\n  - $\\boldsymbol{x} = [\\,2.0,\\,3.0,\\,0.1\\,]$, $t = 0.02$,\n  - $\\Delta T = 0.05$, $N = 20000$.\n\n- 测试用例C（超声速叶尖速度，可能存在多重根）：\n  - $c = 343.0$, $R = 1.0$, $\\Omega = 400.0$, $\\psi_0 = 0.3$, $U = 0.0$, $z_0 = 0.0$,\n  - $\\boldsymbol{x} = [\\,10.0,\\,0.0,\\,0.0\\,]$, $t = 0.08$,\n  - $\\Delta T = 0.10$, $N = 40000$.\n\n- 测试用例D（窗口过短，无根）：\n  - $c = 343.0$, $R = 0.5$, $\\Omega = 100.0$, $\\psi_0 = 0.0$, $U = 0.0$, $z_0 = 0.0$,\n  - $\\boldsymbol{x} = [\\,100.0,\\,0.0,\\,0.0\\,]$, $t = 1.0$,\n  - $\\Delta T = 0.001$, $N = 2000$.\n\n最终输出格式：\n- 您的程序必须生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个元素按 A、B、C、D 的顺序对应一个测试用例，其本身是一个列表，包含在指定窗口中找到的已排序的延迟时间 $t_r$（单位：秒），每个时间都四舍五入到六位小数。例如，如果一个测试用例产生两个根 $t_{r,1}$ 和 $t_{r,2}$，相应的元素应为 $[t_{r,1},t_{r,2}]$，如果未找到根，则应为 $[]$。",
            "solution": "该问题要求推导由移动声源发出的声波的因果约束，并将其应用于特定的螺旋源轨迹。随后，必须开发一个数值算法来求解延迟发出时间。\n\n首先，我们从第一性原理推导因果约束。我们从声速为 $c$ 的静止、均匀介质中的声压扰动 $p'(\\boldsymbol{x},t)$ 的非齐次标量波动方程开始：\n$$\n\\frac{1}{c^2}\\,\\frac{\\partial^2 p'}{\\partial t^2} - \\nabla^2 p' = s(\\boldsymbol{x},t)\n$$\n这个线性偏微分方程可以使用 d'Alembert 算子 $\\Box = \\frac{1}{c^2}\\frac{\\partial^2}{\\partial t^2} - \\nabla^2$ 紧凑地写为 $\\Box p'(\\boldsymbol{x},t) = s(\\boldsymbol{x},t)$。其解可以使用自由空间格林函数 $G(\\boldsymbol{x},t; \\boldsymbol{y},\\tau)$ 形式上表示，该函数是 $\\Box G = \\delta(\\boldsymbol{x}-\\boldsymbol{y})\\delta(t-\\tau)$ 的解，其中 $\\delta(\\cdot)$ 是 Dirac delta 函数。确保果不能先于因的物理上正确的（因果）格林函数由下式给出：\n$$\nG(\\boldsymbol{x},t; \\boldsymbol{y},\\tau) = \\frac{\\delta\\left(t - \\tau - \\frac{|\\boldsymbol{x}-\\boldsymbol{y}|}{c}\\right)}{4\\pi|\\boldsymbol{x}-\\boldsymbol{y}|}\n$$\n压力场则通过将源项与格林函数对所有源位置 $\\boldsymbol{y}$ 和发出时间 $\\tau$ 进行卷积得到：\n$$\np'(\\boldsymbol{x},t) = \\int_{-\\infty}^{\\infty} \\int_{V} s(\\boldsymbol{y},\\tau) G(\\boldsymbol{x},t; \\boldsymbol{y},\\tau) \\,d^3\\boldsymbol{y}\\,d\\tau\n$$\n代入 $G$ 的表达式，我们得到：\n$$\np'(\\boldsymbol{x},t) = \\int_{-\\infty}^{\\infty} \\int_{V} s(\\boldsymbol{y},\\tau) \\frac{\\delta\\left(t - \\tau - \\frac{|\\boldsymbol{x}-\\boldsymbol{y}|}{c}\\right)}{4\\pi|\\boldsymbol{x}-\\boldsymbol{y}|} \\,d^3\\boldsymbol{y}\\,d\\tau\n$$\nDirac delta 函数的关键性质是其筛选性质：$\\int f(z) \\delta(z-a) dz = f(a)$。将其应用于对 $\\tau$ 的积分，delta 函数仅在其自变量为零时才非零。这对观测点的时空坐标 $(\\boldsymbol{x},t)$ 和源点的时空坐标 $(\\boldsymbol{y},\\tau)$ 之间的关系施加了一个严格的约束。为了使位于 $(\\boldsymbol{y},\\tau)$ 的源元所做的任何贡献能够在 $(\\boldsymbol{x},t)$ 处被感知到，必须满足以下关系：\n$$\nt - \\tau - \\frac{|\\boldsymbol{x}-\\boldsymbol{y}|}{c} = 0\n$$\n这就是因果约束。它表明，观测时间 $t$ 必须等于发出时间 $\\tau$ 加上声音以速度 $c$ 传播距离 $|\\boldsymbol{x}-\\boldsymbol{y}|$ 所需的时间。对于给定的 $t$，满足此关系的 $\\tau$ 被称为延迟时间，通常表示为 $t_r$。\n\n对于一个沿轨迹 $\\boldsymbol{y}(\\tau)$ 移动的声源，因果约束仅成为发出时间 $\\tau$ 的函数：\n$$\nt - \\tau - \\frac{|\\boldsymbol{x}-\\boldsymbol{y}(\\tau)|}{c} = 0\n$$\n这可以重新整理以突出传播时间：$t-\\tau = \\frac{|\\boldsymbol{x}-\\boldsymbol{y}(\\tau)|}{c}$。必须求解该方程以得到 $\\tau$，从而找到与给定观测时间 $t$ 对应的延迟时间 $t_r$。\n\n接下来，我们将其特化到给定的螺旋源轨迹：\n$$\n\\boldsymbol{y}(\\tau) = \n\\begin{bmatrix}\nR\\cos\\!\\left(\\psi_0 + \\Omega\\,\\tau\\right) \\\\\nR\\sin\\!\\left(\\psi_0 + \\Omega\\,\\tau\\right) \\\\\nz_0 + U\\,\\tau\n\\end{bmatrix}\n$$\n观测点位于 $\\boldsymbol{x} = [x, y, z]^T$。我们寻求求解因果方程的延迟时间 $t_r$。为了消除平方根，在数值上最好使用平方形式。由于 $t > t_r$，项 $t-t_r$ 是正的，因此我们可以对 $c(t-t_r) = |\\boldsymbol{x}-\\boldsymbol{y}(t_r)|$ 两边取平方而不会引入伪解：\n$$\nc^2(t-t_r)^2 = |\\boldsymbol{x}-\\boldsymbol{y}(t_r)|^2\n$$\n距离的平方是：\n$$\n|\\boldsymbol{x}-\\boldsymbol{y}(t_r)|^2 = (x - R\\cos(\\psi_0 + \\Omega t_r))^2 + (y - R\\sin(\\psi_0 + \\Omega t_r))^2 + (z - (z_0 + U t_r))^2\n$$\n因此，关于延迟时间 $t_r$ 的非线性方程就是求函数 $g(t_r)$ 的根：\n$$\ng(t_r) = c^2(t-t_r)^2 - \\left[ (x - R\\cos(\\psi_0 + \\Omega t_r))^2 + (y - R\\sin(\\psi_0 + \\Omega t_r))^2 + (z - z_0 - U t_r)^2 \\right] = 0\n$$\n该方程必须通过数值方法求解。\n\n在搜索窗口 $[t-\\Delta T, t]$ 内寻找 $g(t_r)=0$ 的根 $t_r$ 的指定算法如下：\n1.  **定义函数** $g(t_r)$：根据给定测试用例的参数定义函数。\n2.  **采样定义域**：在区间 $[t-\\Delta T, t]$ 上创建包含 $N$ 个点的均匀网格 $\\tau_j$。在每个网格点上计算 $g(\\tau_j)$ 的值。\n3.  **寻找含根区间**：遍历网格点。如果 $g(\\tau_j)$ 和 $g(\\tau_{j+1})$ 符号相反（即 $g(\\tau_j) \\cdot g(\\tau_{j+1})  0$），则区间 $[\\tau_j, \\tau_{j+1}]$ 是一个包含至少一个根的区间。存储所有这样的区间。该方法能可靠地找到相对于网格间距足够分离的单根。\n4.  **提高根的精度**：对于每个区间 $[a, b]$，使用一个适用于区间的鲁棒数值求根算法。`scipy.optimize.brentq` 函数实现了 Brent 方法，对于有效区间内的连续函数，它能保证收敛，是一个绝佳的选择。\n5.  **去重和排序**：该过程可能会对同一个根产生多个数值上非常接近的近似值，特别是当根靠近某个网格点时。对找到的根列表进行排序，并通过迭代排序后的列表进行去重，只保留与前一个根的差值大于一个很小容差（例如 $10^{-9}$）的根。这样可以消除数值上的重复项。\n6.  **格式化输出**：对于每个测试用例，将最终的唯一、排序后的根四舍五入到所需的小数位数。\n\n这个过程对于寻找未知数量的根是鲁棒的，并且对于涉及超声速源运动（$R\\Omega > c$）的情况尤其必要，在这种情况下，多个延迟时间可能对应于单个观测时间。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for finding retarded times.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case A (subsonic, general position)\n        {\n            'c': 343.0, 'R': 0.75, 'Omega': 200.0, 'psi0': 0.0, 'U': 10.0, 'z0': 0.0,\n            'x_obs': np.array([5.0, 0.0, 1.0]), 't': 0.04,\n            'delta_T': 0.05, 'N': 20000\n        },\n        # Test case B (near-grazing, high subsonic tip speed)\n        {\n            'c': 343.0, 'R': 1.0, 'Omega': 300.0, 'psi0': 1.2, 'U': 0.0, 'z0': 0.0,\n            'x_obs': np.array([2.0, 3.0, 0.1]), 't': 0.02,\n            'delta_T': 0.05, 'N': 20000\n        },\n        # Test case C (supersonic tip speed, multiple roots possible)\n        {\n            'c': 343.0, 'R': 1.0, 'Omega': 400.0, 'psi0': 0.3, 'U': 0.0, 'z0': 0.0,\n            'x_obs': np.array([10.0, 0.0, 0.0]), 't': 0.08,\n            'delta_T': 0.10, 'N': 40000\n        },\n        # Test case D (no root within a too-short window)\n        {\n            'c': 343.0, 'R': 0.5, 'Omega': 100.0, 'psi0': 0.0, 'U': 0.0, 'z0': 0.0,\n            'x_obs': np.array([100.0, 0.0, 0.0]), 't': 1.0,\n            'delta_T': 0.001, 'N': 2000\n        }\n    ]\n\n    all_results = []\n    for params in test_cases:\n        roots = find_retarded_times(**params)\n        # Format each root to 6 decimal places as a string\n        formatted_roots = [f\"{r:.6f}\" for r in roots]\n        # Create the string representation of the list of roots\n        all_results.append(f\"[{','.join(formatted_roots)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\ndef find_retarded_times(c, R, Omega, psi0, U, z0, x_obs, t, delta_T, N):\n    \"\"\"\n    Finds all retarded times t_r in the window [t-delta_T, t] for a given\n    set of parameters using a bracketing and root-finding approach.\n    \"\"\"\n    \n    # Unpack observer coordinates\n    x, y, z = x_obs\n\n    # Define the nonlinear function g(t_r) = 0 for the retarded time.\n    # g(t_r) = c^2 * (t - t_r)^2 - |x - y(t_r)|^2\n    def g(tr):\n        # Calculate source position y(t_r) components\n        arg = psi0 + Omega * tr\n        y_tr_x = R * np.cos(arg)\n        y_tr_y = R * np.sin(arg)\n        y_tr_z = z0 + U * tr\n        \n        # Calculate squared distance |x - y(t_r)|^2\n        dist_sq = (x - y_tr_x)**2 + (y - y_tr_y)**2 + (z - y_tr_z)**2\n        \n        # Propagation term\n        prop_term = c**2 * (t - tr)**2\n        \n        return prop_term - dist_sq\n\n    # 1. Construct sign-change bracketing\n    t_start = t - delta_T\n    t_end = t\n    \n    # Create a grid of points to sample the function\n    t_grid = np.linspace(t_start, t_end, N)\n    g_vals = g(t_grid)\n    \n    brackets = []\n    for i in range(N - 1):\n        if np.sign(g_vals[i]) != np.sign(g_vals[i+1]):\n            # A sign change indicates a root in the interval\n            brackets.append((t_grid[i], t_grid[i+1]))\n\n    # 2. Refine each detected bracket to a root\n    roots = []\n    for a, b in brackets:\n        try:\n            root = brentq(g, a, b)\n            roots.append(root)\n        except ValueError:\n            # This can happen if g(a) and g(b) have the same sign due to precision,\n            # but the bracketing check should mostly prevent this.\n            pass\n\n    # 3. De-duplicate numerically coincident roots and sort\n    if not roots:\n        return []\n\n    # Sort the roots\n    roots.sort()\n    \n    # De-duplicate with a small tolerance\n    unique_roots = [roots[0]]\n    for i in range(1, len(roots)):\n        if abs(roots[i] - roots[i-1]) > 1e-9:\n            unique_roots.append(roots[i])\n            \n    return unique_roots\n\n# Execute the main function\nsolve()\n```"
        },
        {
            "introduction": "要深入理解气动声学现象，必须能将观测到的声场特性与声源本身的物理性质联系起来。本练习将向您展示如何从一个理想化的气动声学声源模型（湍流射流）出发，解析推导出远场声指向性图样。通过这个过程，您将清晰地看到声源的四极子性质和空间分布是如何共同决定我们最终听到的声音方向特性的，从而加深对 Lighthill 张量物理意义的理解。",
            "id": "3968408",
            "problem": "一个半径为 $a$ 的高雷诺数、低马赫数的轴对称湍流射流辐射出的声音，可以用 Lighthill 的声学比拟来建模。在密度为 $\\rho_{0}$、声速为 $c$ 的周围静止介质中，脉动声压 $p'(\\boldsymbol{x},t)$ 满足非齐次波动方程\n$$\n\\frac{\\partial^{2} p'}{\\partial t^{2}} - c^{2} \\nabla^{2} p' \\;=\\; \\frac{\\partial^{2} T_{ij}}{\\partial x_{i}\\,\\partial x_{j}},\n$$\n其中 $T_{ij}$ 是 Lighthill 应力张量。在远场和低马赫数条件下，假设辐射主要由与射流轴 $\\hat{\\boldsymbol{z}}$ 对齐的轴对称正应力分量 $T_{zz}$ 相关的四极子贡献主导。考虑角频率为 $\\omega$ 的单频分量，并记 $k=\\omega/c$。设观测者位于相对于射流轴的球坐标极角 $\\theta$ 处（具有方位对称性），距离为 $r \\gg a$。\n\n假设以下源结构理想化条件：\n- 轴向相关长度与声波长相比很短，因此轴向去相关消除了远场角谱中任何依赖于 $\\theta$ 的轴向相干效应。\n- $T_{zz}$ 的径向空间包络是高斯型的，$\\psi(r_{\\perp})=\\exp\\!\\left(-r_{\\perp}^{2}/(2 a^{2})\\right)$，其中 $r_{\\perp}$ 是离轴的距离。你可以将时间相关性视为角频率为 $\\omega$ 的单色波。\n\n从非齐次波动方程出发，使用自由空间格林函数和角谱表示，推导远场、单频的均方声压方向性（结果可相差一个不依赖于 $\\theta$ 的总常数），并将其表示为 $\\theta$ 和无量纲频率参数 $k a$ 的函数。清楚地论证四极子性质如何引入角张量因子，以及高斯径向包络如何塑造角谱。将 $\\theta=0$ 处的方向性归一化为1，从而消去总的乘法常数。\n\n最后，提供仅用 $\\theta$ 和 $k a$ 表示的归一化远场方向性 $D(\\theta;k a)$ 的闭式表达式。你的最终答案必须是单一的解析表达式。不需要进行数值取整。",
            "solution": "所述问题具有科学依据、是适定且客观的。它代表了基于 Lighthill 声学比拟的气动声学中的一个标准理论练习。所有给定的条件和假设都是该领域中常见的、有物理动机的理想化，从而导向一个可解且有意义的解。因此，该问题被视为**有效的**。我们开始进行推导。\n\n推导的出发点是在密度为 $\\rho_0$、声速为 $c$ 的静止介质中声压扰动 $p'(\\boldsymbol{x},t)$ 的非齐次波动方程：\n$$\n\\frac{\\partial^{2} p'}{\\partial t^{2}} - c^{2} \\nabla^{2} p' = \\frac{\\partial^{2} T_{ij}}{\\partial x_{i}\\,\\partial x_{j}}\n$$\n其中 $T_{ij}$ 是 Lighthill 应力张量。我们关心的是角频率为 $\\omega$ 的单频分量。因此，我们可以用傅里叶振幅来表示压力项和源项，$p'(\\boldsymbol{x},t) = \\text{Re}\\{\\hat{p}(\\boldsymbol{x}) e^{-i\\omega t}\\}$ 和 $T_{ij}(\\boldsymbol{x},t) = \\text{Re}\\{\\hat{T}_{ij}(\\boldsymbol{x}) e^{-i\\omega t}\\}$。将它们代入波动方程，得到复声压振幅 $\\hat{p}(\\boldsymbol{x})$ 的非齐次亥姆霍兹方程：\n$$\n(\\nabla^2 + k^2) \\hat{p}(\\boldsymbol{x}) = -\\frac{1}{c^2} \\frac{\\partial^2 \\hat{T}_{ij}}{\\partial x_{i}\\,\\partial x_{j}}\n$$\n其中 $k = \\omega/c$ 是声波数。右侧的源项是通过注意到 $\\frac{\\partial^2}{\\partial t^2} \\rightarrow (-\\omega)^2 = -k^2c^2$ 并将源中的 $-\\omega^2$ 因子吸收到亥姆霍兹算子中得到的。注意，一些惯例将 $1/c^2$ 吸收到源项定义中。这里我们遵循给定的方程，这导致 $\\frac{\\partial^2\\hat{T}_{ij}}{\\partial x_i \\partial x_j}$ 成为 $(-\\omega^2-c^2\\nabla^2)\\hat{p}$ 的源项。\n\n该方程的解可以用自由空间格林函数 $G(\\boldsymbol{x}, \\boldsymbol{y}) = \\frac{\\exp(ik|\\boldsymbol{x}-\\boldsymbol{y}|)}{4\\pi|\\boldsymbol{x}-\\boldsymbol{y}|}$ 表示为对源体积 $V$ 的积分：\n$$\n\\hat{p}(\\boldsymbol{x}) = \\int_V \\left(-\\frac{1}{c^2} \\frac{\\partial^2 \\hat{T}_{ij}}{\\partial y_i \\partial y_j}(\\boldsymbol{y}) \\right) G(\\boldsymbol{x}, \\boldsymbol{y}) \\, d^3\\boldsymbol{y}\n$$\n假设源张量 $\\hat{T}_{ij}$ 在源区域的边界处为零，我们可以进行两次分部积分，将空间导数从源项转移到格林函数上：\n$$\n\\hat{p}(\\boldsymbol{x}) = -\\frac{1}{c^2} \\int_V \\hat{T}_{ij}(\\boldsymbol{y}) \\frac{\\partial^2 G(\\boldsymbol{x}, \\boldsymbol{y})}{\\partial y_i \\partial y_j} \\, d^3\\boldsymbol{y}\n$$\n现在我们应用远场近似，即观测者位置 $r=|\\boldsymbol{x}|$ 远大于源区域的范围，即 $r \\gg |\\boldsymbol{y}|$。在此极限下，$|\\boldsymbol{x}-\\boldsymbol{y}| \\approx r - \\hat{\\boldsymbol{x}} \\cdot \\boldsymbol{y}$，其中 $\\hat{\\boldsymbol{x}} = \\boldsymbol{x}/r$ 是指向观测者方向的单位矢量。格林函数及其导数简化为：\n$$\nG(\\boldsymbol{x}, \\boldsymbol{y}) \\approx \\frac{\\exp(ikr)}{4\\pi r} \\exp(-ik\\hat{\\boldsymbol{x}} \\cdot \\boldsymbol{y})\n$$\n$$\n\\frac{\\partial G}{\\partial y_j} \\approx \\frac{\\exp(ikr)}{4\\pi r} (-ik\\hat{x}_j) \\exp(-ik\\hat{\\boldsymbol{x}} \\cdot \\boldsymbol{y})\n$$\n$$\n\\frac{\\partial^2 G}{\\partial y_i \\partial y_j} \\approx \\frac{\\exp(ikr)}{4\\pi r} (-ik\\hat{x}_i)(-ik\\hat{x}_j) \\exp(-ik\\hat{\\boldsymbol{x}} \\cdot \\boldsymbol{y}) = -k^2 \\hat{x}_i \\hat{x}_j \\frac{\\exp(ikr)}{4\\pi r} \\exp(-ik\\hat{\\boldsymbol{x}} \\cdot \\boldsymbol{y})\n$$\n将此代入压力积分，得到远场压力：\n$$\n\\hat{p}(\\boldsymbol{x}) \\approx \\frac{k^2}{c^2} \\frac{\\exp(ikr)}{4\\pi r} \\hat{x}_i \\hat{x}_j \\int_V \\hat{T}_{ij}(\\boldsymbol{y}) \\exp(-ik\\hat{\\boldsymbol{x}} \\cdot \\boldsymbol{y}) \\, d^3\\boldsymbol{y}\n$$\n问题指出辐射主要由轴对称正应力分量 $T_{zz}$ 主导。因此，我们设 $\\hat{T}_{ij} = \\delta_{iz}\\delta_{jz} \\hat{T}_{zz}$。缩并项 $\\hat{x}_i \\hat{x}_j \\hat{T}_{ij}$ 变为 $\\hat{x}_z \\hat{x}_z \\hat{T}_{zz}$。由于射流轴沿 $\\hat{\\boldsymbol{z}}$ 方向，球坐标极角 $\\theta$ 是 $\\hat{\\boldsymbol{x}}$ 和 $\\hat{\\boldsymbol{z}}$ 之间的夹角。因此，$\\hat{x}_z = \\hat{\\boldsymbol{x}} \\cdot \\hat{\\boldsymbol{z}} = \\cos\\theta$。压力表达式简化为：\n$$\n\\hat{p}(\\boldsymbol{x}) \\approx \\frac{k^2}{c^2} \\frac{\\exp(ikr)}{4\\pi r} \\cos^2\\theta \\int_V \\hat{T}_{zz}(\\boldsymbol{y}) \\exp(-ik\\hat{\\boldsymbol{x}} \\cdot \\boldsymbol{y}) \\, d^3\\boldsymbol{y}\n$$\n因此，均方压力 $\\langle |p'|^2 \\rangle \\propto |\\hat{p}|^2$ 将包含一个因子 $(\\cos^2\\theta)^2 = \\cos^4\\theta$。该项是由 $T_{zz}$ 分量决定的纵向四极子源的特征。\n\n接下来，我们使用给定的理想化假设来计算源积分。源积分项 $I(\\boldsymbol{k}_{rad}) = \\int \\hat{T}_{zz}(\\boldsymbol{y}) \\exp(-i\\boldsymbol{k}_{rad} \\cdot \\boldsymbol{y}) d^3\\boldsymbol{y}$ 表示在辐射波矢 $\\boldsymbol{k}_{rad} = k\\hat{\\boldsymbol{x}}$ 处求值的源分布的空间傅里叶变换。“轴向相关长度短”的假设意味着射流的不同轴向位置进行非相干辐射。这使我们可以通过考虑射流的单个代表性切片（一个圆盘）的辐射来找到方向性，因为总强度是所有这些切片的非相干和，并保留了角度依赖性。\n\n让我们将源建模为位于 $z_y=0$ 处的一个圆盘，其具有给定的高斯径向包络：$\\hat{T}_{zz}(\\boldsymbol{y}) = S_0 \\exp(-r_{\\perp}^2 / (2a^2)) \\delta(z_y)$，其中 $r_{\\perp}$ 是离 z 轴的径向距离，$S_0$ 是源振幅。该积分变为：\n$$\nI = S_0 \\int \\exp\\left(-\\frac{r_{\\perp}^2}{2a^2}\\right) \\delta(z_y) \\exp(-ik\\hat{\\boldsymbol{x}} \\cdot \\boldsymbol{y}) \\, d^3\\boldsymbol{y}\n$$\n在源的柱坐标系中，$\\boldsymbol{y} = (r_\\perp \\cos\\phi_y, r_\\perp \\sin\\phi_y, z_y)$。不失一般性，设观测者在 $xz$ 平面内，因此 $\\hat{\\boldsymbol{x}} = (\\sin\\theta, 0, \\cos\\theta)$。点积为 $\\hat{\\boldsymbol{x}} \\cdot \\boldsymbol{y} = r_\\perp \\sin\\theta \\cos\\phi_y + z_y \\cos\\theta$。对带有 delta 函数的 $z_y$ 进行积分会将 $z_y$ 设为0，并消除指数中对 $z_y$ 的依赖。\n$$\nI = S_0 \\int_{0}^{\\infty} r_\\perp dr_\\perp \\int_{0}^{2\\pi} d\\phi_y \\, \\exp\\left(-\\frac{r_{\\perp}^2}{2a^2}\\right) \\exp(-ik r_\\perp \\sin\\theta \\cos\\phi_y)\n$$\n对方位角 $\\phi_y$ 的积分是零阶第一类贝塞尔函数 $J_0(u)$ 的一个标准积分表示：\n$$\n\\int_{0}^{2\\pi} \\exp(-iu \\cos\\phi_y) d\\phi_y = 2\\pi J_0(u)\n$$\n此处，$u = k r_\\perp \\sin\\theta$。所以源积分变为：\n$$\nI = 2\\pi S_0 \\int_{0}^{\\infty} \\exp\\left(-\\frac{r_{\\perp}^2}{2a^2}\\right) J_0(k r_\\perp \\sin\\theta) r_\\perp dr_\\perp\n$$\n这是一个高斯函数的汉克尔变换。使用标准积分公式 $\\int_0^\\infty x \\exp(-p^2 x^2) J_0(qx) dx = \\frac{1}{2p^2}\\exp(-q^2/(4p^2))$，并设 $x=r_\\perp$，$p^2=1/(2a^2)$ 和 $q=k\\sin\\theta$，我们得到：\n$$\n\\int_{0}^{\\infty} \\dots dr_\\perp = \\frac{1}{2(1/2a^2))} \\exp\\left(-\\frac{(k\\sin\\theta)^2}{4(1/2a^2)}\\right) = a^2 \\exp\\left(-\\frac{k^2 a^2 \\sin^2\\theta}{2}\\right)\n$$\n将此结果代回，源积分正比于 $a^2 \\exp\\left(-\\frac{(ka \\sin\\theta)^2}{2}\\right)$。\n\n结合所有因子，远场复声压振幅正比于：\n$$\n\\hat{p}(\\boldsymbol{x}) \\propto \\cos^2\\theta \\cdot \\exp\\left(-\\frac{(ka \\sin\\theta)^2}{2}\\right)\n$$\n均方压力 $\\langle |p'(\\boldsymbol{x},t)|^2 \\rangle \\propto |\\hat{p}(\\boldsymbol{x})|^2$ 定义了方向性 $D(\\theta; ka)$。\n$$\nD(\\theta; ka) \\propto |\\hat{p}(\\boldsymbol{x})|^2 \\propto \\left(\\cos^2\\theta \\cdot \\exp\\left(-\\frac{(ka \\sin\\theta)^2}{2}\\right)\\right)^2\n$$\n$$\nD(\\theta; ka) = C_0 \\cos^4\\theta \\exp\\left(-(ka \\sin\\theta)^2\\right)\n$$\n其中 $C_0$ 是一个不依赖于 $\\theta$ 的常数。\n\n最后，我们将 $\\theta=0$ 处方向性归一化为1。\n$$\nD(0; ka) = C_0 \\cos^4(0) \\exp\\left(-(ka \\sin 0)^2\\right) = C_0 \\cdot 1 \\cdot \\exp(0) = C_0\n$$\n为了使 $D(0; ka) = 1$，我们必须设置 $C_0=1$。\n因此，归一化的远场方向性为：\n$$\nD(\\theta; ka) = \\cos^4\\theta \\exp\\left(-(ka)^2 \\sin^2\\theta\\right)\n$$\n此表达式展示了源的纵向四极子性质（$\\cos^4\\theta$ 因子）和源的有限横向尺寸（以高斯分布为特征，在角空间中充当低通滤波器，即指数因子）的组合效应。",
            "answer": "$$\n\\boxed{\\cos^{4}\\theta \\exp\\left(-(ka)^{2} \\sin^{2}\\theta\\right)}\n$$"
        }
    ]
}