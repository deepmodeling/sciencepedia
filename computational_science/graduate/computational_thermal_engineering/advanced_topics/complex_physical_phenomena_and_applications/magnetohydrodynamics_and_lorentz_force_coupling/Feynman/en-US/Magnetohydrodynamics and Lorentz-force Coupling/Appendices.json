{
    "hands_on_practices": [
        {
            "introduction": "Before applying the principles of magnetohydrodynamics, we must first establish their domain of validity. This foundational exercise guides you to test a key assumption of the MHD model: that the displacement current is negligible compared to the conduction current in most engineering applications . By deriving and calculating the ratio $\\frac{\\omega \\epsilon}{\\sigma}$ for a common industrial scenario, you will gain a rigorous understanding of why the magneto-quasi-static approximation is so effective and widely used in computational thermal engineering.",
            "id": "3969418",
            "problem": "A cylindrical induction furnace contains a pool of molten aluminum experiencing Alternating Current (AC) electromagnetic stirring. To decide whether Magnetohydrodynamics (MHD) can be treated in the magneto-quasi-static limit for computational thermal engineering analysis, consider the relative importance of displacement current and conduction current in Maxwell’s current continuity. Starting only from Maxwell–Ampère’s law and linear, isotropic constitutive relations, derive a dimensionless expression for the ratio of the magnitude of the displacement current density to the magnitude of the conduction current density under sinusoidal steady state at angular frequency $\\omega$. Then, evaluate this ratio for molten aluminum at temperature near its melting point, modeled with vacuum permittivity and uniform conductivity.\n\nUse the following data:\n- Vacuum permittivity: $\\epsilon_{0} = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F \\, m^{-1}}$.\n- Electrical conductivity of molten aluminum: $\\sigma = 3.3 \\times 10^{6} \\ \\mathrm{S \\, m^{-1}}$.\n- AC frequency: $f = 1.00 \\times 10^{5} \\ \\mathrm{Hz}$, so $\\omega = 2 \\pi f$ in $\\mathrm{rad \\, s^{-1}}$.\n- Assume the aluminum behaves as a linear, isotropic medium with $\\epsilon \\approx \\epsilon_{0}$ for the purposes of displacement current at this frequency.\n\nProvide the final ratio as a single dimensionless number rounded to four significant figures. No physical units should be included in the final reported value.",
            "solution": "The problem has been validated and is deemed to be scientifically grounded, well-posed, and objective. It is based on fundamental principles of electromagnetism and provides all necessary information for a unique solution. The scenario described is a standard problem in computational magnetohydrodynamics.\n\nThe objective is to derive an expression for the ratio of the magnitude of the displacement current density to the magnitude of the conduction current density and then evaluate this ratio for molten aluminum under specific AC conditions. This ratio is crucial for determining the validity of the magneto-quasi-static (MQS) approximation, where the displacement current is neglected.\n\nWe begin with the differential form of the Maxwell–Ampère law:\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J}_{\\text{total}} $$\nwhere $\\mathbf{H}$ is the magnetic field intensity and $\\mathbf{J}_{\\text{total}}$ is the total current density. The total current density is the sum of the free conduction current density, $\\mathbf{J}_{\\text{cond}}$, and the displacement current density, $\\mathbf{J}_{\\text{disp}}$:\n$$ \\mathbf{J}_{\\text{total}} = \\mathbf{J}_{\\text{cond}} + \\mathbf{J}_{\\text{disp}} $$\nThe displacement current density is defined as the time derivative of the electric displacement field, $\\mathbf{D}$:\n$$ \\mathbf{J}_{\\text{disp}} = \\frac{\\partial \\mathbf{D}}{\\partial t} $$\nThus, the Maxwell–Ampère law is fully written as:\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J}_{\\text{cond}} + \\frac{\\partial \\mathbf{D}}{\\partial t} $$\nFor a linear, isotropic medium, the constitutive relations are given by Ohm's law for the conduction current and the standard dielectric relation:\n$$ \\mathbf{J}_{\\text{cond}} = \\sigma \\mathbf{E} $$\n$$ \\mathbf{D} = \\epsilon \\mathbf{E} $$\nHere, $\\sigma$ is the electrical conductivity, $\\epsilon$ is the permittivity of the medium, and $\\mathbf{E}$ is the electric field.\n\nThe problem specifies a sinusoidal steady state at an angular frequency $\\omega$. In this regime, it is convenient to use phasor analysis. Any time-varying field quantity $A(t)$ can be represented as the real part of a complex phasor $\\tilde{A}$ multiplied by $e^{i\\omega t}$, such that $A(t) = \\text{Re}\\{\\tilde{A} e^{i\\omega t}\\}$. In the phasor domain, the time derivative operator $\\frac{\\partial}{\\partial t}$ is replaced by multiplication by $i\\omega$.\n\nApplying this to our current density terms:\nThe phasor for the conduction current density, $\\tilde{\\mathbf{J}}_{\\text{cond}}$, is related to the electric field phasor, $\\tilde{\\mathbf{E}}$, by:\n$$ \\tilde{\\mathbf{J}}_{\\text{cond}} = \\sigma \\tilde{\\mathbf{E}} $$\nThe phasor for the displacement current density, $\\tilde{\\mathbf{J}}_{\\text{disp}}$, is:\n$$ \\tilde{\\mathbf{J}}_{\\text{disp}} = i\\omega \\tilde{\\mathbf{D}} = i\\omega \\epsilon \\tilde{\\mathbf{E}} $$\nWe are asked to find the ratio of the magnitudes of these two current densities. The magnitude of a physical sinusoidal quantity is equal to the magnitude of its complex phasor. Therefore, we need to compute the ratio $\\frac{|\\tilde{\\mathbf{J}}_{\\text{disp}}|}{|\\tilde{\\mathbf{J}}_{\\text{cond}}|}$.\n\nThe magnitude of the conduction current density phasor is:\n$$ |\\tilde{\\mathbf{J}}_{\\text{cond}}| = |\\sigma \\tilde{\\mathbf{E}}| = \\sigma |\\tilde{\\mathbf{E}}| $$\nsince $\\sigma$ is a positive real scalar.\n\nThe magnitude of the displacement current density phasor is:\n$$ |\\tilde{\\mathbf{J}}_{\\text{disp}}| = |i\\omega \\epsilon \\tilde{\\mathbf{E}}| = |i||\\omega||\\epsilon||\\tilde{\\mathbf{E}}| = \\omega \\epsilon |\\tilde{\\mathbf{E}}| $$\nsince $\\omega$ and $\\epsilon$ are positive real scalars, and $|i|=1$.\n\nThe dimensionless ratio of the magnitudes is therefore:\n$$ \\frac{|\\tilde{\\mathbf{J}}_{\\text{disp}}|}{|\\tilde{\\mathbf{J}}_{\\text{cond}}|} = \\frac{\\omega \\epsilon |\\tilde{\\mathbf{E}}|}{\\sigma |\\tilde{\\mathbf{E}}|} = \\frac{\\omega \\epsilon}{\\sigma} $$\nThis expression provides the general formula for the ratio.\n\nNow, we evaluate this ratio using the provided data for molten aluminum:\n- Electrical conductivity: $\\sigma = 3.3 \\times 10^{6} \\ \\mathrm{S \\, m^{-1}}$.\n- The problem states to use the vacuum permittivity for the material's permittivity: $\\epsilon \\approx \\epsilon_{0} = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F \\, m^{-1}}$.\n- The AC frequency is $f = 1.00 \\times 10^{5} \\ \\mathrm{Hz}$. The angular frequency $\\omega$ is calculated as:\n$$ \\omega = 2 \\pi f = 2 \\pi (1.00 \\times 10^{5} \\ \\mathrm{s^{-1}}) $$\n\nSubstituting these values into the derived ratio expression:\n$$ \\frac{\\omega \\epsilon}{\\sigma} = \\frac{(2 \\pi \\times 1.00 \\times 10^{5}) \\times (8.8541878128 \\times 10^{-12})}{3.3 \\times 10^{6}} $$\nLet's perform the calculation:\n$$ \\frac{\\omega \\epsilon}{\\sigma} = \\frac{2\\pi \\times 8.8541878128 \\times 10^{-7}}{3.3 \\times 10^{6}} $$\n$$ \\frac{\\omega \\epsilon}{\\sigma} = \\frac{5.56340191 \\times 10^{-6}}{3.3 \\times 10^{6}} $$\n$$ \\frac{\\omega \\epsilon}{\\sigma} \\approx 1.68587936 \\times 10^{-12} $$\nThe problem requires the final answer to be rounded to four significant figures.\n$$ 1.68587936 \\times 10^{-12} \\approx 1.686 \\times 10^{-12} $$\nThis extremely small value indicates that the magnitude of the displacement current density is many orders of magnitude smaller than the magnitude of the conduction current density. For computational thermal engineering analysis of this system, this result rigorously justifies neglecting the displacement current term ($\\frac{\\partial \\mathbf{D}}{\\partial t}$) in Maxwell's equations, which is the essence of the magneto-quasi-static (MQS) approximation.",
            "answer": "$$\\boxed{1.686 \\times 10^{-12}}$$"
        },
        {
            "introduction": "The rich and complex behavior of magnetohydrodynamic flows can be distilled into the interplay between a few crucial dimensionless parameters. This practice challenges you to perform a nondimensionalization of the governing equations to derive the Hartmann number ($Ha$), the interaction parameter ($N$), and the magnetic Reynolds number ($Rm$) . By calculating their values for a molten metal flow, you will develop a powerful intuition for how the Lorentz force competes with inertial and viscous forces to reshape the velocity profile and dramatically alter momentum transport.",
            "id": "3969424",
            "problem": "An electrically conducting, incompressible molten aluminum stream flows steadily through a straight rectangular duct of hydraulic size characterized by a single geometric length scale $L$. A uniform, steady magnetic field of magnitude $B_0$ is imposed transverse to the mean flow. The molten metal is assumed isothermal for property evaluation, and the flow is in the low-frequency regime where displacement current is negligible. The governing physics is magnetohydrodynamics (MHD): fluid momentum is governed by the incompressible Navier–Stokes equations with the Lorentz force density, and the magnetic field evolution is governed by the magnetic induction equation with finite electrical conductivity. Ohm’s law for a moving conductor closes the electromagnetic response.\n\nStarting from the incompressible Navier–Stokes equations with the Lorentz force density and the magnetic induction equation, perform a consistent nondimensionalization using velocity scale $U$, length scale $L$, imposed magnetic field scale $B_0$, and material properties density $\\rho$, kinematic viscosity $\\nu$, and electrical conductivity $\\sigma$. Identify the resulting dimensionless groups that characterize magnetohydrodynamic Lorentz-force coupling and induction: the Hartmann number $Ha$, the interaction parameter (Stuart number) $N$, the magnetic Reynolds number $Rm$, and the magnetic Prandtl number $Pm$. Then, using the molten aluminum properties and flow-magnetic parameters provided below, evaluate $Ha$, $N$, $Rm$, and $Pm$ as dimensionless numbers, and, based on their magnitudes, briefly predict qualitative changes to the flow and momentum transport compared to the case $B_0=0$.\n\nUse the following values for molten aluminum at an operating temperature where properties are approximately constant:\n- Density: $\\rho = 2.375 \\times 10^{3}\\ \\mathrm{kg/m^3}$\n- Kinematic viscosity: $\\nu = 6.0 \\times 10^{-7}\\ \\mathrm{m^2/s}$\n- Electrical conductivity: $\\sigma = 3.2 \\times 10^{6}\\ \\mathrm{S/m}$\n- Imposed magnetic field: $B_0 = 0.8\\ \\mathrm{T}$\n- Velocity scale: $U = 0.15\\ \\mathrm{m/s}$\n- Length scale: $L = 0.04\\ \\mathrm{m}$\n\nFor electromagnetic constants, use the permeability of free space $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$.\n\nRound each of the four dimensionless quantities to three significant figures. Express your final numerical answer as a single $1 \\times 4$ row matrix in the order $\\big(Ha,\\ N,\\ Rm,\\ Pm\\big)$. The final answer must contain only numbers and no units inside the matrix. The qualitative prediction should appear in your working, not in the final boxed answer.",
            "solution": "The problem is scientifically grounded, well-posed, and objective. It is based on the fundamental principles of magnetohydrodynamics (MHD) and presents a standard analysis task in computational thermal engineering. All data required for the nondimensionalization and numerical evaluation are provided, and there are no contradictions or ambiguities. The problem is therefore deemed valid and a full solution will be provided.\n\nThe governing equations for an incompressible, conducting fluid in the presence of a magnetic field, under the low-frequency (MHD) approximation, are the incompressible Navier–Stokes equations and the magnetic induction equation. For a steady flow ($ \\frac{\\partial}{\\partial t} = 0 $), these are:\n\n1.  Mass Conservation (Continuity):\n    $$ \\nabla \\cdot \\mathbf{u} = 0 $$\n2.  Momentum Conservation (Navier–Stokes):\n    $$ \\rho (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\mathbf{J} \\times \\mathbf{B} $$\n3.  Magnetic Induction:\n    $$ \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) = \\frac{1}{\\mu_0 \\sigma} \\nabla \\times (\\nabla \\times \\mathbf{B}) $$\n\nHere, $\\mathbf{u}$ is the fluid velocity, $p$ is the pressure, $\\rho$ is the density, $\\mu = \\rho \\nu$ is the dynamic viscosity ($\\nu$ is kinematic viscosity), $\\mathbf{J}$ is the electric current density, $\\mathbf{B}$ is the magnetic field, $\\sigma$ is the electrical conductivity, and $\\mu_0$ is the permeability of free space. The term $\\mathbf{J} \\times \\mathbf{B}$ is the Lorentz force density.\n\nWe nondimensionalize these equations using the characteristic scales provided: velocity scale $U$, length scale $L$, and imposed magnetic field scale $B_0$. We define the dimensionless variables (denoted with a superscript $*$) as:\n$$ \\mathbf{u}^* = \\frac{\\mathbf{u}}{U}, \\quad \\mathbf{x}^* = \\frac{\\mathbf{x}}{L}, \\quad p^* = \\frac{p - p_0}{\\rho U^2}, \\quad \\mathbf{B}^* = \\frac{\\mathbf{B}}{B_0} $$\nThe gradient operator scales as $\\nabla = \\frac{1}{L}\\nabla^*$.\n\nSubstituting these into the steady Navier-Stokes equation:\n$$ \\rho \\left( (U \\mathbf{u}^*) \\cdot \\left(\\frac{1}{L}\\nabla^*\\right) \\right) (U \\mathbf{u}^*) = -\\left(\\frac{1}{L}\\nabla^*\\right) (\\rho U^2 p^*) + (\\rho \\nu) \\left(\\frac{1}{L^2}\\nabla^{*2}\\right) (U \\mathbf{u}^*) + \\mathbf{J} \\times (B_0 \\mathbf{B}^*) $$\n$$ \\frac{\\rho U^2}{L} (\\mathbf{u}^* \\cdot \\nabla^*) \\mathbf{u}^* = -\\frac{\\rho U^2}{L} \\nabla^* p^* + \\frac{\\rho \\nu U}{L^2} \\nabla^{*2} \\mathbf{u}^* + \\mathbf{J} \\times (B_0 \\mathbf{B}^*) $$\nThe current density $\\mathbf{J}$ is given by Ohm's law, $\\mathbf{J} = \\sigma(\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B})$. The characteristic scale of the induced electric field and the convective term are both of order $U B_0$, so the scale for current density is $J \\sim \\sigma U B_0$. The Lorentz force thus scales as $F_L \\sim (\\sigma U B_0) B_0 = \\sigma U B_0^2$.\nLet's divide the momentum equation by the inertial term scale $\\frac{\\rho U^2}{L}$:\n$$ (\\mathbf{u}^* \\cdot \\nabla^*) \\mathbf{u}^* = -\\nabla^* p^* + \\frac{\\rho \\nu U / L^2}{\\rho U^2 / L} \\nabla^{*2} \\mathbf{u}^* + \\frac{\\sigma U B_0^2}{\\rho U^2 / L} (\\mathbf{j}^* \\times \\mathbf{B}^*) $$\nSimplifying the coefficients gives the dimensionless groups. The coefficient of the viscous term is:\n$$ \\frac{\\nu}{UL} = \\frac{1}{Re} $$\nwhere $Re = \\frac{UL}{\\nu}$ is the Reynolds number. The coefficient of the Lorentz force term is:\n$$ \\frac{\\sigma U B_0^2 L}{\\rho U^2} = \\frac{\\sigma B_0^2 L}{\\rho U} = N $$\nThis dimensionless group $N$ is the **Interaction Parameter** (or Stuart number), representing the ratio of Lorentz force to inertial force.\n\nNext, we nondimensionalize the steady magnetic induction equation:\n$$ \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) = \\frac{1}{\\mu_0 \\sigma} \\nabla \\times (\\nabla \\times \\mathbf{B}) $$\n$$ \\left(\\frac{1}{L}\\nabla^*\\right) \\times (U \\mathbf{u}^* \\times B_0 \\mathbf{B}^*) = \\frac{1}{\\mu_0 \\sigma} \\left(\\frac{1}{L}\\nabla^*\\right) \\times \\left( \\left(\\frac{1}{L}\\nabla^*\\right) \\times B_0 \\mathbf{B}^* \\right) $$\n$$ \\frac{U B_0}{L} \\nabla^* \\times (\\mathbf{u}^* \\times \\mathbf{B}^*) = \\frac{B_0}{\\mu_0 \\sigma L^2} \\nabla^* \\times (\\nabla^* \\times \\mathbf{B}^*) $$\nDividing by $\\frac{U B_0}{L}$ yields:\n$$ \\nabla^* \\times (\\mathbf{u}^* \\times \\mathbf{B}^*) = \\frac{1}{\\mu_0 \\sigma U L} \\nabla^* \\times (\\nabla^* \\times \\mathbf{B}^*) $$\nThe coefficient on the right-hand side is the inverse of the **Magnetic Reynolds Number**, $Rm$:\n$$ Rm = \\mu_0 \\sigma U L $$\n$Rm$ represents the ratio of advection to diffusion of the magnetic field.\n\nThe problem also asks for the Hartmann number ($Ha$) and the magnetic Prandtl number ($Pm$).\nThe **Hartmann number** squared, $Ha^2$, is the ratio of Lorentz forces to viscous forces:\n$$ Ha^2 = \\frac{\\text{Lorentz force}}{\\text{Viscous force}} = \\frac{\\sigma U B_0^2}{\\rho \\nu U / L^2} = \\frac{\\sigma B_0^2 L^2}{\\rho \\nu} \\quad \\implies \\quad Ha = B_0 L \\sqrt{\\frac{\\sigma}{\\rho\\nu}} $$\nNotice the relationship $N = \\frac{\\sigma B_0^2 L}{\\rho U} = \\left(\\frac{\\sigma B_0^2 L^2}{\\rho\\nu}\\right) \\left(\\frac{\\nu}{UL}\\right) = \\frac{Ha^2}{Re}$.\n\nThe **Magnetic Prandtl number**, $Pm$, is the ratio of momentum diffusivity (kinematic viscosity, $\\nu$) to magnetic diffusivity ($\\eta = 1/(\\mu_0 \\sigma)$):\n$$ Pm = \\frac{\\nu}{\\eta} = \\mu_0 \\sigma \\nu $$\nNotice the relationship $Rm = (\\mu_0 \\sigma \\nu) \\frac{U L}{\\nu} = Pm \\cdot Re$.\n\nNow, we evaluate these four dimensionless numbers using the provided values:\n- $\\rho = 2.375 \\times 10^{3}\\ \\mathrm{kg/m^3}$\n- $\\nu = 6.0 \\times 10^{-7}\\ \\mathrm{m^2/s}$\n- $\\sigma = 3.2 \\times 10^{6}\\ \\mathrm{S/m}$\n- $B_0 = 0.8\\ \\mathrm{T}$\n- $U = 0.15\\ \\mathrm{m/s}$\n- $L = 0.04\\ \\mathrm{m}$\n- $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$\n\n**Hartmann Number (Ha):**\n$$ Ha = B_0 L \\sqrt{\\frac{\\sigma}{\\rho \\nu}} = (0.8)(0.04) \\sqrt{\\frac{3.2 \\times 10^6}{(2.375 \\times 10^3)(6.0 \\times 10^{-7})}} $$\n$$ Ha = 0.032 \\sqrt{\\frac{3.2 \\times 10^6}{1.425 \\times 10^{-3}}} = 0.032 \\sqrt{2.2456 \\times 10^9} \\approx 0.032 \\times 47387.9 $$\n$$ Ha \\approx 1516.4 $$\nTo three significant figures, $Ha \\approx 1.52 \\times 10^3$.\n\n**Interaction Parameter (N):**\n$$ N = \\frac{\\sigma B_0^2 L}{\\rho U} = \\frac{(3.2 \\times 10^6)(0.8)^2(0.04)}{(2.375 \\times 10^3)(0.15)} $$\n$$ N = \\frac{(3.2 \\times 10^6)(0.64)(0.04)}{356.25} = \\frac{81920}{356.25} \\approx 229.95 $$\nTo three significant figures, $N \\approx 2.30 \\times 10^2$.\n\n**Magnetic Reynolds Number (Rm):**\n$$ Rm = \\mu_0 \\sigma U L = (4\\pi \\times 10^{-7})(3.2 \\times 10^6)(0.15)(0.04) $$\n$$ Rm = (4\\pi \\times 10^{-7})(3.2 \\times 10^6)(0.006) = 0.024127... $$\nTo three significant figures, $Rm \\approx 2.41 \\times 10^{-2}$.\n\n**Magnetic Prandtl Number (Pm):**\n$$ Pm = \\mu_0 \\sigma \\nu = (4\\pi \\times 10^{-7})(3.2 \\times 10^6)(6.0 \\times 10^{-7}) $$\n$$ Pm = 4\\pi \\times 3.2 \\times 6.0 \\times 10^{-7} = 2.4127... \\times 10^{-6} $$\nTo three significant figures, $Pm \\approx 2.41 \\times 10^{-6}$.\n\n**Qualitative Prediction of Flow Changes:**\nFor the non-magnetic case ($B_0=0$), the Reynolds number is $Re = UL/\\nu = (0.15)(0.04)/(6.0 \\times 10^{-7}) = 10000$. This value is well above the typical transition threshold for duct flow (around $Re \\approx 2300$), indicating the baseline flow would be turbulent.\n\nWhen the magnetic field is applied ($B_0=0.8\\ \\mathrm{T}$):\n1.  The large Hartmann number, $Ha \\approx 1520 \\gg 1$, signifies that electromagnetic (Lorentz) forces are overwhelmingly dominant compared to viscous forces.\n2.  The large Interaction Parameter, $N \\approx 230 \\gg 1$, signifies that Lorentz forces are also much larger than inertial forces.\n3.  The small Magnetic Reynolds number, $Rm \\approx 0.0241 \\ll 1$, indicates that the magnetic field induced by the fluid motion is very weak compared to the imposed field $B_0$. This is the \"low-Rm\" regime, where we can approximate the total magnetic field as just the imposed field, $\\mathbf{B} \\approx \\mathbf{B}_0$. This greatly simplifies the analysis of the Lorentz force.\n4.  The extremely small Magnetic Prandtl number, $Pm \\approx 2.41 \\times 10^{-6} \\ll 1$, is characteristic of liquid metals and means that momentum diffusivity ($\\nu$) is far greater than magnetic diffusivity ($\\eta$).\n\nBased on these magnitudes, the following qualitative changes are predicted:\n- **Laminarization:** The dominance of the Lorentz force ($N \\gg 1$) will strongly suppress turbulent eddies and velocity fluctuations. The flow, despite its high Reynolds number, will be \"laminarized\" by the magnetic field, becoming steady and orderly.\n- **Velocity Profile Flattening:** The powerful Lorentz braking force acts throughout the fluid core. To balance the pressure gradient, the flow reorganizes. Viscous effects become confined to extremely thin boundary layers. In the central region of the duct, the velocity profile will become nearly flat, a signature of high-$Ha$ MHD flow, often called \"slug flow\".\n- **Formation of Hartmann Layers:** The transition from the no-slip condition at walls perpendicular to $\\mathbf{B}_0$ to the flat core velocity occurs across very thin boundary layers called Hartmann layers. The thickness of these layers scales as $L/Ha$, which in this case is $\\delta_H \\approx 0.04/1520 \\approx 26\\ \\mu \\mathrm{m}$. These layers are characterized by intense viscous shear.\n- **Increased Pressure Drop:** The Lorentz force acts as a powerful braking mechanism. To maintain the same mean velocity $U$, a significantly larger pressure gradient must be applied to overcome this magnetic drag, leading to a dramatic increase in the overall pressure drop across the duct compared to the $B_0=0$ case.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.52 \\times 10^{3} & 2.30 \\times 10^{2} & 2.41 \\times 10^{-2} & 2.41 \\times 10^{-6} \\end{pmatrix} } $$"
        },
        {
            "introduction": "Translating MHD theory into reliable computational solvers requires numerical methods that respect the underlying physics. A paramount challenge is enforcing the divergence-free constraint, $\\nabla \\cdot \\mathbf{B} = 0$, at the discrete level to avoid unphysical magnetic monopoles. This hands-on coding exercise  introduces the constrained transport method, a cornerstone of modern MHD simulation, where representing the magnetic field as the curl of a vector potential, $\\mathbf{B} = \\nabla \\times \\mathbf{A}$, elegantly and robustly guarantees a divergence-free field to machine precision.",
            "id": "3969454",
            "problem": "Consider two-dimensional ideal magnetohydrodynamics (MHD) in a periodic square domain where the magnetic field is represented by the curl of a magnetic vector potential. The goal is to construct a numerical benchmark using a magnetic vector potential based constrained transport (CT) update to advect a localized magnetic loop and verify that the numerically reconstructed magnetic field remains divergence-free at machine precision.\n\nStart from the following fundamental laws and core definitions:\n- Maxwell–Faraday law in differential form: $\\displaystyle \\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}$.\n- Ideal Ohm’s law: $\\displaystyle \\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}$.\n- Definition of magnetic vector potential: $\\displaystyle \\mathbf{B} = \\nabla \\times \\mathbf{A}$.\n- Choose the Weyl gauge for the magnetic vector potential, which sets the scalar potential to zero: $\\displaystyle \\phi = 0$.\n\nUnder these, the evolution of the magnetic vector potential satisfies $\\displaystyle \\frac{\\partial \\mathbf{A}}{\\partial t} = \\mathbf{v} \\times \\mathbf{B}$, ensuring that the numerical representation of $\\displaystyle \\mathbf{B}$ as a discrete curl of $\\displaystyle \\mathbf{A}$ remains free of magnetic monopoles. In two dimensions with $\\displaystyle \\mathbf{A} = (0,0,A_z)$, the evolution equation reduces to a pure advection equation for $\\displaystyle A_z$:\n$$\n\\frac{\\partial A_z}{\\partial t} + \\mathbf{v}\\cdot\\nabla A_z = 0,\n$$\nand the in-plane magnetic field components are reconstructed as\n$$\nB_x = \\frac{\\partial A_z}{\\partial y}, \\quad B_y = -\\frac{\\partial A_z}{\\partial x}, \\quad B_z = 0.\n$$\nThe discrete divergence of the magnetic field is defined using the same centered-difference operators that define the discrete curl,\n$$\n(\\nabla\\cdot\\mathbf{B})_{\\text{disc}} \\equiv D_x B_x + D_y B_y,\n$$\nand must be verified to be numerically zero by construction (i.e., within floating-point roundoff) when $\\displaystyle \\mathbf{B}$ is obtained as the discrete curl of $\\displaystyle \\mathbf{A}$.\n\nImplement the following benchmark in nondimensional units:\n- Domain: $\\displaystyle [0,L_x)\\times[0,L_y)$ with periodic boundary conditions, where $\\displaystyle L_x = L_y = L$.\n- Grid: a uniform, cell-centered mesh of $\\displaystyle N_x \\times N_y$ cells, spacings $\\displaystyle \\Delta x = L_x/N_x$, $\\displaystyle \\Delta y = L_y/N_y$.\n- Initial condition: a ring-shaped magnetic loop encoded in $\\displaystyle A_z(\\mathbf{x},0)$,\n$$\nA_z(x,y,0) = A_0 \\exp\\!\\left(-\\frac{\\left(r(x,y) - r_0\\right)^2}{w^2}\\right),\n$$\nwith $\\displaystyle r(x,y) = \\sqrt{(x-x_c)^2+(y-y_c)^2}$, center $\\displaystyle (x_c,y_c)=(L_x/2,L_y/2)$, amplitude $\\displaystyle A_0 = 1$, ring radius $\\displaystyle r_0$, and ring half-width $\\displaystyle w$.\n- Velocity: spatially uniform and constant in time, $\\displaystyle \\mathbf{v}=(v_x,v_y)$.\n- Evolution: advance $\\displaystyle A_z$ in time using a stable, first-order upwind scheme that solves $\\displaystyle \\partial_t A_z + v_x \\partial_x A_z + v_y \\partial_y A_z = 0$ under periodic boundaries. Use a Courant–Friedrichs–Lewy (CFL) number $\\displaystyle C=0.5$ to select the time step $\\displaystyle \\Delta t$ so that stability is guaranteed. Evolve to a specified final time $\\displaystyle T$.\n\nAfter reaching $\\displaystyle t=T$, reconstruct the magnetic field $\\displaystyle \\mathbf{B}$ from $\\displaystyle A_z$ using centered differences:\n$$\nB_x = D_y A_z = \\frac{A_z(x,y+\\Delta y) - A_z(x,y-\\Delta y)}{2\\Delta y}, \\quad\nB_y = -D_x A_z = -\\frac{A_z(x+\\Delta x,y) - A_z(x-\\Delta x,y)}{2\\Delta x}.\n$$\nCompute the discrete divergence of $\\displaystyle \\mathbf{B}$ using the same centered differences:\n$$\n(\\nabla\\cdot\\mathbf{B})_{\\text{disc}} = D_x B_x + D_y B_y.\n$$\nYour program must report, for each test case, the single scalar quantity\n$$\n\\max_{i,j} \\left|(\\nabla\\cdot\\mathbf{B})_{\\text{disc}}\\right|,\n$$\ni.e., the maximum absolute discrete divergence over all grid cells at $\\displaystyle t=T$. All quantities are nondimensional, and no physical units are required.\n\nImplement the benchmark for the following four test cases, chosen to exercise different aspects of the scheme:\n- Case $\\displaystyle 1$ (happy path): $\\displaystyle N_x=N_y=128$, $\\displaystyle L=1$, $\\displaystyle v_x=0.5$, $\\displaystyle v_y=-0.3$, $\\displaystyle T=2.0$, $\\displaystyle r_0=0.25L$, $\\displaystyle w=0.05L$.\n- Case $\\displaystyle 2$ (zero-velocity boundary case): $\\displaystyle N_x=N_y=64$, $\\displaystyle L=1$, $\\displaystyle v_x=0.0$, $\\displaystyle v_y=0.0$, $\\displaystyle T=1.0$, $\\displaystyle r_0=0.3L$, $\\displaystyle w=0.07L$.\n- Case $\\displaystyle 3$ (coarse grid, strong advection in $\\displaystyle x$): $\\displaystyle N_x=N_y=16$, $\\displaystyle L=1$, $\\displaystyle v_x=1.0$, $\\displaystyle v_y=0.0$, $\\displaystyle T=1.0$, $\\displaystyle r_0=0.2L$, $\\displaystyle w=0.04L$.\n- Case $\\displaystyle 4$ (anisotropic advection, different resolution): $\\displaystyle N_x=96$, $\\displaystyle N_y=128$, $\\displaystyle L=1$, $\\displaystyle v_x=-0.25$, $\\displaystyle v_y=0.75$, $\\displaystyle T=1.5$, $\\displaystyle r_0=0.35L$, $\\displaystyle w=0.03L$.\n\nYour program should produce a single line of output containing these four results as a comma-separated list enclosed in square brackets, in the order of the cases above (e.g., $\\displaystyle [r_1,r_2,r_3,r_4]$). Each $\\displaystyle r_k$ must be a floating-point number computed as specified. No other output is permitted.\n\nThis benchmark is kinematic: you do not solve the momentum or energy equations; the Lorentz-force coupling term $\\displaystyle \\mathbf{J}\\times\\mathbf{B}$ (with current density $\\displaystyle \\mathbf{J}=(1/\\mu_0)\\nabla\\times\\mathbf{B}$ and magnetic permeability $\\displaystyle \\mu_0$) is not applied to the velocity. Nevertheless, the divergence-free property of the reconstructed $\\displaystyle \\mathbf{B}$ is essential for scientifically realistic coupling in general MHD simulations.",
            "solution": "The problem statement has been meticulously validated and is determined to be valid. It is scientifically grounded in the principles of ideal magnetohydrodynamics (MHD), is well-posed with a complete and consistent set of definitions and constraints, and presents a non-trivial, verifiable computational benchmark.\n\nThe fundamental task is to verify a cornerstone property of constrained transport (CT) schemes in computational MHD: the preservation of the divergence-free condition for the magnetic field, $\\nabla \\cdot \\mathbf{B} = 0$, at the discrete level. The problem is set in two dimensions and simplifies the full MHD system to a kinematic problem where a scalar magnetic vector potential, $A_z$, is advected by a prescribed velocity field $\\mathbf{v}$.\n\nThe derivation begins with the Maxwell-Faraday law and ideal Ohm's law:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}, \\quad \\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}\n$$\nIntroducing the magnetic vector potential $\\mathbf{A}$ such that $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ and choosing the Weyl gauge (zero scalar potential, $\\phi=0$), the evolution of $\\mathbf{A}$ is governed by:\n$$\n\\frac{\\partial \\mathbf{A}}{\\partial t} = \\mathbf{v} \\times \\mathbf{B} = \\mathbf{v} \\times (\\nabla \\times \\mathbf{A})\n$$\nFor a two-dimensional system where the velocity is in-plane, $\\mathbf{v} = (v_x, v_y, 0)$, and the vector potential is out-of-plane, $\\mathbf{A} = (0, 0, A_z)$, the in-plane magnetic field is $\\mathbf{B} = (\\partial_y A_z, -\\partial_x A_z, 0)$. The evolution equation for $\\mathbf{A}$ simplifies to a scalar advection equation for $A_z$:\n$$\n\\frac{\\partial A_z}{\\partial t} + v_x \\frac{\\partial A_z}{\\partial x} + v_y \\frac{\\partial A_z}{\\partial y} = 0 \\quad \\implies \\quad \\frac{\\partial A_z}{\\partial t} + \\mathbf{v}\\cdot\\nabla A_z = 0\n$$\nThe core of the problem lies in the numerical discretization. The Constrained Transport method hinges on defining the discrete curl and divergence operations such that the analytical identity $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) \\equiv 0$ is exactly preserved. The problem specifies second-order centered-difference operators for this purpose. Let $D_x$ and $D_y$ represent these discrete operators. The discrete magnetic field components are computed from $A_z$ as:\n$$\nB_x = D_y A_z, \\quad B_y = -D_x A_z\n$$\nThe discrete divergence of this field is then computed using the same operators:\n$$\n(\\nabla\\cdot\\mathbf{B})_{\\text{disc}} = D_x B_x + D_y B_y = D_x(D_y A_z) + D_y(-D_x A_z) = D_x D_y A_z - D_y D_x Az\n$$\nFor the specified centered-difference stencils on a uniform grid, the discrete operators $D_x$ and $D_y$ commute, i.e., $D_x D_y f = D_y D_x f$ for any discrete field $f$. Consequently, the discrete divergence $(\\nabla\\cdot\\mathbf{B})_{\\text{disc}}$ is algebraically guaranteed to be zero. The numerical implementation will yield a result that is non-zero only due to floating-point round-off errors, and its magnitude should be on the order of machine epsilon. The time-evolution of $A_z$ via the advection scheme serves only to produce a non-trivial field at the final time $T$; the divergence-free property is a feature of the reconstruction operators, not the time-stepping scheme.\n\nThe numerical implementation proceeds as follows:\n$1$. **Grid and Initialization**: For each test case, a uniform, cell-centered grid of size $N_x \\times N_y$ is defined on the domain $[0, L) \\times [0, L)$, where $L=1$. The grid spacings are $\\Delta x = L/N_x$ and $\\Delta y = L/N_y$. The scalar field $A_z$ is initialized at the cell centers $(x_i, y_j) = ((i+0.5)\\Delta x, (j+0.5)\\Delta y)$ using the given Gaussian ring profile: $A_z(x,y,0) = A_0 \\exp(-((r(x,y) - r_0)^2 / w^2))$, with $A_0=1$.\n\n$2$. **Time Evolution**: The advection equation for $A_z$ is solved numerically from $t=0$ to $t=T$. A first-order explicit upwind scheme is used, which is appropriate and robust for pure advection problems. The update for a grid cell $(i,j)$ is:\n$$\nA_z^{n+1}_{i,j} = A_z^n_{i,j} - \\Delta t (v_x (\\partial_x A_z)^n_{i,j} + v_y (\\partial_y A_z)^n_{i,j})\n$$\nwhere the spatial derivatives are approximated with first-order upwind differences. For example, the $x$-derivative term is $v_x(A_z^n_{i,j} - A_z^n_{i-1,j})/\\Delta x$ if $v_x > 0$, and $v_x(A_z^n_{i+1,j} - A_z^n_{i,j})/\\Delta x$ if $v_x  0$. The time step $\\Delta t$ is selected to ensure stability, based on the Courant-Friedrichs-Lewy (CFL) number $C=0.5$: $\\Delta t = C / (|v_x|/\\Delta x + |v_y|/\\Delta y)$. For the special case where $v_x=v_y=0$, $A_z$ is stationary, and no time evolution is performed. Periodic boundary conditions are enforced by circular shifts of the grid data, readily implemented using `numpy.roll`.\n\n$3$. **Verification**: After evolving $A_z$ to the final time $T$, the magnetic field components $B_x$ and $B_y$ are reconstructed using second-order centered differences:\n$$\nB_x(i,j) = \\frac{A_z(i,j+1) - A_z(i,j-1)}{2\\Delta y}, \\quad B_y(i,j) = -\\frac{A_z(i+1,j) - A_z(i-1,j)}{2\\Delta x}\n$$\n(Note the index mapping to spatial coordinates). The divergence $(\\nabla \\cdot \\mathbf{B})_{\\text{disc}}$ is then calculated, again with centered differences:\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\text{disc}}(i,j) = \\frac{B_x(i+1,j) - B_x(i-1,j)}{2\\Delta x} + \\frac{B_y(i,j+1) - B_y(i,j-1)}{2\\Delta y}\n$$\nThe final reported value for each case is the maximum absolute value of this divergence field, $\\max |(\\nabla \\cdot \\mathbf{B})_{\\text{disc}}|$, across all grid cells.\n\nThe provided Python code implements this procedure for the four specified test cases. It leverages `numpy` for efficient array-based computations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 2D MHD benchmark problem for four test cases.\n    It advects a magnetic vector potential A_z and verifies that the\n    reconstructed magnetic field B remains divergence-free to machine precision.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (Nx, Ny, L, vx, vy, T, r0_factor, w_factor)\n    test_cases = [\n        (128, 128, 1.0, 0.5, -0.3, 2.0, 0.25, 0.05),   # Case 1\n        (64, 64, 1.0, 0.0, 0.0, 1.0, 0.3, 0.07),       # Case 2\n        (16, 16, 1.0, 1.0, 0.0, 1.0, 0.2, 0.04),       # Case 3\n        (96, 128, 1.0, -0.25, 0.75, 1.5, 0.35, 0.03)  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters\n        Nx, Ny, L, vx, vy, T, r0_factor, w_factor = case\n        Lx, Ly = L, L\n        r0 = r0_factor * L\n        w = w_factor * L\n        A0 = 1.0\n        CFL = 0.5\n\n        # Setup grid (cell-centered)\n        dx = Lx / Nx\n        dy = Ly / Ny\n        x_coords = (np.arange(Nx) + 0.5) * dx\n        y_coords = (np.arange(Ny) + 0.5) * dy\n        xx, yy = np.meshgrid(x_coords, y_coords)\n\n        # Initial condition for A_z\n        xc = Lx / 2.0\n        yc = Ly / 2.0\n        r = np.sqrt((xx - xc)**2 + (yy - yc)**2)\n        Az = A0 * np.exp(-((r - r0)**2) / w**2)\n\n        # Time evolution using first-order upwind scheme\n        # Handle zero-velocity case\n        if vx == 0.0 and vy == 0.0:\n            pass  # Az remains unchanged\n        else:\n            # Calculate stable time step dt\n            dt_max = CFL / (np.abs(vx) / dx + np.abs(vy) / dy)\n            # Find number of steps and exact dt to reach T\n            num_steps = int(np.ceil(T / dt_max))\n            dt = T / num_steps\n\n            for _ in range(num_steps):\n                Az_n = Az.copy()\n\n                # x-advection (upwind)\n                # Note: axis=1 for x-direction (columns)\n                if vx > 0:\n                    dAz_dx = (Az_n - np.roll(Az_n, 1, axis=1)) / dx\n                elif vx  0:\n                    dAz_dx = (np.roll(Az_n, -1, axis=1) - Az_n) / dx\n                else: # vx == 0\n                    dAz_dx = np.zeros_like(Az_n)\n\n                # y-advection (upwind)\n                # Note: axis=0 for y-direction (rows)\n                if vy > 0:\n                    dAz_dy = (Az_n - np.roll(Az_n, 1, axis=0)) / dy\n                elif vy  0:\n                    dAz_dy = (np.roll(Az_n, -1, axis=0) - Az_n) / dy\n                else: # vy == 0\n                    dAz_dy = np.zeros_like(Az_n)\n\n                Az = Az_n - dt * (vx * dAz_dx + vy * dAz_dy)\n        \n        # At t=T, reconstruct B field using centered differences\n        # Bx = d(Az)/dy\n        Az_up = np.roll(Az, -1, axis=0)\n        Az_down = np.roll(Az, 1, axis=0)\n        Bx = (Az_up - Az_down) / (2.0 * dy)\n\n        # By = -d(Az)/dx\n        Az_right = np.roll(Az, -1, axis=1)\n        Az_left = np.roll(Az, 1, axis=1)\n        By = -(Az_right - Az_left) / (2.0 * dx)\n\n        # Compute discrete divergence of B using centered differences\n        # Dx_Bx = d(Bx)/dx\n        Bx_right = np.roll(Bx, -1, axis=1)\n        Bx_left = np.roll(Bx, 1, axis=1)\n        Dx_Bx = (Bx_right - Bx_left) / (2.0 * dx)\n\n        # Dy_By = d(By)/dy\n        By_up = np.roll(By, -1, axis=0)\n        By_down = np.roll(By, 1, axis=0)\n        Dy_By = (By_up - By_down) / (2.0 * dy)\n        \n        divB = Dx_Bx + Dy_By\n        \n        # Calculate the maximum absolute divergence over the grid\n        max_abs_divB = np.max(np.abs(divB))\n        results.append(max_abs_divB)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}