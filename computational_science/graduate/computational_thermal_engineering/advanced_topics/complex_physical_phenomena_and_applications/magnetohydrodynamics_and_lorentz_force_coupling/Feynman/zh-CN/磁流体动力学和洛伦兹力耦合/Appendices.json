{
    "hands_on_practices": [
        {
            "introduction": "在深入研究磁流体动力学（MHD）的复杂耦合现象之前，我们首先需要理解其理论根基。MHD本身是麦克斯韦方程组与流体动力学方程组在特定条件下的简化近似。这项实践  将指导你从麦克斯韦-安培定律出发，推导并计算位移电流与传导电流之比，从而定量地验证为何在如熔融金属等良导体中，位移电流可以被忽略。理解这一磁准静态（magneto-quasi-static, MQS）近似的适用范围，是正确应用MHD模型的关键第一步。",
            "id": "3969418",
            "problem": "一个圆柱形感应炉内有熔融铝液，受到交流电（AC）电磁搅拌。为判断在计算热工分析中是否可将磁流体动力学（MHD）视为磁准静态极限，请考虑麦克斯韦电流连续性方程中位移电流和传导电流的相对重要性。仅从麦克斯韦-安培定律以及线性和各向同性的本构关系出发，推导在角频率为 $\\omega$ 的正弦稳态下，位移电流密度大小与传导电流密度大小之比的无量纲表达式。然后，对于接近其熔点的熔融铝，使用真空介电常数和均匀电导率进行建模，计算该比值。\n\n使用以下数据：\n- 真空介电常数：$\\epsilon_{0} = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F \\, m^{-1}}$。\n- 熔融铝的电导率：$\\sigma = 3.3 \\times 10^{6} \\ \\mathrm{S \\, m^{-1}}$。\n- 交流电频率：$f = 1.00 \\times 10^{5} \\ \\mathrm{Hz}$，因此角频率 $\\omega = 2 \\pi f$，单位为 $\\mathrm{rad \\, s^{-1}}$。\n- 假设在此频率下，为了计算位移电流，铝的行为可视为线性、各向同性介质，其介电常数 $\\epsilon \\approx \\epsilon_{0}$。\n\n将最终比值以无量纲数的形式给出，并四舍五入至四位有效数字。最终报告值中不应包含任何物理单位。",
            "solution": "该问题已经过验证，被认为是科学上成立、提法恰当且客观的。它基于电磁学的基本原理，并为获得唯一解提供了所有必要信息。所述场景是计算磁流体动力学中的一个标准问题。\n\n目标是推导位移电流密度大小与传导电流密度大小之比的表达式，然后针对特定交流条件下的熔融铝计算该比值。这个比值对于确定磁准静态（MQS）近似的有效性至关重要，在MQS近似中，位移电流被忽略。\n\n我们从麦克斯韦-安培定律的微分形式开始：\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J}_{\\text{total}} $$\n其中 $\\mathbf{H}$ 是磁场强度，$\\mathbf{J}_{\\text{total}}$ 是总电流密度。总电流密度是自由传导电流密度 $\\mathbf{J}_{\\text{cond}}$ 和位移电流密度 $\\mathbf{J}_{\\text{disp}}$ 的和：\n$$ \\mathbf{J}_{\\text{total}} = \\mathbf{J}_{\\text{cond}} + \\mathbf{J}_{\\text{disp}} $$\n位移电流密度定义为电位移场 $\\mathbf{D}$ 对时间的导数：\n$$ \\mathbf{J}_{\\text{disp}} = \\frac{\\partial \\mathbf{D}}{\\partial t} $$\n因此，麦克斯韦-安培定律的完整形式为：\n$$ \\nabla \\times \\mathbf{H} = \\mathbf{J}_{\\text{cond}} + \\frac{\\partial \\mathbf{D}}{\\partial t} $$\n对于线性、各向同性介质，其本构关系由传导电流的欧姆定律和标准的电介质关系给出：\n$$ \\mathbf{J}_{\\text{cond}} = \\sigma \\mathbf{E} $$\n$$ \\mathbf{D} = \\epsilon \\mathbf{E} $$\n此处，$\\sigma$ 是电导率，$\\epsilon$ 是介质的介电常数，$\\mathbf{E}$ 是电场。\n\n问题指定了角频率为 $\\omega$ 的正弦稳态。在这种情况下，使用相量分析很方便。任何时变场量 $A(t)$ 都可以表示为一个复相量 $\\tilde{A}$ 乘以 $e^{i\\omega t}$ 后的实部，即 $A(t) = \\text{Re}\\{\\tilde{A} e^{i\\omega t}\\}$。在相量域中，时间导数算子 $\\frac{\\partial}{\\partial t}$ 被替换为乘以 $i\\omega$。\n\n将此应用于我们的电流密度项：\n传导电流密度的相量 $\\tilde{\\mathbf{J}}_{\\text{cond}}$ 与电场相量 $\\tilde{\\mathbf{E}}$ 的关系为：\n$$ \\tilde{\\mathbf{J}}_{\\text{cond}} = \\sigma \\tilde{\\mathbf{E}} $$\n位移电流密度的相量 $\\tilde{\\mathbf{J}}_{\\text{disp}}$ 为：\n$$ \\tilde{\\mathbf{J}}_{\\text{disp}} = i\\omega \\tilde{\\mathbf{D}} = i\\omega \\epsilon \\tilde{\\mathbf{E}} $$\n我们需要求这两个电流密度的大小之比。一个物理正弦量的大小等于其复相量的大小。因此，我们需要计算比值 $\\frac{|\\tilde{\\mathbf{J}}_{\\text{disp}}|}{|\\tilde{\\mathbf{J}}_{\\text{cond}}|}$。\n\n传导电流密度相量的大小为：\n$$ |\\tilde{\\mathbf{J}}_{\\text{cond}}| = |\\sigma \\tilde{\\mathbf{E}}| = \\sigma |\\tilde{\\mathbf{E}}| $$\n因为 $\\sigma$ 是一个正实数标量。\n\n位移电流密度相量的大小为：\n$$ |\\tilde{\\mathbf{J}}_{\\text{disp}}| = |i\\omega \\epsilon \\tilde{\\mathbf{E}}| = |i||\\omega||\\epsilon||\\tilde{\\mathbf{E}}| = \\omega \\epsilon |\\tilde{\\mathbf{E}}| $$\n因为 $\\omega$ 和 $\\epsilon$ 是正实数标量，且 $|i|=1$。\n\n因此，大小的无量纲比值为：\n$$ \\frac{|\\tilde{\\mathbf{J}}_{\\text{disp}}|}{|\\tilde{\\mathbf{J}}_{\\text{cond}}|} = \\frac{\\omega \\epsilon |\\tilde{\\mathbf{E}}|}{\\sigma |\\tilde{\\mathbf{E}}|} = \\frac{\\omega \\epsilon}{\\sigma} $$\n此表达式给出了该比值的通用公式。\n\n现在，我们使用所提供的熔融铝数据来计算该比值：\n- 电导率：$\\sigma = 3.3 \\times 10^{6} \\ \\mathrm{S \\, m^{-1}}$。\n- 问题陈述要求使用真空介电常数作为材料的介电常数：$\\epsilon \\approx \\epsilon_{0} = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F \\, m^{-1}}$。\n- 交流电频率为 $f = 1.00 \\times 10^{5} \\ \\mathrm{Hz}$。角频率 $\\omega$ 计算如下：\n$$ \\omega = 2 \\pi f = 2 \\pi (1.00 \\times 10^{5} \\ \\mathrm{s^{-1}}) $$\n\n将这些值代入推导出的比值表达式中：\n$$ \\frac{\\omega \\epsilon}{\\sigma} = \\frac{(2 \\pi \\times 1.00 \\times 10^{5}) \\times (8.8541878128 \\times 10^{-12})}{3.3 \\times 10^{6}} $$\n我们来进行计算：\n$$ \\frac{\\omega \\epsilon}{\\sigma} = \\frac{2\\pi \\times 8.8541878128 \\times 10^{-7}}{3.3 \\times 10^{6}} $$\n$$ \\frac{\\omega \\epsilon}{\\sigma} = \\frac{5.56340191 \\times 10^{-6}}{3.3 \\times 10^{6}} $$\n$$ \\frac{\\omega \\epsilon}{\\sigma} \\approx 1.68587936 \\times 10^{-12} $$\n问题要求将最终答案四舍五入至四位有效数字。\n$$ 1.68587936 \\times 10^{-12} \\approx 1.686 \\times 10^{-12} $$\n这个极小的值表明，位移电流密度的大小比传导电流密度的大小小数个数量级。对于该系统的计算热工分析，这一结果严格证明了在麦克斯韦方程组中忽略位移电流项（$\\frac{\\partial \\mathbf{D}}{\\partial t}$）的合理性，而这正是磁准静态（MQS）近似的精髓所在。",
            "answer": "$$\\boxed{1.686 \\times 10^{-12}}$$"
        },
        {
            "introduction": "确立了MHD的适用范围后，下一步是分析控制方程中各项物理效应的相对重要性。通过无量纲化，我们可以将复杂的偏微分方程转化为由一系列无量纲数主导的代数关系，从而洞察流动的主要特征。本练习  要求你对包含洛伦兹力的Navier-Stokes方程和磁感应方程进行无量纲化，识别出哈特曼数（$Ha$）、相互作用参数（$N$）等关键参数。通过计算这些参数在具体工况下的数值，你将学会如何定量评估电磁力相对于粘性力和惯性力的主导地位，并预测磁场对流动的深刻影响，例如湍流抑制和速度剖面平坦化。",
            "id": "3969424",
            "problem": "一股导电、不可压缩的熔融铝流稳定地流过一个直矩形管道，其水力尺寸由单一几何长度尺度 $L$ 表征。一个大小为 $B_0$ 的均匀、稳定磁场被施加在横向于平均流动的方向上。假定熔融金属在物性评估中是等温的，且流动处于位移电流可忽略的低频区。其控制物理是磁流体动力学（MHD）：流体动量由包含洛伦兹力密度的不可压缩纳维-斯托克斯方程控制，磁场演化由具有有限电导率的磁感应方程控制。运动导体的欧姆定律闭合了电磁响应。\n\n从包含洛伦兹力密度的不可压缩纳维-斯托克斯方程和磁感应方程出发，使用速度尺度 $U$、长度尺度 $L$、施加的磁场尺度 $B_0$ 以及材料属性密度 $\\rho$、运动粘度 $\\nu$ 和电导率 $\\sigma$ 进行一致的无量纲化。识别出表征磁流体动力学洛伦兹力耦合和感应的无量纲数组：哈特曼数 $Ha$、相互作用参数（斯图尔特数）$N$、磁雷诺数 $Rm$ 和磁普朗特数 $Pm$。然后，使用下面提供的熔融铝属性和流动-磁场参数，计算 $Ha$、$N$、$Rm$ 和 $Pm$ 作为无量纲数，并根据它们的大小，简要预测与 $B_0=0$ 的情况相比，流动和动量输运的定性变化。\n\n在物性近似恒定的工作温度下，对熔融铝使用以下数值：\n- 密度：$\\rho = 2.375 \\times 10^{3}\\ \\mathrm{kg/m^3}$\n- 运动粘度：$\\nu = 6.0 \\times 10^{-7}\\ \\mathrm{m^2/s}$\n- 电导率：$\\sigma = 3.2 \\times 10^{6}\\ \\mathrm{S/m}$\n- 施加的磁场：$B_0 = 0.8\\ \\mathrm{T}$\n- 速度尺度：$U = 0.15\\ \\mathrm{m/s}$\n- 长度尺度：$L = 0.04\\ \\mathrm{m}$\n\n对于电磁常数，使用自由空间磁导率 $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$。\n\n将四个无量纲量中的每一个都四舍五入到三位有效数字。以 $\\big(Ha,\\ N,\\ Rm,\\ Pm\\big)$ 的顺序，将最终数值答案表示为单个 $1 \\times 4$ 的行矩阵。最终答案的矩阵内必须只包含数字，不含单位。定性预测应出现在您的演算过程中，而不是在最终的方框答案中。",
            "solution": "该问题具有科学依据，提法恰当且客观。它基于磁流体动力学（MHD）的基本原理，是计算热工领域一项标准的分析任务。无量纲化和数值评估所需的所有数据均已提供，不存在矛盾或歧义。因此，该问题被认为是有效的，并将提供完整的解答。\n\n在低频（MHD）近似下，存在磁场时不可压缩导电流体的控制方程是不可压缩纳维-斯托克斯方程和磁感应方程。对于稳定流（$ \\frac{\\partial}{\\partial t} = 0 $），这些方程是：\n\n1.  质量守恒（连续性方程）：\n    $$ \\nabla \\cdot \\mathbf{u} = 0 $$\n2.  动量守恒（纳维-斯托克斯方程）：\n    $$ \\rho (\\mathbf{u} \\cdot \\nabla)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\mathbf{J} \\times \\mathbf{B} $$\n3.  磁感应方程：\n    $$ \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) = \\frac{1}{\\mu_0 \\sigma} \\nabla \\times (\\nabla \\times \\mathbf{B}) $$\n\n此处，$\\mathbf{u}$ 是流体速度，$p$ 是压力，$\\rho$ 是密度，$\\mu = \\rho \\nu$ 是动力粘度（$\\nu$ 是运动粘度），$\\mathbf{J}$ 是电流密度，$\\mathbf{B}$ 是磁场，$\\sigma$ 是电导率，$\\mu_0$ 是自由空间磁导率。项 $\\mathbf{J} \\times \\mathbf{B}$ 是洛伦兹力密度。\n\n我们使用提供的特征尺度对这些方程进行无量纲化：速度尺度 $U$、长度尺度 $L$ 和施加的磁场尺度 $B_0$。我们将无量纲变量（用上标 $*$ 表示）定义为：\n$$ \\mathbf{u}^* = \\frac{\\mathbf{u}}{U}, \\quad \\mathbf{x}^* = \\frac{\\mathbf{x}}{L}, \\quad p^* = \\frac{p - p_0}{\\rho U^2}, \\quad \\mathbf{B}^* = \\frac{\\mathbf{B}}{B_0} $$\n梯度算子按 $\\nabla = \\frac{1}{L}\\nabla^*$ 进行缩放。\n\n将这些代入稳态纳维-斯托克斯方程：\n$$ \\rho \\left( (U \\mathbf{u}^*) \\cdot \\left(\\frac{1}{L}\\nabla^*\\right) \\right) (U \\mathbf{u}^*) = -\\left(\\frac{1}{L}\\nabla^*\\right) (\\rho U^2 p^*) + (\\rho \\nu) \\left(\\frac{1}{L^2}\\nabla^{*2}\\right) (U \\mathbf{u}^*) + \\mathbf{J} \\times (B_0 \\mathbf{B}^*) $$\n$$ \\frac{\\rho U^2}{L} (\\mathbf{u}^* \\cdot \\nabla^*) \\mathbf{u}^* = -\\frac{\\rho U^2}{L} \\nabla^* p^* + \\frac{\\rho \\nu U}{L^2} \\nabla^{*2} \\mathbf{u}^* + \\mathbf{J} \\times (B_0 \\mathbf{B}^*) $$\n电流密度 $\\mathbf{J}$ 由欧姆定律给出，$\\mathbf{J} = \\sigma(\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B})$。感应电场和对流项的特征尺度均为 $U B_0$ 的量级，因此电流密度的尺度为 $J \\sim \\sigma U B_0$。因此洛伦兹力的尺度为 $F_L \\sim (\\sigma U B_0) B_0 = \\sigma U B_0^2$。\n让我们将动量方程除以惯性项尺度 $\\frac{\\rho U^2}{L}$：\n$$ (\\mathbf{u}^* \\cdot \\nabla^*) \\mathbf{u}^* = -\\nabla^* p^* + \\frac{\\rho \\nu U / L^2}{\\rho U^2 / L} \\nabla^{*2} \\mathbf{u}^* + \\frac{\\sigma U B_0^2}{\\rho U^2 / L} (\\mathbf{j}^* \\times \\mathbf{B}^*) $$\n简化系数即可得到无量纲数组。粘性项的系数为：\n$$ \\frac{\\nu}{UL} = \\frac{1}{Re} $$\n其中 $Re = \\frac{UL}{\\nu}$ 是雷诺数。洛伦兹力项的系数是：\n$$ \\frac{\\sigma U B_0^2 L}{\\rho U^2} = \\frac{\\sigma B_0^2 L}{\\rho U} = N $$\n这个无量纲数组 $N$ 是**相互作用参数**（或斯图尔特数），表示洛伦兹力与惯性力之比。\n\n接下来，我们对稳态磁感应方程进行无量纲化：\n$$ \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) = \\frac{1}{\\mu_0 \\sigma} \\nabla \\times (\\nabla \\times \\mathbf{B}) $$\n$$ \\left(\\frac{1}{L}\\nabla^*\\right) \\times (U \\mathbf{u}^* \\times B_0 \\mathbf{B}^*) = \\frac{1}{\\mu_0 \\sigma} \\left(\\frac{1}{L}\\nabla^*\\right) \\times \\left( \\left(\\frac{1}{L}\\nabla^*\\right) \\times B_0 \\mathbf{B}^* \\right) $$\n$$ \\frac{U B_0}{L} \\nabla^* \\times (\\mathbf{u}^* \\times \\mathbf{B}^*) = \\frac{B_0}{\\mu_0 \\sigma L^2} \\nabla^* \\times (\\nabla^* \\times \\mathbf{B}^*) $$\n除以 $\\frac{U B_0}{L}$ 得：\n$$ \\nabla^* \\times (\\mathbf{u}^* \\times \\mathbf{B}^*) = \\frac{1}{\\mu_0 \\sigma U L} \\nabla^* \\times (\\nabla^* \\times \\mathbf{B}^*) $$\n右侧的系数是**磁雷诺数** $Rm$ 的倒数：\n$$ Rm = \\mu_0 \\sigma U L $$\n$Rm$ 代表磁场的平流与扩散之比。\n\n该问题还要求计算哈特曼数（$Ha$）和磁普朗特数（$Pm$）。\n**哈特曼数**的平方，$Ha^2$，是洛伦兹力与粘性力之比：\n$$ Ha^2 = \\frac{\\text{Lorentz force}}{\\text{Viscous force}} = \\frac{\\sigma U B_0^2}{\\rho \\nu U / L^2} = \\frac{\\sigma B_0^2 L^2}{\\rho \\nu} \\quad \\implies \\quad Ha = B_0 L \\sqrt{\\frac{\\sigma}{\\rho\\nu}} $$\n注意关系式 $N = \\frac{\\sigma B_0^2 L}{\\rho U} = \\left(\\frac{\\sigma B_0^2 L^2}{\\rho\\nu}\\right) \\left(\\frac{\\nu}{UL}\\right) = \\frac{Ha^2}{Re}$。\n\n**磁普朗特数**，$Pm$，是动量扩散率（运动粘度，$\\nu$）与磁扩散率（$\\eta = 1/(\\mu_0 \\sigma)$）之比：\n$$ Pm = \\frac{\\nu}{\\eta} = \\mu_0 \\sigma \\nu $$\n注意关系式 $Rm = (\\mu_0 \\sigma \\nu) \\frac{U L}{\\nu} = Pm \\cdot Re$。\n\n现在，我们使用所提供的值计算这四个无量纲数：\n- $\\rho = 2.375 \\times 10^{3}\\ \\mathrm{kg/m^3}$\n- $\\nu = 6.0 \\times 10^{-7}\\ \\mathrm{m^2/s}$\n- $\\sigma = 3.2 \\times 10^{6}\\ \\mathrm{S/m}$\n- $B_0 = 0.8\\ \\mathrm{T}$\n- $U = 0.15\\ \\mathrm{m/s}$\n- $L = 0.04\\ \\mathrm{m}$\n- $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$\n\n**哈特曼数 (Ha):**\n$$ Ha = B_0 L \\sqrt{\\frac{\\sigma}{\\rho \\nu}} = (0.8)(0.04) \\sqrt{\\frac{3.2 \\times 10^6}{(2.375 \\times 10^3)(6.0 \\times 10^{-7})}} $$\n$$ Ha = 0.032 \\sqrt{\\frac{3.2 \\times 10^6}{1.425 \\times 10^{-3}}} = 0.032 \\sqrt{2.2456 \\times 10^9} \\approx 0.032 \\times 47387.9 $$\n$$ Ha \\approx 1516.4 $$\n保留三位有效数字，$Ha \\approx 1.52 \\times 10^3$。\n\n**相互作用参数 (N):**\n$$ N = \\frac{\\sigma B_0^2 L}{\\rho U} = \\frac{(3.2 \\times 10^6)(0.8)^2(0.04)}{(2.375 \\times 10^3)(0.15)} $$\n$$ N = \\frac{(3.2 \\times 10^6)(0.64)(0.04)}{356.25} = \\frac{81920}{356.25} \\approx 229.95 $$\n保留三位有效数字，$N \\approx 2.30 \\times 10^2$。\n\n**磁雷诺数 (Rm):**\n$$ Rm = \\mu_0 \\sigma U L = (4\\pi \\times 10^{-7})(3.2 \\times 10^6)(0.15)(0.04) $$\n$$ Rm = (4\\pi \\times 10^{-7})(3.2 \\times 10^6)(0.006) = 0.024127... $$\n保留三位有效数字，$Rm \\approx 2.41 \\times 10^{-2}$。\n\n**磁普朗特数 (Pm):**\n$$ Pm = \\mu_0 \\sigma \\nu = (4\\pi \\times 10^{-7})(3.2 \\times 10^6)(6.0 \\times 10^{-7}) $$\n$$ Pm = 4\\pi \\times 3.2 \\times 6.0 \\times 10^{-7} = 2.4127... \\times 10^{-6} $$\n保留三位有效数字，$Pm \\approx 2.41 \\times 10^{-6}$。\n\n**流动变化的定性预测：**\n对于无磁场的情况（$B_0=0$），雷诺数为 $Re = UL/\\nu = (0.15)(0.04)/(6.0 \\times 10^{-7}) = 10000$。该值远高于管道流的典型转变阈值（约 $Re \\approx 2300$），表明基准流将是湍流。\n\n当施加磁场（$B_0=0.8\\ \\mathrm{T}$）时：\n1.  巨大的哈特曼数，$Ha \\approx 1520 \\gg 1$，表明与粘性力相比，电磁（洛伦兹）力占绝对主导地位。\n2.  巨大的相互作用参数，$N \\approx 230 \\gg 1$，表明洛伦兹力也远大于惯性力。\n3.  微小的磁雷诺数，$Rm \\approx 0.0241 \\ll 1$，表明由流体运动引起的感应磁场与施加的磁场 $B_0$ 相比非常弱。这就是“低磁雷诺数”区，我们可以将总磁场近似为仅施加的磁场，即 $\\mathbf{B} \\approx \\mathbf{B}_0$。这极大地简化了对洛伦兹力的分析。\n4.  极小的磁普朗特数，$Pm \\approx 2.41 \\times 10^{-6} \\ll 1$，是液态金属的特征，意味着动量扩散率（$\\nu$）远大于磁扩散率（$\\eta$）。\n\n基于这些量级，预测出以下定性变化：\n- **层流化：** 洛伦兹力（$N \\gg 1$）的主导作用将强烈抑制湍流涡和速度波动。尽管雷诺数很高，流动将被磁场“层流化”，变得稳定而有序。\n- **速度剖面扁平化：** 强大的洛伦兹制动力作用于整个流体核心。为了平衡压力梯度，流动会重新组织。粘性效应被限制在极薄的边界层内。在管道的中心区域，速度剖面将变得近乎平坦，这是高哈特曼数（high-$Ha$）MHD流的一个标志，通常称为“栓塞流”(slug flow)。\n- **哈特曼层的形成：** 从垂直于 $\\mathbf{B}_0$ 的壁面上的无滑移条件到平坦的核心速度的过渡，发生在称为哈特曼层的非常薄的边界层中。这些层的厚度尺度为 $L/Ha$，在本例中为 $\\delta_H \\approx 0.04/1520 \\approx 26\\ \\mu \\mathrm{m}$。这些层的特点是具有强烈的粘性剪切。\n- **压降增加：** 洛伦兹力起到了强大的制动作用。为保持相同的平均速度 $U$，必须施加一个显著更大的压力梯度来克服这种磁阻力，导致与 $B_0=0$ 的情况相比，整个管道的压降急剧增加。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.52 \\times 10^{3}  2.30 \\times 10^{2}  2.41 \\times 10^{-2}  2.41 \\times 10^{-6} \\end{pmatrix} } $$"
        },
        {
            "introduction": "从解析理论转向计算实践，数值MHD模拟面临的一个核心挑战是严格维持磁场的无散性约束（$\\nabla \\cdot \\mathbf{B} = 0$）。违反此约束会产生非物理性的“磁单极子”，导致数值解的崩溃。这项编码实践  引导你构建一个基于磁矢量势（magnetic vector potential）的约束输运（constrained transport）方法基准测试。你将编写一个简单的平流输运程序，并通过数值实验证明，这种“旋度”形式定义的磁场能够将散度误差控制在机器精度范围内，这是构建稳定且精确的MHD求解器的基础。",
            "id": "3969454",
            "problem": "考虑一个周期性方形域中的二维理想磁流体动力学（MHD），其中磁场由磁矢量势的旋度表示。目标是使用基于磁矢量势的约束输运（CT）更新方法构建一个数值基准测试，用于平流一个局域磁环，并验证数值重构的磁场在机器精度上保持无散度。\n\n从以下基本定律和核心定义出发：\n- 微分形式的 Maxwell–Faraday 定律：$\\displaystyle \\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}$。\n- 理想欧姆定律：$\\displaystyle \\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}$。\n- 磁矢量势的定义：$\\displaystyle \\mathbf{B} = \\nabla \\times \\mathbf{A}$。\n- 为磁矢量势选择 Weyl 规范，该规范将标量势置为零：$\\displaystyle \\phi = 0$。\n\n在这些条件下，磁矢量势的演化满足 $\\displaystyle \\frac{\\partial \\mathbf{A}}{\\partial t} = \\mathbf{v} \\times \\mathbf{B}$，确保 $\\displaystyle \\mathbf{B}$ 作为 $\\displaystyle \\mathbf{A}$ 的离散旋度的数值表示不会产生磁单极子。在二维情况下，当 $\\displaystyle \\mathbf{A} = (0,0,A_z)$ 时，演化方程简化为关于 $\\displaystyle A_z$ 的纯平流方程：\n$$\n\\frac{\\partial A_z}{\\partial t} + \\mathbf{v}\\cdot\\nabla A_z = 0,\n$$\n并且平面内的磁场分量重构如下：\n$$\nB_x = \\frac{\\partial A_z}{\\partial y}, \\quad B_y = -\\frac{\\partial A_z}{\\partial x}, \\quad B_z = 0.\n$$\n磁场的离散散度使用定义离散旋度的相同中心差分算子来定义，\n$$\n(\\nabla\\cdot\\mathbf{B})_{\\text{disc}} \\equiv D_x B_x + D_y B_y,\n$$\n并且当 $\\displaystyle \\mathbf{B}$ 作为 $\\displaystyle \\mathbf{A}$ 的离散旋度得到时，必须验证其在构造上数值为零（即在浮点舍入误差范围内）。\n\n以无量纲单位实现以下基准测试：\n- 域：$\\displaystyle [0,L_x)\\times[0,L_y)$，具有周期性边界条件，其中 $\\displaystyle L_x = L_y = L$。\n- 网格：一个均匀、单元中心的 $\\displaystyle N_x \\times N_y$ 网格，间距为 $\\displaystyle \\Delta x = L_x/N_x$，$\\displaystyle \\Delta y = L_y/N_y$。\n- 初始条件：一个编码在 $\\displaystyle A_z(\\mathbf{x},0)$ 中的环形磁环，\n$$\nA_z(x,y,0) = A_0 \\exp\\!\\left(-\\frac{\\left(r(x,y) - r_0\\right)^2}{w^2}\\right),\n$$\n其中 $\\displaystyle r(x,y) = \\sqrt{(x-x_c)^2+(y-y_c)^2}$，中心为 $\\displaystyle (x_c,y_c)=(L_x/2,L_y/2)$，振幅 $\\displaystyle A_0 = 1$，环半径 $\\displaystyle r_0$，环半宽 $\\displaystyle w$。\n- 速度：空间均匀且不随时间变化，$\\displaystyle \\mathbf{v}=(v_x,v_y)$。\n- 演化：使用稳定的一阶迎风格式对 $\\displaystyle A_z$ 进行时间推进，该格式在周期性边界条件下求解 $\\displaystyle \\partial_t A_z + v_x \\partial_x A_z + v_y \\partial_y A_z = 0$。使用 Courant–Friedrichs–Lewy (CFL) 数 $\\displaystyle C=0.5$ 来选择时间步长 $\\displaystyle \\Delta t$，以保证稳定性。演化到指定的最终时间 $\\displaystyle T$。\n\n到达 $\\displaystyle t=T$ 后，使用中心差分从 $\\displaystyle A_z$ 重构磁场 $\\displaystyle \\mathbf{B}$：\n$$\nB_x = D_y A_z = \\frac{A_z(x,y+\\Delta y) - A_z(x,y-\\Delta y)}{2\\Delta y}, \\quad\nB_y = -D_x A_z = -\\frac{A_z(x+\\Delta x,y) - A_z(x-\\Delta x,y)}{2\\Delta x}.\n$$\n使用相同的中心差分计算 $\\displaystyle \\mathbf{B}$ 的离散散度：\n$$\n(\\nabla\\cdot\\mathbf{B})_{\\text{disc}} = D_x B_x + D_y B_y.\n$$\n您的程序必须为每个测试用例报告单个标量值\n$$\n\\max_{i,j} \\left|(\\nabla\\cdot\\mathbf{B})_{\\text{disc}}\\right|,\n$$\n即在 $\\displaystyle t=T$ 时所有网格单元上的最大绝对离散散度。所有量都是无量纲的，不需要物理单位。\n\n为以下四个测试用例实现基准测试，这些用例旨在检验该格式的不同方面：\n- 案例 $\\displaystyle 1$ (理想路径)：$\\displaystyle N_x=N_y=128$，$\\displaystyle L=1$，$\\displaystyle v_x=0.5$，$\\displaystyle v_y=-0.3$，$\\displaystyle T=2.0$，$\\displaystyle r_0=0.25L$，$\\displaystyle w=0.05L$。\n- 案例 $\\displaystyle 2$ (零速度边界情况)：$\\displaystyle N_x=N_y=64$，$\\displaystyle L=1$，$\\displaystyle v_x=0.0$，$\\displaystyle v_y=0.0$，$\\displaystyle T=1.0$，$\\displaystyle r_0=0.3L$，$\\displaystyle w=0.07L$。\n- 案例 $\\displaystyle 3$ (粗网格，x方向强平流)：$\\displaystyle N_x=N_y=16$，$\\displaystyle L=1$，$\\displaystyle v_x=1.0$，$\\displaystyle v_y=0.0$, $\\displaystyle T=1.0$，$\\displaystyle r_0=0.2L$，$\\displaystyle w=0.04L$。\n- 案例 $\\displaystyle 4$ (各向异性平流，不同分辨率)：$\\displaystyle N_x=96$，$\\displaystyle N_y=128$，$\\displaystyle L=1$，$\\displaystyle v_x=-0.25$，$\\displaystyle v_y=0.75$，$\\displaystyle T=1.5$，$\\displaystyle r_0=0.35L$，$\\displaystyle w=0.03L$。\n\n您的程序应产生单行输出，包含这四个结果，形式为方括号括起来的逗号分隔列表，顺序与上述案例一致（例如，$\\displaystyle [r_1,r_2,r_3,r_4]$）。每个 $\\displaystyle r_k$ 必须是按规定计算的浮点数。不允许有其他输出。\n\n这个基准测试是运动学的：您不需要求解动量或能量方程；Lorentz力耦合项 $\\displaystyle \\mathbf{J}\\times\\mathbf{B}$ （其中电流密度 $\\displaystyle \\mathbf{J}=(1/\\mu_0)\\nabla\\times\\mathbf{B}$，磁导率为 $\\displaystyle \\mu_0$）不施加到速度上。然而，重构的 $\\displaystyle \\mathbf{B}$ 的无散度性质对于常规MHD模拟中科学上真实的耦合至关重要。",
            "solution": "问题陈述经过了仔细验证，并被确定为有效。其科学基础是理想磁流体动力学（MHD）的原理，具有一套完整且一致的定义和约束，是一个适定的问题，并提出了一个非平凡的、可验证的计算基准测试。\n\n基本任务是验证计算MHD中约束输运（CT）格式的一个基石性质：在离散层面上保持磁场的无散度条件 $\\nabla \\cdot \\mathbf{B} = 0$。该问题设置在二维空间，并将完整的MHD系统简化为一个运动学问题，其中标量磁矢量势 $A_z$ 被一个给定的速度场 $\\mathbf{v}$ 平流。\n\n推导始于 Maxwell-Faraday 定律和理想欧姆定律：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}, \\quad \\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}\n$$\n引入磁矢量势 $\\mathbf{A}$ 使得 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$，并选择 Weyl 规范（标量势为零，$\\phi=0$），$\\mathbf{A}$ 的演化由以下方程控制：\n$$\n\\frac{\\partial \\mathbf{A}}{\\partial t} = \\mathbf{v} \\times \\mathbf{B} = \\mathbf{v} \\times (\\nabla \\times \\mathbf{A})\n$$\n对于一个二维系统，其中速度在平面内，$\\mathbf{v} = (v_x, v_y, 0)$，矢量势在平面外，$\\mathbf{A} = (0, 0, A_z)$，平面内磁场为 $\\mathbf{B} = (\\partial_y A_z, -\\partial_x A_z, 0)$。$\\mathbf{A}$ 的演化方程简化为 $A_z$ 的标量平流方程：\n$$\n\\frac{\\partial A_z}{\\partial t} + v_x \\frac{\\partial A_z}{\\partial x} + v_y \\frac{\\partial A_z}{\\partial y} = 0 \\quad \\implies \\quad \\frac{\\partial A_z}{\\partial t} + \\mathbf{v}\\cdot\\nabla A_z = 0\n$$\n问题的核心在于数值离散化。约束输运方法依赖于定义离散的旋度和散度操作，从而使解析恒等式 $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) \\equiv 0$ 被精确地保持。问题为此目的指定了二阶中心差分算子。设 $D_x$ 和 $D_y$ 代表这些离散算子。离散磁场分量由 $A_z$ 计算如下：\n$$\nB_x = D_y A_z, \\quad B_y = -D_x A_z\n$$\n该场的离散散度然后使用相同的算子计算：\n$$\n(\\nabla\\cdot\\mathbf{B})_{\\text{disc}} = D_x B_x + D_y B_y = D_x(D_y A_z) + D_y(-D_x A_z) = D_x D_y A_z - D_y D_x Az\n$$\n对于均匀网格上指定的中心差分模板，离散算子 $D_x$ 和 $D_y$ 是可交换的，即对于任何离散场 $f$，都有 $D_x D_y f = D_y D_x f$。因此，离散散度 $(\\nabla\\cdot\\mathbf{B})_{\\text{disc}}$ 在代数上保证为零。数值实现产生的结果仅由于浮点舍入误差而非零，其量级应在机器ε的量级。通过平流格式对 $A_z$ 进行时间演化仅仅是为了在最终时刻 $T$ 产生一个非平凡的场；无散度性质是重构算子的一个特性，而不是时间步进格式的特性。\n\n数值实现按以下步骤进行：\n$1$. **网格与初始化**：对于每个测试用例，在域 $[0, L) \\times [0, L)$ 上定义一个大小为 $N_x \\times N_y$ 的均匀、单元中心网格，其中 $L=1$。网格间距为 $\\Delta x = L/N_x$ 和 $\\Delta y = L/N_y$。标量场 $A_z$ 在单元中心 $(x_i, y_j) = ((i+0.5)\\Delta x, (j+0.5)\\Delta y)$ 使用给定的高斯环形剖面进行初始化：$A_z(x,y,0) = A_0 \\exp(-((r(x,y) - r_0)^2 / w^2))$，其中 $A_0=1$。\n\n$2$. **时间演化**：从 $t=0$ 到 $t=T$ 对 $A_z$ 的平流方程进行数值求解。使用一阶显式迎风格式，这对于纯平流问题是合适且稳健的。网格单元 $(i,j)$ 的更新为：\n$$\nA_z^{n+1}_{i,j} = A_z^n_{i,j} - \\Delta t (v_x (\\partial_x A_z)^n_{i,j} + v_y (\\partial_y A_z)^n_{i,j})\n$$\n其中空间导数用一阶迎风差分近似。例如，如果 $v_x > 0$，则 $x$-导数项为 $v_x(A_z^n_{i,j} - A_z^n_{i-1,j})/\\Delta x$；如果 $v_x  0$，则为 $v_x(A_z^n_{i+1,j} - A_z^n_{i,j})/\\Delta x$。时间步长 $\\Delta t$ 基于 Courant-Friedrichs-Lewy (CFL) 数 $C=0.5$ 来选择以确保稳定性：$\\Delta t = C / (|v_x|/\\Delta x + |v_y|/\\Delta y)$。对于 $v_x=v_y=0$ 的特殊情况，$A_z$ 是静止的，不进行时间演化。周期性边界条件通过对网格数据的循环移位来强制执行，这可以很方便地使用 `numpy.roll` 实现。\n\n$3$. **验证**：将 $A_z$ 演化到最终时间 $T$ 后，使用二阶中心差分重构磁场分量 $B_x$ 和 $B_y$：\n$$\nB_x(i,j) = \\frac{A_z(i,j+1) - A_z(i,j-1)}{2\\Delta y}, \\quad B_y(i,j) = -\\frac{A_z(i+1,j) - A_z(i-1,j)}{2\\Delta x}\n$$\n（注意索引到空间坐标的映射）。然后再次用中心差分计算散度 $(\\nabla \\cdot \\mathbf{B})_{\\text{disc}}$：\n$$\n(\\nabla \\cdot \\mathbf{B})_{\\text{disc}}(i,j) = \\frac{B_x(i+1,j) - B_x(i-1,j)}{2\\Delta x} + \\frac{B_y(i,j+1) - B_y(i,j-1)}{2\\Delta y}\n$$\n每个案例最终报告的值是该散度场在所有网格单元上的最大绝对值 $\\max |(\\nabla \\cdot \\mathbf{B})_{\\text{disc}}|$。\n\n提供的 Python 代码为四个指定的测试用例实现了这个过程。它利用 `numpy` 进行高效的基于数组的计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 2D MHD benchmark problem for four test cases.\n    It advects a magnetic vector potential A_z and verifies that the\n    reconstructed magnetic field B remains divergence-free to machine precision.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (Nx, Ny, L, vx, vy, T, r0_factor, w_factor)\n    test_cases = [\n        (128, 128, 1.0, 0.5, -0.3, 2.0, 0.25, 0.05),   # Case 1\n        (64, 64, 1.0, 0.0, 0.0, 1.0, 0.3, 0.07),       # Case 2\n        (16, 16, 1.0, 1.0, 0.0, 1.0, 0.2, 0.04),       # Case 3\n        (96, 128, 1.0, -0.25, 0.75, 1.5, 0.35, 0.03)  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters\n        Nx, Ny, L, vx, vy, T, r0_factor, w_factor = case\n        Lx, Ly = L, L\n        r0 = r0_factor * L\n        w = w_factor * L\n        A0 = 1.0\n        CFL = 0.5\n\n        # Setup grid (cell-centered)\n        dx = Lx / Nx\n        dy = Ly / Ny\n        x_coords = (np.arange(Nx) + 0.5) * dx\n        y_coords = (np.arange(Ny) + 0.5) * dy\n        xx, yy = np.meshgrid(x_coords, y_coords, indexing='ij')\n\n        # Initial condition for A_z\n        xc = Lx / 2.0\n        yc = Ly / 2.0\n        r = np.sqrt((xx - xc)**2 + (yy - yc)**2)\n        Az = A0 * np.exp(-((r - r0)**2) / w**2)\n\n        # Time evolution using first-order upwind scheme\n        # Handle zero-velocity case\n        if vx == 0.0 and vy == 0.0:\n            pass  # Az remains unchanged\n        else:\n            # Calculate stable time step dt\n            dt_max_inv = np.abs(vx) / dx + np.abs(vy) / dy\n            dt_max = CFL / dt_max_inv\n            # Find number of steps and exact dt to reach T\n            num_steps = int(np.ceil(T / dt_max))\n            dt = T / num_steps\n\n            for _ in range(num_steps):\n                Az_n = Az.copy()\n\n                # x-advection (upwind)\n                # Note: axis=0 for x-direction (columns) for 'ij' indexing\n                if vx > 0:\n                    dAz_dx = (Az_n - np.roll(Az_n, 1, axis=0)) / dx\n                elif vx  0:\n                    dAz_dx = (np.roll(Az_n, -1, axis=0) - Az_n) / dx\n                else: # vx == 0\n                    dAz_dx = np.zeros_like(Az_n)\n\n                # y-advection (upwind)\n                # Note: axis=1 for y-direction (rows) for 'ij' indexing\n                if vy > 0:\n                    dAz_dy = (Az_n - np.roll(Az_n, 1, axis=1)) / dy\n                elif vy  0:\n                    dAz_dy = (np.roll(Az_n, -1, axis=1) - Az_n) / dy\n                else: # vy == 0\n                    dAz_dy = np.zeros_like(Az_n)\n\n                Az = Az_n - dt * (vx * dAz_dx + vy * dAz_dy)\n        \n        # At t=T, reconstruct B field using centered differences\n        # Transpose back if necessary, but operations are on 'ij' grid\n        # Bx = d(Az)/dy\n        Az_up = np.roll(Az, -1, axis=1)\n        Az_down = np.roll(Az, 1, axis=1)\n        Bx = (Az_up - Az_down) / (2.0 * dy)\n\n        # By = -d(Az)/dx\n        Az_right = np.roll(Az, -1, axis=0)\n        Az_left = np.roll(Az, 1, axis=0)\n        By = -(Az_right - Az_left) / (2.0 * dx)\n\n        # Compute discrete divergence of B using centered differences\n        # Dx_Bx = d(Bx)/dx\n        Bx_right = np.roll(Bx, -1, axis=0)\n        Bx_left = np.roll(Bx, 1, axis=0)\n        Dx_Bx = (Bx_right - Bx_left) / (2.0 * dx)\n\n        # Dy_By = d(By)/dy\n        By_up = np.roll(By, -1, axis=1)\n        By_down = np.roll(By, 1, axis=1)\n        Dy_By = (By_up - By_down) / (2.0 * dy)\n        \n        divB = Dx_Bx + Dy_By\n        \n        # Calculate the maximum absolute divergence over the grid\n        max_abs_divB = np.max(np.abs(divB))\n        results.append(max_abs_divB)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}