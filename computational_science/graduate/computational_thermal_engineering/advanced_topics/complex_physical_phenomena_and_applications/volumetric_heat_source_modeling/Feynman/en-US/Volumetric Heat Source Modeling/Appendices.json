{
    "hands_on_practices": [
        {
            "introduction": "Mastering volumetric heat source modeling begins with a solid foundation in analytical solutions. This exercise  challenges you to derive the temperature profile within a solid from first principles, considering a heat source that varies spatially. By solving the governing differential equation and applying boundary conditions, you will sharpen your fundamental problem-solving skills and develop an intuition for how non-uniform heating influences temperature distribution, a crucial step before tackling more complex numerical simulations.",
            "id": "4004475",
            "problem": "A plane slab of thickness $L$ and constant thermal conductivity $k$ experiences steady one-dimensional heat conduction along the $x$-direction, with the coordinate $x$ measured from the left face at $x=0$ to the right face at $x=L$. The volumetric heat source varies linearly as $q'''(x)=q_{0}\\left(1+\\alpha \\frac{x}{L}\\right)$, where $q_{0}>0$ and $\\alpha>0$ are constants. Both faces are maintained at the same prescribed temperature $T_{s}$, so that $T(0)=T_{s}$ and $T(L)=T_{s}$. Starting from the fundamental conservation of energy for a differential control volume and Fourier’s law of heat conduction, derive the governing equation, solve for the temperature field $T(x)$, and justify whether the maximum temperature occurs within the interior or at a boundary. Then, determine the closed-form analytic expression for the location $x_{\\max}$ of the maximum temperature (measured from $x=0$). Express the final location in meters. No rounding is required.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of heat transfer, well-posed with sufficient and consistent conditions, and stated objectively. We may proceed with the solution.\n\nThe first step is to derive the governing differential equation for the temperature distribution $T(x)$. We apply the principle of conservation of energy to a differential control volume of thickness $dx$ and cross-sectional area $A$ normal to the direction of heat flow. For steady-state one-dimensional heat conduction, the energy balance is:\n$$ \\dot{E}_{in} - \\dot{E}_{out} + \\dot{E}_{gen} = \\dot{E}_{st} = 0 $$\nwhere $\\dot{E}_{in}$ is the rate of heat entering the control volume at position $x$, $\\dot{E}_{out}$ is the rate of heat leaving at $x+dx$, and $\\dot{E}_{gen}$ is the rate of heat generation within the volume. The storage term $\\dot{E}_{st}$ is zero for steady-state conditions.\n\nThe terms are given by:\n$$ \\dot{E}_{in} = q_x $$\n$$ \\dot{E}_{out} = q_{x+dx} $$\n$$ \\dot{E}_{gen} = q'''(x) \\cdot (A \\cdot dx) $$\nwhere $q_x$ is the heat flux and $q'''(x)$ is the volumetric heat generation rate. The energy balance becomes:\n$$ q_x - q_{x+dx} + q'''(x) A dx = 0 $$\nUsing a Taylor series expansion for $q_{x+dx}$ and retaining the first-order term, we have $q_{x+dx} \\approx q_x + \\frac{dq_x}{dx}dx$. Substituting this into the balance equation gives:\n$$ q_x - \\left(q_x + \\frac{dq_x}{dx}dx\\right) + q'''(x) A dx = 0 $$\n$$ -\\frac{dq_x}{dx}dx + q'''(x) A dx = 0 $$\nDividing by $A \\cdot dx$ (since $A>0$ and $dx>0$):\n$$ -\\frac{1}{A}\\frac{dq_x}{dx} + q'''(x) = 0 $$\nWe now introduce Fourier's law of heat conduction, $q_x = -kA \\frac{dT}{dx}$, where $k$ is the thermal conductivity. Substituting this into the energy equation:\n$$ -\\frac{1}{A}\\frac{d}{dx}\\left(-kA\\frac{dT}{dx}\\right) + q'''(x) = 0 $$\nSince the thermal conductivity $k$ and the cross-sectional area $A$ are constant, we can simplify this to:\n$$ k \\frac{d^2T}{dx^2} + q'''(x) = 0 $$\nSubstituting the given expression for the volumetric heat source, $q'''(x)=q_{0}\\left(1+\\alpha \\frac{x}{L}\\right)$, the governing equation for the temperature field $T(x)$ is:\n$$ \\frac{d^2T}{dx^2} = -\\frac{q'''(x)}{k} = -\\frac{q_0}{k}\\left(1+\\alpha \\frac{x}{L}\\right) $$\nTo find the temperature distribution $T(x)$, we integrate this second-order ordinary differential equation twice. The first integration with respect to $x$ yields the temperature gradient:\n$$ \\frac{dT}{dx} = \\int -\\frac{q_0}{k}\\left(1+\\alpha \\frac{x}{L}\\right) dx = -\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + C_1 $$\nwhere $C_1$ is the first integration constant. A second integration yields the temperature field:\n$$ T(x) = \\int \\left[-\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + C_1\\right] dx = -\\frac{q_0}{k}\\left(\\frac{x^2}{2} + \\frac{\\alpha x^3}{6L}\\right) + C_1 x + C_2 $$\nwhere $C_2$ is the second integration constant. We determine $C_1$ and $C_2$ by applying the prescribed boundary conditions: $T(0)=T_s$ and $T(L)=T_s$.\n\nApplying the first boundary condition, $T(0)=T_s$:\n$$ T(0) = -\\frac{q_0}{k}\\left(0+0\\right) + C_1(0) + C_2 = T_s \\implies C_2 = T_s $$\nApplying the second boundary condition, $T(L)=T_s$:\n$$ T(L) = -\\frac{q_0}{k}\\left(\\frac{L^2}{2} + \\frac{\\alpha L^3}{6L}\\right) + C_1 L + T_s = T_s $$\n$$ -\\frac{q_0}{k}\\left(\\frac{L^2}{2} + \\frac{\\alpha L^2}{6}\\right) + C_1 L = 0 $$\nSolving for $C_1$:\n$$ C_1 L = \\frac{q_0 L^2}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) \\implies C_1 = \\frac{q_0 L}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) $$\nSubstituting the constants $C_1$ and $C_2$ back into the expression for $T(x)$, we obtain the complete solution for the temperature field:\n$$ T(x) = T_s + \\frac{q_0 L}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right)x - \\frac{q_0}{k}\\left(\\frac{x^2}{2} + \\frac{\\alpha x^3}{6L}\\right) $$\nThis expression can be rearranged to highlight the dimensionless position $\\xi = x/L$:\n$$ T(x) - T_s = \\frac{q_0 L^2}{k} \\left[ \\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right)\\left(\\frac{x}{L}\\right) - \\frac{1}{2}\\left(\\frac{x}{L}\\right)^2 - \\frac{\\alpha}{6}\\left(\\frac{x}{L}\\right)^3 \\right] $$\n\nNext, we justify the location of the maximum temperature. The heat generation term $q'''(x) = q_0(1+\\alpha \\frac{x}{L})$ is strictly positive for all $x \\in [0, L]$ because $q_0 > 0$ and $\\alpha > 0$. This continuous internal heat generation requires heat to be conducted out of the slab towards the boundaries, which are held at the constant temperature $T_s$. For heat to flow out, the temperature inside the slab must be higher than at the boundaries. Therefore, the maximum temperature must occur in the interior of the slab, i.e., for some $x_{\\max} \\in (0, L)$, and not at the boundaries $x=0$ or $x=L$.\n\nAt the point of maximum temperature, $x_{\\max}$, the temperature gradient must be zero: $\\left.\\frac{dT}{dx}\\right|_{x=x_{\\max}} = 0$. Using our expression for the temperature gradient:\n$$ \\frac{dT}{dx} = -\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + C_1 = -\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + \\frac{q_0 L}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) $$\nSetting $\\frac{dT}{dx}=0$ at $x=x_{\\max}$ and dividing by the non-zero term $-\\frac{q_0}{k}$:\n$$ \\left(x_{\\max} + \\frac{\\alpha x_{\\max}^2}{2L}\\right) - L\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) = 0 $$\nRearranging gives a quadratic equation for $x_{\\max}$:\n$$ \\frac{\\alpha}{2L}x_{\\max}^2 + x_{\\max} - \\left(\\frac{L}{2} + \\frac{\\alpha L}{6}\\right) = 0 $$\nTo clear the denominators, we multiply by $6L$:\n$$ 3\\alpha x_{\\max}^2 + 6L x_{\\max} - (3L^2 + \\alpha L^2) = 0 $$\n$$ 3\\alpha x_{\\max}^2 + 6L x_{\\max} - L^2(3+\\alpha) = 0 $$\nWe solve this quadratic equation using the quadratic formula, $x_{\\max} = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$, with $a=3\\alpha$, $b=6L$, and $c=-L^2(3+\\alpha)$.\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{(6L)^2 - 4(3\\alpha)(-L^2(3+\\alpha))}}{2(3\\alpha)} $$\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{36L^2 + 12\\alpha L^2(3+\\alpha)}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{36L^2 + 36\\alpha L^2 + 12\\alpha^2 L^2}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{12L^2(3 + 3\\alpha + \\alpha^2)}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-6L \\pm 2L\\sqrt{3(3 + 3\\alpha + \\alpha^2)}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-3L \\pm L\\sqrt{9 + 9\\alpha + 3\\alpha^2}}{3\\alpha} $$\nSince $x_{\\max}$ must represent a physical position within the slab, we require $x_{\\max} > 0$. As $\\alpha>0$, the denominator $3\\alpha$ is positive. The term under the square root, $9 + 9\\alpha + 3\\alpha^2$, is greater than $9$, so its square root is greater than $3$. Thus, the numerator of the \"plus\" root, $-3L + L\\sqrt{9 + 9\\alpha + 3\\alpha^2}$, is positive. The \"minus\" root would be negative and is therefore unphysical. We select the physically valid positive root:\n$$ x_{\\max} = \\frac{-3L + L\\sqrt{9 + 9\\alpha + 3\\alpha^2}}{3\\alpha} $$\nFactoring out $L$ gives the final expression for the location of maximum temperature:\n$$ x_{\\max} = L \\left( \\frac{\\sqrt{9 + 9\\alpha + 3\\alpha^2} - 3}{3\\alpha} \\right) $$\nThe second derivative, $\\frac{d^2T}{dx^2} = -\\frac{q_0}{k}(1+\\alpha \\frac{x}{L})$, is always negative for $x \\in [0,L]$, confirming that this critical point is indeed a maximum.",
            "answer": "$$ \\boxed{L \\left( \\frac{\\sqrt{9 + 9\\alpha + 3\\alpha^2} - 3}{3\\alpha} \\right)} $$"
        },
        {
            "introduction": "While analytical solutions provide deep insight, most engineering problems require numerical methods. This practice  transitions from continuous physics to the discrete world of the Finite Volume Method (FVM). You will analyze how a continuous, spatially-varying source term is represented on a computational grid, forcing a careful consideration of the core principles of numerical accuracy and discrete conservation. This conceptual exercise is vital for understanding how to build numerical models that are not only accurate but also physically consistent.",
            "id": "4004528",
            "problem": "Consider steady conduction with spatially varying volumetric heating in a one-dimensional ($1\\text{D}$) slab of thickness $L$, constant cross-sectional area $A$, and constant thermal conductivity $k$. Let the temperature field be $T(x)$, and the volumetric heat generation be $q'''(x) = q_0 \\sin\\!\\left(\\dfrac{\\pi x}{L}\\right)$, where $q_0$ is a positive constant. The governing balance of thermal energy, derived from conservation of energy applied to a fixed control volume and Fourier’s law of conduction, in integral form over any control volume $V_i$ bounded by faces at $x_{i-1/2}$ and $x_{i+1/2}$ is\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx}\\left(k A \\frac{dT}{dx}\\right)\\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x)\\,A\\,dx = 0,\n$$\nwhich, under standard finite volume assembly, becomes a discrete balance of face heat fluxes and the integrated volumetric source,\n$$\n-kA\\left.\\frac{dT}{dx}\\right|_{x_{i+1/2}} + kA\\left.\\frac{dT}{dx}\\right|_{x_{i-1/2}} + Q_i = 0, \\quad \\text{with} \\quad Q_i = \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x)\\,A\\,dx.\n$$\nAssume a uniform mesh with $N$ control volumes of width $\\Delta x = L/N$ and cell centers at $x_i = \\left(i - \\dfrac{1}{2}\\right)\\Delta x$. In practice, $Q_i$ must be approximated numerically if $q'''(x)$ is known only at certain points; a common choice on uniform grids is the midpoint rule $Q_i \\approx q'''(x_i)\\,A\\,\\Delta x$.\n\nStarting from the integral conservation law and definitions above, analyze the discrete conservation and accuracy implications of how $Q_i$ is formed. Select all statements that are correct.\n\nA. The exact integrated source over cell $i$ for $q'''(x) = q_0 \\sin\\!\\left(\\dfrac{\\pi x}{L}\\right)$ and constant $A$ is\n$$\nQ_i = q_0\\,A\\,\\frac{L}{\\pi}\\left[\\cos\\!\\left(\\frac{\\pi x_{i-1/2}}{L}\\right) - \\cos\\!\\left(\\frac{\\pi x_{i+1/2}}{L}\\right)\\right].\n$$\n\nB. If each interior face flux is computed once per face and stored with equal magnitude and opposite sign in the two adjacent cells (pairwise antisymmetry), then summing the discrete balances over all control volumes yields that the net boundary heat flux equals $\\sum_i Q_i$, irrespective of the quadrature order used to compute $Q_i$.\n\nC. Approximating $Q_i$ by $q'''(x_i)\\,V_i$ on a uniform grid, with $V_i = A\\,\\Delta x$, yields an $\\mathcal{O}(\\Delta x)$ local truncation error for the source term when $q'''(x)$ is smooth, and thus only first-order global accuracy for the integrated source.\n\nD. Even if $Q_i$ is evaluated exactly, the computed temperature field can remain first-order accurate if the conduction operator is discretized by a first-order approximation of the face gradients, because the leading truncation error is dominated by the flux discretization.\n\nE. On highly skewed, non-orthogonal meshes, exact analytical integration of $q'''(x)$ within each cell is necessary to ensure discrete conservation; otherwise the scheme cannot be conservative.",
            "solution": "The user has requested an analysis of a problem in computational heat transfer.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Physical System**: Steady-state conduction in a one-dimensional ($1\\text{D}$) slab.\n*   **Geometry**: Thickness $L$, constant cross-sectional area $A$.\n*   **Material Properties**: Constant thermal conductivity $k$.\n*   **Unknown Field**: Temperature $T(x)$.\n*   **Volumetric Heat Source**: $q'''(x) = q_0 \\sin\\!\\left(\\dfrac{\\pi x}{L}\\right)$, with $q_0$ being a positive constant.\n*   **Governing Equation (Integral Form for a control volume $V_i$ from $x_{i-1/2}$ to $x_{i+1/2}$)**:\n    $$\n    \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx}\\left(k A \\frac{dT}{dx}\\right)\\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x)\\,A\\,dx = 0\n    $$\n*   **Discrete Balance Equation**:\n    $$\n    -kA\\left.\\frac{dT}{dx}\\right|_{x_{i+1/2}} + kA\\left.\\frac{dT}{dx}\\right|_{x_{i-1/2}} + Q_i = 0\n    $$\n*   **Definition of Integrated Source**:\n    $$\n    Q_i = \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x)\\,A\\,dx\n    $$\n*   **Numerical Mesh**: Uniform grid with $N$ control volumes, each of width $\\Delta x = L/N$.\n*   **Cell Centers**: $x_i = \\left(i - \\dfrac{1}{2}\\right)\\Delta x$.\n*   **Source Term Approximation**: Midpoint rule is mentioned as a common choice, $Q_i \\approx q'''(x_i)\\,A\\,\\Delta x$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem statement is scientifically sound, well-posed, and objective.\n1.  **Scientific Grounding**: The problem describes the standard finite volume discretization of the steady-state heat conduction equation with a source term. The governing equations and definitions are fundamental to the field of computational heat transfer and numerical methods for partial differential equations.\n2.  **Well-Posedness**: The problem is well-posed. It asks for an analysis of the properties (conservation and accuracy) of a numerical scheme, which are well-defined mathematical concepts. The provided information is sufficient to perform this analysis.\n3.  **Objectivity**: The language is technical, precise, and free of subjective or ambiguous terms.\n4.  **Completeness and Consistency**: The problem is self-contained. It provides the continuous and discrete forms of the governing equation, the specific functional form of the source term, and the mesh definition, which are all the necessary components to evaluate the propositions. There are no contradictions.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. The solution will now proceed by analyzing each option.\n\n### Solution and Option Analysis\n\n**A. The exact integrated source over cell $i$ for $q'''(x) = q_0 \\sin\\!\\left(\\dfrac{\\pi x}{L}\\right)$ and constant $A$ is $Q_i = q_0\\,A\\,\\frac{L}{\\pi}\\left[\\cos\\!\\left(\\frac{\\pi x_{i-1/2}}{L}\\right) - \\cos\\!\\left(\\frac{\\pi x_{i+1/2}}{L}\\right)\\right]$.**\n\nTo verify this statement, we must compute the exact integral of the source term over the $i$-th control volume.\nThe integrated source term is defined as:\n$$\nQ_i = \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x)\\,A\\,dx\n$$\nSubstituting the given function for $q'''(x)$:\n$$\nQ_i = \\int_{x_{i-1/2}}^{x_{i+1/2}} q_0 \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\,A\\,dx\n$$\nSince $q_0$ and $A$ are constants, they can be factored out of the integral:\n$$\nQ_i = q_0 A \\int_{x_{i-1/2}}^{x_{i+1/2}} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\,dx\n$$\nThe antiderivative of $\\sin(ax)$ is $-\\frac{1}{a}\\cos(ax)$. In this case, the constant $a$ is $\\frac{\\pi}{L}$.\n$$\n\\int \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\,dx = -\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right)\n$$\nEvaluating the definite integral:\n$$\nQ_i = q_0 A \\left[ -\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right) \\right]_{x_{i-1/2}}^{x_{i+1/2}}\n$$\n$$\nQ_i = q_0 A \\left( -\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x_{i+1/2}}{L}\\right) - \\left(-\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x_{i-1/2}}{L}\\right)\\right) \\right)\n$$\n$$\nQ_i = q_0 A \\frac{L}{\\pi} \\left( \\cos\\!\\left(\\frac{\\pi x_{i-1/2}}{L}\\right) - \\cos\\!\\left(\\frac{\\pi x_{i+1/2}}{L}\\right) \\right)\n$$\nThis expression perfectly matches the one given in option A.\n\nVerdict: **Correct**.\n\n**B. If each interior face flux is computed once per face and stored with equal magnitude and opposite sign in the two adjacent cells (pairwise antisymmetry), then summing the discrete balances over all control volumes yields that the net boundary heat flux equals $\\sum_i Q_i$, irrespective of the quadrature order used to compute $Q_i$.**\n\nThis statement addresses the property of discrete global conservation in a finite volume method. The discrete balance for a generic cell $i$ is:\n$$\n-kA\\left.\\frac{dT}{dx}\\right|_{x_{i+1/2}} + kA\\left.\\frac{dT}{dx}\\right|_{x_{i-1/2}} + Q_i = 0\n$$\nLet us define the heat rate (flux) entering cell $i$ through its left face as $q_{i-1/2} = -kA\\left.\\frac{dT}{dx}\\right|_{x_{i-1/2}}$ and the heat rate leaving cell $i$ through its right face as $q_{i+1/2} = -kA\\left.\\frac{dT}{dx}\\right|_{x_{i+1/2}}$. The sign convention means positive flux is in the positive $x$-direction. The balance for cell $i$ is thus $q_{i-1/2} - q_{i+1/2} + Q_i = 0$.\n\nThe property of \"pairwise antisymmetry\" means that the flux leaving cell $i$ at face $x_{i+1/2}$ is exactly the negative of the flux leaving cell $i+1$ at that same face. This is the core of the finite volume method's local conservation property.\nLet's sum the discrete balances for all cells $i=1, \\dots, N$:\n$$\n\\sum_{i=1}^{N} \\left(q_{i-1/2} - q_{i+1/2} + Q_i\\right) = 0\n$$\n$$\n\\sum_{i=1}^{N} \\left(q_{i-1/2} - q_{i+1/2}\\right) + \\sum_{i=1}^{N} Q_i = 0\n$$\nThe first term is a telescoping sum:\n$$\n(q_{1/2} - q_{3/2}) + (q_{3/2} - q_{5/2}) + \\dots + (q_{N-1/2} - q_{N+1/2})\n$$\nAll interior fluxes (e.g., $q_{3/2}$, $q_{5/2}$, etc.) cancel out, leaving only the fluxes at the domain boundaries: face $1/2$ (at $x=0$) and face $N+1/2$ (at $x=L$).\nThe sum becomes:\n$$\nq_{1/2} - q_{N+1/2} + \\sum_{i=1}^{N} Q_i = 0\n$$\nRearranging gives:\n$$\nq_{N+1/2} - q_{1/2} = \\sum_{i=1}^{N} Q_i\n$$\nThe term $q_{N+1/2} - q_{1/2}$ represents the net heat rate leaving the domain through its boundaries. This equation states that the net heat leaving the domain boundaries is equal to the total heat generated within the domain. This is the statement of discrete global conservation. The derivation relies only on the telescoping nature of the sum, which is a direct consequence of the conservative formulation of the fluxes. It is entirely independent of how the cell source terms $Q_i$ are calculated.\n\nVerdict: **Correct**.\n\n**C. Approximating $Q_i$ by $q'''(x_i)\\,V_i$ on a uniform grid, with $V_i = A\\,\\Delta x$, yields an $\\mathcal{O}(\\Delta x)$ local truncation error for the source term when $q'''(x)$ is smooth, and thus only first-order global accuracy for the integrated source.**\n\nThis statement concerns the accuracy of the midpoint rule for integration. The exact integrated source is $Q_i = A \\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} q'''(x) dx$. The approximation is $Q_i^{\\text{approx}} = A \\, q'''(x_i) \\Delta x$.\nThe error is the difference $Q_i - Q_i^{\\text{approx}}$. To determine the order of this error, we use a Taylor series expansion of $q'''(x)$ around the midpoint $x_i$:\n$$\nq'''(x) = q'''(x_i) + (x-x_i)q'''' (x_i) + \\frac{(x-x_i)^2}{2!} q'''''(x_i) + \\mathcal{O}((x-x_i)^3)\n$$\nIntegrating this series over the cell, from $x_i - \\Delta x/2$ to $x_i + \\Delta x/2$:\n$$\n\\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} q'''(x) dx = \\left[ q'''(x_i)x + \\frac{(x-x_i)^2}{2}q'''' (x_i) + \\frac{(x-x_i)^3}{6}q'''''(x_i) + \\dots \\right]_{x_i-\\Delta x/2}^{x_i+\\Delta x/2}\n$$\nEvaluating the terms:\n*   The first term gives $q'''(x_i) \\Delta x$.\n*   The second term, involving an odd power of $(x-x_i)$, evaluates to $0$ over the symmetric interval.\n*   The third term gives $\\frac{q'''''(x_i)}{6} \\left[ \\left(\\frac{\\Delta x}{2}\\right)^3 - \\left(-\\frac{\\Delta x}{2}\\right)^3 \\right] = \\frac{q'''''(x_i)}{6} \\left[ 2 \\frac{(\\Delta x)^3}{8} \\right] = \\frac{q'''''(x_i)}{24}(\\Delta x)^3$.\n\nSo, $\\int q'''(x) dx = q'''(x_i) \\Delta x + \\frac{q'''''(x_i)}{24}(\\Delta x)^3 + \\mathcal{O}((\\Delta x)^5)$.\nThe error in the integrated source term is $Q_i - Q_i^{\\text{approx}} = A \\left( \\frac{q'''''(x_i)}{24}(\\Delta x)^3 + \\dots \\right)$, which is of order $\\mathcal{O}((\\Delta x)^3)$.\n\nThe statement claims the local truncation error is $\\mathcal{O}(\\Delta x)$. This is incorrect. The midpoint rule for integration is second-order accurate for the average value, meaning the local truncation error for the integrated quantity is $\\mathcal{O}((\\Delta x)^3)$. When the full discrete equation is divided by the volume $A \\Delta x$, the source term contributes an error of $\\mathcal{O}((\\Delta x)^2)$ to the local truncation error of the PDE approximation, leading to a second-order accurate scheme, not first-order.\n\nVerdict: **Incorrect**.\n\n**D. Even if $Q_i$ is evaluated exactly, the computed temperature field can remain first-order accurate if the conduction operator is discretized by a first-order approximation of the face gradients, because the leading truncation error is dominated by the flux discretization.**\n\nThis statement concerns the overall accuracy of a numerical scheme. The total local truncation error (LTE) of a discrete equation is the sum of the truncation errors from each of its components (e.g., flux terms, source terms).\nThe LTE for the full scheme is:\n$$\n\\text{LTE} = \\text{LTE}_{\\text{flux}} + \\text{LTE}_{\\text{source}}\n$$\nThe problem posits a scenario where:\n1.  The source term $Q_i$ is evaluated \"exactly\". This implies that the discrete source term is equal to the exact integral, so $\\text{LTE}_{\\text{source}} = 0$.\n2.  The conduction operator (face fluxes) is approximated with a first-order method. This means $\\text{LTE}_{\\text{flux}} = \\mathcal{O}(\\Delta x)$. An example would be using a one-sided difference for the gradient at the cell face.\n\nThe total local truncation error is therefore $\\text{LTE} = \\mathcal{O}(\\Delta x) + 0 = \\mathcal{O}(\\Delta x)$.\nFor a stable and consistent numerical method, the order of the global error (the error in the final computed solution, e.g., $T(x)$) is the same as the order of the local truncation error. Therefore, a scheme with an LTE of $\\mathcal{O}(\\Delta x)$ will be globally first-order accurate. The overall accuracy is limited by the least accurate part of the discretization. Improving one part of the scheme to a very high order (or exactness) cannot compensate for a low-order approximation in another part.\n\nVerdict: **Correct**.\n\n**E. On highly skewed, non-orthogonal meshes, exact analytical integration of $q'''(x)$ within each cell is necessary to ensure discrete conservation; otherwise the scheme cannot be conservative.**\n\nThis statement confuses the concepts of accuracy and conservation. As established in the analysis of option B, a finite volume scheme is discretely conservative if the flux calculated at a face common to two cells is accounted for with equal magnitude and opposite sign in the balance equations of those two cells. This ensures that what leaves one cell is precisely what enters the neighboring cell. This property, which leads to the telescoping sum and global conservation, is a feature of how the surface integrals (fluxes) are formulated and assembled. Mesh skewness and non-orthogonality introduce challenges and errors in approximating the fluxes themselves, but the conservative assembly procedure remains the same.\n\nThe evaluation of the volume integral of the source term, $Q_i = \\int_{V_i} q'''(x) dV$, is a separate issue that affects the accuracy of the local balance, but not its conservative nature. A scheme is conservative even if $Q_i$ is approximated inaccurately (e.g., with a low-order quadrature rule). Using an inaccurate approximation for $Q_i$ means that the discrete balance in cell $i$ does not perfectly represent the physical energy balance for that cell, which introduces a larger truncation error and reduces the accuracy of the final solution. However, the scheme still conserves the discretized quantities globally. Therefore, exact integration of the source is not a prerequisite for the scheme to be conservative.\n\nVerdict: **Incorrect**.",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "The final step is to translate theory into a functional computational tool. This hands-on coding practice  requires you to implement a robust routine for calculating cell-averaged heat sources on a nonuniform mesh. By using direct analytical integration for complex source functions, you will build a program that upholds the conservation laws discussed previously and quantitatively demonstrate the significant errors that can arise from naive approximations. This exercise encapsulates the practical challenges and best practices at the heart of computational thermal engineering.",
            "id": "4004508",
            "problem": "You are modeling a one-dimensional steady heat conduction problem with a spatially varying volumetric heat source in a nonuniform mesh. The physical quantity of interest is the volumetric heat generation rate per unit volume, denoted by $q'''(x)$ with units $\\mathrm{W\\,m^{-3}}$. The computational task is to implement a robust computation of the cell-averaged source on a nonuniform mesh for given analytic source functions, demonstrate a conservation check, and quantify the difference between naive point-sampling and proper finite-volume cell averaging. All angles in trigonometric functions must be treated in radians. When integrating over the domain of length $L$, the total heat generation per unit area is $\\int_0^L q'''(x)\\,\\mathrm{d}x$ and must be reported in $\\mathrm{W\\,m^{-2}}$.\n\nStart from the integral form of energy conservation for steady heat conduction in one spatial dimension and the requirement that the discretization remain conservative under the Finite Volume Method (FVM). Your program must use these principles to compute cell-averaged sources on a nonuniform mesh. The mesh is defined by control-volume faces at positions $x_{j+1/2}$ for $j=0,1,\\dots,N$, with $x_{1/2}=0$ and $x_{N+1/2}=L$, where the nonuniformity is introduced by a stretching exponent $\\alpha>0$ via the mapping $x_{j+1/2} = L\\left(\\frac{j}{N}\\right)^\\alpha$. The cell width is $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ for cell index $i=1,2,\\dots,N$.\n\nYour program must, for each test case:\n- Construct the nonuniform mesh from the given $L$, $N$, and $\\alpha$.\n- Implement $q'''(x)$ as specified for that case.\n- Compute the cell-averaged source in every control volume using the integral form implied by FVM, without relying on point sampling.\n- Compute the total integrated heat generation per unit area, $Q=\\int_0^L q'''(x)\\,\\mathrm{d}x$, by summing the cell-integrated sources and express $Q$ in $\\mathrm{W\\,m^{-2}}$.\n- Quantify the deviation between naive center-point sampling and the cell-averaged representation using the relative $L^2$-norm with control-volume weighting. Specifically, compute\n$$\n\\varepsilon = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(\\bar{q}_i - q'''(x_i)\\right)^2 \\,\\Delta x_i}{\\sum_{i=1}^{N} \\bar{q}_i^2 \\,\\Delta x_i}},\n$$\nwhere $\\bar{q}_i$ is the cell-averaged source in cell $i$ and $x_i = \\tfrac{1}{2}\\left(x_{i-1/2}+x_{i+1/2}\\right)$ is the cell center.\n\nTest Suite. Implement the following four scientifically consistent test cases. All angles are in radians, and all quantities of $q'''(x)$ are in $\\mathrm{W\\,m^{-3}}$.\n\n- Case $1$ (smooth oscillation with a localized Gaussian bump, moderate nonuniformity):\n    - Domain length: $L=1\\,\\mathrm{m}$, number of cells: $N=40$, stretch exponent: $\\alpha=1.7$.\n    - Source:\n      $$\n      q'''(x) = a_0 + a_1 x + A\\sin(\\omega x + \\phi) + G\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right).\n      $$\n      Parameters: $a_0=1.0\\times 10^5$, $a_1=5.0\\times 10^4\\,\\mathrm{W\\,m^{-4}}$, $A=1.5\\times 10^5$, $\\omega=24\\pi\\,\\mathrm{rad\\,m^{-1}}$, $\\phi=0$, $G=3.0\\times 10^5$, $x_0=0.6\\,\\mathrm{m}$, $\\sigma=0.07\\,\\mathrm{m}$.\n\n- Case $2$ (high-frequency oscillation prone to aliasing on a relatively coarse, mildly stretched mesh):\n    - Domain length: $L=1\\,\\mathrm{m}$, number of cells: $N=24$, stretch exponent: $\\alpha=0.8$.\n    - Source:\n      $$\n      q'''(x) = a_0 + a_1 x + A\\sin(\\omega x + \\phi) + G\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right).\n      $$\n      Parameters: $a_0=8.0\\times 10^4$, $a_1=2.0\\times 10^4\\,\\mathrm{W\\,m^{-4}}$, $A=2.0\\times 10^5$, $\\omega=120\\pi\\,\\mathrm{rad\\,m^{-1}}$, $\\phi=0.3$, $G=1.0\\times 10^5$, $x_0=0.2\\,\\mathrm{m}$, $\\sigma=0.03\\,\\mathrm{m}$.\n\n- Case $3$ (discontinuous step plus oscillation, requiring special handling of the discontinuity to avoid spurious oscillations):\n    - Domain length: $L=1\\,\\mathrm{m}$, number of cells: $N=32$, stretch exponent: $\\alpha=1.2$.\n    - Source:\n      $$\n      q'''(x) = a_0 + a_1 x + A\\sin(\\omega x + \\phi) + H\\,\\mathsf{H}(x-x_d),\n      $$\n      where $\\mathsf{H}(\\cdot)$ is the Heaviside step function. Parameters: $a_0=6.0\\times 10^4$, $a_1=3.0\\times 10^4\\,\\mathrm{W\\,m^{-4}}$, $A=1.0\\times 10^5$, $\\omega=36\\pi\\,\\mathrm{rad\\,m^{-1}}$, $\\phi=-0.2$, $H=4.0\\times 10^5$, $x_d=0.5\\,\\mathrm{m}$.\n\n- Case $4$ (sharp exponential decay near one boundary plus mild oscillation and a Gaussian, strongly stretched mesh):\n    - Domain length: $L=2\\,\\mathrm{m}$, number of cells: $N=64$, stretch exponent: $\\alpha=2.5$.\n    - Source:\n      $$\n      q'''(x) = a_0 + A\\sin(\\omega x + \\phi) + E\\exp\\!\\left(-\\frac{x}{\\lambda}\\right) + G\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right),\n      $$\n      Parameters: $a_0=5.0\\times 10^4$, $A=0.8\\times 10^5$, $\\omega=30\\pi\\,\\mathrm{rad\\,m^{-1}}$, $\\phi=0$, $E=9.0\\times 10^5$, $\\lambda=0.12\\,\\mathrm{m}$, $G=2.0\\times 10^5$, $x_0=1.2\\,\\mathrm{m}$, $\\sigma=0.08\\,\\mathrm{m}$.\n\nFinal Output Specification. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case in the order $1,2,3,4$, output two values: first the total integrated heat generation $Q$ in $\\mathrm{W\\,m^{-2}}$, and second the relative deviation $\\varepsilon$ as a decimal. The final output line must therefore contain $8$ numbers in the order\n$[Q_1,\\varepsilon_1,Q_2,\\varepsilon_2,Q_3,\\varepsilon_3,Q_4,\\varepsilon_4]$.",
            "solution": "The problem requires the implementation of a finite volume method (FVM) for computing cell-averaged volumetric heat sources on a one-dimensional nonuniform mesh. This task is central to computational heat transfer, as it ensures that the total heat generated within the discrete domain is conserved, regardless of the mesh structure. The problem is well-posed, scientifically grounded, and provides all necessary information for a complete computational solution.\n\n### Principle: Finite Volume Source Term Discretization\n\nThe fundamental principle underlying the Finite Volume Method is the enforcement of conservation laws on a discrete set of control volumes (CVs) that partition the computational domain. For steady-state one-dimensional heat conduction, the integral form of the energy balance over a single control volume $CV_i$, spanning from face $x_{i-1/2}$ to $x_{i+1/2}$, is given by:\n$$\n\\left(q_x A\\right)_{i+1/2} - \\left(q_x A\\right)_{i-1/2} + \\int_{CV_i} q'''(x) \\, dV = 0\n$$\nwhere $q_x$ is the heat flux in the $x$-direction [$\\mathrm{W\\,m^{-2}}$], $A$ is the cross-sectional area [$\\mathrm{m^2}$], and $q'''(x)$ is the volumetric heat generation rate [$\\mathrm{W\\,m^{-3}}$]. Assuming a constant cross-sectional area $A$ and a volume element $dV = A \\, dx$, the equation simplifies to:\n$$\nA \\left( (q_x)_{i+1/2} - (q_x)_{i-1/2} \\right) + A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = 0\n$$\nDividing by the cell volume $V_i = A \\Delta x_i$, where $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ is the cell width, we obtain the discretized equation:\n$$\n\\frac{(q_x)_{i+1/2} - (q_x)_{i-1/2}}{\\Delta x_i} + \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = 0\n$$\nThe second term represents the contribution of the heat source. In FVM, the source term is represented by its cell-averaged value, $\\bar{q}_i$, defined as:\n$$\n\\bar{q}_i = \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx\n$$\nThis integral formulation is crucial. A naive approach might sample the source at the cell center, $q'''(x_i)$, and assume $\\bar{q}_i \\approx q'''(x_i)$. However, for nonlinear source functions or highly nonuniform meshes, this approximation can lead to significant errors and violate conservation. The problem requires a direct computation of this integral for each cell.\n\n### Algorithmic Design and Implementation\n\nThe solution involves three main stages: mesh generation, analytical integration of the source function, and computation of the required metrics ($Q$ and $\\varepsilon$).\n\n#### 1. Mesh Generation\n\nThe nonuniform mesh is defined by the locations of the cell faces, $x_{j+1/2}$, for $j=0, 1, \\dots, N$. The mapping is given by:\n$$\nx_{j+1/2} = L \\left(\\frac{j}{N}\\right)^\\alpha\n$$\nThis creates a grid that is stretched according to the exponent $\\alpha$. If $\\alpha > 1$, cells are finer near $x=0$ and coarser near $x=L$. If $\\alpha < 1$, the opposite occurs. If $\\alpha=1$, the mesh is uniform. For each cell $i$ (where $i=1, \\dots, N$), the cell width is $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ and the cell center is $x_i = \\frac{1}{2}(x_{i-1/2} + x_{i+1/2})$.\n\n#### 2. Source Term Integration\n\nTo compute $\\bar{q}_i$, we need the analytical antiderivative of the source function $q'''(x)$. Let $F(x) = \\int q'''(x) \\, dx$. The integral over cell $i$ is then given by the fundamental theorem of calculus:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = F(x_{i+1/2}) - F(x_{i-1/2})\n$$\nThe source functions in the problem are compositions of basic functions. We find their antiderivatives term-by-term:\n-   **Polynomial**: $\\int (a_0 + a_1 x) \\,dx = a_0 x + \\frac{1}{2}a_1 x^2 + C$\n-   **Sinusoidal**: $\\int A\\sin(\\omega x + \\phi) \\,dx = -\\frac{A}{\\omega}\\cos(\\omega x + \\phi) + C$\n-   **Gaussian**: $\\int G\\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right) \\,dx = G\\sigma\\sqrt{\\frac{\\pi}{2}}\\,\\mathrm{erf}\\left(\\frac{x-x_0}{\\sqrt{2}\\sigma}\\right) + C$, where $\\mathrm{erf}(\\cdot)$ is the error function, available in `scipy.special`.\n-   **Exponential Decay**: $\\int E\\exp\\left(-\\frac{x}{\\lambda}\\right) \\,dx = -E\\lambda\\exp\\left(-\\frac{x}{\\lambda}\\right) + C$\n-   **Heaviside Step**: For $a < b$, the integral $\\int_a^b H\\,\\mathsf{H}(x-x_d)\\,dx$ is handled piecewise. It evaluates to $H \\cdot \\max(0, b - \\max(a, x_d))$, which correctly captures the three cases: the interval is before, after, or straddles the discontinuity at $x_d$.\n\nThe implementation will consist of modular functions for the integral of each component, which are then combined as needed for each test case.\n\n#### 3. Computation of Metrics\n\n-   **Total Heat Generation ($Q$)**: The total heat generated per unit area over the domain $[0, L]$ is $Q = \\int_0^L q'''(x) \\, dx$. A key property of the FVM is conservation, meaning the sum of the integrated sources over all control volumes must equal the total integral over the domain:\n    $$\n    Q = \\sum_{i=1}^N \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = \\sum_{i=1}^N \\bar{q}_i \\Delta x_i\n    $$\n    The program will compute $Q$ using this summation.\n\n-   **Relative Deviation ($\\varepsilon$)**: To quantify the error introduced by the naive point-sampling approximation, we compute the volume-weighted relative $L^2$-norm of the difference between the cell-averaged source $\\bar{q}_i$ and the point-sampled source $q'''(x_i)$:\n    $$\n    \\varepsilon = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(\\bar{q}_i - q'''(x_i)\\right)^2 \\,\\Delta x_i}{\\sum_{i=1}^{N} \\bar{q}_i^2 \\,\\Delta x_i}}\n    $$\n    This requires evaluating $q'''(x)$ at each cell center $x_i$ and then applying the formula. A non-zero $\\varepsilon$ highlights the importance of proper source term integration, especially for coarse or stretched meshes and highly variable source functions.\n\nThe final program will systematically process each test case according to these principles, calculating $Q$ and $\\varepsilon$ and formatting the output as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\n# --- Integral and Function Definitions ---\n\n# Polynomial term: q(x) = a0 + a1*x\ndef poly_func(x, a0, a1):\n    return a0 + a1 * x\n\ndef poly_integral(xa, xb, a0, a1):\n    F_b = a0 * xb + 0.5 * a1 * xb**2\n    F_a = a0 * xa + 0.5 * a1 * xa**2\n    return F_b - F_a\n\n# Sinusoidal term: q(x) = A*sin(omega*x + phi)\ndef sin_func(x, A, omega, phi):\n    return A * np.sin(omega * x + phi)\n\ndef sin_integral(xa, xb, A, omega, phi):\n    if omega == 0:\n        return A * np.sin(phi) * (xb - xa)\n    F_b = -A / omega * np.cos(omega * xb + phi)\n    F_a = -A / omega * np.cos(omega * xa + phi)\n    return F_b - F_a\n\n# Gaussian term: q(x) = G*exp(-(x-x0)^2 / (2*sigma^2))\ndef gauss_func(x, G, x0, sigma):\n    return G * np.exp(-((x - x0)**2) / (2 * sigma**2))\n\ndef gauss_integral(xa, xb, G, x0, sigma):\n    const = G * sigma * np.sqrt(np.pi / 2.0)\n    F_b = const * erf((xb - x0) / (np.sqrt(2) * sigma))\n    F_a = const * erf((xa - x0) / (np.sqrt(2) * sigma))\n    return F_b - F_a\n\n# Heaviside step term: q(x) = H*H(x - xd)\ndef heaviside_func(x, H, xd):\n    return H * np.heaviside(x - xd, 1)\n\ndef heaviside_integral(xa, xb, H, xd):\n    # This vectorized implementation handles all cases\n    # integral is H * max(0, xb - max(xa, xd))\n    return H * np.maximum(0, xb - np.maximum(xa, xd))\n\n# Exponential decay term: q(x) = E*exp(-x/lambda)\ndef exp_decay_func(x, E, lam):\n    return E * np.exp(-x / lam)\n\ndef exp_decay_integral(xa, xb, E, lam):\n    if lam == 0:\n        return 0\n    F_b = -E * lam * np.exp(-xb / lam)\n    F_a = -E * lam * np.exp(-xa / lam)\n    return F_b - F_a\n\n# --- Case Processing Function ---\n\ndef process_case(case_params):\n    \"\"\"\n    Processes a single test case to compute Q and epsilon.\n    \"\"\"\n    L = case_params['L']\n    N = case_params['N']\n    alpha = case_params['alpha']\n    p = case_params['params']\n    q_type = case_params['q_type']\n\n    # 1. Generate Mesh\n    j = np.arange(N + 1)\n    x_faces = L * (j / N)**alpha\n    delta_x = np.diff(x_faces)\n    x_centers = 0.5 * (x_faces[:-1] + x_faces[1:])\n\n    # 2. Define source and integral functions for the case\n    if q_type == 'case1' or q_type == 'case2':\n        q_func = lambda x: (poly_func(x, p['a0'], p['a1']) +\n                           sin_func(x, p['A'], p['omega'], p['phi']) +\n                           gauss_func(x, p['G'], p['x0'], p['sigma']))\n        integral_func = lambda xa, xb: (poly_integral(xa, xb, p['a0'], p['a1']) +\n                                       sin_integral(xa, xb, p['A'], p['omega'], p['phi']) +\n                                       gauss_integral(xa, xb, p['G'], p['x0'], p['sigma']))\n    elif q_type == 'case3':\n        q_func = lambda x: (poly_func(x, p['a0'], p['a1']) +\n                           sin_func(x, p['A'], p['omega'], p['phi']) +\n                           heaviside_func(x, p['H'], p['xd']))\n        integral_func = lambda xa, xb: (poly_integral(xa, xb, p['a0'], p['a1']) +\n                                       sin_integral(xa, xb, p['A'], p['omega'], p['phi']) +\n                                       heaviside_integral(xa, xb, p['H'], p['xd']))\n    elif q_type == 'case4':\n        q_func = lambda x: (p['a0'] +\n                           sin_func(x, p['A'], p['omega'], p['phi']) +\n                           exp_decay_func(x, p['E'], p['lambda']) +\n                           gauss_func(x, p['G'], p['x0'], p['sigma']))\n        integral_func = lambda xa, xb: (p['a0'] * (xb - xa) +\n                                       sin_integral(xa, xb, p['A'], p['omega'], p['phi']) +\n                                       exp_decay_integral(xa, xb, p['E'], p['lambda']) +\n                                       gauss_integral(xa, xb, p['G'], p['x0'], p['sigma']))\n\n    # 3. Compute cell-averaged sources\n    cell_integrals = integral_func(x_faces[:-1], x_faces[1:])\n    q_bar = cell_integrals / delta_x\n    \n    # 4. Compute total heat generation Q\n    Q = np.sum(cell_integrals)\n\n    # 5. Compute deviation epsilon\n    q_point = q_func(x_centers)\n    \n    numerator = np.sum((q_bar - q_point)**2 * delta_x)\n    denominator = np.sum(q_bar**2 * delta_x)\n    \n    epsilon = np.sqrt(numerator / denominator) if denominator != 0 else 0.0\n\n    return Q, epsilon\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        { # Case 1\n            'L': 1.0, 'N': 40, 'alpha': 1.7, 'q_type': 'case1',\n            'params': {\n                'a0': 1.0e5, 'a1': 5.0e4, 'A': 1.5e5, 'omega': 24 * np.pi,\n                'phi': 0.0, 'G': 3.0e5, 'x0': 0.6, 'sigma': 0.07,\n            }\n        },\n        { # Case 2\n            'L': 1.0, 'N': 24, 'alpha': 0.8, 'q_type': 'case2',\n            'params': {\n                'a0': 8.0e4, 'a1': 2.0e4, 'A': 2.0e5, 'omega': 120 * np.pi,\n                'phi': 0.3, 'G': 1.0e5, 'x0': 0.2, 'sigma': 0.03,\n            }\n        },\n        { # Case 3\n            'L': 1.0, 'N': 32, 'alpha': 1.2, 'q_type': 'case3',\n            'params': {\n                'a0': 6.0e4, 'a1': 3.0e4, 'A': 1.0e5, 'omega': 36 * np.pi,\n                'phi': -0.2, 'H': 4.0e5, 'xd': 0.5,\n            }\n        },\n        { # Case 4\n            'L': 2.0, 'N': 64, 'alpha': 2.5, 'q_type': 'case4',\n            'params': {\n                'a0': 5.0e4, 'A': 0.8e5, 'omega': 30 * np.pi, 'phi': 0.0,\n                'E': 9.0e5, 'lambda': 0.12, 'G': 2.0e5, 'x0': 1.2, 'sigma': 0.08,\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Q, epsilon = process_case(case)\n        results.extend([Q, epsilon])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}