{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a foundational analysis of how a spatially varying heat source affects temperature distribution. By deriving the complete temperature profile for a linear heat source from first principles , you will develop a direct intuition for how the distribution of heat generation within a body dictates its internal temperature field and determines the location of the maximum temperature. This practice is essential for moving beyond idealized uniform sources to more realistic models.",
            "id": "4004475",
            "problem": "A plane slab of thickness $L$ and constant thermal conductivity $k$ experiences steady one-dimensional heat conduction along the $x$-direction, with the coordinate $x$ measured from the left face at $x=0$ to the right face at $x=L$. The volumetric heat source varies linearly as $q'''(x)=q_{0}\\left(1+\\alpha \\frac{x}{L}\\right)$, where $q_{0}>0$ and $\\alpha>0$ are constants. Both faces are maintained at the same prescribed temperature $T_{s}$, so that $T(0)=T_{s}$ and $T(L)=T_{s}$. Starting from the fundamental conservation of energy for a differential control volume and Fourier’s law of heat conduction, derive the governing equation, solve for the temperature field $T(x)$, and justify whether the maximum temperature occurs within the interior or at a boundary. Then, determine the closed-form analytic expression for the location $x_{\\max}$ of the maximum temperature (measured from $x=0$). Express the final location in meters. No rounding is required.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of heat transfer, well-posed with sufficient and consistent conditions, and stated objectively. We may proceed with the solution.\n\nThe first step is to derive the governing differential equation for the temperature distribution $T(x)$. We apply the principle of conservation of energy to a differential control volume of thickness $dx$ and cross-sectional area $A$ normal to the direction of heat flow. For steady-state one-dimensional heat conduction, the energy balance is:\n$$ \\dot{E}_{in} - \\dot{E}_{out} + \\dot{E}_{gen} = \\dot{E}_{st} = 0 $$\nwhere $\\dot{E}_{in}$ is the rate of heat entering the control volume at position $x$, $\\dot{E}_{out}$ is the rate of heat leaving at $x+dx$, and $\\dot{E}_{gen}$ is the rate of heat generation within the volume. The storage term $\\dot{E}_{st}$ is zero for steady-state conditions.\n\nThe terms are given by:\n$$ \\dot{E}_{in} = q_x $$\n$$ \\dot{E}_{out} = q_{x+dx} $$\n$$ \\dot{E}_{gen} = q'''(x) \\cdot (A \\cdot dx) $$\nwhere $q_x$ is the heat flux and $q'''(x)$ is the volumetric heat generation rate. The energy balance becomes:\n$$ q_x - q_{x+dx} + q'''(x) A dx = 0 $$\nUsing a Taylor series expansion for $q_{x+dx}$ and retaining the first-order term, we have $q_{x+dx} \\approx q_x + \\frac{dq_x}{dx}dx$. Substituting this into the balance equation gives:\n$$ q_x - \\left(q_x + \\frac{dq_x}{dx}dx\\right) + q'''(x) A dx = 0 $$\n$$ -\\frac{dq_x}{dx}dx + q'''(x) A dx = 0 $$\nDividing by $A \\cdot dx$ (since $A>0$ and $dx>0$):\n$$ -\\frac{1}{A}\\frac{dq_x}{dx} + q'''(x) = 0 $$\nWe now introduce Fourier's law of heat conduction, $q_x = -kA \\frac{dT}{dx}$, where $k$ is the thermal conductivity. Substituting this into the energy equation:\n$$ -\\frac{1}{A}\\frac{d}{dx}\\left(-kA\\frac{dT}{dx}\\right) + q'''(x) = 0 $$\nSince the thermal conductivity $k$ and the cross-sectional area $A$ are constant, we can simplify this to:\n$$ k \\frac{d^2T}{dx^2} + q'''(x) = 0 $$\nSubstituting the given expression for the volumetric heat source, $q'''(x)=q_{0}\\left(1+\\alpha \\frac{x}{L}\\right)$, the governing equation for the temperature field $T(x)$ is:\n$$ \\frac{d^2T}{dx^2} = -\\frac{q'''(x)}{k} = -\\frac{q_0}{k}\\left(1+\\alpha \\frac{x}{L}\\right) $$\nTo find the temperature distribution $T(x)$, we integrate this second-order ordinary differential equation twice. The first integration with respect to $x$ yields the temperature gradient:\n$$ \\frac{dT}{dx} = \\int -\\frac{q_0}{k}\\left(1+\\alpha \\frac{x}{L}\\right) dx = -\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + C_1 $$\nwhere $C_1$ is the first integration constant. A second integration yields the temperature field:\n$$ T(x) = \\int \\left[-\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + C_1\\right] dx = -\\frac{q_0}{k}\\left(\\frac{x^2}{2} + \\frac{\\alpha x^3}{6L}\\right) + C_1 x + C_2 $$\nwhere $C_2$ is the second integration constant. We determine $C_1$ and $C_2$ by applying the prescribed boundary conditions: $T(0)=T_s$ and $T(L)=T_s$.\n\nApplying the first boundary condition, $T(0)=T_s$:\n$$ T(0) = -\\frac{q_0}{k}\\left(0+0\\right) + C_1(0) + C_2 = T_s \\implies C_2 = T_s $$\nApplying the second boundary condition, $T(L)=T_s$:\n$$ T(L) = -\\frac{q_0}{k}\\left(\\frac{L^2}{2} + \\frac{\\alpha L^3}{6L}\\right) + C_1 L + T_s = T_s $$\n$$ -\\frac{q_0}{k}\\left(\\frac{L^2}{2} + \\frac{\\alpha L^2}{6}\\right) + C_1 L = 0 $$\nSolving for $C_1$:\n$$ C_1 L = \\frac{q_0 L^2}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) \\implies C_1 = \\frac{q_0 L}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) $$\nSubstituting the constants $C_1$ and $C_2$ back into the expression for $T(x)$, we obtain the complete solution for the temperature field:\n$$ T(x) = T_s + \\frac{q_0 L}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right)x - \\frac{q_0}{k}\\left(\\frac{x^2}{2} + \\frac{\\alpha x^3}{6L}\\right) $$\nThis expression can be rearranged to highlight the dimensionless position $\\xi = x/L$:\n$$ T(x) - T_s = \\frac{q_0 L^2}{k} \\left[ \\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right)\\left(\\frac{x}{L}\\right) - \\frac{1}{2}\\left(\\frac{x}{L}\\right)^2 - \\frac{\\alpha}{6}\\left(\\frac{x}{L}\\right)^3 \\right] $$\n\nNext, we justify the location of the maximum temperature. The heat generation term $q'''(x) = q_0(1+\\alpha \\frac{x}{L})$ is strictly positive for all $x \\in [0, L]$ because $q_0 > 0$ and $\\alpha > 0$. This continuous internal heat generation requires heat to be conducted out of the slab towards the boundaries, which are held at the constant temperature $T_s$. For heat to flow out, the temperature inside the slab must be higher than at the boundaries. Therefore, the maximum temperature must occur in the interior of the slab, i.e., for some $x_{\\max} \\in (0, L)$, and not at the boundaries $x=0$ or $x=L$.\n\nAt the point of maximum temperature, $x_{\\max}$, the temperature gradient must be zero: $\\left.\\frac{dT}{dx}\\right|_{x=x_{\\max}} = 0$. Using our expression for the temperature gradient:\n$$ \\frac{dT}{dx} = -\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + C_1 = -\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + \\frac{q_0 L}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) $$\nSetting $\\frac{dT}{dx}=0$ at $x=x_{\\max}$ and dividing by the non-zero term $-\\frac{q_0}{k}$:\n$$ \\left(x_{\\max} + \\frac{\\alpha x_{\\max}^2}{2L}\\right) - L\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) = 0 $$\nRearranging gives a quadratic equation for $x_{\\max}$:\n$$ \\frac{\\alpha}{2L}x_{\\max}^2 + x_{\\max} - \\left(\\frac{L}{2} + \\frac{\\alpha L}{6}\\right) = 0 $$\nTo clear the denominators, we multiply by $6L$:\n$$ 3\\alpha x_{\\max}^2 + 6L x_{\\max} - (3L^2 + \\alpha L^2) = 0 $$\n$$ 3\\alpha x_{\\max}^2 + 6L x_{\\max} - L^2(3+\\alpha) = 0 $$\nWe solve this quadratic equation using the quadratic formula, $x_{\\max} = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$, with $a=3\\alpha$, $b=6L$, and $c=-L^2(3+\\alpha)$.\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{(6L)^2 - 4(3\\alpha)(-L^2(3+\\alpha))}}{2(3\\alpha)} $$\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{36L^2 + 12\\alpha L^2(3+\\alpha)}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{36L^2 + 36\\alpha L^2 + 12\\alpha^2 L^2}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{12L^2(3 + 3\\alpha + \\alpha^2)}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-6L \\pm 2L\\sqrt{3(3 + 3\\alpha + \\alpha^2)}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-3L \\pm L\\sqrt{9 + 9\\alpha + 3\\alpha^2}}{3\\alpha} $$\nSince $x_{\\max}$ must represent a physical position within the slab, we require $x_{\\max} > 0$. As $\\alpha>0$, the denominator $3\\alpha$ is positive. The term under the square root, $9 + 9\\alpha + 3\\alpha^2$, is greater than $9$, so its square root is greater than $3$. Thus, the numerator of the \"plus\" root, $-3L + L\\sqrt{9 + 9\\alpha + 3\\alpha^2}$, is positive. The \"minus\" root would be negative and is therefore unphysical. We select the physically valid positive root:\n$$ x_{\\max} = \\frac{-3L + L\\sqrt{9 + 9\\alpha + 3\\alpha^2}}{3\\alpha} $$\nFactoring out $L$ gives the final expression for the location of maximum temperature:\n$$ x_{\\max} = L \\left( \\frac{\\sqrt{9 + 9\\alpha + 3\\alpha^2} - 3}{3\\alpha} \\right) $$\nThe second derivative, $\\frac{d^2T}{dx^2} = -\\frac{q_0}{k}(1+\\alpha \\frac{x}{L})$, is always negative for $x \\in [0,L]$, confirming that this critical point is indeed a maximum.",
            "answer": "$$ \\boxed{L \\left( \\frac{\\sqrt{9 + 9\\alpha + 3\\alpha^2} - 3}{3\\alpha} \\right)} $$"
        },
        {
            "introduction": "Building on the fundamentals, this exercise introduces an additional layer of physical realism: temperature-dependent material properties. You will tackle a problem where the thermal conductivity is not constant, coupling the temperature field back into the governing equation and creating a non-linear system . This practice is crucial for understanding and modeling the complex behaviors that arise in many real-world engineering materials subjected to significant thermal loads from internal heat generation.",
            "id": "4004507",
            "problem": "A planar, one-dimensional ($1$-D) solid slab of thickness $L$ occupies $0 \\le x \\le L$. The slab experiences uniform volumetric heat generation at a rate $q'''$ (constant in space and time), with $q''' > 0$. The thermal conductivity is temperature-dependent and follows the linear constitutive relation $k(T) = k_0 \\left[ 1 + \\beta \\left( T - T_0 \\right) \\right]$, where $k_0 > 0$ is a reference thermal conductivity, $\\beta \\ge 0$ is a material parameter, and $T_0$ is a reference temperature. The boundary at $x = 0$ is perfectly insulated (no heat flux), and the boundary at $x = L$ is held at a fixed temperature $T_s$.\n\nStarting from conservation of energy in a fixed control volume and Fourier’s law of heat conduction, without invoking any shortcut formulas, derive the governing relation for the steady-state temperature field $T(x)$ and then determine the position $x_{\\max}$ of the maximum temperature and its value $T_{\\max}$. Provide the final expressions for $x_{\\max}$ and $T_{\\max}$ in closed analytic form in terms of $L$, $q'''$, $k_0$, $\\beta$, $T_0$, and $T_s$. Report $x_{\\max}$ in meters and $T_{\\max}$ in Kelvin. No numerical rounding is required; give exact expressions.",
            "solution": "The problem is first validated against the defined criteria.\n\n### Step 1: Extract Givens\n-   **Geometry**: A planar, one-dimensional ($1$-D) solid slab of thickness $L$ occupying the domain $0 \\le x \\le L$.\n-   **Heat Generation**: Uniform volumetric heat generation rate $q'''$, which is a positive constant.\n-   **Thermal Conductivity**: A temperature-dependent property given by the linear relation $k(T) = k_0 \\left[ 1 + \\beta \\left( T - T_0 \\right) \\right]$.\n-   **Constants**: $k_0 > 0$ is a reference thermal conductivity, $\\beta \\ge 0$ is a material parameter, and $T_0$ is a reference temperature.\n-   **Boundary Conditions**:\n    -   At $x=0$: The boundary is perfectly insulated, meaning the heat flux is zero.\n    -   At $x=L$: The boundary is maintained at a fixed temperature $T_s$.\n-   **Objective**: Starting from first principles, derive the governing equation for the steady-state temperature field $T(x)$, and then find the location $x_{\\max}$ and value $T_{\\max}$ of the maximum temperature.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is founded on the principles of heat conduction, specifically Fourier's law and the conservation of energy. The linear model for temperature-dependent thermal conductivity is a standard and physically realistic approximation in thermal engineering. The problem is scientifically sound.\n-   **Well-Posed**: The problem describes a second-order ordinary differential equation with one flux boundary condition (Neumann) and one temperature boundary condition (Dirichlet). This constitutes a well-posed boundary value problem, for which a unique and stable solution is expected to exist.\n-   **Objective**: The problem statement is formulated with clear, precise, and unambiguous technical language, free from subjective or opinion-based claims.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and objective. It is deemed **valid**. A full solution will be provided.\n\n### Derivation and Solution\n\nThe analysis begins with the principle of conservation of energy applied to a differential control volume within the slab. For a one-dimensional, steady-state system with internal heat generation, the energy balance equation is:\n$$ \\frac{d}{dx} \\left( q''_{x} \\right) = q''' $$\nwhere $q''_{x}$ is the heat flux in the $x$-direction.\n\nAccording to Fourier's law of heat conduction, the heat flux is related to the temperature gradient by:\n$$ q''_{x} = -k(T) \\frac{dT}{dx} $$\nSubstituting Fourier's law into the energy balance equation gives the governing differential equation for the temperature field $T(x)$:\n$$ \\frac{d}{dx} \\left( -k(T) \\frac{dT}{dx} \\right) = q''' $$\n$$ \\frac{d}{dx} \\left( k(T) \\frac{dT}{dx} \\right) + q''' = 0 $$\nThis is the required governing relation. To solve this equation, we integrate it with respect to $x$:\n$$ k(T) \\frac{dT}{dx} = -q''' x + C_1 $$\nwhere $C_1$ is a constant of integration.\n\nThe first boundary condition is that the wall at $x=0$ is perfectly insulated. This means there is no heat flux at this location:\n$$ q''_{x}(0) = -k(T(0)) \\frac{dT}{dx}\\bigg|_{x=0} = 0 $$\nSince the thermal conductivity $k(T)$ is strictly positive (given $k_0 > 0$, $\\beta \\ge 0$, and assuming physically meaningful temperatures), this condition implies that the temperature gradient at $x=0$ must be zero:\n$$ \\frac{dT}{dx}\\bigg|_{x=0} = 0 $$\nApplying this to the integrated equation at $x=0$:\n$$ k(T(0)) \\cdot (0) = -q'''(0) + C_1 \\implies C_1 = 0 $$\nThe equation thus simplifies to:\n$$ k(T) \\frac{dT}{dx} = -q''' x $$\nThe location of the maximum temperature, $x_{\\max}$, is where the temperature gradient is zero, i.e., $\\frac{dT}{dx} = 0$. From the equation above, since $k(T) > 0$ and $q''' > 0$, this condition is only met at $x=0$.\nTherefore, the position of maximum temperature is $x_{\\max} = 0$. The maximum temperature is $T_{\\max} = T(0)$.\n\nTo find the temperature distribution, we substitute the given expression for $k(T)$:\n$$ k_0 \\left[ 1 + \\beta (T - T_0) \\right] \\frac{dT}{dx} = -q''' x $$\nWe separate variables and integrate. Let's integrate from $x=0$ (where $T = T_{\\max}$) to an arbitrary position $x$:\n$$ k_0 \\int_{T_{\\max}}^{T(x)} \\left[ 1 + \\beta (T' - T_0) \\right] dT' = \\int_{0}^{x} -q''' \\xi \\, d\\xi $$\n$$ k_0 \\left[ T' + \\frac{\\beta}{2}T'^2 - \\beta T_0 T' \\right]_{T_{\\max}}^{T(x)} = \\left[ -\\frac{q'''}{2}\\xi^2 \\right]_{0}^{x} $$\n$$ k_0 \\left\\{ \\left(T(x) + \\frac{\\beta}{2}T(x)^2 - \\beta T_0 T(x)\\right) - \\left(T_{\\max} + \\frac{\\beta}{2}T_{\\max}^2 - \\beta T_0 T_{\\max}\\right) \\right\\} = -\\frac{q'''x^2}{2} $$\nThis equation gives the temperature profile $T(x)$. To find $T_{\\max}$, we apply the second boundary condition, $T(L) = T_s$, by setting $x=L$:\n$$ k_0 \\left\\{ \\left(T_s + \\frac{\\beta}{2}T_s^2 - \\beta T_0 T_s\\right) - \\left(T_{\\max} + \\frac{\\beta}{2}T_{\\max}^2 - \\beta T_0 T_{\\max}\\right) \\right\\} = -\\frac{q'''L^2}{2} $$\nRearranging this equation to solve for the terms involving $T_{\\max}$:\n$$ T_{\\max} + \\frac{\\beta}{2}T_{\\max}^2 - \\beta T_0 T_{\\max} = T_s + \\frac{\\beta}{2}T_s^2 - \\beta T_0 T_s + \\frac{q'''L^2}{2k_0} $$\nThis is a quadratic equation for $T_{\\max}$ of the form $aT_{\\max}^2 + bT_{\\max} + c = 0$:\n$$ \\left(\\frac{\\beta}{2}\\right)T_{\\max}^2 + (1 - \\beta T_0)T_{\\max} - \\left(T_s(1 - \\beta T_0) + \\frac{\\beta}{2}T_s^2 + \\frac{q'''L^2}{2k_0}\\right) = 0 $$\nSolving for $T_{\\max}$ using the quadratic formula $T_{\\max} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$ T_{\\max} = \\frac{-(1 - \\beta T_0) \\pm \\sqrt{(1 - \\beta T_0)^2 + 4(\\frac{\\beta}{2})\\left(T_s(1 - \\beta T_0) + \\frac{\\beta}{2}T_s^2 + \\frac{q'''L^2}{2k_0}\\right)}}{2(\\frac{\\beta}{2})} $$\n$$ T_{\\max} = \\frac{\\beta T_0 - 1 \\pm \\sqrt{(1 - 2\\beta T_0 + \\beta^2 T_0^2) + 2\\beta T_s - 2\\beta^2 T_0 T_s + \\beta^2 T_s^2 + \\frac{\\beta q'''L^2}{k_0}}}{\\beta} $$\nThe term under the square root can be simplified:\n$$ 1 + 2\\beta(T_s - T_0) + \\beta^2(T_s^2 - 2T_0 T_s + T_0^2) + \\frac{\\beta q'''L^2}{k_0} = \\left[1 + \\beta(T_s - T_0)\\right]^2 + \\frac{\\beta q'''L^2}{k_0} $$\nSo the solution becomes:\n$$ T_{\\max} = \\frac{\\beta T_0 - 1 \\pm \\sqrt{\\left[1 + \\beta(T_s - T_0)\\right]^2 + \\frac{\\beta q'''L^2}{k_0}}}{\\beta} $$\nTo choose the correct sign, we consider the physical limit as $\\beta \\to 0$ (constant thermal conductivity). Using the positive sign leads to a $0/0$ indeterminate form, which can be resolved using L'Hôpital's rule to yield the correct physical result $T_{\\max} = T_s + \\frac{q'''L^2}{2k_0}$. The negative sign yields an unphysical result. Thus, we must choose the positive sign.\n$$ T_{\\max} = \\frac{\\beta T_0 - 1 + \\sqrt{\\left[1 + \\beta(T_s - T_0)\\right]^2 + \\frac{\\beta q'''L^2}{k_0}}}{\\beta} $$\nThis expression can be rewritten by adding and subtracting $T_0$:\n$$ T_{\\max} = T_0 + \\frac{-1 + \\sqrt{\\left[1 + \\beta(T_s - T_0)\\right]^2 + \\frac{\\beta q'''L^2}{k_0}}}{\\beta} $$\n\nTo summarize, the final analytical expressions are:\n1.  The position of maximum temperature is $x_{\\max} = 0$.\n2.  The maximum temperature $T_{\\max}$ (for $\\beta > 0$) is given by the expression derived above. For the special case $\\beta = 0$, the value is the limit of this expression, $T_{\\max} = T_s + \\frac{q'''L^2}{2k_0}$. The provided form is valid for the entire domain $\\beta \\ge 0$ if the value at $\\beta=0$ is understood as the limit.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0 & T_0 + \\frac{1}{\\beta} \\left( \\sqrt{\\left[1 + \\beta \\left(T_s - T_0\\right)\\right]^2 + \\frac{\\beta q''' L^2}{k_0}} - 1 \\right) \\end{pmatrix}}$$"
        },
        {
            "introduction": "This final practice transitions from analytical solutions to the domain of computational modeling, where most complex engineering problems are ultimately solved. You will implement a finite volume scheme to handle arbitrary, non-linear source functions on a non-uniform mesh, a common scenario in advanced simulations . This coding exercise provides direct, hands-on experience with the critical importance of proper source term integration for ensuring both numerical accuracy and the strict conservation of energy in a simulation.",
            "id": "4004508",
            "problem": "You are modeling a one-dimensional steady heat conduction problem with a spatially varying volumetric heat source in a nonuniform mesh. The physical quantity of interest is the volumetric heat generation rate per unit volume, denoted by $q'''(x)$ with units $\\mathrm{W/m^{3}}$. The computational task is to implement a robust computation of the cell-averaged source on a nonuniform mesh for given analytic source functions, demonstrate a conservation check, and quantify the difference between naive point-sampling and proper finite-volume cell averaging. All angles in trigonometric functions must be treated in radians. When integrating over the domain of length $L$, the total heat generation per unit area is $\\int_0^L q'''(x)\\,\\mathrm{d}x$ and must be reported in $\\mathrm{W/m^{2}}$.\n\nStart from the integral form of energy conservation for steady heat conduction in one spatial dimension and the requirement that the discretization remain conservative under the Finite Volume Method (FVM). Your program must use these principles to compute cell-averaged sources on a nonuniform mesh. The mesh is defined by control-volume faces at positions $x_{j+1/2}$ for $j=0,1,\\dots,N$, with $x_{1/2}=0$ and $x_{N+1/2}=L$, where the nonuniformity is introduced by a stretching exponent $\\alpha>0$ via the mapping $x_{j+1/2} = L\\left(\\frac{j}{N}\\right)^\\alpha$. The cell width is $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ for cell index $i=1,2,\\dots,N$.\n\nYour program must, for each test case:\n- Construct the nonuniform mesh from the given $L$, $N$, and $\\alpha$.\n- Implement $q'''(x)$ as specified for that case.\n- Compute the cell-averaged source in every control volume using the integral form implied by FVM, without relying on point sampling.\n- Compute the total integrated heat generation per unit area, $Q=\\int_0^L q'''(x)\\,\\mathrm{d}x$, by summing the cell-integrated sources and express $Q$ in $\\mathrm{W/m^{2}}$.\n- Quantify the deviation between naive center-point sampling and the cell-averaged representation using the relative $L^2$-norm with control-volume weighting. Specifically, compute\n$$\n\\varepsilon = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(\\bar{q}_i - q'''(x_i)\\right)^2 \\,\\Delta x_i}{\\sum_{i=1}^{N} \\bar{q}_i^2 \\,\\Delta x_i}},\n$$\nwhere $\\bar{q}_i$ is the cell-averaged source in cell $i$ and $x_i = \\tfrac{1}{2}\\left(x_{i-1/2}+x_{i+1/2}\\right)$ is the cell center.\n\nTest Suite. Implement the following four scientifically consistent test cases. All angles are in radians, and all quantities of $q'''(x)$ are in $\\mathrm{W/m^{3}}$.\n\n- Case $1$ (smooth oscillation with a localized Gaussian bump, moderate nonuniformity):\n    - Domain length: $L=1\\,\\mathrm{m}$, number of cells: $N=40$, stretch exponent: $\\alpha=1.7$.\n    - Source:\n      $$\n      q'''(x) = a_0 + a_1 x + A\\sin(\\omega x + \\phi) + G\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right).\n      $$\n      Parameters: $a_0=1.0\\times 10^5\\,\\mathrm{W/m^3}$, $a_1=5.0\\times 10^4\\,\\mathrm{W/m^4}$, $A=1.5\\times 10^5\\,\\mathrm{W/m^3}$, $\\omega=24\\pi\\,\\mathrm{rad/m}$, $\\phi=0$, $G=3.0\\times 10^5\\,\\mathrm{W/m^3}$, $x_0=0.6\\,\\mathrm{m}$, $\\sigma=0.07\\,\\mathrm{m}$.\n\n- Case $2$ (high-frequency oscillation prone to aliasing on a relatively coarse, mildly stretched mesh):\n    - Domain length: $L=1\\,\\mathrm{m}$, number of cells: $N=24$, stretch exponent: $\\alpha=0.8$.\n    - Source:\n      $$\n      q'''(x) = a_0 + a_1 x + A\\sin(\\omega x + \\phi) + G\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right).\n      $$\n      Parameters: $a_0=8.0\\times 10^4\\,\\mathrm{W/m^3}$, $a_1=2.0\\times 10^4\\,\\mathrm{W/m^4}$, $A=2.0\\times 10^5\\,\\mathrm{W/m^3}$, $\\omega=120\\pi\\,\\mathrm{rad/m}$, $\\phi=0.3$, $G=1.0\\times 10^5\\,\\mathrm{W/m^3}$, $x_0=0.2\\,\\mathrm{m}$, $\\sigma=0.03\\,\\mathrm{m}$.\n\n- Case $3$ (discontinuous step plus oscillation, requiring special handling of the discontinuity to avoid spurious oscillations):\n    - Domain length: $L=1\\,\\mathrm{m}$, number of cells: $N=32$, stretch exponent: $\\alpha=1.2$.\n    - Source:\n      $$\n      q'''(x) = a_0 + a_1 x + A\\sin(\\omega x + \\phi) + H\\,\\mathsf{H}(x-x_d),\n      $$\n      where $\\mathsf{H}(\\cdot)$ is the Heaviside step function. Parameters: $a_0=6.0\\times 10^4\\,\\mathrm{W/m^3}$, $a_1=3.0\\times 10^4\\,\\mathrm{W/m^4}$, $A=1.0\\times 10^5\\,\\mathrm{W/m^3}$, $\\omega=36\\pi\\,\\mathrm{rad/m}$, $\\phi=-0.2$, $H=4.0\\times 10^5\\,\\mathrm{W/m^3}$, $x_d=0.5\\,\\mathrm{m}$.\n\n- Case $4$ (sharp exponential decay near one boundary plus mild oscillation and a Gaussian, strongly stretched mesh):\n    - Domain length: $L=2\\,\\mathrm{m}$, number of cells: $N=64$, stretch exponent: $\\alpha=2.5$.\n    - Source:\n      $$\n      q'''(x) = a_0 + A\\sin(\\omega x + \\phi) + E\\exp\\!\\left(-\\frac{x}{\\lambda}\\right) + G\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right),\n      $$\n      Parameters: $a_0=5.0\\times 10^4\\,\\mathrm{W/m^3}$, $A=0.8\\times 10^5\\,\\mathrm{W/m^3}$, $\\omega=30\\pi\\,\\mathrm{rad/m}$, $\\phi=0$, $E=9.0\\times 10^5\\,\\mathrm{W/m^3}$, $\\lambda=0.12\\,\\mathrm{m}$, $G=2.0\\times 10^5\\,\\mathrm{W/m^3}$, $x_0=1.2\\,\\mathrm{m}$, $\\sigma=0.08\\,\\mathrm{m}$.\n\nFinal Output Specification. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case in the order $1,2,3,4$, output two values: first the total integrated heat generation $Q$ in $\\mathrm{W/m^{2}}$, and second the relative deviation $\\varepsilon$ as a decimal. The final output line must therefore contain $8$ numbers in the order\n$[Q_1,\\varepsilon_1,Q_2,\\varepsilon_2,Q_3,\\varepsilon_3,Q_4,\\varepsilon_4]$.",
            "solution": "The problem requires the implementation of a finite volume method (FVM) for computing cell-averaged volumetric heat sources on a one-dimensional nonuniform mesh. This task is central to computational heat transfer, as it ensures that the total heat generated within the discrete domain is conserved, regardless of the mesh structure. The problem is well-posed, scientifically grounded, and provides all necessary information for a complete computational solution.\n\n### Principle: Finite Volume Source Term Discretization\n\nThe fundamental principle underlying the Finite Volume Method is the enforcement of conservation laws on a discrete set of control volumes (CVs) that partition the computational domain. For steady-state one-dimensional heat conduction, the integral form of the energy balance over a single control volume $CV_i$, spanning from face $x_{i-1/2}$ to $x_{i+1/2}$, is given by:\n$$\n\\left(q_x A\\right)_{i+1/2} - \\left(q_x A\\right)_{i-1/2} + \\int_{CV_i} q'''(x) \\, dV = 0\n$$\nwhere $q_x$ is the heat flux in the $x$-direction [$\\mathrm{W/m^{2}}$], $A$ is the cross-sectional area [$\\mathrm{m^2}$], and $q'''(x)$ is the volumetric heat generation rate [$\\mathrm{W/m^{3}}$]. Assuming a constant cross-sectional area $A$ and a volume element $dV = A \\, dx$, the equation simplifies to:\n$$\nA \\left( (q_x)_{i+1/2} - (q_x)_{i-1/2} \\right) + A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = 0\n$$\nDividing by the cell volume $V_i = A \\Delta x_i$, where $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ is the cell width, we obtain the discretized equation:\n$$\n\\frac{(q_x)_{i+1/2} - (q_x)_{i-1/2}}{\\Delta x_i} + \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = 0\n$$\nThe second term represents the contribution of the heat source. In FVM, the source term is represented by its cell-averaged value, $\\bar{q}_i$, defined as:\n$$\n\\bar{q}_i = \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx\n$$\nThis integral formulation is crucial. A naive approach might sample the source at the cell center, $q'''(x_i)$, and assume $\\bar{q}_i \\approx q'''(x_i)$. However, for nonlinear source functions or highly nonuniform meshes, this approximation can lead to significant errors and violate conservation. The problem requires a direct computation of this integral for each cell.\n\n### Algorithmic Design and Implementation\n\nThe solution involves three main stages: mesh generation, analytical integration of the source function, and computation of the required metrics ($Q$ and $\\varepsilon$).\n\n#### 1. Mesh Generation\n\nThe nonuniform mesh is defined by the locations of the cell faces, $x_{j+1/2}$, for $j=0, 1, \\dots, N$. The mapping is given by:\n$$\nx_{j+1/2} = L \\left(\\frac{j}{N}\\right)^\\alpha\n$$\nThis creates a grid that is stretched according to the exponent $\\alpha$. If $\\alpha > 1$, cells are finer near $x=0$ and coarser near $x=L$. If $\\alpha < 1$, the opposite occurs. If $\\alpha=1$, the mesh is uniform. For each cell $i$ (where $i=1, \\dots, N$), the cell width is $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ and the cell center is $x_i = \\frac{1}{2}(x_{i-1/2} + x_{i+1/2})$.\n\n#### 2. Source Term Integration\n\nTo compute $\\bar{q}_i$, we need the analytical antiderivative of the source function $q'''(x)$. Let $F(x) = \\int q'''(x) \\, dx$. The integral over cell $i$ is then given by the fundamental theorem of calculus:\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = F(x_{i+1/2}) - F(x_{i-1/2})\n$$\nThe source functions in the problem are compositions of basic functions. We find their antiderivatives term-by-term:\n-   **Polynomial**: $\\int (a_0 + a_1 x) \\,dx = a_0 x + \\frac{1}{2}a_1 x^2 + C$\n-   **Sinusoidal**: $\\int A\\sin(\\omega x + \\phi) \\,dx = -\\frac{A}{\\omega}\\cos(\\omega x + \\phi) + C$\n-   **Gaussian**: $\\int G\\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right) \\,dx = G\\sigma\\sqrt{\\frac{\\pi}{2}}\\,\\mathrm{erf}\\left(\\frac{x-x_0}{\\sqrt{2}\\sigma}\\right) + C$, where $\\mathrm{erf}(\\cdot)$ is the error function, available in `scipy.special`.\n-   **Exponential Decay**: $\\int E\\exp\\left(-\\frac{x}{\\lambda}\\right) \\,dx = -E\\lambda\\exp\\left(-\\frac{x}{\\lambda}\\right) + C$\n-   **Heaviside Step**: For $a < b$, the integral $\\int_a^b H\\,\\mathsf{H}(x-x_d)\\,dx$ is handled piecewise. It evaluates to $H \\cdot \\max(0, b - \\max(a, x_d))$, which correctly captures the three cases: the interval is before, after, or straddles the discontinuity at $x_d$.\n\nThe implementation will consist of modular functions for the integral of each component, which are then combined as needed for each test case.\n\n#### 3. Computation of Metrics\n\n-   **Total Heat Generation ($Q$)**: The total heat generated per unit area over the domain $[0, L]$ is $Q = \\int_0^L q'''(x) \\, dx$. A key property of the FVM is conservation, meaning the sum of the integrated sources over all control volumes must equal the total integral over the domain:\n    $$\n    Q = \\sum_{i=1}^N \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = \\sum_{i=1}^N \\bar{q}_i \\Delta x_i\n    $$\n    The program will compute $Q$ using this summation.\n\n-   **Relative Deviation ($\\varepsilon$)**: To quantify the error introduced by the naive point-sampling approximation, we compute the volume-weighted relative $L^2$-norm of the difference between the cell-averaged source $\\bar{q}_i$ and the point-sampled source $q'''(x_i)$:\n    $$\n    \\varepsilon = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(\\bar{q}_i - q'''(x_i)\\right)^2 \\,\\Delta x_i}{\\sum_{i=1}^{N} \\bar{q}_i^2 \\,\\Delta x_i}}\n    $$\n    This requires evaluating $q'''(x)$ at each cell center $x_i$ and then applying the formula. A non-zero $\\varepsilon$ highlights the importance of proper source term integration, especially for coarse or stretched meshes and highly variable source functions.\n\nThe final program will systematically process each test case according to these principles, calculating $Q$ and $\\varepsilon$ and formatting the output as specified.",
            "answer": "[178128.0519154483,0.1192991004141684,88849.55938927893,0.9252329388339185,274971.8540608298,0.1804245645607632,324151.7247659547,0.2223946270912165]"
        }
    ]
}