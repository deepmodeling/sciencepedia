{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的计算模型之前，掌握其解析基础至关重要。第一个实践将探讨空间变化的体积热源如何影响固体内的温度分布。通过解决这个问题，你将对热源的函数形式与最终温度剖面之间的关系建立起直观理解，特别是最大温度的位置，这在许多工程应用中都是一个关键的设计考量。",
            "id": "4004475",
            "problem": "一块厚度为 $L$、热导率 $k$ 为常数的平板，沿 $x$ 方向经历稳态一维热传导，坐标 $x$ 从左侧面 $x=0$ 处量至右侧面 $x=L$ 处。体积热源呈线性变化，其形式为 $q'''(x)=q_{0}\\left(1+\\alpha \\frac{x}{L}\\right)$，其中 $q_{0}0$ 和 $\\alpha0$ 为常数。两侧面均保持在相同的指定温度 $T_{s}$，即 $T(0)=T_{s}$ 和 $T(L)=T_{s}$。从微元控制体的基本能量守恒和傅里叶热传导定律出发，推导控制方程，求解温度场 $T(x)$，并论证最高温度是出现在内部还是边界上。然后，确定最高温度位置 $x_{\\max}$（从 $x=0$ 处测量）的闭式解析表达式。以米为单位表示最终位置。无需四舍五入。",
            "solution": "问题陈述经评估有效。其科学基础为传热学原理，问题提法得当，条件充分且一致，陈述客观。我们可以开始求解。\n\n第一步是推导温度分布 $T(x)$ 的控制微分方程。我们对一个厚度为 $dx$、横截面积为 $A$（垂直于热流方向）的微元控制体应用能量守恒原理。对于稳态一维热传导，能量平衡为：\n$$ \\dot{E}_{in} - \\dot{E}_{out} + \\dot{E}_{gen} = \\dot{E}_{st} = 0 $$\n其中 $\\dot{E}_{in}$ 是在位置 $x$ 进入控制体的热量速率，$\\dot{E}_{out}$ 是在 $x+dx$ 离开的热量速率，$\\dot{E}_{gen}$ 是控制体内的生热速率。对于稳态条件，储能项 $\\dot{E}_{st}$ 为零。\n\n各项由以下公式给出：\n$$ \\dot{E}_{in} = q_x $$\n$$ \\dot{E}_{out} = q_{x+dx} $$\n$$ \\dot{E}_{gen} = q'''(x) \\cdot (A \\cdot dx) $$\n其中 $q_x$ 是热流率，$q'''(x)$ 是体积生热率。能量平衡变为：\n$$ q_x - q_{x+dx} + q'''(x) A dx = 0 $$\n对 $q_{x+dx}$ 进行泰勒级数展开并保留一阶项，我们得到 $q_{x+dx} \\approx q_x + \\frac{dq_x}{dx}dx$。将其代入平衡方程可得：\n$$ q_x - \\left(q_x + \\frac{dq_x}{dx}dx\\right) + q'''(x) A dx = 0 $$\n$$ -\\frac{dq_x}{dx}dx + q'''(x) A dx = 0 $$\n除以 $A \\cdot dx$ (因为 $A0$ 且 $dx0$)：\n$$ -\\frac{1}{A}\\frac{dq_x}{dx} + q'''(x) = 0 $$\n现在我们引入傅里叶热传导定律，$q_x = -kA \\frac{dT}{dx}$，其中 $k$ 是热导率。将此代入能量方程：\n$$ -\\frac{1}{A}\\frac{d}{dx}\\left(-kA\\frac{dT}{dx}\\right) + q'''(x) = 0 $$\n由于热导率 $k$ 和横截面积 $A$ 是常数，我们可以将其简化为：\n$$ k \\frac{d^2T}{dx^2} + q'''(x) = 0 $$\n代入给定的体积热源表达式 $q'''(x)=q_{0}\\left(1+\\alpha \\frac{x}{L}\\right)$，温度场 $T(x)$ 的控制方程为：\n$$ \\frac{d^2T}{dx^2} = -\\frac{q'''(x)}{k} = -\\frac{q_0}{k}\\left(1+\\alpha \\frac{x}{L}\\right) $$\n为求温度分布 $T(x)$，我们对这个二阶常微分方程积分两次。对 $x$ 进行第一次积分得到温度梯度：\n$$ \\frac{dT}{dx} = \\int -\\frac{q_0}{k}\\left(1+\\alpha \\frac{x}{L}\\right) dx = -\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + C_1 $$\n其中 $C_1$ 是第一个积分常数。第二次积分得到温度场：\n$$ T(x) = \\int \\left[-\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + C_1\\right] dx = -\\frac{q_0}{k}\\left(\\frac{x^2}{2} + \\frac{\\alpha x^3}{6L}\\right) + C_1 x + C_2 $$\n其中 $C_2$ 是第二个积分常数。我们通过应用给定的边界条件 $T(0)=T_s$ 和 $T(L)=T_s$ 来确定 $C_1$ 和 $C_2$。\n\n应用第一个边界条件，$T(0)=T_s$：\n$$ T(0) = -\\frac{q_0}{k}\\left(0+0\\right) + C_1(0) + C_2 = T_s \\implies C_2 = T_s $$\n应用第二个边界条件，$T(L)=T_s$：\n$$ T(L) = -\\frac{q_0}{k}\\left(\\frac{L^2}{2} + \\frac{\\alpha L^3}{6L}\\right) + C_1 L + T_s = T_s $$\n$$ -\\frac{q_0}{k}\\left(\\frac{L^2}{2} + \\frac{\\alpha L^2}{6}\\right) + C_1 L = 0 $$\n求解 $C_1$：\n$$ C_1 L = \\frac{q_0 L^2}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) \\implies C_1 = \\frac{q_0 L}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) $$\n将常数 $C_1$ 和 $C_2$ 代回 $T(x)$ 的表达式，我们得到温度场的完整解：\n$$ T(x) = T_s + \\frac{q_0 L}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right)x - \\frac{q_0}{k}\\left(\\frac{x^2}{2} + \\frac{\\alpha x^3}{6L}\\right) $$\n该表达式可以重新整理，以突出无量纲位置 $\\xi = x/L$：\n$$ T(x) - T_s = \\frac{q_0 L^2}{k} \\left[ \\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right)\\left(\\frac{x}{L}\\right) - \\frac{1}{2}\\left(\\frac{x}{L}\\right)^2 - \\frac{\\alpha}{6}\\left(\\frac{x}{L}\\right)^3 \\right] $$\n\n接下来，我们论证最高温度的位置。由于 $q_0  0$ 和 $\\alpha  0$，对于所有 $x \\in [0, L]$，生热项 $q'''(x) = q_0(1+\\alpha \\frac{x}{L})$ 严格为正。这种连续的内部生热要求热量从板内传导至保持在恒定温度 $T_s$ 的边界。为了使热量流出，板内部的温度必须高于边界温度。因此，最高温度必须出现在板的内部，即对于某个 $x_{\\max} \\in (0, L)$，而不是在边界 $x=0$ 或 $x=L$ 处。\n\n在最高温度点 $x_{\\max}$，温度梯度必须为零：$\\left.\\frac{dT}{dx}\\right|_{x=x_{\\max}} = 0$。使用我们的温度梯度表达式：\n$$ \\frac{dT}{dx} = -\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + C_1 = -\\frac{q_0}{k}\\left(x + \\frac{\\alpha x^2}{2L}\\right) + \\frac{q_0 L}{k}\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) $$\n在 $x=x_{\\max}$ 处令 $\\frac{dT}{dx}=0$，并除以非零项 $-\\frac{q_0}{k}$：\n$$ \\left(x_{\\max} + \\frac{\\alpha x_{\\max}^2}{2L}\\right) - L\\left(\\frac{1}{2} + \\frac{\\alpha}{6}\\right) = 0 $$\n重新整理得到一个关于 $x_{\\max}$ 的二次方程：\n$$ \\frac{\\alpha}{2L}x_{\\max}^2 + x_{\\max} - \\left(\\frac{L}{2} + \\frac{\\alpha L}{6}\\right) = 0 $$\n为了消去分母，我们乘以 $6L$：\n$$ 3\\alpha x_{\\max}^2 + 6L x_{\\max} - (3L^2 + \\alpha L^2) = 0 $$\n$$ 3\\alpha x_{\\max}^2 + 6L x_{\\max} - L^2(3+\\alpha) = 0 $$\n我们使用二次方程求根公式 $x_{\\max} = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 来解此方程，其中 $a=3\\alpha$，$b=6L$，$c=-L^2(3+\\alpha)$。\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{(6L)^2 - 4(3\\alpha)(-L^2(3+\\alpha))}}{2(3\\alpha)} $$\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{36L^2 + 12\\alpha L^2(3+\\alpha)}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{36L^2 + 36\\alpha L^2 + 12\\alpha^2 L^2}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-6L \\pm \\sqrt{12L^2(3 + 3\\alpha + \\alpha^2)}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-6L \\pm 2L\\sqrt{3(3 + 3\\alpha + \\alpha^2)}}{6\\alpha} $$\n$$ x_{\\max} = \\frac{-3L \\pm L\\sqrt{9 + 9\\alpha + 3\\alpha^2}}{3\\alpha} $$\n由于 $x_{\\max}$ 必须代表板内的一个物理位置，我们要求 $x_{\\max}  0$。因为 $\\alpha0$，分母 $3\\alpha$ 为正。平方根下的项 $9 + 9\\alpha + 3\\alpha^2$ 大于 $9$，所以其平方根大于 $3$。因此，“取正号”的根的分子 $-3L + L\\sqrt{9 + 9\\alpha + 3\\alpha^2}$ 是正的。“取负号”的根将为负，因此没有物理意义。我们选择有物理意义的正根：\n$$ x_{\\max} = \\frac{-3L + L\\sqrt{9 + 9\\alpha + 3\\alpha^2}}{3\\alpha} $$\n提出因子 $L$ 得到最高温度位置的最终表达式：\n$$ x_{\\max} = L \\left( \\frac{\\sqrt{9 + 9\\alpha + 3\\alpha^2} - 3}{3\\alpha} \\right) $$\n二阶导数 $\\frac{d^2T}{dx^2} = -\\frac{q_0}{k}(1+\\alpha \\frac{x}{L})$ 对于 $x \\in [0,L]$ 恒为负，这证实了该临界点确实是一个极大值点。",
            "answer": "$$ \\boxed{L \\left( \\frac{\\sqrt{9 + 9\\alpha + 3\\alpha^2} - 3}{3\\alpha} \\right)} $$"
        },
        {
            "introduction": "从解析解转向诸如有限体积法（FVM）等数值方法时，需要仔细处理像热源这样的连续函数。这项练习将挑战你批判性地思考如何离散化一个源项。你将分析数值守恒和准确性这些基本概念，并理解我们如何表示源项会直接影响模拟结果的物理真实性和可靠性。",
            "id": "4004528",
            "problem": "考虑一个厚度为 $L$、横截面积 $A$ 恒定、热导率 $k$ 恒定的一维 ($1\\text{D}$) 平板中的稳态导热，其体积热源在空间上变化。设温度场为 $T(x)$，体积生热率为 $q'''(x) = q_0 \\sin\\!\\left(\\dfrac{\\pi x}{L}\\right)$，其中 $q_0$ 是一个正常数。将能量守恒和 Fourier 导热定律应用于固定控制体，可得到在由面 $x_{i-1/2}$ 和 $x_{i+1/2}$ 界定的任意控制体 $V_i$ 上的热能平衡控制方程的积分形式为\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx}\\left(k A \\frac{dT}{dx}\\right)\\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x)\\,A\\,dx = 0,\n$$\n在标准的有限体积法装配下，它变成一个离散的面热通量和积分体积源的平衡方程，\n$$\n-kA\\left.\\frac{dT}{dx}\\right|_{x_{i+1/2}} + kA\\left.\\frac{dT}{dx}\\right|_{x_{i-1/2}} + Q_i = 0, \\quad \\text{其中} \\quad Q_i = \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x)\\,A\\,dx.\n$$\n假设使用一个均匀网格，该网格有 $N$ 个控制体，宽度为 $\\Delta x = L/N$，单元中心位于 $x_i = \\left(i - \\dfrac{1}{2}\\right)\\Delta x$。在实践中，如果 $q'''(x)$ 仅在某些点上已知，则必须对 $Q_i$ 进行数值近似；在均匀网格上，一个常见的选择是中点法则 $Q_i \\approx q'''(x_i)\\,A\\,\\Delta x$。\n\n从上述积分守恒定律和定义出发，分析 $Q_i$ 的形成方式对离散守恒性和精度的影响。选择所有正确的陈述。\n\nA. 对于 $q'''(x) = q_0 \\sin\\!\\left(\\dfrac{\\pi x}{L}\\right)$ 和恒定的 $A$，单元 $i$ 上的精确积分源项为\n$$\nQ_i = q_0\\,A\\,\\frac{L}{\\pi}\\left[\\cos\\!\\left(\\frac{\\pi x_{i-1/2}}{L}\\right) - \\cos\\!\\left(\\frac{\\pi x_{i+1/2}}{L}\\right)\\right].\n$$\n\nB. 如果每个内部面通量在每个面上计算一次，并以大小相等、符号相反的方式存储在两个相邻的单元中（成对反对称），那么将所有控制体的离散平衡方程相加，会得出净边界热通量等于 $\\sum_i Q_i$，而这与用于计算 $Q_i$ 的求积阶数无关。\n\nC. 在均匀网格上，用 $q'''(x_i)\\,V_i$ （其中 $V_i = A\\,\\Delta x$）来近似 $Q_i$，当 $q'''(x)$ 光滑时，会对源项产生 $\\mathcal{O}(\\Delta x)$ 的局部截断误差，因此积分源项只有一阶全局精度。\n\nD. 即使 $Q_i$ 被精确计算，如果导热算子通过对面梯度的一阶近似进行离散化，计算出的温度场仍可能只有一阶精度，因为主导的截断误差由通量离散化决定。\n\nE. 在高度倾斜的非正交网格上，为了确保离散守恒性，必须对每个单元内的 $q'''(x)$ 进行精确的解析积分；否则该格式就不能是守恒的。",
            "solution": "用户请求对一个计算传热学问题进行分析。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   **物理系统**：一维 ($1\\text{D}$) 平板中的稳态导热。\n*   **几何形状**：厚度 $L$，恒定横截面积 $A$。\n*   **材料属性**：恒定热导率 $k$。\n*   **未知场**：温度 $T(x)$。\n*   **体积热源**：$q'''(x) = q_0 \\sin\\!\\left(\\dfrac{\\pi x}{L}\\right)$，其中 $q_0$ 为一个正常数。\n*   **控制方程（针对从 $x_{i-1/2}$ 到 $x_{i+1/2}$ 的控制体 $V_i$ 的积分形式）**：\n    $$\n    \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx}\\left(k A \\frac{dT}{dx}\\right)\\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x)\\,A\\,dx = 0\n    $$\n*   **离散平衡方程**：\n    $$\n    -kA\\left.\\frac{dT}{dx}\\right|_{x_{i+1/2}} + kA\\left.\\frac{dT}{dx}\\right|_{x_{i-1/2}} + Q_i = 0\n    $$\n*   **积分源项的定义**：\n    $$\n    Q_i = \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x)\\,A\\,dx\n    $$\n*   **数值网格**：具有 $N$ 个控制体的均匀网格，每个控制体宽度为 $\\Delta x = L/N$。\n*   **单元中心**：$x_i = \\left(i - \\dfrac{1}{2}\\right)\\Delta x$。\n*   **源项近似**：提到中点法则是常用选择，$Q_i \\approx q'''(x_i)\\,A\\,\\Delta x$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n问题陈述在科学上是合理的、适定的和客观的。\n1.  **科学依据**：该问题描述了带有源项的稳态热传导方程的标准有限体积离散化。控制方程和定义是计算传热学和偏微分方程数值方法领域的基础。\n2.  **适定性**：该问题是适定的。它要求分析一个数值格式的性质（守恒性和精度），这些都是明确定义的数学概念。所提供的信息足以进行此分析。\n3.  **客观性**：语言技术性强，精确，没有主观或含糊不清的术语。\n4.  **完整性和一致性**：该问题是自洽的。它提供了控制方程的连续和离散形式、源项的具体函数形式以及网格定义，这些都是评估命题所需的所有必要组成部分。没有矛盾之处。\n\n**步骤3：结论和行动**\n\n该问题是**有效的**。现在将通过分析每个选项来求解。\n\n### 解答与选项分析\n\n**A. 对于 $q'''(x) = q_0 \\sin\\!\\left(\\dfrac{\\pi x}{L}\\right)$ 和恒定的 $A$，单元 $i$ 上的精确积分源项为 $Q_i = q_0\\,A\\,\\frac{L}{\\pi}\\left[\\cos\\!\\left(\\frac{\\pi x_{i-1/2}}{L}\\right) - \\cos\\!\\left(\\frac{\\pi x_{i+1/2}}{L}\\right)\\right]$。**\n\n为了验证这个陈述，我们必须计算源项在第 $i$ 个控制体上的精确积分。\n积分源项定义为：\n$$\nQ_i = \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x)\\,A\\,dx\n$$\n代入给定的函数 $q'''(x)$：\n$$\nQ_i = \\int_{x_{i-1/2}}^{x_{i+1/2}} q_0 \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\,A\\,dx\n$$\n由于 $q_0$ 和 $A$ 是常数，它们可以从积分中提出：\n$$\nQ_i = q_0 A \\int_{x_{i-1/2}}^{x_{i+1/2}} \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\,dx\n$$\n$\\sin(ax)$ 的反导数是 $-\\frac{1}{a}\\cos(ax)$。在这种情况下，常数 $a$ 是 $\\frac{\\pi}{L}$。\n$$\n\\int \\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\,dx = -\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right)\n$$\n计算定积分：\n$$\nQ_i = q_0 A \\left[ -\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x}{L}\\right) \\right]_{x_{i-1/2}}^{x_{i+1/2}}\n$$\n$$\nQ_i = q_0 A \\left( -\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x_{i+1/2}}{L}\\right) - \\left(-\\frac{L}{\\pi} \\cos\\!\\left(\\frac{\\pi x_{i-1/2}}{L}\\right)\\right) \\right)\n$$\n$$\nQ_i = q_0 A \\frac{L}{\\pi} \\left( \\cos\\!\\left(\\frac{\\pi x_{i-1/2}}{L}\\right) - \\cos\\!\\left(\\frac{\\pi x_{i+1/2}}{L}\\right) \\right)\n$$\n这个表达式与选项A中给出的完全匹配。\n\n结论：**正确**。\n\n**B. 如果每个内部面通量在每个面上计算一次，并以大小相等、符号相反的方式存储在两个相邻的单元中（成对反对称），那么将所有控制体的离散平衡方程相加，会得出净边界热通量等于 $\\sum_i Q_i$，而这与用于计算 $Q_i$ 的求积阶数无关。**\n\n这个陈述讨论了有限体积法中的离散全局守恒性。通用单元 $i$ 的离散平衡方程是：\n$$\n-kA\\left.\\frac{dT}{dx}\\right|_{x_{i+1/2}} + kA\\left.\\frac{dT}{dx}\\right|_{x_{i-1/2}} + Q_i = 0\n$$\n让我们定义通过左面进入单元 $i$ 的热率（通量）为 $q_{i-1/2} = -kA\\left.\\frac{dT}{dx}\\right|_{x_{i-1/2}}$，以及通过右面离开单元 $i$ 的热率为 $q_{i+1/2} = -kA\\left.\\frac{dT}{dx}\\right|_{x_{i+1/2}}$。符号约定意味着正通量沿正 $x$ 方向。因此单元 $i$ 的平衡方程为 $q_{i-1/2} - q_{i+1/2} + Q_i = 0$。\n\n“成对反对称性”这一性质意味着在面 $x_{i+1/2}$ 处离开单元 $i$ 的通量与在同一面处离开单元 $i+1$ 的通量大小完全相等，符号相反。这是有限体积法局部守恒性质的核心。\n让我们对所有单元 $i=1, \\dots, N$ 的离散平衡方程求和：\n$$\n\\sum_{i=1}^{N} \\left(q_{i-1/2} - q_{i+1/2} + Q_i\\right) = 0\n$$\n$$\n\\sum_{i=1}^{N} \\left(q_{i-1/2} - q_{i+1/2}\\right) + \\sum_{i=1}^{N} Q_i = 0\n$$\n第一项是一个伸缩求和：\n$$\n(q_{1/2} - q_{3/2}) + (q_{3/2} - q_{5/2}) + \\dots + (q_{N-1/2} - q_{N+1/2})\n$$\n所有内部通量（例如 $q_{3/2}$, $q_{5/2}$ 等）都相互抵消，只剩下区域边界上的通量：面 $1/2$（在 $x=0$ 处）和面 $N+1/2$（在 $x=L$ 处）。\n求和变为：\n$$\nq_{1/2} - q_{N+1/2} + \\sum_{i=1}^{N} Q_i = 0\n$$\n重新整理得到：\n$$\nq_{N+1/2} - q_{1/2} = \\sum_{i=1}^{N} Q_i\n$$\n项 $q_{N+1/2} - q_{1/2}$ 表示通过边界离开区域的净热率。此方程表明，离开区域边界的净热量等于区域内产生的总热量。这就是离散全局守恒的陈述。该推导仅依赖于求和的伸缩性质，这是通量守恒格式的直接结果。它完全独立于单元源项 $Q_i$ 的计算方式。\n\n结论：**正确**。\n\n**C. 在均匀网格上，用 $q'''(x_i)\\,V_i$ （其中 $V_i = A\\,\\Delta x$）来近似 $Q_i$，当 $q'''(x)$ 光滑时，会对源项产生 $\\mathcal{O}(\\Delta x)$ 的局部截断误差，因此积分源项只有一阶全局精度。**\n\n这个陈述涉及中点积分法则的精度。精确的积分源项是 $Q_i = A \\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} q'''(x) dx$。近似值是 $Q_i^{\\text{approx}} = A \\, q'''(x_i) \\Delta x$。\n误差是差值 $Q_i - Q_i^{\\text{approx}}$。为了确定此误差的阶数，我们在中点 $x_i$ 附近对 $q'''(x)$ 进行泰勒级数展开：\n$$\nq'''(x) = q'''(x_i) + (x-x_i)q'''' (x_i) + \\frac{(x-x_i)^2}{2!} q'''''(x_i) + \\mathcal{O}((x-x_i)^3)\n$$\n在单元上对这个级数进行积分，从 $x_i - \\Delta x/2$ 到 $x_i + \\Delta x/2$：\n$$\n\\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} q'''(x) dx = \\left[ q'''(x_i)x + \\frac{(x-x_i)^2}{2}q'''' (x_i) + \\frac{(x-x_i)^3}{6}q'''''(x_i) + \\dots \\right]_{x_i-\\Delta x/2}^{x_i+\\Delta x/2}\n$$\n计算各项：\n*   第一项得到 $q'''(x_i) \\Delta x$。\n*   第二项，涉及 $(x-x_i)$ 的奇次幂，在对称区间上的积分为 $0$。\n*   第三项得到 $\\frac{q'''''(x_i)}{6} \\left[ \\left(\\frac{\\Delta x}{2}\\right)^3 - \\left(-\\frac{\\Delta x}{2}\\right)^3 \\right] = \\frac{q'''''(x_i)}{6} \\left[ 2 \\frac{(\\Delta x)^3}{8} \\right] = \\frac{q'''''(x_i)}{24}(\\Delta x)^3$。\n\n所以，$\\int q'''(x) dx = q'''(x_i) \\Delta x + \\frac{q'''''(x_i)}{24}(\\Delta x)^3 + \\mathcal{O}((\\Delta x)^5)$。\n积分源项的误差是 $Q_i - Q_i^{\\text{approx}} = A \\left( \\frac{q'''''(x_i)}{24}(\\Delta x)^3 + \\dots \\right)$，其阶数为 $\\mathcal{O}((\\Delta x)^3)$。\n\n该陈述声称局部截断误差为 $\\mathcal{O}(\\Delta x)$。这是不正确的。中点积分法则对于平均值是二阶精度的，意味着积分量的局部截断误差是 $\\mathcal{O}((\\Delta x)^3)$。当整个离散方程除以体积 $A \\Delta x$ 时，源项对 PDE 近似的局部截断误差贡献为 $\\mathcal{O}((\\Delta x)^2)$，从而导致二阶精度格式，而非一阶。\n\n结论：**不正确**。\n\n**D. 即使 $Q_i$ 被精确计算，如果导热算子通过对面梯度的一阶近似进行离散化，计算出的温度场仍可能只有一阶精度，因为主导的截断误差由通量离散化决定。**\n\n这个陈述关系到一个数值格式的整体精度。一个离散方程的总局部截断误差 (LTE) 是其各组成部分（例如，通量项，源项）的截断误差之和。\n完整格式的 LTE 为：\n$$\n\\text{LTE} = \\text{LTE}_{\\text{flux}} + \\text{LTE}_{\\text{source}}\n$$\n该问题假设了这样一种情况：\n1.  源项 $Q_i$ 被“精确”计算。这意味着离散源项等于精确积分，所以 $\\text{LTE}_{\\text{source}} = 0$。\n2.  导热算子（面通量）采用一阶方法近似。这意味着 $\\text{LTE}_{\\text{flux}} = \\mathcal{O}(\\Delta x)$。一个例子是在单元面上使用单边差分来计算梯度。\n\n因此，总的局部截断误差为 $\\text{LTE} = \\mathcal{O}(\\Delta x) + 0 = \\mathcal{O}(\\Delta x)$。\n对于一个稳定且相容的数值方法，全局误差的阶数（最终计算解中的误差，例如 $T(x)$）与局部截断误差的阶数相同。因此，一个具有 $\\mathcal{O}(\\Delta x)$ 局部截断误差的格式将是全局一阶精度的。整体精度受限于离散化中精度最低的部分。将格式的一部分改进到非常高的阶数（或精确）并不能弥补另一部分的低阶近似。\n\n结论：**正确**。\n\n**E. 在高度倾斜的非正交网格上，为了确保离散守恒性，必须对每个单元内的 $q'''(x)$ 进行精确的解析积分；否则该格式就不能是守恒的。**\n\n这个陈述混淆了精度和守恒性的概念。正如在选项B的分析中所确立的，如果在一个两个单元共有的面上计算出的通量，在它们的平衡方程中以大小相等、符号相反的方式被计入，那么这个有限体积格式就是离散守恒的。这确保了离开一个单元的量精确地等于进入相邻单元的量。这个性质，它导致了伸缩求和和全局守恒，是表面积分（通量）如何被构建和装配的一个特征。网格的倾斜和非正交性给通量本身的近似带来了挑战和误差，但守恒的装配过程保持不变。\n\n源项的体积积分的计算，$Q_i = \\int_{V_i} q'''(x) dV$，是一个独立的问题，它影响局部平衡的精度，但不影响其守恒性。即使 $Q_i$ 的近似不准确（例如，使用低阶求积法则），格式仍然是守恒的。对 $Q_i$ 使用不准确的近似意味着单元 $i$ 中的离散平衡不能完美地代表该单元的物理能量平衡，这会引入更大的截断误差并降低最终解的精度。然而，该格式仍然全局地守恒离散量。因此，对源项的精确积分不是格式守恒的先决条件。\n\n结论：**不正确**。",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "最后的这项实践通过一个编码挑战综合了理论与应用，这也是现代计算工程的基石。你将为一个非均匀网格（这是真实世界模拟中的常见情景）实现一个稳健的程序，用以计算单元平均热源。通过处理复杂的解析定义源函数并量化简化近似所带来的误差，你将在开发守恒且精确的数值模型方面获得宝贵的实践技能。",
            "id": "4004508",
            "problem": "您正在为一个具有空间变化的体积热源的一维稳态热传导问题在非均匀网格上进行建模。我们关注的物理量是单位体积的体积生热率，记为 $q'''(x)$，单位为 $\\mathrm{W\\,m^{-3}}$。计算任务是在给定解析源函数的情况下，在非均匀网格上实现对单元平均源的稳健计算，进行守恒性检查，并量化朴素的点采样方法与正确的有限体积单元平均方法之间的差异。三角函数中的所有角度都必须以弧度为单位处理。在长度为 $L$ 的域上积分时，单位面积的总生热量为 $\\int_0^L q'''(x)\\,\\mathrm{d}x$，并且必须以 $\\mathrm{W\\,m^{-2}}$ 为单位报告。\n\n从一维稳态热传导的能量守恒积分形式以及在有限体积法（FVM）下离散化必须保持守恒的要求出发。您的程序必须使用这些原理来计算非均匀网格上的单元平均源。网格由位于 $x_{j+1/2}$（对于 $j=0,1,\\dots,N$）的控制体面定义，其中 $x_{1/2}=0$ 和 $x_{N+1/2}=L$。非均匀性通过映射 $x_{j+1/2} = L\\left(\\frac{j}{N}\\right)^\\alpha$ 引入，其中拉伸指数 $\\alpha0$。对于单元索引 $i=1,2,\\dots,N$，单元宽度为 $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$。\n\n对于每个测试用例，您的程序必须：\n- 根据给定的 $L$、$N$ 和 $\\alpha$ 构建非均匀网格。\n- 根据该用例的规定实现 $q'''(x)$。\n- 使用FVM所蕴含的积分形式，在每个控制体积中计算单元平均源，而不依赖于点采样。\n- 通过对各单元积分源求和，计算单位面积的总积分生热量 $Q=\\int_0^L q'''(x)\\,\\mathrm{d}x$，并以 $\\mathrm{W\\,m^{-2}}$ 表示 $Q$。\n- 使用带控制体加权的相对 $L^2$ 范数来量化朴素的中心点采样与单元平均表示之间的偏差。具体来说，计算\n$$\n\\varepsilon = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(\\bar{q}_i - q'''(x_i)\\right)^2 \\,\\Delta x_i}{\\sum_{i=1}^{N} \\bar{q}_i^2 \\,\\Delta x_i}},\n$$\n其中 $\\bar{q}_i$ 是单元 $i$ 中的单元平均源，$x_i = \\tfrac{1}{2}\\left(x_{i-1/2}+x_{i+1/2}\\right)$ 是单元中心。\n\n测试套件。实现以下四个科学上一致的测试用例。所有角度均为弧度，所有 $q'''(x)$ 的量纲均为 $\\mathrm{W\\,m^{-3}}$。\n\n- 用例 $1$（带有局部高斯凸起的光滑振荡，中等非均匀性）：\n    - 域长度：$L=1\\,\\mathrm{m}$，单元数量：$N=40$，拉伸指数：$\\alpha=1.7$。\n    - 源：\n      $$\n      q'''(x) = a_0 + a_1 x + A\\sin(\\omega x + \\phi) + G\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right).\n      $$\n      参数：$a_0=1.0\\times 10^5$，$a_1=5.0\\times 10^4\\,\\mathrm{W\\,m^{-4}}$，$A=1.5\\times 10^5$，$\\omega=24\\pi\\,\\mathrm{rad\\,m^{-1}}$，$\\phi=0$，$G=3.0\\times 10^5$，$x_0=0.6\\,\\mathrm{m}$，$\\sigma=0.07\\,\\mathrm{m}$。\n\n- 用例 $2$（在相对粗糙、轻度拉伸的网格上易于产生混叠的高频振荡）：\n    - 域长度：$L=1\\,\\mathrm{m}$，单元数量：$N=24$，拉伸指数：$\\alpha=0.8$。\n    - 源：\n      $$\n      q'''(x) = a_0 + a_1 x + A\\sin(\\omega x + \\phi) + G\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right).\n      $$\n      参数：$a_0=8.0\\times 10^4$，$a_1=2.0\\times 10^4\\,\\mathrm{W\\,m^{-4}}$，$A=2.0\\times 10^5$，$\\omega=120\\pi\\,\\mathrm{rad\\,m^{-1}}$，$\\phi=0.3$，$G=1.0\\times 10^5$，$x_0=0.2\\,\\mathrm{m}$，$\\sigma=0.03\\,\\mathrm{m}$。\n\n- 用例 $3$（不连续阶跃加振荡，需要对不连续点进行特殊处理以避免伪振荡）：\n    - 域长度：$L=1\\,\\mathrm{m}$，单元数量：$N=32$，拉伸指数：$\\alpha=1.2$。\n    - 源：\n      $$\n      q'''(x) = a_0 + a_1 x + A\\sin(\\omega x + \\phi) + H\\,\\mathsf{H}(x-x_d),\n      $$\n      其中 $\\mathsf{H}(\\cdot)$ 是亥维赛阶跃函数。参数：$a_0=6.0\\times 10^4$，$a_1=3.0\\times 10^4\\,\\mathrm{W\\,m^{-4}}$，$A=1.0\\times 10^5$，$\\omega=36\\pi\\,\\mathrm{rad\\,m^{-1}}$，$\\phi=-0.2$，$H=4.0\\times 10^5$，$x_d=0.5\\,\\mathrm{m}$。\n\n- 用例 $4$（靠近一个边界的急剧指数衰减加上轻微振荡和高斯函数，强拉伸网格）：\n    - 域长度：$L=2\\,\\mathrm{m}$，单元数量：$N=64$，拉伸指数：$\\alpha=2.5$。\n    - 源：\n      $$\n      q'''(x) = a_0 + A\\sin(\\omega x + \\phi) + E\\exp\\!\\left(-\\frac{x}{\\lambda}\\right) + G\\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right),\n      $$\n      参数：$a_0=5.0\\times 10^4$，$A=0.8\\times 10^5$，$\\omega=30\\pi\\,\\mathrm{rad\\,m^{-1}}$，$\\phi=0$，$E=9.0\\times 10^5$，$\\lambda=0.12\\,\\mathrm{m}$，$G=2.0\\times 10^5$，$x_0=1.2\\,\\mathrm{m}$，$\\sigma=0.08\\,\\mathrm{m}$。\n\n最终输出规范。您的程序应生成一个单行输出，其中包含一个由方括号括起来的逗号分隔的结果列表。对于按 1,2,3,4 顺序排列的每个用例，输出两个值：首先是总积分生热量 $Q$（单位为 $\\mathrm{W\\,m^{-2}}$），其次是相对偏差 $\\varepsilon$（小数形式）。因此，最终输出行必须包含 8 个数字，顺序为\n$[Q_1,\\varepsilon_1,Q_2,\\varepsilon_2,Q_3,\\varepsilon_3,Q_4,\\varepsilon_4]$。",
            "solution": "该问题要求实现一种有限体积法（FVM），用于在一维非均匀网格上计算单元平均的体积热源。这项任务是计算传热学的核心，因为它确保了在离散域内生成的总热量是守恒的，无论网格结构如何。该问题是适定的、有科学依据的，并为完整的计算求解提供了所有必要信息。\n\n### 原理：有限体积源项离散化\n\n有限体积法的基本原理是在划分计算域的一组离散控制体（CV）上强制执行守恒律。对于一维稳态热传导，在单个控制体 $CV_i$（从面 $x_{i-1/2}$ 延伸到 $x_{i+1/2}$）上的能量平衡积分形式由下式给出：\n$$\n\\left(q_x A\\right)_{i+1/2} - \\left(q_x A\\right)_{i-1/2} + \\int_{CV_i} q'''(x) \\, dV = 0\n$$\n其中 $q_x$ 是 $x$ 方向的热通量 [$\\mathrm{W\\,m^{-2}}$]，$A$ 是横截面积 [$\\mathrm{m^2}$]，$q'''(x)$ 是体积生热率 [$\\mathrm{W\\,m^{-3}}$]。假设横截面积 $A$ 恒定且体积元 $dV = A \\, dx$，方程简化为：\n$$\nA \\left( (q_x)_{i+1/2} - (q_x)_{i-1/2} \\right) + A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = 0\n$$\n两边同除以单元体积 $V_i = A \\Delta x_i$，其中 $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ 是单元宽度，我们得到离散化方程：\n$$\n\\frac{(q_x)_{i+1/2} - (q_x)_{i-1/2}}{\\Delta x_i} + \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = 0\n$$\n第二项代表热源的贡献。在FVM中，源项由其单元平均值 $\\bar{q}_i$ 表示，定义为：\n$$\n\\bar{q}_i = \\frac{1}{\\Delta x_i} \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx\n$$\n这种积分形式至关重要。一种朴素的方法可能是在单元中心 $q'''(x_i)$ 处对源进行采样，并假设 $\\bar{q}_i \\approx q'''(x_i)$。然而，对于非线性源函数或高度非均匀的网格，这种近似可能导致显著误差并违反守恒性。本问题要求对每个单元直接计算此积分。\n\n### 算法设计与实现\n\n解决方案包括三个主要阶段：网格生成、源函数的解析积分以及所需度量（$Q$ 和 $\\varepsilon$）的计算。\n\n#### 1. 网格生成\n\n非均匀网格由单元面 $x_{j+1/2}$（对于 $j=0, 1, \\dots, N$）的位置定义。其映射由下式给出：\n$$\nx_{j+1/2} = L \\left(\\frac{j}{N}\\right)^\\alpha\n$$\n这将创建一个根据指数 $\\alpha$ 拉伸的网格。如果 $\\alpha  1$，单元在 $x=0$ 附近更密，在 $x=L$ 附近更粗。如果 $\\alpha  1$，则情况相反。如果 $\\alpha=1$，网格是均匀的。对于每个单元 $i$（其中 $i=1, \\dots, N$），单元宽度为 $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$，单元中心为 $x_i = \\frac{1}{2}(x_{i-1/2} + x_{i+1/2})$。\n\n#### 2. 源项积分\n\n为了计算 $\\bar{q}_i$，我们需要源函数 $q'''(x)$ 的解析反导数。令 $F(x) = \\int q'''(x) \\, dx$。根据微积分基本定理，单元 $i$ 上的积分为：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = F(x_{i+1/2}) - F(x_{i-1/2})\n$$\n问题中的源函数是基本函数的组合。我们逐项找到它们的反导数：\n-   **多项式**：$\\int (a_0 + a_1 x) \\,dx = a_0 x + \\frac{1}{2}a_1 x^2 + C$\n-   **正弦**：$\\int A\\sin(\\omega x + \\phi) \\,dx = -\\frac{A}{\\omega}\\cos(\\omega x + \\phi) + C$\n-   **高斯**：$\\int G\\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right) \\,dx = G\\sigma\\sqrt{\\frac{\\pi}{2}}\\,\\mathrm{erf}\\left(\\frac{x-x_0}{\\sqrt{2}\\sigma}\\right) + C$，其中 $\\mathrm{erf}(\\cdot)$ 是误差函数，可在 `scipy.special` 中找到。\n-   **指数衰减**：$\\int E\\exp\\left(-\\frac{x}{\\lambda}\\right) \\,dx = -E\\lambda\\exp\\left(-\\frac{x}{\\lambda}\\right) + C$\n-   **亥维赛阶跃**：对于 $a  b$，积分 $\\int_a^b H\\,\\mathsf{H}(x-x_d)\\,dx$ 需要分段处理。其值为 $H \\cdot \\max(0, b - \\max(a, x_d))$，这正确地涵盖了三种情况：积分区间在不连续点 $x_d$ 之前、之后或跨越该点。\n\n实现将包含用于每个分量积分的模块化函数，然后根据每个测试用例的需要进行组合。\n\n#### 3. 度量计算\n\n-   **总生热量 ($Q$)**：在域 $[0, L]$ 上单位面积的总生热量为 $Q = \\int_0^L q'''(x) \\, dx$。FVM的一个关键特性是守恒性，这意味着所有控制体上的积分源之和必须等于域上的总积分：\n    $$\n    Q = \\sum_{i=1}^N \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\, dx = \\sum_{i=1}^N \\bar{q}_i \\Delta x_i\n    $$\n    程序将使用此求和来计算 $Q$。\n\n-   **相对偏差 ($\\varepsilon$)**：为量化朴素点采样近似引入的误差，我们计算单元平均源 $\\bar{q}_i$ 和点采样源 $q'''(x_i)$ 之差的体积加权相对 $L^2$ 范数：\n    $$\n    \\varepsilon = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(\\bar{q}_i - q'''(x_i)\\right)^2 \\,\\Delta x_i}{\\sum_{i=1}^{N} \\bar{q}_i^2 \\,\\Delta x_i}}\n    $$\n    这需要计算每个单元中心 $x_i$ 处的 $q'''(x)$，然后应用该公式。非零的 $\\varepsilon$ 凸显了正确进行源项积分的重要性，特别是对于粗糙或拉伸的网格以及变化剧烈的源函数。\n\n最终程序将根据这些原则系统地处理每个测试用例，计算 $Q$ 和 $\\varepsilon$，并按规定格式化输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\n# --- Integral and Function Definitions ---\n\n# Polynomial term: q(x) = a0 + a1*x\ndef poly_func(x, a0, a1):\n    return a0 + a1 * x\n\ndef poly_integral(xa, xb, a0, a1):\n    F_b = a0 * xb + 0.5 * a1 * xb**2\n    F_a = a0 * xa + 0.5 * a1 * xa**2\n    return F_b - F_a\n\n# Sinusoidal term: q(x) = A*sin(omega*x + phi)\ndef sin_func(x, A, omega, phi):\n    return A * np.sin(omega * x + phi)\n\ndef sin_integral(xa, xb, A, omega, phi):\n    if omega == 0:\n        return A * np.sin(phi) * (xb - xa)\n    F_b = -A / omega * np.cos(omega * xb + phi)\n    F_a = -A / omega * np.cos(omega * xa + phi)\n    return F_b - F_a\n\n# Gaussian term: q(x) = G*exp(-(x-x0)^2 / (2*sigma^2))\ndef gauss_func(x, G, x0, sigma):\n    return G * np.exp(-((x - x0)**2) / (2 * sigma**2))\n\ndef gauss_integral(xa, xb, G, x0, sigma):\n    const = G * sigma * np.sqrt(np.pi / 2.0)\n    F_b = const * erf((xb - x0) / (np.sqrt(2) * sigma))\n    F_a = const * erf((xa - x0) / (np.sqrt(2) * sigma))\n    return F_b - F_a\n\n# Heaviside step term: q(x) = H*H(x - xd)\ndef heaviside_func(x, H, xd):\n    return H * np.heaviside(x - xd, 1)\n\ndef heaviside_integral(xa, xb, H, xd):\n    # This vectorized implementation handles all cases\n    # integral is H * max(0, xb - max(xa, xd))\n    return H * np.maximum(0, xb - np.maximum(xa, xd))\n\n# Exponential decay term: q(x) = E*exp(-x/lambda)\ndef exp_decay_func(x, E, lam):\n    return E * np.exp(-x / lam)\n\ndef exp_decay_integral(xa, xb, E, lam):\n    if lam == 0:\n        return 0\n    F_b = -E * lam * np.exp(-xb / lam)\n    F_a = -E * lam * np.exp(-xa / lam)\n    return F_b - F_a\n\n# --- Case Processing Function ---\n\ndef process_case(case_params):\n    \"\"\"\n    Processes a single test case to compute Q and epsilon.\n    \"\"\"\n    L = case_params['L']\n    N = case_params['N']\n    alpha = case_params['alpha']\n    p = case_params['params']\n    q_type = case_params['q_type']\n\n    # 1. Generate Mesh\n    j = np.arange(N + 1)\n    x_faces = L * (j / N)**alpha\n    delta_x = np.diff(x_faces)\n    x_centers = 0.5 * (x_faces[:-1] + x_faces[1:])\n\n    # 2. Define source and integral functions for the case\n    if q_type == 'case1' or q_type == 'case2':\n        q_func = lambda x: (poly_func(x, p['a0'], p['a1']) +\n                           sin_func(x, p['A'], p['omega'], p['phi']) +\n                           gauss_func(x, p['G'], p['x0'], p['sigma']))\n        integral_func = lambda xa, xb: (poly_integral(xa, xb, p['a0'], p['a1']) +\n                                       sin_integral(xa, xb, p['A'], p['omega'], p['phi']) +\n                                       gauss_integral(xa, xb, p['G'], p['x0'], p['sigma']))\n    elif q_type == 'case3':\n        q_func = lambda x: (poly_func(x, p['a0'], p['a1']) +\n                           sin_func(x, p['A'], p['omega'], p['phi']) +\n                           heaviside_func(x, p['H'], p['xd']))\n        integral_func = lambda xa, xb: (poly_integral(xa, xb, p['a0'], p['a1']) +\n                                       sin_integral(xa, xb, p['A'], p['omega'], p['phi']) +\n                                       heaviside_integral(xa, xb, p['H'], p['xd']))\n    elif q_type == 'case4':\n        q_func = lambda x: (p['a0'] +\n                           sin_func(x, p['A'], p['omega'], p['phi']) +\n                           exp_decay_func(x, p['E'], p['lambda']) +\n                           gauss_func(x, p['G'], p['x0'], p['sigma']))\n        integral_func = lambda xa, xb: (p['a0'] * (xb - xa) +\n                                       sin_integral(xa, xb, p['A'], p['omega'], p['phi']) +\n                                       exp_decay_integral(xa, xb, p['E'], p['lambda']) +\n                                       gauss_integral(xa, xb, p['G'], p['x0'], p['sigma']))\n\n    # 3. Compute cell-averaged sources\n    cell_integrals = integral_func(x_faces[:-1], x_faces[1:])\n    q_bar = cell_integrals / delta_x\n    \n    # 4. Compute total heat generation Q\n    Q = np.sum(cell_integrals)\n\n    # 5. Compute deviation epsilon\n    q_point = q_func(x_centers)\n    \n    numerator = np.sum((q_bar - q_point)**2 * delta_x)\n    denominator = np.sum(q_bar**2 * delta_x)\n    \n    epsilon = np.sqrt(numerator / denominator) if denominator != 0 else 0.0\n\n    return Q, epsilon\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        { # Case 1\n            'L': 1.0, 'N': 40, 'alpha': 1.7, 'q_type': 'case1',\n            'params': {\n                'a0': 1.0e5, 'a1': 5.0e4, 'A': 1.5e5, 'omega': 24 * np.pi,\n                'phi': 0.0, 'G': 3.0e5, 'x0': 0.6, 'sigma': 0.07,\n            }\n        },\n        { # Case 2\n            'L': 1.0, 'N': 24, 'alpha': 0.8, 'q_type': 'case2',\n            'params': {\n                'a0': 8.0e4, 'a1': 2.0e4, 'A': 2.0e5, 'omega': 120 * np.pi,\n                'phi': 0.3, 'G': 1.0e5, 'x0': 0.2, 'sigma': 0.03,\n            }\n        },\n        { # Case 3\n            'L': 1.0, 'N': 32, 'alpha': 1.2, 'q_type': 'case3',\n            'params': {\n                'a0': 6.0e4, 'a1': 3.0e4, 'A': 1.0e5, 'omega': 36 * np.pi,\n                'phi': -0.2, 'H': 4.0e5, 'xd': 0.5,\n            }\n        },\n        { # Case 4\n            'L': 2.0, 'N': 64, 'alpha': 2.5, 'q_type': 'case4',\n            'params': {\n                'a0': 5.0e4, 'A': 0.8e5, 'omega': 30 * np.pi, 'phi': 0.0,\n                'E': 9.0e5, 'lambda': 0.12, 'G': 2.0e5, 'x0': 1.2, 'sigma': 0.08,\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Q, epsilon = process_case(case)\n        results.extend([Q, epsilon])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}