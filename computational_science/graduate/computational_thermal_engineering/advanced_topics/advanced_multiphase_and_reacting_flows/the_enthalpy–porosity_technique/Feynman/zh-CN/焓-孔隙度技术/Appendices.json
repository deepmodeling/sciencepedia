{
    "hands_on_practices": [
        {
            "introduction": "在投入复杂的计算模拟之前，首先理解问题的核心物理机制至关重要。本练习引导您通过无量纲化分析，从基本的守恒定律出发，推导出控制熔化过程的关键无量纲数——瑞利数（$Ra$）和斯特凡数（$Ste$）。掌握这些参数有助于洞察对流、扩散和潜热之间的相互作用，为后续的模拟设置和结果分析提供坚实的物理基础。",
            "id": "3991317",
            "problem": "一个边长为 $L_{c}$ 的方形空腔中充满了初始温度为其熔化温度 $T_{m}$ 的相变材料（PCM）。在时间 $t=0$ 时，左壁突然被维持在更高的温度 $T_{h}>T_{m}$，而其余壁面则为绝热状态。流动在 Boussinesq 近似下被建模为不可压缩流，相变过程采用焓-孔隙度技术处理，其中糊状区被建模为多孔介质，其 Darcy 阻力在全液相区消失，在全固相区发散。在 $T\\approx T_{m}$ 时的液体性质被认为是恒定的。以第一性原理（质量、动量和能量守恒）为基本依据，通过进行系统的无量纲化，识别出量化浮力驱动对流相对于扩散输运的典型无量纲数组，以及熔化过程中显热与潜热效应之比。然后，使用以下科学真实的数据和边界条件，并以液体性质作为输运系数，计算这些无量纲数组的值：\n- 空腔尺寸：$L_{c}=0.05\\,\\text{m}$。\n- 重力：$g=9.81\\,\\text{m}\\,\\text{s}^{-2}$。\n- 热膨胀系数：$\\beta=8.00\\times 10^{-4}\\,\\text{K}^{-1}$。\n- 热壁温度和熔化温度：$T_{h}=330\\,\\text{K}$ 和 $T_{m}=315\\,\\text{K}$，因此施加的温差为 $\\Delta T=T_{h}-T_{m}$。\n- 液体密度：$\\rho_{\\ell}=800\\,\\text{kg}\\,\\text{m}^{-3}$。\n- 液体动力粘度：$\\mu_{\\ell}=3.00\\times 10^{-3}\\,\\text{Pa}\\,\\text{s}$，由此得到液体运动粘度 $\\nu=\\mu_{\\ell}/\\rho_{\\ell}$。\n- 液体导热系数：$k_{\\ell}=0.200\\,\\text{W}\\,\\text{m}^{-1}\\,\\text{K}^{-1}$ 和定压比热：$c_{p}=2000\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$，由此得到液体热扩散系数 $\\alpha=k_{\\ell}/(\\rho_{\\ell}c_{p})$。\n- 熔化潜热：$L_{h}=2.00\\times 10^{5}\\,\\text{J}\\,\\text{kg}^{-1}$。\n\n根据您的无量纲化，计算通常为空腔内自然对流定义的浮力-扩散比，以及通常为伴有相变的熔化定义的显热-潜热比。然后，基于无量纲控制方程和焓-孔隙度闭合模型的物理推理，定性解释这两个数组的大小如何共同影响熔化过程中的内部流动强度和演变的界面形态。将这两个无量纲数组的最终答案表示为一个行矩阵 $\\big[Ra,\\ Ste\\big]$，并将两个条目都四舍五入到四位有效数字。由于这两个数组都是无量纲的，因此最终报告值不需要单位。",
            "solution": "我们从 Boussinesq 近似下的不可压缩牛顿流体的守恒定律以及用于相变的焓-孔隙度公式出发。控制方程包括：\n- 质量守恒：$\\nabla\\cdot \\boldsymbol{u}=0$。\n- 动量守恒（液相区和带有 Darcy 阻力的糊状区）：$\\rho\\left(\\dfrac{\\partial \\boldsymbol{u}}{\\partial t}+\\boldsymbol{u}\\cdot \\nabla \\boldsymbol{u}\\right)=-\\nabla p+\\mu \\nabla^{2}\\boldsymbol{u}+\\rho\\,\\boldsymbol{g}\\,\\beta\\,(T-T_{\\text{ref}})\\,\\hat{\\boldsymbol{y}}+\\boldsymbol{S}_{D}$，其中 $\\boldsymbol{S}_{D}$ 表示在焓-孔隙度技术中使用的类 Darcy 汇项，并在全液相区消失。\n- 用显-潜焓表示的能量守恒：$\\dfrac{\\partial (\\rho h)}{\\partial t}+\\nabla \\cdot (\\rho \\boldsymbol{u} h)=\\nabla \\cdot (k \\nabla T)$，其中比焓 $h$ 为 $h=h_{0}+c_{p}(T-T_{0})+L_{h} f_{\\ell}$ 且 $f_{\\ell}\\in[0,1]$ 为液相分数。\n\n在代入 $h$ 并假设 $\\rho$、$c_{p}$ 和 $k$（液体性质）为常数后，能量方程可以重写为\n$$\n\\rho c_{p}\\left(\\dfrac{\\partial T}{\\partial t}+\\boldsymbol{u}\\cdot \\nabla T\\right)=k \\nabla^{2} T-\\rho L_{h}\\dfrac{\\partial f_{\\ell}}{\\partial t}.\n$$\n\n为了识别出典型的无量纲数组，我们引入适用于边长为 $L_{c}$、施加温差为 $\\Delta T=T_{h}-T_{m}$ 的差热空腔中自然对流和传导的特征尺度。我们选择：\n- 长度尺度：$L_{c}$，因此 $\\boldsymbol{x}=L_{c}\\,\\boldsymbol{x}^{*}$。\n- 温度尺度：$\\Delta T$，因此 $T=T_{\\text{ref}}+\\Delta T\\,\\theta$，其中 $\\theta=T^{*}$ 是无量纲温度。\n- 速度尺度：$\\alpha/L_{c}$，其中 $\\alpha=k/(\\rho c_{p})$ 是热扩散系数，因此 $\\boldsymbol{u}=(\\alpha/L_{c})\\,\\boldsymbol{u}^{*}$。\n- 时间尺度：$L_{c}^{2}/\\alpha$，因此 $t=(L_{c}^{2}/\\alpha)\\,t^{*}$。\n- 压力尺度：$\\rho \\alpha^{2}/L_{c}^{2}$，因此 $p=(\\rho \\alpha^{2}/L_{c}^{2})\\,p^{*}$。\n\n使用这些尺度，无量纲动量方程（忽略在全液相区消失的 Darcy 项，并在其他地方保留其作为与速度成正比的阻尼项）变为\n$$\n\\dfrac{\\partial \\boldsymbol{u}^{*}}{\\partial t^{*}}+\\boldsymbol{u}^{*}\\cdot \\nabla^{*} \\boldsymbol{u}^{*}=-\\nabla^{*} p^{*}+\\Pr \\nabla^{*2} \\boldsymbol{u}^{*}+Ra\\,\\Pr\\,\\theta\\,\\hat{\\boldsymbol{y}}+\\boldsymbol{S}_{D}^{*},\n$$\n其中 Prandtl 数为 $\\Pr=\\dfrac{\\nu}{\\alpha}$，Rayleigh 数为\n$$\nRa=\\dfrac{g\\,\\beta\\,\\Delta T\\,L_{c}^{3}}{\\nu\\,\\alpha}.\n$$\n这个 $Ra$ 量化了差热空腔中自然对流的浮力驱动与扩散耗散之比。\n\n无量纲能量方程变为\n$$\n\\dfrac{\\partial \\theta}{\\partial t^{*}}+\\boldsymbol{u}^{*}\\cdot \\nabla^{*} \\theta=\\nabla^{*2} \\theta-\\dfrac{1}{Ste}\\,\\dfrac{\\partial f_{\\ell}}{\\partial t^{*}},\n$$\n其中 Stefan 数为\n$$\nSte=\\dfrac{c_{p}\\,\\Delta T}{L_{h}}.\n$$\n这个 $Ste$ 衡量了在施加温差范围内的显热与熔化所需潜热之比；小的 $Ste$ 表示潜热在能量收支中占主导地位并减慢相变过程，而大的 $Ste$ 表示相对于潜热需求，显热更容易使温度升高。\n\n通过无量纲化从第一性原理识别出 $Ra$ 和 $Ste$ 后，我们现在根据给定数据计算它们的值。\n\n首先计算用于 $Ra$ 的输运性质：\n- 运动粘度为\n$$\n\\nu=\\dfrac{\\mu_{\\ell}}{\\rho_{\\ell}}=\\dfrac{3.00\\times 10^{-3}}{800}=3.75\\times 10^{-6}\\ \\text{m}^{2}\\,\\text{s}^{-1}.\n$$\n- 热扩散系数为\n$$\n\\alpha=\\dfrac{k_{\\ell}}{\\rho_{\\ell} c_{p}}=\\dfrac{0.200}{800\\times 2000}=1.25\\times 10^{-7}\\ \\text{m}^{2}\\,\\text{s}^{-1}.\n$$\n- 施加的温差为\n$$\n\\Delta T=T_{h}-T_{m}=330-315=15\\ \\text{K}.\n$$\n- 空腔长度的立方为\n$$\nL_{c}^{3}=(0.05)^{3}=1.25\\times 10^{-4}\\ \\text{m}^{3}.\n$$\n\n将这些值代入 $Ra$：\n$$\nRa=\\dfrac{(9.81)\\,(8.00\\times 10^{-4})\\,(15)\\,(1.25\\times 10^{-4})}{(3.75\\times 10^{-6})\\,(1.25\\times 10^{-7})}.\n$$\n分别计算分子和分母：\n$$\n\\text{分子}=9.81\\times 8.00\\times 10^{-4}\\times 15\\times 1.25\\times 10^{-4}=1.4715\\times 10^{-5},\n$$\n$$\n\\text{分母}=3.75\\times 10^{-6}\\times 1.25\\times 10^{-7}=4.6875\\times 10^{-13}.\n$$\n因此，\n$$\nRa=\\dfrac{1.4715\\times 10^{-5}}{4.6875\\times 10^{-13}}=\\left(\\dfrac{1.4715}{4.6875}\\right)\\times 10^{8}\\approx 3.139\\times 10^{7}.\n$$\n\n接下来计算 $Ste$：\n$$\nSte=\\dfrac{c_{p}\\,\\Delta T}{L_{h}}=\\dfrac{2000\\times 15}{2.00\\times 10^{5}}=\\dfrac{30000}{200000}=0.15.\n$$\n\n四舍五入到四位有效数字，我们得到\n$$\nRa=3.139\\times 10^{7},\\qquad Ste=0.1500.\n$$\n\n在焓-孔隙度框架内对流动和界面形状的定性影响：动量方程显示浮力项以 $Ra\\,\\Pr\\,\\theta\\,\\hat{\\boldsymbol{y}}$ 的形式出现，因此，在 $\\Pr$ 固定的情况下，增加 $Ra$ 会相对于粘性扩散和热扩散按比例增强驱动力。大的 $Ra$ 会产生剧烈的自然对流，增加从热壁到熔体的对流传热。对差热空腔的标度分析和关联式表明，Nusselt 数随 $Ra$ 的增加而增加（例如，在层流区 $Nu\\sim Ra^{n}$，其中 $n>0$），这会加速熔化并使固-液界面变形：暖流体沿热壁上升并扫过顶部，因此熔化前沿通常在顶部附近向上凸出，在底部附近滞后，从液相侧看形成一个凹形界面。能量方程包含潜热项 $-(1/Ste)\\,\\partial f_{\\ell}/\\partial t^{*}$，这揭示了对于小的 $Ste$，给定的熔化速率（$\\partial f_{\\ell}/\\partial t^{*}$）需要从显热平衡中吸收大量的能量。因此，在小的 $Ste$ 下，大部分区域的温度场保持在熔化等温线附近，糊状区变宽，即使在强对流下界面也推进缓慢。相反，对于较大的 $Ste$，显热很容易使温度升高到 $T_{m}$ 以上，使糊状区收缩，并允许对流引起的热不均匀性更强烈地印刻在界面形状上。共同作用下，大的 $Ra$ 和大的 $Ste$ 有利于强循环和具有薄热边界层的明显的、不对称的熔化前沿；大的 $Ra$ 但小的 $Ste$ 会产生强流动，但界面的整体推进仍然受限于潜热，熔化集中在对流热通量最高的地方（靠近热壁的上部）。在所有情况下，焓-孔隙度 Darcy 阻力都会规范糊状区内的流动，但对流动强度和界面形态的主要控制是通过上面推导出的 $Ra$ 和 $Ste$ 体现出来的。\n\n最后，遵照指示，我们将这两个无量纲数组表示为一个行矩阵 $\\big[Ra,\\ Ste\\big]$，并四舍五入到四位有效数字。",
            "answer": "$$\\boxed{\\begin{pmatrix}3.139\\times 10^{7}  & 0.1500\\end{pmatrix}}$$"
        },
        {
            "introduction": "将物理模型转化为可靠的计算程序是计算热工学的核心任务。这个练习挑战您像计算流体动力学（CFD）开发者一样思考，设计一个用于模拟相变问题的分离式求解器算法框架。通过辨析不同的实现策略，您将学会如何正确处理焓-孔隙法中存在的强非线性和多物理场耦合，特别是如何稳定地处理糊状区的动量耗散项。",
            "id": "3991255",
            "problem": "考虑在有界域内纯物质凝固/熔化的焓-多孔介质法的分离式有限体积法 (FVM) 实现。控制方程为能量守恒和动量平衡，其中糊状区包含一个类达西阻尼项。焓形式的能量守恒定律为\n$$\\frac{\\partial (\\rho h)}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u} h) = \\nabla \\cdot (k \\nabla T),$$\n其本构关系为\n$$h(T,f_l) = h_{\\text{sens}}(T) + f_l L, \\quad h_{\\text{sens}}(T) = \\int_{T_{\\text{ref}}}^{T} \\rho c_p(\\theta)\\, d\\theta,$$\n其中 $h$ 是焓，$T$ 是温度，$f_l$ 是液相分数，$L$ 是潜热，$\\rho$ 是密度，$k$ 是热导率，$c_p$ 是定压比热。动量平衡包含一个糊状区汇项，模型为\n$$\\rho\\left(\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u}\\right) = -\\nabla p + \\nabla\\cdot\\left(\\mu \\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top}\\right)\\right) - A(f_l)\\, \\mathbf{u},$$\n其中 $\\mathbf{u}$ 是速度，$p$ 是压力，$\\mu$ 是粘度，$A(f_l)$ 是一个非负系数，当 $f_l \\to 0$ 时该系数增大，以在固体区域中抑制速度。一个经过充分测试的典型形式是\n$$A(f_l) = A_m \\frac{(1 - f_l)^2}{f_l^3 + \\epsilon^3},$$\n其中 $A_m$ 是一个大常数，$\\epsilon$ 是一个小的正则化参数。液相分数 $f_l$ 由相变区间 $[T_s,T_l]$ 上的一个平滑斜坡函数定义，例如\n$$f_l(T) = \n\\begin{cases}\n0, & T \\le T_s,\\\\\n\\frac{T - T_s}{T_l - T_s}, & T_s < T < T_l,\\\\\n1, & T \\ge T_l,\n\\end{cases}$$\n或其任何可微的正则化形式，以使 $\\frac{df_l}{dT}$ 有良好定义。\n\n您需要选择最能正确概括分离式焓-多孔介质求解器伪代码的选项，包括对 $T$、$h$、$f_l$、$\\mathbf{u}$ 以及汇项系数（或汇项）数据结构的明确标识，并清晰说明在循环中处理非线性的位置和方式。该求解器应：\n\n- 为与 FVM 一致的主变量和系数存储网格中心数组。\n- 遵循 $h(T,f_l)$ 和 $A(f_l)$ 的耦合关系。\n- 通过压力耦合方程组的半隐式方法（SIMPLE）来保证质量守恒。\n- 在动量矩阵中对糊状区汇项进行半隐式处理以提高稳定性。\n- 通过在每个时间步内的一致迭代策略来处理由 $f_l(T)$ 和 $A(f_l)$ 产生的非线性。\n\n以下哪个选项最合适？\n\nA. 数据结构：网格中心数组 $T[\\Omega]$、$h[\\Omega]$、$f_l[\\Omega]$、$\\mathbf{u}_x[\\Omega]$、$\\mathbf{u}_y[\\Omega]$、$p[\\Omega]$、$A[\\Omega]$ 和网格面通量 $F[\\text{faces}]$。对于每个时间步索引 $n$：初始化 $T^{(0)}$、$f_l^{(0)}$、$\\mathbf{u}^{(0)}$。执行一个关于 $m$ 的 Picard 非线性循环，直到收敛：\n- 构建动量矩阵，其对角线项由 $A(f_l^{(m)})$ 增强；求解 $\\mathbf{u}^{(m+1)}$；应用压力耦合方程组的半隐式方法（SIMPLE）进行压力修正；对 $\\mathbf{u}$ 进行欠松弛。\n- 使用等效热容 $c_{\\text{eff}}^{(m)} = c_p + L \\frac{df_l}{dT}\\big|_{T^{(m)}}$ 组装温度形式的能量方程；以 $\\mathbf{u}^{(m+1)}$ 进行对流求解 $T^{(m+1)}$；更新 $f_l^{(m+1)} = f_l(T^{(m+1)})$；更新 $h^{(m+1)} = h_{\\text{sens}}(T^{(m+1)}) + f_l^{(m+1)} L$；对 $T$、$f_l$ 和 $h$ 进行欠松弛。\n- 重新计算 $A^{(m+1)} = A(f_l^{(m+1)})$；检查 $\\mathbf{u}$、$T$、$f_l$ 的残差以及焓闭合项 $h - \\left(h_{\\text{sens}}(T) + f_l L\\right)$；如果低于容差，则进入 $n+1$ 时间步。非线性通过在每个 $m$ 循环中将系数中的 $f_l$ 和 $A$ “冻结”并在每次分离求解后更新它们来处理。\n\nB. 数据结构：$T[\\Omega]$、$h[\\Omega]$、$f_l[\\Omega]$、$\\mathbf{u}[\\Omega]$、$p[\\Omega]$。对于每个时间步索引 $n$：根据 $T^{(n-1)}$ 计算一次 $f_l^{(n)}$ 并保持其不变；计算 $A^{(n)} = A(f_l^{(n)})$；求解动量方程，汇项显式地加到右侧；跳过压力修正以节省计算；使用 $\\mathbf{u}^{(n)}$ 求解 $h$ 形式的能量方程，然后设置 $T^{(n)} = h^{(n)}/(\\rho c_p)$；无内部迭代地进入 $n+1$ 时间步。非线性通过每个时间步对 $f_l$ 进行一次显式更新来处理。\n\nC. 数据结构：$h[\\Omega]$、$\\mathbf{u}[\\Omega]$、$p[\\Omega]$、$A[\\Omega]$。对于每个时间步索引 $n$：使用 $f_l = h/L$（并裁剪到 $[0,1]$ 区间）计算 $A(f_l)$；求解动量方程，不对对角线进行 $A$ 的增强，而是在右侧减去 $A(f_l)\\mathbf{u}$；省略压力耦合方程组的半隐式方法（SIMPLE）的压力修正；求解焓方程得到 $h$，并仅在最后通过 $T = h/(\\rho c_p)$ 输出 $T$。非线性通过每个时间步从 $h$ 计算一次 $A$ 来处理。\n\nD. 数据结构：$T[\\Omega]$、$f_l[\\Omega]$、$\\mathbf{u}[\\Omega]$、$p[\\Omega]$、$A[\\Omega]$。对于每个时间步索引 $n$：构建一个耦合 $T$ 和 $\\mathbf{u}$ 的单一整体雅可比系统，其矩阵项包括 $\\partial A/\\partial f_l \\cdot \\partial f_l/\\partial T$；应用牛顿法一次性求解该耦合系统；收敛后更新 $f_l$；不执行分离的动量或能量求解。非线性通过在单一耦合求解内部进行牛顿线性化来处理，而不是通过内部的分离式循环。\n\n选择最合适的选项。",
            "solution": "用户要求对一个关于凝固和熔化问题的焓-多孔介质法数值实现进行严格评估，然后详细分析所提出的算法选项。\n\n### 问题验证\n\n**第1步：提取给定信息**\n\n- **技术**: 焓-多孔介质法的分离式有限体积法 (FVM)。\n- **应用**: 纯物质的凝固/熔化。\n- **控制方程**:\n    - 能量守恒: $\\frac{\\partial (\\rho h)}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u} h) = \\nabla \\cdot (k \\nabla T)$\n    - 动量平衡: $\\rho\\left(\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u}\\right) = -\\nabla p + \\nabla\\cdot\\left(\\mu \\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top}\\right)\\right) - A(f_l)\\, \\mathbf{u}$\n- **本构关系**:\n    - 焓: $h(T,f_l) = h_{\\text{sens}}(T) + f_l L$，其中 $h_{\\text{sens}}(T) = \\int_{T_{\\text{ref}}}^{T} \\rho c_p(\\theta)\\, d\\theta$。\n    - 糊状区汇项系数: $A(f_l) = A_m \\frac{(1 - f_l)^2}{f_l^3 + \\epsilon^3}$，其中 $A(f_l)$ 是非负的，并随着 $f_l \\to 0$ 而增大。\n    - 液相分数: $f_l(T) = \\begin{cases} 0, & T \\le T_s,\\\\ \\frac{T - T_s}{T_l - T_s}, & T_s < T < T_l,\\\\ 1, & T \\ge T_l, \\end{cases}$ 或其可微的正则化形式。\n- **术语**: $h$ (焓), $T$ (温度), $f_l$ (液相分数), $L$ (潜热), $\\rho$ (密度), $k$ (热导率), $c_p$ (比热), $\\mathbf{u}$ (速度), $p$ (压力), $\\mu$ (粘度), $A(f_l)$ (汇项系数)。\n- **求解器要求**:\n    1. 存储网格中心数组。\n    2. 遵循 $h(T,f_l)$ 和 $A(f_l)$ 之间的耦合关系。\n    3. 使用压力耦合方程组的半隐式方法（SIMPLE）来保证质量守恒。\n    4. 在动量矩阵中对糊状区汇项进行半隐式处理。\n    5. 在每个时间步内通过一致的迭代策略处理非线性 ($f_l(T)$, $A(f_l)$)。\n\n**第2步：使用提取的给定信息进行验证**\n\n- **科学基础**: 该问题在计算流体动力学（CFD）和传热学原理方面有坚实的基础。焓-多孔介质模型、控制的纳维-斯托克斯方程和能量方程，以及用于达西汇项的类 Carman-Kozeny 公式都是该领域中标准且成熟的组成部分。\n- **良定性**: 该问题要求根据一组明确定义的物理和数值约束来识别正确的数值算法。在数值方法的背景下，这是一个良定问题。\n- **客观性**: 问题陈述是客观的，使用了精确的技术语言和数学定义。对求解器的要求（分离式、SIMPLE、半隐式汇项）是明确的技术规范。\n\n问题陈述没有科学上的不健全性、歧义和内部矛盾。它提出了一个计算工程领域中标准的、有一定难度的问题。\n\n**第3步：结论与行动**\n\n问题陈述是**有效的**。求解过程将继续推导正确答案并评估所提供的选项。\n\n### 求解与选项分析\n\n该问题的正确算法必须是一个分离式求解器，其中动量、压力修正和能量方程在每个时间步的外部迭代循环中顺序求解。这个循环对于处理变量之间的强非线性耦合是必需的。\n\n1.  **分离式迭代结构**: 在每个时间步内，需要一个迭代过程（例如，由 $m$ 索引的 Picard 循环）。迭代从一个猜测值开始（例如，来自前一个时间步的值，$T^{(0)} = T^n$，$\\mathbf{u}^{(0)} = \\mathbf{u}^n$ 等），并持续进行直到场量收敛。\n\n2.  **动量方程和汇项**: 动量方程包含汇项 $-A(f_l)\\,\\mathbf{u}$。为保证稳定性，需要进行半隐式处理。对于一个通用的控制体 $P$，离散化的动量方程形式为 $a_P \\mathbf{u}_P = \\sum a_{nb} \\mathbf{u}_{nb} + \\mathbf{b}$。在网格单元 $P$ 处离散化的汇项为 $-A_P(f_l)\\,\\mathbf{u}_P$。\n    - 显式处理会将此项添加到源向量 $\\mathbf{b}$ 中，使用前一次迭代的速度：$\\mathbf{b} \\leftarrow \\mathbf{b} - A_P(f_l^{(m)})\\,\\mathbf{u}_P^{(m)}$。当 $A_P$ 很大时，这是不稳定的。\n    - 半隐式处理对源项进行线性化：$S = S_C + S_P \\mathbf{u}_P$。此处，$S_C = 0$ 且 $S_P = -A_P(f_l^{(m)})$。$S_P \\mathbf{u}_P$ 项被移到离散方程的左侧，从而增强主对角线系数：$a_P \\leftarrow a_P - S_P = a_P + A_P(f_l^{(m)})$。这通过在 $A_P$ 很大时（即在固体区域）隐式地抑制速度，显著增强了稳定性。\n\n3.  **压力-速度耦合**: 必须使用 SIMPLE 算法。这包括求解动量方程以获得预测速度场 $\\mathbf{u}^*$，然后求解一个类似泊松方程的压力修正方程得到 $p'$，最后修正速度和压力场以保证质量守恒。\n\n4.  **能量方程和相变**: 能量方程涉及焓 $h$，在相变区间内，焓是温度 $T$ 的非线性函数。\n    - 一种方法是直接求解焓 $h$ 的输运方程。这将得到一个新的焓场 $h^{(m+1)}$。随后，必须对 $h(T)$ 关系进行反算，以找到相应的温度场 $T^{(m+1)}$。这个反算步骤本身就是非线性的。\n    - 另一种常见的、可将问题线性化的方法是使用等效热容求解温度 $T$。从 $h(T) = h_{\\text{sens}}(T) + f_l(T)L$ 出发，我们可以写出 $\\frac{\\partial h}{\\partial t} = \\frac{\\partial h}{\\partial T}\\frac{\\partial T}{\\partial t}$。项 $\\frac{\\partial h}{\\partial T} = \\rho c_p + L \\frac{df_l}{dT}$ 充当等效热容，即 $\\rho c_{\\text{eff}}$。该项在糊状区可能非常大，体现了潜热效应。在数值格式中，$\\frac{df_l}{dT}$ 将使用前一次迭代的温度 $T^{(m)}$ 来评估。\n\n5.  **耦合与更新**: 在迭代循环中，求解主变量（$\\mathbf{u}^{(m+1)}$, $p^{(m+1)}$, $T^{(m+1)}$）之后，所有相关的属性都必须更新。这包括液相分数 $f_l^{(m+1)} = f_l(T^{(m+1)})$、焓 $h^{(m+1)} = h(T^{(m+1)}, f_l^{(m+1)})$ 和动量汇项系数 $A^{(m+1)} = A(f_l^{(m+1)})$。这些更新后的属性随后用于下一次迭代 $m+1$。通常需要对变量进行欠松弛才能获得收敛解。\n\n基于这些原则，我们评估每个选项。\n\n**选项 A 评估**\n\n该选项提出了在每个时间步 $n$ 内的一个分离式迭代循环（关于 $m$ 的 Picard 循环）。\n- **数据结构**: 所列出的网格中心和网格面数组对于一个标准的 FVM 代码是合适的。\n- **动量求解**: 它正确地指明了构建动量矩阵时对角线项“由 $A(f_l^{(m)})$ 增强”，这正是所需的半隐式处理。然后它正确地描述了应用 SIMPLE 算法进行压力修正。提到了欠松弛，这对收敛至关重要。这部分完全正确。\n- **能量求解**: 它建议使用等效热容 $c_{\\text{eff}}^{(m)} = c_p + L \\frac{df_l}{dT}\\big|_{T^{(m)}}$ 来求解温度形式的能量方程。这是一种有效且广泛使用的方法。它正确地指出，对流速度应为新计算出的 $\\mathbf{u}^{(m+1)}$。随后基于新温度 $T^{(m+1)}$ 对 $f_l^{(m+1)}$ 和 $h^{(m+1)}$ 进行的更新步骤是正确的。再次正确地提到了欠松弛。\n- **非线性与收敛**: 它描述了根据更新的 $f_l^{(m+1)}$ 重新计算动量汇项系数 $A^{(m+1)}$，正确地闭合了下一次迭代的循环。收敛性检查包括主变量的残差和“焓闭合”项 $h - (h_{\\text{sens}}(T) + f_l L)$，这是确保热力学一致性的良好实践。关于非线性处理的最终总结（“在每个 $m$ 循环中将系数中的 $f_l$ 和 $A$ ‘冻结’并在每次分离求解后更新它们”）是对分离式 Picard 迭代策略的准确描述。\n\n该选项细致地描述了一个最先进的、稳健的算法，满足了问题陈述的所有要求。\n**结论：正确。**\n\n**选项 B 评估**\n\n该选项概述的算法有几个根本性缺陷。\n- 它以“无内部迭代”的方式进入下一个时间步，违反了“在每个时间步内通过一致的迭代策略”处理强非线性的要求。\n- 它“显式”处理动量汇项，违反了半隐式处理的要求。这在数值上是不稳定的。\n- 它建议“跳过压力修正”，违反了使用 SIMPLE 的要求，并且从根本上未能保证质量守恒。\n- 温度更新公式 $T^{(n)} = h^{(n)}/(\\rho c_p)$ 在物理上是不正确的，因为它完全忽略了潜热 $L$ 和显焓的正确定义。\n- 使用 $T^{(n-1)}$ 计算第 $n$ 步的属性会引入时间滞后，严重降低准确性和稳定性。\n**结论：不正确。**\n\n**选项 C 评估**\n\n该选项与选项 B 有许多相同的缺陷。\n- 关系式 $f_l = h/L$ 在物理上是不正确的；它忽略了显热 $h_{\\text{sens}}$。\n- 动量汇项被显式处理（“在右侧减去 $A(f_l)\\mathbf{u}$”），违反了半隐式要求。\n- 它省略了 SIMPLE 压力修正，未能保证质量守恒。\n- 温度更新公式 $T = h/(\\rho c_p)$ 同样在物理上是不正确的。\n- 该过程缺少在时间步内处理非线性所必需的内部迭代。\n**结论：不正确。**\n\n**选项 D 评估**\n\n该选项描述了一种根本不同类型的求解器。\n- 它建议构建一个“单一整体雅可比系统”并应用牛顿法。这是一个**耦合**求解器，而不是**分离式**求解器。\n- 问题明确要求使用“**分离式**有限体积法”和“**SIMPLE**”算法。SIMPLE 本质上是为分离式求解器设计的算法。单体牛顿求解器和基于 SIMPLE 的分离式求解器是相互排斥的架构选择。\n- 虽然耦合牛顿求解器是解决这些问题的有效方法，但它不是问题陈述中指定的方法。因此，该选项未能满足核心要求。\n**结论：不正确。**\n\n### 结论\n\n选项 A 是唯一准确描述了与问题陈述中所有要求一致的数值算法的选项：一个使用 SIMPLE 算法的分离式 FVM 求解器，对达西汇项进行半隐式处理，并通过一致的迭代策略（Picard 循环）来处理相变的非线性。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "计算科学中的一个关键环节是验证（Verification），即确保程序正确地求解了数学模型。本练习将带您实践一种严谨的代码验证技术——人造解法（Method of Manufactured Solutions, MMS）。通过在一个简化的纯导热熔化问题中应用此方法，您将学习如何系统地评估数值方案的时空精度，从而确保您的代码实现达到了预期的理论精度。",
            "id": "3991284",
            "problem": "考虑在零速度（纯传导）下，焓-孔隙度方法中的一维瞬态相变问题。设空间域为 $x \\in [0,1]$，时间为 $t \\ge 0$。焓形式的能量守恒方程为\n$$\n\\frac{\\partial H}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k \\frac{\\partial T}{\\partial x}\\right) + S(x,t),\n$$\n其中单位体积的焓为\n$$\nH(T) = \\rho \\left(c_p T + L f_L(T)\\right),\n$$\n其中 $\\rho$ 为密度，$c_p$ 为定压比热容，$L$ 为潜热，$k$ 为热导率，$T$ 为温度，$S(x,t)$ 为内部体积热源项。焓-孔隙度方法引入了液相分数 $f_L(T)$，它表示从固相到液相的平滑过渡。在本问题中，$f_L(T)$ 在一个预设的糊状区温度区间内是一个线性斜坡，其形式如下\n$$\nf_L(T) = \\begin{cases}\n0, & T \\le T_m - \\delta,\\\\\n\\dfrac{T - (T_m - \\delta)}{2\\delta}, & T_m - \\delta < T < T_m + \\delta,\\\\\n1, & T \\ge T_m + \\delta,\n\\end{cases}\n$$\n其中 $T_m$ 为熔化温度，$\\delta > 0$ 为糊状区半宽度，两者均为常数。\n\n你将通过执行网格和时间步长加密研究，来评估所选焓方程离散化方案在时间和空间上的精度阶数。此研究使用一个制造解，该解完全保持在糊状区间内，从而使得对于所有的 $x$ 和 $t$，$f_L(T)$ 都处于其线性区域。选择精确温度场\n$$\nT_{\\text{exact}}(x,t) = T_m + A \\sin(\\pi x)\\cos(\\omega t),\n$$\n其中常数 $A$ 和 $\\omega$ 满足 $|A| < \\delta$。在这种情况下，$H(T)$ 是 $T$ 的线性函数，有效热容为常数，\n$$\nc_{\\text{eff}} = \\rho\\left(c_p + \\frac{L}{2\\delta}\\right),\n$$\n从而将控制方程简化为\n$$\nc_{\\text{eff}} \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} + S(x,t).\n$$\n定义源项 $S(x,t)$，使得 $T_{\\text{exact}}(x,t)$ 精确满足上述方程，\n$$\nS(x,t) = c_{\\text{eff}} \\frac{\\partial T_{\\text{exact}}}{\\partial t} - k \\frac{\\partial^2 T_{\\text{exact}}}{\\partial x^2}.\n$$\n施加与精确解一致的狄利克雷边界条件，$T(0,t) = T_{\\text{exact}}(0,t)$ 和 $T(1,t) = T_{\\text{exact}}(1,t)$，以及初始条件 $T(x,0) = T_{\\text{exact}}(x,0)$。\n\n你所选的离散化方案必须在时间上无条件稳定，在空间上二阶精确。在具有 $N_x$ 个内部点和间距 $h = \\frac{1}{N_x+1}$ 的均匀网格上，实现一个从 $t=0$ 到 $t=\\Delta t$ 的大小为 $\\Delta t$ 的单步后向欧拉时间步长，并对空间二阶导数使用二阶中心差分。在 $t=\\Delta t$ 时刻评估数值解，并使用内部节点误差的离散 $L_2$ 范数与 $T_{\\text{exact}}(x,\\Delta t)$ 进行比较，\n$$\n\\|e\\|_2 = \\left(h \\sum_{i=1}^{N_x} \\left[T_i^{\\text{num}}(\\Delta t) - T_{\\text{exact}}(x_i,\\Delta t)\\right]^2\\right)^{1/2},\n$$\n其中 $x_i = i h$，$i = 1,2,\\dots,N_x$。\n\n执行两项加密研究：\n- 空间加密：固定一个足够小的 $\\Delta t$，并为一系列 $N_x$ 值计算 $\\|e\\|_2$。通过对 $\\log(\\|e\\|_2)$ 与 $\\log(h)$ 的关系进行线性拟合，并报告其斜率，来估计空间阶数 $p_x$。\n- 时间加密：固定一个足够精细的空间网格（大的 $N_x$），并为一系列 $\\Delta t$ 值计算 $\\|e\\|_2$。通过对 $\\log(\\|e\\|_2)$ 与 $\\log(\\Delta t)$ 的关系进行线性拟合，并报告其斜率，来估计时间阶数 $p_t$。\n\n所有量均为无量纲。你的程序必须对以下参数集测试套件执行上述操作，每个套件包含一个“理想路径”案例、一个电导率变化案例和一个高频时间边界案例：\n\n- 案例 $1$ (理想路径): $\\rho = 1$, $c_p = 1$, $L = 1$, $\\delta = 0.5$, $k = 1$, $T_m = 0$, $A = 0.2$, $\\omega = 2$。空间加密使用 $N_x \\in \\{32,64,128,256\\}$ 和 $\\Delta t = 10^{-4}$。时间加密使用 $N_x = 512$ 和 $\\Delta t \\in \\{10^{-2}, 5\\cdot 10^{-3}, 2.5\\cdot 10^{-3}, 1.25\\cdot 10^{-3}\\}$。\n- 案例 $2$ (电导率变化): $\\rho = 1$, $c_p = 1$, $L = 2$, $\\delta = 0.6$, $k = 0.1$, $T_m = 0$, $A = 0.3$, $\\omega = 3$。空间加密使用 $N_x \\in \\{32,64,128,256\\}$ 和 $\\Delta t = 10^{-4}$。时间加密使用 $N_x = 512$ 和 $\\Delta t \\in \\{10^{-2}, 5\\cdot 10^{-3}, 2.5\\cdot 10^{-3}, 1.25\\cdot 10^{-3}\\}$。\n- 案例 $3$ (高频边界案例): $\\rho = 1$, $c_p = 1$, $L = 1$, $\\delta = 0.3$, $k = 1$, $T_m = 0$, $A = 0.25$, $\\omega = 10$。空间加密使用 $N_x \\in \\{32,64,128,256\\}$ 和 $\\Delta t = 10^{-4}$。时间加密使用 $N_x = 512$ 和 $\\Delta t \\in \\{10^{-2}, 5\\cdot 10^{-3}, 2.5\\cdot 10^{-3}, 1.25\\cdot 10^{-3}\\}$。\n\n你的程序应为每个案例计算估计的阶数对 $(p_x, p_t)$，结果为浮点数。最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表，其中按顺序包含六个结果 $[p_{x,1}, p_{t,1}, p_{x,2}, p_{t,2}, p_{x,3}, p_{t,3}]$，下标表示案例编号。将这六个数字表示为无量纲单位的十进制浮点数。不应打印任何其他文本。角度单位不适用于本问题。",
            "solution": "该问题要求使用焓-孔隙度方法，实现一个带相变的一维瞬态热传导问题的数值解。目标是使用制造解方法（MMS）验证所选数值方案的精度阶数。\n\n通过选择一个完全处于糊状（相变）区间内的制造温度场 $T_{\\text{exact}}(x,t)$，该问题得以简化。在此区间内，液相分数 $f_L(T)$ 是温度 $T$ 的线性函数。\n焓 $H(T) = \\rho (c_p T + L f_L(T))$ 由下式给出\n$$H(T) = \\rho \\left( c_p T + L \\frac{T - (T_m - \\delta)}{2\\delta} \\right)$$\n其中 $\\rho$ 是密度，$c_p$ 是比热，$L$ 是潜热，$T_m$ 是熔化温度，$\\delta$ 是糊状区的半宽度。\n控制能量方程为 $\\frac{\\partial H}{\\partial t} = \\frac{\\partial}{\\partial x}(k \\frac{\\partial T}{\\partial x}) + S(x,t)$。由于 $H$ 是 $T$ 的线性函数，我们可以写作 $\\frac{\\partial H}{\\partial t} = \\frac{dH}{dT} \\frac{\\partial T}{\\partial t}$。项 $\\frac{dH}{dT}$ 是有效热容 $c_{\\text{eff}}$，它在此区域内是常数：\n$$c_{\\text{eff}} = \\frac{dH}{dT} = \\rho \\left(c_p + \\frac{L}{2\\delta}\\right)$$\n假设热导率 $k$ 为常数，控制方程简化为线性热方程：\n$$c_{\\text{eff}} \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} + S(x,t)$$\n制造解为 $T_{\\text{exact}}(x,t) = T_m + A \\sin(\\pi x)\\cos(\\omega t)$。为确保此函数是一个精确解，源项 $S(x,t)$ 定义为：\n$$S(x,t) = c_{\\text{eff}} \\frac{\\partial T_{\\text{exact}}}{\\partial t} - k \\frac{\\partial^2 T_{\\text{exact}}}{\\partial x^2}$$\n$T_{\\text{exact}}$ 所需的偏导数为：\n$$\\frac{\\partial T_{\\text{exact}}}{\\partial t} = -A\\omega \\sin(\\pi x)\\sin(\\omega t)$$\n$$\\frac{\\partial^2 T_{\\text{exact}}}{\\partial x^2} = -A\\pi^2 \\sin(\\pi x)\\cos(\\omega t)$$\n将这些代入 $S(x,t)$ 的表达式中，得到：\n$$S(x,t) = A\\sin(\\pi x) \\left( k\\pi^2\\cos(\\omega t) - c_{\\text{eff}}\\omega\\sin(\\omega t) \\right)$$\n该问题在一个具有 $N_x$ 个内部点 $x_i = ih$（$i=1, \\dots, N_x$）的均匀网格上求解，其中 $h=1/(N_x+1)$。我们将从 $t_0=0$ 的初始条件开始，计算在时间 $t_1 = \\Delta t$ 时的解。设 $T_i^n$ 表示 $T(x_i, t_n)$ 的数值近似值。\n\n指定的离散化方案是时间上的一阶精确后向欧拉法和空间上的二阶中心差分法。在节点 $i$ 和时间 $t_1$ 的完全离散方程为：\n$$c_{\\text{eff}} \\frac{T_i^1 - T_i^0}{\\Delta t} = k \\frac{T_{i-1}^1 - 2T_i^1 + T_{i+1}^1}{h^2} + S_i^1$$\n其中 $T_i^0 = T_{\\text{exact}}(x_i, 0)$ 且 $S_i^1 = S(x_i, \\Delta t)$。重新排列各项，将未知数 $T_i^1$ 组合到左侧，得到一个线性方程组：\n$$-\\frac{k}{h^2} T_{i-1}^1 + \\left(\\frac{c_{\\text{eff}}}{\\Delta t} + \\frac{2k}{h^2}\\right) T_i^1 - \\frac{k}{h^2} T_{i+1}^1 = \\frac{c_{\\text{eff}}}{\\Delta t} T_i^0 + S_i^1$$\n该系统对内部节点 $i=1, \\dots, N_x$ 成立。它可以写成矩阵形式 $\\mathbf{M}\\mathbf{T}^1 = \\mathbf{b}$，其中 $\\mathbf{T}^1$ 是内部节点未知温度的向量。矩阵 $\\mathbf{M}$ 是一个对称三对角的 $N_x \\times N_x$ 矩阵，其元素为：\n$$\n\\mathbf{M}_{ij} = \\begin{cases}\n\\frac{c_{\\text{eff}}}{\\Delta t} + \\frac{2k}{h^2} & \\text{if } i=j \\\\\n-\\frac{k}{h^2} & \\text{if } |i-j|=1 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n右侧向量 $\\mathbf{b}$ 包含了初始条件和边界条件。狄利克雷边界条件为 $T(0,t) = T_{\\text{exact}}(0,t) = T_m$ 和 $T(1,t) = T_{\\text{exact}}(1,t) = T_m$。$\\mathbf{b}$ 的分量为：\n$$b_1 = \\frac{c_{\\text{eff}}}{\\Delta t} T_1^0 + S_1^1 + \\frac{k}{h^2}T_m$$\n$$b_i = \\frac{c_{\\text{eff}}}{\\Delta t} T_i^0 + S_i^1 \\quad \\text{for } i=2, \\dots, N_x-1$$\n$$b_{N_x} = \\frac{c_{\\text{eff}}}{\\Delta t} T_{N_x}^0 + S_{N_x}^1 + \\frac{k}{h^2}T_m$$\n求解此线性系统以得到 $\\mathbf{T}^1$。数值误差通过内部节点的离散 $L_2$ 范数进行量化：\n$$\\|e\\|_2 = \\left(h \\sum_{i=1}^{N_x} \\left[T_i^1 - T_{\\text{exact}}(x_i, \\Delta t)\\right]^2\\right)^{1/2}$$\n数值精度阶数，$p_x$（空间）和 $p_t$（时间），通过加密研究确定。误差预计遵循 $\\|e\\|_2 \\approx C_x h^{p_x} + C_t (\\Delta t)^{p_t}$。\n- 对于空间加密，$\\Delta t$ 固定在一个较小的值，使得空间误差占主导地位：$\\|e\\|_2 \\approx C_x h^{p_x}$。取对数，$\\log(\\|e\\|_2) \\approx \\log(C_x) + p_x\\log(h)$。$p_x$ 是通过对 $\\log(\\|e\\|_2)$ 与 $\\log(h)$ 的关系进行线性拟合得到的斜率。我们期望 $p_x \\approx 2$。\n- 对于时间加密，$h$ 固定在一个较小的值（大的 $N_x$），使得时间误差占主导地位：$\\|e\\|_2 \\approx C_t (\\Delta t)^{p_t}$。取对数，$\\log(\\|e\\|_2) \\approx \\log(C_t) + p_t\\log(\\Delta t)$。$p_t$ 是通过对 $\\log(\\|e\\|_2)$ 与 $\\log(\\Delta t)$ 的关系进行线性拟合得到的斜率。我们期望 $p_t \\approx 1$。\n\n程序将对给定的三个测试案例中的每一个执行这两项研究。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the refinement studies for all test cases.\n    \"\"\"\n\n    def solve_one_case(params, spatial_ref_params, temporal_ref_params):\n        \"\"\"\n        Performs spatial and temporal refinement studies for a single parameter case.\n\n        Args:\n            params (tuple): Physical and analytical parameters for the case.\n            spatial_ref_params (dict): Parameters for the spatial refinement study.\n            temporal_ref_params (dict): Parameters for the temporal refinement study.\n\n        Returns:\n            tuple: A tuple containing the estimated spatial order (p_x) and\n                   temporal order (p_t).\n        \"\"\"\n        rho, c_p, L, delta, k, Tm, A, omega = params\n        c_eff = rho * (c_p + L / (2 * delta))\n\n        # --- Analytical and Source Functions ---\n        def T_exact(x, t):\n            return Tm + A * np.sin(np.pi * x) * np.cos(omega * t)\n\n        def S_source(x, t):\n            dT_dt = -A * omega * np.sin(np.pi * x) * np.sin(omega * t)\n            d2T_dx2 = -A * np.pi**2 * np.sin(np.pi * x) * np.cos(omega * t)\n            return c_eff * dT_dt - k * d2T_dx2\n\n        def compute_numerical_solution(Nx, dt):\n            \"\"\"\n            Solves the linear system for one time step and returns the L2 error.\n            \"\"\"\n            h = 1.0 / (Nx + 1)\n            x_interior = np.linspace(h, 1.0 - h, Nx)\n\n            # Initial and source terms\n            T0 = T_exact(x_interior, 0.0)\n            S1 = S_source(x_interior, dt)\n            \n            # Boundary conditions at t=dt. T_exact is Tm at x=0 and x=1.\n            T_bc_val = Tm\n\n            # Assemble the linear system M * T1 = b\n            main_diag_val = c_eff / dt + 2 * k / h**2\n            off_diag_val = -k / h**2\n            \n            M = np.diag(np.full(Nx, main_diag_val)) + \\\n                np.diag(np.full(Nx - 1, off_diag_val), k=1) + \\\n                np.diag(np.full(Nx - 1, off_diag_val), k=-1)\n            \n            b = (c_eff / dt) * T0 + S1\n            b[0] -= off_diag_val * T_bc_val\n            b[-1] -= off_diag_val * T_bc_val\n\n            # Solve for T1\n            T1_num = np.linalg.solve(M, b)\n\n            # Calculate L2 error norm\n            T1_exact = T_exact(x_interior, dt)\n            error_vec = T1_num - T1_exact\n            l2_error = np.sqrt(h * np.sum(error_vec**2))\n            \n            return l2_error\n\n        # --- Spatial Refinement Study ---\n        Nx_list = spatial_ref_params[\"Nx_list\"]\n        dt_spatial = spatial_ref_params[\"dt\"]\n        \n        h_values = [1.0 / (Nx + 1) for Nx in Nx_list]\n        errors_spatial = [compute_numerical_solution(Nx, dt_spatial) for Nx in Nx_list]\n        \n        log_h = np.log(h_values)\n        log_errors_spatial = np.log(errors_spatial)\n        p_x = np.polyfit(log_h, log_errors_spatial, 1)[0]\n        \n        # --- Temporal Refinement Study ---\n        Nx_temporal = temporal_ref_params[\"Nx\"]\n        dt_list = temporal_ref_params[\"dt_list\"]\n\n        errors_temporal = [compute_numerical_solution(Nx_temporal, dt) for dt in dt_list]\n        \n        log_dt = np.log(dt_list)\n        log_errors_temporal = np.log(errors_temporal)\n        p_t = np.polyfit(log_dt, log_errors_temporal, 1)[0]\n\n        return p_x, p_t\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (rho, c_p, L, delta, k, Tm, A, omega)\n        (1.0, 1.0, 1.0, 0.5, 1.0, 0.0, 0.2, 2.0),\n        # Case 2\n        (1.0, 1.0, 2.0, 0.6, 0.1, 0.0, 0.3, 3.0),\n        # Case 3\n        (1.0, 1.0, 1.0, 0.3, 1.0, 0.0, 0.25, 10.0),\n    ]\n\n    # Shared refinement parameters for all cases\n    spatial_ref_params = {\n        \"Nx_list\": [32, 64, 128, 256],\n        \"dt\": 1e-4\n    }\n    temporal_ref_params = {\n        \"Nx\": 512,\n        \"dt_list\": [1e-2, 5e-3, 2.5e-3, 1.25e-3]\n    }\n    \n    results = []\n    for params in test_cases:\n        p_x, p_t = solve_one_case(params, spatial_ref_params, temporal_ref_params)\n        results.extend([p_x, p_t])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}