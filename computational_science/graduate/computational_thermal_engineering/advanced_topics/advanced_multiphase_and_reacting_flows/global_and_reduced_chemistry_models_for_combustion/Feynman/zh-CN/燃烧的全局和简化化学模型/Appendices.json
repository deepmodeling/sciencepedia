{
    "hands_on_practices": [
        {
            "introduction": "层流火焰速度（$S_L$）是预混燃烧的一个基本属性，其建模对于燃烧器的设计和安全分析至关重要。本练习  基于反应-扩散平衡的标度律，指导您通过计算来比较单步全局模型和包含一氧化碳（$\\text{CO}$）生成的两步全局模型对层流火焰速度的预测。通过这个实践，您将亲身体会到增加模型的化学保真度如何影响模型在不同当量比下的预测准确性。",
            "id": "3957666",
            "problem": "您需要设计并实现一个基于燃烧理论和反应-扩散平衡的计算实验，以比较两种用于预混甲烷-空气燃烧的全局化学模型对层流火焰速度的预测：一个单步全局模型和一个明确包含一氧化碳（$\\text{CO}$）生成与氧化的两步全局模型。目标是计算在一系列当量比下，这两种模型之间的相对误差。\n\n从平面、一维、预混层流火焰的反应-扩散平衡出发，该平衡为层流火焰速度提供了一个基于热扩散率和特征化学时间的标度。具体来说，将层流火焰速度定义为\n$$\nS_L = \\sqrt{\\frac{\\alpha}{\\tau_{\\mathrm{ch}}}},\n$$\n其中$\\alpha$是未燃混合物的热扩散率，$\\tau_{\\mathrm{ch}}$是导致热释放的主要化学过程的特征化学时间。\n\n将大气条件下空气-甲烷未燃混合物的属性定义如下：\n- 热导率$k = 0.026 \\,\\mathrm{W/(m\\cdot K)}$，\n- 密度$\\rho = 1.2 \\,\\mathrm{kg/m^3}$，\n- 恒压比热$c_p = 1000 \\,\\mathrm{J/(kg\\cdot K)}$，\n- 热扩散率$\\alpha = \\frac{k}{\\rho c_p}$，\n- 通用气体常数$R_u = 8.314 \\,\\mathrm{J/(mol\\cdot K)}$，\n- 有效反应区温度$T_r = 1800 \\,\\mathrm{K}$（用于阿伦尼乌斯因子），\n- 空气中氧气的质量分数$Y_{O_2,\\mathrm{air}} = 0.232$，\n- 甲烷-空气的化学计量空燃质量比$s = 17.24$。\n\n对于给定的当量比$\\phi$，通过质量定义预混组分，其为甲烷燃料和空气的混合物，总混合物质量归一化为$1 \\,\\mathrm{kg}$。燃料质量$m_f(\\phi)$和空气质量$m_{\\mathrm{air}}(\\phi)$由当量比的定义确定：\n$$\n\\frac{m_f(\\phi)}{m_{\\mathrm{air}}(\\phi)} = \\frac{\\phi}{s}, \\quad m_f(\\phi) + m_{\\mathrm{air}}(\\phi) = 1,\n$$\n由此得出\n$$\nm_f(\\phi) = \\frac{1}{1 + \\frac{s}{\\phi}}, \\quad m_{\\mathrm{air}}(\\phi) = \\frac{\\frac{s}{\\phi}}{1 + \\frac{s}{\\phi}}.\n$$\n由此，未燃混合物中燃料的质量分数和氧气的质量分数为\n$$\nY_F(\\phi) = m_f(\\phi), \\quad Y_{O_2}(\\phi) = Y_{O_2,\\mathrm{air}}\\, m_{\\mathrm{air}}(\\phi).\n$$\n\n使用阿伦尼乌斯型速率依赖性来模拟单步全局模型的特征化学时间。设单步速率由一个指前因子、一个活化能以及对反应物质量分数的幂律依赖性来近似：\n$$\n\\tau_1(\\phi) = \\left[A_1 \\exp\\left(-\\frac{E_1}{R_u T_r}\\right) \\, Y_F(\\phi)^{a_1} \\, Y_{O_2}(\\phi)^{b_1}\\right]^{-1}.\n$$\n该模型的参数定义为$A_1 = 1.0 \\times 10^8 \\,\\mathrm{s^{-1}}$，$E_1 = 8.0 \\times 10^4 \\,\\mathrm{J/mol}$，$a_1 = 1.0$和$b_1 = 0.5$。相应的层流火焰速度预测值为\n$$\nS_{L,1}(\\phi) = \\sqrt{\\frac{\\alpha}{\\tau_1(\\phi)}}.\n$$\n\n对于包含$\\text{CO}$生成和氧化的两步全局模型，将化学反应表示为两个串联步骤：燃料到$\\text{CO}$和$\\text{CO}$到二氧化碳。第一步使用与上述相同的形式和参数建模，贡献一个时间$\\tau_1(\\phi)$。第二步使用具有其自身参数的阿伦尼乌斯速率，并依赖于$\\text{CO}$质量分数和氧气质量分数：\n$$\n\\tau_2(\\phi) = \\left[A_2 \\exp\\left(-\\frac{E_2}{R_u T_r}\\right) \\, Y_{CO}(\\phi)^{\\gamma} \\, Y_{O_2}(\\phi)^{\\delta}\\right]^{-1}.\n$$\n取$A_2 = 5.0 \\times 10^7 \\,\\mathrm{s^{-1}}$，$E_2 = 6.0 \\times 10^4 \\,\\mathrm{J/mol}$，$\\gamma = 1.0$和$\\delta = 1.0$。通过一个平滑的、依赖于当量比的分支分数来近似一氧化碳的质量分数$Y_{CO}(\\phi)$，该分数捕捉了$\\text{CO}$的生成对于贫燃混合物可忽略不计而对于富燃混合物则显著的趋势：\n$$\n\\eta(\\phi) = \\tfrac{1}{2}\\left[1 + \\tanh\\left(\\kappa\\, (\\phi - 1)\\right)\\right], \\quad \\kappa = 4.0,\n$$\n以及\n$$\nY_{CO}(\\phi) = \\eta(\\phi)\\, Y_F(\\phi).\n$$\n因为这两个步骤是串联发生的，并且只有一部分碳通量$\\eta(\\phi)$通过$\\text{CO}$氧化路径，所以将净化学时间建模为\n$$\n\\tau_{\\mathrm{chain}}(\\phi) = \\tau_1(\\phi) + \\eta(\\phi)\\, \\tau_2(\\phi),\n$$\n两步层流火焰速度为\n$$\nS_{L,2}(\\phi) = \\sqrt{\\frac{\\alpha}{\\tau_{\\mathrm{chain}}(\\phi)}}.\n$$\n\n为保证数值稳健性，将进入速率定律的任何计算出的质量分数若小于$10^{-12}$，则按$10^{-12}$处理，以避免除以零或未定义的行为。速度必须以米/秒为单位计算。\n\n定义单步模型和两步模型之间的相对误差，以两步模型为参考，如下：\n$$\n\\varepsilon(\\phi) = \\frac{\\left|S_{L,1}(\\phi) - S_{L,2}(\\phi)\\right|}{S_{L,2}(\\phi)}.\n$$\n\n实现一个程序，为以下当量比测试套件计算$\\varepsilon(\\phi)$：\n$$\n\\phi \\in \\{0.6,\\, 0.8,\\, 0.9,\\, 1.0,\\, 1.2,\\, 1.4,\\, 1.5,\\, 1.6\\}.\n$$\n\n最终输出格式必须是仅包含一行的、由方括号括起来的逗号分隔列表，其中每个条目等于$\\varepsilon(\\phi)$并四舍五入到五位小数（无量纲小数）。例如，输出必须看起来像\n$$\n[\\varepsilon(0.6),\\varepsilon(0.8),\\ldots,\\varepsilon(1.6)].\n$$\n不应打印任何其他文本。在内部，所有层流火焰速度必须以$\\mathrm{m/s}$为单位计算。",
            "solution": "该问题陈述是化学工程领域，特别是燃烧建模领域中一个有效的计算练习。所有参数都已提供，物理和化学模型定义清晰，目标明确。该问题具有科学依据，内容自洽，且提法得当。因此，我们可以着手求解。\n\n目标是计算在一系列当量比$\\phi$下，一个单步和一个两步全局化学模型对预混甲烷-空气燃烧的层流火焰速度预测值之间的相对误差。层流火焰速度$S_L$使用从反应-扩散平衡导出的标度律进行估算。\n\n首先，我们定义所提供的未燃混合物的物理常数和性质。\n- 热导率：$k = 0.026 \\,\\mathrm{W/(m\\cdot K)}$\n- 密度：$\\rho = 1.2 \\,\\mathrm{kg/m^3}$\n- 恒压比热：$c_p = 1000 \\,\\mathrm{J/(kg\\cdot K)}$\n- 通用气体常数：$R_u = 8.314 \\,\\mathrm{J/(mol\\cdot K)}$\n- 化学计量空燃质量比：$s = 17.24$\n- 空气中氧气的质量分数：$Y_{O_2,\\mathrm{air}} = 0.232$\n\n根据这些，计算热扩散率$\\alpha$。在本问题中它是一个常数。\n$$\n\\alpha = \\frac{k}{\\rho c_p} = \\frac{0.026 \\,\\mathrm{W/(m\\cdot K)}}{(1.2 \\,\\mathrm{kg/m^3}) \\cdot (1000 \\,\\mathrm{J/(kg\\cdot K)})} = \\frac{0.026}{1200} \\,\\mathrm{m^2/s} \\approx 2.1667 \\times 10^{-5} \\,\\mathrm{m^2/s}\n$$\n\n将在给定的一组当量比$\\phi \\in \\{0.6,\\, 0.8,\\, 0.9,\\, 1.0,\\, 1.2,\\, 1.4,\\, 1.5,\\, 1.6\\}$下进行分析。对于每个$\\phi$，我们必须首先确定未燃混合物中燃料的质量分数$Y_F(\\phi)$和氧气的质量分数$Y_{O_2}(\\phi)$。在$1 \\,\\mathrm{kg}$混合物中，燃料质量$m_f(\\phi)$和空气质量$m_{\\mathrm{air}}(\\phi)$由以下公式给出：\n$$\nm_f(\\phi) = \\frac{1}{1 + \\frac{s}{\\phi}}\n$$\n$$\nm_{\\mathrm{air}}(\\phi) = 1 - m_f(\\phi) = \\frac{\\frac{s}{\\phi}}{1 + \\frac{s}{\\phi}}\n$$\n相应的质量分数为：\n$$\nY_F(\\phi) = m_f(\\phi)\n$$\n$$\nY_{O_2}(\\phi) = Y_{O_2,\\mathrm{air}} \\cdot m_{\\mathrm{air}}(\\phi) = 0.232 \\cdot m_{\\mathrm{air}}(\\phi)\n$$\n\n接下来，我们评估单步模型。特征化学时间$\\tau_1(\\phi)$由阿伦尼乌斯型速率定律定义：\n$$\n\\tau_1(\\phi) = \\left[A_1 \\exp\\left(-\\frac{E_1}{R_u T_r}\\right) \\, Y_F(\\phi)^{a_1} \\, Y_{O_2}(\\phi)^{b_1}\\right]^{-1}\n$$\n该模型的参数为：\n- 指前因子：$A_1 = 1.0 \\times 10^8 \\,\\mathrm{s^{-1}}$\n- 活化能：$E_1 = 8.0 \\times 10^4 \\,\\mathrm{J/mol}$\n- 有效反应区温度：$T_r = 1800 \\,\\mathrm{K}$\n- 指数：$a_1 = 1.0$, $b_1 = 0.5$\n\n指数的参数是一个常数：\n$$\n-\\frac{E_1}{R_u T_r} = -\\frac{8.0 \\times 10^4}{8.314 \\cdot 1800} \\approx -5.344\n$$\n在将质量分数$Y_F(\\phi)$和$Y_{O_2}(\\phi)$用于速率表达式之前，对其应用$10^{-12}$的数值下限，以确保数值稳定性。单步模型的层流火焰速度$S_{L,1}(\\phi)$则为：\n$$\nS_{L,1}(\\phi) = \\sqrt{\\frac{\\alpha}{\\tau_1(\\phi)}} = \\sqrt{\\alpha \\cdot A_1 \\exp\\left(-\\frac{E_1}{R_u T_r}\\right) \\, Y_F(\\phi)^{a_1} \\, Y_{O_2}(\\phi)^{b_1}}\n$$\n\n随后，我们评估两步模型。该模型引入了一氧化碳（$\\text{CO}$）氧化步骤。总化学时间被建模为两个串联过程的和。第一个时间$\\tau_1(\\phi)$与单步模型的相同。第二个时间$\\tau_2(\\phi)$对应于$\\text{CO}$氧化。\n首先，我们使用一个依赖于当量比的分支分数$\\eta(\\phi)$来模拟$\\text{CO}$的质量分数$Y_{CO}(\\phi)$：\n$$\n\\eta(\\phi) = \\tfrac{1}{2}\\left[1 + \\tanh\\left(\\kappa\\, (\\phi - 1)\\right)\\right], \\quad \\kappa = 4.0\n$$\n$$\nY_{CO}(\\phi) = \\eta(\\phi) \\cdot Y_F(\\phi)\n$$\n第二步的特征时间$\\tau_2(\\phi)$为：\n$$\n\\tau_2(\\phi) = \\left[A_2 \\exp\\left(-\\frac{E_2}{R_u T_r}\\right) \\, Y_{CO}(\\phi)^{\\gamma} \\, Y_{O_2}(\\phi)^{\\delta}\\right]^{-1}\n$$\n这第二步的参数为：\n- 指前因子：$A_2 = 5.0 \\times 10^7 \\,\\mathrm{s^{-1}}$\n- 活化能：$E_2 = 6.0 \\times 10^4 \\,\\mathrm{J/mol}$\n- 指数：$\\gamma = 1.0$, $\\delta = 1.0$\n\n第二个指数的参数也是常数：\n$$\n-\\frac{E_2}{R_u T_r} = -\\frac{6.0 \\times 10^4}{8.314 \\cdot 1800} \\approx -4.008\n$$\n同样，对质量分数$Y_{CO}(\\phi)$和$Y_{O_2}(\\phi)$设置$10^{-12}$的下限。两步模型的净化学时间是一个加权和：\n$$\n\\tau_{\\mathrm{chain}}(\\phi) = \\tau_1(\\phi) + \\eta(\\phi) \\cdot \\tau_2(\\phi)\n$$\n两步模型的火焰速度$S_{L,2}(\\phi)$则为：\n$$\nS_{L,2}(\\phi) = \\sqrt{\\frac{\\alpha}{\\tau_{\\mathrm{chain}}(\\phi)}}\n$$\n\n最后，我们计算两种模型之间的相对误差$\\varepsilon(\\phi)$，其中两步模型作为参考值。\n$$\n\\varepsilon(\\phi) = \\frac{\\left|S_{L,1}(\\phi) - S_{L,2}(\\phi)\\right|}{S_{L,2}(\\phi)}\n$$\n\n计算算法通过遍历每个指定的$\\phi$值来进行，计算$Y_F(\\phi)$、$Y_{O_2}(\\phi)$、$S_{L,1}(\\phi)$、$S_{L,2}(\\phi)$，最后计算$\\varepsilon(\\phi)$。将得到的$\\varepsilon(\\phi)$值收集起来并按指定格式输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative error in laminar flame speed predictions between\n    a one-step and a two-step global chemistry model for methane-air combustion.\n    \"\"\"\n\n    # --- Define constants and physical properties ---\n    k = 0.026         # Thermal conductivity [W/(m.K)]\n    rho = 1.2         # Density [kg/m^3]\n    cp = 1000.0       # Specific heat [J/(kg.K)]\n    Ru = 8.314        # Universal gas constant [J/(mol.K)]\n    Tr = 1800.0       # Effective reaction-zone temperature [K]\n    Y_O2_air = 0.232  # Oxygen mass fraction in air\n    s = 17.24         # Stoichiometric air-to-fuel mass ratio for methane\n\n    # --- Parameters for the one-step model (Step 1) ---\n    A1 = 1.0e8        # Pre-exponential factor [1/s]\n    E1 = 8.0e4        # Activation energy [J/mol]\n    a1 = 1.0          # Fuel mass fraction exponent\n    b1 = 0.5          # Oxygen mass fraction exponent\n\n    # --- Parameters for the two-step model (Step 2) ---\n    A2 = 5.0e7        # Pre-exponential factor [1/s]\n    E2 = 6.0e4        # Activation energy [J/mol]\n    gamma = 1.0       # CO mass fraction exponent\n    delta = 1.0       # Oxygen mass fraction exponent\n    kappa = 4.0       # tanh parameter for branching fraction\n\n    # --- Numerical floor for mass fractions ---\n    mass_fraction_floor = 1.0e-12\n    \n    # --- Test suite of equivalence ratios ---\n    phi_values = [0.6, 0.8, 0.9, 1.0, 1.2, 1.4, 1.5, 1.6]\n    \n    # --- Pre-calculate constant values ---\n    alpha = k / (rho * cp)  # Thermal diffusivity [m^2/s]\n    exp_term1 = np.exp(-E1 / (Ru * Tr))\n    exp_term2 = np.exp(-E2 / (Ru * Tr))\n    \n    results = []\n\n    # --- Iterate through each equivalence ratio ---\n    for phi in phi_values:\n        # --- Composition Calculation ---\n        # Avoid division by zero if phi is 0, though not in the test set.\n        if phi == 0:\n            m_f = 0.0\n        else:\n            m_f = 1.0 / (1.0 + s / phi)\n        m_air = 1.0 - m_f\n\n        Y_F = m_f\n        Y_O2 = Y_O2_air * m_air\n        \n        # Apply numerical floor\n        Y_F_eff = max(Y_F, mass_fraction_floor)\n        Y_O2_eff = max(Y_O2, mass_fraction_floor)\n\n        # --- One-Step Model Calculation ---\n        # Calculate inverse chemical time (rate) for step 1\n        rate1 = A1 * exp_term1 * (Y_F_eff ** a1) * (Y_O2_eff ** b1)\n        tau1 = 1.0 / rate1\n        \n        # Flame speed for one-step model\n        S_L1 = np.sqrt(alpha / tau1)\n\n        # --- Two-Step Model Calculation ---\n        # Branching fraction for CO formation\n        eta = 0.5 * (1.0 + np.tanh(kappa * (phi - 1.0)))\n        \n        # CO mass fraction\n        Y_CO = eta * Y_F\n        Y_CO_eff = max(Y_CO, mass_fraction_floor)\n\n        # Calculate inverse chemical time (rate) for step 2\n        rate2 = A2 * exp_term2 * (Y_CO_eff ** gamma) * (Y_O2_eff ** delta)\n        tau2 = 1.0 / rate2\n        \n        # Net chemical time for the chain reaction\n        tau_chain = tau1 + eta * tau2\n        \n        # Flame speed for two-step model\n        S_L2 = np.sqrt(alpha / tau_chain)\n\n        # --- Relative Error Calculation ---\n        if S_L2 == 0:\n            # Handle potential division by zero, although unlikely here\n            relative_error = 0.0 if S_L1 == 0.0 else float('inf')\n        else:\n            relative_error = np.abs(S_L1 - S_L2) / S_L2\n            \n        results.append(relative_error)\n\n    # --- Format and print the final output ---\n    formatted_results = [f\"{r:.5f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```"
        },
        {
            "introduction": "全局和简化化学模型的一个关键应用是预测污染物（如一氧化碳 $\\text{CO}$）的生成，这对于设计清洁高效的燃烧系统至关重要。本练习  模拟了一个理想搅拌反应器（PSR）中的化学反应过程，要求您通过数值积分来追踪不同组分的浓度演化。通过对比单步模型和两步模型的 $\\text{CO}$ 预测结果，您将深刻理解为何最简单的全局模型无法预测中间产物，以及为何在简化机理中必须保留关键的污染物生成路径。",
            "id": "3957688",
            "problem": "考虑一个等温、等压、完全搅拌的反应器（Perfectly Stirred Reactor (PSR)），其中包含一个初始充分混合、模型化为理想气体的化学计量甲烷-空气混合物。目标是通过将一个两步全局简化化学模型与一个单步全局燃烧模型进行比较，来评估包含一个显式全局一氧化碳（$\\text{CO}$）氧化步骤对预测的一氧化碳排放量的影响。您编写的程序必须在指定的停留时间内对物种摩尔分数的演化进行数值积分，并返回每个测试案例中两种模型出口处一氧化碳摩尔分数的差异。\n\n使用的基本原理包括理想气体定律、质量作用动力学和 Arrhenius 温度依赖性。\n\n使用以下物理和化学设置：\n\n- 理想气体定律：总摩尔浓度定义为 $$C_{\\text{tot}} = \\frac{P}{RT}\\,,$$ 其中 $P$ 是压力，$T$ 是温度，$R$ 是理想气体常数。\n- 理想气体常数：$$R = 8.314462618 \\ \\text{J} \\ \\text{mol}^{-1} \\ \\text{K}^{-1}.$$\n- 追踪的物种：甲烷 ($\\text{CH}_4$)、氧气 ($\\text{O}_2$)、一氧化碳 ($\\text{CO}$)、二氧化碳 ($\\text{CO}_2$)、水 ($\\text{H}_2\\text{O}$)、氮气 ($\\text{N}_2$)。\n- 初始混合物组成（$t=0$ 时的化学计量甲烷-空气混合物）：$n_{\\text{CH}_4} = 1$, $n_{\\text{O}_2} = 2$, $n_{\\text{N}_2} = \\frac{79}{21} \\cdot 2$，以及 $n_{\\text{CO}} = 0$, $n_{\\text{CO}_2} = 0$, $n_{\\text{H}_2\\text{O}} = 0$。初始摩尔分数为 $$x_i(0) = \\frac{n_i}{\\sum_j n_j}\\,.$$\n\n两个全局反应模型：\n\n1. 单步全局模型（不可逆）：\n   $$\\text{CH}_4 + 2 \\ \\text{O}_2 \\rightarrow \\text{CO}_2 + 2 \\ \\text{H}_2\\text{O}.$$\n   反应进程速率为 $$\\mathcal{R}_A = k_A C_{\\text{CH}_4} C_{\\text{O}_2}^2,$$ 其中 $$k_A = A_A \\exp\\left(-\\frac{E_A}{RT}\\right).$$\n   Arrhenius 参数：$$A_A = 1.0 \\times 10^{7}, \\quad E_A = 1.5 \\times 10^{5} \\ \\text{J} \\ \\text{mol}^{-1}.$$\n   物种 $[\\text{CH}_4,\\text{O}_2,\\text{CO},\\text{CO}_2,\\text{H}_2\\text{O},\\text{N}_2]$ 的化学计量系数为 $$\\nu_A = [-1, -2, 0, +1, +2, 0], \\quad \\Delta \\nu_A = \\sum_i \\nu_{A,i} = 0.$$\n\n2. 两步简化化学模型（不可逆全局步骤）：\n   步骤 1：$$\\text{CH}_4 + 1.5 \\ \\text{O}_2 \\rightarrow \\text{CO} + 2 \\ \\text{H}_2\\text{O},$$ 其中 $$\\mathcal{R}_1 = k_1 C_{\\text{CH}_4} C_{\\text{O}_2}^{1.5}, \\quad k_1 = A_1 \\exp\\left(-\\frac{E_1}{RT}\\right),$$ $$A_1 = 5.0 \\times 10^{6}, \\quad E_1 = 8.0 \\times 10^{4} \\ \\text{J} \\ \\text{mol}^{-1}.$$ 化学计量系数 $$\\nu_1 = [-1, -1.5, +1, 0, +2, 0], \\quad \\Delta \\nu_1 = +0.5.$$\n   步骤 2：$$\\text{CO} + 0.5 \\ \\text{O}_2 \\rightarrow \\text{CO}_2,$$ 其中 $$\\mathcal{R}_2 = k_2 C_{\\text{CO}} C_{\\text{O}_2}^{0.5}, \\quad k_2 = A_2 \\exp\\left(-\\frac{E_2}{RT}\\right),$$ $$A_2 = 2.5 \\times 10^{7}, \\quad E_2 = 1.2 \\times 10^{5} \\ \\text{J} \\ \\text{mol}^{-1}.$$ 化学计量系数 $$\\nu_2 = [0, -0.5, -1, +1, 0, 0], \\quad \\Delta \\nu_2 = -0.5.$$\n\n假设使用所列的反应级数进行质量作用动力学计算，浓度定义为 $$C_i = x_i C_{\\text{tot}}.$$\n\n恒压、恒温下的摩尔分数演化由以下非自治系统控制\n$$\\frac{d x_i}{d t} = \\frac{1}{C_{\\text{tot}}} \\left( \\sum_{r} \\nu_{i,r} \\mathcal{R}_r - x_i \\sum_{r} \\Delta \\nu_r \\mathcal{R}_r \\right),$$\n其中 $r$ 遍历所选模型中活跃的反应。对于单步模型，该和只有一项，且 $\\Delta \\nu_A = 0$。对于两步模型，该和有两项，分别为 $\\Delta \\nu_1$ 和 $\\Delta \\nu_2$。\n\n对于每个测试案例，在恒定的$T$和$P$条件下，将上述系统从$t=0$积分到$t=\\tau$。计算两步模型预测的出口一氧化碳摩尔分数$x_{\\text{CO, two-step}}(\\tau)$，以及单步模型预测的$x_{\\text{CO, one-step}}(\\tau)$。每个测试案例所需量为二者之差\n$$\\Delta x_{\\text{CO}} = x_{\\text{CO, two-step}}(\\tau) - x_{\\text{CO, one-step}}(\\tau).$$\n\n单位与量：\n- 温度$T$单位为$\\text{K}$。\n- 压力$P$单位为$\\text{Pa}$。\n- 停留时间$\\tau$单位为$\\text{s}$。\n- Arrhenius 指前因子的单位经过选择，以确保在给定的反应级数下，每个$\\mathcal{R}_r$的单位都是$\\text{mol} \\ \\text{m}^{-3} \\ \\text{s}^{-1}$。\n- 摩尔分数为无量纲。\n\n测试套件（每个案例为 $(T, P, \\tau)$）：\n- 案例 1：$(1600, 100000, 0.010)$。\n- 案例 2：$(1800, 100000, 0.050)$。\n- 案例 3：$(1400, 100000, 0.010)$。\n- 案例 4：$(1600, 500000, 0.010)$。\n- 案例 5：$(1600, 100000, 0.001)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个$r_k$是第$k$个测试案例的$\\Delta x_{\\text{CO}}$的浮点数值。",
            "solution": "### 问题验证\n\n**步骤 1：提取给定信息**\n- **系统：**等温（$T$）、等压（$P$）的间歇式反应器，从 $t=0$ 演化到最终时间 $\\tau$（停留时间）。\n- **混合物：**理想气体，初始为化学计量的甲烷-空气混合物。\n- **初始摩尔数：**$n_{\\text{CH}_4} = 1$, $n_{\\text{O}_2} = 2$, $n_{\\text{N}_2} = \\frac{79}{21} \\cdot 2$, $n_{\\text{CO}} = 0$, $n_{\\text{CO}_2} = 0$, $n_{\\text{H}_2\\text{O}} = 0$。\n- **初始摩尔分数：**$x_i(0) = n_i / \\sum_j n_j$。\n- **追踪的物种：**甲烷 $(\\text{CH}_4)$、氧气 $(\\text{O}_2)$、一氧化碳 $(\\text{CO})$、二氧化碳 $(\\text{CO}_2)$、水 $(\\text{H}_2\\text{O})$、氮气 $(\\text{N}_2)$。\n- **物理常数：**理想气体常数 $R = 8.314462618 \\ \\text{J} \\ \\text{mol}^{-1} \\ \\text{K}^{-1}$。\n- **热力学状态：**总摩尔浓度 $C_{\\text{tot}} = \\frac{P}{RT}$。\n- **摩尔分数的主控方程：**\n  $$\\frac{d x_i}{d t} = \\frac{1}{C_{\\text{tot}}} \\left( \\sum_{r} \\nu_{i,r} \\mathcal{R}_r - x_i \\sum_{r} \\Delta \\nu_r \\mathcal{R}_r \\right)$$\n- **模型：**\n    1.  **单步模型：**\n        - 反应：$\\text{CH}_4 + 2 \\ \\text{O}_2 \\rightarrow \\text{CO}_2 + 2 \\ \\text{H}_2\\text{O}$\n        - 速率：$\\mathcal{R}_A = k_A C_{\\text{CH}_4} C_{\\text{O}_2}^2$\n        - 动力学：$k_A = A_A \\exp(-E_A / RT)$，其中 $A_A = 1.0 \\times 10^{7}$，$E_A = 1.5 \\times 10^{5} \\ \\text{J} \\ \\text{mol}^{-1}$。\n        - 化学计量：$\\nu_A = [-1, -2, 0, +1, +2, 0]$, $\\Delta \\nu_A = 0$。\n    2.  **两步模型：**\n        - 步骤 1：$\\text{CH}_4 + 1.5 \\ \\text{O}_2 \\rightarrow \\text{CO} + 2 \\ \\text{H}_2\\text{O}$\n            - 速率：$\\mathcal{R}_1 = k_1 C_{\\text{CH}_4} C_{\\text{O}_2}^{1.5}$\n            - 动力学：$k_1 = A_1 \\exp(-E_1 / RT)$，其中 $A_1 = 5.0 \\times 10^{6}$，$E_1 = 8.0 \\times 10^{4} \\ \\text{J} \\ \\text{mol}^{-1}$。\n            - 化学计量：$\\nu_1 = [-1, -1.5, +1, 0, +2, 0]$, $\\Delta \\nu_1 = +0.5$。\n        - 步骤 2：$\\text{CO} + 0.5 \\ \\text{O}_2 \\rightarrow \\text{CO}_2$\n            - 速率：$\\mathcal{R}_2 = k_2 C_{\\text{CO}} C_{\\text{O}_2}^{0.5}$\n            - 动力学：$k_2 = A_2 \\exp(-E_2 / RT)$，其中 $A_2 = 2.5 \\times 10^{7}$，$E_2 = 1.2 \\times 10^{5} \\ \\text{J} \\ \\text{mol}^{-1}$。\n            - 化学计量：$\\nu_2 = [0, -0.5, -1, +1, 0, 0]$, $\\Delta \\nu_2 = -0.5$。\n- **测试案例 $(T, P, \\tau)$：**\n    - 案例 1：$(1600 \\ \\text{K}, 100000 \\ \\text{Pa}, 0.010 \\ \\text{s})$\n    - 案例 2：$(1800 \\ \\text{K}, 100000 \\ \\text{Pa}, 0.050 \\ \\text{s})$\n    - 案例 3：$(1400 \\ \\text{K}, 100000 \\ \\text{Pa}, 0.010 \\ \\text{s})$\n    - 案例 4：$(1600 \\ \\text{K}, 500000 \\ \\text{Pa}, 0.010 \\ \\text{s})$\n    - 案例 5：$(1600 \\ \\text{K}, 100000 \\ \\text{Pa}, 0.001 \\ \\text{s})$\n- **目标：**计算 $\\Delta x_{\\text{CO}} = x_{\\text{CO, two-step}}(\\tau) - x_{\\text{CO, one-step}}(\\tau)$。\n\n**步骤 2：使用提取的给定信息进行验证**\n经评估，该问题有效。\n- **科学依据：**该问题牢固地植根于化学动力学、热力学和反应器理论的原理。使用全局反应机理、Arrhenius 动力学和质量作用速率定律是燃烧建模中的标准做法。\n- **适定性：**该问题被表述为一个常微分方程组的初值问题。主控方程是明确的，并且提供了所有必要的参数和初始条件。定义常微分方程组的函数是连续的，确保在给定的时间区间内解的存在性和唯一性。\n- **目标：**问题陈述使用精确、无歧义的科学语言编写。\n- **未检测到缺陷：**该问题没有违反任何基本原则，不是不完整或矛盾的，使用了实际的参数，结构良好，不平凡，并且是科学可验证的。使用术语“完全搅拌反应器”来描述一个在停留时间 $\\tau$ 内演化的间歇系统是一种常见的建模方法，明确提供的主控方程阐明了需要求解的精确数学体系，避免了歧义。\n\n**步骤 3：结论与行动**\n问题有效。将制定一个合理的解决方案。\n\n### 解题方案\n\n目标是比较在一个等温、等压的间歇式反应器中，由单步和两步全局燃烧模型预测的甲烷-空气混合物燃烧后最终的一氧化碳（$\\text{CO}$）摩尔分数。系统的演化由一组关于物种摩尔分数$x_i$的常微分方程（ODE）描述。\n\n**初始状态向量**\n初始混合物是化学计量的甲烷-空气混合物。空气近似为 $21\\%$ 的 $\\text{O}_2$ 和 $79\\%$ 的 $\\text{N}_2$（按体积计）。化学计量燃烧反应为 $\\text{CH}_4 + 2\\text{O}_2 \\rightarrow \\text{CO}_2 + 2\\text{H}_2\\text{O}$。对于 $1$ 摩尔的 $\\text{CH}_4$，需要 $2$ 摩尔的 $\\text{O}_2$。这 $2$ 摩尔的 $\\text{O}_2$ 伴随着 $2 \\times (79/21)$ 摩尔的 $\\text{N}_2$。初始摩尔数（$n_i$）为：\n$n_{\\text{CH}_4} = 1$\n$n_{\\text{O}_2} = 2$\n$n_{\\text{N}_2} = 2 \\cdot \\frac{79}{21} = \\frac{158}{21}$\n$n_{\\text{CO}} = 0, \\ n_{\\text{CO}_2} = 0, \\ n_{\\text{H}_2\\text{O}} = 0$\n\n初始总摩尔数为 $n_{\\text{tot}}(0) = 1 + 2 + \\frac{158}{21} = \\frac{21+42+158}{21} = \\frac{221}{21}$。\n初始摩尔分数向量 $\\vec{x}(0) = [x_{\\text{CH}_4}, x_{\\text{O}_2}, x_{\\text{CO}}, x_{\\text{CO}_2}, x_{\\text{H}_2\\text{O}}, x_{\\text{N}_2}]$ 为：\n$x_{\\text{CH}_4}(0) = \\frac{1}{221/21} = \\frac{21}{221} \\approx 0.09502$\n$x_{\\text{O}_2}(0) = \\frac{2}{221/21} = \\frac{42}{221} \\approx 0.19005$\n$x_{\\text{CO}}(0) = 0$\n$x_{\\text{CO}_2}(0) = 0$\n$x_{\\text{H}_2\\text{O}}(0) = 0$\n$x_{\\text{N}_2}(0) = \\frac{158/21}{221/21} = \\frac{158}{221} \\approx 0.71493$\n\n**模型 1：单步全局模型**\n在此模型中，物种 $i$ 的演化方程为：\n$\\frac{d x_i}{d t} = \\frac{1}{C_{\\text{tot}}} \\left( \\nu_{i,A} \\mathcal{R}_A - x_i \\Delta \\nu_A \\mathcal{R}_A \\right)$\n此反应的摩尔数净变化为 $\\Delta \\nu_A = \\sum_i \\nu_{i,A} = -1 - 2 + 0 + 1 + 2 + 0 = 0$。主控方程简化为：\n$\\frac{d x_i}{d t} = \\frac{\\nu_{i,A} \\mathcal{R}_A}{C_{\\text{tot}}}$\n对于一氧化碳（$i = \\text{CO}$），化学计量系数为 $\\nu_{\\text{CO},A} = 0$。因此，其摩尔分数的变化率为：\n$\\frac{d x_{\\text{CO}}}{d t} = 0$\n鉴于初始条件 $x_{\\text{CO}}(0) = 0$，$\\text{CO}$ 的摩尔分数在所有时间内都保持为零。因此，单步模型预测的出口摩尔分数为：\n$x_{\\text{CO, one-step}}(\\tau) = 0$\n\n**模型 2：两步简化化学模型**\n该模型涉及两个反应，必须使用完整的主控方程：\n$\\frac{d x_i}{d t} = \\frac{1}{C_{\\text{tot}}} \\left( (\\nu_{i,1} \\mathcal{R}_1 + \\nu_{i,2} \\mathcal{R}_2) - x_i (\\Delta \\nu_1 \\mathcal{R}_1 + \\Delta \\nu_2 \\mathcal{R}_2) \\right)$\n其中反应器条件（$T, P$）是恒定的。各项定义如下：\n- 总摩尔浓度：$C_{\\text{tot}} = P/(RT)$\n- 反应速率：\n  $\\mathcal{R}_1 = k_1 (x_{\\text{CH}_4}C_{\\text{tot}})^{1} (x_{\\text{O}_2}C_{\\text{tot}})^{1.5}$\n  $\\mathcal{R}_2 = k_2 (x_{\\text{CO}}C_{\\text{tot}})^{1} (x_{\\text{O}_2}C_{\\text{tot}})^{0.5}$\n- 速率常数：\n  $k_1 = A_1 \\exp(-E_1/RT)$\n  $k_2 = A_2 \\exp(-E_2/RT)$\n- 每个反应的摩尔数变化：$\\Delta \\nu_1 = +0.5$, $\\Delta \\nu_2 = -0.5$。\n\n在此模型中，$\\text{CO}$ 是一个中间物种。它由第一个反应生成（$\\nu_{\\text{CO},1} = +1$），并由第二个反应消耗（$\\nu_{\\text{CO},2} = -1$）。其主控方程不平凡：\n$\\frac{d x_{\\text{CO}}}{d t} = \\frac{1}{C_{\\text{tot}}} \\left( (1 \\cdot \\mathcal{R}_1 - 1 \\cdot \\mathcal{R}_2) - x_{\\text{CO}} (0.5 \\cdot \\mathcal{R}_1 - 0.5 \\cdot \\mathcal{R}_2) \\right)$\n\n这个由六个耦合的、针对所有物种摩尔分数的非线性常微分方程组必须进行数值求解。\n\n**数值求解策略**\n两步模型的初值问题通过将常微分方程组从 $t=0$ 积分到 $t=\\tau$ 来求解。由于化学动力学特有的反应时间尺度范围宽（刚性），需要一个鲁棒的隐式常微分方程求解器。SciPy 库中的 `solve_ivp` 函数，配合 `Radau` 方法，是一个合适的选择。\n\n对于每个测试案例 `(T, P, tau)`：\n1. 单步模型的结果可解析得出 $x_{\\text{CO, one-step}}(\\tau) = 0$。\n2. 使用初始条件向量 $\\vec{x}(0)$，在时间跨度 $[0, \\tau]$ 上对两步模型的常微分方程组进行积分。\n3. 从数值解中提取最终时刻的一氧化碳摩尔分数 $x_{\\text{CO, two-step}}(\\tau)$。\n4. 计算该测试案例的最终结果，即差值 $\\Delta x_{\\text{CO}} = x_{\\text{CO, two-step}}(\\tau) - 0 = x_{\\text{CO, two-step}}(\\tau)$。\n\n最终输出将是所有测试案例的这些 $\\Delta x_{\\text{CO}}$ 值的列表。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the difference in exit CO mole fraction between a two-step and a one-step\n    methane combustion model in an isothermal, isobaric batch reactor.\n    \"\"\"\n    \n    # Fundamental constant\n    R = 8.314462618  # J mol^-1 K^-1\n\n    # Species order: [CH4, O2, CO, CO2, H2O, N2]\n    # Indices for key species\n    I_CH4, I_O2, I_CO = 0, 1, 2\n\n    # --- Initial Conditions ---\n    # Stoichiometric methane-air mixture. Air is 79/21 N2/O2.\n    # CH4 + 2(O2 + 3.76 N2)\n    n_ch4 = 1.0\n    n_o2 = 2.0\n    n_n2 = 2.0 * (79.0 / 21.0)\n    \n    # Total initial moles\n    n_total_initial = n_ch4 + n_o2 + n_n2\n    \n    # Initial mole fraction vector x0\n    x0 = np.zeros(6)\n    x0[I_CH4] = n_ch4 / n_total_initial\n    x0[I_O2] = n_o2 / n_total_initial\n    x0[5] = n_n2 / n_total_initial # Index 5 for N2\n\n    # --- Two-Step Model Definition ---\n    # Reaction 1: CH4 + 1.5 O2 -> CO + 2 H2O\n    # Reaction 2: CO + 0.5 O2 -> CO2\n    \n    # Stoichiometric coefficient vectors (nu) for [CH4, O2, CO, CO2, H2O, N2]\n    nu1 = np.array([-1.0, -1.5, 1.0, 0.0, 2.0, 0.0])\n    nu2 = np.array([0.0, -0.5, -1.0, 1.0, 0.0, 0.0])\n    \n    # Change in total moles for each reaction\n    delta_nu1 = 0.5\n    delta_nu2 = -0.5\n\n    # Arrhenius parameters for the two-step model\n    A1, E1 = 5.0e6, 8.0e4\n    A2, E2 = 2.5e7, 1.2e5\n\n    def dxdt_twostep(t, x, P, T):\n        \"\"\"\n        ODE system for the two-step model mole fraction evolution.\n        dx_i/dt = (1/C_tot) * ( sum(nu_ir * R_r) - x_i * sum(delta_nu_r * R_r) )\n        \"\"\"\n        # Ensure mole fractions do not become negative due to numerical error\n        x_non_neg = np.maximum(x, 1e-30) # Use a small positive floor\n\n        # Total molar concentration (mol/m^3)\n        C_tot = P / (R * T)\n\n        # Species concentrations (mol/m^3)\n        C = x_non_neg * C_tot\n        C_ch4 = C[I_CH4]\n        C_o2  = C[I_O2]\n        C_co  = C[I_CO]\n        \n        # Rate constants (k)\n        k1 = A1 * np.exp(-E1 / (R * T))\n        k2 = A2 * np.exp(-E2 / (R * T))\n        \n        # Reaction rates (R_r) in mol m^-3 s^-1\n        R1 = k1 * (C_ch4 ** 1.0) * (C_o2 ** 1.5)\n        R2 = k2 * (C_co ** 1.0) * (C_o2 ** 0.5)\n\n        # Net species production rates (omega_dot)\n        omega_dot = nu1 * R1 + nu2 * R2\n\n        # Mole change term\n        sum_delta_nu_R = delta_nu1 * R1 + delta_nu2 * R2\n        \n        # Rate of change of mole fractions\n        dxdt = (1.0 / C_tot) * (omega_dot - x * sum_delta_nu_R)\n        return dxdt\n\n    # --- Test Cases ---\n    test_cases = [\n        # (T in K, P in Pa, tau in s)\n        (1600.0, 100000.0, 0.010),\n        (1800.0, 100000.0, 0.050),\n        (1400.0, 100000.0, 0.010),\n        (1600.0, 500000.0, 0.010),\n        (1600.0, 100000.0, 0.001),\n    ]\n\n    results = []\n    for T, P, tau in test_cases:\n        # Model 1 (one-step): x_CO(0)=0 and nu_CO,A=0, so dx_CO/dt=0.\n        # Thus, the final CO mole fraction is always 0.\n        x_co_onestep = 0.0\n\n        # Model 2 (two-step): Numerically integrate the ODE system.\n        # A stiff solver is appropriate for chemical kinetics.\n        sol = solve_ivp(\n            fun=dxdt_twostep,\n            t_span=[0, tau],\n            y0=x0,\n            method='Radau',\n            args=(P, T),\n            atol=1e-12, # Strict tolerance for accuracy\n            rtol=1e-9\n        )\n        \n        # Final CO mole fraction from the two-step model\n        x_co_twostep = sol.y[I_CO, -1]\n        \n        # Calculate the difference as required\n        delta_x_co = x_co_twostep - x_co_onestep\n        results.append(delta_x_co)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "全局模型中的参数（如指前因子$A$和活化能$E_a$）通常由实验数据拟合得到，因此带有不确定性。本高级练习  引导您探究模型预测对其参数的敏感性，这是模型验证和不确定性量化的核心步骤。您将基于高活化能渐近理论，推导并计算层流火焰速度$S_L$对模型中各个关键参数的偏导数，从而深入理解不同参数如何影响燃烧过程的整体速率。",
            "id": "3957684",
            "problem": "您的任务是设计一个程序，用于计算在稳态、平面、预混火焰中层流火焰速度的局部一阶参数敏感度，该火焰通过单步总包反应进行建模。需要计算的敏感度为$\\partial S_L/\\partial A$、$\\partial S_L/\\partial E_a$、$\\partial S_L/\\partial m$和$\\partial S_L/\\partial p$。您的程序必须在以下假设和基础之上，实现一个科学上一致的热扩散预混火焰模型，并为给定的参数测试套件生成具有指定单位的数值。\n\n基本依据和假设：\n- 考虑一个 Lewis 数为 1 且输运性质恒定的一维、稳态、平面预混火焰。能量守恒、组分守恒和热量释放是其控制基础。\n- 总包单步反应速率假设为具有显式压力依赖性的 Arrhenius 形式：$k(T) = A\\left(\\frac{p}{p_{\\mathrm{ref}}}\\right)^{m}\\exp\\left(-\\frac{E_a}{R T}\\right)$，其中$A$是指前因子，$E_a$是活化能，$m$是相对于压力的总包反应级数，$p$是热力学压力，$p_{\\mathrm{ref}}$是一个固定的参考压力，$R$是普适气体常数，$T$是温度。\n- 热结构假设为绝热火焰条件，绝热已燃气体温度由能量平衡定义为 $T_b = T_u + \\frac{Q}{c_p}$，其中$T_u$是未燃气体温度，$Q$是单位质量混合物的比热释放，$c_p$是混合物的定压比热。\n- 使用 Frank-Kamenetskii 和 Zel'dovich 的高活化能渐近框架。将 Zel'dovich 数定义为 $\\beta = \\frac{E_a (T_b - T_u)}{R T_b^2}$，并在$\\beta > 1$的情况下，通过 $T_e = T_b\\left(1 - \\frac{1}{\\beta}\\right)$来近似有效反应区温度。\n- 在热扩散理论和 Lewis 数为 1 的匹配渐近法下，通过$S_L \\sim \\sqrt{\\alpha/\\tau_c}$（其中$\\tau_c \\approx 1/k(T_e)$）将层流火焰速度与有效化学时间尺度关联起来，其中$\\alpha$是未燃混合物的热扩散率。在您的解法中，必须基于这些基础推导出连接$S_L$与$A$、$E_a$、$m$、$p$及热学量的精确代数形式。\n\n要求的输出和单位：\n- 在指定的工况下计算并输出四个偏导数。使用以下单位：\n  - $\\partial S_L/\\partial A$ 的单位是米 ($\\mathrm{m}$)。\n  - $\\partial S_L/\\partial E_a$ 的单位是米·摩尔/(焦耳·秒) ($\\mathrm{m\\cdot mol/(J\\cdot s)}$)。\n  - $\\partial S_L/\\partial m$ 的单位是米/秒 ($\\mathrm{m/s}$)。\n  - $\\partial S_L/\\partial p$ 的单位是米/(秒·帕斯卡) ($\\mathrm{m/(s\\cdot Pa)}$)。\n- 所有计算必须采用国际单位制 (SI)：$A$的单位是$\\mathrm{s^{-1}}$，$E_a$的单位是$\\mathrm{J/mol}$，$m$是无量纲的，$p$的单位是$\\mathrm{Pa}$，$p_{\\mathrm{ref}}$的单位是$\\mathrm{Pa}$，$R$的单位是$\\mathrm{J/(mol\\cdot K)}$，$T_u$、$T_b$、$T_e$的单位是$\\mathrm{K}$，$Q$的单位是$\\mathrm{J/kg}$，$c_p$的单位是$\\mathrm{J/(kg\\cdot K)}$，$\\alpha$的单位是$\\mathrm{m^2/s}$。\n\n适用于所有测试用例的给定常数：\n- $T_u = 300\\,\\mathrm{K}$。\n- $c_p = 1005\\,\\mathrm{J/(kg\\cdot K)}$。\n- $Q = 1.8\\times 10^{6}\\,\\mathrm{J/kg}$。\n- $\\alpha = 2.0\\times 10^{-5}\\,\\mathrm{m^2/s}$。\n- $R = 8.314\\,\\mathrm{J/(mol\\cdot K)}$。\n- $p_{\\mathrm{ref}} = 101325\\,\\mathrm{Pa}$。\n\n测试套件：\n您的程序必须为以下每一组参数$(A,E_a,m,p)$计算四个敏感度：\n1. $(1.0\\times 10^{7},\\,1.2\\times 10^{5},\\,0.5,\\,101325)$。\n2. $(1.0\\times 10^{7},\\,1.2\\times 10^{5},\\,0.5,\\,5.0\\times 10^{6})$。\n3. $(1.0\\times 10^{7},\\,2.5\\times 10^{4},\\,0.5,\\,101325)$。\n4. $(1.0\\times 10^{7},\\,1.2\\times 10^{5},\\,0.0,\\,3.0\\times 10^{5})$。\n5. $(1.0\\times 10^{3},\\,1.2\\times 10^{5},\\,0.5,\\,101325)$。\n\n覆盖范围设计：\n- 用例 1 测试中等活化能和压力依赖性下的典型近常压工况。\n- 用例 2 测试高压下的敏感度。\n- 用例 3 测试渐近边界 $\\beta \\gtrsim 1$ 附近的工况。\n- 用例 4 测试零压力级数以验证$\\partial S_L/\\partial p$的行为。\n- 用例 5 测试影响$S_L$大小的低指前因子下的敏感度。\n\n最终输出格式规范：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个包含四个浮点数的列表，顺序为$[\\partial S_L/\\partial A,\\ \\partial S_L/\\partial E_a,\\ \\partial S_L/\\partial m,\\ \\partial S_L/\\partial p]$。例如，输出必须采用$[[d_1^A,d_1^{E_a},d_1^m,d_1^p],[d_2^A,d_2^{E_a},d_2^m,d_2^p],\\ldots]$的形式，不含任何附加文本。",
            "solution": "该问题已经过严格评估，被认为是有效的。它以预混火焰传播的经典理论为科学基础，是适定的、客观且自洽的。所提供的假设和常数足以推导出一个唯一且有意义的解。火焰速度标度关系$S_L \\sim \\sqrt{\\alpha/\\tau_c}$中的轻微模糊性，通过采纳此类问题的标准解释得以解决，即比例常数为 1。这导出了直接的代数形式$S_L = \\sqrt{\\alpha/\\tau_c}$，由此可以严格推导出各种敏感度。测试用例经过精心选择，旨在探究模型的不同物理区域，包括高压极限、低活化能极限和零压力级数情况，这证实了该问题设计的周密性。\n\n我们接下来推导层流火焰速度$S_L$及其参数敏感度。\n\n首先，我们根据所提供的理论框架，建立层流火焰速度$S_L$的函数形式。模型参数包括指前因子$A$、活化能$E_a$、压力级数$m$和压力$p$。固定的物理常数包括未燃气体温度$T_u$、比热$c_p$、热释放$Q$、热扩散率$\\alpha$、普适气体常数$R$和参考压力$p_{\\mathrm{ref}}$。\n\n绝热火焰温度$T_b$对所有情况都是恒定的，因为它仅依赖于固定的热学性质：\n$$T_b = T_u + \\frac{Q}{c_p}$$\n\nZel'dovich 数$\\beta$是活化能的一个无量纲度量，它依赖于$E_a$：\n$$\\beta(E_a) = \\frac{E_a (T_b - T_u)}{R T_b^2}$$\n渐近理论对大的$\\beta$值有效，问题要求在$\\beta > 1$时使用该框架，此条件对所有指定的测试用例均成立。\n\n有效反应区温度$T_e$使用高活化能渐近法进行近似：\n$$T_e(E_a) = T_b \\left(1 - \\frac{1}{\\beta(E_a)}\\right)$$\n\n总包单步 Arrhenius 反应速率$k$在此有效温度下计算：\n$$k(T_e) = A \\left(\\frac{p}{p_{\\mathrm{ref}}}\\right)^m \\exp\\left(-\\frac{E_a}{R T_e(E_a)}\\right)$$\n\n火焰速度$S_L$与热扩散率$\\alpha$和特征化学时间$\\tau_c$相关。按照规定，我们使用$\\tau_c \\approx 1/k(T_e)$和标度关系$S_L \\sim \\sqrt{\\alpha/\\tau_c}$。将比例常数解释为 1，得到显式公式：\n$$S_L(A, E_a, m, p) = \\sqrt{\\alpha k(T_e)} = \\sqrt{\\alpha A \\left(\\frac{p}{p_{\\mathrm{ref}}}\\right)^m \\exp\\left(-\\frac{E_a}{R T_e(E_a)}\\right)}$$\n这可以写作：\n$$S_L = A^{1/2} \\alpha^{1/2} \\left(\\frac{p}{p_{\\mathrm{ref}}}\\right)^{m/2} \\exp\\left(-\\frac{E_a}{2 R T_e(E_a)}\\right)$$\n\n接下来，我们推导所需的一阶偏导数。对数微分法是一个方便的工具。\n$$\\ln S_L = \\frac{1}{2}\\ln A + \\frac{1}{2}\\ln \\alpha + \\frac{m}{2}\\ln\\left(\\frac{p}{p_{\\mathrm{ref}}}\\right) - \\frac{E_a}{2 R T_e(E_a)}$$\n\n1.  **对指前因子$A$的敏感度**：\n    对$\\ln S_L$关于$A$求导得到：\n    $$\\frac{1}{S_L}\\frac{\\partial S_L}{\\partial A} = \\frac{1}{2A}$$\n    $$\\frac{\\partial S_L}{\\partial A} = \\frac{S_L}{2A}$$\n\n2.  **对压力级数$m$的敏感度**：\n    对$\\ln S_L$关于$m$求导得到：\n    $$\\frac{1}{S_L}\\frac{\\partial S_L}{\\partial m} = \\frac{1}{2}\\ln\\left(\\frac{p}{p_{\\mathrm{ref}}}\\right)$$\n    $$\\frac{\\partial S_L}{\\partial m} = \\frac{S_L}{2}\\ln\\left(\\frac{p}{p_{\\mathrm{ref}}}\\right)$$\n    注意，如果$p = p_{\\mathrm{ref}}$，该导数如预期为零。\n\n3.  **对压力$p$的敏感度**：\n    对$\\ln S_L$关于$p$求导得到：\n    $$\\frac{1}{S_L}\\frac{\\partial S_L}{\\partial p} = \\frac{m}{2} \\cdot \\frac{1}{p/p_{\\mathrm{ref}}} \\cdot \\frac{1}{p_{\\mathrm{ref}}} = \\frac{m}{2p}$$\n    $$\\frac{\\partial S_L}{\\partial p} = \\frac{m S_L}{2p}$$\n    如果$m=0$，该导数为零，正确地反映了没有压力依赖性。\n\n4.  **对活化能$E_a$的敏感度**：\n    这是最复杂的导数，因为$E_a$显式地出现在指数项中，并隐式地包含在$T_e$内。\n    $$\\frac{1}{S_L}\\frac{\\partial S_L}{\\partial E_a} = \\frac{\\partial}{\\partial E_a}\\left(-\\frac{E_a}{2 R T_e(E_a)}\\right) = -\\frac{1}{2R} \\frac{\\partial}{\\partial E_a}\\left(\\frac{E_a}{T_e}\\right)$$\n    我们对$\\frac{E_a}{T_e}$应用商法则：\n    $$\\frac{\\partial}{\\partial E_a}\\left(\\frac{E_a}{T_e}\\right) = \\frac{1 \\cdot T_e - E_a \\cdot \\frac{\\partial T_e}{\\partial E_a}}{T_e^2} = \\frac{1}{T_e} - \\frac{E_a}{T_e^2}\\frac{\\partial T_e}{\\partial E_a}$$\n    为了求得$\\frac{\\partial T_e}{\\partial E_a}$，我们首先将$T_e$显式地表示为$E_a$的函数：\n    $$T_e(E_a) = T_b - \\frac{T_b}{\\beta(E_a)} = T_b - T_b \\left(\\frac{R T_b^2}{E_a(T_b-T_u)}\\right) = T_b - \\frac{R T_b^3}{T_b-T_u} E_a^{-1}$$\n    对$E_a$求导：\n    $$\\frac{\\partial T_e}{\\partial E_a} = - \\left(\\frac{R T_b^3}{T_b-T_u}\\right) (-1) E_a^{-2} = \\frac{R T_b^3}{E_a^2(T_b-T_u)}$$\n    通过代入$\\beta$的定义，可以简化为：\n    $$\\frac{\\partial T_e}{\\partial E_a} = \\frac{R T_b^2}{E_a(T_b-T_u)} \\frac{T_b}{E_a} = \\frac{1}{\\beta} \\frac{T_b}{E_a}$$\n    将此结果代回$E_a/T_e$的导数中：\n    $$\\frac{\\partial}{\\partial E_a}\\left(\\frac{E_a}{T_e}\\right) = \\frac{1}{T_e} - \\frac{E_a}{T_e^2} \\left(\\frac{T_b}{\\beta E_a}\\right) = \\frac{1}{T_e} - \\frac{T_b}{\\beta T_e^2}$$\n    使用$T_e = T_b(1 - 1/\\beta) = T_b\\frac{\\beta-1}{\\beta}$：\n    $$\\frac{\\partial}{\\partial E_a}\\left(\\frac{E_a}{T_e}\\right) = \\frac{\\beta}{T_b(\\beta-1)} - \\frac{T_b}{\\beta \\left(T_b\\frac{\\beta-1}{\\beta}\\right)^2} = \\frac{\\beta}{T_b(\\beta-1)} - \\frac{T_b \\beta^2}{\\beta T_b^2(\\beta-1)^2} = \\frac{\\beta}{T_b(\\beta-1)} - \\frac{\\beta}{T_b(\\beta-1)^2}$$\n    $$= \\frac{\\beta(\\beta-1) - \\beta}{T_b(\\beta-1)^2} = \\frac{\\beta^2 - 2\\beta}{T_b(\\beta-1)^2} = \\frac{\\beta(\\beta - 2)}{T_b(\\beta - 1)^2}$$\n    最后，我们得到敏感度：\n    $$\\frac{\\partial S_L}{\\partial E_a} = -S_L \\frac{1}{2R} \\frac{\\beta(\\beta - 2)}{T_b(\\beta - 1)^2}$$\n\n计算算法如下：\n对于每个给定的参数集$(A, E_a, m, p)$：\n1. 计算常数$T_b$。\n2. 计算$\\beta(E_a)$。\n3. 计算$T_e(E_a)$。\n4. 计算火焰速度$S_L$。\n5. 使用上面推导的表达式计算四个偏导数。\n6. 整理结果并按要求格式化。\n此过程将在提供的 Python 环境中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes first-order parameter sensitivities for the laminar flame speed\n    based on a thermal-diffusive model with high-activation-energy asymptotics.\n    \"\"\"\n    # Given constants in SI units\n    Tu = 300.0  # K\n    cp = 1005.0  # J/(kg*K)\n    Q = 1.8e6  # J/kg\n    alpha = 2.0e-5  # m^2/s\n    R = 8.314  # J/(mol*K)\n    p_ref = 101325.0  # Pa\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (A [s^-1], Ea [J/mol], m, p [Pa])\n        (1.0e7, 1.2e5, 0.5, 101325.0),\n        (1.0e7, 1.2e5, 0.5, 5.0e6),\n        (1.0e7, 2.5e4, 0.5, 101325.0),\n        (1.0e7, 1.2e5, 0.0, 3.0e5),\n        (1.0e3, 1.2e5, 0.5, 101325.0),\n    ]\n\n    results = []\n\n    # Pre-calculate constant values\n    Tb = Tu + Q / cp\n    Tb_minus_Tu = Tb - Tu\n\n    for case in test_cases:\n        A, Ea, m, p = case\n\n        # Step 1: Calculate Zel'dovich number beta\n        beta = (Ea * Tb_minus_Tu) / (R * Tb**2)\n\n        if beta == 1.0:\n            # The asymptotic model is not valid for beta = 1.\n            # This case is not expected based on problem validation.\n            # We can append NaNs or raise an error.\n            # For robustness, we'll indicate an invalid calculation.\n            results.append([np.nan, np.nan, np.nan, np.nan])\n            continue\n\n        # Step 2: Calculate effective reaction temperature Te\n        Te = Tb * (1.0 - 1.0 / beta)\n\n        # Step 3: Calculate laminar flame speed S_L\n        # Reaction rate at Te\n        k_Te = A * (p / p_ref)**m * np.exp(-Ea / (R * Te))\n        S_L = (alpha * k_Te)**0.5\n\n        # Step 4: Calculate the four sensitivities\n        \n        # dS_L / dA\n        dS_dA = S_L / (2.0 * A)\n\n        # dS_L / dEa\n        dS_dEa = -S_L * (beta * (beta - 2.0)) / (2.0 * R * Tb * (beta - 1.0)**2)\n\n        # dS_L / dm\n        # Handle the case where p = p_ref to avoid log(1) floating point issues,\n        # ensuring the result is exactly 0.\n        if p == p_ref:\n            dS_dm = 0.0\n        else:\n            dS_dm = S_L / 2.0 * np.log(p / p_ref)\n            \n        # dS_L / dp\n        # The formula is robust and gives 0 for m=0, but an explicit check is clear.\n        if m == 0.0:\n            dS_dp = 0.0\n        else:\n            dS_dp = m * S_L / (2.0 * p)\n\n        results.append([dS_dA, dS_dEa, dS_dm, dS_dp])\n    \n    # Format the final list of lists into the required string representation.\n    # We use list comprehensions and str.format for control over the output.\n    case_strings = []\n    for res_list in results:\n        # Format each float in the list to a consistent representation\n        formatted_list = [f\"{val:.8e}\" for val in res_list]\n        case_strings.append(f\"[{','.join(formatted_list)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(case_strings)}]\")\n\nsolve()\n```"
        }
    ]
}