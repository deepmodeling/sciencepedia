## 引言
[颗粒系统](@entry_id:1129404)，从[催化反应器](@entry_id:1122126)中的催化剂颗粒到地质过程中的砂石，在自然界和工业工程中无处不在。理解和预测这些系统的复杂行为，尤其是在涉及热传递和流体相互作用时，对优化设计和控制至关重要。然而，传统的[连续介质力学](@entry_id:155125)方法往往难以捕捉由单个颗粒的离散特性和非均匀相互作用所主导的关键现象。离散元方法 (DEM) 正是为应对这一挑战而生，它提供了一个从“第一性原理”出发，直接在颗粒尺度上解析[系统动力学](@entry_id:136288)的强大数值工具。

本文旨在为读者提供一份关于DEM在[颗粒系统](@entry_id:1129404)，特别是热工领域应用的全面指南。我们将分三步深入探索这一技术。首先，在“原理与机制”一章中，我们将奠定理论基础，详细阐述控制颗粒运动的动力学方程、核心的[接触力](@entry_id:165079)模型以及热现象的建模方法。接着，在“应用与跨学科连接”一章中，我们将展示DEM如何连接微观物理与宏观行为，并与其他物理场（如流体力学）耦合，解决实际工程问题。最后，“动手实践”部分将通过具体的编程练习，帮助您将理论知识转化为实践技能。

让我们从深入理解驱动DEM模拟的核心原理开始，揭开颗粒世界复杂动力学的面纱。

## 原理与机制

离散元方法 (Discrete Element Method, DEM) 为深入研究[颗粒系统](@entry_id:1129404)的[热力学](@entry_id:172368)行为提供了一个强大的数值框架。本章旨在系统地阐述驱动 DEM 模拟的核心物理原理和计算机制。我们将从该方法的基本理念出发，逐步构建描述颗粒运动和相互作用的数学模型，探讨其数值实现的关键方面，并最终将该框架扩展到包含复杂热现象的领域。

### 离散元方法的核心理念

离散元方法是一种[拉格朗日方法](@entry_id:142825)，其核心思想是将[颗粒系统](@entry_id:1129404)中的每一个颗粒视为独立的个体，并直接求解其在各种力作用下的运动轨迹。与其他将颗粒相视为连续介质的方法（例如，[双流体模型](@entry_id:139846)）相比，DEM 提供了在颗粒尺度上解析系统动力学和[热力学](@entry_id:172368)行为的独特能力 。DEM 主要存在两种经典范式：**软球时间驱动模型 (soft-sphere time-driven DEM)** 和 **硬球事件驱动模型 (hard-sphere event-driven DEM)**。

**硬[球模型](@entry_id:161388)** 将颗粒间的碰撞视为瞬时发生的二元事件，碰撞持续时间为零，颗粒间无重叠。该模型通过预测下一次碰撞事件的发生时间来推进模拟。这种方法对于模拟稀疏、快速流动的[颗粒系统](@entry_id:1129404)（如[颗粒气体](@entry_id:201841)）非常高效，因为在这些系统中，颗粒自由飞行的时间远大于碰撞本身。然而，对于存在持久[力链](@entry_id:199587)和显著静态接触的密集堆积床，硬球模型则显得力不从心。由于其忽略了接触的持续时间，因此无法直接模拟通过静态接触发生的关键[热传导](@entry_id:143509)过程 。

相比之下，**[软球模型](@entry_id:755009)** 允许颗粒在接触时发生微小的、虚拟的“重叠”。这种重叠量被用作计算接触力的依据，接触力被建模为重叠量和[相对速度](@entry_id:178060)的[连续函数](@entry_id:137361)。因此，每次碰撞都具有有限的持续时间，并且可以通过多个固定的时间步长进行解析。这种方法天然地适用于模拟密集、摩擦性[颗粒系统](@entry_id:1129404)，如填充床和料仓流动。更重要的是，有限的接触时间和由此产生的有效接触面积，为建立基于物理的颗粒间导热模型提供了坚实的基础 。鉴于其在处理持久接触和耦合复杂物理场（如热传递）方面的优势，本章将主要聚焦于软球时间驱动方法。

### 颗粒运动的控制方程

在DEM框架中，每个颗粒都被视为一个[刚体](@entry_id:1131033)，其运动遵循牛顿-欧拉运动定律。这些定律构成了DEM模拟的数学核心 。

#### 平动动力学

颗粒的平动由[牛顿第二定律](@entry_id:274217)描述，即颗粒的线性动量变化率等于作用在其上的合外力。对于一个质量为 $m$ 的颗粒，其[质心](@entry_id:138352)位置为 $\mathbf{r}$，[平动](@entry_id:187700)速度为 $\mathbf{v}$，该定律表示为：
$$ m\frac{d\mathbf{v}}{dt} = \sum \mathbf{F}_{\text{ext}} $$
其中 $\sum \mathbf{F}_{\text{ext}}$ 是作用在颗粒上的所有外力的矢量和。在典型的[颗粒系统](@entry_id:1129404)中，这些力包括：
- **重力**：$\mathbf{F}_g = m\mathbf{g}$，其中 $\mathbf{g}$ 是重力加速度。
- **接触力**：与其他颗粒或边界的接触产生的力，$\sum_j \mathbf{F}_{ij}$。这些力通常被分解为法向分量 $\mathbf{F}_{n,ij}$ 和切向分量 $\mathbf{F}_{t,ij}$。
- **流体-颗粒相互作用力**：如果颗粒浸没在流体中，则还包括拖曳力、压力[梯度力](@entry_id:166847)等。

颗粒位置的更新则通过其速度的定义式进行：
$$ \frac{d\mathbf{r}}{dt} = \mathbf{v} $$

#### [转动动力学](@entry_id:267911)

颗粒的转动由欧拉第二定律描述，即颗粒的[角动量变化率](@entry_id:165567)等于作用在其[质心](@entry_id:138352)上的合外力矩。对于一个具有[转动惯量张量](@entry_id:148659) $\mathbf{I}$ 和[角速度](@entry_id:192539) $\boldsymbol{\omega}$ 的[刚体](@entry_id:1131033)，一般形式为 $\frac{d\mathbf{L}}{dt} = \sum \boldsymbol{\tau}$，其中角动量 $\mathbf{L} = \mathbf{I}\boldsymbol{\omega}$。对于各向同性的球形颗粒，其[转动惯量张量](@entry_id:148659)为对角阵 $\mathbf{I} = I\mathbf{I}_3$，其中 $I = \frac{2}{5}mR^2$ 是标量转动惯量，$R$ 是颗粒半径。此时，[转动方程](@entry_id:176684)简化为：
$$ I\frac{d\boldsymbol{\omega}}{dt} = \sum \boldsymbol{\tau}_{\text{ext}} $$
作用在[质心](@entry_id:138352)上的力矩 $\sum \boldsymbol{\tau}_{\text{ext}}$ 包括：
- **[切向接触](@entry_id:201927)力产生的力矩**：$\sum_j (\mathbf{b}_{ij} \times \mathbf{F}_{t,ij})$，其中 $\mathbf{b}_{ij}$ 是从颗粒[质心](@entry_id:138352)指向接触点的分支矢量。对于球体，$\mathbf{b}_{ij} = R\mathbf{n}_{ij}$，$\mathbf{n}_{ij}$ 是接触点的单位法向矢量。[法向力](@entry_id:174233) $\mathbf{F}_{n,ij}$ 由于与 $\mathbf{b}_{ij}$ 平行，因此不产生力矩。
- **[滚动阻力](@entry_id:754415)力矩**：$\sum_j \boldsymbol{\tau}_{r,ij}$，这是一个用于模拟额外转动耗散的现象学力矩。

#### 方向的运动学表示

为了描述颗粒在三维空间中的任意转动并避免使用欧拉角可能导致的奇异性问题（万向锁），通常采用**[四元数](@entry_id:1130460) (Quaternions)** 来表示颗粒的朝向。一个[单位四元数](@entry_id:204470) $\mathbf{q}$ 的变化率与[角速度](@entry_id:192539) $\boldsymbol{\omega}$ 之间的运动学关系为：
$$ \frac{d\mathbf{q}}{dt} = \frac{1}{2}\Omega(\boldsymbol{\omega})\mathbf{q} $$
其中 $\Omega(\boldsymbol{\omega})$ 是一个与 $\boldsymbol{\omega}$ 相关的 $4 \times 4$ 矩阵。通过对这些[常微分方程组](@entry_id:907499)进行数值积分，就可以追踪每个颗粒随时间的平动和转动 。

### 机械相互作用模型：[接触力](@entry_id:165079)定律

接触力模型是[软球DEM](@entry_id:1131848)的核心，它将颗粒间的微观变形物理与宏观动力学联系起来。其基本思想是，允许颗粒几何体在计算上发生微小重叠，并将此重叠量 $\delta$ 视为局部弹性变形的量度，从而计算出排斥力 。

#### 法向接触力

法向[接触力](@entry_id:165079) $F_n$ 主要用于阻止颗粒相互穿透并模拟碰撞过程中的[能量耗散](@entry_id:147406)。

- **线性弹簧-[阻尼模型](@entry_id:748160) (Linear Spring-Dashpot, LSD)**：这是最简单、计算效率最高的模型之一。它将接触模拟为一个并联的线性弹簧和线性阻尼器 。[法向力](@entry_id:174233)表示为：
  $$ F_n = k_n \delta + \eta_n v_n $$
  其中，$k_n$ 是法向刚度系数，$\eta_n$ 是法向[阻尼系数](@entry_id:163719)，$v_n = \dot{\delta}$ 是法向相对速度。弹簧项提供了弹性排斥力，而阻尼项则用于耗散能量，其耗散功率为 $P = \eta_n v_n^2$。该模型的参数 ($k_n, \eta_n$) 通常是根据宏观实验数据（如[恢复系数](@entry_id:170710)）进行标定的。

- **[赫兹接触](@entry_id:200324)模型 (Hertzian Contact Model)**：该模型源于弹性力学理论，描述了两个光滑、弹性、无粘附的曲面在接触时的行为。它预测了[法向力](@entry_id:174233)与重叠量之间存在[非线性](@entry_id:637147)关系 ：
  $$ F_n = \frac{4}{3} E^* \sqrt{R^*} \delta^{3/2} $$
  这里的 $E^*$ 和 $R^*$ 分别是**有效杨氏模量**和**有效半径**，它们综合了两个接触球体的材料属性（杨氏模量 $E_1, E_2$ 和[泊松比](@entry_id:158876) $\nu_1, \nu_2$）和几何形状（半径 $R_1, R_2$）：
  $$ \frac{1}{E^*} = \frac{1-\nu_1^2}{E_1} + \frac{1-\nu_2^2}{E_2}, \qquad \frac{1}{R^*} = \frac{1}{R_1} + \frac{1}{R_2} $$
  赫兹模型是纯弹性的，不包含耗散。为了在DEM中引入[能量耗散](@entry_id:147406)，通常会在赫兹弹簧力的基础上增加一个阻尼项。与LSD模型相比，赫兹模型具有更坚实的物理基础，但计算成本也更高 。我们可以定义一个随重叠量变化的**[切线刚度](@entry_id:166213)** $k_{\text{tan}}(\delta) = \frac{dF_n}{d\delta} = 2 E^* \sqrt{R^*} \delta^{1/2}$，这在分析系统振动特性时非常重要 。

#### [切向接触](@entry_id:201927)力与摩擦

切向力模拟了颗粒间的摩擦行为，这是[颗粒材料](@entry_id:750005)宏观力学响应（如[剪切强度](@entry_id:754762)和稳定性）的关键。一个广泛使用的模型是带有[库仑摩擦](@entry_id:169196)极限的切向[弹簧-阻尼器模型](@entry_id:1132221)。

该模型的核心在于区分**粘着 (sticking)** 和**滑动 (sliding)** 两种状态。在粘着状态下，接触点之间的微小相对位移会导致一个与位移相关的弹性恢复力，类似于一个切向弹簧。这使得模型能够表示[静摩擦力](@entry_id:163518)——即在没有宏观相对滑动时抵抗外力的能力。为了实现这一点，必须**追踪接触历史** 。

具体而言，模型需要为每个接触维护一个**切向弹性[位移矢量](@entry_id:262782)** $\boldsymbol{\xi}_t$。当接触首次形成时，$\boldsymbol{\xi}_t$ 初始化为零。在每个时间步，$\boldsymbol{\xi}_t$ 根据接触点的切向[相对速度](@entry_id:178060) $\mathbf{g}_t$ 进行[增量更新](@entry_id:750602)，同时必须通过投影等操作确保它始终位于随颗粒滚动而变化的接触[切平面](@entry_id:136914)上。一个试探性的切向力 $\mathbf{F}_t^{\text{trial}}$ 由弹性项（依赖于 $\boldsymbol{\xi}_t$）和阻尼项（依赖于 $\mathbf{g}_t$）共同构成：
$$ \mathbf{F}_t^{\text{trial}} = -k_t \boldsymbol{\xi}_t - \gamma_t \mathbf{g}_t $$
其中 $k_t$ 和 $\gamma_t$ 分别是切向刚度和[阻尼系数](@entry_id:163719)。

随后，将该试探力的大小与**[库仑摩擦](@entry_id:169196)极限** $\mu F_n$ 进行比较，其中 $\mu$ 是[动摩擦系数](@entry_id:162794)，$F_n$ 是当前的[法向力](@entry_id:174233)：
- 如果 $\lVert \mathbf{F}_t^{\text{trial}} \rVert \le \mu F_n$，则接触处于粘着状态，最终的切向力 $\mathbf{F}_t = \mathbf{F}_t^{\text{trial}}$。
- 如果 $\lVert \mathbf{F}_t^{\text{trial}} \rVert > \mu F_n$，则接触发生滑动。最终的切向力大小被限制在摩擦极限，其方向与试探力（或相对速度）方向相反：$\mathbf{F}_t = -\mu F_n \frac{\mathbf{F}_t^{\text{trial}}}{\lVert \mathbf{F}_t^{\text{trial}} \rVert}$。在这种情况下，还必须对存储的弹性位移 $\boldsymbol{\xi}_t$ 进行修正，使其与被“截断”后的力保持一致，以确保能量守恒和模型的物理一致性 。

#### [滚动阻力](@entry_id:754415)

除了平[动摩擦](@entry_id:177897)外，颗粒在滚动时也会经历能量耗散。这种现象可以通过引入**[滚动阻力](@entry_id:754415)力矩**来建模。
- 一种常见的模型是**载荷依赖的干摩擦模型**，它模拟了由于接触区域的非对称变形或微观滑移引起的阻力。该力矩的大小与[法向力](@entry_id:174233) $F_n$ 和颗粒半径 $r$ 成正比，方向与角速度相反：
  $$ T_r = -\mu_r F_n r \frac{\boldsymbol{\omega}}{|\boldsymbol{\omega}|} $$
  其中 $\mu_r$ 是一个无量纲的[滚动阻力](@entry_id:754415)系数。这种力矩的大小与角速度无关。
- 另一种模型是**粘性[滚动阻力](@entry_id:754415)模型**，它代表了颗粒在流体中旋转时受到的流体阻力。在[低雷诺数](@entry_id:204816)（[蠕动流](@entry_id:263844)）下，该力矩与[角速度](@entry_id:192539) $\omega$ 和[流体粘度](@entry_id:267219) $\mu_f$ 成正比，并且与颗粒半径的立方 $r^3$ 相关：
  $$ T_v = -8\pi \mu_f r^3 \omega $$
  这两种模型代表了不同的物理机制。干摩擦模型适用于模拟干燥的[颗粒材料](@entry_id:750005)，而粘性模型适用于模拟浆料或[流化床](@entry_id:191273)系统。值得注意的是，由于对半径的依赖性不同（$r$ vs. $r^3$），随着颗粒尺寸的增加，粘性[滚动阻力](@entry_id:754415)的影响会比干摩擦[滚动阻力](@entry_id:754415)增长得更快 。

### 扩展到复杂几何形状

虽然球形颗粒模型在许多应用中很有用，但真实世界的颗粒往往是非球形的。为了捕捉形状对颗粒堆积和流动行为的影响，DEM提供了多种方法，其中最常用的是**团簇法 (Clump-based Method)**。

团簇法通过将多个（可能重叠的）球形颗粒刚性地粘合在一起，形成一个复合[刚体](@entry_id:1131033)来近似一个非球形颗粒。这种方法的优势在于，[接触检测](@entry_id:1122952)和力计算仍然可以在高效的球-球算法基础上进行，而整个团簇则作为一个单一的[刚体](@entry_id:1131033)进行运动学更新 。

一个团簇的动力学属性由其总质量 $M$，[质心](@entry_id:138352)位置 $\mathbf{x}_{\text{COM}}$ 和关于[质心](@entry_id:138352)的**惯性张量** $\mathbf{I}_{\text{COM}}$ 决定。
- **总质量**是所有组成球体质量的总和：$M = \sum m_i$。
- **[质心](@entry_id:138352)位置**是各球体[质心](@entry_id:138352)的质量加权平均：$\mathbf{x}_{\text{COM}} = \frac{1}{M}\sum m_i \mathbf{x}_i$。
- **[惯性张量](@entry_id:148659)**描述了物体[质量分布](@entry_id:158451)对其转动惯性的影响。对于一个团簇，其总[惯性张量](@entry_id:148659) $\mathbf{I}_{\text{COM}}$ 是每个组成球体对总惯性张量贡献的总和。每个球体 $i$ 的贡献需要使用**[平行轴定理](@entry_id:172778)**计算，该定理将其自身关于其[质心](@entry_id:138352)的惯性张量 $\mathbf{I}_{i,cm}$ 转换到团簇的共同[质心](@entry_id:138352)上：
  $$ \mathbf{I}_i = \mathbf{I}_{i,cm} + m_i [(\mathbf{d}_i \cdot \mathbf{d}_i)\mathbf{1} - \mathbf{d}_i \otimes \mathbf{d}_i] $$
  其中 $\mathbf{d}_i = \mathbf{x}_i - \mathbf{x}_{\text{COM}}$ 是从团簇[质心](@entry_id:138352)到球体 $i$ [质心](@entry_id:138352)的[位移矢量](@entry_id:262782)。通过将所有球体的贡献相加（$\mathbf{I}_{\text{COM}} = \sum \mathbf{I}_i$），可以得到一个通常为非对角的[惯性张量](@entry_id:148659)，它能够准确地反映非球形颗粒在转动时的各向异性行为 。

### 数值积分与稳定性

DEM中的[运动方程](@entry_id:264286)是一组[常微分方程组](@entry_id:907499)，通常使用显式时间积分格式（如[速度-Verlet](@entry_id:160498)算法或[中心差分法](@entry_id:163679)）来求解。显式方法的优点是易于实现，且不需要求解大型联立方程组。然而，它们的稳定性受到时间步长 $\Delta t$ 的严格限制。

为了保证[数值稳定性](@entry_id:175146)，时间步长必须足够小，以能够解析系统中最高频率的振荡。在DEM中，这个最高频率通常由最硬的接触决定。我们可以将一个接触理想化为一个由法向弹簧（刚度为 $k$）连接两个质量（$m_i$ 和 $m_j$）的振子。该系统的等效质量为**[折合质量](@entry_id:152420)** $m_{\text{eff}} = \frac{m_i m_j}{m_i + m_j}$，其自然振荡周期为 $T = 2\pi \sqrt{m_{\text{eff}}/k}$。

对于标准显式积分格式，数值稳定性理论表明，时间步长 $\Delta t$ 必须小于[临界时间步长](@entry_id:178088) $\Delta t_c$ 的某个比例。这个[临界时间步长](@entry_id:178088)与系统最短的自然周期成正比：
$$ \Delta t_c \propto \sqrt{\frac{m_{\text{eff}}}{k}} $$
对于无阻尼的中心差分格式，精确的稳定性极限是 $\Delta t \le 2\sqrt{m_{\text{eff}}/k}$。然而，在实际的DEM模拟中，还存在切向振动、阻尼和其他[非线性](@entry_id:637147)因素。为了确保模拟的鲁棒性，必须采用一个远小于1的**安全因子** $s$。通常，选择的时间步长为：
$$ \Delta t = s \cdot \Delta t_c $$
一个审慎的实践是选择 $s$ 在 $[0.1, 0.2]$ 的范围内，以确保所有相关的动力学模式都能被稳定地解析 。

### 热现象的建模

对于热工应用，将[热力学原理](@entry_id:142232)整合到DEM框架中至关重要。这涉及为每个颗粒求解一个[能量平衡方程](@entry_id:191484)，并对颗粒间的各种热传递机制进行建模。

每个颗粒的温度 $T_p$ 随时间的变化由热力学第一定律决定：
$$ m_p c_p \frac{dT_p}{dt} = \sum \dot{Q}_{\text{in/out}} + \dot{Q}_{\text{source}} $$
其中 $m_p$ 和 $c_p$ 是颗粒的质量和比热容，$\sum \dot{Q}_{\text{in/out}}$ 是所有热传递模式导致的净热流率，$\dot{Q}_{\text{source}}$ 是内部热源项。

#### 热量的产生

在[颗粒系统](@entry_id:1129404)中，一个重要的内热源来自于机械能的耗散。在[软球模型](@entry_id:755009)中，由[非弹性碰撞](@entry_id:137360)（法向阻尼）和摩擦滑动（切向力做功）所耗散的机械功会转化为热能。由于[软球模型](@entry_id:755009)在时间上解析了[接触过程](@entry_id:152214)，因此可以很自然地计算出耗散功率，并将其作为热源项添加到接触颗粒的能量方程中 。

#### 热传递机制

[颗粒系统](@entry_id:1129404)中的热传递主要通过以下三种机制发生：

1.  **接触导热**：当颗粒物理接触时，热量通过接触区域传导。由于真实表面的粗糙性，实际的导热面积（**[真实接触面积](@entry_id:199283)** $A_r$）远小于由弹性变形决定的宏观**名义接触面积** $A_n$。这种热流路径的“收缩”效应导致了所谓的**热接触阻力**。在DEM中，这种复杂的微观现象通常被一个有效的**热接触传导系数** $h_c$ [单位：$\mathrm{W/(m^2 \cdot K)}$] 所宏观表征。它将通过接触界面的平均热流密度 $q'' = Q/A_n$ 与界面两侧的宏观温度差 $\Delta T$ 联系起来：
    $$ q'' = h_c \Delta T $$
    $h_c$ 的值取决于接触压力、材料属性和[表面粗糙度](@entry_id:171005)等因素 。

2.  **对流换热**：当颗粒与周围流体存在温差时，会发生[对流换热](@entry_id:151349)。这种相间热传递的速率由牛顿冷却定律描述：
    $$ q = h_p A_p (T_p - T_f) $$
    其中，$A_p$ 是颗粒表面积，$T_f$ 是周围流体的温度，$h_p$ 是**相间[换热系数](@entry_id:155200)**。$h_p$ 通常通过无量纲的**努塞尔数 ($Nu$)** 来计算，$Nu = h_p d_p / k_f$，其中 $d_p$ 是颗粒直径，$k_f$ 是流体的导热系数。努塞尔数本身则常常通过实验或[数值模拟](@entry_id:146043)得到的经验关联式来确定，这些关联式通常是**颗粒雷诺数 ($Re_p$)** 和**[普朗特数](@entry_id:143303) ($Pr$)** 的函数，例如广泛使用的[Ranz-Marshall关联式](@entry_id:754072)：
    $$ Nu = 2 + 0.6 Re_p^{1/2} Pr^{1/3} $$

3.  **辐射换热**：在高温应用中，颗粒之间的热辐射可能成为一个重要的热传递模式。对于不透明的颗粒，可以基于它们的表面温度、发射率和相互之间的**[角系数](@entry_id:149598) (view factors)** 建立一个辐射网络模型来计算辐射热流。这种建模方法与DEM的力学求解器（无论是软球还是硬球）是基本兼容的，因为它主要依赖于系统的几何构型和温度分布 。

在包含流体的热-力耦合模拟中（如CFD-DEM），选择合适的时间步长变得尤为重要。模拟的时间步长不仅要满足DEM力学计算的稳定性要求，还必须小于流体动力学（如CFL条件）和热传递过程的[特征时间尺度](@entry_id:276738)，以保证整个耦合系统的稳定性和准确性 。