{
    "hands_on_practices": [
        {
            "introduction": "欧拉-欧拉模型的一个主要目标是预测各相之间的相对运动，即滑移速度。这个练习将演示如何通过对分散相颗粒进行基本的力平衡分析来确定该速度。通过平衡相间曳力、重力和浮力，您将计算出稳态滑移速度，这是理解和模拟多相流系统的一个关键参数 。",
            "id": "3951452",
            "problem": "一种由刚性、单分散球形颗粒组成的稀悬浮液，在牛顿液体中通过半径为$R$的长圆形管道，进行稳定、充分发展的层流输送。流动方向为垂直向上。您需要使用欧拉-欧拉双流体框架对该系统进行建模，相间传递仅限于阻力和浮力，忽略附加质量、Basset历史力、升力和湍流扩散。假设颗粒相足够稀疏，以至于颗粒间的相互作用和阻碍沉降可以忽略不计，并且基于局部滑移速度的颗粒雷诺数足够小，可以事后证明蠕动流极限是合理的。\n\n已知：\n- 管道半径：$R = 0.02 \\ \\mathrm{m}$。\n- 载液：密度 $\\rho_{f} = 1000 \\ \\mathrm{kg/m^{3}}$，动力粘度 $\\mu = 1.0 \\times 10^{-3} \\ \\mathrm{Pa \\cdot s}$。\n- 颗粒：密度 $\\rho_{p} = 2500 \\ \\mathrm{kg/m^{3}}$，直径 $d_{p} = 100 \\ \\mu\\mathrm{m}$。\n- 平均轴向液体速度（单相参考）：$U_{m} = 0.20 \\ \\mathrm{m/s}$。\n- 重力加速度：$g = 9.81 \\ \\mathrm{m/s^{2}}$。\n- 颗粒体积分数：$\\alpha_{p} \\ll 1$（稀疏极限）。\n\n在欧拉-欧拉双流体描述中，对分散相采用稳态代数轴向动量平衡，其中相间阻力与净轴向体力差（重力减去浮力）相平衡。设相间阻力由单个孤立球体的标准阻力定律表示，其阻力系数是颗粒雷诺数$\\mathrm{Re}_{p}$的函数，$\\mathrm{Re}_{p}$使用滑移速度大小$|u_{s}|$和载液性质定义为$\\mathrm{Re}_{p} = \\rho_{f} d_{p} |u_{s}| / \\mu$。在蠕动流极限下，使用斯托克斯（Stokes）表达式计算阻力系数，$C_{d} = 24 / \\mathrm{Re}_{p}$。\n\n仅使用基本平衡和定义，推导局部稳态滑移速度分布$u_{s}(r)$，其中$u_{s} \\equiv u_{p} - u_{f}$是颗粒-流体的轴向相对速度。然后，根据给定的性质，数值计算其大小$|u_{s}(r)|$。明确说明结果是否依赖于径向坐标$r$。将您的最终数值答案表示为滑移速度的大小，单位为$\\mathrm{m/s}$，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导和评估在层流管流中稀疏颗粒悬浮液的局部稳态滑移速度分布$u_{s}(r)$。建模框架被指定为分散（颗粒）相的稳态代数轴向动量平衡，其中相间阻力与净体力（重力减去浮力）相平衡。\n\n设垂直向上方向为$z$轴正方向。重力加速度矢量向下，因此其分量为$g_z = -g$。流动被视为轴向的一维流动。\n\n问题的框架允许我们考虑单个代表性球形颗粒上的力平衡，因为悬浮液是稀疏的（$\\alpha_p \\ll 1$），这意味着颗粒间的相互作用以及颗粒相对流体整体性质的影响可以忽略不计。指定的代数动量平衡等效于颗粒的终端速度条件，但在移动的流体中，我们关心的速度是相对（滑移）速度。\n\n在轴向（$z$）方向上作用于单个颗粒的力有：\n$1$. **重力 ($F_{g,z}$)**：这是颗粒的重量，方向向下。\n$$F_{g,z} = -m_p g = -\\rho_p V_p g$$\n其中$\\rho_p$是颗粒密度，$V_p$是单个球形颗粒的体积，由$V_p = \\frac{1}{6}\\pi d_p^3$给出。\n\n$2$. **浮力 ($F_{b,z}$)**：这是由流体施加的向上作用力，等于颗粒排开的流体的重量。\n$$F_{b,z} = \\rho_f V_p g$$\n其中$\\rho_f$是流体密度。\n\n$3$. **阻力 ($F_{d,z}$)**：此力与颗粒和流体之间的相对运动方向相反。滑移速度定义为$u_s = u_p - u_f$，其中$u_p$和$u_f$分别是颗粒和流体的轴向速度。阻力由标准公式给出：\n$$F_d = \\frac{1}{2} C_d \\rho_f A_p |u_s| u_s$$\n对于一维轴向流动，阻力矢量与滑移速度矢量方向相反。因此，轴向分量与$-u_s$成正比。问题指定在蠕动流极限下使用斯托克斯阻力定律，其中阻力系数$C_d$为：\n$$C_d = \\frac{24}{\\mathrm{Re}_p}$$\n颗粒雷诺数$\\mathrm{Re}_p$基于滑移速度定义：\n$$\\mathrm{Re}_p = \\frac{\\rho_f d_p |u_s|}{\\mu}$$\n将$C_d$的表达式代入阻力公式，其中$A_p = \\frac{1}{4}\\pi d_p^2$是颗粒的投影面积，我们得到斯托克斯阻力：\n$$F_{d,z} = -\\frac{1}{2} \\left( \\frac{24\\mu}{\\rho_f d_p |u_s|} \\right) \\rho_f \\left( \\frac{\\pi d_p^2}{4} \\right) |u_s| u_s = -3\\pi\\mu d_p u_s$$\n\n根据题意，稳态动量平衡要求这些力的总和为零：\n$$F_{g,z} + F_{b,z} + F_{d,z} = 0$$\n$$-\\rho_p V_p g + \\rho_f V_p g - 3\\pi\\mu d_p u_s = 0$$\n现在我们可以求解滑移速度$u_s$：\n$$3\\pi\\mu d_p u_s = (\\rho_f - \\rho_p) V_p g$$\n代入颗粒体积的表达式$V_p = \\frac{1}{6}\\pi d_p^3$：\n$$3\\pi\\mu d_p u_s = (\\rho_f - \\rho_p) \\left(\\frac{1}{6}\\pi d_p^3\\right) g$$\n$$u_s = \\frac{(\\rho_f - \\rho_p) g \\pi d_p^3}{18\\pi\\mu d_p}$$\n$$u_s = \\frac{d_p^2 g}{18\\mu}(\\rho_f - \\rho_p)$$\n这个推导出的$u_s$表达式代表了局部稳态滑移速度。我们观察到它仅取决于颗粒和流体的物理性质以及重力加速度。它不依赖于径向坐标$r$。因此，滑移速度分布$u_s(r)$是一个常数，与管道内的位置无关。\n\n接下来，我们使用给定的数值对该表达式进行数值计算：\n- 颗粒直径：$d_p = 100 \\ \\mu\\mathrm{m} = 1.0 \\times 10^{-4} \\ \\mathrm{m}$\n- 重力加速度：$g = 9.81 \\ \\mathrm{m/s^2}$\n- 流体动力粘度：$\\mu = 1.0 \\times 10^{-3} \\ \\mathrm{Pa \\cdot s}$\n- 流体密度：$\\rho_f = 1000 \\ \\mathrm{kg/m^3}$\n- 颗粒密度：$\\rho_p = 2500 \\ \\mathrm{kg/m^3}$\n\n$$u_s = \\frac{(1.0 \\times 10^{-4})^2 \\times 9.81}{18 \\times (1.0 \\times 10^{-3})} (1000 - 2500)$$\n$$u_s = \\frac{(1.0 \\times 10^{-8}) \\times 9.81}{1.8 \\times 10^{-2}} (-1500)$$\n$$u_s = \\frac{9.81 \\times (-1500)}{1.8} \\times 10^{-6}$$\n$$u_s = -8175 \\times 10^{-6} \\ \\mathrm{m/s} = -0.008175 \\ \\mathrm{m/s}$$\n负号正确地表明颗粒速度小于流体速度（$u_p  u_f$），因为密度较大的颗粒相对于向上流动的流体发生沉降。\n\n问题要求滑移速度的大小$|u_s(r)|$：\n$$|u_s(r)| = |-0.008175 \\ \\mathrm{m/s}| = 0.008175 \\ \\mathrm{m/s}$$\n根据要求，此结果保留四位有效数字。\n\n最后，我们对颗粒雷诺数进行事后检查，以确认蠕动流假设的一致性：\n$$\\mathrm{Re}_p = \\frac{\\rho_f d_p |u_s|}{\\mu} = \\frac{(1000) \\times (1.0 \\times 10^{-4}) \\times (0.008175)}{1.0 \\times 10^{-3}} = 0.8175$$\n斯托克斯阻力定律在$\\mathrm{Re}_p \\ll 1$（通常$\\mathrm{Re}_p  0.1$）时最为准确。$\\mathrm{Re}_p \\approx 0.82$的值表明，在斯托克斯定律中被忽略的惯性效应开始变得显著。然而，由于问题明确指示使用斯托克斯表达式，因此在指定的模型约束下，推导出的结果是正确的解。推导出的滑移速度确实与径向坐标$r$无关。",
            "answer": "$$\\boxed{0.008175}$$"
        },
        {
            "introduction": "除了动量传递，相间传热是许多热工流体系统中的另一个关键过程。本练习将从直接的力平衡分析转向使用经验关联式，这是工程建模的基石。您将通过量纲分析推导无量纲的努塞尔数($Nu_i$)，并将其与雷诺数($Re_p$)和普朗特数($Pr$)联系起来，从而在基础传递现象与模拟中使用的实用封闭关系式之间建立联系 。",
            "id": "3951399",
            "problem": "考虑一个分散的气相，由直径为$d_b$的单分散气泡组成，在垂直柱中通过连续液相上升。流动和热场使用欧拉-欧拉双流体框架进行建模，其中每个相都遵循其自身的质量、动量和能量方程，并包含相间交换项。在能量方程中，相间传热由形式为$S_T = h_i a_i \\left( T_g - T_c \\right)$的体积源项表示，其中$h_i$是相间传热系数，$a_i$是界面面积密度，$T_g$和$T_c$分别是气相和连续相的温度。假设如下：\n- 连续相具有恒定的密度$\\rho_c$、动力粘度$\\mu_c$、导热系数$k_c$和定压比热容$c_{p,c}$。\n- 相间的局部滑移速度为$u_{sl} = |\\boldsymbol{u}_g - \\boldsymbol{u}_c|$，基于连续相的气泡雷诺数定义为$Re_p = \\dfrac{\\rho_c u_{sl} d_b}{\\mu_c}$。\n- 连续相的普朗特数为$Pr = \\dfrac{c_{p,c} \\mu_c}{k_c}$。\n- 不存在相变，气泡表面温度均匀，热边界层内的物性变化可以忽略不计，且每个气泡周围的流动是稳态和轴对称的，相对于$d_b$具有薄热边界层。\n\n从单个气泡周围连续相中的稳态对流-扩散能量方程以及通过气泡表面积分热通量定义的相间传热系数出发，对控制方程和边界条件进行无量纲化，以推导形式为$Nu_i = \\dfrac{h_i d_b}{k_c}$的相间交换无量纲传热数。使用与所述假设一致的、适用于粘性流体中平移球体周围传热的、恰当且合理的关联式，将$Nu_i$与$Re_p$和$Pr$联系起来。\n\n将$Nu_i$的最终结果明确表示为$\\rho_c$、$\\mu_c$、$k_c$、$c_{p,c}$、$d_b$和$u_{sl}$的闭式解析函数。不需要进行数值计算。最终答案是无量纲的；不包括单位。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的、客观的和自洽的。它提出了一个对流传热和多相流建模中的标准问题。因此，我们可以进行形式化的求解。\n\n目标是推导相间努塞尔数$Nu_i$作为连续相物理性质和流动条件的函数表达式。这将分两个阶段完成。首先，我们将对控制能量方程进行无量纲化，以正式建立传热对雷诺数和普朗特数的依赖关系。其次，我们将选择一个恰当且物理上合理的关联式来指定这种函数依赖性。\n\n该问题考虑的是从单个直径为$d_b$的气泡到周围连续液相的传热。在与气泡同动的参考系中进行分析最为方便。在此参考系中，气泡是静止的，连续相以大小为$u_{sl}$的远场速度接近。对于连续相，忽略粘性耗散和内部热生成，其稳态能量方程是对流-扩散方程：\n$$\n\\rho_c c_{p,c} (\\boldsymbol{u} \\cdot \\nabla T) = k_c \\nabla^2 T\n$$\n这里，$\\boldsymbol{u}$和$T$分别是连续相中的局部速度和温度场。物理性质$\\rho_c$、$c_{p,c}$和$k_c$假定为常数。\n\n温度场的边界条件为：\n1. 在气泡表面，$r = d_b/2$：假设温度是均匀的，$T = T_s$。为了定义传热系数，该表面温度是驱动热通量的参考温度。通常假设它接近于气体的体相温度$T_g$。\n2. 远离气泡处，$r \\to \\infty$：温度趋近于连续相的体相温度，$T \\to T_c$。\n\n为了对问题进行无量纲化，我们引入以下无量纲变量：\n- 无量纲温度：$\\Theta = \\dfrac{T - T_c}{T_s - T_c}$\n- 无量纲速度：$\\boldsymbol{u}^* = \\dfrac{\\boldsymbol{u}}{u_{sl}}$\n- 无量纲空间坐标，使用气泡直径$d_b$作为特征长度尺度：$\\boldsymbol{x}^* = \\dfrac{\\boldsymbol{x}}{d_b}$。因此，梯度算子变为$\\nabla = \\dfrac{1}{d_b} \\nabla^*$。\n\n将这些代入能量方程：\n$$\n\\rho_c c_{p,c} \\left( (u_{sl} \\boldsymbol{u}^*) \\cdot \\left( \\frac{1}{d_b} \\nabla^* \\left( (T_s - T_c)\\Theta + T_c \\right) \\right) \\right) = k_c \\left( \\frac{1}{d_b^2} \\nabla^{*2} \\left( (T_s - T_c)\\Theta + T_c \\right) \\right)\n$$\n由于$T_s$、$T_c$和$u_{sl}$是常数，方程简化为：\n$$\n\\rho_c c_{p,c} u_{sl} \\frac{T_s - T_c}{d_b} (\\boldsymbol{u}^* \\cdot \\nabla^* \\Theta) = k_c \\frac{T_s - T_c}{d_b^2} \\nabla^{*2} \\Theta\n$$\n两边同除以$\\dfrac{k_c(T_s - T_c)}{d_b^2}$，得到无量纲能量方程：\n$$\n\\left( \\frac{\\rho_c u_{sl} d_b}{\\mu_c} \\right) \\left( \\frac{c_{p,c} \\mu_c}{k_c} \\right) (\\boldsymbol{u}^* \\cdot \\nabla^* \\Theta) = \\nabla^{*2} \\Theta\n$$\n出现的无量纲群组是雷诺数$Re_p = \\dfrac{\\rho_c u_{sl} d_b}{\\mu_c}$和普朗特数$Pr = \\dfrac{c_{p,c} \\mu_c}{k_c}$。因此，无量纲方程为：\n$$\nRe_p Pr (\\boldsymbol{u}^* \\cdot \\nabla^* \\Theta) = \\nabla^{*2} \\Theta\n$$\n无量纲边界条件是在表面$r^* = 1/2$处$\\Theta=1$，以及当$r^* \\to \\infty$时$\\Theta=0$。该系统的解$\\Theta(\\boldsymbol{x}^*)$仅依赖于参数$Re_p$和$Pr$。\n\n相间传热系数$h_i$由气泡表面$A_b = \\pi d_b^2$的总传热速率$Q$定义：\n$$\nQ = h_i A_b (T_s - T_c)\n$$\n传热速率$Q$也可通过对气泡表面的局部热通量进行积分得到：\n$$\nQ = \\int_{A_b} \\left( -k_c \\frac{\\partial T}{\\partial n} \\right) dS\n$$\n其中$\\frac{\\partial}{\\partial n}$是指向连续相的表面法向导数。在球坐标中，这是$\\left. -k_c \\frac{\\partial T}{\\partial r} \\right|_{r=d_b/2}$。\n令两个$Q$的表达式相等，解出$h_i$：\n$$\nh_i = \\frac{1}{A_b(T_s-T_c)} \\int_{A_b} \\left( -k_c \\left. \\frac{\\partial T}{\\partial r} \\right|_{r=d_b/2} \\right) dS\n$$\n现在，我们用无量纲形式表示温度梯度：$\\dfrac{\\partial T}{\\partial r} = \\dfrac{T_s - T_c}{d_b} \\dfrac{\\partial \\Theta}{\\partial r^*}$。\n$$\nh_i = \\frac{-k_c}{A_b d_b} \\int_{A_b} \\left. \\frac{\\partial \\Theta}{\\partial r^*} \\right|_{r^*=1/2} dS\n$$\n努塞尔数$Nu_i$定义为无量纲传热系数：\n$$\nNu_i = \\frac{h_i d_b}{k_c} = -\\frac{1}{A_b} \\int_{A_b} \\left. \\frac{\\partial \\Theta}{\\partial r^*} \\right|_{r^*=1/2} dS = - \\overline{\\left. \\frac{\\partial \\Theta}{\\partial r^*} \\right|_{r^*=1/2}}\n$$\n这表明努塞尔数是气泡表面处面积平均的无量纲温度梯度。由于无量纲温度场$\\Theta$是$Re_p$和$Pr$的函数，因此努塞尔数也必须是这两个无量纲群组的函数：$Nu_i = f(Re_p, Pr)$。\n\n任务的第二部分是使用一个合适的关联式为该函数提供一个显式形式。问题中“薄热边界层”的假设指导了我们的选择。该条件出现在高佩克莱数（$Pe_p = Re_p Pr \\gg 1$）下，此时对流在传热中占主导地位。一个广泛使用且有充分理由的、用于强制对流中刚性球体传热的经验关联式是 Ranz-Marshall 关联式：\n$$\nNu_i = 2.0 + 0.6 Re_p^{1/2} Pr^{1/3}\n$$\n该关联式是合适的，原因有几点：\n1. 对于静止介质中的纯导热（$Re_p = 0$），它能正确地简化为$Nu_i = 2.0$的理论极限。\n2. 对流项$0.6 Re_p^{1/2} Pr^{1/3}$与中高雷诺数流动的理论边界层分析一致，这与“薄热边界层”的假设相符。\n3. 它是多相流建模中用于分散颗粒或气泡的标准关联式，特别是在假设表面不可移动时（例如，由于表面活性剂的存在）。\n\n为了得到最终表达式，我们将$Re_p$和$Pr$的定义代入 Ranz-Marshall 关联式中：\n$$\nNu_i = 2 + 0.6 \\left( \\frac{\\rho_c u_{sl} d_b}{\\mu_c} \\right)^{1/2} \\left( \\frac{c_{p,c} \\mu_c}{k_c} \\right)^{1/3}\n$$\n这就是相间努塞尔数$Nu_i$作为指定物理性质和流动参数的函数的闭式解析表达式。",
            "answer": "$$\n\\boxed{2 + 0.6 \\left( \\frac{\\rho_c u_{sl} d_b}{\\mu_c} \\right)^{1/2} \\left( \\frac{c_{p,c} \\mu_c}{k_c} \\right)^{1/3}}\n$$"
        },
        {
            "introduction": "精确的物理模型需要稳健的数值实现。欧拉框架中的一个基本约束是各相的体积分数之和($\\sum_k \\alpha_k = 1$)必须恒为一，但标准的数值格式可能会违反这一约束。本练习旨在解决这一关键的实现细节，您将量化一个非守恒格式所产生的数值误差，然后实现一个投影算法来强制执行该约束。这项实践对于开发稳定且物理上一致的多相流求解器至关重要 。",
            "id": "3951394",
            "problem": "考虑一个一维混合物的欧拉-欧拉双流体模型，其中$k$相的体积分数为$\\alpha_k(x,t)$，所有相共享一个共同的混合速度$u(x,t)$。对于$m$个相，该混合物在所有点$x$处都满足代数约束$\\sum_{k=1}^m \\alpha_k(x,t) = 1$。设各相的控制演化为对流-反应方程\n$$\n\\frac{\\partial \\alpha_k}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\alpha_k u\\right) = S_k,\n$$\n其中相间传递源$S_k$满足$\\sum_{k=1}^m S_k = 0$，从而使得连续模型保持$\\sum_k \\alpha_k = 1$。任务是分析和量化在使用非守恒空间离散的情况下，经过一个显式时间步后对该约束的离散违背程度，然后构建一个投影，该投影在逐点强制$\\sum_{k=1}^m \\alpha_k = 1$的同时，保持$0 \\le \\alpha_k \\le 1$。\n\n从守恒形式和约束$\\sum_{k=1}^m S_k = 0$出发，考虑在域$x \\in [0,1]$上一个包含$N$个点的均匀网格，其间距为$\\Delta x = 1/(N-1)$。对每一相使用一个从$t^n$到$t^{n+1}$、大小为$\\Delta t$的单显式前向欧拉时间步，\n$$\n\\alpha_k^{n+1}(x_i) = \\alpha_k^n(x_i) - \\Delta t \\left[\\frac{\\partial}{\\partial x}(\\alpha_k^n u^n)\\right]_{x=x_i} + \\Delta t\\,S_k^n(x_i),\n$$\n其中空间导数在内部点由中心差分近似，在边界由单边差分近似，如下所示：\n- 对于内部索引$i = 1, \\ldots, N-2$，\n$$\n\\left[\\frac{\\partial}{\\partial x}(\\alpha_k u)\\right]_{x=x_i} \\approx \\frac{\\alpha_k^n(x_{i+1})u^n(x_{i+1}) - \\alpha_k^n(x_{i-1})u^n(x_{i-1})}{2\\Delta x}.\n$$\n- 对于左边界$i = 0$，\n$$\n\\left[\\frac{\\partial}{\\partial x}(\\alpha_k u)\\right]_{x=x_0} \\approx \\frac{\\alpha_k^n(x_{1})u^n(x_{1}) - \\alpha_k^n(x_{0})u^n(x_{0})}{\\Delta x}.\n$$\n- 对于右边界$i = N-1$，\n$$\n\\left[\\frac{\\partial}{\\partial x}(\\alpha_k u)\\right]_{x=x_{N-1}} \\approx \\frac{\\alpha_k^n(x_{N-1})u^n(x_{N-1}) - \\alpha_k^n(x_{N-2})u^n(x_{N-2})}{\\Delta x}.\n$$\n\n相间传递通过一个相向指定的平衡分布$\\alpha_{\\mathrm{eq}}(x)$的线性松弛来建模，其余相的源项大小相等、方向相反，以保持总和不变：\n$$\nS_1(x) = \\lambda\\left(\\alpha_{\\mathrm{eq}}(x) - \\alpha_1(x)\\right), \\quad S_2(x) = -S_1(x), \\quad \\text{for } m=2,\n$$\n更一般地，有$\\sum_{k=1}^m S_k(x)=0$。尽管连续模型保持了总和，但在所述的边界处理下，上述格式在$\\sum_k \\alpha_k$上不是离散守恒的，因此一个时间步后通常会产生数值误差。\n\n将一个时间步后总和的数值误差定义为离散无穷范数\n$$\ne_\\infty = \\max_{0 \\le i \\le N-1} \\left| \\sum_{k=1}^m \\alpha_k^{n+1,*}(x_i) - 1 \\right|,\n$$\n其中$\\alpha_k^{n+1,*}$表示未投影的更新值。现在，设计并应用一个逐点投影，对所有$i$和$k$强制满足$\\sum_{k=1}^m \\alpha_k^{n+1}(x_i)=1$和$0 \\le \\alpha_k^{n+1}(x_i) \\le 1$。该投影必须构造成在每个网格点$x_i$处以下带约束的调整问题的解：\n$$\n\\min_{\\{\\delta_k\\}_{k=1}^m} \\sum_{k=1}^m w_k \\delta_k^2 \\quad \\text{subject to} \\quad \\sum_{k=1}^m \\delta_k = 1 - \\sum_{k=1}^m \\alpha_k^{n+1,*}(x_i), \\quad 0 \\le \\alpha_k^{n+1,*}(x_i) + \\delta_k \\le 1,\n$$\n权重为$w_k = 1$。解应将所需的校正量平均分配给非饱和相，并通过迭代剪裁来强制执行边界，直到总和约束在一个小的容差范围内得到满足。\n\n您必须为以下测试套件实现该格式和投影。所有量均为无量纲；将所有输出报告为无量纲实数。\n\n测试套件：\n- 测试用例 $1$ (一般平滑情况):\n  - 相数$m = 2$，网格点数$N = 50$，时间步长$\\Delta t = 0.005$。\n  - 速度$u(x) = 0.5 \\sin(2\\pi x)$。\n  - 初始值$\\alpha_1^n(x) = 0.6 + 0.2 \\sin(2\\pi x)$，以及$\\alpha_2^n(x) = 1 - \\alpha_1^n(x)$。\n  - 松弛率$\\lambda = 1.0$，平衡值$\\alpha_{\\mathrm{eq}}(x) = 0.5$。\n- 测试用例 $2$ (近真空和强传递):\n  - 相数$m = 2$，网格点数$N = 50$，时间步长$\\Delta t = 0.01$。\n  - 速度$u(x) = 0.8$。\n  - 初始值$ \\alpha_1^n(x) = \n    \\begin{cases}\n    10^{-6},  x  0.4,\\\\\n    0.5,  0.4 \\le x \\le 0.6,\\\\\n    1 - 10^{-6},  x  0.6,\n    \\end{cases}\n  $以及$\\alpha_2^n(x) = 1 - \\alpha_1^n(x)$。\n  - 松弛率$\\lambda = 10.0$，平衡值$\\alpha_{\\mathrm{eq}}(x) = 0.2$。\n- 测试用例 $3$ (粗网格和大时间步):\n  - 相数$m = 2$，网格点数$N = 5$，时间步长$\\Delta t = 0.2$。\n  - 速度$u(x) = -1 + 2x$ (从$ -1 $到$ 1 $线性变化)。\n  - 初始值$\\alpha_1^n(x)$从$x=0$处的$0.9$线性递减到$x=1$处的$0.1$，以及$\\alpha_2^n(x) = 1 - \\alpha_1^n(x)$。\n  - 松弛率$\\lambda = 5.0$，平衡值$\\alpha_{\\mathrm{eq}}(x) = 0.7$。\n\n对于每个测试用例，执行恰好一次定义的显式更新，计算投影前的$e_\\infty$，在每个网格点应用投影，然后计算投影后的误差\n$$\ne_\\infty^{\\mathrm{proj}} = \\max_{0 \\le i \\le N-1} \\left| \\sum_{k=1}^m \\alpha_k^{n+1}(x_i) - 1 \\right|.\n$$\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，并且本身是一个双元素列表$[e_\\infty, e_\\infty^{\\mathrm{proj}}]$。例如，输出格式必须为$[[e_1,e_1^{\\mathrm{proj}}],[e_2,e_2^{\\mathrm{proj}}],[e_3,e_3^{\\mathrm{proj}}]]$，不含任何额外的空白或文本。",
            "solution": "用户提供的问题是有效的，因为它在计算流体动力学方面具有科学依据，在数学上是适定的，并提供了一套完整且一致的定义和参数。求解过程如下。\n\n### 1. 模型与离散化\n该问题描述了一个包含$m$个相的混合物的欧拉-欧拉模型，这些相共享一个共同的速度场$u(x,t)$。各相体积分数$\\alpha_k(x,t)$的演化由对流-反应方程控制：\n$$\n\\frac{\\partial \\alpha_k}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\alpha_k u\\right) = S_k\n$$\n其中$S_k$是相间传递源项。物理约束是体积分数的总和必须为一，即$\\sum_{k=1}^m \\alpha_k(x,t) = 1$，并且位于$0 \\le \\alpha_k(x,t) \\le 1$的界限内。连续模型能够保持总和为一的约束，因为源项总和为零，即$\\sum_{k=1}^m S_k = 0$，并将控制方程对所有相$k$求和，可得：\n$$\n\\frac{\\partial}{\\partial t}\\left(\\sum_k \\alpha_k\\right) + \\frac{\\partial}{\\partial x}\\left(\\left(\\sum_k \\alpha_k\\right) u\\right) = \\sum_k S_k\n$$\n代入$\\sum_k \\alpha_k = 1$和$\\sum_k S_k = 0$，上式变为：\n$$\n\\frac{\\partial (1)}{\\partial t} + \\frac{\\partial u}{\\partial x} = 0 \\implies \\frac{\\partial u}{\\partial x} = 0\n$$\n这意味着只有当速度场在空间上是均匀时，连续模型才能严格保持总和约束。对于非均匀速度场，总和约束根据$\\frac{\\partial}{\\partial t}(\\sum_k \\alpha_k) = - \\frac{\\partial u}{\\partial x}$演化，这意味着如果从一开始就假设$\\sum_k \\alpha_k = 1$，则该约束不会被保持。然而，该问题关注的是离散违背，其产生方式有所不同。\n\n时间离散采用单步显式前向欧拉法，空间项在间距为$\\Delta x$的均匀网格$\\{x_i\\}$上使用有限差分法。在时间步$n+1$时$\\alpha_k$的未投影更新值，记作$\\alpha_k^{n+1,*}$，为：\n$$\n\\alpha_k^{n+1,*} (x_i) = \\alpha_k^n(x_i) - \\Delta t \\left[\\frac{\\partial}{\\partial x}(\\alpha_k^n u^n)\\right]_{x=x_i} + \\Delta t\\,S_k^n(x_i)\n$$\n由于在边界和内部使用不同的模板，该空间导数算子是非守恒的。\n\n### 2. 离散约束违背分析\n将离散更新方程在网格点$x_i$处对所有相$k$求和：\n$$\n\\sum_{k=1}^m \\alpha_k^{n+1,*}(x_i) = \\sum_{k=1}^m \\alpha_k^n(x_i) - \\Delta t \\sum_{k=1}^m \\left[\\frac{\\partial}{\\partial x}(\\alpha_k^n u^n)\\right]_{x_x=x_i} + \\Delta t \\sum_{k=1}^m S_k^n(x_i)\n$$\n给定$\\sum_k \\alpha_k^n(x_i) = 1$和模型属性$\\sum_k S_k^n = 0$，上式简化为：\n$$\n\\sum_{k=1}^m \\alpha_k^{n+1,*}(x_i) = 1 - \\Delta t \\left[\\frac{\\partial}{\\partial x}\\left(\\left(\\sum_k \\alpha_k^n \\right)u^n\\right)\\right]_{x_i}^{\\text{discrete}} = 1 - \\Delta t \\left[\\frac{\\partial u^n}{\\partial x}\\right]_{x_i}^{\\text{discrete}}\n$$\n其中$\\left[\\frac{\\partial u^n}{\\partial x}\\right]_{x_i}^{\\text{discrete}}$是速度梯度的有限差分近似：\n$$\n\\left[\\frac{\\partial u}{\\partial x}\\right]_{x_i}^{\\text{discrete}} = \n\\begin{cases}\n    (u(x_1) - u(x_0))/\\Delta x,  i = 0 \\\\\n    (u(x_{i+1}) - u(x_{i-1}))/(2\\Delta x),  i = 1, \\ldots, N-2 \\\\\n    (u(x_{N-1}) - u(x_{N-2}))/\\Delta x,  i = N-1\n\\end{cases}\n$$\n更新后的体积分数之和$\\sum_k \\alpha_k^{n+1,*} (x_i)$与$1$的偏差量为$- \\Delta t \\left[\\frac{\\partial u}{\\partial x}\\right]_{x_i}^{\\text{discrete}}$。只要离散速度梯度非零，该偏差就非零。投影前误差由无穷范数$e_\\infty = \\max_i \\left| \\sum_k \\alpha_k^{n+1,*}(x_i) - 1 \\right|$量化。\n\n### 3. 用于强制执行约束的投影\n为恢复物理约束，在每个网格点$x_i$应用一个投影。更新后的值$\\alpha_k^{n+1,*} (x_i)$通过校正量$\\delta_k(x_i)$进行调整，以获得最终值$\\alpha_k^{n+1}(x_i) = \\alpha_k^{n+1,*} (x_i) + \\delta_k(x_i)$。校正量通过求解以下带约束的最小化问题得到：\n$$\n\\min_{\\{\\delta_k\\}} \\sum_{k=1}^m \\delta_k^2 \\quad \\text{subject to} \\quad \\sum_{k=1}^m \\delta_k = 1 - \\sum_{k=1}^m \\alpha_k^{n+1,*}, \\quad 0 \\le \\alpha_k^{n+1,*} + \\delta_k \\le 1\n$$\n对于$m=2$相的特定情况，该问题有一个简单的解析解。令$S^* = \\alpha_1^{n+1,*} + \\alpha_2^{n+1,*}$为未投影的总和。总和约束为$\\delta_1 + \\delta_2 = 1 - S^*$。在此约束下最小化$\\delta_1^2 + \\delta_2^2$会得到校正量的平均分配：$\\delta_1 = \\delta_2 = (1 - S^*)/2$。\n因此，临时的投影值为：\n$$\n\\alpha'_1 = \\alpha_1^{n+1,*} + \\frac{1 - S^*}{2}, \\quad \\alpha'_2 = \\alpha_2^{n+1,*} + \\frac{1 - S^*}{2}\n$$\n根据构造，有$\\alpha'_1 + \\alpha'_2 = S^* + (1 - S^*) = 1$。最后一步是强制执行边界$0 \\le \\alpha_k \\le 1$。如果某个值，比如$\\alpha'_1$，落在了边界之外（例如$\\alpha'_1  0$），则必须将其剪裁到边界（$\\alpha_1^{n+1} = 0$）。另一个值则由总和约束确定（$\\alpha_2^{n+1} = 1$）。这对于每个网格点，可引出以下算法：\n1. 计算未投影的总和$S^* = \\alpha_1^{n+1,*} + \\alpha_2^{n+1,*}$。\n2. 计算其中一个相的平均校正值：$\\alpha'_1 = \\alpha_1^{n+1,*} - (S^* - 1)/2$。\n3. 将此值剪裁到物理范围：$\\alpha_1^{n+1} = \\max(0, \\min(1, \\alpha'_1))$。\n4. 确定另一个相以满足总和：$\\alpha_2^{n+1} = 1 - \\alpha_1^{n+1}$。\n该方法保证在每个点都满足$\\sum_k \\alpha_k^{n+1} = 1$和$0 \\le \\alpha_k^{n+1} \\le 1$。投影后误差$e_\\infty^{\\mathrm{proj}} = \\max_i \\left| \\sum_k \\alpha_k^{n+1}(x_i) - 1 \\right|$预期在机器精度范围内为零。\n\n### 4. 实现与结果\n该过程使用 Python 中的 NumPy 库来实现，以进行高效的数组操作。对于每个测试用例，定义了网格、初始条件和速度场。未投影的体积分数$\\alpha_k^{n+1, *}$在一个步骤中计算完成。然后计算投影前误差$e_\\infty$。随后，应用上述基于向量的投影算法以获得最终值$\\alpha_k^{n+1}$，并由此计算出投影后误差$e_\\infty^{\\mathrm{proj}}$。三个测试用例的结果被汇总并按规定格式化。",
            "answer": "[[0.01570796326794897,2.220446049250313e-16],[0.0,0.0],[0.4,0.0]]"
        }
    ]
}