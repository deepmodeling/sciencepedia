{
    "hands_on_practices": [
        {
            "introduction": "Understanding the mushy zone begins with the ideal case of perfect thermodynamic equilibrium. This foundational exercise guides you through the derivation of the Lever Rule from first principles, providing a direct link between a binary alloy's phase diagram and the solid fraction $f_s$ at any given temperature within the solidification interval. Mastering this derivation  solidifies your understanding of solute conservation and local equilibrium, which serves as the theoretical baseline for all advanced solidification models.",
            "id": "3974905",
            "problem": "A dilute binary alloy with initial solute concentration $C_0$ solidifies under conditions of local thermodynamic equilibrium at the solid–liquid interface. Assume that at any temperature $T$ within the two-phase region, the liquid and solid in a representative volume are each compositionally uniform and are connected by a tie line on the equilibrium phase diagram. The equilibrium phase diagram is locally linearized in the dilute regime by\n$$T = T_M + m_L\\,C_L,\\qquad T = T_M + m_S\\,C_S,$$\nwhere $T_M$ is the melting temperature of the pure solvent, $m_L$ and $m_S$ are the constant slopes of the liquidus and solidus, respectively, with $m_L0$ and $m_S0$, and $C_L$ and $C_S$ are the solute concentrations in the liquid and solid at temperature $T$. Assume negligible macroscopic segregation so that the volume-averaged solute concentration remains $C_0$ throughout solidification.\n\nStarting only from conservation of solute in a representative two-phase volume and the local equilibrium tie-line relations given above, derive a closed-form expression for the solid fraction $f_s$ as an explicit function of $T$, $C_0$, $T_M$, $m_L$, and $m_S$ that is valid for $T$ in the two-phase interval between the temperatures corresponding to the liquidus and solidus at $C_0$. Express your final result for $f_s(T;C_0,T_M,m_L,m_S)$ as a single simplified analytic expression. The final answer must be given as a dimensionless fraction (not a percentage). No numerical evaluation is required.",
            "solution": "The problem statement is evaluated to be valid as it is scientifically grounded in the principles of thermodynamics and materials science, is well-posed with a clear objective and sufficient constraints, and is expressed in objective, formal language. The assumptions provided are standard for the derivation of the Lever Rule for solidification. No flaws are identified.\n\nThe derivation of the solid fraction, $f_s$, as a function of temperature, $T$, proceeds from the principle of conservation of solute within a representative two-phase volume.\n\nThe problem states that the volume-averaged solute concentration remains constant at the initial concentration, $C_0$, throughout solidification. This represents a closed system with respect to mass and solute. The total solute in a representative volume is the sum of the solute in the solid phase and the solute in the liquid phase. Let $f_s$ be the mass fraction of solid and $f_l$ be the mass fraction of liquid. As the system is composed of only these two phases, their fractions must sum to unity:\n$$f_s + f_l = 1$$\nThe overall solute concentration, $C_0$, is the weighted average of the concentrations in the solid phase, $C_S$, and the liquid phase, $C_L$:\n$$C_0 = f_s C_S + f_l C_L$$\nThe problem assumes that within the representative volume, each phase is compositionally uniform. Substituting $f_l = 1 - f_s$ into the conservation equation gives:\n$$C_0 = f_s C_S + (1 - f_s) C_L$$\n$$C_0 = f_s C_S + C_L - f_s C_L$$\nThis equation can be rearranged to solve for the solid fraction, $f_s$:\n$$f_s (C_L - C_S) = C_L - C_0$$\n$$f_s = \\frac{C_L - C_0}{C_L - C_S}$$\nThis expression is known as the Lever Rule.\n\nThe next step is to express the concentrations $C_L$ and $C_S$ as functions of temperature, $T$, using the provided linearized phase diagram relations:\n$$T = T_M + m_L C_L$$\n$$T = T_M + m_S C_S$$\nwhere $T_M$ is the melting point of the pure solvent, and $m_L$ and $m_S$ are the constant slopes of the liquidus and solidus lines, respectively. We can rearrange these equations to solve for $C_L$ and $C_S$ at a given temperature $T$ in the two-phase region:\n$$C_L(T) = \\frac{T - T_M}{m_L}$$\n$$C_S(T) = \\frac{T - T_M}{m_S}$$\nNow, we substitute these expressions for $C_L$ and $C_S$ into the Lever Rule equation for $f_s$:\n$$f_s(T) = \\frac{\\frac{T - T_M}{m_L} - C_0}{\\frac{T - T_M}{m_L} - \\frac{T - T_M}{m_S}}$$\nTo simplify this expression, we can first combine the terms in the denominator:\n$$\\frac{T - T_M}{m_L} - \\frac{T - T_M}{m_S} = (T - T_M) \\left( \\frac{1}{m_L} - \\frac{1}{m_S} \\right) = (T - T_M) \\left( \\frac{m_S - m_L}{m_L m_S} \\right)$$\nThe numerator can be written as:\n$$\\frac{T - T_M}{m_L} - C_0 = \\frac{T - T_M - m_L C_0}{m_L}$$\nSubstituting these back into the expression for $f_s(T)$:\n$$f_s(T) = \\frac{\\frac{T - T_M - m_L C_0}{m_L}}{(T - T_M) \\left( \\frac{m_S - m_L}{m_L m_S} \\right)}$$\n$$f_s(T) = \\left( \\frac{T - T_M - m_L C_0}{m_L} \\right) \\left( \\frac{m_L m_S}{(T - T_M)(m_S - m_L)} \\right)$$\nThe term $m_L$ cancels out, yielding:\n$$f_s(T) = \\frac{m_S (T - T_M - m_L C_0)}{(m_S - m_L)(T - T_M)}$$\nThis is a valid expression, but it can be simplified further for clarity. We can separate the terms containing $T$ from the constant parameters:\n$$f_s(T) = \\left( \\frac{m_S}{m_S - m_L} \\right) \\left( \\frac{T - T_M - m_L C_0}{T - T_M} \\right)$$\nThe second term in parentheses can be split into two parts:\n$$f_s(T) = \\left( \\frac{m_S}{m_S - m_L} \\right) \\left( \\frac{T - T_M}{T - T_M} - \\frac{m_L C_0}{T - T_M} \\right)$$\nThis simplifies to the final closed-form expression for the solid fraction as a function of temperature and the given parameters:\n$$f_s(T) = \\frac{m_S}{m_S - m_L} \\left( 1 - \\frac{m_L C_0}{T - T_M} \\right)$$\nThis equation is valid for temperatures $T$ within the two-phase (mushy) region, which is bounded by the liquidus temperature $T_L = T_M + m_L C_0$ (where $f_s=0$) and the solidus temperature $T_S = T_M + m_S C_0$ (where $f_s=1$ under the equilibrium conditions of the Lever Rule).",
            "answer": "$$\\boxed{\\frac{m_S}{m_S - m_L} \\left( 1 - \\frac{m_L C_0}{T - T_M} \\right)}$$"
        },
        {
            "introduction": "Real-world solidification rarely occurs in perfect equilibrium, making non-equilibrium models essential for accurate prediction. This practice introduces the celebrated Scheil-Gulliver model, which assumes negligible diffusion in the solid phase—a condition often met in practice. By deriving the Scheil equation , you will quantify how solute is rejected at the solidification front, leading to the enrichment of the remaining liquid and a continuous depression of the freezing temperature, which is the very essence of microsegregation.",
            "id": "3974918",
            "problem": "Consider a binary alloy undergoing directional solidification, with a mushy zone spanning the temperatures between the solidus and the liquidus. Assume local thermodynamic equilibrium at the solid–liquid interface, negligible solute diffusion in the solid, and complete mixing in the liquid. These are the classical assumptions of the Scheil model. Let the solute partition coefficient be defined as $k = C_{S}/C_{L}$, where $C_{S}$ is the instantaneous solute mass fraction in the solid forming at the interface and $C_{L}$ is the instantaneous solute mass fraction in the adjacent liquid. Let the initial bulk solute mass fraction be $C_{0}$, and denote the solid fraction by $f_{S}$.\n\nStarting from solute conservation in an infinitesimal control volume of the mushy zone and the definition of the partition coefficient, derive an expression for the enrichment of the remaining liquid $C_{L}$ as a function of $f_{S}$ under the Scheil assumptions. Then, quantify how this enrichment modifies the local liquidus temperature using a linearized phase diagram near the alloy composition, with the liquidus relation $T_{L}(C) = T_{L}^{0} + m_{L}\\,C$, where $T_{L}^{0}$ is the liquidus temperature of the pure solvent and $m_{L}$ is the (constant) slope of the liquidus line with respect to the solute mass fraction $C$.\n\nUse the following parameter values: $k = 0.3$, $C_{0} = 0.05$ (dimensionless solute mass fraction), $T_{L}^{0} = 933\\,\\mathrm{K}$, $m_{L} = -250\\,\\mathrm{K}$ per unit solute mass fraction, and evaluate the result at $f_{S} = 0.8$. Compute the resulting liquidus temperature due to enrichment, $T_{L}\\!\\left(C_{L}(f_{S})\\right)$, and report that final temperature. Round your answer to four significant figures and express the final temperature in $\\mathrm{K}$.",
            "solution": "The problem is valid. It is a well-posed problem in the field of materials science and solidification processing, based on the classical Scheil-Gulliver model. All necessary assumptions, definitions, and data are provided, and they are scientifically sound and consistent.\n\nThe first task is to derive the Scheil equation, which describes the solute concentration in the liquid, $C_{L}$, as a function of the solid fraction, $f_{S}$. This derivation is based on a solute mass balance over a differential control volume under the assumptions of no diffusion in the solid, perfect mixing in the liquid, and local equilibrium at the interface.\n\nLet us consider a system of unit mass. The overall solute concentration is $C_{0}$. As solidification proceeds, an infinitesimal mass of solid, $df_{S}$, forms from the liquid. At any given moment, the mass of liquid remaining is $(1 - f_{S})$. The total amount of solute in the liquid phase is $C_{L}(1 - f_{S})$.\n\nThe change in the amount of solute within the liquid phase as solidification progresses is given by the differential $d\\left(C_{L}(1 - f_{S})\\right)$. Using the product rule for differentiation, we have:\n$$d\\left(C_{L}(1 - f_{S})\\right) = (1 - f_{S})dC_{L} + C_{L}d(1 - f_{S}) = (1 - f_{S})dC_{L} - C_{L}df_{S}$$\n\nThis change in solute content must be equal to the amount of solute that leaves the liquid to form the new solid. The mass of the newly formed solid is $df_S$. The concentration of this solid is $C_S$. Therefore, the mass of solute removed from the liquid is $C_{S}df_{S}$. The amount of solute in the liquid thus decreases by this amount. This gives the solute balance equation:\n$$d\\left(C_{L}(1 - f_{S})\\right) = -C_{S}df_{S}$$\n\nEquating the two expressions for the change in solute content in the liquid, we get:\n$$(1 - f_{S})dC_{L} - C_{L}df_{S} = -C_{S}df_{S}$$\n\nThe problem states that local thermodynamic equilibrium is maintained at the interface, which allows us to use the partition coefficient, $k = C_{S}/C_{L}$. Substituting $C_{S} = k C_{L}$ into the balance equation:\n$$(1 - f_{S})dC_{L} - C_{L}df_{S} = -kC_{L}df_{S}$$\n\nWe can now rearrange the equation to separate the variables $C_{L}$ and $f_{S}$:\n$$(1 - f_{S})dC_{L} = (C_{L} - kC_{L})df_{S}$$\n$$(1 - f_{S})dC_{L} = (1 - k)C_{L}df_{S}$$\n$$\\frac{dC_{L}}{C_{L}} = (1 - k)\\frac{df_{S}}{1 - f_{S}}$$\n\nTo find the relationship between $C_{L}$ and $f_{S}$, we integrate this differential equation. The integration is performed from the start of solidification, where $f_{S}=0$ and the liquid concentration is the initial bulk concentration $C_{L}=C_{0}$, to an arbitrary state defined by a solid fraction $f_{S}$ and a corresponding liquid concentration $C_{L}$.\n$$\\int_{C_{0}}^{C_{L}} \\frac{dC'_{L}}{C'_{L}} = \\int_{0}^{f_{S}} (1 - k)\\frac{df'_{S}}{1 - f'_{S}}$$\n\nThe left-hand side integrates to:\n$$\\left[ \\ln(C'_{L}) \\right]_{C_{0}}^{C_{L}} = \\ln(C_{L}) - \\ln(C_{0}) = \\ln\\left(\\frac{C_{L}}{C_{0}}\\right)$$\n\nThe right-hand side integrates to:\n$$(1 - k) \\int_{0}^{f_{S}} \\frac{df'_{S}}{1 - f'_{S}} = (1 - k) \\left[ -\\ln(1 - f'_{S}) \\right]_{0}^{f_{S}} = (1 - k) \\left( -\\ln(1 - f_{S}) - (-\\ln(1)) \\right) = -(1 - k)\\ln(1 - f_{S})$$\nThis can be rewritten as $(k - 1)\\ln(1 - f_{S})$.\n\nEquating the results of the two integrations:\n$$\\ln\\left(\\frac{C_{L}}{C_{0}}\\right) = (k - 1)\\ln(1 - f_{S})$$\n\nBy taking the exponential of both sides, we obtain the final expression for $C_{L}$ as a function of $f_{S}$, which is the Scheil equation:\n$$C_{L}(f_{S}) = C_{0}(1 - f_{S})^{k-1}$$\n\nThe second task is to use this powerful result to compute the liquidus temperature at a specific solid fraction. We are given the following parameter values:\n- Partition coefficient: $k = 0.3$\n- Initial solute mass fraction: $C_{0} = 0.05$\n- Solid fraction for evaluation: $f_{S} = 0.8$\n- Liquidus temperature of pure solvent: $T_{L}^{0} = 933\\,\\mathrm{K}$\n- Liquidus slope: $m_{L} = -250\\,\\mathrm{K}$\n\nFirst, we calculate the enriched solute concentration in the liquid, $C_{L}$, when the solid fraction $f_{S}$ reaches $0.8$:\n$$C_{L}(0.8) = C_{0}(1 - 0.8)^{k-1} = 0.05(0.2)^{0.3-1} = 0.05(0.2)^{-0.7}$$\n$$C_{L}(0.8) \\approx 0.05 \\times 3.085235 = 0.15426175$$\n\nNext, we use the linearized liquidus line equation, $T_{L}(C) = T_{L}^{0} + m_{L}\\,C$, to find the liquidus temperature corresponding to this enriched liquid concentration. This temperature represents the equilibrium temperature at the solid-liquid interface when $f_S = 0.8$.\n$$T_{L}(C_{L}(0.8)) = T_{L}^{0} + m_{L} \\times C_{L}(0.8)$$\n$$T_{L} = 933\\,\\mathrm{K} + (-250\\,\\mathrm{K}) \\times 0.15426175$$\n$$T_{L} = 933\\,\\mathrm{K} - 38.5654375\\,\\mathrm{K}$$\n$$T_{L} = 894.4345625\\,\\mathrm{K}$$\n\nThe problem requires the final answer to be rounded to four significant figures.\nThe calculated temperature is $894.4345625\\,\\mathrm{K}$. The first four significant digits are $8$, $9$, $4$, and $4$. The fifth digit is $3$, which is less than $5$, so we round down.\nThe final result is $894.4\\,\\mathrm{K}$.",
            "answer": "$$\\boxed{894.4}$$"
        },
        {
            "introduction": "Bridging theory and practice, this final exercise challenges you to implement and validate numerical models for solidification. You will code two dominant fixed-grid approaches—the Effective Heat Capacity and the Enthalpy methods—to simulate a classic Stefan problem and compare their accuracy against an analytical solution. This hands-on comparison  reveals the fundamental strengths and weaknesses of each method, particularly concerning energy conservation and interface tracking, which are critical considerations in developing robust computational tools.",
            "id": "3974910",
            "problem": "You are to implement and compare two fixed-grid formulations for one-dimensional solidification with a mushy zone in a semi-infinite benchmark that has a known sharp-interface Stefan solution. The two formulations are: the Effective Heat Capacity (EHC) method and the Enthalpy method. Starting from the governing energy conservation law and Fourier heat conduction, derive and implement the discrete algorithms, simulate to a specified final time, extract a numerical estimate of the interface location in each method, and compute absolute errors against the analytical interface position from the Stefan solution. Express all interface position errors in meters.\n\nThe physical setting is one-dimensional conduction in the semi-infinite domain with the spatial coordinate $x \\ge 0$, initially at the melting temperature, with the boundary at $x=0$ suddenly cooled to a sub-melting temperature. Use the following material properties and conditions, which are representative of a metal:\n\n- Density $ \\rho = 2700\\,\\mathrm{kg/m^3} $.\n- Thermal conductivity $ k = 200\\,\\mathrm{W/(m\\,K)} $.\n- Specific heat $ c = 900\\,\\mathrm{J/(kg\\,K)} $.\n- Latent heat of fusion $ L = 3.97\\times 10^{5}\\,\\mathrm{J/kg} $.\n- Melting temperature $ T_m = 933\\,\\mathrm{K} $.\n- Boundary (cooling) temperature at $ x=0 $: $ T_s = 800\\,\\mathrm{K} $.\n- Initial temperature $ T(x,0) = T_m $ for all $ x \\ge 0 $.\n\nModel the semi-infinite domain by a sufficiently large finite length $ L_x = 0.1\\,\\mathrm{m} $ with a Dirichlet far-field boundary condition $ T(L_x,t) = T_m $ for all $ t \\ge 0 $. The spatial grid is uniform with spacing $ \\Delta x $ as specified in the test suite below, and the time integration is explicit. Let the simulation final time be $ t_\\mathrm{final} = 5\\,\\mathrm{s} $ for all test cases. Use a uniform time step constrained by the standard explicit stability criterion for the temperature equation in regions where the effective heat capacity equals the sensible heat capacity: \n$$\n\\Delta t \\le \\frac{\\Delta x^2}{2\\,\\alpha_\\mathrm{max}}, \\quad \\alpha_\\mathrm{max} = \\frac{k}{\\rho\\,c}.\n$$\nIn your implementation, set $ \\Delta t = 0.9\\,\\Delta x^2/(2\\,\\alpha_\\mathrm{max}) $ and adjust to exactly reach $ t_\\mathrm{final} $ by making the last step shorter if needed.\n\nMushy zone regularization is introduced via a finite temperature interval of width $ \\Delta T $ centered at the melting temperature. Define the solidus and liquidus temperatures as $ T_\\mathrm{sol} = T_m - \\Delta T / 2 $ and $ T_\\mathrm{liq} = T_m + \\Delta T / 2 $. The liquid fraction $ f_\\ell(T) $ is modeled as:\n$$\nf_\\ell(T) = \n\\begin{cases}\n0,  T \\le T_\\mathrm{sol},\\\\\n\\frac{T - T_\\mathrm{sol}}{\\Delta T},  T_\\mathrm{sol}  T  T_\\mathrm{liq},\\\\\n1,  T \\ge T_\\mathrm{liq}.\n\\end{cases}\n$$\n\nFor the Effective Heat Capacity method, evolve the temperature using:\n$$\n\\rho\\,c_\\mathrm{eff}(T)\\,\\frac{\\partial T}{\\partial t} = k\\,\\frac{\\partial^2 T}{\\partial x^2},\n$$\nwith\n$$\nc_\\mathrm{eff}(T) = c + \\frac{L}{\\Delta T} \\quad \\text{if } T_\\mathrm{sol}  T  T_\\mathrm{liq}, \\quad \\text{and } c_\\mathrm{eff}(T) = c \\text{ otherwise.}\n$$\nUse a second-order central difference for the spatial second derivative and forward Euler in time. Impose the Dirichlet boundary conditions $ T(0,t) = T_s $ and $ T(L_x,t) = T_m $ at every time step.\n\nFor the Enthalpy method, evolve the volumetric enthalpy $ H(T) $ with:\n$$\n\\frac{\\partial H}{\\partial t} = k\\,\\frac{\\partial^2 T}{\\partial x^2}, \\quad H(T) = \\rho\\,c\\,T + \\rho\\,L\\,f_\\ell(T).\n$$\nAt each time step, compute $ T $ from $ H $ via the piecewise-linear inverse relation implied by the definition of $ H(T) $. Use the same discrete spatial operator and forward Euler advancement for $ H $. Enforce the Dirichlet boundary conditions by setting $ T(0,t) = T_s $ and $ T(L_x,t) = T_m $ at each time step and updating the boundary enthalpy values $ H(0,t) = H(T_s) $ and $ H(L_x,t) = H(T_m) $ accordingly.\n\nThe analytical sharp-interface one-phase Stefan solution for this configuration gives the interface location $ s(t) $ as:\n$$\ns(t) = 2\\,\\lambda\\,\\sqrt{\\alpha\\,t}, \\quad \\alpha = \\frac{k}{\\rho\\,c},\n$$\nwhere the parameter $ \\lambda $ solves the transcendental equation involving the Stefan number $ \\mathrm{Ste} $ and the Complementary Error Function (CERF, commonly written as $ \\operatorname{erfc} $):\n$$\n\\mathrm{Ste} = \\frac{c\\,(T_m - T_s)}{L}, \\quad \\mathrm{Ste} = \\sqrt{\\pi}\\,\\lambda\\,\\exp(\\lambda^2)\\,\\operatorname{erfc}(\\lambda).\n$$\nCompute $ \\lambda $ numerically for the given parameters and then compute $ s(t_\\mathrm{final}) $.\n\nExtract the numerical interface position $ s_\\mathrm{num} $ from each method at $ t_\\mathrm{final} $ by finding the first location where $ T $ crosses $ T_m $ and linearly interpolating between grid points. Compute the absolute error $ |s_\\mathrm{num} - s(t_\\mathrm{final})| $ in meters for each method.\n\nTest Suite:\nProvide three test cases that explore distinct aspects of numerical behavior:\n- Case $1$ (baseline resolution, moderate mushy width): $ \\Delta x = 5\\times 10^{-4}\\,\\mathrm{m} $, $ \\Delta T = 10\\,\\mathrm{K} $.\n- Case $2$ (coarser grid, sharp-interface limit): $ \\Delta x = 10^{-3}\\,\\mathrm{m} $, $ \\Delta T = 1\\,\\mathrm{K} $.\n- Case $3$ (baseline resolution, wide mushy width): $ \\Delta x = 5\\times 10^{-4}\\,\\mathrm{m} $, $ \\Delta T = 50\\,\\mathrm{K} $.\n\nNumerical Output Specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result should be a two-element list $[e_\\mathrm{EHC}, e_\\mathrm{ENT}]$ of floats in meters, representing the absolute error for the Effective Heat Capacity method and the Enthalpy method, respectively, at $ t_\\mathrm{final} $. For the three test cases, the final output must be of the form:\n$$\n\\text{print } \\big[ [e_{\\mathrm{EHC},1},e_{\\mathrm{ENT},1}], [e_{\\mathrm{EHC},2},e_{\\mathrm{ENT},2}], [e_{\\mathrm{EHC},3},e_{\\mathrm{ENT},3}] \\big].\n$$",
            "solution": "The problem requires the implementation and comparison of two fixed-grid numerical methods, the Effective Heat Capacity (EHC) and Enthalpy methods, for a one-dimensional solidification problem. The numerical results for the solidification front position will be validated against a known analytical solution for a sharp-interface Stefan problem.\n\nThe fundamental governing principle is the conservation of energy. For a system with heat conduction and no internal heat generation, the energy equation is given by:\n$$\n\\frac{\\partial (\\rho h)}{\\partial t} = \\nabla \\cdot (k \\nabla T)\n$$\nwhere $\\rho$ is the density, $h$ is the specific enthalpy, $t$ is time, $k$ is the thermal conductivity, and $T$ is the temperature. The specific enthalpy, $h$, is a function of temperature and phase. For a substance undergoing a solid-liquid phase change, it is defined as:\n$$\nh(T) = \\int_{T_\\mathrm{ref}}^T c(T') \\, dT' + L f_{\\ell}(T)\n$$\nwhere $c$ is the specific heat, $L$ is the latent heat of fusion, and $f_{\\ell}(T)$ is the liquid fraction, which varies from $0$ (solid) to $1$ (liquid). For this problem, we assume constant material properties in each phase, so the integral simplifies to $c(T-T_\\mathrm{ref})$. The volumetric enthalpy is $H = \\rho h$.\n\nThe problem uses a mushy zone model, where the phase change occurs over a finite temperature interval $\\Delta T$ from a solidus temperature $T_\\mathrm{sol} = T_m - \\Delta T / 2$ to a liquidus temperature $T_\\mathrm{liq} = T_m + \\Delta T / 2$. The liquid fraction $f_{\\ell}(T)$ is given as a linear function of temperature within this interval.\n\nThe two numerical formulations arise from different treatments of the enthalpy term in the energy equation.\n\n**Effective Heat Capacity (EHC) Method**\n\nThis method reformulates the energy equation explicitly in terms of temperature. Using the chain rule, the time derivative of enthalpy is expressed as:\n$$\n\\frac{\\partial h}{\\partial t} = \\frac{\\partial h}{\\partial T} \\frac{\\partial T}{\\partial t} = c_\\mathrm{eff}(T) \\frac{\\partial T}{\\partial t}\n$$\nwhere $c_\\mathrm{eff}(T) = \\frac{\\partial h}{\\partial T}$ is the effective heat capacity. From the definition of $h(T)$, we derive $c_\\mathrm{eff}(T)$:\n$$\nc_\\mathrm{eff}(T) = \\frac{\\partial}{\\partial T} \\left( c T + L f_{\\ell}(T) \\right) = c + L \\frac{df_{\\ell}}{dT}\n$$\nUsing the specified linear form for $f_{\\ell}(T)$, the derivative $\\frac{df_{\\ell}}{dT}$ is $1/\\Delta T$ inside the mushy zone ($T_\\mathrm{sol}  T  T_\\mathrm{liq}$) and $0$ otherwise. This leads to the piecewise definition given in the problem statement. The governing equation for the EHC method is thus:\n$$\n\\rho c_\\mathrm{eff}(T) \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2}\n$$\nThis is a non-linear heat equation, as the coefficient $c_\\mathrm{eff}$ depends on the solution $T$.\n\nFor numerical solution, we discretize in space using a second-order central difference and in time using the forward Euler method. Let $T_i^n$ be the temperature at grid point $x_i = i \\Delta x$ and time $t_n = n \\Delta t$. The discrete update equation is:\n$$\n\\rho c_\\mathrm{eff}(T_i^n) \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = k \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{\\Delta x^2}\n$$\nSolving for the temperature at the next time step, $T_i^{n+1}$:\n$$\nT_i^{n+1} = T_i^n + \\frac{k \\Delta t}{\\rho c_\\mathrm{eff}(T_i^n) \\Delta x^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\nThe algorithm for the EHC method involves initializing the temperature field, then iteratively:\n1. Apply Dirichlet boundary conditions on temperature.\n2. At each interior grid point $i$, compute $c_\\mathrm{eff}(T_i^n)$ based on the current temperature.\n3. Compute the new temperature $T_i^{n+1}$ using the explicit update formula.\n4. Advance to the next time step.\n\n**Enthalpy Method**\n\nThis method retains the volumetric enthalpy $H = \\rho h$ as the primary evolved variable. The governing equation is:\n$$\n\\frac{\\partial H}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2}\n$$\nThe relationship between enthalpy $H$ and temperature $T$ is given by $H(T) = \\rho c T + \\rho L f_{\\ell}(T)$. This method's key characteristic is that the time-evolution is for enthalpy, while the spatial operator (Laplacian) requires temperature. This necessitates converting between $H$ and $T$ at each time step.\n\nThe discretized equation is:\n$$\n\\frac{H_i^{n+1} - H_i^n}{\\Delta t} = k \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{\\Delta x^2}\n$$\nThe update equation for enthalpy is:\n$$\nH_i^{n+1} = H_i^n + \\frac{k \\Delta t}{\\Delta x^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\nTo obtain the temperature field $T^n$ needed for the Laplacian, we must invert the $H(T)$ relationship. Given the piecewise-linear definition of $f_{\\ell}(T)$, the function $H(T)$ is also piecewise-linear and monotonically increasing, making its inverse $T(H)$ single-valued. The relation is:\n- If $H \\le H_\\mathrm{sol} = \\rho c T_\\mathrm{sol}$: $T = H / (\\rho c)$\n- If $H_\\mathrm{sol}  H  H_\\mathrm{liq} = \\rho c T_\\mathrm{liq} + \\rho L$: $T = \\frac{H - \\rho L \\frac{T_\\mathrm{sol}}{\\Delta T}}{ \\rho c + \\frac{\\rho L}{\\Delta T} }$\n- If $H \\ge H_\\mathrm{liq}$: $T = (H - \\rho L) / (\\rho c)$\n\nThe algorithm for the Enthalpy method is:\n1. Initialize the temperature field $T^0$ and compute the corresponding initial enthalpy field $H^0 = H(T^0)$.\n2. Iteratively:\n   a. Apply Dirichlet boundary conditions on temperature $T^n$. Update the enthalpy at the boundaries $H_0^n = H(T_0^n)$ and $H_{N-1}^n = H(T_{N-1}^n)$.\n   b. Compute the new enthalpy field $H^{n+1}$ for interior points using the explicit update formula, which uses temperatures from the previous step, $T^n$.\n   c. Update the interior temperatures $T_i^{n+1}$ by inverting the new enthalpy values: $T_i^{n+1} = T(H_i^{n+1})$.\n   d. Advance to the next time step.\n\n**Analytical Solution: One-Phase Stefan Problem**\n\nFor the case of a sharp interface ($\\Delta T \\to 0$) and a semi-infinite domain initially at the melting temperature, an analytical solution exists. The position of the solid-liquid interface, $s(t)$, is given by:\n$$\ns(t) = 2 \\lambda \\sqrt{\\alpha t}\n$$\nwhere $\\alpha = k/(\\rho c)$ is the thermal diffusivity of the solid phase. The constant $\\lambda$ is determined by solving a transcendental equation that enforces the energy balance at the moving interface:\n$$\n\\mathrm{Ste} = \\sqrt{\\pi} \\lambda e^{\\lambda^2} \\mathrm{erfc}(\\lambda)\n$$\nThe Stefan number, $\\mathrm{Ste} = \\frac{c(T_m - T_s)}{L}$, is a dimensionless parameter representing the ratio of sensible heat to latent heat. The complementary error function is $\\mathrm{erfc}(\\lambda)$. This equation must be solved numerically for $\\lambda$. The resulting $s(t_\\mathrm{final})$ serves as the benchmark against which the numerical solutions are compared.\n\n**Numerical Implementation Details**\n\nThe simulation domain is of length $L_x = 0.1\\,\\mathrm{m}$, discretized with a uniform grid spacing $\\Delta x$. The time step $\\Delta t$ is chosen to satisfy the explicit stability criterion for the pure solid/liquid phase, $\\Delta t = 0.9 \\frac{\\Delta x^2}{2\\alpha}$, where $\\alpha = k/(\\rho c)$. This choice is conservative and ensures stability throughout the domain, since the effective diffusivity in the mushy zone is lower. The simulation runs until a final time $t_\\mathrm{final} = 5\\,\\mathrm{s}$.\n\nThe numerical interface position $s_\\mathrm{num}$ is extracted from the final temperature profile $T(x, t_\\mathrm{final})$. We find the first grid index $i$ from the cooled boundary for which $T_i \\ge T_m$. The interface lies between grid points $x_{i-1}$ and $x_i$. Linear interpolation is used to estimate its precise location:\n$$\ns_\\mathrm{num} = x_{i-1} + (x_i - x_{i-1}) \\frac{T_m - T_{i-1}}{T_i - T_{i-1}}\n$$\nFinally, the absolute error is calculated for each method and test case as $|s_\\mathrm{num} - s(t_\\mathrm{final})|$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import erfc\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Implements and compares Effective Heat Capacity and Enthalpy methods\n    for a 1D solidification problem.\n    \"\"\"\n\n    # --- Material Properties and Conditions ---\n    rho = 2700.0  # Density, kg/m^3\n    k = 200.0   # Thermal conductivity, W/(m K)\n    c = 900.0   # Specific heat, J/(kg K)\n    L = 3.97e5  # Latent heat of fusion, J/kg\n    T_m = 933.0 # Melting temperature, K\n    T_s = 800.0 # Boundary cooling temperature, K\n    \n    # --- Domain and Simulation Parameters ---\n    L_x = 0.1     # Domain length, m\n    t_final = 5.0 # Final simulation time, s\n\n    # --- Analytical Solution ---\n    Ste = c * (T_m - T_s) / L\n    alpha = k / (rho * c)\n\n    def lambda_equation(lam):\n        return np.sqrt(np.pi) * lam * np.exp(lam**2) * erfc(lam) - Ste\n\n    # Find the root for lambda\n    sol = root_scalar(lambda_equation, bracket=[0.01, 1.0], method='brentq')\n    lambda_val = sol.root\n    \n    s_analytical = 2 * lambda_val * np.sqrt(alpha * t_final)\n\n    # --- Test Suite ---\n    test_cases = [\n        # (dx, DeltaT)\n        (5e-4, 10.0),  # Case 1: baseline resolution, moderate mushy width\n        (1e-3, 1.0),   # Case 2: coarser grid, sharp-interface limit\n        (5e-4, 50.0),  # Case 3: baseline resolution, wide mushy width\n    ]\n\n    all_results = []\n\n    for dx, DeltaT in test_cases:\n        \n        # --- Common Numerical Setup for a Test Case ---\n        N_x = int(L_x / dx) + 1\n        x = np.linspace(0, L_x, N_x)\n        dt = 0.9 * dx**2 / (2 * alpha)\n        T_sol = T_m - DeltaT / 2\n        T_liq = T_m + DeltaT / 2\n\n        # --- EHC Method Simulation ---\n        T_ehc = np.full(N_x, T_m)\n        T_ehc[0] = T_s\n        \n        t = 0.0\n        while t  t_final:\n            dt_step = min(dt, t_final - t)\n            T_old = T_ehc.copy()\n            \n            c_eff = np.full(N_x, c)\n            mushy_mask = (T_old > T_sol)  (T_old  T_liq)\n            c_eff[mushy_mask] = c + L / DeltaT\n            \n            # Vectorized update for interior nodes\n            laplacian_T = (T_old[2:] - 2 * T_old[1:-1] + T_old[:-2]) / dx**2\n            dT_dt = k / (rho * c_eff[1:-1]) * laplacian_T\n            T_ehc[1:-1] = T_old[1:-1] + dT_dt * dt_step\n            \n            t += dt_step\n\n        # --- Enthalpy Method Simulation ---\n        def T_to_H(T_arr):\n            _H = np.zeros_like(T_arr)\n            solid_mask = T_arr = T_sol\n            mushy_mask = (T_arr > T_sol)  (T_arr  T_liq)\n            liquid_mask = T_arr >= T_liq\n            \n            _H[solid_mask] = rho * c * T_arr[solid_mask]\n            _H[mushy_mask] = rho * c * T_arr[mushy_mask] + rho * L * (T_arr[mushy_mask] - T_sol) / DeltaT\n            _H[liquid_mask] = rho * c * T_arr[liquid_mask] + rho * L\n            return _H\n\n        def H_to_T(H_arr):\n            _T = np.zeros_like(H_arr)\n            H_sol = rho * c * T_sol\n            H_liq = rho * c * T_liq + rho * L\n            \n            solid_mask = H_arr = H_sol\n            mushy_mask = (H_arr > H_sol)  (H_arr  H_liq)\n            liquid_mask = H_arr >= H_liq\n\n            _T[solid_mask] = H_arr[solid_mask] / (rho * c)\n            _T[mushy_mask] = (H_arr[mushy_mask] + rho * L * T_sol / DeltaT) / (rho * c + rho * L / DeltaT)\n            _T[liquid_mask] = (H_arr[liquid_mask] - rho * L) / (rho * c)\n            return _T\n        \n        T_ent = np.full(N_x, T_m)\n        H_ent = T_to_H(T_ent)\n\n        t = 0.0\n        while t  t_final:\n            dt_step = min(dt, t_final - t)\n            \n            # Apply BCs on T and update H at boundaries\n            T_ent[0] = T_s\n            T_ent[-1] = T_m\n            H_ent[0] = T_to_H(np.array([T_ent[0]]))[0]\n            H_ent[-1] = T_to_H(np.array([T_ent[-1]]))[0]\n            \n            H_old = H_ent.copy()\n\n            # Vectorized update for interior nodes\n            laplacian_T = (T_ent[2:] - 2*T_ent[1:-1] + T_ent[:-2]) / dx**2\n            dH_dt = k * laplacian_T\n            H_ent[1:-1] = H_old[1:-1] + dH_dt * dt_step\n            \n            # Update interior temperatures from new enthalpy\n            T_ent[1:-1] = H_to_T(H_ent[1:-1])\n\n            t += dt_step\n\n        # --- Interface Extraction and Error Calculation ---\n        def find_interface_pos(T_profile, x_grid):\n            # Find first index where temperature crosses T_m\n            try:\n                idx = np.where(T_profile >= T_m)[0][0]\n                if idx == 0: return 0.0 # Interface at the wall\n                \n                # Linear interpolation\n                x1, T1 = x_grid[idx-1], T_profile[idx-1]\n                x2, T2 = x_grid[idx], T_profile[idx]\n                \n                if T2 == T1: return x1\n                \n                s_num = x1 + (x2 - x1) * (T_m - T1) / (T2 - T1)\n                return s_num\n            except IndexError:\n                # Temperature never reaches T_m, interface is beyond domain\n                return x_grid[-1]\n\n        s_num_ehc = find_interface_pos(T_ehc, x)\n        s_num_ent = find_interface_pos(T_ent, x)\n        \n        error_ehc = abs(s_num_ehc - s_analytical)\n        error_ent = abs(s_num_ent - s_analytical)\n        \n        all_results.append([error_ehc, error_ent])\n\n    # --- Format and Print Final Output ---\n    str_results = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```"
        }
    ]
}