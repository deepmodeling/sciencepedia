{
    "hands_on_practices": [
        {
            "introduction": "在扩散火焰的模拟中，直接追踪所有化学组分的输运和反应是一个极其复杂的问题。混合分数（Mixture Fraction）的概念提供了一种强大的简化方法，它将复杂的化学状态映射到一个仅依赖于燃料和氧化剂混合过程的守恒标量上。本练习将引导您从元素守恒的基本原理出发，推导这个关键变量的定义，并计算其在化学计量比条件下的值，从而加深对扩散火焰物理基础的理解。",
            "id": "3966539",
            "problem": "在计算热工学中的非预混层流火焰模拟中，一个称为混合分数的守恒标量被用作参数，以表征沿混合线的组分和热化学状态。考虑一个包含碳（$C$）、氢（$H$）、氮（$N$）和氧（$O$）元素的通用反应系统。仅利用元素原子守恒以及完全氧化为二氧化碳（$\\mathrm{CO}_{2}$）、水（$\\mathrm{H}_{2}\\mathrm{O}$）和氮气（$\\mathrm{N}_{2}$）的化学计量关系，推导一个由元素质量分数构成的标量 $\\beta$，该标量在化学反应中保持不变，并且在两股进料流（一股燃料流和一股氧化剂流）的混合作用下呈线性变化。使用该标量构建 Bilger 混合分数 $Z$，将其作为混合物中标量到两股进料流中其对应值的仿射映射，然后通过施加完全氧化的精确氧平衡条件，求得化学计量混合分数 $Z_{st}$。\n\n假设如下：\n- 任何混合物中的元素质量分数为 $Y_{C}$、$Y_{H}$、$Y_{O}$ 和 $Y_{N}$，定义为各元素的质量除以总质量。\n- 原子量为 $W_{C} = 12.011$、$W_{H} = 1.008$、$W_{O} = 15.999$ 和 $W_{N} = 14.007$。\n- 燃料流为纯甲烷 $\\mathrm{CH}_{4}$。\n- 氧化剂流为干燥空气，其中 $\\mathrm{O}_{2}$ 的摩尔分数为 $0.21$，$\\mathrm{N}_{2}$ 的摩尔分数为 $0.79$。\n\n使用您构建的标量和以上数据，计算甲烷-空气系统的 $Z_{st}$。将最终的混合分数表示为一个无量纲数，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它科学地基于燃烧理论的原理，问题提法适定，有足够的数据得出唯一解，并使用客观、正式的语言陈述。因此，我们可以进行推导和计算。\n\n该问题要求推导一个守恒标量，用它来定义混合分数，并随后计算甲烷-空气系统的化学计量混合分数。\n\n首先，我们推导一个守恒标量 $\\beta$。在任何经历化学反应的封闭系统中，每种元素的总质量是守恒的。元素质量分数 $Y_k$ 定义为混合物中单位总质量下元素 $k$ 的质量。由于化学反应仅仅是将原子重排成不同的分子种类，每种元素的总质量保持不变。因此，元素质量分数的任何线性组合也是一个守恒量。一个定义为 $\\beta = \\sum_{k} c_k Y_k$ 的标量变量（其中 $c_k$ 是常数）在化学反应过程中将是守恒的。此外，在两股流（燃料和氧化剂）的混合作用下，任何元素的最终质量分数是其在母流中质量分数的线性组合，并由混合分数加权。因此，$\\beta$ 也将随混合呈线性变化。\n\n为了能有效地描述燃烧的化学计量，常数 $c_k$ 必须被审慎地选择。我们寻求一个能将燃料元素（碳和氢）与氧化剂元素（氧）关联起来的标量，其关联方式能反映它们在完全氧化过程中的消耗。一个标准且有效的方法是定义 $\\beta$，使其对于完全燃烧的最终产物，即二氧化碳（$\\mathrm{CO}_{2}$）和水（$\\mathrm{H}_{2}\\mathrm{O}$），其值为零。氮气（$\\mathrm{N}_{2}$）被视为惰性稀释剂。\n\n让我们提出一个形式如下的标量：\n$$\n\\beta = c_C \\frac{Y_C}{W_C} + c_H \\frac{Y_H}{W_H} + c_O \\frac{Y_O}{W_O}\n$$\n其中 $Y_k$ 是碳（$C$）、氢（$H$）和氧（$O$）的元素质量分数，$W_k$ 是它们各自的原子量。这种形式使用了单位质量的元素摩尔数。我们将通过强制 $\\beta=0$ 对 $\\mathrm{CO}_{2}$ 和 $\\mathrm{H}_{2}\\mathrm{O}$ 成立来确定系数 $c_C$、$c_H$ 和 $c_O$。\n\n对于纯 $\\mathrm{CO}_{2}$ 样品：\n该分子由一个 $C$ 原子和两个 $O$ 原子组成。元素质量分数为 $Y_C = \\frac{W_C}{W_C + 2W_O}$ 和 $Y_O = \\frac{2W_O}{W_C + 2W_O}$。$Y_H=0$。\n对 $\\mathrm{CO}_{2}$ 设 $\\beta=0$ 可得：\n$$\nc_C \\frac{1}{W_C + 2W_O} + c_O \\frac{2}{W_C + 2W_O} = 0 \\implies c_C + 2c_O = 0\n$$\n\n对于纯 $\\mathrm{H}_{2}\\mathrm{O}$ 样品：\n该分子由两个 $H$ 原子和一个 $O$ 原子组成。元素质量分数为 $Y_H = \\frac{2W_H}{2W_H + W_O}$ 和 $Y_O = \\frac{W_O}{2W_H + W_O}$。$Y_C=0$。\n对 $\\mathrm{H}_{2}\\mathrm{O}$ 设 $\\beta=0$ 可得：\n$$\nc_H \\frac{2}{2W_H + W_O} + c_O \\frac{1}{2W_H + W_O} = 0 \\implies 2c_H + c_O = 0\n$$\n\n我们得到了一个包含三个未知数的两个线性方程组，因此有一个自由度。我们可以选择一个系数的值来固定其他系数。我们选择 $c_O = -1$。\n由 $c_C + 2c_O = 0$，我们得到 $c_C = -2c_O = 2$。\n由 $2c_H + c_O = 0$，我们得到 $c_H = -c_O/2 = 1/2$。\n因此，一个有效的守恒标量是：\n$$\n\\beta = 2\\frac{Y_C}{W_C} + \\frac{1}{2}\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O}\n$$\n这是 Bilger 耦合函数的一种特定形式。它是一个由元素质量分数构成的守恒标量，具有与化学计量相关的期望性质。\n\n接下来，我们构建混合分数 $Z$。混合分数被定义为一个归一化变量，它将守恒标量 $\\beta$ 从其在氧化剂流中的值（$\\beta_{ox}$）线性映射到其在燃料流中的值（$\\beta_{fuel}$）。按照惯例，在氧化剂流中 $Z=0$，在燃料流中 $Z=1$。该仿射映射为：\n$$\nZ = \\frac{\\beta - \\beta_{ox}}{\\beta_{fuel} - \\beta_{ox}}\n$$\n\n化学计量混合分数 $Z_{st}$ 对应于氧气量恰好足以将燃料完全氧化为 $\\mathrm{CO}_{2}$ 和 $\\mathrm{H}_{2}\\mathrm{O}$ 的特定混合物组分。在这种混合物中，其元素组成使得在完全反应后，仅剩下这些产物（以及像 $\\mathrm{N}_{2}$ 这样的惰性物质）。根据我们对 $\\beta$ 的构建，其在该化学计量混合物中的值为零，即 $\\beta_{st} = 0$。将此代入 $Z$ 的定义中，可得到 $Z_{st}$ 的表达式：\n$$\nZ_{st} = \\frac{0 - \\beta_{ox}}{\\beta_{fuel} - \\beta_{ox}} = \\frac{-\\beta_{ox}}{\\beta_{fuel} - \\beta_{ox}}\n$$\n\n为了计算甲烷-空气燃烧的 $Z_{st}$ 的数值，我们必须首先计算 $\\beta_{fuel}$ 和 $\\beta_{ox}$。\n\n对于燃料流（纯甲烷，$\\mathrm{CH}_{4}$）：\n摩尔质量为 $W_{CH_4} = W_C + 4W_H$。\n元素质量分数为 $Y_C = \\frac{W_C}{W_{CH_4}}$ 和 $Y_H = \\frac{4W_H}{W_{CH_4}}$。$Y_O$ 和 $Y_N$ 为零。\n计算 $\\beta_{fuel}$：\n$$\n\\beta_{fuel} = 2\\frac{Y_C}{W_C} + \\frac{1}{2}\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O} = 2\\frac{(W_C/W_{CH_4})}{W_C} + \\frac{1}{2}\\frac{(4W_H/W_{CH_4})}{W_H} - 0 = \\frac{2}{W_{CH_4}} + \\frac{2}{W_{CH_4}} = \\frac{4}{W_{CH_4}}\n$$\n\n对于氧化剂流（干燥空气：$0.21$ 摩尔分数的 $\\mathrm{O}_{2}$，$0.79$ 摩尔分数的 $\\mathrm{N}_{2}$）：\n空气的平均摩尔质量为 $W_{air} = 0.21 W_{O_2} + 0.79 W_{N_2} = 0.21(2W_O) + 0.79(2W_N) = 0.42W_O + 1.58W_N$。\n氧的元素质量分数为 $Y_O = \\frac{0.21 \\times 2W_O}{W_{air}} = \\frac{0.42W_O}{W_{air}}$。$Y_C$ 和 $Y_H$ 为零。\n计算 $\\beta_{ox}$：\n$$\n\\beta_{ox} = 2\\frac{Y_C}{W_C} + \\frac{1}{2}\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O} = 0 + 0 - \\frac{(0.42W_O/W_{air})}{W_O} = -\\frac{0.42}{W_{air}}\n$$\n\n现在，我们将 $\\beta_{fuel}$ 和 $\\beta_{ox}$ 的表达式代入 $Z_{st}$ 的公式中：\n$$\nZ_{st} = \\frac{-(-\\frac{0.42}{W_{air}})}{\\frac{4}{W_{CH_4}} - (-\\frac{0.42}{W_{air}})} = \\frac{\\frac{0.42}{W_{air}}}{\\frac{4}{W_{CH_4}} + \\frac{0.42}{W_{air}}}\n$$\n分子和分母同乘以 $W_{CH_4}W_{air}$ 得：\n$$\nZ_{st} = \\frac{0.42 W_{CH_4}}{4 W_{air} + 0.42 W_{CH_4}}\n$$\n分子和分母同除以 $2$ 以简化：\n$$\nZ_{st} = \\frac{0.21 W_{CH_4}}{2 W_{air} + 0.21 W_{CH_4}}\n$$\n这个表达式也可以从化学计量的空燃质量比推导出来，从而证实了我们的推导。\n\n最后，我们使用给定的原子量计算数值：\n$W_{C} = 12.011$\n$W_{H} = 1.008$\n$W_{O} = 15.999$\n$W_{N} = 14.007$\n\n甲烷的摩尔质量：\n$W_{CH_4} = W_C + 4W_H = 12.011 + 4(1.008) = 16.043$\n\n空气的摩尔质量：\n$W_{air} = 0.21(2W_O) + 0.79(2W_N) = 0.21(2 \\times 15.999) + 0.79(2 \\times 14.007) = 0.21(31.998) + 0.79(28.014) = 6.71958 + 22.13106 = 28.85064$\n\n将这些值代入 $Z_{st}$ 的表达式中：\n$$\nZ_{st} = \\frac{0.21 \\times 16.043}{2 \\times 28.85064 + 0.21 \\times 16.043}\n$$\n$$\nZ_{st} = \\frac{3.36903}{57.70128 + 3.36903} = \\frac{3.36903}{61.07031} \\approx 0.0551664\n$$\n四舍五入到四位有效数字，我们得到 $Z_{st} = 0.05517$。",
            "answer": "$$\n\\boxed{0.05517}\n$$"
        },
        {
            "introduction": "火焰中的化学转化是由组分输运方程中的源项，即化学反应产生的净生成率，所控制的。这个练习将提供一个动手实践的机会，让您学习如何根据详细的化学动力学机理，利用质量作用定律和阿伦尼乌斯公式来计算这些关键的生成率。掌握这一技能对于在燃烧模拟中实现或分析化学模型至关重要。",
            "id": "3966554",
            "problem": "我们为您提供了一个针对氢-空气层流预混火焰中羟基自由基物种的详细化学动力学机理的科学合理子集。您的任务是，在指定的局部热化学状态下，计算峰值温度位置处羟基自由基的净摩尔生成速率，并确定在此处最强烈控制羟基自由基生成的反应。计算必须从基本定律和经过充分检验的公式开始，不使用简化关系。\n\n使用的基本原理：\n从物种守恒和基元反应的质量作用定律开始，结合阿伦尼乌斯速率表达式。使用国际单位制（SI）。具体来说，使用理想气体对摩尔浓度的定义，即摩尔分数与压力的乘积除以通用气体常数与温度的乘积。使用可逆基元反应步骤，其正向和反向阿伦尼乌斯参数如下所示。\n\n机理定义：\n考虑以下八个物种：氢气（$\\mathrm{H_2}$）、氧气（$\\mathrm{O_2}$）、氮气（$\\mathrm{N_2}$）、水（$\\mathrm{H_2O}$）、羟基（$\\mathrm{OH}$）、氧原子（$\\mathrm{O}$）、氢原子（$\\mathrm{H}$）和氢过氧自由基（$\\mathrm{HO_2}$）。将使用以下六个基元可逆反应：\n\n反应 $\\#1$：$\\mathrm{H} + \\mathrm{O_2} \\rightleftharpoons \\mathrm{O} + \\mathrm{OH}$，正向阿伦尼乌斯参数为 $A_f = 3.55\\times10^{7}$，$n_f = -0.70$，$E_{a,f} = 7.12\\times10^{4}\\,\\mathrm{J/mol}$，反向阿伦尼乌斯参数为 $A_r = 1.20\\times10^{7}$，$n_r = -0.70$，$E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$。\n\n反应 $\\#2$：$\\mathrm{O} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{OH}$，正向阿伦尼乌斯参数为 $A_f = 1.80\\times10^{6}$，$n_f = 1.00$，$E_{a,f} = 3.16\\times10^{4}\\,\\mathrm{J/mol}$，反向阿伦尼乌斯参数为 $A_r = 7.00\\times10^{5}$，$n_r = 1.00$，$E_{a,r} = 0\\,\\mathrm{J/mol}$。\n\n反应 $\\#3$：$\\mathrm{OH} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{H_2O}$，正向阿伦尼乌斯参数为 $A_f = 2.10\\times10^{6}$，$n_f = 1.50$，$E_{a,f} = 2.10\\times10^{3}\\,\\mathrm{J/mol}$，反向阿伦尼乌斯参数为 $A_r = 1.00\\times10^{6}$，$n_r = 1.50$，$E_{a,r} = 3.00\\times10^{4}\\,\\mathrm{J/mol}$。\n\n反应 $\\#4$：$\\mathrm{HO_2} + \\mathrm{H} \\rightleftharpoons \\mathrm{OH} + \\mathrm{OH}$，正向阿伦尼乌斯参数为 $A_f = 1.00\\times10^{6}$，$n_f = 0.00$，$E_{a,f} = 0\\,\\mathrm{J/mol}$，反向阿伦尼乌斯参数为 $A_r = 2.00\\times10^{6}$，$n_r = 0.00$，$E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$。请注意，此反应在正向步骤中产生两个羟基自由基。\n\n反应 $\\#5$：$\\mathrm{HO_2} + \\mathrm{O} \\rightleftharpoons \\mathrm{OH} + \\mathrm{O_2}$，正向阿伦尼乌斯参数为 $A_f = 1.00\\times10^{6}$，$n_f = 0.00$，$E_{a,f} = 0\\,\\mathrm{J/mol}$，反向阿伦尼乌斯参数为 $A_r = 1.00\\times10^{6}$，$n_r = 0.00$，$E_{a,r} = 1.80\\times10^{4}\\,\\mathrm{J/mol}$。\n\n反应 $\\#6$：$\\mathrm{HO_2} + \\mathrm{OH} \\rightleftharpoons \\mathrm{H_2O} + \\mathrm{O_2}$，正向阿伦尼乌斯参数为 $A_f = 2.00\\times10^{6}$，$n_f = 0.00$，$E_{a,f} = 0\\,\\mathrm{J/mol}$，反向阿伦尼乌斯参数为 $A_r = 2.00\\times10^{6}$，$n_r = 0.00$，$E_{a,r} = 5.00\\times10^{3}\\,\\mathrm{J/mol}$。\n\n速率定义：\n对于每个反应 $j$，正向速率常数为 $k_{f,j} = A_{f,j}\\,T^{n_{f,j}}\\exp\\!\\left(-E_{a,f,j}/(R\\,T)\\right)$，反向速率常数为 $k_{r,j} = A_{r,j}\\,T^{n_{r,j}}\\exp\\!\\left(-E_{a,r,j}/(R\\,T)\\right)$，其中 $R$ 是通用气体常数。根据质量作用定律，正向反应进程速率是正向速率常数与反应物摩尔浓度（各浓度值取其化学计量系数次幂）的乘积，反向反应进程速率类似，但使用产物摩尔浓度。\n\n热化学状态和数据：\n假设理想气体行为。对于给定的压力 $p$ 和温度 $T$，物种 $i$ 的摩尔浓度为 $c_i = X_i\\,p/(R\\,T)$，其中 $X_i$ 是物种 $i$ 的摩尔分数。在下面的测试套件中，提供了除 $\\mathrm{N_2}$ 外所有物种的摩尔分数，您必须通过差值计算 $X_{\\mathrm{N_2}}$ 以满足 $\\sum_i X_i = 1$。通用气体常数为 $R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$。\n\n目标量：\n计算羟基自由基的净摩尔生成速率 $\\omega_{\\mathrm{OH}}$，其定义为各反应的净反应进程速率与该反应中羟基化学计量系数差（产物减去反应物）的乘积，再对所有反应求和。$\\omega_{\\mathrm{OH}}$ 的单位必须以 $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$ 报告。\n\n解释任务：\n对于每种状态，确定最强烈控制羟基自由基生成的三个反应，即在按反应分解时对 $\\omega_{\\mathrm{OH}}$ 具有最大绝对贡献的反应。使用与上述反应编号相对应的基于 $1$ 的索引报告这些控制反应的索引。\n\n测试套件：\n使用以下三个代表氢-空气层流预混火焰中峰值温度位置的测试用例：\n\n用例 $1$（类似化学计量的峰值温度）：$p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$，$T = 2.400\\times10^{3}\\,\\mathrm{K}$，除 $\\mathrm{N_2}$ 外的摩尔分数为 $X_{\\mathrm{H_2O}} = 3.50\\times10^{-1}$，$X_{\\mathrm{OH}} = 1.00\\times10^{-3}$，$X_{\\mathrm{O}} = 5.00\\times10^{-4}$，$X_{\\mathrm{H}} = 2.00\\times10^{-4}$，$X_{\\mathrm{O_2}} = 1.00\\times10^{-6}$，$X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$，$X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$。\n\n用例 $2$（类似贫燃的峰值温度）：$p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$，$T = 2.000\\times10^{3}\\,\\mathrm{K}$，除 $\\mathrm{N_2}$ 外的摩尔分数为 $X_{\\mathrm{H_2O}} = 2.50\\times10^{-1}$，$X_{\\mathrm{OH}} = 6.00\\times10^{-4}$，$X_{\\mathrm{O}} = 2.00\\times10^{-4}$，$X_{\\mathrm{H}} = 1.00\\times10^{-4}$，$X_{\\mathrm{O_2}} = 1.00\\times10^{-2}$，$X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$，$X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$。\n\n用例 $3$（类似富燃的峰值温度）：$p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$，$T = 2.100\\times10^{3}\\,\\mathrm{K}$，除 $\\mathrm{N_2}$ 外的摩尔分数为 $X_{\\mathrm{H_2O}} = 2.80\\times10^{-1}$，$X_{\\mathrm{OH}} = 8.00\\times10^{-4}$，$X_{\\mathrm{O}} = 1.00\\times10^{-4}$，$X_{\\mathrm{H}} = 4.00\\times10^{-4}$，$X_{\\mathrm{O_2}} = 5.00\\times10^{-7}$，$X_{\\mathrm{H_2}} = 2.00\\times10^{-2}$，$X_{\\mathrm{HO_2}} = 2.00\\times10^{-7}$。\n\n所需输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，其中每个测试用例的结果是一个形式为 $[\\omega_{\\mathrm{OH}}, i_1, i_2, i_3]$ 的内部列表，$\\omega_{\\mathrm{OH}}$ 的单位为 $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$，$i_1$, $i_2$, $i_3$ 是按绝对贡献排名的三个最主要控制反应的索引。作为结构示例，输出应类似于 $[[\\omega_1,i_{1,1},i_{1,2},i_{1,3}],[\\omega_2,i_{2,1},i_{2,2},i_{2,3}],[\\omega_3,i_{3,1},i_{3,2},i_{3,3}]]$。",
            "solution": "用户提供了一个化学动力学领域的问题，特别关注于计算高温气体系统中的反应速率。在尝试解决问题之前，需要验证问题的科学合理性和完整性。\n\n### 步骤 1：问题验证\n\n按照规定的协议，第一步是从问题陈述中逐字提取所有给定信息。\n\n**提取的已知信息：**\n\n*   **系统：** 氢-空气层流预混火焰。\n*   **目标物种：** 羟基自由基 ($\\mathrm{OH}$)。\n*   **基本定律：** 物种守恒、质量作用定律、阿伦尼乌斯速率表达式。\n*   **假设：** 理想气体行为。\n*   **物种列表：** 氢气 ($\\mathrm{H_2}$)、氧气 ($\\mathrm{O_2}$)、氮气 ($\\mathrm{N_2}$)、水 ($\\mathrm{H_2O}$)、羟基 ($\\mathrm{OH}$)、氧原子 ($\\mathrm{O}$)、氢原子 ($\\mathrm{H}$) 和氢过氧自由基 ($\\mathrm{HO_2}$)。\n*   **通用气体常数：** $R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$。\n*   **反应机理（6个可逆反应）：**\n    1.  $\\mathrm{H} + \\mathrm{O_2} \\rightleftharpoons \\mathrm{O} + \\mathrm{OH}$：$A_f = 3.55\\times10^{7}$，$n_f = -0.70$，$E_{a,f} = 7.12\\times10^{4}\\,\\mathrm{J/mol}$；$A_r = 1.20\\times10^{7}$，$n_r = -0.70$，$E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$。\n    2.  $\\mathrm{O} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{OH}$：$A_f = 1.80\\times10^{6}$，$n_f = 1.00$，$E_{a,f} = 3.16\\times10^{4}\\,\\mathrm{J/mol}$；$A_r = 7.00\\times10^{5}$，$n_r = 1.00$，$E_{a,r} = 0\\,\\mathrm{J/mol}$。\n    3.  $\\mathrm{OH} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{H_2O}$：$A_f = 2.10\\times10^{6}$，$n_f = 1.50$，$E_{a,f} = 2.10\\times10^{3}\\,\\mathrm{J/mol}$；$A_r = 1.00\\times10^{6}$，$n_r = 1.50$，$E_{a,r} = 3.00\\times10^{4}\\,\\mathrm{J/mol}$。\n    4.  $\\mathrm{HO_2} + \\mathrm{H} \\rightleftharpoons \\mathrm{OH} + \\mathrm{OH}$：$A_f = 1.00\\times10^{6}$，$n_f = 0.00$，$E_{a,f} = 0\\,\\mathrm{J/mol}$；$A_r = 2.00\\times10^{6}$，$n_r = 0.00$，$E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$。\n    5.  $\\mathrm{HO_2} + \\mathrm{O} \\rightleftharpoons \\mathrm{OH} + \\mathrm{O_2}$：$A_f = 1.00\\times10^{6}$，$n_f = 0.00$，$E_{a,f} = 0\\,\\mathrm{J/mol}$；$A_r = 1.00\\times10^{6}$，$n_r = 0.00$，$E_{a,r} = 1.80\\times10^{4}\\,\\mathrm{J/mol}$。\n    6.  $\\mathrm{HO_2} + \\mathrm{OH} \\rightleftharpoons \\mathrm{H_2O} + \\mathrm{O_2}$：$A_f = 2.00\\times10^{6}$，$n_f = 0.00$，$E_{a,f} = 0\\,\\mathrm{J/mol}$；$A_r = 2.00\\times10^{6}$，$n_r = 0.00$，$E_{a,r} = 5.00\\times10^{3}\\,\\mathrm{J/mol}$。\n*   **控制方程：**\n    *   正向速率常数：$k_{f,j} = A_{f,j}\\,T^{n_{f,j}}\\exp\\!\\left(-E_{a,f,j}/(R\\,T)\\right)$。\n    *   反向速率常数：$k_{r,j} = A_{r,j}\\,T^{n_{r,j}}\\exp\\!\\left(-E_{a,r,j}/(R\\,T)\\right)$。\n    *   摩尔浓度：$c_i = X_i\\,p/(R\\,T)$。\n    *   摩尔分数之和：$\\sum_i X_i = 1$。\n*   **目标量：**\n    *   羟基自由基的净摩尔生成速率，$\\omega_{\\mathrm{OH}}$，单位为 $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$。\n    *   对 $\\omega_{\\mathrm{OH}}$ 绝对贡献最大的三个反应的索引。\n*   **测试用例：**\n    *   用例 1：$p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$，$T = 2.400\\times10^{3}\\,\\mathrm{K}$，$X_{\\mathrm{H_2O}} = 3.50\\times10^{-1}$，$X_{\\mathrm{OH}} = 1.00\\times10^{-3}$，$X_{\\mathrm{O}} = 5.00\\times10^{-4}$，$X_{\\mathrm{H}} = 2.00\\times10^{-4}$，$X_{\\mathrm{O_2}} = 1.00\\times10^{-6}$，$X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$，$X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$。\n    *   用例 2：$p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$，$T = 2.000\\times10^{3}\\,\\mathrm{K}$，$X_{\\mathrm{H_2O}} = 2.50\\times10^{-1}$，$X_{\\mathrm{OH}} = 6.00\\times10^{-4}$，$X_{\\mathrm{O}} = 2.00\\times10^{-4}$，$X_{\\mathrm{H}} = 1.00\\times10^{-4}$，$X_{\\mathrm{O_2}} = 1.00\\times10^{-2}$，$X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$，$X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$。\n    *   用例 3：$p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$，$T = 2.100\\times10^{3}\\,\\mathrm{K}$，$X_{\\mathrm{H_2O}} = 2.80\\times10^{-1}$，$X_{\\mathrm{OH}} = 8.00\\times10^{-4}$，$X_{\\mathrm{O}} = 1.00\\times10^{-4}$，$X_{\\mathrm{H}} = 4.00\\times10^{-4}$，$X_{\\mathrm{O_2}} = 5.00\\times10^{-7}$，$X_{\\mathrm{H_2}} = 2.00\\times10^{-2}$，$X_{\\mathrm{HO_2}} = 2.00\\times10^{-7}$。\n\n### 步骤 2：提取的已知信息验证\n\n根据既定标准评估该问题。\n\n*   **科学依据：** 该问题牢固地植根于化学动力学和燃烧理论的原理中。它使用了质量作用定律和阿伦尼乌斯方程，这些都是基本概念。化学机理是氢燃烧的一个公认子集。所有数据在物理上都是合理的。\n*   **问题明确：** 提供了所有必要的输入：压力、温度、所有反应物种的摩尔分数，以及反应速率常数的所有参数。目标定义明确且可通过计算实现。每个测试用例都有唯一的解。\n*   **客观性：** 问题以精确、定量和无偏见的语言陈述。\n*   **完整性和一致性：** 问题是自包含的。通过差值计算惰性物种 $\\mathrm{N_2}$ 摩尔分数的指令确保了摩尔分数之和为一，从而使热化学状态完全确定。在每种情况下，提供的摩尔分数之和都小于 1，使得可以计算出正的 $X_{\\mathrm{N_2}}$。单位被指定为 SI 单位制，并且所提供的阿伦尼乌斯参数（虽然没有明确说明单位）在数值上与标准的基于 SI 的公式（例如，双分子反应的 $A$ 单位为 $\\mathrm{m^3 mol^{-1} s^{-1} K^{-n}}$）一致，以得出目标量单位为 $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效的**。它在科学上是合理的，问题明确，并包含唯一解所需的所有必要信息。因此，我将继续推导并给出解答。\n\n---\n\n### 解答推导\n\n目标是计算羟基自由基的净摩尔生成速率 $\\omega_{\\mathrm{OH}}$，并确定在三种给定的热化学状态下最具影响力的反应。\n\n**1. 基本原理**\n\n对于空间均匀系统（如在火焰中特定位置的假设），物种 $i$ 的摩尔浓度 $c_i$ 的变化率由其净化学生成速率 $\\omega_i$ 控制。\n$$\n\\frac{dc_i}{dt} = \\omega_i\n$$\n净生成速率 $\\omega_i$ 是其在机理中所有基元反应中生成速率的总和。对于一组 $N_{rxn}$ 个反应，这表示为：\n$$\n\\omega_i = \\sum_{j=1}^{N_{rxn}} \\Delta\\nu_{ij} q_j\n$$\n其中 $\\Delta\\nu_{ij} = (\\nu''_{ij} - \\nu'_{ij})$ 是物种 $i$ 在反应 $j$ 中的净化学计量系数（$\\nu''_{ij}$ 表示产物，$\\nu'_{ij}$ 表示反应物），$q_j$ 是反应 $j$ 的净反应进程速率。\n\n净反应进程速率 $q_j$ 是其正向速率 ($q_{f,j}$) 和反向速率 ($q_{r,j}$) 之差：\n$$\nq_j = q_{f,j} - q_{r,j}\n$$\n根据基元反应 $j$ 的质量作用定律，这些速率由以下公式给出：\n$$\nq_{f,j} = k_{f,j} \\prod_{k=1}^{N_{species}} c_k^{\\nu'_{kj}} \\quad \\text{和} \\quad q_{r,j} = k_{r,j} \\prod_{k=1}^{N_{species}} c_k^{\\nu''_{kj}}\n$$\n其中 $k_{f,j}$ 和 $k_{r,j}$ 是正向和反向速率常数，$c_k$ 是物种 $k$ 的摩尔浓度。\n\n速率常数由广义阿伦尼乌斯方程描述：\n$$\nk_j(T) = A_j T^{n_j} \\exp\\left(-\\frac{E_{a,j}}{RT}\\right)\n$$\n其中 $A_j$ 是指前因子，$n_j$ 是温度指数，$E_{a,j}$ 是活化能，$T$ 是绝对温度，$R$ 是通用气体常数。\n\n最后，在理想气体假设下，物种 $i$ 的摩尔浓度 $c_i$ 与其摩尔分数 $X_i$、系统压力 $p$ 和温度 $T$ 的关系为：\n$$\nc_i = \\frac{X_i p}{RT}\n$$\n\n**2. 应用于羟基自由基 ($\\mathrm{OH}$)**\n\n我们必须确定在六个指定反应中，$\\mathrm{OH}$ 的净化学计量系数 $\\Delta\\nu_{\\mathrm{OH},j}$。\n\n*   反应 1：$\\mathrm{H} + \\mathrm{O_2} \\rightleftharpoons \\mathrm{O} + \\mathrm{OH}$。$\\nu'_{\\mathrm{OH},1} = 0$，$\\nu''_{\\mathrm{OH},1} = 1 \\implies \\Delta\\nu_{\\mathrm{OH},1} = 1$。\n*   反应 2：$\\mathrm{O} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{OH}$。$\\nu'_{\\mathrm{OH},2} = 0$，$\\nu''_{\\mathrm{OH},2} = 1 \\implies \\Delta\\nu_{\\mathrm{OH},2} = 1$。\n*   反应 3：$\\mathrm{OH} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{H_2O}$。$\\nu'_{\\mathrm{OH},3} = 1$，$\\nu''_{\\mathrm{OH},3} = 0 \\implies \\Delta\\nu_{\\mathrm{OH},3} = -1$。\n*   反应 4：$\\mathrm{HO_2} + \\mathrm{H} \\rightleftharpoons \\mathrm{OH} + \\mathrm{OH}$。$\\nu'_{\\mathrm{OH},4} = 0$，$\\nu''_{\\mathrm{OH},4} = 2 \\implies \\Delta\\nu_{\\mathrm{OH},4} = 2$。\n*   反应 5：$\\mathrm{HO_2} + \\mathrm{O} \\rightleftharpoons \\mathrm{OH} + \\mathrm{O_2}$。$\\nu'_{\\mathrm{OH},5} = 0$，$\\nu''_{\\mathrm{OH},5} = 1 \\implies \\Delta\\nu_{\\mathrm{OH},5} = 1$。\n*   反应 6：$\\mathrm{HO_2} + \\mathrm{OH} \\rightleftharpoons \\mathrm{H_2O} + \\mathrm{O_2}$。$\\nu'_{\\mathrm{OH},6} = 1$，$\\nu''_{\\mathrm{OH},6} = 0 \\implies \\Delta\\nu_{\\mathrm{OH},6} = -1$。\n\n反应进程速率 $q_j$ 是：\n$q_1 = k_{f,1} c_{\\mathrm{H}} c_{\\mathrm{O_2}} - k_{r,1} c_{\\mathrm{O}} c_{\\mathrm{OH}}$\n$q_2 = k_{f,2} c_{\\mathrm{O}} c_{\\mathrm{H_2}} - k_{r,2} c_{\\mathrm{H}} c_{\\mathrm{OH}}$\n$q_3 = k_{f,3} c_{\\mathrm{OH}} c_{\\mathrm{H_2}} - k_{r,3} c_{\\mathrm{H}} c_{\\mathrm{H_2O}}$\n$q_4 = k_{f,4} c_{\\mathrm{HO_2}} c_{\\mathrm{H}} - k_{r,4} c_{\\mathrm{OH}}^2$\n$q_5 = k_{f,5} c_{\\mathrm{HO_2}} c_{\\mathrm{O}} - k_{r,5} c_{\\mathrm{OH}} c_{\\mathrm{O_2}}$\n$q_6 = k_{f,6} c_{\\mathrm{HO_2}} c_{\\mathrm{OH}} - k_{r,6} c_{\\mathrm{H_2O}} c_{\\mathrm{O_2}}$\n\n$\\mathrm{OH}$ 的净生成速率是各反应贡献的总和，$\\omega_{\\mathrm{OH}, j} = \\Delta\\nu_{\\mathrm{OH},j} q_j$：\n$$\n\\omega_{\\mathrm{OH}} = \\sum_{j=1}^{6} \\omega_{\\mathrm{OH}, j} = q_1 + q_2 - q_3 + 2q_4 + q_5 - q_6\n$$\n\n**3. 计算算法**\n\n对于由 $(p, T, \\{X_i\\}_{i\\neq \\mathrm{N_2}})$ 指定的每个测试用例：\n1.  计算氮气的摩尔分数：$X_{\\mathrm{N_2}} = 1 - \\sum_{i \\in \\{\\mathrm{H_2}, \\mathrm{O_2}, ...\\}} X_i$。\n2.  使用 $c_i = X_i p / (RT)$ 计算全部 8 个物种的摩尔浓度。\n3.  对于 6 个反应中的每一个：\n    a. 使用阿伦尼乌斯公式和给定的参数计算正向速率常数 $k_{f,j}$ 和反向速率常数 $k_{r,j}$。\n    b. 使用质量作用定律和计算出的浓度计算正向反应进程速率 $q_{f,j}$ 和反向反应进程速率 $q_{r,j}$。\n    c. 计算净反应进程速率 $q_j = q_{f,j} - q_{r,j}$。\n4.  计算每个反应对 $\\mathrm{OH}$ 净生成的贡献：$\\omega_{\\mathrm{OH},j} = \\Delta\\nu_{\\mathrm{OH},j} q_j$。\n5.  将这些贡献相加得到总净生成速率：$\\omega_{\\mathrm{OH}} = \\sum_{j=1}^{6} \\omega_{\\mathrm{OH},j}$。\n6.  为了确定控制反应，计算每个贡献的绝对值 $|\\omega_{\\mathrm{OH},j}|$。\n7.  按降序对这些绝对贡献进行排序，并确定相应的反应索引（基于 1）。前三个是主要的控制反应。\n8.  按要求格式化结果：$[\\omega_{\\mathrm{OH}}, i_1, i_2, i_3]$。\n\n此过程为基于所提供数据和基本原理得出解决方案提供了一条严谨而完整的路径。以下代码实现了此算法。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the net molar production rate of the hydroxyl radical (OH)\n    and identifies the controlling reactions for given thermochemical states\n    in a hydrogen-air flame.\n    \"\"\"\n    # Universal Gas Constant in SI units: J/(mol.K)\n    R = 8.314462618\n\n    # Species list in the order they are typically handled\n    species_map = {\n        'H2': 0, 'O2': 1, 'H2O': 2, 'OH': 3, 'O': 4,\n        'H': 5, 'HO2': 6, 'N2': 7\n    }\n\n    # Reaction mechanism data.\n    # A_f/A_r units are m^3/mol/s for bimolecular rxns (adjusted for T^n).\n    # E_a units are J/mol.\n    reactions = [\n        # R1: H + O2 = O + OH\n        {'reactants': {'H': 1, 'O2': 1}, 'products': {'O': 1, 'OH': 1},\n         'f': {'A': 3.55e7, 'n': -0.70, 'Ea': 7.12e4},\n         'r': {'A': 1.20e7, 'n': -0.70, 'Ea': 2.00e4}},\n        # R2: O + H2 = H + OH\n        {'reactants': {'O': 1, 'H2': 1}, 'products': {'H': 1, 'OH': 1},\n         'f': {'A': 1.80e6, 'n': 1.00, 'Ea': 3.16e4},\n         'r': {'A': 7.00e5, 'n': 1.00, 'Ea': 0.0}},\n        # R3: OH + H2 = H + H2O\n        {'reactants': {'OH': 1, 'H2': 1}, 'products': {'H': 1, 'H2O': 1},\n         'f': {'A': 2.10e6, 'n': 1.50, 'Ea': 2.10e3},\n         'r': {'A': 1.00e6, 'n': 1.50, 'Ea': 3.00e4}},\n        # R4: HO2 + H = OH + OH\n        {'reactants': {'HO2': 1, 'H': 1}, 'products': {'OH': 2},\n         'f': {'A': 1.00e6, 'n': 0.00, 'Ea': 0.0},\n         'r': {'A': 2.00e6, 'n': 0.00, 'Ea': 2.00e4}},\n        # R5: HO2 + O = OH + O2\n        {'reactants': {'HO2': 1, 'O': 1}, 'products': {'OH': 1, 'O2': 1},\n         'f': {'A': 1.00e6, 'n': 0.00, 'Ea': 0.0},\n         'r': {'A': 1.00e6, 'n': 0.00, 'Ea': 1.80e4}},\n        # R6: HO2 + OH = H2O + O2\n        {'reactants': {'HO2': 1, 'OH': 1}, 'products': {'H2O': 1, 'O2': 1},\n         'f': {'A': 2.00e6, 'n': 0.00, 'Ea': 0.0},\n         'r': {'A': 2.00e6, 'n': 0.00, 'Ea': 5.00e3}},\n    ]\n\n    # Pre-calculate stoichiometric coefficients for OH for each reaction\n    nu_OH = np.array([\n        rx['products'].get('OH', 0) - rx['reactants'].get('OH', 0) for rx in reactions\n    ])\n\n    test_cases = [\n        # Case 1 (stoichiometric-like)\n        {'p': 1.01325e5, 'T': 2.400e3,\n         'X': {'H2O': 3.50e-1, 'OH': 1.00e-3, 'O': 5.00e-4, 'H': 2.00e-4,\n               'O2': 1.00e-6, 'H2': 1.00e-6, 'HO2': 1.00e-7}},\n        # Case 2 (lean-like)\n        {'p': 1.01325e5, 'T': 2.000e3,\n         'X': {'H2O': 2.50e-1, 'OH': 6.00e-4, 'O': 2.00e-4, 'H': 1.00e-4,\n               'O2': 1.00e-2, 'H2': 1.00e-6, 'HO2': 1.00e-7}},\n        # Case 3 (rich-like)\n        {'p': 1.01325e5, 'T': 2.100e3,\n         'X': {'H2O': 2.80e-1, 'OH': 8.00e-4, 'O': 1.00e-4, 'H': 4.00e-4,\n               'O2': 5.00e-7, 'H2': 2.00e-2, 'HO2': 2.00e-7}},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        p, T, X_in = case['p'], case['T'], case['X']\n        \n        # Complete mole fractions\n        X = X_in.copy()\n        X_sum = sum(X.values())\n        if X_sum = 1.0:\n            raise ValueError(\"Sum of mole fractions is = 1\")\n        X['N2'] = 1.0 - X_sum\n\n        # Calculate molar concentrations (mol/m^3)\n        p_over_RT = p / (R * T)\n        c = {name: val * p_over_RT for name, val in X.items()}\n\n        q = np.zeros(len(reactions))\n        \n        for j, rx in enumerate(reactions):\n            # Forward rate\n            kf_params = rx['f']\n            kf = kf_params['A'] * (T ** kf_params['n']) * np.exp(-kf_params['Ea'] / (R * T))\n            \n            qf_conc_prod = 1.0\n            for species, stoich in rx['reactants'].items():\n                qf_conc_prod *= c[species] ** stoich\n            qf = kf * qf_conc_prod\n\n            # Reverse rate\n            kr_params = rx['r']\n            kr = kr_params['A'] * (T ** kr_params['n']) * np.exp(-kr_params['Ea'] / (R * T))\n            \n            qr_conc_prod = 1.0\n            for species, stoich in rx['products'].items():\n                qr_conc_prod *= c[species] ** stoich\n            qr = kr * qr_conc_prod\n\n            # Net rate of progress for reaction j\n            q[j] = qf - qr\n            \n        # Reaction-wise production rate of OH (mol/m^3/s)\n        omega_OH_j = nu_OH * q\n        \n        # Total net production rate of OH\n        omega_OH_total = np.sum(omega_OH_j)\n        \n        # Identify controlling reactions (1-based index)\n        # Sort by absolute contribution in descending order\n        controlling_rxn_indices = np.argsort(np.abs(omega_OH_j))[::-1]\n        top_3_indices = (controlling_rxn_indices[:3] + 1).tolist()\n        \n        all_results.append([omega_OH_total, *top_3_indices])\n\n    # Format output as specified\n    result_str_list = [str( res ).replace(\" \", \"\") for res in all_results]\n    print(f\"[{','.join(result_str_list)}]\")\n\n\nsolve()\n```"
        },
        {
            "introduction": "任何数值模拟的结果都是对真实物理过程的一种近似，其准确性强烈依赖于计算网格的分辨率。本练习将介绍 Richardson 外推法，这是一种评估模拟结果的网格收敛性、估计数值方法精度阶数以及预测连续介质极限解的强大技术。对于获得可靠且可信的计算结果而言，这是一个必不可少的验证步骤。",
            "id": "3966547",
            "problem": "您的任务是在计算热工学领域的层流预混火焰模拟背景下，针对层流燃烧速度和一维温度分布，使用理查森外推法进行网格收敛性研究。目标是估计空间离散的精度阶，并计算外推的连续介质极限预测值。该分析必须纯粹以数学术语进行阐述，并通过算法实现。\n\n从一个数值计算量的渐近截断误差模型开始，该模型源自反应流的质量、组分和能量守恒定律的一致空间离散化：在网格间距为 $h$ 时计算出的量满足\n$$\nU_h \\;=\\; U^\\star + C\\,h^p + \\mathcal{O}(h^{p+1}),\n$$\n其中 $U^\\star$ 是连续介质（精确网格）解，$C$ 是一个与 $h$ 无关的常数，$p$ 是离散化的精度阶。当存在两个加密比为 $r  1$ 的连续加密网格解时，其差值会以可预测的方式随 $h^p$ 缩放。这种关系使得在不知道 $U^\\star$ 的情况下，可以从 $h$、$h/r$ 和 $h/r^2$ 处的三个解来估计 $p$ 和 $U^\\star$。\n\n您必须实现一个程序，该程序能够：\n- 使用三个网格解，估计层流燃烧速度 $S_L$ (Laminar Burning Velocity) 的精度阶 $p$。\n- 对跨网格的温度分布进行逐点对齐，估计温度场的全局精度阶 $p$，并计算最密网格节点上的理查森外推温度分布。\n- 报告每个测试案例中 $S_L$ 的估计精度阶 $p$、外推的 $S_L$ 值（单位为 $\\mathrm{m/s}$）、温度分布的估计全局精度阶 $p$，以及外推的峰值温度（单位为 $\\mathrm{K}$）。\n\n为使测试定义明确且可复现，并避免对外部求解器的依赖，请使用以下物理上合理的代理稳态预混火焰温度分布和合成数值误差模型。对于一维域 $x \\in [0,L]$，精确温度场建模为\n$$\nT_{\\mathrm{exact}}(x) \\;=\\; T_u \\;+\\; \\left(T_b - T_u\\right)\\,\\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{x - x_f}{\\delta}\\right)\\right],\n$$\n其中 $T_u$ 是未燃温度，$T_b$ 是已燃温度，$x_f$ 是名义火焰位置，$\\delta$ 是热厚度。在网格间距为 $h$ 时的合成数值温度定义为\n$$\nT_h(x_i) \\;=\\; T_{\\mathrm{exact}}(x_i) \\;+\\; C_T\\,h^{p_{\\mathrm{true}}}\\,\\phi(x_i), \\quad \\phi(x) = \\sin\\!\\left(\\frac{3\\pi x}{L}\\right),\n$$\n在均匀网格节点 $x_i = i\\,h$（其中整数 $i$ 满足 $x_i \\in [0,L]$）上求值。在网格间距为 $h$ 时的合成层流燃烧速度为\n$$\nS_L(h) \\;=\\; S_L^{\\mathrm{exact}} \\;+\\; C_S\\,h^{p_{\\mathrm{true}}},\n$$\n其中 $S_L^{\\mathrm{exact}}$ 是连续介质极限层流燃烧速度。值 $p_{\\mathrm{true}}$ 仅用于合成数据，您的估计算法不应使用它。\n\n您的程序必须为三个网格层级（间距分别为 $h_0$、$h_1 = h_0/r$ 和 $h_2 = h_0/r^2$）构建数据，然后：\n- 使用在 $h_0$、$h_1$、$h_2$ 处的三个合成 $S_L(h)$ 值和一个单一加密比 $r$ 来估计 $S_L$ 的精度阶 $p$。\n- 在最密网格节点上对齐温度场（通过对较粗网格的温度数组进行插值），从连续差分的范数中计算全局温度精度阶 $p$，并执行理查森外推以预测最密网格节点上的连续介质极限温度场。最后，提取外推分布的峰值温度（最大值）。\n\n$S_L$ 以 $\\mathrm{m/s}$ 表示，温度以 $\\mathrm{K}$ 表示。角度（未使用）无需说明。输出中不出现百分比。输出为数值浮点数。\n\n测试套件和参数：\n- 案例 1（理想情况，清晰的加密）：\n  - $L = 0.01$ $\\mathrm{m}$，$\\delta = 0.0005$ $\\mathrm{m}$，$x_f = 0.004$ $\\mathrm{m}$。\n  - $T_u = 300$ $\\mathrm{K}$，$T_b = 2100$ $\\mathrm{K}$。\n  - $S_L^{\\mathrm{exact}} = 0.40$ $\\mathrm{m/s}$。\n  - $h_0 = 2.0\\times 10^{-4}$ $\\mathrm{m}$，$r = 2.0$。\n  - $p_{\\mathrm{true}} = 2.1$，$C_T = 400$（单位选择使得 $C_T\\,h^{p_{\\mathrm{true}}}$ 产生 $\\mathrm{K}$），$C_S = 0.08$（单位选择使得 $C_S\\,h^{p_{\\mathrm{true}}}$ 产生 $\\mathrm{m/s}$）。\n- 案例 2（中等加密比，较低阶数）：\n  - $L = 0.015$ $\\mathrm{m}$，$\\delta = 0.0008$ $\\mathrm{m}$，$x_f = 0.006$ $\\mathrm{m}$。\n  - $T_u = 320$ $\\mathrm{K}$，$T_b = 2200$ $\\mathrm{K}$。\n  - $S_L^{\\mathrm{exact}} = 0.55$ $\\mathrm{m/s}$。\n  - $h_0 = 1.5\\times 10^{-4}$ $\\mathrm{m}$，$r = 1.5$。\n  - $p_{\\mathrm{true}} = 1.8$，$C_T = 300$，$C_S = 0.05$。\n- 案例 3（小误差幅度的边界情况）：\n  - $L = 0.012$ $\\mathrm{m}$，$\\delta = 0.0006$ $\\mathrm{m}$，$x_f = 0.0055$ $\\mathrm{m}$。\n  - $T_u = 290$ $\\mathrm{K}$，$T_b = 2000$ $\\mathrm{K}$。\n  - $S_L^{\\mathrm{exact}} = 0.48$ $\\mathrm{m/s}$。\n  - $h_0 = 2.4\\times 10^{-4}$ $\\mathrm{m}$，$r = 2.0$。\n  - $p_{\\mathrm{true}} = 2.0$，$C_T = 100$，$C_S = 0.02$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果严格按以下顺序排列：\n- 案例 1：$S_L$ 的 $p$ 估计值（无单位），外推的 $S_L$（单位 $\\mathrm{m/s}$），温度的全局 $p$ 估计值（无单位），外推的峰值温度（单位 $\\mathrm{K}$）。\n- 案例 2：按相同顺序排列的相同四个量。\n- 案例 3：按相同顺序排列的相同四个量。\n\n因此，输出必须是以下形式的单行：\n$$\n[\\text{p\\_SL\\_1},\\text{SL\\_inf\\_1},\\text{p\\_T\\_1},\\text{T\\_peak\\_inf\\_1},\\text{p\\_SL\\_2},\\text{SL\\_inf\\_2},\\text{p\\_T\\_2},\\text{T\\_peak\\_inf\\_2},\\text{p\\_SL\\_3},\\text{SL\\_inf\\_3},\\text{p\\_T\\_3},\\text{T\\_peak\\_inf\\_3}],\n$$\n所有条目均为十进制浮点数。",
            "solution": "该问题要求实现理查森外推法，对从层流预混火焰模拟中得到的两个量进行网格收敛性研究：标量层流燃烧速度 $S_L$ 和一维温度场 $T(x)$。该分析基于在特征间距为 $h$ 的网格上计算量 $U_h$ 的渐近误差模型：\n$$\nU_h = U^\\star + C h^p + \\mathcal{O}(h^{p+1})\n$$\n其中 $U^\\star$ 是精确的连续介质解，$C$ 是一个常数，$p$ 是数值方法的理论精度阶。我们获得了在三个连续加密的网格上的解，其网格间距分别为 $h_0$、$h_1 = h_0/r$ 和 $h_2 = h_0/r^2$，其中 $r  1$ 是加密比。\n\n**标量（层流燃烧速度 $S_L$）的方法论**\n\n对于像层流燃烧速度 $S_L$ 这样的标量，我们将其在三个网格上的数值解表示为 $S_{L,0}$、$S_{L,1}$ 和 $S_{L,2}$，分别对应网格间距 $h_0$、$h_1$ 和 $h_2$。忽略高阶项，我们得到以下方程组：\n$$\nS_{L,0} \\approx S_L^\\star + C_S h_0^p \\\\\nS_{L,1} \\approx S_L^\\star + C_S h_1^p = S_L^\\star + C_S (h_0/r)^p \\\\\nS_{L,2} \\approx S_L^\\star + C_S h_2^p = S_L^\\star + C_S (h_0/r^2)^p\n$$\n为了估计精度阶 $p$，我们计算连续解之间的差值：\n$$\n\\epsilon_{01} = S_{L,0} - S_{L,1} \\approx C_S h_0^p (1 - 1/r^p) \\\\\n\\epsilon_{12} = S_{L,1} - S_{L,2} \\approx C_S (h_0/r)^p (1 - 1/r^p)\n$$\n这些差值的比率可以分离出项 $r^p$：\n$$\n\\frac{\\epsilon_{01}}{\\epsilon_{12}} = \\frac{S_{L,0} - S_{L,1}}{S_{L,1} - S_{L,2}} \\approx r^p\n$$\n求解 $p$ 可得到估计的精度阶：\n$$\np_{S_L} = \\frac{\\ln\\left(\\frac{S_{L,0} - S_{L,1}}{S_{L,1} - S_{L,2}}\\right)}{\\ln(r)}\n$$\n一旦估计出 $p$，我们就可以使用两个最密网格的解（$S_{L,1}$、$S_{L,2}$）来计算连续介质解 $S_L^\\star$ 的一个改进的、外推的值，以获得更好的精度。通过重新整理 $S_{L,1}$ 和 $S_{L,2}$ 的方程以消除误差项 $C_S h_1^p$，可以得到理查森外推公式：\n$$\nS_L^\\star = S_{L,2} + \\frac{S_{L,2} - S_{L,1}}{r^{p_{S_L}} - 1}\n$$\n\n**场量（温度 $T$）的方法论**\n\n对温度场 $T(x)$ 的分析遵循相同的原则，但需要额外的步骤来处理空间分布的数据。\n\n$1$.  **数据合成与网格生成**：对于每个网格层级 $k \\in \\{0, 1, 2\\}$，在域 $[0, L]$ 上生成一个间距为 $h_k$ 的均匀网格 $x_k$。然后使用提供的精确温度 $T_{\\mathrm{exact}}(x)$ 和数值误差项的模型，在 $x_k$ 的每个节点上计算合成温度数据 $T_{h_k}$。\n\n$2$.  **分布对齐**：温度分布 $T_{h_0}$、$T_{h_1}$ 和 $T_{h_2}$ 定义在具有不同点数的网格上。为了比较它们，必须将它们表示在一个公共网格上。为此，选择最密的网格 $x_2$。使用线性插值将较粗的分布 $T_{h_0}$ 和 $T_{h_1}$ 插值到 $x_2$ 的节点上。这会产生三个定义在同一空间坐标集上的分布：$T_{h_0}^{\\text{interp}}$、$T_{h_1}^{\\text{interp}}$ 和 $T_{h_2}$。\n\n$3$.  **全局精度阶 $p_T$**：为了估计整个温度场的单个全局精度阶，我们使用向量范数来衡量对齐后分布之间差异的大小。$L_2$-范数是一个标准选择。差异计算如下：\n    $$\n    \\epsilon_{T,01} = \\| T_{h_0}^{\\text{interp}} - T_{h_1}^{\\text{interp}} \\|_2 \\\\\n    \\epsilon_{T,12} = \\| T_{h_1}^{\\text{interp}} - T_{h_2} \\|_2\n    $$\n    然后将精度阶的公式应用于这些标量范数值：\n    $$\n    p_T = \\frac{\\ln\\left(\\frac{\\epsilon_{T,01}}{\\epsilon_{T,12}}\\right)}{\\ln(r)}\n    $$\n\n$4$.  **逐点外推和峰值温度**：使用估计的全局精度阶 $p_T$，在密网格 $x_2$ 的每个点 $x_i$ 上应用理查森外推公式，以计算外推的连续介质温度分布 $T^\\star(x_i)$：\n    $$\n    T^\\star(x_i) = T_{h_2}(x_i) + \\frac{T_{h_2}(x_i) - T_{h_1}^{\\text{interp}}(x_i)}{r^{p_T} - 1}\n    $$\n    这可以通过对对齐后的分布进行向量运算来高效地执行。最后，通过找到所得分布 $T^\\star$ 的最大值来确定外推的峰值温度 $T_{\\text{peak}}^\\star$。\n\n**算法实现**\n\n每个测试案例的总体算法流程如下：\n$1$.  设置物理和数值参数（$L, \\delta, T_u, T_b, x_f, S_L^{\\mathrm{exact}}, C_S, C_T, p_{\\mathrm{true}}, h_0, r$）。\n$2$.  计算网格间距 $h_1 = h_0/r$ 和 $h_2 = h_0/r^2$。\n$3$.  为层流燃烧速度生成三个合成数据点 $S_{L,0}, S_{L,1}, S_{L,2}$。\n$4$.  应用推导出的公式计算估计的精度阶 $p_{S_L}$ 和外推值 $S_L^\\star$。\n$5$.  生成三个坐标数组 $x_0, x_1, x_2$ 和相应的合成温度分布 $T_{h_0}, T_{h_1}, T_{h_2}$。\n$6$.  将 $T_{h_0}$ 和 $T_{h_1}$ 插值到 $x_2$ 网格上。\n$7$.  计算对齐后分布之间差值的 $L_2$-范数，以找到全局温度精度阶 $p_T$。\n$8$.  计算逐点外推的温度分布 $T^\\star$ 并找到其最大值 $T_{\\text{peak}}^\\star$。\n$9$.  收集四个结果值（$p_{S_L}, S_L^\\star, p_T, T_{\\text{peak}}^\\star$）用于最终输出。\n\n该过程系统地应用于所有测试案例，以生成所需的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a grid convergence study using Richardson extrapolation for laminar\n    burning velocity and temperature profiles based on synthetic flame data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": 0.01, \"delta\": 0.0005, \"x_f\": 0.004,\n            \"T_u\": 300.0, \"T_b\": 2100.0,\n            \"S_L_exact\": 0.40,\n            \"h0\": 2.0e-4, \"r\": 2.0,\n            \"p_true\": 2.1, \"C_T\": 400.0, \"C_S\": 0.08,\n        },\n        {\n            \"L\": 0.015, \"delta\": 0.0008, \"x_f\": 0.006,\n            \"T_u\": 320.0, \"T_b\": 2200.0,\n            \"S_L_exact\": 0.55,\n            \"h0\": 1.5e-4, \"r\": 1.5,\n            \"p_true\": 1.8, \"C_T\": 300.0, \"C_S\": 0.05,\n        },\n        {\n            \"L\": 0.012, \"delta\": 0.0006, \"x_f\": 0.0055,\n            \"T_u\": 290.0, \"T_b\": 2000.0,\n            \"S_L_exact\": 0.48,\n            \"h0\": 2.4e-4, \"r\": 2.0,\n            \"p_true\": 2.0, \"C_T\": 100.0, \"C_S\": 0.02,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters\n        L, delta, x_f = case[\"L\"], case[\"delta\"], case[\"x_f\"]\n        T_u, T_b = case[\"T_u\"], case[\"T_b\"]\n        S_L_exact = case[\"S_L_exact\"]\n        h0, r = case[\"h0\"], case[\"r\"]\n        p_true, C_T, C_S = case[\"p_true\"], case[\"C_T\"], case[\"C_S\"]\n\n        # Define grid spacings\n        h1 = h0 / r\n        h2 = h0 / r**2\n        h_levels = [h0, h1, h2]\n\n        # --- Part 1: Laminar Burning Velocity (S_L) Analysis ---\n\n        # Synthesize S_L data\n        S_L_h = [S_L_exact + C_S * h**p_true for h in h_levels]\n        S_L0, S_L1, S_L2 = S_L_h[0], S_L_h[1], S_L_h[2]\n\n        # Estimate order of accuracy p for S_L\n        # p = log((U0-U1)/(U1-U2)) / log(r)\n        diff_01_SL = S_L0 - S_L1\n        diff_12_SL = S_L1 - S_L2\n        \n        # Handle potential division by zero or log of non-positive\n        if diff_12_SL == 0 or diff_01_SL / diff_12_SL = 0:\n            # Fallback if ratio isn't positive, though not expected here\n            p_SL_est = np.nan \n        else:\n            p_SL_est = np.log(diff_01_SL / diff_12_SL) / np.log(r)\n\n        # Compute Richardson-extrapolated S_L\n        # U_star = U2 + (U2 - U1) / (r^p - 1)\n        if np.isclose(r**p_SL_est, 1.0):\n             SL_extrap = np.nan\n        else:\n             SL_extrap = S_L2 + (S_L2 - S_L1) / (r**p_SL_est - 1)\n\n        # --- Part 2: Temperature Profile (T) Analysis ---\n\n        # Define helper functions for synthetic data generation\n        def T_exact(x, Tu, Tb, xf, d):\n            return Tu + (Tb - Tu) * 0.5 * (1 + np.tanh((x - xf) / d))\n\n        def phi(x, L_domain):\n            return np.sin(3 * np.pi * x / L_domain)\n\n        # Generate grids and temperature profiles\n        grids = []\n        temp_profiles = []\n        for h in h_levels:\n            # Create grid using linspace for robustness\n            num_intervals = int(round(L / h))\n            x_grid = np.linspace(0, L, num_intervals + 1)\n            grids.append(x_grid)\n            \n            # Synthesize temperature profile\n            T_h = T_exact(x_grid, T_u, T_b, x_f, delta) + C_T * h**p_true * phi(x_grid, L)\n            temp_profiles.append(T_h)\n            \n        x0, x1, x2 = grids[0], grids[1], grids[2]\n        T0, T1, T2 = temp_profiles[0], temp_profiles[1], temp_profiles[2]\n\n        # Align profiles on the finest grid (x2) using linear interpolation\n        T0_interp = np.interp(x2, x0, T0)\n        T1_interp = np.interp(x2, x1, T1)\n\n        # Estimate global order of accuracy p for T using L2 norms\n        diff_01_T_norm = np.linalg.norm(T0_interp - T1_interp)\n        diff_12_T_norm = np.linalg.norm(T1_interp - T2)\n\n        if diff_12_T_norm == 0 or diff_01_T_norm / diff_12_T_norm = 0:\n            p_T_est = np.nan\n        else:\n            p_T_est = np.log(diff_01_T_norm / diff_12_T_norm) / np.log(r)\n            \n        # Compute pointwise Richardson-extrapolated T profile\n        if np.isclose(r**p_T_est, 1.0):\n            T_extrap_profile = np.full_like(T2, np.nan)\n        else:\n            T_extrap_profile = T2 + (T2 - T1_interp) / (r**p_T_est - 1)\n        \n        # Find the peak temperature of the extrapolated profile\n        T_peak_extrap = np.max(T_extrap_profile)\n\n        # Append results for this case\n        results.extend([p_SL_est, SL_extrap, p_T_est, T_peak_extrap])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{val:.10f}' for val in results)}]\")\n\nsolve()\n```"
        }
    ]
}