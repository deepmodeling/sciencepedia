{
    "hands_on_practices": [
        {
            "introduction": "In simulating non-premixed flames, the complex interplay of fluid mixing and chemical reaction can be elegantly simplified by tracking a conserved scalar. This exercise guides you through the first-principles derivation of the Bilger mixture fraction, a variable that describes the local mixing state between fuel and oxidizer based on elemental conservation, independent of the reaction progress . Mastering this concept provides a powerful framework for analyzing and modeling diffusion flames.",
            "id": "3966539",
            "problem": "In nonpremixed laminar flame simulations within computational thermal engineering, a conserved scalar known as the mixture fraction is used to parameterize composition and thermochemical state along mixing lines. Consider a general reacting system containing the elements carbon ($C$), hydrogen ($H$), nitrogen ($N$), and oxygen ($O$). Using only conservation of elemental atoms and the stoichiometry of complete oxidation to carbon dioxide ($\\mathrm{CO}_{2}$), water ($\\mathrm{H}_{2}\\mathrm{O}$), and nitrogen ($\\mathrm{N}_{2}$), derive a scalar $\\beta$ built from elemental mass fractions that remains unchanged by chemical reaction and varies linearly under mixing of two feed streams (a fuel stream and an oxidizer stream). Use this scalar to construct the Bilger mixture fraction $Z$ as an affine mapping from the scalar in the mixture to its values in the two feed streams, and then obtain the stoichiometric mixture fraction $Z_{st}$ by imposing the condition of exact oxygen balance for complete oxidation.\n\nAssume the following:\n- The elemental mass fractions in any mixture are $Y_{C}$, $Y_{H}$, $Y_{O}$, and $Y_{N}$, defined as the mass of each element divided by the total mass.\n- The atomic weights are $W_{C} = 12.011$, $W_{H} = 1.008$, $W_{O} = 15.999$, and $W_{N} = 14.007$.\n- The fuel stream is pure methane $\\mathrm{CH}_{4}$.\n- The oxidizer stream is dry air with $0.21$ mole fraction of $\\mathrm{O}_{2}$ and $0.79$ mole fraction of $\\mathrm{N}_{2}$.\n\nCompute $Z_{st}$ for methane–air using your constructed scalar and the above data. Express the final mixture fraction as a unitless number and round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of combustion theory, well-posed with sufficient data for a unique solution, and stated using objective, formal language. We may therefore proceed with the derivation and calculation.\n\nThe problem requires the derivation of a conserved scalar, its use in defining the mixture fraction, and the subsequent calculation of the stoichiometric mixture fraction for a methane-air system.\n\nFirst, we derive a conserved scalar $\\beta$. In any closed system undergoing chemical reactions, the total mass of each element is conserved. An elemental mass fraction, $Y_k$, is defined as the mass of element $k$ per unit total mass in a mixture. Since chemical reactions merely rearrange atoms into different molecular species, the total mass of each element remains constant. Consequently, any linear combination of elemental mass fractions is also a conserved quantity. A scalar variable $\\beta$ defined as $\\beta = \\sum_{k} c_k Y_k$, where $c_k$ are constants, will be conserved during chemical reactions. Furthermore, under the mixing of two streams (fuel and oxidizer), the resulting mass fraction of any element is a linear combination of its mass fractions in the parent streams, weighted by the mixture fraction. Therefore, $\\beta$ will also vary linearly with mixing.\n\nTo be useful for describing the stoichiometry of combustion, the constants $c_k$ must be chosen judiciously. We seek a scalar that relates the fuel elements (carbon and hydrogen) to the oxidizer element (oxygen) in a manner that reflects their consumption during complete oxidation. A standard and powerful choice is to define $\\beta$ such that its value is zero for the final products of complete combustion, which are carbon dioxide ($\\mathrm{CO}_{2}$) and water ($\\mathrm{H}_{2}\\mathrm{O}$). Nitrogen ($\\mathrm{N}_{2}$) is treated as an inert diluent.\n\nLet us propose a scalar of the form:\n$$\n\\beta = c_C \\frac{Y_C}{W_C} + c_H \\frac{Y_H}{W_H} + c_O \\frac{Y_O}{W_O}\n$$\nwhere $Y_k$ are the elemental mass fractions of carbon ($C$), hydrogen ($H$), and oxygen ($O$), and $W_k$ are their respective atomic weights. This form uses elemental mole numbers per unit mass. We will determine the coefficients $c_C$, $c_H$, and $c_O$ by enforcing $\\beta=0$ for $\\mathrm{CO}_{2}$ and $\\mathrm{H}_{2}\\mathrm{O}$.\n\nFor a pure sample of $\\mathrm{CO}_{2}$:\nThe molecule consists of one $C$ atom and two $O$ atoms. The elemental mass fractions are $Y_C = \\frac{W_C}{W_C + 2W_O}$ and $Y_O = \\frac{2W_O}{W_C + 2W_O}$. $Y_H=0$.\nSetting $\\beta=0$ for $\\mathrm{CO}_{2}$ yields:\n$$\nc_C \\frac{1}{W_C + 2W_O} + c_O \\frac{2}{W_C + 2W_O} = 0 \\implies c_C + 2c_O = 0\n$$\n\nFor a pure sample of $\\mathrm{H}_{2}\\mathrm{O}$:\nThe molecule consists of two $H$ atoms and one $O$ atom. The elemental mass fractions are $Y_H = \\frac{2W_H}{2W_H + W_O}$ and $Y_O = \\frac{W_O}{2W_H + W_O}$. $Y_C=0$.\nSetting $\\beta=0$ for $\\mathrm{H}_{2}\\mathrm{O}$ yields:\n$$\nc_H \\frac{2}{2W_H + W_O} + c_O \\frac{1}{2W_H + W_O} = 0 \\implies 2c_H + c_O = 0\n$$\n\nWe have a system of two linear equations with three unknowns, so there is one degree of freedom. We can choose a value for one coefficient to fix the others. Let us choose $c_O = -1$.\nFrom $c_C + 2c_O = 0$, we get $c_C = -2c_O = 2$.\nFrom $2c_H + c_O = 0$, we get $c_H = -c_O/2 = 1/2$.\nThus, a valid conserved scalar is:\n$$\n\\beta = 2\\frac{Y_C}{W_C} + \\frac{1}{2}\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O}\n$$\nThis is a specific form of the Bilger coupling function. It is a conserved scalar constructed from elemental mass fractions that has the desired property related to stoichiometry.\n\nNext, we construct the mixture fraction $Z$. The mixture fraction is defined as a normalized variable that linearly maps the conserved scalar $\\beta$ from its value in the oxidizer stream ($\\beta_{ox}$) to its value in the fuel stream ($\\beta_{fuel}$). By convention, $Z=0$ in the oxidizer stream and $Z=1$ in the fuel stream. The affine mapping is:\n$$\nZ = \\frac{\\beta - \\beta_{ox}}{\\beta_{fuel} - \\beta_{ox}}\n$$\n\nThe stoichiometric mixture fraction, $Z_{st}$, corresponds to the specific mixture composition where there is exactly enough oxygen to completely oxidize the fuel to $\\mathrm{CO}_{2}$ and $\\mathrm{H}_{2}\\mathrm{O}$. In such a mixture, the elemental composition is such that after complete reaction, only these products (and inert species like $\\mathrm{N}_{2}$) would remain. By our construction of $\\beta$, its value for this stoichiometric mixture is zero, i.e., $\\beta_{st} = 0$. Substituting this into the definition of $Z$ gives the expression for $Z_{st}$:\n$$\nZ_{st} = \\frac{0 - \\beta_{ox}}{\\beta_{fuel} - \\beta_{ox}} = \\frac{-\\beta_{ox}}{\\beta_{fuel} - \\beta_{ox}}\n$$\n\nTo compute the numerical value of $Z_{st}$ for methane-air combustion, we must first calculate $\\beta_{fuel}$ and $\\beta_{ox}$.\n\nFor the fuel stream (pure methane, $\\mathrm{CH}_{4}$):\nThe molar mass is $W_{CH_4} = W_C + 4W_H$.\nThe elemental mass fractions are $Y_C = \\frac{W_C}{W_{CH_4}}$ and $Y_H = \\frac{4W_H}{W_{CH_4}}$. $Y_O$ and $Y_N$ are zero.\nCalculating $\\beta_{fuel}$:\n$$\n\\beta_{fuel} = 2\\frac{Y_C}{W_C} + \\frac{1}{2}\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O} = 2\\frac{(W_C/W_{CH_4})}{W_C} + \\frac{1}{2}\\frac{(4W_H/W_{CH_4})}{W_H} - 0 = \\frac{2}{W_{CH_4}} + \\frac{2}{W_{CH_4}} = \\frac{4}{W_{CH_4}}\n$$\n\nFor the oxidizer stream (dry air: $0.21$ mole fraction $\\mathrm{O}_{2}$, $0.79$ mole fraction $\\mathrm{N}_{2}$):\nThe average molar mass of air is $W_{air} = 0.21 W_{O_2} + 0.79 W_{N_2} = 0.21(2W_O) + 0.79(2W_N) = 0.42W_O + 1.58W_N$.\nThe elemental mass fraction of oxygen is $Y_O = \\frac{0.21 \\times 2W_O}{W_{air}} = \\frac{0.42W_O}{W_{air}}$. $Y_C$ and $Y_H$ are zero.\nCalculating $\\beta_{ox}$:\n$$\n\\beta_{ox} = 2\\frac{Y_C}{W_C} + \\frac{1}{2}\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O} = 0 + 0 - \\frac{(0.42W_O/W_{air})}{W_O} = -\\frac{0.42}{W_{air}}\n$$\n\nNow, we substitute these expressions for $\\beta_{fuel}$ and $\\beta_{ox}$ into the formula for $Z_{st}$:\n$$\nZ_{st} = \\frac{-(-\\frac{0.42}{W_{air}})}{\\frac{4}{W_{CH_4}} - (-\\frac{0.42}{W_{air}})} = \\frac{\\frac{0.42}{W_{air}}}{\\frac{4}{W_{CH_4}} + \\frac{0.42}{W_{air}}}\n$$\nMultiplying the numerator and denominator by $W_{CH_4}W_{air}$ gives:\n$$\nZ_{st} = \\frac{0.42 W_{CH_4}}{4 W_{air} + 0.42 W_{CH_4}}\n$$\nDividing the numerator and denominator by 2 to simplify:\n$$\nZ_{st} = \\frac{0.21 W_{CH_4}}{2 W_{air} + 0.21 W_{CH_4}}\n$$\nThis expression can also be derived from the stoichiometric air-fuel mass ratio, confirming our derivation.\n\nFinally, we compute the numerical value using the provided atomic weights:\n$W_{C} = 12.011$\n$W_{H} = 1.008$\n$W_{O} = 15.999$\n$W_{N} = 14.007$\n\nMolar mass of methane:\n$W_{CH_4} = W_C + 4W_H = 12.011 + 4(1.008) = 16.043$\n\nMolar mass of air:\n$W_{air} = 0.21(2W_O) + 0.79(2W_N) = 0.21(2 \\times 15.999) + 0.79(2 \\times 14.007) = 0.21(31.998) + 0.79(28.014) = 6.71958 + 22.13106 = 28.85064$\n\nSubstitute these values into the expression for $Z_{st}$:\n$$\nZ_{st} = \\frac{0.21 \\times 16.043}{2 \\times 28.85064 + 0.21 \\times 16.043}\n$$\n$$\nZ_{st} = \\frac{3.36903}{57.70128 + 3.36903} = \\frac{3.36903}{61.07031} \\approx 0.0551664\n$$\nRounding to four significant figures, we get $Z_{st} = 0.05517$.",
            "answer": "$$\n\\boxed{0.05517}\n$$"
        },
        {
            "introduction": "The core of any reacting flow simulation is the accurate calculation of chemical source terms, which govern the rates of species consumption and formation. This practice focuses on the chemical kinetics, guiding you to compute the net production rate of the hydroxyl radical ($\\mathrm{OH}$), a crucial species in combustion chemistry, from a detailed kinetic mechanism . This exercise provides essential experience in translating reaction mechanisms and rate laws into the computational source terms that drive the simulation.",
            "id": "3966554",
            "problem": "You are provided with a scientifically plausible subset of a detailed chemical kinetic mechanism for a hydrogen–air laminar premixed flame focused on the hydroxyl radical species. Your task is to compute the net molar production rate of hydroxyl radical at the location of peak temperature for specified local thermochemical states and to identify the reactions that most strongly control hydroxyl radical production there. The computation must be done by starting from fundamental laws and well-tested formulas, without shortcut relations.\n\nFundamental base to use:\nBegin from species conservation and the law of mass action for elementary reactions, together with the Arrhenius rate expression. Use the International System of Units (SI). Specifically, use the ideal-gas definition of molar concentration as the product of mole fraction and pressure divided by the universal gas constant times temperature. Use reversible elementary reaction steps with separate forward and reverse Arrhenius parameters provided below.\n\nMechanism definition:\nConsider the following eight species: hydrogen ($\\mathrm{H_2}$), oxygen ($\\mathrm{O_2}$), nitrogen ($\\mathrm{N_2}$), water ($\\mathrm{H_2O}$), hydroxyl ($\\mathrm{OH}$), oxygen atom ($\\mathrm{O}$), hydrogen atom ($\\mathrm{H}$), and hydroperoxyl ($\\mathrm{HO_2}$). The following six elementary reversible reactions are to be used:\n\nReaction $\\#1$: $\\mathrm{H} + \\mathrm{O_2} \\rightleftharpoons \\mathrm{O} + \\mathrm{OH}$ with forward Arrhenius parameters $A_f = 3.55\\times10^{7}$, $n_f = -0.70$, $E_{a,f} = 7.12\\times10^{4}\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 1.20\\times10^{7}$, $n_r = -0.70$, $E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$.\n\nReaction $\\#2$: $\\mathrm{O} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{OH}$ with forward Arrhenius parameters $A_f = 1.80\\times10^{6}$, $n_f = 1.00$, $E_{a,f} = 3.16\\times10^{4}\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 7.00\\times10^{5}$, $n_r = 1.00$, $E_{a,r} = 0\\,\\mathrm{J/mol}$.\n\nReaction $\\#3$: $\\mathrm{OH} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{H_2O}$ with forward Arrhenius parameters $A_f = 2.10\\times10^{6}$, $n_f = 1.50$, $E_{a,f} = 2.10\\times10^{3}\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 1.00\\times10^{6}$, $n_r = 1.50$, $E_{a,r} = 3.00\\times10^{4}\\,\\mathrm{J/mol}$.\n\nReaction $\\#4$: $\\mathrm{HO_2} + \\mathrm{H} \\rightleftharpoons \\mathrm{OH} + \\mathrm{OH}$ with forward Arrhenius parameters $A_f = 1.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 2.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$. Note that this reaction produces two hydroxyl radicals on the forward step.\n\nReaction $\\#5$: $\\mathrm{HO_2} + \\mathrm{O} \\rightleftharpoons \\mathrm{OH} + \\mathrm{O_2}$ with forward Arrhenius parameters $A_f = 1.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 1.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 1.80\\times10^{4}\\,\\mathrm{J/mol}$.\n\nReaction $\\#6$: $\\mathrm{HO_2} + \\mathrm{OH} \\rightleftharpoons \\mathrm{H_2O} + \\mathrm{O_2}$ with forward Arrhenius parameters $A_f = 2.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 2.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 5.00\\times10^{3}\\,\\mathrm{J/mol}$.\n\nRate definitions:\nFor each reaction $j$, the forward rate constant is $k_{f,j} = A_{f,j}\\,T^{n_{f,j}}\\exp\\!\\left(-E_{a,f,j}/(R\\,T)\\right)$ and the reverse rate constant is $k_{r,j} = A_{r,j}\\,T^{n_{r,j}}\\exp\\!\\left(-E_{a,r,j}/(R\\,T)\\right)$, where $R$ is the universal gas constant. For law of mass action, the forward rate of progress is the product of the forward rate constant and the product of reactant molar concentrations raised to their stoichiometric powers, and similarly for the reverse direction with product molar concentrations.\n\nThermochemical state and data:\nAssume ideal-gas behavior. For a given pressure $p$ and temperature $T$, the molar concentration of species $i$ is $c_i = X_i\\,p/(R\\,T)$, where $X_i$ is the mole fraction of species $i$. In the test suite below, mole fractions are provided for all species except $\\mathrm{N_2}$, and you must compute $X_{\\mathrm{N_2}}$ by difference to satisfy $\\sum_i X_i = 1$. The universal gas constant is $R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$.\n\nTarget quantity:\nCompute the net molar production rate of hydroxyl radical, $\\omega_{\\mathrm{OH}}$, defined as the stoichiometric sum over reactions of the net reaction rates of progress multiplied by the hydroxyl stoichiometric coefficient difference (products minus reactants) for each reaction. The unit of $\\omega_{\\mathrm{OH}}$ must be reported in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$.\n\nInterpretation task:\nFor each state, identify the three reactions that most strongly control hydroxyl radical production, defined as those with largest absolute contribution to $\\omega_{\\mathrm{OH}}$ when decomposed reaction-wise. Report the indices of these controlling reactions using $1$-based indexing corresponding to the reaction numbering above.\n\nTest suite:\nUse the following three test cases representative of peak-temperature locations in a hydrogen–air laminar premixed flame:\n\nCase $1$ (stoichiometric-like peak temperature): $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.400\\times10^{3}\\,\\mathrm{K}$, mole fractions excluding $\\mathrm{N_2}$ are $X_{\\mathrm{H_2O}} = 3.50\\times10^{-1}$, $X_{\\mathrm{OH}} = 1.00\\times10^{-3}$, $X_{\\mathrm{O}} = 5.00\\times10^{-4}$, $X_{\\mathrm{H}} = 2.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$.\n\nCase $2$ (lean-like peak temperature): $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.000\\times10^{3}\\,\\mathrm{K}$, mole fractions excluding $\\mathrm{N_2}$ are $X_{\\mathrm{H_2O}} = 2.50\\times10^{-1}$, $X_{\\mathrm{OH}} = 6.00\\times10^{-4}$, $X_{\\mathrm{O}} = 2.00\\times10^{-4}$, $X_{\\mathrm{H}} = 1.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 1.00\\times10^{-2}$, $X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$.\n\nCase $3$ (rich-like peak temperature): $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.100\\times10^{3}\\,\\mathrm{K}$, mole fractions excluding $\\mathrm{N_2}$ are $X_{\\mathrm{H_2O}} = 2.80\\times10^{-1}$, $X_{\\mathrm{OH}} = 8.00\\times10^{-4}$, $X_{\\mathrm{O}} = 1.00\\times10^{-4}$, $X_{\\mathrm{H}} = 4.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 5.00\\times10^{-7}$, $X_{\\mathrm{H_2}} = 2.00\\times10^{-2}$, $X_{\\mathrm{HO_2}} = 2.00\\times10^{-7}$.\n\nRequired output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is an inner list of the form $[\\omega_{\\mathrm{OH}}, i_1, i_2, i_3]$ with $\\omega_{\\mathrm{OH}}$ in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$ and $i_1$, $i_2$, $i_3$ the indices of the three most controlling reactions by absolute contribution. As an example of the structure, the output should look like $[[\\omega_1,i_{1,1},i_{1,2},i_{1,3}],[\\omega_2,i_{2,1},i_{2,2},i_{2,3}],[\\omega_3,i_{3,1},i_{3,2},i_{3,3}]]$.",
            "solution": "The user has provided a problem in the domain of chemical kinetics, specifically focused on calculating reaction rates in a high-temperature gaseous system. The problem is to be validated for scientific soundness and completeness before a solution is attempted.\n\n### Step 1: Problem Validation\n\nFollowing the prescribed protocol, the first step is to extract all given information verbatim from the problem statement.\n\n**Extraction of Givens:**\n\n*   **System:** A hydrogen–air laminar premixed flame.\n*   **Target Species:** Hydroxyl radical ($\\mathrm{OH}$).\n*   **Fundamental Laws:** Species conservation, law of mass action, Arrhenius rate expression.\n*   **Assumptions:** Ideal-gas behavior.\n*   **Species List:** Hydrogen ($\\mathrm{H_2}$), Oxygen ($\\mathrm{O_2}$), Nitrogen ($\\mathrm{N_2}$), Water ($\\mathrm{H_2O}$), Hydroxyl ($\\mathrm{OH}$), Oxygen atom ($\\mathrm{O}$), Hydrogen atom ($\\mathrm{H}$), and Hydroperoxyl ($\\mathrm{HO_2}$).\n*   **Universal Gas Constant:** $R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$.\n*   **Reaction Mechanism (6 reversible reactions):**\n    1.  $\\mathrm{H} + \\mathrm{O_2} \\rightleftharpoons \\mathrm{O} + \\mathrm{OH}$: $A_f = 3.55\\times10^{7}$, $n_f = -0.70$, $E_{a,f} = 7.12\\times10^{4}\\,\\mathrm{J/mol}$; $A_r = 1.20\\times10^{7}$, $n_r = -0.70$, $E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$.\n    2.  $\\mathrm{O} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{OH}$: $A_f = 1.80\\times10^{6}$, $n_f = 1.00$, $E_{a,f} = 3.16\\times10^{4}\\,\\mathrm{J/mol}$; $A_r = 7.00\\times10^{5}$, $n_r = 1.00$, $E_{a,r} = 0\\,\\mathrm{J/mol}$.\n    3.  $\\mathrm{OH} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{H_2O}$: $A_f = 2.10\\times10^{6}$, $n_f = 1.50$, $E_{a,f} = 2.10\\times10^{3}\\,\\mathrm{J/mol}$; $A_r = 1.00\\times10^{6}$, $n_r = 1.50$, $E_{a,r} = 3.00\\times10^{4}\\,\\mathrm{J/mol}$.\n    4.  $\\mathrm{HO_2} + \\mathrm{H} \\rightleftharpoons \\mathrm{OH} + \\mathrm{OH}$: $A_f = 1.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$; $A_r = 2.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$.\n    5.  $\\mathrm{HO_2} + \\mathrm{O} \\rightleftharpoons \\mathrm{OH} + \\mathrm{O_2}$: $A_f = 1.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$; $A_r = 1.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 1.80\\times10^{4}\\,\\mathrm{J/mol}$.\n    6.  $\\mathrm{HO_2} + \\mathrm{OH} \\rightleftharpoons \\mathrm{H_2O} + \\mathrm{O_2}$: $A_f = 2.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$; $A_r = 2.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 5.00\\times10^{3}\\,\\mathrm{J/mol}$.\n*   **Governing Equations:**\n    *   Forward rate constant: $k_{f,j} = A_{f,j}\\,T^{n_{f,j}}\\exp\\!\\left(-E_{a,f,j}/(R\\,T)\\right)$.\n    *   Reverse rate constant: $k_{r,j} = A_{r,j}\\,T^{n_{r,j}}\\exp\\!\\left(-E_{a,r,j}/(R\\,T)\\right)$.\n    *   Molar concentration: $c_i = X_i\\,p/(R\\,T)$.\n    *   Mole fraction sum: $\\sum_i X_i = 1$.\n*   **Target Quantities:**\n    *   Net molar production rate of hydroxyl radical, $\\omega_{\\mathrm{OH}}$ in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$.\n    *   Indices of the three reactions with the largest absolute contribution to $\\omega_{\\mathrm{OH}}$.\n*   **Test Cases:**\n    *   Case 1: $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.400\\times10^{3}\\,\\mathrm{K}$, $X_{\\mathrm{H_2O}} = 3.50\\times10^{-1}$, $X_{\\mathrm{OH}} = 1.00\\times10^{-3}$, $X_{\\mathrm{O}} = 5.00\\times10^{-4}$, $X_{\\mathrm{H}} = 2.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$.\n    *   Case 2: $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.000\\times10^{3}\\,\\mathrm{K}$, $X_{\\mathrm{H_2O}} = 2.50\\times10^{-1}$, $X_{\\mathrm{OH}} = 6.00\\times10^{-4}$, $X_{\\mathrm{O}} = 2.00\\times10^{-4}$, $X_{\\mathrm{H}} = 1.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 1.00\\times10^{-2}$, $X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$.\n    *   Case 3: $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.100\\times10^{3}\\,\\mathrm{K}$, $X_{\\mathrm{H_2O}} = 2.80\\times10^{-1}$, $X_{\\mathrm{OH}} = 8.00\\times10^{-4}$, $X_{\\mathrm{O}} = 1.00\\times10^{-4}$, $X_{\\mathrm{H}} = 4.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 5.00\\times10^{-7}$, $X_{\\mathrm{H_2}} = 2.00\\times10^{-2}$, $X_{\\mathrm{HO_2}} = 2.00\\times10^{-7}$.\n\n### Step 2: Validation of Extracted Givens\n\nThe problem is evaluated against the established criteria.\n\n*   **Scientifically Grounded:** The problem is firmly rooted in the principles of chemical kinetics and combustion theory. It uses the law of mass action and the Arrhenius equation, which are foundational concepts. The chemical mechanism is a well-established subset for hydrogen combustion. All data are physically plausible.\n*   **Well-Posed:** All necessary inputs are provided: pressure, temperature, mole fractions for all reactive species, and all parameters for the reaction rate constants. The objective is clearly defined and computationally achievable. A unique solution exists for each test case.\n*   **Objective:** The problem is stated in precise, quantitative, and unbiased language.\n*   **Completeness and Consistency:** The problem is self-contained. The instruction to compute the mole fraction of the inert species $\\mathrm{N_2}$ by difference ensures that the mole fractions sum to unity, rendering the thermochemical state fully defined. The sum of the provided mole fractions in each case is less than $1$, making the calculation of a positive $X_{\\mathrm{N_2}}$ possible. The units are specified as SI, and the provided Arrhenius parameters, while not having explicitly stated units, are numerically consistent with standard SI-based formulations (e.g., $A$ for a bimolecular reaction in $\\mathrm{m^3 mol^{-1} s^{-1} K^{-n}}$) to yield the target quantity in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is scientifically sound, well-posed, and contains all necessary information for a unique solution. Therefore, I will proceed to derive and present the solution.\n\n---\n\n### Solution Derivation\n\nThe objective is to compute the net molar production rate of the hydroxyl radical, $\\omega_{\\mathrm{OH}}$, and identify the most influential reactions for three given thermochemical states.\n\n**1. Fundamental Principles**\n\nFor a spatially homogeneous system (as assumed at a specific location in the flame), the rate of change of the molar concentration of a species $i$, $c_i$, is governed by its net rate of chemical production, $\\omega_i$.\n$$\n\\frac{dc_i}{dt} = \\omega_i\n$$\nThe net production rate $\\omega_i$ is the sum of its production rates over all elementary reactions in the mechanism. For a set of $N_{rxn}$ reactions, this is expressed as:\n$$\n\\omega_i = \\sum_{j=1}^{N_{rxn}} \\Delta\\nu_{ij} q_j\n$$\nwhere $\\Delta\\nu_{ij} = (\\nu''_{ij} - \\nu'_{ij})$ is the net stoichiometric coefficient of species $i$ in reaction $j$ ($\\nu''_{ij}$ for products, $\\nu'_{ij}$ for reactants), and $q_j$ is the net rate of progress for reaction $j$.\n\nThe net rate of progress, $q_j$, is the difference between its forward ($q_{f,j}$) and reverse ($q_{r,j}$) rates:\n$$\nq_j = q_{f,j} - q_{r,j}\n$$\nAccording to the law of mass action for an elementary reaction $j$, these rates are given by:\n$$\nq_{f,j} = k_{f,j} \\prod_{k=1}^{N_{species}} c_k^{\\nu'_{kj}} \\quad \\text{and} \\quad q_{r,j} = k_{r,j} \\prod_{k=1}^{N_{species}} c_k^{\\nu''_{kj}}\n$$\nwhere $k_{f,j}$ and $k_{r,j}$ are the forward and reverse rate constants, and $c_k$ is the molar concentration of species $k$.\n\nThe rate constants are described by the generalized Arrhenius equation:\n$$\nk_j(T) = A_j T^{n_j} \\exp\\left(-\\frac{E_{a,j}}{RT}\\right)\n$$\nwhere $A_j$ is the pre-exponential factor, $n_j$ is the temperature exponent, $E_{a,j}$ is the activation energy, $T$ is the absolute temperature, and $R$ is the universal gas constant.\n\nFinally, under the ideal gas assumption, the molar concentration $c_i$ of species $i$ is related to its mole fraction $X_i$, the system pressure $p$, and temperature $T$ by:\n$$\nc_i = \\frac{X_i p}{RT}\n$$\n\n**2. Application to Hydroxyl Radical ($\\mathrm{OH}$)**\n\nWe must determine the net stoichiometric coefficient, $\\Delta\\nu_{\\mathrm{OH},j}$, for $\\mathrm{OH}$ in each of the six specified reactions.\n\n*   Reaction $1$: $\\mathrm{H} + \\mathrm{O_2} \\rightleftharpoons \\mathrm{O} + \\mathrm{OH}$. $\\nu'_{\\mathrm{OH},1} = 0$, $\\nu''_{\\mathrm{OH},1} = 1 \\implies \\Delta\\nu_{\\mathrm{OH},1} = 1$.\n*   Reaction $2$: $\\mathrm{O} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{OH}$. $\\nu'_{\\mathrm{OH},2} = 0$, $\\nu''_{\\mathrm{OH},2} = 1 \\implies \\Delta\\nu_{\\mathrm{OH},2} = 1$.\n*   Reaction $3$: $\\mathrm{OH} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{H_2O}$. $\\nu'_{\\mathrm{OH},3} = 1$, $\\nu''_{\\mathrm{OH},3} = 0 \\implies \\Delta\\nu_{\\mathrm{OH},3} = -1$.\n*   Reaction $4$: $\\mathrm{HO_2} + \\mathrm{H} \\rightleftharpoons \\mathrm{OH} + \\mathrm{OH}$. $\\nu'_{\\mathrm{OH},4} = 0$, $\\nu''_{\\mathrm{OH},4} = 2 \\implies \\Delta\\nu_{\\mathrm{OH},4} = 2$.\n*   Reaction $5$: $\\mathrm{HO_2} + \\mathrm{O} \\rightleftharpoons \\mathrm{OH} + \\mathrm{O_2}$. $\\nu'_{\\mathrm{OH},5} = 0$, $\\nu''_{\\mathrm{OH},5} = 1 \\implies \\Delta\\nu_{\\mathrm{OH},5} = 1$.\n*   Reaction $6$: $\\mathrm{HO_2} + \\mathrm{OH} \\rightleftharpoons \\mathrm{H_2O} + \\mathrm{O_2}$. $\\nu'_{\\mathrm{OH},6} = 1$, $\\nu''_{\\mathrm{OH},6} = 0 \\implies \\Delta\\nu_{\\mathrm{OH},6} = -1$.\n\nThe rates of progress $q_j$ are:\n$q_1 = k_{f,1} c_{\\mathrm{H}} c_{\\mathrm{O_2}} - k_{r,1} c_{\\mathrm{O}} c_{\\mathrm{OH}}$\n$q_2 = k_{f,2} c_{\\mathrm{O}} c_{\\mathrm{H_2}} - k_{r,2} c_{\\mathrm{H}} c_{\\mathrm{OH}}$\n$q_3 = k_{f,3} c_{\\mathrm{OH}} c_{\\mathrm{H_2}} - k_{r,3} c_{\\mathrm{H}} c_{\\mathrm{H_2O}}$\n$q_4 = k_{f,4} c_{\\mathrm{HO_2}} c_{\\mathrm{H}} - k_{r,4} c_{\\mathrm{OH}}^2$\n$q_5 = k_{f,5} c_{\\mathrm{HO_2}} c_{\\mathrm{O}} - k_{r,5} c_{\\mathrm{OH}} c_{\\mathrm{O_2}}$\n$q_6 = k_{f,6} c_{\\mathrm{HO_2}} c_{\\mathrm{OH}} - k_{r,6} c_{\\mathrm{H_2O}} c_{\\mathrm{O_2}}$\n\nThe net production rate of $\\mathrm{OH}$ is the sum of the contributions from each reaction, $\\omega_{\\mathrm{OH}, j} = \\Delta\\nu_{\\mathrm{OH},j} q_j$:\n$$\n\\omega_{\\mathrm{OH}} = \\sum_{j=1}^{6} \\omega_{\\mathrm{OH}, j} = q_1 + q_2 - q_3 + 2q_4 + q_5 - q_6\n$$\n\n**3. Computational Algorithm**\n\nFor each test case specified by $(p, T, \\{X_i\\}_{i\\neq \\mathrm{N_2}})$:\n1.  Calculate the mole fraction of nitrogen: $X_{\\mathrm{N_2}} = 1 - \\sum_{i \\in \\{\\mathrm{H_2}, \\mathrm{O_2}, ...\\}} X_i$.\n2.  Calculate the molar concentration for each of the $8$ species using $c_i = X_i p / (RT)$.\n3.  For each of the $6$ reactions:\n    a. Compute the forward rate constant $k_{f,j}$ and reverse rate constant $k_{r,j}$ using the Arrhenius formula and the given parameters.\n    b. Compute the forward rate of progress $q_{f,j}$ and reverse rate of progress $q_{r,j}$ using the law of mass action and the calculated concentrations.\n    c. Compute the net rate of progress $q_j = q_{f,j} - q_{r,j}$.\n4.  Calculate the contribution of each reaction to the net production of $\\mathrm{OH}$: $\\omega_{\\mathrm{OH},j} = \\Delta\\nu_{\\mathrm{OH},j} q_j$.\n5.  Sum these contributions to obtain the total net production rate: $\\omega_{\\mathrm{OH}} = \\sum_{j=1}^{6} \\omega_{\\mathrm{OH},j}$.\n6.  To identify the controlling reactions, calculate the absolute value of each contribution, $|\\omega_{\\mathrm{OH},j}|$.\n7.  Sort these absolute contributions in descending order and identify the corresponding reaction indices ($1$-based). The top three are the most controlling reactions.\n8.  Format the results as required: $[\\omega_{\\mathrm{OH}}, i_1, i_2, i_3]$.\n\nThis procedure provides a rigorous and complete path to the solution based on the provided data and fundamental principles. The following code implements this algorithm.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the net molar production rate of the hydroxyl radical (OH)\n    and identifies the controlling reactions for given thermochemical states\n    in a hydrogen-air flame.\n    \"\"\"\n    # Universal Gas Constant in SI units: J/(mol.K)\n    R = 8.314462618\n\n    # Species list in the order they are typically handled\n    species_map = {\n        'H2': 0, 'O2': 1, 'H2O': 2, 'OH': 3, 'O': 4,\n        'H': 5, 'HO2': 6, 'N2': 7\n    }\n\n    # Reaction mechanism data.\n    # A_f/A_r units are m^3/mol/s for bimolecular rxns (adjusted for T^n).\n    # E_a units are J/mol.\n    reactions = [\n        # R1: H + O2 => O + OH\n        {'reactants': {'H': 1, 'O2': 1}, 'products': {'O': 1, 'OH': 1},\n         'f': {'A': 3.55e7, 'n': -0.70, 'Ea': 7.12e4},\n         'r': {'A': 1.20e7, 'n': -0.70, 'Ea': 2.00e4}},\n        # R2: O + H2 => H + OH\n        {'reactants': {'O': 1, 'H2': 1}, 'products': {'H': 1, 'OH': 1},\n         'f': {'A': 1.80e6, 'n': 1.00, 'Ea': 3.16e4},\n         'r': {'A': 7.00e5, 'n': 1.00, 'Ea': 0.0}},\n        # R3: OH + H2 => H + H2O\n        {'reactants': {'OH': 1, 'H2': 1}, 'products': {'H': 1, 'H2O': 1},\n         'f': {'A': 2.10e6, 'n': 1.50, 'Ea': 2.10e3},\n         'r': {'A': 1.00e6, 'n': 1.50, 'Ea': 3.00e4}},\n        # R4: HO2 + H => OH + OH\n        {'reactants': {'HO2': 1, 'H': 1}, 'products': {'OH': 2},\n         'f': {'A': 1.00e6, 'n': 0.00, 'Ea': 0.0},\n         'r': {'A': 2.00e6, 'n': 0.00, 'Ea': 2.00e4}},\n        # R5: HO2 + O => OH + O2\n        {'reactants': {'HO2': 1, 'O': 1}, 'products': {'OH': 1, 'O2': 1},\n         'f': {'A': 1.00e6, 'n': 0.00, 'Ea': 0.0},\n         'r': {'A': 1.00e6, 'n': 0.00, 'Ea': 1.80e4}},\n        # R6: HO2 + OH => H2O + O2\n        {'reactants': {'HO2': 1, 'OH': 1}, 'products': {'H2O': 1, 'O2': 1},\n         'f': {'A': 2.00e6, 'n': 0.00, 'Ea': 0.0},\n         'r': {'A': 2.00e6, 'n': 0.00, 'Ea': 5.00e3}},\n    ]\n\n    # Pre-calculate stoichiometric coefficients for OH for each reaction\n    nu_OH = np.array([\n        rx['products'].get('OH', 0) - rx['reactants'].get('OH', 0) for rx in reactions\n    ])\n\n    test_cases = [\n        # Case 1 (stoichiometric-like)\n        {'p': 1.01325e5, 'T': 2.400e3,\n         'X': {'H2O': 3.50e-1, 'OH': 1.00e-3, 'O': 5.00e-4, 'H': 2.00e-4,\n               'O2': 1.00e-6, 'H2': 1.00e-6, 'HO2': 1.00e-7}},\n        # Case 2 (lean-like)\n        {'p': 1.01325e5, 'T': 2.000e3,\n         'X': {'H2O': 2.50e-1, 'OH': 6.00e-4, 'O': 2.00e-4, 'H': 1.00e-4,\n               'O2': 1.00e-2, 'H2': 1.00e-6, 'HO2': 1.00e-7}},\n        # Case 3 (rich-like)\n        {'p': 1.01325e5, 'T': 2.100e3,\n         'X': {'H2O': 2.80e-1, 'OH': 8.00e-4, 'O': 1.00e-4, 'H': 4.00e-4,\n               'O2': 5.00e-7, 'H2': 2.00e-2, 'HO2': 2.00e-7}},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        p, T, X_in = case['p'], case['T'], case['X']\n        \n        # Complete mole fractions\n        X = X_in.copy()\n        X_sum = sum(X.values())\n        if X_sum >= 1.0:\n            raise ValueError(\"Sum of mole fractions is >= 1\")\n        X['N2'] = 1.0 - X_sum\n\n        # Calculate molar concentrations (mol/m^3)\n        p_over_RT = p / (R * T)\n        c = {name: val * p_over_RT for name, val in X.items()}\n\n        q = np.zeros(len(reactions))\n        \n        for j, rx in enumerate(reactions):\n            # Forward rate\n            kf_params = rx['f']\n            kf = kf_params['A'] * (T ** kf_params['n']) * np.exp(-kf_params['Ea'] / (R * T))\n            \n            qf_conc_prod = 1.0\n            for species, stoich in rx['reactants'].items():\n                qf_conc_prod *= c[species] ** stoich\n            qf = kf * qf_conc_prod\n\n            # Reverse rate\n            kr_params = rx['r']\n            kr = kr_params['A'] * (T ** kr_params['n']) * np.exp(-kr_params['Ea'] / (R * T))\n            \n            qr_conc_prod = 1.0\n            for species, stoich in rx['products'].items():\n                qr_conc_prod *= c[species] ** stoich\n            qr = kr * qr_conc_prod\n\n            # Net rate of progress for reaction j\n            q[j] = qf - qr\n            \n        # Reaction-wise production rate of OH (mol/m^3/s)\n        omega_OH_j = nu_OH * q\n        \n        # Total net production rate of OH\n        omega_OH_total = np.sum(omega_OH_j)\n        \n        # Identify controlling reactions (1-based index)\n        # Sort by absolute contribution in descending order\n        controlling_rxn_indices = np.argsort(np.abs(omega_OH_j))[::-1]\n        top_3_indices = (controlling_rxn_indices[:3] + 1).tolist()\n        \n        all_results.append([omega_OH_total, *top_3_indices])\n\n    # Format output as specified\n    result_str_list = [str( res ).replace(\" \", \"\") for res in all_results]\n    print(f\"[{','.join(result_str_list)}]\")\n\n\nsolve()\n```"
        },
        {
            "introduction": "A computational result is only trustworthy if it can be shown to be independent of the numerical grid on which it was computed. This practice introduces the essential technique of grid convergence analysis using Richardson extrapolation, a cornerstone of numerical verification . By systematically refining the grid and analyzing the solution's behavior, you will learn to estimate the formal order of accuracy of your numerical scheme and compute a more reliable, grid-converged result.",
            "id": "3966547",
            "problem": "You are tasked with performing a grid convergence study using Richardson extrapolation for the laminar burning velocity and for one-dimensional temperature profiles in the context of laminar premixed flame simulation within computational thermal engineering. The objective is to estimate the order of accuracy of the spatial discretization and compute extrapolated continuum-limit predictions. The analysis must be formulated purely in mathematical terms and implemented algorithmically.\n\nStart from the asymptotic truncation error model for a numerically computed quantity, derived from consistent spatial discretizations of conservation laws of mass, species, and energy for reacting flows: the computed quantity at grid spacing $h$ satisfies\n$$\nU_h \\;=\\; U^\\star + C\\,h^p + \\mathcal{O}(h^{p+1}),\n$$\nwhere $U^\\star$ is the continuum (exact-grid) solution, $C$ is a constant independent of $h$, and $p$ is the order of accuracy of the discretization. When two successively refined grid solutions with refinement ratio $r > 1$ are available, differences scale predictably with $h^p$. This relationship enables estimation of $p$ and $U^\\star$ from triplets of solutions at $h$, $h/r$, and $h/r^2$ without knowledge of $U^\\star$.\n\nYou must implement a program that:\n- Estimates the order of accuracy $p$ for the laminar burning velocity $S_L$ using three grid solutions.\n- Performs a pointwise alignment of temperature profiles across grids, estimates a global order of accuracy $p$ for the temperature field, and computes the Richardson-extrapolated temperature profile at the finest grid’s nodes.\n- Reports, for each test case, the estimated $p$ for $S_L$, the extrapolated $S_L$ in $\\mathrm{m/s}$, the estimated global $p$ for the temperature profile, and the extrapolated peak temperature in $\\mathrm{K}$.\n\nTo make the test well-defined and reproducible and to avoid dependency on external solvers, use the following physically plausible surrogate steady premixed flame temperature profile and synthetic numerical error model. For a one-dimensional domain $x \\in [0,L]$, the exact temperature field is modeled as\n$$\nT_{\\mathrm{exact}}(x) \\;=\\; T_u \\;+\\; \\left(T_b - T_u\\right)\\,\\frac{1}{2}\\left[1 + \\tanh\\!\\left(\\frac{x - x_f}{\\delta}\\right)\\right],\n$$\nwhere $T_u$ is the unburned temperature, $T_b$ is the burned temperature, $x_f$ is the nominal flame location, and $\\delta$ is the thermal thickness. The synthetic numerical temperature at grid spacing $h$ is defined by\n$$\nT_h(x_i) \\;=\\; T_{\\mathrm{exact}}(x_i) \\;+\\; C_T\\,h^{p_{\\mathrm{true}}}\\,\\phi(x_i), \\quad \\phi(x) = \\sin\\!\\left(\\frac{3\\pi x}{L}\\right),\n$$\nevaluated at uniform grid nodes $x_i = i\\,h$ for integer $i$ such that $x_i \\in [0,L]$. The synthetic laminar burning velocity at grid spacing $h$ is\n$$\nS_L(h) \\;=\\; S_L^{\\mathrm{exact}} \\;+\\; C_S\\,h^{p_{\\mathrm{true}}},\n$$\nwith $S_L^{\\mathrm{exact}}$ the continuum-limit laminar burning velocity. The value $p_{\\mathrm{true}}$ is used solely to synthesize data and is not to be used by your estimation algorithm.\n\nYour program must construct data for three grid levels with spacings $h_0$, $h_1 = h_0/r$, and $h_2 = h_0/r^2$ and then:\n- Estimate $p$ for $S_L$ using the three synthetic $S_L(h)$ values at $h_0$, $h_1$, $h_2$ and a single refinement ratio $r$.\n- Align the temperature fields on the finest grid nodes (by interpolation of coarser-grid temperature arrays), compute the global temperature order $p$ from the norms of successive differences, and perform Richardson extrapolation to predict the continuum-limit temperature field on the finest grid nodes. Finally, extract the peak temperature (maximum) of the extrapolated profile.\n\nExpress $S_L$ in $\\mathrm{m/s}$ and temperature in $\\mathrm{K}$. Angles (none used) need no specification. No percentages appear in the output. The outputs are numeric floats.\n\nTest suite and parameters:\n- Case $1$ (happy path, clear refinement):\n  - $L = 0.01$ $\\mathrm{m}$, $\\delta = 0.0005$ $\\mathrm{m}$, $x_f = 0.004$ $\\mathrm{m}$.\n  - $T_u = 300$ $\\mathrm{K}$, $T_b = 2100$ $\\mathrm{K}$.\n  - $S_L^{\\mathrm{exact}} = 0.40$ $\\mathrm{m/s}$.\n  - $h_0 = 2.0\\times 10^{-4}$ $\\mathrm{m}$, $r = 2.0$.\n  - $p_{\\mathrm{true}} = 2.1$, $C_T = 400$ (units chosen so $C_T\\,h^{p_{\\mathrm{true}}}$ yields $\\mathrm{K}$), $C_S = 0.08$ (units chosen so $C_S\\,h^{p_{\\mathrm{true}}}$ yields $\\mathrm{m/s}$).\n- Case $2$ (moderate refinement ratio, lower order):\n  - $L = 0.015$ $\\mathrm{m}$, $\\delta = 0.0008$ $\\mathrm{m}$, $x_f = 0.006$ $\\mathrm{m}$.\n  - $T_u = 320$ $\\mathrm{K}$, $T_b = 2200$ $\\mathrm{K}$.\n  - $S_L^{\\mathrm{exact}} = 0.55$ $\\mathrm{m/s}$.\n  - $h_0 = 1.5\\times 10^{-4}$ $\\mathrm{m}$, $r = 1.5$.\n  - $p_{\\mathrm{true}} = 1.8$, $C_T = 300$, $C_S = 0.05$.\n- Case $3$ (edge case with small error amplitude):\n  - $L = 0.012$ $\\mathrm{m}$, $\\delta = 0.0006$ $\\mathrm{m}$, $x_f = 0.0055$ $\\mathrm{m}$.\n  - $T_u = 290$ $\\mathrm{K}$, $T_b = 2000$ $\\mathrm{K}$.\n  - $S_L^{\\mathrm{exact}} = 0.48$ $\\mathrm{m/s}$.\n  - $h_0 = 2.4\\times 10^{-4}$ $\\mathrm{m}$, $r = 2.0$.\n  - $p_{\\mathrm{true}} = 2.0$, $C_T = 100$, $C_S = 0.02$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the exact following order:\n- Case $1$: $p$ estimate for $S_L$ (unitless), extrapolated $S_L$ in $\\mathrm{m/s}$, global $p$ estimate for temperature (unitless), extrapolated peak temperature in $\\mathrm{K}$.\n- Case $2$: same four quantities in the same order.\n- Case $3$: same four quantities in the same order.\n\nThus, the output must be a single line of the form\n$$\n[\\text{p\\_SL\\_1},\\text{SL\\_inf\\_1},\\text{p\\_T\\_1},\\text{T\\_peak\\_inf\\_1},\\text{p\\_SL\\_2},\\text{SL\\_inf\\_2},\\text{p\\_T\\_2},\\text{T\\_peak\\_inf\\_2},\\text{p\\_SL\\_3},\\text{SL\\_inf\\_3},\\text{p\\_T\\_3},\\text{T\\_peak\\_inf\\_3}],\n$$\nwith all entries as decimal floats.",
            "solution": "The problem requires the implementation of Richardson extrapolation to perform a grid convergence study for two quantities derived from a laminar premixed flame simulation: the scalar laminar burning velocity, $S_L$, and the one-dimensional temperature field, $T(x)$. The analysis is based on the asymptotic error model for a computed quantity $U_h$ on a grid with characteristic spacing $h$:\n$$\nU_h = U^\\star + C h^p + \\mathcal{O}(h^{p+1})\n$$\nwhere $U^\\star$ is the exact continuum solution, $C$ is a constant, and $p$ is the formal order of accuracy of the numerical method. We are provided with three solutions on successively refined grids with spacings $h_0$, $h_1 = h_0/r$, and $h_2 = h_0/r^2$, where $r > 1$ is the refinement ratio.\n\n**Methodology for Scalar Quantities (Laminar Burning Velocity $S_L$)**\n\nFor a scalar quantity like the laminar burning velocity, $S_L$, we denote the numerical solutions on the three grids as $S_{L,0}$, $S_{L,1}$, and $S_{L,2}$ corresponding to grid spacings $h_0$, $h_1$, and $h_2$. Neglecting the higher-order terms, we have the system of equations:\n$$\nS_{L,0} \\approx S_L^\\star + C_S h_0^p \\\\\nS_{L,1} \\approx S_L^\\star + C_S h_1^p = S_L^\\star + C_S (h_0/r)^p \\\\\nS_{L,2} \\approx S_L^\\star + C_S h_2^p = S_L^\\star + C_S (h_0/r^2)^p\n$$\nTo estimate the order of accuracy $p$, we compute the differences between successive solutions:\n$$\n\\epsilon_{01} = S_{L,0} - S_{L,1} \\approx C_S h_0^p (1 - 1/r^p) \\\\\n\\epsilon_{12} = S_{L,1} - S_{L,2} \\approx C_S (h_0/r)^p (1 - 1/r^p)\n$$\nThe ratio of these differences isolates the term $r^p$:\n$$\n\\frac{\\epsilon_{01}}{\\epsilon_{12}} = \\frac{S_{L,0} - S_{L,1}}{S_{L,1} - S_{L,2}} \\approx r^p\n$$\nSolving for $p$ yields the estimated order of accuracy:\n$$\np_{S_L} = \\frac{\\ln\\left(\\frac{S_{L,0} - S_{L,1}}{S_{L,1} - S_{L,2}}\\right)}{\\ln(r)}\n$$\nOnce $p$ is estimated, we can compute an improved, extrapolated value for the continuum solution, $S_L^\\star$, using the two finest grid solutions ($S_{L,1}$, $S_{L,2}$) for better accuracy. Rearranging the equations for $S_{L,1}$ and $S_{L,2}$ to eliminate the error term $C_S h_1^p$ leads to the Richardson extrapolation formula:\n$$\nS_L^\\star = S_{L,2} + \\frac{S_{L,2} - S_{L,1}}{r^{p_{S_L}} - 1}\n$$\n\n**Methodology for Field Quantities (Temperature $T$)**\n\nThe analysis for the temperature field, $T(x)$, follows the same principles but requires additional steps to handle the spatially distributed data.\n\n$1$.  **Data Synthesis and Grid Generation**: For each grid level $k \\in \\{0, 1, 2\\}$, a uniform grid $x_k$ is generated over the domain $[0, L]$ with spacing $h_k$. The synthetic temperature data $T_{h_k}$ is then computed at each node of $x_k$ using the provided models for the exact temperature $T_{\\mathrm{exact}}(x)$ and the numerical error term.\n\n$2$.  **Profile Alignment**: The temperature profiles $T_{h_0}$, $T_{h_1}$, and $T_{h_2}$ are defined on grids with different numbers of points. To compare them, they must be represented on a common grid. The finest grid, $x_2$, is chosen for this purpose. The coarser profiles, $T_{h_0}$ and $T_{h_1}$, are interpolated onto the nodes of $x_2$ using linear interpolation. This yields three profiles defined on the same set of spatial coordinates: $T_{h_0}^{\\text{interp}}$, $T_{h_1}^{\\text{interp}}$, and $T_{h_2}$.\n\n$3$.  **Global Order of Accuracy, $p_T$**: To estimate a single, global order of accuracy for the entire temperature field, we use a vector norm to measure the magnitude of the difference between the aligned profiles. The $L_2$-norm is a standard choice. The differences are computed as:\n    $$\n    \\epsilon_{T,01} = \\| T_{h_0}^{\\text{interp}} - T_{h_1}^{\\text{interp}} \\|_2 \\\\\n    \\epsilon_{T,12} = \\| T_{h_1}^{\\text{interp}} - T_{h_2} \\|_2\n    $$\n    The formula for the order of accuracy is then applied to these scalar norm values:\n    $$\n    p_T = \\frac{\\ln\\left(\\frac{\\epsilon_{T,01}}{\\epsilon_{T,12}}\\right)}{\\ln(r)}\n    $$\n\n$4$.  **Pointwise Extrapolation and Peak Temperature**: Using the estimated global order $p_T$, the Richardson extrapolation formula is applied at each point $x_i$ of the fine grid $x_2$ to compute the extrapolated continuum temperature profile $T^\\star(x_i)$:\n    $$\n    T^\\star(x_i) = T_{h_2}(x_i) + \\frac{T_{h_2}(x_i) - T_{h_1}^{\\text{interp}}(x_i)}{r^{p_T} - 1}\n    $$\n    This is performed efficiently using vector operations on the aligned profiles. Finally, the extrapolated peak temperature, $T_{\\text{peak}}^\\star$, is determined by finding the maximum value of the resulting profile $T^\\star$.\n\n**Algorithmic Implementation**\n\nThe overall algorithm proceeds as follows for each test case:\n$1$.  Set the physical and numerical parameters ($L, \\delta, T_u, T_b, x_f, S_L^{\\mathrm{exact}}, C_S, C_T, p_{\\mathrm{true}}, h_0, r$).\n$2$.  Calculate the grid spacings $h_1 = h_0/r$ and $h_2 = h_0/r^2$.\n$3$.  Generate the three synthetic data points for the laminar burning velocity, $S_{L,0}, S_{L,1}, S_{L,2}$.\n$4$.  Apply the derived formulas to compute the estimated order $p_{S_L}$ and the extrapolated value $S_L^\\star$.\n$5$.  Generate the three coordinate arrays $x_0, x_1, x_2$ and the corresponding synthetic temperature profiles $T_{h_0}, T_{h_1}, T_{h_2}$.\n$6$.  Interpolate $T_{h_0}$ and $T_{h_1}$ onto the $x_2$ grid.\n$7$.  Compute the $L_2$-norms of the differences between the aligned profiles to find the global temperature order of accuracy, $p_T$.\n$8$.  Calculate the pointwise extrapolated temperature profile $T^\\star$ and find its maximum value, $T_{\\text{peak}}^\\star$.\n$9$.  Collect the four resulting values ($p_{S_L}, S_L^\\star, p_T, T_{\\text{peak}}^\\star$) for final output.\n\nThis procedure is systematically applied to all test cases to generate the required results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a grid convergence study using Richardson extrapolation for laminar\n    burning velocity and temperature profiles based on synthetic flame data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": 0.01, \"delta\": 0.0005, \"x_f\": 0.004,\n            \"T_u\": 300.0, \"T_b\": 2100.0,\n            \"S_L_exact\": 0.40,\n            \"h0\": 2.0e-4, \"r\": 2.0,\n            \"p_true\": 2.1, \"C_T\": 400.0, \"C_S\": 0.08,\n        },\n        {\n            \"L\": 0.015, \"delta\": 0.0008, \"x_f\": 0.006,\n            \"T_u\": 320.0, \"T_b\": 2200.0,\n            \"S_L_exact\": 0.55,\n            \"h0\": 1.5e-4, \"r\": 1.5,\n            \"p_true\": 1.8, \"C_T\": 300.0, \"C_S\": 0.05,\n        },\n        {\n            \"L\": 0.012, \"delta\": 0.0006, \"x_f\": 0.0055,\n            \"T_u\": 290.0, \"T_b\": 2000.0,\n            \"S_L_exact\": 0.48,\n            \"h0\": 2.4e-4, \"r\": 2.0,\n            \"p_true\": 2.0, \"C_T\": 100.0, \"C_S\": 0.02,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters\n        L, delta, x_f = case[\"L\"], case[\"delta\"], case[\"x_f\"]\n        T_u, T_b = case[\"T_u\"], case[\"T_b\"]\n        S_L_exact = case[\"S_L_exact\"]\n        h0, r = case[\"h0\"], case[\"r\"]\n        p_true, C_T, C_S = case[\"p_true\"], case[\"C_T\"], case[\"C_S\"]\n\n        # Define grid spacings\n        h1 = h0 / r\n        h2 = h0 / r**2\n        h_levels = [h0, h1, h2]\n\n        # --- Part 1: Laminar Burning Velocity (S_L) Analysis ---\n\n        # Synthesize S_L data\n        S_L_h = [S_L_exact + C_S * h**p_true for h in h_levels]\n        S_L0, S_L1, S_L2 = S_L_h[0], S_L_h[1], S_L_h[2]\n\n        # Estimate order of accuracy p for S_L\n        # p = log((U0-U1)/(U1-U2)) / log(r)\n        diff_01_SL = S_L0 - S_L1\n        diff_12_SL = S_L1 - S_L2\n        \n        # Handle potential division by zero or log of non-positive\n        if diff_12_SL == 0 or diff_01_SL / diff_12_SL = 0:\n            # Fallback if ratio isn't positive, though not expected here\n            p_SL_est = np.nan \n        else:\n            p_SL_est = np.log(diff_01_SL / diff_12_SL) / np.log(r)\n\n        # Compute Richardson-extrapolated S_L\n        # U_star = U2 + (U2 - U1) / (r^p - 1)\n        if np.isclose(r**p_SL_est, 1.0):\n             SL_extrap = np.nan\n        else:\n             SL_extrap = S_L2 + (S_L2 - S_L1) / (r**p_SL_est - 1)\n\n        # --- Part 2: Temperature Profile (T) Analysis ---\n\n        # Define helper functions for synthetic data generation\n        def T_exact(x, Tu, Tb, xf, d):\n            return Tu + (Tb - Tu) * 0.5 * (1 + np.tanh((x - xf) / d))\n\n        def phi(x, L_domain):\n            return np.sin(3 * np.pi * x / L_domain)\n\n        # Generate grids and temperature profiles\n        grids = []\n        temp_profiles = []\n        for h in h_levels:\n            # Create grid using linspace for robustness\n            num_intervals = int(round(L / h))\n            x_grid = np.linspace(0, L, num_intervals + 1)\n            grids.append(x_grid)\n            \n            # Synthesize temperature profile\n            T_h = T_exact(x_grid, T_u, T_b, x_f, delta) + C_T * h**p_true * phi(x_grid, L)\n            temp_profiles.append(T_h)\n            \n        x0, x1, x2 = grids[0], grids[1], grids[2]\n        T0, T1, T2 = temp_profiles[0], temp_profiles[1], temp_profiles[2]\n\n        # Align profiles on the finest grid (x2) using linear interpolation\n        T0_interp = np.interp(x2, x0, T0)\n        T1_interp = np.interp(x2, x1, T1)\n\n        # Estimate global order of accuracy p for T using L2 norms\n        diff_01_T_norm = np.linalg.norm(T0_interp - T1_interp)\n        diff_12_T_norm = np.linalg.norm(T1_interp - T2)\n\n        if diff_12_T_norm == 0 or diff_01_T_norm / diff_12_T_norm = 0:\n            p_T_est = np.nan\n        else:\n            p_T_est = np.log(diff_01_T_norm / diff_12_T_norm) / np.log(r)\n            \n        # Compute pointwise Richardson-extrapolated T profile\n        if np.isclose(r**p_T_est, 1.0):\n            T_extrap_profile = np.full_like(T2, np.nan)\n        else:\n            T_extrap_profile = T2 + (T2 - T1_interp) / (r**p_T_est - 1)\n        \n        # Find the peak temperature of the extrapolated profile\n        T_peak_extrap = np.max(T_extrap_profile)\n\n        # Append results for this case\n        results.extend([p_SL_est, SL_extrap, p_T_est, T_peak_extrap])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{val:.10f}' for val in results)}]\")\n\nsolve()\n```"
        }
    ]
}