{
    "hands_on_practices": [
        {
            "introduction": "Non-premixed, or diffusion, flames are governed by the rate at which fuel and oxidizer mix. We can use conserved scalars, which are quantities unaffected by chemical reaction, to track this mixing process and simplify the problem description. This practice  guides you through the first-principles derivation of the Bilger mixture fraction, a fundamental variable used to parameterize the thermochemical state in diffusion flame simulations and provide a powerful framework for analysis.",
            "id": "3966539",
            "problem": "In nonpremixed laminar flame simulations within computational thermal engineering, a conserved scalar known as the mixture fraction is used to parameterize composition and thermochemical state along mixing lines. Consider a general reacting system containing the elements carbon ($C$), hydrogen ($H$), nitrogen ($N$), and oxygen ($O$). Using only conservation of elemental atoms and the stoichiometry of complete oxidation to carbon dioxide ($\\mathrm{CO}_{2}$), water ($\\mathrm{H}_{2}\\mathrm{O}$), and nitrogen ($\\mathrm{N}_{2}$), derive a scalar $\\beta$ built from elemental mass fractions that remains unchanged by chemical reaction and varies linearly under mixing of two feed streams (a fuel stream and an oxidizer stream). Use this scalar to construct the Bilger mixture fraction $Z$ as an affine mapping from the scalar in the mixture to its values in the two feed streams, and then obtain the stoichiometric mixture fraction $Z_{st}$ by imposing the condition of exact oxygen balance for complete oxidation.\n\nAssume the following:\n- The elemental mass fractions in any mixture are $Y_{C}$, $Y_{H}$, $Y_{O}$, and $Y_{N}$, defined as the mass of each element divided by the total mass.\n- The atomic weights are $W_{C} = 12.011$, $W_{H} = 1.008$, $W_{O} = 15.999$, and $W_{N} = 14.007$.\n- The fuel stream is pure methane $\\mathrm{CH}_{4}$.\n- The oxidizer stream is dry air with $0.21$ mole fraction of $\\mathrm{O}_{2}$ and $0.79$ mole fraction of $\\mathrm{N}_{2}$.\n\nCompute $Z_{st}$ for methane–air using your constructed scalar and the above data. Express the final mixture fraction as a unitless number and round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of combustion theory, well-posed with sufficient data for a unique solution, and stated using objective, formal language. We may therefore proceed with the derivation and calculation.\n\nThe problem requires the derivation of a conserved scalar, its use in defining the mixture fraction, and the subsequent calculation of the stoichiometric mixture fraction for a methane-air system.\n\nFirst, we derive a conserved scalar $\\beta$. In any closed system undergoing chemical reactions, the total mass of each element is conserved. An elemental mass fraction, $Y_k$, is defined as the mass of element $k$ per unit total mass in a mixture. Since chemical reactions merely rearrange atoms into different molecular species, the total mass of each element remains constant. Consequently, any linear combination of elemental mass fractions is also a conserved quantity. A scalar variable $\\beta$ defined as $\\beta = \\sum_{k} c_k Y_k$, where $c_k$ are constants, will be conserved during chemical reactions. Furthermore, under the mixing of two streams (fuel and oxidizer), the resulting mass fraction of any element is a linear combination of its mass fractions in the parent streams, weighted by the mixture fraction. Therefore, $\\beta$ will also vary linearly with mixing.\n\nTo be useful for describing the stoichiometry of combustion, the constants $c_k$ must be chosen judiciously. We seek a scalar that relates the fuel elements (carbon and hydrogen) to the oxidizer element (oxygen) in a manner that reflects their consumption during complete oxidation. A standard and powerful choice is to define $\\beta$ such that its value is zero for the final products of complete combustion, which are carbon dioxide ($\\mathrm{CO}_{2}$) and water ($\\mathrm{H}_{2}\\mathrm{O}$). Nitrogen ($\\mathrm{N}_{2}$) is treated as an inert diluent.\n\nLet us propose a scalar of the form:\n$$\n\\beta = c_C \\frac{Y_C}{W_C} + c_H \\frac{Y_H}{W_H} + c_O \\frac{Y_O}{W_O}\n$$\nwhere $Y_k$ are the elemental mass fractions of carbon ($C$), hydrogen ($H$), and oxygen ($O$), and $W_k$ are their respective atomic weights. This form uses elemental mole numbers per unit mass. We will determine the coefficients $c_C$, $c_H$, and $c_O$ by enforcing $\\beta=0$ for $\\mathrm{CO}_{2}$ and $\\mathrm{H}_{2}\\mathrm{O}$.\n\nFor a pure sample of $\\mathrm{CO}_{2}$:\nThe molecule consists of one $C$ atom and two $O$ atoms. The elemental mass fractions are $Y_C = \\frac{W_C}{W_C + 2W_O}$ and $Y_O = \\frac{2W_O}{W_C + 2W_O}$. $Y_H=0$.\nSetting $\\beta=0$ for $\\mathrm{CO}_{2}$ yields:\n$$\nc_C \\frac{1}{W_C + 2W_O} + c_O \\frac{2}{W_C + 2W_O} = 0 \\implies c_C + 2c_O = 0\n$$\n\nFor a pure sample of $\\mathrm{H}_{2}\\mathrm{O}$:\nThe molecule consists of two $H$ atoms and one $O$ atom. The elemental mass fractions are $Y_H = \\frac{2W_H}{2W_H + W_O}$ and $Y_O = \\frac{W_O}{2W_H + W_O}$. $Y_C=0$.\nSetting $\\beta=0$ for $\\mathrm{H}_{2}\\mathrm{O}$ yields:\n$$\nc_H \\frac{2}{2W_H + W_O} + c_O \\frac{1}{2W_H + W_O} = 0 \\implies 2c_H + c_O = 0\n$$\n\nWe have a system of two linear equations with three unknowns, so there is one degree of freedom. We can choose a value for one coefficient to fix the others. Let us choose $c_O = -1$.\nFrom $c_C + 2c_O = 0$, we get $c_C = -2c_O = 2$.\nFrom $2c_H + c_O = 0$, we get $c_H = -c_O/2 = 1/2$.\nThus, a valid conserved scalar is:\n$$\n\\beta = 2\\frac{Y_C}{W_C} + \\frac{1}{2}\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O}\n$$\nThis is a specific form of the Bilger coupling function. It is a conserved scalar constructed from elemental mass fractions that has the desired property related to stoichiometry.\n\nNext, we construct the mixture fraction $Z$. The mixture fraction is defined as a normalized variable that linearly maps the conserved scalar $\\beta$ from its value in the oxidizer stream ($\\beta_{ox}$) to its value in the fuel stream ($\\beta_{fuel}$). By convention, $Z=0$ in the oxidizer stream and $Z=1$ in the fuel stream. The affine mapping is:\n$$\nZ = \\frac{\\beta - \\beta_{ox}}{\\beta_{fuel} - \\beta_{ox}}\n$$\n\nThe stoichiometric mixture fraction, $Z_{st}$, corresponds to the specific mixture composition where there is exactly enough oxygen to completely oxidize the fuel to $\\mathrm{CO}_{2}$ and $\\mathrm{H}_{2}\\mathrm{O}$. In such a mixture, the elemental composition is such that after complete reaction, only these products (and inert species like $\\mathrm{N}_{2}$) would remain. By our construction of $\\beta$, its value for this stoichiometric mixture is zero, i.e., $\\beta_{st} = 0$. Substituting this into the definition of $Z$ gives the expression for $Z_{st}$:\n$$\nZ_{st} = \\frac{0 - \\beta_{ox}}{\\beta_{fuel} - \\beta_{ox}} = \\frac{-\\beta_{ox}}{\\beta_{fuel} - \\beta_{ox}}\n$$\n\nTo compute the numerical value of $Z_{st}$ for methane-air combustion, we must first calculate $\\beta_{fuel}$ and $\\beta_{ox}$.\n\nFor the fuel stream (pure methane, $\\mathrm{CH}_{4}$):\nThe molar mass is $W_{CH_4} = W_C + 4W_H$.\nThe elemental mass fractions are $Y_C = \\frac{W_C}{W_{CH_4}}$ and $Y_H = \\frac{4W_H}{W_{CH_4}}$. $Y_O$ and $Y_N$ are zero.\nCalculating $\\beta_{fuel}$:\n$$\n\\beta_{fuel} = 2\\frac{Y_C}{W_C} + \\frac{1}{2}\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O} = 2\\frac{(W_C/W_{CH_4})}{W_C} + \\frac{1}{2}\\frac{(4W_H/W_{CH_4})}{W_H} - 0 = \\frac{2}{W_{CH_4}} + \\frac{2}{W_{CH_4}} = \\frac{4}{W_{CH_4}}\n$$\n\nFor the oxidizer stream (dry air: $0.21$ mole fraction $\\mathrm{O}_{2}$, $0.79$ mole fraction $\\mathrm{N}_{2}$):\nThe average molar mass of air is $W_{air} = 0.21 W_{O_2} + 0.79 W_{N_2} = 0.21(2W_O) + 0.79(2W_N) = 0.42W_O + 1.58W_N$.\nThe elemental mass fraction of oxygen is $Y_O = \\frac{0.21 \\times 2W_O}{W_{air}} = \\frac{0.42W_O}{W_{air}}$. $Y_C$ and $Y_H$ are zero.\nCalculating $\\beta_{ox}$:\n$$\n\\beta_{ox} = 2\\frac{Y_C}{W_C} + \\frac{1}{2}\\frac{Y_H}{W_H} - \\frac{Y_O}{W_O} = 0 + 0 - \\frac{(0.42W_O/W_{air})}{W_O} = -\\frac{0.42}{W_{air}}\n$$\n\nNow, we substitute these expressions for $\\beta_{fuel}$ and $\\beta_{ox}$ into the formula for $Z_{st}$:\n$$\nZ_{st} = \\frac{-(-\\frac{0.42}{W_{air}})}{\\frac{4}{W_{CH_4}} - (-\\frac{0.42}{W_{air}})} = \\frac{\\frac{0.42}{W_{air}}}{\\frac{4}{W_{CH_4}} + \\frac{0.42}{W_{air}}}\n$$\nMultiplying the numerator and denominator by $W_{CH_4}W_{air}$ gives:\n$$\nZ_{st} = \\frac{0.42 W_{CH_4}}{4 W_{air} + 0.42 W_{CH_4}}\n$$\nDividing the numerator and denominator by $2$ to simplify:\n$$\nZ_{st} = \\frac{0.21 W_{CH_4}}{2 W_{air} + 0.21 W_{CH_4}}\n$$\nThis expression can also be derived from the stoichiometric air-fuel mass ratio, confirming our derivation.\n\nFinally, we compute the numerical value using the provided atomic weights:\n$W_{C} = 12.011$\n$W_{H} = 1.008$\n$W_{O} = 15.999$\n$W_{N} = 14.007$\n\nMolar mass of methane:\n$W_{CH_4} = W_C + 4W_H = 12.011 + 4(1.008) = 16.043$\n\nMolar mass of air:\n$W_{air} = 0.21(2W_O) + 0.79(2W_N) = 0.21(2 \\times 15.999) + 0.79(2 \\times 14.007) = 0.21(31.998) + 0.79(28.014) = 6.71958 + 22.13106 = 28.85064$\n\nSubstitute these values into the expression for $Z_{st}$:\n$$\nZ_{st} = \\frac{0.21 \\times 16.043}{2 \\times 28.85064 + 0.21 \\times 16.043}\n$$\n$$\nZ_{st} = \\frac{3.36903}{57.70128 + 3.36903} = \\frac{3.36903}{61.07031} \\approx 0.0551664\n$$\nRounding to four significant figures, we get $Z_{st} = 0.05517$.",
            "answer": "$$\n\\boxed{0.05517}\n$$"
        },
        {
            "introduction": "The core of any flame simulation is the accurate calculation of chemical reaction rates, which act as source or sink terms in the species transport equations. These rates are determined by the law of mass action and temperature-dependent Arrhenius rate constants. This hands-on coding exercise  challenges you to compute the net species production rates, such as $\\omega_{\\mathrm{OH}}$, from a detailed kinetic mechanism, a critical skill for developing combustion software and for post-processing analyses that identify key reaction pathways.",
            "id": "3966554",
            "problem": "You are provided with a scientifically plausible subset of a detailed chemical kinetic mechanism for a hydrogen–air laminar premixed flame focused on the hydroxyl radical species. Your task is to compute the net molar production rate of hydroxyl radical at the location of peak temperature for specified local thermochemical states and to identify the reactions that most strongly control hydroxyl radical production there. The computation must be done by starting from fundamental laws and well-tested formulas, without shortcut relations.\n\nFundamental base to use:\nBegin from species conservation and the law of mass action for elementary reactions, together with the Arrhenius rate expression. Use the International System of Units (SI). Specifically, use the ideal-gas definition of molar concentration as the product of mole fraction and pressure divided by the universal gas constant times temperature. Use reversible elementary reaction steps with separate forward and reverse Arrhenius parameters provided below.\n\nMechanism definition:\nConsider the following eight species: hydrogen ($\\mathrm{H_2}$), oxygen ($\\mathrm{O_2}$), nitrogen ($\\mathrm{N_2}$), water ($\\mathrm{H_2O}$), hydroxyl ($\\mathrm{OH}$), oxygen atom ($\\mathrm{O}$), hydrogen atom ($\\mathrm{H}$), and hydroperoxyl ($\\mathrm{HO_2}$). The following six elementary reversible reactions are to be used:\n\nReaction $\\#1$: $\\mathrm{H} + \\mathrm{O_2} \\rightleftharpoons \\mathrm{O} + \\mathrm{OH}$ with forward Arrhenius parameters $A_f = 3.55\\times10^{7}$, $n_f = -0.70$, $E_{a,f} = 7.12\\times10^{4}\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 1.20\\times10^{7}$, $n_r = -0.70$, $E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$.\n\nReaction $\\#2$: $\\mathrm{O} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{OH}$ with forward Arrhenius parameters $A_f = 1.80\\times10^{6}$, $n_f = 1.00$, $E_{a,f} = 3.16\\times10^{4}\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 7.00\\times10^{5}$, $n_r = 1.00$, $E_{a,r} = 0\\,\\mathrm{J/mol}$.\n\nReaction $\\#3$: $\\mathrm{OH} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{H_2O}$ with forward Arrhenius parameters $A_f = 2.10\\times10^{6}$, $n_f = 1.50$, $E_{a,f} = 2.10\\times10^{3}\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 1.00\\times10^{6}$, $n_r = 1.50$, $E_{a,r} = 3.00\\times10^{4}\\,\\mathrm{J/mol}$.\n\nReaction $\\#4$: $\\mathrm{HO_2} + \\mathrm{H} \\rightleftharpoons \\mathrm{OH} + \\mathrm{OH}$ with forward Arrhenius parameters $A_f = 1.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 2.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$. Note that this reaction produces two hydroxyl radicals on the forward step.\n\nReaction $\\#5$: $\\mathrm{HO_2} + \\mathrm{O} \\rightleftharpoons \\mathrm{OH} + \\mathrm{O_2}$ with forward Arrhenius parameters $A_f = 1.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 1.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 1.80\\times10^{4}\\,\\mathrm{J/mol}$.\n\nReaction $\\#6$: $\\mathrm{HO_2} + \\mathrm{OH} \\rightleftharpoons \\mathrm{H_2O} + \\mathrm{O_2}$ with forward Arrhenius parameters $A_f = 2.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$, and reverse Arrhenius parameters $A_r = 2.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 5.00\\times10^{3}\\,\\mathrm{J/mol}$.\n\nRate definitions:\nFor each reaction $j$, the forward rate constant is $k_{f,j} = A_{f,j}\\,T^{n_{f,j}}\\exp\\!\\left(-E_{a,f,j}/(R\\,T)\\right)$ and the reverse rate constant is $k_{r,j} = A_{r,j}\\,T^{n_{r,j}}\\exp\\!\\left(-E_{a,r,j}/(R\\,T)\\right)$, where $R$ is the universal gas constant. For law of mass action, the forward rate of progress is the product of the forward rate constant and the product of reactant molar concentrations raised to their stoichiometric powers, and similarly for the reverse direction with product molar concentrations.\n\nThermochemical state and data:\nAssume ideal-gas behavior. For a given pressure $p$ and temperature $T$, the molar concentration of species $i$ is $c_i = X_i\\,p/(R\\,T)$, where $X_i$ is the mole fraction of species $i$. In the test suite below, mole fractions are provided for all species except $\\mathrm{N_2}$, and you must compute $X_{\\mathrm{N_2}}$ by difference to satisfy $\\sum_i X_i = 1$. The universal gas constant is $R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$.\n\nTarget quantity:\nCompute the net molar production rate of hydroxyl radical, $\\omega_{\\mathrm{OH}}$, defined as the stoichiometric sum over reactions of the net reaction rates of progress multiplied by the hydroxyl stoichiometric coefficient difference (products minus reactants) for each reaction. The unit of $\\omega_{\\mathrm{OH}}$ must be reported in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$.\n\nInterpretation task:\nFor each state, identify the three reactions that most strongly control hydroxyl radical production, defined as those with largest absolute contribution to $\\omega_{\\mathrm{OH}}$ when decomposed reaction-wise. Report the indices of these controlling reactions using $1$-based indexing corresponding to the reaction numbering above.\n\nTest suite:\nUse the following three test cases representative of peak-temperature locations in a hydrogen–air laminar premixed flame:\n\nCase $1$ (stoichiometric-like peak temperature): $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.400\\times10^{3}\\,\\mathrm{K}$, mole fractions excluding $\\mathrm{N_2}$ are $X_{\\mathrm{H_2O}} = 3.50\\times10^{-1}$, $X_{\\mathrm{OH}} = 1.00\\times10^{-3}$, $X_{\\mathrm{O}} = 5.00\\times10^{-4}$, $X_{\\mathrm{H}} = 2.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$.\n\nCase $2$ (lean-like peak temperature): $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.000\\times10^{3}\\,\\mathrm{K}$, mole fractions excluding $\\mathrm{N_2}$ are $X_{\\mathrm{H_2O}} = 2.50\\times10^{-1}$, $X_{\\mathrm{OH}} = 6.00\\times10^{-4}$, $X_{\\mathrm{O}} = 2.00\\times10^{-4}$, $X_{\\mathrm{H}} = 1.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 1.00\\times10^{-2}$, $X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$.\n\nCase $3$ (rich-like peak temperature): $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.100\\times10^{3}\\,\\mathrm{K}$, mole fractions excluding $\\mathrm{N_2}$ are $X_{\\mathrm{H_2O}} = 2.80\\times10^{-1}$, $X_{\\mathrm{OH}} = 8.00\\times10^{-4}$, $X_{\\mathrm{O}} = 1.00\\times10^{-4}$, $X_{\\mathrm{H}} = 4.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 5.00\\times10^{-7}$, $X_{\\mathrm{H_2}} = 2.00\\times10^{-2}$, $X_{\\mathrm{HO_2}} = 2.00\\times10^{-7}$.\n\nRequired output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is an inner list of the form $[\\omega_{\\mathrm{OH}}, i_1, i_2, i_3]$ with $\\omega_{\\mathrm{OH}}$ in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$ and $i_1$, $i_2$, $i_3$ the indices of the three most controlling reactions by absolute contribution. As an example of the structure, the output should look like $[[\\omega_1,i_{1,1},i_{1,2},i_{1,3}],[\\omega_2,i_{2,1},i_{2,2},i_{2,3}],[\\omega_3,i_{3,1},i_{3,2},i_{3,3}]]$.",
            "solution": "The user has provided a problem in the domain of chemical kinetics, specifically focused on calculating reaction rates in a high-temperature gaseous system. The problem is to be validated for scientific soundness and completeness before a solution is attempted.\n\n### Step 1: Problem Validation\n\nFollowing the prescribed protocol, the first step is to extract all given information verbatim from the problem statement.\n\n**Extraction of Givens:**\n\n*   **System:** A hydrogen–air laminar premixed flame.\n*   **Target Species:** Hydroxyl radical ($\\mathrm{OH}$).\n*   **Fundamental Laws:** Species conservation, law of mass action, Arrhenius rate expression.\n*   **Assumptions:** Ideal-gas behavior.\n*   **Species List:** Hydrogen ($\\mathrm{H_2}$), Oxygen ($\\mathrm{O_2}$), Nitrogen ($\\mathrm{N_2}$), Water ($\\mathrm{H_2O}$), Hydroxyl ($\\mathrm{OH}$), Oxygen atom ($\\mathrm{O}$), Hydrogen atom ($\\mathrm{H}$), and Hydroperoxyl ($\\mathrm{HO_2}$).\n*   **Universal Gas Constant:** $R = 8.314462618\\,\\mathrm{J/(mol\\cdot K)}$.\n*   **Reaction Mechanism (6 reversible reactions):**\n    1.  $\\mathrm{H} + \\mathrm{O_2} \\rightleftharpoons \\mathrm{O} + \\mathrm{OH}$: $A_f = 3.55\\times10^{7}$, $n_f = -0.70$, $E_{a,f} = 7.12\\times10^{4}\\,\\mathrm{J/mol}$; $A_r = 1.20\\times10^{7}$, $n_r = -0.70$, $E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$.\n    2.  $\\mathrm{O} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{OH}$: $A_f = 1.80\\times10^{6}$, $n_f = 1.00$, $E_{a,f} = 3.16\\times10^{4}\\,\\mathrm{J/mol}$; $A_r = 7.00\\times10^{5}$, $n_r = 1.00$, $E_{a,r} = 0\\,\\mathrm{J/mol}$.\n    3.  $\\mathrm{OH} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{H_2O}$: $A_f = 2.10\\times10^{6}$, $n_f = 1.50$, $E_{a,f} = 2.10\\times10^{3}\\,\\mathrm{J/mol}$; $A_r = 1.00\\times10^{6}$, $n_r = 1.50$, $E_{a,r} = 3.00\\times10^{4}\\,\\mathrm{J/mol}$.\n    4.  $\\mathrm{HO_2} + \\mathrm{H} \\rightleftharpoons \\mathrm{OH} + \\mathrm{OH}$: $A_f = 1.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$; $A_r = 2.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 2.00\\times10^{4}\\,\\mathrm{J/mol}$.\n    5.  $\\mathrm{HO_2} + \\mathrm{O} \\rightleftharpoons \\mathrm{OH} + \\mathrm{O_2}$: $A_f = 1.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$; $A_r = 1.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 1.80\\times10^{4}\\,\\mathrm{J/mol}$.\n    6.  $\\mathrm{HO_2} + \\mathrm{OH} \\rightleftharpoons \\mathrm{H_2O} + \\mathrm{O_2}$: $A_f = 2.00\\times10^{6}$, $n_f = 0.00$, $E_{a,f} = 0\\,\\mathrm{J/mol}$; $A_r = 2.00\\times10^{6}$, $n_r = 0.00$, $E_{a,r} = 5.00\\times10^{3}\\,\\mathrm{J/mol}$.\n*   **Governing Equations:**\n    *   Forward rate constant: $k_{f,j} = A_{f,j}\\,T^{n_{f,j}}\\exp\\!\\left(-E_{a,f,j}/(R\\,T)\\right)$.\n    *   Reverse rate constant: $k_{r,j} = A_{r,j}\\,T^{n_{r,j}}\\exp\\!\\left(-E_{a,r,j}/(R\\,T)\\right)$.\n    *   Molar concentration: $c_i = X_i\\,p/(R\\,T)$.\n    *   Mole fraction sum: $\\sum_i X_i = 1$.\n*   **Target Quantities:**\n    *   Net molar production rate of hydroxyl radical, $\\omega_{\\mathrm{OH}}$ in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$.\n    *   Indices of the three reactions with the largest absolute contribution to $\\omega_{\\mathrm{OH}}$.\n*   **Test Cases:**\n    *   Case 1: $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.400\\times10^{3}\\,\\mathrm{K}$, $X_{\\mathrm{H_2O}} = 3.50\\times10^{-1}$, $X_{\\mathrm{OH}} = 1.00\\times10^{-3}$, $X_{\\mathrm{O}} = 5.00\\times10^{-4}$, $X_{\\mathrm{H}} = 2.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$.\n    *   Case 2: $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.000\\times10^{3}\\,\\mathrm{K}$, $X_{\\mathrm{H_2O}} = 2.50\\times10^{-1}$, $X_{\\mathrm{OH}} = 6.00\\times10^{-4}$, $X_{\\mathrm{O}} = 2.00\\times10^{-4}$, $X_{\\mathrm{H}} = 1.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 1.00\\times10^{-2}$, $X_{\\mathrm{H_2}} = 1.00\\times10^{-6}$, $X_{\\mathrm{HO_2}} = 1.00\\times10^{-7}$.\n    *   Case 3: $p = 1.01325\\times10^{5}\\,\\mathrm{Pa}$, $T = 2.100\\times10^{3}\\,\\mathrm{K}$, $X_{\\mathrm{H_2O}} = 2.80\\times10^{-1}$, $X_{\\mathrm{OH}} = 8.00\\times10^{-4}$, $X_{\\mathrm{O}} = 1.00\\times10^{-4}$, $X_{\\mathrm{H}} = 4.00\\times10^{-4}$, $X_{\\mathrm{O_2}} = 5.00\\times10^{-7}$, $X_{\\mathrm{H_2}} = 2.00\\times10^{-2}$, $X_{\\mathrm{HO_2}} = 2.00\\times10^{-7}$.\n\n### Step 2: Validation of Extracted Givens\n\nThe problem is evaluated against the established criteria.\n\n*   **Scientifically Grounded:** The problem is firmly rooted in the principles of chemical kinetics and combustion theory. It uses the law of mass action and the Arrhenius equation, which are foundational concepts. The chemical mechanism is a well-established subset for hydrogen combustion. All data are physically plausible.\n*   **Well-Posed:** All necessary inputs are provided: pressure, temperature, mole fractions for all reactive species, and all parameters for the reaction rate constants. The objective is clearly defined and computationally achievable. A unique solution exists for each test case.\n*   **Objective:** The problem is stated in precise, quantitative, and unbiased language.\n*   **Completeness and Consistency:** The problem is self-contained. The instruction to compute the mole fraction of the inert species $\\mathrm{N_2}$ by difference ensures that the mole fractions sum to unity, rendering the thermochemical state fully defined. The sum of the provided mole fractions in each case is less than $1$, making the calculation of a positive $X_{\\mathrm{N_2}}$ possible. The units are specified as SI, and the provided Arrhenius parameters, while not having explicitly stated units, are numerically consistent with standard SI-based formulations (e.g., $A$ for a bimolecular reaction in $\\mathrm{m^3 mol^{-1} s^{-1} K^{-n}}$) to yield the target quantity in $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is scientifically sound, well-posed, and contains all necessary information for a unique solution. Therefore, I will proceed to derive and present the solution.\n\n---\n\n### Solution Derivation\n\nThe objective is to compute the net molar production rate of the hydroxyl radical, $\\omega_{\\mathrm{OH}}$, and identify the most influential reactions for three given thermochemical states.\n\n**1. Fundamental Principles**\n\nFor a spatially homogeneous system (as assumed at a specific location in the flame), the rate of change of the molar concentration of a species $i$, $c_i$, is governed by its net rate of chemical production, $\\omega_i$.\n$$\n\\frac{dc_i}{dt} = \\omega_i\n$$\nThe net production rate $\\omega_i$ is the sum of its production rates over all elementary reactions in the mechanism. For a set of $N_{rxn}$ reactions, this is expressed as:\n$$\n\\omega_i = \\sum_{j=1}^{N_{rxn}} \\Delta\\nu_{ij} q_j\n$$\nwhere $\\Delta\\nu_{ij} = (\\nu''_{ij} - \\nu'_{ij})$ is the net stoichiometric coefficient of species $i$ in reaction $j$ ($\\nu''_{ij}$ for products, $\\nu'_{ij}$ for reactants), and $q_j$ is the net rate of progress for reaction $j$.\n\nThe net rate of progress, $q_j$, is the difference between its forward ($q_{f,j}$) and reverse ($q_{r,j}$) rates:\n$$\nq_j = q_{f,j} - q_{r,j}\n$$\nAccording to the law of mass action for an elementary reaction $j$, these rates are given by:\n$$\nq_{f,j} = k_{f,j} \\prod_{k=1}^{N_{species}} c_k^{\\nu'_{kj}} \\quad \\text{and} \\quad q_{r,j} = k_{r,j} \\prod_{k=1}^{N_{species}} c_k^{\\nu''_{kj}}\n$$\nwhere $k_{f,j}$ and $k_{r,j}$ are the forward and reverse rate constants, and $c_k$ is the molar concentration of species $k$.\n\nThe rate constants are described by the generalized Arrhenius equation:\n$$\nk_j(T) = A_j T^{n_j} \\exp\\left(-\\frac{E_{a,j}}{RT}\\right)\n$$\nwhere $A_j$ is the pre-exponential factor, $n_j$ is the temperature exponent, $E_{a,j}$ is the activation energy, $T$ is the absolute temperature, and $R$ is the universal gas constant.\n\nFinally, under the ideal gas assumption, the molar concentration $c_i$ of species $i$ is related to its mole fraction $X_i$, the system pressure $p$, and temperature $T$ by:\n$$\nc_i = \\frac{X_i p}{RT}\n$$\n\n**2. Application to Hydroxyl Radical ($\\mathrm{OH}$)**\n\nWe must determine the net stoichiometric coefficient, $\\Delta\\nu_{\\mathrm{OH},j}$, for $\\mathrm{OH}$ in each of the six specified reactions.\n\n*   Reaction $1$: $\\mathrm{H} + \\mathrm{O_2} \\rightleftharpoons \\mathrm{O} + \\mathrm{OH}$. $\\nu'_{\\mathrm{OH},1} = 0$, $\\nu''_{\\mathrm{OH},1} = 1 \\implies \\Delta\\nu_{\\mathrm{OH},1} = 1$.\n*   Reaction $2$: $\\mathrm{O} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{OH}$. $\\nu'_{\\mathrm{OH},2} = 0$, $\\nu''_{\\mathrm{OH},2} = 1 \\implies \\Delta\\nu_{\\mathrm{OH},2} = 1$.\n*   Reaction $3$: $\\mathrm{OH} + \\mathrm{H_2} \\rightleftharpoons \\mathrm{H} + \\mathrm{H_2O}$. $\\nu'_{\\mathrm{OH},3} = 1$, $\\nu''_{\\mathrm{OH},3} = 0 \\implies \\Delta\\nu_{\\mathrm{OH},3} = -1$.\n*   Reaction $4$: $\\mathrm{HO_2} + \\mathrm{H} \\rightleftharpoons \\mathrm{OH} + \\mathrm{OH}$. $\\nu'_{\\mathrm{OH},4} = 0$, $\\nu''_{\\mathrm{OH},4} = 2 \\implies \\Delta\\nu_{\\mathrm{OH},4} = 2$.\n*   Reaction $5$: $\\mathrm{HO_2} + \\mathrm{O} \\rightleftharpoons \\mathrm{OH} + \\mathrm{O_2}$. $\\nu'_{\\mathrm{OH},5} = 0$, $\\nu''_{\\mathrm{OH},5} = 1 \\implies \\Delta\\nu_{\\mathrm{OH},5} = 1$.\n*   Reaction $6$: $\\mathrm{HO_2} + \\mathrm{OH} \\rightleftharpoons \\mathrm{H_2O} + \\mathrm{O_2}$. $\\nu'_{\\mathrm{OH},6} = 1$, $\\nu''_{\\mathrm{OH},6} = 0 \\implies \\Delta\\nu_{\\mathrm{OH},6} = -1$.\n\nThe rates of progress $q_j$ are:\n$q_1 = k_{f,1} c_{\\mathrm{H}} c_{\\mathrm{O_2}} - k_{r,1} c_{\\mathrm{O}} c_{\\mathrm{OH}}$\n$q_2 = k_{f,2} c_{\\mathrm{O}} c_{\\mathrm{H_2}} - k_{r,2} c_{\\mathrm{H}} c_{\\mathrm{OH}}$\n$q_3 = k_{f,3} c_{\\mathrm{OH}} c_{\\mathrm{H_2}} - k_{r,3} c_{\\mathrm{H}} c_{\\mathrm{H_2O}}$\n$q_4 = k_{f,4} c_{\\mathrm{HO_2}} c_{\\mathrm{H}} - k_{r,4} c_{\\mathrm{OH}}^2$\n$q_5 = k_{f,5} c_{\\mathrm{HO_2}} c_{\\mathrm{O}} - k_{r,5} c_{\\mathrm{OH}} c_{\\mathrm{O_2}}$\n$q_6 = k_{f,6} c_{\\mathrm{HO_2}} c_{\\mathrm{OH}} - k_{r,6} c_{\\mathrm{H_2O}} c_{\\mathrm{O_2}}$\n\nThe net production rate of $\\mathrm{OH}$ is the sum of the contributions from each reaction, $\\omega_{\\mathrm{OH}, j} = \\Delta\\nu_{\\mathrm{OH},j} q_j$:\n$$\n\\omega_{\\mathrm{OH}} = \\sum_{j=1}^{6} \\omega_{\\mathrm{OH}, j} = q_1 + q_2 - q_3 + 2q_4 + q_5 - q_6\n$$\n\n**3. Computational Algorithm**\n\nFor each test case specified by $(p, T, \\{X_i\\}_{i\\neq \\mathrm{N_2}})$:\n1.  Calculate the mole fraction of nitrogen: $X_{\\mathrm{N_2}} = 1 - \\sum_{i \\in \\{\\mathrm{H_2}, \\mathrm{O_2}, ...\\}} X_i$.\n2.  Calculate the molar concentration for each of the $8$ species using $c_i = X_i p / (RT)$.\n3.  For each of the $6$ reactions:\n    a. Compute the forward rate constant $k_{f,j}$ and reverse rate constant $k_{r,j}$ using the Arrhenius formula and the given parameters.\n    b. Compute the forward rate of progress $q_{f,j}$ and reverse rate of progress $q_{r,j}$ using the law of mass action and the calculated concentrations.\n    c. Compute the net rate of progress $q_j = q_{f,j} - q_{r,j}$.\n4.  Calculate the contribution of each reaction to the net production of $\\mathrm{OH}$: $\\omega_{\\mathrm{OH},j} = \\Delta\\nu_{\\mathrm{OH},j} q_j$.\n5.  Sum these contributions to obtain the total net production rate: $\\omega_{\\mathrm{OH}} = \\sum_{j=1}^{6} \\omega_{\\mathrm{OH},j}$.\n6.  To identify the controlling reactions, calculate the absolute value of each contribution, $|\\omega_{\\mathrm{OH},j}|$.\n7.  Sort these absolute contributions in descending order and identify the corresponding reaction indices ($1$-based). The top three are the most controlling reactions.\n8.  Format the results as required: $[\\omega_{\\mathrm{OH}}, i_1, i_2, i_3]$.\n\nThis procedure provides a rigorous and complete path to the solution based on the provided data and fundamental principles. The following code implements this algorithm.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the net molar production rate of the hydroxyl radical (OH)\n    and identifies the controlling reactions for given thermochemical states\n    in a hydrogen-air flame.\n    \"\"\"\n    # Universal Gas Constant in SI units: J/(mol.K)\n    R = 8.314462618\n\n    # Species list in the order they are typically handled\n    species_map = {\n        'H2': 0, 'O2': 1, 'H2O': 2, 'OH': 3, 'O': 4,\n        'H': 5, 'HO2': 6, 'N2': 7\n    }\n\n    # Reaction mechanism data.\n    # A_f/A_r units are m^3/mol/s for bimolecular rxns (adjusted for T^n).\n    # E_a units are J/mol.\n    reactions = [\n        # R1: H + O2 = O + OH\n        {'reactants': {'H': 1, 'O2': 1}, 'products': {'O': 1, 'OH': 1},\n         'f': {'A': 3.55e7, 'n': -0.70, 'Ea': 7.12e4},\n         'r': {'A': 1.20e7, 'n': -0.70, 'Ea': 2.00e4}},\n        # R2: O + H2 = H + OH\n        {'reactants': {'O': 1, 'H2': 1}, 'products': {'H': 1, 'OH': 1},\n         'f': {'A': 1.80e6, 'n': 1.00, 'Ea': 3.16e4},\n         'r': {'A': 7.00e5, 'n': 1.00, 'Ea': 0.0}},\n        # R3: OH + H2 = H + H2O\n        {'reactants': {'OH': 1, 'H2': 1}, 'products': {'H': 1, 'H2O': 1},\n         'f': {'A': 2.10e6, 'n': 1.50, 'Ea': 2.10e3},\n         'r': {'A': 1.00e6, 'n': 1.50, 'Ea': 3.00e4}},\n        # R4: HO2 + H = OH + OH\n        {'reactants': {'HO2': 1, 'H': 1}, 'products': {'OH': 2},\n         'f': {'A': 1.00e6, 'n': 0.00, 'Ea': 0.0},\n         'r': {'A': 2.00e6, 'n': 0.00, 'Ea': 2.00e4}},\n        # R5: HO2 + O = OH + O2\n        {'reactants': {'HO2': 1, 'O': 1}, 'products': {'OH': 1, 'O2': 1},\n         'f': {'A': 1.00e6, 'n': 0.00, 'Ea': 0.0},\n         'r': {'A': 1.00e6, 'n': 0.00, 'Ea': 1.80e4}},\n        # R6: HO2 + OH = H2O + O2\n        {'reactants': {'HO2': 1, 'OH': 1}, 'products': {'H2O': 1, 'O2': 1},\n         'f': {'A': 2.00e6, 'n': 0.00, 'Ea': 0.0},\n         'r': {'A': 2.00e6, 'n': 0.00, 'Ea': 5.00e3}},\n    ]\n\n    # Pre-calculate stoichiometric coefficients for OH for each reaction\n    nu_OH = np.array([\n        rx['products'].get('OH', 0) - rx['reactants'].get('OH', 0) for rx in reactions\n    ])\n\n    test_cases = [\n        # Case 1 (stoichiometric-like)\n        {'p': 1.01325e5, 'T': 2.400e3,\n         'X': {'H2O': 3.50e-1, 'OH': 1.00e-3, 'O': 5.00e-4, 'H': 2.00e-4,\n               'O2': 1.00e-6, 'H2': 1.00e-6, 'HO2': 1.00e-7}},\n        # Case 2 (lean-like)\n        {'p': 1.01325e5, 'T': 2.000e3,\n         'X': {'H2O': 2.50e-1, 'OH': 6.00e-4, 'O': 2.00e-4, 'H': 1.00e-4,\n               'O2': 1.00e-2, 'H2': 1.00e-6, 'HO2': 1.00e-7}},\n        # Case 3 (rich-like)\n        {'p': 1.01325e5, 'T': 2.100e3,\n         'X': {'H2O': 2.80e-1, 'OH': 8.00e-4, 'O': 1.00e-4, 'H': 4.00e-4,\n               'O2': 5.00e-7, 'H2': 2.00e-2, 'HO2': 2.00e-7}},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        p, T, X_in = case['p'], case['T'], case['X']\n        \n        # Complete mole fractions\n        X = X_in.copy()\n        X_sum = sum(X.values())\n        if X_sum = 1.0:\n            raise ValueError(\"Sum of mole fractions is = 1\")\n        X['N2'] = 1.0 - X_sum\n\n        # Calculate molar concentrations (mol/m^3)\n        p_over_RT = p / (R * T)\n        c = {name: val * p_over_RT for name, val in X.items()}\n\n        q = np.zeros(len(reactions))\n        \n        for j, rx in enumerate(reactions):\n            # Forward rate\n            kf_params = rx['f']\n            kf = kf_params['A'] * (T ** kf_params['n']) * np.exp(-kf_params['Ea'] / (R * T))\n            \n            qf_conc_prod = 1.0\n            for species, stoich in rx['reactants'].items():\n                qf_conc_prod *= c[species] ** stoich\n            qf = kf * qf_conc_prod\n\n            # Reverse rate\n            kr_params = rx['r']\n            kr = kr_params['A'] * (T ** kr_params['n']) * np.exp(-kr_params['Ea'] / (R * T))\n            \n            qr_conc_prod = 1.0\n            for species, stoich in rx['products'].items():\n                qr_conc_prod *= c[species] ** stoich\n            qr = kr * qr_conc_prod\n\n            # Net rate of progress for reaction j\n            q[j] = qf - qr\n            \n        # Reaction-wise production rate of OH (mol/m^3/s)\n        omega_OH_j = nu_OH * q\n        \n        # Total net production rate of OH\n        omega_OH_total = np.sum(omega_OH_j)\n        \n        # Identify controlling reactions (1-based index)\n        # Sort by absolute contribution in descending order\n        controlling_rxn_indices = np.argsort(np.abs(omega_OH_j))[::-1]\n        top_3_indices = (controlling_rxn_indices[:3] + 1).tolist()\n        \n        all_results.append([omega_OH_total, *top_3_indices])\n\n    # Format output as specified\n    result_str_list = [str( res ).replace(\" \", \"\") for res in all_results]\n    print(f\"[{','.join(result_str_list)}]\")\n\n\nsolve()\n```"
        },
        {
            "introduction": "The discretized governing equations for laminar flames form a large, stiff system of nonlinear algebraic equations, $\\mathbf{F}(\\mathbf{U})=\\mathbf{0}$, due to the exponential sensitivity of reaction rates to temperature. Standard solvers like the direct Newton method may fail for such systems, requiring more robust techniques like Pseudo-Transient Continuation (PTC). By implementing and comparing these two distinct nonlinear solvers , you will gain direct insight into the numerical challenges of flame simulation and the trade-offs between computational efficiency and solver robustness, an essential expertise for tackling realistic combustion problems.",
            "id": "3966595",
            "problem": "Consider the one-dimensional, steady, non-dimensional reaction–diffusion model for a laminar premixed free flame with unity Lewis number, posed on the spatial interval $z \\in [0,1]$. The unknowns are the non-dimensional temperature $\\theta(z)$ and the non-dimensional fuel mass fraction $y(z)$. The governing equations are, for $z \\in (0,1)$,\n$$\n0 = \\frac{d^2 \\theta}{dz^2} + \\mathrm{Da}\\, y\\, \\exp\\!\\left(-\\frac{\\beta}{1+\\gamma \\theta}\\right),\n$$\n$$\n0 = \\mathrm{Le}\\, \\frac{d^2 y}{dz^2} - \\mathrm{Da}\\, y\\, \\exp\\!\\left(-\\frac{\\beta}{1+\\gamma \\theta}\\right),\n$$\nwith Dirichlet boundary conditions\n$$\n\\theta(0)=0,\\quad \\theta(1)=\\Theta_{\\mathrm{ad}},\\quad y(0)=1,\\quad y(1)=0.\n$$\nHere, $\\mathrm{Da}$ is the Damköhler number (the ratio of reaction to diffusion time scales), $\\beta$ is the non-dimensional activation energy parameter, $\\gamma$ is the heat-release coupling coefficient, $\\mathrm{Le}$ is the Lewis number (the ratio of thermal to mass diffusivity), and $\\Theta_{\\mathrm{ad}}$ is the non-dimensional adiabatic temperature rise. These parameters control stiffness: large $\\beta$ and large $\\mathrm{Da}$ generate an exponentially sharp reaction zone.\n\nYour task is to discretize these equations using second-order central differences on $N$ equally spaced grid points, with $N=50$. Let the grid be defined by $z_i = i\\,\\Delta z$ for $i=0,1,\\dots,N-1$, where $\\Delta z = 1/(N-1)$. Denote the discrete unknowns by $\\theta_i \\approx \\theta(z_i)$ and $y_i \\approx y(z_i)$. Construct the nonlinear residual vector $\\mathbf{F}(\\mathbf{U})=\\mathbf{0}$ for the $2N$-vector of unknowns $\\mathbf{U} = [\\theta_0,\\theta_1,\\dots,\\theta_{N-1},y_0,y_1,\\dots,y_{N-1}]^\\top$, as follows:\n\n- For interior nodes $i=1,2,\\dots,N-2$,\n$$\nF_{\\theta,i} = \\frac{\\theta_{i-1} - 2\\theta_i + \\theta_{i+1}}{\\Delta z^2} + \\mathrm{Da}\\, y_i\\, \\exp\\!\\left(-\\frac{\\beta}{1+\\gamma \\theta_i}\\right),\n$$\n$$\nF_{y,i} = \\mathrm{Le}\\, \\frac{y_{i-1} - 2 y_i + y_{i+1}}{\\Delta z^2} - \\mathrm{Da}\\, y_i\\, \\exp\\!\\left(-\\frac{\\beta}{1+\\gamma \\theta_i}\\right).\n$$\n\n- For boundary nodes,\n$$\nF_{\\theta,0} = \\theta_0 - 0,\\quad F_{\\theta,N-1} = \\theta_{N-1} - \\Theta_{\\mathrm{ad}},\n$$\n$$\nF_{y,0} = y_0 - 1,\\quad F_{y,N-1} = y_{N-1} - 0.\n$$\n\nDefine the residual norm as the Euclidean norm of the full $2N$-vector $\\mathbf{F}(\\mathbf{U})$, that is,\n$$\n\\|\\mathbf{F}(\\mathbf{U})\\|_2 = \\left( \\sum_{j=1}^{2N} F_j^2 \\right)^{1/2}.\n$$\n\nYou must implement and compare two nonlinear solvers:\n\n1. Direct Newton method (also called Newton–Raphson method): Starting from an initial guess, at each iteration $k$ form the Jacobian matrix $\\mathbf{J}(\\mathbf{U}^{(k)}) = \\partial \\mathbf{F}/\\partial \\mathbf{U}$ and solve the linear system\n$$\n\\mathbf{J}(\\mathbf{U}^{(k)})\\, \\delta^{(k)} = -\\mathbf{F}(\\mathbf{U}^{(k)}),\n$$\nthen update\n$$\n\\mathbf{U}^{(k+1)} = \\mathbf{U}^{(k)} + \\delta^{(k)}.\n$$\nTerminate when $\\|\\mathbf{F}(\\mathbf{U}^{(k+1)})\\|_2 \\le 10^{-8}$ or when the iteration count reaches a maximum of $50$.\n\n2. Pseudo-Transient Continuation (PTC): Introduce a pseudo-time and march toward steady state using backward Euler linearization with adaptive pseudo-time step. At iteration $k$, for a current pseudo-time step $\\Delta t^{(k)}$, solve\n$$\n\\left( \\frac{1}{\\Delta t^{(k)}} \\mathbf{I} + \\mathbf{J}(\\mathbf{U}^{(k)}) \\right)\\, \\delta^{(k)} = -\\mathbf{F}(\\mathbf{U}^{(k)}),\n$$\nand update\n$$\n\\mathbf{U}^{(k+1)} = \\mathbf{U}^{(k)} + \\delta^{(k)}.\n$$\nUse the following pseudo-time step control:\n- Initialize $\\Delta t^{(0)} = 10^{-4}$, with lower and upper bounds $10^{-6}$ and $10^{2}$.\n- After computing $\\mathbf{U}^{(k+1)}$, let $r^{(k)} = \\|\\mathbf{F}(\\mathbf{U}^{(k+1)})\\|_2 / \\|\\mathbf{F}(\\mathbf{U}^{(k)})\\|_2$. If $r^{(k)}  0.7$, increase the step via $\\Delta t^{(k+1)} = \\min( 2\\, \\Delta t^{(k)}, 10^{2} )$; otherwise, decrease the step via $\\Delta t^{(k+1)} = \\max( 0.5\\, \\Delta t^{(k)}, 10^{-6} )$.\nTerminate when $\\|\\mathbf{F}(\\mathbf{U}^{(k+1)})\\|_2 \\le 10^{-8}$ or when the iteration count reaches a maximum of $200$.\n\nIn both methods, use the same initial guess:\n$$\n\\theta_i^{(0)} = \\Theta_{\\mathrm{ad}}\\, z_i,\\qquad y_i^{(0)} = 1 - z_i.\n$$\n\nDerive and implement the analytic Jacobian entries for efficiency. For each interior node $i$, the reaction term $R_i = \\mathrm{Da}\\, y_i\\, \\exp\\!\\left(-\\frac{\\beta}{1+\\gamma \\theta_i}\\right)$ has partial derivatives\n$$\n\\frac{\\partial R_i}{\\partial \\theta_i} = \\mathrm{Da}\\, y_i\\, \\exp\\!\\left(-\\frac{\\beta}{1+\\gamma \\theta_i}\\right)\\, \\frac{\\beta \\gamma}{(1+\\gamma \\theta_i)^2},\\qquad \\frac{\\partial R_i}{\\partial y_i} = \\mathrm{Da}\\, \\exp\\!\\left(-\\frac{\\beta}{1+\\gamma \\theta_i}\\right).\n$$\n\nTest Suite: Run your program on the following parameter sets, all with $\\Theta_{\\mathrm{ad}}=1$ and $\\mathrm{Le}=1$:\n- Case A (moderate stiffness): $\\mathrm{Da}=10$, $\\beta=5$, $\\gamma=4$.\n- Case B (stiff): $\\mathrm{Da}=50$, $\\beta=12$, $\\gamma=4$.\n- Case C (very stiff): $\\mathrm{Da}=100$, $\\beta=20$, $\\gamma=4$.\n\nFor each case, report four quantities for the direct Newton method and the pseudo-transient continuation method, respectively: the final residual norm and the number of iterations upon termination. If a method fails due to a linear solve error or does not reach the tolerance within the maximum iterations, report the residual norm achieved at termination and the iteration count used.\n\nFinal Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n[\\; r^{\\mathrm{N}}_{\\mathrm{A}},\\; i^{\\mathrm{N}}_{\\mathrm{A}},\\; r^{\\mathrm{P}}_{\\mathrm{A}},\\; i^{\\mathrm{P}}_{\\mathrm{A}},\\; r^{\\mathrm{N}}_{\\mathrm{B}},\\; i^{\\mathrm{N}}_{\\mathrm{B}},\\; r^{\\mathrm{P}}_{\\mathrm{B}},\\; i^{\\mathrm{P}}_{\\mathrm{B}},\\; r^{\\mathrm{N}}_{\\mathrm{C}},\\; i^{\\mathrm{N}}_{\\mathrm{C}},\\; r^{\\mathrm{P}}_{\\mathrm{C}},\\; i^{\\mathrm{P}}_{\\mathrm{C}} \\;],\n$$\nwhere $r$ denotes the final residual norm (a float) and $i$ denotes the iteration count (an integer). No physical units are involved since the formulation is non-dimensional. Angles are not present. Percentages are not used.",
            "solution": "The problem requires the numerical solution of a system of coupled, nonlinear boundary value problems that model a one-dimensional laminar premixed flame. The continuous governing equations are discretized using a second-order central finite difference scheme on a uniform grid, resulting in a large system of nonlinear algebraic equations of the form $\\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$.\n\nThe vector of unknowns $\\mathbf{U}$ is constructed by concatenating the discrete temperature values $\\theta_i$ and the discrete fuel mass fraction values $y_i$ for all grid points $i=0, 1, \\dots, N-1$. Specifically, $\\mathbf{U} = [\\theta_0, \\dots, \\theta_{N-1}, y_0, \\dots, y_{N-1}]^\\top$, resulting in a vector of size $2N$. The residual vector $\\mathbf{F}(\\mathbf{U})$ is structured similarly, with its first $N$ components corresponding to the discrete equations for temperature, and the next $N$ components corresponding to the discrete equations for the fuel mass fraction. For the interior grid points $i=1, \\dots, N-2$, the residual equations are given by the discretized governing equations. For the boundary points $i=0$ and $i=N-1$, the residuals represent the enforcement of the Dirichlet boundary conditions.\n\nTwo iterative numerical methods are to be implemented to find the root $\\mathbf{U}$ that satisfies $\\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$.\n\nFirst, the direct Newton method (Newton-Raphson) is a root-finding algorithm that begins with an initial guess $\\mathbf{U}^{(0)}$ and iteratively refines it. At each iteration $k$, the nonlinear function $\\mathbf{F}(\\mathbf{U})$ is approximated by its first-order Taylor expansion around the current iterate $\\mathbf{U}^{(k)}$:\n$$ \\mathbf{F}(\\mathbf{U}) \\approx \\mathbf{F}(\\mathbf{U}^{(k)}) + \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}\\bigg|_{\\mathbf{U}^{(k)}} (\\mathbf{U} - \\mathbf{U}^{(k)}) $$\nBy setting $\\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$ to find the next iterate $\\mathbf{U}^{(k+1)}$ and defining the Jacobian matrix as $\\mathbf{J}(\\mathbf{U}^{(k)}) = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{U}}\\big|_{\\mathbf{U}^{(k)}}$, we obtain a linear system for the update step $\\delta^{(k)} = \\mathbf{U}^{(k+1)} - \\mathbf{U}^{(k)}$:\n$$ \\mathbf{J}(\\mathbf{U}^{(k)})\\, \\delta^{(k)} = -\\mathbf{F}(\\mathbf{U}^{(k)}) $$\nAfter solving for $\\delta^{(k)}$, the solution is updated via $\\mathbf{U}^{(k+1)} = \\mathbf{U}^{(k)} + \\delta^{(k)}$. This method exhibits quadratic convergence when the guess is sufficiently close to the root, but it can diverge if the initial guess is poor, especially for stiff systems where the basin of attraction is small.\n\nSecond, the Pseudo-Transient Continuation (PTC) method is a globalization technique designed to improve the robustness of the Newton method. It recasts the steady-state problem $\\mathbf{F}(\\mathbf{U})=\\mathbf{0}$ as the long-time solution of a pseudo-transient problem $\\frac{d\\mathbf{U}}{dt} = -\\mathbf{F}(\\mathbf{U})$. Applying the implicit (backward) Euler discretization in pseudo-time with a step size $\\Delta t$ gives:\n$$ \\frac{\\mathbf{U}^{(k+1)} - \\mathbf{U}^{(k)}}{\\Delta t^{(k)}} = -\\mathbf{F}(\\mathbf{U}^{(k+1)}) $$\nLinearizing the term $\\mathbf{F}(\\mathbf{U}^{(k+1)})$ around the current iterate $\\mathbf{U}^{(k)}$ as $\\mathbf{F}(\\mathbf{U}^{(k+1)}) \\approx \\mathbf{F}(\\mathbf{U}^{(k)}) + \\mathbf{J}(\\mathbf{U}^{(k)})(\\mathbf{U}^{(k+1)} - \\mathbf{U}^{(k)})$ and rearranging yields the linear system for the update $\\delta^{(k)}$:\n$$ \\left( \\frac{1}{\\Delta t^{(k)}} \\mathbf{I} + \\mathbf{J}(\\mathbf{U}^{(k)}) \\right)\\, \\delta^{(k)} = -\\mathbf{F}(\\mathbf{U}^{(k)}) $$\nwhere $\\mathbf{I}$ is the identity matrix. The term $\\frac{1}{\\Delta t^{(k)}}\\mathbf{I}$ adds to the diagonal of the Jacobian, improving the diagonal dominance and hence the conditioning of the linear system, especially for small $\\Delta t^{(k)}$. This makes the method more robust against poor initial guesses. The adaptive time-stepping strategy allows the method to take small, cautious steps when convergence is slow (by decreasing $\\Delta t^{(k)}$) and larger, more aggressive Newton-like steps when convergence is fast (by increasing $\\Delta t^{(k)}$).\n\nFor both methods, the analytical Jacobian matrix $\\mathbf{J}$ must be constructed. The Jacobian has a $2 \\times 2$ block structure corresponding to the derivatives of the $\\theta$ and $y$ residuals with respect to the $\\theta$ and $y$ variables. The entries are derived by differentiating the residual equations $F_{\\theta,i}$ and $F_{y,i}$ with respect to the variables $\\theta_j$ and $y_j$. For interior nodes, this results in a banded structure from the finite difference stencil, plus off-diagonal terms from the nonlinear reaction coupling. The derivatives of the reaction term $R_i = \\mathrm{Da}\\, y_i\\, \\exp(-\\frac{\\beta}{1+\\gamma \\theta_i})$ are given as:\n$$ \\frac{\\partial R_i}{\\partial \\theta_i} = R_i \\frac{\\beta \\gamma}{(1+\\gamma \\theta_i)^2}, \\qquad \\frac{\\partial R_i}{\\partial y_i} = \\frac{R_i}{y_i} = \\mathrm{Da}\\, \\exp\\!\\left(-\\frac{\\beta}{1+\\gamma \\theta_i}\\right) $$\nFor the boundary nodes, the residual equations are linear, leading to constant $1$ entries on the diagonal of the Jacobian.\n\nThe overall implementation proceeds by defining functions to compute the residual vector $\\mathbf{F}(\\mathbf{U})$ and the Jacobian matrix $\\mathbf{J}(\\mathbf{U})$ for any given state $\\mathbf{U}$. Then, two separate solver functions implement the iterative loops for the Newton and PTC methods, respectively, including their specific termination criteria and logic. The initial guess is constructed from the given linear profiles. The program iterates through the three specified test cases, runs both solvers for each, and collects the final residual norm and iteration count for reporting. This comparison highlights the trade-offs between the rapid convergence of the Newton method and the superior robustness of the PTC method, particularly as the problem stiffness increases with parameters $\\mathrm{Da}$ and $\\beta$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a 1D premixed flame problem using Newton and PTC methods.\n    \"\"\"\n    # --- Problem Constants ---\n    N = 50\n    DZ = 1.0 / (N - 1)\n    DZ2 = DZ * DZ\n    Z = np.linspace(0, 1, N)\n    TOL = 1e-8\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case A (moderate stiffness)\n        {'Da': 10, 'beta': 5, 'gamma': 4, 'Le': 1, 'The_ad': 1},\n        # Case B (stiff)\n        {'Da': 50, 'beta': 12, 'gamma': 4, 'Le': 1, 'The_ad': 1},\n        # Case C (very stiff)\n        {'Da': 100, 'beta': 20, 'gamma': 4, 'Le': 1, 'The_ad': 1},\n    ]\n\n    # --- Helper Functions for Residual and Jacobian ---\n    \n    def compute_residual(U, params):\n        Da, beta, gamma, Le, The_ad = params['Da'], params['beta'], params['gamma'], params['Le'], params['The_ad']\n        theta = U[:N]\n        y = U[N:]\n        F = np.zeros(2 * N)\n\n        # Interior nodes\n        for i in range(1, N - 1):\n            # The reaction term argument can become large positive if (1+gamma*theta) is small or negative,\n            # leading to overflow in np.exp. Clamp the argument to a reasonable max value.\n            arg = -beta / (1.0 + gamma * theta[i]) if (1.0 + gamma * theta[i]) != 0 else np.inf\n            exp_term = np.exp(min(arg, 700)) if y[i]  0 else 0\n            R = Da * y[i] * exp_term\n            \n            F[i] = (theta[i-1] - 2*theta[i] + theta[i+1]) / DZ2 + R\n            F[N + i] = Le * (y[i-1] - 2*y[i] + y[i+1]) / DZ2 - R\n            \n        # Boundary conditions\n        F[0] = theta[0] - 0.0\n        F[N-1] = theta[N-1] - The_ad\n        F[N] = y[0] - 1.0\n        F[2*N-1] = y[N-1] - 0.0\n        \n        return F\n\n    def compute_jacobian(U, params):\n        Da, beta, gamma, Le = params['Da'], params['beta'], params['gamma'], params['Le']\n        theta = U[:N]\n        y = U[N:]\n        J = np.zeros((2 * N, 2 * N))\n\n        # Interior nodes\n        for i in range(1, N - 1):\n            denom = 1.0 + gamma * theta[i]\n            if denom = 0 or y[i]  0:\n                dRd_theta, dRd_y = 0.0, 0.0\n            else:\n                arg = -beta / denom\n                exp_term = np.exp(min(arg, 700))\n                dRd_theta = Da * y[i] * exp_term * (beta * gamma) / (denom * denom)\n                dRd_y = Da * exp_term\n\n            # Block dF_theta / d_theta\n            J[i, i-1] = 1.0 / DZ2\n            J[i, i] = -2.0 / DZ2 + dRd_theta\n            J[i, i+1] = 1.0 / DZ2\n            \n            # Block dF_theta / d_y\n            J[i, N + i] = dRd_y\n            \n            # Block dF_y / d_theta\n            J[N + i, i] = -dRd_theta\n            \n            # Block dF_y / d_y\n            J[N + i, N + i - 1] = Le / DZ2\n            J[N + i, N + i]     = -2.0 * Le / DZ2 - dRd_y\n            J[N + i, N + i + 1] = Le / DZ2\n\n        # Boundary conditions\n        J[0, 0] = 1.0\n        J[N-1, N-1] = 1.0\n        J[N, N] = 1.0\n        J[2*N-1, 2*N-1] = 1.0\n        \n        return J\n\n    # --- Solver Implementations ---\n    \n    def solve_newton(U_init, params):\n        max_iter = 50\n        U = U_init.copy()\n        \n        for k in range(max_iter):\n            F = compute_residual(U, params)\n            norm_F = np.linalg.norm(F)\n            \n            if norm_F = TOL:\n                return norm_F, k\n            \n            J = compute_jacobian(U, params)\n            \n            try:\n                delta = np.linalg.solve(J, -F)\n            except np.linalg.LinAlgError:\n                return norm_F, k\n            \n            U += delta\n            \n        final_norm = np.linalg.norm(compute_residual(U, params))\n        return final_norm, max_iter\n\n    def solve_ptc(U_init, params):\n        max_iter = 200\n        U = U_init.copy()\n        \n        dt = 1e-4\n        dt_min, dt_max = 1e-6, 1e2\n        \n        F_current = compute_residual(U, params)\n        norm_F_current = np.linalg.norm(F_current)\n\n        for k in range(max_iter):\n            if norm_F_current = TOL:\n                return norm_F_current, k\n            \n            J = compute_jacobian(U, params)\n            A = np.identity(2 * N) * (1.0 / dt) + J\n            \n            try:\n                delta = np.linalg.solve(A, -F_current)\n            except np.linalg.LinAlgError:\n                return norm_F_current, k\n            \n            U += delta\n            \n            F_next = compute_residual(U, params)\n            norm_F_next = np.linalg.norm(F_next)\n            \n            ratio = norm_F_next / norm_F_current if norm_F_current  1e-12 else 0.0\n            \n            if ratio  0.7:\n                dt = min(2.0 * dt, dt_max)\n            else:\n                dt = max(0.5 * dt, dt_min)\n            \n            F_current = F_next\n            norm_F_current = norm_F_next\n\n        return norm_F_current, max_iter\n\n    # --- Main Execution Logic ---\n    results = []\n    for case in test_cases:\n        theta0 = case['The_ad'] * Z\n        y0 = 1.0 - Z\n        U0 = np.concatenate([theta0, y0])\n        \n        res_N, iter_N = solve_newton(U0, case)\n        results.extend([res_N, iter_N])\n        \n        res_P, iter_P = solve_ptc(U0, case)\n        results.extend([res_P, iter_P])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}