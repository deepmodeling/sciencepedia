{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学中，对壁面边界层的处理是决定模拟成本和精度的核心环节。此练习将带您计算无量纲壁面距离 $y^+$，这是衡量近壁面网格分辨率的关键指标，它直接关系到我们是选择“壁面解析”方法还是“壁面模型”方法。通过亲手计算并解读 $y^+$ 值，您将深刻理解这两种主流湍流模拟策略的根本区别与适用条件 。",
            "id": "3941228",
            "problem": "一个在标准条件下充分发展的高雷诺数空气湍流槽道流将被模拟，以进行共轭传热分析。一次初步的壁面剪切测量得到了摩擦速度 $u_{\\tau}$，且空气的运动粘度 $\\nu$ 是已知的。当前的计算网格将第一个离壁单元的中心置于距离壁面 $y_1$ 的位置。在比较直接数值模拟(DNS)、大涡模拟(LES)和雷诺平均纳维-斯托克斯(RANS)方法的背景下，壁面模型的适用性取决于无量纲的近壁分辨率。\n\n从第一性原理出发，使用摩擦速度 $u_{\\tau}$ 和粘性长度尺度的定义，推导出以 $y_1$、$u_{\\tau}$ 和 $\\nu$ 表示的无量纲壁面坐标 $y_1^{+}$。然后，根据以下物理上一致的参数计算 $y_1^{+}$ 的值：\n- 摩擦速度 $u_{\\tau} = 0.50 \\ \\mathrm{m/s}$，\n- 运动粘度 $\\nu = 1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}$，\n- 第一单元中心法向离壁距离 $y_1 = 1.0 \\times 10^{-4} \\ \\mathrm{m}$。\n\n最后，根据壁湍流中经典的近壁结构和建模实践，解释在此分辨率下壁面模型是否适用于大涡模拟(LES)，并通过参考 $y_1^{+}$ 相对于已确立的近壁区域的位置来简要说明你的决定。\n\n将您计算的 $y_1^{+}$ 值四舍五入至四位有效数字。最终结果以纯数（无量纲）形式表示。最终答案必须仅为计算出的 $y_1^{+}$ 值。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 第1步：提取给定条件\n- 需要推导的定义：用 $y_1$、$u_{\\tau}$ 和 $\\nu$ 表示的无量纲壁面坐标 $y_1^{+}$。\n- 摩擦速度：$u_{\\tau} = 0.50 \\ \\mathrm{m/s}$。\n- 运动粘度：$\\nu = 1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}$。\n- 第一单元中心法向离壁距离：$y_1 = 1.0 \\times 10^{-4} \\ \\mathrm{m}$。\n- 要求的精度：将计算出的 $y_1^{+}$ 值四舍五入到四位有效数字。\n- 要求解释：评估在计算出的分辨率下，壁面模型对大涡模拟(LES)的适用性。\n\n### 第2步：使用提取的给定条件进行验证\n- **科学依据**：该问题在根本上是合理的。它涉及壁湍流理论中的标准概念，即摩擦速度、粘性长度尺度和无量纲壁面坐标 ($y^{+}$)。这些是计算流体动力学(CFD)中使用DNS、LES和RANS对湍流进行建模的基石概念。所提供的物理参数对于标准温度和压力下的空气是符合实际的。\n- **适定性**：该问题是适定的。它要求从第一性原理进行推导，使用所提供的数据进行数值计算，并基于该领域的既定实践进行解释。任务定义清晰，能够导出一个唯一且有意义的结果。\n- **客观性**：问题以精确、客观和定量的术语陈述。在定义或要求的任务中没有歧义。\n\n### 第3步：结论与行动\n该问题被认为是**有效的**，因为它具有科学依据、适定且客观。它不包含不一致之处、缺失信息或逻辑缺陷。将提供完整的解答。\n\n### 解答推导与计算\n\n第一步是推导无量纲壁面坐标 $y^{+}$ 的表达式。该坐标系用于表征湍流边界层近壁区域的流动结构。其标度化是基于主导该区域的物理量。\n\n在固体壁面附近（粘性底层）主导流体运动的关键物理量是壁面剪切应力 $\\tau_w$、流体密度 $\\rho$ 和流体运动粘度 $\\nu$。根据这些量，我们可以构建速度、长度和时间的特征尺度。\n\n特征速度尺度是摩擦速度 $u_{\\tau}$，其定义为：\n$$\nu_{\\tau} \\equiv \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n这个量的单位是速度 $[L T^{-1}]$。问题直接给出了 $u_{\\tau}$ 的值。\n\n近壁区域的特征长度尺度是粘性长度尺度，有时记作 $\\delta_{\\nu}$。它由摩擦速度 $u_{\\tau}$ 和运动粘度 $\\nu$ 组合而成，得到长度的量纲。各量的量纲为：\n- $[u_{\\tau}] = L T^{-1}$\n- $[\\nu] = L^2 T^{-1}$\n\n为了获得单位为长度 $[L]$ 的量，我们必须将 $\\nu$ 除以 $u_{\\tau}$：\n$$\n\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}} \\quad \\left( \\frac{[L^2 T^{-1}]}{[L T^{-1}]} = [L] \\right)\n$$\n这就是粘性长度尺度。它代表了粘性效应主导惯性效应的区域的大致厚度。\n\n无量纲壁面坐标 $y^{+}$ 定义为物理法向离壁距离 $y$ 用这个粘性长度尺度 $\\delta_{\\nu}$ 进行归一化：\n$$\ny^{+} = \\frac{y}{\\delta_{\\nu}}\n$$\n代入 $\\delta_{\\nu}$ 的表达式，我们得到所需的关系式：\n$$\ny^{+} = \\frac{y}{\\left(\\frac{\\nu}{u_{\\tau}}\\right)} = \\frac{y u_{\\tau}}{\\nu}\n$$\n对于第一个计算单元中心距壁面距离为 $y_1$ 的特定情况，其无量纲坐标记为 $y_1^{+}$：\n$$\ny_1^{+} = \\frac{y_1 u_{\\tau}}{\\nu}\n$$\n至此，从第一性原理的推导完成。\n\n接下来，我们使用给定的数值计算 $y_1^{+}$：\n- $y_1 = 1.0 \\times 10^{-4} \\ \\mathrm{m}$\n- $u_{\\tau} = 0.50 \\ \\mathrm{m/s}$\n- $\\nu = 1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}$\n\n将这些值代入推导出的公式中：\n$$\ny_1^{+} = \\frac{(1.0 \\times 10^{-4} \\ \\mathrm{m}) (0.50 \\ \\mathrm{m/s})}{1.5 \\times 10^{-5} \\ \\mathrm{m^2/s}}\n$$\n正如预期的那样，单位相互抵消，得到一个无量纲数：\n$$\n\\frac{\\mathrm{m} \\cdot \\mathrm{m/s}}{\\mathrm{m^2/s}} = 1\n$$\n现在，我们进行算术计算：\n$$\ny_1^{+} = \\frac{0.50 \\times 10^{-4}}{1.5 \\times 10^{-5}} = \\frac{0.50}{1.5} \\times 10^{(-4 - (-5))} = \\frac{1}{3} \\times 10^1 = \\frac{10}{3}\n$$\n值为 $y_1^{+} = 3.3333...$。按要求四舍五入到四位有效数字，得到：\n$$\ny_1^{+} \\approx 3.333\n$$\n\n### 关于大涡模拟(LES)壁面模型的解释\n\n大涡模拟(LES)中壁面模型的适用性，关键取决于第一个离壁网格点的放置位置，该位置由其 $y_1^{+}$ 值量化。湍流边界层的近壁区域通常根据其 $y^{+}$ 值分为几个区域：\n1.  **粘性底层**：对于 $y^{+} \\lesssim 5$，粘性剪切应力占主导地位，平均速度剖面是线性的 ($u^{+} = y^{+}$)。\n2.  **缓冲层**：对于 $5 \\lesssim y^{+} \\lesssim 30$，粘性应力和湍流（雷诺）应力都非常显著。这是一个复杂的过渡区域。\n3.  **对数律层（对数律区域）**：对于 $y^{+} \\gtrsim 30$（直到边界层厚度的某个分数），湍流应力占主导地位，平均速度剖面遵循对数律 ($u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$)。\n\nLES中的壁面模型旨在桥接边界层的内部区域，从而避免直接解析它所带来的高昂计算成本。这些模型几乎普遍基于一个假设，即第一个离壁网格点位于对数律层内，那里普适的壁面律成立。因此，应用标准壁面模型的一个先决条件是 $y_1^{+} \\gtrsim 30$。\n\n在本问题中，计算值为 $y_1^{+} \\approx 3.333$。这个值将第一个计算单元的中心完全置于**粘性底层**之内。在此位置，壁面模型所依赖的对数速度剖面的基本假设是无效的。在此分辨率下使用壁面模型将是不正确的，并会导致显著的建模误差。\n\n因此，对于此分辨率下的大涡模拟(LES)，壁面模型是**不合适的**。一个 $y_1^{+} \\approx 3.333$ 的网格是为**壁面解析**模拟而设计的，其中粘性层和缓冲层内的湍流结构至少部分由网格解析，而不是被建模。为了正确使用壁面模型，需要将近壁网格粗化，使第一个单元中心移动到对数律区域（例如，$y_1^{+} > 30$）。",
            "answer": "$$\n\\boxed{3.333}\n$$"
        },
        {
            "introduction": "在了解了直接数值模拟（DNS）对近壁面区域的苛刻解析要求后，一个自然而然的问题是：这种高保真度的代价究竟有多大？本练习通过一个经典的尺度分析，将动量场的科尔莫戈洛夫尺度（$\\eta$）和高普朗特数（$Pr$）下温度场的白切勒尺度（$\\eta_B$）与计算成本直接关联起来。通过推导，您将得出一个极具启发性的结论，量化解析精细热结构所带来的指数级计算量增长，从而体会到发展大涡模拟（LES）和雷诺平均（RANS）等实用模型的必要性 。",
            "id": "3941206",
            "problem": "在一个通过直接数值模拟 (DNS) 求解的三维不可压缩湍流中，您最初模拟了一个等温情况，其网格间距 $\\Delta x_{0}$ 被选择用于解析 Kolmogorov 长度尺度 $\\eta$。现在，您加入温度作为一个输运标量，其 Prandtl 数为 $Pr = 7$，并要求温度场也必须得到 DNS 解析。大涡模拟 (LES) 和雷諾平均纳维-斯托克斯 (RANS) 是分辨率要求更粗糙的替代方法，但此处我们专注于 DNS 范畴。\n\n使用以下基本依据：\n- Prandtl 数为 $Pr = \\nu / \\alpha$，其中 $\\nu$ 是运动粘度，$\\alpha$ 是热扩散率。\n- Kolmogorov 长度尺度是 $\\eta$，即湍流中动量的最小动态活动尺度。\n- 对于 $Pr \\ge 1$，扩散率小于粘度的标量的 Batchelor 尺度为 $\\eta_{B} = \\eta / \\sqrt{Pr}$。\n- 一个完全解析的 DNS 要求网格间距 $\\Delta x$ 与最小相关物理尺度处于同一数量级（即，对于动量，$\\Delta x_{0} \\sim \\eta$；对于 $Pr \\ge 1$ 时的温度，$\\Delta x_{T} \\sim \\eta_{B}$）。\n- 对于边长固定的立方体域 $L$，网格点数与 $(L / \\Delta x)^{3}$ 成比例。\n- 对于由对流 Courant–Friedrichs–Lewy (CFL) 准則主导的显式时间积分，稳定时间步长与 $\\Delta t \\propto \\Delta x / U$ 成比例，其中 $U$ 是一个与 $\\Delta x$ 无关的特征速度尺度。\n\n假设以下条件以分离由分辨率驱动的计算效应：\n- 添加温度时，域尺寸 $L$ 和特征速度尺度 $U$ 保持不变。\n- 每个时间步的成本与网格点数成正比，并且在此估算中忽略了温度方程本身的任何额外代数成本。\n- 在添加温度前后，时间步长均受对流 CFL 限制（即，在所选分辨率下，粘性扩散和热扩散的稳定性限制不会施加更严格的约束）。\n\n从这些基本依据出发，推导当添加 Prandtl 数为 $Pr = 7$ 的输运标量温度时，总计算成本（网格点数乘以达到固定物理时间所需的时间步数）的乘性增长。此增长纯粹是由于更小的 $\\eta_{B}$ 以及在更精细的分辨率下由对流 CFL 带来的更严格的 $\\Delta t$ 所致。请将您的最终答案表示为一个纯数字（无单位）。無需四舍五入；请提供精确值。",
            "solution": "该问题是有效的，因为它具有科学依据、问题设定良好且客观。它提供了一套一致的物理和计算比例定律，用以确定在直接数值模拟 (DNS) 中添加高 Prandtl 数标量时计算成本的增长。\n\n令 $C$ 表示总计算成本。根据问题陈述，模拟固定物理时间 $T_{final}$ 的总成本是网格点数 $N$ 和时间步数 $M$ 的乘积。\n$$C \\propto N \\times M$$\n下标 $0$ 和 $T$ 将分别用于表示初始等温情况和最终有温度的情况。我们旨在求出比率 $\\frac{C_T}{C_0}$。\n\n首先，我们建立网格点数 $N$ 的比例关系。对于边长固定的立方体域 $L$ 和均匀的网格间距 $\\Delta x$，三维空间中的网格点数按以下方式缩放：\n$$N \\propto \\left(\\frac{L}{\\Delta x}\\right)^3 \\propto (\\Delta x)^{-3}$$\n问题陈述指出，一个完全解析的 DNS 要求网格间距 $\\Delta x$ 与最小相关物理尺度处于同一数量级。对于初始等温情况，最小尺度是 Kolmogorov 长度尺度 $\\eta$。因此，网格间距为 $\\Delta x_0 \\propto \\eta$。对于 Prandtl 数 $Pr > 1$ 的最终有温度的情况，最小尺度是 Batchelor 尺度 $\\eta_B$。网格间距必须细化至 $\\Delta x_T \\propto \\eta_B$。\n问题给出了对于 $Pr \\ge 1$ 的关系式 $\\eta_B = \\frac{\\eta}{\\sqrt{Pr}}$。两种情况下网格点数的比值为：\n$$\\frac{N_T}{N_0} = \\frac{(\\Delta x_T)^{-3}}{(\\Delta x_0)^{-3}} = \\left(\\frac{\\Delta x_0}{\\Delta x_T}\\right)^3$$\n由于 $\\Delta x_0 \\propto \\eta$ 且 $\\Delta x_T \\propto \\eta_B$，网格间距的比值为：\n$$\\frac{\\Delta x_0}{\\Delta x_T} \\propto \\frac{\\eta}{\\eta_B} = \\frac{\\eta}{\\eta/\\sqrt{Pr}} = \\sqrt{Pr}$$\n将此代入 $N$ 的比值中：\n$$\\frac{N_T}{N_0} = \\left(\\sqrt{Pr}\\right)^3 = Pr^{\\frac{3}{2}}$$\n\n接下来，我们建立时间步数 $M$ 的比例关系。要用时间步长 $\\Delta t$ 达到固定的物理时间 $T_{final}$，所需的步数为 $M = \\frac{T_{final}}{\\Delta t}$。因此，$M \\propto (\\Delta t)^{-1}$。\n问题陈述指出，时间步长受对流 Courant–Friedrichs–Lewy (CFL) 准则的限制，其比例关系为 $\\Delta t \\propto \\frac{\\Delta x}{U}$。由于特征速度 $U$ 假定为常数，我们有 $\\Delta t \\propto \\Delta x$。\n因此，时间步数按以下方式缩放：\n$$M \\propto (\\Delta x)^{-1}$$\n两种情况下时间步数的比值为：\n$$\\frac{M_T}{M_0} = \\frac{(\\Delta t_T)^{-1}}{(\\Delta t_0)^{-1}} = \\frac{\\Delta t_0}{\\Delta t_T} = \\frac{\\Delta x_0}{\\Delta x_T}$$\n如前所述，此比值为 $\\sqrt{Pr}$：\n$$\\frac{M_T}{M_0} = \\sqrt{Pr} = Pr^{\\frac{1}{2}}$$\n\n最后，我们计算总计算成本的乘性增长，即比率 $\\frac{C_T}{C_0}$。\n$$\\frac{C_T}{C_0} = \\frac{N_T \\times M_T}{N_0 \\times M_0} = \\left(\\frac{N_T}{N_0}\\right) \\times \\left(\\frac{M_T}{M_0}\\right)$$\n代入上面推導出的比例关系：\n$$\\frac{C_T}{C_0} = \\left(Pr^{\\frac{3}{2}}\\right) \\times \\left(Pr^{\\frac{1}{2}}\\right) = Pr^{\\frac{3}{2} + \\frac{1}{2}} = Pr^2$$\n因此，总计算成本的乘性增长等于 Prandtl 数的平方。\n\n问题提供了值 $Pr=7$。将此值代入我们推导的表达式中：\n$$\\text{成本增长} = 7^2 = 49$$\n因此，在指定假设下，与等温情况相比，解析 $Pr=7$ 的温度场需要将总计算资源增加 49 倍。",
            "answer": "$$\n\\boxed{49}\n$$"
        },
        {
            "introduction": "既然直接数值模拟的成本如此高昂，工程师们在实践中广泛采用依赖于壁面函数的大涡模拟（LES）和雷诺平均（RANS）模型。本压轴练习旨在量化这一工程决策所带来的影响，您将通过编程实现一个模型，该模型将基于壁面律的传热估算与公认的工程关联式（Gnielinski 关联式）进行对比。通过这个练习，您将把抽象的网格参数 $y^+$ 与具体的工程预测量（努塞尔数 $Nu$）的误差直接联系起来，从而获得评估和优化传热模拟精度的实用技能 。",
            "id": "3941243",
            "problem": "您需要通过比较两个具有不同壁面坐标 $y^+$ 值的网格，并计算相对于参考值的误差估计，来量化无量纲努塞尔数对近壁面分辨率的敏感性。请在计算热工学中一个标准的典型配置下进行分析：在壁温恒定的光滑圆管内，流动为充分发展的湍流，且热场也为充分发展的内部流动。\n\n使用一个基于原理的模型，其中参考努塞尔数由经过充分检验的湍流传热关联式推断得出，而近壁面分辨率的依赖性则通过与典型壁面温度律相关的壁面函数估计引入。解决方案应从以下基本基础开始：\n- 努塞尔数 $Nu$ 的定义为 $Nu = h D / k$，其中 $h$ 是对流传热系数，$D$ 是水力直径，$k$ 是导热系数。\n- 使用温度壁面单位 $\\Theta^+ = (T_w - T)/T_\\tau$ 对近壁面湍流输运进行内区标度，其中 $T_\\tau = q_w/(\\rho c_p u_\\tau)$ 是由壁面热通量 $q_w$、密度 $\\rho$、比热容 $c_p$ 和摩擦速度 $u_\\tau$ 构建的温度标度。\n- 温度的复合壁面律形式为 $\\Theta^+(y^+)$，对于小的 $y^+$ 有粘性子层，对于较大的 $y^+$ 有对数律层。\n- 参考努塞尔数 $Nu_{\\text{ref}}$ 从一个针对光滑管道的、经过充分验证的稳健关联式计算得出，以便近似壁面解析的高保真度计算的行为。您可以采用 Gnielinski 关联式作为一个经过充分检验的基础。\n\n假设采用以下复合壁面温度律和常数：\n- 粘性子层：对于 $y^+ \\le y_{\\text{crit}}$，$\\Theta^+(y^+) = y^+$。\n- 对数律层：对于 $y^+ > y_{\\text{crit}}$，$\\Theta^+(y^+) = \\dfrac{1}{\\kappa \\, Pr_t} \\ln(y^+) + B_t$。\n- 冯·卡门常数 $\\kappa = 0.41$（无量纲）。\n- 湍流普朗特数 $Pr_t = 0.85$（无量纲）。\n- 温度对数律加性常数 $B_t = 3.5$（无量纲）。\n- 过渡位置 $y_{\\text{crit}} = 11.8$（无量纲内区单位）。\n- 所有对数运算均使用自然对数 $\\ln(\\cdot)$。\n\n在常见的壁面函数实践中，即根据第一个离壁点的数值估计近壁面梯度，通过比值 $\\Theta^+(y^+)/y^+$ 来近似壁面处的无量纲温度梯度。通过将其与粘性子层内精确的梯度值 $1$（在内区单位下）进行比较，将估计的壁面热通量（因此也包括 $Nu$）中的乘性偏差建模为\n$$\nr(y^+) = \\frac{\\Theta^+(y^+)}{y^+}.\n$$\n因此，将与网格相关的努塞尔数估计值定义为\n$$\nNu_{\\text{est}}(y^+) = r(y^+) \\, Nu_{\\text{ref}}.\n$$\n对于第一个单元中心位置为 $y^+$ 的网格，将其相对误差（以小数形式，而非百分比）定义为\n$$\ne(y^+) = \\frac{Nu_{\\text{est}}(y^+) - Nu_{\\text{ref}}}{Nu_{\\text{ref}}} = r(y^+) - 1.\n$$\n\n使用 Gnielinski 关联式为每个测试用例计算参考努塞尔数 $Nu_{\\text{ref}}$。该关联式是针对湍流范围内的 $Re$ 和 $Pr$ 的一个经过充分检验的公式：\n- 摩擦因子由 Petukhov 关联式给出：\n$$\nf = \\left(0.79 \\, \\ln(Re) - 1.64\\right)^{-2},\n$$\n适用于 $Re \\in [3\\times 10^3, 5\\times 10^6]$。\n- Gnielinski 关联式：\n$$\nNu_{\\text{ref}} = \\frac{(f/8)\\,(Re - 1000)\\,Pr}{1 + 12.7 \\sqrt{f/8}\\,\\left(Pr^{2/3} - 1\\right)},\n$$\n适用于 $Pr \\in [0.5, 2000]$ 以及上述 $Re$ 范围。\n\n对于每个测试用例，给定两个网格，其特征是它们的第一个离壁点位置 $y^+_1$ 和 $y^+_2$。对每个网格，计算 $e(y^+_1)$ 和 $e(y^+_2)$。通过相对于 $y^+$ 对数的有限差分斜率来量化误差对近壁面分辨率的敏感性，\n$$\ns = \\frac{e(y^+_2) - e(y^+_1)}{\\ln\\!\\left(\\frac{y^+_2}{y^+_1}\\right)}.\n$$\n\n实现一个程序，为每个测试用例返回一个包含四个浮点数的列表：\n- $Nu_{\\text{ref}}$，\n- $e(y^+_1)$，\n- $e(y^+_2)$，\n- $s$。\n\n您的程序应生成单行输出，其中包含所有测试用例的结果，形式为由方括号括起来的、逗号分隔的列表之列表，例如 $\\left[ [\\dots], [\\dots] \\right]$。\n\n使用以下测试套件，它涵盖了典型工况和边界情况：\n- 工况 A（类空气，中等湍流，壁面解析与壁面模型对比）：$Re = 1.0\\times 10^5$，$Pr = 0.71$，$y^+_1 = 1.0$，$y^+_2 = 30.0$。\n- 工况 B（类水，高 $Pr$ 数，强近壁面梯度）：$Re = 2.0\\times 10^5$，$Pr = 7.0$，$y^+_1 = 1.0$，$y^+_2 = 100.0$。\n- 工况 C（以缓冲层边缘作为粗网格）：$Re = 5.0\\times 10^4$，$Pr = 2.0$，$y^+_1 = 0.5$，$y^+_2 = 12.0$。\n- 工况 D（极高 $Re$ 数，非常粗糙的近壁面采样）：$Re = 1.0\\times 10^6$，$Pr = 0.70$，$y^+_1 = 2.0$，$y^+_2 = 300.0$。\n\n所有量均为无量纲；无需物理单位。不涉及角度。所有最终数值答案均以浮点数表示。最终输出格式必须是严格的单行，即一个 Python 列表之列表的字符串表示，不得包含任何额外文本。",
            "solution": "该问题要求在计算流体动力学（CFD）的背景下，分析预测的努塞尔数 $Nu$ 对近壁面网格分辨率的敏感性。这是通过利用管道中湍流传热的典型模型来完成的。分析的核心在于将基于壁面函数模型推导出的努塞尔数估计值 $Nu_{\\text{est}}$ 与一个高保真度的参考值 $Nu_{\\text{ref}}$进行比较。这两个量之间的差异是衡量因近壁面网格分辨率不足而引入的误差的直接指标。\n\n整个分析均使用无量纲量进行，这是流体力学和传热学中为实现通用性而采用的标准做法。关键的无量纲参数是雷诺数 $Re$、普朗特数 $Pr$ 和无量纲壁面距离 $y^+$。\n\n首先，我们建立精确解的基准。参考努塞尔数 $Nu_{\\text{ref}}$ 使用 Gnielinski 关联式计算，这是一个针对光滑圆管中充分发展湍流的、经过充分验证的经验公式。该关联式依赖于 $Re$ 和 $Pr$。它首先需要达西摩擦因子 $f$，我们为此使用 Petukhov 关联式，其适用范围为 $Re \\in [3\\times 10^3, 5\\times 10^6]$：\n$$\nf = \\left(0.79 \\, \\ln(Re) - 1.64\\right)^{-2}\n$$\n有了摩擦因子 $f$，Gnielinski 关联式为 $Pr \\in [0.5, 2000]$ 提供了参考努塞尔数：\n$$\nNu_{\\text{ref}} = \\frac{(f/8)\\,(Re - 1000)\\,Pr}{1 + 12.7 \\sqrt{f/8}\\,\\left(Pr^{2/3} - 1\\right)}\n$$\n这个 $Nu_{\\text{ref}}$ 作为我们的“基准真相”，代表了人们期望从非常精细的、壁面解析的模拟或精确实验中得到的结果。\n\n接下来，我们对由粗糙近壁面网格引入的误差进行建模。在许多 CFD 模拟中，特别是在使用雷诺平均纳维-斯托克斯（RANS）模型时，要解析壁面附近薄的粘性子层，其计算成本过高。因此，使用“壁面函数”来桥接壁面与第一个计算网格点之间的区域。这种方法的准确性关键取决于这个首个网格点的位置，由其 $y^+$ 值指定。\n\n该分析基于壁面温度律，它描述了无量纲温度剖面 $\\Theta^+(y^+) = (T_w - T)/T_\\tau$ 作为无量纲壁面距离 $y^+$ 的函数。这里，$T_w$ 是壁面温度，$T$ 是当地流体温度，$T_\\tau = q_w/(\\rho c_p u_\\tau)$ 是基于壁面热通量 $q_w$ 的摩擦温度。问题指定了一个 $\\Theta^+$ 的复合剖面：\n- 在粘性子层中，对于 $y^+ \\le y_{\\text{crit}} = 11.8$：\n$$\n\\Theta^+(y^+) = y^+\n$$\n- 在对数律层中，对于 $y^+ > y_{\\text{crit}} = 11.8$：\n$$\n\\Theta^+(y^+) = \\frac{1}{\\kappa \\, Pr_t} \\ln(y^+) + B_t\n$$\n给定的常数为 $\\kappa = 0.41$，$Pr_t = 0.85$ 和 $B_t = 3.5$。\n\n与努塞尔数成正比的壁面热通量 $q_w$，是由壁面处的温度梯度计算得出的。在无量纲形式下，这对应于 $y^+=0$ 处的梯度 $d\\Theta^+/dy^+$。在粘性子层中，该梯度精确为 $1$。一种常见的壁面函数实践是使用第一个网格点 $y^+_p$ 处的温度来近似这个梯度，即 $(d\\Theta^+/dy^+)|_0 \\approx \\Theta^+(y^+_p) / y^+_p$。因此，计算出的热通量中的乘性偏差，或误差因子，是近似梯度与精确梯度的比值：\n$$\nr(y^+) = \\frac{\\text{近似梯度}}{\\text{精确梯度}} = \\frac{\\Theta^+(y^+)/y^+}{1} = \\frac{\\Theta^+(y^+)}{y^+}\n$$\n这个因子直接转化为努塞尔数的偏差，使得 $Nu_{\\text{est}}(y^+) = r(y^+) \\, Nu_{\\text{ref}}$。\n\n相对误差 $e(y^+)$ 随后被定义为估计的努塞尔数相对于参考值的偏差分数：\n$$\ne(y^+) = \\frac{Nu_{\\text{est}}(y^+) - Nu_{\\text{ref}}}{Nu_{\\text{ref}}} = \\frac{r(y^+) \\, Nu_{\\text{ref}} - Nu_{\\text{ref}}}{Nu_{\\text{ref}}} = r(y^+) - 1\n$$\n通过代入 $\\Theta^+(y^+)$ 的表达式，我们可以为任何给定的 $y^+$ 计算误差：\n- 对于 $y^+ \\le y_{\\text{crit}}$：$e(y^+) = (y^+ / y^+) - 1 = 0$。这意味着，如果第一个单元位于粘性子层内，这个特定的壁面函数模型预测的误差为零。\n- 对于 $y^+ > y_{\\text{crit}}$：$e(y^+) = \\left(\\frac{1}{y^+}\\left(\\frac{1}{\\kappa Pr_t} \\ln(y^+) + B_t\\right)\\right) - 1$。这表明对于粗网格 ($y^+ > y_{\\text{crit}}$)，误差取决于第一个网格点的放置位置。\n\n最后，为了量化此误差对近壁面分辨率变化的敏感性，我们计算了误差相对于 $y^+$ 对数的导数的有限差分近似。这是一个自然的选择，因为湍流剖面在 $y^+$ 上是对数的。给定两个具有首个单元位置 $y^+_1$ 和 $y^+_2$ 的网格，敏感度 $s$ 为：\n$$\ns = \\frac{e(y^+_2) - e(y^+_1)}{\\ln(y^+_2) - \\ln(y^+_1)} = \\frac{e(y^+_2) - e(y^+_1)}{\\ln(y^+_2 / y^+_1)}\n$$\n$s$ 的绝对值越大，表明建模误差对近壁面网格间距的变化越敏感。\n\n每个测试用例的计算步骤如下：\n1.  给定 $Re$ 和 $Pr$，使用 Petukhov 关联式计算摩擦因子 $f$。\n2.  使用 $f$、$Re$ 和 $Pr$，通过 Gnielinski 公式计算参考努塞尔数 $Nu_{\\text{ref}}$。该值与网格参数 $y^+_1$ 和 $y^+_2$ 无关。\n3.  对于 $y^+_1$，通过先根据 $y^+_1 \\le y_{\\text{crit}}$ 或 $y^+_1 > y_{\\text{crit}}$ 计算 $\\Theta^+(y^+_1)$，然后使用 $e(y^+_1) = \\Theta^+(y^+_1)/y^+_1 - 1$ 来计算误差 $e(y^+_1)$。\n4.  类似地，为分辨率为 $y^+_2$ 的网格计算误差 $e(y^+_2)$。\n5.  使用 $e(y^+_1)$、$e(y^+_2)$、$y^+_1$ 和 $y^+_2$ 的值计算敏感度 $s$。\n6.  收集四个计算值：$[Nu_{\\text{ref}}, e(y^+_1), e(y^+_2), s]$。\n然后对所有指定的测试用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes sensitivity of Nusselt number to near-wall resolution\n    for several test cases in turbulent pipe flow.\n    \"\"\"\n\n    # Define physical and model constants from the problem statement.\n    KAPPA = 0.41  # Von Kármán constant\n    PR_T = 0.85   # Turbulent Prandtl number\n    B_T = 3.5     # Temperature log-law additive constant\n    Y_CRIT = 11.8 # Crossover y+ from viscous sublayer to log layer\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Re, Pr, y_plus_1, y_plus_2)\n        (1.0e5, 0.71, 1.0, 30.0),   # Case A\n        (2.0e5, 7.0, 1.0, 100.0),  # Case B\n        (5.0e4, 2.0, 0.5, 12.0),   # Case C\n        (1.0e6, 0.70, 2.0, 300.0),  # Case D\n    ]\n\n    def calculate_nu_ref(Re, Pr):\n        \"\"\"\n        Calculates the reference Nusselt number using the Gnielinski correlation.\n        \"\"\"\n        # Petukhov correlation for friction factor f\n        f = (0.79 * np.log(Re) - 1.64)**(-2)\n\n        # Gnielinski correlation for Nu_ref\n        f_over_8 = f / 8.0\n        numerator = f_over_8 * (Re - 1000.0) * Pr\n        denominator = 1.0 + 12.7 * np.sqrt(f_over_8) * (Pr**(2.0/3.0) - 1.0)\n        \n        return numerator / denominator\n\n    def calculate_theta_plus(y_plus):\n        \"\"\"\n        Calculates the dimensionless temperature Theta+ based on the composite law of the wall.\n        \"\"\"\n        if y_plus = Y_CRIT:\n            # Viscous sublayer\n            return y_plus\n        else:\n            # Logarithmic layer\n            return (1.0 / (KAPPA * PR_T)) * np.log(y_plus) + B_T\n            \n    def calculate_relative_error(y_plus):\n        \"\"\"\n        Calculates the relative error e(y+) based on the wall function model.\n        e(y+) = r(y+) - 1, where r(y+) = Theta+(y+)/y+\n        \"\"\"\n        theta_p = calculate_theta_plus(y_plus)\n        r_y_plus = theta_p / y_plus\n        return r_y_plus - 1.0\n        \n    def calculate_sensitivity(e1, e2, y_plus1, y_plus2):\n        \"\"\"\n        Calculates the sensitivity s of the error to the log of the wall coordinate.\n        \"\"\"\n        # s = (e2 - e1) / ln(y2/y1) = (e2 - e1) / (ln(y2) - ln(y1))\n        return (e2 - e1) / np.log(y_plus2 / y_plus1)\n\n    results = []\n    for case in test_cases:\n        Re, Pr, y_plus1, y_plus2 = case\n        \n        # 1. Calculate the reference Nusselt number\n        nu_ref = calculate_nu_ref(Re, Pr)\n        \n        # 2. Calculate the relative error for the first grid\n        e1 = calculate_relative_error(y_plus1)\n        \n        # 3. Calculate the relative error for the second grid\n        e2 = calculate_relative_error(y_plus2)\n        \n        # 4. Calculate the sensitivity\n        s = calculate_sensitivity(e1, e2, y_plus1, y_plus2)\n        \n        # Append the list of four floats to the main results list\n        results.append([nu_ref, e1, e2, s])\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}