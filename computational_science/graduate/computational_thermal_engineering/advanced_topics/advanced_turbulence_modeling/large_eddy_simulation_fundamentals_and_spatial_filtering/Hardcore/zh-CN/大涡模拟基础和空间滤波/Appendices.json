{
    "hands_on_practices": [
        {
            "introduction": "空间滤波是大涡模拟（LES）的基石，它将流场分解为已解析的大尺度结构和需要建模的小尺度结构。本练习通过一个基础但极具启发性的例子，让你亲手实践滤波操作。你将对一个简单的正弦波场应用“帽型”滤波器，通过解析计算，直观地理解滤波过程如何衰减不同尺度的涡，并引出描述这种衰减特性的关键概念——传递函数。",
            "id": "3338942",
            "problem": "在大涡模拟（LES）中，空间滤波通过场与滤波核的卷积来定义。考虑一个一维空间均匀滤波器，其核函数 $G(x;\\Delta)$ 为宽度为 $\\Delta$ 的紧支集，并将滤波后的场 $\\bar{\\phi}(x)$ 定义为卷积 $\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(r;\\Delta)\\,\\phi(x-r)\\,dr$。取箱式核 $G(x;\\Delta) = \\Delta^{-1}\\,\\mathbb{1}_{|x| \\le \\Delta/2}$ 和标量场 $\\phi(x) = \\sin(k x)$，其中 $k$ 是实波数。仅从卷积的定义和基本三角恒等式出发，推导 $\\bar{\\phi}(x)$ 作为 $k$、$\\Delta$ 和 $x$ 的函数的闭式表达式。然后，将有效谱截断波数 $k_c$ 定义为使滤波器一维传递函数幅值消失的最小正波数 $k$，并表示出相应的无量纲积 $k_c \\Delta$。将你的最终答案以单行向量的形式给出，其第一个条目是 $\\bar{\\phi}(x)$ 的精确表达式，第二个条目是 $k_c \\Delta$ 的精确值。无需四舍五入，最终答案中不应包含单位。",
            "solution": "在尝试求解之前，对问题陈述进行了严格验证。\n\n### 步骤 1：提取已知条件\n- **空间滤波的定义：** 滤波后的场 $\\bar{\\phi}(x)$ 是场 $\\phi(x)$ 与滤波核 $G(x;\\Delta)$ 的卷积：$\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(r;\\Delta)\\,\\phi(x-r)\\,dr$。\n- **滤波核：** 一维箱式滤波核，$G(x;\\Delta) = \\Delta^{-1}\\,\\mathbb{1}_{|x| \\le \\Delta/2}$，其中 $\\mathbb{1}$ 是指示函数，$\\Delta$ 是滤波器宽度。\n- **标量场：** 单一波数的正弦场，$\\phi(x) = \\sin(k x)$，其中 $k$ 是实波数。\n- **截断波数的定义：** 有效谱截断波数 $k_c$ 是使滤波器一维传递函数幅值消失的最小正波数 $k$。\n- **任务：** 推导 $\\bar{\\phi}(x)$ 的闭式表达式，并求出无量纲积 $k_c \\Delta$ 的值。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学基础：** 该问题是大涡模拟（LES）数学基础中的一个标准练习，LES是计算流体力学的一个主要课题。卷积、滤波核和传递函数的概念是信号处理和湍流理论中的基本原理。\n- **适定性：** 所有必要的函数（$G$, $\\phi$）、定义（卷积, $k_c$）和约束都已提供。问题是自洽的，其结构可以得出一个唯一的解。\n- **客观性：** 语言正式且精确，没有主观或含糊的陈述。\n- **未检测到其他缺陷：** 问题并非不健全、不完整、矛盾、不切实际或不适定。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供一个完整、有理有据的解答。\n\n### 求解推导\n第一步是通过计算卷积积分来推导滤波后场 $\\bar{\\phi}(x)$ 的表达式。\n滤波后场的定义为：\n$$\n\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(r;\\Delta)\\,\\phi(x-r)\\,dr\n$$\n将给定的滤波核 $G(r;\\Delta)$ 和标量场 $\\phi(x)$ 的表达式代入：\n$$\n\\bar{\\phi}(x) = \\int_{-\\infty}^{\\infty} \\left(\\frac{1}{\\Delta}\\,\\mathbb{1}_{|r| \\le \\Delta/2}\\right) \\sin(k(x-r))\\,dr\n$$\n指示函数 $\\mathbb{1}_{|r| \\le \\Delta/2}$ 在 $-\\Delta/2 \\le r \\le \\Delta/2$ 时等于 $1$，否则等于 $0$。此属性限制了积分的上下限：\n$$\n\\bar{\\phi}(x) = \\frac{1}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\sin(k(x-r))\\,dr\n$$\n为计算此积分，我们使用差角正弦的三角恒等式：$\\sin(A-B) = \\sin(A)\\cos(B) - \\cos(A)\\sin(B)$。令 $A = kx$ 且 $B = kr$。\n$$\n\\sin(k(x-r)) = \\sin(kx)\\cos(kr) - \\cos(kx)\\sin(kr)\n$$\n将此式代入积分中：\n$$\n\\bar{\\phi}(x) = \\frac{1}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\left[ \\sin(kx)\\cos(kr) - \\cos(kx)\\sin(kr) \\right]\\,dr\n$$\n由于 $\\sin(kx)$ 和 $\\cos(kx)$ 不依赖于积分变量 $r$，它们可以从积分中提出：\n$$\n\\bar{\\phi}(x) = \\frac{\\sin(kx)}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\cos(kr)\\,dr - \\frac{\\cos(kx)}{\\Delta} \\int_{-\\Delta/2}^{\\Delta/2} \\sin(kr)\\,dr\n$$\n现在我们分别计算这两个积分。\n第一个积分涉及在一个对称区间上对偶函数 $\\cos(kr)$ 进行积分：\n$$\n\\int_{-\\Delta/2}^{\\Delta/2} \\cos(kr)\\,dr = \\left[ \\frac{\\sin(kr)}{k} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{\\sin(k\\Delta/2)}{k} - \\frac{\\sin(-k\\Delta/2)}{k}\n$$\n由于 $\\sin(-z) = -\\sin(z)$，该式可简化为：\n$$\n\\frac{\\sin(k\\Delta/2)}{k} + \\frac{\\sin(k\\Delta/2)}{k} = \\frac{2}{k} \\sin\\left(\\frac{k\\Delta}{2}\\right)\n$$\n第二个积分涉及在一个对称区间上对奇函数 $\\sin(kr)$ 进行积分。这样的积分总是为零。我们可以明确地验证这一点：\n$$\n\\int_{-\\Delta/2}^{\\Delta/2} \\sin(kr)\\,dr = \\left[ -\\frac{\\cos(kr)}{k} \\right]_{-\\Delta/2}^{\\Delta/2} = -\\frac{\\cos(k\\Delta/2)}{k} - \\left(-\\frac{\\cos(-k\\Delta/2)}{k}\\right)\n$$\n由于 $\\cos(-z) = \\cos(z)$，该式可简化为：\n$$\n-\\frac{\\cos(k\\Delta/2)}{k} + \\frac{\\cos(k\\Delta/2)}{k} = 0\n$$\n将这些结果代回 $\\bar{\\phi}(x)$ 的表达式中：\n$$\n\\bar{\\phi}(x) = \\frac{\\sin(kx)}{\\Delta} \\left( \\frac{2}{k} \\sin\\left(\\frac{k\\Delta}{2}\\right) \\right) - \\frac{\\cos(kx)}{\\Delta} (0)\n$$\n$$\n\\bar{\\phi}(x) = \\frac{2}{k\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) \\sin(kx)\n$$\n这个表达式可以方便地重写以突出滤波器的传递函数。通过重新排列各项，我们得到了所需答案的第一部分：\n$$\n\\bar{\\phi}(x) = \\frac{\\sin(k\\Delta/2)}{k\\Delta/2} \\sin(kx)\n$$\n\n第二步是确定无量纲积 $k_c \\Delta$。\n将滤波器应用于单个傅里叶模态 $\\exp(ikx)$ 会导致该模态乘以滤波器的传递函数 $\\hat{G}(k)$。对于像 $\\phi(x) = \\sin(kx)$ 这样的实值场，假设核函数 $G(x)$ 是实偶函数（对于箱式核是成立的），则滤波后的场为 $\\bar{\\phi}(x) = \\hat{G}(k)\\phi(x)$。\n通过将我们推导出的 $\\bar{\\phi}(x)$ 表达式与形式 $\\hat{G}(k)\\phi(x) = \\hat{G}(k)\\sin(kx)$ 进行比较，我们可以确定传递函数：\n$$\n\\hat{G}(k) = \\frac{\\sin(k\\Delta/2)}{k\\Delta/2}\n$$\n这是归一化的sinc函数，$\\text{sinc}(k\\Delta/2)$。\n根据问题定义，$k_c$ 是使传递函数幅值 $|\\hat{G}(k)|$ 为零的最小正波数 $k$。由于 $\\hat{G}(k)$ 是实数，这等价于找到使 $\\hat{G}(k) = 0$ 的最小正波数 $k$。\n$$\n\\frac{\\sin(k_c\\Delta/2)}{k_c\\Delta/2} = 0\n$$\n要使此表达式为零，分子必须为零，而分母不为零（排除了 $k_c=0$ 的情况，因为我们寻找的是正波数，并且在极限 $k\\to 0$ 时，$\\hat{G}(k) \\to 1$）。\n因此，条件是：\n$$\n\\sin\\left(\\frac{k_c\\Delta}{2}\\right) = 0\n$$\n$\\sin(\\theta) = 0$ 的通解是 $\\theta = n\\pi$，其中 $n$ 为任意整数。因此：\n$$\n\\frac{k_c\\Delta}{2} = n\\pi, \\quad n \\in \\mathbb{Z}\n$$\n我们寻找最小的正波数 $k_c$。由于滤波器宽度 $\\Delta$ 是正的，我们必须有 $n > 0$。最小的正整数是 $n=1$。\n$$\n\\frac{k_c\\Delta}{2} = \\pi\n$$\n求解无量纲积 $k_c \\Delta$ 得到所需答案的第二部分：\n$$\nk_c \\Delta = 2\\pi\n$$\n物理上的解释是，箱式滤波器完全移除了波长 $\\lambda = 2\\pi/k_c$ 等于滤波器宽度 $\\Delta$ 的波，即 $\\lambda_c = \\Delta$。\n\n最终答案包含 $\\bar{\\phi}(x)$ 的表达式和 $k_c \\Delta$ 的值。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sin(k\\Delta/2)}{k\\Delta/2} \\sin(kx) & 2\\pi \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理想情况下，流体密度是均匀的，但许多现实世界的流动（如燃烧或多相流）都涉及剧烈的密度变化。在这种复杂情况下，如何定义已解析的变量变得至关重要，直接影响着亚格子尺度模型的形式和精度。本练习通过一个动手编程任务，让你对比标准的雷诺（Reynolds）滤波和密度加权的法福（Favre）滤波在处理非均匀密度流时的表现，从而深刻理解为何Favre滤波是模拟这类流动的首选方法。",
            "id": "3967139",
            "problem": "给定一个长度为 $L$（单位：$\\mathrm{m}$）的一维周期性域，以及一个在位置 $x_0$ 附近具有陡峭梯度的、预先设定的非均匀密度场 $\\rho(x)$（单位：$\\mathrm{kg\\,m^{-3}}$），同时还有一个速度场 $u(x)$（单位：$\\mathrm{m\\,s^{-1}}$）。考虑在周期性边界条件下，使用标准差为 $\\sigma$（单位：$\\mathrm{m}$）的高斯核进行空间滤波。令简单滤波表示通过与高斯核进行卷积实现的空间平均 $\\overline{\\cdot}$，令Favre滤波表示由 $\\tilde{\\phi}(x) = \\overline{\\rho \\phi}(x)/\\overline{\\rho}(x)$ 定义的密度加权平均。在一维空间中，对流项动量通量是场 $\\rho(x)\\,u(x)^2$（单位：$\\mathrm{Pa}$）。\n\n从可压缩对流项动量通量、空间滤波和Favre滤波的定义出发，实现一个程序，该程序：\n- 计算精确的滤波后通量 $\\overline{\\rho u^2}(x)$（单位：$\\mathrm{Pa}$）。\n- 计算通量的简单滤波近似 $\\overline{\\rho}(x)\\,\\overline{u}(x)^2$（单位：$\\mathrm{Pa}$）。\n- 计算通量的Favre滤波近似 $\\overline{\\rho}(x)\\,\\tilde{u}(x)^2$（单位：$\\mathrm{Pa}$），其中 $\\tilde{u}(x) = \\overline{\\rho u}(x)/\\overline{\\rho}(x)$。\n- 计算简单滤波近似和Favre滤波近似对对流项动量通量的逐点差异，定义为 $\\Delta(x) = \\overline{\\rho}(x)\\,\\overline{u}(x)^2 - \\overline{\\rho}(x)\\,\\tilde{u}(x)^2$（单位：$\\mathrm{Pa}$）。\n- 量化通过Favre滤波相对于精确滤波通量所避免的伪项，即绝对误差的逐点减少量 $E_{\\mathrm{avoid}}(x) = \\left|\\overline{\\rho}(x)\\,\\overline{u}(x)^2 - \\overline{\\rho u^2}(x)\\right| - \\left|\\overline{\\rho}(x)\\,\\tilde{u}(x)^2 - \\overline{\\rho u^2}(x)\\right|$（单位：$\\mathrm{Pa}$）。\n- 报告在整个域上的空间平均值 $\\langle \\Delta \\rangle$ 和 $\\langle E_{\\mathrm{avoid}} \\rangle$，均以 $\\mathrm{Pa}$ 为单位。\n\n使用以下基本依据：\n- 可压缩动量方程的对流通量张量在一维情况下简化为标量场 $\\rho u^2$（单位：$\\mathrm{Pa}$）。\n- 空间滤波是与一个归一化高斯核 $G(x) = \\exp\\!\\left(-x^2/(2\\sigma^2)\\right)$ 的线性卷积运算，在域上周期性地解释。\n- Favre滤波定义为 $\\tilde{\\phi} = \\overline{\\rho \\phi}/\\overline{\\rho}$。\n\n所有滤波必须通过离散傅里叶变换，在周期性边界条件下，利用波数空间中的高斯传递函数进行数值计算。\n\n物理和数值规格：\n- 域：$x \\in [0,L)$，具有周期性边界条件和 $N$ 个均匀间隔点。\n- 密度：$\\rho(x) = \\rho_1 + (\\rho_2 - \\rho_1)\\,s(x)$，其中 $s(x) = \\dfrac{1}{2}\\left[1 + \\tanh\\!\\left(\\dfrac{x - x_0}{\\epsilon}\\right)\\right]$，$\\rho_1$ 和 $\\rho_2$ 的单位为 $\\mathrm{kg\\,m^{-3}}$，$x_0$ 和 $\\epsilon$ 的单位为 $\\mathrm{m}$。\n- 速度：$u(x) = U_0 + U_1 \\sin\\!\\left(\\dfrac{2\\pi x}{L}\\right) + U_2 \\exp\\!\\left(-\\left(\\dfrac{x - x_0}{\\epsilon}\\right)^2\\right)$，其中 $U_0$、$U_1$ 和 $U_2$ 的单位为 $\\mathrm{m\\,s^{-1}}$。\n- 高斯滤波器：标准差为 $\\sigma$（单位：$\\mathrm{m}$），在波数空间中的传递函数为 $H(k) = \\exp\\!\\left(-\\dfrac{1}{2}\\sigma^2 k^2\\right)$，其中 $k$ 表示周期性波数。\n\n单位：\n- 所有输出必须以 $\\mathrm{Pa}$ 报告。\n\n测试套件：\n提供三个具有科学上真实参数的测试用例来评估不同方面：\n1. 情况A（一般陡峭梯度，中等滤波器）：$L = 1\\,\\mathrm{m}$，$N = 4096$，$\\rho_1 = 1.0\\,\\mathrm{kg\\,m^{-3}}$，$\\rho_2 = 5.0\\,\\mathrm{kg\\,m^{-3}}$，$x_0 = 0.5\\,\\mathrm{m}$，$\\epsilon = 0.005\\,\\mathrm{m}$，$U_0 = 20\\,\\mathrm{m\\,s^{-1}}$，$U_1 = 5\\,\\mathrm{m\\,s^{-1}}$，$U_2 = 10\\,\\mathrm{m\\,s^{-1}}$，$\\sigma = 0.02\\,\\mathrm{m}$。\n2. 情况B（均匀密度基准）：$L = 1\\,\\mathrm{m}$，$N = 4096$，$\\rho_1 = 1.2\\,\\mathrm{kg\\,m^{-3}}$，$\\rho_2 = 1.2\\,\\mathrm{kg\\,m^{-3}}$，$x_0 = 0.5\\,\\mathrm{m}$，$\\epsilon = 0.005\\,\\mathrm{m}$，$U_0 = 20\\,\\mathrm{m\\,s^{-1}}$，$U_1 = 5\\,\\mathrm{m\\,s^{-1}}$，$U_2 = 10\\,\\mathrm{m\\,s^{-1}}$，$\\sigma = 0.02\\,\\mathrm{m}$。\n3. 情况C（非常陡峭的梯度，大滤波器）：$L = 1\\,\\mathrm{m}$，$N = 4096$，$\\rho_1 = 1.0\\,\\mathrm{kg\\,m^{-3}}$，$\\rho_2 = 7.0\\,\\mathrm{kg\\,m^{-3}}$，$x_0 = 0.5\\,\\mathrm{m}$，$\\epsilon = 0.001\\,\\mathrm{m}$，$U_0 = 15\\,\\mathrm{m\\,s^{-1}}$，$U_1 = 8\\,\\mathrm{m\\,s^{-1}}$，$U_2 = 12\\,\\mathrm{m\\,s^{-1}}$，$\\sigma = 0.20\\,\\mathrm{m}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，形式为一个展平的、逗号分隔的浮点数列表（单位：$\\mathrm{Pa}$），顺序为 $\\left[\\langle \\Delta \\rangle_{\\mathrm{A}}, \\langle E_{\\mathrm{avoid}} \\rangle_{\\mathrm{A}}, \\langle \\Delta \\rangle_{\\mathrm{B}}, \\langle E_{\\mathrm{avoid}} \\rangle_{\\mathrm{B}}, \\langle \\Delta \\rangle_{\\mathrm{C}}, \\langle E_{\\mathrm{avoid}} \\rangle_{\\mathrm{C}}\\right]$，并用方括号括起来（例如，$\\left[0.1,0.2,0.0,0.0,1.5,1.2\\right]$），其中每个值都是在域上的空间平均值（单位：$\\mathrm{Pa}$）。",
            "solution": "所提出的问题是计算流体动力学中一个有效且定义明确的练习，具体涉及用于可变密度流的大涡模拟（LES）的基本原理。它具有科学依据，是客观的，并为进行数值求解提供了所有必要的信息。该问题要求对对流项动量通量项的简单（雷诺式）滤波和Favre（密度加权）滤波进行比较，这是模拟可压缩或多相湍流的一个关键方面。\n\n首先，建立物理量及其数学定义。一维域在长度 $L$ 上延伸，具有周期性边界条件，由 $N$ 个均匀间隔点离散化。空间坐标为 $x$。密度场 $\\rho(x)$ 和速度场 $u(x)$ 由以下公式给出：\n$$ \\rho(x) = \\rho_1 + (\\rho_2 - \\rho_1)\\,s(x), \\quad \\text{其中} \\quad s(x) = \\frac{1}{2}\\left[1 + \\tanh\\left(\\frac{x - x_0}{\\epsilon}\\right)\\right] $$\n$$ u(x) = U_0 + U_1 \\sin\\left(\\frac{2\\pi x}{L}\\right) + U_2 \\exp\\left(-\\left(\\frac{x - x_0}{\\epsilon}\\right)^2\\right) $$\n一维对流项动量通量是量 $\\rho(x) u(x)^2$。\n\n在LES中，流场变量被分解为一个大尺度（滤波后）分量和一个小尺度（亚格子）分量。滤波操作，用上划线 $\\overline{\\cdot}$ 表示，是一种空间卷积。对于一个通用场 $\\phi(x)$，其滤波后的场为 $\\overline{\\phi}(x) = \\int_{-\\infty}^{\\infty} G(x - x') \\phi(x') dx'$，其中 $G$ 是滤波器核。对于本问题，指定了一个标准差为 $\\sigma$ 的高斯核。\n\nLES中的核心挑战来自于对非线性项的滤波。对对流项动量通量 $\\rho u^2$ 进行滤波得到 $\\overline{\\rho u^2}$。该项是不封闭的，意味着它不能直接用滤波后的主变量 $\\overline{\\rho}$ 和 $\\overline{u}$ 来表示。它必须被建模。\n\n分析了两种常见的近似此项的方法：\n$1$. **简单（或雷诺式）滤波**：近似由滤波后量的乘积形成：$\\overline{\\rho u^2} \\approx \\overline{\\rho}\\,\\overline{u}^2$。众所周知，当密度变化显著时，这种方法表现不佳，因为它忽略了亚格子尺度上密度和速度波动之间的相关性。\n\n$2$. **Favre（或密度加权）滤波**：此方法旨在减轻可变密度带来的问题。Favre滤波后的速度 $\\tilde{u}$ 定义为：\n$$ \\tilde{u}(x) = \\frac{\\overline{\\rho u}(x)}{\\overline{\\rho}(x)} $$\n滤波后对流通量的相应近似为 $\\overline{\\rho u^2} \\approx \\overline{\\rho}\\,\\tilde{u}^2$。通过将密度纳入滤波速度的定义中，一些亚格子相关性被隐式地考虑在内，这通常会导致更准确的近似和更简单的剩余亚格子尺度（SGS）项结构。\n\n该问题要求计算和比较这两种近似。具体来说，我们需要计算：\n- 精确的滤波后通量：$\\overline{\\rho u^2}(x)$。\n- 简单滤波近似：$\\overline{\\rho}(x)\\,\\overline{u}(x)^2$。\n- Favre滤波近似：$\\overline{\\rho}(x)\\,\\tilde{u}(x)^2 = \\overline{\\rho}(x) \\left( \\frac{\\overline{\\rho u}(x)}{\\overline{\\rho}(x)} \\right)^2 = \\frac{(\\overline{\\rho u}(x))^2}{\\overline{\\rho}(x)}$。\n\n两种近似之间的差异由 $\\Delta(x)$ 量化：\n$$ \\Delta(x) = \\overline{\\rho}(x)\\,\\overline{u}(x)^2 - \\overline{\\rho}(x)\\,\\tilde{u}(x)^2 $$\n这个项 $\\Delta(x)$ 代表了在简单平均框架中明确存在，但在Favre框架中被吸收到滤波速度定义中的贡献。\n\n此外，我们通过计算相对于精确滤波通量的绝对误差的逐点减少量 $E_{\\mathrm{avoid}}(x)$ 来量化Favre滤波的好处：\n$$ E_{\\mathrm{avoid}}(x) = \\underbrace{\\left|\\overline{\\rho}(x)\\,\\overline{u}(x)^2 - \\overline{\\rho u^2}(x)\\right|}_{\\text{简单近似的误差}} - \\underbrace{\\left|\\overline{\\rho}(x)\\,\\tilde{u}(x)^2 - \\overline{\\rho u^2}(x)\\right|}_{\\text{Favre近似的误差}} $$\n$E_{\\mathrm{avoid}}(x)$ 的正值表示Favre近似在该点更准确。最终目标是报告这两个量的空间平均值 $\\langle \\Delta \\rangle$ 和 $\\langle E_{\\mathrm{avoid}} \\rangle$，用于三个不同的测试用例。\n\n数值实现依赖于卷积定理。物理空间中的卷积运算等价于傅里叶（波数）空间中的乘法运算。过程如下：\n$1$. 将域 $x \\in [0, L)$ 离散化为 $N$ 个点。\n$2$. 生成 $\\rho(x)$、$u(x)$ 以及复合场 $\\rho(x)u(x)$ 和 $\\rho(x)u(x)^2$ 的离散信号。\n$3$. 计算与网格对应的离散波数 $k$。对于长度为 $L$ 的域和 $N$ 个点，波数为 $k_j = 2\\pi j / L$，其中 $j = -N/2, \\dots, N/2 - 1$。\n$4$. 在波数空间中构建高斯传递函数：$H(k) = \\exp(-\\frac{1}{2}\\sigma^2 k^2)$。\n$5$. 对于任何场 $\\phi(x)$，其滤波版本 $\\overline{\\phi}(x)$ 通过以下方式计算：\n   a. 应用快速傅里叶变换（FFT）：$\\hat{\\phi}(k) = \\mathcal{F}\\{\\phi(x)\\}$。\n   b. 乘以传递函数：$\\hat{\\overline{\\phi}}(k) = \\hat{\\phi}(k) H(k)$。\n   c. 应用逆快速傅里叶变换（IFFT）：$\\overline{\\phi}(x) = \\mathcal{F}^{-1}\\{\\hat{\\overline{\\phi}}(k)\\}$。\n$6$. 使用此滤波程序，计算 $\\overline{\\rho}$、$\\overline{u}$、$\\overline{\\rho u}$ 和 $\\overline{\\rho u^2}$。\n$7$. 从这些滤波后的场，逐点计算 $\\tilde{u}$、$\\Delta(x)$ 和 $E_{\\mathrm{avoid}}(x)$。\n$8$. 最后，通过取各自数组的平均值来计算空间平均值 $\\langle \\Delta \\rangle$ 和 $\\langle E_{\\mathrm{avoid}} \\rangle$。\n\n对于恒定密度情况（情况B），其中 $\\rho_1 = \\rho_2$，密度场是均匀的，$\\rho(x) = \\rho_1$。在这种情况下，$\\overline{\\rho} = \\rho_1$，Favre速度的定义简化为 $\\tilde{u} = \\overline{\\rho_1 u} / \\overline{\\rho_1} = (\\rho_1 \\overline{u}) / \\rho_1 = \\overline{u}$。因此，简单近似和Favre近似变得相同，并且 $\\Delta(x)$ 和 $E_{\\mathrm{avoid}}(x)$ 都恒等于零。这种情况可作为数值实现的关键验证。对于具有陡峭密度梯度的情况（A和C），预计 $\\langle \\Delta \\rangle$ 和 $\\langle E_{\\mathrm{avoid}} \\rangle$ 都会有显著的非零值，这表明两种滤波方法之间存在不可忽略的差异，并且Favre方法在此类流场中的实际优越性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing simple and Favre filtering for the\n    convective momentum flux in a 1D variable-density flow.\n    \"\"\"\n\n    test_cases = [\n        # Case A: General sharp gradient, moderate filter\n        {'L': 1.0, 'N': 4096, 'rho1': 1.0, 'rho2': 5.0, 'x0': 0.5, 'epsilon': 0.005,\n         'U0': 20.0, 'U1': 5.0, 'U2': 10.0, 'sigma': 0.02},\n        # Case B: Uniform density baseline\n        {'L': 1.0, 'N': 4096, 'rho1': 1.2, 'rho2': 1.2, 'x0': 0.5, 'epsilon': 0.005,\n         'U0': 20.0, 'U1': 5.0, 'U2': 10.0, 'sigma': 0.02},\n        # Case C: Very sharp gradient, large filter\n        {'L': 1.0, 'N': 4096, 'rho1': 1.0, 'rho2': 7.0, 'x0': 0.5, 'epsilon': 0.001,\n         'U0': 15.0, 'U1': 8.0, 'U2': 12.0, 'sigma': 0.20},\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        L = params['L']\n        N = params['N']\n        rho1 = params['rho1']\n        rho2 = params['rho2']\n        x0 = params['x0']\n        epsilon = params['epsilon']\n        U0 = params['U0']\n        U1 = params['U1']\n        U2 = params['U2']\n        sigma = params['sigma']\n\n        # 1. Discretize the domain and define wavenumbers\n        x = np.linspace(0, L, N, endpoint=False)\n        dx = L / N\n        k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n        # 2. Define the Gaussian filter transfer function\n        H_k = np.exp(-0.5 * sigma**2 * k**2)\n\n        def apply_filter(field):\n            \"\"\"Applies the Gaussian filter in Fourier space.\"\"\"\n            field_hat = np.fft.fft(field)\n            filtered_field_hat = field_hat * H_k\n            filtered_field = np.fft.ifft(filtered_field_hat)\n            return np.real(filtered_field)\n\n        # 3. Generate the physical fields\n        s_x = 0.5 * (1 + np.tanh((x - x0) / epsilon))\n        rho = rho1 + (rho2 - rho1) * s_x\n        u = U0 + U1 * np.sin(2 * np.pi * x / L) + U2 * np.exp(-((x - x0) / epsilon)**2)\n\n        # 4. Compute composite fields\n        rhou = rho * u\n        rhou2 = rho * u**2\n\n        # 5. Apply the filter to all necessary fields\n        rho_bar = apply_filter(rho)\n        u_bar = apply_filter(u)\n        rhou_bar = apply_filter(rhou)\n        rhou2_bar = apply_filter(rhou2) # This is the exact filtered flux\n\n        # 6. Compute Favre-filtered velocity\n        # Add a small epsilon to avoid division by zero in case rho_bar gets very small\n        # although with the given parameters it is not an issue.\n        u_tilde = rhou_bar / (rho_bar + 1e-12)\n\n        # 7. Compute the flux approximations\n        flux_simple = rho_bar * u_bar**2\n        flux_favre = rho_bar * u_tilde**2\n\n        # 8. Compute the diagnostic quantities\n        # Difference between simple and Favre approximations\n        delta = flux_simple - flux_favre\n        \n        # Spurious term avoided by Favre filtering (reduction in absolute error)\n        error_simple = np.abs(flux_simple - rhou2_bar)\n        error_favre = np.abs(flux_favre - rhou2_bar)\n        E_avoid = error_simple - error_favre\n\n        # 9. Compute the spatial averages\n        avg_delta = np.mean(delta)\n        avg_E_avoid = np.mean(E_avoid)\n        \n        results.extend([avg_delta, avg_E_avoid])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在大涡模拟中，完全解析靠近壁面区域的湍流边界层往往需要极高的计算成本，因此壁面模型成为了不可或缺的工具。本练习将引导你探索一个基于“壁面律”的经典平衡壁面模型。你将从理论出发，推导出如何利用离壁面有一定距离处的已解析速度值来计算壁面切应力 $\\tau_{w}$，这个过程展示了如何将经典的湍流理论与LES的实际需求相结合，以解决工程中的关键问题。",
            "id": "3967070",
            "problem": "考虑用于不可压缩、高雷诺数、光滑壁面热流的大涡模拟 (LES) 中近壁湍流的平衡壁面模型，其中，在距壁面法向距离为 $y$ 的匹配位置，亚格子尺度（空间滤波后）的切向速度表示为 $\\bar{u}(y)$。假设密度 $\\rho$ 和运动粘度 $\\nu$ 为常数，且局部平均近壁流动是稳态的，并且近似处于平衡状态，流向压力梯度可以忽略不计，因此经典的壁面律对数律适用于匹配区域。摩擦速度定义为 $u_{\\tau}=\\sqrt{\\tau_{w}/\\rho}$，标准的无量纲变量为 $\\bar{u}^{+}=\\bar{u}/u_{\\tau}$ 和 $y^{+}=yu_{\\tau}/\\nu$。在对数层中，平均速度遵循 $\\bar{u}^{+}=\\frac{1}{\\kappa}\\ln y^{+}+B$，其中 $\\kappa$ 是 von Kármán 常数， $B$ 是加法常数。\n\n从上述经过充分检验的关系式和定义出发，并且除了 $\\kappa$ 和 $B$ 之外不引入任何经验性调整，推导出壁面剪切应力 $\\tau_{w}$ 作为匹配位置处 $\\bar{u}$、$y$、$\\rho$、$\\nu$、$\\kappa$ 和 $B$ 的函数的精确闭式解析表达式。您的最终表达式必须是单一的解析公式，而不是隐式方程。不要进行小参数展开或迭代近似。如果需要使用特殊函数来表达解，您可以使用它。仅提供解析表达式；不要代入数值。如果您之后选择对表达式进行数值计算，请用pascals表示 $\\tau_{w}$。",
            "solution": "该问题是有效的。它在科学上基于流体动力学和湍流建模的原理，特别是关于大涡模拟（LES）壁面模型。该问题是适定的、客观的，并包含了推导唯一解析解所需的所有必要信息。从壁面律的对数律中寻找壁面剪切应力的闭式表达式是一个标准的、非平凡的练习，它涉及到求解一个超越方程。\n\n推导从给定的壁面律对数律开始，该定律关联了无量纲速度 $\\bar{u}^{+}$ 和无量纲壁面法向距离 $y^{+}$：\n$$\n\\bar{u}^{+} = \\frac{1}{\\kappa}\\ln y^{+} + B\n$$\n无量纲变量是根据匹配位置 $y$ 处的滤波后速度 $\\bar{u}$、摩擦速度 $u_{\\tau}$ 和流体运动粘度 $\\nu$ 定义的：\n$$\n\\bar{u}^{+} = \\frac{\\bar{u}}{u_{\\tau}}\n$$\n$$\ny^{+} = \\frac{y u_{\\tau}}{\\nu}\n$$\n摩擦速度 $u_{\\tau}$ 是根据壁面剪切应力 $\\tau_w$ 和流体密度 $\\rho$ 定义的：\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n我们的目标是找到 $\\tau_w$ 作为给定参数 $\\bar{u}$、$y$、$\\rho$、$\\nu$、$\\kappa$ 和 $B$ 的显式表达式。\n\n首先，我们将 $\\bar{u}^{+}$ 和 $y^{+}$ 的定义代入对数律方程：\n$$\n\\frac{\\bar{u}}{u_{\\tau}} = \\frac{1}{\\kappa}\\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right) + B\n$$\n这是一个关于未知摩擦速度 $u_{\\tau}$ 的超越方程。为了解出 $u_{\\tau}$，我们必须将此方程重新整理成可以反解的形式。朗伯W函数（Lambert W function），也称为乘积对数（product logarithm），是完成此任务的合适特殊函数。朗伯W函数，记作 $W(z)$，被定义为方程的解：\n$$\nz = W(z) \\exp(W(z))\n$$\n我们继续处理关于 $u_{\\tau}$ 的超越方程，以使其匹配这种形式。首先，将方程两边乘以 von Kármán 常数 $\\kappa$：\n$$\n\\frac{\\kappa \\bar{u}}{u_{\\tau}} = \\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right) + \\kappa B\n$$\n利用对数性质 $\\ln(a/b) = \\ln(a) - \\ln(b)$，我们可以展开对数项：\n$$\n\\frac{\\kappa \\bar{u}}{u_{\\tau}} = \\ln(y) + \\ln(u_{\\tau}) - \\ln(\\nu) + \\kappa B\n$$\n重新整理以组合包含 $u_{\\tau}$ 的项并非最直接的路径。相反，我们可以如下重新整理方程，为取指数做准备。分离对数项：\n$$\n\\kappa\\left(\\frac{\\bar{u}}{u_{\\tau}} - B\\right) = \\ln\\left(\\frac{y u_{\\tau}}{\\nu}\\right)\n$$\n对等式两边取指数：\n$$\n\\exp\\left(\\kappa\\frac{\\bar{u}}{u_{\\tau}} - \\kappa B\\right) = \\frac{y u_{\\tau}}{\\nu}\n$$\n利用性质 $\\exp(a-b) = \\exp(a)\\exp(-b)$，我们分离指数项：\n$$\n\\exp\\left(\\frac{\\kappa \\bar{u}}{u_{\\tau}}\\right) \\exp(-\\kappa B) = \\frac{y u_{\\tau}}{\\nu}\n$$\n我们希望将其整理成 $Z = V \\exp(V)$ 的形式。让我们定义一个新变量 $V = \\frac{\\kappa \\bar{u}}{u_{\\tau}}$。这意味着 $u_{\\tau} = \\frac{\\kappa \\bar{u}}{V}$。将这个 $u_{\\tau}$ 的表达式代入方程中得到：\n$$\n\\exp(V) \\exp(-\\kappa B) = \\frac{y}{\\nu} \\left(\\frac{\\kappa \\bar{u}}{V}\\right)\n$$\n现在，我们可以解出 $V \\exp(V)$：\n$$\nV \\exp(V) = \\frac{\\kappa \\bar{u} y}{\\nu} \\exp(\\kappa B)\n$$\n此方程是朗伯W函数的标准形式 $Z = V \\exp(V)$，其中自变量 $Z$ 由右侧给出。因此，$V$ 的解是：\n$$\nV = W\\left(\\frac{\\kappa \\bar{u} y}{\\nu} \\exp(\\kappa B)\\right)\n$$\n对于典型的物理流动，所有参数（$\\kappa, \\bar{u}, y, \\nu$）都是正的，常数 $B$ 也是正的。因此，朗伯W函数的自变量是一个正实数，对于该自变量，函数有一个唯一的实数值主分支，记作 $W_0$。我们将简单地写成 $W$，并理解它指的是这个主分支。\n\n现在我们代回我们对 $V$ 的定义：\n$$\n\\frac{\\kappa \\bar{u}}{u_{\\tau}} = W\\left(\\frac{\\kappa \\bar{u} y}{\\nu} \\exp(\\kappa B)\\right)\n$$\n我们现在可以解出摩擦速度 $u_{\\tau}$：\n$$\nu_{\\tau} = \\frac{\\kappa \\bar{u}}{W\\left(\\frac{\\kappa \\bar{u} y}{\\nu} \\exp(\\kappa B)\\right)}\n$$\n这就是摩擦速度的闭式解析表达式。最后一步是找到壁面剪切应力 $\\tau_w$ 的表达式。利用定义 $\\tau_w = \\rho u_{\\tau}^2$，我们将 $u_{\\tau}$ 的表达式平方，然后乘以密度 $\\rho$：\n$$\n\\tau_w = \\rho \\left( \\frac{\\kappa \\bar{u}}{W\\left(\\frac{\\kappa \\bar{u} y}{\\nu} \\exp(\\kappa B)\\right)} \\right)^2\n$$\n这就是所求的壁面剪切应力 $\\tau_w$ 作为指定参数的函数的精确、闭式解析表达式。",
            "answer": "$$\n\\boxed{\\rho \\left( \\frac{\\kappa \\bar{u}}{W\\left(\\frac{\\kappa \\bar{u} y}{\\nu} \\exp(\\kappa B)\\right)} \\right)^2}\n$$"
        }
    ]
}