{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation in adaptive meshing, we begin with an idealized yet insightful exercise. By analytically solving a classic 1D advection-diffusion problem, we can determine the exact features of the solution, such as the steep gradients within a thermal boundary layer. This practice challenges you to derive the theoretically optimal mesh size distribution that perfectly equidistributes the interpolation error, providing a clear, first-principles understanding of how solution behavior dictates the ideal mesh structure .",
            "id": "3934281",
            "problem": "A thermal transport process in one spatial dimension is modeled on the interval $x \\in [0, L]$ by the steady advection-diffusion equation with constant properties,\n$$u \\frac{d T}{d x} = \\alpha \\frac{d^{2} T}{d x^{2}},$$\nwhere $T(x)$ is the temperature, $u > 0$ is the uniform flow speed, and $\\alpha > 0$ is the thermal diffusivity. The boundary conditions are $T(0) = T_{0}$ and $T(L) = T_{L}$, with $T_{0}$ and $T_{L}$ prescribed constants. For large Peclet number $Pe = \\frac{u L}{\\alpha}$, a thin outflow boundary layer near $x = L$ develops in the exact solution.\n\nWithin the paradigm of Adaptive Mesh Refinement (AMR) with $h$-adaptivity for the Finite Element Method (FEM) using linear Lagrange elements, suppose the element size distribution $h(x)$ is designed to equidistribute the leading-order interpolation error based on a second-derivative monitor, i.e., the local interpolation error scales like $h(x)^{2} |T''(x)|$. Let the desired mesh consist of exactly $N$ elements over $[0, L]$, enforcing the constraint $\\int_{0}^{L} \\frac{dx}{h(x)} = N$.\n\nStarting from the governing equation and boundary conditions, derive the exact expression for the target element-size function $h(x)$ that equidistributes the leading-order interpolation error over $[0, L]$. Express your final answer as a single closed-form analytic expression in terms of $L$, $u$, $\\alpha$, and $N$. Express $h(x)$ in meters. No numerical evaluation is required, and no rounding is necessary. Use only the given symbols and fundamental constants as needed.",
            "solution": "The problem statement is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- Governing equation: $u \\frac{d T}{d x} = \\alpha \\frac{d^{2} T}{d x^{2}}$\n- Domain: $x \\in [0, L]$\n- Parameters: $u > 0$, $\\alpha > 0$\n- Boundary Conditions: $T(0) = T_{0}$, $T(L) = T_{L}$\n- Assumption: Large Peclet number, $Pe = \\frac{u L}{\\alpha}$\n- AMR Criterion: The local interpolation error for linear elements scales like $h(x)^{2} |T''(x)|$. The mesh size distribution $h(x)$ is designed to equidistribute this error.\n- Mesh Constraint: The total number of elements is $N$, which is expressed as $\\int_{0}^{L} \\frac{dx}{h(x)} = N$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is well-grounded in the fundamental principles of computational heat transfer. The steady advection-diffusion equation is a cornerstone model for transport phenomena. The concepts of Peclet number, boundary layers, Adaptive Mesh Refinement ($h$-adaptivity), Finite Element Method (FEM), and error equidistribution using a second-derivative monitor function are all standard, well-established topics in computational science and engineering.\n- **Well-Posed**: The problem is mathematically well-posed. It involves finding the analytical solution to a second-order linear Ordinary Differential Equation (ODE) with specified boundary conditions, and subsequently using this solution to determine a mesh size function $h(x)$ that satisfies a clear integral constraint based on a well-defined optimization criterion (error equidistribution). A unique, stable, and meaningful solution for $h(x)$ can be derived.\n- **Objective**: The problem is stated in precise, objective, and unambiguous mathematical language. All terms are formally defined or are standard in the field.\n- **Completeness and Consistency**: The problem is self-contained. It provides all necessary information—the governing equation, boundary conditions, the error scaling law, and the constraint on the number of elements—to derive the required function $h(x)$. There are no contradictions in the provided information.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically sound, well-posed, objective, and complete. I will now proceed to derive the solution.\n\nThe derivation of the element-size function $h(x)$ requires several steps. First, we must find the exact analytical solution $T(x)$ to the governing equation. Second, we compute its second derivative $T''(x)$. Third, we formalize the error equidistribution principle and use the integral constraint on the number of elements to find the explicit form of $h(x)$.\n\n**1. Analytical Solution for Temperature $T(x)$**\n\nThe governing equation is a steady $1$D advection-diffusion equation:\n$$u \\frac{d T}{d x} = \\alpha \\frac{d^{2} T}{d x^{2}}$$\nThis is a second-order linear homogeneous ODE with constant coefficients, which can be rearranged as:\n$$\\alpha \\frac{d^{2} T}{d x^{2}} - u \\frac{d T}{d x} = 0$$\nWe seek a solution of the form $T(x) = \\exp(rx)$. The characteristic equation is:\n$$\\alpha r^2 - u r = 0$$\n$$r(\\alpha r - u) = 0$$\nThe roots are $r_1 = 0$ and $r_2 = \\frac{u}{\\alpha}$. The general solution for $T(x)$ is a linear combination of the solutions corresponding to these roots:\n$$T(x) = C_1 \\exp(r_1 x) + C_2 \\exp(r_2 x) = C_1 + C_2 \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\nThe constants $C_1$ and $C_2$ are determined by the boundary conditions, $T(0) = T_0$ and $T(L) = T_L$.\nAt $x=0$:\n$$T(0) = T_0 = C_1 + C_2 \\exp(0) \\implies T_0 = C_1 + C_2$$\nAt $x=L$:\n$$T(L) = T_L = C_1 + C_2 \\exp\\left(\\frac{u L}{\\alpha}\\right)$$\nThis is a system of two linear equations for $C_1$ and $C_2$. From the first equation, we have $C_1 = T_0 - C_2$. Substituting this into the second equation gives:\n$$T_L = (T_0 - C_2) + C_2 \\exp\\left(\\frac{u L}{\\alpha}\\right) = T_0 + C_2 \\left(\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1\\right)$$\nSolving for $C_2$:\n$$C_2 = \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1}$$\nSolving for $C_1$:\n$$C_1 = T_0 - C_2 = T_0 - \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} = \\frac{T_0 \\exp\\left(\\frac{u L}{\\alpha}\\right) - T_0 - T_L + T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} = \\frac{T_0 \\exp\\left(\\frac{u L}{\\alpha}\\right) - T_L}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1}$$\nSubstituting $C_1$ and $C_2$ back into the general solution for $T(x)$ gives the exact solution:\n$$T(x) = T_0 + (T_L - T_0) \\frac{\\exp\\left(\\frac{u x}{\\alpha}\\right) - 1}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1}$$\n\n**2. Second Derivative of the Solution**\n\nThe error equidistribution criterion is based on the second derivative, $T''(x)$. We differentiate $T(x)$ twice with respect to $x$.\nFirst derivative:\n$$\\frac{d T}{d x} = \\frac{d}{dx} \\left[ T_0 + (T_L - T_0) \\frac{\\exp\\left(\\frac{u x}{\\alpha}\\right) - 1}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right] = \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\left(\\frac{u}{\\alpha}\\right) \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\nSecond derivative:\n$$\\frac{d^2 T}{d x^2} = \\frac{d}{dx} \\left[ \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\left(\\frac{u}{\\alpha}\\right) \\exp\\left(\\frac{u x}{\\alpha}\\right) \\right] = \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\left(\\frac{u}{\\alpha}\\right)^2 \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\n\n**3. Derivation of the Element-Size Function $h(x)$**\n\nThe problem states that the element-size distribution $h(x)$ is designed to equidistribute the leading-order interpolation error, which scales like $h(x)^{2} |T''(x)|$. The equidistribution principle requires that this quantity be constant over the domain:\n$$h(x)^2 |T''(x)| = C_{eq}$$\nwhere $C_{eq}$ is a constant. This implies that the element size $h(x)$ should be:\n$$h(x) = \\frac{\\sqrt{C_{eq}}}{|T''(x)|^{1/2}}$$\nThe constant $\\sqrt{C_{eq}}$ is determined by the constraint that the mesh must contain exactly $N$ elements. In the continuous limit this is expressed as:\n$$\\int_{0}^{L} \\frac{dx}{h(x)} = N$$\nSubstituting the expression for $h(x)$ into the constraint:\n$$\\int_{0}^{L} \\frac{|T''(x)|^{1/2}}{\\sqrt{C_{eq}}} dx = N$$\nSolving for $\\sqrt{C_{eq}}$:\n$$\\sqrt{C_{eq}} = \\frac{1}{N} \\int_{0}^{L} |T''(x')|^{1/2} dx'$$\n(using $x'$ as the integration variable for clarity). Substituting this back into the expression for $h(x)$ gives the general formula for the optimal mesh size function:\n$$h(x) = \\frac{\\frac{1}{N} \\int_{0}^{L} |T''(x')|^{1/2} dx'}{|T''(x)|^{1/2}}$$\nNow, we apply this formula to our specific problem. First, we find $|T''(x)|^{1/2}$:\n$$|T''(x)| = \\left| \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right| \\left(\\frac{u}{\\alpha}\\right)^2 \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\nTaking the square root:\n$$|T''(x)|^{1/2} = \\left| \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right|^{1/2} \\left(\\frac{u}{\\alpha}\\right) \\exp\\left(\\frac{u x}{2\\alpha}\\right)$$\nThis can be written as $|T''(x)|^{1/2} = C_A \\exp\\left(\\frac{u x}{2\\alpha}\\right)$, where $C_A = \\left| \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right|^{1/2} \\frac{u}{\\alpha}$ is a constant that is independent of $x$.\n\nNext, we evaluate the integral in the numerator:\n$$\\int_{0}^{L} |T''(x')|^{1/2} dx' = \\int_{0}^{L} C_A \\exp\\left(\\frac{u x'}{2\\alpha}\\right) dx' = C_A \\left[ \\frac{2\\alpha}{u} \\exp\\left(\\frac{u x'}{2\\alpha}\\right) \\right]_{0}^{L}$$\n$$= C_A \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - \\exp(0)\\right) = C_A \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right)$$\nNow we substitute this integral and the expression for $|T''(x)|^{1/2}$ back into the general formula for $h(x)$:\n$$h(x) = \\frac{1}{N} \\frac{C_A \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right)}{C_A \\exp\\left(\\frac{u x}{2\\alpha}\\right)}$$\nThe constant $C_A$ cancels out. This is a crucial result, as it means the optimal element size distribution is independent of the specific boundary temperature values $T_0$ and $T_L$, and depends only on the system parameters $u, \\alpha, L$ and the mesh parameter $N$.\nSimplifying the expression for $h(x)$:\n$$h(x) = \\frac{1}{N} \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right) \\frac{1}{\\exp\\left(\\frac{u x}{2\\alpha}\\right)}$$\n$$h(x) = \\frac{2\\alpha}{Nu} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right) \\exp\\left(-\\frac{u x}{2\\alpha}\\right)$$\nThis is the final expression for the target element-size function $h(x)$. The function is a decaying exponential, indicating that the mesh should be finest (smallest $h$) at the outflow boundary $x=L$, which is consistent with the presence of a boundary layer in that region for large Peclet numbers. The units of the expression are meters, as $\\frac{\\alpha}{u}$ has units of length ($\\frac{m^2/s}{m/s} = m$), and $N$ and the exponential terms are dimensionless.",
            "answer": "$$\n\\boxed{\\frac{2\\alpha}{Nu} \\left(\\exp\\left(\\frac{uL}{2\\alpha}\\right) - 1\\right) \\exp\\left(-\\frac{ux}{2\\alpha}\\right)}\n$$"
        },
        {
            "introduction": "In practical finite element analysis, the exact solution is unknown, so we cannot compute the error directly. Instead, we must rely on a posteriori error estimators that use the computed numerical solution to approximate the true error. This exercise introduces the celebrated Zienkiewicz-Zhu error estimator, a powerful technique based on flux recovery that provides a computable and physically meaningful measure of error, forming the basis for many real-world adaptive meshing strategies .",
            "id": "3934228",
            "problem": "Consider steady-state heat conduction governed by Fourier’s law $\\,\\boldsymbol{q}=-k\\,\\nabla T\\,$ and the conservation equation $-\\nabla\\cdot(k\\,\\nabla T)=f$ in a domain $\\Omega$, where $k(\\boldsymbol{x})>0$ is the thermal conductivity, $T$ is the temperature, and $\\boldsymbol{q}$ is the heat flux. Let $T_h\\in H^1(\\Omega)$ be a conforming finite element approximation obtained by the Finite Element Method (FEM), and define the discrete flux $\\boldsymbol{q}_h:=-k\\,\\nabla T_h$. On an element $K\\subset\\Omega$, consider a flux recovery procedure that produces a continuous recovered field $\\tilde{\\boldsymbol{q}}$ which approximates the exact flux $\\boldsymbol{q}$ more accurately than $\\boldsymbol{q}_h$ in the sense of asymptotic refinement.\n\n(a) Starting from the thermally weighted energy norm of the error $\\,\\|e\\|_{E(K)}^2:=\\int_K k\\,\\nabla e\\cdot\\nabla e\\,dV\\,$ with $e:=T-T_h$, derive an elementwise computable indicator based solely on $\\boldsymbol{q}_h$ and a recovered flux $\\tilde{\\boldsymbol{q}}$, and explain under what asymptotic conditions (on $h$-refinement and recovery quality) the indicator is consistent with the energy norm of the error.\n\n(b) Now evaluate the indicator you derived in part (a) for the following scientifically plausible element and fields. Let $K=[0,a]\\times[0,b]\\times[0,t]$ with $a=0.02\\,\\mathrm{m}$, $b=0.03\\,\\mathrm{m}$, and $t=1\\,\\mathrm{m}$, and let the thermal conductivity be constant on $K$ with $k=12\\,\\mathrm{W/(m\\cdot K)}$. Take the discrete flux to be constant on $K$ as\n$$\n\\boldsymbol{q}_h = \\begin{pmatrix}120\\\\-80\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2},\n$$\nand a recovered flux field that is linear in the in-plane coordinates and independent of $z$,\n$$\n\\tilde{\\boldsymbol{q}}(x,y,z) = \\begin{pmatrix}120+1000\\,x-500\\,y\\\\-80+600\\,x+400\\,y\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2}.\n$$\nCompute the elementwise indicator value. Round your answer to four significant figures and express the final value in $\\mathrm{W\\cdot K}$.",
            "solution": "**(a) Derivation and Consistency of the Error Indicator**\n\nThe problem asks for an elementwise computable error indicator for the finite element approximation of a steady-state heat conduction problem. The indicator should be based on the thermally weighted energy norm of the error, $e = T - T_h$, on an element $K$.\n\nThe squared energy norm of the error on an element $K$ is defined as:\n$$\n\\|e\\|_{E(K)}^2 := \\int_K k\\,\\nabla e\\cdot\\nabla e\\,dV\n$$\nBy substituting the definition of the error $e = T - T_h$, we have $\\nabla e = \\nabla T - \\nabla T_h$. The expression becomes:\n$$\n\\|e\\|_{E(K)}^2 = \\int_K k\\,(\\nabla T - \\nabla T_h)\\cdot(\\nabla T - \\nabla T_h)\\,dV\n$$\nThe exact flux $\\boldsymbol{q}$ and the discrete flux $\\boldsymbol{q}_h$ are given by Fourier's law:\n$$\n\\boldsymbol{q} = -k\\,\\nabla T \\implies \\nabla T = -\\frac{1}{k}\\boldsymbol{q}\n$$\n$$\n\\boldsymbol{q}_h = -k\\,\\nabla T_h \\implies \\nabla T_h = -\\frac{1}{k}\\boldsymbol{q}_h\n$$\nSubstituting these expressions for the gradients into the integral for the error norm gives:\n$$\n\\|e\\|_{E(K)}^2 = \\int_K k\\,\\left(-\\frac{1}{k}\\boldsymbol{q} - \\left(-\\frac{1}{k}\\boldsymbol{q}_h\\right)\\right)\\cdot\\left(-\\frac{1}{k}\\boldsymbol{q} - \\left(-\\frac{1}{k}\\boldsymbol{q}_h\\right)\\right)\\,dV\n$$\n$$\n\\|e\\|_{E(K)}^2 = \\int_K k\\,\\left(\\frac{1}{k}(\\boldsymbol{q}_h - \\boldsymbol{q})\\right)\\cdot\\left(\\frac{1}{k}(\\boldsymbol{q}_h - \\boldsymbol{q})\\right)\\,dV\n$$\n$$\n\\|e\\|_{E(K)}^2 = \\int_K \\frac{1}{k}\\,(\\boldsymbol{q} - \\boldsymbol{q}_h)\\cdot(\\boldsymbol{q} - \\boldsymbol{q}_h)\\,dV = \\int_K \\frac{1}{k}\\,|\\boldsymbol{q} - \\boldsymbol{q}_h|^2\\,dV\n$$\nThis expression represents the exact squared error, but it is not computable because the exact flux $\\boldsymbol{q}$ is unknown. The core idea of a posteriori error estimation is to replace the unknown exact solution with a more accurate approximation. The problem introduces a recovered flux $\\tilde{\\boldsymbol{q}}$ which is designed to be a better approximation to $\\boldsymbol{q}$ than $\\boldsymbol{q}_h$ is.\n\nWe obtain a computable error indicator, which we denote $\\eta_K^2$, by substituting $\\tilde{\\boldsymbol{q}}$ for $\\boldsymbol{q}$ in the expression for the squared error norm:\n$$\n\\eta_K^2 = \\int_K \\frac{1}{k}\\,|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV\n$$\nThis is the desired elementwise computable indicator, known as the Zienkiewicz-Zhu error estimator.\n\nFor this indicator to be consistent with the true error, the quantity $\\eta_K$ must be a good approximation of $\\|e\\|_{E(K)}$. This is formally characterized by the element effectivity index, $\\theta_K = \\eta_K / \\|e\\|_{E(K)}$, which should approach $1$ as the mesh size $h$ tends to zero. This property is known as asymptotic exactness.\n\nThe condition under which $\\eta_K$ is a good approximation for $\\|e\\|_{E(K)}$ relates to the quality of the flux recovery. By the triangle inequality for the norm corresponding to the inner product $\\langle \\boldsymbol{a}, \\boldsymbol{b} \\rangle = \\int_K \\frac{1}{k} \\boldsymbol{a} \\cdot \\boldsymbol{b} \\, dV$, we have:\n$$\n\\left| \\|\\boldsymbol{q} - \\boldsymbol{q}_h\\| - \\|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h\\| \\right| \\leq \\|\\boldsymbol{q} - \\tilde{\\boldsymbol{q}}\\|\n$$\nwhere $\\|\\cdot\\|$ denotes the norm derived from this inner product. For the indicator to be accurate, $\\|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h\\|$ must be close to $\\|\\boldsymbol{q} - \\boldsymbol{q}_h\\|$. This occurs if $\\|\\boldsymbol{q} - \\tilde{\\boldsymbol{q}}\\|$ is significantly smaller than $\\|\\boldsymbol{q} - \\boldsymbol{q}_h\\|$.\n\nThis leads to the crucial asymptotic condition: the recovered flux $\\tilde{\\boldsymbol{q}}$ must be **superconvergent**. Superconvergence means that $\\tilde{\\boldsymbol{q}}$ converges to the true flux $\\boldsymbol{q}$ at a higher order of accuracy with respect to the mesh size $h$ than the original discrete flux $\\boldsymbol{q}_h$ does. If the order of the finite elements is $p$, the convergence rate for the gradients (and thus for $\\boldsymbol{q}_h$) is typically $\\|\\boldsymbol{q}-\\boldsymbol{q}_h\\|_{L_2} = O(h^p)$. The recovery scheme is superconvergent if $\\|\\boldsymbol{q}-\\tilde{\\boldsymbol{q}}\\|_{L_2} = O(h^{p+r})$ for some $r > 0$. Under this condition, the error of the estimator, which is related to $\\boldsymbol{q} - \\tilde{\\boldsymbol{q}}$, vanishes faster than the estimated error itself, ensuring the consistency and asymptotic exactness of the indicator.\n\n**(b) Evaluation of the Indicator**\n\nWe are asked to evaluate the indicator $\\eta_K^2$ for the given element $K$ and fields. The formula is:\n$$\n\\eta_K^2 = \\int_K \\frac{1}{k}\\,|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV\n$$\nThe givens are:\n-   $K = [0,a]\\times[0,b]\\times[0,t]$ with $a=0.02\\,\\mathrm{m}$, $b=0.03\\,\\mathrm{m}$, $t=1\\,\\mathrm{m}$.\n-   $k = 12\\,\\mathrm{W/(m\\cdot K)}$.\n-   $\\boldsymbol{q}_h = \\begin{pmatrix}120\\\\-80\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2}$.\n-   $\\tilde{\\boldsymbol{q}}(x,y,z) = \\begin{pmatrix}120+1000\\,x-500\\,y\\\\-80+600\\,x+400\\,y\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2}$.\n\nFirst, we compute the difference between the recovered and discrete flux vectors:\n$$\n\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h = \\begin{pmatrix} (120+1000\\,x-500\\,y) - 120 \\\\ (-80+600\\,x+400\\,y) - (-80) \\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 1000\\,x-500\\,y \\\\ 600\\,x+400\\,y \\\\ 0 \\end{pmatrix}\n$$\nNext, we compute the squared magnitude of this vector:\n$$\n|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2 = (1000\\,x-500\\,y)^2 + (600\\,x+400\\,y)^2 + 0^2\n$$\n$$\n|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2 = (10^6 x^2 - 10^6 xy + 0.25 \\times 10^6 y^2) + (0.36 \\times 10^6 x^2 + 0.48 \\times 10^6 xy + 0.16 \\times 10^6 y^2)\n$$\n$$\n|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2 = (1.36 \\times 10^6) x^2 - (0.52 \\times 10^6) xy + (0.41 \\times 10^6) y^2\n$$\nNow, we set up the integral for $\\eta_K^2$. Since the integrand does not depend on $z$, the integration over $z$ from $0$ to $t$ simply multiplies the result by $t$.\n$$\n\\eta_K^2 = \\frac{t}{k} \\int_0^b \\int_0^a \\left[ (1.36 \\times 10^6) x^2 - (0.52 \\times 10^6) xy + (0.41 \\times 10^6) y^2 \\right] \\,dx\\,dy\n$$\nWe perform the integration term by term, denoting the double integral as $I$:\n$$\nI = \\int_0^b \\int_0^a \\left[ (1.36 \\times 10^6) x^2 - (0.52 \\times 10^6) xy + (0.41 \\times 10^6) y^2 \\right] \\,dx\\,dy\n$$\n$$\nI = (1.36 \\times 10^6) \\int_0^b \\int_0^a x^2 \\,dx\\,dy - (0.52 \\times 10^6) \\int_0^b \\int_0^a xy \\,dx\\,dy + (0.41 \\times 10^6) \\int_0^b \\int_0^a y^2 \\,dx\\,dy\n$$\nThe separated integrals are:\n$$\n\\int_0^b \\int_0^a x^2 \\,dx\\,dy = \\left(\\frac{a^3}{3}\\right) b = \\frac{a^3b}{3}\n$$\n$$\n\\int_0^b \\int_0^a xy \\,dx\\,dy = \\left(\\frac{a^2}{2}\\right) \\left(\\frac{b^2}{2}\\right) = \\frac{a^2b^2}{4}\n$$\n$$\n\\int_0^b \\int_0^a y^2 \\,dx\\,dy = a \\left(\\frac{b^3}{3}\\right) = \\frac{ab^3}{3}\n$$\nSubstituting these results back into the expression for $I$:\n$$\nI = (1.36 \\times 10^6) \\frac{a^3b}{3} - (0.52 \\times 10^6) \\frac{a^2b^2}{4} + (0.41 \\times 10^6) \\frac{ab^3}{3}\n$$\nNow, substitute the numerical values $a = 0.02$ and $b = 0.03$:\n$$\nI = (1.36 \\times 10^6) \\frac{(0.02)^3(0.03)}{3} - (0.52 \\times 10^6) \\frac{(0.02)^2(0.03)^2}{4} + (0.41 \\times 10^6) \\frac{(0.02)(0.03)^3}{3}\n$$\n$$\nI = (1.36 \\times 10^6) \\frac{(8 \\times 10^{-6})(3 \\times 10^{-2})}{3} - (0.52 \\times 10^6) \\frac{(4 \\times 10^{-4})(9 \\times 10^{-4})}{4} + (0.41 \\times 10^6) \\frac{(2 \\times 10^{-2})(27 \\times 10^{-6})}{3}\n$$\n$$\nI = (1.36 \\times 10^6)(8 \\times 10^{-8}) - (0.52 \\times 10^6)(9 \\times 10^{-8}) + (0.41 \\times 10^6)(18 \\times 10^{-8})\n$$\n$$\nI = 10.88 \\times 10^{-2} - 4.68 \\times 10^{-2} + 7.38 \\times 10^{-2}\n$$\n$$\nI = (10.88 - 4.68 + 7.38) \\times 10^{-2} = 13.58 \\times 10^{-2} = 0.1358\n$$\nThe volume integral of the squared flux difference is $\\int_K |\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV = t \\times I = 0.1358\\,\\mathrm{W}^2/\\mathrm{m}$.\nFinally, we compute $\\eta_K^2$:\n$$\n\\eta_K^2 = \\frac{\\int_K |\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV}{k} = \\frac{0.1358 \\,[\\mathrm{W^2/m}]}{12 \\,[\\mathrm{W/(m\\cdot K)}]} = 0.01131666... \\, \\mathrm{W \\cdot K}\n$$\nRounding to four significant figures, the value of the elementwise indicator is $0.01132\\,\\mathrm{W \\cdot K}$.",
            "answer": "$$\\boxed{0.01132}$$"
        },
        {
            "introduction": "After understanding the theory of mesh adaptivity and learning a practical method for error estimation, the final step is to ensure our computational solver is working correctly. This practice introduces the Method of Manufactured Solutions (MMS), a rigorous code verification technique where a chosen analytical solution is used to define the problem's source terms and boundary conditions. By comparing the solver's output against this known truth, you will predict and verify that the adaptive refinement process achieves the optimal convergence rate promised by finite element theory .",
            "id": "3934182",
            "problem": "Consider steady-state conduction in the unit square domain $\\Omega = (0,1)^{2}$ with spatially varying thermal conductivity. The governing equation is\n$$\\nabla \\cdot \\big(k(x,y)\\,\\nabla T(x,y)\\big) + q(x,y) = 0,$$\nwith Dirichlet boundary conditions equal to the exact manufactured temperature field. In order to verify an Adaptive Mesh Refinement (AMR) solver using $h$-adaptivity, assume the manufactured temperature field and conductivity are chosen as\n$$T(x,y) = \\exp(x)\\,\\cos(\\pi y), \\quad k(x,y) = 2 + \\sin(\\pi x)\\,\\sin(\\pi y),$$\nwhich ensures $k(x,y) \\geq 1$ for all $(x,y) \\in \\Omega$. The solver employs the Finite Element Method (FEM) with linear shape functions on shape-regular triangulations, and uses a residual-based $h$-adaptivity criterion combining element-wise volumetric residuals and flux-jump terms across edges, scaled by local mesh size.\n\nStarting from the strong form above and the given manufactured fields, derive the volumetric heat generation $q(x,y)$ that makes $T(x,y)$ an exact solution. Then, using fundamental convergence theory for the FEM in the energy norm under $h$-refinement guided by a reliable and efficient residual-based estimator for smooth solutions, predict the algebraic rate exponent $r$ such that the energy norm error satisfies\n$$\\|\\nabla(T - T_h)\\|_{L^{2}(\\Omega)} \\approx C\\,N^{-r},$$\nas the number of degrees of freedom $N \\to \\infty$, where $C$ is independent of $N$. Express the final answer as the value of $r$. No rounding is required. The final answer is dimensionless.",
            "solution": "The steady-state conduction equation with spatially varying conductivity is\n$$\\nabla \\cdot \\big(k\\,\\nabla T\\big) + q = 0.$$\nEquivalently,\n$$q = -\\,\\nabla \\cdot \\big(k\\,\\nabla T\\big).$$\nWe are given the manufactured temperature\n$$T(x,y) = \\exp(x)\\,\\cos(\\pi y),$$\nand conductivity\n$$k(x,y) = 2 + \\sin(\\pi x)\\,\\sin(\\pi y).$$\nTo compute $q(x,y)$, we use the product-divergence identity\n$$\\nabla \\cdot \\big(k\\,\\nabla T\\big) = k\\,\\Delta T + \\nabla k \\cdot \\nabla T.$$\nWe therefore need $\\Delta T$ and $\\nabla k \\cdot \\nabla T$.\n\nFirst, compute derivatives of $T(x,y)$:\n$$T_{x}(x,y) = \\exp(x)\\,\\cos(\\pi y), \\quad T_{y}(x,y) = -\\pi\\,\\exp(x)\\,\\sin(\\pi y).$$\nThus,\n$$T_{xx}(x,y) = \\exp(x)\\,\\cos(\\pi y),$$\n$$T_{yy}(x,y) = -\\pi^{2}\\,\\exp(x)\\,\\cos(\\pi y).$$\nHence the Laplacian is\n$$\\Delta T(x,y) = T_{xx}(x,y) + T_{yy}(x,y) = \\big(1 - \\pi^{2}\\big)\\,\\exp(x)\\,\\cos(\\pi y).$$\n\nNext, compute derivatives of $k(x,y)$:\n$$k_{x}(x,y) = \\pi\\,\\cos(\\pi x)\\,\\sin(\\pi y), \\quad k_{y}(x,y) = \\pi\\,\\sin(\\pi x)\\,\\cos(\\pi y).$$\nTherefore,\n\\begin{align*}\n\\nabla k \\cdot \\nabla T\n&= k_{x}\\,T_{x} + k_{y}\\,T_{y} \\\\\n&= \\big(\\pi\\,\\cos(\\pi x)\\,\\sin(\\pi y)\\big)\\,\\big(\\exp(x)\\,\\cos(\\pi y)\\big) + \\big(\\pi\\,\\sin(\\pi x)\\,\\cos(\\pi y)\\big)\\,\\big(-\\pi\\,\\exp(x)\\,\\sin(\\pi y)\\big) \\\\\n&= \\pi\\,\\exp(x)\\,\\cos(\\pi x)\\,\\sin(\\pi y)\\,\\cos(\\pi y) - \\pi^{2}\\,\\exp(x)\\,\\sin(\\pi x)\\,\\cos(\\pi y)\\,\\sin(\\pi y).\n\\end{align*}\nAlso,\n\\begin{align*}\nk\\,\\Delta T\n&= \\big(2 + \\sin(\\pi x)\\,\\sin(\\pi y)\\big)\\,\\big(1 - \\pi^{2}\\big)\\,\\exp(x)\\,\\cos(\\pi y).\n\\end{align*}\nCombining,\n\\begin{align*}\n\\nabla \\cdot \\big(k\\,\\nabla T\\big)\n&= \\nabla k \\cdot \\nabla T + k\\,\\Delta T \\\\\n&= \\pi\\,\\exp(x)\\,\\cos(\\pi x)\\,\\sin(\\pi y)\\,\\cos(\\pi y) - \\pi^{2}\\,\\exp(x)\\,\\sin(\\pi x)\\,\\cos(\\pi y)\\,\\sin(\\pi y) \\\\\n&\\quad + \\big(2 + \\sin(\\pi x)\\,\\sin(\\pi y)\\big)\\,\\big(1 - \\pi^{2}\\big)\\,\\exp(x)\\,\\cos(\\pi y).\n\\end{align*}\nTherefore,\n\\begin{align*}\nq(x,y)\n&= -\\,\\nabla \\cdot \\big(k\\,\\nabla T\\big) \\\\\n&= -\\,\\exp(x)\\,\\cos(\\pi y)\\,\\Big[\\sin(\\pi y)\\,\\big(\\pi\\,\\cos(\\pi x) - \\pi^{2}\\,\\sin(\\pi x)\\big) + \\big(1 - \\pi^{2}\\big)\\,\\big(2 + \\sin(\\pi x)\\,\\sin(\\pi y)\\big)\\Big].\n\\end{align*}\n\nWe now predict the algebraic convergence rate exponent $r$ in the energy norm under $h$-adaptive refinement guided by a residual-based estimator. The energy norm is\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)}.$$\nFor the Finite Element Method (FEM) with polynomial degree $p = 1$ (linear shape functions) on shape-regular triangulations, and for smooth exact solution $T$ and smooth conductivity $k$ bounded away from zero, standard a priori theory gives\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\le C\\,h^{p}\\,|T|_{H^{p+1}(\\Omega)},$$\nfor some constant $C$ independent of the mesh size $h$, provided $T \\in H^{p+1}(\\Omega)$. In our case, $T(x,y) = \\exp(x)\\,\\cos(\\pi y)$ is analytic on $\\Omega$, and $k(x,y) = 2 + \\sin(\\pi x)\\,\\sin(\\pi y)$ is smooth and strictly positive, so the regularity assumptions are satisfied.\n\nRelating $h$ to the number of degrees of freedom $N$ in two dimensions, one has $N \\propto h^{-2}$ for shape-regular meshes. Hence\n$$h \\propto N^{-1/2}.$$\nSubstituting into the energy-norm estimate yields\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\le C'\\,N^{-p/2},$$\nfor some constant $C'$ independent of $N$. With $p = 1$, this becomes\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\approx C\\,N^{-1/2}.$$\nResidual-based $h$-adaptivity criteria that are reliable and efficient for elliptic problems (combining volumetric residuals $q + \\nabla \\cdot (k\\,\\nabla T_{h})$ and flux-jump terms across inter-element boundaries, each appropriately scaled by local $h$) lead to equidistribution of the error density over elements for smooth solutions, thereby achieving the same optimal algebraic rate with respect to $N$. Therefore, the predicted exponent $r$ in\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\approx C\\,N^{-r}$$\nis\n$$r = \\frac{1}{2}.$$",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        }
    ]
}