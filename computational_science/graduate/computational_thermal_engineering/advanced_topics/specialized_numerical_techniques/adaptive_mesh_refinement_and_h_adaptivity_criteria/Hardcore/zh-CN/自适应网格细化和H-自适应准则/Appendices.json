{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础练习开始，为自适应网格剖分建立直观理解。通过分析一个简化的一维热输运问题，我们将能够解析地推导出“理想”的单元尺寸分布。该练习  阐释了误差均分的核心原理，即通过在解变化剧烈的区域（本例中为尖锐的边界层）加密网格，从而在整个计算域上保持均匀的误差水平。",
            "id": "3934281",
            "problem": "一个一维空间中的热传输过程在区间 $x \\in [0, L]$ 上由具有恒定属性的稳态对流扩散方程建模，\n$$u \\frac{d T}{d x} = \\alpha \\frac{d^{2} T}{d x^{2}},$$\n其中 $T(x)$ 是温度，$u > 0$ 是均匀流速，$\\alpha > 0$ 是热扩散率。边界条件为 $T(0) = T_{0}$ 和 $T(L) = T_{L}$，其中 $T_{0}$ 和 $T_{L}$ 是给定的常数。对于大佩克莱数 $Pe = \\frac{u L}{\\alpha}$，在精确解中，$x = L$ 附近会出现一个薄的流出边界层。\n\n在使用线性拉格朗日元的有限元方法 (FEM) 的自适应网格加密 (AMR) $h$-自适应范式中，假设单元尺寸分布 $h(x)$ 被设计为基于二阶导数监控函数来均分主阶插值误差，即局部插值误差与 $h(x)^{2} |T''(x)|$ 成比例。设期望的网格在 $[0, L]$ 上恰好由 $N$ 个单元组成，并强制执行约束 $\\int_{0}^{L} \\frac{dx}{h(x)} = N$。\n\n从控制方程和边界条件出发，推导在 $[0, L]$ 上均分主阶插值误差的目标单元尺寸函数 $h(x)$ 的精确表达式。将您的最终答案表示为关于 $L$、$u$、$\\alpha$ 和 $N$ 的单个闭式解析表达式。以米为单位表示 $h(x)$。不需要进行数值评估，也无需四舍五入。仅使用给定的符号和需要的基本常数。",
            "solution": "首先根据指定标准对问题陈述进行验证。\n\n### 第一步：提取已知条件\n- 控制方程：$u \\frac{d T}{d x} = \\alpha \\frac{d^{2} T}{d x^{2}}$\n- 域：$x \\in [0, L]$\n- 参数：$u > 0$, $\\alpha > 0$\n- 边界条件：$T(0) = T_{0}$, $T(L) = T_{L}$\n- 假设：大佩克莱数，$Pe = \\frac{u L}{\\alpha}$\n- AMR 准则：线性元的局部插值误差与 $h(x)^{2} |T''(x)|$ 成比例。网格尺寸分布 $h(x)$ 被设计为均分此误差。\n- 网格约束：单元总数为 $N$，表示为 $\\int_{0}^{L} \\frac{dx}{h(x)} = N$。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据**：问题在计算传热学的基本原理中有充分的依据。稳态对流扩散方程是输运现象的基础模型。佩克莱数、边界层、自适应网格加密 ($h$-自适应)、有限元方法 (FEM) 以及使用二阶导数监控函数的误差均分等概念都是计算科学与工程中的标准、成熟的课题。\n- **适定性**：该问题在数学上是适定的。它涉及求解一个具有指定边界条件的二阶线性常微分方程 (ODE) 的解析解，并随后使用该解来确定一个满足基于明确优化准则（误差均分）的积分约束的网格尺寸函数 $h(x)$。可以推导出一个唯一、稳定且有意义的 $h(x)$ 解。\n- **客观性**：问题以精确、客观、无歧义的数学语言陈述。所有术语都有正式定义或是该领域的标准术语。\n- **完整性与一致性**：问题是自洽的。它提供了推导所需函数 $h(x)$ 的所有必要信息——控制方程、边界条件、误差缩放定律以及单元数量的约束。所提供的信息中没有矛盾。\n\n### 第三步：结论与行动\n该问题是有效的，因为它科学合理、适定、客观且完整。我现在将开始推导解答。\n\n推导单元尺寸函数 $h(x)$ 需要几个步骤。首先，我们必须求出控制方程的精确解析解 $T(x)$。其次，我们计算其二阶导数 $T''(x)$。第三，我们形式化误差均分原理，并利用单元数量的积分约束来找到 $h(x)$ 的显式形式。\n\n**1. 温度 $T(x)$ 的解析解**\n\n控制方程是一个稳态一维对流扩散方程：\n$$u \\frac{d T}{d x} = \\alpha \\frac{d^{2} T}{d x^{2}}$$\n这是一个二阶线性齐次常微分方程，具有常数系数，可以重新排列为：\n$$\\alpha \\frac{d^{2} T}{d x^{2}} - u \\frac{d T}{d x} = 0$$\n我们寻求形如 $T(x) = \\exp(rx)$ 的解。特征方程为：\n$$\\alpha r^2 - u r = 0$$\n$$r(\\alpha r - u) = 0$$\n根为 $r_1 = 0$ 和 $r_2 = \\frac{u}{\\alpha}$。$T(x)$ 的通解是与这些根对应的解的线性组合：\n$$T(x) = C_1 \\exp(r_1 x) + C_2 \\exp(r_2 x) = C_1 + C_2 \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\n常数 $C_1$ 和 $C_2$ 由边界条件 $T(0) = T_0$ 和 $T(L) = T_L$ 确定。\n在 $x=0$ 处：\n$$T(0) = T_0 = C_1 + C_2 \\exp(0) \\implies T_0 = C_1 + C_2$$\n在 $x=L$ 处：\n$$T(L) = T_L = C_1 + C_2 \\exp\\left(\\frac{u L}{\\alpha}\\right)$$\n这是一个关于 $C_1$ 和 $C_2$ 的二元一次方程组。从第一个方程，我们得到 $C_1 = T_0 - C_2$。将其代入第二个方程得到：\n$$T_L = (T_0 - C_2) + C_2 \\exp\\left(\\frac{u L}{\\alpha}\\right) = T_0 + C_2 \\left(\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1\\right)$$\n求解 $C_2$：\n$$C_2 = \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1}$$\n求解 $C_1$：\n$$C_1 = T_0 - C_2 = T_0 - \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} = \\frac{T_0 \\exp\\left(\\frac{u L}{\\alpha}\\right) - T_0 - T_L + T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} = \\frac{T_0 \\exp\\left(\\frac{u L}{\\alpha}\\right) - T_L}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1}$$\n将 $C_1$ 和 $C_2$ 代回 $T(x)$ 的通解，得到精确解：\n$$T(x) = T_0 + (T_L - T_0) \\frac{\\exp\\left(\\frac{u x}{\\alpha}\\right) - 1}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1}$$\n\n**2. 解的二阶导数**\n\n误差均分准则基于二阶导数 $T''(x)$。我们将 $T(x)$ 对 $x$ 求导两次。\n一阶导数：\n$$\\frac{d T}{d x} = \\frac{d}{dx} \\left[ T_0 + (T_L - T_0) \\frac{\\exp\\left(\\frac{u x}{\\alpha}\\right) - 1}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right] = \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\left(\\frac{u}{\\alpha}\\right) \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\n二阶导数：\n$$\\frac{d^2 T}{d x^2} = \\frac{d}{dx} \\left[ \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\left(\\frac{u}{\\alpha}\\right) \\exp\\left(\\frac{u x}{\\alpha}\\right) \\right] = \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\left(\\frac{u}{\\alpha}\\right)^2 \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\n\n**3. 单元尺寸函数 $h(x)$ 的推导**\n\n问题陈述指出，单元尺寸分布 $h(x)$ 被设计为均分主阶插值误差，该误差与 $h(x)^{2} |T''(x)|$ 成比例。均分原理要求此量在整个域上为常数：\n$$h(x)^2 |T''(x)| = C_{eq}$$\n其中 $C_{eq}$ 是一个常数。这意味着单元尺寸 $h(x)$ 应为：\n$$h(x) = \\frac{\\sqrt{C_{eq}}}{|T''(x)|^{1/2}}$$\n常数 $\\sqrt{C_{eq}}$ 由网格必须恰好包含 $N$ 个单元的约束确定。在连续极限下，这表示为：\n$$\\int_{0}^{L} \\frac{dx}{h(x)} = N$$\n将 $h(x)$ 的表达式代入约束条件：\n$$\\int_{0}^{L} \\frac{|T''(x)|^{1/2}}{\\sqrt{C_{eq}}} dx = N$$\n求解 $\\sqrt{C_{eq}}$：\n$$\\sqrt{C_{eq}} = \\frac{1}{N} \\int_{0}^{L} |T''(x')|^{1/2} dx'$$\n（为清晰起见，使用 $x'$ 作为积分变量）。将此代回 $h(x)$ 的表达式，得到最优网格尺寸函数的一般公式：\n$$h(x) = \\frac{\\frac{1}{N} \\int_{0}^{L} |T''(x')|^{1/2} dx'}{|T''(x)|^{1/2}}$$\n现在，我们将此公式应用于我们的特定问题。首先，我们求 $|T''(x)|^{1/2}$：\n$$|T''(x)| = \\left| \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right| \\left(\\frac{u}{\\alpha}\\right)^2 \\exp\\left(\\frac{u x}{\\alpha}\\right)$$\n取平方根：\n$$|T''(x)|^{1/2} = \\left| \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right|^{1/2} \\left(\\frac{u}{\\alpha}\\right) \\exp\\left(\\frac{u x}{2\\alpha}\\right)$$\n这可以写成 $|T''(x)|^{1/2} = C_A \\exp\\left(\\frac{u x}{2\\alpha}\\right)$，其中 $C_A = \\left| \\frac{T_L - T_0}{\\exp\\left(\\frac{u L}{\\alpha}\\right) - 1} \\right|^{1/2} \\frac{u}{\\alpha}$ 是一个不依赖于 $x$ 的常数。\n\n接下来，我们计算分子中的积分：\n$$\\int_{0}^{L} |T''(x')|^{1/2} dx' = \\int_{0}^{L} C_A \\exp\\left(\\frac{u x'}{2\\alpha}\\right) dx' = C_A \\left[ \\frac{2\\alpha}{u} \\exp\\left(\\frac{u x'}{2\\alpha}\\right) \\right]_{0}^{L}$$\n$$= C_A \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - \\exp(0)\\right) = C_A \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right)$$\n现在我们将这个积分和 $|T''(x)|^{1/2}$ 的表达式代回 $h(x)$ 的一般公式：\n$$h(x) = \\frac{1}{N} \\frac{C_A \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right)}{C_A \\exp\\left(\\frac{u x}{2\\alpha}\\right)}$$\n常数 $C_A$ 被消掉了。这是一个关键结果，因为它意味着最优单元尺寸分布与具体的边界温度值 $T_0$ 和 $T_L$ 无关，仅取决于系统参数 $u、\\alpha、L$ 和网格参数 $N$。\n简化 $h(x)$ 的表达式：\n$$h(x) = \\frac{1}{N} \\frac{2\\alpha}{u} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right) \\frac{1}{\\exp\\left(\\frac{u x}{2\\alpha}\\right)}$$\n$$h(x) = \\frac{2\\alpha}{Nu} \\left(\\exp\\left(\\frac{u L}{2\\alpha}\\right) - 1\\right) \\exp\\left(-\\frac{u x}{2\\alpha}\\right)$$\n这是目标单元尺寸函数 $h(x)$ 的最终表达式。该函数是一个衰减的指数函数，表明网格应在流出边界 $x=L$ 处最密（$h$ 最小），这与大佩克莱数下该区域存在边界层的情况一致。表达式的单位是米，因为 $\\frac{\\alpha}{u}$ 的单位是长度（$\\frac{m^2/s}{m/s} = m$），而 $N$ 和指数项是无量纲的。",
            "answer": "$$\n\\boxed{\\frac{2\\alpha}{Nu} \\left(\\exp\\left(\\frac{uL}{2\\alpha}\\right) - 1\\right) \\exp\\left(-\\frac{ux}{2\\alpha}\\right)}\n$$"
        },
        {
            "introduction": "虽然解析示例很有启发性，但在实际仿真中，我们必须在不知道精确解的情况下估计误差。这正是“后验”误差估计的目标。本练习  将介绍一种最著名且广泛使用的技术：Zienkiewicz-Zhu 误差估计子。你将推导如何利用一个“恢复”的、更精确的热通量场，来构造一个可计算的指标，从而可靠地指导网格加密。",
            "id": "3934228",
            "problem": "考虑一个域 $\\Omega$ 内的稳态热传导，其由傅里叶定律 $\\,\\boldsymbol{q}=-k\\,\\nabla T\\,$ 和守恒方程 $-\\nabla\\cdot(k\\,\\nabla T)=f$ 控制，其中 $k(\\boldsymbol{x})>0$ 是热导率，$T$ 是温度，$\\boldsymbol{q}$ 是热通量。设 $T_h\\in H^1(\\Omega)$ 是通过有限元法 (FEM) 获得的协调有限元近似解，并定义离散通量 $\\boldsymbol{q}_h:=-k\\,\\nabla T_h$。在一个单元 $K\\subset\\Omega$ 上，考虑一个通量恢复过程，该过程产生一个连续的恢复场 $\\tilde{\\boldsymbol{q}}$，在渐近加密的意义上，它比 $\\boldsymbol{q}_h$ 更精确地逼近精确通量 $\\boldsymbol{q}$。\n\n(a) 从误差 $e:=T-T_h$ 的热加权能量范数 $\\,\\|e\\|_{E(K)}^2:=\\int_K k\\,\\nabla e\\cdot\\nabla e\\,dV\\,$ 出发，推导一个仅基于 $\\boldsymbol{q}_h$ 和恢复通量 $\\tilde{\\boldsymbol{q}}$ 的单元可计算指标，并解释在何种渐近条件（关于 $h$-加密和恢复质量）下，该指标与误差的能量范数一致。\n\n(b) 现在，对于以下科学上合理的单元和场，计算你在(a)部分推导出的指标。设 $K=[0,a]\\times[0,b]\\times[0,t]$，其中 $a=0.02\\,\\mathrm{m}$，$b=0.03\\,\\mathrm{m}$，$t=1\\,\\mathrm{m}$，并且单元 $K$ 上的热导率为常数 $k=12\\,\\mathrm{W/(m\\cdot K)}$。取单元 $K$ 上的离散通量为常数\n$$\n\\boldsymbol{q}_h = \\begin{pmatrix}120\\\\-80\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2},\n$$\n以及一个在平面内坐标上线性且与 $z$ 无关的恢复通量场\n$$\n\\tilde{\\boldsymbol{q}}(x,y,z) = \\begin{pmatrix}120+1000\\,x-500\\,y\\\\-80+600\\,x+400\\,y\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2}.\n$$\n计算单元指标值。将你的答案四舍五入到四位有效数字，并以 $\\mathrm{W\\cdot K}$ 为单位表示最终值。",
            "solution": "**(a) 误差指标的推导与一致性**\n\n问题要求为稳态热传导问题的有限元近似提供一个单元可计算的误差指标。该指标应基于单元 $K$ 上误差 $e = T - T_h$ 的热加权能量范数。\n\n单元 $K$ 上误差的能量范数的平方定义为：\n$$\n\\|e\\|_{E(K)}^2 := \\int_K k\\,\\nabla e\\cdot\\nabla e\\,dV\n$$\n代入误差的定义 $e = T - T_h$，我们有 $\\nabla e = \\nabla T - \\nabla T_h$。表达式变为：\n$$\n\\|e\\|_{E(K)}^2 = \\int_K k\\,(\\nabla T - \\nabla T_h)\\cdot(\\nabla T - \\nabla T_h)\\,dV\n$$\n精确通量 $\\boldsymbol{q}$ 和离散通量 $\\boldsymbol{q}_h$ 由傅里叶定律给出：\n$$\n\\boldsymbol{q} = -k\\,\\nabla T \\implies \\nabla T = -\\frac{1}{k}\\boldsymbol{q}\n$$\n$$\n\\boldsymbol{q}_h = -k\\,\\nabla T_h \\implies \\nabla T_h = -\\frac{1}{k}\\boldsymbol{q}_h\n$$\n将这些梯度的表达式代入误差范数的积分中，得到：\n$$\n\\|e\\|_{E(K)}^2 = \\int_K k\\,\\left(-\\frac{1}{k}\\boldsymbol{q} - \\left(-\\frac{1}{k}\\boldsymbol{q}_h\\right)\\right)\\cdot\\left(-\\frac{1}{k}\\boldsymbol{q} - \\left(-\\frac{1}{k}\\boldsymbol{q}_h\\right)\\right)\\,dV\n$$\n$$\n\\|e\\|_{E(K)}^2 = \\int_K k\\,\\left(\\frac{1}{k}(\\boldsymbol{q}_h - \\boldsymbol{q})\\right)\\cdot\\left(\\frac{1}{k}(\\boldsymbol{q}_h - \\boldsymbol{q})\\right)\\,dV\n$$\n$$\n\\|e\\|_{E(K)}^2 = \\int_K \\frac{1}{k}\\,(\\boldsymbol{q} - \\boldsymbol{q}_h)\\cdot(\\boldsymbol{q} - \\boldsymbol{q}_h)\\,dV = \\int_K \\frac{1}{k}\\,|\\boldsymbol{q} - \\boldsymbol{q}_h|^2\\,dV\n$$\n这个表达式代表了精确的误差平方，但它是不可计算的，因为精确通量 $\\boldsymbol{q}$ 是未知的。后验误差估计的核心思想是用一个更精确的近似来代替未知的精确解。问题引入了一个恢复通量 $\\tilde{\\boldsymbol{q}}$，它被设计成比 $\\boldsymbol{q}_h$ 更好地逼近 $\\boldsymbol{q}$。\n\n我们通过在误差范数平方的表达式中用 $\\tilde{\\boldsymbol{q}}$ 代替 $\\boldsymbol{q}$，得到一个可计算的误差指标，我们记为 $\\eta_K^2$：\n$$\n\\eta_K^2 = \\int_K \\frac{1}{k}\\,|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV\n$$\n这就是所求的单元可计算指标，被称为 Zienkiewicz-Zhu 误差估计子。\n\n为了使该指标与真实误差一致，量 $\\eta_K$ 必须是 $\\|e\\|_{E(K)}$ 的一个良好近似。这由单元效率指数 $\\theta_K = \\eta_K / \\|e\\|_{E(K)}$ 来正式刻画，当网格尺寸 $h$ 趋于零时，该指数应趋近于 $1$。此性质被称为渐近精确性。\n\n$\\eta_K$ 成为 $\\|e\\|_{E(K)}$ 的良好近似的条件与通量恢复的质量有关。根据与内积 $\\langle \\boldsymbol{a}, \\boldsymbol{b} \\rangle = \\int_K \\frac{1}{k} \\boldsymbol{a} \\cdot \\boldsymbol{b} \\, dV$ 相应的范数的三角不等式，我们有：\n$$\n\\left| \\|\\boldsymbol{q} - \\boldsymbol{q}_h\\| - \\|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h\\| \\right| \\leq \\|\\boldsymbol{q} - \\tilde{\\boldsymbol{q}}\\|\n$$\n其中 $\\|\\cdot\\|$ 表示由此内积导出的范数。为了使指标准确，$\\|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h\\|$ 必须接近 $\\|\\boldsymbol{q} - \\boldsymbol{q}_h\\|$。这种情况发生在 $\\|\\boldsymbol{q} - \\tilde{\\boldsymbol{q}}\\|$ 远小于 $\\|\\boldsymbol{q} - \\boldsymbol{q}_h\\|$ 时。\n\n这导出了关键的渐近条件：恢复通量 $\\tilde{\\boldsymbol{q}}$ 必须是**超收敛**的。超收敛意味着，相对于网格尺寸 $h$，$\\tilde{\\boldsymbol{q}}$ 收敛到真实通量 $\\boldsymbol{q}$ 的精度阶高于原始离散通量 $\\boldsymbol{q}_h$ 的收敛阶。如果有限元的阶数为 $p$，则梯度（以及 $\\boldsymbol{q}_h$）的收敛率通常为 $\\|\\boldsymbol{q}-\\boldsymbol{q}_h\\|_{L_2} = \\mathcal{O}(h^p)$。如果对于某个 $r > 0$ 有 $\\|\\boldsymbol{q}-\\tilde{\\boldsymbol{q}}\\|_{L_2} = \\mathcal{O}(h^{p+r})$，则该恢复方案是超收敛的。在此条件下，与 $\\boldsymbol{q} - \\tilde{\\boldsymbol{q}}$ 相关的估计子误差比被估计的误差本身消失得更快，从而确保了指标的一致性和渐近精确性。\n\n**(b) 指标的计算**\n\n我们被要求对给定的单元 $K$ 和场计算指标 $\\eta_K^2$。公式为：\n$$\n\\eta_K^2 = \\int_K \\frac{1}{k}\\,|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV\n$$\n已知条件如下：\n-   $K = [0,a]\\times[0,b]\\times[0,t]$，其中 $a=0.02\\,\\mathrm{m}$，$b=0.03\\,\\mathrm{m}$，$t=1\\,\\mathrm{m}$。\n-   $k = 12\\,\\mathrm{W/(m\\cdot K)}$。\n-   $\\boldsymbol{q}_h = \\begin{pmatrix}120\\\\-80\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2}$。\n-   $\\tilde{\\boldsymbol{q}}(x,y,z) = \\begin{pmatrix}120+1000\\,x-500\\,y\\\\-80+600\\,x+400\\,y\\\\0\\end{pmatrix}\\,\\mathrm{W/m^2}$。\n\n首先，我们计算恢复通量向量与离散通量向量之差：\n$$\n\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h = \\begin{pmatrix} (120+1000\\,x-500\\,y) - 120 \\\\ (-80+600\\,x+400\\,y) - (-80) \\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 1000\\,x-500\\,y \\\\ 600\\,x+400\\,y \\\\ 0 \\end{pmatrix}\n$$\n接下来，我们计算该向量的模的平方：\n$$\n|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2 = (1000\\,x-500\\,y)^2 + (600\\,x+400\\,y)^2 + 0^2\n$$\n$$\n|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2 = (10^6 x^2 - 10^6 xy + 0.25 \\times 10^6 y^2) + (0.36 \\times 10^6 x^2 + 0.48 \\times 10^6 xy + 0.16 \\times 10^6 y^2)\n$$\n$$\n|\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2 = (1.36 \\times 10^6) x^2 - (0.52 \\times 10^6) xy + (0.41 \\times 10^6) y^2\n$$\n现在，我们建立 $\\eta_K^2$ 的积分。由于被积函数不依赖于 $z$，从 $0$ 到 $t$ 对 $z$ 的积分只是将结果乘以 $t$。\n$$\n\\eta_K^2 = \\frac{t}{k} \\int_0^b \\int_0^a \\left[ (1.36 \\times 10^6) x^2 - (0.52 \\times 10^6) xy + (0.41 \\times 10^6) y^2 \\right] \\,dx\\,dy\n$$\n我们逐项进行积分：\n$$\nI = \\int_0^b \\int_0^a \\left[ (1.36 \\times 10^6) x^2 - (0.52 \\times 10^6) xy + (0.41 \\times 10^6) y^2 \\right] \\,dx\\,dy\n$$\n$$\nI = (1.36 \\times 10^6) \\int_0^b \\int_0^a x^2 \\,dx\\,dy - (0.52 \\times 10^6) \\int_0^b \\int_0^a xy \\,dx\\,dy + (0.41 \\times 10^6) \\int_0^b \\int_0^a y^2 \\,dx\\,dy\n$$\n分离后的积分为：\n$$\n\\int_0^b \\int_0^a x^2 \\,dx\\,dy = \\left(\\frac{a^3}{3}\\right) b = \\frac{a^3b}{3}\n$$\n$$\n\\int_0^b \\int_0^a xy \\,dx\\,dy = \\left(\\frac{a^2}{2}\\right) \\left(\\frac{b^2}{2}\\right) = \\frac{a^2b^2}{4}\n$$\n$$\n\\int_0^b \\int_0^a y^2 \\,dx\\,dy = a \\left(\\frac{b^3}{3}\\right) = \\frac{ab^3}{3}\n$$\n将这些结果代回 $I$ 的表达式中：\n$$\nI = (1.36 \\times 10^6) \\frac{a^3b}{3} - (0.52 \\times 10^6) \\frac{a^2b^2}{4} + (0.41 \\times 10^6) \\frac{ab^3}{3}\n$$\n现在，代入数值 $a = 0.02$ 和 $b = 0.03$：\n$$\nI = (1.36 \\times 10^6) \\frac{(0.02)^3(0.03)}{3} - (0.52 \\times 10^6) \\frac{(0.02)^2(0.03)^2}{4} + (0.41 \\times 10^6) \\frac{(0.02)(0.03)^3}{3}\n$$\n$$\nI = (1.36 \\times 10^6) \\frac{(8 \\times 10^{-6})(3 \\times 10^{-2})}{3} - (0.52 \\times 10^6) \\frac{(4 \\times 10^{-4})(9 \\times 10^{-4})}{4} + (0.41 \\times 10^6) \\frac{(2 \\times 10^{-2})(27 \\times 10^{-6})}{3}\n$$\n$$\nI = (1.36 \\times 10^6)(8 \\times 10^{-8}) - (0.52 \\times 10^6)(9 \\times 10^{-8}) + (0.41 \\times 10^6)(18 \\times 10^{-8})\n$$\n$$\nI = 0.1088 - 0.0468 + 0.0738\n$$\n$$\nI = 0.1358\n$$\n注意，这个积分 $I$ 的单位是 $\\mathrm{W}^2/\\mathrm{m}^2$。我们需要的全体积积分为 $\\int_K |\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV = t \\times I = 1 \\times 0.1358 = 0.1358\\,\\mathrm{W}^2/\\mathrm{m}$。\n最后，我们计算 $\\eta_K^2$：\n$$\n\\eta_K^2 = \\frac{1}{k} \\int_K |\\tilde{\\boldsymbol{q}} - \\boldsymbol{q}_h|^2\\,dV = \\frac{0.1358 \\,[\\mathrm{W^2/m}]}{12 \\,[\\mathrm{W/(m\\cdot K)}]}\n$$\n$$\n\\eta_K^2 = 0.01131666... \\,\\mathrm{W \\cdot K}\n$$\n四舍五入到四位有效数字，单元指标的值为 $0.01132\\,\\mathrm{W \\cdot K}$。",
            "answer": "$$\\boxed{0.01132}$$"
        },
        {
            "introduction": "构建自适应求解器后，我们必须验证其性能是否符合预期。这最后一个练习  将介绍“人造解方法”（Method of Manufactured Solutions, MMS），这是计算科学中软件验证的基石。通过构造一个具有已知解析解的问题，我们可以严格测试自适应算法，并预测它是否达到了有限元理论所承诺的最优收敛率。",
            "id": "3934182",
            "problem": "考虑在单位正方形域 $\\Omega = (0,1)^{2}$ 内的稳态热传导问题，其导热系数随空间变化。控制方程为\n$$\\nabla \\cdot \\big(k(x,y)\\,\\nabla T(x,y)\\big) + q(x,y) = 0,$$\n其狄利克雷边界条件等于精确的人工制造温度场。为了验证一个使用 $h$-自适应的自适应网格加密（AMR）求解器，假设人工制造的温度场和导热系数选择为\n$$T(x,y) = \\exp(x)\\,\\cos(\\pi y), \\quad k(x,y) = 2 + \\sin(\\pi x)\\,\\sin(\\pi y),$$\n这确保了对于所有 $(x,y) \\in \\Omega$，$k(x,y) \\geq 1$。该求解器采用有限元法（FEM），在形态规则的三角剖分上使用线性形函数，并使用一个基于残差的 $h$-自适应准则，该准则结合了按局部网格尺寸缩放的单元体积残差和跨边的通量跳跃项。\n\n从上述强形式和给定的人工制造场出发，推导使 $T(x,y)$ 成为精确解的体积热源 $q(x,y)$。然后，利用有限元法在能量范数下的基本收敛理论，在针对光滑解的可靠且高效的基于残差的估计器引导的 $h$-加密下，预测代数收敛率指数 $r$，使得能量范数误差满足\n$$\\|\\nabla(T - T_h)\\|_{L^{2}(\\Omega)} \\approx C\\,N^{-r},$$\n当自由度数 $N \\to \\infty$ 时，其中 $C$ 与 $N$ 无关。最终答案以 $r$ 的值表示。无需四舍五入。最终答案是无量纲的。",
            "solution": "随空间变化的导热系数的稳态热传导方程为\n$$\\nabla \\cdot \\big(k\\,\\nabla T\\big) + q = 0.$$\n等价地，\n$$q = -\\,\\nabla \\cdot \\big(k\\,\\nabla T\\big).$$\n我们已知人工制造的温度\n$$T(x,y) = \\exp(x)\\,\\cos(\\pi y),$$\n和导热系数\n$$k(x,y) = 2 + \\sin(\\pi x)\\,\\sin(\\pi y).$$\n为了计算 $q(x,y)$，我们使用乘积-散度恒等式\n$$\\nabla \\cdot \\big(k\\,\\nabla T\\big) = k\\,\\Delta T + \\nabla k \\cdot \\nabla T.$$\n因此我们需要 $\\Delta T$ 和 $\\nabla k \\cdot \\nabla T$。\n\n首先，计算 $T(x,y)$ 的导数：\n$$T_{x}(x,y) = \\exp(x)\\,\\cos(\\pi y), \\quad T_{y}(x,y) = -\\pi\\,\\exp(x)\\,\\sin(\\pi y).$$\n因此，\n$$T_{xx}(x,y) = \\exp(x)\\,\\cos(\\pi y),$$\n$$T_{yy}(x,y) = -\\pi^{2}\\,\\exp(x)\\,\\cos(\\pi y).$$\n因此拉普拉斯算子为\n$$\\Delta T(x,y) = T_{xx}(x,y) + T_{yy}(x,y) = \\big(1 - \\pi^{2}\\big)\\,\\exp(x)\\,\\cos(\\pi y).$$\n\n接下来，计算 $k(x,y)$ 的导数：\n$$k_{x}(x,y) = \\pi\\,\\cos(\\pi x)\\,\\sin(\\pi y), \\quad k_{y}(x,y) = \\pi\\,\\sin(\\pi x)\\,\\cos(\\pi y).$$\n所以，\n\\begin{align*}\n\\nabla k \\cdot \\nabla T\n= k_{x}\\,T_{x} + k_{y}\\,T_{y} \\\\\n= \\big(\\pi\\,\\cos(\\pi x)\\,\\sin(\\pi y)\\big)\\,\\big(\\exp(x)\\,\\cos(\\pi y)\\big) + \\big(\\pi\\,\\sin(\\pi x)\\,\\cos(\\pi y)\\big)\\,\\big(-\\pi\\,\\exp(x)\\,\\sin(\\pi y)\\big) \\\\\n= \\pi\\,\\exp(x)\\,\\cos(\\pi x)\\,\\sin(\\pi y)\\,\\cos(\\pi y) - \\pi^{2}\\,\\exp(x)\\,\\sin(\\pi x)\\,\\cos(\\pi y)\\,\\sin(\\pi y).\n\\end{align*}\n另外，\n\\begin{align*}\nk\\,\\Delta T\n= \\big(2 + \\sin(\\pi x)\\,\\sin(\\pi y)\\big)\\,\\big(1 - \\pi^{2}\\big)\\,\\exp(x)\\,\\cos(\\pi y).\n\\end{align*}\n合并起来，\n\\begin{align*}\n\\nabla \\cdot \\big(k\\,\\nabla T\\big)\n= \\nabla k \\cdot \\nabla T + k\\,\\Delta T \\\\\n= \\pi\\,\\exp(x)\\,\\cos(\\pi x)\\,\\sin(\\pi y)\\,\\cos(\\pi y) - \\pi^{2}\\,\\exp(x)\\,\\sin(\\pi x)\\,\\cos(\\pi y)\\,\\sin(\\pi y) \\\\\n\\quad + \\big(2 + \\sin(\\pi x)\\,\\sin(\\pi y)\\big)\\,\\big(1 - \\pi^{2}\\big)\\,\\exp(x)\\,\\cos(\\pi y).\n\\end{align*}\n所以，\n\\begin{align*}\nq(x,y)\n= -\\,\\nabla \\cdot \\big(k\\,\\nabla T\\big) \\\\\n= -\\,\\exp(x)\\,\\cos(\\pi y)\\,\\Big[\\sin(\\pi y)\\,\\big(\\pi\\,\\cos(\\pi x) - \\pi^{2}\\,\\sin(\\pi x)\\big) + \\big(1 - \\pi^{2}\\big)\\,\\big(2 + \\sin(\\pi x)\\,\\sin(\\pi y)\\big)\\Big].\n\\end{align*}\n\n我们现在预测在基于残差的估计器引导的 $h$-自适应加密下，能量范数中的代数收敛率指数 $r$。能量范数为\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)}.$$\n对于在形态规则的三角剖分上使用多项式次数 $p = 1$（线性形函数）的有限元法（FEM），并且对于光滑的精确解 $T$ 和有正下界的光滑导热系数 $k$，标准的先验理论给出\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\le C\\,h^{p}\\,|T|_{H^{p+1}(\\Omega)},$$\n对于某个与网格尺寸 $h$ 无关的常数 $C$，只要 $T \\in H^{p+1}(\\Omega)$。在我们的情况下，$T(x,y) = \\exp(x)\\,\\cos(\\pi y)$ 在 $\\Omega$ 上是解析的，并且 $k(x,y) = 2 + \\sin(\\pi x)\\,\\sin(\\pi y)$ 是光滑且严格为正的，因此正则性假设得到满足。\n\n在二维空间中，将 $h$ 与自由度数 $N$ 相关联，对于形态规则的网格，有 $N \\propto h^{-2}$。因此\n$$h \\propto N^{-1/2}.$$\n将其代入能量范数估计式可得\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\le C'\\,N^{-p/2},$$\n对于某个与 $N$ 无关的常数 $C'$。当 $p = 1$ 时，这变成\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\approx C\\,N^{-1/2}.$$\n对于椭圆问题，可靠且高效的基于残差的 $h$-自适应准则（结合了体积残差 $q + \\nabla \\cdot (k\\,\\nabla T_{h})$ 和跨单元间边界的通量跳跃项，每一项都按局部 $h$ 进行适当缩放）能够使得光滑解的误差密度在单元上均匀分布，从而实现相对于 $N$ 的相同的最优代数收敛率。因此，下式中的预测指数 $r$\n$$\\|\\nabla(T - T_{h})\\|_{L^{2}(\\Omega)} \\approx C\\,N^{-r}$$\n为\n$$r = \\frac{1}{2}.$$",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        }
    ]
}