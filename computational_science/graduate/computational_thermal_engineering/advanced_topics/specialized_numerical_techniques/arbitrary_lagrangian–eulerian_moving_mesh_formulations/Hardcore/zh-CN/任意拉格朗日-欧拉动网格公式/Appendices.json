{
    "hands_on_practices": [
        {
            "introduction": "在任意拉格朗日-欧拉（ALE）方法中，一个核心问题是如何根据边界的运动来确定计算域内部网格节点的光滑运动。一种常用且稳健的技术是谐波延拓，即通过求解拉普拉斯方程来生成网格位移或速度。本练习  旨在揭示该方法应用于刚体运动时的一个重要特性，帮助您深入理解椭圆偏微分方程在此背景下的行为，并掌握ALE网格运动的基本原理。",
            "id": "3937140",
            "problem": "考虑一个二维有界单连通计算域 $\\Omega \\subset \\mathbb{R}^{2}$，其具有包含原点的 Lipschitz 边界 $\\partial \\Omega$。该域中进行瞬态传热计算，采用任意拉格朗日-欧拉（ALE）框架，其中网格运动通过网格速度进入能量方程的 ALE 形式。物理边界经历一个指定的刚体运动，该运动由速度为 $\\mathbf{V}(t) = \\left(V_{x}(t), V_{y}(t)\\right)$ 的随时间变化的平移和角速度为 $\\omega(t)$（逆时针旋转为正）的绕原点的随时间变化的平面内旋转组成。令 $\\mathbf{x} = (x,y)$ 表示当前构形中的空间坐标。\n\n采用调和提升来获得平滑的内部网格运动：具体来说，令网格位移 $\\mathbf{d}(\\mathbf{x},t)$ 求解 $\\Omega$ 内的矢量拉普拉斯方程，其狄利克雷数据等于 $\\partial \\Omega$ 上的物理边到位移。等效地，网格速度 $\\mathbf{w}(\\mathbf{x},t) = \\partial \\mathbf{d}(\\mathbf{x},t)/\\partial t$ 在 $\\Omega$ 内逐分量满足矢量拉普拉斯方程，其在 $\\partial \\Omega$ 上的狄利克雷边界值等于物理边界速度 $\\mathbf{u}_{b}(\\mathbf{x},t)$。指定的边界速度为刚体速度\n$$\n\\mathbf{u}_{b}(\\mathbf{x},t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x},\n$$\n其中 $\\mathbf{k}$ 是与该平面正交的单位矢量，且 $\\mathbf{k} \\times \\mathbf{x} = (-y, x)$。\n\n从椭圆偏微分方程的基本事实和刚体运动的性质出发，推导由边界速度的调和提升产生的唯一内部网格速度场 $\\mathbf{w}(\\mathbf{x},t)$，然后计算在特定时间 $t_{0}$ 位于特定网格节点 $\\mathbf{x}_{0} = (x_{0}, y_{0})$ 处的内部网格速度。将最终答案表示为给出 $\\mathbf{w}(\\mathbf{x}_{0}, t_{0})$ 的单个解析表达式。不需要数值。如果选择分量形式书写结果，请将其表示为单个行向量。最终答案中不要提供单位。",
            "solution": "首先将对问题的科学性和数学合理性进行验证。\n\n### 步骤 1：提取已知条件\n-   **计算域**：一个二维、有界、单连通的域 $\\Omega \\subset \\mathbb{R}^{2}$，其 Lipschitz 边界 $\\partial \\Omega$ 包含原点。\n-   **方法**：用于瞬态传热的任意拉格朗日-欧拉（ALE）框架。\n-   **网格运动**：网格速度 $\\mathbf{w}(\\mathbf{x},t) = \\frac{\\partial \\mathbf{d}(\\mathbf{x},t)}{\\partial t}$（其中 $\\mathbf{d}$ 是网格位移）通过调和提升获得。\n-   **网格速度的控制方程**：网格速度场 $\\mathbf{w}(\\mathbf{x},t)$ 在域 $\\Omega$ 内逐分量满足矢量拉普拉斯方程 $\\nabla^2 \\mathbf{w} = \\mathbf{0}$。\n-   **网格速度的边界条件**：在边界 $\\partial \\Omega$ 上，网格速度由物理边界速度 $\\mathbf{u}_{b}(\\mathbf{x},t)$ 指定。这作为 $\\mathbf{w}(\\mathbf{x},t)$ 的狄利克雷边界条件。\n-   **指定的边界速度**：边界经历刚体运动，由 $\\mathbf{u}_{b}(\\mathbf{x},t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}$ 给出，其中 $\\mathbf{x}=(x,y) \\in \\partial\\Omega$。\n-   **定义**：$\\mathbf{V}(t) = (V_{x}(t), V_{y}(t))$ 是平移速度。$\\omega(t)$ 是绕原点的标量角速度。$\\mathbf{k}$ 是与 $xy$ 平面正交的单位矢量，叉积定义为 $\\mathbf{k} \\times \\mathbf{x} = (-y, x)$。\n-   **目标**：推导内部网格速度场 $\\mathbf{w}(\\mathbf{x},t)$，并计算其在特定时间 $t_0$ 位于特定点 $\\mathbf{x}_{0} = (x_0, y_0)$ 处的值。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在计算流体力学和传热领域有充分的依据。对于移动边界问题，使用 ALE 框架是标准做法。调和提升（为网格位移或速度求解拉普拉斯方程）是一种广泛使用且公认的技术，用于从指定的边界运动生成平滑的内部网格运动。刚体速度的表达式是运动学的基础。该提法在科学上是合理的。\n-   **适定性**：该问题可归结为在有界域 $\\Omega$ 上求解矢量拉普拉斯方程 $\\nabla^2 \\mathbf{w} = \\mathbf{0}$，并带有指定的狄利克雷边界条件 $\\mathbf{w}|_{\\partial \\Omega} = \\mathbf{u}_b$。拉普拉斯方程的狄利克雷问题是适定椭圆偏微分方程的经典例子。在给定条件下（具有 Lipschitz 边界的有界域），解的存在性、唯一性和稳定性得到保证。\n-   **客观性**：问题使用精确、无歧义的数学术语陈述。没有主观或基于观点的陈述。\n-   **一致性与完整性**：问题提供了所有必要信息：控制偏微分方程、域的性质以及边界条件。没有内部矛盾。\n\n### 步骤 3：结论与行动\n问题有效。它在科学上合理、适定、客观且自洽。可以从提供的信息中推导出严谨的解。\n\n### 求解推导\n问题的核心是找到矢量场 $\\mathbf{w}(\\mathbf{x},t)$，使其在每个时间 $t$ 满足以下边值问题：\n$$\n\\nabla^2 \\mathbf{w}(\\mathbf{x},t) = \\mathbf{0} \\quad \\text{for } \\mathbf{x} \\in \\Omega\n$$\n$$\n\\mathbf{w}(\\mathbf{x},t) = \\mathbf{u}_{b}(\\mathbf{x},t) \\quad \\text{for } \\mathbf{x} \\in \\partial\\Omega\n$$\n其中 $\\mathbf{u}_{b}(\\mathbf{x},t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}$。\n\n这个矢量方程可以分解为关于 $\\mathbf{w} = (w_x, w_y)$ 各分量的两个独立的标量拉普拉斯方程。边界速度 $\\mathbf{u}_b = (u_{b,x}, u_{b,y})$ 的分量为：\n$$\nu_{b,x}(x,y,t) = V_x(t) - \\omega(t)y\n$$\n$$\nu_{b,y}(x,y,t) = V_y(t) + \\omega(t)x\n$$\n因此，两个标量问题是：\n1.  求 $w_x(x,y,t)$，使得在 $\\Omega$ 内 $\\nabla^2 w_x = 0$，且对于 $(x,y) \\in \\partial\\Omega$，有 $w_x(x,y,t) = V_x(t) - \\omega(t)y$。\n2.  求 $w_y(x,y,t)$，使得在 $\\Omega$ 内 $\\nabla^2 w_y = 0$，且对于 $(x,y) \\in \\partial\\Omega$，有 $w_y(x,y,t) = V_y(t) + \\omega(t)x$。\n\n拉普拉斯方程的狄利克雷问题有唯一解。我们提出一个内部速度场 $\\mathbf{w}(\\mathbf{x}, t)$ 的候选解，其解析形式与边界速度场相同，即，\n$$\n\\mathbf{w}_{\\text{candidate}}(\\mathbf{x}, t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}\n$$\n对于所有 $\\mathbf{x} \\in \\Omega$。\n\n我们必须验证该候选解是否同时满足控制方程和边界条件。\n首先，对于任意点 $\\mathbf{x} \\in \\partial\\Omega$，根据定义，候选解等于指定的边界速度：$\\mathbf{w}_{\\text{candidate}}(\\mathbf{x}, t) = \\mathbf{u}_{b}(\\mathbf{x}, t)$。因此，边界条件得到满足。\n\n其次，我们必须验证 $\\mathbf{w}_{\\text{candidate}}$ 在整个域 $\\Omega$ 内满足拉普拉斯方程 $\\nabla^2 \\mathbf{w} = \\mathbf{0}$。我们逐分量进行检查。\n候选解的分量是：\n$$\nw_{\\text{candidate}, x}(x, y, t) = V_x(t) - \\omega(t) y\n$$\n$$\nw_{\\text{candidate}, y}(x, y, t) = V_y(t) + \\omega(t) x\n$$\n对于 $x$ 分量，拉普拉斯算子为 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$。注意 $V_x(t)$ 和 $\\omega(t)$ 仅是 $t$ 的函数，因此在对空间求导时被视为常数。\n$$\n\\nabla^2 w_{\\text{candidate}, x} = \\frac{\\partial^2}{\\partial x^2}\\left( V_x(t) - \\omega(t) y \\right) + \\frac{\\partial^2}{\\partial y^2}\\left( V_x(t) - \\omega(t) y \\right)\n$$\n第一项是 $\\frac{\\partial}{\\partial x}(0) = 0$。第二项是 $\\frac{\\partial}{\\partial y}(-\\omega(t)) = 0$。\n$$\n\\nabla^2 w_{\\text{candidate}, x} = 0 + 0 = 0\n$$\n所以，$x$ 分量是一个调和函数。\n\n对于 $y$ 分量：\n$$\n\\nabla^2 w_{\\text{candidate}, y} = \\frac{\\partial^2}{\\partial x^2}\\left( V_y(t) + \\omega(t) x \\right) + \\frac{\\partial^2}{\\partial y^2}\\left( V_y(t) + \\omega(t) x \\right)\n$$\n第一项是 $\\frac{\\partial}{\\partial x}(\\omega(t)) = 0$。第二项是 $\\frac{\\partial}{\\partial y}(0) = 0$。\n$$\n\\nabla^2 w_{\\text{candidate}, y} = 0 + 0 = 0\n$$\n所以，$y$ 分量也是一个调和函数。\n\n由于 $\\mathbf{w}_{\\text{candidate}}$ 的两个分量都是调和的，因此该矢量场本身也是调和的：$\\nabla^2 \\mathbf{w}_{\\text{candidate}} = \\mathbf{0}$。\n\n我们找到了一个函数 $\\mathbf{w}_{\\text{candidate}}(\\mathbf{x}, t)$，它既满足 $\\Omega$ 内的控制偏微分方程，又满足 $\\partial\\Omega$ 上的指定狄利克雷条件。由于此边值问题的解是唯一的，我们的候选解必定是唯一的解。\n这证明了一个基本性质：任何刚体速度场都是一个调和矢量场。当调和提升过程应用于作刚体运动的边界时，它只是将此刚体速度场延伸到域的内部。\n\n因此，唯一的内部网格速度场是：\n$$\n\\mathbf{w}(\\mathbf{x}, t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}\n$$\n问题要求计算在特定时间 $t_{0}$ 位于特定网格节点 $\\mathbf{x}_{0} = (x_{0}, y_{0})$ 处的速度。我们将这些值代入推导出的表达式中：\n$$\n\\mathbf{w}(\\mathbf{x}_{0}, t_{0}) = \\mathbf{V}(t_{0}) + \\omega(t_{0})\\,\\mathbf{k} \\times \\mathbf{x}_{0}\n$$\n用分量形式表示：\n$$\n\\mathbf{w}(\\mathbf{x}_{0}, t_{0}) = (V_x(t_0), V_y(t_0)) + \\omega(t_0)(-y_0, x_0)\n$$\n$$\n\\mathbf{w}(\\mathbf{x}_{0}, t_{0}) = (V_x(t_0) - \\omega(t_0)y_0, V_y(t_0) + \\omega(t_0)x_0)\n$$\n这就是在指定点和时间的网格速度的最终解析表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} V_x(t_0) - \\omega(t_0)y_0 & V_y(t_0) + \\omega(t_0)x_0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在计算科学中，保证代码的正确性至关重要。人造解方法（Method of Manufactured Solutions, MMS）是一种严格的代码验证技术，它通过假定一个解析解并反推出其必须满足的源项，来检验数值求解器是否被正确实现。本练习  将指导您完成这一过程，您需要首先推导ALE框架下的对流扩散方程，然后计算出使人造解精确成立所需的源项，从而掌握开发可靠仿真工具的关键技能。",
            "id": "3937079",
            "problem": "考虑一个一维无反应热标量 $T(x,t)$，在一个由任意拉格朗日-欧拉 (ALE) 移动网格追踪的域中，该标量受平流和扩散控制。设参考坐标为 $\\Xi \\in [0,1]$，物理坐标为 $x \\in \\mathbb{R}$。从参考构型到物理构型的含时映射由 $x = \\chi(\\Xi,t)$ 给出：\n$$\nx = \\chi(\\Xi,t) = \\Xi + \\varepsilon \\sin(\\pi \\Xi)\\,\\sin(\\omega t),\n$$\n其中 $\\varepsilon$ 和 $\\omega$ 为实常数，使得该映射在所有关心的时刻 $t$ 都是微分同胚。物理框架中的平流速度是均匀且恒定的，$v(x,t) \\equiv U_0$，热扩散系数为常数，$\\alpha > 0$。假设所有变量都是无量纲的。网格速度定义为 $w(x,t) = \\partial \\chi/\\partial t \\big|_{\\Xi}$，映射的雅可比行列式为 $J(\\Xi,t) = \\partial \\chi/\\partial \\Xi$。\n\n从移动控制体积中被动标量的基本能量守恒以及由映射 $\\chi(\\Xi,t)$ 蕴含的链式法则关系出发，推导强形式的 ALE 平流-扩散方程。然后，使用人造解法确定 ALE 框架中的体积源项 $S_{\\mathrm{ALE}}(\\Xi,t)$，使得以下人造温度场能够精确满足 ALE 方程：\n$$\nT(x,t) = \\Theta(\\Xi,t) = \\cos(2\\pi \\Xi)\\,\\exp(-\\lambda t),\n$$\n其中 $\\lambda > 0$ 是一个常数，$\\Xi$ 是通过 $\\chi(\\Xi,t)$ 映射到 $x$ 的参考坐标。将最终的源项 $S_{\\mathrm{ALE}}(\\Xi,t)$ 表示为关于 $\\Xi$、$t$、$U_0$、$\\alpha$、$\\varepsilon$、$\\omega$ 和 $\\lambda$ 的单个闭式解析表达式。无需进行数值舍入。",
            "solution": "用户要求我解决以下问题：\n首先验证问题，以确保其科学上合理、自洽且适定。\n\n### 步骤 1：提取已知条件\n- **控制物理**：一维无反应热标量 $T(x,t)$ 的平流和扩散。\n- **域**：一个任意拉格朗日-欧拉 (ALE) 移动网格。\n- **坐标**：\n    - 参考坐标：$\\Xi \\in [0,1]$。\n    - 物理坐标：$x \\in \\mathbb{R}$。\n- **映射**：从参考坐标到物理坐标的含时映射为 $x = \\chi(\\Xi,t)$，由以下公式给出：\n  $$x = \\chi(\\Xi,t) = \\Xi + \\varepsilon \\sin(\\pi \\Xi)\\,\\sin(\\omega t)$$\n  该映射为微分同胚，其中 $\\varepsilon$ 和 $\\omega$ 是实常数。\n- **物理性质**：\n    - 平流速度（物理框架）：$v(x,t) = U_0$（常数）。\n    - 热扩散系数：$\\alpha > 0$（常数）。\n- **ALE相关定义**：\n    - 网格速度：$w(x,t) = \\frac{\\partial \\chi}{\\partial t} \\big|_{\\Xi}$。\n    - 映射的雅可比行列式：$J(\\Xi,t) = \\frac{\\partial \\chi}{\\partial \\Xi}$。\n- **人造解**：温度场在参考坐标中给出为：\n  $$T(x,t) = \\Theta(\\Xi,t) = \\cos(2\\pi \\Xi)\\,\\exp(-\\lambda t)$$\n  其中 $\\lambda > 0$ 是一个常数。\n- **任务**：\n    1.  推导强形式的 ALE 平流-扩散方程。\n    2.  使用人造解法求出 ALE 框架中的体积源项 $S_{\\mathrm{ALE}}(\\Xi,t)$，使得给定的人造解 $\\Theta(\\Xi,t)$ 是该方程的精确解。\n    3.  将 $S_{\\mathrm{ALE}}(\\Xi,t)$ 表示为关于 $\\Xi$、$t$、$U_0$、$\\alpha$、$\\varepsilon$、$\\omega$ 和 $\\lambda$ 的单个闭式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于基本的平流-扩散方程，这是输运现象的基石。任意拉格朗日-欧拉 (ALE) 方法是计算力学和热流科学中一种标准且成熟的方法。人造解法 (MMS) 是验证数值代码正确性的严谨技术。该问题在科学上是合理的。\n2.  **适定性**：该问题要求进行推导，然后基于该推导进行计算。所有必需的函数和参数都已提供。任务是计算一个源项，使给定函数成为所推导方程的解，这是一个明确定义的数学过程。\n3.  **客观性**：语言精确且数学化，没有主观或含糊的陈述。\n4.  **不完整或矛盾的设置**：该问题是自洽的。映射被说明为微分同胚，这意味着雅可比行列式 $J(\\Xi,t) = \\frac{\\partial \\chi}{\\partial \\Xi}$ 永不为零（并假设为正）。这要求 $| \\varepsilon \\pi \\cos(\\pi \\Xi)\\,\\sin(\\omega t) | < 1$，从而对 $\\varepsilon$ 施加了一个物理上合理的约束，即 $|\\varepsilon| < 1/\\pi$。问题假设此条件成立。\n5.  **不切实际或不可行**：该设置为用于代码验证的标准理论问题。所有函数都是光滑且行为良好的。该设置是合理且可行的。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行求解。\n\n### 第 1 部分：强形式 ALE 平流-扩散方程的推导\n在一个固定的（欧拉）一维域中标量 $T$ 的守恒由平流-扩散方程描述：\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x + \\frac{\\partial}{\\partial x}(vT) = \\frac{\\partial}{\\partial x}\\left(\\alpha \\frac{\\partial T}{\\partial x}\\right) + S_{\\text{phys}}(x,t) $$\n鉴于流体速度 $v = U_0$ 和扩散系数 $\\alpha$ 是常数，方程简化为：\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x + U_0 \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + S_{\\text{phys}}(x,t) $$\n在 ALE 框架中，我们希望表达关于参考坐标 $\\Xi$ 的时间演化，在时间微分过程中保持该坐标不变。在固定物理点 $x$（欧拉）处的时间导数与在固定参考点 $\\Xi$（ALE）处的时间导数之间的关系由链式法则给出：\n$$ \\frac{\\partial T(x(\\Xi,t), t)}{\\partial t}\\bigg|_x = \\frac{\\partial \\Theta(\\Xi, t)}{\\partial t}\\bigg|_\\Xi + \\frac{\\partial \\Theta(\\Xi, t)}{\\partial \\Xi} \\frac{\\partial \\Xi(x,t)}{\\partial t}\\bigg|_x $$\n通过考虑 $T(x,t)$ 其中 $x=\\chi(\\Xi,t)$，可以得到一个更直接的形式。保持 $\\Xi$ 不变的 $T$ 的全时间导数是 $\\frac{\\partial \\Theta}{\\partial t}\\big|_\\Xi$。保持 $x$ 不变的全时间导数是 $\\frac{\\partial T}{\\partial t}\\big|_x$。从关系式 $x=\\chi(\\Xi,t)$，我们有 $dx = \\frac{\\partial \\chi}{\\partial \\Xi}d\\Xi + \\frac{\\partial \\chi}{\\partial t}dt$。保持 $x$ 不变（$dx=0$），我们得到 $\\frac{d\\Xi}{dt}\\big|_x = -(\\frac{\\partial \\chi}{\\partial t})/(\\frac{\\partial \\chi}{\\partial \\Xi}) = -w/J$。\n链式法则给出：\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x = \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + \\frac{\\partial \\Theta}{\\partial \\Xi} \\frac{d\\Xi}{dt}\\bigg|_x = \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi - \\frac{w}{J}\\frac{\\partial \\Theta}{\\partial \\Xi} $$\n注意到 $\\frac{\\partial T}{\\partial x} = \\frac{1}{J}\\frac{\\partial \\Theta}{\\partial \\Xi}$，我们可以将其写为：\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x = \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi - w \\frac{\\partial T}{\\partial x} $$\n将此代入欧拉方程，得到物理框架中的 ALE 方程：\n$$ \\left(\\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi - w \\frac{\\partial T}{\\partial x}\\right) + U_0 \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + S_{\\text{phys}} $$\n$$ \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + (U_0 - w) \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + S_{\\text{phys}} $$\n现在，我们使用 $\\frac{\\partial}{\\partial x} = \\frac{1}{J}\\frac{\\partial}{\\partial \\Xi}$ 将空间导数转换到参考框架：\n$$ \\frac{\\partial T}{\\partial x} = \\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} $$\n$$ \\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\frac{1}{J}\\frac{\\partial}{\\partial \\Xi}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) $$\n将这些代入物理框架的 ALE 方程并识别 $S_{\\mathrm{ALE}}(\\Xi,t) = S_{\\text{phys}}(\\chi(\\Xi,t),t)$，得到参考坐标系下的强形式 ALE 平流-扩散方程：\n$$ \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + (U_0 - w) \\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} = \\alpha \\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) + S_{\\mathrm{ALE}}(\\Xi,t) $$\n由于 $\\alpha$ 是常数，这也可以写成：\n$$ \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + \\frac{U_0 - w}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} = \\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) + S_{\\mathrm{ALE}}(\\Xi,t) $$\n这就是我们必须满足的方程。\n\n### 第 2 部分：源项 $S_{\\mathrm{ALE}}(\\Xi,t)$ 的计算\n我们重新整理推导出的方程以求解源项：\n$$ S_{\\mathrm{ALE}}(\\Xi,t) = \\frac{\\partial \\Theta}{\\partial t} + \\frac{U_0 - w}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} - \\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) $$\n现在我们使用给定的映射和人造解来计算每一项。\n\n1.  **几何与运动学项**：\n    -   映射：$x = \\chi(\\Xi,t) = \\Xi + \\varepsilon \\sin(\\pi \\Xi)\\sin(\\omega t)$\n    -   雅可比行列式：$J(\\Xi,t) = \\frac{\\partial \\chi}{\\partial \\Xi} = 1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)$\n    -   网格速度：$w(\\Xi,t) = \\frac{\\partial \\chi}{\\partial t} = \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t)$\n    -   雅可比行列式的导数：$\\frac{\\partial J}{\\partial \\Xi} = -\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)$\n\n2.  **温度场导数**：\n    -   温度：$\\Theta(\\Xi,t) = \\cos(2\\pi \\Xi)\\exp(-\\lambda t)$\n    -   时间导数：$\\frac{\\partial \\Theta}{\\partial t} = -\\lambda \\cos(2\\pi \\Xi)\\exp(-\\lambda t)$\n    -   一阶空间导数：$\\frac{\\partial \\Theta}{\\partial \\Xi} = -2\\pi \\sin(2\\pi \\Xi)\\exp(-\\lambda t)$\n    -   二阶空间导数：$\\frac{\\partial^2 \\Theta}{\\partial \\Xi^2} = -4\\pi^2 \\cos(2\\pi \\Xi)\\exp(-\\lambda t)$\n\n3.  **组合 $S_{\\mathrm{ALE}}$ 的各项**：\n\n    -   **瞬态项**：\n        $$ \\frac{\\partial \\Theta}{\\partial t} = -\\lambda \\cos(2\\pi \\Xi)\\exp(-\\lambda t) $$\n\n    -   **平流项**：\n        $$ \\frac{U_0 - w}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} = \\frac{U_0 - \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t)}{1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)} \\left( -2\\pi \\sin(2\\pi \\Xi)\\exp(-\\lambda t) \\right) $$\n\n    -   **扩散项**：\n        扩散项是 $-\\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right)$。我们先计算内部部分：\n        $$ \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\alpha \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\alpha \\left[ \\frac{\\partial (1/J)}{\\partial \\Xi}\\frac{\\partial \\Theta}{\\partial \\Xi} + \\frac{1}{J}\\frac{\\partial^2 \\Theta}{\\partial \\Xi^2} \\right] $$\n        $$ \\frac{\\partial (1/J)}{\\partial \\Xi} = -\\frac{1}{J^2}\\frac{\\partial J}{\\partial \\Xi} = -\\frac{1}{J^2}(-\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)) = \\frac{\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)}{J^2} $$\n        代入导数：\n        $$ \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\alpha \\left[ \\left(\\frac{\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)}{J^2}\\right)(-2\\pi \\sin(2\\pi \\Xi)\\exp(-\\lambda t)) + \\frac{1}{J}(-4\\pi^2 \\cos(2\\pi \\Xi)\\exp(-\\lambda t)) \\right] $$\n        $$ = \\alpha \\pi^2 \\exp(-\\lambda t) \\left[ -\\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^2} - \\frac{4\\cos(2\\pi \\Xi)}{J} \\right] $$\n        所以，对 $S_{\\mathrm{ALE}}$ 的完整扩散贡献是：\n        $$ -\\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = -\\frac{\\alpha \\pi^2 \\exp(-\\lambda t)}{J} \\left[ -\\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^2} - \\frac{4\\cos(2\\pi \\Xi)}{J} \\right] $$\n        $$ = \\alpha \\pi^2 \\exp(-\\lambda t) \\left[ \\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^3} + \\frac{4\\cos(2\\pi \\Xi)}{J^2} \\right] $$\n\n4.  **$S_{\\mathrm{ALE}}(\\Xi,t)$ 的最终表达式**：\n    合并所有项并提出因子 $\\exp(-\\lambda t)$：\n    $$ S_{\\mathrm{ALE}}(\\Xi,t) = \\exp(-\\lambda t) \\left[ -\\lambda \\cos(2\\pi \\Xi) - 2\\pi \\sin(2\\pi \\Xi)\\frac{U_0 - w}{J} + \\alpha \\pi^2 \\left( \\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^3} + \\frac{4\\cos(2\\pi \\Xi)}{J^2} \\right) \\right] $$\n    代入 $w$ 和 $J$ 的完整表达式：\n    $$ S_{\\mathrm{ALE}}(\\Xi,t) = \\exp(-\\lambda t) \\Bigg[ -\\lambda \\cos(2\\pi \\Xi) - \\frac{2\\pi \\sin(2\\pi \\Xi) \\left(U_0 - \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t)\\right)}{1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)} + \\frac{4\\alpha\\pi^2 \\cos(2\\pi \\Xi)}{\\left(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)\\right)^2} + \\frac{2\\alpha \\varepsilon \\pi^3 \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{\\left(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)\\right)^3} \\Bigg] $$\n    这就是源项的最终闭式解析表达式。",
            "answer": "$$ \\boxed{\\exp(-\\lambda t) \\left[ -\\lambda \\cos(2\\pi \\Xi) - \\frac{2\\pi \\sin(2\\pi \\Xi) (U_0 - \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t))}{1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)} + \\frac{4\\alpha\\pi^2 \\cos(2\\pi \\Xi)}{(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t))^2} + \\frac{2\\alpha \\varepsilon \\pi^3 \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t))^3} \\right]} $$"
        },
        {
            "introduction": "几何守恒律（Geometric Conservation Law, GCL）是稳定且精确的ALE仿真的基石，它确保了网格运动本身不会人为地产生或消耗守恒量（如质量或能量）。本动手编程练习  的任务是实现一个数值测试，以验证离散GCL是否得到精确满足。通过将数值计算出的单元体积演化与已知的解析解进行比较，您可以定量地评估ALE运动学实现的正确性，这是任何ALE求解器都必须通过的基本考验。",
            "id": "3937083",
            "problem": "考虑计算热工学中的一种一维移动网格格式，该格式在任意拉格朗日-欧拉 (ALE) 框架下，网格遵循指定的边界运动。设固定的参考域为区间 $[0,L_0]$，其中 $L_0$ 的单位为米。在时刻 $t$ 的物理域是通过一个从参考坐标 $X \\in [0,L_0]$ 到物理坐标 $x$ 的随时间变化的映射 $x(X,t)$ 获得的。几何守恒律 (GCL) 指出，控制体的时间变化率等于网格速度通过其边界的通量。该陈述的基本依据是针对移动控制体的 Reynolds 输运定理：对于被积函数等于 $1$ 的特殊情况，该定理即推导出几何守恒律\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{\\Omega(t)} 1\\,\\mathrm{d}\\Omega = \\int_{\\partial\\Omega(t)} \\mathbf{v}_m \\cdot \\mathbf{n}\\,\\mathrm{d}A,\n$$\n其中 $\\Omega(t)$ 是随时间变化的域，$\\partial\\Omega(t)$ 是其边界，$\\mathbf{v}_m$ 是网格速度，$\\mathbf{n}$ 是边界上的外法向单位向量。在一维空间中，对于一个由位置 $x_{i}$ 和 $x_{i+1}$ 处的面所界定的单元 $i$，该定律简化为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\Delta x_i(t) = v_m(x_{i+1},t) - v_m(x_{i},t),\n$$\n其中 $\\Delta x_i(t) = x_{i+1}(t) - x_i(t)$ 是单元 $i$ 的物理长度，$v_m$ 是在单元面处计算的网格速度。\n\n你的任务是通过将离散 GCL 更新计算出的数值更新单元体积，与由映射 $x(X,t)$ 导出的解析计算单元体积进行比较，来验证离散几何守恒律 (discrete GCL)。验证必须针对由以下公式定义的指定边界运动和内部网格运动进行：\n$$\nx(X,t) = \\lambda(t)\\,X + \\mu(t)\\,L_0\\,\\phi(X),\n$$\n其中\n$$\n\\lambda(t) = 1 + \\alpha \\sin\\left(2\\pi f t\\right),\\quad \\mu(t) = \\delta \\cos\\left(2\\pi f t\\right),\\quad \\phi(X) = \\frac{X}{L_0}\\left(1 - \\frac{X}{L_0}\\right).\n$$\n此处，$\\alpha$ 和 $\\delta$ 是无量纲振幅，$f$ 是频率，单位为赫兹（秒的倒数），$t$ 是时间，单位为秒。该映射使左边界保持在 $x(0,t)=0$，并将右边界移动到 $x(L_0,t)=\\lambda(t)\\,L_0$，提供了一种物理上真实的边界运动，并带有一个由 $\\mu(t)$ 控制的可选内部凸起。\n\n网格速度定义为\n$$\nv_m(X,t) = \\frac{\\partial x}{\\partial t}(X,t) = \\dot{\\lambda}(t)\\,X + \\dot{\\mu}(t)\\,L_0\\,\\phi(X),\n$$\n其时间导数为\n$$\n\\dot{\\lambda}(t) = \\alpha\\,(2\\pi f)\\,\\cos\\left(2\\pi f t\\right),\\quad \\dot{\\mu}(t) = -\\delta\\,(2\\pi f)\\,\\sin\\left(2\\pi f t\\right).\n$$\n\n将参考区间 $[0,L_0]$ 离散化为 $N$ 个等间距单元，节点位于 $X_j = j\\,\\Delta X$，其中 $j=0,1,\\dots,N$，且 $\\Delta X = L_0/N$。设解析物理位置为 $x_j^{\\text{exact}}(t) = x(X_j,t)$，解析单元长度为 $\\Delta x_i^{\\text{exact}}(t) = x_{i+1}^{\\text{exact}}(t) - x_i^{\\text{exact}}(t)$，其中 $i=0,1,\\dots,N-1$。\n\n在一个从时间 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的时间步长 $\\Delta t$ 内，单元长度的离散 GCL 更新公式为\n$$\n\\frac{\\Delta x_i^{n+1} - \\Delta x_i^{n}}{\\Delta t} = v_m\\big(X_{i+1}, t^{\\ast}\\big) - v_m\\big(X_{i}, t^{\\ast}\\big),\n$$\n其中 $t^{\\ast}$ 是计算网格速度的时刻。为了满足时间上二阶精度的离散 GCL，请使用中点时间 $t^{\\ast} = t^{n} + \\Delta t/2$；为作比较，也考虑一阶显式欧拉选择 $t^{\\ast} = t^{n}$。\n\n从 $t^0=0$ 时的解析初始单元长度开始，使用离散 GCL 公式在一系列时间步上推进离散单元长度，直到时间 $T$，并在每个步骤中将离散单元长度与在新时刻下直接从 $x(X,t)$ 计算出的解析单元长度进行比较。将一次运行的验证误差定义为在所有单元和所有时间步上的最大绝对差异，\n$$\nE_{\\max} = \\max_{0\\le n \\le N_t-1}\\max_{0\\le i \\le N-1}\\left|\\Delta x_i^{n+1} - \\Delta x_i^{\\text{exact}}(t^{n+1})\\right|,\n$$\n其中 $N_t$ 是时间步数。\n\n实现一个程序，该程序对下面的每个测试用例计算以米为单位的 $E_{\\max}$，并以浮点数形式输出这些误差。使用以下测试套件以确保覆盖不同方面，包括一般情况、内部凸起、高振幅边界运动、零运动，以及一个特意使用不满足离散 GCL 的时间积分器的用例：\n\n- 测试用例 1 (一般均匀拉伸): $N=10$，$L_0=1.0$ 米，$\\alpha=0.1$，$\\delta=0.0$，$f=1.0$ 赫兹，$T=3.0$ 秒，$\\Delta t=0.005$ 秒，中点时间。\n- 测试用例 2 (非均匀内部凸起): $N=50$，$L_0=2.0$ 米，$\\alpha=0.05$，$\\delta=0.05$，$f=2.0$ 赫兹，$T=1.5$ 秒，$\\Delta t=0.0025$ 秒，中点时间。\n- 测试用例 3 (高振幅边界运动): $N=20$，$L_0=1.0$ 米，$\\alpha=0.9$，$\\delta=0.0$，$f=0.5$ 赫兹，$T=2.0$ 秒，$\\Delta t=0.01$ 秒，中点时间。\n- 测试用例 4 (零运动边缘情况): $N=7$，$L_0=1.5$ 米，$\\alpha=0.0$，$\\delta=0.0$，$f=1.0$ 赫兹，$T=1.0$ 秒，$\\Delta t=0.02$ 秒，中点时间。\n- 测试用例 5 (为对比而故意违反离散 GCL): $N=30$，$L_0=1.0$ 米，$\\alpha=0.2$，$\\delta=0.1$，$f=3.0$ 赫兹，$T=\\frac{1}{3}$ 秒，$\\Delta t=\\frac{1}{120}$ 秒，显式欧拉时间。\n\n你的程序应产生单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，\"[result1,result2,result3,result4,result5]\"）。每个结果必须是相应测试用例以米为单位的 $E_{\\max}$ 的浮点值。报告原始数值浮点数，不带任何单位符号；计算中的所有量必须一致地对长度使用米，对时间使用秒，对频率使用赫兹。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它具有科学依据，是适定且客观的。它提出了计算科学领域中的一个标准数值验证练习，特别是关于任意拉格朗日-欧拉 (ALE) 方法。所提供的关于网格映射、网格速度和离散几何守恒律 (GCL) 的方程是一致且正确的。测试用例的参数是完整的且物理上合理的，并且映射函数在所有指定条件下都是非退化的。因此，将提供一个合理的解决方案。\n\n目标是验证一维移动网格的离散几何守恒律 (GCL) 的一个实现。GCL 是 ALE 公式中的一个基本要求，它确保离散化能正确处理因网格运动引起的单元体积变化，从而防止引入人为的质量、动量或能量。该问题要求比较使用离散 GCL 进行数值演化得到的单元长度与从指定的映射函数 $x(X,t)$ 解析计算得到的单元长度。在整个模拟过程中，这两个量之间的最大差异作为验证误差 $E_{\\max}$。\n\n一维连续 GCL 由下式给出：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\Delta x_i(t) = v_m(x_{i+1},t) - v_m(x_{i},t)\n$$\n其中 $\\Delta x_i(t)$ 是时刻 $t$ 单元 $i$ 的长度，$v_m$ 是位于物理位置 $x_i$ 和 $x_{i+1}$ 的单元面上的网格速度。\n\n网格运动由从固定参考坐标 $X$ 到时刻 $t$ 的物理坐标 $x$ 的映射 $x(X,t)$ 定义：\n$$\nx(X,t) = \\lambda(t)\\,X + \\mu(t)\\,L_0\\,\\phi(X)\n$$\n其分量为：\n$$\n\\lambda(t) = 1 + \\alpha \\sin\\left(2\\pi f t\\right) \\\\\n\\mu(t) = \\delta \\cos\\left(2\\pi f t\\right) \\\\\n\\phi(X) = \\frac{X}{L_0}\\left(1 - \\frac{X}{L_0}\\right)\n$$\n网格速度是位置相对于参考坐标 $X$ 的物质导数：\n$$\nv_m(X,t) = \\frac{\\partial x}{\\partial t}(X,t) = \\dot{\\lambda}(t)\\,X + \\dot{\\mu}(t)\\,L_0\\,\\phi(X)\n$$\n其时间导数为：\n$$\n\\dot{\\lambda}(t) = \\alpha\\,(2\\pi f)\\,\\cos\\left(2\\pi f t\\right) \\\\\n\\dot{\\mu}(t) = -\\delta\\,(2\\pi f)\\,\\sin\\left(2\\pi f t\\right)\n$$\n\n该过程涉及一个时间步进模拟。参考域 $[0, L_0]$ 被离散化为 $N$ 个单元，节点位于 $X_j = j \\Delta X$，其中 $j=0, \\dots, N$，且 $\\Delta X = L_0/N$。\n\n1.  **初始化**：在时间 $t^0=0$ 时，使用解析单元长度初始化模拟。物理域中节点的位置计算为 $x_j^{\\text{exact}}(0) = x(X_j, 0)$，初始单元长度为 $\\Delta x_i^0 = x_{i+1}^{\\text{exact}}(0) - x_{i}^{\\text{exact}}(0)$，其中 $i = 0, \\dots, N-1$。一个误差变量 $E_{\\max}$ 被初始化为 $0$。\n\n2.  **时间推进**：模拟从 $t=0$ 到 $t=T$ 以 $\\Delta t$ 为步长进行。对于从 $t^n$ 到 $t^{n+1} = t^n + \\Delta t$ 的每个时间步：\n    a.  **速度计算**：在所有参考节点 $X_j$ 处计算网格速度 $v_m(X_j, t^{\\ast})$。计算时间 $t^{\\ast}$ 是关键的。为满足二阶精度的 GCL，使用时间中点计算，$t^{\\ast} = t^{n} + \\Delta t/2$。为作比较，也考虑一阶显式欧拉计算，$t^{\\ast} = t^{n}$。\n    \n    b.  **数值更新**：使用离散 GCL 公式更新单元长度，该公式是连续 GCL 的时间离散化：\n    $$\n    \\Delta x_i^{n+1} = \\Delta x_i^{n} + \\Delta t \\left( v_m(X_{i+1}, t^{\\ast}) - v_m(X_i, t^{\\ast}) \\right)\n    $$\n    该公式应用于所有单元 $i=0, \\dots, N-1$。\n\n    c.  **解析解**：时刻 $t^{n+1}$ 的“真实”或解析单元长度直接从映射计算得出：\n    $$\n    x_j^{\\text{exact}}(t^{n+1}) = x(X_j, t^{n+1}) \\\\\n    \\Delta x_i^{\\text{exact}}(t^{n+1}) = x_{i+1}^{\\text{exact}}(t^{n+1}) - x_i^{\\text{exact}}(t^{n+1})\n    $$\n\n    d.  **误差计算**：计算当前时间步每个单元的绝对误差：$|\\Delta x_i^{n+1} - \\Delta x_i^{\\text{exact}}(t^{n+1})|$。找出所有单元中这些误差的最大值，如果该最大值大于当前的 $E_{\\max}$，则更新 $E_{\\max}$。\n    \n    e.  **状态更新**：新计算出的数值单元长度 $\\Delta x_i^{n+1}$ 成为下一个时间步的当前长度 $\\Delta x_i^{n}$。\n\n3.  **结果**：在最后一个时间步之后，$E_{\\max}$ 保存了在整个模拟过程中观测到的最大差异，它作为给定测试用例的最终验证指标。\n\n对五个测试用例中的每一个重复此过程。预期对于使用二阶中点法则的用例 1-3，误差 $E_{\\max}$ 将非常小，接近机器精度，这证实了 GCL 得到了很好的满足。这种情况下的误差是中点求积法则的时间离散误差，该误差是二阶的，即 $O(\\Delta t^2)$。对于用例 4，没有网格运动 ($\\alpha=0, \\delta=0$)，网格速度恒等于零，误差应精确为零。对于用例 5，它特意使用一阶显式欧拉格式，预计会产生一个大得多的、一阶的误差 ($O(\\Delta t)$)。这表明时间积分器的选择对于满足离散 GCL 至关重要。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the discrete Geometric Conservation Law (GCL) verification problem.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, L0, alpha, delta, f, T, dt, method)\n        (10, 1.0, 0.1, 0.0, 1.0, 3.0, 0.005, 'midpoint'),\n        (50, 2.0, 0.05, 0.05, 2.0, 1.5, 0.0025, 'midpoint'),\n        (20, 1.0, 0.9, 0.0, 0.5, 2.0, 0.01, 'midpoint'),\n        (7, 1.5, 0.0, 0.0, 1.0, 1.0, 0.02, 'midpoint'),\n        (30, 1.0, 0.2, 0.1, 3.0, 1.0/3.0, 1.0/120.0, 'euler'),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N, L0, alpha, delta, f, T, dt, method = case\n        \n        # Helper functions for the mapping and its derivatives\n        pi_2f = 2.0 * np.pi * f\n\n        def lambda_func(t):\n            return 1.0 + alpha * np.sin(pi_2f * t)\n\n        def mu_func(t):\n            return delta * np.cos(pi_2f * t)\n\n        def phi_func(X):\n            # Ensure X is a numpy array for vectorization\n            X_norm = X / L0\n            return X_norm * (1.0 - X_norm)\n\n        def x_map(X, t):\n            # X can be a scalar or a numpy array\n            return lambda_func(t) * X + mu_func(t) * L0 * phi_func(X)\n\n        def lambda_dot_func(t):\n            return alpha * pi_2f * np.cos(pi_2f * t)\n\n        def mu_dot_func(t):\n            return -delta * pi_2f * np.sin(pi_2f * t)\n\n        def v_m_func(X, t):\n            # X can be a scalar or a numpy array\n            return lambda_dot_func(t) * X + mu_dot_func(t) * L0 * phi_func(X)\n\n        # Set up the simulation\n        # Reference mesh nodes\n        X_nodes = np.linspace(0.0, L0, N + 1)\n        \n        # Time steps\n        # Use round() to avoid floating point issues with T/dt\n        num_steps = int(round(T / dt))\n        times = np.linspace(0.0, T, num_steps + 1)\n\n        # Initial conditions at t=0\n        x_nodes_initial = x_map(X_nodes, 0.0)\n        delta_x_n = np.diff(x_nodes_initial) # delta_x_n are numerical cell lengths\n\n        max_error = 0.0\n\n        # Time-stepping loop\n        for n in range(num_steps):\n            t_n = times[n]\n            t_n_plus_1 = times[n+1]\n            \n            # Determine time for velocity evaluation\n            if method == 'midpoint':\n                t_star = t_n + dt / 2.0\n            elif method == 'euler':\n                t_star = t_n\n            else:\n                raise ValueError(\"Unknown method: \" + method)\n\n            # Compute mesh velocities at nodes\n            v_m_nodes = v_m_func(X_nodes, t_star)\n            \n            # Update cell lengths using discrete GCL\n            # delta_x_n+1 = delta_x_n + dt * (v_m(i+1) - v_m(i))\n            delta_x_n_plus_1 = delta_x_n + dt * np.diff(v_m_nodes)\n            \n            # Compute analytical cell lengths for comparison\n            x_nodes_exact = x_map(X_nodes, t_n_plus_1)\n            delta_x_exact = np.diff(x_nodes_exact)\n            \n            # Calculate error for this time step\n            current_max_error = np.max(np.abs(delta_x_n_plus_1 - delta_x_exact))\n            \n            # Update overall maximum error\n            if current_max_error > max_error:\n                max_error = current_max_error\n                \n            # Update cell lengths for the next iteration\n            delta_x_n = delta_x_n_plus_1\n        \n        results.append(max_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}