{
    "hands_on_practices": [
        {
            "introduction": "A primary challenge in Arbitrary Lagrangian-Eulerian (ALE) formulations is determining a smooth, non-tangling motion for the interior mesh nodes given a prescribed motion of the domain boundaries. One of the most robust and widely used techniques is *harmonic lifting*, where the mesh displacement or velocity is governed by the Laplace equation. This practice  explores the analytical properties of this method, guiding you to derive the interior mesh velocity that results from a rigid-body motion of the boundary. The exercise reveals a fundamental property of rigid-body velocity fields and solidifies the connection between mesh motion strategies and classical partial differential equations.",
            "id": "3937140",
            "problem": "Consider a two-dimensional bounded, simply connected computational domain $\\Omega \\subset \\mathbb{R}^{2}$ with Lipschitz boundary $\\partial \\Omega$ containing the origin. The domain hosts a transient heat-transfer computation in an Arbitrary Lagrangian–Eulerian (ALE) framework, where the mesh motion enters the ALE form of the energy equation through the mesh velocity. The physical boundary undergoes a prescribed rigid-body motion consisting of a time-dependent translation with velocity $\\mathbf{V}(t) = \\left(V_{x}(t), V_{y}(t)\\right)$ and a time-dependent in-plane rotation about the origin with angular velocity $\\omega(t)$ (positive for counterclockwise rotation). Let $\\mathbf{x} = (x,y)$ denote the spatial coordinates in the current configuration.\n\nAdopt harmonic lifting to obtain a smooth interior mesh motion: specifically, let the mesh displacement $\\mathbf{d}(\\mathbf{x},t)$ solve the vector Laplace equation in $\\Omega$ with Dirichlet data equal to the physical boundary displacement on $\\partial \\Omega$. Equivalently, the mesh velocity $\\mathbf{w}(\\mathbf{x},t) = \\partial \\mathbf{d}(\\mathbf{x},t)/\\partial t$ satisfies the vector Laplace equation componentwise in $\\Omega$, with Dirichlet boundary values equal to the physical boundary velocity $\\mathbf{u}_{b}(\\mathbf{x},t)$ on $\\partial \\Omega$. The prescribed boundary velocity is the rigid-body velocity\n$$\n\\mathbf{u}_{b}(\\mathbf{x},t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x},\n$$\nwhere $\\mathbf{k}$ is the unit vector orthogonal to the plane and $\\mathbf{k} \\times \\mathbf{x} = (-y, x)$.\n\nStarting from fundamental facts of elliptic partial differential equations and the properties of rigid-body motions, derive the unique interior mesh velocity field $\\mathbf{w}(\\mathbf{x},t)$ produced by harmonic lifting of the boundary velocity, and then compute the interior mesh velocity at a specific mesh node $\\mathbf{x}_{0} = (x_{0}, y_{0})$ at time $t_{0}$. Express your final answer as a single analytic expression giving $\\mathbf{w}(\\mathbf{x}_{0}, t_{0})$. No numerical values are required. If you choose to write the result componentwise, present it as a single row vector. Do not provide units in the final answer.",
            "solution": "The problem will first be validated for scientific and mathematical soundness.\n\n### Step 1: Extract Givens\n-   **Computational Domain**: A two-dimensional, bounded, simply connected domain $\\Omega \\subset \\mathbb{R}^{2}$ with a Lipschitz boundary $\\partial \\Omega$. The origin is contained within $\\Omega$.\n-   **Methodology**: Arbitrary Lagrangian–Eulerian (ALE) framework for transient heat-transfer.\n-   **Mesh Motion**: The mesh velocity $\\mathbf{w}(\\mathbf{x},t) = \\frac{\\partial \\mathbf{d}(\\mathbf{x},t)}{\\partial t}$, where $\\mathbf{d}$ is mesh displacement, is obtained via harmonic lifting.\n-   **Governing Equation for Mesh Velocity**: The mesh velocity field $\\mathbf{w}(\\mathbf{x},t)$ satisfies the vector Laplace equation, $\\nabla^2 \\mathbf{w} = \\mathbf{0}$, componentwise within the domain $\\Omega$.\n-   **Boundary Condition for Mesh Velocity**: On the boundary $\\partial \\Omega$, the mesh velocity is prescribed by the physical boundary velocity $\\mathbf{u}_{b}(\\mathbf{x},t)$. This serves as a Dirichlet boundary condition for $\\mathbf{w}(\\mathbf{x},t)$.\n-   **Prescribed Boundary Velocity**: The boundary undergoes a rigid-body motion, given by $\\mathbf{u}_{b}(\\mathbf{x},t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}$, where $\\mathbf{x}=(x,y) \\in \\partial\\Omega$.\n-   **Definitions**: $\\mathbf{V}(t) = (V_{x}(t), V_{y}(t))$ is the translational velocity. $\\omega(t)$ is the scalar angular velocity about the origin. $\\mathbf{k}$ is the unit vector orthogonal to the $xy$-plane, and the cross product is defined as $\\mathbf{k} \\times \\mathbf{x} = (-y, x)$.\n-   **Objective**: Derive the interior mesh velocity field $\\mathbf{w}(\\mathbf{x},t)$ and evaluate it at a specific point $\\mathbf{x}_{0} = (x_0, y_0)$ at time $t_0$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is well-grounded in the field of computational fluid dynamics and heat transfer. The use of an ALE framework is standard for problems with moving boundaries. Harmonic lifting (solving Laplace's equation for mesh displacement or velocity) is a widely used and accepted technique for generating smooth interior mesh motion from prescribed boundary motion. The expression for rigid-body velocity is fundamental in kinematics. The formulation is scientifically sound.\n-   **Well-Posed**: The problem reduces to solving the vector Laplace equation $\\nabla^2 \\mathbf{w} = \\mathbf{0}$ on a bounded domain $\\Omega$ with specified Dirichlet boundary conditions $\\mathbf{w}|_{\\partial \\Omega} = \\mathbf{u}_b$. The Dirichlet problem for the Laplace equation is a classic example of a well-posed elliptic partial differential equation. Existence, uniqueness, and stability of the solution are guaranteed under the given conditions (bounded domain with Lipschitz boundary).\n-   **Objective**: The problem is stated using precise, unambiguous mathematical terminology. There are no subjective or opinion-based statements.\n-   **Consistency and Completeness**: The problem provides all necessary information: the governing partial differential equation, the domain properties, and the boundary conditions. There are no internal contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is scientifically sound, well-posed, objective, and self-contained. A rigorous solution can be derived from the provided information.\n\n### Solution Derivation\nThe core of the problem is to find the vector field $\\mathbf{w}(\\mathbf{x},t)$ that satisfies the following boundary value problem for each time $t$:\n$$\n\\nabla^2 \\mathbf{w}(\\mathbf{x},t) = \\mathbf{0} \\quad \\text{for } \\mathbf{x} \\in \\Omega\n$$\n$$\n\\mathbf{w}(\\mathbf{x},t) = \\mathbf{u}_{b}(\\mathbf{x},t) \\quad \\text{for } \\mathbf{x} \\in \\partial\\Omega\n$$\nwhere $\\mathbf{u}_{b}(\\mathbf{x},t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}$.\n\nThis vector equation can be decomposed into two independent scalar Laplace equations for the components of $\\mathbf{w} = (w_x, w_y)$. The components of the boundary velocity $\\mathbf{u}_b = (u_{b,x}, u_{b,y})$ are:\n$$\nu_{b,x}(x,y,t) = V_x(t) - \\omega(t)y\n$$\n$$\nu_{b,y}(x,y,t) = V_y(t) + \\omega(t)x\n$$\nSo, the two scalar problems are:\n1.  Find $w_x(x,y,t)$ such that $\\nabla^2 w_x = 0$ in $\\Omega$, with $w_x(x,y,t) = V_x(t) - \\omega(t)y$ for $(x,y) \\in \\partial\\Omega$.\n2.  Find $w_y(x,y,t)$ such that $\\nabla^2 w_y = 0$ in $\\Omega$, with $w_y(x,y,t) = V_y(t) + \\omega(t)x$ for $(x,y) \\in \\partial\\Omega$.\n\nThe Dirichlet problem for the Laplace equation has a unique solution. Let us propose a candidate solution for the interior velocity field $\\mathbf{w}(\\mathbf{x}, t)$ that has the same analytical form as the boundary velocity field, i.e.,\n$$\n\\mathbf{w}_{\\text{candidate}}(\\mathbf{x}, t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}\n$$\nfor all $\\mathbf{x} \\in \\Omega$.\n\nWe must verify if this candidate solution satisfies both the governing equation and the boundary condition.\nFirst, for any point $\\mathbf{x} \\in \\partial\\Omega$, the candidate solution is by definition equal to the prescribed boundary velocity: $\\mathbf{w}_{\\text{candidate}}(\\mathbf{x}, t) = \\mathbf{u}_{b}(\\mathbf{x}, t)$. Thus, the boundary condition is satisfied.\n\nSecond, we must verify that $\\mathbf{w}_{\\text{candidate}}$ satisfies the Laplace equation $\\nabla^2 \\mathbf{w} = \\mathbf{0}$ throughout the domain $\\Omega$. We check this component-wise.\nThe components of the candidate solution are:\n$$\nw_{\\text{candidate}, x}(x, y, t) = V_x(t) - \\omega(t) y\n$$\n$$\nw_{\\text{candidate}, y}(x, y, t) = V_y(t) + \\omega(t) x\n$$\nFor the $x$-component, the Laplacian is $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$. Note that $V_x(t)$ and $\\omega(t)$ are functions of $t$ only, so they are treated as constants with respect to spatial differentiation.\n$$\n\\nabla^2 w_{\\text{candidate}, x} = \\frac{\\partial^2}{\\partial x^2}\\left( V_x(t) - \\omega(t) y \\right) + \\frac{\\partial^2}{\\partial y^2}\\left( V_x(t) - \\omega(t) y \\right)\n$$\nThe first term is $\\frac{\\partial}{\\partial x}(0) = 0$. The second term is $\\frac{\\partial}{\\partial y}(-\\omega(t)) = 0$.\n$$\n\\nabla^2 w_{\\text{candidate}, x} = 0 + 0 = 0\n$$\nSo, the $x$-component is a harmonic function.\n\nFor the $y$-component:\n$$\n\\nabla^2 w_{\\text{candidate}, y} = \\frac{\\partial^2}{\\partial x^2}\\left( V_y(t) + \\omega(t) x \\right) + \\frac{\\partial^2}{\\partial y^2}\\left( V_y(t) + \\omega(t) x \\right)\n$$\nThe first term is $\\frac{\\partial}{\\partial x}(\\omega(t)) = 0$. The second term is $\\frac{\\partial}{\\partial y}(0) = 0$.\n$$\n\\nabla^2 w_{\\text{candidate}, y} = 0 + 0 = 0\n$$\nSo, the $y$-component is also a harmonic function.\n\nSince both components of $\\mathbf{w}_{\\text{candidate}}$ are harmonic, the vector field itself is harmonic: $\\nabla^2 \\mathbf{w}_{\\text{candidate}} = \\mathbf{0}$.\n\nWe have found a function, $\\mathbf{w}_{\\text{candidate}}(\\mathbf{x}, t)$, which satisfies both the governing PDE within $\\Omega$ and the prescribed Dirichlet condition on $\\partial\\Omega$. Because the solution to this boundary value problem is unique, our candidate solution must be the one and only solution.\nThis demonstrates a fundamental property: any rigid-body velocity field is a harmonic vector field. The harmonic lifting procedure, when applied to a boundary moving as a rigid body, simply extends this rigid-body velocity field into the interior of the domain.\n\nTherefore, the unique interior mesh velocity field is:\n$$\n\\mathbf{w}(\\mathbf{x}, t) = \\mathbf{V}(t) + \\omega(t)\\,\\mathbf{k} \\times \\mathbf{x}\n$$\nThe problem asks for this velocity at a specific mesh node $\\mathbf{x}_{0} = (x_{0}, y_{0})$ at a specific time $t_{0}$. We substitute these values into the derived expression:\n$$\n\\mathbf{w}(\\mathbf{x}_{0}, t_{0}) = \\mathbf{V}(t_{0}) + \\omega(t_{0})\\,\\mathbf{k} \\times \\mathbf{x}_{0}\n$$\nExpressing this in component form:\n$$\n\\mathbf{w}(\\mathbf{x}_{0}, t_{0}) = (V_x(t_0), V_y(t_0)) + \\omega(t_0)(-y_0, x_0)\n$$\n$$\n\\mathbf{w}(\\mathbf{x}_{0}, t_{0}) = (V_x(t_0) - \\omega(t_0)y_0, V_y(t_0) + \\omega(t_0)x_0)\n$$\nThis is the final analytical expression for the mesh velocity at the specified point and time.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} V_x(t_0) - \\omega(t_0)y_0 & V_y(t_0) + \\omega(t_0)x_0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Ensuring a numerical solver is implemented correctly is a critical task in computational science, a process known as code verification. The Method of Manufactured Solutions (MMS) provides a rigorous framework for this, where an analytical solution is 'manufactured' and substituted into the governing equations to derive a corresponding source term. This practice  challenges you to apply MMS to the ALE advection-diffusion equation, deriving the exact source term required to satisfy the equation for a given non-trivial mesh motion and temperature field. This exercise provides essential hands-on experience with the complete ALE transport equation and the formal process of verification.",
            "id": "3937079",
            "problem": "Consider a one-dimensional, nonreactive thermal scalar $T(x,t)$ governed by advection and diffusion in a domain that is tracked by an Arbitrary Lagrangian–Eulerian (ALE) moving mesh. Let the referential coordinate be $\\Xi \\in [0,1]$ and the physical coordinate be $x \\in \\mathbb{R}$. The time-dependent mapping from the referential configuration to the physical configuration is given by $x = \\chi(\\Xi,t)$ with\n$$\nx = \\chi(\\Xi,t) = \\Xi + \\varepsilon \\sin(\\pi \\Xi)\\,\\sin(\\omega t),\n$$\nwhere $\\varepsilon$ and $\\omega$ are real constants such that the mapping is a diffeomorphism for all $t$ of interest. The advection velocity in the physical frame is uniform and constant, $v(x,t) \\equiv U_0$, and the thermal diffusivity is constant, $\\alpha > 0$. Assume all variables are nondimensional. The mesh velocity is defined by $w(x,t) = \\partial \\chi/\\partial t \\big|_{\\Xi}$, and the Jacobian of the mapping is $J(\\Xi,t) = \\partial \\chi/\\partial \\Xi$.\n\nStarting from fundamental conservation of energy for a passive scalar in a moving control volume and the chain-rule relations implied by the mapping $\\chi(\\Xi,t)$, derive the strong-form ALE advection–diffusion equation. Then, use the method of manufactured solutions to determine the volumetric source term in the ALE frame, $S_{\\mathrm{ALE}}(\\Xi,t)$, required for the following manufactured temperature field to satisfy the ALE equation exactly:\n$$\nT(x,t) = \\Theta(\\Xi,t) = \\cos(2\\pi \\Xi)\\,\\exp(-\\lambda t),\n$$\nwhere $\\lambda > 0$ is a constant and $\\Xi$ is the referential coordinate mapped to $x$ by $\\chi(\\Xi,t)$. Express your final source term $S_{\\mathrm{ALE}}(\\Xi,t)$ as a single closed-form analytic expression in terms of $\\Xi$, $t$, $U_0$, $\\alpha$, $\\varepsilon$, $\\omega$, and $\\lambda$. No numerical rounding is required.",
            "solution": "The user wants me to solve the following problem:\nThe problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- **Governing Physics**: One-dimensional advection and diffusion of a nonreactive thermal scalar $T(x,t)$.\n- **Domain**: An Arbitrary Lagrangian–Eulerian (ALE) moving mesh.\n- **Coordinates**:\n    - Referential coordinate: $\\Xi \\in [0,1]$.\n    - Physical coordinate: $x \\in \\mathbb{R}$.\n- **Mapping**: The time-dependent mapping from referential to physical coordinates is $x = \\chi(\\Xi,t)$, given by:\n  $$x = \\chi(\\Xi,t) = \\Xi + \\varepsilon \\sin(\\pi \\Xi)\\,\\sin(\\omega t)$$\n  The mapping is a diffeomorphism, where $\\varepsilon$ and $\\omega$ are real constants.\n- **Physical Properties**:\n    - Advection velocity (physical frame): $v(x,t) = U_0$ (constant).\n    - Thermal diffusivity: $\\alpha > 0$ (constant).\n- **ALE-related Definitions**:\n    - Mesh velocity: $w(x,t) = \\frac{\\partial \\chi}{\\partial t} \\big|_{\\Xi}$.\n    - Jacobian of the mapping: $J(\\Xi,t) = \\frac{\\partial \\chi}{\\partial \\Xi}$.\n- **Manufactured Solution**: The temperature field is given in referential coordinates as:\n  $$T(x,t) = \\Theta(\\Xi,t) = \\cos(2\\pi \\Xi)\\,\\exp(-\\lambda t)$$\n  where $\\lambda > 0$ is a constant.\n- **Task**:\n    1.  Derive the strong-form ALE advection–diffusion equation.\n    2.  Use the method of manufactured solutions to find the volumetric source term in the ALE frame, $S_{\\mathrm{ALE}}(\\Xi,t)$, required for the given $\\Theta(\\Xi,t)$ to be an exact solution.\n    3.  Express $S_{\\mathrm{ALE}}(\\Xi,t)$ as a single closed-form analytic expression in terms of $\\Xi$, $t$, $U_0$, $\\alpha$, $\\varepsilon$, $\\omega$, and $\\lambda$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on the fundamental advection-diffusion equation, a cornerstone of transport phenomena. The Arbitrary Lagrangian–Eulerian (ALE) formulation is a standard and well-established method in computational mechanics and thermal-fluid sciences. The method of manufactured solutions (MMS) is a rigorous technique for verifying the correctness of numerical codes. The problem is scientifically sound.\n2.  **Well-Posed**: The problem asks for a derivation and then a calculation based on that derivation. All necessary functions and parameters are provided. The task is to compute a source term that makes a given function a solution to a derived equation, which is a well-defined mathematical procedure.\n3.  **Objective**: The language is precise and mathematical, with no subjective or ambiguous statements.\n4.  **Incomplete or Contradictory Setup**: The problem is self-contained. The mapping is stated to be a diffeomorphism, which implies that the Jacobian $J(\\Xi,t) = \\frac{\\partial \\chi}{\\partial \\Xi}$ is never zero (and assumed positive). This requires $| \\varepsilon \\pi \\cos(\\pi \\Xi)\\,\\sin(\\omega t) | < 1$, which imposes a physically reasonable constraint on $\\varepsilon$, namely $|\\varepsilon| < 1/\\pi$. The problem assumes this condition holds.\n5.  **Unrealistic or Infeasible**: The setup is a standard theoretical problem used for code verification. All functions are smooth and well-behaved. The setup is plausible and feasible.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the solution.\n\n### Part 1: Derivation of the Strong-Form ALE Advection–Diffusion Equation\nThe conservation of a scalar quantity $T$ in a fixed (Eulerian) one-dimensional domain is described by the advection-diffusion equation:\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x + \\frac{\\partial}{\\partial x}(vT) = \\frac{\\partial}{\\partial x}\\left(\\alpha \\frac{\\partial T}{\\partial x}\\right) + S_{\\text{phys}}(x,t) $$\nGiven that the fluid velocity $v = U_0$ and diffusivity $\\alpha$ are constants, the equation simplifies to:\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x + U_0 \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + S_{\\text{phys}}(x,t) $$\nIn the ALE framework, we wish to express the time evolution with respect to the referential coordinate $\\Xi$, which is held constant during the time differentiation. The relationship between the time derivative at a fixed physical point $x$ (Eulerian) and the time derivative at a fixed referential point $\\Xi$ (ALE) is given by the chain rule:\n$$ \\frac{\\partial T(x(\\Xi,t), t)}{\\partial t}\\bigg|_x = \\frac{\\partial \\Theta(\\Xi, t)}{\\partial t}\\bigg|_\\Xi + \\frac{\\partial \\Theta(\\Xi, t)}{\\partial \\Xi} \\frac{\\partial \\Xi(x,t)}{\\partial t}\\bigg|_x $$\nA more direct form is obtained by considering $T(x,t)$ where $x=\\chi(\\Xi,t)$. The total time derivative of $T$ holding $\\Xi$ constant is $\\frac{\\partial \\Theta}{\\partial t}\\big|_\\Xi$. The total time derivative holding $x$ constant is $\\frac{\\partial T}{\\partial t}\\big|_x$. From the relation $x=\\chi(\\Xi,t)$, we have $dx = \\frac{\\partial \\chi}{\\partial \\Xi}d\\Xi + \\frac{\\partial \\chi}{\\partial t}dt$. Holding $x$ constant ($dx=0$), we get $\\frac{d\\Xi}{dt}\\big|_x = -(\\frac{\\partial \\chi}{\\partial t})/(\\frac{\\partial \\chi}{\\partial \\Xi}) = -w/J$.\nThe chain rule gives:\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x = \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + \\frac{\\partial \\Theta}{\\partial \\Xi} \\frac{d\\Xi}{dt}\\bigg|_x = \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi - \\frac{w}{J}\\frac{\\partial \\Theta}{\\partial \\Xi} $$\nNoting that $\\frac{\\partial T}{\\partial x} = \\frac{1}{J}\\frac{\\partial \\Theta}{\\partial \\Xi}$, we can write this as:\n$$ \\frac{\\partial T}{\\partial t}\\bigg|_x = \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi - w \\frac{\\partial T}{\\partial x} $$\nSubstituting this into the Eulerian equation gives the ALE equation in the physical frame:\n$$ \\left(\\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi - w \\frac{\\partial T}{\\partial x}\\right) + U_0 \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + S_{\\text{phys}} $$\n$$ \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + (U_0 - w) \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + S_{\\text{phys}} $$\nNow, we transform the spatial derivatives to the referential frame using $\\frac{\\partial}{\\partial x} = \\frac{1}{J}\\frac{\\partial}{\\partial \\Xi}$:\n$$ \\frac{\\partial T}{\\partial x} = \\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} $$\n$$ \\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\frac{1}{J}\\frac{\\partial}{\\partial \\Xi}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) $$\nSubstituting these into the physical-frame ALE equation and identifying $S_{\\mathrm{ALE}}(\\Xi,t) = S_{\\text{phys}}(\\chi(\\Xi,t),t)$ yields the strong-form ALE advection-diffusion equation in referential coordinates:\n$$ \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + (U_0 - w) \\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} = \\alpha \\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) + S_{\\mathrm{ALE}}(\\Xi,t) $$\nSince $\\alpha$ is a constant, this can also be written as:\n$$ \\frac{\\partial \\Theta}{\\partial t}\\bigg|_\\Xi + \\frac{U_0 - w}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} = \\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) + S_{\\mathrm{ALE}}(\\Xi,t) $$\nThis is the equation we must satisfy.\n\n### Part 2: Calculation of the Source Term $S_{\\mathrm{ALE}}(\\Xi,t)$\nWe rearrange the derived equation to solve for the source term:\n$$ S_{\\mathrm{ALE}}(\\Xi,t) = \\frac{\\partial \\Theta}{\\partial t} + \\frac{U_0 - w}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} - \\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) $$\nWe now compute each term using the given mapping and manufactured solution.\n\n1.  **Geometric and Kinematic Terms**:\n    -   Mapping: $x = \\chi(\\Xi,t) = \\Xi + \\varepsilon \\sin(\\pi \\Xi)\\sin(\\omega t)$\n    -   Jacobian: $J(\\Xi,t) = \\frac{\\partial \\chi}{\\partial \\Xi} = 1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)$\n    -   Mesh velocity: $w(\\Xi,t) = \\frac{\\partial \\chi}{\\partial t} = \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t)$\n    -   Derivative of Jacobian: $\\frac{\\partial J}{\\partial \\Xi} = -\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)$\n\n2.  **Temperature Field Derivatives**:\n    -   Temperature: $\\Theta(\\Xi,t) = \\cos(2\\pi \\Xi)\\exp(-\\lambda t)$\n    -   Time derivative: $\\frac{\\partial \\Theta}{\\partial t} = -\\lambda \\cos(2\\pi \\Xi)\\exp(-\\lambda t)$\n    -   First spatial derivative: $\\frac{\\partial \\Theta}{\\partial \\Xi} = -2\\pi \\sin(2\\pi \\Xi)\\exp(-\\lambda t)$\n    -   Second spatial derivative: $\\frac{\\partial^2 \\Theta}{\\partial \\Xi^2} = -4\\pi^2 \\cos(2\\pi \\Xi)\\exp(-\\lambda t)$\n\n3.  **Assemble the Terms for $S_{\\mathrm{ALE}}$**:\n\n    -   **Transient Term**:\n        $$ \\frac{\\partial \\Theta}{\\partial t} = -\\lambda \\cos(2\\pi \\Xi)\\exp(-\\lambda t) $$\n\n    -   **Advection Term**:\n        $$ \\frac{U_0 - w}{J} \\frac{\\partial \\Theta}{\\partial \\Xi} = \\frac{U_0 - \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t)}{1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)} \\left( -2\\pi \\sin(2\\pi \\Xi)\\exp(-\\lambda t) \\right) $$\n\n    -   **Diffusion Term**:\n        The diffusion term is $-\\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right)$. We evaluate the inner part first:\n        $$ \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\alpha \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{1}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\alpha \\left[ \\frac{\\partial (1/J)}{\\partial \\Xi}\\frac{\\partial \\Theta}{\\partial \\Xi} + \\frac{1}{J}\\frac{\\partial^2 \\Theta}{\\partial \\Xi^2} \\right] $$\n        $$ \\frac{\\partial (1/J)}{\\partial \\Xi} = -\\frac{1}{J^2}\\frac{\\partial J}{\\partial \\Xi} = -\\frac{1}{J^2}(-\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)) = \\frac{\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)}{J^2} $$\n        Substituting the derivatives:\n        $$ \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = \\alpha \\left[ \\left(\\frac{\\varepsilon \\pi^2 \\sin(\\pi \\Xi)\\sin(\\omega t)}{J^2}\\right)(-2\\pi \\sin(2\\pi \\Xi)\\exp(-\\lambda t)) + \\frac{1}{J}(-4\\pi^2 \\cos(2\\pi \\Xi)\\exp(-\\lambda t)) \\right] $$\n        $$ = \\alpha \\pi^2 \\exp(-\\lambda t) \\left[ -\\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^2} - \\frac{4\\cos(2\\pi \\Xi)}{J} \\right] $$\n        So, the full diffusion contribution to $S_{\\mathrm{ALE}}$ is:\n        $$ -\\frac{1}{J} \\frac{\\partial}{\\partial \\Xi}\\left(\\frac{\\alpha}{J} \\frac{\\partial \\Theta}{\\partial \\Xi}\\right) = -\\frac{\\alpha \\pi^2 \\exp(-\\lambda t)}{J} \\left[ -\\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^2} - \\frac{4\\cos(2\\pi \\Xi)}{J} \\right] $$\n        $$ = \\alpha \\pi^2 \\exp(-\\lambda t) \\left[ \\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^3} + \\frac{4\\cos(2\\pi \\Xi)}{J^2} \\right] $$\n\n4.  **Final Expression for $S_{\\mathrm{ALE}}(\\Xi,t)$**:\n    Combining all terms and factoring out $\\exp(-\\lambda t)$:\n    $$ S_{\\mathrm{ALE}}(\\Xi,t) = \\exp(-\\lambda t) \\left[ -\\lambda \\cos(2\\pi \\Xi) - 2\\pi \\sin(2\\pi \\Xi)\\frac{U_0 - w}{J} + \\alpha \\pi^2 \\left( \\frac{2\\varepsilon \\pi \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{J^3} + \\frac{4\\cos(2\\pi \\Xi)}{J^2} \\right) \\right] $$\n    Substituting the full expressions for $w$ and $J$:\n    $$ S_{\\mathrm{ALE}}(\\Xi,t) = \\exp(-\\lambda t) \\Bigg[ -\\lambda \\cos(2\\pi \\Xi) - \\frac{2\\pi \\sin(2\\pi \\Xi) \\left(U_0 - \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t)\\right)}{1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)} + \\frac{4\\alpha\\pi^2 \\cos(2\\pi \\Xi)}{\\left(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)\\right)^2} + \\frac{2\\alpha \\varepsilon \\pi^3 \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{\\left(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)\\right)^3} \\Bigg] $$\n    This is the final closed-form analytic expression for the source term.",
            "answer": "$$ \\boxed{\\exp(-\\lambda t) \\left[ -\\lambda \\cos(2\\pi \\Xi) - \\frac{2\\pi \\sin(2\\pi \\Xi) (U_0 - \\varepsilon \\omega \\sin(\\pi \\Xi)\\cos(\\omega t))}{1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t)} + \\frac{4\\alpha\\pi^2 \\cos(2\\pi \\Xi)}{(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t))^2} + \\frac{2\\alpha \\varepsilon \\pi^3 \\sin(\\pi \\Xi)\\sin(2\\pi \\Xi)\\sin(\\omega t)}{(1 + \\varepsilon \\pi \\cos(\\pi \\Xi)\\sin(\\omega t))^3} \\right]} $$"
        },
        {
            "introduction": "A fundamental sanity check for any ALE solver is the \"free-stream preservation\" test: a uniform flow field should remain perfectly uniform, even as the mesh deforms arbitrarily. Failure to pass this test indicates a critical flaw in the discretization that can generate artificial mass, momentum, or energy. This practice  demonstrates that free-stream preservation is intrinsically linked to the exact satisfaction of the discrete Geometric Conservation Law (GCL). You will implement and contrast a \"naive\" discretization with a GCL-consistent one, providing direct, computational proof of the GCL's necessity.",
            "id": "3937108",
            "problem": "Consider a one-dimensional Arbitrary Lagrangian–Eulerian (ALE) moving-mesh mapping for computational thermal engineering, where the physical coordinate $x$ is mapped from a fixed reference coordinate $X \\in [0,1]$ by $x = x(X,t)$, and time $t \\ge 0$. The temperature field is denoted $T(x,t)$ and is assumed to be a conserved passive scalar without physical convection or diffusion. The mapping is defined by a nontrivial oscillatory motion\n$$\nx(X,t) = X + \\alpha \\sin(2\\pi X)\\,\\sin(\\omega t),\n$$\nwhere $\\alpha > 0$ is the oscillation amplitude and $\\omega > 0$ is the angular frequency. Use radians for angles. Let the reference mesh be uniform with $N$ cells and reference faces $X_{f,j} = j/N$ for $j=0,1,\\dots,N$, and reference cell centers $X_{i} = (i+1/2)/N$ for $i=0,1,\\dots,N-1$.\n\nFundamental base: Start from the integral conservation of thermal energy in a moving control volume in one spatial dimension, derived from the Reynolds transport theorem and the conservation of a passive scalar, which states that for a moving interval $[x_{L}(t), x_{R}(t)]$ advected only by mesh motion (no physical flow and no sources),\n$$\n\\frac{d}{dt}\\int_{x_{L}(t)}^{x_{R}(t)} T(x,t)\\,dx + \\left[(u-w)\\,T\\right]_{x_{L}(t)}^{x_{R}(t)} = 0,\n$$\nwhere $u$ is the physical flow velocity (here $u=0$) and $w$ is the mesh (grid) velocity at the moving boundary. Denote the cell physical length by $J_i(t) = x_{f,i+1}(t) - x_{f,i}(t)$, the cell total thermal content by $Q_i(t) = J_i(t)\\,\\bar{T}_i(t)$ where $\\bar{T}_i$ is the cell-averaged temperature, and the face grid velocities by $w_{f,j}(t) = \\frac{dx_{f,j}(t)}{dt}$. The mixed partial derivatives of the mapping imply the identity\n$$\n\\frac{\\partial}{\\partial t}\\left(\\frac{\\partial x}{\\partial X}\\right) = \\frac{\\partial}{\\partial X}\\left(\\frac{\\partial x}{\\partial t}\\right),\n$$\nwhich, in one dimension, underpins the geometric conservation law (GCL) needed for free-stream preservation. The angle unit throughout is radians.\n\nTask: Design and implement a free-stream preservation test, verifying that a uniform initial temperature field $T(x,0) \\equiv T_0$ remains uniform after one oscillation period $T_{\\text{period}} = 2\\pi/\\omega$ under the given mapping. Implement two distinct discretizations:\n\n- A \"naive metrics\" discretization that uses center-based Jacobians $J_i(t)$ computed from the analytical derivative at the cell centers, $J_i(t) \\approx \\left.\\frac{\\partial x}{\\partial X}\\right|_{X_i,t}\\,\\Delta X$ with $\\Delta X = 1/N$, and face grid velocities $w_{f,j}(t)$ computed analytically at time $t$ from $w_{f,j}(t) = \\left.\\frac{\\partial x}{\\partial t}\\right|_{X_{f,j},t}$. Update the thermal content $Q_i$ using an explicit time-stepping scheme over one full period, and define the temperature update by $\\bar{T}_i(t) = Q_i(t)/J_i(t)$ at each step.\n\n- A \"geometric conservation law (GCL)-consistent metrics\" discretization that computes face positions $x_{f,j}(t)$ exactly from the mapping at time levels, updates face grid velocities by time integration over each step $w_{f,j}^n \\approx \\left(x_{f,j}^{n+1}-x_{f,j}^{n}\\right)/\\Delta t$, updates cell Jacobians by $J_i^n = x_{f,i+1}^n - x_{f,i}^n$ at each time level, and advances the thermal content $Q_i$ using the face grid velocities in such a way that the discrete geometric identity relating $J_i$ and the face velocities holds over each time step. The goal is to ensure that a uniform $T$ remains uniform to within a specified tolerance.\n\nYou must derive from the fundamental base the discrete conditions on the metric terms and design an algorithm that enforces the necessary discrete geometric identities for free-stream preservation. Scientifically realistic constraints: choose $\\alpha$ such that the mesh does not tangle for all $t \\in [0,T_{\\text{period}}]$, i.e., $J_i(t) > 0$ for all $i$ and $t$. For this mapping, a sufficient constraint is $\\alpha < 1/(2\\pi)$.\n\nNumerical experiment specification: Simulate the evolution from $t=0$ to $t=T_{\\text{period}}$ for the following test suite. For each test case, initialize $T_0 = 1.0$ (dimensionless), and use a uniform time step $\\Delta t = T_{\\text{period}}/\\text{steps}$.\n\n- Test case 1 (happy path): $N=100$, $\\alpha=0.10$, $\\omega=2\\pi$, $\\text{steps}=200$.\n- Test case 2 (boundary case: static mesh): $N=100$, $\\alpha=0.0$, $\\omega=2\\pi$, $\\text{steps}=10$.\n- Test case 3 (high-frequency oscillation): $N=200$, $\\alpha=0.12$, $\\omega=20\\pi$, $\\text{steps}=1000$.\n- Test case 4 (near-tangling boundary but safe): $N=80$, $\\alpha=1/(2\\pi)-10^{-3}$, $\\omega=4\\pi$, $\\text{steps}=500$.\n\nFor each test case and for each discretization, compute the maximum absolute deviation from the initial uniform temperature at the end of one full period,\n$$\nE = \\max_{i}\\left|\\bar{T}_i(T_{\\text{period}}) - T_0\\right|.\n$$\nSpecify a tolerance for passing the free-stream preservation test as $\\varepsilon = 10^{-10}$ (dimensionless). The \"naive metrics\" scheme is expected to fail (produce $E > \\varepsilon$) for nontrivial motion, while the \"GCL-consistent metrics\" scheme is expected to pass (produce $E \\le \\varepsilon$) in all cases, including challenging oscillations.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, for each test case in the order given above, first the \"naive metrics\" maximum deviation $E$ and then the \"GCL-consistent metrics\" maximum deviation $E$. For example, the output should be of the form\n$$\n[\\;E_{1,\\text{naive}},\\;E_{1,\\text{GCL}},\\;E_{2,\\text{naive}},\\;E_{2,\\text{GCL}},\\;E_{3,\\text{naive}},\\;E_{3,\\text{GCL}},\\;E_{4,\\text{naive}},\\;E_{4,\\text{GCL}}\\;].\n$$\nAll angles must be in radians, and all outputs are dimensionless floating-point numbers.",
            "solution": "The problem requires the design and implementation of a numerical experiment to test the free-stream preservation property of two different discretizations for an Arbitrary Lagrangian–Eulerian (ALE) moving-mesh formulation. A uniform initial temperature field, being a trivial solution to the governing advection equation in the absence of sources and diffusion, should remain uniform for all time. A numerical scheme that fails to maintain this uniform state is said to violate the free-stream condition, which is a direct consequence of not satisfying the Geometric Conservation Law (GCL) in its discrete form.\n\nThe fundamental equation is the integral conservation of a passive scalar quantity $T$ in a one-dimensional moving control volume $[x_L(t), x_R(t)]$:\n$$\n\\frac{d}{dt}\\int_{x_{L}(t)}^{x_{R}(t)} T(x,t)\\,dx + \\left[(u-w)\\,T\\right]_{x_{L}(t)}^{x_{R}(t)} = 0\n$$\nGiven no physical flow ($u=0$), the equation for a computational cell $i$ bounded by faces at $x_{f,i}(t)$ and $x_{f,i+1}(t)$ simplifies. Denoting the cell-averaged temperature as $\\bar{T}_i$, the total scalar content in the cell as $Q_i(t) = \\bar{T}_i(t) J_i(t)$, where $J_i(t) = x_{f,i+1}(t)-x_{f,i}(t)$ is the cell volume (length in 1D), and the grid velocity at a face $j$ as $w_{f,j}(t) = dx_{f,j}/dt$, the conservation law becomes:\n$$\n\\frac{dQ_i}{dt} = w_{f,i+1}(t)T_{f,i+1}(t) - w_{f,i}(t)T_{f,i}(t)\n$$\nwhere $T_{f,j}$ is the temperature at face $j$.\n\nThe continuous GCL is derived from the identity of mixed partial derivatives of the mapping $x(X,t)$, stating $\\frac{\\partial}{\\partial t}\\left(\\frac{\\partial x}{\\partial X}\\right) = \\frac{\\partial}{\\partial X}\\left(\\frac{\\partial x}{\\partial t}\\right)$. Integrating this over a reference cell $[X_{f,i}, X_{f,i+1}]$ yields the relationship between the rate of change of the cell volume and the face velocities:\n$$\n\\frac{dJ_i}{dt} = w_{f,i+1}(t) - w_{f,i}(t)\n$$\nFor a free-stream field $T(x,t) = T_0$, a constant, we have $\\bar{T}_i(t) = T_0$ and $T_{f,j}(t) = T_0$. The conservation law reduces to $T_0\\frac{dJ_i}{dt} = T_0(w_{f,i+1} - w_{f,i})$, which is precisely the GCL. Therefore, a numerical scheme preserves the free stream if and only if its discrete conservation equation reduces to its discrete GCL for a constant field.\n\nUsing a forward Euler time-stepping scheme with step size $\\Delta t$, the discrete conservation law for the free-stream test ($T_f^n=T_0$) is:\n$$\nQ_i^{n+1} = Q_i^n + \\Delta t \\, T_0 \\left(w_{f,i+1}^n - w_{f,i}^n\\right)\n$$\nSubstituting $Q_i^n = J_i^n T_0$, we get $Q_i^{n+1} = T_0 \\left(J_i^n + \\Delta t (w_{f,i+1}^n - w_{f,i}^n)\\right)$. The new temperature is $\\bar{T}_i^{n+1} = Q_i^{n+1} / J_i^{n+1}$. For this to equal $T_0$, the scheme must satisfy the Discrete Geometric Conservation Law (DGCL):\n$$\nJ_i^{n+1} = J_i^n + \\Delta t \\left(w_{f,i+1}^n - w_{f,i}^n\\right)\n$$\nThe two required schemes differ in how they define the metric terms $J_i$ and $w_{f,j}$, which determines whether they satisfy the DGCL. The mapping is $x(X,t) = X + \\alpha \\sin(2\\pi X)\\sin(\\omega t)$.\n\n### Discretization 1: Naive Metrics\nThis approach computes metrics from the analytical derivatives of the mapping at different locations, breaking the geometric consistency.\n- **Cell Jacobian**: Computed at the cell center $X_i$ at time $t^n$: $J_i^n = \\left.\\frac{\\partial x}{\\partial X}\\right|_{X_i, t^n} \\Delta X = \\left(1 + 2\\pi\\alpha \\cos(2\\pi X_i)\\sin(\\omega t^n)\\right)\\Delta X$. The cell volume at $t^{n+1}$, $J_i^{n+1}$, is computed similarly.\n- **Face Velocity**: Computed at the face locations $X_{f,j}$ at time $t^n$: $w_{f,j}^n = \\left.\\frac{\\partial x}{\\partial t}\\right|_{X_{f,j}, t^n} = \\alpha\\omega \\sin(2\\pi X_{f,j})\\cos(\\omega t^n)$.\n\nThe DGCL is not satisfied because the update to $J_i$ via its analytical formula does not match the update implied by the discrete face velocities. This spatial inconsistency between cell-centered Jacobians and face-centered velocities leads to a truncation error that manifests as a failure to preserve the free stream.\n\n### Discretization 2: GCL-Consistent Metrics\nThis approach constructs the discrete metrics in a way that satisfies the DGCL by definition.\n- **Face Positions**: Calculated exactly from the mapping at time levels $n$ and $n+1$: $x_{f,j}^n = x(X_{f,j}, t^n)$.\n- **Cell Jacobian**: Calculated from the face positions: $J_i^n = x_{f,i+1}^n - x_{f,i}^n$ and $J_i^{n+1} = x_{f,i+1}^{n+1} - x_{f,i}^{n+1}$.\n- **Face Velocity**: Defined as a finite difference that exactly bridges the change in face positions over a time step: $w_{f,j}^n = \\frac{x_{f,j}^{n+1} - x_{f,j}^n}{\\Delta t}$.\n\nSubstituting these definitions into the DGCL yields an identity:\n$$\n(x_{f,i+1}^{n+1} - x_{f,i}^{n+1}) = (x_{f,i+1}^n - x_{f,i}^n) + \\Delta t \\left( \\frac{x_{f,i+1}^{n+1} - x_{f,i+1}^n}{\\Delta t} - \\frac{x_{f,i}^{n+1} - x_{f,i}^n}{\\Delta t} \\right)\n$$\nThis simplifies to $x_{f,i+1}^{n+1} - x_{f,i}^{n+1} = x_{f,i+1}^{n+1} - x_{f,i}^{n+1}$. Since the DGCL is satisfied identically, this scheme is expected to preserve the free-stream condition to within machine floating-point precision. The case where $\\alpha=0$ reduces to a static mesh, for which both schemes are expected to perform perfectly as face velocities are zero.\n\nThe solution is implemented by simulating the evolution of the temperature field for one full period $T_{\\text{period}} = 2\\pi/\\omega$ for each test case and each scheme, then computing the maximum deviation from the initial uniform temperature $T_0=1.0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the free-stream preservation problem for an ALE moving mesh.\n    \"\"\"\n\n    test_cases = [\n        {'N': 100, 'alpha': 0.10, 'omega_val': 2.0 * np.pi, 'steps': 200},\n        {'N': 100, 'alpha': 0.0, 'omega_val': 2.0 * np.pi, 'steps': 10},\n        {'N': 200, 'alpha': 0.12, 'omega_val': 20.0 * np.pi, 'steps': 1000},\n        {'N': 80, 'alpha': 1.0 / (2.0 * np.pi) - 1e-3, 'omega_val': 4.0 * np.pi, 'steps': 500},\n    ]\n\n    results = []\n\n    # Mapping and its derivatives\n    def x_map(X, t, alpha, omega):\n        return X + alpha * np.sin(2.0 * np.pi * X) * np.sin(omega * t)\n\n    def dx_dX(X, t, alpha, omega):\n        return 1.0 + alpha * 2.0 * np.pi * np.cos(2.0 * np.pi * X) * np.sin(omega * t)\n\n    def dx_dt(X, t, alpha, omega):\n        return alpha * omega * np.sin(2.0 * np.pi * X) * np.cos(omega * t)\n\n    for case in test_cases:\n        N = case['N']\n        alpha = case['alpha']\n        omega = case['omega_val']\n        steps = case['steps']\n\n        T0 = 1.0\n        T_period = 2.0 * np.pi / omega\n        dt = T_period / steps\n        \n        # Reference mesh coordinates\n        X_faces = np.linspace(0.0, 1.0, N + 1)\n        X_centers = (X_faces[:-1] + X_faces[1:]) / 2.0\n        dX = 1.0 / N\n\n        # --- Scheme 1: Naive Metrics ---\n        # Initialize temperature and total quantity\n        T_naive = np.full(N, T0)\n        \n        # Initial Jacobian and total quantity\n        J0_naive = dx_dX(X_centers, 0.0, alpha, omega) * dX\n        Q_naive = J0_naive * T_naive\n        \n        t_current = 0.0\n        for _ in range(steps):\n            w_faces_naive = dx_dt(X_faces, t_current, alpha, omega)\n            \n            # Flux difference using face velocities\n            flux_diff = w_faces_naive[1:] - w_faces_naive[:-1]\n            \n            # Update total quantity Q\n            Q_naive += dt * T0 * flux_diff\n            \n            t_current += dt\n\n        # Final temperature calculation\n        J_final_naive = dx_dX(X_centers, T_period, alpha, omega) * dX\n        T_final_naive = Q_naive / J_final_naive\n        E_naive = np.max(np.abs(T_final_naive - T0))\n        results.append(E_naive)\n        \n        # --- Scheme 2: GCL-Consistent Metrics ---\n        # Initialize temperature and total quantity\n        T_gcl = np.full(N, T0)\n\n        # Initial Jacobian and total quantity from exact face positions\n        x_faces_t0 = x_map(X_faces, 0.0, alpha, omega)\n        J0_gcl = x_faces_t0[1:] - x_faces_t0[:-1]\n        Q_gcl = J0_gcl * T_gcl\n\n        t_current = 0.0\n        for i in range(steps):\n            t_next = (i + 1) * dt\n            \n            x_faces_curr = x_map(X_faces, t_current, alpha, omega)\n            x_faces_next = x_map(X_faces, t_next, alpha, omega)\n\n            # GCL-consistent velocities\n            w_faces_gcl = (x_faces_next - x_faces_curr) / dt\n            \n            # Flux difference\n            flux_diff = w_faces_gcl[1:] - w_faces_gcl[:-1]\n            \n            # Update total quantity Q\n            Q_gcl += dt * T0 * flux_diff\n            \n            t_current = t_next\n            \n        # Final temperature calculation\n        x_faces_final = x_map(X_faces, T_period, alpha, omega)\n        J_final_gcl = x_faces_final[1:] - x_faces_final[:-1]\n        T_final_gcl = Q_gcl / J_final_gcl\n        E_gcl = np.max(np.abs(T_final_gcl - T0))\n        results.append(E_gcl)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}