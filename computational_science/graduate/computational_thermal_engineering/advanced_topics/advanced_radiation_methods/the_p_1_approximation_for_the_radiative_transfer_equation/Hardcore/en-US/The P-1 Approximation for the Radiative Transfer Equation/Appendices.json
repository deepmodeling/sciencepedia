{
    "hands_on_practices": [
        {
            "introduction": "This foundational exercise guides you through the derivation of the P-1 approximation, starting from the first principles of the Radiative Transfer Equation (RTE). By applying the spherical harmonics expansion and taking the first angular moment of the RTE, you will see how the complex integro-differential equation simplifies into a familiar diffusion-type model. This practice is essential for understanding the theoretical origins of the P-1 method, defining the radiative diffusion coefficient $D$, and learning to assess when this powerful approximation is physically valid using the concept of transport optical thickness.",
            "id": "3992977",
            "problem": "A plane-parallel, homogeneous, gray, isothermal participating medium of thickness $L$ is bounded by large, diffuse-gray walls. The medium is emitting, absorbing, and scattering, with absorption coefficient $\\kappa$, scattering coefficient $\\sigma_{s}$, and anistropic scattering characterized by the Henyey–Greenstein asymmetry factor $g$. The specific intensity $I(\\mathbf{r},\\hat{\\mathbf{s}})$ obeys the steady Radiative Transfer Equation (RTE), and the P-$1$ (first-order spherical harmonics) approximation may be invoked by truncating the spherical harmonics expansion of $I(\\mathbf{r},\\hat{\\mathbf{s}})$ at order $1$. Starting from the RTE and the definitions of the zeroth and first angular moments,\n$$G(\\mathbf{r}) = \\int_{4\\pi} I(\\mathbf{r},\\hat{\\mathbf{s}})\\, \\mathrm{d}\\Omega, \\qquad \\mathbf{F}(\\mathbf{r}) = \\int_{4\\pi} \\hat{\\mathbf{s}}\\, I(\\mathbf{r},\\hat{\\mathbf{s}})\\, \\mathrm{d}\\Omega,$$\nderive the diffusion form that relates $\\mathbf{F}$ to $\\nabla G$ and identify the corresponding diffusion coefficient $D$ in terms of $\\kappa$, $\\sigma_{s}$, and $g$. Then, for the medium parameters\n$$\\kappa = 0.6~\\mathrm{m}^{-1}, \\qquad \\sigma_{s} = 25~\\mathrm{m}^{-1}, \\qquad g = 0.85, \\qquad L = 1.2~\\mathrm{m},$$\ncompute the numerical value of $D$ and evaluate the transport optical thickness across the slab to assess whether the diffusion approximation is expected to be valid. State your physical reasoning based on first principles of optical thickness and angular isotropy, using the transport optical thickness concept appropriate for anisotropic scattering.\n\nExpress the final numerical value of the diffusion coefficient $D$ in meters, and round your answer to $4$ significant figures.",
            "solution": "The problem requires the derivation of the diffusion approximation for radiative transfer from the P-1 approximation of the Radiative Transfer Equation (RTE), the identification of the diffusion coefficient $D$, the calculation of its numerical value for the given parameters, and an assessment of the validity of this approximation.\n\n**Part 1: Derivation of the Diffusion Relation**\n\nThe steady-state Radiative Transfer Equation (RTE) for a gray, emitting, absorbing, and anisotropically scattering medium is given by:\n$$\n\\hat{\\mathbf{s}} \\cdot \\nabla I(\\mathbf{r},\\hat{\\mathbf{s}}) = -\\beta I(\\mathbf{r},\\hat{\\mathbf{s}}) + \\kappa I_b(\\mathbf{r}) + \\frac{\\sigma_s}{4\\pi} \\int_{4\\pi} I(\\mathbf{r},\\hat{\\mathbf{s}}') \\Phi(\\hat{\\mathbf{s}}', \\hat{\\mathbf{s}}) \\, \\mathrm{d}\\Omega'\n$$\nwhere $I(\\mathbf{r},\\hat{\\mathbf{s}})$ is the specific radiation intensity at position $\\mathbf{r}$ in direction $\\hat{\\mathbf{s}}$, $\\kappa$ is the absorption coefficient, $\\sigma_s$ is the scattering coefficient, $\\beta = \\kappa + \\sigma_s$ is the extinction coefficient, $I_b$ is the blackbody intensity, and $\\Phi(\\hat{\\mathbf{s}}', \\hat{\\mathbf{s}})$ is the scattering phase function.\n\nThe P-1 approximation is based on truncating the spherical harmonics expansion of the intensity after the first-order terms. This results in an expression for the intensity that is linear in the direction vector components:\n$$\nI(\\mathbf{r},\\hat{\\mathbf{s}}) \\approx \\frac{1}{4\\pi} G(\\mathbf{r}) + \\frac{3}{4\\pi} \\mathbf{F}(\\mathbf{r}) \\cdot \\hat{\\mathbf{s}}\n$$\nHere, $G(\\mathbf{r})$ is the incident radiation (the zeroth angular moment of intensity) and $\\mathbf{F}(\\mathbf{r})$ is the radiative flux vector (the first angular moment of intensity), as defined in the problem statement.\n\nTo derive the relationship between $\\mathbf{F}$ and $G$, we take the first moment of the RTE. This is achieved by multiplying the entire RTE by the direction vector $\\hat{\\mathbf{s}}$ and integrating over the full solid angle $4\\pi$:\n$$\n\\int_{4\\pi} \\hat{\\mathbf{s}} (\\hat{\\mathbf{s}} \\cdot \\nabla I) \\, \\mathrm{d}\\Omega = \\int_{4\\pi} \\hat{\\mathbf{s}} \\left( -\\beta I + \\kappa I_b + \\frac{\\sigma_s}{4\\pi} \\int_{4\\pi} I' \\Phi(\\hat{\\mathbf{s}}', \\hat{\\mathbf{s}}) \\, \\mathrm{d}\\Omega' \\right) \\, \\mathrm{d}\\Omega\n$$\nLet us evaluate each term.\n\nLeft-hand side (LHS):\nThe term $\\hat{\\mathbf{s}} (\\hat{\\mathbf{s}} \\cdot \\nabla I)$ can be written as $\\nabla \\cdot (\\hat{\\mathbf{s}}\\hat{\\mathbf{s}}I)$ by noting that $\\nabla$ does not operate on $\\hat{\\mathbf{s}}$.\n$$\n\\text{LHS} = \\int_{4\\pi} \\nabla \\cdot (\\hat{\\mathbf{s}}\\hat{\\mathbf{s}}I) \\, \\mathrm{d}\\Omega = \\nabla \\cdot \\left( \\int_{4\\pi} \\hat{\\mathbf{s}}\\hat{\\mathbf{s}}I \\, \\mathrm{d}\\Omega \\right)\n$$\nWe substitute the P-1 expansion for $I$ into the integral:\n$$\n\\int_{4\\pi} \\hat{\\mathbf{s}}\\hat{\\mathbf{s}}I \\, \\mathrm{d}\\Omega \\approx \\int_{4\\pi} \\hat{\\mathbf{s}}\\hat{\\mathbf{s}} \\left( \\frac{1}{4\\pi} G + \\frac{3}{4\\pi} \\mathbf{F} \\cdot \\hat{\\mathbf{s}} \\right) \\, \\mathrm{d}\\Omega\n$$\nThe integral separates into two parts. The second part involves an integral of a third-rank tensor ($\\hat{\\mathbf{s}}\\hat{\\mathbf{s}}\\hat{\\mathbf{s}}$), which is zero due to symmetry. Using the identity $\\int_{4\\pi} \\hat{\\mathbf{s}}\\hat{\\mathbf{s}} \\, \\mathrm{d}\\Omega = \\frac{4\\pi}{3}\\mathbf{I}$ (where $\\mathbf{I}$ is the identity tensor), the first part becomes:\n$$\n\\int_{4\\pi} \\hat{\\mathbf{s}}\\hat{\\mathbf{s}}I \\, \\mathrm{d}\\Omega \\approx \\frac{G}{4\\pi} \\int_{4\\pi} \\hat{\\mathbf{s}}\\hat{\\mathbf{s}} \\, \\mathrm{d}\\Omega = \\frac{G}{4\\pi} \\left( \\frac{4\\pi}{3}\\mathbf{I} \\right) = \\frac{G}{3}\\mathbf{I}\n$$\nThus, the LHS becomes:\n$$\n\\text{LHS} = \\nabla \\cdot \\left( \\frac{G}{3}\\mathbf{I} \\right) = \\frac{1}{3}\\nabla G\n$$\n\nRight-hand side (RHS):\nThe RHS consists of three terms.\n1. Absorption/out-scattering loss term:\n$$ -\\beta \\int_{4\\pi} \\hat{\\mathbf{s}} I \\, \\mathrm{d}\\Omega = -\\beta \\mathbf{F} $$\n2. Emission source term:\n$$ \\kappa I_b \\int_{4\\pi} \\hat{\\mathbf{s}} \\, \\mathrm{d}\\Omega = 0 $$\nsince the integral of $\\hat{\\mathbf{s}}$ over a sphere is zero.\n3. In-scattering source term:\n$$ \\int_{4\\pi} \\hat{\\mathbf{s}} \\left( \\frac{\\sigma_s}{4\\pi} \\int_{4\\pi} I' \\Phi(\\hat{\\mathbf{s}}', \\hat{\\mathbf{s}}) \\, \\mathrm{d}\\Omega' \\right) \\, \\mathrm{d}\\Omega = \\frac{\\sigma_s}{4\\pi} \\int_{4\\pi} I' \\left( \\int_{4\\pi} \\hat{\\mathbf{s}} \\Phi(\\hat{\\mathbf{s}}', \\hat{\\mathbf{s}}) \\, \\mathrm{d}\\Omega \\right) \\, \\mathrm{d}\\Omega' $$\nThe inner integral is $\\int_{4\\pi} \\hat{\\mathbf{s}} \\Phi(\\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{s}}') \\, \\mathrm{d}\\Omega = 4\\pi g \\hat{\\mathbf{s}}'$, where $g$ is the asymmetry factor, defined as the average cosine of the scattering angle: $g = \\frac{1}{4\\pi} \\int_{4\\pi} (\\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{s}}') \\Phi(\\hat{\\mathbf{s}} \\cdot \\hat{\\mathbf{s}}') \\, \\mathrm{d}\\Omega$.\nSubstituting this result, the in-scattering term simplifies to:\n$$ \\frac{\\sigma_s}{4\\pi} \\int_{4\\pi} I' (4\\pi g \\hat{\\mathbf{s}}') \\, \\mathrm{d}\\Omega' = \\sigma_s g \\int_{4\\pi} \\hat{\\mathbf{s}}' I' \\, \\mathrm{d}\\Omega' = \\sigma_s g \\mathbf{F} $$\nCombining the terms on the RHS:\n$$ \\text{RHS} = -\\beta \\mathbf{F} + 0 + \\sigma_s g \\mathbf{F} = -(\\beta - \\sigma_s g) \\mathbf{F} = -(\\kappa + \\sigma_s - \\sigma_s g) \\mathbf{F} = -(\\kappa + \\sigma_s(1-g)) \\mathbf{F} $$\n\nEquating LHS and RHS:\n$$\n\\frac{1}{3}\\nabla G = -(\\kappa + \\sigma_s(1-g)) \\mathbf{F}\n$$\nSolving for $\\mathbf{F}$ yields the diffusion relation, which is a form of Fick's law for radiation:\n$$\n\\mathbf{F} = - \\frac{1}{3(\\kappa + \\sigma_s(1-g))} \\nabla G\n$$\nThis is of the form $\\mathbf{F} = -D \\nabla G$. The radiative diffusion coefficient $D$ is therefore:\n$$\nD = \\frac{1}{3(\\kappa + \\sigma_s(1-g))}\n$$\n\n**Part 2: Numerical Calculation and Validity Assessment**\n\nThe given parameters are:\n$\\kappa = 0.6~\\mathrm{m}^{-1}$\n$\\sigma_{s} = 25~\\mathrm{m}^{-1}$\n$g = 0.85$\n$L = 1.2~\\mathrm{m}$\n\nFirst, we compute the numerical value of the diffusion coefficient $D$:\n$$\nD = \\frac{1}{3(0.6~\\mathrm{m}^{-1} + 25~\\mathrm{m}^{-1}(1-0.85))}\n$$\n$$\nD = \\frac{1}{3(0.6 + 25(0.15))}~\\mathrm{m} = \\frac{1}{3(0.6 + 3.75)}~\\mathrm{m} = \\frac{1}{3(4.35)}~\\mathrm{m}\n$$\n$$\nD = \\frac{1}{13.05}~\\mathrm{m} \\approx 0.07662835...~\\mathrm{m}\n$$\nRounding to $4$ significant figures, the diffusion coefficient is $D = 0.07663~\\mathrm{m}$.\n\nNext, we assess the validity of the diffusion approximation. The P-1 approximation, and thus the diffusion model, is valid in optically thick media where the radiation field is nearly isotropic due to multiple scattering events. For anisotropic scattering, the relevant measure of optical thickness is the transport optical thickness, $\\tau_{tr}$. This is based on the transport extinction coefficient, $\\beta_{tr} = \\kappa + \\sigma_s(1-g)$, which accounts for the reduced effectiveness of forward-peaked scattering in randomizing photon direction. The transport mean free path is $l_{tr} = 1/\\beta_{tr}$.\n\nThe diffusion approximation is expected to be valid when the characteristic dimension of the medium, $L$, is much larger than the transport mean free path, i.e., $L \\gg l_{tr}$, or equivalently, $\\tau_{tr} \\gg 1$.\nThe transport optical thickness for the slab is:\n$$\n\\tau_{tr} = \\beta_{tr} L = (\\kappa + \\sigma_s(1-g)) L\n$$\nUsing the given values:\n$$\n\\beta_{tr} = 0.6~\\mathrm{m}^{-1} + 25~\\mathrm{m}^{-1}(1-0.85) = 4.35~\\mathrm{m}^{-1}\n$$\n$$\n\\tau_{tr} = (4.35~\\mathrm{m}^{-1})(1.2~\\mathrm{m}) = 5.22\n$$\nThe value $\\tau_{tr} = 5.22$ suggests that the medium is optically thick from a transport perspective. A common rule of thumb for the validity of the diffusion approximation is $\\tau_{tr} > 5$. Since our calculated value satisfies this condition, the diffusion approximation is expected to be reasonably valid for analyzing radiative transfer within this medium, although inaccuracies may arise near the boundaries where the intensity field is inherently more anisotropic. The physical reason is that the slab thickness is over $5$ times the average distance a photon must travel to have its direction of propagation effectively randomized, ensuring that the nearly isotropic condition required by the P-1 approximation is largely met throughout the bulk of the medium.",
            "answer": "$$\\boxed{0.07663}$$"
        },
        {
            "introduction": "Having derived the P-1 governing equation, we now turn to its behavior at the boundaries. This practice explores the P-1 model in a non-participating medium, a scenario allowing for a direct comparison against an exact analytical solution from classical heat transfer theory. By applying the appropriate Marshak boundary conditions and comparing the resulting heat flux to the one obtained from the view-factor method, you will gain critical insight into the performance and surprising accuracy of the P-1 approximation in this important limiting case.",
            "id": "3992999",
            "problem": "Consider two infinite, parallel, diffuse-grey walls separated by a vacuum gap of thickness $L$ (nonparticipating medium, with zero absorption and zero scattering). The walls have emissivities $\\epsilon_{1}$ and $\\epsilon_{2}$ and are maintained at uniform temperatures $T_{1}$ and $T_{2}$, respectively. The vacuum gap contains no participating species. The outward unit normal $\\mathbf{n}_{1}$ at wall $1$ points into the gap, and the outward unit normal $\\mathbf{n}_{2}$ at wall $2$ points into the gap but is oriented opposite to $\\mathbf{n}_{1}$.\n\nStarting from the Radiative Transfer Equation (RTE) and the definition of radiative intensity, use the first-order spherical harmonics (P-1) approximation to model the radiation field in the gap. Treat the walls as diffuse-grey surfaces and use the appropriate radiative boundary condition implied by diffuse emission and Lambertian reflection. In the gap, define the incident radiation $G$ and the radiative heat flux vector $\\mathbf{q}_{r}$, and denote by $\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1}$ the net radiative heat flux at wall $1$ directed into the gap.\n\nProceed to:\n\n- Derive, using the P-1 approximation and hemisphere-integrated boundary relations for a diffuse-grey wall, a closed-form expression for $\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1}$ in terms of $\\epsilon_{1}$, $\\epsilon_{2}$, $T_{1}$, $T_{2}$, and the Stefan–Boltzmann constant $\\sigma$.\n\n- Independently derive, using classical radiative exchange (view-factor) reasoning for two infinite parallel planes in a nonparticipating medium, the exact net radiative heat flux magnitude between the two walls.\n\n- Compute the dimensionless ratio $R$ of the P-1 predicted net radiative heat flux at wall $1$ to the exact view-factor result, $R = \\left(\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1}\\right)_{\\text{P-1}} \\big/ \\left(\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1}\\right)_{\\text{exact}}$, and provide $R$ as your final answer.\n\nUse the specific values $\\epsilon_{1} = 0.80$, $\\epsilon_{2} = 0.60$, $T_{1} = 1200\\,\\mathrm{K}$, $T_{2} = 400\\,\\mathrm{K}$. Express the final ratio $R$ as a dimensionless number. No rounding instruction is necessary if $R$ is exact.",
            "solution": "### Derivation of the Net Radiative Heat Flux\n\nA one-dimensional coordinate system is established with the $x$-axis normal to the walls. Wall $1$ is at $x=0$ and wall $2$ is at $x=L$. The outward unit normal for wall $1$ is $\\mathbf{n}_{1} = \\mathbf{i}$, and for wall $2$ is $\\mathbf{n}_{2} = -\\mathbf{i}$. The radiative heat flux vector is $\\mathbf{q}_{r} = q_{r,x}(x)\\mathbf{i}$.\n\n#### Part 1: P-1 Approximation Method\n\nThe Radiative Transfer Equation (RTE) for a non-emitting, non-scattering (nonparticipating) medium is:\n$$\n\\mathbf{\\Omega} \\cdot \\nabla I(\\mathbf{r}, \\mathbf{\\Omega}) = 0\n$$\nwhere $I$ is the radiative intensity and $\\mathbf{\\Omega}$ is the direction vector.\n\nThe first-order spherical harmonics (P-1) approximation for the intensity is:\n$$\nI(\\mathbf{r}, \\mathbf{\\Omega}) \\approx \\frac{1}{4\\pi} G(\\mathbf{r}) + \\frac{3}{4\\pi} \\mathbf{q}_{r}(\\mathbf{r}) \\cdot \\mathbf{\\Omega}\n$$\nwhere $G(\\mathbf{r}) = \\int_{4\\pi} I(\\mathbf{r}, \\mathbf{\\Omega}) d\\Omega$ is the incident radiation and $\\mathbf{q}_{r}(\\mathbf{r}) = \\int_{4\\pi} I(\\mathbf{r}, \\mathbf{\\Omega}) \\mathbf{\\Omega} d\\Omega$ is the radiative heat flux vector.\n\nThe zeroth moment of the RTE is $\\nabla \\cdot \\mathbf{q}_{r} = 0$. For our one-dimensional system, this simplifies to $\\frac{d q_{r,x}}{dx} = 0$, which implies that the radiative heat flux $q_{r,x}$ is constant throughout the gap.\n\nThe first moment of the RTE yields $\\nabla G = 0$ after applying the P-1 closure relation for a nonparticipating medium. In one dimension, this is $\\frac{dG}{dx} = 0$, meaning the incident radiation $G$ is also constant throughout the gap.\n\nWe apply the Marshak boundary condition, a hemisphere-integrated relation for diffuse-grey surfaces. For any such surface with normal $\\mathbf{n}_w$, the outgoing radiative flux (radiosity, $J_w$) equals the hemispherical integral of the P-1 intensity distribution over the outgoing directions:\n$$\nJ_w = \\int_{\\mathbf{\\Omega} \\cdot \\mathbf{n}_w > 0} (\\mathbf{\\Omega} \\cdot \\mathbf{n}_w) I(\\mathbf{r}_w, \\mathbf{\\Omega}) d\\Omega\n$$\nThe radiosity is also related to the wall's emissive power and the incident radiative flux $q_{r,i,w}$ by:\n$$\nJ_w = \\epsilon_w \\sigma T_w^4 + (1 - \\epsilon_w) q_{r,i,w}\n$$\n\nFor wall 1 at $x=0$ with $\\mathbf{n}_1 = \\mathbf{i}$:\nThe outgoing flux from the P-1 approximation is $J_1 = \\frac{G}{4} + \\frac{1}{2} q_{r,x}$.\nThe incident flux is $q_{r,i,1} = \\frac{G}{4} - \\frac{1}{2} q_{r,x}$.\nSubstituting these into the radiosity equation for wall $1$:\n$$\n\\frac{G}{4} + \\frac{1}{2} q_{r,x} = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1) \\left( \\frac{G}{4} - \\frac{1}{2} q_{r,x} \\right)\n$$\nSimplifying this equation yields a relation between $q_{r,x}$ and $G$:\n$$\nq_{r,x} \\left(1 - \\frac{\\epsilon_1}{2} \\right) = \\epsilon_1 \\left( \\sigma T_1^4 - \\frac{G}{4} \\right) \\implies q_{r,x} = \\frac{2\\epsilon_1}{2-\\epsilon_1} \\left( \\sigma T_1^4 - \\frac{G}{4} \\right)\n$$\n\nFor wall 2 at $x=L$ with $\\mathbf{n}_2 = -\\mathbf{i}$:\nThe outgoing flux (radiosity) from wall $2$ is $J_2 = \\frac{G}{4} - \\frac{1}{2} q_{r,x}$.\nThe incident flux onto wall $2$ is $q_{r,i,2} = \\frac{G}{4} + \\frac{1}{2} q_{r,x}$.\nSubstituting these into the radiosity equation for wall $2$:\n$$\n\\frac{G}{4} - \\frac{1}{2} q_{r,x} = \\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_2) \\left( \\frac{G}{4} + \\frac{1}{2} q_{r,x} \\right)\n$$\nSimplifying this equation gives a second relation between $q_{r,x}$ and $G$:\n$$\n-q_{r,x} \\left(1 - \\frac{\\epsilon_2}{2} \\right) = \\epsilon_2 \\left( \\sigma T_2^4 - \\frac{G}{4} \\right) \\implies -q_{r,x} = \\frac{2\\epsilon_2}{2-\\epsilon_2} \\left( \\sigma T_2^4 - \\frac{G}{4} \\right)\n$$\n\nWe now have a system of two linear equations for $q_{r,x}$ and $G$. We can eliminate $G$ by rearranging both equations to solve for $G/4$:\n$$\n\\text{From wall 1: } \\frac{G}{4} = \\sigma T_1^4 - q_{r,x} \\frac{2-\\epsilon_1}{2\\epsilon_1}\n$$\n$$\n\\text{From wall 2: } \\frac{G}{4} = \\sigma T_2^4 + q_{r,x} \\frac{2-\\epsilon_2}{2\\epsilon_2}\n$$\nEquating the expressions for $G/4$:\n$$\n\\sigma T_1^4 - q_{r,x} \\left( \\frac{1}{\\epsilon_1} - \\frac{1}{2} \\right) = \\sigma T_2^4 + q_{r,x} \\left( \\frac{1}{\\epsilon_2} - \\frac{1}{2} \\right)\n$$\nSolving for $q_{r,x}$:\n$$\n\\sigma(T_1^4 - T_2^4) = q_{r,x} \\left( \\frac{1}{\\epsilon_1} - \\frac{1}{2} + \\frac{1}{\\epsilon_2} - \\frac{1}{2} \\right) = q_{r,x} \\left( \\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1 \\right)\n$$\nThe net radiative heat flux component in the $x$-direction is:\n$$\nq_{r,x} = \\frac{\\sigma(T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1}\n$$\nThe quantity requested is $\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1} = (q_{r,x}\\mathbf{i})\\cdot(\\mathbf{i}) = q_{r,x}$. Therefore:\n$$\n(\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1})_{\\text{P-1}} = \\frac{\\sigma(T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1}\n$$\n\n#### Part 2: Exact View-Factor Method\n\nFor two infinite, parallel, diffuse-grey surfaces, the net radiative heat flux between them can be determined using the radiative network analogy. The system consists of two surface resistances and one space resistance in series between the blackbody emissive potentials.\nThe net heat flux per unit area from wall $1$ to wall $2$, $q''_{12}$, is:\n$$\nq''_{12} = \\frac{E_{b1} - E_{b2}}{R''_{\\text{total}}}\n$$\nwhere $E_{b1} = \\sigma T_1^4$ and $E_{b2} = \\sigma T_2^4$ are the blackbody emissive powers. The total resistance per unit area, $R''_{\\text{total}}$, is the sum of the individual resistances:\n- Surface resistance of wall 1: $R''_{s,1} = \\frac{1-\\epsilon_1}{\\epsilon_1}$\n- Space resistance between wall 1 and wall 2: $R''_{\\text{space}} = \\frac{1}{F_{12}}$, where the view factor $F_{12}$ for infinite parallel plates is $1$.\n- Surface resistance of wall 2: $R''_{s,2} = \\frac{1-\\epsilon_2}{\\epsilon_2}$\n\nThe total resistance per unit area is:\n$$\nR''_{\\text{total}} = R''_{s,1} + R''_{\\text{space}} + R''_{s,2} = \\frac{1-\\epsilon_1}{\\epsilon_1} + \\frac{1}{1} + \\frac{1-\\epsilon_2}{\\epsilon_2} = \\frac{1}{\\epsilon_1} - 1 + 1 + \\frac{1}{\\epsilon_2} - 1 = \\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1\n$$\nThe exact net radiative heat flux from wall $1$, $(\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1})_{\\text{exact}}$, is equal to $q''_{12}$:\n$$\n(\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1})_{\\text{exact}} = \\frac{\\sigma(T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1}\n$$\n\n#### Part 3: Ratio Calculation\n\nThe dimensionless ratio $R$ is defined as the P-1 prediction divided by the exact result.\n$$\nR = \\frac{\\left(\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1}\\right)_{\\text{P-1}}}{\\left(\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1}\\right)_{\\text{exact}}}\n$$\nUpon comparing the derived expressions, we observe that they are identical:\n$$\n(\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1})_{\\text{P-1}} = \\frac{\\sigma(T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} = (\\mathbf{q}_{r}\\cdot\\mathbf{n}_{1})_{\\text{exact}}\n$$\nThis is a known result in radiative transfer theory: for the specific case of one-dimensional radiative exchange between two infinite parallel plates in a nonparticipating medium, the P-1 approximation with Marshak boundary conditions yields the exact net heat flux. This occurs because the errors introduced by the linear approximation of the inherently discontinuous intensity field fortuitously cancel during the integration process for the net flux.\n\nTherefore, the ratio $R$ is:\n$$\nR = \\frac{\\frac{\\sigma(T_1^4 - T_2^4)}{1/\\epsilon_1 + 1/\\epsilon_2 - 1}}{\\frac{\\sigma(T_1^4 - T_2^4)}{1/\\epsilon_1 + 1/\\epsilon_2 - 1}} = 1\n$$\nThe specific numerical values for $\\epsilon_1$, $\\epsilon_2$, $T_1$, and $T_2$ are not required to determine the ratio, which is exactly $1$.",
            "answer": "$$ \\boxed{1} $$"
        },
        {
            "introduction": "Our final practice bridges the gap between theory and computational practice, where the P-1 approximation is most frequently applied. Using the Method of Manufactured Solutions—a powerful code verification technique—you will implement a numerical solver to quantify the impact of anisotropic scattering on the model's accuracy. This exercise will demonstrate firsthand the critical importance of using the modified P-1 formulation with a transport-corrected diffusion coefficient to obtain physically meaningful results in realistic engineering simulations.",
            "id": "3992996",
            "problem": "Consider one-dimensional radiative heat transfer in a homogeneous, absorbing and scattering slab of thickness $L$ in meters with spatial coordinate $x \\in [0,L]$. The angularly dependent Radiative Transfer Equation (RTE) can be reduced, via the first-order spherical harmonics approximation (P-1 approximation), to a diffusion-type equation for the scalar flux (also called the incident radiation) $\\phi(x)$, with appropriate boundary conditions. In media with anisotropic scattering characterized by the first Legendre moment $g$ of the scattering phase function (for example, the Henyey–Greenstein phase function), the Modified P-1 model incorporates the transport cross-section $\\sigma_{\\mathrm{tr}} = \\sigma_a + (1-g)\\sigma_s$ to account for anisotropy, whereas the Standard P-1 model uses $\\sigma_t = \\sigma_a + \\sigma_s$ as if scattering were isotropic. Here $\\sigma_a$ (in $\\mathrm{m}^{-1}$) is the absorption coefficient and $\\sigma_s$ (in $\\mathrm{m}^{-1}$) is the scattering coefficient. The diffusion coefficient $D$ and the reaction (absorption) term in the resulting diffusion equation differ between the Standard and Modified models only through $D$.\n\nStarting from the angle-integrated moment equations of the RTE under the P-1 approximation and using the constitutive relation for the radiative flux $\\mathbf{J} = -D \\nabla \\phi$, the governing one-dimensional steady-state equation for $\\phi(x)$ is\n$$\n- \\frac{d}{dx}\\left( D \\frac{d \\phi}{dx} \\right) + \\sigma_a \\, \\phi = S(x),\n$$\nwhere $S(x)$ is a known volumetric source term in $\\mathrm{W\\,m^{-3}}$ that aggregates in-medium emission and any manufactured forcing used to benchmark accuracy. The boundary conditions at the slab boundaries are Marshak-type vacuum conditions expressed as radiative partial-current boundary conditions,\n$$\n\\phi(0) + 2 D \\left.\\frac{\\partial \\phi}{\\partial n}\\right|_{x=0} = 4 J_{\\mathrm{inc},0}, \\qquad\n\\phi(L) + 2 D \\left.\\frac{\\partial \\phi}{\\partial n}\\right|_{x=L} = 4 J_{\\mathrm{inc},L},\n$$\nwhere $\\partial/\\partial n$ is the derivative in the outward normal direction and $J_{\\mathrm{inc},0}$, $J_{\\mathrm{inc},L}$ are prescribed incident boundary partial currents in $\\mathrm{W\\,m^{-2}}$. The outward normal derivative at $x=0$ is $\\partial/\\partial n = - d/dx$ and at $x=L$ is $\\partial/\\partial n = + d/dx$.\n\nIn the Standard P-1 model, the diffusion coefficient is\n$$\nD_{\\mathrm{std}} = \\frac{1}{3(\\sigma_a + \\sigma_s)},\n$$\nwhile in the Modified P-1 model (accounting for anisotropy),\n$$\nD_{\\mathrm{mod}} = \\frac{1}{3(\\sigma_a + (1-g)\\sigma_s)}.\n$$\n\nTo enable quantitative accuracy assessment, adopt a manufactured exact solution that is smooth and nonnegative:\n$$\n\\phi_{\\mathrm{true}}(x) = 1 + \\cos\\left(\\frac{\\pi x}{L}\\right) + \\frac{1}{2}\\cos\\left(\\frac{2\\pi x}{L}\\right).\n$$\nUsing the Modified P-1 model as the physically consistent baseline, construct the source term $S(x)$ and the boundary incident partial currents $J_{\\mathrm{inc},0}$, $J_{\\mathrm{inc},L}$ so that $\\phi_{\\mathrm{true}}(x)$ exactly satisfies the Modified P-1 diffusion equation and Marshak boundary conditions. Specifically, define\n$$\nS(x) = - D_{\\mathrm{mod}} \\frac{d^2 \\phi_{\\mathrm{true}}}{dx^2} + \\sigma_a \\, \\phi_{\\mathrm{true}}(x),\n$$\n$$\nJ_{\\mathrm{inc},0} = \\frac{1}{4}\\left[\\phi_{\\mathrm{true}}(0) + 2 D_{\\mathrm{mod}} \\left.\\frac{\\partial \\phi_{\\mathrm{true}}}{\\partial n}\\right|_{x=0}\\right], \\qquad\nJ_{\\mathrm{inc},L} = \\frac{1}{4}\\left[\\phi_{\\mathrm{true}}(L) + 2 D_{\\mathrm{mod}} \\left.\\frac{\\partial \\phi_{\\mathrm{true}}}{\\partial n}\\right|_{x=L}\\right].\n$$\nNote that for the chosen $\\phi_{\\mathrm{true}}(x)$, the exact outward normal derivatives at both boundaries are zero, which simplifies the boundary data to $J_{\\mathrm{inc},0} = \\phi_{\\mathrm{true}}(0)/4$ and $J_{\\mathrm{inc},L} = \\phi_{\\mathrm{true}}(L)/4$.\n\nDiscretize the domain into $N$ uniformly spaced nodes with spacing $\\Delta x = L/(N-1)$, and approximate the interior operator with second-order central differences:\n$$\n- D \\frac{d^2 \\phi}{dx^2} \\approx - D \\frac{\\phi_{i-1} - 2 \\phi_i + \\phi_{i+1}}{\\Delta x^2}, \\quad \\text{for } i = 1,\\dots,N-2,\n$$\nwith the reaction term $\\sigma_a \\phi_i$ and source term $S_i = S(x_i)$. Impose second-order accurate one-sided Marshak boundary conditions at $x=0$ and $x=L$ using the outward normal derivative approximations\n$$\n\\left.\\frac{\\partial \\phi}{\\partial n}\\right|_{x=0} \\approx \\frac{3\\phi_0 - 4\\phi_1 + \\phi_2}{2\\Delta x}, \\qquad\n\\left.\\frac{\\partial \\phi}{\\partial n}\\right|_{x=L} \\approx \\frac{3\\phi_{N-1} - 4\\phi_{N-2} + \\phi_{N-3}}{2\\Delta x}.\n$$\n\nYour task is to implement two solvers that assemble and solve the linear system for the Standard P-1 and Modified P-1 models, respectively, using the same physically consistent source $S(x)$ and boundary incident currents $J_{\\mathrm{inc},0}$ and $J_{\\mathrm{inc},L}$ constructed from $\\phi_{\\mathrm{true}}(x)$ and $D_{\\mathrm{mod}}$. Then, compare:\n- Accuracy: compute the discrete $L^2$ relative error of each numerical solution $\\phi_{\\mathrm{num}}$ against $\\phi_{\\mathrm{true}}(x)$,\n$$\nE = \\frac{\\left(\\sum_{i=0}^{N-1} [\\phi_{\\mathrm{num}}(x_i) - \\phi_{\\mathrm{true}}(x_i)]^2 \\, \\Delta x\\right)^{1/2}}{\\left(\\sum_{i=0}^{N-1} [\\phi_{\\mathrm{true}}(x_i)]^2 \\, \\Delta x\\right)^{1/2}},\n$$\nwhich is unitless.\n- Numerical performance proxy: compute the $2$-norm condition number of the discrete operator matrix for each model, which is unitless.\n\nExpress all material coefficients in $\\mathrm{m}^{-1}$ and the slab thickness in meters. The errors and condition numbers are unitless floats.\n\nImplement the program to produce results for the following test suite, chosen to probe different regimes, including isotropic scattering, forward-peaked anisotropy, backward-peaked anisotropy, and varying absorption:\n\n- Test 1 (baseline isotropic scattering): $L = 1.0$ m, $N = 64$, $\\sigma_a = 0.1$ $\\mathrm{m}^{-1}$, $\\sigma_s = 1.0$ $\\mathrm{m}^{-1}$, $g = 0.0$.\n- Test 2 (moderate forward anisotropy): $L = 1.0$ m, $N = 64$, $\\sigma_a = 0.1$ $\\mathrm{m}^{-1}$, $\\sigma_s = 1.0$ $\\mathrm{m}^{-1}$, $g = 0.7$.\n- Test 3 (strong forward anisotropy with higher scattering): $L = 0.5$ m, $N = 48$, $\\sigma_a = 0.05$ $\\mathrm{m}^{-1}$, $\\sigma_s = 2.0$ $\\mathrm{m}^{-1}$, $g = 0.95$.\n- Test 4 (backward anisotropy with higher absorption): $L = 1.0$ m, $N = 32$, $\\sigma_a = 1.0$ $\\mathrm{m}^{-1}$, $\\sigma_s = 0.5$ $\\mathrm{m}^{-1}$, $g = -0.3$.\n\nYour program should produce a single line of output containing, for each test in order, a list with four unitless floats: the relative $L^2$ error for the Standard P-1 solver, the relative $L^2$ error for the Modified P-1 solver, the condition number of the Standard P-1 system matrix, and the condition number of the Modified P-1 system matrix. Aggregate the results for all tests into a single comma-separated list of lists enclosed in square brackets, for example, \n$$\n[\\,[E_{\\mathrm{std},1}, E_{\\mathrm{mod},1}, \\kappa_{\\mathrm{std},1}, \\kappa_{\\mathrm{mod},1}], [E_{\\mathrm{std},2}, E_{\\mathrm{mod},2}, \\kappa_{\\mathrm{std},2}, \\kappa_{\\mathrm{mod},2}], \\dots ].\n$$",
            "solution": "This problem requires solving a one-dimensional diffusion-reaction equation that arises from the P-1 approximation of the Radiative Transfer Equation (RTE). We will compare the accuracy and matrix conditioning of two variants: the Standard P-1 model (which assumes isotropic scattering) and the Modified P-1 model (which correctly accounts for anisotropic scattering).\n\nThe governing steady-state equation for the scalar flux $\\phi(x)$ on the domain $x \\in [0, L]$ is:\n$$\n- \\frac{d}{dx}\\left( D \\frac{d \\phi}{dx} \\right) + \\sigma_a \\, \\phi = S(x)\n$$\nThe models differ in their definition of the diffusion coefficient $D$:\n1.  **Standard P-1 Model**: $D_{\\mathrm{std}} = 1 / (3(\\sigma_a + \\sigma_s))$\n2.  **Modified P-1 Model**: $D_{\\mathrm{mod}} = 1 / (3(\\sigma_a + (1-g)\\sigma_s))$\n\nThe Method of Manufactured Solutions is used for verification. A true solution $\\phi_{\\mathrm{true}}(x)$ is defined, and the source term $S(x)$ and boundary data are derived from it using the physically correct Modified P-1 model. Both models are then solved using this same source term and boundary data. The error is the difference between the numerical solution of each model and the manufactured true solution. We expect the Modified P-1 model's error to be small (due only to numerical discretization), while the Standard P-1 model's error will be large when $g \\neq 0$ because it uses an physically inconsistent diffusion coefficient for the problem.\n\nThe implementation requires discretizing the governing equation using finite differences to form a linear system $\\mathbf{A}\\boldsymbol{\\phi} = \\mathbf{b}$, which is then solved for the numerical solution $\\boldsymbol{\\phi}_{\\mathrm{num}}$. The accuracy is measured by the $L^2$ relative error, and the matrix stability is assessed by its condition number.\n\nThe implementation of the numerical solution in Python is as follows:\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main solver function that runs all test cases and prints the results.\n    \"\"\"\n\n    test_cases = [\n        # Test 1 (baseline isotropic scattering)\n        {'L': 1.0, 'N': 64, 'sigma_a': 0.1, 'sigma_s': 1.0, 'g': 0.0},\n        # Test 2 (moderate forward anisotropy)\n        {'L': 1.0, 'N': 64, 'sigma_a': 0.1, 'sigma_s': 1.0, 'g': 0.7},\n        # Test 3 (strong forward anisotropy with higher scattering)\n        {'L': 0.5, 'N': 48, 'sigma_a': 0.05, 'sigma_s': 2.0, 'g': 0.95},\n        # Test 4 (backward anisotropy with higher absorption)\n        {'L': 1.0, 'N': 32, 'sigma_a': 1.0, 'sigma_s': 0.5, 'g': -0.3},\n    ]\n\n    def run_case(params):\n        \"\"\"\n        Solves the P-1 equation for a single set of parameters for both\n        Standard and Modified models.\n        \"\"\"\n        L = params['L']\n        N = params['N']\n        sigma_a = params['sigma_a']\n        sigma_s = params['sigma_s']\n        g = params['g']\n\n        dx = L / (N - 1)\n        x = np.linspace(0, L, N)\n\n        # --- Manufactured Solution and Source Terms ---\n        # NOTE: Source terms are always manufactured from the Modified P-1 model.\n        D_mod = 1.0 / (3.0 * (sigma_a + (1.0 - g) * sigma_s))\n\n        # Manufactured true solution and its derivatives\n        phi_true_func = lambda x_val: 1.0 + np.cos(np.pi * x_val / L) + 0.5 * np.cos(2 * np.pi * x_val / L)\n        phi_true_ddx2_func = lambda x_val: \\\n            -(np.pi/L)**2 * np.cos(np.pi * x_val / L) - 2 * (np.pi/L)**2 * np.cos(2 * np.pi * x_val / L)\n        \n        phi_true_vec = phi_true_func(x)\n        \n        # Manufactured source term S(x)\n        S_vec = -D_mod * phi_true_ddx2_func(x) + sigma_a * phi_true_vec\n\n        # Manufactured boundary incident currents (constant due to zero gradient of phi_true at boundaries)\n        J_inc_0 = 0.625\n        J_inc_L = 0.125\n        \n        # --- Function to solve for a specific model (std or mod) ---\n        def solve_model(model_type):\n            if model_type == 'std':\n                D = 1.0 / (3.0 * (sigma_a + sigma_s))\n            elif model_type == 'mod':\n                D = D_mod\n            else:\n                raise ValueError(\"Unknown model type\")\n\n            # Assemble matrix A and vector b\n            A = np.zeros((N, N))\n            b = np.zeros(N)\n\n            # Interior nodes (i = 1 to N-2)\n            c1 = -D / (dx**2)\n            c2 = 2.0 * D / (dx**2) + sigma_a\n            for i in range(1, N - 1):\n                A[i, i - 1] = c1\n                A[i, i] = c2\n                A[i, i + 1] = c1\n                b[i] = S_vec[i]\n                \n            # Boundary node at x=0 (i=0)\n            A[0, 0] = 1.0 + 3.0 * D / dx\n            A[0, 1] = -4.0 * D / dx\n            A[0, 2] = D / dx\n            b[0] = 4.0 * J_inc_0\n\n            # Boundary node at x=L (i=N-1)\n            A[N - 1, N - 3] = D / dx\n            A[N - 1, N - 2] = -4.0 * D / dx\n            A[N - 1, N - 1] = 1.0 + 3.0 * D / dx\n            b[N - 1] = 4.0 * J_inc_L\n\n            # Solve the linear system\n            phi_num = np.linalg.solve(A, b)\n\n            # Calculate condition number\n            cond_num = np.linalg.cond(A, 2)\n\n            # Calculate L2 relative error\n            err_norm_sq = np.sum((phi_num - phi_true_vec)**2 * dx)\n            true_norm_sq = np.sum(phi_true_vec**2 * dx)\n            \n            # Handle potential division by zero if true norm is zero (unlikely here)\n            if true_norm_sq == 0:\n                 rel_err = np.sqrt(err_norm_sq) if err_norm_sq > 0 else 0.0\n            else:\n                rel_err = np.sqrt(err_norm_sq / true_norm_sq)\n\n            return rel_err, cond_num\n\n        E_std, kappa_std = solve_model('std')\n        E_mod, kappa_mod = solve_model('mod')\n\n        return [E_std, E_mod, kappa_std, kappa_mod]\n\n    results = []\n    for case_params in test_cases:\n        case_results = run_case(case_params)\n        results.append(case_results)\n\n    # Format the final output string\n    print(f\"{results}\")\n\nsolve()\n```",
            "answer": "[[2.909945398687702e-05, 2.909945398687702e-05, 439.429986348464, 439.429986348464], [0.4497645166416972, 2.766113206497217e-05, 439.429986348464, 1152.091173663711], [0.7712398939798089, 7.39162986280327e-05, 2378.113063854181, 32560.01639017684], [0.03859738012117551, 0.00010904097457319586, 172.0728348937669, 156.49129402518602]]"
        }
    ]
}