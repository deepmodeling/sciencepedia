{
    "hands_on_practices": [
        {
            "introduction": "在分子动力学模拟中，积分时间步长 $\\Delta t$ 的选择至关重要，它直接影响计算效率和数值稳定性。过大的时间步长会导致积分发散，而过小则会耗费不必要的计算资源。本练习旨在通过对系统中最高频振动模式（如水分子的O-H键伸缩）进行线性稳定性分析，指导您如何确定一个既能保证模拟稳定又能兼顾效率的可行时间步长，并理解施加刚性键约束为何能显著提升计算效率 。",
            "id": "3973865",
            "problem": "您正在使用速度-Verlet积分方案，对一个显式全原子模型下的液态水在 $T=300\\,\\mathrm{K}$ 时进行经典分子动力学 (MD) 模拟。最硬的分子内振动模式是 O–H 伸缩振动，它可以很好地近似为一个角频率为 $\\omega_{\\mathrm{s}} \\approx 3.0\\times 10^{14}\\,\\mathrm{s}^{-1}$ 的一维谐振子。在没有刚性约束的情况下，这是最快的模式。当施加刚性约束来冻结 O–H 键长时，剩余的最高频率分子内振动模式是 H–O–H 弯曲模式，您可以将其建模为一个角频率为 $\\omega_{\\mathrm{b}} \\approx 1.6\\times 10^{14}\\,\\mathrm{s}^{-1}$ 的谐振子。\n\n仅从牛顿第二定律和谐振子方程 $m\\,d^{2}x/dt^{2} + m\\,\\omega^{2}\\,x = 0$ 出发，并使用速度-Verlet离散化的位置更新形式，完成以下任务：\n\n1. 对谐振子得到的离散更新方程进行线性稳定性分析，以确定时间步长 $\\Delta t$ 需要满足的关于 $\\omega$ 的条件，从而确保积分的线性稳定性。\n\n2. 施加一个分辨率要求，即最快的振动周期 $T = 2\\pi/\\omega$ 必须被至少 $N=20$ 个时间步长采样。将“可行”时间步长定义为 $\\Delta t_{\\mathrm{feas}} = \\min\\{\\Delta t_{\\mathrm{stab}},\\,T/N\\}$，其中 $\\Delta t_{\\mathrm{stab}}$ 是在第1部分中获得的由稳定性限制的时间步长。\n\n3. 分别使用 $\\omega=\\omega_{\\mathrm{s}}$ （对于无约束的水）和 $\\omega=\\omega_{\\mathrm{b}}$ （对于有约束的水）计算可行时间步长 $\\Delta t_{\\mathrm{feas}}$。然后计算约束使可行时间步长增加的倍数因子，定义为 $R=\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{b}})/\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{s}})$。\n\n将两个可行时间步长以飞秒 (fs) 为单位表示，并将比率 $R$ 表示为无量纲数。将您的三个最终结果四舍五入到三位有效数字。",
            "solution": "我们基于牛顿第二定律和谐振子模型进行分析。谐振子满足\n$$\nm\\,\\frac{d^{2}x}{dt^{2}} + m\\,\\omega^{2}\\,x = 0,\n$$\n其角频率为 $\\omega$，周期为 $T=2\\pi/\\omega$。\n\n对于速度-Verlet方法，一维谐振子的仅含位置的更新可以写成 Störmer–Verlet 形式\n$$\nx_{n+1} = 2x_{n} - x_{n-1} - (\\omega \\Delta t)^{2} x_{n},\n$$\n其中 $x_{n}$ 表示在时间 $t_{n}=n\\,\\Delta t$ 时的位置。这个线性齐次递推关系允许形如 $x_{n}=\\lambda^{n}$ 的解，从而得到特征方程\n$$\n\\lambda^{2} - 2\\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right)\\lambda + 1 = 0.\n$$\n两个根是\n$$\n\\lambda_{\\pm} = \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right) \\pm i \\sqrt{1 - \\left(1 - \\frac{(\\omega \\Delta t)^{2}}{2}\\right)^{2}}.\n$$\n离散映射的线性稳定性要求放大因子满足 $|\\lambda_{\\pm}|=1$ （无指数增长）。上述根位于单位圆上，当且仅当平方根下的判别式为非负，并且实部有界，使得模保持为1。对于这个递推关系的一个标准结果是，只要满足以下条件，其根就是单位圆上的一对复共轭数\n$$\n0 \\le (\\omega \\Delta t)^{2} \\le 4,\n$$\n也就是说，\n$$\n0 \\le \\omega \\Delta t \\le 2.\n$$\n因此，对谐振子进行速度-Verlet积分的线性稳定性条件是\n$$\n\\Delta t_{\\mathrm{stab}} \\le \\frac{2}{\\omega}.\n$$\n\n精度通常要求比稳定性本身所要求的时间分辨率更高。我们要求最快的周期至少被 $N=20$ 个时间步长采样，这得出了一个由分辨率限制的时间步长\n$$\n\\Delta t_{\\mathrm{res}} = \\frac{T}{N} = \\frac{2\\pi}{\\omega\\,N}.\n$$\n我们将可行时间步长定义为\n$$\n\\Delta t_{\\mathrm{feas}} = \\min\\!\\left\\{\\frac{2}{\\omega},\\,\\frac{2\\pi}{\\omega\\,N}\\right\\}.\n$$\n当 $N=20$ 时，我们比较这两个界限：\n$$\n\\frac{2}{\\omega} \\quad \\text{versus} \\quad \\frac{2\\pi}{20\\,\\omega} = \\frac{\\pi}{10\\,\\omega}.\n$$\n由于 $\\frac{2}{\\omega} = \\frac{T}{\\pi}$ 且 $\\frac{\\pi}{10\\,\\omega} = \\frac{T}{20}$，并且 $\\frac{T}{20}  \\frac{T}{\\pi}$，因此分辨率准则更严格。所以，\n$$\n\\Delta t_{\\mathrm{feas}} = \\frac{2\\pi}{\\omega\\,N} \\quad \\text{with} \\quad N=20.\n$$\n\n我们现在计算这两种情况下的可行时间步长。\n\n无约束的水（最快的模式是O–H伸缩振动，其角频率为 $\\omega_{\\mathrm{s}}=3.0\\times 10^{14}\\,\\mathrm{s}^{-1}$）：\n$$\n\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{s}}) = \\frac{2\\pi}{\\omega_{\\mathrm{s}}\\,N} = \\frac{2\\pi}{(3.0\\times 10^{14}\\,\\mathrm{s}^{-1})\\times 20}.\n$$\n数值上，\n$$\n\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{s}}) = \\frac{2\\pi}{6.0\\times 10^{15}\\,\\mathrm{s}^{-1}} = \\left(\\frac{2\\pi}{6.0}\\right)\\times 10^{-15}\\,\\mathrm{s}.\n$$\n使用 $2\\pi \\approx 6.283185307$，我们得到\n$$\n\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{s}}) \\approx 1.047197551\\times 10^{-15}\\,\\mathrm{s} = 1.047197551\\,\\mathrm{fs}.\n$$\n四舍五入到三位有效数字：$1.05\\,\\mathrm{fs}$。\n\n有约束的水（最快的模式是H–O–H弯曲振动，其角频率为 $\\omega_{\\mathrm{b}}=1.6\\times 10^{14}\\,\\mathrm{s}^{-1}$）：\n$$\n\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{b}}) = \\frac{2\\pi}{\\omega_{\\mathrm{b}}\\,N} = \\frac{2\\pi}{(1.6\\times 10^{14}\\,\\mathrm{s}^{-1})\\times 20} = \\frac{2\\pi}{3.2\\times 10^{15}\\,\\mathrm{s}^{-1}}.\n$$\n因此，\n$$\n\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{b}}) = \\left(\\frac{2\\pi}{3.2}\\right)\\times 10^{-15}\\,\\mathrm{s} \\approx 1.963495408\\times 10^{-15}\\,\\mathrm{s} = 1.963495408\\,\\mathrm{fs}.\n$$\n四舍五入到三位有效数字：$1.96\\,\\mathrm{fs}$。\n\n约束使可行时间步长增加的倍数因子是\n$$\nR = \\frac{\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{b}})}{\\Delta t_{\\mathrm{feas}}(\\omega_{\\mathrm{s}})} = \\frac{\\frac{2\\pi}{\\omega_{\\mathrm{b}}\\,N}}{\\frac{2\\pi}{\\omega_{\\mathrm{s}}\\,N}} = \\frac{\\omega_{\\mathrm{s}}}{\\omega_{\\mathrm{b}}} = \\frac{3.0\\times 10^{14}}{1.6\\times 10^{14}} = 1.875.\n$$\n四舍五入到三位有效数字：$1.88$。\n\n因此，以飞秒表示的可行时间步长，在无约束时约为 $1.05\\,\\mathrm{fs}$，在有O–H键约束时约为 $1.96\\,\\mathrm{fs}$，而约束带来的增加因子为 $1.88$。",
            "answer": "$$\\boxed{\\begin{pmatrix}1.05  1.96  1.88\\end{pmatrix}}$$"
        },
        {
            "introduction": "为了提高计算效率，分子动力学模拟通常会对粒子间的相互作用势在某一截断半径 $r_c$ 处进行截断。然而，这种截断会引入系统性误差，影响势能和压力等热力学性质的准确性。本练习将引导您从统计力学第一性原理出发，推导并应用“长程校正”（或称“尾部校正”），以解析地补偿由于截断Lennard-Jones势而忽略的长程相互作用，这是确保模拟结果准确性的关键一步 。",
            "id": "3973849",
            "problem": "考虑一个均匀、各向同性的流体，通过分子动力学 (MD) 进行模拟，使用在有限截断距离 $r_c$ 处截断且没有任何移位的成对Lennard–Jones (LJ) 势。对势为 $u(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right]$，其中 $\\varepsilon$ 和 $\\sigma$ 分别是特征能量和长度参数。数密度为 $\\rho$，径向分布函数 (RDF) 为 $g(r)$，温度为 $T$。玻尔兹曼常数（记为 $k_B$）仅通过理想气体项出现，在下文的尾部修正推导中无需使用。\n\n请您推导解析尾部修正，以估计由于在 $r_c$ 处截断势而对每个粒子的势能和压力造成的缺失贡献。假设对于 $r \\ge r_c$，结构是不相关的，即 $g(r) = 1$，并且流体足够均匀以支持使用标准连续积分。从统计力学中均匀流体的构型能量和维里压力的第一性原理表达式出发，获得尾部修正 $\\Delta U/N$ 和 $\\Delta P$ 作为 $\\varepsilon$、$\\sigma$、$\\rho$ 和 $r_c$ 的函数的闭式表达式。\n\n在符号推导这些表达式后，在Lennard-Jones约化单位下对它们进行数值计算，其定义为 $r^\\ast = r/\\sigma$，$\\rho^\\ast = \\rho \\sigma^3$，能量以 $\\varepsilon$ 为单位，压力以 $\\varepsilon/\\sigma^3$ 为单位。使用 $\\rho^\\ast = 0.85$ 和 $r_c^\\ast = 2.5$。将每个粒子的能量修正以 $\\varepsilon$ 为单位表示，压力修正以 $\\varepsilon/\\sigma^3$ 为单位表示。将您的数值答案四舍五入到四位有效数字。按顺序报告您的最终结果：$\\Delta U/N$（单位为 $\\varepsilon$），然后是 $\\Delta P$（单位为 $\\varepsilon/\\sigma^3$）。",
            "solution": "该问题要求为Lennard-Jones (LJ) 流体推导每个粒子的势能和压力的解析尾部修正，其中势在有限截断距离 $r_c$ 处被截断。该推导基于以下假设：对于距离 $r \\ge r_c$，径向分布函数 $g(r)$ 为1。\n\n首先，我们建立统计力学的基本表达式。\n对于一个包含 $N$ 个粒子、数密度为 $\\rho = N/V$ 的系统，其构型势能 $U$ 由下式给出：\n$$ U = 2 \\pi N \\rho \\int_0^\\infty u(r) g(r) r^2 dr $$\n压力 $P$ 由维里定理给出：\n$$ P = \\rho k_B T - \\frac{2 \\pi \\rho^2}{3} \\int_0^\\infty r \\frac{du(r)}{dr} g(r) r^2 dr $$\n其中积分项表示来自粒子间相互作用力的贡献。\n\n尾部修正 $\\Delta U$ 和 $\\Delta P$ 表示来自截断距离以外区域（即 $r \\in [r_c, \\infty)$）对这些积分的贡献。\n\n**势能尾部修正 ($\\Delta U/N$) 的推导**\n\n势能修正 $\\Delta U$ 是在截断距离之外的区域对相互作用能的积分。\n$$ \\Delta U = 2 \\pi N \\rho \\int_{r_c}^\\infty u(r) g(r) r^2 dr $$\n我们已知Lennard-Jones势为：\n$$ u(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right] $$\n并且我们假设对于 $r \\ge r_c$，流体在结构上是不相关的，即 $g(r) = 1$。将这些代入 $\\Delta U$ 的表达式中：\n$$ \\Delta U = 2 \\pi N \\rho \\int_{r_c}^\\infty 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^6 \\right] r^2 dr $$\n将常数项提取出来：\n$$ \\Delta U = 8 \\pi N \\rho \\varepsilon \\int_{r_c}^\\infty \\left( \\sigma^{12} r^{-12} - \\sigma^6 r^{-6} \\right) r^2 dr $$\n$$ \\Delta U = 8 \\pi N \\rho \\varepsilon \\int_{r_c}^\\infty \\left( \\sigma^{12} r^{-10} - \\sigma^6 r^{-4} \\right) dr $$\n进行积分：\n$$ \\int \\left( \\sigma^{12} r^{-10} - \\sigma^6 r^{-4} \\right) dr = \\sigma^{12} \\frac{r^{-9}}{-9} - \\sigma^6 \\frac{r^{-3}}{-3} = -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} $$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$ \\left[ -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^\\infty = \\lim_{r \\to \\infty} \\left( -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right) - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) $$\n$$ = (0 - 0) - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) = \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} $$\n将此结果代回 $\\Delta U$ 的表达式中：\n$$ \\Delta U = 8 \\pi N \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right) $$\n题目要求的是每个粒子的修正量 $\\Delta U/N$：\n$$ \\frac{\\Delta U}{N} = 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right) = \\frac{8 \\pi \\rho \\varepsilon \\sigma^3}{3} \\left[ \\frac{1}{3} \\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right] $$\n\n**压力尾部修正 ($\\Delta P$) 的推导**\n\n压力修正 $\\Delta P$ 从压力表达式的维里部分在区域 $r \\ge r_c$ 上的贡献推导而来：\n$$ \\Delta P = - \\frac{2 \\pi \\rho^2}{3} \\int_{r_c}^\\infty r \\frac{du(r)}{dr} g(r) r^2 dr $$\n同样，我们假设 $g(r) = 1$。首先，我们计算LJ势的导数 $du/dr$：\n$$ \\frac{du}{dr} = 4 \\varepsilon \\left( -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^6}{r^7} \\right) $$\n将此代入 $\\Delta P$ 的积分式中：\n$$ \\Delta P = - \\frac{2 \\pi \\rho^2}{3} \\int_{r_c}^\\infty r^3 \\left[ 4 \\varepsilon \\left( -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^6}{r^7} \\right) \\right] dr $$\n$$ \\Delta P = - \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\int_{r_c}^\\infty \\left( -12 \\sigma^{12} r^{-10} + 6 \\sigma^6 r^{-4} \\right) dr $$\n$$ \\Delta P = \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\int_{r_c}^\\infty \\left( 12 \\sigma^{12} r^{-10} - 6 \\sigma^6 r^{-4} \\right) dr $$\n进行积分：\n$$ \\int \\left( 12 \\sigma^{12} r^{-10} - 6 \\sigma^6 r^{-4} \\right) dr = 12 \\sigma^{12} \\frac{r^{-9}}{-9} - 6 \\sigma^6 \\frac{r^{-3}}{-3} = -\\frac{4}{3} \\sigma^{12} r^{-9} + 2 \\sigma^6 r^{-3} $$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$ \\left[ -\\frac{4}{3} \\frac{\\sigma^{12}}{r^9} + 2 \\frac{\\sigma^6}{r^3} \\right]_{r_c}^\\infty = (0 - 0) - \\left( -\\frac{4}{3} \\frac{\\sigma^{12}}{r_c^9} + 2 \\frac{\\sigma^6}{r_c^3} \\right) = \\frac{4}{3} \\frac{\\sigma^{12}}{r_c^9} - 2 \\frac{\\sigma^6}{r_c^3} $$\n将此结果代回 $\\Delta P$ 的表达式中：\n$$ \\Delta P = \\frac{8 \\pi \\rho^2 \\varepsilon}{3} \\left( \\frac{4}{3} \\frac{\\sigma^{12}}{r_c^9} - 2 \\frac{\\sigma^6}{r_c^3} \\right) = \\frac{32 \\pi \\rho^2 \\varepsilon}{9} \\frac{\\sigma^{12}}{r_c^9} - \\frac{16 \\pi \\rho^2 \\varepsilon}{3} \\frac{\\sigma^6}{r_c^3} $$\n\n**在约化单位下的数值计算**\n\n我们现在使用Lennard-Jones约化单位来计算这些表达式的值，其定义为 $r^* = r/\\sigma$, $\\rho^* = \\rho \\sigma^3$。能量以 $\\varepsilon$ 为单位，压力以 $\\varepsilon/\\sigma^3$ 为单位。\n\n对于每个粒子的能量修正，$(\\Delta U/N)^* = (\\Delta U/N)/\\varepsilon$：\n$$ \\frac{\\Delta U}{N \\varepsilon} = 8 \\pi (\\rho \\sigma^3) \\left( \\frac{1}{9(r_c/\\sigma)^9} - \\frac{1}{3(r_c/\\sigma)^3} \\right) = 8 \\pi \\rho^* \\left( \\frac{1}{9(r_c^*)^9} - \\frac{1}{3(r_c^*)^3} \\right) $$\n对于压力修正，$\\Delta P^* = \\Delta P / (\\varepsilon/\\sigma^3)$：\n$$ \\Delta P^* = \\frac{32 \\pi (\\rho \\sigma^3)^2}{9 (r_c/\\sigma)^9} - \\frac{16 \\pi (\\rho \\sigma^3)^2}{3 (r_c/\\sigma)^3} = \\frac{32 \\pi (\\rho^*)^2}{9 (r_c^*)^9} - \\frac{16 \\pi (\\rho^*)^2}{3 (r_c^*)^3} $$\n$$ \\Delta P^* = 16 \\pi (\\rho^*)^2 \\left( \\frac{2}{9(r_c^*)^9} - \\frac{1}{3(r_c^*)^3} \\right) $$\n我们已知数值为 $\\rho^* = 0.85$ 和 $r_c^* = 2.5$。\n首先，我们计算 $r_c^*$ 的幂：\n$(r_c^*)^3 = 2.5^3 = 15.625$\n$(r_c^*)^9 = (2.5^3)^3 = 15.625^3 = 3814.697265625$\n\n现在，我们计算能量修正的数值：\n$$ \\frac{\\Delta U}{N \\varepsilon} = 8 \\pi (0.85) \\left( \\frac{1}{9 \\times 3814.697...} - \\frac{1}{3 \\times 15.625} \\right) $$\n$$ \\frac{\\Delta U}{N \\varepsilon} = 21.36283... \\times \\left( \\frac{1}{34332.275...} - \\frac{1}{46.875} \\right) $$\n$$ \\frac{\\Delta U}{N \\varepsilon} = 21.36283... \\times (0.000029127... - 0.021333333...) $$\n$$ \\frac{\\Delta U}{N \\varepsilon} = 21.36283... \\times (-0.021304206...) = -0.4550775... $$\n四舍五入到四位有效数字，每个粒子的能量修正为 $-0.4551\\,\\varepsilon$。\n\n接下来，我们计算压力修正的数值：\n$$ \\Delta P^* = 16 \\pi (0.85)^2 \\left( \\frac{2}{9 \\times 3814.697...} - \\frac{1}{3 \\times 15.625} \\right) $$\n$$ \\Delta P^* = 16 \\pi (0.7225) \\left( \\frac{2}{34332.275...} - \\frac{1}{46.875} \\right) $$\n$$ \\Delta P^* = 36.31681... \\times (0.000058254... - 0.021333333...) $$\n$$ \\Delta P^* = 36.31681... \\times (-0.021275079...) = -0.7725964... $$\n四舍五入到四位有效数字，压力修正为 $-0.7726\\,\\varepsilon/\\sigma^3$。\n\n最终答案是 $\\Delta U/N = -0.4551\\,\\varepsilon$ 和 $\\Delta P = -0.7726\\,\\varepsilon/\\sigma^3$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -0.4551 -0.7726 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在分子动力学模拟中，温度是根据能量均分定理，通过瞬时动能来定义的。这个定义的核心在于正确计算系统的动力学自由度 $f$。本练习将通过一个包含单原子和刚性双原子分子的混合体系，阐述如何系统性地计算自由度，其中必须考虑刚性键等完整约束（holonomic constraints）以及质心动量守恒等因素对总自由度的削减。准确计算自由度是实现正确控温和解读模拟结果的基础 。",
            "id": "3973855",
            "problem": "在一个三维空间中，对一个二元混合物在周期性边界条件下进行经典分子动力学 (MD) 模拟。该混合物包含 $N_{\\mathrm{Ar}}$ 个单原子氩原子和 $N_{\\mathrm{H}_2}$ 个双原子氢分子，其中每个氢分子都使用一个完整的键长约束来强制其刚性。积分器在每个时间步都移除系统的总质心 (COM) 线性动量。瞬时动能记为 $K$，而基于动能的恒温器所使用的温度定义为：将系统的动能等同于二次速度自由度数乘以每个模式的热能之和。\n\n给定 $N_{\\mathrm{Ar}} = 500$，$N_{\\mathrm{H}_2} = 200$，并且每个完整键长约束恰好移除一个独立的标量自由度 (DOF)，请选择一个选项，该选项能正确地用 $K$、玻尔兹曼常数 $k_{\\mathrm{B}}$ 以及该系统无约束二次自由度 (DOF) $f$ 的正确数量来表示瞬时动能温度。\n\nA. $T = \\dfrac{2K}{f k_{\\mathrm{B}}}$，其中 $f = 3N - N_c - 3$，$N = N_{\\mathrm{Ar}} + 2N_{\\mathrm{H}_2} = 900$ 且 $N_c = N_{\\mathrm{H}_2} = 200$，所以 $f = 2497$。\n\nB. $T = \\dfrac{K}{f k_{\\mathrm{B}}}$，其中 $f = 3N - N_c - 3$，$N = 900$ 且 $N_c = 200$，所以 $f = 2497$。\n\nC. $T = \\dfrac{2K}{f k_{\\mathrm{B}}}$，其中 $f = 3N$，$N = 900$，所以 $f = 2700$。\n\nD. $T = \\dfrac{2K}{f k_{\\mathrm{B}}}$，其中 $f = 3N - 2N_c - 3$，$N = 900$ 且 $N_c = 200$，所以 $f = 2297$。\n\nE. $T = \\dfrac{2K}{3N k_{\\mathrm{B}}}$，其中 $N = 900$。",
            "solution": "问题陈述要求为使用经典分子动力学模拟的系统，找出瞬时动能温度 $T$ 的正确表达式。温度是基于总瞬时动能 $K$ 和无约束的二次速度自由度数 $f$ 来定义的。\n\n首先，我们根据能量均分定理建立动能与温度之间的基本关系。该定理指出，对于一个处于热平衡的系统，与每个二次自由度相关的平均能量是 $\\frac{1}{2}k_{\\mathrm{B}}T$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。粒子系统的动能是关于速度分量的二次项的和。如果系统有 $f$ 个这样的独立（无约束）速度自由度，总平均动能由下式给出：\n$$ \\langle K \\rangle = f \\cdot \\frac{1}{2} k_{\\mathrm{B}} T $$\n在分子动力学模拟中，瞬时动能温度是通过将此关系应用于瞬时动能（而不是时间平均值）来定义的：\n$$ K = \\frac{f}{2} k_{\\mathrm{B}} T $$\n解出温度 $T$，我们得到：\n$$ T = \\frac{2K}{f k_{\\mathrm{B}}} $$\n这是通用公式。问题的核心是确定 $f$（动能自由度的数量）的正确值。\n\n自由度数 $f$ 的计算方法是，从所有原子的总运动自由度数开始，然后减去由约束所移除的自由度数。\n\n1.  **原子总数和初始自由度：**\n    该系统由 $N_{\\mathrm{Ar}} = 500$ 个单原子氩原子和 $N_{\\mathrm{H}_2} = 200$ 个双原子氢分子组成。\n    每个氩原子是一个单粒子。\n    每个氢分子由 $2$ 个原子组成。\n    模拟中原子的总数（质点），我们称之为 $N$，是：\n    $$ N = N_{\\mathrm{Ar}} + 2 N_{\\mathrm{H}_2} = 500 + 2(200) = 500 + 400 = 900 \\text{ 个原子} $$\n    在三维空间中，这 $N$ 个原子中的每一个最初都有 $3$ 个平移自由度，对应于沿 $x$、$y$ 和 $z$ 轴的运动。\n    因此，初始总平移自由度数为 $3N$：\n    $$ \\text{初始自由度} = 3N = 3 \\times 900 = 2700 $$\n\n2.  **系统上的约束：**\n    问题指出了两种减少独立自由度数量的约束。\n\n    a.  **完整约束：** 有 $N_{\\mathrm{H}_2} = 200$ 个氢分子，每个都被建模为刚性双原子。这种刚性是通过一个完整键长约束来强制实现的。问题陈述，每个这样的约束恰好移除一个独立的标量自由度。因此，这些约束移除的总自由度数，记为 $N_c$，是：\n    $$ N_c = N_{\\mathrm{H}_2} = 200 $$\n\n    b.  **质心 (COM) 动量约束：** 问题陈述，积分器在每个时间步都移除总质心线性动量。这等同于将系统的总线性动量约束为零：$\\vec{P}_{\\text{total}} = \\sum_{i=1}^N m_i \\vec{v}_i = \\vec{0}$。由于线性动量是三维空间中的一个矢量，这会对系统的速度施加三个独立的标量约束（$P_x=0$, $P_y=0$, $P_z=0$）。这些约束移除了 $3$ 个自由度。\n\n3.  **最终自由度数 ($f$)：**\n    最终的无约束动能自由度数 $f$，是初始总数减去所有约束移除的自由度数。\n    $$ f = (\\text{初始自由度}) - (\\text{完整约束}) - (\\text{质心动量约束}) $$\n    $$ f = 3N - N_c - 3 $$\n    代入我们已有的值：\n    $N = 900$\n    $N_c = 200$\n    $$ f = 3(900) - 200 - 3 = 2700 - 200 - 3 = 2497 $$\n\n4.  **温度的最终表达式：**\n    将 $f = 2497$ 代入温度公式 $T = \\frac{2K}{f k_{\\mathrm{B}}}$，我们得到：\n    $$ T = \\frac{2K}{2497 k_{\\mathrm{B}}} $$\n\n现在，我们评估每个给定的选项。\n\n**A. $T = \\dfrac{2K}{f k_{\\mathrm{B}}}$，其中 $f = 3N - N_c - 3$，$N = N_{\\mathrm{Ar}} + 2N_{\\mathrm{H}_2} = 900$ 且 $N_c = N_{\\mathrm{H}_2} = 200$，所以 $f = 2497$。**\n- 温度公式 $T = \\dfrac{2K}{f k_{\\mathrm{B}}}$ 是正确的。\n- 原子总数 $N = N_{\\mathrm{Ar}} + 2N_{\\mathrm{H}_2} = 900$ 是正确的。\n- 完整约束的数量 $N_c = N_{\\mathrm{H}_2} = 200$ 是正确的。\n- 自由度的公式 $f = 3N - N_c - 3$ 正确地考虑了总原子数、键约束和质心动量约束。\n- 计算 $f = 3(900) - 200 - 3 = 2497$ 是正确的。\n- 这个选项与我们的推导完全一致。\n**结论：正确。**\n\n**B. $T = \\dfrac{K}{f k_{\\mathrm{B}}}$，其中 $f = 3N - N_c - 3$，$N = 900$ 且 $N_c = 200$，所以 $f = 2497$。**\n- 自由度数 $f=2497$ 的计算是正确的。\n- 然而，温度公式 $T = \\dfrac{K}{f k_{\\mathrm{B}}}$ 是不正确的。它在分子中缺少了因子 2，这个因子源于每个二次自由度对能量的贡献是 $\\frac{1}{2}k_{\\mathrm{B}}T$。\n**结论：不正确。**\n\n**C. $T = \\dfrac{2K}{f k_{\\mathrm{B}}}$，其中 $f = 3N$，$N = 900$，所以 $f = 2700$。**\n- 温度公式 $T = \\dfrac{2K}{f k_{\\mathrm{B}}}$ 是正确的。\n- $f$ 的计算是 $f = 3N = 2700$。这个计数没有减去由完整约束（$N_c = 200$）和质心运动约束（$3$）所移除的自由度。因此这是一个不正确的无约束自由度计数。\n**结论：不正确。**\n\n**D. $T = \\dfrac{2K}{f k_{\\mathrm{B}}}$，其中 $f = 3N - 2N_c - 3$，$N = 900$ 且 $N_c = 200$，所以 $f = 2297$。**\n- 温度公式 $T = \\dfrac{2K}{f k_{\\mathrm{B}}}$ 是正确的。\n- 用于自由度的公式 $f = 3N - 2N_c - 3$ 是不正确的。它为完整约束减去了 $2N_c$ 而不是 $N_c$。$N_c$ 个标量键长约束中的每一个只移除一个自由度，而不是两个。\n**结论：不正确。**\n\n**E. $T = \\dfrac{2K}{3N k_{\\mathrm{B}}}$，其中 $N = 900$。**\n- 这是选项 C 的一个紧凑形式。它隐含地使用了 $f=3N$。如对选项 C 的解释，这是一个不正确的自由度计数，因为它忽略了系统上的所有约束。\n**结论：不正确。**\n\n只有选项 A 提供了正确的温度公式和正确的自由度数计算。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}