{
    "hands_on_practices": [
        {
            "introduction": "在计算热工学中，将物理边界条件正确地整合到离散的代数方程组中是至关重要的一步。对流边界条件（也称为第三类边界条件或 Robin 边界条件）就是一个常见的例子，其热流与待求解的壁面温度有关。本练习将指导你如何将这个物理上直观的边界条件转化为有限体积法求解器所要求的标准线性化源项形式 $S = S_C + S_P T_P$，这是确保数值模型准确性和稳定性的基本技能。",
            "id": "3984551",
            "problem": "考虑一个使用有限体积法（FVM）离散化的固体中的稳态一维热传导问题。设与边界面 $f$ 相邻的控制体中心温度为 $T_{P}$，边界面积为 $A_{f}$，并受制于由牛顿冷却定律给出的对流（罗宾型）边界条件，即边界上的热通量为 $q'' = h\\left(T_{w} - T_{\\infty}\\right)$，其中 $h$ 是传热系数，$T_{w}$ 是壁面温度，$T_{\\infty}$ 是环境温度。假设边界面 $f$ 与环境进行热交换，使得穿过 $f$ 进入或离开控制体的净热流量可以表示为控制体温度 $T_{P}$ 和已知数据的函数。\n\n从控制体的能量守恒和牛頓冷却定律出发，将边界面 $f$ 处的对流边界贡献重写为源项线性化策略中规定的标准线性化源形式 $S = S_{C} + S_{P} T_{P}$。选择 $S_{P}$ 以满足适用于线性化源的对角占优要求。然后，确定这个线性化源如何修改相邻单元的组装代数平衡方程 $a_{P} T_{P} = \\sum a_{nb} T_{nb} + b_{P}$，并计算仅由边界面 $f$ 处的对流边界所引起的、必须加到对角系数 $a_{P}$ 和右端项 $b_{P}$ 上的数值贡献 $\\Delta a_{P}$ 和 $\\Delta b_{P}$。\n\n使用数据 $h = 100\\,\\text{W/m}^{2}\\text{/K}$，$A_{f} = 0.01\\,\\text{m}^{2}$ 和 $T_{\\infty} = 300\\,\\text{K}$。以符号形式用 $h$、$A_{f}$ 和 $T_{\\infty}$ 报告 $S_{C}$ 和 $S_{P}$，然后计算 $\\Delta a_{P}$（单位为 $\\text{W/K}$）和 $\\Delta b_{P}$（单位为 $\\text{W}$）的数值。将 $(\\Delta a_{P}, \\Delta b_{P})$ 的最终数值答案以行矩阵的形式呈现。无需四舍五入；提供精确值。",
            "solution": "该问题是有效的，因为它在科学上基于热传导和计算流体动力学的原理，问题定义良好且客观。我们着手求解。\n\n有限体积法（FVM）的基础是物理量在控制体上的守恒。对于稳态热传导问题，这意味着进入控制体的净热能速率为零。与边界面 $f$ 相邻的控制体 $P$ 的能量平衡可以写成：\n$$\n\\sum_{i} Q_{i} + S_{\\text{vol}} \\Delta V = 0\n$$\n其中 $Q_{i}$ 是穿过面 $i$ 的净热流率，$S_{\\text{vol}}$ 是体积热源，$\\Delta V$ 是控制体的体积。在本问题中，我们只关心来自边界面 $f$ 处对流边界的贡献。穿过该面的热流 $Q_f$ 被视为控制体单元的一个源项。\n\n根据牛顿冷却定律，从温度为 $T_w$ 的壁面到温度为 $T_{\\infty}$ 的周围环境的热通量（单位面积的热流率）由下式给出：\n$$\nq'' = h (T_{w} - T_{\\infty})\n$$\n其中 $h$ 是对流传热系数。根据 FVM 的惯例，流入控制体的热流被认为是正的。因此，通过面 $f$流入控制体的热流率为：\n$$\nQ_{f} = -q'' A_{f} = -h A_{f} (T_{w} - T_{\\infty})\n$$\n其中 $A_{f}$ 是边界面 $f$ 的面积。\n\n为了将此热流纳入单元中心温度 $T_P$ 的离散代数方程中，我们必须用节点温度来表示壁面温度 $T_w$。对于固体中的边界控制体，一个标准且必要的近似是假设壁面处的温度等于控制体中心的温度：\n$$\nT_w \\approx T_P\n$$\n将此近似代入 $Q_f$ 的表达式，我们得到来自边界的热源贡献：\n$$\nS = Q_{f} = -h A_{f} (T_P - T_{\\infty})\n$$\n这个源项 $S$ 依赖于未知变量 $T_P$。为了保持最终代数系统的线性结构，该项必须被线性化为标准形式 $S = S_C + S_P T_P$。通过重新排列 $S$ 的表达式：\n$$\nS = h A_{f} T_{\\infty} - h A_{f} T_P\n$$\n将其与线性化形式 $S = S_C + S_P T_P$ 进行比较，我们可以确定各个分量：\n$$\nS_C = h A_{f} T_{\\infty}\n$$\n$$\nS_P = -h A_{f}\n$$\n源项线性化的一般做法要求系数 $S_P$ 必须小于或等于零（$S_P \\le 0$）。这确保了当 $S_P T_P$ 项移到代数方程的左侧时，它会给主对角系数 $a_P$ 增加一个正值，从而加强对角占优性并促进数值解的稳定性。由于 $h$ 和 $A_f$ 是必须为正的物理量，我们推导出的 $S_P = -h A_f$ 确实是负的，满足了这一关键条件。\n\n单元 $P$ 的离散代数方程的一般形式是：\n$$\na_P T_P = \\sum_{nb} a_{nb} T_{nb} + b_P\n$$\n其中 $a_{nb}$ 是相邻单元的系数，$b_P$ 是源项的常数部分。在考虑边界源之前，设方程为 $a_P^0 T_P = \\sum a_{nb} T_{nb} + b_P^0$。包括线性化边界贡献在内的总源项被加到右侧：\n$$\na_P^0 T_P = \\sum_{nb} a_{nb} T_{nb} + b_P^0 + S = \\sum_{nb} a_{nb} T_{nb} + b_P^0 + S_C + S_P T_P\n$$\n为了恢复标准形式，我们将包含 $T_P$ 的项移到左侧：\n$$\n(a_P^0 - S_P) T_P = \\sum_{nb} a_{nb} T_{nb} + (b_P^0 + S_C)\n$$\n新的对角系数是 $a_P = a_P^0 - S_P$，新的源项常数部分是 $b_P = b_P^0 + S_C$。\n\n问题要求的是仅由对流边界引起的、必须加到系数上的数值贡献 $\\Delta a_P$ 和 $\\Delta b_P$。这些是相对于不包含边界效应的基准值（$a_P^0$, $b_P^0$）的变化量。\n对角系数的变化量是：\n$$\n\\Delta a_P = a_P - a_P^0 = -S_P\n$$\n源项常数部分的变化量是：\n$$\n\\Delta b_P = b_P - b_P^0 = S_C\n$$\n代入 $S_C$ 和 $S_P$ 的表达式：\n$$\n\\Delta a_P = -(-h A_{f}) = h A_{f}\n$$\n$$\n\\Delta b_P = h A_{f} T_{\\infty}\n$$\n现在，我们代入给定的数值：$h = 100\\,\\text{W/m}^{2}\\text{/K}$，$A_{f} = 0.01\\,\\text{m}^{2}$ 和 $T_{\\infty} = 300\\,\\text{K}$。\n\n对对角系数 $a_P$ 的数值贡献是：\n$$\n\\Delta a_P = (100\\,\\text{W/m}^{2}\\text{/K}) \\times (0.01\\,\\text{m}^{2}) = 1\\,\\text{W/K}\n$$\n对源项常数部分 $b_P$ 的数值贡献是：\n$$\n\\Delta b_P = (100\\,\\text{W/m}^{2}\\text{/K}) \\times (0.01\\,\\text{m}^{2}) \\times (300\\,\\text{K}) = 1 \\times 300\\,\\text{W} = 300\\,\\text{W}\n$$\n最终答案是数值对 $(\\Delta a_P, \\Delta b_P)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  300\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了如何对边界条件进行线性化之后，我们必须深入探讨线性化背后的理论依据，尤其是如何处理那些可能破坏数值稳定性的源项。例如，在放热化学反应等现象中，源项会随着温度升高而增强，即其导数 $\\frac{\\partial S}{\\partial T}  0$，这会对求解过程构成挑战。本练习通过分析和选择题的形式，探讨了保证数值解有界性和单调性的核心原则——即确保系数 $S_P \\le 0$，帮助你建立对不同线性化策略优劣的批判性认识。",
            "id": "3984545",
            "problem": "考虑用于瞬态热传导的有限体积法 (FVM) 中的单个控制体积，该控制体积具有与温度相关的体积热源。局部能量守恒定律可以用温度 $T$ 表示为 $$\\rho c \\frac{\\partial T}{\\partial t} = \\nabla \\cdot (k \\nabla T) + S(T),$$ 其中 $\\rho$ 是密度，$c$ 是比热容，$k$ 是导热系数，$S(T)$ 是体积热源。在放热过程中，$S(T) \\ge 0$ 并且通常随 $T$ 的增加而增加，例如在 Arrhenius 型反应热释放或热辐射吸收/发射模型中。\n\n您使用 FVM 在体积为 $V$ 的控制体积上对控制方程进行时间和空间上的全隐式离散化。为了处理 $S(T)$ 中的非线性，您打算将源项线性化为标准形式 $$S(T) \\approx S_C + S_P \\, T,$$ 其中 $S_C$ 和 $S_P$ 是每次迭代中待定的系数，$S_C$ 组装到右侧项中，$S_P$ 组装到未知温度的系数中。为了保证数值有界性和物理真实性（避免非物理的过冲并保持单调性），一个常见的准则是对 $S_P$ 强制施加一个符号条件。\n\n分析在全隐式 FVM 离散化中适用于放热源的 $S_P$ 的符号，并解释如何将 $S(T)$ 重构为 $S_C + S_P T$ 的形式，以强制执行所需的符号条件，同时保持物理行为（例如，在选定的参考温度下匹配真实源，并对放热机制保持源项为非负）。回答以下多项选择题；选择所有正确的选项。\n\nA. 对于 $\\frac{\\partial S}{\\partial T}  0$ 的放热源，设置 $S_P = 0$ 并取 $S_C = S(T^{*})$（其中 $T^{*}$ 是一个滞后或先前计算的温度）是一个安全的选择，它强制执行了对 $S_P$ 的符号条件，并保证了隐式离散化的有界性。\n\nB. 选择 $S_P = \\left.\\frac{\\partial S}{\\partial T}\\right|_{T^{*}}  0$ 可以改善收敛性并保证有界性，因为它在隐式系数中捕捉了温度敏感性。\n\nC. 一种保持物理性的重构是 $$S_C = S(T^{*}) - S_P \\, T^{*}, \\quad S_P = -\\beta,$$ 其中 $\\beta \\ge 0$ 由用户选择。这既能在 $T^{*}$ 处匹配精确源，又强制执行了 $S_P \\le 0$。对于 $S(T^{*}) \\ge 0$ 的放热源，它能使线性化模型中的有效源在 $T^{*}$ 附近的温度下保持非负。\n\nD. 对于一个 Arrhenius 放热源 $$S(T) = \\rho Q A \\exp\\!\\left(-\\frac{E}{R T}\\right),$$ 其中 $Q$ 是反应热，$A$ 是指前因子，$E$ 是活化能，$R$ 是通用气体常数，可以通过取 $$S_P = -\\theta \\left.\\frac{\\partial S}{\\partial T}\\right|_{T^{*}}, \\quad S_C = S(T^{*}) - S_P T^{*}, \\quad 0 \\le \\theta \\le 1$$ 来强制 $S_P \\le 0$ 同时捕捉刚度。这会抑制非线性，增加线性系统的对角系数，并保证隐式求解的有界性。\n\nE. 为了保持放热源的物理行为，$S_P$ 必须是严格为负的（即 $S_P  0$）；选择 $S_P = 0$ 在物理上是不一致的，并会导致离散化中的能量不守恒。\n\n选择所有适用的选项。",
            "solution": "用户希望我以一位严谨的STEM教授的身份，解决一个关于计算热工学中源项线性化的多项选择题。\n\n### 第一步：提取已知条件\n-   瞬态热传导的控制方程：$$\\rho c \\frac{\\partial T}{\\partial t} = \\nabla \\cdot (k \\nabla T) + S(T)$$\n-   变量：`$\\rho$` (密度)，`$c$` (比热容)，`$k$` (导热系数)，`$T$` (温度)，`$t$` (时间)。\n-   源项：`$S(T)$` 是一个与温度相关的体积热源。\n-   放热过程特性：`$S(T) \\ge 0$`，并且 `$S(T)$` 通常随 `$T$` 的增加而增加，所以 `$\\frac{\\partial S}{\\partial T} \\ge 0$`。\n-   数值方法：在体积为 `$V$` 的控制体积上的全隐式有限体积法 (FVM)。\n-   源项线性化模型：$$S(T) \\approx S_C + S_P \\, T$$\n-   组装规则：`$S_C$` 是右侧项（源向量）的一部分，`$S_P$` 贡献于未知温度的系数（矩阵对角线）。\n-   数值准则：为保证有界性和物理真实性，对 `$S_P$` 强制施加一个符号条件。\n-   源项示例：Arrhenius 放热源 $$S(T) = \\rho Q A \\exp\\!\\left(-\\frac{E}{R T}\\right)$$\n\n### 第二步：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题牢固地植根于传热学原理和计算流体力学与传热学中使用的标准数值方法 (FVM)。控制方程是标准的能量守恒方程。源项线性化是处理数值模拟中非线性的一项关键且成熟的技术。Arrhenius 模型是化学热释放的标准表示。该问题在科学上是合理的。\n2.  **适定性：** 该问题要求对不同的数值策略进行分析和评估，而不是求解一个特定的边值问题。背景定义清晰，评估标准（有界性、物理真实性）是该领域的标准。该问题是适定的。\n3.  **客观性：** 该问题以精确、技术性的语言陈述，没有主观或模糊的术语。\n4.  **完整性/一致性：** 该问题提供了分析源项线性化对数值稳定性影响所需的所有信息。没有矛盾之处。\n5.  **现实性：** 所描述的情景是工程师和科学家在为具有反应或辐射源的系统实施数值模型时面临的常见挑战。\n6.  **其他缺陷：** 该问题并非微不足道、隐喻性或无法验证。它涉及了高级数值建模中的一个核心概念。\n\n### 第三步：结论与行动\n问题陈述是 **有效的**。这是一个适定的、有科学依据的计算热工学问题。我将继续推导和评估这些选项。\n\n### `$S_P$` 符号条件的推导\n\n对于体积为 `$V$` 的单个控制体积 `$P$`，其控制方程的全隐式 FVM 离散形式为：\n$$ \\rho c \\frac{T_P - T_P^0}{\\Delta t} V = \\sum_{nb} \\frac{k_{nb} A_{nb}}{d_{nb}} (T_{nb} - T_P) + \\int_V S(T) dV $$\n其中 `$T_P$` 是当前时间步的未知温度，`$T_P^0$` 是前一时间步的温度，`$\\Delta t$` 是时间步长，求和是对所有相邻控制体积 (`$nb$`) 进行的。`$A_{nb}$` 是交界面面积，`$d_{nb}$` 是单元中心之间的距离。\n\n将源项线性化为 `$\\int_V S(T) dV \\approx (S_C + S_P T_P) V$`，我们将其代入方程：\n$$ \\rho c \\frac{T_P - T_P^0}{\\Delta t} V = \\sum_{nb} \\frac{k_{nb} A_{nb}}{d_{nb}} (T_{nb} - T_P) + (S_C + S_P T_P) V $$\n为了得到标准的线性代数形式 `$a_P T_P = \\sum_{nb} a_{nb} T_{nb} + b$`，我们重新整理各项，将所有包含未知温度 `$T_P$` 的项移到左侧，所有其他项移到右侧：\n$$ \\left( \\frac{\\rho c V}{\\Delta t} + \\sum_{nb} \\frac{k_{nb} A_{nb}}{d_{nb}} - S_P V \\right) T_P = \\left( \\sum_{nb} \\frac{k_{nb} A_{nb}}{d_{nb}} T_{nb} \\right) + \\frac{\\rho c V}{\\Delta t} T_P^0 + S_C V $$\n我们可以确定系数：\n$$ a_{nb} = \\frac{k_{nb} A_{nb}}{d_{nb}} $$\n$$ a_P = \\sum_{nb} a_{nb} + \\frac{\\rho c V}{\\Delta t} - S_P V $$\n$$ b = \\frac{\\rho c V}{\\Delta t} T_P^0 + S_C V $$\n\n为了使数值格式有界（即防止非物理振荡并确保解保持在物理界限内）并使迭代矩阵求解器可靠收敛，得到的线性方程组必须满足某些性质，最常见的是对角占优。对于一个不可约矩阵，Scarborough 判据要求所有方程都满足 `$a_P > 0$` 且 `$a_P \\ge \\sum_{nb} |a_{nb}|$`。在 FVM 中，相邻系数 `$a_{nb}$` 是正的（因为 `$k, A, d > 0$`）。瞬态项系数 `$\\frac{\\rho c V}{\\Delta t}$` 也是正的。\n\n在 FVM 的背景下，有界性的要求通常被简化为确保所有系数 `$a_{nb}$` 都是非负的，并且主系数 `$a_P$` 满足 `$a_P = \\sum_{nb} a_{nb} + a'_P$`，其中 `$a'_P \\ge 0$`。在我们的例子中：\n$$ a_P = \\left( \\sum_{nb} a_{nb} \\right) + \\left( \\frac{\\rho c V}{\\Delta t} - S_P V \\right) $$\n为了满足该条件，我们必须有 `$\\frac{\\rho c V}{\\Delta t} - S_P V \\ge 0$`。由于 `$\\frac{\\rho c V}{\\Delta t} \\ge 0$`，要最稳健地保证此条件，需要源项部分 `$-S_P V$` 是非负的。由于 `$V > 0$`，这意味着：\n$$ -S_P \\ge 0 \\quad \\implies \\quad S_P \\le 0 $$\n选择 `$S_P \\le 0$` 会增加（或保持不变）主对角系数 `$a_P$` 的大小，从而增强对角占优性并促进稳定性和有界性。相反，选择 `$S_P > 0$` 会减小 `$a_P$`，可能使其变为负数并违反了对角占优性，导致数值不稳定和发散。这对于 `$\\frac{\\partial S}{\\partial T} > 0$` 的放热源尤其危险，因为它会在数值格式中产生一个不稳定的正反馈。\n\n因此，在这种情况下，线性化源项的基本准则是确保 `$S_P \\le 0$`。\n\n### 逐项分析\n\n**A. 对于 `$\\frac{\\partial S}{\\partial T} > 0$` 的放热源，设置 `$S_P = 0$` 并取 `$S_C = S(T^{*})$`（其中 `$T^{*}$` 是一个滞后或先前计算的温度）是一个安全的选择，它强制执行了对 `$S_P$` 的符号条件，并保证了隐式离散化的有界性。**\n\n-   **分析：** 该选项建议设置 `$S_P = 0$`。这个选择满足推导出的条件 `$S_P \\le 0$`。当 `$S_P = 0$` 时，源项 `$-S_P V$` 对对角系数 `$a_P$` 的贡献为零，因此保持了基础（无源）格式的对角占优性。整个源项 `$S(T^{*})$` 被显式处理，即移动到右侧源向量 `$b$` 中。虽然这种显式处理对于刚性源可能有局限性（需要小的时间步长来保证稳定性/精度），但它正确地遵守了有界性准则。这是一个“安全”且简单的选择。\n-   **结论：** **正确**。\n\n**B. 选择 `$S_P = \\left.\\frac{\\partial S}{\\partial T}\\right|_{T^{*}} > 0$` 可以改善收敛性并保证有界性，因为它在隐式系数中捕捉了温度敏感性。**\n\n-   **分析：** 对于给定的放热源，`$S(T)$` 随 `$T$` 增加，所以 `$\\left.\\frac{\\partial S}{\\partial T}\\right|_{T^{*}} > 0$`。这个选择意味着 `$S_P > 0$`。正如所推导的，一个正的 `$S_P$` 违反了条件 `$S_P \\le 0$`。它会从主对角系数 `$a_P$` 中减去一个值，降低对角占优性，并可能使 `$a_P$` 变为负值。这是导致数值不稳定和发散的根源，而不是保证有界性的方法。对于标准的 FVM 格式，这个选择是根本错误的。\n-   **结论：** **不正确**。\n\n**C. 一种保持物理性的重构是 `$$S_C = S(T^{*}) - S_P \\, T^{*}, \\quad S_P = -\\beta,$$` 其中 `$\\beta \\ge 0$` 由用户选择。这既能在 `$T^{*}$` 处匹配精确源，又强制执行了 `$S_P \\le 0$`。对于 `$S(T^{*}) \\ge 0$` 的放热源，它能使线性化模型中的有效源在 `$T^{*}$` 附近的温度下保持非负。**\n\n-   **分析：** 该提议是 `$S_P = -\\beta$`，其中 `$\\beta \\ge 0$`。这直接强制执行了 `$S_P \\le 0$` 的条件。`$S_C = S(T^{*}) - S_P T^{*}$` 的构造确保了线性化源 `$S_{\\text{lin}}(T) = S_C + S_P T = (S(T^{*}) - S_P T^{*}) + S_P T = S(T^{*}) + S_P(T - T^{*})$` 在 `$T = T^{*}$` 时求得的值为 `$S(T^{*})$`。这是一个理想的性质，使得该近似在结构上成为一个一阶泰勒展开，但具有一个修正的斜率 `$S_P$`。关于它在 `$T^{*}$` 附近保持源非负的说法也是正确的，因为 `$S(T^{*}) \\ge 0$` 并且对于 `$T \\approx T^{*}$`，变化量 `$S_P(T - T^{*})$` 很小。这是在遵守数值稳定性约束的同时实现源项线性化的一个通用且正确的过程。\n-   **结论：** **正确**。\n\n**D. 对于一个 Arrhenius 放热源 `$$S(T) = \\rho Q A \\exp\\!\\left(-\\frac{E}{R T}\\right),$$` 其中 `$Q$` 是反应热，`$A$` 是指前因子，`$E$` 是活化能，`$R$` 是通用气体常数，可以通过取 `$$S_P = -\\theta \\left.\\frac{\\partial S}{\\partial T}\\right|_{T^{*}}, \\quad S_C = S(T^{*}) - S_P T^{*}, \\quad 0 \\le \\theta \\le 1.$$` 来强制 `$S_P \\le 0$` 同时捕捉刚度。这会抑制非线性，增加线性系统的对角系数，并保证隐式求解的有界性。**\n\n-   **分析：** 这是选项 C 中原理的一个具体应用。对于 Arrhenius 源，`$\\frac{\\partial S}{\\partial T} = S(T) \\frac{E}{RT^2} > 0$`。所提出的 `$S_P = -\\theta \\left.\\frac{\\partial S}{\\partial T}\\right|_{T^{*}}$` 在 `$0 \\le \\theta \\le 1$` 的条件下确保了 `$S_P \\le 0$`。对对角系数的贡献是 `$-S_P V = \\theta \\left.\\frac{\\partial S}{\\partial T}\\right|_{T^{*}} V \\ge 0$`，这会 *增加* 对角系数 `$a_P$`，从而增强稳定性和有界性。因子 `$\\theta$` 作为一个“阻尼”或欠松弛因子。`$\\theta = 0$` 恢复为显式方法（选项 A）。`$\\theta = 1$` 对应于一个类牛顿线性化项（为了稳定性符号被翻转），对于高度非线性的源可能过于激进。使用 `$0  \\theta  1$` 提供了一种稳健的方式来增加隐式性并稳定解，而不会引起过冲。`$S_C = S(T^{*}) - S_P T^{*}$` 的构造与之前一致。这是一个先进、正确且实用的策略。\n-   **结论：** **正确**。\n\n**E. 为了保持放热源的物理行为，`$S_P$` 必须是严格为负的（即 `$S_P  0$`）；选择 `$S_P = 0$` 在物理上是不一致的，并会导致离散化中的能量不守恒。**\n\n-   **分析：** 有界性的条件是 `$S_P \\le 0$`，这包括 `$S_P = 0$`。因此，声称 `$S_P$` 必须是 *严格* 为负的说法是错误的。正如在 A 中分析的，`$S_P = 0$` 是一个有效的选择。声称 `$S_P=0$` 是“物理上不一致的”说法也是不正确的；它代表了一个有效的零阶近似 `$S(T) \\approx S(T^{*})$`。最重要的是，声称它“会导致能量不守恒”是根本错误的。有限体积法是通过在控制体积上对守恒定律进行积分而导出的，这使其具有内在的守恒性。线性化是一种用于在每个时间步/迭代中求解所产生的代数方程的数学技术。它影响的是求解的路径及其稳定性，而不是底层离散化框架的守恒性质。\n-   **结论：** **不正确**。",
            "answer": "$$\\boxed{ACD}$$"
        },
        {
            "introduction": "理论和基础实践是解决更复杂问题的基石，例如相变过程的模拟。在相变问题中，“源项”并不像外加的热源那样直观，而是作为潜热释放的数学表征，从焓的瞬态变化中产生。本练习将展示如何运用源项线性化技术来处理这种高度非线性的物理现象，通过将潜热项视为一个强大的温度依赖源项，并应用确保稳定性的线性化原则，从而实现对熔化或凝固过程的稳健数值模拟。",
            "id": "3984562",
            "problem": "使用有限体积法（FVM）和全隐式时间积分来模拟一个一维相变问题。以单位体积为基础，用与温度相关的焓表示的能量方程受能量守恒定律支配：焓的变化率等于净传导加上任何体积源或汇。在糊状区（mushy-zone）公式中，焓被建模为 $h(T)=c\\,T+L\\,f(T)$，其中 $c$ 是比热， $L$ 是潜热， $f(T)$ 是局部液相分数。潜热的贡献通过 $\\rho\\,L\\,\\partial f/\\partial t$ 项进入能量方程，其中 $\\rho$ 是密度。\n\n在相变区间 $T\\in[T_s,T_l]$ 内，糊状分数被视为线性关系，$f(T)=\\dfrac{T-T_s}{T_l-T_s}$，其中 $T_s=300\\,\\mathrm{K}$ 和 $T_l=350\\,\\mathrm{K}$。密度 $\\rho=900\\,\\mathrm{kg/m^3}$，潜热 $L=2\\times 10^5\\,\\mathrm{J/kg}$，时间步长 $\\Delta t=0.1\\,\\mathrm{s}$。\n\n使用与全隐式格式一致的源项线性化策略，围绕前一时间步的温度对潜热源项 $S(T)\\equiv \\rho\\,L\\,\\dfrac{\\partial f}{\\partial t}$ 进行线性化，使得新时间步的 $S(T)$ 可以表示为 $S(T)\\approx S_P\\,T^{n+1}+S_C$，其中 $S_P\\le 0$ 以确保离散化的有界性。在相变区间内，用 $\\rho$、$L$、$\\Delta t$ 和 $\\dfrac{df}{dT}$ 推导出 $S_P$ 的闭式表达式，然后使用所提供的数据对 $S_P$ 进行数值计算。\n\n将 $S_P$ 的最终值以瓦特每立方米开尔文（写作 $\\mathrm{W\\,m^{-3}\\,K^{-1}}$）表示，并将您的数值结果四舍五入到三位有效数字。最终答案必须是一个实数。",
            "solution": "本问题要求对一个使用有限体积法（FVM）和全隐式时间积分方案求解的一维相变问题中的潜热源项进行线性化。目标是从线性化源项表达式 $S_P\\,T^{n+1}+S_C$ 中推导出系数 $S_P$ 并进行数值计算。\n\n首先，我们建立控制能量方程。在一个涉及相变的系统中，能量守恒可以用焓 $h$ 来表示。单位体积焓的变化率由热传导和任何体积源项来平衡。焓由 $h(T) = c\\,T + L\\,f(T)$ 给出，其中 $c$ 是比热， $L$ 是潜热， $f(T)$ 是液相分数。\n控制方程为：\n$$\n\\rho \\frac{\\partial h}{\\partial t} = \\nabla \\cdot (k \\nabla T)\n$$\n其中 $\\rho$ 是密度， $k$ 是热导率。代入 $h(T)$ 的表达式：\n$$\n\\rho \\frac{\\partial}{\\partial t} (c\\,T + L\\,f(T)) = \\nabla \\cdot (k \\nabla T)\n$$\n假设比热 $c$ 为常数，我们可以展开时间导数：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} + \\rho L \\frac{\\partial f}{\\partial t} = \\nabla \\cdot (k \\nabla T)\n$$\n为了求解温度 $T$ ，通常的做法是将潜热项视为一个源项或汇项。重新整理方程以分离出温度的瞬态项：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = \\nabla \\cdot (k \\nabla T) - \\rho L \\frac{\\partial f}{\\partial t}\n$$\n问题将潜热源项定义为 $S(T) \\equiv \\rho\\,L\\,\\frac{\\partial f}{\\partial t}$。因此，该项在温度方程中充当一个汇项，以负号进入方程。温度方程中的总源项是 $S_{\\text{eff}} = -S(T)$。\n\n对于全隐式时间离散，所有项都在新的时间步 $n+1$ 进行计算。时间导数使用一阶后向差分近似：\n$$\n\\frac{\\partial T}{\\partial t} \\approx \\frac{T^{n+1} - T^n}{\\Delta t}\n$$\n液相分数导数也类似：\n$$\n\\frac{\\partial f}{\\partial t} \\approx \\frac{f(T^{n+1}) - f(T^n)}{\\Delta t}\n$$\n因此，在时间步 $n+1$ 的有效源项近似为：\n$$\nS_{\\text{eff}}^{n+1} = -\\rho L \\frac{f(T^{n+1}) - f(T^n)}{\\Delta t}\n$$\n这个表达式对于未知温度 $T^{n+1}$ 是非线性的，因为 $f$ 是 $T^{n+1}$ 的函数。为了将其纳入线性代数方程组，我们必须对其进行线性化。问题指定围绕前一时间步的温度 $T^n$ 进行线性化，形式为 $S_P T^{n+1} + S_C$。\n这可以通过对 $f(T^{n+1})$ 在 $T^n$ 附近进行一阶泰勒级数展开来实现：\n$$\nf(T^{n+1}) \\approx f(T^n) + \\left(\\frac{df}{dT}\\right)^n (T^{n+1} - T^n)\n$$\n其中 $\\left(\\frac{df}{dT}\\right)^n$ 是液相分数对温度的导数，在 $T^n$ 处求值。\n\n将此展开式代入 $S_{\\text{eff}}^{n+1}$ 的表达式中：\n$$\nS_{\\text{eff}}^{n+1} \\approx -\\frac{\\rho L}{\\Delta t} \\left[ \\left( f(T^n) + \\left(\\frac{df}{dT}\\right)^n (T^{n+1} - T^n) \\right) - f(T^n) \\right]\n$$\n$f(T^n)$ 项相互抵消：\n$$\nS_{\\text{eff}}^{n+1} \\approx -\\frac{\\rho L}{\\Delta t} \\left[ \\left(\\frac{df}{dT}\\right)^n (T^{n+1} - T^n) \\right]\n$$\n将其重新整理为所需的线性化形式 $S_P T^{n+1} + S_C$：\n$$\nS_{\\text{eff}}^{n+1} \\approx \\left[ -\\frac{\\rho L}{\\Delta t} \\left(\\frac{df}{dT}\\right)^n \\right] T^{n+1} + \\left[ \\frac{\\rho L}{\\Delta t} \\left(\\frac{df}{dT}\\right)^n T^n \\right]\n$$\n通过与目标形式进行比较，我们确定系数 $S_P$ 和 $S_C$：\n$$\nS_P = -\\frac{\\rho L}{\\Delta t} \\left(\\frac{df}{dT}\\right)^n\n$$\n$$\nS_C = \\frac{\\rho L}{\\Delta t} \\left(\\frac{df}{dT}\\right)^n T^n = -S_P T^n\n$$\n问题给出了显式约束 $S_P \\le 0$。由于 $\\rho$、$L$ 和 $\\Delta t$ 均为正值，这要求 $\\left(\\frac{df}{dT}\\right)^n \\ge 0$。随着熔化过程中温度的升高，液相分数 $f$ 增加，因此该条件在物理上是一致的。我们的推导正确地得出了一个负的 $S_P$ ，满足了有限体积法中数值稳定性的这一基本要求。\n\n任务的第一部分是给出用给定参数表示的 $S_P$ 的闭式表达式。它就是：\n$$\nS_P = -\\frac{\\rho L}{\\Delta t} \\frac{df}{dT}\n$$\n请注意，我们去掉了导数上的上标 $n$ ，因为对于给定的模型，在相变区间内它是恒定的。\n\n第二部分是对 $S_P$ 进行数值计算。在相变区间 $T \\in [T_s, T_l]$ 内，液相分数由 $f(T) = \\dfrac{T-T_s}{T_l-T_s}$ 给出。\n其导数为：\n$$\n\\frac{df}{dT} = \\frac{1}{T_l - T_s}\n$$\n将此代入 $S_P$ 的表达式中：\n$$\nS_P = -\\frac{\\rho L}{\\Delta t (T_l - T_s)}\n$$\n现在，我们代入给定的数值：\n$\\rho = 900\\,\\mathrm{kg/m^3}$\n$L = 2 \\times 10^5\\,\\mathrm{J/kg}$\n$\\Delta t = 0.1\\,\\mathrm{s}$\n$T_s = 300\\,\\mathrm{K}$\n$T_l = 350\\,\\mathrm{K}$\n\n温差为 $T_l - T_s = 350\\,\\mathrm{K} - 300\\,\\mathrm{K} = 50\\,\\mathrm{K}$。\n\n$$\nS_P = -\\frac{(900\\,\\mathrm{kg/m^3}) \\times (2 \\times 10^5\\,\\mathrm{J/kg})}{(0.1\\,\\mathrm{s}) \\times (50\\,\\mathrm{K})}\n$$\n$$\nS_P = -\\frac{1.8 \\times 10^8\\,\\mathrm{J/m^3}}{5\\,\\mathrm{s \\cdot K}}\n$$\n$$\nS_P = -0.36 \\times 10^8\\,\\frac{\\mathrm{J}}{\\mathrm{s \\cdot m^3 \\cdot K}}\n$$\n由于 $1\\,\\mathrm{J/s} = 1\\,\\mathrm{W}$，单位为 $\\mathrm{W\\,m^{-3}\\,K^{-1}}$，符合要求。\n$$\nS_P = -3.6 \\times 10^7\\,\\mathrm{W\\,m^{-3}\\,K^{-1}}\n$$\n问题要求将结果四舍五入到三位有效数字。\n$$\nS_P = -3.60 \\times 10^7\\,\\mathrm{W\\,m^{-3}\\,K^{-1}}\n$$\n这是系数 $S_P$ 的最终数值。",
            "answer": "$$\\boxed{-3.60 \\times 10^7}$$"
        }
    ]
}