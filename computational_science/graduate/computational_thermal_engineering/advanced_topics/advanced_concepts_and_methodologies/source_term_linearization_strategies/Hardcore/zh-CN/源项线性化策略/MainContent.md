## 引言
在[计算热工学](@entry_id:1122812)及更广泛的计算物理领域，许多关键物理过程，如化学反应、相变或辐射，都在控制方程中以源项的形式出现。这些源项常常与温度等求解变量呈[非线性](@entry_id:637147)关系，给数值求解带来了巨大的挑战，若处理不当，极易导致计算过程的不稳定甚至发散。本文旨在系统性地解决这一难题，为读者提供一套关于[源项线性化](@entry_id:1131997)策略的完整知识框架，确保[数值模拟](@entry_id:146043)的鲁棒性与准确性。

为了实现这一目标，本文内容被精心划分为三个递进的章节。首先，在“原理与机制”一章中，我们将深入探讨线性化的基本思想、推导保证[数值稳定性](@entry_id:175146)的核心准则（[Patankar法则](@entry_id:1129423)），并比较Picard和Newton等不[同线性](@entry_id:270224)化方法的优劣。接着，“应用与交叉学科联系”一章将视野拓宽至真实世界的复杂问题，展示线性化策略如何在相变、[湍流](@entry_id:151300)、[辐射传热](@entry_id:149271)和化学反应流等多样化的场景中发挥关键作用。最后，“动手实践”部分将通过具体的计算练习，帮助读者将理论知识转化为解决实际问题的能力。

通过这一结构化的学习路径，我们将从最核心的数学原理出发，逐步揭示[源项线性化](@entry_id:1131997)作为连接理论与实践的桥梁，在现代计算模拟中的普适性与强大威力。

## 原理与机制

在[计算热工学](@entry_id:1122812)中，许多物理现象——例如化学反应、相变、[辐射交换](@entry_id:150522)或焦耳热——在控制方程中表现为源项。当这些源项依赖于求解变量（如温度）时，它们会给离散化的代数方程组带来[非线性](@entry_id:637147)。有效且稳定地处理这些[非线性源项](@entry_id:1128871)对于数值求解器的鲁棒性和准确性至关重要。本章深入探讨了[源项线性化](@entry_id:1131997)策略的原理和机制，重点关注在[有限体积法 (FVM)](@entry_id:749403) 框架内确保数值解的有界性和收敛性的方法。

### 源项在能量平衡中的作用

让我们从一个[固定控制体](@entry_id:272149)积 $V$ 的积分形式的能量守恒方程开始。根据[热力学第一定律](@entry_id:146485)，控制体积内能量的变化率等于通过其边界的[净热通量](@entry_id:155652)加上体积内源项的净生成率。对于一个包含[体积热源](@entry_id:1133894) $s(T)$（单位体积的功率，单位为 $\mathrm{W\,m^{-3}}$）的静止介质，能量方程可以写成：

$$
\frac{d}{dt} \int_V \rho c_p T \, dV = \oint_A \mathbf{q} \cdot d\mathbf{A} + \int_V s(T) \, dV
$$

其中 $\rho$ 是密度，$c_p$ 是比热容，$T$ 是温度场，$\mathbf{q}$ 是热通量矢量。在[有限体积法](@entry_id:141374)中，我们将此方程应用于网格中的每个单元（控制体积）。对于一个以节点 $P$ 为中心的单元，其体积为 $V_P$，上述方程的离散形式将单元 $P$ 的温度 $T_P$ 与其相邻节点 $T_N$ 的温度联系起来。

源项的贡献来自于体积积分 $\int_{V_P} s(T) \, dV$。一个常见的且合理的近似是假设源项在整个小控制体积内是均匀的，并取其在节点温度 $T_P$ 下的值。因此，源项对离散方程的贡献被近似为 $S(T_P) V_P$。这个量的单位是 $(\mathrm{W\,m^{-3}}) \cdot \mathrm{m^3} = \mathrm{W}$，代表了在控制体积内由于源（或汇）而产生的净热能速率。正的 $S$ 表示能量生成（源），负的 $S$ 表示能量消耗（汇）。重要的是要区分这种**体积源**与作用于表面的**表面通量**，后者是在边界积分项中处理的。

### [非线性](@entry_id:637147)挑战与线性化需求

当源项 $S(T)$ 是温度的[非线性](@entry_id:637147)函数时，离散化的能量平衡方程对于每个节点 $P$ 都会变成[非线性](@entry_id:637147)[代数方程](@entry_id:272665)。例如，一个[稳态](@entry_id:139253)导热问题的离散方程可能呈现如下形式：

$$
\sum_N a_N (T_P - T_N) = S(T_P) V_P
$$

其中 $a_N$ 是表示节点 $P$ 与其邻居 $N$ 之间[热传导](@entry_id:143509)能力的系数。求解由大量此[类方程](@entry_id:144428)组成的整个非线性系统在计算上是昂贵且复杂的。

为了应对这一挑战，[计算流体力学](@entry_id:747620) (CFD) 的标准实践是采用**[源项线性化](@entry_id:1131997)**。其核心思想是在每次迭代求解之前，用一个关于待求变量的线性表达式来近似[非线性源项](@entry_id:1128871)。最常见的线性化形式是：

$$
S(T_P) \approx S_C + S_P T_P
$$

其中 $S_C$ 和 $S_P$ 是在当前迭代步内被视为常数的系数。$S_C$ 被称为**显式**部分，因为它不依赖于当前迭代步正在求解的未知温度 $T_P$。$S_P T_P$ 被称为**隐式**部分，因为它包含了未知温度 $T_P$。通过这种方式，[非线性](@entry_id:637147)[代数方程](@entry_id:272665)被转化为一个可以在每次迭代中高效求解的线性代数方程。

将这个线性化表达式代入离散方程，我们可以看到它如何修改方程的系数。考虑一个通用的离散方程，其形式为（在引入源项之前）：

$$
a_P^0 T_P = \sum_N a_N T_N + b_P^0
$$

加入线性化的源项 $(S_C + S_P T_P)V_P$ 后，方程变为：

$$
a_P^0 T_P = \sum_N a_N T_N + b_P^0 + (S_C + S_P T_P)V_P
$$

为了将方程重新整理为标准[线性形式](@entry_id:276136)，我们将所有包含未知 $T_P$ 的项移到左边：

$$
(a_P^0 - S_P V_P) T_P = \sum_N a_N T_N + (b_P^0 + S_C V_P)
$$

通过与新的标准形式 $a_P^{\text{new}} T_P = \sum_N a_N T_N + b_P^{\text{new}}$ 对比，我们得到更新后的系数：

$$
a_P^{\text{new}} = a_P^0 - S_P V_P
$$
$$
b_P^{\text{new}} = b_P^0 + S_C V_P
$$

这个简单的代数推导揭示了线性化系数的直接影响：$S_P$ 修改了主对[角系数](@entry_id:149598) $a_P$，而 $S_C$ 则贡献给了源向量（右侧项）$b_P$。

### 稳定性的基石：Patankar 线性化法则

数值解的物理真实性和迭代过程的收敛性在很大程度上取决于离散方程组所构成的矩阵的性质。一个关键要求是解的**有界性**，即在没有源的情况下，解的[极值](@entry_id:145933)必须出现在计算域的边界上。这在数值上对应于**[离散最大值原理](@entry_id:748510)**。满足这一原理的一个充分条件是，系数矩阵是一个**M-矩阵**。对于典型的扩散问题，这意味着：
1.  对角元素为正 ($a_P > 0$)。
2.  非对角元素为负或零 ($-a_N \le 0$)。
3.  [对角占优](@entry_id:748380)，即对角元素大于或等于同行的非对角元素绝对值之和 ($a_P \ge \sum_N a_N$)。

在我们的离散方程中，来[自扩散](@entry_id:754665)项的系数 $a_N$ 和 $a_P^0 = \sum_N a_N$ 天然地满足这些条件。然而，源项的引入改变了对角系数 $a_P$。为了维持[对角占优](@entry_id:748380)，我们必须满足：

$$
a_P^{\text{new}} \ge \sum_N a_N \implies (a_P^0 - S_P V_P) \ge \sum_N a_N
$$

由于 $a_P^0 = \sum_N a_N$，这个不等式简化为：

$$
-S_P V_P \ge 0
$$

因为控制体积 $V_P$ 总是正的，这个不等式最终导出了[源项线性化](@entry_id:1131997)的黄金法则：

$$
S_P \le 0
$$

这条规则由 Suhas Patankar 提出，是确保数值稳定性的基石。

- 当 $S_P  0$ 时，项 $-S_P V_P$ 是正的。这会**增加**对角系数 $a_P$，从而**增强**[对角占优](@entry_id:748380)性。这使得数值格式更加稳定。
- 当 $S_P  0$ 时，项 $-S_P V_P$ 是负的。这会**减小**对[角系数](@entry_id:149598) $a_P$，从而**削弱**[对角占优](@entry_id:748380)性。如果 $S_P$ 足够大，甚至可能导致 $a_P$ 变为负值，这会严重违反M-矩阵的条件，几乎肯定会导致迭代发散或产生非物理的振荡解。

这个数学条件具有深刻的物理意义：
- **物理稳定的源项（汇）**：考虑一个散热过程，例如向环境的辐射冷却，其源项可以建模为 $S(T) = -\chi(T^4 - T_s^4)$。其导数 $\frac{dS}{dT} = -4\chi T^3$ 对于物理温度（[绝对温度](@entry_id:144687)）总是负的。这是一个负反馈过程：温度越高，散热越快。将这样的源项隐式处理，自然会得到 $S_P  0$，从而增强数值稳定性。
- **物理不稳定的源项（源）**：考虑一个放热化学反应，其[反应速率](@entry_id:185114)随温度升高而急剧增加，例如 $S(T) \propto \exp(-E_a/RT)$。在这里，$\frac{dS}{dT}  0$。这是一个正反馈过程：温度越高，产热越快。如果天真地将此源项隐式处理并取 $S_P = \frac{dS}{dT}  0$，就会破坏数值稳定性。

因此，一个鲁棒的数值方案必须在任何情况下都强制执行 $S_P \le 0$ 的规则。如果源项的物理特性导致 $\frac{dS}{dT}  0$，我们必须采用一种策略，将这部分“不稳定”的贡献从隐式项 $S_P$ 移到显式项 $S_C$ 中。最简单的方法是直接设置 $S_P = 0$，并将整个源项 $S(T)$ 显式处理。

我们可以通过一个简单的计算来量化对角优势的增强。定义[对角占优](@entry_id:748380)比 $r = a_P / (\sum_N a_N)$。如果 $S_P  0$，则 $a_P = \sum_N a_N - S_P V > \sum_N a_N$，因此 $r > 1$。例如，对于一个控制体积，如果 $\sum_N a_N = 500\,\mathrm{W\,K^{-1}}$，$V=10^{-4}\,\mathrm{m^{3}}$，并且一个稳定的[源项线性化](@entry_id:1131997)给出 $S_P = -2 \times 10^4\,\mathrm{W\,m^{-3}\,K^{-1}}$，那么更新后的对角系数为 $a_P = 500 - (-2 \times 10^4)(10^{-4}) = 500 + 2 = 502\,\mathrm{W\,K^{-1}}$。[对角占优](@entry_id:748380)比为 $r = 502/500 = 1.004$，清楚地表明了对角优势的增强。

### 实用线性化策略

在确定了 $S_P \le 0$ 的稳定准则后，我们现在探讨如何具体地构造 $S_C$ 和 $S_P$ 系数。

#### 策略一：Picard（定点）线性化

这是一种广泛使用的顺序方法。在求解第 $(m+1)$ 次迭代的温度场 $T^{(m+1)}$ 时，我们使用前一次迭代 $(m)$ 的已知温度场 $T^{(m)}$ 来计算线性化系数。

1.  **确定 $S_P$**：一种常见的选择是使用源项在 $T^{(m)}$ 处的导数，即 $S_P = \frac{dS}{dT}\big|_{T^{(m)}}$，但前提是这个值满足稳定性准则 $S_P \le 0$。如果 $\frac{dS}{dT}\big|_{T^{(m)}}  0$，为了保证鲁棒性，必须采取修正措施，例如直接设置 $S_P=0$。

2.  **确定 $S_C$**：一旦 $S_P$ 选定，我们通过要求线性化表达式在 $T^{(m)}$ 处是精确的来确定 $S_C$。这确保了迭代过程的一致性。
    $$
    S(T^{(m)}) = S_C + S_P T^{(m)}
    $$
    解出 $S_C$ 可得：
    $$
    S_C = S(T^{(m)}) - S_P T^{(m)}
    $$
    

例如，对于一个源项 $\mathcal{S}(\theta) = \theta^4 - 9\theta$，其导数为 $\frac{d\mathcal{S}}{d\theta} = 4\theta^3 - 9$。在当前迭代值为 $\theta^{(m)}=1$ 时，我们计算 $S_P = 4(1)^3 - 9 = -5$。这个值是负的，满足稳定性条件。然后我们计算 $\mathcal{S}(1) = 1^4 - 9(1) = -8$，并用它来求 $S_C = \mathcal{S}(1) - S_P \theta^{(m)} = -8 - (-5)(1) = -3$。

另一种等效的推导方法是使用一阶泰勒展开：

$$
S(T) \approx S(T^*) + \frac{dS}{dT}\big|_{T^*} (T - T^*)
$$

其中 $T^*$ 是线性化点（在 Picard 法中即为 $T^{(m)}$）。通过重新整理各项，我们可以得到 Patankar 形式：

$$
S(T) \approx \underbrace{\left( S(T^*) - \frac{dS}{dT}\big|_{T^*} T^* \right)}_{S_C} + \underbrace{\left( \frac{dS}{dT}\big|_{T^*} \right)}_{S_P} T
$$

这与前面的结果完全一致。

Picard 线性化的主要优点是其实现简单且全局鲁棒性较好（即从一个较差的初值猜测开始也能收敛）。它的缺点是[收敛速度](@entry_id:636873)通常是线性的，对于高度[非线性](@entry_id:637147)的问题可能收敛缓慢，并且常常需要配合欠松弛技术来保证收敛。

#### 策略二：牛顿（Newton）线性化

[牛顿法](@entry_id:140116)是一种更高级的策略，它旨在实现更快的收敛速度。该方法从方程的**残差形式**入手。对于节点 $P$，残差 $R_P$ 定义为当所有项都移到等式一侧时的表达式：

$$
R_P(T_P) = a_P^0 T_P - \sum_N a_N T_N - b_P(T_P) = 0
$$

其中源项被包含在 $b_P(T_P)$ 中。[牛顿法](@entry_id:140116)的核心思想是使用残差对未知数的一阶[泰勒展开](@entry_id:145057)来近似方程：

$$
R(T^{(m+1)}) \approx R(T^{(m)}) + \frac{dR}{dT}\bigg|_{T^{(m)}} (T^{(m+1)} - T^{(m)}) = 0
$$

这里的导数 $\frac{dR}{dT}$ 被称为**雅可比**（Jacobian）。求解 $T^{(m+1)}$ 的线性方程变为：

$$
J(T^{(m)}) \Delta T = -R(T^{(m)})
$$

其中 $J = \frac{dR}{dT}$ 是[雅可比矩阵](@entry_id:178326)，$\Delta T = T^{(m+1)} - T^{(m)}$ 是解的修正量。

源项 $S(T_P)$ 通过其导数对[雅可比矩阵](@entry_id:178326)做出贡献。对于上面定义的残差，源项的贡献是 $-\frac{d}{dT_P}(S(T_P)V_P) = - \frac{dS}{dT_P} V_P$。因此，与 Picard 法中 $S_P$ 贡献了 $-S_P V_P$ 给对角线类似，牛顿法中源项的贡献是 $-\frac{dS}{dT_P}V_P$。

牛顿法的主要优点是其在解附近的**二次[收敛速度](@entry_id:636873)**，这比 Picard 法的[线性收敛](@entry_id:163614)快得多。然而，它的缺点也很明显：
- **复杂性**：需要计算和组装[雅可比矩阵](@entry_id:178326)，这可能非常复杂，特别是当[输运性质](@entry_id:203130)（如[热导](@entry_id:189019)率）也依赖于温度时。
- **计算成本**：每一步迭代都需要求解一个结构可能与原始[扩散矩阵](@entry_id:182965)不同的线性系统。
- **鲁棒性**：牛顿法仅保证局部收敛。如果初始猜测不够接近真实解，它很容易发散。因此，它通常需要与[线搜索](@entry_id:141607)或信赖域等[全局化策略](@entry_id:177837)结合使用。

### 高级主题与细微差别

#### 瞬态问题中的稳定性

[源项线性化](@entry_id:1131997)原理同样适用于瞬态问题。考虑一个集总参数模型，其能量方程为 $\rho c_p \frac{dT}{dt} = S(T)$。使用一阶全隐式（后向欧拉）格式进行[时间离散化](@entry_id:169380)：

$$
\rho c_p \frac{T^{n+1} - T^n}{\Delta t} = S(T^{n+1}) \approx S_C + S_P T^{n+1}
$$

整理后，求解 $T^{n+1}$ 的方程的对角系数为：

$$
A_P = \frac{\rho c_p}{\Delta t} - S_P
$$

为了保证[数值稳定性](@entry_id:175146)（即避免解的无界增长），对[角系数](@entry_id:149598) $A_P$ 必须为正。
- 如果 $S_P \le 0$（稳定源项），则 $\frac{\rho c_p}{\Delta t} - S_P$ 总是正的。在这种情况下，[全隐式格式](@entry_id:1125373)是**无条件稳定**的，对时间步长 $\Delta t$ 没有限制。
- 如果 $S_P  0$（不稳定源项），则必须满足 $\frac{\rho c_p}{\Delta t}  S_P$，这导致了对时间步长的限制：
  $$
  \Delta t  \frac{\rho c_p}{S_P}
  $$
这表明，即使对于[隐式格式](@entry_id:166484)，物理不稳定的源项也会引入一个基于源项“刚度”的稳定性时间步长限制。源项对瞬态项的相对重要性可以用无量纲**刚度**度量 $\kappa_S = \left|\frac{S_P V}{\rho c_p V/\Delta t}\right|$ 来量化。

#### [线性求解器](@entry_id:751329)性能与刚度

在实践中，仅仅满足 $S_P \le 0$ 以确保有界性，并不足以保证高效的求解过程。当源项的导数 $|S_P|$ 非常大时，即使它是负的，也会带来新的挑战。这种情况被称为**刚性**（stiffness）。

在一个大型计算域中，如果[刚性源项](@entry_id:1132398)仅存在于少数几个单元中，那么线性系统矩阵 $\mathbf{A}$ 的对角线将会变得高度**异构**：少数几个对角元素会因为巨大的 $-S_P V_P$ 项而变得异常大。根据[盖尔圆](@entry_id:148950)盘定理，矩阵的[特征值分布](@entry_id:194746)在以对角元素为中心的圆盘内。高度异构的对角线会导致[特征值谱](@entry_id:1124216)的巨大扩展，即[最大特征值](@entry_id:1127078) $\lambda_{\max}$ 与[最小特征值](@entry_id:177333) $\lambda_{\min}$ 的比值变得非常大。这个比值，即**[条件数](@entry_id:145150)** $\kappa(\mathbf{A})$，是衡量[线性系统](@entry_id:147850)求解难度的关键指标。高条件数会严重拖慢诸如 GMRES 等[克雷洛夫子空间](@entry_id:751067)[迭代求解器](@entry_id:136910)的[收敛速度](@entry_id:636873)。

因此，先进的求解策略不仅要保证有界性，还要控制[线性系统](@entry_id:147850)的条件数。常用的策略包括：
1.  **源项限制（Clipping）**：对 $|S_P|$ 的大小设置一个上限，例如，限制其不超过扩散项系数的一定倍数。超出的部分被移至显式项 $S_C$ 中，并通过所谓的“延迟修正”来处理。这在保持 [M-矩阵](@entry_id:189121)性质的同时，有效地控制了对角线的异构性。
2.  **[伪瞬态延拓](@entry_id:753844)**：在[稳态](@entry_id:139253)问题的每次迭代中，人为地向对角线添加一个伪瞬态项 $\frac{\rho c_p V_P}{\Delta t}$。通过选择一个小的[伪时间](@entry_id:262363)步长 $\Delta t$，可以给所有对角元素增加一个大的、统一的正值，从而“淹没”由源项引起的异构性，显著改善[矩阵的条件数](@entry_id:150947)。

这些高级技术对于解决包含刚性化学反应或相变等复杂物理现象的挑战性问题至关重要。