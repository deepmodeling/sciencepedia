{
    "hands_on_practices": [
        {
            "introduction": "应用人造解方法的首要步骤是，从一个选定的人造“精确”解出发进行反向推导。本练习将引导你完成这个针对经典二维热传导问题的基本过程。通过计算使你的人造解成立所必需的源项和边界条件，你实际上是在创建一个完美的基准问题，用以测试你的数值代码。",
            "id": "3970243",
            "problem": "在静止各向同性介质中的稳态二维热传导问题中，能量守恒定律结合傅里叶定律可得到温度场的泊松型控制方程。考虑一个方形区域 $\\Omega=[0,1]\\times[0,1]$，其边界 $\\partial\\Omega$ 上的单位外法向量为 $\\boldsymbol{n}$。您将应用“人造解法”（Method of Manufactured Solutions, MMS），通过指定一个精确、光滑、非平凡的温度场 $T_{\\text{exact}}(x,y)$，以推导出所需的体积源项和一致的边界条件。\n\n首先，从控制体的稳态能量守恒基本陈述和热传导的傅里叶定律出发，推导在具有恒定热导率的各向同性介质中，存在体积源的稳态热传导控制方程的一般形式。然后，采用一种无量纲化方法，其中热导率被缩放为1，自变量 $x$ 和 $y$ 在区域 $\\Omega=[0,1]\\times[0,1]$ 上也已无量纲化，从而使得简化的控制方程呈现为带有源项 $S(x,y)$ 的标准泊松形式。\n\n构造精确温度场\n$$\nT_{\\text{exact}}(x,y)=\\sin(\\pi x)\\cos(2\\pi y),\n$$\n并确定：\n- 使 $T_{\\text{exact}}(x,y)$ 成为 $\\Omega$ 内部简化控制方程精确解的源项 $S(x,y)$，以及\n- 由该人造解所蕴含的 $\\partial\\Omega$ 上的一致狄利克雷边界数据。\n\n将您的最终结果以表达式对 $\\big[S(x,y),\\,T_b(x,y)\\big]$ 的形式给出，其中 $T_b(x,y)$ 表示在 $\\partial\\Omega$ 上规定的边界温度。无需进行数值四舍五入。在最终的方框答案中不要包含单位。",
            "solution": "用户提供了一个关于二维稳态热传导问题，需使用“人造解法”（MMS）来解决。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **物理系统：** 静止各向同性介质中的稳态二维热传导。\n- **区域：** 方形区域 $\\Omega=[0,1]\\times[0,1]$。\n- **边界：** $\\partial\\Omega$，单位外法向量为 $\\boldsymbol{n}$。\n- **方法论：** 人造解法 (MMS)。\n- **人造解：** 指定的精确温度场为 $T_{\\text{exact}}(x,y)=\\sin(\\pi x)\\cos(2\\pi y)$。\n- **控制物理学：**\n    1. 控制体的稳态能量守恒。\n    2. 热传导的傅里叶定律。\n- **假设/简化：**\n    1. 热导率 $k$ 是常数。\n    2. 系统经过无量纲化，使得热导率被缩放为1 ($k=1$)。\n    3. 自变量 $x$ 和 $y$ 是无量纲的。\n- **简化控制方程：** 方程采用标准泊松形式 $-\\nabla^2 T = S(x,y)$，其中 $S(x,y)$ 是源项。\n- **要求输出：**\n    1. 与 $T_{\\text{exact}}(x,y)$ 一致的源项 $S(x,y)$。\n    2. 由 $T_{\\text{exact}}(x,y)$ 蕴含的 $\\partial\\Omega$ 上的狄利克雷边界数据 $T_b(x,y)$。\n- **最终结果格式：** 表达式对 $[S(x,y), T_b(x,y)]$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于传热学原理，特别是能量守恒定律和傅里叶定律。“人造解法”是计算流体动力学和传热学中用于代码验证的一种标准而严谨的技术。其推导和应用基于成熟的数学物理学。该问题在科学上是合理的。\n- **适定性：** 该问题是适定的。它不是要求解给定边界条件的偏微分方程，而是要求解“逆问题”：给定一个解，求出它所满足的源项和边界条件。这是一个涉及微分和求值的直接计算，其结果是唯一、稳定且有意义的。\n- **客观性：** 该问题以精确、客观和数学化的术语陈述。没有歧义、主观性或偏见。\n\n**缺陷清单：**\n1.  **科学或事实不健全：** 无。所涉物理学和数学均为标准内容。\n2.  **无法形式化或不相关：** 该问题是MMS的一个教科书式范例，与所述主题直接相关。\n3.  **设置不完整或矛盾：** 提供了所有必要信息。没有矛盾之处。\n4.  **不切实际或不可行：** 该问题是一个用于验证目的的理论练习，并非特定物理现实的模型。在此背景下完全可行。\n5.  **不适定或结构不良：** 该问题结构良好，并能导出一个唯一答案。\n6.  **伪深刻、琐碎或同义反复：** 该问题需要对矢量微积分和偏微分方程有扎实的理解，是MMS技术的一个非平凡应用。\n7.  **超出科学可验证性：** 结果可通过数学推导和验证。\n\n**步骤3：结论与行动**\n问题有效。将提供一个完整且有理有据的解答。\n\n### 解答\n\n第一步是按照要求，从第一性原理推导控制微分方程。对于一个有热量生成但无做功或对流的稳态系统，能量守恒定律指出，从控制体传导出的净热量速率必须等于其内部产生的总热量速率。对于具有边界面 $\\partial V$ 的任意控制体 $V$，其积分形式为：\n$$\n-\\oint_{\\partial V} \\boldsymbol{q} \\cdot \\boldsymbol{n} \\, dA = \\int_V \\dot{q}''' \\, dV\n$$\n其中 $\\boldsymbol{q}$ 是热通量矢量，$\\boldsymbol{n}$ 是面元 $dA$ 的单位外法向量，$\\dot{q}'''$ 是单位体积的生热率。左侧的负号表示正（向外）通量对应于能量离开该体积。\n\n对面积分应用散度定理，将其转换为体积分：\n$$\n\\oint_{\\partial V} \\boldsymbol{q} \\cdot \\boldsymbol{n} \\, dA = \\int_V (\\nabla \\cdot \\boldsymbol{q}) \\, dV\n$$\n将此代入能量平衡方程得到：\n$$\n-\\int_V (\\nabla \\cdot \\boldsymbol{q}) \\, dV = \\int_V \\dot{q}''' \\, dV\n$$\n因为该等式必须对任意控制体 $V$ 成立，所以被积函数必须相等。这就得到了能量方程的微分形式：\n$$\n-\\nabla \\cdot \\boldsymbol{q} = \\dot{q}'''\n$$\n接下来，我们引入各向同性介质的热传导傅里叶定律：\n$$\n\\boldsymbol{q} = -k \\nabla T\n$$\n其中 $k$ 是热导率，$T$ 是温度场。将傅里叶定律代入能量方程，得到：\n$$\n-\\nabla \\cdot (-k \\nabla T) = \\dot{q}'''\n$$\n$$\n\\nabla \\cdot (k \\nabla T) = \\dot{q}'''\n$$\n正如问题所述，热导率 $k$ 是一个常数。因此，它可以从散度算子中提取出来：\n$$\nk \\nabla \\cdot (\\nabla T) = \\dot{q}'''\n$$\n$$\nk \\nabla^2 T = \\dot{q}'''\n$$\n其中 $\\nabla^2$ 是拉普拉斯算子。问题指定了一种无量纲化方案，其中热导率被缩放为1 ($k=1$)，方程被写成标准泊松形式 $-\\nabla^2 T = S(x,y)$。这意味着我们推导出的源项 $\\dot{q}'''$ 和无量纲源项 $S(x,y)$ 之间存在一种关系。重排我们推导的方程：\n$$\n-\\nabla^2 T = -\\frac{\\dot{q}'''}{k}\n$$\n将此与目标形式 $-\\nabla^2 T = S(x,y)$ 进行比较，并设 $k=1$，我们得到 $S(x,y) = -\\dot{q}'''$。因此，控制方程为：\n$$\n-\\nabla^2 T(x,y) = S(x,y)\n$$\n在二维笛卡尔坐标系中，该方程为：\n$$\n-\\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) = S(x,y)\n$$\n“人造解法”要求我们将指定的精确解 $T_{\\text{exact}}(x,y)$ 代入此控制方程，以找出使其成为解的源项 $S(x,y)$。\n人造解为：\n$$\nT_{\\text{exact}}(x,y) = \\sin(\\pi x)\\cos(2\\pi y)\n$$\n我们需要计算 $T_{\\text{exact}}$ 的拉普拉斯。首先，我们求其关于 $x$ 和 $y$ 的二阶偏导数。\n\n关于 $x$ 的导数：\n$$\n\\frac{\\partial T_{\\text{exact}}}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\sin(\\pi x)\\cos(2\\pi y) \\right] = \\pi\\cos(\\pi x)\\cos(2\\pi y)\n$$\n$$\n\\frac{\\partial^2 T_{\\text{exact}}}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left[ \\pi\\cos(\\pi x)\\cos(2\\pi y) \\right] = -\\pi^2\\sin(\\pi x)\\cos(2\\pi y)\n$$\n关于 $y$ 的导数：\n$$\n\\frac{\\partial T_{\\text{exact}}}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ \\sin(\\pi x)\\cos(2\\pi y) \\right] = -2\\pi\\sin(\\pi x)\\sin(2\\pi y)\n$$\n$$\n\\frac{\\partial^2 T_{\\text{exact}}}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left[ -2\\pi\\sin(\\pi x)\\sin(2\\pi y) \\right] = -4\\pi^2\\sin(\\pi x)\\cos(2\\pi y)\n$$\n源项 $S(x,y)$ 由 $S(x,y) = -\\nabla^2 T_{\\text{exact}} = -(\\frac{\\partial^2 T_{\\text{exact}}}{\\partial x^2} + \\frac{\\partial^2 T_{\\text{exact}}}{\\partial y^2})$ 给出。\n$$\nS(x,y) = -\\left[ (-\\pi^2\\sin(\\pi x)\\cos(2\\pi y)) + (-4\\pi^2\\sin(\\pi x)\\cos(2\\pi y)) \\right]\n$$\n$$\nS(x,y) = -\\left[ -5\\pi^2\\sin(\\pi x)\\cos(2\\pi y) \\right]\n$$\n$$\nS(x,y) = 5\\pi^2\\sin(\\pi x)\\cos(2\\pi y)\n$$\n这是第一个要求的表达式。\n\n第二个要求是确定区域边界 $\\partial\\Omega$ 上的一致狄利克雷边界数据 $T_b(x,y)$。这只需在边界上计算人造解 $T_{\\text{exact}}(x,y)$ 的值即可得到。因此，边界上温度的表达式与温度场的表达式相同，但其定义域被限制在点集 $(x,y) \\in \\partial\\Omega$ 上。\n正方形区域 $[0,1]\\times[0,1]$ 的边界 $\\partial\\Omega$ 由四条边组成：\n1.  底边：$y=0$，对于 $x \\in [0,1]$。$T_b(x,0) = \\sin(\\pi x)\\cos(0) = \\sin(\\pi x)$。\n2.  右边：$x=1$，对于 $y \\in [0,1]$。$T_b(1,y) = \\sin(\\pi)\\cos(2\\pi y) = 0$。\n3.  顶边：$y=1$，对于 $x \\in [0,1]$。$T_b(x,1) = \\sin(\\pi x)\\cos(2\\pi) = \\sin(\\pi x)$。\n4.  左边：$x=0$，对于 $y \\in [0,1]$。$T_b(0,y) = \\sin(0)\\cos(2\\pi y) = 0$。\n\n问题要求给出 $T_b(x,y)$ 的表达式。这个表达式就是原始的人造解 $T_{\\text{exact}}(x,y)$，然后在边界的具体坐标上进行求值。因此，定义边界温度的函数是：\n$$\nT_b(x,y) = \\sin(\\pi x)\\cos(2\\pi y) \\quad \\text{对于 } (x,y) \\in \\partial\\Omega\n$$\n最终结果是 $S(x,y)$ 和 $T_b(x,y)$ 的表达式对。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 5\\pi^2\\sin(\\pi x)\\cos(2\\pi y) \\\\ \\sin(\\pi x)\\cos(2\\pi y) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "对瞬态求解器的验证增加了一层复杂性，因为空间和时间离散误差都会影响总误差。一个设计粗糙的验证研究可能会混淆这两种误差，导致结果模棱两可。本练习将展示一个严谨的实验设计方案，它能够分离这些误差源，使你能够独立且明确地验证你的空间和时间离散格式的收敛阶。",
            "id": "3970201",
            "problem": "考虑一根长度为 $L=1$、具有恒定热扩散系数 $\\alpha0$ 的均匀杆中的一维瞬态热传导。对于一个密度 $\\rho$ 和比热容 $c$ 恒定的连续介质，其能量守恒定律导出的带源项的量纲形式热方程为 $\\rho c \\,\\partial T/\\partial t = k \\,\\partial^2 T/\\partial x^2 + q$，其中 $k$ 是热导率，$q$ 是体积生热率。定义热扩散系数 $\\alpha = k/(\\rho c)$ 和归一化源项 $S = q/(\\rho c)$，可得到如下无量纲的线性抛物型偏微分方程\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2} + S(x,t),\n$$\n该方程定义在 $x\\in[0,1]$ 和 $t\\in[0,t_f]$ 上。使用制造解方法（MMS），设制造解为\n$$\nT_{\\text{MMS}}(x,t) = e^{t}\\,\\sin(\\pi x).\n$$\n你将使用 $T_{\\text{MMS}}(x,t)$ 来确定一个相容的源项 $S(x,t)$、边界条件和初始条件，从而使 $T_{\\text{MMS}}$ 成为该连续问题的精确解。然后，考虑以下有限差分离散：一个间距为 $h = 1/N$（$N$ 为某个整数且 $N\\ge 4$）的均匀空间网格，以及一个时间步长为 $\\Delta t = t_f/M$（$M$ 为某个整数且 $M\\ge 4$）的均匀时间网格。时间上半隐式的后向欧拉格式结合空间上的二阶中心差分，其形式为\n$$\n\\frac{T_i^{n+1} - T_i^{n}}{\\Delta t} = \\alpha\\,\\frac{T_{i+1}^{n+1} - 2T_i^{n+1} + T_{i-1}^{n+1}}{h^2} + S_i^{n+1},\n$$\n适用于 $i=1,\\dots,N-1$，$n=0,\\dots,M-1$，并在 $i=0$ 和 $i=N$ 处带有适当的离散边界条件。这里 $T_i^{n}$ 表示对 $T(x_i,t^n)$ 的数值近似，而 $S_i^{n+1}$ 表示在 $(x_i,t^{n+1})$ 处取值的源项。\n\n从第一性原理（泰勒展开和格式的相容性）可知，后向欧拉法在时间上的局部截断误差为 $\\mathcal{O}(\\Delta t)$，二阶中心差分在空间上的局部截断误差为 $\\mathcal{O}(h^2)$。对于一个在固定有限时间区间 $[0,t_f]$ 上的线性问题，在离散格式稳定且 $T_{\\text{MMS}}$ 光滑的条件下，在 $t=t_f$ 时刻范数 $\\|\\cdot\\|$ 下的全局误差表现为\n$$\n\\|e(h,\\Delta t;t_f)\\| \\equiv \\|T_{\\text{num}}(\\cdot,t_f) - T_{\\text{MMS}}(\\cdot,t_f)\\| \\approx K_t\\,\\Delta t^{p_t} + K_x\\,h^{p_x},\n$$\n其中时间阶 $p_t=1$，空间阶 $p_x=2$，而 $K_t,K_x0$ 是与问题和范数相关的常数。\n\n你的任务是从以下选项中，选出唯一一个能够正确且严谨地使用MMS方法对此瞬态问题分离时间和空间离散误差，并得出可靠的时间和空间收敛阶估计值的方案。一个有效的方案必须：\n- 指明与 $T_{\\text{MMS}}(x,t)$ 相容的源项 $S(x,t)$、边界条件和初始条件。\n- 定义在 $t=t_f$ 时的误差范数，并说明如何使用精确的制造解来计算它。\n- 描述两种加密研究：(i) 在固定网格下进行时间步长加密，以分离时间误差并估计 $p_t$；(ii) 在固定时间步长下进行网格加密，以分离空间误差并估计 $p_x$。\n- 论证每种加密研究如何确保非目标误差的贡献可以忽略不计，并提供根据连续加密数据估计 $p_t$ 和 $p_x$ 的正确表达式。\n\n选择唯一的最佳选项。\n\nA. 选择 $T_{\\text{MMS}}(x,t)=e^{t}\\sin(\\pi x)$。通过将 $T_{\\text{MMS}}$ 代入偏微分方程来计算 $S(x,t)$，对所有 $t\\in[0,t_f]$ 施加狄利克雷边界条件 $T(0,t)=T(1,t)=0$，以及初始条件 $T(x,0)=\\sin(\\pi x)$。将最终时刻的误差范数定义为\n$$\n\\|e(h,\\Delta t;t_f)\\|_{2,h} = \\left(h\\sum_{i=0}^{N} \\bigl(T_i^{M}-T_{\\text{MMS}}(x_i,t_f)\\bigr)^2\\right)^{1/2}.\n$$\n时间研究：固定一个足够精细的网格 $h=h_\\star$，使得对于所使用的最大 $\\Delta t$ 来说，$K_x h_\\star^{2}\\ll K_t \\Delta t$；通过检查 $\\Delta t$ 的连续加密是否使误差改变一个接近于 $r^{p_t}$ 的因子来验证时间上的渐进行为，其中时间步长序列为等比序列 $\\Delta t,\\Delta t/r,\\Delta t/r^2$ 且 $r1$（例如，$r=2$）。通过以下公式估计时间阶：\n$$\np_t \\approx \\frac{\\ln\\bigl(\\|e(h_\\star,\\Delta t;t_f)\\|_{2,h} / \\|e(h_\\star,\\Delta t/r;t_f)\\|_{2,h}\\bigr)}{\\ln(r)}.\n$$\n空间研究：固定一个足够小的时间步长 $\\Delta t=\\Delta t_\\star$，使得对于所使用的最大 $h$ 来说，$K_t \\Delta t_\\star\\ll K_x h^{2}$；通过检查 $h$ 的连续加密是否使误差改变一个接近于 $r^{p_x}$ 的因子来验证空间上的渐进行为，其中网格序列为等比序列 $h,h/r,h/r^2$ 且 $r1$（例如，$r=2$）。通过以下公式估计空间阶：\n$$\np_x \\approx \\frac{\\ln\\bigl(\\|e(h,\\Delta t_\\star;t_f)\\|_{2,h} / \\|e(h/r,\\Delta t_\\star;t_f)\\|_{2,h/r}\\bigr)}{\\ln(r)}.\n$$\n在两项研究中，都使用精确的 $T_{\\text{MMS}}$ 来计算 $\\|e(\\cdot,\\cdot;t_f)\\|$，并通过观察在进一步加密非目标离散化参数时，估计的非目标阶出现的平台行为，来验证非目标的贡献是可忽略的。\n\nB. 选择 $T_{\\text{MMS}}(x,t)=e^{t}\\sin(\\pi x)$ 以及相容的源项 $S$、边界和初始条件。进行同步加密，通过 $\\Delta t=\\lambda h^2$（对于某个固定的 $\\lambda0$）将 $\\Delta t$ 与 $h$ 关联起来，从而使无量纲群 $\\alpha\\Delta t/h^2$ 保持恒定。当 $h\\to 0$ 时，通过 $\\|e(h,\\Delta t;t_f)\\|$ 相对于 $h$ 的单个对数-对数图的斜率来估计时间和空间阶，使用\n$$\np_t \\approx \\frac{\\partial \\ln\\|e\\|}{\\partial \\ln(\\Delta t)},\\quad p_x \\approx \\frac{\\partial \\ln\\|e\\|}{\\partial \\ln(h)}.\n$$\n不需要额外的检查，因为保持 $\\alpha\\Delta t/h^2$ 恒定可以保证稳定性并同时分离两种误差。\n\nC. 选择 $T_{\\text{MMS}}(x,t)=e^{t}\\sin(\\pi x)$ 以及相容的源项 $S$、边界和初始条件。为了估计时间阶，使用一个粗网格 $h=h_{\\text{coarse}}$ 并只加密 $\\Delta t$，用两个时间步长值将 $\\|e(h_{\\text{coarse}},\\Delta t;t_f)\\|$ 拟合到 $C_t\\Delta t^{p_t}+C_x h_{\\text{coarse}}^{p_x}$ 以求出 $C_t$ 和 $p_t$。为了估计空间阶，使用一个大的时间步长 $\\Delta t=\\Delta t_{\\text{large}}$ 并只加密 $h$，用两个网格尺寸将 $\\|e(h,\\Delta t_{\\text{large}};t_f)\\|$ 拟合到 $C_t\\Delta t_{\\text{large}}^{p_t}+C_x h^{p_x}$ 以求出 $C_x$ 和 $p_x$。因为这个两项模型对未知数是线性的，所以每次拟合两个数据点就足够了。\n\nD. 选择 $T_{\\text{MMS}}(x,t)=e^{t}\\sin(\\pi x)$ 以及相容的源项 $S$、边界和初始条件。不使用精确解来计算解的误差，而是计算在 $t=t_f$ 时的离散残差，\n$$\nR_i = \\frac{T_i^{M} - T_i^{M-1}}{\\Delta t} - \\alpha\\,\\frac{T_{i+1}^{M} - 2T_i^{M} + T_{i-1}^{M}}{h^2} - S_i^{M},\n$$\n并通过以比率 r 同时加密 $\\Delta t$ 和 $h$ 来估计阶数，使用\n$$\np_t \\approx \\frac{\\ln\\bigl(\\|R(h,\\Delta t)\\|_{2,h} / \\|R(h,\\Delta t/r)\\|_{2,h}\\bigr)}{\\ln(r)},\\quad\np_x \\approx \\frac{\\ln\\bigl(\\|R(h,\\Delta t)\\|_{2,h} / \\|R(h/r,\\Delta t)\\|_{2,h/r}\\bigr)}{\\ln(r)}.\n$$\n基于残差的估计更可取，因为残差在离散解处为零，这直接反映了离散误差，而无需精确解。",
            "solution": "该问题陈述是有效的。它描述了制造解方法（MMS）在验证一个抛物型偏微分方程数值格式精度阶方面的标准应用。控制方程、制造解、数值方法和误差模型在数值分析和计算传热学领域都是标准且明确定义的。该问题是自洽的、有科学依据且客观的。\n\n在评估选项之前，我们必须首先推导与制造解 $T_{\\text{MMS}}(x,t) = e^{t}\\,\\sin(\\pi x)$ 以及控制方程 $\\frac{\\partial T}{\\partial t} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2} + S(x,t)$ 相容的源项、边界条件和初始条件。\n\n源项 $S(x,t)$ 是通过重新整理偏微分方程并代入 $T_{\\text{MMS}}$ 来确定的：\n$$ S(x,t) = \\frac{\\partial T_{\\text{MMS}}}{\\partial t} - \\alpha\\,\\frac{\\partial^2 T_{\\text{MMS}}}{\\partial x^2} $$\n我们计算 $T_{\\text{MMS}}$ 的必要导数：\n$$ \\frac{\\partial T_{\\text{MMS}}}{\\partial t} = \\frac{\\partial}{\\partial t}\\left(e^{t}\\,\\sin(\\pi x)\\right) = e^{t}\\,\\sin(\\pi x) $$\n$$ \\frac{\\partial T_{\\text{MMS}}}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(e^{t}\\,\\sin(\\pi x)\\right) = \\pi e^{t}\\,\\cos(\\pi x) $$\n$$ \\frac{\\partial^2 T_{\\text{MMS}}}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(\\pi e^{t}\\,\\cos(\\pi x)\\right) = -\\pi^2 e^{t}\\,\\sin(\\pi x) $$\n将这些代入 $S(x,t)$ 的表达式中：\n$$ S(x,t) = e^{t}\\,\\sin(\\pi x) - \\alpha(-\\pi^2 e^{t}\\,\\sin(\\pi x)) = (1 + \\alpha\\pi^2)e^{t}\\,\\sin(\\pi x) $$\n边界条件通过在 $x=0$ 和 $x=1$ 处计算 $T_{\\text{MMS}}$ 的值得到：\n$$ T(0,t) = T_{\\text{MMS}}(0,t) = e^{t}\\,\\sin(0) = 0 $$\n$$ T(1,t) = T_{\\text{MMS}}(1,t) = e^{t}\\,\\sin(\\pi) = 0 $$\n这些是齐次狄利克雷边界条件。\n初始条件通过在 $t=0$ 处计算 $T_{\\text{MMS}}$ 的值得到：\n$$ T(x,0) = T_{\\text{MMS}}(x,0) = e^{0}\\,\\sin(\\pi x) = \\sin(\\pi x) $$\n任何有效的MMS方案都必须使用此源项、这些边界条件和此初始条件。所有选项都正确地指出应使用这些相容的项。\n\n核心任务是从渐进误差模型 $\\|e(h,\\Delta t;t_f)\\| \\approx K_t\\,\\Delta t^{p_t} + K_x\\,h^{p_x}$ 中验证收敛阶 $p_t=1$ 和 $p_x=2$。一个严谨的方案必须分离这两个误差项。为了测量时间误差贡献 $K_t\\,\\Delta t^{p_t}$，空间误差贡献 $K_x\\,h^{p_x}$ 必须变得可以忽略不计。反之，为了测量空间误差，时间误差必须变得可以忽略不计。\n\n现在，我们评估每个选项。\n\n**选项 A 的分析**\n该选项正确地阐述了分离离散误差的标准、严谨的程序。\n1.  **MMS设置**：它正确地指明了上面推导出的边界和初始条件，并说明必须计算相容的源项，这是正确的。\n2.  **误差范数**：它定义了一个离散 $L_2$ 范数，$\\|e(h,\\Delta t;t_f)\\|_{2,h} = \\left(h\\sum_{i=0}^{N} \\bigl(T_i^{M}-T_{\\text{MMS}}(x_i,t_f)\\bigr)^2\\right)^{1/2}$。这是在最终时刻测量全局解误差的一种正确且标准的方法。\n3.  **时间研究**：它提议固定一个“足够精细的网格 $h=h_\\star$”以确保空间误差 $K_x h_\\star^{2}$ 与时间误差 $K_t \\Delta t$ 相比可以忽略不计。这是正确的误差分离原则。然后它使用一系列加密的时间步长，并应用正确的公式来估计 $p_t$：$p_t \\approx \\frac{\\ln\\bigl(\\|e_1\\| / \\|e_2\\|\\bigr)}{\\ln(r)}$，其中 $r$ 是加密比。\n4.  **空间研究**：类似地，它提议固定一个“足够小的时间步长 $\\Delta t=\\Delta t_\\star$”以确保时间误差 $K_t \\Delta t_\\star$ 与空间误差 $K_x h^{2}$ 相比可以忽略不计。这同样是正确的原则。然后它使用一系列加密的网格，并应用正确的公式来计算 $p_x$。它还正确地注意到范数的定义随 $h$ 而改变，即 $\\|e\\|_{2,h}$ 与 $\\|e\\|_{2,h/r}$。\n5.  **严谨性**：它包括了关键的一步，即通过观察在进一步加密非目标离散化参数时，估计的收敛阶所呈现的平台行为，来验证非目标误差确实可以忽略不计。这表明了对该方法实际应用的全面理解。\n该方案在各方面都是合理的。\n\n**结论：正确**\n\n**选项 B 的分析**\n该选项提出了一种同步加密策略，其中 $\\Delta t = \\lambda h^2$（$\\lambda$ 为常数）。全局误差模型变为：\n$$ \\|e\\| \\approx K_t \\Delta t^{p_t} + K_x h^{p_x} = K_t (\\lambda h^2)^{p_t} + K_x h^{p_x} $$\n对于已知的阶数 $p_t=1$ 和 $p_x=2$，这简化为：\n$$ \\|e\\| \\approx K_t (\\lambda h^2) + K_x h^2 = (K_t \\lambda + K_x)h^2 $$\n这意味着总误差将以 $\\mathcal{O}(h^2)$ 的速度收敛。这种加密路径允许估计*整体*的精度阶（在这种情况下是2）。然而，它完全混淆了时间和空间的贡献。这两项被合并成一个与 $h^2$ 成正比的单项，无法从这项单一的研究中分别估计 $p_t$ 和 $p_x$。声称这种方法可以分离两种误差是错误的。所提出的通过偏导数提取 $p_t$ 和 $p_x$ 的方法在数学上是无效的，因为在这条加密路径上 $\\ln(\\Delta t)$ 和 $\\ln(h)$ 不是独立的变量。\n\n**结论：不正确**\n\n**选项 C 的分析**\n该选项提议将误差数据拟合到两项模型 $\\|e\\| \\approx C_t\\Delta t^{p_t} + C_x h^{p_x}$。其根本缺陷在于其提议的执行方式。对于时间研究，它建议使用*粗*网格 $h=h_{\\text{coarse}}$。这恰恰与要求相反；粗网格会确保空间误差项 $C_x h_{\\text{coarse}}^{p_x}$ *很大*，从而污染对时间误差的测量。对于空间研究，它犯了同样的逻辑错误，提议使用一个*大*的时间步长 $\\Delta t=\\Delta t_{\\text{large}}$。此外，声称两个数据点足以进行拟合是不正确的。要从模型 $E_j = C_t(\\Delta t_j)^{p_t} + K$（其中 $K=C_x h_{\\text{coarse}}^{p_x}$ 是一个未知的常数）中求解未知数 $C_t$ 和 $p_t$，至少需要三个数据点，即便如此，除非其中一项明显占主导地位，否则这种非线性拟合通常是不稳定和不可靠的。该方案在概念上存在缺陷且不切实际。\n\n**结论：不正确**\n\n**选项 D 的分析**\n该选项提议测量离散残差的收敛性，定义为 $R_i = \\frac{T_i^{M} - T_i^{M-1}}{\\Delta t} - \\alpha\\,\\frac{T_{i+1}^{M} - 2T_i^{M} + T_{i-1}^{M}}{h^2} - S_i^{M}$。这个量是在*数值解* $(T_i^M)$ 处计算的离散方程的残差。根据定义，数值解是使该残差等于零（对于迭代求解器则是机器精度）的一组值。因此，测量 $R_i$ 的范数是无意义的，因为它将始终接近于零，与离散化无关。反映离散误差的量是*局部截断误差*（LTE），它是将*精确制造解* $T_\\text{MMS}$ 代入离散算子得到的残差。虽然分析LTE的收敛性是一种有效的验证测试，但它验证的是局部误差的阶数，而不是全局解的误差。该选项从根本上混淆了离散残差和LTE，并提议测量一个根据定义就为零的量。所提供的理由同样混乱。\n\n**结论：不正确**\n\n基于此分析，选项A是唯一在方法论上合理、严谨且描述正确的方案。它遵循了使用制造解方法进行代码验证的既定最佳实践。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "MMS 测试并非总能按计划进行；有时，观测到的收敛阶会与理论阶不符。这并非方法的失败，而是一个诊断问题的良机。最后的这个练习将挑战你扮演一名计算侦探，分析几种观测结果偏离预期的场景，并找出其根本原因——无论是解的光滑性不足还是边界处理存在缺陷——从而磨练你关键的故障排查技能。",
            "id": "3970217",
            "problem": "一位研究人员正在执行“人造解方法”（Method of Manufactured Solutions, MMS）来验证一个用于稳态热传导的一维有限体积求解器。其控制方程是具有空间变化热导率的稳态扩散方程，\n$$\n- \\frac{d}{dx}\\left(k(x)\\frac{dT}{dx}\\right) = f(x), \\quad x \\in [0,1],\n$$\n边界条件由人造解决定，可以是狄利克雷（Dirichlet）或诺伊曼（Neumann）边界条件。离散格式是一种在间距为 $h$ 的均匀网格上的保守、二阶、中心有限体积方法，通量位于面心，并对 $k(x)$ 使用调和插值。边界条件以常规方式施加（对于狄利克雷边界，将边界未知数设置为指定值；对于诺伊曼边界，使用与离散模板一致的单边面通量）。研究人员构建了人造解 $T_{\\text{exact}}(x)$，从控制方程中推导出 $f(x)$，并应用从 $T_{\\text{exact}}(x)$ 获得的边界数据。\n\n研究人员在以下几种情景下重复进行MMS实验：\n\n- 情景 I：$k(x)$ 光滑且严格为正，$T_{\\text{exact}}(x) = \\sin(\\pi x)$，狄利克雷边界取自 $T_{\\text{exact}}(x)$。测得的实验收敛阶（Experimental Order of Convergence, EOC）$p_{\\text{obs}}$，由下式计算\n$$\np_{\\text{obs}} = \\frac{\\log\\left(E(h)/E(h/2)\\right)}{\\log(2)},\n$$\n其中 $E(h)$ 是在尺寸为 $h$ 的网格上离散解与 $T_{\\text{exact}}$ 之间的误差范数，其值约为 $2$。\n\n- 情景 II：与情景 I 相同，但 $T_{\\text{exact}}(x) = |x - 0.35| + \\sin(6\\pi x)/20$，狄利克雷边界取自 $T_{\\text{exact}}(x)$。在很宽的 $h$ 范围内，测得的 $p_{\\text{obs}}$ 约为 $1$。\n\n- 情景 III：与情景 I 相同，但在 $x=0$ 处施加一个从 $T_{\\text{exact}}(x)$ 推导出的诺伊曼边界，并在 $x=1$ 处保留狄利克雷边界。诺伊曼导数在边界上使用单边一阶近似进行离散化。测得的 $p_{\\text{obs}}$ 约为 $1.3$。\n\n- 情景 IV：与情景 I 相同，但 $T_{\\text{exact}}(x) = \\sin(\\omega x)$，其中频率 $\\omega$ 很大，且 $h$ 不够小以解析振荡（即 $\\omega h$ 不满足 $\\ll 1$）。在粗网格上测得的 $p_{\\text{obs}}$ 小于 $2$，但在加密到非常小的 $h$ 时，该值趋向于 $2$。\n\n- 情景 V：与情景 I 相同，但在代码中，$f(x)$ 是由一个略有不同的表达式计算得出的，由于一个符号错误，该表达式不对应于 $- \\frac{d}{dx}\\left(k(x)\\frac{dT_{\\text{exact}}}{dx}\\right)$。测得的 $p_{\\text{obs}}$ 未达到 $2$ 且随 $h$ 不规则变化。\n\n基于人造解方法背后的一般理论以及中心二阶格式的截断误差结构，通过检查实现细节、$T_{\\text{exact}}(x)$ 的光滑性以及边界条件的一致性，以下哪些陈述最能描述如何解释和诊断观测阶数与期望阶数之间的差异？\n\nA. 如果 $T_{\\text{exact}}(x)$ 对于内部模板的截断误差展开不够光滑（对于中心二阶方法，这涉及到有界高阶导数，如 $T^{(4)}$），那么观测阶数合理地可能低于 $2$；检查是否存在拐点、导数不连续或相对于 $h$ 的高频成分。\n\nB. 只要内部格式是二阶的，边界条件就不会影响观测阶数，因此在诊断阶数差异时无需检查边界条件的实现。\n\nC. 使用低阶单边差分进行离散化的诺伊曼或罗宾边界条件，或在与内部模板不一致的位置进行求值，可能会主导全局误差并降低观测阶数；验证边界数据是否从 $T_{\\text{exact}}(x)$ 推导而来，以及边界离散化是否与内部阶数匹配。\n\nD. 实现细节，如计算错误的 $f(x)$ 或指定错误的 $k(x)$，如果它们与人造解 $T_{\\text{exact}}(x)$ 不完全对应，会改变代码所求解的连续问题，并可能导致明显的阶数降低；确认代码中的代数一致性和求值点。\n\nE. 仅误差范数的选择就可以解释阶数差异；将最大范数切换到能量范数将在不改变求解器、人造解或边界处理的情况下恢复预期阶数。\n\n选择所有适用项。",
            "solution": "问题陈述描述了使用人造解方法（MMS）进行的一系列数值实验，以验证一个一维有限体积求解器。必须根据数值分析和代码验证的基本原则来评估问题陈述的有效性以及相关选项的正确性。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n\n*   **控制方程：** $- \\frac{d}{dx}\\left(k(x)\\frac{dT}{dx}\\right) = f(x)$，对于 $x \\in [0,1]$。\n*   **数值离散化：** 在间距为 $h$ 的均匀网格上的保守、二阶、中心有限体积方法。通量位于面心，并对 $k(x)$ 使用调和插值。\n*   **方法论：** 人造解方法（MMS）。\n*   **收敛阶（EOC）计算：** $p_{\\text{obs}} = \\frac{\\log\\left(E(h)/E(h/2)\\right)}{\\log(2)}$。\n*   **情景 I：** 光滑的 $k(x)0$，$T_{\\text{exact}}(x) = \\sin(\\pi x)$，狄利克雷边界条件。结果：$p_{\\text{obs}} \\approx 2$。\n*   **情景 II：** 与 I 相同，但 $T_{\\text{exact}}(x) = |x - 0.35| + \\sin(6\\pi x)/20$。结果：$p_{\\text{obs}} \\approx 1$。\n*   **情景 III：** 与 I 相同，但在 $x=0$ 处使用一阶近似离散化的诺伊曼边界条件。结果：$p_{\\text{obs}} \\approx 1.3$。\n*   **情景 IV：** 与 I 相同，但 $T_{\\text{exact}}(x) = \\sin(\\omega x)$，其中 $\\omega$ 很大，且网格未解析（$\\omega h$ 不满足 $\\ll 1$）。结果：在粗网格上 $p_{\\text{obs}}  2$，在细网格上趋近于 $2$。\n*   **情景 V：** 与 I 相同，但 $f(x)$ 的实现有误。结果：$p_{\\text{obs}}$ 未达到 $2$ 且不规则变化。\n*   **问题：** 找出最能描述如何解释和诊断观测收敛阶与期望收敛阶之间差异的陈述。\n\n**步骤2：使用提取的已知信息进行验证**\n\n问题陈述具有科学依据，提法恰当且客观。它植根于计算科学中验证数值求解器正确性的标准实践。\n1.  **科学合理性：** 控制方程是标准的稳态扩散方程。所描述的数值方法是常见的二阶有限体积格式。MMS 是代码验证的基石技术。所描述的情景及其结果（例如，由于非光滑解、低阶边界条件或实现错误导致的阶数降低）都与已建立的数值分析理论一致。\n2.  **提法恰当与完整性：** 问题是自洽的。它提供了所有必要的背景：方程、数值格式、验证方法以及一组定义明确的测试案例及其结果。问题要求基于一般原则对这些结果进行解释，这是一个有效的概念性问题。\n3.  **一致性：** 这些情景是 MMS 中常见陷阱和诊断案例的教科书式例子。在给定条件下，每种情况下观测到的收敛阶都是一个合理且预期的结果。例如，光滑解产生理论阶数（情景 I），导数不连续的解降低了阶数（情景 II），一阶边界条件限制了全局阶数（情景 III），未解析的解显示了前渐近行为（情景 IV），而问题设置中的一个基本错误使收敛性测试无效（情景 V）。\n\n**步骤3：结论与行动**\n\n问题陈述是有效的。它提出了一套连贯且理论上合理的情景，用以评估对人造解方法的理解。对选项进行全面分析是必要的。\n\n### 解答与选项分析\n\n数值方法的理论收敛阶源于局部截断误差，该误差通过将精确解代入离散方程得到。对于一个二阶格式，局部截断误差 $\\tau$ 的形式为 $\\tau = C h^2 + O(h^3)$，其中 $C$ 是一个常数，取决于精确解的高阶导数（例如，对于此问题是 $T^{(4)}(x)$）和问题系数（例如，$k(x)$）。要使全局误差为 $O(h^2)$，必须满足几个条件：\n1.  精确解必须足够光滑，以使用于推导 $\\tau$ 的泰勒级数展开有效，并使系数 $C$ 有界。\n2.  离散化必须在整个域（包括边界）内保持一致的二阶精度。\n3.  MMS 测试本身必须正确实现，即代码中使用的源项 $f(x)$ 和边界条件必须精确地从所选的 $T_{\\text{exact}}(x)$ 推导出来。\n4.  分析必须在渐近区进行，其中 $h$ 足够小，以使误差的主导项占主导地位。\n\n我们现在根据这些原则和所提供的情景来评估每个选项。\n\n**A. 如果 $T_{\\text{exact}}(x)$ 对于内部模板的截断误差展开不够光滑（对于中心二阶方法，这涉及到有界高阶导数，如 $T^{(4)}$），那么观测阶数合理地可能低于 $2$；检查是否存在拐点、导数不连续或相对于 $h$ 的高频成分。**\n\n*   **分析：** 这个陈述是正确的。二阶截断误差 $\\tau \\propto h^2$ 的推导要求精确解 $T(x)$ 拥有有界高阶导数（对于此中心格式的扩散方程，具体需要到四阶导数）。情景 II 提供了一个直接的例子，$T_{\\text{exact}}(x) = |x - 0.35| + \\dots$。绝对值函数在 $x=0.35$ 处有一个连续的一阶导数不连续点（一个“拐点”），其二阶导数是一个奇异分布（狄拉克δ函数），其更高阶导数在经典意义上没有定义或无界。这种对光滑性假设的违反破坏了 $O(h^2)$ 误差估计的基础，导致观测收敛阶的降低，本例中降至 $p_{\\text{obs}} \\approx 1$。检查此类特征的建议是合理的诊断实践。提及“相对于 $h$ 的高频成分”正确地暗示了情景 IV 中看到的前渐近效应，在该情景中，尽管 $T_{\\text{exact}}$ 是光滑的，但其导数很大，只有在 $h$ 非常小时才能观察到 $h^2$ 的行为。\n*   **结论：正确**。\n\n**B. 只要内部格式是二阶的，边界条件就不会影响观测阶数，因此在诊断阶数差异时无需检查边界条件的实现。**\n\n*   **分析：** 这个陈述是根本错误的。微分方程数值方法分析中一个公认的原则是，全局精度阶数受限于离散化中任何位置（包括边界条件）的最低精度阶数。情景 III 直接驳斥了这一说法。一个 $O(h^2)$ 的内部格式与一个 $O(h)$ 的诺伊曼边界条件配对，结果观测到的全局阶数 $p_{\\text{obs}}$ 约为 $1.3$，远低于 $2$。由低阶边界格式引入的误差会污染整个域的解。因此，在任何验证程序中，检查边界条件的实现都是一个关键步骤。\n*   **结论：错误**。\n\n**C. 使用低阶单边差分进行离散化的诺伊曼或罗宾边界条件，或在与内部模板不一致的位置进行求值，可能会主导全局误差并降低观测阶数；验证边界数据是否从 $T_{\\text{exact}}(x)$ 推导而来，以及边界离散化是否与内部阶数匹配。**\n\n*   **分析：** 这个陈述是与选项 B 相矛盾的正确原则。它准确地描述了情景 III 中的现象。一个局部截断误差为 $O(h^p)$ 的边界格式，通常会将全局精度阶数限制在最多为 $p$，即使内部格式的阶数更高。为了充分发挥高阶内部格式的潜力，边界离散化的阶数必须至少与内部格式相同。该陈述正确地指出了低阶边界格式是阶数降低的主要原因，并提供了正确的诊断建议：确保边界格式的阶数与内部格式的阶数一致。\n*   **结论：正确**。\n\n**D. 实现细节，如计算错误的 $f(x)$ 或指定错误的 $k(x)$，如果它们与人造解 $T_{\\text{exact}}(x)$ 不完全对应，会改变代码所求解的连续问题，并可能导致明显的阶数降低；确认代码中的代数一致性和求值点。**\n\n*   **分析：** 这个陈述是正确的。MMS 的整个前提是，人造解 $T_{\\text{exact}}$ 是代码正在求解的离散化版本的*连续*问题的精确解。如果代码中的源项 $f(x)$ 或系数 $k(x)$ 与从 $T_{\\text{exact}}$ 推导出的不匹配，即 $f_{\\text{code}}(x) \\neq - \\frac{d}{dx}\\left(k_{\\text{code}}(x)\\frac{dT_{\\text{exact}}}{dx}\\right)$，那么代码求解的问题的解就不是 $T_{\\text{exact}}$。在这种情况下，数值解 $T_h$ 和 $T_{\\text{exact}}$ 之间的差异不是随 $h \\to 0$ 而消失的离散化误差。相反，它是求解错误问题所产生的误差，这是一个 $O(1)$ 的量。如情景 V 所述，这会导致一个不会随着网格加密而系统性减小的误差，从而产生一个不规则且无意义的 $p_{\\text{obs}}$。验证所实现的源项和系数的代数一致性是调试 MMS 测试的一个基本步骤。\n*   **结论：正确**。\n\n**E. 仅误差范数的选择就可以解释阶数差异；将最大范数切换到能量范数将在不改变求解器、人造解或边界处理的情况下恢复预期阶数。**\n\n*   **分析：** 这个陈述是错误的。虽然观测到的 EOC 的具体值有时会随着范数的选择（例如，$L_1$, $L_2$, $L_\\infty$）而略有变化，但改变范数无法修复问题设置或数值方法中的根本性缺陷。例如，在情景 II（非光滑解）或情景 III（低阶边界条件）中，收敛阶在*任何*标准范数下都会降低。在情景 V（错误的源项）中，误差根本不收敛到 $0$，因此没有范数会显示正确的阶数。范数是衡量误差的工具，而不是可以纠正误差的参数。声称它将“在不做任何改变的情况下恢复预期阶数”是错误的。\n*   **结论：错误**。",
            "answer": "$$\\boxed{ACD}$$"
        }
    ]
}