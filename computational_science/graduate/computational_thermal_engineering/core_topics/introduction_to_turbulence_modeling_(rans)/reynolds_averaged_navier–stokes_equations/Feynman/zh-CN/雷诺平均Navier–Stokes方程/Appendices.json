{
    "hands_on_practices": [
        {
            "introduction": "精确预测壁面束缚的湍流是 RANS 模型的一个核心应用，其成败关键在于如何正确处理近壁区域。本练习将通过计算和分析，阐明网格策略（尤其是第一个网格节点的位置）与低雷诺数湍流模型有效性之间的重要联系。通过这个实践，你将深刻理解为何将第一个网格中心放置在 $y^+ \\approx 1$ 处是保证模型物理一致性和预测精度的关键所在。",
            "id": "3982991",
            "problem": "一个计算热工学团队正在准备对光滑等温平板上充分发展的湍流与传热进行雷诺平均纳维-斯托克斯 (RANS) 模拟。该流动是不可压缩的，且物性恒定。\n\n正在考虑近壁区模拟策略：一种是解析粘性子层的低雷诺数方法，另一种是使用壁面函数的高雷诺数方法。第一个网格单元中心相对于壁面的位置（以壁面单位衡量）已知会影响所选模拟策略的有效性以及近壁区热学预测的准确性。\n\n从支撑湍流壁面标度的基本定义出发，解释在使用低雷诺数 RANS 模型进行动量和能量耦合输运模拟时，将第一个离壁网格单元中心放置在 $y^{+}\\approx 30$ 与 $y^{+}\\approx 1$ 处的实际影响。您的解释应将 $y^{+}$ 的选择与所解析的物理分层、模型一致性以及在预测壁面剪切应力和壁面热通量方面的预期准确性联系起来。\n\n然后，对于一个计划中的网格，在给定摩擦速度 $u_{\\tau}=0.4$ $\\mathrm{m/s}$ 和运动粘度 $\\nu=1.6\\times 10^{-5}$ $\\mathrm{m^2/s}$ 的条件下，计算从壁面到第一个网格单元中心所需的物理网格间距 $\\Delta y$，以实现 $y^{+}\\approx 1$ 和 $y^{+}\\approx 30$ 的目标值。将两个 $\\Delta y$ 值以米为单位表示，并按 $\\left[\\Delta y(y^{+}\\approx 1),\\,\\Delta y(y^{+}\\approx 30)\\right]$ 的顺序以一个双元素行矩阵的形式报告，并将您的数值答案四舍五入到四位有效数字。",
            "solution": "所述问题具有科学依据、提法恰当、客观，并包含进行完整分析所需的所有信息。因此，该问题被认定为有效。\n\n这个问题的核心在于理解壁面单位的概念和湍流边界层的结构，这些是计算流体动力学 (CFD) 中近壁区湍流模拟的基础。\n\n无量纲壁面距离，记作 $y^{+}$，定义为：\n$$\ny^{+} = \\frac{y u_{\\tau}}{\\nu}\n$$\n其中，$y$ 是垂直于壁面的物理距离，$u_{\\tau}$ 是摩擦速度，$\\nu$ 是流体的运动粘度。摩擦速度 $u_{\\tau} = \\sqrt{\\tau_w / \\rho}$（其中 $\\tau_w$ 是壁面剪切应力，$\\rho$ 是流体密度）代表了近壁区动量输运的特征速度尺度。量 $\\nu/u_{\\tau}$ 代表粘性子层的特征长度尺度，通常称为粘性长度尺度。因此，$y^{+}$ 是以这种粘性单位来衡量离壁法向距离。\n\n湍流边界层的近壁区通常根据 $y^{+}$ 的值分为三个主要区域：\n1.  **粘性子层 (Viscous Sublayer)**：$y^{+} \\lesssim 5$。在这一层中，粘性剪切应力主导湍流（雷诺）剪切应力。速度剖面近似为线性，由 $u^{+} = y^{+}$ 给出，其中 $u^{+} = u/u_{\\tau}$ 是无量纲速度。类似地，对于普朗特数 $Pr \\approx 1$ 的传热问题，温度剖面也是线性的，$T^{+} \\approx Pr \\cdot y^{+}$，其中 $T^{+}$ 是无量纲温度。\n2.  **缓冲层 (Buffer Layer)**：$5 \\lesssim y^{+} \\lesssim 30$。这是一个过渡区域，其中粘性应力和湍流应力的大小相当。速度和温度剖面偏离简单的线性和对数律。\n3.  **对数律区 (Log-Law Region)**：$y^{+} \\gtrsim 30$。在这个完全湍流的区域，湍流应力占主导地位。平均速度剖面遵循对数关系，$u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + C$，其中 $\\kappa \\approx 0.41$ 是 von Kármán 常数，对于光滑壁面 $C \\approx 5.2$。温度剖面也存在类似的对数律。\n\n低雷诺数 (low-Re) RANS 模型是专门为解析直至壁面的流动物理而构建的。它们通过引入阻尼函数来实现这一点，这些函数在接近壁面时正确地修正湍流模型方程（例如，湍动能 $k$ 及其耗散率 $\\epsilon$ 或比耗散率 $\\omega$ 的方程），从而解释粘性效应对湍流的抑制作用。\n\n现在我们来分析两种建议的网格布置对低雷诺数 RANS 模型的影响。\n\n**情况1：第一个网格单元中心位于 $y^{+} \\approx 1$**\n\n*   **解析的物理分层**：将第一个网格单元中心放置在 $y^{+} \\approx 1$ 处，使其深入粘性子层。这是低雷诺数模型的预期工作范围。具有这种分辨率的网格，并且通常在缓冲层内有更多的单元（例如，在 $y^{+} = 30$ 以下有10到15个单元），使得模拟能够直接捕捉粘性子层和缓冲层中速度和温度的陡峭梯度，在这些区域粘性效应至关重要。\n*   **模型一致性**：这种网格划分策略与低雷诺数 RANS 模型的假设和构造完全一致。模型的阻尼函数被设计为在该区域 ($y^{+} \\lesssim 5$) 内有效且准确，能正确地将壁面处的湍流粘度降低到零。模拟解析了模型旨在表示的物理现象。\n*   **预期准确性**：预计此方法对壁面剪切应力 ($\\tau_w$) 和壁面热通量 ($q_w$) 都能产生高准确度的结果。因为速度和温度的线性剖面被网格解析，所以这些壁面量可以通过其基本定义，使用壁面边界处的局部梯度精确计算得出：\n    $$\n    \\tau_w = \\mu \\left. \\frac{\\partial u}{\\partial y} \\right|_{y=0} \\quad \\text{和} \\quad q_w = -k_{th} \\left. \\frac{\\partial T}{\\partial y} \\right|_{y=0}\n    $$\n    其中 $\\mu = \\rho\\nu$ 是动力粘度， $k_{th}$ 是导热系数。这是在RANS中预测壁面通量的最可靠方法。\n\n**情况2：第一个网格单元中心位于 $y^{+} \\approx 30$**\n\n*   **解析的物理分层**：将第一个网格单元中心放置在 $y^{+} \\approx 30$ 处，使其位于缓冲层的边缘，进入对数律区。使用这种粗网格，整个粘性子层和缓冲层都完全未被解析；它们位于壁面与第一个网格单元中心之间的空间内。\n*   **模型一致性**：这种布置与低雷诺数 RANS 模型的用途**根本上不一致**。这相当于要求模型在一个其关于解析近壁区粘性效应的基本假设被网格违背的区域内计算解。低雷诺数模型中的阻尼函数并非为跨越到壁面的如此大间隙而设计，可能会导致数值刚性或产生物理上不正确的结果，因为它们期望的是精细解析的网格。这构成了一个关键的建模错误。对于第一个网格单元在 $y^{+} \\approx 30$ 处的网格，正确的方法是使用高雷诺数 RANS 模型并结合壁面函数，壁面函数是模拟未解析内部层物理的半经验公式。在壁面函数类型的网格上使用低雷诺数模型是对模型的误用。\n*   **预期准确性**：这种方法将导致对 $\\tau_w$ 和 $q_w$ 的**不良且不可靠的预测**。模拟没有解析壁面附近的陡峭梯度，因此任何基于壁面梯度计算壁面通量的结果都将非常不准确。模型将试图将其低雷诺数逻辑应用于一个完全湍流的区域（第一个单元），导致对近壁区物理的错误表述，从而对壁面摩擦和传热做出错误的预测。\n\n为了计算所需的物理网格间距 $\\Delta y$，我们重排 $y^{+}$ 的定义：\n$$\n\\Delta y = y = \\frac{y^{+} \\nu}{u_{\\tau}}\n$$\n给定值 $u_{\\tau}=0.4 \\, \\mathrm{m/s}$ 和 $\\nu=1.6\\times 10^{-5} \\, \\mathrm{m^2/s}$：\n\n对于目标 $y^{+} \\approx 1$：\n$$\n\\Delta y_1 = \\frac{1 \\times (1.6 \\times 10^{-5} \\, \\mathrm{m^2/s})}{0.4 \\, \\mathrm{m/s}} = 4.0 \\times 10^{-5} \\, \\mathrm{m}\n$$\n四舍五入到四位有效数字，即 $4.000 \\times 10^{-5} \\, \\mathrm{m}$。\n\n对于目标 $y^{+} \\approx 30$：\n$$\n\\Delta y_{30} = \\frac{30 \\times (1.6 \\times 10^{-5} \\, \\mathrm{m^2/s})}{0.4 \\, \\mathrm{m/s}} = \\frac{4.8 \\times 10^{-4} \\, \\mathrm{m^2/s}}{0.4 \\, \\mathrm{m/s}} = 1.2 \\times 10^{-3} \\, \\mathrm{m}\n$$\n四舍五入到四位有效数字，即 $1.200 \\times 10^{-3} \\, \\mathrm{m}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.000 \\times 10^{-5} & 1.200 \\times 10^{-3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在建立了合适的近壁网格后，下一步是深入理解 RANS 封闭模型本身的工作原理。本练习聚焦于作为大多数涡粘模型基石的 Boussinesq 假说。通过为一个简化的剪切流计算关键的雷诺应力分量，并将其与假设的高保真数据进行比较，你将能够洞察该方法的内在机制及其局限性，特别是在面对系统旋转等复杂物理现象时。",
            "id": "3983010",
            "problem": "考虑牛顿流体的不可压缩均匀平面剪切流，其平均速度场为 $\\overline{\\boldsymbol{u}}(y) = (\\Gamma y,\\,0,\\,0)$，其中 $\\Gamma$ 是一个恒定的平均剪切率。雷诺平均纳维-斯托克斯（RANS）方程引入了雷诺应力张量 $\\boldsymbol{R}$，其分量为 $R_{ij} = \\overline{u'_i u'_j}$，其中 $u'_i$ 是速度脉动。在 Boussinesq 涡粘性假设下，通过平均应变率张量 $S_{ij}$，用一个标量湍流粘度 $\\nu_{t}$ 来封闭 $\\boldsymbol{R}$ 的偏量部分。\n\n对于一个统计定常态，给定以下数据：\n- 平均剪切率 $\\Gamma = 150\\,\\text{s}^{-1}$。\n- 湍动能 $k = 0.25\\,\\text{m}^2\\text{s}^{-2}$。\n- 湍流耗散率 $\\varepsilon = 37.5\\,\\text{m}^2\\text{s}^{-3}$。\n- 模型常数 $C_{\\mu} = 0.09$。\n\n直接数值模拟（DNS）在两种条件下提供了以下的剪切应力分量（定义为 $R_{xy}^{\\mathrm{DNS}} = \\overline{u'_x u'_y}$）：\n- 非旋转情况：$R_{xy}^{\\mathrm{DNS}} = -2.40 \\times 10^{-2}\\,\\text{m}^2\\text{s}^{-2}$。\n- 旋转情况：系统围绕 $z$ 轴以角速度 $\\Omega = 20\\,\\text{s}^{-1}$ 均匀旋转，此时 $R_{xy}^{\\mathrm{DNS,rot}} = -1.50 \\times 10^{-2}\\,\\text{m}^2\\text{s}^{-2}$。\n\n从给定流动的雷诺平均和平均应变率张量的基本定义出发，使用带有单个标量湍流粘度的 Boussinesq 封闭来预测该流动的非对角雷诺应力 $R_{xy}$。然后，使用所提供的 DNS 值，定义非旋转情况下的绝对相对误差 $E = \\left| R_{xy}^{\\mathrm{B}} - R_{xy}^{\\mathrm{DNS}} \\right| \\big/ \\left| R_{xy}^{\\mathrm{DNS}} \\right|$ 和旋转情况下的绝对相对误差 $E_{\\mathrm{rot}} = \\left| R_{xy}^{\\mathrm{B}} - R_{xy}^{\\mathrm{DNS,rot}} \\right| \\big/ \\left| R_{xy}^{\\mathrm{DNS,rot}} \\right|$。报告比值 $\\mathcal{E} = E_{\\mathrm{rot}} / E$。\n\n将最终比值四舍五入到四位有效数字，并以纯小数（无量纲）形式表示。",
            "solution": "我们从雷诺分解和雷诺平均纳维-斯托克斯（RANS）框架开始。对于不可压缩流，雷诺应力分量定义为 $R_{ij} = \\overline{u'_i u'_j}$。Boussinesq 涡粘性假设将雷诺应力张量的偏量部分建模为与平均应变率张量 $S_{ij}$ 成正比，其中\n$$\nS_{ij} = \\frac{1}{2}\\left( \\frac{\\partial \\overline{u}_i}{\\partial x_j} + \\frac{\\partial \\overline{u}_j}{\\partial x_i} \\right).\n$$\n对于 $i \\neq j$，Boussinesq 假设得出\n$$\nR_{ij} = -2 \\nu_{t} S_{ij}.\n$$\n\n在当前的平面剪切流中，平均速度为 $\\overline{\\boldsymbol{u}} = (\\Gamma y,\\,0,\\,0)$，因此唯一非零的平均速度梯度是\n$$\n\\frac{\\partial \\overline{u}_x}{\\partial y} = \\Gamma.\n$$\n因此，应变率张量唯一非零的非对角分量是\n$$\nS_{xy} = \\frac{1}{2}\\left( \\frac{\\partial \\overline{u}_x}{\\partial y} + \\frac{\\partial \\overline{u}_y}{\\partial x} \\right) = \\frac{1}{2}\\Gamma.\n$$\n将 Boussinesq 封闭应用于 $xy$ 分量，得到\n$$\nR_{xy}^{\\mathrm{B}} = -2 \\nu_{t} S_{xy} = -2 \\nu_{t} \\left( \\frac{1}{2}\\Gamma \\right) = - \\nu_{t} \\Gamma.\n$$\n\n为了计算 $\\nu_{t}$，我们使用来自两方程 $k$–$\\varepsilon$ 模型的一个经过充分检验的标准关系式，\n$$\n\\nu_{t} = C_{\\mu} \\frac{k^{2}}{\\varepsilon},\n$$\n使用给定的 $C_{\\mu}$、$k$ 和 $\\varepsilon$。代入所提供的值，\n$$\n\\nu_{t} = 0.09 \\times \\frac{(0.25)^{2}}{37.5} = 0.09 \\times \\frac{0.0625}{37.5}.\n$$\n计算分子：\n$$\n0.09 \\times 0.0625 = 0.005625.\n$$\n除以 $\\varepsilon$：\n$$\n\\nu_{t} = \\frac{0.005625}{37.5} = 1.5 \\times 10^{-4}.\n$$\n因此，\n$$\nR_{xy}^{\\mathrm{B}} = - \\nu_{t} \\Gamma = - (1.5 \\times 10^{-4}) \\times 150 = -2.25 \\times 10^{-2}.\n$$\n\n现在我们使用 DNS 值构建绝对相对误差。对于非旋转情况，\n$$\nR_{xy}^{\\mathrm{DNS}} = -2.40 \\times 10^{-2},\n$$\n所以\n$$\nE = \\frac{\\left| R_{xy}^{\\mathrm{B}} - R_{xy}^{\\mathrm{DNS}} \\right|}{\\left| R_{xy}^{\\mathrm{DNS}} \\right|} = \\frac{\\left| (-2.25 \\times 10^{-2}) - (-2.40 \\times 10^{-2}) \\right|}{\\left| -2.40 \\times 10^{-2} \\right|}.\n$$\n计算分子：\n$$\n(-2.25 \\times 10^{-2}) - (-2.40 \\times 10^{-2}) = (+1.5 \\times 10^{-3}),\n$$\n其绝对值为 $1.5 \\times 10^{-3}$。分母为 $2.40 \\times 10^{-2}$。因此，\n$$\nE = \\frac{1.5 \\times 10^{-3}}{2.40 \\times 10^{-2}} = \\frac{1.5}{24} = 0.0625.\n$$\n\n对于旋转情况（绕 $z$ 轴旋转，$\\Omega = 20\\,\\text{s}^{-1}$），DNS 提供的值是\n$$\nR_{xy}^{\\mathrm{DNS,rot}} = -1.50 \\times 10^{-2}.\n$$\n那么，\n$$\nE_{\\mathrm{rot}} = \\frac{\\left| R_{xy}^{\\mathrm{B}} - R_{xy}^{\\mathrm{DNS,rot}} \\right|}{\\left| R_{xy}^{\\mathrm{DNS,rot}} \\right|} = \\frac{\\left| (-2.25 \\times 10^{-2}) - (-1.50 \\times 10^{-2}) \\right|}{\\left| -1.50 \\times 10^{-2} \\right|}.\n$$\n计算分子：\n$$\n(-2.25 \\times 10^{-2}) - (-1.50 \\times 10^{-2}) = (-7.5 \\times 10^{-3}),\n$$\n其绝对值为 $7.5 \\times 10^{-3}$。分母为 $1.50 \\times 10^{-2}$。因此，\n$$\nE_{\\mathrm{rot}} = \\frac{7.5 \\times 10^{-3}}{1.50 \\times 10^{-2}} = \\frac{7.5}{15} = 0.5.\n$$\n\n最后，报告绝对相对误差的比值，\n$$\n\\mathcal{E} = \\frac{E_{\\mathrm{rot}}}{E} = \\frac{0.5}{0.0625} = 8.\n$$\n四舍五入到四位有效数字并以纯小数（无量纲）表示，最终比值为 $8.000$。",
            "answer": "$$\\boxed{8.000}$$"
        },
        {
            "introduction": "任何计算模型的价值最终取决于其经过验证的预测能力。最后的这个实践将从模型计算转向模型评估，指导你设计并实施一个系统性的验证方案。通过将 RANS 模型的关键指标预测结果与“基准真相”的直接数值模拟（DNS）数据进行对比，本练习旨在引入使用统计工具量化模型误差的专业方法，这是任何严肃的 CFD 从业者都必须掌握的关键技能。",
            "id": "3982996",
            "problem": "考虑在高雷诺数和等温条件下，统计定常、充分发展的湍流平面槽道流。雷诺平均纳维–斯托克斯 (RANS) 方程是通过对瞬时纳维–斯托克斯方程进行雷诺分解 $u_i = U_i + u_i'$ 和系综平均得到的。用于比较 RANS 封闭模型与直接数值模拟 (DNS) 的相关验证指标由 RANS 场变量定义如下：平均流向速度 $U(y)$、雷诺应力张量分量 $R_{ij}(y) = \\langle u_i'(y) u_j'(y) \\rangle$、湍动能 $k(y) = \\tfrac{1}{2} \\langle u_i'(y) u_i'(y) \\rangle = \\tfrac{1}{2}\\left(R_{11}(y) + R_{22}(y) + R_{33}(y)\\right)$，以及壁面摩擦系数 $C_f = \\tau_w / \\left(\\tfrac{1}{2} \\rho U_b^2\\right)$，其中 $U_b$ 是体积速度，$\\rho$ 是密度，$\\tau_w$ 是平均壁面剪切应力。假设使用摩擦速度 $u_\\tau$ 和壁面单位 $y^+ = y u_\\tau / \\nu$ 进行无量纲内尺度缩放，其中 $\\nu$ 是运动粘度。设 DNS 型线为基准真值，RANS 型线为待验证的预测值。\n\n您的任务是设计并实施一个验证计划，该计划针对每个指标，在显著性水平 $\\alpha = 0.05$ 下计算基于样本的偏差以及平均偏差的双侧置信区间。使用以下原则：\n- 对于在离散的法向壁面位置 $y_k^+$ 处有可用样本的任何场量 $q(y)$，定义逐点相对偏差样本 $e_k = \\left(q_{\\mathrm{RANS}}(y_k^+) - q_{\\mathrm{DNS}}(y_k^+)\\right) / q_{\\mathrm{DNS}}(y_k^+)$。当组合多个张量分量时，通过跨分量和位置的拼接形成单个样本向量。如果任何分母 $q_{\\mathrm{DNS}}(y_k^+)$ 在数值上为零，则通过将其替换为 $\\varepsilon = 10^{-12}$ 来正则化除法。\n- 对于壁面摩擦系数，假设 DNS 和 RANS 都有多个统计独立的瞬时样本 $C_f$；为每个重复实验索引 $m$ 定义配对相对偏差样本 $e_m = \\left(C_{f,\\mathrm{RANS}}^{(m)} - C_{f,\\mathrm{DNS}}^{(m)}\\right) / C_{f,\\mathrm{DNS}}^{(m)}$。\n- 对于每组偏差样本，计算样本均值和偏差总体均值的双侧 $100(1-\\alpha)\\%$ 置信区间。\n\n您的推导应基于上述定义、大数定律以及样本均值的标准统计推断。除这些定义外，不要假设或引用任何特定封闭模型的公式。说明您在构建置信区间时使用的任何独立性或平稳性假设。\n\n实现一个程序，为包含三个案例的小型测试套件执行此验证。在所有情况下，对 $U^+$ 使用自然对数，并假设 DNS 平均流向速度遵循壁面律的对数律，\n$$\nU_{\\mathrm{DNS}}^+(y^+) = \\frac{1}{\\kappa} \\ln(y^+) + B,\n$$\n常数为 $\\kappa = 0.41$ 和 $B = 5.0$。假设 $U_{\\mathrm{DNS}}^+(y^+)$ 是由 $u_\\tau$ 归一化的流向速度，雷诺应力分量由 $u_\\tau^2$ 归一化，因此 $k^+ = k / u_\\tau^2$ 且 $R_{ij}^+ = R_{ij} / u_\\tau^2$。\n\n测试套件：\n- 案例 1 (一般情况)：\n    - 法向壁面样本：$y^+ = [5, 15, 30, 60, 100, 200]$。\n    - 平均速度：$U_{\\mathrm{RANS}}^+ = 1.03\\, U_{\\mathrm{DNS}}^+ - 0.5$。\n    - 雷诺应力分量 (DNS，均以 $u_\\tau^2$ 无量纲化)：$R_{11}^+ = [5.5, 6.8, 6.2, 5.1, 4.0, 2.5]$，$R_{22}^+ = [2.0, 2.5, 2.7, 2.6, 2.4, 2.0]$，$R_{33}^+ = [2.5, 2.9, 3.0, 2.9, 2.7, 2.3]$，$R_{12}^+ = [-0.30, -0.28, -0.24, -0.19, -0.14, -0.08]$。RANS 分量：$R_{11,\\mathrm{RANS}}^+ = 1.05\\, R_{11,\\mathrm{DNS}}^+ - 0.2$，$R_{22,\\mathrm{RANS}}^+ = 0.95\\, R_{22,\\mathrm{DNS}}^+ + 0.1$，$R_{33,\\mathrm{RANS}}^+ = 0.90\\, R_{33,\\mathrm{DNS}}^+ + 0.15$，$R_{12,\\mathrm{RANS}}^+ = 1.10\\, R_{12,\\mathrm{DNS}}^+ + 0.01$。\n    - 壁面摩擦系数重复实验值：$C_{f,\\mathrm{DNS}} = [0.0049, 0.0051, 0.0050, 0.0050, 0.0052, 0.0048, 0.0050, 0.0051]$，$C_{f,\\mathrm{RANS}} = [0.0053, 0.0054, 0.0052, 0.0053, 0.0055, 0.0052, 0.0054, 0.0053]$。\n- 案例 2 (近似匹配与精度检查)：\n    - 法向壁面样本：$y^+ = [5, 15, 30, 60, 100, 200]$。\n    - 平均速度：$U_{\\mathrm{RANS}}^+ = 1.005\\, U_{\\mathrm{DNS}}^+$。\n    - 雷诺应力分量 (DNS 与案例 1 相同)。RANS 分量：$R_{11,\\mathrm{RANS}}^+ = 1.02\\, R_{11,\\mathrm{DNS}}^+$，$R_{22,\\mathrm{RANS}}^+ = 1.02\\, R_{22,\\mathrm{DNS}}^+$，$R_{33,\\mathrm{RANS}}^+ = 1.02\\, R_{33,\\mathrm{DNS}}^+$，$R_{12,\\mathrm{RANS}}^+ = 0.98\\, R_{12,\\mathrm{DNS}}^+$。\n    - 壁面摩擦系数重复实验值：$C_{f,\\mathrm{DNS}}$ 与案例 1 相同，$C_{f,\\mathrm{RANS}} = 1.01\\, C_{f,\\mathrm{DNS}}$ 逐元素应用。\n- 案例 3 (小样本与偏差应力测试)：\n    - 法向壁面样本：$y^+ = [10, 50, 180]$。\n    - 平均速度：$U_{\\mathrm{RANS}}^+ = 0.95\\, U_{\\mathrm{DNS}}^+ - 0.4$。\n    - 雷诺应力分量 (DNS)：$R_{11}^+ = [6.0, 5.0, 3.0]$，$R_{22}^+ = [2.4, 2.3, 2.1]$，$R_{33}^+ = [2.8, 2.7, 2.2]$，$R_{12}^+ = [-0.29, -0.18, -0.10]$。RANS 分量：$R_{11,\\mathrm{RANS}}^+ = 0.90\\, R_{11,\\mathrm{DNS}}^+ + 0.3$，$R_{22,\\mathrm{RANS}}^+ = 1.10\\, R_{22,\\mathrm{DNS}}^+ - 0.15$，$R_{33,\\mathrm{RANS}}^+ = 0.85\\, R_{33,\\mathrm{DNS}}^+ + 0.2$，$R_{12,\\mathrm{RANS}}^+ = 1.20\\, R_{12,\\mathrm{DNS}}^+ + 0.02$。\n    - 壁面摩擦系数重复实验值：$C_{f,\\mathrm{DNS}} = [0.0050, 0.0051, 0.0049]$，$C_{f,\\mathrm{RANS}} = [0.0047, 0.0048, 0.0046]$。\n\n对于每个案例，按此确切顺序以十进制数计算并报告以下十二个量：\n1. 给定 $y^+$ 样本上 $U^+$ 相对偏差的样本均值。\n2. $U^+$ 平均偏差的 $95\\%$ 双侧置信区间的下界。\n3. $U^+$ 平均偏差的 $95\\%$ 双侧置信区间的上界。\n4. 通过拼接聚合所有四个雷诺应力分量 $R_{ij}^+$ 和所有 $y^+$ 样本的相对偏差的样本均值。\n5. 聚合的 $R_{ij}^+$ 样本的平均偏差的 $95\\%$ 双侧置信区间的下界。\n6. 聚合的 $R_{ij}^+$ 样本的平均偏差的 $95\\%$ 双侧置信区间的上界。\n7. 在每个 $y^+$ 位置由法向应力分量计算出的 $k^+$ 相对偏差的样本均值。\n8. $k^+$ 平均偏差的 $95\\%$ 双侧置信区间的下界。\n9. $k^+$ 平均偏差的 $95\\%$ 双侧置信区间的上界。\n10. $C_f$ 重复实验值的配对相对偏差的样本均值。\n11. $C_f$ 平均偏差的 $95\\%$ 双侧置信区间的下界。\n12. $C_f$ 平均偏差的 $95\\%$ 双侧置信区间的上界。\n\n您的程序应生成单行输出，其中包含三个案例的结果，格式为一个逗号分隔的列表，包含三个子列表，每个子列表都在方括号内，并严格按照上述顺序排列，例如 \"[[case1_values...],[case2_values...],[case3_values...]]\"。所有输出均为无量纲；不包含任何物理单位。不涉及角度。所有结果均以十进制数表示。通过对任何接近零的分母使用正则化 $\\varepsilon = 10^{-12}$（如上所述）来确保数值鲁棒性。",
            "solution": "该问题要求制定并实施一个统计验证计划，以比较雷诺平均纳维–斯托克斯 (RANS) 模型预测与湍流平面槽道流的直接数值模拟 (DNS) 数据。验证重点关注四个关键量：平均流向速度型线 $U^+(y^+)$、雷诺应力张量 $R_{ij}^+(y^+)$、湍动能 $k^+(y^+)$ 和壁面摩擦系数 $C_f$。对于每个量，我们必须计算相对偏差的样本均值和总体平均偏差的双侧置信区间。\n\n### 统计框架\n\n验证计划的核心是量化平均偏差及其不确定性的统计程序。该程序基于样本均值的标准统计推断方法。\n\n设 $q_{\\mathrm{RANS}}$ 表示 RANS 模型的预测值，$q_{\\mathrm{DNS}}$ 为 DNS 对应的基准真值。对于一组 $n$ 个配对观测值 $\\{(q_{\\mathrm{RANS},i}, q_{\\mathrm{DNS},i})\\}_{i=1}^n$，我们将逐点相对偏差的样本定义为：\n$$\ne_i = \\frac{q_{\\mathrm{RANS},i} - q_{\\mathrm{DNS},i}}{q_{\\mathrm{DNS},i}}\n$$\n在分母 $q_{\\mathrm{DNS},i}$ 在数值上与零无法区分的情况下，其值将被替换为一个小的正则化参数 $\\varepsilon = 10^{-12}$ 以确保数值稳定性。这通过计算偏差 $(q_{\\mathrm{RANS},i} - q_{\\mathrm{DNS},i}) / d_i$ 来实现，其中如果 $|q_{\\mathrm{DNS},i}| \\ge \\varepsilon$，则 $d_i = q_{\\mathrm{DNS},i}$，否则 $d_i = \\varepsilon$。\n\n我们将偏差样本集 $\\{e_i\\}_{i=1}^n$ 视为从一个具有未知均值 $\\mu_e$ 和方差 $\\sigma_e^2$ 的总体中抽取的独立同分布 (i.i.d.) 随机变量。对于 $C_f$ 的瞬时重复实验值，明确陈述了此 i.i.d. 假设；而当应用于在不同空间位置 ($y^+$) 采集的样本时，这是一个简化假设，因为此分析中未考虑可能存在的空间相关性。\n\n总体均值 $\\mu_e$ 由样本均值估计：\n$$\n\\bar{e} = \\frac{1}{n} \\sum_{i=1}^{n} e_i\n$$\n为量化此估计的不确定性，我们为 $\\mu_e$ 构建一个双侧 $100(1-\\alpha)\\%$ 置信区间。对于小样本量 $n$，该区间基于 Student's t-分布。该区间由下式给出：\n$$\n\\text{CI} = \\left[ \\bar{e} - t_{1-\\alpha/2, n-1} \\frac{s}{\\sqrt{n}}, \\quad \\bar{e} + t_{1-\\alpha/2, n-1} \\frac{s}{\\sqrt{n}} \\right]\n$$\n其中：\n- $s$ 是样本标准差，是 $\\sigma_e$ 的估计值：\n$$\ns = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (e_i - \\bar{e})^2}\n$$\n- $t_{1-\\alpha/2, n-1}$ 是自由度为 $n-1$ 的 t-分布的临界值（即 $(1-\\alpha/2)$-分位数）。\n- $\\alpha=0.05$ 是显著性水平，对应于 $95\\%$ 的置信水平。\n\n现在将此框架应用于每个指定的流体物理量。\n\n### 在流体物理量上的应用\n\n**1. 平均流向速度 ($U^+$)**\n对数层中的 DNS 平均速度型线由壁面律给出：\n$$\nU_{\\mathrm{DNS}}^+(y^+) = \\frac{1}{\\kappa} \\ln(y^+) + B\n$$\n其中 $\\kappa = 0.41$ 且 $B = 5.0$。对于一组给定的 $n_y$ 个法向壁面位置 $\\{y_k^+\\}_{k=1}^{n_y}$，我们首先计算 DNS 型线 $U_{\\mathrm{DNS}}^+(y_k^+)$ 和相应的 RANS 预测值 $U_{\\mathrm{RANS}}^+(y_k^+)$。然后计算相对偏差样本 $\\{e_k\\}_{k=1}^{n_y}$，并应用统计框架，样本量为 $n = n_y$。\n\n**2. 雷诺应力张量 ($R_{ij}^+$)**\n验证是针对雷诺应力张量的四个分量进行的：法向应力 $R_{11}^+, R_{22}^+, R_{33}^+$ 和剪切应力 $R_{12}^+$。对于每个分量，在所有 $n_y$ 个空间位置上计算偏差样本。根据问题规范，然后将这些样本通过拼接聚合成单个向量。聚合分析的总样本量为 $n = 4 \\times n_y$。然后将统计框架应用于此复合样本，以评估雷诺应力张量的整体模型性能。\n\n**3. 湍动能 ($k^+$)**\n湍动能 $k^+$ 是一个派生量，定义为：\n$$\nk^+(y^+) = \\frac{1}{2} \\left( R_{11}^+(y^+) + R_{22}^+(y^+) + R_{33}^+(y^+) \\right)\n$$\n我们使用各自的法向应力分量，在每个位置 $y_k^+$ 计算型线 $k_{\\mathrm{DNS}}^+(y_k^+)$ 和 $k_{\\mathrm{RANS}}^+(y_k^+)$。随后，我们在每个 $n_y$ 个位置计算 $k^+$ 的相对偏差样本。然后对这组 $n=n_y$ 个样本进行统计分析。\n\n**4. 壁面摩擦系数 ($C_f$)**\n对于标量 $C_f$，我们提供了 $n_{Cf}$ 对统计独立的瞬时重复实验值：$\\{C_{f,\\mathrm{DNS}}^{(m)}\\}_{m=1}^{n_{Cf}}$ 和 $\\{C_{f,\\mathrm{RANS}}^{(m)}\\}_{m=1}^{n_{Cf}}$。计算配对相对偏差样本 $\\{e_m\\}_{m=1}^{n_{Cf}}$。然后应用统计分析，样本量为 $n = n_{Cf}$，以确定平均偏差及其置信区间。\n\n### 算法实现\n所描述的验证过程通过以下程序实现，该程序为每个案例计算指定的十二个指标。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Performs a statistical validation of RANS models against DNS data\n    for three test cases, computing mean discrepancies and confidence intervals.\n    \"\"\"\n    # Define global constants from the problem statement.\n    KAPPA = 0.41\n    B = 5.0\n    ALPHA = 0.05\n    EPSILON = 1e-12\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        # Case 1 (general case)\n        {\n            \"y_plus\": np.array([5, 15, 30, 60, 100, 200]),\n            \"U_rans_formula\": lambda U_dns: 1.03 * U_dns - 0.5,\n            \"R_dns\": {\n                \"11\": np.array([5.5, 6.8, 6.2, 5.1, 4.0, 2.5]),\n                \"22\": np.array([2.0, 2.5, 2.7, 2.6, 2.4, 2.0]),\n                \"33\": np.array([2.5, 2.9, 3.0, 2.9, 2.7, 2.3]),\n                \"12\": np.array([-0.30, -0.28, -0.24, -0.19, -0.14, -0.08]),\n            },\n            \"R_rans_formula\": lambda R_dns: {\n                \"11\": 1.05 * R_dns[\"11\"] - 0.2,\n                \"22\": 0.95 * R_dns[\"22\"] + 0.1,\n                \"33\": 0.90 * R_dns[\"33\"] + 0.15,\n                \"12\": 1.10 * R_dns[\"12\"] + 0.01,\n            },\n            \"Cf_dns\": np.array([0.0049, 0.0051, 0.0050, 0.0050, 0.0052, 0.0048, 0.0050, 0.0051]),\n            \"Cf_rans\": np.array([0.0053, 0.0054, 0.0052, 0.0053, 0.0055, 0.0052, 0.0054, 0.0053]),\n        },\n        # Case 2 (near match and precision check)\n        {\n            \"y_plus\": np.array([5, 15, 30, 60, 100, 200]),\n            \"U_rans_formula\": lambda U_dns: 1.005 * U_dns,\n            \"R_dns\": {\n                \"11\": np.array([5.5, 6.8, 6.2, 5.1, 4.0, 2.5]),\n                \"22\": np.array([2.0, 2.5, 2.7, 2.6, 2.4, 2.0]),\n                \"33\": np.array([2.5, 2.9, 3.0, 2.9, 2.7, 2.3]),\n                \"12\": np.array([-0.30, -0.28, -0.24, -0.19, -0.14, -0.08]),\n            },\n            \"R_rans_formula\": lambda R_dns: {\n                \"11\": 1.02 * R_dns[\"11\"],\n                \"22\": 1.02 * R_dns[\"22\"],\n                \"33\": 1.02 * R_dns[\"33\"],\n                \"12\": 0.98 * R_dns[\"12\"],\n            },\n            \"Cf_dns\": np.array([0.0049, 0.0051, 0.0050, 0.0050, 0.0052, 0.0048, 0.0050, 0.0051]),\n            \"Cf_rans\": 1.01 * np.array([0.0049, 0.0051, 0.0050, 0.0050, 0.0052, 0.0048, 0.0050, 0.0051]),\n        },\n        # Case 3 (small-sample and bias stress test)\n        {\n            \"y_plus\": np.array([10, 50, 180]),\n            \"U_rans_formula\": lambda U_dns: 0.95 * U_dns - 0.4,\n            \"R_dns\": {\n                \"11\": np.array([6.0, 5.0, 3.0]),\n                \"22\": np.array([2.4, 2.3, 2.1]),\n                \"33\": np.array([2.8, 2.7, 2.2]),\n                \"12\": np.array([-0.29, -0.18, -0.10]),\n            },\n            \"R_rans_formula\": lambda R_dns: {\n                \"11\": 0.90 * R_dns[\"11\"] + 0.3,\n                \"22\": 1.10 * R_dns[\"22\"] - 0.15,\n                \"33\": 0.85 * R_dns[\"33\"] + 0.2,\n                \"12\": 1.20 * R_dns[\"12\"] + 0.02,\n            },\n            \"Cf_dns\": np.array([0.0050, 0.0051, 0.0049]),\n            \"Cf_rans\": np.array([0.0047, 0.0048, 0.0046]),\n        },\n    ]\n\n    def compute_stats(samples, alpha):\n        \"\"\"Computes sample mean and confidence interval for a set of samples.\"\"\"\n        n = len(samples)\n        if n  2:\n            return np.mean(samples), np.nan, np.nan\n        \n        mean = np.mean(samples)\n        std_dev = np.std(samples, ddof=1)\n        t_crit = t.ppf(1 - alpha / 2, df=n - 1)\n        margin_of_error = t_crit * std_dev / np.sqrt(n)\n        \n        lower_bound = mean - margin_of_error\n        upper_bound = mean + margin_of_error\n        \n        return mean, lower_bound, upper_bound\n\n    def relative_discrepancy(rans, dns, epsilon):\n        \"\"\"Computes relative discrepancy with regularization for the denominator.\"\"\"\n        safe_dns = np.where(np.abs(dns)  epsilon, epsilon, dns)\n        return (rans - dns) / safe_dns\n\n    all_results = []\n    for case_data in test_cases:\n        case_results = []\n\n        # --- 1. Mean Velocity (U+) ---\n        y_plus = case_data[\"y_plus\"]\n        U_dns = (1 / KAPPA) * np.log(y_plus) + B\n        U_rans = case_data[\"U_rans_formula\"](U_dns)\n        e_U = relative_discrepancy(U_rans, U_dns, EPSILON)\n        case_results.extend(compute_stats(e_U, ALPHA))\n\n        # --- 2. Reynolds Stresses (R_ij) ---\n        R_dns = case_data[\"R_dns\"]\n        R_rans = case_data[\"R_rans_formula\"](R_dns)\n        e_R_agg = np.concatenate([\n            relative_discrepancy(R_rans[comp], R_dns[comp], EPSILON) for comp in [\"11\", \"22\", \"33\", \"12\"]\n        ])\n        case_results.extend(compute_stats(e_R_agg, ALPHA))\n\n        # --- 3. Turbulent Kinetic Energy (k+) ---\n        k_dns = 0.5 * (R_dns[\"11\"] + R_dns[\"22\"] + R_dns[\"33\"])\n        k_rans = 0.5 * (R_rans[\"11\"] + R_rans[\"22\"] + R_rans[\"33\"])\n        e_k = relative_discrepancy(k_rans, k_dns, EPSILON)\n        case_results.extend(compute_stats(e_k, ALPHA))\n        \n        # --- 4. Skin Friction (Cf) ---\n        e_Cf = relative_discrepancy(case_data[\"Cf_rans\"], case_data[\"Cf_dns\"], EPSILON)\n        case_results.extend(compute_stats(e_Cf, ALPHA))\n        \n        all_results.append(case_results)\n\n    # Format the final output string as per the problem specification.\n    # The output string itself is generated and printed outside this function in the execution environment.\n    # This is to satisfy the problem constraints.\n    return all_results\n\n# In the actual execution environment, the result of solve() would be formatted and printed.\n# For example:\n# results = solve()\n# output_str = \",\".join([f\"[{','.join(map(str, res))}]\" for res in results])\n# print(f\"[{output_str}]\")\n\n```",
            "answer": "$$\n\\boxed{\n\\begin{aligned}\n\\text{[[}-0.01634, -0.04351, 0.01084, 0.02105, -0.01250, 0.05460, 0.00755, -0.03051, 0.04562, 0.06941, 0.05830, 0.08053\\text{],} \\\\\n\\text{[}0.00500, 0.00500, 0.00500, 0.01500, 0.01068, 0.01932, 0.02000, 0.02000, 0.02000, 0.01000, 0.01000, 0.01000\\text{],} \\\\\n\\text{[}-0.08581, -0.17002, -0.00161, -0.01243, -0.10303, 0.07817, -0.02384, -0.12401, 0.07633, -0.06001, -0.06300, -0.05703\\text{]]}\n\\end{aligned}\n}\n$$"
        }
    ]
}