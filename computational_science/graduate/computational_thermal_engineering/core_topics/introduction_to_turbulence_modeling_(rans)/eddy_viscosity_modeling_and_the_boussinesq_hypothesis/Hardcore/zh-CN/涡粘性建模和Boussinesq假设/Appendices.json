{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在从基本原理层面介绍涡粘度的概念。通过将Prandtl混合长度模型应用于一个简单的剪切流，你将推导并计算涡粘度，并将其数值与分子粘度进行直接比较。这项练习旨在帮助你建立一个直观的理解，即湍流脉动如何极大地增强动量输运，其效果远超分子扩散。",
            "id": "3950041",
            "problem": "一个不可压缩的统计定常平面剪切流，其平均流向速度 $U(y)$ 随法向坐标 $y$ 线性变化，即 $U(y) = S y$，其中 $S  0$ 为恒定的平均剪切率。流体具有恒定的密度 $\\rho$ 和恒定的分子动力粘度 $\\mu$。在雷诺平均纳维-斯托克斯 (RANS) 框架下，从雷诺分解的定义和平均动量平衡出发，确定湍流剪切应力分量，并引用 Boussinesq 涡粘性假设将湍流剪切应力与平均剪切关联起来。然后，使用 Prandtl 混合长度概念和一个恒定的混合长度 $l$，推导涡粘度 $\\mu_{t}$ 关于 $\\rho$、$l$ 和 $S$ 的表达式。\n\n利用此表达式，根据以下代表性参数计算 $\\mu_{t}$ 以及比率 $R = \\mu_{t} / \\mu$：$\\rho = 1.20 \\ \\text{kg}\\,\\text{m}^{-3}$，$\\mu = 1.80 \\times 10^{-5} \\ \\text{Pa}\\,\\text{s}$，$S = 500 \\ \\text{s}^{-1}$，以及 $l = 1.00 \\times 10^{-3} \\ \\text{m}$。\n\n将 $R$ 的最终值四舍五入至三位有效数字。最终答案只报告 $R$ 的数值（无量纲），不带单位。",
            "solution": "用户要求我解决一个涉及湍流建模的流体力学问题。\n\n### 第 1 步：提取已知条件\n- **流场:** 不可压缩、统计定常的平面剪切流。\n- **平均速度剖面:** $U(y) = S y$，其中 $y$ 是法向坐标。\n- **平均剪切率:** $S  0$，为常数。\n- **流体性质:** 恒定的密度 $\\rho$ 和恒定的分子动力粘度 $\\mu$。\n- **框架:** 雷诺平均纳维-斯托克斯 (RANS)。\n- **概念:** Boussinesq 涡粘性假设和 Prandtl 混合长度概念。\n- **混合长度:** 恒定值 $l$。\n- **目标 1:** 推导涡粘度 $\\mu_{t}$ 关于 $\\rho$、$l$ 和 $S$ 的表达式。\n- **目标 2:** 计算 $\\mu_{t}$ 以及比率 $R = \\mu_{t} / \\mu$。\n- **数值参数:**\n    -   $\\rho = 1.20 \\ \\text{kg}\\,\\text{m}^{-3}$\n    -   $\\mu = 1.80 \\times 10^{-5} \\ \\text{Pa}\\,\\text{s}$\n    -   $S = 500 \\ \\text{s}^{-1}$\n    -   $l = 1.00 \\times 10^{-3} \\ \\text{m}$\n- **最终答案要求:** 报告无量纲的 $R$ 值，并四舍五入至三位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，采用了湍流建模中的标准、成熟的概念，如 RANS、Boussinesq 假设和 Prandtl 混合长度模型。所指定的流场，即简单剪切流，是教科书中用以介绍这些概念的经典案例。该问题是适定的，为获得唯一解提供了所有必要的信息和参数。语言客观而精确。对于在显著剪切作用下的空气等流体，数值是物理上现实的。该问题在流体力学框架内是完全可以形式化的，并且不违反任何科学原理，也不包含内部矛盾。\n\n### 第 3 步：结论和行动\n问题有效。将提供解答。\n\n我们首先对速度场应用雷诺分解。对于湍流，瞬时速度分量 $u_i$ 被分解为一个平均分量 $\\overline{u_i}$ 和一个脉动分量 $u_i'$，即 $u_i = \\overline{u_i} + u_i'$。对于给定的平面剪切流，平均速度场为 $\\overline{\\mathbf{u}} = (U(y), 0, 0)$，其中 $U(y) = Sy$。\n\n对于具有恒定性质的不可压缩流体，雷诺平均纳维-斯托克斯 (RANS) 方程由下式给出：\n$$\n\\rho \\frac{\\partial \\overline{u_i}}{\\partial t} + \\rho \\overline{u_j} \\frac{\\partial \\overline{u_i}}{\\partial x_j} = -\\frac{\\partial \\overline{p}}{\\partial x_i} + \\frac{\\partial}{\\partial x_j} \\left( \\mu \\frac{\\partial \\overline{u_i}}{\\partial x_j} - \\rho \\overline{u_i' u_j'} \\right)\n$$\n项 $\\tau_{ij}^R = -\\rho \\overline{u_i' u_j'}$ 是雷诺应力张量，表示湍流脉动对平均流的影响。\n\n对于统计定常流，所有平均量的时间导数均为零（$\\frac{\\partial}{\\partial t} = 0$）。对于一个具有 $\\overline{\\mathbf{u}} = (U(y), 0, 0)$ 的平面剪切流，流向 ($x$) 的平均动量方程显著简化。假设平均量在 $x$ 和 $z$ 方向上是均匀的（对此类流动的一个标准假设），方程变为：\n$$\n0 = -\\frac{d \\overline{p}}{dx} + \\frac{d}{dy} \\left( \\mu \\frac{dU}{dy} - \\rho \\overline{u'v'} \\right)\n$$\n流场中的总剪切应力 $\\tau_{total}$ 是平均粘性应力 $\\tau_{yx}^{visc} = \\mu \\frac{dU}{dy}$ 和湍流剪切应力（也称雷诺剪切应力）$\\tau_{yx}^{turb} = -\\rho \\overline{u'v'}$ 的和。\n所以，$\\tau_{total} = \\tau_{yx}^{visc} + \\tau_{yx}^{turb} = \\mu \\frac{dU}{dy} - \\rho \\overline{u'v'}$。\n\n问题要求我们对湍流剪切应力项进行建模。Boussinesq 涡粘性假设通过引入一个涡粘度 $\\mu_t$，提供了与分子粘性应力的类比。对于这种特定的流动配置，该假设表述为：\n$$\n\\tau_{yx}^{turb} = -\\rho \\overline{u'v'} = \\mu_t \\frac{dU}{dy}\n$$\n\n接下来，我们使用 Prandtl 混合长度模型来获得湍流应力的表达式。该模型通过一个特征长度尺度 $l$（混合长度），将速度脉动与平均速度梯度关联起来。它提出雷诺剪切应力由下式给出：\n$$\n-\\rho \\overline{u'v'} = \\rho l^2 \\left| \\frac{dU}{dy} \\right| \\frac{dU}{dy}\n$$\n\n通过令 Boussinesq 表达式和 Prandtl 模型表达式对于湍流剪切应力相等，我们得到：\n$$\n\\mu_t \\frac{dU}{dy} = \\rho l^2 \\left| \\frac{dU}{dy} \\right| \\frac{dU}{dy}\n$$\n求解涡粘度 $\\mu_t$，我们得到：\n$$\n\\mu_t = \\rho l^2 \\left| \\frac{dU}{dy} \\right|\n$$\n这是基于混合长度模型的涡粘度的通用表达式。\n\n对于给定的特定平均速度剖面 $U(y) = Sy$，平均剪切率为：\n$$\n\\frac{dU}{dy} = S\n$$\n由于问题说明 $S  0$，其绝对值就是 $S$。将此代入我们关于 $\\mu_t$ 的表达式中：\n$$\n\\mu_t = \\rho l^2 S\n$$\n这就是所要求的涡粘度关于 $\\rho$、$l$ 和 $S$ 的表达式。\n\n现在，我们使用提供的数值参数计算 $\\mu_t$ 和比率 $R = \\mu_t / \\mu$：\n$\\rho = 1.20 \\ \\text{kg}\\,\\text{m}^{-3}$\n$\\mu = 1.80 \\times 10^{-5} \\ \\text{Pa}\\,\\text{s}$\n$S = 500 \\ \\text{s}^{-1}$\n$l = 1.00 \\times 10^{-3} \\ \\text{m}$\n\n首先，我们计算涡粘度 $\\mu_t$：\n$$\n\\mu_t = (1.20 \\ \\text{kg}\\,\\text{m}^{-3}) \\times (1.00 \\times 10^{-3} \\ \\text{m})^2 \\times (500 \\ \\text{s}^{-1})\n$$\n$$\n\\mu_t = 1.20 \\times (1.00 \\times 10^{-6}) \\times 500 \\ \\text{kg}\\,\\text{m}^{-1}\\,\\text{s}^{-1}\n$$\n$$\n\\mu_t = 600 \\times 10^{-6} \\ \\text{Pa}\\,\\text{s} = 6.00 \\times 10^{-4} \\ \\text{Pa}\\,\\text{s}\n$$\n\n接下来，我们计算比率 $R$：\n$$\nR = \\frac{\\mu_t}{\\mu} = \\frac{6.00 \\times 10^{-4} \\ \\text{Pa}\\,\\text{s}}{1.80 \\times 10^{-5} \\ \\text{Pa}\\,\\text{s}}\n$$\n$$\nR = \\frac{6.00}{1.80} \\times \\frac{10^{-4}}{10^{-5}} = \\frac{6.00}{1.80} \\times 10^1\n$$\n$$\nR = \\frac{60.0}{1.80} = \\frac{100}{3} \\approx 33.333...\n$$\n问题要求将 R 的最终值四舍五入到三位有效数字。\n$$\nR \\approx 33.3\n$$\n这个无量纲比率表明，在给定条件下，动量的湍流输运效率大约是分子（粘性）输运的 33.3 倍。",
            "answer": "$$\n\\boxed{33.3}\n$$"
        },
        {
            "introduction": "这项练习将理论知识转化为一个真实的计算工程应用。你将通过求解基于代数涡粘度模型的速度剖面积分方程，来开发一个数值程序以预测平板上的壁面摩擦系数。这个综合性练习将湍流模型理论与数值方法（如数值积分和求根算法）相结合，为学习如何实现CFD模型并根据经验数据进行验证提供了宝贵的实践经验。",
            "id": "3950013",
            "problem": "考虑在光滑、等温平板上发展的不可压缩、零压力梯度湍流边界层。假设涡粘性闭合（Boussinesq 假设）有效，并且平均流是定常且平行的，因此在所考虑的壁面法向积分范围内，平均速度的流向梯度可忽略不计。定义摩擦速度 $u_{\\tau}$ 为 $u_{\\tau} = \\sqrt{\\tau_w/\\rho}$，其中 $\\tau_w$ 是壁面剪切应力，$\\rho$ 是流体密度；定义壁面摩擦系数 $C_f$ 为 $C_f = \\tau_w/(0.5\\,\\rho\\,U_{\\infty}^2)$，其中 $U_{\\infty}$ 是自由来流速度。Boussinesq 假设指出 $-\\rho\\,\\overline{u'v'} = \\rho\\,\\nu_t\\,\\partial_y U$，因此在近壁平衡区，总剪切应力可以写为 $\\tau(y) = \\mu\\,\\partial_y U + \\rho\\,\\nu_t\\,\\partial_y U = \\rho\\,u_{\\tau}^2$，其中 $\\mu$ 是动力粘度，$\\nu = \\mu/\\rho$ 是运动粘度。使用此恒定总剪切应力近似，平均速度梯度满足 $\\partial_y U = u_{\\tau}^2/(\\nu + \\nu_t(y))$。\n\n为了对涡粘性进行建模，使用一种受 Spalart–Allmaras 模型启发的代数平衡形式，该形式与惯性子层中的壁面律对数律一致。在壁面单位下，定义 $y^+ = y\\,u_{\\tau}/\\nu$，$U^+ = U/u_{\\tau}$ 和 $\\nu_t^+ = \\nu_t/\\nu$。采用\n$$\n\\nu_t^+(y^+) = \\kappa\\,y^+\\,f_d(y^+)^2,\\quad f_d(y^+) = 1 - \\exp\\!\\left(-\\frac{y^+}{A^+}\\right),\n$$\n其中 $\\kappa$ 是 von Kármán 常数，$A^+$ 控制近壁阻尼。该形式强制在对数区中 $\\nu_t^+(y^+) \\approx \\kappa y^+$，并且当 $y^+ \\to 0$ 时 $\\nu_t^+ \\to 0$，这与 Spalart–Allmaras 模型的近壁阻尼行为一致。\n\n通过变量替换为壁面单位，平均速度剖面可以表示为\n$$\nU^+(y^+) = \\int_0^{y^+} \\frac{1}{1 + \\nu_t^+(\\eta)}\\,\\mathrm{d}\\eta,\n$$\n该表达式在惯性子层中渐近地恢复为对数律 $U^+(y^+) \\sim \\frac{1}{\\kappa}\\ln y^+ + B$，其中适当的常数 $B$ 由近壁行为决定。为了在给定的流向位置 $x$ 处获得壁面摩擦系数 $C_f$，首先使用一个经过充分检验的湍流边界层厚度关联式估算边界层厚度 $\\delta$\n$$\n\\frac{\\delta}{x} = 0.37\\,\\mathrm{Re}_x^{-1/5}, \\quad \\mathrm{Re}_x = \\frac{U_{\\infty}\\,x}{\\nu}.\n$$\n然后通过求解关于 $u_{\\tau}$ 的标量方程来施加外边界条件 $U(\\delta) \\approx U_{\\infty}$\n$$\n\\frac{U_{\\infty}}{u_{\\tau}} = \\int_0^{\\frac{u_{\\tau}\\,\\delta}{\\nu}} \\frac{1}{1 + \\nu_t^+(\\eta)}\\,\\mathrm{d}\\eta,\n$$\n最后计算\n$$\nC_f = 2\\left(\\frac{u_{\\tau}}{U_{\\infty}}\\right)^2.\n$$\n为了进行比较，根据关联式计算 $x$ 处的经验局部湍流壁面摩擦系数\n$$\nC_{f,\\mathrm{emp}}(\\mathrm{Re}_x) = 0.026\\,\\mathrm{Re}_x^{-1/7}.\n$$\n\n您的任务是实现一个程序，对下面的每个测试用例，使用上述积分方程（无闭式快捷公式）数值求解 $u_{\\tau}$ 来计算 $C_f$，并将其与 $C_{f,\\mathrm{emp}}(\\mathrm{Re}_x)$ 进行比较。对壁面单位下的积分使用数值积分法，对 $u_{\\tau}$ 使用鲁棒的一维求根方法。报告每一对 $[C_f, C_{f,\\mathrm{emp}}]$，数值四舍五入到六位小数（无量纲）。\n\n使用以下测试套件，参数以国际单位制 (SI) 给出：\n- 案例1（空气，中等雷诺数，典型常数）：$U_{\\infty} = 30\\,\\mathrm{m/s}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，$x = 1.0\\,\\mathrm{m}$，$\\kappa = 0.41$，$B = 5.2$，$A^+ = 26$。\n- 案例2（空气，较低雷诺数，较强阻尼）：$U_{\\infty} = 10\\,\\mathrm{m/s}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，$x = 0.5\\,\\mathrm{m}$，$\\kappa = 0.41$，$B = 5.2$，$A^+ = 20$。\n- 案例3（空气，较高雷诺数，B值略有不同）：$U_{\\infty} = 50\\,\\mathrm{m/s}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$，$x = 2.0\\,\\mathrm{m}$，$\\kappa = 0.41$，$B = 5.0$，$A^+ = 30$。\n- 案例4（水，由于低粘度导致高雷诺数）：$U_{\\infty} = 5\\,\\mathrm{m/s}$，$\\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s}$，$x = 1.0\\,\\mathrm{m}$，$\\kappa = 0.41$，$B = 5.2$，$A^+ = 26$。\n\n注意：尽管对数律常数 $B$ 出现在渐近表征中，但您对 $C_f$ 的计算必须来自涡粘性积分和外边界条件，而不是通过直接在边界层边缘调用闭式对数速度剖面。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的结果，形式为逗号分隔的数对列表，精确格式如下\n\"[[Cf1,Cf_emp1],[Cf2,Cf_emp2],[Cf3,Cf_emp3],[Cf4,Cf_emp4]]\"，\n每个数值四舍五入到六位小数（例如，\"[[0.003150,0.003098],...]\"）。",
            "solution": "该问题要求计算光滑平板上湍流边界层的壁面摩擦系数 $C_f$。该方法基于 Boussinesq 假设框架内的代数涡粘性模型。计算结果将与一个标准经验关联式进行比较。\n\n分析始于定常、不可压缩、零压力梯度湍流边界层的假设。在近壁区域内，假设总剪切应力 $\\tau(y)$ 是恒定的，且等于壁面剪切应力 $\\tau_w$。总剪切应力由粘性应力和湍流（雷诺）应力组成：\n$$\n\\tau(y) = \\mu \\frac{\\partial U}{\\partial y} - \\rho \\overline{u'v'} = \\tau_w\n$$\n此处，$U$ 是流向的平均速度，$y$ 是壁面法向坐标，$\\mu$ 是动力粘度，$\\rho$ 是密度，而 $-\\rho \\overline{u'v'}$ 是雷诺剪切应力。\n\nBoussinesq 假设通过与粘性应力类比来对雷诺剪切应力进行建模：\n$$\n-\\rho \\overline{u'v'} = \\mu_t \\frac{\\partial U}{\\partial y} = \\rho \\nu_t \\frac{\\partial U}{\\partial y}\n$$\n其中 $\\mu_t$ 是涡粘性，$\\nu_t = \\mu_t/\\rho$ 是涡运动粘度。将此代入恒定应力方程得到：\n$$\n\\tau_w = (\\mu + \\mu_t) \\frac{\\partial U}{\\partial y} = \\rho (\\nu + \\nu_t) \\frac{\\partial U}{\\partial y}\n$$\n其中 $\\nu = \\mu/\\rho$ 是运动粘度。通过定义摩擦速度 $u_{\\tau} = \\sqrt{\\tau_w/\\rho}$，我们可以重排平均速度梯度的方程：\n$$\n\\frac{\\partial U}{\\partial y} = \\frac{u_{\\tau}^2}{\\nu + \\nu_t(y)}\n$$\n为使该方程无量纲化，我们引入壁面单位：$y^+ = y u_{\\tau}/\\nu$ 和 $U^+ = U/u_{\\tau}$。壁面单位下的速度梯度为：\n$$\n\\frac{\\mathrm{d}U^+}{\\mathrm{d}y^+} = \\frac{\\nu}{u_{\\tau}} \\frac{\\partial U}{\\partial y} \\frac{\\nu}{u_{\\tau}} = \\frac{\\nu^2}{u_{\\tau}^2} \\frac{u_{\\tau}^2}{\\nu + \\nu_t} = \\frac{1}{1 + \\nu_t/\\nu} = \\frac{1}{1 + \\nu_t^+(y^+)}\n$$\n其中 $\\nu_t^+ = \\nu_t/\\nu$。从壁面（$y^+=0$，此处 $U^+=0$）开始积分，得到速度剖面：\n$$\nU^+(y^+) = \\int_0^{y^+} \\frac{1}{1 + \\nu_t^+(\\eta)} \\, \\mathrm{d}\\eta\n$$\n问题指定了一个受 Spalart–Allmaras 模型启发的代数涡粘性模型：\n$$\n\\nu_t^+(y^+) = \\kappa\\, y^+ \\left( 1 - \\exp\\left(-\\frac{y^+}{A^+}\\right) \\right)^2\n$$\n其中 $\\kappa$ 是 von Kármán 常数，$A^+$ 是一个阻尼常数。\n\n问题的核心是对于给定的自由来流速度 $U_{\\infty}$ 和流向位置 $x$，确定摩擦速度 $u_{\\tau}$。这是通过施加外边界条件来实现的，即在边界层边缘 $y=\\delta$ 处，平均速度 $U$ 达到 $U_{\\infty}$。在壁面单位下，该条件为 $U(\\delta) = U_{\\infty}$，或 $U^+(\\delta^+) = U_{\\infty}/u_{\\tau}$，其中 $\\delta^+ = \\delta u_{\\tau} / \\nu$。这导出了关于 $u_{\\tau}$ 的非线性标量方程：\n$$\n\\frac{U_{\\infty}}{u_{\\tau}} = \\int_0^{\\delta^+} \\frac{1}{1 + \\nu_t^+(\\eta)} \\, \\mathrm{d}\\eta = \\int_0^{\\frac{u_{\\tau}\\delta}{\\nu}} \\frac{1}{1 + \\kappa\\,\\eta \\left( 1 - \\exp\\left(-\\frac{\\eta}{A^+}\\right) \\right)^2} \\, \\mathrm{d}\\eta\n$$\n边界层厚度 $\\delta$ 并非先验已知，而是使用广为接受的湍流平板流动经验关联式来估算：\n$$\n\\delta = 0.37 \\, x \\, \\mathrm{Re}_x^{-1/5}, \\quad \\text{其中} \\quad \\mathrm{Re}_x = \\frac{U_{\\infty} x}{\\nu}\n$$\n对每个测试用例，数值求解过程如下：\n1.  根据给定的 $U_{\\infty}$、$x$ 和 $\\nu$ 计算雷诺数 $\\mathrm{Re}_x$。\n2.  使用关联式计算边界层厚度 $\\delta$。\n3.  基于积分方程定义一个残差函数 $f(u_{\\tau})$：\n    $$\n    f(u_{\\tau}) = \\left( \\int_0^{\\frac{u_{\\tau}\\delta}{\\nu}} \\frac{1}{1 + \\nu_t^+(\\eta)} \\, \\mathrm{d}\\eta \\right) - \\frac{U_{\\infty}}{u_{\\tau}}\n    $$\n4.  $f(u_{\\tau})$ 中的积分使用数值积分法求值。`scipy.integrate.quad` 函数适用于此目的。\n5.  使用数值求根算法找到使 $f(u_{\\tau}) = 0$ 的 $u_{\\tau}$ 值。`scipy.optimize.root_scalar` 函数，配合像 Brent 方法这样的鲁棒方法，是合适的。可以从经验壁面摩擦公式导出 $u_{\\tau}$ 的初始猜测值，以确保快速收敛。\n6.  一旦求解器收敛到 $u_{\\tau}$ 的解，壁面摩擦系数 $C_f$ 就根据其以 $u_{\\tau}$ 表示的定义进行计算：\n    $$\n    C_f = \\frac{\\tau_w}{\\frac{1}{2}\\rho U_{\\infty}^2} = \\frac{\\rho u_{\\tau}^2}{\\frac{1}{2}\\rho U_{\\infty}^2} = 2 \\left(\\frac{u_{\\tau}}{U_{\\infty}}\\right)^2\n    $$\n7.  为了比较，使用提供的关联式计算经验壁面摩擦系数 $C_{f,\\mathrm{emp}}$：\n    $$\n    C_{f,\\mathrm{emp}} = 0.026 \\, \\mathrm{Re}_x^{-1/7}\n    $$\n8.  每个案例的最终结果是数对 $[C_f, C_{f,\\mathrm{emp}}]$，其值四舍五入到六位小数。\n\n这个过程将湍流建模原理与数值方法相结合，以解决计算流体动力学中的一个实际问题。所指定的涡粘性模型提供了一种比仅仅依赖经验关联式更为基于物理的方法，因为它是由对整个边界层的速度剖面进行积分推导出来的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes skin friction for turbulent boundary layers using an eddy viscosity model\n    and compares it to an empirical correlation for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # U_inf (m/s), nu (m^2/s), x (m), kappa, B (for context), A_plus\n    test_cases = [\n        (30.0, 1.5e-5, 1.0, 0.41, 5.2, 26.0),\n        (10.0, 1.5e-5, 0.5, 0.41, 5.2, 20.0),\n        (50.0, 1.5e-5, 2.0, 0.41, 5.0, 30.0),\n        (5.0, 1.0e-6, 1.0, 0.41, 5.2, 26.0),\n    ]\n\n    results = []\n    for U_inf, nu, x, kappa, B, A_plus in test_cases:\n        # Step 1: Calculate Reynolds number\n        Re_x = U_inf * x / nu\n\n        # Step 2: Calculate empirical C_f for comparison and initial guess\n        C_f_emp = 0.026 * Re_x**(-1.0/7.0)\n\n        # Step 3: Estimate boundary layer thickness\n        delta = 0.37 * x * Re_x**(-1.0/5.0)\n\n        # Step 4: Define the integrand for the velocity profile\n        def integrand(eta, k, A_p):\n            # Damping function f_d\n            f_d = 1.0 - np.exp(-eta / A_p)\n            # Non-dimensional eddy viscosity nu_t^+\n            nu_t_plus = k * eta * f_d**2\n            return 1.0 / (1.0 + nu_t_plus)\n\n        # Step 5: Define the residual function to find u_tau\n        def residual(u_tau):\n            if u_tau == 0:\n                return -np.inf # Physically invalid, ensure solver stays in positive domain\n            \n            # Upper limit of integration in wall units\n            y_plus_delta = u_tau * delta / nu\n            \n            # Use numerical quadrature to compute the integral\n            integral_val, _ = quad(integrand, 0, y_plus_delta, args=(kappa, A_plus))\n            \n            # The function whose root we want to find\n            return integral_val - U_inf / u_tau\n\n        # Step 6: Solve for u_tau using a root-finding algorithm\n        # Provide an initial guess for u_tau from the empirical C_f\n        u_tau_guess = U_inf * np.sqrt(C_f_emp / 2.0)\n        \n        # Use a robust bracketing method for root finding\n        sol = root_scalar(residual, bracket=[u_tau_guess * 0.5, u_tau_guess * 1.5], method='brentq')\n        u_tau_sol = sol.root\n\n        # Step 7: Calculate C_f from the solved u_tau\n        C_f_calc = 2.0 * (u_tau_sol / U_inf)**2\n\n        # Step 8: Store the results\n        results.append([C_f_calc, C_f_emp])\n\n    # Final print statement in the exact required format.\n    string_pairs = [f\"[{pair[0]:.6f},{pair[1]:.6f}]\" for pair in results]\n    print(f\"[{','.join(string_pairs)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后一项练习旨在挑战你对Boussinesq假说本身进行批判性思考。通过分析一个涉及负涡粘度 $ \\mu_t \\lt 0 $ 的假想情景，你将探究其背后深刻的物理及数值意义，例如能量“反向散射”和模型不稳定性。这个思想实验对于深刻理解模型的基本假设及其在应用于复杂非平衡流时的潜在失效模式至关重要。",
            "id": "3950060",
            "problem": "一个不可压缩、密度恒定的湍流剪切流采用雷诺平均纳维-斯托克斯 (RANS) 方程进行建模，并通过 Boussinesq 假设进行封闭。设平均速度在流向 $x$ 方向上为 $U(y,t)$，空间坐标 $y$ 垂直于壁面。流体的分子动力粘度为 $\\mu$，密度为 $\\rho$。Boussinesq 假设将湍流（雷诺）应力建模为 $ \\tau_{ij} = 2 \\mu_t S_{ij} - \\frac{2}{3} \\rho k \\delta_{ij} $，其中 $\\mu_t$ 是湍流（涡）动力粘度，$S_{ij} = \\frac{1}{2}\\left( \\frac{\\partial U_i}{\\partial x_j} + \\frac{\\partial U_j}{\\partial x_i} \\right)$ 是平均应变率张量，$k$ 是湍动能，$\\delta_{ij}$ 是克罗内克 δ。在此平面剪切流中，$U_x = U(y,t)$，$U_y = 0$，且 $S_{ij}$ 唯一非零的分量是 $S_{xy} = S_{yx} = \\frac{1}{2} \\frac{\\partial U}{\\partial y}$。\n\n考虑一个薄层 $y \\in [y_0, y_0 + \\delta]$，在该层中建模的湍流粘度为负值，$\\mu_t(y) = -\\alpha \\mu$，其中 $\\alpha  0$，而在该层之外 $\\mu_t \\ge 0$。假设不可压缩性，因此有 $ \\frac{\\partial U_i}{\\partial x_i} = 0$，并忽略体力。在此一维设定下，平均动量方程简化为\n$$\n\\rho \\frac{\\partial U}{\\partial t} = \\frac{\\partial}{\\partial y} \\left[ \\left( \\mu + \\mu_t \\right) \\frac{\\partial U}{\\partial y} \\right] + \\text{(压力梯度和非线性平流项)}。\n$$\n湍动能生成项由标准定义给出：$P_k = -\\overline{u_i' u_j'} \\frac{\\partial U_i}{\\partial x_j}$，其中 $u_i'$ 是速度脉动。\n\n在 $\\mu_t  0$ 的薄层中，判断下列哪些陈述是正确的。选择所有适用项。\n\nA. 在该层中，湍动能生成项（在 Boussinesq 假设和不可压缩性条件下）简化为 $ P_k = \\frac{\\mu_t}{\\rho} \\left( \\frac{\\partial U}{\\partial y} \\right)^2 $，该值变为负；这表示能量从湍流向平均流转移（能量回输），并与涡粘封闭模型所隐含的耗散性正向级串特性相矛盾。\n\nB. 如果在该层中 $|\\mu_t|  \\mu$，有效运动粘度 $ \\nu_{\\text{eff}} = \\frac{\\mu + \\mu_t}{\\rho} $ 将变为负值，使扩散算子变为反向抛物算子，并导致高波数扰动以 $ \\exp\\left( |\\nu_{\\text{eff}}| k^2 t \\right) $ 的形式增长，这是不适定的，并会导致严重的数值不稳定性。\n\nC. 负的 $\\mu_t$ 仅仅是减小了净粘度；因此它总是起稳定作用，减小梯度并抑制湍流，对能量转移没有影响。\n\nD. 当 $\\mu_t  0$ 且 $ \\frac{\\partial U}{\\partial y}  0 $ 时，湍流剪切应力 $ \\tau_{xy} = \\mu_t \\frac{\\partial U}{\\partial y} $ 为负，与分子剪切应力 $ \\mu \\frac{\\partial U}{\\partial y}  0 $ 的符号相反，这意味着存在一个反扩散的动量通量，它会使平均速度梯度变陡，这与 Boussinesq 型涡粘模型预期的耗散作用相矛盾。\n\nE. 只要分子粘度 $\\mu$ 为正，负 $\\mu_t$ 的存在就是无害的，因为热力学第二定律仅约束 $\\mu$，而 $\\mu_t$ 是一个建模产物，对稳定性或能量收支没有影响。",
            "solution": "用户需要对计算热工学中的一个问题进行批判性评估，特别是关于 RANS 模型中负涡粘度的影响。\n\n### 步骤1：提取已知条件\n-   **流动条件**：不可压缩、密度恒定的湍流剪切流。\n-   **平均速度场**：$U_x = U(y,t)$，$U_y = 0$，$U_z = 0$。坐标 $y$ 垂直于壁面。\n-   **流体性质**：分子动力粘度 $\\mu$，密度 $\\rho$。\n-   **湍流封闭**：通过 Boussinesq 假设封闭的雷诺平均纳维-斯托克斯 (RANS) 方程。\n-   **Boussinesq 假设**：湍流（雷诺）应力建模为 $\\tau_{ij} = 2 \\mu_t S_{ij} - \\frac{2}{3} \\rho k \\delta_{ij}$。\n-   **变量**：$\\mu_t$ 是湍流（涡）动力粘度，$S_{ij} = \\frac{1}{2}\\left( \\frac{\\partial U_i}{\\partial x_j} + \\frac{\\partial U_j}{\\partial x_i} \\right)$ 是平均应变率张量，$k$ 是湍动能，$\\delta_{ij}$ 是克罗内克 δ。\n-   **简化的应变率**：对于给定的平面剪切流，$S_{ij}$ 唯一非零的分量是 $S_{xy} = S_{yx} = \\frac{1}{2} \\frac{\\partial U}{\\partial y}$。\n-   **特定条件**：在一个薄层 $y \\in [y_0, y_0 + \\delta]$ 中，湍流粘度为负，$\\mu_t(y) = -\\alpha \\mu$，其中 $\\alpha  0$。在该层之外，$\\mu_t \\ge 0$。\n-   **控制方程**：\n    -   平均动量方程（简化）：$\\rho \\frac{\\partial U}{\\partial t} = \\frac{\\partial}{\\partial y} \\left[ \\left( \\mu + \\mu_t \\right) \\frac{\\partial U}{\\partial y} \\right] + \\text{(压力梯度和非线性平流项)}$。\n    -   湍动能生成项：$P_k = -\\overline{u_i' u_j'} \\frac{\\partial U_i}{\\partial x_j}$，其中 $u_i'$ 是速度脉动。\n-   **不可压缩性**：$\\frac{\\partial U_i}{\\partial x_i} = 0$。\n-   **体力**：可忽略不计。\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定标准对问题陈述进行批判性评估。\n\n-   **科学依据**：该问题建立在 RANS 和 Boussinesq 假设的湍流建模框架内。动量、应变率和湍流生成项的方程都是标准的。负涡粘度的概念，虽然从简单的梯度扩散角度看是“非物理的”，但在先进的湍流建模中，特别是非平衡流中，是一个已知的产物和研究课题。该问题探讨了这种产物的后果，这是一个有效的科学探究。\n-   **适定性**：该问题以对给定条件（$\\mu_t  0$）的物理和数学影响进行概念分析的形式呈现。它不要求对边值问题进行完整求解，而是要求检查在此条件下控制方程的性质。选项中提出的问题是有意义且可分析的。\n-   **客观性**：问题陈述使用了精确、客观和形式化的科学语言。所提供的定义没有主观性或模糊性。\n-   **自洽性与一致性**：该问题提供了所有必要的定义（$\\tau_{ij}$, $S_{ij}$, $P_k$）和相关的动量方程形式来分析情况。雷诺应力张量 $-\\rho\\overline{u_i'u_j'}$ 与模型 $\\tau_{ij}$ 之间的关系被隐式假定为 $\\tau_{ij} = -\\rho\\overline{u_i'u_j'}$，这是一个常见的约定。对于指定的剪切流，所提供的动量方程与此解释一致。没有内部矛盾。\n-   **其他缺陷**：该问题没有表现出任何其他无效性标志。它不是微不足道的、隐喻性的或无法验证的。这个情景虽然是假设性的，但它是一个用于探究广泛使用的工程模型的局限性和失效模式的形式化设置。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。它代表了流体动力学和湍流建模领域中一个适定的概念性问题。可以进行求解过程。\n\n### 基于原理的推导与分析\n\n该问题要求在 Boussinesq 涡粘框架内分析具有负湍流粘度 $\\mu_t  0$ 的后果。我们将从三个关键方面分析其影响：湍动能生成、平均动量方程的稳定性以及湍流应力的物理解释。\n\n**1. 对湍动能 (TKE) 生成的影响**\n\nTKE 的生成项 $P_k$ 表示从平均流向湍流脉动转移能量的速率。其定义为 $P_k = -\\overline{u_i' u_j'} \\frac{\\partial U_i}{\\partial x_j}$。\n对于指定的平面剪切流 $U_i = (U(y,t), 0, 0)$，与乘积相关的唯一非零平均速度梯度分量是 $\\frac{\\partial U_1}{\\partial x_2} = \\frac{\\partial U}{\\partial y}$。\n因此，生成项的表达式简化为：\n$$P_k = -\\overline{u_x' u_y'} \\frac{\\partial U}{\\partial y}$$\nBoussinesq 假设将雷诺剪切应力 $-\\rho\\overline{u_x' u_y'}$ 与平均应变率联系起来。问题将湍流应力的模型定义为 $\\tau_{ij}$。对于非对角线剪切分量，这给出：\n$$\\tau_{xy} = 2 \\mu_t S_{xy} - \\frac{2}{3} \\rho k \\delta_{xy} = 2 \\mu_t \\left( \\frac{1}{2} \\frac{\\partial U}{\\partial y} \\right) = \\mu_t \\frac{\\partial U}{\\partial y}$$\n假设问题陈述中的 $\\tau_{ij}$ 是雷诺应力张量 $-\\rho \\overline{u_i' u_j'}$ 的模型这一标准约定，我们有 $-\\rho \\overline{u_x' u_y'} = \\mu_t \\frac{\\partial U}{\\partial y}$。\n两边除以 $\\rho$，我们得到 $-\\overline{u_x' u_y'} = \\frac{\\mu_t}{\\rho} \\frac{\\partial U}{\\partial y}$。\n将此代入 $P_k$ 的表达式：\n$$P_k = \\left( \\frac{\\mu_t}{\\rho} \\frac{\\partial U}{\\partial y} \\right) \\frac{\\partial U}{\\partial y} = \\frac{\\mu_t}{\\rho} \\left( \\frac{\\partial U}{\\partial y} \\right)^2$$\n由于 $\\rho  0$ 且 $\\left( \\frac{\\partial U}{\\partial y} \\right)^2 \\ge 0$，所以 $P_k$ 的符号由 $\\mu_t$ 的符号决定。如果 $\\mu_t  0$，则 $P_k \\le 0$。负的 TKE 生成项意味着正常能量级串的逆转；湍流脉动没有从平均流中获得能量来产生湍流，反而是将能量损失给平均流。这个过程被称为“能量回输”。这与简单涡粘模型背后的基本物理图像相矛盾，这些模型假设湍流对平均流而言是一种纯粹的耗散现象，其特征是从大尺度到小尺度的正向能量级串。\n\n**2. 对平均动量方程及稳定性的影响**\n\n所给的平均动量方程是：\n$$\\rho \\frac{\\partial U}{\\partial t} = \\frac{\\partial}{\\partial y} \\left[ \\left( \\mu + \\mu_t \\right) \\frac{\\partial U}{\\partial y} \\right] + \\dots$$\n两边除以 $\\rho$ 并定义一个有效运动粘度 $\\nu_{\\text{eff}} = \\frac{\\mu + \\mu_t}{\\rho}$，该方程呈现为一维反应扩散方程的形式：\n$$\\frac{\\partial U}{\\partial t} = \\frac{\\partial}{\\partial y} \\left( \\nu_{\\text{eff}} \\frac{\\partial U}{\\partial y} \\right) + \\dots = \\nu_{\\text{eff}} \\frac{\\partial^2 U}{\\partial y^2} + \\frac{\\partial \\nu_{\\text{eff}}}{\\partial y} \\frac{\\partial U}{\\partial y} + \\dots$$\n这个偏微分方程 (PDE) 对短波长（高波数）扰动的稳定性由最高阶空间导数的系数符号决定，即 $\\nu_{\\text{eff}}$。\n问题陈述在该层中 $\\mu_t = -\\alpha \\mu$，其中 $\\alpha  0$。\n有效动力粘度为 $\\mu_{\\text{eff}} = \\mu + \\mu_t = \\mu - \\alpha \\mu = \\mu (1-\\alpha)$。\n- 如果 $0  \\alpha  1$，则 $\\mu_{\\text{eff}}  0$。净粘度减小，但方程仍然是正向抛物型扩散方程，是稳定的。\n- 如果 $\\alpha  1$，对应于 $|\\mu_t|  \\mu$，则 $\\mu_{\\text{eff}}  0$。有效运动粘度 $\\nu_{\\text{eff}}$ 变为负值。\n让我们分析当 $\\nu_{\\text{eff}}  0$ 时方程 $\\frac{\\partial U}{\\partial t} = \\nu_{\\text{eff}} \\frac{\\partial^2 U}{\\partial y^2}$ 的稳定性。设 $\\nu_{\\text{eff}} = -|\\nu_{\\text{eff}}|$。该方程是一个反向热方程：$\\frac{\\partial U}{\\partial t} = -|\\nu_{\\text{eff}}| \\frac{\\partial^2 U}{\\partial y^2}$。\n考虑一个形式为 $U'(y,t) = \\hat{U} e^{\\sigma t} e^{iK_y y}$ 的小扰动，其中 $K_y$ 是 $y$ 方向的波数。代入 PDE 得：\n$$\\sigma \\hat{U} e^{\\sigma t} e^{iK_y y} = \\nu_{\\text{eff}} (iK_y)^2 \\hat{U} e^{\\sigma t} e^{iK_y y}$$\n$$\\sigma = \\nu_{\\text{eff}} (-K_y^2) = (-|\\nu_{\\text{eff}}|) (-K_y^2) = |\\nu_{\\text{eff}}| K_y^2$$\n由于 $\\sigma  0$，扰动的振幅会以 $e^{\\sigma t} = \\exp\\left( |\\nu_{\\text{eff}}| K_y^2 t \\right)$ 的形式指数增长。增长率与 $K_y^2$ 成正比，这意味着波长越小（$K_y$ 越大）的扰动增长得越快。这使得问题变得不适定；任何数值模拟都会因高频噪声（如舍入误差）的无界放大而立即失败。\n\n**3. 对湍流剪切应力的影响**\n\n湍流剪切应力建模为 $\\tau_{xy} = \\mu_t \\frac{\\partial U}{\\partial y}$。该应力代表了 $x$ 方向动量在 $y$ 方向的通量。对于典型的边界层，平均速度梯度 $\\frac{\\partial U}{\\partial y}$ 是正的。\n-   **标准情况 ($\\mu_t  0$)**：$\\tau_{xy}  0$。这个正应力作用是减慢较快的流体并加速较慢的流体，导致动量沿着速度梯度向下进行扩散通量，从而使速度剖面变得平滑。这与分子剪切应力 $\\tau_{\\text{mol}, xy} = \\mu \\frac{\\partial U}{\\partial y}  0$ 一致。\n-   **负粘度情况 ($\\mu_t  0$)**：当 $\\frac{\\partial U}{\\partial y}  0$ 时，湍流剪切应力变为 $\\tau_{xy}  0$。该应力的符号与分子应力相反，作用方式违反直觉。负应力意味着动量的“逆梯度”通量，将动量从低速区域输运到高速区域。这个过程是反扩散的，会使速度梯度变陡，而不是使其平滑。这种行为与涡粘模型的初衷完全相悖，涡粘模型的目的是表示由湍流引起的增强混合和耗散。\n\n### 逐项分析选项\n\n**A. 在该层中，湍动能生成项（在 Boussinesq 假设和不可压缩性条件下）简化为 $ P_k = \\frac{\\mu_t}{\\rho} \\left( \\frac{\\partial U}{\\partial y} \\right)^2 $，该值变为负；这表示能量从湍流向平均流转移（能量回输），并与涡粘封闭模型所隐含的耗散性正向级串特性相矛盾。**\n如在第(1)点中推导的，$P_k$ 的公式是正确的。当 $\\mu_t  0$ 时，$P_k$ 变为负值。这正确地将该现象识别为能量回输（能量从湍流转移到平均流），这违反了简单涡粘模型的物理前提。\n**结论：正确。**\n\n**B. 如果在该层中 $|\\mu_t|  \\mu$，有效运动粘度 $ \\nu_{\\text{eff}} = \\frac{\\mu + \\mu_t}{\\rho} $ 将变为负值，使扩散算子变为反向抛物算子，并导致高波数扰动以 $ \\exp\\left( |\\nu_{\\text{eff}}| k^2 t \\right) $ 的形式增长，这是不适定的，并会导致严重的数值不稳定性。**\n如在第(2)点中推导的，如果 $|\\mu_t|  \\mu$，有效粘度 $\\mu + \\mu_t$ 将变为负值。这将扩散项变为反向热方程的扩散项。稳定性分析是正确的，并显示高波数扰动以与波数平方成正比的速率指数增长，导致不适定性和数值发散。（注意：选项中使用 $k$ 表示波数，这与标准符号一致，尽管我为了避免与湍动能 $k$ 混淆而使用了 $K_y$）。\n**结论：正确。**\n\n**C. 负的 $\\mu_t$ 仅仅是减小了净粘度；因此它总是起稳定作用，减小梯度并抑制湍流，对能量转移没有影响。**\n这个陈述在所有方面都是错误的。负的 $\\mu_t$ 可以使净粘度为负，这不仅仅是减小。如B选项所示，这会导致灾难性的不稳定性，而不是稳定。它导致梯度变陡（反扩散），而不是减小。它对TKE收支有直接影响，导致负的生成项。\n**结论：错误。**\n\n**D. 当 $\\mu_t  0$ 且 $ \\frac{\\partial U}{\\partial y}  0 $ 时，湍流剪切应力 $ \\tau_{xy} = \\mu_t \\frac{\\partial U}{\\partial y} $ 为负，与分子剪切应力 $ \\mu \\frac{\\partial U}{\\partial y}  0 $ 的符号相反，这意味着存在一个反扩散的动量通量，它会使平均速度梯度变陡，这与 Boussinesq 型涡粘模型预期的耗散作用相矛盾。**\n如在第(3)点中分析的，负的 $\\mu_t$ 和正的速度梯度导致负的湍流剪切应力，这与正的分子剪切应力相反。这描述了一种反扩散或逆梯度的动量输运。正如稳定性分析（第2点）所确立的，这样的系统会导致梯度变陡。这种行为与涡粘模型旨在捕捉的耗散和扩散性质相反。\n**结论：正确。**\n\n**E. 只要分子粘度 $\\mu$ 为正，负 $\\mu_t$ 的存在就是无害的，因为热力学第二定律仅约束 $\\mu$，而 $\\mu_t$ 是一个建模产物，对稳定性或能量收支没有影响。**\n这个陈述有根本性缺陷。虽然热力学第二定律直接约束 $\\mu \\ge 0$ 且 $\\mu_t$ 是一个建模系数是正确的，但声称它没有后果是错误的。模型方程的数学行为完全由其内部的系数决定。如A和B选项所示，负的 $\\mu_t$ 对能量收支（$P_k0$）和动量方程的数学稳定性都有严重后果，在 $|\\mu_t|  \\mu$ 时使模型不适定。一个具有如此后果的“建模产物”并非“无害的”。\n**结论：错误。**",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}