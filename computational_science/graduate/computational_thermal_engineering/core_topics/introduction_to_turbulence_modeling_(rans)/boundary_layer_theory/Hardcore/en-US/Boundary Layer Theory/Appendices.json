{
    "hands_on_practices": [
        {
            "introduction": "Before tackling the full complexity of the boundary layer equations, it is crucial to develop a physical intuition for the relative importance of different terms. This practice guides you through a foundational order-of-magnitude analysis, the very technique Prandtl used to simplify the Navier-Stokes equations. By comparing the scale of inertial and viscous forces, you will derive the classic scaling laws for the growth of a laminar boundary layer and the magnitude of the wall-normal velocity, solidifying your understanding of the boundary layer's slender nature. ",
            "id": "3938948",
            "problem": "Consider a steady, two-dimensional, incompressible laminar boundary layer forming on a semi-infinite flat plate aligned with a uniform free stream of speed $U_{\\infty}$ at zero pressure gradient. Starting from the continuity equation and the streamwise momentum equation for a Newtonian fluid, use the boundary layer approximation to perform an order-of-magnitude analysis that yields a scaling for the boundary layer thickness $\\delta(x)$ at a downstream position $x$. Then use the same framework to obtain the scaling of the wall-normal velocity magnitude $v$ inside the boundary layer.\n\nUsing your derived scaling laws, evaluate $\\delta(x)$ and the wall-normal velocity scale $v$ at $x=0.5\\,\\mathrm{m}$ for $U_{\\infty}=10\\,\\mathrm{m/s}$ and kinematic viscosity $\\nu=1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$. Assume the laminar scaling prefactor is unity, interpret the Reynolds number based on $x$ as $Re_{x} = U_{\\infty} x / \\nu$, and take the wall-normal velocity scale as $U_{\\infty}\\,\\delta/x$.\n\nExpress the boundary layer thickness in meters and the wall-normal velocity scale in meters per second. Round your final numerical values to four significant figures. Your final answer must be presented as a single row of two quantities: first $\\delta(x)$, second the wall-normal velocity scale.",
            "solution": "The problem requires an order-of-magnitude analysis of the boundary layer equations for a steady, two-dimensional, incompressible laminar flow over a semi-infinite flat plate at zero pressure gradient. This analysis will yield scaling laws for the boundary layer thickness $\\delta(x)$ and the wall-normal velocity component $v$. Following the derivation, these scaling laws will be used to compute numerical values for the given flow conditions.\n\nThe governing equations for this flow are the continuity and streamwise momentum equations for a Newtonian fluid, which are:\nContinuity:\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0\n$$\nStreamwise Momentum:\n$$\nu \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = -\\frac{1}{\\rho}\\frac{d p}{d x} + \\nu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\nwhere $u$ and $v$ are the velocity components in the streamwise ($x$) and wall-normal ($y$) directions, respectively, $\\rho$ is the fluid density, $p$ is the pressure, and $\\nu$ is the kinematic viscosity. The problem states a zero pressure gradient, so $\\frac{dp}{dx} = 0$.\n\nWe perform an order-of-magnitude analysis by defining characteristic scales for the variables within the boundary layer of thickness $\\delta$ at a downstream location $x$.\nThe characteristic length scales are $x$ in the streamwise direction and $\\delta$ in the wall-normal direction. We make the fundamental boundary layer assumption that $\\delta \\ll x$.\nThe characteristic velocity scale in the streamwise direction is the free-stream velocity, $U_{\\infty}$, so $u \\sim U_{\\infty}$. The characteristic scale for the wall-normal velocity is unknown, denoted as $v \\sim v_{scale}$.\n\nFirst, we analyze the continuity equation:\n$$\n\\frac{\\partial u}{\\partial x} \\sim \\frac{U_{\\infty}}{x} \\quad \\text{and} \\quad \\frac{\\partial v}{\\partial y} \\sim \\frac{v_{scale}}{\\delta}\n$$\nFor the two terms in the continuity equation to balance, they must be of the same order of magnitude:\n$$\n\\frac{v_{scale}}{\\delta} \\sim \\frac{U_{\\infty}}{x} \\implies v_{scale} \\sim U_{\\infty} \\frac{\\delta}{x}\n$$\nThis provides the scaling for the wall-normal velocity magnitude. Since $\\delta \\ll x$, it follows that $v_{scale} \\ll U_{\\infty}$.\n\nNext, we analyze the terms in the streamwise momentum equation:\nInertial terms (left-hand side):\n$$\nu \\frac{\\partial u}{\\partial x} \\sim U_{\\infty} \\left( \\frac{U_{\\infty}}{x} \\right) = \\frac{U_{\\infty}^2}{x}\n$$\n$$\nv \\frac{\\partial u}{\\partial y} \\sim \\left( U_{\\infty} \\frac{\\delta}{x} \\right) \\left( \\frac{U_{\\infty}}{\\delta} \\right) = \\frac{U_{\\infty}^2}{x}\n$$\nBoth inertial terms are of the same order of magnitude.\n\nViscous terms (right-hand side, with $\\frac{dp}{dx}=0$):\n$$\n\\nu \\frac{\\partial^2 u}{\\partial x^2} \\sim \\nu \\frac{U_{\\infty}}{x^2}\n$$\n$$\n\\nu \\frac{\\partial^2 u}{\\partial y^2} \\sim \\nu \\frac{U_{\\infty}}{\\delta^2}\n$$\nBecause $\\delta \\ll x$, we have $\\delta^2 \\ll x^2$, which implies $\\frac{1}{\\delta^2} \\gg \\frac{1}{x^2}$. Therefore, the viscous diffusion in the streamwise direction is negligible compared to the diffusion in the wall-normal direction: $\\nu \\frac{\\partial^2 u}{\\partial y^2} \\gg \\nu \\frac{\\partial^2 u}{\\partial x^2}$.\n\nThe essence of the boundary layer is the balance between inertial and viscous forces. Thus, the order of magnitude of the inertial terms must be comparable to that of the dominant viscous term:\n$$\n\\underbrace{\\frac{U_{\\infty}^2}{x}}_{\\text{Inertia}} \\sim \\underbrace{\\nu \\frac{U_{\\infty}}{\\delta^2}}_{\\text{Viscous}}\n$$\nSolving for the boundary layer thickness squared, $\\delta^2$:\n$$\n\\delta^2 \\sim \\frac{\\nu x U_{\\infty}}{U_{\\infty}^2} = \\frac{\\nu x}{U_{\\infty}}\n$$\nThis gives the scaling for the boundary layer thickness:\n$$\n\\delta(x) \\sim \\sqrt{\\frac{\\nu x}{U_{\\infty}}}\n$$\nTo express this in a non-dimensional form, we divide by $x$ and introduce the Reynolds number based on $x$, $Re_x = \\frac{U_{\\infty} x}{\\nu}$:\n$$\n\\frac{\\delta(x)}{x} \\sim \\sqrt{\\frac{\\nu}{U_{\\infty} x}} = \\frac{1}{\\sqrt{\\frac{U_{\\infty} x}{\\nu}}} = \\frac{1}{\\sqrt{Re_x}}\n$$\nThis confirms the classic scaling law $\\delta(x)/x \\propto Re_x^{-1/2}$.\n\nNow, we proceed with the numerical evaluation using the given data: $x=0.5\\,\\mathrm{m}$, $U_{\\infty}=10\\,\\mathrm{m/s}$, and $\\nu=1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$.\nFirst, we calculate the Reynolds number $Re_x$:\n$$\nRe_x = \\frac{U_{\\infty} x}{\\nu} = \\frac{(10\\,\\mathrm{m/s})(0.5\\,\\mathrm{m})}{1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}} = \\frac{5}{1.5 \\times 10^{-5}} = \\frac{10}{3} \\times 10^5 \\approx 333333\n$$\nThe problem specifies to assume the laminar scaling prefactor is unity. Therefore, we use the relation $\\delta(x)/x = Re_x^{-1/2}$ directly.\n$$\n\\delta(x) = x \\, Re_x^{-1/2} = x \\sqrt{\\frac{\\nu}{U_{\\infty} x}} = \\sqrt{\\frac{\\nu x}{U_{\\infty}}}\n$$\nSubstituting the numerical values for $\\delta(x)$ at $x=0.5\\,\\mathrm{m}$:\n$$\n\\delta(0.5) = \\sqrt{\\frac{(1.5 \\times 10^{-5}\\,\\mathrm{m^2/s})(0.5\\,\\mathrm{m})}{10\\,\\mathrm{m/s}}} = \\sqrt{0.75 \\times 10^{-6}}\\,\\mathrm{m} = \\sqrt{75 \\times 10^{-8}}\\,\\mathrm{m}\n$$\n$$\n\\delta(0.5) = \\sqrt{25 \\times 3} \\times 10^{-4}\\,\\mathrm{m} = 5\\sqrt{3} \\times 10^{-4}\\,\\mathrm{m} \\approx 8.660254 \\times 10^{-4}\\,\\mathrm{m}\n$$\nRounding to four significant figures, the boundary layer thickness is $\\delta(0.5) = 0.0008660\\,\\mathrm{m}$.\n\nNext, we calculate the wall-normal velocity scale, $v$. The problem specifies using the relation $v = U_{\\infty} \\frac{\\delta}{x}$, which is consistent with our derived scaling.\n$$\nv = (10\\,\\mathrm{m/s}) \\times \\frac{8.660254 \\times 10^{-4}\\,\\mathrm{m}}{0.5\\,\\mathrm{m}} = 20 \\times (8.660254 \\times 10^{-4})\\,\\mathrm{m/s} \\approx 0.0173205\\,\\mathrm{m/s}\n$$\nRounding to four significant figures, the wall-normal velocity scale is $v = 0.01732\\,\\mathrm{m/s}$.\n\nThe final results are the boundary layer thickness and the wall-normal velocity scale, rounded to four significant figures.\n$\\delta(0.5) = 0.0008660\\,\\mathrm{m}$\n$v = 0.01732\\,\\mathrm{m/s}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.0008660  0.01732\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The scaling analysis simplifies the governing partial differential equations, and for the canonical case of a flat plate, these equations admit a \"similarity solution\" that reduces them to a single ordinary differential equation—the celebrated Blasius equation. This practice challenges you to solve this cornerstone boundary value problem numerically using a shooting method, a powerful and widely applicable technique. By finding the unknown initial condition that satisfies the far-field boundary condition, you will determine the dimensionless wall shear stress, a quantity of immense practical importance. ",
            "id": "3938896",
            "problem": "Consider the two-dimensional, steady, incompressible, laminar boundary layer that forms over a semi-infinite flat plate aligned with a uniform free-stream velocity $U_{\\infty}$. Starting from the conservation of mass and momentum for boundary-layer flow, the governing equations are the continuity equation $\\partial u / \\partial x + \\partial v / \\partial y = 0$ and the streamwise momentum equation $u \\, \\partial u / \\partial x + v \\, \\partial u / \\partial y = \\nu \\, \\partial^2 u / \\partial y^2$, where $u(x,y)$ and $v(x,y)$ are the velocity components in the streamwise and wall-normal directions, respectively, and $\\nu$ is the kinematic viscosity. Seeking a similarity solution with a streamfunction representation and a properly scaled similarity variable reduces the partial differential equations to the classical Blasius ordinary differential equation (ODE) for a dimensionless streamfunction profile $f(\\eta)$,\n$$\nf'''(\\eta) + \\tfrac{1}{2} f(\\eta) \\, f''(\\eta) = 0,\n$$\nwith boundary conditions\n$$\nf(0) = 0, \\quad f'(0) = 0, \\quad \\text{and} \\quad f'(\\eta \\to \\infty) = 1,\n$$\nwhere primes denote differentiation with respect to the similarity variable $\\eta$. The quantity of interest is the unknown initial curvature $f''(0)$, which determines the wall shear stress and is a dimensionless number.\n\nYour task is to implement a numerical shooting method to solve the above initial value problem (IVP) and determine $f''(0)$ to at least four significant figures. Treat $s = f''(0)$ as a shooting parameter. For any trial $s$, integrate the Blasius ODE as a first-order system from $\\eta = 0$ to a finite truncation $\\eta = L$ using a modern adaptive ODE solver. Define the residual\n$$\nR(s; L) = f'(\\eta = L; s) - 1,\n$$\nand find $s$ such that $R(s; L) = 0$. Compare your computed $s$ against the classical reference value $s_{\\mathrm{ref}} = 0.332057336215$ and assess whether the result has at least four significant figures correct. For this assessment, declare a pass if the absolute error $|s - s_{\\mathrm{ref}}| \\le 0.00005$, which guarantees correct rounding to four significant figures for a value near $s_{\\mathrm{ref}}$.\n\nThe solution must be purely algorithmic and dimensionless. Implement your solver in a single program that produces the required outputs without any external input. Use an adaptive ODE integrator from a standard scientific library to handle the IVP accurately. You may use a one-dimensional root-finding method such as bisection or secant for the shooting parameter.\n\nTest Suite:\nProvide results for the following parameter sets $(L, \\mathrm{rtol}, \\mathrm{atol})$, where $L$ is the finite truncation in the similarity variable and $\\mathrm{rtol}$ and $\\mathrm{atol}$ are the relative and absolute tolerances of the ODE solver, respectively. All quantities are dimensionless.\n\n- Case $1$: $(L, \\mathrm{rtol}, \\mathrm{atol}) = (10.0, 10^{-9}, 10^{-11})$.\n- Case $2$: $(L, \\mathrm{rtol}, \\mathrm{atol}) = (4.0, 10^{-8}, 10^{-10})$.\n- Case $3$: $(L, \\mathrm{rtol}, \\mathrm{atol}) = (20.0, 10^{-8}, 10^{-10})$.\n- Case $4$: $(L, \\mathrm{rtol}, \\mathrm{atol}) = (10.0, 10^{-6}, 10^{-8})$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case and must be a three-element list of the form $[s, e, p]$, where $s$ is the computed $f''(0)$ rounded to six decimal places, $e$ is the absolute error $|s - s_{\\mathrm{ref}}|$ rounded to six decimal places, and $p$ is a boolean indicating whether the four-significant-figure criterion is satisfied. For example, the output format must be\n$$\n[[s_1, e_1, p_1],[s_2, e_2, p_2],[s_3, e_3, p_3],[s_4, e_4, p_4]].\n$$",
            "solution": "The user has presented a problem that is scientifically grounded, well-posed, and objective. It involves the numerical solution of the Blasius equation, a classical problem in fluid mechanics, using a standard shooting method. All required data, boundary conditions, and evaluation criteria are provided. The problem is valid.\n\nThe core task is to solve a third-order nonlinear ordinary differential equation (ODE) boundary value problem (BVP) for the dimensionless streamfunction profile $f(\\eta)$. The ODE is the Blasius equation:\n$$\nf'''(\\eta) + \\tfrac{1}{2} f(\\eta) \\, f''(\\eta) = 0\n$$\nsubject to the boundary conditions:\n$$\nf(0) = 0, \\quad f'(0) = 0, \\quad \\text{and} \\quad f'(\\eta \\to \\infty) = 1\n$$\nThe objective is to find the value of the unknown initial condition $f''(0)$. This type of BVP is well-suited for a shooting method, which transforms the BVP into an initial value problem (IVP) that can be solved iteratively.\n\n**Step 1: Conversion to a System of First-Order ODEs**\nTo use standard IVP solvers, the third-order ODE must be converted into a system of three first-order ODEs. We define a state vector $y(\\eta)$ as:\n$$\ny(\\eta) = \\begin{bmatrix} y_0(\\eta) \\\\ y_1(\\eta) \\\\ y_2(\\eta) \\end{bmatrix} = \\begin{bmatrix} f(\\eta) \\\\ f'(\\eta) \\\\ f''(\\eta) \\end{bmatrix}\n$$\nThe derivatives of the components of $y$ with respect to $\\eta$ form the system:\n$$\n\\frac{d y}{d \\eta} = \\begin{bmatrix} y_0' \\\\ y_1' \\\\ y_2' \\end{bmatrix} = \\begin{bmatrix} f' \\\\ f'' \\\\ f''' \\end{bmatrix} = \\begin{bmatrix} y_1 \\\\ y_2 \\\\ -\\frac{1}{2} f f'' \\end{bmatrix} = \\begin{bmatrix} y_1 \\\\ y_2 \\\\ -0.5 \\, y_0 \\, y_2 \\end{bmatrix}\n$$\nThis is the system of first-order ODEs that will be integrated numerically.\n\n**Step 2: The Shooting Method**\nThe shooting method addresses the missing initial condition, $f''(0)$, by treating it as a parameter, which we will call $s$. We \"shoot\" solutions from $\\eta=0$ by guessing $s$ and integrating the IVP. The goal is to adjust $s$ until the boundary condition at the far end of the domain is met.\n\nThe initial conditions for the IVP at $\\eta=0$ are:\n$$\nf(0) = 0 \\quad \\implies \\quad y_0(0) = 0\n$$\n$$\nf'(0) = 0 \\quad \\implies \\quad y_1(0) = 0\n$$\nThe missing condition is our shooting parameter:\n$$\nf''(0) = s \\quad \\implies \\quad y_2(0) = s\n$$\nThus, the initial state vector for our IVP is $y(0) = [0, 0, s]^T$.\n\nThe boundary condition at infinity, $f'(\\eta \\to \\infty) = 1$, is numerically intractable. We approximate it by enforcing the condition at a finite, but sufficiently large, value of the similarity variable, $\\eta = L$. The condition becomes $f'(L; s) = 1$, or in terms of our state vector, $y_1(L; s) = 1$. The parameter $L$ is one of the inputs specified in the test suite.\n\nWe define a residual function, $R(s; L)$, which measures how far a given guess $s$ is from satisfying the far-field boundary condition:\n$$\nR(s; L) = y_1(L; s) - 1\n$$\nThe problem is now reduced to finding the root of the equation $R(s;L) = 0$.\n\n**Step 3: Numerical Implementation**\nThe overall algorithm is as follows:\n1.  For each test case, specified by the tuple $(L, \\mathrm{rtol}, \\mathrm{atol})$, we need to find the value of $s$ that solves $R(s; L) = 0$.\n2.  The evaluation of the residual function $R(s; L)$ for any given $s$ requires the numerical integration of the first-order ODE system from $\\eta=0$ to $\\eta=L$ with the initial condition $y(0) = [0, 0, s]^T$. This integration is performed using a modern adaptive ODE solver, specifically `scipy.integrate.solve_ivp`, with the provided relative tolerance `rtol` and absolute tolerance `atol`. This solver automatically adjusts its internal step size to achieve the desired accuracy.\n3.  A robust one-dimensional root-finding algorithm is used to find the value of $s$ for which $R(s; L) = 0$. The `scipy.optimize.brentq` function, which implements Brent's method, is an excellent choice. It requires a bracket, an interval $[s_a, s_b]$, where the residual function has opposite signs at the endpoints, i.e., $R(s_a; L) \\times R(s_b; L)  0$. A suitable bracket is $[0, 1]$. For $s=0$, the solution is trivially $f(\\eta)=0$, so $y_1(L)=0$ and $R(0; L) = -1$. For $s=1$, the initial curvature is large, and we expect the velocity profile to overshoot the target, making $y_1(L)  1$ and thus $R(1; L)  0$. This bracket guarantees a root.\n4.  Once the root $s$ (our approximation of $f''(0)$) is found, it is compared against the high-precision reference value $s_{\\mathrm{ref}} = 0.332057336215$. The absolute error $e = |s - s_{\\mathrm{ref}}|$ is calculated.\n5.  A pass/fail flag, $p$, is set to `True` if the accuracy criterion, $e \\le 0.00005$, is met, and `False` otherwise.\n6.  The computed value $s$ and the error $e$ are rounded to six decimal places, and the triplet $[s, e, p]$ is stored. This process is repeated for all test cases.\n\nThe final output is a list of these triplets, formatted as a string according to the problem specification.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Blasius equation for f''(0) using a shooting method\n    for a suite of test cases and formats the output.\n    \"\"\"\n\n    # High-precision reference value for f''(0)\n    S_REF = 0.332057336215\n    # Accuracy criterion for passing the test\n    PASS_CRITERION = 0.00005\n\n    def blasius_ode_system(eta, y):\n        \"\"\"\n        Defines the first-order ODE system for the Blasius equation.\n        The state vector y is [f, f', f''].\n        The system returns [y', y'', y'''] = [f', f'', f'''].\n        The Blasius equation is f''' = -0.5 * f * f''.\n        \"\"\"\n        return [y[1], y[2], -0.5 * y[0] * y[2]]\n\n    def solve_blasius(L, rtol, atol):\n        \"\"\"\n        Finds s = f''(0) for a given set of numerical parameters.\n\n        It uses a root-finding algorithm (Brent's method) on a residual\n        function. The residual represents the error in the far-field\n        boundary condition f'(L) = 1.\n\n        Args:\n            L (float): Finite truncation of the semi-infinite domain.\n            rtol (float): Relative tolerance for the ODE solver.\n            atol (float): Absolute tolerance for the ODE solver.\n\n        Returns:\n            float: The computed value of s = f''(0).\n        \"\"\"\n        \n        def residual(s):\n            \"\"\"\n            Computes the residual R(s) = f'(L; s) - 1.\n            This function is the target for the root-finder.\n            It solves the IVP for a given shooting parameter s.\n            \"\"\"\n            # Initial conditions: y(0) = [f(0), f'(0), f''(0)]\n            y0 = [0.0, 0.0, s]\n            \n            # Solve the IVP from eta=0 to eta=L\n            sol = solve_ivp(\n                fun=blasius_ode_system,\n                t_span=[0, L],\n                y0=y0,\n                method='RK45',  # Adaptive Runge-Kutta method\n                rtol=rtol,\n                atol=atol\n            )\n            \n            # Extract f'(L), which is the second component of the solution\n            # at the last time point.\n            f_prime_at_L = sol.y[1, -1]\n            return f_prime_at_L - 1.0\n\n        # Find the root of the residual function s.\n        # A bracket of [0, 1] is robust:\n        # s=0 - f'=0 - residual=-1\n        # s=1 - f' overshoots 1 - residual  0\n        try:\n            s_solution = brentq(residual, a=0.0, b=1.0, xtol=1e-15, rtol=1e-15)\n        except ValueError:\n            # In case the bracket is invalid for extreme parameters,\n            # which shouldn't happen for this problem.\n            return np.nan\n            \n        return s_solution\n\n    # Test suite provided in the problem statement\n    test_cases = [\n        (10.0, 1e-9, 1e-11),\n        (4.0, 1e-8, 1e-10),\n        (20.0, 1e-8, 1e-10),\n        (10.0, 1e-6, 1e-8),\n    ]\n\n    results = []\n    for L, rtol, atol in test_cases:\n        s_computed = solve_blasius(L, rtol, atol)\n        \n        error = abs(s_computed - S_REF)\n        passed = (error = PASS_CRITERION)\n        \n        s_rounded = round(s_computed, 6)\n        error_rounded = round(error, 6)\n        \n        results.append([s_rounded, error_rounded, passed])\n\n    # Generate the output string in the exact specified format.\n    # The default string representation of a list of lists matches the format,\n    # and spaces are removed to be precise.\n    output_string = str(results).replace(\" \", \"\")\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "While similarity solutions offer deep insight, their applicability is limited to specific flow configurations. Integral methods, pioneered by von Kármán, provide a more flexible framework for analyzing boundary layers and are indispensable for processing experimental and computational data. This exercise places you in the role of a data analyst, tasking you with computing integral parameters like displacement thickness ($\\delta^*$) and momentum thickness ($\\theta$) from a discrete velocity profile. You will then apply the momentum integral relation to infer the wall shear stress, a skill that directly connects theoretical concepts to practical engineering measurements. ",
            "id": "3938934",
            "problem": "Consider a steady, incompressible, two-dimensional laminar boundary layer over a smooth, flat plate with zero streamwise pressure gradient. A measurement system provides discrete velocity profiles normal to the wall at two nearby streamwise locations, one of which is at $x=0.3\\,\\mathrm{m}$. Using only fundamental definitions and the boundary-layer momentum integral relation, you must compute the displacement thickness and the momentum thickness at the downstream station $x=0.3\\,\\mathrm{m}$ from the discrete data, and then infer the wall shear stress and the skin-friction coefficient at $x=0.3\\,\\mathrm{m}$.\n\nAll computations must be based on the following principles:\n- The displacement thickness $\\delta^\\*$ is defined by\n$$\n\\delta^\\* \\equiv \\int_{0}^{\\infty} \\left(1 - \\frac{u(y)}{U_\\infty}\\right)\\,\\mathrm{d}y,\n$$\nwhere $u(y)$ is the local mean streamwise velocity at wall-normal coordinate $y$ and $U_\\infty$ is the free-stream velocity.\n- The momentum thickness $\\theta$ is defined by\n$$\n\\theta \\equiv \\int_{0}^{\\infty} \\frac{u(y)}{U_\\infty}\\left(1 - \\frac{u(y)}{U_\\infty}\\right)\\,\\mathrm{d}y.\n$$\n- Under the stated conditions (steady, incompressible, two-dimensional, zero pressure gradient), the streamwise momentum integral relation specialized to a flat plate relates the wall shear stress $\\tau_w$ to the streamwise evolution of the momentum thickness.\n\nYou must treat the integrals from $y=0$ to a finite $y_{\\max}$ provided as part of the discrete data, using a consistent numerical quadrature method designed for nonuniform grids. The velocity profiles are provided as discrete samples $(y_i, u_i)$, where $i$ indexes the samples and $y_0=0$ corresponds to the wall.\n\nYou are given a test suite of three scenarios. In each scenario, the discrete profiles at two streamwise locations $x_1$ and $x_2$ (with $x_2=0.3\\,\\mathrm{m}$) must be used. The free-stream velocity $U_\\infty$ and the fluid density $\\rho$ are given. The discrete profiles are generated using a widely used fourth-degree Pohlhausen-type polynomial approximation for a laminar zero-pressure-gradient boundary layer:\n$$\n\\frac{u(y;x)}{U_\\infty} =\n\\begin{cases}\n2\\eta - 2\\eta^3 + \\eta^4,  \\text{if } \\eta \\le 1,\\\\\n1,  \\text{if } \\eta  1,\n\\end{cases}\n\\quad \\text{with} \\quad \\eta \\equiv \\frac{y}{\\delta(x)},\n$$\nwhere $\\delta(x)$ is a prescribed boundary-layer thickness parameter for profile generation. The discrete sample points are uniformly spaced between $y=0$ and $y=y_{\\max}$ with a specified number of points $N$, and the velocity $u(y;x)$ at each $y$ is determined by the above expression.\n\nFor each scenario, compute at $x=x_2$:\n- The displacement thickness $\\delta^\\*$ in $\\mathrm{m}$.\n- The momentum thickness $\\theta$ in $\\mathrm{m}$.\n- The wall shear stress $\\tau_w$ in $\\mathrm{Pa}$ (Pascal), inferred via the boundary-layer momentum integral relation and a consistent numerical approximation of $\\mathrm{d}\\theta/\\mathrm{d}x$ using the two stations $x_1$ and $x_2$.\n- The skin-friction coefficient (dimensionless), defined as $C_f \\equiv \\tau_w/\\left(\\frac{1}{2}\\rho U_\\infty^2\\right)$.\n\nUse radians for any angles if they appear in intermediate calculations, although angles are not explicitly required in this problem. Express the final numerical results in the specified units, and round each output number to six decimal places.\n\nTest suite parameter sets:\n- Scenario $1$ (happy path):\n    - $U_\\infty = 10.0\\,\\mathrm{m/s}$, $\\rho = 1.20\\,\\mathrm{kg/m^3}$, $x_1 = 0.295\\,\\mathrm{m}$, $x_2 = 0.300\\,\\mathrm{m}$,\n    - $y_{\\max} = 0.015\\,\\mathrm{m}$, $N = 61$,\n    - $\\delta(x_1) = 0.00335\\,\\mathrm{m}$, $\\delta(x_2) = 0.00340\\,\\mathrm{m}$.\n- Scenario $2$ (coarse wall-normal sampling):\n    - $U_\\infty = 20.0\\,\\mathrm{m/s}$, $\\rho = 1.20\\,\\mathrm{kg/m^3}$, $x_1 = 0.290\\,\\mathrm{m}$, $x_2 = 0.300\\,\\mathrm{m}$,\n    - $y_{\\max} = 0.012\\,\\mathrm{m}$, $N = 11$,\n    - $\\delta(x_1) = 0.00236\\,\\mathrm{m}$, $\\delta(x_2) = 0.00240\\,\\mathrm{m}$.\n- Scenario $3$ (small streamwise separation):\n    - $U_\\infty = 5.0\\,\\mathrm{m/s}$, $\\rho = 1.20\\,\\mathrm{kg/m^3}$, $x_1 = 0.299\\,\\mathrm{m}$, $x_2 = 0.300\\,\\mathrm{m}$,\n    - $y_{\\max} = 0.018\\,\\mathrm{m}$, $N = 41$,\n    - $\\delta(x_1) = 0.00475\\,\\mathrm{m}$, $\\delta(x_2) = 0.00480\\,\\mathrm{m}$.\n\nYour program must:\n- Generate the discrete profiles using the parameters above.\n- Compute $\\delta^\\*$ and $\\theta$ at $x_2$ from the discrete data using a composite trapezoidal rule suitable for nonuniform grids.\n- Approximate $\\mathrm{d}\\theta/\\mathrm{d}x$ between $x_1$ and $x_2$ using a finite difference based on the two measured profiles.\n- Infer $\\tau_w$ and $C_f$ at $x_2$ using the integral relation under zero pressure gradient.\n\nFinal output format specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- The list must contain the concatenated results for the three scenarios in order, with each scenario contributing four numbers in the order $\\left[\\delta^\\*, \\theta, \\tau_w, C_f\\right]$.\n- For example, the output should look like $\\left[\\delta^\\*_1,\\theta_1,\\tau_{w,1},C_{f,1},\\delta^\\*_2,\\theta_2,\\tau_{w,2},C_{f,2},\\delta^\\*_3,\\theta_3,\\tau_{w,3},C_{f,3}\\right]$, with each number rounded to six decimal places.",
            "solution": "The problem is framed in the context of boundary layer theory for steady, incompressible, two-dimensional flow over a flat plate with zero pressure gradient. The derivation proceeds from fundamental definitions and the boundary-layer momentum integral relation.\n\nBegin with the core definitions, which do not rely on any specific closed-form solution but only on the measured profiles. The displacement thickness $\\delta^\\*$ is defined as\n$$\n\\delta^\\* = \\int_0^\\infty \\left(1 - \\frac{u(y)}{U_\\infty}\\right)\\,\\mathrm{d}y,\n$$\nand the momentum thickness $\\theta$ is defined as\n$$\n\\theta = \\int_0^\\infty \\frac{u(y)}{U_\\infty}\\left(1 - \\frac{u(y)}{U_\\infty}\\right)\\,\\mathrm{d}y.\n$$\nBecause measurements are available only up to a finite $y_{\\max}$, we approximate the semi-infinite integral by truncating at $y_{\\max}$:\n$$\n\\delta^\\* \\approx \\int_0^{y_{\\max}} \\left(1 - \\frac{u(y)}{U_\\infty}\\right)\\,\\mathrm{d}y,\\quad\n\\theta \\approx \\int_0^{y_{\\max}} \\frac{u(y)}{U_\\infty}\\left(1 - \\frac{u(y)}{U_\\infty}\\right)\\,\\mathrm{d}y.\n$$\nThese integrals are computed numerically using a composite trapezoidal rule on the discrete nonuniform grid $\\{y_i\\}_{i=0}^{N-1}$. If we denote the integrand for $\\delta^\\*$ as $f(y) = 1 - u(y)/U_\\infty$ and for $\\theta$ as $g(y) = (u/U_\\infty)(1 - u/U_\\infty)$, then the composite trapezoidal rule yields\n$$\n\\int_0^{y_{\\max}} f(y)\\,\\mathrm{d}y \\approx \\sum_{i=0}^{N-2} \\frac{f(y_i) + f(y_{i+1})}{2}\\,(y_{i+1} - y_i),\n$$\nand analogously for $\\int_0^{y_{\\max}} g(y)\\,\\mathrm{d}y$.\n\nTo infer the wall shear stress $\\tau_w$ via the integral relation, we invoke the boundary-layer momentum integral equation derived by integrating the Navier–Stokes equations across the boundary layer. For steady, incompressible, two-dimensional flow over a flat plate with zero pressure gradient and constant free-stream velocity $U_\\infty$, this relation is specialized to\n$$\n\\frac{\\mathrm{d}\\theta}{\\mathrm{d}x} = \\frac{\\tau_w}{\\rho U_\\infty^2}.\n$$\nThis equation is a statement of streamwise momentum balance for the boundary layer: the growth rate of the momentum thickness with respect to $x$ is directly proportional to the normalized wall shear stress. Rearranging gives\n$$\n\\tau_w = \\rho U_\\infty^2\\,\\frac{\\mathrm{d}\\theta}{\\mathrm{d}x}.\n$$\nThe skin-friction coefficient (first defined here) is $C_f \\equiv \\tau_w/\\left(\\frac{1}{2}\\rho U_\\infty^2\\right)$, leading to\n$$\nC_f = \\frac{\\tau_w}{\\frac{1}{2}\\rho U_\\infty^2} = 2\\,\\frac{\\mathrm{d}\\theta}{\\mathrm{d}x}.\n$$\nThe required derivative $\\mathrm{d}\\theta/\\mathrm{d}x$ is not provided analytically, so we approximate it using a finite difference between the two nearby stations $x_1$ and $x_2$:\n$$\n\\frac{\\mathrm{d}\\theta}{\\mathrm{d}x}\\bigg|_{x_2} \\approx \\frac{\\theta(x_2) - \\theta(x_1)}{x_2 - x_1}.\n$$\nThis approximation is consistent for sufficiently small $|x_2 - x_1|$, as in the provided scenarios.\n\nAlgorithmic design to compute the requested quantities for each scenario:\n1. Generate the discrete wall-normal grid $\\{y_i\\}$ from $y=0$ to $y=y_{\\max}$ with $N$ uniformly spaced points, using $y_i = i\\,\\Delta y$ where $\\Delta y = y_{\\max}/(N-1)$.\n2. Generate the discrete velocity profiles at $x_1$ and $x_2$ using the Pohlhausen-type polynomial for zero pressure gradient:\n   - Define $\\eta_i(x) = y_i/\\delta(x)$.\n   - Compute $u_i(x)/U_\\infty = 2\\eta_i - 2\\eta_i^3 + \\eta_i^4$ if $\\eta_i \\le 1$, and $u_i(x)/U_\\infty = 1$ otherwise.\n   - Multiply by $U_\\infty$ to obtain $u_i(x)$ at each grid point.\n3. Compute $\\delta^\\*(x_2)$ and $\\theta(x_2)$ using the composite trapezoidal rule:\n   - For $\\delta^\\*$, sum $\\sum_{i=0}^{N-2} \\frac{\\left(1 - u_i(x_2)/U_\\infty\\right)+\\left(1 - u_{i+1}(x_2)/U_\\infty\\right)}{2}\\,(y_{i+1} - y_i)$.\n   - For $\\theta$, sum $\\sum_{i=0}^{N-2} \\frac{\\left(\\frac{u_i(x_2)}{U_\\infty}\\left(1 - \\frac{u_i(x_2)}{U_\\infty}\\right)\\right) + \\left(\\frac{u_{i+1}(x_2)}{U_\\infty}\\left(1 - \\frac{u_{i+1}(x_2)}{U_\\infty}\\right)\\right)}{2}\\,(y_{i+1} - y_i)$.\n4. Compute $\\theta(x_1)$ similarly using the $x_1$ profile and the same grid construction parameters for that scenario (each scenario provides its own $y_{\\max}$ and $N$).\n5. Approximate $\\mathrm{d}\\theta/\\mathrm{d}x$ at $x_2$ by the finite difference $(\\theta(x_2) - \\theta(x_1))/(x_2 - x_1)$.\n6. Compute $\\tau_w = \\rho U_\\infty^2\\,\\mathrm{d}\\theta/\\mathrm{d}x$ in $\\mathrm{Pa}$ and $C_f = 2\\,\\mathrm{d}\\theta/\\mathrm{d}x$ (dimensionless).\n7. Round each output quantity ($\\delta^\\*$, $\\theta$, $\\tau_w$, $C_f$) to six decimal places and aggregate results for all scenarios into the specified single-line output format.\n\nScientific realism:\n- The Pohlhausen-type polynomial provides a self-consistent laminar boundary-layer profile under zero pressure gradient.\n- The numerical integration truncation at $y_{\\max}$ is acceptable when the profile reaches the free-stream value ($u/U_\\infty \\approx 1$) well before $y_{\\max}$, which is enforced by the profile model.\n- The finite-difference approximation of $\\mathrm{d}\\theta/\\mathrm{d}x$ is justified by the small streamwise separation and is consistent with the integral relation used to infer $\\tau_w$.\n\nThis methodology integrates fundamental definitions with the momentum integral principle to infer wall shear without directly differentiating the near-wall velocity, aligning with the directive to use the integral relation under the given conditions.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef pohlhausen_profile(y, delta, U_inf):\n    \"\"\"\n    Compute u(y)/U_inf using a 4th-degree Pohlhausen-type polynomial for zero pressure gradient.\n    For eta = y/delta = 1: f(eta) = 2*eta - 2*eta**3 + eta**4\n    For eta  1: f(eta) = 1\n    Returns u(y) in m/s for array y.\n    \"\"\"\n    eta = y / delta\n    f = np.where(eta = 1.0, 2*eta - 2*eta**3 + eta**4, 1.0)\n    return U_inf * f\n\ndef trapezoidal_integral(y, integrand):\n    \"\"\"\n    Composite trapezoidal rule over nonuniform grid y for integrand values.\n    Assumes y is sorted ascending and integrand has same shape.\n    \"\"\"\n    return np.sum(0.5 * (integrand[:-1] + integrand[1:]) * (y[1:] - y[:-1]))\n\ndef thicknesses_from_profile(y, u, U_inf):\n    \"\"\"\n    Compute displacement thickness delta_star and momentum thickness theta\n    from discrete profile (y, u) using trapezoidal rule.\n    \"\"\"\n    # Ensure arrays are numpy and sorted by y\n    y = np.asarray(y)\n    u = np.asarray(u)\n    # Sort if not sorted\n    if not np.all(np.diff(y) = 0):\n        idx = np.argsort(y)\n        y = y[idx]\n        u = u[idx]\n    # Compute integrands\n    phi = 1.0 - (u / U_inf)\n    psi = (u / U_inf) * (1.0 - (u / U_inf))\n    # Integrate\n    delta_star = trapezoidal_integral(y, phi)\n    theta = trapezoidal_integral(y, psi)\n    return delta_star, theta\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: dict with U_inf, rho, x1, x2, y_max, N, delta1, delta2\n    test_cases = [\n        {\n            \"U_inf\": 10.0,\n            \"rho\": 1.20,\n            \"x1\": 0.295,\n            \"x2\": 0.300,\n            \"y_max\": 0.015,\n            \"N\": 61,\n            \"delta1\": 0.00335,\n            \"delta2\": 0.00340,\n        },\n        {\n            \"U_inf\": 20.0,\n            \"rho\": 1.20,\n            \"x1\": 0.290,\n            \"x2\": 0.300,\n            \"y_max\": 0.012,\n            \"N\": 11,\n            \"delta1\": 0.00236,\n            \"delta2\": 0.00240,\n        },\n        {\n            \"U_inf\": 5.0,\n            \"rho\": 1.20,\n            \"x1\": 0.299,\n            \"x2\": 0.300,\n            \"y_max\": 0.018,\n            \"N\": 41,\n            \"delta1\": 0.00475,\n            \"delta2\": 0.00480,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        U_inf = case[\"U_inf\"]\n        rho = case[\"rho\"]\n        x1 = case[\"x1\"]\n        x2 = case[\"x2\"]\n        y_max = case[\"y_max\"]\n        N = case[\"N\"]\n        delta1 = case[\"delta1\"]\n        delta2 = case[\"delta2\"]\n\n        # Generate wall-normal grid\n        y = np.linspace(0.0, y_max, N)\n\n        # Generate profiles at x1 and x2 using the Pohlhausen-type approximation\n        u1 = pohlhausen_profile(y, delta1, U_inf)\n        u2 = pohlhausen_profile(y, delta2, U_inf)\n\n        # Compute thicknesses at x1 and x2\n        delta_star_2, theta_2 = thicknesses_from_profile(y, u2, U_inf)\n        _, theta_1 = thicknesses_from_profile(y, u1, U_inf)\n\n        # Finite difference for dtheta/dx at x2\n        dtheta_dx = (theta_2 - theta_1) / (x2 - x1)\n\n        # Infer wall shear stress and skin-friction coefficient via integral relation\n        tau_w = rho * (U_inf ** 2) * dtheta_dx  # Pa\n        C_f = 2.0 * dtheta_dx  # dimensionless\n\n        # Round to six decimal places\n        results.extend([\n            f\"{delta_star_2:.6f}\",\n            f\"{theta_2:.6f}\",\n            f\"{tau_w:.6f}\",\n            f\"{C_f:.6f}\",\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}