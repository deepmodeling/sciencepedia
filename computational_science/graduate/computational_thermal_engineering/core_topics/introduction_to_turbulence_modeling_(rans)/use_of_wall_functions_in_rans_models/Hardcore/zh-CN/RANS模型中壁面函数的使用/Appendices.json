{
    "hands_on_practices": [
        {
            "introduction": "要有效地使用和诊断壁面函数，首先必须掌握近壁面湍流的基本语言：壁面单位。本练习提供了一个实践机会，将有量纲的速度测量值转换为其无量纲对应量 $y^+$ 和 $u^+$。通过这样做，您将对不同的边界层区域获得直观的感受，并理解应用基于对数律的壁面函数的标准。",
            "id": "4001766",
            "problem": "在空气中，零压力梯度的湍流边界层在光滑、等温的平板上发展。在给定的流向位置，壁面剪切应力和流体属性通过独立测量已知。四个垂直于壁面的位置安装了仪器，以提供时间平均的速度。您的任务是计算壁面坐标，并将每个点根据雷诺平均纳维-斯托克斯 (RANS) 模型中壁面函数的用法划分到近壁区域，然后报告一个单一的聚合量。\n\n已知数据：\n- 空气密度：$\\rho = 1.20 \\ \\mathrm{kg \\, m^{-3}}$。\n- 空气动力粘度：$\\mu = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\, s}$。\n- 壁面剪切应力：$\\tau_{w} = 0.90 \\ \\mathrm{Pa}$。\n- 垂直于壁面的位置和平均速度：$(y_1, U_1) = (1.0 \\times 10^{-5} \\ \\mathrm{m}, \\ 0.500 \\ \\mathrm{m \\, s^{-1}})$，$(y_2, U_2) = (1.0 \\times 10^{-4} \\ \\mathrm{m}, \\ 8.20 \\ \\mathrm{m \\, s^{-1}})$，$(y_3, U_3) = (1.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 12.99038106 \\ \\mathrm{m \\, s^{-1}})$，$(y_4, U_4) = (5.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 18.18653349 \\ \\mathrm{m \\, s^{-1}})$。\n\n任务：\n1. 从牛顿粘性定律和壁面剪切应力的定义出发，并引用湍流边界层理论中壁面单位的标准定义，推导计算每个位置的摩擦速度 $u_{\\tau}$、运动粘度 $\\nu$、以壁面单位表示的壁面距离 $y^{+}$ 以及以壁面单位表示的速度 $u^{+}$ 所需的步骤。\n2. 计算 $i \\in \\{1,2,3,4\\}$ 时各点的 $y_i^{+}$ 和 $u_i^{+}$。\n3. 使用以下基于 $y^{+}$ 的区域定义对每个点进行分类：粘性子层（如果 $y^{+} \\leq 5$），缓冲层（如果 $5  y^{+}  30$），对数（重叠）层（如果 $30 \\leq y^{+} \\leq 300$），外尾流区（如果 $y^{+}  300$）。确定哪些点适用于应用基于壁面对数律的标准高雷诺数壁面函数。\n4. 令 $\\mathcal{L}$ 表示落在对数层中的点的索引集合。报告 $\\mathcal{L}$ 上 $u^{+}$ 的算术平均值。\n\n答案规格：\n- 以单一无量纲实数的形式提供最终答案，该数值等于对数层各点上 $u^{+}$ 的算术平均值。\n- 将您的答案四舍五入至四位有效数字。\n- 最终答案不包含单位。",
            "solution": "该问题要求分析来自湍流边界层的四个数据点，将它们划分到近壁区域，并计算一个特定的统计量。该过程涉及计算壁面尺度量（$y^{+}$ 和 $u^{+}$）并应用边界层区域的标准定义。\n\n### 步骤1：壁面单位计算的推导\n\n分析基于壁面单位的概念，该概念使用基于壁面的尺度对固体边界附近的物理量进行无量纲化。\n\n**摩擦速度**，用 $u_{\\tau}$ 表示，是特征速度尺度，由壁面剪切应力 $\\tau_w$ 和流体密度 $\\rho$ 定义：\n$$\n\\tau_w = \\rho u_{\\tau}^2\n$$\n求解 $u_{\\tau}$ 可得：\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n\n**运动粘度** $\\nu$ 是动力粘度 $\\mu$ 与密度 $\\rho$ 的比值：\n$$\n\\nu = \\frac{\\mu}{\\rho}\n$$\n\n近壁区域的特征长度尺度是粘性长度尺度 $\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}$。与壁面的物理距离 $y$ 和平均速度 $U$ 使用这些尺度进行无量纲化。\n\n**无量纲壁面距离** $y^{+}$ 定义为：\n$$\ny^{+} = \\frac{y}{\\delta_{\\nu}} = \\frac{y u_{\\tau}}{\\nu}\n$$\n\n**无量纲速度** $u^{+}$ 定义为：\n$$\nu^{+} = \\frac{U}{u_{\\tau}}\n$$\n这些定义，从壁面处的牛顿粘性定律 $\\tau_w = \\mu (\\frac{dU}{dy})_{y=0}$ 出发，构成了壁面律公式的基础。\n\n### 步骤2：物理尺度和壁面坐标的计算\n\n首先，我们使用所提供的数据计算恒定的物理尺度 $u_{\\tau}$ 和 $\\nu$：\n$\\rho = 1.20 \\ \\mathrm{kg \\, m^{-3}}$\n$\\mu = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\, s}$\n$\\tau_{w} = 0.90 \\ \\mathrm{Pa}$\n\n摩擦速度为：\n$$\nu_{\\tau} = \\sqrt{\\frac{0.90 \\ \\mathrm{Pa}}{1.20 \\ \\mathrm{kg \\, m^{-3}}}} = \\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}} = \\frac{\\sqrt{3}}{2} \\ \\mathrm{m \\, s^{-1}} \\approx 0.866025 \\ \\mathrm{m \\, s^{-1}}\n$$\n\n运动粘度为：\n$$\n\\nu = \\frac{1.80 \\times 10^{-5} \\ \\mathrm{Pa \\, s}}{1.20 \\ \\mathrm{kg \\, m^{-3}}} = 1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}\n$$\n\n现在，我们为每个测量点 $(y_i, U_i)$（其中 $i \\in \\{1, 2, 3, 4\\}$）计算 $y_i^{+}$ 和 $u_i^{+}$。\n\n**点1：** $(y_1, U_1) = (1.0 \\times 10^{-5} \\ \\mathrm{m}, \\ 0.500 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_1^{+} = \\frac{y_1 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-5} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{\\sqrt{0.75}}{1.5} = \\frac{\\sqrt{3}/2}{3/2} = \\frac{\\sqrt{3}}{3} \\approx 0.57735\n$$\n$$\nu_1^{+} = \\frac{U_1}{u_{\\tau}} = \\frac{0.500 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = \\frac{0.5}{\\sqrt{3}/2} = \\frac{1}{\\sqrt{3}} = \\frac{\\sqrt{3}}{3} \\approx 0.57735\n$$\n\n**点2：** $(y_2, U_2) = (1.0 \\times 10^{-4} \\ \\mathrm{m}, \\ 8.20 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_2^{+} = \\frac{y_2 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-4} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{10 \\sqrt{0.75}}{1.5} = \\frac{10\\sqrt{3}}{3} \\approx 5.7735\n$$\n$$\nu_2^{+} = \\frac{U_2}{u_{\\tau}} = \\frac{8.20 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = \\frac{8.20}{\\sqrt{3}/2} = \\frac{16.4}{\\sqrt{3}} \\approx 9.4681\n$$\n\n**点3：** $(y_3, U_3) = (1.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 12.99038106 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_3^{+} = \\frac{y_3 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-3} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{100 \\sqrt{0.75}}{1.5} = \\frac{100\\sqrt{3}}{3} \\approx 57.735\n$$\n$U_3$ 的值是精确构造的。我们检查：$15 \\times u_\\tau = 15 \\times \\frac{\\sqrt{3}}{2} = 7.5\\sqrt{3} \\approx 12.99038106$。因此：\n$$\nu_3^{+} = \\frac{U_3}{u_{\\tau}} = \\frac{12.99038106 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = 15.00\n$$\n\n**点4：** $(y_4, U_4) = (5.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 18.18653349 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_4^{+} = \\frac{y_4 u_{\\tau}}{\\nu} = \\frac{(5.0 \\times 10^{-3} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{500 \\sqrt{0.75}}{1.5} = \\frac{500\\sqrt{3}}{3} \\approx 288.675\n$$\n类似地，$U_4$ 的值是精确构造的。我们检查：$21 \\times u_\\tau = 21 \\times \\frac{\\sqrt{3}}{2} = 10.5\\sqrt{3} \\approx 18.18653349$。因此：\n$$\nu_4^{+} = \\frac{U_4}{u_{\\tau}} = \\frac{18.18653349 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = 21.00\n$$\n\n### 步骤3：点的分类\n\n使用基于 $y^{+}$ 的标准区域定义：\n- 粘性子层：$y^{+} \\leq 5$\n- 缓冲层：$5  y^{+}  30$\n- 对数（重叠）层：$30 \\leq y^{+} \\leq 300$\n- 外尾流区：$y^{+}  300$\n\n我们对每个点进行分类：\n- **点1：** $y_1^{+} \\approx 0.577$。由于 $0.577 \\leq 5$，该点位于**粘性子层**。(注意：该层的一个定义特征是 $u^{+} = y^{+}$，这一点在此处成立：$u_1^{+} \\approx 0.577$)。\n- **点2：** $y_2^{+} \\approx 5.77$。由于 $5  5.77  30$，该点位于**缓冲层**。\n- **点3：** $y_3^{+} \\approx 57.7$。由于 $30 \\leq 57.7 \\leq 300$，该点位于**对数层**。\n- **点4：** $y_4^{+} \\approx 288.7$。由于 $30 \\leq 288.7 \\leq 300$，该点也位于**对数层**。\n\n位于对数层的点适用于在 RANS 模型中应用标准高雷诺数壁面函数，因为这些函数基于在该区域内有效的壁面对数律 $u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + C$。因此，点3和点4是相关点。\n\n### 步骤4：算术平均值的计算\n\n问题要求计算落在对数层中的点的索引集合 $\\mathcal{L}$ 上 $u^{+}$ 的算术平均值。根据我们的分类，$\\mathcal{L} = \\{3, 4\\}$。对应的无量纲速度为 $u_3^{+} = 15$ 和 $u_4^{+} = 21$。\n\n算术平均值为：\n$$\n\\text{Mean}(u^{+}) = \\frac{1}{ |\\mathcal{L}| } \\sum_{i \\in \\mathcal{L}} u_i^{+} = \\frac{u_3^{+} + u_4^{+}}{2} = \\frac{15 + 21}{2} = \\frac{36}{2} = 18\n$$\n\n结果恰好是 $18$。根据答案规格要求四舍五入至四位有效数字，最终答案是 $18.00$。",
            "answer": "$$\\boxed{18.00}$$"
        },
        {
            "introduction": "任何壁面函数的核心是从第一个离壁网格单元中的流动变量推断壁面剪切应力的算法。这个编程练习要求您实现这一关键过程，其中涉及迭代求解隐式的对数律方程。掌握此实现能让您直接洞察 RANS 求解器在计算上如何处理壁面边界条件。",
            "id": "4001748",
            "problem": "考虑一个在雷诺平均纳维-斯托克斯 (RANS) 模拟中紧邻壁面的控制体，该模拟使用壁面函数为光滑、等温、平行于壁面的压力梯度为零的壁面提供动量边界条件。给定单元中心处的平均速度平行分量 $U_P$（单位为 $\\mathrm{m/s}$），从壁面到单元中心的壁面法向距离 $y_P$（单位为 $\\mathrm{m}$），以及流体属性：密度 $\\rho$（单位为 $\\mathrm{kg/m^3}$）和动力粘度 $\\mu$（单位为 $\\mathrm{Pa\\,s}$）。任务是通过在适用时迭代地反解湍流对数律壁面法则，或在不适用时使用线性粘性子层关系，来计算壁面剪切应力 $\\tau_w$（单位为 $\\mathrm{Pa}$）。\n\n使用以下基本定义和经过充分检验的经验事实作为您的起点：\n- 定义摩擦速度为 $u_\\tau = \\sqrt{\\tau_w / \\rho}$。\n- 定义无量纲速度为 $U^+ = U_P / u_\\tau$，无量纲壁面距离为 $y^+ = \\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}$。\n- 对于近壁的完全湍流区域（不包括粘性子层），速度分布遵循对数律：$U^+ = \\dfrac{1}{\\kappa} \\ln(y^+) + B$，其中 $\\kappa$ 是 von Kármán 常数，$B$ 是光滑壁面加法常数。这里的对数是自然对数。\n- 对于粘性子层，关系式为 $U^+ = y^+$。\n\n您的程序必须以科学上真实且数值上鲁棒的方式实现以下逻辑：\n- 根据粘性子层关系计算 $u_\\tau$ 的初始估计值，并由此计算基于粘性假设的 $y^+$。如果这个粘性 $y^+$ 小于或等于指定的阈值 $y^+_{\\mathrm{vs}}$，则使用粘性子层关系计算 $\\tau_w$。否则，对对数律进行迭代反解，以在隐式方程 $U_P/u_\\tau = \\dfrac{1}{\\kappa} \\ln\\!\\left(\\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) + B$ 中求解 $u_\\tau > 0$，然后计算 $\\tau_w = \\rho\\,u_\\tau^2$。\n- 使用一种能保证 $u_\\tau$ 为正的稳定迭代方法，该方法应有明确的收敛准则和最大迭代次数，并包含一个当主要迭代方法未能收敛时的回退策略。\n\n物理单位要求：将每种情况下最终的剪切应力以 $\\mathrm{Pa}$ 为单位表示为浮点数。\n\n常数 $\\kappa$、$B$ 和 $y^+_{\\mathrm{vs}}$ 是您计算的输入。当 $y^+$ 超过粘性阈值时，您可以假设壁面光滑且为高雷诺数湍流，以满足对数律的适用性。\n\n将您的解决方案实现为一个完整、可运行的程序，该程序硬编码并评估以下测试套件，该套件旨在测试不同的区域和边缘情况。程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表。\n\n测试套件（每组参数为 $\\left(U_P, y_P, \\rho, \\mu, \\kappa, B, y^+_{\\mathrm{vs}}\\right)$）：\n- 情况 1（理想路径，空气，对数层）：$\\left(10.0, 0.005, 1.200, 1.80\\times 10^{-5}, 0.41, 5.2, 11.0\\right)$\n- 情况 2（边界条件在粘性子层中，空气）：$\\left(2.0, 1.2\\times 10^{-4}, 1.200, 1.80\\times 10^{-5}, 0.41, 5.2, 11.0\\right)$\n- 情况 3（高粘度油，粘性子层）：$\\left(1.0, 0.010, 850.0, 0.10, 0.41, 5.2, 11.0\\right)$\n- 情况 4（水，明确的对数区域）：$\\left(20.0, 0.002, 1000.0, 1.00\\times 10^{-3}, 0.41, 5.2, 11.0\\right)$\n- 情况 5（近粘性子层的低速空气）：$\\left(0.05, 0.010, 1.225, 1.80\\times 10^{-5}, 0.41, 5.2, 11.0\\right)$\n\n输出规范：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3}\\right]$），其中每个 $\\mathrm{result}$ 是对应测试用例计算出的 $\\tau_w$（单位为 $\\mathrm{Pa}$），顺序与上面列出的一致。",
            "solution": "目标是根据给定的平均平行速度 $U_P$、壁面法向距离 $y_P$ 以及流体属性 $\\rho$ 和 $\\mu$，计算与雷诺平均纳维-斯托克斯 (RANS) 壁面函数一致的壁面剪切应力 $\\tau_w$。其核心物理原理体现在摩擦速度 $u_\\tau = \\sqrt{\\tau_w/\\rho}$ 和经典的近壁标度中。我们从这些定义和广为接受的经验性近壁速度剖面出发。\n\n从摩擦速度的定义开始：\n$$\nu_\\tau = \\sqrt{\\frac{\\tau_w}{\\rho}}, \\quad \\tau_w = \\rho\\,u_\\tau^2.\n$$\n引入无量纲变量：\n$$\nU^+ = \\frac{U_P}{u_\\tau}, \\qquad y^+ = \\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}.\n$$\n在粘性子层中，近壁行为是线性的：\n$$\nU^+ = y^+.\n$$\n代入定义以获得在粘性区域中 $u_\\tau$ 的显式表达式。令 $\\dfrac{U_P}{u_\\tau} = \\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}$，可得\n$$\nU_P = \\frac{\\rho\\,y_P}{\\mu}\\,u_\\tau^2 \\quad \\Rightarrow \\quad u_\\tau^2 = \\frac{U_P\\,\\mu}{\\rho\\,y_P}.\n$$\n于是，\n$$\n\\tau_w = \\rho\\,u_\\tau^2 = \\rho \\left(\\frac{U_P\\,\\mu}{\\rho\\,y_P}\\right) = \\frac{\\mu\\,U_P}{y_P}.\n$$\n在粘性子层线性假设下，该粘性表达式是精确的，并具有双重作用：当局部 $y^+$ 很小时，它直接提供剪切应力；同时，它也提供一个初始估计值以评估适用区域。\n\n在完全湍流的对数层中，经经验验证的壁面法则为\n$$\nU^+ = \\frac{1}{\\kappa}\\,\\ln(y^+) + B,\n$$\n其中 $\\kappa$ 是 von Kármán 常数，$B$ 是光滑壁面的加法常数。将 $U^+$ 和 $y^+$ 的定义代入，得到一个关于 $u_\\tau$ 的隐式方程：\n$$\n\\frac{U_P}{u_\\tau} = \\frac{1}{\\kappa}\\,\\ln\\!\\left(\\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) + B.\n$$\n定义 $u_\\tau$ 的残差函数：\n$$\nr(u_\\tau) = \\frac{U_P}{u_\\tau} - \\frac{1}{\\kappa} \\ln\\!\\left(\\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) - B.\n$$\n我们寻求 $u_\\tau > 0$ 使得 $r(u_\\tau) = 0$，以确保与对数律的一致性。一种可靠的迭代方法是牛顿法，它使用导数\n$$\n\\frac{dr}{du_\\tau} = -\\frac{U_P}{u_\\tau^2} - \\frac{1}{\\kappa}\\cdot\\frac{1}{u_\\tau}.\n$$\n牛顿法更新公式为\n$$\nu_\\tau^{(n+1)} = u_\\tau^{(n)} - \\frac{r\\!\\left(u_\\tau^{(n)}\\right)}{dr/du_\\tau\\!\\left(u_\\tau^{(n)}\\right)}.\n$$\n为确保物理上的可接受性和数值上的鲁棒性，我们强制 $u_\\tau^{(n+1)} > 0$，并在残差未减小时应用回溯线搜索。一个小的正数下界可以防止对数函数出现非物理输入。当 $|r(u_\\tau)|$ 低于指定容差或 $u_\\tau$ 的相对变化足够小时，迭代终止。如果牛顿法在最大迭代次数内未能收敛，我们回退到通过重新整理对数律得到的松弛定点迭代法：\n$$\nu_\\tau \\leftarrow \\frac{U_P}{\\frac{1}{\\kappa}\\,\\ln\\!\\left(\\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) + B},\n$$\n并结合松弛\n$$\nu_\\tau^{(n+1)} = \\alpha\\,u_\\tau^{\\text{fp}} + (1-\\alpha)\\,u_\\tau^{(n)}, \\quad \\alpha \\in (0,1),\n$$\n这可以抑制振荡。\n\n通过首先计算粘性估计值来进行区域选择：\n$$\nu_{\\tau,\\mathrm{visc}} = \\sqrt{\\frac{U_P\\,\\mu}{\\rho\\,y_P}}, \\qquad y^+_{\\mathrm{visc}} = \\frac{\\rho\\,u_{\\tau,\\mathrm{visc}}\\,y_P}{\\mu}.\n$$\n如果 $y^+_{\\mathrm{visc}} \\le y^+_{\\mathrm{vs}}$，其中 $y^+_{\\mathrm{vs}}$ 是一个选定的阈值（通常 $y^+_{\\mathrm{vs}} \\approx 11$），则直接使用粘性公式：\n$$\n\\tau_w = \\frac{\\mu\\,U_P}{y_P}.\n$$\n否则，应用对数律的迭代反解来找到 $u_\\tau$，然后计算\n$$\n\\tau_w = \\rho\\,u_\\tau^2.\n$$\n\n每个测试用例的算法步骤：\n1. 读取参数 $\\left(U_P, y_P, \\rho, \\mu, \\kappa, B, y^+_{\\mathrm{vs}}\\right)$。\n2. 使用粘性子层关系计算 $u_{\\tau,\\mathrm{visc}}$ 和 $y^+_{\\mathrm{visc}}$。\n3. 如果 $y^+_{\\mathrm{visc}} \\le y^+_{\\mathrm{vs}}$，则设 $\\tau_w = \\dfrac{\\mu\\,U_P}{y_P}$。\n4. 否则，使用物理上合理的猜测值（例如，用对数律标度调整后的粘性值）来初始化 $u_\\tau$，并执行带回溯的牛顿法直至收敛。如果牛顿法失败，则执行松弛定点迭代。\n5. 计算 $\\tau_w = \\rho\\,u_\\tau^2$。\n6. 以 $\\mathrm{Pa}$ 为单位输出 $\\tau_w$。\n\n该方法基于摩擦速度和无量纲壁面变量的定义，并结合了成熟的经验性近壁法则。鲁棒的迭代确保了 $u_\\tau$ 的物理上可接受的正解，而通过 $y^+_{\\mathrm{visc}}$ 进行的区域选择则通过在每个区域使用适当的法则来保持科学的真实性。程序将指定测试套件计算出的剪切应力汇总成所需的单行输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_wall_shear(U_P, y_P, rho, mu, kappa, B, yplus_switch,\n                       newton_max_iter=50, newton_tol=1e-12,\n                       fp_max_iter=200, fp_relax=0.5, fp_tol=1e-12):\n    \"\"\"\n    Compute wall shear stress tau_w (Pa) using hybrid viscous/log-law approach.\n    Inputs:\n        U_P: mean parallel velocity at cell center [m/s]\n        y_P: wall-normal distance to cell center [m]\n        rho: fluid density [kg/m^3]\n        mu: dynamic viscosity [Pa s]\n        kappa: von Karman constant [-]\n        B: additive constant [-]\n        yplus_switch: viscous sublayer threshold y+ [-]\n        newton_max_iter: max iterations for Newton\n        newton_tol: residual tolerance for Newton\n        fp_max_iter: max iterations for fixed-point fallback\n        fp_relax: relaxation factor for fixed-point\n        fp_tol: tolerance for fixed-point convergence\n    Returns:\n        tau_w: wall shear stress [Pa]\n    \"\"\"\n    # Guard against nonphysical inputs; keep positive values\n    eps = 1e-16\n    U_P = max(U_P, eps)\n    y_P = max(y_P, eps)\n    rho = max(rho, eps)\n    mu = max(mu, eps)\n    kappa = max(kappa, eps)\n\n    # Viscous sublayer estimate\n    u_tau_visc = np.sqrt((U_P * mu) / (rho * y_P))\n    y_plus_visc = (rho * u_tau_visc * y_P) / mu\n\n    # If viscous regime, use exact linear relation: tau_w = mu * U_P / y_P\n    if y_plus_visc = yplus_switch:\n        return mu * U_P / y_P\n\n    # Else, invert the log-law iteratively\n    # Residual function r(u) = U_P/u - (1/kappa)*ln(rho*u*y_P/mu) - B\n    def residual(u):\n        y_plus = (rho * u * y_P) / mu\n        y_plus = max(y_plus, eps)\n        return (U_P / u) - (1.0 / kappa) * np.log(y_plus) - B\n\n    def residual_prime(u):\n        # dr/du = -(U_P/u^2) - (1/kappa)*(1/u)\n        return - (U_P / (u * u)) - (1.0 / (kappa * u))\n\n    # Initial guess: use viscous u_tau as baseline and adjust\n    # A heuristic initial guess using fixed-point rearrangement with y_plus from viscous estimate\n    y_plus_guess = max((rho * u_tau_visc * y_P) / mu, 1.0)\n    U_plus_guess = (1.0 / kappa) * np.log(y_plus_guess) + B\n    u0 = U_P / max(U_plus_guess, eps)\n    u_tau = max(u0, u_tau_visc, 1e-6)\n\n    # Newton iteration with backtracking line search\n    r_prev = None\n    converged = False\n    for _ in range(newton_max_iter):\n        r = residual(u_tau)\n        if abs(r)  newton_tol:\n            converged = True\n            break\n        rp = residual_prime(u_tau)\n        # Avoid division by zero or extreme updates\n        if rp == 0.0 or not np.isfinite(rp):\n            break\n        delta = -r / rp\n        # Backtracking to ensure residual decreases and positivity of u_tau\n        lam = 1.0\n        for _ in range(20):\n            u_trial = u_tau + lam * delta\n            if u_trial = eps:\n                lam *= 0.5\n                continue\n            r_trial = residual(u_trial)\n            # Accept if residual decreases sufficiently\n            if r_prev is None or abs(r_trial) = abs(r) * (0.9 + 0.1 * lam):\n                u_tau = u_trial\n                r_prev = r_trial\n                break\n            lam *= 0.5\n        else:\n            # Line search failed; break to fallback\n            break\n\n    if not converged:\n        # Fixed-point fallback with relaxation\n        u_tau = max(u_tau, 1e-6)\n        for _ in range(fp_max_iter):\n            y_plus = max((rho * u_tau * y_P) / mu, 1.0)\n            denom = (1.0 / kappa) * np.log(y_plus) + B\n            denom = max(denom, 1e-6)\n            u_fp = U_P / denom\n            u_new = fp_relax * u_fp + (1.0 - fp_relax) * u_tau\n            if abs(u_new - u_tau) / max(u_tau, 1e-12)  fp_tol:\n                u_tau = u_new\n                converged = True\n                break\n            u_tau = max(u_new, 1e-6)\n\n    # Compute tau_w from u_tau; if still not converged, return viscous as a safe fallback\n    if not converged and y_plus_visc > yplus_switch:\n        # As a last resort, use a blended value to avoid failure\n        tau_log = rho * u_tau * u_tau\n        tau_visc = mu * U_P / y_P\n        # Blend weights based on initial y_plus_visc\n        w = min(max((y_plus_visc - yplus_switch) / (y_plus_visc + 1.0), 0.0), 1.0)\n        return (1.0 - w) * tau_visc + w * tau_log\n\n    return rho * u_tau * u_tau\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (U_P [m/s], y_P [m], rho [kg/m^3], mu [Pa s], kappa [-], B [-], yplus_switch [-])\n    test_cases = [\n        (10.0, 0.005, 1.200, 1.80e-5, 0.41, 5.2, 11.0),\n        (2.0, 1.2e-4, 1.200, 1.80e-5, 0.41, 5.2, 11.0),\n        (1.0, 0.010, 850.0, 0.10, 0.41, 5.2, 11.0),\n        (20.0, 0.002, 1000.0, 1.00e-3, 0.41, 5.2, 11.0),\n        (0.05, 0.010, 1.225, 1.80e-5, 0.41, 5.2, 11.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        U_P, y_P, rho, mu, kappa, B, yplus_switch = case\n        tau_w = compute_wall_shear(U_P, y_P, rho, mu, kappa, B, yplus_switch)\n        results.append(tau_w)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "壁面函数是一种近似，理解其影响需要与更完整的模型进行比较。本练习指导您为槽道流建立并比较两个模型：一个使用简单的平衡壁面函数，另一个使用完全解析的低雷诺数模型。通过量化差异，您将对湍流模型中计算成本与准确性之间的权衡有更深刻的理解。",
            "id": "4001755",
            "problem": "你需要使用适用于雷诺平均纳维-斯托克斯 (RANS) 建模的原理，实现并比较两种用于充分发展的不可压缩湍流槽道流中平均流向速度剖面的一维模型。重点是使用平衡壁面函数与完全解析的低雷诺数封闭模型进行对比，两者在匹配的摩擦雷诺数下进行。所有计算都必须在半槽道内进行，从 $y=0$ 处的壁面到 $y=\\delta$ 处的中心线，其中 $\\delta$ 是半槽道高度。\n\n从以下基础理论开始：\n- 对于充分发展的槽道流，流向平均动量平衡意味着总剪切应力在半槽道内呈线性分布，$\\tau(y) = \\rho u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)$，其中 $\\rho$ 是流体密度，$u_\\tau$ 是摩擦速度，定义为 $u_\\tau = \\sqrt{\\tau_w/\\rho}$，$\\tau_w$ 是壁面剪切应力。\n- 摩擦雷诺数是 $Re_\\tau = \\frac{u_\\tau \\delta}{\\nu}$，其中 $\\nu$ 是运动粘度。\n- 在混合长度封闭模型中，涡粘度为 $\\nu_t = \\ell_m^2 \\left|\\frac{dU}{dy}\\right|$，其中 $U(y)$ 是平均速度，$\\ell_m(y)$ 是混合长度。\n- 近壁区标度使用无量纲变量 $y^+ = \\frac{y u_\\tau}{\\nu}$ 和 $U^+ = \\frac{U}{u_\\tau}$ 来表示。\n\n仅使用这些基础，构建两个模型：\n1. 一个平衡壁面函数模型，其中当位置 $y^+$ 超过阈值切换值 $y^+_{\\mathrm{sw}}$ 时，混合长度设为 $\\ell_m(y) = \\kappa y$；当位置 $y^+ \\le y^+_{\\mathrm{sw}}$ 时，$\\ell_m(y) = 0$。使用冯·卡门常数 $\\kappa = 0.41$。\n2. 一个完全解析的低雷诺数模型，其中混合长度使用 van Driest 阻尼，$\\ell_m(y) = \\kappa y f_d(y^+)$，其中 $f_d(y^+) = 1 - \\exp\\!\\left(-\\frac{y^+}{A^+}\\right)$ 且 $A^+ = 26$。\n\n在每个模型中，使用线性总剪切应力分布来确定在 $y \\in [0,\\delta]$ 范围内的 $\\frac{dU}{dy}$，并从 $U(0) = 0$ 开始积分以获得 $U(y)$。然后在 $y$ 的均匀网格上转换为无量纲平均速度 $U^+(y) = U(y)/u_\\tau$。\n\n对于数值实现和比较：\n- 使用 $\\delta = 1$ 和 $\\nu = 1$（无量纲化），因此 $u_\\tau = Re_\\tau$ 且 $y^+ = y Re_\\tau$。\n- 在 $y \\in [0,\\delta]$ 上使用包含 $N$ 个点的均匀网格，其中 $N \\ge 1000$。\n- 计算平衡壁面函数模型的剖面 $U^+_{\\mathrm{wf}}(y)$ 和低雷诺数模型的剖面 $U^+_{\\mathrm{lr}}(y)$。\n- 使用以下无量纲指标量化差异：\n  - 网格上的均方根偏差，$\\mathrm{RMSD} = \\left[\\frac{1}{N}\\sum_{i=1}^{N} \\left(U^+_{\\mathrm{wf}}(y_i) - U^+_{\\mathrm{lr}}(y_i)\\right)^2\\right]^{1/2}$。\n  - 最大绝对偏差，$\\mathrm{MAXD} = \\max_{i} \\left|U^+_{\\mathrm{wf}}(y_i) - U^+_{\\mathrm{lr}}(y_i)\\right|$。\n  - 中心线差异，$\\Delta U^+_c = U^+_{\\mathrm{wf}}(y=\\delta) - U^+_{\\mathrm{lr}}(y=\\delta)$。\n\n所有报告的指标都是无量纲的，并且必须在不同模型间使用一致的 $N$ 进行计算。\n\n测试套件：\n- 情况 1 (理想情况): $Re_\\tau = 180$, $y^+_{\\mathrm{sw}} = 11$, $N = 1200$。\n- 情况 2 (侧重外层): $Re_\\tau = 395$, $y^+_{\\mathrm{sw}} = 30$, $N = 1200$。\n- 情况 3 (更高湍流强度): $Re_\\tau = 550$, $y^+_{\\mathrm{sw}} = 11$, $N = 1500$。\n- 情况 4 (较低湍流阈值的边缘情况): $Re_\\tau = 80$, $y^+_{\\mathrm{sw}} = 11$, $N = 1200$。\n\n你的程序必须在没有任何外部输入的情况下，生成一行输出，其中包含一个用方括号括起来的逗号分隔的结果列表。将所有测试用例的指标按顺序平铺成一个单一的浮点数列表：$[\\mathrm{RMSD}_1,\\mathrm{MAXD}_1,\\Delta U^+_{c,1},\\mathrm{RMSD}_2,\\mathrm{MAXD}_2,\\Delta U^+_{c,2},\\mathrm{RMSD}_3,\\mathrm{MAXD}_3,\\Delta U^+_{c,3},\\mathrm{RMSD}_4,\\mathrm{MAXD}_4,\\Delta U^+_{c,4}]$。所有值均为无量纲浮点数。",
            "solution": "该问题要求实现并比较两种用于湍流槽道流平均速度剖面的一维模型：一个平衡壁面函数模型和一个低雷诺数模型。解决方案源于平均动量平衡和一个混合长度湍流封闭模型。\n\n### **1. 平均速度梯度的控制方程**\n\n对于充分发展的不可压缩湍流槽道流，总剪切应力 $\\tau$ 是粘性剪切应力 $\\tau_v$ 和湍流（雷诺）剪切应力 $\\tau_t$ 的和：\n$$ \\tau(y) = \\tau_v(y) + \\tau_t(y) $$\n粘性部分使用牛顿粘性定律，湍流部分使用 Boussinesq 假设和涡粘度 $\\nu_t$，方程变为：\n$$ \\tau(y) = \\rho \\nu \\frac{dU}{dy} + \\rho \\nu_t \\frac{dU}{dy} = \\rho (\\nu + \\nu_t) \\frac{dU}{dy} $$\n其中 $\\rho$ 是流体密度，$\\nu$ 是运动粘度，$U(y)$ 是距离壁面 $y$ 处的平均流向速度。\n\n问题陈述指出，平均动量平衡在半槽道（$y \\in [0, \\delta]$）内产生线性的总剪切应力分布：\n$$ \\tau(y) = \\rho u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right) $$\n其中 $u_\\tau = \\sqrt{\\tau_w/\\rho}$ 是摩擦速度，$\\tau_w$ 是壁面剪切应力，$\\delta$ 是半槽道高度。\n\n将两个 $\\tau(y)$ 的表达式相等，并求解速度梯度 $\\frac{dU}{dy}$，可得：\n$$ \\frac{dU}{dy} = \\frac{u_\\tau^2}{\\nu + \\nu_t} \\left(1 - \\frac{y}{\\delta}\\right) $$\n涡粘度 $\\nu_t$ 使用混合长度假设进行建模：\n$$ \\nu_t = \\ell_m^2 \\left|\\frac{dU}{dy}\\right| $$\n在槽道流中，速度梯度 $\\frac{dU}{dy}$ 是正的，因此我们可以写成 $\\nu_t = \\ell_m^2 \\frac{dU}{dy}$。将其代入 $\\frac{dU}{dy}$ 的方程中，得到一个隐式关系：\n$$ \\frac{dU}{dy} = \\frac{u_\\tau^2}{\\nu + \\ell_m^2 \\frac{dU}{dy}} \\left(1 - \\frac{y}{\\delta}\\right) $$\n这可以重新整理成一个关于 $G = \\frac{dU}{dy}$ 的二次方程：\n$$ \\ell_m^2 G^2 + \\nu G - u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right) = 0 $$\n使用二次公式求解 $G$ 并取物理上有意义的正根（因为 $U$ 随远离壁面而增加），可得：\n$$ \\frac{dU}{dy} = \\frac{-\\nu + \\sqrt{\\nu^2 + 4\\ell_m^2 u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)}}{2\\ell_m^2} $$\n该方程在 $\\ell_m  0$ 时有效。在 $\\ell_m = 0$ 的情况下，我们恢复到线性关系：\n$$ \\frac{dU}{dy} = \\frac{u_\\tau^2}{\\nu} \\left(1 - \\frac{y}{\\delta}\\right) $$\n\n对于数值实现，问题指定了无量纲化 $\\delta = 1$ 和 $\\nu = 1$。这使得摩擦雷诺数 $Re_\\tau = \\frac{u_\\tau \\delta}{\\nu}$ 简化为 $u_\\tau = Re_\\tau$，无量纲壁面距离 $y^+ = \\frac{y u_\\tau}{\\nu}$ 简化为 $y^+ = y Re_\\tau$。$\\frac{dU}{dy}$ 的方程变为：\n- 对于 $\\ell_m  0$：$\\frac{dU}{dy} = \\frac{-1 + \\sqrt{1 + 4\\ell_m^2 Re_\\tau^2 (1 - y)}}{2\\ell_m^2}$\n- 对于 $\\ell_m = 0$：$\\frac{dU}{dy} = Re_\\tau^2 (1 - y)$\n\n### **2. 模型构建**\n\n两种模型仅在混合长度 $\\ell_m(y)$ 的规定上有所不同。\n\n**模型 1：平衡壁面函数模型 ($U^+_{\\mathrm{wf}}$)**\n该模型对混合长度采用突变切换。假设在低于某个阈值壁面距离 $y^+_{\\mathrm{sw}}$ 时，湍流不存在。\n$$\n\\ell_m(y) = \\begin{cases} \n0  \\text{if } y^+ \\le y^+_{\\mathrm{sw}} \\\\\n\\kappa y  \\text{if } y^+  y^+_{\\mathrm{sw}}\n\\end{cases}\n$$\n这里，$\\kappa = 0.41$ 是冯·卡门常数。速度梯度 $\\frac{dU}{dy}$ 根据 $\\ell_m(y)$ 的这种分段定义，使用相应的公式计算。\n\n**模型 2：低雷诺数模型 ($U^+_{\\mathrm{lr}}$)**\n该模型使用一个连续的阻尼函数，使混合长度从壁面到外部流场平滑过渡。使用了 van Driest 阻尼函数 $f_d(y^+)$：\n$$ \\ell_m(y) = \\kappa y f_d(y^+) \\quad \\text{with} \\quad f_d(y^+) = 1 - \\exp\\!\\left(-\\frac{y^+}{A^+}\\right) $$\n常数 $A^+$ 给定为 $26$。\n对于 $y  0$，$\\ell_m(y)  0$，可以使用二次公式求解 $\\frac{dU}{dy}$。然而，在壁面处（$y=0$），$\\ell_m(0)=0$。这在二次公式解中造成了奇异点。在 $y=0$ 处，我们必须使用 $\\ell_m=0$ 的情况，此时正确地计算出 $\\frac{dU}{dy}|_{y=0} = Re_\\tau^2$。\n\n### **3. 数值实现与指标**\n\n对于每个测试用例 $(Re_\\tau, y^+_{\\mathrm{sw}}, N)$，求解过程如下：\n1. 为 $y \\in [0, 1]$ 创建一个包含 $N$ 个点的均匀网格。\n2. 对每个模型，根据各自的 $\\ell_m(y)$ 公式，在每个网格点上计算一个代表 $\\frac{dU}{dy}$ 的数组。\n3. 通过从壁面（$y=0$）开始，使用无滑移边界条件 $U(0)=0$ 对 $\\frac{dU}{dy}$ 进行数值积分，得到速度剖面 $U(y)$。为获得高精度，采用累积梯形法则。这通过 `scipy.integrate.cumulative_trapezoid` 实现。\n4. 将有量纲的速度剖面 $U(y)$ 通过摩擦速度 $u_\\tau=Re_\\tau$ 进行归一化，以获得无量纲剖面 $U^+(y) = U(y)/Re_\\tau$。\n5. 使用指定的指标比较得到的两个剖面 $U^+_{\\mathrm{wf}}(y)$ 和 $U^+_{\\mathrm{lr}}(y)$：\n    - 均方根偏差 (RMSD): $\\mathrm{RMSD} = \\left[\\frac{1}{N}\\sum_{i=1}^{N} \\left(U^+_{\\mathrm{wf}}(y_i) - U^+_{\\mathrm{lr}}(y_i)\\right)^2\\right]^{1/2}$\n    - 最大绝对偏差 (MAXD): $\\mathrm{MAXD} = \\max_{i} \\left|U^+_{\\mathrm{wf}}(y_i) - U^+_{\\mathrm{lr}}(y_i)\\right|$\n    - 中心线差异 ($\\Delta U^+_c$): 在槽道中心线 ($y=\\delta=1$) 处最大速度的差异。\n\n此过程系统地应用于所有提供的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef compute_velocity_profile(Re_tau, N, model_type, y_sw_plus=None):\n    \"\"\"\n    Computes the mean velocity profile for turbulent channel flow.\n\n    Args:\n        Re_tau (float): The friction Reynolds number.\n        N (int): The number of grid points.\n        model_type (str): The turbulence model ('wf' or 'lr').\n        y_sw_plus (float, optional): Switching y+ for the wall-function model.\n\n    Returns:\n        numpy.ndarray: The dimensionless velocity profile U+.\n    \"\"\"\n    # Problem-specified nondimensionalization and constants\n    delta = 1.0\n    nu = 1.0\n    kappa = 0.41\n    A_plus = 26.0\n    u_tau = Re_tau\n\n    y = np.linspace(0, delta, N)\n    dUdy = np.zeros(N)\n\n    if model_type == 'wf':\n        if y_sw_plus is None:\n            raise ValueError(\"y_sw_plus must be provided for wall-function model.\")\n        \n        y_plus = y * u_tau / nu\n        \n        # Region where lm = 0 (viscous/buffer)\n        viscous_region = y_plus = y_sw_plus\n        dUdy[viscous_region] = (u_tau**2 / nu) * (1 - y[viscous_region] / delta)\n\n        # Region where lm = kappa * y (log-law)\n        turbulent_region = y_plus > y_sw_plus\n        y_turb = y[turbulent_region]\n        \n        if y_turb.size > 0:\n            lm_turb = kappa * y_turb\n            term_inside_sqrt = nu**2 + 4 * lm_turb**2 * u_tau**2 * (1 - y_turb / delta)\n            numerator = -nu + np.sqrt(term_inside_sqrt)\n            denominator = 2 * lm_turb**2\n            dUdy[turbulent_region] = numerator / denominator\n\n    elif model_type == 'lr':\n        # At y=0, lm=0, so use the linear stress relation\n        dUdy[0] = (u_tau**2 / nu) * (1 - y[0] / delta)\n\n        # For y > 0\n        y_inner = y[1:]\n        y_plus_inner = y_inner * u_tau / nu\n        f_d = 1.0 - np.exp(-y_plus_inner / A_plus)\n        lm = kappa * y_inner * f_d\n        \n        term_inside_sqrt = nu**2 + 4 * lm**2 * u_tau**2 * (1 - y_inner / delta)\n        numerator = -nu + np.sqrt(term_inside_sqrt)\n        denominator = 2 * lm**2\n        dUdy[1:] = numerator / denominator\n        \n    else:\n        raise ValueError(\"Invalid model_type specified.\")\n\n    # Integrate dU/dy to get U(y) with U(0)=0\n    U = cumulative_trapezoid(dUdy, y, initial=0)\n    \n    # Normalize to get U+\n    U_plus = U / u_tau\n\n    return U_plus\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and compute metrics.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Re_tau, y_sw_plus, N)\n        (180.0, 11.0, 1200),\n        (395.0, 30.0, 1200),\n        (550.0, 11.0, 1500),\n        (80.0, 11.0, 1200),\n    ]\n\n    results = []\n    for case in test_cases:\n        Re_tau_val, y_sw_plus_val, N_val = case\n\n        # Compute profiles for both models\n        U_plus_wf = compute_velocity_profile(Re_tau_val, N_val, 'wf', y_sw_plus=y_sw_plus_val)\n        U_plus_lr = compute_velocity_profile(Re_tau_val, N_val, 'lr')\n        \n        # Calculate metrics\n        diff = U_plus_wf - U_plus_lr\n        \n        # RMSD = sqrt(1/N * sum((diff)^2))\n        rmsd = np.sqrt(np.mean(diff**2))\n        \n        # MAXD = max(|diff|)\n        maxd = np.max(np.abs(diff))\n        \n        # Centerline difference\n        delta_U_c = U_plus_wf[-1] - U_plus_lr[-1]\n        \n        results.extend([rmsd, maxd, delta_U_c])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}