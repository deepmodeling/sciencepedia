{
    "hands_on_practices": [
        {
            "introduction": "The foundation of all wall-bounded turbulence modeling rests on understanding the characteristic scales that govern the flow near a solid surface. This practice focuses on computing and interpreting the dimensionless wall units, $y^+$ and $u^+$, which are essential for classifying the different layers of the near-wall region. Mastering this calculation is the first step toward correctly applying and interpreting wall functions in CFD simulations, as it allows you to determine if your first grid point is in the viscous sublayer, buffer layer, or the logarithmic region where standard wall functions are valid .",
            "id": "4001766",
            "problem": "A zero-pressure-gradient turbulent boundary layer develops over a smooth, isothermal flat plate in air. At a given streamwise location, the wall shear stress and fluid properties are known from independent measurements. Four wall-normal locations are instrumented to provide the time-averaged mean velocity. Your task is to compute the wall coordinates and classify each point into near-wall regions consistent with the use of wall functions in Reynolds-Averaged Navier–Stokes (RANS) models, then report a single aggregated quantity.\n\nKnown data:\n- Air density: $\\rho = 1.20 \\ \\mathrm{kg \\, m^{-3}}$.\n- Air dynamic viscosity: $\\mu = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\, s}$.\n- Wall shear stress: $\\tau_{w} = 0.90 \\ \\mathrm{Pa}$.\n- Wall-normal locations and mean velocity: $(y_1, U_1) = (1.0 \\times 10^{-5} \\ \\mathrm{m}, \\ 0.500 \\ \\mathrm{m \\, s^{-1}})$, $(y_2, U_2) = (1.0 \\times 10^{-4} \\ \\mathrm{m}, \\ 8.20 \\ \\mathrm{m \\, s^{-1}})$, $(y_3, U_3) = (1.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 12.99038106 \\ \\mathrm{m \\, s^{-1}})$, $(y_4, U_4) = (5.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 18.18653349 \\ \\mathrm{m \\, s^{-1}})$.\n\nTasks:\n1. Starting from Newton’s law of viscosity and the definition of wall shear stress, and invoking the standard definition of wall units in turbulent boundary layer theory, derive the steps needed to compute the friction velocity $u_{\\tau}$, the kinematic viscosity $\\nu$, the wall distance in wall units $y^{+}$, and the velocity in wall units $u^{+}$ at each location.\n2. Compute $y_i^{+}$ and $u_i^{+}$ for $i \\in \\{1,2,3,4\\}$.\n3. Using the following region definitions based on $y^{+}$, classify each point: viscous sublayer if $y^{+} \\leq 5$, buffer layer if $5  y^{+}  30$, logarithmic (overlap) layer if $30 \\leq y^{+} \\leq 300$, outer wake if $y^{+} > 300$. Identify which points are suitable for applying standard high-Reynolds-number wall functions predicated on the logarithmic law of the wall.\n4. Let $\\mathcal{L}$ denote the set of indices of the points that fall in the logarithmic layer. Report the arithmetic mean of $u^{+}$ over $\\mathcal{L}$.\n\nAnswer specification:\n- Provide the final answer as a single dimensionless real number equal to the arithmetic mean of $u^{+}$ over the logarithmic-layer points.\n- Round your answer to four significant figures.\n- Do not include units with the final answer.",
            "solution": "The problem requires the analysis of four data points from a turbulent boundary layer to classify them into near-wall regions and compute a specific statistical quantity. The process involves calculating wall-scaled quantities ($y^{+}$ and $u^{+}$) and applying standard definitions for boundary layer regions.\n\n### Step 1: Derivation of Wall Unit Calculations\n\nThe analysis is based on the concept of wall units, which non-dimensionalize quantities near a solid boundary using wall-based scales.\n\nThe **friction velocity**, denoted by $u_{\\tau}$, is the characteristic velocity scale and is defined from the wall shear stress, $\\tau_w$, and the fluid density, $\\rho$:\n$$\n\\tau_w = \\rho u_{\\tau}^2\n$$\nSolving for $u_{\\tau}$ yields:\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n\nThe **kinematic viscosity**, $\\nu$, is the ratio of the dynamic viscosity, $\\mu$, to the density, $\\rho$:\n$$\n\\nu = \\frac{\\mu}{\\rho}\n$$\n\nThe characteristic length scale in the near-wall region is the viscous length scale, $\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}$. The physical distance from the wall, $y$, and the mean velocity, $U$, are non-dimensionalized using these scales.\n\nThe **dimensionless wall distance**, $y^{+}$, is defined as:\n$$\ny^{+} = \\frac{y}{\\delta_{\\nu}} = \\frac{y u_{\\tau}}{\\nu}\n$$\n\nThe **dimensionless velocity**, $u^{+}$, is defined as:\n$$\nu^{+} = \\frac{U}{u_{\\tau}}\n$$\nThese definitions, starting from Newton's law of viscosity at the wall, $\\tau_w = \\mu (\\frac{dU}{dy})_{y=0}$, form the basis for the law-of-the-wall formulation.\n\n### Step 2: Calculation of Physical Scales and Wall Coordinates\n\nFirst, we compute the constant physical scales $u_{\\tau}$ and $\\nu$ using the provided data:\n$\\rho = 1.20 \\ \\mathrm{kg \\, m^{-3}}$\n$\\mu = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\, s}$\n$\\tau_{w} = 0.90 \\ \\mathrm{Pa}$\n\nThe friction velocity is:\n$$\nu_{\\tau} = \\sqrt{\\frac{0.90 \\ \\mathrm{Pa}}{1.20 \\ \\mathrm{kg \\, m^{-3}}}} = \\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}} = \\frac{\\sqrt{3}}{2} \\ \\mathrm{m \\, s^{-1}} \\approx 0.866025 \\ \\mathrm{m \\, s^{-1}}\n$$\n\nThe kinematic viscosity is:\n$$\n\\nu = \\frac{1.80 \\times 10^{-5} \\ \\mathrm{Pa \\, s}}{1.20 \\ \\mathrm{kg \\, m^{-3}}} = 1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}\n$$\n\nNow, we compute $y_i^{+}$ and $u_i^{+}$ for each measurement point $(y_i, U_i)$ for $i \\in \\{1, 2, 3, 4\\}$.\n\n**Point 1:** $(y_1, U_1) = (1.0 \\times 10^{-5} \\ \\mathrm{m}, \\ 0.500 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_1^{+} = \\frac{y_1 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-5} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{\\sqrt{0.75}}{1.5} = \\frac{\\sqrt{3}/2}{3/2} = \\frac{\\sqrt{3}}{3} \\approx 0.57735\n$$\n$$\nu_1^{+} = \\frac{U_1}{u_{\\tau}} = \\frac{0.500 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = \\frac{0.5}{\\sqrt{3}/2} = \\frac{1}{\\sqrt{3}} = \\frac{\\sqrt{3}}{3} \\approx 0.57735\n$$\n\n**Point 2:** $(y_2, U_2) = (1.0 \\times 10^{-4} \\ \\mathrm{m}, \\ 8.20 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_2^{+} = \\frac{y_2 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-4} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{10 \\sqrt{0.75}}{1.5} = \\frac{10\\sqrt{3}}{3} \\approx 5.7735\n$$\n$$\nu_2^{+} = \\frac{U_2}{u_{\\tau}} = \\frac{8.20 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = \\frac{8.20}{\\sqrt{3}/2} = \\frac{16.4}{\\sqrt{3}} \\approx 9.4681\n$$\n\n**Point 3:** $(y_3, U_3) = (1.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 12.99038106 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_3^{+} = \\frac{y_3 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-3} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{100 \\sqrt{0.75}}{1.5} = \\frac{100\\sqrt{3}}{3} \\approx 57.735\n$$\nThe value of $U_3$ is precisely constructed. We check: $15 \\times u_\\tau = 15 \\times \\frac{\\sqrt{3}}{2} = 7.5\\sqrt{3} \\approx 12.99038106$. Thus:\n$$\nu_3^{+} = \\frac{U_3}{u_{\\tau}} = \\frac{12.99038106 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = 15.00\n$$\n\n**Point 4:** $(y_4, U_4) = (5.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 18.18653349 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_4^{+} = \\frac{y_4 u_{\\tau}}{\\nu} = \\frac{(5.0 \\times 10^{-3} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{500 \\sqrt{0.75}}{1.5} = \\frac{500\\sqrt{3}}{3} \\approx 288.675\n$$\nSimilarly, the value of $U_4$ is precisely constructed. We check: $21 \\times u_\\tau = 21 \\times \\frac{\\sqrt{3}}{2} = 10.5\\sqrt{3} \\approx 18.18653349$. Thus:\n$$\nu_4^{+} = \\frac{U_4}{u_{\\tau}} = \\frac{18.18653349 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = 21.00\n$$\n\n### Step 3: Classification of Points\n\nUsing the standard region definitions based on $y^{+}$:\n- Viscous sublayer: $y^{+} \\leq 5$\n- Buffer layer: $5  y^{+}  30$\n- Logarithmic (overlap) layer: $30 \\leq y^{+} \\leq 300$\n- Outer wake: $y^{+} > 300$\n\nWe classify each point:\n- **Point 1:** $y_1^{+} \\approx 0.577$. Since $0.577 \\leq 5$, this point lies in the **viscous sublayer**. (Note: a defining feature of this layer is $u^{+} = y^{+}$, which holds for this point: $u_1^{+} \\approx 0.577$).\n- **Point 2:** $y_2^{+} \\approx 5.77$. Since $5  5.77  30$, this point lies in the **buffer layer**.\n- **Point 3:** $y_3^{+} \\approx 57.7$. Since $30 \\leq 57.7 \\leq 300$, this point lies in the **logarithmic layer**.\n- **Point 4:** $y_4^{+} \\approx 288.7$. Since $30 \\leq 288.7 \\leq 300$, this point also lies in the **logarithmic layer**.\n\nPoints located in the logarithmic layer are suitable for the application of standard high-Reynolds-number wall functions in RANS models, as these functions are based on the logarithmic law of the wall, $u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + C$, which is valid in this region. Therefore, points $3$ and $4$ are the relevant points.\n\n### Step 4: Calculation of the Arithmetic Mean\n\nThe problem asks for the arithmetic mean of $u^{+}$ over the set $\\mathcal{L}$ of indices of points that fall in the logarithmic layer. From our classification, $\\mathcal{L} = \\{3, 4\\}$. The corresponding dimensionless velocities are $u_3^{+} = 15$ and $u_4^{+} = 21$.\n\nThe arithmetic mean is:\n$$\n\\text{Mean}(u^{+}) = \\frac{1}{ |\\mathcal{L}| } \\sum_{i \\in \\mathcal{L}} u_i^{+} = \\frac{u_3^{+} + u_4^{+}}{2} = \\frac{15 + 21}{2} = \\frac{36}{2} = 18\n$$\n\nThe result is exactly $18$. As per the answer specification to round to four significant figures, the final answer is $18.00$.",
            "answer": "$$\\boxed{18.00}$$"
        },
        {
            "introduction": "After learning to identify the near-wall regions, the next step is to implement the logic that CFD solvers use to bridge the wall and the first computational cell. This exercise guides you through building a robust algorithm to calculate wall shear stress, $\\tau_w$, from a known velocity at a point near the wall. You will learn to implement the core task of any high-Reynolds-number wall function: inverting the implicit law-of-the-wall equation using iterative numerical methods .",
            "id": "4001748",
            "problem": "Consider a single wall-adjacent control volume in a Reynolds-Averaged Navier–Stokes (RANS) simulation using wall functions to provide a boundary condition for momentum at a smooth, isothermal wall with zero pressure gradient parallel to the wall. You are provided the parallel component of the mean velocity at the cell center, denoted by $U_P$ with units of $\\mathrm{m/s}$, the wall-normal distance from the wall to the cell center, denoted by $y_P$ with units of $\\mathrm{m}$, and the fluid properties density $\\rho$ with units of $\\mathrm{kg/m^3}$ and dynamic viscosity $\\mu$ with units of $\\mathrm{Pa\\,s}$. The task is to compute the wall shear stress $\\tau_w$ with units of $\\mathrm{Pa}$ by iteratively inverting the turbulent logarithmic law of the wall when appropriate, and otherwise using the linear viscous sublayer relation.\n\nUse the following fundamental definitions and well-tested empirical facts as your starting base:\n- Define the friction velocity by $u_\\tau = \\sqrt{\\tau_w / \\rho}$.\n- Define the dimensionless velocity by $U^+ = U_P / u_\\tau$ and the dimensionless wall distance by $y^+ = \\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}$.\n- For fully turbulent regions near the wall (excluding the viscous sublayer), the velocity distribution obeys the logarithmic law, $U^+ = \\dfrac{1}{\\kappa} \\ln(y^+) + B$, where $\\kappa$ is the von Kármán constant and $B$ is the smooth-wall additive constant. The logarithm is the natural logarithm.\n- For the viscous sublayer, the relation is $U^+ = y^+$.\n\nYour program must implement the following logic in a scientifically realistic and numerically robust way:\n- Compute an initial estimate of $u_\\tau$ from the viscous sublayer relation, and from it compute $y^+$ under the viscous assumption. If this viscous $y^+$ is less than or equal to a specified threshold $y^+_{\\mathrm{vs}}$, then use the viscous sublayer relation to compute $\\tau_w$. Otherwise, perform an iterative inversion of the logarithmic law to solve for $u_\\tau$ in the implicit equation $U_P/u_\\tau = \\dfrac{1}{\\kappa} \\ln\\!\\left(\\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) + B$ with $u_\\tau > 0$, and then compute $\\tau_w = \\rho\\,u_\\tau^2$.\n- Use a stable iterative method that guarantees positive $u_\\tau$, with a clear convergence criterion and a maximum number of iterations, and include a fallback strategy if your primary iteration fails to converge.\n\nPhysical units requirement: Express the final shear stress for each case in $\\mathrm{Pa}$ as floating-point numbers.\n\nThe constants $\\kappa$, $B$, and $y^+_{\\mathrm{vs}}$ are inputs to your computation. You may assume a smooth wall and high-Reynolds-number turbulence for the applicability of the logarithmic law when $y^+$ exceeds the viscous threshold.\n\nImplement your solution as a complete, runnable program that hardcodes and evaluates the following test suite, which is chosen to exercise different regimes and edge conditions. The program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nTest suite (each parameter set is $\\left(U_P, y_P, \\rho, \\mu, \\kappa, B, y^+_{\\mathrm{vs}}\\right)$):\n- Case $1$ (happy path, air, logarithmic layer): $\\left(10.0, 0.005, 1.200, 1.80\\times 10^{-5}, 0.41, 5.2, 11.0\\right)$\n- Case $2$ (boundary condition in viscous sublayer, air): $\\left(2.0, 1.2\\times 10^{-4}, 1.200, 1.80\\times 10^{-5}, 0.41, 5.2, 11.0\\right)$\n- Case $3$ (high-viscosity oil, viscous sublayer): $\\left(1.0, 0.010, 850.0, 0.10, 0.41, 5.2, 11.0\\right)$\n- Case $4$ (water, clearly logarithmic region): $\\left(20.0, 0.002, 1000.0, 1.00\\times 10^{-3}, 0.41, 5.2, 11.0\\right)$\n- Case $5$ (low-speed air near viscous sublayer): $\\left(0.05, 0.010, 1.225, 1.80\\times 10^{-5}, 0.41, 5.2, 11.0\\right)$\n\nOutput specification: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3}\\right]$), where each $\\mathrm{result}$ is the computed $\\tau_w$ in $\\mathrm{Pa}$ for the corresponding test case, in the order listed above.",
            "solution": "The goal is to compute the wall shear stress $\\tau_w$ from the given mean parallel velocity $U_P$, wall-normal distance $y_P$, and fluid properties $\\rho$ and $\\mu$, consistent with Reynolds-Averaged Navier–Stokes (RANS) wall functions. The essential physics is captured by the friction velocity $u_\\tau = \\sqrt{\\tau_w/\\rho}$ and the canonical near-wall scaling. We proceed from the definitions and widely accepted empirical near-wall velocity profiles.\n\nStart from the friction velocity definition:\n$$\nu_\\tau = \\sqrt{\\frac{\\tau_w}{\\rho}}, \\quad \\tau_w = \\rho\\,u_\\tau^2.\n$$\nIntroduce the dimensionless variables:\n$$\nU^+ = \\frac{U_P}{u_\\tau}, \\qquad y^+ = \\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}.\n$$\nIn the viscous sublayer, the near-wall behavior is linear:\n$$\nU^+ = y^+.\n$$\nSubstitute the definitions to obtain an explicit expression for $u_\\tau$ in the viscous regime. Setting $\\dfrac{U_P}{u_\\tau} = \\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}$ gives\n$$\nU_P = \\frac{\\rho\\,y_P}{\\mu}\\,u_\\tau^2 \\quad \\Rightarrow \\quad u_\\tau^2 = \\frac{U_P\\,\\mu}{\\rho\\,y_P}.\n$$\nThen,\n$$\n\\tau_w = \\rho\\,u_\\tau^2 = \\rho \\left(\\frac{U_P\\,\\mu}{\\rho\\,y_P}\\right) = \\frac{\\mu\\,U_P}{y_P}.\n$$\nThis viscous expression is exact under the linear sublayer assumption and serves two purposes: it provides the shear stress when the local $y^+$ is small, and it provides an initial estimate to assess the appropriate regime.\n\nIn the fully turbulent logarithmic layer, the empirically validated law of the wall states\n$$\nU^+ = \\frac{1}{\\kappa}\\,\\ln(y^+) + B,\n$$\nwhere $\\kappa$ is the von Kármán constant and $B$ is the additive constant for smooth walls. Substituting $U^+$ and $y^+$ definitions yields an implicit equation for $u_\\tau$:\n$$\n\\frac{U_P}{u_\\tau} = \\frac{1}{\\kappa}\\,\\ln\\!\\left(\\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) + B.\n$$\nDefine the residual function of $u_\\tau$:\n$$\nr(u_\\tau) = \\frac{U_P}{u_\\tau} - \\frac{1}{\\kappa} \\ln\\!\\left(\\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) - B.\n$$\nWe seek $u_\\tau > 0$ such that $r(u_\\tau) = 0$, which ensures consistency with the log-law. A principled iterative method is Newton's method, which uses the derivative\n$$\n\\frac{dr}{du_\\tau} = -\\frac{U_P}{u_\\tau^2} - \\frac{1}{\\kappa}\\cdot\\frac{1}{u_\\tau}.\n$$\nThe Newton update is\n$$\nu_\\tau^{(n+1)} = u_\\tau^{(n)} - \\frac{r\\!\\left(u_\\tau^{(n)}\\right)}{dr/du_\\tau\\!\\left(u_\\tau^{(n)}\\right)}.\n$$\nTo ensure physical admissibility and numerical robustness, we enforce $u_\\tau^{(n+1)} > 0$ and apply a backtracking line search if the residual does not decrease. A small positive lower bound prevents nonphysical arguments in the logarithm. The iteration terminates when $|r(u_\\tau)|$ is below a specified tolerance or when the relative change in $u_\\tau$ is sufficiently small. If Newton's method fails to converge within the maximum number of iterations, we fall back to a relaxed fixed-point iteration derived from rearranging the log-law:\n$$\nu_\\tau \\leftarrow \\frac{U_P}{\\frac{1}{\\kappa}\\,\\ln\\!\\left(\\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) + B},\n$$\ncombined with relaxation\n$$\nu_\\tau^{(n+1)} = \\alpha\\,u_\\tau^{\\text{fp}} + (1-\\alpha)\\,u_\\tau^{(n)}, \\quad \\alpha \\in (0,1),\n$$\nwhich damps oscillations.\n\nRegime selection is made by first computing the viscous estimate\n$$\nu_{\\tau,\\mathrm{visc}} = \\sqrt{\\frac{U_P\\,\\mu}{\\rho\\,y_P}}, \\qquad y^+_{\\mathrm{visc}} = \\frac{\\rho\\,u_{\\tau,\\mathrm{visc}}\\,y_P}{\\mu}.\n$$\nIf $y^+_{\\mathrm{visc}} \\le y^+_{\\mathrm{vs}}$, where $y^+_{\\mathrm{vs}}$ is a chosen threshold (commonly $y^+_{\\mathrm{vs}} \\approx 11$), then the viscous formula is used directly:\n$$\n\\tau_w = \\frac{\\mu\\,U_P}{y_P}.\n$$\nOtherwise, apply the iterative inversion of the log-law to find $u_\\tau$, and then compute\n$$\n\\tau_w = \\rho\\,u_\\tau^2.\n$$\n\nAlgorithmic steps for each test case:\n1. Read the parameters $\\left(U_P, y_P, \\rho, \\mu, \\kappa, B, y^+_{\\mathrm{vs}}\\right)$.\n2. Compute $u_{\\tau,\\mathrm{visc}}$ and $y^+_{\\mathrm{visc}}$ using the viscous sublayer relations.\n3. If $y^+_{\\mathrm{visc}} \\le y^+_{\\mathrm{vs}}$, set $\\tau_w = \\dfrac{\\mu\\,U_P}{y_P}$.\n4. Else, initialize $u_\\tau$ using a physically plausible guess, for example the viscous value adjusted by the log-law scaling, and perform Newton's method with backtracking until convergence. If Newton fails, perform relaxed fixed-point iteration.\n5. Compute $\\tau_w = \\rho\\,u_\\tau^2$.\n6. Output $\\tau_w$ in $\\mathrm{Pa}$.\n\nThis approach is grounded in the definitions of friction velocity and dimensionless wall variables, combined with the well-established empirical near-wall laws. The robust iteration ensures a physically admissible positive solution for $u_\\tau$, and the regime selection via $y^+_{\\mathrm{visc}}$ maintains scientific realism by using the appropriate law in each region. The program aggregates the computed shear stresses for the specified test suite into the required single-line output format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_wall_shear(U_P, y_P, rho, mu, kappa, B, yplus_switch,\n                       newton_max_iter=50, newton_tol=1e-12,\n                       fp_max_iter=200, fp_relax=0.5, fp_tol=1e-12):\n    \"\"\"\n    Compute wall shear stress tau_w (Pa) using hybrid viscous/log-law approach.\n    Inputs:\n        U_P: mean parallel velocity at cell center [m/s]\n        y_P: wall-normal distance to cell center [m]\n        rho: fluid density [kg/m^3]\n        mu: dynamic viscosity [Pa s]\n        kappa: von Karman constant [-]\n        B: additive constant [-]\n        yplus_switch: viscous sublayer threshold y+ [-]\n        newton_max_iter: max iterations for Newton\n        newton_tol: residual tolerance for Newton\n        fp_max_iter: max iterations for fixed-point fallback\n        fp_relax: relaxation factor for fixed-point\n        fp_tol: tolerance for fixed-point convergence\n    Returns:\n        tau_w: wall shear stress [Pa]\n    \"\"\"\n    # Guard against nonphysical inputs; keep positive values\n    eps = 1e-16\n    U_P = max(U_P, eps)\n    y_P = max(y_P, eps)\n    rho = max(rho, eps)\n    mu = max(mu, eps)\n    kappa = max(kappa, eps)\n\n    # Viscous sublayer estimate\n    u_tau_visc = np.sqrt((U_P * mu) / (rho * y_P))\n    y_plus_visc = (rho * u_tau_visc * y_P) / mu\n\n    # If viscous regime, use exact linear relation: tau_w = mu * U_P / y_P\n    if y_plus_visc = yplus_switch:\n        return mu * U_P / y_P\n\n    # Else, invert the log-law iteratively\n    # Residual function r(u) = U_P/u - (1/kappa)*ln(rho*u*y_P/mu) - B\n    def residual(u):\n        y_plus = (rho * u * y_P) / mu\n        y_plus = max(y_plus, eps)\n        return (U_P / u) - (1.0 / kappa) * np.log(y_plus) - B\n\n    def residual_prime(u):\n        # dr/du = -(U_P/u^2) - (1/kappa)*(1/u)\n        return - (U_P / (u * u)) - (1.0 / (kappa * u))\n\n    # Initial guess: use viscous u_tau as baseline and adjust\n    # A heuristic initial guess using fixed-point rearrangement with y_plus from viscous estimate\n    y_plus_guess = max((rho * u_tau_visc * y_P) / mu, 1.0)\n    U_plus_guess = (1.0 / kappa) * np.log(y_plus_guess) + B\n    u0 = U_P / max(U_plus_guess, eps)\n    u_tau = max(u0, u_tau_visc, 1e-6)\n\n    # Newton iteration with backtracking line search\n    r_prev = None\n    converged = False\n    for _ in range(newton_max_iter):\n        r = residual(u_tau)\n        if abs(r)  newton_tol:\n            converged = True\n            break\n        rp = residual_prime(u_tau)\n        # Avoid division by zero or extreme updates\n        if rp == 0.0 or not np.isfinite(rp):\n            break\n        delta = -r / rp\n        # Backtracking to ensure residual decreases and positivity of u_tau\n        lam = 1.0\n        for _ in range(20):\n            u_trial = u_tau + lam * delta\n            if u_trial = eps:\n                lam *= 0.5\n                continue\n            r_trial = residual(u_trial)\n            # Accept if residual decreases sufficiently\n            if r_prev is None or abs(r_trial) = abs(r) * (0.9 + 0.1 * lam):\n                u_tau = u_trial\n                r_prev = r_trial\n                break\n            lam *= 0.5\n        else:\n            # Line search failed; break to fallback\n            break\n\n    if not converged:\n        # Fixed-point fallback with relaxation\n        u_tau = max(u_tau, 1e-6)\n        for _ in range(fp_max_iter):\n            y_plus = max((rho * u_tau * y_P) / mu, 1.0)\n            denom = (1.0 / kappa) * np.log(y_plus) + B\n            denom = max(denom, 1e-6)\n            u_fp = U_P / denom\n            u_new = fp_relax * u_fp + (1.0 - fp_relax) * u_tau\n            if abs(u_new - u_tau) / max(u_tau, 1e-12)  fp_tol:\n                u_tau = u_new\n                converged = True\n                break\n            u_tau = max(u_new, 1e-6)\n\n    # Compute tau_w from u_tau; if still not converged, return viscous as a safe fallback\n    if not converged and y_plus_visc > yplus_switch:\n        # As a last resort, use a blended value to avoid failure\n        tau_log = rho * u_tau * u_tau\n        tau_visc = mu * U_P / y_P\n        # Blend weights based on initial y_plus_visc\n        w = min(max((y_plus_visc - yplus_switch) / (y_plus_visc + 1.0), 0.0), 1.0)\n        return (1.0 - w) * tau_visc + w * tau_log\n\n    return rho * u_tau * u_tau\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (U_P [m/s], y_P [m], rho [kg/m^3], mu [Pa s], kappa [-], B [-], yplus_switch [-])\n    test_cases = [\n        (10.0, 0.005, 1.200, 1.80e-5, 0.41, 5.2, 11.0),\n        (2.0, 1.2e-4, 1.200, 1.80e-5, 0.41, 5.2, 11.0),\n        (1.0, 0.010, 850.0, 0.10, 0.41, 5.2, 11.0),\n        (20.0, 0.002, 1000.0, 1.00e-3, 0.41, 5.2, 11.0),\n        (0.05, 0.010, 1.225, 1.80e-5, 0.41, 5.2, 11.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        U_P, y_P, rho, mu, kappa, B, yplus_switch = case\n        tau_w = compute_wall_shear(U_P, y_P, rho, mu, kappa, B, yplus_switch)\n        results.append(tau_w)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Having implemented the core wall function algorithm, we can now explore its impact on the entire flow field and compare it against a more detailed modeling approach. This practice involves developing two one-dimensional models for a turbulent channel flow: one mimicking a simplified wall-function approach and another using a fully resolved low-Reynolds-number model that captures the physics through the viscous sublayer. Comparing the resulting velocity profiles allows you to visualize and quantify the modeling assumptions and inherent approximations of the equilibrium wall function, providing critical insight into the trade-offs between computational cost and accuracy in turbulence modeling .",
            "id": "4001755",
            "problem": "You are to implement and compare two one-dimensional models of the mean streamwise velocity profile in a fully developed, incompressible turbulent channel flow using principles suitable for Reynolds-Averaged Navier–Stokes (RANS) modeling. The focus is the use of equilibrium wall functions versus a fully resolved low-Reynolds-number closure, at matched friction Reynolds number. All computations must be performed for the half-channel, from the wall at $y=0$ to the centerline at $y=\\delta$, where $\\delta$ is the half-channel height.\n\nBegin from the following foundational base:\n- The streamwise mean momentum balance for fully developed channel flow implies a linear total shear stress distribution across the half-channel, $\\tau(y) = \\rho u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)$, where $\\rho$ is the fluid density and $u_\\tau$ is the friction velocity defined by $u_\\tau = \\sqrt{\\tau_w/\\rho}$ and $\\tau_w$ is the wall shear stress.\n- The friction Reynolds number is $Re_\\tau = \\frac{u_\\tau \\delta}{\\nu}$, where $\\nu$ is the kinematic viscosity.\n- The eddy viscosity in a mixing-length closure is $\\nu_t = \\ell_m^2 \\left|\\frac{dU}{dy}\\right|$, where $U(y)$ is the mean velocity and $\\ell_m(y)$ is the mixing length.\n- Near-wall scalings are represented using the dimensionless variables $y^+ = \\frac{y u_\\tau}{\\nu}$ and $U^+ = \\frac{U}{u_\\tau}$.\n\nUsing only these bases, construct two models:\n1. An equilibrium wall-function model in which the mixing length is set to $\\ell_m(y) = \\kappa y$ for positions where $y^+$ exceeds a threshold switching value $y^+_{\\mathrm{sw}}$, and $\\ell_m(y) = 0$ for positions where $y^+ \\le y^+_{\\mathrm{sw}}$. Use $\\kappa = 0.41$ as the von Kármán constant.\n2. A fully resolved low-Reynolds-number model in which the mixing length uses van Driest damping, $\\ell_m(y) = \\kappa y f_d(y^+)$ with $f_d(y^+) = 1 - \\exp\\!\\left(-\\frac{y^+}{A^+}\\right)$ and $A^+ = 26$.\n\nIn each model, use the linear total shear stress distribution to determine $\\frac{dU}{dy}$ across $y \\in [0,\\delta]$ and integrate from $U(0) = 0$ to obtain $U(y)$. Then convert to the dimensionless mean velocity $U^+(y) = U(y)/u_\\tau$ on a uniform grid in $y$.\n\nFor numerical implementation and comparison:\n- Use $\\delta = 1$ and $\\nu = 1$ (nondimensionalization) so that $u_\\tau = Re_\\tau$ and $y^+ = y Re_\\tau$.\n- Use a uniform grid of $N$ points in $y \\in [0,\\delta]$ with $N \\ge 1000$.\n- Compute the profiles $U^+_{\\mathrm{wf}}(y)$ from the equilibrium wall-function model and $U^+_{\\mathrm{lr}}(y)$ from the low-Reynolds-number model.\n- Quantify the difference using the following dimensionless metrics:\n  - The root-mean-square deviation over the grid, $\\mathrm{RMSD} = \\left[\\frac{1}{N}\\sum_{i=1}^{N} \\left(U^+_{\\mathrm{wf}}(y_i) - U^+_{\\mathrm{lr}}(y_i)\\right)^2\\right]^{1/2}$.\n  - The maximum absolute deviation, $\\mathrm{MAXD} = \\max_{i} \\left|U^+_{\\mathrm{wf}}(y_i) - U^+_{\\mathrm{lr}}(y_i)\\right|$.\n  - The centerline difference, $\\Delta U^+_c = U^+_{\\mathrm{wf}}(y=\\delta) - U^+_{\\mathrm{lr}}(y=\\delta)$.\n\nAll reported metrics are dimensionless and must be computed with consistent $N$ across models.\n\nTest suite:\n- Case 1 (happy path): $Re_\\tau = 180$, $y^+_{\\mathrm{sw}} = 11$, $N = 1200$.\n- Case 2 (outer-layer emphasis): $Re_\\tau = 395$, $y^+_{\\mathrm{sw}} = 30$, $N = 1200$.\n- Case 3 (higher turbulence intensity): $Re_\\tau = 550$, $y^+_{\\mathrm{sw}} = 11$, $N = 1500$.\n- Case 4 (lower turbulence threshold edge case): $Re_\\tau = 80$, $y^+_{\\mathrm{sw}} = 11$, $N = 1200$.\n\nYour program must produce, without any external input, a single line of output containing the results as a comma-separated list enclosed in square brackets. Aggregate the metrics from all test cases in order, flattened into a single list of floats: $[\\mathrm{RMSD}_1,\\mathrm{MAXD}_1,\\Delta U^+_{c,1},\\mathrm{RMSD}_2,\\mathrm{MAXD}_2,\\Delta U^+_{c,2},\\mathrm{RMSD}_3,\\mathrm{MAXD}_3,\\Delta U^+_{c,3},\\mathrm{RMSD}_4,\\mathrm{MAXD}_4,\\Delta U^+_{c,4}]$. All values are dimensionless floats.",
            "solution": "The problem requires the implementation and comparison of two one-dimensional models for the mean velocity profile in a turbulent channel flow: an equilibrium wall-function model and a low-Reynolds-number model. The solution is derived from the mean momentum balance and a mixing-length turbulence closure.\n\n### **1. Governing Equation for the Mean Velocity Gradient**\n\nFor a fully developed, incompressible turbulent channel flow, the total shear stress $\\tau$ is the sum of the viscous shear stress $\\tau_v$ and the turbulent (Reynolds) shear stress $\\tau_t$:\n$$ \\tau(y) = \\tau_v(y) + \\tau_t(y) $$\nUsing Newton's law of viscosity for the viscous part and the Boussinesq hypothesis with an eddy viscosity $\\nu_t$ for the turbulent part, this becomes:\n$$ \\tau(y) = \\rho \\nu \\frac{dU}{dy} + \\rho \\nu_t \\frac{dU}{dy} = \\rho (\\nu + \\nu_t) \\frac{dU}{dy} $$\nwhere $\\rho$ is the fluid density, $\\nu$ is the kinematic viscosity, and $U(y)$ is the mean streamwise velocity at a distance $y$ from the wall.\n\nThe problem states that the mean momentum balance yields a linear total shear stress distribution across the half-channel ($y \\in [0, \\delta]$):\n$$ \\tau(y) = \\rho u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right) $$\nwhere $u_\\tau = \\sqrt{\\tau_w/\\rho}$ is the friction velocity, $\\tau_w$ is the wall shear stress, and $\\delta$ is the half-channel height.\n\nEquating the two expressions for $\\tau(y)$ and solving for the velocity gradient $\\frac{dU}{dy}$ gives:\n$$ \\frac{dU}{dy} = \\frac{u_\\tau^2}{\\nu + \\nu_t} \\left(1 - \\frac{y}{\\delta}\\right) $$\nThe eddy viscosity $\\nu_t$ is modeled using a mixing-length hypothesis:\n$$ \\nu_t = \\ell_m^2 \\left|\\frac{dU}{dy}\\right| $$\nIn channel flow, the velocity gradient $\\frac{dU}{dy}$ is positive, so we can write $\\nu_t = \\ell_m^2 \\frac{dU}{dy}$. Substituting this into the equation for $\\frac{dU}{dy}$ yields an implicit relation:\n$$ \\frac{dU}{dy} = \\frac{u_\\tau^2}{\\nu + \\ell_m^2 \\frac{dU}{dy}} \\left(1 - \\frac{y}{\\delta}\\right) $$\nThis can be rearranged into a quadratic equation for $G = \\frac{dU}{dy}$:\n$$ \\ell_m^2 G^2 + \\nu G - u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right) = 0 $$\nSolving for $G$ using the quadratic formula and taking the physically meaningful positive root (since $U$ increases away from the wall) gives:\n$$ \\frac{dU}{dy} = \\frac{-\\nu + \\sqrt{\\nu^2 + 4\\ell_m^2 u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)}}{2\\ell_m^2} $$\nThis equation is valid for $\\ell_m > 0$. In the case where $\\ell_m = 0$, we revert to the linear relationship:\n$$ \\frac{dU}{dy} = \\frac{u_\\tau^2}{\\nu} \\left(1 - \\frac{y}{\\delta}\\right) $$\n\nFor numerical implementation, the problem specifies the nondimensionalization $\\delta = 1$ and $\\nu = 1$. This simplifies the friction Reynolds number $Re_\\tau = \\frac{u_\\tau \\delta}{\\nu}$ to $u_\\tau = Re_\\tau$, and the dimensionless wall distance $y^+ = \\frac{y u_\\tau}{\\nu}$ to $y^+ = y Re_\\tau$. The equations for $\\frac{dU}{dy}$ become:\n- For $\\ell_m > 0$: $\\frac{dU}{dy} = \\frac{-1 + \\sqrt{1 + 4\\ell_m^2 Re_\\tau^2 (1 - y)}}{2\\ell_m^2}$\n- For $\\ell_m = 0$: $\\frac{dU}{dy} = Re_\\tau^2 (1 - y)$\n\n### **2. Model Formulations**\n\nThe two models differ only in their prescription for the mixing length $\\ell_m(y)$.\n\n**Model 1: Equilibrium Wall-Function Model ($U^+_{\\mathrm{wf}}$)**\nThis model employs a sharp switch for the mixing length. Turbulence is assumed to be nonexistent below a certain threshold distance from the wall, $y^+_{\\mathrm{sw}}$.\n$$\n\\ell_m(y) = \\begin{cases} \n0  \\text{if } y^+ \\le y^+_{\\mathrm{sw}} \\\\\n\\kappa y  \\text{if } y^+ > y^+_{\\mathrm{sw}}\n\\end{cases}\n$$\nHere, $\\kappa = 0.41$ is the von Kármán constant. The velocity gradient $\\frac{dU}{dy}$ is calculated using the appropriate formula based on this piecewise definition of $\\ell_m(y)$.\n\n**Model 2: Low-Reynolds-Number Model ($U^+_{\\mathrm{lr}}$)**\nThis model uses a continuous damping function to smoothly transition the mixing length from the wall to the outer flow. The van Driest damping function $f_d(y^+)$ is used:\n$$ \\ell_m(y) = \\kappa y f_d(y^+) \\quad \\text{with} \\quad f_d(y^+) = 1 - \\exp\\!\\left(-\\frac{y^+}{A^+}\\right) $$\nThe constant $A^+$ is given as $26$.\nFor $y > 0$, $\\ell_m(y) > 0$, and the quadratic formula for $\\frac{dU}{dy}$ can be used. However, at the wall ($y=0$), $\\ell_m(0)=0$. This creates a singularity in the quadratic formula solution. At $y=0$, we must use the $\\ell_m=0$ case, which correctly evaluates to $\\frac{dU}{dy}|_{y=0} = Re_\\tau^2$.\n\n### **3. Numerical Implementation and Metrics**\n\nThe solution proceeds as follows for each test case $(Re_\\tau, y^+_{\\mathrm{sw}}, N)$:\n1. A uniform grid of $N$ points is created for $y \\in [0, 1]$.\n2. For each model, an array representing $\\frac{dU}{dy}$ is computed at each grid point according to the respective $\\ell_m(y)$ formulation.\n3. The velocity profile $U(y)$ is obtained by numerically integrating $\\frac{dU}{dy}$ from the wall ($y=0$) with the no-slip boundary condition $U(0)=0$. The cumulative trapezoidal rule is employed for high accuracy. This is performed using `scipy.integrate.cumulative_trapezoid`.\n4. The dimensional velocity profile $U(y)$ is normalized by the friction velocity $u_\\tau=Re_\\tau$ to obtain the dimensionless profile $U^+(y) = U(y)/Re_\\tau$.\n5. The two resulting profiles, $U^+_{\\mathrm{wf}}(y)$ and $U^+_{\\mathrm{lr}}(y)$, are compared using the specified metrics:\n    - Root-Mean-Square Deviation (RMSD): $\\mathrm{RMSD} = \\left[\\frac{1}{N}\\sum_{i=1}^{N} \\left(U^+_{\\mathrm{wf}}(y_i) - U^+_{\\mathrm{lr}}(y_i)\\right)^2\\right]^{1/2}$\n    - Maximum Absolute Deviation (MAXD): $\\mathrm{MAXD} = \\max_{i} \\left|U^+_{\\mathrm{wf}}(y_i) - U^+_{\\mathrm{lr}}(y_i)\\right|$\n    - Centerline Difference ($\\Delta U^+_c$): The difference in the maximum velocity at the channel centerline ($y=\\delta=1$).\n\nThis procedure is systematically applied to all test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef compute_velocity_profile(Re_tau, N, model_type, y_sw_plus=None):\n    \"\"\"\n    Computes the mean velocity profile for turbulent channel flow.\n\n    Args:\n        Re_tau (float): The friction Reynolds number.\n        N (int): The number of grid points.\n        model_type (str): The turbulence model ('wf' or 'lr').\n        y_sw_plus (float, optional): Switching y+ for the wall-function model.\n\n    Returns:\n        numpy.ndarray: The dimensionless velocity profile U+.\n    \"\"\"\n    # Problem-specified nondimensionalization and constants\n    delta = 1.0\n    nu = 1.0\n    kappa = 0.41\n    A_plus = 26.0\n    u_tau = Re_tau\n\n    y = np.linspace(0, delta, N)\n    dUdy = np.zeros(N)\n\n    if model_type == 'wf':\n        if y_sw_plus is None:\n            raise ValueError(\"y_sw_plus must be provided for wall-function model.\")\n        \n        y_plus = y * u_tau / nu\n        \n        # Region where lm = 0 (viscous/buffer)\n        viscous_region = y_plus = y_sw_plus\n        dUdy[viscous_region] = (u_tau**2 / nu) * (1 - y[viscous_region] / delta)\n\n        # Region where lm = kappa * y (log-law)\n        turbulent_region = y_plus > y_sw_plus\n        y_turb = y[turbulent_region]\n        \n        if y_turb.size > 0:\n            lm_turb = kappa * y_turb\n            term_inside_sqrt = nu**2 + 4 * lm_turb**2 * u_tau**2 * (1 - y_turb / delta)\n            numerator = -nu + np.sqrt(term_inside_sqrt)\n            denominator = 2 * lm_turb**2\n            dUdy[turbulent_region] = numerator / denominator\n\n    elif model_type == 'lr':\n        # At y=0, lm=0, so use the linear stress relation\n        dUdy[0] = (u_tau**2 / nu) * (1 - y[0] / delta)\n\n        # For y > 0\n        y_inner = y[1:]\n        y_plus_inner = y_inner * u_tau / nu\n        f_d = 1.0 - np.exp(-y_plus_inner / A_plus)\n        lm = kappa * y_inner * f_d\n        \n        term_inside_sqrt = nu**2 + 4 * lm**2 * u_tau**2 * (1 - y_inner / delta)\n        numerator = -nu + np.sqrt(term_inside_sqrt)\n        denominator = 2 * lm**2\n        dUdy[1:] = numerator / denominator\n        \n    else:\n        raise ValueError(\"Invalid model_type specified.\")\n\n    # Integrate dU/dy to get U(y) with U(0)=0\n    U = cumulative_trapezoid(dUdy, y, initial=0)\n    \n    # Normalize to get U+\n    U_plus = U / u_tau\n\n    return U_plus\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and compute metrics.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Re_tau, y_sw_plus, N)\n        (180.0, 11.0, 1200),\n        (395.0, 30.0, 1200),\n        (550.0, 11.0, 1500),\n        (80.0, 11.0, 1200),\n    ]\n\n    results = []\n    for case in test_cases:\n        Re_tau_val, y_sw_plus_val, N_val = case\n\n        # Compute profiles for both models\n        U_plus_wf = compute_velocity_profile(Re_tau_val, N_val, 'wf', y_sw_plus=y_sw_plus_val)\n        U_plus_lr = compute_velocity_profile(Re_tau_val, N_val, 'lr')\n        \n        # Calculate metrics\n        diff = U_plus_wf - U_plus_lr\n        \n        # RMSD = sqrt(1/N * sum((diff)^2))\n        rmsd = np.sqrt(np.mean(diff**2))\n        \n        # MAXD = max(|diff|)\n        maxd = np.max(np.abs(diff))\n        \n        # Centerline difference\n        delta_U_c = U_plus_wf[-1] - U_plus_lr[-1]\n        \n        results.extend([rmsd, maxd, delta_U_c])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}