{
    "hands_on_practices": [
        {
            "introduction": "在深入研究壁面函数如何在雷诺平均纳维-斯托克斯 (RANS) 模型中实现之前，我们必须首先掌握其理论基石：壁面单位。这个练习将指导您计算湍流边界层中的无量纲壁面距离 $y^+$ 和无量纲速度 $u^+$。通过将物理量转换为壁面单位 ，您可以将不同流动条件下的近壁区行为归一化，并准确地识别出粘性子层、缓冲层和对数律层，这是正确应用任何壁面模型的前提。",
            "id": "4001766",
            "problem": "零压力梯度湍流边界层在空气中光滑的等温平板上发展。在某一给定的流向位置，壁面剪切应力和流体性质通过独立测量已知。四个壁面法向位置被仪器测量，以提供时均速度。您的任务是计算壁面坐标，并将每个点根据雷诺平均纳维-斯托克斯 (RANS) 模型中壁面函数的使用方法，划分为相应的近壁区域，然后报告一个聚合量。\n\n已知数据：\n- 空气密度：$\\rho = 1.20 \\ \\mathrm{kg \\cdot m^{-3}}$。\n- 空气动力粘度：$\\mu = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$。\n- 壁面剪切应力：$\\tau_{w} = 0.90 \\ \\mathrm{Pa}$。\n- 壁面法向位置和平均速度：$(y_1, U_1) = (1.0 \\times 10^{-5} \\ \\mathrm{m}, \\ 0.500 \\ \\mathrm{m \\cdot s^{-1}})$，$(y_2, U_2) = (1.0 \\times 10^{-4} \\ \\mathrm{m}, \\ 8.20 \\ \\mathrm{m \\cdot s^{-1}})$，$(y_3, U_3) = (1.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 12.99038106 \\ \\mathrm{m \\cdot s^{-1}})$，$(y_4, U_4) = (5.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 18.18653349 \\ \\mathrm{m \\cdot s^{-1}})$。\n\n任务：\n1. 从牛顿粘性定律和壁面剪切应力的定义出发，并引用湍流边界层理论中壁面单位的标准定义，推导计算每个位置的摩擦速度 $u_{\\tau}$、运动粘度 $\\nu$、无量纲壁面距离 $y^{+}$ 和无量纲速度 $u^{+}$ 所需的步骤。\n2. 计算 $i \\in \\{1,2,3,4\\}$ 时各点的 $y_i^{+}$ 和 $u_i^{+}$。\n3. 使用以下基于 $y^{+}$ 的区域定义对每个点进行分类：若 $y^{+} \\leq 5$，则为粘性子层；若 $5 < y^{+} < 30$，则为缓冲层；若 $30 \\leq y^{+} \\leq 300$，则为对数律层（重叠层）；若 $y^{+} > 300$，则为外部尾流区。确定哪些点适合应用基于壁面律的对数律的标准高雷诺数壁面函数。\n4. 令 $\\mathcal{L}$ 表示落入对数律层的点的索引集合。报告 $\\mathcal{L}$ 上 $u^{+}$ 的算术平均值。\n\n答案规格：\n- 最终答案以单个无量纲实数的形式给出，该数值等于对数律层各点的 $u^{+}$ 的算术平均值。\n- 将您的答案四舍五入至四位有效数字。\n- 最终答案不包含单位。",
            "solution": "该问题要求分析来自湍流边界层的四个数据点，将它们划分为近壁区域，并计算一个特定的统计量。该过程涉及计算壁面尺度的量（$y^{+}$ 和 $u^{+}$），并应用边界层区域的标准定义。\n\n### 步骤1：壁面单位计算的推导\n\n分析基于壁面单位的概念，该概念使用基于壁面的尺度对固体边界附近的物理量进行无量纲化。\n\n**摩擦速度**，记为 $u_{\\tau}$，是特征速度尺度，由壁面剪切应力 $\\tau_w$ 和流体密度 $\\rho$ 定义：\n$$\n\\tau_w = \\rho u_{\\tau}^2\n$$\n解出 $u_{\\tau}$ 得：\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n\n**运动粘度** $\\nu$ 是动力粘度 $\\mu$ 与密度 $\\rho$ 的比值：\n$$\n\\nu = \\frac{\\mu}{\\rho}\n$$\n\n近壁区域的特征长度尺度是粘性长度尺度 $\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}$。物理壁面距离 $y$ 和平均速度 $U$ 使用这些尺度进行无量纲化。\n\n**无量纲壁面距离** $y^{+}$ 定义为：\n$$\ny^{+} = \\frac{y}{\\delta_{\\nu}} = \\frac{y u_{\\tau}}{\\nu}\n$$\n\n**无量纲速度** $u^{+}$ 定义为：\n$$\nu^{+} = \\frac{U}{u_{\\tau}}\n$$\n这些定义，从壁面处的牛顿粘性定律 $\\tau_w = \\mu (\\frac{dU}{dy})_{y=0}$ 出发，构成了壁面律公式的基础。\n\n### 步骤2：物理尺度和壁面坐标的计算\n\n首先，我们使用所提供的数据计算恒定的物理尺度 $u_{\\tau}$ 和 $\\nu$：\n$\\rho = 1.20 \\ \\mathrm{kg \\cdot m^{-3}}$\n$\\mu = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$\n$\\tau_{w} = 0.90 \\ \\mathrm{Pa}$\n\n摩擦速度为：\n$$\nu_{\\tau} = \\sqrt{\\frac{0.90 \\ \\mathrm{Pa}}{1.20 \\ \\mathrm{kg \\cdot m^{-3}}}} = \\sqrt{0.75} \\ \\mathrm{m \\cdot s^{-1}} = \\frac{\\sqrt{3}}{2} \\ \\mathrm{m \\cdot s^{-1}} \\approx 0.866025 \\ \\mathrm{m \\cdot s^{-1}}\n$$\n\n运动粘度为：\n$$\n\\nu = \\frac{1.80 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}}{1.20 \\ \\mathrm{kg \\cdot m^{-3}}} = 1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\cdot s^{-1}}\n$$\n\n现在，我们为每个测量点 $(y_i, U_i)$（其中 $i \\in \\{1, 2, 3, 4\\}$）计算 $y_i^{+}$ 和 $u_i^{+}$。\n\n**点1：** $(y_1, U_1) = (1.0 \\times 10^{-5} \\ \\mathrm{m}, \\ 0.500 \\ \\mathrm{m \\cdot s^{-1}})$\n$$\ny_1^{+} = \\frac{y_1 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-5} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\cdot s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\cdot s^{-1}}} = \\frac{\\sqrt{0.75}}{1.5} = \\frac{\\sqrt{3}/2}{3/2} = \\frac{\\sqrt{3}}{3} \\approx 0.57735\n$$\n$$\nu_1^{+} = \\frac{U_1}{u_{\\tau}} = \\frac{0.500 \\ \\mathrm{m \\cdot s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\cdot s^{-1}}} = \\frac{0.5}{\\sqrt{3}/2} = \\frac{1}{\\sqrt{3}} = \\frac{\\sqrt{3}}{3} \\approx 0.57735\n$$\n\n**点2：** $(y_2, U_2) = (1.0 \\times 10^{-4} \\ \\mathrm{m}, \\ 8.20 \\ \\mathrm{m \\cdot s^{-1}})$\n$$\ny_2^{+} = \\frac{y_2 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-4} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\cdot s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\cdot s^{-1}}} = \\frac{10 \\sqrt{0.75}}{1.5} = \\frac{10\\sqrt{3}}{3} \\approx 5.7735\n$$\n$$\nu_2^{+} = \\frac{U_2}{u_{\\tau}} = \\frac{8.20 \\ \\mathrm{m \\cdot s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\cdot s^{-1}}} = \\frac{8.20}{\\sqrt{3}/2} = \\frac{16.4}{\\sqrt{3}} \\approx 9.4681\n$$\n\n**点3：** $(y_3, U_3) = (1.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 12.99038106 \\ \\mathrm{m \\cdot s^{-1}})$\n$$\ny_3^{+} = \\frac{y_3 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-3} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\cdot s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\cdot s^{-1}}} = \\frac{100 \\sqrt{0.75}}{1.5} = \\frac{100\\sqrt{3}}{3} \\approx 57.735\n$$\n$U_3$ 的值是精确构造的。我们验证：$15 \\times u_\\tau = 15 \\times \\frac{\\sqrt{3}}{2} = 7.5\\sqrt{3} \\approx 12.99038106$。因此：\n$$\nu_3^{+} = \\frac{U_3}{u_{\\tau}} = \\frac{12.99038106 \\ \\mathrm{m \\cdot s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\cdot s^{-1}}} = 15.00\n$$\n\n**点4：** $(y_4, U_4) = (5.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 18.18653349 \\ \\mathrm{m \\cdot s^{-1}})$\n$$\ny_4^{+} = \\frac{y_4 u_{\\tau}}{\\nu} = \\frac{(5.0 \\times 10^{-3} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\cdot s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\cdot s^{-1}}} = \\frac{500 \\sqrt{0.75}}{1.5} = \\frac{500\\sqrt{3}}{3} \\approx 288.675\n$$\n类似地，$U_4$ 的值是精确构造的。我们验证：$21 \\times u_\\tau = 21 \\times \\frac{\\sqrt{3}}{2} = 10.5\\sqrt{3} \\approx 18.18653349$。因此：\n$$\nu_4^{+} = \\frac{U_4}{u_{\\tau}} = \\frac{18.18653349 \\ \\mathrm{m \\cdot s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\cdot s^{-1}}} = 21.00\n$$\n\n### 步骤3：点的分类\n\n使用基于 $y^{+}$ 的标准区域定义：\n- 粘性子层：$y^{+} \\leq 5$\n- 缓冲层：$5 < y^{+} < 30$\n- 对数律层（重叠层）：$30 \\leq y^{+} \\leq 300$\n- 外部尾流区：$y^{+} > 300$\n\n我们对每个点进行分类：\n- **点1：** $y_1^{+} \\approx 0.577$。由于 $0.577 \\leq 5$，该点位于**粘性子层**。（注意：该层的一个定义特征是 $u^{+} = y^{+}$，这一点对此点成立：$u_1^{+} \\approx 0.577$）。\n- **点2：** $y_2^{+} \\approx 5.77$。由于 $5 < 5.77 < 30$，该点位于**缓冲层**。\n- **点3：** $y_3^{+} \\approx 57.7$。由于 $30 \\leq 57.7 \\leq 300$，该点位于**对数律层**。\n- **点4：** $y_4^{+} \\approx 288.7$。由于 $30 \\leq 288.7 \\leq 300$，该点也位于**对数律层**。\n\n位于对数律层的点适用于在 RANS 模型中应用标准高雷诺数壁面函数，因为这些函数基于在该区域有效的壁面律的对数律 $u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + C$。因此，点3和点4是相关点。\n\n### 步骤4：算术平均值的计算\n\n问题要求计算落入对数律层的点的索引集合 $\\mathcal{L}$ 上 $u^{+}$ 的算术平均值。根据我们的分类，$\\mathcal{L} = \\{3, 4\\}$。对应的无量纲速度为 $u_3^{+} = 15$ 和 $u_4^{+} = 21$。\n\n算术平均值为：\n$$\n\\text{Mean}(u^{+}) = \\frac{1}{ |\\mathcal{L}| } \\sum_{i \\in \\mathcal{L}} u_i^{+} = \\frac{u_3^{+} + u_4^{+}}{2} = \\frac{15 + 21}{2} = \\frac{36}{2} = 18\n$$\n\n结果恰好是18。根据答案规格要求四舍五入到四位有效数字，最终答案是18.00。",
            "answer": "$$\\boxed{18.00}$$"
        },
        {
            "introduction": "掌握了壁面单位的概念后，下一步是将其应用于一个核心的计算任务：从给定的流动参数中反解出壁面剪切应力。这个编程练习将模拟 CFD 求解器中壁面函数子程序的关键逻辑，您将实现一个能够根据第一层网格点的位置自动选择粘性子层或对数律层公式的函数。通过实现一个稳健的迭代求解器 ，您将对壁面函数如何将近壁区的理论与宏观流动计算联系起来有一个具体的理解。",
            "id": "4001748",
            "problem": "考虑在雷诺平均纳维-斯托克斯 (RANS) 模拟中，一个邻壁控制体积使用壁面函数为光滑、等温且平行于壁面方向压力梯度为零的壁面提供动量边界条件。给定单元中心的平均速度平行分量（记为 $U_P$，单位为 $\\mathrm{m/s}$）、从壁面到单元中心的壁面法向距离（记为 $y_P$，单位为 $\\mathrm{m}$），以及流体属性，包括密度 $\\rho$（单位为 $\\mathrm{kg/m^3}$）和动力粘度 $\\mu$（单位为 $\\mathrm{Pa \\cdot s}$）。任务是计算壁面剪切应力 $\\tau_w$（单位为 $\\mathrm{Pa}$），方法为在适当时迭代反解湍流对数律壁面法则，否则使用线性粘性子层关系。\n\n使用以下基本定义和经过充分检验的经验事实作为出发点：\n- 定义摩擦速度为 $u_\\tau = \\sqrt{\\tau_w / \\rho}$。\n- 定义无量纲速度为 $U^+ = U_P / u_\\tau$，无量纲壁面距离为 $y^+ = \\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}$。\n- 对于壁面附近的完全湍流区域（不包括粘性子层），速度分布遵循对数律，$U^+ = \\dfrac{1}{\\kappa} \\ln(y^+) + B$，其中 $\\kappa$ 是冯·卡门常数，$B$ 是光滑壁面加性常数。此处的对数是自然对数。\n- 对于粘性子层，关系式为 $U^+ = y^+$。\n\n你的程序必须以科学上真实且数值上稳健的方式实现以下逻辑：\n- 根据粘性子层关系计算 $u_\\tau$ 的初始估计值，并由此在粘性假设下计算 $y^+$。如果这个粘性 $y^+$ 小于或等于指定的阈值 $y^+_{\\mathrm{vs}}$，则使用粘性子层关系计算 $\\tau_w$。否则，对隐式方程 $U_P/u_\\tau = \\dfrac{1}{\\kappa} \\ln\\!\\left(\\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) + B$（其中 $u_\\tau > 0$）进行迭代反解以求出 $u_\\tau$，然后计算 $\\tau_w = \\rho\\,u_\\tau^2$。\n- 使用一种能保证 $u_\\tau$ 为正值的稳定迭代方法，该方法应有明确的收敛准则和最大迭代次数，并包含主迭代未能收敛时的回退策略。\n\n物理单位要求：对于每个案例，将最终的剪切应力以 $\\mathrm{Pa}$ 为单位表示为浮点数。\n\n常数 $\\kappa$、$B$ 和 $y^+_{\\mathrm{vs}}$ 是你计算的输入。当 $y^+$ 超过粘性阈值时，你可以假设为光滑壁面和高雷诺数湍流，以保证对数律的适用性。\n\n将你的解决方案实现为一个完整的、可运行的程序，该程序硬编码并评估以下测试套件。该测试套件旨在检验不同区域和边界条件。程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。\n\n测试套件（每组参数为 $\\left(U_P, y_P, \\rho, \\mu, \\kappa, B, y^+_{\\mathrm{vs}}\\right)$）：\n- 案例 1（理想路径，空气，对数层）：$\\left(10.0, 0.005, 1.200, 1.80\\times 10^{-5}, 0.41, 5.2, 11.0\\right)$\n- 案例 2（边界条件在粘性子层内，空气）：$\\left(2.0, 1.2\\times 10^{-4}, 1.200, 1.80\\times 10^{-5}, 0.41, 5.2, 11.0\\right)$\n- 案例 3（高粘度油，粘性子层）：$\\left(1.0, 0.010, 850.0, 0.10, 0.41, 5.2, 11.0\\right)$\n- 案例 4（水，明显的对数区）：$\\left(20.0, 0.002, 1000.0, 1.00\\times 10^{-3}, 0.41, 5.2, 11.0\\right)$\n- 案例 5（低速空气，靠近粘性子层）：$\\left(0.05, 0.010, 1.225, 1.80\\times 10^{-5}, 0.41, 5.2, 11.0\\right)$\n\n输出规范：你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表（例如 $\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3}\\right]$），其中每个 $\\mathrm{result}$ 是按上述顺序列出的对应测试案例计算出的 $\\tau_w$（单位为 $\\mathrm{Pa}$）。",
            "solution": "目标是根据给定的平均平行速度 $U_P$、壁面法向距离 $y_P$ 以及流体属性 $\\rho$ 和 $\\mu$，计算与雷诺平均纳维-斯托克斯 (RANS) 壁面函数一致的壁面剪切应力 $\\tau_w$。其核心物理由摩擦速度 $u_\\tau = \\sqrt{\\tau_w/\\rho}$ 和典型的近壁标度律捕捉。我们从基本定义和广泛接受的经验性近壁速度剖面出发。\n\n从摩擦速度的定义开始：\n$$\nu_\\tau = \\sqrt{\\frac{\\tau_w}{\\rho}}, \\quad \\tau_w = \\rho\\,u_\\tau^2.\n$$\n引入无量纲变量：\n$$\nU^+ = \\frac{U_P}{u_\\tau}, \\qquad y^+ = \\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}.\n$$\n在粘性子层中，近壁行为是线性的：\n$$\nU^+ = y^+.\n$$\n代入定义，得到在粘性区中 $u_\\tau$ 的显式表达式。令 $\\dfrac{U_P}{u_\\tau} = \\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}$，可得\n$$\nU_P = \\frac{\\rho\\,y_P}{\\mu}\\,u_\\tau^2 \\quad \\Rightarrow \\quad u_\\tau^2 = \\frac{U_P\\,\\mu}{\\rho\\,y_P}.\n$$\n于是，\n$$\n\\tau_w = \\rho\\,u_\\tau^2 = \\rho \\left(\\frac{U_P\\,\\mu}{\\rho\\,y_P}\\right) = \\frac{\\mu\\,U_P}{y_P}.\n$$\n在线性子层假设下，这个粘性表达式是精确的，并有两个作用：它在局部 $y^+$ 很小时提供剪切应力，并提供一个初始估计值来评估应采用哪个区域模型。\n\n在完全湍流的对数层中，经经验验证的壁面律表明\n$$\nU^+ = \\frac{1}{\\kappa}\\,\\ln(y^+) + B,\n$$\n其中 $\\kappa$ 是冯·卡门常数，$B$ 是光滑壁面的加性常数。代入 $U^+$ 和 $y^+$ 的定义，得到关于 $u_\\tau$ 的隐式方程：\n$$\n\\frac{U_P}{u_\\tau} = \\frac{1}{\\kappa}\\,\\ln\\!\\left(\\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) + B.\n$$\n定义关于 $u_\\tau$ 的残差函数：\n$$\nr(u_\\tau) = \\frac{U_P}{u_\\tau} - \\frac{1}{\\kappa} \\ln\\!\\left(\\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) - B.\n$$\n我们寻求 $u_\\tau > 0$ 使得 $r(u_\\tau) = 0$，这保证了与对数律的一致性。一种有准则的迭代方法是牛顿法，它使用导数\n$$\n\\frac{dr}{du_\\tau} = -\\frac{U_P}{u_\\tau^2} - \\frac{1}{\\kappa}\\cdot\\frac{1}{u_\\tau}.\n$$\n牛顿更新公式为\n$$\nu_\\tau^{(n+1)} = u_\\tau^{(n)} - \\frac{r\\!\\left(u_\\tau^{(n)}\\right)}{dr/du_\\tau\\!\\left(u_\\tau^{(n)}\\right)}.\n$$\n为确保物理可容许性和数值稳健性，我们强制 $u_\\tau^{(n+1)} > 0$，并在残差不减小时应用回溯线搜索。一个小的正数下界可以防止对数函数出现非物理参数。当 $|r(u_\\tau)|$ 低于指定容差或 $u_\\tau$ 的相对变化足够小时，迭代终止。如果牛顿法在最大迭代次数内未能收敛，我们回退到通过重排对数律得到的松弛定点迭代法：\n$$\nu_\\tau \\leftarrow \\frac{U_P}{\\frac{1}{\\kappa}\\,\\ln\\!\\left(\\frac{\\rho\\,u_\\tau\\,y_P}{\\mu}\\right) + B},\n$$\n结合松弛\n$$\nu_\\tau^{(n+1)} = \\alpha\\,u_\\tau^{\\text{fp}} + (1-\\alpha)\\,u_\\tau^{(n)}, \\quad \\alpha \\in (0,1),\n$$\n这可以抑制振荡。\n\n区域选择通过首先计算粘性估计值来进行\n$$\nu_{\\tau,\\mathrm{visc}} = \\sqrt{\\frac{U_P\\,\\mu}{\\rho\\,y_P}}, \\qquad y^+_{\\mathrm{visc}} = \\frac{\\rho\\,u_{\\tau,\\mathrm{visc}}\\,y_P}{\\mu}.\n$$\n如果 $y^+_{\\mathrm{visc}} \\le y^+_{\\mathrm{vs}}$，其中 $y^+_{\\mathrm{vs}}$ 是一个选定的阈值（通常 $y^+_{\\mathrm{vs}} \\approx 11$），则直接使用粘性公式：\n$$\n\\tau_w = \\frac{\\mu\\,U_P}{y_P}.\n$$\n否则，应用对数律的迭代反解来找到 $u_\\tau$，然后计算\n$$\n\\tau_w = \\rho\\,u_\\tau^2.\n$$\n\n每个测试案例的算法步骤：\n1. 读取参数 $\\left(U_P, y_P, \\rho, \\mu, \\kappa, B, y^+_{\\mathrm{vs}}\\right)$。\n2. 使用粘性子层关系式计算 $u_{\\tau,\\mathrm{visc}}$ 和 $y^+_{\\mathrm{visc}}$。\n3. 如果 $y^+_{\\mathrm{visc}} \\le y^+_{\\mathrm{vs}}$，则设 $\\tau_w = \\dfrac{\\mu\\,U_P}{y_P}$。\n4. 否则，使用一个物理上合理的猜测值（例如，用对数律标度调整后的粘性值）来初始化 $u_\\tau$，并执行带回溯的牛顿法直至收敛。如果牛顿法失败，则执行松弛定点迭代。\n5. 计算 $\\tau_w = \\rho\\,u_\\tau^2$。\n6. 以 $\\mathrm{Pa}$ 为单位输出 $\\tau_w$。\n\n此方法基于摩擦速度和无量纲壁面变量的定义，并结合了公认的经验性近壁定律。稳健的迭代确保了 $u_\\tau$ 有一个物理上可容许的正解，而通过 $y^+_{\\mathrm{visc}}$ 进行的区域选择，通过在每个区域使用适当的定律，保持了科学真实性。程序将指定测试套件计算出的剪切应力汇总成所需的单行输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_wall_shear(U_P, y_P, rho, mu, kappa, B, yplus_switch,\n                       newton_max_iter=50, newton_tol=1e-12,\n                       fp_max_iter=200, fp_relax=0.5, fp_tol=1e-12):\n    \"\"\"\n    Compute wall shear stress tau_w (Pa) using hybrid viscous/log-law approach.\n    Inputs:\n        U_P: mean parallel velocity at cell center [m/s]\n        y_P: wall-normal distance to cell center [m]\n        rho: fluid density [kg/m^3]\n        mu: dynamic viscosity [Pa s]\n        kappa: von Karman constant [-]\n        B: additive constant [-]\n        yplus_switch: viscous sublayer threshold y+ [-]\n        newton_max_iter: max iterations for Newton\n        newton_tol: residual tolerance for Newton\n        fp_max_iter: max iterations for fixed-point fallback\n        fp_relax: relaxation factor for fixed-point\n        fp_tol: tolerance for fixed-point convergence\n    Returns:\n        tau_w: wall shear stress [Pa]\n    \"\"\"\n    # Guard against nonphysical inputs; keep positive values\n    eps = 1e-16\n    U_P = max(U_P, eps)\n    y_P = max(y_P, eps)\n    rho = max(rho, eps)\n    mu = max(mu, eps)\n    kappa = max(kappa, eps)\n\n    # Viscous sublayer estimate\n    u_tau_visc = np.sqrt((U_P * mu) / (rho * y_P))\n    y_plus_visc = (rho * u_tau_visc * y_P) / mu\n\n    # If viscous regime, use exact linear relation: tau_w = mu * U_P / y_P\n    if y_plus_visc = yplus_switch:\n        return mu * U_P / y_P\n\n    # Else, invert the log-law iteratively\n    # Residual function r(u) = U_P/u - (1/kappa)*ln(rho*u*y_P/mu) - B\n    def residual(u):\n        y_plus = (rho * u * y_P) / mu\n        y_plus = max(y_plus, eps)\n        return (U_P / u) - (1.0 / kappa) * np.log(y_plus) - B\n\n    def residual_prime(u):\n        # dr/du = -(U_P/u^2) - (1/kappa)*(1/u)\n        return - (U_P / (u * u)) - (1.0 / (kappa * u))\n\n    # Initial guess: use viscous u_tau as baseline and adjust\n    # A heuristic initial guess using fixed-point rearrangement with y_plus from viscous estimate\n    y_plus_guess = max((rho * u_tau_visc * y_P) / mu, 1.0)\n    U_plus_guess = (1.0 / kappa) * np.log(y_plus_guess) + B\n    u0 = U_P / max(U_plus_guess, eps)\n    u_tau = max(u0, u_tau_visc, 1e-6)\n\n    # Newton iteration with backtracking line search\n    r_prev = None\n    converged = False\n    for _ in range(newton_max_iter):\n        r = residual(u_tau)\n        if abs(r)  newton_tol:\n            converged = True\n            break\n        rp = residual_prime(u_tau)\n        # Avoid division by zero or extreme updates\n        if rp == 0.0 or not np.isfinite(rp):\n            break\n        delta = -r / rp\n        # Backtracking to ensure residual decreases and positivity of u_tau\n        lam = 1.0\n        for _ in range(20):\n            u_trial = u_tau + lam * delta\n            if u_trial = eps:\n                lam *= 0.5\n                continue\n            r_trial = residual(u_trial)\n            # Accept if residual decreases sufficiently\n            if r_prev is None or abs(r_trial) = abs(r) * (0.9 + 0.1 * lam):\n                u_tau = u_trial\n                r_prev = r_trial\n                break\n            lam *= 0.5\n        else:\n            # Line search failed; break to fallback\n            break\n\n    if not converged:\n        # Fixed-point fallback with relaxation\n        u_tau = max(u_tau, 1e-6)\n        for _ in range(fp_max_iter):\n            y_plus = max((rho * u_tau * y_P) / mu, 1.0)\n            denom = (1.0 / kappa) * np.log(y_plus) + B\n            denom = max(denom, 1e-6)\n            u_fp = U_P / denom\n            u_new = fp_relax * u_fp + (1.0 - fp_relax) * u_tau\n            if abs(u_new - u_tau) / max(u_tau, 1e-12)  fp_tol:\n                u_tau = u_new\n                converged = True\n                break\n            u_tau = max(u_new, 1e-6)\n\n    # Compute tau_w from u_tau; if still not converged, return viscous as a safe fallback\n    if not converged and y_plus_visc > yplus_switch:\n        # As a last resort, use a blended value to avoid failure\n        tau_log = rho * u_tau * u_tau\n        tau_visc = mu * U_P / y_P\n        # Blend weights based on initial y_plus_visc\n        w = min(max((y_plus_visc - yplus_switch) / (y_plus_visc + 1.0), 0.0), 1.0)\n        return (1.0 - w) * tau_visc + w * tau_log\n\n    return rho * u_tau * u_tau\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (U_P [m/s], y_P [m], rho [kg/m^3], mu [Pa s], kappa [-], B [-], yplus_switch [-])\n    test_cases = [\n        (10.0, 0.005, 1.200, 1.80e-5, 0.41, 5.2, 11.0),\n        (2.0, 1.2e-4, 1.200, 1.80e-5, 0.41, 5.2, 11.0),\n        (1.0, 0.010, 850.0, 0.10, 0.41, 5.2, 11.0),\n        (20.0, 0.002, 1000.0, 1.00e-3, 0.41, 5.2, 11.0),\n        (0.05, 0.010, 1.225, 1.80e-5, 0.41, 5.2, 11.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        U_P, y_P, rho, mu, kappa, B, yplus_switch = case\n        tau_w = compute_wall_shear(U_P, y_P, rho, mu, kappa, B, yplus_switch)\n        results.append(tau_w)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "标准的高雷诺数壁面函数依赖于一个关键假设：第一层网格点必须位于对数律层中。这个练习探讨了当这个假设被违反时（例如，网格过密导致第一层网格点落入粘性子层）会发生什么。通过分析这种常见的不匹配情况所导致的误差 ，您将培养对壁面函数局限性的批判性认识，并理解为何需要更先进的方法，如低雷诺数模型或混合壁面处理。",
            "id": "4001779",
            "problem": "考虑一个紧邻等温壁面的、物性恒定的牛顿流体的统计定常、充分发展的湍流槽道流，该流动使用雷诺平均Navier–Stokes (RANS) 方法进行建模。设近壁无量纲变量定义为 $u^+ \\equiv U/u_\\tau$ 和 $y^+ \\equiv y u_\\tau/\\nu$，其中 $U$ 是平均流向速度，$y$ 是壁面法向距离，$\\nu$ 是运动粘度，$u_\\tau \\equiv \\sqrt{\\tau_w/\\rho}$ 是摩擦速度，$\\tau_w$ 是壁面剪切应力，$\\rho$ 是密度。在粘性子层中，总剪切应力满足 $\\tau \\approx \\tau_w$，且湍流涡粘度 $\\nu_t$ 与分子粘度 $\\nu$ 相比可以忽略不计，而在对数层中，湍流涡粘度占主导地位。高雷诺数壁面函数依赖于对数层的渐近假设，从离壁最近的第一个网格点推断 $u_\\tau$ 和近壁梯度。\n\n假设使用了一种高雷诺数壁面函数处理方法，但第一个网格点位于粘性子层内，即真实的 $y_p^+ \\approx 2$。求解器通过在第一个点上强制施加对数壁面律来推断 $u_\\tau$ 和 $\\tau_w$。在你的推理中，请从近壁的平均动量平衡、$u^+$ 和 $y^+$ 的定义以及粘性子层和对数层的渐近行为出发。如果需要，你可以使用速度对数律的典型常数 $\\kappa \\approx 0.41$ 和 $B \\approx 5.0$，并假设普朗特数 $Pr \\approx 1$ 和用于热学类比的湍流普朗特数 $Pr_t \\approx 0.85$。评估这种不匹配对推断的壁面剪切应力和壁面传热造成的后果，并找出理论上合理的补救策略。\n\n下列陈述中，哪些是正确的？\n\nA. 在 $y_p^+ \\approx 2$ 处强制施加对数壁面函数，会使得推断出的摩擦速度 $u_\\tau$ 和壁面剪切应力 $\\tau_w$ 相对于粘性子层动量平衡所隐含的值偏低；可接受的补救措施包括将第一个网格点移动到对数区（例如，$y_p^+ \\gtrsim 30$），或切换到能够解析粘性子层的低雷诺数湍流模型。\n\nB. 这种误用只影响动量；热壁面函数仍然有效，因此只要湍流普朗特数 $Pr_t$ 设置为 $1$，壁面热通量 $q_w$ 就不受影响。\n\nC. 一种在 $y^+ \\to 0$ 时能恢复 $u^+ = y^+$ 和 $T^+ = Pr \\cdot y^+$ 的混合壁面处理方法，可以在不更改网格的情况下减轻误差，并且与近壁动量和能量平衡相一致。\n\nD. 通过提高壁面处的湍动能来增加近壁涡粘度 $\\nu_t$，会迫使模型回到对数区，并且即使在 $y_p^+  5$ 的情况下也是一种合适的修正方法。",
            "solution": "问题陈述在科学上是合理的且提法恰当，为评估壁面函数在基于RANS的计算流体力学(CFD)中的应用提供了一个标准情景。我们将继续进行分析。\n\n近壁湍流建模的基本原理是正确地表示速度梯度和剪切应力之间的关系。湍流边界层中的总剪切应力 $\\tau$ 是粘性应力 $\\tau_v$ 和湍流雷诺应力 $\\tau_t$ 的和：\n$$ \\tau = \\rho \\nu \\frac{dU}{dy} - \\rho \\overline{u'v'} = \\rho (\\nu + \\nu_t) \\frac{dU}{dy} $$\n其中 $\\nu_t$ 是涡粘度。用壁面单位进行无量纲化，其中 $u^+ = U/u_\\tau$，$y^+ = y u_\\tau/\\nu$ 且 $u_\\tau = \\sqrt{\\tau_w/\\rho}$，该方程变为：\n$$ \\frac{\\tau}{\\tau_w} = \\left(1 + \\frac{\\nu_t}{\\nu}\\right) \\frac{du^+}{dy^+} $$\n在充分发展的槽道流的近壁区域，总应力近似恒定且等于壁面剪切应力，即 $\\tau \\approx \\tau_w$。因此，我们有：\n$$ 1 \\approx \\left(1 + \\frac{\\nu_t}{\\nu}\\right) \\frac{du^+}{dy^+} $$\n\n我们分析所提到的两个渐近区域：\n\n1.  **粘性子层：** 非常靠近壁面处（通常在 $y^+ \\lesssim 5$ 的区域），粘性效应占主导，湍流脉动被抑制。因此，$\\nu_t \\ll \\nu$。动量平衡简化为：\n    $$ 1 \\approx \\frac{du^+}{dy^+} $$\n    在无滑移条件（$y^+=0$ 时 $u^+=0$）下积分，得出线性速度剖面：\n    $$ u^+ = y^+ $$\n\n2.  **对数层：** 离壁面更远的地方（通常在 $30 \\lesssim y^+ \\lesssim 0.2\\delta^+$ 的区域，其中 $\\delta$ 是边界层厚度），湍流应力占主导，因此 $\\nu_t \\gg \\nu$。使用混合长度假设 $\\nu_t = (\\kappa y)^2 |dU/dy|$ 以及 $\\tau \\approx \\tau_w$ 的假设，我们可以推导出 $\\nu_t = \\kappa u_\\tau y = \\kappa \\nu y^+$。动量平衡变为：\n    $$ 1 \\approx \\frac{\\nu_t}{\\nu} \\frac{du^+}{dy^+} = \\kappa y^+ \\frac{du^+}{dy^+} $$\n    对此积分，得到对数壁面律：\n    $$ u^+ = \\frac{1}{\\kappa} \\ln(y^+) + B $$\n    其中 $\\kappa \\approx 0.41$ 和 $B \\approx 5.0$ 是经验常数。\n\n**对不匹配情况的分析**\n\n问题陈述，一个假设对数律有效的高雷诺数壁面函数被应用于第一个网格点 $p$ 上，该点所在位置的真实无量纲距离为 $y_p^+ \\approx 2$。\n\n在这个位置，正确的物理行为是粘性子层的行为。设 $u_{\\tau, \\text{true}}$ 为真实摩擦速度。点 $p$ 的真实状态由以下公式描述：\n$y_p^+ = y_p u_{\\tau, \\text{true}}/\\nu \\approx 2$\n$u_p^+ = U_p/u_{\\tau, \\text{true}} \\approx y_p^+ \\approx 2$\n由此，我们得到物理速度和位置：$U_p \\approx 2 u_{\\tau, \\text{true}}$ 和 $y_p \\approx 2\\nu/u_{\\tau, \\text{true}}$。\n\n然而，CFD求解器被编程为通过在点 $p$ 处错误地施加对数律来找到一个推断的摩擦速度 $u_{\\tau, \\text{inferred}}$：\n$$ \\frac{U_p}{u_{\\tau, \\text{inferred}}} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_p u_{\\tau, \\text{inferred}}}{\\nu}\\right) + B $$\n为了确定其后果，我们将 $U_p$ 和 $y_p$ 的真实物理值代入求解器的方程中：\n$$ \\frac{2 u_{\\tau, \\text{true}}}{u_{\\tau, \\text{inferred}}} = \\frac{1}{\\kappa} \\ln\\left(\\frac{2\\nu}{u_{\\tau, \\text{true}}} \\frac{u_{\\tau, \\text{inferred}}}{\\nu}\\right) + B $$\n设 $R = u_{\\tau, \\text{inferred}} / u_{\\tau, \\text{true}}$ 为推断的摩擦速度与真实摩擦速度之比。方程变为：\n$$ \\frac{2}{R} = \\frac{1}{\\kappa} \\ln(2R) + B $$\n我们需要确定 $R$ 是大于、小于还是等于 $1$。让我们测试 $R=1$ 的情况：\n-   左侧 (LHS): $2/1 = 2$.\n-   右侧 (RHS): $\\frac{1}{0.41} \\ln(2 \\cdot 1) + 5.0 \\approx 2.439 \\times 0.693 + 5.0 = 1.69 + 5.0 = 6.69$.\n由于 LHS ($2$) $\\neq$ RHS ($6.69$)，推断的速度不等于真实速度。\n让我们分析函数 $f(R) = 2/R$ 和 $g(R) = \\frac{1}{\\kappa}\\ln(2R) + B$。\n-   $f(R)$ 在 $R0$ 时是单调递减函数。\n-   $g(R)$ 在 $R0$ 时是单调递增函数。\n当 $R=1$ 时，我们有 $f(1)  g(1)$。为了找到 $f(R)=g(R)$ 的根，我们必须减小 $R$。一个更小的 $R$ 会增加 $f(R)$ 并减小 $g(R)$，使它们趋于相等。因此，解必须满足 $R  1$。\n这证明了 $u_{\\tau, \\text{inferred}}  u_{\\tau, \\text{true}}$。求解器推断出的摩擦速度低于真实值。由于壁面剪切应力为 $\\tau_w = \\rho u_\\tau^2$，推断出的壁面剪切应力 $\\tau_{w, \\text{inferred}}$ 将比真实值 $\\tau_{w, \\text{true}}$ 显著偏低。\n\n**逐项分析**\n\n**A. 在 $y_p^+ \\approx 2$ 处强制施加对数壁面函数，会使得推断出的摩擦速度 $u_\\tau$ 和壁面剪切应力 $\\tau_w$ 相对于粘性子层动量平衡所隐含的值偏低；可接受的补救措施包括将第一个网格点移动到对数区（例如，$y_p^+ \\gtrsim 30$），或切换到能够解析粘性子层的低雷诺数湍流模型。**\n-   我们的分析证实了 $u_{\\tau, \\text{inferred}}  u_{\\tau, \\text{true}}$，因此 $\\tau_{w, \\text{inferred}}  \\tau_{w, \\text{true}}$。偏差是偏低。\n-   将第一个网格点移动到 $y_p^+ \\gtrsim 30$ 确保了壁面函数的对数律假设有效，这是高雷诺数模型的标准做法。这是一个正确的补救措施。\n-   切换到能够解析流场直至壁面的粘性子层和缓冲层的低雷诺数模型（需要网格满足 $y_p^+ \\approx 1$），完全避免了壁面函数的使用，这是一种根本上正确但计算成本更高的替代方案。这也是一个正确的补救措施。\n-   该陈述完全正确。\n\n**B. 这种误用只影响动量；热壁面函数仍然有效，因此只要湍流普朗特数 $Pr_t$ 设置为 $1$，壁面热通量 $q_w$ 就不受影响。**\n-   这个陈述是不正确的。通过热壁面函数计算壁面热通量 $q_w$ 与动量计算密不可分。无量纲温度 $T^+ = (T_w - T)\\rho c_p u_\\tau / q_w$ 和无量纲距离 $y^+ = y u_\\tau/\\nu$ 都依赖于 $u_\\tau$。一个错误的 $u_\\tau$ 会导致在热壁面律中使用错误的 $y_p^+$ 值，以及错误的 $T^+$ 标度，从而导致错误的 $q_w$。\n-   物理模型也被误用。对于 $y_p^+ \\approx 2$，热传递由分子传导主导，导致线性剖面 $T^+ = Pr \\cdot y^+$。应用对数热力学定律就像应用速度对数律一样是错误的。\n-   设置 $Pr_t=1$ 仅仅在有缺陷的动量计算和热计算之间建立了一个完美的类比（对于 $y^+ \\gtrsim 30$ 时 $T^+ = u^+$）；它并不能修复在错误的区域使用错误的物理定律和使用有偏差的 $u_\\tau$ 这个根本性错误。动量上的错误会深刻影响热学预测。\n-   该陈述不正确。\n\n**C. 一种在 $y^+ \\to 0$ 时能恢复 $u^+ = y^+$ 和 $T^+ = Pr \\cdot y^+$ 的混合壁面处理方法，可以在不更改网格的情况下减轻误差，并且与近壁动量和能量平衡相一致。**\n-   混合或“全$y^+$”壁面处理方法使用一个能从粘性子层剖面平滑过渡到对数层剖面的函数。对于动量，当第一个网格点 $y_p^+$ 很小（如 $y_p^+ \\approx 2$）时，它将正确地恢复 $u^+ = y^+$。\n-   类似地，混合热壁面函数将对小的 $y^+$ 恢复传导子层剖面 $T^+ = Pr \\cdot y^+$。\n-   这种方法通过根据局部的 $y_p^+$ 值应用物理上正确的定律，直接“减轻了误差”。它被设计为“无需更改网格”即可工作，正是因为它对第一个网格点的放置具有鲁棒性。\n-   通过使用从近壁动量和能量平衡推导出的正确渐近极限，该方法在物理上是一致的。\n-   该陈述完全正确。\n\n**D. 通过提高壁面处的湍动能来增加近壁涡粘度 $\\nu_t$，会迫使模型回到对数区，并且即使在 $y_p^+  5$ 的情况下也是一种合适的修正方法。**\n-   这个陈述提出了一种非物理的“修正”。粘性子层（$y^+  5$）的物理特征是湍流被抑制，分子粘度占主导地位，意味着 $\\nu_t \\ll \\nu$。\n-   在该区域人为增加 $\\nu_t$ 以迫使流动匹配对数律剖面，是与底层物理原理直接矛盾的。这构成了为达到期望的数值行为而对模型进行的操纵，而不是对现实的表征。\n-   这样的程序不是一个合理或“合适的修正”。它会破坏湍流量和其他相关现象的预测。正确的方法是使用一个尊重物理规律的模型，而不是修改物理规律以适应不匹配的模型。\n-   该陈述不正确。\n\n根据分析，陈述 A 和 C 是正确的。",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}