{
    "hands_on_practices": [
        {
            "introduction": "涡粘性系数 $\\nu_t$ 的概念是许多湍流模型的基石，它将雷诺应力与平均速度梯度联系起来。第一个练习提供了一个基础推导，展示了普朗特的混合长度假设如何直接导出一个简单的、代数的 $\\nu_t$ 表达式，适用于壁面束缚流动的对数律区域。完成这个练习  将阐明假定的混合长度 $l_m$ 与最终的湍动量输运之间的直接关系。",
            "id": "3992485",
            "problem": "考虑一个处于对数律层的统计定常、充分发展的高雷诺数湍流壁面流动，其中平均流向速度仅是壁面法向坐标 $y$ 的函数。令摩擦速度为 $u_{\\tau}$，流体密度为 $\\rho$，von Kármán 常数为 $\\kappa$。在对数律层中，测得的平均剪切为 $\\partial U/\\partial y = u_{\\tau}/(\\kappa y)$，混合长度模化为 $l_{m} = \\kappa y$。\n\n从关联雷诺剪切应力与平均剪切的 Boussinesq 涡粘性假设，以及根据湍流速度脉动和平均剪切定义的 Prandtl 混合长度出发，推导湍流运动粘度 $\\nu_{t}(y)$ 作为 $y$、$\\kappa$ 和 $u_{\\tau}$ 函数的封闭形式符号表达式。然后，根据你的表达式验证在对数律层内 $\\nu_{t}(y)$ 是否是 $y$ 的线性函数。\n\n请以 $\\nu_{t}(y)$ 的单一封闭形式符号表达式的形式提供最终结果。不要进行数值计算，也无需在最终答案中包含单位。",
            "solution": "该问题要求在湍流壁面流动的对数律层内推导湍流运动粘度 $\\nu_{t}(y)$ 的表达式。推导必须从湍流模型的基本原理出发，即 Boussinesq 涡粘性假设和 Prandtl 混合长度模型，并使用为该流动区域提供的平均剪切和混合长度的特定形式。\n\n首先，我们陈述 Boussinesq 涡粘性假设。该假设在分子动量输运和湍流动量输运之间提供了一个类比，定义了湍流（或涡）粘度 $\\nu_{t}$。雷诺剪切应力 $\\tau_{t} = -\\rho \\overline{u'v'}$，其中 $\\overline{u'v'}$ 是流向和壁面法向速度脉动乘积的时间平均值，被模化为与平均应变率成正比。对于平均速度为 $U(y)$ 的简单剪切流，这表示为：\n$$ \\tau_{t} = \\rho \\nu_{t} \\frac{\\partial U}{\\partial y} $$\n量 $\\nu_{t}$ 是湍流运动粘度。通过除以流体密度 $\\rho$，我们可以将运动雷诺剪切应力表示为：\n$$ -\\overline{u'v'} = \\nu_{t} \\frac{\\partial U}{\\partial y} $$\n\n接下来，我们引入 Prandtl 混合长度模型。该模型通过将雷诺剪切应力与平均速度梯度和湍流的特征长度尺度（混合长度 $l_m$）相关联，为雷诺剪切应力提供了一个封闭。该模型假定运动雷诺剪切应力可以表示为：\n$$ -\\overline{u'v'} = l_{m}^2 \\left| \\frac{\\partial U}{\\partial y} \\right| \\frac{\\partial U}{\\partial y} $$\n对于壁面边界层的特定情况，平均速度梯度 $\\frac{\\partial U}{\\partial y}$ 为正，因此表达式简化为：\n$$ -\\overline{u'v'} = l_{m}^2 \\left( \\frac{\\partial U}{\\partial y} \\right)^2 $$\n\n现在，我们可以通过令运动雷诺剪切应力 $-\\overline{u'v'}$ 的两个模型相等来推导 $\\nu_{t}$ 的表达式。\n$$ \\nu_{t} \\frac{\\partial U}{\\partial y} = l_{m}^2 \\left( \\frac{\\partial U}{\\partial y} \\right)^2 $$\n在对数律层中，平均剪切 $\\frac{\\partial U}{\\partial y}$ 非零，这允许我们用该项除以等式两边。这得出了一个基于混合长度模型的湍流运动粘度的直接表达式：\n$$ \\nu_{t} = l_{m}^2 \\frac{\\partial U}{\\partial y} $$\n\n问题中提供了在高雷诺数湍流壁面流动的对数律层中有效的混合长度和平均剪切的具体形式。它们是：\n1.  混合长度模型：$l_{m} = \\kappa y$，其中 $\\kappa$ 是 von Kármán 常数，而 $y$ 是壁面法向坐标。\n2.  平均剪切剖面：$\\frac{\\partial U}{\\partial y} = \\frac{u_{\\tau}}{\\kappa y}$，其中 $u_{\\tau}$ 是摩擦速度。\n\n我们将这两个表达式代入我们推导出的 $\\nu_{t}$ 方程中：\n$$ \\nu_{t}(y) = (\\kappa y)^2 \\left( \\frac{u_{\\tau}}{\\kappa y} \\right) $$\n展开平方项得到：\n$$ \\nu_{t}(y) = (\\kappa^2 y^2) \\left( \\frac{u_{\\tau}}{\\kappa y} \\right) $$\n现在我们可以通过消去公因子来简化这个表达式。分子中的一个因子 $\\kappa$ 与分母中的 $\\kappa$ 相消。分子中的一个因子 $y$ 与分母中的 $y$ 相消。\n$$ \\nu_{t}(y) = \\kappa y u_{\\tau} $$\n为了符合常规顺序重新排列，我们得到了对数律层中湍流运动粘度的最终封闭形式符号表达式：\n$$ \\nu_{t}(y) = \\kappa u_{\\tau} y $$\n\n任务的第二部分是验证 $\\nu_{t}(y)$ 是否是 $y$ 的线性函数。如果一个函数 $f(x)$ 可以写成 $f(x) = C x$ 的形式，其中 $C$ 是一个常数，那么它就是 $x$ 的线性函数。在我们推导的表达式 $\\nu_{t}(y) = (\\kappa u_{\\tau}) y$ 中，von Kármán 常数 $\\kappa$ 是一个普适的无量纲常数（约等于 $0.41$），而对于给定的充分发展的流动条件，摩擦速度 $u_{\\tau}$ 是一个常数。因此，乘积 $\\kappa u_{\\tau}$ 是一个常数。$\\nu_{t}(y)$ 的表达式形式为 $C y$，其中比例常数为 $C = \\kappa u_{\\tau}$。因此，在对数律层内，湍流运动粘度 $\\nu_{t}(y)$ 确实是壁面法向坐标 $y$ 的线性函数。",
            "answer": "$$\\boxed{\\kappa u_{\\tau} y}$$"
        },
        {
            "introduction": "从理论走向计算实践是每一位工程师的关键一步。在计算流体动力学（CFD）中，完全解析到壁面的湍流边界层计算成本极高，因此我们使用基于对数律等理论的“壁面函数”。这个动手练习  将指导你实现一个数值算法，根据近壁点的已知速度迭代计算壁面剪切应力，这是几乎所有工业RANS求解器中使用的核心技术。",
            "id": "3992497",
            "problem": "您正在一个计算流体力学（CFD）求解器中，为湍流壁面束流实施一种近壁处理方法，该方法使用混合长度模型。从以下基本原理出发：\n\n- 在平衡湍流边界层中，当流向压力梯度可忽略不计时，近壁区的雷诺平均纳维-斯托克斯（RANS）流向平均动量平衡方程，表示为粘性剪切应力和湍流剪切应力的平衡：$$\\tau_{\\text{tot}}(y) = \\mu \\,\\frac{dU}{dy} - \\rho \\,\\overline{u'v'} \\approx \\tau_w,$$ 其中 $\\tau_w$ 是壁面剪切应力，$\\mu$ 是动力粘度，$\\rho$ 是密度，$U$ 是平均流向速度，而 $\\overline{u'v'}$ 是雷诺剪切应力。\n- Ludwig Prandtl 的混合长度模型，其混合长度为 $\\ell_m = \\kappa \\, y$，其中 $\\kappa$ 是 von Kármán 常数，而 $y$ 是法向壁面坐标。\n- Boussinesq 假设，用涡粘度 $\\nu_t = \\ell_m^2 \\,\\left|\\frac{dU}{dy}\\right|$ 来近似雷诺剪切应力，使得 $-\\rho \\,\\overline{u'v'} = \\rho \\,\\nu_t \\,\\frac{dU}{dy}$。\n- 在离壁面足够远（完全湍流）的对数区，粘性剪切与湍流剪切相比可以忽略不计，因此 $\\tau_w \\approx \\rho \\,\\ell_m^2 \\left(\\frac{dU}{dy}\\right)^2$。\n\n仅以上述内容为基本原理，并结合完全湍流对数律适用于光滑壁面，且具有一个附加常数 $B$ 和 von Kármán 常数 $\\kappa$ 这一经验事实，执行以下任务：\n\n- 从混合长度模型推导出壁面单位下的对数平均速度剖面，其形式为 $$U^+ = \\frac{1}{\\kappa}\\,\\ln y^+ + B,$$ 其中 $U^+ = \\frac{U}{u_\\tau}$，$y^+ = \\frac{\\rho \\,u_\\tau \\,y}{\\mu}$，而 $u_\\tau = \\sqrt{\\tau_w/\\rho}$ 是摩擦速度。\n- 设第一个离壁控制体的中心距离壁面为已知距离 $y_p$，并具有一个平行于壁面的已知平均速度 $U_p$。使用经验性的壁面-对数律，写出由 $U_p$ 和 $y_p$ 确定 $u_\\tau$ 的隐式方程。\n- 通过分析一个适当残差的单调性，证明 $u_\\tau$ 的方程存在唯一的正解。\n- 设计一种稳健的迭代数值方法，用于在给定 $\\rho$、$\\mu$、$U_p$、$y_p$、$\\kappa$ 和 $B$ 的情况下计算 $u_\\tau$。该方法的停止容差为：残差绝对值小于 $\\varepsilon = 10^{-12}$，或 $u_\\tau$ 的相对变化量小于 $\\delta = 10^{-12}$；最大迭代次数为 $N_{\\max} = 200$。如果使用区间法，请确保初始区间能自动扩展，直到找到符号变化或达到安全的上限。\n- 根据收敛的 $u_\\tau$，计算壁面剪切应力 $\\tau_w = \\rho \\,u_\\tau^2$。\n\n在一个完整的、可运行的程序中实现您的推导和数值方法，用以计算以下测试套件的 $u_\\tau$ 和 $\\tau_w$。在每个测试案例中，所有量都应被视为常数，所选参数对于使用壁面函数的光滑壁面、高雷诺数、近壁单元格而言是科学合理的。使用国际单位制（SI单位）的基本单位。对于每个案例，将 $u_\\tau$ 以 $\\mathrm{m/s}$ 表示，$\\tau_w$ 以 $\\mathrm{Pa}$ 表示，并将每个值精确到小数点后 $6$ 位。\n\n测试套件 (每个案例为 $(\\rho,\\mu,U_p,y_p,\\kappa,B)$):\n- 案例 A (标准状况下的空气): $(\\rho,\\mu,U_p,y_p,\\kappa,B) = (\\,1.225,\\,1.7894\\times 10^{-5},\\,10.0,\\,1.0\\times 10^{-3},\\,0.41,\\,5.2\\,)$.\n- 案例 B (空气，更高速度，更细的第一层网格): $(\\rho,\\mu,U_p,y_p,\\kappa,B) = (\\,1.225,\\,1.7894\\times 10^{-5},\\,40.0,\\,5.0\\times 10^{-4},\\,0.41,\\,5.2\\,)$.\n- 案例 C (室温下的水): $(\\rho,\\mu,U_p,y_p,\\kappa,B) = (\\,998.2,\\,1.003\\times 10^{-3},\\,1.0,\\,1.0\\times 10^{-3},\\,0.41,\\,5.2\\,)$.\n- 案例 D (空气，中等速度，不同的光滑壁面常数): $(\\rho,\\mu,U_p,y_p,\\kappa,B) = (\\,1.2,\\,1.85\\times 10^{-5},\\,5.0,\\,7.5\\times 10^{-4},\\,0.41,\\,5.0\\,)$.\n- 案例 E (空气，较小的 $y_p$，略有不同的 $B$): $(\\rho,\\mu,U_p,y_p,\\kappa,B) = (\\,1.225,\\,1.7894\\times 10^{-5},\\,15.0,\\,2.0\\times 10^{-4},\\,0.41,\\,5.5\\,)$.\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果。每个内部列表对应一个测试案例，并按顺序 $[u_\\tau,\\tau_w]$ 包含两个四舍五入后的浮点数结果。确切的输出格式为\n\n\"[[u_tau_A,tau_w_A],[u_tau_B,tau_w_B],[u_tau_C,tau_w_C],[u_tau_D,tau_w_D],[u_tau_E,tau_w_E]]\"\n\n不添加任何空格。确保打印的数字按要求精确到小数点后 $6$ 位。",
            "solution": "任务是基于壁面-对数律推导并实现一种计算摩擦速度 $u_\\tau$ 和壁面剪切应力 $\\tau_w$ 的数值方法，而该对数律本身需从 Prandtl 的混合长度模型推导得出。该方法将应用于一组具有指定物理参数的测试案例。\n\n**1. 对数速度剖面的推导**\n\n问题始于一个充分发展的、压力梯度可忽略的湍流边界层的雷诺平均纳维-斯托克斯（RANS）动量方程，其中总剪切应力 $\\tau_{\\text{tot}}$ 近似为常数且等于壁面剪切应力 $\\tau_w$：\n$$ \\tau_w \\approx \\mu \\frac{dU}{dy} - \\rho \\overline{u'v'} $$\n使用 Boussinesq 假设，雷诺剪切应力项 $-\\rho \\overline{u'v'}$ 被建模为 $\\rho \\nu_t \\frac{dU}{dy}$，其中 $\\nu_t$ 是涡粘度。混合长度模型为 $\\nu_t$ 提供了表达式：\n$$ \\nu_t = \\ell_m^2 \\left|\\frac{dU}{dy}\\right| $$\n其中混合长度为 $\\ell_m = \\kappa y$。这里，$\\kappa$ 是 von Kármán 常数，$y$ 是距壁面的距离。我们假设 $\\frac{dU}{dy} > 0$。\n总剪切应力平衡变为：\n$$ \\tau_w \\approx \\mu \\frac{dU}{dy} + \\rho (\\kappa y)^2 \\left(\\frac{dU}{dy}\\right)^2 $$\n在对数区，该区域离壁面足够远，使得粘性效应可以忽略不计，但又足够近，使得常数应力假设仍然成立。在此区域，粘性剪切项 $\\mu \\frac{dU}{dy}$ 被认为远小于湍流剪切项。平衡方程简化为：\n$$ \\tau_w \\approx \\rho (\\kappa y)^2 \\left(\\frac{dU}{dy}\\right)^2 $$\n我们可以重排此方程以求解平均速度梯度 $\\frac{dU}{dy}$：\n$$ \\left(\\frac{dU}{dy}\\right)^2 = \\frac{\\tau_w}{\\rho (\\kappa y)^2} \\implies \\frac{dU}{dy} = \\frac{\\sqrt{\\tau_w/\\rho}}{\\kappa y} $$\n引入摩擦速度 $u_\\tau = \\sqrt{\\tau_w/\\rho}$，方程变为：\n$$ \\frac{dU}{dy} = \\frac{u_\\tau}{\\kappa y} $$\n为求得速度剖面 $U(y)$，我们对此常微分方程对 $y$ 进行积分：\n$$ \\int dU = \\int \\frac{u_\\tau}{\\kappa y} dy \\implies U(y) = \\frac{u_\\tau}{\\kappa} \\ln(y) + C $$\n其中 $C$ 是积分常数。为了得到标准的无量纲形式，我们引入壁面单位：\n-   无量纲速度：$U^+ = \\frac{U}{u_\\tau}$\n-   无量纲壁面距离：$y^+ = \\frac{\\rho u_\\tau y}{\\mu}$\n\n根据 $y^+$ 的定义，我们可以将 $y$ 表示为 $y = \\frac{y^+ \\mu}{\\rho u_\\tau}$。将其代入积分得到的速度剖面中：\n$$ U(y) = \\frac{u_\\tau}{\\kappa} \\ln\\left(\\frac{y^+ \\mu}{\\rho u_\\tau}\\right) + C = \\frac{u_\\tau}{\\kappa} \\left[ \\ln(y^+) + \\ln\\left(\\frac{\\mu}{\\rho u_\\tau}\\right) \\right] + C $$\n两边同除以 $u_\\tau$ 以得到 $U^+$：\n$$ U^+ = \\frac{U(y)}{u_\\tau} = \\frac{1}{\\kappa} \\ln(y^+) + \\left[ \\frac{1}{\\kappa} \\ln\\left(\\frac{\\mu}{\\rho u_\\tau}\\right) + \\frac{C}{u_\\tau} \\right] $$\n方括号中的项结合了积分常数和流动参数。问题中指出，一个经验事实是对数律适用于光滑壁面，并带有一个附加常数 $B$。因此，我们将括号中的项等同于这个经验常数：\n$$ B = \\frac{1}{\\kappa} \\ln\\left(\\frac{\\mu}{\\rho u_\\tau}\\right) + \\frac{C}{u_\\tau} $$\n这就得到了我们所期望的壁面-对数律：\n$$ U^+ = \\frac{1}{\\kappa} \\ln(y^+) + B $$\n\n**2. 摩擦速度的隐式方程**\n\n给定壁面外指定距离 $y_p$ 处的已知平均速度 $U_p$，只要点 $(y_p, U_p)$ 位于对数区内，这些值就必须满足对数律方程。我们将 $U=U_p$ 和 $y=y_p$ 代入该定律：\n$$ \\frac{U_p}{u_\\tau} = \\frac{1}{\\kappa} \\ln\\left(\\frac{\\rho u_\\tau y_p}{\\mu}\\right) + B $$\n这是一个关于未知摩擦速度 $u_\\tau$ 的超越隐式方程。\n\n**3. 唯一正解的证明**\n\n为证明 $u_\\tau$ 存在唯一的正解，我们定义一个残差函数 $f(u_\\tau)$，其根对应于方程的解：\n$$ f(u_\\tau) = \\frac{U_p}{u_\\tau} - \\frac{1}{\\kappa} \\ln\\left(\\frac{\\rho u_\\tau y_p}{\\mu}\\right) - B $$\n我们寻找 $u_\\tau > 0$ 使得 $f(u_\\tau) = 0$。解的唯一性可以通过分析 $f(u_\\tau)$ 的单调性来确定。我们计算它关于 $u_\\tau$ 的一阶导数：\n$$ f'(u_\\tau) = \\frac{d}{du_\\tau} \\left( U_p u_\\tau^{-1} - \\frac{1}{\\kappa} \\left[\\ln(u_\\tau) + \\ln\\left(\\frac{\\rho y_p}{\\mu}\\right)\\right] - B \\right) $$\n$$ f'(u_\\tau) = -U_p u_\\tau^{-2} - \\frac{1}{\\kappa u_\\tau} = -\\left(\\frac{U_p}{u_\\tau^2} + \\frac{1}{\\kappa u_\\tau}\\right) $$\n对于任何有物理意义的情况，$U_p > 0$，$\\kappa > 0$，并且我们正在寻找一个解，其中 $u_\\tau > 0$。在这些条件下，括号内的两项都是正的，这意味着对于所有 $u_\\tau \\in (0, \\infty)$，$f'(u_\\tau)  0$。因此，$f(u_\\tau)$ 在正 $u_\\tau$ 的定义域上是一个严格单调递减的函数。\n\n接下来，我们考察 $f(u_\\tau)$ 在该定义域边界处的极限：\n-   当 $u_\\tau \\to 0^+$ 时，项 $\\frac{U_p}{u_\\tau} \\to +\\infty$，而项 $-\\frac{1}{\\kappa}\\ln(u_\\tau) \\to +\\infty$。因此，$\\lim_{u_\\tau \\to 0^+} f(u_\\tau) = +\\infty$。\n-   当 $u_\\tau \\to +\\infty$ 时，项 $\\frac{U_p}{u_\\tau} \\to 0$，而项 $-\\frac{1}{\\kappa}\\ln(u_\\tau) \\to -\\infty$。因此，$\\lim_{u_\\tau \\to \\infty} f(u_\\tau) = -\\infty$。\n\n由于 $f(u_\\tau)$ 是在 $(0, \\infty)$ 上的一个连续函数，它从 $+\\infty$ 严格单调递减到 $-\\infty$，根据介值定理，它必须且仅有一次穿过轴线 $f(u_\\tau)=0$。这证明了 $u_\\tau$ 存在唯一的正解。\n\n**4. 数值求解方法**\n\n为了求解隐式方程 $f(u_\\tau) = 0$，我们采用牛顿法，该方法以其在初始猜测足够接近根时的快速（二次）收敛性而著称。迭代公式为：\n$$ u_{\\tau, n+1} = u_{\\tau, n} - \\frac{f(u_{\\tau, n})}{f'(u_{\\tau, n})} $$\n代入 $f(u_\\tau)$ 和 $f'(u_\\tau)$ 的表达式：\n$$ u_{\\tau, n+1} = u_{\\tau, n} - \\frac{\\frac{U_p}{u_{\\tau, n}} - \\frac{1}{\\kappa} \\ln\\left(\\frac{\\rho u_{\\tau, n} y_p}{\\mu}\\right) - B}{-\\left(\\frac{U_p}{u_{\\tau, n}^2} + \\frac{1}{\\kappa u_{\\tau, n}}\\right)} $$\n对于这个问题，该方法特别“稳健”。其二阶导数 $f''(u_\\tau) = 2U_p u_\\tau^{-3} + \\frac{1}{\\kappa} u_\\tau^{-2}$ 对于 $u_\\tau > 0$ 总是正的。这意味着函数 $f(u_\\tau)$ 是严格凸的。此性质确保了对于任何正的初始猜测 $u_{\\tau,0}$，牛顿法的迭代序列将单调收敛到唯一的正根，而不会发散或振荡，使其成为一个高度可靠的选择。\n\n实现细节如下：\n-   **初始猜测：** 一个合理的初始猜测可以从经验性的壁面摩擦关联式中得出。我们使用 $u_{\\tau,0} = 0.05\\,U_p$，这是一个常用的启发式方法。\n-   **收敛判据：** 当满足以下任一条件时，迭代停止：\n    1.  残差的绝对值小于容差 $\\varepsilon = 10^{-12}$：$|f(u_{\\tau, n+1})|  10^{-12}$。\n    2.  解的相对变化量小于容差 $\\delta = 10^{-12}$：$|u_{\\tau, n+1} - u_{\\tau, n}| / |u_{\\tau, n+1}|  10^{-12}$。\n-   **终止条件：** 设置了最大 $N_{\\max} = 200$ 次迭代作为防止意外行为的保障，尽管通常在很少的步数内（少于10步）即可实现收敛。\n\n**5. 壁面剪切应力的计算**\n\n一旦迭代过程收敛到摩擦速度 $u_\\tau$ 的最终值，相应的壁面剪切应力 $\\tau_w$ 就直接根据其定义进行计算：\n$$ \\tau_w = \\rho u_\\tau^2 $$\n对问题陈述中提供的每个测试案例，计算出 $u_\\tau$ 和 $\\tau_w$ 的最终值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for friction velocity and wall shear stress for a suite of test cases.\n    \"\"\"\n    \n    # Test suite: (rho, mu, U_p, y_p, kappa, B)\n    test_cases = [\n        # Case A (air at standard conditions)\n        (1.225, 1.7894e-5, 10.0, 1.0e-3, 0.41, 5.2),\n        # Case B (air, higher speed, finer first cell)\n        (1.225, 1.7894e-5, 40.0, 5.0e-4, 0.41, 5.2),\n        # Case C (water at room temperature)\n        (998.2, 1.003e-3, 1.0, 1.0e-3, 0.41, 5.2),\n        # Case D (air, moderate speed, alternative smooth-wall constant)\n        (1.2, 1.85e-5, 5.0, 7.5e-4, 0.41, 5.0),\n        # Case E (air, small y_p, slightly different B)\n        (1.225, 1.7894e-5, 15.0, 2.0e-4, 0.41, 5.5),\n    ]\n\n    results_as_strings = []\n    \n    for case in test_cases:\n        u_tau, tau_w = calculate_wall_quantities(*case)\n        # Format the results to exactly 6 decimal places and create the string for the inner list.\n        results_as_strings.append(f\"[{u_tau:.6f},{tau_w:.6f}]\")\n\n    # Combine the formatted strings into the final output format.\n    final_output = f\"[{','.join(results_as_strings)}]\"\n    print(final_output)\n\ndef calculate_wall_quantities(rho, mu, u_p, y_p, kappa, b):\n    \"\"\"\n    Calculates friction velocity (u_tau) and wall shear stress (tau_w) using Newton's method.\n\n    Args:\n        rho (float): Density (kg/m^3)\n        mu (float): Dynamic viscosity (Pa*s)\n        u_p (float): Mean velocity at point P (m/s)\n        y_p (float): Distance of point P from the wall (m)\n        kappa (float): Von Kármán constant\n        b (float): Log-law additive constant\n\n    Returns:\n        tuple[float, float]: A tuple containing the converged u_tau and the calculated tau_w.\n    \"\"\"\n    # Tolerances and iteration limits\n    eps = 1.0e-12\n    delta = 1.0e-12\n    n_max = 200\n\n    # Initial guess for u_tau using a common fluid dynamics heuristic\n    u_tau = 0.05 * u_p\n\n    # Pre-calculate constant term for efficiency\n    log_arg_const = rho * y_p / mu\n    \n    for _ in range(n_max):\n        # Ensure u_tau remains positive; if not, the guess is pathological (unlikely here)\n        if u_tau = 0:\n            raise ValueError(\"u_tau became non-positive during iteration.\")\n\n        # Evaluate the residual function f(u_tau)\n        # f(u_tau) = Up/u_tau - (1/kappa) * ln(rho*u_tau*y_p/mu) - B\n        # The natural logarithm np.log is used.\n        f_val = u_p / u_tau - (1.0 / kappa) * np.log(log_arg_const * u_tau) - b\n\n        # Check for convergence based on residual magnitude\n        if abs(f_val)  eps:\n            break\n\n        # Evaluate the derivative of the residual function f'(u_tau)\n        # f'(u_tau) = -Up/u_tau^2 - 1/(kappa*u_tau)\n        f_prime_val = -u_p / (u_tau**2) - 1.0 / (kappa * u_tau)\n\n        # Newton's method update step\n        u_tau_new = u_tau - f_val / f_prime_val\n        \n        # Check for convergence based on relative change in u_tau\n        if abs(u_tau_new - u_tau) / abs(u_tau_new)  delta:\n            u_tau = u_tau_new\n            break\n\n        u_tau = u_tau_new\n    else:\n        # This block executes if the loop completes without `break`, indicating failure to converge.\n        raise RuntimeError(f\"Newton's method failed to converge within {n_max} iterations.\")\n\n    # Calculate wall shear stress from the converged friction velocity\n    tau_w = rho * u_tau**2\n\n    return u_tau, tau_w\n\nsolve()\n```"
        },
        {
            "introduction": "没有模型是完美的，理解其局限性与了解其推导过程同等重要。基本的混合长度模型假设了一种简单的平衡状态，这种平衡在存在压力梯度的流动中会被打破，而这在许多工程应用中很常见。这个练习  深入探讨了模型在逆压梯度下失效的物理原因，并要求你选择一个物理上合理的修正方法，展示了在复杂场景中调整和优化模型的关键工程技能。",
            "id": "3992518",
            "problem": "一个受到缓慢变化的流向压力梯度作用的不可压缩二维湍流边界层，使用雷诺平均纳维-斯托克斯 (RANS) 方程和 Boussinesq 假设进行建模。在零流向压力梯度的近壁区，经典的 Prandtl 混合长度模型将混合长度取为 $l_m=\\kappa y$，其中 $\\kappa$ 是 von Kármán 常数，$y$ 是垂直于壁面的距离。该模型在所谓的对数律层中恢复了湍动能生成与耗散之间的近似平衡。考虑一个逆压梯度，在流向方向上定义为 $dP/dx0$。它会使流动减速，并改变边界层的结构。\n\n从 RANS 动量方程和湍动能输运方程出发，使用广为接受的建模假设，从第一性原理角度解释为什么在逆压梯度下，生成与耗散之间的局部平衡被破坏，并且选择 $l_m=\\kappa y$ 会倾向于高估边界层外区的涡粘性系数 $\\mu_t$。然后，通过对流向动量平衡进行量纲分析，引入一个由压力梯度控制的长度尺度 $l_p$，并构建一个修正后的混合长度 $l_m'$，该长度必须满足以下物理和数学约束：\n\n- 当 $|dP/dx|\\to 0$ 时，$l_m'\\to \\kappa y$。\n- 当 $\\tau_w$ 和 $y$ 固定时，若 $|dP/dx|\\to \\infty$，则 $l_m'\\to 0$。\n- 当 $y\\to 0$ 时，根据内层标度律，$l_m'\\sim \\kappa y$。\n- 修正后的 $l_m'$ 必须量纲一致，并且在固定的 $y$ 和壁面剪切应力 $\\tau_w$ 下，随着逆压梯度大小的增加而单调递减。\n\n假设壁面剪切应力 $\\tau_w$ 决定了摩擦速度 $u_\\tau=\\sqrt{\\tau_w/\\rho}$，其中 $\\rho$ 是密度，并定义压力梯度长度尺度为 $l_p=\\tau_w/|dP/dx|$。根据您的推导，从以下选项中选择最合适的修正混合长度表达式。\n\nA. $l_m'=\\dfrac{\\kappa y}{\\,1+\\dfrac{\\kappa y}{l_p}\\,}$，其中 $l_p=\\dfrac{\\tau_w}{|dP/dx|}$\n\nB. $l_m'=\\kappa y\\left(1+\\beta\\right)$，其中 $\\beta=\\dfrac{\\delta^*}{\\tau_w}\\dfrac{dP}{dx}$\n\nC. $l_m'=\\kappa y\\,\\exp\\!\\left(\\beta\\right)$，其中 $\\beta=\\dfrac{\\delta^*}{\\tau_w}\\dfrac{dP}{dx}$\n\nD. $l_m'=\\kappa y+l_p$，其中 $l_p=\\dfrac{\\tau_w}{|dP/dx|}$\n\n此处，$\\delta^*$ 是位移厚度，$\\beta$ 是 Clauser 压力梯度参数，$dP/dx0$ 代表逆压梯度。与给定 $l_m'$ 相关的涡粘性系数为 $\\mu_t=\\rho\\,l_m'^2\\,\\left|\\dfrac{dU}{dy}\\right|$，其中 $U$ 是平均流向速度。",
            "solution": "问题陈述经过严格验证，确认有效。它在科学上基于湍流边界层理论和湍流建模的原理，问题提出得当且客观。所有必要的定义和约束均已提供，可以从给定选项中确定唯一解。\n\n任务首先是解释逆压梯度 (APG) 改变湍流边界层结构的物理机制，该机制导致经典混合长度模型高估涡粘性系数；然后是选择一个满足一系列指定约束的修正混合长度公式。\n\n**第一部分：物理机理阐释**\n\n我们从二维、不可压缩、定常湍流边界层的雷诺平均纳维-斯托克斯 (RANS) 动量方程开始：\n$$\n\\rho \\left( U \\frac{\\partial U}{\\partial x} + V \\frac{\\partial U}{\\partial y} \\right) = -\\frac{dP}{dx} + \\frac{\\partial}{\\partial y} \\left( \\mu \\frac{\\partial U}{\\partial y} - \\rho \\overline{u'v'} \\right)\n$$\n此处，$U$ 和 $V$ 分别是流向 ($x$) 和法向 ($y$) 的平均速度分量，$P$ 是平均压力，$\\rho$ 是密度，$\\mu$ 是动力粘度，$-\\rho \\overline{u'v'}$ 是雷诺剪切应力，我们记为 $\\tau_t$。总剪切应力为 $\\tau = \\mu \\frac{\\partial U}{\\partial y} + \\tau_t$。在近壁区，但在粘性底层之外，左侧的对流项与压力梯度和剪切应力梯度相比通常很小。这导出了如下近似：\n$$\n\\frac{\\partial \\tau}{\\partial y} \\approx \\frac{dP}{dx}\n$$\n从壁面 ($y=0$) 积分到距离 $y$ 处，其中 $\\tau(0) = \\tau_w$ (壁面剪切应力)，得到：\n$$\n\\tau(y) - \\tau_w \\approx y \\frac{dP}{dx} \\quad \\implies \\quad \\tau(y) \\approx \\tau_w + y \\frac{dP}{dx}\n$$\n对于零压力梯度 (ZPG)，$dP/dx=0$，在整个内层中，剪切应力 $\\tau$ 近似为常数且等于 $\\tau_w$。对于逆压梯度 (APG)，$dP/dx > 0$，总剪切应力 $\\tau(y)$ 随离壁距离的增加而增加。\n\n湍流的结构由湍动能 ($k$) 输运方程描述。在其简化形式中，该方程指出，跟随流体质点的 $k$ 的变化率是由生成项 ($P_k$)、耗散项 ($\\epsilon$) 和输运过程（例如，平流、湍流扩散、压力扩散）引起的。\n$$\n\\text{Advection of } k = P_k - \\epsilon + \\text{Transport of } k\n$$\n生成项由 $P_k = -\\overline{u'v'} \\frac{dU}{dy} = \\frac{\\tau_t}{\\rho} \\frac{dU}{dy}$ 给出。在零压力梯度边界层的对数律层中，假定存在“局部平衡”状态，即平流项和输运项可忽略不计，从而导致生成与耗散之间的局部平衡：$P_k \\approx \\epsilon$。\n\n经典的 Prandtl 混合长度模型 $l_m = \\kappa y$ 与这种局部平衡假设有着内在的联系。该模型导出的涡粘性系数为 $\\mu_t = \\rho l_m^2 \\left|\\frac{dU}{dy}\\right| = \\rho (\\kappa y)^2 \\left|\\frac{dU}{dy}\\right|$。该模型意味着湍流长度尺度随离壁距离线性增长，不受其他效应的阻碍。\n\n在逆压梯度作用下，流动减速。这种减速有两个关键效应会破坏局部平衡：\n1.  与零压力梯度流动相比，平均速度梯度 $\\frac{dU}{dy}$ 减小，尤其是在边界层的外区。这直接减少了湍动能的局域生成量 $P_k$。\n2.  输运项，尤其是平流项，变得显著。湍流场，特别是外层的大尺度含能涡，不会瞬时响应剪切的局部变化。这些涡携带着上游的“历史”信息，而上游的生成可能更高。这导致了这样一种状态：局部的湍动能水平 $k$ 高于局部生成项 $P_k$ 所能维持的水平。因此，耗散 $\\epsilon$（其大小与 $k$ 成比例）超过了生成，即 $P_k  \\epsilon$。\n\n混合长度 $l_m$ 是一个用于描述动量输运涡特征尺寸的模型。在逆压梯度中，外层的湍流涡由于流动减速以及生成与耗散之间的不平衡而受到抑制。它们输运动量的效率降低。因此，它们的特征长度尺度应小于简单的零压力梯度模型 $l_m = \\kappa y$ 所预测的值。使用 $l_m = \\kappa y$ 为被抑制的湍流指定了一个过大的长度尺度。由于涡粘性系数 $\\mu_t$ 与 $l_m^2$ 成正比，使用未经修正的（过大的）$l_m$ 会导致对 $\\mu_t$ 的高估。\n\n**第二部分：修正的混合长度模型**\n\n为了修正该模型，我们必须引入一个与压力梯度相关的长度尺度。问题将其定义为 $l_p = \\frac{\\tau_w}{|dP/dx|}$。该尺度代表了由压力梯度引起的应力 $y|dP/dx|$ 与壁面剪切应力 $\\tau_w$ 相当的法向距离。\n\n修正后的混合长度 $l_m'$ 必须是两个相互竞争的长度尺度的函数：由 $\\kappa y$ 代表的离壁距离尺度，和压力梯度尺度 $l_p$。有效的混合长度应受这两个尺度中较小者的限制。一种组合两个限制尺度 $l_1$ 和 $l_2$ 的标准方法是通过对其倒数进行调和相加，这确保了结果小于 $l_1$ 和 $l_2$ 两者：\n$$\n\\frac{1}{l_m'} = \\frac{1}{l_1} + \\frac{1}{l_2}\n$$\n将此方法应用于我们的尺度，我们设 $l_1 = \\kappa y$ 和 $l_2 = l_p$：\n$$\n\\frac{1}{l_m'} = \\frac{1}{\\kappa y} + \\frac{1}{l_p}\n$$\n求解 $l_m'$：\n$$\nl_m' = \\left( \\frac{1}{\\kappa y} + \\frac{1}{l_p} \\right)^{-1} = \\frac{(\\kappa y) l_p}{\\kappa y + l_p} = \\frac{\\kappa y}{1 + \\frac{\\kappa y}{l_p}}\n$$\n我们现在用这四个给定的约束来检验这个函数形式：\n1.  **当 $|dP/dx| \\to 0$ 时**：这意味着 $l_p = \\frac{\\tau_w}{|dP/dx|} \\to \\infty$。\n    $l_m' = \\frac{\\kappa y}{1 + \\frac{\\kappa y}{l_p}} \\to \\frac{\\kappa y}{1 + 0} = \\kappa y$。约束条件得到满足。\n2.  **当 $|dP/dx| \\to \\infty$ 时**：这意味着 $l_p \\to 0$。\n    $l_m' = \\frac{(\\kappa y) l_p}{\\kappa y + l_p} \\to \\frac{(\\kappa y) \\cdot 0}{\\kappa y + 0} = 0$。约束条件得到满足。\n3.  **当 $y \\to 0$ 时**：项 $\\frac{\\kappa y}{l_p} \\to 0$。\n    $l_m' = \\frac{\\kappa y}{1 + \\frac{\\kappa y}{l_p}} \\approx \\kappa y \\left(1 - \\frac{\\kappa y}{l_p}\\right) \\approx \\kappa y$。其主导阶行为为 $l_m' \\sim \\kappa y$。约束条件得到满足。\n4.  **量纲一致性与单调性**：\n    -   $\\kappa$ 是无量纲的，$y$ 的量纲是长度 $[L]$。$l_p = \\frac{\\tau_w}{|dP/dx|}$ 的量纲为 $\\frac{[M L T^{-2} / L^2]}{[M L^{-1} T^{-2} / L]} = \\frac{[M L^{-1} T^{-2}]}{[M L^{-2} T^{-2}]} = [L]$。$l_m'$ 的表达式量纲一致，结果为长度。\n    -   为了检查单调性，我们考察 $l_m'$ 对 $|dP/dx|$ 的导数。因为增加 $|dP/dx|$ 意味着减小 $l_p$，所以我们需要 $l_m'$ 是 $l_p$ 的增函数。令 $f(l_p) = \\frac{\\kappa y l_p}{\\kappa y + l_p}$。其导数为 $\\frac{\\partial f}{\\partial l_p} = \\frac{(\\kappa y)^2}{(\\kappa y + l_p)^2} > 0$。因此，$l_m'$ 随 $l_p$ 的增加而增加，随 $|dP/dx|$ 的增加而减小。约束条件得到满足。\n\n推导出的表达式成功地满足了所有物理和数学要求。\n\n**第三部分：选项评估**\n\n**A. $l_m'=\\dfrac{\\kappa y}{\\,1+\\dfrac{\\kappa y}{l_p}\\,}$，其中 $l_p=\\dfrac{\\tau_w}{|dP/dx|}$**\n该表达式与从第一性原理和量纲分析推导出的表达式相同。如上所示，它满足所有四个约束。此修正在存在逆压梯度时，正确地将混合长度从零压力梯度的值 $\\kappa y$ 减小。\n**结论：正确**\n\n**B. $l_m'=\\kappa y\\left(1+\\beta\\right)$，其中 $\\beta=\\dfrac{\\delta^*}{\\tau_w}\\dfrac{dP}{dx}$**\n对于逆压梯度，$dP/dx0$，因此 $\\beta0$。该模型预测 $l_m' > \\kappa y$。这在物理上是不正确的，因为它意味着混合作用的增强，这与逆压梯度已知的抑制效应相矛盾，而正是这种抑制效应促使我们进行修正。该模型不满足约束 2（当 $|dP/dx| \\to \\infty$ 时，$l_m' \\to \\infty$）和约束 4（单调性不正确）。\n**结论：不正确**\n\n**C. $l_m'=\\kappa y\\,\\exp\\!\\left(\\beta\\right)$，其中 $\\beta=\\dfrac{\\delta^*}{\\tau_w}\\dfrac{dP}{dx}$**\n与选项 B 类似，对于逆压梯度，$\\beta0$，因此 $\\exp(\\beta)1$。该模型同样错误地预测混合长度会增加 ($l_m' > \\kappa y$)。它不满足约束 2（当 $|dP/dx| \\to \\infty$ 时，$l_m' \\to \\infty$）和约束 4（单调性不正确）。一个物理上更合理的公式可能包含 $\\exp(-C\\beta)$ (其中 $C0$)，但提供的选项并非如此。\n**结论：不正确**\n\n**D. $l_m'=\\kappa y+l_p$，其中 $l_p=\\dfrac{\\tau_w}{|dP/dx|}$**\n这代表了长度尺度的简单相加，这在物理上不适合组合限制效应。它不满足约束 1：当 $|dP/dx| \\to 0$ 时，$l_p \\to \\infty$，因此 $l_m' \\to \\infty$，而它应为 $\\kappa y$。它也不满足约束 2：当 $|dP/dx| \\to \\infty$ 时，$l_p \\to 0$，因此 $l_m' \\to \\kappa y$，而它应为 $0$。它还不满足约束 3：当 $y \\to 0$ 时，$l_m' \\to l_p$，这是一个有限值，违反了混合长度在壁面处必须为零的必要条件。\n**结论：不正确**\n\n基于详细分析，只有选项 A 为逆压梯度下的混合长度模型提供了物理和数学上都合理的修正。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}