{
    "hands_on_practices": [
        {
            "introduction": "代数模型的核心在于通过平均流场信息直接构造涡粘性系数 $\\nu_t$。本练习将指导你运用混合长理论和量纲分析，从给定的特征速度和剪切率尺度出发，推导出外层涡粘性系数的表达式。这个过程能让你深入理解零方程模型是如何基于物理直觉和量纲一致性建立起来的。",
            "id": "3936278",
            "problem": "一个在零压力梯度下、光滑等温平板上的稳态、不可压缩、二维湍流边界层，使用代数零方程湍流封闭模型进行建模。湍流脉动量通量通过 Boussinesq 假设来表示，该假设用涡粘性和平均应变率张量来封闭雷诺应力。在薄剪切层中，假设外层的代表性剪切率尺度是平均涡量的大小，记为 $\\Omega$，并且涡粘性可以通过一个由特征混合长度和代表性剪切率尺度构建的混合长度关系来建模。\n\n假设外层混合长度由下式给出\n$$\nl_{BL} \\;=\\; C_{cp}\\,\\frac{F_{max}}{\\Omega},\n$$\n其中 $C_{cp}$ 是一个无量纲常数，$F_{max}$ 是一个由平均流构建的外层速度尺度，其单位为速度单位。仅使用 Boussinesq 假设、混合长度框架和量纲一致性，构建以外层涡粘性 $\\nu_t^{outer}$ 关于 $C_{cp}$、$F_{max}$ 和 $\\Omega$ 的表达式。您的最终表达式必须是仅包含这些符号的封闭形式解析表达式。解释为证明所选剪切率尺度的合理性所需的假设，并验证您结果的量纲齐次性和伽利略不变性。\n\n将您的最终答案表示为符号表达式。不要在最终答案中包含单位。",
            "solution": "该问题要求基于零方程混合长度模型，为湍流边界层构建一个外层涡粘性 $\\nu_t^{outer}$ 的表达式。该问题是适定的，并且在湍流模型原理上具有科学依据。我们将通过应用 Boussinesq 假设和混合长度理论的一般框架到所提供的特定尺度来继续。\n\nBoussinesq 假设为雷诺应力提供了一个本构关系，这类似于分子应力的牛顿粘性定律。对于不可压缩流，它写为：\n$$\n-\\overline{u_i' u_j'} = \\nu_t \\left( \\frac{\\partial U_i}{\\partial x_j} + \\frac{\\partial U_j}{\\partial x_i} \\right) - \\frac{2}{3} k \\delta_{ij} = \\nu_t (2 S_{ij}) - \\frac{2}{3} k \\delta_{ij}\n$$\n其中，$u_i'$ 是脉动速度分量，$U_i$ 是平均速度分量，$\\nu_t$ 是湍流粘性或涡粘性，$S_{ij}$ 是平均应变率张量，$k = \\frac{1}{2}\\overline{u_i'u_i'}$ 是湍动能，$\\delta_{ij}$ 是克罗内克符号。代数零方程模型提供了一种直接从局部平均流特性计算 $\\nu_t$ 的方法，而无需为湍流量求解任何输运方程。\n\n最初由 Prandtl 提出的混合长度模型假定，涡粘性在量纲上与一个特征湍流速度尺度和一个长度尺度的乘积成正比。该速度尺度本身被建模为混合长度 $l_m$ 和一个特征平均剪切率的乘积。这导致了一般形式：\n$$\n\\nu_t = l_m^2 S\n$$\n其中 $S$ 是平均剪切率的标量度量。\n\n问题陈述指明，使用了一个由特征混合长度和代表性剪切率尺度构建的混合长度关系。对于边界层的外层，提供了以下量：\n1. 外层混合长度：$l_{BL} = C_{cp}\\,\\frac{F_{max}}{\\Omega}$\n2. 代表性剪切率尺度：平均涡量的大小 $\\Omega$。\n\n在通用的混合长度模型结构中使用这些特定量，我们可以构建外层涡粘性 $\\nu_t^{outer}$。我们将混合长度 $l_m$ 等同于给定的 $l_{BL}$，并将剪切率尺度 $S$ 等同于给定的 $\\Omega$。\n$$\n\\nu_t^{outer} = (l_{BL})^2 \\Omega\n$$\n将给定的 $l_{BL}$ 表达式代入：\n$$\n\\nu_t^{outer} = \\left( C_{cp}\\,\\frac{F_{max}}{\\Omega} \\right)^2 \\Omega = C_{cp}^{2} \\frac{F_{max}^{2}}{\\Omega^{2}} \\Omega\n$$\n简化该表达式，得到外层涡粘性的最终形式：\n$$\n\\nu_t^{outer} = C_{cp}^{2} \\frac{F_{max}^{2}}{\\Omega}\n$$\n\n接下来，我们处理问题的附带要求：解释证明剪切率尺度合理性的假设，并验证量纲齐次性和伽利略不变性。\n\n**剪切率尺度的假设：**\n问题假定外层的剪切率尺度是平均涡量的大小 $\\Omega$。对于具有平均速度矢量 $\\vec{U} = (U, V)$ 的一般二维流，其涡量矢量为 $\\vec{\\omega} = \\nabla \\times \\vec{U} = \\left(\\frac{\\partial V}{\\partial x} - \\frac{\\partial U}{\\partial y}\\right)\\hat{k}$。其大小为 $\\Omega = |\\vec{\\omega}| = \\left|\\frac{\\partial V}{\\partial x} - \\frac{\\partial U}{\\partial y}\\right|$。\n在薄边界层的背景下，我们应用薄剪切层近似。该近似假设壁面法向方向（$y$）的梯度远大于流向方向（$x$）的梯度，即 $\\frac{\\partial}{\\partial y} \\gg \\frac{\\partial}{\\partial x}$。因此，与 $\\frac{\\partial U}{\\partial y}$ 相比，项 $\\frac{\\partial V}{\\partial x}$ 被认为可以忽略不计。这导致简化为：\n$$\n\\Omega \\approx \\left| -\\frac{\\partial U}{\\partial y} \\right| = \\left| \\frac{\\partial U}{\\partial y} \\right|\n$$\n剪切率的形式标量不变量是平均应变率张量的大小， $|S| = \\sqrt{2 S_{ij} S_{ij}}$。对于二维不可压缩流，这等于 $|S| = \\sqrt{2 \\left(\\frac{\\partial U}{\\partial x}\\right)^2 + 2 \\left(\\frac{\\partial V}{\\partial y}\\right)^2 + \\left(\\frac{\\partial U}{\\partial y} + \\frac{\\partial V}{\\partial x}\\right)^2}$。应用薄剪切层近似和连续性方程 $\\frac{\\partial U}{\\partial x} + \\frac{\\partial V}{\\partial y} = 0$，上式简化为 $|S| \\approx \\left|\\frac{\\partial U}{\\partial y}\\right|$。\n因此，在薄剪切层近似下，涡量大小 $\\Omega$ 作为特征剪切率尺度的假设是合理的，因为 $\\Omega$ 和 $|S|$ 都约等于主导的剪切应变率 $\\left|\\frac{\\partial U}{\\partial y}\\right|$。\n\n**量纲齐次性：**\n我们必须验证推导出的 $\\nu_t^{outer}$ 表达式的量纲是一致的。涡粘性的量纲是长度的平方除以时间，即 $[L^2 T^{-1}]$。\n右侧项 $C_{cp}^{2} \\frac{F_{max}^{2}}{\\Omega}$ 的量纲如下：\n- $C_{cp}$ 是一个无量纲常数：$[C_{cp}] = 1$。\n- $F_{max}$ 是一个速度尺度：$[F_{max}] = L T^{-1}$。\n- $\\Omega$ 是一个涡量/剪切率尺度：$[\\Omega] = T^{-1}$。\n\n结合这些，我们检查表达式的量纲：\n$$\n\\left[ C_{cp}^{2} \\frac{F_{max}^{2}}{\\Omega} \\right] = \\frac{[1]^2 [L T^{-1}]^2}{[T^{-1}]} = \\frac{L^2 T^{-2}}{T^{-1}} = L^2 T^{-1}\n$$\n右侧的量纲与涡粘性的量纲相匹配。该表达式是量纲齐次的。\n\n**伽利略不变性：**\n湍流模型必须独立于其构建时所采用的参考系的恒定速度。此属性被称为伽利略不变性。伽利略变换由 $\\vec{x}' = \\vec{x} - \\vec{V}_c t$ 和 $\\vec{U}' = \\vec{U} - \\vec{V}_c$ 给出，其中 $\\vec{V}_c$ 是一个恒定的速度矢量。我们必须证明 $\\nu_t^{outer}$ 在这种变换下保持不变。\n我们检查表达式 $\\nu_t^{outer} = C_{cp}^{2} \\frac{F_{max}^{2}}{\\Omega}$ 中每一项的不变性：\n1. $C_{cp}$ 是一个常数，因此是不变的。\n2. 涡量为 $\\vec{\\omega} = \\nabla \\times \\vec{U}$。在新的参考系中，$\\vec{\\omega}' = \\nabla' \\times \\vec{U}'$。由于空间导数不变（$\\nabla' = \\nabla$），我们有 $\\vec{\\omega}' = \\nabla \\times (\\vec{U} - \\vec{V}_c) = (\\nabla \\times \\vec{U}) - (\\nabla \\times \\vec{V}_c)$。因为 $\\vec{V}_c$ 是一个常矢量，其旋度为零（$\\nabla \\times \\vec{V}_c = 0$）。因此，$\\vec{\\omega}' = \\vec{\\omega}$。所以涡量的大小 $\\Omega = |\\vec{\\omega}|$ 是伽利略不变的。\n3. $F_{max}$ 被描述为“由平均流构建的外层速度尺度”。在像 Baldwin-Lomax 模型这样的常见代数模型中，该项是函数 $F(y) = y |\\Omega|$ 的最大值，其中 $y$ 是壁面法向距离。与固体边界的距离 $y$ 在伽利略变换下是不变的。由于我们已经证明 $\\Omega$ 是不变的，任何仅由 $y$ 和 $\\Omega$ 构建的函数，例如 $F(y)$，也是不变的。因此，其最大值 $F_{max}$ 也必须是伽利略不变的。\n\n由于 $C_{cp}$、$F_{max}$ 和 $\\Omega$ 都是伽利略不变的，它们的组合 $C_{cp}^{2} \\frac{F_{max}^{2}}{\\Omega}$ 也是伽利略不变的。这证实了所构建的 $\\nu_t^{outer}$ 模型的物理一致性。",
            "answer": "$$\\boxed{C_{cp}^{2} \\frac{F_{max}^{2}}{\\Omega}}$$"
        },
        {
            "introduction": "在计算流体动力学（CFD）中，壁面函数是处理壁面附近湍流的基石，它极大地提高了计算效率。本练习要求你从基本物理原理出发，推导壁面律，并设计一个数值算法来反解壁面剪切应力。通过这个实践，你将掌握将理论公式转化为雷诺平均模拟（RANS）中实用计算程序的核心技能。",
            "id": "3936298",
            "problem": "您的任务是根据计算热工学和代数零方程湍流模型的基本原理，推导并实现连接光滑壁面附近的摩擦速度 $u_{\\tau}$、壁面剪切应力 $\\tau_{w}$ 和平均速度剖面 $U(y)$ 之间关系的公式，并演示如何反演给定的近壁网格中心数据以获得 $u_{\\tau}$，用于计算流体动力学 (CFD) 的壁面函数。推导应从以下基础出发，不使用任何简化公式：牛顿流体的 Newton 黏性定律、用于湍流脉动量输运的 Boussinesq 近似、混合长度与壁面法向距离成正比的代数混合长度概念，以及在平衡边界层的近壁区域总剪切应力近似恒定的观测结果。您的推导必须得出广泛使用的壁面律对数律及其黏性子层对应部分，并生成一个算法，根据第一个离壁点的速度 $U_{P}$、其壁面法向距离 $y_{P}$以及流体性质来反演对数律以计算 $u_{\\tau}$。\n\n实现要求：\n- 通过壁面剪切应力 $\\tau_{w}$ 和密度 $\\rho$ 的基本定义来定义摩擦速度 $u_{\\tau}$。使用混合长度与 $y$ 成正比的混合长度零方程模型，推导出以 $u_{\\tau}$ 表示的平均速度剖面的对数律表达式。解释由 Newton 黏性定律得出的黏性子层线性关系，并说明它如何通过为光滑壁面进行经验校准得到的加法常数与对数律相匹配。\n- 设计一个稳健的数值反演程序，在给定 $U_{P}$、$y_{P}$ 和运动黏度 $\\nu$ 的情况下，通过求解适用于光滑壁面的对数律关系式来计算 $u_{\\tau}$，求解方法应采用求根法。使用黏性子层判据来决定何时应使用线性关系而非对数律。您必须使用一种能确保 $u_{\\tau} > 0$ 并在物理现实的输入下收敛的数值方法。最终的算法必须基于您的推导，而不是一个黑箱公式。\n- 获得 $u_{\\tau}$ 后，使用推导出的 $u_{\\tau}$ 和 $\\tau_{w}$ 之间的关系计算壁面剪切应力 $\\tau_{w}$。\n\n物理单位：\n- $u_{\\tau}$ 以 $\\mathrm{m/s}$ 表示，$\\tau_{w}$ 以 $\\mathrm{Pa}$ 表示。所有输入和输出均使用国际单位制 (SI)。\n\n水力光滑壁面的常数：\n- 使用 von Karman 常数 $\\kappa = 0.41$ 和加法常数 $B = 5.2$。\n- 使用黏性子层切换阈值 $y^{+}_{\\mathrm{switch}} = 11.0$ 来在黏性子层关系和对数律之间进行选择。\n\n测试套件：\n对于下方的每个测试用例，将流动视为在光滑壁面上方，并根据给定的输入参数计算 $u_{\\tau}$ 和 $\\tau_{w}$。每个用例指定 $(U_{P}, y_{P}, \\rho, \\nu)$，其中 $U_{P}$ 是第一个离壁点的平均速度（单位 $\\mathrm{m/s}$），$y_{P}$ 是壁面法向距离（单位 $\\mathrm{m}$），$\\rho$ 是密度（单位 $\\mathrm{kg/m^3}$），$\\nu$ 是运动黏度（单位 $\\mathrm{m^2/s}$）。\n\n- 用例 $1$（明确的对数律区域）：$(U_{P} = 10.0,\\ y_{P} = 0.005,\\ \\rho = 1.20,\\ \\nu = 1.50\\times 10^{-5})$。\n- 用例 $2$（切换点附近的过渡区域）：$(U_{P} = 5.0,\\ y_{P} = 0.001,\\ \\rho = 1.20,\\ \\nu = 1.50\\times 10^{-5})$。\n- 用例 $3$（黏性子层主导，水）：$(U_{P} = 0.20,\\ y_{P} = 5.0\\times 10^{-5},\\ \\rho = 1000.0,\\ \\nu = 1.00\\times 10^{-6})$。\n- 用例 $4$（高黏度，近壁线性区，油）：$(U_{P} = 2.00,\\ y_{P} = 0.002,\\ \\rho = 850.0,\\ \\nu = 1.00\\times 10^{-4})$。\n- 用例 $5$（非常大的 $y^{+}$，强对数律）：$(U_{P} = 30.0,\\ y_{P} = 0.020,\\ \\rho = 1.20,\\ \\nu = 1.50\\times 10^{-5})$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素必须是一个包含两个元素的列表，其中包含相应测试用例的 $u_{\\tau}$ (m/s) 和 $\\tau_{w}$ (Pa)。例如，输出必须类似于 $[[u_{\\tau,1},\\ \\tau_{w,1}],\\ [u_{\\tau,2},\\ \\tau_{w,2}],\\ \\ldots]$。不得打印任何其他文本。",
            "solution": "提出的问题是推导和实现湍流边界层在光滑表面上的壁面律，并构建一个数值算法，根据单个近壁速度测量值计算摩擦速度 $u_{\\tau}$ 和壁面剪切应力 $\\tau_{w}$。该问题在科学上是合理的、适定的、客观的，并包含唯一解所需的所有必要信息。这是计算流体动力学（CFD）和热工学中的一个标准和基本问题。因此，我们可以进行完整的推导和求解。\n\n推导从考虑边界层中的总剪切应力 $\\tau_{total}$ 开始。该应力是黏性（层流）应力 $\\tau_{visc}$ 和湍流（雷诺）应力 $\\tau_{turb}$ 的总和：\n$$\n\\tau_{total}(y) = \\tau_{visc}(y) + \\tau_{turb}(y)\n$$\n其中 $y$ 是壁面法向坐标。对于牛顿流体，黏性应力由 Newton 黏性定律给出：\n$$\n\\tau_{visc} = \\mu \\frac{\\mathrm{d}U}{\\mathrm{d}y} = \\rho \\nu \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n其中 $U(y)$ 是平均速度剖面，$\\mu$ 是动力黏度，$\\rho$ 是流体密度，$\\nu = \\mu/\\rho$ 是运动黏度。湍流应力源于速度脉动引起动量输运的时间平均效应，即雷诺应力 $-\\rho \\overline{u'v'}$。使用 Boussinesq 近似，该应力通过涡黏度 $\\nu_t$ 模拟，与黏性应力类似：\n$$\n\\tau_{turb} = -\\rho \\overline{u'v'} = \\rho \\nu_t \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n在平衡湍流边界层的近壁区域，总剪切应力近似恒定，等于壁面处的剪切应力 $\\tau_w$。因此，我们有：\n$$\n\\tau_w = \\tau_{visc} + \\tau_{turb} = \\rho(\\nu + \\nu_t) \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n壁面束缚湍流中的一个基本量是摩擦速度 $u_{\\tau}$，它由壁面剪切应力和密度定义：\n$$\nu_{\\tau} \\equiv \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n将此定义代入应力方程，得到：\n$$\nu_{\\tau}^2 = (\\nu + \\nu_t) \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n此方程是推导近壁速度剖面的基础。我们在两个不同区域对其进行分析。\n\n首先，在紧邻壁面的黏性子层中，湍流脉动受到黏性效应的强烈抑制。因此，我们可以假设涡黏度与分子黏度相比可以忽略不计，即 $\\nu_t \\ll \\nu$。方程简化为：\n$$\nu_{\\tau}^2 \\approx \\nu \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n将此方程从壁面（$y=0$，无滑移条件要求 $U=0$）积分到距离 $y$ 处，得到线性速度剖面：\n$$\n\\int_0^U \\mathrm{d}U' = \\int_0^y \\frac{u_{\\tau}^2}{\\nu} \\mathrm{d}y' \\implies U(y) = \\frac{u_{\\tau}^2}{\\nu} y\n$$\n通常用无量纲壁面单位表示，其中速度由 $u_{\\tau}$ 缩放，长度由黏性长度尺度 $\\nu/u_{\\tau}$ 缩放。我们定义无量纲速度 $U^{+} = U/u_{\\tau}$ 和无量纲壁面距离 $y^{+} = y u_{\\tau}/\\nu$。在这些单位中，线性剖面变为：\n$$\n\\frac{U}{u_{\\tau}} = \\frac{y u_{\\tau}}{\\nu} \\implies U^{+} = y^{+}\n$$\n该线性关系在黏性子层中成立，通常对于 $y^{+} \\lesssim 5$。\n\n其次，在对数层（或对数律区域），该区域离壁面更远但仍在内层之内，湍流输运主导黏性输运，因此我们假设 $\\nu_t \\gg \\nu$。应力方程近似为：\n$$\nu_{\\tau}^2 \\approx \\nu_t \\frac{\\mathrm{d}U}{\\mathrm{d}y}\n$$\n为继续推导，我们需要一个涡黏度 $\\nu_t$ 的模型。问题指定了 Prandtl 的混合长度模型，这是一种零方程代数模型。对于 $\\mathrm{d}U/\\mathrm{d}y > 0$ 的边界层，该模型表述为 $\\nu_t = l_m^2 (\\mathrm{d}U/\\mathrm{d}y)$。近壁区域的一个关键假设是混合长度 $l_m$ 与离壁距离成正比，即 $l_m = \\kappa y$，其中 $\\kappa$ 是 von Karman 常数。将此代入简化的应力方程，得到：\n$$\nu_{\\tau}^2 \\approx \\left((\\kappa y)^2 \\frac{\\mathrm{d}U}{\\mathrm{d}y}\\right) \\frac{\\mathrm{d}U}{\\mathrm{d}y} = (\\kappa y)^2 \\left(\\frac{\\mathrm{d}U}{\\mathrm{d}y}\\right)^2\n$$\n对两边取平方根（并注意 $u_{\\tau}$、$\\kappa$、$y$ 和 $\\mathrm{d}U/\\mathrm{d}y$ 均为正值），得到一个可分离的一阶常微分方程：\n$$\nu_{\\tau} = \\kappa y \\frac{\\mathrm{d}U}{\\mathrm{d}y} \\implies \\mathrm{d}U = \\frac{u_{\\tau}}{\\kappa} \\frac{\\mathrm{d}y}{y}\n$$\n对此方程积分，得到对数速度剖面：\n$$\nU(y) = \\frac{u_{\\tau}}{\\kappa} \\ln(y) + C\n$$\n其中 $C$ 是积分常数。为用壁面单位表示，我们将其改写为：\n$$\n\\frac{U(y)}{u_{\\tau}} = \\frac{1}{\\kappa} \\ln(y) + C' \\implies U^{+} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y u_{\\tau}}{\\nu} \\cdot \\frac{\\nu}{u_{\\tau}}\\right) + C' = \\frac{1}{\\kappa} \\ln(y^{+}) + \\left(C' + \\frac{1}{\\kappa}\\ln\\left(\\frac{\\nu}{u_{\\tau}}\\right)\\right)\n$$\n括号中的项被吸收到一个新的常数 $B$ 中，称为对数律加法常数，该常数由光滑壁面的实验数据凭经验确定。对数律的最终形式是：\n$$\nU^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B\n$$\n问题指定了光滑壁面的标准值：$\\kappa = 0.41$ 和 $B = 5.2$。该定律通常在 $y^{+} \\gtrsim 30$ 时有效。在黏性子层和对数律区域之间存在一个缓冲层，其中黏性应力和湍流应力均显著。在CFD壁面函数实践中，我们在指定的阈值 $y^{+}_{\\mathrm{switch}} = 11.0$ 处使用两个定律之间的急剧过渡。\n\n核心任务是反演这些关系，以从近壁计算网格中心的单个数据点 $(y_P, U_P)$ 以及流体性质 $\\rho$ 和 $\\nu$ 中求出 $u_{\\tau}$。挑战在于，选择线性律还是对数律取决于 $y_P^{+} = y_P u_{\\tau}/\\nu$ 的值，而该值本身又取决于未知的 $u_{\\tau}$。\n\n我们可以通过建立一个基于给定速度 $U_P$ 的判据来设计一个稳健的算法。让我们找到 $u_{\\tau}$ 的阈值，记为 $u_{\\tau, \\mathrm{switch}}$，在该阈值下，$y_P$ 点恰好位于过渡边界 $y_P^{+} = y^{+}_{\\mathrm{switch}}$：\n$$\n\\frac{y_P u_{\\tau, \\mathrm{switch}}}{\\nu} = y^{+}_{\\mathrm{switch}} \\implies u_{\\tau, \\mathrm{switch}} = \\frac{y^{+}_{\\mathrm{switch}} \\nu}{y_P}\n$$\n在此过渡点，速度 $U_{\\mathrm{switch}}$ 可以使用线性律计算（因为对于选定的B值，定律在该点是连续的）：\n$$\nU^{+}_{\\mathrm{switch}} = y^{+}_{\\mathrm{switch}} \\implies \\frac{U_{\\mathrm{switch}}}{u_{\\tau, \\mathrm{switch}}} = y^{+}_{\\mathrm{switch}} \\implies U_{\\mathrm{switch}} = u_{\\tau, \\mathrm{switch}} y^{+}_{\\mathrm{switch}} = \\left(\\frac{y^{+}_{\\mathrm{switch}} \\nu}{y_P}\\right) y^{+}_{\\mathrm{switch}} = \\frac{(y^{+}_{\\mathrm{switch}})^2 \\nu}{y_P}\n$$\n这个 $U_{\\mathrm{switch}}$ 表示，如果 $y_P$ 点恰好位于子层和对数层之间的边界上，在该点测得的速度。\n现在我们可以将给定的测量速度 $U_P$ 与此阈值进行比较：\n1.  如果 $U_P \\le U_{\\mathrm{switch}}$，则点 $(y_P, U_P)$ 位于黏性子层内。因此，我们可以使用显式线性关系来求解 $u_{\\tau}$：\n    $$\n    U_P = \\frac{u_{\\tau}^2 y_P}{\\nu} \\implies u_{\\tau} = \\sqrt{\\frac{U_P \\nu}{y_P}}\n    $$\n2.  如果 $U_P > U_{\\mathrm{switch}}$，则该点位于对数律区域内。我们必须求解以下超越方程以得到 $u_{\\tau}$：\n    $$\n    U_P = u_{\\tau} \\left(\\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right) + B\\right)\n    $$\n这需要一个数值求根方法。让我们定义一个残差函数 $R(u_{\\tau})$：\n$$\nR(u_{\\tau}) = u_{\\tau} \\left(\\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right) + B\\right) - U_P = 0\n$$\nNewton 法是求解此问题的有效选择。迭代更新为 $u_{\\tau, k+1} = u_{\\tau, k} - R(u_{\\tau, k})/R'(u_{\\tau, k})$。导数 $R'(u_{\\tau})$ 为：\n$$\nR'(u_{\\tau}) = \\frac{\\mathrm{d}}{\\mathrm{d}u_{\\tau}} \\left[ u_{\\tau} \\left(\\frac{U_P}{u_{\\tau}}\\right) - U_P \\right] = \\frac{\\mathrm{d}}{\\mathrm{d}u_{\\tau}} \\left[ u_{\\tau} \\left(\\frac{1}{\\kappa} \\ln(y_P u_{\\tau}/\\nu) + B \\right) \\right]\n$$\n$$\nR'(u_{\\tau}) = \\left(\\frac{1}{\\kappa} \\ln\\left(\\frac{y_P u_{\\tau}}{\\nu}\\right) + B\\right) + u_{\\tau} \\left(\\frac{1}{\\kappa} \\frac{1}{u_{\\tau}}\\right) = \\frac{U_P}{u_{\\tau}} + \\frac{1}{\\kappa}\n$$\n由于 $U_P$、$u_{\\tau}$ 和 $\\kappa$ 均为正值，$R'(u_{\\tau})$ 始终为正，保证了 $R(u_{\\tau})$ 是单调的，并且最多只有一个根。迭代的一个有效初始猜测可以是 $u_{\\tau, 0} = u_{\\tau, \\mathrm{switch}}$ 或另一个合理的估计，例如 $u_{\\tau, 0} = U_P/20$。迭代进行直到 $u_{\\tau}$ 的变化小于预设的容差。\n\n一旦通过显式公式或迭代求解器确定了 $u_{\\tau}$，壁面剪切应力 $\\tau_w$ 就直接从其定义计算得出：\n$$\n\\tau_w = \\rho u_{\\tau}^2\n$$\n这完成了解决该问题所需的理论框架和算法设计。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements the law of the wall to compute friction velocity\n    and wall shear stress from near-wall CFD data.\n    \"\"\"\n\n    # Define physical constants for a hydraulically smooth wall as per the problem.\n    KAPPA = 0.41  # von Karman constant\n    B = 5.2       # Log-law additive constant\n    Y_PLUS_SWITCH = 11.0 # Threshold for switching between viscous and log layers\n\n    # Test cases: (U_P, y_P, rho, nu)\n    # U_P: mean velocity at cell center [m/s]\n    # y_P: wall-normal distance of cell center [m]\n    # rho: fluid density [kg/m^3]\n    # nu: fluid kinematic viscosity [m^2/s]\n    test_cases = [\n        (10.0, 0.005, 1.20, 1.50e-5),  # Case 1 (clear log-law regime)\n        (5.0, 0.001, 1.20, 1.50e-5),   # Case 2 (transitional near the switch)\n        (0.20, 5.0e-5, 1000.0, 1.00e-6),# Case 3 (viscous sublayer dominance, water)\n        (2.00, 0.002, 850.0, 1.00e-4), # Case 4 (high viscosity, linear regime, oil)\n        (30.0, 0.020, 1.20, 1.50e-5),  # Case 5 (very large y+, strong log-law)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        U_P, y_P, rho, nu = case\n\n        # Calculate the threshold velocity U_switch that corresponds to y_P being\n        # at the transition point y_plus_switch.\n        # This determines whether the point (y_P, U_P) is in the viscous sublayer\n        # or the logarithmic layer.\n        u_tau_switch = Y_PLUS_SWITCH * nu / y_P\n        U_switch = u_tau_switch * Y_PLUS_SWITCH\n\n        if U_P = U_switch:\n            # The point is in the viscous sublayer.\n            # U = u_tau^2 * y / nu  =>  u_tau = sqrt(U * nu / y)\n            u_tau = np.sqrt(U_P * nu / y_P)\n        else:\n            # The point is in the logarithmic layer.\n            # We must solve the transcendental equation for u_tau using an iterative method.\n            # U_P = u_tau * (1/KAPPA * ln(y_P * u_tau / nu) + B)\n            # We use Newton's method to solve for R(u_tau) = 0 where\n            # R(u_tau) = u_tau * (1/KAPPA * ln(...) + B) - U_P\n            \n            # A good initial guess for the iteration.\n            # A simple physical heuristic is often sufficient, e.g., u_tau is a few percent of U_P.\n            # Starting from the switch value is also a robust choice.\n            u_tau_k = u_tau_switch \n            \n            # Parameters for Newton's method solver\n            TOLERANCE = 1.0e-9\n            MAX_ITERATIONS = 15\n\n            for i in range(MAX_ITERATIONS):\n                if u_tau_k = 0: # Ensure log argument is positive\n                    # This case is unlikely with good initial guess but is a safeguard.\n                    # A small positive value is used to restart.\n                    u_tau_k = TOLERANCE \n                \n                # Evaluate the residual function R(u_tau)\n                y_plus_k = y_P * u_tau_k / nu\n                U_plus_k = (1.0 / KAPPA) * np.log(y_plus_k) + B\n                R = u_tau_k * U_plus_k - U_P\n\n                # Evaluate the derivative of the residual function R'(u_tau)\n                # R'(u_tau) = U_plus + 1/KAPPA\n                R_prime = U_plus_k + 1.0 / KAPPA\n\n                # Newton's method update step\n                u_tau_k_plus_1 = u_tau_k - R / R_prime\n\n                if abs(u_tau_k_plus_1 - u_tau_k)  TOLERANCE:\n                    break\n                \n                u_tau_k = u_tau_k_plus_1\n            \n            u_tau = u_tau_k_plus_1\n\n        # After finding u_tau, calculate the wall shear stress tau_w.\n        # tau_w = rho * u_tau^2\n        tau_w = rho * u_tau**2\n        \n        results.append([u_tau, tau_w])\n\n    # Format the final output as specified.\n    output_str = \"[\" + \",\".join([f\"[{u_tau:.8e}, {tau_w:.8e}]\" for u_tau, tau_w in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "湍流模型的选择直接影响传热预测的准确性，尤其是在近壁区域，阻尼函数的具体形式至关重要。本练习将引导你分析不同阻尼函数对湍流热扩散系数 $\\alpha_t$ 和有效导热系数 $k_{\\mathrm{eff}}$ 的影响，并最终通过数值积分计算传热系数 $h$。这个练习旨在培养你对模型假设的批判性思维，并量化模型选择对工程预测结果带来的差异。",
            "id": "3936299",
            "problem": "考虑一个紧邻等温壁面的、厚度为 $\\delta$ 的稳态、充分发展的湍流热边界层。设流体的密度为 $\\rho$、动力粘度为 $\\mu$、定压比热为 $c_p$、热导率为 $k$。分子运动粘度为 $\\nu = \\mu / \\rho$，分子热扩散率为 $\\alpha = k / (\\rho c_p)$。定义摩擦速度 $u_\\tau = \\sqrt{\\tau_w / \\rho}$，其中 $\\tau_w$ 是壁面剪切应力。无量纲壁面距离为 $y^+ = y u_\\tau / \\nu$，摩擦雷诺数为 $\\mathrm{Re}_\\tau = u_\\tau \\delta / \\nu$。湍流普朗特数（湍流的Prandtl数）$\\mathrm{Pr}_t$ 通过 $\\alpha_t = \\nu_t / \\mathrm{Pr}_t$ 将湍流热扩散率 $\\alpha_t$ 和湍流运动粘度 $\\nu_t$ 联系起来。在代数零方程湍流模型中，湍流运动粘度使用 Prandtl 混合长度假设进行建模，其中混合长度为 $l_m = \\kappa y f_d(y^+)$，$\\kappa$ 是 von Kármán 常数，$f_d(y^+)$ 是一个近壁阻尼函数。剪切应力使用 Boussinesq 假设和对数律层中平均速度梯度的平衡近似进行封闭。有效热导率为 $k_\\mathrm{eff}(y) = k + \\rho c_p \\alpha_t(y)$，一维横向热通量为 $q''(y) = -k_\\mathrm{eff}(y) \\,\\mathrm{d}T/\\mathrm{d}y$。在充分发展的条件下，当单位面积的壁面热输入恒定时，总横向热通量与 $y$ 无关，这意味着可以采用热阻的解释。因此，壁面传热系数 $h$ 可以用整个边界层的积分热阻表示为 $h = \\left[\\int_0^\\delta \\frac{\\mathrm{d}y}{k_\\mathrm{eff}(y)}\\right]^{-1}$。你的任务是通过从 $\\mathrm{Pr}_t$ 和 $l_m = \\kappa y f_d(y^+)$ 计算 $\\alpha_t(y)$，评估 $k_\\mathrm{eff}(y)$，并积分热阻，来分析预测的 $h$ 对阻尼函数 $f_d(y^+)$ 选择的敏感性。\n\n使用以下三种科学上合理的阻尼函数 $f_d(y^+)$：\n\n- Van Driest: $f_d(y^+) = 1 - \\exp\\!\\left(-\\dfrac{y^+}{A^+}\\right)$。\n- 双曲正切函数: $f_d(y^+) = \\tanh\\!\\left(\\dfrac{y^+}{A^+}\\right)$。\n- 代数有理函数: $f_d(y^+) = \\dfrac{y^+}{A^+ + y^+}$。\n\n从上述基本关系出发，一致地使用混合长度封闭和平衡对数律层近似来确定 $\\nu_t(y)$，然后计算 $\\alpha_t(y)$ 和 $k_\\mathrm{eff}(y)$，最后从积分热阻中得到 $h$。假设 von Kármán 常数 $\\kappa = 0.41$ 为一个常数，并将 $\\mathrm{Pr}_t$ 在每个测试用例中视为给定的常数。\n\n将最终的传热系数 $h$ 以 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$ 为单位，表示为浮点数值。\n\n测试套件：\n对于以下每个参数集，计算一个包含三个值的元组 $\\left[h_\\mathrm{VD}, h_\\mathrm{TH}, h_\\mathrm{AL}\\right]$，分别对应于 Van Driest、双曲正切和代数有理阻尼函数：\n\n- 案例 $1$ (类空气): $\\rho = 1.200\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\mu = 1.800\\times 10^{-5}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$, $k = 0.0260\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $c_p = 1005\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, $u_\\tau = 0.500\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $\\delta = 0.0100\\,\\mathrm{m}$, $\\mathrm{Pr}_t = 0.85$, $A^+ = 26$。\n- 案例 $2$ (类水): $\\rho = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\mu = 1.00\\times 10^{-3}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$, $k = 0.600\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $c_p = 4180\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, $u_\\tau = 0.100\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $\\delta = 0.0100\\,\\mathrm{m}$, $\\mathrm{Pr}_t = 0.90$, $A^+ = 26$。\n- 案例 $3$ (低摩擦雷诺数边界情况，类空气): $\\rho = 1.200\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\mu = 1.800\\times 10^{-5}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$, $k = 0.0260\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $c_p = 1005\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, $u_\\tau = 0.0900\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $\\delta = 0.00100\\,\\mathrm{m}$, $\\mathrm{Pr}_t = 0.85$, $A^+ = 26$。\n\n您的程序应生成单行输出，其中包含一个由三个内部列表组成的逗号分隔列表。每个内部列表包含一个案例的三个浮点数 $h$ 值，按案例1、案例2、案例3的顺序排列，并用方括号括起来。例如，格式应类似于 $\\left[\\left[h_1^\\mathrm{VD},h_1^\\mathrm{TH},h_1^\\mathrm{AL}\\right],\\left[h_2^\\mathrm{VD},h_2^\\mathrm{TH},h_2^\\mathrm{AL}\\right],\\left[h_3^\\mathrm{VD},h_3^\\mathrm{TH},h_3^\\mathrm{AL}\\right]\\right]$，所有 $h$ 值的单位均为 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-1}$。",
            "solution": "该问题是有效的。它在科学上基于湍流边界层理论和传热学的原理，特别是使用了 Prandtl 混合长度模型，这是一个标准的代数零方程模型。该问题是适定的、客观的、自包含的，并且在计算上是可行的。\n\n目标是针对三种不同的阻尼函数 $f_d(y^+)$ 和三组物理参数，计算传热系数 $h$。传热系数由贯穿边界层的总热阻的倒数给出：\n$$ h = \\left[\\int_0^\\delta \\frac{\\mathrm{d}y}{k_\\mathrm{eff}(y)}\\right]^{-1} $$\n其中 $\\delta$ 是边界层厚度，$k_\\mathrm{eff}(y)$ 是距壁面距离 $y$ 处的有效热导率。\n\n有效热导率是分子热导率 $k$ 和湍流贡献 $k_t = \\rho c_p \\alpha_t$ 的总和，其中 $\\rho$ 是密度，$c_p$ 是定压比热，$\\alpha_t$ 是湍流热扩散率。\n$$ k_\\mathrm{eff}(y) = k + \\rho c_p \\alpha_t(y) $$\n湍流热扩散率 $\\alpha_t$ 通过湍流普朗特数 $\\mathrm{Pr}_t$ 与湍流运动粘度 $\\nu_t$ 相关：\n$$ \\alpha_t(y) = \\frac{\\nu_t(y)}{\\mathrm{Pr}_t} $$\n问题指示使用 Prandtl 混合长度假设 $l_m$ 和“对数律层中平均速度梯度的平衡近似”来确定湍流运动粘度 $\\nu_t$。\n\n湍流粘度的混合长度模型是：\n$$ \\nu_t = l_m^2 \\left| \\frac{\\mathrm{d}U}{\\mathrm{d}y} \\right| $$\n混合长度 $l_m$ 给出为：\n$$ l_m = \\kappa y f_d(y^+) $$\n其中 $\\kappa$ 是 von Kármán 常数，$y$ 是壁面距离，$f_d(y^+)$ 是无量纲壁面距离 $y^+ = y u_\\tau / \\nu$ 的近壁阻尼函数。此处，$u_\\tau$ 是摩擦速度，$\\nu$ 是分子运动粘度。\n\n对数律层中平均速度梯度的近似为：\n$$ \\frac{\\mathrm{d}U}{\\mathrm{d}y} = \\frac{u_\\tau}{\\kappa y} $$\n将 $l_m$ 和 $\\mathrm{d}U/\\mathrm{d}y$ 的表达式代入 $\\nu_t$ 的方程，得到：\n$$ \\nu_t(y) = (\\kappa y f_d(y^+))^2 \\left( \\frac{u_\\tau}{\\kappa y} \\right) = \\kappa y u_\\tau (f_d(y^+))^2 $$\n现在我们可以组装出 $k_\\mathrm{eff}(y)$ 的完整表达式：\n$$ k_\\mathrm{eff}(y) = k + \\frac{\\rho c_p}{\\mathrm{Pr}_t} \\nu_t(y) = k + \\frac{\\rho c_p}{\\mathrm{Pr}_t} \\kappa y u_\\tau (f_d(y^+))^2 $$\n为了简化积分，我们执行从 $y$ 到 $y^+$ 的变量替换。\n$y = y^+ \\nu / u_\\tau$，所以 $\\mathrm{d}y = (\\nu / u_\\tau) \\mathrm{d}y^+$。\n积分上限 $y=\\delta$ 变为 $y^+ = \\delta^+ = \\delta u_\\tau / \\nu = \\mathrm{Re}_\\tau$。\n热阻积分 $R_{th} = 1/h$ 变为：\n$$ R_{th} = \\int_0^{\\mathrm{Re}_\\tau} \\frac{(\\nu / u_\\tau) \\mathrm{d}y^+}{k + \\frac{\\rho c_p}{\\mathrm{Pr}_t} \\kappa \\left( \\frac{y^+\\nu}{u_\\tau} \\right) u_\\tau (f_d(y^+))^2} = \\int_0^{\\mathrm{Re}_\\tau} \\frac{(\\nu / u_\\tau) \\mathrm{d}y^+}{k + \\frac{\\rho c_p \\kappa \\nu}{\\mathrm{Pr}_t} y^+ (f_d(y^+))^2} $$\n从分母中提出因子 $k$，并使用分子普朗特数 $\\mathrm{Pr} = \\nu / \\alpha = \\nu \\rho c_p / k$ 的定义，我们可以写出 $\\rho c_p \\kappa \\nu = k \\kappa \\mathrm{Pr}$。\n$$ R_{th} = \\int_0^{\\mathrm{Re}_\\tau} \\frac{(\\nu / u_\\tau) \\mathrm{d}y^+}{k \\left( 1 + \\frac{\\kappa \\mathrm{Pr}}{\\mathrm{Pr}_t} y^+ (f_d(y^+))^2 \\right)} = \\frac{\\nu}{k u_\\tau} \\int_0^{\\mathrm{Re}_\\tau} \\frac{\\mathrm{d}y^+}{1 + \\frac{\\kappa \\mathrm{Pr}}{\\mathrm{Pr}_t} y^+ (f_d(y^+))^2} $$\n于是传热系数为：\n$$ h = \\frac{1}{R_{th}} = \\frac{k u_\\tau}{\\nu} \\left[ \\int_0^{\\mathrm{Re}_\\tau} \\frac{\\mathrm{d}y^+}{1 + \\frac{\\kappa \\mathrm{Pr}}{\\mathrm{Pr}_t} y^+ (f_d(y^+))^2} \\right]^{-1} $$\n这个最终形式适合进行数值计算。对于每个测试用例，我们首先计算派生参数 $\\nu$、$\\mathrm{Pr}$ 和 $\\mathrm{Re}_\\tau$。然后，对于三个指定的阻尼函数 $f_d(y^+)$ 中的每一个，我们使用数值积分方法计算从 $y^+=0$ 到 $y^+=\\mathrm{Re}_\\tau$ 的定积分。最后，我们使用上面的公式计算 $h$。\n\n将使用的三个阻尼函数是：\n1.  Van Driest: $f_d(y^+) = 1 - \\exp(-y^+/A^+)$\n2.  双曲正切: $f_d(y^+) = \\tanh(y^+/A^+)$\n3.  代数有理: $f_d(y^+) = y^+ / (A^+ + y^+)$\n\n数值解是通过定义一个 Python 函数来实现的，该函数将物理参数和阻尼函数类型作为输入，构建被积函数，使用 `scipy.integrate.quad` 执行积分，并返回计算出的 $h$ 值。对测试套件中指定的所有组合重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the turbulent heat transfer problem for the given test cases.\n    \"\"\"\n    # Define physical constants and test case parameters\n    KAPPA = 0.41\n\n    test_cases = [\n        # Case 1 (air-like)\n        {'rho': 1.200, 'mu': 1.800e-5, 'k': 0.0260, 'cp': 1005,\n         'u_tau': 0.500, 'delta': 0.0100, 'Pr_t': 0.85, 'A_plus': 26},\n        # Case 2 (water-like)\n        {'rho': 1000.0, 'mu': 1.00e-3, 'k': 0.600, 'cp': 4180.0,\n         'u_tau': 0.100, 'delta': 0.0100, 'Pr_t': 0.90, 'A_plus': 26},\n        # Case 3 (low-friction Re, air-like)\n        {'rho': 1.200, 'mu': 1.800e-5, 'k': 0.0260, 'cp': 1005,\n         'u_tau': 0.0900, 'delta': 0.00100, 'Pr_t': 0.85, 'A_plus': 26}\n    ]\n\n    damping_model_names = ['VD', 'TH', 'AL']\n    all_results = []\n\n    for params in test_cases:\n        case_results = []\n        for model_name in damping_model_names:\n            h = calculate_heat_transfer_coefficient(params, model_name, KAPPA)\n            case_results.append(h)\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # [[h_1_VD, h_1_TH, h_1_AL], [h_2_VD, h_2_TH, h_2_AL], [h_3_VD, h_3_TH, h_3_AL]]\n    formatted_results = f\"[{','.join([f'[{\",\".join(map(str, inner))}]' for inner in all_results])}]\"\n    print(formatted_results)\n\n\ndef calculate_heat_transfer_coefficient(params, damping_type, kappa):\n    \"\"\"\n    Calculates the heat transfer coefficient h for a given set of parameters\n    and a specific damping function model.\n\n    Args:\n        params (dict): Dictionary of physical and flow parameters.\n        damping_type (str): Type of damping function ('VD', 'TH', 'AL').\n        kappa (float): von Kármán constant.\n\n    Returns:\n        float: The calculated heat transfer coefficient h in W m^-2 K^-1.\n    \"\"\"\n    # Unpack parameters\n    rho = params['rho']\n    mu = params['mu']\n    k = params['k']\n    cp = params['cp']\n    u_tau = params['u_tau']\n    delta = params['delta']\n    Pr_t = params['Pr_t']\n    A_plus = params['A_plus']\n\n    # Calculate derived fluid and flow properties\n    nu = mu / rho\n    Pr = mu * cp / k\n    Re_tau = u_tau * delta / nu  # This is the upper integration limit, delta^+\n\n    # Define the damping functions based on the specified type\n    def f_d(y_plus):\n        if damping_type == 'VD':\n            # Van Driest\n            return 1.0 - np.exp(-y_plus / A_plus)\n        elif damping_type == 'TH':\n            # Hyperbolic tangent\n            return np.tanh(y_plus / A_plus)\n        elif damping_type == 'AL':\n            # Algebraic rational\n            return y_plus / (A_plus + y_plus)\n        else:\n            raise ValueError(f\"Unknown damping type: {damping_type}\")\n\n    # Define the integrand for the non-dimensional resistance integral\n    def integrand_nondim(y_plus):\n        # Integrand for I in R_th = (nu / (k * u_tau)) * I\n        # I = integral from 0 to Re_tau of dy+ / (k_eff/k)\n        # where k_eff/k = 1 + (kappa * Pr / Pr_t) * y_plus * (f_d(y_plus))^2\n        if y_plus == 0:\n            return 1.0  # k_eff/k = 1 at the wall\n\n        fd_val = f_d(y_plus)\n        k_eff_over_k = 1.0 + (kappa * Pr / Pr_t) * y_plus * (fd_val**2)\n        return 1.0 / k_eff_over_k\n\n    # Perform the numerical integration of the non-dimensional thermal resistance\n    integral_val, _ = quad(integrand_nondim, 0, Re_tau)\n\n    # Calculate the heat transfer coefficient h\n    # h = 1/R_th = (k * u_tau / nu) / integral_val\n    h = (k * u_tau / nu) / integral_val\n    \n    return h\n\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}