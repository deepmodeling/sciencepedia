{
    "hands_on_practices": [
        {
            "introduction": "To analyze and model the complex fluid dynamics near a solid boundary, we first need a universal framework. This practice introduces the fundamental language of wall-bounded turbulence: wall units. By calculating the dimensionless distance $y^+$ and velocity $u^+$, you will learn to transform physical measurements into a universal coordinate system, allowing you to classify flow data into the distinct canonical regions of the near-wall layer, such as the viscous sublayer, buffer layer, and logarithmic layer .",
            "id": "4001766",
            "problem": "A zero-pressure-gradient turbulent boundary layer develops over a smooth, isothermal flat plate in air. At a given streamwise location, the wall shear stress and fluid properties are known from independent measurements. Four wall-normal locations are instrumented to provide the time-averaged mean velocity. Your task is to compute the wall coordinates and classify each point into near-wall regions consistent with the use of wall functions in Reynolds-Averaged Navier–Stokes (RANS) models, then report a single aggregated quantity.\n\nKnown data:\n- Air density: $\\rho = 1.20 \\ \\mathrm{kg \\, m^{-3}}$.\n- Air dynamic viscosity: $\\mu = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\, s}$.\n- Wall shear stress: $\\tau_{w} = 0.90 \\ \\mathrm{Pa}$.\n- Wall-normal locations and mean velocity: $(y_1, U_1) = (1.0 \\times 10^{-5} \\ \\mathrm{m}, \\ 0.500 \\ \\mathrm{m \\, s^{-1}})$, $(y_2, U_2) = (1.0 \\times 10^{-4} \\ \\mathrm{m}, \\ 8.20 \\ \\mathrm{m \\, s^{-1}})$, $(y_3, U_3) = (1.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 12.99038106 \\ \\mathrm{m \\, s^{-1}})$, $(y_4, U_4) = (5.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 18.18653349 \\ \\mathrm{m \\, s^{-1}})$.\n\nTasks:\n1. Starting from Newton’s law of viscosity and the definition of wall shear stress, and invoking the standard definition of wall units in turbulent boundary layer theory, derive the steps needed to compute the friction velocity $u_{\\tau}$, the kinematic viscosity $\\nu$, the wall distance in wall units $y^{+}$, and the velocity in wall units $u^{+}$ at each location.\n2. Compute $y_i^{+}$ and $u_i^{+}$ for $i \\in \\{1,2,3,4\\}$.\n3. Using the following region definitions based on $y^{+}$, classify each point: viscous sublayer if $y^{+} \\leq 5$, buffer layer if $5  y^{+}  30$, logarithmic (overlap) layer if $30 \\leq y^{+} \\leq 300$, outer wake if $y^{+} > 300$. Identify which points are suitable for applying standard high-Reynolds-number wall functions predicated on the logarithmic law of the wall.\n4. Let $\\mathcal{L}$ denote the set of indices of the points that fall in the logarithmic layer. Report the arithmetic mean of $u^{+}$ over $\\mathcal{L}$.\n\nAnswer specification:\n- Provide the final answer as a single dimensionless real number equal to the arithmetic mean of $u^{+}$ over the logarithmic-layer points.\n- Round your answer to four significant figures.\n- Do not include units with the final answer.",
            "solution": "The problem requires the analysis of four data points from a turbulent boundary layer to classify them into near-wall regions and compute a specific statistical quantity. The process involves calculating wall-scaled quantities ($y^{+}$ and $u^{+}$) and applying standard definitions for boundary layer regions.\n\n### Step 1: Derivation of Wall Unit Calculations\n\nThe analysis is based on the concept of wall units, which non-dimensionalize quantities near a solid boundary using wall-based scales.\n\nThe **friction velocity**, denoted by $u_{\\tau}$, is the characteristic velocity scale and is defined from the wall shear stress, $\\tau_w$, and the fluid density, $\\rho$:\n$$\n\\tau_w = \\rho u_{\\tau}^2\n$$\nSolving for $u_{\\tau}$ yields:\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\n\nThe **kinematic viscosity**, $\\nu$, is the ratio of the dynamic viscosity, $\\mu$, to the density, $\\rho$:\n$$\n\\nu = \\frac{\\mu}{\\rho}\n$$\n\nThe characteristic length scale in the near-wall region is the viscous length scale, $\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}$. The physical distance from the wall, $y$, and the mean velocity, $U$, are non-dimensionalized using these scales.\n\nThe **dimensionless wall distance**, $y^{+}$, is defined as:\n$$\ny^{+} = \\frac{y}{\\delta_{\\nu}} = \\frac{y u_{\\tau}}{\\nu}\n$$\n\nThe **dimensionless velocity**, $u^{+}$, is defined as:\n$$\nu^{+} = \\frac{U}{u_{\\tau}}\n$$\nThese definitions, starting from Newton's law of viscosity at the wall, $\\tau_w = \\mu (\\frac{dU}{dy})_{y=0}$, form the basis for the law-of-the-wall formulation.\n\n### Step 2: Calculation of Physical Scales and Wall Coordinates\n\nFirst, we compute the constant physical scales $u_{\\tau}$ and $\\nu$ using the provided data:\n$\\rho = 1.20 \\ \\mathrm{kg \\, m^{-3}}$\n$\\mu = 1.80 \\times 10^{-5} \\ \\mathrm{Pa \\, s}$\n$\\tau_{w} = 0.90 \\ \\mathrm{Pa}$\n\nThe friction velocity is:\n$$\nu_{\\tau} = \\sqrt{\\frac{0.90 \\ \\mathrm{Pa}}{1.20 \\ \\mathrm{kg \\, m^{-3}}}} = \\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}} = \\frac{\\sqrt{3}}{2} \\ \\mathrm{m \\, s^{-1}} \\approx 0.866025 \\ \\mathrm{m \\, s^{-1}}\n$$\n\nThe kinematic viscosity is:\n$$\n\\nu = \\frac{1.80 \\times 10^{-5} \\ \\mathrm{Pa \\, s}}{1.20 \\ \\mathrm{kg \\, m^{-3}}} = 1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}\n$$\n\nNow, we compute $y_i^{+}$ and $u_i^{+}$ for each measurement point $(y_i, U_i)$ for $i \\in \\{1, 2, 3, 4\\}$.\n\n**Point 1:** $(y_1, U_1) = (1.0 \\times 10^{-5} \\ \\mathrm{m}, \\ 0.500 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_1^{+} = \\frac{y_1 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-5} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{\\sqrt{0.75}}{1.5} = \\frac{\\sqrt{3}/2}{3/2} = \\frac{\\sqrt{3}}{3} \\approx 0.57735\n$$\n$$\nu_1^{+} = \\frac{U_1}{u_{\\tau}} = \\frac{0.500 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = \\frac{0.5}{\\sqrt{3}/2} = \\frac{1}{\\sqrt{3}} = \\frac{\\sqrt{3}}{3} \\approx 0.57735\n$$\n\n**Point 2:** $(y_2, U_2) = (1.0 \\times 10^{-4} \\ \\mathrm{m}, \\ 8.20 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_2^{+} = \\frac{y_2 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-4} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{10 \\sqrt{0.75}}{1.5} = \\frac{10\\sqrt{3}}{3} \\approx 5.7735\n$$\n$$\nu_2^{+} = \\frac{U_2}{u_{\\tau}} = \\frac{8.20 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = \\frac{8.20}{\\sqrt{3}/2} = \\frac{16.4}{\\sqrt{3}} \\approx 9.4681\n$$\n\n**Point 3:** $(y_3, U_3) = (1.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 12.99038106 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_3^{+} = \\frac{y_3 u_{\\tau}}{\\nu} = \\frac{(1.0 \\times 10^{-3} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{100 \\sqrt{0.75}}{1.5} = \\frac{100\\sqrt{3}}{3} \\approx 57.735\n$$\nThe value of $U_3$ is precisely constructed. We check: $15 \\times u_\\tau = 15 \\times \\frac{\\sqrt{3}}{2} = 7.5\\sqrt{3} \\approx 12.99038106$. Thus:\n$$\nu_3^{+} = \\frac{U_3}{u_{\\tau}} = \\frac{12.99038106 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = 15.00\n$$\n\n**Point 4:** $(y_4, U_4) = (5.0 \\times 10^{-3} \\ \\mathrm{m}, \\ 18.18653349 \\ \\mathrm{m \\, s^{-1}})$\n$$\ny_4^{+} = \\frac{y_4 u_{\\tau}}{\\nu} = \\frac{(5.0 \\times 10^{-3} \\ \\mathrm{m}) (\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}})}{1.50 \\times 10^{-5} \\ \\mathrm{m^2 \\, s^{-1}}} = \\frac{500 \\sqrt{0.75}}{1.5} = \\frac{500\\sqrt{3}}{3} \\approx 288.675\n$$\nSimilarly, the value of $U_4$ is precisely constructed. We check: $21 \\times u_\\tau = 21 \\times \\frac{\\sqrt{3}}{2} = 10.5\\sqrt{3} \\approx 18.18653349$. Thus:\n$$\nu_4^{+} = \\frac{U_4}{u_{\\tau}} = \\frac{18.18653349 \\ \\mathrm{m \\, s^{-1}}}{\\sqrt{0.75} \\ \\mathrm{m \\, s^{-1}}} = 21.00\n$$\n\n### Step 3: Classification of Points\n\nUsing the standard region definitions based on $y^{+}$:\n- Viscous sublayer: $y^{+} \\leq 5$\n- Buffer layer: $5  y^{+}  30$\n- Logarithmic (overlap) layer: $30 \\leq y^{+} \\leq 300$\n- Outer wake: $y^{+} > 300$\n\nWe classify each point:\n- **Point 1:** $y_1^{+} \\approx 0.577$. Since $0.577 \\leq 5$, this point lies in the **viscous sublayer**. (Note: a defining feature of this layer is $u^{+} = y^{+}$, which holds for this point: $u_1^{+} \\approx 0.577$).\n- **Point 2:** $y_2^{+} \\approx 5.77$. Since $5  5.77  30$, this point lies in the **buffer layer**.\n- **Point 3:** $y_3^{+} \\approx 57.7$. Since $30 \\leq 57.7 \\leq 300$, this point lies in the **logarithmic layer**.\n- **Point 4:** $y_4^{+} \\approx 288.7$. Since $30 \\leq 288.7 \\leq 300$, this point also lies in the **logarithmic layer**.\n\nPoints located in the logarithmic layer are suitable for the application of standard high-Reynolds-number wall functions in RANS models, as these functions are based on the logarithmic law of the wall, $u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + C$, which is valid in this region. Therefore, points $3$ and $4$ are the relevant points.\n\n### Step 4: Calculation of the Arithmetic Mean\n\nThe problem asks for the arithmetic mean of $u^{+}$ over the set $\\mathcal{L}$ of indices of points that fall in the logarithmic layer. From our classification, $\\mathcal{L} = \\{3, 4\\}$. The corresponding dimensionless velocities are $u_3^{+} = 15$ and $u_4^{+} = 21$.\n\nThe arithmetic mean is:\n$$\n\\text{Mean}(u^{+}) = \\frac{1}{ |\\mathcal{L}| } \\sum_{i \\in \\mathcal{L}} u_i^{+} = \\frac{u_3^{+} + u_4^{+}}{2} = \\frac{15 + 21}{2} = \\frac{36}{2} = 18\n$$\n\nThe result is exactly $18$. As per the answer specification to round to four significant figures, the final answer is $18.00$.",
            "answer": "$$\\boxed{18.00}$$"
        },
        {
            "introduction": "Building on the concept of wall units, we now focus on the logarithmic layer, where the mean velocity profile follows the celebrated law of the wall, $u^+ = \\frac{1}{\\kappa} \\ln(y^+) + B$. This exercise puts you in the role of a data analyst, tasking you with extracting the universal von Kármán constant, $\\kappa$, and the additive constant, $B$, from a given velocity dataset. This practice will sharpen your ability to apply regression techniques and, more importantly, to critically assess the validity of a physical model by carefully selecting the appropriate data range, thereby understanding how buffer layer and wake effects can contaminate the analysis .",
            "id": "3975557",
            "problem": "A fully developed turbulent plane channel flow of air at temperature $T \\approx 300\\,\\mathrm{K}$ has kinematic viscosity $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$ and density $\\rho = 1.2\\,\\mathrm{kg}/\\mathrm{m}^3$. The channel half-height is $h = 0.05\\,\\mathrm{m}$. The wall friction velocity is $u_{\\tau} = 0.8\\,\\mathrm{m}/\\mathrm{s}$, so the friction Reynolds number is $Re_{\\tau} = u_{\\tau} h / \\nu$. Mean velocity measurements $u(y)$ were obtained at wall-normal locations $y_i$ (measured from the wall), with values listed below. Define the inner-scaled wall coordinate $y^+ = y u_{\\tau}/\\nu$ and the inner-scaled mean velocity $u^+ = u/u_{\\tau}$. Consider the hypothesis that in the inertial sublayer under equilibrium conditions, $u^+$ depends logarithmically on $y^+$, implying an affine relation between $u^+$ and $\\ln y^+$.\n\nData points $(y_i, u_i)$:\n- $(y_1, u_1) = (4.688\\times 10^{-4}\\,\\mathrm{m},\\, 9.76\\,\\mathrm{m}/\\mathrm{s})$\n- $(y_2, u_2) = (7.50\\times 10^{-4}\\,\\mathrm{m},\\, 11.04\\,\\mathrm{m}/\\mathrm{s})$\n- $(y_3, u_3) = (1.125\\times 10^{-3}\\,\\mathrm{m},\\, 12.08\\,\\mathrm{m}/\\mathrm{s})$\n- $(y_4, u_4) = (1.875\\times 10^{-3}\\,\\mathrm{m},\\, 13.04\\,\\mathrm{m}/\\mathrm{s})$\n- $(y_5, u_5) = (3.000\\times 10^{-3}\\,\\mathrm{m},\\, 13.92\\,\\mathrm{m}/\\mathrm{s})$\n- $(y_6, u_6) = (4.875\\times 10^{-3}\\,\\mathrm{m},\\, 14.88\\,\\mathrm{m}/\\mathrm{s})$\n- $(y_7, u_7) = (7.875\\times 10^{-3}\\,\\mathrm{m},\\, 15.60\\,\\mathrm{m}/\\mathrm{s})$\n- $(y_8, u_8) = (1.3125\\times 10^{-2}\\,\\mathrm{m},\\, 16.48\\,\\mathrm{m}/\\mathrm{s})$\n\nTasks:\n- Compute $y_i^+ = y_i u_{\\tau}/\\nu$ and $u_i^+ = u_i/u_{\\tau}$ for all points. Use the natural logarithm for $\\ln y^+$.\n- For three ranges of $y^+$, perform an Ordinary Least Squares (OLS) linear regression of $u^+$ versus $\\ln y^+$ to estimate the slope $m$ and intercept $c$: Range R1: $40 \\le y^+ \\le 260$, Range R2: $25 \\le y^+ \\le 100$, Range R3: $260 \\le y^+ \\le 700$. From these $m$ and $c$, infer the physically meaningful constants $\\kappa$ and $B$ associated with the inner logarithmic similarity (justify the mapping).\n- For each range, compute the coefficient of determination $R^2$ to assess goodness of fit.\n- Based on first principles of inner scaling, equilibrium assumptions in the inertial sublayer, and the computed regressions, identify which option best describes the correct estimates of $\\kappa$ and $B$ and the proper interpretation of goodness of fit across ranges, particularly regarding deviations from equilibrium in the buffer layer and outer wake.\n\nChoices:\nA. In Range R1, the regression yields $m \\approx 2.52$ and $c \\approx 4.65$, so $\\kappa \\approx 0.40$ and $B \\approx 4.7$, with $R^2 \\approx 0.998$. In R2, $\\kappa$ and $B$ are biased by buffer-layer viscous effects, while in R3 they are biased by outer-layer wake influences; high $R^2$ outside R1 does not imply equilibrium holds there.\n\nB. Range R2 is most appropriate because it has the highest $R^2$, giving $\\kappa \\approx 0.34$ and $B \\approx 2.7$; these should be adopted globally since the regression is linear in $\\ln y^+$ in that range.\n\nC. Range R3 is preferable because its slope is lower, yielding $\\kappa \\approx 0.50$ and $B \\approx 7.35$; the discrepancies at lower $y^+$ are mainly measurement noise, so the global $\\kappa$ is approximately $0.50$.\n\nD. The choice of logarithm base is immaterial: using base-$10$ instead of the natural logarithm gives identical estimates of $\\kappa$ and $B$, so the best-fit range is unaffected by the log base.\n\nSelect the single best option.",
            "solution": "The user has provided a problem in the field of computational thermal engineering, specifically concerning near-wall modeling for turbulence. The task is to validate the problem statement, perform a series of calculations and regressions on provided data, and select the best explanatory option.\n\n### Step 1: Extract Givens\nThe problem statement provides the following information:\n- Flow configuration: Fully developed turbulent plane channel flow.\n- Fluid: Air at temperature $T \\approx 300\\,\\mathrm{K}$.\n- Kinematic viscosity: $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$.\n- Density: $\\rho = 1.2\\,\\mathrm{kg}/\\mathrm{m}^3$.\n- Channel half-height: $h = 0.05\\,\\mathrm{m}$.\n- Wall friction velocity: $u_{\\tau} = 0.8\\,\\mathrm{m}/\\mathrm{s}$.\n- Friction Reynolds number: $Re_{\\tau} = u_{\\tau} h / \\nu$.\n- Inner-scaled wall coordinate: $y^+ = y u_{\\tau}/\\nu$.\n- Inner-scaled mean velocity: $u^+ = u/u_{\\tau}$.\n- Hypothesis: In the inertial sublayer, $u^+$ is related to $\\ln y^+$ by an affine relation: $u^+ = m \\ln y^+ + c$.\n- Data points $(y_i, u_i)$:\n  - $(y_1, u_1) = (4.688\\times 10^{-4}\\,\\mathrm{m},\\, 9.76\\,\\mathrm{m}/\\mathrm{s})$\n  - $(y_2, u_2) = (7.50\\times 10^{-4}\\,\\mathrm{m},\\, 11.04\\,\\mathrm{m}/\\mathrm{s})$\n  - $(y_3, u_3) = (1.125\\times 10^{-3}\\,\\mathrm{m},\\, 12.08\\,\\mathrm{m}/\\mathrm{s})$\n  - $(y_4, u_4) = (1.875\\times 10^{-3}\\,\\mathrm{m},\\, 13.04\\,\\mathrm{m}/\\mathrm{s})$\n  - $(y_5, u_5) = (3.000\\times 10^{-3}\\,\\mathrm{m},\\, 13.92\\,\\mathrm{m}/\\mathrm{s})$\n  - $(y_6, u_6) = (4.875\\times 10^{-3}\\,\\mathrm{m},\\, 14.88\\,\\mathrm{m}/\\mathrm{s})$\n  - $(y_7, u_7) = (7.875\\times 10^{-3}\\,\\mathrm{m},\\, 15.60\\,\\mathrm{m}/\\mathrm{s})$\n  - $(y_8, u_8) = (1.3125\\times 10^{-2}\\,\\mathrm{m},\\, 16.48\\,\\mathrm{m}/\\mathrm{s})$\n- Regression Ranges:\n  - Range R1: $40 \\le y^+ \\le 260$\n  - Range R2: $25 \\le y^+ \\le 100$\n  - Range R3: $260 \\le y^+ \\le 700$\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is validated against the required criteria:\n- **Scientifically Grounded:** The problem is firmly rooted in the classical theory of turbulent wall-bounded flows. The concepts of the law of the wall, inner scaling ($y^+$, $u^+$), friction velocity ($u_\\tau$), and the logarithmic layer are fundamental principles in fluid mechanics. The physical parameters for air are standard.\n- **Well-Posed:** The problem provides all necessary data and definitions to perform the requested tasks (data transformation, linear regression, and parameter estimation). The tasks are specific and lead to a unique set of results.\n- **Objective:** The problem is stated in precise, quantitative, and unbiased technical language.\n- **Consistency Check:** The friction Reynolds number is calculated as $Re_{\\tau} = u_{\\tau} h / \\nu = (0.8\\,\\mathrm{m}/\\mathrm{s})(0.05\\,\\mathrm{m}) / (1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}) = 0.04 / (1.5\\times 10^{-5}) \\approx 2667$. This is a sufficiently high Reynolds number to expect a distinct logarithmic region, making the investigation of the log-law appropriate. The problem is free of internal contradictions.\n- **Flaw Analysis:** The problem does not violate any of the specified invalidity criteria. It is scientifically sound, formalizable, complete, feasible, well-posed, and non-trivial.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. The solution will be derived as follows.\n\n### Derivation and Analysis\nFirst, we transform the raw data $(y_i, u_i)$ into inner-scaled variables $(y_i^+, u_i^+)$ using the provided constants $u_{\\tau} = 0.8\\,\\mathrm{m}/\\mathrm{s}$ and $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$. The scaling factor for the wall-normal coordinate is $u_{\\tau}/\\nu = 0.8 / (1.5 \\times 10^{-5}) = 53333.\\overline{3}\\,\\mathrm{m}^{-1}$. The scaling factor for velocity is $1/u_{\\tau} = 1/0.8 = 1.25\\,(\\mathrm{s}/\\mathrm{m})$.\n\nThe transformed data points $(y_i^+, u_i^+)$ and the corresponding values of $\\ln y_i^+$ are:\n- $i=1$: $y_1^+ = (4.688\\times 10^{-4}) \\times (53333.\\overline{3}) \\approx 25.0$, $u_1^+ = 9.76 \\times 1.25 = 12.20$, $\\ln(25.0) \\approx 3.219$\n- $i=2$: $y_2^+ = (7.50\\times 10^{-4}) \\times (53333.\\overline{3}) = 40.0$, $u_2^+ = 11.04 \\times 1.25 = 13.80$, $\\ln(40.0) \\approx 3.689$\n- $i=3$: $y_3^+ = (1.125\\times 10^{-3}) \\times (53333.\\overline{3}) = 60.0$, $u_3^+ = 12.08 \\times 1.25 = 15.10$, $\\ln(60.0) \\approx 4.094$\n- $i=4$: $y_4^+ = (1.875\\times 10^{-3}) \\times (53333.\\overline{3}) = 100.0$, $u_4^+ = 13.04 \\times 1.25 = 16.30$, $\\ln(100.0) \\approx 4.605$\n- $i=5$: $y_5^+ = (3.000\\times 10^{-3}) \\times (53333.\\overline{3}) = 160.0$, $u_5^+ = 13.92 \\times 1.25 = 17.40$, $\\ln(160.0) \\approx 5.075$\n- $i=6$: $y_6^+ = (4.875\\times 10^{-3}) \\times (53333.\\overline{3}) \\approx 260.0$, $u_6^+ = 14.88 \\times 1.25 = 18.60$, $\\ln(260.0) \\approx 5.561$\n- $i=7$: $y_7^+ = (7.875\\times 10^{-3}) \\times (53333.\\overline{3}) = 420.0$, $u_7^+ = 15.60 \\times 1.25 = 19.50$, $\\ln(420.0) \\approx 6.040$\n- $i=8$: $y_8^+ = (1.3125\\times 10^{-2}) \\times (53333.\\overline{3}) = 700.0$, $u_8^+ = 16.48 \\times 1.25 = 20.60$, $\\ln(700.0) \\approx 6.551$\n\nThe logarithmic law of the wall states that in the inertial sublayer, $u^+ = \\frac{1}{\\kappa} \\ln y^+ + B$. This is a linear relationship between $u^+$ and $\\ln y^+$. A linear regression of the form $u^+ = m(\\ln y^+) + c$ allows us to estimate the slope $m$ and intercept $c$. The physical constants are then inferred as the von Kármán constant $\\kappa = 1/m$ and the additive constant $B = c$.\n\nWe now perform Ordinary Least Squares (OLS) regression for the specified ranges.\n\n**Range R1: $40 \\le y^+ \\le 260$**\nThis range includes the data points $i=2, 3, 4, 5, 6$. The $(x, y)$ pairs for regression are $(\\ln y^+, u^+)$: $(3.689, 13.80)$, $(4.094, 15.10)$, $(4.605, 16.30)$, $(5.075, 17.40)$, and $(5.561, 18.60)$.\nA precise linear regression on these points yields:\n- Slope: $m \\approx 2.518$\n- Intercept: $c \\approx 4.647$\n- Coefficient of determination: $R^2 \\approx 0.9982$\nFrom these values, we infer the physical constants:\n- $\\kappa = 1/m = 1/2.518 \\approx 0.397$\n- $B = c \\approx 4.647$\nThese results are in excellent agreement with the values presented in option A ($m \\approx 2.52$, $c \\approx 4.65$, $\\kappa \\approx 0.40$, $B \\approx 4.7$, $R^2 \\approx 0.998$). This range, typically cited as starting from $y^+ \\approx 30$ and extending to $y/h \\approx 0.2$ (here, $y^+ \\approx 0.2 Re_\\tau \\approx 533$), is physically the most appropriate candidate for the inertial sublayer, as it avoids both the viscous-dominated buffer layer near the wall and the wake-dominated outer layer.\n\n**Range R2: $25 \\le y^+ \\le 100$**\nThis range includes points $i=1, 2, 3, 4$. The pairs are $(\\ln y^+, u^+)$: $(3.219, 12.20)$, $(3.689, 13.80)$, $(4.094, 15.10)$, and $(4.605, 16.30)$.\nA linear regression yields:\n- Slope: $m \\approx 2.915$\n- Intercept: $c \\approx 2.846$\n- Coefficient of determination: $R^2 \\approx 0.9944$\nThe inferred constants are:\n- $\\kappa = 1/m = 1/2.915 \\approx 0.343$\n- $B = c \\approx 2.846$\nThese results match the values in option B ($\\kappa \\approx 0.34$, $B \\approx 2.7$). This range includes the point at $y^+=25$, which lies in the buffer layer where viscous effects are not negligible. The velocity profile in the buffer layer lies below the logarithmic line, causing the regression to have a steeper slope ($m$ is larger) and a lower intercept ($c$ is smaller). Thus, the estimates of $\\kappa$ and $B$ from this range are biased by viscous effects.\n\n**Range R3: $260 \\le y^+ \\le 700$**\nThis range includes points $i=6, 7, 8$. The pairs are $(\\ln y^+, u^+)$: $(5.561, 18.60)$, $(6.040, 19.50)$, and $(6.551, 20.60)$.\nA linear regression yields:\n- Slope: $m \\approx 2.019$\n- Intercept: $c \\approx 7.39$\n- Coefficient of determination: $R^2 \\approx 0.9996$\nThe inferred constants are:\n- $\\kappa = 1/m = 1/2.019 \\approx 0.495$\n- $B = c \\approx 7.39$\nThese results match the values in option C ($\\kappa \\approx 0.50$, $B \\approx 7.35$). This range extends into the outer part of the channel flow ($y_8/h = 700/2667 \\approx 0.26$). In this wake region, the velocity profile deviates above the logarithmic line. This leads to a regression with a shallower slope ($m$ is smaller) and a higher intercept ($c$ is larger). The estimates of $\\kappa$ and $B$ are therefore biased by outer-layer wake effects.\n\n### Option-by-Option Analysis\n\n**A. In Range R1, the regression yields $m \\approx 2.52$ and $c \\approx 4.65$, so $\\kappa \\approx 0.40$ and $B \\approx 4.7$, with $R^2 \\approx 0.998$. In R2, $\\kappa$ and $B$ are biased by buffer-layer viscous effects, while in R3 they are biased by outer-layer wake influences; high $R^2$ outside R1 does not imply equilibrium holds there.**\n- **Evaluation:** The numerical results computed for Range R1 precisely match those stated in the option. The physical interpretation is correct: Range R1 is the most representative of the inertial sublayer. The explanations for the biased results in R2 (due to buffer-layer effects) and R3 (due to outer-layer wake effects) are fully consistent with turbulence theory. The concluding remark that a high $R^2$ value is a measure of linearity but not necessarily of physical model validity is a critical and correct point in data analysis.\n- **Verdict:** Correct.\n\n**B. Range R2 is most appropriate because it has the highest $R^2$, giving $\\kappa \\approx 0.34$ and $B \\approx 2.7$; these should be adopted globally since the regression is linear in $\\ln y^+$ in that range.**\n- **Evaluation:** The premise that R2 has the highest $R^2$ is false; our calculation shows $R^2_{R2} \\approx 0.9944$ while $R^2_{R3} \\approx 0.9996$. The primary justification for selecting a range must be physical, not solely based on maximizing a statistical metric like $R^2$. Range R2 is physically inappropriate as it is contaminated by buffer layer effects.\n- **Verdict:** Incorrect.\n\n**C. Range R3 is preferable because its slope is lower, yielding $\\kappa \\approx 0.50$ and $B \\approx 7.35$; the discrepancies at lower $y^+$ are mainly measurement noise, so the global $\\kappa$ is approximately $0.50$.**\n- **Evaluation:** The numerical values are consistent with our calculation for R3. However, the reasoning is flawed. Preferring a range because its slope is lower is not a valid scientific argument. The assertion that deviations at lower $y^+$ are \"measurement noise\" is a severe misinterpretation of well-documented physical phenomena (the buffer and log layers). The systematic deviations are not random noise. The resulting $\\kappa \\approx 0.50$ is physically unrealistic for the universal von Kármán constant.\n- **Verdict:** Incorrect.\n\n**D. The choice of logarithm base is immaterial: using base-10 instead of the natural logarithm gives identical estimates of $\\kappa$ and $B$, so the best-fit range is unaffected by the log base.**\n- **Evaluation:** This statement is mathematically false. The relationship between natural logarithm ($\\ln$) and base-10 logarithm ($\\log_{10}$) is $\\ln(x) = \\ln(10) \\log_{10}(x)$. The law of the wall becomes $u^+ = \\frac{\\ln(10)}{\\kappa} \\log_{10}(y^+) + B$. A regression of $u^+$ vs. $\\log_{10}(y^+)$ would yield a new slope $m' = \\frac{\\ln(10)}{\\kappa}$ and the same intercept $c'=B$. The estimate for $B$ would be identical, but the estimate for $\\kappa$ would be derived from a different slope value via $\\kappa = \\ln(10)/m'$. Since the numerical value of the slope changes, the statement that the estimate for $\\kappa$ is \"identical\" is incorrect.\n- **Verdict:** Incorrect.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The law of the wall is not just a theoretical curiosity; it is the cornerstone of \"wall functions\" used in nearly all industrial Computational Fluid Dynamics (CFD) simulations to bridge the near-wall region without resolving it fully. This final practice explores the practical application and, crucially, the limitations of these models. You will quantify the significant errors that arise when a standard equilibrium wall function is misapplied to a non-equilibrium flow, such as one experiencing separation, thereby demonstrating why more sophisticated non-equilibrium models are essential for accurately simulating complex engineering flows .",
            "id": "3975586",
            "problem": "Consider modeling the wall shear stress in turbulent flow within the near-wall region using a coarse mesh where the center of the first off-wall cell is located at a dimensionless wall-normal position $y_P^+ \\approx 100$. In computational simulations based on Reynolds-Averaged Navier–Stokes (RANS), when the mesh is too coarse to resolve the viscous sublayer, a wall function is used to connect the wall shear stress to the velocity at the first near-wall grid point. The equilibrium wall function assumes a statistically steady, fully developed, zero-pressure-gradient boundary layer, in which the turbulence production and dissipation balance locally and the mean velocity follows the logarithmic law of the wall. This assumption is known to break down in separated flows with strong adverse pressure gradients, where non-equilibrium effects are significant. Your task is to quantitatively evaluate the error in the wall shear stress when the equilibrium wall function is applied to a separated flow, and to justify whether a non-equilibrium wall function is necessary.\n\nStart from fundamental principles valid for computational thermal engineering and near-wall turbulence modeling:\n\n- The wall shear stress is defined by $ \\tau_w = \\mu \\left.\\frac{\\partial u}{\\partial y}\\right|_{wall} $, where $ \\mu $ is the dynamic viscosity, $ u $ is the mean tangential velocity, and $ y $ is the wall-normal coordinate.\n- The friction velocity is defined by $ u_\\tau = \\sqrt{\\frac{\\tau_w}{\\rho}} $, where $ \\rho $ is the fluid density.\n- The dimensionless quantities are defined as $ u^+ = \\frac{u}{u_\\tau} $ and $ y^+ = \\frac{y u_\\tau}{\\nu} $, where $ \\nu = \\frac{\\mu}{\\rho} $ is the kinematic viscosity.\n- The equilibrium logarithmic law of the wall states that, in an attached turbulent boundary layer under equilibrium conditions, the dimensionless velocity at the near-wall position obeys $ u^+(y^+) = \\frac{1}{\\kappa} \\ln(y^+) + B $, where $ \\kappa $ is the von Kármán constant and $ B $ is an empirical constant.\n- The equilibrium wall function infers the wall shear stress by inverting the log-law at the first off-wall point to obtain $ u_\\tau $, and then computing $ \\tau_w = \\rho u_\\tau^2 $.\n\nConstruct an algorithm that, given the local mean tangential velocity $ u_P $ at the first off-wall point, applies the equilibrium wall function at $ y_P^+ = 100 $ to predict the wall shear stress $ \\tau_w^{eq} $ and compares it against a reference “true” wall shear stress $ \\tau_w^{true} $. The reference wall shear stress represents the correct value at the wall when separation or strong non-equilibrium effects exist, and is determined from a near-wall velocity gradient (for example, a high-resolution reference solution) via $ \\tau_w^{true} = \\mu \\left.\\frac{\\partial u}{\\partial y}\\right|_{wall} $. For the test suite below, you are provided $ \\tau_w^{true} $ directly. Quantify the relative error as\n$$ e = \\frac{\\left| \\tau_w^{eq} - \\tau_w^{true} \\right|}{\\tau_w^{true}}. $$\nExpress $ e $ as a decimal (unitless).\n\nUse the following constants throughout:\n- Fluid density $ \\rho = 1.2 \\ \\mathrm{kg/m^3} $,\n- Dynamic viscosity $ \\mu = 1.8\\times 10^{-5} \\ \\mathrm{kg/(m\\cdot s)} $,\n- Kinematic viscosity $ \\nu = \\mu / \\rho $,\n- Von Kármán constant $ \\kappa = 0.41 $,\n- Log-law constant $ B = 5.2 $,\n- Near-wall location $ y_P^+ = 100 $.\n\nAlgorithm design requirements:\n1. For each test case, compute $ u_\\tau^{eq} $ by inverting the logarithmic law of the wall at $ y_P^+ = 100 $ using the given $ u_P $:\n   $$ u_\\tau^{eq} = \\frac{u_P}{\\frac{1}{\\kappa}\\ln(y_P^+) + B}. $$\n2. Compute $ \\tau_w^{eq} = \\rho \\left( u_\\tau^{eq} \\right)^2 $.\n3. Compute the relative error $ e $ using the provided $ \\tau_w^{true} $.\n4. Decide whether a non-equilibrium wall function is necessary using the following model selection criterion: if $e > 0.5$ then output the boolean value “true” indicating that a non-equilibrium wall function is necessary; otherwise output “false”.\n\nPhysical units:\n- $ u_P $ must be in $ \\mathrm{m/s} $,\n- $ \\tau_w^{true} $ and $ \\tau_w^{eq} $ must be in Pascal ($ \\mathrm{Pa} $),\n- $ e $ must be a unitless decimal.\n\nTest suite:\n- Case A (attached, equilibrium-consistent baseline): $ \\tau_w^{true} = 0.1 \\ \\mathrm{Pa} $. Let $ u_P $ be exactly the equilibrium log-law value at $ y_P^+ = 100 $, that is $ u_P = u_\\tau^{true}\\left(\\frac{1}{\\kappa}\\ln(y_P^+) + B\\right) $ with $ u_\\tau^{true} = \\sqrt{\\tau_w^{true}/\\rho} $.\n- Case B (mild adverse pressure gradient, beginning of separation effects): $ \\tau_w^{true} = 0.01 \\ \\mathrm{Pa} $, $ u_P = 3.0 \\ \\mathrm{m/s} $.\n- Case C (strong separation, near-zero wall shear): $ \\tau_w^{true} = 0.001 \\ \\mathrm{Pa} $, $ u_P = 2.0 \\ \\mathrm{m/s} $.\n- Case D (stagnation-like at the coarse cell center): $ \\tau_w^{true} = 0.005 \\ \\mathrm{Pa} $, $ u_P = 0.0 \\ \\mathrm{m/s} $.\n\nYour program should produce a single line of output containing the results for Cases A–D as a comma-separated list enclosed in square brackets, where each element is a two-item list $ [e, \\text{need}] $ with $ e $ as a decimal and $ \\text{need} $ as a boolean. For example, the output format must be\n$$ [ [e_A,\\text{need}_A],[e_B,\\text{need}_B],[e_C,\\text{need}_C],[e_D,\\text{need}_D] ]. $$",
            "solution": "The problem statement is evaluated to be scientifically sound, well-posed, and objective. It presents a standard, albeit simplified, exercise in computational fluid dynamics (CFD) concerning the application and limitation of equilibrium wall functions in Reynolds-Averaged Navier-Stokes (RANS) modeling of turbulent flows. All necessary physical constants, mathematical definitions, and algorithmic steps are provided, forming a self-contained and solvable problem. There are no contradictions, ambiguities, or violations of fundamental principles. We may therefore proceed with a formal solution.\n\nThe primary objective is to quantify the error incurred by using an equilibrium wall function, which is based on the logarithmic law of the wall, to predict wall shear stress in flow regimes that deviate from the assumed equilibrium conditions. Such non-equilibrium conditions are characteristic of flows with strong pressure gradients, particularly near separation.\n\nThe fundamental quantities are defined as follows:\n- Fluid density: $ \\rho $.\n- Dynamic viscosity: $ \\mu $.\n- Kinematic viscosity: $ \\nu = \\mu / \\rho $.\n- Mean tangential velocity at a wall-normal distance $y$: $u(y)$.\n- Wall shear stress: $ \\tau_w = \\mu \\left.\\frac{\\partial u}{\\partial y}\\right|_{y=0} $.\n- Friction velocity: $ u_\\tau = \\sqrt{\\tau_w / \\rho} $.\n- Dimensionless velocity: $ u^+ = u / u_\\tau $.\n- Dimensionless wall distance: $ y^+ = y u_\\tau / \\nu $.\n\nThe equilibrium logarithmic law of the wall, valid for the logarithmic layer of an attached, zero-pressure-gradient turbulent boundary layer, is given by:\n$$ u^+(y^+) = \\frac{1}{\\kappa} \\ln(y^+) + B $$\nwhere $ \\kappa $ is the von Kármán constant and $ B $ is the log-law intercept. A wall function leverages this law to bridge the near-wall region in a coarse mesh, relating the velocity at the first grid point $ P $ (at wall distance $ y_P $) to the wall shear stress $ \\tau_w $.\n\nThe algorithm prescribed is to compute the wall shear stress predicted by the equilibrium model, $ \\tau_w^{eq} $, and compare it to a given true value, $ \\tau_w^{true} $.\nThe first step is to rearrange the log-law to solve for the friction velocity. Given the velocity $ u_P $ at the first grid point, which is assumed to lie at a fixed dimensionless height $ y_P^+ $, the dimensionless velocity is $ u_P^+ = u_P / u_\\tau^{eq} $. Substituting this into the log-law:\n$$ \\frac{u_P}{u_\\tau^{eq}} = \\frac{1}{\\kappa} \\ln(y_P^+) + B $$\nSolving for the equilibrium friction velocity, $ u_\\tau^{eq} $:\n$$ u_\\tau^{eq} = \\frac{u_P}{\\frac{1}{\\kappa} \\ln(y_P^+) + B} $$\nThe corresponding equilibrium wall shear stress is then calculated as:\n$$ \\tau_w^{eq} = \\rho (u_\\tau^{eq})^2 $$\nThe relative error $ e $ is computed to quantify the model's inaccuracy:\n$$ e = \\frac{\\left| \\tau_w^{eq} - \\tau_w^{true} \\right|}{\\tau_w^{true}} $$\nA non-equilibrium wall function is deemed necessary if this error exceeds a threshold, specified as $ e > 0.5 $.\n\nThe following constants are used for the calculations:\n- $ \\rho = 1.2 \\ \\mathrm{kg/m^3} $\n- $ \\mu = 1.8 \\times 10^{-5} \\ \\mathrm{kg/(m\\cdot s)} $\n- $ \\nu = \\mu / \\rho = 1.5 \\times 10^{-5} \\ \\mathrm{m^2/s} $\n- $ \\kappa = 0.41 $\n- $ B = 5.2 $\n- $ y_P^+ = 100 $\n\nFirst, we compute the constant denominator term from the inverted log-law, which we shall denote $ C $:\n$$ C = \\frac{1}{\\kappa} \\ln(y_P^+) + B = \\frac{1}{0.41} \\ln(100) + 5.2 \\approx 2.439024 \\times 4.605170 + 5.2 \\approx 11.232122 + 5.2 = 16.432122 $$\n\nNow, we proceed with the analysis for each test case.\n\n**Case A: Attached, equilibrium-consistent baseline**\n- Given: $ \\tau_w^{true} = 0.1 \\ \\mathrm{Pa} $.\n- The velocity $ u_P $ is set to be perfectly consistent with the equilibrium log-law for the given $ \\tau_w^{true} $.\n- First, we calculate the true friction velocity $ u_\\tau^{true} $:\n  $$ u_\\tau^{true} = \\sqrt{\\frac{\\tau_w^{true}}{\\rho}} = \\sqrt{\\frac{0.1}{1.2}} \\approx 0.288675 \\ \\mathrm{m/s} $$\n- Next, we calculate $ u_P $ using the log-law:\n  $$ u_P = u_\\tau^{true} \\left( \\frac{1}{\\kappa} \\ln(y_P^+) + B \\right) = u_\\tau^{true} \\times C \\approx 0.288675 \\ \\mathrm{m/s} \\times 16.432122 \\approx 4.74396 \\ \\mathrm{m/s} $$\n- Now, we apply the wall function algorithm with this $ u_P $:\n  $$ u_\\tau^{eq} = \\frac{u_P}{C} = \\frac{u_\\tau^{true} \\times C}{C} = u_\\tau^{true} \\approx 0.288675 \\ \\mathrm{m/s} $$\n- The predicted wall shear stress is:\n  $$ \\tau_w^{eq} = \\rho (u_\\tau^{eq})^2 = \\rho (u_\\tau^{true})^2 = \\tau_w^{true} = 0.1 \\ \\mathrm{Pa} $$\n- The relative error $ e_A $ is:\n  $$ e_A = \\frac{\\left| 0.1 - 0.1 \\right|}{0.1} = 0.0 $$\n- The decision criterion $ e_A > 0.5 $ is not met. Thus, a non-equilibrium model is not necessary, which is expected. The result is $ [0.0, \\text{false}] $.\n\n**Case B: Mild adverse pressure gradient**\n- Given: $ \\tau_w^{true} = 0.01 \\ \\mathrm{Pa} $, $ u_P = 3.0 \\ \\mathrm{m/s} $.\n- We apply the wall function algorithm to find the predicted shear stress:\n  $$ u_\\tau^{eq} = \\frac{u_P}{C} = \\frac{3.0}{16.432122} \\approx 0.182570 \\ \\mathrm{m/s} $$\n- The predicted wall shear stress is:\n  $$ \\tau_w^{eq} = \\rho (u_\\tau^{eq})^2 = 1.2 \\times (0.182570)^2 \\approx 1.2 \\times 0.033331 \\approx 0.039998 \\ \\mathrm{Pa} $$\n- The relative error $ e_B $ is:\n  $$ e_B = \\frac{\\left| 0.039998 - 0.01 \\right|}{0.01} = \\frac{0.029998}{0.01} \\approx 2.9998 $$\n- The decision criterion $ e_B > 0.5 $ is met. A non-equilibrium model is necessary. The result is approximately $ [3.0, \\text{true}] $.\n\n**Case C: Strong separation, near-zero wall shear**\n- Given: $ \\tau_w^{true} = 0.001 \\ \\mathrm{Pa} $, $ u_P = 2.0 \\ \\mathrm{m/s} $.\n- In this scenario, the velocity profile is significantly distorted from the log-law due to strong adverse pressure gradients and flow separation.\n- We apply the wall function algorithm:\n  $$ u_\\tau^{eq} = \\frac{u_P}{C} = \\frac{2.0}{16.432122} \\approx 0.121713 \\ \\mathrm{m/s} $$\n- The predicted wall shear stress is:\n  $$ \\tau_w^{eq} = \\rho (u_\\tau^{eq})^2 = 1.2 \\times (0.121713)^2 \\approx 1.2 \\times 0.014814 \\approx 0.017777 \\ \\mathrm{Pa} $$\n- The relative error $ e_C $ is:\n  $$ e_C = \\frac{\\left| 0.017777 - 0.001 \\right|}{0.001} = \\frac{0.016777}{0.001} = 16.777 $$\n- The decision criterion $ e_C > 0.5 $ is met. The error is very large, strongly indicating the failure of the equilibrium model. The result is approximately $ [16.777, \\text{true}] $.\n\n**Case D: Stagnation-like at the coarse cell center**\n- Given: $ \\tau_w^{true} = 0.005 \\ \\mathrm{Pa} $, $ u_P = 0.0 \\ \\mathrm{m/s} $.\n- This case represents a region of reversed or stagnant flow near the wall, where the velocity at the first grid point is zero.\n- We apply the wall function algorithm:\n  $$ u_\\tau^{eq} = \\frac{u_P}{C} = \\frac{0.0}{16.432122} = 0.0 \\ \\mathrm{m/s} $$\n- The predicted wall shear stress is:\n  $$ \\tau_w^{eq} = \\rho (u_\\tau^{eq})^2 = 1.2 \\times (0.0)^2 = 0.0 \\ \\mathrm{Pa} $$\n- This case illustrates a critical flaw in this simple wall function: a zero velocity at the cell center forces a prediction of zero wall shear, regardless of the true near-wall velocity gradient.\n- The relative error $ e_D $ is:\n  $$ e_D = \\frac{\\left| 0.0 - 0.005 \\right|}{0.005} = \\frac{0.005}{0.005} = 1.0 $$\n- The decision criterion $ e_D > 0.5 $ is met. The model is 100% in error, and a non-equilibrium model is necessary. The result is $ [1.0, \\text{true}] $.\n\nIn summary, the equilibrium wall function is only accurate when the flow conditions precisely match its underlying assumption (Case A). As the flow deviates due to adverse pressure gradients and separation (Cases B, C, and D), the velocity profile no longer conforms to the log-law, and the wall function's predictions degrade severely, leading to large errors in wall shear stress. This analysis quantitatively justifies the need for more sophisticated non-equilibrium wall functions in complex turbulent flows.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of evaluating wall shear stress error using an equilibrium\n    wall function in various flow scenarios.\n    \"\"\"\n\n    # --- Constants and Givens ---\n    rho = 1.2  # kg/m^3\n    mu = 1.8e-5  # kg/(m*s)\n    kappa = 0.41\n    B = 5.2\n    y_p_plus = 100.0\n\n    # --- Algorithm Setup ---\n    # Pre-calculate the constant part of the wall function equation.\n    # C = 1/kappa * ln(y_p^+) + B\n    log_law_constant = (1 / kappa) * np.log(y_p_plus) + B\n\n    def calculate_wall_function_error(u_p, tau_w_true):\n        \"\"\"\n        Applies the equilibrium wall function and calculates the relative error.\n\n        Args:\n            u_p (float): Mean tangential velocity at the first off-wall point (m/s).\n            tau_w_true (float): The reference \"true\" wall shear stress (Pa).\n\n        Returns:\n            tuple[float, bool]: A tuple containing the relative error and a boolean\n                                indicating if a non-equilibrium model is needed.\n        \"\"\"\n        # Step 1: Compute u_tau_eq\n        # This handles the u_p = 0 case gracefully.\n        u_tau_eq = u_p / log_law_constant\n\n        # Step 2: Compute tau_w_eq\n        tau_w_eq = rho * (u_tau_eq**2)\n\n        # Step 3: Compute the relative error e\n        # The problem guarantees tau_w_true is non-zero, so no division by zero.\n        error = abs(tau_w_eq - tau_w_true) / tau_w_true\n\n        # Step 4: Decide if a non-equilibrium wall function is necessary\n        is_needed = error > 0.5\n\n        return error, is_needed\n\n    # --- Test Suite ---\n    # Case A: Attached, equilibrium-consistent baseline\n    tau_w_true_A = 0.1\n    u_tau_true_A = np.sqrt(tau_w_true_A / rho)\n    u_p_A = u_tau_true_A * log_law_constant\n\n    # Case B: Mild adverse pressure gradient\n    tau_w_true_B = 0.01\n    u_p_B = 3.0\n\n    # Case C: Strong separation, near-zero wall shear\n    tau_w_true_C = 0.001\n    u_p_C = 2.0\n\n    # Case D: Stagnation-like at the coarse cell center\n    tau_w_true_D = 0.005\n    u_p_D = 0.0\n\n    test_cases = [\n        (u_p_A, tau_w_true_A),\n        (u_p_B, tau_w_true_B),\n        (u_p_C, tau_w_true_C),\n        (u_p_D, tau_w_true_D),\n    ]\n\n    # --- Execution and Output Formatting ---\n    results_list = []\n    for u_p, tau_w_true in test_cases:\n        error, needed = calculate_wall_function_error(u_p, tau_w_true)\n        # Using general float-to-string conversion as no specific precision is requested.\n        # Python's str() for a float is usually sufficient.\n        # The problem asks for the boolean value to be 'true' or 'false' (lowercase).\n        needed_str = \"true\" if needed else \"false\"\n        results_list.append(f\"[{error},{needed_str}]\")\n\n    # Final print statement in the exact required format.\n    final_output = f\"[{','.join(results_list)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}