{
    "hands_on_practices": [
        {
            "introduction": "本练习通过解决一个经典的双表面闭合体问题来巩固您对辐射度基本原理的理解 。您将直接从能量守恒推导出控制方程，然后独立地使用强大的电阻网络类比法解决同一问题。这项实践证明了这些方法的等效性，并加深了您对辐射交换的直观认识。",
            "id": "3958654",
            "problem": "考虑两个大的、平行的、等温的、不透明的板，标记为表面 $1$ 和表面 $2$，它们隔着真空间隙相对。它们之间的介质是不参与的（无吸收、发射或散射），且表面是灰体和漫射的。每个板完全只能看到另一个板（即角系数 $F_{12} = 1$ 且没有辐射逃逸出这个双表面系统）。板的面积相等，均为 $A$，发射率分别为 $\\epsilon_{1}$ 和 $\\epsilon_{2}$，绝对温度分别为 $T_{1}$ 和 $T_{2}$。令斯蒂芬-玻尔兹曼常数为 $\\sigma$，黑体发射功率为 $E_{b,i} = \\sigma T_{i}^{4}$（对于表面 $i$）。\n\n仅从表面能量守恒、灰体漫射表面的辐射度和辐照度的定义以及角系数关系出发，完成以下任务：\n\n1. 为未知辐射度 $J_{1}$ 和 $J_{2}$ 建立两个耦合线性方程。\n2. 通过直接求解这些方程，得到 $J_{1}$ 和 $J_{2}$ 的闭式表达式。\n3. 独立地，使用表面电阻和空间电阻为此双表面系统构建辐射电网络类比模型，并推导从表面 $1$ 到表面 $2$ 的净辐射传热率 $Q$。\n4. 证明电网络模型得到的 $Q$ 结果与从辐射度解法得到的结果相同，并且 $J_{1}$ 和 $J_{2}$ 的两个表达式与相同的 $Q$ 值相符。\n\n将最终答案表示为一个单行矩阵，其中包含以 $\\epsilon_{1}$、$\\epsilon_{2}$、$\\sigma$、$T_{1}$、$T_{2}$ 和 $A$ 表示的三个闭式表达式 $(J_{1}, J_{2}, Q)$。无需四舍五入。最终表达式中不包含单位。",
            "solution": "该问题具有科学依据，提法明确，客观公正，为辐射传热中的一个标准问题提供了一套完整且一致的已知条件。因此，该问题被认为是有效的。解答过程将系统地解决四个要求的任务。\n\n分析从构成一个系统的两个不透明、漫射、灰体表面之间的辐射交换的基本原理开始。表面标记为 $1$ 和 $2$，面积为 $A_1 = A_2 = A$，发射率分别为 $\\epsilon_1$ 和 $\\epsilon_2$，并分别保持在绝对温度 $T_1$ 和 $T_2$。\n\n表面 $i$ 的辐射度 $J_i$ 定义为离开该表面的总辐射能流。对于一个不透明、漫射、灰体表面，它是发射和反射辐射的总和：\n$$ J_i = E_i + \\rho_i G_i $$\n其中 $E_i$ 是发射功率，$\\rho_i$ 是反射率，而 $G_i$ 是辐照度（入射辐射能流）。发射功率为 $E_i = \\epsilon_i E_{b,i}$，其中 $E_{b,i} = \\sigma T_i^4$ 是黑体发射功率。对于不透明表面，入射辐射的能量守恒要求吸收率 $\\alpha_i$ 和反射率 $\\rho_i$ 之和为1，即 $\\alpha_i + \\rho_i = 1$。对于灰体表面，发射率等于吸收率，即 $\\epsilon_i = \\alpha_i$。因此，反射率为 $\\rho_i = 1 - \\epsilon_i$。将这些关系代入辐射度定义中，得到：\n$$ J_i = \\epsilon_i E_{b,i} + (1 - \\epsilon_i) G_i $$\n表面 $i$ 上的辐照度 $G_i$ 是系统中所有表面辐射度的总和，并由各自的角系数加权。对于一个 $N$ 表面系统：\n$$ G_i = \\sum_{j=1}^{N} F_{ji} J_j $$\n在这个双表面系统中，板是大的且平行的，因此每个表面只看到另一个表面。这意味着角系数 $F_{12}=1$ 和 $F_{21}=1$（这与互易关系 $A_1 F_{12} = A_2 F_{21}$ 一致，因为 $A_1=A_2$）。此外，由于表面是平的，它们看不到自身，因此 $F_{11}=0$ 和 $F_{22}=0$。\n\n表面 $1$ 上的辐照度仅来自表面 $2$：$G_1 = F_{21} J_2 = (1)J_2 = J_2$。\n表面 $2$ 上的辐照度仅来自表面 $1$：$G_2 = F_{12} J_1 = (1)J_1 = J_1$。\n\n1. 为 $J_1$ 和 $J_2$ 建立两个耦合线性方程。\n\n将辐照度的表达式代入每个表面的辐射度方程，得到以下方程组。\n\n对于表面 $1$：\n$$ J_1 = \\epsilon_1 E_{b,1} + (1 - \\epsilon_1) G_1 = \\epsilon_1 E_{b,1} + (1 - \\epsilon_1) J_2 $$\n整理成标准线性形式：\n$$ J_1 - (1 - \\epsilon_1) J_2 = \\epsilon_1 E_{b,1} $$\n\n对于表面 $2$：\n$$ J_2 = \\epsilon_2 E_{b,2} + (1 - \\epsilon_2) G_2 = \\epsilon_2 E_{b,2} + (1 - \\epsilon_2) J_1 $$\n整理成标准线性形式：\n$$ -(1 - \\epsilon_2) J_1 + J_2 = \\epsilon_2 E_{b,2} $$\n这两个方程构成了未知辐射度 $J_1$ 和 $J_2$ 的耦合线性系统。\n\n2. 求解 $J_1$ 和 $J_2$。\n\n我们求解一个二元线性方程组。从第二个方程中，我们将 $J_2$ 表示为 $J_1$ 的函数：\n$$ J_2 = \\epsilon_2 E_{b,2} + (1 - \\epsilon_2) J_1 $$\n将这个 $J_2$ 的表达式代入第一个方程：\n$$ J_1 - (1 - \\epsilon_1) [\\epsilon_2 E_{b,2} + (1 - \\epsilon_2) J_1] = \\epsilon_1 E_{b,1} $$\n$$ J_1 - (1 - \\epsilon_1)\\epsilon_2 E_{b,2} - (1 - \\epsilon_1)(1 - \\epsilon_2) J_1 = \\epsilon_1 E_{b,1} $$\n合并包含 $J_1$ 的项：\n$$ J_1 [1 - (1 - \\epsilon_1)(1 - \\epsilon_2)] = \\epsilon_1 E_{b,1} + (1 - \\epsilon_1)\\epsilon_2 E_{b,2} $$\n$J_1$ 的系数简化为：\n$$ 1 - (1 - \\epsilon_1 - \\epsilon_2 + \\epsilon_1 \\epsilon_2) = \\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2 $$\n求解 $J_1$：\n$$ J_1 = \\frac{\\epsilon_1 E_{b,1} + (1 - \\epsilon_1)\\epsilon_2 E_{b,2}}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} $$\n根据问题的几何对称性和控制方程，通过交换所有下标 $1$ 和 $2$ 可以得到 $J_2$ 的表达式：\n$$ J_2 = \\frac{\\epsilon_2 E_{b,2} + (1 - \\epsilon_2)\\epsilon_1 E_{b,1}}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} $$\n\n3. 使用电网络类比模型推导净辐射传热率 $Q$。\n\n辐射网络类比将传热模拟为流经一系列电阻的电流。每个节点的电位是黑体发射功率 $E_{b,i}$ 或辐射度 $J_i$。\n\n灰体漫射表面 $i$ 的表面电阻 $R_{\\text{surf},i}$ 将其黑体电位与其辐射度电位联系起来。它由下式给出：\n$$ R_{\\text{surf},i} = \\frac{1 - \\epsilon_i}{\\epsilon_i A_i} $$\n两个表面 $i$ 和 $j$ 之间的空间电阻 $R_{\\text{space},ij}$ 考虑了几何构型（角系数），由下式给出：\n$$ R_{\\text{space},ij} = \\frac{1}{A_i F_{ij}} $$\n对于给定的双表面系统，网络是一个简单的串联电路：\n$E_{b,1} \\rightarrow R_{\\text{surf},1} \\rightarrow J_1 \\rightarrow R_{\\text{space},12} \\rightarrow J_2 \\rightarrow R_{\\text{surf},2} \\rightarrow E_{b,2}$\n\n电阻为：\n$R_{\\text{surf},1} = \\frac{1 - \\epsilon_1}{\\epsilon_1 A}$\n$R_{\\text{space},12} = \\frac{1}{A_1 F_{12}} = \\frac{1}{A \\cdot 1} = \\frac{1}{A}$\n$R_{\\text{surf},2} = \\frac{1 - \\epsilon_2}{\\epsilon_2 A}$\n\n网络的总电阻 $R_{\\text{total}}$ 是串联电阻之和：\n$$ R_{\\text{total}} = R_{\\text{surf},1} + R_{\\text{space},12} + R_{\\text{surf},2} = \\frac{1 - \\epsilon_1}{\\epsilon_1 A} + \\frac{1}{A} + \\frac{1 - \\epsilon_2}{\\epsilon_2 A} $$\n$$ R_{\\text{total}} = \\frac{1}{A} \\left( \\frac{1}{\\epsilon_1} - 1 + 1 + \\frac{1}{\\epsilon_2} - 1 \\right) = \\frac{1}{A} \\left( \\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1 \\right) $$\n从表面 $1$ 到表面 $2$ 的净传热率 $Q$ 是总电位差除以总电阻：\n$$ Q = \\frac{E_{b,1} - E_{b,2}}{R_{\\text{total}}} = \\frac{\\sigma (T_1^4 - T_2^4)}{\\frac{1}{A} \\left( \\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1 \\right)} = \\frac{A \\sigma (T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} $$\n\n4. 证明辐射度解法和网络解法之间的一致性。\n\n首先，我们证明从辐射度解法计算出的净传热率与网络结果相匹配。离开表面 $1$ 的净传热率为 $Q_1 = A_1 (J_1 - G_1)$。由于 $G_1 = J_2$ 且 $A_1=A$：\n$$ Q_1 = A (J_1 - J_2) $$\n代入第2部分中 $J_1$ 和 $J_2$ 的表达式：\n$$ J_1 - J_2 = \\frac{1}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} \\left[ (\\epsilon_1 E_{b,1} + (1 - \\epsilon_1)\\epsilon_2 E_{b,2}) - (\\epsilon_2 E_{b,2} + (1 - \\epsilon_2)\\epsilon_1 E_{b,1}) \\right] $$\n$$ J_1 - J_2 = \\frac{1}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} [(\\epsilon_1 - \\epsilon_1(1-\\epsilon_2)) E_{b,1} - (\\epsilon_2 - \\epsilon_2(1-\\epsilon_1)) E_{b,2}] $$\n$$ J_1 - J_2 = \\frac{1}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} [\\epsilon_1 \\epsilon_2 E_{b,1} - \\epsilon_1 \\epsilon_2 E_{b,2}] = \\frac{\\epsilon_1 \\epsilon_2 (E_{b,1} - E_{b,2})}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} $$\n所以，传热率为：\n$$ Q_1 = A (J_1 - J_2) = \\frac{A \\epsilon_1 \\epsilon_2 (E_{b,1} - E_{b,2})}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} $$\n这个表达式可以通过将分子和分母同时除以 $\\epsilon_1 \\epsilon_2$ 来改写：\n$$ Q_1 = \\frac{A (E_{b,1} - E_{b,2})}{\\frac{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}{\\epsilon_1 \\epsilon_2}} = \\frac{A (E_{b,1} - E_{b,2})}{\\frac{1}{\\epsilon_2} + \\frac{1}{\\epsilon_1} - 1} $$\n这与从网络类比模型推导出的净传热率 $Q$ 完全相同。\n\n其次，我们证明 $J_1$ 和 $J_2$ 的表达式与网络结果一致。从网络模型看，传热率 $Q$ 必须等于第一个表面电阻上的电位降：\n$$ Q = \\frac{E_{b,1} - J_1}{R_{\\text{surf},1}} = \\frac{E_{b,1} - J_1}{(1 - \\epsilon_1)/(\\epsilon_1 A)} $$\n求解 $J_1$：\n$$ J_1 = E_{b,1} - Q \\cdot R_{\\text{surf},1} = E_{b,1} - \\frac{A (E_{b,1} - E_{b,2})}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} \\cdot \\frac{1 - \\epsilon_1}{\\epsilon_1 A} $$\n$$ J_1 = E_{b,1} - \\frac{(E_{b,1} - E_{b,2})(\\frac{1}{\\epsilon_1} - 1)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} $$\n通分后得到：\n$$ J_1 = \\frac{E_{b,1}(\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1) - (E_{b,1} - E_{b,2})(\\frac{1}{\\epsilon_1} - 1)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} $$\n展开分子：\n$$ \\frac{E_{b,1}}{\\epsilon_1} + \\frac{E_{b,1}}{\\epsilon_2} - E_{b,1} - \\frac{E_{b,1}}{\\epsilon_1} + E_{b,1} + \\frac{E_{b,2}}{\\epsilon_1} - E_{b,2} = \\frac{E_{b,1}}{\\epsilon_2} + \\frac{E_{b,2}}{\\epsilon_1} - E_{b,2} = \\frac{\\epsilon_1 E_{b,1} + \\epsilon_2 E_{b,2} - \\epsilon_1 \\epsilon_2 E_{b,2}}{\\epsilon_1 \\epsilon_2} $$\n分母为：\n$$ \\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1 = \\frac{\\epsilon_2 + \\epsilon_1 - \\epsilon_1 \\epsilon_2}{\\epsilon_1 \\epsilon_2} $$\n用分子除以分母得到：\n$$ J_1 = \\frac{\\epsilon_1 E_{b,1} + (1 - \\epsilon_1)\\epsilon_2 E_{b,2}}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} $$\n这个表达式与第2部分得到的 $J_1$ 结果完全相同。对 $J_2 = E_{b,2} + Q \\cdot R_{\\text{surf},2}$ 进行类似的推导可以证实 $J_2$ 的表达式。两种方法完全一致。\n\n最终 $J_1$、$J_2$ 和 $Q$ 的表达式用给定变量表示如下。\n$J_1 = \\frac{\\sigma(\\epsilon_1 T_1^4 + (1 - \\epsilon_1)\\epsilon_2 T_2^4)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}$\n$J_2 = \\frac{\\sigma(\\epsilon_2 T_2^4 + (1 - \\epsilon_2)\\epsilon_1 T_1^4)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}$\n$Q = \\frac{A \\sigma (T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\sigma(\\epsilon_1 T_1^4 + (1 - \\epsilon_1)\\epsilon_2 T_2^4)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}  \\frac{\\sigma(\\epsilon_2 T_2^4 + (1 - \\epsilon_2)\\epsilon_1 T_1^4)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}  \\frac{A \\sigma (T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1} \\end{pmatrix} } $$"
        },
        {
            "introduction": "漫反射假设是简化辐射分析的基石，但对于专家而言，理解其局限性至关重要 。本练习要求您通过使用更真实的双向反射分布函数 (BRDF) 来模拟一个光滑的镜面，从而构建一个反例。通过将其结果与漫反射模型的预测进行比较，您将对这一基本假设在何种情况下以及为何会失效获得清晰、定量的理解。",
            "id": "3958652",
            "problem": "考虑一个面积为 $A$ 的不透明、等温、抛光的表面面元，该面元置于真空罩中。一束辐照度为 $G_0$ 的单色准直光束垂直入射到该面元上，因此入射方向 $\\boldsymbol{\\omega}_i$ 与外表面法线 $\\boldsymbol{n}$ 重合。假设该表面是灰体，其定向半球反射率 $\\rho \\in (0,1)$ 在所关注的窄波段内与波长无关。\n\n一个具有小接收立体角 $\\Delta \\Omega$ 的探测器被放置在从 $\\boldsymbol{n}$ 测量的极角 $\\theta_d \\in (0,\\pi/2)$ 处的方向 $\\boldsymbol{\\omega}_o$ 上观察该面元；假设轴向对称，因此方位角无关紧要。探测器距离足够远，使得面元看起来是局部平面的，并且接收立体角 $\\Delta \\Omega$ 足够小，可以忽略 $\\Delta \\Omega$ 内部的角度变化。角度应以弧度处理。\n\n使用辐射传输基本原理，定义辐射亮度 $L$ 和辐照度 $E$，并回顾对于任何其散射特性完全由双向反射分布函数 (BRDF) 表征的表面，出射辐射亮度满足 $L_o(\\boldsymbol{\\omega}_o) = f_r(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\,E_i(\\boldsymbol{\\omega}_i)$，并带有能量守恒约束 $\\int_{\\Omega^{+}} f_r(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\,\\cos\\theta_o\\,\\mathrm{d}\\Omega_o = \\rho$，其中 $\\Omega^{+}$ 表示出射半球，$\\theta_o$ 是 $\\boldsymbol{\\omega}_o$ 相对于 $\\boldsymbol{n}$ 的极角。\n\n现在，通过使用一个关于镜面反射方向的 Phong 型波瓣的归一化纯镜面 BRDF 对抛光表面进行建模，构建一个漫反射假设的反例。对于垂直入射，镜面反射方向与 $\\boldsymbol{n}$ 重合；假设 BRDF 的形式为\n$$\nf_r^{\\mathrm{spec}}(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o) = \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_o\\big)^{n},\n$$\n其中 $n0$ 是镜面指数。相比之下，漫反射（朗伯）假设对应的 BRDF 为 $f_r^{\\mathrm{diff}}(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o) = \\rho/\\pi$。\n\n仅使用上述定义和能量守恒，推导在漫反射假设下预测的探测器功率 $P_{\\mathrm{diff}}$ 和在给定几何结构下镜面 BRDF 的物理正确探测器功率 $P_{\\mathrm{spec}}$，并获得比率的解析表达式\n$$\nR(\\theta_d,n) = \\frac{P_{\\mathrm{diff}}}{P_{\\mathrm{spec}}}.\n$$\n您的最终答案必须是 $R(\\theta_d,n)$ 的单一闭式解析表达式，角度以弧度为单位。不代入任何数值，也无需四舍五入。从辐射传输的第一性原理和灰体表面能量守恒约束出发，解释每一步，并证明镜面 BRDF 归一化的合理性。最后明确写出 $R(\\theta_d,n)$。",
            "solution": "首先验证问题陈述的科学合理性、完整性和一致性。\n\n**第 1 步：提取已知条件**\n- 表面：不透明、等温、抛光、面积 $A$。\n- 环境：真空罩。\n- 入射辐射：辐照度为 $G_0$ 的单色准直光束。\n- 入射方向：垂直入射，$\\boldsymbol{\\omega}_i$ 与表面法线 $\\boldsymbol{n}$ 重合。\n- 表面属性：灰体，定向半球反射率 $\\rho \\in (0,1)$。\n- 探测器：小接收立体角 $\\Delta \\Omega$，在距 $\\boldsymbol{n}$ 的极角 $\\theta_d \\in (0,\\pi/2)$ 处观察表面。由于轴向对称，方位角无关紧要。\n- 辐射传输关系：$L_o(\\boldsymbol{\\omega}_o) = f_r(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\,E_i(\\boldsymbol{\\omega}_i)$。\n- BRDF 的能量守恒：$\\int_{\\Omega^{+}} f_r(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\,\\cos\\theta_o\\,\\mathrm{d}\\Omega_o = \\rho$，其中 $\\Omega^{+}$ 是出射半球。\n- 镜面 BRDF 模型（对于垂直入射）：$f_r^{\\mathrm{spec}}(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o) = \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_o\\big)^{n}$，其中 $n0$。\n- 漫反射（朗伯）BRDF 模型：$f_r^{\\mathrm{diff}}(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o) = \\rho/\\pi$。\n- 目标：推导比率 $R(\\theta_d,n) = P_{\\mathrm{diff}}/P_{\\mathrm{spec}}$。\n\n**第 2 步：验证**\n该问题是适定的，并且在科学上基于辐射传热的原理。辐射亮度、辐照度和双向反射分布函数 (BRDF) 的定义都是标准的。Phong 型 BRDF 是一个常见的镜面反射经验模型，而朗伯模型是完美漫反射表面的定义。能量守恒约束是一项基本物理定律。所有必要的变量和函数形式都已提供，以推导所要求的比率。问题要求证明 BRDF 归一化的合理性，这是物理一致性所必需的检查。此检查在下面的求解过程中执行。该问题没有歧义、矛盾和事实错误。\n\n**第 3 步：结论**\n该问题有效。将推导解答。\n\n**推导**\n\n分析从辐射量的基本定义开始。辐射亮度，记为 $L$，定义为单位投影面积、单位立体角的辐射功率，单位为 $\\mathrm{W} \\cdot \\mathrm{m}^{-2} \\cdot \\mathrm{sr}^{-1}$。辐照度，记为 $E$，是入射到单位面积表面上的辐射功率，单位为 $\\mathrm{W} \\cdot \\mathrm{m}^{-2}$。\n\n一个具有小接收立体角 $\\Delta \\Omega$ 的探测器接收到来自面积为 $A$ 的表面面元的辐射功率 $P$ 由以下几项的乘积给出：从表面沿探测器方向出射的辐射亮度 $L_o(\\boldsymbol{\\omega}_o)$、垂直于观察方向的表面投影面积 $A \\cos\\theta_d$、以及探测器所对的立体角 $\\Delta \\Omega$。\n$$\nP = L_o(\\boldsymbol{\\omega}_o) (A \\cos\\theta_d) \\Delta\\Omega\n$$\n此处，$\\boldsymbol{\\omega}_o$ 是朝向探测器的方向，$\\theta_d$ 是此方向相对于表面法线 $\\boldsymbol{n}$ 的极角。\n\n问题陈述指出，出射辐射亮度 $L_o$ 通过 BRDF $f_r(\\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o)$ 与入射辐照度 $E_i$ 相关：\n$$\nL_o(\\boldsymbol{\\omega}_o) = f_r(\\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o) E_i(\\boldsymbol{\\omega}_i)\n$$\n对于一束辐照度为 $G_0$ 的准直光束垂直入射到表面上，入射辐照度 $E_i$ 就是 $G_0$。入射方向 $\\boldsymbol{\\omega}_i$ 沿着 $\\boldsymbol{n}$，因此入射极角为 $\\theta_i=0$。所以，沿探测器方向 $\\boldsymbol{\\omega}_o$ 的出射辐射亮度为：\n$$\nL_o(\\boldsymbol{\\omega}_o) = f_r(\\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o) G_0\n$$\n将此代入探测器功率的表达式，得到一个通用公式：\n$$\nP = G_0 A \\Delta\\Omega f_r(\\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o) \\cos\\theta_d\n$$\n\n首先，我们必须证明所给定的镜面 BRDF $f_r^{\\mathrm{spec}}$ 归一化的合理性。能量守恒原理要求定向半球反射率 $\\rho$ 等于 BRDF 乘以出射极角的余弦在整个出射方向半球 $\\Omega^{+}$ 上的积分。\n$$\n\\rho = \\int_{\\Omega^{+}} f_r(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\,\\cos\\theta_o\\,\\mathrm{d}\\Omega_o\n$$\n在球坐标系中，微分立体角为 $\\mathrm{d}\\Omega_o = \\sin\\theta_o\\,\\mathrm{d}\\theta_o\\,\\mathrm{d}\\phi_o$，其中 $\\phi_o$ 是方位角。对于给定的镜面 BRDF，我们进行积分：\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{\\pi/2} \\left( \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_o\\big)^{n} \\right) \\cos\\theta_o \\sin\\theta_o\\,\\mathrm{d}\\theta_o\\,\\mathrm{d}\\phi_o\n$$\n对方位角 $\\phi_o$ 从 $0$ 到 $2\\pi$ 的积分得到一个因子 $2\\pi$。\n$$\n= 2\\pi \\cdot \\rho\\,\\frac{n+2}{2\\pi} \\int_{0}^{\\pi/2} (\\cos\\theta_o)^{n+1} \\sin\\theta_o\\,\\mathrm{d}\\theta_o = \\rho(n+2) \\int_{0}^{\\pi/2} (\\cos\\theta_o)^{n+1} \\sin\\theta_o\\,\\mathrm{d}\\theta_o\n$$\n为求解剩余的积分，我们使用换元法，令 $u = \\cos\\theta_o$，则 $\\mathrm{d}u = -\\sin\\theta_o\\,\\mathrm{d}\\theta_o$。积分限从 $\\theta_o=0$ 变为 $u=1$，从 $\\theta_o=\\pi/2$ 变为 $u=0$。\n$$\n= \\rho(n+2) \\int_{1}^{0} u^{n+1} (-\\mathrm{d}u) = \\rho(n+2) \\int_{0}^{1} u^{n+1} \\mathrm{d}u = \\rho(n+2) \\left[ \\frac{u^{n+2}}{n+2} \\right]_{0}^{1} = \\rho(n+2) \\left( \\frac{1}{n+2} - 0 \\right) = \\rho\n$$\n该镜面 BRDF 已被正确归一化，满足能量守恒约束。\n\n现在我们可以计算漫反射和镜面反射两种情况下的探测器功率。\n\n**情况 1：漫反射表面 ($P_{\\mathrm{diff}}$)**\n漫反射（朗伯）BRDF 对于所有出射方向都是常数：$f_r^{\\mathrm{diff}} = \\rho/\\pi$。出射辐射亮度也与方向无关，$L_{o,\\mathrm{diff}} = (\\rho/\\pi)G_0$。探测器测量的功率为：\n$$\nP_{\\mathrm{diff}} = L_{o,\\mathrm{diff}} (A \\cos\\theta_d) \\Delta\\Omega = \\left(\\frac{\\rho}{\\pi} G_0\\right) A \\cos\\theta_d \\Delta\\Omega = \\frac{\\rho G_0 A \\Delta\\Omega}{\\pi} \\cos\\theta_d\n$$\n\n**情况 2：镜面反射表面 ($P_{\\mathrm{spec}}$)**\n镜面 BRDF 给出为 $f_r^{\\mathrm{spec}} = \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_o\\big)^{n}$。探测器从极角 $\\theta_d$ 观察表面，因此我们设 $\\theta_o = \\theta_d$。沿探测器方向的出射辐射亮度为：\n$$\nL_{o,\\mathrm{spec}}(\\theta_d) = \\left( \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_d\\big)^{n} \\right) G_0\n$$\n探测器测量的功率为：\n$$\nP_{\\mathrm{spec}} = L_{o,\\mathrm{spec}}(\\theta_d) (A \\cos\\theta_d) \\Delta\\Omega = \\left( \\rho\\,\\frac{n+2}{2\\pi}\\,\\big(\\cos\\theta_d\\big)^{n} G_0 \\right) A \\cos\\theta_d \\Delta\\Omega\n$$\n$$\nP_{\\mathrm{spec}} = \\frac{\\rho G_0 A \\Delta\\Omega}{2\\pi} (n+2) (\\cos\\theta_d)^{n+1}\n$$\n\n**比率计算**\n最后，我们计算比率 $R(\\theta_d,n) = P_{\\mathrm{diff}}/P_{\\mathrm{spec}}$。\n$$\nR(\\theta_d,n) = \\frac{P_{\\mathrm{diff}}}{P_{\\mathrm{spec}}} = \\frac{\\frac{\\rho G_0 A \\Delta\\Omega}{\\pi} \\cos\\theta_d}{\\frac{\\rho G_0 A \\Delta\\Omega}{2\\pi} (n+2) (\\cos\\theta_d)^{n+1}}\n$$\n公共项 $\\rho$、 $G_0$、 $A$ 和 $\\Delta\\Omega$ 消去。\n$$\nR(\\theta_d,n) = \\frac{\\frac{1}{\\pi} \\cos\\theta_d}{\\frac{1}{2\\pi} (n+2) (\\cos\\theta_d)^{n+1}} = \\frac{1}{\\pi} \\cos\\theta_d \\cdot \\frac{2\\pi}{(n+2) (\\cos\\theta_d)^{n+1}}\n$$\n简化表达式：\n$$\nR(\\theta_d,n) = \\frac{2 \\cos\\theta_d}{(n+2) (\\cos\\theta_d)^{n+1}} = \\frac{2}{(n+2) (\\cos\\theta_d)^{n}}\n$$\n该表达式给出了在错误的漫反射假设下探测到的功率与从更物理准确的抛光表面镜面模型探测到的功率之比。\n比率 $R(\\theta_d, n)$ 的最终结果是：\n$$\nR(\\theta_d,n) = \\frac{2}{(n+2)(\\cos\\theta_d)^n}\n$$",
            "answer": "$$\n\\boxed{\\frac{2}{(n+2) (\\cos\\theta_d)^{n}}}\n$$"
        },
        {
            "introduction": "这项实践练习旨在连接解析理论与计算实践，引导您完成解决一个通用 $N$ 表面闭合体问题的完整过程 。您将推导辐射度方程的矩阵形式，并实现标准的迭代数值方法——雅可比 (Jacobi) 法和高斯-赛德尔 (Gauss-Seidel) 法——来求解这些方程。这项综合性练习将物理原理与专业热分析软件中使用的基本数值技术融为一体。",
            "id": "3958598",
            "problem": "考虑一个由有限个不透明、灰体和漫射表面组成的围护体。令 $N$ 表示表面数量。对于每个表面 $i \\in \\{1,\\dots,N\\}$，令半球辐射出射度用 $J_i$ 表示，单位为 $\\mathrm{W/m^2}$，发射率用 $\\varepsilon_i$ 表示（无量纲），绝对温度用 $T_i$ 表示，单位为 $\\mathrm{K}$，从表面 $i$ 到表面 $j$ 的方向-半球角系数用 $F_{ij}$ 表示（无量纲）。假设围护体是封闭的，因此对于每个 $i$，角系数集合是行随机的，即 $\\sum_{j=1}^{N} F_{ij} = 1$，并且所有角系数满足 $F_{ij} \\ge 0$。令 Stefan–Boltzmann 常数为 $\\sigma$，单位为 $\\mathrm{W/(m^2\\,K^4)}$。\n\n从表面能量守恒、黑体半球发射功率的定义以及灰体和漫射假设（半球发射率与波长和方向无关，朗伯反射）出发，完成以下任务：\n\n- 推导一个线性代数系统，该系统将未知的辐射出射度 $\\{J_i\\}_{i=1}^{N}$ 与已知的表面温度 $\\{T_i\\}_{i=1}^{N}$、发射率 $\\{\\varepsilon_i\\}_{i=1}^{N}$ 和角系数 $\\{F_{ij}\\}_{i,j=1}^{N}$ 关联起来。你的推导必须从“辐射出射度等于自身发射的辐射和漫反射的入射辐射之和”这一陈述开始，并使用基于 Stefan–Boltzmann 定律的黑体发射定义，不得假设任何预先形成的辐射出射度方程。\n- 将得到的线性系统重写为标准形式 $M \\, \\mathbf{J} = \\mathbf{E}$，其中 $\\mathbf{J} \\in \\mathbb{R}^{N}$ 是未知辐射出射度的向量（单位为 $\\mathrm{W/m^2}$），$M \\in \\mathbb{R}^{N \\times N}$ 是系统矩阵，$\\mathbf{E} \\in \\mathbb{R}^{N}$ 是一个已知的源项。\n- 通过将 $M$ 分解为 $M = D - L - U$ 来构建用于求解 $M \\, \\mathbf{J} = \\mathbf{E}$ 的 Jacobi 和 Gauss–Seidel 定常迭代法，其中 $D$ 是 $M$ 的对角部分，$L$ 是其严格下三角部分，$U$ 是其严格上三角部分。将每次迭代表示为典范形式 $\\mathbf{J}^{(k+1)} = G \\, \\mathbf{J}^{(k)} + \\mathbf{c}$，其中 $G$ 为迭代矩阵，$\\mathbf{c}$ 为向量，并为 Jacobi 和 Gauss–Seidel 方法分别确定 $G$。\n- 利用定常迭代的误差传播关系，推导以谱半径表述的收敛判据，即证明迭代从任何初始猜测收敛的充分必要条件是谱半径 $\\rho(G)  1$。清晰地陈述你使用的所有假设。\n\n实现要求。编写一个程序，对于下面的测试套件，使用 Jacobi 和 Gauss–Seidel 两种方法完成以下所有操作：\n\n- 使用你推导出的关系从提供的数据构建 $M$ 和 $\\mathbf{E}$。\n- 构成相应的迭代矩阵 $G_{\\text{J}}$ 和 $G_{\\text{GS}}$，并计算它们的谱半径 $\\rho(G_{\\text{J}})$ 和 $\\rho(G_{\\text{GS}})$。\n- 使用谱半径判据 $\\rho(G)  1$，以布尔值的形式为每种方法预测收敛性。\n- 从零向量 $\\mathbf{J}^{(0)} = \\mathbf{0}$ 开始执行迭代，直到残差的无穷范数 $\\lVert M \\mathbf{J}^{(k)} - \\mathbf{E} \\rVert_{\\infty}$ 小于容差 $\\tau$ 或达到最大迭代次数 $k_{\\max}$。使用 $\\tau = 10^{-8}\\,\\mathrm{W/m^2}$ 和 $k_{\\max} = 10000$。\n- 报告达到收敛所需的迭代次数（如果在 $k_{\\max}$ 内未收敛，则为 $-1$）以及表面1的辐射出射度（单位为 $\\mathrm{W/m^2}$）。\n\n物理常数和单位：\n\n- 使用 $\\sigma = 5.670374419 \\times 10^{-8}\\,\\mathrm{W/(m^2\\,K^4)}$。\n- 所有温度必须以 $\\mathrm{K}$ 为单位。\n- 所有辐射出射度必须以 $\\mathrm{W/m^2}$ 为单位。\n- 发射率和角系数是无量纲的。\n\n测试套件。对于每种情况，输入以 $(N, \\boldsymbol{\\varepsilon}, \\mathbf{T}, F)$ 的形式给出：\n\n- 情况1（两个相对的漫射平板）：\n    - $N = 2$\n    - $\\boldsymbol{\\varepsilon} = [0.8,\\, 0.6]$\n    - $\\mathbf{T} = [1000,\\, 500]\\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}$\n- 情况2（三个具有非零自角系数的表面）：\n    - $N = 3$\n    - $\\boldsymbol{\\varepsilon} = [0.1,\\, 0.1,\\, 0.1]$\n    - $\\mathbf{T} = [800,\\, 900,\\, 700]\\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0.3  0.35  0.35 \\\\ 0.35  0.3  0.35 \\\\ 0.35  0.35  0.3 \\end{bmatrix}$\n- 情况3（具有非均匀属性的四表面围护体）：\n    - $N = 4$\n    - $\\boldsymbol{\\varepsilon} = [0.95,\\, 0.2,\\, 0.7,\\, 0.05]$\n    - $\\mathbf{T} = [400,\\, 1200,\\, 800,\\, 600]\\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0  0.5  0.3  0.2 \\\\ 0.4  0  0.4  0.2 \\\\ 0.2  0.4  0  0.4 \\\\ 0.3  0.3  0.4  0 \\end{bmatrix}$\n\n最终输出格式。你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。对于按上面列出的顺序的每个测试用例，按顺序附加以下七个值：\n\n- Jacobi 迭代矩阵的谱半径 $\\rho(G_{\\text{J}})$，四舍五入到6位小数。\n- Gauss–Seidel 迭代矩阵的谱半径 $\\rho(G_{\\text{GS}})$，四舍五入到6位小数。\n- 对 Jacobi 方法的收敛性预测（布尔值），使用判据 $\\rho(G_{\\text{J}})  1$。\n- 对 Gauss–Seidel 方法的收敛性预测（布尔值），使用判据 $\\rho(G_{\\text{GS}})  1$。\n- Jacobi 方法为满足容差 $\\tau$ 实际所需的迭代次数（如果在 $k_{\\max}$ 内未收敛，则为 $-1$）。\n- Gauss–Seidel 方法为满足容差 $\\tau$ 实际所需的迭代次数（如果在 $k_{\\max}$ 内未收敛，则为 $-1$）。\n- 计算出的表面1的辐射出射度 $J_1$，单位为 $\\mathrm{W/m^2}$，四舍五入到3位小数。\n\n因此，最终打印的列表必须总共包含 $3 \\times 7 = 21$ 个条目，顺序如上所述。",
            "solution": "在由不透明、灰体和漫射表面组成的围护体中的辐射传热分析是热工学中的一个基本问题。我们首先从基本原理严格推导控制方程，然后开发求解这些方程的数值方法。\n\n**1. 辐射出射度积分方程的推导**\n\n对于围护体中的任何不透明表面 $i$，离开该表面的总辐射通量，定义为其半球辐射出射度 $J_i$（单位为 $\\mathrm{W/m^2}$），是它自身发射的辐射与其反射的入射辐射部分之和。这是表面能量守恒的直接表述：\n$$\nJ_i = E_i + G_{i, \\text{refl}}\n$$\n其中 $E_i$ 是表面 $i$ 的发射功率，$G_{i, \\text{refl}}$ 是投射到表面 $i$ 上的入射辐射 $G_i$ 中被反射的部分。\n\n对于灰体表面，总半球发射率 $\\varepsilon_i$ 与波长无关。因此，发射功率由 $E_i = \\varepsilon_i E_{b,i}$ 给出，其中 $E_{b,i}$ 是处于相同温度 $T_i$ 下的黑体的总半球发射功率。根据 Stefan-Boltzmann 定律，$E_{b,i} = \\sigma T_i^4$，其中 $\\sigma$ 是 Stefan-Boltzmann 常数。因此，发射分量为：\n$$\nE_i = \\varepsilon_i \\sigma T_i^4\n$$\n\n表面也被假定为漫射的，意味着其反射率与方向无关。总半球反射率用 $\\rho_i$ 表示。反射的入射辐射则为 $G_{i, \\text{refl}} = \\rho_i G_i$。\n对于不透明表面，其吸收率 $\\alpha_i$ 和反射率 $\\rho_i$ 之和必须为1：$\\alpha_i + \\rho_i = 1$。对于灰体表面，Kirchhoff 定律指出总半球吸收率等于总半球发射率，即 $\\alpha_i = \\varepsilon_i$。结合这些关系，我们得到反射率为：\n$$\n\\rho_i = 1 - \\alpha_i = 1 - \\varepsilon_i\n$$\n将这些表达式代入能量平衡方程，我们得到：\n$$\nJ_i = \\varepsilon_i \\sigma T_i^4 + (1 - \\varepsilon_i) G_i\n$$\n表面 $i$ 上的入射辐射 $G_i$ 是来自围护体中所有表面 $j=1, \\dots, N$ 的辐射能量之和。离开面积为 $A_j$ 的表面 $j$ 的总能量是 $A_j J_j$。这部分能量到达表面 $i$ 的比例由角系数 $F_{ji}$ 给出。因此，从 $j$ 到达 $i$ 的总能量为 $(A_j J_j) F_{ji}$。对所有表面求和并除以面积 $A_i$ 得到入射辐射 $G_i$：\n$$\nG_i = \\frac{1}{A_i} \\sum_{j=1}^{N} (A_j J_j) F_{ji}\n$$\n使用角系数倒易关系 $A_j F_{ji} = A_i F_{ij}$，我们将入射辐射的表达式简化为：\n$$\nG_i = \\frac{1}{A_i} \\sum_{j=1}^{N} (A_i F_{ij}) J_j = \\sum_{j=1}^{N} F_{ij} J_j\n$$\n这个简化巧妙地消除了对表面积的显式依赖。将这个 $G_i$ 的表达式代入辐射出射度方程，得到最终的积分方程（在表面上离散化）：\n$$\nJ_i = \\varepsilon_i \\sigma T_i^4 + (1 - \\varepsilon_i) \\sum_{j=1}^{N} F_{ij} J_j\n$$\n该方程对每个表面 $i = 1, \\dots, N$ 都成立。\n\n**2. 构建线性系统 $M\\,\\mathbf{J} = \\mathbf{E}$**\n\n为了求解未知的辐射出射度 $\\{J_i\\}_{i=1}^{N}$，我们重新整理推导出的方程，将所有涉及 $J_j$ 的项归到一边：\n$$\nJ_i - (1 - \\varepsilon_i) \\sum_{j=1}^{N} F_{ij} J_j = \\varepsilon_i \\sigma T_i^4\n$$\n这可以用 Kronecker delta $\\delta_{ij}$（当 $i=j$ 时为1，否则为0）更正式地写成：\n$$\n\\sum_{j=1}^{N} (\\delta_{ij} - (1 - \\varepsilon_i) F_{ij}) J_j = \\varepsilon_i \\sigma T_i^4\n$$\n这 $N$ 个方程组构成一个线性代数系统 $M \\mathbf{J} = \\mathbf{E}$，其中：\n- $\\mathbf{J}$ 是未知辐射出射度的列向量：$\\mathbf{J} = [J_1, J_2, \\dots, J_N]^T$。\n- $M$ 是 $N \\times N$ 的系统矩阵，其元素 $M_{ij}$ 由下式给出：\n  $$\n  M_{ij} = \\delta_{ij} - (1 - \\varepsilon_i) F_{ij}\n  $$\n- $\\mathbf{E}$ 是已知源项的列向量，代表每个表面的发射功率：\n  $$\n  E_i = \\varepsilon_i \\sigma T_i^4\n  $$\n\n**3. 定常迭代法**\n\n为了迭代求解 $M \\mathbf{J} = \\mathbf{E}$，我们将矩阵 $M$ 分解为其对角（$D$）、严格下三角（$-L$）和严格上三角（$-U$）部分：$M = D - L - U$。\n- 对角矩阵 $D$ 的元素为 $D_{ii} = M_{ii} = 1 - (1 - \\varepsilon_i) F_{ii}$。\n- 严格下三角矩阵 $L$ 的元素为 $L_{ij} = -M_{ij} = (1 - \\varepsilon_i) F_{ij}$（对于 $i  j$）。\n- 严格上三角矩阵 $U$ 的元素为 $U_{ij} = -M_{ij} = (1 - \\varepsilon_i) F_{ij}$（对于 $i  j$）。\n\n系统 $M \\mathbf{J} = \\mathbf{E}$ 变为 $(D - L - U) \\mathbf{J} = \\mathbf{E}$。\n\n**Jacobi 迭代法**：\nJacobi 方法同时更新解向量的所有分量，仅使用上一次迭代 $k$ 的值。\n$$\nD \\mathbf{J}^{(k+1)} = (L + U) \\mathbf{J}^{(k)} + \\mathbf{E}\n$$\n$$\n\\mathbf{J}^{(k+1)} = D^{-1}(L + U) \\mathbf{J}^{(k)} + D^{-1} \\mathbf{E}\n$$\n这是典范形式 $\\mathbf{J}^{(k+1)} = G \\mathbf{J}^{(k)} + \\mathbf{c}$，其中 Jacobi 迭代矩阵 $G_{\\text{J}}$ 和向量 $\\mathbf{c}_{\\text{J}}$ 可确定为：\n$$\nG_{\\text{J}} = D^{-1}(L + U) \\quad \\text{和} \\quad \\mathbf{c}_{\\text{J}} = D^{-1} \\mathbf{E}\n$$\n\n**Gauss-Seidel 迭代法**：\nGauss-Seidel 方法通过在当前迭代 $k+1$ 中使用最新计算出的值来改进 Jacobi 方法。\n$$\n(D - L) \\mathbf{J}^{(k+1)} = U \\mathbf{J}^{(k)} + \\mathbf{E}\n$$\n$$\n\\mathbf{J}^{(k+1)} = (D - L)^{-1} U \\mathbf{J}^{(k)} + (D - L)^{-1} \\mathbf{E}\n$$\n因此，Gauss-Seidel 迭代矩阵 $G_{\\text{GS}}$ 和向量 $\\mathbf{c}_{\\text{GS}}$ 为：\n$$\nG_{\\text{GS}} = (D - L)^{-1} U \\quad \\text{和} \\quad \\mathbf{c}_{\\text{GS}} = (D - L)^{-1} \\mathbf{E}\n$$\n\n**4. 收敛判据**\n\n对于任何形式为 $\\mathbf{J}^{(k+1)} = G \\mathbf{J}^{(k)} + \\mathbf{c}$ 的定常迭代法，我们分析误差的传播。设 $\\mathbf{J}^*$ 为精确解，满足 $\\mathbf{J}^* = G \\mathbf{J}^* + \\mathbf{c}$。设第 $k$ 次迭代的误差为 $\\mathbf{e}^{(k)} = \\mathbf{J}^{(k)} - \\mathbf{J}^*$。\n从迭代方程中减去精确解方程，得到：\n$$\n\\mathbf{J}^{(k+1)} - \\mathbf{J}^* = (G \\mathbf{J}^{(k)} + \\mathbf{c}) - (G \\mathbf{J}^* + \\mathbf{c})\n$$\n$$\n\\mathbf{e}^{(k+1)} = G (\\mathbf{J}^{(k)} - \\mathbf{J}^*) = G \\mathbf{e}^{(k)}\n$$\n递归应用此关系，我们发现第 $k$ 次迭代的误差可以用初始误差 $\\mathbf{e}^{(0)}$ 表示：\n$$\n\\mathbf{e}^{(k)} = G^k \\mathbf{e}^{(0)}\n$$\n为了使迭代从任意初始猜测 $\\mathbf{J}^{(0)}$（从而对任意初始误差 $\\mathbf{e}^{(0)}$）收敛，误差向量 $\\mathbf{e}^{(k)}$ 必须在 $k \\to \\infty$ 时趋近于零向量。这要求对于所有 $\\mathbf{e}^{(0)}$，$\\lim_{k \\to \\infty} G^k \\mathbf{e}^{(0)} = \\mathbf{0}$。此条件成立当且仅当矩阵 $G^k$ 收敛到零矩阵。数值线性代数中的一个基本定理指出，$\\lim_{k \\to \\infty} G^k = 0$ 的充分必要条件是 $G$ 的谱半径 $\\rho(G)$ 严格小于1。谱半径定义为 $G$ 的特征值的最大绝对值：$\\rho(G) = \\max_i |\\lambda_i|$，其中 $\\lambda_i$ 是 $G$ 的特征值。\n因此，定常迭代法从任意起始向量收敛的充分必要条件是：\n$$\n\\rho(G)  1\n$$\n对于当前讨论的物理系统，可以证明，如果所有表面的发射率都非零（$\\varepsilon_i  0$），则矩阵 $M$ 是严格对角占优的。此性质保证了 Jacobi 和 Gauss-Seidel 迭代都会收敛，即 $\\rho(G_{\\text{J}})  1$ 和 $\\rho(G_{\\text{GS}})  1$。\n\n**5. 实现策略**\n\n对于每个测试用例，数值实现按以下步骤进行：\n1.  定义物理常数 $\\sigma$、$\\tau$、 $k_{\\max}$ 以及问题数据 $(N, \\boldsymbol{\\varepsilon}, \\mathbf{T}, F)$。\n2.  计算源向量 $\\mathbf{E}$，其元素为 $E_i = \\varepsilon_i \\sigma T_i^4$。\n3.  构建系统矩阵 $M$，其元素为 $M_{ij} = \\delta_{ij} - (1 - \\varepsilon_i) F_{ij}$。\n4.  从 $M$ 中提取矩阵 $D$、$L$ 和 $U$。\n5.  构成迭代矩阵 $G_{\\text{J}} = D^{-1}(L+U)$ 和 $G_{\\text{GS}} = (D-L)^{-1}U$。\n6.  使用标准的数值库函数计算 $G_{\\text{J}}$ 和 $G_{\\text{GS}}$ 的特征值，并取其最大绝对值以找到谱半径 $\\rho(G_{\\text{J}})$ 和 $\\rho(G_{\\text{GS}})$。\n7.  基于判据 $\\rho(G)  1$ 预测每种方法的收敛性。\n8.  从 $\\mathbf{J}^{(0)} = \\mathbf{0}$ 开始执行 Jacobi 和 Gauss-Seidel 迭代。在每一步 $k$，检查残差无穷范数 $\\lVert \\mathbf{r}^{(k)} \\rVert_{\\infty} = \\lVert M \\mathbf{J}^{(k)} - \\mathbf{E} \\rVert_{\\infty}$ 是否小于容差 $\\tau$。循环在收敛或达到 $k_{\\max}$ 时终止。\n9.  记录迭代次数和最终计算出的表面1的辐射出射度 $J_1$。使用 Gauss-Seidel 方法的结果作为最终报告的辐射出射度。\n10. 收集所有结果并按指定格式进行格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the radiosity problem for a set of test cases using Jacobi and Gauss-Seidel methods.\n    \"\"\"\n    \n    # Physical constants and numerical parameters\n    sigma = 5.670374419e-8  # Stefan-Boltzmann constant in W/(m^2 K^4)\n    tau = 1e-8              # Convergence tolerance for residual norm\n    k_max = 10000           # Maximum number of iterations\n\n    # Test suite\n    test_cases = [\n        {\n            \"N\": 2,\n            \"eps\": np.array([0.8, 0.6]),\n            \"T\": np.array([1000.0, 500.0]),\n            \"F\": np.array([[0.0, 1.0], [1.0, 0.0]])\n        },\n        {\n            \"N\": 3,\n            \"eps\": np.array([0.1, 0.1, 0.1]),\n            \"T\": np.array([800.0, 900.0, 700.0]),\n            \"F\": np.array([[0.3, 0.35, 0.35], [0.35, 0.3, 0.35], [0.35, 0.35, 0.3]])\n        },\n        {\n            \"N\": 4,\n            \"eps\": np.array([0.95, 0.2, 0.7, 0.05]),\n            \"T\": np.array([400.0, 1200.0, 800.0, 600.0]),\n            \"F\": np.array([[0.0, 0.5, 0.3, 0.2], [0.4, 0.0, 0.4, 0.2], [0.2, 0.4, 0.0, 0.4], [0.3, 0.3, 0.4, 0.0]])\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        N = case[\"N\"]\n        eps = case[\"eps\"]\n        T = case[\"T\"]\n        F = case[\"F\"]\n        \n        # 1. Build M and E\n        E = eps * sigma * (T ** 4)\n        M = np.identity(N) - (1 - eps).reshape(-1, 1) * F\n\n        # 2. Form iteration matrices G and compute spectral radii\n        D = np.diag(np.diag(M))\n        L = -np.tril(M, k=-1)\n        U = -np.triu(M, k=1)\n        \n        D_inv = np.linalg.inv(D)\n        \n        # Jacobi\n        G_J = D_inv @ (L + U)\n        rho_J = np.max(np.abs(np.linalg.eigvals(G_J)))\n        \n        # Gauss-Seidel\n        D_minus_L_inv = np.linalg.inv(D - L)\n        G_GS = D_minus_L_inv @ U\n        rho_GS = np.max(np.abs(np.linalg.eigvals(G_GS)))\n        \n        # 3. Predict convergence\n        predict_J = rho_J  1\n        predict_GS = rho_GS  1\n        \n        # 4. Execute Jacobi iteration\n        J = np.zeros(N)\n        iter_J = -1\n        for k in range(k_max):\n            residual_norm = np.linalg.norm(M @ J - E, ord=np.inf)\n            if residual_norm  tau:\n                iter_J = k\n                break\n            \n            # Update step for Jacobi\n            J_old = J.copy()\n            J = D_inv @ (E + (L + U) @ J_old)\n        \n        # 5. Execute Gauss-Seidel iteration\n        J_gs = np.zeros(N)\n        iter_GS = -1\n        for k in range(k_max):\n            residual_norm = np.linalg.norm(M @ J_gs - E, ord=np.inf)\n            if residual_norm  tau:\n                iter_GS = k\n                break\n            \n            # Update step for Gauss-Seidel\n            J_gs_old = J_gs.copy()\n            for i in range(N):\n                sum_L = M[i, :i] @ J_gs[:i]\n                sum_U = M[i, i+1:] @ J_gs_old[i+1:]\n                J_gs[i] = (E[i] - sum_L - sum_U) / M[i, i]\n        \n        # Use converged GS value for J1. If GS fails, fallback to Jacobi.\n        # If both fail, J1 will be from the last GS iteration.\n        J1_final = J_gs[0]\n\n        # 6. Append results\n        all_results.extend([\n            f\"{rho_J:.6f}\",\n            f\"{rho_GS:.6f}\",\n            str(predict_J),\n            str(predict_GS),\n            iter_J,\n            iter_GS,\n            f\"{J1_final:.3f}\"\n        ])\n\n    # Final print statement\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}