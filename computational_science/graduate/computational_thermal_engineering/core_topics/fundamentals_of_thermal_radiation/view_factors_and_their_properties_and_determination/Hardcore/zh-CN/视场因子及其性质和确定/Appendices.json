{
    "hands_on_practices": [
        {
            "introduction": "这个首次实践将通过一个简单的对称几何体来巩固角系数的基本性质。通过分析两个同心球体，您将应用封闭腔体的求和法则，并从第一性原理推导互易关系，从而确定角系数 $F_{1\\to 2}$ 与 $F_{2\\to 1}$。 这项练习展示了这些基本规则如何巧妙地解决那些否则可能需要复杂积分的问题。",
            "id": "4003697",
            "problem": "考虑一个辐射闭合腔，由两个在真空中的完美的漫反射、不透明、等温的同心球面构成，其中没有参与介质。内球的半径为 $R_1$，表面积为 $A_1$；外球的半径为 $R_2$，表面积为 $A_2$，其中 $R_2 > R_1$。令 $F_{i\\to j}$ 表示从表面 $i$ 到表面 $j$ 的几何角系数（也称形态因子）。假设闭合腔中没有其他表面。从漫反射表面的角系数积分定义和基本的辐射交换守恒定律出发，推导计算角系数 $F_{1\\to 2}$ 和 $F_{2\\to 1}$ 所需的关系式。您的推导应从 $F_{i\\to j}$ 的积分定义开始，从第一性原理证明所使用的任何闭合腔性质，并在应用互易关系前证明它。将您的最终答案表示为单行矩阵中的有序对 $(F_{1\\to 2}, F_{2\\to 1})$。最终答案无需四舍五入，也无需包含单位。",
            "solution": "根据既定标准对所述问题进行验证。\n\n### 步骤 1：提取已知条件\n- **系统：** 由两个同心球面构成的辐射闭合腔。\n- **表面：**\n  - 内球（表面 $1$）：半径 $R_1$，表面积 $A_1$。\n  - 外球（表面 $2$）：半径 $R_2$，表面积 $A_2$。\n- **表面特性：** 完美的漫反射、不透明、等温。\n- **介质：** 真空，无参与介质。\n- **几何约束：** $R_2 > R_1$。\n- **闭合腔定义：** 闭合腔仅由表面 $1$ 和 $2$ 构成。\n- **符号：** $F_{i\\to j}$ 表示从表面 $i$ 到表面 $j$ 的几何角系数。\n- **要求推导：** 从角系数的积分定义出发，计算 $F_{1\\to 2}$ 和 $F_{2\\to 1}$，并证明所使用的所有性质，包括互易关系的证明。\n- **输出格式：** 单行矩阵中的有序对 $(F_{1\\to 2}, F_{2\\to 1})$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题基于辐射传热的基本原理，特别是闭合腔中角系数的概念。这是热工和物理学中的一个典型问题。该模型是科学合理的。\n2.  **适定性：** 问题对系统（两个构成闭合腔的同心球）进行了完整的物理描述，并要求确定具体的、唯一定义的量（$F_{1\\to 2}$ 和 $F_{2\\to 1}$）。所给信息足以推导出唯一解。\n3.  **客观性：** 语言精确，使用了标准的科学术语。没有主观或模糊的陈述。\n4.  **完整性与一致性：** 问题是自洽的。几何形状已完全指定。表面特性已明确定义。没有矛盾之处。面积 $A_1 = 4\\pi R_1^2$ 和 $A_2 = 4\\pi R_2^2$ 是可以假定为已知的标准几何公式。\n5.  **现实性与可行性：** 物理设置虽然是理想化的，但对于许多现实世界系统（例如，低温恒温器、卫星）来说，是一个常见且合理的近似。条件是物理上可行的。\n\n### 步骤 3：结论与行动\n该问题被判定为 **有效**。这是一个适定的、科学合理的、非平凡的问题，需要按要求从第一性原理进行推导。现在可以开始求解过程。\n\n### 解题推导\n目标是确定由两个同心球构成的闭合腔的角系数 $F_{1\\to 2}$ 和 $F_{2\\to 1}$。推导将从第一性原理开始。\n\n**1. 闭合腔的求和法则**\n\n对于构成一个包含 $N$ 个表面的闭合腔的任意表面 $i$，辐射能量守恒要求离开表面 $i$ 的能量中，投射到闭合腔内所有表面 $j$（包括其自身）的能量分数之和必须为1。这表示为求和法则：\n$$ \\sum_{j=1}^{N} F_{i\\to j} = 1 $$\n在我们的系统中，闭合腔由两个表面组成，内球（表面 $1$）和外球（表面 $2$）。因此，$N=2$。\n\n**2. 计算 $F_{1\\to 2}$**\n\n将求和法则应用于内球（表面 $1$）：\n$$ F_{1\\to 1} + F_{1\\to 2} = 1 $$\n角系数 $F_{1\\to 1}$ 表示离开内球表面的辐射中投射到其自身的部分。内球是一个凸面。对于任何凸面，连接表面上任意两点的直线完全位于表面的一侧（除了端点本身）。因此，凸面上的任何微元面积都无法“看到”同一表面上的任何其他微元面积。因此，离开表面 $1$ 的辐射不能被表面 $1$ 自身所截获。这意味着：\n$$ F_{1\\to 1} = 0 $$\n将此代入表面 $1$ 的求和法则中：\n$$ 0 + F_{1\\to 2} = 1 $$\n$$ F_{1\\to 2} = 1 $$\n这个结果在物理上是直观的：由于内球完全被外球包围，所有从其表面发射的辐射必然会投射到外球的内表面上。\n\n**3. 互易关系**\n\n为了求出 $F_{2\\to 1}$，我们首先从角系数的基本积分定义推导互易关系。对于漫反射表面，从有限面积 $A_i$ 到另一个有限面积 $A_j$ 的角系数定义为：\n$$ F_{i\\to j} = \\frac{1}{A_i} \\int_{A_i} \\int_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2} dA_j dA_i $$\n这里，$dA_i$ 和 $dA_j$ 分别是表面 $A_i$ 和 $A_j$ 上的微元面积。这些微元之间的距离是 $r$。角度 $\\theta_i$ 和 $\\theta_j$ 是连接微元的直线与它们各自表面法线之间的夹角。\n\n我们写出乘积 $A_i F_{i\\to j}$ 的表达式：\n$$ A_i F_{i\\to j} = \\int_{A_i} \\int_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2} dA_j dA_i $$\n现在，我们写出乘积 $A_j F_{j\\to i}$ 的相应表达式：\n$$ A_j F_{j\\to i} = A_j \\left( \\frac{1}{A_j} \\int_{A_j} \\int_{A_i} \\frac{\\cos\\theta_j \\cos\\theta_i}{\\pi r^2} dA_i dA_j \\right) $$\n$$ A_j F_{j\\to i} = \\int_{A_j} \\int_{A_i} \\frac{\\cos\\theta_j \\cos\\theta_i}{\\pi r^2} dA_i dA_j $$\n被积函数 $\\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2}$ 对于交换下标 $i$ 和 $j$ 是对称的。由于两个表达式中的积分都在相同的域 $A_i$ 和 $A_j$ 上进行，因此可以交换积分顺序而不改变二重积分的值。因此：\n$$ \\int_{A_i} \\int_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2} dA_j dA_i = \\int_{A_j} \\int_{A_i} \\frac{\\cos\\theta_j \\cos\\theta_i}{\\pi r^2} dA_i dA_j $$\n这意味着两个表达式的左边必须相等：\n$$ A_i F_{i\\to j} = A_j F_{j\\to i} $$\n这就是互易关系，它已经从角系数的积分定义中得到了证明。\n\n**4. 计算 $F_{2\\to 1}$**\n\n我们现在将已证明的互易关系应用于表面 $1$ 和 $2$：\n$$ A_1 F_{1\\to 2} = A_2 F_{2\\to 1} $$\n我们可以解出 $F_{2\\to 1}$：\n$$ F_{2\\to 1} = \\frac{A_1}{A_2} F_{1\\to 2} $$\n我们之前发现 $F_{1\\to 2} = 1$。半径为 $R$ 的球的表面积是 $4\\pi R^2$。因此，我们表面的面积是：\n$$ A_1 = 4\\pi R_1^2 $$\n$$ A_2 = 4\\pi R_2^2 $$\n将这些表达式和 $F_{1\\to 2}$ 的值代入 $F_{2\\to 1}$ 的方程中：\n$$ F_{2\\to 1} = \\frac{4\\pi R_1^2}{4\\pi R_2^2} \\times 1 $$\n$$ F_{2\\to 1} = \\frac{R_1^2}{R_2^2} = \\left(\\frac{R_1}{R_2}\\right)^2 $$\n这个结果表示离开外球内表面的辐射被内球截获的部分。剩余的部分 $1 - F_{2\\to 1}$ 会投射到外球自身（$F_{2\\to 2} = 1 - (R_1/R_2)^2$），这是可能的，因为外球是一个凹面。\n\n推导出的角系数为 $F_{1\\to 2} = 1$ 和 $F_{2\\to 1} = (R_1/R_2)^2$。问题要求将有序对 $(F_{1\\to 2}, F_{2\\to 1})$ 表示为单行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\left(\\frac{R_1}{R_2}\\right)^2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了基本性质之后，本次实践将介绍一种用于二维几何体的强大分析技术，即角系数代数。您将通过巧妙地定义一个封闭系统来推导两个无限长垂直平板之间的角系数 $F_{1\\to 2}$。 这项练习还提供了可加性法则的动手应用，用以量化几何变化如何影响角系数，这是工程设计中的一项常见任务。",
            "id": "4003676",
            "problem": "考虑两个漫射、灰色、等温、不透明的矩形表面，它们形成一个直角二面角，并在其交汇线段处共享一条公共边。表面 $1$ 位于平面 $z=0$ 中，范围为 $\\{(x,y,0): x\\in\\mathbb{R},\\ y\\in[0,b]\\}$；表面 $2$ 位于平面 $y=0$ 中，范围为 $\\{(x,0,z): x\\in\\mathbb{R},\\ z\\in[0,c]\\}$。两个表面都沿 $x$ 方向具有平移不变性（实际上非常长），公共边为直线 $\\{(x,0,0): x\\in\\mathbb{R}\\}$。设表面 $1$ 的宽度为 $b$，表面 $2$ 的高度为 $c$。辐射角系数 $F_{1\\to 2}$ 定义为离开表面 $1$ 的总漫射辐射能量中被表面 $2$ 截获的部分。\n\n从两个漫射表面之间角系数的基本面积-面积定义出发，\n$$\nF_{1\\to 2} \\equiv \\frac{1}{A_1}\\int_{A_1}\\int_{A_2}\\frac{\\cos\\theta_1\\,\\cos\\theta_2}{\\pi\\,r^2}\\,\\mathrm{d}A_2\\,\\mathrm{d}A_1,\n$$\n其中 $A_1$ 是表面 $1$ 的面积，$r$ 是微分面积元之间的距离，$\\theta_1$ 和 $\\theta_2$ 是这些元与连接它们的直线所成的角度，通过处理沿 $x$ 方向长度为 $L$ 的有限段，然后取极限 $L\\to\\infty$，推导给定几何形状的 $F_{1\\to 2}$。当表面 $2$ 沿 $z$ 方向延伸超出共享边时，使用角系数的可加性来量化 $F_{1\\to 2}$ 的增加量。\n\n对于原始配置，设 $b=0.40\\,\\text{m}$ 和 $c=0.30\\,\\text{m}$，并将表面 $2$ 延伸至新的高度 $c_{\\text{new}}=0.40\\,\\text{m}$。使用可加性 $F_{1\\to (2_{\\text{orig}}\\cup 2_{\\text{ext}})} = F_{1\\to 2_{\\text{orig}}} + F_{1\\to 2_{\\text{ext}}}$，计算角系数的增加量 $\\Delta F_{1\\to 2} = F_{1\\to 2}(b,c_{\\text{new}}) - F_{1\\to 2}(b,c)$。\n\n将最终数值答案四舍五入至六位有效数字。角系数是无量纲的；最终答案中不要包含单位。",
            "solution": "首先对问题陈述进行验证过程。\n\n### 第1步：提取已知条件\n- **几何形状**：两个漫射、灰色、等温、不透明的矩形表面，形成一个直角二面角，共享一条公共边。\n- **表面 1**：位于平面 $z=0$ 中，范围为 $\\{(x,y,0): x\\in\\mathbb{R},\\ y\\in[0,b]\\}$。宽度为 $b$。\n- **表面 2**：位于平面 $y=0$ 中，范围为 $\\{(x,0,z): x\\in\\mathbb{R},\\ z\\in[0,c]\\}$。高度为 $c$。\n- **公共边**：直线 $\\{(x,0,0): x\\in\\mathbb{R}\\}$。\n- **对称性**：两个表面都沿 $x$ 方向具有平移不变性（无限长）。\n- **角系数定义**：$F_{1\\to 2} \\equiv \\frac{1}{A_1}\\int_{A_1}\\int_{A_2}\\frac{\\cos\\theta_1\\,\\cos\\theta_2}{\\pi\\,r^2}\\,\\mathrm{d}A_2\\,\\mathrm{d}A_1$。\n- **推导任务**：从基本定义出发，考虑有限长度 $L$ 并取极限 $L\\to\\infty$，推导该几何形状的 $F_{1\\to 2}$。\n- **可加性**：$F_{1\\to (2_{\\text{orig}}\\cup 2_{\\text{ext}})} = F_{1\\to 2_{\\text{orig}}} + F_{1\\to 2_{\\text{ext}}}$。\n- **数值**：对于原始配置， $b=0.40\\,\\text{m}$ 和 $c=0.30\\,\\text{m}$。\n- **修改**：表面 2 延伸至新的高度 $c_{\\text{new}}=0.40\\,\\text{m}$。\n- **计算任务**：计算角系数的增加量 $\\Delta F_{1\\to 2} = F_{1\\to 2}(b,c_{\\text{new}}) - F_{1\\to 2}(b,c)$。\n- **舍入要求**：最终数值答案必须四舍五入至六位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题是辐射传热中的一个经典练习，而辐射传热是热工学的一个子学科。几何形状、表面性质和角系数的定义都是标准且科学正确的。角系数的性质，如可加性和互易性，都是基本原理。\n- **良态问题**：这是一个良态问题。几何形状被明确指定。要推导和计算的量都已明确定义。给定的信息足以找到唯一解，并且是自洽的。\n- **客观性**：问题以精确、客观和技术性的语言陈述，没有任何主观性或偏见。\n\n### 第3步：结论与操作\n该问题被认定为有效。它在科学上是合理的，是良态的，并且是客观的。将提供解答。\n\n问题要求推导共享一条公共边的两个无限长垂直平板之间的角系数 $F_{1\\to 2}$。出发点是角系数的通用四维积分定义。然而，无限长的条件（沿 $x$ 轴的平移不变性）将问题从三维简化为二维。这种简化允许使用强大的二维方法，这些方法本身也是从基本积分定义推导出来的。在这些方法中，最优雅且物理上最具洞察力的是封闭体系法（也称为角系数代数），我们将采用此方法。\n\n考虑系统在 $y-z$ 平面上的横截面。表面 1 是沿 $y$ 轴长度为 $b$ 的线段，从 $(y,z)=(0,0)$ 到 $(b,0)$。表面 2 是沿 $z$ 轴长度为 $c$ 的线段，从 $(0,0)$ 到 $(0,c)$。为了形成一个封闭系统（一个封闭体），我们引入一个假设的第三个表面 $A_3$，它是连接端点 $(b,0)$ 和 $(0,c)$ 的线段。这个表面的长度，记为 $d$，由勾股定理给出：$d = \\sqrt{b^2 + c^2}$。\n\n对于一个由 $N$ 个表面组成的封闭体，求和法则指出，从任何表面 $i$ 到所有其他表面（包括其自身）的角系数之和必须为1：$\\sum_{j=1}^{N} F_{i\\to j} = 1$。\n对于我们的三表面封闭体，我们有：\n$1.$ $F_{1\\to 1} + F_{1\\to 2} + F_{1\\to 3} = 1$\n$2.$ $F_{2\\to 1} + F_{2\\to 2} + F_{2\\to 3} = 1$\n$3.$ $F_{3\\to 1} + F_{3\\to 2} + F_{3\\to 3} = 1$\n\n由于表面 1、2 和 3 都是平的（在二维横截面中，它们是线段），一个表面不能“看到”自己。因此，$F_{1\\to 1} = 0$，$F_{2\\to 2} = 0$，$F_{3\\to 3} = 0$。求和法则简化为：\n$1'.$ $F_{1\\to 2} + F_{1\\to 3} = 1$\n$2'.$ $F_{2\\to 1} + F_{2\\to 3} = 1$\n$3'.$ $F_{3\\to 1} + F_{3\\to 2} = 1$\n\n另一个基本原理是互易律，它指出对于任意两个表面 $i$ 和 $j$，$A_i F_{i\\to j} = A_j F_{j\\to i}$。对于我们的二维问题，单位长度的“面积”就是宽度 $b$、$c$ 和 $d$。互易关系为：\n$4.$ $b F_{1\\to 2} = c F_{2\\to 1}$\n$5.$ $b F_{1\\to 3} = d F_{3\\to 1}$\n$6.$ $c F_{2\\to 3} = d F_{3\\to 2}$\n\n我们寻求 $F_{1\\to 2}$。一种强大的方法，称为 Hottel 的划线法（它是二维角系数积分的直接评估），可以应用于整个封闭体。封闭体中两组表面之间的净辐射交换可以与它们端点之间拉伸的线的长度相关联。考虑组合表面 $(1+2)$ 和表面 $3$ 之间的辐射交换。离开表面 $3$ 并被表面 $1$ 和 $2$ 截获的总能量为 $A_3 F_{3\\to(1+2)} = A_3 (F_{3\\to1} + F_{3\\to2})$。根据方程 $3'$，这等于 $A_3 (1) = A_3$。根据互易律，这必须等于离开表面 $1$ 和 $2$ 并被表面 $3$ 截获的能量：$A_1 F_{1\\to3} + A_2 F_{2\\to3}$。\n因此，我们有关系式：\n$d = b F_{1\\to 3} + c F_{2\\to 3}$\n\n我们现在有一个方程组。让我们用 $F_{1\\to 2}$ 来表示所有量：\n由 $1'$，我们有 $F_{1\\to 3} = 1 - F_{1\\to 2}$。\n由 $4'$，我们有 $F_{2\\to 1} = \\frac{b}{c} F_{1\\to 2}$。\n将其代入 $2'$：$\\frac{b}{c} F_{1\\to 2} + F_{2\\to 3} = 1 \\implies F_{2\\to 3} = 1 - \\frac{b}{c} F_{1\\to 2}$。\n\n现在，将 $F_{1\\to 3}$ 和 $F_{2\\to 3}$ 的表达式代入方程 $d = b F_{1\\to 3} + c F_{2\\to 3}$：\n$d = b(1 - F_{1\\to 2}) + c\\left(1 - \\frac{b}{c} F_{1\\to 2}\\right)$\n$d = b - b F_{1\\to 2} + c - b F_{1\\to 2}$\n$d = b + c - 2b F_{1\\to 2}$\n\n求解 $F_{1\\to 2}$：\n$2b F_{1\\to 2} = b + c - d$\n$F_{1\\to 2} = \\frac{b+c-d}{2b}$\n代入 $d = \\sqrt{b^2 + c^2}$：\n$$F_{1\\to 2} = \\frac{b+c-\\sqrt{b^2+c^2}}{2b}$$\n这个表达式可以写成无量纲比率 $C=c/b$ 的形式：\n$$F_{1\\to 2} = \\frac{1}{2}\\left(1 + \\frac{c}{b} - \\sqrt{1 + \\left(\\frac{c}{b}\\right)^2}\\right) = \\frac{1}{2}\\left(1 + C - \\sqrt{1 + C^2}\\right)$$\n这就是推导出的角系数的解析表达式。\n\n接下来，我们计算当表面 2 延伸时角系数的增加量 $\\Delta F_{1\\to 2}$。\n问题定义了 $\\Delta F_{1\\to 2} = F_{1\\to 2}(b,c_{\\text{new}}) - F_{1\\to 2}(b,c)$。\n可加性法则，$F_{1\\to(2_{\\text{orig}}\\cup 2_{\\text{ext}})} = F_{1\\to 2_{\\text{orig}}} + F_{1\\to 2_{\\text{ext}}}$，表明我们正在寻找的量，$F_{1\\to 2}(b,c_{\\text{new}}) - F_{1\\to 2}(b,c)$，恰好是从表面 $1$ 到表面 $2$ 延伸部分的角系数 $F_{1\\to 2_{\\text{ext}}}$。我们将使用推导出的公式直接计算所需的差值。\n\n给定值：\n表面 1 的宽度：$b = 0.40\\,\\text{m}$\n表面 2 的原始高度：$c = 0.30\\,\\text{m}$\n表面 2 的新高度：$c_{\\text{new}} = 0.40\\,\\text{m}$\n\n首先，计算原始配置的角系数 $F_{1\\to 2, \\text{orig}}$：\n比率为 $C = \\frac{c}{b} = \\frac{0.30}{0.40} = 0.75$。\n$F_{1\\to 2, \\text{orig}} = \\frac{1}{2}\\left(1 + 0.75 - \\sqrt{1 + (0.75)^2}\\right)$\n$F_{1\\to 2, \\text{orig}} = \\frac{1}{2}\\left(1.75 - \\sqrt{1 + 0.5625}\\right) = \\frac{1}{2}\\left(1.75 - \\sqrt{1.5625}\\right)$\n$F_{1\\to 2, \\text{orig}} = \\frac{1}{2}\\left(1.75 - 1.25\\right) = \\frac{1}{2}(0.50) = 0.25$。\n\n接下来，计算延伸配置的角系数 $F_{1\\to 2, \\text{new}}$：\n新的比率为 $C_{\\text{new}} = \\frac{c_{\\text{new}}}{b} = \\frac{0.40}{0.40} = 1.0$。\n$F_{1\\to 2, \\text{new}} = \\frac{1}{2}\\left(1 + 1.0 - \\sqrt{1 + (1.0)^2}\\right)$\n$F_{1\\to 2, \\text{new}} = \\frac{1}{2}\\left(2 - \\sqrt{2}\\right)$。\n\n最后，计算增加量 $\\Delta F_{1\\to 2}$：\n$\\Delta F_{1\\to 2} = F_{1\\to 2, \\text{new}} - F_{1\\to 2, \\text{orig}}$\n$\\Delta F_{1\\to 2} = \\frac{1}{2}(2 - \\sqrt{2}) - 0.25$\n我们使用值 $\\sqrt{2} \\approx 1.41421356237$。\n$\\Delta F_{1\\to 2} \\approx \\frac{1}{2}(2 - 1.41421356237) - 0.25$\n$\\Delta F_{1\\to 2} \\approx \\frac{1}{2}(0.58578643763) - 0.25$\n$\\Delta F_{1\\to 2} \\approx 0.29289321881 - 0.25$\n$\\Delta F_{1\\to 2} \\approx 0.04289321881$。\n\n问题要求将最终答案四舍五入至六位有效数字。\n$\\Delta F_{1\\to 2} \\approx 0.0428932$。\n计算完成。",
            "answer": "$$\n\\boxed{0.0428932}\n$$"
        },
        {
            "introduction": "虽然解析方法很强大，但大多数现实世界的问题都需要数值解。最后的这项实践通过让您编写一个程序，使用数值积分计算任意朝向的矩形表面间的角系数 $F_{1\\to 2}$，从而将理论与计算实践联系起来。 接着，您将进行敏感性分析，以确定哪些几何参数对辐射交换的影响最大，这是稳健工程设计和优化中的一项关键技能。",
            "id": "4003698",
            "problem": "考虑两个不透明的、漫反射的、等温的平面矩形表面，它们处于真空中，且它们之间没有遮挡。设表面 $\\mathrm{A}_1$ 以原点为中心，其外向单位法向量为 $\\mathbf{n}_1 = (0,0,1)$，平面内正交单位边方向为 $\\mathbf{u}_1 = (1,0,0)$ 和 $\\mathbf{v}_1 = (0,1,0)$。设 $\\mathrm{A}_2$ 以 $\\mathbf{c}_2 = (x_0,0,d)$ 为中心，其外向单位法向量 $\\mathbf{n}_2$ 是通过将向量 $(0,0,-1)$ 绕 $y$ 轴进行角度为 $\\alpha$（以弧度为单位）的右手旋转得到的，即 $\\mathbf{n}_2 = R_y(\\alpha)\\,(0,0,-1)$。其平面内正交单位边方向为 $\\mathbf{u}_2 = R_y(\\alpha)\\,(1,0,0)$ 和 $\\mathbf{v}_2 = (0,1,0)$，其中 $R_y(\\alpha)$ 是绕 $y$ 轴旋转 $\\alpha$ 的标准旋转矩阵。矩形 $\\mathrm{A}_1$ 和 $\\mathrm{A}_2$ 的完整宽度和高度分别为 $(w_1,h_1)$ 和 $(w_2,h_2)$，面积分别为 $A_1 = w_1 h_1$ 和 $A_2 = w_2 h_2$。所有长度必须以米（m）表示，所有角度必须以弧度表示。\n\n从 $\\mathrm{A}_1$ 到 $\\mathrm{A}_2$ 的辐射角系数，记为 $F_{1\\to 2}$，由第一性原理通过半球无遮挡形态因子积分定义：\n$$\nF_{1\\to 2} \\;=\\; \\frac{1}{A_1} \\int_{\\mathrm{A}_1} \\int_{\\mathrm{A}_2} \\frac{\\max(0,\\cos\\theta_1)\\,\\max(0,\\cos\\theta_2)}{\\pi\\,\\lVert \\mathbf{r}\\rVert^2}\\, \\mathrm{d}A_2\\, \\mathrm{d}A_1,\n$$\n其中 $\\mathbf{r} = \\mathbf{x}_2 - \\mathbf{x}_1$，$\\cos\\theta_1 = \\hat{\\mathbf{r}}\\cdot \\mathbf{n}_1$，$\\cos\\theta_2 = (-\\hat{\\mathbf{r}})\\cdot \\mathbf{n}_2$，且 $\\hat{\\mathbf{r}} = \\mathbf{r}/\\lVert \\mathbf{r}\\rVert$。函数 $\\max(0,\\cdot)$ 强制执行半球可见性约束，并忽略了相互遮挡。\n\n您的任务是设计并实现一个程序，该程序：\n- 使用张量积高斯求积法在每个矩形上数值计算 $F_{1\\to 2}$，每个表面的每个平面内坐标至少使用 $n = 6$ 个横坐标点，将标准区间 $[-1,1]$ 映射到每个矩形的参数域。对于 $k\\in\\{1,2\\}$，使用映射 $\\mathbf{x}_k(s,t) = \\mathbf{c}_k + s\\,\\mathbf{u}_k + t\\,\\mathbf{v}_k$，其中 $(s,t)\\in[-\\tfrac{w_k}{2},\\tfrac{w_k}{2}]\\times[-\\tfrac{h_k}{2},\\tfrac{h_k}{2}]$。\n- 对 $F_{1\\to 2}$ 相对于五个几何参数 $\\mathbf{p} = [x_0,\\; d,\\; \\alpha,\\; w_2,\\; h_2]$ 进行一阶微扰（灵敏度）分析。对每个分量 $p_k$ 使用对称中心差分：\n$$\n\\frac{\\partial F_{1\\to 2}}{\\partial p_k} \\;\\approx\\; \\frac{F_{1\\to 2}(\\mathbf{p}+\\delta_k \\mathbf{e}_k) - F_{1\\to 2}(\\mathbf{p}-\\delta_k \\mathbf{e}_k)}{2\\,\\delta_k},\n$$\n微扰幅度为\n$$\n\\delta_k \\;=\\; \\eta \\,\\max\\!\\big(|p_k|,\\; s_k\\big),\n$$\n其中 $\\eta = 10^{-4}$ 是无量纲的，参考尺度对于每个类长度参数（米）为 $s_k = 1$，对于类角度参数（弧度）为 $s_k = 1$。角度必须以弧度为单位，长度以米为单位。确保微扰后的尺寸 $w_2$ 和 $h_2$ 保持严格为正。\n- 计算无量纲的归一化灵敏度，以便进行跨参数比较：\n$$\nS_k \\;=\\; \\frac{\\max(|p_k|,s_k)}{\\max(|F_{1\\to 2}|,\\delta_F)} \\,\\left|\\,\\frac{\\partial F_{1\\to 2}}{\\partial p_k}\\right|,\n$$\n其中 $\\delta_F = 10^{-12}$。\n- 识别与最敏感参数对应的索引 $k^\\star \\in \\{0,1,2,3,4\\}$，即最大化 $S_k$ 的 $k$。\n\n对于所有计算，积分核中的 $\\pi$ 应按其精确定义使用，并通过 $\\max(0,\\cdot)$ 因子强制执行半球约束。除半球约束外，忽略任何形式的遮挡或阴影。\n\n测试套件：\n评估以下三种情况。每个元组按顺序列出 $(w_1,h_1,w_2,h_2,d,x_0,\\alpha)$，单位为米和弧度。\n\n- 情况 #1：$(1.0,\\,1.0,\\,1.2,\\,0.8,\\,1.0,\\,0.2,\\,0.3)$\n- 情况 #2：$(1.0,\\,0.8,\\,0.6,\\,1.1,\\,0.5,\\,0.1,\\,1.2)$\n- 情况 #3：$(1.0,\\,1.0,\\,1.0,\\,1.0,\\,3.0,\\,0.0,\\,0.4)$\n\n输出要求：\n- 对于每种情况，输出一个列表，包含：\n  $[F_{1\\to 2},\\; \\tfrac{\\partial F}{\\partial x_0},\\; \\tfrac{\\partial F}{\\partial d},\\; \\tfrac{\\partial F}{\\partial \\alpha},\\; \\tfrac{\\partial F}{\\partial w_2},\\; \\tfrac{\\partial F}{\\partial h_2},\\; S_{x_0},\\; S_d,\\; S_{\\alpha},\\; S_{w_2},\\; S_{h_2},\\; k^\\star]$，\n  其中 $F_{1\\to 2}$ 是无量纲的，偏导数的单位分别为每米或每弧度，而 $S_k$ 是无量纲的。索引 $k^\\star$ 对于 $x_0$ 是 $0$，对于 $d$ 是 $1$，对于 $\\alpha$ 是 $2$，对于 $w_2$ 是 $3$，对于 $h_2$ 是 $4$。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表由三个按情况排列的列表组成，无空格，并用一对单独的方括号括起来，例如：`[[\\cdots],[\\cdots],[\\cdots]]`。",
            "solution": "问题陈述已经过严格验证，被认为是**有效**的。它在科学上基于辐射传热原理，在数学上是自洽的，并且在算法上是适定的。所有参数、定义和约束都已足够清晰地指定，以允许一个唯一且有意义的数值解。该任务要求应用已建立的数值方法——即用于多维积分的高斯求积法和用于灵敏度分析的中心差分法——来解决一个标准的工程问题。\n\n问题的核心是计算两个平面矩形 $\\mathrm{A}_1$ 和 $\\mathrm{A}_2$ 之间的辐射角系数 $F_{1\\to 2}$，该系数由四维积分定义：\n$$\nF_{1\\to 2} \\;=\\; \\frac{1}{A_1} \\int_{\\mathrm{A}_1} \\int_{\\mathrm{A}_2} \\frac{\\max(0,\\cos\\theta_1)\\,\\max(0,\\cos\\theta_2)}{\\pi\\,\\lVert \\mathbf{r}\\rVert^2}\\, \\mathrm{d}A_2\\, \\mathrm{d}A_1\n$$\n此处，$\\mathbf{r} = \\mathbf{x}_2 - \\mathbf{x}_1$ 是连接表面 $\\mathrm{A}_1$ 上一点 $\\mathbf{x}_1$ 与表面 $\\mathrm{A}_2$ 上一点 $\\mathbf{x}_2$ 的向量。角度 $\\theta_1$ 和 $\\theta_2$ 分别是视线向量 $\\mathbf{r}$ 与各自表面法线 $\\mathbf{n}_1$ 和 $\\mathbf{n}_2$ 之间的夹角。\n\n几何配置定义如下：\n表面 $\\mathrm{A}_1$ 以原点 $\\mathbf{c}_1 = (0,0,0)$ 为中心，尺寸为 $(w_1, h_1)$。其方向由外向法线 $\\mathbf{n}_1 = (0,0,1)$ 和平面内基向量 $\\mathbf{u}_1 = (1,0,0)$ 与 $\\mathbf{v}_1 = (0,1,0)$ 给出。\n表面 $\\mathrm{A}_2$ 的尺寸为 $(w_2, h_2)$，以 $\\mathbf{c}_2 = (x_0,0,d)$ 为中心。其方向由绕 $y$ 轴旋转角度 $\\alpha$ 决定。旋转矩阵为：\n$$\nR_y(\\alpha) = \\begin{pmatrix} \\cos\\alpha  0  \\sin\\alpha \\\\ 0  1  0 \\\\ -\\sin\\alpha  0  \\cos\\alpha \\end{pmatrix}\n$$\n因此，$\\mathrm{A}_2$ 的方向向量为 $\\mathbf{n}_2 = R_y(\\alpha)\\,(0,0,-1)^T = (-\\sin\\alpha, 0, -\\cos\\alpha)^T$，$\\mathbf{u}_2 = R_y(\\alpha)\\,(1,0,0)^T = (\\cos\\alpha, 0, -\\sin\\alpha)^T$，以及 $\\mathbf{v}_2 = (0,1,0)^T$。\n\n每个表面上的点被参数化。对于 $k \\in \\{1,2\\}$，点 $\\mathbf{x}_k$ 由 $\\mathbf{x}_k(s_k, t_k) = \\mathbf{c}_k + s_k\\,\\mathbf{u}_k + t_k\\,\\mathbf{v}_k$ 给出，其中 $s_k \\in [-\\frac{w_k}{2}, \\frac{w_k}{2}]$ 且 $t_k \\in [-\\frac{h_k}{2}, \\frac{h_k}{2}]$。\n\n为了数值计算该积分，我们采用张量积高斯求积法。$s_k$ 和 $t_k$ 的积分域被映射到标准求积区间 $[-1,1]$。设 $\\xi$ 和 $\\zeta$ 为 $[-1,1]$ 中的求积坐标。映射关系为：\n$s_k = \\frac{w_k}{2} \\xi_k$ 和 $t_k = \\frac{h_k}{2} \\zeta_k$。\n因此，微分面积元变换为：\n$\\mathrm{d}A_k = \\mathrm{d}s_k \\mathrm{d}t_k = (\\frac{w_k}{2} \\mathrm{d}\\xi_k) (\\frac{h_k}{2} \\mathrm{d}\\zeta_k) = \\frac{A_k}{4} \\mathrm{d}\\xi_k \\mathrm{d}\\zeta_k$。\n\n将这些代入角系数定义中：\n$$\nF_{1\\to 2} = \\frac{1}{A_1} \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 K(\\xi_1,\\zeta_1,\\xi_2,\\zeta_2) \\left(\\frac{A_2}{4}\\mathrm{d}\\xi_2 \\mathrm{d}\\zeta_2\\right) \\left(\\frac{A_1}{4}\\mathrm{d}\\xi_1 \\mathrm{d}\\zeta_1\\right) = \\frac{A_2}{16} \\int_{[-1,1]^4} K(\\dots) \\mathrm{d}\\xi_1 \\mathrm{d}\\zeta_1 \\mathrm{d}\\xi_2 \\mathrm{d}\\zeta_2\n$$\n其中 $K$ 是积分核。使用具有横坐标点 $\\{u_i\\}$ 和权重 $\\{w_i\\}$ 的 $n$ 点高斯求积法则，积分可近似为加权和：\n$$\nF_{1\\to 2} \\approx \\frac{A_2}{16} \\sum_{i=1}^n \\sum_{j=1}^n \\sum_{k=1}^n \\sum_{l=1}^n w_i w_j w_k w_l \\, K_{ijkl}\n$$\n其中 $K_{ijkl}$ 是在对应于横坐标点 $(u_i, u_j, u_k, u_l)$ 的 $(\\xi_1, \\zeta_1, \\xi_2, \\zeta_2)$ 点处求值的核函数。问题规定 $n \\ge 6$；我们选择 $n=6$。\n\n灵敏度分析使用二阶精度的对称中心差分近似来计算关于参数向量 $\\mathbf{p} = [x_0, d, \\alpha, w_2, h_2]$ 的偏导数。对于每个参数 $p_k$：\n$$\n\\frac{\\partial F_{1\\to 2}}{\\partial p_k} \\approx \\frac{F_{1\\to 2}(\\mathbf{p}+\\delta_k \\mathbf{e}_k) - F_{1\\to 2}(\\mathbf{p}-\\delta_k \\mathbf{e}_k)}{2\\,\\delta_k}\n$$\n微扰步长 $\\delta_k$ 定义为 $\\delta_k = \\eta \\,\\max(|p_k|, s_k)$，其中 $\\eta = 10^{-4}$，所有参数的参考尺度 $s_k=1$。这需要额外进行 $2N_p = 10$ 次角系数积分的计算。\n\n最后，为了比较每个参数的相对重要性，计算一个无量纲的归一化灵敏度 $S_k$：\n$$\nS_k = \\frac{\\max(|p_k|,s_k)}{\\max(|F_{1\\to 2}|, \\delta_F)} \\left| \\frac{\\partial F_{1\\to 2}}{\\partial p_k} \\right|\n$$\n其中 $\\delta_F = 10^{-12}$ 是一个下限值，以防止除以一个非常小的角系数。具有最高 $S_k$ 的参数被确定为影响最大的参数，并报告其索引 $k^\\star \\in \\{0, 1, 2, 3, 4\\}$。\n\n实现将包括一个主函数，用于使用所述的求积方案计算 $F_{1\\to 2}$。然后，一个包装器会重复调用此函数，管理用于灵敏度分析的参数微扰，并计算最终的归一化灵敏度。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_view_factor(w1, h1, w2, h2, d, x0, alpha, n=6):\n    \"\"\"\n    Numerically evaluates the view factor F_1->2 using Gaussian quadrature.\n    \"\"\"\n    if w1 == 0 or h1 == 0 or w2 == 0 or h2 == 0:\n        return 0.0\n\n    abscissae, weights = np.polynomial.legendre.leggauss(n)\n    \n    A2 = w2 * h2\n\n    # Define geometry for surface 1\n    c1 = np.array([0.0, 0.0, 0.0])\n    n1 = np.array([0.0, 0.0, 1.0])\n    u1_vec = np.array([1.0, 0.0, 0.0])\n    v1_vec = np.array([0.0, 1.0, 0.0])\n\n    # Define geometry for surface 2\n    c2 = np.array([x0, 0.0, d])\n    cos_a, sin_a = np.cos(alpha), np.sin(alpha)\n    Ry = np.array([[cos_a, 0.0, sin_a], [0.0, 1.0, 0.0], [-sin_a, 0.0, cos_a]])\n    n2 = Ry @ np.array([0.0, 0.0, -1.0])\n    u2_vec = Ry @ np.array([1.0, 0.0, 0.0])\n    v2_vec = np.array([0.0, 1.0, 0.0])\n\n    s1_map = w1 / 2.0\n    t1_map = h1 / 2.0\n    s2_map = w2 / 2.0\n    t2_map = h2 / 2.0\n\n    x1_pts = []\n    w1_wts = []\n    for i in range(n):\n        s1 = s1_map * abscissae[i]\n        for j in range(n):\n            t1 = t1_map * abscissae[j]\n            x1_pts.append(c1 + s1 * u1_vec + t1 * v1_vec)\n            w1_wts.append(weights[i] * weights[j])\n\n    x2_pts = []\n    w2_wts = []\n    for k in range(n):\n        s2 = s2_map * abscissae[k]\n        for l in range(n):\n            t2 = t2_map * abscissae[l]\n            x2_pts.append(c2 + s2 * u2_vec + t2 * v2_vec)\n            w2_wts.append(weights[k] * weights[l])\n            \n    integral_sum = 0.0\n    for i in range(n*n):\n        x1 = x1_pts[i]\n        for j in range(n*n):\n            x2 = x2_pts[j]\n            \n            r_vec = x2 - x1\n            r_norm_sq = np.dot(r_vec, r_vec)\n\n            # Avoid division by zero for coincident points.\n            if r_norm_sq < 1e-20:\n                continue\n\n            r_norm = np.sqrt(r_norm_sq)\n            r_hat = r_vec / r_norm\n\n            cos_theta1 = np.dot(r_hat, n1)\n            cos_theta2 = np.dot(-r_hat, n2)\n\n            if cos_theta1 > 0 and cos_theta2 > 0:\n                kernel = (cos_theta1 * cos_theta2) / (np.pi * r_norm_sq)\n                integral_sum += w1_wts[i] * w2_wts[j] * kernel\n\n    # The mapping from [-1,1]^4 to the full area integral yields a factor of (A1/4)*(A2/4).\n    # The view factor is (1/A1) * Integral, so the pre-factor is (A2/4).\n    # wait - integral is sum(w_i..w_l * kernel). Mapping was already done.\n    # dF12 = dA1/A1 * integral_over_A2(kernel * dA2)\n    # F12 = integral_over_A1(integral_over_A2(kernel*dA2)*(dA1/A1))\n    #     = 1/A1 * sum( (w_i*h_i/4) * w1_wts * sum( (w_j*h_j/4) * w2_wts * kernel ) )\n    #     = (A1*A2/16/A1) * sum(wts*kernel) = (A2/16) * sum(wts*kernel)\n    F12 = (A2 / 16.0) * integral_sum\n    return F12\n\ndef solve():\n    test_cases = [\n        # (w1, h1, w2, h2, d, x0, alpha)\n        (1.0, 1.0, 1.2, 0.8, 1.0, 0.2, 0.3),\n        (1.0, 0.8, 0.6, 1.1, 0.5, 0.1, 1.2),\n        (1.0, 1.0, 1.0, 1.0, 3.0, 0.0, 0.4),\n    ]\n\n    all_results = []\n\n    eta = 1e-4\n    delta_F = 1e-12\n    s_k = 1.0  # reference scale for all parameters\n\n    for case in test_cases:\n        w1, h1, w2, h2, d, x0, alpha = case\n        \n        # Calculate nominal view factor\n        F12_nominal = calculate_view_factor(w1, h1, w2, h2, d, x0, alpha)\n        \n        p = np.array([x0, d, alpha, w2, h2])\n        derivatives = []\n        sensitivities = []\n        \n        def eval_F(params):\n            _x0, _d, _alpha, _w2, _h2 = params\n            return calculate_view_factor(w1, h1, _w2, _h2, _d, _x0, _alpha)\n            \n        for k in range(len(p)):\n            pk = p[k]\n            delta_k = eta * max(abs(pk), s_k)\n            \n            p_plus = p.copy()\n            p_plus[k] += delta_k\n            \n            p_minus = p.copy()\n            p_minus[k] -= delta_k\n\n            # Ensure widths and heights remain positive\n            if k in [3, 4] and p_minus[k] <= 0:\n              # Fallback to forward difference if central difference would create invalid geometry\n                F_nominal_for_fd = eval_F(p)\n                F_plus = eval_F(p_plus)\n                deriv = (F_plus - F_nominal_for_fd) / delta_k\n            else:\n                F_plus = eval_F(p_plus)\n                F_minus = eval_F(p_minus)\n                deriv = (F_plus - F_minus) / (2.0 * delta_k)\n\n            derivatives.append(deriv)\n            \n            norm_factor_p = max(abs(pk), s_k)\n            norm_factor_F = max(abs(F12_nominal), delta_F)\n            S_k = (norm_factor_p / norm_factor_F) * abs(deriv)\n            sensitivities.append(S_k)\n            \n        k_star = np.argmax(sensitivities)\n        \n        case_results = [F12_nominal] + derivatives + sensitivities + [int(k_star)]\n        all_results.append(case_results)\n\n    # Format the output string precisely as requested\n    list_of_strings = []\n    for res in all_results:\n        list_of_strings.append(f\"[{','.join(f'{v:.10e}' for v in res[:-1])},{int(res[-1])}]\")\n    final_output_str = f\"[{','.join(list_of_strings)}]\"\n    print(final_output_str)\n\nsolve()\n\n```"
        }
    ]
}