{
    "hands_on_practices": [
        {
            "introduction": "This exercise will guide you through a fundamental derivation for one of the simplest and most important configurations: two concentric spheres. By starting from basic principles, such as the summation rule for enclosures, you will prove why all radiation from the inner sphere must reach the outer one. This practice is essential for building a solid theoretical foundation and includes a required proof of the reciprocity relation, a cornerstone of view factor analysis .",
            "id": "4003697",
            "problem": "Consider a radiative enclosure consisting of two perfectly diffuse, opaque, isothermal, concentric spherical surfaces in vacuum, with no participating medium. The inner sphere has radius $R_1$ and surface area $A_1$, and the outer sphere has radius $R_2$ and surface area $A_2$, where $R_2 > R_1$. Let $F_{i\\to j}$ denote the geometric view factor (also called the configuration factor) from surface $i$ to surface $j$. Assume there are no other surfaces in the enclosure. Starting from the integral definition of the view factor for diffuse surfaces and fundamental radiative exchange conservation, derive the necessary relations to compute the view factors $F_{1\\to 2}$ and $F_{2\\to 1}$. Your derivation should start from the integral definition of $F_{i\\to j}$, justify any enclosure properties used from first principles, and prove the reciprocity relation before applying it. Express your final answer as the ordered pair $(F_{1\\to 2}, F_{2\\to 1})$ in a single row matrix. No rounding is required and no units should be included in the final answer.",
            "solution": "The problem as stated is subjected to validation against the established criteria.\n\n### Step 1: Extract Givens\n- **System:** A radiative enclosure consisting of two concentric spherical surfaces.\n- **Surfaces:**\n  - Inner sphere (surface $1$): radius $R_1$, surface area $A_1$.\n  - Outer sphere (surface $2$): radius $R_2$, surface area $A_2$.\n- **Surface Properties:** Perfectly diffuse, opaque, isothermal.\n- **Medium:** Vacuum, no participating medium.\n- **Geometric Constraint:** $R_2 > R_1$.\n- **Enclosure Definition:** The enclosure consists only of surfaces $1$ and $2$.\n- **Notation:** $F_{i\\to j}$ denotes the geometric view factor from surface $i$ to surface $j$.\n- **Required Derivation:** Compute $F_{1\\to 2}$ and $F_{2\\to 1}$ starting from the integral definition of the view factor, justifying all properties used including a proof of the reciprocity relation.\n- **Output Format:** An ordered pair $(F_{1\\to 2}, F_{2\\to 1})$ in a single row matrix.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is based on the fundamental principles of radiative heat transfer, specifically the concept of view factors in an enclosure. This is a canonical problem in thermal engineering and physics. The model is scientifically sound.\n2.  **Well-Posed:** The problem provides a complete physical description of the system (two concentric spheres forming an enclosure) and asks for the determination of specific, uniquely defined quantities ($F_{1\\to 2}$ and $F_{2\\to 1}$). The information is sufficient to derive a unique solution.\n3.  **Objective:** The language is precise and uses standard scientific terminology. There are no subjective or ambiguous statements.\n4.  **Completeness and Consistency:** The problem is self-contained. The geometry is fully specified. The surface properties are clearly defined. There are no contradictions. The areas $A_1 = 4\\pi R_1^2$ and $A_2 = 4\\pi R_2^2$ are standard geometric formulas that can be assumed known.\n5.  **Realism and Feasibility:** The physical setup, while an idealization, is a common and reasonable approximation for many real-world systems (e.g., cryostats, satellites). The conditions are physically plausible.\n\n### Step 3: Verdict and Action\nThe problem is determined to be **valid**. It is a well-posed, scientifically sound, and non-trivial problem that requires derivation from first principles as requested. The solution process may now proceed.\n\n### Solution Derivation\nThe objective is to determine the view factors $F_{1\\to 2}$ and $F_{2\\to 1}$ for an enclosure formed by two concentric spheres. The derivation will proceed from first principles.\n\n**1. The Summation Rule for Enclosures**\n\nFor any surface $i$ that is part of an enclosure comprising $N$ surfaces, the conservation of radiative energy requires that the sum of the fractions of energy leaving surface $i$ that strike all surfaces $j$ in the enclosure (including itself) must be unity. This is expressed as the summation rule:\n$$ \\sum_{j=1}^{N} F_{i\\to j} = 1 $$\nIn our system, the enclosure consists of two surfaces, the inner sphere (surface $1$) and the outer sphere (surface $2$). Thus, $N=2$.\n\n**2. Calculation of $F_{1\\to 2}$**\n\nApplying the summation rule to the inner sphere (surface $1$):\n$$ F_{1\\to 1} + F_{1\\to 2} = 1 $$\nThe view factor $F_{1\\to 1}$ represents the fraction of radiation leaving the surface of the inner sphere that strikes itself. The inner sphere is a convex surface. For any convex surface, a straight line connecting any two points on the surface lies entirely on one side of the surface (except for the endpoints themselves). Consequently, no differential area on a convex surface can \"see\" any other differential area on the same surface. Therefore, no radiation leaving surface $1$ can be intercepted by surface $1$. This means:\n$$ F_{1\\to 1} = 0 $$\nSubstituting this into the summation rule for surface $1$:\n$$ 0 + F_{1\\to 2} = 1 $$\n$$ F_{1\\to 2} = 1 $$\nThis result is physically intuitive: since the inner sphere is completely enclosed by the outer sphere, all radiation emitted from its surface must, by necessity, strike the inner surface of the outer sphere.\n\n**3. The Reciprocity Relation**\n\nTo find $F_{2\\to 1}$, we will first derive the reciprocity relation from the fundamental integral definition of the view factor. The view factor from a finite area $A_i$ to another finite area $A_j$ for diffuse surfaces is defined as:\n$$ F_{i\\to j} = \\frac{1}{A_i} \\int_{A_i} \\int_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2} dA_j dA_i $$\nHere, $dA_i$ and $dA_j$ are differential area elements on surfaces $A_i$ and $A_j$, respectively. The distance between these elements is $r$. The angles $\\theta_i$ and $\\theta_j$ are the angles between the line connecting the differential elements and their respective surface normals.\n\nLet's write the expression for the product $A_i F_{i\\to j}$:\n$$ A_i F_{i\\to j} = \\int_{A_i} \\int_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2} dA_j dA_i $$\nNow, let's write the corresponding expression for the product $A_j F_{j\\to i}$:\n$$ A_j F_{j\\to i} = A_j \\left( \\frac{1}{A_j} \\int_{A_j} \\int_{A_i} \\frac{\\cos\\theta_j \\cos\\theta_i}{\\pi r^2} dA_i dA_j \\right) $$\n$$ A_j F_{j\\to i} = \\int_{A_j} \\int_{A_i} \\frac{\\cos\\theta_j \\cos\\theta_i}{\\pi r^2} dA_i dA_j $$\nThe integrand $\\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2}$ is symmetric with respect to the interchange of indices $i$ and $j$. Since the integration is over the same domains $A_i$ and $A_j$ in both expressions, the order of integration can be swapped without changing the value of the double integral. Therefore:\n$$ \\int_{A_i} \\int_{A_j} \\frac{\\cos\\theta_i \\cos\\theta_j}{\\pi r^2} dA_j dA_i = \\int_{A_j} \\int_{A_i} \\frac{\\cos\\theta_j \\cos\\theta_i}{\\pi r^2} dA_i dA_j $$\nThis implies that the left-hand sides of the two expressions must be equal:\n$$ A_i F_{i\\to j} = A_j F_{j\\to i} $$\nThis is the reciprocity relation, which has been proven from the integral definition of the view factor.\n\n**4. Calculation of $F_{2\\to 1}$**\n\nWe now apply the proven reciprocity relation to surfaces $1$ and $2$:\n$$ A_1 F_{1\\to 2} = A_2 F_{2\\to 1} $$\nWe can solve for $F_{2\\to 1}$:\n$$ F_{2\\to 1} = \\frac{A_1}{A_2} F_{1\\to 2} $$\nWe previously found that $F_{1\\to 2} = 1$. The surface area of a sphere of radius $R$ is $4\\pi R^2$. Therefore, the areas of our surfaces are:\n$$ A_1 = 4\\pi R_1^2 $$\n$$ A_2 = 4\\pi R_2^2 $$\nSubstituting these expressions and the value of $F_{1\\to 2}$ into the equation for $F_{2\\to 1}$:\n$$ F_{2\\to 1} = \\frac{4\\pi R_1^2}{4\\pi R_2^2} \\times 1 $$\n$$ F_{2\\to 1} = \\frac{R_1^2}{R_2^2} = \\left(\\frac{R_1}{R_2}\\right)^2 $$\nThis result represents the fraction of radiation leaving the inner surface of the outer sphere that is intercepted by the inner sphere. The remaining fraction, $1 - F_{2\\to 1}$, strikes the outer sphere itself ($F_{2\\to 2} = 1 - (R_1/R_2)^2$), which is possible because the outer sphere is a concave surface.\n\nThe derived view factors are $F_{1\\to 2} = 1$ and $F_{2\\to 1} = (R_1/R_2)^2$. The problem asks for the ordered pair $(F_{1\\to 2}, F_{2\\to 1})$ in a single row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\left(\\frac{R_1}{R_2}\\right)^2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Direct integration of the view factor is often complex; fortunately, we can use powerful properties to find elegant solutions for certain geometries. This practice demonstrates this by analyzing two infinitely long perpendicular plates, a common 2D simplification. You will use the enclosure method and view factor algebra to derive the view factor without performing the full integration, and then apply the additivity rule to quantify the effect of geometric changes .",
            "id": "4003676",
            "problem": "Consider two diffuse, gray, isothermal, and opaque rectangular surfaces forming a right-angle dihedral and sharing a common edge along the line segment where they meet. Surface $1$ lies in the plane $z=0$ and spans the region $\\{(x,y,0): x\\in\\mathbb{R},\\ y\\in[0,b]\\}$; surface $2$ lies in the plane $y=0$ and spans the region $\\{(x,0,z): x\\in\\mathbb{R},\\ z\\in[0,c]\\}$. Both surfaces are translationally invariant along the $x$-direction (effectively very long), and the common edge is the line $\\{(x,0,0): x\\in\\mathbb{R}\\}$. Let the width of surface $1$ be $b$ and the height of surface $2$ be $c$. The radiative view factor $F_{1\\to 2}$ is defined as the fraction of the total diffuse radiative energy leaving surface $1$ that is intercepted by surface $2$.\n\nStarting from the fundamental area-to-area definition of the view factor between two diffuse surfaces,\n$$\nF_{1\\to 2} \\equiv \\frac{1}{A_1}\\int_{A_1}\\int_{A_2}\\frac{\\cos\\theta_1\\,\\cos\\theta_2}{\\pi\\,r^2}\\,\\mathrm{d}A_2\\,\\mathrm{d}A_1,\n$$\nwhere $A_1$ is the area of surface $1$, $r$ is the distance between differential area elements, and $\\theta_1$ and $\\theta_2$ are the angles those elements make with the line connecting them, derive $F_{1\\to 2}$ for the given geometry by treating a finite segment of length $L$ along $x$, then taking the limit $L\\to\\infty$. Use the additivity property of view factors to quantify the increase in $F_{1\\to 2}$ when surface $2$ is extended beyond the shared edge along the $z$-direction.\n\nLet $b=0.40\\,\\text{m}$ and $c=0.30\\,\\text{m}$ for the original configuration, and extend surface $2$ to $c_{\\text{new}}=0.40\\,\\text{m}$. Using the additivity property $F_{1\\to (2_{\\text{orig}}\\cup 2_{\\text{ext}})} = F_{1\\to 2_{\\text{orig}}} + F_{1\\to 2_{\\text{ext}}}$, compute the increase in the view factor $\\Delta F_{1\\to 2} = F_{1\\to 2}(b,c_{\\text{new}}) - F_{1\\to 2}(b,c)$.\n\nRound your final numerical answer to six significant figures. The view factor is dimensionless; do not include units in your final answer.",
            "solution": "The problem statement is first subjected to a validation process.\n\n### Step 1: Extract Givens\n- **Geometry**: Two diffuse, gray, isothermal, opaque rectangular surfaces forming a right-angle dihedral, sharing a common edge.\n- **Surface 1**: Lies in the plane $z=0$, spanning $\\{(x,y,0): x\\in\\mathbb{R},\\ y\\in[0,b]\\}$. Width is $b$.\n- **Surface 2**: Lies in the plane $y=0$, spanning $\\{(x,0,z): x\\in\\mathbb{R},\\ z\\in[0,c]\\}$. Height is $c$.\n- **Common Edge**: The line $\\{(x,0,0): x\\in\\mathbb{R}\\}$.\n- **Symmetry**: Both surfaces are translationally invariant along the $x$-direction (infinitely long).\n- **View Factor Definition**: $F_{1\\to 2} \\equiv \\frac{1}{A_1}\\int_{A_1}\\int_{A_2}\\frac{\\cos\\theta_1\\,\\cos\\theta_2}{\\pi\\,r^2}\\,\\mathrm{d}A_2\\,\\mathrm{d}A_1$.\n- **Derivation Task**: Derive $F_{1\\to 2}$ for this geometry by starting from the fundamental definition, considering a finite length $L$ and taking the limit $L\\to\\infty$.\n- **Additivity Property**: $F_{1\\to (2_{\\text{orig}}\\cup 2_{\\text{ext}})} = F_{1\\to 2_{\\text{orig}}} + F_{1\\to 2_{\\text{ext}}}$.\n- **Numerical Values**: For the original configuration, $b=0.40\\,\\text{m}$ and $c=0.30\\,\\text{m}$.\n- **Modification**: Surface $2$ is extended to a new height $c_{\\text{new}}=0.40\\,\\text{m}$.\n- **Calculation Task**: Compute the increase in the view factor, $\\Delta F_{1\\to 2} = F_{1\\to 2}(b,c_{\\text{new}}) - F_{1\\to 2}(b,c)$.\n- **Rounding Requirement**: The final numerical answer must be rounded to six significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded**: The problem is a classic exercise in radiative heat transfer, a sub-discipline of thermal engineering. The geometry, properties of surfaces, and the definition of the view factor are all standard and scientifically correct. The properties of view factors, such as additivity and reciprocity, are fundamental principles.\n- **Well-Posed**: The problem is well-posed. The geometry is specified unambiguously. The quantities to be derived and calculated are clearly defined. The given information is sufficient and self-consistent for finding a unique solution.\n- **Objective**: The problem is stated in precise, objective, and technical language, free from any subjectivity or bias.\n\n### Step 3: Verdict and Action\nThe problem is found to be valid. It is scientifically sound, well-posed, and objective. A solution will be provided.\n\nThe problem asks for a derivation of the view factor $F_{1\\to 2}$ for two infinitely long perpendicular plates sharing a common edge. The starting point is the general four-dimensional integral definition of the view factor. However, the condition of infinite length (translational invariance along the $x$-axis) simplifies the problem from three dimensions to two. This simplification allows for the use of powerful 2D methods, which are themselves derived from the fundamental integral definition. The most elegant and physically insightful of these methods is the enclosure method (also known as view factor algebra), which we shall employ.\n\nConsider the cross-section of the system in the $y-z$ plane. Surface $1$ is a line segment of length $b$ along the $y$-axis, from $(y,z)=(0,0)$ to $(b,0)$. Surface $2$ is a line segment of length $c$ along the $z$-axis, from $(0,0)$ to $(0,c)$. To form a closed system (an enclosure), we introduce a hypothetical third surface, $A_3$, which is the line segment connecting the endpoints $(b,0)$ and $(0,c)$. The length of this surface, denoted by $d$, is given by the Pythagorean theorem: $d = \\sqrt{b^2 + c^2}$.\n\nFor an enclosure of $N$ surfaces, the summation rule states that the sum of view factors from any surface $i$ to all other surfaces (including itself) must be unity: $\\sum_{j=1}^{N} F_{i\\to j} = 1$.\nFor our 3-surface enclosure, we have:\n$1.$ $F_{1\\to 1} + F_{1\\to 2} + F_{1\\to 3} = 1$\n$2.$ $F_{2\\to 1} + F_{2\\to 2} + F_{2\\to 3} = 1$\n$3.$ $F_{3\\to 1} + F_{3\\to 2} + F_{3\\to 3} = 1$\n\nSince surfaces $1$, $2$, and $3$ are all flat (in the 2D cross-section, they are line segments), a surface cannot \"see\" itself. Thus, $F_{1\\to 1} = 0$, $F_{2\\to 2} = 0$, and $F_{3\\to 3} = 0$. The summation rules simplify to:\n$1'.$ $F_{1\\to 2} + F_{1\\to 3} = 1$\n$2'.$ $F_{2\\to 1} + F_{2\\to 3} = 1$\n$3'.$ $F_{3\\to 1} + F_{3\\to 2} = 1$\n\nAnother fundamental principle is the reciprocity rule, which states that for any two surfaces $i$ and $j$, $A_i F_{i\\to j} = A_j F_{j\\to i}$. For our 2D problem, the \"areas\" per unit length are simply the widths $b$, $c$, and $d$. The reciprocity relations are:\n$4.$ $b F_{1\\to 2} = c F_{2\\to 1}$\n$5.$ $b F_{1\\to 3} = d F_{3\\to 1}$\n$6.$ $c F_{2\\to 3} = d F_{3\\to 2}$\n\nWe seek $F_{1\\to 2}$. A powerful method, known as Hottel's crossed-string method (which is a direct evaluation of the 2D view factor integral), can be applied to the entire enclosure. The net radiation exchange between two groups of surfaces in an enclosure can be related to the lengths of strings stretched between their endpoints. Consider the radiation exchange between the combined surface $(1+2)$ and surface $3$. The total energy leaving surface $3$ that is intercepted by surfaces $1$ and $2$ is $A_3 F_{3\\to(1+2)} = A_3 (F_{3\\to1} + F_{3\\to2})$. From equation $3'$, this is equal to $A_3 (1) = A_3$. By reciprocity, this must equal the energy leaving surfaces $1$ and $2$ that is intercepted by surface $3$: $A_1 F_{1\\to3} + A_2 F_{2\\to3}$.\nTherefore, we have the relation:\n$d = b F_{1\\to 3} + c F_{2\\to 3}$\n\nWe now have a system of equations. Let's express everything in terms of $F_{1\\to 2}$:\nFrom $1'$, we have $F_{1\\to 3} = 1 - F_{1\\to 2}$.\nFrom $4'$, we have $F_{2\\to 1} = \\frac{b}{c} F_{1\\to 2}$.\nSubstitute this into $2'$: $\\frac{b}{c} F_{1\\to 2} + F_{2\\to 3} = 1 \\implies F_{2\\to 3} = 1 - \\frac{b}{c} F_{1\\to 2}$.\n\nNow, substitute the expressions for $F_{1\\to 3}$ and $F_{2\\to 3}$ into the equation $d = b F_{1\\to 3} + c F_{2\\to 3}$:\n$d = b(1 - F_{1\\to 2}) + c\\left(1 - \\frac{b}{c} F_{1\\to 2}\\right)$\n$d = b - b F_{1\\to 2} + c - b F_{1\\to 2}$\n$d = b + c - 2b F_{1\\to 2}$\n\nSolving for $F_{1\\to 2}$:\n$2b F_{1\\to 2} = b + c - d$\n$F_{1\\to 2} = \\frac{b+c-d}{2b}$\nSubstituting $d = \\sqrt{b^2 + c^2}$:\n$$F_{1\\to 2} = \\frac{b+c-\\sqrt{b^2+c^2}}{2b}$$\nThis expression can be written in terms of the dimensionless ratio $C=c/b$:\n$$F_{1\\to 2} = \\frac{1}{2}\\left(1 + \\frac{c}{b} - \\sqrt{1 + \\left(\\frac{c}{b}\\right)^2}\\right) = \\frac{1}{2}\\left(1 + C - \\sqrt{1 + C^2}\\right)$$\nThis is the derived analytical expression for the view factor.\n\nNext, we compute the increase in the view factor, $\\Delta F_{1\\to 2}$, when surface $2$ is extended.\nThe problem defines $\\Delta F_{1\\to 2} = F_{1\\to 2}(b,c_{\\text{new}}) - F_{1\\to 2}(b,c)$.\nThe additivity rule, $F_{1\\to(2_{\\text{orig}}\\cup 2_{\\text{ext}})} = F_{1\\to 2_{\\text{orig}}} + F_{1\\to 2_{\\text{ext}}}$, states that the quantity we are looking for, $F_{1\\to 2}(b,c_{\\text{new}}) - F_{1\\to 2}(b,c)$, is precisely the view factor from surface $1$ to the extension part of surface $2$, $F_{1\\to 2_{\\text{ext}}}$. We will calculate the required difference directly using the derived formula.\n\nGiven values:\nWidth of surface $1$: $b = 0.40\\,\\text{m}$\nOriginal height of surface $2$: $c = 0.30\\,\\text{m}$\nNew height of surface $2$: $c_{\\text{new}} = 0.40\\,\\text{m}$\n\nFirst, calculate the view factor for the original configuration, $F_{1\\to 2, \\text{orig}}$:\nThe ratio is $C = \\frac{c}{b} = \\frac{0.30}{0.40} = 0.75$.\n$F_{1\\to 2, \\text{orig}} = \\frac{1}{2}\\left(1 + 0.75 - \\sqrt{1 + (0.75)^2}\\right)$\n$F_{1\\to 2, \\text{orig}} = \\frac{1}{2}\\left(1.75 - \\sqrt{1 + 0.5625}\\right) = \\frac{1}{2}\\left(1.75 - \\sqrt{1.5625}\\right)$\n$F_{1\\to 2, \\text{orig}} = \\frac{1}{2}\\left(1.75 - 1.25\\right) = \\frac{1}{2}(0.50) = 0.25$.\n\nNext, calculate the view factor for the extended configuration, $F_{1\\to 2, \\text{new}}$:\nThe new ratio is $C_{\\text{new}} = \\frac{c_{\\text{new}}}{b} = \\frac{0.40}{0.40} = 1.0$.\n$F_{1\\to 2, \\text{new}} = \\frac{1}{2}\\left(1 + 1.0 - \\sqrt{1 + (1.0)^2}\\right)$\n$F_{1\\to 2, \\text{new}} = \\frac{1}{2}\\left(2 - \\sqrt{2}\\right)$.\n\nFinally, compute the increase $\\Delta F_{1\\to 2}$:\n$\\Delta F_{1\\to 2} = F_{1\\to 2, \\text{new}} - F_{1\\to 2, \\text{orig}}$\n$\\Delta F_{1\\to 2} = \\frac{1}{2}(2 - \\sqrt{2}) - 0.25$\nWe use the value $\\sqrt{2} \\approx 1.41421356237$.\n$\\Delta F_{1\\to 2} \\approx \\frac{1}{2}(2 - 1.41421356237) - 0.25$\n$\\Delta F_{1\\to 2} \\approx \\frac{1}{2}(0.58578643763) - 0.25$\n$\\Delta F_{1\\to 2} \\approx 0.29289321881 - 0.25$\n$\\Delta F_{1\\to 2} \\approx 0.04289321881$.\n\nThe problem requires rounding the final answer to six significant figures.\n$\\Delta F_{1\\to 2} \\approx 0.0428932$.\nThis completes the calculation.",
            "answer": "$$\n\\boxed{0.0428932}\n$$"
        },
        {
            "introduction": "Real-world engineering systems often involve complex geometries that defy analytical solution, requiring computational methods. This advanced practice challenges you to develop a numerical tool to calculate the view factor $F_{1\\to 2}$ between two arbitrarily oriented rectangles using Gaussian quadrature. Furthermore, you will perform a sensitivity analysis to determine which geometric parameters most strongly influence the radiative exchange, a crucial skill in robust engineering design and optimization .",
            "id": "4003698",
            "problem": "Consider two opaque, diffuse, isothermal, planar rectangular surfaces in vacuum with no occlusion between them. Let surface $\\mathrm{A}_1$ be centered at the origin with outward unit normal $\\mathbf{n}_1 = (0,0,1)$, and in-plane orthonormal edge directions $\\mathbf{u}_1 = (1,0,0)$ and $\\mathbf{v}_1 = (0,1,0)$. Let $\\mathrm{A}_2$ be centered at $\\mathbf{c}_2 = (x_0,0,d)$, with outward unit normal $\\mathbf{n}_2$ obtained by a right-handed rotation about the $y$-axis by angle $\\alpha$ (in radians) applied to $(0,0,-1)$, i.e., $\\mathbf{n}_2 = R_y(\\alpha)\\,(0,0,-1)$. Its in-plane orthonormal edge directions are $\\mathbf{u}_2 = R_y(\\alpha)\\,(1,0,0)$ and $\\mathbf{v}_2 = (0,1,0)$, where $R_y(\\alpha)$ is the standard rotation by $\\alpha$ about the $y$-axis. The rectangles have full widths and heights $(w_1,h_1)$ for $\\mathrm{A}_1$ and $(w_2,h_2)$ for $\\mathrm{A}_2$, respectively, with areas $A_1 = w_1 h_1$ and $A_2 = w_2 h_2$. All lengths must be expressed in meters (m), and all angles must be expressed in radians.\n\nThe radiative view factor from $\\mathrm{A}_1$ to $\\mathrm{A}_2$, denoted $F_{1\\to 2}$, is defined from first principles by the hemispherical, obstruction-free configuration factor integral\n$$\nF_{1\\to 2} \\;=\\; \\frac{1}{A_1} \\int_{\\mathrm{A}_1} \\int_{\\mathrm{A}_2} \\frac{\\max(0,\\cos\\theta_1)\\,\\max(0,\\cos\\theta_2)}{\\pi\\,\\lVert \\mathbf{r}\\rVert^2}\\, \\mathrm{d}A_2\\, \\mathrm{d}A_1,\n$$\nwhere $\\mathbf{r} = \\mathbf{x}_2 - \\mathbf{x}_1$, $\\cos\\theta_1 = \\hat{\\mathbf{r}}\\cdot \\mathbf{n}_1$, $\\cos\\theta_2 = (-\\hat{\\mathbf{r}})\\cdot \\mathbf{n}_2$, and $\\hat{\\mathbf{r}} = \\mathbf{r}/\\lVert \\mathbf{r}\\rVert$. The function $\\max(0,\\cdot)$ enforces the hemispherical visibility constraint, and mutual shading is neglected.\n\nYour task is to design and implement a program that:\n- Numerically evaluates $F_{1\\to 2}$ using tensor-product Gaussian quadrature on each rectangle with at least $n = 6$ abscissae per in-plane coordinate per surface, mapping the standard interval $[-1,1]$ to each rectangle’s parameter domain. Use the mapping $\\mathbf{x}_k(s,t) = \\mathbf{c}_k + s\\,\\mathbf{u}_k + t\\,\\mathbf{v}_k$ with $(s,t)\\in[-\\tfrac{w_k}{2},\\tfrac{w_k}{2}]\\times[-\\tfrac{h_k}{2},\\tfrac{h_k}{2}]$ for $k\\in\\{1,2\\}$.\n- Performs a first-order perturbation (sensitivity) analysis of $F_{1\\to 2}$ with respect to the five geometric parameters $\\mathbf{p} = [x_0,\\; d,\\; \\alpha,\\; w_2,\\; h_2]$. Use a symmetric central difference for each component $p_k$:\n$$\n\\frac{\\partial F_{1\\to 2}}{\\partial p_k} \\;\\approx\\; \\frac{F_{1\\to 2}(\\mathbf{p}+\\delta_k \\mathbf{e}_k) - F_{1\\to 2}(\\mathbf{p}-\\delta_k \\mathbf{e}_k)}{2\\,\\delta_k},\n$$\nwith a perturbation magnitude\n$$\n\\delta_k \\;=\\; \\eta \\,\\max\\!\\big(|p_k|,\\; s_k\\big),\n$$\nwhere $\\eta = 10^{-4}$ is dimensionless, and the reference scales are $s_k = 1$ for each length-like parameter (meters) and $s_k = 1$ for the angle-like parameter (radians). Angles must be in radians, and lengths in meters. Ensure perturbed dimensions $w_2$ and $h_2$ remain strictly positive.\n- Computes dimensionless, normalized sensitivities to enable cross-parameter comparison:\n$$\nS_k \\;=\\; \\frac{\\max(|p_k|,s_k)}{\\max(|F_{1\\to 2}|,\\delta_F)} \\,\\left|\\,\\frac{\\partial F_{1\\to 2}}{\\partial p_k}\\right|,\n$$\nwith $\\delta_F = 10^{-12}$.\n- Identifies the index $k^\\star \\in \\{0,1,2,3,4\\}$ corresponding to the most sensitive parameter, i.e., the $k$ that maximizes $S_k$.\n\nFor all computations, use $\\pi$ in the integral kernel exactly as defined, and enforce the hemispherical constraints via the $\\max(0,\\cdot)$ factors. Ignore any form of occlusion or shadowing other than the hemispherical constraint.\n\nTest Suite:\nEvaluate the following three cases. Each tuple lists $(w_1,h_1,w_2,h_2,d,x_0,\\alpha)$ in meters and radians.\n\n- Case $\\#1$: $(1.0,\\,1.0,\\,1.2,\\,0.8,\\,1.0,\\,0.2,\\,0.3)$\n- Case $\\#2$: $(1.0,\\,0.8,\\,0.6,\\,1.1,\\,0.5,\\,0.1,\\,1.2)$\n- Case $\\#3$: $(1.0,\\,1.0,\\,1.0,\\,1.0,\\,3.0,\\,0.0,\\,0.4)$\n\nOutput Requirements:\n- For each case, output a list containing:\n  $[F_{1\\to 2},\\; \\tfrac{\\partial F}{\\partial x_0},\\; \\tfrac{\\partial F}{\\partial d},\\; \\tfrac{\\partial F}{\\partial \\alpha},\\; \\tfrac{\\partial F}{\\partial w_2},\\; \\tfrac{\\partial F}{\\partial h_2},\\; S_{x_0},\\; S_d,\\; S_{\\alpha},\\; S_{w_2},\\; S_{h_2},\\; k^\\star]$,\n  where $F_{1\\to 2}$ is dimensionless, the partial derivatives carry units of per meter or per radian as appropriate, and the $S_k$ are dimensionless. The index $k^\\star$ is $0$ for $x_0$, $1$ for $d$, $2$ for $\\alpha$, $3$ for $w_2$, and $4$ for $h_2$.\n- Your program should produce a single line of output containing the results as a comma-separated list of the three per-case lists, with no spaces, enclosed in a single pair of square brackets, for example: $[[\\cdots],[\\cdots],[\\cdots]]$.",
            "solution": "The problem statement has been critically validated and is deemed to be **valid**. It is scientifically grounded in the principles of radiative heat transfer, mathematically self-contained, and algorithmically well-posed. All parameters, definitions, and constraints are specified with sufficient clarity to permit a unique and meaningful numerical solution. The task requires the implementation of established numerical methods—namely, Gaussian quadrature for multidimensional integration and central differences for sensitivity analysis—applied to a standard engineering problem.\n\nThe core of the problem is to compute the radiative view factor, $F_{1\\to 2}$, between two planar rectangles, $\\mathrm{A}_1$ and $\\mathrm{A}_2$, defined by the four-dimensional integral:\n$$\nF_{1\\to 2} \\;=\\; \\frac{1}{A_1} \\int_{\\mathrm{A}_1} \\int_{\\mathrm{A}_2} \\frac{\\max(0,\\cos\\theta_1)\\,\\max(0,\\cos\\theta_2)}{\\pi\\,\\lVert \\mathbf{r}\\rVert^2}\\, \\mathrm{d}A_2\\, \\mathrm{d}A_1\n$$\nHere, $\\mathbf{r} = \\mathbf{x}_2 - \\mathbf{x}_1$ is the vector connecting a point $\\mathbf{x}_1$ on surface $\\mathrm{A}_1$ to a point $\\mathbf{x}_2$ on surface $\\mathrm{A}_2$. The angles $\\theta_1$ and $\\theta_2$ are between the line of sight vector $\\mathbf{r}$ and the respective surface normals $\\mathbf{n}_1$ and $\\mathbf{n}_2$.\n\nThe geometric configuration is defined as follows:\nSurface $\\mathrm{A}_1$ is centered at the origin $\\mathbf{c}_1 = (0,0,0)$ with dimensions $(w_1, h_1)$. Its orientation is given by the outward normal $\\mathbf{n}_1 = (0,0,1)$ and in-plane basis vectors $\\mathbf{u}_1 = (1,0,0)$ and $\\mathbf{v}_1 = (0,1,0)$.\nSurface $\\mathrm{A}_2$ has dimensions $(w_2, h_2)$ and is centered at $\\mathbf{c}_2 = (x_0,0,d)$. Its orientation is determined by a rotation of angle $\\alpha$ about the $y$-axis. The rotation matrix is:\n$$\nR_y(\\alpha) = \\begin{pmatrix} \\cos\\alpha & 0 & \\sin\\alpha \\\\ 0 & 1 & 0 \\\\ -\\sin\\alpha & 0 & \\cos\\alpha \\end{pmatrix}\n$$\nThe orientation vectors for $\\mathrm{A}_2$ are then $\\mathbf{n}_2 = R_y(\\alpha)\\,(0,0,-1)^T = (-\\sin\\alpha, 0, -\\cos\\alpha)^T$, $\\mathbf{u}_2 = R_y(\\alpha)\\,(1,0,0)^T = (\\cos\\alpha, 0, -\\sin\\alpha)^T$, and $\\mathbf{v}_2 = (0,1,0)^T$.\n\nThe points on each surface are parameterized. For $k \\in \\{1,2\\}$, a point $\\mathbf{x}_k$ is given by $\\mathbf{x}_k(s_k, t_k) = \\mathbf{c}_k + s_k\\,\\mathbf{u}_k + t_k\\,\\mathbf{v}_k$, where $s_k \\in [-\\frac{w_k}{2}, \\frac{w_k}{2}]$ and $t_k \\in [-\\frac{h_k}{2}, \\frac{h_k}{2}]$.\n\nTo numerically evaluate the integral, we employ a tensor-product Gaussian quadrature. The integration domains for $s_k$ and $t_k$ are mapped to the standard quadrature interval $[-1,1]$. Let $\\xi$ and $\\zeta$ be the quadrature coordinates in $[-1,1]$. The mappings are:\n$s_k = \\frac{w_k}{2} \\xi_k$ and $t_k = \\frac{h_k}{2} \\zeta_k$.\nThe differential area elements thus transform as:\n$\\mathrm{d}A_k = \\mathrm{d}s_k \\mathrm{d}t_k = (\\frac{w_k}{2} \\mathrm{d}\\xi_k) (\\frac{h_k}{2} \\mathrm{d}\\zeta_k) = \\frac{A_k}{4} \\mathrm{d}\\xi_k \\mathrm{d}\\zeta_k$.\n\nSubstituting these into the view factor definition:\n$$\nF_{1\\to 2} = \\frac{1}{A_1} \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 K(\\xi_1,\\zeta_1,\\xi_2,\\zeta_2) \\left(\\frac{A_2}{4}\\mathrm{d}\\xi_2 \\mathrm{d}\\zeta_2\\right) \\left(\\frac{A_1}{4}\\mathrm{d}\\xi_1 \\mathrm{d}\\zeta_1\\right) = \\frac{A_2}{16} \\int_{[-1,1]^4} K(\\dots) \\mathrm{d}\\xi_1 \\mathrm{d}\\zeta_1 \\mathrm{d}\\xi_2 \\mathrm{d}\\zeta_2\n$$\nwhere $K$ is the integral kernel. Using an $n$-point Gaussian quadrature rule with abscissae $\\{u_i\\}$ and weights $\\{w_i\\}$, the integral is approximated by a weighted sum:\n$$\nF_{1\\to 2} \\approx \\frac{A_2}{16} \\sum_{i=1}^n \\sum_{j=1}^n \\sum_{k=1}^n \\sum_{l=1}^n w_i w_j w_k w_l \\, K_{ijkl}\n$$\nwhere $K_{ijkl}$ is the kernel evaluated at points corresponding to the abscissae $(u_i, u_j, u_k, u_l)$ for $(\\xi_1, \\zeta_1, \\xi_2, \\zeta_2)$. The problem specifies $n \\ge 6$; we select $n=6$.\n\nThe sensitivity analysis is performed using a second-order accurate symmetric central difference approximation for the partial derivatives with respect to the parameter vector $\\mathbf{p} = [x_0, d, \\alpha, w_2, h_2]$. For each parameter $p_k$:\n$$\n\\frac{\\partial F_{1\\to 2}}{\\partial p_k} \\approx \\frac{F_{1\\to 2}(\\mathbf{p}+\\delta_k \\mathbf{e}_k) - F_{1\\to 2}(\\mathbf{p}-\\delta_k \\mathbf{e}_k)}{2\\,\\delta_k}\n$$\nThe perturbation step $\\delta_k$ is defined as $\\delta_k = \\eta \\,\\max(|p_k|, s_k)$, with $\\eta = 10^{-4}$ and a reference scale $s_k=1$ for all parameters. This requires $2N_p = 10$ additional evaluations of the view factor integral.\n\nFinally, to compare the relative importance of each parameter, a dimensionless normalized sensitivity, $S_k$, is computed:\n$$\nS_k = \\frac{\\max(|p_k|,s_k)}{\\max(|F_{1\\to 2}|, \\delta_F)} \\left| \\frac{\\partial F_{1\\to 2}}{\\partial p_k} \\right|\n$$\nwhere $\\delta_F = 10^{-12}$ is a flooring value to prevent division by a very small view factor. The parameter with the highest $S_k$ is identified as the most influential, and its index $k^\\star \\in \\{0, 1, 2, 3, 4\\}$ is reported.\n\nThe implementation will consist of a primary function to compute $F_{1\\to 2}$ using the described quadrature scheme. This function is then called repeatedly by a wrapper that manages the parameter perturbations for the sensitivity analysis and calculates the final normalized sensitivities.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_view_factor(w1, h1, w2, h2, d, x0, alpha, n=6):\n    \"\"\"\n    Numerically evaluates the view factor F_1->2 using Gaussian quadrature.\n    \"\"\"\n    if w1 <= 0 or h1 <= 0 or w2 <= 0 or h2 <= 0:\n        return 0.0\n\n    abscissae, weights = np.polynomial.legendre.leggauss(n)\n    \n    A2 = w2 * h2\n\n    # Define geometry for surface 1\n    c1 = np.array([0.0, 0.0, 0.0])\n    n1 = np.array([0.0, 0.0, 1.0])\n    u1_vec = np.array([1.0, 0.0, 0.0])\n    v1_vec = np.array([0.0, 1.0, 0.0])\n\n    # Define geometry for surface 2\n    c2 = np.array([x0, 0.0, d])\n    cos_a, sin_a = np.cos(alpha), np.sin(alpha)\n    Ry = np.array([[cos_a, 0.0, sin_a], [0.0, 1.0, 0.0], [-sin_a, 0.0, cos_a]])\n    n2 = Ry @ np.array([0.0, 0.0, -1.0])\n    u2_vec = Ry @ np.array([1.0, 0.0, 0.0])\n    v2_vec = np.array([0.0, 1.0, 0.0])\n\n    s1_map = w1 / 2.0\n    t1_map = h1 / 2.0\n    s2_map = w2 / 2.0\n    t2_map = h2 / 2.0\n\n    x1_pts = []\n    w1_wts = []\n    for i in range(n):\n        s1 = s1_map * abscissae[i]\n        for j in range(n):\n            t1 = t1_map * abscissae[j]\n            x1_pts.append(c1 + s1 * u1_vec + t1 * v1_vec)\n            w1_wts.append(weights[i] * weights[j])\n\n    x2_pts = []\n    w2_wts = []\n    for k in range(n):\n        s2 = s2_map * abscissae[k]\n        for l in range(n):\n            t2 = t2_map * abscissae[l]\n            x2_pts.append(c2 + s2 * u2_vec + t2 * v2_vec)\n            w2_wts.append(weights[k] * weights[l])\n            \n    integral_sum = 0.0\n    for i in range(n*n):\n        x1 = x1_pts[i]\n        for j in range(n*n):\n            x2 = x2_pts[j]\n            \n            r_vec = x2 - x1\n            r_norm_sq = np.dot(r_vec, r_vec)\n\n            # Avoid division by zero for coincident points.\n            if r_norm_sq < 1e-20:\n                continue\n\n            r_norm = np.sqrt(r_norm_sq)\n            r_hat = r_vec / r_norm\n\n            cos_theta1 = np.dot(r_hat, n1)\n            cos_theta2 = np.dot(-r_hat, n2)\n\n            if cos_theta1 > 0 and cos_theta2 > 0:\n                kernel = (cos_theta1 * cos_theta2) / (np.pi * r_norm_sq)\n                integral_sum += w1_wts[i] * w2_wts[j] * kernel\n\n    F12 = (A2 / 16.0) * integral_sum\n    return F12\n\ndef solve():\n    test_cases = [\n        # (w1, h1, w2, h2, d, x0, alpha)\n        (1.0, 1.0, 1.2, 0.8, 1.0, 0.2, 0.3),\n        (1.0, 0.8, 0.6, 1.1, 0.5, 0.1, 1.2),\n        (1.0, 1.0, 1.0, 1.0, 3.0, 0.0, 0.4),\n    ]\n\n    all_results = []\n\n    eta = 1e-4\n    delta_F = 1e-12\n    s_k = 1.0  # reference scale for all parameters\n\n    for case in test_cases:\n        w1, h1, w2, h2, d, x0, alpha = case\n        \n        # Calculate nominal view factor\n        F12_nominal = calculate_view_factor(w1, h1, w2, h2, d, x0, alpha)\n        \n        p = np.array([x0, d, alpha, w2, h2])\n        derivatives = []\n        sensitivities = []\n        \n        def eval_F(params):\n            _x0, _d, _alpha, _w2, _h2 = params\n            return calculate_view_factor(w1, h1, _w2, _h2, _d, _x0, _alpha)\n            \n        for k in range(len(p)):\n            pk = p[k]\n            delta_k = eta * max(abs(pk), s_k)\n            \n            p_plus = p.copy()\n            p_plus[k] += delta_k\n            \n            p_minus = p.copy()\n            p_minus[k] -= delta_k\n\n            # Ensure widths and heights remain positive\n            if k in [3, 4] and p_minus[k] <= 0:\n              # Fallback to forward difference if central difference would create invalid geometry\n                F_nominal_for_fd = eval_F(p)\n                F_plus = eval_F(p_plus)\n                deriv = (F_plus - F_nominal_for_fd) / delta_k\n            else:\n                F_plus = eval_F(p_plus)\n                F_minus = eval_F(p_minus)\n                deriv = (F_plus - F_minus) / (2.0 * delta_k)\n\n            derivatives.append(deriv)\n            \n            norm_factor_p = max(abs(pk), s_k)\n            norm_factor_F = max(abs(F12_nominal), delta_F)\n            S_k = (norm_factor_p / norm_factor_F) * abs(deriv)\n            sensitivities.append(S_k)\n            \n        k_star = np.argmax(sensitivities)\n        \n        case_results = [F12_nominal] + derivatives + sensitivities + [int(k_star)]\n        all_results.append(case_results)\n\n    # Format the output string precisely as requested\n    list_of_strings = []\n    for res in all_results:\n        list_of_strings.append(f\"[{','.join(f'{v:.10e}' for v in res[:-1])},{int(res[-1])}]\")\n    final_output_str = f\"[{','.join(list_of_strings)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}