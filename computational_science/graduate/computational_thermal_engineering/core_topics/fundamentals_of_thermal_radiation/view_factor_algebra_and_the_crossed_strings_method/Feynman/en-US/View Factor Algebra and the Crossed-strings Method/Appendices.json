{
    "hands_on_practices": [
        {
            "introduction": "The crossed-strings method provides a powerful geometric shortcut for calculating view factors, but its foundation lies in simple Euclidean geometry. This first practice grounds your understanding by tasking you with deriving the core algebraic expression from first principles. By calculating the 'crossed' and 'uncrossed' string lengths for two arbitrarily positioned parallel rectangles and assembling the Hottel functional, you will construct the building block used in many advanced view factor calculations and gain a concrete intuition for the method's geometric origins .",
            "id": "4003293",
            "problem": "Consider two axis-aligned rectangles in three-dimensional Euclidean space. Rectangle $\\mathcal{R}_{1}$ lies in the plane $z=0$ with center at the origin and side lengths $a$ in the $x$-direction and $b$ in the $y$-direction, so its corner points are at $(\\pm a/2,\\pm b/2,0)$. Rectangle $\\mathcal{R}_{2}$ lies in the plane $z=h>0$ with center at $(x_{0},y_{0},h)$ and side lengths $c$ in the $x$-direction and $d$ in the $y$-direction, so its corner points are at $(x_{0}\\pm c/2,y_{0}\\pm d/2,h)$. In the context of radiative view factor algebra and the Hottel crossed-strings method, one constructs four “strings” (straight line segments) between selected corner pairs: two designated “crossed” and two designated “uncrossed.” Treat the “crossed” strings as those connecting opposite corners across the two rectangles, and the “uncrossed” strings as those connecting corresponding corners.\n\nStarting from fundamental geometric principles (Euclidean distance in three dimensions and planar projection in two dimensions), derive explicit closed-form expressions for the four corner-to-corner distances associated with the strings connecting $( -a/2,-b/2,0)$ to $(x_{0}+c/2,y_{0}+d/2,h)$, $( a/2, b/2,0)$ to $(x_{0}-c/2,y_{0}-d/2,h)$, $( -a/2,-b/2,0)$ to $(x_{0}-c/2,y_{0}-d/2,h)$, and $( a/2, b/2,0)$ to $(x_{0}+c/2,y_{0}+d/2,h)$. Classify which two are crossed and which two are uncrossed by examining whether the projections of the corresponding strings onto the $xy$-plane intersect. Finally, form the crossed-strings functional defined as the sum of the crossed distances minus the sum of the uncrossed distances, and provide it as a single closed-form analytic expression in terms of $a$, $b$, $c$, $d$, $x_{0}$, $y_{0}$, and $h$. The final answer must be a single closed-form expression. Do not approximate or round.",
            "solution": "We begin by specifying the geometry precisely. Rectangle $\\mathcal{R}_{1}$ has corner points\n$$\nA_{1}=(-a/2,-b/2,0),\\quad B_{1}=(a/2,-b/2,0),\\quad C_{1}=(a/2,b/2,0),\\quad D_{1}=(-a/2,b/2,0).\n$$\nRectangle $\\mathcal{R}_{2}$ has corner points\n$$\nA_{2}=(x_{0}-c/2,y_{0}-d/2,h),\\quad B_{2}=(x_{0}+c/2,y_{0}-d/2,h),\\quad C_{2}=(x_{0}+c/2,y_{0}+d/2,h),\\quad D_{2}=(x_{0}-c/2,y_{0}+d/2,h).\n$$\n\nThe construction in the Hottel crossed-strings method for parallel, axis-aligned rectangles uses four strings connecting corner pairs. A conventional and symmetrical choice that produces two “crossed” and two “uncrossed” strings is:\n- Crossed strings: $A_{1}\\rightarrow C_{2}$ and $C_{1}\\rightarrow A_{2}$,\n- Uncrossed strings: $A_{1}\\rightarrow A_{2}$ and $C_{1}\\rightarrow C_{2}$.\n\nThe classification “crossed” versus “uncrossed” is substantiated by examining the projections of these line segments onto the $xy$-plane. The $xy$-projections of $A_{1}\\rightarrow C_{2}$ and $C_{1}\\rightarrow A_{2}$ join the southwest to northeast and northeast to southwest corners of the offset rectangles, respectively. In the $xy$-plane, these two projected segments intersect generically for axis-aligned configurations because they connect opposite corners across the two rectangles, creating the classic crossing of diagonals in the convex hull of the four projected points. In contrast, the projections of $A_{1}\\rightarrow A_{2}$ and $C_{1}\\rightarrow C_{2}$ connect corresponding corners (southwest to southwest and northeast to northeast), and these do not intersect one another; hence they are designated “uncrossed.”\n\nWe now compute the Euclidean distances for the four specified strings using the three-dimensional distance formula. For any two points $(x_{1},y_{1},z_{1})$ and $(x_{2},y_{2},z_{2})$, the Euclidean distance is\n$$\nr=\\sqrt{(x_{2}-x_{1})^{2}+(y_{2}-y_{1})^{2}+(z_{2}-z_{1})^{2}}.\n$$\n\nCompute each distance:\n\n1. Distance for $A_{1}\\rightarrow C_{2}$:\n$$\nr_{A_{1}C_{2}}=\\sqrt{\\bigl(x_{0}+c/2-(-a/2)\\bigr)^{2}+\\bigl(y_{0}+d/2-(-b/2)\\bigr)^{2}+\\bigl(h-0\\bigr)^{2}}=\\sqrt{\\bigl(x_{0}+(a+c)/2\\bigr)^{2}+\\bigl(y_{0}+(b+d)/2\\bigr)^{2}+h^{2}}.\n$$\n\n2. Distance for $C_{1}\\rightarrow A_{2}$:\n$$\nr_{C_{1}A_{2}}=\\sqrt{\\bigl(x_{0}-c/2-(a/2)\\bigr)^{2}+\\bigl(y_{0}-d/2-(b/2)\\bigr)^{2}+h^{2}}=\\sqrt{\\bigl(x_{0}-(a+c)/2\\bigr)^{2}+\\bigl(y_{0}-(b+d)/2\\bigr)^{2}+h^{2}}.\n$$\n\n3. Distance for $A_{1}\\rightarrow A_{2}$:\n$$\nr_{A_{1}A_{2}}=\\sqrt{\\bigl(x_{0}-c/2-(-a/2)\\bigr)^{2}+\\bigl(y_{0}-d/2-(-b/2)\\bigr)^{2}+h^{2}}=\\sqrt{\\bigl(x_{0}+(a-c)/2\\bigr)^{2}+\\bigl(y_{0}+(b-d)/2\\bigr)^{2}+h^{2}}.\n$$\n\n4. Distance for $C_{1}\\rightarrow C_{2}$:\n$$\nr_{C_{1}C_{2}}=\\sqrt{\\bigl(x_{0}+c/2-(a/2)\\bigr)^{2}+\\bigl(y_{0}+d/2-(b/2)\\bigr)^{2}+h^{2}}=\\sqrt{\\bigl(x_{0}+(c-a)/2\\bigr)^{2}+\\bigl(y_{0}+(d-b)/2\\bigr)^{2}+h^{2}}.\n$$\n\nWe have already justified the classification:\n- Crossed: $r_{A_{1}C_{2}}$ and $r_{C_{1}A_{2}}$,\n- Uncrossed: $r_{A_{1}A_{2}}$ and $r_{C_{1}C_{2}}$.\n\nFinally, define the crossed-strings functional $S$ as the sum of the crossed-string distances minus the sum of the uncrossed-string distances:\n$$\nS \\equiv r_{A_{1}C_{2}}+r_{C_{1}A_{2}}-r_{A_{1}A_{2}}-r_{C_{1}C_{2}}.\n$$\nSubstituting the expressions obtained above yields the closed-form analytic expression\n$$\nS=\\sqrt{\\bigl(x_{0}+(a+c)/2\\bigr)^{2}+\\bigl(y_{0}+(b+d)/2\\bigr)^{2}+h^{2}}+\\sqrt{\\bigl(x_{0}-(a+c)/2\\bigr)^{2}+\\bigl(y_{0}-(b+d)/2\\bigr)^{2}+h^{2}}-\\sqrt{\\bigl(x_{0}+(a-c)/2\\bigr)^{2}+\\bigl(y_{0}+(b-d)/2\\bigr)^{2}+h^{2}}-\\sqrt{\\bigl(x_{0}+(c-a)/2\\bigr)^{2}+\\bigl(y_{0}+(d-b)/2\\bigr)^{2}+h^{2}}.\n$$\n\nThis $S$ encapsulates the crossed-strings construction for the given axis-aligned rectangles and is the requested single closed-form analytic expression in terms of $a$, $b$, $c$, $d$, $x_{0}$, $y_{0}$, and $h$.",
            "answer": "$$\\boxed{\\sqrt{\\bigl(x_{0}+\\frac{a+c}{2}\\bigr)^{2}+\\bigl(y_{0}+\\frac{b+d}{2}\\bigr)^{2}+h^{2}}+\\sqrt{\\bigl(x_{0}-\\frac{a+c}{2}\\bigr)^{2}+\\bigl(y_{0}-\\frac{b+d}{2}\\bigr)^{2}+h^{2}}-\\sqrt{\\bigl(x_{0}+\\frac{a-c}{2}\\bigr)^{2}+\\bigl(y_{0}+\\frac{b-d}{2}\\bigr)^{2}+h^{2}}-\\sqrt{\\bigl(x_{0}+\\frac{c-a}{2}\\bigr)^{2}+\\bigl(y_{0}+\\frac{d-b}{2}\\bigr)^{2}+h^{2}}}$$"
        },
        {
            "introduction": "A valid numerical method must be consistent with the fundamental physical laws it models. This exercise bridges the geometric crossed-strings formula with the axiomatic framework of view factor algebra, specifically the additivity rule. You will first prove analytically that the area-weighted sum of view factors from sub-surfaces equals the view factor of the whole, a proof that elegantly reveals a telescoping sum, and then verify this property by implementing it in code . This practice demonstrates the internal consistency of the crossed-strings method and reinforces its connection to the underlying physics.",
            "id": "4003225",
            "problem": "Consider two parallel, diffuse, gray, isothermal surfaces modeled as infinitely long strips of finite width in two-dimensional space. Let surface $S_1$ lie along the $x$-axis between $x = x_A$ and $x = x_B$ at $y = 0$, and let surface $S_2$ lie parallel to it between $x = x_C$ and $x = x_D$ at $y = H$, with $H > 0$. The view factor $F_{12}$ is defined as the fraction of the radiative energy leaving $S_1$ that directly intercepts $S_2$, under the assumptions of diffuse emission and unobstructed line-of-sight.\n\nFundamental bases to be used:\n- The differential view factor definition for diffuse surfaces: for differential areas $dA_1$ on $S_1$ and $dA_2$ on $S_2$, the contribution to the view factor is proportional to $\\dfrac{\\cos \\theta_1 \\cos \\theta_2}{\\pi r^2}$, where $\\theta_1$ and $\\theta_2$ are the angles between the line connecting the differential elements and their respective surface normals, and $r$ is the distance between the points.\n- The additivity of view factors over partitions: if $S_1$ is partitioned into $N$ non-overlapping subsurfaces $\\{S_{1k}\\}$ such that $\\bigcup_k S_{1k} = S_1$, then $F_{12} = \\sum_{k=1}^N \\dfrac{A_{1k}}{A_1} F_{(1k)2}$, where $A_{1k}$ is the area of $S_{1k}$ and $A_1$ is the area of $S_1$.\n- The reciprocity relation and geometric invariance underlying the Crossed-Strings method (no shortcut formula is to be provided here in the problem statement): the view factor can be expressed via an equivalent computation using corner-to-corner Euclidean distances between the endpoints of the strips.\n\nTask:\n1. Derive, from the differential definition and geometric relations, an explicit expression for $F_{12}$ between two infinitely long parallel strips in terms of corner-to-corner Euclidean distances between $(x_A, 0)$, $(x_B, 0)$, $(x_C, H)$, and $(x_D, H)$, without invoking any shortcut formula directly. This derivation should justify why a certain linear combination of these distances yields the view factor for strips per unit length in the out-of-plane direction.\n2. Using the additivity of view factors, prove that partitioning surface $S_1$ into contiguous sub-strips along $x$ and applying the derived crossed-strings computation to each sub-strip, then forming the area-weighted sum $\\sum_k \\dfrac{A_{1k}}{A_1} F_{(1k)2}$, preserves the original $F_{12}$ for the full strip $S_1$.\n3. Implement a program that:\n   - Computes $F_{12}$ for a given geometry $(x_A, x_B, x_C, x_D, H)$ using the derived crossed-strings expression.\n   - Partitions $S_1$ into specified sub-strips with endpoints $\\{x_{p,0} = x_A, x_{p,1}, \\ldots, x_{p,n} = x_B\\}$, computes $F_{(1k)2}$ for each sub-strip $[x_{p,k-1}, x_{p,k}]$, and forms the area-weighted sum $\\sum_k \\dfrac{x_{p,k} - x_{p,k-1}}{x_B - x_A} F_{(1k)2}$.\n   - Reports the absolute difference between the full-strip $F_{12}$ and the partitioned sum, as a float, for each test case.\n\nUnits:\n- All lengths are in meters. The view factor is dimensionless (unitless). There are no angles to specify, as the geometry is entirely prescribed.\n\nTest suite:\nProvide the results for the following five cases. In each case, your program must compute and output the absolute difference between the full-strip $F_{12}$ and the area-weighted sum of sub-strip view factors, as a float.\n\n- Case $1$ (happy path, partial overlap, moderate separation):\n  - Geometry: $x_A = -0.40$, $x_B = 1.10$, $x_C = -0.20$, $x_D = 0.70$, $H = 0.65$.\n  - Partition points for $S_1$: $[-0.40, -0.10, 0.30, 0.50, 0.80, 1.10]$.\n\n- Case $2$ (no horizontal overlap, moderate separation):\n  - Geometry: $x_A = -1.20$, $x_B = -0.20$, $x_C = 0.30$, $x_D = 1.00$, $H = 0.90$.\n  - Partition points for $S_1$: $[-1.20, -1.05, -0.80, -0.60, -0.35, -0.20]$.\n\n- Case $3$ (significant offset with small separation):\n  - Geometry: $x_A = 0.00$, $x_B = 0.70$, $x_C = -0.60$, $x_D = 0.10$, $H = 0.20$.\n  - Partition points for $S_1$: $[0.00, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70]$.\n\n- Case $4$ (very narrow $S_1$, moderate separation):\n  - Geometry: $x_A = -0.05$, $x_B = 0.05$, $x_C = -0.30$, $x_D = 0.60$, $H = 0.50$.\n  - Partition points for $S_1$: $[-0.05, -0.01, 0.02, 0.05]$.\n\n- Case $5$ (wide strips with large separation):\n  - Geometry: $x_A = -0.30$, $x_B = 0.90$, $x_C = -0.80$, $x_D = 1.20$, $H = 5.00$.\n  - Partition points for $S_1$: $[-0.30, 0.00, 0.30, 0.60, 0.90]$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact order of the cases above (for example, $[d_1,d_2,d_3,d_4,d_5]$), where each $d_i$ is the computed absolute difference (a float). No other text should be printed.",
            "solution": "The problem is assessed as valid as it is scientifically grounded in the principles of radiative heat transfer, well-posed with a clear and complete problem definition, and objective in its formulation. The task requires a derivation from first principles, a formal proof, and a numerical implementation, all of which are standard and verifiable procedures in computational science and engineering.\n\n### Part 1: Derivation of the View Factor Expression ###\n\nThe problem asks for the derivation of the view factor $F_{12}$ between two infinitely long, parallel strips, $S_1$ and $S_2$, from the fundamental differential definition.\nLet $S_1$ be a strip on the $xy$-plane (for $z=0$) defined by $x \\in [x_A, x_B]$ and $y=0$.\nLet $S_2$ be a strip parallel to $S_1$ defined by $x \\in [x_C, x_D]$ and $y=H$, where $H > 0$. Both strips are infinitely long in the $z$-direction.\n\nThe view factor from a differential area $dA_1$ on surface $S_1$ to a differential area $dA_2$ on surface $S_2$ is given by:\n$$ dF_{dA_1 \\to dA_2} = \\frac{\\cos\\theta_1 \\cos\\theta_2}{\\pi r^2} dA_2 $$\nLet $dA_1$ be located at $(x_1, 0, z_1)$ and $dA_2$ at $(x_2, H, z_2)$. The areas are $dA_1 = dx_1 dz_1$ and $dA_2 = dx_2 dz_2$.\nThe vector from $dA_1$ to $dA_2$ is $\\vec{r} = (x_2 - x_1)\\hat{i} + H\\hat{j} + (z_2 - z_1)\\hat{k}$.\nThe squared distance is $r^2 = (x_2 - x_1)^2 + H^2 + (z_2 - z_1)^2$.\nThe unit normal vector to $S_1$ is $\\vec{n}_1 = \\hat{j}$. The unit normal vector to $S_2$ is $\\vec{n}_2 = -\\hat{j}$.\nThe angles $\\theta_1$ and $\\theta_2$ are given by:\n$$ \\cos\\theta_1 = \\frac{\\vec{r} \\cdot \\vec{n}_1}{|\\vec{r}||\\vec{n}_1|} = \\frac{H}{r} $$\n$$ \\cos\\theta_2 = \\frac{\\vec{r} \\cdot (-\\vec{n}_2)}{|\\vec{r}||\\vec{n}_2|} = \\frac{H}{r} $$\nNote that $\\theta_2$ is the angle between $\\vec{r}$ and the normal to $S_2$, which is $\\vec{n}_2$. But the formula uses the angle between the line connecting the elements and the respective surface normal. So, the formulation is correct.\nThe view factor from the differential area $dA_1$ to the entire surface $S_2$ is obtained by integrating over $S_2$:\n$$ F_{dA_1 \\to S_2} = \\int_{S_2} \\frac{\\cos\\theta_1 \\cos\\theta_2}{\\pi r^2} dA_2 = \\int_{z_2=-\\infty}^{\\infty} \\int_{x_2=x_C}^{x_D} \\frac{H^2}{\\pi r^4} dx_2 dz_2 $$\nFor a 2D problem (infinitely long strips), it is more convenient to work with the view factor between two differential strips of length $dx_1$ and $dx_2$ and infinite extent in $z$. Let this be $dF_{dL_1 \\to dL_2}$. The view factor $F_{dL_1 \\to S_2}$ from an infinitely long differential strip $dL_1$ at $x_1$ to the finite-width strip $S_2$ is obtained by integrating over the width of $S_2$ and the infinite length $z_2$.\n$$ F_{dL_1 \\to S_2} = \\int_{x_C}^{x_D} \\left( \\int_{-\\infty}^{\\infty} \\frac{H^2}{\\pi [ (x_2-x_1)^2 + H^2 + (z_2-z_1)^2 ]^2} dz_2 \\right) dx_2 $$\nLet $s = z_2 - z_1$ and $R^2 = (x_2 - x_1)^2 + H^2$. The inner integral becomes:\n$$ \\int_{-\\infty}^{\\infty} \\frac{H^2}{\\pi (R^2 + s^2)^2} ds = \\frac{H^2}{\\pi} \\left[ \\frac{s}{2R^2(R^2+s^2)} + \\frac{1}{2R^3}\\arctan\\left(\\frac{s}{R}\\right) \\right]_{-\\infty}^{\\infty} = \\frac{H^2}{\\pi} \\frac{\\pi}{2R^3} = \\frac{H^2}{2R^3} $$\nSubstituting this back, we get:\n$$ F_{dL_1 \\to S_2} = \\int_{x_C}^{x_D} \\frac{H^2}{2((x_2-x_1)^2 + H^2)^{3/2}} dx_2 $$\nThe integral of $\\frac{c^2}{(u^2+c^2)^{3/2}}$ with respect to $u$ is $\\frac{u}{\\sqrt{u^2+c^2}}$. Here, $u = x_2 - x_1$ and $c=H$. So, $du = dx_2$.\n$$ F_{dL_1 \\to S_2} = \\frac{1}{2} \\left[ \\frac{x_2 - x_1}{\\sqrt{(x_2-x_1)^2 + H^2}} \\right]_{x_2=x_C}^{x_D} $$\n$$ F_{dL_1 \\to S_2} = \\frac{1}{2} \\left( \\frac{x_D-x_1}{\\sqrt{(x_D-x_1)^2 + H^2}} - \\frac{x_C-x_1}{\\sqrt{(x_C-x_1)^2 + H^2}} \\right) $$\nTo find the total view factor $F_{12}$, we must average $F_{dL_1 \\to S_2}$ over the width of surface $S_1$:\n$$ F_{12} = \\frac{1}{A_1} \\int_{A_1} F_{dL_1 \\to S_2} dA_1 = \\frac{1}{x_B - x_A} \\int_{x_A}^{x_B} F_{dL_1 \\to S_2} dx_1 $$\nThe integral is:\n$$ \\int_{x_A}^{x_B} \\frac{1}{2} \\left( \\frac{x_D-x_1}{\\sqrt{(x_D-x_1)^2 + H^2}} - \\frac{x_C-x_1}{\\sqrt{(x_C-x_1)^2 + H^2}} \\right) dx_1 $$\nWe evaluate the two terms separately. For the first term, let $u = x_D-x_1$, so $du = -dx_1$.\n$$ \\int_{x_D-x_A}^{x_D-x_B} \\frac{u}{\\sqrt{u^2+H^2}}(-du) = \\left[ \\sqrt{u^2+H^2} \\right]_{x_D-x_B}^{x_D-x_A} = \\sqrt{(x_D-x_A)^2+H^2} - \\sqrt{(x_D-x_B)^2+H^2} $$\nLet the endpoints be $A=(x_A,0)$, $B=(x_B,0)$, $C=(x_C,H)$, and $D=(x_D,H)$. The terms are the Euclidean distances: $L_{AD} = \\sqrt{(x_D-x_A)^2+H^2}$ and $L_{BD} = \\sqrt{(x_D-x_B)^2+H^2}$. The integral of the first term is $L_{AD} - L_{BD}$.\nSimilarly, the integral of the second term gives $L_{AC} - L_{BC}$.\nThe total integral is $(L_{AD} - L_{BD}) - (L_{AC} - L_{BC}) = (L_{AD} + L_{BC}) - (L_{AC} + L_{BD})$.\nSubstituting this back into the expression for $F_{12}$:\n$$ F_{12} = \\frac{(L_{AD} + L_{BC}) - (L_{AC} + L_{BD})}{2(x_B - x_A)} $$\nThis is the crossed-strings method formula. The numerator represents the sum of the lengths of the crossed strings connecting the endpoints of the strips minus the sum of the lengths of the uncrossed strings. The denominator is twice the width of the emitting surface $S_1$.\n\n### Part 2: Proof of Additivity ###\n\nThe problem requires proving that partitioning $S_1$ and summing the area-weighted view factors of the sub-strips preserves the total view factor.\nLet $S_1$ be partitioned into $N$ contiguous sub-strips $\\{S_{1k}\\}_{k=1}^N$. The $k$-th sub-strip, $S_{1k}$, extends from $x=x_{p,k-1}$ to $x=x_{p,k}$, where the partition points are $\\{x_{p,0}, x_{p,1}, \\ldots, x_{p,N}\\}$ with $x_{p,0} = x_A$ and $x_{p,N} = x_B$.\nThe width (area per unit length) of sub-strip $S_{1k}$ is $W_{1k} = x_{p,k} - x_{p,k-1}$.\nThe total width of $S_1$ is $W_1 = x_B - x_A = \\sum_{k=1}^N W_{1k}$.\nThe additivity rule states:\n$$ F_{12} = \\sum_{k=1}^N \\frac{W_{1k}}{W_1} F_{(1k)2} $$\nWe must prove this identity using the derived formula for the view factor. Let the endpoints of $S_{1k}$ be $P_{k-1}=(x_{p,k-1}, 0)$ and $P_k=(x_{p,k}, 0)$. The endpoints of $S_2$ remain $C=(x_C, H)$ and $D=(x_D, H)$.\nThe view factor from $S_{1k}$ to $S_2$ is:\n$$ F_{(1k)2} = \\frac{(L_{P_{k-1}D} + L_{P_kC}) - (L_{P_{k-1}C} + L_{P_kD})}{2 W_{1k}} $$\nNow, we form the area-weighted sum:\n$$ \\sum_{k=1}^N \\frac{W_{1k}}{W_1} F_{(1k)2} = \\sum_{k=1}^N \\frac{W_{1k}}{W_1} \\left[ \\frac{(L_{P_{k-1}D} + L_{P_kC}) - (L_{P_{k-1}C} + L_{P_kD})}{2 W_{1k}} \\right] $$\nThe width terms $W_{1k}$ cancel:\n$$ = \\frac{1}{2W_1} \\sum_{k=1}^N \\left[ (L_{P_{k-1}D} + L_{P_kC}) - (L_{P_{k-1}C} + L_{P_kD}) \\right] $$\nThis is a telescoping sum. Let's expand and regroup the terms in the summation:\n$$ \\sum_{k=1}^N (\\dots) = \\sum_{k=1}^N (L_{P_{k-1}D} - L_{P_kD}) + \\sum_{k=1}^N (L_{P_kC} - L_{P_{k-1}C}) $$\nThe first summation telescopes:\n$$ \\sum_{k=1}^N (L_{P_{k-1}D} - L_{P_kD}) = (L_{P_0D} - L_{P_1D}) + (L_{P_1D} - L_{P_2D}) + \\dots + (L_{P_{N-1}D} - L_{P_ND}) = L_{P_0D} - L_{P_ND} $$\nThe second summation also telescopes:\n$$ \\sum_{k=1}^N (L_{P_kC} - L_{P_{k-1}C}) = (L_{P_1C} - L_{P_0C}) + (L_{P_2C} - L_{P_1C}) + \\dots + (L_{P_NC} - L_{P_{N-1}C}) = L_{P_NC} - L_{P_0C} $$\nCombining these results, the total sum is $(L_{P_0D} - L_{P_ND}) + (L_{P_NC} - L_{P_0C})$.\nBy definition of the partition, $P_0 = A = (x_A, 0)$ and $P_N = B = (x_B, 0)$.\nSo, the sum becomes $(L_{AD} - L_{BD}) + (L_{BC} - L_{AC})$.\nRearranging terms, this is $(L_{AD} + L_{BC}) - (L_{AC} + L_{BD})$.\nSubstituting this back into the expression for the weighted sum:\n$$ \\sum_{k=1}^N \\frac{W_{1k}}{W_1} F_{(1k)2} = \\frac{(L_{AD} + L_{BC}) - (L_{AC} + L_{BD})}{2W_1} = \\frac{(L_{AD} + L_{BC}) - (L_{AC} + L_{BD})}{2(x_B - x_A)} $$\nThis is precisely the expression for $F_{12}$ for the entire strip $S_1$. Thus, the additivity property is proven to hold analytically for the crossed-strings formula. The numerical implementation should yield a difference of zero, or a value on the order of machine precision due to floating-point arithmetic.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_view_factor(x1_start: float, x1_end: float, x2_start: float, x2_end: float, h: float) -> float:\n    \"\"\"\n    Computes the view factor F_12 between two infinitely long parallel strips.\n\n    Args:\n        x1_start: Starting x-coordinate of strip 1.\n        x1_end: Ending x-coordinate of strip 1.\n        x2_start: Starting x-coordinate of strip 2.\n        x2_end: Ending x-coordinate of strip 2.\n        h: Perpendicular distance between the strips.\n\n    Returns:\n        The view factor F_12.\n    \"\"\"\n    w1 = x1_end - x1_start\n    if abs(w1) < 1e-12:\n        return 0.0\n\n    # Endpoints of the strips: A, B for strip 1; C, D for strip 2.\n    # A = (x1_start, 0), B = (x1_end, 0)\n    # C = (x2_start, h),  D = (x2_end, h)\n\n    # Uncrossed strings\n    l_ac = np.sqrt((x2_start - x1_start)**2 + h**2)\n    l_bd = np.sqrt((x2_end - x1_end)**2 + h**2)\n\n    # Crossed strings\n    l_ad = np.sqrt((x2_end - x1_start)**2 + h**2)\n    l_bc = np.sqrt((x2_start - x1_end)**2 + h**2)\n\n    f12 = (l_ad + l_bc - l_ac - l_bd) / (2 * w1)\n    \n    return f12\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases, computes the absolute difference between\n    the full-strip view factor and the area-weighted sum of sub-strip view factors,\n    and prints the results.\n    \"\"\"\n    test_cases = [\n        {\n            \"geometry\": {\"xA\": -0.40, \"xB\": 1.10, \"xC\": -0.20, \"xD\": 0.70, \"H\": 0.65},\n            \"partitions\": [-0.40, -0.10, 0.30, 0.50, 0.80, 1.10],\n        },\n        {\n            \"geometry\": {\"xA\": -1.20, \"xB\": -0.20, \"xC\": 0.30, \"xD\": 1.00, \"H\": 0.90},\n            \"partitions\": [-1.20, -1.05, -0.80, -0.60, -0.35, -0.20],\n        },\n        {\n            \"geometry\": {\"xA\": 0.00, \"xB\": 0.70, \"xC\": -0.60, \"xD\": 0.10, \"H\": 0.20},\n            \"partitions\": [0.00, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70],\n        },\n        {\n            \"geometry\": {\"xA\": -0.05, \"xB\": 0.05, \"xC\": -0.30, \"xD\": 0.60, \"H\": 0.50},\n            \"partitions\": [-0.05, -0.01, 0.02, 0.05],\n        },\n        {\n            \"geometry\": {\"xA\": -0.30, \"xB\": 0.90, \"xC\": -0.80, \"xD\": 1.20, \"H\": 5.00},\n            \"partitions\": [-0.30, 0.00, 0.30, 0.60, 0.90],\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        geom = case[\"geometry\"]\n        partitions = case[\"partitions\"]\n        \n        xA, xB, xC, xD, H = geom[\"xA\"], geom[\"xB\"], geom[\"xC\"], geom[\"xD\"], geom[\"H\"]\n        \n        # 1. Compute F_12 for the full strip\n        f12_full = calculate_view_factor(xA, xB, xC, xD, H)\n        \n        # 2. Compute the area-weighted sum of sub-strip view factors\n        partitioned_sum = 0.0\n        total_width = xB - xA\n        \n        for k in range(1, len(partitions)):\n            x_start_k = partitions[k-1]\n            x_end_k = partitions[k]\n            \n            # Compute view factor for the sub-strip\n            f_k2 = calculate_view_factor(x_start_k, x_end_k, xC, xD, H)\n            \n            # Calculate area weight and add to sum\n            sub_strip_width = x_end_k - x_start_k\n            weight = sub_strip_width / total_width\n            partitioned_sum += weight * f_k2\n            \n        # 3. Report the absolute difference\n        abs_diff = abs(f12_full - partitioned_sum)\n        results.append(abs_diff)\n        \n    # Format the final output string as [d1,d2,d3,d4,d5]\n    # The analytical proof shows the difference is 0. Numerical error will be very small.\n    # To strictly match float, we will use the default string representation of floats.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from theory to a robust computational tool requires addressing edge cases that, while rare in continuous geometry, are common in discretized models. This advanced practice confronts the challenge of geometric degeneracies, such as coincident or collinear vertices, which can cause naive implementations of the crossed-strings method to fail. By analyzing different strategies, you will develop a criterion for a robust classification rule that guarantees continuity and reciprocity, key properties inherited from the foundational view factor integral . This exercise is essential for anyone aiming to write reliable and accurate radiation simulation software.",
            "id": "4003313",
            "problem": "Consider two diffuse, gray, isothermal, perfectly absorbing line segments $\\overline{A_1A_2}$ and $\\overline{B_1B_2}$ embedded in a plane, representing two-dimensional cross-sections of infinitely long surfaces perpendicular to the plane. The view factor $F_{12}$ from $\\overline{A_1A_2}$ to $\\overline{B_1B_2}$ is to be computed using a crossed-strings construction that connects each endpoint of $\\overline{A_1A_2}$ to each endpoint of $\\overline{B_1B_2}$ and then partitions the four resulting strings into two disjoint classes, labeled by whether the two strings in a class cross each other in their interiors. In strictly nondegenerate configurations, this construction yields a unique partition and a corresponding algebraic combination of lengths that is known to be continuous in the endpoints and to satisfy reciprocity $L_1 F_{12} = L_2 F_{21}$, where $L_1 = \\lVert A_2 - A_1 \\rVert_2$ and $L_2 = \\lVert B_2 - B_1 \\rVert_2$.\n\nHowever, in computational practice, the configuration can be degenerate in either of two ways: (i) coincident endpoints, where $A_i = B_j$ for some $i,j \\in \\{1,2\\}$, produce a string of zero length; and (ii) collinearity, where three or four points among $\\{A_1,A_2,B_1,B_2\\}$ are collinear, can cause two strings to touch at an endpoint or to lie on a common line, making the binary cross/noncross classification ambiguous. Such degeneracies are of measure zero in the continuous geometry but occur frequently due to meshing and floating-point roundoff.\n\nStarting from the fundamental facts that (a) the view factor is defined by a double integral of a smooth kernel over the two segments and hence depends continuously on the segment endpoints as long as the segments remain disjoint, and (b) reciprocity requires $L_1 F_{12} = L_2 F_{21}$ for any admissible configuration, select the option that prescribes a numerically robust, label-symmetric rule to handle coincident or collinear vertices, resolves the classification without arbitrary bias, and guarantees both continuity (as a limit of nondegenerate perturbations) and reciprocity.\n\nWhich option is correct?\n\nA. Classify any pair of strings that intersect, including touching at an endpoint, as “crossed,” and drop any zero-length strings from all sums; if a tie remains in classification, break the tie by choosing the pair with the smallest index labels as “uncrossed.” This enforces a strict geometric intersection rule and avoids numerical singularities.\n\nB. Apply an infinitesimal translation of $\\overline{B_1B_2}$ by $\\varepsilon \\,\\hat{\\mathbf{n}}$ for $\\varepsilon \\to 0^+$ in a fixed, arbitrary unit direction $\\hat{\\mathbf{n}}$ chosen once for the entire computation; classify crossings after the translation using strict inequalities, and map the result back to the original configuration. Count zero-length strings as absent. This simulates a general-position configuration while keeping the algorithm simple.\n\nC. Use an oriented-segment intersection predicate and the following symmetric tie-breaking: declare two strings “crossed” if and only if each segment properly intersects the interior of the other (strictly opposite signed orientations), and declare any endpoint-touch or collinearity case (zero orientation with respect to either segment) as “noncrossing.” If $A_i = B_j$ for any $i,j$, include the zero-length string exactly once and place it in the “noncrossing” class. If four points are collinear, classify both strings as “noncrossing.” Implement the orientation test with an exact or adaptive-precision robust predicate; when deduplication is needed for coincident endpoints, use lexicographic ordering of the endpoint coordinates to select a unique representative so that the classification is label-invariant. This rule is independent of label ordering and matches the limit of nondegenerate perturbations.\n\nD. Jitter all coordinates independently by adding $\\delta \\, \\xi$ with $\\xi$ sampled uniformly from $[-1,1]$ and a fixed small $\\delta > 0$, recompute the classification, and average the result over $N$ independent jitters, taking $N$ large. Treat any zero-length string as absent. By the law of large numbers, this produces a stable estimate and avoids dealing with degenerate logic.\n\nProvide your choice and justify it based on the foundational continuity of the integral definition and reciprocity $L_1 F_{12} = L_2 F_{21}$, without appealing to any unproven shortcut formulas for the crossed-strings method. Your justification should make clear why the incorrect options fail either continuity or reciprocity in at least one realistic configuration. Assume the segments remain disjoint (positive separation) so that the view factor is finite and well-defined.",
            "solution": "The problem requires selecting a rule for classifying strings in the crossed-strings method for calculating the 2D view factor $F_{12}$ between two line segments, $\\overline{A_1A_2}$ and $\\overline{B_1B_2}$. The rule must be robust against degenerate geometric configurations (coincident or collinear endpoints), and must guarantee two fundamental properties of the view factor: continuity with respect to the endpoint coordinates and satisfaction of the reciprocity relation $L_1 F_{12} = L_2 F_{21}$, where $L_1$ and $L_2$ are the lengths of the segments. It must also be a \"label-symmetric\" rule, meaning it should be invariant to the relabeling of endpoints (e.g., swapping $A_1$ and $A_2$).\n\nFirst, let us establish the theoretical foundation. The crossed-strings method provides an expression for the exchange factor, $E_{12} = L_1 F_{12}$. This method involves four strings connecting the endpoints of the two segments: $\\overline{A_1B_1}$, $\\overline{A_1B_2}$, $\\overline{A_2B_1}$, and $\\overline{A_2B_2}$. These four strings can be partitioned into two pairs that do not share any endpoints: $P_a = \\{\\overline{A_1B_1}, \\overline{A_2B_2}\\}$ and $P_b = \\{\\overline{A_1B_2}, \\overline{A_2B_1}\\}$. In a non-degenerate configuration, the strings of one of these pairs (the \"crossed\" strings) will intersect in their interiors, while the strings of the other pair (the \"uncrossed\" strings) will not. The exchange factor is then given by the algebraic combination:\n$$E_{12} = L_1 F_{12} = \\frac{1}{2} \\left[ \\sum L_{\\text{crossed}} - \\sum L_{\\text{uncrossed}} \\right]$$\nwhere $\\sum L$ is the sum of the lengths of the strings in the respective class. For the view factor $F_{12}$ to be non-negative, the sum of the lengths of the crossed strings must be greater than or equal to the sum of the lengths of the uncrossed strings.\n\nWe must evaluate each option against the primary requirements:\n\n1.  **Continuity**: As the problem states, the view factor defined by the fundamental double integral is a continuous function of the endpoint coordinates (as long as the segments are disjoint). Any rule for the algebraic crossed-strings method must reproduce this continuity. Discontinuities in the computed $F_{12}$ can arise if the classification of strings into \"crossed\" and \"uncrossed\" changes abruptly at a degenerate configuration. A classification switch causes the term $\\left[ \\sum L_{\\text{crossed}} - \\sum L_{\\text{uncrossed}} \\right]$ to flip its sign. For continuity to hold, this term must be zero at the transition point.\n\n2.  **Reciprocity**: The rule must ensure $L_1 F_{12} = L_2 F_{21}$. This means $E_{12} = E_{21}$. The calculation of $E_{21}$ involves the same four strings and the same geometry. Reciprocity is satisfied if and only if the classification of strings into \"crossed\" and \"uncrossed\" is symmetric with respect to swapping the roles of segment $1$ and segment $2$. This requires a rule based on the intrinsic geometry of the four endpoints, independent of which segment is the source.\n\n3.  **Label Symmetry**: The computed value of $F_{12}$ must not depend on the arbitrary labeling of the endpoints of a segment (e.g., swapping $A_1$ with $A_2$). This also requires the classification rule to be based on intrinsic geometric properties, not on index labels.\n\nNow, we evaluate the given options.\n\n**Option A Analysis**\nThis option proposes to classify any strings that intersect, including merely touching at an endpoint, as \"crossed\". Let's consider a configuration where the diagonals (e.g., $\\overline{A_1B_2}$ and $\\overline{A_2B_1}$) touch at an endpoint. According to this rule, they are \"crossed\". An infinitesimal perturbation can make them not intersect at all. In this perturbed state, they would be classified as \"uncrossed\", and the other pair would be classified as \"crossed\". This causes the expression for $E_{12}$ to flip sign, introducing a discontinuity in $F_{12}$, which violates the continuity principle. Furthermore, the rule to break ties using \"the smallest index labels\" is explicitly dependent on the arbitrary labeling of the points, violating the label-symmetry requirement. Dropping zero-length strings can also lead to discontinuities, as a string length smoothly approaching zero would abruptly be removed from the formula.\n**Verdict: Incorrect.**\n\n**Option B Analysis**\nThis option suggests resolving degeneracies by applying an infinitesimal translation $\\varepsilon \\hat{\\mathbf{n}}$ to one of the segments. This is a common perturbation technique. However, the choice of the direction $\\hat{\\mathbf{n}}$ is \"fixed\" but \"arbitrary\". Consider a configuration of four points where one vertex is collinear with an edge of the quadrilateral formed by the four endpoints. A perturbation in one direction could result in a convex quadrilateral (diagonals cross), while a perturbation in another direction could result in a non-convex quadrilateral (diagonals do not cross). The resulting classification—and thus the value of $F_{12}$—would depend on the arbitrary choice of $\\hat{\\mathbf n}$. This would violate the requirement for an objective, unbiased rule and would not guarantee a unique result for a given degenerate geometry.\n**Verdict: Incorrect.**\n\n**Option C Analysis**\nThis option provides a detailed, multi-part rule grounded in principles of robust computational geometry.\n1.  **Intersection Test**: It defines \"crossed\" using a strict interior intersection predicate. This is based on orientation tests (e.g., using signed areas of triangles or cross products), which is the standard robust method. A pair of segments $\\overline{PQ}$ and $\\overline{RS}$ properly intersects if and only if the endpoints of each segment lie on opposite sides of the line defined by the other. This test is purely geometric and thus symmetric with respect to swapping segments (ensuring reciprocity) and invariant to relabeling endpoints (ensuring label-symmetry).\n2.  **Degeneracy Handling (Collinearity/Touching)**: Cases where an orientation test yields zero (collinearity or endpoint touching) are explicitly classified as \"non-crossing\". Let's analyze this for continuity. A transition from \"crossing\" to \"non-crossing\" occurs when the four relevant endpoints become collinear. In such a configuration (e.g., $A_1, A_2, B_1, B_2$ all on a line with segments separated), the lengths of the strings are such that $(\\sum L_{\\text{crossed}}) - (\\sum L_{\\text{uncrossed}}) = 0$, regardless of classification. For example, with points $x_1<x_2<x_3<x_4$ on a line, $L_{A_1B_2}+L_{A_2B_1} = (x_4-x_1)+(x_3-x_2)$ and $L_{A_1B_1}+L_{A_2B_2} = (x_3-x_1)+(x_4-x_2)$. These sums are equal. Thus, at the moment of transition, $E_{12}=0$. By defining the degenerate case as non-crossing, the formula remains continuous. This rule correctly handles the transition.\n3.  **Degeneracy Handling (Coincident Endpoints)**: If $A_i=B_j$, a zero-length string arises. The rule states to place this string in the \"non-crossing\" class. This implies that the pair of strings containing the zero-length one is classified as the \"uncrossed\" pair. This rule is continuous because if we perturb the coincident endpoints by an infinitesimal amount, the resulting configuration will indeed have the pair containing the now very short string as the non-crossing one, while the other pair intersects. This rule is also symmetric and label-invariant.\n4.  **Implementation Details**: The mention of \"exact or adaptive-precision robust predicate\" and \"lexicographic ordering\" for deduplication are hallmarks of a professionally designed, robust computational geometry algorithm that correctly handles floating-point issues and ensures true label-invariance.\n\nThis option systematically addresses all types of degeneracy with rules that are consistent with the fundamental requirements of continuity and reciprocity.\n**Verdict: Correct.**\n\n**Option D Analysis**\nThis option proposes a stochastic \"jittering\" method. While averaging over many random perturbations can converge to the correct value as the perturbation size $\\delta \\to 0$, it is not a deterministic rule for a single computation. It replaces an algorithmic challenge with a statistical estimation, which is computationally expensive and does not fit the request for a \"rule\" in the sense of a deterministic algorithm. Moreover, the instruction to \"Treat any zero-length string as absent\" is ill-defined and problematic. A zero-length string has a length of $0$, which should be used in the sum; removing the string entirely would alter the pairing structure of the remaining three strings, breaking the method.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}