{
    "hands_on_practices": [
        {
            "introduction": "The Discrete Transfer Method (DTM) begins by dividing the continuous sphere of directions into a finite set of discrete angular bins. This fundamental exercise guides you through deriving the solid angle, or quadrature weight, for each bin directly from first principles. Mastering this step is crucial for correctly formulating the angular integrals that define radiative heat flux and source terms. ",
            "id": "3990862",
            "problem": "In the Discrete Transfer Method for Radiation (DTM), directional space is discretized on the unit sphere using the polar angle $\\theta \\in [0,\\pi]$ and the azimuthal angle $\\phi \\in [0,2\\pi]$ to form a set of nonoverlapping angular bins. Consider a polar-azimuthal discretization with $N_{\\theta}$ polar bins and $N_{\\phi}$ azimuthal bins. Let the polar edges be given by a strictly monotone mapping $\\mu(s)$ with $\\mu(0)=1$ and $\\mu(1)=-1$, where $s \\in [0,1]$ is a normalized index and $\\mu = \\cos(\\theta)$. The polar bin edges are defined by $\\mu_{k} = \\mu\\!\\left(\\frac{k}{N_{\\theta}}\\right)$ for $k = 0,1,\\dots,N_{\\theta}$. Similarly, let the azimuthal edges be given by a strictly monotone mapping $\\phi(t)$ with $\\phi(0)=0$ and $\\phi(1)=2\\pi$, where $t \\in [0,1]$ is a normalized index. The azimuthal bin edges are defined by $\\phi_{m} = \\phi\\!\\left(\\frac{m}{N_{\\phi}}\\right)$ for $m = 0,1,\\dots,N_{\\phi}$. This general construction permits either equal-solid-angle bins or nonuniform resolution concentrated in selected directions through appropriate choices of $\\mu(s)$ and $\\phi(t)$.\n\nDerive the quadrature weight $w_{k,m}$ assigned to the bin $(k,m)$, defined by the polar interval $[\\mu_{k},\\mu_{k-1}]$ and the azimuthal interval $[\\phi_{m-1},\\phi_{m}]$, such that the quadrature sum exactly integrates a constant directional field over the sphere. Your derivation must start from fundamental geometric definitions on the unit sphere and proceed rigorously to the final expression, showing how the choice of $\\mu(s)$ and $\\phi(t)$ preserves the total solid angle. Express your final weight formula in steradians and use radians for all angles. You must provide the weight $w_{k,m}$ as a single closed-form analytic expression in terms of $\\mu(\\cdot)$, \\,$\\phi(\\cdot)$, \\,$N_{\\theta}$, and $N_{\\phi}$. No numerical evaluation is required.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and self-contained. The definitions and constraints are consistent with standard practices in computational thermal engineering, specifically within the context of the Discrete Transfer Method for Radiation. No flaws were identified. We may therefore proceed with the derivation.\n\nThe objective is to derive the quadrature weight $w_{k,m}$ for an angular bin defined by the indices $(k,m)$. This weight represents the solid angle subtended by that bin. The derivation must start from the fundamental definition of a differential solid angle in spherical coordinates.\n\nIn a spherical coordinate system, the differential solid angle $d\\Omega$ is given by:\n$$\nd\\Omega = \\sin(\\theta) \\, d\\theta \\, d\\phi\n$$\nwhere $\\theta \\in [0,\\pi]$ is the polar angle and $\\phi \\in [0,2\\pi]$ is the azimuthal angle.\n\nThe problem defines the polar discretization in terms of the variable $\\mu = \\cos(\\theta)$. We perform a change of variables from $\\theta$ to $\\mu$. The differential of $\\mu$ is:\n$$\nd\\mu = \\frac{d}{d\\theta}(\\cos(\\theta)) \\, d\\theta = -\\sin(\\theta) \\, d\\theta\n$$\nFrom this, we can express $\\sin(\\theta) \\, d\\theta = -d\\mu$. Substituting this into the expression for the differential solid angle gives:\n$$\nd\\Omega = -d\\mu \\, d\\phi\n$$\nThe negative sign arises because as $\\theta$ increases from $0$ to $\\pi$, $\\mu$ decreases from $1$ to $-1$.\n\nThe quadrature weight $w_{k,m}$ is the solid angle of the bin $(k,m)$, which is obtained by integrating $d\\Omega$ over the angular extent of that bin. The bin is defined by the polar interval corresponding to $[\\mu_{k},\\mu_{k-1}]$ and the azimuthal interval $[\\phi_{m-1},\\phi_{m}]$. Let's first consider the integration over the corresponding polar angles, which range from $\\theta_{k-1}$ to $\\theta_{k}$ such that $\\mu_{k-1} = \\cos(\\theta_{k-1})$ and $\\mu_{k} = \\cos(\\theta_{k})$. Since $\\mu(s)$ is strictly monotone decreasing (from $\\mu(0)=1$ to $\\mu(1)=-1$), an increasing index $k$ corresponds to an increasing value of $\\theta$. Thus, the polar angle interval is $[\\theta_{k-1}, \\theta_{k}]$. The azimuthal interval is given directly as $[\\phi_{m-1}, \\phi_m]$.\n\nThe integral for the solid angle is:\n$$\nw_{k,m} = \\int_{\\phi_{m-1}}^{\\phi_m} \\int_{\\theta_{k-1}}^{\\theta_k} \\sin(\\theta) \\, d\\theta \\, d\\phi\n$$\nWe evaluate the inner integral with respect to $\\theta$:\n$$\n\\int_{\\theta_{k-1}}^{\\theta_k} \\sin(\\theta) \\, d\\theta = [-\\cos(\\theta)]_{\\theta_{k-1}}^{\\theta_k} = -\\cos(\\theta_k) - (-\\cos(\\theta_{k-1})) = \\cos(\\theta_{k-1}) - \\cos(\\theta_k)\n$$\nBy the definitions given in the problem, $\\mu_k = \\cos(\\theta_k)$ and $\\mu_{k-1} = \\cos(\\theta_{k-1})$. The result of the inner integral is therefore $\\mu_{k-1} - \\mu_k$. Since $\\mu$ is a decreasing function of the angle $\\theta$ (and of the index $k$), we have $\\mu_{k-1} > \\mu_k$, ensuring the result is positive.\n\nSubstituting this back into the expression for $w_{k,m}$:\n$$\nw_{k,m} = \\int_{\\phi_{m-1}}^{\\phi_m} (\\mu_{k-1} - \\mu_k) \\, d\\phi\n$$\nThe term $(\\mu_{k-1} - \\mu_k)$ is constant with respect to $\\phi$, so we can move it outside the integral:\n$$\nw_{k,m} = (\\mu_{k-1} - \\mu_k) \\int_{\\phi_{m-1}}^{\\phi_m} d\\phi\n$$\nEvaluating the remaining integral gives:\n$$\nw_{k,m} = (\\mu_{k-1} - \\mu_k) (\\phi_m - \\phi_{m-1})\n$$\nThis expression gives the solid angle for any bin $(k,m)$ in terms of the values at its edges.\n\nFinally, we substitute the specific definitions for the edge values, which are given by the mapping functions $\\mu(s)$ and $\\phi(t)$:\n$\\mu_{k} = \\mu\\!\\left(\\frac{k}{N_{\\theta}}\\right)$\n$\\phi_{m} = \\phi\\!\\left(\\frac{m}{N_{\\phi}}\\right)$\n\nSubstituting these into our expression for $w_{k,m}$ yields the final closed-form expression:\n$$\nw_{k,m} = \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]\n$$\nTo verify this result, we confirm that the sum of all quadrature weights equals the total solid angle of a sphere, $4\\pi$. The total sum is:\n$$\n\\sum_{k=1}^{N_{\\theta}} \\sum_{m=1}^{N_{\\phi}} w_{k,m} = \\sum_{k=1}^{N_{\\theta}} \\sum_{m=1}^{N_{\\phi}} \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]\n$$\nThis is a separable sum, which can be written as the product of two independent sums:\n$$\n\\left( \\sum_{k=1}^{N_{\\theta}} \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\right) \\left( \\sum_{m=1}^{N_{\\phi}} \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right] \\right)\n$$\nBoth sums are telescoping. The first sum is:\n$$\n\\sum_{k=1}^{N_{\\theta}} \\left[ \\mu_{k-1} - \\mu_k \\right] = (\\mu_0 - \\mu_1) + (\\mu_1 - \\mu_2) + \\dots + (\\mu_{N_{\\theta}-1} - \\mu_{N_{\\theta}}) = \\mu_0 - \\mu_{N_{\\theta}}\n$$\nUsing the given boundary conditions, $\\mu_0 = \\mu(0) = 1$ and $\\mu_{N_{\\theta}} = \\mu(1) = -1$. The sum is $1 - (-1) = 2$.\n\nThe second sum is:\n$$\n\\sum_{m=1}^{N_{\\phi}} \\left[ \\phi_m - \\phi_{m-1} \\right] = (\\phi_1 - \\phi_0) + (\\phi_2 - \\phi_1) + \\dots + (\\phi_{N_{\\phi}} - \\phi_{N_{\\phi}-1}) = \\phi_{N_{\\phi}} - \\phi_0\n$$\nUsing the given boundary conditions, $\\phi_0 = \\phi(0) = 0$ and $\\phi_{N_{\\phi}} = \\phi(1) = 2\\pi$. The sum is $2\\pi - 0 = 2\\pi$.\n\nThe total sum of weights is the product of these two results: $2 \\times 2\\pi = 4\\pi$. This matches the total solid angle of a sphere, confirming that the quadrature rule exactly integrates a constant function over the sphere. The derived expression for $w_{k,m}$ is therefore correct.",
            "answer": "$$\n\\boxed{\\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]}\n$$"
        },
        {
            "introduction": "Once directional space is discretized, the DTM traces rays through the computational domain, cell by cell. This practice focuses on the 'transfer' aspect of the method, requiring you to calculate how radiative intensity is attenuated as it traverses multiple cells with different absorption properties. Understanding the concept of cumulative optical thickness is essential for implementing the core ray-marching algorithm of the DTM. ",
            "id": "3990847",
            "problem": "In computational thermal engineering, the Discrete Transfer Method (DTM) models radiation by tracing straight rays through a discretized participating medium. Consider a single ray that crosses $N$ contiguous cells in a nonemitting, nonscattering, gray medium under steady conditions. The absorption coefficient in cell $i$ is uniform and equal to $\\kappa_{i}$ (with units $\\mathrm{m}^{-1}$) along the path segment of length $\\Delta s_{i}$ (with units $\\mathrm{m}$). The ray enters the first cell with incident radiative intensity $I_{0}$.\n\nStarting from the radiative transfer equation (RTE) for a nonemitting, nonscattering, gray medium, derive the expression for the attenuation of intensity across a single segment and then across the entire $N$-segment path. From this derivation, define the effective optical thickness $\\tau_{\\mathrm{eff}}$ along the entire ray in terms of $\\kappa_{i}$ and $\\Delta s_{i}$, such that the overall attenuation is identical to that of a single homogeneous slab of optical thickness $\\tau_{\\mathrm{eff}}$. Explain how DTM accumulates attenuation across multiple segments.\n\nFor a specific case with $N = 5$, use the following data:\n- Cell $1$: $\\kappa_{1} = 0.8\\,\\mathrm{m}^{-1}$, $\\Delta s_{1} = 0.30\\,\\mathrm{m}$.\n- Cell $2$: $\\kappa_{2} = 2.3\\,\\mathrm{m}^{-1}$, $\\Delta s_{2} = 0.10\\,\\mathrm{m}$.\n- Cell $3$: $\\kappa_{3} = 0.5\\,\\mathrm{m}^{-1}$, $\\Delta s_{3} = 1.20\\,\\mathrm{m}$.\n- Cell $4$: $\\kappa_{4} = 1.1\\,\\mathrm{m}^{-1}$, $\\Delta s_{4} = 0.050\\,\\mathrm{m}$.\n- Cell $5$: $\\kappa_{5} = 0.050\\,\\mathrm{m}^{-1}$, $\\Delta s_{5} = 4.00\\,\\mathrm{m}$.\n\nCompute the effective optical thickness $\\tau_{\\mathrm{eff}}$ for this ray. Round your answer to four significant figures. Express the final optical thickness as a dimensionless quantity.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It is based on the fundamental Radiative Transfer Equation (RTE) and a standard numerical method (DTM) in computational thermal engineering. All data provided are complete, consistent, and physically plausible. The problem is therefore deemed valid and a solution will be provided.\n\nThe starting point for this analysis is the radiative transfer equation (RTE) along a path $s$ for a gray, nonemitting, and nonscattering medium under steady conditions. In such a medium, the change in radiative intensity $I$ is due solely to absorption, described by the absorption coefficient $\\kappa$. The RTE simplifies to:\n$$\n\\frac{dI}{ds} = -\\kappa I\n$$\nThis is a first-order linear ordinary differential equation.\n\nFirst, we derive the expression for the attenuation of intensity across a single cell segment, say cell $i$. Within this cell, the absorption coefficient $\\kappa_i$ is uniform, and the path length is $\\Delta s_i$. We can solve the RTE by separation of variables. Let $I_{i-1}$ be the intensity entering the cell at $s=0$ (local coordinate) and $I_i$ be the intensity leaving the cell at $s=\\Delta s_i$.\n$$\n\\frac{dI}{I} = -\\kappa_i ds\n$$\nIntegrating across the cell from its entrance to its exit:\n$$\n\\int_{I_{i-1}}^{I_i} \\frac{dI}{I} = \\int_{0}^{\\Delta s_i} -\\kappa_i ds\n$$\n$$\n\\ln(I_i) - \\ln(I_{i-1}) = -\\kappa_i \\Delta s_i\n$$\n$$\n\\ln\\left(\\frac{I_i}{I_{i-1}}\\right) = -\\kappa_i \\Delta s_i\n$$\nExponentiating both sides gives the attenuation expression for a single segment:\n$$\nI_i = I_{i-1} \\exp(-\\kappa_i \\Delta s_i)\n$$\nThe dimensionless product $\\kappa_i \\Delta s_i$ is defined as the optical thickness of the cell segment, $\\tau_i$.\n\nNext, we derive the attenuation across the entire $N$-segment path. The Discrete Transfer Method (DTM) accumulates attenuation by treating the output intensity from one cell as the input intensity for the next. Let the initial intensity entering the first cell be $I_0$.\n\nThe intensity leaving cell $1$ is $I_1$:\n$$\nI_1 = I_0 \\exp(-\\kappa_1 \\Delta s_1)\n$$\nThe intensity leaving cell $2$, which is entered with intensity $I_1$, is $I_2$:\n$$\nI_2 = I_1 \\exp(-\\kappa_2 \\Delta s_2) = \\left[I_0 \\exp(-\\kappa_1 \\Delta s_1)\\right] \\exp(-\\kappa_2 \\Delta s_2)\n$$\nUsing the property of exponentials $\\exp(a)\\exp(b) = \\exp(a+b)$, we get:\n$$\nI_2 = I_0 \\exp(-(\\kappa_1 \\Delta s_1 + \\kappa_2 \\Delta s_2))\n$$\nBy induction, after the ray passes through all $N$ cells, the final intensity $I_N$ is:\n$$\nI_N = I_0 \\exp\\left(-\\sum_{i=1}^{N} \\kappa_i \\Delta s_i\\right)\n$$\nThis equation demonstrates how DTM accumulates attenuation: the total attenuation is an exponential function whose argument is the sum of the individual optical thicknesses of all cells traversed by the ray.\n\nThe problem asks to define an effective optical thickness $\\tau_{\\mathrm{eff}}$ for the entire path, such that the overall attenuation is identical to that of a single homogeneous slab with this optical thickness. The attenuation through such a slab would be:\n$$\nI_N = I_0 \\exp(-\\tau_{\\mathrm{eff}})\n$$\nBy comparing this with the expression derived for the $N$-segment path, we can directly identify the effective optical thickness:\n$$\nI_0 \\exp(-\\tau_{\\mathrm{eff}}) = I_0 \\exp\\left(-\\sum_{i=1}^{N} \\kappa_i \\Delta s_i\\right)\n$$\nTherefore, the effective optical thickness is the sum of the individual optical thicknesses:\n$$\n\\tau_{\\mathrm{eff}} = \\sum_{i=1}^{N} \\kappa_i \\Delta s_i\n$$\nThis quantity is dimensionless, as the product of the absorption coefficient (units $\\mathrm{m}^{-1}$) and the path length (units $\\mathrm{m}$) results in a dimensionless number.\n\nNow, we compute $\\tau_{\\mathrm{eff}}$ for the specific case with $N=5$ and the given data.\nThe optical thickness for each cell is calculated as $\\tau_i = \\kappa_i \\Delta s_i$.\n\nCell $1$: $\\tau_1 = \\kappa_1 \\Delta s_1 = (0.8\\,\\mathrm{m}^{-1}) \\times (0.30\\,\\mathrm{m}) = 0.24$\nCell $2$: $\\tau_2 = \\kappa_2 \\Delta s_2 = (2.3\\,\\mathrm{m}^{-1}) \\times (0.10\\,\\mathrm{m}) = 0.23$\nCell $3$: $\\tau_3 = \\kappa_3 \\Delta s_3 = (0.5\\,\\mathrm{m}^{-1}) \\times (1.20\\,\\mathrm{m}) = 0.60$\nCell $4$: $\\tau_4 = \\kappa_4 \\Delta s_4 = (1.1\\,\\mathrm{m}^{-1}) \\times (0.050\\,\\mathrm{m}) = 0.055$\nCell $5$: $\\tau_5 = \\kappa_5 \\Delta s_5 = (0.050\\,\\mathrm{m}^{-1}) \\times (4.00\\,\\mathrm{m}) = 0.200$ (retaining significant figures from multiplication for intermediate step).\n\nThe effective optical thickness is the sum of these individual values:\n$$\n\\tau_{\\mathrm{eff}} = \\tau_1 + \\tau_2 + \\tau_3 + \\tau_4 + \\tau_5\n$$\n$$\n\\tau_{\\mathrm{eff}} = 0.24 + 0.23 + 0.60 + 0.055 + 0.200\n$$\n$$\n\\tau_{\\mathrm{eff}} = 1.325\n$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value of $1.325$ already has four significant figures, so no further rounding is necessary.",
            "answer": "$$\n\\boxed{1.325}\n$$"
        },
        {
            "introduction": "A numerical model is only as reliable as its verification. This capstone practice challenges you to build a DTM solver for a classic benchmark problem—a one-dimensional slab—and compare its output against a rigorous analytical solution. This process of verification is a cornerstone of computational engineering, providing confidence that your code correctly implements the underlying physics and converges to the true solution as the discretization is refined. ",
            "id": "3990816",
            "problem": "Consider a one-dimensional plane-parallel slab of thickness $L$ containing a gray, isothermal, emitting-absorbing medium with no scattering. The absorption coefficient is spatially uniform and equal to $\\kappa$ in units of $\\mathrm{m^{-1}}$. The medium temperature is $T_m$ in $\\mathrm{K}$. The slab boundaries at $x=0$ and $x=L$ are perfectly black (no reflection), with wall temperatures $T_{w,0}$ and $T_{w,L}$ in $\\mathrm{K}$. The blackbody specific intensity (per unit solid angle) is assumed gray and given by $I_b(T) = \\sigma T^4/\\pi$ in $\\mathrm{W\\,m^{-2}\\,sr^{-1}}$, where $\\sigma$ is the Stefan–Boltzmann constant in $\\mathrm{W\\,m^{-2}\\,K^{-4}}$. Denote by $\\theta$ the polar angle relative to the $+x$ axis, measured in radians, and by $\\mu = \\cos\\theta$ the direction cosine.\n\nStarting from the fundamental radiative transfer equation along a ray,\n$$\n\\frac{\\mathrm{d}I}{\\mathrm{d}s} = -\\kappa I + \\kappa I_b(T_m),\n$$\nwith appropriate boundary conditions at $x=0$ and $x=L$ for a black wall, derive the analytical expression for the specific intensity $I(x,\\mu)$ for $\\mu>0$ and $\\mu<0$. From first principles, derive the expression for the radiative heat flux $q_r(x)$ in $\\mathrm{W\\,m^{-2}}$ as a hemispherical angular integral,\n$$\nq_r(x) = 2\\pi \\int_{-1}^{1} \\mu\\, I(x,\\mu)\\, \\mathrm{d}\\mu,\n$$\nexpressed in terms of $\\kappa$, $L$, $T_m$, $T_{w,0}$, and $T_{w,L}$. Your derivation must be grounded in the stated equation, the definition of a black surface, and the definition of $I_b(T)$, and must not introduce unstated assumptions.\n\nThen, specify how the Discrete Transfer Method (DTM) reproduces this solution under mesh and angular refinement by:\n- Discretizing the slab into $M$ uniform cells of width $\\Delta x = L/M$, and marching the ray intensity along each discrete direction cosine $\\mu_i \\in (0,1]$ using the exact homogeneous solution of the one-dimensional ordinary differential equation over $\\Delta x$.\n- Approximating the hemispherical angular integrals with a quadrature over $\\mu \\in [0,1]$ using $N$ directions and weights $\\{(\\mu_i,w_i)\\}_{i=1}^{N}$, applying symmetry between forward ($\\mu>0$) and backward ($\\mu<0$) hemispheres.\n- Demonstrating that as $M\\to\\infty$ and $N\\to\\infty$, the DTM-computed $q_r(x)$ converges to the analytical expression.\n\nImplement a program that, for each test case below, computes:\n- The analytical radiative heat flux at the slab mid-plane $x=L/2$ in $\\mathrm{W\\,m^{-2}}$.\n- The DTM-predicted radiative heat flux at $x=L/2$ using a coarse discretization $(M_c,N_c)$.\n- The DTM-predicted radiative heat flux at $x=L/2$ using a refined discretization $(M_f,N_f)$.\n- The relative errors of the coarse and refined DTM fluxes with respect to the analytical flux, defined as\n$$\n\\varepsilon = \\frac{\\left|q_{\\text{DTM}} - q_{\\text{analytical}}\\right|}{\\max\\left(\\left|q_{\\text{analytical}}\\right|,\\ \\epsilon\\right)},\n$$\nwhere $\\epsilon = 10^{-12}$ in $\\mathrm{W\\,m^{-2}}$.\n\nAll quantities with physical units must be handled consistently; the fluxes must be computed and internally represented in $\\mathrm{W\\,m^{-2}}$. The final program output must be a single line containing a comma-separated list of the error pairs for each test case, with each error pair presented as a two-element list $[\\varepsilon_{\\text{coarse}}, \\varepsilon_{\\text{refined}}]$.\n\nTest suite:\n- Case $1$ (happy path): $\\kappa = 1.0\\,\\mathrm{m^{-1}}$, $L = 0.5\\,\\mathrm{m}$, $T_m = 1000\\,\\mathrm{K}$, $T_{w,0} = 1200\\,\\mathrm{K}$, $T_{w,L} = 800\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$.\n- Case $2$ (radiative equilibrium boundary): $\\kappa = 5.0\\,\\mathrm{m^{-1}}$, $L = 0.2\\,\\mathrm{m}$, $T_m = 900\\,\\mathrm{K}$, $T_{w,0} = 900\\,\\mathrm{K}$, $T_{w,L} = 900\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$. This case should produce near-zero analytical flux at $x=L/2$.\n- Case $3$ (optically thin): $\\kappa = 0.01\\,\\mathrm{m^{-1}}$, $L = 2.0\\,\\mathrm{m}$, $T_m = 1000\\,\\mathrm{K}$, $T_{w,0} = 1000\\,\\mathrm{K}$, $T_{w,L} = 1100\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$.\n- Case $4$ (optically thick): $\\kappa = 20.0\\,\\mathrm{m^{-1}}$, $L = 0.1\\,\\mathrm{m}$, $T_m = 1000\\,\\mathrm{K}$, $T_{w,0} = 1400\\,\\mathrm{K}$, $T_{w,L} = 800\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case yielding a two-element list of floats $[\\varepsilon_{\\text{coarse}}, \\varepsilon_{\\text{refined}}]$, for example, $[[e_{1c},e_{1f}],[e_{2c},e_{2f}],\\dots]$.",
            "solution": "We begin from the fundamental radiative transfer equation along a characteristic ray in a gray, isothermal, emitting-absorbing medium with no scattering,\n$$\n\\frac{\\mathrm{d}I}{\\mathrm{d}s} = -\\kappa I + \\kappa I_b(T_m),\n$$\nwhere $I$ is the specific intensity in $\\mathrm{W\\,m^{-2}\\,sr^{-1}}$, $s$ is the path length along the ray in $\\mathrm{m}$, $\\kappa$ is the absorption coefficient in $\\mathrm{m^{-1}}$, and $I_b(T_m) = \\sigma T_m^4/\\pi$ is the blackbody specific intensity of the medium. The boundaries at $x=0$ and $x=L$ are black; consequently, the boundary conditions for rays entering the medium from the walls are:\n- At $x=0$, for rays with $\\mu = \\cos\\theta > 0$ (propagating in the $+x$ direction), $I(0,\\mu) = I_b(T_{w,0})$.\n- At $x=L$, for rays with $\\mu = \\cos\\theta < 0$ (propagating in the $-x$ direction), $I(L,\\mu) = I_b(T_{w,L})$.\n\nFor one-dimensional plane-parallel geometry, the coordinate $s$ along a ray relates to the spatial coordinate $x$ via $\\mathrm{d}s = \\mathrm{d}x / \\mu$ for $\\mu>0$ and $\\mathrm{d}s = -\\mathrm{d}x / |\\mu|$ for $\\mu<0$. The ordinary differential equation has constant coefficients and admits a standard integrating factor solution. For $\\mu>0$, consider the ordinary differential equation in terms of $x$,\n$$\n\\mu\\, \\frac{\\mathrm{d}I(x,\\mu)}{\\mathrm{d}x} = -\\kappa I(x,\\mu) + \\kappa I_b(T_m).\n$$\nThis linear equation has the homogeneous solution $\\exp(-\\kappa x/\\mu)$ and the particular solution $I(x,\\mu) = I_b(T_m)$. Enforcing the boundary condition $I(0,\\mu) = I_b(T_{w,0})$, the solution for $\\mu>0$ is\n$$\nI(x,\\mu) = I_b(T_m) + \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right),\\quad \\mu>0.\n$$\nSimilarly, for $\\mu<0$, we write $|\\mu| = -\\mu$ and integrate from $x=L$ toward smaller $x$. The equation becomes\n$$\n|\\mu|\\, \\frac{\\mathrm{d}I(x,\\mu)}{\\mathrm{d}x} = \\kappa I_b(T_m) - \\kappa I(x,\\mu).\n$$\nEnforcing $I(L,\\mu) = I_b(T_{w,L})$, the solution for $\\mu<0$ is\n$$\nI(x,\\mu) = I_b(T_m) + \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{|\\mu|}\\right),\\quad \\mu<0.\n$$\n\nThe radiative heat flux in the $x$-direction is defined by angular integration over the full sphere; in plane-parallel symmetry, the azimuthal integration yields a factor $2\\pi$ and the polar integral reduces to $\\mu \\in [-1,1]$,\n$$\nq_r(x) = 2\\pi \\int_{-1}^{1} \\mu\\, I(x,\\mu)\\, \\mathrm{d}\\mu.\n$$\nSplit the integral into forward $(\\mu>0)$ and backward $(\\mu<0)$ hemispheres, using the symmetry substitution $\\nu = |\\mu|$ for the backward hemisphere, and the explicit solutions above:\n\\begin{align*}\nq_r(x) &= 2\\pi \\left[ \\int_{0}^{1} \\mu\\, \\left(I_b(T_m) + \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right)\\right) \\mathrm{d}\\mu \\right. \\\\\n&\\quad\\left. + \\int_{-1}^{0} \\mu\\, \\left(I_b(T_m) + \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{|\\mu|}\\right)\\right) \\mathrm{d}\\mu \\right].\n\\end{align*}\nIn the backward integral, let $\\nu = |\\mu| \\in (0,1]$ so that $\\mu = -\\nu$ and $\\mathrm{d}\\mu = -\\mathrm{d}\\nu$, yielding\n\\begin{align*}\nq_r(x) &= 2\\pi \\left[ \\int_{0}^{1} \\mu\\, I_b(T_m)\\, \\mathrm{d}\\mu + \\big(I_b(T_{w,0}) - I_b(T_m)\\big) \\int_{0}^{1} \\mu\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right)\\, \\mathrm{d}\\mu \\right. \\\\\n&\\quad \\left. - \\int_{0}^{1} \\nu\\, I_b(T_m)\\, \\mathrm{d}\\nu - \\big(I_b(T_{w,L}) - I_b(T_m)\\big) \\int_{0}^{1} \\nu\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{\\nu}\\right)\\, \\mathrm{d}\\nu \\right].\n\\end{align*}\nThe terms $\\int_{0}^{1} \\mu\\, I_b(T_m)\\,\\mathrm{d}\\mu$ cancel identically. Define the exponential integral of order $n$ in the radiative transfer sense,\n$$\nE_n(t) \\equiv \\int_{0}^{1} \\mu^{n-2}\\, \\exp\\!\\left(-\\frac{t}{\\mu}\\right)\\, \\mathrm{d}\\mu,\n$$\nwhich, by change of variables $u=t/\\mu$, is related to the generalized exponential integral $\\mathrm{E}_n$ defined by\n$$\n\\mathrm{E}_n(t) \\equiv \\int_{1}^{\\infty} \\frac{e^{-t v}}{v^n}\\, \\mathrm{d}v.\n$$\nSpecifically,\n$$\n\\int_{0}^{1} \\mu^{n-2}\\, \\exp\\!\\left(-\\frac{t}{\\mu}\\right)\\, \\mathrm{d}\\mu = \\mathrm{E}_n(t).\n$$\nFor $n=3$, the remaining integrals are $E_3$, and we obtain the analytical radiative flux\n$$\nq_r(x) = 2\\pi \\left[ \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\mathrm{E}_3(\\kappa x) - \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\big(\\kappa (L-x)\\big) \\right],\n$$\nwith $\\mathrm{E}_3(0) = \\int_{1}^{\\infty} v^{-3}\\,\\mathrm{d}v = \\frac{1}{2}$, consistent with $\\int_{0}^{1} \\mu\\, \\mathrm{d}\\mu = \\frac{1}{2}$.\n\nDiscrete Transfer Method (DTM) formulation:\n- Spatial discretization: partition $[0,L]$ into $M$ uniform cells, nodes $x_j = j\\, \\Delta x$ for $j=0,1,\\dots,M$, $\\Delta x=L/M$.\n- Angular discretization: choose $N$ quadrature nodes and weights $\\{(\\mu_i,w_i)\\}_{i=1}^{N}$ on $[0,1]$ (e.g., Gauss–Legendre mapped to $[0,1]$) to approximate $\\int_{0}^{1} g(\\mu)\\, \\mathrm{d}\\mu \\approx \\sum_{i=1}^{N} w_i g(\\mu_i)$.\n- Marching scheme: for each $\\mu_i>0$, propagate the forward intensity from $x=0$ to $x=L$ via the exact cellwise solution of the homogeneous ordinary differential equation with a constant source over $\\Delta x$,\n$$\nI_{j+1}^{+}(\\mu_i) = I_{j}^{+}(\\mu_i)\\, \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right) + I_b(T_m)\\, \\left(1 - \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right)\\right),\n$$\ninitialized by the black wall boundary condition $I_{0}^{+}(\\mu_i) = I_b(T_{w,0})$. For each $\\mu_i>0$, propagate the backward intensity from $x=L$ to $x=0$ via\n$$\nI_{j-1}^{-}(\\mu_i) = I_{j}^{-}(\\mu_i)\\, \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right) + I_b(T_m)\\, \\left(1 - \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right)\\right),\n$$\ninitialized by $I_{M}^{-}(\\mu_i) = I_b(T_{w,L})$.\n- Flux evaluation at node $x_j$: approximate the hemispherical integral by quadrature and symmetry,\n$$\nq_r(x_j) \\approx 2\\pi \\left[ \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{+}(\\mu_i)\\ - \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{-}(\\mu_i) \\right].\n$$\n\nConvergence:\n- As $M\\to\\infty$, the discrete marching with the exact per-cell attenuation/emission reproduces the continuous solution for each ray, since it uses the exact solution over each cell for a constant-coefficient ordinary differential equation; thus reducing $\\Delta x$ refines the resolution of sampling $I(x,\\mu)$ at the evaluation location.\n- As $N\\to\\infty$ and with a polynomially accurate quadrature (e.g., Gauss–Legendre), the quadrature approximation of $\\int_{0}^{1} \\mu\\, f(\\mu)\\, \\mathrm{d}\\mu$ converges rapidly to the true integral for smooth $f(\\mu)$, which holds because the exponentials in $I(x,\\mu)$ are analytic in $\\mu$ over $(0,1]$ for finite $\\kappa x$.\n\nError metric:\nWe compute the analytical flux $q_{\\text{analytical}}(L/2)$ using the derived expression in terms of $\\mathrm{E}_3(\\cdot)$ and the DTM flux $q_{\\text{DTM}}(L/2)$ using the discrete marching and quadrature. The relative error is\n$$\n\\varepsilon = \\frac{\\left|q_{\\text{DTM}} - q_{\\text{analytical}}\\right|}{\\max\\left(\\left|q_{\\text{analytical}}\\right|,\\ \\epsilon\\right)},\n$$\nwith $\\epsilon = 10^{-12}\\,\\mathrm{W\\,m^{-2}}$ to avoid division by zero in equilibrium cases.\n\nAlgorithmic steps implemented in code for each test case:\n- Compute $I_b(T) = \\sigma T^4/\\pi$ for $T = T_m, T_{w,0}, T_{w,L}$.\n- Analytical flux at $x=L/2$: evaluate\n$$\nq_r\\!\\left(\\frac{L}{2}\\right) = 2\\pi \\left[ \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right) - \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right) \\right],\n$$\nwhich simplifies to\n$$\nq_r\\!\\left(\\frac{L}{2}\\right) = 2\\pi\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right)\\, \\left(I_b(T_{w,0}) - I_b(T_{w,L})\\right).\n$$\nNumerically, $\\mathrm{E}_3(t)$ is evaluated via the generalized exponential integral $\\mathrm{E}_n(t)$ using the identity $\\int_{0}^{1} \\mu^{n-2} e^{-t/\\mu}\\, \\mathrm{d}\\mu = \\mathrm{E}_n(t)$ with $n=3$.\n- DTM flux at $x=L/2$: construct $N$-point Gauss–Legendre nodes and weights on $[0,1]$ (map from $[-1,1]$), march $I^{+}$ from $x=0$ and $I^{-}$ from $x=L$ across $M$ cells, then evaluate\n$$\nq_r^{\\text{DTM}}\\!\\left(\\frac{L}{2}\\right) \\approx 2\\pi \\left[ \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{+}(\\mu_i)\\ - \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{-}(\\mu_i) \\right],\n$$\nwith $j = M/2$ (assuming $M$ even).\n- Compute the relative errors for coarse $(M_c,N_c)$ and refined $(M_f,N_f)$ discretizations.\n- Aggregate the error pairs for all cases in a single output line as specified.\n\nPhysical and numerical consistency:\n- All fluxes are computed in $\\mathrm{W\\,m^{-2}}$ using $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$.\n- Angles are referenced only through $\\mu = \\cos\\theta$ with $\\theta$ measured in radians; no explicit angle values are used.\n- The test suite probes a happy path, a radiative equilibrium boundary condition (expected near-zero flux), an optically thin slab (small $\\kappa L$), and an optically thick slab (larger $\\kappa L$), covering distinct regimes of attenuation and emission.\n\nUnder mesh refinement ($M_c \\to M_f$) and angular refinement ($N_c \\to N_f$), the DTM flux converges toward the analytical flux, which is reflected in decreasing $\\varepsilon$ values returned by the program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import expn\n\n# Constants\nSIGMA = 5.670374419e-8  # Stefan-Boltzmann constant [W/(m^2 K^4)]\nPI = np.pi\nTOL_DEN = 1e-12  # [W/m^2] for stabilizing relative error in near-zero flux cases\n\ndef blackbody_intensity(T):\n    \"\"\"Blackbody specific intensity per unit solid angle, gray approximation.\"\"\"\n    return SIGMA * T**4 / PI  # [W/(m^2 sr)]\n\ndef analytic_flux_mid(kappa, L, Tm, Tw0, TwL):\n    \"\"\"\n    Analytical radiative heat flux at x = L/2 [W/m^2] for a gray, isothermal slab with black boundaries.\n    q_r(L/2) = 2*pi * E3(kappa*L/2) * (Ib(Tw0) - Ib(TwL))\n    where E3 is the generalized exponential integral expn(3, x).\n    \"\"\"\n    t = kappa * (L / 2.0)\n    E3 = float(expn(3, t))\n    Ibw0 = blackbody_intensity(Tw0)\n    IbwL = blackbody_intensity(TwL)\n    return 2.0 * PI * E3 * (Ibw0 - IbwL)\n\ndef gauss_legendre_unit_interval(N):\n    \"\"\"\n    Gauss-Legendre quadrature nodes/weights on [0,1].\n    Returns arrays mu in (0,1) and weights w such that integral_0^1 f(mu) ~ sum w_i f(mu_i).\n    \"\"\"\n    # Nodes/weights on [-1,1]\n    x, w = np.polynomial.legendre.leggauss(N)\n    # Map to [0,1]: mu = (x+1)/2, w' = w/2\n    mu = 0.5 * (x + 1.0)\n    w_mapped = 0.5 * w\n    return mu, w_mapped\n\ndef dtm_flux_mid(kappa, L, Tm, Tw0, TwL, M, N):\n    \"\"\"\n    DTM-computed radiative heat flux at x = L/2 [W/m^2].\n    \"\"\"\n    # Discretization\n    dx = L / M\n    mid_index = M // 2  # assume M even\n    mu, w = gauss_legendre_unit_interval(N)\n\n    # Blackbody intensities\n    Ib_m = blackbody_intensity(Tm)\n    Ib_w0 = blackbody_intensity(Tw0)\n    Ib_wL = blackbody_intensity(TwL)\n\n    # Precompute attenuation factors per direction\n    # Avoid division by zero: mu strictly in (0,1] for Gauss-Legendre nodes (no endpoints)\n    att = np.exp(- (kappa * dx) / mu)  # shape (N,)\n    one_minus_att = 1.0 - att\n\n    # March forward intensities from x=0\n    I_plus = np.empty((M + 1, N), dtype=float)\n    I_plus[0, :] = Ib_w0\n    for j in range(M):\n        I_plus[j + 1, :] = I_plus[j, :] * att + Ib_m * one_minus_att\n\n    # March backward intensities from x=L\n    I_minus = np.empty((M + 1, N), dtype=float)\n    I_minus[M, :] = Ib_wL\n    for j in range(M, 0, -1):\n        I_minus[j - 1, :] = I_minus[j, :] * att + Ib_m * one_minus_att\n\n    # Flux at mid-plane node\n    # q = 2*pi [ sum w_i * mu_i * I_plus - sum w_i * mu_i * I_minus ]\n    term_plus = np.sum(w * mu * I_plus[mid_index, :])\n    term_minus = np.sum(w * mu * I_minus[mid_index, :])\n    q = 2.0 * PI * (term_plus - term_minus)\n    return float(q)\n\ndef relative_error(q_dtm, q_analytical):\n    denom = max(abs(q_analytical), TOL_DEN)\n    return abs(q_dtm - q_analytical) / denom\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (kappa [1/m], L [m], Tm [K], Tw0 [K], TwL [K], (Mc, Nc), (Mf, Nf))\n    test_cases = [\n        (1.0, 0.5, 1000.0, 1200.0, 800.0, (40, 6), (400, 20)),     # Case 1\n        (5.0, 0.2, 900.0, 900.0, 900.0, (40, 6), (400, 20)),       # Case 2\n        (0.01, 2.0, 1000.0, 1000.0, 1100.0, (40, 6), (400, 20)),   # Case 3\n        (20.0, 0.1, 1000.0, 1400.0, 800.0, (40, 6), (400, 20)),    # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        kappa, L, Tm, Tw0, TwL, (Mc, Nc), (Mf, Nf) = case\n        q_ana = analytic_flux_mid(kappa, L, Tm, Tw0, TwL)\n        q_dtm_coarse = dtm_flux_mid(kappa, L, Tm, Tw0, TwL, Mc, Nc)\n        q_dtm_fine = dtm_flux_mid(kappa, L, Tm, Tw0, TwL, Mf, Nf)\n        err_coarse = relative_error(q_dtm_coarse, q_ana)\n        err_fine = relative_error(q_dtm_fine, q_ana)\n        results.append([err_coarse, err_fine])\n\n    # Final print statement in the exact required format.\n    # Print a single line: list of error pairs for each test case.\n    def format_item(item):\n        if isinstance(item, list):\n            return \"[\" + \",\".join(f\"{x:.6e}\" if isinstance(x, float) else str(x) for x in item) + \"]\"\n        return str(item)\n\n    print(\"[\" + \",\".join(format_item(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}