{
    "hands_on_practices": [
        {
            "introduction": "离散传递法 (DTM) 的第一步是将连续的辐射方向空间分解为一组有限的离散角度。这个练习至关重要，因为它要求我们从基本原理出发，推导每个离散角度（角仓）的积分权重，即其对应的立体角。通过确保所有权重之和等于球面的总立体角 $4\\pi$，我们保证了数值方案的能量守恒性，这是任何有效辐射计算方法的基础 。",
            "id": "3990862",
            "problem": "在辐射离散传递法 (DTM) 中，方向空间通过极角 $\\theta \\in [0,\\pi]$ 和方位角 $\\phi \\in [0,2\\pi]$ 在单位球面上进行离散化，以形成一组不重叠的角区。考虑一个具有 $N_{\\theta}$ 个极角区和 $N_{\\phi}$ 个方位角区的极角-方位角离散化方案。设极角区边界由一个严格单调映射 $\\mu(s)$ 给出，满足 $\\mu(0)=1$ 和 $\\mu(1)=-1$，其中 $s \\in [0,1]$ 是一个归一化指数，且 $\\mu = \\cos(\\theta)$。极角区边界定义为 $\\mu_{k} = \\mu\\!\\left(\\frac{k}{N_{\\theta}}\\right)$，其中 $k = 0,1,\\dots,N_{\\theta}$。类似地，设方位角区边界由一个严格单调映射 $\\phi(t)$ 给出，满足 $\\phi(0)=0$ 和 $\\phi(1)=2\\pi$，其中 $t \\in [0,1]$ 是一个归一化指数。方位角区边界定义为 $\\phi_{m} = \\phi\\!\\left(\\frac{m}{N_{\\phi}}\\right)$，其中 $m = 0,1,\\dots,N_{\\phi}$。这种通用构造允许通过适当选择 $\\mu(s)$ 和 $\\phi(t)$ 来实现等立体角区，或在选定方向上集中分辨率的非均匀划分。\n\n推导分配给角区 $(k,m)$ 的求积权重 $w_{k,m}$，该角区由极角区间 $[\\mu_{k},\\mu_{k-1}]$ 和方位角区间 $[\\phi_{m-1},\\phi_{m}]$ 定义。要求求积和能够精确积分整个球面上的恒定方向场。您的推导必须从单位球面上的基本几何定义开始，并严格地推导出最终表达式，同时说明 $\\mu(s)$ 和 $\\phi(t)$ 的选择如何保持总立体角不变。请用球面度表示最终的权重公式，并对所有角度使用弧度单位。您必须提供权重 $w_{k,m}$ 的单一闭式解析表达式，该表达式应使用 $\\mu(\\cdot)$、$\\phi(\\cdot)$、$N_{\\theta}$ 和 $N_{\\phi}$ 表示。无需进行数值计算。",
            "solution": "问题陈述经核实具有科学依据、适定、客观且自洽。其定义和约束条件符合计算热工学领域的标准实践，特别是在辐射离散传递法的背景下。未发现任何缺陷。因此，我们可以开始进行推导。\n\n目标是推导由指数 $(k,m)$ 定义的角区的求积权重 $w_{k,m}$。该权重代表该角区所张的立体角。推导必须从球坐标中微分立体角的基本定义开始。\n\n在球坐标系中，微分立体角 $d\\Omega$ 由下式给出：\n$$\nd\\Omega = \\sin(\\theta) \\, d\\theta \\, d\\phi\n$$\n其中 $\\theta \\in [0,\\pi]$ 是极角，$\\phi \\in [0,2\\pi]$ 是方位角。\n\n问题中用变量 $\\mu = \\cos(\\theta)$ 来定义极角离散化。我们进行从 $\\theta$ 到 $\\mu$ 的变量替换。$\\mu$ 的微分为：\n$$\nd\\mu = \\frac{d}{d\\theta}(\\cos(\\theta)) \\, d\\theta = -\\sin(\\theta) \\, d\\theta\n$$\n由此，我们可以得到 $\\sin(\\theta) \\, d\\theta = -d\\mu$。将其代入微分立体角的表达式，得到：\n$$\nd\\Omega = -d\\mu \\, d\\phi\n$$\n负号的出现是因为当 $\\theta$ 从 $0$ 增加到 $\\pi$ 时，$\\mu$ 从 $1$ 减小到 $-1$。\n\n求积权重 $w_{k,m}$ 是角区 $(k,m)$ 的立体角，通过在该角区的角度范围内对 $d\\Omega$ 进行积分得到。该角区由极角区间 $[\\mu_{k},\\mu_{k-1}]$ 和方位角区间 $[\\phi_{m-1},\\phi_{m}]$ 定义。我们首先考虑对相应的极角进行积分，其范围从 $\\theta_{k-1}$ 到 $\\theta_{k}$，使得 $\\mu_{k-1} = \\cos(\\theta_{k-1})$ 且 $\\mu_{k} = \\cos(\\theta_{k})$。由于 $\\mu(s)$ 是严格单调递减的（从 $\\mu(0)=1$ 到 $\\mu(1)=-1$），递增的指数 $k$ 对应于递增的 $\\theta$ 值。因此，极角区间为 $[\\theta_{k-1}, \\theta_{k}]$。方位角区间直接给出为 $[\\phi_{m-1}, \\phi_m]$。\n\n立体角的积分为：\n$$\nw_{k,m} = \\int_{\\phi_{m-1}}^{\\phi_m} \\int_{\\theta_{k-1}}^{\\theta_k} \\sin(\\theta) \\, d\\theta \\, d\\phi\n$$\n我们先计算关于 $\\theta$ 的内层积分：\n$$\n\\int_{\\theta_{k-1}}^{\\theta_k} \\sin(\\theta) \\, d\\theta = [-\\cos(\\theta)]_{\\theta_{k-1}}^{\\theta_k} = -\\cos(\\theta_k) - (-\\cos(\\theta_{k-1})) = \\cos(\\theta_{k-1}) - \\cos(\\theta_k)\n$$\n根据问题中给出的定义，$\\mu_k = \\cos(\\theta_k)$ 和 $\\mu_{k-1} = \\cos(\\theta_{k-1})$。因此，内层积分的结果是 $\\mu_{k-1} - \\mu_k$。由于 $\\mu$ 是关于角度 $\\theta$（以及指数 $k$）的递减函数，我们有 $\\mu_{k-1} > \\mu_k$，这确保了结果为正。\n\n将此结果代回 $w_{k,m}$ 的表达式中：\n$$\nw_{k,m} = \\int_{\\phi_{m-1}}^{\\phi_m} (\\mu_{k-1} - \\mu_k) \\, d\\phi\n$$\n项 $(\\mu_{k-1} - \\mu_k)$ 相对于 $\\phi$ 是常数，因此可以将其移到积分号外：\n$$\nw_{k,m} = (\\mu_{k-1} - \\mu_k) \\int_{\\phi_{m-1}}^{\\phi_m} d\\phi\n$$\n计算剩余的积分得到：\n$$\nw_{k,m} = (\\mu_{k-1} - \\mu_k) (\\phi_m - \\phi_{m-1})\n$$\n该表达式给出了任意角区 $(k,m)$ 的立体角，用其边界上的值表示。\n\n最后，我们代入由映射函数 $\\mu(s)$ 和 $\\phi(t)$ 给出的边界值的具体定义：\n$\\mu_{k} = \\mu\\!\\left(\\frac{k}{N_{\\theta}}\\right)$\n$\\phi_{m} = \\phi\\!\\left(\\frac{m}{N_{\\phi}}\\right)$\n\n将这些定义代入我们的 $w_{k,m}$ 表达式，得到最终的闭式表达式：\n$$\nw_{k,m} = \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]\n$$\n为验证此结果，我们确认所有求积权重的总和等于球体的总立体角 $4\\pi$。总和为：\n$$\n\\sum_{k=1}^{N_{\\theta}} \\sum_{m=1}^{N_{\\phi}} w_{k,m} = \\sum_{k=1}^{N_{\\theta}} \\sum_{m=1}^{N_{\\phi}} \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]\n$$\n这是一个可分离的和，可以写成两个独立求和的乘积：\n$$\n\\left( \\sum_{k=1}^{N_{\\theta}} \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\right) \\left( \\sum_{m=1}^{N_{\\phi}} \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right] \\right)\n$$\n这两个和都是裂项求和（或伸缩求和）。第一个和是：\n$$\n\\sum_{k=1}^{N_{\\theta}} \\left[ \\mu_{k-1} - \\mu_k \\right] = (\\mu_0 - \\mu_1) + (\\mu_1 - \\mu_2) + \\dots + (\\mu_{N_{\\theta}-1} - \\mu_{N_{\\theta}}) = \\mu_0 - \\mu_{N_{\\theta}}\n$$\n使用给定的边界条件，$\\mu_0 = \\mu(0) = 1$ 和 $\\mu_{N_{\\theta}} = \\mu(1) = -1$。该和为 $1 - (-1) = 2$。\n\n第二个和是：\n$$\n\\sum_{m=1}^{N_{\\phi}} \\left[ \\phi_m - \\phi_{m-1} \\right] = (\\phi_1 - \\phi_0) + (\\phi_2 - \\phi_1) + \\dots + (\\phi_{N_{\\phi}} - \\phi_{N_{\\phi}-1}) = \\phi_{N_{\\phi}} - \\phi_0\n$$\n使用给定的边界条件，$\\phi_0 = \\phi(0) = 0$ 和 $\\phi_{N_{\\phi}} = \\phi(1) = 2\\pi$。该和为 $2\\pi - 0 = 2\\pi$。\n\n权重的总和是这两个结果的乘积：$2 \\times 2\\pi = 4\\pi$。这与球体的总立体角相符，证实了该求积法则能够精确积分球面上的常数函数。因此，推导出的 $w_{k,m}$ 表达式是正确的。",
            "answer": "$$\n\\boxed{\\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]}\n$$"
        },
        {
            "introduction": "在确定了离散方向后，下一步是沿着每个方向追踪辐射强度的变化。这个练习模拟了射线穿过非均匀参与介质的核心过程，即辐射衰减。通过从辐射传递方程 (RTE) 出发，您将推导出如何计算射线穿过多个具有不同吸收系数的计算单元时的总有效光学厚度，这清晰地展示了 DTM 算法逐个单元累积衰减的基本机制 。",
            "id": "3990847",
            "problem": "在计算热工学中，离散传递法（DTM）通过在离散化的参与介质中追踪直线光线来模拟辐射。考虑在稳态条件下，一束光线穿过一个无发射、无散射的灰介质中的 $N$ 个连续单元格。在单元格 $i$ 中，吸收系数 $\\kappa_{i}$（单位为 $\\mathrm{m}^{-1}$）在长度为 $\\Delta s_{i}$（单位为 $\\mathrm{m}$）的路径段上是均匀的。光线以入射辐射强度 $I_{0}$ 进入第一个单元格。\n\n从无发射、无散射的灰介质的辐射传输方程（RTE）出发，推导强度在单个路径段上以及在整个 $N$ 段路径上的衰减表达式。根据此推导，用 $\\kappa_{i}$ 和 $\\Delta s_{i}$ 定义整个光线路径上的有效光学厚度 $\\tau_{\\mathrm{eff}}$，使得总衰减与光学厚度为 $\\tau_{\\mathrm{eff}}$ 的单个均匀平板的衰减相同。解释DTM如何累积多个路径段上的衰减。\n\n对于一个 $N = 5$ 的具体案例，使用以下数据：\n- 单元格 $1$：$\\kappa_{1} = 0.8\\,\\mathrm{m}^{-1}$，$\\Delta s_{1} = 0.30\\,\\mathrm{m}$。\n- 单元格 $2$：$\\kappa_{2} = 2.3\\,\\mathrm{m}^{-1}$，$\\Delta s_{2} = 0.10\\,\\mathrm{m}$。\n- 单元格 $3$：$\\kappa_{3} = 0.5\\,\\mathrm{m}^{-1}$，$\\Delta s_{3} = 1.20\\,\\mathrm{m}$。\n- 单元格 $4$：$\\kappa_{4} = 1.1\\,\\mathrm{m}^{-1}$，$\\Delta s_{4} = 0.050\\,\\mathrm{m}$。\n- 单元格 $5$：$\\kappa_{5} = 0.050\\,\\mathrm{m}^{-1}$，$\\Delta s_{5} = 4.00\\,\\mathrm{m}$。\n\n计算该光线的有效光学厚度 $\\tau_{\\mathrm{eff}}$。将您的答案四舍五入到四位有效数字。将最终的光学厚度表示为无量纲量。",
            "solution": "该问题陈述经评估具有科学依据、提法明确且客观。它基于计算热工学中的基本辐射传输方程（RTE）和一种标准数值方法（DTM）。所提供的所有数据都是完整、一致且物理上合理的。因此，该问题被认为是有效的，并将提供解答。\n\n本分析的出发点是稳态条件下，灰体、无发射、无散射介质中沿路径 $s$ 的辐射传输方程（RTE）。在此类介质中，辐射强度 $I$ 的变化仅由吸收引起，吸收由吸收系数 $\\kappa$ 描述。RTE简化为：\n$$\n\\frac{dI}{ds} = -\\kappa I\n$$\n这是一个一阶线性常微分方程。\n\n首先，我们推导强度在单个单元格段（例如单元格 $i$）上的衰减表达式。在该单元格内，吸收系数 $\\kappa_i$ 是均匀的，路径长度为 $\\Delta s_i$。我们可以通过分离变量法求解RTE。设 $I_{i-1}$ 是在 $s=0$（局部坐标）处进入单元格的强度，$I_i$ 是在 $s=\\Delta s_i$ 处离开单元格的强度。\n$$\n\\frac{dI}{I} = -\\kappa_i ds\n$$\n对整个单元格从入口到出口进行积分：\n$$\n\\int_{I_{i-1}}^{I_i} \\frac{dI}{I} = \\int_{0}^{\\Delta s_i} -\\kappa_i ds\n$$\n$$\n\\ln(I_i) - \\ln(I_{i-1}) = -\\kappa_i \\Delta s_i\n$$\n$$\n\\ln\\left(\\frac{I_i}{I_{i-1}}\\right) = -\\kappa_i \\Delta s_i\n$$\n对两边取指数，得到单个路径段的衰减表达式：\n$$\nI_i = I_{i-1} \\exp(-\\kappa_i \\Delta s_i)\n$$\n无量纲乘积 $\\kappa_i \\Delta s_i$ 定义为该单元格段的光学厚度 $\\tau_i$。\n\n接下来，我们推导整个 $N$ 段路径上的衰减。离散传递法（DTM）通过将一个单元格的输出强度视为下一个单元格的输入强度来累积衰减。设进入第一个单元格的初始强度为 $I_0$。\n\n离开单元格1的强度为 $I_1$：\n$$\nI_1 = I_0 \\exp(-\\kappa_1 \\Delta s_1)\n$$\n以强度 $I_1$ 进入并离开单元格2的强度为 $I_2$：\n$$\nI_2 = I_1 \\exp(-\\kappa_2 \\Delta s_2) = \\left[I_0 \\exp(-\\kappa_1 \\Delta s_1)\\right] \\exp(-\\kappa_2 \\Delta s_2)\n$$\n利用指数的性质 $\\exp(a)\\exp(b) = \\exp(a+b)$，我们得到：\n$$\nI_2 = I_0 \\exp(-(\\kappa_1 \\Delta s_1 + \\kappa_2 \\Delta s_2))\n$$\n通过归纳法，当光线穿过所有 $N$ 个单元格后，最终强度 $I_N$ 为：\n$$\nI_N = I_0 \\exp\\left(-\\sum_{i=1}^{N} \\kappa_i \\Delta s_i\\right)\n$$\n这个方程展示了DTM如何累积衰减：总衰减是一个指数函数，其参数是光线穿过的所有单元格的各个光学厚度之和。\n\n问题要求为整个路径定义一个有效光学厚度 $\\tau_{\\mathrm{eff}}$，使得总衰减与具有此光学厚度的单个均匀平板的衰减相同。通过这样一个平板的衰减将是：\n$$\nI_N = I_0 \\exp(-\\tau_{\\mathrm{eff}})\n$$\n通过将其与为 $N$ 段路径推导出的表达式进行比较，我们可以直接确定有效光学厚度：\n$$\nI_0 \\exp(-\\tau_{\\mathrm{eff}}) = I_0 \\exp\\left(-\\sum_{i=1}^{N} \\kappa_i \\Delta s_i\\right)\n$$\n因此，有效光学厚度是各个光学厚度的总和：\n$$\n\\tau_{\\mathrm{eff}} = \\sum_{i=1}^{N} \\kappa_i \\Delta s_i\n$$\n这个量是无量纲的，因为吸收系数（单位 $\\mathrm{m}^{-1}$）和路径长度（单位 $\\mathrm{m}$）的乘积得到一个无量纲数。\n\n现在，我们根据给定数据计算 $N=5$ 的特定情况下的 $\\tau_{\\mathrm{eff}}$。\n每个单元格的光学厚度计算为 $\\tau_i = \\kappa_i \\Delta s_i$。\n\n单元格1：$\\tau_1 = \\kappa_1 \\Delta s_1 = (0.8\\,\\mathrm{m}^{-1}) \\times (0.30\\,\\mathrm{m}) = 0.24$\n单元格2：$\\tau_2 = \\kappa_2 \\Delta s_2 = (2.3\\,\\mathrm{m}^{-1}) \\times (0.10\\,\\mathrm{m}) = 0.23$\n单元格3：$\\tau_3 = \\kappa_3 \\Delta s_3 = (0.5\\,\\mathrm{m}^{-1}) \\times (1.20\\,\\mathrm{m}) = 0.60$\n单元格4：$\\tau_4 = \\kappa_4 \\Delta s_4 = (1.1\\,\\mathrm{m}^{-1}) \\times (0.050\\,\\mathrm{m}) = 0.055$\n单元格5：$\\tau_5 = \\kappa_5 \\Delta s_5 = (0.050\\,\\mathrm{m}^{-1}) \\times (4.00\\,\\mathrm{m}) = 0.200$（为中间步骤保留乘法产生的有效数字）。\n\n有效光学厚度是这些单个值的总和：\n$$\n\\tau_{\\mathrm{eff}} = \\tau_1 + \\tau_2 + \\tau_3 + \\tau_4 + \\tau_5\n$$\n$$\n\\tau_{\\mathrm{eff}} = 0.24 + 0.23 + 0.60 + 0.055 + 0.200\n$$\n$$\n\\tau_{\\mathrm{eff}} = 1.325\n$$\n问题要求答案保留四位有效数字。计算值 $1.325$ 已有四位有效数字，因此无需进一步四舍五入。",
            "answer": "$$\n\\boxed{1.325}\n$$"
        },
        {
            "introduction": "开发可靠计算工具的最终环节是验证。本综合练习提供了一个典型的基准测试案例：一维平面平行板中的辐射传递。您需要首先推导该问题的解析解，然后编写一个 DTM 程序来数值求解该问题，并将数值结果与解析解进行比较。通过这个“代码验证”过程，您可以确认自己对 DTM 推进格式、边界条件和热流计算的实现是否正确，并观察随着网格和角度加密，数值解如何收敛于精确解 。",
            "id": "3990816",
            "problem": "考虑一个厚度为 $L$ 的一维平面平行板，其中包含无散射的灰体、等温、发射-吸收介质。吸收系数 $\\kappa$ 在空间上是均匀的，单位为 $\\mathrm{m^{-1}}$。介质温度为 $T_m$，单位为 $\\mathrm{K}$。位于 $x=0$ 和 $x=L$ 处的平板边界是绝对黑体（无反射），壁面温度分别为 $T_{w,0}$ 和 $T_{w,L}$，单位为 $\\mathrm{K}$。黑体辐射强度（单位立体角）被假设为灰体，由 $I_b(T) = \\sigma T^4/\\pi$ 给出，单位为 $\\mathrm{W\\,m^{-2}\\,sr^{-1}}$，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-4}}$。记 $\\theta$ 为相对于 $+x$ 轴的极角，以弧度为单位，$\\mu = \\cos\\theta$ 为方向余弦。\n\n从沿射线的​​基本辐射传输方程出发，\n$$\n\\frac{\\mathrm{d}I}{\\mathrm{d}s} = -\\kappa I + \\kappa I_b(T_m),\n$$\n利用在 $x=0$ 和 $x=L$ 处的黑体壁面的适当边界条件，推导在 $\\mu>0$ 和 $\\mu0$ 条件下辐射强度 $I(x,\\mu)$ 的解析表达式。从第一性原理出发，以半球角积分的形式推导辐射热通量 $q_r(x)$（单位为 $\\mathrm{W\\,m^{-2}}$）的表达式，\n$$\nq_r(x) = 2\\pi \\int_{-1}^{1} \\mu\\, I(x,\\mu)\\, \\mathrm{d}\\mu,\n$$\n该表达式用 $\\kappa$、$L$、$T_m$、$T_{w,0}$ 和 $T_{w,L}$ 表示。您的推导必须基于给定的方程、黑体表面的定义和 $I_b(T)$ 的定义，并且不得引入任何未声明的假设。\n\n然后，具体说明离散传输法（DTM）如何通过网格和角度加密来复现此解：\n- 将平板离散化为 $M$ 个宽度为 $\\Delta x = L/M$ 的均匀单元，并使用一维常微分方程在 $\\Delta x$ 上的精确齐次解，沿每个离散方向余弦 $\\mu_i \\in (0,1]$ 推进射线强度。\n- 使用 $N$ 个方向和权重 $\\{(\\mu_i,w_i)\\}_{i=1}^{N}$，通过在 $\\mu \\in [0,1]$ 上的求积来近似半球角积分，并应用前向（$\\mu0$）和后向（$\\mu0$）半球之间的对称性。\n- 证明当 $M\\to\\infty$ 和 $N\\to\\infty$ 时，DTM计算的 $q_r(x)$ 收敛于解析表达式。\n\n实现一个程序，对于下述每个测试用例，计算：\n- 平板中面 $x=L/2$ 处的解析辐射热通量，单位为 $\\mathrm{W\\,m^{-2}}$。\n- 使用粗糙离散 $(M_c,N_c)$ 时 DTM 预测的 $x=L/2$ 处的辐射热通量。\n- 使用精细离散 $(M_f,N_f)$ 时 DTM 预测的 $x=L/2$ 处的辐射热通量。\n- 粗糙和精细 DTM 通量相对于解析通量的相对误差，定义为\n$$\n\\varepsilon = \\frac{\\left|q_{\\text{DTM}} - q_{\\text{analytical}}\\right|}{\\max\\left(\\left|q_{\\text{analytical}}\\right|,\\ \\epsilon\\right)},\n$$\n其中 $\\epsilon = 10^{-12}$，单位为 $\\mathrm{W\\,m^{-2}}$。\n\n所有带有物理单位的量必须得到一致处理；通量必须以 $\\mathrm{W\\,m^{-2}}$ 为单位进行计算和内部表示。最终程序输出必须是单行，包含每个测试用例的误差对的逗号分隔列表，每个误差对表示为一个二元列表 $[\\varepsilon_{\\text{coarse}}, \\varepsilon_{\\text{refined}}]$。\n\n测试套件：\n- 案例 $1$（理想情况）：$\\kappa = 1.0\\,\\mathrm{m^{-1}}$，$L = 0.5\\,\\mathrm{m}$，$T_m = 1000\\,\\mathrm{K}$，$T_{w,0} = 1200\\,\\mathrm{K}$，$T_{w,L} = 800\\,\\mathrm{K}$，$(M_c,N_c) = (40,6)$，$(M_f,N_f) = (400,20)$。\n- 案例 $2$（辐射平衡边界）：$\\kappa = 5.0\\,\\mathrm{m^{-1}}$，$L = 0.2\\,\\mathrm{m}$，$T_m = 900\\,\\mathrm{K}$，$T_{w,0} = 900\\,\\mathrm{K}$，$T_{w,L} = 900\\,\\mathrm{K}$，$(M_c,N_c) = (40,6)$，$(M_f,N_f) = (400,20)$。此案例应在 $x=L/2$ 处产生接近零的解析通量。\n- 案例 $3$（光学薄）：$\\kappa = 0.01\\,\\mathrm{m^{-1}}$，$L = 2.0\\,\\mathrm{m}$，$T_m = 1000\\,\\mathrm{K}$，$T_{w,0} = 1000\\,\\mathrm{K}$，$T_{w,L} = 1100\\,\\mathrm{K}$，$(M_c,N_c) = (40,6)$，$(M_f,N_f) = (400,20)$。\n- 案例 $4$（光学厚）：$\\kappa = 20.0\\,\\mathrm{m^{-1}}$，$L = 0.1\\,\\mathrm{m}$，$T_m = 1000\\,\\mathrm{K}$，$T_{w,0} = 1400\\,\\mathrm{K}$，$T_{w,L} = 800\\,\\mathrm{K}$，$(M_c,N_c) = (40,6)$，$(M_f,N_f) = (400,20)$。\n\n最终输出格式：\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例产生一个由浮点数组成的二元列表 $[\\varepsilon_{\\text{coarse}}, \\varepsilon_{\\text{refined}}]$，例如 $[[e_{1c},e_{1f}],[e_{2c},e_{2f}],\\dots]$。",
            "solution": "我们从无散射的灰体、等温、发射-吸收介质中沿特征射线的基本辐射传输方程开始，\n$$\n\\frac{\\mathrm{d}I}{\\mathrm{d}s} = -\\kappa I + \\kappa I_b(T_m),\n$$\n其中 $I$ 是辐射强度，单位为 $\\mathrm{W\\,m^{-2}\\,sr^{-1}}$，$s$ 是沿射线的路径长度，单位为 $\\mathrm{m}$，$\\kappa$ 是吸收系数，单位为 $\\mathrm{m^{-1}}$，而 $I_b(T_m) = \\sigma T_m^4/\\pi$ 是介质的黑体辐射强度。$x=0$ 和 $x=L$ 处的边界是黑体；因此，从壁面进入介质的射线的边界条件为：\n- 在 $x=0$ 处，对于 $\\mu = \\cos\\theta  0$（在 $+x$ 方向传播）的射线，$I(0,\\mu) = I_b(T_{w,0})$。\n- 在 $x=L$ 处，对于 $\\mu = \\cos\\theta  0$（在 $-x$ 方向传播）的射线，$I(L,\\mu) = I_b(T_{w,L})$。\n\n对于一维平面平行几何，沿射线的坐标 $s$ 通过 $\\mathrm{d}s = \\mathrm{d}x / \\mu$（对于 $\\mu0$）和 $\\mathrm{d}s = -\\mathrm{d}x / |\\mu|$（对于 $\\mu0$）与空间坐标 $x$ 相关。该常微分方程具有常系数，并可用标准积分因子法求解。对于 $\\mu0$，考虑以 $x$ 为变量的常微分方程，\n$$\n\\mu\\, \\frac{\\mathrm{d}I(x,\\mu)}{\\mathrm{d}x} = -\\kappa I(x,\\mu) + \\kappa I_b(T_m).\n$$\n该线性方程的齐次解为 $\\exp(-\\kappa x/\\mu)$，特解为 $I(x,\\mu) = I_b(T_m)$。应用边界条件 $I(0,\\mu) = I_b(T_{w,0})$，对于 $\\mu0$ 的解为\n$$\nI(x,\\mu) = I_b(T_m) + \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right),\\quad \\mu0.\n$$\n类似地，对于 $\\mu0$，我们记 $|\\mu| = -\\mu$ 并从 $x=L$ 向较小的 $x$ 方向积分。方程变为\n$$\n|\\mu|\\, \\frac{\\mathrm{d}I(x,\\mu)}{\\mathrm{d}x} = \\kappa I_b(T_m) - \\kappa I(x,\\mu).\n$$\n应用 $I(L,\\mu) = I_b(T_{w,L})$，对于 $\\mu0$ 的解为\n$$\nI(x,\\mu) = I_b(T_m) + \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{|\\mu|}\\right),\\quad \\mu0.\n$$\n\n$x$ 方向的辐射热通量通过在整个球体上的角积分来定义；在平面平行对称性下，方位角积分产生一个因子 $2\\pi$，极角积分简化为 $\\mu \\in [-1,1]$，\n$$\nq_r(x) = 2\\pi \\int_{-1}^{1} \\mu\\, I(x,\\mu)\\, \\mathrm{d}\\mu.\n$$\n将积分拆分为前向（$\\mu0$）和后向（$\\mu0$）半球，对后向半球使用对称替换 $\\nu = |\\mu|$，并代入上述显式解：\n\\begin{align*}\nq_r(x) = 2\\pi \\left[ \\int_{0}^{1} \\mu\\, \\left(I_b(T_m) + \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right)\\right) \\mathrm{d}\\mu \\right. \\\\\n\\quad\\left. + \\int_{-1}^{0} \\mu\\, \\left(I_b(T_m) + \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{|\\mu|}\\right)\\right) \\mathrm{d}\\mu \\right].\n\\end{align*}\n在后向积分中，令 $\\nu = |\\mu| \\in (0,1]$，因此 $\\mu = -\\nu$ 且 $\\mathrm{d}\\mu = -\\mathrm{d}\\nu$，得到\n\\begin{align*}\nq_r(x) = 2\\pi \\left[ \\int_{0}^{1} \\mu\\, I_b(T_m)\\, \\mathrm{d}\\mu + \\big(I_b(T_{w,0}) - I_b(T_m)\\big) \\int_{0}^{1} \\mu\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right)\\, \\mathrm{d}\\mu \\right. \\\\\n\\quad \\left. - \\int_{0}^{1} \\nu\\, I_b(T_m)\\, \\mathrm{d}\\nu - \\big(I_b(T_{w,L}) - I_b(T_m)\\big) \\int_{0}^{1} \\nu\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{\\nu}\\right)\\, \\mathrm{d}\\nu \\right].\n\\end{align*}\n$\\int_{0}^{1} \\mu\\, I_b(T_m)\\,\\mathrm{d}\\mu$ 项完全抵消。在辐射传输的意义上，定义 n 阶指数积分，\n$$\nE_n(t) \\equiv \\int_{0}^{1} \\mu^{n-2}\\, \\exp\\!\\left(-\\frac{t}{\\mu}\\right)\\, \\mathrm{d}\\mu,\n$$\n通过变量替换 $u=t/\\mu$，它与由下式定义的广义指数积分 $\\mathrm{E}_n$ 相关\n$$\n\\mathrm{E}_n(t) \\equiv \\int_{1}^{\\infty} \\frac{e^{-t v}}{v^n}\\, \\mathrm{d}v.\n$$\n具体来说，\n$$\n\\int_{0}^{1} \\mu^{n-2}\\, \\exp\\!\\left(-\\frac{t}{\\mu}\\right)\\, \\mathrm{d}\\mu = \\mathrm{E}_n(t).\n$$\n对于 $n=3$，剩余的积分为 $E_3$，我们得到解析辐射通量\n$$\nq_r(x) = 2\\pi \\left[ \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\mathrm{E}_3(\\kappa x) - \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\big(\\kappa (L-x)\\big) \\right],\n$$\n其中 $\\mathrm{E}_3(0) = \\int_{1}^{\\infty} v^{-3}\\,\\mathrm{d}v = \\frac{1}{2}$，这与 $\\int_{0}^{1} \\mu\\, \\mathrm{d}\\mu = \\frac{1}{2}$ 一致。\n\n离散传输法（DTM）公式：\n- 空间离散化：将 $[0,L]$ 划分为 $M$ 个均匀单元，节点为 $x_j = j\\, \\Delta x$，其中 $j=0,1,\\dots,M$，$\\Delta x=L/M$。\n- 角度离散化：在 $[0,1]$ 上选择 $N$ 个求积节点和权重 $\\{(\\mu_i,w_i)\\}_{i=1}^{N}$（例如，映射到 $[0,1]$ 上的高斯-勒让德求积）来近似 $\\int_{0}^{1} g(\\mu)\\, \\mathrm{d}\\mu \\approx \\sum_{i=1}^{N} w_i g(\\mu_i)$。\n- 推进格式：对于每个 $\\mu_i0$，通过在 $\\Delta x$ 上带有常数源项的齐次常微分方程的精确单元解，将前向强度从 $x=0$ 传播到 $x=L$，\n$$\nI_{j+1}^{+}(\\mu_i) = I_{j}^{+}(\\mu_i)\\, \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right) + I_b(T_m)\\, \\left(1 - \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right)\\right),\n$$\n由黑体壁面边界条件 $I_{0}^{+}(\\mu_i) = I_b(T_{w,0})$ 初始化。对于每个 $\\mu_i0$，通过\n$$\nI_{j-1}^{-}(\\mu_i) = I_{j}^{-}(\\mu_i)\\, \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right) + I_b(T_m)\\, \\left(1 - \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right)\\right),\n$$\n将后向强度从 $x=L$ 传播到 $x=0$，由 $I_{M}^{-}(\\mu_i) = I_b(T_{w,L})$ 初始化。\n- 在节点 $x_j$ 处的通量计算：通过求积和对称性近似半球积分，\n$$\nq_r(x_j) \\approx 2\\pi \\left[ \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{+}(\\mu_i)\\ - \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{-}(\\mu_i) \\right].\n$$\n\n收敛性：\n- 当 $M\\to\\infty$ 时，由于离散推进对每个常系数常微分方程单元使用精确解，因此带有精确单元衰减/发射的离散推进可以为每条射线复现连续解；因此减小 $\\Delta x$ 可以提高在计算位置采样 $I(x,\\mu)$ 的分辨率。\n- 当 $N\\to\\infty$ 且使用多项式精确的求积法（例如，高斯-勒让德求积）时，对于光滑函数 $f(\\mu)$，$\\int_{0}^{1} \\mu\\, f(\\mu)\\, \\mathrm{d}\\mu$ 的求积近似会快速收敛到真实积分值。这一点成立是因为对于有限的 $\\kappa x$，$I(x,\\mu)$ 中的指数项在 $\\mu$ 属于 $(0,1]$ 区间上是解析的。\n\n误差度量：\n我们使用以 $\\mathrm{E}_3(\\cdot)$ 表示的推导表达式计算解析通量 $q_{\\text{analytical}}(L/2)$，并使用离散推进和求积法计算 DTM 通量 $q_{\\text{DTM}}(L/2)$。相对误差为\n$$\n\\varepsilon = \\frac{\\left|q_{\\text{DTM}} - q_{\\text{analytical}}\\right|}{\\max\\left(\\left|q_{\\text{analytical}}\\right|,\\ \\epsilon\\right)},\n$$\n其中 $\\epsilon = 10^{-12}\\,\\mathrm{W\\,m^{-2}}$ 用于在平衡情况下避免除以零。\n\n为每个测试用例在代码中实现的算法步骤：\n- 计算 $T = T_m, T_{w,0}, T_{w,L}$ 时的 $I_b(T) = \\sigma T^4/\\pi$。\n- $x=L/2$ 处的解析通量：计算\n$$\nq_r\\!\\left(\\frac{L}{2}\\right) = 2\\pi \\left[ \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right) - \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right) \\right],\n$$\n可简化为\n$$\nq_r\\!\\left(\\frac{L}{2}\\right) = 2\\pi\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right)\\, \\left(I_b(T_{w,0}) - I_b(T_{w,L})\\right).\n$$\n在数值上，使用恒等式 $\\int_{0}^{1} \\mu^{n-2} e^{-t/\\mu}\\, \\mathrm{d}\\mu = \\mathrm{E}_n(t)$（其中 $n=3$），通过广义指数积分 $\\mathrm{E}_n(t)$ 计算 $\\mathrm{E}_3(t)$。\n- $x=L/2$ 处的 DTM 通量：在 $[0,1]$ 上构建 $N$ 点高斯-勒让德节点和权重（从 $[-1,1]$ 映射），将 $I^{+}$ 从 $x=0$ 和 $I^{-}$ 从 $x=L$ 跨越 $M$ 个单元进行推进，然后计算\n$$\nq_r^{\\text{DTM}}\\!\\left(\\frac{L}{2}\\right) \\approx 2\\pi \\left[ \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{+}(\\mu_i)\\ - \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{-}(\\mu_i) \\right],\n$$\n其中 $j = M/2$（假设 $M$ 为偶数）。\n- 计算粗糙 $(M_c,N_c)$ 和精细 $(M_f,N_f)$ 离散化下的相对误差。\n- 按规定将所有案例的误差对汇总到单行输出中。\n\n物理和数值一致性：\n- 所有通量均使用 $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$ 计算，单位为 $\\mathrm{W\\,m^{-2}}$。\n- 角度仅通过 $\\mu = \\cos\\theta$ 来引用，其中 $\\theta$ 以弧度为单位；不使用显式的角度值。\n- 该测试套件检验了理想情况、辐射平衡边界条件（预期通量接近零）、光学薄平板（$\\kappa L$ 较小）和光学厚平板（$\\kappa L$ 较大）的情况，覆盖了不同的衰减和发射区域。\n\n在网格加密（$M_c \\to M_f$）和角度加密（$N_c \\to N_f$）的情况下，DTM 通量收敛于解析通量，这反映在程序返回的 $\\varepsilon$ 值减小上。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import expn\n\n# Constants\nSIGMA = 5.670374419e-8  # Stefan-Boltzmann constant [W/(m^2 K^4)]\nPI = np.pi\nTOL_DEN = 1e-12  # [W/m^2] for stabilizing relative error in near-zero flux cases\n\ndef blackbody_intensity(T):\n    \"\"\"Blackbody specific intensity per unit solid angle, gray approximation.\"\"\"\n    return SIGMA * T**4 / PI  # [W/(m^2 sr)]\n\ndef analytic_flux_mid(kappa, L, Tm, Tw0, TwL):\n    \"\"\"\n    Analytical radiative heat flux at x = L/2 [W/m^2] for a gray, isothermal slab with black boundaries.\n    q_r(L/2) = 2*pi * E3(kappa*L/2) * (Ib(Tw0) - Ib(TwL))\n    where E3 is the generalized exponential integral expn(3, x).\n    \"\"\"\n    t = kappa * (L / 2.0)\n    E3 = float(expn(3, t))\n    Ibw0 = blackbody_intensity(Tw0)\n    IbwL = blackbody_intensity(TwL)\n    return 2.0 * PI * E3 * (Ibw0 - IbwL)\n\ndef gauss_legendre_unit_interval(N):\n    \"\"\"\n    Gauss-Legendre quadrature nodes/weights on [0,1].\n    Returns arrays mu in (0,1) and weights w such that integral_0^1 f(mu) ~ sum w_i f(mu_i).\n    \"\"\"\n    # Nodes/weights on [-1,1]\n    x, w = np.polynomial.legendre.leggauss(N)\n    # Map to [0,1]: mu = (x+1)/2, w' = w/2\n    mu = 0.5 * (x + 1.0)\n    w_mapped = 0.5 * w\n    return mu, w_mapped\n\ndef dtm_flux_mid(kappa, L, Tm, Tw0, TwL, M, N):\n    \"\"\"\n    DTM-computed radiative heat flux at x = L/2 [W/m^2].\n    \"\"\"\n    # Discretization\n    dx = L / M\n    mid_index = M // 2  # assume M even\n    mu, w = gauss_legendre_unit_interval(N)\n\n    # Blackbody intensities\n    Ib_m = blackbody_intensity(Tm)\n    Ib_w0 = blackbody_intensity(Tw0)\n    Ib_wL = blackbody_intensity(TwL)\n\n    # Precompute attenuation factors per direction\n    # Avoid division by zero: mu strictly in (0,1] for Gauss-Legendre nodes (no endpoints)\n    att = np.exp(- (kappa * dx) / mu)  # shape (N,)\n    one_minus_att = 1.0 - att\n\n    # March forward intensities from x=0\n    I_plus = np.empty((M + 1, N), dtype=float)\n    I_plus[0, :] = Ib_w0\n    for j in range(M):\n        I_plus[j + 1, :] = I_plus[j, :] * att + Ib_m * one_minus_att\n\n    # March backward intensities from x=L\n    I_minus = np.empty((M + 1, N), dtype=float)\n    I_minus[M, :] = Ib_wL\n    for j in range(M, 0, -1):\n        I_minus[j - 1, :] = I_minus[j, :] * att + Ib_m * one_minus_att\n\n    # Flux at mid-plane node\n    # q = 2*pi [ sum w_i * mu_i * I_plus - sum w_i * mu_i * I_minus ]\n    term_plus = np.sum(w * mu * I_plus[mid_index, :])\n    term_minus = np.sum(w * mu * I_minus[mid_index, :])\n    q = 2.0 * PI * (term_plus - term_minus)\n    return float(q)\n\ndef relative_error(q_dtm, q_analytical):\n    denom = max(abs(q_analytical), TOL_DEN)\n    return abs(q_dtm - q_analytical) / denom\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (kappa [1/m], L [m], Tm [K], Tw0 [K], TwL [K], (Mc, Nc), (Mf, Nf))\n    test_cases = [\n        (1.0, 0.5, 1000.0, 1200.0, 800.0, (40, 6), (400, 20)),     # Case 1\n        (5.0, 0.2, 900.0, 900.0, 900.0, (40, 6), (400, 20)),       # Case 2\n        (0.01, 2.0, 1000.0, 1000.0, 1100.0, (40, 6), (400, 20)),   # Case 3\n        (20.0, 0.1, 1000.0, 1400.0, 800.0, (40, 6), (400, 20)),    # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        kappa, L, Tm, Tw0, TwL, (Mc, Nc), (Mf, Nf) = case\n        q_ana = analytic_flux_mid(kappa, L, Tm, Tw0, TwL)\n        q_dtm_coarse = dtm_flux_mid(kappa, L, Tm, Tw0, TwL, Mc, Nc)\n        q_dtm_fine = dtm_flux_mid(kappa, L, Tm, Tw0, TwL, Mf, Nf)\n        err_coarse = relative_error(q_dtm_coarse, q_ana)\n        err_fine = relative_error(q_dtm_fine, q_ana)\n        results.append([err_coarse, err_fine])\n\n    # Final print statement in the exact required format.\n    # Print a single line: list of error pairs for each test case.\n    def format_item(item):\n        if isinstance(item, list):\n            return \"[\" + \",\".join(f\"{x:.6e}\" if isinstance(x, float) else str(x) for x in item) + \"]\"\n        return str(item)\n\n    print(\"[\" + \",\".join(format_item(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}