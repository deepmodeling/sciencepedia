{
    "hands_on_practices": [
        {
            "introduction": "The Discrete Transfer Method (DTM) begins by discretizing the continuous directional space into a finite set of solid angles. This practice guides you through the essential process of deriving the quadrature weights, which represent the size of these angular bins, directly from the geometric definition of a solid angle. Mastering this derivation ensures that your numerical scheme correctly conserves radiative energy over the angular domain and allows you to create flexible angular grids tailored to specific problems .",
            "id": "3990862",
            "problem": "In the Discrete Transfer Method for Radiation (DTM), directional space is discretized on the unit sphere using the polar angle $\\theta \\in [0,\\pi]$ and the azimuthal angle $\\phi \\in [0,2\\pi]$ to form a set of nonoverlapping angular bins. Consider a polar-azimuthal discretization with $N_{\\theta}$ polar bins and $N_{\\phi}$ azimuthal bins. Let the polar edges be given by a strictly monotone mapping $\\mu(s)$ with $\\mu(0)=1$ and $\\mu(1)=-1$, where $s \\in [0,1]$ is a normalized index and $\\mu = \\cos(\\theta)$. The polar bin edges are defined by $\\mu_{k} = \\mu\\left(\\frac{k}{N_{\\theta}}\\right)$ for $k = 0,1,\\dots,N_{\\theta}$. Similarly, let the azimuthal edges be given by a strictly monotone mapping $\\phi(t)$ with $\\phi(0)=0$ and $\\phi(1)=2\\pi$, where $t \\in [0,1]$ is a normalized index. The azimuthal bin edges are defined by $\\phi_{m} = \\phi\\left(\\frac{m}{N_{\\phi}}\\right)$ for $m = 0,1,\\dots,N_{\\phi}$. This general construction permits either equal-solid-angle bins or nonuniform resolution concentrated in selected directions through appropriate choices of $\\mu(s)$ and $\\phi(t)$.\n\nDerive the quadrature weight $w_{k,m}$ assigned to the bin $(k,m)$, defined by the polar interval $[\\mu_{k},\\mu_{k-1}]$ and the azimuthal interval $[\\phi_{m-1},\\phi_{m}]$, such that the quadrature sum exactly integrates a constant directional field over the sphere. Your derivation must start from fundamental geometric definitions on the unit sphere and proceed rigorously to the final expression, showing how the choice of $\\mu(s)$ and $\\phi(t)$ preserves the total solid angle. Express your final weight formula in steradians and use radians for all angles. You must provide the weight $w_{k,m}$ as a single closed-form analytic expression in terms of $\\mu(\\cdot), \\phi(\\cdot), N_{\\theta}$, and $N_{\\phi}$. No numerical evaluation is required.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and self-contained. The definitions and constraints are consistent with standard practices in computational thermal engineering, specifically within the context of the Discrete Transfer Method for Radiation. No flaws were identified. We may therefore proceed with the derivation.\n\nThe objective is to derive the quadrature weight $w_{k,m}$ for an angular bin defined by the indices $(k,m)$. This weight represents the solid angle subtended by that bin. The derivation must start from the fundamental definition of a differential solid angle in spherical coordinates.\n\nIn a spherical coordinate system, the differential solid angle $d\\Omega$ is given by:\n$$\nd\\Omega = \\sin(\\theta) \\, d\\theta \\, d\\phi\n$$\nwhere $\\theta \\in [0,\\pi]$ is the polar angle and $\\phi \\in [0,2\\pi]$ is the azimuthal angle.\n\nThe problem defines the polar discretization in terms of the variable $\\mu = \\cos(\\theta)$. We perform a change of variables from $\\theta$ to $\\mu$. The differential of $\\mu$ is:\n$$\nd\\mu = \\frac{d}{d\\theta}(\\cos(\\theta)) \\, d\\theta = -\\sin(\\theta) \\, d\\theta\n$$\nFrom this, we can express $\\sin(\\theta) \\, d\\theta = -d\\mu$. Substituting this into the expression for the differential solid angle gives:\n$$\nd\\Omega = -d\\mu \\, d\\phi\n$$\nThe negative sign arises because as $\\theta$ increases from $0$ to $\\pi$, $\\mu$ decreases from $1$ to $-1$.\n\nThe quadrature weight $w_{k,m}$ is the solid angle of the bin $(k,m)$, which is obtained by integrating $d\\Omega$ over the angular extent of that bin. The bin is defined by the polar interval corresponding to $[\\mu_{k},\\mu_{k-1}]$ and the azimuthal interval $[\\phi_{m-1},\\phi_{m}]$. Let's first consider the integration over the corresponding polar angles, which range from $\\theta_{k-1}$ to $\\theta_{k}$ such that $\\mu_{k-1} = \\cos(\\theta_{k-1})$ and $\\mu_{k} = \\cos(\\theta_{k})$. Since $\\mu(s)$ is strictly monotone decreasing (from $\\mu(0)=1$ to $\\mu(1)=-1$), an increasing index $k$ corresponds to an increasing value of $\\theta$. Thus, the polar angle interval is $[\\theta_{k-1}, \\theta_{k}]$. The azimuthal interval is given directly as $[\\phi_{m-1}, \\phi_m]$.\n\nThe integral for the solid angle is:\n$$\nw_{k,m} = \\int_{\\phi_{m-1}}^{\\phi_m} \\int_{\\theta_{k-1}}^{\\theta_k} \\sin(\\theta) \\, d\\theta \\, d\\phi\n$$\nWe evaluate the inner integral with respect to $\\theta$:\n$$\n\\int_{\\theta_{k-1}}^{\\theta_k} \\sin(\\theta) \\, d\\theta = [-\\cos(\\theta)]_{\\theta_{k-1}}^{\\theta_k} = -\\cos(\\theta_k) - (-\\cos(\\theta_{k-1})) = \\cos(\\theta_{k-1}) - \\cos(\\theta_k)\n$$\nBy the definitions given in the problem, $\\mu_k = \\cos(\\theta_k)$ and $\\mu_{k-1} = \\cos(\\theta_{k-1})$. The result of the inner integral is therefore $\\mu_{k-1} - \\mu_k$. Since $\\mu$ is a decreasing function of the angle $\\theta$ (and of the index $k$), we have $\\mu_{k-1} > \\mu_k$, ensuring the result is positive.\n\nSubstituting this back into the expression for $w_{k,m}$:\n$$\nw_{k,m} = \\int_{\\phi_{m-1}}^{\\phi_m} (\\mu_{k-1} - \\mu_k) \\, d\\phi\n$$\nThe term $(\\mu_{k-1} - \\mu_k)$ is constant with respect to $\\phi$, so we can move it outside the integral:\n$$\nw_{k,m} = (\\mu_{k-1} - \\mu_k) \\int_{\\phi_{m-1}}^{\\phi_m} d\\phi\n$$\nEvaluating the remaining integral gives:\n$$\nw_{k,m} = (\\mu_{k-1} - \\mu_k) (\\phi_m - \\phi_{m-1})\n$$\nThis expression gives the solid angle for any bin $(k,m)$ in terms of the values at its edges.\n\nFinally, we substitute the specific definitions for the edge values, which are given by the mapping functions $\\mu(s)$ and $\\phi(t)$:\n$\\mu_{k} = \\mu\\left(\\frac{k}{N_{\\theta}}\\right)$\n$\\phi_{m} = \\phi\\left(\\frac{m}{N_{\\phi}}\\right)$\n\nSubstituting these into our expression for $w_{k,m}$ yields the final closed-form expression:\n$$\nw_{k,m} = \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]\n$$\nTo verify this result, we confirm that the sum of all quadrature weights equals the total solid angle of a sphere, $4\\pi$. The total sum is:\n$$\n\\sum_{k=1}^{N_{\\theta}} \\sum_{m=1}^{N_{\\phi}} w_{k,m} = \\sum_{k=1}^{N_{\\theta}} \\sum_{m=1}^{N_{\\phi}} \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]\n$$\nThis is a separable sum, which can be written as the product of two independent sums:\n$$\n\\left( \\sum_{k=1}^{N_{\\theta}} \\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\right) \\left( \\sum_{m=1}^{N_{\\phi}} \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right] \\right)\n$$\nBoth sums are telescoping. The first sum is:\n$$\n\\sum_{k=1}^{N_{\\theta}} \\left[ \\mu_{k-1} - \\mu_k \\right] = (\\mu_0 - \\mu_1) + (\\mu_1 - \\mu_2) + \\dots + (\\mu_{N_{\\theta}-1} - \\mu_{N_{\\theta}}) = \\mu_0 - \\mu_{N_{\\theta}}\n$$\nUsing the given boundary conditions, $\\mu_0 = \\mu(0) = 1$ and $\\mu_{N_{\\theta}} = \\mu(1) = -1$. The sum is $1 - (-1) = 2$.\n\nThe second sum is:\n$$\n\\sum_{m=1}^{N_{\\phi}} \\left[ \\phi_m - \\phi_{m-1} \\right] = (\\phi_1 - \\phi_0) + (\\phi_2 - \\phi_1) + \\dots + (\\phi_{N_{\\phi}} - \\phi_{N_{\\phi}-1}) = \\phi_{N_{\\phi}} - \\phi_0\n$$\nUsing the given boundary conditions, $\\phi_0 = \\phi(0) = 0$ and $\\phi_{N_{\\phi}} = \\phi(1) = 2\\pi$. The sum is $2\\pi - 0 = 2\\pi$.\n\nThe total sum of weights is the product of these two results: $2 \\times 2\\pi = 4\\pi$. This matches the total solid angle of a sphere, confirming that the quadrature rule exactly integrates a constant function over the sphere. The derived expression for $w_{k,m}$ is therefore correct.",
            "answer": "$$\n\\boxed{\\left[ \\mu\\left(\\frac{k-1}{N_{\\theta}}\\right) - \\mu\\left(\\frac{k}{N_{\\theta}}\\right) \\right] \\left[ \\phi\\left(\\frac{m}{N_{\\phi}}\\right) - \\phi\\left(\\frac{m-1}{N_{\\phi}}\\right) \\right]}\n$$"
        },
        {
            "introduction": "A key step in developing any computational code is to perform Verification and Validation (V&V), which involves comparing the numerical solution against a known analytical solution for a simplified benchmark problem. This practice provides a complete V&V workflow, from deriving the analytical solution for a 1D slab to implementing a DTM solver to test its convergence and accuracy. This exercise is invaluable for building confidence in a numerical implementation and understanding the sources of error in a simulation .",
            "id": "3990816",
            "problem": "Consider a one-dimensional plane-parallel slab of thickness $L$ containing a gray, isothermal, emitting-absorbing medium with no scattering. The absorption coefficient is spatially uniform and equal to $\\kappa$ in units of $\\mathrm{m^{-1}}$. The medium temperature is $T_m$ in $\\mathrm{K}$. The slab boundaries at $x=0$ and $x=L$ are perfectly black (no reflection), with wall temperatures $T_{w,0}$ and $T_{w,L}$ in $\\mathrm{K}$. The blackbody specific intensity (per unit solid angle) is assumed gray and given by $I_b(T) = \\sigma T^4/\\pi$ in $\\mathrm{W\\,m^{-2}\\,sr^{-1}}$, where $\\sigma$ is the Stefan–Boltzmann constant in $\\mathrm{W\\,m^{-2}\\,K^{-4}}$. Denote by $\\theta$ the polar angle relative to the $+x$ axis, measured in radians, and by $\\mu = \\cos\\theta$ the direction cosine.\n\nStarting from the fundamental radiative transfer equation along a ray,\n$$\n\\frac{\\mathrm{d}I}{\\mathrm{d}s} = -\\kappa I + \\kappa I_b(T_m),\n$$\nwith appropriate boundary conditions at $x=0$ and $x=L$ for a black wall, derive the analytical expression for the specific intensity $I(x,\\mu)$ for $\\mu>0$ and $\\mu<0$. From first principles, derive the expression for the radiative heat flux $q_r(x)$ in $\\mathrm{W\\,m^{-2}}$ as a hemispherical angular integral,\n$$\nq_r(x) = 2\\pi \\int_{-1}^{1} \\mu\\, I(x,\\mu)\\, \\mathrm{d}\\mu,\n$$\nexpressed in terms of $\\kappa$, $L$, $T_m$, $T_{w,0}$, and $T_{w,L}$. Your derivation must be grounded in the stated equation, the definition of a black surface, and the definition of $I_b(T)$, and must not introduce unstated assumptions.\n\nThen, specify how the Discrete Transfer Method (DTM) reproduces this solution under mesh and angular refinement by:\n- Discretizing the slab into $M$ uniform cells of width $\\Delta x = L/M$, and marching the ray intensity along each discrete direction cosine $\\mu_i \\in (0,1]$ using the exact homogeneous solution of the one-dimensional ordinary differential equation over $\\Delta x$.\n- Approximating the hemispherical angular integrals with a quadrature over $\\mu \\in [0,1]$ using $N$ directions and weights $\\{(\\mu_i,w_i)\\}_{i=1}^{N}$, applying symmetry between forward ($\\mu>0$) and backward ($\\mu<0$) hemispheres.\n- Demonstrating that as $M\\to\\infty$ and $N\\to\\infty$, the DTM-computed $q_r(x)$ converges to the analytical expression.\n\nImplement a program that, for each test case below, computes:\n- The analytical radiative heat flux at the slab mid-plane $x=L/2$ in $\\mathrm{W\\,m^{-2}}$.\n- The DTM-predicted radiative heat flux at $x=L/2$ using a coarse discretization $(M_c,N_c)$.\n- The DTM-predicted radiative heat flux at $x=L/2$ using a refined discretization $(M_f,N_f)$.\n- The relative errors of the coarse and refined DTM fluxes with respect to the analytical flux, defined as\n$$\n\\varepsilon = \\frac{\\left|q_{\\text{DTM}} - q_{\\text{analytical}}\\right|}{\\max\\left(\\left|q_{\\text{analytical}}\\right|,\\ \\epsilon\\right)},\n$$\nwhere $\\epsilon = 10^{-12}$ in $\\mathrm{W\\,m^{-2}}$.\n\nAll quantities with physical units must be handled consistently; the fluxes must be computed and internally represented in $\\mathrm{W\\,m^{-2}}$. The final program output must be a single line containing a comma-separated list of the error pairs for each test case, with each error pair presented as a two-element list $[\\varepsilon_{\\text{coarse}}, \\varepsilon_{\\text{refined}}]$.\n\nTest suite:\n- Case $1$ (happy path): $\\kappa = 1.0\\,\\mathrm{m^{-1}}$, $L = 0.5\\,\\mathrm{m}$, $T_m = 1000\\,\\mathrm{K}$, $T_{w,0} = 1200\\,\\mathrm{K}$, $T_{w,L} = 800\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$.\n- Case $2$ (radiative equilibrium boundary): $\\kappa = 5.0\\,\\mathrm{m^{-1}}$, $L = 0.2\\,\\mathrm{m}$, $T_m = 900\\,\\mathrm{K}$, $T_{w,0} = 900\\,\\mathrm{K}$, $T_{w,L} = 900\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$. This case should produce near-zero analytical flux at $x=L/2$.\n- Case $3$ (optically thin): $\\kappa = 0.01\\,\\mathrm{m^{-1}}$, $L = 2.0\\,\\mathrm{m}$, $T_m = 1000\\,\\mathrm{K}$, $T_{w,0} = 1000\\,\\mathrm{K}$, $T_{w,L} = 1100\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$.\n- Case $4$ (optically thick): $\\kappa = 20.0\\,\\mathrm{m^{-1}}$, $L = 0.1\\,\\mathrm{m}$, $T_m = 1000\\,\\mathrm{K}$, $T_{w,0} = 1400\\,\\mathrm{K}$, $T_{w,L} = 800\\,\\mathrm{K}$, $(M_c,N_c) = (40,6)$, $(M_f,N_f) = (400,20)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each test case yielding a two-element list of floats $[\\varepsilon_{\\text{coarse}}, \\varepsilon_{\\text{refined}}]$, for example, $[[e_{1c},e_{1f}],[e_{2c},e_{2f}],\\dots]$.",
            "solution": "We begin from the fundamental radiative transfer equation along a characteristic ray in a gray, isothermal, emitting-absorbing medium with no scattering,\n$$\n\\frac{\\mathrm{d}I}{\\mathrm{d}s} = -\\kappa I + \\kappa I_b(T_m),\n$$\nwhere $I$ is the specific intensity in $\\mathrm{W\\,m^{-2}\\,sr^{-1}}$, $s$ is the path length along the ray in $\\mathrm{m}$, $\\kappa$ is the absorption coefficient in $\\mathrm{m^{-1}}$, and $I_b(T_m) = \\sigma T_m^4/\\pi$ is the blackbody specific intensity of the medium. The boundaries at $x=0$ and $x=L$ are black; consequently, the boundary conditions for rays entering the medium from the walls are:\n- At $x=0$, for rays with $\\mu = \\cos\\theta > 0$ (propagating in the $+x$ direction), $I(0,\\mu) = I_b(T_{w,0})$.\n- At $x=L$, for rays with $\\mu = \\cos\\theta < 0$ (propagating in the $-x$ direction), $I(L,\\mu) = I_b(T_{w,L})$.\n\nFor one-dimensional plane-parallel geometry, the coordinate $s$ along a ray relates to the spatial coordinate $x$ via $\\mathrm{d}s = \\mathrm{d}x / \\mu$ for $\\mu>0$ and $\\mathrm{d}s = -\\mathrm{d}x / |\\mu|$ for $\\mu<0$. The ordinary differential equation has constant coefficients and admits a standard integrating factor solution. For $\\mu>0$, consider the ordinary differential equation in terms of $x$,\n$$\n\\mu\\, \\frac{\\mathrm{d}I(x,\\mu)}{\\mathrm{d}x} = -\\kappa I(x,\\mu) + \\kappa I_b(T_m).\n$$\nThis linear equation has the homogeneous solution $\\exp(-\\kappa x/\\mu)$ and the particular solution $I(x,\\mu) = I_b(T_m)$. Enforcing the boundary condition $I(0,\\mu) = I_b(T_{w,0})$, the solution for $\\mu>0$ is\n$$\nI(x,\\mu) = I_b(T_m) + \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right),\\quad \\mu>0.\n$$\nSimilarly, for $\\mu<0$, we write $|\\mu| = -\\mu$ and integrate from $x=L$ toward smaller $x$. The equation becomes\n$$\n|\\mu|\\, \\frac{\\mathrm{d}I(x,\\mu)}{\\mathrm{d}x} = \\kappa I_b(T_m) - \\kappa I(x,\\mu).\n$$\nEnforcing $I(L,\\mu) = I_b(T_{w,L})$, the solution for $\\mu<0$ is\n$$\nI(x,\\mu) = I_b(T_m) + \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{|\\mu|}\\right),\\quad \\mu<0.\n$$\n\nThe radiative heat flux in the $x$-direction is defined by angular integration over the full sphere; in plane-parallel symmetry, the azimuthal integration yields a factor $2\\pi$ and the polar integral reduces to $\\mu \\in [-1,1]$,\n$$\nq_r(x) = 2\\pi \\int_{-1}^{1} \\mu\\, I(x,\\mu)\\, \\mathrm{d}\\mu.\n$$\nSplit the integral into forward $(\\mu>0)$ and backward $(\\mu<0)$ hemispheres, using the symmetry substitution $\\nu = |\\mu|$ for the backward hemisphere, and the explicit solutions above:\n\\begin{align*}\nq_r(x) &= 2\\pi \\left[ \\int_{0}^{1} \\mu\\, \\left(I_b(T_m) + \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right)\\right) \\mathrm{d}\\mu \\right. \\\\\n&\\quad\\left. + \\int_{-1}^{0} \\mu\\, \\left(I_b(T_m) + \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{|\\mu|}\\right)\\right) \\mathrm{d}\\mu \\right].\n\\end{align*}\nIn the backward integral, let $\\nu = |\\mu| \\in (0,1]$ so that $\\mu = -\\nu$ and $\\mathrm{d}\\mu = -\\mathrm{d}\\nu$, yielding\n\\begin{align*}\nq_r(x) &= 2\\pi \\left[ \\int_{0}^{1} \\mu\\, I_b(T_m)\\, \\mathrm{d}\\mu + \\big(I_b(T_{w,0}) - I_b(T_m)\\big) \\int_{0}^{1} \\mu\\, \\exp\\!\\left(-\\frac{\\kappa x}{\\mu}\\right)\\, \\mathrm{d}\\mu \\right. \\\\\n&\\quad \\left. - \\int_{0}^{1} \\nu\\, I_b(T_m)\\, \\mathrm{d}\\nu - \\big(I_b(T_{w,L}) - I_b(T_m)\\big) \\int_{0}^{1} \\nu\\, \\exp\\!\\left(-\\frac{\\kappa (L-x)}{\\nu}\\right)\\, \\mathrm{d}\\nu \\right].\n\\end{align*}\nThe terms $\\int_{0}^{1} \\mu\\, I_b(T_m)\\,\\mathrm{d}\\mu$ cancel identically. Define the exponential integral of order $n$ in the radiative transfer sense,\n$$\nE_n(t) \\equiv \\int_{0}^{1} \\mu^{n-2}\\, \\exp\\!\\left(-\\frac{t}{\\mu}\\right)\\, \\mathrm{d}\\mu,\n$$\nwhich, by change of variables $u=t/\\mu$, is related to the generalized exponential integral $\\mathrm{E}_n$ defined by\n$$\n\\mathrm{E}_n(t) \\equiv \\int_{1}^{\\infty} \\frac{e^{-t v}}{v^n}\\, \\mathrm{d}v.\n$$\nSpecifically,\n$$\n\\int_{0}^{1} \\mu^{n-2}\\, \\exp\\!\\left(-\\frac{t}{\\mu}\\right)\\, \\mathrm{d}\\mu = \\mathrm{E}_n(t).\n$$\nFor $n=3$, the remaining integrals are $E_3$, and we obtain the analytical radiative flux\n$$\nq_r(x) = 2\\pi \\left[ \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\mathrm{E}_3(\\kappa x) - \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\big(\\kappa (L-x)\\big) \\right],\n$$\nwith $\\mathrm{E}_3(0) = \\int_{1}^{\\infty} v^{-3}\\,\\mathrm{d}v = \\frac{1}{2}$, consistent with $\\int_{0}^{1} \\mu\\, \\mathrm{d}\\mu = \\frac{1}{2}$.\n\nDiscrete Transfer Method (DTM) formulation:\n- Spatial discretization: partition $[0,L]$ into $M$ uniform cells, nodes $x_j = j\\, \\Delta x$ for $j=0,1,\\dots,M$, $\\Delta x=L/M$.\n- Angular discretization: choose $N$ quadrature nodes and weights $\\{(\\mu_i,w_i)\\}_{i=1}^{N}$ on $[0,1]$ (e.g., Gauss–Legendre mapped to $[0,1]$) to approximate $\\int_{0}^{1} g(\\mu)\\, \\mathrm{d}\\mu \\approx \\sum_{i=1}^{N} w_i g(\\mu_i)$.\n- Marching scheme: for each $\\mu_i>0$, propagate the forward intensity from $x=0$ to $x=L$ via the exact cellwise solution of the homogeneous ordinary differential equation with a constant source over $\\Delta x$,\n$$\nI_{j+1}^{+}(\\mu_i) = I_{j}^{+}(\\mu_i)\\, \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right) + I_b(T_m)\\, \\left(1 - \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right)\\right),\n$$\ninitialized by the black wall boundary condition $I_{0}^{+}(\\mu_i) = I_b(T_{w,0})$. For each $\\mu_i>0$, propagate the backward intensity from $x=L$ to $x=0$ via\n$$\nI_{j-1}^{-}(\\mu_i) = I_{j}^{-}(\\mu_i)\\, \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right) + I_b(T_m)\\, \\left(1 - \\exp\\!\\left(-\\frac{\\kappa \\Delta x}{\\mu_i}\\right)\\right),\n$$\ninitialized by $I_{M}^{-}(\\mu_i) = I_b(T_{w,L})$.\n- Flux evaluation at node $x_j$: approximate the hemispherical integral by quadrature and symmetry,\n$$\nq_r(x_j) \\approx 2\\pi \\left[ \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{+}(\\mu_i) - \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{-}(\\mu_i) \\right].\n$$\n\nConvergence:\n- As $M\\to\\infty$, the discrete marching with the exact per-cell attenuation/emission reproduces the continuous solution for each ray, since it uses the exact solution over each cell for a constant-coefficient ordinary differential equation; thus reducing $\\Delta x$ refines the resolution of sampling $I(x,\\mu)$ at the evaluation location.\n- As $N\\to\\infty$ and with a polynomially accurate quadrature (e.g., Gauss–Legendre), the quadrature approximation of $\\int_{0}^{1} \\mu\\, f(\\mu)\\, \\mathrm{d}\\mu$ converges rapidly to the true integral for smooth $f(\\mu)$, which holds because the exponentials in $I(x,\\mu)$ are analytic in $\\mu$ over $(0,1]$ for finite $\\kappa x$.\n\nError metric:\nWe compute the analytical flux $q_{\\text{analytical}}(L/2)$ using the derived expression in terms of $\\mathrm{E}_3(\\cdot)$ and the DTM flux $q_{\\text{DTM}}(L/2)$ using the discrete marching and quadrature. The relative error is\n$$\n\\varepsilon = \\frac{\\left|q_{\\text{DTM}} - q_{\\text{analytical}}\\right|}{\\max\\left(\\left|q_{\\text{analytical}}\\right|,\\ \\epsilon\\right)},\n$$\nwith $\\epsilon = 10^{-12}\\,\\mathrm{W\\,m^{-2}}$ to avoid division by zero in equilibrium cases.\n\nAlgorithmic steps implemented in code for each test case:\n- Compute $I_b(T) = \\sigma T^4/\\pi$ for $T = T_m, T_{w,0}, T_{w,L}$.\n- Analytical flux at $x=L/2$: evaluate\n$$\nq_r\\!\\left(\\frac{L}{2}\\right) = 2\\pi \\left[ \\big(I_b(T_{w,0}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right) - \\big(I_b(T_{w,L}) - I_b(T_m)\\big)\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right) \\right],\n$$\nwhich simplifies to\n$$\nq_r\\!\\left(\\frac{L}{2}\\right) = 2\\pi\\, \\mathrm{E}_3\\!\\left(\\kappa \\frac{L}{2}\\right)\\, \\left(I_b(T_{w,0}) - I_b(T_{w,L})\\right).\n$$\nNumerically, $\\mathrm{E}_3(t)$ is evaluated via the generalized exponential integral $\\mathrm{E}_n(t)$ using the identity $\\int_{0}^{1} \\mu^{n-2} e^{-t/\\mu}\\, \\mathrm{d}\\mu = \\mathrm{E}_n(t)$ with $n=3$.\n- DTM flux at $x=L/2$: construct $N$-point Gauss–Legendre nodes and weights on $[0,1]$ (map from $[-1,1]$), march $I^{+}$ from $x=0$ and $I^{-}$ from $x=L$ across $M$ cells, then evaluate\n$$\nq_r^{\\text{DTM}}\\!\\left(\\frac{L}{2}\\right) \\approx 2\\pi \\left[ \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{+}(\\mu_i) - \\sum_{i=1}^{N} w_i\\, \\mu_i\\, I_{j}^{-}(\\mu_i) \\right],\n$$\nwith $j = M/2$ (assuming $M$ even).\n- Compute the relative errors for coarse $(M_c,N_c)$ and refined $(M_f,N_f)$ discretizations.\n- Aggregate the error pairs for all cases in a single output line as specified.\n\nPhysical and numerical consistency:\n- All fluxes are computed in $\\mathrm{W\\,m^{-2}}$ using $\\sigma = 5.670374419\\times 10^{-8}\\,\\mathrm{W\\,m^{-2}\\,K^{-4}}$.\n- Angles are referenced only through $\\mu = \\cos\\theta$ with $\\theta$ measured in radians; no explicit angle values are used.\n- The test suite probes a happy path, a radiative equilibrium boundary condition (expected near-zero flux), an optically thin slab (small $\\kappa L$), and an optically thick slab (larger $\\kappa L$), covering distinct regimes of attenuation and emission.\n\nUnder mesh refinement ($M_c \\to M_f$) and angular refinement ($N_c \\to N_f$), the DTM flux converges toward the analytical flux, which is reflected in decreasing $\\varepsilon$ values returned by the program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import expn\n\n# Constants\nSIGMA = 5.670374419e-8  # Stefan-Boltzmann constant [W/(m^2 K^4)]\nPI = np.pi\nTOL_DEN = 1e-12  # [W/m^2] for stabilizing relative error in near-zero flux cases\n\ndef blackbody_intensity(T):\n    \"\"\"Blackbody specific intensity per unit solid angle, gray approximation.\"\"\"\n    return SIGMA * T**4 / PI  # [W/(m^2 sr)]\n\ndef analytic_flux_mid(kappa, L, Tm, Tw0, TwL):\n    \"\"\"\n    Analytical radiative heat flux at x = L/2 [W/m^2] for a gray, isothermal slab with black boundaries.\n    q_r(L/2) = 2*pi * E3(kappa*L/2) * (Ib(Tw0) - Ib(TwL))\n    where E3 is the generalized exponential integral expn(3, x).\n    \"\"\"\n    t = kappa * (L / 2.0)\n    E3 = float(expn(3, t))\n    Ibw0 = blackbody_intensity(Tw0)\n    IbwL = blackbody_intensity(TwL)\n    return 2.0 * PI * E3 * (Ibw0 - IbwL)\n\ndef gauss_legendre_unit_interval(N):\n    \"\"\"\n    Gauss-Legendre quadrature nodes/weights on [0,1].\n    Returns arrays mu in (0,1) and weights w such that integral_0^1 f(mu) ~ sum w_i f(mu_i).\n    \"\"\"\n    # Nodes/weights on [-1,1]\n    x, w = np.polynomial.legendre.leggauss(N)\n    # Map to [0,1]: mu = (x+1)/2, w' = w/2\n    mu = 0.5 * (x + 1.0)\n    w_mapped = 0.5 * w\n    return mu, w_mapped\n\ndef dtm_flux_mid(kappa, L, Tm, Tw0, TwL, M, N):\n    \"\"\"\n    DTM-computed radiative heat flux at x = L/2 [W/m^2].\n    \"\"\"\n    # Discretization\n    dx = L / M\n    mid_index = M // 2  # assume M even\n    mu, w = gauss_legendre_unit_interval(N)\n\n    # Blackbody intensities\n    Ib_m = blackbody_intensity(Tm)\n    Ib_w0 = blackbody_intensity(Tw0)\n    Ib_wL = blackbody_intensity(TwL)\n\n    # Precompute attenuation factors per direction\n    # Avoid division by zero: mu strictly in (0,1] for Gauss-Legendre nodes (no endpoints)\n    att = np.exp(- (kappa * dx) / mu)  # shape (N,)\n    one_minus_att = 1.0 - att\n\n    # March forward intensities from x=0\n    I_plus = np.empty((M + 1, N), dtype=float)\n    I_plus[0, :] = Ib_w0\n    for j in range(M):\n        I_plus[j + 1, :] = I_plus[j, :] * att + Ib_m * one_minus_att\n\n    # March backward intensities from x=L\n    I_minus = np.empty((M + 1, N), dtype=float)\n    I_minus[M, :] = Ib_wL\n    for j in range(M, 0, -1):\n        I_minus[j - 1, :] = I_minus[j, :] * att + Ib_m * one_minus_att\n\n    # Flux at mid-plane node\n    # q = 2*pi [ sum w_i * mu_i * I_plus - sum w_i * mu_i * I_minus ]\n    term_plus = np.sum(w * mu * I_plus[mid_index, :])\n    term_minus = np.sum(w * mu * I_minus[mid_index, :])\n    q = 2.0 * PI * (term_plus - term_minus)\n    return float(q)\n\ndef relative_error(q_dtm, q_analytical):\n    denom = max(abs(q_analytical), TOL_DEN)\n    return abs(q_dtm - q_analytical) / denom\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (kappa [1/m], L [m], Tm [K], Tw0 [K], TwL [K], (Mc, Nc), (Mf, Nf))\n    test_cases = [\n        (1.0, 0.5, 1000.0, 1200.0, 800.0, (40, 6), (400, 20)),     # Case 1\n        (5.0, 0.2, 900.0, 900.0, 900.0, (40, 6), (400, 20)),       # Case 2\n        (0.01, 2.0, 1000.0, 1000.0, 1100.0, (40, 6), (400, 20)),   # Case 3\n        (20.0, 0.1, 1000.0, 1400.0, 800.0, (40, 6), (400, 20)),    # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        kappa, L, Tm, Tw0, TwL, (Mc, Nc), (Mf, Nf) = case\n        q_ana = analytic_flux_mid(kappa, L, Tm, Tw0, TwL)\n        q_dtm_coarse = dtm_flux_mid(kappa, L, Tm, Tw0, TwL, Mc, Nc)\n        q_dtm_fine = dtm_flux_mid(kappa, L, Tm, Tw0, TwL, Mf, Nf)\n        err_coarse = relative_error(q_dtm_coarse, q_ana)\n        err_fine = relative_error(q_dtm_fine, q_ana)\n        results.append([err_coarse, err_fine])\n\n    # Final print statement in the exact required format.\n    # Print a single line: list of error pairs for each test case.\n    def format_item(item):\n        if isinstance(item, list):\n            return \"[\" + \",\".join(f\"{x:.6e}\" if isinstance(x, float) else str(x) for x in item) + \"]\"\n        return str(item)\n\n    print(\"[\" + \",\".join(format_item(r) for r in results) + \"]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A fundamental law of physics is the conservation of energy, and any valid numerical simulation must honor this law to within a reasonable tolerance. This exercise provides hands-on experience in creating a critical diagnostic tool to check for global energy conservation in a DTM simulation. By comparing the total energy emitted by sources to the total energy accounted for in sinks, this practice reinforces the importance of robust bookkeeping and error checking in computational engineering .",
            "id": "3990885",
            "problem": "You are tasked with designing and implementing a diagnostic for the Discrete Transfer Method (DTM) in radiation heat transfer that verifies global radiative energy conservation by comparing the total emission tallied from traced rays to the sum of all accounted sinks. The diagnostic must compute a residual and determine whether the simulation satisfies an acceptable threshold relative to total emission. The problem must be solved by writing a complete, runnable program as specified.\n\nAssume a steady-state, grey, participating medium in a bounded domain, with rays traced to model radiative exchange. The fundamental base is energy conservation derived from the Radiative Transfer Equation (RTE): when integrated over the entire domain and all directions, the total radiative power emitted equals the sum of all accounted sinks, namely, volumetric absorption in the medium, absorption at surfaces, and net energy that exits the computational domain through open boundaries. Let the following definitions apply:\n\n- Let $E_{\\mathrm{emit}}$ denote the total radiative power emitted by all volume and surface sources tallied via rays, in units of Watts (W).\n- Let the collection of nonnegative sink tallies $\\{S_j\\}$ include volumetric absorption, surface absorption, and net escape from boundaries, each in Watts (W). Let $E_{\\mathrm{acc}} = \\sum_j S_j$ be the total accounted sink power.\n- Define the global energy conservation residual $R$ as the signed difference between emission and accounted sinks:\n$$\nR = E_{\\mathrm{emit}} - E_{\\mathrm{acc}}.\n$$\n- Define a normalized diagnostic metric $\\rho$ to assess acceptability:\n  - If $E_{\\mathrm{emit}} > 0$, use the relative metric\n  $$\n  \\rho = \\frac{|R|}{E_{\\mathrm{emit}}}.\n  $$\n  - If $E_{\\mathrm{emit}} = 0$, use an absolute tolerance $\\varepsilon_{\\mathrm{abs}} > 0$ (in W) and define\n  $$\n  \\rho = \\frac{|R|}{\\varepsilon_{\\mathrm{abs}}}.\n  $$\n- The case passes the diagnostic if:\n  - For $E_{\\mathrm{emit}} > 0$, the inequality $|R|/E_{\\mathrm{emit}} \\le \\tau_{\\mathrm{rel}}$ holds, where $\\tau_{\\mathrm{rel}}$ is a specified nonnegative dimensionless threshold.\n  - For $E_{\\mathrm{emit}} = 0$, the inequality $|R| \\le \\varepsilon_{\\mathrm{abs}}$ holds.\n\nYour program must implement the above logic. All radiative powers must be expressed in Watts (W). All thresholds must be nonnegative. Your implementation must be purely numerical, without any reliance on hidden simulation data: treat the provided tallies as complete.\n\nImplement the diagnostic for the following test suite. Each test case provides a tuple $(E_{\\mathrm{emit}}, \\{S_j\\}, \\tau_{\\mathrm{rel}}, \\varepsilon_{\\mathrm{abs}})$:\n\n- Case 1 (balanced, stringent tolerance): $E_{\\mathrm{emit}} = 1000$, $\\{S_j\\} = [600, 300, 100]$, $\\tau_{\\mathrm{rel}} = 10^{-12}$, $\\varepsilon_{\\mathrm{abs}} = 10^{-9}$.\n- Case 2 (small imbalance, acceptable): $E_{\\mathrm{emit}} = 1000$, $\\{S_j\\} = [600, 395]$, $\\tau_{\\mathrm{rel}} = 10^{-2}$, $\\varepsilon_{\\mathrm{abs}} = 10^{-9}$.\n- Case 3 (on the threshold): $E_{\\mathrm{emit}} = 2500$, $\\{S_j\\} = [1200, 1275]$, $\\tau_{\\mathrm{rel}} = 10^{-2}$, $\\varepsilon_{\\mathrm{abs}} = 10^{-9}$.\n- Case 4 (beyond threshold): $E_{\\mathrm{emit}} = 800$, $\\{S_j\\} = [500, 290.3]$, $\\tau_{\\mathrm{rel}} = 10^{-2}$, $\\varepsilon_{\\mathrm{abs}} = 10^{-9}$.\n- Case 5 (zero emission, consistent): $E_{\\mathrm{emit}} = 0$, $\\{S_j\\} = [0]$, $\\tau_{\\mathrm{rel}} = 10^{-2}$, $\\varepsilon_{\\mathrm{abs}} = 10^{-9}$.\n- Case 6 (zero emission, inconsistent): $E_{\\mathrm{emit}} = 0$, $\\{S_j\\} = [10^{-6}]$, $\\tau_{\\mathrm{rel}} = 10^{-2}$, $\\varepsilon_{\\mathrm{abs}} = 10^{-9}$.\n\nYour program must, for each case, compute and return:\n- the diagnostic metric $\\rho$ (dimensionless),\n- the boolean pass/fail result as defined above.\n\nFinal output format: Your program should produce a single line of output containing a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a two-element list containing the metric $\\rho$ and a boolean pass/fail result. For example, a valid output format for two cases would look like $[[0.0,\\mathrm{True}],[0.01,\\mathrm{False}]]$. Do not print any other text. Angles are not involved in this problem. All physical quantities of power must be understood to be in Watts (W), and the diagnostic metric is dimensionless. The acceptance thresholds $\\tau_{\\mathrm{rel}}$ and $\\varepsilon_{\\mathrm{abs}}$ are nonnegative, with $\\tau_{\\mathrm{rel}}$ dimensionless and $\\varepsilon_{\\mathrm{abs}}$ in Watts (W).",
            "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\nThe data, variables, definitions, and conditions provided are as follows:\n- The context is a diagnostic for the Discrete Transfer Method (DTM) in radiation heat transfer.\n- The physical setting is a steady-state, grey, participating medium in a bounded domain.\n- $E_{\\mathrm{emit}}$: total radiative power emitted by all volume and surface sources tallied via rays, in Watts (W).\n- $\\{S_j\\}$: a collection of nonnegative sink tallies (volumetric absorption, surface absorption, net escape from boundaries), each in Watts (W).\n- $E_{\\mathrm{acc}} = \\sum_j S_j$: total accounted sink power.\n- $R = E_{\\mathrm{emit}} - E_{\\mathrm{acc}}$: the global energy conservation residual.\n- The diagnostic metric $\\rho$ is defined as:\n    - If $E_{\\mathrm{emit}} > 0$, then $\\rho = \\frac{|R|}{E_{\\mathrm{emit}}}$.\n    - If $E_{\\mathrm{emit}} = 0$, then $\\rho = \\frac{|R|}{\\varepsilon_{\\mathrm{abs}}}$, where $\\varepsilon_{\\mathrm{abs}} > 0$ is an absolute tolerance in Watts (W).\n- The diagnostic passes if:\n    - For $E_{\\mathrm{emit}} > 0$, $|R|/E_{\\mathrm{emit}} \\le \\tau_{\\mathrm{rel}}$ holds, where $\\tau_{\\mathrm{rel}}$ is a specified nonnegative dimensionless threshold.\n    - For $E_{\\mathrm{emit}} = 0$, $|R| \\le \\varepsilon_{\\mathrm{abs}}$ holds.\n- Test Cases:\n    - Case 1: $(E_{\\mathrm{emit}} = 1000, \\{S_j\\} = [600, 300, 100], \\tau_{\\mathrm{rel}} = 10^{-12}, \\varepsilon_{\\mathrm{abs}} = 10^{-9})$\n    - Case 2: $(E_{\\mathrm{emit}} = 1000, \\{S_j\\} = [600, 395], \\tau_{\\mathrm{rel}} = 10^{-2}, \\varepsilon_{\\mathrm{abs}} = 10^{-9})$\n    - Case 3: $(E_{\\mathrm{emit}} = 2500, \\{S_j\\} = [1200, 1275], \\tau_{\\mathrm{rel}} = 10^{-2}, \\varepsilon_{\\mathrm{abs}} = 10^{-9})$\n    - Case 4: $(E_{\\mathrm{emit}} = 800, \\{S_j\\} = [500, 290.3], \\tau_{\\mathrm{rel}} = 10^{-2}, \\varepsilon_{\\mathrm{abs}} = 10^{-9})$\n    - Case 5: $(E_{\\mathrm{emit}} = 0, \\{S_j\\} = [0], \\tau_{\\mathrm{rel}} = 10^{-2}, \\varepsilon_{\\mathrm{abs}} = 10^{-9})$\n    - Case 6: $(E_{\\mathrm{emit}} = 0, \\{S_j\\} = [10^{-6}], \\tau_{\\mathrm{rel}} = 10^{-2}, \\varepsilon_{\\mathrm{abs}} = 10^{-9})$\n- Required output per case: a two-element list containing the metric $\\rho$ and a boolean pass/fail result.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The problem is based on the fundamental principle of energy conservation as applied to radiative heat transfer, a cornerstone of thermal engineering. The diagnostic, which verifies that the sum of energy sources equals the sum of energy sinks, is a standard and essential procedure for validating numerical simulations based on conservation laws, such as those solving the Radiative Transfer Equation (RTE). The problem is scientifically sound.\n- **Well-Posed**: The problem provides explicit mathematical definitions for all computed quantities ($E_{\\mathrm{acc}}$, $R$, $\\rho$) and unambiguous criteria for determining the pass/fail status. For each test case, all necessary inputs are provided, ensuring that a unique solution can be determined. The logic is self-contained and complete.\n- **Objective**: The problem is stated using precise, formal language. All quantities are defined mathematically, and the acceptance criteria are objective inequalities. There are no subjective or ambiguous statements.\n\nThe problem does not exhibit any of the enumerated flaws (Scientific Unsoundness, Non-Formalizable, Incomplete Setup, Unrealistic, Ill-Posed, Pseudo-Profound, or Unverifiable).\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe solution requires the implementation of a diagnostic procedure based on the principle of global energy conservation for a radiative system. For a system in steady state, the total power emitted must equal the total power removed through various sink mechanisms. The Discrete Transfer Method (DTM), being a numerical approximation, may introduce small discrepancies. This diagnostic quantifies such discrepancies and compares them against predefined tolerances.\n\nThe algorithm to be implemented for each test case $(E_{\\mathrm{emit}}, \\{S_j\\}, \\tau_{\\mathrm{rel}}, \\varepsilon_{\\mathrm{abs}})$ is as follows:\n\n1.  **Compute Total Sink Power**: The total accounted sink power, $E_{\\mathrm{acc}}$, is the summation of all individual sink tallies, $\\{S_j\\}$.\n    $$\n    E_{\\mathrm{acc}} = \\sum_j S_j\n    $$\n\n2.  **Compute Residual**: The energy imbalance, or residual $R$, is the difference between the total emitted power and the total accounted sink power.\n    $$\n    R = E_{\\mathrm{emit}} - E_{\\mathrm{acc}}\n    $$\n    A non-zero residual indicates a discrepancy in the numerical energy balance.\n\n3.  **Evaluate Diagnostic Metric and Pass/Fail Status**: The evaluation path is contingent on the value of $E_{\\mathrm{emit}}$.\n\n    - **Case A: $E_{\\mathrm{emit}} > 0$**\n      In this scenario, a relative error metric is appropriate. The diagnostic metric $\\rho$ is defined as the absolute value of the residual normalized by the total emission:\n      $$\n      \\rho = \\frac{|R|}{E_{\\mathrm{emit}}}\n      $$\n      The simulation passes the diagnostic if this relative error is within the specified relative tolerance $\\tau_{\\mathrm{rel}}$:\n      $$\n      \\text{pass} = (\\rho \\le \\tau_{\\mathrm{rel}})\n      $$\n\n    - **Case B: $E_{\\mathrm{emit}} = 0$**\n      When there is no emission, a relative metric is undefined. An absolute comparison is necessary. The diagnostic metric $\\rho$ is defined as the absolute residual normalized by a small, positive absolute tolerance $\\varepsilon_{\\mathrm{abs}}$:\n      $$\n      \\rho = \\frac{|R|}{\\varepsilon_{\\mathrm{abs}}}\n      $$\n      The condition for passing the diagnostic is that the absolute residual must be no larger than the absolute tolerance $\\varepsilon_{\\mathrm{abs}}$:\n      $$\n      \\text{pass} = (|R| \\le \\varepsilon_{\\mathrm{abs}})\n      $$\n      This condition is equivalent to requiring $\\rho \\le 1$.\n\nThe final output for each test case will be the pair $[\\rho, \\text{pass}]$. We now apply this logic to two demonstrative cases.\n\n**Example Calculation for Case 4:**\nGiven: $E_{\\mathrm{emit}} = 800$, $\\{S_j\\} = [500, 290.3]$, $\\tau_{\\mathrm{rel}} = 10^{-2}$, $\\varepsilon_{\\mathrm{abs}} = 10^{-9}$.\n1.  $E_{\\mathrm{acc}} = 500 + 290.3 = 790.3$.\n2.  $R = 800 - 790.3 = 9.7$.\n3.  Since $E_{\\mathrm{emit}} > 0$, we use the relative metric.\n    $\\rho = \\frac{|9.7|}{800} = 0.012125$.\n4.  The pass condition is $\\rho \\le \\tau_{\\mathrm{rel}}$. We check if $0.012125 \\le 10^{-2}$, which is $0.012125 \\le 0.01$. This is false.\n5.  Result: $[\\rho, \\text{pass}] = [0.012125, \\text{False}]$.\n\n**Example Calculation for Case 6:**\nGiven: $E_{\\mathrm{emit}} = 0$, $\\{S_j\\} = [10^{-6}]$, $\\tau_{\\mathrm{rel}} = 10^{-2}$, $\\varepsilon_{\\mathrm{abs}} = 10^{-9}$.\n1.  $E_{\\mathrm{acc}} = 10^{-6}$.\n2.  $R = 0 - 10^{-6} = -10^{-6}$.\n3.  Since $E_{\\mathrm{emit}} = 0$, we use the absolute tolerance framing.\n    $\\rho = \\frac{|-10^{-6}|}{\\varepsilon_{\\mathrm{abs}}} = \\frac{10^{-6}}{10^{-9}} = 1000$.\n4.  The pass condition is $|R| \\le \\varepsilon_{\\mathrm{abs}}$. We check if $|-10^{-6}| \\le 10^{-9}$, which is $10^{-6} \\le 10^{-9}$. This is false.\n5.  Result: $[\\rho, \\text{pass}] = [1000.0, \\text{False}]$.\n\nThe program will systemically apply this algorithm to all provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a diagnostic for the Discrete Transfer Method (DTM) to verify global\n    radiative energy conservation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E_emit, {S_j}, tau_rel, epsilon_abs)\n    test_cases = [\n        # Case 1 (balanced, stringent tolerance)\n        (1000.0, [600.0, 300.0, 100.0], 1e-12, 1e-9),\n        # Case 2 (small imbalance, acceptable)\n        (1000.0, [600.0, 395.0], 1e-2, 1e-9),\n        # Case 3 (on the threshold)\n        (2500.0, [1200.0, 1275.0], 1e-2, 1e-9),\n        # Case 4 (beyond threshold)\n        (800.0, [500.0, 290.3], 1e-2, 1e-9),\n        # Case 5 (zero emission, consistent)\n        (0.0, [0.0], 1e-2, 1e-9),\n        # Case 6 (zero emission, inconsistent)\n        (0.0, [1e-6], 1e-2, 1e-9),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_emit, S_j, tau_rel, epsilon_abs = case\n\n        # Step 1: Compute Total Sink Power\n        E_acc = np.sum(S_j)\n\n        # Step 2: Compute Residual\n        R = E_emit - E_acc\n        abs_R = np.abs(R)\n\n        # Step 3: Evaluate Diagnostic Metric and Pass/Fail Status\n        passed = False\n        if E_emit > 0:\n            # Case A: E_emit > 0, use relative tolerance\n            rho = abs_R / E_emit\n            if rho = tau_rel:\n                passed = True\n        else: # E_emit == 0\n            # Case B: E_emit = 0, use absolute tolerance\n            # The problem defines rho = |R|/epsilon_abs for this case.\n            # Handle potential division by zero if epsilon_abs could be zero,\n            # though problem states it's > 0.\n            if epsilon_abs > 0:\n                rho = abs_R / epsilon_abs\n            else:\n                # Fallback for ill-defined tolerance, though not expected here.\n                # If abs_R is also zero, it's balanced. Otherwise, it's an error.\n                rho = 0.0 if abs_R == 0.0 else float('inf')\n\n            # The pass condition is |R| = epsilon_abs\n            if abs_R = epsilon_abs:\n                passed = True\n\n        results.append([rho, passed])\n\n    # Format the final output string to match the exact requirement:\n    # e.g., [[0.0,True],[0.01,False]] without spaces after commas inside the inner list.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}