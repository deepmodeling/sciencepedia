{
    "hands_on_practices": [
        {
            "introduction": "掌握角系数的计算是辐射换热分析的基石。本练习将通过一个经典的同轴圆柱体几何结构，引导你从第一性原理出发，应用角系数的求和法则与倒易关系。通过这个实践，你将巩固对简单双表面闭集腔内辐射能交换基本规律的理解。",
            "id": "3981152",
            "problem": "考虑两个位于非参与介质中的无限长同心圆柱体，其中半径为 $r_1$ 的小圆柱体位于内半径为 $r_2$ 的大圆柱体内部，且 $0  r_1  r_2$。令两个圆柱体具有相同的长度 $L$ 并且完全同轴，并通过取极限 $L \\to \\infty$ 来忽略末端效应，从而只有侧面对辐射交换有贡献。令表面 $1$ 为内圆柱体的外侧面（面积为 $A_1$），表面 $2$ 为外圆柱体的内侧面（面积为 $A_2$）。假设两个表面都是不透明、漫-灰、等温的发射体，并且它们之间的空间是真空（没有散射或吸收的非参与介质）。\n\n从辐射角系数 $F_{ij}$ 的定义出发，即表面 $i$ 的总半球漫射发射中被表面 $j$ 拦截的分数，该定义由在两个表面上的双重面积分给出，并由兰伯特余弦因子和分离距离的平方反比加权（无视线阻碍），并根据能量守恒原理（其蕴含了角系数的互易性和求和规则），推导该几何形状的 $F_{12}$。然后，通过应用互易关系，用 $r_1$ 和 $r_2$ 表示 $F_{21}$，并使用侧面积 $A_1 = 2\\pi r_1 L$ 和 $A_2 = 2\\pi r_2 L$ 确认一致性条件 $A_1 F_{12} = A_2 F_{21}$。\n\n将 $F_{12}$ 的最终答案报告为单个无量纲实数。无需四舍五入。用 $r_1$、$r_2$ 和 $L$ 表示任何中间的符号关系。",
            "solution": "该问题要求推导两个无限长同心圆柱体之间的角系数 $F_{12}$，并随后使用互易关系推导 $F_{21}$。\n\n首先，我们必须验证问题陈述。\n所有数据、变量和条件提取如下：\n- 几何形状：两个无限长的同心圆柱体。\n- 内圆柱体半径：$r_1$。\n- 外圆柱体内半径：$r_2$。\n- 约束条件：$0  r_1  r_2$。\n- 共同长度：$L$，取极限 $L \\to \\infty$ 以忽略末端效应。\n- 表面 1：内圆柱体的外侧面，面积 $A_1 = 2\\pi r_1 L$。\n- 表面 2：外圆柱体的内侧面，面积 $A_2 = 2\\pi r_2 L$。\n- 表面性质：不透明、漫-灰、等温。\n- 介质：真空（非参与）。\n- 使用的原理：角系数 $F_{ij}$ 的定义、互易性 ($A_i F_{ij} = A_j F_{ji}$) 以及封闭体的求和规则 ($\\sum_j F_{ij} = 1$)。\n- 任务：推导 $F_{12}$，然后使用互易性求出 $F_{21}$ 并确认一致性。报告 $F_{12}$ 的数值。\n\n该问题具有科学依据，因为它涉及辐射传热中的标准概念。它是一个适定问题，具有明确定义的几何形状和充分的假设，可以得出唯一的解。语言客观而精确。问题是自洽的，没有矛盾。无限长度的理想化是工程分析中标准且有效的简化。因此，该问题被认为是有效的，并将提供解答。\n\n令表面 1 为内圆柱体的外表面，表面 2 为外圆柱体的内表面。由于圆柱体是无限长的，它们构成一个双表面封闭体。角系数的求和规则，即漫射发射体能量守恒的陈述，指出对于封闭体中的任何表面 $i$，从表面 $i$ 到封闭体中所有其他表面 $j$（包括其自身）的角系数之和必须为 1。\n$$\n\\sum_{j=1}^{N} F_{ij} = 1\n$$\n其中 $N$ 是封闭体中的表面数量。在这种情况下，$N=2$。\n\n我们首先将求和规则应用于表面 1。从表面 1 发出的辐射可以被表面 1 本身（角系数为 $F_{11}$）或被表面 2（角系数为 $F_{12}$）拦截。因此，表面 1 的求和规则是：\n$$\nF_{11} + F_{12} = 1\n$$\n表面 1 是一个圆柱体的外表面，这是一个凸面。根据定义，凸面无法“看到”自己。任何从凸面上一点发出并向外延伸的直线（代表辐射射线）都不能与该表面的任何其他点相交。因此，离开表面 1 的辐射中被表面 1 自身拦截的部分为零。因此，从凸面到其自身的角系数总是零。\n$$\nF_{11} = 0\n$$\n将此代入表面 1 的求和规则：\n$$\n0 + F_{12} = 1\n$$\n这给出了第一个角系数的结果：\n$$\nF_{12} = 1\n$$\n这个结果在物理上是直观的：由于内圆柱体完全被外圆柱体包围并且是凸面，所有从其外表面发出的辐射都必须不可避免地被外圆柱体的内表面拦截。\n\n接下来，我们被要求通过应用互易关系来求出 $F_{21}$。角系数的互易性定理指出，对于任意两个表面 $i$ 和 $j$：\n$$\nA_i F_{ij} = A_j F_{ji}\n$$\n将其应用于表面 1 和 2：\n$$\nA_1 F_{12} = A_2 F_{21}\n$$\n我们可以解出 $F_{21}$：\n$$\nF_{21} = F_{12} \\frac{A_1}{A_2}\n$$\n侧面积为 $A_1 = 2\\pi r_1 L$ 和 $A_2 = 2\\pi r_2 L$。将这些表达式和 $F_{12} = 1$ 的值代入 $F_{21}$ 的方程：\n$$\nF_{21} = (1) \\frac{2\\pi r_1 L}{2\\pi r_2 L} = \\frac{r_1}{r_2}\n$$\n这按照要求用半径 $r_1$ 和 $r_2$ 表示了 $F_{21}$。这个结果在物理上也是合理的：它是从外圆柱体内表面发出并照射到内圆柱体的辐射分数。这个分数是它们半径的比值（或者等效地，是它们单位长度的周长或表面积的比值）。\n\n最后，我们确认一致性条件 $A_1 F_{12} = A_2 F_{21}$。\n计算左手边 (LHS)：\n$$\n\\text{LHS} = A_1 F_{12} = (2\\pi r_1 L)(1) = 2\\pi r_1 L\n$$\n计算右手边 (RHS)：\n$$\n\\text{RHS} = A_2 F_{21} = (2\\pi r_2 L) \\left( \\frac{r_1}{r_2} \\right) = 2\\pi r_1 L\n$$\n由于 LHS = RHS ($2\\pi r_1 L = 2\\pi r_1 L$)，互易关系与推导出的角系数是内部一致的。\n\n作为进一步的检验，我们可以将求和规则应用于表面 2。表面 2 是凹面，可以同时看到表面 1 ($F_{21}$) 和其自身 ($F_{22}$)。\n$$\nF_{21} + F_{22} = 1\n$$\n使用我们推导出的 $F_{21}$ 值：\n$$\nF_{22} = 1 - F_{21} = 1 - \\frac{r_1}{r_2}\n$$\n这是离开外圆柱体内表面的辐射中，照射到外圆柱体内表面另一部分的分数。这个结果在物理上是合理的。\n\n问题要求将 $F_{12}$ 的最终答案表示为单个无量纲实数。如上所述，这个值为 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在掌握了基本原理之后，我们将探讨一个更复杂的场景：存在遮挡的情况。通过分析一个带有开孔的中间层球壳的三同心球体系统，本练习将深入探讨角系数代数的重要思想。它将向你展示当视线被部分阻挡时如何计算角系数，以及辐射能如何在多个表面之间重新分配。",
            "id": "3981137",
            "problem": "一个在非参与性介质中的漫-灰、等温三表面外壳结构如下。表面 $1$ 是一个以原点为中心、半径为 $R_1$ 的完美漫射、不透明球体。表面 $2$ 是一个半径为 $R_2$ 的完美漫射、不透明、无限薄的同心球壳，它完全包围表面 $1$，但在正 $z$ 轴上有一个圆形孔；该孔是 $R_2$ 球上的一个球冠，在中心处张成的半角为 $\\theta_0$。表面 $3$ 是一个半径为 $R_3$ 的完美漫射、不透明、无限薄的同心球壳，它完全包围表面 $2$。表面之间的介质是真空，因此是非参与性的。为简化起见，所有表面均为黑体（发射率为单位值），但您只需处理角系数（几何构型因子）。表面 $2$ 上的孔是表面 $1$ 和 $3$ 之间唯一的视线通道；在其他地方，表面 $2$ 是完全阻挡的。\n\n仅从角系数的定义、能量守恒和互易关系出发，确定表面 $2$ 上孔的存在如何重新分配角系数，并计算被遮挡的角系数 $F_{13}$ 和 $F_{31}$。\n\n使用数值数据 $R_1 = 0.40\\,\\mathrm{m}$，$R_2 = 0.80\\,\\mathrm{m}$，$R_3 = 1.20\\,\\mathrm{m}$，以及 $\\theta_0 = 60^\\circ$（角度以度为单位）。除了计算 $F_{13}$ 和 $F_{31}$ 之外，请通过将 $F_{12}$ 表示为 $F_{13}$ 的函数并验证 $F_{11} + F_{12} + F_{13} = 1$，来明确展示表面 $1$ 的求和法则。\n\n将最终答案以有序对 $\\left(F_{13}, F_{31}\\right)$ 的形式报告，四舍五入到四位有效数字。将最终答案表示为无量纲量。",
            "solution": "用户想要解决一个辐射传热中的角系数问题。\n\n### 第1步：提取已知条件\n- **几何结构**：一个在非参与性介质（真空）中的三表面外壳。\n- **表面1**：一个以原点为中心、半径为 $R_1$ 的完美漫射、不透明球体。\n- **表面2**：一个半径为 $R_2$ 的完美漫射、不透明、无限薄的同心球壳。它在正 $z$ 轴上有一个圆形孔，该孔由一个在中心处张成的半角为 $\\theta_0$ 的球冠定义。\n- **表面3**：一个半径为 $R_3$ 的完美漫射、不透明、无限薄的同心球壳，它完全包围表面 $2$。\n- **辐射特性**：为简化起见，所有表面均被视为黑体（发射率 $\\epsilon=1$），但分析仅限于几何角系数。\n- **关系**：$R_1  R_2  R_3$。表面 $2$ 上的孔是表面 $1$ 和 $3$ 之间辐射的唯一路径。\n- **数值数据**：$R_1 = 0.40\\,\\mathrm{m}$，$R_2 = 0.80\\,\\mathrm{m}$，$R_3 = 1.20\\,\\mathrm{m}$，以及 $\\theta_0 = 60^\\circ$。\n- **任务**：\n    1. 计算被遮挡的角系数 $F_{13}$ 和 $F_{31}$。\n    2. 通过将 $F_{12}$ 表示为 $F_{13}$ 的函数并验证 $F_{11} + F_{12} + F_{13} = 1$，来展示表面 $1$ 的求和法则。\n    3. 将最终答案以有序对 $(F_{13}, F_{31})$ 的形式报告，四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它描述了辐射传热中的一个经典问题。几何结构定义清晰，所有必要的参数都已提供。角系数、求和法则和相互关系的概念是该领域的基本原理。不存在矛盾、模糊或物理上不可能的条件。该问题是将角系数代数应用于带遮挡物的外壳的标准练习。\n\n### 第3步：结论与行动\n该问题是**有效的**。将提供完整的解决方案。\n\n### 解题推导\n\n分析将首先计算角系数 $F_{13}$，然后验证表面 $1$ 的求和法则，最后使用相互关系计算 $F_{31}$。\n\n**1. 角系数 $F_{13}$ 的计算**\n\n角系数 $F_{13}$ 表示离开表面 $1$ 并直接投射到表面 $3$ 上的辐射能的分数。由于几何结构，表面 $2$ 是表面 $1$ 和 $3$ 之间的一个不透明遮挡物。辐射只能通过表面 $2$ 上的孔从表面 $1$ 传播到表面 $3$。我们将此孔表示为一个假设的表面 $A$。因此，从表面 $1$ 到表面 $3$ 的角系数等同于从表面 $1$ 到孔 $A$ 的角系数。\n$$F_{13} = F_{1A}$$\n两个同心球体之间漫辐射交换的一个基本性质是，从内球到外球的辐照在外球的整个表面上是均匀的。这是球对称性的直接结果。因此，从内球（$1$）发出并被同心球壳（半径为 $R_2$）的任何部分所拦截的能量分数，就是该部分面积与球壳总面积之比。\n孔 $A$ 是半径为 $R_2$ 的球体上的一个球冠。因此，角系数 $F_{1A}$ 是孔的面积 $A_A$ 与半径为 $R_2$ 的完整球体的总表面积 $A_{2,total}$ 之比。\n$$F_{13} = F_{1A} = \\frac{A_A}{A_{2,total}}$$\n球冠的表面积由公式 $A_{cap} = 2\\pi R^2 (1 - \\cos\\alpha)$ 给出，其中 $R$ 是球的半径，$\\alpha$ 是球冠张成的半角。在我们的问题中，$R = R_2$ 且 $\\alpha = \\theta_0$。\n$$A_A = 2\\pi R_2^2 (1 - \\cos\\theta_0)$$\n半径为 $R_2$ 的球体的总表面积为：\n$$A_{2,total} = 4\\pi R_2^2$$\n将这些代入 $F_{13}$ 的表达式中：\n$$F_{13} = \\frac{2\\pi R_2^2 (1 - \\cos\\theta_0)}{4\\pi R_2^2} = \\frac{1 - \\cos\\theta_0}{2}$$\n注意，这个结果与半径 $R_1$ 和 $R_2$ 无关。使用给定值 $\\theta_0 = 60^\\circ$：\n$$\\cos\\theta_0 = \\cos(60^\\circ) = \\frac{1}{2} = 0.5$$\n$$F_{13} = \\frac{1 - 0.5}{2} = \\frac{0.5}{2} = 0.25$$\n\n**2. 表面 1 求和法则的验证**\n\n对于一个 $N$ 表面外壳中的任意表面 $i$，求和法则规定 $\\sum_{j=1}^{N} F_{ij} = 1$。对于我们三表面外壳中的表面 $1$，即为：\n$$F_{11} + F_{12} + F_{13} = 1$$\n表面 $1$ 是一个球体，它是一个凸面。凸面无法“看见”自身。因此，从表面 $1$ 到其自身的角系数为零。\n$$F_{11} = 0$$\n求和法则简化为：\n$$F_{12} + F_{13} = 1$$\n这表达了离开表面 $1$ 的辐射的能量守恒：它必须被表面 $2$ 或表面 $3$ 拦截。\n问题要求将 $F_{12}$ 表示为 $F_{13}$ 的函数。从简化的求和法则，我们得到：\n$$F_{12} = 1 - F_{13}$$\n使用计算出的值 $F_{13} = 0.25$：\n$$F_{12} = 1 - 0.25 = 0.75$$\n为明确验证求和法则，我们可以独立计算 $F_{12}$。$F_{12}$ 是从表面 $1$ 发出并投射到表面 $2$ 上的辐射分数。这是半径为 $R_2$ 的球体上*不是*孔的部分。\n$$F_{12} = \\frac{A_2}{A_{2,total}} = \\frac{A_{2,total} - A_A}{A_{2,total}} = 1 - \\frac{A_A}{A_{2,total}} = 1 - F_{13}$$\n这证实了我们之前的推理。使用角度 $\\theta_0$：\n$$F_{12} = 1 - \\frac{1 - \\cos\\theta_0}{2} = \\frac{2 - (1 - \\cos\\theta_0)}{2} = \\frac{1 + \\cos\\theta_0}{2}$$\n对于 $\\theta_0 = 60^\\circ$：\n$$F_{12} = \\frac{1 + 0.5}{2} = \\frac{1.5}{2} = 0.75$$\n现在，我们用计算出的值验证求和法则：\n$$F_{11} + F_{12} + F_{13} = 0 + 0.75 + 0.25 = 1.00$$\n求和法则成立，证实了我们对 $F_{13}$ 计算的正确性。\n\n**3. 角系数 $F_{31}$ 的计算**\n\n为了求出角系数 $F_{31}$，我们使用相互关系，对于表面 $1$ 和 $3$，其形式为：\n$$A_1 F_{13} = A_3 F_{31}$$\n其中 $A_1$ 和 $A_3$ 分别是表面 $1$ 和 $3$ 的面积。\n表面 $1$（半径为 $R_1$ 的球体）的面积是：\n$$A_1 = 4\\pi R_1^2$$\n表面 $3$（半径为 $R_3$ 的球体的内表面）的面积是：\n$$A_3 = 4\\pi R_3^2$$\n重新排列相互关系以求解 $F_{31}$：\n$$F_{31} = F_{13} \\frac{A_1}{A_3} = F_{13} \\frac{4\\pi R_1^2}{4\\pi R_3^2} = F_{13} \\left(\\frac{R_1}{R_3}\\right)^2$$\n现在，我们代入已知的数值：$F_{13} = 0.25$，$R_1 = 0.40\\,\\mathrm{m}$，以及 $R_3 = 1.20\\,\\mathrm{m}$。\n$$F_{31} = 0.25 \\times \\left(\\frac{0.40}{1.20}\\right)^2 = 0.25 \\times \\left(\\frac{1}{3}\\right)^2 = 0.25 \\times \\frac{1}{9} = \\frac{1}{4} \\times \\frac{1}{9} = \\frac{1}{36}$$\n将此分数转换为小数：\n$$F_{31} = \\frac{1}{36} \\approx 0.027777...$$\n\n**4. 最终答案的形成**\n\n问题要求提供有序对 $(F_{13}, F_{31})$，数值四舍五入到四位有效数字。\n- $F_{13} = 0.25$。保留四位有效数字，为 $0.2500$。\n- $F_{31} \\approx 0.027777...$。保留四位有效数字，为 $0.02778$。\n\n最终答案为有序对 $(0.2500, 0.02778)$。",
            "answer": "$$\n\\boxed{(0.2500, 0.02778)}\n$$"
        },
        {
            "introduction": "最后的实践将理论与计算应用联系起来，这也是辐射度法的精髓所在。在大多数实际工程问题中，表面温度不是预先给定的，而是由辐射、对流和内部热源之间的能量平衡决定的。本练习将指导你构建一个功能强大的数值求解器，以解决这个耦合的非线性方程组，从而为复杂的综合热分析提供一个有力的工具。",
            "id": "3981134",
            "problem": "考虑一个由有限个不透明的漫灰表面组成的封闭腔，这些表面在非参与介质中交换热辐射。每个表面还与指定环境温度的外部环境发生对流。该封闭腔是封闭的，且表面没有透射率。未知的表面温度通过黑体辐射力呈非线性关系出现。您必须从基本原理出发，通过构建牛顿迭代或不动点迭代，推导、实现并求解一个用于计算表面温度的非线性系统。\n\n基本出发点：\n- 斯特藩-玻尔兹曼定律，描述黑体辐射力：$E_b = \\sigma T^4$，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数，$T$ 是绝对温度。\n- 对于一个漫灰、不透明的表面 $i$，将辐射度 $J_i$ 定义为单位时间单位面积离开表面的总热辐射能量，将辐照度 $G_i$ 定义为单位时间单位面积到达表面的总热辐射能量。假设为漫反射，反射率为 $1 - \\varepsilon_i$，其中 $\\varepsilon_i$ 是发射率。\n- 定义角（视）系数 $F_{ij}$，对于一个无自视（$F_{ii} = 0$）的封闭腔，其满足相互关系 $A_i F_{ij} = A_j F_{ji}$ 和加和关系 $\\sum_j F_{ij} = 1$。\n- 与静止环境的对流通过牛顿冷却定律建模，其系数为 $h_i$，环境温度为 $T_{\\infty,i}$。\n\n任务：\n1. 使用上述基本定义，根据未知温度、发射率和角系数，为每个表面 $i$ 正式定义辐射度和辐照度。利用这些定义，构建一组方程，将给定封闭腔的辐射度与温度关联起来。\n2. 为每个表面 $i$ 编写一个能量平衡方程，使单位面积的供热量 $q_{i}^{\\text{gen}}$ 等于对流热损失与净辐射损失之和。根据物理定义，用辐射度和辐照度表示净辐射热损失。\n3. 推导一个残差函数 $\\mathbf{R}(\\mathbf{T})$，其根对应于满足能量平衡的温度。构建以下任一方法：\n   - 一个针对 $\\mathbf{T}$ 的牛顿迭代，需要雅可比矩阵 $\\partial \\mathbf{R}/\\partial \\mathbf{T}$，或\n   - 一个基于物理关系证明其合理性的针对 $\\mathbf{T}$ 的不动点迭代。\n   无论哪种情况，都需要根据残差和更新量的数学上明确定义的范数来指定停止准则。该准则必须用残差（单位 $\\mathrm{W/m^2}$）和温度变化（单位 $\\mathrm{K}$）的绝对容差来表示。明确描述您的程序将使用的收敛准则。\n4. 完全用代码实现您选择的迭代方法。该迭代必须对由低发射率或强耦合引起的病态问题具有鲁棒性，并必须确保温度保持在物理上允许的范围内（绝对温度严格为正）。\n\n常数和单位：\n- 使用 $\\sigma = 5.670374419\\times 10^{-8}\\ \\mathrm{W/(m^2\\cdot K^4)}$。\n- 所有温度必须以 $\\mathrm{K}$ 为单位计算和报告。\n- 产热量 $q_{i}^{\\text{gen}}$ 的单位是 $\\mathrm{W/m^2}$。\n- 对流系数 $h_i$ 的单位是 $\\mathrm{W/(m^2\\cdot K)}$。\n- 角系数 $F_{ij}$ 是无量纲的。\n\n测试套件：\n为以下四个测试用例实现您的求解器。每个用例由表面数量 $N$、面积 $\\{A_i\\}$、发射率 $\\{\\varepsilon_i\\}$、对流系数 $\\{h_i\\}$、环境温度 $\\{T_{\\infty,i}\\}$、单位面积产热量 $\\{q_{i}^{\\text{gen}}\\}$ 以及角系数矩阵 $F$ 指定。\n\n- 用例 1（两个相对的平板，其中一个被加热）：\n  - $N = 2$\n  - 面积：$A_1 = 1.0\\ \\mathrm{m^2}$，$A_2 = 1.0\\ \\mathrm{m^2}$\n  - 发射率：$\\varepsilon_1 = 0.9$，$\\varepsilon_2 = 0.7$\n  - 对流系数：$h_1 = 10.0\\ \\mathrm{W/(m^2\\cdot K)}$，$h_2 = 5.0\\ \\mathrm{W/(m^2\\cdot K)}$\n  - 环境温度：$T_{\\infty,1} = 300.0\\ \\mathrm{K}$，$T_{\\infty,2} = 300.0\\ \\mathrm{K}$\n  - 产热量：$q_{1}^{\\text{gen}} = 1000.0\\ \\mathrm{W/m^2}$，$q_{2}^{\\text{gen}} = 0.0\\ \\mathrm{W/m^2}$\n  - 角系数：$F = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}$\n\n- 用例 2（三个具有不对称面积和耦合的表面）：\n  - $N = 3$\n  - 面积：$A_1 = 1.0\\ \\mathrm{m^2}$，$A_2 = 2.0\\ \\mathrm{m^2}$，$A_3 = 1.0\\ \\mathrm{m^2}$\n  - 发射率：$\\varepsilon_1 = 0.85$，$\\varepsilon_2 = 0.6$，$\\varepsilon_3 = 0.9$\n  - 对流系数：$h_1 = 15.0\\ \\mathrm{W/(m^2\\cdot K)}$，$h_2 = 8.0\\ \\mathrm{W/(m^2\\cdot K)}$，$h_3 = 20.0\\ \\mathrm{W/(m^2\\cdot K)}$\n  - 环境温度：$T_{\\infty,1} = 300.0\\ \\mathrm{K}$，$T_{\\infty,2} = 300.0\\ \\mathrm{K}$，$T_{\\infty,3} = 300.0\\ \\mathrm{K}$\n  - 产热量：$q_{1}^{\\text{gen}} = 500.0\\ \\mathrm{W/m^2}$，$q_{2}^{\\text{gen}} = 200.0\\ \\mathrm{W/m^2}$，$q_{3}^{\\text{gen}} = 0.0\\ \\mathrm{W/m^2}$\n  - 角系数：\n    $F = \\begin{bmatrix}\n    0  1  0 \\\\\n    0.5  0  0.5 \\\\\n    0  1  0\n    \\end{bmatrix}$\n    该矩阵遵循相互关系 $A_1 F_{12} = A_2 F_{21}$，$A_1 F_{13} = A_3 F_{31}$，$A_2 F_{23} = A_3 F_{32}$ 和逐行求和规则。\n\n- 用例 3（两个具有极低发射率和强加热的相对平板）：\n  - $N = 2$\n  - 面积：$A_1 = 1.0\\ \\mathrm{m^2}$，$A_2 = 1.0\\ \\mathrm{m^2}$\n  - 发射率：$\\varepsilon_1 = 0.05$，$\\varepsilon_2 = 0.05$\n  - 对流系数：$h_1 = 2.0\\ \\mathrm{W/(m^2\\cdot K)}$，$h_2 = 2.0\\ \\mathrm{W/(m^2\\cdot K)}$\n  - 环境温度：$T_{\\infty,1} = 300.0\\ \\mathrm{K}$，$T_{\\infty,2} = 300.0\\ \\mathrm{K}$\n  - 产热量：$q_{1}^{\\text{gen}} = 2000.0\\ \\mathrm{W/m^2}$，$q_{2}^{\\text{gen}} = 0.0\\ \\mathrm{W/m^2}$\n  - 角系数：$F = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}$\n\n- 用例 4（两个相对的平板，无加热；边界检查）：\n  - $N = 2$\n  - 面积：$A_1 = 1.0\\ \\mathrm{m^2}$，$A_2 = 1.0\\ \\mathrm{m^2}$\n  - 发射率：$\\varepsilon_1 = 0.8$，$\\varepsilon_2 = 0.8$\n  - 对流系数：$h_1 = 10.0\\ \\mathrm{W/(m^2\\cdot K)}$，$h_2 = 10.0\\ \\mathrm{W/(m^2\\cdot K)}$\n  - 环境温度：$T_{\\infty,1} = 300.0\\ \\mathrm{K}$，$T_{\\infty,2} = 300.0\\ \\mathrm{K}$\n  - 产热量：$q_{1}^{\\text{gen}} = 0.0\\ \\mathrm{W/m^2}$，$q_{2}^{\\text{gen}} = 0.0\\ \\mathrm{W/m^2}$\n  - 角系数：$F = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix}$\n\n输出要求：\n- 实现迭代时，残差无穷范数的绝对收敛容差为 $10^{-6}\\ \\mathrm{W/m^2}$，温度更新无穷范数的绝对收敛容差为 $10^{-9}\\ \\mathrm{K}$。\n- 对于每个用例，计算收敛后的温度 $\\{T_i\\}$（单位 K），并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。列表中的每个元素是对应一个用例的温度列表，例如，“[[T_case1_surface1,T_case1_surface2], [T_case2_surface1,...], ...]”。温度必须以 K 为单位，并按要求四舍五入到三位小数。",
            "solution": "该问题要求推导并实现一个数值求解器，用于计算存在外部对流的辐射封闭腔中的稳态表面温度。通过建立一个非线性系统能量平衡方程组，并使用牛顿法求解来获得解。\n\n### 步骤 1：控制方程的推导\n\n分析从非参与介质中 $N$ 个不透明漫灰表面组成的封闭腔的辐射传热基本原理开始。\n\n**1. 辐射度与辐照度**\n对于每个表面 $i$，辐射度 $J_i$ 是单位面积离开表面的总辐射能。它是发射辐射和反射辐射之和：\n$$J_i = \\varepsilon_i E_{b,i} + \\rho_i G_i$$\n其中 $\\varepsilon_i$ 是发射率，$E_{b,i} = \\sigma T_i^4$ 是绝对温度 $T_i$ 下的黑体辐射力，$\\rho_i$ 是反射率，$G_i$ 是辐照度（单位面积的入射辐射能）。对于不透明表面，$\\rho_i = 1 - \\varepsilon_i$。因此，\n$$J_i = \\varepsilon_i \\sigma T_i^4 + (1 - \\varepsilon_i) G_i$$\n\n表面 $i$ 上的辐照度 $G_i$ 是从封闭腔中所有其他表面 $j$ 到达的辐射能之和。\n$$A_i G_i = \\sum_{j=1}^{N} J_j A_j F_{ji}$$\n使用相互关系 $A_j F_{ji} = A_i F_{ij}$，我们可以将表面 $i$ 的单位面积辐照度 $G_i$ 写为：\n$$G_i = \\sum_{j=1}^{N} F_{ij} J_j$$\n\n**2. 用温度表示的辐射度系统**\n将 $G_i$ 的表达式代入 $J_i$ 的方程，得到一个关于辐射度 $J_i$ 的 $N$ 个线性方程组（假设温度 $T_i$ 已知）：\n$$J_i = \\varepsilon_i \\sigma T_i^4 + (1 - \\varepsilon_i) \\sum_{j=1}^{N} F_{ij} J_j$$\n可以将其重新排列为：\n$$J_i - (1 - \\varepsilon_i) \\sum_{j=1}^{N} F_{ij} J_j = \\varepsilon_i \\sigma T_i^4$$\n\n用矩阵-向量表示法，该系统变为：\n$$(\\mathbf{I} - \\mathrm{diag}(1-\\boldsymbol{\\varepsilon})\\mathbf{F}) \\mathbf{J} = \\mathrm{diag}(\\boldsymbol{\\varepsilon}) \\mathbf{E_b}(\\mathbf{T})$$\n其中 $\\mathbf{I}$ 是单位矩阵，$\\mathbf{F}$ 是元素为 $F_{ij}$ 的角系数矩阵，$\\mathbf{J}$ 是辐射度向量，$\\boldsymbol{\\varepsilon}$ 是发射率向量，$\\mathbf{E_b}(\\mathbf{T})$ 是黑体辐射力向量，即 $\\sigma \\mathbf{T}^4$（逐元素）。\n\n我们定义矩阵 $\\mathbf{M} = \\mathbf{I} - \\mathrm{diag}(1-\\boldsymbol{\\varepsilon})\\mathbf{F}$。则该系统为 $\\mathbf{M}\\mathbf{J} = \\mathrm{diag}(\\boldsymbol{\\varepsilon}) \\mathbf{E_b}$。对于任何具有 $\\varepsilon_i > 0$ 和 $\\sum_j F_{ij} = 1$ 的物理系统，矩阵 $\\mathbf{M}$ 是严格对角占优的，因此是非奇异的。因此，我们可以正式地将辐射度向量 $\\mathbf{J}$ 表示为温度向量 $\\mathbf{T}$ 的函数：\n$$\\mathbf{J}(\\mathbf{T}) = \\mathbf{M}^{-1} \\mathrm{diag}(\\boldsymbol{\\varepsilon}) \\mathbf{E_b}(\\mathbf{T})$$\n\n**3. 表面能量平衡**\n表面 $i$ 上的稳态能量平衡方程将单位面积的供热量 $q_{i}^{\\text{gen}}$ 与对流和净辐射热损失之和相等：\n$$q_{i}^{\\text{gen}} = q_{i,\\text{conv}} + q_{i,\\text{rad,net}}$$\n与温度为 $T_{\\infty,i}$ 的环境之间的对流热损失由牛顿冷却定律给出：\n$$q_{i,\\text{conv}} = h_i (T_i - T_{\\infty,i})$$\n净辐射热损失是辐射度与辐照度之差：\n$$q_{i,\\text{rad,net}} = J_i - G_i = J_i - \\sum_{j=1}^{N} F_{ij} J_j$$\n以向量形式，净辐射热通量为 $\\mathbf{q}_{\\text{rad,net}} = (\\mathbf{I}-\\mathbf{F})\\mathbf{J}$。\n\n**4. 残差函数**\n通过将热通量的表达式代入能量平衡方程，得到求解未知温度 $\\mathbf{T}$ 的方程组。我们定义一个残差函数 $\\mathbf{R}(\\mathbf{T})$，其根 $\\mathbf{R}(\\mathbf{T})=\\mathbf{0}$ 即为解。\n$$R_i(\\mathbf{T}) = q_{i}^{\\text{gen}} - h_i (T_i - T_{\\infty,i}) - q_{i,\\text{rad,net}}(\\mathbf{T}) = 0$$\n以向量形式：\n$$\\mathbf{R}(\\mathbf{T}) = \\mathbf{q}^{\\text{gen}} - \\mathbf{h} \\circ (\\mathbf{T} - \\mathbf{T}_{\\infty}) - (\\mathbf{I}-\\mathbf{F})\\mathbf{J}(\\mathbf{T})$$\n其中 $\\circ$ 表示哈达玛（逐元素）积。代入 $\\mathbf{J}(\\mathbf{T})$ 的表达式：\n$$\\mathbf{R}(\\mathbf{T}) = \\mathbf{q}^{\\text{gen}} - \\mathbf{h} \\circ (\\mathbf{T} - \\mathbf{T}_{\\infty}) - (\\mathbf{I}-\\mathbf{F})\\mathbf{M}^{-1}\\mathrm{diag}(\\boldsymbol{\\varepsilon})\\mathbf{E_b}(\\mathbf{T})$$\n这就是最终用于求解 $N$ 个未知温度的 $N$ 个非线性方程组。\n\n### 步骤 2：非线性系统的牛顿法\n\n牛顿法是一种迭代求根算法。给定一个温度的估计值 $\\mathbf{T}^{(k)}$，通过求解一个基于残差函数局部梯度（雅可比矩阵）的线性系统，可以找到一个新的、改进的估计值 $\\mathbf{T}^{(k+1)}$。\n更新规则为：\n$$\\mathbf{T}^{(k+1)} = \\mathbf{T}^{(k)} - \\mathcal{J}(\\mathbf{T}^{(k)})^{-1} \\mathbf{R}(\\mathbf{T}^{(k)})$$\n其中 $\\mathcal{J}(\\mathbf{T}^{(k)})$ 是 $\\mathbf{R}$ 在 $\\mathbf{T}^{(k)}$ 处求值的雅可比矩阵。\n\n**1. 雅可比矩阵的推导**\n雅可比矩阵 $\\mathcal{J}$ 的元素为 $\\mathcal{J}_{ij} = \\frac{\\partial R_i}{\\partial T_j}$。我们对残差函数 $R_i(\\mathbf{T})$ 进行微分。为了提高效率，我们定义一个常数矩阵 $\\mathbf{C} = (\\mathbf{I}-\\mathbf{F})\\mathbf{M}^{-1}\\mathrm{diag}(\\boldsymbol{\\varepsilon})$。残差向量则为：\n$$\\mathbf{R}(\\mathbf{T}) = \\mathbf{q}^{\\text{gen}} - \\mathbf{h} \\circ (\\mathbf{T} - \\mathbf{T}_{\\infty}) - \\mathbf{C} (\\sigma \\mathbf{T}^4)$$\n现在，我们对 $T_j$ 进行微分：\n$$\\frac{\\partial R_i}{\\partial T_j} = \\frac{\\partial}{\\partial T_j} \\left( q_{i}^{\\text{gen}} - h_i(T_i - T_{\\infty,i}) - \\sum_{k=1}^{N} C_{ik} (\\sigma T_k^4) \\right)$$\n$$\\frac{\\partial R_i}{\\partial T_j} = - h_i \\delta_{ij} - C_{ij} \\frac{\\partial}{\\partial T_j}(\\sigma T_j^4) = -h_i \\delta_{ij} - C_{ij} (4 \\sigma T_j^3)$$\n以矩阵形式，雅可比矩阵为：\n$$\\mathcal{J}(\\mathbf{T}) = -\\mathrm{diag}(\\mathbf{h}) - \\mathbf{C} \\mathrm{diag}(4\\sigma \\mathbf{T}^3)$$\n\n**2. 算法与实现细节**\n迭代求解过程如下：\n1.  **初始化**：根据给定的问题参数，预先计算常数矩阵 $\\mathbf{M}^{-1}$ 和 $\\mathbf{C}$。为温度向量设置一个初始猜测值 $\\mathbf{T}^{(0)}$（例如，$\\mathbf{T}^{(0)} = \\mathbf{T}_{\\infty}$）。\n2.  **迭代**：对于 $k=0, 1, 2, ...$：\n    a.  计算残差向量 $\\mathbf{R}(\\mathbf{T}^{(k)})$。\n    b.  计算雅可比矩阵 $\\mathcal{J}(\\mathbf{T}^{(k)})$。\n    c.  求解线性系统 $\\mathcal{J}(\\mathbf{T}^{(k)}) \\Delta\\mathbf{T} = -\\mathbf{R}(\\mathbf{T}^{(k)})$，得到更新向量 $\\Delta\\mathbf{T}$。\n    d.  应用线搜索找到一个步长 $\\alpha \\in (0, 1]$，使得新温度 $\\mathbf{T}^{(k+1)} = \\mathbf{T}^{(k)} + \\alpha \\Delta\\mathbf{T}$ 是物理上允许的（即，对所有 $i$ 都有 $T_i > 0$）。这通过从 $\\alpha=1$ 开始并不断减半直至满足条件来实现。\n    e.  更新温度向量：$\\mathbf{T}^{(k+1)} = \\mathbf{T}^{(k)} + \\alpha \\Delta\\mathbf{T}$。\n3.  **收敛检查**：当以下两个准则同时满足时，迭代终止：\n    -   残差的无穷范数低于绝对容差 $\\tau_{\\text{res}}$：$||\\mathbf{R}(\\mathbf{T}^{(k+1)})||_{\\infty}  \\tau_{\\text{res}} = 10^{-6} \\mathrm{W/m^2}$。\n    -   温度更新的无穷范数低于绝对容差 $\\tau_T$: $||\\alpha \\Delta\\mathbf{T}||_{\\infty}  \\tau_T = 10^{-9} \\mathrm{K}$。\n同时也会强制执行最大迭代次数以防止无限循环。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and run the solver for each.\n    The final results are printed in the specified format.\n    \"\"\"\n    sigma = 5.670374419e-8\n\n    test_cases = [\n        # Case 1: two facing plates with one heated\n        {\n            \"N\": 2,\n            \"A\": np.array([1.0, 1.0]),\n            \"eps\": np.array([0.9, 0.7]),\n            \"h\": np.array([10.0, 5.0]),\n            \"T_inf\": np.array([300.0, 300.0]),\n            \"q_gen\": np.array([1000.0, 0.0]),\n            \"F\": np.array([[0.0, 1.0], [1.0, 0.0]]),\n        },\n        # Case 2: three surfaces with asymmetric areas and coupling\n        {\n            \"N\": 3,\n            \"A\": np.array([1.0, 2.0, 1.0]),\n            \"eps\": np.array([0.85, 0.6, 0.9]),\n            \"h\": np.array([15.0, 8.0, 20.0]),\n            \"T_inf\": np.array([300.0, 300.0, 300.0]),\n            \"q_gen\": np.array([500.0, 200.0, 0.0]),\n            \"F\": np.array([[0.0, 1.0, 0.0], [0.5, 0.0, 0.5], [0.0, 1.0, 0.0]]),\n        },\n        # Case 3: two facing plates with very low emissivity and strong heating\n        {\n            \"N\": 2,\n            \"A\": np.array([1.0, 1.0]),\n            \"eps\": np.array([0.05, 0.05]),\n            \"h\": np.array([2.0, 2.0]),\n            \"T_inf\": np.array([300.0, 300.0]),\n            \"q_gen\": np.array([2000.0, 0.0]),\n            \"F\": np.array([[0.0, 1.0], [1.0, 0.0]]),\n        },\n        # Case 4: two facing plates, no heating; boundary check\n        {\n            \"N\": 2,\n            \"A\": np.array([1.0, 1.0]),\n            \"eps\": np.array([0.8, 0.8]),\n            \"h\": np.array([10.0, 10.0]),\n            \"T_inf\": np.array([300.0, 300.0]),\n            \"q_gen\": np.array([0.0, 0.0]),\n            \"F\": np.array([[0.0, 1.0], [1.0, 0.0]]),\n        },\n    ]\n    \n    results = []\n    for case in test_cases:\n        converged_temps = solve_enclosure(\n            N=case[\"N\"],\n            eps=case[\"eps\"],\n            h=case[\"h\"],\n            T_inf=case[\"T_inf\"],\n            q_gen=case[\"q_gen\"],\n            F=case[\"F\"],\n            sigma=sigma,\n            tol_res=1e-6,\n            tol_T=1e-9,\n            max_iter=100\n        )\n        results.append(np.round(converged_temps, 3).tolist())\n\n    # The string representation of a list of lists is already the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef solve_enclosure(N, eps, h, T_inf, q_gen, F, sigma, tol_res, tol_T, max_iter):\n    \"\"\"\n    Solves for the steady-state surface temperatures in a radiative enclosure using Newton's method.\n\n    Args:\n        N (int): Number of surfaces.\n        eps (np.ndarray): Vector of surface emissivities.\n        h (np.ndarray): Vector of convection coefficients.\n        T_inf (np.ndarray): Vector of ambient temperatures.\n        q_gen (np.ndarray): Vector of heat generation per unit area.\n        F (np.ndarray): Configuration factor matrix.\n        sigma (float): Stefan-Boltzmann constant.\n        tol_res (float): Convergence tolerance for the residual norm.\n        tol_T (float): Convergence tolerance for the temperature update norm.\n        max_iter (int): Maximum number of iterations.\n\n    Returns:\n        np.ndarray: Vector of converged surface temperatures in Kelvin.\n    \"\"\"\n    # Pre-calculate constant matrices for efficiency.\n    # M = I - diag(1-eps) @ F\n    M = np.identity(N) - np.diag(1 - eps) @ F\n    try:\n        M_inv = np.linalg.inv(M)\n    except np.linalg.LinAlgError:\n        raise RuntimeError(\"Matrix M is singular, problem may be ill-posed.\")\n\n    # C = (I - F) @ M_inv @ diag(eps)\n    C = (np.identity(N) - F) @ M_inv @ np.diag(eps)\n    \n    # Initial guess for temperatures\n    T = T_inf.copy().astype(float)\n    if not np.all(T > 0):\n        # Fallback if any ambient temp is 0K or less.\n        T[T = 0] = 300.0\n\n    for k in range(max_iter):\n        # --- Calculate Residual R(T) ---\n        E_b = sigma * T**4\n        q_rad = C @ E_b\n        q_conv = h * (T - T_inf)\n        R = q_gen - q_conv - q_rad\n\n        # --- Calculate Jacobian J(T) ---\n        # J = -diag(h) - C @ diag(4*sigma*T^3)\n        J = -np.diag(h) - C @ np.diag(4 * sigma * T**3)\n        \n        # --- Solve for update step delta_T ---\n        try:\n            delta_T = np.linalg.solve(J, -R)\n        except np.linalg.LinAlgError:\n            raise RuntimeError(f\"Jacobian is singular at iteration {k}.\")\n\n        # --- Line search for step size alpha to ensure T > 0 ---\n        alpha = 1.0\n        while True:\n            T_next = T + alpha * delta_T\n            if np.all(T_next > 0):\n                break\n            alpha /= 2.0\n            if alpha  1e-9: # Failsafe for line search\n                raise RuntimeError(\"Line search failed to find a valid step.\")\n        \n        T_update = alpha * delta_T\n        T = T + T_update\n\n        # --- Check for convergence ---\n        res_norm = np.linalg.norm(R, np.inf)\n        update_norm = np.linalg.norm(T_update, np.inf)\n\n        if res_norm  tol_res and update_norm  tol_T:\n            return T\n            \n    raise RuntimeError(f\"Solver did not converge within {max_iter} iterations.\")\n\nsolve()\n```"
        }
    ]
}