{
    "hands_on_practices": [
        {
            "introduction": "In many thermal engineering applications, from designing high-temperature coatings to analyzing satellite thermal control systems, knowing a material's emissivity is critical. While direct measurement of spectral emissivity can be challenging, spectral reflectance is often more accessible experimentally. This practice bridges that gap by applying Kirchhoff's law, which states that under thermal equilibrium, a material's spectral absorptivity equals its spectral emissivity ($ \\epsilon_\\lambda = \\alpha_\\lambda $). You will use this principle, along with the conservation of energy for an opaque surface, to determine the hemispherical spectral emissivity of a material from a given empirical model for its reflectance, a foundational skill in thermal-radiative analysis .",
            "id": "3966162",
            "problem": "An opaque ceramic coating is tested in a high-temperature radiative environment at temperature $T$, and its hemispherical spectral reflectance $\\bar{\\rho}_{\\lambda}(\\lambda;T)$ is reported by the following fit to measured data across wavelength $\\lambda$:\n$$\n\\bar{\\rho}_{\\lambda}(\\lambda;T) \\;=\\; 0.07 \\;+\\; 0.15\\,\\exp\\!\\left(-\\left(\\frac{\\lambda}{2.5\\,\\mu\\mathrm{m}}\\right)^{2}\\right) \\;+\\; 0.10\\,\\left(\\frac{\\lambda}{10\\,\\mu\\mathrm{m}}\\right)^{1/3} \\;+\\; 0.02\\,\\left(\\frac{T}{1000\\,\\mathrm{K}} - 1\\right).\n$$\nAssume the coating is strictly opaque in the spectral band of interest (zero spectral transmittance), the surface and its surroundings are in mutual thermal equilibrium, and the measured reflectance is truly hemispherical (integrated over all reflection directions with proper direction-cosine weighting).\n\nStarting from the fundamental definitions of spectral hemispherical absorptivity and reflectance, the radiative energy balance at the surface, and the statement of Kirchhoff’s law of thermal radiation at thermal equilibrium, determine the hemispherical spectral emissivity $\\bar{\\epsilon}_{\\lambda}$ of this coating at $\\lambda^{\\star} = 5\\,\\mu\\mathrm{m}$ and $T^{\\star} = 1200\\,\\mathrm{K}$. Express the final emissivity as a dimensionless decimal. Round your answer to four significant figures.",
            "solution": "The problem requires the determination of the hemispherical spectral emissivity, $\\bar{\\epsilon}_{\\lambda}$, of a ceramic coating at a specific wavelength $\\lambda^{\\star}$ and temperature $T^{\\star}$. This will be accomplished by first principles, beginning with the conservation of radiative energy at a surface and then applying Kirchhoff's law of thermal radiation.\n\nFirst, we consider the radiative energy balance for an irradiated surface. The fraction of incident spectral radiation that is absorbed is the spectral absorptivity, $\\alpha_{\\lambda}$, the fraction reflected is the spectral reflectivity, $\\rho_{\\lambda}$, and the fraction transmitted is the spectral transmissivity, $\\tau_{\\lambda}$. By conservation of energy, these three properties must sum to unity for any given wavelength $\\lambda$:\n$$ \\alpha_{\\lambda} + \\rho_{\\lambda} + \\tau_{\\lambda} = 1 $$\nThis relationship holds for any irradiation conditions. The problem specifies that the measured reflectance is hemispherical, which means it is integrated over all reflection angles. Consequently, all properties in the energy balance must be considered hemispherical. The equation is more precisely written as:\n$$ \\bar{\\alpha}_{\\lambda} + \\bar{\\rho}_{\\lambda} + \\bar{\\tau}_{\\lambda} = 1 $$\nwhere the overbar denotes a hemispherical property.\n\nThe problem states that the coating is strictly opaque. Opacity implies that no radiation is transmitted through the material. Therefore, the spectral hemispherical transmissivity is zero:\n$$ \\bar{\\tau}_{\\lambda} = 0 $$\nSubstituting this condition into the energy balance equation simplifies it to:\n$$ \\bar{\\alpha}_{\\lambda} + \\bar{\\rho}_{\\lambda} = 1 \\quad \\implies \\quad \\bar{\\alpha}_{\\lambda} = 1 - \\bar{\\rho}_{\\lambda} $$\nThis equation relates the hemispherical spectral absorptivity to the hemispherical spectral reflectance for any opaque surface.\n\nNext, we invoke Kirchhoff's law of thermal radiation. This law states that for an arbitrary body emitting and absorbing thermal radiation in thermal equilibrium with its surroundings, its emissivity is equal to its absorptivity. For spectral, hemispherical properties, this is expressed as:\n$$ \\bar{\\epsilon}_{\\lambda}(\\lambda; T) = \\bar{\\alpha}_{\\lambda}(\\lambda; T) $$\nThe problem explicitly states that \"the surface and its surroundings are in mutual thermal equilibrium,\" which is the precise condition under which Kirchhoff's law is valid.\n\nBy combining the simplified energy balance with Kirchhoff's law, we establish a direct relationship between the hemispherical spectral emissivity and the hemispherical spectral reflectance for an opaque surface in thermal equilibrium:\n$$ \\bar{\\epsilon}_{\\lambda}(\\lambda; T) = 1 - \\bar{\\rho}_{\\lambda}(\\lambda; T) $$\nThis equation forms the basis of our calculation.\n\nThe problem provides an empirical formula for the hemispherical spectral reflectance $\\bar{\\rho}_{\\lambda}(\\lambda;T)$:\n$$ \\bar{\\rho}_{\\lambda}(\\lambda;T) \\;=\\; 0.07 \\;+\\; 0.15\\,\\exp\\!\\left(-\\left(\\frac{\\lambda}{2.5\\,\\mu\\mathrm{m}}\\right)^{2}\\right) \\;+\\; 0.10\\,\\left(\\frac{\\lambda}{10\\,\\mu\\mathrm{m}}\\right)^{1/3} \\;+\\; 0.02\\,\\left(\\frac{T}{1000\\,\\mathrm{K}} - 1\\right) $$\nWe are asked to evaluate the emissivity at the specific conditions $\\lambda^{\\star} = 5\\,\\mu\\mathrm{m}$ and $T^{\\star} = 1200\\,\\mathrm{K}$.\n\nFirst, we calculate the dimensionless arguments in the reflectance formula:\n$$ \\frac{\\lambda^{\\star}}{2.5\\,\\mu\\mathrm{m}} = \\frac{5\\,\\mu\\mathrm{m}}{2.5\\,\\mu\\mathrm{m}} = 2 $$\n$$ \\frac{\\lambda^{\\star}}{10\\,\\mu\\mathrm{m}} = \\frac{5\\,\\mu\\mathrm{m}}{10\\,\\mu\\mathrm{m}} = 0.5 $$\n$$ \\frac{T^{\\star}}{1000\\,\\mathrm{K}} = \\frac{1200\\,\\mathrm{K}}{1000\\,\\mathrm{K}} = 1.2 $$\n\nNow, substitute these values into the expression for $\\bar{\\rho}_{\\lambda}$:\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp\\left(-(2)^{2}\\right) + 0.10\\,(0.5)^{1/3} + 0.02\\,(1.2 - 1) $$\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp(-4) + 0.10\\,(0.5)^{1/3} + 0.02\\,(0.2) $$\n$$ \\bar{\\rho}_{\\lambda}(\\lambda^{\\star}; T^{\\star}) = 0.07 + 0.15\\,\\exp(-4) + 0.10\\,(0.5)^{1/3} + 0.004 $$\n\nWe proceed to calculate the numerical value of each term:\nThe exponential term is:\n$$ 0.15\\,\\exp(-4) \\approx 0.15 \\times 0.01831566 \\approx 0.00274735 $$\nThe power law term is:\n$$ 0.10\\,(0.5)^{1/3} \\approx 0.10 \\times 0.79370053 \\approx 0.07937005 $$\nSumming all terms to find the reflectance:\n$$ \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.07 + 0.00274735 + 0.07937005 + 0.004 $$\n$$ \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.15611740 $$\n\nFinally, we calculate the hemispherical spectral emissivity using the derived relation:\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) = 1 - \\bar{\\rho}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) $$\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 1 - 0.15611740 $$\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.84388260 $$\n\nThe problem requires the answer to be rounded to four significant figures. The fifth significant figure is $8$, so we round up the fourth digit.\n$$ \\bar{\\epsilon}_{\\lambda}(5\\,\\mu\\mathrm{m}; 1200\\,\\mathrm{K}) \\approx 0.8439 $$\nThis is the final dimensionless value for the emissivity under the specified conditions.",
            "answer": "$$\n\\boxed{0.8439}\n$$"
        },
        {
            "introduction": "While a full spectral analysis of radiative heat transfer provides the highest accuracy, it is often computationally intensive. To simplify calculations, engineers frequently employ the gray-body approximation, which assumes radiative properties are constant across all wavelengths. This exercise explores the validity and consequences of that simplification . By building a computational model, you will calculate the net radiative heat flux using both a full spectral integration based on Planck's law and the gray-body model, where the gray emissivity is determined by a Planck-weighted average. This practice is essential for developing the judgment to know when a simplified model is appropriate and how to quantify the error it introduces.",
            "id": "3966176",
            "problem": "A surface with wavelength-dependent absorptivity $\\alpha_\\lambda$ is exchanging thermal radiation with a large isothermal environment. Under thermodynamic equilibrium, Kirchhoff's law of thermal radiation states that the spectral emissivity equals the spectral absorptivity, i.e., $\\epsilon_\\lambda = \\alpha_\\lambda$. The hemispherical blackbody spectral emissive power per unit wavelength is given by Planck's law,\n$$\nE_\\lambda^b(T) = \\frac{2\\pi h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1},\n$$\nwhere $h$ is Planck's constant, $c$ is the speed of light in vacuum, $k_{\\mathrm{B}}$ is Boltzmann's constant, $\\lambda$ is the wavelength, and $T$ is the absolute temperature. The total blackbody emissive power is $\\sigma T^4$, where $\\sigma$ is the Stefan–Boltzmann constant.\n\nDefine the spectrally resolved net radiative heat flux from the surface at temperature $T_s$ to an environment at temperature $T_e$ and unit view factor as\n$$\nq_{\\text{spec}}(T_s,T_e) = \\int_{0}^{\\infty} \\alpha_\\lambda \\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda.\n$$\nA gray-body model replaces the spectral dependence by a single wavelength-independent quantity $\\epsilon_g = \\alpha_g$. To fit $\\alpha_g$, use a Planck-weighted definition at a specified reference temperature $T_{\\text{ref}}$:\n$$\n\\alpha_g(T_{\\text{ref}}) = \\frac{\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4}.\n$$\nThe corresponding gray-body net flux prediction is\n$$\nq_{\\text{gray}}(T_s,T_e;T_{\\text{ref}}) = \\alpha_g(T_{\\text{ref}})\\,\\sigma\\left(T_s^4 - T_e^4\\right).\n$$\n\nYour task is to implement a complete program that:\n- Computes $q_{\\text{spec}}$ and $q_{\\text{gray}}$ and quantifies the error introduced by the gray-body assumption for a set of synthetic materials with specified $\\alpha_\\lambda$ and a set of $(T_s,T_e)$ pairs.\n- Uses numerical quadrature over wavelength to evaluate the required integrals.\n- Reports, for each test case, the relative error defined as\n$$\n\\delta = \n\\begin{cases}\n\\dfrac{q_{\\text{gray}} - q_{\\text{spec}}}{q_{\\text{spec}}}, & \\text{if } q_{\\text{spec}} \\neq 0, \\\\\n0.0, & \\text{if } q_{\\text{spec}} = 0.\n\\end{cases}\n$$\nThis relative error must be reported as a dimensionless decimal number. Internally, all fluxes must be computed in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n\nUse the following synthetic materials and test suite. For all cases, use the same wavelength domain $\\lambda \\in [2\\times 10^{-7},\\,1\\times 10^{-4}]\\,\\mathrm{m}$ and a numerically appropriate wavelength discretization.\n\nSynthetic materials:\n1. Material $\\mathcal{M}_1$ (shortwave-dominant absorption): \n$$\n\\alpha_\\lambda =\n\\begin{cases}\n0.95, & \\lambda \\le 2.5\\times 10^{-6}\\,\\mathrm{m},\\\\\n0.10, & \\lambda > 2.5\\times 10^{-6}\\,\\mathrm{m}.\n\\end{cases}\n$$\n2. Material $\\mathcal{M}_2$ (mid-to-longwave rise):\n$$\n\\alpha_\\lambda =\n\\begin{cases}\n0.20, & \\lambda \\le 3\\times 10^{-6}\\,\\mathrm{m},\\\\\n0.20 + 0.70\\,\\dfrac{\\lambda - 3\\times 10^{-6}}{7\\times 10^{-6}}, & 3\\times 10^{-6} < \\lambda < 1\\times 10^{-5}\\,\\mathrm{m},\\\\\n0.90, & \\lambda \\ge 1\\times 10^{-5}\\,\\mathrm{m}.\n\\end{cases}\n$$\n3. Material $\\mathcal{M}_3$ (gray baseline): \n$$\n\\alpha_\\lambda = 0.60, \\quad \\text{for all } \\lambda.\n$$\n\nReference temperature for gray-body fitting:\n- $T_{\\text{ref}} = 1200\\,\\mathrm{K}$.\n\nTest suite (each case is a triple $(\\text{material}, T_s, T_e)$):\n- Case A: $(\\mathcal{M}_1,\\,1200\\,\\mathrm{K},\\,300\\,\\mathrm{K})$.\n- Case B (boundary): $(\\mathcal{M}_1,\\,1200\\,\\mathrm{K},\\,1200\\,\\mathrm{K})$.\n- Case C (sign reversal): $(\\mathcal{M}_1,\\,600\\,\\mathrm{K},\\,1200\\,\\mathrm{K})$.\n- Case D (high $T_s$): $(\\mathcal{M}_2,\\,1500\\,\\mathrm{K},\\,300\\,\\mathrm{K})$.\n- Case E (low $T_s$): $(\\mathcal{M}_2,\\,600\\,\\mathrm{K},\\,300\\,\\mathrm{K})$.\n- Case F (gray baseline): $(\\mathcal{M}_3,\\,1000\\,\\mathrm{K},\\,300\\,\\mathrm{K})$.\n\nYour program should produce a single line of output containing the relative errors for Cases A–F, in that order, as a comma-separated list enclosed in square brackets (e.g., \"[errA,errB,errC,errD,errE,errF]\"). The entries must be plain decimal numbers. All internal calculations must use the constants $h$, $c$, $k_{\\mathrm{B}}$, and $\\sigma$ in SI units, temperatures in $\\mathrm{K}$, wavelengths in $\\mathrm{m}$, and fluxes in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.",
            "solution": "The computation begins from first principles that connect spectral properties to total radiative exchange. Kirchhoff's law of thermal radiation states that under thermodynamic equilibrium the spectral emissivity equals the spectral absorptivity, i.e., $\\epsilon_\\lambda = \\alpha_\\lambda$. This allows modeling emission and absorption consistently with the same spectral function.\n\nThe spectral density of hemispherical blackbody emissive power per unit wavelength is provided by Planck's law,\n$$\nE_\\lambda^b(T) = \\frac{2\\pi h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1}.\n$$\nThis is derived from quantum statistics for photons and angular integration of spectral radiance over a hemisphere. The total blackbody emissive power is linked to this spectrum via\n$$\n\\int_0^\\infty E_\\lambda^b(T)\\,\\mathrm{d}\\lambda = \\sigma T^4,\n$$\nwhere $\\sigma$ is the Stefan–Boltzmann constant.\n\nFor a surface with spectral absorptivity $\\alpha_\\lambda$ exchanging radiation with a large isothermal environment, the net hemispherical radiative heat flux is obtained by integrating the difference between emission from the surface and absorption of irradiation from the environment, weighted by the spectral absorptivity,\n$$\nq_{\\text{spec}}(T_s,T_e) = \\int_{0}^{\\infty} \\alpha_\\lambda\\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda.\n$$\nThis expression directly follows from the definition of net exchange and Kirchhoff's law ensuring that emission from the surface uses the same spectral function $\\alpha_\\lambda$ that governs absorption.\n\nA gray-body model, which approximates the wavelength dependence by a constant $\\epsilon_g = \\alpha_g$, is commonly employed to simplify computations. To make this approximation physically meaningful, we define $\\alpha_g$ as a Planck-mean at a reference temperature $T_{\\text{ref}}$, chosen to represent conditions under which the material's emission is most critical. Specifically,\n$$\n\\alpha_g(T_{\\text{ref}}) = \\frac{\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4}.\n$$\nThis choice ensures that the total emission at $T_{\\text{ref}}$ from the gray model matches the total emission from the spectral model:\n$$\n\\int_{0}^{\\infty} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda = \\alpha_g(T_{\\text{ref}})\\,\\sigma T_{\\text{ref}}^4.\n$$\nHowever, when temperatures differ from $T_{\\text{ref}}$, or when net exchange includes absorption from an environment at a different temperature, mismatches occur because the Planck distribution shifts with temperature and the shape of $\\alpha_\\lambda$ preferentially weights different wavelength bands. These mismatches quantify the error introduced by the gray assumption.\n\nAlgorithmic design:\n1. Define the physical constants $h$, $c$, $k_{\\mathrm{B}}$, and $\\sigma$ in SI units.\n2. Discretize the wavelength domain $\\lambda \\in [2\\times 10^{-7},\\,1\\times 10^{-4}]\\,\\mathrm{m}$ using a logarithmic grid to capture orders of magnitude differences and accurately resolve the temperature-dependent peak of $E_\\lambda^b(T)$ for temperatures in the test suite. A sufficiently dense grid, such as several thousand points, provides numerical stability for quadrature.\n3. Implement $E_\\lambda^b(T)$ using the stated Planck formula. For numerical robustness, compute the exponential term $\\exp(hc/(\\lambda k_{\\mathrm{B}} T))$ with care to avoid overflow, for instance by clipping its argument to a large finite bound. The spectrum is computed for each grid point and temperature.\n4. Implement the synthetic $\\alpha_\\lambda$ for materials $\\mathcal{M}_1$, $\\mathcal{M}_2$, and $\\mathcal{M}_3$ as specified. For piecewise definitions, ensure continuity at segment boundaries.\n5. Compute $\\alpha_g(T_{\\text{ref}})$ via numerical quadrature:\n$$\n\\alpha_g(T_{\\text{ref}}) \\approx \\frac{\\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} \\alpha_\\lambda\\, E_\\lambda^b(T_{\\text{ref}})\\,\\mathrm{d}\\lambda}{\\sigma T_{\\text{ref}}^4},\n$$\nusing the same wavelength grid. The trapezoidal rule over a logarithmic grid is acceptable because integration is with respect to $\\lambda$; the trapezoidal rule consistently accounts for the variable spacing.\n6. For each test case $(\\text{material},T_s,T_e)$, compute\n$$\nq_{\\text{spec}} \\approx \\int_{\\lambda_{\\min}}^{\\lambda_{\\max}} \\alpha_\\lambda\\left[E_\\lambda^b(T_s) - E_\\lambda^b(T_e)\\right]\\,\\mathrm{d}\\lambda,\n$$\nand\n$$\nq_{\\text{gray}} = \\alpha_g(T_{\\text{ref}})\\,\\sigma\\left(T_s^4 - T_e^4\\right).\n$$\n7. Compute the relative error\n$$\n\\delta =\n\\begin{cases}\n\\dfrac{q_{\\text{gray}} - q_{\\text{spec}}}{q_{\\text{spec}}}, & \\text{if } q_{\\text{spec}} \\neq 0, \\\\\n0.0, & \\text{if } q_{\\text{spec}} = 0.\n\\end{cases}\n$$\nThis dimensionless metric isolates the discrepancy introduced by using a constant $\\alpha_g$ in place of the true spectral $\\alpha_\\lambda$.\n8. Aggregate the relative errors for Cases A–F into a single list and print it in the prescribed format.\n\nScientific interpretation of the test suite:\n- Case A uses $\\mathcal{M}_1$ with $T_s = T_{\\text{ref}}$ and a cooler environment. The emission part is matched at $T_{\\text{ref}}$, but absorption from the environment is weighted by $E_\\lambda^b(T_e)$, not $E_\\lambda^b(T_{\\text{ref}})$, introducing error.\n- Case B is a boundary where $T_s = T_e$, so $q_{\\text{spec}} = 0$ by symmetry; the relative error is defined as $0.0$.\n- Case C inverts the temperature ordering ($T_s < T_e$), producing negative net flux; the gray fit at $T_{\\text{ref}}$ misweights the incoming spectrum, often increasing error magnitude.\n- Cases D and E use $\\mathcal{M}_2$ whose absorptivity emphasizes mid-to-long wavelengths. When $T_s$ is high (Case D), the Planck peak shifts to shorter wavelengths, reducing overlap with high-$\\alpha_\\lambda$ bands and amplifying gray-model mismatch. At lower $T_s$ (Case E), the Planck peak is closer to the high-$\\alpha_\\lambda$ region, typically reducing error.\n- Case F is a gray baseline where $\\alpha_\\lambda$ is constant; the gray-body model becomes exact, and the error should be near machine-level numerical zero.\n\nAll fluxes are computed in $\\mathrm{W}\\,\\mathrm{m}^{-2}$; the program outputs only the dimensionless relative errors as a single bracketed list of decimal numbers, adhering to the specified format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI units)\nh = 6.62607015e-34       # Planck constant, J*s\nc = 2.99792458e8         # Speed of light, m/s\nk_B = 1.380649e-23       # Boltzmann constant, J/K\nsigma = 5.670374419e-8   # Stefan-Boltzmann constant, W/(m^2*K^4)\n\ndef planck_hemispherical_E_lambda(T, lam):\n    \"\"\"\n    Hemispherical blackbody spectral emissive power per unit wavelength E_lambda^b(T).\n    Uses Planck's law: E_lambda^b(T) = (2*pi*h*c^2)/lam^5 * 1/(exp(h*c/(lam*k_B*T)) - 1)\n    Returns array with same shape as lam, units W/m^3.\n    \"\"\"\n    # Avoid division by zero or invalid values at T=0\n    if T <= 0.0:\n        return np.zeros_like(lam)\n    x = (h * c) / (lam * k_B * T)\n    # Clip exponent argument to avoid overflow in exp for very small lam\n    x = np.clip(x, 1e-12, 700.0)\n    denom = np.exp(x) - 1.0\n    # Where denom underflows to 0, set to np.inf to yield zero spectral power\n    denom = np.where(denom == 0.0, np.inf, denom)\n    E = (2.0 * np.pi * h * c**2) / (lam**5 * denom)\n    return E\n\ndef alpha_M1(lam):\n    \"\"\"\n    Synthetic material M1: shortwave-dominant absorption.\n    alpha_lambda = 0.95 for lambda <= 2.5e-6 m, else 0.10\n    \"\"\"\n    return np.where(lam <= 2.5e-6, 0.95, 0.10)\n\ndef alpha_M2(lam):\n    \"\"\"\n    Synthetic material M2: mid-to-longwave rise.\n    alpha_lambda =\n        0.20, for lambda <= 3e-6 m\n        linear from 0.20 at 3e-6 to 0.90 at 1e-5 m, for 3e-6 < lambda < 1e-5 m\n        0.90, for lambda >= 1e-5 m\n    \"\"\"\n    a = np.empty_like(lam)\n    a.fill(0.20)\n    mask_mid = (lam > 3e-6) & (lam < 1e-5)\n    # Linear interpolation between 0.20 and 0.90 over [3e-6, 1e-5]\n    a[mask_mid] = 0.20 + 0.70 * (lam[mask_mid] - 3e-6) / (7e-6)\n    a[lam >= 1e-5] = 0.90\n    return a\n\ndef alpha_M3(lam):\n    \"\"\"\n    Synthetic material M3: gray baseline.\n    alpha_lambda = 0.60 for all lambda\n    \"\"\"\n    return np.full_like(lam, 0.60)\n\ndef compute_alpha_g(alpha_func, lam, T_ref):\n    \"\"\"\n    Compute gray absorptivity alpha_g(T_ref) via Planck-weighted mean:\n    alpha_g = (integral alpha_lambda * E_lambda^b(T_ref) d lambda) / (sigma * T_ref^4)\n    \"\"\"\n    E_ref = planck_hemispherical_E_lambda(T_ref, lam)\n    alpha_vals = alpha_func(lam)\n    num = np.trapz(alpha_vals * E_ref, lam)\n    denom = sigma * T_ref**4\n    return num / denom\n\ndef compute_q_spec(alpha_func, lam, T_s, T_e):\n    \"\"\"\n    Compute spectral net flux:\n    q_spec = integral alpha_lambda * (E_lambda^b(T_s) - E_lambda^b(T_e)) d lambda\n    \"\"\"\n    E_s = planck_hemispherical_E_lambda(T_s, lam)\n    E_e = planck_hemispherical_E_lambda(T_e, lam)\n    alpha_vals = alpha_func(lam)\n    integrand = alpha_vals * (E_s - E_e)\n    return np.trapz(integrand, lam)\n\ndef solve():\n    # Wavelength grid: logarithmically spaced from 2e-7 m to 1e-4 m\n    lam_min = 2e-7\n    lam_max = 1e-4\n    # Use sufficient resolution for numerical stability\n    lam = np.logspace(np.log10(lam_min), np.log10(lam_max), num=5000)\n\n    # Reference temperature for gray-body fitting\n    T_ref = 1200.0  # K\n\n    # Map material names to functions\n    materials = {\n        \"M1\": alpha_M1,\n        \"M2\": alpha_M2,\n        \"M3\": alpha_M3,\n    }\n\n    # Define test cases: (material_key, T_s, T_e)\n    test_cases = [\n        (\"M1\", 1200.0, 300.0),  # Case A\n        (\"M1\", 1200.0, 1200.0), # Case B\n        (\"M1\", 600.0, 1200.0),  # Case C\n        (\"M2\", 1500.0, 300.0),  # Case D\n        (\"M2\", 600.0, 300.0),   # Case E\n        (\"M3\", 1000.0, 300.0),  # Case F\n    ]\n\n    results = []\n    for mat_key, T_s, T_e in test_cases:\n        alpha_func = materials[mat_key]\n        # Fit gray absorptivity at reference temperature\n        alpha_g = compute_alpha_g(alpha_func, lam, T_ref)\n        # Compute spectral net flux\n        q_spec = compute_q_spec(alpha_func, lam, T_s, T_e)\n        # Compute gray net flux\n        q_gray = alpha_g * sigma * (T_s**4 - T_e**4)\n        # Relative error\n        if q_spec != 0.0:\n            rel_err = (q_gray - q_spec) / q_spec\n        else:\n            rel_err = 0.0\n        results.append(rel_err)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Moving beyond surface phenomena, this practice delves into the fundamental physics of radiation transport within participating media, such as flames, atmospheres, or astrophysical gases. Here, Kirchhoff's law is expressed in its volumetric form, relating the spectral emission coefficient $ j_\\lambda $ to the absorption coefficient $ \\kappa_\\lambda $ via the Planck function, $ j_\\lambda = \\kappa_\\lambda B_\\lambda(T) $, under conditions of Local Thermodynamic Equilibrium (LTE). You will derive and implement a robust numerical scheme for the Radiative Transfer Equation (RTE) that incorporates this law . By simulating a closed, isothermal cavity, you will perform a critical validation test: verifying that your solver correctly converges to the uniform blackbody radiation field predicted by theory, a cornerstone benchmark for any advanced radiative transfer code.",
            "id": "3966159",
            "problem": "Consider a one-dimensional, plane-parallel, closed cavity of physical length $L$ filled with a spatially uniform, non-scattering, absorbing-emitting medium in Local Thermodynamic Equilibrium (LTE). The cavity is bounded by two black, isothermal walls at position $s=0$ and $s=L$, both maintained at the same temperature $T$. The spectral wavelength is denoted by $\\lambda$. The radiative transfer equation (RTE) for the spectral radiative intensity $I_\\lambda(s,\\mu)$ along a straight characteristic with direction cosine $\\mu \\in \\{-1,+1\\}$ reduces, in steady state and without scattering, to the ordinary differential equation\n$$\\frac{d I_\\lambda}{d s} = -\\kappa_\\lambda I_\\lambda + j_\\lambda,$$\nwhere $\\kappa_\\lambda$ is the spectral absorption coefficient and $j_\\lambda$ is the spectral emission coefficient. By Kirchhoff’s law of thermal radiation in LTE, emission and absorption are related point-wise by\n$$j_\\lambda = \\kappa_\\lambda B_\\lambda(T),$$\nwhere $B_\\lambda(T)$ is the spectral Planck blackbody intensity given by\n$$B_\\lambda(T) = \\frac{2 h c^2}{\\lambda^5} \\left[\\exp\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1\\right]^{-1},$$\nwith $h$ the Planck constant, $c$ the speed of light in vacuum, and $k_{\\mathrm{B}}$ the Boltzmann constant. All quantities are in the International System of Units (SI): $\\lambda$ in $\\mathrm{m}$, $T$ in $\\mathrm{K}$, $\\kappa_\\lambda$ in $\\mathrm{m}^{-1}$, $s$ and $L$ in $\\mathrm{m}$, and $I_\\lambda$ and $B_\\lambda$ in $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{sr}^{-1}$.\n\nYour task is to:\n1. Starting from the RTE and Kirchhoff’s law stated above, derive a numerically stable, first-order cell-to-cell update scheme for marching the solution for $I_\\lambda$ across a uniform spatial grid of $N$ cells of size $\\Delta s = L/N$. The scheme must be expressed in terms of the known local values of $\\kappa_\\lambda$ and $B_\\lambda(T)$ and must enforce the LTE relation $j_\\lambda=\\kappa_\\lambda B_\\lambda(T)$ exactly at the discretization level.\n2. Impose black, isothermal boundary conditions at both ends of the cavity: $I_\\lambda(0,\\mu=+1) = B_\\lambda(T)$ and $I_\\lambda(L,\\mu=-1) = B_\\lambda(T)$.\n3. Implement the derived scheme in a complete program that computes the directional intensities $I_\\lambda$ for $\\mu=+1$ and $\\mu=-1$ along the grid for several parameter sets.\n4. Validate radiative equilibrium for the closed cavity by checking that the numerical solution converges to the blackbody field everywhere, i.e., $I_\\lambda(s,\\mu) \\to B_\\lambda(T)$, by computing the maximum relative deviation\n$$\\varepsilon = \\max_{i,\\mu} \\left|\\frac{I_{\\lambda,i}^{(\\mu)} - B_\\lambda(T)}{B_\\lambda(T)}\\right|,$$\nand reporting for each test case whether $\\varepsilon \\le \\tau$, with a prescribed tolerance $\\tau$.\n\nUse the following test suite of parameter values, each expressed in SI units:\n- Test case $1$: $\\lambda = 1.0\\times 10^{-6}\\,\\mathrm{m}$, $T=1200\\,\\mathrm{K}$, $\\kappa_\\lambda=10\\,\\mathrm{m}^{-1}$, $L=0.1\\,\\mathrm{m}$, $N=50$.\n- Test case $2$: $\\lambda = 5.0\\times 10^{-6}\\,\\mathrm{m}$, $T=300\\,\\mathrm{K}$, $\\kappa_\\lambda=1000\\,\\mathrm{m}^{-1}$, $L=0.1\\,\\mathrm{m}$, $N=20$.\n- Test case $3$: $\\lambda = 5.0\\times 10^{-7}\\,\\mathrm{m}$, $T=5800\\,\\mathrm{K}$, $\\kappa_\\lambda=0\\,\\mathrm{m}^{-1}$, $L=1.0\\,\\mathrm{m}$, $N=100$.\n- Test case $4$: $\\lambda = 1.0\\times 10^{-5}\\,\\mathrm{m}$, $T=1000\\,\\mathrm{K}$, $\\kappa_\\lambda=1.0\\times 10^{-3}\\,\\mathrm{m}^{-1}$, $L=1000\\,\\mathrm{m}$, $N=100$.\n- Test case $5$: $\\lambda = 2.0\\times 10^{-6}\\,\\mathrm{m}$, $T=1000\\,\\mathrm{K}$, $\\kappa_\\lambda=10\\,\\mathrm{m}^{-1}$, $L=0.01\\,\\mathrm{m}$, $N=1$.\n\nSet the validation tolerance to $\\tau = 1.0\\times 10^{-12}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases, where each entry is a boolean indicating whether equilibrium was validated, i.e., $\\varepsilon \\le \\tau$, for that test case (for example, $[{\\text{True}},{\\text{False}},{\\text{True}}]$).",
            "solution": "The problem statement is a valid, well-posed problem in the field of computational radiative transfer. It is scientifically grounded, self-contained, and free of any contradictions or ambiguities. The task is to derive and implement a numerical scheme to solve the radiative transfer equation (RTE) for a benchmark case of a one-dimensional, isothermal, closed cavity in local thermodynamic equilibrium (LTE), and to verify that the numerical solution correctly converges to the known analytical solution.\n\nThe core of the problem lies in the derivation of a numerically stable discretization of the RTE and its careful implementation to achieve high precision, as indicated by the strict validation tolerance.\n\n**1. Governing Equations and Analytical Solution**\n\nThe steady-state, one-dimensional RTE for a non-scattering, absorbing-emitting medium is given as:\n$$\n\\frac{d I_\\lambda}{d s} = -\\kappa_\\lambda I_\\lambda + j_\\lambda\n$$\nwhere $I_\\lambda(s, \\mu)$ is the spectral radiative intensity at position $s$ along a direction with cosine $\\mu$, $\\kappa_\\lambda$ is the spectral absorption coefficient, and $j_\\lambda$ is the spectral emission coefficient. For a medium in LTE, Kirchhoff's law relates emission to absorption via the Planck blackbody function $B_\\lambda(T)$:\n$$\nj_\\lambda = \\kappa_\\lambda B_\\lambda(T)\n$$\nSubstituting Kirchhoff's law into the RTE and explicitly including the directional dependence yields:\n$$\n\\mu \\frac{d I_\\lambda(s, \\mu)}{ds} = -\\kappa_\\lambda I_\\lambda(s, \\mu) + \\kappa_\\lambda B_\\lambda(T)\n$$\nThe problem describes a closed cavity bounded by black walls at $s=0$ and $s=L$, both at a uniform temperature $T$. The medium filling the cavity is also at this same uniform temperature $T$. Under these conditions of complete thermodynamic equilibrium, the radiation field inside the cavity must be the isotropic, homogeneous blackbody radiation field at temperature $T$. The analytical solution is therefore:\n$$\nI_\\lambda(s, \\mu) = B_\\lambda(T) \\quad \\forall s \\in [0, L], \\mu \\in \\{-1, +1\\}\n$$\nThe numerical task is to show that a properly formulated scheme recovers this exact solution to within machine precision.\n\n**2. Derivation of the First-Order Numerical Scheme**\n\nA stable, first-order numerical scheme can be derived from the formal solution of the RTE over a single grid cell. Let the spatial domain $[0, L]$ be discretized into $N$ uniform cells of width $\\Delta s = L/N$. The grid nodes are at positions $s_i = i \\Delta s$ for $i = 0, 1, \\dots, N$.\n\nFirst, consider the forward-propagating radiation in the direction $\\mu=+1$. The RTE is:\n$$\n\\frac{d I_\\lambda}{ds} = -\\kappa_\\lambda (I_\\lambda - B_\\lambda(T))\n$$\nThis is a first-order linear ordinary differential equation. We solve it over a single cell, from $s_i$ to $s_{i+1}$, assuming $\\kappa_\\lambda$ and $T$ (and thus $B_\\lambda(T)$) are constant within the cell. The solution is found using an integrating factor $e^{\\kappa_\\lambda s}$:\n$$\n\\frac{d}{ds}(I_\\lambda e^{\\kappa_\\lambda s}) = \\kappa_\\lambda B_\\lambda(T) e^{\\kappa_\\lambda s}\n$$\nIntegrating from $s_i$ to $s_{i+1}$:\n$$\n\\int_{s_i}^{s_{i+1}} \\frac{d}{ds'}(I_\\lambda e^{\\kappa_\\lambda s'}) ds' = \\int_{s_i}^{s_{i+1}} \\kappa_\\lambda B_\\lambda(T) e^{\\kappa_\\lambda s'} ds'\n$$\n$$\nI_{\\lambda,i+1} e^{\\kappa_\\lambda s_{i+1}} - I_{\\lambda,i} e^{\\kappa_\\lambda s_i} = B_\\lambda(T) [e^{\\kappa_\\lambda s'}]_{s_i}^{s_{i+1}}\n$$\n$$\nI_{\\lambda,i+1} e^{\\kappa_\\lambda s_{i+1}} - I_{\\lambda,i} e^{\\kappa_\\lambda s_i} = B_\\lambda(T) (e^{\\kappa_\\lambda s_{i+1}} - e^{\\kappa_\\lambda s_i})\n$$\nSolving for $I_{\\lambda,i+1}$, the intensity at the downwind face of the cell, we get:\n$$\nI_{\\lambda,i+1} = I_{\\lambda,i} e^{-\\kappa_\\lambda(s_{i+1}-s_i)} + B_\\lambda(T) (1 - e^{-\\kappa_\\lambda(s_{i+1}-s_i)})\n$$\nLet $\\Delta \\tau_\\lambda = \\kappa_\\lambda \\Delta s$ be the optical thickness of the cell. The cell-to-cell update scheme for $\\mu=+1$ is:\n$$\nI_{\\lambda,i+1}^{(+1)} = I_{\\lambda,i}^{(+1)} e^{-\\Delta \\tau_\\lambda} + B_\\lambda(T) (1 - e^{-\\Delta \\tau_\\lambda})\n$$\nThis scheme is used to march the solution from the boundary at $s=0$ to $s=L$. The boundary condition is $I_{\\lambda,0}^{(+1)} = I_\\lambda(0, \\mu=+1) = B_\\lambda(T)$.\n\nFor the backward-propagating radiation ($\\mu=-1$), the RTE is:\n$$\n-\\frac{d I_\\lambda}{ds} = -\\kappa_\\lambda (I_\\lambda - B_\\lambda(T)) \\implies \\frac{d I_\\lambda}{ds} = \\kappa_\\lambda (I_\\lambda - B_\\lambda(T))\n$$\nThe natural marching direction is from $s=L$ to $s=0$. The formal solution is derived over a cell from $s_{i-1}$ to $s_i$. The upwind intensity is at $s_i$ and the downwind intensity is at $s_{i-1}$. Following a similar derivation, the update rule is structurally identical:\n$$\nI_{\\lambda,i-1}^{(-1)} = I_{\\lambda,i}^{(-1)} e^{-\\Delta \\tau_\\lambda} + B_\\lambda(T) (1 - e^{-\\Delta \\tau_\\lambda})\n$$\nThis scheme is used to march from the boundary at $s=L$ where $I_{\\lambda,N}^{(-1)} = I_\\lambda(L, \\mu=-1) = B_\\lambda(T)$, down to $s=0$.\n\nThis formulation is known as the formal solver or integrating factor method and is guaranteed to be numerically stable, as the attenuation factor $e^{-\\Delta \\tau_\\lambda}$ is bounded between $0$ and $1$ for any non-negative optical depth $\\Delta \\tau_\\lambda \\ge 0$.\n\n**3. Numerically Robust Implementation**\n\nThe small tolerance $\\tau=1.0 \\times 10^{-12}$ requires careful implementation to avoid loss of precision from floating-point arithmetic. A key issue arises in the term $(1 - e^{-x})$ when $x = \\Delta \\tau_\\lambda$ is very small. This involves the subtraction of two nearly equal numbers, leading to catastrophic cancellation.\n\nTo maintain precision, we can use a library function that accurately computes $e^y-1$ for small $y$. In Python, `numpy.expm1(y)` serves this purpose. We can rewrite the update scheme as:\n$$\nI_{out} = I_{in} e^{-\\Delta \\tau_\\lambda} - B_\\lambda(T) \\cdot \\mathrm{expm1}(-\\Delta \\tau_\\lambda)\n$$\nwhere `expm1(-Δτ)` calculates $e^{-\\Delta\\tau_\\lambda} - 1$. An even more robust formulation can be obtained by algebraic rearrangement:\n$$\nI_{out} = I_{in} + (I_{in} - B_\\lambda(T))(e^{-\\Delta \\tau_\\lambda} - 1) = I_{in} + (I_{in} - B_\\lambda(T)) \\cdot \\mathrm{expm1}(-\\Delta \\tau_\\lambda)\n$$\nThis form is exceptionally stable for the present problem. Since the boundary conditions and the medium properties ensure that the incoming intensity $I_{in}$ should be equal to $B_\\lambda(T)$, the term $(I_{in} - B_\\lambda(T))$ will be zero (or very close to it, due to representation error). This minimizes the propagation of floating-point errors across the grid, ensuring that if $I_{in} = B_\\lambda(T)$, then $I_{out} = B_\\lambda(T)$ to the limits of machine precision. This is crucial for satisfying the strict validation tolerance.\n\nSpecial case: If $\\kappa_\\lambda = 0$, then $\\Delta \\tau_\\lambda = 0$. The `expm1(0)` function returns $0$, and the scheme correctly reduces to $I_{out} = I_{in}$, representing loss-less propagation through a transparent medium.\n\n**4. Algorithmic Procedure**\n\nThe overall algorithm for each test case is as follows:\n1.  **Initialization**: Given $\\lambda, T, \\kappa_\\lambda, L, N$, calculate the physical constants $h, c, k_B$ and compute the Planck function $B_\\lambda(T)$. Calculate the grid spacing $\\Delta s = L/N$ and the cell optical thickness $\\Delta \\tau_\\lambda = \\kappa_\\lambda \\Delta s$.\n2.  **Grid Setup**: Create two one-dimensional arrays of size $N+1$, `I_plus` and `I_minus`, to store the intensities $I_{\\lambda,i}^{(+1)}$ and $I_{\\lambda,i}^{(-1)}$ at the $N+1$ grid nodes.\n3.  **Forward Sweep ($\\mu=+1$)**:\n    a. Apply the boundary condition at $s=0$: `I_plus[0] = B_\\lambda`$(T)$.\n    b. March from $i=0$ to $N-1$, applying the robust update scheme to compute `I_plus[i+1]` from `I_plus[i]`.\n4.  **Backward Sweep ($\\mu=-1$)**:\n    a. Apply the boundary condition at $s=L$: `I_minus[N] = B_\\lambda`$(T)$.\n    b. March from $i=N$ down to $1$, applying the same update scheme to compute `I_minus[i-1]` from `I_minus[i]`.\n5.  **Validation**:\n    a. Combine all computed intensities from `I_plus` and `I_minus` into a single collection.\n    b. Compute the maximum absolute error: $\\Delta_{\\max} = \\max |I_{\\lambda,i}^{(\\mu)} - B_\\lambda(T)|$.\n    c. Compute the maximum relative deviation: $\\varepsilon = \\Delta_{\\max} / |B_\\lambda(T)|$.\n    d. Check if $\\varepsilon \\le \\tau$, where $\\tau = 1.0 \\times 10^{-12}$. The result is a boolean value (True or False).\n\nThis procedure, when implemented, will test whether the derived numerical scheme accurately reproduces the state of radiative equilibrium for the provided set of parameters. Given the exactness of the formal solution and the robust implementation, all test cases are expected to pass this validation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.constants import h, c, k as k_B\n\ndef solve():\n    \"\"\"\n    Derives and implements a numerical scheme for the 1D Radiative Transfer Equation\n    in an isothermal closed cavity and validates the solution against the analytical\n    result for several test cases.\n    \"\"\"\n\n    # Prescribed validation tolerance.\n    TOLERANCE = 1.0e-12\n\n    # Define the test cases from the problem statement (SI units).\n    # Each case is a tuple: (lambda, T, kappa_lambda, L, N)\n    test_cases = [\n        (1.0e-6, 1200.0, 10.0, 0.1, 50),\n        (5.0e-6, 300.0, 1000.0, 0.1, 20),\n        (5.0e-7, 5800.0, 0.0, 1.0, 100),\n        (1.0e-5, 1000.0, 1.0e-3, 1000.0, 100),\n        (2.0e-6, 1000.0, 10.0, 0.01, 1),\n    ]\n\n    results = []\n    for case in test_cases:\n        lam, T, kappa, L, N = case\n        \n        # 1. Calculate the Planck blackbody intensity B_lambda(T).\n        # B_lambda(T) = (2 * h * c^2 / lambda^5) / (exp(h*c / (lambda*k_B*T)) - 1)\n        # The argument to exp() can be large, but within standard double precision range.\n        # No underflow/overflow is expected for the given test cases.\n        exponent_arg = (h * c) / (lam * k_B * T)\n        try:\n            planck_B = (2.0 * h * c**2 / lam**5) / np.expm1(exponent_arg)\n        except FloatingPointError: # Handles potential overflow in expm1 if arg is huge.\n            planck_B = 0.0\n        \n        # If B_lambda is zero, the relative error is undefined. However, for these\n        # test cases, B_lambda is always non-zero. This check is for robustness.\n        if planck_B == 0.0:\n            # If B=0, and BC is B=0, I should be 0 everywhere. Abs error is used.\n            # This path is not taken by the current test suite.\n            # In general, if B=0, one would check absolute error. Here, we can assume\n            # failure if B=0 as the test expects non-trivial radiation fields.\n            results.append(False) # Should not happen for problem's data\n            continue\n\n        # 2. Set up the grid and calculate cell optical thickness.\n        if N > 0:\n            delta_s = L / N\n        else: # Should not happen based on test cases\n            delta_s = L\n        \n        delta_tau = kappa * delta_s\n\n        # 3. Initialize intensity arrays for N+1 grid nodes.\n        # I_plus for mu=+1, I_minus for mu=-1.\n        I_plus = np.zeros(N + 1)\n        I_minus = np.zeros(N + 1)\n\n        # 4. Perform the marches using the robust formal solution.\n        # The update rule is: I_out = I_in + (I_in - B) * expm1(-delta_tau)\n        m = np.expm1(-delta_tau) # Calculate exp(-dtau)-1 once.\n\n        # Forward march for mu = +1 (from s=0 to s=L)\n        I_plus[0] = planck_B  # Boundary condition at s=0\n        for i in range(N):\n            I_in = I_plus[i]\n            I_plus[i+1] = I_in + (I_in - planck_B) * m\n\n        # Backward march for mu = -1 (from s=L to s=0)\n        I_minus[N] = planck_B  # Boundary condition at s=L\n        for i in range(N, 0, -1):\n            I_in = I_minus[i]\n            I_minus[i-1] = I_in + (I_in - planck_B) * m\n            \n        # 5. Validate radiative equilibrium.\n        # Combine all computed intensities.\n        all_intensities = np.concatenate((I_plus, I_minus))\n        \n        # Calculate the maximum relative deviation.\n        abs_errors = np.abs(all_intensities - planck_B)\n        max_abs_error = np.max(abs_errors)\n        max_rel_dev = max_abs_error / planck_B\n        \n        # Check against the tolerance.\n        is_equilibrium_validated = max_rel_dev <= TOLERANCE\n        results.append(is_equilibrium_validated)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, [r for r in results]))}]\")\n\nsolve()\n```"
        }
    ]
}