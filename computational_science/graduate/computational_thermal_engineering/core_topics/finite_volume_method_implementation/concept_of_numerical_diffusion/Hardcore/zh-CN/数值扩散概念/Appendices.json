{
    "hands_on_practices": [
        {
            "introduction": "这项基础练习旨在揭示数值扩散的数学根源。通过对一个简化的对流方程应用修正方程分析，我们将看到离散化过程如何引入一个与物理扩散项形式相同的人工项。这项练习不仅能培养分析任何有限差分格式所需的核心数学技能，还能为一阶迎风格式的数值扩散提供一个具体的量化公式。",
            "id": "3942223",
            "problem": "考虑一维空间中热标量场的纯平流问题，该问题由线性平流方程 $ \\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = 0 $ 描述，其中 $ \\theta(x,t) $ 是一个类温度的被动标量，$ a $ 是一个恒定的流速，$ x $ 和 $ t $ 分别表示空间和时间。该方程是计算流体动力学和计算热工学中对流输运的标准模型，其中 $ \\theta $ 在没有物理扩散的情况下被输运。\n\n将 $ x $ 在间距为 $ \\Delta x $ 的均匀网格上进行离散化，并以恒定的时间步长 $ \\Delta t $ 在时间上推进。对于 $ a  0 $ 的情况，使用一阶显式迎风格式（时间上为向前欧拉法，空间上为一阶迎风法），得到更新方程\n$$\n\\theta_{i}^{n+1} = \\theta_{i}^{n} - C \\left( \\theta_{i}^{n} - \\theta_{i-1}^{n} \\right),\n$$\n其中 $ \\theta_{i}^{n} $ 近似于 $ \\theta(x_i, t_n) $，Courant–Friedrichs–Lewy (CFL) 数定义为 $ C = \\frac{a \\Delta t}{\\Delta x} $，为保证稳定性，需满足 $ 0  C \\leq 1 $。\n\n仅使用泰勒展开和作为基本依据的控制连续介质平流方程，进行修正方程分析，以确定由该数值格式引入的主阶人工扩散。将有效数值扩散系数 $ \\nu_{\\text{num}} $ 定义为形式为\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = \\nu_{\\text{num}} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{高阶项}\n$$\n的主阶修正方程中 $ \\frac{\\partial^2 \\theta}{\\partial x^2} $ 项的系数，并将 $ \\nu_{\\text{num}} $ 表示为 $ a $、$ \\Delta x $ 和 CFL 数 $ C $ 的函数。请以包含 $ a $、$ \\Delta x $ 和 $ C $ 的单个闭式解析表达式的形式提供您的最终答案。不要进行数值计算。如果赋于数值，$ \\nu_{\\text{num}} $ 的物理单位将是平方米/秒，但您必须只提供符号表达式。",
            "solution": "该问题要求对一维线性平流方程的一阶显式迎风格式进行修正方程分析。目标是确定该数值方法所固有的（或内含的）人工扩散系数 $\\nu_{\\text{num}}$。\n\n控制连续介质方程是线性平流方程：\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = 0\n$$\n其中 $a > 0$ 是一个恒定速度。\n\n数值格式为一阶显式迎风法（对于 $a>0$，采用时间向前，空间向后的差分）：\n$$\n\\theta_{i}^{n+1} = \\theta_{i}^{n} - C \\left( \\theta_{i}^{n} - \\theta_{i-1}^{n} \\right)\n$$\n此处，$\\theta_{i}^{n}$ 是标量场 $\\theta$ 在位置 $x_i = i \\Delta x$ 和时间 $t_n = n \\Delta t$ 处的数值近似。Courant–Friedrichs–Lewy (CFL) 数为 $C = \\frac{a \\Delta t}{\\Delta x}$。\n\n分析首先将离散方程的每一项在点 $(x_i, t_n)$ 附近进行泰勒级数展开。我们假设 $\\theta(x,t)$ 足够光滑。所有导数均在点 $(x_i, t_n)$ 处求值。\n\n$\\theta_i^{n+1}$ 项在时间上展开为：\n$$\n\\theta_{i}^{n+1} = \\theta(x_i, t_n + \\Delta t) = \\theta_{i}^{n} + \\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\frac{(\\Delta t)^3}{6} \\frac{\\partial^3 \\theta}{\\partial t^3} + \\dots\n$$\n\n$\\theta_{i-1}^{n}$ 项在空间上展开为：\n$$\n\\theta_{i-1}^{n} = \\theta(x_i - \\Delta x, t_n) = \\theta_{i}^{n} - \\Delta x \\frac{\\partial \\theta}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 \\theta}{\\partial x^3} + \\dots\n$$\n\n将这些展开式代入数值格式，该格式可以重排为 $\\theta_i^{n+1} - \\theta_i^n = -C(\\theta_i^n - \\theta_{i-1}^n)$：\n$$\n\\left( \\theta_{i}^{n} + \\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots \\right) - \\theta_i^n = -C \\left[ \\theta_i^n - \\left( \\theta_{i}^{n} - \\Delta x \\frac{\\partial \\theta}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\dots \\right) \\right]\n$$\n\n简化两边：\n$$\n\\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots = -C \\left( \\Delta x \\frac{\\partial \\theta}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\dots \\right)\n$$\n$$\n\\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots = -C \\Delta x \\frac{\\partial \\theta}{\\partial x} + C \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\dots\n$$\n\n根据定义，$C = \\frac{a \\Delta t}{\\Delta x}$，这意味着 $C \\Delta x = a \\Delta t$。将此代入右侧第一项：\n$$\n\\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots = -a \\Delta t \\frac{\\partial \\theta}{\\partial x} + C \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\dots\n$$\n\n将整个方程除以 $\\Delta t$：\n$$\n\\frac{\\partial \\theta}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + O((\\Delta t)^2) = -a \\frac{\\partial \\theta}{\\partial x} + C \\frac{(\\Delta x)^2}{2 \\Delta t} \\frac{\\partial^2 \\theta}{\\partial x^2} - O(\\Delta x^2, \\Delta t \\Delta x)\n$$\n\n二阶空间导数项的系数可以简化为：\n$$\nC \\frac{(\\Delta x)^2}{2 \\Delta t} = \\left(\\frac{a \\Delta t}{\\Delta x}\\right) \\frac{(\\Delta x)^2}{2 \\Delta t} = \\frac{a \\Delta x}{2}\n$$\n\n将此代回并重排方程，以匹配原始偏微分方程的形式：\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = - \\frac{\\Delta t}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\frac{a \\Delta x}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}\n$$\n其中 H.O.T. 代表高阶项。这就是修正方程，但其右侧包含时间导数。为了将误差纯粹用空间导数表示，我们必须近似 $\\frac{\\partial^2 \\theta}{\\partial t^2}$。\n\n从原始连续介质方程可知，$\\frac{\\partial \\theta}{\\partial t} = -a \\frac{\\partial \\theta}{\\partial x}$。我们假设数值解是一个有效的近似，因此该关系在主阶上成立。我们可以对这个表达式关于时间 $t$ 求导：\n$$\n\\frac{\\partial^2 \\theta}{\\partial t^2} = \\frac{\\partial}{\\partial t} \\left(-a \\frac{\\partial \\theta}{\\partial x}\\right) = -a \\frac{\\partial}{\\partial x} \\left(\\frac{\\partial \\theta}{\\partial t}\\right)\n$$\n现在，再次代入 $\\frac{\\partial \\theta}{\\partial t} = -a \\frac{\\partial \\theta}{\\partial x}$：\n$$\n\\frac{\\partial^2 \\theta}{\\partial t^2} = -a \\frac{\\partial}{\\partial x} \\left(-a \\frac{\\partial \\theta}{\\partial x}\\right) = a^2 \\frac{\\partial^2 \\theta}{\\partial x^2}\n$$\n高阶时间导数可以类似地用高阶空间导数表示。对于本分析，我们只需要主阶项。\n\n将 $\\frac{\\partial^2 \\theta}{\\partial t^2} = a^2 \\frac{\\partial^2 \\theta}{\\partial x^2}$ 代入修正方程：\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = - \\frac{\\Delta t}{2} \\left(a^2 \\frac{\\partial^2 \\theta}{\\partial x^2}\\right) + \\frac{a \\Delta x}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}\n$$\n\n我们现在可以合并 $\\frac{\\partial^2 \\theta}{\\partial x^2}$ 项的系数：\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = \\left(\\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\\right) \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}\n$$\n\n此方程具有目标形式 $\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = \\nu_{\\text{num}} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}$，其中二阶空间导数的系数就是数值扩散系数 $\\nu_{\\text{num}}$。\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\n$$\n\n问题要求此表达式用 $a$, $\\Delta x$ 和 $C$ 来表示。我们提取公因式 $\\frac{a \\Delta x}{2}$：\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right)\n$$\n考虑到 $C = \\frac{a \\Delta t}{\\Delta x}$，我们得到最终表达式：\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} (1 - C)\n$$\n这个主阶截断误差项，其形式与物理扩散项相同，被称为数值扩散或人工粘性。它是一阶迎风格式具有耗散性的原因。在稳定范围 $0  C \\le 1$ 内，系数 $\\nu_{\\text{num}}$ 是非负的，这正确地表示了一个扩散过程。当且仅当 $C=1$ 时，扩散项消失，此时格式是精确的。",
            "answer": "$$\n\\boxed{\\frac{a \\Delta x}{2} (1 - C)}\n$$"
        },
        {
            "introduction": "在了解了迎风格式如何产生数值扩散之后，一个自然的问题是：我们能否使用更精确的中心差分格式来消除它？本练习将探讨使用中心差分格式的后果，揭示其在消除主导扩散误差的同时，会引入一种新的误差——数值色散。此外，我们将通过稳定性分析发现，这种数值耗散的缺失会导致格式的不稳定性，从而凸显了对流问题数值方法中的一个基本权衡。",
            "id": "3942275",
            "problem": "考虑由偏微分方程 $u_t + a u_x = 0$ 控制的一维被动热标量线性平流问题，其中 $u(x,t)$ 是标量场，$a0$ 是恒定的平流速度。使用间距为 $\\Delta x$ 的均匀空间网格。考虑两种显式有限差分空间离散化方法：\n\n1. 一种半离散空间中心差分格式，通过在网格点 $x_j$ 处用 $(u_{j+1} - u_{j-1})/(2 \\Delta x)$ 替换 $u_x$ 来定义，并结合显式向前时间积分。\n\n2. 一种适用于 $a0$ 的空间迎风格式，通过在网格点 $x_j$ 处用 $(u_j - u_{j-1})/\\Delta x$ 替换 $u_x$ 来定义，并结合显式向前时间积分。\n\n从精确方程 $u_t + a u_x = 0$ 出发，使用 $u(x \\pm \\Delta x, t)$ 在 $x$ 点的泰勒级数展开和傅里叶 (von Neumann) 分析来：\n\n- 通过将离散空间导数表示为连续空间导数的函数，推导每种空间离散化方法的主阶修正方程，并保留至 $\\mathcal{O}(\\Delta x^2)$ 阶的项。\n- 在修正方程中，识别并比较主人工扩散项（与 $u_{xx}$ 成正比的项）和主色散项（与 $u_{xxx}$ 成正比的项）。\n- 使用傅里叶分析，计算并解释全离散中心差分和迎风格式的放大因子。讨论中心差分相对于迎风格式在 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = a \\Delta t / \\Delta x$ 方面的稳定性含义。\n\n你的最终任务是提供一个单一的实数值：中心差分格式的主人工扩散系数 $D_{\\text{num}}$（定义为修正方程中 $u_{xx}$ 的系数）。将 $D_{\\text{num}}$ 的最终值以 $\\text{m}^2/\\text{s}$ 为单位表示。无需进行四舍五入。",
            "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n### 第1步：提取已知条件\n-   **控制方程**：被动标量 $u(x,t)$ 的一维线性平流方程为 $u_t + a u_x = 0$，其中 $a  0$ 是恒定的平流速度。\n-   **网格**：间距为 $\\Delta x$ 的均匀空间网格。\n-   **格式1（中心差分）**：一种半离散空间中心差分格式，其中网格点 $x_j$ 处的 $u_x$ 由 $\\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}$ 近似。对于全离散格式，此方法与显式向前时间积分相结合。\n-   **格式2（迎风格式）**：一种适用于 $a0$ 的空间迎风格式，其中网格点 $x_j$ 处的 $u_x$ 由 $\\frac{u_j - u_{j-1}}{\\Delta x}$ 近似。此方法也与显式向前时间积分相结合。\n-   **任务1**：为每种空间离散化方法推导主阶修正方程，保留至 $\\mathcal{O}(\\Delta x^2)$ 阶。\n-   **任务2**：识别并比较主人工扩散项（与 $u_{xx}$ 成正比）和色散项（与 $u_{xxx}$ 成正比）。\n-   **任务3**：对于全离散格式，使用傅里叶分析计算并解释放大因子，并讨论与 CFL 数 $\\nu = a \\Delta t / \\Delta x$ 相关的稳定性。\n-   **任务4**：提供中心差分格式的主人工扩散系数 $D_{\\text{num}}$ 的值。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题在根本上是成立的。它涉及偏微分方程数值分析中的标准核心概念，特别是在计算热工和流体动力学领域。所用的分析方法（用于修正方程的泰勒级数，用于稳定性的 von Neumann 分析）都是经典方法。\n-   **适定性**：该问题是适定的。任务具体，所需的推导能得出唯一的解析表达式。为修正方程分析空间离散化和为稳定性分析全离散格式之间的区别是清晰且标准的做法。\n-   **客观性**：问题以精确、客观、形式化的数学语言陈述。\n\n该问题没有任何缺陷。它不是不合理、不完整或模棱两可的。即使在符号上下文中，关于扩散系数的实数值的请求也是可以回答的，因为中心差分空间算子的系数恰好为零。\n\n### 第3步：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解答\n\n分析过程将按问题陈述中规定的各项任务进行。我们首先推导空间离散化的修正方程。\n\n**修正方程分析**\n\n修正方程是数值格式实际求解的偏微分方程，它包含了其主阶截断误差。问题要求的是与空间离散化相对应的修正方程，这是一种半离散分析。\n\n**1. 中心差分格式**\n\n我们首先分析空间导数 $u_x$ 的中心差分近似。$u(x \\pm \\Delta x, t)$ 在点 $(x,t)$ 附近的泰勒级数展开为：\n$$u(x+\\Delta x, t) = u(x,t) + (\\Delta x) u_x + \\frac{(\\Delta x)^2}{2!} u_{xx} + \\frac{(\\Delta x)^3}{3!} u_{xxx} + \\frac{(\\Delta x)^4}{4!} u_{xxxx} + \\mathcal{O}(\\Delta x^5)$$\n$$u(x-\\Delta x, t) = u(x,t) - (\\Delta x) u_x + \\frac{(\\Delta x)^2}{2!} u_{xx} - \\frac{(\\Delta x)^3}{3!} u_{xxx} + \\frac{(\\Delta x)^4}{4!} u_{xxxx} - \\mathcal{O}(\\Delta x^5)$$\n其中 $u$ 的下标表示对 $x$ 的偏微分。在网格点 $x_j$ 处，我们有 $u_j = u(x_j, t)$，$u_{j+1} = u(x_j+\\Delta x, t)$，以及 $u_{j-1} = u(x_j-\\Delta x, t)$。\n\n中心差分算子为 $\\delta_{CD}(u_j) = \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}$。将第二个展开式从第一个展开式中减去，得到：\n$$u_{j+1} - u_{j-1} = 2 (\\Delta x) u_x + 2 \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^5)$$\n两边除以 $2 \\Delta x$，我们得到离散导数用连续导数表示的表达式：\n$$\\frac{u_{j+1} - u_{j-1}}{2 \\Delta x} = u_x + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\n半离散方程为 $u_t + a \\left( \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x} \\right) = 0$。代入上述表达式，得到修正方程：\n$$u_t + a \\left( u_x + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) \\right) = 0$$\n$$u_t + a u_x = -a \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\n主阶误差项为 $-a \\frac{\\Delta x^2}{6} u_{xxx}$。\n\n**2. 迎风格式（适用于 $a0$）**\n\n对于 $a0$，迎风格式使用一阶向后差分，$\\delta_{UW}(u_j) = \\frac{u_j - u_{j-1}}{\\Delta x}$。使用 $u_{j-1} = u(x_j-\\Delta x, t)$ 的泰勒展开式：\n$$u_j - u_{j-1} = u_j - \\left( u_j - (\\Delta x) u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) \\right)$$\n$$u_j - u_{j-1} = (\\Delta x) u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} - \\mathcal{O}(\\Delta x^4)$$\n两边除以 $\\Delta x$：\n$$\\frac{u_j - u_{j-1}}{\\Delta x} = u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3)$$\n半离散方程为 $u_t + a \\left( \\frac{u_j - u_{j-1}}{\\Delta x} \\right) = 0$。代入该表达式得到修正方程：\n$$u_t + a \\left( u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3) \\right) = 0$$\n保留至 $\\mathcal{O}(\\Delta x^2)$ 阶的项，修正方程为：\n$$u_t + a u_x = a \\frac{\\Delta x}{2} u_{xx} - a \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3)$$\n\n**人工扩散与色散的比较**\n\n-   **人工扩散（$u_{xx}$ 项）**：\n    -   对于中心差分空间算子，$u_{xx}$ 项的系数为 $0$。该格式在主阶上是非耗散的。\n    -   对于迎风空间算子，主误差项为 $a \\frac{\\Delta x}{2} u_{xx}$。其系数 $D_{\\text{num}} = a \\frac{\\Delta x}{2}$ 是人工扩散或数值粘性。该项的阶数为 $\\mathcal{O}(\\Delta x)$，它负责抑制数值振荡，但代价是会抹平尖锐的梯度。\n\n-   **人工色散（$u_{xxx}$ 项）**：\n    -   对于中心差分格式，主误差项为 $-a \\frac{\\Delta x^2}{6} u_{xxx}$。这是一个阶数为 $\\mathcal{O}(\\Delta x^2)$ 的色散项。它导致解的不同傅里叶分量以不同速度传播，从而在数值解中产生伪振荡（wiggles），尤其是在尖锐梯度附近。\n    -   对于迎风格式，也存在一个色散项 $-a \\frac{\\Delta x^2}{6} u_{xxx}$，其阶数为 $\\mathcal{O}(\\Delta x^2)$。然而，与占主导地位的扩散项相比，这是一个高阶项。\n\n总之，中心差分格式在空间上是二阶精度的（$\\mathcal{O}(\\Delta x^2)$），并且在此阶上是纯色散的。迎风格式在空间上是一阶精度的（$\\mathcal{O}(\\Delta x)$），并由其耗散误差主导。\n\n**傅里叶 (von Neumann) 稳定性分析**\n\n现在我们分析全离散格式，将空间算子与显式向前时间积分（向前时间欧拉法）相结合。\n\n**1. 中心差分格式 (FTCS: Forward Time, Central Space)**\n\n全离散方程为 $u_j^{n+1} = u_j^n - a \\frac{\\Delta t}{2 \\Delta x} (u_{j+1}^n - u_{j-1}^n)$。\n令 Courant 数为 $\\nu = \\frac{a \\Delta t}{\\Delta x}$，则方程为 $u_j^{n+1} = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n)$。\n我们寻找形式为 $u_j^n = G^n e^{i k x_j}$ 的解，其中 $k$ 是波数，$G$ 是放大因子。\n$$G^{n+1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} - \\frac{\\nu}{2} G^n (e^{i k (j+1) \\Delta x} - e^{i k (j-1) \\Delta x})$$\n两边除以 $G^n e^{i k j \\Delta x}$：\n$$G = 1 - \\frac{\\nu}{2} (e^{i k \\Delta x} - e^{-i k \\Delta x}) = 1 - \\frac{\\nu}{2} (2i \\sin(k \\Delta x)) = 1 - i \\nu \\sin(k \\Delta x)$$\n稳定性要求 $|G| \\leq 1$。放大因子的模的平方为：\n$$|G|^2 = 1^2 + (-\\nu \\sin(k \\Delta x))^2 = 1 + \\nu^2 \\sin^2(k \\Delta x)$$\n对于任何 $\\nu > 0$ 以及任何不为 $\\pi$ 的倍数的 $k \\Delta x$，我们有 $\\nu^2 \\sin^2(k \\Delta x) > 0$。因此，$|G|^2 > 1$，且 $|G| > 1$。\n**结论**：用于线性平流方程的 FTCS 格式是无条件不稳定的。空间离散化中缺乏数值耗散机制，导致所有波分量都被放大，从而引起指数级的误差增长。\n\n**2. 迎风格式 (FTBS: Forward Time, Backward Space for $a0$)**\n\n全离散方程为 $u_j^{n+1} = u_j^n - a \\frac{\\Delta t}{\\Delta x} (u_j^n - u_j^{n-1}) = u_j^n - \\nu (u_j^n - u_{j-1}^n)$。\n代入 $u_j^n = G^n e^{i k x_j}$：\n$$G^{n+1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} - \\nu G^n (e^{i k j \\Delta x} - e^{i k (j-1) \\Delta x})$$\n$$G = 1 - \\nu (1 - e^{-i k \\Delta x})$$\n令 $\\theta = k \\Delta x$。则 $G = 1 - \\nu (1 - \\cos(\\theta) + i \\sin(\\theta)) = (1 - \\nu + \\nu\\cos\\theta) - i \\nu \\sin\\theta$。\n模的平方为：\n$$|G|^2 = (1 - \\nu + \\nu\\cos\\theta)^2 + (-\\nu \\sin\\theta)^2$$\n$$|G|^2 = (1-\\nu)^2 + 2\\nu(1-\\nu)\\cos\\theta + \\nu^2\\cos^2\\theta + \\nu^2\\sin^2\\theta$$\n$$|G|^2 = 1 - 2\\nu + \\nu^2 + 2\\nu\\cos\\theta - 2\\nu^2\\cos\\theta + \\nu^2$$\n$$|G|^2 = 1 - 2\\nu(1-\\cos\\theta) + 2\\nu^2(1-\\cos\\theta) = 1 - 2\\nu(1-\\nu)(1-\\cos\\theta)$$\n使用恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$：\n$$|G|^2 = 1 - 4\\nu(1-\\nu)\\sin^2(k\\Delta x/2)$$\n为保证稳定性，我们要求 $|G|^2 \\leq 1$，这意味着 $-4\\nu(1-\\nu)\\sin^2(k\\Delta x/2) \\leq 0$。由于 $\\sin^2(k\\Delta x/2)$ 是非负的，该条件简化为 $\\nu(1-\\nu) \\ge 0$。\n已知 $a, \\Delta t, \\Delta x  0$，我们有 $\\nu  0$。因此稳定性条件变为 $1-\\nu \\ge 0$，即 $\\nu \\le 1$。\n**结论**：FTBS 迎风格式是条件稳定的，要求 CFL 数在 $0 \\le \\nu \\le 1$ 的范围内。迎风算子固有的数值扩散 $D_{\\text{num}} = a \\frac{\\Delta x}{2} (1-\\nu)$（对于全离散格式）提供了一种稳定效应，而这在中心差分格式中是不存在的。\n\n**最终任务：中心差分格式的扩散系数**\n\n最终任务是提供中心差分格式的主人工扩散系数 $D_{\\text{num}}$。根据问题中“为每种**空间离散化**推导主阶修正方程”的明确指示，我们参考半离散分析。\n\n半离散中心差分格式的修正方程为：\n$$u_t + a u_x = -a \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\n人工扩散项是与 $u_{xx}$ 成正比的项。在此方程中，$u_{xx}$ 项的系数恰好为零。\n因此，主人工扩散系数 $D_{\\text{num}}$ 为 $0$。扩散系数的单位是长度的平方除以时间，在国际单位制（SI）中是 $\\text{m}^2/\\text{s}$。因此，其值为 $0 \\text{ m}^2/\\text{s}$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在实际的工程模拟中，我们通常需要同时处理物理扩散和数值扩散。最后的这项练习将数值扩散的概念置于一个实际的工程问题背景中，其目标不是完全消除数值扩散，而是确保其足够小，不会污染物理上正确的解。你将运用在第一个练习中推导出的公式来确定所需的网格分辨率，以将数值误差控制在可接受的范围内，这是计算工程师必备的一项关键技能。",
            "id": "3942285",
            "problem": "考虑一个标量温度场 $T(x,t)$ 在速度为 $a$ 的稳定均匀流中沿直微通道的一维热输运。其控制方程为线性平流-扩散方程\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^{2} T}{\\partial x^{2}},\n$$\n其中 $\\alpha$ 是热扩散系数。使用间距为 $\\Delta x$ 的均匀网格和固定的时间步长 $\\Delta t$。对流项采用一阶迎风格式离散，时间积分采用前向欧拉法。选择时间步长以保持由 $C = a \\Delta t / \\Delta x$ 定义的 Courant 数 $C$ 为常数，并等于一个预定值。从上述偏微分方程和所述离散化出发，使用修正方程分析，确定由对流离散化引入的数值（人为）扩散 $\\nu_{\\text{num}}$ 的主阶系数。然后，施加设计准则，即人为扩散不大于物理扩散的一小部分 $\\epsilon$，即要求 $\\nu_{\\text{num}} \\le \\epsilon \\alpha$，并求解此不等式，以 $a$、$\\alpha$、$\\epsilon$ 和 $C$ 表示最大允许的均匀网格间距 $\\Delta x$。\n\n最后，根据以下参数计算得到的 $\\Delta x$：$a = 0.020\\,\\mathrm{m/s}$，$\\alpha = 1.50 \\times 10^{-5}\\,\\mathrm{m^{2}/s}$，$\\epsilon = 0.10$ 和 $C = 0.80$。以米为单位表示最终的网格间距，并将答案四舍五入到三位有效数字。",
            "solution": "首先验证问题，以确保其科学上合理、内容完整且提法恰当。\n\n### 步骤 1：提取已知条件\n- 控制方程：$\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^{2} T}{\\partial x^{2}}$\n- 标量场：$T(x,t)$\n- 流速：$a$（均匀且稳定）\n- 热扩散系数：$\\alpha$\n- 网格间距：$\\Delta x$（均匀）\n- 时间步长：$\\Delta t$（固定）\n- 对流项离散化：一阶迎风格式。\n- 时间积分：前向欧拉法。\n- Courant 数：$C = a \\Delta t / \\Delta x$，一个预定的常数。\n- 第一个目标：确定数值扩散的主阶系数 $\\nu_{\\text{num}}$。\n- 第二个目标：求解不等式 $\\nu_{\\text{num}} \\le \\epsilon \\alpha$，得到最大允许的 $\\Delta x$。\n- 用于计算的参数：\n  - $a = 0.020\\,\\mathrm{m/s}$\n  - $\\alpha = 1.50 \\times 10^{-5}\\,\\mathrm{m^{2}/s}$\n  - $\\epsilon = 0.10$\n  - $C = 0.80$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于标准的平流-扩散方程以及计算流体动力学和传热学的基本概念。指定的前向欧拉法、一阶迎风格式等数值方法是标准方法。所要求的技术，即修正方程分析，是分析有限差分格式准确性和行为的基石。问题提法恰当，提供了所有必要信息和明确的目标。语言客观、精确。给定的参数对于微流体中的热分析是物理上现实的。不存在解题协议中定义的任何缺陷。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 解题推导\n一维平流-扩散控制方程为：\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^{2} T}{\\partial x^{2}}\n$$\n我们在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上离散此方程。令 $T_i^n$ 表示温度 $T(i\\Delta x, n\\Delta t)$ 的数值近似值。\n\n时间导数使用前向欧拉法离散：\n$$\n\\frac{\\partial T}{\\partial t} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n对流项使用一阶迎风格式离散。对于正流速 $a  0$，格式如下：\n$$\n\\frac{\\partial T}{\\partial x} \\approx \\frac{T_i^n - T_{i-1}^n}{\\Delta x}\n$$\n扩散项使用二阶中心差分格式离散：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\n将这些离散近似代入控制方程，得到完全离散的格式：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} + a \\frac{T_i^n - T_{i-1}^n}{\\Delta x} = \\alpha \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\n为了确定数值扩散，我们进行修正方程分析。这包括将离散方程中的每一项表示为在点 $(x_i, t_n)$ 附近的泰勒级数展开。设 $T$ 及其所有偏导数均在该点求值。\n\n该格式中各项的泰勒级数展开为：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{\\partial T}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 T}{\\partial t^2} + \\mathcal{O}((\\Delta t)^2)\n$$\n$$\na \\frac{T_i^n - T_{i-1}^n}{\\Delta x} = a \\left( \\frac{\\partial T}{\\partial x} - \\frac{\\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} + \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 T}{\\partial x^3} - \\dots \\right)\n$$\n$$\n\\alpha \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} = \\alpha \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{(\\Delta x)^2}{12} \\frac{\\partial^4 T}{\\partial x^4} + \\dots \\right)\n$$\n将这些展开式代入离散方程，并重新整理以匹配原始偏微分方程的形式，可得：\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} - \\alpha \\frac{\\partial^2 T}{\\partial x^2} = -\\frac{\\Delta t}{2} \\frac{\\partial^2 T}{\\partial t^2} + \\frac{a \\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} - a \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 T}{\\partial x^3} + \\alpha \\frac{(\\Delta x)^2}{12} \\frac{\\partial^4 T}{\\partial x^4} + \\dots\n$$\n这就是修正方程，它代表了数值格式实际求解的偏微分方程。右侧的项是截断误差。包含偶数阶空间导数（如 $\\frac{\\partial^2 T}{\\partial x^2}$）的主阶误差项表现为类扩散项。为了找到数值扩散的主阶系数，我们必须用空间导数表示 $\\frac{\\partial^2 T}{\\partial t^2}$ 项。在最低阶近似下，我们可以使用原始偏微分方程 $\\frac{\\partial T}{\\partial t} \\approx -a \\frac{\\partial T}{\\partial x}$。对 $t$ 求导然后再次代入，得到 $\\frac{\\partial^2 T}{\\partial t^2} \\approx a^2 \\frac{\\partial^2 T}{\\partial x^2}$。\n\n将此代入修正方程：\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} - \\alpha \\frac{\\partial^2 T}{\\partial x^2} = -\\frac{\\Delta t}{2} \\left(a^2 \\frac{\\partial^2 T}{\\partial x^2}\\right) + \\frac{a \\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} + \\dots\n$$\n整理后得到：\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + \\left( \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) \\frac{\\partial^2 T}{\\partial x^2} + \\text{H.O.T.}\n$$\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = \\left( \\alpha + \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) \\frac{\\partial^2 T}{\\partial x^2} + \\text{H.O.T.}\n$$\n有效扩散系数是乘以 $\\frac{\\partial^2 T}{\\partial x^2}$ 的项。数值扩散 $\\nu_{\\text{num}}$ 是附加到物理扩散 $\\alpha$ 上的部分：\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\n$$\n使用 Courant 数的定义 $C = \\frac{a \\Delta t}{\\Delta x}$，我们可以将其重写为：\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) = \\frac{a \\Delta x}{2} (1 - C)\n$$\n这就是该格式引入的数值扩散的主阶系数。\n\n接下来，我们施加设计准则 $\\nu_{\\text{num}} \\le \\epsilon \\alpha$：\n$$\n\\frac{a \\Delta x}{2} (1 - C) \\le \\epsilon \\alpha\n$$\n我们求解此不等式以获得最大允许的网格间距 $\\Delta x$。由于 $a$、$1-C$（因为 $C=0.80$）、$\\epsilon$ 和 $\\alpha$ 均为正数，我们可以重新整理不等式而无需改变不等号方向：\n$$\n\\Delta x \\le \\frac{2 \\epsilon \\alpha}{a (1 - C)}\n$$\n因此，$\\Delta x$ 的最大允许值为：\n$$\n\\Delta x_{\\text{max}} = \\frac{2 \\epsilon \\alpha}{a (1 - C)}\n$$\n最后，我们使用给定的数值计算此表达式：\n- $a = 0.020\\,\\mathrm{m/s}$\n- $\\alpha = 1.50 \\times 10^{-5}\\,\\mathrm{m^{2}/s}$\n- $\\epsilon = 0.10$\n- $C = 0.80$\n\n$$\n\\Delta x_{\\text{max}} = \\frac{2 \\times 0.10 \\times (1.50 \\times 10^{-5}\\,\\mathrm{m^{2}/s})}{(0.020\\,\\mathrm{m/s}) \\times (1 - 0.80)}\n$$\n$$\n\\Delta x_{\\text{max}} = \\frac{0.20 \\times 1.50 \\times 10^{-5}}{0.020 \\times 0.20}\\,\\mathrm{m}\n$$\n$$\n\\Delta x_{\\text{max}} = \\frac{0.30 \\times 10^{-5}}{0.0040}\\,\\mathrm{m} = \\frac{3.0 \\times 10^{-6}}{4.0 \\times 10^{-3}}\\,\\mathrm{m}\n$$\n$$\n\\Delta x_{\\text{max}} = 0.75 \\times 10^{-3}\\,\\mathrm{m} = 7.5 \\times 10^{-4}\\,\\mathrm{m}\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\n\\Delta x_{\\text{max}} = 7.50 \\times 10^{-4}\\,\\mathrm{m}\n$$",
            "answer": "$$\n\\boxed{7.50 \\times 10^{-4}}\n$$"
        }
    ]
}