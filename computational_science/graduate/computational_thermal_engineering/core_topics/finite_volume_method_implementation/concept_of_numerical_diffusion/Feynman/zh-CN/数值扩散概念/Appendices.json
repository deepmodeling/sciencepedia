{
    "hands_on_practices": [
        {
            "introduction": "为了真正理解数值扩散，第一步是能够量化它。这个练习将引导您完成一个基础但至关重要的分析：通过泰勒级数展开，推导出一阶迎风格式中隐含的数值扩散项。这个过程，也称为修正方程分析，揭示了数值格式的真实行为，表明即使在求解纯平流问题时，该格式实际上也在求解一个带有附加扩散项的平流-扩散方程。",
            "id": "3942223",
            "problem": "考虑一维空间中的纯热标量场平流，由线性平流方程 $ \\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = 0 $ 描述，其中 $ \\theta(x,t) $ 是一个被动类温度标量，$ a $ 是恒定流速，$ x $ 和 $ t $ 分别表示空间和时间。该方程是计算流体力学和计算热工学中对流输运的标准模型，其中 $ \\theta $ 在没有物理扩散的情况下被输运。\n\n你将空间 $ x $ 在间距为 $ \\Delta x $ 的均匀网格上进行离散化，并以恒定的时间步长 $ \\Delta t $ 向前推进。对于 $ a  0 $ 的情况，你使用一阶显式迎风格式（时间上向前欧拉，空间上一阶迎风），得到更新公式\n$$\n\\theta_{i}^{n+1} = \\theta_{i}^{n} - C \\left( \\theta_{i}^{n} - \\theta_{i-1}^{n} \\right),\n$$\n其中 $ \\theta_{i}^{n} $ 近似于 $ \\theta(x_i, t_n) $，且库朗-弗里德里希-路维（CFL）数定义为 $ C = \\frac{a \\Delta t}{\\Delta x} $，为保证稳定性，有 $0 \\le C \\le 1$。\n\n仅以泰勒展开和控制连续介质平流方程为基本依据，进行修正方程分析，以识别由数值格式引入的主阶人工扩散。在形式为如下的主阶修正方程中，将 $ \\frac{\\partial^2 \\theta}{\\partial x^2} $ 的系数定义为等效数值扩散系数 $ \\nu_{\\text{num}} $\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = \\nu_{\\text{num}} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{高阶项},\n$$\n并将 $ \\nu_{\\text{num}} $ 表示为 $ a $、$ \\Delta x $ 和CFL数 $ C $ 的函数。请以 $ a $、$ \\Delta x $ 和 $ C $ 的单个闭式解析表达式形式给出你的最终答案。不要进行数值计算。如果赋以数值，$ \\nu_{\\text{num}} $ 的物理单位将是平方米/秒，但你必须只提供符号表达式。",
            "solution": "该问题要求对一维线性平流方程的一阶显式迎风格式进行修正方程分析。目标是确定数值方法中固有的数值扩散系数 $\\nu_{\\text{num}}$。\n\n控制连续介质方程为线性平流方程：\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = 0\n$$\n其中 $a  0$ 是一个恒定速度。\n\n数值格式为一阶显式迎风法（对于 $a0$ 为时间向前，空间向后）：\n$$\n\\theta_{i}^{n+1} = \\theta_{i}^{n} - C \\left( \\theta_{i}^{n} - \\theta_{i-1}^{n} \\right)\n$$\n此处，$\\theta_{i}^{n}$ 是标量场 $\\theta$ 在位置 $x_i = i \\Delta x$ 和时间 $t_n = n \\Delta t$ 的数值近似。库朗-弗里德里希-路维（CFL）数为 $C = \\frac{a \\Delta t}{\\Delta x}$。\n\n分析从将离散方程的每一项在点 $(x_i, t_n)$ 附近进行泰勒级数展开开始。我们假设 $\\theta(x,t)$ 足够光滑。所有导数均在点 $(x_i, t_n)$ 处求值。\n\n项 $\\theta_i^{n+1}$ 在时间上展开：\n$$\n\\theta_{i}^{n+1} = \\theta(x_i, t_n + \\Delta t) = \\theta_{i}^{n} + \\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\frac{(\\Delta t)^3}{6} \\frac{\\partial^3 \\theta}{\\partial t^3} + \\dots\n$$\n\n项 $\\theta_{i-1}^{n}$ 在空间上展开：\n$$\n\\theta_{i-1}^{n} = \\theta(x_i - \\Delta x, t_n) = \\theta_{i}^{n} - \\Delta x \\frac{\\partial \\theta}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 \\theta}{\\partial x^3} + \\dots\n$$\n\n将这些展开式代入数值格式，该格式可重排为 $\\theta_i^{n+1} - \\theta_i^n = -C(\\theta_i^n - \\theta_{i-1}^n)$：\n$$\n\\left( \\theta_{i}^{n} + \\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots \\right) - \\theta_i^n = -C \\left[ \\theta_i^n - \\left( \\theta_{i}^{n} - \\Delta x \\frac{\\partial \\theta}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\dots \\right) \\right]\n$$\n\n简化等式两边：\n$$\n\\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots = -C \\left( \\Delta x \\frac{\\partial \\theta}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\dots \\right)\n$$\n$$\n\\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots = -C \\Delta x \\frac{\\partial \\theta}{\\partial x} + C \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\dots\n$$\n\n根据定义，$C = \\frac{a \\Delta t}{\\Delta x}$，这意味着 $C \\Delta x = a \\Delta t$。将此代入右侧第一项：\n$$\n\\Delta t \\frac{\\partial \\theta}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\dots = -a \\Delta t \\frac{\\partial \\theta}{\\partial x} + C \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} - \\dots\n$$\n\n将整个方程除以 $\\Delta t$：\n$$\n\\frac{\\partial \\theta}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + O((\\Delta t)^2) = -a \\frac{\\partial \\theta}{\\partial x} + C \\frac{(\\Delta x)^2}{2 \\Delta t} \\frac{\\partial^2 \\theta}{\\partial x^2} - O(\\Delta x^2, \\Delta t \\Delta x)\n$$\n\n空间二阶导数项的系数可以简化为：\n$$\nC \\frac{(\\Delta x)^2}{2 \\Delta t} = \\left(\\frac{a \\Delta t}{\\Delta x}\\right) \\frac{(\\Delta x)^2}{2 \\Delta t} = \\frac{a \\Delta x}{2}\n$$\n\n将此代回并重排方程，以匹配原始偏微分方程（PDE）的形式：\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = - \\frac{\\Delta t}{2} \\frac{\\partial^2 \\theta}{\\partial t^2} + \\frac{a \\Delta x}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}\n$$\n其中 H.O.T. 代表高阶项（Higher-Order Terms）。这就是修正方程，但其右侧包含时间导数。为了将误差纯粹用空间导数表示，我们必须近似 $\\frac{\\partial^2 \\theta}{\\partial t^2}$。\n\n从原始连续介质方程可知，$\\frac{\\partial \\theta}{\\partial t} = -a \\frac{\\partial \\theta}{\\partial x}$。我们假设数值解是一个有效的近似，因此该关系在主阶上成立。我们可以对这个表达式关于时间 $t$ 求导：\n$$\n\\frac{\\partial^2 \\theta}{\\partial t^2} = \\frac{\\partial}{\\partial t} \\left(-a \\frac{\\partial \\theta}{\\partial x}\\right) = -a \\frac{\\partial}{\\partial x} \\left(\\frac{\\partial \\theta}{\\partial t}\\right)\n$$\n现在，再次代入 $\\frac{\\partial \\theta}{\\partial t} = -a \\frac{\\partial \\theta}{\\partial x}$：\n$$\n\\frac{\\partial^2 \\theta}{\\partial t^2} = -a \\frac{\\partial}{\\partial x} \\left(-a \\frac{\\partial \\theta}{\\partial x}\\right) = a^2 \\frac{\\partial^2 \\theta}{\\partial x^2}\n$$\n高阶时间导数可以类似地用高阶空间导数表示。对于本分析，我们只需要主阶项。\n\n将 $\\frac{\\partial^2 \\theta}{\\partial t^2} = a^2 \\frac{\\partial^2 \\theta}{\\partial x^2}$ 代入修正方程：\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = - \\frac{\\Delta t}{2} \\left(a^2 \\frac{\\partial^2 \\theta}{\\partial x^2}\\right) + \\frac{a \\Delta x}{2} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}\n$$\n\n现在我们可以将 $\\frac{\\partial^2 \\theta}{\\partial x^2}$ 项的系数组合在一起：\n$$\n\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = \\left(\\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\\right) \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}\n$$\n\n该方程符合目标形式 $\\frac{\\partial \\theta}{\\partial t} + a \\frac{\\partial \\theta}{\\partial x} = \\nu_{\\text{num}} \\frac{\\partial^2 \\theta}{\\partial x^2} + \\text{H.O.T.}$，其中空间二阶导数的系数即为数值扩散系数 $\\nu_{\\text{num}}$。\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\n$$\n\n问题要求此表达式用 $a$、$\\Delta x$ 和 $C$ 表示。我们提出因子 $\\frac{a \\Delta x}{2}$：\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right)\n$$\n认识到 $C = \\frac{a \\Delta t}{\\Delta x}$，我们得到最终表达式：\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} (1 - C)\n$$\n这个主阶截断误差项，其形式与物理扩散项相同，被称为数值扩散或人工黏性。它导致了一阶迎风格式的耗散性。对于稳定性范围 $0 \\le C \\le 1$，系数 $\\nu_{\\text{num}}$ 是非负的，正确地表示了一个扩散过程。当且仅当 $C=1$ 时，扩散消失，此时该格式是精确的。",
            "answer": "$$\n\\boxed{\\frac{a \\Delta x}{2} (1 - C)}\n$$"
        },
        {
            "introduction": "理论分析的价值在于其在实践中的应用。在掌握了如何量化数值扩散之后，下一步自然是学习如何控制它。这个练习将理论与实际的模拟设计联系起来，要求您基于一个关键准则——确保数值扩散远小于物理扩散——来确定计算网格所需的分辨率。通过这个在微通道热输运背景下的具体问题，您将学会如何将对截断误差的抽象理解转化为选择网格尺寸这一实际决策。",
            "id": "3942285",
            "problem": "考虑一个标量温度场 $T(x,t)$ 在速度为 $a$ 的稳定均匀流中沿直微通道的一维热输运。其控制方程为线性平流-扩散方程\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^{2} T}{\\partial x^{2}},\n$$\n其中 $\\alpha$ 是热扩散系数。使用间距为 $\\Delta x$ 的均匀网格和固定的时间步长 $\\Delta t$。对流项采用一阶迎风格式离散，时间积分采用前向欧拉法。选择时间步长以使由 $C = a \\Delta t / \\Delta x$ 定义的库朗数 $C$ 保持恒定并等于一个预定值。从上述偏微分方程和所述离散化方法出发，使用修正方程分析，确定由对流离散化引入的数值（人为）扩散 $\\nu_{\\text{num}}$ 的主阶系数。然后，施加设计准则，即人为扩散不大于物理扩散的一小部分 $\\epsilon$，即要求 $\\nu_{\\text{num}} \\le \\epsilon \\alpha$，并求解此不等式，以 $a$、$\\alpha$、$\\epsilon$ 和 $C$ 的形式得出允许的最大均匀网格间距 $\\Delta x$。\n\n最后，对以下参数计算所得的 $\\Delta x$：$a = 0.020\\,\\mathrm{m/s}$，$\\alpha = 1.50 \\times 10^{-5}\\,\\mathrm{m^{2}/s}$，$\\epsilon = 0.10$ 和 $C = 0.80$。以米为单位表示最终的网格间距，并将答案四舍五入到三位有效数字。",
            "solution": "首先验证问题，确保其科学上合理、内容完整且提法得当。\n\n### 第1步：提取已知条件\n- 控制方程：$\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^{2} T}{\\partial x^{2}}$\n- 标量场：$T(x,t)$\n- 流速：$a$ (均匀且稳定)\n- 热扩散系数：$\\alpha$\n- 网格间距：$\\Delta x$ (均匀)\n- 时间步长：$\\Delta t$ (固定)\n- 对流项的离散化：一阶迎风格式。\n- 时间积分：前向欧拉法。\n- 库朗数：$C = a \\Delta t / \\Delta x$，一个预设常数。\n- 第一个目标：确定数值扩散的主阶系数 $\\nu_{\\text{num}}$。\n- 第二个目标：求解不等式 $\\nu_{\\text{num}} \\le \\epsilon \\alpha$ 以得到允许的最大 $\\Delta x$。\n- 用于评估的参数：\n  - $a = 0.020\\,\\mathrm{m/s}$\n  - $\\alpha = 1.50 \\times 10^{-5}\\,\\mathrm{m^{2}/s}$\n  - $\\epsilon = 0.10$\n  - $C = 0.80$\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，植根于标准的平流-扩散方程以及计算流体动力学和传热学的基本概念。指定的数值方法（前向欧拉法，一阶迎风）是标准方法。所要求的技术，即修正方程分析，是分析有限差分格式准确性和行为的基石。问题提法得当，提供了所有必要信息和明确的目标。语言客观而精确。给出的参数对于微流体中的热分析是物理上现实的。不存在解题协议中定义的缺陷。\n\n### 第3步：结论与行动\n问题是**有效的**。将提供完整的解答。\n\n### 解题推导\n一维平流-扩散控制方程为：\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^{2} T}{\\partial x^{2}}\n$$\n我们在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上对此方程进行离散化。令 $T_i^n$ 表示温度 $T(i\\Delta x, n\\Delta t)$ 的数值近似。\n\n时间导数使用前向欧拉法离散化：\n$$\n\\frac{\\partial T}{\\partial t} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n对流项使用一阶迎风格式离散化。对于正流速 $a  0$，其形式为：\n$$\n\\frac{\\partial T}{\\partial x} \\approx \\frac{T_i^n - T_{i-1}^n}{\\Delta x}\n$$\n扩散项使用二阶中心差分格式离散化：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\n将这些离散近似代入控制方程，得到完全离散的格式：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} + a \\frac{T_i^n - T_{i-1}^n}{\\Delta x} = \\alpha \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\n为了确定数值扩散，我们进行修正方程分析。这涉及到将离散方程中的每一项表示为围绕点 $(x_i, t_n)$ 的泰勒级数展开。设 $T$ 及其所有偏导数均在该点求值。\n\n该格式中各项的泰勒级数展开为：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{\\partial T}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 T}{\\partial t^2} + \\mathcal{O}((\\Delta t)^2)\n$$\n$$\na \\frac{T_i^n - T_{i-1}^n}{\\Delta x} = a \\left( \\frac{\\partial T}{\\partial x} - \\frac{\\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} + \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 T}{\\partial x^3} - \\dots \\right)\n$$\n$$\n\\alpha \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} = \\alpha \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{(\\Delta x)^2}{12} \\frac{\\partial^4 T}{\\partial x^4} + \\dots \\right)\n$$\n将这些展开式代入离散方程，并重新整理以匹配原始偏微分方程的形式，得到：\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} - \\alpha \\frac{\\partial^2 T}{\\partial x^2} = -\\frac{\\Delta t}{2} \\frac{\\partial^2 T}{\\partial t^2} + \\frac{a \\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} - a \\frac{(\\Delta x)^2}{6} \\frac{\\partial^3 T}{\\partial x^3} + \\alpha \\frac{(\\Delta x)^2}{12} \\frac{\\partial^4 T}{\\partial x^4} + \\dots\n$$\n这就是修正方程，它代表了数值格式实际求解的偏微分方程。右侧的项是截断误差。包含偶数阶空间导数（如 $\\frac{\\partial^2 T}{\\partial x^2}$）的主阶误差项表现得像扩散项。为了找到数值扩散的主阶系数，我们必须用空间导数来表示 $\\frac{\\partial^2 T}{\\partial t^2}$ 项。在最低阶近似下，我们可以使用原始偏微分方程，$\\frac{\\partial T}{\\partial t} \\approx -a \\frac{\\partial T}{\\partial x}$。对 $t$ 求导然后再次代入，得到 $\\frac{\\partial^2 T}{\\partial t^2} \\approx a^2 \\frac{\\partial^2 T}{\\partial x^2}$。\n\n将此代入修正方程：\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} - \\alpha \\frac{\\partial^2 T}{\\partial x^2} = -\\frac{\\Delta t}{2} \\left(a^2 \\frac{\\partial^2 T}{\\partial x^2}\\right) + \\frac{a \\Delta x}{2} \\frac{\\partial^2 T}{\\partial x^2} + \\dots\n$$\n重新整理得到：\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} + \\left( \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) \\frac{\\partial^2 T}{\\partial x^2} + \\text{H.O.T.}\n$$\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = \\left( \\alpha + \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2} \\right) \\frac{\\partial^2 T}{\\partial x^2} + \\text{H.O.T.}\n$$\n有效扩散系数是乘以 $\\frac{\\partial^2 T}{\\partial x^2}$ 的项。数值扩散 $\\nu_{\\text{num}}$ 是附加在物理扩散 $\\alpha$ 上的部分：\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} - \\frac{a^2 \\Delta t}{2}\n$$\n使用库朗数定义 $C = \\frac{a \\Delta t}{\\Delta x}$，我们可以将其重写为：\n$$\n\\nu_{\\text{num}} = \\frac{a \\Delta x}{2} \\left(1 - \\frac{a \\Delta t}{\\Delta x}\\right) = \\frac{a \\Delta x}{2} (1 - C)\n$$\n这就是该格式引入的数值扩散的主阶系数。\n\n接下来，我们施加设计准则 $\\nu_{\\text{num}} \\le \\epsilon \\alpha$：\n$$\n\\frac{a \\Delta x}{2} (1 - C) \\le \\epsilon \\alpha\n$$\n我们求解此不等式以得到允许的最大网格间距 $\\Delta x$。由于 $a$、$1-C$（因为 $C=0.80$）、$\\epsilon$ 和 $\\alpha$ 均为正数，我们可以重新整理不等式而不改变其方向：\n$$\n\\Delta x \\le \\frac{2 \\epsilon \\alpha}{a (1 - C)}\n$$\n因此，$\\Delta x$ 的最大允许值为：\n$$\n\\Delta x_{\\text{max}} = \\frac{2 \\epsilon \\alpha}{a (1 - C)}\n$$\n最后，我们使用给定的数值计算这个表达式：\n- $a = 0.020\\,\\mathrm{m/s}$\n- $\\alpha = 1.50 \\times 10^{-5}\\,\\mathrm{m^{2}/s}$\n- $\\epsilon = 0.10$\n- $C = 0.80$\n\n$$\n\\Delta x_{\\text{max}} = \\frac{2 \\times 0.10 \\times (1.50 \\times 10^{-5}\\,\\mathrm{m^{2}/s})}{(0.020\\,\\mathrm{m/s}) \\times (1 - 0.80)}\n$$\n$$\n\\Delta x_{\\text{max}} = \\frac{0.20 \\times 1.50 \\times 10^{-5}}{0.020 \\times 0.20}\\,\\mathrm{m}\n$$\n$$\n\\Delta x_{\\text{max}} = \\frac{0.30 \\times 10^{-5}}{0.0040}\\,\\mathrm{m} = \\frac{3.0 \\times 10^{-6}}{4.0 \\times 10^{-3}}\\,\\mathrm{m}\n$$\n$$\n\\Delta x_{\\text{max}} = 0.75 \\times 10^{-3}\\,\\mathrm{m} = 7.5 \\times 10^{-4}\\,\\mathrm{m}\n$$\n问题要求将答案四舍五入到三位有效数字。\n$$\n\\Delta x_{\\text{max}} = 7.50 \\times 10^{-4}\\,\\mathrm{m}\n$$",
            "answer": "$$\n\\boxed{7.50 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "既然我们已经看到了一阶迎风格式的扩散性问题，一个自然的问题是：为什么不使用一个没有数值扩散的格式，比如中心差分呢？这个练习将直接探讨这个问题，揭示数值计算中的一个核心权衡。您会发现，消除数值扩散可能会引入另一种类型的误差——数值频散，并且更关键的是，可能会导致灾难性的数值不稳定性。这个对比练习突出了在计算流体力学中，精度、稳定性和数值误差类型之间必须做出的基本妥协。",
            "id": "3942275",
            "problem": "考虑一个由偏微分方程 $u_t + a u_x = 0$ 控制的被动热标量的一维线性平流问题，其中 $u(x,t)$ 是标量场，$a0$ 是一个恒定的平流速度。使用间距为 $\\Delta x$ 的均匀空间网格。考虑两种显式有限差分空间离散化方案：\n\n1. 一种半离散空间中心差分格式，通过将网格点 $x_j$ 处的 $u_x$ 替换为 $(u_{j+1} - u_{j-1})/(2 \\Delta x)$ 来定义，并与显式向前时间积分相结合。\n\n2. 一种适用于 $a0$ 的空间迎风格式，通过将网格点 $x_j$ 处的 $u_x$ 替换为 $(u_j - u_{j-1})/\\Delta x$ 来定义，并与显式向前时间积分相结合。\n\n从精确方程 $u_t + a u_x = 0$ 出发，使用 $u(x \\pm \\Delta x, t)$ 在 $x$ 附近的 Taylor 级数展开和 Fourier (von Neumann) 分析来：\n\n- 通过将离散空间导数表示为连续空间导数的函数，推导每种空间离散化方案的主阶修正方程，保留截至 $\\mathcal{O}(\\Delta x^2)$ 的项。\n- 在修正方程中，识别并比较主人工扩散项（与 $u_{xx}$ 成正比的项）和主色散项（与 $u_{xxx}$ 成正比的项）。\n- 使用 Fourier 分析，计算并解释全离散中心差分和迎风格式的放大因子。根据 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = a \\Delta t / \\Delta x$，讨论中心差分相对于迎风格式的稳定性影响。\n\n你的最终任务是提供一个单一的实值量：中心差分格式的主人工扩散系数 $D_{\\text{num}}$（定义为修正方程中 $u_{xx}$ 的系数）。以 $\\text{m}^2/\\text{s}$ 为单位表示 $D_{\\text{num}}$ 的最终值。无需四舍五入。",
            "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **控制方程**：被动标量 $u(x,t)$ 的一维线性平流方程为 $u_t + a u_x = 0$，其中 $a  0$ 是恒定的平流速度。\n- **网格**：间距为 $\\Delta x$ 的均匀空间网格。\n- **格式 1 (中心差分)**：一种半离散空间中心差分格式，其中网格点 $x_j$ 处的 $u_x$ 由 $\\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}$ 近似。对于全离散格式，此格式与显式向前时间积分相结合。\n- **格式 2 (迎风)**：一种适用于 $a0$ 的空间迎风格式，其中网格点 $x_j$ 处的 $u_x$ 由 $\\frac{u_j - u_{j-1}}{\\Delta x}$ 近似。此格式也与显式向前时间积分相结合。\n- **任务 1**：推导每种空间离散化方案的主阶修正方程，截至 $\\mathcal{O}(\\Delta x^2)$。\n- **任务 2**：识别并比较主人工扩散项（与 $u_{xx}$ 成正比）和色散项（与 $u_{xxx}$ 成正比）。\n- **任务 3**：对于全离散格式，使用 Fourier 分析计算并解释放大因子，并结合 CFL 数 $\\nu = a \\Delta t / \\Delta x$ 讨论稳定性。\n- **任务 4**：提供中心差分格式的主人工扩散系数 $D_{\\text{num}}$ 的值。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题在根本上是合理的。它涉及偏微分方程数值分析中的标准核心概念，特别是在计算热工学和流体动力学领域。所用的分析方法（用于修正方程的 Taylor 级数，用于稳定性的 von Neumann 分析）都是经典方法。\n- **适定性**：该问题是适定的。任务具体，所需的推导会得出唯一的解析表达式。为修正方程分析空间离散化与为稳定性分析全离散格式之间的区别是清晰的，也是标准做法。\n- **客观性**：问题以精确、客观和形式化的数学语言陈述。\n\n问题没有任何缺陷。它不是不合理的、不完整的或模棱两可的。即使在符号化语境中，关于扩散系数实值量的要求也是可以回答的，因为中心差分空间算子的系数恰好为零。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答\n\n分析过程通过处理问题陈述中规定的每个任务来进行。我们从推导空间离散化的修正方程开始。\n\n**修正方程分析**\n\n修正方程是数值格式实际求解的偏微分方程，它包含了其主阶截断误差。问题要求的是与空间离散化相对应的修正方程，这是一种半离散分析。\n\n**1. 中心差分格式**\n\n我们首先分析空间导数 $u_x$ 的中心差分近似。$u(x \\pm \\Delta x, t)$ 在点 $(x,t)$ 附近的 Taylor 级数展开为：\n$$u(x+\\Delta x, t) = u(x,t) + (\\Delta x) u_x + \\frac{(\\Delta x)^2}{2!} u_{xx} + \\frac{(\\Delta x)^3}{3!} u_{xxx} + \\frac{(\\Delta x)^4}{4!} u_{xxxx} + \\mathcal{O}(\\Delta x^5)$$\n$$u(x-\\Delta x, t) = u(x,t) - (\\Delta x) u_x + \\frac{(\\Delta x)^2}{2!} u_{xx} - \\frac{(\\Delta x)^3}{3!} u_{xxx} + \\frac{(\\Delta x)^4}{4!} u_{xxxx} - \\mathcal{O}(\\Delta x^5)$$\n其中 $u$ 的下标表示对 $x$ 的偏微分。在网格点 $x_j$ 处，我们有 $u_j = u(x_j, t)$，$u_{j+1} = u(x_j+\\Delta x, t)$ 和 $u_{j-1} = u(x_j-\\Delta x, t)$。\n\n中心差分算子为 $\\delta_{CD}(u_j) = \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x}$。用第一个展开式减去第二个展开式得到：\n$$u_{j+1} - u_{j-1} = 2 (\\Delta x) u_x + 2 \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^5)$$\n两边除以 $2 \\Delta x$，我们得到用连续导数表示的离散导数的表达式：\n$$\\frac{u_{j+1} - u_{j-1}}{2 \\Delta x} = u_x + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\n半离散方程为 $u_t + a \\left( \\frac{u_{j+1} - u_{j-1}}{2 \\Delta x} \\right) = 0$。代入上述表达式得到修正方程：\n$$u_t + a \\left( u_x + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) \\right) = 0$$\n$$u_t + a u_x = -a \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\n主阶误差项为 $-a \\frac{\\Delta x^2}{6} u_{xxx}$。\n\n**2. 迎风格式 (适用于 $a0$)**\n\n对于 $a0$，迎风格式使用一阶后向差分 $\\delta_{UW}(u_j) = \\frac{u_j - u_{j-1}}{\\Delta x}$。使用 $u_{j-1} = u(x_j-\\Delta x, t)$ 的 Taylor 展开：\n$$u_j - u_{j-1} = u_j - \\left( u_j - (\\Delta x) u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) \\right)$$\n$$u_j - u_{j-1} = (\\Delta x) u_x - \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx} - \\mathcal{O}(\\Delta x^4)$$\n两边除以 $\\Delta x$：\n$$\\frac{u_j - u_{j-1}}{\\Delta x} = u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3)$$\n半离散方程为 $u_t + a \\left( \\frac{u_j - u_{j-1}}{\\Delta x} \\right) = 0$。代入该表达式得到修正方程：\n$$u_t + a \\left( u_x - \\frac{\\Delta x}{2} u_{xx} + \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3) \\right) = 0$$\n保留截至 $\\mathcal{O}(\\Delta x^2)$ 的项，修正方程为：\n$$u_t + a u_x = a \\frac{\\Delta x}{2} u_{xx} - a \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^3)$$\n\n**人工扩散与色散的比较**\n\n- **人工扩散（$u_{xx}$ 项）**：\n    - 对于中心差分空间算子，$u_{xx}$ 项的系数为 $0$。该格式在主阶上是非耗散的。\n    - 对于迎风空间算子，主误差项为 $a \\frac{\\Delta x}{2} u_{xx}$。其系数 $D_{\\text{num}} = a \\frac{\\Delta x}{2}$ 即为人工扩散或数值粘性。该项是 $\\mathcal{O}(\\Delta x)$ 阶的，负责阻尼数值振荡，但代价是会抹平尖锐梯度。\n\n- **人工色散（$u_{xxx}$ 项）**：\n    - 对于中心差分格式，主误差项为 $-a \\frac{\\Delta x^2}{6} u_{xxx}$。这是一个 $\\mathcal{O}(\\Delta x^2)$ 阶的色散项。它导致解的不同 Fourier 分量以不同速度传播，从而在数值解中（尤其是在尖锐梯度附近）产生伪振荡（摆动）。\n    - 对于迎风格式，也存在一个 $\\mathcal{O}(\\Delta x^2)$ 阶的色散项 $-a \\frac{\\Delta x^2}{6} u_{xxx}$。然而，与其占主导地位的扩散项相比，这是一个高阶项。\n\n总而言之，中心差分格式在空间上是二阶精度的（$\\mathcal{O}(\\Delta x^2)$），并且在该阶上是纯色散的。迎风格式在空间上是一阶精度的（$\\mathcal{O}(\\Delta x)$），并由其耗散误差主导。\n\n**Fourier (von Neumann) 稳定性分析**\n\n现在我们分析全离散格式，将空间算子与显式向前时间积分（向前时间欧拉法）相结合。\n\n**1. 中心差分格式 (FTCS: 向前时间，中心空间)**\n\n全离散方程为 $u_j^{n+1} = u_j^n - a \\frac{\\Delta t}{2 \\Delta x} (u_{j+1}^n - u_{j-1}^n)$。\n令 Courant 数为 $\\nu = \\frac{a \\Delta t}{\\Delta x}$，则方程为 $u_j^{n+1} = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n)$。\n我们寻求形如 $u_j^n = G^n e^{i k x_j}$ 的解，其中 $k$ 是波数，$G$ 是放大因子。\n$$G^{n+1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} - \\frac{\\nu}{2} G^n (e^{i k (j+1) \\Delta x} - e^{i k (j-1) \\Delta x})$$\n两边除以 $G^n e^{i k j \\Delta x}$：\n$$G = 1 - \\frac{\\nu}{2} (e^{i k \\Delta x} - e^{-i k \\Delta x}) = 1 - \\frac{\\nu}{2} (2i \\sin(k \\Delta x)) = 1 - i \\nu \\sin(k \\Delta x)$$\n稳定性要求 $|G| \\leq 1$。放大因子的模的平方为：\n$$|G|^2 = 1^2 + (-\\nu \\sin(k \\Delta x))^2 = 1 + \\nu^2 \\sin^2(k \\Delta x)$$\n对于任何 $\\nu  0$ 和任何非 $\\pi$ 倍数的 $k \\Delta x$，我们有 $\\nu^2 \\sin^2(k \\Delta x)  0$。因此， $|G|^2  1$ 且 $|G|  1$。\n**结论**：用于线性平流方程的 FTCS 格式是无条件不稳定的。空间离散化中缺乏数值耗散机制，导致所有波分量都被放大，从而引起指数级的误差增长。\n\n**2. 迎风格式 (FTBS: 向前时间，后向空间，适用于 $a0$)**\n\n全离散方程为 $u_j^{n+1} = u_j^n - a \\frac{\\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n) = u_j^n - \\nu (u_j^n - u_{j-1}^n)$。\n代入 $u_j^n = G^n e^{i k x_j}$：\n$$G^{n+1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} - \\nu G^n (e^{i k j \\Delta x} - e^{i k (j-1) \\Delta x})$$\n$$G = 1 - \\nu (1 - e^{-i k \\Delta x})$$\n令 $\\theta = k \\Delta x$。则 $G = 1 - \\nu (1 - \\cos(\\theta) + i \\sin(\\theta)) = (1 - \\nu + \\nu\\cos\\theta) - i \\nu \\sin\\theta$。\n模的平方为：\n$$|G|^2 = (1 - \\nu + \\nu\\cos\\theta)^2 + (-\\nu \\sin\\theta)^2$$\n$$|G|^2 = (1-\\nu)^2 + 2\\nu(1-\\nu)\\cos\\theta + \\nu^2\\cos^2\\theta + \\nu^2\\sin^2\\theta$$\n$$|G|^2 = 1 - 2\\nu + \\nu^2 + 2\\nu\\cos\\theta - 2\\nu^2\\cos\\theta + \\nu^2$$\n$$|G|^2 = 1 - 2\\nu(1-\\cos\\theta) + 2\\nu^2(1-\\cos\\theta) = 1 - 2\\nu(1-\\nu)(1-\\cos\\theta)$$\n使用恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$：\n$$|G|^2 = 1 - 4\\nu(1-\\nu)\\sin^2(k\\Delta x/2)$$\n为保证稳定性，我们要求 $|G|^2 \\leq 1$，这意味着 $-4\\nu(1-\\nu)\\sin^2(k\\Delta x/2) \\leq 0$。由于 $\\sin^2(k\\Delta x/2)$ 是非负的，该条件简化为 $\\nu(1-\\nu) \\ge 0$。\n给定 $a, \\Delta t, \\Delta x  0$，我们有 $\\nu  0$。因此，稳定性条件变为 $1-\\nu \\ge 0$，即 $\\nu \\le 1$。\n**结论**：FTBS 迎风格式是条件稳定的，要求 CFL 数在 $0 \\le \\nu \\le 1$ 的范围内。迎风算子的内在数值扩散（对于全离散格式为 $D_{\\text{num}} = a \\frac{\\Delta x}{2} (1-\\nu)$）提供了一种稳定效应，而这是中心差分格式中所没有的。\n\n**最终任务：中心差分格式的扩散系数**\n\n最终任务是提供中心差分格式的主人工扩散系数 $D_{\\text{num}}$。根据问题中“推导每种**空间离散化**方案的主阶修正方程”的明确指示，我们参考半离散分析。\n\n半离散中心差分格式的修正方程为：\n$$u_t + a u_x = -a \\frac{\\Delta x^2}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)$$\n人工扩散项是与 $u_{xx}$ 成正比的项。在此方程中，$u_{xx}$ 项的系数恰好为零。\n因此，主人工扩散系数 $D_{\\text{num}}$ 为 $0$。扩散系数的单位是长度的平方除以时间，在国际单位制中为 $\\text{m}^2/\\text{s}$。因此，该值为 $0 \\text{ m}^2/\\text{s}$。",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}