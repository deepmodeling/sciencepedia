{
    "hands_on_practices": [
        {
            "introduction": "为了在计算中获得更高的精度，QUICK格式采用二次多项式来插值计算控制体界面上的值，这与仅使用上游节点的一阶迎风格式形成了鲜明对比。通过该练习，您将亲手推导QUICK格式的插值公式，并将其与一阶方法进行比较，从而量化两者之间的差异。这个差异项在更高级的“延迟修正”实现方法中至关重要。",
            "id": "3306422",
            "problem": "考虑一个由标量守恒控制的一维稳态无源标量场 $\\phi(x)$ 的平流，当密度 $\\rho$ 和速度 $u$ 均匀时，对流通量 $\\rho u \\phi$ 沿 $x$ 方向在空间上是恒定的。使用有限体积法 (FVM)，在具有单元中心 $x_{i-1}$、$x_{i}$、$x_{i+1}$ 和 $x_{i+2}$ 以及单元面 $x_{i-1/2}$、$x_{i+1/2}$ 和 $x_{i+3/2}$ 的均匀网格上进行离散化，需要对单元面值 $\\phi_{i+1/2}$ 进行近似，以封闭穿过单元 $i$ 和 $i+1$ 之间交界面的对流通量。对于严格正速度 ($u>0$)，一阶供体单元上风近似和高阶的对流运动学二次上风插值 (QUICK) 格式提供了两种不同的单元面值重构方法。\n\n从平流的守恒律基础和均匀网格几何出发，完成以下任务：\n- 对于 $u>0$，通过识别物理上正确的供体状态，推导出 $x_{i+1/2}$ 处的供体单元上风格式的面值，并将 $\\phi_{i+1/2}^{UP}$ 表示为相邻单元中心值的函数。\n- 对于 $u>0$，通过构建一个唯一的二次多项式来插值偏向上游的单元中心值模板，并在单元面位置对其求值，从而独立推导出 $x_{i+1/2}$ 处的 QUICK 格式的面值。\n- 使用样本值 $\\phi_{i-1}=1$、$\\phi_{i}=2$、$\\phi_{i+1}=4$ 和 $\\phi_{i+2}=8$，计算 $\\phi_{i+1/2}^{UP}$ 和 $\\phi_{i+1/2}^{QUICK}$，并确定延迟修正贡献项 $\\delta=\\phi_{i+1/2}^{QUICK}-\\phi_{i+1/2}^{UP}$，这是在延迟修正公式中需要加到上风通量上的修正量。\n\n将最终答案表示为行矩阵 $\\left[ \\phi_{i+1/2}^{UP}, \\, \\phi_{i+1/2}^{QUICK}, \\, \\delta \\right]$，使用精确值。不要四舍五入；提供精确的数字。",
            "solution": "该问题要求推导并应用两种有限体积对流格式，即一阶供体单元上风格式和对流运动学二次上风插值 (Quadratic Upwind Interpolation for Convective Kinematics, QUICK) 格式，以确定标量场 $\\phi$ 在单元面上的值。最终目标是计算延迟修正项，即高阶近似与低阶近似之间的差值。\n\n其物理基础是一维稳态无源标量 $\\phi(x)$ 的平流，由守恒律控制：\n$$ \\frac{d}{dx}(\\rho u \\phi) = 0 $$\n其中 $\\rho$ 是密度， $u$ 是速度。问题陈述 $\\rho$ 和 $u$ 是均匀且恒定的，且 $u > 0$。方程简化为：\n$$ u \\frac{d\\phi}{dx} = 0 $$\n在有限体积法 (FVM) 中，该方程在一个以 $x_i$ 为中心、从面 $x_{i-1/2}$ 延伸到面 $x_{i+1/2}$ 的控制体积（一个单元）上进行积分。\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} u \\frac{d\\phi}{dx} dx = 0 $$\n$$ u [\\phi]_{x_{i-1/2}}^{x_{i+1/2}} = 0 $$\n$$ u (\\phi_{i+1/2} - \\phi_{i-1/2}) = 0 $$\n在这里，$\\phi_{i+1/2}$ 和 $\\phi_{i-1/2}$ 是标量在单元面上的值。为了数值求解这个代数方程组，这些面值必须用已知的单元中心值 $\\phi_i$ 来表示。这就是对流格式的作用。\n\n首先，我们推导供体单元上风格式的面值 $\\phi_{i+1/2}^{UP}$ 的表达式。\n供体单元或一阶上风 (FOU) 格式基于流动方向。它用“供体”单元的中心值来近似单元面上的值，该供体单元是该面上游紧邻的单元。问题指定了严格正速度，$u > 0$，意味着流动方向是从左到右（即 $x$ 增大的方向）。对于位于单元 $i$ 和单元 $i+1$ 之间的面 $x_{i+1/2}$，上游方向是向左。因此，供体单元是单元 $i$。该格式将面值设为等于供体单元中心的值。\n$$ \\phi_{i+1/2}^{UP} = \\phi_i $$\n\n接下来，我们推导 QUICK 格式的面值 $\\phi_{i+1/2}^{QUICK}$ 的表达式。\nQUICK 格式构建一个二次多项式来对面值进行插值。为了迎风，插值模板向上游方向有偏差。为了找到当 $u>0$ 时在面 $x_{i+1/2}$ 处的值，该格式使用两个最近的上游单元中心和一个最近的下游单元中心。这些中心位于 $x_{i-1}$、$x_i$ 和 $x_{i+1}$。\n我们构建一个通过点 $(x_{i-1}, \\phi_{i-1})$、$(x_i, \\phi_i)$ 和 $(x_{i+1}, \\phi_{i+1})$ 的二次多项式 $P(x)$。设网格是均匀的，单元间距为 $\\Delta x$。为方便起见，我们可以设置一个局部坐标系，其原点在 $x_i = 0$。那么，$x_{i-1} = -\\Delta x$，$x_{i+1} = \\Delta x$。我们关注的面 $x_{i+1/2}$ 位于 $x = \\frac{\\Delta x}{2}$。\n通过这三个点的插值多项式的拉格朗日形式是：\n$$ P(x) = \\phi_{i-1} \\frac{(x-x_i)(x-x_{i+1})}{(x_{i-1}-x_i)(x_{i-1}-x_{i+1})} + \\phi_i \\frac{(x-x_{i-1})(x-x_{i+1})}{(x_i-x_{i-1})(x_i-x_{i+1})} + \\phi_{i+1} \\frac{(x-x_{i-1})(x-x_i)}{(x_{i+1}-x_{i-1})(x_{i+1}-x_i)} $$\n代入局部坐标 $x_{i-1}=-\\Delta x$, $x_i=0$, $x_{i+1}=\\Delta x$：\n$$ P(x) = \\phi_{i-1} \\frac{x(x-\\Delta x)}{(-\\Delta x)(-2\\Delta x)} + \\phi_i \\frac{(x+\\Delta x)(x-\\Delta x)}{(\\Delta x)(-\\Delta x)} + \\phi_{i+1} \\frac{(x+\\Delta x)x}{(2\\Delta x)(\\Delta x)} $$\n$$ P(x) = \\phi_{i-1} \\frac{x(x-\\Delta x)}{2(\\Delta x)^2} - \\phi_i \\frac{x^2 - (\\Delta x)^2}{(\\Delta x)^2} + \\phi_{i+1} \\frac{x(x+\\Delta x)}{2(\\Delta x)^2} $$\n我们在面位置 $x = \\frac{\\Delta x}{2}$ 计算该多项式的值，以求得 $\\phi_{i+1/2}^{QUICK}$。\n$$ \\phi_{i+1/2}^{QUICK} = P\\left(\\frac{\\Delta x}{2}\\right) $$\n$$ \\phi_{i+1/2}^{QUICK} = \\phi_{i-1} \\frac{\\frac{\\Delta x}{2}(\\frac{\\Delta x}{2}-\\Delta x)}{2(\\Delta x)^2} - \\phi_i \\frac{(\\frac{\\Delta x}{2})^2 - (\\Delta x)^2}{(\\Delta x)^2} + \\phi_{i+1} \\frac{\\frac{\\Delta x}{2}(\\frac{\\Delta x}{2}+\\Delta x)}{2(\\Delta x)^2} $$\n$$ \\phi_{i+1/2}^{QUICK} = \\phi_{i-1} \\frac{\\frac{\\Delta x}{2}(-\\frac{\\Delta x}{2})}{2(\\Delta x)^2} - \\phi_i \\frac{\\frac{(\\Delta x)^2}{4} - (\\Delta x)^2}{(\\Delta x)^2} + \\phi_{i+1} \\frac{\\frac{\\Delta x}{2}(\\frac{3\\Delta x}{2})}{2(\\Delta x)^2} $$\n$$ \\phi_{i+1/2}^{QUICK} = \\phi_{i-1} \\frac{-\\frac{(\\Delta x)^2}{4}}{2(\\Delta x)^2} - \\phi_i \\frac{-\\frac{3(\\Delta x)^2}{4}}{(\\Delta x)^2} + \\phi_{i+1} \\frac{\\frac{3(\\Delta x)^2}{4}}{2(\\Delta x)^2} $$\n$$ \\phi_{i+1/2}^{QUICK} = -\\frac{1}{8}\\phi_{i-1} + \\frac{3}{4}\\phi_i + \\frac{3}{8}\\phi_{i+1} $$\n将各项通分，公分母为8：\n$$ \\phi_{i+1/2}^{QUICK} = \\frac{6}{8}\\phi_i + \\frac{3}{8}\\phi_{i+1} - \\frac{1}{8}\\phi_{i-1} = \\frac{1}{8}(6\\phi_i + 3\\phi_{i+1} - \\phi_{i-1}) $$\n\n最后，我们使用提供的样本值来计算数值结果。\n已知：$\\phi_{i-1}=1$、$\\phi_{i}=2$、$\\phi_{i+1}=4$。\n\n1.  计算供体单元上风格式的面值：\n    $$ \\phi_{i+1/2}^{UP} = \\phi_i = 2 $$\n\n2.  计算 QUICK 格式的面值：\n    $$ \\phi_{i+1/2}^{QUICK} = \\frac{1}{8}(6\\phi_i + 3\\phi_{i+1} - \\phi_{i-1}) = \\frac{1}{8}(6(2) + 3(4) - 1) $$\n    $$ \\phi_{i+1/2}^{QUICK} = \\frac{1}{8}(12 + 12 - 1) = \\frac{23}{8} $$\n\n3.  计算延迟修正贡献项 $\\delta$：\n    延迟修正项是面值的高阶 (QUICK) 近似和低阶 (上风) 近似之间的差值。\n    $$ \\delta = \\phi_{i+1/2}^{QUICK} - \\phi_{i+1/2}^{UP} $$\n    $$ \\delta = \\frac{23}{8} - 2 = \\frac{23}{8} - \\frac{16}{8} = \\frac{7}{8} $$\n\n所需的三个值为 $\\phi_{i+1/2}^{UP} = 2$、$\\phi_{i+1/2}^{QUICK} = \\frac{23}{8}$ 和 $\\delta = \\frac{7}{8}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & \\frac{23}{8} & \\frac{7}{8}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "计算出界面值是中间步骤，最终目标是构建整个计算域的代数方程组。本练习将带您将QUICK格式应用于稳态一维对流扩散方程，推导出一个内部控制体的完整离散代数方程。这能帮助您理解高阶格式如何影响最终线性方程组中的系数，是将理论知识应用于实际CFD代码开发的关键一步。",
            "id": "3961003",
            "problem": "考虑一个输运标量 $ \\phi(x) $ 的稳态一维 ($1$D) 对流扩散方程，其速度 $ u $ 和扩散系数 $ \\Gamma $ 均为常数，\n$$\nu \\, \\frac{\\partial \\phi}{\\partial x} \\;=\\; \\Gamma \\, \\frac{\\partial^2 \\phi}{\\partial x^2} \\;+\\; S(\\phi),\n$$\n该方程建立在宽度为 $ \\Delta x $、单位横截面积的均匀控制体网格上。假设密度为单位值，因此一个面上的对流通量为 $ u \\, \\phi_f $。设源项在控制体 $ i $ 内线性化为 $ S(\\phi) = S_{P,i} \\, \\phi_i + S_{U,i} $，其中 $ S_{P,i} \\le 0 $。\n\n使用有限体积法，对由面 $ w $ 和 $ e $ 界定的控制体 $ i $ 进行积分。对于扩散面通量，使用中心差分格式，即：\n$$\n\\left( \\Gamma \\, \\frac{\\partial \\phi}{\\partial x} \\right)_e \\approx \\Gamma \\, \\frac{\\phi_E - \\phi_P}{\\Delta x}, \n\\qquad\n\\left( \\Gamma \\, \\frac{\\partial \\phi}{\\partial x} \\right)_w \\approx \\Gamma \\, \\frac{\\phi_P - \\phi_W}{\\Delta x}.\n$$\n对于对流面值，在速度 $ u > 0 $ 为正的情况下，使用对流运动学的二次上游插值 (Quadratic Upstream Interpolation for Convective Kinematics, QUICK) 格式。在均匀网格上，通过在东面计算经过 $ \\phi_W, \\phi_P, \\phi_E $ 的二次函数来获得 $ \\phi_e $，通过在西面计算经过 $ \\phi_{WW}, \\phi_W, \\phi_P $ 的二次函数来获得 $ \\phi_w $。\n\n从积分平衡和上述近似出发，推导内部控制体 $ i $ 的线性化代数方程，其形式为\n$$\na_{P,i} \\, \\phi_i \\;=\\; a_{WW,i} \\, \\phi_{i-2} \\;+\\; a_{W,i} \\, \\phi_{i-1} \\;+\\; a_{E,i} \\, \\phi_{i+1} \\;+\\; a_{EE,i} \\, \\phi_{i+2} \\;+\\; b_i,\n$$\n并求出系数 $ a_{WW,i}, a_{W,i}, a_{P,i}, a_{E,i}, a_{EE,i}, b_i $ 的显式表达式，用 $ u, \\Gamma, \\Delta x, S_{P,i}, S_{U,i} $ 表示，适用于 $ u > 0 $ 的情况，在均匀网格上，扩散项使用中心差分，对流项使用上述指定的 QUICK 格式。假设除了 $ S(\\phi) $ 之外没有其他源项。\n\n你的最终答案必须是一个单一的解析表达式，以行矩阵的形式报告有序系数\n$$\n\\left[ a_{WW,i} \\;\\; a_{W,i} \\;\\; a_{P,i} \\;\\; a_{E,i} \\;\\; a_{EE,i} \\;\\; b_i \\right].\n$$",
            "solution": "该问题是有效的。它提出了计算流体动力学中的一个标准的、适定的任务：为稳态一维对流扩散方程的有限体积离散化推导代数系数。问题设定是自洽的且科学上是合理的。方程的目标形式包含一个节点系数 $a_{EE,i}$，对于指定的正速度 $u > 0$ 的迎风偏置 QUICK 格式，该系数预计为零。然而，这并不矛盾，因为通过发现该特定系数为零即可解决该问题，这是一个有效的结果。\n\n推导过程如下。\n\n步骤 1：控制方程的积分形式\n稳态一维对流扩散方程由下式给出：\n$$u \\, \\frac{\\partial \\phi}{\\partial x} \\;=\\; \\Gamma \\, \\frac{\\partial^2 \\phi}{\\partial x^2} \\;+\\; S(\\phi)$$\n我们将此方程在一个宽度为 $\\Delta x$、单位横截面积的控制体 (CV) $i$ 上进行积分，该控制体以节点 $P$ (或 $i$) 为中心。该控制体由西面 $w$ 和东面 $e$ 界定。\n$$\\int_{w}^{e} \\left( \\frac{d}{dx} (u \\phi) - \\frac{d}{dx} \\left(\\Gamma \\frac{d\\phi}{dx}\\right) - S(\\phi) \\right) dx \\;=\\; 0$$\n应用散度定理，得到面上通量和积分源项的平衡：\n$$\\left( u \\phi - \\Gamma \\frac{d\\phi}{dx} \\right)_e - \\left( u \\phi - \\Gamma \\frac{d\\phi}{dx} \\right)_w - \\int_{w}^{e} S(\\phi) \\, dx \\;=\\; 0$$\n一个面上的总通量为 $J = u \\phi - \\Gamma \\frac{d\\phi}{dx}$。积分源项近似为 $\\bar{S}_i \\Delta x$，其中 $\\bar{S}_i$ 是控制体上的平均源项。使用给定的线性化源项形式 $S(\\phi) = S_{P,i} \\, \\phi_i + S_{U,i}$，积分变为 $(S_{P,i} \\, \\phi_i + S_{U,i}) \\Delta x$。因此平衡方程为：\n$$J_e - J_w - (S_{P,i} \\, \\phi_i + S_{U,i}) \\Delta x \\;=\\; 0$$\n\n步骤 2：通量的离散化\n扩散通量按规定使用中心差分格式进行近似。速度 $u$ 和扩散系数 $\\Gamma$ 是常数。\n在面 $e$ 上的扩散通量为 $-\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e \\approx -\\Gamma \\frac{\\phi_E - \\phi_P}{\\Delta x}$。\n在面 $w$ 上的扩散通量为 $-\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w \\approx -\\Gamma \\frac{\\phi_P - \\phi_W}{\\Delta x}$。\n注意，节点 $P$ 对应于索引 $i$，$W$ 对应于 $i-1$，$E$ 对应于 $i+1$，依此类推。\n\n对流通量由 $u \\phi_f$ 给出，其中 $\\phi_f$ 是面上的 $\\phi$ 值。QUICK 格式用于近似 $\\phi_f$。对于 $u>0$，流动方向是从西到东。\n\n对于控制体 $i$ 的东面 $e$，上游方向是西。QUICK 格式使用一个二次多项式，该多项式拟合了两个最近的上游节点 ($W, P$) 和一个最近的下游节点 ($E$)。在面 $e$ (位于 $x_P + \\Delta x/2$) 上的值为：\n$$\\phi_e = \\frac{3}{8}\\phi_E + \\frac{6}{8}\\phi_P - \\frac{1}{8}\\phi_W$$\n对于控制体 $i$ 的西面 $w$，上游方向也是西。两个最近的上游节点是 $WW$ 和 $W$，最近的下游节点是 $P$。在面 $w$ (位于 $x_P - \\Delta x/2$) 上的值为：\n$$\\phi_w = \\frac{3}{8}\\phi_P + \\frac{6}{8}\\phi_W - \\frac{1}{8}\\phi_{WW}$$\n\n步骤 3：组装代数方程\n我们将这些近似值代入平衡方程：\n$$u \\phi_e - u \\phi_w - \\left(\\Gamma \\frac{\\phi_E - \\phi_P}{\\Delta x}\\right) + \\left(\\Gamma \\frac{\\phi_P - \\phi_W}{\\Delta x}\\right) - (S_{P,i} \\, \\phi_i + S_{U,i}) \\Delta x \\;=\\; 0$$\n让我们代入 $\\phi_e$ 和 $\\phi_w$ 的 QUICK 表达式：\n$$u \\left( \\frac{3}{8}\\phi_E + \\frac{6}{8}\\phi_P - \\frac{1}{8}\\phi_W \\right) - u \\left( \\frac{3}{8}\\phi_P + \\frac{6}{8}\\phi_W - \\frac{1}{8}\\phi_{WW} \\right) - \\frac{\\Gamma}{\\Delta x}(\\phi_E - 2\\phi_P + \\phi_W) - (S_{P,i} \\, \\phi_P + S_{U,i}) \\Delta x \\;=\\; 0$$\n我们现在收集每个节点值 $\\phi_{WW}, \\phi_W, \\phi_P, \\phi_E$ 的系数。\n对于 $\\phi_{WW}$ (索引 $i-2$)：\n$$u \\left( \\frac{1}{8} \\right) \\phi_{WW} = \\frac{u}{8} \\phi_{WW}$$\n对于 $\\phi_W$ (索引 $i-1$)：\n$$-\\frac{u}{8}\\phi_W - \\frac{6u}{8}\\phi_W - \\frac{\\Gamma}{\\Delta x}\\phi_W = \\left(-\\frac{7u}{8} - \\frac{\\Gamma}{\\Delta x}\\right) \\phi_W$$\n对于 $\\phi_P$ (索引 $i$)：\n$$\\frac{6u}{8}\\phi_P - \\frac{3u}{8}\\phi_P + \\frac{2\\Gamma}{\\Delta x}\\phi_P - S_{P,i}\\Delta x\\, \\phi_P = \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right) \\phi_P$$\n对于 $\\phi_E$ (索引 $i+1$)：\n$$\\frac{3u}{8}\\phi_E - \\frac{\\Gamma}{\\Delta x}\\phi_E = \\left(\\frac{3u}{8} - \\frac{\\Gamma}{\\Delta x}\\right) \\phi_E$$\n对于 $\\phi_{EE}$ (索引 $i+2$)：系数为 $0$。\n\n恒定源项的贡献是 $-S_{U,i}\\Delta x$。\n\n合并所有项，我们得到控制体 $i$ 的完整代数方程：\n$$ \\left(-\\frac{7u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i-1} + \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right)\\phi_i + \\left(\\frac{3u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i+1} + \\left(\\frac{u}{8}\\right)\\phi_{i-2} - S_{U,i}\\Delta x = 0 $$\n该方程通常被写为：\n$$ a_P \\phi_P = a_W \\phi_W + a_E \\phi_E + a_{WW}\\phi_{WW} + a_{EE}\\phi_{EE} + b $$\n其中系数通常是正的。在我们的情况下，原始形式是\n$$ a_{WW}\\phi_{WW} + a_W\\phi_W + a_P\\phi_P + a_E\\phi_E = S_{U,i}\\Delta x $$\n其中 $a_P = \\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x$, $a_W = -\\frac{7u}{8} - \\frac{\\Gamma}{\\Delta x}$, $a_E = \\frac{3u}{8} - \\frac{\\Gamma}{\\Delta x}$, $a_{WW} = \\frac{u}{8}$。\n\n步骤 4：重排为目标形式\n问题要求方程的形式为：\n$$a_{P,i} \\, \\phi_i \\;=\\; a_{WW,i} \\, \\phi_{i-2} \\;+\\; a_{W,i} \\, \\phi_{i-1} \\;+\\; a_{E,i} \\, \\phi_{i+1} \\;+\\; a_{EE,i} \\, \\phi_{i+2} \\;+\\; b_i$$\n为了实现这一点，我们将 $\\phi_i$ 项保留在左侧，并将所有其他项移动到右侧。\n$$ \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right)\\phi_i = -\\left(\\frac{u}{8}\\right)\\phi_{i-2} - \\left(-\\frac{7u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i-1} - \\left(\\frac{3u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i+1} + (0)\\phi_{i+2} + S_{U,i}\\Delta x $$\n简化右侧的系数：\n$$ \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right)\\phi_i = \\left(-\\frac{u}{8}\\right)\\phi_{i-2} + \\left(\\frac{7u}{8} + \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i-1} + \\left(\\frac{\\Gamma}{\\Delta x} - \\frac{3u}{8}\\right)\\phi_{i+1} + (0)\\phi_{i+2} + S_{U,i}\\Delta x $$\n\n步骤 5：确定系数\n通过将此结果与目标形式进行比较，我们确定系数：\n$a_{WW,i} = -\\frac{u}{8}$\n$a_{W,i} = \\frac{7u}{8} + \\frac{\\Gamma}{\\Delta x}$\n$a_{P,i} = \\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x$\n$a_{E,i} = \\frac{\\Gamma}{\\Delta x} - \\frac{3u}{8}$\n$a_{EE,i} = 0$\n$b_i = S_{U,i}\\Delta x$\n\n这些系数的表达式是问题的解。它们在下面以行矩阵的形式报告。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{u}{8} & \\frac{7u}{8} + \\frac{\\Gamma}{\\Delta x} & \\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x & \\frac{\\Gamma}{\\Delta x} - \\frac{3u}{8} & 0 & S_{U,i}\\Delta x\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "数值格式在计算域内部和边界处的应用方式往往不同，边界处理是保证计算稳定性和准确性的关键。本练习将探讨如何在给定值的入口边界上应用QUICK格式，这需要特殊处理以维持格式的精度。通过构建一个与边界条件相容的虚拟网格点，您将学习到如何调整插值模板，这是在实际工程问题中正确实施高阶格式的必备技能。",
            "id": "3961006",
            "problem": "考虑一个无源标量场 $\\phi(x)$ 在一个恒定密度、恒定速度流中的一维稳态对流。流向速度为 $u>0$，计算区域位于一个间距为 $\\Delta x$ 的均匀有限体积网格上。位于 $x=0$ 的左边界是一个入口，其在 $x=0$ 处的界面上具有给定的狄利克雷值 $\\phi_{in}$。前两个内部单元中心的坐标分别为 $x_{P}=\\Delta x/2$ 和 $x_{E}=3\\Delta x/2$，这两个中心之间的内部界面位于 $x_{e}=\\Delta x$。\n\n在有限体积法中，界面上的对流通量是使用插值得到的界面值计算的。为了在 $u>0$ 时在入口附近达到三阶空间精度，我们使用对流运动学二次上游插值 (QUICK) 格式，该方法通过计算一个由三个上游偏置点构造的二次多项式来获得界面值。在入口附近，将边界处理为提供一个虚拟单元值，以便精确满足边界界面上的狄利克雷条件。\n\n具体步骤如下：\n- 在入口界面 $x=0$ 处精确施加边界条件，并确定在 $x=-\\Delta x/2$ 处的等效虚拟单元中心值。该值需与虚拟单元中心和第一个内部单元中心之间的线性变化一致，从而使得在 $x=0$ 处的界面值等于 $\\phi_{in}$。\n- 然后，构造一个穿过位于虚拟单元中心 $x=-\\Delta x/2$、第一个内部单元中心 $x=\\Delta x/2$ 和第二个内部单元中心 $x=3\\Delta x/2$ 这三个点的二次多项式，并在内部界面位置 $x=\\Delta x$ 处计算该多项式的值。\n\n推导在 $x=\\Delta x$ 处得到的 QUICK 界面值 $\\phi_{e}$，将其表示为 $\\phi_{in}$、$\\phi_{P}\\equiv\\phi(x_{P})$ 和 $\\phi_{E}\\equiv\\phi(x_{E})$ 的闭式解析表达式。您的最终答案必须是一个单一的解析表达式。不要进行四舍五入。最终结果必须仅用 $\\phi_{in}$、$\\phi_{P}$ 和 $\\phi_{E}$ 表示。",
            "solution": "用户希望使用一种特定的边界条件处理方法，来计算入口附近一个内部界面上的 QUICK 格式界面值。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n- **物理系统**：一维稳态对流的无源标量场 $\\phi(x)$。\n- **流动特性**：恒定密度，恒定正流向速度 $u > 0$。\n- **网格**：间距为 $\\Delta x$ 的均匀有限体积网格。\n- **边界**：位于 $x=0$ 的左边界是一个入口，在 $x=0$ 处的界面上具有给定的狄利克雷值 $\\phi_{in}$。\n- **网格点位置**：\n    - 第一个内部单元中心 (P): $x_P = \\frac{\\Delta x}{2}$。\n    - 第二个内部单元中心 (E): $x_E = \\frac{3\\Delta x}{2}$。\n    - P 和 E 之间的内部界面 (e): $x_e = \\Delta x$。\n    - 等效虚拟单元中心 (W): $x_W = -\\frac{\\Delta x}{2}$。\n- **插值格式**：对流运动学二次上游插值 (QUICK)。\n- **边界条件实施**：\n    1. 虚拟单元的值 $\\phi_W \\equiv \\phi(x_W)$ 通过假设虚拟单元中心 $(x_W, \\phi_W)$ 和第一个内部单元中心 $(x_P, \\phi_P)$ 之间存在线性变化来确定，从而精确满足在 $x=0$ 处的界面值为 $\\phi_{in}$。\n    2. 构造一个二次多项式，使其穿过对应于虚拟单元中心、第一个内部单元中心和第二个内部单元中心的三个点。这些点是 $(x_W, \\phi_W)$、$(x_P, \\phi_P)$ 和 $(x_E, \\phi_E)$。\n- **任务**：通过在 $x_e = \\Delta x$ 处计算构造出的二次多项式，推导出界面值 $\\phi_e \\equiv \\phi(x_e)$。结果应为以 $\\phi_{in}$、$\\phi_P \\equiv \\phi(x_P)$ 和 $\\phi_E \\equiv \\phi(x_E)$ 表示的表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学依据充分**：该问题是计算流体力学 (CFD) 中的一个标准练习，涉及一种特定类型的边界条件下高阶数值格式 (QUICK) 的实现。这是输运现象数值方法中的一个成熟课题。\n- **提法恰当**：该问题为唯一的推导提供了所有必要的信息和条件。步骤阐述清晰。\n- **客观性**：问题以精确、正式的语言陈述，没有歧义或主观内容。\n\n**步骤 3：结论与行动**\n\n此问题有效。它具有科学依据，提法恰当且客观。将提供详细的解决方案。\n\n### 解答推导\n\n推导过程主要分为三个步骤：\n1. 确定虚拟单元中心处的标量值 $\\phi_W$。\n2. 使用指定的三个点构造二次插值多项式。\n3. 在界面位置 $x_e$ 处计算该多项式的值，并代入 $\\phi_W$ 的表达式。\n\n**步骤 1：确定虚拟单元值**\n\n问题指明，通过在虚拟单元中心值 $\\phi_W$（位于 $x_W = -\\frac{\\Delta x}{2}$）和第一个内部单元中心值 $\\phi_P$（位于 $x_P = \\frac{\\Delta x}{2}$）之间强制施加一个线性关系来满足边界条件 $\\phi(0) = \\phi_{in}$。\n\n穿过点 $(x_W, \\phi_W)$ 和 $(x_P, \\phi_P)$ 的线性函数 $\\phi(x)$ 由下式给出：\n$$\n\\phi(x) = \\phi_W + (\\phi_P - \\phi_W) \\frac{x - x_W}{x_P - x_W}\n$$\n我们在边界界面 $x=0$ 处计算该函数值，令其等于 $\\phi_{in}$：\n$$\n\\phi_{in} = \\phi_W + (\\phi_P - \\phi_W) \\frac{0 - (-\\frac{\\Delta x}{2})}{\\frac{\\Delta x}{2} - (-\\frac{\\Delta x}{2})}\n$$\n$$\n\\phi_{in} = \\phi_W + (\\phi_P - \\phi_W) \\frac{\\frac{\\Delta x}{2}}{\\Delta x} = \\phi_W + \\frac{1}{2}(\\phi_P - \\phi_W)\n$$\n$$\n\\phi_{in} = \\frac{1}{2}\\phi_W + \\frac{1}{2}\\phi_P = \\frac{\\phi_W + \\phi_P}{2}\n$$\n这个结果是符合预期的，因为 $x=0$ 是 $x_W$ 和 $x_P$ 的中点。求解虚拟单元值 $\\phi_W$，我们得到：\n$$\n\\phi_W = 2\\phi_{in} - \\phi_P\n$$\n\n**步骤 2：为界面值构造二次插值**\n\nQUICK 格式使用二次多项式来插值界面值。问题指出，对于位于 $x_e=\\Delta x$ 的界面 $e$，多项式 $\\phi(x)$ 必须穿过三个点 $(x_W, \\phi_W)$、$(x_P, \\phi_P)$ 和 $(x_E, \\phi_E)$，它们的坐标是：\n- $x_W = -\\frac{\\Delta x}{2}$\n- $x_P = \\frac{\\Delta x}{2}$\n- $x_E = \\frac{3\\Delta x}{2}$\n\n我们使用拉格朗日插值法来找到该多项式在 $x_e = \\Delta x$ 处的值。多项式的拉格朗日形式为：\n$$\n\\phi(x) = \\phi_W L_W(x) + \\phi_P L_P(x) + \\phi_E L_E(x)\n$$\n其中 $L_W(x)$、$L_P(x)$ 和 $L_E(x)$ 是拉格朗日基多项式。我们需要在 $x=x_e=\\Delta x$ 处计算它们的值。\n\n点 $W$ 的基多项式为：\n$$\nL_W(x_e) = \\frac{(x_e - x_P)(x_e - x_E)}{(x_W - x_P)(x_W - x_E)} = \\frac{(\\Delta x - \\frac{\\Delta x}{2})(\\Delta x - \\frac{3\\Delta x}{2})}{(-\\frac{\\Delta x}{2} - \\frac{\\Delta x}{2})(-\\frac{\\Delta x}{2} - \\frac{3\\Delta x}{2})} = \\frac{(\\frac{\\Delta x}{2})(-\\frac{\\Delta x}{2})}{(-\\Delta x)(-2\\Delta x)} = \\frac{-\\frac{\\Delta x^2}{4}}{2\\Delta x^2} = -\\frac{1}{8}\n$$\n点 $P$ 的基多项式为：\n$$\nL_P(x_e) = \\frac{(x_e - x_W)(x_e - x_E)}{(x_P - x_W)(x_P - x_E)} = \\frac{(\\Delta x - (-\\frac{\\Delta x}{2}))(\\Delta x - \\frac{3\\Delta x}{2})}{(\\frac{\\Delta x}{2} - (-\\frac{\\Delta x}{2}))(\\frac{\\Delta x}{2} - \\frac{3\\Delta x}{2})} = \\frac{(\\frac{3\\Delta x}{2})(-\\frac{\\Delta x}{2})}{(\\Delta x)(-\\Delta x)} = \\frac{-\\frac{3\\Delta x^2}{4}}{-\\Delta x^2} = \\frac{3}{4}\n$$\n点 $E$ 的基多项式为：\n$$\nL_E(x_e) = \\frac{(x_e - x_W)(x_e - x_P)}{(x_E - x_W)(x_E - x_P)} = \\frac{(\\Delta x - (-\\frac{\\Delta x}{2}))(\\Delta x - \\frac{\\Delta x}{2})}{(\\frac{3\\Delta x}{2} - (-\\frac{\\Delta x}{2}))(\\frac{3\\Delta x}{2} - \\frac{\\Delta x}{2})} = \\frac{(\\frac{3\\Delta x}{2})(\\frac{\\Delta x}{2})}{(2\\Delta x)(\\Delta x)} = \\frac{\\frac{3\\Delta x^2}{4}}{2\\Delta x^2} = \\frac{3}{8}\n$$\n因此，界面上的插值 $\\phi_e = \\phi(x_e)$ 为：\n$$\n\\phi_e = \\phi_W L_W(x_e) + \\phi_P L_P(x_e) + \\phi_E L_E(x_e) = -\\frac{1}{8}\\phi_W + \\frac{3}{4}\\phi_P + \\frac{3}{8}\\phi_E\n$$\n\n**步骤 3：代入虚拟单元值并最终简化**\n\n现在我们将步骤 1 中得到的 $\\phi_W$ 表达式代入 $\\phi_e$ 的表达式中：\n$$\n\\phi_e = -\\frac{1}{8}(2\\phi_{in} - \\phi_P) + \\frac{3}{4}\\phi_P + \\frac{3}{8}\\phi_E\n$$\n展开第一项：\n$$\n\\phi_e = -\\frac{2}{8}\\phi_{in} + \\frac{1}{8}\\phi_P + \\frac{3}{4}\\phi_P + \\frac{3}{8}\\phi_E\n$$\n为了合并含有 $\\phi_P$ 的项，我们使用公分母 8：\n$$\n\\phi_e = -\\frac{1}{4}\\phi_{in} + \\frac{1}{8}\\phi_P + \\frac{6}{8}\\phi_P + \\frac{3}{8}\\phi_E\n$$\n$$\n\\phi_e = -\\frac{1}{4}\\phi_{in} + \\frac{7}{8}\\phi_P + \\frac{3}{8}\\phi_E\n$$\n该表达式给出了以入口边界值 $\\phi_{in}$ 以及两个相邻的内部单元中心值 $\\phi_P$ 和 $\\phi_E$ 表示的界面值 $\\phi_e$。为了将其表示为单个分数：\n$$\n\\phi_e = \\frac{-2\\phi_{in} + 7\\phi_P + 3\\phi_E}{8}\n$$",
            "answer": "$$\n\\boxed{\\frac{7\\phi_P + 3\\phi_E - 2\\phi_{in}}{8}}\n$$"
        }
    ]
}