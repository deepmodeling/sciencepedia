{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握QUICK格式，最好的起点是将其与更简单的一阶格式进行直接比较。本练习将引导您从基本原理出发，推导QUICK格式在一维稳态平流问题中的表达式，并将其与经典的一阶迎风格式进行对比。通过计算一个具体示例，您将能够量化QUICK格式引入的“延迟修正项”，从而直观地理解高阶格式是如何通过更精确的插值来改进数值解的。",
            "id": "3306422",
            "problem": "考虑一个由标量守恒控制的一维稳态平流的被动标量场 $\\phi(x)$，因此当密度 $\\rho$ 和速度 $u$ 均匀时，对流通量 $\\rho u \\phi$ 沿 $x$ 在空间上是恒定的。使用有限体积法 (FVM)，在以 $x_{i-1}$、$x_{i}$、$x_{i+1}$ 和 $x_{i+2}$ 为网格中心，以 $x_{i-1/2}$、$x_{i+1/2}$ 和 $x_{i+3/2}$ 为网格面的均匀网格上进行离散化时，需要对面值 $\\phi_{i+1/2}$ 进行近似，以封闭穿过单元 $i$ 和 $i+1$ 之间网格面的对流通量。对于严格为正的速度 ($u0$)，一阶施主单元迎风近似和高阶的对流运动学的二次迎风插值 (QUICK) 格式提供了两种不同的面值重构方法。\n\n从平流的守恒律基础和均匀网格的几何形状出发，完成以下操作：\n- 对于 $u0$，通过识别物理上正确的施主状态并用相邻网格中心值表示 $\\phi_{i+1/2}^{UP}$，推导施主单元迎风面值。\n- 对于 $u0$，通过构造唯一的二次多项式，该多项式对迎风偏置模板的网格中心值进行插值，并在网格面位置求值，独立推导 QUICK 面值。\n- 使用样本值 $\\phi_{i-1}=1$、$\\phi_{i}=2$、$\\phi_{i+1}=4$ 和 $\\phi_{i+2}=8$，计算 $\\phi_{i+1/2}^{UP}$ 和 $\\phi_{i+1/2}^{QUICK}$，并确定延迟修正贡献项 $\\delta=\\phi_{i+1/2}^{QUICK}-\\phi_{i+1/2}^{UP}$，这是在延迟修正公式中加到迎风通量上的修正项。\n\n将最终答案表示为行矩阵 $\\left[ \\phi_{i+1/2}^{UP}, \\, \\phi_{i+1/2}^{QUICK}, \\, \\delta \\right]$，使用精确值。不要四舍五入；请提供精确数值。",
            "solution": "该问题要求推导和应用两种有限体积对流格式，即一阶施主单元迎风格式和对流运动学的二次迎风插值 (QUICK) 格式，以确定标量场 $\\phi$ 在网格面上的值。最终目标是计算延迟修正项，即高阶近似与低阶近似之间的差值。\n\n物理基础是被动标量 $\\phi(x)$ 的一维稳态平流，由守恒律控制：\n$$ \\frac{d}{dx}(\\rho u \\phi) = 0 $$\n其中 $\\rho$ 是密度，$u$ 是速度。问题说明 $\\rho$ 和 $u$ 是均匀且恒定的，且 $u  0$。方程简化为：\n$$ u \\frac{d\\phi}{dx} = 0 $$\n在有限体积法 (FVM) 中，此方程在一个以 $x_i$ 为中心、从网格面 $x_{i-1/2}$ 延伸到 $x_{i+1/2}$ 的控制体（一个单元）上进行积分。\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} u \\frac{d\\phi}{dx} dx = 0 $$\n$$ u [\\phi]_{x_{i-1/2}}^{x_{i+1/2}} = 0 $$\n$$ u (\\phi_{i+1/2} - \\phi_{i-1/2}) = 0 $$\n这里，$\\phi_{i+1/2}$ 和 $\\phi_{i-1/2}$ 是标量在网格面上的值。为了数值求解这个代数方程组，必须用已知的网格中心值 $\\phi_i$ 来表示这些面值。这就是对流格式的作用。\n\n首先，我们推导施主单元迎风面值 $\\phi_{i+1/2}^{UP}$ 的表达式。\n施主单元或一阶迎风 (FOU) 格式是基于流动方向的。它用“施主”单元的网格中心值来近似网格面上的值，施主单元是紧邻该面上游的单元。问题指定速度严格为正，$u  0$，意味着流动是从左到右（沿 $x$ 增加的方向）。对于位于单元 $i$ 和单元 $i+1$ 之间的网格面 $x_{i+1/2}$，上游方向是向左。因此，施主单元是单元 $i$。该格式将面值设为等于施主单元中心的值。\n$$ \\phi_{i+1/2}^{UP} = \\phi_i $$\n\n接下来，我们推导 QUICK 面值 $\\phi_{i+1/2}^{QUICK}$ 的表达式。\nQUICK 格式构造一个二次多项式来插值得到面上的值。为实现迎风特性，插值模板向上游方向偏置。为了求得在 $u  0$ 时网格面 $x_{i+1/2}$ 处的值，该格式使用两个最近的上游网格中心和一个最近的下游网格中心。这些是位于 $x_{i-1}$、$x_i$ 和 $x_{i+1}$ 的中心。\n我们构造一个通过点 $(x_{i-1}, \\phi_{i-1})$、$(x_i, \\phi_i)$ 和 $(x_{i+1}, \\phi_{i+1})$ 的二次多项式 $P(x)$。设网格是均匀的，网格间距为 $\\Delta x$。为方便起见，我们可以设置一个局部坐标系，其原点在 $x_i = 0$。那么，$x_{i-1} = -\\Delta x$ 且 $x_{i+1} = \\Delta x$。我们感兴趣的网格面 $x_{i+1/2}$ 位于 $x = \\frac{\\Delta x}{2}$。\n通过这三个点的拉格朗日插值多项式形式为：\n$$ P(x) = \\phi_{i-1} \\frac{(x-x_i)(x-x_{i+1})}{(x_{i-1}-x_i)(x_{i-1}-x_{i+1})} + \\phi_i \\frac{(x-x_{i-1})(x-x_{i+1})}{(x_i-x_{i-1})(x_i-x_{i+1})} + \\phi_{i+1} \\frac{(x-x_{i-1})(x-x_i)}{(x_{i+1}-x_{i-1})(x_{i+1}-x_i)} $$\n代入局部坐标 $x_{i-1}=-\\Delta x$，$x_i=0$，$x_{i+1}=\\Delta x$：\n$$ P(x) = \\phi_{i-1} \\frac{x(x-\\Delta x)}{(-\\Delta x)(-2\\Delta x)} + \\phi_i \\frac{(x+\\Delta x)(x-\\Delta x)}{(\\Delta x)(-\\Delta x)} + \\phi_{i+1} \\frac{x(x+\\Delta x)}{(2\\Delta x)(\\Delta x)} $$\n$$ P(x) = \\phi_{i-1} \\frac{x(x-\\Delta x)}{2(\\Delta x)^2} - \\phi_i \\frac{x^2 - (\\Delta x)^2}{(\\Delta x)^2} + \\phi_{i+1} \\frac{x(x+\\Delta x)}{2(\\Delta x)^2} $$\n我们在此多项式的网格面位置 $x = \\frac{\\Delta x}{2}$ 求值，以得到 $\\phi_{i+1/2}^{QUICK}$。\n$$ \\phi_{i+1/2}^{QUICK} = P\\left(\\frac{\\Delta x}{2}\\right) $$\n$$ \\phi_{i+1/2}^{QUICK} = \\phi_{i-1} \\frac{\\frac{\\Delta x}{2}(\\frac{\\Delta x}{2}-\\Delta x)}{2(\\Delta x)^2} - \\phi_i \\frac{(\\frac{\\Delta x}{2})^2 - (\\Delta x)^2}{(\\Delta x)^2} + \\phi_{i+1} \\frac{\\frac{\\Delta x}{2}(\\frac{\\Delta x}{2}+\\Delta x)}{2(\\Delta x)^2} $$\n$$ \\phi_{i+1/2}^{QUICK} = \\phi_{i-1} \\frac{\\frac{\\Delta x}{2}(-\\frac{\\Delta x}{2})}{2(\\Delta x)^2} - \\phi_i \\frac{\\frac{(\\Delta x)^2}{4} - (\\Delta x)^2}{(\\Delta x)^2} + \\phi_{i+1} \\frac{\\frac{\\Delta x}{2}(\\frac{3\\Delta x}{2})}{2(\\Delta x)^2} $$\n$$ \\phi_{i+1/2}^{QUICK} = \\phi_{i-1} \\frac{-\\frac{(\\Delta x)^2}{4}}{2(\\Delta x)^2} - \\phi_i \\frac{-\\frac{3(\\Delta x)^2}{4}}{(\\Delta x)^2} + \\phi_{i+1} \\frac{\\frac{3(\\Delta x)^2}{4}}{2(\\Delta x)^2} $$\n$$ \\phi_{i+1/2}^{QUICK} = -\\frac{1}{8}\\phi_{i-1} + \\frac{3}{4}\\phi_i + \\frac{3}{8}\\phi_{i+1} $$\n将各项通分，公分母为8：\n$$ \\phi_{i+1/2}^{QUICK} = \\frac{6}{8}\\phi_i + \\frac{3}{8}\\phi_{i+1} - \\frac{1}{8}\\phi_{i-1} = \\frac{1}{8}(6\\phi_i + 3\\phi_{i+1} - \\phi_{i-1}) $$\n\n最后，我们使用给定的样本值计算数值结果。\n已知：$\\phi_{i-1}=1$，$\\phi_{i}=2$，$\\phi_{i+1}=4$。\n\n1.  计算施主单元迎风面值：\n    $$ \\phi_{i+1/2}^{UP} = \\phi_i = 2 $$\n\n2.  计算 QUICK 面值：\n    $$ \\phi_{i+1/2}^{QUICK} = \\frac{1}{8}(6\\phi_i + 3\\phi_{i+1} - \\phi_{i-1}) = \\frac{1}{8}(6(2) + 3(4) - 1) $$\n    $$ \\phi_{i+1/2}^{QUICK} = \\frac{1}{8}(12 + 12 - 1) = \\frac{23}{8} $$\n\n3.  计算延迟修正贡献项 $\\delta$：\n    延迟修正项是高阶 (QUICK) 和低阶 (迎风) 面值近似之间的差值。\n    $$ \\delta = \\phi_{i+1/2}^{QUICK} - \\phi_{i+1/2}^{UP} $$\n    $$ \\delta = \\frac{23}{8} - 2 = \\frac{23}{8} - \\frac{16}{8} = \\frac{7}{8} $$\n\n所需的三个值是 $\\phi_{i+1/2}^{UP} = 2$，$\\phi_{i+1/2}^{QUICK} = \\frac{23}{8}$ 和 $\\delta = \\frac{7}{8}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  \\frac{23}{8}  \\frac{7}{8}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了QUICK格式对单元界面值的计算之后，下一步是将其应用于一个完整的控制方程。本练习将指导您在稳态一维对流-扩散方程的有限体积离散化过程中，同时使用QUICK格式处理对流项和中心差分处理扩散项。完成此练习将帮助您理解如何将高阶格式的界面插值与通量平衡相结合，最终推导出描述每个控制体积的线性代数方程及其系数。",
            "id": "3961003",
            "problem": "考虑一个输运标量 $ \\phi(x) $ 的稳态一维 ($1$D) 对流-扩散方程，其速度 $ u $ 和扩散系数 $ \\Gamma $ 均为常数，\n$$\nu \\, \\frac{\\partial \\phi}{\\partial x} \\;=\\; \\Gamma \\, \\frac{\\partial^2 \\phi}{\\partial x^2} \\;+\\; S(\\phi),\n$$\n该方程建立在宽度为 $ \\Delta x $、单位横截面积的均匀控制体网格上。假设密度为单位密度，因此在某个面上的对流通量为 $ u \\, \\phi_f $。设源项在控制体 $ i $ 内线性化为 $ S(\\phi) = S_{P,i} \\, \\phi_i + S_{U,i} $，其中 $ S_{P,i} \\le 0 $。\n\n使用有限体积法，在由面 $ w $ 和 $ e $ 界定的控制体 $ i $ 上进行积分。对于扩散面通量，使用中心差分法，即\n$$\n\\left( \\Gamma \\, \\frac{\\partial \\phi}{\\partial x} \\right)_e \\approx \\Gamma \\, \\frac{\\phi_E - \\phi_P}{\\Delta x}, \n\\qquad\n\\left( \\Gamma \\, \\frac{\\partial \\phi}{\\partial x} \\right)_w \\approx \\Gamma \\, \\frac{\\phi_P - \\phi_W}{\\Delta x}.\n$$\n对于对流面值，在速度为正 ($ u  0 $) 的情况下，使用对流运动学的二次上游插值 (Quadratic Upstream Interpolation for Convective Kinematics, QUICK) 格式。在均匀网格上，通过经过 $ \\phi_W, \\phi_P, \\phi_E $ 的二次函数在东面求值得到 $ \\phi_e $，通过经过 $ \\phi_{WW}, \\phi_W, \\phi_P $ 的二次函数在西面求值得到 $ \\phi_w $。\n\n从积分平衡和上述近似出发，推导内部控制体 $ i $ 的线性化代数方程，其形式为\n$$\na_{P,i} \\, \\phi_i \\;=\\; a_{WW,i} \\, \\phi_{i-2} \\;+\\; a_{W,i} \\, \\phi_{i-1} \\;+\\; a_{E,i} \\, \\phi_{i+1} \\;+\\; a_{EE,i} \\, \\phi_{i+2} \\;+\\; b_i,\n$$\n并根据上述指定的扩散中心差分和对流QUICK格式，在 $ u  0 $ 的均匀网格情况下，用 $ u, \\Gamma, \\Delta x, S_{P,i}, S_{U,i} $ 给出系数 $ a_{WW,i}, a_{W,i}, a_{P,i}, a_{E,i}, a_{EE,i}, b_i $ 的显式表达式。假设除了 $ S(\\phi) $ 外没有其他源项。\n\n你的最终答案必须是一个单一的解析表达式，以行矩阵的形式报告有序系数 \n$$\n\\left[ a_{WW,i} \\;\\; a_{W,i} \\;\\; a_{P,i} \\;\\; a_{E,i} \\;\\; a_{EE,i} \\;\\; b_i \\right].\n$$",
            "solution": "步骤1：控制方程的积分形式\n稳态一维对流-扩散方程由下式给出：\n$$u \\, \\frac{\\partial \\phi}{\\partial x} \\;=\\; \\Gamma \\, \\frac{\\partial^2 \\phi}{\\partial x^2} \\;+\\; S(\\phi)$$\n我们将此方程在一个宽度为 $\\Delta x$、单位横截面积、以节点 $P$ (或 $i$) 为中心的控制体 (CV) $i$ 上进行积分。该控制体由西面 $w$ 和东面 $e$ 界定。\n$$\\int_{w}^{e} \\left( \\frac{d}{dx} (u \\phi) - \\frac{d}{dx} \\left(\\Gamma \\frac{d\\phi}{dx}\\right) - S(\\phi) \\right) dx \\;=\\; 0$$\n应用散度定理，可得到在各面上的通量平衡以及积分源项：\n$$\\left( u \\phi - \\Gamma \\frac{d\\phi}{dx} \\right)_e - \\left( u \\phi - \\Gamma \\frac{d\\phi}{dx} \\right)_w - \\int_{w}^{e} S(\\phi) \\, dx \\;=\\; 0$$\n在某个面上的总通量为 $J = u \\phi - \\Gamma \\frac{d\\phi}{dx}$。积分源项近似为 $\\bar{S}_i \\Delta x$，其中 $\\bar{S}_i$ 是控制体内的平均源。使用给定的线性化源项形式 $S(\\phi) = S_{P,i} \\, \\phi_i + S_{U,i}$，积分变为 $(S_{P,i} \\, \\phi_i + S_{U,i}) \\Delta x$。因此平衡方程为：\n$$J_e - J_w - (S_{P,i} \\, \\phi_i + S_{U,i}) \\Delta x \\;=\\; 0$$\n\n步骤2：通量的离散化\n扩散通量按规定使用中心差分法进行近似。速度 $u$ 和扩散系数 $\\Gamma$ 是常数。\n在面 $e$ 上的扩散通量为 $-\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e \\approx -\\Gamma \\frac{\\phi_E - \\phi_P}{\\Delta x}$。\n在面 $w$ 上的扩散通量为 $-\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w \\approx -\\Gamma \\frac{\\phi_P - \\phi_W}{\\Delta x}$。\n注意，节点 $P$ 对应于索引 $i$，$W$ 对应于 $i-1$，$E$ 对应于 $i+1$，依此类推。\n\n对流通量由 $u \\phi_f$ 给出，其中 $\\phi_f$ 是在面上的 $\\phi$ 值。QUICK 格式用于近似 $\\phi_f$。对于 $u0$，流动方向是从西到东。\n\n对于控制体 $i$ 的东面 $e$，上游方向是西。QUICK 格式使用一个拟合最近的两个上游节点 ($P, W$) 和一个最近的下游节点 ($E$) 的二次多项式。在面 $e$ (位于 $x_P + \\Delta x/2$) 处的值由下式给出：\n$$\\phi_e = \\frac{3}{8}\\phi_E + \\frac{6}{8}\\phi_P - \\frac{1}{8}\\phi_W$$\n对于控制体 $i$ 的西面 $w$，上游方向也是西。最近的两个上游节点是 $W$ 和 $WW$，最近的下游节点是 $P$。在面 $w$ (位于 $x_P - \\Delta x/2$) 处的值为：\n$$\\phi_w = \\frac{3}{8}\\phi_P + \\frac{6}{8}\\phi_W - \\frac{1}{8}\\phi_{WW}$$\n\n步骤3：组装代数方程\n我们将这些近似值代入平衡方程：\n$$u \\phi_e - u \\phi_w - \\left(\\Gamma \\frac{\\phi_E - \\phi_P}{\\Delta x}\\right) + \\left(\\Gamma \\frac{\\phi_P - \\phi_W}{\\Delta x}\\right) - (S_{P,i} \\, \\phi_i + S_{U,i}) \\Delta x \\;=\\; 0$$\n让我们代入 $\\phi_e$ 和 $\\phi_w$ 的 QUICK 表达式：\n$$u \\left( \\frac{3}{8}\\phi_E + \\frac{6}{8}\\phi_P - \\frac{1}{8}\\phi_W \\right) - u \\left( \\frac{3}{8}\\phi_P + \\frac{6}{8}\\phi_W - \\frac{1}{8}\\phi_{WW} \\right) - \\frac{\\Gamma}{\\Delta x}(\\phi_E - 2\\phi_P + \\phi_W) - (S_{P,i} \\, \\phi_P + S_{U,i}) \\Delta x \\;=\\; 0$$\n现在我们收集每个节点值 $\\phi_{WW}, \\phi_W, \\phi_P, \\phi_E$ 的系数。\n对于 $\\phi_{WW}$ (索引 $i-2$)：\n$$u \\left( \\frac{1}{8} \\right) \\phi_{WW} = \\frac{u}{8} \\phi_{WW}$$\n对于 $\\phi_W$ (索引 $i-1$)：\n$$-\\frac{u}{8}\\phi_W - \\frac{6u}{8}\\phi_W - \\frac{\\Gamma}{\\Delta x}\\phi_W = \\left(-\\frac{7u}{8} - \\frac{\\Gamma}{\\Delta x}\\right) \\phi_W$$\n对于 $\\phi_P$ (索引 $i$)：\n$$\\frac{6u}{8}\\phi_P - \\frac{3u}{8}\\phi_P + \\frac{2\\Gamma}{\\Delta x}\\phi_P - S_{P,i}\\Delta x\\, \\phi_P = \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right) \\phi_P$$\n对于 $\\phi_E$ (索引 $i+1$)：\n$$\\frac{3u}{8}\\phi_E - \\frac{\\Gamma}{\\Delta x}\\phi_E = \\left(\\frac{3u}{8} - \\frac{\\Gamma}{\\Delta x}\\right) \\phi_E$$\n对于 $\\phi_{EE}$ (索引 $i+2$)：\n系数为 $0$。\n\n恒定源项的贡献是 $-S_{U,i}\\Delta x$。\n\n合并所有项，我们得到控制体 $i$ 的完整代数方程：\n$$ \\left(\\frac{u}{8}\\right)\\phi_{i-2} + \\left(-\\frac{7u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i-1} + \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right)\\phi_i + \\left(\\frac{3u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i+1} - S_{U,i}\\Delta x = 0 $$\n\n步骤4：整理成目标形式\n问题要求方程的形式为：\n$$a_{P,i} \\, \\phi_i \\;=\\; a_{WW,i} \\, \\phi_{i-2} \\;+\\; a_{W,i} \\, \\phi_{i-1} \\;+\\; a_{E,i} \\, \\phi_{i+1} \\;+\\; a_{EE,i} \\, \\phi_{i+2} \\;+\\; b_i$$\n为此，我们将 $\\phi_i$ 项保留在左侧，并将所有其他项移到右侧。\n$$ \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right)\\phi_i = -\\left(\\frac{u}{8}\\right)\\phi_{i-2} - \\left(-\\frac{7u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i-1} - \\left(\\frac{3u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i+1} + (0)\\phi_{i+2} + S_{U,i}\\Delta x $$\n简化右侧的系数：\n$$ \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right)\\phi_i = \\left(-\\frac{u}{8}\\right)\\phi_{i-2} + \\left(\\frac{7u}{8} + \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i-1} + \\left(\\frac{\\Gamma}{\\Delta x} - \\frac{3u}{8}\\right)\\phi_{i+1} + (0)\\phi_{i+2} + S_{U,i}\\Delta x $$\n\n步骤5：确定系数\n通过将此结果与目标形式进行比较，我们确定系数：\n$a_{WW,i} = -\\frac{u}{8}$\n$a_{W,i} = \\frac{7u}{8} + \\frac{\\Gamma}{\\Delta x}$\n$a_{P,i} = \\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x$\n$a_{E,i} = \\frac{\\Gamma}{\\Delta x} - \\frac{3u}{8}$\n$a_{EE,i} = 0$\n$b_i = S_{U,i}\\Delta x$\n\n这些系数的表达式是问题的解。它们在下面以行矩阵的形式报告。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{u}{8}  \\frac{7u}{8} + \\frac{\\Gamma}{\\Delta x}  \\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x  \\frac{\\Gamma}{\\Delta x} - \\frac{3u}{8}  0  S_{U,i}\\Delta x\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理论在计算域内部的应用是一回事，但在边界处进行正确处理则是另一项挑战，这往往是数值稳定性和准确性的关键。本练习将重点关注如何在入口边界处实施QUICK格式，这是一个非常常见的实际场景。您将学习如何通过引入“虚拟网格”的概念来构造一个既能精确满足给定边界条件，又与内部格式保持兼容的边界处理方案。",
            "id": "3961006",
            "problem": "考虑在间距为 $\\Delta x$ 的均匀有限体积网格上，一个无源标量场 $\\phi(x)$ 在流向速度为 $u0$ 的恒定密度、恒定速度流场中的一维稳态对流。位于 $x=0$ 处的左边界是一个入口，其面上的狄利克雷(Dirichlet)值为给定的 $\\phi_{in}$。前两个内部单元中心的坐标分别为 $x_{P}=\\Delta x/2$ 和 $x_{E}=3\\Delta x/2$，这两个中心之间的内部面位于 $x_{e}=\\Delta x$。\n\n在有限体积法中，面上的对流通量是通过使用插值的面上值来计算的。为了在 $u0$ 的情况下在入口附近达到三阶空间精度，使用对流运动学的二次上游插值 (QUICK) 方法，该方法通过由三个上游偏置点构造的二次多项式进行求值。在入口附近，将边界视为提供一个虚拟单元值，从而精确满足边界面上的狄利克雷(Dirichlet)条件。\n\n具体来说：\n- 精确地在入口面 $x=0$ 施加边界条件，并确定在 $x=-\\Delta x/2$ 处的有效虚拟单元中心值，该值应与虚拟单元中心和第一个内部单元中心之间的线性变化一致，从而使得在 $x=0$ 处的面上值等于 $\\phi_{in}$。\n- 然后，构造一个经过虚拟单元中心 $x=-\\Delta x/2$、第一个内部单元中心 $x=\\Delta x/2$ 和第二个内部单元中心 $x=3\\Delta x/2$ 这三个点的二次多项式，并在内部面位置 $x=\\Delta x$ 处对该多项式求值。\n\n推导在 $x=\\Delta x$ 处得到的 QUICK 面上值 $\\phi_{e}$ 的闭式解析表达式，该表达式用 $\\phi_{in}$、$\\phi_{P}\\equiv\\phi(x_{P})$ 和 $\\phi_{E}\\equiv\\phi(x_{E})$ 表示。您的最终答案必须是单一的解析表达式。不要进行四舍五入。最终结果只用 $\\phi_{in}$、$\\phi_{P}$ 和 $\\phi_{E}$ 来表示。",
            "solution": "推导过程主要分为三个步骤：\n1.  确定虚拟单元中心的标量值 $\\phi_W$。\n2.  使用指定的三个点构造二次插值多项式。\n3.  在面位置 $x_e$ 处对该多项式求值，并代入 $\\phi_W$ 的表达式。\n\n**第一步：确定虚拟单元值**\n\n问题规定，边界条件 $\\phi(0) = \\phi_{in}$ 是通过在虚拟单元中心值 $\\phi_W$（位于 $x_W = -\\frac{\\Delta x}{2}$）和第一个内部单元中心值 $\\phi_P$（位于 $x_P = \\frac{\\Delta x}{2}$）之间强制建立线性关系来满足的。\n\n一个通过 $(x_W, \\phi_W)$ 和 $(x_P, \\phi_P)$ 的线性函数 $\\phi(x)$ 由下式给出：\n$$\n\\phi(x) = \\phi_W + (\\phi_P - \\phi_W) \\frac{x - x_W}{x_P - x_W}\n$$\n我们在边界位置 $x=0$ 处对其求值，得到 $\\phi_{in}$：\n$$\n\\phi_{in} = \\phi_W + (\\phi_P - \\phi_W) \\frac{0 - (-\\frac{\\Delta x}{2})}{\\frac{\\Delta x}{2} - (-\\frac{\\Delta x}{2})}\n$$\n$$\n\\phi_{in} = \\phi_W + (\\phi_P - \\phi_W) \\frac{\\frac{\\Delta x}{2}}{\\Delta x} = \\phi_W + \\frac{1}{2}(\\phi_P - \\phi_W)\n$$\n$$\n\\phi_{in} = \\frac{1}{2}\\phi_W + \\frac{1}{2}\\phi_P = \\frac{\\phi_W + \\phi_P}{2}\n$$\n这个结果是预料之中的，因为 $x=0$ 是 $x_W$ 和 $x_P$ 的中点。求解虚拟单元值 $\\phi_W$，我们得到：\n$$\n\\phi_W = 2\\phi_{in} - \\phi_P\n$$\n\n**第二步：为面上值构造二次插值**\n\nQUICK 格式使用二次多项式来插值面上值。问题指出，对于位于 $x_e=\\Delta x$ 处的面 $e$，多项式 $\\phi(x)$ 必须通过三个点 $(x_W, \\phi_W)$、$(x_P, \\phi_P)$ 和 $(x_E, \\phi_E)$，它们的坐标是：\n- $x_W = -\\frac{\\Delta x}{2}$\n- $x_P = \\frac{\\Delta x}{2}$\n- $x_E = \\frac{3\\Delta x}{2}$\n\n我们使用拉格朗日(Lagrange)插值来求此多项式在 $x_e = \\Delta x$ 处的值。该多项式的拉格朗日形式为：\n$$\n\\phi(x) = \\phi_W L_W(x) + \\phi_P L_P(x) + \\phi_E L_E(x)\n$$\n其中 $L_W(x)$、$L_P(x)$ 和 $L_E(x)$ 是拉格朗日基多项式。我们需要在 $x=x_e=\\Delta x$ 处对它们求值。\n\n点 $W$ 的基多项式为：\n$$\nL_W(x_e) = \\frac{(x_e - x_P)(x_e - x_E)}{(x_W - x_P)(x_W - x_E)} = \\frac{(\\Delta x - \\frac{\\Delta x}{2})(\\Delta x - \\frac{3\\Delta x}{2})}{(-\\frac{\\Delta x}{2} - \\frac{\\Delta x}{2})(-\\frac{\\Delta x}{2} - \\frac{3\\Delta x}{2})} = \\frac{(\\frac{\\Delta x}{2})(-\\frac{\\Delta x}{2})}{(-\\Delta x)(-2\\Delta x)} = \\frac{-\\frac{\\Delta x^2}{4}}{2\\Delta x^2} = -\\frac{1}{8}\n$$\n点 $P$ 的基多项式为：\n$$\nL_P(x_e) = \\frac{(x_e - x_W)(x_e - x_E)}{(x_P - x_W)(x_P - x_E)} = \\frac{(\\Delta x - (-\\frac{\\Delta x}{2}))(\\Delta x - \\frac{3\\Delta x}{2})}{(\\frac{\\Delta x}{2} - (-\\frac{\\Delta x}{2}))(\\frac{\\Delta x}{2} - \\frac{3\\Delta x}{2})} = \\frac{(\\frac{3\\Delta x}{2})(-\\frac{\\Delta x}{2})}{(\\Delta x)(-\\Delta x)} = \\frac{-\\frac{3\\Delta x^2}{4}}{-\\Delta x^2} = \\frac{3}{4}\n$$\n点 $E$ 的基多项式为：\n$$\nL_E(x_e) = \\frac{(x_e - x_W)(x_e - x_P)}{(x_E - x_W)(x_E - x_P)} = \\frac{(\\Delta x - (-\\frac{\\Delta x}{2}))(\\Delta x - \\frac{\\Delta x}{2})}{(\\frac{3\\Delta x}{2} - (-\\frac{\\Delta x}{2}))(\\frac{3\\Delta x}{2} - \\frac{\\Delta x}{2})} = \\frac{(\\frac{3\\Delta x}{2})(\\frac{\\Delta x}{2})}{(2\\Delta x)(\\Delta x)} = \\frac{\\frac{3\\Delta x^2}{4}}{2\\Delta x^2} = \\frac{3}{8}\n$$\n因此，面上的插值 $\\phi_e = \\phi(x_e)$ 为：\n$$\n\\phi_e = \\phi_W L_W(x_e) + \\phi_P L_P(x_e) + \\phi_E L_E(x_e) = -\\frac{1}{8}\\phi_W + \\frac{3}{4}\\phi_P + \\frac{3}{8}\\phi_E\n$$\n\n**第三步：代入虚拟单元值并最终简化**\n\n现在我们将第一步中得到的 $\\phi_W$ 表达式代入 $\\phi_e$ 的表达式中：\n$$\n\\phi_e = -\\frac{1}{8}(2\\phi_{in} - \\phi_P) + \\frac{3}{4}\\phi_P + \\frac{3}{8}\\phi_E\n$$\n展开第一项：\n$$\n\\phi_e = -\\frac{2}{8}\\phi_{in} + \\frac{1}{8}\\phi_P + \\frac{3}{4}\\phi_P + \\frac{3}{8}\\phi_E\n$$\n为了合并含有 $\\phi_P$ 的项，我们使用公分母 8：\n$$\n\\phi_e = -\\frac{1}{4}\\phi_{in} + \\frac{1}{8}\\phi_P + \\frac{6}{8}\\phi_P + \\frac{3}{8}\\phi_E\n$$\n$$\n\\phi_e = -\\frac{1}{4}\\phi_{in} + \\frac{7}{8}\\phi_P + \\frac{3}{8}\\phi_E\n$$\n该表达式给出了面上值 $\\phi_e$ 与入口边界值 $\\phi_{in}$ 以及两个相邻内部单元中心值 $\\phi_P$ 和 $\\phi_E$ 的关系。为了将其表示为单个分数：\n$$\n\\phi_e = \\frac{-2\\phi_{in} + 7\\phi_P + 3\\phi_E}{8}\n$$",
            "answer": "$$\n\\boxed{\\frac{7\\phi_P + 3\\phi_E - 2\\phi_{in}}{8}}\n$$"
        }
    ]
}