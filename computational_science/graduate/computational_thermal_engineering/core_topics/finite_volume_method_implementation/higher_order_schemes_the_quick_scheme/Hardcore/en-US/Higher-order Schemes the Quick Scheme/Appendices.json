{
    "hands_on_practices": [
        {
            "introduction": "To truly appreciate the refinement that the QUICK scheme brings to numerical simulations, it is instructive to compare it directly against a simpler, more diffusive method. This first exercise focuses on the core calculation of a scalar value at a cell face, contrasting the first-order upwind scheme's simple 'donor-cell' approach with the more sophisticated quadratic interpolation of QUICK. By calculating the difference between these two approximations, you will quantify the 'deferred correction' term, which represents the higher-order contribution that reduces numerical error. ",
            "id": "3306422",
            "problem": "Consider one-dimensional steady advection of a passive scalar field $\\phi(x)$ governed by conservation of the scalar quantity, so that the convective flux $\\rho u \\phi$ is spatially constant along $x$ when the density $\\rho$ and velocity $u$ are uniform. Using the Finite Volume Method (FVM), the discretization on a uniform grid with cell centers at $x_{i-1}$, $x_{i}$, $x_{i+1}$, and $x_{i+2}$ and faces at $x_{i-1/2}$, $x_{i+1/2}$, and $x_{i+3/2}$ requires an approximation of the face value $\\phi_{i+1/2}$ to close the convective flux across the face between cells $i$ and $i+1$. For strictly positive velocity ($u0$), the first-order donor-cell upwind approximation and the higher-order Quadratic Upwind Interpolation for Convective Kinematics (QUICK) scheme provide two different face-value reconstructions.\n\nStarting from the conservation-law foundation for advection and the uniform-grid geometry, do the following:\n- Derive the donor-cell upwind face value at $x_{i+1/2}$ for $u0$ by identifying the physically correct donor state and expressing $\\phi_{i+1/2}^{UP}$ in terms of neighboring cell-center values.\n- Independently derive the QUICK face value at $x_{i+1/2}$ for $u0$ by constructing the unique quadratic polynomial that interpolates the upstream-biased stencil of cell-center values and evaluating it at the face location.\n- Using the sample values $\\phi_{i-1}=1$, $\\phi_{i}=2$, $\\phi_{i+1}=4$, and $\\phi_{i+2}=8$, compute $\\phi_{i+1/2}^{UP}$ and $\\phi_{i+1/2}^{QUICK}$ and determine the deferred-correction contribution $\\delta=\\phi_{i+1/2}^{QUICK}-\\phi_{i+1/2}^{UP}$, which is the correction one would add to the upwind flux in a deferred-correction formulation.\n\nExpress the final answer as a row matrix $\\left[ \\phi_{i+1/2}^{UP}, \\, \\phi_{i+1/2}^{QUICK}, \\, \\delta \\right]$ using exact values. Do not round; provide the exact numbers.",
            "solution": "The problem requires the derivation and application of two finite volume convection schemes, the first-order donor-cell upwind scheme and the Quadratic Upwind Interpolation for Convective Kinematics (QUICK) scheme, to determine the value of a scalar field $\\phi$ at a cell face. The final goal is to compute the deferred-correction term, which is the difference between the higher-order and lower-order approximations.\n\nThe physical basis is the one-dimensional steady-state advection of a passive scalar $\\phi(x)$, governed by the conservation law:\n$$ \\frac{d}{dx}(\\rho u \\phi) = 0 $$\nwhere $\\rho$ is the density and $u$ is the velocity. The problem states that $\\rho$ and $u$ are uniform and constant, with $u  0$. The equation simplifies to:\n$$ u \\frac{d\\phi}{dx} = 0 $$\nIn the Finite Volume Method (FVM), this equation is integrated over a control volume (a cell) centered at $x_i$, extending from face $x_{i-1/2}$ to face $x_{i+1/2}$.\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} u \\frac{d\\phi}{dx} dx = 0 $$\n$$ u [\\phi]_{x_{i-1/2}}^{x_{i+1/2}} = 0 $$\n$$ u (\\phi_{i+1/2} - \\phi_{i-1/2}) = 0 $$\nHere, $\\phi_{i+1/2}$ and $\\phi_{i-1/2}$ are the values of the scalar at the cell faces. To solve this system of algebraic equations numerically, these face values must be expressed in terms of the known cell-center values $\\phi_i$. This is the role of the convection scheme.\n\nFirst, we derive the expression for the donor-cell upwind face value, $\\phi_{i+1/2}^{UP}$.\nThe donor-cell or first-order upwind (FOU) scheme is based on the direction of flow. It approximates the value at a cell face by the cell-center value of the \"donor\" cell, which is the cell immediately upstream of that face. The problem specifies a strictly positive velocity, $u  0$, meaning the flow is from left to right (in the direction of increasing $x$). For the face at $x_{i+1/2}$, which is located between cell $i$ and cell $i+1$, the upstream direction is to the left. Therefore, the donor cell is cell $i$. The scheme sets the face value equal to the value at the center of the donor cell.\n$$ \\phi_{i+1/2}^{UP} = \\phi_i $$\n\nNext, we derive the expression for the QUICK face value, $\\phi_{i+1/2}^{QUICK}$.\nThe QUICK scheme constructs a quadratic polynomial to interpolate for the face value. For upwinding, the interpolation stencil is biased in the upstream direction. To find the value at face $x_{i+1/2}$ for $u  0$, the scheme uses the two nearest upstream cell centers and the one nearest downstream cell center. These are the centers at $x_{i-1}$, $x_i$, and $x_{i+1}$.\nWe construct a quadratic polynomial $P(x)$ that passes through the points $(x_{i-1}, \\phi_{i-1})$, $(x_i, \\phi_i)$, and $(x_{i+1}, \\phi_{i+1})$. Let the grid be uniform with cell spacing $\\Delta x$. For convenience, we can set a local coordinate system with its origin at $x_i = 0$. Then, $x_{i-1} = -\\Delta x$ and $x_{i+1} = \\Delta x$. The face of interest, $x_{i+1/2}$, is located at $x = \\frac{\\Delta x}{2}$.\nThe Lagrange form of the interpolating polynomial through these three points is:\n$$ P(x) = \\phi_{i-1} \\frac{(x-x_i)(x-x_{i+1})}{(x_{i-1}-x_i)(x_{i-1}-x_{i+1})} + \\phi_i \\frac{(x-x_{i-1})(x-x_{i+1})}{(x_i-x_{i-1})(x_i-x_{i+1})} + \\phi_{i+1} \\frac{(x-x_{i-1})(x-x_i)}{(x_{i+1}-x_{i-1})(x_{i+1}-x_i)} $$\nSubstituting the local coordinates $x_{i-1}=-\\Delta x$, $x_i=0$, $x_{i+1}=\\Delta x$:\n$$ P(x) = \\phi_{i-1} \\frac{x(x-\\Delta x)}{(-\\Delta x)(-2\\Delta x)} + \\phi_i \\frac{(x+\\Delta x)(x-\\Delta x)}{(\\Delta x)(-\\Delta x)} + \\phi_{i+1} \\frac{(x+\\Delta x)x}{(2\\Delta x)(\\Delta x)} $$\n$$ P(x) = \\phi_{i-1} \\frac{x(x-\\Delta x)}{2(\\Delta x)^2} - \\phi_i \\frac{x^2 - (\\Delta x)^2}{(\\Delta x)^2} + \\phi_{i+1} \\frac{x(x+\\Delta x)}{2(\\Delta x)^2} $$\nWe evaluate this polynomial at the face location $x = \\frac{\\Delta x}{2}$ to find $\\phi_{i+1/2}^{QUICK}$.\n$$ \\phi_{i+1/2}^{QUICK} = P\\left(\\frac{\\Delta x}{2}\\right) $$\n$$ \\phi_{i+1/2}^{QUICK} = \\phi_{i-1} \\frac{\\frac{\\Delta x}{2}(\\frac{\\Delta x}{2}-\\Delta x)}{2(\\Delta x)^2} - \\phi_i \\frac{(\\frac{\\Delta x}{2})^2 - (\\Delta x)^2}{(\\Delta x)^2} + \\phi_{i+1} \\frac{\\frac{\\Delta x}{2}(\\frac{\\Delta x}{2}+\\Delta x)}{2(\\Delta x)^2} $$\n$$ \\phi_{i+1/2}^{QUICK} = \\phi_{i-1} \\frac{\\frac{\\Delta x}{2}(-\\frac{\\Delta x}{2})}{2(\\Delta x)^2} - \\phi_i \\frac{\\frac{(\\Delta x)^2}{4} - (\\Delta x)^2}{(\\Delta x)^2} + \\phi_{i+1} \\frac{\\frac{\\Delta x}{2}(\\frac{3\\Delta x}{2})}{2(\\Delta x)^2} $$\n$$ \\phi_{i+1/2}^{QUICK} = \\phi_{i-1} \\frac{-\\frac{(\\Delta x)^2}{4}}{2(\\Delta x)^2} - \\phi_i \\frac{-\\frac{3(\\Delta x)^2}{4}}{(\\Delta x)^2} + \\phi_{i+1} \\frac{\\frac{3(\\Delta x)^2}{4}}{2(\\Delta x)^2} $$\n$$ \\phi_{i+1/2}^{QUICK} = -\\frac{1}{8}\\phi_{i-1} + \\frac{3}{4}\\phi_i + \\frac{3}{8}\\phi_{i+1} $$\nCombining terms with a common denominator of $8$:\n$$ \\phi_{i+1/2}^{QUICK} = \\frac{6}{8}\\phi_i + \\frac{3}{8}\\phi_{i+1} - \\frac{1}{8}\\phi_{i-1} = \\frac{1}{8}(6\\phi_i + 3\\phi_{i+1} - \\phi_{i-1}) $$\n\nFinally, we use the provided sample values to compute the numerical results.\nGiven: $\\phi_{i-1}=1$, $\\phi_{i}=2$, $\\phi_{i+1}=4$.\n\n1.  Compute the donor-cell upwind face value:\n    $$ \\phi_{i+1/2}^{UP} = \\phi_i = 2 $$\n\n2.  Compute the QUICK face value:\n    $$ \\phi_{i+1/2}^{QUICK} = \\frac{1}{8}(6\\phi_i + 3\\phi_{i+1} - \\phi_{i-1}) = \\frac{1}{8}(6(2) + 3(4) - 1) $$\n    $$ \\phi_{i+1/2}^{QUICK} = \\frac{1}{8}(12 + 12 - 1) = \\frac{23}{8} $$\n\n3.  Compute the deferred-correction contribution, $\\delta$:\n    The deferred-correction term is the difference between the higher-order (QUICK) and lower-order (Upwind) approximations of the face value.\n    $$ \\delta = \\phi_{i+1/2}^{QUICK} - \\phi_{i+1/2}^{UP} $$\n    $$ \\delta = \\frac{23}{8} - 2 = \\frac{23}{8} - \\frac{16}{8} = \\frac{7}{8} $$\n\nThe three required values are $\\phi_{i+1/2}^{UP} = 2$, $\\phi_{i+1/2}^{QUICK} = \\frac{23}{8}$, and $\\delta = \\frac{7}{8}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  \\frac{23}{8}  \\frac{7}{8}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from a single face value to a complete simulation requires integrating the scheme into the governing conservation law for an entire control volume. This practice challenges you to derive the full algebraic equation for a cell by applying the QUICK scheme for the convective fluxes and central differencing for the diffusive fluxes. This process of assembling the coefficients is the fundamental task of the Finite Volume Method and demonstrates how the higher-order interpolation directly influences the final system of equations to be solved. ",
            "id": "3961003",
            "problem": "Consider the steady one-dimensional ($1$D) convection-diffusion equation for a transported scalar $ \\phi(x) $ with constant velocity $ u $ and constant diffusivity $ \\Gamma $,\n$$\nu \\, \\frac{\\partial \\phi}{\\partial x} \\;=\\; \\Gamma \\, \\frac{\\partial^2 \\phi}{\\partial x^2} \\;+\\; S(\\phi),\n$$\nposed on a uniform grid of control volumes of width $ \\Delta x $ and unit cross-sectional area. Assume unit density so that the convective flux at a face is $ u \\, \\phi_f $. Let the source be linearized as $ S(\\phi) = S_{P,i} \\, \\phi_i + S_{U,i} $ within control volume $ i $, with $ S_{P,i} \\le 0 $.\n\nUsing a finite volume formulation, integrate over control volume $ i $ bounded by faces $ w $ and $ e $. For the diffusive face fluxes, use central differencing, i.e.,\n$$\n\\left( \\Gamma \\, \\frac{\\partial \\phi}{\\partial x} \\right)_e \\approx \\Gamma \\, \\frac{\\phi_E - \\phi_P}{\\Delta x}, \n\\qquad\n\\left( \\Gamma \\, \\frac{\\partial \\phi}{\\partial x} \\right)_w \\approx \\Gamma \\, \\frac{\\phi_P - \\phi_W}{\\Delta x}.\n$$\nFor the convective face values, use the Quadratic Upstream Interpolation for Convective Kinematics (QUICK) scheme for the case of positive velocity $ u  0 $. On a uniform grid, obtain $ \\phi_e $ from the quadratic through $ \\phi_W, \\phi_P, \\phi_E $ evaluated at the east face, and $ \\phi_w $ from the quadratic through $ \\phi_{WW}, \\phi_W, \\phi_P $ evaluated at the west face.\n\nStarting from the integral balance and the above approximations, derive the linearized algebraic equation for interior control volume $ i $ in the form\n$$\na_{P,i} \\, \\phi_i \\;=\\; a_{WW,i} \\, \\phi_{i-2} \\;+\\; a_{W,i} \\, \\phi_{i-1} \\;+\\; a_{E,i} \\, \\phi_{i+1} \\;+\\; a_{EE,i} \\, \\phi_{i+2} \\;+\\; b_i,\n$$\nand obtain explicit expressions for the coefficients $ a_{WW,i}, a_{W,i}, a_{P,i}, a_{E,i}, a_{EE,i}, b_i $ in terms of $ u, \\Gamma, \\Delta x, S_{P,i}, S_{U,i} $ for the case $ u  0 $ on a uniform grid with the central differencing for diffusion and QUICK for convection as specified above. Assume there are no source terms other than $ S(\\phi) $.\n\nYour final answer must be a single analytical expression reporting the ordered coefficients as a row matrix \n$$\n\\left[ a_{WW,i} \\;\\; a_{W,i} \\;\\; a_{P,i} \\;\\; a_{E,i} \\;\\; a_{EE,i} \\;\\; b_i \\right].\n$$",
            "solution": "The derivation proceeds as follows.\n\nStep 1: Integral Form of the Governing Equation\nThe steady $1$D convection-diffusion equation is given by:\n$$u \\, \\frac{\\partial \\phi}{\\partial x} \\;=\\; \\Gamma \\, \\frac{\\partial^2 \\phi}{\\partial x^2} \\;+\\; S(\\phi)$$\nWe integrate this equation over a control volume (CV) $i$ of width $\\Delta x$ and unit cross-sectional area, centered around node $P$ (or $i$). The CV is bounded by the west face $w$ and the east face $e$.\n$$\\int_{w}^{e} \\left( \\frac{d}{dx} (u \\phi) - \\frac{d}{dx} \\left(\\Gamma \\frac{d\\phi}{dx}\\right) - S(\\phi) \\right) dx \\;=\\; 0$$\nApplying the divergence theorem, this yields a balance of fluxes at the faces and the integrated source term:\n$$\\left( u \\phi - \\Gamma \\frac{d\\phi}{dx} \\right)_e - \\left( u \\phi - \\Gamma \\frac{d\\phi}{dx} \\right)_w - \\int_{w}^{e} S(\\phi) \\, dx \\;=\\; 0$$\nThe total flux at a face is $J = u \\phi - \\Gamma \\frac{d\\phi}{dx}$. The integrated source term is approximated as $\\bar{S}_i \\Delta x$, where $\\bar{S}_i$ is the average source over the CV. Using the given linearized source form $S(\\phi) = S_{P,i} \\, \\phi_i + S_{U,i}$, the integral becomes $(S_{P,i} \\, \\phi_i + S_{U,i}) \\Delta x$. So the balance equation is:\n$$J_e - J_w - (S_{P,i} \\, \\phi_i + S_{U,i}) \\Delta x \\;=\\; 0$$\n\nStep 2: Discretization of Fluxes\nThe diffusive fluxes are approximated using central differencing as specified. The velocity $u$ and diffusivity $\\Gamma$ are constant.\nThe diffusive flux at face $e$ is $-\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_e \\approx -\\Gamma \\frac{\\phi_E - \\phi_P}{\\Delta x}$.\nThe diffusive flux at face $w$ is $-\\left(\\Gamma \\frac{d\\phi}{dx}\\right)_w \\approx -\\Gamma \\frac{\\phi_P - \\phi_W}{\\Delta x}$.\nNote that node $P$ corresponds to index $i$, $W$ to $i-1$, $E$ to $i+1$, etc.\n\nThe convective fluxes are given by $u \\phi_f$, where $\\phi_f$ is the value of $\\phi$ at the face. The QUICK scheme is used to approximate $\\phi_f$. For $u0$, the flow is from west to east.\n\nFor the east face $e$ of CV $i$, the upstream direction is west. The QUICK scheme uses a quadratic polynomial fitted to the two nearest upstream nodes ($W, P$) and one nearest downstream node ($E$). The value at face $e$ (located at $x_P + \\Delta x/2$) is given by:\n$$\\phi_e = \\frac{3}{8}\\phi_E + \\frac{6}{8}\\phi_P - \\frac{1}{8}\\phi_W$$\nFor the west face $w$ of CV $i$, the upstream direction is also west. The two nearest upstream nodes are $WW$ and $W$, and the nearest downstream node is $P$. The value at face $w$ (located at $x_P - \\Delta x/2$) is:\n$$\\phi_w = \\frac{3}{8}\\phi_P + \\frac{6}{8}\\phi_W - \\frac{1}{8}\\phi_{WW}$$\n\nStep 3: Assemble the Algebraic Equation\nWe substitute these approximations into the balance equation:\n$$u \\phi_e - u \\phi_w - \\left(\\Gamma \\frac{\\phi_E - \\phi_P}{\\Delta x}\\right) + \\left(\\Gamma \\frac{\\phi_P - \\phi_W}{\\Delta x}\\right) - (S_{P,i} \\, \\phi_i + S_{U,i}) \\Delta x \\;=\\; 0$$\nLet's substitute the QUICK expressions for $\\phi_e$ and $\\phi_w$:\n$$u \\left( \\frac{3}{8}\\phi_E + \\frac{6}{8}\\phi_P - \\frac{1}{8}\\phi_W \\right) - u \\left( \\frac{3}{8}\\phi_P + \\frac{6}{8}\\phi_W - \\frac{1}{8}\\phi_{WW} \\right) - \\frac{\\Gamma}{\\Delta x}(\\phi_E - 2\\phi_P + \\phi_W) - (S_{P,i} \\, \\phi_P + S_{U,i}) \\Delta x \\;=\\; 0$$\nWe now collect the coefficients for each nodal value $\\phi_{WW}, \\phi_W, \\phi_P, \\phi_E$.\nFor $\\phi_{WW}$ (index $i-2$):\n$$u \\left( \\frac{1}{8} \\right) \\phi_{WW} = \\frac{u}{8} \\phi_{WW}$$\nFor $\\phi_W$ (index $i-1$):\n$$-\\frac{u}{8}\\phi_W - \\frac{6u}{8}\\phi_W - \\frac{\\Gamma}{\\Delta x}\\phi_W = \\left(-\\frac{7u}{8} - \\frac{\\Gamma}{\\Delta x}\\right) \\phi_W$$\nFor $\\phi_P$ (index $i$):\n$$\\frac{6u}{8}\\phi_P - \\frac{3u}{8}\\phi_P + \\frac{2\\Gamma}{\\Delta x}\\phi_P - S_{P,i}\\Delta x\\, \\phi_P = \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right) \\phi_P$$\nFor $\\phi_E$ (index $i+1$):\n$$\\frac{3u}{8}\\phi_E - \\frac{\\Gamma}{\\Delta x}\\phi_E = \\left(\\frac{3u}{8} - \\frac{\\Gamma}{\\Delta x}\\right) \\phi_E$$\nFor $\\phi_{EE}$ (index $i+2$):\nThe coefficient is $0$.\n\nThe constant source term contribution is $-S_{U,i}\\Delta x$.\n\nCombining all terms, we have the full algebraic equation for CV $i$:\n$$ \\left(\\frac{u}{8}\\right)\\phi_{i-2} + \\left(-\\frac{7u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i-1} + \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right)\\phi_i + \\left(\\frac{3u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i+1} - S_{U,i}\\Delta x = 0 $$\n\nStep 4: Rearrange into the Target Form\nThe problem requires the equation in the form:\n$$a_{P,i} \\, \\phi_i \\;=\\; a_{WW,i} \\, \\phi_{i-2} \\;+\\; a_{W,i} \\, \\phi_{i-1} \\;+\\; a_{E,i} \\, \\phi_{i+1} \\;+\\; a_{EE,i} \\, \\phi_{i+2} \\;+\\; b_i$$\nTo achieve this, we keep the $\\phi_i$ term on the left-hand side and move all other terms to the right-hand side.\n$$ \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right)\\phi_i = -\\left(\\frac{u}{8}\\right)\\phi_{i-2} - \\left(-\\frac{7u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i-1} - \\left(\\frac{3u}{8} - \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i+1} + (0)\\phi_{i+2} + S_{U,i}\\Delta x $$\nSimplifying the coefficients on the right-hand side:\n$$ \\left(\\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x\\right)\\phi_i = \\left(-\\frac{u}{8}\\right)\\phi_{i-2} + \\left(\\frac{7u}{8} + \\frac{\\Gamma}{\\Delta x}\\right)\\phi_{i-1} + \\left(\\frac{\\Gamma}{\\Delta x} - \\frac{3u}{8}\\right)\\phi_{i+1} + (0)\\phi_{i+2} + S_{U,i}\\Delta x $$\n\nStep 5: Identify the Coefficients\nBy comparing this result with the target form, we identify the coefficients:\n$a_{WW,i} = -\\frac{u}{8}$\n$a_{W,i} = \\frac{7u}{8} + \\frac{\\Gamma}{\\Delta x}$\n$a_{P,i} = \\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x$\n$a_{E,i} = \\frac{\\Gamma}{\\Delta x} - \\frac{3u}{8}$\n$a_{EE,i} = 0$\n$b_i = S_{U,i}\\Delta x$\n\nThese expressions for the coefficients are the solution to the problem. They are reported below as a row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{u}{8}  \\frac{7u}{8} + \\frac{\\Gamma}{\\Delta x}  \\frac{3u}{8} + \\frac{2\\Gamma}{\\Delta x} - S_{P,i}\\Delta x  \\frac{\\Gamma}{\\Delta x} - \\frac{3u}{8}  0  S_{U,i}\\Delta x\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A scheme's robustness is often tested at the boundaries of the computational domain, where the standard stencil may not be available. This final practice addresses the common scenario of an outflow boundary, where a zero-gradient condition, $\\frac{\\partial \\phi}{\\partial n} = 0$, is applied. You will derive a consistent extrapolation for the boundary face value that honors this physical condition while preserving the quadratic nature of the QUICK scheme, a crucial skill for ensuring that boundary treatments do not degrade the overall accuracy of the solution. ",
            "id": "3961073",
            "problem": "Consider a one-dimensional, steady advection of a thermal scalar field $\\phi(x)$ in a channel of length $L$ with uniform positive velocity $u0$. A finite-volume discretization is employed on a uniform mesh of spacing $\\Delta x$ near the outlet at $x=L$, with the last two interior cell centers located at $x_{P}=L-\\Delta x/2$ and $x_{W}=L-3\\Delta x/2$, and a boundary face at $x=L$. The outward unit normal $\\boldsymbol{n}$ at the outlet points in the $+x$ direction. The outlet boundary condition is the homogeneous Neumann condition, $\\partial \\phi/\\partial n=0$ at $x=L$, which is physically appropriate for a convective outflow where diffusive and source effects are negligible at the boundary. To evaluate the advective flux at the boundary face within the Quadratic Upwind Interpolation for Convective Kinematics (QUICK) framework, derive a mathematically consistent extrapolation of the face value $\\phi_{f}$ at $x=L$ that preserves second-order accuracy while respecting the Neumann boundary condition and the upwind bias implied by $u0$. Express the final $\\phi_{f}$ as a closed-form linear combination of the interior cell-centered values $\\phi_{P}$ and $\\phi_{W}$. Your final answer must be a single analytical expression. No numerical approximation or rounding is required.",
            "solution": "The objective is to derive an expression for the scalar value $\\phi_f$ at the outlet boundary face, located at $x=L$, consistent with the Quadratic Upwind Interpolation for Convective Kinematics (QUICK) scheme. The derivation must incorporate the homogeneous Neumann boundary condition, $\\frac{\\partial \\phi}{\\partial x} = 0$ at $x=L$, and use the two available upwind interior cell-centered values, $\\phi_P$ and $\\phi_W$.\n\nThe QUICK scheme is based on a quadratic approximation of the scalar field. For an outflow boundary where $u0$, the standard upwind-biased three-point stencil cannot be used as it would require a node outside the domain. We must therefore construct a special quadratic profile using the two interior nodes and the boundary condition itself as constraints.\n\nLet the quadratic interpolation polynomial for $\\phi(x)$ near the outlet be of the form:\n$$ \\phi(x) = ax^2 + bx + c $$\nTo simplify the algebra, we define a local coordinate system $\\xi$ centered at the node $P$:\n$$ \\xi = x - x_P $$\nThe locations of the nodes and the boundary face in this system are:\n1.  The cell center $P$ is at $x_P = L - \\frac{\\Delta x}{2}$, which corresponds to $\\xi_P = 0$.\n2.  The cell center $W$ is at $x_W = L - \\frac{3\\Delta x}{2}$, which corresponds to $\\xi_W = x_W - x_P = -\\Delta x$.\n3.  The boundary face $f$ is at $x=L$, which corresponds to $\\xi_f = L - x_P = L - (L - \\frac{\\Delta x}{2}) = \\frac{\\Delta x}{2}$.\n\nIn the local coordinate system, the quadratic polynomial is $\\phi(\\xi) = A\\xi^2 + B\\xi + C$. We have three conditions to determine the coefficients $A$, $B$, and $C$:\n1.  The polynomial must pass through the nodal value at $P$:\n    $\\phi(\\xi_P=0) = \\phi_P \\implies A(0)^2 + B(0) + C = \\phi_P \\implies C = \\phi_P$.\n2.  The polynomial must pass through the nodal value at $W$:\n    $\\phi(\\xi_W=-\\Delta x) = \\phi_W \\implies A(-\\Delta x)^2 + B(-\\Delta x) + C = \\phi_W$.\n    Substituting $C=\\phi_P$, we get:\n    $$ A(\\Delta x)^2 - B\\Delta x + \\phi_P = \\phi_W \\quad (*)$$\n3.  The polynomial's derivative must be zero at the boundary face, satisfying the Neumann condition. The derivative is $\\frac{d\\phi}{d\\xi} = 2A\\xi + B$. The condition is applied at $\\xi_f = \\frac{\\Delta x}{2}$:\n    $\\frac{d\\phi}{d\\xi}\\Big|_{\\xi=\\Delta x/2} = 0 \\implies 2A\\left(\\frac{\\Delta x}{2}\\right) + B = 0 \\implies A\\Delta x + B = 0$.\n    This gives us a direct relationship between $B$ and $A$:\n    $$ B = -A\\Delta x \\quad (**) $$\n\nNow we solve the system of equations for $A$ and $B$. Substitute equation $(**)$ into equation $(*)$:\n$$ A(\\Delta x)^2 - (-A\\Delta x)\\Delta x = \\phi_W - \\phi_P $$\n$$ A(\\Delta x)^2 + A(\\Delta x)^2 = \\phi_W - \\phi_P $$\n$$ 2A(\\Delta x)^2 = \\phi_W - \\phi_P $$\nSolving for $A$:\n$$ A = \\frac{\\phi_W - \\phi_P}{2(\\Delta x)^2} $$\nNow, we find $B$ using equation $(**)$:\n$$ B = - \\left( \\frac{\\phi_W - \\phi_P}{2(\\Delta x)^2} \\right) \\Delta x = -\\frac{\\phi_W - \\phi_P}{2\\Delta x} = \\frac{\\phi_P - \\phi_W}{2\\Delta x} $$\nWe have now fully determined the quadratic profile:\n$$ \\phi(\\xi) = \\left( \\frac{\\phi_W - \\phi_P}{2(\\Delta x)^2} \\right) \\xi^2 + \\left( \\frac{\\phi_P - \\phi_W}{2\\Delta x} \\right) \\xi + \\phi_P $$\nThe final step is to evaluate this polynomial at the boundary face, $\\xi_f = \\frac{\\Delta x}{2}$, to find the value $\\phi_f$:\n$$ \\phi_f = \\phi(\\xi_f) = \\left( \\frac{\\phi_W - \\phi_P}{2(\\Delta x)^2} \\right) \\left(\\frac{\\Delta x}{2}\\right)^2 + \\left( \\frac{\\phi_P - \\phi_W}{2\\Delta x} \\right) \\left(\\frac{\\Delta x}{2}\\right) + \\phi_P $$\n$$ \\phi_f = \\left( \\frac{\\phi_W - \\phi_P}{2(\\Delta x)^2} \\right) \\frac{(\\Delta x)^2}{4} + \\frac{\\phi_P - \\phi_W}{4} + \\phi_P $$\n$$ \\phi_f = \\frac{\\phi_W - \\phi_P}{8} + \\frac{\\phi_P - \\phi_W}{4} + \\phi_P $$\nTo combine these terms, we find a common denominator of $8$:\n$$ \\phi_f = \\frac{\\phi_W - \\phi_P}{8} + \\frac{2(\\phi_P - \\phi_W)}{8} + \\frac{8\\phi_P}{8} $$\n$$ \\phi_f = \\frac{(\\phi_W - \\phi_P) + (2\\phi_P - 2\\phi_W) + 8\\phi_P}{8} $$\n$$ \\phi_f = \\frac{(-1+2+8)\\phi_P + (1-2)\\phi_W}{8} $$\n$$ \\phi_f = \\frac{9\\phi_P - \\phi_W}{8} $$\nThis expression represents the value at the boundary face as a linear combination of the two nearest interior cell-centered values, derived in a manner that is consistent with a quadratic profile and the zero-gradient boundary condition, thereby satisfying the requirements of the problem. This extrapolation scheme has been shown to maintain the second-order accuracy of the overall finite-volume method.",
            "answer": "$$\\boxed{\\frac{9\\phi_P - \\phi_W}{8}}$$"
        }
    ]
}