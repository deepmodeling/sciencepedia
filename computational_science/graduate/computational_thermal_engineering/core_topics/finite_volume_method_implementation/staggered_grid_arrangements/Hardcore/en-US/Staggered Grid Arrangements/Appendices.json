{
    "hands_on_practices": [
        {
            "introduction": "A primary motivation for the development of staggered grids was to overcome the critical issue of pressure-velocity decoupling, where non-physical, high-frequency pressure oscillations can exist undetected by the momentum equations. This practice  provides a definitive demonstration of this phenomenon by challenging you to analyze a \"checkerboard\" pressure mode. You will quantitatively show why a standard collocated grid discretization is blind to this mode, while the staggered arrangement correctly computes a strong, non-zero pressure gradient, ensuring proper physical coupling.",
            "id": "3986262",
            "problem": "Consider a two-dimensional, uniform Cartesian grid used in the Finite Volume Method (FVM) in Computational Fluid Dynamics (CFD), with cell centers indexed by integers $(i,j)$, uniform spacings $\\Delta x$ and $\\Delta y$ in the $x$ and $y$ directions, respectively, and interior faces located at half-integer indices. A synthetic pressure field is defined at cell centers by $p_{i,j}=(-1)^{i+j}$ for all integers $i,j$. The discrete gradient operator at a collocated cell center $(i,j)$ is defined using second-order, symmetric central differences of the nearest neighbor cell-centered pressures along each coordinate direction. The discrete gradient normal to a staggered face is defined using the difference of the two adjacent cell-centered pressures divided by the grid spacing along the face-normal direction. Starting from these discretization definitions and the field $p_{i,j}=(-1)^{i+j}$, derive the analytic expressions for:\n- the two components of the discrete collocated central-gradient at the cell center $(i,j)$, and\n- the face-normal discrete gradients at the east face $(i+\\tfrac{1}{2},j)$ and the north face $(i,j+\\tfrac{1}{2})$ of the same cell.\nExpress each quantity exactly in terms of $i$, $j$, $\\Delta x$, and $\\Delta y$. Your final answer must be a single analytic expression aggregating the four quantities as a row matrix. Do not include units in the final expression. No numerical rounding is required.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of computational fluid dynamics, well-posed, objective, and internally consistent. We shall proceed with a formal derivation of the required quantities.\n\nThe problem requires the calculation of four discrete gradient quantities for a given pressure field on a two-dimensional, uniform Cartesian grid. The pressure field is defined at cell centers, indexed by integers $(i,j)$, as:\n$$ p_{i,j} = (-1)^{i+j} $$\n\nFirst, we calculate the two components of the discrete collocated central-gradient at the cell center $(i,j)$. The operator is defined using second-order, symmetric central differences.\n\nThe $x$-component of the collocated gradient, which we denote as $(\\nabla p)_{x,i,j}$, is defined as:\n$$ (\\nabla p)_{x,i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2\\Delta x} $$\nTo evaluate this, we first find the pressure values at the neighboring cell centers, $p_{i+1,j}$ and $p_{i-1,j}$.\nUsing the given pressure field definition:\n$$ p_{i+1,j} = (-1)^{(i+1)+j} = (-1)^{i+j+1} = -(-1)^{i+j} $$\n$$ p_{i-1,j} = (-1)^{(i-1)+j} = (-1)^{i+j-1} = -(-1)^{i+j} $$\nSubstituting these into the gradient formula:\n$$ (\\nabla p)_{x,i,j} = \\frac{-(-1)^{i+j} - (-(-1)^{i+j})}{2\\Delta x} = \\frac{-(-1)^{i+j} + (-1)^{i+j}}{2\\Delta x} = \\frac{0}{2\\Delta x} = 0 $$\n\nThe $y$-component of the collocated gradient, $(\\nabla p)_{y,i,j}$, is defined similarly:\n$$ (\\nabla p)_{y,i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2\\Delta y} $$\nThe pressure values at the neighboring cell centers are:\n$$ p_{i,j+1} = (-1)^{i+(j+1)} = (-1)^{i+j+1} = -(-1)^{i+j} $$\n$$ p_{i,j-1} = (-1)^{i+(j-1)} = (-1)^{i+j-1} = -(-1)^{i+j} $$\nSubstituting these into the formula:\n$$ (\\nabla p)_{y,i,j} = \\frac{-(-1)^{i+j} - (-(-1)^{i+j})}{2\\Delta y} = \\frac{-(-1)^{i+j} + (-1)^{i+j}}{2\\Delta y} = \\frac{0}{2\\Delta y} = 0 $$\nThe result that both components of the collocated central-difference gradient are zero for this \"checkerboard\" pressure field is significant. It demonstrates that this discretization scheme is unable to detect high-frequency oscillations in the pressure field, which is a primary motivation for using staggered grid arrangements in fluid dynamics simulations to avoid such spurious pressure modes.\n\nSecond, we calculate the face-normal discrete gradients at the east face $(i+\\frac{1}{2},j)$ and the north face $(i,j+\\frac{1}{2})$. This staggered gradient is defined as the difference of the two adjacent cell-centered pressures divided by the grid spacing.\n\nThe face-normal gradient at the east face, $(i+\\frac{1}{2},j)$, is normal to the $x$-direction. The adjacent cell centers are $(i,j)$ and $(i+1,j)$. The grid spacing is $\\Delta x$. We denote this quantity as $(\\nabla_n p)_{e}$.\n$$ (\\nabla_n p)_{e} = \\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j} = \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x} $$\nWe have $p_{i,j} = (-1)^{i+j}$ and $p_{i+1,j} = -(-1)^{i+j}$. Substituting these gives:\n$$ (\\nabla_n p)_{e} = \\frac{-(-1)^{i+j} - (-1)^{i+j}}{\\Delta x} = \\frac{-2(-1)^{i+j}}{\\Delta x} $$\n\nThe face-normal gradient at the north face, $(i,j+\\frac{1}{2})$, is normal to the $y$-direction. The adjacent cell centers are $(i,j)$ and $(i,j+1)$. The grid spacing is $\\Delta y$. We denote this quantity as $(\\nabla_n p)_{n}$.\n$$ (\\nabla_n p)_{n} = \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}} = \\frac{p_{i,j+1} - p_{i,j}}{\\Delta y} $$\nWe have $p_{i,j} = (-1)^{i+j}$ and $p_{i,j+1} = -(-1)^{i+j}$. Substituting these gives:\n$$ (\\nabla_n p)_{n} = \\frac{-(-1)^{i+j} - (-1)^{i+j}}{\\Delta y} = \\frac{-2(-1)^{i+j}}{\\Delta y} $$\nUnlike the collocated gradient, the staggered gradient correctly yields a non-zero value, demonstrating its ability to resolve the checkerboard pressure field.\n\nThe four required quantities are:\n$1$. The $x$-component of the discrete collocated central-gradient at $(i,j)$: $0$.\n$2$. The $y$-component of the discrete collocated central-gradient at $(i,j)$: $0$.\n$3$. The face-normal discrete gradient at the east face $(i+\\frac{1}{2},j)$: $\\frac{-2(-1)^{i+j}}{\\Delta x}$.\n$4$. The face-normal discrete gradient at the north face $(i,j+\\frac{1}{2})$: $\\frac{-2(-1)^{i+j}}{\\Delta y}$.\n\nAggregating these four quantities into a single row matrix as requested yields the final answer.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0 & 0 & \\frac{-2(-1)^{i+j}}{\\Delta x} & \\frac{-2(-1)^{i+j}}{\\Delta y} \\end{pmatrix} } $$"
        },
        {
            "introduction": "Adopting a staggered grid elegantly solves the decoupling problem, but it introduces a new practical requirement: the frequent need to interpolate field values between different storage locations. For example, to compute the advection of temperature, velocity components must be known at the faces of the scalar control volume. This exercise  focuses on these essential mechanics, asking you to formulate the linear interpolation schemes for moving data and, critically, to perform a truncation error analysis to determine their formal order of accuracy.",
            "id": "3986256",
            "problem": "Consider a two-dimensional orthogonal, rectilinear grid used in the Finite Volume Method (FVM) for Computational Fluid Dynamics (CFD) with a staggered arrangement: the scalar temperature field $T(x,y)$ is stored at the centers of scalar control volumes located at $(x_i,y_j)$, while the velocity components $u(x,y)$ and $v(x,y)$ are stored at the centers of the normal faces of scalar control volumes, located at $(x_{i+\\frac{1}{2}},y_j)$ for $u$ and $(x_i,y_{j+\\frac{1}{2}})$ for $v$. Assume the grid spacing is positive and finite in each direction, with $x_{i+\\frac{1}{2}}=\\frac{x_i+x_{i+1}}{2}$ and $y_{j+\\frac{1}{2}}=\\frac{y_j+y_{j+1}}{2}$ on a uniform grid, but allow non-uniform spacings $x_{i+1}-x_i$ and $y_{j+1}-y_j$ in the derivations. Let $T(x,y)$ and $u(x,y)$ be sufficiently smooth, possessing continuous partial derivatives up to third order in a neighborhood of each target location.\n\nYour tasks are:\n- Using only linear interpolation and distances along grid lines, formulate the discrete interpolation to map the scalar field $T$ from its storage at $(x_i,y_j)$ to the velocity storage locations $(x_{i+\\frac{1}{2}},y_j)$ and $(x_i,y_{j+\\frac{1}{2}})$.\n- Using only linear interpolation and distances along grid lines, formulate the discrete interpolation to map the $x$-velocity component $u$ from its storage at $(x_{i+\\frac{1}{2}},y_j)$ to the scalar control volume north-face center $(x_i,y_{j+\\frac{1}{2}})$.\n- Starting from the definition of consistency and employing Taylor series expansions about the target location(s), analyze the truncation error of each interpolation and determine the formal consistency order $p$ such that the interpolation error scales like $C\\Delta^p$ for a characteristic mesh size $\\Delta$ tending to zero.\n\nGive the final answer as the single integer value of the common consistency order $p$ shared by the three interpolations. No rounding is required. The final answer must have no units.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n- A two-dimensional orthogonal, rectilinear grid is used in the Finite Volume Method (FVM) for Computational Fluid Dynamics (CFD).\n- The grid arrangement is staggered.\n- The scalar temperature field $T(x,y)$ is stored at the centers of scalar control volumes located at $(x_i,y_j)$.\n- The velocity component $u(x,y)$ is stored at the centers of the normal faces of scalar control volumes, located at $(x_{i+\\frac{1}{2}},y_j)$.\n- The velocity component $v(x,y)$ is stored at the centers of the normal faces of scalar control volumes, located at $(x_i,y_{j+\\frac{1}{2}})$.\n- Grid spacing is positive and finite in each direction.\n- Non-uniform spacings $x_{i+1}-x_i$ and $y_{j+1}-y_j$ are allowed.\n- Face center locations are defined as $x_{i+\\frac{1}{2}}=\\frac{x_i+x_{i+1}}{2}$ and $y_{j+\\frac{1}{2}}=\\frac{y_j+y_{j+1}}{2}$.\n- $T(x,y)$ and $u(x,y)$ are sufficiently smooth, possessing continuous partial derivatives up to third order.\n- The task is to formulate discrete linear interpolations for $T$ to velocity locations and for $u$ to a scalar face location.\n- The task includes analyzing the truncation error of each interpolation to find the common consistency order $p$.\n\n#### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a fundamental exercise in the field of computational fluid dynamics, specifically concerning the numerical discretization on staggered grids (also known as MAC grids). The methods involved—linear interpolation and truncation error analysis via Taylor series—are standard and rigorous mathematical techniques in numerical analysis.\n- **Well-Posed**: The problem is clearly stated, with all necessary definitions and conditions provided. It requests the derivation of specific interpolation formulas and a formal analysis of their accuracy, which leads to a unique and meaningful solution.\n- **Objective**: The problem is posed using precise, objective, and standard terminology from mathematics and engineering. It is free from ambiguity and subjective content.\n\nThe problem does not violate any of the invalidity criteria. It is a textbook example of analyzing discretization schemes.\n\n#### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution\n\nThe solution is presented in three parts as requested: interpolation of the scalar field $T$, interpolation of the velocity component $u$, and the consistency analysis for each.\n\n#### 1. Interpolation of Scalar Field $T$ to Velocity Locations\n\n**a) Interpolation of $T$ to the $u$-velocity location $(x_{i+\\frac{1}{2}},y_j)$**\n\nThe target point $(x_{i+\\frac{1}{2}},y_j)$ lies on the horizontal grid line connecting the scalar nodes $(x_i, y_j)$ and $(x_{i+1}, y_j)$. We use linear interpolation between the values $T_{i,j} = T(x_i, y_j)$ and $T_{i+1,j} = T(x_{i+1}, y_j)$. The general formula for linear interpolation of a function $f(x)$ from points $x_a$ and $x_b$ to a point $x_c$ is $f(x_c) = f(x_a)\\frac{x_b-x_c}{x_b-x_a} + f(x_b)\\frac{x_c-x_a}{x_b-x_a}$.\n\nHere, $x_a = x_i$, $x_b = x_{i+1}$, and $x_c = x_{i+\\frac{1}{2}}$. The problem defines $x_{i+\\frac{1}{2}} = \\frac{x_i+x_{i+1}}{2}$.\nThe interpolation weights are:\nWeight for $T_{i,j}$: $\\frac{x_{i+1}-x_{i+\\frac{1}{2}}}{x_{i+1}-x_i} = \\frac{x_{i+1}-\\frac{x_i+x_{i+1}}{2}}{x_{i+1}-x_i} = \\frac{\\frac{x_{i+1}-x_i}{2}}{x_{i+1}-x_i} = \\frac{1}{2}$.\nWeight for $T_{i+1,j}$: $\\frac{x_{i+\\frac{1}{2}}-x_i}{x_{i+1}-x_i} = \\frac{\\frac{x_i+x_{i+1}}{2}-x_i}{x_{i+1}-x_i} = \\frac{\\frac{x_{i+1}-x_i}{2}}{x_{i+1}-x_i} = \\frac{1}{2}$.\n\nThe interpolated value, denoted $T_{i+\\frac{1}{2},j}$, is therefore the arithmetic mean:\n$$T_{i+\\frac{1}{2},j} = \\frac{1}{2}T_{i,j} + \\frac{1}{2}T_{i+1,j} = \\frac{T(x_i, y_j) + T(x_{i+1}, y_j)}{2}$$\n\n**b) Interpolation of $T$ to the $v$-velocity location $(x_i,y_{j+\\frac{1}{2}})$**\n\nBy analogy, this interpolation is performed along the vertical grid line connecting $(x_i, y_j)$ and $(x_i, y_{j+1})$. Using the definition $y_{j+\\frac{1}{2}}=\\frac{y_j+y_{j+1}}{2}$, the interpolation is:\n$$T_{i,j+\\frac{1}{2}} = \\frac{1}{2}T_{i,j} + \\frac{1}{2}T_{i,j+1} = \\frac{T(x_i, y_j) + T(x_i, y_{j+1})}{2}$$\n\n#### 2. Interpolation of $u$-velocity to Scalar Face Location $(x_i,y_{j+\\frac{1}{2}})$\n\nThe target point $(x_i, y_{j+\\frac{1}{2}})$ does not lie on a grid line directly connecting any two $u$-velocity nodes. This requires a bilinear interpolation, which can be performed as two sequential linear interpolations. The four relevant $u$-velocity nodes surrounding the target point are $u_{i-\\frac{1}{2},j}$, $u_{i+\\frac{1}{2},j}$, $u_{i-\\frac{1}{2},j+1}$, and $u_{i+\\frac{1}{2},j+1}$.\n\nStep 1: Interpolate in the $x$-direction to the line $x=x_i$ at elevations $y_j$ and $y_{j+1}$.\nLet $\\Delta x_k = x_{k+1}-x_k$. The grid points are $x_{i-\\frac{1}{2}}=\\frac{x_{i-1}+x_i}{2}$ and $x_{i+\\frac{1}{2}}=\\frac{x_i+x_{i+1}}{2}$.\nThe distance from $x_i$ to $x_{i-\\frac{1}{2}}$ is $x_i - x_{i-\\frac{1}{2}} = \\frac{x_i - x_{i-1}}{2} = \\frac{\\Delta x_{i-1}}{2}$.\nThe distance from $x_i$ to $x_{i+\\frac{1}{2}}$ is $x_{i+\\frac{1}{2}} - x_i = \\frac{x_{i+1} - x_i}{2} = \\frac{\\Delta x_i}{2}$.\nThe total distance is $x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}} = \\frac{\\Delta x_{i-1} + \\Delta x_i}{2}$.\n\nAt $y=y_j$, the interpolated value $u(x_i,y_j)$ is:\n$$u(x_i,y_j) = u_{i-\\frac{1}{2},j} \\frac{x_{i+\\frac{1}{2}}-x_i}{x_{i+\\frac{1}{2}}-x_{i-\\frac{1}{2}}} + u_{i+\\frac{1}{2},j} \\frac{x_i-x_{i-\\frac{1}{2}}}{x_{i+\\frac{1}{2}}-x_{i-\\frac{1}{2}}} = u_{i-\\frac{1}{2},j} \\frac{\\Delta x_i/2}{(\\Delta x_{i-1}+\\Delta x_i)/2} + u_{i+\\frac{1}{2},j} \\frac{\\Delta x_{i-1}/2}{(\\Delta x_{i-1}+\\Delta x_i)/2}$$\n$$u(x_i,y_j) = \\frac{\\Delta x_i}{\\Delta x_{i-1}+\\Delta x_i} u_{i-\\frac{1}{2},j} + \\frac{\\Delta x_{i-1}}{\\Delta x_{i-1}+\\Delta x_i} u_{i+\\frac{1}{2},j}$$\nSimilarly, at $y=y_{j+1}$:\n$$u(x_i,y_{j+1}) = \\frac{\\Delta x_i}{\\Delta x_{i-1}+\\Delta x_i} u_{i-\\frac{1}{2},j+1} + \\frac{\\Delta x_{i-1}}{\\Delta x_{i-1}+\\Delta x_i} u_{i+\\frac{1}{2},j+1}$$\n\nStep 2: Interpolate in the $y$-direction to the point $y_{j+\\frac{1}{2}}$. Since $y_{j+\\frac{1}{2}}$ is the midpoint between $y_j$ and $y_{j+1}$, this is a simple average:\n$$u_{i,j+\\frac{1}{2}} = \\frac{u(x_i,y_j) + u(x_i,y_{j+1})}{2}$$\nSubstituting the expressions from Step 1 gives the final formula:\n$$u_{i,j+\\frac{1}{2}} = \\frac{1}{2} \\left[ \\left(\\frac{\\Delta x_i u_{i-\\frac{1}{2},j} + \\Delta x_{i-1} u_{i+\\frac{1}{2},j}}{\\Delta x_{i-1}+\\Delta x_i}\\right) + \\left(\\frac{\\Delta x_i u_{i-\\frac{1}{2},j+1} + \\Delta x_{i-1} u_{i+\\frac{1}{2},j+1}}{\\Delta x_{i-1}+\\Delta x_i}\\right) \\right]$$\n\n#### 3. Truncation Error Analysis and Consistency Order\n\nThe truncation error $\\tau$ is defined as the difference between the interpolated value and the exact value of the continuous field at the target point: $\\tau = \\text{Interpolation} - \\text{Exact}$. The order of consistency $p$ is the lowest power of the characteristic grid spacing $\\Delta$ in the leading term of $\\tau$.\n\n**a) Analysis for $T_{i+\\frac{1}{2},j}$**\nThe target point is $P=(x_{i+\\frac{1}{2}}, y_j)$. The truncation error is $\\tau_T = \\frac{1}{2}(T(x_i, y_j) + T(x_{i+1}, y_j)) - T(x_{i+\\frac{1}{2}}, y_j)$. Let $\\Delta x_i = x_{i+1}-x_i$. The locations are $x_i = x_{i+\\frac{1}{2}} - \\frac{\\Delta x_i}{2}$ and $x_{i+1} = x_{i+\\frac{1}{2}} + \\frac{\\Delta x_i}{2}$.\nWe expand $T(x_i, y_j)$ and $T(x_{i+1}, y_j)$ in a Taylor series around $P$:\n$$T(x_i, y_j) = T|_P - \\left(\\frac{\\Delta x_i}{2}\\right)\\frac{\\partial T}{\\partial x}\\bigg|_P + \\frac{1}{2}\\left(\\frac{\\Delta x_i}{2}\\right)^2\\frac{\\partial^2 T}{\\partial x^2}\\bigg|_P - \\frac{1}{6}\\left(\\frac{\\Delta x_i}{2}\\right)^3\\frac{\\partial^3 T}{\\partial x^3}\\bigg|_P + O((\\Delta x_i)^4)$$\n$$T(x_{i+1}, y_j) = T|_P + \\left(\\frac{\\Delta x_i}{2}\\right)\\frac{\\partial T}{\\partial x}\\bigg|_P + \\frac{1}{2}\\left(\\frac{\\Delta x_i}{2}\\right)^2\\frac{\\partial^2 T}{\\partial x^2}\\bigg|_P + \\frac{1}{6}\\left(\\frac{\\Delta x_i}{2}\\right)^3\\frac{\\partial^3 T}{\\partial x^3}\\bigg|_P + O((\\Delta x_i)^4)$$\nAveraging these two expansions:\n$$\\frac{T(x_i, y_j) + T(x_{i+1}, y_j)}{2} = T|_P + \\frac{1}{2}\\left(\\frac{\\Delta x_i}{2}\\right)^2\\frac{\\partial^2 T}{\\partial x^2}\\bigg|_P + O((\\Delta x_i)^4) = T|_P + \\frac{(\\Delta x_i)^2}{8}\\frac{\\partial^2 T}{\\partial x^2}\\bigg|_P + O((\\Delta x_i)^4)$$\nThe truncation error is:\n$$\\tau_T = \\left( T|_P + \\frac{(\\Delta x_i)^2}{8}\\frac{\\partial^2 T}{\\partial x^2}\\bigg|_P \\right) - T|_P + O((\\Delta x_i)^4) = \\frac{(\\Delta x_i)^2}{8}\\frac{\\partial^2 T}{\\partial x^2}\\bigg|_P + O((\\Delta x_i)^4)$$\nThe leading error term is proportional to $(\\Delta x_i)^2$, so the consistency order is $p=2$. By symmetry, the interpolation for $T_{i,j+\\frac{1}{2}}$ also has a consistency order of $p=2$, with error $\\tau_T = \\frac{(\\Delta y_j)^2}{8}\\frac{\\partial^2 T}{\\partial y^2}|_{(x_i, y_{j+\\frac{1}{2}})} + O((\\Delta y_j)^4)$.\n\n**b) Analysis for $u_{i,j+\\frac{1}{2}}$**\nThe analysis is performed in two steps, mirroring the interpolation procedure.\nLet $Q = (x_i, y_{j+\\frac{1}{2}})$ be the target point.\nStep 1 Error (x-interpolation): The error of the linear interpolation $\\tilde{u}(x_i, y)$ from $u(x_{i-\\frac{1}{2}}, y)$ and $u(x_{i+\\frac{1}{2}}, y)$ is:\n$$\\tau_x(y) = \\tilde{u}(x_i, y) - u(x_i, y) = -\\frac{(x_i - x_{i-\\frac{1}{2}})(x_i-x_{i+\\frac{1}{2}})}{2} \\frac{\\partial^2 u}{\\partial x^2}(x_i, y) + O(\\Delta x^3)$$\nUsing $x_i-x_{i-\\frac{1}{2}} = \\frac{\\Delta x_{i-1}}{2}$ and $x_i-x_{i+\\frac{1}{2}} = -\\frac{\\Delta x_i}{2}$:\n$$\\tau_x(y) = \\frac{\\Delta x_{i-1} \\Delta x_i}{8} \\frac{\\partial^2 u}{\\partial x^2}(x_i, y) + O(\\Delta x^3)$$\nSo, $\\tilde{u}(x_i,y_j) = u(x_i,y_j) + \\tau_x(y_j)$ and $\\tilde{u}(x_i,y_{j+1}) = u(x_i,y_{j+1}) + \\tau_x(y_{j+1})$.\n\nStep 2 Error (y-interpolation): The final interpolated value is $\\tilde{u}_Q = \\frac{1}{2}(\\tilde{u}(x_i,y_j) + \\tilde{u}(x_i,y_{j+1}))$.\n$$\\tilde{u}_Q = \\frac{1}{2}(u(x_i,y_j) + u(x_i,y_{j+1})) + \\frac{1}{2}(\\tau_x(y_j) + \\tau_x(y_{j+1}))$$\nThe first term is the standard linear interpolation of the exact function $u$ from $y_j$ and $y_{j+1}$ to $y_{j+\\frac{1}{2}}$. From the analysis for $T$, its error is known:\n$$\\frac{1}{2}(u(x_i,y_j) + u(x_i,y_{j+1})) = u(x_i,y_{j+\\frac{1}{2}}) + \\frac{(\\Delta y_j)^2}{8} \\frac{\\partial^2 u}{\\partial y^2}\\bigg|_Q + O(\\Delta y^4)$$\nThe second term involves the error from Step 1. We approximate the average of $\\tau_x$ by its value at the midpoint, which is itself a second-order accurate approximation:\n$$\\frac{1}{2}(\\tau_x(y_j) + \\tau_x(y_{j+1})) = \\tau_x(y_{j+\\frac{1}{2}}) + O(\\Delta y^2) = \\frac{\\Delta x_{i-1} \\Delta x_i}{8} \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_Q + O(\\Delta x^2 \\Delta y^2) + O(\\Delta x^3)$$\nCombining these parts, the total truncation error $\\tau_u = \\tilde{u}_Q - u_Q$ is:\n$$\\tau_u = \\frac{(\\Delta y_j)^2}{8} \\frac{\\partial^2 u}{\\partial y^2}\\bigg|_Q + \\frac{\\Delta x_{i-1} \\Delta x_i}{8} \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_Q + \\text{H.O.T.}$$\nThe leading terms are of order $(\\Delta y_j)^2$ and $(\\Delta x_{i-1}\\Delta x_i)$, which both scale as $\\Delta^2$ for a characteristic grid size $\\Delta$. Thus, the consistency order is $p=2$.\n\n### Conclusion\nAll three specified linear interpolation schemes—$T$ to $u$-locations, $T$ to $v$-locations, and $u$ to scalar face locations—are shown to have a leading truncation error term proportional to the square of the grid spacing. Therefore, the common consistency order for all three interpolations is $p=2$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "Beyond understanding the theoretical underpinnings, a crucial skill for any computational engineer is verifying that a numerical code correctly solves the intended equations. The Method of Manufactured Solutions (MMS) is the gold standard for such code verification. This advanced practice  challenges you to apply MMS to a full set of thermal convection equations discretized on a staggered grid, deriving the precise source terms needed to make a chosen analytical solution satisfy the governing equations exactly.",
            "id": "3986249",
            "problem": "Consider the incompressible, constant-property thermal convection equations on a two-dimensional unit square domain $\\Omega = [0,1] \\times [0,1]$ with periodic boundary conditions in both spatial directions. The equations are posed in primitive variables and read, for velocity $\\mathbf{u} = (u,v)$, pressure $p$, and temperature $T$,\n$$\n\\nabla \\cdot \\mathbf{u} = 0,\n$$\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^{2}\\mathbf{u} + g \\beta \\left(T - T_{r}\\right)\\,\\hat{\\mathbf{e}}_{y} + \\mathbf{s}_{\\mathbf{u}},\n$$\n$$\n\\frac{\\partial T}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)T = \\alpha \\nabla^{2} T + s_{T},\n$$\nwhere $\\rho$ is the constant mass density, $\\nu$ is the kinematic viscosity, $\\alpha$ is the thermal diffusivity, $\\beta$ is the thermal expansion coefficient, $g$ is the gravitational acceleration magnitude, $T_{r}$ is a reference temperature, $\\hat{\\mathbf{e}}_{y}$ is the unit vector in the $y$-direction, $\\mathbf{s}_{\\mathbf{u}} = (s_{u}, s_{v})$ is a manufactured momentum source per unit mass (with units $\\mathrm{m}\\,\\mathrm{s}^{-2}$), and $s_{T}$ is a manufactured thermal source (with units $\\mathrm{K}\\,\\mathrm{s}^{-1}$). The verification target is a finite-volume discretization on a staggered grid arrangement: velocity components are face-centered, while pressure and temperature are cell-centered.\n\nUsing the Method of Manufactured Solutions (MMS), propose the following exact, smooth, periodic fields intended to be sampled at their respective staggered locations:\n$$\nu(x,y,t) = \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t),\n$$\n$$\nv(x,y,t) = -\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t),\n$$\n$$\nT(x,y,t) = \\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t),\n$$\n$$\np(x,y,t) = \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(3t).\n$$\nAssume $T_{r} = 0$ and $\\rho$, $\\nu$, $\\alpha$, $\\beta$, and $g$ are strictly positive constants. Starting from the fundamental laws stated above and without invoking any shortcut formulas, derive the exact closed-form source terms $s_{u}(x,y,t)$, $s_{v}(x,y,t)$, and $s_{T}(x,y,t)$ that make these manufactured fields satisfy the governing equations pointwise. Express your final results symbolically, keeping $\\rho$, $\\nu$, $\\alpha$, $\\beta$, and $g$ explicit.\n\nAnswer form and units:\n- Provide a single analytical expression containing the three source terms in a single row matrix using the $\\mathrm{pmatrix}$ environment, ordered as $\\left(s_{u}, s_{v}, s_{T}\\right)$.\n- Express the momentum sources per unit mass in $\\mathrm{m}\\,\\mathrm{s}^{-2}$ and the thermal source in $\\mathrm{K}\\,\\mathrm{s}^{-1}$ (do not include units inside the final boxed expression).\n- No numerical rounding is required; present exact expressions.",
            "solution": "The Method of Manufactured Solutions (MMS) prescribes smooth, exact fields and deduces the source terms that make these fields satisfy the governing equations. We begin from the incompressible continuity equation, the momentum equation with Boussinesq buoyancy, and the advection-diffusion energy equation:\n$$\n\\nabla \\cdot \\mathbf{u} = 0,\n$$\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^{2}\\mathbf{u} + g \\beta T\\,\\hat{\\mathbf{e}}_{y} + \\mathbf{s}_{\\mathbf{u}},\n$$\n$$\n\\frac{\\partial T}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)T = \\alpha \\nabla^{2} T + s_{T},\n$$\nwhere we set $T_{r} = 0$.\n\nWe first verify incompressibility of the manufactured velocity:\n$$\nu(x,y,t) = \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t), \\quad\nv(x,y,t) = -\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t).\n$$\nCompute the divergence:\n$$\n\\frac{\\partial u}{\\partial x} = 2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t),\n$$\n$$\n\\frac{\\partial v}{\\partial y} = -2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t),\n$$\nhence\n$$\n\\nabla \\cdot \\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0,\n$$\nas required.\n\nWe next compute the terms needed for the source derivation.\n\nTime derivatives:\n$$\n\\frac{\\partial u}{\\partial t} = u = \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t),\n$$\n$$\n\\frac{\\partial v}{\\partial t} = v = -\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t),\n$$\n$$\n\\frac{\\partial T}{\\partial t} = 2\\,T = 2\\,\\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t),\n$$\n$$\n\\frac{\\partial p}{\\partial t} = 3\\,p = 3\\,\\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(3t).\n$$\n\nSpatial derivatives for advection in the momentum equations:\n\nFor $u$,\n$$\n\\frac{\\partial u}{\\partial x} = 2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t), \\quad\n\\frac{\\partial u}{\\partial y} = -2\\pi \\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t).\n$$\nFor $v$,\n$$\n\\frac{\\partial v}{\\partial x} = 2\\pi \\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t), \\quad\n\\frac{\\partial v}{\\partial y} = -2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t).\n$$\nAdvection contributions:\n$$\n(\\mathbf{u}\\cdot\\nabla)u = u\\,\\frac{\\partial u}{\\partial x} + v\\,\\frac{\\partial u}{\\partial y}\n= \\left[\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\\right]\\left[2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\\right]\n$$\n$$\n\\quad + \\left[-\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\\right]\\left[-2\\pi \\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\\right]\n$$\n$$\n= 2\\pi \\exp(2t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x)\\,\\left[\\cos^{2}(2\\pi y) + \\sin^{2}(2\\pi y)\\right]\n= 2\\pi \\exp(2t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x).\n$$\nSimilarly,\n$$\n(\\mathbf{u}\\cdot\\nabla)v = u\\,\\frac{\\partial v}{\\partial x} + v\\,\\frac{\\partial v}{\\partial y}\n$$\n$$\n= \\left[\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\\right]\\left[2\\pi \\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\\right]\n+ \\left[-\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\\right]\\left[-2\\pi \\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\\right]\n$$\n$$\n= 2\\pi \\exp(2t)\\,\\sin(2\\pi y)\\,\\cos(2\\pi y)\\,\\left[\\sin^{2}(2\\pi x) + \\cos^{2}(2\\pi x)\\right]\n= 2\\pi \\exp(2t)\\,\\sin(2\\pi y)\\,\\cos(2\\pi y).\n$$\n\nPressure gradients:\n$$\n\\frac{\\partial p}{\\partial x} = -2\\pi \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(3t), \\quad\n\\frac{\\partial p}{\\partial y} = -2\\pi \\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(3t).\n$$\n\nLaplacians:\nFor trigonometric products with equal wavenumbers $2\\pi$ in $x$ and $y$, we use $\\nabla^{2}[\\sin(2\\pi x)\\cos(2\\pi y)] = -\\left((2\\pi)^{2} + (2\\pi)^{2}\\right)\\sin(2\\pi x)\\cos(2\\pi y) = -8\\pi^{2}\\sin(2\\pi x)\\cos(2\\pi y)$, and likewise for other combinations.\nThus,\n$$\n\\nabla^{2}u = -8\\pi^{2}\\,\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t),\n$$\n$$\n\\nabla^{2}v = +8\\pi^{2}\\,\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t),\n$$\n$$\n\\nabla^{2}T = -8\\pi^{2}\\,\\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t).\n$$\n\nTemperature advection:\n$$\n\\frac{\\partial T}{\\partial x} = 2\\pi \\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t), \\quad\n\\frac{\\partial T}{\\partial y} = 2\\pi \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(2t),\n$$\nso\n$$\n(\\mathbf{u}\\cdot\\nabla)T = u\\,\\frac{\\partial T}{\\partial x} + v\\,\\frac{\\partial T}{\\partial y}\n$$\n$$\n= \\left[\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\\right]\\left[2\\pi \\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t)\\right]\n+ \\left[-\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\\right]\\left[2\\pi \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(2t)\\right]\n$$\n$$\n= 2\\pi \\exp(3t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\sin(2\\pi y)\n- 2\\pi \\exp(3t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x)\\,\\cos(2\\pi y)\\,\\sin(2\\pi y)\n= 0.\n$$\n\nWith these components, assemble the manufactured sources by rearranging each equation to solve for the source terms.\n\nFor the momentum sources per unit mass, componentwise:\n$$\ns_{u} = \\frac{\\partial u}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)u + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} - \\nu \\nabla^{2}u,\n$$\n$$\ns_{v} = \\frac{\\partial v}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)v + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial y} - \\nu \\nabla^{2}v - g\\beta T,\n$$\nwhere the last term accounts for Boussinesq buoyancy in the $y$-direction.\n\nSubstituting the computed pieces:\n$$\ns_{u}(x,y,t) = \\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t) + 2\\pi \\exp(2t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x)\n- \\frac{2\\pi}{\\rho}\\,\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(3t)\n+ 8\\nu \\pi^{2}\\,\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t).\n$$\nFor $s_{v}$,\n$$\ns_{v}(x,y,t) = -\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t) + 2\\pi \\exp(2t)\\,\\sin(2\\pi y)\\,\\cos(2\\pi y)\n- \\frac{2\\pi}{\\rho}\\,\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(3t)\n- 8\\nu \\pi^{2}\\,\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t)\n- g\\beta\\,\\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t).\n$$\n\nFor the thermal source,\n$$\ns_{T} = \\frac{\\partial T}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)T - \\alpha \\nabla^{2}T\n= 2\\,T + 0 - \\alpha \\left[-8\\pi^{2} T\\right]\n= \\left(2 + 8\\alpha \\pi^{2}\\right)\\,T,\n$$\nso\n$$\ns_{T}(x,y,t) = \\left(2 + 8\\alpha \\pi^{2}\\right)\\,\\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t).\n$$\n\nThese source terms are smooth, periodic, and compatible with the staggered grid arrangement: face-centered velocity fields satisfy incompressibility exactly at the continuous level, ensuring that discrete divergence with second-order central differences will be zero up to truncation and round-off when sampled consistently. Pressure and temperature are cell-centered; the manufactured gradients and Laplacians computed above are well-defined and provide exact right-hand sides for code verification.\n\nCollect the three source terms in the required order for the final answer.",
            "answer": "$$\\boxed{\n\\begin{pmatrix}\n\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t) + 2\\pi \\exp(2t)\\,\\sin(2\\pi x)\\,\\cos(2\\pi x) - \\dfrac{2\\pi}{\\rho}\\,\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(3t) + 8\\nu \\pi^{2}\\,\\sin(2\\pi x)\\,\\cos(2\\pi y)\\,\\exp(t)\n&\n-\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t) + 2\\pi \\exp(2t)\\,\\sin(2\\pi y)\\,\\cos(2\\pi y) - \\dfrac{2\\pi}{\\rho}\\,\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(3t) - 8\\nu \\pi^{2}\\,\\cos(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(t) - g\\beta\\,\\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t)\n&\n\\left(2 + 8\\alpha \\pi^{2}\\right)\\,\\sin(2\\pi x)\\,\\sin(2\\pi y)\\,\\exp(2t)\n\\end{pmatrix}\n}$$"
        }
    ]
}