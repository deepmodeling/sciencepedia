{
    "hands_on_practices": [
        {
            "introduction": "在并置网格上，速度和压力的耦合是一个核心挑战，处理不当会导致非物理的棋盘状压力振荡。本练习提供了一个直观的计算实验，让您亲眼见证这一现象的发生，并通过对比有无 Rhie-Chow 插值的离散散度结果，来验证该方法如何有效地抑制压力-速度解耦。这个实践将帮助您建立为何需要 Rhie-Chow 修正的深刻理解 。",
            "id": "3939869",
            "problem": "考虑一个二维、不可压缩的稳态流场，该流场位于一个均匀的同位网格上，其中速度分量和压力存储在网格中心。控制方程为连续性方程 $\\nabla \\cdot \\mathbf{u} = 0$ 和动量方程 $\\rho (\\mathbf{u} \\cdot \\nabla) \\mathbf{u} = - \\nabla p + \\mu \\nabla^2 \\mathbf{u}$，其中密度 $\\rho$ 和动力粘度 $\\mu$ 为常数。在计算流体动力学（CFD）中，众所周知，除非应用像 Rhie–Chow 插值这样的稳定化方法，否则同位网格可能会出现虚假的压力振荡（棋盘格现象）。您的任务是构建一个简单的离散测试，以演示在没有 Rhie–Chow 插值的情况下，同位网格上如何产生压力振荡，即使在施加了精确均匀边界条件的情况下也是如此。\n\n基本背景和离散设置：\n- 使用一个大小为 $N_x \\times N_y$ 的均匀笛卡尔网格，其均匀间距为 $\\Delta x = 1$ 和 $\\Delta y = 1$，并在两个方向上都采用周期性边界条件。周期性边界代表了均匀解的精确延续。\n- 假设一个基础均匀速度场 $\\tilde{u} = U_0$ 和 $\\tilde{v} = 0$，以及一个基础压力 $p_0$（常数）。所有量都是无量纲的。\n- 在 $p_0$ 的基础上，引入一个振幅为 $\\varepsilon$ 的无量纲小扰动——棋盘格压力扰动：\n$$\np_{i,j} = p_0 + \\varepsilon (-1)^{i+j},\n$$\n对于网格索引 $i \\in \\{0,1,\\dots,N_x-1\\}$ 和 $j \\in \\{0,1,\\dots,N_y-1\\}$。在周期性边界和偶数 $N_x, N_y$ 的情况下，此扰动是一致的，并且基础均匀解在边界处保持精确。\n\n离散梯度、速度更新和面插值：\n- 使用二阶中心差分（带周期性环绕）计算离散的网格中心压力梯度：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2 \\Delta x}, \\quad\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2 \\Delta y}.\n$$\n- 定义一个无量纲动量对角系数 $a_m  0$，它代表隐式动量算子的强度（其倒数用于缩放压力梯度对速度的贡献）。由压力引起的速度更新在网格中心进行，公式如下：\n$$\nu_{i,j} = \\tilde{u} - \\frac{1}{a_m} \\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}, \\quad\nv_{i,j} = \\tilde{v} - \\frac{1}{a_m} \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}.\n$$\n\n两种面插值策略：\n1. 不使用 Rhie–Chow 插值（朴素的同位插值）：\n   - 通过对相邻网格中心的速度进行线性插值来计算面速度：\n   $$\n   u_{e,i,j} = \\frac{u_{i,j} + u_{i+1,j}}{2}, \\quad u_{w,i,j} = \\frac{u_{i,j} + u_{i-1,j}}{2},\n   $$\n   $$\n   v_{n,i,j} = \\frac{v_{i,j} + v_{i,j+1}}{2}, \\quad v_{s,i,j} = \\frac{v_{i,j} + v_{i,j-1}}{2}.\n   $$\n   - 使用面上的差分计算每个网格的离散散度：\n   $$\n   (\\nabla \\cdot \\mathbf{u})_{i,j}^{\\text{naive}} = \\frac{u_{e,i,j} - u_{w,i,j}}{\\Delta x} + \\frac{v_{n,i,j} - v_{s,i,j}}{\\Delta y}.\n   $$\n2. 使用 Rhie–Chow 插值（稳定化的同位插值）：\n   - 定义面动量系数 $a_f = a_m$。\n   - 使用跨面的压力差项来增强面速度：\n   $$\n   u_{e,i,j}^{\\text{RC}} = \\frac{u_{i,j} + u_{i+1,j}}{2} - \\frac{1}{a_f} \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x}, \\quad\n   u_{w,i,j}^{\\text{RC}} = \\frac{u_{i,j} + u_{i-1,j}}{2} - \\frac{1}{a_f} \\frac{p_{i,j} - p_{i-1,j}}{\\Delta x},\n   $$\n   $$\n   v_{n,i,j}^{\\text{RC}} = \\frac{v_{i,j} + v_{i,j+1}}{2} - \\frac{1}{a_f} \\frac{p_{i,j+1} - p_{i,j}}{\\Delta y}, \\quad\n   v_{s,i,j}^{\\text{RC}} = \\frac{v_{i,j} + v_{i,j-1}}{2} - \\frac{1}{a_f} \\frac{p_{i,j} - p_{i,j-1}}{\\Delta y}.\n   $$\n   - 计算离散散度：\n   $$\n   (\\nabla \\cdot \\mathbf{u})_{i,j}^{\\text{RC}} = \\frac{u_{e,i,j}^{\\text{RC}} - u_{w,i,j}^{\\text{RC}}}{\\Delta x} + \\frac{v_{n,i,j}^{\\text{RC}} - v_{s,i,j}^{\\text{RC}}}{\\Delta y}.\n   $$\n\n定量度量：\n- 对于每种策略，计算散度的全局离散 $L^2$ 范数：\n$$\n\\|\\nabla \\cdot \\mathbf{u}\\|_2 = \\left( \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} \\left[ (\\nabla \\cdot \\mathbf{u})_{i,j} \\right]^2 \\right)^{1/2}.\n$$\n- 证明对于棋盘格扰动和周期性边界，朴素的同位插值得到的 $\\|\\nabla \\cdot \\mathbf{u}\\|_2$ 在数值上等于 0（或达到机器精度），而 Rhie–Chow 插值得到的 $\\|\\nabla \\cdot \\mathbf{u}\\|_2$ 是一个与 $\\varepsilon$ 成正比的严格正值。\n\n测试套件：\n- 使用以下无量纲参数集 $(N_x,N_y,U_0,a_m,\\varepsilon)$：\n  1. $(4,4,1.0,1.0,10^{-3})$\n  2. $(16,16,0.5,1.0,10^{-3})$\n  3. $(8,8,0.0,2.0,10^{-6})$\n  4. $(6,10,3.0,0.5,10^{-4})$\n\n程序要求：\n- 实现上述带有周期性边界条件和两种面插值策略的离散操作。\n- 对于每个测试用例，计算并记录一对浮点数 $[\\|\\nabla \\cdot \\mathbf{u}\\|_2^{\\text{naive}}, \\|\\nabla \\cdot \\mathbf{u}\\|_2^{\\text{RC}}]$。\n- 您的程序应生成单行输出，其中包含这些浮点数对的结果，结果为用逗号分隔并包含在方括号中的列表，例如 $[[a,b],[c,d],[e,f],[g,h]]$，其中每个字母都是一个浮点数。\n\n所有量都是无量纲的，因此输出中不需要物理单位。不出现角度。不使用百分比。",
            "solution": "我们从不可压缩连续性方程 $\\nabla \\cdot \\mathbf{u} = 0$ 和稳态动量方程 $\\rho (\\mathbf{u} \\cdot \\nabla) \\mathbf{u} = - \\nabla p + \\mu \\nabla^2 \\mathbf{u}$ 开始。在同位网格上，速度 $\\mathbf{u}$ 和压力 $p$ 存储在相同的位置（网格中心）。对于具有周期性边界的稳态均匀流，一个精确解是 $\\mathbf{u} = (U_0, 0)$ 和 $p = p_0$（常数）。我们考虑一个叠加的棋盘格压力扰动 $p_{i,j} = p_0 + \\varepsilon (-1)^{i+j}$，以研究面插值方案的数值响应。\n\n离散化选择：\n- 我们采用 $\\Delta x = \\Delta y = 1$ 的均匀网格、周期性边界条件，并使用中心差分计算网格中心的压力梯度：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2}, \\quad\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2}.\n$$\n对于棋盘格模式和偶数 $N_x,N_y$，我们注意到 $p_{i+1,j}$ 与 $p_{i-1,j}$ 符号相同，与 $p_{i,j}$ 相反，这意味着 $p_{i+1,j} = p_{i-1,j}$。\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2} = 0, \\quad\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = 0.\n$$\n因此，由压力梯度更新的网格中心速度，\n$$\nu_{i,j} = \\tilde{u} - \\frac{1}{a_m} \\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}, \\quad\nv_{i,j} = \\tilde{v} - \\frac{1}{a_m} \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j},\n$$\n简化为 $u_{i,j} = \\tilde{u} = U_0$ 和 $v_{i,j} = \\tilde{v} = 0$ 在所有位置均成立，尽管存在压力振荡。\n\n朴素的同位面插值：\n- 朴素策略将网格中心速度线性插值到面上：\n$$\nu_{e,i,j} = \\frac{u_{i,j} + u_{i+1,j}}{2}, \\quad u_{w,i,j} = \\frac{u_{i,j} + u_{i-1,j}}{2},\n$$\n$$\nv_{n,i,j} = \\frac{v_{i,j} + v_{i,j+1}}{2}, \\quad v_{s,i,j} = \\frac{v_{i,j} + v_{i,j-1}}{2}.\n$$\n由于 $u_{i,j} = U_0$ 是常数且 $v_{i,j} = 0$ 是常数，我们有 $u_{e,i,j} = u_{w,i,j} = U_0$ 和 $v_{n,i,j} = v_{s,i,j} = 0$。因此，离散散度\n$$\n(\\nabla \\cdot \\mathbf{u})_{i,j}^{\\text{naive}} = (u_{e,i,j} - u_{w,i,j}) + (v_{n,i,j} - v_{s,i,j}) = 0,\n$$\n对于所有网格单元都成立。全局 $L^2$ 范数 $\\|\\nabla \\cdot \\mathbf{u}\\|_2^{\\text{naive}}$ 恒等于 $0$。这揭示了解耦现象：棋盘格压力振荡不会在面上引起任何修正质量通量，因此连续性方程对其“视而不见”，从而允许虚假压力模式持续存在。\n\nRhie–Chow 插值：\n- Rhie–Chow 插值通过添加一个压力差项来修改面速度，该项使用面中心的压力差而不是网格中心的梯度：\n$$\nu_{e,i,j}^{\\text{RC}} = \\frac{u_{i,j} + u_{i+1,j}}{2} - \\frac{1}{a_f} (p_{i+1,j} - p_{i,j}), \\quad\nu_{w,i,j}^{\\text{RC}} = \\frac{u_{i,j} + u_{i-1,j}}{2} - \\frac{1}{a_f} (p_{i,j} - p_{i-1,j}),\n$$\n$$\nv_{n,i,j}^{\\text{RC}} = \\frac{v_{i,j} + v_{i,j+1}}{2} - \\frac{1}{a_f} (p_{i,j+1} - p_{i,j}), \\quad\nv_{s,i,j}^{\\text{RC}} = \\frac{v_{i,j} + v_{i,j-1}}{2} - \\frac{1}{a_f} (p_{i,j} - p_{i,j-1}).\n$$\n这里我们为简化起见设 $a_f = a_m$。得到的离散散度是\n$$\n(\\nabla \\cdot \\mathbf{u})_{i,j}^{\\text{RC}} = \\left[ \\frac{u_{e,i,j}^{\\text{RC}} - u_{w,i,j}^{\\text{RC}}}{\\Delta x} + \\frac{v_{n,i,j}^{\\text{RC}} - v_{s,i,j}^{\\text{RC}}}{\\Delta y} \\right].\n$$\n当 $\\Delta x = \\Delta y = 1$ 且 $u_{i,j} = U_0$, $v_{i,j} = 0$ 时，均匀部分抵消，剩下压力的贡献：\n$$\n(\\nabla \\cdot \\mathbf{u})_{i,j}^{\\text{RC}} = - \\frac{1}{a_f} \\left[(p_{i+1,j} - p_{i,j}) - (p_{i,j} - p_{i-1,j}) + (p_{i,j+1} - p_{i,j}) - (p_{i,j} - p_{i,j-1})\\right].\n$$\n重新整理，\n$$\n(\\nabla \\cdot \\mathbf{u})_{i,j}^{\\text{RC}} = - \\frac{1}{a_f} \\left[ p_{i+1,j} + p_{i-1,j} - 2 p_{i,j} + p_{i,j+1} + p_{i,j-1} - 2 p_{i,j} \\right].\n$$\n这是 $p$ 的离散 5 点拉普拉斯算子乘以 $-1/a_f$。对于棋盘格模式 $p_{i,j} = p_0 + \\varepsilon (-1)^{i+j}$，相邻值满足 $p_{i\\pm 1,j} = p_0 - (p_{i,j}-p_0)$ 和 $p_{i,j \\pm 1} = p_0 - (p_{i,j}-p_0)$，给出\n$$\np_{i+1,j} + p_{i-1,j} - 2 p_{i,j} = -4(p_{i,j}-p_0), \\quad p_{i,j+1} + p_{i,j-1} - 2 p_{i,j} = -4(p_{i,j}-p_0).\n$$\n因此\n$$\n(\\nabla \\cdot \\mathbf{u})_{i,j}^{\\text{RC}} = - \\frac{1}{a_f} \\left[ -8(p_{i,j}-p_0) \\right] = \\frac{8}{a_f} (p_{i,j}-p_0) = \\frac{8 \\varepsilon}{a_m} (-1)^{i+j}.\n$$\n全局 $L^2$ 范数是\n$$\n\\|\\nabla \\cdot \\mathbf{u}\\|_2^{\\text{RC}} = \\left( \\sum_{i,j} \\left[ \\frac{8 \\varepsilon}{a_m} \\right]^2 \\right)^{1/2} = \\frac{8 \\varepsilon}{a_m} \\sqrt{N_x N_y}.\n$$\n这个非零范数定量地描述了 Rhie–Chow 插值能够将棋盘格压力振荡转换成面通量修正项的能力，这些修正项在离散连续性方程中不会消失，从而抑制了虚假模式。\n\n算法设计：\n- 实现用于中心差分和面插值的周期性索引。\n- 用中心差分计算 $\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}$ 和 $\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}$。\n- 使用 $a_m$ 更新 $u_{i,j}$ 和 $v_{i,j}$。\n- 计算朴素面速度和散度；计算 $\\|\\nabla \\cdot \\mathbf{u}\\|_2^{\\text{naive}}$。\n- 计算 Rhie–Chow 面速度和散度；计算 $\\|\\nabla \\cdot \\mathbf{u}\\|_2^{\\text{RC}}$。\n- 对于给定的测试套件 $(N_x,N_y,U_0,a_m,\\varepsilon)$，记录浮点数对 $[\\|\\nabla \\cdot \\mathbf{u}\\|_2^{\\text{naive}}, \\|\\nabla \\cdot \\mathbf{u}\\|_2^{\\text{RC}}]$。\n- 预期的定性结果是，对于所有情况，$\\|\\nabla \\cdot \\mathbf{u}\\|_2^{\\text{naive}} \\approx 0$（达到机器精度），而 $\\|\\nabla \\cdot \\mathbf{u}\\|_2^{\\text{RC}}$ 等于 $\\frac{8 \\varepsilon}{a_m} \\sqrt{N_x N_y}$。\n\n该演示使用基本定律和标准中心差分离散格式，揭示了同位网格的解耦机制，并展示了 Rhie–Chow 插值如何恢复压力和面质量通量之间的耦合，从而消除了棋盘格零空间。",
            "answer": "```python\nimport numpy as np\n\ndef periodic_index(i, n):\n    # Return periodic index\n    return i % n\n\ndef compute_gradients(p):\n    nx, ny = p.shape\n    dpdx = np.zeros_like(p)\n    dpdy = np.zeros_like(p)\n    # Central differences with periodic wrap, dx = dy = 1\n    for i in range(nx):\n        ip = periodic_index(i + 1, nx)\n        im = periodic_index(i - 1, nx)\n        for j in range(ny):\n            jp = periodic_index(j + 1, ny)\n            jm = periodic_index(j - 1, ny)\n            dpdx[i, j] = 0.5 * (p[ip, j] - p[im, j])\n            dpdy[i, j] = 0.5 * (p[i, jp] - p[i, jm])\n    return dpdx, dpdy\n\ndef interpolate_faces_naive(u, v):\n    nx, ny = u.shape\n    # Face velocities at cell i,j: east, west, north, south\n    u_e = np.zeros_like(u)\n    u_w = np.zeros_like(u)\n    v_n = np.zeros_like(v)\n    v_s = np.zeros_like(v)\n    for i in range(nx):\n        ip = periodic_index(i + 1, nx)\n        im = periodic_index(i - 1, nx)\n        for j in range(ny):\n            jp = periodic_index(j + 1, ny)\n            jm = periodic_index(j - 1, ny)\n            u_e[i, j] = 0.5 * (u[i, j] + u[ip, j])\n            u_w[i, j] = 0.5 * (u[i, j] + u[im, j])\n            v_n[i, j] = 0.5 * (v[i, j] + v[i, jp])\n            v_s[i, j] = 0.5 * (v[i, j] + v[i, jm])\n    return u_e, u_w, v_n, v_s\n\ndef interpolate_faces_rc(u, v, p, a_f):\n    nx, ny = u.shape\n    u_e = np.zeros_like(u)\n    u_w = np.zeros_like(u)\n    v_n = np.zeros_like(v)\n    v_s = np.zeros_like(v)\n    for i in range(nx):\n        ip = periodic_index(i + 1, nx)\n        im = periodic_index(i - 1, nx)\n        for j in range(ny):\n            jp = periodic_index(j + 1, ny)\n            jm = periodic_index(j - 1, ny)\n            # dx = dy = 1\n            u_e[i, j] = 0.5 * (u[i, j] + u[ip, j]) - (1.0 / a_f) * (p[ip, j] - p[i, j])\n            u_w[i, j] = 0.5 * (u[i, j] + u[im, j]) - (1.0 / a_f) * (p[i, j] - p[im, j])\n            v_n[i, j] = 0.5 * (v[i, j] + v[i, jp]) - (1.0 / a_f) * (p[i, jp] - p[i, j])\n            v_s[i, j] = 0.5 * (v[i, j] + v[i, jm]) - (1.0 / a_f) * (p[i, j] - p[i, jm])\n    return u_e, u_w, v_n, v_s\n\ndef divergence_from_faces(u_e, u_w, v_n, v_s):\n    # dx = dy = 1\n    return (u_e - u_w) + (v_n - v_s)\n\ndef l2_norm(field):\n    return np.sqrt(np.sum(field**2))\n\ndef run_case(nx, ny, U0, a_m, eps):\n    # Construct checkerboard pressure with periodic consistency\n    i_idx = np.arange(nx).reshape(nx, 1)\n    j_idx = np.arange(ny).reshape(1, ny)\n    checker = ((-1)**(i_idx + j_idx))\n    p0 = 0.0\n    p = p0 + eps * checker\n\n    # Base velocities\n    u_tilde = np.full((nx, ny), U0)\n    v_tilde = np.zeros((nx, ny))\n\n    # Cell-centered gradients\n    dpdx, dpdy = compute_gradients(p)\n\n    # Update cell-centered velocities\n    u = u_tilde - (1.0 / a_m) * dpdx\n    v = v_tilde - (1.0 / a_m) * dpdy\n\n    # Naive face interpolation and divergence\n    u_e, u_w, v_n, v_s = interpolate_faces_naive(u, v)\n    div_naive = divergence_from_faces(u_e, u_w, v_n, v_s)\n    norm_naive = l2_norm(div_naive)\n\n    # Rhie–Chow face interpolation and divergence\n    u_e_rc, u_w_rc, v_n_rc, v_s_rc = interpolate_faces_rc(u, v, p, a_m)\n    div_rc = divergence_from_faces(u_e_rc, u_w_rc, v_n_rc, v_s_rc)\n    norm_rc = l2_norm(div_rc)\n\n    return [float(norm_naive), float(norm_rc)]\n\ndef solve():\n    test_cases = [\n        (4, 4, 1.0, 1.0, 1e-3),\n        (16, 16, 0.5, 1.0, 1e-3),\n        (8, 8, 0.0, 2.0, 1e-6),\n        (6, 10, 3.0, 0.5, 1e-4),\n    ]\n\n    results = []\n    for nx, ny, U0, a_m, eps in test_cases:\n        results.append(run_case(nx, ny, U0, a_m, eps))\n\n    # Print nested list of [norm_naive, norm_rc] for each case\n    # Ensure single-line output format exactly as specified.\n    print(str(results).replace(\" \", \"\"))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "在通过计算实验观察到 Rhie-Chow 插值的有效性之后，理解其背后的数学原理至关重要。本练习将引导您从第一性原理出发，推导包含 Rhie-Chow 修正项的离散连续性方程的完整代数形式。这个推导过程将揭示插值格式如何精确地在质量平衡中引入一个类似压力拉普拉斯算子的项，从而为压力修正算法提供了坚实的理论基础 。",
            "id": "3939855",
            "problem": "考虑一个在均匀同位网格上使用有限体积法（FVM）求解的二维、定常、不可压缩、恒定密度的流动。在每个控制体 $\\Omega_{P}$ 上，主要未知量是存储在单元中心的笛卡尔速度分量 $u$ 和 $v$ 以及压力 $p$。设单元尺寸在 $x$ 方向为 $\\Delta x$，在 $y$ 方向为 $\\Delta y$，因此面面积为 $A_{e} = \\Delta y$，$A_{w} = \\Delta y$，$A_{n} = \\Delta x$ 和 $A_{s} = \\Delta x$。分别用 $E$、$W$、$N$ 和 $S$ 表示单元 $P$ 的东、西、北、南相邻单元。设 $\\rho$ 表示恒定密度。设 $\\Omega_{P}$ 各个面上的外向单位法向量为 $\\mathbf{n}_{e} = (1,0)$，$\\mathbf{n}_{w} = (-1,0)$，$\\mathbf{n}_{n} = (0,1)$ 和 $\\mathbf{n}_{s} = (0,-1)$。\n\n从不可压缩流的积分形式连续性方程 $\\int_{\\Omega_{P}} \\nabla \\cdot \\mathbf{u} \\,\\mathrm{d}\\Omega = 0$ 出发，利用散度定理和控制体面划分，将质量守恒表示为面法向质量通量之和为零。在同位网格上，采用 Rhie–Chow 插值来计算面法向速度。在此设定下，假设单元中心速度的每个分量通过一个线性化的定常动量平衡与单元中心的压力梯度相关联，其对角系数对于 $u$-动量方程记为 $a_{P}^{u}$，对于 $v$-动量方程记为 $a_{P}^{v}$，同样地，对于相应的相邻单元记为 $a_{E}^{u}$、$a_{W}^{u}$、$a_{N}^{v}$ 和 $a_{S}^{v}$。使用与这些离散动量关系一致的面插值方法：通过相邻单元中心速度的算术平均值来近似每个面法向速度，并用一个校正项进行修正，该校正项为逆对角动量系数的算术平均值乘以跨面的中心有限差分压力梯度。具体来说，对东、西面使用 $x$ 分量（$u$），对南、北面使用 $y$ 分量（$v$）。每个面上的质量通量是密度、面面积和面法向速度的乘积，其符号与外向法向量一致。\n\n推导离散连续性残差 $R_{P}$ 的封闭形式表达式。$R_{P}$ 定义为 $\\Omega_{P}$ 上四个外向面质量通量的代数和，并完全用 $\\rho$、$\\Delta x$、$\\Delta y$、单元中心变量 $u_{P}$、$u_{E}$、$u_{W}$、$v_{P}$、$v_{N}$、$v_{S}$、压力 $p_{P}$、$p_{E}$、$p_{W}$、$p_{N}$、$p_{S}$ 以及对角动量系数 $a_{P}^{u}$、$a_{E}^{u}$、$a_{W}^{u}$、$a_{P}^{v}$、$a_{N}^{v}$、$a_{S}^{v}$ 来表示。您的推导必须从所述的积分形式连续性定律开始，并遵循物理上一致的离散化和 Rhie–Chow 插值概念。给出 $R_{P}$ 的最终符号表达式。不要代入任何数值。最终表达式中不要包含单位。",
            "solution": "推导步骤是合乎逻辑的，并遵循问题陈述。\n1. 从积分形式的连续性方程开始。\n2. 应用散度定理 - 面的通量之和。\n3. 用面速度 $u_e, u_w, v_n, v_s$ 表示质量残差 $R_P$。\n4. 使用特定的 Rhie-Chow 插值规则定义 $u_e, u_w, v_n, v_s$。\n5. 将这些代入 $R_P$。\n6. 进行代数化简。\n整个过程是合理的。\n该问题定义明确，以计算流体动力学原理为基础。它要求使用指定形式的 Rhie-Chow 插值，在同位网格上推导离散连续性残差。该问题是有效的。\n\n推导过程如下。\n首先，我们从控制体 $\\Omega_P$ 上的积分形式连续性方程开始：\n$$ \\int_{\\Omega_P} \\nabla \\cdot \\mathbf{u} \\,\\mathrm{d}\\Omega = 0 $$\n应用散度定理，我们将体积分转换为边界 $\\partial\\Omega_P$ 上的面积分：\n$$ \\int_{\\partial\\Omega_P} \\mathbf{u} \\cdot \\mathbf{n} \\,\\mathrm{d}S = 0 $$\n边界被划分为四个面：东（$e$）、西（$w$）、北（$n$）和南（$s$）。假设每个面上的属性是均匀的，该积分变为体积通量的代数和：\n$$ (\\mathbf{u}_e \\cdot \\mathbf{n}_e) A_e + (\\mathbf{u}_w \\cdot \\mathbf{n}_w) A_w + (\\mathbf{u}_n \\cdot \\mathbf{n}_n) A_n + (\\mathbf{u}_s \\cdot \\mathbf{n}_s) A_s = 0 $$\n使用给定的外向单位法向量 $\\mathbf{n}_e=(1,0)$、$\\mathbf{n}_w=(-1,0)$、$\\mathbf{n}_n=(0,1)$、$\\mathbf{n}_s=(0,-1)$，并将在各面中心处沿正坐标方向的速度分量定义为面法向速度 $u_e$、$u_w$、$v_n$、$v_s$，体积守恒方程为：\n$$ u_e A_e - u_w A_w + v_n A_n - v_s A_s = 0 $$\n离散连续性残差 $R_P$ 定义为从控制体流出的净质量通量。对于密度为常数 $\\rho$ 的流体，这表示为：\n$$ R_P = \\rho (u_e A_e - u_w A_w + v_n A_n - v_s A_s) $$\n代入给定的面面积 $A_e = A_w = \\Delta y$ 和 $A_n = A_s = \\Delta x$：\n$$ R_P = \\rho \\left[ (u_e - u_w)\\Delta y + (v_n - v_s)\\Delta x \\right] $$\n接下来，我们使用规定的 Rhie–Chow 插值方案来表示面法向速度。对于每个面，其速度是相邻单元中心速度的算术平均值，外加一个校正项。该校正项涉及逆对角动量系数的平均值与跨面的中心压力梯度。对于单元 $P$ 和 $E$ 之间的东面速度 $u_e$：\n$$ u_e = \\frac{u_P + u_E}{2} - \\frac{1}{2} \\left( \\frac{1}{a_P^u} + \\frac{1}{a_E^u} \\right) \\frac{p_E - p_P}{\\Delta x} $$\n校正项的负号是因为正压力梯度会阻碍流动。通过类比，我们写出其他三个面的表达式：\n西面（$w$），位于单元 $W$ 和 $P$ 之间：\n$$ u_w = \\frac{u_W + u_P}{2} - \\frac{1}{2} \\left( \\frac{1}{a_W^u} + \\frac{1}{a_P^u} \\right) \\frac{p_P - p_W}{\\Delta x} $$\n北面（$n$），位于单元 $P$ 和 $N$ 之间：\n$$ v_n = \\frac{v_P + v_N}{2} - \\frac{1}{2} \\left( \\frac{1}{a_P^v} + \\frac{1}{a_N^v} \\right) \\frac{p_N - p_P}{\\Delta y} $$\n南面（$s$），位于单元 $S$ 和 $P$ 之间：\n$$ v_s = \\frac{v_S + v_P}{2} - \\frac{1}{2} \\left( \\frac{1}{a_S^v} + \\frac{1}{a_P^v} \\right) \\frac{p_P - p_S}{\\Delta y} $$\n现在我们将这些表达式代入 $R_P$ 的表达式中。让我们计算差值 $(u_e - u_w)$ 和 $(v_n - v_s)$。\n对于 $x$ 方向的速度：\n$$ u_e - u_w = \\left[ \\frac{u_P + u_E}{2} - \\frac{1}{2\\Delta x}\\left(\\frac{1}{a_P^u}+\\frac{1}{a_E^u}\\right)(p_E - p_P) \\right] - \\left[ \\frac{u_W + u_P}{2} - \\frac{1}{2\\Delta x}\\left(\\frac{1}{a_W^u}+\\frac{1}{a_P^u}\\right)(p_P - p_W) \\right] $$\n$$ u_e - u_w = \\frac{u_E - u_W}{2} - \\frac{1}{2\\Delta x}\\left(\\frac{1}{a_P^u}+\\frac{1}{a_E^u}\\right)(p_E - p_P) + \\frac{1}{2\\Delta x}\\left(\\frac{1}{a_W^u}+\\frac{1}{a_P^u}\\right)(p_P - p_W) $$\n对于 $y$ 方向的速度：\n$$ v_n - v_s = \\frac{v_N - v_S}{2} - \\frac{1}{2\\Delta y}\\left(\\frac{1}{a_P^v}+\\frac{1}{a_N^v}\\right)(p_N - p_P) + \\frac{1}{2\\Delta y}\\left(\\frac{1}{a_S^v}+\\frac{1}{a_P^v}\\right)(p_P - p_S) $$\n最后，我们将这些差值代回到 $R_P$ 的表达式中：\n$$ R_P = \\rho \\left[ (u_e - u_w)\\Delta y + (v_n - v_s)\\Delta x \\right] $$\n$$ R_P = \\rho \\left\\{ \\left[ \\frac{u_E - u_W}{2} \\right]\\Delta y + \\left[ \\frac{v_N - v_S}{2} \\right]\\Delta x \\right. $$\n$$ \\left. - \\left[ \\frac{1}{2\\Delta x}\\left(\\frac{1}{a_P^u}+\\frac{1}{a_E^u}\\right)(p_E - p_P) - \\frac{1}{2\\Delta x}\\left(\\frac{1}{a_W^u}+\\frac{1}{a_P^u}\\right)(p_P - p_W) \\right]\\Delta y \\right. $$\n$$ \\left. - \\left[ \\frac{1}{2\\Delta y}\\left(\\frac{1}{a_P^v}+\\frac{1}{a_N^v}\\right)(p_N - p_P) - \\frac{1}{2\\Delta y}\\left(\\frac{1}{a_S^v}+\\frac{1}{a_P^v}\\right)(p_P - p_S) \\right]\\Delta x \\right\\} $$\n将 $\\Delta y$ 和 $\\Delta x$ 项分配进去，得到以指定变量表示的残差 $R_P$ 的最终表达式。\n该表达式可以分为两部分：一部分来自简单的速度平均（已知其本身是不稳定的），另一部分来自压力梯度校正，它提供了必要的压力-速度耦合以防止棋盘格振荡。\n稍微重新排列，按面的贡献分组，即可得到最终形式。\n$$ R_P = \\rho \\left( \\frac{u_E - u_W}{2}\\Delta y + \\frac{v_N - v_S}{2}\\Delta x \\right) $$\n$$ - \\rho \\frac{\\Delta y}{2\\Delta x} \\left(\\frac{1}{a_P^u}+\\frac{1}{a_E^u}\\right)(p_E - p_P) + \\rho \\frac{\\Delta y}{2\\Delta x} \\left(\\frac{1}{a_W^u}+\\frac{1}{a_P^u}\\right)(p_P - p_W) $$\n$$ - \\rho \\frac{\\Delta x}{2\\Delta y} \\left(\\frac{1}{a_P^v}+\\frac{1}{a_N^v}\\right)(p_N - p_P) + \\rho \\frac{\\Delta x}{2\\Delta y} \\left(\\frac{1}{a_S^v}+\\frac{1}{a_P^v}\\right)(p_P - p_S) $$\n该表达式即为所要求的完整的离散连续性残差。",
            "answer": "$$\n\\boxed{\n\\rho\\left[ \\frac{(u_E - u_W)\\Delta y}{2} + \\frac{(v_N - v_S)\\Delta x}{2} \\right] - \\rho\\frac{\\Delta y}{2\\Delta x}\\left(\\frac{1}{a_{P}^{u}}+\\frac{1}{a_{E}^{u}}\\right)(p_E-p_P) + \\rho\\frac{\\Delta y}{2\\Delta x}\\left(\\frac{1}{a_{W}^{u}}+\\frac{1}{a_{P}^{u}}\\right)(p_P-p_W) - \\rho\\frac{\\Delta x}{2\\Delta y}\\left(\\frac{1}{a_{P}^{v}}+\\frac{1}{a_{N}^{v}}\\right)(p_N-p_P) + \\rho\\frac{\\Delta x}{2\\Delta y}\\left(\\frac{1}{a_{S}^{v}}+\\frac{1}{a_{P}^{v}}\\right)(p_P-p_S)\n}\n$$"
        },
        {
            "introduction": "Rhie-Chow 插值的基本思想具有很强的通用性，可以扩展到更高阶的数值格式以提升计算精度。这项高级练习挑战您将 Rhie-Chow 的概念与一种高阶速度重构方案（二次插值）相结合。通过推导修正后的通量公式，您将更深入地理解该方法的灵活性，并学会权衡更高精度与计算复杂性及数值稳定性之间的关系 。",
            "id": "3939904",
            "problem": "考虑在同位有限体积网格上，恒定截面积通道中牛顿流体的一维、稳态、不可压缩流动，其中速度和压力存储在相同的位置（单元中心）。沿 $x$ 方向的控制动量方程是 Navier–Stokes 方程的 $x$ 分量，空间离散化采用有限体积法（FVM）。在同位网格上，对单元中心速度进行简单的面插值会导致压力-速度解耦（棋盘格现象）。Rhie–Chow 插值在面速度公式中引入了与压力梯度一致的修正，以防止解耦。\n\n请您评估使用更高阶面速度重构的可行性，并推导 Rhie–Chow 面通量的相应修正。请从第一性原理出发，按以下步骤进行：\n\n- 从单元 $i$ 上 $x$ 方向动量方程的离散形式开始，其线性化形式写作 $a_i u_i = H_i - D_i (\\partial p/\\partial x)_i$，其中 $a_i$ 是由对流、扩散和时间项产生的对角动量系数，$H_i$ 是相邻单元贡献和源项的集合，$D_i$ 是乘以压力梯度贡献项的几何系数。简要解释为什么在同位网格上，面上纯插值的 $u_f$ 未能与离散压力场一致地耦合，以及为什么一个与面压力梯度和单元中心压力梯度插值之差成比例的 Rhie–Chow 型修正能够恢复耦合。\n\n- 现在，假设网格均匀，间距为 $\\Delta x$，流体密度 $\\rho$ 恒定，面面积 $A_f$ 恒定，并考虑位于单元 $i$ 和 $i+1$ 之间 $x_{i+1/2}$ 处的面 $f$。使用三点模板 $\\{x_{i-1}, x_i, x_{i+1}\\}$ 为速度构造一个关于 $x$ 的二次多项式，并在 $x_{i+1/2}$ 处对其求值，以获得用 $u_{i-1}$、$u_i$ 和 $u_{i+1}$ 表示的二阶面速度重构 $u_f^{\\mathrm{quad}}$。对于 Rhie–Chow 压力梯度修正，使用以下一致的二阶分量：\n    1.  在 $x_{i+1/2}$ 处的面压力梯度，通过两点差分计算，即 $\\left(\\partial p/\\partial x\\right)_f = \\left(p_{i+1} - p_i\\right)/\\Delta x$。\n    2.  单元中心压力梯度 $\\left(\\partial p/\\partial x\\right)_i = \\left(p_{i+1} - p_{i-1}\\right)/(2\\Delta x)$ 和 $\\left(\\partial p/\\partial x\\right)_{i+1} = \\left(p_{i+2} - p_i\\right)/(2\\Delta x)$，线性插值到面上为 $\\overline{\\left(\\partial p/\\partial x\\right)}_f = \\frac{1}{2}\\left[\\left(\\partial p/\\partial x\\right)_i + \\left(\\partial p/\\partial x\\right)_{i+1}\\right]$。\n    3.  逆面动量系数，由倒数的算术平均值给出，即 $\\beta_f = \\frac{1}{2}\\left(\\frac{1}{a_i} + \\frac{1}{a_{i+1}}\\right)$。\n\n- 使用这些分量，为位于 $x_{i+1/2}$ 处的面质量通量 $F_f = \\rho A_f u_f$ 推导一个闭式解析表达式，该表达式采用二次面速度重构和定义为 $-\\beta_f\\left[\\left(\\partial p/\\partial x\\right)_f - \\overline{\\left(\\partial p/\\partial x\\right)}_f\\right]$ 的 Rhie–Chow 修正。将最终表达式简化为用 $u_{i-1}$、$u_i$、$u_{i+1}$、$p_{i-1}$、$p_i$、$p_{i+1}$、$p_{i+2}$、$a_i$、$a_{i+1}$、$\\Delta x$、$A_f$ 和 $\\rho$ 表示的单一公式。\n\n在您的推导中，从业内一致性（对于线性压力场，修正项应为零）和潜在的稳定性问题（例如，在不使用限制器的情况下的过冲）方面，简要讨论这种带有 Rhie–Chow 插值的二次重构的可行性。您的最终答案必须是 $F_f$ 的单一、简化的解析表达式。不要对您的表达式进行数值计算，也不要在最终方框内的表达式中包含单位。",
            "solution": "该问题是有效的，因为它在科学上基于计算流体动力学（CFD）的原理，问题陈述清晰，目标明确，数据充分，且表述客观。我们开始进行求解。\n\n在有限体积法（FVM）中使用同位网格，即速度分量和压力共享相同的存储位置（例如，单元中心），先天就容易出现压力-速度解耦问题。这个问题源于离散动量方程和连续性方程的耦合方式。考虑单元 $i$ 上一维不可压缩流的离散连续性方程：$F_{i+1/2} - F_{i-1/2} = 0$，其中 $F_f = \\rho A_f u_f$ 是通过面 $f$ 的质量通量。如果面速度 $u_{i+1/2}$ 是通过对单元中心速度进行简单的线性插值得到的，即 $u_{i+1/2} = \\frac{1}{2}(u_i + u_{i+1})$，那么单元 $i$ 上的连续性方程的计算模板不直接涉及节点 $i$ 处的压力 $p_i$。具体来说，单元 $i$ 处的离散动量方程将 $u_i$ 与由 $p_{i+1}$ 和 $p_{i-1}$ 计算出的压力梯度联系起来。因此，单元 $i$ 处的连续性方程最终只将 $p_i$ 与其次近邻（$p_{i-2}$ 和 $p_{i+2}$）耦合，而不是与其直接相邻的邻居（$p_{i-1}$ 和 $p_{i+1}$）耦合。这使得在交替的网格点上可以存在两个独立的压力场，从而导致被称为“棋盘格”现象的非物理、振荡的压力解。\n\nRhie–Chow 插值方法通过在面速度中引入一个修正项来解决这个问题。其基本思想是以一种与驱动该速度的离散压力梯度相一致的方式重构面速度。单元 $i$ 的离散动量方程为 $a_i u_i = H_i - D_i (\\partial p/\\partial x)_i$。由此，我们可以将单元速度表示为 $u_i = (H_i/a_i) - (D_i/a_i)(\\partial p/\\partial x)_i$。将 $u_i$ 和 $u_{i+1}$ 简单插值到面 $i+1/2$ 会涉及到对 $(\\partial p/\\partial x)_i$ 和 $(\\partial p/\\partial x)_{i+1}$ 项的插值。Rhie-Chow 修正项与面上的紧凑、高阶压力梯度近似值 $(\\partial p/\\partial x)_f$ 和插值得到的单元中心压力梯度 $\\overline{(\\partial p/\\partial x)}_f$ 之差成正比。这个差值项有效地在连续性方程中引入了一个离散的压力拉普拉斯项，从而稳健地耦合了相邻的压力节点并抑制了振荡。该修正项被设计为在足够光滑的压力场中为零，从而保持了格式的理论精度。\n\n按照题目的要求，我们首先推导位于 $x_{i+1/2}$ 处面 $f$ 上的二阶（二次）面速度重构 $u_f^{\\mathrm{quad}}$。我们使用包含单元中心速度 $u_{i-1}$、$u_i$ 和 $u_{i+1}$ 的三点模板。设二次插值多项式为 $u(x')$，其中 $x'=x-x_i$ 是局部坐标：\n$$u(x') = c_0 + c_1 x' + c_2 (x')^2$$\n在 $x'=-\\Delta x$ ($u_{i-1}$)、$x'=0$ ($u_i$) 和 $x'=\\Delta x$ ($u_{i+1}$) 处速度已知。\n$u(0) = u_i \\implies c_0 = u_i$。\n$u(\\Delta x) = u_{i+1} = u_i + c_1 \\Delta x + c_2 (\\Delta x)^2$。\n$u(-\\Delta x) = u_{i-1} = u_i - c_1 \\Delta x + c_2 (\\Delta x)^2$。\n解此方程组得到 $c_1$ 和 $c_2$：\n$$c_1 = \\frac{u_{i+1} - u_{i-1}}{2\\Delta x}$$\n$$c_2 = \\frac{u_{i+1} - 2u_i + u_{i-1}}{2(\\Delta x)^2}$$\n面 $f$ 位于 $x_{i+1/2}$，对应于 $x' = \\Delta x / 2$。在此位置计算该多项式的值，得到所需的面速度重构：\n$$u_f^{\\mathrm{quad}} = u\\left(\\frac{\\Delta x}{2}\\right) = c_0 + c_1\\left(\\frac{\\Delta x}{2}\\right) + c_2\\left(\\frac{\\Delta x}{2}\\right)^2$$\n$$u_f^{\\mathrm{quad}} = u_i + \\left(\\frac{u_{i+1} - u_{i-1}}{2\\Delta x}\\right)\\frac{\\Delta x}{2} + \\left(\\frac{u_{i+1} - 2u_i + u_{i-1}}{2(\\Delta x)^2}\\right)\\frac{(\\Delta x)^2}{4}$$\n$$u_f^{\\mathrm{quad}} = u_i + \\frac{u_{i+1} - u_{i-1}}{4} + \\frac{u_{i+1} - 2u_i + u_{i-1}}{8}$$\n$$u_f^{\\mathrm{quad}} = \\frac{8u_i + 2(u_{i+1} - u_{i-1}) + (u_{i+1} - 2u_i + u_{i-1})}{8}$$\n$$u_f^{\\mathrm{quad}} = \\frac{8u_i + 2u_{i+1} - 2u_{i-1} + u_{i+1} - 2u_i + u_{i-1}}{8} = \\frac{6u_i + 3u_{i+1} - u_{i-1}}{8}$$\n这是基于 QUICK 格式的速度重构。\n\n接下来，我们使用所提供的分量来构建 Rhie-Chow 修正项。该修正项被加到插值速度上，因此最终的面速度为 $u_f = u_f^{\\mathrm{quad}} - \\beta_f \\left[ (\\partial p/\\partial x)_f - \\overline{(\\partial p/\\partial x)}_f \\right]$。我们来计算压力梯度差值项：\n$$ \\Delta\\left(\\frac{\\partial p}{\\partial x}\\right) = \\left(\\frac{\\partial p}{\\partial x}\\right)_f - \\overline{\\left(\\frac{\\partial p}{\\partial x}\\right)}_f $$\n使用给定的定义：\n$$ \\left(\\frac{\\partial p}{\\partial x}\\right)_f = \\frac{p_{i+1} - p_i}{\\Delta x} $$\n$$ \\overline{\\left(\\frac{\\partial p}{\\partial x}\\right)}_f = \\frac{1}{2}\\left[\\left(\\frac{\\partial p}{\\partial x}\\right)_i + \\left(\\frac{\\partial p}{\\partial x}\\right)_{i+1}\\right] = \\frac{1}{2}\\left[ \\frac{p_{i+1} - p_{i-1}}{2\\Delta x} + \\frac{p_{i+2} - p_i}{2\\Delta x} \\right] = \\frac{p_{i+1} - p_{i-1} + p_{i+2} - p_i}{4\\Delta x} $$\n将这些代入差值表达式：\n$$ \\Delta\\left(\\frac{\\partial p}{\\partial x}\\right) = \\frac{p_{i+1} - p_i}{\\Delta x} - \\frac{p_{i+2} + p_{i+1} - p_i - p_{i-1}}{4\\Delta x} $$\n$$ \\Delta\\left(\\frac{\\partial p}{\\partial x}\\right) = \\frac{4(p_{i+1} - p_i) - (p_{i+2} + p_{i+1} - p_i - p_{i-1})}{4\\Delta x} $$\n$$ \\Delta\\left(\\frac{\\partial p}{\\partial x}\\right) = \\frac{4p_{i+1} - 4p_i - p_{i+2} - p_{i+1} + p_i + p_{i-1}}{4\\Delta x} = \\frac{-p_{i+2} + 3p_{i+1} - 3p_i + p_{i-1}}{4\\Delta x} $$\n该项与压力的三阶导数的有限差分近似 $-(\\Delta x)^2 (\\partial^3 p/\\partial x^3)/4$ 成正比。根据一致性要求，如果压力场是二次、线性或常数，该项为零。\n\n现在，我们构建面速度 $u_f$ 的完整表达式。要加到 $u_f^{\\mathrm{quad}}$ 上的 Rhie-Chow 修正项定义为 $-\\beta_f \\Delta(\\partial p/\\partial x)$，其中 $\\beta_f = \\frac{1}{2}\\left(\\frac{1}{a_i} + \\frac{1}{a_{i+1}}\\right)$。\n$$ u_f = u_f^{\\mathrm{quad}} - \\beta_f \\left[ \\frac{-p_{i+2} + 3p_{i+1} - 3p_i + p_{i-1}}{4\\Delta x} \\right] $$\n$$ u_f = \\frac{6u_i + 3u_{i+1} - u_{i-1}}{8} + \\frac{1}{2}\\left(\\frac{1}{a_i} + \\frac{1}{a_{i+1}}\\right) \\left[ \\frac{p_{i+2} - 3p_{i+1} + 3p_i - p_{i-1}}{4\\Delta x} \\right] $$\n$$ u_f = \\frac{6u_i + 3u_{i+1} - u_{i-1}}{8} + \\frac{1}{8\\Delta x}\\left(\\frac{1}{a_i} + \\frac{1}{a_{i+1}}\\right) (p_{i+2} - 3p_{i+1} + 3p_i - p_{i-1}) $$\n最后，面质量通量 $F_f$ 为 $F_f = \\rho A_f u_f$。\n$$ F_f = \\rho A_f \\left[ \\frac{6u_i + 3u_{i+1} - u_{i-1}}{8} + \\frac{1}{8\\Delta x}\\left(\\frac{1}{a_i} + \\frac{1}{a_{i+1}}\\right) (p_{i+2} - 3p_{i+1} + 3p_i - p_{i-1}) \\right] $$\n该格式是可行且一致的。然而，其稳定性需要谨慎对待。已知 QUICK 速度重构在强梯度区域会产生非物理振荡（过冲和下冲），除非使用通量限制器。压力修正项作为一个离散的高阶导数，也可能引入数值噪声和潜在的不稳定性，尤其是在粗网格上。此外，包含该项会导致压力修正方程的计算模板更宽（在一维中为五对角系统），与标准的三对角系统相比，增加了计算成本。",
            "answer": "$$\n\\boxed{\\rho A_f \\left[ \\frac{6u_i + 3u_{i+1} - u_{i-1}}{8} + \\frac{1}{8\\Delta x}\\left(\\frac{1}{a_i} + \\frac{1}{a_{i+1}}\\right) (p_{i+2} - 3p_{i+1} + 3p_i - p_{i-1}) \\right]}\n$$"
        }
    ]
}