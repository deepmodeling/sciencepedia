{
    "hands_on_practices": [
        {
            "introduction": "掌握混合格式的第一步是学会在每个控制体表面上判断局部流动条件。面佩克莱数 $Pe_f$ 是控制这一决策的关键无量纲参数。本练习 () 将让你直接实践在二维流动中计算 $Pe_f$ 并应用混合格式的转换准则，这是在计算传热学中一项基本且至关重要的技能。",
            "id": "3991580",
            "problem": "在均匀笛卡尔网格上，使用有限体积法 (FVM) 求解被动标量 $\\phi$ 的二维稳态对流扩散问题。密度为恒定值 $\\rho$，速度场为均匀的 $\\mathbf{u}=(u,u)$，有效扩散系数为恒定值 $\\Gamma$。网格是均匀的，由边长为 $\\Delta$ 的方形控制体积组成，在平面外方向上的深度为单位长度。\n\n考虑一个以节点 $P$ 为中心的内部控制体积，其相邻单元中心为 $E$、$W$、$N$ 和 $S$，对应的面为 $e$、$w$、$n$ 和 $s$。从 $\\phi$ 的稳态守恒方程以及面上对流质量通量和扩散导率的定义出发，推导出每个面 $f \\in \\{e,w,n,s\\}$ 上的局部面佩克莱数 $Pe_f$ 关于 $\\rho$、$u$、$\\Gamma$ 和 $\\Delta$ 的表达式。对于参数值 $\\rho=1.0 \\text{ kg m}^{-3}$，$u=0.5 \\text{ m s}^{-1}$，$\\Gamma=0.01 \\text{ kg m}^{-1} \\text{ s}^{-1}$ 和 $\\Delta=0.1 \\text{ m}$，数值计算每个面上的 $Pe_f$。\n\n然后，使用对流扩散问题的混合差分格式（当 $|Pe_f|\\leq 2$ 时使用中心差分，当 $|Pe_f|>2$ 时切换到一阶迎风差分），分析在给定参数下每个面上的格式选择决策。对于格式选择迎风差分的面，确定相对于 $P$ 的供给节点。\n\n最后，定义\n$$\nS \\equiv \\sum_{f \\in \\{e,w,n,s\\}} |Pe_f|\n$$\n并将 $S$ 作为一个纯数（无量纲）报告，结果保留四位有效数字。",
            "solution": "被动标量 $\\phi$ 在控制体积 $CV$ 上的稳态守恒方程的积分形式为：\n$$\n\\oint_{\\partial CV} \\rho \\mathbf{u} \\phi \\cdot d\\mathbf{A} = \\oint_{\\partial CV} \\Gamma \\nabla \\phi \\cdot d\\mathbf{A}\n$$\n该方程平衡了流出控制体积的净对流通量与流入控制体积的净扩散通量。应用有限体积法，通过对以节点 $P$ 为中心的控制体积各个面上的通量求和，该积分方程被离散化为一个代数方程。这些面表示为 $e$ (东)、$w$ (西)、$n$ (北) 和 $s$ (南)。平衡关系变为：\n$$\n\\sum_{f \\in \\{e,w,n,s\\}} (\\text{对流通量})_f = \\sum_{f \\in \\{e,w,n,s\\}} (\\text{扩散通量})_f\n$$\n通过一个面 $f$ 的 $\\phi$ 的对流通量由 $F_f \\phi_f$ 给出，其中 $F_f$ 是对流质量通量；扩散通量由 $D_f (\\phi_{\\text{neighbor}} - \\phi_P)$ 给出，其中 $D_f$ 是扩散导率。局部面佩克莱数 $Pe_f$ 定义为该面上对流强度与扩散强度的比值：\n$$\nPe_f = \\frac{F_f}{D_f}\n$$\n对流质量通量 $F_f$ 定义为通过该面的质量流率，由 $F_f = (\\rho \\mathbf{u} \\cdot \\mathbf{A})_f = \\rho (\\mathbf{u} \\cdot \\mathbf{n}_f) A_f$ 给出，其中 $\\mathbf{n}_f$ 是面 $f$ 的外向单位法向量，$A_f$ 是该面的面积。扩散导率 $D_f$ 定义为 $D_f = \\frac{\\Gamma_f A_f}{\\delta_f}$，其中 $\\delta_f$ 是与面 $f$ 相邻的单元中心之间的距离。\n\n对于给定的问题，网格是均匀的，控制体积为边长为 $\\Delta$ 的正方形。深度为单位长度，因此每个面的面积为 $A_f = \\Delta \\times 1 = \\Delta$。相邻单元中心之间的距离也是 $\\Delta$。扩散系数 $\\Gamma$ 是恒定的。因此，任何面 $f$ 上的扩散导率为：\n$$\nD_f = \\frac{\\Gamma A_f}{\\Delta} = \\frac{\\Gamma \\Delta}{\\Delta} = \\Gamma\n$$\n速度场是均匀的，由 $\\mathbf{u}=(u,u)$ 给出。我们现在可以计算每个面的对流通量 $F_f$ 和佩克莱数 $Pe_f$。\n\n面 $e$ (东)：从 $P$ 出发的外向法向量为 $\\mathbf{n}_e = (1, 0)$。\n对流通量为 $F_e = \\rho (\\mathbf{u} \\cdot \\mathbf{n}_e) A_e = \\rho ((u,u) \\cdot (1,0)) \\Delta = \\rho u \\Delta$。\n佩克莱数为 $Pe_e = \\frac{F_e}{D_e} = \\frac{\\rho u \\Delta}{\\Gamma}$。\n\n面 $w$ (西)：从 $P$ 出发的外向法向量为 $\\mathbf{n}_w = (-1, 0)$。\n对流通量为 $F_w = \\rho (\\mathbf{u} \\cdot \\mathbf{n}_w) A_w = \\rho ((u,u) \\cdot (-1,0)) \\Delta = -\\rho u \\Delta$。\n佩克莱数为 $Pe_w = \\frac{F_w}{D_w} = \\frac{-\\rho u \\Delta}{\\Gamma}$。\n\n面 $n$ (北)：从 $P$ 出发的外向法向量为 $\\mathbf{n}_n = (0, 1)$。\n对流通量为 $F_n = \\rho (\\mathbf{u} \\cdot \\mathbf{n}_n) A_n = \\rho ((u,u) \\cdot (0,1)) \\Delta = \\rho u \\Delta$。\n佩克莱数为 $Pe_n = \\frac{F_n}{D_n} = \\frac{\\rho u \\Delta}{\\Gamma}$。\n\n面 $s$ (南)：从 $P$ 出发的外向法向量为 $\\mathbf{n}_s = (0, -1)$。\n对流通量为 $F_s = \\rho (\\mathbf{u} \\cdot \\mathbf{n}_s) A_s = \\rho ((u,u) \\cdot (0,-1)) \\Delta = -\\rho u \\Delta$。\n佩克莱数为 $Pe_s = \\frac{F_s}{D_s} = \\frac{-\\rho u \\Delta}{\\Gamma}$。\n\n对于一个具有外向法向量 $\\mathbf{n}_f$ 的面 $f$，其局部面佩克莱数的推导表达式为 $Pe_f = \\frac{\\rho (\\mathbf{u} \\cdot \\mathbf{n}_f) \\Delta}{\\Gamma}$。\n\n接下来，我们使用给定的参数值进行数值计算：$\\rho=1.0 \\text{ kg m}^{-3}$，$u=0.5 \\text{ m s}^{-1}$，$\\Gamma=0.01 \\text{ kg m}^{-1}\\text{s}^{-1}$ 和 $\\Delta=0.1 \\text{ m}$。\n佩克莱数的绝对值由以下项确定：\n$$\n\\frac{\\rho u \\Delta}{\\Gamma} = \\frac{1.0 \\times 0.5 \\times 0.1}{0.01} = \\frac{0.05}{0.01} = 5\n$$\n每个面上的佩克莱数分别为：\n$Pe_e = 5$\n$Pe_w = -5$\n$Pe_n = 5$\n$Pe_s = -5$\n\n现在，我们分析混合差分格式的切换决策。该格式在 $|Pe_f| \\le 2$ 时使用中心差分，在 $|Pe_f| > 2$ 时使用一阶迎风差分。\n对于所有面 $f \\in \\{e,w,n,s\\}$，我们有 $|Pe_f| = 5$。由于 $5 > 2$，混合格式对所有四个面都选择一阶迎风差分。\n\n对于使用迎风差分的面，供给节点是流体来源的节点。流动方向由对流通量 $F_f$ 的符号决定，由于 $D_f = \\Gamma > 0$，该符号与 $Pe_f$ 的符号相同。\n- 面 $e$：$Pe_e = 5 > 0$。流动方向与外向法向量 $\\mathbf{n}_e$ 的方向为正，意味着流体从 $P$ 流向 $E$ (流出)。供给节点是 $P$。\n- 面 $w$：$Pe_w = -5  0$。流动方向与外向法向量 $\\mathbf{n}_w$ 的方向为负，意味着流体方向与 $\\mathbf{n}_w$ 相反，即从 $W$ 流向 $P$ (流入)。供给节点是 $W$。\n- 面 $n$：$Pe_n = 5 > 0$。流动方向与外向法向量 $\\mathbf{n}_n$ 的方向为正，意味着流体从 $P$ 流向 $N$ (流出)。供给节点是 $P$。\n- 面 $s$：$Pe_s = -5  0$。流动方向与外向法向量 $\\mathbf{n}_s$ 的方向为负，意味着流体方向与 $\\mathbf{n}_s$ 相反，即从 $S$ 流向 $P$ (流入)。供给节点是 $S$。\n\n最后，我们计算总和 $S$：\n$$\nS \\equiv \\sum_{f \\in \\{e,w,n,s\\}} |Pe_f|\n$$\n代入计算出的值：\n$$\nS = |Pe_e| + |Pe_w| + |Pe_n| + |Pe_s| = |5| + |-5| + |5| + |-5| = 5 + 5 + 5 + 5 = 20\n$$\n问题要求将此值四舍五入到四位有效数字。作为一个整数，$20$ 可以写成 $20.00$ 来明确表示四位有效数字。\n$S = 20.00$。",
            "answer": "$$\\boxed{20.00}$$"
        },
        {
            "introduction": "在学会如何应用混合格式后，理解其必要性也同样重要。本练习 () 将揭示在对流主导的流动中，看似更精确的中心差分格式（CDS）的一个致命弱点：它无法保证解的物理有界性。通过这个反例，你将亲眼看到混合格式如何修正这一缺陷，从而确保数值解的稳定性和物理合理性。",
            "id": "3991588",
            "problem": "考虑一维稳态对流扩散问题，其中无量纲温度场为 $\\,\\phi(x)\\,$。该场存在于一个横截面积为 $\\,A=1\\,$、网格宽度为 $\\,\\Delta x = 1\\,$ 的均匀管道中，具有恒定的热扩散系数 $\\,\\Gamma = 1\\,$、恒定的密度 $\\,\\rho\\,$ 以及均匀的轴向速度 $\\,u0\\,$。西边界的边界值为 $\\,\\phi(0)=0\\,$，东边界的边界值为 $\\,\\phi(\\Delta x)=1\\,$。不存在体积源项。定义质量通量 $\\,F \\equiv \\rho u A\\,$ 和扩散传导系数 $\\,D \\equiv \\Gamma A/\\Delta x\\,$，因此网格佩克莱特数为 $\\mathrm{Pe} \\equiv F/D$。在此设定下，取 $\\,D=1\\,$ 和 $\\,F=3\\,$，因此 $\\,\\mathrm{Pe}=3$。\n\n使用有限体积法 (FVM)，对单个内部控制体上的稳态守恒定律 $\\,\\frac{d}{dx}\\left(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}\\right)=0\\,$ 进行积分，并将离散平衡写成规范形式 $\\,a_P \\phi_P = a_W \\phi_W + a_E \\phi_E\\,$。其中，$\\,\\phi_W=0\\,$ 和 $\\,\\phi_E=1\\,$ 分别是控制体西侧和东侧相邻节点的边界邻近节点值，$\\,\\phi_P\\,$ 是待求的内部节点值。\n\n(a) 通过推导中心差分格式 (CDS) 下的系数 $\\,a_W\\,$, $\\,a_E\\,$ 和 $\\,a_P\\,$，并计算 $\\,\\phi_P\\,$，为 $\\,\\mathrm{Pe}=3\\,$ 时的中心差分格式构造一个关于有界性的反例。\n\n(b) 通过将对流面值设为迎风值（即，对于正的 $\\,u\\,$，取 $\\,\\phi_e=\\phi_P\\,$ 和 $\\,\\phi_w=\\phi_W\\,$），推导相应的系数，并计算混合格式下的 $\\,\\phi_P\\,$，展示混合差分格式如何在 $\\,\\mathrm{Pe}=3\\,$ 时恢复有界性。\n\n将最终的数值对 $\\,\\left(\\phi_P^{\\mathrm{CDS}},\\,\\phi_P^{\\mathrm{hybrid}}\\right)\\,$ 以精确形式表示为行矩阵。无需四舍五入。答案是无量纲的。",
            "solution": "该问题要求使用有限体积法 (FVM) 求解一维稳态对流扩散问题中的内部节点值 $\\phi_P$，首先使用中心差分格式 (CDS)，然后使用混合差分格式。\n\n控制守恒定律如下所示：\n$$\n\\frac{d}{dx}\\left(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}\\right) = 0\n$$\n其中 $\\rho$ 是密度，$u$ 是速度，$\\phi$ 是无量纲温度，$\\Gamma$ 是热扩散系数。所有这些量均为常数，且速度 $u$ 为正。\n\n我们通过对以内部节点 P 为中心的单个控制体 (CV) 上的此方程进行积分来应用 FVM。该控制体从西侧面 'w' 延伸到东侧面 'e'。控制体的宽度为 $\\Delta x$。\n$$\n\\int_{w}^{e} \\frac{d}{dx}\\left(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}\\right) A \\, dx = 0\n$$\n其中 $A$ 是恒定的横截面积。积分结果为：\n$$\n\\left[ \\left(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}\\right)A \\right]_{w}^{e} = 0\n$$\n这可以写成各面上总通量的平衡：\n$$\n\\left( (\\rho u A) \\phi_e - \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_e \\right) - \\left( (\\rho u A) \\phi_w - \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_w \\right) = 0\n$$\n使用所提供的质量通量 $F \\equiv \\rho u A$ 和扩散传导系数 $D \\equiv \\Gamma A/\\Delta x$ 的定义，方程变为：\n$$\n\\left( F \\phi_e - D \\Delta x \\left(\\frac{d\\phi}{dx}\\right)_e \\right) - \\left( F \\phi_w - D \\Delta x \\left(\\frac{d\\phi}{dx}\\right)_w \\right) = 0\n$$\n扩散项使用相邻节点 W 和 E 的节点值来近似。节点之间的距离是均匀的，等于控制体宽度 $\\Delta x$。\n东侧面 'e'（位于 P 和 E 中间）的梯度近似为：\n$$\n\\left(\\frac{d\\phi}{dx}\\right)_e \\approx \\frac{\\phi_E - \\phi_P}{\\Delta x}\n$$\n西侧面 'w'（位于 W 和 P 中间）的梯度近似为：\n$$\n\\left(\\frac{d\\phi}{dx}\\right)_w \\approx \\frac{\\phi_P - \\phi_W}{\\Delta x}\n$$\n将这些近似值代入通量平衡方程，得到：\n$$\n\\left( F \\phi_e - D (\\phi_E - \\phi_P) \\right) - \\left( F \\phi_w - D (\\phi_P - \\phi_W) \\right) = 0\n$$\n该方程可以重新整理，将对流项和扩散项分组：\n$$\nF(\\phi_e - \\phi_w) + D(\\phi_P - \\phi_W) - D(\\phi_E - \\phi_P) = 0\n$$\n这是一般的离散化方程。其具体形式取决于面值 $\\phi_e$ 和 $\\phi_w$ 的近似方式。问题设定为 $A=1$, $\\Delta x=1$, $\\Gamma=1$，这给出 $D = \\frac{\\Gamma A}{\\Delta x} = \\frac{1 \\cdot 1}{1} = 1$。给定的质量通量为 $F=3$。网格佩克莱特数为 $\\mathrm{Pe} \\equiv F/D = 3/1 = 3$。节点边界值为 $\\phi_W=0$ 和 $\\phi_E=1$。\n\n(a) 中心差分格式 (CDS)\n\n对于 CDS，控制体面上的 $\\phi$ 值取自两个包围节点的线性插值：\n$$\n\\phi_e = \\frac{\\phi_P + \\phi_E}{2} \\quad \\text{和} \\quad \\phi_w = \\frac{\\phi_W + \\phi_P}{2}\n$$\n将这些代入一般的离散化方程：\n$$\nF\\left(\\frac{\\phi_P + \\phi_E}{2} - \\frac{\\phi_W + \\phi_P}{2}\\right) + D(\\phi_P - \\phi_W) - D(\\phi_E - \\phi_P) = 0\n$$\n$$\nF\\left(\\frac{\\phi_E - \\phi_W}{2}\\right) + 2D\\phi_P - D\\phi_W - D\\phi_E = 0\n$$\n为了将其写成规范形式 $a_P \\phi_P = a_W \\phi_W + a_E \\phi_E$，我们重新整理各项：\n$$\n(2D)\\phi_P = (D\\phi_W + D\\phi_E) - F\\left(\\frac{\\phi_E - \\phi_W}{2}\\right)\n$$\n$$\n(2D)\\phi_P = \\left(D + \\frac{F}{2}\\right)\\phi_W + \\left(D - \\frac{F}{2}\\right)\\phi_E\n$$\n与 $a_P \\phi_P = a_W \\phi_W + a_E \\phi_E$ 比较，系数为：\n$$\na_W = D + \\frac{F}{2}\n$$\n$$\na_E = D - \\frac{F}{2}\n$$\n$$\na_P = a_W + a_E = 2D\n$$\n使用给定值 $D=1$ 和 $F=3$：\n$$\na_W = 1 + \\frac{3}{2} = 2.5\n$$\n$$\na_E = 1 - \\frac{3}{2} = -0.5\n$$\n$$\na_P = 2(1) = 2\n$$\n离散化方程为 $2\\phi_P = 2.5\\phi_W - 0.5\\phi_E$。\n代入边界值 $\\phi_W=0$ 和 $\\phi_E=1$：\n$$\n2\\phi_P = 2.5(0) - 0.5(1) = -0.5\n$$\n$$\n\\phi_P^{\\mathrm{CDS}} = -\\frac{0.5}{2} = -0.25\n$$\n边界值在 $[0, 1]$ 范围内，但计算出的内部值 $\\phi_P^{\\mathrm{CDS}} = -0.25$ 落在了该范围之外。这个不符合物理规律的结果是违反有界性原则的一个反例。其原因是系数 $a_E = -0.5$ 为负，这是因为佩克莱特数 $\\mathrm{Pe} = 3$ 大于 2。\n\n(b) 混合差分格式\n\n混合格式在 $|\\mathrm{Pe}| \\le 2$ 时使用 CDS，在 $|\\mathrm{Pe}| > 2$ 时使用一阶迎风格式。由于 $\\mathrm{Pe}=3$，因此使用迎风格式。对于正速度 ($u>0$)，流动方向是从左到右（从 W 到 E）。迎风格式在单元面上的对流值取自上游节点：\n$$\n\\phi_e = \\phi_P \\quad \\text{和} \\quad \\phi_w = \\phi_W\n$$\n将这些代入一般的离散化方程：\n$$\nF(\\phi_P - \\phi_W) + D(\\phi_P - \\phi_W) - D(\\phi_E - \\phi_P) = 0\n$$\n整理成规范形式 $a_P \\phi_P = a_W \\phi_W + a_E \\phi_E$：\n$$\n(F+D+D)\\phi_P = (F+D)\\phi_W + D\\phi_E\n$$\n系数为：\n$$\na_W = F+D\n$$\n$$\na_E = D\n$$\n$$\na_P = F+2D\n$$\n使用给定值 $D=1$ 和 $F=3$：\n$$\na_W = 3 + 1 = 4\n$$\n$$\na_E = 1\n$$\n$$\na_P = 3 + 2(1) = 5\n$$\n请注意，所有系数均为正，这是有界性的一个充分条件。离散化方程为 $5\\phi_P = 4\\phi_W + 1\\phi_E$。\n代入边界值 $\\phi_W=0$ 和 $\\phi_E=1$：\n$$\n5\\phi_P = 4(0) + 1(1) = 1\n$$\n$$\n\\phi_P^{\\mathrm{hybrid}} = \\frac{1}{5} = 0.2\n$$\n该值位于边界条件范围 $[0, 1]$ 内，这表明混合（迎风）格式在这种高佩克莱特数流动中恢复了有界性。\n\n最终的数值对为 $(\\phi_P^{\\mathrm{CDS}}, \\phi_P^{\\mathrm{hybrid}}) = (-0.25, 0.2)$，其精确分数形式为 $(-\\frac{1}{4}, \\frac{1}{5})$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{4}  \\frac{1}{5} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然混合格式能确保稳定性，但其使用的一阶迎风格式会引入数值误差，通常称为数值扩散。这个高级练习 () 允许我们对这种误差进行精确的定量分析，方法是将混合格式的近似值与一维问题的精确解析解进行比较。通过推导混合格式与理想的“指数格式”之间的差异，你将对该格式的精度及其在不同佩克莱数范围内的行为有更深刻的理解。",
            "id": "3991591",
            "problem": "一维稳态对流扩散问题，研究的是被动标量$\\,\\phi(x)\\,$在一个长度为$\\,L\\,$的通道中的输运。通道内流体密度$\\,\\rho0\\,$、速度$\\,u0\\,$和扩散系数$\\,\\Gamma0\\,$均为常数。边界条件为狄利克雷（Dirichlet）条件：$\\,\\phi(0)=\\phi_{L}\\,$和$\\,\\phi(L)=\\phi_{R}\\,$。其控制方程源于$\\,\\phi\\,$的稳态守恒和菲克（Fickian）扩散定律：\n$$\n\\frac{d}{dx}\\left(-\\Gamma\\,\\frac{d\\phi}{dx}+\\rho\\,u\\,\\phi\\right)=0,\n$$\n该方程可简化为一个常系数常微分方程。\n\n第一部分：从上述守恒声明和菲克定律出发，推导在$\\,x \\in [0,L]\\,$区间上的闭式精确解$\\,\\phi(x)\\,$，解应以边界值$\\,\\phi_{L}\\,$和$\\,\\phi_{R}\\,$、$\\rho$、$u$、$\\Gamma$和$L$表示。请指出在解中自然出现的区域佩克莱数（Péclet number）$\\,\\mathrm{Pe}:=\\rho\\,u\\,L/\\Gamma\\,$。\n\n第二部分：考虑一个均匀的有限体积法（FVM）离散化，其中节点$\\,P\\,$和$\\,E\\,$分别位于$\\,x_{P}\\,$和$\\,x_{E}=x_{P}+\\Delta x\\,$处，东侧网格面位于$\\,x_{f}=x_{P}+\\Delta x/2\\,$处。将第一部分得到的精确解限制在子区间$[x_{P},x_{E}]$上，其局部边界数据为$\\,\\phi(x_{P})=\\phi_{P}\\,$和$\\,\\phi(x_{E})=\\phi_{E}\\,$。利用此受限的精确解，推导东侧网格面上的指数格式（exponential-scheme）插值，其形式为线性混合形式\n$$\n\\phi_{f}^{\\mathrm{exp}} \\;=\\; \\phi_{P} \\;+\\; w_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta})\\,\\bigl(\\phi_{E}-\\phi_{P}\\bigr),\n$$\n并求出闭式权重$\\,w_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta})\\,$，权重应以网格佩克莱数$\\,\\mathrm{Pe}_{\\Delta}:=\\rho\\,u\\,\\Delta x/\\Gamma\\,$表示。\n\n第三部分：在混合差分格式（Hybrid Differencing Scheme, HDS）中，为了保持解的有界性，网格面值$\\,\\phi_{f}^{\\mathrm{HDS}}\\,$在扩散主导的网格中选择中心差分格式，在对流主导的网格中选择迎风差分格式。对于$\\,u0\\,$的情况，请根据$\\,|\\mathrm{Pe}_{\\Delta}|\\,$的标准HDS切换准则，将$\\,\\phi_{f}^{\\mathrm{HDS}}\\,$写成以$\\,\\phi_{P}\\,$、$\\,\\phi_{E}\\,$和$\\,\\mathrm{Pe}_{\\Delta}\\,$表示的函数。\n\n第四部分：利用第二部分和第三部分的结果，推导东侧网格面上差值\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) \\;:=\\; \\phi_{f}^{\\mathrm{exp}} \\;-\\; \\phi_{f}^{\\mathrm{HDS}}\n$$\n的单一闭式解析表达式，该表达式仅用$\\,\\phi_{P}\\,$、$\\,\\phi_{E}\\,$和$\\,\\mathrm{Pe}_{\\Delta}\\,$表示。最终答案必须是单一的闭式解析表达式。无需进行数值计算，最终答案中不包含单位。",
            "solution": "### 第一部分：精确解的推导\n\n一维稳态对流扩散的控制方程如下：\n$$\n\\frac{d}{dx}\\left(-\\Gamma\\,\\frac{d\\phi}{dx}+\\rho\\,u\\,\\phi\\right)=0\n$$\n由于$\\rho$、$u$和$\\Gamma$是常数，我们将方程对$x$积分一次，得到：\n$$\n-\\Gamma\\,\\frac{d\\phi}{dx}+\\rho\\,u\\,\\phi = C_1\n$$\n其中$C_1$是一个积分常数。这是一个一阶线性常微分方程（ODE），可以改写为：\n$$\n\\frac{d\\phi}{dx} - \\frac{\\rho u}{\\Gamma}\\phi = -\\frac{C_1}{\\Gamma}\n$$\n该常微分方程的通解是齐次解（$\\phi_h$）和特解（$\\phi_p$）之和。齐次方程为$\\frac{d\\phi_h}{dx} - \\frac{\\rho u}{\\Gamma}\\phi_h = 0$，其解为$\\phi_h(x) = A \\exp\\left(\\frac{\\rho u}{\\Gamma}x\\right)$。对于特解，我们可以假设一个常数解$\\phi_p(x)=B$，代入后得到$B=\\frac{C_1}{\\rho u}$。\n因此，通解为：\n$$\n\\phi(x) = A \\exp\\left(\\frac{\\rho u}{\\Gamma}x\\right) + B'\n$$\n其中$A$和$B'$是新的常数。现在我们应用边界条件$\\phi(0)=\\phi_L$和$\\phi(L)=\\phi_R$来确定$A$和$B'$。\n\n在$x=0$处：\n$$\n\\phi(0) = \\phi_L = A + B'\n$$\n在$x=L$处：\n$$\n\\phi(L) = \\phi_R = A \\exp\\left(\\frac{\\rho u L}{\\Gamma}\\right) + B'\n$$\n指数中的项是区域佩克莱数，$\\mathrm{Pe} = \\frac{\\rho u L}{\\Gamma}$。第二个方程变为$\\phi_R = A \\exp(\\mathrm{Pe}) + B'$。\n\n我们求解关于$A$和$B'$的线性方程组：\n由第一个方程可知，$B' = \\phi_L - A$。代入第二个方程：\n$$\n\\phi_R = A \\exp(\\mathrm{Pe}) + (\\phi_L - A) = A(\\exp(\\mathrm{Pe})-1) + \\phi_L\n$$\n解出$A$：\n$$\nA = \\frac{\\phi_R - \\phi_L}{\\exp(\\mathrm{Pe})-1}\n$$\n将$A$和$B'$代回通解，通过将$\\phi(x)$与边界值关联，可以得到一个更方便的形式：\n$$\n\\phi(x) - \\phi_L = A\\left(\\exp\\left(\\frac{\\rho u}{\\Gamma}x\\right) - 1\\right)\n$$\n代入$A$的表达式，并注意到$\\frac{\\rho u x}{\\Gamma} = \\frac{\\rho u L}{\\Gamma} \\frac{x}{L} = \\mathrm{Pe}\\frac{x}{L}$：\n$$\n\\phi(x) = \\phi_L + (\\phi_R - \\phi_L)\\frac{\\exp\\left(\\mathrm{Pe}\\frac{x}{L}\\right) - 1}{\\exp(\\mathrm{Pe}) - 1}\n$$\n区域佩克莱数$\\mathrm{Pe}=\\rho\\,u\\,L/\\Gamma$自然地出现在此精确解中，它表征了在整个区域长度$L$上对流输运与扩散输运的比率。\n\n### 第二部分：指数格式网格面值的推导\n\n我们将第一部分推导出的精确解应用于长度为$\\Delta x = x_E - x_P$的子区间$[x_P, x_E]$。局部边界条件为$\\phi(x_P)=\\phi_P$和$\\phi(x_E)=\\phi_E$。\n我们可以使用一个局部坐标系$x' = x - x_P$，其中$x' \\in [0, \\Delta x]$。该问题等价于第一部分中的问题，只需将$L \\rightarrow \\Delta x$，$x \\rightarrow x'$，$\\phi_L \\rightarrow \\phi_P$以及$\\phi_R \\rightarrow \\phi_E$。相关的佩克莱数现在是网格佩克莱数$\\mathrm{Pe}_{\\Delta} = \\frac{\\rho u \\Delta x}{\\Gamma}$。\n\n在这个子区间上的精确解是：\n$$\n\\phi(x') = \\phi_P + (\\phi_E - \\phi_P)\\frac{\\exp\\left(\\mathrm{Pe}_{\\Delta}\\frac{x'}{\\Delta x}\\right) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\n$$\n我们需要在位于$x_f = x_P + \\Delta x/2$的网格面$f$处计算该解。在局部坐标系中，这对应于$x' = \\Delta x/2$。\n$$\n\\phi_f^{\\mathrm{exp}} = \\phi(\\Delta x/2) = \\phi_P + (\\phi_E - \\phi_P)\\frac{\\exp\\left(\\mathrm{Pe}_{\\Delta}\\frac{\\Delta x/2}{\\Delta x}\\right) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\n$$\n$$\n\\phi_f^{\\mathrm{exp}} = \\phi_P + (\\phi_E - \\phi_P)\\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\n$$\n该表达式符合所要求的线性混合形式$\\phi_f^{\\mathrm{exp}} = \\phi_P + w_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta})(\\phi_E - \\phi_P)$。通过比较，权重$w_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta})$为：\n$$\nw_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta}) = \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\n$$\n\n### 第三部分：混合差分格式（HDS）网格面值\n\n混合差分格式（HDS）根据网格佩克莱数的大小$|\\mathrm{Pe}_{\\Delta}|$，在中心差分格式（CDS）和迎风差分格式（UDS）之间自适应选择。标准的切换准则为：\n- 如果$|\\mathrm{Pe}_{\\Delta}| \\le 2$，使用CDS。\n- 如果$|\\mathrm{Pe}_{\\Delta}| > 2$，使用UDS。\n\n对于CDS，网格面值是相邻节点值的线性插值：\n$$\n\\phi_f^{\\mathrm{CDS}} = \\frac{\\phi_P + \\phi_E}{2}\n$$\n对于UDS，网格面值取自上游（迎风）节点。由于问题指定$u  0$，流动方向是从左到右（从P到E），因此东侧网格面$f$的迎风节点是$P$：\n$$\n\\phi_f^{\\mathrm{UDS}} = \\phi_P\n$$\n由于$u0$且其他参数均为正，$\\mathrm{Pe}_{\\Delta} = \\frac{\\rho u \\Delta x}{\\Gamma}  0$。因此，$|\\mathrm{Pe}_{\\Delta}| = \\mathrm{Pe}_{\\Delta}$。此情况下HDS的公式为：\n$$\n\\phi_f^{\\mathrm{HDS}} = \\begin{cases} \\phi_f^{\\mathrm{CDS}} = \\frac{\\phi_P + \\phi_E}{2}  \\text{if } 0 \\le \\mathrm{Pe}_{\\Delta} \\le 2 \\\\ \\phi_f^{\\mathrm{UDS}} = \\phi_P  \\text{if } \\mathrm{Pe}_{\\Delta} > 2 \\end{cases}\n$$\n\n### 第四部分：差值$\\Delta(\\mathrm{Pe}_{\\Delta})$的推导\n\n我们现在推导差值$\\Delta(\\mathrm{Pe}_{\\Delta}) = \\phi_f^{\\mathrm{exp}} - \\phi_f^{\\mathrm{HDS}}$。由于HDS的定义，该差值将是一个分段函数。\n\n**情况1：$0 \\le \\mathrm{Pe}_{\\Delta} \\le 2$**\n在此范围内，HDS使用中心差分。\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = \\phi_f^{\\mathrm{exp}} - \\phi_f^{\\mathrm{CDS}}\n$$\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = \\left(\\phi_P + (\\phi_E - \\phi_P)\\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\\right) - \\left(\\frac{\\phi_P + \\phi_E}{2}\\right)\n$$\n为简化起见，我们将$\\frac{\\phi_P + \\phi_E}{2}$写为$\\phi_P + \\frac{1}{2}(\\phi_E - \\phi_P)$。\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = (\\phi_E - \\phi_P) \\left( \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1} - \\frac{1}{2} \\right)\n$$\n\n**情况2：$\\mathrm{Pe}_{\\Delta} > 2$**\n在此范围内，HDS使用迎风差分。\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = \\phi_f^{\\mathrm{exp}} - \\phi_f^{\\mathrm{UDS}}\n$$\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = \\left(\\phi_P + (\\phi_E - \\phi_P)\\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\\right) - \\phi_P\n$$\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = (\\phi_E - \\phi_P) \\left( \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1} \\right)\n$$\n\n结合这两种情况，我们得到该差值的单一闭式解析表达式，写成分段形式：\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = (\\phi_E - \\phi_P) \\begin{cases} \\left( \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1} - \\frac{1}{2} \\right)  \\text{if } 0 \\le \\mathrm{Pe}_{\\Delta} \\le 2 \\\\ \\left( \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1} \\right)  \\text{if } \\mathrm{Pe}_{\\Delta} > 2 \\end{cases}\n$$\n该表达式量化了混合差分格式相对于局部精确的指数格式所引入的误差，即数值扩散。",
            "answer": "$$\n\\boxed{\n\\Delta(\\mathrm{Pe}_{\\Delta}) = (\\phi_E - \\phi_P) \\begin{cases} \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1} - \\frac{1}{2}  \\text{if } 0 \\le \\mathrm{Pe}_{\\Delta} \\le 2 \\\\ \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}  \\text{if } \\mathrm{Pe}_{\\Delta} > 2 \\end{cases}\n}\n$$"
        }
    ]
}