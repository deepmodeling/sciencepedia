{
    "hands_on_practices": [
        {
            "introduction": "To effectively apply the hybrid differencing scheme, one must first master the calculation of the local face Péclet number, $Pe_f$. This dimensionless group quantifies the local balance between convective and diffusive transport, serving as the critical parameter for the scheme's switching logic. This first exercise  provides fundamental practice in deriving and calculating $Pe_f$ on each face of a two-dimensional control volume, allowing you to directly apply the hybrid scheme's decision-making criterion in a practical setting.",
            "id": "3991580",
            "problem": "A two-dimensional, steady convection–diffusion of a passive scalar $\\phi$ is solved on a uniform Cartesian grid using the Finite Volume Method (FVM). The density is constant and equal to $\\rho$, the velocity field is uniform and given by $\\mathbf{u}=(u,u)$, and the effective diffusivity is constant and equal to $\\Gamma$. The grid is uniform with square control volumes of side length $\\Delta$, and unit depth in the out-of-plane direction.\n\nConsider an interior control volume centered at node $P$, with neighboring cell centers $E$, $W$, $N$, and $S$, and the corresponding faces $e$, $w$, $n$, and $s$. Starting from the steady conservation statement for $\\phi$ and the definitions of convective mass flux and diffusive conductance at a face, derive an expression for the local face Peclet number $Pe_f$ at each face $f \\in \\{e,w,n,s\\}$ in terms of $\\rho$, $u$, $\\Gamma$, and $\\Delta$. Evaluate $Pe_f$ numerically on each face for the parameter values $\\rho=1.0$ kg m$^{-3}$, $u=0.5$ m s$^{-1}$, $\\Gamma=0.01$ kg m$^{-1}$ s$^{-1}$, and $\\Delta=0.1$ m.\n\nThen, using the hybrid differencing scheme for convection–diffusion (which uses central differencing when $|Pe_f|\\leq 2$ and switches to first-order upwind differencing when $|Pe_f|2$), analyze the directional switching decision at each face for the given parameters. For faces where the scheme selects upwind differencing, identify the donor node relative to $P$.\n\nFinally, define\n$$\nS \\equiv \\sum_{f \\in \\{e,w,n,s\\}} |Pe_f|\n$$\nand report $S$ as a pure number (dimensionless), rounded to four significant figures.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. It presents a standard exercise in the field of computational fluid dynamics, specifically concerning the Finite Volume Method (FVM) and numerical differencing schemes.\n\nThe steady-state conservation equation for a passive scalar $\\phi$ in integral form over a control volume $CV$ is:\n$$\n\\oint_{\\partial CV} \\rho \\mathbf{u} \\phi \\cdot d\\mathbf{A} = \\oint_{\\partial CV} \\Gamma \\nabla \\phi \\cdot d\\mathbf{A}\n$$\nThis equation balances the net convective flux out of the control volume with the net diffusive flux into the control volume. Applying the Finite Volume Method, this integral equation is discretized into an algebraic equation by summing the fluxes over the faces of the control volume centered at node $P$. The faces are denoted $e$ (east), $w$ (west), $n$ (north), and $s$ (south). The balance becomes:\n$$\n\\sum_{f \\in \\{e,w,n,s\\}} (\\text{Convective Flux})_f = \\sum_{f \\in \\{e,w,n,s\\}} (\\text{Diffusive Flux})_f\n$$\nThe convective flux of $\\phi$ through a face $f$ is given by $F_f \\phi_f$, where $F_f$ is the convective mass flux, and the diffusive flux is given by $D_f (\\phi_{neighbor} - \\phi_P)$ where $D_f$ is the diffusive conductance. The local face Peclet number, $Pe_f$, is defined as the ratio of the strength of convection to the strength of diffusion at that face:\n$$\nPe_f = \\frac{F_f}{D_f}\n$$\nThe convective mass flux $F_f$ is defined as the mass flow rate across the face, given by $F_f = (\\rho \\mathbf{u} \\cdot \\mathbf{A})_f = \\rho (\\mathbf{u} \\cdot \\mathbf{n}_f) A_f$, where $\\mathbf{n}_f$ is the outward unit normal vector of face $f$ and $A_f$ is the face area. The diffusive conductance $D_f$ is defined as $D_f = \\frac{\\Gamma_f A_f}{\\delta_f}$, where $\\delta_f$ is the distance between the cell centers adjacent to face $f$.\n\nFor the given problem, the grid is uniform with square control volumes of side length $\\Delta$. The depth is unity, so the area of each face is $A_f = \\Delta \\times 1 = \\Delta$. The distance between adjacent cell centers is also $\\Delta$. The diffusivity $\\Gamma$ is constant. Thus, the diffusive conductance at any face $f$ is:\n$$\nD_f = \\frac{\\Gamma A_f}{\\Delta} = \\frac{\\Gamma \\Delta}{\\Delta} = \\Gamma\n$$\nThe velocity field is uniform and given by $\\mathbf{u}=(u,u)$. We can now calculate the convective flux $F_f$ and the Peclet number $Pe_f$ for each face.\n\nFace $e$ (east): The outward normal vector from $P$ is $\\mathbf{n}_e = (1, 0)$.\nThe convective flux is $F_e = \\rho (\\mathbf{u} \\cdot \\mathbf{n}_e) A_e = \\rho ((u,u) \\cdot (1,0)) \\Delta = \\rho u \\Delta$.\nThe Peclet number is $Pe_e = \\frac{F_e}{D_e} = \\frac{\\rho u \\Delta}{\\Gamma}$.\n\nFace $w$ (west): The outward normal vector from $P$ is $\\mathbf{n}_w = (-1, 0)$.\nThe convective flux is $F_w = \\rho (\\mathbf{u} \\cdot \\mathbf{n}_w) A_w = \\rho ((u,u) \\cdot (-1,0)) \\Delta = -\\rho u \\Delta$.\nThe Peclet number is $Pe_w = \\frac{F_w}{D_w} = \\frac{-\\rho u \\Delta}{\\Gamma}$.\n\nFace $n$ (north): The outward normal vector from $P$ is $\\mathbf{n}_n = (0, 1)$.\nThe convective flux is $F_n = \\rho (\\mathbf{u} \\cdot \\mathbf{n}_n) A_n = \\rho ((u,u) \\cdot (0,1)) \\Delta = \\rho u \\Delta$.\nThe Peclet number is $Pe_n = \\frac{F_n}{D_n} = \\frac{\\rho u \\Delta}{\\Gamma}$.\n\nFace $s$ (south): The outward normal vector from $P$ is $\\mathbf{n}_s = (0, -1)$.\nThe convective flux is $F_s = \\rho (\\mathbf{u} \\cdot \\mathbf{n}_s) A_s = \\rho ((u,u) \\cdot (0,-1)) \\Delta = -\\rho u \\Delta$.\nThe Peclet number is $Pe_s = \\frac{F_s}{D_s} = \\frac{-\\rho u \\Delta}{\\Gamma}$.\n\nThe derived expression for the local face Peclet number at a face $f$ with outward normal $\\mathbf{n}_f$ is $Pe_f = \\frac{\\rho (\\mathbf{u} \\cdot \\mathbf{n}_f) \\Delta}{\\Gamma}$.\n\nNext, we evaluate these expressions numerically using the given parameter values: $\\rho=1.0 \\text{ kg m}^{-3}$, $u=0.5 \\text{ m s}^{-1}$, $\\Gamma=0.01 \\text{ kg m}^{-1} \\text{ s}^{-1}$, and $\\Delta=0.1 \\text{ m}$.\nThe magnitude of the Peclet number is determined by the term:\n$$\n\\frac{\\rho u \\Delta}{\\Gamma} = \\frac{1.0 \\times 0.5 \\times 0.1}{0.01} = \\frac{0.05}{0.01} = 5\n$$\nThe Peclet numbers for each face are:\n$Pe_e = 5$\n$Pe_w = -5$\n$Pe_n = 5$\n$Pe_s = -5$\n\nNow, we analyze the switching decision of the hybrid differencing scheme. The scheme uses central differencing when $|Pe_f| \\le 2$ and first-order upwind differencing when $|Pe_f|  2$.\nFor all faces $f \\in \\{e,w,n,s\\}$, we have $|Pe_f| = 5$. Since $5  2$, the hybrid scheme selects first-order upwind differencing for all four faces.\n\nFor the faces using upwind differencing, the donor node is the node from which the flow is coming. The direction of flow is determined by the sign of the convective flux $F_f$, which is the same as the sign of $Pe_f$ since $D_f = \\Gamma  0$.\n- Face $e$: $Pe_e = 5  0$. The flow is positive in the direction of the outward normal $\\mathbf{n}_e$, meaning flow is from $P$ to $E$ (outflow). The donor node is $P$.\n- Face $w$: $Pe_w = -5  0$. The flow is negative in the direction of the outward normal $\\mathbf{n}_w$, meaning flow is opposite to $\\mathbf{n}_w$, i.e., from $W$ to $P$ (inflow). The donor node is $W$.\n- Face $n$: $Pe_n = 5  0$. The flow is positive in the direction of the outward normal $\\mathbf{n}_n$, meaning flow is from $P$ to $N$ (outflow). The donor node is $P$.\n- Face $s$: $Pe_s = -5  0$. The flow is negative in the direction of the outward normal $\\mathbf{n}_s$, meaning flow is opposite to $\\mathbf{n}_s$, i.e., from $S$ to $P$ (inflow). The donor node is $S$.\n\nFinally, we calculate the sum $S$:\n$$\nS \\equiv \\sum_{f \\in \\{e,w,n,s\\}} |Pe_f|\n$$\nSubstituting the calculated values:\n$$\nS = |Pe_e| + |Pe_w| + |Pe_n| + |Pe_s| = |5| + |-5| + |5| + |-5| = 5 + 5 + 5 + 5 = 20\n$$\nThe problem requires this value to be rounded to four significant figures. As an integer, $20$ can be written as $20.00$ to explicitly show four significant figures.\n$S = 20.00$.",
            "answer": "$$\\boxed{20.00}$$"
        },
        {
            "introduction": "The motivation for the hybrid scheme lies in a fundamental compromise between accuracy and numerical stability. While the Central Differencing Scheme (CDS) is second-order accurate, it can produce unphysical, unbounded solutions in convection-dominated flows. This practice  guides you through constructing a compelling one-dimensional counterexample where CDS fails, and then demonstrates precisely how the hybrid scheme's switch to first-order upwinding restores boundedness, ensuring a physically plausible result.",
            "id": "3991588",
            "problem": "Consider one-dimensional, steady convection–diffusion of a nondimensional temperature field $\\,\\phi(x)\\,$ in a uniform duct of cross-section $\\,A=1\\,$ and cell width $\\,\\Delta x = 1\\,$, with constant thermal diffusivity $\\,\\Gamma = 1\\,$, constant density $\\,\\rho\\,$, and uniform axial velocity $\\,u0\\,$. The boundary values are $\\,\\phi(0)=0\\,$ at the west boundary and $\\,\\phi(\\Delta x)=1\\,$ at the east boundary. There is no volumetric source term. Define the mass flux $\\,F \\equiv \\rho u A\\,$ and the diffusive conductance $\\,D \\equiv \\Gamma A/\\Delta x\\,$, so that the cell Peclet number is $\\mathrm{Pe} \\equiv F/D$. In this setting, take $\\,D=1\\,$ and $\\,F=3\\,$ so that $\\,\\mathrm{Pe}=3$.\n\nUsing the Finite Volume Method (FVM), integrate the steady conservation law $\\,\\frac{d}{dx}\\!\\left(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}\\right)=0\\,$ over the single interior control volume and write the discrete balance in the canonical form $\\,a_P \\phi_P = a_W \\phi_W + a_E \\phi_E\\,$, where $\\,\\phi_W=0\\,$ and $\\,\\phi_E=1\\,$ are the boundary-adjacent nodal values at the west and east neighbors of the control volume, respectively, and $\\,\\phi_P\\,$ is the interior nodal value to be determined.\n\n(a) Construct a counterexample to boundedness for the Central Differencing Scheme (CDS) at $\\,\\mathrm{Pe}=3\\,$ by deriving the coefficients $\\,a_W\\,$, $\\,a_E\\,$, and $\\,a_P\\,$ under CDS and evaluating $\\,\\phi_P$.\n\n(b) Show how the hybrid differencing scheme restores boundedness at $\\,\\mathrm{Pe}=3\\,$ by setting the convective face values to upwind (i.e., for positive $\\,u\\,$, take $\\,\\phi_e=\\phi_P\\,$ and $\\,\\phi_w=\\phi_W\\,$), derive the corresponding coefficients, and evaluate $\\,\\phi_P\\,$ under the hybrid scheme.\n\nExpress the final pair $\\,\\left(\\phi_P^{\\mathrm{CDS}},\\,\\phi_P^{\\mathrm{hybrid}}\\right)\\,$ as a row matrix in exact form. No rounding is required. The answer is nondimensional.",
            "solution": "The problem requires the determination of an interior nodal value $\\phi_P$ for a one-dimensional steady convection-diffusion problem using the Finite Volume Method (FVM), first with the Central Differencing Scheme (CDS) and then with the hybrid differencing scheme.\n\nThe governing conservation law is given as:\n$$\n\\frac{d}{dx}\\!\\left(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}\\right) = 0\n$$\nwhere $\\rho$ is the density, $u$ is the velocity, $\\phi$ is the non-dimensional temperature, and $\\Gamma$ is the thermal diffusivity. All these are constant, and the velocity $u$ is positive.\n\nWe apply the FVM by integrating this equation over a single control volume (CV) centered around the interior node P. The CV extends from a west face 'w' to an east face 'e'. The width of the CV is $\\Delta x$.\n$$\n\\int_{w}^{e} \\frac{d}{dx}\\!\\left(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}\\right) A \\, dx = 0\n$$\nwhere $A$ is the constant cross-sectional area. The integral evaluates to:\n$$\n\\left[ \\left(\\rho u \\phi - \\Gamma \\frac{d\\phi}{dx}\\right)A \\right]_{w}^{e} = 0\n$$\nThis can be written as the balance of total fluxes at the faces:\n$$\n\\left( (\\rho u A) \\phi_e - \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_e \\right) - \\left( (\\rho u A) \\phi_w - \\left(\\Gamma A \\frac{d\\phi}{dx}\\right)_w \\right) = 0\n$$\nUsing the provided definitions for mass flux, $F \\equiv \\rho u A$, and diffusive conductance, $D \\equiv \\Gamma A/\\Delta x$, the equation becomes:\n$$\n\\left( F \\phi_e - D \\Delta x \\left(\\frac{d\\phi}{dx}\\right)_e \\right) - \\left( F \\phi_w - D \\Delta x \\left(\\frac{d\\phi}{dx}\\right)_w \\right) = 0\n$$\nThe diffusive terms are approximated using the nodal values of the neighboring nodes, W and E. The distance between nodes is uniform and equal to the CV width, $\\Delta x$.\nThe gradient at the east face 'e' (midway between P and E) is approximated as:\n$$\n\\left(\\frac{d\\phi}{dx}\\right)_e \\approx \\frac{\\phi_E - \\phi_P}{\\Delta x}\n$$\nThe gradient at the west face 'w' (midway between W and P) is approximated as:\n$$\n\\left(\\frac{d\\phi}{dx}\\right)_w \\approx \\frac{\\phi_P - \\phi_W}{\\Delta x}\n$$\nSubstituting these approximations into the flux balance equation yields:\n$$\n\\left( F \\phi_e - D (\\phi_E - \\phi_P) \\right) - \\left( F \\phi_w - D (\\phi_P - \\phi_W) \\right) = 0\n$$\nThis equation can be rearranged to group convection and diffusion terms:\n$$\nF(\\phi_e - \\phi_w) + D(\\phi_P - \\phi_W) - D(\\phi_E - \\phi_P) = 0\n$$\nThis is the general discretized equation. The specific form depends on how the face values $\\phi_e$ and $\\phi_w$ are approximated. The problem is set up with $A=1$, $\\Delta x=1$, $\\Gamma=1$, which gives $D = \\frac{\\Gamma A}{\\Delta x} = \\frac{1 \\cdot 1}{1} = 1$. The mass flux is given as $F=3$. The cell Peclet number is $\\mathrm{Pe} \\equiv F/D = 3/1 = 3$. The nodal boundary values are $\\phi_W=0$ and $\\phi_E=1$.\n\n(a) Central Differencing Scheme (CDS)\n\nFor CDS, the value of $\\phi$ at a CV face is taken as the linear interpolation of the values at the two bracketing nodes:\n$$\n\\phi_e = \\frac{\\phi_P + \\phi_E}{2} \\quad \\text{and} \\quad \\phi_w = \\frac{\\phi_W + \\phi_P}{2}\n$$\nSubstituting these into the general discretized equation:\n$$\nF\\left(\\frac{\\phi_P + \\phi_E}{2} - \\frac{\\phi_W + \\phi_P}{2}\\right) + D(\\phi_P - \\phi_W) - D(\\phi_E - \\phi_P) = 0\n$$\n$$\nF\\left(\\frac{\\phi_E - \\phi_W}{2}\\right) + 2D\\phi_P - D\\phi_W - D\\phi_E = 0\n$$\nTo write this in the canonical form $a_P \\phi_P = a_W \\phi_W + a_E \\phi_E$, we rearrange the terms:\n$$\n(2D)\\phi_P = (D\\phi_W + D\\phi_E) - F\\left(\\frac{\\phi_E - \\phi_W}{2}\\right)\n$$\n$$\n(2D)\\phi_P = \\left(D + \\frac{F}{2}\\right)\\phi_W + \\left(D - \\frac{F}{2}\\right)\\phi_E\n$$\nComparing with $a_P \\phi_P = a_W \\phi_W + a_E \\phi_E$, the coefficients are:\n$$\na_W = D + \\frac{F}{2}\n$$\n$$\na_E = D - \\frac{F}{2}\n$$\n$$\na_P = 2D\n$$\nUsing the given values $D=1$ and $F=3$:\n$$\na_W = 1 + \\frac{3}{2} = 2.5\n$$\n$$\na_E = 1 - \\frac{3}{2} = -0.5\n$$\n$$\na_P = 2(1) = 2\n$$\nThe discretized equation is $2\\phi_P = 2.5\\phi_W - 0.5\\phi_E$.\nSubstituting the boundary values $\\phi_W=0$ and $\\phi_E=1$:\n$$\n2\\phi_P = 2.5(0) - 0.5(1) = -0.5\n$$\n$$\n\\phi_P^{\\mathrm{CDS}} = -\\frac{0.5}{2} = -0.25\n$$\nThe boundary values lie in the range $[0, 1]$, but the computed interior value $\\phi_P^{\\mathrm{CDS}} = -0.25$ falls outside this range. This unphysical result is a counterexample to the boundedness principle. The cause is the negative coefficient $a_E = -0.5$, which occurs because the Peclet number $\\mathrm{Pe} = 3$ is greater than $2$.\n\n(b) Hybrid Differencing Scheme\n\nThe hybrid scheme uses CDS for $|\\mathrm{Pe}| \\le 2$ and the first-order upwind scheme for $|\\mathrm{Pe}| > 2$. Since $\\mathrm{Pe}=3$, the upwind scheme is used. For a positive velocity ($u0$), the flow is from left to right (W towards E). The upwind scheme takes the convected value at a cell face from the upstream node:\n$$\n\\phi_e = \\phi_P \\quad \\text{and} \\quad \\phi_w = \\phi_W\n$$\nSubstituting these into the general discretized equation:\n$$\nF(\\phi_P - \\phi_W) + D(\\phi_P - \\phi_W) - D(\\phi_E - \\phi_P) = 0\n$$\nRearranging to the canonical form $a_P \\phi_P = a_W \\phi_W + a_E \\phi_E$:\n$$\n(F+D+D)\\phi_P = (F+D)\\phi_W + D\\phi_E\n$$\nThe coefficients are:\n$$\na_W = F+D\n$$\n$$\na_E = D\n$$\n$$\na_P = F+2D\n$$\nUsing the given values $D=1$ and $F=3$:\n$$\na_W = 3 + 1 = 4\n$$\n$$\na_E = 1\n$$\n$$\na_P = 3 + 2(1) = 5\n$$\nNote that all coefficients are positive, which is a sufficient condition for boundedness. The discretized equation is $5\\phi_P = 4\\phi_W + 1\\phi_E$.\nSubstituting the boundary values $\\phi_W=0$ and $\\phi_E=1$:\n$$\n5\\phi_P = 4(0) + 1(1) = 1\n$$\n$$\n\\phi_P^{\\mathrm{hybrid}} = \\frac{1}{5} = 0.2\n$$\nThis value lies within the range of the boundary conditions $[0, 1]$, demonstrating that the hybrid (upwind) scheme restores the boundedness property for this high-Peclet-number flow.\n\nThe final pair is $(\\phi_P^{\\mathrm{CDS}}, \\phi_P^{\\mathrm{hybrid}}) = (-0.25, 0.2)$, which in exact fractional form is $(-\\frac{1}{4}, \\frac{1}{5})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{4}  \\frac{1}{5} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Beyond ensuring stability, it is crucial to understand the accuracy limitations of any numerical scheme. The exponential differencing scheme, derived directly from the local analytical solution of the convection-diffusion equation, provides an ideal benchmark for face value interpolation. This advanced problem  challenges you to derive this \"exact\" scheme and use it to analytically quantify the error, or numerical diffusion, introduced by the approximations made in the hybrid scheme, offering deep insight into its performance characteristics.",
            "id": "3991591",
            "problem": "A one-dimensional steady convection–diffusion of a passive scalar $\\,\\phi(x)\\,$ occurs in a channel of length $\\,L\\,$ with constant density $\\,\\rho0\\,$, constant velocity $\\,u0\\,$, and constant diffusion coefficient $\\,\\Gamma0\\,$. The boundary conditions are Dirichlet: $\\,\\phi(0)=\\phi_{L}\\,$ and $\\,\\phi(L)=\\phi_{R}\\,$. The governing equation follows from the steady conservation of $\\,\\phi\\,$ with Fickian diffusion:\n$$\n\\frac{d}{dx}\\left(-\\Gamma\\,\\frac{d\\phi}{dx}+\\rho\\,u\\,\\phi\\right)=0,\n$$\nwhich reduces to a constant-coefficient ordinary differential equation.\n\nPart 1. Starting from the above conservation statement and Fick’s law, derive the closed-form exact solution $\\,\\phi(x)\\,$ for $\\,x\\in[0,L]\\,$ in terms of the boundary values $\\,\\phi_{L}\\,$ and $\\,\\phi_{R}\\,$, $\\rho$, $u$, $\\Gamma$, and $L$. Identify the domain Péclet number $\\,\\mathrm{Pe}:=\\rho\\,u\\,L/\\Gamma\\,$ that naturally emerges in the solution.\n\nPart 2. Consider a uniform Finite Volume Method (FVM) discretization with nodes $\\,P\\,$ and $\\,E\\,$ located at $\\,x_{P}\\,$ and $\\,x_{E}=x_{P}+\\Delta x\\,$, respectively, and the east face at $\\,x_{f}=x_{P}+\\Delta x/2\\,$. Restrict the exact solution from Part 1 to the subinterval $[x_{P},x_{E}]$ with local boundary data $\\,\\phi(x_{P})=\\phi_{P}\\,$ and $\\,\\phi(x_{E})=\\phi_{E}\\,$. Using this restricted exact solution, derive the exponential-scheme face interpolation at the east face in the linear-blend form\n$$\n\\phi_{f}^{\\mathrm{exp}} \\;=\\; \\phi_{P} \\;+\\; w_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta})\\,\\bigl(\\phi_{E}-\\phi_{P}\\bigr),\n$$\nand obtain the closed-form weight $\\,w_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta})\\,$ in terms of the cell Péclet number $\\,\\mathrm{Pe}_{\\Delta}:=\\rho\\,u\\,\\Delta x/\\Gamma\\,$.\n\nPart 3. In the Hybrid Differencing Scheme (HDS), the face value $\\,\\phi_{f}^{\\mathrm{HDS}}\\,$ is chosen as central differencing for diffusion-dominated cells and upwind differencing for convection-dominated cells to preserve boundedness. For $\\,u0\\,$, write $\\,\\phi_{f}^{\\mathrm{HDS}}\\,$ in terms of $\\,\\phi_{P}\\,$ and $\\,\\phi_{E}\\,$ as a function of $\\,\\mathrm{Pe}_{\\Delta}\\,$ using the standard HDS switching criterion on the magnitude of $\\,\\mathrm{Pe}_{\\Delta}\\,$.\n\nPart 4. Using your results from Parts 2 and 3, derive a single closed-form analytic expression for the difference\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) \\;:=\\; \\phi_{f}^{\\mathrm{exp}} \\;-\\; \\phi_{f}^{\\mathrm{HDS}}\n$$\nat the east face, expressed only in terms of $\\,\\phi_{P}\\,$, $\\,\\phi_{E}\\,$, and $\\,\\mathrm{Pe}_{\\Delta}\\,$. Your final answer must be a single closed-form analytic expression. No numerical evaluation is required, and no units are to be included in the final answer.",
            "solution": "The user-provided problem is assessed for validity.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: $\\frac{d}{dx}\\left(-\\Gamma\\,\\frac{d\\phi}{dx}+\\rho\\,u\\,\\phi\\right)=0$\n-   **Domain**: $x \\in [0, L]$\n-   **Constants**: Density $\\rho0$, velocity $u0$, diffusion coefficient $\\Gamma0$. All are constant.\n-   **Boundary Conditions (BCs)**: $\\phi(0)=\\phi_{L}$ and $\\phi(L)=\\phi_{R}$.\n-   **Definition 1**: Domain Péclet number $\\mathrm{Pe}:=\\rho\\,u\\,L/\\Gamma$.\n-   **FVM Discretization**: Nodes $P$ at $x_P$ and $E$ at $x_E=x_P+\\Delta x$. East face $f$ at $x_f=x_P+\\Delta x/2$.\n-   **Local BCs for Part 2**: $\\phi(x_P)=\\phi_P$ and $\\phi(x_E)=\\phi_E$.\n-   **Definition 2**: Exponential scheme face interpolation form, $\\phi_{f}^{\\mathrm{exp}} = \\phi_{P} + w_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta})\\,\\bigl(\\phi_{E}-\\phi_{P}\\bigr)$.\n-   **Definition 3**: Cell Péclet number $\\mathrm{Pe}_{\\Delta}:=\\rho\\,u\\,\\Delta x/\\Gamma$.\n-   **Part 3 Task**: Define Hybrid Differencing Scheme (HDS) face value $\\phi_{f}^{\\mathrm{HDS}}$ for $u0$ using the standard switching criterion on $|\\mathrm{Pe}_{\\Delta}|$.\n-   **Part 4 Task**: Derive the difference $\\Delta(\\mathrm{Pe}_{\\Delta}) := \\phi_{f}^{\\mathrm{exp}} - \\phi_{f}^{\\mathrm{HDS}}$ as a single closed-form analytic expression.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem describes the one-dimensional steady-state convection-diffusion equation, a fundamental model in transport phenomena and computational thermal engineering. The concepts of Péclet number, Finite Volume Method, and the specified numerical schemes (Exponential, Hybrid) are standard and well-established in the field. All premises are scientifically sound.\n2.  **Well-Posed**: The problem is structured as a sequence of four dependent derivations. Part 1 involves solving a well-posed second-order linear ordinary differential equation with two-point boundary conditions. Parts 2, 3, and 4 are well-defined derivation tasks based on standard definitions in computational fluid dynamics. The problem leads to a unique and meaningful solution.\n3.  **Objective**: The problem is stated using precise, unambiguous mathematical language. There are no subjective or opinion-based statements.\n4.  **Completeness and Consistency**: The problem provides all necessary information, including the governing equation, boundary conditions, and definitions of relevant dimensionless numbers and numerical schemes. The givens are internally consistent. The condition $u0$ is consistently used.\n5.  **Conclusion**: The problem is deemed valid as it is scientifically grounded, well-posed, objective, and complete.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution will be derived as requested.\n\n---\n\n### Part 1: Derivation of the Exact Solution\n\nThe governing equation for one-dimensional steady convection-diffusion is given as:\n$$\n\\frac{d}{dx}\\left(-\\Gamma\\,\\frac{d\\phi}{dx}+\\rho\\,u\\,\\phi\\right)=0\n$$\nSince $\\rho$, $u$, and $\\Gamma$ are constants, we can integrate the equation once with respect to $x$ to obtain:\n$$\n-\\Gamma\\,\\frac{d\\phi}{dx}+\\rho\\,u\\,\\phi = C_1\n$$\nwhere $C_1$ is a constant of integration. This is a first-order linear ordinary differential equation (ODE), which can be rewritten as:\n$$\n\\frac{d\\phi}{dx} - \\frac{\\rho u}{\\Gamma}\\phi = -\\frac{C_1}{\\Gamma}\n$$\nThe general solution to this ODE is the sum of a homogeneous solution ($\\phi_h$) and a particular solution ($\\phi_p$). The homogeneous equation is $\\frac{d\\phi_h}{dx} - \\frac{\\rho u}{\\Gamma}\\phi_h = 0$, which has the solution $\\phi_h(x) = A \\exp\\left(\\frac{\\rho u}{\\Gamma}x\\right)$. For the particular solution, we can assume a constant, $\\phi_p(x)=B$, which upon substitution gives $B=\\frac{C_1}{\\rho u}$.\nThus, the general solution is:\n$$\n\\phi(x) = A \\exp\\left(\\frac{\\rho u}{\\Gamma}x\\right) + B'\n$$\nwhere $A$ and $B'$ are new constants. We now apply the boundary conditions $\\phi(0)=\\phi_L$ and $\\phi(L)=\\phi_R$ to determine $A$ and $B'$.\n\nAt $x=0$:\n$$\n\\phi(0) = \\phi_L = A + B'\n$$\nAt $x=L$:\n$$\n\\phi(L) = \\phi_R = A \\exp\\left(\\frac{\\rho u L}{\\Gamma}\\right) + B'\n$$\nThe term in the exponent is the domain Péclet number, $\\mathrm{Pe} = \\frac{\\rho u L}{\\Gamma}$. The second equation becomes $\\phi_R = A \\exp(\\mathrm{Pe}) + B'$.\n\nWe solve the system of linear equations for $A$ and $B'$:\nFrom the first equation, $B' = \\phi_L - A$. Substituting into the second equation:\n$$\n\\phi_R = A \\exp(\\mathrm{Pe}) + (\\phi_L - A) = A(\\exp(\\mathrm{Pe})-1) + \\phi_L\n$$\nSolving for $A$:\n$$\nA = \\frac{\\phi_R - \\phi_L}{\\exp(\\mathrm{Pe})-1}\n$$\nSolving for $B'$:\n$$\nB' = \\phi_L - A = \\phi_L - \\frac{\\phi_R - \\phi_L}{\\exp(\\mathrm{Pe})-1} = \\frac{\\phi_L\\exp(\\mathrm{Pe}) - \\phi_L - \\phi_R + \\phi_L}{\\exp(\\mathrm{Pe})-1} = \\frac{\\phi_L\\exp(\\mathrm{Pe}) - \\phi_R}{\\exp(\\mathrm{Pe})-1}\n$$\nSubstituting $A$ and $B'$ back into the general solution gives:\n$$\n\\phi(x) = \\frac{\\phi_R - \\phi_L}{\\exp(\\mathrm{Pe})-1}\\exp\\left(\\frac{\\rho u}{\\Gamma}x\\right) + \\frac{\\phi_L\\exp(\\mathrm{Pe}) - \\phi_R}{\\exp(\\mathrm{Pe})-1}\n$$\nA more convenient form is obtained by relating $\\phi(x)$ to the boundary values:\n$$\n\\phi(x) - \\phi_L = A\\exp\\left(\\frac{\\rho u}{\\Gamma}x\\right) + B' - (A+B') = A\\left(\\exp\\left(\\frac{\\rho u}{\\Gamma}x\\right) - 1\\right)\n$$\nSubstituting the expression for $A$ and recognizing that $\\frac{\\rho u x}{\\Gamma} = \\frac{\\rho u L}{\\Gamma} \\frac{x}{L} = \\mathrm{Pe}\\frac{x}{L}$:\n$$\n\\phi(x) = \\phi_L + (\\phi_R - \\phi_L)\\frac{\\exp\\left(\\mathrm{Pe}\\frac{x}{L}\\right) - 1}{\\exp(\\mathrm{Pe}) - 1}\n$$\nThe domain Péclet number, $\\mathrm{Pe}=\\rho\\,u\\,L/\\Gamma$, naturally appears in this exact solution, characterizing the ratio of convective to diffusive transport over the domain length $L$.\n\n### Part 2: Derivation of the Exponential Scheme Face Value\n\nWe apply the exact solution derived in Part 1 to a subinterval $[x_P, x_E]$ of length $\\Delta x = x_E - x_P$. The local boundary conditions are $\\phi(x_P)=\\phi_P$ and $\\phi(x_E)=\\phi_E$.\nWe can use a local coordinate system $x' = x - x_P$, where $x' \\in [0, \\Delta x]$. The problem is equivalent to the one in Part 1 with $L \\rightarrow \\Delta x$, $x \\rightarrow x'$, $\\phi_L \\rightarrow \\phi_P$, and $\\phi_R \\rightarrow \\phi_E$. The relevant Péclet number is now the cell Péclet number, $\\mathrm{Pe}_{\\Delta} = \\frac{\\rho u \\Delta x}{\\Gamma}$.\n\nThe exact solution on this subinterval is:\n$$\n\\phi(x') = \\phi_P + (\\phi_E - \\phi_P)\\frac{\\exp\\left(\\mathrm{Pe}_{\\Delta}\\frac{x'}{\\Delta x}\\right) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\n$$\nWe need to evaluate this solution at the cell face $f$, located at $x_f = x_P + \\Delta x/2$. In the local coordinate, this corresponds to $x' = \\Delta x/2$.\n$$\n\\phi_f^{\\mathrm{exp}} = \\phi(\\Delta x/2) = \\phi_P + (\\phi_E - \\phi_P)\\frac{\\exp\\left(\\mathrm{Pe}_{\\Delta}\\frac{\\Delta x/2}{\\Delta x}\\right) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\n$$\n$$\n\\phi_f^{\\mathrm{exp}} = \\phi_P + (\\phi_E - \\phi_P)\\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\n$$\nThis expression is in the requested linear-blend form $\\phi_f^{\\mathrm{exp}} = \\phi_P + w_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta})(\\phi_E - \\phi_P)$. By comparison, the weight $w_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta})$ is:\n$$\nw_{\\mathrm{exp}}(\\mathrm{Pe}_{\\Delta}) = \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\n$$\n\n### Part 3: Hybrid Differencing Scheme (HDS) Face Value\n\nThe Hybrid Differencing Scheme (HDS) adaptively chooses between the Central Differencing Scheme (CDS) and the Upwind Differencing Scheme (UDS) based on the magnitude of the cell Péclet number, $|\\mathrm{Pe}_{\\Delta}|$. The standard switching criterion is:\n- Use CDS if $|\\mathrm{Pe}_{\\Delta}| \\le 2$.\n- Use UDS if $|\\mathrm{Pe}_{\\Delta}| > 2$.\n\nFor CDS, the face value is a linear interpolation of the neighboring nodal values:\n$$\n\\phi_f^{\\mathrm{CDS}} = \\frac{\\phi_P + \\phi_E}{2}\n$$\nFor UDS, the face value is taken from the upwind node. Since the problem specifies $u  0$, the flow is from left to right (from P to E), so the upwind node for the east face $f$ is $P$:\n$$\n\\phi_f^{\\mathrm{UDS}} = \\phi_P\n$$\nAs $u0$ and other parameters are positive, $\\mathrm{Pe}_{\\Delta} = \\frac{\\rho u \\Delta x}{\\Gamma}  0$. Thus, $|\\mathrm{Pe}_{\\Delta}| = \\mathrm{Pe}_{\\Delta}$. The HDS formulation for this case is:\n$$\n\\phi_f^{\\mathrm{HDS}} = \\begin{cases} \\phi_f^{\\mathrm{CDS}} = \\frac{\\phi_P + \\phi_E}{2}  \\text{if } 0 \\le \\mathrm{Pe}_{\\Delta} \\le 2 \\\\ \\phi_f^{\\mathrm{UDS}} = \\phi_P  \\text{if } \\mathrm{Pe}_{\\Delta} > 2 \\end{cases}\n$$\n\n### Part 4: Derivation of the Difference $\\Delta(\\mathrm{Pe}_{\\Delta})$\n\nWe now derive the difference $\\Delta(\\mathrm{Pe}_{\\Delta}) = \\phi_f^{\\mathrm{exp}} - \\phi_f^{\\mathrm{HDS}}$. This difference will be a piecewise function due to the definition of HDS.\n\n**Case 1: $0 \\le \\mathrm{Pe}_{\\Delta} \\le 2$**\nIn this range, HDS uses Central Differencing.\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = \\phi_f^{\\mathrm{exp}} - \\phi_f^{\\mathrm{CDS}}\n$$\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = \\left(\\phi_P + (\\phi_E - \\phi_P)\\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\\right) - \\left(\\frac{\\phi_P + \\phi_E}{2}\\right)\n$$\nTo simplify, let's write $\\frac{\\phi_P + \\phi_E}{2} = \\phi_P + \\frac{1}{2}(\\phi_E - \\phi_P)$.\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = (\\phi_E - \\phi_P) \\left( \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1} - \\frac{1}{2} \\right)\n$$\n\n**Case 2: $\\mathrm{Pe}_{\\Delta} > 2$**\nIn this range, HDS uses Upwind Differencing.\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = \\phi_f^{\\mathrm{exp}} - \\phi_f^{\\mathrm{UDS}}\n$$\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = \\left(\\phi_P + (\\phi_E - \\phi_P)\\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}\\right) - \\phi_P\n$$\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = (\\phi_E - \\phi_P) \\left( \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1} \\right)\n$$\n\nCombining these two cases, we obtain the single closed-form analytic expression for the difference, written in piecewise form:\n$$\n\\Delta(\\mathrm{Pe}_{\\Delta}) = (\\phi_E - \\phi_P) \\begin{cases} \\left( \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1} - \\frac{1}{2} \\right)  \\text{if } 0 \\le \\mathrm{Pe}_{\\Delta} \\le 2 \\\\ \\left( \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1} \\right)  \\text{if } \\mathrm{Pe}_{\\Delta} > 2 \\end{cases}\n$$\nThis expression quantifies the error, or numerical diffusion, introduced by the Hybrid Differencing Scheme relative to the locally exact exponential scheme.",
            "answer": "$$\n\\boxed{\n\\Delta(\\mathrm{Pe}_{\\Delta}) = (\\phi_E - \\phi_P) \\begin{cases} \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1} - \\frac{1}{2}  \\text{if } 0 \\le \\mathrm{Pe}_{\\Delta} \\le 2 \\\\ \\frac{\\exp(\\mathrm{Pe}_{\\Delta}/2) - 1}{\\exp(\\mathrm{Pe}_{\\Delta}) - 1}  \\text{if } \\mathrm{Pe}_{\\Delta} > 2 \\end{cases}\n}\n$$"
        }
    ]
}