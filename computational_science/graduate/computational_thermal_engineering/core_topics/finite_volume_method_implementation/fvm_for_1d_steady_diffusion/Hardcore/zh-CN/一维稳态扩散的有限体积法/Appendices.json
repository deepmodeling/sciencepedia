{
    "hands_on_practices": [
        {
            "introduction": "有限体积法的核心在于其守恒性，这要求对控制体积内的所有物理过程进行精确积分。本练习将超越教科书中常用的简化假设，引导你为一个同时具有空间变化的截面积和热源的物理情境，严格推导源项的离散形式。通过这个练习，你将深化对源项线性化处理背后基本原理的理解，并掌握在复杂几何与物理条件下构建精确离散方程的能力。",
            "id": "3956036",
            "problem": "考虑一个细长体内的一维 ($1$D) 稳态热传导，其空间坐标为 $x$，横截面积在每个控制体积内是变化的。设体积生热率随空间变化，其形式为 $\\dot{q}'''(x)=\\alpha+\\beta x$，其中 $\\alpha$ 和 $\\beta$ 为实常数。使用有限体积法 (FVM)，关注一个索引为 $i$ 的内部控制体积，其边界为分别位于 $x_{i-\\frac{1}{2}}$ 和 $x_{i+\\frac{1}{2}}$ 的西面和东面。假设横截面积在控制体积内，在界面值 $A_{i-\\frac{1}{2}}$ 和 $A_{i+\\frac{1}{2}}$ 之间呈线性变化。从能量守恒出发，不使用任何简化公式，推导源项贡献 $S_{U,i}$ 的精确控制体积积分。该项作为常数项（与温度无关）进入离散化的代数能量方程。以 $\\alpha$、$\\beta$、 $x_{i-\\frac{1}{2}}$、 $x_{i+\\frac{1}{2}}$、 $A_{i-\\frac{1}{2}}$ 和 $A_{i+\\frac{1}{2}}$ 的形式，给出最终结果的闭合表达式。\n\n您的最终答案必须是单一的闭合形式解析表达式。不要代入数值，也不要附加单位；请以符号形式表示 $S_{U,i}$。",
            "solution": "该问题要求使用有限体积法 (FVM) 为单个内部控制体积的离散化能量方程推导源项贡献 $S_{U,i}$ 的精确积分。推导必须从能量守恒原理出发。\n\n对于控制体积 $V_i$ 内的稳态过程，能量守恒规定体积内的生热率必须等于通过其边界表面流出的净热通量率。总生热率对应于 FVM 代数方程中源项 $S_{U,i}$ 的常数部分，可以通过对体积生热率 $\\dot{q}'''(x)$ 在控制体积 $V_i$ 上积分得到。\n\n对于具有随空间变化的横截面积 $A(x)$ 的一维系统，体积微元为 $dV = A(x) dx$。节点 $i$ 的控制体积由区间 $[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ 定义。因此，源项由以下定积分给出：\n$$\nS_{U,i} = \\int_{V_i} \\dot{q}'''(x) dV = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\dot{q}'''(x) A(x) dx\n$$\n问题指定体积生热率是位置的线性函数：\n$$\n\\dot{q}'''(x) = \\alpha + \\beta x\n$$\n且横截面积 $A(x)$ 在控制体积内，在其界面值之间呈线性变化。表示 $A(x)$ 且通过点 $(x_{i-\\frac{1}{2}}, A_{i-\\frac{1}{2}})$ 和 $(x_{i+\\frac{1}{2}}, A_{i+\\frac{1}{2}})$ 的直线方程为：\n$$\nA(x) = A_{i-\\frac{1}{2}} + \\frac{A_{i+\\frac{1}{2}} - A_{i-\\frac{1}{2}}}{x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}} (x - x_{i-\\frac{1}{2}})\n$$\n将 $\\dot{q}'''(x)$ 和 $A(x)$ 的表达式代入 $S_{U,i}$ 的积分中，得到：\n$$\nS_{U,i} = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} (\\alpha + \\beta x) \\left( A_{i-\\frac{1}{2}} + \\frac{A_{i+\\frac{1}{2}} - A_{i-\\frac{1}{2}}}{x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}} (x - x_{i-\\frac{1}{2}}) \\right) dx\n$$\n为计算该积分，我们可以展开被积函数。一个更有条理的方法是根据 $\\dot{q}'''(x)$ 的分量将积分拆分：\n$$\nS_{U,i} = \\alpha \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} A(x) dx + \\beta \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} x A(x) dx\n$$\n让我们分别计算每个积分。为方便标记，设 $x_w = x_{i-\\frac{1}{2}}$，$x_e = x_{i+\\frac{1}{2}}$，$A_w = A_{i-\\frac{1}{2}}$，以及 $A_e = A_{i+\\frac{1}{2}}$。控制体积的长度为 $\\Delta x_i = x_e - x_w$。\n\n第一个积分 $\\int_{x_w}^{x_e} A(x) dx$ 代表控制体积的体积 $V_i$。由于 $A(x)$ 是线性的，该体积是平均横截面积与长度的乘积：\n$$\n\\int_{x_w}^{x_e} A(x) dx = V_i = \\frac{A_w + A_e}{2} (x_e - x_w)\n$$\n第二个积分 $\\int_{x_w}^{x_e} x A(x) dx$ 需要对 $x$ 和线性函数 $A(x)$ 的乘积进行积分。被积函数 $x A(x)$ 是一个二次多项式。\n$$\n\\int_{x_w}^{x_e} x A(x) dx = \\int_{x_w}^{x_e} x \\left( A_w + \\frac{A_e-A_w}{x_e-x_w}(x-x_w) \\right) dx\n$$\n对这个多项式表达式进行积分，得到：\n$$\n\\int_{x_w}^{x_e} x A(x) dx = \\left( A_w - \\frac{A_e-A_w}{x_e-x_w}x_w \\right) \\frac{x_e^2-x_w^2}{2} + \\left( \\frac{A_e-A_w}{x_e-x_w} \\right) \\frac{x_e^3-x_w^3}{3}\n$$\n使用恒等式 $x_e^2-x_w^2 = (x_e-x_w)(x_e+x_w)$ 和 $x_e^3-x_w^3 = (x_e-x_w)(x_e^2+x_ex_w+x_w^2)$，该表达式可简化为：\n$$\n\\int_{x_w}^{x_e} x A(x) dx = \\left( A_w - \\frac{A_e-A_w}{x_e-x_w}x_w \\right) \\frac{(x_e-x_w)(x_e+x_w)}{2} + \\left( \\frac{A_e-A_w}{x_e-x_w} \\right) \\frac{(x_e-x_w)(x_e^2+x_ex_w+x_w^2)}{3}\n$$\n经过代数处理和简化，该积分可以表示为以下对称且紧凑的形式：\n$$\n\\int_{x_w}^{x_e} x A(x) dx = \\frac{x_e-x_w}{6} \\left[ A_w(x_e + 2x_w) + A_e(2x_e + x_w) \\right]\n$$\n现在，我们将两个积分的结果结合起来，得到 $S_{U,i}$ 的最终表达式：\n$$\nS_{U,i} = \\alpha \\left( \\frac{A_w + A_e}{2} \\right) (x_e - x_w) + \\beta \\left( \\frac{x_e-x_w}{6} \\left[ A_w(x_e + 2x_w) + A_e(2x_e + x_w) \\right] \\right)\n$$\n为了得到单一表达式，我们提取公因式 $\\frac{x_e-x_w}{6}$：\n$$\nS_{U,i} = \\frac{x_e-x_w}{6} \\left[ 3\\alpha(A_w + A_e) + \\beta \\left( A_w(x_e + 2x_w) + A_e(2x_e + x_w) \\right) \\right]\n$$\n我们可以按 $A_w$ 和 $A_e$ 对项进行分组，以获得更规整的最终形式：\n$$\nS_{U,i} = \\frac{x_e-x_w}{6} \\left[ A_w(3\\alpha + \\beta(x_e + 2x_w)) + A_e(3\\alpha + \\beta(2x_e + x_w)) \\right]\n$$\n最后，恢复原来的索引标记：\n$$\nS_{U,i} = \\frac{x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}}{6} \\left[ A_{i-\\frac{1}{2}} \\left(3\\alpha + \\beta(x_{i+\\frac{1}{2}} + 2x_{i-\\frac{1}{2}})\\right) + A_{i+\\frac{1}{2}} \\left(3\\alpha + \\beta(2x_{i+\\frac{1}{2}} + x_{i-\\frac{1}{2}})\\right) \\right]\n$$\n这就是按要求从第一性原理推导出的源项贡献 $S_{U,i}$ 的精确闭合形式表达式。",
            "answer": "$$\n\\boxed{\\frac{x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}}}{6} \\left[ A_{i-\\frac{1}{2}} \\left(3\\alpha + \\beta(x_{i+\\frac{1}{2}} + 2x_{i-\\frac{1}{2}})\\right) + A_{i+\\frac{1}{2}} \\left(3\\alpha + \\beta(2x_{i+\\frac{1}{2}} + x_{i-\\frac{1}{2}})\\right) \\right]}\n$$"
        },
        {
            "introduction": "编写计算代码只是第一步，验证其正确性同样至关重要。本练习将指导你完成一个经典的验证流程：首先推导一个具有均匀热源的稳态扩散问题的精确解析解，然后编写一个有限体积法求解器，并通过网格加密研究来验证其空间收敛精度。这个过程是计算流体力学与传热学领域验证代码可靠性的基石，能帮助你建立对数值解的信心。",
            "id": "3956039",
            "problem": "考虑一根长度为 $L$ 的均匀杆内的一维稳态热传导，其热导率 $k$、横截面积 $A$ 均为常数，并存在均匀的体积生热 $\\dot{q}'''$。针对带内部生热的一维稳态扩散问题，其控制能量守恒定律是傅里叶定律的散度形式在控制体积上的积分，在连续介质极限下，该定律简化为一个关于温度场的二阶常微分方程。未知场是定义在 $x \\in [0,L]$ 上的温度 $T(x)$。假设边界条件为狄利克雷（Dirichlet）边界条件，即 $T(0) = T_0$ 和 $T(L) = T_L$。\n\n任务：\n- 从基本的能量守恒定律和傅里叶定律出发，推导 $T(x)$ 的连续方程，并在上述狄利克雷边界条件下精确求解 $T(x)$。证明精确解是关于 $x$ 的二次函数，并由 $k$、$A$、$\\dot{q}'''$、$T_0$、$T_L$ 和 $L$ 唯一确定。温度单位必须为开尔文（$\\mathrm{K}$），热导率单位为 $\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$，横截面积单位为 $\\mathrm{m}^2$，体积生热率单位为 $\\mathrm{W}/\\mathrm{m}^3$，长度单位为米（$\\mathrm{m}$）。\n- 在一个包含 $N$ 个大小为 $\\Delta x = L/N$ 的控制体积的均匀网格上，推导一种基于单元中心的有限体积法（FVM）离散格式。对面法向梯度使用两点中心差分近似，并用半控制体积距离处理狄利克雷边界面。将每个控制体积的离散方程写成标准的 FVM 形式 $a_P T_P = a_W T_W + a_E T_E + S_u$，其中 $T_P$ 表示单元中心温度，$T_W$ 和 $T_E$ 分别为其西侧和东侧的相邻单元温度，$S_u$ 是积分源项的贡献。\n- 实现一个程序，组装并求解生成的三对角线性系统，以求得单元中心的温度 $T_P$。然后在相同的单元中心位置计算连续精确解，并计算误差范数。使用离散 $L^2$（积分）范数，其计算公式为 $\\sqrt{\\sum_{i=1}^N \\left(T_i^{\\text{disc}} - T(x_i)^{\\text{exact}}\\right)^2 \\Delta x}$，其中 $x_i$ 是单元中心坐标，$T_i^{\\text{disc}}$ 是这些中心的离散温度。\n- 通过计算观测到的阶数 $p$ 来验证二阶空间精度，计算公式为 $p = \\log_2\\left(E_h/E_{h/2}\\right)$，其中 $E_h$ 是在网格间距为 $h=\\Delta x$ 上的误差范数，$E_{h/2}$ 是在网格加密一倍（即间距为 $h/2$）后的误差范数。\n\n测试套件和要求的输出：\n- 使用以下三个测试案例来评估实现：\n  1. 案例 A（对称边界温度，非零生热）：$L = 0.2\\,\\mathrm{m}$，$k = 15.0\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$，$A = 1.0\\times 10^{-3}\\,\\mathrm{m}^2$，$\\dot{q}''' = 2.0\\times 10^{5}\\,\\mathrm{W}/\\mathrm{m}^3$，$T_0 = 300.0\\,\\mathrm{K}$，$T_L = 300.0\\,\\mathrm{K}$，使用 $N=40$ 和 $N=80$ 两种网格。输出观测阶数 $p$（浮点数）。\n  2. 案例 B（非对称边界温度，非零生热）：$L = 0.1\\,\\mathrm{m}$，$k = 200.0\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$，$A = 5.0\\times 10^{-4}\\,\\mathrm{m}^2$，$\\dot{q}''' = 1.0\\times 10^{6}\\,\\mathrm{W}/\\mathrm{m}^3$，$T_0 = 300.0\\,\\mathrm{K}$，$T_L = 350.0\\,\\mathrm{K}$，使用 $N=20$ 和 $N=40$ 两种网格。输出观测阶数 $p$（浮点数）。\n  3. 案例 C（边界情况，零生热）：$L = 0.3\\,\\mathrm{m}$，$k = 50.0\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$，$A = 2.0\\times 10^{-4}\\,\\mathrm{m}^2$，$\\dot{q}''' = 0.0\\,\\mathrm{W}/\\mathrm{m}^3$，$T_0 = 300.0\\,\\mathrm{K}$，$T_L = 350.0\\,\\mathrm{K}$，使用 $N=10$ 和 $N=20$ 两种网格。由于精确解是线性的，中心差分 FVM 应该能精确到舍入误差范围内再现它；如果两种网格下的离散 $L^2$ 范数误差均低于 $1.0\\times 10^{-11}\\,\\mathrm{K}$，则输出布尔值 $True$，否则输出 $False$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，顺序为案例 A、案例 B、案例 C（例如，$[p_A, p_B, \\text{boolean}_C]$）。数字 $p_A$ 和 $p_B$ 是无量纲的，必须以浮点数形式打印。案例 C 的布尔值必须打印为 $True$ 或 $False$。",
            "solution": "该问题被评估为有效。这是一个计算传热学中适定、有科学依据的问题，内容自洽，没有歧义或矛盾。\n\n### 第 1 部分：连续控制方程和精确解\n\n控制该过程的基本原理是能量守恒。对于一维稳态系统，在长度为 $\\Delta x$、横截面积恒为 $A$ 的任意控制体积上，能量平衡为：\n\n(传入的能量传导速率) + (能量生成速率) = (传出的能量传导速率)\n\n设 $q(x)$ 为沿 x 正方向的热通量，单位为 $\\mathrm{W}/\\mathrm{m}^2$。热传递速率（热流）为 $Q(x) = q(x) A$。能量平衡方程变为：\n$$Q(x) - Q(x+\\Delta x) + \\dot{q}''' (A \\Delta x) = 0$$\n其中 $\\dot{q}'''$ 是均匀的体积生热率，单位为 $\\mathrm{W}/\\mathrm{m}^3$。两边同除以体积 $A \\Delta x$ 并取 $\\Delta x \\to 0$ 的极限，得到能量守恒方程的微分形式：\n$$-\\frac{d}{dx}q(x) + \\dot{q}''' = 0$$\n傅里叶热传导定律将热通量与温度梯度关联起来：\n$$q(x) = -k \\frac{dT}{dx}$$\n其中 $k$ 是热导率，单位为 $\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$，$T(x)$ 是温度场。将傅里叶定律代入守恒方程，得到：\n$$-\\frac{d}{dx}\\left(-k \\frac{dT}{dx}\\right) + \\dot{q}''' = 0$$\n由于热导率 $k$ 假定为常数，该方程简化为关于 $T(x)$ 的二阶常微分方程（ODE）：\n$$\\frac{d^2T}{dx^2} = -\\frac{\\dot{q}'''}{k}$$\n为求得精确解，我们将此常微分方程对 $x$ 积分两次：\n$$\\frac{dT}{dx} = -\\frac{\\dot{q}'''}{k}x + C_1$$\n$$T(x) = -\\frac{\\dot{q}'''}{2k}x^2 + C_1 x + C_2$$\n这表明精确解是关于 $x$ 的二次函数。积分常数 $C_1$ 和 $C_2$ 通过应用狄利克雷边界条件 $T(0) = T_0$ 和 $T(L) = T_L$ 来确定。\n\n在 $x=0$ 处：\n$$T(0) = T_0 = -\\frac{\\dot{q}'''}{2k}(0)^2 + C_1(0) + C_2 \\implies C_2 = T_0$$\n在 $x=L$ 处：\n$$T(L) = T_L = -\\frac{\\dot{q}'''}{2k}L^2 + C_1 L + T_0$$\n求解 $C_1$：\n$$C_1 L = T_L - T_0 + \\frac{\\dot{q}'''L^2}{2k} \\implies C_1 = \\frac{T_L - T_0}{L} + \\frac{\\dot{q}'''L}{2k}$$\n将 $C_1$ 和 $C_2$ 代回 $T(x)$ 的表达式，得到唯一的精确解：\n$$T(x) = -\\frac{\\dot{q}'''}{2k}x^2 + \\left(\\frac{T_L - T_0}{L} + \\frac{\\dot{q}'''L}{2k}\\right)x + T_0$$\n该解可以重排为线性分布（无源项的传导）和抛物线分布（边界温度为零的源项）的叠加：\n$$T(x)^{\\text{exact}} = T_0 + (T_L - T_0)\\frac{x}{L} + \\frac{\\dot{q}'''}{2k}(Lx - x^2)$$\n该解由参数 $k, \\dot{q}''', T_0, T_L,$ 和 $L$ 唯一确定。面积 $A$ 由于被消去，不出现在温度的控制方程中，但在计算总热率时是必需的。\n\n### 第 2 部分：有限体积法（FVM）离散化\n\n我们将区域 $x \\in [0, L]$ 离散为 $N$ 个均匀的、以单元为中心的控制体积（CV），每个控制体积的宽度为 $\\Delta x = L/N$。第 $i$ 个控制体积的中心用 $P$（或 $i$）表示，其坐标为 $x_i = (i-0.5)\\Delta x$，$i=1, 2, \\dots, N$。第 $i$ 个控制体积的西侧和东侧面分别位于 $x_w = (i-1)\\Delta x$ 和 $x_e = i\\Delta x$。\n\n我们将原始守恒定律 $\\frac{d}{dx}(k \\frac{dT}{dx}) + \\dot{q}''' = 0$ 在第 $i$ 个控制体积上积分：\n$$\\int_{x_w}^{x_e} \\left(\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) + \\dot{q}'''\\right) A \\, dx = 0$$\n$$A \\int_{x_w}^{x_e} \\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) dx + A \\int_{x_w}^{x_e} \\dot{q}''' \\, dx = 0$$\n对第一项应用微积分基本定理，并计算常数源项的积分：\n$$A \\left[k \\frac{dT}{dx}\\right]_w^e + A \\dot{q}''' \\Delta x = 0$$\n$$A \\left(k \\frac{dT}{dx}\\right)_e - A \\left(k \\frac{dT}{dx}\\right)_w + A \\dot{q}''' \\Delta x = 0$$\n单元面上的梯度使用相邻单元中心温度的中心差分来近似。对于一个内部单元 $i$，其相邻单元为西侧的单元 $W$（$i-1$）和东侧的单元 $E$（$i+1$）。\n$$\\left(\\frac{dT}{dx}\\right)_e \\approx \\frac{T_E - T_P}{\\Delta x} \\quad \\text{和} \\quad \\left(\\frac{dT}{dx}\\right)_w \\approx \\frac{T_P - T_W}{\\Delta x}$$\n将这些近似代入内部控制体积（$i=2, \\dots, N-1$）的积分平衡方程中：\n$$A k \\frac{T_E - T_P}{\\Delta x} - A k \\frac{T_P - T_W}{\\Delta x} + A \\dot{q}''' \\Delta x = 0$$\n整理成标准的 FVM 形式 $a_P T_P = a_W T_W + a_E T_E + S_u$：\n$$\\left(\\frac{kA}{\\Delta x} + \\frac{kA}{\\Delta x}\\right) T_P = \\left(\\frac{kA}{\\Delta x}\\right) T_W + \\left(\\frac{kA}{\\Delta x}\\right) T_E + \\dot{q}''' A \\Delta x$$\n对于内部单元，系数为：$a_P = \\frac{2kA}{\\Delta x}$，$a_W = a_E = \\frac{kA}{\\Delta x}$，源项为 $S_u = \\dot{q}''' A \\Delta x$。\n\n对于边界单元，处理方式有所修改：\n**单元 1（西边界）：** 其西侧面是位于 $x=0$ 的物理边界，温度为 $T_0$。该面上的梯度在半单元距离 $\\Delta x/2$ 上近似为：\n$$\\left(\\frac{dT}{dx}\\right)_w \\approx \\frac{T_P - T_0}{\\Delta x / 2} = \\frac{T_1 - T_0}{\\Delta x / 2}$$\n东侧面的梯度是标准的：$(\\frac{dT}{dx})_e \\approx \\frac{T_2 - T_1}{\\Delta x}$。代入平衡方程：\n$$A k \\frac{T_2 - T_1}{\\Delta x} - A k \\frac{T_1 - T_0}{\\Delta x/2} + A \\dot{q}''' \\Delta x = 0$$\n对 $T_P = T_1$ 进行整理：\n$$\\left(\\frac{kA}{\\Delta x} + \\frac{2kA}{\\Delta x}\\right) T_1 = \\left(\\frac{kA}{\\Delta x}\\right) T_2 + \\left(\\frac{2kA}{\\Delta x} T_0 + \\dot{q}''' A \\Delta x\\right)$$\n此处，$a_P = \\frac{3kA}{\\Delta x}$，$a_W = 0$，$a_E = \\frac{kA}{\\Delta x}$，且 $S_u = \\frac{2kA}{\\Delta x} T_0 + \\dot{q}''' A \\Delta x$。\n\n**单元 N（东边界）：** 其东侧面是位于 $x=L$ 的边界，温度为 $T_L$。梯度近似为：\n$$\\left(\\frac{dT}{dx}\\right)_e \\approx \\frac{T_L - T_P}{\\Delta x / 2} = \\frac{T_L - T_N}{\\Delta x / 2}$$\n西侧面的梯度是 $(\\frac{dT}{dx})_w \\approx \\frac{T_N - T_{N-1}}{\\Delta x}$。代入平衡方程：\n$$A k \\frac{T_L - T_N}{\\Delta x/2} - A k \\frac{T_N - T_{N-1}}{\\Delta x} + A \\dot{q}''' \\Delta x = 0$$\n对 $T_P = T_N$ 进行整理：\n$$\\left(\\frac{2kA}{\\Delta x} + \\frac{kA}{\\Delta x}\\right) T_N = \\left(\\frac{kA}{\\Delta x}\\right) T_{N-1} + \\left(\\frac{2kA}{\\Delta x} T_L + \\dot{q}''' A \\Delta x\\right)$$\n此处，$a_P = \\frac{3kA}{\\Delta x}$，$a_W = \\frac{kA}{\\Delta x}$，$a_E = 0$，且 $S_u = \\frac{2kA}{\\Delta x} T_L + \\dot{q}''' A \\Delta x$。\n\n### 第 3 部分：线性系统和精度验证\n\n这 $N$ 个线性代数方程组构成一个三对角系统 $\\mathbf{M}\\mathbf{T} = \\mathbf{b}$，其中 $\\mathbf{T} = [T_1, T_2, \\dots, T_N]^T$。为方便实现，可将所有方程同除以 $kA/\\Delta x$：\n- **方程 1：** $3 T_1 - T_2 = \\frac{\\dot{q}''' (\\Delta x)^2}{k} + 2 T_0$\n- **方程 i=2..N-1：** $-T_{i-1} + 2 T_i - T_{i+1} = \\frac{\\dot{q}''' (\\Delta x)^2}{k}$\n- **方程 N：** $-T_{N-1} + 3 T_N = \\frac{\\dot{q}''' (\\Delta x)^2}{k} + 2 T_L$\n\n该系统通过数值方法求解，得到离散温度 $T_i^{\\text{disc}}$。使用离散 $L^2$ 范数，将计算结果与在单元中心坐标 $x_i$ 处的精确解进行比较，以评估误差：\n$$E = \\sqrt{\\sum_{i=1}^N \\left(T_i^{\\text{disc}} - T(x_i)^{\\text{exact}}\\right)^2 \\Delta x}$$\n对于这种中心差分格式，其理论精度阶为二阶，这意味着误差 $E$ 与 $(\\Delta x)^2$ 成正比。我们通过计算在两种网格间距 $h$ 和 $h/2$ 上求解得到的观测精度阶 $p$ 来验证这一点：\n$$p = \\log_2\\left(\\frac{E_h}{E_{h/2}}\\right)$$\n对于二阶格式，我们期望 $p \\approx 2$。\n\n对于 $\\dot{q}'''=0$ 的案例 C，其精确解是线性的。经代数运算证实，该 FVM 格式（包括边界处理）能被线性解精确满足，因此数值解应在机器浮点精度范围内与精确解相匹配。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem, run test cases, and print the final output.\n    \"\"\"\n\n    def compute_error(L, k, A, q_gen, T0, TL, N):\n        \"\"\"\n        Solves the 1D steady diffusion problem using FVM and returns the L2 error norm.\n        \n        Args:\n            L (float): Length of the rod [m].\n            k (float): Thermal conductivity [W/(m.K)].\n            A (float): Cross-sectional area [m^2].\n            q_gen (float): Volumetric heat generation [W/m^3].\n            T0 (float): Temperature at x=0 [K].\n            TL (float): Temperature at x=L [K].\n            N (int): Number of control volumes.\n        \n        Returns:\n            float: The discrete L2 norm of the error.\n        \"\"\"\n        # 1. Grid setup\n        dx = L / N\n        x_centers = np.linspace(dx / 2, L - dx / 2, N)\n\n        # 2. Assemble the linear system M*T = b (simplified form)\n        M = np.zeros((N, N))\n        b = np.zeros(N)\n\n        # Fill main and off-diagonals\n        np.fill_diagonal(M, 2.0)\n        np.fill_diagonal(M[1:], -1.0)\n        np.fill_diagonal(M[:, 1:], -1.0)\n        \n        # Apply boundary condition modifications\n        M[0, 0] = 3.0\n        M[N - 1, N - 1] = 3.0\n\n        # Assemble the RHS vector b\n        source_term = (q_gen * dx**2) / k\n        b.fill(source_term)\n        b[0] += 2 * T0\n        b[N - 1] += 2 * TL\n\n        # 3. Solve the linear system\n        T_fvm = np.linalg.solve(M, b)\n\n        # 4. Calculate the exact solution at cell centers\n        # T_exact(x) = T0 + (TL - T0)*x/L + (q_gen/(2*k))*(L*x - x**2)\n        term1 = T0\n        term2 = (TL - T0) * x_centers / L\n        term3 = (q_gen / (2 * k)) * (L * x_centers - x_centers**2)\n        T_exact = term1 + term2 + term3\n        \n        # 5. Compute the discrete L2 error norm\n        error_norm = np.sqrt(np.sum((T_fvm - T_exact)**2) * dx)\n        \n        return error_norm\n\n    results = []\n\n    # Case A: Symmetric BCs, with generation\n    L_A, k_A, A_A, q_gen_A, T0_A, TL_A = 0.2, 15.0, 1.0e-3, 2.0e5, 300.0, 300.0\n    N1_A, N2_A = 40, 80\n    error_h_A = compute_error(L_A, k_A, A_A, q_gen_A, T0_A, TL_A, N1_A)\n    error_h2_A = compute_error(L_A, k_A, A_A, q_gen_A, T0_A, TL_A, N2_A)\n    # Avoid division by zero if error is zero\n    if error_h2_A > 0:\n        p_A = np.log2(error_h_A / error_h2_A)\n    else:\n        p_A = np.inf # Or some other indicator of exactness\n    results.append(p_A)\n\n    # Case B: Asymmetric BCs, with generation\n    L_B, k_B, A_B, q_gen_B, T0_B, TL_B = 0.1, 200.0, 5.0e-4, 1.0e6, 300.0, 350.0\n    N1_B, N2_B = 20, 40\n    error_h_B = compute_error(L_B, k_B, A_B, q_gen_B, T0_B, TL_B, N1_B)\n    error_h2_B = compute_error(L_B, k_B, A_B, q_gen_B, T0_B, TL_B, N2_B)\n    if error_h2_B > 0:\n        p_B = np.log2(error_h_B / error_h2_B)\n    else:\n        p_B = np.inf\n    results.append(p_B)\n\n    # Case C: Zero generation (linear solution)\n    L_C, k_C, A_C, q_gen_C, T0_C, TL_C = 0.3, 50.0, 2.0e-4, 0.0, 300.0, 350.0\n    N1_C, N2_C = 10, 20\n    error_1_C = compute_error(L_C, k_C, A_C, q_gen_C, T0_C, TL_C, N1_C)\n    error_2_C = compute_error(L_C, k_C, A_C, q_gen_C, T0_C, TL_C, N2_C)\n    threshold = 1.0e-11\n    result_C = (error_1_C  threshold) and (error_2_C  threshold)\n    results.append(result_C)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "真实世界的工程问题常常涉及由不同材料组成的复合结构，这给数值模拟带来了挑战，尤其是在材料界面处。本练习将通过一个包含两种不同导热系数的层状材料问题，让你亲手比较两种常用的界面导热系数计算方法——算术平均法与调和平均法的优劣。通过量化误差，你将深刻理解为何调和平均法在处理此类不连续问题时能够保持物理真实性和数值准确性，这是开发高保真度模拟程序的关键一环。",
            "id": "3956020",
            "problem": "考虑无量纲温度 $T(x)$ 沿着线段 $x \\in [0,L]$ 的一维稳态扩散，无体积源。热导率是分段常数：\n$$\nk(x) = \\begin{cases}\nk_1,  0 \\le x \\le a,\\\\\nk_2,  a  x \\le L,\n\\end{cases}\n$$\n其中 $k_1  0$、$k_2  0$、$L  0$ 和 $a \\in (0,L)$ 是给定的常数。边界条件是两端的狄利克雷（Dirichlet）条件：$T(0) = T_0$ 和 $T(L) = T_L$。所有物理量都是无量纲的。\n\n任务：\n1) 从一维稳态控制体的能量守恒和傅里叶（Fourier）热传导定律出发，推导满足上述边界条件以及在 $x=a$ 处温度和热通量均连续的精确分段解 $T(x)$。不要先验地假设任何特定形式；从基本原理出发推导 $T(x)$ 和恒定的热通量。\n\n2) 将区域离散为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀控制体，单元中心位于 $x_i = \\left(i+\\tfrac{1}{2}\\right)\\Delta x$，其中 $i=0,1,\\dots,N-1$。使用标准的两点通量近似方法构建一个线性的有限体积法（Finite Volume Method, FVM）系统来计算跨面的通量。对于内部面，实现两种计算面电导率的变体：\n- 相邻单元电导率的调和平均值，以及\n- 相邻单元电导率的算术平均值。\n使用边界与相邻单元之间一致的边界面传导率，在 $x=0$ 和 $x=L$ 处施加狄利克雷（Dirichlet）边界条件。\n\n3) 对于每个测试用例，使用调和平均和算术平均两种面电导率计算方法，计算单元中心的离散解。使用以下无量纲误差，将每个离散解与相同单元中心处的精确解进行比较：\n- 归一化的离散 $\\ell_2$ 误差\n$$\nE_2 = \\frac{\\left( \\frac{1}{N}\\sum_{i=0}^{N-1} \\left[T_i^{\\text{num}} - T(x_i)\\right]^2 \\right)^{1/2}}{|T_L - T_0|},\n$$\n- 归一化的离散 $\\ell_\\infty$ 误差\n$$\nE_\\infty = \\frac{\\max_{0 \\le i \\le N-1} \\left| T_i^{\\text{num}} - T(x_i) \\right|}{|T_L - T_0|}.\n$$\n\n您的程序必须评估以下测试套件，该套件探讨了未对齐和对齐的界面、均匀电导率以及高对比度的情况：\n- 案例 1：$L=1$, $a=0.3$, $k_1=1$, $k_2=10$, $T_0=0$, $T_L=1$, $N=40$。\n- 案例 2：$L=1$, $a=0.5$, $k_1=1$, $k_2=10$, $T_0=0$, $T_L=1$, $N=20$。\n- 案例 3：$L=1$, $a=0.6$, $k_1=5$, $k_2=5$, $T_0=0$, $T_L=1$, $N=30$。\n- 案例 4：$L=1$, $a=0.45$, $k_1=1$, $k_2=10^6$, $T_0=0$, $T_L=1$, $N=60$。\n\n对于每个案例，生成一个包含四个浮点数的结果列表，顺序如下：$[E_2^{\\text{harm}}, E_2^{\\text{arith}}, E_\\infty^{\\text{harm}}, E_\\infty^{\\text{arith}}]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有四个案例的结果，格式为用方括号括起来的逗号分隔的列表。例如，输出必须如下所示：\n$$\n\\left[\\left[E_2^{\\text{harm},(1)}, E_2^{\\text{arith},(1)}, E_\\infty^{\\text{harm},(1)}, E_\\infty^{\\text{arith},(1)}\\right], \\dots, \\left[E_2^{\\text{harm},(4)}, E_2^{\\text{arith},(4)}, E_\\infty^{\\text{harm},(4)}, E_\\infty^{\\text{arith},(4)}\\right]\\right].\n$$\n不应打印任何额外文本。所有数字必须是有限的实数值。所有量都是无量纲的；输出不需要物理单位。",
            "solution": "用户提供了一个关于一维稳态热扩散的适定问题陈述，我们将对其进行分析和求解。\n\n### 第1步：推导精确解\n\n该问题考虑的是无内部热源的一维稳态热扩散。其控制原理是能量守恒，可简化为热通量 $q(x)$ 在整个区域内必须为常数的论断。根据 Fourier 热传导定律，热通量由 $q(x) = -k(x) \\frac{dT}{dx}$ 给出。因此，控制方程为：\n$$\n\\frac{d}{dx}\\left(-k(x) \\frac{dT}{dx}\\right) = 0\n$$\n对该方程关于 $x$ 积分一次，可以证实热通量是恒定的：\n$$\n-k(x) \\frac{dT}{dx} = q_0\n$$\n其中 $q_0$ 是恒定热通量。这可以重写为 $\\frac{dT}{dx} = -\\frac{q_0}{k(x)}$。我们对两个电导率恒定的区域分段求解这个常微分方程。\n\n对于区域 $0 \\le x \\le a$，其中 $k(x)=k_1$：\n$$\n\\frac{dT}{dx} = -\\frac{q_0}{k_1} \\implies T_1(x) = -\\frac{q_0}{k_1}x + C_1\n$$\n对于区域 $a  x \\le L$，其中 $k(x)=k_2$：\n$$\n\\frac{dT}{dx} = -\\frac{q_0}{k_2} \\implies T_2(x) = -\\frac{q_0}{k_2}x + C_2\n$$\n常数 $q_0$、$C_1$ 和 $C_2$ 由边界条件和界面条件确定。\n1.  $x=0$ 处的边界条件：$T(0) = T_0$。将其应用于 $T_1(x)$：\n    $T_1(0) = C_1 = T_0$。因此，$T_1(x) = T_0 - \\frac{q_0}{k_1}x$。\n2.  $x=L$ 处的边界条件：$T(L) = T_L$。将其应用于 $T_2(x)$：\n    $T_L = -\\frac{q_0}{k_2}L + C_2$。\n3.  $x=a$ 处的界面条件：\n    a. 温度连续性：$T_1(a) = T_2(a)$。\n       $T_0 - \\frac{q_0}{k_1}a = -\\frac{q_0}{k_2}a + C_2$\n    b. 热通量连续性：通过在整个区域使用单一常数 $q_0$，此条件已得到满足。\n\n我们得到了一个关于 $q_0$ 和 $C_2$ 的二元线性方程组。从条件 3a，我们表示出 $C_2$：\n$C_2 = T_0 - q_0\\left(\\frac{a}{k_1} - \\frac{a}{k_2}\\right)$。\n将此代入由条件 2 得到的方程中：\n$T_L = -\\frac{q_0}{k_2}L + T_0 - q_0\\left(\\frac{a}{k_1} - \\frac{a}{k_2}\\right)$\n$T_L - T_0 = -q_0 \\left( \\frac{L}{k_2} + \\frac{a}{k_1} - \\frac{a}{k_2} \\right) = -q_0 \\left( \\frac{a}{k_1} + \\frac{L-a}{k_2} \\right)$\n项 $\\frac{a}{k_1}$ 和 $\\frac{L-a}{k_2}$ 分别代表两层的热阻，我们称之为 $R_1$ 和 $R_2$。总热阻为 $R_{tot} = R_1 + R_2$。那么恒定热通量为：\n$$\nq_0 = - \\frac{T_L - T_0}{R_1 + R_2} = \\frac{T_0 - T_L}{R_1 + R_2}\n$$\n已知 $q_0$ 后，我们可以求出界面温度 $T(a)$：\n$T(a) = T_1(a) = T_0 - \\frac{q_0}{k_1}a = T_0 + \\frac{T_L-T_0}{R_1+R_2} \\frac{a}{k_1} = T_0 + \\frac{T_L-T_0}{R_1+R_2}R_1 = \\frac{T_0(R_1+R_2) + (T_L-T_0)R_1}{R_1+R_2} = \\frac{T_0 R_2 + T_L R_1}{R_1+R_2}$。\n代入 $R_1$ 和 $R_2$ 的表达式：\n$$\nT(a) = \\frac{T_0 \\frac{L-a}{k_2} + T_L \\frac{a}{k_1}}{\\frac{L-a}{k_2} + \\frac{a}{k_1}}\n$$\n每个分段内的温度分布是线性的。最终的精确解是：\n$$\nT(x) = \\begin{cases}\nT_0 + \\left(T(a) - T_0\\right)\\frac{x}{a},   0 \\le x \\le a \\\\\nT_L + \\left(T(a) - T_L\\right)\\frac{L-x}{L-a},  a  x \\le L\n\\end{cases}\n$$\n\n### 第2步：有限体积法（FVM）离散化\n\n区域 $[0,L]$ 被划分为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀控制体（CVs）。第 $i$ 个控制体覆盖 $[x_{i-1/2}, x_{i+1/2}]$，其中心（节点）位于 $x_i = (i+1/2)\\Delta x$，其中 $i=0, \\dots, N-1$。面位于 $x_{i+1/2} = (i+1)\\Delta x$。\n\n对于控制体 $i$ 的能量守恒方程的积分形式为：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{d}{dx}\\left(-k \\frac{dT}{dx}\\right) dx = \\left[-k \\frac{dT}{dx}\\right]_{x_{i-1/2}}^{x_{i+1/2}} = q_{i+1/2} - q_{i-1/2} = 0\n$$\n其中 $q_{i \\pm 1/2}$ 是控制体东西两侧面上的热通量。我们使用两点近似来计算节点 $i$ 和 $i+1$ 之间内面 $i+1/2$ 处的通量：\n$$\nq_{i+1/2} \\approx -k_{i+1/2} \\frac{T_{i+1} - T_i}{\\Delta x}\n$$\n其中 $T_i$ 是节点 $x_i$ 处的温度，$k_{i+1/2}$ 是面上的热导率。以 $x_i$ 为中心的控制体的电导率为 $k_{cv,i} = k(x_i)$。\n\n对于内部节点 $i \\in [1, N-2]$，离散后的方程是：\n$$\n-k_{i+1/2} \\frac{T_{i+1} - T_i}{\\Delta x} - \\left(-k_{i-1/2} \\frac{T_i - T_{i-1}}{\\Delta x}\\right) = 0\n$$\n$$\n\\left(\\frac{k_{i-1/2}}{\\Delta x} + \\frac{k_{i+1/2}}{\\Delta x}\\right)T_i - \\frac{k_{i-1/2}}{\\Delta x} T_{i-1} - \\frac{k_{i+1/2}}{\\Delta x} T_{i+1} = 0\n$$\n这给出了一个关于节点温度向量 $\\mathbf{T} = [T_0, \\dots, T_{N-1}]^T$ 的三对角线性方程组 $A\\mathbf{T}=\\mathbf{b}$。\n\n面电导率 $k_{i+1/2}$ 使用两种方法计算：\n1.  **算术平均值**：$k_{i+1/2}^{\\text{arith}} = \\frac{k_{cv,i} + k_{cv,i+1}}{2}$\n2.  **调和平均值**：$k_{i+1/2}^{\\text{harm}} = \\frac{2 k_{cv,i} k_{cv,i+1}}{k_{cv,i} + k_{cv,i+1}}$\n\n对于边界控制体，我们引入狄利克雷（Dirichlet）条件。\n对于控制体 $0$（在 $x=0$ 处），方程为 $q_{1/2} - q_w = 0$，其中 $q_w$ 是西边界面的通量。我们将 $q_w$ 建模为：\n$q_w = -k_{w} \\frac{T_0 - T(0)}{\\Delta x/2}$，其中 $T(0)=T_0^{\\text{given}}$ 且面电导率 $k_w$ 取为 $k_{cv,0}$。\n$$\n-k_{1/2} \\frac{T_1 - T_0}{\\Delta x} + k_{cv,0}\\frac{T_0 - T_0^{\\text{given}}}{\\Delta x/2} = 0\n$$\n重新整理得到关于 $T_0$ 的方程：\n$$\n\\left(\\frac{k_{1/2}}{\\Delta x} + \\frac{2k_{cv,0}}{\\Delta x}\\right)T_0 - \\frac{k_{1/2}}{\\Delta x}T_1 = \\frac{2k_{cv,0}}{\\Delta x}T_0^{\\text{given}}\n$$\n\n对于控制体 $N-1$（在 $x=L$ 处），方程为 $q_e - q_{N-1/2} = 0$，其中 $q_e$ 是东边界面的通量。\n$q_e = -k_{e} \\frac{T_L^{\\text{given}} - T_{N-1}}{\\Delta x/2}$，且 $k_e = k_{cv,N-1}$。\n$$\n-k_{cv,N-1}\\frac{T_L^{\\text{given}} - T_{N-1}}{\\Delta x/2} + k_{N-1/2}\\frac{T_{N-1} - T_{N-2}}{\\Delta x} = 0\n$$\n重新整理得到关于 $T_{N-1}$ 的方程：\n$$\n\\left(\\frac{k_{N-1/2}}{\\Delta x} + \\frac{2k_{cv,N-1}}{\\Delta x}\\right)T_{N-1} - \\frac{k_{N-1/2}}{\\Delta x}T_{N-2} = \\frac{2k_{cv,N-1}}{\\Delta x}T_L^{\\text{given}}\n$$\n这些方程定义了系统 $A\\mathbf{T}=\\mathbf{b}$ 的第一行和最后一行，然后求解该系统以得到 $\\mathbf{T}$。\n\n### 第3步：误差计算\n\n使用两种归一化的误差度量，将数值解 $\\mathbf{T}^{\\text{num}}$ 与单元中心处的精确解 $T(x_i)$ 进行比较：\n-   归一化的离散 $\\ell_2$ 误差：$E_2 = \\frac{\\left( \\frac{1}{N}\\sum_{i=0}^{N-1} \\left[T_i^{\\text{num}} - T(x_i)\\right]^2 \\right)^{1/2}}{|T_L - T_0|}$\n-   归一化的离散 $\\ell_\\infty$ 误差：$E_\\infty = \\frac{\\max_{0 \\le i \\le N-1} \\left| T_i^{\\text{num}} - T(x_i) \\right|}{|T_L - T_0|}$\n\n当 $x=a$ 处的材料界面与某个控制体面对齐时，两个相邻单元中心之间的热阻可以通过其电导率的调和平均值精确捕捉。因此，采用调和平均的有限体积法（FVM）有望在单元中心得到精确解，其误差接近机器精度。算术平均值不具备此特性，会表现出离散误差。对于均匀电导率介质，调和平均值和算术平均值是相同的，此时有限体积法（FVM）方案对于线性温度分布是精确的。",
            "answer": "```python\nimport numpy as np\n\ndef _get_exact_solution(x_coords, L, a, k1, k2, T0, TL):\n    \"\"\"\n    Computes the exact analytical solution at given coordinates.\n    \"\"\"\n    # Thermal resistances\n    # Handle k1 or k2 being extremely large, a or L-a being zero.\n    R1 = a / k1 if k1 > 0 and a > 0 else 0\n    R2 = (L - a) / k2 if k2 > 0 and L-a > 0 else 0\n\n    if R1 + R2 == 0:\n        # This case happens if the domain has infinite conductivity everywhere,\n        # or if T0==TL. Solution is constant/indeterminate.\n        # But problem constraints ensure R1+R2 > 0.\n        # However, for robustness: if both T0 and TL are the same, temp is uniform.\n        if T0 == TL:\n             return np.full_like(x_coords, T0)\n        # Undefined otherwise, a should be in (0,L) and k>0\n        # For simplicity, for perfect conductor, treat as linear profile.\n        T_a = T0 + (TL-T0) * (a/L)\n    else:\n        # Interface temperature (voltage divider analogy)\n        T_a = (T0 * R2 + TL * R1) / (R1 + R2)\n\n    # Piecewise linear solution\n    T_exact = np.piecewise(\n        x_coords,\n        [x_coords = a, x_coords  a],\n        [\n            lambda x: T0 + (T_a - T0) * x / a if a  0 else T_a,\n            lambda x: TL + (T_a - TL) * (L - x) / (L - a) if (L - a)  0 else T_a,\n        ]\n    )\n    return T_exact\n\ndef _solve_fvm(N, L, a, k1, k2, T0, TL, method):\n    \"\"\"\n    Builds and solves the FVM linear system.\n    \"\"\"\n    dx = L / N\n    x_centers = (np.arange(N) + 0.5) * dx\n\n    # Cell-center conductivities\n    k_cv = np.where(x_centers = a, k1, k2)\n\n    # Face conductivities for internal faces (i=0 to N-2)\n    k_face = np.zeros(N - 1)\n    if method == 'harmonic':\n        # Harmonic mean: 2*k_i*k_{i+1} / (k_i + k_{i+1})\n        k_face = 2 * k_cv[:-1] * k_cv[1:] / (k_cv[:-1] + k_cv[1:])\n    elif method == 'arithmetic':\n        # Arithmetic mean: (k_i + k_{i+1}) / 2\n        k_face = 0.5 * (k_cv[:-1] + k_cv[1:])\n    else:\n        raise ValueError(\"Method must be 'harmonic' or 'arithmetic'\")\n    \n    # Assemble the linear system A*T = b\n    A = np.zeros((N, N))\n    b = np.zeros(N)\n\n    # Left boundary (i=0)\n    A[0, 0] = k_face[0] / dx + 2 * k_cv[0] / dx\n    A[0, 1] = -k_face[0] / dx\n    b[0] = 2 * k_cv[0] / dx * T0\n\n    # Internal nodes (i=1 to N-2)\n    for i in range(1, N - 1):\n        A[i, i - 1] = -k_face[i - 1] / dx\n        A[i, i] = k_face[i - 1] / dx + k_face[i] / dx\n        A[i, i + 1] = -k_face[i] / dx\n\n    # Right boundary (i=N-1)\n    A[N - 1, N - 2] = -k_face[N - 2] / dx\n    A[N - 1, N - 1] = k_face[N - 2] / dx + 2 * k_cv[N - 1] / dx\n    b[N - 1] = 2 * k_cv[N - 1] / dx * TL\n    \n    # Solve for temperature vector T\n    T_num = np.linalg.solve(A, b)\n    return T_num\n\ndef _process_case(L, a, k1, k2, T0, TL, N):\n    \"\"\"\n    Handles all calculations for a single test case.\n    \"\"\"\n    dx = L / N\n    x_centers = (np.arange(N) + 0.5) * dx\n\n    # Get exact solution at cell centers\n    T_exact = _get_exact_solution(x_centers, L, a, k1, k2, T0, TL)\n\n    # Get numerical solutions\n    T_harm = _solve_fvm(N, L, a, k1, k2, T0, TL, 'harmonic')\n    T_arith = _solve_fvm(N, L, a, k1, k2, T0, TL, 'arithmetic')\n\n    # Calculate errors\n    norm_factor = abs(TL - T0)\n    if norm_factor == 0:\n        # If T0==TL, exact solution is T0 everywhere. Use absolute error instead.\n        norm_factor = 1.0 \n\n    # Harmonic mean errors\n    err_harm = T_harm - T_exact\n    E2_harm = np.sqrt(np.mean(err_harm**2)) / norm_factor\n    Einf_harm = np.max(np.abs(err_harm)) / norm_factor\n\n    # Arithmetic mean errors\n    err_arith = T_arith - T_exact\n    E2_arith = np.sqrt(np.mean(err_arith**2)) / norm_factor\n    Einf_arith = np.max(np.abs(err_arith)) / norm_factor\n\n    return [E2_harm, E2_arith, Einf_harm, Einf_arith]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'L': 1, 'a': 0.3, 'k1': 1, 'k2': 10, 'T0': 0, 'TL': 1, 'N': 40},\n        {'L': 1, 'a': 0.5, 'k1': 1, 'k2': 10, 'T0': 0, 'TL': 1, 'N': 20},\n        {'L': 1, 'a': 0.6, 'k1': 5, 'k2': 5, 'T0': 0, 'TL': 1, 'N': 30},\n        {'L': 1, 'a': 0.45, 'k1': 1, 'k2': 10**6, 'T0': 0, 'TL': 1, 'N': 60},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _process_case(**case)\n        results.append(result)\n    \n    # Final print statement in the exact required format.\n    # Convert list of lists to string and remove spaces for compactness.\n    final_output = str(results).replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}