{
    "hands_on_practices": [
        {
            "introduction": "A fundamental sanity check for any numerical scheme is its ability to exactly preserve a constant field, a property known as zeroth-order consistency. This exercise asks you to verify this essential property for both cell-centered and vertex-centered finite volume schemes in the context of an advection-diffusion problem . By demonstrating that the net flux across a control volume is zero for a constant temperature field, you will reinforce your understanding of how flux discretizations and the geometric properties of control volumes ensure conservation.",
            "id": "3939387",
            "problem": "Consider a $2$-dimensional, steady, source-free advection–diffusion of temperature $T$ for a passive scalar on a square domain of side length $L$, with periodic boundaries on all sides. The thermal conductivity $k$, mass density $\\rho$, and specific heat at constant pressure $c_{p}$ are all positive constants. The velocity field is constant and divergence-free, $\\boldsymbol{u}=(u_{0},v_{0})$, with $u_{0}$ and $v_{0}$ constant in space and time. The governing physical principle is the integrated conservation of energy over any control volume: the net outward diffusive plus advective heat flux across its boundary must vanish in steady state when there is no source term. You will examine two discretizations: a cell-centered scheme and a vertex-centered scheme, both formulated within the Finite Volume Method (FVM).\n\nDefine a uniform Cartesian partition of the domain into $N_{x}\\times N_{y}$ rectangular primal cells of size $\\Delta x=L/N_{x}$ and $\\Delta y=L/N_{y}$. In the cell-centered scheme, the control volumes are the primal cells and the unknowns $T_{i,j}$ reside at cell centers. In the vertex-centered scheme, the control volumes are median-dual rectangles built around mesh vertices and the unknowns $T_{i,j}$ reside at the vertices.\n\nStarting from the integral conservation statement for steady, source-free advection–diffusion and using only the most basic two-point face-normal gradient approximation for diffusion and a face-value interpolation for advection that is bounded and consistent on uniform fields, construct the discrete net outward flux across the boundary of:\n- an arbitrary interior primal cell for the cell-centered scheme, and\n- the corresponding interior dual control volume around a vertex for the vertex-centered scheme.\n\nAssume the face area for vertical faces is $\\Delta y$ and for horizontal faces is $\\Delta x$, and the outward unit normal on each face points from the interior of the control volume to the exterior. Let the test field be constant, $T\\equiv C$, with $C$ a finite real constant. Compute, in closed form, the discrete net flux sums for both schemes under this test and return your answer as the ordered pair $\\left(R_{\\mathrm{CC}},R_{\\mathrm{VC}}\\right)$, where $R_{\\mathrm{CC}}$ is the discrete residual (net outward flux) for the cell-centered control volume and $R_{\\mathrm{VC}}$ is the discrete residual for the vertex-centered control volume. Express the final answer as a dimensionless quantity. No rounding is required because the result is exact. The final answer must be a single row matrix containing the two values.",
            "solution": "The problem asks for the discrete net outward flux (residual) for a cell-centered (CC) and a vertex-centered (VC) finite volume scheme, when the temperature field is a constant, $T \\equiv C$.\n\nThe governing physical principle is the integral conservation of energy for a steady, source-free system. For any control volume $\\Omega_{\\text{CV}}$, this is expressed as:\n$$\n\\oint_{\\partial\\Omega_{\\text{CV}}} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\, dA = 0\n$$\nwhere $\\boldsymbol{n}$ is the outward unit normal vector on the boundary $\\partial\\Omega_{\\text{CV}}$, and $\\boldsymbol{F}$ is the total heat flux vector. The total heat flux is the sum of the diffusive flux (Fourier's law) and the advective flux:\n$$\n\\boldsymbol{F} = -k \\nabla T + \\rho c_p \\boldsymbol{u} T\n$$\nHere, the thermal conductivity $k$, mass density $\\rho$, specific heat $c_p$, and velocity field $\\boldsymbol{u}=(u_0, v_0)$ are all constants.\n\nIn the Finite Volume Method (FVM), the integral is approximated by a sum over the discrete faces $f$ that form the boundary of the control volume:\n$$\nR \\equiv \\sum_{f \\in \\partial\\Omega_{\\text{CV}}} (\\boldsymbol{F}_f \\cdot \\boldsymbol{n}_f) A_f\n$$\nwhere $R$ is the discrete residual, or the net outward flux. $\\boldsymbol{F}_f$ is the approximation of the flux vector at the center of face $f$, $\\boldsymbol{n}_f$ is the outward unit normal to face $f$, and $A_f$ is the area of face $f$.\n\nThe total flux through a face $f$ can be split into its diffusive and advective components:\n$$\nF_f = (\\boldsymbol{F}_f \\cdot \\boldsymbol{n}_f) A_f = \\underbrace{\\left(-k (\\nabla T)_f \\cdot \\boldsymbol{n}_f\\right) A_f}_{F_{\\text{diff},f}} + \\underbrace{\\left((\\rho c_p \\boldsymbol{u} T)_f \\cdot \\boldsymbol{n}_f\\right) A_f}_{F_{\\text{adv},f}}\n$$\nWe need to evaluate the total residual $R = \\sum_f (F_{\\text{diff},f} + F_{\\text{adv},f})$ for the specific test case where the temperature field is a constant, $T(x,y) = C$.\n\nLet's analyze the contribution of each flux type.\n\n1.  **Diffusive Flux Contribution:**\nThe problem specifies using \"the most basic two-point face-normal gradient approximation\". For any face $f$ separating two nodes (either cell centers or vertices) denoted $P$ and $N$ (for 'primary' and 'neighbor'), the gradient component normal to the face is approximated as:\n$$\n(\\nabla T)_f \\cdot \\boldsymbol{n}_f \\approx \\frac{T_N - T_P}{d_{PN}}\n$$\nwhere $T_P$ and $T_N$ are the temperature values at the nodes, and $d_{PN}$ is the perpendicular distance between them.\nIn the test case, the temperature field is constant, $T \\equiv C$. This means that the temperature at every node in the mesh is $C$. Thus, for any face, $T_N = C$ and $T_P = C$.\nThe normal gradient approximation becomes:\n$$\n(\\nabla T)_f \\cdot \\boldsymbol{n}_f \\approx \\frac{C-C}{d_{PN}} = 0\n$$\nConsequently, the diffusive flux through any face is zero:\n$$\nF_{\\text{diff},f} = -k \\left( (\\nabla T)_f \\cdot \\boldsymbol{n}_f \\right) A_f = -k(0)A_f = 0\n$$\nThis holds true for every face of any control volume, regardless of whether the scheme is cell-centered or vertex-centered. Therefore, the sum of diffusive fluxes over all faces of the control volume is zero:\n$$\nR_{\\text{diff}} = \\sum_f F_{\\text{diff},f} = 0\n$$\n\n2.  **Advective Flux Contribution:**\nThe advective flux through a face $f$ is given by $F_{\\text{adv},f} = ((\\rho c_p \\boldsymbol{u} T)_f \\cdot \\boldsymbol{n}_f) A_f$. The material properties $\\rho, c_p$ and the velocity $\\boldsymbol{u}$ are constant. The term $T_f$ is the temperature interpolated to the face center.\nThe problem states that the face-value interpolation scheme is \"consistent on uniform fields\". A constant field $T(x,y)=C$ is a uniform field. Consistency means that the interpolation must recover the constant value exactly. Therefore, for any face $f$, the interpolated temperature is $T_f = C$.\n\nWith $T_f = C$ and all other properties being constant, the advective flux through face $f$ is:\n$$\nF_{\\text{adv},f} = (\\rho c_p \\boldsymbol{u} C \\cdot \\boldsymbol{n}_f) A_f\n$$\nSince $\\rho, c_p, C,$ and $\\boldsymbol{u}$ are constant, we can factor them out of the dot product:\n$$\nF_{\\text{adv},f} = \\rho c_p C (\\boldsymbol{u} \\cdot \\boldsymbol{n}_f) A_f\n$$\nThe total advective contribution to the residual is the sum over all faces of the control volume:\n$$\nR_{\\text{adv}} = \\sum_f F_{\\text{adv},f} = \\sum_f \\rho c_p C (\\boldsymbol{u} \\cdot \\boldsymbol{n}_f) A_f\n$$\nWe can factor out the constants from the summation:\n$$\nR_{\\text{adv}} = \\rho c_p C \\boldsymbol{u} \\cdot \\left( \\sum_f \\boldsymbol{n}_f A_f \\right)\n$$\nThe term $\\sum_f \\boldsymbol{n}_f A_f$ is the sum of area-weighted outward normal vectors for a closed control volume. For any closed polyhedron, this sum is identically zero. This is a fundamental geometric property, the discrete analogue of the Gauss's theorem identity $\\oint_S \\boldsymbol{n} \\, dA = \\boldsymbol{0}$ for a closed surface $S$.\n\nLet's verify this for the rectangular control volumes in question. Both the primal cells (for CC) and the median-dual cells (for VC on a uniform grid) are rectangles of size $\\Delta x \\times \\Delta y$. Let's denote the east, west, north, and south faces by $e, w, n, s$.\nThe outward-pointing, area-weighted normal vectors are:\n-   $\\boldsymbol{n}_e A_e = (1, 0) \\Delta y$\n-   $\\boldsymbol{n}_w A_w = (-1, 0) \\Delta y$\n-   $\\boldsymbol{n}_n A_n = (0, 1) \\Delta x$\n-   $\\boldsymbol{n}_s A_s = (0, -1) \\Delta x$\nSumming these vectors gives:\n$$\n\\sum_f \\boldsymbol{n}_f A_f = (1, 0)\\Delta y + (-1, 0)\\Delta y + (0, 1)\\Delta x + (0, -1)\\Delta x = (\\Delta y - \\Delta y, \\Delta x - \\Delta x) = (0, 0) = \\boldsymbol{0}\n$$\nThis geometric identity holds for both primal and dual control volumes. Therefore, the total advective flux is:\n$$\nR_{\\text{adv}} = \\rho c_p C \\boldsymbol{u} \\cdot \\boldsymbol{0} = 0\n$$\n\n**Conclusion for Both Schemes:**\nThe total residual $R$ is the sum of the diffusive and advective residuals.\n$$\nR = R_{\\text{diff}} + R_{\\text{adv}} = 0 + 0 = 0\n$$\nThis result is independent of the specific choice of cell-centered or vertex-centered schemes, as long as a) the control volumes are closed polygons (which they are), b) the diffusive flux approximation vanishes for a constant field, and c) the advective flux approximation is consistent for a constant field. The problem statement guarantees these conditions.\n\nTherefore, the discrete net flux sum for the cell-centered scheme is $R_{\\mathrm{CC}} = 0$, and for the vertex-centered scheme it is $R_{\\mathrm{VC}} = 0$. The requested ordered pair is $(R_{\\mathrm{CC}}, R_{\\mathrm{VC}}) = (0, 0)$. The value $0$ is a dimensionless number.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "After confirming basic consistency, the next step is to evaluate how these schemes handle a simple, non-trivial problem and compute a key engineering quantity. This practice challenges you to analyze a classic steady-state conduction problem where the temperature varies linearly . You will compare the boundary heat flux calculated by a cell-centered scheme (as a face-averaged quantity) with that from a vertex-centered scheme (as a nodal quantity), providing valuable insight into how the placement of unknowns affects boundary condition implementation and flux calculation.",
            "id": "3939451",
            "problem": "Consider steady-state heat conduction in a homogeneous, isotropic material with constant thermal conductivity $k$ occupying the unit square domain $\\Omega = \\{(x,y) \\mid 0 \\leq x \\leq 1, 0 \\leq y \\leq 1\\}$. The governing equation is the Laplace equation $ \\nabla^{2} T = 0$ with boundary conditions $T(0,y) = 1$, $T(1,y) = 0$ for $0 \\leq y \\leq 1$, and adiabatic (homogeneous Neumann) boundaries on the top and bottom, i.e., $\\partial T/\\partial y = 0$ at $y=0$ and $y=1$. There is no internal heat generation. \n\nOn a family of uniform Cartesian meshes, compare two finite volume formulations:\n- a cell-centered Finite Volume Method (FVM), where unknowns are located at cell centers and boundary fluxes are evaluated conservatively at boundary faces using a second-order accurate treatment of Dirichlet boundaries consistent with the scheme, and\n- a vertex-centered FVM, where unknowns are located at mesh vertices, control volumes are constructed around vertices, and boundary-normal fluxes at boundary vertices are evaluated using a second-order accurate one-sided approximation consistent with the scheme.\n\nFor each formulation, define the boundary-normal heat flux using Fourier’s law, $ \\mathbf{q} = -k \\nabla T$, and construct the area-averaged boundary-normal flux across the left boundary $x=0$ as follows:\n- For the cell-centered scheme, compute a face-based flux on each boundary face along $x=0$ and average over all such faces (each face has equal length on the uniform mesh).\n- For the vertex-centered scheme, compute a pointwise nodal boundary-normal flux at each boundary vertex on $x=0$ and average over all such vertices.\n\nLet $q_{\\mathrm{CC}}$ denote the area-averaged boundary-normal flux magnitude from the cell-centered scheme and $q_{\\mathrm{VC}}$ denote the average of nodal boundary-normal flux magnitudes from the vertex-centered scheme. Work from first principles (the governing equation, boundary conditions, and Fourier’s law), and derive expressions for $q_{\\mathrm{CC}}$ and $q_{\\mathrm{VC}}$ on this problem. Then, compute the ratio \n$$ R = \\frac{q_{\\mathrm{CC}}}{q_{\\mathrm{VC}}}. $$\nReport $R$ as a dimensionless number. Round your answer to four significant figures. If you compute fluxes at any stage, express them in $\\mathrm{W/m^{2}}$.",
            "solution": "To find the ratio $R = q_{\\mathrm{CC}} / q_{\\mathrm{VC}}$, we first determine the analytical solution to the problem and then compute the boundary flux for each scheme.\n\n### 1. Analytical Solution and Exact Flux\n\nThe problem describes 1D heat flow in the x-direction. The governing equation $\\nabla^2 T = 0$ simplifies to $\\frac{d^2 T}{dx^2} = 0$. The general solution is $T(x) = Ax + B$.\nApplying the boundary conditions:\n- $T(0) = A(0) + B = 1 \\implies B = 1$.\n- $T(1) = A(1) + 1 = 0 \\implies A = -1$.\nThe exact temperature profile is $T(x,y) = 1 - x$. This solution also satisfies the adiabatic conditions on the top and bottom boundaries ($\\partial T / \\partial y = 0$).\n\nThe heat flux is given by Fourier's law, $\\mathbf{q} = -k \\nabla T$. The temperature gradient is $\\nabla T = (\\frac{\\partial T}{\\partial x}, \\frac{\\partial T}{\\partial y}) = (-1, 0)$.\nThe flux vector is constant throughout the domain: $\\mathbf{q} = -k(-1, 0) = (k, 0)$.\nThe boundary-normal flux magnitude at the left boundary ($x=0$) is the magnitude of the x-component of the flux, which is $|q_x| = k$. Since the flux is uniform, the exact area-averaged flux is $q_{\\text{exact}} = k$.\n\n### 2. Cell-Centered (CC) Scheme Flux, $q_{\\mathrm{CC}}$\n\nFor the cell-centered scheme, a standard second-order accurate flux treatment for a Dirichlet boundary uses a ghost cell.\n- Let cell 1 be centered at $x_1 = \\Delta x/2$. Let the fictitious ghost cell be centered at $x_G = -\\Delta x/2$.\n- The numerical scheme is exact for a linear temperature profile, so the solution at the cell center is $T_1 = T(x_1) = 1 - \\Delta x/2$.\n- To enforce the boundary condition $T(0)=1$ in a way that is second-order accurate, the value at the boundary is set as the average of the neighboring nodal values: $T_b = (T_1 + T_G)/2$.\n- We can solve for the required ghost cell value: $1 = ( (1 - \\Delta x/2) + T_G )/2 \\implies 2 = 1 - \\Delta x/2 + T_G \\implies T_G = 1 + \\Delta x/2$.\n- The flux at the boundary face ($x=0$) is computed using a central difference centered on the face:\n$$ q_{\\mathrm{CC}} = \\left| -k \\frac{T_1 - T_G}{x_1 - x_G} \\right| = \\left| -k \\frac{(1-\\Delta x/2) - (1+\\Delta x/2)}{\\Delta x} \\right| = \\left| -k \\frac{-\\Delta x}{\\Delta x} \\right| = k $$\nSince this flux is constant for all boundary faces, the area-averaged flux is $q_{\\mathrm{CC}} = k$.\n\n### 3. Vertex-Centered (VC) Scheme Flux, $q_{\\mathrm{VC}}$\n\nIn a vertex-centered scheme, the nodes lie on the mesh vertices. The numerical solution will be exact at the nodes for this linear problem. For any vertex $(i,j)$, the temperature is $T_{i,j} = 1 - i\\Delta x$.\n- $T_{0,j} = T(0, y_j) = 1$\n- $T_{1,j} = T(\\Delta x, y_j) = 1 - \\Delta x$\n- $T_{2,j} = T(2\\Delta x, y_j) = 1 - 2\\Delta x$\nThe problem specifies using a second-order accurate one-sided approximation for the boundary-normal gradient at the boundary vertices ($x=0$). The standard three-point forward difference formula is:\n$$ \\frac{\\partial T}{\\partial x}\\bigg|_{x=0} \\approx \\frac{-3T_{0,j} + 4T_{1,j} - T_{2,j}}{2\\Delta x} $$\nSubstituting the exact nodal values:\n$$ \\frac{\\partial T}{\\partial x}\\bigg|_{x=0} \\approx \\frac{-3(1) + 4(1 - \\Delta x) - (1 - 2\\Delta x)}{2\\Delta x} = \\frac{-3 + 4 - 4\\Delta x - 1 + 2\\Delta x}{2\\Delta x} = \\frac{-2\\Delta x}{2\\Delta x} = -1 $$\nThe gradient is computed exactly. The nodal boundary-normal flux magnitude is $|-k \\frac{\\partial T}{\\partial x}| = |-k(-1)| = k$.\nSince this value is the same for all vertices on the left boundary, the average nodal flux is $q_{\\mathrm{VC}} = k$.\n\n### 4. Final Ratio\n\nThe ratio is:\n$$ R = \\frac{q_{\\mathrm{CC}}}{q_{\\mathrm{VC}}} = \\frac{k}{k} = 1 $$\nThe result is exactly 1. Expressed to four significant figures, this is 1.000.",
            "answer": "$$\\boxed{1.000}$$"
        }
    ]
}