{
    "hands_on_practices": [
        {
            "introduction": "A critical challenge in implementing finite-volume methods on collocated grids is the potential for pressure-velocity decoupling, where non-physical, oscillatory pressure fields produce no signal in the discrete continuity equation. This hands-on exercise guides you through a classic numerical experiment to demonstrate this very issue, revealing how naive interpolation fails and how the Rhie-Chow interpolation scheme elegantly restores the necessary coupling between pressure and velocity. ",
            "id": "3993353",
            "problem": "Consider a one-dimensional, periodic, uniform collocated finite-volume mesh with $N$ cells, cell width $\\Delta x = 1/N$, dimensionless density $\\rho = 1$, and a diagonal momentum coefficient $a_u > 0$ that represents the local implicit treatment of the momentum equation in Pressure Implicit with Splitting of Operators (PISO). The goal is to construct a numerical example that reveals odd–even decoupling artifacts in face mass flux when face velocities are formed by naive linear interpolation of cell-centered velocities on a collocated mesh, and to show that the Rhie–Chow face interpolation restores coupling by tying the face mass flux directly to the pressure gradient at the face. All quantities are dimensionless. \n\nStart from the discrete incompressible momentum correction for the cell-centered velocity due to pressure, which is consistent with the PISO predictor–corrector framework: \n$$\nu_i = -\\frac{1}{a_u}\\left.\\frac{\\partial p}{\\partial x}\\right|_{x_i} \\approx -\\frac{1}{a_u}\\frac{p_{i+1}-p_{i-1}}{2\\Delta x},\n$$\nwhere $u_i$ and $p_i$ are the cell-centered velocity and pressure at cell index $i$ with periodic indexing. The discrete face mass flux on a collocated mesh is required to enter the continuity equation in PISO through the discrete divergence operator:\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i \\approx \\frac{u_{i+1/2} - u_{i-1/2}}{\\Delta x},\n$$\nwhere $u_{i+1/2}$ is the velocity interpolated at the face between cells $i$ and $i+1$.\n\nDefine the following two face interpolation strategies:\n- Naive linear interpolation of the cell-centered velocities:\n$$\nu_{i+1/2}^{\\text{naive}} = \\frac{1}{2}\\left(u_i + u_{i+1}\\right).\n$$\n- Rhie–Chow interpolation computed directly from the face pressure gradient and the momentum coefficient:\n$$\nu_{i+1/2}^{\\text{RC}} = -\\frac{1}{a_u}\\frac{p_{i+1}-p_i}{\\Delta x}.\n$$\n\nTask:\n1. Construct a checkerboard pressure field $p_i = A(-1)^i$ with amplitude $A > 0$ for a given $N$ and $\\Delta x = 1/N$, using periodic indexing. \n2. Compute the cell-centered pressure-correction velocity $u_i$ from the cell-centered pressure gradient using the above discrete approximation.\n3. Compute the discrete divergence $\\left(\\nabla \\cdot \\mathbf{u}\\right)_i$ using the naive face interpolation $u_{i+1/2}^{\\text{naive}}$ and separately using the Rhie–Chow face interpolation $u_{i+1/2}^{\\text{RC}}$, and report the root-mean-square (RMS) of the divergence for each method:\n$$\n\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1}\\left(\\left(\\nabla \\cdot \\mathbf{u}\\right)_i\\right)^2}.\n$$\n4. Using a tolerance $T_{\\text{small}} = 10^{-12}$ and $T_{\\text{large}} = 10^{-6}$, produce for each test case a boolean result that is true if and only if the naive interpolation produces $\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS}} \\le T_{\\text{small}}$ and the Rhie–Chow interpolation produces $\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS}} \\ge T_{\\text{large}}$. This quantifies the decoupling artifact for the naive interpolation and the corrective coupling with Rhie–Chow.\n\nFundamental base for derivation and algorithm design:\n- Mass conservation for incompressible flow requires $\\nabla \\cdot \\mathbf{u} = 0$.\n- The discrete momentum correction in PISO links velocity to pressure gradient through $u = u^* - \\frac{1}{a_u}\\nabla p$, where $u^*$ is the predicted velocity. In this test we isolate the pressure-correction contribution by setting $u^* = 0$.\n- The collocated-grid face mass flux must be coupled to the cell pressure to prevent odd–even decoupling; Rhie–Chow achieves this via an implicit pressure gradient at faces.\n\nTest suite and parameters:\n- Case $1$: $N = 8$, $a_u = 1.0$, $A = 1.0$.\n- Case $2$: $N = 9$, $a_u = 0.5$, $A = 1.0$.\n- Case $3$: $N = 2$, $a_u = 1.0$, $A = 0.3$.\n\nYour program must:\n- Implement the computations above for each test case.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$, where each $\\text{result}_k$ is the boolean value for case $k$ as described in item $4$.\n- All results are dimensionless; no physical units are required.\n\nThe problem is designed to be solved in any modern programming language and focuses on algorithmic reasoning grounded in the governing equations of incompressible flow and the PISO pressure–velocity coupling. No shortcuts are allowed beyond the stated discrete relations and definitions; all symbols, variables, and numbers must be treated exactly as specified.",
            "solution": "The problem statement is parsed and validated as scientifically sound, well-posed, and complete. It presents a well-defined numerical experiment in computational fluid dynamics to demonstrate the pressure-velocity decoupling phenomenon on collocated grids and its remedy using Rhie–Chow interpolation.\n\nThe core task is to analyze the behavior of two different face velocity interpolation schemes when subjected to a checkerboard pressure field, which is known to excite non-physical oscillations that naive schemes fail to detect. The analysis will proceed by deriving the discrete divergence for each scheme and then evaluating the results for the given test cases.\n\n**1. Cell-Centered Velocity ($u_i$) from the Checkerboard Pressure Field**\n\nThe analysis begins with the specified checkerboard pressure field on a periodic domain with $N$ cells:\n$$\np_i = A(-1)^i\n$$\nwhere $i \\in \\{0, 1, \\dots, N-1\\}$. The cell-centered velocity, $u_i$, is given by the discrete momentum correction formula, which approximates the pressure gradient at the cell center $x_i$:\n$$\nu_i = -\\frac{1}{a_u}\\frac{p_{i+1}-p_{i-1}}{2\\Delta x}\n$$\nDue to the periodic nature of the domain, the indices are handled modulo $N$. The pressure at neighboring cells $i+1$ and $i-1$ are:\n$$\np_{i+1} = A(-1)^{i+1} = -A(-1)^i = -p_i\n$$\n$$\np_{i-1} = A(-1)^{i-1} = A(-1)^{i+1} = -A(-1)^i = -p_i\n$$\nFrom this, it is clear that $p_{i+1} = p_{i-1}$. Substituting this into the equation for $u_i$:\n$$\nu_i = -\\frac{1}{a_u}\\frac{p_{i-1}-p_{i-1}}{2\\Delta x} = -\\frac{1}{a_u}\\frac{0}{2\\Delta x} = 0\n$$\nThus, for the checkerboard pressure field, the discrete cell-centered velocity is identically zero for all cells, $u_i = 0$ for all $i$. This result is independent of $N$, $A$, and $a_u$.\n\n**2. Divergence Calculation with Naive Linear Interpolation**\n\nThe first method for interpolating velocity to the cell face $i+1/2$ is naive linear interpolation:\n$$\nu_{i+1/2}^{\\text{naive}} = \\frac{1}{2}\\left(u_i + u_{i+1}\\right)\n$$\nSince we found that $u_i = 0$ for all $i$, the face velocity is also identically zero:\n$$\nu_{i+1/2}^{\\text{naive}} = \\frac{1}{2}\\left(0 + 0\\right) = 0\n$$\nThe discrete divergence at cell $i$ is defined as:\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i = \\frac{u_{i+1/2} - u_{i-1/2}}{\\Delta x}\n$$\nUsing the naive face velocities, we get:\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i^{\\text{naive}} = \\frac{0 - 0}{\\Delta x} = 0\n$$\nThe divergence is zero for all cells. Consequently, its root-mean-square (RMS) norm is also zero:\n$$\n\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, naive}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1}(0)^2} = 0\n$$\nThis result demonstrates the critical flaw of naive interpolation on a collocated grid: it is blind to the checkerboard pressure mode. The continuity equation, discretized this way, fails to detect the non-zero pressure oscillations, an effect known as odd-even decoupling.\n\n**3. Divergence Calculation with Rhie–Chow Interpolation**\n\nThe Rhie–Chow interpolation constructs the face velocity not from cell-centered velocities, but directly from the pressure gradient at the face:\n$$\nu_{i+1/2}^{\\text{RC}} = -\\frac{1}{a_u}\\frac{p_{i+1}-p_i}{\\Delta x}\n$$\nSubstituting the checkerboard pressure field, $p_i = A(-1)^i$ and $p_{i+1} = -p_i = -A(-1)^i$:\n$$\np_{i+1}-p_i = -A(-1)^i - A(-1)^i = -2A(-1)^i\n$$\nThe Rhie-Chow face velocity is therefore:\n$$\nu_{i+1/2}^{\\text{RC}} = -\\frac{1}{a_u \\Delta x} \\left(-2A(-1)^i\\right) = \\frac{2A}{a_u \\Delta x}(-1)^i\n$$\nThis velocity is non-zero and oscillatory, correctly reflecting the underlying pressure oscillations. Now, we compute the divergence at cell $i$:\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i^{\\text{RC}} = \\frac{u_{i+1/2}^{\\text{RC}} - u_{i-1/2}^{\\text{RC}}}{\\Delta x}\n$$\nThe velocity at the preceding face, $u_{i-1/2}^{\\text{RC}}$, is found by replacing $i$ with $i-1$ in the face velocity formula:\n$$\nu_{i-1/2}^{\\text{RC}} = \\frac{2A}{a_u \\Delta x}(-1)^{i-1} = -\\frac{2A}{a_u \\Delta x}(-1)^i\n$$\nThe difference in face velocities is:\n$$\nu_{i+1/2}^{\\text{RC}} - u_{i-1/2}^{\\text{RC}} = \\frac{2A}{a_u \\Delta x}(-1)^i - \\left(-\\frac{2A}{a_u \\Delta x}(-1)^i\\right) = \\frac{4A}{a_u \\Delta x}(-1)^i\n$$\nSubstituting this into the divergence formula gives:\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i^{\\text{RC}} = \\frac{1}{\\Delta x} \\left( \\frac{4A}{a_u \\Delta x}(-1)^i \\right) = \\frac{4A}{a_u (\\Delta x)^2}(-1)^i\n$$\nUsing $\\Delta x = 1/N$, the divergence becomes:\n$$\n\\left(\\nabla \\cdot \\mathbf{u}\\right)_i^{\\text{RC}} = \\frac{4AN^2}{a_u}(-1)^i\n$$\nThe discrete divergence is non-zero, demonstrating that the Rhie-Chow scheme successfully couples the pressure and velocity fields. To quantify this, we compute the RMS norm:\n$$\n\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}}^2 = \\frac{1}{N}\\sum_{i=0}^{N-1}\\left(\\left(\\nabla \\cdot \\mathbf{u}\\right)_i^{\\text{RC}}\\right)^2 = \\frac{1}{N}\\sum_{i=0}^{N-1}\\left(\\frac{4AN^2}{a_u}(-1)^i\\right)^2\n$$\nSince $((-1)^i)^2 = 1$, the term in the sum is constant.\n$$\n\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}}^2 = \\frac{1}{N} \\cdot N \\cdot \\left(\\frac{4AN^2}{a_u}\\right)^2 = \\left(\\frac{4AN^2}{a_u}\\right)^2\n$$\nTaking the square root, and noting that $A, N, a_u$ are positive, we get:\n$$\n\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}} = \\frac{4AN^2}{a_u}\n$$\n\n**4. Evaluation of Test Cases**\n\nThe boolean condition to be checked is $\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, naive}} \\le T_{\\text{small}}$ AND $\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}} \\ge T_{\\text{large}}$, with $T_{\\text{small}} = 10^{-12}$ and $T_{\\text{large}} = 10^{-6}$.\n\n- For the naive method, we found $\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, naive}} = 0$. The condition $0 \\le 10^{-12}$ is always true.\n- For the Rhie-Chow method, we must check if $\\frac{4AN^2}{a_u} \\ge 10^{-6}$.\n\n**Case 1**: $N = 8$, $a_u = 1.0$, $A = 1.0$\n$\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}} = \\frac{4(1.0)(8^2)}{1.0} = 4 \\times 64 = 256$.\nSince $256 \\ge 10^{-6}$, the condition is true.\n\n**Case 2**: $N = 9$, $a_u = 0.5$, $A = 1.0$\n$\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}} = \\frac{4(1.0)(9^2)}{0.5} = 8 \\times 81 = 648$.\nSince $648 \\ge 10^{-6}$, the condition is true.\n\n**Case 3**: $N = 2$, $a_u = 1.0$, $A = 0.3$\n$\\| \\nabla \\cdot \\mathbf{u} \\|_{\\text{RMS, RC}} = \\frac{4(0.3)(2^2)}{1.0} = 4 \\times 0.3 \\times 4 = 4.8$.\nSince $4.8 \\ge 10^{-6}$, the condition is true.\n\nIn all three cases, the numerical experiment is expected to demonstrate the decoupling artifact for the naive interpolation and the corrective coupling provided by the Rhie-Chow scheme. Therefore, the boolean condition will be met for all test cases. The final result is a list of three true values.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of demonstrating odd-even decoupling on a collocated\n    grid and its correction by Rhie-Chow interpolation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, a_u, A)\n        (8, 1.0, 1.0),\n        (9, 0.5, 1.0),\n        (2, 1.0, 0.3),\n    ]\n\n    T_small = 1e-12\n    T_large = 1e-6\n    \n    results = []\n    for N, a_u, A in test_cases:\n        # 1. Define grid parameters and the checkerboard pressure field p_i.\n        dx = 1.0 / N\n        indices = np.arange(N)\n        p = A * (-1)**indices\n\n        # 2. Compute the cell-centered velocity u_i from the pressure gradient.\n        # u_i = -1/a_u * (p_{i+1} - p_{i-1}) / (2*dx)\n        # np.roll provides periodic boundary handling.\n        p_plus1 = np.roll(p, -1)\n        p_minus1 = np.roll(p, 1)\n        u = (-1.0 / a_u) * (p_plus1 - p_minus1) / (2.0 * dx)\n\n        # 3. Compute divergence using Naive Linear Interpolation.\n        # Face velocity: u_{i+1/2}^naive = 0.5 * (u_i + u_{i+1})\n        u_plus1 = np.roll(u, -1)\n        u_face_naive = 0.5 * (u + u_plus1)\n\n        # Divergence: (div u)_i = (u_{i+1/2} - u_{i-1/2}) / dx\n        u_face_naive_minus1 = np.roll(u_face_naive, 1)\n        div_u_naive = (u_face_naive - u_face_naive_minus1) / dx\n\n        # RMS of the naive divergence.\n        rms_naive = np.sqrt(np.mean(div_u_naive**2))\n\n        # 4. Compute divergence using Rhie-Chow Interpolation.\n        # Face velocity: u_{i+1/2}^RC = -1/a_u * (p_{i+1} - p_i) / dx\n        # p_plus1 is already available from the cell-centered velocity calculation.\n        u_face_rc = (-1.0 / a_u) * (p_plus1 - p) / dx\n        \n        # Divergence: (div u)_i = (u_{i+1/2} - u_{i-1/2}) / dx\n        u_face_rc_minus1 = np.roll(u_face_rc, 1)\n        div_u_rc = (u_face_rc - u_face_rc_minus1) / dx\n        \n        # RMS of the Rhie-Chow divergence.\n        rms_rc = np.sqrt(np.mean(div_u_rc**2))\n        \n        # 5. Evaluate the boolean condition as specified in the problem statement.\n        # The condition is true if naive interpolation shows decoupling (RMS is small)\n        # AND Rhie-Chow interpolation shows coupling (RMS is large).\n        condition_met = (rms_naive = T_small) and (rms_rc >= T_large)\n        results.append(condition_met)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The 'S' in PISO stands for 'Splitting of Operators,' a technique that introduces approximations to make the system solvable. This practice delves into the consequences of this splitting, specifically when an approximate inverse of the momentum matrix is used to form the pressure equation. By using Fourier analysis, you will quantify the residual divergence that remains after a single corrector step, providing a clear illustration of the splitting error and the fundamental reason why multiple corrector loops are often required to enforce incompressibility. ",
            "id": "3993373",
            "problem": "Consider a one-dimensional, periodic, uniform grid of length $L$ with $N$ control volumes and grid spacing $h=L/N$, discretizing the incompressible, constant-property momentum equation with a fully implicit mass term and viscous term. Let $\\rho$ denote the constant density and $\\mu$ the dynamic viscosity. Denote by $A$ the linear operator associated with the implicit mass-viscous block in the discrete momentum equation, by $G$ the discrete gradient operator, and by $D$ the discrete divergence operator, all constructed with second-order central differences. In a Pressure-Implicit with Splitting of Operators (PISO) algorithm, a predicted velocity $\\boldsymbol{u}^{\\ast}$ is obtained from the momentum equation using the known pressure, and a pressure correction $\\phi$ is determined to enforce incompressibility through a pressure equation assembled using an approximate inverse of $A$, denoted $\\tilde{A}^{-1}$. The velocity is then corrected with the exact inverse action of $A$ via the linear solve $A\\boldsymbol{w}=G\\phi$ and update $\\boldsymbol{u}^{n+1}=\\boldsymbol{u}^{\\ast}-\\boldsymbol{w}$. Assume the following:\n- The domain is one-dimensional and periodic with $L=1$.\n- The number of control volumes is $N=64$, so $h=1/64$.\n- The density is $\\rho=1$ and the dynamic viscosity is $\\mu=10^{-3}$.\n- The time step is $\\Delta t=10^{-3}$.\n- The approximate inverse used to assemble the pressure equation is the Jacobi (diagonal) inverse of $A$ in physical space, so that $\\tilde{A}^{-1}=\\alpha I$ with $\\alpha=\\left(\\frac{\\rho}{\\Delta t}+\\frac{2\\mu}{h^{2}}\\right)^{-1}$.\n- Use standard second-order central differences so that for a Fourier mode with wavenumber $k=\\frac{2\\pi n}{L}$, the discrete gradient and divergence symbols are $i\\tilde{k}$ with $\\tilde{k}=\\frac{2}{h}\\sin\\left(\\frac{k h}{2}\\right)$, and the Fourier symbol of $A$ is $a(k)=\\frac{\\rho}{\\Delta t}+\\mu \\tilde{k}^{2}$.\n\nSuppose the predicted velocity $\\boldsymbol{u}^{\\ast}$ has a nonzero divergence component consisting of a single Fourier mode with index $n=32$, that is, $D\\boldsymbol{u}^{\\ast}$ has Fourier amplitude $\\hat{b}\\neq 0$ only at $k=\\frac{2\\pi n}{L}$. After one PISO corrector in which the pressure equation is assembled with $\\tilde{A}^{-1}$ but the velocity correction is applied with the exact inverse action of $A$, quantify the ratio of the residual divergence amplitude to the initial divergence amplitude for this mode, that is, compute\n$$\nR=\\frac{|\\widehat{D\\boldsymbol{u}^{\\,n+1}}|}{|\\widehat{D\\boldsymbol{u}^{\\ast}}|},\n$$\nwhere hats denote Fourier amplitudes at wavenumber $k=\\frac{2\\pi n}{L}$.\n\nExpress your final answer as a dimensionless number and round to four significant figures.",
            "solution": "The problem asks for the ratio of the residual divergence amplitude to the initial divergence amplitude, $R = \\frac{|\\widehat{D\\boldsymbol{u}^{\\,n+1}}|}{|\\widehat{D\\boldsymbol{u}^{\\ast}}|}$, after one corrector step of a Pressure-Implicit with Splitting of Operators (PISO) algorithm. The analysis will be performed in Fourier space, as the given operators and initial condition are well-suited for this approach.\n\nLet $\\mathcal{F}(\\cdot)$ denote the Fourier transform, and $\\hat{f}(k) = \\mathcal{F}(f(x))$ be the Fourier amplitude of a function $f(x)$ at wavenumber $k$. The action of a linear differential or pseudo-differential operator in physical space corresponds to multiplication by its Fourier symbol in Fourier space.\n\nThe steps of the PISO corrector, as described in the problem, are:\n1.  A predicted velocity field $\\boldsymbol{u}^{\\ast}$ is known. Its divergence, $D\\boldsymbol{u}^{\\ast}$, is non-zero. We are given that $D\\boldsymbol{u}^{\\ast}$ consists of a single Fourier mode with index $n=32$. Let its Fourier amplitude at the corresponding wavenumber $k = \\frac{2\\pi n}{L}$ be $\\widehat{D\\boldsymbol{u}^{\\ast}} = \\hat{b}$.\n\n2.  A pressure correction, $\\phi$, is computed by solving a pressure equation. This equation is formed using an approximate inverse of the implicit mass-viscous operator $A$, denoted $\\tilde{A}^{-1}$. The governing equation for $\\phi$ is:\n    $$\n    (D \\tilde{A}^{-1} G) \\phi = D\\boldsymbol{u}^{\\ast}\n    $$\n    We transform this equation into Fourier space. The Fourier symbols for the discrete gradient operator $G$ and the discrete divergence operator $D$ are both given as $i\\tilde{k}$, where $\\tilde{k} = \\frac{2}{h}\\sin\\left(\\frac{k h}{2}\\right)$. The approximate inverse operator $\\tilde{A}^{-1}$ is given as $\\alpha I$, where $I$ is the identity operator and $\\alpha$ is a scalar constant. The Fourier symbol of $\\alpha I$ is simply $\\alpha$. Thus, the Fourier-transformed pressure equation is:\n    $$\n    (i\\tilde{k}) (\\alpha) (i\\tilde{k}) \\hat{\\phi} = \\widehat{D\\boldsymbol{u}^{\\ast}}\n    $$\n    $$\n    -\\alpha \\tilde{k}^2 \\hat{\\phi} = \\hat{b}\n    $$\n    Solving for the Fourier amplitude of the pressure correction, we get:\n    $$\n    \\hat{\\phi} = -\\frac{\\hat{b}}{\\alpha \\tilde{k}^2}\n    $$\n\n3.  The velocity field is corrected to obtain the new velocity $\\boldsymbol{u}^{n+1}$. The correction is performed using the exact inverse action of $A$. The update rule is $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{\\ast} - \\boldsymbol{w}$, where $\\boldsymbol{w}$ is the solution to $A\\boldsymbol{w} = G\\phi$.\n\n4.  We need to find the divergence of the corrected velocity, $D\\boldsymbol{u}^{n+1}$. Applying the divergence operator to the update rule:\n    $$\n    D\\boldsymbol{u}^{n+1} = D\\boldsymbol{u}^{\\ast} - D\\boldsymbol{w}\n    $$\n    From $A\\boldsymbol{w} = G\\phi$, we have $\\boldsymbol{w} = A^{-1}G\\phi$. Substituting this into the expression for the divergence gives:\n    $$\n    D\\boldsymbol{u}^{n+1} = D\\boldsymbol{u}^{\\ast} - D(A^{-1}G\\phi)\n    $$\n    Transforming this equation into Fourier space, we use the symbols for $D$, $G$, and $A$. The symbol for $A$ is given as $a(k) = \\frac{\\rho}{\\Delta t} + \\mu \\tilde{k}^2$, so the symbol for its inverse, $A^{-1}$, is $1/a(k)$.\n    $$\n    \\widehat{D\\boldsymbol{u}^{n+1}} = \\widehat{D\\boldsymbol{u}^{\\ast}} - \\mathcal{F}(D A^{-1} G \\phi) = \\hat{b} - (i\\tilde{k}) \\left(\\frac{1}{a(k)}\\right) (i\\tilde{k}) \\hat{\\phi}\n    $$\n    $$\n    \\widehat{D\\boldsymbol{u}^{n+1}} = \\hat{b} + \\frac{\\tilde{k}^2}{a(k)} \\hat{\\phi}\n    $$\n    Now, we substitute the expression for $\\hat{\\phi}$ from step 2:\n    $$\n    \\widehat{D\\boldsymbol{u}^{n+1}} = \\hat{b} + \\frac{\\tilde{k}^2}{a(k)} \\left( -\\frac{\\hat{b}}{\\alpha \\tilde{k}^2} \\right) = \\hat{b} - \\frac{\\hat{b}}{\\alpha a(k)} = \\hat{b} \\left( 1 - \\frac{1}{\\alpha a(k)} \\right)\n    $$\n\n5.  The desired ratio $R$ is the magnitude of the ratio of the Fourier amplitudes:\n    $$\n    R = \\frac{|\\widehat{D\\boldsymbol{u}^{n+1}}|}{|\\widehat{D\\boldsymbol{u}^{\\ast}}|} = \\frac{|\\hat{b} \\left( 1 - \\frac{1}{\\alpha a(k)} \\right)|}{|\\hat{b}|} = \\left| 1 - \\frac{1}{\\alpha a(k)} \\right| = \\left| 1 - \\frac{\\alpha^{-1}}{a(k)} \\right|\n    $$\n    Now we must compute the numerical values of the terms involved using the provided data:\n    -   $L=1$, $N=64$, so $h=L/N = 1/64$.\n    -   $\\rho=1$, $\\mu=10^{-3}$, $\\Delta t=10^{-3}$.\n    -   Fourier mode index $n=32$.\n\n    The wavenumber $k$ is:\n    $$\n    k = \\frac{2\\pi n}{L} = \\frac{2\\pi (32)}{1} = 64\\pi\n    $$\n    The effective wavenumber $\\tilde{k}$ is:\n    $$\n    \\tilde{k} = \\frac{2}{h} \\sin\\left(\\frac{k h}{2}\\right) = \\frac{2}{1/64} \\sin\\left(\\frac{(64\\pi)(1/64)}{2}\\right) = 128 \\sin\\left(\\frac{\\pi}{2}\\right) = 128\n    $$\n    The symbol of the exact operator $A$ is:\n    $$\n    a(k) = \\frac{\\rho}{\\Delta t} + \\mu \\tilde{k}^2 = \\frac{1}{10^{-3}} + 10^{-3} \\cdot (128)^2 = 1000 + 10^{-3} \\cdot 16384 = 1000 + 16.384 = 1016.384\n    $$\n    The term $\\alpha^{-1}$ is the diagonal of the operator $A$ in physical space, which is used to construct the approximate inverse $\\tilde{A}^{-1}$:\n    $$\n    \\alpha^{-1} = \\frac{\\rho}{\\Delta t} + \\frac{2\\mu}{h^2} = \\frac{1}{10^{-3}} + \\frac{2 \\cdot 10^{-3}}{(1/64)^2} = 1000 + 2 \\cdot 10^{-3} \\cdot 4096 = 1000 + 8.192 = 1008.192\n    $$\n    Finally, we compute the ratio $R$:\n    $$\n    R = \\left| 1 - \\frac{1008.192}{1016.384} \\right| = \\left| \\frac{1016.384 - 1008.192}{1016.384} \\right| = \\frac{8.192}{1016.384}\n    $$\n    $$\n    R \\approx 0.0080601509...\n    $$\n    Rounding the result to four significant figures gives $0.008060$.",
            "answer": "$$\n\\boxed{0.008060}\n$$"
        },
        {
            "introduction": "The performance of the PISO algorithm is not just determined by the corrector steps, but also by the initial momentum predictor. This exercise explores the profound impact of the time integration scheme used in the predictor step on the overall algorithm's behavior. You will quantitatively compare the Backward Euler and Crank-Nicolson schemes, exposing a fundamental trade-off between temporal accuracy and the numerical stiffness of the resulting pressure Poisson equation. ",
            "id": "3993384",
            "problem": "Consider incompressible flow in a straight channel of length $L$ with uniform cross-sectional area $A$, discretized by a one-dimensional uniform finite-volume mesh of $N$ control volumes of size $h = L/N$. The density is $\\rho$, the kinematic viscosity is $\\nu$, and the bulk speed is $U$ directed in the positive $x$ direction. The Reynolds number (Re) is defined as $Re = \\rho U L / \\mu$, where $\\mu = \\rho \\nu$ is the dynamic viscosity. The time step $\\Delta t$ is chosen such that the Courant number (defined as $Co = U \\Delta t / h$) equals $Co = 0.5$. Convection is discretized with first-order upwind and diffusion with second-order central differences. The Pressure Implicit with Splitting of Operators (PISO) algorithm is used to enforce continuity via a pressure correction equation after a momentum predictor step.\n\nFor the momentum predictor, consider a cell-lumped linear model obtained from the integral form of the momentum equation and linearized fluxes for convection and diffusion, neglecting the pressure gradient in the predictor. This yields a linear ordinary differential equation (ODE) for the predicted velocity $u(t)$ in each control volume of the form $\\rho h \\, \\frac{d u}{d t} = \\mathcal{R}(u)$, where $\\mathcal{R}(u)$ represents linearized convective and diffusive outfluxes. Express this ODE in the form $\\frac{d u}{d t} = \\lambda u$ by deriving the constant $\\lambda$ from first principles in terms of $\\rho$, $U$, $\\mu$, and $h$.\n\nNow, compare two time integration schemes for the predictor:\n- Backward Euler (fully implicit).\n- Crank–Nicolson (trapezoidal rule).\n\nStarting from the fundamental definition of each time integration scheme applied to the linear ODE $\\frac{d u}{d t} = \\lambda u$, derive the one-step numerical amplification factor for each scheme and the exact one-step amplification factor. Define the temporal accuracy metric $E$ for a given $\\Delta t$ as the absolute difference between the numerical one-step amplification factor and the exact one-step amplification factor. Compute $E$ for both schemes.\n\nIn PISO, the pressure correction equation is elliptic with a scalar coefficient arising from the momentum predictor’s left-hand-side diagonal entry $a_p$; under standard operator splitting, this scalar multiplies the pressure Laplacian and has the form $\\alpha = \\Delta t / a_p$. Derive $a_p$ for each time integration scheme from the same flux linearization and implicit treatment used in the predictor, and then obtain $\\alpha$ for each scheme. Define the pressure equation stiffness metric $S$ as $S = 1/\\alpha$ (larger $S$ corresponds to a stiffer pressure equation in the sense of smaller elliptic operator scaling). Compute the ratio $S_{\\mathrm{BE}} / S_{\\mathrm{CN}}$.\n\nUse the following numerical parameters to obtain concrete values:\n- $L = 1 \\,\\mathrm{m}$, $A = 1 \\,\\mathrm{m}^2$, $N = 10$.\n- $\\rho = 1 \\,\\mathrm{kg/m^3}$, $U = 1 \\,\\mathrm{m/s}$, $Re = 100$ (hence $\\mu = \\rho U L / Re$).\n- $Co = 0.5$ (so $\\Delta t = Co \\, h / U$).\n\nReport your final answer as a row matrix containing, in order,\n- the ratio of temporal accuracy metrics $R_E = E_{\\mathrm{BE}} / E_{\\mathrm{CN}}$,\n- the ratio of stiffness metrics $R_S = S_{\\mathrm{BE}} / S_{\\mathrm{CN}}$.\n\nRound each reported value to four significant figures. Express the final answer as dimensionless numbers.",
            "solution": "The problem statement is critically validated before attempting a solution.\n\n### Step 1: Extract Givens\n- Flow type: Incompressible flow in a straight channel.\n- Geometry: Length $L$, uniform cross-sectional area $A$.\n- Discretization: One-dimensional uniform finite-volume mesh, $N$ control volumes, size $h = L/N$.\n- Fluid properties: Density $\\rho$, kinematic viscosity $\\nu$, dynamic viscosity $\\mu = \\rho \\nu$.\n- Flow conditions: Bulk speed $U$ in the positive $x$ direction.\n- Dimensionless numbers: Reynolds number $Re = \\rho U L / \\mu$, Courant number $Co = U \\Delta t / h$.\n- Numerical schemes: Convection is discretized with first-order upwind, diffusion with second-order central differences. PISO algorithm is used.\n- Momentum predictor model: Neglecting the pressure gradient, the linearized ODE is $\\rho h \\, \\frac{d u}{d t} = \\mathcal{R}(u)$, which is to be expressed as $\\frac{d u}{d t} = \\lambda u$.\n- Time integration schemes: Backward Euler (BE) and Crank–Nicolson (CN).\n- Definitions for comparison:\n    - Temporal accuracy metric: $E = |\\text{numerical amplification factor} - \\text{exact amplification factor}|$.\n    - PISO pressure equation coefficient: $\\alpha = \\Delta t / a_p$, where $a_p$ is the momentum predictor's left-hand-side diagonal entry.\n    - Pressure equation stiffness metric: $S = 1/\\alpha$.\n- Numerical Parameters:\n    - $L = 1 \\,\\mathrm{m}$, $A = 1 \\,\\mathrm{m}^2$, $N = 10$.\n    - $\\rho = 1 \\,\\mathrm{kg/m^3}$, $U = 1 \\,\\mathrm{m/s}$, $Re = 100$.\n    - $Co = 0.5$.\n- Required output: The ratio of temporal accuracy metrics $R_E = E_{\\mathrm{BE}} / E_{\\mathrm{CN}}$ and the ratio of stiffness metrics $R_S = S_{\\mathrm{BE}} / S_{\\mathrm{CN}}$, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on the fundamental principles of fluid dynamics (incompressible Navier-Stokes equations) and numerical analysis (finite volume method, PISO algorithm, analysis of time integration schemes). The setup is standard in computational fluid dynamics (CFD).\n2.  **Well-Posed**: The problem provides all necessary definitions, parameters, and discretization schemes to derive the requested quantities. The tasks are clearly defined, leading to a unique analytical and numerical solution.\n3.  **Objective**: The problem is stated using precise, formal language common in engineering and applied mathematics. It is free of subjective or ambiguous terminology.\n4.  **Completeness and Consistency**: The provided data are self-contained and consistent. For example, $Re$ is defined, and its value is given, allowing for the determination of viscosity.\n5.  **Realism and Feasibility**: The physical parameters and numerical setup describe a realistic low-Reynolds-number channel flow simulation. The tasks are computationally feasible.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a well-posed, scientifically sound problem in the field of computational fluid dynamics. Proceeding with the solution.\n\n### Derivation of the model ODE\nWe begin by discretizing the one-dimensional convection-diffusion equation in space for a control volume $P$ with neighbors $W$ (west) and $E$ (east). The governing equation, neglecting pressure, is:\n$$ \\rho \\frac{\\partial u}{\\partial t} + \\rho U \\frac{\\partial u}{\\partial x} = \\mu \\frac{\\partial^2 u}{\\partial x^2} $$\nIntegrating over a control volume of length $h$ and area $A$ (which cancels out for the 1D problem), we get:\n$$ \\rho h \\frac{d u_P}{d t} = \\left[ -\\rho U u + \\mu \\frac{d u}{d x} \\right]_{w}^{e} $$\nHere, $u_P$ is the velocity in control volume $P$, and $e$ and $w$ denote the east and west faces of the control volume. Applying the specified discretization schemes:\n- Convection (first-order upwind, $U>0$): The flux at face $e$ is based on $u_P$ and at face $w$ is based on $u_W$. The net convective outflux is $\\rho U u_e - \\rho U u_w = \\rho U (u_P - u_W)$.\n- Diffusion (second-order central): The diffusive flux at face $e$ is $\\mu \\frac{u_E - u_P}{h}$ and at face $w$ is $\\mu \\frac{u_P - u_W}{h}$. The net diffusive influx is $\\mu \\frac{u_E - u_P}{h} - \\mu \\frac{u_P - u_W}{h} = \\frac{\\mu}{h}(u_E - 2u_P + u_W)$.\n\nThe semi-discrete equation for cell $P$ is the rate of change of momentum due to the sum of net fluxes:\n$$ \\rho h \\frac{d u_P}{d t} = -\\rho U(u_P - u_W) + \\frac{\\mu}{h}(u_E - 2u_P + u_W) $$\n$$ \\rho h \\frac{d u_P}{d t} = - \\left( \\rho U + \\frac{2\\mu}{h} \\right) u_P + \\left( \\rho U + \\frac{\\mu}{h} \\right) u_W + \\left( \\frac{\\mu}{h} \\right) u_E $$\nThe problem asks for a \"cell-lumped linear model\" of the form $\\frac{du}{dt} = \\lambda u$. This implies approximating the right-hand side, which depends on neighboring cells, by a term proportional to the cell's own velocity, $u_P$. This is achieved by considering only the diagonal part of the spatial operator matrix.\n$$ \\rho h \\frac{du}{dt} \\approx - \\left( \\rho U + \\frac{2\\mu}{h} \\right) u $$\nSolving for $\\frac{du}{dt}$, we find the constant $\\lambda$:\n$$ \\frac{du}{dt} = \\left[ -\\frac{1}{\\rho h} \\left( \\rho U + \\frac{2\\mu}{h} \\right) \\right] u = \\left( -\\frac{U}{h} - \\frac{2\\mu}{\\rho h^2} \\right) u $$\nThus, $\\lambda = -\\frac{U}{h} - \\frac{2\\mu}{\\rho h^2}$.\n\n### Temporal Accuracy Metric\nThe ODE is $\\frac{du}{dt} = \\lambda u$. The exact solution over a time step $\\Delta t$ is $u(t+\\Delta t) = u(t) \\exp(\\lambda \\Delta t)$. The exact one-step amplification factor is $G_{exact} = \\exp(\\lambda \\Delta t)$.\n\n**Backward Euler (BE):** The scheme is $\\frac{u^{n+1} - u^n}{\\Delta t} = \\lambda u^{n+1}$.\n$$ u^{n+1}(1 - \\lambda \\Delta t) = u^n \\implies G_{BE} = \\frac{u^{n+1}}{u^n} = \\frac{1}{1 - \\lambda \\Delta t} $$\nThe temporal accuracy metric for BE is:\n$$ E_{BE} = |G_{BE} - G_{exact}| = \\left| \\frac{1}{1 - \\lambda \\Delta t} - \\exp(\\lambda \\Delta t) \\right| $$\n\n**Crank-Nicolson (CN):** The scheme is $\\frac{u^{n+1} - u^n}{\\Delta t} = \\lambda \\frac{u^{n+1} + u^n}{2}$.\n$$ u^{n+1}\\left(1 - \\frac{\\lambda \\Delta t}{2}\\right) = u^n\\left(1 + \\frac{\\lambda \\Delta t}{2}\\right) \\implies G_{CN} = \\frac{u^{n+1}}{u^n} = \\frac{1 + \\lambda \\Delta t/2}{1 - \\lambda \\Delta t/2} $$\nThe temporal accuracy metric for CN is:\n$$ E_{CN} = |G_{CN} - G_{exact}| = \\left| \\frac{1 + \\lambda \\Delta t/2}{1 - \\lambda \\Delta t/2} - \\exp(\\lambda \\Delta t) \\right| $$\n\n### Pressure Equation Stiffness Metric\nThe stiffness metric is $S = 1/\\alpha = a_p / \\Delta t$, where $a_p$ is the diagonal coefficient of the matrix in the momentum predictor step. The fully discrete equation for the predictor velocity $u^*$ is written as $a_p u_P^* = \\sum a_{nb} u_{nb}^* + \\text{source terms}$. We derive $a_p$ from the time discretization of the semi-discrete equation.\nThe spatial operator terms for cell $P$ can be written as $a_P^{\\text{space}} u_P - a_W^{\\text{space}} u_W - a_E^{\\text{space}} u_E$, where $a_P^{\\text{space}} = \\rho U + \\frac{2\\mu}{h}$.\n\n**Backward Euler:** The time derivative and spatial terms are evaluated implicitly at the future time level.\n$$ \\rho h \\frac{u_P^* - u_P^n}{\\Delta t} = -\\left( a_P^{\\text{space}} u_P^* - a_W^{\\text{space}} u_W^* - a_E^{\\text{space}} u_E^* \\right) $$\nRearranging to isolate terms with $u_P^*$:\n$$ \\left( \\frac{\\rho h}{\\Delta t} + a_P^{\\text{space}} \\right) u_P^* = \\dots $$\nSo, the diagonal coefficient is $a_{p, \\text{BE}} = \\frac{\\rho h}{\\Delta t} + a_P^{\\text{space}} = \\frac{\\rho h}{\\Delta t} + \\rho U + \\frac{2\\mu}{h}$.\nThe stiffness metric for BE is:\n$$ S_{BE} = \\frac{a_{p, \\text{BE}}}{\\Delta t} = \\frac{\\rho h}{(\\Delta t)^2} + \\frac{\\rho U}{\\Delta t} + \\frac{2\\mu}{h \\Delta t} $$\n\n**Crank-Nicolson:** The spatial term is an average of its values at time levels $n$ and $*$.\n$$ \\rho h \\frac{u_P^* - u_P^n}{\\Delta t} = -\\frac{1}{2}\\left( a_P^{\\text{space}} u_P^* - \\dots \\right) - \\frac{1}{2}\\left( a_P^{\\text{space}} u_P^n - \\dots \\right) $$\nRearranging to isolate terms with $u_P^*$:\n$$ \\left( \\frac{\\rho h}{\\Delta t} + \\frac{1}{2}a_P^{\\text{space}} \\right) u_P^* = \\dots $$\nSo, the diagonal coefficient is $a_{p, \\text{CN}} = \\frac{\\rho h}{\\Delta t} + \\frac{1}{2}a_P^{\\text{space}} = \\frac{\\rho h}{\\Delta t} + \\frac{1}{2}\\left(\\rho U + \\frac{2\\mu}{h}\\right)$.\nThe stiffness metric for CN is:\n$$ S_{CN} = \\frac{a_{p, \\text{CN}}}{\\Delta t} = \\frac{\\rho h}{(\\Delta t)^2} + \\frac{\\rho U}{2\\Delta t} + \\frac{\\mu}{h \\Delta t} $$\n\n### Numerical Calculation\nFirst, we compute the physical and numerical parameters:\n- Cell size: $h = L/N = 1/10 = 0.1 \\, \\mathrm{m}$.\n- Dynamic viscosity: $\\mu = \\rho U L / Re = (1 \\cdot 1 \\cdot 1) / 100 = 0.01 \\, \\mathrm{kg/(m \\cdot s)}$.\n- Time step: $\\Delta t = Co \\cdot h / U = 0.5 \\cdot 0.1 / 1 = 0.05 \\, \\mathrm{s}$.\n\nNow, we compute $\\lambda$:\n$$ \\lambda = -\\frac{U}{h} - \\frac{2\\mu}{\\rho h^2} = -\\frac{1}{0.1} - \\frac{2(0.01)}{1 \\cdot (0.1)^2} = -10 - \\frac{0.02}{0.01} = -10 - 2 = -12 \\, \\mathrm{s^{-1}} $$\nThe key dimensionless parameter is $x = \\lambda \\Delta t$:\n$$ x = -12 \\cdot 0.05 = -0.6 $$\n\n**Temporal Accuracy Ratios:**\n- Exact amplification factor: $G_{exact} = \\exp(x) = \\exp(-0.6) \\approx 0.548812$.\n- BE amplification factor: $G_{BE} = \\frac{1}{1 - x} = \\frac{1}{1 - (-0.6)} = \\frac{1}{1.6} = 0.625$.\n- CN amplification factor: $G_{CN} = \\frac{1 + x/2}{1 - x/2} = \\frac{1 - 0.3}{1 + 0.3} = \\frac{0.7}{1.3} \\approx 0.538462$.\n\n- Accuracy metrics:\n  - $E_{BE} = |0.625 - 0.548812| = 0.076188$.\n  - $E_{CN} = |0.538462 - 0.548812| = |-0.010350| = 0.010350$.\n- Ratio $R_E$:\n  $$ R_E = \\frac{E_{BE}}{E_{CN}} = \\frac{0.076188}{0.010350} \\approx 7.36116 $$\n  Rounded to four significant figures, $R_E = 7.361$.\n\n**Stiffness Metric Ratios:**\nWe compute the terms for $S_{BE}$ and $S_{CN}$:\n- Term 1: $\\frac{\\rho h}{(\\Delta t)^2} = \\frac{1 \\cdot 0.1}{(0.05)^2} = \\frac{0.1}{0.0025} = 40$.\n- Term 2: $\\frac{\\rho U}{\\Delta t} = \\frac{1 \\cdot 1}{0.05} = 20$.\n- Term 3: $\\frac{2\\mu}{h \\Delta t} = \\frac{2 \\cdot 0.01}{0.1 \\cdot 0.05} = \\frac{0.02}{0.005} = 4$.\n\n- Stiffness metrics:\n  - $S_{BE} = 40 + 20 + 4 = 64$.\n  - $S_{CN} = 40 + \\frac{20}{2} + \\frac{4}{2} = 40 + 10 + 2 = 52$.\n- Ratio $R_S$:\n  $$ R_S = \\frac{S_{BE}}{S_{CN}} = \\frac{64}{52} = \\frac{16}{13} \\approx 1.230769 $$\n  Rounded to four significant figures, $R_S = 1.231$.\n\nThe final results are the ratios $R_E$ and $R_S$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 7.361  1.231 \\end{pmatrix}}$$"
        }
    ]
}