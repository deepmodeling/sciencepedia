{
    "hands_on_practices": [
        {
            "introduction": "To truly master the pressure correction method, we must first understand how the governing differential equations transform into a solvable algebraic system. This exercise guides you through the fundamental process of deriving the discrete pressure correction equation using the finite volume method in a simplified one-dimensional setting . By applying conservation principles over a control volume, you will build the core linear equation that relates the pressure correction in a cell to its neighbors, providing a concrete link between physical laws and the numerical algorithm.",
            "id": "3993952",
            "problem": "An isothermal, incompressible flow of a Newtonian fluid with constant density $\\rho$ is simulated in a one-dimensional channel of length $L$ and uniform cross-sectional area $A$, using a collocated finite volume method with $N$ equal control volumes. The energy equation is decoupled and not solved, and the flow is considered only along the $x$-direction. The fundamental base for the derivation is the conservation of mass for incompressible flow, $\\nabla \\cdot \\mathbf{u} = 0$, and the momentum balance from the incompressible Navier–Stokes equations with explicit treatment of convection and diffusion and implicit treatment of the pressure at the new time. A backward Euler time stepping scheme with time step $\\Delta t$ is used to advance the solution from time level $n$ to $n+1$.\n\nA fractional-step (projection) approach is applied: first, a predicted velocity field $\\mathbf{u}^{*}$ is obtained by solving the momentum equation without the pressure gradient at time level $n+1$; then a pressure correction $p'$ is introduced such that the corrected velocity $\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p'$ satisfies the incompressible continuity equation at time level $n+1$. This yields a pressure correction equation of Poisson type. The domain is discretized into $N$ uniform control volumes of width $\\Delta x = L/N$, with pressures $p'$ stored at cell centers, face-centered gradients approximated by second-order central differences, and face velocities $u^{*}_{i\\pm 1/2}$ used to evaluate the discrete divergence.\n\nFor an interior control volume indexed by $i$, derive the discrete pressure correction equation in tridiagonal form,\n$$\na_{P} \\, p'_{i} = a_{E} \\, p'_{i+1} + a_{W} \\, p'_{i-1} + b_{i},\n$$\nwhere $a_{P}$, $a_{E}$, and $a_{W}$ are the linear system coefficients and $b_{i}$ is the contribution from the predicted velocity divergence. Using only the fundamental laws and the stated discretization assumptions, determine the symbolic expression for the diagonal coefficient $a_{P}$ for an interior cell in terms of the cross-sectional area $A$ and the uniform cell width $\\Delta x$. Express your final answer as a closed-form analytic expression. No rounding is required, and no units should be included in the final boxed answer.",
            "solution": "The problem statement is evaluated as valid, as it describes a standard, well-posed problem in computational fluid dynamics based on established scientific principles and is free of contradictions or ambiguities.\n\nThe derivation of the discrete pressure correction equation begins with the fundamental relations of the fractional-step (projection) method for incompressible flow. The corrected velocity field at the new time step, $\\mathbf{u}^{n+1}$, must satisfy the continuity equation for an incompressible fluid:\n$$\n\\nabla \\cdot \\mathbf{u}^{n+1} = 0\n$$\nThe corrected velocity is related to the predicted velocity, $\\mathbf{u}^{*}$, and the pressure correction, $p'$, by the formula provided:\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p'\n$$\nwhere $\\Delta t$ is the time step and $\\rho$ is the constant fluid density.\n\nSubstituting the second equation into the first yields the continuous pressure correction equation:\n$$\n\\nabla \\cdot \\left( \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla p' \\right) = 0\n$$\nAs $\\Delta t$ and $\\rho$ are constants, the divergence operator can be distributed:\n$$\n\\nabla \\cdot \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla \\cdot (\\nabla p') = 0\n$$\nThis rearranges to the Poisson equation for the pressure correction $p'$:\n$$\n\\nabla^2 p' = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\mathbf{u}^{*}\n$$\nHere, $\\nabla^2$ is the Laplacian operator, which is $\\nabla \\cdot \\nabla$.\n\nTo discretize this equation using the finite volume method, we integrate it over a generic interior control volume $CV_i$. The control volume has a uniform width $\\Delta x$ and a constant cross-sectional area $A$, so its volume is $V_P = A \\Delta x$.\n$$\n\\int_{CV_i} \\nabla^2 p' \\, dV = \\int_{CV_i} \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\mathbf{u}^{*} \\, dV\n$$\nApplying the divergence theorem, which states $\\int_V (\\nabla \\cdot \\mathbf{F}) \\, dV = \\oint_S (\\mathbf{F} \\cdot \\mathbf{n}) \\, dS$, to both sides of the equation. For the one-dimensional case, the surface integral simplifies to a sum over the east ($e$) and west ($w$) faces of the control volume, located at $x_{i+1/2}$ and $x_{i-1/2}$ respectively. The area of each face is $A$.\n\nThe left-hand side (LHS) becomes:\n$$\n\\int_{CV_i} \\nabla \\cdot (\\nabla p') \\, dV = \\oint_{S_i} (\\nabla p' \\cdot \\mathbf{n}) \\, dS = \\left[ A \\left( \\frac{\\partial p'}{\\partial x} \\right) \\right]_{e} - \\left[ A \\left( \\frac{\\partial p'}{\\partial x} \\right) \\right]_{w}\n$$\nThe problem specifies that face-centered gradients are approximated by second-order central differences. The gradient at the east face ($e$) is approximated using the cell-center values $p'_{i+1}$ and $p'_{i}$, and the gradient at the west face ($w$) is approximated using $p'_{i}$ and $p'_{i-1}$:\n$$\n\\left( \\frac{\\partial p'}{\\partial x} \\right)_{e} \\approx \\frac{p'_{i+1} - p'_{i}}{\\Delta x}\n$$\n$$\n\\left( \\frac{\\partial p'}{\\partial x} \\right)_{w} \\approx \\frac{p'_{i} - p'_{i-1}}{\\Delta x}\n$$\nSubstituting these approximations into the LHS gives:\n$$\n\\text{LHS} = A \\left( \\frac{p'_{i+1} - p'_{i}}{\\Delta x} \\right) - A \\left( \\frac{p'_{i} - p'_{i-1}}{\\Delta x} \\right) = \\frac{A}{\\Delta x} (p'_{i+1} - 2p'_{i} + p'_{i-1})\n$$\nThe right-hand side (RHS) of the integrated equation is:\n$$\n\\text{RHS} = \\frac{\\rho}{\\Delta t} \\int_{CV_i} \\nabla \\cdot \\mathbf{u}^{*} \\, dV = \\frac{\\rho}{\\Delta t} \\oint_{S_i} (\\mathbf{u}^{*} \\cdot \\mathbf{n}) \\, dS = \\frac{\\rho}{\\Delta t} \\left( [A u^{*}]_{e} - [A u^{*}]_{w} \\right)\n$$\nwhere $u^{*}_{e}$ and $u^{*}_{w}$ are the face-centered predicted velocities (given as $u^{*}_{i+1/2}$ and $u^{*}_{i-1/2}$).\n\nEquating the LHS and RHS:\n$$\n\\frac{A}{\\Delta x} (p'_{i+1} - 2p'_{i} + p'_{i-1}) = \\frac{\\rho A}{\\Delta t} (u^{*}_{i+1/2} - u^{*}_{i-1/2})\n$$\nWe must now rearrange this equation into the target form specified in the problem:\n$$\na_{P} \\, p'_{i} = a_{E} \\, p'_{i+1} + a_{W} \\, p'_{i-1} + b_{i}\n$$\nFrom our derived equation, we isolate the term with $p'_{i}$:\n$$\n-\\frac{2A}{\\Delta x} p'_{i} = - \\frac{A}{\\Delta x} p'_{i+1} - \\frac{A}{\\Delta x} p'_{i-1} + \\frac{\\rho A}{\\Delta t} (u^{*}_{i+1/2} - u^{*}_{i-1/2})\n$$\nMultiplying the entire equation by $-1$ to make the coefficient of $p'_i$ positive:\n$$\n\\frac{2A}{\\Delta x} p'_{i} = \\frac{A}{\\Delta x} p'_{i+1} + \\frac{A}{\\Delta x} p'_{i-1} - \\frac{\\rho A}{\\Delta t} (u^{*}_{i+1/2} - u^{*}_{i-1/2})\n$$\nThis equation now matches the target form. The problem states that $b_{i}$ is the contribution from the predicted velocity divergence, and that the coefficients $a_P, a_E, a_W$ should be expressed in terms of $A$ and $\\Delta x$ only. This unique algebraic arrangement partitions the terms as follows:\n$$\na_{P} = \\frac{2A}{\\Delta x}\n$$\n$$\na_{E} = \\frac{A}{\\Delta x}\n$$\n$$\na_{W} = \\frac{A}{\\Delta x}\n$$\n$$\nb_{i} = - \\frac{\\rho A}{\\Delta t} (u^{*}_{i+1/2} - u^{*}_{i-1/2})\n$$\nThis form satisfies all conditions, notably that $a_P$, $a_E$, and $a_W$ depend only on the geometric parameters $A$ and $\\Delta x$, while the physical parameters $\\rho$ and the time step $\\Delta t$ are absorbed into the source term $b_i$.\n\nThe diagonal coefficient for an interior cell is therefore:\n$$\na_{P} = \\frac{2A}{\\Delta x}\n$$",
            "answer": "$$\n\\boxed{\\frac{2A}{\\Delta x}}\n$$"
        },
        {
            "introduction": "A common numerical challenge when discretizing fluid equations on a collocated grid is the emergence of non-physical, oscillatory pressure fields, often called \"checkerboarding.\" This practice delves into the elegant solution provided by Rhie-Chow interpolation, which effectively couples pressure and velocity to suppress these oscillations . Through Fourier analysis, you will mathematically demonstrate how this interpolation scheme targets and damps the highest-frequency error modes, revealing the sophisticated numerical reasoning behind robust CFD methods.",
            "id": "3993953",
            "problem": "Consider a one-dimensional, periodic, uniformly discretized domain of length $L$ with $N$ collocated control volumes of spacing $h = L/N$, constant density $\\rho$, and incompressible flow. A pressure-correction step is carried out within the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE), and face-normal velocities are computed on a collocated grid using Rhie–Chow interpolation. The Rhie–Chow interpolation modifies the face-normal velocity at the face between cells $i$ and $i+1$ by adding a pressure-difference-based term that comes from the discretized momentum equation, while other non-pressure contributions are aggregated in an interpolated term. Denote the pressure at cell center $i$ by $p_i$ and model the pressure-induced contribution to the face-normal velocity at face $i+1/2$ as $u_{i+1/2}^{p} = -\\delta\\,(p_{i+1} - p_i)$, where $\\delta  0$ is a constant determined by the diagonal dominance of the discretized momentum operator and grid metrics. Assume that all non-pressure contributions to the face-normal velocities either cancel from the divergence in the pressure-correction equation or do not affect the analysis of pressure-mode coupling.\n\nStarting from the conservation of mass and its discrete divergence form for incompressible flow, derive the linear operator $L$ acting on the pressure field that arises solely from the Rhie–Chow pressure-difference contribution to the face-normal velocities. On the uniform grid, perform a Fourier (normal-mode) analysis by considering a pressure mode of the form $p_i = \\hat{p}\\,\\exp(\\mathrm{i} k x_i)$ with $x_i = i h$ and wavenumber $k$. Determine the normalized Fourier symbol $\\sigma(k)$ such that $L p_i = \\left(\\frac{\\delta}{h}\\right)\\sigma(k)\\,p_i$.\n\nFinally, evaluate the normalized symbol for the checkerboard mode characterized by $k h = \\pi$. Express your final answer as a single real number. No rounding is required, and no physical units should be attached to the final value because the requested symbol is dimensionless by construction.",
            "solution": "The derivation begins with the principle of mass conservation for an incompressible flow. In one dimension, the differential form of the continuity equation is $\\frac{du}{dx} = 0$. For a collocated grid, we apply the finite volume method to a control volume centered at node $i$, which extends from face $i-\\frac{1}{2}$ to face $i+\\frac{1}{2}$. The discrete form of the continuity equation is obtained by integrating the divergence over the control volume and applying the divergence theorem, which results in:\n$$\n\\frac{u_{i+1/2} - u_{i-1/2}}{h} = 0\n$$\nwhere $u_{i+1/2}$ and $u_{i-1/2}$ are the velocities at the control volume faces and $h$ is the uniform grid spacing.\n\nThe problem states that we are to consider only the pressure-induced contribution to the face-normal velocity, which is given by the Rhie-Chow interpolation model:\n$$\nu_{i+1/2}^{p} = -\\delta\\,(p_{i+1} - p_i)\n$$\nwhere $p_i$ is the pressure at cell center $i$ and $\\delta  0$ is a constant. The term $u_{i-1/2}^{p}$ is found by shifting the index $i$ to $i-1$:\n$$\nu_{i-1/2}^{p} = -\\delta\\,(p_i - p_{i-1})\n$$\nThe linear operator $L$ acting on the pressure field $p$ arises from substituting these pressure-dependent velocities into the discrete continuity equation. This operator forms the left-hand side of the pressure-correction Poisson equation. We define $L p_i$ as the discrete divergence of this velocity field:\n$$\nL p_i = \\frac{u_{i+1/2}^{p} - u_{i-1/2}^{p}}{h}\n$$\nSubstituting the expressions for the face velocities:\n$$\nL p_i = \\frac{1}{h} \\left[ (-\\delta\\,(p_{i+1} - p_i)) - (-\\delta\\,(p_i - p_{i-1})) \\right]\n$$\nFactoring out the constant $-\\frac{\\delta}{h}$:\n$$\nL p_i = -\\frac{\\delta}{h} \\left[ (p_{i+1} - p_i) - (p_i - p_{i-1}) \\right]\n$$\nSimplifying the expression inside the brackets gives the discrete Laplacian stencil:\n$$\nL p_i = -\\frac{\\delta}{h} (p_{i+1} - 2p_i + p_{i-1})\n$$\nThis is the derived linear operator $L$ acting on the pressure field.\n\nNext, we perform a Fourier (normal-mode) analysis by considering a pressure mode of the form $p_i = \\hat{p}\\,\\exp(\\mathrm{i} k x_i)$, where $x_i = i h$. To find the action of $L$ on this mode, we first express $p_{i+1}$ and $p_{i-1}$ in terms of $p_i$:\n$$\np_{i+1} = \\hat{p}\\,\\exp(\\mathrm{i} k x_{i+1}) = \\hat{p}\\,\\exp(\\mathrm{i} k (x_i + h)) = \\hat{p}\\,\\exp(\\mathrm{i} k x_i)\\,\\exp(\\mathrm{i} k h) = p_i\\,\\exp(\\mathrm{i} k h)\n$$\n$$\np_{i-1} = \\hat{p}\\,\\exp(\\mathrm{i} k x_{i-1}) = \\hat{p}\\,\\exp(\\mathrm{i} k (x_i - h)) = \\hat{p}\\,\\exp(\\mathrm{i} k x_i)\\,\\exp(-\\mathrm{i} k h) = p_i\\,\\exp(-\\mathrm{i} k h)\n$$\nSubstituting these into the expression for $L p_i$:\n$$\nL p_i = -\\frac{\\delta}{h} (p_i\\,\\exp(\\mathrm{i} k h) - 2p_i + p_i\\,\\exp(-\\mathrm{i} k h))\n$$\nFactoring out $p_i$:\n$$\nL p_i = -\\frac{\\delta}{h} p_i (\\exp(\\mathrm{i} k h) - 2 + \\exp(-\\mathrm{i} k h))\n$$\nUsing the Euler identity $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta)}{2}$, we can write $\\exp(\\mathrm{i} k h) + \\exp(-\\mathrm{i} k h) = 2\\cos(k h)$. The expression in the parenthesis becomes:\n$$\n\\exp(\\mathrm{i} k h) - 2 + \\exp(-\\mathrm{i} k h) = 2\\cos(k h) - 2 = -2(1 - \\cos(k h))\n$$\nSubstituting this back into the equation for $L p_i$:\n$$\nL p_i = -\\frac{\\delta}{h} p_i [-2(1 - \\cos(k h))]\n$$\n$$\nL p_i = \\frac{2\\delta}{h} (1 - \\cos(k h)) p_i\n$$\nThe problem requires us to find the normalized Fourier symbol $\\sigma(k)$ defined by the relation $L p_i = \\left(\\frac{\\delta}{h}\\right)\\sigma(k)\\,p_i$. By comparing this definition with our derived result, we can identify $\\sigma(k)$:\n$$\n\\left(\\frac{\\delta}{h}\\right)\\sigma(k)\\,p_i = \\frac{2\\delta}{h} (1 - \\cos(k h)) p_i\n$$\nCanceling the common factor $\\left(\\frac{\\delta}{h}\\right)p_i$ from both sides, we obtain the expression for the normalized symbol:\n$$\n\\sigma(k) = 2(1 - \\cos(k h))\n$$\nFinally, we must evaluate this symbol for the checkerboard mode, which is characterized by the dimensionless wavenumber $k h = \\pi$. This mode corresponds to the highest frequency that can be resolved on the grid, with pressure values alternating in sign between adjacent cells, i.e., $p_i \\propto (-1)^i$. Substituting $k h = \\pi$ into the expression for $\\sigma(k)$:\n$$\n\\sigma(k)\\rvert_{kh=\\pi} = 2(1 - \\cos(\\pi))\n$$\nSince $\\cos(\\pi) = -1$, the evaluation is:\n$$\n\\sigma(k)\\rvert_{kh=\\pi} = 2(1 - (-1)) = 2(1 + 1) = 4\n$$\nThis result indicates that the discrete operator responds most strongly to the checkerboard mode, which is the desired behavior of the Rhie-Chow interpolation—to prevent such spurious pressure oscillations by creating a well-conditioned pressure-Poisson equation.",
            "answer": "$$ \\boxed{4} $$"
        },
        {
            "introduction": "With the discrete equation derived and its numerical intricacies understood, the final step is to solve it efficiently and robustly. This coding practice transitions from theory to application, asking you to implement and analyze an iterative solution for the pressure correction system . You will explore the critical concept of under-relaxation and its effect on convergence by calculating the spectral radius of the iteration matrix, a key metric for determining the stability of the numerical scheme.",
            "id": "3993965",
            "problem": "Consider an incompressible, isothermal flow in a one-dimensional channel of length $L$ with impermeable ends. Start from the conservation of mass for an incompressible fluid,\n$$\\nabla \\cdot \\mathbf{u} = 0,$$\nand the discretized momentum balance for a pressure-based algorithm where the face-normal velocity is predicted and then corrected by a pressure gradient. In the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE), the predicted velocity field $\\mathbf{u}^\\ast$ does not satisfy mass conservation, and a pressure correction field $p'$ is introduced so that the corrected velocity $\\mathbf{u} = \\mathbf{u}^\\ast - \\frac{1}{a_P} \\nabla p'$ satisfies mass conservation. Under constant coefficients and one-dimensional geometry $x \\in [0,L]$, this yields a pressure correction equation of the Poisson type with Dirichlet boundary conditions $p'(0)=0$ and $p'(L)=0$, which, after second-order central discretization on $N$ uniformly spaced interior control volumes, leads to a symmetric positive definite linear system of the form\n$$A \\, \\mathbf{p}' = \\mathbf{r},$$\nwhere $A \\in \\mathbb{R}^{N \\times N}$ is the discrete Laplacian operator induced by the one-dimensional second derivative with the specified boundary conditions, and $\\mathbf{r}$ is the discrete mass imbalance residual obtained from the predicted velocity field.\n\nTo improve robustness and stability in iterative solvers, the pressure is commonly updated by under-relaxation,\n$$p^{(k+1)} = p^{(k)} + \\alpha_p \\, p',$$\nwhere $p^{(k)}$ is the current pressure iterate, $p'$ is the current solution of the correction equation (or its approximation in a stationary iteration based on $A$), and $\\alpha_p \\ge 0$ is the pressure under-relaxation factor. In a Jacobi-type stationary iteration for the correction equation, one replaces solving $A \\, \\mathbf{p}' = \\mathbf{r}$ by applying the diagonal inverse $D^{-1}$, with $D = \\operatorname{diag}(A)$, to the residual to obtain an approximate correction.\n\nYour task is to:\n- Derive, from the above physical and numerical principles, the linear iteration for the error $\\mathbf{e}^{(k)} = \\mathbf{p}^{(k)} - \\mathbf{p}^\\star$ under Jacobi-type under-relaxation, where $\\mathbf{p}^\\star$ is the fixed point corresponding to the exact solution of the discrete pressure correction equation. Express the iteration in terms of a matrix $M(\\alpha_p)$ acting on $\\mathbf{e}^{(k)}$.\n- For the one-dimensional channel, construct $A$ explicitly for $N$ interior control volumes on a uniform grid with spacing $h = L/(N+1)$ using second-order central differences and Dirichlet boundary conditions $p'(0)=0$ and $p'(L)=0$. Ensure scientific consistency by using the standard discrete Laplacian stencil: on interior nodes $i$, $A_{i,i} = \\frac{2}{h^2}$ and $A_{i,i\\pm 1} = -\\frac{1}{h^2}$.\n- Using the Jacobi diagonal $D = \\operatorname{diag}(A)$, construct the iteration matrix $M(\\alpha_p)$ associated with the under-relaxed Jacobi update for the pressure field.\n- Compute the spectral radius $\\rho(M)$, defined as the largest absolute value among the eigenvalues of $M(\\alpha_p)$, for each provided test case. The spectral radius is dimensionless.\n- For each test case, also determine a boolean stability flag that is $True$ if $\\rho(M)  1$ (linearly stable iteration) and $False$ otherwise.\n\nUse the following scientifically sound test suite, covering a typical case, a large under-relaxation factor case, a boundary under-relaxation case, a moderate grid with significant under-relaxation, and a fine grid with near-aggressive under-relaxation:\n- Case $1$: $N = 5$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 0.8$.\n- Case $2$: $N = 5$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 2.1$.\n- Case $3$: $N = 50$, $L = 2\\,\\mathrm{m}$, $\\alpha_p = 0.0$.\n- Case $4$: $N = 20$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 1.6$.\n- Case $5$: $N = 100$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 1.99$.\n\nYour program must:\n- Build the matrix $A$ according to the above discrete Laplacian for each $(N,L)$ pair.\n- Form $D^{-1}$ from $A$ and then the iteration matrix $M(\\alpha_p)$ for the given $\\alpha_p$.\n- Compute $\\rho(M)$ and the associated stability flag for each case.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each result is itself a two-element list of the form $[ \\rho(M), \\text{stability} ]$ with $\\rho(M)$ as a float and $\\text{stability}$ as a boolean. For example, a valid shape is $[[\\text{float},\\text{bool}],[\\text{float},\\text{bool}],\\dots]$.\n- The spectral radius is dimensionless; no physical units are associated with the output. Print the float values in standard decimal form without rounding directives.",
            "solution": "We begin from the conservation of mass for incompressible flow,\n$$\\nabla \\cdot \\mathbf{u} = 0.$$\nIn pressure-based algorithms such as the Semi-Implicit Method for Pressure-Linked Equations (SIMPLE), one obtains a predicted velocity field $\\mathbf{u}^\\ast$ from the discretized momentum equations. This predicted field generally does not satisfy $\\nabla \\cdot \\mathbf{u}^\\ast = 0$, so a pressure correction $p'$ is introduced to adjust the velocity field,\n$$\\mathbf{u} = \\mathbf{u}^\\ast - \\frac{1}{a_P} \\nabla p',$$\nwhere $a_P$ is the central coefficient from the discretized momentum equation. Substituting the corrected velocity into the mass conservation and assuming $a_P$ is spatially constant gives\n$$\\nabla \\cdot \\mathbf{u} = \\nabla \\cdot \\left( \\mathbf{u}^\\ast - \\frac{1}{a_P} \\nabla p' \\right) = 0 \\quad \\Rightarrow \\quad \\nabla \\cdot \\left( \\frac{1}{a_P} \\nabla p' \\right) = \\nabla \\cdot \\mathbf{u}^\\ast.$$\nDefining the source term $s = \\nabla \\cdot \\mathbf{u}^\\ast$, the pressure correction equation becomes\n$$\\nabla \\cdot \\left( \\frac{1}{a_P} \\nabla p' \\right) = s.$$\nIn one dimension with constant $a_P$, this reduces to\n$$\\frac{1}{a_P} \\frac{d^2 p'}{dx^2} = s(x).$$\nFor the present analysis, the essential structure is the elliptic operator $\\frac{d^2}{dx^2}$, so we focus on the discrete operator and its stability characteristics under iterative under-relaxation.\n\nWe discretize the second derivative using second-order central differences on $N$ interior nodes with uniform spacing $h = \\frac{L}{N+1}$. With Dirichlet boundary conditions $p'(0)=0$ and $p'(L)=0$, the discrete Laplacian acting on the vector of interior nodal values $\\mathbf{p}' \\in \\mathbb{R}^N$ yields the linear system\n$$A \\, \\mathbf{p}' = \\mathbf{r},$$\nwhere the tridiagonal matrix $A \\in \\mathbb{R}^{N \\times N}$ has entries\n$$A_{i,i} = \\frac{2}{h^2}, \\quad A_{i,i-1} = -\\frac{1}{h^2}, \\quad A_{i,i+1} = -\\frac{1}{h^2},$$\nfor $i = 1, \\dots, N$ with appropriate adjustments at the ends (the off-diagonals are present only when the index remains within $1$ to $N$). This $A$ is symmetric positive definite due to the Dirichlet boundary conditions.\n\nRather than solving $A \\, \\mathbf{p}' = \\mathbf{r}$ exactly at each iteration, we consider a Jacobi-type stationary iteration. Let $D = \\operatorname{diag}(A)$ be the diagonal part of $A$. The Jacobi update for the pressure correction approximates the solution by\n$$\\mathbf{p}' \\approx D^{-1} \\left( \\mathbf{r} - A \\, \\mathbf{p}^{(k)} \\right),$$\nwhich is then under-relaxed in the pressure update\n$$\\mathbf{p}^{(k+1)} = \\mathbf{p}^{(k)} + \\alpha_p \\, \\mathbf{p}'.$$\nCombining these yields\n$$\\mathbf{p}^{(k+1)} = \\mathbf{p}^{(k)} + \\alpha_p \\, D^{-1} \\left( \\mathbf{r} - A \\, \\mathbf{p}^{(k)} \\right) = \\left( I - \\alpha_p D^{-1}A \\right) \\mathbf{p}^{(k)} + \\alpha_p D^{-1} \\mathbf{r}.$$\nLet $\\mathbf{p}^\\star$ be the fixed point satisfying the discrete equation $A \\, \\mathbf{p}^\\star = \\mathbf{r}$. Define the error $\\mathbf{e}^{(k)} = \\mathbf{p}^{(k)} - \\mathbf{p}^\\star$. Subtracting the fixed-point equation from the iteration, the error evolves as\n$$\\mathbf{e}^{(k+1)} = \\left( I - \\alpha_p D^{-1}A \\right) \\mathbf{e}^{(k)}.$$\nHence, the iteration matrix acting on the error is\n$$M(\\alpha_p) = I - \\alpha_p D^{-1}A.$$\nClassical linear iteration theory states that the iteration converges linearly if and only if the spectral radius of $M(\\alpha_p)$ satisfies\n$$\\rho\\!\\left(M(\\alpha_p)\\right)  1,$$\nwhere $\\rho(\\cdot)$ denotes the largest absolute value among the eigenvalues. For our discrete Laplacian $A$ with Dirichlet boundary conditions, $A$ is symmetric positive definite, and $D^{-1}A$ is also symmetric with real eigenvalues. Under these conditions, the choice of $\\alpha_p$ controls the contraction factor of the error through the eigenvalues of $M(\\alpha_p)$.\n\nAlgorithmic steps to compute the requested quantities for each test case:\n- Given $N$ and $L$, compute $h = \\frac{L}{N+1}$.\n- Assemble the tridiagonal matrix $A$ with $A_{i,i} = \\frac{2}{h^2}$ and $A_{i,i\\pm 1} = -\\frac{1}{h^2}$ for interior neighbors.\n- Form $D = \\operatorname{diag}(A)$ and $D^{-1}$.\n- Construct $M(\\alpha_p) = I - \\alpha_p D^{-1}A$.\n- Compute all eigenvalues of $M(\\alpha_p)$ and then evaluate the spectral radius $\\rho(M)$ as the maximum absolute eigenvalue.\n- Set the stability flag to $True$ if $\\rho(M)  1$ and $False$ otherwise.\n\nThe spectral radius is dimensionless. The specified test suite includes:\n- Case $1$: $N = 5$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 0.8$.\n- Case $2$: $N = 5$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 2.1$.\n- Case $3$: $N = 50$, $L = 2\\,\\mathrm{m}$, $\\alpha_p = 0.0$.\n- Case $4$: $N = 20$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 1.6$.\n- Case $5$: $N = 100$, $L = 1\\,\\mathrm{m}$, $\\alpha_p = 1.99$.\n\nThe final output must be a single line containing a list of two-element lists $[ \\rho(M), \\text{stability} ]$ for the five cases, in the order listed above.",
            "answer": "```python\nimport numpy as np\n\ndef build_A(N: int, L: float) - np.ndarray:\n    \"\"\"\n    Build the N x N discrete Laplacian matrix A for a 1D domain [0, L]\n    with Dirichlet boundary conditions at both ends and uniform spacing.\n    A_{ii} = 2/h^2, A_{i,i±1} = -1/h^2.\n    \"\"\"\n    h = L / (N + 1)\n    diag = 2.0 / (h * h)\n    off = -1.0 / (h * h)\n    A = np.zeros((N, N), dtype=float)\n    # Fill tridiagonal entries\n    for i in range(N):\n        A[i, i] = diag\n        if i - 1 = 0:\n            A[i, i - 1] = off\n        if i + 1  N:\n            A[i, i + 1] = off\n    return A\n\ndef iteration_matrix_spectral_radius(N: int, L: float, alpha: float) - tuple[float, bool]:\n    \"\"\"\n    Construct the iteration matrix M(alpha) = I - alpha * D^{-1} * A\n    for Jacobi-type under-relaxation of the pressure correction, and\n    compute its spectral radius and stability flag.\n    \"\"\"\n    A = build_A(N, L)\n    D_diag = np.diag(A)\n    # Ensure no zero diagonal entries; for Dirichlet Laplacian this is guaranteed positive.\n    D_inv = np.diag(1.0 / D_diag)\n    I = np.eye(N, dtype=float)\n    M = I - alpha * (D_inv @ A)\n    # Compute eigenvalues and spectral radius\n    eigvals = np.linalg.eigvals(M)\n    rho = float(np.max(np.abs(eigvals)))\n    stable = rho  1.0\n    return rho, stable\n\ndef solve():\n    # Define the test cases from the problem statement: (N, L [m], alpha_p)\n    test_cases = [\n        (5, 1.0, 0.8),   # Case 1: typical stable under-relaxation\n        (5, 1.0, 2.1),   # Case 2: aggressive under-relaxation likely unstable\n        (50, 2.0, 0.0),  # Case 3: boundary case alpha=0, no change, spectral radius=1\n        (20, 1.0, 1.6),  # Case 4: moderate grid with significant under-relaxation\n        (100, 1.0, 1.99) # Case 5: fine grid with near-aggressive under-relaxation\n    ]\n\n    results = []\n    for N, L, alpha in test_cases:\n        rho, stable = iteration_matrix_spectral_radius(N, L, alpha)\n        results.append([rho, stable])\n\n    # Final print statement in the exact required format.\n    print(\"[\" + \",\".join(str(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}