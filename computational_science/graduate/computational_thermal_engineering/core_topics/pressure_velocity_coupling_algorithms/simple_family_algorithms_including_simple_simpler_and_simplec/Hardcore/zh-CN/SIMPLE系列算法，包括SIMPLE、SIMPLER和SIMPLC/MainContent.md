## 引言
在[计算流体动力学](@entry_id:142614)（CFD）领域，[精确模拟](@entry_id:749142)不可压缩流体流动是众多工程与科学问题的核心。然而，[纳维-斯托克斯方程组](@entry_id:142275)的内在结构带来了一个独特的挑战：压力没有独立的控制方程，其作用是实时调整以确保速度场满足质量守恒。直接求解包含速度和压力的全耦合系统在计算上成本高昂且数值上不稳定，这催生了更高效的分离式算法。SIMPLE（压力耦合方程组的[半隐式方法](@entry_id:200119)）及其衍生算法家族正是为解决这一核心的压力-速度耦合难题而生，构成了现代[CFD求解器](@entry_id:747244)的基石。

本文将系统性地引导读者全面掌握SIMPLE系列算法。在“原理与机制”一章，我们将深入剖析其标志性的预测-校正策略、网格布置方案，并辨析SIMPLE、SIMPLEC及SIMPLER的异同。随后的“应用与跨学科联系”一章将展示这些算法在处理[自然对流](@entry_id:197869)、[湍流](@entry_id:151300)和燃烧等复杂热流问题时的强大功能，并探讨实际应用中的关键数值考量。最后，“动手实践”部分将提供具体的计算练习，帮助读者将理论知识转化为解决实际问题的能力。

## 原理与机制

在[计算流体动力学](@entry_id:142614)中，求解[不可压缩流](@entry_id:140301)动的控制方程——[纳维-斯托克斯方程](@entry_id:142275)——提出了一系列独特的挑战。与[可压缩流](@entry_id:747589)不同，[不可压缩流](@entry_id:140301)动的密度与压力无关，这意味着没有直接的[状态方程](@entry_id:274378)来求解压[力场](@entry_id:147325)。相反，压力扮演了一个更为微妙但至关重要的角色：它是一个瞬时调整的运动学量，以确保速度场始终满足[质量守恒](@entry_id:204015)（即连续性）的约束。本章将深入探讨为解决这一核心的[压力-速度耦合](@entry_id:155962)问题而发展起来的SIMPLE算法家族的原理与机制。

### [不可压缩流](@entry_id:140301)动的基本挑战：[压力-速度耦合](@entry_id:155962)

对于一个密度为常数 $\rho$ 的不可压缩牛顿流体，其质量和动量守恒由以下方程组描述 ：

[动量方程](@entry_id:197225)：
$$
\frac{\partial (\rho \mathbf{u})}{\partial t} + \nabla \cdot (\rho \mathbf{u} \mathbf{u}) = -\nabla p + \nabla \cdot (2\mu \mathbf{S}) + \rho\mathbf{g}
$$

连续性方程：
$$
\nabla \cdot \mathbf{u} = 0
$$

其中，$\mathbf{u}$ 是速度矢量， $p$ 是压力，$\mu$ 是[动力粘度](@entry_id:268228)，$\mathbf{g}$ 是重力加速度，$\mathbf{S} = \frac{1}{2}\left(\nabla\mathbf{u} + (\nabla\mathbf{u})^{\top}\right)$ 是[应变率张量](@entry_id:266108)。[动量方程](@entry_id:197225)的左侧代表动量的瞬时累积和[对流输运](@entry_id:149512)，右侧则包括压力[梯度力](@entry_id:166847)、粘性应力散度和体积力。

这个方程组的关键难点在于压力的处理。压力 $p$ 仅以其梯度 $\nabla p$ 的形式出现在动量方程中，而连续性方程中根本没有压力项。这表明，压力本身不是由热力学状态决定的，而是作为一个“[拉格朗日乘子](@entry_id:142696)”，其场的分布必须恰好能迫使速度场 $\mathbf{u}$ 满足[无散度](@entry_id:190991)条件 $\nabla \cdot \mathbf{u} = 0$ 。

这种特殊的角色导致了两个直接的后果。首先，压力解具有“[规范自由度](@entry_id:160491)”：如果 $p(\mathbf{x}, t)$ 是一个有效的压[力场](@entry_id:147325)，那么 $p(\mathbf{x}, t) + C$（其中 $C$ 是任意常数）也是一个有效的解，因为两者产生完全相同的压力梯度 $\nabla p$。其次，当对方程进行离散化，尤其是在所有边界上都只规定速度（或压力梯度）而没有指定[绝对压力](@entry_id:144445)的封闭区域问题中，描述压力的离散[线性系统](@entry_id:147850)会是奇异的。这意味着该系统的[系数矩阵](@entry_id:151473)存在一个由常数向量构成的零空间。为了获得唯一的数值解，必须通过某种方式消除这种奇异性，例如在计算域的某一点上指定压力值，或约束压力的平均值。这个指定的参考压力是数值计算的需要，它不会影响最终的、具有物理意义的速度场，因为速度场仅由压力梯度驱动 。

### 全耦合系统及其求解困境

当我们将动量和连续性方程在有限体积网格上离散化后，理论上可以得到一个包含所有未知速度分量和压力的全耦合[线性方程组](@entry_id:148943)。这个系统通常可以写成一种典型的[分块矩阵](@entry_id:148435)形式，即**[鞍点问题](@entry_id:174221)**结构 ：

$$
\begin{bmatrix}
A & G \\
D & 0
\end{bmatrix}
\begin{bmatrix}
\mathbf{u} \\
p
\end{bmatrix}
=
\begin{bmatrix}
\mathbf{b} \\
0
\end{bmatrix}
$$

在这个系统中，$\mathbf{u}$ 和 $p$ 分别是所有控制体中心的速度和压力未知数构成的向量。矩阵 $A$ 代表离散的[对流-扩散](@entry_id:151021)算子，它耦合了各个速度分量。矩阵 $G$ 是离散的[梯度算子](@entry_id:1125719)，将压[力场](@entry_id:147325)转化为驱动动量的力。矩阵 $D$ 则是离散的[散度算子](@entry_id:265975)，作用于速度场以强制执行[质量守恒](@entry_id:204015)。

直接求解这个庞大的[鞍点系统](@entry_id:754480)面临着严峻的挑战。首先，由于右下角的零块，该[系统矩阵](@entry_id:172230)是**不定**的，这意味着它既有正特征值也有负特征值，这使得许多高效的[迭代求解器](@entry_id:136910)（如共轭梯度法）无法直接适用。其次，如前所述，由于压力的[规范自由度](@entry_id:160491)，该矩阵是**奇异**的。最后，对于实际工程问题中的大规模网格，这个全[耦合矩阵](@entry_id:191757)的规模巨大，直接求解（如[LU分解](@entry_id:144767)）的计算成本和内存需求往往高得令人无法接受 。

正是为了规避这些困难，研究人员开发了**分离式算法**（Segregated Algorithms）。SIMPLE（Semi-Implicit Method for Pressure-Linked Equations）及其衍生算法家族是这类方法中最著名和应用最广泛的代表。其核心思想是避免直接求解全耦合系统，而是通过一种迭代的“预测-校正”策略，将速度和压力的求解过程[解耦](@entry_id:160890)，从而将一个庞大、不定的[系统分解](@entry_id:274870)为一系列规模更小、性质更优良的子问题进行顺序求解。

### 预测-校正策略：SIMPLE算法的核心机制

SIMPLE算法家族的基石是一种巧妙的预测-校正迭代循环，旨在逐步逼近满足动量和[连续性方程](@entry_id:195013)的解。其基本步骤如下 ：

1.  **预测步 (Predictor Step)**：首先，根据上一迭代步得到的压[力场](@entry_id:147325) $p^*$（或一个初始猜测值），求解离散的[动量方程](@entry_id:197225)，得到一个临时的或称为“预测”的速度场 $\mathbf{u}^*$。这个速度场 $\mathbf{u}^*$ 满足了[动量平衡](@entry_id:1128118)（在给定 $p^*$ 的情况下），但通常不满足连续性方程，即 $\nabla \cdot \mathbf{u}^* \neq 0$。

2.  **校正步 (Corrector Step)**：此步的目标是找到一组速度校正量 $\mathbf{u}'$ 和压力校正量 $p'$，使得校正后的场 $\mathbf{u} = \mathbf{u}^* + \mathbf{u}'$ 和 $p = p^* + p'$（或 $p = p^* - p'$，符号约定取决于具体实现）能够同时满足动量和[连续性方程](@entry_id:195013)。
    
    关键在于建立 $\mathbf{u}'$ 和 $p'$ 之间的关系。通过从真实的[动量方程](@entry_id:197225)中减去用于计算预测速度的[动量方程](@entry_id:197225)，可以得到一个关于校正量的方程。SIMPLE算法在此处引入了一个核心简化：它假定一个控制体内的速度校正量主要由该控制体内的压力校正量梯度驱动，而忽略了相邻控制体速度校正量的影响。这导出一个近似的局部关系 ：
    
    $$
    \mathbf{u}' \approx -d \nabla p'
    $$
    
    其中系数 $d$ 与离散动量方程的对角系数 $a_P$ 和控制体体积 $V_P$ 有关，通常形式为 $d_P = V_P/a_P$。
    
    接下来，将校正后的速度 $\mathbf{u} = \mathbf{u}^* + \mathbf{u}'$ 代入[连续性方程](@entry_id:195013)，并要求其满足 $\nabla \cdot \mathbf{u} = 0$：
    
    $$
    \nabla \cdot (\mathbf{u}^* + \mathbf{u}') = 0 \implies \nabla \cdot \mathbf{u}' = - \nabla \cdot \mathbf{u}^*
    $$
    
    将上述 $\mathbf{u}'$ 与 $\nabla p'$ 的关系代入，我们便得到了一个关于压力校正量 $p'$ 的泊松型方程：
    
    $$
    \nabla \cdot (-d \nabla p') = - \nabla \cdot \mathbf{u}^*
    $$
    
    这个方程被称为**压力校正方程**。其源项 $(-\nabla \cdot \mathbf{u}^*)$ 正是预测步中速度场不满足连续性的程度，即质量不平衡的残差。通过求解这个椭圆型方程得到 $p'$ 场，我们就可以计算出能消除质量残差的速度校正量 $\mathbf{u}'$。
    
3.  **场更新**：最后，使用计算出的 $p'$ 和 $\mathbf{u}'$ 来更新压力和速度场。由于整个过程建立在一系列近似之上，一次迭代无法得到最终解，因此需要重复整个[预测-校正循环](@entry_id:270742)，直到速度和压[力场](@entry_id:147325)收敛，即动量和[连续性方程](@entry_id:195013)的残差都降低到足够小的水平。

### 网格布置的挑战与解决方案

在[有限体积法](@entry_id:141374)的实际应用中，变量的存储位置（即网格布置）对压力-速度耦合的稳定性有至关重要的影响。

#### 交错网格 (Staggered Grid)

早期的SIMPLE算法主要在**[交错网格](@entry_id:1125805)**上实现。在这种布置中，压力、温度等标量存储在控制体的中心，而速度分量则存储在控制体的面上（例如，$u$ 速度存储在东西两侧的面上，$v$ 速度存储在南北两侧的面上）。这种几何布置的巧妙之处在于，计算驱动面速度的压力梯度时，总是能直接使用该面两侧的两个相邻控制体中心的压力值。例如，驱动面 $e$ 上的速度 $u_e$ 的压力梯度自然地离散为 $(p_E - p_P)/\Delta x$。同样，计算控制体 $P$ 的质量通量时，所需要的面速度 $u_e, u_w, v_n, v_s$ 都已直接定义在所需位置，无需插值。

这种布置天然地避免了压[力场](@entry_id:147325)的“棋盘格”震荡问题。[棋盘格压力](@entry_id:164851)场（即压力值在相邻网格点间高低交错）在[交错网格](@entry_id:1125805)上会产生强烈的非零压力梯度，从而驱动速度场进行响应和调整，最终平滑掉这种非物理的震荡。因此，交错网格提供了非常稳健的压力-速度耦合机制 。然而，其缺点是编程复杂，尤其是在处理复杂几何和[非结构化网格](@entry_id:756354)时。

#### 同位网格 (Collocated Grid) 与[Rhie-Chow插值](@entry_id:154759)

现代CFD代码更倾向于使用**同位网格**，即将所有变量（速度分量和压力）都存储在控制体的中心。这种布置简化了编程和数据结构，但它也带来了新的挑战。如果在[同位网格](@entry_id:1122659)上使用简单的线性插值来获得计算通量所需的面速度，以及计算压力梯度，就会再次出现[压力-速度解耦](@entry_id:167545)问题。一个[棋盘格压力](@entry_id:164851)场可能在离散的动量和连续性方程中不被“感知”，导致求解过程中出现无法收敛的非物理压力震荡 。

为了解决这个问题，**[Rhie-Chow插值](@entry_id:154759)**被提出并得到广泛应用。其核心思想是修改面速度的计算方式，使其不仅依赖于相邻节点速度的插值，还显式地包含与该面两侧压力差相关的项。面速度 $u_f$ 的表达式大致如下 ：

$$
u_f = \tilde{u}_f - \frac{1}{a_f}(p_N - p_P)
$$

其中，$\tilde{u}_f$ 是通过对动量方程中除压力梯度外的所有项进行插值得到的速度部分，$a_f$ 是一个由相邻动量方程对角系数导出的面等效系数。当这个表达式被代入离散的连续性方程时，相邻的压力未知数 $p_P, p_N$ 等被直接耦合在一起，形成了一个离散的压力拉普拉斯算子。这个算子能有效地抑制棋盘格震荡，从而在同位网格上重建了稳健的压力-速度耦合  。

### SIMPLE算法家族：改进与演化

基于上述核心思想，发展出了多种SIMPLE算法的变体，它们通过不同的方式优化预测-校正过程，以期获得更快的收敛速度或更好的稳定性。

#### SIMPLE (Semi-Implicit Method for Pressure-Linked Equations)

这是最原始的算法。如前所述，它在推导速度校正量 $\mathbf{u}'$ 和压力校正量 $p'$ 的关系时，完全忽略了相邻速度校正项 $\sum_N a_N \mathbf{u}_N'$ 的影响 。这个过度的简化导致压力校正量被系统性地高估，如果不加抑制地使用这个校正量，迭代过程很容易发散。因此，SIMPLE算法必须配合一个较小的**压力[松弛因子](@entry_id:1130825)** $\alpha_p$ (通常在 0.1 到 0.3 之间)才能[稳定收敛](@entry_id:199422)。

#### SIMPLEC (SIMPLE-Consistent)

SIMPLEC算法旨在修正SIMPLE算法中过于简化的假设。它在推导速度校正关系时，做出了一个更“自洽” (Consistent) 的近似，即假设相邻控制体的速度校正量约等于当前控制体的速度校正量：$\mathbf{u}_N' \approx \mathbf{u}_P'$ 。将这个近似代入完整的速度校正方程，可以得到一个新的速度校正公式：

$$
u_P' = -\frac{(\nabla p')_P \cdot \mathbf{S}_P}{a_P - \sum_N a_N}
$$

与SIMPLE算法的公式相比，分母由 $a_P$ 变成了 $a_P - \sum_N a_N$。由于离散系数 $a_N$ 通常为正，这使得分母变小，从而增大了速度校正对压力校正的响应强度。这种更强的耦合关系使得压力校正的预测更为准确，大大提高了算法的[收敛速度](@entry_id:636873)和稳定性，并允许使用接近1.0的压力[松弛因子](@entry_id:1130825) 。

#### SIMPLER (SIMPLE-Revised)

SIMPLER算法采用了与SIMPLE和SIMPLEC截然不同的策略来改善压[力场](@entry_id:147325)的计算 。它的核心思想是在求解动量方程之前，先求解一个专门用于计算**[绝对压力](@entry_id:144445)** $p$ 本身的方程，而不是压力校正量 $p'$。

其步骤如下：
1.  首先，将离散动量方程改写为 $\mathbf{u} = \hat{\mathbf{u}} - \mathbf{D}\nabla p$ 的形式，其中 $\hat{\mathbf{u}}$ 是不包含压力梯度项的“伪速度”。
2.  将这个关系式代入[连续性方程](@entry_id:195013) $\nabla \cdot \mathbf{u} = 0$，得到一个关于真实压力 $p$ 的泊松方程：$\nabla \cdot (\mathbf{D}\nabla p) = \nabla \cdot \hat{\mathbf{u}}$。
3.  求解这个压力方程，得到一个比初始猜测好得多的压[力场](@entry_id:147325) $p$。
4.  使用这个新得到的压[力场](@entry_id:147325) $p$ 来求解[动量方程](@entry_id:197225)，获得新的速度场 $\mathbf{u}^*$。
5.  由于离散和近似，此时的 $\mathbf{u}^*$ 仍可能存在微小的质量不平衡。因此，最后再执行一个类似SIMPLE的校正步骤，但这个校正量通常很小。

SIMPLER算法每一步的计算量比SIMPLE更大（因为它多求解了一个压力方程），但由于其压[力场](@entry_id:147325)计算更准确，通常能以更少的迭代次数达到收敛，尤其适用于压[力场](@entry_id:147325)变化剧烈的问题 。

### 实际应用中的关键：欠松弛技术

无论是哪种SIMPLE变体，它们都是处理高度[非线性](@entry_id:637147)耦合方程组的迭代方法。为了保证这个迭代过程的[稳定收敛](@entry_id:199422)，**欠松弛**（Under-relaxation）技术是必不可少的。

对于一个通用变量 $\phi$，其更新过程可以表示为：
$$
\phi^{\mathrm{new}} = \phi^{\mathrm{old}} + \alpha_{\phi} (\phi^{*} - \phi^{\mathrm{old}})
$$
其中 $\phi^*$ 是当前迭代步求解器计算出的临时解，$\alpha_{\phi} \in (0, 1]$ 是[松弛因子](@entry_id:1130825)。

在SIMPLE算法家族中，主要对速度和压力进行[欠松弛](@entry_id:756302) ：
*   **速度欠松弛** ($ \alpha_u $)：主要用于稳定动量方程本身的[非线性](@entry_id:637147)，特别是当对流项或源项非常强时（如[高雷诺数流](@entry_id:1126089)动或强[浮力驱动流](@entry_id:155190)动）。通过限制每次迭代中速度变化的幅度，可以避免解的震荡。通常 $\alpha_u$ 的取值范围在 $[0.5, 0.8]$。

*   **压力欠松弛** ($ \alpha_p $)：压力更新公式为 $p^{\mathrm{new}} = p^{\mathrm{old}} + \alpha_p p'$。对于标准的SIMPLE算法，由于其系统性地高估了压力校正，必须使用一个较小的 $\alpha_p$（如 $[0.1, 0.3]$）来抑制这种过校正，从而稳定整个压力-速度耦合的迭代 。对于SIMPLEC和SIMPLER，由于其压力（或压力校正）计算更为准确，可以安全地使用更大的 $\alpha_p$ 值（通常接近1.0），这也是它们收敛更快的关键原因之一。

当面临数值计算困难的问题时（例如，[网格质量](@entry_id:151343)差、物性参数变化剧烈、强耦合效应等），降低[松弛因子](@entry_id:1130825)是提高[算法鲁棒性](@entry_id:635315)的首要手段。选择合适的[松弛因子](@entry_id:1130825)组合，是成功应用SIMPLE系列算法求解复杂工程问题的关键实践技能。