{
    "hands_on_practices": [
        {
            "introduction": "在有限体积法中，将所有变量（如速度和压力）存储在控制体中心的同位网格 (collocated grid) 是一种直观的布局。然而，这种看似简单的选择隐藏着一个关键的数值陷阱，即压力-速度解耦问题。本练习将引导您通过一个简单的思想实验，亲手揭示这个问题：您将构建一个非均匀的“棋盘格”压力场，并证明在这种情况下，标准的中心差分格式计算出的压力梯度竟然为零，从而使其对动量方程“隐形”。",
            "id": "3948408",
            "problem": "考虑不可压缩的纳维–斯托克斯方程，其连续性方程为 $\\,\\nabla \\cdot \\boldsymbol{u} = 0\\,$，动量方程为 $\\,\\rho \\,\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\rho\\,(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} = -\\nabla p + \\mu \\,\\nabla^{2}\\boldsymbol{u} + \\boldsymbol{s}\\,$，其中 $\\,\\boldsymbol{u}\\,$ 是速度，$\\,p\\,$ 是压力，$\\,\\rho\\,$ 是密度，$\\,\\mu\\,$ 是动力粘度，$\\,\\boldsymbol{s}\\,$ 是任意源项。在一个二维周期性域的均匀、笛卡尔、同位网格上，该域大小为 $\\,L_x \\times L_y\\,$，离散为 $\\,N_x \\times N_y\\,$ 个控制体，其间距为 $\\,\\Delta x = L_x/N_x\\,$ 和 $\\,\\Delta y = L_y/N_y\\,$。假设所有原始变量 $\\,u\\,$，$\\,v\\,$ 和 $\\,p\\,$ 都存储在由 $\\,i \\in \\{1,\\dots,N_x\\}\\,$ 和 $\\,j \\in \\{1,\\dots,N_y\\}\\,$ 索引的单元中心，且 $\\,N_x\\,$ 和 $\\,N_y\\,$ 均为偶数。\n\n在该同位网格上定义一个压力场为 $\\,p_{i,j} = p_0 \\,(-1)^{i+j}\\,$，其中 $\\,p_0 \\neq 0\\,$ 是一个常数。使用与有限体积法 (FVM) 一致的二阶中心差分，将离散的单元中心梯度 $\\,(\\partial p/\\partial x)_{i,j}\\,$ 和 $\\,(\\partial p/\\partial y)_{i,j}\\,$ 取为相应方向上相邻单元中心值的对称差分。将由单元 $\\, (i,j)\\,$ 和 $\\, (i+1,j)\\,$ 共享的内部东侧面上的法向压力梯度定义为法向方向上相邻单元中心梯度的算术平均值，并类似地定义由 $\\, (i,j)\\,$ 和 $\\, (i,j+1)\\,$ 共享的北侧面上的法向梯度。\n\n执行以下操作：\n- 从第一性原理构建离散的单元中心梯度，并针对给定的 $\\,p_{i,j}\\,$ 进行简化。\n- 使用这些梯度，评估任意内部东侧面或北侧面上的法向压力梯度，并证明其值。\n- 基于离散的动量和连续性方程，简要解释为什么这个结果意味着该同位中心差分格式存在压力-速度解耦。\n\n请提供在该 $\\,p_{i,j}\\,$ 条件下，任意内部面上的法向压力梯度值（计算出的数值）作为最终答案。以帕斯卡每米（$\\text{Pa}/\\text{m}$）表示最终的法向梯度。无需四舍五入；给出精确值。",
            "solution": "该问题要求在同位网格上对不可压缩纳维–斯托克斯方程中压力梯度项的特定离散化进行分析。我们必须首先计算给定“棋盘”压力场的离散压力梯度，然后解释其结果的物理和数值意义。\n\n控制方程为不可压缩纳维–斯托克斯方程：\n连续性方程：\n$$ \\nabla \\cdot \\boldsymbol{u} = 0 $$\n动量方程：\n$$ \\rho \\,\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\rho\\,(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} = -\\nabla p + \\mu \\,\\nabla^{2}\\boldsymbol{u} + \\boldsymbol{s} $$\n\n分析在一个二维均匀同位网格上进行，其中压力 $p$ 和速度分量 $(u,v)$ 存储在单元中心 $(i,j)$。所考虑的压力场是一个棋盘格式，定义为：\n$$ p_{i,j} = p_0 \\,(-1)^{i+j} $$\n其中 $p_0 \\neq 0$ 是一个常数。\n\n该过程涉及问题陈述中概述的三个步骤。\n\n**1. 构建离散的单元中心梯度**\n\n问题指定单元中心梯度应使用二阶中心差分计算，定义为相邻单元中心值的对称差分。\n\n对于单元中心 $(i,j)$ 处梯度的 $x$ 分量，$x$ 方向上的相邻单元是 $(i-1,j)$ 和 $(i+1,j)$。$x$ 方向上的网格间距是 $\\Delta x$。因此，离散梯度为：\n$$ \\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2\\Delta x} $$\n现在我们将给定的压力场 $p_{i,j} = p_0 (-1)^{i+j}$ 代入此表达式。相邻单元中心的压力值为：\n$$ p_{i+1,j} = p_0 (-1)^{(i+1)+j} = p_0 (-1)^{i+j} (-1)^1 = -p_0 (-1)^{i+j} $$\n$$ p_{i-1,j} = p_0 (-1)^{(i-1)+j} = p_0 (-1)^{i+j} (-1)^{-1} = -p_0 (-1)^{i+j} $$\n将这些值代入梯度公式：\n$$ \\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{(-p_0 (-1)^{i+j}) - (-p_0 (-1)^{i+j})}{2\\Delta x} = \\frac{0}{2\\Delta x} = 0 $$\n$x$ 方向上的单元中心压力梯度处处为零。\n\n类似地，对于单元中心 $(i,j)$ 处梯度的 $y$ 分量，相邻单元是 $(i,j-1)$ 和 $(i,j+1)$，网格间距是 $\\Delta y$。离散梯度为：\n$$ \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2\\Delta y} $$\n这些相邻点的压力值为：\n$$ p_{i,j+1} = p_0 (-1)^{i+(j+1)} = p_0 (-1)^{i+j} (-1)^1 = -p_0 (-1)^{i+j} $$\n$$ p_{i,j-1} = p_0 (-1)^{i+(j-1)} = p_0 (-1)^{i+j} (-1)^{-1} = -p_0 (-1)^{i+j} $$\n将这些值代入梯度公式：\n$$ \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{(-p_0 (-1)^{i+j}) - (-p_0 (-1)^{i+j})}{2\\Delta y} = \\frac{0}{2\\Delta y} = 0 $$\n$y$ 方向上的单元中心压力梯度也处处为零。\n\n**2. 评估面法向压力梯度**\n\n问题将面法向压力梯度定义为法向方向上相邻单元中心梯度的算术平均值。\n\n考虑由单元 $(i,j)$ 和 $(i+1,j)$ 共享的内部东侧面。法向为 $x$ 方向。该面上的法向压力梯度（可由索引 $(i+1/2,j)$ 表示）为：\n$$ \\left( \\nabla_d p \\right)_x \\Big|_{i+1/2,j} = \\frac{1}{2} \\left[ \\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} + \\left(\\frac{\\partial p}{\\partial x}\\right)_{i+1,j} \\right] $$\n从上一步中，我们发现对于所有 $(i,j)$，$(\\partial p/\\partial x)_{i,j} = 0$。因此：\n$$ \\left( \\nabla_d p \\right)_x \\Big|_{i+1/2,j} = \\frac{1}{2} \\left[ 0 + 0 \\right] = 0 $$\n\n现在，考虑由单元 $(i,j)$ 和 $(i,j+1)$ 共享的内部北侧面。法向为 $y$ 方向。该面上的法向压力梯度（表示为 $(i,j+1/2)$）为：\n$$ \\left( \\nabla_d p \\right)_y \\Big|_{i,j+1/2} = \\frac{1}{2} \\left[ \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} + \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+1} \\right] $$\n从上一步中，我们发现对于所有 $(i,j)$，$(\\partial p/\\partial y)_{i,j} = 0$。因此：\n$$ \\left( \\nabla_d p \\right)_y \\Big|_{i,j+1/2} = \\frac{1}{2} \\left[ 0 + 0 \\right] = 0 $$\n因此，对于给定的棋盘式压力场，在网格的任何内部面上，$x$ 和 $y$ 方向的面法向压力梯度都恰好为 $0$。\n\n**3. 压力-速度解耦的解释**\n\n一个非均匀压力场产生零离散梯度的结果，对数值解的稳定性和准确性具有深远影响。这种现象被称为压力-速度解耦。\n\n在不可压缩纳维–斯托克斯方程的数值方法（如投影法或 SIMPLE 型算法）中，动量方程中的压力梯度项 $-\\nabla p$ 充当驱动速度场的力。压力场的主要作用是自我调整，以使最终的速度场 $\\boldsymbol{u}$ 满足连续性方程 $\\nabla \\cdot \\boldsymbol{u} = 0$。\n\n我们的计算表明，当离散压力梯度算子应用于高频棋盘式压力模式 $p_{i,j}=p_0(-1)^{i+j}$ 时，其计算结果为零。这意味着离散动量方程对这种压力模式完全不敏感。如果在模拟中出现这样的压力场，它不会对流体施加任何力，因此不会以任何方式影响速度场。\n\n因此，数值格式没有机制来抑制这些伪压力振荡。对于这种特定的空间模式，速度场和压力场变得“解耦”。一个非物理的、振荡的压力解可以与一个光滑的、物理上合理的速度场共存，但它们的组合并不代表控制方程的真实解。压力求解器可能会产生一个棋盘式解来满足离散形式的压力泊松方程，但由此产生的梯度为零，无法强制执行满足质量守恒（连续性）所需的速度修正。\n\n这种失效是使用简单中心差分计算压力梯度的同位网格配置中的一个经典问题。这也是使用替代离散化策略的主要动机，例如：\n- **交错网格 (MAC 格式):** 速度分量存储在单元面上，而压力存储在单元中心。这种布置自然地将相邻单元之间的压力差与它们之间面上的速度分量耦合起来。\n- **同位网格上的压力稳定技术:** 像 Rhie-Chow 插值这样的方法通过修改面速度的计算来重新引入压力和速度之间的耦合，从而有效地防止这些奇偶振荡。\n\n总而言之，棋盘式压力场的面法向梯度为零，这揭示了简单同位中心差分格式的一个基本缺陷，即离散算子允许非物理的压力模式存在于压力梯度算子的零空间中，从而导致与速度场解耦。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在认识到同位网格上存在压力-速度解耦的挑战后 ()，我们自然会探寻其解决方案。诸如 Rhie-Chow 插值等压力-速度耦合策略正是为此而生。本练习结合了理论推导与编程实践，旨在让您深入理解这些稳定化方法的机理：您将首先推导简化的离散算子，然后通过编写一个数值实验，亲自观察并量化该方法如何有效抑制虚假的压力振荡模式。",
            "id": "3948393",
            "problem": "考虑在计算热工学背景下，同位网格上不可压缩Navier–Stokes (INS) 方程的一维、均匀、周期性离散化。从基本定律出发：无散度约束（连续性）$\\nabla \\cdot \\mathbf{u} = 0$ 和线性化动量平衡，其中显式压力梯度驱动面法向速度。Rhie–Chow插值 (RC) 是一种压力-速度耦合策略，它通过包含一个由离散化动量算子对角线元素加权的压力梯度项来计算面法向速度。相反，一种省略RC修正的朴素插值方法会将压力与面法向质量通量解耦，从而产生伪压力模式。\n\n从第一性原理出发，在一个具有$N$个单元中心（位置为$x_i$，间距为$\\Delta x$）的均匀一维周期性网格上，推导离散的压力-散度算子。设面$i+\\frac{1}{2}$处的离散面法向速度为$u_{i+\\frac{1}{2}}$，单元中心压力为$p_i$。定义离散面梯度算子 $\\mathcal{G}$，该算子通过Rhie–Chow插值 (RC) 模型将$p$映射到面法向速度增量\n$$\nu_{i+\\frac{1}{2}} = -\\frac{1}{a} \\frac{p_{i+1}-p_i}{\\Delta x},\n$$\n其中$a>0$代表离散化动量算子的对角线元素（包括诸如密度除以时间步长和粘性扩散等贡献项）。定义离散散度算子$\\mathcal{C}$，该算子将面法向速度映射到单元中心的散度：\n$$\n[\\mathcal{C}\\, \\mathbf{u}]_i = \\frac{u_{i+\\frac{1}{2}} - u_{i-\\frac{1}{2}}}{\\Delta x}.\n$$\n证明作用于$p$的复合离散算子$S = \\mathcal{C}\\, A^{-1}\\, \\mathcal{G}$在均匀网格上简化为\n$$\nS = -\\frac{1}{a\\, \\Delta x^2} L,\n$$\n其中$A^{-1}$表示乘以$\\frac{1}{a}$，$L$是由以下公式定义的具有周期性边界条件的二阶差分矩阵\n$$\n[L p]_i = p_{i+1} - 2 p_i + p_{i-1}.\n$$\n解释为何在此简化模型中，朴素的非Rhie–Chow（无RC）插值导致$u_{i+\\frac{1}{2}}$与$p$无关，从而产生一个不作用于压力的有效算子$S$（即，对于此耦合路径，$S$是零算子），使得伪压力模式能够持续存在而无阻尼。\n\n设计一个数值实验，以测量在由下式控制的压力显式伪时间松弛下伪压力模式的阻尼率\n$$\np^{n+1} = p^n - \\alpha\\, S\\, p^n,\n$$\n其中$\\alpha = \\gamma\\, a\\, \\Delta x^2$，$\\gamma>0$是一个无量纲松弛参数。对伪压力模式使用初始条件\n$$\np_i^0 = (-1)^i,\n$$\n这是偶数$N$网格上的最高波数棋盘格模式。对于Rhie–Chow情况（有RC），显式更新使用上面推导出的$S$。对于非Rhie–Chow情况（无RC），使用$S=\\mathbf{0}$来表示此简化模型中解耦的压力-速度路径。经过$m$次迭代后，将每次迭代的阻尼率测量为\n$$\nd = \\frac{1}{m} \\ln\\left(\\frac{\\|p^m\\|_2}{\\|p^0\\|_2}\\right).\n$$\n\n实现一个完整、可运行的程序，该程序：\n- 为给定的$N$构建周期性二阶差分矩阵$L$。\n- 在Rhie–Chow情况下，构造$S$为$S = -\\frac{1}{a\\, \\Delta x^2} L$；在非Rhie–Chow情况下，设置$S=\\mathbf{0}$。\n- 使用$p^{n+1} = p^n - \\alpha S p^n$（其中$\\alpha = \\gamma\\, a\\, \\Delta x^2$）将$p$演化$m$次迭代。\n- 按上文规定计算阻尼率$d$。\n\n本实验中的所有量均为无量纲；无需物理单位。不涉及角度。最终的阻尼率必须以浮点数形式报告。\n\n使用以下参数值测试套件，该套件覆盖了一般行为、网格加密和一个重要的边缘情况：\n- 案例 1：$N=8, a=1, \\gamma=0.05, m=10$，使用RC。\n- 案例 2：$N=8, a=1, \\gamma=0.05, m=10$，不使用RC。\n- 案例 3：$N=16, a=2, \\gamma=0.2, m=5$，使用RC。\n- 案例 4：$N=16, a=2, \\gamma=0.2, m=5$，不使用RC。\n- 案例 5：$N=4, a=1, \\gamma=0.25, m=1$，使用RC。\n- 案例 6：$N=4, a=1, \\gamma=0.25, m=1$，不使用RC。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,\\dots]$），其中每个$result_k$是按上述顺序排列的相应案例的测量阻尼率$d$。",
            "solution": "该问题要求推导离散的压力-散度算子，解释Rhie–Chow插值的作用，并实现一个数值实验来量化其对伪压力模式的影响。该问题在科学上是合理的、内容自洽且适定的。\n\n推导从给定的离散算子开始，这些算子用于一个具有$N$个单元和间距$\\Delta x$的一维、均匀、周期性网格。压力$p$位于单元中心$x_i$，速度$u$位于单元面$x_{i \\pm 1/2}$。\n\n该问题基于Rhie–Chow (RC) 插值概念，定义了一个面法向速度$u_{i+1/2}$的简化模型。该模型将面$i+1/2$处的速度与该面上的压力梯度联系起来：\n$$\nu_{i+1/2} = -\\frac{1}{a} \\frac{p_{i+1}-p_i}{\\Delta x}\n$$\n此处，$p_i$和$p_{i+1}$是与该面相邻单元中的压力，$a>0$是代表离散化动量算子对角线元素的常数。该表达式表示算子乘积$A^{-1}\\mathcal{G}$对压力场$p$的作用，其中$\\mathcal{G}$是离散梯度算子，$A^{-1}$表示乘以$1/a$。设$\\mathbf{u}$为面速度向量。其$i+1/2$分量由$[\\mathbf{u}]_{i+1/2} = [A^{-1}\\mathcal{G}\\, p]_{i+1/2} = u_{i+1/2}$给出。\n\n接下来，离散散度算子$\\mathcal{C}$将面法向速度场$\\mathbf{u}$映射到单元中心散度场。其在单元$i$处的作用定义为：\n$$\n[\\mathcal{C}\\, \\mathbf{u}]_i = \\frac{u_{i+\\frac{1}{2}} - u_{i-\\frac{1}{2}}}{\\Delta x}\n$$\n这是在单元中心$x_i$处对散度$\\partial u / \\partial x$的标准中心差分近似。\n\n复合算子$S = \\mathcal{C}\\, A^{-1}\\, \\mathcal{G}$将单元中心压力场$p$映射到单元中心散度场。为求其显式形式，我们将面速度的表达式代入散度公式。$S$在单元$i$处对$p$的作用，记为$[S\\, p]_i$，是：\n$$\n[S\\, p]_i = [\\mathcal{C}\\, (A^{-1}\\mathcal{G}\\, p)]_i = \\frac{[A^{-1}\\mathcal{G}\\, p]_{i+\\frac{1}{2}} - [A^{-1}\\mathcal{G}\\, p]_{i-\\frac{1}{2}}}{\\Delta x}\n$$\n代入给定的速度公式：\n$$\n[S\\, p]_i = \\frac{1}{\\Delta x} \\left( \\left(-\\frac{1}{a} \\frac{p_{i+1}-p_i}{\\Delta x}\\right) - \\left(-\\frac{1}{a} \\frac{p_i-p_{i-1}}{\\Delta x}\\right) \\right)\n$$\n提出常数项$-\\frac{1}{a \\Delta x^2}$：\n$$\n[S\\, p]_i = -\\frac{1}{a \\Delta x^2} \\left( (p_{i+1}-p_i) - (p_i-p_{i-1}) \\right)\n$$\n简化括号内的表达式，得到二阶导数的标准三点格式：\n$$\n[S\\, p]_i = -\\frac{1}{a \\Delta x^2} (p_{i+1} - 2p_i + p_{i-1})\n$$\n这证实了算子$S$的作用等价于应用周期性二阶差分矩阵$L$（其中$[Lp]_i = p_{i+1} - 2p_i + p_{i-1}$），并将结果乘以$-\\frac{1}{a \\Delta x^2}$。因此，我们证明了$S = -\\frac{1}{a \\Delta x^2} L$。算子$S$是一个按比例缩放的离散泊松算子，它是不可压缩Navier-Stokes方程压力修正格式的基础。\n\n在朴素的非Rhie–Chow插值情况下，压力-速度耦合被破坏。问题陈述断言，该格式“将压力与面法向质量通量解耦”。在我们的简化模型背景下，这意味着面速度$u_{i+1/2}$不再依赖于局部压力梯度$\\frac{p_{i+1}-p_i}{\\Delta x}$。将压力映射到速度增量的算子$\\mathcal{G}$成为零算子，即$\\mathcal{G}=\\mathbf{0}$。因此，依赖于$\\mathcal{G}$的复合算子$S$也必定是零算子：$S = \\mathcal{C}\\, A^{-1}\\, \\mathcal{G} = \\mathbf{0}$。\n\n数值实验研究由$p^{n+1} = p^n - \\alpha\\, S\\, p^n$控制的压力伪时间松弛。\n当应用Rhie–Chow修正时，$S = -\\frac{1}{a \\Delta x^2}L$。松弛参数为$\\alpha = \\gamma a \\Delta x^2$，其中$\\gamma>0$。更新规则变为：\n$$\np^{n+1} = p^n - (\\gamma a \\Delta x^2) \\left(-\\frac{1}{a \\Delta x^2} L\\right) p^n = p^n + \\gamma L p^n = (I + \\gamma L) p^n\n$$\n初始条件是棋盘格模式$p_i^0 = (-1)^i$，这是网格上的最高频率模式，也是$L$的一个特征向量，其特征值为-4。该模式的更新规则简化为$p^{n+1} = (1 - 4\\gamma)p^n$。这表明对于$\\gamma \\in (0, 0.5)$，该模式是被阻尼的，因为$|1-4\\gamma|<1$。\n\n当省略Rhie–Chow修正时（无RC），$S = \\mathbf{0}$。更新规则变为：\n$$\np^{n+1} = p^n - \\alpha (\\mathbf{0}) p^n = p^n\n$$\n在这种情况下，压力场不会演化。任何初始的伪模式，如$p_i^0 = (-1)^i$，都将无限期地持续存在。测量的阻尼率$d = \\frac{1}{m} \\ln\\left(\\frac{\\|p^m\\|_2}{\\|p^0\\|_2}\\right)$将是$\\frac{1}{m}\\ln(1) = 0$。这证明了Rhie–Chow插值在提供一种能够阻尼伪压力振荡的耦合机制方面起着关键作用。\n\n数值实验将在一系列测试案例中，为这两种情况精确地量化此阻尼率$d$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the damping rate of a spurious pressure mode in a 1D periodic system\n    with and without Rhie-Chow (RC) interpolation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'N': 8, 'a': 1, 'gamma': 0.05, 'm': 10, 'with_rc': True, 'label': 'Case 1'},\n        {'N': 8, 'a': 1, 'gamma': 0.05, 'm': 10, 'with_rc': False, 'label': 'Case 2'},\n        {'N': 16, 'a': 2, 'gamma': 0.2, 'm': 5, 'with_rc': True, 'label': 'Case 3'},\n        {'N': 16, 'a': 2, 'gamma': 0.2, 'm': 5, 'with_rc': False, 'label': 'Case 4'},\n        {'N': 4, 'a': 1, 'gamma': 0.25, 'm': 1, 'with_rc': True, 'label': 'Case 5'},\n        {'N': 4, 'a': 1, 'gamma': 0.25, 'm': 1, 'with_rc': False, 'label': 'Case 6'},\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case['N']\n        gamma = case['gamma']\n        m = case['m']\n        with_rc = case['with_rc']\n\n        # Initial condition: high-frequency checkerboard mode\n        p0 = np.array([(-1)**i for i in range(N)], dtype=np.float64)\n        \n        # Calculate the initial L2-norm\n        norm_p0 = np.linalg.norm(p0)\n        \n        # Initialize pressure for time evolution\n        p = np.copy(p0)\n\n        if with_rc:\n            # For the RC case, evolve the pressure field using the update rule:\n            # p^{n+1} = p^n + gamma * L * p^n\n            # The action of the periodic second-difference matrix L on p,\n            # [Lp]_i = p_{i+1} - 2p_i + p_{i-1},\n            # can be implemented efficiently using np.roll.\n            for _ in range(m):\n                Lp = np.roll(p, -1) + np.roll(p, 1) - 2 * p\n                p = p + gamma * Lp\n        else:\n            # For the non-RC case, the operator S is zero, so pressure does not change.\n            # p^m = p^0.\n            pass\n\n        pm = p\n        \n        # Calculate the final L2-norm\n        norm_pm = np.linalg.norm(pm)\n\n        # Calculate the damping rate d per iteration.\n        # d = (1/m) * ln(||p^m||_2 / ||p^0||_2)\n        # We must handle the case where the initial norm is zero, though not possible\n        # with the given initial condition.\n        if norm_p0 == 0:\n            # If the initial state is zero, damping is ill-defined.\n            # If the final state is also zero, we can consider the rate to be 0.\n            # Otherwise, it's infinite growth from nothing, which is not physical.\n            d = 0.0 if norm_pm == 0 else np.inf\n        else:\n            ratio = norm_pm / norm_p0\n            # np.log(0) correctly returns -inf, which is the expected result\n            # for perfect damping in a finite number of steps (e.g., Case 5).\n            d = (1.0 / m) * np.log(ratio)\n        \n        results.append(d)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "解决了核心的压力-速度耦合问题后，我们转向任何计算流体动力学 (CFD) 模拟都不可或缺的另一个方面：边界条件的处理。本练习聚焦于不可压 Navier-Stokes 方程中的黏性扩散项在固壁处的离散化。您将推导在无滑移 (no-slip) 边界条件下，壁面法向的扩散通量如何表示，并理解其如何体现在有限体积法的代数方程组中，从而掌握将物理约束转化为数值实现的基本技能。",
            "id": "3948422",
            "problem": "考虑一个具有恒定动力粘度 $\\mu$ 和密度 $\\rho$ 的牛顿流体的不可压缩纳维-斯托克斯动量方程。关注与一个静止、不可渗透、无滑移壁面相邻的控制体中，单个笛卡尔速度分量 $u_{i}$ 的扩散项。使用有限体积法（FVM），通过散度定理，控制体 $V_{P}$ 上 $u_{i}$ 的半离散平衡中的粘性扩散贡献来自于梯度的面积分，表现为一系列面通量之和。设控制体 $V_{P}$ 有一个与壁面重合的边界面 $f$，其面积为 $A_{f}$，从 $V_{P}$ 指出的单位外法向量为 $\\boldsymbol{n}_{f}$，与壁面法线方向对齐。记从网格中心 $P$ 沿 $\\boldsymbol{n}_{f}$ 到壁面的距离为 $d_{Pw}$。壁面处的狄利克雷边界条件是无滑移条件 $u_{i}(w)=0$。使用沿 $\\boldsymbol{n}_{f}$ 的单边线性梯度重构，根据网格中心的 $u_{i}$ 值和指定的壁面值来近似面 $f$ 上的壁面法向导数。\n\n从扩散算子的积分形式和第一性原理（散度定理和牛顿粘性）出发，推导通过边界面 $f$ 的 $u_{i}$ 的壁面法向粘性扩散通量的符号表达式，用 $\\mu$、$A_{f}$、$u_{P,i}$ 和 $d_{Pw}$ 表示。通过识别其对对角系数和源项的影响，解释最终的离散面通量如何在组装的 $u_{i}$ 线性系统中强制施加狄利克雷边界条件。只需报告无滑移壁面情况下通过面 $f$ 的壁面法向扩散通量的最终符号表达式。不需要进行数值计算，最终表达式中不应包含任何单位。",
            "solution": "所述问题在科学上是合理的、适定的、客观的且自洽的。它提出了计算流体动力学中有限体积法发展过程中的一个标准的、基本的任务。所有提供的信息都是一致且足以推导出所要求的表达式和解释的。因此，该问题被认为是有效的。\n\n目标是推导速度分量 $u_i$ 通过无滑移壁面边界的粘性扩散通量表达式，并解释在有限体积法（FVM）背景下其对最终线性代数系统的影响。\n\n分析始于不可压缩纳维-斯托克斯动量方程中速度分量 $u_i$ 的扩散项，即 $\\nabla \\cdot (\\mu \\nabla u_i)$，其中 $\\mu$ 是恒定的动力粘度。根据FVM，该项在一个控制体 $V_P$ 上进行积分：\n$$\n\\int_{V_P} \\nabla \\cdot (\\mu \\nabla u_i) \\, dV\n$$\n通过应用高斯散度定理，这个体积分被转换为在控制体边界 $\\partial V_P$ 上的面积分。边界 $\\partial V_P$ 由若干个面组成，积分变成这些面上的通量之和：\n$$\n\\int_{V_P} \\nabla \\cdot (\\mu \\nabla u_i) \\, dV = \\oint_{\\partial V_P} (\\mu \\nabla u_i) \\cdot \\boldsymbol{n} \\, dS = \\sum_{j} \\int_{f_j} (\\mu \\nabla u_i) \\cdot \\boldsymbol{n}_j \\, dS\n$$\n其中，求和遍历控制体的所有面 $f_j$，$\\boldsymbol{n}_j$ 是面 $f_j$ 上的外向单位法向量。\n\n我们关心的是与静止壁面重合的面 $f$ 的特定贡献。通过该面的通量，我们记为 $J_f$，由以下公式给出：\n$$\nJ_f = \\int_{f} (\\mu \\nabla u_i) \\cdot \\boldsymbol{n}_f \\, dS\n$$\n这里，$\\boldsymbol{n}_f$ 是从控制体 $V_P$ 指出的单位外法向量，指向壁面。假设被积函数在面面积 $A_f$ 上是恒定的，并可在面中心处求值，则该表达式简化为：\n$$\nJ_f \\approx \\mu A_f ((\\nabla u_i)_f \\cdot \\boldsymbol{n}_f)\n$$\n项 $(\\nabla u_i)_f \\cdot \\boldsymbol{n}_f$ 表示 $u_i$ 在面 $f$ 处沿外法向量 $\\boldsymbol{n}_f$ 方向的方向导数。这是壁面法向梯度分量。问题指定，该导数需使用基于网格中心 $P$ 处的 $u_i$ 值（记为 $u_{P,i}$）和壁面上的值 $u_i(w)$ 的单边线性梯度重构来近似。\n\n可用于近似的点是网格中心 $P$ 和壁面位置 $w$。从壁面 $w$ 到网格中心 $P$ 的向量为 $\\vec{wP} = -d_{Pw} \\boldsymbol{n}_f$，其中 $d_{Pw}$ 是垂直距离。可以构建壁面 $w$ 处方向导数 $\\nabla u_i \\cdot \\boldsymbol{n}_f$ 的有限差分近似。使用沿 $\\boldsymbol{n}_f$ 方向的后向差分格式（使用点 $w$ 和点 $w - d_{Pw}\\boldsymbol{n}_f = P$）：\n$$\n(\\nabla u_i)_f \\cdot \\boldsymbol{n}_f \\approx \\frac{u_i(w) - u_{P,i}}{d_{Pw}}\n$$\n将此近似代入通量 $J_f$ 的表达式中：\n$$\nJ_f \\approx \\mu A_f \\left( \\frac{u_i(w) - u_{P,i}}{d_{Pw}} \\right)\n$$\n问题指定了一个静止的无滑移壁面。这是一个狄利克雷边界条件，其中流体在壁面上的速度为零：$u_i(w) = 0$。应用此条件，得到通过壁面的外向粘性扩散通量的最终表达式：\n$$\nJ_f = -\\frac{\\mu A_f u_{P,i}}{d_{Pw}}\n$$\n该表达式表示动量的第 i 个分量通过壁面 $f$ 从控制体 $V_P$ 中输运出去的速率。负号表示，对于典型的边界层，其中 $u_{P,i} > 0$，动量从流体向壁面扩散，这与外法向量 $\\boldsymbol{n}_f$ 的方向相反。\n\n接下来，我们解释该通量项如何在组装的线性系统中强制施加狄利克雷边界条件。控制体 $V_P$ 中 $u_{P,i}$ 演化的半离散FVM方程具有以下通用形式：\n$$\n\\frac{d(\\rho V_P u_{P,i})}{dt} = \\sum_{j} (\\text{通过面 j 进入控制体的通量}) + \\text{源项}\n$$\n从壁面 $f$ *进入*控制体 $V_P$ 的扩散通量是外向通量的负值，即 $-J_f$。\n$$\n\\text{从壁面进入控制体的通量} = -J_f = -\\left( \\mu A_f \\frac{u_i(w) - u_{P,i}}{d_{Pw}} \\right) = \\frac{\\mu A_f}{d_{Pw}} (u_{P,i} - u_i(w))\n$$\n在隐式时间步进格式（例如，隐式欧拉）或稳态问题中，此通量贡献被并入 $u_{P,i}$ 的代数方程中，该方程通常排列成以下形式：\n$$\na_P u_{P,i} = \\sum_{nb} a_{nb} u_{nb,i} + S_u\n$$\n其中 $a_P$ 是对角系数，$a_{nb}$ 是相邻网格的非对角系数，$S_u$ 是源项。\n\n来自壁面的通量贡献 $\\frac{\\mu A_f}{d_{Pw}} (u_{P,i} - u_i(w))$ 被线性化并拆分。我们将其重写为：\n$$\n\\frac{\\mu A_f}{d_{Pw}} u_{P,i} - \\frac{\\mu A_f}{d_{Pw}} u_i(w)\n$$\n该项对最终代数方程的贡献被分为两部分：\n1.  **对对角系数（$a_P$）的影响：** 与未知数 $u_{P,i}$ 成比例的项影响对角系数。在标准的FVM实践中，进入控制体的通量中与 $u_{P,i}$ 相关的部分会贡献给对角系数 $a_P$。通量项 `\\frac{\\mu A_f}{d_{Pw}} u_{P,i}` 意味着对角系数 $a_P$ 增加了 $\\frac{\\mu A_f}{d_{Pw}}$。这会增强矩阵的对角优势，有利于数值稳定性。\n2.  **对源项（$S_u$）的影响：** 不依赖于控制中心未知数 $u_{P,i}$ 的项 `- \\frac{\\mu A_f}{d_{Pw}} u_i(w)` 被作为源项处理。这一项被加到源项 $S_u$ 中。对于无滑移条件，$u_i(w)=0$，因此对源项的贡献为零。边界条件完全通过修改矩阵对角系数来施加。\n\n总之，对于无滑移壁面，粘性扩散通量隐式地引入了一个项，使对角矩阵系数 $a_P$ 增加 $\\frac{\\mu A_f}{d_{Pw}}$，同时不影响源项 $S_u$。这正确地施加了由无滑移条件产生的壁面剪切应力。",
            "answer": "$$\n\\boxed{-\\frac{\\mu A_f u_{P,i}}{d_{Pw}}}\n$$"
        }
    ]
}