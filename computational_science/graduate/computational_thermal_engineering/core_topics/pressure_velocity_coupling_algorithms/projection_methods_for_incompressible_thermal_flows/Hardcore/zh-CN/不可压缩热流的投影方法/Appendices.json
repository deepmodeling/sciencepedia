{
    "hands_on_practices": [
        {
            "introduction": "投影方法的核心在于将不可压缩性约束转化为一个可解的压力方程。本练习将引导你使用有限体积法（FVM），从基本原理出发，将连续的压力泊松方程转化为其离散形式。通过推导该线性系统的系数，你将对压力和速度如何在离散层面耦合有一个根本性的理解，这是构建任何计算流体动力学（CFD）求解器的关键一步 。",
            "id": "3980165",
            "problem": "考虑一个二维不可压缩的热驱动流，该流动在Boussinesq近似下，由温度引起的密度变化很小，且仅在动量方程中影响浮力项。该流动采用有限体积法（FVM）在均匀、正交的笛卡尔网格上进行离散，其中压力位于单元中心，速度位于单元面中心。设一个通用的内部控制体积为单元$P$，其体积为$V_{P}$，东、西面面积分别为$S_{e} = \\Delta y$和$S_{w} = \\Delta y$，南、北面面积分别为$S_{n} = \\Delta x$和$S_{s} = \\Delta x$，中心间距分别为$d_{pe} = \\Delta x$、$d_{pw} = \\Delta x$、$d_{pn} = \\Delta y$和$d_{ps} = \\Delta y$。假设密度$\\rho$为常数，时间步长为$\\Delta t$。\n\n从计算流体力学（CFD）中的不可压缩连续性方程和投影法框架出发，构建基于通量的离散散度算子，该算子等于跨面法向质量通量的净和除以体积；并构建基于通量的离散梯度算子，该算子等于压力的两点法向差分除以中心间距。使用这些算子，推导用于压力增量的全离散压力系统，该系统强制要求在新的时间层级上，每个单元面的净质量通量为零。假设中间速度场$\\mathbf{u}^{*}$已通过不含压力梯度的动量和能量更新得到。\n\n对于上述均匀网格，请确定最终得到的内部单元$P$的压力线性系统中的对角系数$A_{P}$。该线性系统以标准的类扩散模板形式书写，其中对角项为正，最近邻的非对角项为负。请将无量纲量$A_{P}/\\Delta t$以$\\Delta x$和$\\Delta y$的闭式表达式形式报告。请勿代入任何数值。将最终答案表示为单个解析表达式。",
            "solution": "用户要求推导由不可压缩流的投影法产生的离散压力方程的对角系数。该问题定义明确，科学上合理，并包含了二维均匀笛卡尔网格上内部控制体积所需的所有信息。\n\n求解过程始于投影法的核心原理。该方法通过先计算一个不满足不可压缩性约束的中间速度场$\\mathbf{u}^{*}$，然后将其投影到一个无散度空间来求解新时间步的速度场$\\mathbf{u}^{n+1}$，从而解耦速度和压力场。\n\n投影法中的速度更新步骤将最终速度$\\mathbf{u}^{n+1}$与中间速度$\\mathbf{u}^{*}$通过一个类压力变量的梯度联系起来。根据问题中提到的“压力增量”，我们将此变量记为$P'$。更新方程为：\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla P'\n$$\n此处，$\\Delta t$是时间步长，$\\rho$是恒定密度。中间速度$\\mathbf{u}^{*}$假定已通过求解不含压力梯度项的动量方程得到。\n\n不可压缩流的基本约束是速度场在任何时候都必须是无散度的。对于新的时间步，这表示为：\n$$\n\\nabla \\cdot \\mathbf{u}^{n+1} = 0\n$$\n将速度更新方程代入不可压缩性约束，得到连续的压力修正方程：\n$$\n\\nabla \\cdot \\left(\\mathbf{u}^{*} - \\frac{\\Delta t}{\\rho} \\nabla P'\\right) = 0\n$$\n假设$\\rho$和$\\Delta t$为常数，并重新整理各项，我们得到一个关于压力修正$P'$的泊松方程：\n$$\n\\nabla^2 P' = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\mathbf{u}^{*}\n$$\n\n现在我们使用有限体积法（FVM）在指定的控制体积$P$上对此关系进行离散化。不可压缩性约束$\\nabla \\cdot \\mathbf{u}^{n+1} = 0$在控制体积$V_P$上的积分形式为：\n$$\n\\int_{V_P} \\nabla \\cdot \\mathbf{u}^{n+1} \\, dV = 0\n$$\n应用散度定理，这变成了一个关于通过控制体各面的净质量通量为零的陈述：\n$$\n\\sum_{f} (\\rho \\mathbf{u}^{n+1} \\cdot \\mathbf{n} S)_f = 0\n$$\n其中，求和遍历控制体积的所有面（东$e$、西$w$、北$n$、南$s$），$\\mathbf{n}$是面的外指单位法向量，$S_f$是面面积。对于二维笛卡尔网格，这展开为：\n$$\n(\\rho u S)_e - (\\rho u S)_w + (\\rho v S)_n - (\\rho v S)_s = 0\n$$\n速度$u$和$v$是垂直于面的分量，在面中心处取值。在时间层级$n+1$时每个面上的速度通过离散化速度更新方程得到。问题指定了离散梯度算子使用“两点法向差分”。将其应用于面中心速度，可得：\n$$\nu_e^{n+1} = u_e^{*} - \\frac{\\Delta t}{\\rho} \\frac{P'_E - P'_P}{d_{pe}}\n$$\n$$\nu_w^{n+1} = u_w^{*} - \\frac{\\Delta t}{\\rho} \\frac{P'_P - P'_W}{d_{pw}}\n$$\n$$\nv_n^{n+1} = v_n^{*} - \\frac{\\Delta t}{\\rho} \\frac{P'_N - P'_P}{d_{pn}}\n$$\n$$\nv_s^{n+1} = v_s^{*} - \\frac{\\Delta t}{\\rho} \\frac{P'_P - P'_S}{d_{ps}}\n$$\n此处，$P'_P, P'_E, P'_W, P'_N, P'_S$分别是单元$P$及其东、西、北、南相邻单元中心的压力修正值。$d_{pe}$等项是单元中心之间的距离。\n\n我们将这些离散速度表达式代入离散化的连续性方程。我们来分析每个面的质量通量项：\n通过东面的质量流率是$\\dot{m}_e^{n+1} = (\\rho u S)_e^{n+1}$：\n$$\n\\dot{m}_e^{n+1} = \\rho S_e \\left(u_e^{*} - \\frac{\\Delta t}{\\rho} \\frac{P'_E - P'_P}{d_{pe}}\\right) = (\\rho u^{\\ast} S)_e - \\frac{S_e \\Delta t}{d_{pe}}(P'_E - P'_P)\n$$\n类似地，对于其他面：\n$$\n\\dot{m}_w^{n+1} = \\rho S_w \\left(u_w^{*} - \\frac{\\Delta t}{\\rho} \\frac{P'_P - P'_W}{d_{pw}}\\right) = (\\rho u^{\\ast} S)_w - \\frac{S_w \\Delta t}{d_{pw}}(P'_P - P'_W)\n$$\n$$\n\\dot{m}_n^{n+1} = \\rho S_n \\left(v_n^{*} - \\frac{\\Delta t}{\\rho} \\frac{P'_N - P'_P}{d_{pn}}\\right) = (\\rho v^{\\ast} S)_n - \\frac{S_n \\Delta t}{d_{pn}}(P'_N - P'_P)\n$$\n$$\n\\dot{m}_s^{n+1} = \\rho S_s \\left(v_s^{*} - \\frac{\\Delta t}{\\rho} \\frac{P'_P - P'_S}{d_{ps}}\\right) = (\\rho v^{\\ast} S)_s - \\frac{S_s \\Delta t}{d_{ps}}(P'_P - P'_S)\n$$\n离散连续性方程为$\\dot{m}_e^{n+1} - \\dot{m}_w^{n+1} + \\dot{m}_n^{n+1} - \\dot{m}_s^{n+1} = 0$。代入质量流率的表达式，并将与压力修正$P'$相关的项分组到一边，我们得到：\n$$\n\\frac{S_e \\Delta t}{d_{pe}}(P'_P - P'_E) + \\frac{S_w \\Delta t}{d_{pw}}(P'_P - P'_W) + \\frac{S_n \\Delta t}{d_{pn}}(P'_P - P'_N) + \\frac{S_s \\Delta t}{d_{ps}}(P'_P - P'_S) = (\\dot{m}^{\\ast}_e - \\dot{m}^{\\ast}_w + \\dot{m}^{\\ast}_n - \\dot{m}^{\\ast}_s)\n$$\n右侧是源项，代表了来自中间速度场的净质量不平衡。我们重新整理左侧，以分离出含$P'_P$的项：\n$$\n\\left( \\frac{S_e \\Delta t}{d_{pe}} + \\frac{S_w \\Delta t}{d_{pw}} + \\frac{S_n \\Delta t}{d_{pn}} + \\frac{S_s \\Delta t}{d_{ps}} \\right) P'_P - \\frac{S_e \\Delta t}{d_{pe}} P'_E - \\frac{S_w \\Delta t}{d_{pw}} P'_W - \\frac{S_n \\Delta t}{d_{pn}} P'_N - \\frac{S_s \\Delta t}{d_{ps}} P'_S = \\text{源项}\n$$\n此方程为标准线性系统形式$A_P P'_P = \\sum_{nb} A_{nb} P'_{nb} + b$，可写为$A_P P'_P - \\sum_{nb \\in \\{E,W,N,S\\}} A_{nb} P'_{nb} = b$。对角系数$A_P$是$P'_P$的系数。通过观察，我们确定它为：\n$$\nA_P = \\frac{S_e \\Delta t}{d_{pe}} + \\frac{S_w \\Delta t}{d_{pw}} + \\frac{S_n \\Delta t}{d_{pn}} + \\frac{S_s \\Delta t}{d_{ps}}\n$$\n注意，在此公式中，$A_{nb}$（例如，$A_E = \\frac{S_e \\Delta t}{d_{pe}}$）是相邻节点的系数，而对角系数是这些相邻系数之和：$A_P = A_E + A_W + A_N + A_S$。\n\n现在，我们代入问题陈述中给出的均匀笛卡尔网格的几何参数：\n- 面面积：$S_e = S_w = \\Delta y$ 和 $S_n = S_s = \\Delta x$。\n- 中心间距：$d_{pe} = d_{pw} = \\Delta x$ 和 $d_{pn} = d_{ps} = \\Delta y$。\n\n将这些代入$A_P$的表达式中：\n$$\nA_P = \\frac{\\Delta y \\cdot \\Delta t}{\\Delta x} + \\frac{\\Delta y \\cdot \\Delta t}{\\Delta x} + \\frac{\\Delta x \\cdot \\Delta t}{\\Delta y} + \\frac{\\Delta x \\cdot \\Delta t}{\\Delta y}\n$$\n$$\nA_P = 2 \\frac{\\Delta y \\Delta t}{\\Delta x} + 2 \\frac{\\Delta x \\Delta t}{\\Delta y}\n$$\n这可以因式分解为：\n$$\nA_P = 2 \\Delta t \\left( \\frac{\\Delta y}{\\Delta x} + \\frac{\\Delta x}{\\Delta y} \\right)\n$$\n问题要求的是无量纲量$A_P / \\Delta t$。将我们的$A_P$表达式除以$\\Delta t$：\n$$\n\\frac{A_P}{\\Delta t} = \\frac{2 \\Delta t}{\\Delta t} \\left( \\frac{\\Delta y}{\\Delta x} + \\frac{\\Delta x}{\\Delta y} \\right)\n$$\n$$\n\\frac{A_P}{\\Delta t} = 2 \\left( \\frac{\\Delta y}{\\Delta x} + \\frac{\\Delta x}{\\Delta y} \\right)\n$$\n这就是所求无量纲量的最终解析表达式。",
            "answer": "$$\n\\boxed{2 \\left( \\frac{\\Delta y}{\\Delta x} + \\frac{\\Delta x}{\\Delta y} \\right)}\n$$"
        },
        {
            "introduction": "在处理了流体动力学之后，我们必须精确地模拟热量传递过程。本练习侧重于温度标量输运方程的守恒离散化。你将学习如何在有限体积法中构建对流和扩散通量，并体会离散无散速度场如何简化对流项，从而揭示该格式的重要数值特性 。",
            "id": "3980237",
            "problem": "考虑一个二维不可压缩热流，其由矩形域 $L_x \\times L_y$ 上的标量温度场 $T(\\mathbf{x},t)$ 控制。该流体具有恒定的密度 $\\rho$、恒定的比热容 $c_p$ 和恒定的热导率 $k$。设速度场 $\\mathbf{u}(\\mathbf{x},t)$ 通过一个压力投影步骤计算得出，该步骤在控制体面上强制执行离散的无散度约束。温度的演化由关于 $T$ 的通量形式的热能守恒方程描述：\n$$\n\\frac{\\partial T}{\\partial t} + \\nabla \\cdot \\left( \\mathbf{u}\\, T \\right) \\;=\\; \\nabla \\cdot \\left( \\alpha \\, \\nabla T \\right) \\;+\\; q,\n$$\n其中 $\\alpha = \\frac{k}{\\rho c_p}$ 是热扩散率，$q(\\mathbf{x},t)$ 是一个给定的体积源项除以 $\\rho c_p$。使用有限体积法 (FVM)，在间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀笛卡尔网格上，为温度 $T$ 构建一个守恒的通量形式半离散格式。其中，$T$ 存储在单元中心，而 $\\mathbf{u}$ 的面法向分量由投影法提供并存储在面上。考虑一个内部控制体 $\\mathcal{V}_P$，其面积为 $V_P = \\Delta x \\, \\Delta y$，其东、西相邻单元中心分别表示为 $E$ 和 $W$，南、北相邻单元中心分别表示为 $N$ 和 $S$，以及在面 $e, w, n, s$ 上的外向法向量。将外向面法向速度（法向分量）表示为 $U_e = \\mathbf{u}_e \\cdot \\mathbf{n}_e$、$U_w = \\mathbf{u}_w \\cdot \\mathbf{n}_w$、$V_n = \\mathbf{u}_n \\cdot \\mathbf{n}_n$ 和 $V_s = \\mathbf{u}_s \\cdot \\mathbf{n}_s$，这些速度由投影法在面上提供。对流项的面温度使用二阶中心差值插值：$T_e = \\frac{T_P + T_E}{2}$, $T_w = \\frac{T_W + T_P}{2}$, $T_n = \\frac{T_P + T_N}{2}$, $T_s = \\frac{T_S + T_P}{2}$。扩散项的面法向梯度使用二阶中心差分。推导在 $\\mathcal{V}_P$ 处强制热量守恒的离散通量平衡方程。将最终的半离散平衡方程表示为关于 $T_P, T_E, T_W, T_N, T_S, U_e, U_w, V_n, V_s, \\alpha, \\Delta x, \\Delta y$ 和 $q_P$ 的 $\\frac{d T_P}{dt}$ 的单一闭式解析表达式，其中 $q_P$ 是 $\\mathcal{V}_P$ 处的单元平均源项。无需进行数值计算，也无需四舍五入。最终答案必须是单一的解析表达式。",
            "solution": "问题陈述的解析和验证如下。\n\n### 步骤 1：提取已知条件\n- **控制方程**：通量形式的热能守恒方程由下式给出：\n$$\n\\frac{\\partial T}{\\partial t} + \\nabla \\cdot \\left( \\mathbf{u}\\, T \\right) \\;=\\; \\nabla \\cdot \\left( \\alpha \\, \\nabla T \\right) \\;+\\; q\n$$\n- **流动与流体性质**：流动是二维且不可压缩的。密度 $\\rho$、比热容 $c_p$ 和热导率 $k$ 是常数。热扩散率为 $\\alpha = \\frac{k}{\\rho c_p}$。\n- **源项**：$q(\\mathbf{x},t)$ 是一个体积源项除以 $\\rho c_p$。\n- **离散化方法**：在均匀笛卡尔网格上使用有限体积法 (FVM)，控制体 $\\mathcal{V}_P$ 的面积为 $V_P = \\Delta x \\Delta y$。\n- **变量存储**：温度 $T$ 存储在单元中心（$P$, $E$, $W$, $N$, $S$）。面法向速度分量存储在面上（$e, w, n, s$）。\n- **速度场**：速度场 $\\mathbf{u}(\\mathbf{x},t)$ 强制执行离散的无散度约束。\n- **面法向速度**：外向面法向速度为 $U_e$, $U_w$, $V_n$, $V_s$。\n- **对流通量插值**：面温度的二阶中心差值插值：$T_e = \\frac{T_P + T_E}{2}$, $T_w = \\frac{T_W + T_P}{2}$, $T_n = \\frac{T_P + T_N}{2}$, $T_s = \\frac{T_S + T_P}{2}$。\n- **扩散通量近似**：面法向梯度的二阶中心差分。\n- **目标**：推导 $\\frac{d T_P}{dt}$ 的半离散表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了传热的标准对流-扩散方程及其使用 FVM 的离散化，这些都是计算热工学中的基本概念。该设定在科学上和数学上都是合理的。\n- **适定性**：问题是适定的。它提供了所有必要的信息——偏微分方程、离散化方法、插值格式和变量位置——以推导出一个唯一的半离san方程。\n- **客观性**：问题以该领域精确、客观和标准的术语陈述。\n- **完整性与一致性**：问题是自洽和一致的。提供了速度场满足离散无散度约束这一关键细节，这是投影法的一个关键特征，对推导至关重要。\n\n### 步骤 3：结论与行动\n问题被判定为**有效**。将构建详细的解答。\n\n### 求解推导\n\n推导过程首先将控制偏微分方程在一个面积为 $V_P = \\Delta x \\Delta y$ 的内部控制体 $\\mathcal{V}_P$ 上积分。\n$$\n\\int_{\\mathcal{V}_P} \\frac{\\partial T}{\\partial t} \\, dV + \\int_{\\mathcal{V}_P} \\nabla \\cdot (\\mathbf{u} T) \\, dV = \\int_{\\mathcal{V}_P} \\nabla \\cdot (\\alpha \\nabla T) \\, dV + \\int_{\\mathcal{V}_P} q \\, dV\n$$\n对通量项应用高斯散度定理，得到控制体 $\\mathcal{V}_P$ 的积分守恒定律：\n$$\n\\int_{\\mathcal{V}_P} \\frac{\\partial T}{\\partial t} \\, dV + \\oint_{\\partial \\mathcal{V}_P} (\\mathbf{u} T) \\cdot \\mathbf{n} \\, dS = \\oint_{\\partial \\mathcal{V}_P} (\\alpha \\nabla T) \\cdot \\mathbf{n} \\, dS + \\int_{\\mathcal{V}_P} q \\, dV\n$$\n其中 $\\partial \\mathcal{V}_P$ 是控制体的边界，$\\mathbf{n}$ 是向外的单位法向量。现在对该积分方程中的每一项进行离散化。\n\n**1. 瞬态项：**假设温度 $T_P$ 能够很好地代表控制体内的平均温度，则第一项近似为：\n$$\n\\int_{\\mathcal{V}_P} \\frac{\\partial T}{\\partial t} \\, dV \\approx V_P \\frac{d T_P}{dt} = \\Delta x \\Delta y \\frac{d T_P}{dt}\n$$\n\n**2. 源项：**积分源项通过单元中心值乘以单元体积来近似：\n$$\n\\int_{\\mathcal{V}_P} q \\, dV \\approx q_P V_P = q_P \\Delta x \\Delta y\n$$\n\n**3. 扩散通量项：**净向外扩散通量是穿过面 $e, w, n, s$ 的通量之和。使用二阶中心差分近似法向梯度，通过东面和西面的净流出通量为 $\\alpha \\Delta y \\frac{(T_E - T_P) - (T_P - T_W)}{\\Delta x}$。类似地，通过北面和南面的净流出通量为 $\\alpha \\Delta x \\frac{(T_N - T_P) - (T_P - T_S)}{\\Delta y}$。因此，总的向外扩散通量之和为：\n$$\n\\sum F_{diff} = \\alpha \\left( \\frac{\\Delta y}{\\Delta x} (T_E + T_W - 2T_P) + \\frac{\\Delta x}{\\Delta y} (T_N + T_S - 2T_P) \\right)\n$$\n\n**4. 对流通量项：**净向外对流通量是各面上通量 $(\\mathbf{u} T) \\cdot \\mathbf{n} A_f$ 的总和。项 $(\\mathbf{u} \\cdot \\mathbf{n})_f A_f$ 被给出为 $U_f A_f$。具体来说，是 $U_e \\Delta y, U_w \\Delta y, V_n \\Delta x, V_s \\Delta x$。总对流通量为：\n$$\n\\sum F_{adv} = (U_e \\Delta y) T_e + (U_w \\Delta y) T_w + (V_n \\Delta x) T_n + (V_s \\Delta x) T_s\n$$\n代入给定的面温度二阶中心差值插值：\n$$\n\\sum F_{adv} = U_e \\Delta y \\left(\\frac{T_P + T_E}{2}\\right) + U_w \\Delta y \\left(\\frac{T_W + T_P}{2}\\right) + V_n \\Delta x \\left(\\frac{T_P + T_N}{2}\\right) + V_s \\Delta x \\left(\\frac{T_S + T_P}{2}\\right)\n$$\n重新整理各项，收集 $T_P, T_E$ 等的系数：\n$$\n\\sum F_{adv} = \\frac{T_P}{2} (U_e \\Delta y + U_w \\Delta y + V_n \\Delta x + V_s \\Delta x) + \\frac{1}{2} (U_e \\Delta y T_E + U_w \\Delta y T_W + V_n \\Delta x T_N + V_s \\Delta x T_S)\n$$\n问题陈述指出，速度场是通过强制执行离散无散度约束的投影法计算的。对于控制体 $\\mathcal{V}_P$ 内的不可压缩流，这等同于质量守恒：\n$$\n\\sum_f (\\rho \\mathbf{u} \\cdot \\mathbf{n})_f A_f = 0\n$$\n由于 $\\rho$ 是常数，这意味着流出控制体的净体积流量为零：\n$$\nU_e \\Delta y + U_w \\Delta y + V_n \\Delta x + V_s \\Delta x = 0\n$$\n应用此约束，对流通量表达式中乘以 $T_P$ 的项消失了。这是在满足离散连续性时，对流项中心差分格式的一个已知属性。该格式有效地将对流输运与单元自身的温度 $T_P$ 解耦，这可能导致数值不稳定性。净对流通量的表达式简化为：\n$$\n\\sum F_{adv} = \\frac{1}{2} (U_e \\Delta y T_E + U_w \\Delta y T_W + V_n \\Delta x T_N + V_s \\Delta x T_S)\n$$\n\n**5. 组合半离散方程：**\n将所有离散化项代回积分平衡方程：\n$$\n\\Delta x \\Delta y \\frac{d T_P}{dt} + \\sum F_{adv} = \\sum F_{diff} + q_P \\Delta x \\Delta y\n$$\n求解 $\\frac{d T_P}{dt}$：\n$$\n\\frac{d T_P}{dt} = \\frac{1}{\\Delta x \\Delta y} \\left( \\sum F_{diff} - \\sum F_{adv} \\right) + q_P\n$$\n$$\n\\frac{d T_P}{dt} = \\frac{\\alpha}{\\Delta x \\Delta y} \\left( \\frac{\\Delta y}{\\Delta x} (T_E + T_W - 2T_P) + \\frac{\\Delta x}{\\Delta y} (T_N + T_S - 2T_P) \\right) - \\frac{1}{2 \\Delta x \\Delta y} (U_e \\Delta y T_E + U_w \\Delta y T_W + V_n \\Delta x T_N + V_s \\Delta x T_S) + q_P\n$$\n按温度节点简化和分组：\n$$\n\\frac{d T_P}{dt} = \\alpha \\left( \\frac{T_E + T_W - 2T_P}{(\\Delta x)^2} + \\frac{T_N + T_S - 2T_P}{(\\Delta y)^2} \\right) - \\frac{1}{2} \\left( \\frac{U_e T_E + U_w T_W}{\\Delta x} + \\frac{V_n T_N + V_s T_S}{\\Delta y} \\right) + q_P\n$$\n这个表达式可以展开和重新排列，以提供 $\\frac{d T_P}{dt}$ 的最终闭式结果：\n$$\n\\frac{d T_P}{dt} = q_P - 2 \\alpha T_P \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right) + T_E \\left(\\frac{\\alpha}{(\\Delta x)^2} - \\frac{U_e}{2\\Delta x}\\right) + T_W \\left(\\frac{\\alpha}{(\\Delta x)^2} - \\frac{U_w}{2\\Delta x}\\right) + T_N \\left(\\frac{\\alpha}{(\\Delta y)^2} - \\frac{V_n}{2\\Delta y}\\right) + T_S \\left(\\frac{\\alpha}{(\\Delta y)^2} - \\frac{V_s}{2\\Delta y}\\right)\n$$\n这就是控制体 $\\mathcal{V}_P$ 中心温度变化率的最终半离散方程。",
            "answer": "$$\n\\boxed{q_P - 2 \\alpha T_P \\left( \\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2} \\right) + T_E \\left(\\frac{\\alpha}{(\\Delta x)^2} - \\frac{U_e}{2\\Delta x}\\right) + T_W \\left(\\frac{\\alpha}{(\\Delta x)^2} - \\frac{U_w}{2\\Delta x}\\right) + T_N \\left(\\frac{\\alpha}{(\\Delta y)^2} - \\frac{V_n}{2\\Delta y}\\right) + T_S \\left(\\frac{\\alpha}{(\\Delta y)^2} - \\frac{V_s}{2\\Delta y}\\right)}\n$$"
        },
        {
            "introduction": "投影方法的理论目标是强制实现一个无散度的速度场。本练习为投影步骤的有效性提供了一个直接的、定量的检验。通过计算一个给定的中间速度场的散度，并与理想投影后的结果进行比较，你将以数值方式验证该方法的核心目的，并巩固对实践中如何实现不可压缩性的理解 。",
            "id": "3980214",
            "problem": "考虑一个二维不可压缩、常密度流，其热浮力由 Boussinesq 近似建模，通过一种显式方法进行时间推进，该方法会产生一个由于时间积分而带有微小散度残差的中间速度场。投影步用于强制不可压缩性。计算域为 $\\Omega = [0,1]\\times[0,1]$，具有不可渗透的壁面，并使用均匀的 Marker-and-Cell (MAC) 网格（Marker-and-Cell (MAC) 将速度分量置于单元面心，压力置于单元中心）进行离散化，其中内部单元数量为 $N_{x}=2$ 和 $N_{y}=2$，因此 $\\Delta x = \\Delta y = 0.5$。时间步长为 $\\Delta t = 0.1$。\n\n面心上的中间速度分量 $\\mathbf{u}^{*} = (u^{*}, v^{*})$ 在 MAC 网格位置上的值如下：\n- 垂直面（对于 $u^{*}_{i+1/2,j}$）：$u^{*}_{1/2,1} = 0$, $u^{*}_{1/2,2} = 0$, $u^{*}_{3/2,1} = 0.06$, $u^{*}_{3/2,2} = -0.02$, $u^{*}_{5/2,1} = 0$, $u^{*}_{5/2,2} = 0$。\n- 水平面（对于 $v^{*}_{i,j+1/2}$）：$v^{*}_{1,1/2} = 0$, $v^{*}_{2,1/2} = 0$, $v^{*}_{1,3/2} = -0.04$, $v^{*}_{2,3/2} = 0.05$, $v^{*}_{1,5/2} = 0$, $v^{*}_{2,5/2} = 0$。\n\n不可渗透壁面意味着在所有域边界上 $\\mathbf{u}^{*}\\cdot \\mathbf{n} = 0$，这与给定的边界面上的值是一致的。\n\n从不可压缩性约束和投影方法出发，您必须：\n1. 使用与 MAC 网格和无穿透边界一致的散度有限体积形式，计算四个单元中每个单元的 $\\mathbf{u}^{*}$ 的离散单元中心散度。\n2. 在投影前，使用该均匀网格上的中点法则计算 $\\Omega$ 上的散度的 $L^{2}$ 范数，即通过 $\\left(\\sum_{i=1}^{2}\\sum_{j=1}^{2} (\\nabla \\cdot \\mathbf{u}^{*})_{i,j}^{2}\\, \\Delta x \\Delta y\\right)^{1/2}$ 来近似 $\\|\\nabla \\cdot \\mathbf{u}^{*}\\|_{L^{2}(\\Omega)}$。\n3. 使用精确的投影步，通过求解带有与不可渗透壁面一致的边界条件的压力泊松方程来强制离散不可压缩性，确定投影后散度的 $L^{2}$ 范数。\n4. 通过定义为 $E = 1 - \\|\\nabla \\cdot \\mathbf{u}^{n+1}\\|_{L^{2}(\\Omega)} / \\|\\nabla \\cdot \\mathbf{u}^{*}\\|_{L^{2}(\\Omega)}$ 的标量度量 $E$ 来量化不可压缩性的强制程度，其中 $\\mathbf{u}^{n+1}$ 是投影后的速度。\n\n仅报告 $E$ 的最终值作为您的答案。如果在您的计算中需要任何数值近似，请保持所有中间量为精确值，并在推导中明确说明任何舍入要求。最终度量 $E$ 是无量纲的；不要在最终答案框中包含任何单位。如果 $E$ 是一个精确值，则无需对其进行舍入。",
            "solution": "控制不可压缩流动的连续性方程为 $\\nabla \\cdot \\mathbf{u} = 0$。在投影法中，我们首先从动量方程（在 Boussinesq 近似下可能包含热浮力）计算出一个中间速度 $\\mathbf{u}^{*}$，此时不强制不可compressibility，然后将 $\\mathbf{u}^{*}$ 投影到一个无散子空间上。投影步使用离散形式的 Helmholtz 分解：我们寻求一个标量势 $\\phi$，使得\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\Delta t \\nabla \\phi,\n$$\n且满足 $\\nabla \\cdot \\mathbf{u}^{n+1} = 0$。对其求散度可得\n$$\n\\nabla \\cdot \\mathbf{u}^{n+1} = \\nabla \\cdot \\mathbf{u}^{*} - \\Delta t \\nabla^{2} \\phi = 0 \\quad \\Rightarrow \\quad \\nabla^{2}\\phi = \\frac{1}{\\Delta t}\\,\\nabla \\cdot \\mathbf{u}^{*}.\n$$\n对于不可渗透壁面（$\\mathbf{u}\\cdot \\mathbf{n} = 0$），$\\phi$ 的边界条件是与强制 $\\mathbf{u}^{n+1}$ 的壁面法向分量相一致的齐次 Neumann 边界条件。\n\n现在我们在 Marker-and-Cell (MAC) 网格上计算单元中心的离散散度。对于一个单元 $(i,j)$，有限体积离散散度为\n$$\n(\\nabla \\cdot \\mathbf{u}^{*})_{i,j} = \\frac{u^{*}_{i+1/2,j} - u^{*}_{i-1/2,j}}{\\Delta x} + \\frac{v^{*}_{i,j+1/2} - v^{*}_{i,j-1/2}}{\\Delta y}.\n$$\n给定 $\\Delta x = \\Delta y = 0.5$，我们计算每个单元：\n\n- 单元 $(1,1)$:\n$$\n\\frac{u^{*}_{3/2,1} - u^{*}_{1/2,1}}{\\Delta x} = \\frac{0.06 - 0}{0.5} = 0.12, \\quad \\frac{v^{*}_{1,3/2} - v^{*}_{1,1/2}}{\\Delta y} = \\frac{-0.04 - 0}{0.5} = -0.08,\n$$\n所以\n$$\n(\\nabla \\cdot \\mathbf{u}^{*})_{1,1} = 0.12 - 0.08 = 0.04.\n$$\n\n- 单元 $(2,1)$:\n$$\n\\frac{u^{*}_{5/2,1} - u^{*}_{3/2,1}}{\\Delta x} = \\frac{0 - 0.06}{0.5} = -0.12, \\quad \\frac{v^{*}_{2,3/2} - v^{*}_{2,1/2}}{\\Delta y} = \\frac{0.05 - 0}{0.5} = 0.10,\n$$\n所以\n$$\n(\\nabla \\cdot \\mathbf{u}^{*})_{2,1} = -0.12 + 0.10 = -0.02.\n$$\n\n- 单元 $(1,2)$:\n$$\n\\frac{u^{*}_{3/2,2} - u^{*}_{1/2,2}}{\\Delta x} = \\frac{-0.02 - 0}{0.5} = -0.04, \\quad \\frac{v^{*}_{1,5/2} - v^{*}_{1,3/2}}{\\Delta y} = \\frac{0 - (-0.04)}{0.5} = 0.08,\n$$\n所以\n$$\n(\\nabla \\cdot \\mathbf{u}^{*})_{1,2} = -0.04 + 0.08 = 0.04.\n$$\n\n- 单元 $(2,2)$:\n$$\n\\frac{u^{*}_{5/2,2} - u^{*}_{3/2,2}}{\\Delta x} = \\frac{0 - (-0.02)}{0.5} = 0.04, \\quad \\frac{v^{*}_{2,5/2} - v^{*}_{2,3/2}}{\\Delta y} = \\frac{0 - 0.05}{0.5} = -0.10,\n$$\n所以\n$$\n(\\nabla \\cdot \\mathbf{u}^{*})_{2,2} = 0.04 - 0.10 = -0.06.\n$$\n\n因此，四个单元中心的散度值分别为 $0.04$、$-0.02$、$0.04$ 和 $-0.06$。\n\n我们使用中点法则来近似 $\\Omega$ 上的 $L^{2}$ 范数：\n$$\n\\|\\nabla \\cdot \\mathbf{u}^{*}\\|_{L^{2}(\\Omega)} \\approx \\left(\\sum_{i=1}^{2}\\sum_{j=1}^{2} \\left[(\\nabla \\cdot \\mathbf{u}^{*})_{i,j}\\right]^{2} \\,\\Delta x \\Delta y\\right)^{1/2}.\n$$\n计算平方和：\n$$\n0.04^{2} + (-0.02)^{2} + 0.04^{2} + (-0.06)^{2} = 0.0016 + 0.0004 + 0.0016 + 0.0036 = 0.0072.\n$$\n乘以单元面积 $\\Delta x \\Delta y = 0.25$：\n$$\n0.0072 \\times 0.25 = 0.0018.\n$$\n因此，\n$$\n\\|\\nabla \\cdot \\mathbf{u}^{*}\\|_{L^{2}(\\Omega)} \\approx \\sqrt{0.0018}.\n$$\n\n接下来，考虑精确的投影步。求解\n$$\n\\nabla^{2} \\phi = \\frac{1}{\\Delta t}\\,\\nabla \\cdot \\mathbf{u}^{*}\n$$\n其中边界条件与不可渗透壁面一致，并设置\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^{*} - \\Delta t \\nabla \\phi,\n$$\n通过构造，可以确保\n$$\n\\nabla \\cdot \\mathbf{u}^{n+1} = \\nabla \\cdot \\mathbf{u}^{*} - \\Delta t \\nabla^{2} \\phi = \\nabla \\cdot \\mathbf{u}^{*} - \\Delta t \\left(\\frac{1}{\\Delta t}\\,\\nabla \\cdot \\mathbf{u}^{*}\\right) = 0\n$$\n在离散的单元中心处成立。因此，\n$$\n\\|\\nabla \\cdot \\mathbf{u}^{n+1}\\|_{L^{2}(\\Omega)} = 0.\n$$\n\n定义强制度量\n$$\nE = 1 - \\frac{\\|\\nabla \\cdot \\mathbf{u}^{n+1}\\|_{L^{2}(\\Omega)}}{\\|\\nabla \\cdot \\mathbf{u}^{*}\\|_{L^{2}(\\Omega)}} = 1 - \\frac{0}{\\sqrt{0.0018}} = 1.\n$$\n这个 $E$ 是无量纲的，并且由于它是精确值，因此不需要舍入。在 `solution` 文本中，$\\|\\nabla \\cdot \\mathbf{u}^{*}\\|_{L^{2}(\\Omega)}$ 被计算为 $10^{-2}\\sqrt{18}$，这是 $\\sqrt{0.0018}$ 的另一种形式，结果是一样的。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}