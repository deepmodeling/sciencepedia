{
    "hands_on_practices": [
        {
            "introduction": "Mastering phase change modeling begins with a firm grasp of the underlying thermodynamics. This first practice  challenges you to apply the first law to a system undergoing melting, reinforcing how specific enthalpy elegantly combines sensible heat and latent heat into a single state variable. Successfully completing this calculation is a crucial first step toward building and understanding more complex numerical enthalpy methods.",
            "id": "3973642",
            "problem": "A pure, single-component material is heated in a well-stirred, constant-pressure environment such that spatial temperature gradients are negligible and thermomechanical work is negligible compared to stored thermal energy. The initial temperature is $T_{1} = 300\\,\\mathrm{K}$, the melting temperature is $T_{m} = 500\\,\\mathrm{K}$, and the final temperature is $T_{2} = 700\\,\\mathrm{K}$. The mass is $m = 5\\,\\mathrm{kg}$. The specific heat capacity in the solid phase for $TT_{m}$ is $c_{p,s}(T) = 500 + 0.2\\,T\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, and in the liquid phase for $TT_{m}$ is $c_{p,\\ell}(T) = 900 + 0.1\\,T\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$. The latent heat of fusion is $L = 2.50 \\times 10^{5}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$. Assume the material is pure, with isothermal melting at $T_{m}$ and negligible undercooling or superheating, and that the process is quasi-static so that specific enthalpy is the relevant storage variable.\n\nUsing the first law of thermodynamics for a closed system and the definition of specific enthalpy per unit mass, explain how the latent heat term modifies the total energy stored as the temperature passes through $T_{m}$. Then, starting from these principles, derive an expression for the total heat input $Q(T_{1}\\rightarrow T_{2})$ required to raise the material from $T_{1}$ to $T_{2}$ across the phase change, and compute its numerical value for the given data. Express the final energy in $\\mathrm{kJ}$ and round your answer to four significant figures.",
            "solution": "The problem is assessed as valid because it is scientifically grounded in classical thermodynamics, is well-posed with a complete and consistent set of givens, and is expressed in objective, unambiguous language.\n\nThe task is to first explain the thermodynamic role of latent heat in the context of stored energy and then to derive and calculate the total heat input required to heat a material across its melting point.\n\nThe analysis is based on the first law of thermodynamics for a closed system undergoing a quasi-static process at constant pressure. The first law states that the change in internal energy $dU$ is equal to the heat added to the system $\\delta Q$ minus the work done by the system $\\delta W$:\n$$dU = \\delta Q - \\delta W$$\nFor a quasi-static process at constant pressure $P$, the work done is primarily thermomechanical (volume expansion), given by $\\delta W = P\\,dV$. Substituting this into the first law gives:\n$$\\delta Q = dU + P\\,dV$$\nSince the pressure $P$ is constant, this can be written as:\n$$\\delta Q = d(U + PV)$$\nThe quantity $H = U + PV$ is defined as enthalpy. Thus, for a quasi-static, constant-pressure process, the heat added to the system is equal to the change in its enthalpy:\n$$\\delta Q = dH$$\nFor a system of mass $m$, we can define the specific enthalpy $h = H/m$, so $dH = m\\,dh$. The heat input required to change the state of the material is therefore given by the integral of $m\\,dh$:\n$$Q = m \\int dh = m\\,\\Delta h$$\nwhere $\\Delta h$ is the total change in specific enthalpy.\n\nThe relationship between enthalpy and temperature is given by the specific heat capacity at constant pressure, $c_p$, defined as:\n$$c_p(T) = \\left(\\frac{\\partial h}{\\partial T}\\right)_P$$\nThis definition implies that for an infinitesimal temperature change $dT$ within a single phase (solid or liquid), the change in specific enthalpy is $dh = c_p(T)\\,dT$. The energy added is called sensible heat, as it results in a measurable change in temperature, which corresponds to an increase in the average kinetic energy of the constituent molecules.\n\nHowever, during a phase transition, such as melting at a constant temperature $T_m$, the substance absorbs a significant amount of heat without any change in temperature ($dT = 0$). From the definition $c_p = (\\partial h / \\partial T)_P$, this would mathematically imply an infinite specific heat at $T = T_m$. A more physically meaningful description is that the specific enthalpy $h$ undergoes a discontinuous jump at $T_m$. This jump is the specific latent heat of fusion, $L$.\n$$L = h_{\\ell}(T_m) - h_{s}(T_m)$$\nwhere $h_{s}(T_m)$ and $h_{\\ell}(T_m)$ are the specific enthalpies of the material in the solid and liquid phases, respectively, at the melting temperature $T_m$.\n\nThe energy absorbed as latent heat does not increase the kinetic energy of the molecules (as temperature remains constant) but rather increases their potential energy. This energy is used to overcome the intermolecular forces that hold the molecules in the fixed, ordered structure of the solid crystalline lattice, allowing them to move more freely in the disordered liquid phase. Therefore, the latent heat term modifies the total stored energy by adding a quantum of energy that is stored in the phase configuration of the material (potential energy) rather than in its temperature (kinetic energy).\n\nTo calculate the total heat input $Q(T_1 \\rightarrow T_2)$ required to raise the material's temperature from $T_1$ to $T_2$, passing through the melting point $T_m$, we must sum the heat absorbed in three distinct stages:\n1.  Sensible heat to raise the temperature of the solid from $T_1$ to $T_m$.\n2.  Latent heat to melt the solid completely at $T_m$.\n3.  Sensible heat to raise the temperature of the liquid from $T_m$ to $T_2$.\n\nThe total heat input $Q$ is the product of the mass $m$ and the total change in specific enthalpy $\\Delta h = h(T_2)-h(T_1)$. This change can be expressed as the sum of the enthalpy changes in each stage:\n$$\\Delta h = \\Delta h_{s} + L + \\Delta h_{\\ell}$$\nThe terms are:\n- $\\Delta h_{s} = \\int_{T_1}^{T_m} c_{p,s}(T)\\,dT$ (heating the solid)\n- $L$ (melting the solid)\n- $\\Delta h_{\\ell} = \\int_{T_m}^{T_2} c_{p,\\ell}(T)\\,dT$ (heating the liquid)\n\nThe total heat input is therefore:\n$$Q = m \\left( \\int_{T_1}^{T_m} c_{p,s}(T)\\,dT + L + \\int_{T_m}^{T_2} c_{p,\\ell}(T)\\,dT \\right)$$\nUsing the given data:\n- $m = 5\\,\\mathrm{kg}$\n- $T_1 = 300\\,\\mathrm{K}$\n- $T_m = 500\\,\\mathrm{K}$\n- $T_2 = 700\\,\\mathrm{K}$\n- $c_{p,s}(T) = 500 + 0.2\\,T\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- $c_{p,\\ell}(T) = 900 + 0.1\\,T\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- $L = 2.50 \\times 10^{5}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$\n\nFirst, we calculate the enthalpy change for heating the solid:\n$$\\Delta h_s = \\int_{300}^{500} (500 + 0.2\\,T)\\,dT = \\left[ 500\\,T + 0.1\\,T^2 \\right]_{300}^{500}$$\n$$\\Delta h_s = (500 \\times 500 + 0.1 \\times 500^2) - (500 \\times 300 + 0.1 \\times 300^2)$$\n$$\\Delta h_s = (250000 + 0.1 \\times 250000) - (150000 + 0.1 \\times 90000)$$\n$$\\Delta h_s = (250000 + 25000) - (150000 + 9000)$$\n$$\\Delta h_s = 275000 - 159000 = 116000\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$$\n\nNext, we calculate the enthalpy change for heating the liquid:\n$$\\Delta h_{\\ell} = \\int_{500}^{700} (900 + 0.1\\,T)\\,dT = \\left[ 900\\,T + 0.05\\,T^2 \\right]_{500}^{700}$$\n$$\\Delta h_{\\ell} = (900 \\times 700 + 0.05 \\times 700^2) - (900 \\times 500 + 0.05 \\times 500^2)$$\n$$\\Delta h_{\\ell} = (630000 + 0.05 \\times 490000) - (450000 + 0.05 \\times 250000)$$\n$$\\Delta h_{\\ell} = (630000 + 24500) - (450000 + 12500)$$\n$$\\Delta h_{\\ell} = 654500 - 462500 = 192000\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$$\n\nNow, we sum the enthalpy changes for all three stages:\n$$\\Delta h_{total} = \\Delta h_s + L + \\Delta h_{\\ell} = 116000 + 250000 + 192000 = 558000\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$$\n\nFinally, we calculate the total heat input $Q$ for the mass $m = 5\\,\\mathrm{kg}$:\n$$Q = m \\times \\Delta h_{total} = 5\\,\\mathrm{kg} \\times 558000\\,\\mathrm{J}\\,\\mathrm{kg}^{-1} = 2790000\\,\\mathrm{J}$$\nTo express the final result in kilojoules ($\\mathrm{kJ}$) and round to four significant figures, we convert from joules:\n$$Q = \\frac{2790000}{1000}\\,\\mathrm{kJ} = 2790\\,\\mathrm{kJ}$$\nThe value $2790$ has four significant figures.",
            "answer": "$$\\boxed{2790}$$"
        },
        {
            "introduction": "While macroscopic balances are useful, most real-world scenarios involve spatial gradients and moving interfaces. This exercise  introduces the one-sided Stefan problem, a classic analytical model for solidification that every computational thermal engineer should master. By deriving the famous square-root-of-time law for interface motion, you will gain fundamental insight into the physics of diffusion-controlled phase fronts and obtain a vital benchmark for code validation.",
            "id": "3973638",
            "problem": "A semi-infinite pure material occupies $x0$. At time $t=0$, the entire domain is at the thermodynamic melting temperature $T_{m}$. For $t0$, the boundary at $x=0$ is suddenly and permanently held at a lower, fixed temperature $T_{0}$ with $T_{0}T_{m}$, causing solidification to begin at $x=0$ and advance into the liquid. Assume constant and temperature-independent thermal properties in the solid: thermal conductivity $k$, mass density $\\rho$, specific heat capacity $c$, and thermal diffusivity $\\alpha = k/(\\rho c)$. Neglect conduction in the liquid so that the liquid remains at $T_{m}$ everywhere it exists. Let $s(t)$ denote the position of the solid–liquid interface.\n\nStarting from the one-dimensional energy conservation in the solid region and Fourier’s law of heat conduction, formulate the well-posed free-boundary problem for $0xs(t)$ and $t0$, including:\n- the heat equation in the solid,\n- the Dirichlet boundary condition at $x=0$,\n- the matching condition at the interface $x=s(t)$,\n- and the Stefan condition embodying conservation of energy at the interface.\n\nUsing a similarity approach consistent with the absence of intrinsic length scales other than the diffusion length, derive the Neumann self-similar solution for the one-sided Stefan problem and show that the interface position admits the form $s(t)=2\\lambda\\sqrt{\\alpha t}$ with a time-independent similarity parameter $\\lambda0$. Obtain the temperature field in the solid in terms of the Gauss error function $\\operatorname{erf}(\\cdot)$ and $\\lambda$, determine the interfacial temperature gradient, and derive the transcendental equation that determines $\\lambda$ in terms of the Stefan number $\\mathrm{Ste}=c\\,(T_{m}-T_{0})/L$, where $L$ is the latent heat of fusion per unit mass. The Gauss error function is defined by $\\operatorname{erf}(y)=\\frac{2}{\\sqrt{\\pi}}\\int_{0}^{y}\\exp(-\\xi^{2})\\,\\mathrm{d}\\xi$.\n\nAnswer specification:\n- Express your final answer for the interface position in the form of a single analytic expression for $s(t)$ in terms of $\\lambda$, $\\alpha$, and $t$. Do not include any equations other than this expression in your final answer.\n- Express $s(t)$ in meters.\n- No numerical evaluation or rounding is required.",
            "solution": "The problem describes the one-sided Stefan problem for solidification in a semi-infinite domain. We first formulate the governing equations and boundary conditions based on the principles of energy conservation and heat conduction.\n\nThe temperature field in the solid phase, $T(x,t)$, for the domain $0  x  s(t)$ and time $t0$, is governed by the one-dimensional heat diffusion equation:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\nwhere $\\alpha = k/(\\rho c)$ is the thermal diffusivity of the solid.\n\nThe boundary and interface conditions are as follows:\n$1$. The temperature at the fixed boundary $x=0$ is constant for $t0$:\n$$ T(0, t) = T_0 $$\n$2$. The temperature at the solid-liquid interface $x=s(t)$ is the melting temperature $T_m$:\n$$ T(s(t), t) = T_m $$\n$3$. The energy balance at the moving interface, known as the Stefan condition, equates the heat conducted away from the interface into the solid with the latent heat released by solidification. The liquid is assumed to be at $T_m$, so there is no heat conduction from the liquid phase to the interface.\n$$ k \\frac{\\partial T}{\\partial x}\\bigg|_{x=s(t)} = \\rho L \\frac{ds}{dt} $$\nwhere $k$ is the thermal conductivity of the solid, $\\rho$ is the density, $L$ is the latent heat of fusion per unit mass, and $ds/dt$ is the velocity of the interface.\n\n$4$. The initial condition is that the entire domain is liquid at the melting temperature, which implies the solid phase starts with zero thickness at $t=0$:\n$$ s(0) = 0 $$\n\nThis system constitutes a well-posed free-boundary problem. The problem lacks an intrinsic length or time scale, which suggests a self-similar solution. We postulate that the interface position grows with the square root of time, consistent with diffusive processes. Following the problem's guidance, we assume a solution of the form:\n$$ s(t) = 2\\lambda\\sqrt{\\alpha t} $$\nwhere $\\lambda$ is a dimensionless, time-independent similarity parameter to be determined. The factor of $2\\sqrt{\\alpha}$ is chosen for mathematical convenience. The validity of this assumption is confirmed if it leads to a self-consistent solution of the full problem.\n\nWe introduce the dimensionless similarity variable $\\eta$:\n$$ \\eta = \\frac{x}{2\\sqrt{\\alpha t}} $$\nWith this transformation, the temperature field $T(x,t)$ is assumed to be a function of $\\eta$ alone, i.e., $T(x,t) = T(\\eta)$. We transform the governing partial differential equation into an ordinary differential equation (ODE) for $T(\\eta)$. The partial derivatives are:\n$$ \\frac{\\partial T}{\\partial t} = \\frac{dT}{d\\eta} \\frac{\\partial \\eta}{\\partial t} = \\frac{dT}{d\\eta} \\left( -\\frac{x}{4\\sqrt{\\alpha} t^{3/2}} \\right) = -\\frac{\\eta}{2t} \\frac{dT}{d\\eta} $$\n$$ \\frac{\\partial T}{\\partial x} = \\frac{dT}{d\\eta} \\frac{\\partial \\eta}{\\partial x} = \\frac{1}{2\\sqrt{\\alpha t}} \\frac{dT}{d\\eta} $$\n$$ \\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2\\sqrt{\\alpha t}} \\frac{dT}{d\\eta} \\right) = \\frac{1}{2\\sqrt{\\alpha t}} \\frac{d^2 T}{d\\eta^2} \\frac{\\partial \\eta}{\\partial x} = \\frac{1}{4\\alpha t} \\frac{d^2 T}{d\\eta^2} $$\nSubstituting these into the heat equation $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$ gives:\n$$ -\\frac{\\eta}{2t} \\frac{dT}{d\\eta} = \\alpha \\left( \\frac{1}{4\\alpha t} \\frac{d^2 T}{d\\eta^2} \\right) $$\n$$ \\frac{d^2 T}{d\\eta^2} + 2\\eta \\frac{dT}{d\\eta} = 0 $$\nThis is a second-order linear ODE for $T(\\eta)$. The general solution can be found by letting $U = dT/d\\eta$, which gives the first-order separable equation $dU/d\\eta = -2\\eta U$. Its solution is $U(\\eta) = C_1 \\exp(-\\eta^2)$. Integrating with respect to $\\eta$ gives:\n$$ T(\\eta) = C_1 \\int_0^\\eta \\exp(-\\xi^2) d\\xi + C_2 $$\nUsing the definition of the Gauss error function, $\\operatorname{erf}(y) = \\frac{2}{\\sqrt{\\pi}} \\int_0^y \\exp(-\\xi^2) d\\xi$, the general solution for temperature is:\n$$ T(\\eta) = A \\operatorname{erf}(\\eta) + B $$\nwhere $A$ and $B$ are constants. The solid region $0  x  s(t)$ corresponds to the similarity domain $0  \\eta  \\lambda$. We apply the boundary conditions to find $A$ and $B$.\n\nAt $x=0$, we have $\\eta=0$. The boundary condition $T(0,t)=T_0$ becomes $T(\\eta=0) = T_0$.\n$$ T(0) = A \\operatorname{erf}(0) + B = A \\cdot 0 + B = B \\implies B = T_0 $$\nAt the interface $x=s(t)$, we have $\\eta = s(t)/(2\\sqrt{\\alpha t}) = (2\\lambda\\sqrt{\\alpha t})/(2\\sqrt{\\alpha t}) = \\lambda$. The condition $T(s(t), t)=T_m$ becomes $T(\\eta=\\lambda)=T_m$.\n$$ T(\\lambda) = A \\operatorname{erf}(\\lambda) + T_0 = T_m \\implies A = \\frac{T_m - T_0}{\\operatorname{erf}(\\lambda)} $$\nSubstituting $A$ and $B$ back into the solution for $T(\\eta)$ and expressing it in terms of $x$ and $t$ yields the temperature field in the solid:\n$$ T(x,t) = T_0 + (T_m - T_0) \\frac{\\operatorname{erf}\\left(\\frac{x}{2\\sqrt{\\alpha t}}\\right)}{\\operatorname{erf}(\\lambda)} $$\nNow we use the Stefan condition to determine the value of $\\lambda$. First, we compute the required derivatives. The temperature gradient at the interface is:\n$$ \\frac{\\partial T}{\\partial x}\\bigg|_{x=s(t)} = \\frac{dT}{d\\eta}\\bigg|_{\\eta=\\lambda} \\frac{\\partial \\eta}{\\partial x} = \\left( A \\frac{2}{\\sqrt{\\pi}} \\exp(-\\lambda^2) \\right) \\left( \\frac{1}{2\\sqrt{\\alpha t}} \\right) $$\nSubstituting the expression for $A$:\n$$ \\frac{\\partial T}{\\partial x}\\bigg|_{x=s(t)} = \\frac{T_m - T_0}{\\operatorname{erf}(\\lambda)} \\frac{2}{\\sqrt{\\pi}} \\exp(-\\lambda^2) \\frac{1}{2\\sqrt{\\alpha t}} = \\frac{T_m - T_0}{\\sqrt{\\pi \\alpha t} \\operatorname{erf}(\\lambda)} \\exp(-\\lambda^2) $$\nThe velocity of the interface is:\n$$ \\frac{ds}{dt} = \\frac{d}{dt} (2\\lambda\\sqrt{\\alpha t}) = 2\\lambda\\sqrt{\\alpha} \\left( \\frac{1}{2}t^{-1/2} \\right) = \\frac{\\lambda\\sqrt{\\alpha}}{\\sqrt{t}} $$\nSubstitute these two expressions into the Stefan condition $k \\frac{\\partial T}{\\partial x}|_{s(t)} = \\rho L \\frac{ds}{dt}$:\n$$ k \\left( \\frac{T_m - T_0}{\\sqrt{\\pi \\alpha t} \\operatorname{erf}(\\lambda)} \\exp(-\\lambda^2) \\right) = \\rho L \\left( \\frac{\\lambda\\sqrt{\\alpha}}{\\sqrt{t}} \\right) $$\nThe term $\\sqrt{t}$ cancels. Rearranging the equation:\n$$ k (T_m - T_0) \\exp(-\\lambda^2) = \\rho L \\lambda \\sqrt{\\alpha} \\sqrt{\\pi \\alpha} \\operatorname{erf}(\\lambda) = \\rho L \\lambda \\alpha \\sqrt{\\pi} \\operatorname{erf}(\\lambda) $$\nSubstitute $\\alpha = k/(\\rho c)$:\n$$ k (T_m - T_0) \\exp(-\\lambda^2) = \\rho L \\lambda \\frac{k}{\\rho c} \\sqrt{\\pi} \\operatorname{erf}(\\lambda) $$\nThe terms $k$ and $\\rho$ cancel out:\n$$ (T_m - T_0) \\exp(-\\lambda^2) = \\frac{L}{c} \\lambda \\sqrt{\\pi} \\operatorname{erf}(\\lambda) $$\nFinally, we rearrange this result to express it in terms of the Stefan number, $\\mathrm{Ste} = c(T_m - T_0)/L$:\n$$ \\frac{c(T_m - T_0)}{L} = \\sqrt{\\pi} \\lambda \\exp(\\lambda^2) \\operatorname{erf}(\\lambda) $$\nThis is the transcendental equation for the similarity parameter $\\lambda$:\n$$ \\mathrm{Ste} = \\sqrt{\\pi} \\lambda \\exp(\\lambda^2) \\operatorname{erf}(\\lambda) $$\nFor a given Stefan number, this equation can be solved numerically to find the unique positive value of $\\lambda$. With $\\lambda$ determined, the position of the interface at any time $t0$ is given by the expression derived from the similarity assumption.",
            "answer": "$$\n\\boxed{s(t) = 2 \\lambda \\sqrt{\\alpha t}}\n$$"
        },
        {
            "introduction": "Analytical solutions like the Stefan problem are rare; most practical modeling relies on numerical methods. The enthalpy method is a powerful and popular choice, but it requires a 'look-up' or inversion step to find temperature $T$ from the calculated enthalpy $H$. This final practice  focuses on this core computational task, challenging you to design a robust algorithm for inverting the piecewise-linear $H(T)$ function, a procedure at the very heart of modern phase change simulators.",
            "id": "3973595",
            "problem": "Consider enthalpy-based modeling of phase change with an implicit time integrator in one spatial dimension. The fundamental base is the conservation of energy and the definition of enthalpy as a state variable: $ \\rho \\, \\dfrac{\\partial H}{\\partial t} = \\nabla \\cdot \\left( k \\nabla T \\right) $, where $ \\rho $ is the mass density, $ H $ is the specific enthalpy, $ T $ is the temperature, and $ k $ is the thermal conductivity. In enthalpy methods, the specific enthalpy $ H $ depends on $ T $ and implicitly accounts for latent heat. After an implicit time step, the new enthalpy $ H^{n+1} $ is obtained from a discrete diffusion solve, but temperature $ T^{n+1} $ must be recovered by inverting $ H(T) $. To ensure robustness for arbitrary monotone, piecewise-linear $ H(T) $, you must design an iterative inversion scheme that is globally convergent and suitable for use within each time step in a Finite Volume Method (FVM) or Finite Element Method (FEM) solver.\n\nAssume the piecewise-linear constitutive relation $ H(T) $ is defined by three regions with a mushy interval distributing latent heat linearly between a solidus temperature $ T_s $ and a liquidus temperature $ T_\\ell $. Let $ T_{\\mathrm{ref}} $ be a reference temperature, $ c_s $ the specific heat in the solid region, $ c_m $ an effective specific heat in the mushy region, $ c_\\ell $ the specific heat in the liquid region, and $ L $ the latent heat of fusion per unit mass. Define\n$$\nH_s \\equiv c_s \\,(T_s - T_{\\mathrm{ref}}), \\qquad\nH_\\ell \\equiv H_s + c_m \\,(T_\\ell - T_s) + L,\n$$\nand let the piecewise function $ H(T) $ be\n$$\nH(T) =\n\\begin{cases}\nc_s \\,(T - T_{\\mathrm{ref}}),  T \\le T_s, \\\\\nH_s + \\big(c_m + \\dfrac{L}{T_\\ell - T_s}\\big)\\,(T - T_s),  T_s  T \\le T_\\ell, \\\\\nH_\\ell + c_\\ell \\,(T - T_\\ell),  T  T_\\ell.\n\\end{cases}\n$$\n\nStarting from the fundamental laws and core definitions above, design a root-finding scheme to invert $ H(T) $ and recover $ T $ from a given $ H $ in the implicit integrator. Your scheme must:\n- Exploit the monotonicity of $ H(T) $ implied by $ c_s  0 $, $ c_m  0 $, $ c_\\ell  0 $, $ L  0 $, and $ T_\\ell  T_s $.\n- Be globally convergent for all inputs $ H \\in \\mathbb{R} $ and parameters satisfying the physical constraints.\n- Handle the non-differentiable kinks at $ T = T_s $ and $ T = T_\\ell $ without failure.\n- Use only algebraic and iterative operations compatible with computational thermal engineering practice.\n\nYou must implement a program that, for a specified test suite, inverts $ H(T) $ for each provided enthalpy value and returns the corresponding temperature. Express all final temperatures in Kelvin ($\\mathrm{K}$), rounded to six decimal places. Angles are not involved. The program must produce a single line of output that is a comma-separated Python-style list of floats enclosed in square brackets.\n\nUse the following test suite of parameter sets and enthalpy targets (all quantities are in SI units):\n- Material A: $ T_{\\mathrm{ref}} = 300 $, $ c_s = 600 $, $ c_m = 700 $, $ c_\\ell = 800 $, $ L = 260000 $, $ T_s = 1700 $, $ T_\\ell = 1800 $.\n  - Targets for inversion:\n    - Case A1: $ H = 500000 $ (solid region).\n    - Case A2: $ H = H_s $ (exactly at $ T_s $).\n    - Case A3: $ H = 900000 $ (mushy region).\n    - Case A4: $ H = H_\\ell $ (exactly at $ T_\\ell $).\n    - Case A5: $ H = 1300000 $ (liquid region).\n- Material B (narrow mushy interval): $ T_{\\mathrm{ref}} = 273 $, $ c_s = 2100 $, $ c_m = 3000 $, $ c_\\ell = 4180 $, $ L = 334000 $, $ T_s = 273 $, $ T_\\ell = 274 $.\n  - Targets for inversion:\n    - Case B1: $ H = -10000 $ (below $ T_{\\mathrm{ref}} $, solid region).\n    - Case B2: $ H = 100000 $ (mushy region).\n    - Case B3: $ H = H_\\ell $ (exactly at $ T_\\ell $).\n    - Case B4: $ H = 600000 $ (liquid region).\n\nYour program should produce a single line of output containing the temperatures corresponding to Cases $ \\mathrm{A1} $ to $ \\mathrm{A5} $ followed by Cases $ \\mathrm{B1} $ to $ \\mathrm{B4} $ as a comma-separated list enclosed in square brackets (for example, $ [T_{\\mathrm{A1}}, T_{\\mathrm{A2}}, \\dots, T_{\\mathrm{B4}}] $). All temperatures must be in Kelvin ($\\mathrm{K}$), rounded to six decimal places.",
            "solution": "The problem requires the design and implementation of a robust, globally convergent numerical scheme to find the temperature $T$ corresponding to a given specific enthalpy $H$. This inversion of the constitutive relation $H(T)$ is a fundamental post-processing step in each time iteration of an implicit, enthalpy-based finite volume or finite element solver for phase-change problems. The energy conservation equation is given by $ \\rho \\, \\dfrac{\\partial H}{\\partial t} = \\nabla \\cdot \\left( k \\nabla T \\right) $. After discretizing and solving this equation for the enthalpy field $H^{n+1}$ at the new time step, one must recover the temperature field $T^{n+1}$ via the function $T(H)$.\n\nThe provided constitutive relation $H(T)$ is a continuous, piecewise-linear function defined over three domains: solid, mushy, and liquid.\n$$\nH(T) =\n\\begin{cases}\nc_s \\,(T - T_{\\mathrm{ref}}),  T \\le T_s \\\\\nH_s + \\left(c_m + \\dfrac{L}{T_\\ell - T_s}\\right)\\,(T - T_s),  T_s  T \\le T_\\ell \\\\\nH_\\ell + c_\\ell \\,(T - T_\\ell),  T  T_\\ell\n\\end{cases}\n$$\nThe thresholds $H_s$ and $H_\\ell$ mark the transition between phases:\n$$\nH_s = c_s \\,(T_s - T_{\\mathrm{ref}})\n$$\n$$\nH_\\ell = H_s + c_m \\,(T_\\ell - T_s) + L\n$$\nThe physical constraints $c_s  0$, $c_m  0$, $c_\\ell  0$, $L  0$, and $T_\\ell  T_s$ ensure that the slope of $H(T)$, which represents the effective heat capacity $dH/dT$, is strictly positive in all three regions.\nThe slopes are:\n- Solid region ($T \\le T_s$): $S_s = c_s  0$\n- Mushy region ($T_s  T \\le T_\\ell$): $S_m = c_m + \\dfrac{L}{T_\\ell - T_s}  0$\n- Liquid region ($T  T_\\ell$): $S_\\ell = c_\\ell  0$\n\nA function that is continuous and has a strictly positive derivative (or slope, in this piecewise case) everywhere is strictly monotonically increasing. A key mathematical principle states that any strictly monotonic function over a given domain has a unique inverse function over its range. Therefore, for any given value of enthalpy $H$, there exists one and only one corresponding temperature $T$. This guarantees that the problem of inverting $H(T)$ is well-posed.\n\nThe problem demands a scheme that is globally convergent and handles the non-differentiable points at $T=T_s$ and $T=T_\\ell$. For a piecewise-linear function, the most robust, efficient, and accurate \"scheme\" is not an iterative one (like bisection or Newton's method, which is not ideal due to the kinks) but rather a direct analytical inversion. This approach can be viewed as an algorithm that converges in a single step with zero error. It is globally convergent because it provides the exact solution for any input $H \\in \\mathbb{R}$.\n\nThe inversion procedure is as follows. We derive the inverse function $T(H)$ for each of the three linear segments. The choice of which inverse formula to apply is determined by comparing the given enthalpy $H$ against the threshold values $H_s$ and $H_\\ell$.\n\n1.  **Inverse for the Solid Region ($H \\le H_s$):**\n    Given $H = c_s(T - T_{\\mathrm{ref}})$, we solve for $T$:\n    $$ \\frac{H}{c_s} = T - T_{\\mathrm{ref}} $$\n    $$ T(H) = T_{\\mathrm{ref}} + \\frac{H}{c_s} $$\n\n2.  **Inverse for the Mushy Region ($H_s  H \\le H_\\ell$):**\n    Given $H = H_s + \\left(c_m + \\frac{L}{T_\\ell - T_s}\\right)(T - T_s)$, we solve for $T$:\n    $$ H - H_s = \\left(c_m + \\frac{L}{T_\\ell - T_s}\\right)(T - T_s) $$\n    $$ T - T_s = \\frac{H - H_s}{c_m + \\frac{L}{T_\\ell - T_s}} $$\n    $$ T(H) = T_s + \\frac{H - H_s}{c_m + \\frac{L}{T_\\ell - T_s}} $$\n\n3.  **Inverse for the Liquid Region ($H  H_\\ell$):**\n    Given $H = H_\\ell + c_\\ell(T - T_\\ell)$, we solve for $T$:\n    $$ H - H_\\ell = c_\\ell(T - T_\\ell) $$\n    $$ T - T_\\ell = \\frac{H - H_\\ell}{c_\\ell} $$\n    $$ T(H) = T_\\ell + \\frac{H - H_\\ell}{c_\\ell} $$\n\nThe complete algorithm for finding $T$ from a given $H$ is:\n1.  For the given material parameters, calculate the threshold enthalpies $H_s$ and $H_\\ell$.\n2.  If the target enthalpy $H_{\\text{target}} \\le H_s$, apply the solid region inverse formula. The equality case $H_{\\text{target}} = H_s$ correctly yields $T=T_s$.\n3.  If $H_s  H_{\\text{target}} \\le H_\\ell$, apply the mushy region inverse formula. The equality case $H_{\\text{target}} = H_\\ell$ correctly yields $T=T_\\ell$.\n4.  If $H_{\\text{target}}  H_\\ell$, apply the liquid region inverse formula.\n\nThis case-based analytical inversion scheme is implemented in the provided program to solve for the temperatures requested in the test suite. It satisfies all problem constraints by being direct, exact, computationally efficient, and unconditionally stable, leveraging the fundamental monotonic property of the enthalpy-temperature relationship.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for temperature T by inverting the piecewise-linear enthalpy function H(T)\n    for a given set of materials and target enthalpy values.\n    \"\"\"\n\n    # Define the material properties and target enthalpy values as specified in the problem statement.\n    # Each entry is a tuple: (material_parameters_dict, list_of_target_H).\n    # Some targets are functions of material parameters (e.g., H_s, H_l) and are denoted by strings.\n    test_cases = [\n        (\n            {\n                \"name\": \"Material A\",\n                \"T_ref\": 300.0,\n                \"c_s\": 600.0,\n                \"c_m\": 700.0,\n                \"c_l\": 800.0,\n                \"L\": 260000.0,\n                \"T_s\": 1700.0,\n                \"T_l\": 1800.0,\n            },\n            [500000.0, \"H_s\", 900000.0, \"H_l\", 1300000.0],\n        ),\n        (\n            {\n                \"name\": \"Material B\",\n                \"T_ref\": 273.0,\n                \"c_s\": 2100.0,\n                \"c_m\": 3000.0,\n                \"c_l\": 4180.0,\n                \"L\": 334000.0,\n                \"T_s\": 273.0,\n                \"T_l\": 274.0,\n            },\n            [-10000.0, 100000.0, \"H_l\", 600000.0],\n        ),\n    ]\n\n    results = []\n    \n    for params, targets in test_cases:\n        # Unpack material parameters\n        T_ref = params[\"T_ref\"]\n        c_s = params[\"c_s\"]\n        c_m = params[\"c_m\"]\n        c_l = params[\"c_l\"]\n        L = params[\"L\"]\n        T_s = params[\"T_s\"]\n        T_l = params[\"T_l\"]\n\n        # Step 1: Calculate the threshold enthalpies H_s and H_l\n        H_s = c_s * (T_s - T_ref)\n        H_l = H_s + c_m * (T_l - T_s) + L\n\n        # Calculate the effective specific heat in the mushy region\n        # This check handles the case T_l = T_s, although constraints say T_l  T_s.\n        if T_l  T_s:\n            c_eff_mushy = c_m + L / (T_l - T_s)\n        else:\n            # For an isothermal phase change, the mushy region has zero width.\n            # Enthalpy jumps from H_s to H_l = H_s + L at T = T_s.\n            c_eff_mushy = np.inf\n\n\n        # Replace string placeholders with calculated values\n        processed_targets = []\n        for h_val in targets:\n            if h_val == \"H_s\":\n                processed_targets.append(H_s)\n            elif h_val == \"H_l\":\n                processed_targets.append(H_l)\n            else:\n                processed_targets.append(h_val)\n\n        for H_target in processed_targets:\n            # Implement the direct analytical inversion\n            if H_target = H_s:\n                # Solid Region: T = T_ref + H / c_s\n                temp = T_ref + H_target / c_s\n            elif H_s  H_target = H_l:\n                # Mushy Region: T = T_s + (H - H_s) / c_eff_mushy\n                if T_l  T_s:\n                    temp = T_s + (H_target - H_s) / c_eff_mushy\n                else: # Isothermal case, T must be T_s=T_l\n                    temp = T_s\n            else: # H_target  H_l\n                # Liquid Region: T = T_l + (H - H_l) / c_l\n                temp = T_l + (H_target - H_l) / c_l\n            \n            # Append the result, rounded to six decimal places, as required.\n            results.append(round(temp, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}