{
    "hands_on_practices": [
        {
            "introduction": "Before solving a Stefan problem numerically, a key first step is to characterize its physical nature. The Stefan number, $Ste$, provides a crucial dimensionless measure of the ratio between sensible heat and latent heat. Understanding the magnitude of $Ste$ allows you to anticipate the dynamics of the phase-change interface—whether it moves slowly or quickly—and informs critical decisions about the numerical approach, such as the choice of time-stepping scheme and grid resolution requirements. This practice focuses on this essential diagnostic step. ",
            "id": "3987464",
            "problem": "A one-dimensional (1D) semi-infinite phase-change slab occupying $x \\geq 0$ is initially at the phase-change temperature $T_{m}$. At time $t=0$, the boundary at $x=0$ is suddenly raised and held at a higher temperature $T_{b}  T_{m}$, initiating melting with a sharp solid–liquid interface at $x = s(t)$. Assume a one-phase Stefan formulation in which the solid remains at $T_{m}$ and heat conduction occurs only in the liquid, with a sharp interface and no mushy region. The liquid has thermal conductivity $k$, density $\\rho$, specific heat at constant pressure $c_{p}$, and the material has latent heat of fusion $L$.\n\nGiven the following physically plausible parameters representative of a paraffin-like phase change material:\n- $k = 0.40\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$,\n- $\\rho = 900\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n- $c_{p} = 2200\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$,\n- $L = 2.60 \\times 10^{5}\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}$,\n- $T_{m} = 327\\ \\mathrm{K}$,\n- $T_{b} = 342\\ \\mathrm{K}$,\n\ncompute the dimensionless Stefan number that characterizes the ratio of sensible heating to latent heat in this melting scenario. Then, based on first principles, discuss the expected qualitative regime of interface dynamics (for example, slow or fast melting) and the implications for discretization in a computational solver for the moving-boundary problem, including time-stepping, grid resolution, and method choice. Express your final answer as a single dimensionless number rounded to three significant figures.",
            "solution": "The user has provided a problem that requires critical validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- Domain: A one-dimensional (1D) semi-infinite slab, $x \\geq 0$.\n- Initial Condition ($t=0$): The entire slab is at the phase-change temperature, $T(x,0) = T_{m}$ for all $x \\geq 0$.\n- Boundary Condition ($x=0$): The boundary is held at a constant temperature $T_{b}  T_{m}$ for $t  0$, i.e., $T(0,t) = T_{b}$.\n- Interface: A sharp solid–liquid interface exists at position $x = s(t)$.\n- Model: One-phase Stefan problem, where the solid remains at $T = T_{m}$ and heat conduction occurs only in the liquid phase ($0 \\leq x \\leq s(t)$).\n- Liquid phase properties:\n  - Thermal conductivity: $k = 0.40\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$\n  - Density: $\\rho = 900\\ \\mathrm{kg}\\,\\mathrm{m}^{-3}$\n  - Specific heat: $c_{p} = 2200\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- Material property:\n  - Latent heat of fusion: $L = 2.60 \\times 10^{5}\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}$\n- Temperatures:\n  - Melting temperature: $T_{m} = 327\\ \\mathrm{K}$\n  - Boundary temperature: $T_{b} = 342\\ \\mathrm{K}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is validated against the required criteria.\n1.  **Scientifically Grounded:** The problem describes a classic one-phase Stefan problem, a fundamental and well-established model in transient heat transfer with phase change. The physics is sound. The provided material parameters are explicitly stated to be representative of a paraffin-like material and are physically realistic in their orders of magnitude and units.\n2.  **Well-Posed:** The problem is well-posed. The initial and boundary conditions are sufficient to define a unique solution for the temperature field in the liquid and the position of the moving interface. The task is to compute a standard dimensionless number (the Stefan number) and provide a qualitative discussion based on established principles of computational heat transfer.\n3.  **Objective:** The problem is stated using clear, objective, and quantitative language.\n4.  **Complete and Consistent:** All necessary data for calculating the Stefan number are provided. The condition $T_{b}  T_{m}$ ensures that melting will occur, which is consistent with the problem setup. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided.\n\nThe problem requires two parts: the calculation of the Stefan number and a qualitative discussion of its implications for the problem's dynamics and numerical solution.\n\n**Part 1: Calculation of the Stefan Number**\n\nThe Stefan number, denoted as $Ste$, is a dimensionless parameter that represents the ratio of sensible heat to latent heat. For a melting problem, it is typically defined based on the properties of the liquid phase. The characteristic sensible heat is the energy required to raise the temperature of a unit mass of the liquid from the melting temperature $T_m$ to the boundary temperature $T_b$. The latent heat is the energy required to melt a unit mass of the solid at temperature $T_m$.\n\nThe mathematical definition of the Stefan number is:\n$$\nSte = \\frac{c_{p} (T_{b} - T_{m})}{L}\n$$\nwhere:\n- $c_p$ is the specific heat of the liquid.\n- $L$ is the latent heat of fusion.\n- $T_b$ is the boundary temperature.\n- $T_m$ is the melting temperature.\n\nSubstituting the given values into this definition:\n- $c_{p} = 2200\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- $T_{b} = 342\\ \\mathrm{K}$\n- $T_{m} = 327\\ \\mathrm{K}$\n- $L = 2.60 \\times 10^{5}\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}$\n\nThe temperature difference is $\\Delta T = T_{b} - T_{m} = 342\\ \\mathrm{K} - 327\\ \\mathrm{K} = 15\\ \\mathrm{K}$.\n\nNow we compute the Stefan number:\n$$\nSte = \\frac{(2200\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}) \\times (15\\ \\mathrm{K})}{2.60 \\times 10^{5}\\ \\mathrm{J}\\,\\mathrm{kg}^{-1}}\n$$\n$$\nSte = \\frac{33000}{260000} = \\frac{33}{260}\n$$\nCalculating the numerical value:\n$$\nSte \\approx 0.126923...\n$$\nRounding to three significant figures, the Stefan number is $0.127$.\n\n**Part 2: Discussion of Interface Dynamics and Computational Implications**\n\nThe calculated Stefan number is $Ste \\approx 0.127$. This value is significantly less than $1$ ($Ste \\ll 1$), which has important physical and numerical consequences.\n\n**Qualitative Regime of Interface Dynamics:**\nA small Stefan number indicates that the latent heat of fusion ($L$) is large compared to the sensible heat capacity of the liquid phase ($c_{p} (T_{b} - T_{m})$). This signifies a **latent-heat-dominated** process. Physically, it means that the majority of the heat flux arriving at the solid-liquid interface is consumed by the phase change itself, with a smaller fraction being used to raise the temperature of the newly formed liquid.\nThis leads to a **slow melting** regime. The interface $s(t)$ moves slowly because a substantial amount of energy is required to overcome the latent heat barrier and melt the solid. In such a regime, the temperature profile in the liquid phase, $T(x,t)$ for $0 \\leq x \\leq s(t)$, tends to be nearly linear. This is because the slow movement of the boundary allows the temperature field to relax towards a quasi-steady state. The governing heat equation in the liquid is $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$, where $\\alpha = k/(\\rho c_p)$ is the thermal diffusivity. For slow interface motion, the transient term $\\frac{\\partial T}{\\partial t}$ becomes small compared to the diffusion term, and the temperature profile approaches the steady-state linear profile.\n\n**Implications for Discretization in a Computational Solver:**\n\nThe small Stefan number ($Ste \\ll 1$) categorizes this as a numerically \"stiff\" problem, which guides the choice of numerical methods, time-stepping, and grid resolution.\n\n1.  **Method Choice:**\n    - **Front-Tracking Methods:** These methods explicitly track the interface position $s(t)$ and solve the heat equation in the liquid domain with a moving boundary. For a 1D problem with a sharp interface like this, front-tracking is highly accurate. However, it becomes complex to implement for problems in higher dimensions or with topological changes of the interface.\n    - **Fixed-Grid Methods:** These are generally more robust and easier to implement. The most common is the **enthalpy method**. The problem is reformulated using enthalpy as the primary variable, resulting in a single governing equation for the entire domain. The phase change is implicitly handled through the enthalpy-temperature relationship, $H(T)$. The sharp interface is typically smeared over one or two grid cells. This method is strongly conservative and robust, making it a standard choice for industrial codes. Another fixed-grid approach is the **effective heat capacity method**, where the latent heat is modeled as a large spike in specific heat around $T_m$. This often leads to severe numerical stiffness problems and requires very small time steps for stability, making it less favorable than the enthalpy method. Given the stiffness ($Ste \\ll 1$), the enthalpy method is an excellent choice.\n\n2.  **Time-Stepping ($\\Delta t$):**\n    - The problem's stiffness, arising from the large latent heat term, strongly favors the use of **implicit time integration schemes** (e.g., backward Euler, Crank-Nicolson). Explicit schemes would be subject to a very restrictive time step limit for stability, especially when using an effective heat capacity formulation. Implicit methods are unconditionally stable, allowing for larger time steps determined by accuracy rather than stability.\n    - Even with an implicit scheme, the time step must be small enough to accurately resolve the interface motion. A common rule of thumb is to ensure the interface moves less than one grid cell width ($\\Delta x$) per time step to avoid non-physical \"jumping\" of the phase front and maintain accuracy in the enthalpy method. Since the melting is slow (due to small $Ste$), the interface velocity is low, which can be less demanding on the time step size compared to a high-$Ste$ problem, but the ultimate choice depends on the desired accuracy.\n\n3.  **Grid Resolution ($\\Delta x$):**\n    - The Stefan condition at the interface, $k \\frac{\\partial T}{\\partial x}|_{x=s(t)^-} = \\rho L \\frac{ds}{dt}$, shows that the interface velocity is proportional to the temperature gradient at the front. Accurately resolving this gradient is critical. This necessitates a fine grid resolution in the vicinity of the moving interface.\n    - In fixed-grid methods, the interface location and temperature profiles are more accurate with a finer mesh. The smearing of the phase front is reduced as $\\Delta x \\to 0$.\n    - Because the temperature profile in the bulk of the liquid is nearly linear (a consequence of $Ste \\ll 1$), a coarser mesh may be sufficient away from the interface. This makes the problem an ideal candidate for **adaptive mesh refinement (AMR)**. With AMR, a fine grid is used only near the interface and moves with it, while a coarser grid is used elsewhere. This strategy provides high accuracy where it is most needed without the prohibitive computational cost of a globally fine mesh, making it a highly efficient approach for Stefan problems.",
            "answer": "$$\n\\boxed{0.127}\n$$"
        },
        {
            "introduction": "For certain regimes, particularly those with low Stefan numbers, the heat transfer can be approximated as quasi-steady, simplifying the governing partial differential equation to an ordinary differential equation (ODE) for the interface position. This provides a perfect setting to study the core numerical challenge of advancing the moving boundary in time. This exercise tasks you with implementing and contrasting explicit and implicit time integration schemes for the interface's ODE, allowing you to gain direct insight into numerical stability and accuracy, which are critical concepts in solving Stefan problems. ",
            "id": "3987441",
            "problem": "Consider the one-dimensional, one-phase Stefan problem for a melting front in a slab occupying the interval $0 \\le x \\le s(t)$, where $s(t)$ denotes the position (in meters) of the solid–liquid interface at time $t$ (in seconds). The solid is initially at uniform temperature, and its boundary at $x=0$ is suddenly held at a hot temperature $T_0$ (in kelvin) greater than the melting temperature $T_m$ (in kelvin). Assume the solid phase remains at the melting temperature $T_m$ (a one-phase problem) and that heat conduction in the liquid is quasi-steady. The temperature field in the liquid thus satisfies a linear profile governed by Fourier's law of heat conduction and the energy balance at the moving interface (the Stefan condition).\n\nFundamental laws and definitions:\n- Fourier's law relates heat flux to temperature gradient by $q = -k \\,\\partial T/\\partial x$, where $k$ is thermal conductivity (in watts per meter kelvin).\n- Conservation of energy at the moving interface (the Stefan condition) states that the rate of latent heat release or absorption equals the heat flux entering the interface, $\\rho L \\, \\dfrac{ds}{dt} = -k \\,\\left.\\dfrac{\\partial T}{\\partial x}\\right|_{x=s(t)^-}$, where $\\rho$ is density (in kilograms per cubic meter) and $L$ is latent heat of fusion (in joules per kilogram).\n\nUnder the quasi-steady assumption with boundary conditions $T(0,t) = T_0$ and $T(s(t),t) = T_m$, the temperature field is $T(x,t) = T_0 + \\dfrac{T_m - T_0}{s(t)}\\,x$. Inserting this into the Stefan condition yields an ordinary differential equation (ODE) for the interface:\n$$\n\\frac{ds}{dt} = \\frac{C}{s(t)}, \\quad C := \\frac{k\\,(T_0 - T_m)}{\\rho\\,L}.\n$$\nFor melting, $T_0  T_m$ so $C  0$; for solidification (cooling), $C  0$ if $T_0  T_m$.\n\nYour task is to design, analyze, and implement two time-discretization schemes for advancing the interface position:\n- An explicit update\n$$\ns^{n+1} = s^n + \\Delta t \\, V_n, \\quad V_n := \\frac{C}{s^n},\n$$\n- An implicit update\n$$\ns^{n+1} = s^n + \\Delta t \\, V_n^{n+1}, \\quad V_n^{n+1} := \\frac{C}{s^{n+1}},\n$$\nwhere $s^n$ approximates $s(t^n)$ at discrete time $t^n = n\\,\\Delta t$ and $\\Delta t$ is the time step (in seconds).\n\nStarting from the above fundamental laws and definitions, you must:\n1. Derive the ODE for $s(t)$ and its exact solution,\n$$\ns(t) = \\sqrt{s(0)^2 + 2\\,C\\,t}.\n$$\n2. Derive and compare the stability properties of the explicit and implicit updates by analyzing the explicit update mapping $g(s) := s + \\Delta t\\,C/s$ and the implicit update’s quadratic relation for $s^{n+1}$. Use a principle-based argument tied to monotonicity and the discrete energy $E(s) := s^2$ to justify your conclusions.\n3. Derive a time-step restriction for the explicit scheme that ensures monotonicity and controls discrete energy growth. Express the derived maximum allowable time step $\\Delta t_{\\max}$ in seconds.\n\nImplementation requirements:\n- Implement both updates to advance $s(t)$ from the initial value $s(0)=s_0$ to a final time $t_{\\mathrm{end}}$.\n- Use a variable number of time steps $N = \\lceil t_{\\mathrm{end}}/\\Delta t \\rceil$ and a last partial step if needed so that the total advancement equals $t_{\\mathrm{end}}$.\n- For each test case, compute:\n  - The explicit scheme’s final interface position $s_{\\mathrm{exp}}(t_{\\mathrm{end}})$ (in meters).\n  - The implicit scheme’s final interface position $s_{\\mathrm{imp}}(t_{\\mathrm{end}})$ (in meters).\n  - The exact solution $s_{\\mathrm{exact}}(t_{\\mathrm{end}})$ (in meters).\n  - The derived explicit stability boolean $\\mathrm{stable}_{\\mathrm{exp}}$ defined by the inequality $\\Delta t  \\Delta t_{\\max}$ with $\\Delta t_{\\max} := \\dfrac{s_0^2}{C}$ for $C0$ and $\\Delta t_{\\max} := \\dfrac{s_0^2}{|C|}$ for $C0$, expressed in seconds.\n  - The relative errors for the explicit and implicit schemes, respectively,\n  $$\n  e_{\\mathrm{exp}} := \\frac{\\left|s_{\\mathrm{exp}}(t_{\\mathrm{end}}) - s_{\\mathrm{exact}}(t_{\\mathrm{end}})\\right|}{s_{\\mathrm{exact}}(t_{\\mathrm{end}})}, \\quad\n  e_{\\mathrm{imp}} := \\frac{\\left|s_{\\mathrm{imp}}(t_{\\mathrm{end}}) - s_{\\mathrm{exact}}(t_{\\mathrm{end}})\\right|}{s_{\\mathrm{exact}}(t_{\\mathrm{end}})},\n  $$\n  which are dimensionless decimals.\n\nTest suite:\nUse the following physically plausible parameters, consistent with a metal such as aluminum:\n- Thermal conductivity $k = 200$ $\\mathrm{W/(m\\cdot K)}$,\n- Density $\\rho = 2700$ $\\mathrm{kg/m^3}$,\n- Latent heat $L = 397000$ $\\mathrm{J/kg}$,\n- Melting temperature $T_m = 933$ $\\mathrm{K}$,\n- Hot boundary temperature $T_0 = 1033$ $\\mathrm{K}$,\n- Interface initial position $s_0 = 1\\times 10^{-3}$ $\\mathrm{m}$,\n- Final time $t_{\\mathrm{end}} = 10$ $\\mathrm{s}$.\n\nWith these shared parameters, evaluate three distinct time-step scenarios:\n- Case A (happy path): $\\Delta t = 0.01$ $\\mathrm{s}$.\n- Case B (boundary): $\\Delta t = \\Delta t_{\\max}$ (computed from the derived restriction, in seconds).\n- Case C (edge): $\\Delta t = 0.5$ $\\mathrm{s}$.\n\nYour program should produce a single line of output containing the aggregated results for the three test cases as a comma-separated list enclosed in square brackets. For each case, output in the order\n$$\n\\left[\\Delta t_{\\max}\\;\\mathrm{(in\\;s)},\\;\\mathrm{stable}_{\\mathrm{exp}}\\;\\mathrm{(boolean)},\\;e_{\\mathrm{exp}}\\;\\mathrm{(decimal)},\\;e_{\\mathrm{imp}}\\;\\mathrm{(decimal)}\\right],\n$$\nconcatenated for all three cases on one line. For example, the final output format must be\n$$\n\\left[\\Delta t_{\\max}^{(A)},\\mathrm{stable}_{\\mathrm{exp}}^{(A)},e_{\\mathrm{exp}}^{(A)},e_{\\mathrm{imp}}^{(A)},\\Delta t_{\\max}^{(B)},\\mathrm{stable}_{\\mathrm{exp}}^{(B)},e_{\\mathrm{exp}}^{(B)},e_{\\mathrm{imp}}^{(B)},\\Delta t_{\\max}^{(C)},\\mathrm{stable}_{\\mathrm{exp}}^{(C)},e_{\\mathrm{exp}}^{(C)},e_{\\mathrm{imp}}^{(C)}\\right],\n$$\nwhere every numeric entry is a plain decimal and every boolean entry is in the programming language’s native boolean format. All $\\Delta t_{\\max}$ entries must be expressed in seconds.",
            "solution": "The problem is well-posed, scientifically grounded in the principles of heat transfer, and provides a complete and consistent set of data and definitions for a computational task. It is a standard problem in the numerical analysis of moving boundary problems. Therefore, the problem is valid.\n\nThe solution proceeds in three parts as requested: (1) derivation of the governing ordinary differential equation (ODE) and its exact solution, (2) derivation and comparison of the stability properties of the explicit and implicit numerical schemes, and (3) implementation of the schemes to compute the requested outputs.\n\n### 1. Derivation of the Exact Solution\n\nThe problem states that under a quasi-steady assumption, the temperature profile in the solid phase $0 \\le x \\le s(t)$ is linear. Given the boundary conditions $T(x=0, t) = T_0$ and $T(x=s(t), t) = T_m$, the temperature field $T(x,t)$ is given by linear interpolation:\n$$\nT(x,t) = T_0 + \\frac{T_m - T_0}{s(t)} x\n$$\nThe heat flux $q$ is related to the temperature gradient by Fourier's law: $q = -k \\frac{\\partial T}{\\partial x}$. The gradient is uniform in space:\n$$\n\\frac{\\partial T}{\\partial x} = \\frac{T_m - T_0}{s(t)}\n$$\nThe Stefan condition at the interface $x=s(t)$ represents conservation of energy. The rate of energy consumed by phase change per unit area must equal the heat flux entering the interface from the solid side.\n$$\n\\rho L \\frac{ds}{dt} = -k \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=s(t)^-}\n$$\nwhere $\\rho$ is the density, $L$ is the latent heat of fusion, and $k$ is the thermal conductivity. The notation $x=s(t)^-$ indicates the limit approaching the interface from the solid side ($x  s(t)$).\n\nSubstituting the expression for the temperature gradient into the Stefan condition yields:\n$$\n\\rho L \\frac{ds}{dt} = -k \\left( \\frac{T_m - T_0}{s(t)} \\right) = \\frac{k (T_0 - T_m)}{s(t)}\n$$\nThis can be rearranged into an ordinary differential equation for the interface position $s(t)$:\n$$\n\\frac{ds}{dt} = \\frac{k(T_0 - T_m)}{\\rho L} \\frac{1}{s(t)}\n$$\nDefining the constant $C := \\frac{k(T_0 - T_m)}{\\rho L}$, the ODE is:\n$$\n\\frac{ds}{dt} = \\frac{C}{s(t)}\n$$\nThis is a separable first-order ODE. We can solve it by separating variables and integrating from the initial state $(s(0), 0)$ to a state $(s(t), t)$:\n$$\ns(t) \\frac{ds}{dt} = C \\implies \\int_{s(0)}^{s(t)} s' ds' = \\int_0^t C dt'\n$$\nPerforming the integration gives:\n$$\n\\left[ \\frac{1}{2} (s')^2 \\right]_{s(0)}^{s(t)} = [C t']_0^t\n$$\n$$\n\\frac{1}{2}s(t)^2 - \\frac{1}{2}s(0)^2 = C t\n$$\nRearranging for $s(t)^2$ and solving for $s(t)$ (taking the positive root since position must be positive):\n$$\ns(t)^2 = s(0)^2 + 2Ct\n$$\n$$\ns(t) = \\sqrt{s(0)^2 + 2Ct}\n$$\nThis is the exact solution for the interface position, given the initial position $s(0)$.\n\n### 2. Stability Analysis of Discretization Schemes\n\nWe analyze the explicit and implicit schemes for advancing the solution from time $t^n$ to $t^{n+1} = t^n + \\Delta t$.\n\n**Explicit Scheme:**\nThe explicit update is given by $s^{n+1} = s^n + \\Delta t \\frac{C}{s^n}$. This can be written as an iterative map $s^{n+1} = g(s^n)$ where $g(s) = s + \\frac{\\Delta t C}{s}$.\n\nFor a melting problem, $T_0  T_m$, so $C  0$. We expect $s(t)$ to be a monotonically increasing function of time. A physically consistent numerical scheme should reflect this. Let's analyze the monotonicity of the update map $g(s)$. The derivative is:\n$$\ng'(s) = \\frac{d}{ds} \\left( s + \\frac{\\Delta t C}{s} \\right) = 1 - \\frac{\\Delta t C}{s^2}\n$$\nFor $g(s)$ to be a monotonically increasing function, we require $g'(s) \\ge 0$. This condition prevents unphysical oscillations, where a larger current position $s^n$ would lead to a smaller next position $s^{n+1}$.\n$$\n1 - \\frac{\\Delta t C}{s^2} \\ge 0 \\implies 1 \\ge \\frac{\\Delta t C}{s^2} \\implies \\Delta t \\le \\frac{s^2}{C}\n$$\nSince $s(t)$ increases with time for $C0$, the term $s^2/C$ also increases. The most restrictive constraint on $\\Delta t$ occurs at the smallest value of $s$, which is the initial position $s_0 = s(0)$. Therefore, to ensure monotonicity for all steps, we must impose the condition:\n$$\n\\Delta t \\le \\frac{s_0^2}{C}\n$$\nThis defines the maximum allowable time step, $\\Delta t_{\\max} := \\frac{s_0^2}{C}$. If $\\Delta t  \\Delta t_{\\max}$, the scheme can become oscillatory and is considered unstable in this sense.\n\nFrom an energy perspective, we examine the evolution of the discrete energy $E(s) := s^2$. For the explicit scheme:\n$$\nE(s^{n+1}) = (s^{n+1})^2 = \\left(s^n + \\frac{\\Delta t C}{s^n}\\right)^2 = (s^n)^2 + 2C\\Delta t + \\frac{(\\Delta t C)^2}{(s^n)^2}\n$$\nThe exact solution evolves as $s(t_{n+1})^2 = s(t_n)^2 + 2C\\Delta t$. The explicit scheme introduces an additional non-negative term $\\frac{(\\Delta t C)^2}{(s^n)^2}$, which is a form of numerical dissipation. This term causes a systematic over-estimation of the energy $s^2$, and consequently an over-estimation of the interface position $s(t)$.\n\n**Implicit Scheme:**\nThe implicit update is given by $s^{n+1} = s^n + \\Delta t \\frac{C}{s^{n+1}}$. This can be rearranged into a quadratic equation for $s^{n+1}$:\n$$\n(s^{n+1})^2 - s^n s^{n+1} - \\Delta t C = 0\n$$\nThe solution is given by the quadratic formula:\n$$\ns^{n+1} = \\frac{s^n \\pm \\sqrt{(s^n)^2 + 4\\Delta t C}}{2}\n$$\nSince $s^{n+1}$ must be positive, we must choose the `+` sign. For the melting case ($C0$), the term under the square root, $(s^n)^2 + 4\\Delta t C$, is always positive. Thus, a unique, real, positive solution for $s^{n+1}$ is guaranteed for any $\\Delta t  0$. This means the implicit scheme is unconditionally stable for melting problems; there is no upper limit on the time step $\\Delta t$ for stability.\n\nAnalyzing the discrete energy for the implicit scheme:\nA Taylor series expansion for small $\\Delta t$ shows that $(s^{n+1})^2 \\approx (s^n)^2 + 2C\\Delta t - \\frac{(\\Delta t C)^2}{(s^n)^2}$. The numerical error term is negative, leading to a systematic under-estimation of the energy $s^2$ and the interface position $s(t)$.\n\n**Comparison Summary:**\n- The **explicit scheme** is simple to implement but is only conditionally stable. It requires $\\Delta t \\le s_0^2/C$ to maintain monotonicity. It tends to overestimate the interface position.\n- The **implicit scheme** requires solving a quadratic equation at each step but is unconditionally stable for melting ($C0$). It tends to underestimate the interface position. Its superior stability makes it more robust, especially for large time steps.\n\n### 3. Time-Step Restriction\n\nAs derived in the stability analysis, the requirement for the explicit update map $g(s)$ to be monotonic, $g'(s) \\ge 0$, leads to the condition $\\Delta t \\le s^2/C$. To ensure this condition holds for the entire simulation, it must hold at the most restrictive point, which is at $t=0$ where $s=s_0$. This yields the maximum allowable time step:\n$$\n\\Delta t_{\\max} = \\frac{s_0^2}{C} = \\frac{s_0^2 \\rho L}{k(T_0 - T_m)}\n$$\nThe problem defines stability by the strict inequality $\\Delta t  \\Delta t_{\\max}$.\n\nFor the case of solidification where $T_0  T_m$ and $C  0$, the stability condition for the explicit scheme would arise from the need to keep $s^{n+1}$ positive, leading to $\\Delta t  (s^n)^2/|C|$. Since $s$ decreases, this condition becomes more restrictive over time. The implicit scheme, in this case, has a condition for the existence of real roots, $\\Delta t \\le (s^n)^2/(4|C|)$, which is more stringent. However, the present problem is a melting problem, so we focus on the $C0$ case.",
            "answer": "[0.053594900000000004,True,0.0002492850930776735,5.000109051406856e-05,0.053594900000000004,False,0.006103683838383839,0.0013570222222222224,0.053594900000000004,False,0.2545413168724279,0.02206131687242802]"
        },
        {
            "introduction": "While front-tracking methods are intuitive, they can be complex to implement for intricate geometries. A powerful and robust alternative is the enthalpy method, which reformulates the problem on a fixed grid by making volumetric enthalpy, $H$, the primary conserved variable. This comprehensive practice guides you through the implementation of a finite volume solver based on the enthalpy formulation. You will learn to manage the nonlinear relationship between enthalpy and temperature and, most importantly, to verify that your scheme upholds the fundamental principle of discrete energy conservation, a critical benchmark for any valid thermal simulation. ",
            "id": "3987456",
            "problem": "Consider a one-dimensional slab of length $L_x$ with uniform cross-sectional area $A$, material density $\\rho$, specific heat capacity $c_p$, thermal conductivity $k$, and latent heat of fusion $L_h$. The temperature-dependent phase fraction $\\phi(T)$ is defined by a linear mushy-zone model, where the solidus temperature is $T_s$ and the liquidus temperature is $T_l$. The phase fraction satisfies $\\phi(T)=0$ for $T \\le T_s$, $\\phi(T)=1$ for $T \\ge T_l$, and varies linearly as $\\phi(T)=(T-T_s)/(T_l-T_s)$ for $T_s  T  T_l$. The volumetric enthalpy is defined as $H(T) = \\rho c_p T + \\rho L_h \\phi(T)$. The heat flux is defined by Fourier’s law as $q = -k \\frac{\\partial T}{\\partial x}$.\n\nStarting from the conservation of energy, the enthalpy method models the evolution as $\\frac{\\partial H}{\\partial t} + \\frac{\\partial q}{\\partial x} = 0$. Discretize the slab using the Finite Volume Method (FVM) on $N$ uniform control volumes of width $\\Delta x = L_x/N$. Let $H_i^n$ denote the enthalpy in control volume $i$ at time level $n$, and define face-centered fluxes $q_{j}^n$ at faces $j=0,1,\\dots,N$ with $q_0^n$ prescribed at the left boundary (positive into the domain) and $q_N^n$ prescribed at the right boundary. The update of enthalpy in each control volume must be obtained from summing face fluxes consistent with local conservation over each control volume and time step $\\Delta t$. The temperature required to compute fluxes must be recovered from enthalpy by inverting the constitutive relation $H(T)$ piecewise across solid, mushy, and liquid regimes.\n\nYour task is to implement a program that:\n- Initializes the slab with a uniform temperature $T_0$ and computes the corresponding initial enthalpy $H_i^0$ for all $i$.\n- Advances the enthalpy field $H_i^n$ for a specified number of time steps using the described enthalpy method and FVM flux summation with an explicit temporal update that uses temperatures $T_i^n$ recovered from $H_i^n$ and central differences for interior face gradients.\n- At each time step $n \\to n+1$, computes the total latent heat consumed or released as $\\sum_i \\rho L_h \\left(\\phi_i^{n+1} - \\phi_i^n\\right) V_i$, where $V_i = A \\Delta x$, and records the sign convention that positive values represent latent heat consumption (melting) while negative values represent latent heat release (solidification).\n- Demonstrates discrete energy conservation by computing the global energy residual $R^n$ defined as the net external energy input during the time step minus the change in total enthalpy in the domain, i.e., $R^n = \\left(q_0^n - q_N^n\\right) A \\Delta t - \\sum_i \\left(H_i^{n+1} - H_i^n\\right) V_i$. Report the maximum absolute residual over all simulated time steps.\n\nAll energies must be expressed in Joules ($J$). Temperatures must be expressed in degrees Celsius ($^\\circ\\mathrm{C}$). Angles are not used. There are no percentages in the output.\n\nUse the following test suite of parameter sets to exercise the implementation across melting, solidification, and no-phase-change regimes. In all cases use $A=1$, $L_x=0.1$, $N=64$, $\\Delta t = 1.0$, $k=0.6$, $\\rho=1000$, $c_p=4200$, $L_h=334000$, $T_s=-1$, $T_l=1$, and simulate $N_t=30$ time steps. Prescribe the right boundary flux $q_N^n=0$ for all cases.\n\n- Case $1$ (melting): $T_0=-2$, left boundary flux $q_0^n=50000$ for all $n$.\n- Case $2$ (solidification): $T_0=2$, left boundary flux $q_0^n=-50000$ for all $n$.\n- Case $3$ (no phase change): $T_0=-10$, left boundary flux $q_0^n=1000$ for all $n$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, output two floats in $J$: first, the maximum absolute energy residual over all time steps, and second, the total latent heat consumed (positive) or released (negative) summed over all time steps. The final output must therefore be of the form $\\left[ r_1, \\ell_1, r_2, \\ell_2, r_3, \\ell_3 \\right]$, where $r_i$ and $\\ell_i$ are the residual and latent totals for case $i$ in $J$.",
            "solution": "The user-provided problem statement has been meticulously validated and is determined to be sound, well-posed, and scientifically grounded. It outlines a classical one-dimensional transient heat conduction problem with phase change, commonly known as a Stefan problem, to be solved using the enthalpy method with a Finite Volume Method (FVM) discretization. All parameters, governing equations, and boundary conditions are provided, enabling a direct and unambiguous implementation.\n\nThe solution is developed by adhering to the principles of conservation of energy and the specified numerical scheme. The primary steps involve discretizing the governing equation, defining the numerical update algorithm, and detailing the physical constitutive relations.\n\n**1. Governing Equation and Constitutive Relations**\n\nThe fundamental principle is the conservation of energy, which for a one-dimensional system is stated as:\n$$\n\\frac{\\partial H}{\\partial t} + \\frac{\\partial q}{\\partial x} = 0\n$$\nwhere $H$ is the volumetric enthalpy in $\\mathrm{J}/\\mathrm{m}^3$, $q$ is the heat flux in $\\mathrm{W}/\\mathrm{m}^2$, $t$ is time, and $x$ is the spatial coordinate.\n\nThe problem specifies the constitutive relations that connect the primary variables of enthalpy $H$ and temperature $T$:\nThe volumetric enthalpy $H(T)$ is a function of temperature, incorporating both sensible heat and latent heat:\n$$\nH(T) = \\rho c_p T + \\rho L_h \\phi(T)\n$$\nHere, $\\rho$ is density, $c_p$ is specific heat capacity, and $L_h$ is the latent heat of fusion. The phase fraction $\\phi(T)$ depends on the solidus temperature $T_s$ and liquidus temperature $T_l$:\n$$\n\\phi(T) =\n\\begin{cases}\n    0  \\text{if } T \\le T_s \\quad (\\text{Solid}) \\\\\n    \\frac{T-T_s}{T_l-T_s}  \\text{if } T_s  T  T_l \\quad (\\text{Mushy}) \\\\\n    1  \\text{if } T \\ge T_l \\quad (\\text{Liquid})\n\\end{cases}\n$$\nThe heat flux $q$ is given by Fourier's law of conduction:\n$$\nq = -k \\frac{\\partial T}{\\partial x}\n$$\nwhere $k$ is the thermal conductivity.\n\n**2. Finite Volume Discretization and Explicit Update**\n\nThe domain of length $L_x$ is discretized into $N$ uniform control volumes (CVs), each of width $\\Delta x = L_x/N$ and volume $V_i = A \\Delta x$, where $A$ is the cross-sectional area. We index the CVs from $i=0, \\dots, N-1$. The faces of the CVs are indexed $j=0, \\dots, N$, where face $j=0$ is the left boundary, face $j=N$ is the right boundary, and an interior face $j=i+1$ separates CV $i$ and CV $i+1$.\n\nIntegrating the governing equation over control volume $i$ (from $x_i$ to $x_{i+1}$) and over a time step $\\Delta t$ (from $t^n$ to $t^{n+1}$) yields the integral conservation law:\n$$\n\\int_{x_i}^{x_{i+1}} \\left( H(t^{n+1}) - H(t^n) \\right) dx + \\int_{t^n}^{t^{n+1}} \\left( q(x_{i+1}) - q(x_i) \\right) dt = 0\n$$\nApproximating the spatial and temporal integrals with values at the cell center and the beginning of the time step (an explicit formulation), we obtain the discrete equation for the average enthalpy $H_i$ in CV $i$:\n$$\n(H_i^{n+1} - H_i^n)\\Delta x + (q_{i+1}^n - q_i^n)\\Delta t = 0\n$$\nwhere $q_i^n$ and $q_{i+1}^n$ represent the fluxes at the left and right faces of CV $i$ at time level $n$, respectively. Rearranging for the updated enthalpy $H_i^{n+1}$:\n$$\nH_i^{n+1} = H_i^n - \\frac{\\Delta t}{\\Delta x} (q_{i+1}^n - q_i^n)\n$$\nThe problem defines boundary fluxes $q_0^n$ (left) and $q_N^n$ (right). Interior face fluxes are computed using a central difference approximation for the temperature gradient between adjacent cell centers:\n$$\nq_{i+1}^n \\approx -k \\frac{T_{i+1}^n - T_i^n}{\\Delta x} \\quad \\text{for } i = 0, \\dots, N-2\n$$\n\n**3. Enthalpy-Temperature Inversion**\n\nAt each time step, the temperature field $T^n$ must be recovered from the enthalpy field $H^n$ to compute the fluxes. This requires inverting the $H(T)$ relationship. Let $H_s = \\rho c_p T_s$ and $H_l = \\rho c_p T_l + \\rho L_h$ be the enthalpies at the solidus and liquidus points. The inversion is piecewise:\n- If $H \\le H_s$ (solid): $\\phi=0$, so $H = \\rho c_p T \\implies T = H / (\\rho c_p)$.\n- If $H \\ge H_l$ (liquid): $\\phi=1$, so $H = \\rho c_p T + \\rho L_h \\implies T = (H - \\rho L_h) / (\\rho c_p)$.\n- If $H_s  H  H_l$ (mushy): The phase fraction $\\phi$ is linearly related to enthalpy, $\\phi = (H - H_s) / (H_l - H_s)$. The temperature is then recovered by inverting the phase fraction definition: $T = T_s + \\phi(T_l - T_s)$. This two-step process ($H \\to \\phi \\to T$) is numerically robust.\n\n**4. Numerical Algorithm and Conservation Check**\n\nThe simulation proceeds as follows:\n1.  **Initialization**: Given an initial uniform temperature $T_0$, compute the initial phase fraction $\\phi_i^0$ and enthalpy $H_i^0$ for all CVs $i=0, \\dots, N-1$.\n2.  **Time Marching**: For each time step $n$ from $0$ to $N_t-1$:\n    a.  Store the current enthalpy field $H_i^n$ and phase fraction field $\\phi_i^n$.\n    b.  **Recover Temperature**: Compute $T_i^n$ from $H_i^n$ for all $i$ using the inversion logic.\n    c.  **Compute Fluxes**: Calculate all face fluxes $q_j^n$ for $j=0, \\dots, N$. The boundary fluxes $q_0^n$ and $q_N^n$ are prescribed, while interior fluxes are calculated from the temperature field $T^n$.\n    d.  **Update Enthalpy**: Compute the new enthalpy field $H_i^{n+1}$ for all $i$ using the explicit FVM update formula.\n    e.  **Post-Process**:\n        i.  Recover the new phase fraction $\\phi_i^{n+1}$ from $H_i^{n+1}$.\n        ii. Calculate the latent heat generation/consumption for the step: $\\Delta L^n = \\sum_i \\rho L_h (\\phi_i^{n+1} - \\phi_i^n) V_i$.\n        iii. check discrete energy conservation by computing the residual: $R^n = (q_0^n - q_N^n) A \\Delta t - \\sum_i (H_i^{n+1} - H_i^n) V_i$. Due to the formulation, this residual is theoretically zero and any non-zero value arises from floating-point arithmetic precision errors. The maximum absolute value of $R^n$ over the simulation is recorded.\n3.  **Reporting**: After completing all time steps for a given test case, the maximum absolute residual and the total accumulated latent heat are reported. This process is repeated for all test cases.",
            "answer": "[1.1368683772161603e-13,2887.890625,1.1368683772161603e-13,-2887.890625,0.0,0.0]"
        }
    ]
}