{
    "hands_on_practices": [
        {
            "introduction": "在船舶工程和涡轮机械等领域，准确预测空化现象至关重要，因为它可能导致性能下降、振动和材料侵蚀。本练习将运用流体力学的基本原理，如伯努利方程，并结合空化数（$\\sigma$）和压力系数（$C_p$）等关键无量纲参数。通过这项实践，您将学会如何基于给定的流动条件和计算流体动力学（CFD）的预测结果，评估水翼发生空化的风险 。",
            "id": "3972430",
            "problem": "一个二维水翼在温度为 $20\\,^{\\circ}\\mathrm{C}$ 的淡水中运行，该温度下水的饱和蒸气压为 $p_{v}=2.3\\,\\mathrm{kPa}$。自由来流的静压和速度分别为 $p_{\\infty}=100\\,\\mathrm{kPa}$ 和 $V=15\\,\\mathrm{m/s}$，水的密度为 $\\rho=1000\\,\\mathrm{kg/m^{3}}$。在工作攻角下进行的雷诺平均纳维-斯托克斯 (RANS) 计算预测，水翼表面的最小压力系数为 $C_{p,\\min}=-1.60$。假设自由来流为定常、不可压缩、无粘性流动，且水翼表面与参考自由来流位置之间的高度差可忽略不计。\n\n从无粘性流动的机械能守恒和压力系数的定义出发，推导用给定物理量表示的空化数 $\\sigma$ 的表达式，以及定义为蒸汽形成时的临界压力系数与计算出的 $C_{p,\\min}$ 之差的空化裕度 $\\Delta C_{p}$ 的表达式。计算给定工作条件下 $\\sigma$ 和 $\\Delta C_{p}$ 的数值。\n\n将最终答案表示为无量纲数。将两个值均四舍五入至四位有效数字，并按 $\\sigma$ 和 $\\Delta C_{p}$ 的顺序列于一个行矩阵中。",
            "solution": "适用的基本原理是沿流线的定常、不可压缩、无粘性流动的伯努利方程，其表达式为\n$$\np + \\tfrac{1}{2}\\rho v^{2} + \\rho g z = \\text{constant}.\n$$\n在自由来流和水翼表面上的一点之间，我们假设高度变化可忽略不计，因此重力项被消去。引入自由来流的物理量 $(p_{\\infty}, V)$ 和翼面局部值 $(p, v)$，伯努利关系简化为\n$$\np_{\\infty} + \\tfrac{1}{2}\\rho V^{2} = p + \\tfrac{1}{2}\\rho v^{2}.\n$$\n压力系数定义为\n$$\nC_{p} \\equiv \\frac{p - p_{\\infty}}{\\tfrac{1}{2}\\rho V^{2}}.\n$$\n当局部静压首次达到饱和蒸气压时，即 $p = p_{v}$，发生初生空化。相应的临界压力系数 $C_{p,\\text{crit}}$ 满足\n$$\nC_{p,\\text{crit}} = \\frac{p_{v} - p_{\\infty}}{\\tfrac{1}{2}\\rho V^{2}}.\n$$\n习惯上将空化数 $\\sigma$ 定义为一个正值，用以衡量自由来流压力相对于动压高出饱和蒸气压的程度，\n$$\n\\sigma \\equiv \\frac{p_{\\infty} - p_{v}}{\\tfrac{1}{2}\\rho V^{2}} = -\\,C_{p,\\text{crit}}.\n$$\n一个方便的空化风险定量度量是空化裕度，定义为临界压力系数与计算得到的最小压力系数之差，\n$$\n\\Delta C_{p} \\equiv C_{p,\\text{crit}} - C_{p,\\min}.\n$$\n使用 $C_{p,\\text{crit}}=-\\sigma$，上式可以直接用 $\\sigma$ 和 $C_{p,\\min}$ 表示为\n$$\n\\Delta C_{p} = -\\sigma - C_{p,\\min}.\n$$\n如果 $\\Delta C_{p} \\geq 0$，则 $C_{p,\\min} \\leq C_{p,\\text{crit}}$，局部压力达到或低于 $p_{v}$，表明发生初生空化；如果 $\\Delta C_{p}  0$，流动保持非空化状态，并存在安全裕度。\n\n现在我们计算数值。首先，动压为\n$$\nq \\equiv \\tfrac{1}{2}\\rho V^{2} = \\tfrac{1}{2}\\times 1000\\,\\mathrm{kg/m^{3}}\\times (15\\,\\mathrm{m/s})^{2} = \\tfrac{1}{2}\\times 1000\\times 225\\,\\mathrm{Pa} = 112{,}500\\,\\mathrm{Pa}.\n$$\n自由来流压力与饱和蒸气压之差为\n$$\np_{\\infty} - p_{v} = 100{,}000\\,\\mathrm{Pa} - 2{,}300\\,\\mathrm{Pa} = 97{,}700\\,\\mathrm{Pa}.\n$$\n因此空化数为\n$$\n\\sigma = \\frac{97{,}700}{112{,}500} = 0.868444\\ldots\n$$\n对于空化裕度，使用 $C_{p,\\min}=-1.60$，\n$$\n\\Delta C_{p} = -\\sigma - C_{p,\\min} = -0.868444\\ldots - (-1.60) = 1.60 - 0.868444\\ldots = 0.731555\\ldots\n$$\n四舍五入到四位有效数字，其值为\n$$\n\\sigma = 0.8684, \\quad \\Delta C_{p} = 0.7316.\n$$\n这些都是无量纲量。正的 $\\Delta C_{p}$ 表明，预测的 $C_{p,\\min}$ 相对于临界系数足够低，以至于压力达到了饱和蒸气压，这意味着在所述条件下会发生初生空化；然而，根据题目要求，最终答案仅以数字形式给出。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.8684  0.7316\\end{pmatrix}}$$"
        },
        {
            "introduction": "核沸腾传热的效率在很大程度上取决于加热表面上微观气泡成核点的密度和活性。本练习旨在揭示沸腾现象背后的微观物理机制，将热力学准则（克劳修斯-克拉佩龙方程）和表面张力效应（杨-拉普拉斯方程）与表面微观形貌联系起来。通过推导壁面过热度与活化成核点密度之间的标度律关系，您将深入理解宏观经验性沸腾模型背后的物理基础 。",
            "id": "3972442",
            "problem": "在常压下饱和水的池沸腾中，对于一个抛光的铜表面，形核点密度 $N_{s}$（单位面积的蒸汽形核点数量）取决于壁面过热度 $\\Delta T = T_{w} - T_{\\text{sat}}$，其中 $T_{w}$ 是壁面温度，$T_{\\text{sat}}$ 是饱和温度。考虑一个微粗糙的铜表面，其空腔可以被建模为具有口部半径 $r$ 分布的轴对称特征。一个空腔的激活受制于蒸汽胚胎的热力学稳定性，这取决于由杨-拉普拉斯关系描述的毛细管压力和由克劳修斯-克拉佩龙关系描述的局部蒸汽压力平衡。假设如下：\n- 曲率半径为 $r_{b}$ 的气泡的毛细管压力为 $2\\sigma / r_{b}$，其中 $\\sigma$ 是表面张力。\n- 在饱和点附近，蒸汽压力随温度的变化为 $p_{v}(T) \\approx p_{\\text{sat}} + \\left(\\frac{dp_{\\text{sat}}}{dT}\\right)_{T_{\\text{sat}}} \\Delta T$，其中 $\\Delta T = T - T_{\\text{sat}}$，$p_{\\text{sat}}$ 是饱和压力。克劳修斯-克拉佩龙关系给出 $\\frac{dp_{\\text{sat}}}{dT} = \\frac{h_{lv}}{T_{\\text{sat}}(v_{v} - v_{l})}$，其中 $h_{lv}$ 是汽化潜热，$v_{v}$ 和 $v_{l}$ 分别是蒸汽和液体的比容。对于饱和水，$v_{v} \\gg v_{l}$，因此 $\\frac{dp_{\\text{sat}}}{dT} \\approx \\frac{h_{lv}}{T_{\\text{sat}}v_{v}} = \\frac{h_{lv}\\rho_{v}}{T_{\\text{sat}}}$，其中 $\\rho_{v} = 1/v_{v}$。\n- 空腔口部和气泡曲率之间的几何投影关系为 $r_{b} = \\gamma r$，其中 $\\gamma$ 是一个由润湿角和空腔形状决定的无量纲因子，对于所考虑的表面，它被视为一个常数。\n- 表面空腔口部半径的分布（单位面积内）是一个幂律 $n(r) = C r^{-p}$，其中 $r \\in [r_{\\min}, r_{\\max}]$，$C$ 和 $p$ 是反映表面形态的正数常数。\n\n基于这些基础，确定 $N_{s}$ 随 $\\Delta T$ 变化的标度关系，并找出 $N_{s}$ 对 $\\Delta T$ 的幂律依赖关系中出现的指数 $m$。然后，使用一个遵循 Hibiki–Ishii 型 $N_{s}$ 与 $\\Delta T$ 之间幂律关系的抛光铜表面的经验参数，计算当 $K = 1.0 \\times 10^{4}\\,\\mathrm{m^{-2}K^{-m}}$，$m = 1.8$，壁面过热度为 $\\Delta T = 12\\,\\mathrm{K}$ 时的 $N_{s}$ 值。将 $N_{s}$ 以 $\\mathrm{m^{-2}}$ 为单位表示，并将答案四舍五入到三位有效数字。",
            "solution": "这个问题分为两部分。第一部分要求推导形核点密度 $N_{s}$ 相对于壁面过热度 $\\Delta T$ 的标度律。第二部分涉及使用经验提供的关系式对 $N_{s}$ 进行数值计算。\n\n**第一部分：标度律的推导**\n\n表面空腔作为蒸汽形核点的激活是由胚胎气泡的汽液界面上的力平衡决定的。只有当气泡内部的蒸汽压力 $p_{v}$ 足以克服周围液体压力 $p_{l}$ 和表面张力引起的毛细管压力 $p_{cap}$ 时，气泡才能从口部半径为 $r$ 的空腔中生长。在饱和液体中沸腾开始时，液体压力为饱和压力 $p_{sat}$，蒸汽温度假定为壁面温度 $T_w$。因此，激活准则为：\n$$p_{v}(T_{w}) \\ge p_{sat} + p_{cap}$$\n问题提供了必要的关系式。曲率半径为 $r_b$ 的气泡的毛细管压力由杨-拉普拉斯方程给出：\n$$p_{cap} = \\frac{2\\sigma}{r_b}$$\n饱和点附近蒸汽压力对温度的依赖关系由饱和曲线的线性化形式给出：\n$$p_{v}(T_{w}) \\approx p_{sat} + \\left(\\frac{dp_{sat}}{dT}\\right)_{T_{sat}} \\Delta T$$\n其中 $\\Delta T = T_w - T_{sat}$ 是壁面过热度。\n\n将这些代入激活准则：\n$$p_{sat} + \\left(\\frac{dp_{sat}}{dT}\\right)_{T_{sat}} \\Delta T \\ge p_{sat} + \\frac{2\\sigma}{r_b}$$\n这简化为激活给定曲率半径气泡所需的最小过热度条件：\n$$\\left(\\frac{dp_{sat}}{dT}\\right)_{T_{sat}} \\Delta T \\ge \\frac{2\\sigma}{r_b}$$\n问题提供了一个克劳修斯-克拉佩龙关系的简化形式，假设蒸汽的比容 $v_v$ 远大于液体的比容 $v_l$：\n$$\\frac{dp_{sat}}{dT} \\approx \\frac{h_{lv}}{T_{sat}v_{v}} = \\frac{h_{lv}\\rho_{v}}{T_{sat}}$$\n其中 $h_{lv}$ 是汽化潜热，$\\rho_v$ 是蒸汽密度。此外，一个几何因子 $\\gamma$ 将气泡曲率半径 $r_b$ 与空腔口部半径 $r$ 联系起来：\n$$r_b = \\gamma r$$\n将这些表达式代入不等式，得到半径为 $r$ 的空腔被激活的条件：\n$$\\frac{h_{lv}\\rho_{v}}{T_{sat}} \\Delta T \\ge \\frac{2\\sigma}{\\gamma r}$$\n对于给定的过热度 $\\Delta T$，存在一个临界空腔半径 $r_c$，这是可以被激活的空腔的最小半径。这个临界半径可以通过将不等式设为等式来找到：\n$$\\frac{h_{lv}\\rho_{v}}{T_{sat}} \\Delta T = \\frac{2\\sigma}{\\gamma r_c}$$\n求解 $r_c$ 得：\n$$r_c = \\left(\\frac{2\\sigma T_{sat}}{h_{lv}\\rho_{v}\\gamma}\\right) \\frac{1}{\\Delta T}$$\n所有口部半径 $r \\ge r_c$ 的空腔都将成为活化的形核点。单位面积上活化形核点的总数 $N_s$ 是通过将空腔尺寸分布函数 $n(r)$ 从临界半径 $r_c$ 积分到最大可用空腔半径 $r_{max}$ 来得到的。\n$$N_s = \\int_{r_c}^{r_{max}} n(r) \\, dr$$\n问题指定了空腔半径的幂律分布：$n(r) = C r^{-p}$，其中 $r \\in [r_{min}, r_{max}]$，$C$ 和 $p$ 是正数常数。使用此分布进行积分：\n$$N_s = \\int_{r_c}^{r_{max}} C r^{-p} \\, dr$$\n假设 $p \\ne 1$，积分的计算结果为：\n$$N_s = C \\left[ \\frac{r^{1-p}}{1-p} \\right]_{r_c}^{r_{max}} = \\frac{C}{1-p} \\left( r_{max}^{1-p} - r_c^{1-p} \\right)$$\n对于物理上真实的表面，通常会发现指数 $p  1$。在这种情况下，表达式最好写成：\n$$N_s = \\frac{C}{p-1} \\left( r_c^{1-p} - r_{max}^{1-p} \\right)$$\n在典型的核态沸腾条件下，临界半径 $r_c$ 远小于最大空腔半径 $r_{max}$。由于 $p1$，指数 $(1-p)$ 是负数，这意味着项 $r_c^{1-p}$ 远大于 $r_{max}^{1-p}$。因此，忽略 $r_{max}$ 项来找到主导的标度行为是一个有效的近似：\n$$N_s \\approx \\frac{C}{p-1} r_c^{1-p}$$\n现在，我们代入 $r_c$ 对 $\\Delta T$ 的依赖关系：\n$$N_s \\propto (r_c)^{1-p} \\propto \\left( \\frac{1}{\\Delta T} \\right)^{1-p} = (\\Delta T)^{p-1}$$\n因此，形核点密度 $N_s$ 与壁面过热度 $\\Delta T$ 呈幂律关系，$N_s \\propto (\\Delta T)^{p-1}$。问题陈述要求找出依赖关系 $N_s \\propto (\\Delta T)^m$ 中的指数 $m$。通过比较这两种形式，我们确定该指数：\n$$m = p-1$$\n\n**第二部分：数值计算**\n\n问题为抛光铜表面上的 $N_s$ 提供了一个经验关系式，该关系式遵循推导出的幂律形式：\n$$N_s = K (\\Delta T)^m$$\n给定的参数是：\n- $K = 1.0 \\times 10^{4}\\,\\mathrm{m^{-2}K^{-m}}$\n- $m = 1.8$\n- $\\Delta T = 12\\,\\mathrm{K}$\n\n我们将这些值代入方程中计算形核点密度 $N_s$：\n$$N_s = (1.0 \\times 10^{4}) \\times (12)^{1.8}$$\n首先，我们计算 $(12)^{1.8}$ 项：\n$$(12)^{1.8} \\approx 87.57351$$\n现在，我们将其乘以常数 $K$：\n$$N_s = (1.0 \\times 10^{4}) \\times 87.57351 = 87573.51$$\n问题要求答案以 $\\mathrm{m^{-2}}$ 为单位表示，并四舍五入到三位有效数字。\n$$N_s \\approx 87600 \\, \\mathrm{m^{-2}}$$\n用科学记数法表示为：\n$$N_s = 8.76 \\times 10^4 \\, \\mathrm{m^{-2}}$$\n单位是一致的，因为 $K$ 的单位是 $\\mathrm{m^{-2}K^{-m}}$，$(\\Delta T)^m$ 的单位是 $\\mathrm{K^m}$，它们的乘积单位是 $\\mathrm{m^{-2}}$。",
            "answer": "$$\n\\boxed{8.76 \\times 10^{4}}\n$$"
        },
        {
            "introduction": "像Rohsenow关系式这样的经验关联式是沸腾传热分析的核心工具，但其关键参数（如$C_s$和$m$）依赖于具体的流体-表面组合，必须通过实验数据来确定。这项高级计算练习将引导您应用一种强大的现代方法——贝叶斯推断——从合成的实验数据中估计这些模型参数。它弥合了理论模型与数据驱动的工程实践之间的鸿沟，是计算热工领域的一项重要技能 。",
            "id": "3972409",
            "problem": "您的任务是为一个广泛使用的池沸腾经验关联式——Rohsenow 关联式，实现一个贝叶斯参数估计程序。该关联式将沸腾热通量建模为壁面过热度和流体-表面参数的函数。具体来说，对于大气压下水的饱和池沸腾，Rohsenow 关联式可以写成以下形式：\n$$\nq''(\\Delta T; C_s, m) \\;=\\; \\mu_\\ell \\, h_{fg} \\, \\left(\\frac{g\\,(\\rho_\\ell - \\rho_v)}{\\sigma}\\right)^{1/2} \\left( \\frac{\\Delta T}{C_s \\, c_p \\, \\mathrm{Pr}^{\\,m}} \\right)^{3},\n$$\n其中，$q''$ 是热通量，单位为 $\\mathrm{W}\\,\\mathrm{m}^{-2}$；$\\Delta T = T_w - T_{\\mathrm{sat}}$ 是壁面过热度，单位为 $\\mathrm{K}$；$C_s$ 是一个无量纲的表面-流体经验参数；$m$ 是一个无量纲的经验指数；$\\mu_\\ell$ 是液体动力粘度，单位为 $\\mathrm{Pa}\\cdot\\mathrm{s}$；$h_{fg}$ 是汽化潜热，单位为 $\\mathrm{J}\\,\\mathrm{kg}^{-1}$；$g$ 是重力加速度，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-2}$；$\\rho_\\ell$ 和 $\\rho_v$ 分别是液体和蒸汽的密度，单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$；$\\sigma$ 是表面张力，单位为 $\\mathrm{N}\\,\\mathrm{m}^{-1}$；$c_p$ 是液体比热容，单位为 $\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$；$\\mathrm{Pr}$ 是液体普朗特数（无量纲）。\n\n您将假设 $q''$ 的测量值受到加性高斯噪声的影响，即\n$$\ny_i \\;=\\; q''(\\Delta T_i; C_s, m) \\;+\\; \\varepsilon_i,\\quad \\varepsilon_i \\sim \\mathcal{N}(0,\\sigma_n^2),\n$$\n其中噪声是独立同分布的，且已知标准差为 $\\sigma_n$。在此假设下，对于一个数据集 $\\{(\\Delta T_i, y_i)\\}_{i=1}^{N}$ 的似然函数为\n$$\n\\mathcal{L}(C_s, m \\mid \\{\\Delta T_i, y_i\\}) \\;\\propto\\; \\exp\\!\\left( -\\frac{1}{2\\sigma_n^2} \\sum_{i=1}^{N} \\left[y_i - q''(\\Delta T_i; C_s, m)\\right]^2 \\right).\n$$\n假设 $(C_s,m)$ 在一个有界域上服从均匀先验分布，具体为 $C_s \\in [C_{\\min}, C_{\\max}]$ 和 $m \\in [m_{\\min}, m_{\\max}]$。在此域内，后验分布与似然函数成正比。您的任务是通过将参数空间离散化为一个均匀网格，并在该网格上对后验进行数值积分，来数值近似后验均值估计\n$$\n\\mathbb{E}[C_s \\mid \\text{data}], \\qquad \\mathbb{E}[m \\mid \\text{data}],\n$$\n\n使用以下近似于 $100\\,^\\circ\\mathrm{C}$ 时饱和水的恒定性质（国际单位制 (SI)）：\n- $\\mu_\\ell = 0.000282\\,\\mathrm{Pa}\\cdot\\mathrm{s}$，\n- $h_{fg} = 2.257\\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$，\n- $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，\n- $\\rho_\\ell = 958\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，\n- $\\rho_v = 0.6\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，\n- $\\sigma = 0.0589\\,\\mathrm{N}\\,\\mathrm{m}^{-1}$，\n- $c_p = 4220\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，\n- $\\mathrm{Pr} = 1.75$。\n\n定义常数\n$$\nS \\;=\\; \\mu_\\ell \\, h_{fg} \\, \\left(\\frac{g\\,(\\rho_\\ell - \\rho_v)}{\\sigma}\\right)^{1/2},\n$$\n并将模型重写为\n$$\nq''(\\Delta T; C_s, m) \\;=\\; S \\left( \\frac{\\Delta T}{C_s \\, c_p \\, \\mathrm{Pr}^{\\,m}} \\right)^{3}.\n$$\n\n构建三个汇集数据集来测试您的估计器。对于每个数据集，测量的 $q''$ 值应使用指定的“真实”参数从模型中确定性地生成，合成数据生成过程中不添加噪声，但推断时仍必须在似然函数中使用给定的 $\\sigma_n$。所有的 $\\Delta T$ 值单位必须是 $\\mathrm{K}$，所有的 $q''$ 值单位必须是 $\\mathrm{W}\\,\\mathrm{m}^{-2}$。\n\n- 数据集 A（一般情况）：\n  - $\\Delta T$ 值：$[5, 10, 15, 20, 25]$。\n  - 真实参数：$C_s^{\\mathrm{true}} = 0.002$, $m^{\\mathrm{true}} = 1.2$。\n  - 似然函数的噪声标准差：$\\sigma_n = 2.0\\times 10^{4}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$。\n\n- 数据集 B（低 $\\Delta T$ 边界情况）：\n  - $\\Delta T$ 值：$[1, 2, 3, 4]$。\n  - 真实参数：$C_s^{\\mathrm{true}} = 0.004$, $m^{\\mathrm{true}} = 1.0$。\n  - 似然函数的噪声标准差：$\\sigma_n = 0.5\\times 10^{4}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$。\n\n- 数据集 C（高噪声、稀疏数据情况）：\n  - $\\Delta T$ 值：$[10, 30, 50]$。\n  - 真实参数：$C_s^{\\mathrm{true}} = 0.003$, $m^{\\mathrm{true}} = 1.2$。\n  - 似然函数的噪声标准差：$\\sigma_n = 6.0\\times 10^{4}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$。\n\n对于先验域，使用\n$$\nC_{\\min} = 0.001,\\quad C_{\\max} = 0.010,\\quad m_{\\min} = 0.5,\\quad m_{\\max} = 2.0.\n$$\n在这些区间上，为 $C_s$ 使用至少 $201$ 个点的均匀网格，为 $m$ 使用至少 $301$ 个点的均匀网格。\n\n算法要求：\n- 对于每个数据集，根据指定的真实参数和上述模型精确计算合成的测量 $q''$ 值。\n- 按照规定为数据集构建高斯似然函数。\n- 在给定的边界上假设一个均匀先验，并计算网格上的未归一化后验。\n- 通过在网格上使用后验权重求和，数值近似后验均值 $\\mathbb{E}[C_s]$ 和 $\\mathbb{E}[m]$。使用数值稳定的实现来处理指数（例如，在取指数之前减去最大对数似然）。\n- 报告每个数据集的后验均值，作为无量纲浮点数，四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表中的元素是用方括号括起来的配对，且没有空格。\n- 每个配对按 A、B、C 的顺序对应一个数据集，并包含该数据集的后验均值估计 $[\\,\\mathbb{E}[C_s],\\,\\mathbb{E}[m]\\,]$。\n- 格式示例：$[[0.002000,1.200000],[0.004000,1.000000],[0.003000,1.200000]]$。\n\n解决方案必须是一个完整的、可运行的程序，该程序遵守指定的执行环境和库，并严格按照上述格式输出一行。不应打印任何额外文本。",
            "solution": "该问题要求实现一个贝叶斯参数估计算法，以找出 Rohsenow 池沸腾关联式中参数 $C_s$ 和 $m$ 的后验均值估计。该估计将通过对三个不同的合成数据集的后验分布进行基于网格的数值积分来执行。\n\n### **问题建模**\n\n问题的核心是 Rohsenow 关联式，它将沸腾热通量 $q''$ 建模为壁面过热度 $\\Delta T = T_w - T_{\\mathrm{sat}}$ 的函数。对于此问题，该关联式以简化形式给出：\n$$\nq''(\\Delta T; C_s, m) \\;=\\; S \\left( \\frac{\\Delta T}{C_s \\, c_p \\, \\mathrm{Pr}^{\\,m}} \\right)^{3}\n$$\n其中 $C_s$ 和 $m$ 是待估计的经验参数。常数 $S$ 汇集了流体的物性参数：\n$$\nS \\;=\\; \\mu_\\ell \\, h_{fg} \\, \\left(\\frac{g\\,(\\rho_\\ell - \\rho_v)}{\\sigma}\\right)^{1/2}\n$$\n使用所提供的约 $100\\,^\\circ\\mathrm{C}$ 饱和水的 SI 单位值：\n- $\\mu_\\ell = 0.000282\\,\\mathrm{Pa}\\cdot\\mathrm{s}$\n- $h_{fg} = 2.257\\times 10^{6}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$\n- $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- $\\rho_\\ell = 958\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $\\rho_v = 0.6\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $\\sigma = 0.0589\\,\\mathrm{N}\\,\\mathrm{m}^{-1}$\n- $c_p = 4220\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n- $\\mathrm{Pr} = 1.75$\n\n首先，计算出常数 $S$ 约为 $S \\approx 254250.31 \\, \\mathrm{W}\\cdot\\mathrm{m}^{-2}$。\n\n### **贝叶斯推断框架**\n\n参数 $(C_s, m)$ 的估计是在贝叶斯框架内进行的。令 $\\theta = (C_s, m)$ 代表参数向量， $D = \\{(\\Delta T_i, y_i)\\}_{i=1}^{N}$ 为观测数据。贝叶斯定理指出，给定数据下参数的后验概率分布与似然和先验概率分布的乘积成正比：\n$$\nP(\\theta \\mid D) \\;\\propto\\; \\mathcal{L}(D \\mid \\theta) \\, P(\\theta)\n$$\n- **似然函数, $\\mathcal{L}(D \\mid \\theta)$**: 问题假设测量的热通量值 $y_i$ 受到独立同分布的加性高斯噪声 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma_n^2)$ 的影响。因此，对于给定的参数集 $\\theta$，观测到数据集 $D$ 的似然为：\n$$\n\\mathcal{L}(D \\mid \\theta) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma_n^2}} \\exp\\!\\left( -\\frac{(y_i - q''(\\Delta T_i; \\theta))^2}{2\\sigma_n^2} \\right) \\;\\propto\\; \\exp\\!\\left( -\\frac{1}{2\\sigma_n^2} \\sum_{i=1}^{N} \\left[y_i - q''(\\Delta T_i; \\theta)\\right]^2 \\right)\n$$\n- **先验, $P(\\theta)$**: 假设两个参数在一个指定的矩形域上服从均匀先验分布：$C_s \\in [0.001, 0.010]$ 和 $m \\in [0.5, 2.0]$。这意味着 $P(\\theta)$ 在此域内是一个常数，在此域外为零。\n\n由于先验是均匀的，后验分布在指定的参数界限内与似然函数成正比：\n$$\nP(C_s, m \\mid D) \\;\\propto\\; \\mathcal{L}(C_s, m \\mid D)\n$$\n\n### **通过基于网格的积分进行数值近似**\n\n为了计算后验均值估计 $\\mathbb{E}[C_s \\mid D]$ 和 $\\mathbb{E}[m \\mid D]$，我们必须对后验分布进行积分。由于解析解难以处理，我们采用一种数值方法，即对参数空间进行离散化。\n\n1.  **离散化**：将 $(C_s, m)$ 的连续参数空间离散化为一个均匀的二维网格。设该网格由点 $(C_{s,j}, m_k)$ 组成，其中 $j=1, \\dots, N_{C_s}$ 且 $k=1, \\dots, N_m$。问题规定 $N_{C_s} \\geq 201$ 和 $N_m \\geq 301$。\n\n2.  **后验评估**：对于网格上的每个点 $(C_{s,j}, m_k)$，我们评估一个与后验概率成比例的值。在计算上，处理对数后验更为稳定。对数后验与对数似然成正比：\n    $$\n    \\ln P(C_{s,j}, m_k \\mid D) \\;\\propto\\; -\\frac{1}{2\\sigma_n^2} \\sum_{i=1}^{N} \\left[y_i - q''(\\Delta T_i; C_{s,j}, m_k)\\right]^2\n    $$\n\n3.  **数值稳定性**：直接对对数后验值取指数可能会导致远离最大值的点出现数值下溢（值变为零）。为避免此问题，我们在取指数之前，从所有对数后验值中减去最大对数后验值。令 $\\mathcal{P}_{jk} = \\ln P(C_{s,j}, m_k \\mid D)$ 且 $\\mathcal{P}_{\\max} = \\max_{j,k} \\mathcal{P}_{jk}$。未归一化的后验权重 $W_{jk}$ 计算如下：\n    $$\n    W_{jk} = \\exp(\\mathcal{P}_{jk} - \\mathcal{P}_{\\max})\n    $$\n    这种归一化确保最大权重为 $1$，所有其他权重在 $0$ 和 $1$ 之间，从而防止下溢。\n\n4.  **后验均值计算**：后验分布被近似为网格上的一个离散概率质量函数，其中每个点 $(C_{s,j}, m_k)$ 的概率质量与 $W_{jk}$ 成正比。任何参数（例如 $\\phi(C_s, m)$）的后验均值可通过网格上的加权平均来近似：\n    $$\n    \\mathbb{E}[\\phi \\mid D] \\approx \\frac{\\sum_{j,k} \\phi(C_{s,j}, m_k) W_{jk}}{\\sum_{j,k} W_{jk}}\n    $$\n    对于我们的参数 $C_s$ 和 $m$，估计值为：\n    $$\n    \\mathbb{E}[C_s \\mid D] \\approx \\frac{\\sum_{j=1}^{N_{C_s}} \\sum_{k=1}^{N_m} C_{s,j} \\, W_{jk}}{\\sum_{j',k'} W_{j'k'}} \\qquad \\mathbb{E}[m \\mid D] \\approx \\frac{\\sum_{j=1}^{N_{C_s}} \\sum_{k=1}^{N_m} m_k \\, W_{jk}}{\\sum_{j',k'} W_{j'k'}}\n    $$\n\n### **算法实现**\n\n对于提供的三个数据集中的每一个，整体算法按以下步骤进行：\n\n1.  **合成数据生成**：对于每个数据集，使用提供的真实参数 $(C_s^{\\mathrm{true}}, m^{\\mathrm{true}})$ 和 Rohsenow 模型确定性地生成测量向量 $\\{y_i\\}$。合成数据本身不添加随机噪声。\n2.  **网格构建**：使用 `numpy.meshgrid` 在各自的域上为 $C_s$ 和 $m$ 创建二维网格。\n3.  **对数后验计算**：\n    a. 初始化一个维度为 $(N_m, N_{C_s})$ 的二维数组 `sse_grid` 为零。\n    b. 对于数据集中的每个数据点 $(\\Delta T_i, y_i)$：\n        i. 为网格上所有的 $(C_s, m)$ 点计算预测的热通量 $q''(\\Delta T_i; C_s, m)$。\n        ii. 计算整个网格的平方误差 $(y_i - q'')^2$。\n        iii. 将此平方误差网格加到 `sse_grid` 上。\n    c. 将对数后验网格计算为 `log_posterior_grid = -sse_grid / (2 * \\sigma_n^2)`。\n4.  **后验均值估计**：\n    a. 找到 `log_posterior_grid` 的最大值。\n    b. 通过对 `log_posterior_grid - max(log_posterior_grid)` 取指数来计算数值稳定的后验权重 `posterior_weights`。\n    c. 通过对 `posterior_weights` 求和来计算总权重。\n    d. 计算 $C_s$ 网格的加权和，然后除以总权重得到 $\\mathbb{E}[C_s]$。\n    e. 计算 $m$ 网格的加权和，然后除以总权重得到 $\\mathbb{E}[m]$。\n5.  **输出格式化**：将每个数据集得到的均值估计对格式化为六位小数，并组合成指定的字符串格式。\n\n对所有三个数据集重复此过程以获得最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Bayesian parameter estimation for the Rohsenow correlation\n    using a grid-based numerical integration approach.\n    \"\"\"\n    # Constant properties for saturated water at atmospheric pressure (SI units)\n    MU_L = 0.000282\n    H_FG = 2.257e6\n    G = 9.81\n    RHO_L = 958\n    RHO_V = 0.6\n    SIGMA = 0.0589\n    CP = 4220\n    PR = 1.75\n\n    # Prior domain bounds\n    CS_MIN, CS_MAX = 0.001, 0.010\n    M_MIN, M_MAX = 0.5, 2.0\n\n    # Grid resolution\n    N_CS = 201\n    N_M = 301\n\n    # Test cases setup\n    test_cases = [\n        {\n            'name': 'Dataset A',\n            'delta_t': np.array([5, 10, 15, 20, 25]),\n            'cs_true': 0.002, 'm_true': 1.2,\n            'sigma_n': 2.0e4\n        },\n        {\n            'name': 'Dataset B',\n            'delta_t': np.array([1, 2, 3, 4]),\n            'cs_true': 0.004, 'm_true': 1.0,\n            'sigma_n': 0.5e4\n        },\n        {\n            'name': 'Dataset C',\n            'delta_t': np.array([10, 30, 50]),\n            'cs_true': 0.003, 'm_true': 1.2,\n            'sigma_n': 6.0e4\n        }\n    ]\n\n    # Pre-calculate the constant S\n    S = MU_L * H_FG * np.sqrt((G * (RHO_L - RHO_V)) / SIGMA)\n\n    def rohrenow_q(delta_t, cs, m):\n        \"\"\"\n        Vectorized Rohsenow correlation model.\n        delta_t can be a scalar or a vector.\n        cs and m can be scalars or broadcastable arrays (e.g., from meshgrid).\n        \"\"\"\n        return S * (delta_t / (cs * CP * PR**m))**3\n\n    # Create parameter grids\n    cs_vals = np.linspace(CS_MIN, CS_MAX, N_CS)\n    m_vals = np.linspace(M_MIN, M_MAX, N_M)\n    # CS has shape (N_M, N_CS), M has shape (N_M, N_CS)\n    CS, M = np.meshgrid(cs_vals, m_vals)\n\n    all_results = []\n    for case in test_cases:\n        delta_t_data = case['delta_t']\n        cs_true = case['cs_true']\n        m_true = case['m_true']\n        sigma_n = case['sigma_n']\n\n        # Generate synthetic measurement data (y_i) deterministically\n        y_data = rohrenow_q(delta_t_data, cs_true, m_true)\n\n        # Calculate log-posterior over the grid\n        # We compute the sum of squared errors (SSE) for each grid point\n        sse_grid = np.zeros_like(CS)\n        for i in range(len(delta_t_data)):\n            q_pred_grid = rohrenow_q(delta_t_data[i], CS, M)\n            sse_grid += (y_data[i] - q_pred_grid)**2\n        \n        # Log-posterior is proportional to log-likelihood (uniform prior)\n        log_posterior_grid = -sse_grid / (2 * sigma_n**2)\n\n        # Numerically stable posterior weight calculation\n        log_post_max = np.max(log_posterior_grid)\n        posterior_weights = np.exp(log_posterior_grid - log_post_max)\n        \n        # Calculate posterior means\n        total_weight = np.sum(posterior_weights)\n        \n        # CS and M grids are already broadcastable with posterior_weights\n        expected_cs = np.sum(CS * posterior_weights) / total_weight\n        expected_m = np.sum(M * posterior_weights) / total_weight\n        \n        all_results.append([expected_cs, expected_m])\n\n    # Format the final output string\n    result_strings = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in all_results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}