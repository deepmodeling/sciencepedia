{
    "hands_on_practices": [
        {
            "introduction": "本练习着重于将物理问题转化为计算分析过程中的一个基本步骤：无量纲化。通过缩放变量，我们可以将众多物理参数简化为几个关键的无量纲数群，从而简化分析并使求解更具通用性。我们还将探讨所选数值方案的稳定性，这对于确保模拟不会产生不符合物理规律的发散结果至关重要，这些是设计任何瞬态热学代码模块时都必须考虑的核心问题 。",
            "id": "3937508",
            "problem": "一个厚度为 $L$、具有恒定热物理性质（热导率 $k$、密度 $\\rho$ 和定压比热容 $c_p$）的一维平板仅通过传导进行热交换。其控制方程源于具有恒定性质的连续体的能量守恒和傅里叶定律。该平板具有给定的且不相等的狄利克雷边界条件 $T(0,t)=T_L$ 和 $T(L,t)=T_R$（其中 $T_L \\neq T_R$），以及一个任意有界的初始温度场 $T(x,0)=T_0(x)$。为该平板设计的一个计算热学代码模块，用于在具有 $N$ 个空间区间的均匀网格上求解偏微分方程的无量纲形式，并使用显式的时间前向、空间中心（FTCS）格式在时间上推进。\n\n任务：\n- 从能量守恒和傅里叶定律出发，引入无量纲变量 $x=L\\,\\xi$、$t=(L^2/\\alpha)\\,\\tau$ 和 $T=T_{\\text{ref}}+T_{\\text{scale}}\\,\\theta$（其中 $\\alpha=k/(\\rho c_p)$），并在 $\\xi \\in (0,1)$ 上推导出标准形式的无量纲控制方程 $\\partial \\theta/\\partial \\tau=\\partial^2 \\theta/\\partial \\xi^2$，其中狄利克雷边界条件映射为常数。选择 $T_{\\text{ref}}$ 和 $T_{\\text{scale}}$，使得边界条件变为对所有 $\\tau \\ge 0$ 都有 $\\theta(0,\\tau)=1$ 和 $\\theta(1,\\tau)=0$，并明确指出由此产生的 $\\theta$ 和 $\\tau$。\n- 代码在 $\\xi$ 的均匀网格上使用FTCS格式在时间上推进解，该网格有 $N$ 个区间，因此无量纲网格间距为 $\\Delta \\xi=1/N$。通过傅里叶（冯·诺依曼）分析，从第一性原理推导线性稳定性条件，并以 $L$、$k$、$\\rho$、$c_p$ 和 $N$ 表示最大允许的有量纲时间步长 $\\Delta t_{\\max}$。最终时间步长以秒为单位表示。\n\n您的最终答案必须是 $\\Delta t_{\\max}$ 的单个闭式解析表达式。",
            "solution": "该问题被评估为具有科学依据、提法恰当、客观且规定完整。其前提基于传热学和数值分析的基本原理。任务是计算热工领域的标准推导。因此，该问题被认为是有效的，下面给出完整解答。\n\n按照要求，解答分为两部分。第一部分是控制方程和边界条件的无量纲化。第二部分是数值格式的稳定性分析。\n\n第一部分：无量纲化\n物理过程是一维平板中的热传导。连续体的能量守恒结合傅里叶热传导定律，得到热方程。对于具有恒定热物理性质（热导率 $k$、密度 $\\rho$ 和比热容 $c_p$）的一维区域 $x \\in [0, L]$，其控制方程为：\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} $$\n两边同除以 $\\rho c_p$ 得到包含热扩散率 $\\alpha = k/(\\rho c_p)$ 的标准形式：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\n问题指定了以下无量纲变量：\n$$ x = L\\,\\xi, \\quad t = \\frac{L^2}{\\alpha}\\,\\tau, \\quad T(x,t) = T_{\\text{ref}} + T_{\\text{scale}}\\,\\theta(\\xi,\\tau) $$\n我们使用链式法则来变换偏导数：\n$$ \\frac{\\partial}{\\partial t} = \\frac{\\partial \\tau}{\\partial t} \\frac{\\partial}{\\partial \\tau} = \\left(\\frac{\\alpha}{L^2}\\right) \\frac{\\partial}{\\partial \\tau} $$\n$$ \\frac{\\partial}{\\partial x} = \\frac{\\partial \\xi}{\\partial x} \\frac{\\partial}{\\partial \\xi} = \\left(\\frac{1}{L}\\right) \\frac{\\partial}{\\partial \\xi} \\implies \\frac{\\partial^2}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{L}\\frac{\\partial}{\\partial \\xi}\\right) = \\left(\\frac{1}{L}\\right)^2 \\frac{\\partial^2}{\\partial \\xi^2} = \\frac{1}{L^2} \\frac{\\partial^2}{\\partial \\xi^2} $$\n将这些算子和温度定义代入热方程：\n$$ \\frac{\\partial (T_{\\text{ref}} + T_{\\text{scale}}\\,\\theta)}{\\partial t} = \\alpha \\frac{\\partial^2 (T_{\\text{ref}} + T_{\\text{scale}}\\,\\theta)}{\\partial x^2} $$\n由于 $T_{\\text{ref}}$ 和 $T_{\\text{scale}}$ 是常数，方程简化为：\n$$ T_{\\text{scale}} \\frac{\\partial \\theta}{\\partial t} = \\alpha T_{\\text{scale}} \\frac{\\partial^2 \\theta}{\\partial x^2} $$\n现在，代入变换后的导数：\n$$ T_{\\text{scale}} \\left(\\frac{\\alpha}{L^2}\\right) \\frac{\\partial \\theta}{\\partial \\tau} = \\alpha T_{\\text{scale}} \\left(\\frac{1}{L^2} \\frac{\\partial^2 \\theta}{\\partial \\xi^2}\\right) $$\n假设 $T_{\\text{scale}} \\neq 0$，我们可以将两边同除以 $\\alpha T_{\\text{scale}}/L^2$，得到所要求的标准形式的无量纲热方程：\n$$ \\frac{\\partial \\theta}{\\partial \\tau} = \\frac{\\partial^2 \\theta}{\\partial \\xi^2} $$\n空间域 $x \\in [0, L]$ 映射到 $\\xi \\in [0, 1]$。\n\n接下来，我们变换边界条件。有量纲的边界条件是 $T(0,t)=T_L$ 和 $T(L,t)=T_R$。我们需要选择 $T_{\\text{ref}}$ 和 $T_{\\text{scale}}$，使得无量纲边界条件变为 $\\theta(0,\\tau)=1$ 和 $\\theta(1,\\tau)=0$。\n在 $x=0$ 处（即 $\\xi=0$）：\n$$ T(0,t) = T_L \\implies T_{\\text{ref}} + T_{\\text{scale}}\\,\\theta(0,\\tau) = T_L $$\n目标是 $\\theta(0,\\tau)=1$，代入后得：\n$$ T_{\\text{ref}} + T_{\\text{scale}}(1) = T_L $$\n在 $x=L$ 处（即 $\\xi=1$）：\n$$ T(L,t) = T_R \\implies T_{\\text{ref}} + T_{\\text{scale}}\\,\\theta(1,\\tau) = T_R $$\n目标是 $\\theta(1,\\tau)=0$，代入后得：\n$$ T_{\\text{ref}} + T_{\\text{scale}}(0) = T_R $$\n从第二个方程，我们得到 $T_{\\text{ref}} = T_R$。将此代入第一个方程，得到 $T_R + T_{\\text{scale}} = T_L$，即 $T_{\\text{scale}} = T_L - T_R$。问题说明 $T_L \\neq T_R$，因此 $T_{\\text{scale}} \\neq 0$，符合要求。\n\n无量纲温度 $\\theta$ 和时间 $\\tau$ 的显式形式可以通过重新整理它们的定义得到：\n$$ \\theta(\\xi, \\tau) = \\frac{T(x,t) - T_{\\text{ref}}}{T_{\\text{scale}}} = \\frac{T(L\\xi, \\frac{L^2}{\\alpha}\\tau) - T_R}{T_L - T_R} $$\n$$ \\tau = \\frac{\\alpha t}{L^2} = \\frac{k t}{\\rho c_p L^2} $$\n\n第二部分：稳定性分析\n代码采用时间前向、空间中心（FTCS）差分格式来求解无量纲方程 $\\partial \\theta/\\partial \\tau = \\partial^2 \\theta/\\partial \\xi^2$。设 $\\theta_j^n$ 近似 $\\theta(\\xi_j, \\tau_n)$，其中 $\\xi_j = j \\Delta \\xi$ 且 $\\tau_n = n \\Delta \\tau$。网格有 $N$ 个区间，因此无量纲网格间距为 $\\Delta \\xi = 1/N$。\n\nFTCS离散格式为：\n$$ \\frac{\\theta_j^{n+1} - \\theta_j^n}{\\Delta \\tau} = \\frac{\\theta_{j+1}^n - 2\\theta_j^n + \\theta_{j-1}^n}{(\\Delta \\xi)^2} $$\n整理以求解未来时间步 $\\theta_j^{n+1}$：\n$$ \\theta_j^{n+1} = \\theta_j^n + s (\\theta_{j+1}^n - 2\\theta_j^n + \\theta_{j-1}^n) $$\n其中 $s = \\frac{\\Delta \\tau}{(\\Delta \\xi)^2}$ 是常数网格傅里叶数。\n\n对于傅里叶（冯·诺依曼）稳定性分析，我们考虑误差的单个傅里叶模式，表示为 $\\epsilon_j^n = G^n e^{i k_m j \\Delta \\xi}$ 形式的扰动，其中 $k_m$ 是波数，$G$ 是每个时间步的放大因子。为使格式稳定，放大因子的模必须小于或等于1，即 $|G| \\le 1$，对所有可能的波数均成立。将此形式代入有限差分方程（误差也满足该方程）：\n$$ G^{n+1} e^{i k_m j \\Delta \\xi} = G^n e^{i k_m j \\Delta \\xi} + s \\left( G^n e^{i k_m (j+1) \\Delta \\xi} - 2G^n e^{i k_m j \\Delta \\xi} + G^n e^{i k_m (j-1) \\Delta \\xi} \\right) $$\n两边同除以 $G^n e^{i k_m j \\Delta \\xi}$（对于非平凡解）：\n$$ G = 1 + s (e^{i k_m \\Delta \\xi} - 2 + e^{-i k_m \\Delta \\xi}) $$\n使用恒等式 $e^{i\\phi} + e^{-i\\phi} = 2 \\cos(\\phi)$:\n$$ G = 1 + s (2 \\cos(k_m \\Delta \\xi) - 2) = 1 - 2s(1 - \\cos(k_m \\Delta \\xi)) $$\n使用半角恒等式 $1 - \\cos(\\phi) = 2\\sin^2(\\phi/2)$:\n$$ G = 1 - 4s \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right) $$\n放大因子 $G$ 是实数。稳定性条件 $|G| \\le 1$ 转化为 $-1 \\le G \\le 1$。\n上界 $G \\le 1$ 给出：\n$$ 1 - 4s \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right) \\le 1 \\implies -4s \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right) \\le 0 $$\n由于 $s > 0$ 且 $\\sin^2(\\cdot) \\ge 0$，此条件总是满足的。\n下界 $G \\ge -1$ 给出：\n$$ 1 - 4s \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right) \\ge -1 \\implies 2 \\ge 4s \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right) \\implies s \\le \\frac{1}{2 \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right)} $$\n此条件必须对所有波数 $k_m$ 都成立。最严格的条件发生在分母最小时，这对应于 $\\sin^2(\\frac{k_m \\Delta \\xi}{2})$ 取最大值。$\\sin^2(\\cdot)$ 的最大值为 $1$。这发生在网格上可表示的最高频率（最短波长）模式，此时 $k_m \\Delta \\xi = \\pi$。\n因此，稳定性条件变为：\n$$ s \\le \\frac{1}{2} $$\n代入 $s$ 的定义：\n$$ \\frac{\\Delta \\tau}{(\\Delta \\xi)^2} \\le \\frac{1}{2} $$\n最大无量纲时间步长为 $\\Delta \\tau_{\\max} = \\frac{1}{2}(\\Delta \\xi)^2$。\n\n为了找到最大允许的有量纲时间步长 $\\Delta t_{\\max}$，我们转换回有量纲变量。\n我们有 $\\Delta \\tau = \\frac{\\alpha \\Delta t}{L^2}$ 和 $\\Delta \\xi = \\frac{\\Delta x}{L}$。对于长度为 $L$、有 $N$ 个区间的均匀网格，网格间距为 $\\Delta x = L/N$。因此，$\\Delta \\xi = (L/N)/L = 1/N$。\n将这些代入稳定性条件：\n$$ \\frac{\\alpha \\Delta t}{L^2} \\le \\frac{1}{2} \\left(\\frac{1}{N}\\right)^2 $$\n解出 $\\Delta t$:\n$$ \\Delta t \\le \\frac{L^2}{2 \\alpha N^2} $$\n因此，最大允许的有量纲时间步长为：\n$$ \\Delta t_{\\max} = \\frac{L^2}{2 \\alpha N^2} $$\n最后，代入热扩散率的定义 $\\alpha = k/(\\rho c_p)$:\n$$ \\Delta t_{\\max} = \\frac{L^2}{2 N^2} \\frac{1}{\\alpha} = \\frac{L^2}{2 N^2} \\frac{\\rho c_p}{k} $$\n此表达式的单位是秒，符合要求。",
            "answer": "$$\\boxed{\\frac{\\rho c_p L^2}{2 k N^2}}$$"
        },
        {
            "introduction": "现实世界的热问题通常同时涉及传导（扩散）和流体流动（对流）。本练习旨在解决一个架构上的挑战：如何创建一个能够准确处理这两种输运机制的离散化模块。佩克莱数（Péclet number, $Pe$）是一个关键的无量纲数群，它量化了对流与扩散的相对重要性，而选择合适的数值方案——无论是中心差分、迎风格式还是混合方法——都严重依赖于 $Pe$ 的局部值 。这项实践鼓励我们思考模块化和自适应的代码设计，即根据局部流动物理特性动态选择数值方法，以确保计算的准确性和稳定性。",
            "id": "3937444",
            "problem": "您正在为一个通用计算热力学代码设计离散化模块，该代码求解温度的对流-扩散输运方程。显能的控制守恒定律始于傅里叶扩散定律和给定速度场的对流。考虑温度 $T(\\mathbf{x},t)$ 的标量输运方程，其中密度为 $\\rho$，比热容为 $c_p$，热导率为 $k$，速度场为 $\\mathbf{u}(\\mathbf{x},t)$：\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} + \\rho c_p \\,\\mathbf{u}\\cdot\\nabla T = \\nabla\\cdot\\left(k \\nabla T\\right) + S,\n$$\n其中 $S$ 是一个体积源项。设热扩散率为 $\\alpha = k/(\\rho c_p)$。假设速度大小、长度和温度变化分别存在特征尺度 $U$、$L$ 和 $\\Theta$，并且网格为非结构化网格，其特征单元尺寸为 $h_e$，面法向距离为 $\\Delta_f$。\n\n任务：\n- 从上述控制方程和定义出发，对该方程进行无量纲化，以确定衡量对流与扩散比率的无量纲群，并用 $U$、$L$ 和 $\\alpha$ 明确表示该群。然后，用 $|\\mathbf{u}\\cdot\\mathbf{n}|$、$\\Delta_f$ 和 $\\alpha$ 表示一个基于局部面的版本。提供物理释义，说明该群的大小如何意味着对流主导或扩散主导的输运。\n- 利用此释义，论述在模块化代码架构中，离散化模块应如何使用此无量纲群来选择中心差分、迎风格式和稳定的高分辨率格式。您的论述必须明确涉及局部与全局决策、相容性与守恒性，以及各向异性扩散的处理。\n\n以下哪种离散化模块的架构设计正确地表达并使用了这个无量纲群来指导稳定化或迎风格式的选择？选择所有适用的选项。\n\nA. 该模块计算一个基于局部面的比率 $Pe_f = \\dfrac{|\\mathbf{u}\\cdot \\mathbf{n}|\\,\\Delta_f}{\\alpha}$（在有限体积通量表示法中等效于 $Pe_f = \\dfrac{F}{D}$），并使用有界的高分辨率限制器混合通量：对于小的 $|Pe_f|$，它恢复为中心差分；对于大的 $|Pe_f|$，它趋近于迎风格式，平滑过渡由一个关于 $|Pe_f|$ 的单调函数控制。对于有限元公式，它使用一个流线迎风 Petrov–Galerkin (SUPG) 稳定化参数 $\\tau \\sim \\dfrac{h_e}{\\|\\mathbf{u}\\|}\\,\\phi(Pe_e)$，其中 $\\phi(Pe)$ 是一个标准形状函数，如 $\\coth(Pe)-1/Pe$。该实现将格式核心封装在策略接口之后，允许基于 $Pe$ 进行逐面或逐单元的选择，同时保持守恒性和相容性。\n\nB. 该模块使用全局平均速度 $U$ 和区域直径 $L$ 计算一个全域范围内的比率，如果这个全局值超过一个阈值，则将所有面或单元切换到迎风格式；否则，在所有地方都使用中心差分。该选择不随空间或时间变化，并忽略了网格的非均匀性和材料的非均质性。\n\nC. 对于瞬态问题，该模块完全基于库朗数 $Co = U\\,\\Delta t / \\Delta_f$ 来选择格式，理由是只要对流很重要，扩散就可以忽略不计。因此，它忽略任何涉及 $\\alpha$ 的比率，并且只要 $Co$ 很小，就使用中心差分，而不管材料属性如何。\n\nD. 在具有由对称正定张量 $\\mathbf{K}$ 表示的各向异性扩散的介质中，该模块沿局部主方向定义方向相关的比率：$Pe_i = \\dfrac{|\\mathbf{u}\\cdot \\mathbf{e}_i|\\,h_i}{\\alpha_i}$，其中 $\\alpha_i$ 是沿特征向量 $\\mathbf{e}_i$ 的有效扩散率，而 $h_i$ 是来自度量张量的方向性单元长度尺度。当顺流向的值很大时，它应用流线稳定化，同时当侧流向的值为单位量级或更小时，避免不必要的侧风向人工扩散。这种稳定化是基于残差的且是相容的，对于精确解会消失。\n\nE. 为保证单调性，该模块在任何面上对任何非零比率值始终使用一阶迎风格式，并添加与 $\\|\\mathbf{u}\\|\\,h_e$ 成正比的各向同性人工扩散，该扩散不依赖于材料扩散率或比率的大小，从而在所有情况下消除振荡。\n\n答案选项反映了不同的架构和数值设计理念。请选择所有通过无量纲分析证明合理且在通用代码中保持所需数值属性的选项。",
            "solution": "从守恒定律开始，\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} + \\rho c_p \\,\\mathbf{u}\\cdot\\nabla T = \\nabla\\cdot\\left(k \\nabla T\\right) + S,\n$$\n定义热扩散率 $\\alpha = \\dfrac{k}{\\rho c_p}$。引入无量纲变量 $T^* = \\dfrac{T - T_{ref}}{\\Theta}$、$\\mathbf{x}^* = \\dfrac{\\mathbf{x}}{L}$ 和 $t^* = \\dfrac{t}{L/U}$。使用链式法则，$\\nabla = \\dfrac{1}{L}\\nabla^*$ 和 $\\dfrac{\\partial}{\\partial t} = \\dfrac{U}{L}\\dfrac{\\partial}{\\partial t^*}$，并将 $T = T_{ref} + \\Theta T^*$ 代入控制方程（为在比率推导中清晰起见，省略 $S$），我们得到\n$$\n\\rho c_p \\left(\\frac{U}{L}\\Theta \\frac{\\partial T^*}{\\partial t^*} + \\Theta \\mathbf{u}\\cdot \\frac{1}{L}\\nabla^* T^*\\right) = k \\frac{1}{L^2} \\nabla^{*2} (\\Theta T^*).\n$$\n消去公因子并使用 $\\alpha = k/(\\rho c_p)$，得到\n$$\n\\frac{U}{L} \\frac{\\partial T^*}{\\partial t^*} + \\frac{\\mathbf{u}}{U}\\cdot \\nabla^* T^* = \\frac{\\alpha}{U L} \\nabla^{*2} T^*.\n$$\n两边同乘以 $L/U$ 得到\n$$\n\\frac{\\partial T^*}{\\partial t^*} + \\left(\\frac{\\mathbf{u}}{U}\\right)\\cdot \\nabla^* T^* = \\frac{1}{Pe}\\,\\nabla^{*2} T^*,\n$$\n其中无量纲群\n$$\nPe = \\frac{U L}{\\alpha}\n$$\n是佩克莱数（Péclet number），衡量对流与扩散输运速率之比。物理上，$Pe \\ll 1$ 意味着扩散主导的行为，而 $Pe \\gg 1$ 意味着对流主导的行为，伴有陡峭的内部和边界层。\n\n对于离散的非结构化网格，一个自然的基于局部面的形式是在一个具有单位外法向量 $\\mathbf{n}$ 和质心间距 $\\Delta_f$ 的面 $f$ 上比较对流通量和扩散热通量的大小。在有限体积表示法中，对流通量大小为 $F_f = \\rho c_p |\\mathbf{u}\\cdot \\mathbf{n}| A_f$，扩散传导系数为 $D_f = k A_f/\\Delta_f$，因此它们的比率简化为\n$$\nPe_f = \\frac{F_f}{D_f} = \\frac{\\rho c_p |\\mathbf{u}\\cdot \\mathbf{n}| A_f}{k A_f/\\Delta_f} = \\frac{|\\mathbf{u}\\cdot \\mathbf{n}|\\,\\Delta_f}{\\alpha}.\n$$\n类似地，单元形式为 $Pe_e = \\dfrac{\\|\\mathbf{u}\\|\\,h_e}{\\alpha}$，其中 $h_e$ 是一个合适的单元度量长度。这些定义中单位量级的常数可能因不同的离散化方法而异，但物理释义保持不变：小的 $Pe$ 表示扩散主导的输运，适合使用中心差分；而大的 $Pe$ 表示对流占主导，需要迎风或稳定化处理以避免非物理振荡并控制数值扩散。\n\n对代码架构中离散化选择的影响：\n- 局部与全局：因为 $\\mathbf{u}$、$\\alpha$ 和网格间距在空间和时间上变化，所以 $Pe$ 应该在局部（每个面或每个单元）进行评估。一个全局阈值会忽略非均质性，并导致次优或不稳定的选择。\n- 相容性与守恒性：稳定化应该是相容的（对于精确解会消失）并且应在离散平衡中保持守恒性。策略包括带通量限制器的有界高分辨率有限体积格式，以及有限元中的基于残差的 Petrov-Galerkin 稳定化方法。\n- 各向异性与方向性：对于各向异性扩散，相关的比较是方向性的。当顺流向的 $Pe$ 较大时，应沿流动方向应用流线稳定化，同时在侧流向扩散仍然有效时，避免不必要的侧风向人工扩散。\n\n逐项分析：\n\nA. 该选项在局部计算 $Pe_f = \\dfrac{|\\mathbf{u}\\cdot \\mathbf{n}|\\,\\Delta_f}{\\alpha}$，并用它来通过一个有界限制器在中心差分和迎风格式之间进行混合。这与从第一性原理推导出的基于面的比率相匹配，并能逐面自适应。提及流线迎风 Petrov-Galerkin (SUPG) 稳定化参数 $\\tau \\sim \\dfrac{h_e}{\\|\\mathbf{u}\\|}\\,\\phi(Pe_e)$，其形状函数如 $\\phi(Pe) = \\coth(Pe)-1/Pe$，反映了依赖于 $Pe$ 的标准基于残差的相容稳定化方法。将格式核心封装在策略接口之后，并允许逐面或逐单元选择，保持了模块化和守恒性。结论：正确。\n\nB. 基于全域平均 $U$ 和单一 $L$ 的单个全局比率忽略了局部网格间距、局部速度和材料变化；它也妨碍了当 $Pe$ 变化剧烈时至关重要的空间自适应选择。这不能由局部的无量纲分析来证明其合理性，是一个糟糕的架构选择。结论：不正确。\n\nC. 库朗数 $Co = U\\,\\Delta t / \\Delta_f$ 控制显式时间步进的稳定性和时间精度，但它不衡量对流与扩散的比率。忽略 $\\alpha$ 抛弃了扩散物理，并错误地指导了空间格式的选择。即使对于瞬态问题，空间稳定化也应基于 $Pe$，而不仅仅是 $Co$。结论：不正确。\n\nD. 对于各向异性扩散张量 $\\mathbf{K}$，使用局部特征向量 $\\mathbf{e}_i$ 和方向性长度尺度 $h_i$ 定义方向相关的比率 $Pe_i = \\dfrac{|\\mathbf{u}\\cdot \\mathbf{e}_i|\\,h_i}{\\alpha_i}$ 与第一性原理是一致的。当顺流向的值很大时应用流线稳定化，同时当侧流向的值为单位量级或更小时抑制不必要的侧风向人工扩散，在物理上和数值上都是合理的。基于残差的、相容的稳定化方法对于精确解会消失，这是合适的并且能保持精度。结论：正确。\n\nE. 对任何非零比率值始终使用一阶迎风格式，并添加与 $\\alpha$ 和比率大小无关的各向同性人工扩散，这在扩散主导区域牺牲了精度，并通过引入过度的、与物理无关的耗散而违反了相容性。这种设计不能由无量纲分析来证明其合理性。结论：不正确。\n\n因此，正确的选项是 A 和 D。",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "计算代码编写完成后，我们如何确定它是正确的？本练习介绍了“人造解法”（Method of Manufactured Solutions, MMS），这是一种功能强大且严谨的代码验证技术。MMS 的工作原理是，首先假设一个我们期望的温度场解析解，然后反向推导出要使该解成立所必须施加在控制方程中的源项 。通过使用这个源项运行代码，并将数值结果与已知解析解进行比较，我们可以精确地测量代码的准确性和收敛阶，这是开发可靠和稳健的科学软件所必需的。",
            "id": "3937495",
            "problem": "一个求解瞬态热传导的计算热学代码被组织为几个模块：几何离散化、场与材料数据库、物理算子组装、边界条件管理和求解器编排。物理内核根据能量守恒和傅里叶定律来推进温度场的演化。从局部能量守恒和傅里叶定律出发，推导在“人工解方法”（Method of Manufactured Solutions, MMS）下为进行验证所必须注入的体积源项。\n\n从以下基本原理开始：\n- 微分控制体的能量守恒：显能的变化率等于传导热通量的散度加上体积生热。\n- 各向同性传导的傅里叶定律：传导热通量为 $-\\;k(\\mathbf{x})\\,\\nabla T(\\mathbf{x},t)$。\n\n考虑一个三维域，坐标为 $\\mathbf{x} = (x,y,z)$，具有恒定的密度 $\\rho$ 和恒定的比热容 $c_p$，以及一个空间变化但各向同性的导热系数 $k(\\mathbf{x})$，其定义为 $k(x,y,z) = k_0\\,\\exp(\\eta x)\\,(1+\\zeta z^2)$，其中 $k_0 > 0$，$\\eta$ 是任意实常数，且 $\\zeta \\ge 0$。对于MMS，选择人工解析温度场\n$$\nT(x,y,z,t) = \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr),\n$$\n其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是正常数。该架构的边界条件模块将通过把 $T(\\mathbf{x},t)$ 限制在边界上来设置狄利克雷数据，而物理算子组装模块必须计算一个与此 $T$ 和 $k$ 一致的源项。\n\n仅使用上述基本原理，推导体积热源项 $Q(x,y,z,t)$ 的闭式解析表达式，该表达式使人工解 $T$ 满足瞬态传导方程。用国际单位制（SI）中的瓦特每立方米（watts per cubic meter）表示 $Q$。不要进行任何数值计算或四舍五入。以单个闭式表达式的形式提供最终的 $Q(x,y,z,t)$。",
            "solution": "目标是推导体积热源项 $Q(x,y,z,t)$，该源项需满足瞬态热传导方程，其中温度场 $T(x,y,z,t)$ 为指定的人工解，导热系数 $k(\\mathbf{x})$ 为空间变量。\n\n瞬态热传导的控制方程源于能量守恒原理。微分控制体中显能的变化率由 $\\rho c_p \\frac{\\partial T}{\\partial t}$ 给出，其中 $\\rho$ 是密度， $c_p$ 是比热容。这必须与传入控制体的净传导热率相平衡，后者由热通量的负散度 $-\\nabla \\cdot \\mathbf{q}$ 加上任何体积生热 $Q$ 给出。\n因此，能量守恒方程为：\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = -\\nabla \\cdot \\mathbf{q} + Q $$\n对于各向同性介质，傅里叶定律指出热通量 $\\mathbf{q}$ 与负温度梯度成正比：\n$$ \\mathbf{q} = -k(\\mathbf{x}) \\nabla T(\\mathbf{x}, t) $$\n将傅里叶定律代入能量守恒方程，得到一般的瞬态热传导方程：\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = \\nabla \\cdot \\left( k(\\mathbf{x}) \\nabla T(\\mathbf{x}, t) \\right) + Q(x,y,z,t) $$\n为了找到与人工解一致的源项 $Q$，我们重排这个方程：\n$$ Q(x,y,z,t) = \\rho c_p \\frac{\\partial T}{\\partial t} - \\nabla \\cdot \\left( k \\nabla T \\right) $$\n\n问题提供了以下函数和常数：\n-   人工温度场：$T(x,y,z,t) = \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr)$\n-   空间变化的导热系数：$k(x,y,z) = k_0\\,\\exp(\\eta x)\\,(1+\\zeta z^2)$\n-   常数：$\\rho$, $c_p$, $\\alpha$, $\\beta$, $\\gamma$, $k_0$, $\\eta$, $\\zeta$。\n\n我们将分别计算 $Q$ 表达式中的每一项。\n\n首先，我们计算时间导数项 $\\rho c_p \\frac{\\partial T}{\\partial t}$：\n$$ \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) \\right] = \\alpha \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) = \\alpha T $$\n因此，$Q$ 的第一项是：\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = \\rho c_p \\alpha \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) $$\n\n接下来，我们计算散度项 $\\nabla \\cdot (k \\nabla T)$。我们可以使用矢量微积分恒等式 $\\nabla \\cdot (\\phi \\mathbf{F}) = (\\nabla \\phi) \\cdot \\mathbf{F} + \\phi (\\nabla \\cdot \\mathbf{F})$ 来展开此项。这里，$\\phi = k$ 且 $\\mathbf{F} = \\nabla T$。\n$$ \\nabla \\cdot (k \\nabla T) = (\\nabla k) \\cdot (\\nabla T) + k \\nabla^2 T $$\n我们将计算分量 $\\nabla T$、$\\nabla^2 T$ 和 $\\nabla k$。\n\n温度的梯度 $\\nabla T = \\left( \\frac{\\partial T}{\\partial x}, \\frac{\\partial T}{\\partial y}, \\frac{\\partial T}{\\partial z} \\right)$：\n$$ \\frac{\\partial T}{\\partial x} = \\beta \\exp(\\alpha t)\\,\\cos(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) $$\n$$ \\frac{\\partial T}{\\partial y} = -\\gamma \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\sin(\\gamma y)\\,\\bigl(1+z^2\\bigr) $$\n$$ \\frac{\\partial T}{\\partial z} = 2z \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y) $$\n\n温度的拉普拉斯算子 $\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} + \\frac{\\partial^2 T}{\\partial z^2}$：\n$$ \\frac{\\partial^2 T}{\\partial x^2} = -\\beta^2 \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) = -\\beta^2 T $$\n$$ \\frac{\\partial^2 T}{\\partial y^2} = -\\gamma^2 \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) = -\\gamma^2 T $$\n$$ \\frac{\\partial^2 T}{\\partial z^2} = \\frac{\\partial}{\\partial z} \\left( 2z \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y) \\right) = 2 \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y) = \\frac{2}{1+z^2}T $$\n将这些合并得到：\n$$ \\nabla^2 T = T \\left(-\\beta^2 - \\gamma^2 + \\frac{2}{1+z^2}\\right) $$\n所以，项 $k \\nabla^2 T$ 是：\n$$ k \\nabla^2 T = k_0 \\exp(\\eta x) (1+\\zeta z^2) \\left[ \\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y)(1+z^2) \\right] \\left(-\\beta^2 - \\gamma^2 + \\frac{2}{1+z^2}\\right) $$\n$$ k \\nabla^2 T = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\sin(\\beta x) \\cos(\\gamma y) \\left[ -(\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) + 2(1+\\zeta z^2) \\right] $$\n\n导热系数的梯度 $\\nabla k = \\left( \\frac{\\partial k}{\\partial x}, \\frac{\\partial k}{\\partial y}, \\frac{\\partial k}{\\partial z} \\right)$：\n$$ \\frac{\\partial k}{\\partial x} = \\eta \\, k_0 \\exp(\\eta x) (1+\\zeta z^2) = \\eta k $$\n$$ \\frac{\\partial k}{\\partial y} = 0 $$\n$$ \\frac{\\partial k}{\\partial z} = k_0 \\exp(\\eta x) (2\\zeta z) = k \\frac{2\\zeta z}{1+\\zeta z^2} $$\n\n现在，我们计算点积 $(\\nabla k) \\cdot (\\nabla T)$：\n$$ (\\nabla k) \\cdot (\\nabla T) = \\frac{\\partial k}{\\partial x}\\frac{\\partial T}{\\partial x} + \\frac{\\partial k}{\\partial y}\\frac{\\partial T}{\\partial y} + \\frac{\\partial k}{\\partial z}\\frac{\\partial T}{\\partial z} $$\n$$ (\\nabla k) \\cdot (\\nabla T) = (\\eta k)(\\beta \\exp(\\alpha t)\\cos(\\beta x)\\cos(\\gamma y)(1+z^2)) + (0) + \\left(k \\frac{2\\zeta z}{1+\\zeta z^2}\\right)(2z \\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y)) $$\n代入 $k = k_0 \\exp(\\eta x)(1+\\zeta z^2)$：\n$$ (\\nabla k) \\cdot (\\nabla T) = \\eta \\beta k_0 \\exp(\\eta x)(1+\\zeta z^2) \\exp(\\alpha t)\\cos(\\beta x)\\cos(\\gamma y)(1+z^2) + 4\\zeta z^2 k_0 \\exp(\\eta x)\\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y) $$\n\n我们组装散度项 $\\nabla \\cdot(k \\nabla T) = (\\nabla k) \\cdot (\\nabla T) + k \\nabla^2 T$。合并表达式并提取公因式 $k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y)$：\n$$ \\nabla \\cdot(k \\nabla T) = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\eta \\beta \\cos(\\beta x)(1+z^2)(1+\\zeta z^2) + 4\\zeta z^2 \\sin(\\beta x) - \\sin(\\beta x)(\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) + 2\\sin(\\beta x)(1+\\zeta z^2) \\bigg] $$\n$$ \\nabla \\cdot(k \\nabla T) = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\eta \\beta \\cos(\\beta x)(1+z^2)(1+\\zeta z^2) + \\sin(\\beta x) \\left( -(\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) + 2(1+\\zeta z^2) + 4\\zeta z^2 \\right) \\bigg] $$\n简化 $\\sin(\\beta x)$ 的括号中的项：$2(1+\\zeta z^2) + 4\\zeta z^2 = 2 + 2\\zeta z^2 + 4\\zeta z^2 = 2+6\\zeta z^2 = 2(1+3\\zeta z^2)$。\n$$ \\nabla \\cdot(k \\nabla T) = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\eta \\beta (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) + \\left( 2(1+3\\zeta z^2) - (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) \\right) \\sin(\\beta x) \\bigg] $$\n\n最后，我们将两个主要分量代入 $Q$ 的表达式中：\n$$ Q = \\rho c_p \\frac{\\partial T}{\\partial t} - \\nabla \\cdot (k \\nabla T) $$\n$$ Q = \\rho c_p \\alpha \\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y)(1+z^2) - k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\dots \\bigg] $$\n提取公因式 $\\exp(\\alpha t)\\cos(\\gamma y)$ 并按 $\\sin(\\beta x)$ 和 $\\cos(\\beta x)$ 对项进行分组：\n$$ Q = \\exp(\\alpha t)\\cos(\\gamma y) \\bigg[ \\rho c_p \\alpha (1+z^2) \\sin(\\beta x) - k_0 \\exp(\\eta x) \\left( \\eta \\beta (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) + \\left( 2(1+3\\zeta z^2) - (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) \\right) \\sin(\\beta x) \\right) \\bigg] $$\n分配负号并合并各项：\n$$ Q(x,y,z,t) = \\exp(\\alpha t)\\cos(\\gamma y) \\bigg[ \\sin(\\beta x) \\left\\{ \\rho c_p \\alpha (1+z^2) + k_0 \\exp(\\eta x) \\left[ (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) - 2(1+3\\zeta z^2) \\right] \\right\\} - k_0 \\beta \\eta \\exp(\\eta x) (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) \\bigg] $$\n这就是体积源项的最终闭式表达式。",
            "answer": "$$\n\\boxed{\n\\exp(\\alpha t)\\cos(\\gamma y) \\left[ \\sin(\\beta x) \\left\\{ \\rho c_p \\alpha (1+z^2) + k_0 \\exp(\\eta x) \\left[ (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) - 2(1+3\\zeta z^2) \\right] \\right\\} - k_0 \\beta \\eta \\exp(\\eta x) (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) \\right]\n}\n$$"
        }
    ]
}