{
    "hands_on_practices": [
        {
            "introduction": "Before a computational code can be used for scientific discovery, we must rigorously verify that it correctly solves the mathematical equations it is designed to model. The Method of Manufactured Solutions (MMS) is a powerful and general technique for code verification, where a known analytic solution is \"manufactured\" and substituted into the governing equations to derive a corresponding source term. This exercise  walks you through this fundamental process, a critical step in building a trustworthy simulation tool and its verification architecture.",
            "id": "3937495",
            "problem": "A computational thermal code solving transient conduction is organized into modules for geometry-discretization, field and material database, physics-operator assembly, boundary-condition management, and solver orchestration. The physics kernel advances the temperature field based on conservation of energy and Fourier’s law. Starting from the local conservation of energy and Fourier’s law, derive the volumetric source term that must be injected for verification under the Method of Manufactured Solutions (MMS).\n\nBegin from the following fundamental base:\n- Conservation of energy for a differential control volume: the rate of change of sensible energy equals the divergence of conductive heat flux plus volumetric heat generation.\n- Fourier’s law for isotropic conduction: the conductive heat flux is $-\\;k(\\mathbf{x})\\,\\nabla T(\\mathbf{x},t)$.\n\nConsider a three-dimensional domain with coordinates $\\mathbf{x} = (x,y,z)$, constant density $\\rho$ and constant specific heat capacity $c_p$, and a spatially varying but isotropic thermal conductivity $k(\\mathbf{x})$ defined by $k(x,y,z) = k_0\\,\\exp(\\eta x)\\,(1+\\zeta z^2)$, where $k_0 > 0$, $\\eta$ is any real constant, and $\\zeta \\ge 0$. For MMS, choose the manufactured analytic temperature field\n$$\nT(x,y,z,t) = \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr),\n$$\nwhere $\\alpha$, $\\beta$, and $\\gamma$ are positive constants. The architecture’s boundary-condition module would set Dirichlet data by restricting $T(\\mathbf{x},t)$ to the boundary, and the physics-operator assembly must compute a source term consistent with this $T$ and $k$.\n\nUsing only the fundamental base above, derive a closed-form analytic expression for the volumetric heat source term $Q(x,y,z,t)$ that makes the manufactured $T$ satisfy the transient conduction equation. Express $Q$ in base International System of Units (SI) as watts per cubic meter. Do not perform any numerical evaluation or rounding. Provide the final $Q(x,y,z,t)$ as a single closed-form expression.",
            "solution": "The objective is to derive the volumetric heat source term, $Q(x,y,z,t)$, required to satisfy the transient heat conduction equation for a specified manufactured temperature field $T(x,y,z,t)$ and a spatially varying thermal conductivity $k(\\mathbf{x})$.\n\nThe governing equation for transient heat conduction is derived from the principle of conservation of energy. The rate of change of sensible energy in a differential control volume is given by $\\rho c_p \\frac{\\partial T}{\\partial t}$, where $\\rho$ is the density and $c_p$ is the specific heat capacity. This must be balanced by the net rate of heat conducted into the volume, which is given by the negative divergence of the heat flux, $-\\nabla \\cdot \\mathbf{q}$, plus any volumetric heat generation, $Q$.\nThe energy conservation equation is thus:\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = -\\nabla \\cdot \\mathbf{q} + Q $$\nFourier's law for an isotropic medium states that the heat flux $\\mathbf{q}$ is proportional to the negative temperature gradient:\n$$ \\mathbf{q} = -k(\\mathbf{x}) \\nabla T(\\mathbf{x}, t) $$\nSubstituting Fourier's law into the energy conservation equation gives the general transient heat conduction equation:\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = \\nabla \\cdot \\left( k(\\mathbf{x}) \\nabla T(\\mathbf{x}, t) \\right) + Q(x,y,z,t) $$\nTo find the source term $Q$ that is consistent with the manufactured solution, we rearrange this equation:\n$$ Q(x,y,z,t) = \\rho c_p \\frac{\\partial T}{\\partial t} - \\nabla \\cdot \\left( k \\nabla T \\right) $$\n\nThe problem provides the following functions and constants:\n-   Manufactured temperature field: $T(x,y,z,t) = \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr)$\n-   Spatially varying thermal conductivity: $k(x,y,z) = k_0\\,\\exp(\\eta x)\\,(1+\\zeta z^2)$\n-   Constants: $\\rho$, $c_p$, $\\alpha$, $\\beta$, $\\gamma$, $k_0$, $\\eta$, $\\zeta$.\n\nWe will compute each term in the expression for $Q$ separately.\n\nFirst, we compute the time-derivative term, $\\rho c_p \\frac{\\partial T}{\\partial t}$:\n$$ \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) \\right] = \\alpha \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) = \\alpha T $$\nTherefore, the first term for $Q$ is:\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = \\rho c_p \\alpha \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) $$\n\nNext, we compute the divergence term, $\\nabla \\cdot (k \\nabla T)$. We can expand this term using the vector calculus identity $\\nabla \\cdot (\\phi \\mathbf{F}) = (\\nabla \\phi) \\cdot \\mathbf{F} + \\phi (\\nabla \\cdot \\mathbf{F})$. Here, $\\phi = k$ and $\\mathbf{F} = \\nabla T$.\n$$ \\nabla \\cdot (k \\nabla T) = (\\nabla k) \\cdot (\\nabla T) + k \\nabla^2 T $$\nWe will compute the components $\\nabla T$, $\\nabla^2 T$, and $\\nabla k$.\n\nThe gradient of the temperature, $\\nabla T = \\left( \\frac{\\partial T}{\\partial x}, \\frac{\\partial T}{\\partial y}, \\frac{\\partial T}{\\partial z} \\right)$:\n$$ \\frac{\\partial T}{\\partial x} = \\beta \\exp(\\alpha t)\\,\\cos(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) $$\n$$ \\frac{\\partial T}{\\partial y} = -\\gamma \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\sin(\\gamma y)\\,\\bigl(1+z^2\\bigr) $$\n$$ \\frac{\\partial T}{\\partial z} = 2z \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y) $$\n\nThe Laplacian of the temperature, $\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} + \\frac{\\partial^2 T}{\\partial z^2}$:\n$$ \\frac{\\partial^2 T}{\\partial x^2} = -\\beta^2 \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) = -\\beta^2 T $$\n$$ \\frac{\\partial^2 T}{\\partial y^2} = -\\gamma^2 \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) = -\\gamma^2 T $$\n$$ \\frac{\\partial^2 T}{\\partial z^2} = \\frac{\\partial}{\\partial z} \\left( 2z \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y) \\right) = 2 \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y) = \\frac{2}{1+z^2}T $$\nCombining these gives:\n$$ \\nabla^2 T = T \\left(-\\beta^2 - \\gamma^2 + \\frac{2}{1+z^2}\\right) $$\nSo, the term $k \\nabla^2 T$ is:\n$$ k \\nabla^2 T = k_0 \\exp(\\eta x) (1+\\zeta z^2) \\left[ \\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y)(1+z^2) \\right] \\left(-\\beta^2 - \\gamma^2 + \\frac{2}{1+z^2}\\right) $$\n$$ k \\nabla^2 T = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\sin(\\beta x) \\cos(\\gamma y) \\left[ -(\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) + 2(1+\\zeta z^2) \\right] $$\n\nThe gradient of the thermal conductivity, $\\nabla k = \\left( \\frac{\\partial k}{\\partial x}, \\frac{\\partial k}{\\partial y}, \\frac{\\partial k}{\\partial z} \\right)$:\n$$ \\frac{\\partial k}{\\partial x} = \\eta \\, k_0 \\exp(\\eta x) (1+\\zeta z^2) = \\eta k $$\n$$ \\frac{\\partial k}{\\partial y} = 0 $$\n$$ \\frac{\\partial k}{\\partial z} = k_0 \\exp(\\eta x) (2\\zeta z) = k \\frac{2\\zeta z}{1+\\zeta z^2} $$\n\nNow, we compute the dot product $(\\nabla k) \\cdot (\\nabla T)$:\n$$ (\\nabla k) \\cdot (\\nabla T) = \\frac{\\partial k}{\\partial x}\\frac{\\partial T}{\\partial x} + \\frac{\\partial k}{\\partial y}\\frac{\\partial T}{\\partial y} + \\frac{\\partial k}{\\partial z}\\frac{\\partial T}{\\partial z} $$\n$$ (\\nabla k) \\cdot (\\nabla T) = (\\eta k)(\\beta \\exp(\\alpha t)\\cos(\\beta x)\\cos(\\gamma y)(1+z^2)) + (0) + \\left(k \\frac{2\\zeta z}{1+\\zeta z^2}\\right)(2z \\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y)) $$\nSubstituting $k = k_0 \\exp(\\eta x)(1+\\zeta z^2)$:\n$$ (\\nabla k) \\cdot (\\nabla T) = \\eta \\beta k_0 \\exp(\\eta x)(1+\\zeta z^2) \\exp(\\alpha t)\\cos(\\beta x)\\cos(\\gamma y)(1+z^2) + 4\\zeta z^2 k_0 \\exp(\\eta x)\\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y) $$\n\nWe assemble the divergence term $\\nabla \\cdot(k \\nabla T) = (\\nabla k) \\cdot (\\nabla T) + k \\nabla^2 T$. Combining the expressions and factoring out common terms $k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y)$:\n$$ \\nabla \\cdot(k \\nabla T) = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\eta \\beta \\cos(\\beta x)(1+z^2)(1+\\zeta z^2) + 4\\zeta z^2 \\sin(\\beta x) - \\sin(\\beta x)(\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) + 2\\sin(\\beta x)(1+\\zeta z^2) \\bigg] $$\n$$ \\nabla \\cdot(k \\nabla T) = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\eta \\beta \\cos(\\beta x)(1+z^2)(1+\\zeta z^2) + \\sin(\\beta x) \\left( -(\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) + 2(1+\\zeta z^2) + 4\\zeta z^2 \\right) \\bigg] $$\nSimplifying the term in parentheses for $\\sin(\\beta x)$: $2 + 2\\zeta z^2 + 4\\zeta z^2 = 2+6\\zeta z^2=2(1+3\\zeta z^2)$.\n$$ \\nabla \\cdot(k \\nabla T) = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\eta \\beta (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) + \\left( 2(1+3\\zeta z^2) - (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) \\right) \\sin(\\beta x) \\bigg] $$\n\nFinally, we substitute the two main components into the expression for $Q$:\n$$ Q = \\rho c_p \\frac{\\partial T}{\\partial t} - \\nabla \\cdot (k \\nabla T) $$\n$$ Q = \\rho c_p \\alpha \\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y)(1+z^2) - k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\dots \\bigg] $$\nFactor out the common term $\\exp(\\alpha t)\\cos(\\gamma y)$ and group terms by $\\sin(\\beta x)$ and $\\cos(\\beta x)$:\n$$ Q = \\exp(\\alpha t)\\cos(\\gamma y) \\bigg[ \\rho c_p \\alpha (1+z^2) \\sin(\\beta x) - k_0 \\exp(\\eta x) \\left( \\eta \\beta (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) + \\left( 2(1+3\\zeta z^2) - (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) \\right) \\sin(\\beta x) \\right) \\bigg] $$\nDistributing the negative sign and grouping terms:\n$$ Q(x,y,z,t) = \\exp(\\alpha t)\\cos(\\gamma y) \\bigg[ \\sin(\\beta x) \\left\\{ \\rho c_p \\alpha (1+z^2) + k_0 \\exp(\\eta x) \\left[ (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) - 2(1+3\\zeta z^2) \\right] \\right\\} - k_0 \\beta \\eta \\exp(\\eta x) (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) \\bigg] $$\nThis is the final closed-form expression for the volumetric source term.",
            "answer": "$$\n\\boxed{\n\\exp(\\alpha t)\\cos(\\gamma y) \\left[ \\sin(\\beta x) \\left\\{ \\rho c_p \\alpha (1+z^2) + k_0 \\exp(\\eta x) \\left[ (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) - 2(1+3\\zeta z^2) \\right] \\right\\} - k_0 \\beta \\eta \\exp(\\eta x) (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) \\right]\n}\n$$"
        },
        {
            "introduction": "A robust thermal code must handle diverse physical regimes, particularly the interplay between advection (transport by flow) and diffusion (transport by molecular motion). The dimensionless Péclet number, $Pe$, quantifies the local balance between these two effects, and its magnitude dictates the choice of an appropriate numerical scheme. This practice  challenges you to think like a code architect, exploring how to design an adaptive discretization module that uses $Pe$ to select stable and accurate schemes, avoiding the pitfalls of a one-size-fits-all approach.",
            "id": "3937444",
            "problem": "You are designing the discretization module of a general-purpose computational thermal code that solves an advection–diffusion transport equation for temperature. The governing conservation law for sensible energy starts from Fourier’s law for diffusion and advection by a given velocity field. Consider the scalar transport equation for temperature $T(\\mathbf{x},t)$ with density $\\rho$, specific heat capacity $c_p$, thermal conductivity $k$, and velocity field $\\mathbf{u}(\\mathbf{x},t)$:\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} + \\rho c_p \\,\\mathbf{u}\\cdot\\nabla T = \\nabla\\cdot\\left(k \\nabla T\\right) + S,\n$$\nwhere $S$ is a volumetric source term. Let the thermal diffusivity be $\\alpha = k/(\\rho c_p)$. Assume that characteristic scales $U$, $L$, and $\\Theta$ exist for velocity magnitude, length, and temperature variation, respectively, and that the mesh is unstructured with characteristic element size $h_e$ and face-normal distance $\\Delta_f$.\n\nTask:\n- Starting from the governing equation and the definitions above, nondimensionalize the equation to identify the dimensionless group that measures the ratio of advection to diffusion, and express this group explicitly in terms of $U$, $L$, and $\\alpha$. Then, express a local face-based version in terms of $|\\mathbf{u}\\cdot\\mathbf{n}|$, $\\Delta_f$, and $\\alpha$. Provide physical interpretation of how the magnitude of this group implies advection- or diffusion-dominated transport.\n- Using this interpretation, reason about how a discretization module within a modular code architecture should use this dimensionless group to select between central, upwind, and stabilized high-resolution schemes. Your reasoning must explicitly address local versus global decisions, consistency and conservation, and handling of anisotropic diffusion.\n\nWhich of the following architectural designs for the discretization module correctly expresses and uses this dimensionless group to guide selection of stabilization or upwinding schemes? Select all that apply.\n\nA. The module computes a local face-based ratio $Pe_f = \\dfrac{|\\mathbf{u}\\cdot \\mathbf{n}|\\,\\Delta_f}{\\alpha}$ (equivalently $Pe_f = \\dfrac{F}{D}$ in a finite volume flux notation), and blends fluxes with a bounded high-resolution limiter: for small $|Pe_f|$ it recovers central differencing, and for large $|Pe_f|$ it approaches upwind, with smooth transition governed by a monotone function of $|Pe_f|$. For finite element formulations, it uses a Streamline Upwind Petrov–Galerkin (SUPG) stabilization parameter $\\tau \\sim \\dfrac{h_e}{\\|\\mathbf{u}\\|}\\,\\phi(Pe_e)$ with $\\phi(Pe)$ a standard shape such as $\\coth(Pe)-1/Pe$. The implementation encapsulates scheme kernels behind a strategy interface, allowing per-face or per-element selection based on $Pe$ while preserving conservation and consistency.\n\nB. The module computes a single domain-wide ratio using a global average $U$ and a domain diameter $L$ and switches all faces or elements to upwind if this global value exceeds a threshold; otherwise it uses central differencing everywhere. The choice does not vary in space or time and ignores mesh nonuniformity and material heterogeneity.\n\nC. For transient problems, the module bases the scheme selection entirely on the Courant number $Co = U\\,\\Delta t / \\Delta_f$, arguing that diffusion becomes negligible whenever advection is important. It therefore ignores any ratio involving $\\alpha$ and uses central differencing whenever $Co$ is small, independent of material properties.\n\nD. In media with anisotropic diffusion represented by a symmetric positive definite tensor $\\mathbf{K}$, the module defines direction-dependent ratios along local principal directions: $Pe_i = \\dfrac{|\\mathbf{u}\\cdot \\mathbf{e}_i|\\,h_i}{\\alpha_i}$, where $\\alpha_i$ are effective diffusivities along eigenvectors $\\mathbf{e}_i$ and $h_i$ are directional element length scales from a metric tensor. It applies streamline stabilization when the along-stream value is large while avoiding unnecessary crosswind artificial diffusion when the cross-stream values are order unity or smaller. The stabilization is residual-based and consistent, vanishing for the exact solution.\n\nE. To guarantee monotonicity, the module always uses first-order upwind for any nonzero value of the ratio at any face, and adds isotropic artificial diffusion proportional to $\\|\\mathbf{u}\\|\\,h_e$ that does not depend on material diffusivity or on the ratio’s magnitude, so that oscillations are eliminated in all regimes.\n\nAnswer choices reflect different architectural and numerical design philosophies. Choose all that are justified by the nondimensional analysis and preserve the desired numerical properties in a general-purpose code.",
            "solution": "Starting from the conservation law,\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} + \\rho c_p \\,\\mathbf{u}\\cdot\\nabla T = \\nabla\\cdot\\left(k \\nabla T\\right) + S,\n$$\ndefine thermal diffusivity $\\alpha = \\dfrac{k}{\\rho c_p}$. Introduce nondimensional variables $T^* = \\dfrac{T - T_{ref}}{\\Theta}$, $\\mathbf{x}^* = \\dfrac{\\mathbf{x}}{L}$, and $t^* = \\dfrac{t}{L/U}$. Using the chain rule, $\\nabla = \\dfrac{1}{L}\\nabla^*$ and $\\dfrac{\\partial}{\\partial t} = \\dfrac{U}{L}\\dfrac{\\partial}{\\partial t^*}$, and substituting $T = T_{ref} + \\Theta T^*$ into the governing equation (omitting $S$ for clarity in the ratio derivation), we obtain\n$$\n\\rho c_p \\left(\\frac{U}{L}\\Theta \\frac{\\partial T^*}{\\partial t^*} + \\Theta \\mathbf{u}\\cdot \\frac{1}{L}\\nabla^* T^*\\right) = k \\frac{1}{L^2} \\nabla^{*2} (\\Theta T^*).\n$$\nCanceling common factors and using $\\alpha = k/(\\rho c_p)$ gives\n$$\n\\frac{U}{L} \\frac{\\partial T^*}{\\partial t^*} + \\frac{\\mathbf{u}}{U}\\cdot \\nabla^* T^* = \\frac{\\alpha}{U L} \\nabla^{*2} T^*.\n$$\nMultiplying through by $L/U$ yields\n$$\n\\frac{\\partial T^*}{\\partial t^*} + \\left(\\frac{\\mathbf{u}}{U}\\right)\\cdot \\nabla^* T^* = \\frac{1}{Pe}\\,\\nabla^{*2} T^*,\n$$\nwhere the dimensionless group\n$$\nPe = \\frac{U L}{\\alpha}\n$$\nis the Péclet number, measuring the ratio of advection to diffusion transport rates. Physically, $Pe \\ll 1$ implies diffusion-dominated behavior, while $Pe \\gg 1$ implies advection-dominated behavior with steep internal and boundary layers.\n\nFor a discrete unstructured mesh, a natural local face-based form compares advective to diffusive flux magnitudes at a face $f$ with outward unit normal $\\mathbf{n}$ and centroid-to-centroid distance $\\Delta_f$. In a finite volume notation, the advective flux magnitude is $F_f = \\rho c_p |\\mathbf{u}\\cdot \\mathbf{n}| A_f$ and the diffusive conductance is $D_f = k A_f/\\Delta_f$, so their ratio simplifies to\n$$\nPe_f = \\frac{F_f}{D_f} = \\frac{\\rho c_p |\\mathbf{u}\\cdot \\mathbf{n}| A_f}{k A_f/\\Delta_f} = \\frac{|\\mathbf{u}\\cdot \\mathbf{n}|\\,\\Delta_f}{\\alpha}.\n$$\nAn elementwise form is similarly $Pe_e = \\dfrac{\\|\\mathbf{u}\\|\\,h_e}{\\alpha}$ with $h_e$ an appropriate element metric length. Constants of order unity in these definitions may vary across discretizations, but the physical interpretation remains: small $Pe$ indicates diffusion-dominated transport amenable to central differencing, while large $Pe$ indicates advection dominance that requires upwinding or stabilization to avoid nonphysical oscillations and to control numerical diffusion.\n\nImplications for discretization selection in a code architecture:\n- Local versus global: Because $\\mathbf{u}$, $\\alpha$, and mesh spacings vary in space and time, $Pe$ should be evaluated locally (per face or per element). A global threshold ignores heterogeneity and leads to suboptimal or unstable choices.\n- Consistency and conservation: Stabilization should be consistent (vanishing for the exact solution) and should preserve conservation in the discrete balance. Strategies include bounded high-resolution finite volume schemes with flux limiters and residual-based Petrov–Galerkin stabilizations in finite elements.\n- Anisotropy and directionality: With anisotropic diffusion, the relevant comparison is directional. Streamline stabilization should be applied along the flow direction when the along-stream $Pe$ is large, while avoiding unnecessary crosswind artificial diffusion when cross-stream diffusion remains effective.\n\nOption-by-option analysis:\n\nA. This option computes $Pe_f = \\dfrac{|\\mathbf{u}\\cdot \\mathbf{n}|\\,\\Delta_f}{\\alpha}$ locally and uses it to blend between central and upwind with a bounded limiter. This matches the face-based ratio derived from first principles and adapts per face. The mention of a Streamline Upwind Petrov–Galerkin (SUPG) stabilization parameter $\\tau \\sim \\dfrac{h_e}{\\|\\mathbf{u}\\|}\\,\\phi(Pe_e)$ with a shape like $\\phi(Pe) = \\coth(Pe)-1/Pe$ reflects standard residual-based consistent stabilization that depends on $Pe$. Encapsulating scheme kernels behind a strategy interface and selecting per face or per element preserves modularity and conservation. Verdict: Correct.\n\nB. A single global ratio based on domain-averaged $U$ and a single $L$ ignores local mesh spacing, local velocity, and material variation; it also prevents spatially adaptive selection that is critical when $Pe$ varies strongly. This is not justified by the local nondimensional analysis and is a poor architectural choice. Verdict: Incorrect.\n\nC. The Courant number $Co = U\\,\\Delta t / \\Delta_f$ controls explicit time-stepping stability and temporal accuracy, but it does not measure the ratio of advection to diffusion. Ignoring $\\alpha$ discards the diffusion physics and misguides spatial scheme selection. Even for transient problems, spatial stabilization should be based on $Pe$, not solely on $Co$. Verdict: Incorrect.\n\nD. With anisotropic diffusion tensor $\\mathbf{K}$, defining direction-dependent ratios $Pe_i = \\dfrac{|\\mathbf{u}\\cdot \\mathbf{e}_i|\\,h_i}{\\alpha_i}$ using local eigenvectors $\\mathbf{e}_i$ and directional length scales $h_i$ is consistent with first principles. Applying streamline stabilization when along-stream values are large, while restraining crosswind artificial diffusion when cross-stream values are order unity or smaller, is physically and numerically sound. Residual-based, consistent stabilization that vanishes for the exact solution is appropriate and preserves accuracy. Verdict: Correct.\n\nE. Always using first-order upwind for any nonzero value of the ratio and adding isotropic artificial diffusion independent of $\\alpha$ and of the ratio’s magnitude sacrifices accuracy in diffusion-dominated regions and violates consistency by introducing excessive, physics-independent dissipation. This design is not justified by the nondimensional analysis. Verdict: Incorrect.\n\nTherefore, the correct choices are A and D.",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "Iterative solvers, which are central to most computational thermal codes, generate a sequence of approximate solutions. A crucial element of the solver architecture is the set of criteria used to determine when the solution is \"good enough\" to stop iterating. This practice  moves beyond abstract numerical tolerances to connect solver residuals to tangible physical quantities, such as global energy balance, allowing you to design stopping criteria that provide confidence in the physical fidelity of the simulation results.",
            "id": "3937462",
            "problem": "A computational thermal code solves a steady-state heat conduction problem on a bounded domain $\\Omega \\subset \\mathbb{R}^3$ with thermal conductivity $k(\\mathbf{x}) > 0$ and volumetric heat source $s(\\mathbf{x})$. The governing law is conservation of energy, which in differential form is\n$$\n\\nabla \\cdot \\left(k(\\mathbf{x}) \\nabla T(\\mathbf{x})\\right) = s(\\mathbf{x})\n$$\nwith a mix of Dirichlet and Neumann boundary conditions prescribed on $\\partial \\Omega$. A finite volume discretization on $N$ control volumes produces a linear system\n$$\n\\mathbf{A} \\mathbf{T} = \\mathbf{b},\n$$\nwhere $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ is symmetric positive definite (SPD), $\\mathbf{T} \\in \\mathbb{R}^N$ is the vector of nodal temperatures, and $\\mathbf{b} \\in \\mathbb{R}^N$ collects source terms and boundary contributions consistently assembled so that the scheme is locally and globally conservative. An iterative linear solver produces an approximation $\\mathbf{T}_k$ at iteration $k$ with residual\n$$\n\\mathbf{r}_k = \\mathbf{b} - \\mathbf{A}\\mathbf{T}_k.\n$$\nDefine the temperature error $\\mathbf{e}_k = \\mathbf{T}^\\star - \\mathbf{T}_k$, where $\\mathbf{T}^\\star$ is the exact discrete solution of $\\mathbf{A}\\mathbf{T}^\\star = \\mathbf{b}$. Let $\\mathbf{G}$ denote the discrete gradient operator mapping nodal temperatures to face-centered gradients used by the flux computation in the finite volume scheme, and assume $k(\\mathbf{x})$ is constant with value $k > 0$ for the purpose of bounding flux errors. Let the heat flux field be discretely represented by $\\mathbf{q} = -k\\,\\mathbf{G}\\mathbf{T}$ so that the heat flux error is $\\mathbf{q}_{\\mathrm{err},k} = \\mathbf{q}^\\star - \\mathbf{q}_k = -k\\,\\mathbf{G}\\mathbf{e}_k$. Define a global energy balance error metric by\n$$\nE_{\\mathrm{bal},k} = \\left|\\sum_{i=1}^N r_{k,i}\\right|,\n$$\nwhere $r_{k,i}$ denotes the $i$th component of $\\mathbf{r}_k$ and summation is over all control volumes.\n\nConsider the problem of designing stopping criteria for the iterative solver and mapping solver tolerances to physical error metrics. Which of the following statements are correct in this context?\n\nA. If $\\mathbf{A}$ is symmetric positive definite with smallest eigenvalue $\\lambda_{\\min}(\\mathbf{A})$, then enforcing a residual norm criterion $\\|\\mathbf{r}_k\\|_2 \\le \\varepsilon_r$ guarantees an upper bound on the temperature error $\\|\\mathbf{e}_k\\|_2 \\le \\varepsilon_r / \\lambda_{\\min}(\\mathbf{A})$.\n\nB. The energy balance error metric $E_{\\mathrm{bal},k}$ equals $\\sum_{i=1}^N |r_{k,i}|$, so a zero residual implies zero global energy imbalance, and conversely a small residual norm ensures a small $E_{\\mathrm{bal},k}$ only if the residual entries have the same sign.\n\nC. For a conservative finite volume discretization, each residual component $r_{k,i}$ represents the discrete energy imbalance over control volume $i$, and therefore using $\\|\\mathbf{r}_k\\|_1$ as a stopping criterion directly bounds the global energy balance error via the inequality $E_{\\mathrm{bal},k} \\le \\|\\mathbf{r}_k\\|_1$.\n\nD. A stopping criterion based purely on the iterative update, such as $\\|\\Delta \\mathbf{T}_k\\|_2 / \\|\\mathbf{T}_k\\|_2 \\le \\varepsilon_u$, always ensures that the energy balance error metric $E_{\\mathrm{bal},k}$ is below $\\varepsilon_u$ times the total heat input to the domain, regardless of the conditioning of $\\mathbf{A}$.\n\nE. If $\\|\\mathbf{G}\\|_2$ denotes the spectral norm of the discrete gradient operator and $k$ is constant, then the heat flux error norm satisfies $\\|\\mathbf{q}_{\\mathrm{err},k}\\|_2 \\le k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\|\\mathbf{r}_k\\|_2$, so selecting a residual tolerance $\\varepsilon_r$ maps to a physical flux error tolerance $k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\varepsilon_r$.\n\nSelect all correct options.",
            "solution": "The fundamental base is conservation of energy and the properties of the finite volume discretization and linear algebra. The steady-state heat equation is $\\nabla \\cdot (k \\nabla T) = s$, and a conservative finite volume scheme enforces that, for each control volume, the net conductive flux out minus the source integrated over the volume is zero at the exact discrete solution. When the iterative solver has not converged, the residual at control volume $i$ is a measure of the imbalance at that volume. The linear system is $\\mathbf{A}\\mathbf{T} = \\mathbf{b}$ with symmetric positive definite (SPD) matrix $\\mathbf{A}$, and the residual is $\\mathbf{r}_k = \\mathbf{b} - \\mathbf{A}\\mathbf{T}_k$.\n\nThe temperature error satisfies\n$$\n\\mathbf{A}\\mathbf{e}_k = \\mathbf{A}(\\mathbf{T}^\\star - \\mathbf{T}_k) = \\mathbf{b} - \\mathbf{A}\\mathbf{T}_k = \\mathbf{r}_k,\n$$\nso\n$$\n\\mathbf{e}_k = \\mathbf{A}^{-1}\\mathbf{r}_k.\n$$\nTaking the Euclidean norm and using the induced operator norm $\\|\\mathbf{A}^{-1}\\|_2$, we obtain\n$$\n\\|\\mathbf{e}_k\\|_2 \\le \\|\\mathbf{A}^{-1}\\|_2 \\,\\|\\mathbf{r}_k\\|_2.\n$$\nFor SPD $\\mathbf{A}$, $\\|\\mathbf{A}^{-1}\\|_2 = 1/\\lambda_{\\min}(\\mathbf{A})$ where $\\lambda_{\\min}(\\mathbf{A})$ is the smallest eigenvalue of $\\mathbf{A}$. Therefore,\n$$\n\\|\\mathbf{e}_k\\|_2 \\le \\frac{\\|\\mathbf{r}_k\\|_2}{\\lambda_{\\min}(\\mathbf{A})}.\n$$\nThis establishes a mapping from a residual norm tolerance to a bound on the temperature error.\n\nFor the energy balance, a conservative finite volume assembly ensures that, at the exact discrete solution, the sum of the control-volume residuals is zero when the boundary fluxes implied by the solution satisfy the boundary conditions. More generally, by definition\n$$\nE_{\\mathrm{bal},k} = \\left|\\sum_{i=1}^N r_{k,i}\\right|,\n$$\nwhich is bounded above by the $\\ell^1$ norm of the residual by the triangle inequality:\n$$\n\\left|\\sum_{i=1}^N r_{k,i}\\right| \\le \\sum_{i=1}^N |r_{k,i}| = \\|\\mathbf{r}_k\\|_1.\n$$\nThus, any stopping criterion that controls $\\|\\mathbf{r}_k\\|_1$ also controls the global energy balance error $E_{\\mathrm{bal},k}$.\n\nFor the heat flux, the discrete flux error is $\\mathbf{q}_{\\mathrm{err},k} = -k\\,\\mathbf{G}\\mathbf{e}_k$. Taking norms,\n$$\n\\|\\mathbf{q}_{\\mathrm{err},k}\\|_2 = k\\,\\|\\mathbf{G}\\mathbf{e}_k\\|_2 \\le k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{e}_k\\|_2 \\le k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\|\\mathbf{r}_k\\|_2,\n$$\nwhich maps a residual norm tolerance $\\varepsilon_r$ to a flux error tolerance $k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\varepsilon_r$.\n\nWe now analyze each option:\n\nA. This statement directly follows from the derivation above. Since $\\mathbf{e}_k = \\mathbf{A}^{-1}\\mathbf{r}_k$, we have $\\|\\mathbf{e}_k\\|_2 \\le \\|\\mathbf{A}^{-1}\\|_2 \\,\\|\\mathbf{r}_k\\|_2 = \\|\\mathbf{r}_k\\|_2/\\lambda_{\\min}(\\mathbf{A})$ for SPD $\\mathbf{A}$. Enforcing $\\|\\mathbf{r}_k\\|_2 \\le \\varepsilon_r$ yields $\\|\\mathbf{e}_k\\|_2 \\le \\varepsilon_r/\\lambda_{\\min}(\\mathbf{A})$. Verdict: Correct.\n\nB. The first claim, $E_{\\mathrm{bal},k} = \\sum_{i=1}^N |r_{k,i}|$, is false. By definition, $E_{\\mathrm{bal},k} = \\left|\\sum_{i=1}^N r_{k,i}\\right|$, which equals the absolute value of the sum, not the sum of absolute values. It is true that a zero residual vector implies zero global energy imbalance, but the statement as written asserts an equality that does not hold. The second clause mixes conditions on sign and does not repair the incorrect equality. Verdict: Incorrect.\n\nC. In a conservative finite volume scheme, the residual at control volume $i$ is the discrete divergence of $k\\nabla T$ minus the source integrated over the volume, i.e., a local energy imbalance due to not yet satisfying the discrete equations. The global energy imbalance $E_{\\mathrm{bal},k} = \\left|\\sum_i r_{k,i}\\right|$ is bounded by $\\|\\mathbf{r}_k\\|_1$ by the triangle inequality, so a stopping criterion based on $\\|\\mathbf{r}_k\\|_1$ directly bounds the global energy balance error. Verdict: Correct.\n\nD. An update-based stopping criterion $\\|\\Delta \\mathbf{T}_k\\|_2/\\|\\mathbf{T}_k\\|_2 \\le \\varepsilon_u$ does not universally guarantee a bound on $E_{\\mathrm{bal},k}$ independent of the conditioning of $\\mathbf{A}$. The residual is $\\mathbf{r}_k = \\mathbf{A}\\mathbf{e}_k$, and the relationship between $\\Delta \\mathbf{T}_k$ and $\\mathbf{e}_k$ depends on the solver and the conditioning of $\\mathbf{A}$. Poor conditioning can yield small updates while the residual (and hence energy imbalance) remains significant. Therefore, the asserted guarantee \"regardless of the conditioning of $\\mathbf{A}$\" is false. Verdict: Incorrect.\n\nE. Using $\\mathbf{q}_{\\mathrm{err},k} = -k\\,\\mathbf{G}\\mathbf{e}_k$ and the submultiplicative property of induced norms gives\n$$\n\\|\\mathbf{q}_{\\mathrm{err},k}\\|_2 \\le k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{e}_k\\|_2 \\le k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\|\\mathbf{r}_k\\|_2.\n$$\nThus, a residual tolerance $\\varepsilon_r$ maps to a flux error tolerance $k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\varepsilon_r$. This is a correct statement under the stated assumptions (constant $k$ and the operator norms as defined). Verdict: Correct.\n\nTherefore, the correct options are A, C, and E.",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}