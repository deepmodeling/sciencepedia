{
    "hands_on_practices": [
        {
            "introduction": "任何计算热学问题的分析都始于坚实的基础，本练习旨在奠定这一基础。通过对控制方程进行无量纲化 ，我们将核心物理原理提炼为关键的无量纲数和规范形式，这有助于我们更普适地理解问题。此外，分析所选离散格式的数值稳定性是一项基本技能，它能确保模拟结果具有物理意义，而不会因数值伪影而发散。",
            "id": "3937508",
            "problem": "一个厚度为 $L$、具有恒定热物理性质（热导率 $k$、密度 $\\rho$、恒压比热容 $c_p$）的一维平板仅通过传导进行热交换。其控制方程由能量守恒定律和适用于恒定性质连续介质的 Fourier 定律推导得出。该平板具有给定的且不相等的 Dirichlet 边界条件 $T(0,t)=T_L$ 和 $T(L,t)=T_R$，其中 $T_L \\neq T_R$，以及一个任意的有界初始温度场 $T(x,0)=T_0(x)$。为该平板设计了一个计算热学代码模块，用于在具有 $N$ 个空间区间的均匀网格上求解偏微分方程的无量纲形式，并使用显式向前时间、中心空间 (FTCS) 格式在时间上推进。\n\n任务：\n- 从能量守恒和 Fourier 定律出发，引入无量纲变量 $x=L\\,\\xi$、$t=(L^2/\\alpha)\\,\\tau$ 和 $T=T_{\\text{ref}}+T_{\\text{scale}}\\,\\theta$，其中 $\\alpha=k/(\\rho c_p)$，推导出在 $\\xi \\in (0,1)$ 上的规范形式无量纲控制方程 $\\partial \\theta/\\partial \\tau=\\partial^2 \\theta/\\partial \\xi^2$，并将 Dirichlet 边界条件映射为常数。选择 $T_{\\text{ref}}$ 和 $T_{\\text{scale}}$，使得边界条件变为 $\\theta(0,\\tau)=1$ 和 $\\theta(1,\\tau)=0$ (对于所有 $\\tau \\ge 0$)，并明确指出由此产生的 $\\theta$ 和 $\\tau$。\n- 该代码在 $\\xi$ 的均匀网格上使用 FTCS 格式在时间上推进解，该网格有 $N$ 个区间，因此无量纲网格间距为 $\\Delta \\xi=1/N$。通过 Fourier (von Neumann) 分析从第一性原理推导线性稳定性条件，并以 $L$、$k$、$\\rho$、$c_p$ 和 $N$ 的形式，求得允许的最大有量纲时间步长 $\\Delta t_{\\max}$。以秒为单位表示最终时间步长。\n\n您的最终答案必须是 $\\Delta t_{\\max}$ 的单个闭式解析表达式。",
            "solution": "该问题被评估为具有科学依据、适定、客观且完全明确。其前提基于热传递和数值分析的基本原理。这些任务是计算热工领域的标准推导。因此，该问题被认为是有效的，下面给出完整解法。\n\n根据要求，解法分为两部分。第一部分是控制方程和边界条件的无量纲化。第二部分是数值格式的稳定性分析。\n\n第 1 部分：无量纲化\n物理过程是一维平板中的热传导。连续介质的能量守恒，结合 Fourier 热传导定律，导出了热方程。对于具有恒定热物理性质（热导率 $k$、密度 $\\rho$ 和比热容 $c_p$）的一维区域 $x \\in [0, L]$，其控制方程为：\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} $$\n两边同除以 $\\rho c_p$ 得到包含热扩散率 $\\alpha = k/(\\rho c_p)$ 的标准形式：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\n问题指定了以下无量纲变量：\n$$ x = L\\,\\xi, \\quad t = \\frac{L^2}{\\alpha}\\,\\tau, \\quad T(x,t) = T_{\\text{ref}} + T_{\\text{scale}}\\,\\theta(\\xi,\\tau) $$\n我们使用链式法则来变换偏导数：\n$$ \\frac{\\partial}{\\partial t} = \\frac{\\partial \\tau}{\\partial t} \\frac{\\partial}{\\partial \\tau} = \\left(\\frac{\\alpha}{L^2}\\right) \\frac{\\partial}{\\partial \\tau} $$\n$$ \\frac{\\partial}{\\partial x} = \\frac{\\partial \\xi}{\\partial x} \\frac{\\partial}{\\partial \\xi} = \\left(\\frac{1}{L}\\right) \\frac{\\partial}{\\partial \\xi} \\implies \\frac{\\partial^2}{\\partial x^2} = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{L}\\frac{\\partial}{\\partial \\xi}\\right) = \\left(\\frac{1}{L}\\right)^2 \\frac{\\partial^2}{\\partial \\xi^2} = \\frac{1}{L^2} \\frac{\\partial^2}{\\partial \\xi^2} $$\n将这些算子和温度定义代入热方程：\n$$ \\frac{\\partial (T_{\\text{ref}} + T_{\\text{scale}}\\,\\theta)}{\\partial t} = \\alpha \\frac{\\partial^2 (T_{\\text{ref}} + T_{\\text{scale}}\\,\\theta)}{\\partial x^2} $$\n由于 $T_{\\text{ref}}$ 和 $T_{\\text{scale}}$ 是常数，这可以简化为：\n$$ T_{\\text{scale}} \\frac{\\partial \\theta}{\\partial t} = \\alpha T_{\\text{scale}} \\frac{\\partial^2 \\theta}{\\partial x^2} $$\n现在，代入变换后的导数：\n$$ T_{\\text{scale}} \\left(\\frac{\\alpha}{L^2}\\right) \\frac{\\partial \\theta}{\\partial \\tau} = \\alpha T_{\\text{scale}} \\left(\\frac{1}{L^2} \\frac{\\partial^2 \\theta}{\\partial \\xi^2}\\right) $$\n假设 $T_{\\text{scale}} \\neq 0$，我们可以将两边同除以 $\\alpha T_{\\text{scale}}/L^2$ 以获得所要求的规范无量纲热方程：\n$$ \\frac{\\partial \\theta}{\\partial \\tau} = \\frac{\\partial^2 \\theta}{\\partial \\xi^2} $$\n空间域 $x \\in [0, L]$ 映射到 $\\xi \\in [0, 1]$。\n\n接下来，我们变换边界条件。有量纲的边界条件是 $T(0,t)=T_L$ 和 $T(L,t)=T_R$。我们需要选择 $T_{\\text{ref}}$ 和 $T_{\\text{scale}}$ 使得无量纲边界条件变为 $\\theta(0,\\tau)=1$ 和 $\\theta(1,\\tau)=0$。\n在 $x=0$ (即 $\\xi=0$) 处：\n$$ T(0,t) = T_L \\implies T_{\\text{ref}} + T_{\\text{scale}}\\,\\theta(0,\\tau) = T_L $$\n使用目标 $\\theta(0,\\tau)=1$，这变为：\n$$ T_{\\text{ref}} + T_{\\text{scale}}(1) = T_L $$\n在 $x=L$ (即 $\\xi=1$) 处：\n$$ T(L,t) = T_R \\implies T_{\\text{ref}} + T_{\\text{scale}}\\,\\theta(1,\\tau) = T_R $$\n使用目标 $\\theta(1,\\tau)=0$，这变为：\n$$ T_{\\text{ref}} + T_{\\text{scale}}(0) = T_R $$\n从第二个方程中，我们得到 $T_{\\text{ref}} = T_R$。将此代入第一个方程得出 $T_R + T_{\\text{scale}} = T_L$，这给出 $T_{\\text{scale}} = T_L - T_R$。问题陈述 $T_L \\neq T_R$，因此按要求 $T_{\\text{scale}} \\neq 0$。\n\n无量纲温度 $\\theta$ 和时间 $\\tau$ 的显式形式通过重新排列其定义得到：\n$$ \\theta(\\xi, \\tau) = \\frac{T(x,t) - T_{\\text{ref}}}{T_{\\text{scale}}} = \\frac{T(L\\xi, \\frac{L^2}{\\alpha}\\tau) - T_R}{T_L - T_R} $$\n$$ \\tau = \\frac{\\alpha t}{L^2} = \\frac{k t}{\\rho c_p L^2} $$\n\n第 2 部分：稳定性分析\n该代码采用向前时间、中心空间 (FTCS) 格式来求解无量纲方程 $\\partial \\theta/\\partial \\tau = \\partial^2 \\theta/\\partial \\xi^2$。设 $\\theta_j^n$ 近似 $\\theta(\\xi_j, \\tau_n)$，其中 $\\xi_j = j \\Delta \\xi$ 且 $\\tau_n = n \\Delta \\tau$。网格有 $N$ 个区间，因此无量纲网格间距为 $\\Delta \\xi = 1/N$。\n\nFTCS 离散格式为：\n$$ \\frac{\\theta_j^{n+1} - \\theta_j^n}{\\Delta \\tau} = \\frac{\\theta_{j+1}^n - 2\\theta_j^n + \\theta_{j-1}^n}{(\\Delta \\xi)^2} $$\n为求未来时间步 $\\theta_j^{n+1}$ 进行整理：\n$$ \\theta_j^{n+1} = \\theta_j^n + s (\\theta_{j+1}^n - 2\\theta_j^n + \\theta_{j-1}^n) $$\n其中 $s = \\frac{\\Delta \\tau}{(\\Delta \\xi)^2}$ 是常数网格 Fourier 数。\n\n对于 Fourier (von Neumann) 稳定性分析，我们考虑误差的单个 Fourier 模态，表示为 $\\epsilon_j^n = G^n e^{i k_m j \\Delta \\xi}$ 形式的扰动，其中 $k_m$ 是波数，$G$ 是每个时间步的放大因子。为使格式稳定，对于所有可能的波数，放大因子的模必须小于或等于 1，即 $|G| \\le 1$。将此形式代入有限差分方程（误差也满足此方程）：\n$$ G^{n+1} e^{i k_m j \\Delta \\xi} = G^n e^{i k_m j \\Delta \\xi} + s \\left( G^n e^{i k_m (j+1) \\Delta \\xi} - 2G^n e^{i k_m j \\Delta \\xi} + G^n e^{i k_m (j-1) \\Delta \\xi} \\right) $$\n两边同除以 $G^n e^{i k_m j \\Delta \\xi}$（对于非平凡解）：\n$$ G = 1 + s (e^{i k_m \\Delta \\xi} - 2 + e^{-i k_m \\Delta \\xi}) $$\n使用恒等式 $e^{i\\phi} + e^{-i\\phi} = 2 \\cos(\\phi)$：\n$$ G = 1 + s (2 \\cos(k_m \\Delta \\xi) - 2) = 1 - 2s(1 - \\cos(k_m \\Delta \\xi)) $$\n使用半角恒等式 $1 - \\cos(\\phi) = 2\\sin^2(\\phi/2)$：\n$$ G = 1 - 4s \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right) $$\n放大因子 $G$ 是实数。稳定性条件 $|G| \\le 1$ 可转换为 $-1 \\le G \\le 1$。\n上界 $G \\le 1$ 给出：\n$$ 1 - 4s \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right) \\le 1 \\implies -4s \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right) \\le 0 $$\n因为 $s > 0$ 且 $\\sin^2(\\cdot) \\ge 0$，此条件总是满足的。\n下界 $G \\ge -1$ 给出：\n$$ 1 - 4s \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right) \\ge -1 \\implies 2 \\ge 4s \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right) \\implies s \\le \\frac{1}{2 \\sin^2\\left(\\frac{k_m \\Delta \\xi}{2}\\right)} $$\n此条件必须对所有波数 $k_m$ 成立。最严格的条件发生在分母最小时，这对应于项 $\\sin^2(\\frac{k_m \\Delta \\xi}{2})$ 取最大值。$\\sin^2(\\cdot)$ 的最大值为 $1$。这发生在网格上可表示的最高频率（最短波长）模态，此时 $k_m \\Delta \\xi = \\pi$。\n因此，稳定性条件变为：\n$$ s \\le \\frac{1}{2} $$\n代入 $s$ 的定义：\n$$ \\frac{\\Delta \\tau}{(\\Delta \\xi)^2} \\le \\frac{1}{2} $$\n最大无量纲时间步长为 $\\Delta \\tau_{\\max} = \\frac{1}{2}(\\Delta \\xi)^2$。\n\n为了求得允许的最大有量纲时间步长 $\\Delta t_{\\max}$，我们转换回有量纲变量。\n我们有 $\\Delta \\tau = \\frac{\\alpha \\Delta t}{L^2}$ 和 $\\Delta \\xi = \\frac{\\Delta x}{L}$。对于长度为 $L$、有 $N$ 个区间的均匀网格，网格间距为 $\\Delta x = L/N$。因此，$\\Delta \\xi = (L/N)/L = 1/N$。\n将这些代入稳定性条件：\n$$ \\frac{\\alpha \\Delta t}{L^2} \\le \\frac{1}{2} \\left(\\frac{1}{N}\\right)^2 $$\n解出 $\\Delta t$：\n$$ \\Delta t \\le \\frac{L^2}{2 \\alpha N^2} $$\n因此，允许的最大有量纲时间步长为：\n$$ \\Delta t_{\\max} = \\frac{L^2}{2 \\alpha N^2} $$\n最后，代入热扩散率的定义 $\\alpha = k/(\\rho c_p)$：\n$$ \\Delta t_{\\max} = \\frac{L^2}{2 N^2} \\frac{1}{\\alpha} = \\frac{L^2}{2 N^2} \\frac{\\rho c_p}{k} $$\n此表达式的单位是秒，符合要求。",
            "answer": "$$\\boxed{\\frac{\\rho c_p L^2}{2 k N^2}}$$"
        },
        {
            "introduction": "当一个物理问题被离散化为一个大型代数方程组后，通常需要使用迭代求解器来获得解。本练习  探讨了设计求解器停止准则这一关键任务，它在抽象的数学收敛指标（如残差范数）与具体的物理误差估计（如温度和热通量误差）之间架起了桥梁。一个稳健的代码架构需要智能的收敛判据，以确保解在物理上的准确性，例如满足全局能量守恒。",
            "id": "3937462",
            "problem": "一个计算热学程序求解有界域 $\\Omega \\subset \\mathbb{R}^3$ 上的稳态热传导问题，其热导率为 $k(\\mathbf{x}) > 0$，体热源为 $s(\\mathbf{x})$。控制定律是能量守恒，其微分形式为\n$$\n\\nabla \\cdot \\left(k(\\mathbf{x}) \\nabla T(\\mathbf{x})\\right) = s(\\mathbf{x})\n$$\n并在 $\\partial \\Omega$ 上规定了狄利克雷和诺伊曼混合边界条件。在 $N$ 个控制体上进行有限体积离散化，产生一个线性系统\n$$\n\\mathbf{A} \\mathbf{T} = \\mathbf{b},\n$$\n其中 $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ 是对称正定 (SPD) 矩阵，$\\mathbf{T} \\in \\mathbb{R}^N$ 是节点温度向量，$\\mathbf{b} \\in \\mathbb{R}^N$ 集合了源项和边界贡献，并以保证格式局部和全局守恒的方式进行一致组装。一个迭代线性求解器在第 $k$ 次迭代时产生一个近似解 $\\mathbf{T}_k$，其残差为\n$$\n\\mathbf{r}_k = \\mathbf{b} - \\mathbf{A}\\mathbf{T}_k.\n$$\n定义温度误差为 $\\mathbf{e}_k = \\mathbf{T}^\\star - \\mathbf{T}_k$，其中 $\\mathbf{T}^\\star$ 是 $\\mathbf{A}\\mathbf{T}^\\star = \\mathbf{b}$ 的精确离散解。令 $\\mathbf{G}$ 表示离散梯度算子，它将节点温度映射到有限体积格式中通量计算所使用的面心梯度。为界定通量误差，假设 $k(\\mathbf{x})$ 是常数，其值为 $k > 0$。令热通量场离散地表示为 $\\mathbf{q} = -k\\,\\mathbf{G}\\mathbf{T}$，因此热通量误差为 $\\mathbf{q}_{\\mathrm{err},k} = \\mathbf{q}^\\star - \\mathbf{q}_k = -k\\,\\mathbf{G}\\mathbf{e}_k$。定义一个全局能量平衡误差度量为\n$$\nE_{\\mathrm{bal},k} = \\left|\\sum_{i=1}^N r_{k,i}\\right|,\n$$\n其中 $r_{k,i}$ 表示 $\\mathbf{r}_k$ 的第 $i$ 个分量，求和遍及所有控制体。\n\n考虑为迭代求解器设计停止准则以及将求解器容差映射到物理误差度量的问题。在这种情况下，下列哪些陈述是正确的？\n\nA. 如果 $\\mathbf{A}$ 是对称正定矩阵，其最小特征值为 $\\lambda_{\\min}(\\mathbf{A})$，那么强制执行残差范数准则 $\\|\\mathbf{r}_k\\|_2 \\le \\varepsilon_r$ 可以保证温度误差的上界为 $\\|\\mathbf{e}_k\\|_2 \\le \\varepsilon_r / \\lambda_{\\min}(\\mathbf{A})$。\n\nB. 能量平衡误差度量 $E_{\\mathrm{bal},k}$ 等于 $\\sum_{i=1}^N |r_{k,i}|$，因此零残差意味着零全局能量不平衡，反之，仅当残差各项符号相同时，小的残差范数才能确保小的 $E_{\\mathrm{bal},k}$。\n\nC. 对于一个守恒的有限体积离散化，每个残差分量 $r_{k,i}$ 代表了控制体 $i$ 上的离散能量不平衡。因此，使用 $\\|\\mathbf{r}_k\\|_1$ 作为停止准则，可以通过不等式 $E_{\\mathrm{bal},k} \\le \\|\\mathbf{r}_k\\|_1$ 直接界定全局能量平衡误差。\n\nD. 一个纯粹基于迭代更新的停止准则，例如 $\\|\\Delta \\mathbf{T}_k\\|_2 / \\|\\mathbf{T}_k\\|_2 \\le \\varepsilon_u$，总能确保能量平衡误差度量 $E_{\\mathrm{bal},k}$ 低于 $\\varepsilon_u$ 乘以区域总热量输入，而与 $\\mathbf{A}$ 的条件数无关。\n\nE. 如果 $\\|\\mathbf{G}\\|_2$ 表示离散梯度算子的谱范数且 $k$ 是常数，那么热通量误差范数满足 $\\|\\mathbf{q}_{\\mathrm{err},k}\\|_2 \\le k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\|\\mathbf{r}_k\\|_2$，因此选择一个残差容差 $\\varepsilon_r$ 会映射到一个物理通量误差容差 $k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\varepsilon_r$。\n\n选择所有正确的选项。",
            "solution": "基本依据是能量守恒以及有限体积离散化和线性代数的性质。稳态热传导方程为 $\\nabla \\cdot (k \\nabla T) = s$，一个守恒的有限体积格式强制要求，在精确离散解处，对于每个控制体，流出的净传导通量减去在该体积上积分的源项为零。当迭代求解器尚未收敛时，控制体 $i$ 上的残差是该控制体上不平衡程度的度量。线性系统为 $\\mathbf{A}\\mathbf{T} = \\mathbf{b}$，其中 $\\mathbf{A}$ 是对称正定 (SPD) 矩阵，残差为 $\\mathbf{r}_k = \\mathbf{b} - \\mathbf{A}\\mathbf{T}_k$。\n\n温度误差满足\n$$\n\\mathbf{A}\\mathbf{e}_k = \\mathbf{A}(\\mathbf{T}^\\star - \\mathbf{T}_k) = \\mathbf{b} - \\mathbf{A}\\mathbf{T}_k = \\mathbf{r}_k,\n$$\n所以\n$$\n\\mathbf{e}_k = \\mathbf{A}^{-1}\\mathbf{r}_k.\n$$\n取欧几里得范数并使用诱导算子范数 $\\|\\mathbf{A}^{-1}\\|_2$，我们得到\n$$\n\\|\\mathbf{e}_k\\|_2 \\le \\|\\mathbf{A}^{-1}\\|_2 \\,\\|\\mathbf{r}_k\\|_2.\n$$\n对于 SPD 矩阵 $\\mathbf{A}$，$\\|\\mathbf{A}^{-1}\\|_2 = 1/\\lambda_{\\min}(\\mathbf{A})$，其中 $\\lambda_{\\min}(\\mathbf{A})$ 是 $\\mathbf{A}$ 的最小特征值。因此，\n$$\n\\|\\mathbf{e}_k\\|_2 \\le \\frac{\\|\\mathbf{r}_k\\|_2}{\\lambda_{\\min}(\\mathbf{A})}.\n$$\n这建立了一个从残差范数容差到温度误差上界的映射。\n\n对于能量平衡，一个守恒的有限体积组装确保了，在精确离散解处，当解所隐含的边界通量满足边界条件时，控制体残差之和为零。更一般地，根据定义\n$$\nE_{\\mathrm{bal},k} = \\left|\\sum_{i=1}^N r_{k,i}\\right|,\n$$\n根据三角不等式，它的上界是残差的 $\\ell^1$ 范数：\n$$\n\\left|\\sum_{i=1}^N r_{k,i}\\right| \\le \\sum_{i=1}^N |r_{k,i}| = \\|\\mathbf{r}_k\\|_1.\n$$\n因此，任何控制 $\\|\\mathbf{r}_k\\|_1$ 的停止准则也控制了全局能量平衡误差 $E_{\\mathrm{bal},k}$。\n\n对于热通量，离散通量误差为 $\\mathbf{q}_{\\mathrm{err},k} = -k\\,\\mathbf{G}\\mathbf{e}_k$。取范数，\n$$\n\\|\\mathbf{q}_{\\mathrm{err},k}\\|_2 = k\\,\\|\\mathbf{G}\\mathbf{e}_k\\|_2 \\le k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{e}_k\\|_2 \\le k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\|\\mathbf{r}_k\\|_2,\n$$\n这将一个残差范数容差 $\\varepsilon_r$ 映射到一个通量误差容差 $k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\varepsilon_r$。\n\n我们现在分析每个选项：\n\nA. 这个陈述直接源于上面的推导。由于 $\\mathbf{e}_k = \\mathbf{A}^{-1}\\mathbf{r}_k$，对于 SPD 矩阵 $\\mathbf{A}$，我们有 $\\|\\mathbf{e}_k\\|_2 \\le \\|\\mathbf{A}^{-1}\\|_2 \\,\\|\\mathbf{r}_k\\|_2 = \\|\\mathbf{r}_k\\|_2/\\lambda_{\\min}(\\mathbf{A})$。强制执行 $\\|\\mathbf{r}_k\\|_2 \\le \\varepsilon_r$ 会得到 $\\|\\mathbf{e}_k\\|_2 \\le \\varepsilon_r/\\lambda_{\\min}(\\mathbf{A})$。结论：正确。\n\nB. 第一个论断，$E_{\\mathrm{bal},k} = \\sum_{i=1}^N |r_{k,i}|$，是错误的。根据定义，$E_{\\mathrm{bal},k} = \\left|\\sum_{i=1}^N r_{k,i}\\right|$，它等于和的绝对值，而不是绝对值的和。零残差向量确实意味着零全局能量不平衡，但所写的陈述断言了一个不成立的等式。第二子句混合了关于符号的条件，并且没有修正这个不正确的等式。结论：不正确。\n\nC. 在一个守恒的有限体积格式中，控制体 $i$ 上的残差是 $k\\nabla T$ 的离散散度减去在该体积上积分的源项，即由于尚未满足离散方程而导致的局部能量不平衡。全局能量不平衡 $E_{\\mathrm{bal},k} = \\left|\\sum_i r_{k,i}\\right|$ 根据三角不等式由 $\\|\\mathbf{r}_k\\|_1$ 界定，因此基于 $\\|\\mathbf{r}_k\\|_1$ 的停止准则直接界定了全局能量平衡误差。结论：正确。\n\nD. 一个基于更新的停止准则 $\\|\\Delta \\mathbf{T}_k\\|_2/\\|\\mathbf{T}_k\\|_2 \\le \\varepsilon_u$ 并不能普遍保证 $E_{\\mathrm{bal},k}$ 的上界与 $\\mathbf{A}$ 的条件数无关。残差为 $\\mathbf{r}_k = \\mathbf{A}\\mathbf{e}_k$，而 $\\Delta \\mathbf{T}_k$ 和 $\\mathbf{e}_k$ 之间的关系取决于求解器和 $\\mathbf{A}$ 的条件数。差的条件数可能导致更新量很小，而残差（以及因此的能量不平衡）仍然很大。因此，所断言的“与 $\\mathbf{A}$ 的条件数无关”的保证是错误的。结论：不正确。\n\nE. 使用 $\\mathbf{q}_{\\mathrm{err},k} = -k\\,\\mathbf{G}\\mathbf{e}_k$ 和诱导范数的次乘性可得\n$$\n\\|\\mathbf{q}_{\\mathrm{err},k}\\|_2 \\le k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{e}_k\\|_2 \\le k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\|\\mathbf{r}_k\\|_2.\n$$\n因此，一个残差容差 $\\varepsilon_r$ 映射到一个通量误差容差 $k\\,\\|\\mathbf{G}\\|_2\\,\\|\\mathbf{A}^{-1}\\|_2\\,\\varepsilon_r$。在给定的假设下（常数 $k$ 和所定义的算子范数），这是一个正确的陈述。结论：正确。\n\n因此，正确的选项是 A、C 和 E。",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "我们如何确信代码中没有错误，并且能正确求解目标偏微分方程？本练习介绍“人造解方法”（Method of Manufactured Solutions, MMS），这是一种用于代码验证的强大而严谨的技术。通过构造一个解析解并推导相应的源项，我们可以精确地量化数值实现的误差，并验证其理论收敛阶，这是确保代码正确性的关键一步。",
            "id": "3937495",
            "problem": "一个用于求解瞬态热传导的计算热学代码被组织为多个模块，分别用于几何离散化、场与材料数据库、物理算子组装、边界条件管理和求解器编排。物理内核根据能量守恒和 Fourier 定律来推进温度场。从局部能量守恒和 Fourier 定律出发，推导在制造解方法（MMS）下为进行验证而必须注入的体积源项。\n\n从以下基本原理开始：\n- 微分控制体的能量守恒：显能的变化率等于传导热通量的散度加上体积生热。\n- 各向同性热传导的 Fourier 定律：传导热通量为 $-\\;k(\\mathbf{x})\\,\\nabla T(\\mathbf{x},t)$。\n\n考虑一个三维域，其坐标为 $\\mathbf{x} = (x,y,z)$，具有恒定的密度 $\\rho$ 和恒定的比热容 $c_p$，以及一个空间变化但各向同性的热导率 $k(\\mathbf{x})$，定义为 $k(x,y,z) = k_0\\,\\exp(\\eta x)\\,(1+\\zeta z^2)$，其中 $k_0 > 0$，$\\eta$ 是任意实常数，且 $\\zeta \\ge 0$。对于 MMS，选择制造的解析温度场\n$$\nT(x,y,z,t) = \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr),\n$$\n其中 $\\alpha$、$\\beta$ 和 $\\gamma$ 是正常数。该架构的边界条件模块将通过把 $T(\\mathbf{x},t)$ 限制在边界上来设置狄利克雷数据，而物理算子组装模块必须计算一个与此 $T$ 和 $k$ 一致的源项。\n\n仅使用上述基本原理，推导体积热源项 $Q(x,y,z,t)$ 的闭式解析表达式，该表达式使制造的 $T$ 满足瞬态热传导方程。将 $Q$ 以国际单位制（SI）基本单位表示为瓦特每立方米。不要进行任何数值计算或四舍五入。将最终的 $Q(x,y,z,t)$ 以单个闭式表达式的形式给出。",
            "solution": "目标是推导体积热源项 $Q(x,y,z,t)$，该源项是使指定的制造温度场 $T(x,y,z,t)$ 和空间变化的热导率 $k(\\mathbf{x})$ 满足瞬态热传导方程所必需的。\n\n瞬态热传导的控制方程源于能量守恒原理。微分控制体中显能的变化率由 $\\rho c_p \\frac{\\partial T}{\\partial t}$ 给出，其中 $\\rho$ 是密度， $c_p$ 是比热容。这必须与传入体积的净热传导率相平衡，后者由热通量的负散度 $-\\nabla \\cdot \\mathbf{q}$ 加上任何体积生热 $Q$ 给出。\n因此，能量守恒方程为：\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = -\\nabla \\cdot \\mathbf{q} + Q $$\n对于各向同性介质，Fourier 定律指出热通量 $\\mathbf{q}$ 与负温度梯度成正比：\n$$ \\mathbf{q} = -k(\\mathbf{x}) \\nabla T(\\mathbf{x}, t) $$\n将 Fourier 定律代入能量守恒方程，得到通用的瞬态热传导方程：\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = \\nabla \\cdot \\left( k(\\mathbf{x}) \\nabla T(\\mathbf{x}, t) \\right) + Q(x,y,z,t) $$\n为了找到与制造解一致的源项 $Q$，我们重排此方程：\n$$ Q(x,y,z,t) = \\rho c_p \\frac{\\partial T}{\\partial t} - \\nabla \\cdot \\left( k \\nabla T \\right) $$\n\n问题提供了以下函数和常数：\n-   制造温度场：$T(x,y,z,t) = \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr)$\n-   空间变化的热导率：$k(x,y,z) = k_0\\,\\exp(\\eta x)\\,(1+\\zeta z^2)$\n-   常数：$\\rho$、 $c_p$、 $\\alpha$、 $\\beta$、 $\\gamma$、 $k_0$、 $\\eta$、 $\\zeta$。\n\n我们将分别计算 $Q$ 表达式中的每一项。\n\n首先，我们计算时间导数项 $\\rho c_p \\frac{\\partial T}{\\partial t}$：\n$$ \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) \\right] = \\alpha \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) = \\alpha T $$\n因此，$Q$ 的第一项是：\n$$ \\rho c_p \\frac{\\partial T}{\\partial t} = \\rho c_p \\alpha \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) $$\n\n接下来，我们计算散度项 $\\nabla \\cdot (k \\nabla T)$。我们可以使用矢量微积分恒等式 $\\nabla \\cdot (\\phi \\mathbf{F}) = (\\nabla \\phi) \\cdot \\mathbf{F} + \\phi (\\nabla \\cdot \\mathbf{F})$ 来展开此项。这里，$\\phi = k$ 且 $\\mathbf{F} = \\nabla T$。\n$$ \\nabla \\cdot (k \\nabla T) = (\\nabla k) \\cdot (\\nabla T) + k \\nabla^2 T $$\n我们将计算分量 $\\nabla T$、$\\nabla^2 T$ 和 $\\nabla k$。\n\n温度梯度 $\\nabla T = \\left( \\frac{\\partial T}{\\partial x}, \\frac{\\partial T}{\\partial y}, \\frac{\\partial T}{\\partial z} \\right)$：\n$$ \\frac{\\partial T}{\\partial x} = \\beta \\exp(\\alpha t)\\,\\cos(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) $$\n$$ \\frac{\\partial T}{\\partial y} = -\\gamma \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\sin(\\gamma y)\\,\\bigl(1+z^2\\bigr) $$\n$$ \\frac{\\partial T}{\\partial z} = 2z \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y) $$\n\n温度的拉普拉斯算子 $\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} + \\frac{\\partial^2 T}{\\partial z^2}$：\n$$ \\frac{\\partial^2 T}{\\partial x^2} = -\\beta^2 \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) = -\\beta^2 T $$\n$$ \\frac{\\partial^2 T}{\\partial y^2} = -\\gamma^2 \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y)\\,\\bigl(1+z^2\\bigr) = -\\gamma^2 T $$\n$$ \\frac{\\partial^2 T}{\\partial z^2} = \\frac{\\partial}{\\partial z} \\left( 2z \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y) \\right) = 2 \\exp(\\alpha t)\\,\\sin(\\beta x)\\,\\cos(\\gamma y) = \\frac{2}{1+z^2}T $$\n将这些组合起来得到：\n$$ \\nabla^2 T = T \\left(-\\beta^2 - \\gamma^2 + \\frac{2}{1+z^2}\\right) $$\n所以，项 $k \\nabla^2 T$ 是：\n$$ k \\nabla^2 T = k_0 \\exp(\\eta x) (1+\\zeta z^2) \\left[ \\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y)(1+z^2) \\right] \\left(-\\beta^2 - \\gamma^2 + \\frac{2}{1+z^2}\\right) $$\n$$ k \\nabla^2 T = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\sin(\\beta x) \\cos(\\gamma y) \\left[ -(\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) + 2(1+\\zeta z^2) \\right] $$\n\n热导率的梯度 $\\nabla k = \\left( \\frac{\\partial k}{\\partial x}, \\frac{\\partial k}{\\partial y}, \\frac{\\partial k}{\\partial z} \\right)$：\n$$ \\frac{\\partial k}{\\partial x} = \\eta \\, k_0 \\exp(\\eta x) (1+\\zeta z^2) = \\eta k $$\n$$ \\frac{\\partial k}{\\partial y} = 0 $$\n$$ \\frac{\\partial k}{\\partial z} = k_0 \\exp(\\eta x) (2\\zeta z) = k \\frac{2\\zeta z}{1+\\zeta z^2} $$\n\n现在，我们计算点积 $(\\nabla k) \\cdot (\\nabla T)$：\n$$ (\\nabla k) \\cdot (\\nabla T) = \\frac{\\partial k}{\\partial x}\\frac{\\partial T}{\\partial x} + \\frac{\\partial k}{\\partial y}\\frac{\\partial T}{\\partial y} + \\frac{\\partial k}{\\partial z}\\frac{\\partial T}{\\partial z} $$\n$$ (\\nabla k) \\cdot (\\nabla T) = (\\eta k)(\\beta \\exp(\\alpha t)\\cos(\\beta x)\\cos(\\gamma y)(1+z^2)) + (0) + \\left(k \\frac{2\\zeta z}{1+\\zeta z^2}\\right)(2z \\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y)) $$\n代入 $k = k_0 \\exp(\\eta x)(1+\\zeta z^2)$：\n$$ (\\nabla k) \\cdot (\\nabla T) = \\eta \\beta k_0 \\exp(\\eta x)(1+\\zeta z^2) \\exp(\\alpha t)\\cos(\\beta x)\\cos(\\gamma y)(1+z^2) + 4\\zeta z^2 k_0 \\exp(\\eta x)\\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y) $$\n\n我们组装散度项 $\\nabla \\cdot(k \\nabla T) = (\\nabla k) \\cdot (\\nabla T) + k \\nabla^2 T$。合并表达式并提出公因子 $k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y)$：\n$$ \\nabla \\cdot(k \\nabla T) = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\eta \\beta \\cos(\\beta x)(1+z^2)(1+\\zeta z^2) + 4\\zeta z^2 \\sin(\\beta x) - \\sin(\\beta x)(\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) + 2\\sin(\\beta x)(1+\\zeta z^2) \\bigg] $$\n$$ \\nabla \\cdot(k \\nabla T) = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\eta \\beta \\cos(\\beta x)(1+z^2)(1+\\zeta z^2) + \\sin(\\beta x) \\left( -(\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) + 2(1+\\zeta z^2) + 4\\zeta z^2 \\right) \\bigg] $$\n简化 $\\sin(\\beta x)$ 的括号中的项：$2(1+\\zeta z^2) + 4\\zeta z^2 = 2 + 2\\zeta z^2 + 4\\zeta z^2 = 2+6\\zeta z^2=2(1+3\\zeta z^2)$。\n$$ \\nabla \\cdot(k \\nabla T) = k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\eta \\beta (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) + \\left( 2(1+3\\zeta z^2) - (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) \\right) \\sin(\\beta x) \\bigg] $$\n\n最后，我们将两个主要分量代入 $Q$ 的表达式中：\n$$ Q = \\rho c_p \\frac{\\partial T}{\\partial t} - \\nabla \\cdot (k \\nabla T) $$\n$$ Q = \\rho c_p \\alpha \\exp(\\alpha t)\\sin(\\beta x)\\cos(\\gamma y)(1+z^2) - k_0 \\exp(\\alpha t) \\exp(\\eta x) \\cos(\\gamma y) \\bigg[ \\dots \\bigg] $$\n提出公因子 $\\exp(\\alpha t)\\cos(\\gamma y)$ 并按 $\\sin(\\beta x)$ 和 $\\cos(\\beta x)$ 对各项进行分组：\n$$ Q = \\exp(\\alpha t)\\cos(\\gamma y) \\bigg[ \\rho c_p \\alpha (1+z^2) \\sin(\\beta x) - k_0 \\exp(\\eta x) \\left( \\eta \\beta (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) + \\left( 2(1+3\\zeta z^2) - (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) \\right) \\sin(\\beta x) \\right) \\bigg] $$\n分配负号并对各项进行分组：\n$$ Q(x,y,z,t) = \\exp(\\alpha t)\\cos(\\gamma y) \\bigg[ \\sin(\\beta x) \\left\\{ \\rho c_p \\alpha (1+z^2) + k_0 \\exp(\\eta x) \\left[ (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) - 2(1+3\\zeta z^2) \\right] \\right\\} - k_0 \\beta \\eta \\exp(\\eta x) (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) \\bigg] $$\n这就是体积源项的最终闭式表达式。",
            "answer": "$$\n\\boxed{\n\\exp(\\alpha t)\\cos(\\gamma y) \\left[ \\sin(\\beta x) \\left\\{ \\rho c_p \\alpha (1+z^2) + k_0 \\exp(\\eta x) \\left[ (\\beta^2+\\gamma^2)(1+z^2)(1+\\zeta z^2) - 2(1+3\\zeta z^2) \\right] \\right\\} - k_0 \\beta \\eta \\exp(\\eta x) (1+z^2)(1+\\zeta z^2) \\cos(\\beta x) \\right]\n}\n$$"
        }
    ]
}