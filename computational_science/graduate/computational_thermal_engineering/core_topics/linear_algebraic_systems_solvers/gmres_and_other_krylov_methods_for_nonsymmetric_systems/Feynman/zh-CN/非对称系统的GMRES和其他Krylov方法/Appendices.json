{
    "hands_on_practices": [
        {
            "introduction": "广义最小残差方法（GMRES）是一种迭代方法，它通过构建一个最优多项式来最小化残差。其性能取决于算子的谱以及它能构建的多项式的阶数。此练习  构建了一个精心设计的场景，以探索 GMRES 的基本机制。通过分析一个谱分布简单的案例，您将深刻理解为何重启（一种常用的节省内存的技术）有时会导致停滞并阻碍收敛。",
            "id": "3957964",
            "problem": "考虑一个单位区间上具有狄利克雷边界条件的一维稳态对流-扩散边值问题，该问题使用二阶中心有限差分格式对扩散项进行离散，并使用一阶迎风格式对对流项进行离散。由此产生的线性系统 $A x = b$ 是非对称的。假设选择一个左预条件子 $M$，它能精确地反转扩散部分，但保持对流的斜对称部分不变，并且，在预处理算子 $M^{-1} A$ 的一个不变的二维子空间上，谱紧密地聚集在两个实数值上，具体为 $\\lambda_{+} = 1$ 和 $\\lambda_{-} = -1$。假设，限制在该二维不变子空间上，与 $\\lambda_{+}$ 和 $\\lambda_{-}$ 对应的特征向量 $v_{+}$ 和 $v_{-}$ 是标准正交的，并且初始残差 $r_{0}$ 完全位于该子空间内，且在这些特征向量上的投影相等，即 $r_{0} = c \\, v_{+} + c \\, v_{-}$，其中 $c \\in \\mathbb{R}$ 为某个非零标量。您将不带重启的广义最小残差方法 (GMRES) 应用于预处理系统 $M^{-1} A x = M^{-1} b$，同时还应用重启参数为 $m = 1$ 的重启 GMRES 方法（记为 GMRES($1$)）。\n\n从基本定义出发，即经过 $k$ 步后，GMRES 产生的残差形式为 $r_{k} = p_{k}(M^{-1} A) r_{0}$，其中 $p_{k}$ 是一个满足 $p_{k}(0) = 1$ 的 $k$ 次实多项式，请从第一性原理推导以下两种情况的精确残差范数缩减因子：\n- 不带重启的 GMRES 迭代 $2$ 次后。\n- GMRES($1$) 一个重启周期后。\n\n将每个缩减因子表示为比值 $\\|r\\|_{2} / \\|r_{0}\\|_{2}$，其中 $\\|\\cdot\\|_{2}$ 是欧几里得范数，并将这两个结果以单个 $1 \\times 2$ 行矩阵的形式提供。不需要四舍五入。最终的量是无量纲的；报告时无需单位。",
            "solution": "该问题要求推导广义最小残差 (GMRES) 方法的两种变体应用于特定预处理线性系统时的残差范数缩减因子。我们将从 GMRES 的基本原理出发来处理每种情况。\n\n令预处理算子记为 $B = M^{-1}A$。预处理后的系统为 $B x = M^{-1} b$。我们以一个初始猜测 $x_0$ 和相应的初始残差 $r_0 = M^{-1}b - Bx_0$ 开始迭代。经过 $k$ 次迭代后，不带重启的 GMRES 方法在仿射克里洛夫子空间 $x_0 + \\mathcal{K}_k(B, r_0)$ 中找到一个近似解 $x_k$，其中 $\\mathcal{K}_k(B, r_0) = \\text{span}\\{r_0, Br_0, \\dots, B^{k-1}r_0\\}$，使得相应残差 $r_k = M^{-1}b - Bx_k$ 的欧几里得范数最小化。\n\n残差 $r_k$ 可以用初始残差 $r_0$ 和一个多项式 $p_k$ 来表示。由于 $x_k - x_0 \\in \\mathcal{K}_k(B, r_0)$，我们可以将 $x_k$ 写成 $x_k = x_0 + q_{k-1}(B)r_0$ 的形式，其中 $q_{k-1}$ 是一个次数至多为 $k-1$ 的多项式。于是残差为\n$$r_k = M^{-1}b - B(x_0 + q_{k-1}(B)r_0) = (M^{-1}b - Bx_0) - Bq_{k-1}(B)r_0 = r_0 - Bq_{k-1}(B)r_0$$\n定义残差多项式 $p_k(z) = 1 - z q_{k-1}(z)$，我们看到 $p_k$ 是一个次数至多为 $k$ 且满足约束条件 $p_k(0) = 1$ 的多项式。残差可以写成 $r_k = p_k(B)r_0$。GMRES 找到多项式 $p_k$，在所有次数至多为 $k$ 且满足 $p_k(0)=1$ 的实多项式中，使得 $\\|r_k\\|_2 = \\|p_k(B)r_0\\|_2$ 最小。\n\n根据题目陈述，我们已知 $B$ 有一个二维不变子空间，由分别对应于实特征值 $\\lambda_+ = 1$ 和 $\\lambda_- = -1$ 的两个标准正交特征向量 $v_+$ 和 $v_-$ 张成。初始残差 $r_0$ 完全位于该子空间内：\n$$r_0 = c \\, v_{+} + c \\, v_{-}$$\n其中 $c$ 为某个非零实标量。由于 $r_0$ 在这个不变子空间中，所有后续的残差 $r_k$ 和克里洛夫向量 $B^j r_0$ 也将位于该子空间内。\n\n我们将算子 $p_k(B)$ 应用于 $r_0$。由于 $v_+$ 和 $v_-$ 是 $B$ 的特征向量：\n$$r_k = p_k(B)r_0 = p_k(B)(c v_{+} + c v_{-}) = c \\, p_k(B)v_{+} + c \\, p_k(B)v_{-} = c \\, p_k(\\lambda_{+})v_{+} + c \\, p_k(\\lambda_{-})v_{-}$$\n代入给定的特征值：\n$$r_k = c \\, p_k(1)v_{+} + c \\, p_k(-1)v_{-}$$\n利用 $v_+$ 和 $v_-$ 的标准正交性（即 $\\langle v_+, v_+ \\rangle = 1$, $\\langle v_-, v_- \\rangle = 1$, 和 $\\langle v_+, v_- \\rangle = 0$），可以求得 $r_k$ 的欧几里得范数的平方：\n$$\\|r_k\\|_2^2 = \\langle c \\, p_k(1)v_{+} + c \\, p_k(-1)v_{-}, c \\, p_k(1)v_{+} + c \\, p_k(-1)v_{-} \\rangle$$\n$$\\|r_k\\|_2^2 = c^2 |p_k(1)|^2 \\langle v_+, v_+ \\rangle + c^2 |p_k(-1)|^2 \\langle v_-, v_- \\rangle + 2c^2 p_k(1)p_k(-1) \\langle v_+, v_- \\rangle$$\n$$\\|r_k\\|_2^2 = c^2 (p_k(1)^2 + p_k(-1)^2)$$\n初始残差 $r_0$ 的范数平方为：\n$$\\|r_0\\|_2^2 = \\langle c v_{+} + c v_{-}, c v_{+} + c v_{-} \\rangle = c^2 \\langle v_+, v_+ \\rangle + c^2 \\langle v_-, v_- \\rangle + 2c^2 \\langle v_+, v_- \\rangle = c^2(1) + c^2(1) + 0 = 2c^2$$\n经过 $k$ 步后的残差范数缩减因子为 $\\frac{\\|r_k\\|_2}{\\|r_0\\|_2}$。其平方为：\n$$\\left( \\frac{\\|r_k\\|_2}{\\|r_0\\|_2} \\right)^2 = \\frac{c^2 (p_k(1)^2 + p_k(-1)^2)}{2c^2} = \\frac{p_k(1)^2 + p_k(-1)^2}{2}$$\nGMRES 找到使该表达式最小化的多项式 $p_k$。\n\n**情况1：不带重启的 GMRES 迭代 2 次后 ($k=2$)**\n我们在寻找一个次数至多为 $2$ 且满足 $p_2(0)=1$ 的多项式 $p_2(z)$，以最小化 $\\frac{p_2(1)^2 + p_2(-1)^2}{2}$。为了最小化这个平方和，我们理想情况下应选择 $p_2(z)$ 使得 $p_2(1)=0$ 和 $p_2(-1)=0$。\n让我们构造这样一个多项式。其根为 $1$ 和 $-1$。该多项式的形式必须是 $p_2(z) = \\gamma (z-1)(z+1)$，其中 $\\gamma$ 是某个常数。我们使用约束条件 $p_2(0)=1$ 来确定 $\\gamma$：\n$$p_2(0) = \\gamma (0-1)(0+1) = -\\gamma = 1 \\implies \\gamma = -1$$\n因此，最优多项式为 $p_2(z) = -(z^2-1) = 1-z^2$。这是一个满足 $p_2(0)=1$ 的 2 次多项式，因此是 GMRES(2) 的一个有效候选。\n使用这个多项式，我们有 $p_2(1) = 0$ 和 $p_2(-1) = 0$。缩减因子的平方的最小值为：\n$$\\left( \\frac{\\|r_2\\|_2}{\\|r_0\\|_2} \\right)^2 = \\frac{0^2 + 0^2}{2} = 0$$\n因此，缩减因子为 $0$。这表明对于这个特定的问题设置，GMRES 在两次迭代内收敛到精确解。\n\n**情况2：GMRES(1) 一个重启周期后**\nGMRES(1) 包括运行单步 GMRES ($k=1$) 然后重启。“一个重启周期后”的缩减因子指的是在这单步中实现的缩减。我们需要找到一个次数至多为 $1$ 且满足 $p_1(0)=1$ 的最优多项式 $p_1(z)$，以最小化缩减因子。\n一个次数至多为 $1$ 且满足 $p_1(0)=1$ 的多项式具有一般形式 $p_1(z) = 1 - \\alpha z$，其中 $\\alpha$ 是某个实系数。\n我们需要找到 $\\alpha$ 的值，以最小化量 $\\frac{p_1(1)^2 + p_1(-1)^2}{2}$。\n$$p_1(1) = 1 - \\alpha$$\n$$p_1(-1) = 1 - \\alpha(-1) = 1 + \\alpha$$\n需要最小化的表达式是 $\\alpha$ 的函数：\n$$f(\\alpha) = \\frac{(1-\\alpha)^2 + (1+\\alpha)^2}{2} = \\frac{(1 - 2\\alpha + \\alpha^2) + (1 + 2\\alpha + \\alpha^2)}{2} = \\frac{2 + 2\\alpha^2}{2} = 1 + \\alpha^2$$\n为了最小化 $f(\\alpha)$，我们通过对 $\\alpha$求导并令其为零来找到临界点：\n$$f'(\\alpha) = 2\\alpha = 0 \\implies \\alpha = 0$$\n$\\alpha=0$ 这个选择可以最小化 $f(\\alpha)$。最小值为 $f(0) = 1+0^2=1$。\n最小的缩减因子平方为 $1$。因此，缩减因子为 $\\sqrt{1} = 1$。\n这意味着经过一步 GMRES 后，残差范数根本没有减小；$\\|r_1\\|_2 = \\|r_0\\|_2$。该方法停滞不前。这是因为最优多项式是 $p_1(z)=1$，这对应于不进行更新（$x_1=x_0$ 和 $r_1=r_0$）。\n\n综合这些结果，不带重启的 GMRES 迭代 2 次后的缩减因子为 $0$，而 GMRES(1) 一个周期后的缩减因子为 $1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "预处理是加速 GMRES 的关键，但在左预处理和右预处理之间的选择会带来微妙的后果。左预处理改变了最小化残差时所采用的范数，而右预处理则不会。本实践  使用一个源自对流扩散问题的简单实例，来展示这一关键差异。您将计算出左预处理如何可能获得更小的预处理后残差范数，但当以物理上有意义的能量范数衡量时，其解的近似效果反而可能更差，这突显了选择与模拟物理目标相符的预处理策略的重要性。",
            "id": "3958007",
            "problem": "考虑一个由傅里叶热传导定律和线性平流控制的稳态一维平流-扩散温度模型。在两个内部控制体积上进行二阶有限体积或有限差分离散化，得到一个对称正定（SPD）的传导刚度矩阵 $K$ 和一个上三角对流矩阵 $C$，因此总算子为 $A = K + C$。取\n$$\nK = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}, \\quad C = \\begin{pmatrix}0  3 \\\\ 0  0\\end{pmatrix}, \\quad A = \\begin{pmatrix}2  2 \\\\ -1  2\\end{pmatrix},\n$$\n给定的源项向量为\n$$\nb = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}.\n$$\n定义由传导引起的物理能量范数为 $\\|v\\|_{E} = \\sqrt{v^{\\top} K v}$，这与传导能量泛函的离散形式 $E(x) = \\frac{1}{2} x^{\\top} K x - b^{\\top} x$ 一致。考虑对非对称线性系统 $A x = b$ 从零初始猜测开始进行一次迭代的广义最小残差（GMRES）方法，使用两种不同的预处理：\n- 左预处理，其中 $M_{L} = \\operatorname{diag}(A)$，因此求解的系统是 $M_{L}^{-1} A x = M_{L}^{-1} b$，GMRES 最小化 $\\|M_{L}^{-1} r\\|_{2}$，其中 $r = b - A x$。\n- 右预处理，其中 $M_{R} = K$，因此求解的系统是 $A M_{R}^{-1} y = b$ 且 $x = M_{R}^{-1} y$，GMRES 最小化 $\\|r\\|_{2}$。\n\n令 $x_{L}$ 和 $x_{R}$ 分别为在左预处理和右预处理下获得的单次迭代 GMRES 近似解，令 $r_{L} = b - A x_{L}$ 和 $r_{R} = b - A x_{R}$ 为相应的残差。令能量梯度方向为 $g_{E,L} = b - K x_{L}$ 和 $g_{E,R} = b - K x_{R}$。为了量化“与物理能量范数的相关性”，使用 $K$-内积中的余弦，\n$$\n\\cos_{K}(u,v) = \\frac{u^{\\top} K v}{\\sqrt{u^{\\top} K u} \\, \\sqrt{v^{\\top} K v}}.\n$$\n计算比率\n$$\n\\rho = \\frac{\\cos_{K}(r_{R}, g_{E,R})}{\\cos_{K}(r_{L}, g_{E,L})}.\n$$\n将您的最终答案表示为简化的精确解析表达式。不需要四舍五入。",
            "solution": "控制物理基础是傅里叶热传导定律和线性平流。在离散设置中，对称正定（SPD）传导矩阵 $K$ 代表与能量范数 $\\|v\\|_{E} = \\sqrt{v^{\\top} K v}$ 相关联的双线性形式，而平流贡献 $C$ 引入了非对称性，因此 $A = K + C$。\n\n我们分析从 $x_{0} = 0$ 开始，在左预处理和右预处理下进行一次广义最小残差（GMRES）迭代。\n\n右预处理，其中 $M_{R} = K$：我们求解 $A M_{R}^{-1} y = b$ 并设 $x = M_{R}^{-1} y$。在一次 GMRES 迭代中，$y$ 位于 $\\operatorname{span}\\{b\\}$ 中，因此 $y = \\alpha b$，从而得到 $x = \\alpha K^{-1} b$。残差为\n$$\nr_{R} = b - A x = b - \\alpha A K^{-1} b.\n$$\nGMRES 步骤选择 $\\alpha$ 来最小化 $\\|r_{R}\\|_{2}$，这给出\n$$\n\\alpha_{R} = \\frac{b^{\\top} (A K^{-1} b)}{\\|A K^{-1} b\\|_{2}^{2}}.\n$$\n计算 $K^{-1}$ 和所需量。由于\n$$\nK = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}, \\quad \\det(K) = 3, \\quad K^{-1} = \\frac{1}{3} \\begin{pmatrix}2  1 \\\\ 1  2\\end{pmatrix},\n$$\n我们有\n$$\nK^{-1} b = \\frac{1}{3} \\begin{pmatrix}1 \\\\ 2\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{3} \\\\ \\frac{2}{3}\\end{pmatrix},\n\\quad\nA K^{-1} b = \\begin{pmatrix}2  2 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}\\frac{1}{3} \\\\ \\frac{2}{3}\\end{pmatrix}\n= \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}.\n$$\n因此\n$$\n\\alpha_{R} = \\frac{b^{\\top} (A K^{-1} b)}{\\|A K^{-1} b\\|_{2}^{2}} = \\frac{\\begin{pmatrix}0  1\\end{pmatrix} \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}}{2^{2} + 1^{2}} = \\frac{1}{5}.\n$$\n所以\n$$\nx_{R} = \\alpha_{R} K^{-1} b = \\frac{1}{5} \\cdot \\frac{1}{3} \\begin{pmatrix}1 \\\\ 2\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{15} \\\\ \\frac{2}{15}\\end{pmatrix}.\n$$\n计算残差和能量梯度方向：\n$$\nA x_{R} = \\begin{pmatrix}2  2 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}\\frac{1}{15} \\\\ \\frac{2}{15}\\end{pmatrix}\n= \\begin{pmatrix}\\frac{2}{15} + \\frac{4}{15} \\\\ -\\frac{1}{15} + \\frac{4}{15}\\end{pmatrix}\n= \\begin{pmatrix}\\frac{2}{5} \\\\ \\frac{1}{5}\\end{pmatrix},\n$$\n$$\nr_{R} = b - A x_{R} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\begin{pmatrix}\\frac{2}{5} \\\\ \\frac{1}{5}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{2}{5} \\\\ \\frac{4}{5}\\end{pmatrix},\n$$\n$$\nK x_{R} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}\\frac{1}{15} \\\\ \\frac{2}{15}\\end{pmatrix}\n= \\begin{pmatrix}\\frac{2}{15} - \\frac{2}{15} \\\\ -\\frac{1}{15} + \\frac{4}{15}\\end{pmatrix}\n= \\begin{pmatrix}0 \\\\ \\frac{1}{5}\\end{pmatrix},\n$$\n$$\ng_{E,R} = b - K x_{R} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\begin{pmatrix}0 \\\\ \\frac{1}{5}\\end{pmatrix}\n= \\begin{pmatrix}0 \\\\ \\frac{4}{5}\\end{pmatrix}.\n$$\n$K$-内积余弦为\n$$\n\\cos_{K}(r_{R}, g_{E,R}) = \\frac{r_{R}^{\\top} K g_{E,R}}{\\sqrt{r_{R}^{\\top} K r_{R}} \\, \\sqrt{g_{E,R}^{\\top} K g_{E,R}}}.\n$$\n计算所需的项：\n$$\nK g_{E,R} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}0 \\\\ \\frac{4}{5}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{4}{5} \\\\ \\frac{8}{5}\\end{pmatrix},\n$$\n$$\nr_{R}^{\\top} K g_{E,R} = \\begin{pmatrix}-\\frac{2}{5}  \\frac{4}{5}\\end{pmatrix} \\begin{pmatrix}-\\frac{4}{5} \\\\ \\frac{8}{5}\\end{pmatrix}\n= \\frac{8}{25} + \\frac{32}{25} = \\frac{40}{25} = \\frac{8}{5},\n$$\n$$\nK r_{R} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}-\\frac{2}{5} \\\\ \\frac{4}{5}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{8}{5} \\\\ 2\\end{pmatrix},\n\\quad\nr_{R}^{\\top} K r_{R} = \\begin{pmatrix}-\\frac{2}{5}  \\frac{4}{5}\\end{pmatrix} \\begin{pmatrix}-\\frac{8}{5} \\\\ 2\\end{pmatrix}\n= \\frac{16}{25} + \\frac{8}{5} = \\frac{56}{25},\n$$\n$$\ng_{E,R}^{\\top} K g_{E,R} = \\begin{pmatrix}0  \\frac{4}{5}\\end{pmatrix} \\begin{pmatrix}-\\frac{4}{5} \\\\ \\frac{8}{5}\\end{pmatrix}\n= \\frac{32}{25}.\n$$\n因此\n$$\n\\cos_{K}(r_{R}, g_{E,R}) = \\frac{\\frac{8}{5}}{\\sqrt{\\frac{56}{25}} \\, \\sqrt{\\frac{32}{25}}}\n= \\frac{\\frac{8}{5}}{\\frac{\\sqrt{56}}{5} \\cdot \\frac{\\sqrt{32}}{5}}\n= \\frac{40}{\\sqrt{56}\\sqrt{32}}\n= \\frac{40}{\\sqrt{1792}}\n= \\frac{40}{16 \\sqrt{7}}\n= \\frac{5}{2 \\sqrt{7}}.\n$$\n\n左预处理，其中 $M_{L} = \\operatorname{diag}(A) = \\begin{pmatrix}2  0 \\\\ 0  2\\end{pmatrix}$：我们用 GMRES 求解 $M_{L}^{-1} A x = M_{L}^{-1} b$。在一次迭代中，$x$ 位于 $\\operatorname{span}\\{M_{L}^{-1} b\\}$ 中，因此 $x = \\alpha M_{L}^{-1} b$。GMRES 步骤选择 $\\alpha$ 来最小化 $\\|M_{L}^{-1} r\\|_{2} = \\|M_{L}^{-1}(b - A x)\\|_{2}$，这等价于最小化 $\\|c - \\alpha q\\|_{2}$，其中\n$$\nc = M_{L}^{-1} b, \\quad q = M_{L}^{-1} A M_{L}^{-1} b.\n$$\n计算 $M_{L}^{-1} = \\frac{1}{2} I$ 因此\n$$\nc = \\frac{1}{2} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}0 \\\\ \\frac{1}{2}\\end{pmatrix}, \\quad\nq = \\frac{1}{2} A \\left(\\frac{1}{2} b\\right) = \\frac{1}{4} A b = \\frac{1}{4} \\begin{pmatrix}2 \\\\ 2\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}.\n$$\n因此，\n$$\n\\alpha_{L} = \\frac{c^{\\top} q}{\\|q\\|_{2}^{2}} = \\frac{\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right)}{\\left(\\frac{1}{2}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2}} = \\frac{\\frac{1}{4}}{\\frac{1}{2}} = \\frac{1}{2}.\n$$\n然后\n$$\nx_{L} = \\alpha_{L} M_{L}^{-1} b = \\frac{1}{2} \\begin{pmatrix}0 \\\\ \\frac{1}{2}\\end{pmatrix} = \\begin{pmatrix}0 \\\\ \\frac{1}{4}\\end{pmatrix},\n$$\n以及\n$$\nA x_{L} = \\begin{pmatrix}2  2 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}0 \\\\ \\frac{1}{4}\\end{pmatrix}\n= \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}, \\quad\nr_{L} = b - A x_{L} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}.\n$$\n能量梯度方向为\n$$\nK x_{L} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}0 \\\\ \\frac{1}{4}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{1}{4} \\\\ \\frac{1}{2}\\end{pmatrix}, \\quad\ng_{E,L} = b - K x_{L} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\begin{pmatrix}-\\frac{1}{4} \\\\ \\frac{1}{2}\\end{pmatrix}\n= \\begin{pmatrix}\\frac{1}{4} \\\\ \\frac{1}{2}\\end{pmatrix}.\n$$\n计算 $K$-余弦：\n$$\nK g_{E,L} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}\\frac{1}{4} \\\\ \\frac{1}{2}\\end{pmatrix}\n= \\begin{pmatrix}0 \\\\ \\frac{3}{4}\\end{pmatrix},\n$$\n$$\nr_{L}^{\\top} K g_{E,L} = \\begin{pmatrix}-\\frac{1}{2}  \\frac{1}{2}\\end{pmatrix} \\begin{pmatrix}0 \\\\ \\frac{3}{4}\\end{pmatrix} = \\frac{3}{8},\n$$\n$$\nK r_{L} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}-\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{3}{2} \\\\ \\frac{3}{2}\\end{pmatrix}, \\quad\nr_{L}^{\\top} K r_{L} = \\begin{pmatrix}-\\frac{1}{2}  \\frac{1}{2}\\end{pmatrix} \\begin{pmatrix}-\\frac{3}{2} \\\\ \\frac{3}{2}\\end{pmatrix} = \\frac{3}{2},\n$$\n$$\ng_{E,L}^{\\top} K g_{E,L} = \\begin{pmatrix}\\frac{1}{4}  \\frac{1}{2}\\end{pmatrix} \\begin{pmatrix}0 \\\\ \\frac{3}{4}\\end{pmatrix} = \\frac{3}{8}.\n$$\n因此，\n$$\n\\cos_{K}(r_{L}, g_{E,L}) = \\frac{\\frac{3}{8}}{\\sqrt{\\frac{3}{2}} \\, \\sqrt{\\frac{3}{8}}}\n= \\frac{\\frac{3}{8}}{\\sqrt{\\frac{9}{16}}}\n= \\frac{\\frac{3}{8}}{\\frac{3}{4}}\n= \\frac{1}{2}.\n$$\n\n所求的比率为\n$$\n\\rho = \\frac{\\cos_{K}(r_{R}, g_{E,R})}{\\cos_{K}(r_{L}, g_{E,L})}\n= \\frac{\\frac{5}{2 \\sqrt{7}}}{\\frac{1}{2}}\n= \\frac{5}{\\sqrt{7}}.\n$$\n\n为了完整性，我们在此单次迭代比较中，通过计算使用 $M_{L}^{-1}$ 的预处理残差范数，来确认左预处理确实“更快地最小化了预处理范数”：\n$$\n\\|M_{L}^{-1} r_{L}\\|_{2} = \\left\\|\\frac{1}{2} \\begin{pmatrix}-\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}\\right\\|_{2}\n= \\left\\|\\begin{pmatrix}-\\frac{1}{4} \\\\ \\frac{1}{4}\\end{pmatrix}\\right\\|_{2}\n= \\sqrt{\\frac{1}{16} + \\frac{1}{16}}\n= \\sqrt{\\frac{1}{8}}\n= \\frac{1}{2 \\sqrt{2}},\n$$\n$$\n\\|M_{L}^{-1} r_{R}\\|_{2} = \\left\\|\\frac{1}{2} \\begin{pmatrix}-\\frac{2}{5} \\\\ \\frac{4}{5}\\end{pmatrix}\\right\\|_{2}\n= \\left\\|\\begin{pmatrix}-\\frac{1}{5} \\\\ \\frac{2}{5}\\end{pmatrix}\\right\\|_{2}\n= \\sqrt{\\frac{1}{25} + \\frac{4}{25}}\n= \\sqrt{\\frac{1}{5}}\n= \\frac{1}{\\sqrt{5}},\n$$\n并且确实 $\\frac{1}{2 \\sqrt{2}}  \\frac{1}{\\sqrt{5}}$，因此一次迭代后，左预处理残差在预处理范数下更小，而其与物理能量范数的相关性则更差，因为 $\\cos_{K}(r_{L}, g_{E,L}) = \\frac{1}{2}  \\cos_{K}(r_{R}, g_{E,R}) = \\frac{5}{2 \\sqrt{7}}$。比率 $\\rho$ 量化了这一差异。",
            "answer": "$$\\boxed{\\frac{5}{\\sqrt{7}}}$$"
        },
        {
            "introduction": "在热工领域常见的大规模非线性问题中，GMRES 通常被用于牛顿-克里洛夫（Newton-Krylov）框架内，其中雅可比矩阵从不被显式构建。取而代之的是，其与向量的乘积通过有限差分进行近似。此问题  深入探讨了这种“无矩阵”方法的核心。您将推导出一个最优的扰动参数 $\\epsilon$，它能够平衡截断误差和浮点舍入误差之间的权衡，这是实现稳健高效的牛顿-克里洛夫求解器的关键技能。",
            "id": "3958015",
            "problem": "一个带有辐射边界条件的稳态对流扩散传热问题的有限体积离散化，导出一个非线性残差映射 $F:\\mathbb{R}^{n}\\to\\mathbb{R}^{n}$，其中 $x\\in\\mathbb{R}^{n}$ 汇集了节点温度。由于上风格式的对流项和非线性辐射，残差 $F(x)$ 是非对称的，并且在使用牛顿-克里洛夫（Newton-Krylov）框架中的广义最小残差方法（GMRES）求解时，其雅可比矩阵 $J(x)\\in\\mathbb{R}^{n\\times n}$ 不会被显式地构造出来。取而代之的是，通过方向扰动来近似一个无需矩阵的雅可比-向量积。\n\n从 $F$ 在 $x$ 处的 Fréchet 可微性出发，使用 Fréchet 导数的定义，推导方向导数 $J(x)v$ 的前向差分近似。其中方向 $v\\in\\mathbb{R}^{n}$ 为任意的单位欧几里得范数方向，即 $\\|v\\|_{2}=1$：\n$$\nJ(x)v \\approx \\frac{F(x+\\epsilon v)-F(x)}{\\epsilon}.\n$$\n假设 $F$ 在 $x$ 的一个邻域内是二次连续可微的，并且在该邻域内其二阶导数的算子范数有界，由一个常数 $M0$ 量化，使得对于所有邻近 $x$ 的 $y$ 和所有 $w\\in\\mathbb{R}^{n}$，\n$$\n\\|D^{2}F(y)[w,w]\\|_{2}\\leq M\\|w\\|_{2}^{2}.\n$$\n将单位舍入误差为 $u0$ 的 $F$ 的浮点求值建模如下：一个计算出的函数值 $\\widehat{F}(y)$ 满足 $\\|\\widehat{F}(y)-F(y)\\|_{2}\\leq u\\,B$，对于该邻域中的所有 $y$，其中 $B0$ 是该邻域内 $F(y)$ 量级的一个已知界。计算出的有限差分雅可比-向量积为\n$$\n\\widehat{Jv}_{\\epsilon}=\\frac{\\widehat{F}(x+\\epsilon v)-\\widehat{F}(x)}{\\epsilon}.\n$$\n使用这些假设，将 $\\widehat{Jv}_{\\epsilon}$ 中的总误差界定为截断误差和浮点贡献之和，并推导出一个形式如下的标量上界\n$$\n\\|\\widehat{Jv}_{\\epsilon}-J(x)v\\|_{2}\\leq \\frac{M}{2}\\,\\epsilon + \\frac{C\\,u}{\\epsilon},\n$$\n其中某个常数 $C0$ 应以 $B$ 和通用不等式表示。然后，通过最小化此上界（相对于正标量 $\\epsilon$），推导出在前向差分近似中平衡截断误差和舍入误差的最优步长 $\\epsilon^{\\star}$ 的解析表达式。你的最终答案必须是 $\\epsilon^{\\star}$ 关于 $M$、$u$ 和 $C$ 的封闭形式表达式，并且必须是精确的（没有数值计算或四舍五入）。最终表达式中不需要物理单位。\n\n除了推导过程，请利用所述假设，简要讨论在牛顿-克里洛夫方法中用于非对称热系统时，$\\epsilon$ 的选择如何影响 GMRES 的准确性和数值稳定性。讨论应是定性的，但要基于你所推导的定量界限。最终报告的答案必须仅为 $\\epsilon^{\\star}$ 的解析表达式。",
            "solution": "该问题要求推导一个最优步长 $\\epsilon^{\\star}$，用于雅可比-向量积的前向差分近似。此近似在牛顿-克里洛夫框架内使用，以解决一个由计算热工问题产生的非线性系统。\n\n首先，我们验证问题陈述的有效性。\n该问题设定在传热数值模拟的背景下，采用了像牛顿-克里洛夫-GMRES算法这样的标准、成熟的数值方法。所有提供的信息在科学上都是合理的，在数学上是一致的。所做的假设——Fréchet可微性、有界的二阶导数以及浮点误差的标准模型——都是数值微分分析中的典型假设。该问题是适定的、客观的，并包含足够的信息以获得唯一解。因此，该问题被认为是有效的，并将推导求解。\n\n计算出的雅可比-向量积 $\\widehat{Jv}_{\\epsilon}$ 的总误差是计算近似值与真实值之差的范数，即 $\\|\\widehat{Jv}_{\\epsilon} - J(x)v\\|_{2}$。我们可以通过引入精确的有限差分近似作为中间项，并应用三角不等式来分解这个误差：\n$$\n\\|\\widehat{Jv}_{\\epsilon} - J(x)v\\|_{2} = \\left\\| \\left(\\frac{\\widehat{F}(x+\\epsilon v)-\\widehat{F}(x)}{\\epsilon}\\right) - J(x)v \\right\\|_{2}\n$$\n$$\n= \\left\\| \\left(\\frac{\\widehat{F}(x+\\epsilon v)-\\widehat{F}(x)}{\\epsilon} - \\frac{F(x+\\epsilon v)-F(x)}{\\epsilon}\\right) + \\left(\\frac{F(x+\\epsilon v)-F(x)}{\\epsilon} - J(x)v\\right) \\right\\|_{2}\n$$\n$$\n\\leq \\left\\| \\frac{(\\widehat{F}(x+\\epsilon v) - F(x+\\epsilon v)) - (\\widehat{F}(x) - F(x))}{\\epsilon} \\right\\|_{2} + \\left\\| \\frac{F(x+\\epsilon v)-F(x)}{\\epsilon} - J(x)v \\right\\|_{2}\n$$\n第一项代表浮点舍入误差的贡献，而第二项是有限差分近似固有的截断误差。我们将分别对每一项进行界定。\n\n我们首先分析截断误差项：\n$$\nE_{trunc} = \\left\\| \\frac{F(x+\\epsilon v)-F(x)}{\\epsilon} - J(x)v \\right\\|_{2}\n$$\n问题陈述 $F$ 在 $x$ 的一个邻域内是二次连续可微的。这允许我们对向量值函数 $F(x+\\epsilon v)$ 在 $x$ 周围使用泰勒展开。令 $h = \\epsilon v$。带有余项的泰勒展开为：\n$$\nF(x+h) = F(x) + DF(x)h + R_{1}(x,h)\n$$\n其中 $DF(x)$ 是 $F$ 在 $x$ 处的 Fréchet 导数，也即是雅可比矩阵 $J(x)$。余项 $R_{1}(x,h)$ 可以用二阶导数来界定。对于一个二次连续可微的函数，向量值函数的泰勒定理的一个标准形式给出：\n$$\nF(x+\\epsilon v) = F(x) + J(x)(\\epsilon v) + \\int_{0}^{1}(1-t)D^{2}F(x+t\\epsilon v)[\\epsilon v, \\epsilon v] dt\n$$\n由于 $J(x)$ 是一个线性算子（矩阵），$J(x)(\\epsilon v) = \\epsilon J(x)v$。双线性形式 $D^{2}F$ 也是2次齐次的，所以 $D^{2}F(y)[\\epsilon v, \\epsilon v] = \\epsilon^{2}D^{2}F(y)[v,v]$。\n将这些代入泰勒展开式得到：\n$$\nF(x+\\epsilon v) = F(x) + \\epsilon J(x)v + \\epsilon^{2}\\int_{0}^{1}(1-t)D^{2}F(x+t\\epsilon v)[v,v] dt\n$$\n重新整理以匹配截断误差的形式：\n$$\n\\frac{F(x+\\epsilon v)-F(x)}{\\epsilon} - J(x)v = \\epsilon\\int_{0}^{1}(1-t)D^{2}F(x+t\\epsilon v)[v,v] dt\n$$\n对两边取欧几里得范数，并对积分使用三角不等式：\n$$\nE_{trunc} = \\left\\| \\epsilon\\int_{0}^{1}(1-t)D^{2}F(x+t\\epsilon v)[v,v] dt \\right\\|_{2} \\leq \\epsilon\\int_{0}^{1}(1-t)\\left\\|D^{2}F(x+t\\epsilon v)[v,v]\\right\\|_{2} dt\n$$\n我们已知对于一个常数 $M0$，有 $\\|D^{2}F(y)[w,w]\\|_{2} \\leq M\\|w\\|_{2}^{2}$。在我们的例子中，$w=v$，并且已知 $\\|v\\|_{2}=1$。因此，$\\|D^{2}F(x+t\\epsilon v)[v,v]\\|_{2} \\leq M\\|v\\|_{2}^{2} = M$。\n截断误差的上界变为：\n$$\nE_{trunc} \\leq \\epsilon\\int_{0}^{1}(1-t)M dt = \\epsilon M \\left[t-\\frac{t^2}{2}\\right]_{0}^{1} = \\epsilon M \\left(1-\\frac{1}{2}\\right) = \\frac{M\\epsilon}{2}\n$$\n\n接下来，我们分析舍入误差项：\n$$\nE_{round} = \\left\\| \\frac{(\\widehat{F}(x+\\epsilon v) - F(x+\\epsilon v)) - (\\widehat{F}(x) - F(x))}{\\epsilon} \\right\\|_{2}\n$$\n令函数求值中的误差为 $e(y) = \\widehat{F}(y) - F(y)$。问题给出了界 $\\|e(y)\\|_{2} \\leq uB$，其中 $B0$ 是一个常数。应用此界，我们有 $\\|e(x+\\epsilon v)\\|_{2} \\leq uB$ 和 $\\|e(x)\\|_{2} \\leq uB$。\n对分子使用三角不等式：\n$$\n\\|e(x+\\epsilon v) - e(x)\\|_{2} \\leq \\|e(x+\\epsilon v)\\|_{2} + \\|e(x)\\|_{2} \\leq uB + uB = 2uB\n$$\n因此，舍入误差的上界为：\n$$\nE_{round} \\leq \\frac{2uB}{\\epsilon}\n$$\n结合两个误差界，总误差的上界为：\n$$\n\\|\\widehat{Jv}_{\\epsilon} - J(x)v\\|_{2} \\leq E_{trunc} + E_{round} \\leq \\frac{M\\epsilon}{2} + \\frac{2uB}{\\epsilon}\n$$\n这与目标形式 $\\|\\widehat{Jv}_{\\epsilon}-J(x)v\\|_{2}\\leq \\frac{M}{2}\\,\\epsilon + \\frac{C\\,u}{\\epsilon}$ 相匹配，其中常数 $C=2B$。\n\n现在，我们通过最小化总误差界（相对于 $\\epsilon  0$）来找到最优步长 $\\epsilon^{\\star}$。令误差界函数为 $E(\\epsilon)$：\n$$\nE(\\epsilon) = \\frac{M\\epsilon}{2} + \\frac{Cu}{\\epsilon}\n$$\n为了找到最小值，我们计算关于 $\\epsilon$ 的导数并将其设为零：\n$$\n\\frac{dE}{d\\epsilon} = \\frac{M}{2} - \\frac{Cu}{\\epsilon^{2}}\n$$\n设 $\\frac{dE}{d\\epsilon} = 0$：\n$$\n\\frac{M}{2} = \\frac{Cu}{\\epsilon^{2}} \\implies \\epsilon^{2} = \\frac{2Cu}{M}\n$$\n由于 $\\epsilon$ 必须是正数，我们取正平方根：\n$$\n\\epsilon^{\\star} = \\sqrt{\\frac{2Cu}{M}}\n$$\n为了确认这是一个最小值，我们检查二阶导数：\n$$\n\\frac{d^{2}E}{d\\epsilon^{2}} = \\frac{2Cu}{\\epsilon^{3}}\n$$\n因为 $C0$，$u0$ 且 $\\epsilon0$，我们有 $\\frac{d^{2}E}{d\\epsilon^{2}}  0$，这证实了 $\\epsilon^{\\star}$ 对应一个局部最小值。\n\n最后，我们讨论 $\\epsilon$ 的作用。扰动步长 $\\epsilon$ 的选择是截断误差和舍入误差之间的一个关键权衡。\n推导出的误差界 $E(\\epsilon)$ 定量地说明了这种权衡。\n对于大的 $\\epsilon$，截断误差项 $\\frac{M\\epsilon}{2}$ 占主导地位。这个误差的产生是因为有限差分公式是基于对非线性函数 $F$ 的线性近似，而随着步长的增加，这种近似变得不那么准确。\n对于小的 $\\epsilon$，舍入误差项 $\\frac{Cu}{\\epsilon}$ 占主导地位。这个误差源于分子 $\\widehat{F}(x+\\epsilon v) - \\widehat{F}(x)$ 浮点计算中的相减抵消。当 $\\epsilon$ 非常小时，$x+\\epsilon v$ 非常接近 $x$，因此 $\\widehat{F}(x+\\epsilon v)$ 非常接近 $\\widehat{F}(x)$。两个几乎相等的数相减会导致有效数字的损失，而这个损失又被除以小数 $\\epsilon$ 所放大。\n\n最优步长 $\\epsilon^{\\star}$ 平衡了这两个相互竞争的误差源，从而为雅可比-向量积近似实现可能的最大精度。该乘积的精度直接影响牛顿-克里洛夫方法中内部 GMRES 求解器的性能。如果雅可比-向量积不准确（即，如果选择的 $\\epsilon$ 远离 $\\epsilon^{\\star}$），那么 GMRES 应用的算子将是真实雅可比矩阵 $J(x)$ 的一个显著扰动。这会降低 GMRES 的收敛速度，需要更多次迭代才能满足线性求解的指定容差。在严重的情况下，它可能导致 GMRES 迭代停滞或失败，进而导致外部的牛顿迭代失败。因此，选择接近最优值的 $\\epsilon$ 对于牛顿-克里洛夫算法在求解非对称热系统时的整体鲁棒性和效率至关重要。推导出的公式表明 $\\epsilon^\\star$ 与 $\\sqrt{u}$ 成正比，这是数值分析中一个众所周知的结果，证实了最优选择远大于机器单位舍入 $u$。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{2Cu}{M}}}\n$$"
        }
    ]
}