{
    "hands_on_practices": [
        {
            "introduction": "GMRES方法的核心在于，在Krylov子空间中寻找一个最优的多项式，以最小化残差范数。理解这一基本原理对于深入掌握GMRES的行为至关重要。本练习  设计了一个巧妙的思维实验，通过构建一个特殊的二维不变子空间，它将揭示GMRES是如何通过构建多项式来“消灭”特征值分量的，并清晰地展示了重启动（一种为节省内存而广泛使用的技术）可能如何阻碍收敛。",
            "id": "3957964",
            "problem": "考虑一个在单位区间上、具有狄利克雷边界条件的一维稳态平流扩散边值问题，该问题通过用于扩散项的二阶中心有限差分格式和用于平流项的一阶迎风格式进行离散化。由此得到的线性系统 $A x = b$ 是非对称的。假设选择一个左预条件子 $M$，它能精确地对扩散部分求逆，但保持对流斜对称部分不变，并且在预处理算子 $M^{-1} A$ 的一个不变二维子空间上，其谱紧密地聚集在两个实数值上，具体为 $\\lambda_{+} = 1$ 和 $\\lambda_{-} = -1$。假设，限制在该二维不变子空间内，与 $\\lambda_{+}$ 和 $\\lambda_{-}$ 对应的特征向量 $v_{+}$ 和 $v_{-}$ 是标准正交的，并且初始残差 $r_{0}$ 完全位于该子空间内，且在这些特征向量上的投影相等，即对于某个非零标量 $c \\in \\mathbb{R}$，有 $r_{0} = c \\, v_{+} + c \\, v_{-}$。您将不带重启的广义最小残差方法 (GMRES) 应用于预处理系统 $M^{-1} A x = M^{-1} b$，同时也应用重启参数为 $m = 1$ 的重启 GMRES 方法（记为 GMRES($1$)）。\n\n从 GMRES 的基本定义（即经过 $k$ 步迭代后，产生形式为 $r_{k} = p_{k}(M^{-1} A) r_{0}$ 的残差，其中 $p_{k}$ 是一个满足 $p_{k}(0) = 1$ 的 $k$ 次实多项式）出发，从第一性原理推导以下两种情况的精确残差范数缩减因子：\n- 不带重启的 GMRES 迭代 $2$ 次后。\n- GMRES($1$) 一个重启周期后。\n\n将每个缩减因子表示为比率 $\\|r\\|_{2} / \\|r_{0}\\|_{2}$，其中 $\\|\\cdot\\|_{2}$ 是欧几里得范数，并将这两个结果以单个 $1 \\times 2$ 行矩阵的形式提供。无需四舍五入。最终的量是无量纲的；报告时无需单位。",
            "solution": "该问题要求推导广义最小残差 (GMRES) 方法的两种变体应用于一个特定预处理线性系统时的残差范数缩减因子。我们将从 GMRES 的基本原理出发来处理每一种情况。\n\n设预处理算子记为 $B = M^{-1}A$。预处理后的系统为 $B x = M^{-1} b$。我们从一个初始猜测值 $x_0$ 和相应的初始残差 $r_0 = M^{-1}b - Bx_0$ 开始迭代。经过 $k$ 次迭代后，不带重启的 GMRES 方法在仿射克雷洛夫子空间 $x_0 + \\mathcal{K}_k(B, r_0)$ 中找到一个近似解 $x_k$，其中 $\\mathcal{K}_k(B, r_0) = \\text{span}\\{r_0, Br_0, \\dots, B^{k-1}r_0\\}$，使得相应残差 $r_k = M^{-1}b - Bx_k$ 的欧几里得范数最小化。\n\n残差 $r_k$ 可以用初始残差 $r_0$ 和一个多项式 $p_k$ 来表示。由于 $x_k - x_0 \\in \\mathcal{K}_k(B, r_0)$，我们可以写出 $x_k = x_0 + q_{k-1}(B)r_0$，其中 $q_{k-1}$ 是一个次数至多为 $k-1$ 的多项式。那么残差为\n$$r_k = M^{-1}b - B(x_0 + q_{k-1}(B)r_0) = (M^{-1}b - Bx_0) - Bq_{k-1}(B)r_0 = r_0 - Bq_{k-1}(B)r_0$$\n定义残差多项式 $p_k(z) = 1 - z q_{k-1}(z)$，我们看到 $p_k$ 是一个次数至多为 $k$ 且满足约束条件 $p_k(0) = 1$ 的多项式。残差可以写为 $r_k = p_k(B)r_0$。GMRES 在所有次数至多为 $k$ 且满足 $p_k(0)=1$ 的实多项式中，找到使 $\\|r_k\\|_2 = \\|p_k(B)r_0\\|_2$ 最小化的那个 $p_k$。\n\n根据问题描述，给定 $B$ 的一个二维不变子空间，由分别对应于实特征值 $\\lambda_+ = 1$ 和 $\\lambda_- = -1$ 的两个标准正交特征向量 $v_+$ 和 $v_-$ 张成。初始残差 $r_0$ 完全位于该子空间内：\n$$r_0 = c \\, v_{+} + c \\, v_{-}$$\n对于某个非零实标量 $c$。由于 $r_0$ 在这个不变子空间内，所有后续的残差 $r_k$ 和克雷洛夫向量 $B^j r_0$ 也将位于该子空间内。\n\n让我们将算子 $p_k(B)$ 应用于 $r_0$。由于 $v_+$ 和 $v_-$ 是 $B$ 的特征向量：\n$$r_k = p_k(B)r_0 = p_k(B)(c v_{+} + c v_{-}) = c \\, p_k(B)v_{+} + c \\, p_k(B)v_{-} = c \\, p_k(\\lambda_{+})v_{+} + c \\, p_k(\\lambda_{-})v_{-}$$\n代入给定的特征值：\n$$r_k = c \\, p_k(1)v_{+} + c \\, p_k(-1)v_{-}$$\n$r_k$ 的欧几里得范数的平方可以通过利用 $v_+$ 和 $v_-$ 的标准正交性（即 $\\langle v_+, v_+ \\rangle = 1$，$\\langle v_-, v_- \\rangle = 1$ 和 $\\langle v_+, v_- \\rangle = 0$）来求得：\n$$\\|r_k\\|_2^2 = \\langle c \\, p_k(1)v_{+} + c \\, p_k(-1)v_{-}, c \\, p_k(1)v_{+} + c \\, p_k(-1)v_{-} \\rangle$$\n$$\\|r_k\\|_2^2 = c^2 |p_k(1)|^2 \\langle v_+, v_+ \\rangle + c^2 |p_k(-1)|^2 \\langle v_-, v_- \\rangle + 2c^2 p_k(1)p_k(-1) \\langle v_+, v_- \\rangle$$\n$$\\|r_k\\|_2^2 = c^2 (p_k(1)^2 + p_k(-1)^2)$$\n初始残差 $r_0$ 的范数平方为：\n$$\\|r_0\\|_2^2 = \\langle c v_{+} + c v_{-}, c v_{+} + c v_{-} \\rangle = c^2 \\langle v_+, v_+ \\rangle + c^2 \\langle v_-, v_- \\rangle + 2c^2 \\langle v_+, v_- \\rangle = c^2(1) + c^2(1) + 0 = 2c^2$$\n经过 $k$ 步后，残差范数缩减因子为 $\\frac{\\|r_k\\|_2}{\\|r_0\\|_2}$。其平方为：\n$$\\left( \\frac{\\|r_k\\|_2}{\\|r_0\\|_2} \\right)^2 = \\frac{c^2 (p_k(1)^2 + p_k(-1)^2)}{2c^2} = \\frac{p_k(1)^2 + p_k(-1)^2}{2}$$\nGMRES 找到使该表达式最小化的多项式 $p_k$。\n\n**情况 1：不带重启的 GMRES 迭代 2 次后 ($k=2$)**\n我们要寻找一个次数至多为 $2$ 且满足 $p_2(0)=1$ 的多项式 $p_2(z)$，以最小化 $\\frac{p_2(1)^2 + p_2(-1)^2}{2}$。为了最小化这个平方和，我们理想地应该选择 $p_2(z)$ 使得 $p_2(1)=0$ 和 $p_2(-1)=0$。\n让我们构造这样一个多项式。它的根是 $1$ 和 $-1$。该多项式的形式必须是 $p_2(z) = \\gamma (z-1)(z+1)$，其中 $\\gamma$ 是某个常数。我们利用约束条件 $p_2(0)=1$ 来确定 $\\gamma$：\n$$p_2(0) = \\gamma (0-1)(0+1) = -\\gamma = 1 \\implies \\gamma = -1$$\n因此，最优多项式为 $p_2(z) = -(z^2-1) = 1-z^2$。这是一个满足 $p_2(0)=1$ 的 2 次多项式，因此它是 GMRES(2) 的一个有效候选。\n使用这个多项式，我们得到 $p_2(1) = 0$ 和 $p_2(-1) = 0$。缩减因子平方的最小值为：\n$$\\left( \\frac{\\|r_2\\|_2}{\\|r_0\\|_2} \\right)^2 = \\frac{0^2 + 0^2}{2} = 0$$\n因此，缩减因子为 $0$。这表明对于这个特定的问题设置，GMRES 在两次迭代后收敛到精确解。\n\n**情况 2：GMRES(1) 一个重启周期后**\nGMRES(1) 涉及运行单步 GMRES ($k=1$) 然后重启。“一个重启周期后”的缩减因子指的是在这一单步中实现的缩减。我们需要找到一个次数至多为 $1$ 且满足 $p_1(0)=1$ 的最优多项式 $p_1(z)$，以最小化缩减因子。\n一个次数至多为 $1$ 且满足 $p_1(0)=1$ 的多项式具有一般形式 $p_1(z) = 1 - \\alpha z$，其中 $\\alpha$ 是某个实系数。\n我们需要找到使数量 $\\frac{p_1(1)^2 + p_1(-1)^2}{2}$ 最小化的 $\\alpha$ 值。\n$$p_1(1) = 1 - \\alpha$$\n$$p_1(-1) = 1 - \\alpha(-1) = 1 + \\alpha$$\n需要最小化的表达式是 $\\alpha$ 的一个函数：\n$$f(\\alpha) = \\frac{(1-\\alpha)^2 + (1+\\alpha)^2}{2} = \\frac{(1 - 2\\alpha + \\alpha^2) + (1 + 2\\alpha + \\alpha^2)}{2} = \\frac{2 + 2\\alpha^2}{2} = 1 + \\alpha^2$$\n为了最小化 $f(\\alpha)$，我们通过对 $\\alpha$ 求导并令其为零来找到临界点：\n$$f'(\\alpha) = 2\\alpha = 0 \\implies \\alpha = 0$$\n$\\alpha=0$ 这个选择可以最小化 $f(\\alpha)$。最小值为 $f(0) = 1+0^2=1$。最小的缩减因子平方是 $1$。因此，缩减因子是 $\\sqrt{1} = 1$。\n这意味着经过一步 GMRES 迭代后，残差范数完全没有减小；$\\|r_1\\|_2 = \\|r_0\\|_2$。方法停滞了。这是因为最优多项式是 $p_1(z)=1$，这对应于不进行任何更新（$x_1=x_0$ 且 $r_1=r_0$）。\n\n综合这些结果，不带重启的 GMRES 迭代 2 次后的缩减因子是 $0$，而 GMRES(1) 一个周期后的缩减因子是 $1$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "预处理是提升GMRES等Krylov方法性能的关键，但预处理器的应用方式——左预处理或右预处理——并非无关紧要。这个选择直接影响了迭代过程所最小化的范数，并可能导致不同的收敛行为。本练习  通过一个简化的对流-扩散模型，让你亲手计算并比较这两种策略，从而深刻理解它们与物理相关的“能量范数”误差之间的微妙关系。",
            "id": "3958007",
            "problem": "考虑一个由傅里叶热传导定律和线性对流控制的稳态一维对流-扩散温度模型。在两个内部控制体积上进行二阶有限体积或有限差分离散化，得到一个对称正定 (SPD) 的传导刚度矩阵 $K$ 和一个上三角对流矩阵 $C$，因此总算子为 $A = K + C$。取\n$$\nK = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}, \\quad C = \\begin{pmatrix}0  3 \\\\ 0  0\\end{pmatrix}, \\quad A = \\begin{pmatrix}2  2 \\\\ -1  2\\end{pmatrix},\n$$\n给定源项向量为\n$$\nb = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}.\n$$\n定义由传导引起的物理能量范数为 $\\|v\\|_{E} = \\sqrt{v^{\\top} K v}$，这与传导能量泛函的离散形式 $E(x) = \\frac{1}{2} x^{\\top} K x - b^{\\top} x$ 一致。对于非对称线性系统 $A x = b$，考虑从零初始猜测开始，使用两种不同的预处理进行一次广义最小残差法 (GMRES) 迭代：\n- 左预处理，使用 $M_{L} = \\operatorname{diag}(A)$，因此求解的系统是 $M_{L}^{-1} A x = M_{L}^{-1} b$，GMRES 最小化 $\\|M_{L}^{-1} r\\|_{2}$，其中 $r = b - A x$。\n- 右预处理，使用 $M_{R} = K$，因此求解的系统是 $A M_{R}^{-1} y = b$ 且 $x = M_{R}^{-1} y$，GMRES 最小化 $\\|r\\|_{2}$。\n\n令 $x_{L}$ 和 $x_{R}$ 分别为在左预处理和右预处理下获得的单次迭代 GMRES 近似解，令 $r_{L} = b - A x_{L}$ 和 $r_{R} = b - A x_{R}$ 为相应的残差。令能量梯度方向为 $g_{E,L} = b - K x_{L}$ 和 $g_{E,R} = b - K x_{R}$。为了量化“与物理能量范数的相关性”，使用 $K$-内积下的余弦，\n$$\n\\cos_{K}(u,v) = \\frac{u^{\\top} K v}{\\sqrt{u^{\\top} K u} \\, \\sqrt{v^{\\top} K v}}.\n$$\n计算比值\n$$\n\\rho = \\frac{\\cos_{K}(r_{R}, g_{E,R})}{\\cos_{K}(r_{L}, g_{E,L})}.\n$$\n将最终答案表示为简化的精确解析表达式。无需四舍五入。",
            "solution": "控制物理基础是傅里叶热传导定律和线性对流。在离散情况下，对称正定 (SPD) 传导矩阵 $K$ 代表与能量范数 $\\|v\\|_{E} = \\sqrt{v^{\\top} K v}$ 相关联的双线性形式，而对流贡献 $C$ 引入了非对称性，使得 $A = K + C$。\n\n我们分析在左预处理和右预处理下，从 $x_{0} = 0$ 开始的广义最小残差法 (GMRES) 的一次迭代。\n\n右预处理，使用 $M_{R} = K$：我们求解 $A M_{R}^{-1} y = b$ 并设 $x = M_{R}^{-1} y$。在一次 GMRES 迭代中，$y$ 位于 $\\operatorname{span}\\{b\\}$ 中，因此 $y = \\alpha b$，得到 $x = \\alpha K^{-1} b$。残差为\n$$\nr_{R} = b - A x = b - \\alpha A K^{-1} b.\n$$\nGMRES 步骤选择 $\\alpha$ 以最小化 $\\|r_{R}\\|_{2}$，这给出\n$$\n\\alpha_{R} = \\frac{b^{\\top} (A K^{-1} b)}{\\|A K^{-1} b\\|_{2}^{2}}.\n$$\n计算 $K^{-1}$ 和所需量。由于\n$$\nK = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix}, \\quad \\det(K) = 3, \\quad K^{-1} = \\frac{1}{3} \\begin{pmatrix}2  1 \\\\ 1  2\\end{pmatrix},\n$$\n我们有\n$$\nK^{-1} b = \\frac{1}{3} \\begin{pmatrix}1 \\\\ 2\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{3} \\\\ \\frac{2}{3}\\end{pmatrix},\n\\quad\nA K^{-1} b = \\begin{pmatrix}2  2 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}\\frac{1}{3} \\\\ \\frac{2}{3}\\end{pmatrix}\n= \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}.\n$$\n因此\n$$\n\\alpha_{R} = \\frac{b^{\\top} (A K^{-1} b)}{\\|A K^{-1} b\\|_{2}^{2}} = \\frac{\\begin{pmatrix}0  1\\end{pmatrix} \\begin{pmatrix}2 \\\\ 1\\end{pmatrix}}{2^{2} + 1^{2}} = \\frac{1}{5}.\n$$\n所以\n$$\nx_{R} = \\alpha_{R} K^{-1} b = \\frac{1}{5} \\cdot \\frac{1}{3} \\begin{pmatrix}1 \\\\ 2\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{15} \\\\ \\frac{2}{15}\\end{pmatrix}.\n$$\n计算残差和能量梯度方向：\n$$\nA x_{R} = \\begin{pmatrix}2  2 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}\\frac{1}{15} \\\\ \\frac{2}{15}\\end{pmatrix}\n= \\begin{pmatrix}\\frac{2}{15} + \\frac{4}{15} \\\\ -\\frac{1}{15} + \\frac{4}{15}\\end{pmatrix}\n= \\begin{pmatrix}\\frac{2}{5} \\\\ \\frac{1}{5}\\end{pmatrix},\n$$\n$$\nr_{R} = b - A x_{R} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\begin{pmatrix}\\frac{2}{5} \\\\ \\frac{1}{5}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{2}{5} \\\\ \\frac{4}{5}\\end{pmatrix},\n$$\n$$\nK x_{R} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}\\frac{1}{15} \\\\ \\frac{2}{15}\\end{pmatrix}\n= \\begin{pmatrix}\\frac{2}{15} - \\frac{2}{15} \\\\ -\\frac{1}{15} + \\frac{4}{15}\\end{pmatrix}\n= \\begin{pmatrix}0 \\\\ \\frac{1}{5}\\end{pmatrix},\n$$\n$$\ng_{E,R} = b - K x_{R} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\begin{pmatrix}0 \\\\ \\frac{1}{5}\\end{pmatrix}\n= \\begin{pmatrix}0 \\\\ \\frac{4}{5}\\end{pmatrix}.\n$$\n$K$-内积余弦是\n$$\n\\cos_{K}(r_{R}, g_{E,R}) = \\frac{r_{R}^{\\top} K g_{E,R}}{\\sqrt{r_{R}^{\\top} K r_{R}} \\, \\sqrt{g_{E,R}^{\\top} K g_{E,R}}}.\n$$\n计算所需项：\n$$\nK g_{E,R} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}0 \\\\ \\frac{4}{5}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{4}{5} \\\\ \\frac{8}{5}\\end{pmatrix},\n$$\n$$\nr_{R}^{\\top} K g_{E,R} = \\begin{pmatrix}-\\frac{2}{5}  \\frac{4}{5}\\end{pmatrix} \\begin{pmatrix}-\\frac{4}{5} \\\\ \\frac{8}{5}\\end{pmatrix}\n= \\frac{8}{25} + \\frac{32}{25} = \\frac{40}{25} = \\frac{8}{5},\n$$\n$$\nK r_{R} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}-\\frac{2}{5} \\\\ \\frac{4}{5}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{8}{5} \\\\ 2\\end{pmatrix},\n\\quad\nr_{R}^{\\top} K r_{R} = \\begin{pmatrix}-\\frac{2}{5}  \\frac{4}{5}\\end{pmatrix} \\begin{pmatrix}-\\frac{8}{5} \\\\ 2\\end{pmatrix}\n= \\frac{16}{25} + \\frac{8}{5} = \\frac{56}{25},\n$$\n$$\ng_{E,R}^{\\top} K g_{E,R} = \\begin{pmatrix}0  \\frac{4}{5}\\end{pmatrix} \\begin{pmatrix}-\\frac{4}{5} \\\\ \\frac{8}{5}\\end{pmatrix}\n= \\frac{32}{25}.\n$$\n因此\n$$\n\\cos_{K}(r_{R}, g_{E,R}) = \\frac{\\frac{8}{5}}{\\sqrt{\\frac{56}{25}} \\, \\sqrt{\\frac{32}{25}}}\n= \\frac{\\frac{8}{5}}{\\frac{\\sqrt{56}}{5} \\cdot \\frac{\\sqrt{32}}{5}}\n= \\frac{40}{\\sqrt{56}\\sqrt{32}}\n= \\frac{40}{\\sqrt{1792}}\n= \\frac{40}{16 \\sqrt{7}}\n= \\frac{5}{2 \\sqrt{7}}.\n$$\n\n左预处理，使用 $M_{L} = \\operatorname{diag}(A) = \\begin{pmatrix}2  0 \\\\ 0  2\\end{pmatrix}$：我们用 GMRES 求解 $M_{L}^{-1} A x = M_{L}^{-1} b$。在一次迭代中，$x$ 位于 $\\operatorname{span}\\{M_{L}^{-1} b\\}$ 中，因此 $x = \\alpha M_{L}^{-1} b$。GMRES 步骤选择 $\\alpha$ 以最小化 $\\|M_{L}^{-1} r\\|_{2} = \\|M_{L}^{-1}(b - A x)\\|_{2}$，这等价于最小化 $\\|c - \\alpha q\\|_{2}$，其中\n$$\nc = M_{L}^{-1} b, \\quad q = M_{L}^{-1} A M_{L}^{-1} b.\n$$\n计算 $M_{L}^{-1} = \\frac{1}{2} I$，因此\n$$\nc = \\frac{1}{2} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}0 \\\\ \\frac{1}{2}\\end{pmatrix}, \\quad\nq = \\frac{1}{2} A \\left(\\frac{1}{2} b\\right) = \\frac{1}{4} A b = \\frac{1}{4} \\begin{pmatrix}2 \\\\ 2\\end{pmatrix} = \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}.\n$$\n因此，\n$$\n\\alpha_{L} = \\frac{c^{\\top} q}{\\|q\\|_{2}^{2}} = \\frac{\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right)}{\\left(\\frac{1}{2}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2}} = \\frac{\\frac{1}{4}}{\\frac{1}{2}} = \\frac{1}{2}.\n$$\n然后\n$$\nx_{L} = \\alpha_{L} M_{L}^{-1} b = \\frac{1}{2} \\begin{pmatrix}0 \\\\ \\frac{1}{2}\\end{pmatrix} = \\begin{pmatrix}0 \\\\ \\frac{1}{4}\\end{pmatrix},\n$$\n以及\n$$\nA x_{L} = \\begin{pmatrix}2  2 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}0 \\\\ \\frac{1}{4}\\end{pmatrix}\n= \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}, \\quad\nr_{L} = b - A x_{L} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}.\n$$\n能量梯度方向是\n$$\nK x_{L} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}0 \\\\ \\frac{1}{4}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{1}{4} \\\\ \\frac{1}{2}\\end{pmatrix}, \\quad\ng_{E,L} = b - K x_{L} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\begin{pmatrix}-\\frac{1}{4} \\\\ \\frac{1}{2}\\end{pmatrix}\n= \\begin{pmatrix}\\frac{1}{4} \\\\ \\frac{1}{2}\\end{pmatrix}.\n$$\n计算 $K$-余弦：\n$$\nK g_{E,L} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}\\frac{1}{4} \\\\ \\frac{1}{2}\\end{pmatrix}\n= \\begin{pmatrix}0 \\\\ \\frac{3}{4}\\end{pmatrix},\n$$\n$$\nr_{L}^{\\top} K g_{E,L} = \\begin{pmatrix}-\\frac{1}{2}  \\frac{1}{2}\\end{pmatrix} \\begin{pmatrix}0 \\\\ \\frac{3}{4}\\end{pmatrix} = \\frac{3}{8},\n$$\n$$\nK r_{L} = \\begin{pmatrix}2  -1 \\\\ -1  2\\end{pmatrix} \\begin{pmatrix}-\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}\n= \\begin{pmatrix}-\\frac{3}{2} \\\\ \\frac{3}{2}\\end{pmatrix}, \\quad\nr_{L}^{\\top} K r_{L} = \\begin{pmatrix}-\\frac{1}{2}  \\frac{1}{2}\\end{pmatrix} \\begin{pmatrix}-\\frac{3}{2} \\\\ \\frac{3}{2}\\end{pmatrix} = \\frac{3}{2},\n$$\n$$\ng_{E,L}^{\\top} K g_{E,L} = \\begin{pmatrix}\\frac{1}{4}  \\frac{1}{2}\\end{pmatrix} \\begin{pmatrix}0 \\\\ \\frac{3}{4}\\end{pmatrix} = \\frac{3}{8}.\n$$\n因此，\n$$\n\\cos_{K}(r_{L}, g_{E,L}) = \\frac{\\frac{3}{8}}{\\sqrt{\\frac{3}{2}} \\, \\sqrt{\\frac{3}{8}}}\n= \\frac{\\frac{3}{8}}{\\sqrt{\\frac{9}{16}}}\n= \\frac{\\frac{3}{8}}{\\frac{3}{4}}\n= \\frac{1}{2}.\n$$\n\n所求比值为\n$$\n\\rho = \\frac{\\cos_{K}(r_{R}, g_{E,R})}{\\cos_{K}(r_{L}, g_{E,L})}\n= \\frac{\\frac{5}{2 \\sqrt{7}}}{\\frac{1}{2}}\n= \\frac{5}{\\sqrt{7}}.\n$$\n\n为完整起见，我们通过计算使用 $M_{L}^{-1}$ 的预处理后残差范数，来确认在此次单迭代比较中左预处理“更快地最小化了预处理后的范数”：\n$$\n\\|M_{L}^{-1} r_{L}\\|_{2} = \\left\\|\\frac{1}{2} \\begin{pmatrix}-\\frac{1}{2} \\\\ \\frac{1}{2}\\end{pmatrix}\\right\\|_{2}\n= \\left\\|\\begin{pmatrix}-\\frac{1}{4} \\\\ \\frac{1}{4}\\end{pmatrix}\\right\\|_{2}\n= \\sqrt{\\frac{1}{16} + \\frac{1}{16}}\n= \\sqrt{\\frac{1}{8}}\n= \\frac{1}{2 \\sqrt{2}},\n$$\n$$\n\\|M_{L}^{-1} r_{R}\\|_{2} = \\left\\|\\frac{1}{2} \\begin{pmatrix}-\\frac{2}{5} \\\\ \\frac{4}{5}\\end{pmatrix}\\right\\|_{2}\n= \\left\\|\\begin{pmatrix}-\\frac{1}{5} \\\\ \\frac{2}{5}\\end{pmatrix}\\right\\|_{2}\n= \\sqrt{\\frac{1}{25} + \\frac{4}{25}}\n= \\sqrt{\\frac{1}{5}}\n= \\frac{1}{\\sqrt{5}},\n$$\n确实 $\\frac{1}{2 \\sqrt{2}}  \\frac{1}{\\sqrt{5}}$，因此一次迭代后，左预处理的残差在预处理后的范数下更小，而与物理能量范数的相关性更差，因为 $\\cos_{K}(r_{L}, g_{E,L}) = \\frac{1}{2}  \\cos_{K}(r_{R}, g_{E,R}) = \\frac{5}{2 \\sqrt{7}}$。比值 $\\rho$ 量化了这种差异。",
            "answer": "$$\\boxed{\\frac{5}{\\sqrt{7}}}$$"
        },
        {
            "introduction": "在工程计算实践中，一个常见的问题是：“我应该将求解器的收敛容差设置到多小？”。仅仅依赖于一个小的相对残差范数，并不能保证你关心的特定工程量（如总热通量）就足够精确。本练习  引入了功能强大的伴随方法（adjoint method），它建立了一座从线性系统的残差到最终工程量误差的桥梁，使你能够推导出与具体工程精度要求直接挂钩的、有明确物理意义的停止准则。",
            "id": "3957987",
            "problem": "一个带有加热壁面的通道内的二维稳态对流-扩散传热问题，通过保守的有限体积法进行离散化，其中对流通量采用一阶迎风格式，扩散通量采用中心差分格式。所得的线性系统是非对称的，可以写成 $A u = b$ 的形式，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是非对称矩阵，$u \\in \\mathbb{R}^{n}$ 是节点温度向量，$b \\in \\mathbb{R}^{n}$ 是由源项和边界条件构成的载荷向量。关注量是加热壁面 $\\Gamma_{h}$ 上的积分壁面热通量，在离散层面上建模为线性泛函 $J(u) = g^{\\mathsf{T}} u$，其中 $g \\in \\mathbb{R}^{n}$ 是一个由面传导系数和壁面法向量构成的已知向量。\n\n假设应用广义最小残差法 (Generalized Minimal Residual, GMRES) 来计算近似解 $\\tilde{u}$，且不使用左或右预处理。其真实残差为 $r = b - A \\tilde{u}$。设关注量的误差为 $\\Delta J = J(u) - J(\\tilde{u})$。要求您仅使用线性代数的基本定义（误差、残差、对偶问题）和范数不等式，将相对残差 $\\|r\\|_{2}/\\|b\\|_{2}$ 与积分热通量的预期绝对误差 $|\\Delta J|$ 联系起来，然后确定一个能够保证工程精度结果的停止容差。\n\n假设从问题设置和在相同网格上进行的辅助伴随分析中可获得以下数据：\n- 离散伴随解 $z \\in \\mathbb{R}^{n}$ 满足 $A^{\\mathsf{T}} z = g$，其欧几里得范数有界，为 $\\|z\\|_{2} \\leq 40$。\n- 右端项的欧几里得范数经测量为 $\\|b\\|_{2} = 3.0 \\times 10^{4}$。\n- 先前经过验证的计算表明，名义积分热通量为 $J_{\\mathrm{ref}} = 8.0 \\times 10^{4}$ 瓦特。工程要求计算出的积分热通量在其绝对值上与 $J_{\\mathrm{ref}}$ 的相对误差在 $0.005$ 以内。\n\n仅使用上述信息和基础线性代数，推导一个用 $\\|r\\|_{2}$ 和 $\\|z\\|_{2}$ 表示 $|\\Delta J|$ 上界的不等式，然后用相对残差 $\\tau = \\|r\\|_{2}/\\|b\\|_{2}$ 表示此界。确定能够保证积分热通量绝对误差满足工程要求的 $\\tau$ 的最大允许值。将您计算的 $\\tau$ 的最终答案四舍五入到三位有效数字。最终答案必须以无量纲数的形式报告，不带单位。",
            "solution": "本问题要求我们对于一个通过迭代方法求解的线性系统，推导一个不等式，将关注量的绝对误差 $|\\Delta J|$ 与相对残差 $\\tau = \\|r\\|_{2}/\\|b\\|_{2}$ 联系起来。随后，我们必须确定能够保证 $J$ 达到指定工程精度的最大 $\\tau$ 值。\n\n首先，我们对问题进行形式化设置。离散系统的精确解 $u \\in \\mathbb{R}^{n}$ 满足以下线性方程：\n$$A u = b$$\n其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个非对称矩阵，$b \\in \\mathbb{R}^{n}$ 是右端向量。\n\n关注量是解的一个线性泛函，由下式给出：\n$$J(u) = g^{\\mathsf{T}} u$$\n其中 $g \\in \\mathbb{R}^{n}$ 是一个指定的向量。\n\n计算得到一个近似解，记为 $\\tilde{u} \\in \\mathbb{R}^{n}$。该解的误差是向量 $e = u - \\tilde{u}$。相应的残差为 $r = b - A \\tilde{u}$。我们可以通过观察以下关系将误差 $e$ 与残差 $r$ 联系起来：\n$$A e = A (u - \\tilde{u}) = A u - A \\tilde{u} = b - A \\tilde{u} = r$$\n因此，误差向量 $e$ 满足线性系统 $A e = r$。\n\n关注量的误差 $\\Delta J$ 是精确值与近似值之差：\n$$\\Delta J = J(u) - J(\\tilde{u}) = g^{\\mathsf{T}} u - g^{\\mathsf{T}} \\tilde{u} = g^{\\mathsf{T}} (u - \\tilde{u}) = g^{\\mathsf{T}} e$$\n\n为继续进行，我们引入离散伴随问题，它是根据矩阵 $A$ 和定义关注量的向量 $g$ 来定义的。伴随解 $z \\in \\mathbb{R}^{n}$ 满足：\n$$A^{\\mathsf{T}} z = g$$\n这使我们可以将 $g$ 表示为 $g = A^{\\mathsf{T}} z$。将其代入 $\\Delta J$ 的表达式中：\n$$\\Delta J = (A^{\\mathsf{T}} z)^{\\mathsf{T}} e = z^{\\mathsf{T}} A e$$\n由于我们已经确定 $A e = r$，我们可以将其代入，从而得到关注量误差的精确表达式：\n$$\\Delta J = z^{\\mathsf{T}} r$$\n这个基本结果表明，线性泛函输出的误差精确地等于伴随解与原始残差的内积。\n\n为了得到此误差大小 $|\\Delta J|$ 的一个上界，我们对内积 $z^{\\mathsf{T}} r$ 应用柯西-施瓦茨不等式：\n$$|\\Delta J| = |z^{\\mathsf{T}} r| \\leq \\|z\\|_{2} \\|r\\|_{2}$$\n这个不等式以伴随解 $z$ 和残差 $r$ 的欧几里得范数为基础，为关注量的绝对误差提供了一个上界。\n\n问题指定使用相对残差 $\\tau = \\|r\\|_{2}/\\|b\\|_{2}$ 作为停止准则。我们可以将残差的范数表示为 $\\|r\\|_{2} = \\tau \\|b\\|_{2}$。将其代入我们的误差界中得到：\n$$|\\Delta J| \\leq \\|z\\|_{2} (\\tau \\|b\\|_{2}) = \\tau \\|z\\|_{2} \\|b\\|_{2}$$\n这就是所求的将绝对误差 $|\\Delta J|$ 与相对残差 $\\tau$ 联系起来的不等式。\n\n接下来，我们必须确定能够保证指定工程精度的最大允许 $\\tau$ 值。参考的积分热通量为 $J_{\\mathrm{ref}} = 8.0 \\times 10^{4}$。要求的相对容差为 $0.005$。因此，最大允许绝对误差（我们记为 $|\\Delta J|_{\\mathrm{max}}$）为：\n$$|\\Delta J|_{\\mathrm{max}} = 0.005 \\times J_{\\mathrm{ref}} = 0.005 \\times (8.0 \\times 10^{4}) = 400$$\n\n为保证计算误差 $|\\Delta J|$ 不超过此值，我们必须确保其上界小于或等于 $|\\Delta J|_{\\mathrm{max}}$：\n$$\\tau \\|z\\|_{2} \\|b\\|_{2} \\leq |\\Delta J|_{\\mathrm{max}}$$\n我们需要找到使此保证成立的最大 $\\tau$ 值。重排不等式，我们得到：\n$$\\tau \\leq \\frac{|\\Delta J|_{\\mathrm{max}}}{\\|z\\|_{2} \\|b\\|_{2}}$$\n为确保此不等式对于任何与给定信息一致的 $z$ 的可能实现都成立，我们必须使用最保守（最大）的 $\\|z\\|_{2}$ 值。问题给出了界限 $\\|z\\|_{2} \\leq 40$。因此，我们在计算中使用 $\\|z\\|_{2} = 40$。\n\n给定值为：\n- $|\\Delta J|_{\\mathrm{max}} = 400$\n- $\\|z\\|_{2} \\leq 40$\n- $\\|b\\|_{2} = 3.0 \\times 10^{4}$\n\n将这些值代入不等式，以求得最大允许的 $\\tau$：\n$$\\tau \\leq \\frac{400}{40 \\times (3.0 \\times 10^{4})}$$\n$$\\tau \\leq \\frac{10}{3.0 \\times 10^{4}} = \\frac{10}{3} \\times 10^{-4}$$\n因此，$\\tau$ 的最大允许值为 $\\frac{10}{3} \\times 10^{-4}$。进行数值计算：\n$$\\tau_{\\mathrm{max}} = \\frac{10}{3} \\times 10^{-4} \\approx 3.333... \\times 10^{-4}$$\n问题要求将答案四舍五入到三位有效数字。\n$$\\tau_{\\mathrm{max}} \\approx 3.33 \\times 10^{-4}$$\n这是相对残差容差 $\\tau$ 的最大值，它能保证积分热通量的绝对误差在要求的工程规格之内。",
            "answer": "$$\\boxed{3.33 \\times 10^{-4}}$$"
        }
    ]
}