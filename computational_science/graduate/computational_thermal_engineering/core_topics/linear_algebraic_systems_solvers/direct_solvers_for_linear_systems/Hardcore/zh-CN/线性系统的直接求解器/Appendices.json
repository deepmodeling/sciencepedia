{
    "hands_on_practices": [
        {
            "introduction": "理论学习的最终目的是解决实际问题。本节的第一个练习将引导你完成从一个基本物理问题到其数值解的全过程。我们将从一个一维稳态热传导问题出发，通过有限差分法将其离散化，最终得到一个线性方程组。通过亲手对该方程组的系数矩阵进行 $LU$ 分解，你将深刻理解直接求解器如何将抽象的代数运算应用于具体的工程计算中。",
            "id": "3947263",
            "problem": "一根长度为 $L$、导热系数为均匀常数 $k$ 的均匀细杆，在没有内部体积生热的情况下，进行一维稳态热传导。其控制偏微分方程 (PDE) 是傅里叶定律与稳态能量守恒的结合，即 $-\\frac{d}{dx}\\!\\left(k\\,\\frac{dT}{dx}\\right)=0$，边界条件为狄利克雷边界条件 $T(0)=T_{\\mathrm{L}}$ 和 $T(L)=T_{\\mathrm{R}}$。使用有限差分法 (FDM) 在具有 $N_{i}=3$ 个内部节点的均匀网格上对求解域进行离散化，因此网格间距为 $h=L/4$。组装关于内部节点温度的线性系统，形式为 $A\\,\\boldsymbol{T}=\\boldsymbol{b}$，其中 $A$ 是所得到的 $3\\times 3$ 三对角系数矩阵。\n\n从基本平衡和傅里叶定律出发，推导内部节点的有限差分方程，确定 $A$ 的显式元素，然后执行无主元高斯消去法，将 $A$ 分解为 $A=L\\,U$，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵。在您的推导中，明确写出消去乘子以及 $L$ 和 $U$ 的元素。\n\n最后，计算无量纲行列式比值\n$$\nD \\;=\\; \\frac{\\det(A)}{\\left(\\dfrac{k}{h^{2}}\\right)^{3}}.\n$$\n以精确值（不要四舍五入）报告 $D$。最终答案必须是单个实数值。",
            "solution": "该问题经验证具有科学依据、适定、客观且完整。它提出了一个计算传热学中的标准问题，可以使用有限差分法和线性代数的既定原理来解决。\n\n第一步是从控制体上的能量平衡出发，推导控制方程的有限差分近似。对于无内部生热、导热系数为常数 $k$ 的一维稳态热传导，其控制方程为\n$$\n-\\frac{d}{dx}\\!\\left(k\\,\\frac{dT}{dx}\\right)=0\n$$\n由于 $k$ 是均匀的，这可以简化为\n$$\nk\\frac{d^2T}{dx^2} = 0 \\quad \\text{或} \\quad \\frac{d^2T}{dx^2} = 0\n$$\n为了从基本原理推导有限差分方程，我们对一个以内部网格节点 $i$ 为中心、长度为 $h$ 的控制体进行能量平衡分析。该控制体的面位于 $x_{i-1/2} = x_i - h/2$ 和 $x_{i+1/2} = x_i + h/2$。在稳态条件下，进入控制体的热量速率必须等于流出控制体的热量速率。设 $\\dot{Q}$ 为传热速率。\n$$\n\\dot{Q}_{\\text{in}} - \\dot{Q}_{\\text{out}} = 0\n$$\n热量从左侧面 $x_{i-1/2}$ 进入，从右侧面 $x_{i+1/2}$ 流出。因此，\n$$\n\\dot{Q}|_{x_{i-1/2}} - \\dot{Q}|_{x_{i+1/2}} = 0\n$$\n根据傅里叶热传导定律，传热速率 $\\dot{Q}$ 与温度梯度相关，关系式为 $\\dot{Q} = -kA_c \\frac{dT}{dx}$，其中 $A_c$ 是杆的横截面积。由于问题是一维的，$A_c$ 是一个常数，将会被消掉。我们可以使用热通量 $q = \\dot{Q}/A_c = -k \\frac{dT}{dx}$。能量平衡方程变为：\n$$\nq|_{x_{i-1/2}} - q|_{x_{i+1/2}} = 0\n$$\n我们使用中心差分来近似温度梯度，从而近似控制体面上的热通量：\n$$\nq|_{x_{i-1/2}} \\approx -k \\frac{T_i - T_{i-1}}{h}\n$$\n$$\nq|_{x_{i+1/2}} \\approx -k \\frac{T_{i+1} - T_i}{h}\n$$\n将这些近似值代入能量平衡方程：\n$$\n\\left(-k \\frac{T_i - T_{i-1}}{h}\\right) - \\left(-k \\frac{T_{i+1} - T_i}{h}\\right) = 0\n$$\n乘以 $h/k$ (假设 $k \\neq 0$ 和 $h \\neq 0$):\n$$\n-(T_i - T_{i-1}) + (T_{i+1} - T_i) = 0\n$$\n$$\nT_{i-1} - 2T_i + T_{i+1} = 0\n$$\n这是任何内部节点 $i$ 的有限差分方程。通常将此方程写成一种可以导出正定系统矩阵的形式。通过乘以 $-\\frac{k}{h^2}$，我们得到：\n$$\n\\frac{k}{h^2} ( -T_{i-1} + 2T_i - T_{i+1} ) = 0\n$$\n求解域被离散化为 $N_i=3$ 个内部节点，这意味着总共有 $N+1=4$ 个区间和 5 个节点，索引从 0 到 4。网格间距为 $h=L/4$。未知温度为 $T_1$、$T_2$ 和 $T_3$。边界温度是已知的：$T_0 = T(0) = T_{\\mathrm{L}}$ 和 $T_4 = T(L) = T_{\\mathrm{R}}$。\n\n我们在每个内部节点上应用有限差分方程：\n对于节点 $i=1$:\n$$\n\\frac{k}{h^2} (-T_0 + 2T_1 - T_2) = 0 \\implies \\frac{k}{h^2} (2T_1 - T_2) = \\frac{k}{h^2}T_0 = \\frac{k}{h^2}T_{\\mathrm{L}}\n$$\n对于节点 $i=2$:\n$$\n\\frac{k}{h^2} (-T_1 + 2T_2 - T_3) = 0\n$$\n对于节点 $i=3$:\n$$\n\\frac{k}{h^2} (-T_2 + 2T_3 - T_4) = 0 \\implies \\frac{k}{h^2} (-T_2 + 2T_3) = \\frac{k}{h^2}T_4 = \\frac{k}{h^2}T_{\\mathrm{R}}\n$$\n这个线性方程组可以写成矩阵形式 $A\\boldsymbol{T}=\\boldsymbol{b}$：\n$$\n\\begin{pmatrix}\n2\\frac{k}{h^2}  -\\frac{k}{h^2}  0 \\\\\n-\\frac{k}{h^2}  2\\frac{k}{h^2}  -\\frac{k}{h^2} \\\\\n0  -\\frac{k}{h^2}  2\\frac{k}{h^2}\n\\end{pmatrix}\n\\begin{pmatrix}\nT_1 \\\\ T_2 \\\\ T_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{k}{h^2}T_{\\mathrm{L}} \\\\\n0 \\\\\n\\frac{k}{h^2}T_{\\mathrm{R}}\n\\end{pmatrix}\n$$\n系数矩阵 $A$ 是：\n$$\nA = \\frac{k}{h^2}\n\\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2\\frac{k}{h^2}  -\\frac{k}{h^2}  0 \\\\\n-\\frac{k}{h^2}  2\\frac{k}{h^2}  -\\frac{k}{h^2} \\\\\n0  -\\frac{k}{h^2}  2\\frac{k}{h^2}\n\\end{pmatrix}\n$$\n接下来，我们执行无主元高斯消去法来获得 $A$ 的 $LU$ 分解。设 $\\gamma = \\frac{k}{h^2}$。\n$$\nA = \\begin{pmatrix}\n2\\gamma  -\\gamma  0 \\\\\n-\\gamma  2\\gamma  -\\gamma \\\\\n0  -\\gamma  2\\gamma\n\\end{pmatrix}\n$$\n目标是将 $A$ 转换为一个上三角矩阵 $U$。\n第一步是消去元素 $A_{21}$。乘子是 $l_{21} = \\frac{A_{21}}{A_{11}} = \\frac{-\\gamma}{2\\gamma} = -\\frac{1}{2}$。我们执行操作 $R_2 \\leftarrow R_2 - l_{21}R_1$。\n$$\nR_2 - \\left(-\\frac{1}{2}\\right)R_1 = (-\\gamma, 2\\gamma, -\\gamma) + \\frac{1}{2}(2\\gamma, -\\gamma, 0) = (-\\gamma+\\gamma, 2\\gamma - \\frac{1}{2}\\gamma, -\\gamma) = (0, \\frac{3}{2}\\gamma, -\\gamma)\n$$\n矩阵变为：\n$$\nA^{(1)} = \\begin{pmatrix}\n2\\gamma  -\\gamma  0 \\\\\n0  \\frac{3}{2}\\gamma  -\\gamma \\\\\n0  -\\gamma  2\\gamma\n\\end{pmatrix}\n$$\n元素 $A_{31}$ 已经为零，所以乘子 $l_{31} = 0$。\n第二步是从更新后的矩阵中消去元素 $A_{32}$。乘子是 $l_{32} = \\frac{A_{32}^{(1)}}{A_{22}^{(1)}} = \\frac{-\\gamma}{3\\gamma/2} = -\\frac{2}{3}$。我们执行操作 $R_3 \\leftarrow R_3 - l_{32}R_2^{(1)}$。\n$$\nR_3 - \\left(-\\frac{2}{3}\\right)R_2^{(1)} = (0, -\\gamma, 2\\gamma) + \\frac{2}{3}(0, \\frac{3}{2}\\gamma, -\\gamma) = (0, -\\gamma+\\gamma, 2\\gamma - \\frac{2}{3}\\gamma) = (0, 0, \\frac{4}{3}\\gamma)\n$$\n最终的上三角矩阵 $U$ 是：\n$$\nU = \\begin{pmatrix}\n2\\gamma  -\\gamma  0 \\\\\n0  \\frac{3}{2}\\gamma  -\\gamma \\\\\n0  0  \\frac{4}{3}\\gamma\n\\end{pmatrix} = \\frac{k}{h^2}\\begin{pmatrix}\n2  -1  0 \\\\\n0  \\frac{3}{2}  -1 \\\\\n0  0  \\frac{4}{3}\n\\end{pmatrix}\n$$\n单位下三角矩阵 $L$ 由乘子构造而成：\n$$\nL = \\begin{pmatrix}\n1  0  0 \\\\\nl_{21}  1  0 \\\\\nl_{31}  l_{32}  1\n\\end{pmatrix} = \\begin{pmatrix}\n1  0  0 \\\\\n-\\frac{1}{2}  1  0 \\\\\n0  -\\frac{2}{3}  1\n\\end{pmatrix}\n$$\n$A$ 的行列式可以计算为 $\\det(A) = \\det(L)\\det(U)$。\n三角矩阵的行列式是其对角线元素的乘积。\n$$\n\\det(L) = 1 \\cdot 1 \\cdot 1 = 1\n$$\n$$\n\\det(U) = (2\\gamma) \\left(\\frac{3}{2}\\gamma\\right) \\left(\\frac{4}{3}\\gamma\\right) = \\left(2 \\cdot \\frac{3}{2} \\cdot \\frac{4}{3}\\right)\\gamma^3 = 4\\gamma^3\n$$\n因此，$\\det(A) = 1 \\cdot 4\\gamma^3 = 4\\gamma^3$。将 $\\gamma = \\frac{k}{h^2}$ 代回：\n$$\n\\det(A) = 4\\left(\\frac{k}{h^2}\\right)^3\n$$\n最后，我们计算无量纲行列式比值 $D$：\n$$\nD = \\frac{\\det(A)}{\\left(\\dfrac{k}{h^{2}}\\right)^{3}} = \\frac{4\\left(\\dfrac{k}{h^{2}}\\right)^{3}}{\\left(\\dfrac{k}{h^{2}}\\right)^{3}} = 4\n$$",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "在理想情况下，高斯消元法是一个强大的工具，但实际工程问题往往更加复杂。这个练习将向你展示一个在计算流体力学中常见的挑战：当对流项占主导地位时，朴素的高斯消元法可能会遇到数值不稳定的问题。通过分析一个对流-扩散问题，你将计算消元过程中的“增长因子”，从而量化这种不稳定性，并理解为何偏主元法等高级策略对于构建稳健的求解器至关重要。",
            "id": "3947234",
            "problem": "对于一个无源标量温度场 $T(x)$，其一维稳态对流扩散能量平衡在均匀网格（间距为 $h$）上由微分方程 $-k \\frac{d^{2}T}{dx^{2}} + u \\frac{dT}{dx} = 0$ 控制，其中热导率 $k$ 和主流速度 $u$ 为常数。在内部节点 $i$ 上对扩散项和对流项同时使用中心差分法，会产生一个形式为 $A \\boldsymbol{T} = \\boldsymbol{b}$ 的线性代数系统，其中内部节点格式产生的系数为 $a_{P} = \\frac{2k}{h^{2}}$，$a_{W} = -\\frac{k}{h^{2}} - \\frac{u}{2h}$，以及 $a_{E} = -\\frac{k}{h^{2}} + \\frac{u}{2h}$。对于在区域两端具有 Dirichlet 边界条件的四节点内部离散化，其系数矩阵 $A$ 是非对称三对角矩阵。当对流贡献相对于扩散贡献足够强时，对角占优性可能很弱。在这种情况下，基于不进行主元选择的高斯消元法（GE）的直接求解器可能会出现元素增长。\n\n考虑 $k = 1$、$u = 3$ 和 $h = 1$ 的情况。组装仅与内部节点系数相关的 $4 \\times 4$ 矩阵 $A$（边界贡献仅出现在右侧项中，不影响对 $A$ 的消元过程）。对 $A$ 执行不进行任何主元选择的高斯消元法，以形成一个上三角矩阵 $U$。将增长因子定义为\n$$\\rho = \\frac{\\max\\limits_{i,j} |u_{ij}|}{\\max\\limits_{i,j} |a_{ij}|},$$ \n其中 $a_{ij}$ 是原始矩阵 $A$ 的元素，$u_{ij}$ 是消元后得到的上三角矩阵 $U$ 的元素。计算这个 $4 \\times 4$ 示例的 $\\rho$，并将最终答案表示为精确分数。无需四舍五入。最终答案必须是一个不带单位的实数。",
            "solution": "该问题陈述经评估是有效的。其科学基础是计算热工学和数值线性代数的原理，这是一个适定问题，提供了所有必要的数据，并且其语言客观而精确。\n\n该问题需要分三步计算：首先，基于对流扩散方程的有限差分离散化，组装系数矩阵 $A$；其次，对 $A$ 执行高斯消元以获得上三角矩阵 $U$；第三，计算元素增长因子 $\\rho$。\n\n控制微分方程为 $-k \\frac{d^{2}T}{dx^{2}} + u \\frac{dT}{dx} = 0$。\n指定的物理参数为热导率 $k = 1$，主流速度 $u = 3$，以及均匀网格间距 $h = 1$。\n\n线性系统 $A \\boldsymbol{T} = \\boldsymbol{b}$ 的内部节点格式的系数定义为：\n$a_{P} = \\frac{2k}{h^{2}}$ (主对角线)\n$a_{W} = -\\frac{k}{h^{2}} - \\frac{u}{2h}$ (次对角线)\n$a_{E} = -\\frac{k}{h^{2}} + \\frac{u}{2h}$ (超对角线)\n\n代入给定值 $k=1$，$u=3$ 和 $h=1$：\n$a_{P} = \\frac{2(1)}{(1)^{2}} = 2$\n$a_{W} = -\\frac{1}{(1)^{2}} - \\frac{3}{2(1)} = -1 - \\frac{3}{2} = -\\frac{5}{2}$\n$a_{E} = -\\frac{1}{(1)^{2}} + \\frac{3}{2(1)} = -1 + \\frac{3}{2} = \\frac{1}{2}$\n\n该问题指定了四节点内部离散化，这会产生一个 $4 \\times 4$ 的非对称三对角矩阵 $A$。使用计算出的系数，该矩阵的结构是：\n$$\nA = \n\\begin{pmatrix}\n2  \\frac{1}{2}  0  0 \\\\\n-\\frac{5}{2}  2  \\frac{1}{2}  0 \\\\\n0  -\\frac{5}{2}  2  \\frac{1}{2} \\\\\n0  0  -\\frac{5}{2}  2\n\\end{pmatrix}\n$$\n\n接下来，我们执行不带主元选择的高斯消元法将 $A$ 转换为上三角矩阵 $U$。令 $A^{(0)} = A$。\n\n步骤 1：消去 $a_{21}$。\n乘子为 $m_{21} = \\frac{a_{21}}{a_{11}} = \\frac{-5/2}{2} = -\\frac{5}{4}$。\n第二行更新为：$R_2 \\leftarrow R_2 - m_{21} R_1$。\n$a_{22}^{(1)} = a_{22} - m_{21} a_{12} = 2 - (-\\frac{5}{4})(\\frac{1}{2}) = 2 + \\frac{5}{8} = \\frac{16}{8} + \\frac{5}{8} = \\frac{21}{8}$。\n矩阵变为：\n$$\nA^{(1)} = \n\\begin{pmatrix}\n2  \\frac{1}{2}  0  0 \\\\\n0  \\frac{21}{8}  \\frac{1}{2}  0 \\\\\n0  -\\frac{5}{2}  2  \\frac{1}{2} \\\\\n0  0  -\\frac{5}{2}  2\n\\end{pmatrix}\n$$\n\n步骤 2：消去 $a_{32}^{(1)}$。\n乘子为 $m_{32} = \\frac{a_{32}^{(1)}}{a_{22}^{(1)}} = \\frac{-5/2}{21/8} = -\\frac{5}{2} \\times \\frac{8}{21} = -\\frac{20}{21}$。\n第三行更新为：$R_3 \\leftarrow R_3 - m_{32} R_2$。\n$a_{33}^{(2)} = a_{33}^{(1)} - m_{32} a_{23}^{(1)} = 2 - (-\\frac{20}{21})(\\frac{1}{2}) = 2 + \\frac{10}{21} = \\frac{42}{21} + \\frac{10}{21} = \\frac{52}{21}$。\n矩阵变为：\n$$\nA^{(2)} = \n\\begin{pmatrix}\n2  \\frac{1}{2}  0  0 \\\\\n0  \\frac{21}{8}  \\frac{1}{2}  0 \\\\\n0  0  \\frac{52}{21}  \\frac{1}{2} \\\\\n0  0  -\\frac{5}{2}  2\n\\end{pmatrix}\n$$\n\n步骤 3：消去 $a_{43}^{(2)}$。\n乘子为 $m_{43} = \\frac{a_{43}^{(2)}}{a_{33}^{(2)}} = \\frac{-5/2}{52/21} = -\\frac{5}{2} \\times \\frac{21}{52} = -\\frac{105}{104}$。\n第四行更新为：$R_4 \\leftarrow R_4 - m_{43} R_3$。\n$a_{44}^{(3)} = a_{44}^{(2)} - m_{43} a_{34}^{(2)} = 2 - (-\\frac{105}{104})(\\frac{1}{2}) = 2 + \\frac{105}{208} = \\frac{416}{208} + \\frac{105}{208} = \\frac{521}{208}$。\n\n最终的上三角矩阵 $U$ 是：\n$$\nU = A^{(3)} = \n\\begin{pmatrix}\n2  \\frac{1}{2}  0  0 \\\\\n0  \\frac{21}{8}  \\frac{1}{2}  0 \\\\\n0  0  \\frac{52}{21}  \\frac{1}{2} \\\\\n0  0  0  \\frac{521}{208}\n\\end{pmatrix}\n$$\n\n增长因子 $\\rho$ 定义为 $\\rho = \\frac{\\max\\limits_{i,j} |u_{ij}|}{\\max\\limits_{i,j} |a_{ij}|}$。\n\n首先，我们求原始矩阵 $A$ 中元素绝对值的最大值：\n$A = \\begin{pmatrix} 2  \\frac{1}{2}  0  0 \\\\ -\\frac{5}{2}  2  \\frac{1}{2}  0 \\\\ 0  -\\frac{5}{2}  2  \\frac{1}{2} \\\\ 0  0  -\\frac{5}{2}  2 \\end{pmatrix}$。\n元素绝对值的集合是 $\\{|2|, |\\frac{1}{2}|, |0|, |-\\frac{5}{2}|\\} = \\{2, \\frac{1}{2}, 0, \\frac{5}{2}\\}$。\n$\\max\\limits_{i,j} |a_{ij}| = \\frac{5}{2} = 2.5$。\n\n接下来，我们求最终矩阵 $U$ 中元素绝对值的最大值：\n$U = \\begin{pmatrix} 2  \\frac{1}{2}  0  0 \\\\ 0  \\frac{21}{8}  \\frac{1}{2}  0 \\\\ 0  0  \\frac{52}{21}  \\frac{1}{2} \\\\ 0  0  0  \\frac{521}{208} \\end{pmatrix}$。\n非零元素为 $\\{2, \\frac{1}{2}, \\frac{21}{8}, \\frac{52}{21}, \\frac{521}{208}\\}$。\n为了比较它们，我们可以将它们转换为小数或通分：\n$2 = 2.0$\n$\\frac{1}{2} = 0.5$\n$\\frac{21}{8} = 2.625$\n$\\frac{52}{21} \\approx 2.476$\n$\\frac{521}{208} \\approx 2.5048$\n最大值显然是 $\\frac{21}{8}$。\n$\\max\\limits_{i,j} |u_{ij}| = \\frac{21}{8}$。\n\n最后，我们计算增长因子 $\\rho$：\n$$\n\\rho = \\frac{\\max\\limits_{i,j} |u_{ij}|}{\\max\\limits_{i,j} |a_{ij}|} = \\frac{21/8}{5/2} = \\frac{21}{8} \\times \\frac{2}{5} = \\frac{42}{40} = \\frac{21}{20}\n$$\n增长因子为 $\\frac{21}{20}$，其值大于 $1$，表明在消元过程中发生了元素增长，这对于一个非对角占优的对流主导问题是符合预期的。",
            "answer": "$$\\boxed{\\frac{21}{20}}$$"
        },
        {
            "introduction": "对于大规模工程模拟，求解器的计算效率和内存消耗是决定性因素。许多问题（如纯热传导）会产生稀疏的对称正定（Symmetric Positive Definite, SPD）矩阵，针对这类矩阵，Cholesky分解是一种极为高效的直接求解方法。这个练习将引导你探究稀疏矩阵直接求解的核心概念——“填充”（fill-in），即在分解过程中产生新的非零元素。通过分析带状矩阵的Cholesky分解，你将理解矩阵结构如何影响求解器的性能，并推导出计算Cholesky因子所需存储空间的关键公式。",
            "id": "3947243",
            "problem": "一个具有空间变化热导率的一维域上的稳态热传导边值问题由以下二阶线性偏微分方程（PDE）描述：\n$$-\\frac{d}{dx}\\left(k(x)\\frac{dT}{dx}\\right)=q(x),$$\n并在端点处具有狄利克雷边界条件。考虑一种高阶、线性和守恒的离散化方法（例如，使用一个奇数 $2p+1$ 点紧致模板的有限差分法，该模板将每个节点与其两侧的 $p$ 个最近邻居耦合），这会产生一个半带宽为 $p$ 的对称正定（SPD）系数矩阵 $A \\in \\mathbb{R}^{n \\times n}$，意味着\n$$A_{ij}=0 \\quad \\text{whenever} \\quad |i-j|p.$$\n在一个基于 Cholesky 分解的直接求解器中，我们计算 $A=L\\,L^{\\top}$，其中 $L$ 是下三角矩阵。在未知量自然排序（节点从左到右）的情况下，利用高斯消元的图解释和 Schur 补的结构，来论证对于此 SPD 带状矩阵，在 Cholesky 分解过程中是否会在原始带外发生任何填充。然后，通过逐列计算下三角因子中潜在非零元的数量，推导出一个关于 $L$ 中非零元总数的闭式表达式，该表达式是 $n$ 和 $p$ 的函数。\n\n将最终答案表示为关于 $n$ 和 $p$ 的单个解析表达式。无需四舍五入，也无需物理单位。",
            "solution": "该问题要求分析一个半带宽为 $p$ 的对称正定（SPD）带状矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 的 Cholesky 分解 $A=LL^{\\top}$。该分析包括两部分：首先，确定是否在原始带外发生填充；其次，推导下三角因子 $L$ 中非零元总数的公式。\n\n矩阵 $A$ 源于具有自然（从左到右）未知量排序的离散化。其结构由 $|i-j|p$ 时 $A_{ij}=0$ 定义。我们假设 $n  p$，这是偏微分方程精细离散化的一个典型特征，其中网格点数 $n$ 远大于模板宽度参数 $p$。\n\n**第一部分：填充分析**\n\nCholesky 分解过程中的填充模式可以使用矩阵的图来精确描述。设 $G(A)=(V, E)$ 是与矩阵 $A$ 相关联的图，其中顶点集 $V=\\{1, 2, \\dots, n\\}$ 对应于未知量的索引，边集 $E = \\{(i, j) \\mid A_{ij} \\neq 0, i \\neq j\\}$。由于 $A$ 的带状结构，当且仅当 $0  |i-j| \\le p$ 时，$G(A)$ 中存在一条边 $(i, j)$。\n\n稀疏矩阵理论中的一个关键结果，通常称为填充路径定理，指出对于使用顶点自然排序执行的 Cholesky 分解 $A=LL^{\\top}$，当 $i>j$ 时，一个元素 $L_{ij}$ 非零，当且仅当在图 $G(A)$ 中存在一条从顶点 $i$ 到顶点 $j$ 的路径，该路径完全由索引小于 $j$ 的中间顶点 $v_k$ 组成。也就是说，必须存在一条路径 $i=v_0, v_1, \\dots, v_m=j$，使得对于所有 $k \\in \\{0, \\dots, m-1\\}$ 都有 $(v_k, v_{k+1}) \\in E$，并且对于所有中间顶点 $k \\in \\{1, \\dots, m-1\\}$ 都有 $v_k  j$。\n\n我们希望确定在 $A$ 的原始带外是否会发生任何填充。这等价于询问对于任何满足 $i-j  p$ 的数对 $(i, j)$，$L_{ij}$ 是否可以为非零。对于这样的数对，原始元素 $A_{ij}$ 为零。\n\n假设 $i-j  p$。要使 $L_{ij}$ 变为非零，必须存在如上所述的填充路径。设此路径为 $i=v_0, v_1, \\dots, v_m=j$。此路径的第一步是从顶点 $i$ 到一个相邻顶点 $v_1$。要使 $(i, v_1)$ 成为 $G(A)$ 中的一条边，必须满足 $|i-v_1| \\le p$。填充路径的要求是中间顶点 $v_1$ 必须满足 $v_1  j$。\n\n根据边的条件，$i$ 的任何邻居 $v_1$ 必须在范围 $[i-p, i+p]$ 内。任何索引小于 $i$ 的邻居 $v_1$ 必须满足 $v_1 \\ge i-p$。\n\n根据我们的初始假设，$i-j  p$，可以重写为 $i-p  j$。\n\n结合这两个事实， $i$ 的任何邻居 $v_1$ 都必须满足 $v_1 \\ge i-p  j$。这意味着顶点 $i$ 的每个邻居的索引都大于 $j$。因此，不可能找到一条从 $i$ 到 $j$ 的路径，其起始步骤是移动到索引小于 $j$ 的顶点 $v_1$。不存在这样的填充路径。\n\n因此，我们得出结论，如果 $i-j  p$，则 $L_{ij}$ 必须为零。这证明了在原始带外不会发生填充。下三角因子 $L$ 也是一个下带宽为 $p$ 的带状矩阵。具体来说，$L$ 的非零元被限制在对角线以及其紧邻下方的 $p$ 条次对角线上。\n\n**第二部分：计算 L 中的非零元数量**\n\n既然已经确定当 $i-j  p$ 时 $L_{ij}=0$，我们就可以计算 $L$ 中潜在非零元的数量。矩阵 $L$ 是下三角矩阵，所以当 $ji$ 时 $L_{ij}=0$。因此，非零元位于满足 $0 \\le i-j \\le p$ 和 $1 \\le j \\le i \\le n$ 的位置 $(i,j)$。\n\n我们可以通过对 $L$ 的每一列中的非零元数量求和来计算非零元的总数，记为 $N_{nz}$。对于给定的列 $j$，非零元可以出现在满足 $i \\ge j$ 和 $i \\le j+p$ 的行 $i$ 中。此外，行索引不能超过矩阵维度，即 $i \\le n$。因此，对于列 $j$，可能存在非零元的行 $i$ 位于集合 $\\{k \\mid j \\le k \\le \\min(n, j+p)\\}$ 中。这样的行数为 $\\min(n, j+p) - j + 1$。\n\n非零元的总数是所有列的总和：\n$$N_{nz} = \\sum_{j=1}^{n} (\\min(n, j+p) - j + 1)$$\n为了计算这个和，我们根据 $\\min$ 函数的行为将其分为两部分。表达式 $\\min(n, j+p)$ 在 $j+p=n$ 时（即 $j=n-p$ 时）改变形式。我们假设 $np$。\n\n情况1：列 $j=1, 2, \\dots, n-p$。\n对于这些列，$j+p \\le n$，所以 $\\min(n, j+p) = j+p$。这些列中每一列的非零元数量为 $(j+p) - j + 1 = p+1$。\n共有 $n-p$ 列这样的列。这部分的总贡献是 $(n-p)(p+1)$。\n\n情况2：列 $j=n-p+1, \\dots, n$。\n对于这些列，$j+p  n$，所以 $\\min(n, j+p) = n$。列 $j$ 中的非零元数量为 $n-j+1$。\n这些列的总贡献是和式 $\\sum_{j=n-p+1}^{n} (n-j+1)$。\n我们来分析这个和。当 $j=n-p+1$ 时，项为 $n-(n-p+1)+1=p$。当 $j=n-p+2$ 时，项为 $p-1$。对于最后一列 $j=n$，项为 $n-n+1 = 1$。这个和是 $p + (p-1) + \\dots + 1$，也就是前 $p$ 个正整数的和：\n$$\\sum_{k=1}^{p} k = \\frac{p(p+1)}{2}$$\n\n$L$ 中非零元的总数是两种情况贡献之和：\n$$N_{nz} = (n-p)(p+1) + \\frac{p(p+1)}{2}$$\n我们可以简化这个表达式：\n$$N_{nz} = n(p+1) - p(p+1) + \\frac{p(p+1)}{2}$$\n$$N_{nz} = n(p+1) - \\frac{p(p+1)}{2}$$\n此表达式给出了在 $np$ 的假设下，半带宽为 $p$ 的 SPD 带状矩阵 $A$ 的 Cholesky 因子 $L$ 中非零元的总数。",
            "answer": "$$\\boxed{n(p+1) - \\frac{p(p+1)}{2}}$$"
        }
    ]
}