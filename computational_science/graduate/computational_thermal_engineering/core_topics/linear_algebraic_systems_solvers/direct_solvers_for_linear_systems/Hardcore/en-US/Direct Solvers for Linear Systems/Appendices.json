{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering direct solvers is to connect the physical principles of engineering to the algebraic operations of linear algebra. This exercise guides you through the process of deriving the linear system for a fundamental one-dimensional heat conduction problem and performing a step-by-step LU factorization . By manually executing Gaussian elimination, you will gain a concrete understanding of how a physical system is transformed and prepared for solution.",
            "id": "3947263",
            "problem": "A homogeneous, slender rod of length $L$ and uniform thermal conductivity $k$ undergoes one-dimensional, steady-state heat conduction with no internal volumetric heat generation. The governing partial differential equation (PDE) is Fourier’s law combined with steady energy conservation, $-\\frac{d}{dx}\\!\\left(k\\,\\frac{dT}{dx}\\right)=0$, with Dirichlet boundary conditions $T(0)=T_{\\mathrm{L}}$ and $T(L)=T_{\\mathrm{R}}$. Discretize the domain using the finite difference method (FDM) on a uniform grid with $N_{i}=3$ interior nodes, so the grid spacing is $h=L/4$. Assemble the linear system for the interior nodal temperatures in the form $A\\,\\boldsymbol{T}=\\boldsymbol{b}$, where $A$ is the resulting $3\\times 3$ tridiagonal coefficient matrix.\n\nStarting from the fundamental balance and Fourier’s law, derive the interior-node finite difference equations, identify the explicit entries of $A$, and then perform Gaussian elimination without pivoting to factor $A$ as $A=L\\,U$, where $L$ is unit lower triangular and $U$ is upper triangular. In your derivation, explicitly write down the elimination multipliers and the entries of $L$ and $U$.\n\nFinally, compute the dimensionless determinant ratio\n$$\nD \\;=\\; \\frac{\\det(A)}{\\left(\\dfrac{k}{h^{2}}\\right)^{3}}.\n$$\nReport $D$ as an exact value (no rounding). The final answer must be a single real-valued number.",
            "solution": "The problem is validated as being scientifically grounded, well-posed, objective, and complete. It presents a standard problem in computational heat transfer that can be solved using established principles of the finite difference method and linear algebra.\n\nThe first step is to derive the finite difference approximation for the governing equation, starting from an energy balance on a control volume. The governing equation for one-dimensional, steady-state heat conduction with no internal heat generation and constant thermal conductivity $k$ is given by\n$$\n-\\frac{d}{dx}\\!\\left(k\\,\\frac{dT}{dx}\\right)=0\n$$\nSince $k$ is uniform, this simplifies to\n$$\nk\\frac{d^2T}{dx^2} = 0 \\quad \\text{or} \\quad \\frac{d^2T}{dx^2} = 0\n$$\nTo derive the finite difference equation from fundamental principles, we perform an energy balance on a control volume of length $h$ centered around an interior grid node $i$. The faces of this control volume are located at $x_{i-1/2} = x_i - h/2$ and $x_{i+1/2} = x_i + h/2$. For steady-state conditions, the rate of heat entering the control volume must equal the rate of heat exiting it. Let $\\dot{Q}$ be the heat transfer rate.\n$$\n\\dot{Q}_{\\text{in}} - \\dot{Q}_{\\text{out}} = 0\n$$\nHeat enters through the left face at $x_{i-1/2}$ and leaves through the right face at $x_{i+1/2}$. Thus,\n$$\n\\dot{Q}|_{x_{i-1/2}} - \\dot{Q}|_{x_{i+1/2}} = 0\n$$\nAccording to Fourier's law of heat conduction, the heat transfer rate $\\dot{Q}$ is related to the temperature gradient by $\\dot{Q} = -kA_c \\frac{dT}{dx}$, where $A_c$ is the cross-sectional area of the rod. Since the problem is one-dimensional, $A_c$ is constant and will cancel out. We can work with the heat flux $q = \\dot{Q}/A_c = -k \\frac{dT}{dx}$. The energy balance becomes:\n$$\nq|_{x_{i-1/2}} - q|_{x_{i+1/2}} = 0\n$$\nWe approximate the heat fluxes at the control volume faces using centered finite differences for the temperature gradients:\n$$\nq|_{x_{i-1/2}} \\approx -k \\frac{T_i - T_{i-1}}{h}\n$$\n$$\nq|_{x_{i+1/2}} \\approx -k \\frac{T_{i+1} - T_i}{h}\n$$\nSubstituting these approximations into the energy balance equation:\n$$\n\\left(-k \\frac{T_i - T_{i-1}}{h}\\right) - \\left(-k \\frac{T_{i+1} - T_i}{h}\\right) = 0\n$$\nMultiplying by $h/k$ (assuming $k \\neq 0$ and $h \\neq 0$):\n$$\n-(T_i - T_{i-1}) + (T_{i+1} - T_i) = 0\n$$\n$$\nT_{i-1} - 2T_i + T_{i+1} = 0\n$$\nThis is the finite difference equation for any interior node $i$. It is conventional to write this equation in a form that leads to a positive definite system matrix. By multiplying by $-\\frac{k}{h^2}$, we get:\n$$\n\\frac{k}{h^2} ( -T_{i-1} + 2T_i - T_{i+1} ) = 0\n$$\nThe domain is discretized with $N_i=3$ interior nodes, which implies a total of $N+1=4$ intervals and $5$ nodes, indexed from $0$ to $4$. The grid spacing is $h=L/4$. The unknown temperatures are $T_1$, $T_2$, and $T_3$. The boundary temperatures are known: $T_0 = T(0) = T_{\\mathrm{L}}$ and $T_4 = T(L) = T_{\\mathrm{R}}$.\n\nWe apply the finite difference equation at each interior node:\nFor node $i=1$:\n$$\n\\frac{k}{h^2} (-T_0 + 2T_1 - T_2) = 0 \\implies \\frac{k}{h^2} (2T_1 - T_2) = \\frac{k}{h^2}T_0 = \\frac{k}{h^2}T_{\\mathrm{L}}\n$$\nFor node $i=2$:\n$$\n\\frac{k}{h^2} (-T_1 + 2T_2 - T_3) = 0\n$$\nFor node $i=3$:\n$$\n\\frac{k}{h^2} (-T_2 + 2T_3 - T_4) = 0 \\implies \\frac{k}{h^2} (-T_2 + 2T_3) = \\frac{k}{h^2}T_4 = \\frac{k}{h^2}T_{\\mathrm{R}}\n$$\nThis system of linear equations can be written in matrix form $A\\boldsymbol{T}=\\boldsymbol{b}$:\n$$\n\\begin{pmatrix}\n2\\frac{k}{h^2} & -\\frac{k}{h^2} & 0 \\\\\n-\\frac{k}{h^2} & 2\\frac{k}{h^2} & -\\frac{k}{h^2} \\\\\n0 & -\\frac{k}{h^2} & 2\\frac{k}{h^2}\n\\end{pmatrix}\n\\begin{pmatrix}\nT_1 \\\\ T_2 \\\\ T_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{k}{h^2}T_{\\mathrm{L}} \\\\\n0 \\\\\n\\frac{k}{h^2}T_{\\mathrm{R}}\n\\end{pmatrix}\n$$\nThe coefficient matrix $A$ is:\n$$\nA = \\frac{k}{h^2}\n\\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2\\frac{k}{h^2} & -\\frac{k}{h^2} & 0 \\\\\n-\\frac{k}{h^2} & 2\\frac{k}{h^2} & -\\frac{k}{h^2} \\\\\n0 & -\\frac{k}{h^2} & 2\\frac{k}{h^2}\n\\end{pmatrix}\n$$\nNext, we perform Gaussian elimination without pivoting to obtain the $LU$ factorization of $A$. Let $\\gamma = \\frac{k}{h^2}$.\n$$\nA = \\begin{pmatrix}\n2\\gamma & -\\gamma & 0 \\\\\n-\\gamma & 2\\gamma & -\\gamma \\\\\n0 & -\\gamma & 2\\gamma\n\\end{pmatrix}\n$$\nThe goal is to transform $A$ into an upper triangular matrix $U$.\nThe first step is to eliminate the entry $A_{21}$. The multiplier is $l_{21} = \\frac{A_{21}}{A_{11}} = \\frac{-\\gamma}{2\\gamma} = -\\frac{1}{2}$. We perform the operation $R_2 \\leftarrow R_2 - l_{21}R_1$.\n$$\nR_2 - \\left(-\\frac{1}{2}\\right)R_1 = (-\\gamma, 2\\gamma, -\\gamma) + \\frac{1}{2}(2\\gamma, -\\gamma, 0) = (-\\gamma+\\gamma, 2\\gamma - \\frac{1}{2}\\gamma, -\\gamma) = (0, \\frac{3}{2}\\gamma, -\\gamma)\n$$\nThe matrix becomes:\n$$\nA^{(1)} = \\begin{pmatrix}\n2\\gamma & -\\gamma & 0 \\\\\n0 & \\frac{3}{2}\\gamma & -\\gamma \\\\\n0 & -\\gamma & 2\\gamma\n\\end{pmatrix}\n$$\nThe entry $A_{31}$ is already zero, so the multiplier $l_{31} = 0$.\nThe second step is to eliminate the entry $A_{32}$ from the updated matrix. The multiplier is $l_{32} = \\frac{A_{32}^{(1)}}{A_{22}^{(1)}} = \\frac{-\\gamma}{3\\gamma/2} = -\\frac{2}{3}$. We perform the operation $R_3 \\leftarrow R_3 - l_{32}R_2^{(1)}$.\n$$\nR_3 - \\left(-\\frac{2}{3}\\right)R_2^{(1)} = (0, -\\gamma, 2\\gamma) + \\frac{2}{3}(0, \\frac{3}{2}\\gamma, -\\gamma) = (0, -\\gamma+\\gamma, 2\\gamma - \\frac{2}{3}\\gamma) = (0, 0, \\frac{4}{3}\\gamma)\n$$\nThe final upper triangular matrix $U$ is:\n$$\nU = \\begin{pmatrix}\n2\\gamma & -\\gamma & 0 \\\\\n0 & \\frac{3}{2}\\gamma & -\\gamma \\\\\n0 & 0 & \\frac{4}{3}\\gamma\n\\end{pmatrix} = \\frac{k}{h^2}\\begin{pmatrix}\n2 & -1 & 0 \\\\\n0 & \\frac{3}{2} & -1 \\\\\n0 & 0 & \\frac{4}{3}\n\\end{pmatrix}\n$$\nThe unit lower triangular matrix $L$ is constructed from the multipliers:\n$$\nL = \\begin{pmatrix}\n1 & 0 & 0 \\\\\nl_{21} & 1 & 0 \\\\\nl_{31} & l_{32} & 1\n\\end{pmatrix} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n-\\frac{1}{2} & 1 & 0 \\\\\n0 & -\\frac{2}{3} & 1\n\\end{pmatrix}\n$$\nThe determinant of $A$ can be computed as $\\det(A) = \\det(L)\\det(U)$.\nThe determinant of a triangular matrix is the product of its diagonal entries.\n$$\n\\det(L) = 1 \\cdot 1 \\cdot 1 = 1\n$$\n$$\n\\det(U) = (2\\gamma) \\left(\\frac{3}{2}\\gamma\\right) \\left(\\frac{4}{3}\\gamma\\right) = \\left(2 \\cdot \\frac{3}{2} \\cdot \\frac{4}{3}\\right)\\gamma^3 = 4\\gamma^3\n$$\nTherefore, $\\det(A) = 1 \\cdot 4\\gamma^3 = 4\\gamma^3$. Substituting back $\\gamma = \\frac{k}{h^2}$:\n$$\n\\det(A) = 4\\left(\\frac{k}{h^2}\\right)^3\n$$\nFinally, we compute the dimensionless determinant ratio $D$:\n$$\nD = \\frac{\\det(A)}{\\left(\\dfrac{k}{h^{2}}\\right)^{3}} = \\frac{4\\left(\\dfrac{k}{h^{2}}\\right)^{3}}{\\left(\\dfrac{k}{h^{2}}\\right)^{3}} = 4\n$$",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "While Gaussian elimination is powerful, its numerical stability is not guaranteed for all types of matrices, a crucial consideration in computational fluid dynamics. This practice explores a convection-diffusion problem where the resulting matrix is non-symmetric and lacks strong diagonal dominance . By calculating the element growth factor during elimination, you will quantify the potential for numerical instability and understand the fundamental motivation for pivoting strategies in robust direct solvers.",
            "id": "3947234",
            "problem": "A one-dimensional, steady convection-diffusion energy balance for a passive scalar temperature field $T(x)$ with constant thermal conductivity $k$ and constant bulk flow speed $u$ is governed by the differential equation $-k \\frac{d^{2}T}{dx^{2}} + u \\frac{dT}{dx} = 0$ on a uniform grid of spacing $h$. Using central differencing for both the diffusion and convection terms on interior nodes $i$ produces a linear algebraic system of the form $A \\boldsymbol{T} = \\boldsymbol{b}$, where the interior-node stencil yields the coefficients $a_{P} = \\frac{2k}{h^{2}}$, $a_{W} = -\\frac{k}{h^{2}} - \\frac{u}{2h}$, and $a_{E} = -\\frac{k}{h^{2}} + \\frac{u}{2h}$. For a four-node interior discretization with Dirichlet boundary conditions at the domain ends, the coefficient matrix $A$ is non-symmetric tridiagonal. When the convective contribution is sufficiently strong relative to the diffusive contribution, diagonal dominance can be weak. In such cases, direct solvers based on Gaussian elimination (GE) without pivoting may exhibit element growth.\n\nConsider the case $k = 1$, $u = 3$, and $h = 1$. Assemble the resulting $4 \\times 4$ matrix $A$ associated solely with the interior-node coefficients (boundary contributions appear only in the right-hand side and do not affect the elimination on $A$). Perform Gaussian elimination without any pivoting on $A$ to form an upper triangular matrix $U$. Define the growth factor as \n$$\\rho = \\frac{\\max\\limits_{i,j} |u_{ij}|}{\\max\\limits_{i,j} |a_{ij}|},$$ \nwhere $a_{ij}$ are the entries of the original matrix $A$ and $u_{ij}$ are the entries of the resulting upper triangular matrix $U$ produced by elimination. Compute $\\rho$ for this $4 \\times 4$ example and express your final answer as an exact fraction. No rounding is required. The final answer must be a single real number without units.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of computational thermal engineering and numerical linear algebra, it is well-posed with all necessary data provided, and its language is objective and precise.\n\nThe problem requires a three-part calculation: first, assembling a coefficient matrix $A$ based on a finite difference discretization of a convection-diffusion equation; second, performing Gaussian elimination on $A$ to obtain an upper triangular matrix $U$; and third, computing the element growth factor $\\rho$.\n\nThe governing differential equation is given as $-k \\frac{d^{2}T}{dx^{2}} + u \\frac{dT}{dx} = 0$.\nThe physical parameters are specified as thermal conductivity $k = 1$, bulk flow speed $u = 3$, and uniform grid spacing $h = 1$.\n\nThe coefficients for the interior-node stencil of the linear system $A \\boldsymbol{T} = \\boldsymbol{b}$ are defined as:\n$a_{P} = \\frac{2k}{h^{2}}$ (main diagonal)\n$a_{W} = -\\frac{k}{h^{2}} - \\frac{u}{2h}$ (sub-diagonal)\n$a_{E} = -\\frac{k}{h^{2}} + \\frac{u}{2h}$ (super-diagonal)\n\nSubstituting the given values $k=1$, $u=3$, and $h=1$:\n$a_{P} = \\frac{2(1)}{(1)^{2}} = 2$\n$a_{W} = -\\frac{1}{(1)^{2}} - \\frac{3}{2(1)} = -1 - \\frac{3}{2} = -\\frac{5}{2}$\n$a_{E} = -\\frac{1}{(1)^{2}} + \\frac{3}{2(1)} = -1 + \\frac{3}{2} = \\frac{1}{2}$\n\nThe problem specifies a four-node interior discretization, which results in a $4 \\times 4$ non-symmetric tridiagonal matrix $A$. The structure of this matrix, using the calculated coefficients, is:\n$$\nA = \n\\begin{pmatrix}\na_{P} & a_{E} & 0 & 0 \\\\\na_{W} & a_{P} & a_{E} & 0 \\\\\n0 & a_{W} & a_{P} & a_{E} \\\\\n0 & 0 & a_{W} & a_{P}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2 & \\frac{1}{2} & 0 & 0 \\\\\n-\\frac{5}{2} & 2 & \\frac{1}{2} & 0 \\\\\n0 & -\\frac{5}{2} & 2 & \\frac{1}{2} \\\\\n0 & 0 & -\\frac{5}{2} & 2\n\\end{pmatrix}\n$$\n\nNext, we perform Gaussian elimination without pivoting to transform $A$ into an upper triangular matrix $U$. Let $A^{(0)} = A$.\n\nStep 1: Eliminate $a_{21}$.\nThe multiplier is $m_{21} = \\frac{a_{21}}{a_{11}} = \\frac{-5/2}{2} = -\\frac{5}{4}$.\nThe second row is updated: $R_2 \\leftarrow R_2 - m_{21} R_1$.\n$a_{22}^{(1)} = a_{22} - m_{21} a_{12} = 2 - (-\\frac{5}{4})(\\frac{1}{2}) = 2 + \\frac{5}{8} = \\frac{16}{8} + \\frac{5}{8} = \\frac{21}{8}$.\nThe matrix becomes:\n$$\nA^{(1)} = \n\\begin{pmatrix}\n2 & \\frac{1}{2} & 0 & 0 \\\\\n0 & \\frac{21}{8} & \\frac{1}{2} & 0 \\\\\n0 & -\\frac{5}{2} & 2 & \\frac{1}{2} \\\\\n0 & 0 & -\\frac{5}{2} & 2\n\\end{pmatrix}\n$$\n\nStep 2: Eliminate $a_{32}^{(1)}$.\nThe multiplier is $m_{32} = \\frac{a_{32}^{(1)}}{a_{22}^{(1)}} = \\frac{-5/2}{21/8} = -\\frac{5}{2} \\times \\frac{8}{21} = -\\frac{20}{21}$.\nThe third row is updated: $R_3 \\leftarrow R_3 - m_{32} R_2$.\n$a_{33}^{(2)} = a_{33}^{(1)} - m_{32} a_{23}^{(1)} = 2 - (-\\frac{20}{21})(\\frac{1}{2}) = 2 + \\frac{10}{21} = \\frac{42}{21} + \\frac{10}{21} = \\frac{52}{21}$.\nThe matrix becomes:\n$$\nA^{(2)} = \n\\begin{pmatrix}\n2 & \\frac{1}{2} & 0 & 0 \\\\\n0 & \\frac{21}{8} & \\frac{1}{2} & 0 \\\\\n0 & 0 & \\frac{52}{21} & \\frac{1}{2} \\\\\n0 & 0 & -\\frac{5}{2} & 2\n\\end{pmatrix}\n$$\n\nStep 3: Eliminate $a_{43}^{(2)}$.\nThe multiplier is $m_{43} = \\frac{a_{43}^{(2)}}{a_{33}^{(2)}} = \\frac{-5/2}{52/21} = -\\frac{5}{2} \\times \\frac{21}{52} = -\\frac{105}{104}$.\nThe fourth row is updated: $R_4 \\leftarrow R_4 - m_{43} R_3$.\n$a_{44}^{(3)} = a_{44}^{(2)} - m_{43} a_{34}^{(2)} = 2 - (-\\frac{105}{104})(\\frac{1}{2}) = 2 + \\frac{105}{208} = \\frac{416}{208} + \\frac{105}{208} = \\frac{521}{208}$.\n\nThe final upper triangular matrix $U$ is:\n$$\nU = A^{(3)} = \n\\begin{pmatrix}\n2 & \\frac{1}{2} & 0 & 0 \\\\\n0 & \\frac{21}{8} & \\frac{1}{2} & 0 \\\\\n0 & 0 & \\frac{52}{21} & \\frac{1}{2} \\\\\n0 & 0 & 0 & \\frac{521}{208}\n\\end{pmatrix}\n$$\n\nThe growth factor $\\rho$ is defined as $\\rho = \\frac{\\max\\limits_{i,j} |u_{ij}|}{\\max\\limits_{i,j} |a_{ij}|}$.\n\nFirst, we find the maximum absolute value of the elements in the original matrix $A$:\n$A = \\begin{pmatrix} 2 & \\frac{1}{2} & 0 & 0 \\\\ -\\frac{5}{2} & 2 & \\frac{1}{2} & 0 \\\\ 0 & -\\frac{5}{2} & 2 & \\frac{1}{2} \\\\ 0 & 0 & -\\frac{5}{2} & 2 \\end{pmatrix}$.\nThe set of absolute values of the elements is $\\{|2|, |\\frac{1}{2}|, |0|, |-\\frac{5}{2}|\\} = \\{2, \\frac{1}{2}, 0, \\frac{5}{2}\\}$.\n$\\max\\limits_{i,j} |a_{ij}| = \\frac{5}{2} = 2.5$.\n\nNext, we find the maximum absolute value of the elements in the final matrix $U$:\n$U = \\begin{pmatrix} 2 & \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{21}{8} & \\frac{1}{2} & 0 \\\\ 0 & 0 & \\frac{52}{21} & \\frac{1}{2} \\\\ 0 & 0 & 0 & \\frac{521}{208} \\end{pmatrix}$.\nThe non-zero elements are $\\{2, \\frac{1}{2}, \\frac{21}{8}, \\frac{52}{21}, \\frac{521}{208}\\}$.\nTo compare them, we can convert to decimals or a common denominator:\n$2 = 2.0$\n$\\frac{1}{2} = 0.5$\n$\\frac{21}{8} = 2.625$\n$\\frac{52}{21} \\approx 2.476$\n$\\frac{521}{208} \\approx 2.5048$\nThe maximum value is clearly $\\frac{21}{8}$.\n$\\max\\limits_{i,j} |u_{ij}| = \\frac{21}{8}$.\n\nFinally, we compute the growth factor $\\rho$:\n$$\n\\rho = \\frac{\\max\\limits_{i,j} |u_{ij}|}{\\max\\limits_{i,j} |a_{ij}|} = \\frac{21/8}{5/2} = \\frac{21}{8} \\times \\frac{2}{5} = \\frac{42}{40} = \\frac{21}{20}\n$$\nThe growth factor is $\\frac{21}{20}$, which is greater than $1$, indicating that element growth occurred during the elimination process, as expected for a convection-dominated problem that is not diagonally dominant.",
            "answer": "$$\\boxed{\\frac{21}{20}}$$"
        },
        {
            "introduction": "The efficiency of direct solvers for large-scale problems hinges on exploiting the underlying structure of the coefficient matrix. This exercise focuses on symmetric positive definite (SPD) systems, which commonly arise in diffusion-based problems, and their solution via Cholesky factorization . You will analyze the concept of 'fill-in' to understand why the banded structure of matrices from PDE discretizations is preserved, making direct methods computationally feasible for many engineering applications.",
            "id": "3947243",
            "problem": "A steady-state heat conduction boundary value problem on a one-dimensional domain with spatially varying conductivity is described by the second-order linear partial differential equation (PDE)\n$$-\\frac{d}{dx}\\left(k(x)\\frac{dT}{dx}\\right)=q(x),$$\nwith Dirichlet boundary conditions at the endpoints. Consider a high-order, linear, conservative discretization (for example, a finite difference method using an odd-$2p+1$-point compact stencil that couples each node to its $p$ nearest neighbors on either side), yielding a symmetric positive definite (SPD) coefficient matrix $A \\in \\mathbb{R}^{n \\times n}$ with half-bandwidth $p$, meaning\n$$A_{ij}=0 \\quad \\text{whenever} \\quad |i-j|>p.$$\nIn a direct solver based on Cholesky factorization, one computes $A=L\\,L^{\\top}$, where $L$ is lower triangular. Under the natural ordering of unknowns (left-to-right nodes), use the graph interpretation of Gaussian elimination and the structure of Schur complements to justify whether any fill-in can occur outside the original band during the Cholesky process for this SPD banded matrix. Then, by counting the potential nonzeros column-by-column in the lower triangular factor, derive a closed-form expression for the total number of nonzero entries in $L$ as a function of $n$ and $p$.\n\nExpress your final answer as a single analytic expression in terms of $n$ and $p$. No rounding is required, and no physical units are needed.",
            "solution": "The problem asks for an analysis of the Cholesky factorization $A=LL^{\\top}$ of a symmetric positive definite (SPD) banded matrix $A \\in \\mathbb{R}^{n \\times n}$ with half-bandwidth $p$. The analysis has two parts: first, to determine if fill-in occurs outside the original band, and second, to derive a formula for the total number of nonzero entries in the lower triangular factor $L$.\n\nThe matrix $A$ originates from a discretization with a natural (left-to-right) ordering of unknowns. Its structure is defined by $A_{ij}=0$ whenever $|i-j|>p$. Let us assume that $n > p$, which is characteristic of fine discretizations of partial differential equations where the number of grid points $n$ far exceeds the stencil width parameter $p$.\n\n**Part 1: Analysis of Fill-in**\n\nThe fill-in pattern during Cholesky factorization can be precisely described using the graph of the matrix. Let $G(A)=(V, E)$ be the graph associated with the matrix $A$, where the set of vertices is $V=\\{1, 2, \\dots, n\\}$ corresponding to the indices of the unknowns, and the set of edges is $E = \\{(i, j) \\mid A_{ij} \\neq 0, i \\neq j\\}$. Due to the banded structure of $A$, an edge $(i, j)$ exists in $G(A)$ if and only if $0 < |i-j| \\le p$.\n\nA key result from the theory of sparse matrices, often called the fill-path theorem, states that for a Cholesky factorization $A=LL^{\\top}$ performed with the natural ordering of vertices, an entry $L_{ij}$ with $i>j$ is nonzero if and only if there is a path from vertex $i$ to vertex $j$ in the graph $G(A)$ that consists entirely of intermediate vertices $v_k$ with indices smaller than $j$. That is, there must exist a path $i=v_0, v_1, \\dots, v_m=j$ such that $(v_k, v_{k+1}) \\in E$ for all $k \\in \\{0, \\dots, m-1\\}$, and $v_k < j$ for all intermediate vertices $k \\in \\{1, \\dots, m-1\\}$.\n\nWe wish to determine if any fill-in can occur outside the original band of $A$. This is equivalent to asking if $L_{ij}$ can be nonzero for any pair $(i, j)$ where $i-j > p$. For such a pair, the original entry $A_{ij}$ is zero.\n\nLet us assume $i-j > p$. For $L_{ij}$ to become nonzero, there must exist a fill-path as described above. Let this path be $i=v_0, v_1, \\dots, v_m=j$. The first step on this path is from vertex $i$ to an adjacent vertex $v_1$. For $(i, v_1)$ to be an edge in $G(A)$, it must satisfy $|i-v_1| \\le p$. The requirement for a fill-path is that the intermediate vertex $v_1$ must satisfy $v_1 < j$.\n\nFrom the edge condition, any neighbor $v_1$ of $i$ must be in the range $[i-p, i+p]$. Any neighbor $v_1$ with an index smaller than $i$ must satisfy $v_1 \\ge i-p$.\n\nFrom our initial assumption, $i-j > p$, which can be rewritten as $i-p > j$.\n\nCombining these two facts, any neighbor $v_1$ of $i$ must satisfy $v_1 \\ge i-p > j$. This means that every neighbor of vertex $i$ has an index greater than $j$. Consequently, it is impossible to find a path from $i$ to $j$ that begins by moving to a vertex $v_1$ with an index less than $j$. No such fill-path exists.\n\nTherefore, we conclude that if $i-j > p$, then $L_{ij}$ must be zero. This proves that no fill-in occurs outside the original band. The lower triangular factor $L$ is also a banded matrix with a lower bandwidth of $p$. Specifically, the nonzero entries of $L$ are confined to the diagonal and the $p$ sub-diagonals immediately below it.\n\n**Part 2: Counting Nonzero Entries in L**\n\nHaving established that $L_{ij}=0$ for $i-j > p$, we can count the number of potentially nonzero entries in $L$. The matrix $L$ is lower triangular, so $L_{ij}=0$ for $j>i$. The nonzeros are thus located at positions $(i,j)$ satisfying $0 \\le i-j \\le p$ and $1 \\le j \\le i \\le n$.\n\nWe can count the total number of nonzeros, denoted $N_{nz}$, by summing the number of nonzeros in each column of $L$. For a given column $j$, the nonzero entries can occur in rows $i$ that satisfy both $i \\ge j$ and $i \\le j+p$. Additionally, the row index must not exceed the matrix dimension, i.e., $i \\le n$. Thus, for column $j$, the rows $i$ with potentially nonzero entries are in the set $\\{k \\mid j \\le k \\le \\min(n, j+p)\\}$. The number of such rows is $\\min(n, j+p) - j + 1$.\n\nThe total number of nonzeros is the sum over all columns:\n$$N_{nz} = \\sum_{j=1}^{n} (\\min(n, j+p) - j + 1)$$\nTo evaluate this sum, we split it into two parts based on the behavior of the $\\min$ function. The expression $\\min(n, j+p)$ changes form when $j+p=n$, i.e., at $j=n-p$. We assume $n>p$.\n\nCase 1: Columns $j=1, 2, \\dots, n-p$.\nFor these columns, $j+p \\le n$, so $\\min(n, j+p) = j+p$. The number of nonzeros in each of these columns is $(j+p) - j + 1 = p+1$.\nThere are $n-p$ such columns. The total contribution from this part is $(n-p)(p+1)$.\n\nCase 2: Columns $j=n-p+1, \\dots, n$.\nFor these columns, $j+p > n$, so $\\min(n, j+p) = n$. The number of nonzeros in column $j$ is $n-j+1$.\nThe total contribution from these columns is the sum $\\sum_{j=n-p+1}^{n} (n-j+1)$.\nLet's analyze this sum. For $j=n-p+1$, the term is $n-(n-p+1)+1=p$. For $j=n-p+2$, the term is $p-1$. For the last column $j=n$, the term is $n-n+1 = 1$. The sum is $p + (p-1) + \\dots + 1$, which is the sum of the first $p$ positive integers:\n$$\\sum_{k=1}^{p} k = \\frac{p(p+1)}{2}$$\n\nThe total number of nonzero entries in $L$ is the sum of the contributions from both cases:\n$$N_{nz} = (n-p)(p+1) + \\frac{p(p+1)}{2}$$\nWe can simplify this expression:\n$$N_{nz} = n(p+1) - p(p+1) + \\frac{p(p+1)}{2}$$\n$$N_{nz} = n(p+1) - \\frac{p(p+1)}{2}$$\nThis expression gives the total number of nonzero entries in the Cholesky factor $L$ for an SPD banded matrix $A$ with half-bandwidth $p$, under the assumption $n>p$.",
            "answer": "$$\\boxed{n(p+1) - \\frac{p(p+1)}{2}}$$"
        }
    ]
}