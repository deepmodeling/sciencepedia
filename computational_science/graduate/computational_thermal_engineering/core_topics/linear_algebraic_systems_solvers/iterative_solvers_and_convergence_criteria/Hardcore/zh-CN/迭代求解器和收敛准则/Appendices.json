{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握迭代求解器，必须理解它们如何从物理定律的离散化中构建而来。本练习  将理论与实践相结合，引导您从基本的热传导泊松方程出发，构建经典的迭代方法。通过分析雅可比法的收敛特性，您将学会如何确定逐次超松弛（SOR）法的最优松弛参数，这是加速收敛的一项关键技能。",
            "id": "3965780",
            "problem": "考虑一个均匀固体中的稳态二维传导，其温度场 $T(x,y)$ 由能量守恒的泊松形式 $-\\nabla^{2} T = f(x,y)$ 控制。该问题定义在单位正方形 $\\Omega = (0,1) \\times (0,1)$ 上，并在边界 $\\partial \\Omega$ 上具有齐次狄利克雷边界条件 $T = 0$。使用具有 $N \\times N$ 个内部点、在两个方向上步长均为 $h = \\frac{1}{N+1}$ 的均匀笛卡尔网格对 $\\Omega$ 进行离散化，并使用标准的5点中心差分格式在内部节点 $(i,j)$ 处近似 $-\\nabla^{2} T$。以自然字典序（索引 $i$ 变化最快）组合生成的线性系统，并定义矩阵分裂 $A = D - L - U$，其中 $D$ 是对角部分，$L$ 和 $U$ 分别是严格下三角和严格上三角部分。\n\n从离散守恒律和分裂的定义出发，完成以下任务：\n\n(a) 为组合矩阵 $A$ 构建 $D$、$L$ 和 $U$，并写出雅可比法、高斯-赛德尔法和逐次超松弛法（Successive Over-Relaxation (SOR)）（松弛因子 $\\omega \\in (0,2)$）对应的节点迭代更新公式。\n\n(b) 对于齐次情况 $f \\equiv 0$，通过将误差在满足狄利克雷边界的离散正弦基中展开，分析雅可比迭代的误差传播。确定雅可比迭代矩阵的谱半径 $\\rho_{J}(N)$，作为 $N$ 的显式函数。\n\n(c) 利用关于均匀网格上离散泊松算子的一致有序分裂的成熟结论，推导使SOR迭代矩阵谱半径最小化的松弛因子 $\\omega_{\\mathrm{opt}}(N)$（用 $\\rho_{J}(N)$ 表示）。将 $\\omega_{\\mathrm{opt}}(N)$ 表示为闭合形式。\n\n你的最终答案必须是 $\\omega_{\\mathrm{opt}}(N)$ 的单一解析表达式，不得进行数值代入和舍入。不需要单位。",
            "solution": "控制方程 $-\\nabla^{2} T = f$ 在边界 $\\partial \\Omega$ 上具有齐次狄利克雷边界条件 $T=0$，在两个方向上步长均为 $h = \\frac{1}{N+1}$ 的均匀网格上进行离散化。在内部节点 $(i,j)$ 处的标准5点中心差分格式给出\n$$\n-\\frac{T_{i+1,j} - 2 T_{i,j} + T_{i-1,j}}{h^{2}} - \\frac{T_{i,j+1} - 2 T_{i,j} + T_{i,j-1}}{h^{2}} = f_{i,j}.\n$$\n两边同乘以 $h^{2}$ 得到无量纲线性关系\n$$\n- T_{i+1,j} + 2 T_{i,j} - T_{i-1,j} - T_{i,j+1} + 2 T_{i,j} - T_{i,j-1} = h^{2} f_{i,j},\n$$\n可以写成\n$$\n4 T_{i,j} - \\left( T_{i+1,j} + T_{i-1,j} + T_{i,j+1} + T_{i,j-1} \\right) = h^{2} f_{i,j}.\n$$\n以自然字典序组合未知数后，矩阵 $A \\in \\mathbb{R}^{N^{2} \\times N^{2}}$ 是一个稀疏矩阵，其对角线元素等于 $4$，非对角线元素等于 $-1$，连接每个内部节点与其四个最近的邻居（由于狄利克雷条件，在边界处有适当的截断）。因此，分裂 $A = D - L - U$ 具有\n- $D$ 是对角矩阵，其对角线元素全为 $4$，\n- $L$ 包含严格下三角的邻居耦合项，其元素为 $1$（因为 $A$ 的非对角线元素为 $-1$，而我们写作 $A = D - L - U$），\n- $U$ 包含严格上三角的邻居耦合项，其元素为 $1$。\n\n由此，根据各种方法的定义，可以直接得出节点迭代更新公式。\n\n雅可比法。雅可比法使用\n$$\nT^{(k+1)} = D^{-1} \\left( L + U \\right) T^{(k)} + D^{-1} b,\n$$\n在节点 $(i,j)$ 处为\n$$\nT_{i,j}^{(k+1)} = \\frac{1}{4} \\left( T_{i+1,j}^{(k)} + T_{i-1,j}^{(k)} + T_{i,j+1}^{(k)} + T_{i,j-1}^{(k)} + h^{2} f_{i,j} \\right).\n$$\n\n高斯–赛德尔法。高斯–赛德尔法使用\n$$\nT^{(k+1)} = \\left( D - L \\right)^{-1} U \\, T^{(k)} + \\left( D - L \\right)^{-1} b,\n$$\n在字典序扫描中，节点 $(i,j)$ 处的公式（使用“西”和“南”邻居的最新可用值）为\n$$\nT_{i,j}^{(k+1)} = \\frac{1}{4} \\left( T_{i+1,j}^{(k)} + T_{i-1,j}^{(k+1)} + T_{i,j+1}^{(k)} + T_{i,j-1}^{(k+1)} + h^{2} f_{i,j} \\right).\n$$\n\n逐次超松弛法（SOR）。带有松弛因子 $\\omega \\in (0,2)$ 的SOR方法使用\n$$\nT^{(k+1)} = \\left( D - \\omega L \\right)^{-1} \\left( (1 - \\omega) D + \\omega U \\right) T^{(k)} + \\omega \\left( D - \\omega L \\right)^{-1} b,\n$$\n在节点 $(i,j)$ 处产生逐点更新公式\n$$\nT_{i,j}^{(k+1)} = (1 - \\omega) \\, T_{i,j}^{(k)} + \\frac{\\omega}{4} \\left( T_{i+1,j}^{(k)} + T_{i-1,j}^{(k+1)} + T_{i,j+1}^{(k)} + T_{i,j-1}^{(k+1)} + h^{2} f_{i,j} \\right).\n$$\n\n为了进行收敛性分析，我们考虑齐次情况 $f \\equiv 0$ 并研究误差传播。令 $e^{(k)} = T^{(k)} - T^{\\ast}$ 表示误差，其中 $T^{\\ast}$ 是精确的离散解。对于任何定常迭代法 $T^{(k+1)} = M T^{(k)} + c$，误差演化为 $e^{(k+1)} = M e^{(k)}$。$M$ 的谱半径决定了线性收敛性：该方法收敛当且仅当谱半径小于 $1$。\n\n(b)部分：通过离散正弦模计算雅可比谱半径。对于均匀网格上的狄利克雷边界，误差可以在离散正弦基中展开\n$$\n\\phi_{p,q}(i,j) = \\sin\\!\\left( \\frac{\\pi p i}{N+1} \\right) \\sin\\!\\left( \\frac{\\pi q j}{N+1} \\right), \\quad p,q \\in \\{1,2,\\dots,N\\}.\n$$\n对于雅可比法，节点 $(i,j)$ 处的误差更新为\n$$\ne_{i,j}^{(k+1)} = \\frac{1}{4} \\left( e_{i+1,j}^{(k)} + e_{i-1,j}^{(k)} + e_{i,j+1}^{(k)} + e_{i,j-1}^{(k)} \\right).\n$$\n假设一个模态 $e^{(k)} = \\mu^{k} \\phi_{p,q}$，因此 $e_{i\\pm 1,j}^{(k)} = \\mu^{k} \\sin\\!\\left( \\frac{\\pi p (i \\pm 1)}{N+1} \\right) \\sin\\!\\left( \\frac{\\pi q j}{N+1} \\right)$，在 $j$ 方向上类似。使用三角恒等式 $\\sin(a \\pm b) = \\sin(a) \\cos(b) \\pm \\cos(a) \\sin(b)$ 和对称性 $\\sin(a+1) + \\sin(a-1) = 2 \\sin(a) \\cos(1)$，其中 $1$ 理解为网格相位增量 $\\frac{\\pi p}{N+1}$，我们得到\n$$\ne_{i+1,j}^{(k)} + e_{i-1,j}^{(k)} = 2 \\mu^{k} \\cos\\!\\left( \\frac{\\pi p}{N+1} \\right) \\phi_{p,q}(i,j), \\quad e_{i,j+1}^{(k)} + e_{i,j-1}^{(k)} = 2 \\mu^{k} \\cos\\!\\left( \\frac{\\pi q}{N+1} \\right) \\phi_{p,q}(i,j).\n$$\n因此\n$$\ne_{i,j}^{(k+1)} = \\mu^{k} \\left[ \\frac{1}{4} \\left( 2 \\cos\\!\\left( \\frac{\\pi p}{N+1} \\right) + 2 \\cos\\!\\left( \\frac{\\pi q}{N+1} \\right) \\right) \\right] \\phi_{p,q}(i,j) = \\mu^{k} \\left[ \\frac{1}{2} \\left( \\cos\\!\\left( \\frac{\\pi p}{N+1} \\right) + \\cos\\!\\left( \\frac{\\pi q}{N+1} \\right) \\right) \\right] \\phi_{p,q}(i,j).\n$$\n因此，每个模态都是雅可比迭代矩阵 $B_{J} = D^{-1}(L+U)$ 的一个特征向量，其特征值为\n$$\n\\mu_{p,q} = \\frac{1}{2} \\left( \\cos\\!\\left( \\frac{\\pi p}{N+1} \\right) + \\cos\\!\\left( \\frac{\\pi q}{N+1} \\right) \\right).\n$$\n谱半径是 $|\\mu_{p,q}|$ 在所有允许的 $p,q$ 上的最大值。由于 $\\cos(\\cdot)$ 从 $1$ 递减到 $-1$ 并且绝对值是对称的，最大值出现在 $p = q = 1$ 时，得到\n$$\n\\rho_{J}(N) = \\mu_{1,1} = \\frac{1}{2} \\left( \\cos\\!\\left( \\frac{\\pi}{N+1} \\right) + \\cos\\!\\left( \\frac{\\pi}{N+1} \\right) \\right) = \\cos\\!\\left( \\frac{\\pi}{N+1} \\right).\n$$\n\n(c)部分：用 $\\rho_{J}(N)$ 表示最优SOR参数。对于采用自然字典序的均匀网格上的离散泊松算子，其分裂是一致有序的。一个关于一致有序分裂的成熟结论（例如，参见矩阵迭代分析中的标准结果）是，高斯-赛德尔迭代矩阵 $B_{GS} = (D - L)^{-1} U$ 的特征值是 $B_{J}$ 特征值的平方，即\n$$\n\\mu_{GS,p,q} = \\mu_{p,q}^{2},\n$$\n使得\n$$\n\\rho_{GS}(N) = \\rho_{J}(N)^{2}.\n$$\n另一个由 Young 和 Varga 提出的关于一致有序分裂上逐次超松弛法的成熟结果是，通过选择以下 $\\omega$ 值可以最小化谱半径 $\\rho_{SOR}(\\omega)$\n$$\n\\omega_{\\mathrm{opt}} = \\frac{2}{1 + \\sqrt{1 - \\rho_{J}^{2}}}.\n$$\n直观上，这可以通过分析SOR下每个模态的误差传播因子得出。可以观察到，对于一致有序分裂，给定模态的SOR迭代矩阵的特征值受到雅可比特征值的约束；在 $\\omega \\in (0,2)$ 上进行优化，平衡了两个贡献根，以最小化它们的共同幅值，从而得到上述用 $\\rho_{J}$ 表示的闭合形式表达式。将(b)部分中求得的 $\\rho_{J}(N)$ 的显式表达式代入，可得\n$$\n\\omega_{\\mathrm{opt}}(N) = \\frac{2}{1 + \\sqrt{\\,1 - \\left[ \\cos\\!\\left( \\frac{\\pi}{N+1} \\right) \\right]^{2}\\,}} = \\frac{2}{1 + \\sin\\!\\left( \\frac{\\pi}{N+1} \\right) }.\n$$\n这就是所要求的最优松弛因子作为 $N$ 的函数的闭合形式表达式。",
            "answer": "$$\\boxed{\\frac{2}{1+\\sin\\!\\left(\\frac{\\pi}{N+1}\\right)}}$$"
        },
        {
            "introduction": "尽管经典方法在求解对称问题时表现良好，但真实的传热工程问题常常涉及对流，这会导致非对称和非正规的线性系统，求解器可能在其中出现“停滞”现象。本练习  呈现了一个真实场景：一个看似收敛的解实际上与正确解相去甚远，从而揭示了依赖简单停止准则的危险。理解这种失效模式是迈向开发稳健可靠的仿真流程的关键一步。",
            "id": "3965783",
            "problem": "您正在求解一个稳态一维对流-扩散传热问题，\n$$-\\,\\kappa\\,\\frac{d^2 T}{dx^2} + u\\,\\frac{d T}{dx} = q(x),\\quad x\\in [0,1],$$\n该问题具有狄利克雷边界条件，在间距为 $\\Delta x$ 的均匀网格上采用迎风有限差分格式进行离散。对于中等大小的佩克莱数 $Pe = u\\,\\Delta x/\\kappa$ （例如，$Pe \\approx 20$），所得的线性系统 $A x = b$ 是非对称且强非正规的。您使用重启步长为 $m$ 的重启广义最小残差 (GMRES) 方法，并采用标准 Gram–Schmidt 正交化，在双精度下运行。当前的停止准则在相对更新量满足以下条件时判断为收敛：\n$$\\frac{\\lVert x_{k+1} - x_k\\rVert}{\\lVert x_{k+1}\\rVert} \\le 10^{-8}。$$\n在实践中，这个准则被满足了，但显式地重新计算真实残差，\n$$r_k^{\\mathrm{true}} = b - A x_k,$$\n的结果显示 $\\lVert r_k^{\\mathrm{true}}\\rVert \\approx 10^{-2}$，并且解在靠近出口的控制体积中仍然表现出显著的能量不平衡，表明出现了停滞。\n\n从残差 $r_k = b - A x_k$、误差 $e_k = x_\\star - x_k$ (其中 $A x_\\star = b$) 和更新量 $s_k = x_{k+1} - x_k$ 的基本定义出发，仅使用范数不等式和非正规矩阵的基本性质 (即 $A A^\\ast \\ne A^\\ast A$)，回答以下问题。选择所有正确的陈述，并共同解释为什么在这种情况下，基于 $\\lVert x_{k+1} - x_k\\rVert$ 的停止准则可能无法检测到停滞，以及如何使用残差重计算来纠正这个问题。\n\nA. 对于一个非正规矩阵 $A$，较小的 $\\lVert s_k\\rVert$ 并不意味着较小的 $\\lVert r_k\\rVert$，因为 $r_{k+1} = r_k - A s_k$，所以残差的变化量受限于 $\\lVert A\\rVert\\,\\lVert s_k\\rVert$，即使 $\\lVert r_k\\rVert$ 本身仍然很大，这个变化量也可能很小；此外，非正规性可能使 $s_k$ 与那些不能有效减小 $\\lVert r_k\\rVert$ 的方向对齐。\n\nB. 在通过递推式 $r_{k+1} = r_k - A s_k$ 更新 $r_k$ 的 Krylov 子空间方法中，浮点舍入误差和正交性的丧失可能导致存储的（递推更新的）残差偏离真实残差 $r_k^{\\mathrm{true}} = b - A x_k$，尤其对于非正规矩阵 $A$。因此，依赖 $\\lVert s_k\\rVert$ 会掩盖残差的停滞；一个纠正方法是周期性地重新计算 $r_k^{\\mathrm{true}}$ 并将递推重置为该值。\n\nC. 如果 $A$ 的谱半径小于1，那么 $\\lVert x_{k+1} - x_k\\rVert$ 和 $\\lVert r_k\\rVert$ 保证是等价范数，因此无论非正规性如何，基于更新量的停止准则都是安全的。\n\nD. 一个稳健的修复方法是简单地收紧更新量的容差（例如，将 $10^{-8}$ 替换为 $10^{-12}$）；这保证了非正规性和舍入误差不会导致假收敛。\n\nE. 一个稳健的替代停止准则是一个基于重计算残差的范数形式的后向误差准则，\n$$\\eta_k \\equiv \\frac{\\lVert r_k^{\\mathrm{true}}\\rVert}{\\lVert A\\rVert\\,\\lVert x_k\\rVert + \\lVert b\\rVert},$$\n并在 $\\eta_k \\le \\text{tol}$ 时终止；周期性地重计算 $r_k^{\\mathrm{true}}$ 可以防止由舍入误差引起的漂移，并减轻非正规放大效应对停止决策的影响。\n\n选择所有适用项，并从第一性原理出发证明你的选择，不引用任何未提供的专门定理或特定于软件的细节。",
            "solution": "用户需要对一个关于 GMRES 方法收敛性的数值线性代数问题进行批判性分析。我将验证问题陈述，然后基于基本原理评估每个选项。\n\n## 问题验证\n\n### 步骤1：提取已知条件\n\n*   **控制方程:** 一维稳态对流-扩散：$-\\,\\kappa\\,\\frac{d^2 T}{dx^2} + u\\,\\frac{d T}{dx} = q(x)$，定义域为 $x\\in [0,1]$。\n*   **边界条件:** 狄利克雷边界条件。\n*   **离散化:** 间距为 $\\Delta x$ 的均匀网格上的迎风有限差分格式。\n*   **系统参数:** 佩克莱数 $Pe = u\\,\\Delta x/\\kappa \\approx 20$。\n*   **线性系统:** $A x = b$。\n*   **矩阵性质:** $A$ 是非对称且强非正规的。\n*   **求解器:** 重启 GMRES($m$) (重启步长为 $m$ 的广义最小残差方法)。\n*   **算法细节:** 使用标准 Gram–Schmidt 正交化。\n*   **数值精度:** 双精度。\n*   **停止准则:** 当相对更新量范数很小时，迭代终止：$\\frac{\\lVert x_{k+1} - x_k\\rVert}{\\lVert x_{k+1}\\rVert} \\le 10^{-8}$。\n*   **观察到的行为:** 该准则被满足，但显式重计算的真实残差 $r_k^{\\mathrm{true}} = b - A x_k$ 范数很大，$\\lVert r_k^{\\mathrm{true}}\\rVert \\approx 10^{-2}$。\n*   **物理释义:** 解表现出显著的能量不平衡，表明数值解不满足离散化的守恒律，且求解器已过早停滞。\n*   **定义:** $r_k = b - A x_k$ (残差)，$e_k = x_\\star - x_k$ (误差)，$s_k = x_{k+1} - x_k$ (更新量)。\n\n### 步骤2：使用提取的已知条件进行验证\n\n1.  **科学上成立:** 该问题牢固植根于计算热工和数值线性代数。对流-扩散方程是一个经典模型。对流主导问题的迎风离散化是一种标准技术，并且众所周知这会导致非对称矩阵。对于大的佩克莱数，这些矩阵通常是强非正规的。GMRES 是解决此类系统的标准首选求解器。所观察到的现象——当真实残差仍然很大时，基于更新量的准则却宣告过早收敛——是数值分析中一个有详细记载的病态现象，尤其对于非正规问题。使用标准 Gram-Schmidt，已知其数值稳定性不如修正 Gram-Schmidt，为所描述的行为提供了合理的机制。整个设置在科学上和数学上都是合理的。\n\n2.  **良构的:** 问题是良构的。它不是要求解偏微分方程，而是对一种数值方法的失效模式进行批判性分析。问题是精确的：找出解释失败原因的正确陈述，并基于基本定义提出补救措施。可以进行唯一且有意义的分析。\n\n3.  **客观的:** 语言技术性强、精确，且没有主观性或偏见。\n\n### 步骤3：结论和行动\n\n问题陈述是**有效的**。它描述了科学计算中一个现实且重要的场景。我现在将继续推导和分析这些选项。\n\n## 推导和选项分析\n\n问题在于解释为什么在给定情境下，一个小的更新量范数 $\\lVert s_k \\rVert = \\lVert x_{k+1} - x_k \\rVert$ 不保证一个小的真实残差范数 $\\lVert r_k \\rVert = \\lVert b - A x_k \\rVert$。\n\n我们从残差和更新量之间的基本关系开始。\n第 k+1 次迭代的残差是\n$$r_{k+1} = b - A x_{k+1}$$\n代入 $x_{k+1} = x_k + s_k$:\n$$r_{k+1} = b - A(x_k + s_k) = (b - A x_k) - A s_k$$\n这就得到了残差更新公式：\n$$r_{k+1} = r_k - A s_k$$\n根据三角不等式，残差范数的变化是有界的：\n$$\\lVert r_k - r_{k+1} \\rVert = \\lVert A s_k \\rVert \\le \\lVert A \\rVert \\lVert s_k \\rVert$$\n这个不等式是分析的核心。\n\n### 逐项分析选项\n\n**A. 对于一个非正规矩阵 $A$，较小的 $\\lVert s_k\\rVert$ 并不意味着较小的 $\\lVert r_k\\rVert$，因为 $r_{k+1} = r_k - A s_k$，所以残差的变化量受限于 $\\lVert A\\rVert\\,\\lVert s_k\\rVert$，即使 $\\lVert r_k\\rVert$ 本身仍然很大，这个变化量也可能很小；此外，非正规性可能使 $s_k$ 与那些不能有效减小 $\\lVert r_k\\rVert$ 的方向对齐。**\n\n该陈述正确地指出了核心问题。不等式 $\\lVert r_k - r_{k+1} \\rVert \\le \\lVert A \\rVert \\lVert s_k \\rVert$ 表明一个小的更新量 $\\lVert s_k \\rVert$ 仅意味着残差向量从一步到下一步的变化量很小。它没有说明残差向量 $\\lVert r_k \\rVert$ 本身的大小。如果迭代已经达到了一个无法再有效减小残差的点（停滞状态），更新量 $s_k$ 将变得非常小，从而满足基于更新量的停止准则，即使残差 $\\lVert r_k \\rVert$ 仍然很大。这种停滞行为是 GMRES 应用于强非正规矩阵时的一个众所周知的特征。关于非正规性使 $s_k$ 与无效方向对齐的说法，是一个定性但准确的描述，解释了为什么 GMRES 可能难以减小残差范数，从而导致这种停滞。\n\n**结论：正确。**\n\n**B. 在通过递推式 $r_{k+1} = r_k - A s_k$ 更新 $r_k$ 的 Krylov 子空间方法中，浮点舍入误差和正交性的丧失可能导致存储的（递推更新的）残差偏离真实残差 $r_k^{\\mathrm{true}} = b - A x_k$，尤其对于非正规矩阵 $A$。因此，依赖 $\\lVert s_k\\rVert$ 会掩盖残差的停滞；一个纠正方法是周期性地重新计算 $r_k^{\\mathrm{true}}$ 并将递推重置为该值。**\n\n这个陈述描述了问题的关键数值方面，而非纯粹的数学方面。GMRES 使用正交化过程为 Krylov 子空间构建一个标准正交基。问题指定了*标准 Gram–Schmidt*，已知其数值上不稳定；在浮点运算下，计算出的基向量会迅速失去其相互正交性。对于病态或强非正规矩阵，这种正交性的丧失尤为严重。GMRES 算法依赖于这种正交性来高效地计算残差范数，而无需在每个子步骤中显式地构造解迭代 $x_k$。当正交性丧失时，算法对残差范数的内部计算（以及因此其对更新量的选择）会变得不准确，并可能与真实残差范数 $\\lVert b - A x_k \\rVert$ 产生显著偏离。这可能导致算法认为它已经最小化了残差，从而产生一个非常小的更新量 $s_k$ 并停滞。这满足了基于更新量的停止准则，而真实残差仍然很大。所提出的补救措施——周期性地重新计算真实残差 $r_k^{\\mathrm{true}} = b - A x_k$ 并用此值重启过程——是抵消这种漂移的标准有效技术。\n\n**结论：正确。**\n\n**C. 如果 $A$ 的谱半径小于1，那么 $\\lVert x_{k+1} - x_k\\rVert$ 和 $\\lVert r_k\\rVert$ 保证是等价范数，因此无论非正规性如何，基于更新量的停止准则都是安全的。**\n\n这个陈述是错误的，原因有几个。首先，条件 $\\rho(A)  1$ 是诸如 $x_{k+1} = (I-A)x_k + b$ 的定常迭代法收敛的条件，而不是用 GMRES 求解问题 $Ax=b$ 的条件。对于一个由偏微分方程离散化得到的矩阵 $A$，其特征值通常与网格间距相关（例如，与 $1/(\\Delta x)^2$ 成正比），因此 $\\rho(A)$ 通常会远大于1。这个前提在物理上和数学上都与上下文无关。其次，即使假设 $\\rho(A)  1$，对于非正规矩阵，谱半径是衡量矩阵行为的一个很差的指标。矩阵幂的范数 $\\lVert A^k \\rVert$ 在最终衰减前可能表现出显著的瞬时增长。停滞现象并不会因为 $\\rho(A)  1$ 而被排除。最后，“保证等价”从而使停止准则“安全”的说法是错误的。虽然有限维空间上的所有范数都是等价的，但等价常数可能非常大，并依赖于 $A$ 的性质（如其条件数），对于非正规矩阵，这个常数可能很大。条件 $\\rho(A)  1$ 并不能消除停滞的可能性，即 $\\lVert s_k \\rVert$ 很小但 $\\lVert r_k \\rVert$ 很大。\n\n**结论：不正确。**\n\n**D. 一个稳健的修复方法是简单地收紧更新量的容差（例如，将 $10^{-8}$ 替换为 $10^{-12}$）；这保证了非正规性和舍入误差不会导致假收敛。**\n\n这个提议的修复方法是幼稚且不正确的。问题在于停止准则衡量的是错误的量——迭代的停滞，而不是其与真实解的接近程度。求解器已经报告了一个非常小的更新量范数（$\\le 10^{-8}$），而真实残差很大（$\\approx 10^{-2}$）。将容差收紧到 $10^{-12}$ 只会迫使求解器继续迭代，直到更新量变得更小。由于过程已经停滞，这不一定会导致真实残差的有意义的减小。求解器可能会花费大量精力来实现更小的更新量，或者可能会达到最大迭代次数限制，但这并没有解决停止准则与实际误差度量之间的根本不匹配问题。它没有提供任何“保证”，也未能解决 A 和 B 中描述的根本问题。\n\n**结论：不正确。**\n\n**E. 一个稳健的替代停止准则是一个基于重计算残差的范数形式的后向误差准则，\n$$\\eta_k \\equiv \\frac{\\lVert r_k^{\\mathrm{true}}\\rVert}{\\lVert A\\rVert\\,\\lVert x_k\\rVert + \\lVert b\\rVert},$$\n并在 $\\eta_k \\le \\text{tol}$ 时终止；周期性地重计算 $r_k^{\\mathrm{true}}$ 可以防止由舍入误差引起的漂移，并减轻非正规放大效应对停止决策的影响。**\n\n这个陈述提出了一个先进的解决方案。量 $\\eta_k$ 是范数形式后向误差的一种度量。一个小的后向误差 $\\eta_k \\le \\text{tol}$ 意味着计算出的解 $x_k$ 是一个轻微扰动问题 $(A+\\Delta A)x_k = b + \\Delta b$ 的精确解，其中扰动的相对大小在 $\\text{tol}$ 的量级上。这是一个对“好”解的稳健且有意义的定义。关键是，这个准则基于真实残差 $r_k^{\\mathrm{true}} = b - A x_k$。直接使用真实残差可以衡量解在多大程度上满足控制方程，从而绕过了迭代停滞的问题（A 中的问题）。此外，通过明确指出必须重计算 $r_k^{\\mathrm{true}}$，它包含了对由舍入误差引起的数值漂移的必要修复（B 中的问题）。这个准则不会被停滞或舍入误差误导，并为困难的非正规问题提供了一个可靠的停止测试。\n\n**结论：正确。**",
            "answer": "$$\\boxed{ABE}$$"
        },
        {
            "introduction": "我们如何知道一个迭代解何时“足够好”？承接前述讨论的陷阱，本练习  引入了一个严谨而现代的答案：后向误差的概念。这一强大的思想重塑了收敛问题，它不再仅仅是检查迭代是否停止变化，而是探究我们计算出的近似解是否是原始问题某个微小扰动版本的精确解。本练习将使您掌握一个量化评估解质量的工具，并实现真正可靠的停止准则。",
            "id": "3965801",
            "problem": "一个在有界域 $\\Omega \\subset \\mathbb{R}^3$ 上的非均质稳态热传导问题，其热导率为 $k(\\mathbf{x})$，体热源为 $q(\\mathbf{x})$，由能量守恒和傅里叶定律控制，共同得出平衡方程 $-\\nabla \\cdot (k(\\mathbf{x}) \\nabla T(\\mathbf{x})) = q(\\mathbf{x})$，并满足适当的边界条件。使用有限体积法 (FVM) 对该模型进行离散化，并施加狄利克雷边界条件，会产生一个稀疏线性系统 $A x = b$，其中 $A$ 编码了扩散通量平衡，$x$ 汇集了节点温度。使用共轭梯度法 (CG) 等迭代求解器来近似求解，经过 $k$ 次迭代后，我们得到一个近似解 $x_k$，其残差为 $r = b - A x_k$。\n\n在实践中，迭代求解器的停止准则通常用后向误差来表示：其思想是，计算出的 $x_k$ 应该是某个微扰动模型 $(A + \\Delta A) x_k = b + \\Delta b$ 的精确解，其中扰动 $\\Delta A$ 和 $\\Delta b$ 相对于 $A$ 和 $b$ 而言很小。范数后向误差量化了使 $x_k$ 成为这样一个扰动系统的精确解所必需的最小相对扰动。\n\n假设该传导问题的某个特定 FVM 离散化产生了以下数据，其范数为诱导的矩阵和向量 2-范数：$\\|A\\|_2 = 1.3 \\times 10^{3}$，$\\|x_k\\|_2 = 2.8 \\times 10^{2}$，$\\|b\\|_2 = 1.1 \\times 10^{5}$，以及残差范数 $\\|r\\|_2 = 3.0 \\times 10^{-1}$。建议的停止容差为 $\\tau = 1.0 \\times 10^{-6}$。\n\n哪个选项正确地指明了与线性系统 $A x = b$ 的 $x_k$ 相关的范数后向误差，并正确地将在诱导 2-范数的意义上，将容差 $\\tau$ 解释为对 $A$ 和 $b$ 扰动大小的一个界？\n\n- A. 范数后向误差为 $\\|r\\|_2 / (\\|A\\|_2 \\|x_k\\|_2 + \\|b\\|_2) \\approx 6.33 \\times 10^{-7}$。解释容差 $\\tau$ 意味着：如果 $\\|r\\|_2 / (\\|A\\|_2 \\|x_k\\|_2 + \\|b\\|_2) \\le \\tau$，则存在扰动 $\\Delta A$ 和 $\\Delta b$ 使得 $(A + \\Delta A) x_k = b + \\Delta b$，并且满足 $\\|\\Delta A\\|_2 \\le \\tau \\|A\\|_2$ 和 $\\|\\Delta b\\|_2 \\le \\tau \\|b\\|_2$。\n- B. 后向误差是相对残差 $\\|r\\|_2 / \\|b\\|_2 \\approx 2.73 \\times 10^{-6}$。解释 $\\tau$ 意味着：如果 $\\|r\\|_2 / \\|b\\|_2 \\le \\tau$，则存在一个扰动 $\\Delta b$ 满足 $\\|\\Delta b\\|_2 \\le \\tau \\|b\\|_2$，使得 $A x_k = b + \\Delta b$，且 $\\Delta A = 0$。\n- C. 后向误差为 $\\|r\\|_2 / (\\|A\\|_2 \\|x_k\\|_2) \\approx 8.24 \\times 10^{-7}$。解释 $\\tau$ 意味着：如果这个量 $\\le \\tau$，则存在一个扰动 $\\Delta A$ 满足 $\\|\\Delta A\\|_2 \\le \\tau \\|A\\|_2$，使得 $(A + \\Delta A) x_k = b$，且 $\\Delta b = 0$。\n- D. 后向误差是使用预处理器 $M$ 定义的，即 $\\|M^{-1} r\\|_2 / \\left(\\|M^{-1} A\\|_2 \\|x_k\\|_2 + \\|M^{-1} b\\|_2\\right)$，并且解释 $\\tau$ 仅对预处理系统的扰动进行界定；因此，除非 $M$ 是单位矩阵，否则它不保证对原始系统的 $\\Delta A$ 和 $\\Delta b$ 有界。\n- E. 后向误差是分量形式的量 $\\max_i \\left( |r_i| / \\left( (|A| |x_k|)_i + |b_i| \\right) \\right)$，并且解释 $\\tau$ 分别对 $\\Delta A$ 和 $\\Delta b$ 的每个分量进行界定；这对于诱导 2-范数情况是正确的范数表述。",
            "solution": "问题要求我们确定线性系统 $A x = b$ 的近似解 $x_k$ 的范数后向误差的正确表达式。后向误差分析旨在寻找最小的扰动 $\\Delta A$ 和 $\\Delta b$，使得 $x_k$ 是扰动系统的一个精确解：\n$$ (A + \\Delta A) x_k = b + \\Delta b $$\n重新整理这个方程，我们得到：\n$$ A x_k + (\\Delta A) x_k = b + \\Delta b $$\n$$ (\\Delta A) x_k - \\Delta b = b - A x_k $$\n右边是残差，$r = b - A x_k$。所以我们有：\n$$ (\\Delta A) x_k - \\Delta b = r $$\n范数后向误差，记为 $\\eta(x_k)$，定义为满足上述方程的最小非负数 $\\epsilon$，其中扰动 $\\Delta A$ 和 $\\Delta b$ 满足 $\\|\\Delta A\\| \\le \\epsilon \\|A\\|$ 和 $\\|\\Delta b\\| \\le \\epsilon \\|b\\|$，对于给定的相容的矩阵和向量范数。\n\n数值线性代数中的一个基本结果（由 Rigal 和 Gaches 提出）指出，对于任何次乘法矩阵范数及其从属向量范数，范数后向误差由以下表达式给出：\n$$ \\eta(x_k) = \\frac{\\|b - A x_k\\|}{\\|A\\| \\|x_k\\| + \\|b\\|} = \\frac{\\|r\\|}{\\|A\\| \\|x_k\\| + \\|b\\|} $$\n问题指定所有范数都使用诱导 2-范数。因此，在这种情况下，范数后向误差的具体公式是：\n$$ \\eta(x_k) = \\frac{\\|r\\|_2}{\\|A\\|_2 \\|x_k\\|_2 + \\|b\\|_2} $$\n让我们用给定的数据计算这个值：\n- $\\|A\\|_2 = 1.3 \\times 10^{3}$\n- $\\|x_k\\|_2 = 2.8 \\times 10^{2}$\n- $\\|b\\|_2 = 1.1 \\times 10^{5}$\n- $\\|r\\|_2 = 3.0 \\times 10^{-1}$\n\n首先，我们计算分母：\n$$ \\|A\\|_2 \\|x_k\\|_2 + \\|b\\|_2 = (1.3 \\times 10^{3}) \\times (2.8 \\times 10^{2}) + (1.1 \\times 10^{5}) $$\n$$ = (3.64 \\times 10^{5}) + (1.1 \\times 10^{5}) = 4.74 \\times 10^{5} $$\n现在，我们可以计算后向误差：\n$$ \\eta(x_k) = \\frac{3.0 \\times 10^{-1}}{4.74 \\times 10^{5}} = \\frac{3.0}{4.74} \\times 10^{-1-5} \\approx 0.63291 \\times 10^{-6} \\approx 6.33 \\times 10^{-7} $$\n对容差 $\\tau$ 的解释是，当近似解 $x_k$ 是一个邻近系统的精确解，且该系统的数据扰动相对量不超过 $\\tau$ 时，迭代过程被认为已经收敛。也就是说，当 $\\eta(x_k) \\le \\tau$ 时，我们停止迭代。根据 $\\eta(x_k)$ 的定义，这意味着存在扰动 $\\Delta A$ 和 $\\Delta b$ 使得 $(A + \\Delta A) x_k = b + \\Delta b$，其中 $\\|\\Delta A\\|_2 \\le \\tau \\|A\\|_2$ 且 $\\|\\Delta b\\|_2 \\le \\tau \\|b\\|_2$。\n\n**逐项分析**\n\n- **A.** 该选项指出范数后向误差为 $\\|r\\|_2 / (\\|A\\|_2 \\|x_k\\|_2 + \\|b\\|_2) \\approx 6.33 \\times 10^{-7}$。这与我们推导的公式和计算完全匹配。它也正确地解释了容差 $\\tau$：条件 $\\eta(x_k) \\le \\tau$ 意味着存在扰动 $\\Delta A$ 和 $\\Delta b$，满足 $\\|\\Delta A\\|_2 \\le \\tau \\|A\\|_2$ 和 $\\|\\Delta b\\|_2 \\le \\tau \\|b\\|_2$，使得 $x_k$ 成为扰动系统的精确解。\n  **结论：正确。**\n\n- **B.** 该选项将后向误差定义为相对残差 $\\|r\\|_2 / \\|b\\|_2$。我们计算一下：$(3.0 \\times 10^{-1}) / (1.1 \\times 10^{5}) \\approx 2.73 \\times 10^{-6}$。对于给定的公式，计算是正确的。然而，这个公式对应于一个后向误差模型，其中只有右侧向量 $b$ 受到扰动（即 $\\Delta A = 0$）。问题的前言描述了一个更一般的情况，即 $A$ 和 $b$ 都受到扰动。因此，该选项不代表所要求的一般“范数后向误差”。\n  **结论：不正确。**\n\n- **C.** 该选项将后向误差定义为 $\\|r\\|_2 / (\\|A\\|_2 \\|x_k\\|_2)$。我们计算一下：$(3.0 \\times 10^{-1}) / ((1.3 \\times 10^{3}) \\times (2.8 \\times 10^{2})) = (3.0 \\times 10^{-1}) / (3.64 \\times 10^{5}) \\approx 8.24 \\times 10^{-7}$。对于给定的公式，计算是正确的。这个公式对应于一个后向误差模型，其中只有矩阵 $A$ 受到扰动（即 $\\Delta b = 0$）。与选项 B 一样，这是一个特例，并不代表对 $A$ 和 $b$ 同时扰动的一般范数后向误差。\n  **结论：不正确。**\n\n- **D.** 该选项引入了一个预处理器 $M$。问题陈述在 $Ax=b$ 的表述或给定的数据中并未包含预处理器。虽然预处理是像 CG 这样的求解器常用的技术，但问题是具体关于系统 $A x = b$ 的后向误差。引入预处理器不必要地使问题复杂化，并解决了另一个问题（预处理系统的后向误差），这并非所问。\n  **结论：不正确。**\n\n- **E.** 该选项描述了*分量*后向误差，由公式 $\\max_i \\left( |r_i| / \\left( (|A| |x_k|)_i + |b_i| \\right) \\right)$ 给出。这是一个不同且有效的概念，但它不是明确要求的*范数*后向误差，问题为此提供了基于范数的数据（2-范数）。声称这个分量定义“对于诱导 2-范数情况是正确的范数表述”是错误的。\n  **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}