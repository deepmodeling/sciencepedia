{
    "hands_on_practices": [
        {
            "introduction": "在计算热工学中，我们面临的许多挑战始于将连续的物理定律（如热传导方程）转化为离散的代数方程组。本练习将指导您完成这一基本过程，从物理守恒定律出发，推导出一个具有空间可变热导率的二维稳态热传导问题的有限差分矩阵。通过分析一个简单的预条件理查森迭代，您将亲身体会到离散化如何形成线性系统的结构，以及最基础的预条件技术如何影响其收敛性。",
            "id": "3979820",
            "problem": "考虑具有空间变化热导率的二维稳态热传导方程，\n$$\n-\\nabla \\cdot \\big(k(x,y)\\,\\nabla T(x,y)\\big) \\;=\\; f(x,y)\n$$\n该方程定义在单位正方形域 $\\Omega=(0,1)\\times(0,1)$ 上，边界 $\\partial\\Omega$ 上具有齐次狄利克雷边界条件 $T=0$。设该域由均匀笛卡尔网格划分，每个坐标方向有 $n$ 个内部点，间距为 $h=1/(n+1)$。采用同位网格布置，其中未知数 $T_{i,j}\\approx T(x_i,y_j)$ 定义在网格点 $(x_i,y_j)=(i\\,h,j\\,h)$ 上，其中 $i,j=1,\\dots,n$。\n\n任务：\n1. 从能量守恒和傅里叶定律出发，推导在每个内部控制体上对 $-\\nabla\\cdot(k\\nabla T)=f$ 进行控制体（等效于有限体积）离散化所得到的五点离散算子。您的推导必须在围绕 $(x_i,y_j)$ 的矩形控制体上使用散度定理，并对界面上的法向温度梯度使用中心二阶差分。为确保物理一致性（热通量连续性）和所得线性系统的对称性，请使用跨越单元格界面的节点热导率的调和平均值来计算界面上的热导率。明确写出内部节点 $(i,j)$ 处的 5 点格式系数，用分别位于控制体东、西、北、南界面上的界面热导率 $k_{e}$、$k_{w}$、$k_{n}$ 和 $k_{s}$ 表示，并说明 $k$ 是如何进入这些系数的。\n\n2. 用 $A\\in\\mathbb{R}^{n^2\\times n^2}$ 表示由您的格式生成、按字典序排列的组装系统 $A\\,\\mathbf{T}=\\mathbf{f}$ 的稀疏矩阵。现在考虑热导率恒定 $k(x,y)\\equiv k_{0}>0$ 的特殊情况。令 $M=\\mathrm{diag}(A)$ 为对角（雅可比）预条件子。分析带有松弛参数 $\\omega>0$ 的稳态预处理理查森迭代\n$$\n\\mathbf{T}^{(m+1)} \\;=\\; \\mathbf{T}^{(m)} \\;+\\; \\omega\\,M^{-1}\\big(\\mathbf{f}-A\\,\\mathbf{T}^{(m)}\\big),\n$$\n该迭代可用作平滑器或简单的预处理定点迭代。通过利用常系数情况下 $A$ 的结构，确定在所有 $\\omega>0$ 的范围内迭代矩阵可达到的最小谱半径值，并将其表示为仅关于 $n$ 的闭式表达式。\n\n请以仅关于 $n$ 的单个闭式表达式的形式给出最终答案。无需进行数值计算。",
            "solution": "所述问题具有科学依据，提法恰当且客观。已提供获得唯一解所需的所有信息。该问题是偏微分方程数值方法中的一个标准练习题，是有效的。我们开始求解。\n\n### 第 1 部分：五点离散算子的推导\n\n控制偏微分方程是带有源项 $f(x,y)$ 和空间变化热导率 $k(x,y)$ 的稳态热传导方程：\n$$-\\nabla \\cdot \\big(k(x,y)\\,\\nabla T(x,y)\\big) \\;=\\; f(x,y)$$\n为了使用有限体积法离散此方程，我们在围绕网格节点 $(x_i, y_j)$ 的控制体 $V_{i,j}$ 上对其进行积分。该控制体是一个边长为 $h$ 的正方形，中心位于 $(x_i, y_j)$，其界面位于 $x = x_i \\pm h/2$ 和 $y = y_j \\pm h/2$。该方程的积分形式为：\n$$-\\int_{V_{i,j}} \\nabla \\cdot (k \\nabla T) \\,dV \\;=\\; \\int_{V_{i,j}} f \\,dV$$\n对左侧应用散度定理，可将体积分转换为对控制体边界 $\\partial V_{i,j}$ 的面积分。根据傅里叶定律，热通量矢量定义为 $\\mathbf{q} = -k\\nabla T$。\n$$-\\int_{\\partial V_{i,j}} (k \\nabla T) \\cdot \\mathbf{n} \\,dS \\;=\\; \\int_{V_{i,j}} f \\,dV \\quad\\implies\\quad \\int_{\\partial V_{i,j}} \\mathbf{q} \\cdot \\mathbf{n} \\,dS \\;=\\; \\int_{V_{i,j}} f \\,dV$$\n左侧的积分表示流出控制体的净热流。在二维中，控制体的面积为 $h^2$，其边界由四个面（东、西、北、南）组成，每个面的长度为 $h$。我们可以将积分方程近似为：\n$$Q_e + Q_w + Q_n + Q_s \\; \\approx \\; \\overline{f}_{i,j} h^2$$\n其中 $Q_e, Q_w, Q_n, Q_s$ 分别是流出东、西、北、南四个面的总热流，$\\overline{f}_{i,j}$ 是 $f$ 在控制体上的平均值，我们将其近似为 $f_{i,j} = f(x_i, y_j)$。通过一个面的总热流是垂直于该面的平均通量与该面面积（在二维中为长度）的乘积。\n$$Q_e = (q_x)_e h, \\quad Q_w = -(q_x)_w h, \\quad Q_n = (q_y)_n h, \\quad Q_s = -(q_y)_s h$$\n其中 $(q_x)_e$ 是东面的 x 方向通量，以此类推。注意西面和南面的符号，因为外法线向量指向坐标负方向。能量平衡方程变为：\n$$(q_x)_e h - (q_x)_w h + (q_y)_n h - (q_y)_s h \\; = \\; f_{i,j} h^2$$\n接下来，我们使用中心二阶有限差分来近似单元格界面处的通量以计算温度梯度：\n\\begin{align*}\n(q_x)_e = \\left(-k \\frac{\\partial T}{\\partial x}\\right)_{e} \\approx -k_e \\frac{T_{i+1,j} - T_{i,j}}{h} \\\\\n(q_x)_w = \\left(-k \\frac{\\partial T}{\\partial x}\\right)_{w} \\approx -k_w \\frac{T_{i,j} - T_{i-1,j}}{h} \\\\\n(q_y)_n = \\left(-k \\frac{\\partial T}{\\partial y}\\right)_{n} \\approx -k_n \\frac{T_{i,j+1} - T_{i,j}}{h} \\\\\n(q_y)_s = \\left(-k \\frac{\\partial T}{\\partial y}\\right)_{s} \\approx -k_s \\frac{T_{i,j} - T_{i,j-1}}{h}\n\\end{align*}\n这里，$k_e, k_w, k_n, k_s$ 分别是控制体东、西、北、南四个界面上的热导率。将这些表达式代入能量平衡方程：\n$$ -k_e \\frac{T_{i+1,j} - T_{i,j}}{h}h - \\left(-k_w \\frac{T_{i,j} - T_{i-1,j}}{h}\\right)h -k_n \\frac{T_{i,j+1} - T_{i,j}}{h}h - \\left(-k_s \\frac{T_{i,j} - T_{i,j-1}}{h}\\right)h \\; = \\; f_{i,j} h^2 $$\n简化并重新排列各项，按温度节点分组：\n$$ k_w(T_{i,j} - T_{i-1,j}) + k_e(T_{i,j} - T_{i+1,j}) + k_s(T_{i,j} - T_{i,j-1}) + k_n(T_{i,j} - T_{i,j+1}) \\; = \\; f_{i,j} h^2 $$\n$$ (k_e+k_w+k_n+k_s)T_{i,j} - k_w T_{i-1,j} - k_e T_{i+1,j} - k_s T_{i,j-1} - k_n T_{i,j+1} \\; = \\; f_{i,j} h^2 $$\n此方程定义了与内部节点 $(i,j)$ 对应的线性系统 $A\\mathbf{T}=\\mathbf{f}$ 的行。节点 $(i,j)$ 处算子的五点格式系数如下：\n\\begin{itemize}\n    \\item 中心 ($T_{i,j}$): $c_{C} = k_e+k_w+k_n+k_s$\n    \\item 西 ($T_{i-1,j}$): $c_{W} = -k_w$\n    \\item 东 ($T_{i+1,j}$): $c_{E} = -k_e$\n    \\item 南 ($T_{i,j-1}$): $c_{S} = -k_s$\n    \\item 北 ($T_{i,j+1}$): $c_{N} = -k_n$\n\\end{itemize}\n为确保热通量连续性和矩阵 $A$ 的对称性，界面热导率使用跨越该界面的节点热导率 $k_{i,j} = k(x_i, y_j)$ 的调和平均值计算：\n\\begin{align*}\nk_e = \\frac{2 k_{i,j} k_{i+1,j}}{k_{i,j} + k_{i+1,j}} \\\\\nk_w = \\frac{2 k_{i-1,j} k_{i,j}}{k_{i-1,j} + k_{i,j}} \\\\\nk_n = \\frac{2 k_{i,j} k_{i,j+1}}{k_{i,j} + k_{i,j+1}} \\\\\nk_s = \\frac{2 k_{i,j-1} k_{i,j}}{k_{i,j-1} + k_{i,j}}\n\\end{align*}\n至此完成了问题第一部分的推导。\n\n### 第 2 部分：预处理理查森迭代的分析\n\n稳态预处理理查森迭代由下式给出：\n$$\\mathbf{T}^{(m+1)} \\;=\\; \\mathbf{T}^{(m)} \\;+\\; \\omega\\,M^{-1}\\big(\\mathbf{f}-A\\,\\mathbf{T}^{(m)}\\big)$$\n迭代矩阵为 $G_\\omega = I - \\omega M^{-1} A$。我们的目标是求出 $\\min_{\\omega > 0} \\rho(G_\\omega)$，其中 $\\rho(\\cdot)$ 表示谱半径。\n\n对于热导率恒定的特殊情况 $k(x,y) = k_0 > 0$，所有节点热导率均为 $k_{i,j}=k_0$。界面热导率变为 $k_e = k_w = k_n = k_s = k_0$。第 1 部分的离散方程简化为：\n$$ (k_0+k_0+k_0+k_0)T_{i,j} - k_0 T_{i-1,j} - k_0 T_{i+1,j} - k_0 T_{i,j-1} - k_0 T_{i,j+1} \\; = \\; h^2 f_{i,j} $$\n$$ k_0(4T_{i,j} - T_{i-1,j} - T_{i+1,j} - T_{i,j-1} - T_{i,j+1}) \\; = \\; h^2 f_{i,j} $$\n在 $A\\mathbf{T}=\\mathbf{f}$（其中 $\\mathbf{f}$ 表示分量为 $h^2 f_{i,j}$ 的缩放源项向量）中的系统矩阵 $A$ 的对角线元素为 $4k_0$，每个邻居对应的非对角线元素为 $-k_0$。因此，$A = k_0 A_{Lap}$，其中 $A_{Lap}$ 是 $n \\times n$ 网格上负离散拉普拉斯算子的 5 点格式的标准矩阵表示，其对角线元素为 $4$，对应邻居的非对角线元素为 $-1$。\n\n预条件子是 $A$ 的对角部分，因此 $M = \\mathrm{diag}(A) = 4k_0 I$，其中 $I$ 是 $n^2 \\times n^2$ 的单位矩阵。\n矩阵 $M^{-1}A$ 为：\n$$ M^{-1}A = (4k_0 I)^{-1} (k_0 A_{Lap}) = \\frac{1}{4k_0} I k_0 A_{Lap} = \\frac{1}{4} A_{Lap} $$\n$A_{Lap}$ 在具有齐次狄利克雷边界条件的 $n \\times n$ 网格上的特征值是众所周知的：\n$$ \\lambda_{p,q}(A_{Lap}) = 4 - 2\\cos\\left(\\frac{p\\pi}{n+1}\\right) - 2\\cos\\left(\\frac{q\\pi}{n+1}\\right), \\quad \\text{for } p,q=1, \\dots, n. $$\n因此，矩阵 $M^{-1}A$ 的特征值，记为 $\\nu_{p,q}$，是：\n$$ \\nu_{p,q} = \\frac{1}{4}\\lambda_{p,q}(A_{Lap}) = 1 - \\frac{1}{2}\\cos\\left(\\frac{p\\pi}{n+1}\\right) - \\frac{1}{2}\\cos\\left(\\frac{q\\pi}{n+1}\\right). $$\n由于矩阵 $A$ 是对称正定的，其特征值 $\\nu_{p,q}$ 是实数且为正。迭代矩阵 $G_\\omega$ 的特征值是 $\\mu_{p,q}(\\omega) = 1 - \\omega \\nu_{p,q}$。谱半径为 $\\rho(G_\\omega) = \\max_{p,q} |1 - \\omega \\nu_{p,q}|$。\n为最小化此谱半径，我们需要 $M^{-1}A$ 的最小和最大特征值。\n当余弦项取最大值时（即 $p=1, q=1$），出现最小特征值 $\\nu_{\\min}$：\n$$ \\nu_{\\min} = 1 - \\frac{1}{2}\\cos\\left(\\frac{\\pi}{n+1}\\right) - \\frac{1}{2}\\cos\\left(\\frac{\\pi}{n+1}\\right) = 1 - \\cos\\left(\\frac{\\pi}{n+1}\\right). $$\n当余弦项取最小值时（即 $p=n, q=n$），出现最大特征值 $\\nu_{\\max}$。使用 $\\cos(\\frac{n\\pi}{n+1}) = \\cos(\\pi - \\frac{\\pi}{n+1}) = -\\cos(\\frac{\\pi}{n+1})$：\n$$ \\nu_{\\max} = 1 - \\frac{1}{2}\\cos\\left(\\frac{n\\pi}{n+1}\\right) - \\frac{1}{2}\\cos\\left(\\frac{n\\pi}{n+1}\\right) = 1 - \\cos\\left(\\frac{n\\pi}{n+1}\\right) = 1 + \\cos\\left(\\frac{\\pi}{n+1}\\right). $$\n对于理查森迭代，若矩阵的特征值 $\\nu$ 在 $[\\nu_{\\min}, \\nu_{\\max}]$ 内，使 $\\max_\\nu |1-\\omega\\nu|$ 最小化的最优松弛参数 $\\omega_{\\text{opt}}$ 为 $\\omega_{\\text{opt}} = \\frac{2}{\\nu_{\\min} + \\nu_{\\max}}$。最小谱半径由下式给出：\n$$ \\rho_{\\min} = \\frac{\\nu_{\\max} - \\nu_{\\min}}{\\nu_{\\max} + \\nu_{\\min}}. $$\n我们来计算这个值。极值特征值的和是：\n$$ \\nu_{\\min} + \\nu_{\\max} = \\left(1 - \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right) + \\left(1 + \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right) = 2. $$\n极值特征值的差是：\n$$ \\nu_{\\max} - \\nu_{\\min} = \\left(1 + \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right) - \\left(1 - \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right) = 2\\cos\\left(\\frac{\\pi}{n+1}\\right). $$\n将这些值代入最小谱半径的公式中：\n$$ \\rho_{\\min} = \\frac{2\\cos\\left(\\frac{\\pi}{n+1}\\right)}{2} = \\cos\\left(\\frac{\\pi}{n+1}\\right). $$\n这是迭代矩阵可达到的最小谱半径，表示为 $n$ 的闭式函数。",
            "answer": "$$\\boxed{\\cos\\left(\\frac{\\pi}{n+1}\\right)}$$"
        },
        {
            "introduction": "虽然简单的对角预条件子（如雅可比预条件）易于构造，但它们对于解决复杂的工程问题往往不够有效。不完全LU（ILU）分解是一种更强大的技术，它通过构造一个近似的矩阵分解来更好地逼近原始矩阵的逆。本练习将引导您为一个经典的二维扩散问题矩阵手动计算零填充不完全LU（ILU(0)）分解，并量化其近似误差。通过这个动手过程，您将揭开ILU预条件子的神秘面紗，并直观地理解其“不完全性”的来源及其对近似质量的影响。",
            "id": "3979814",
            "problem": "一块边长为 $L$、热导率为常数 $k$ 的方形板，其边界温度保持在给定值，因此内部温度场 $T(x,y)$ 满足无内部热源的稳态热传导，由守恒律 $-\\nabla \\cdot (k \\nabla T) = 0$ 控制。使用经典的五点有限差分格式，在间距为 $h$ 的均匀笛卡尔网格上对控制方程进行离散化，以获得关于未知离散内部温度 $\\mathbf{u}$ 的线性系统 $A \\mathbf{u} = \\mathbf{b}$。考虑一个最小的 $2 \\times 2$ 未知量内部区域（即4个内部节点），按 $x$ 再按 $y$ 的字典序进行排序，并假设均匀狄利克雷数据使得 $\\mathbf{b} = \\mathbf{0}$。在不考虑一个无关紧要的均匀缩放因子 $k/h^{2}$ 的情况下，系数矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$ 具有内部节点间的5点扩散格式连通性，其形式如下\n$$\nA \\;=\\; \\begin{pmatrix}\n4  -1  -1  0 \\\\\n-1  4  0  -1 \\\\\n-1  0  4  -1 \\\\\n0  -1  -1  4\n\\end{pmatrix}.\n$$\n构造零填充不完全LU分解（ILU$(0)$）预处理器 $M = L U$，其中 $L$ 是单位下三角矩阵， $U$ 是上三角矩阵，且满足约束条件：$L$ 和 $U$ 的稀疏模式分别与 $A$ 的严格下三角部分和上三角部分相匹配。然后，通过计算相对Frobenius分解误差来量化稀疏性约束对近似逆质量的降低程度\n$$\nr \\;=\\; \\frac{\\|A - L U\\|_{F}}{\\|A\\|_{F}}\\,.\n$$\n请用精确值表示最终答案，不要四舍五入。答案必须是一个无单位的单个实数。",
            "solution": "我们从热导率为常数的稳态能量守恒律 $-\\nabla \\cdot (k \\nabla T) = 0$ 开始。在间距为 $h$ 的均匀笛卡尔网格上，对内部节点 $(i,j)$ 进行标准的五点有限差分格式离散化，得到\n$$\n\\frac{k}{h^{2}}\\left(-T_{i-1,j} - T_{i+1,j} - T_{i,j-1} - T_{i,j+1} + 4 T_{i,j}\\right) \\;=\\; 0,\n$$\n这导出一个线性系统 $A \\mathbf{u} = \\mathbf{b}$，其中，将公因子 $k/h^{2}$ 吸收到 $A$ 和 $\\mathbf{b}$ 的均匀缩放中后，未知量之间的内部耦合由5点格式捕捉。对于一个 $2 \\times 2$ 的内部区域（即4个未知量），按 $x$ 再按 $y$ 的字典序排序，矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$ 为\n$$\nA \\;=\\; \\begin{pmatrix}\n4  -1  -1  0 \\\\\n-1  4  0  -1 \\\\\n-1  0  4  -1 \\\\\n0  -1  -1  4\n\\end{pmatrix}.\n$$\n我们构造零填充不完全LU分解（ILU$(0)$）预处理器 $M = L U$，并满足以下约束：\n- $L$ 是单位下三角矩阵，且其非零元仅存在于 $A$ 在严格对角线下有非零元的位置，即位置 $(2,1), (3,1), (4,2), (4,3)$。\n- $U$ 是上三角矩阵，且其非零元仅存在于 $A$ 在对角线或对角线之上有非零元的位置，即位置 $(1,1), (1,2), (1,3), (2,2), (2,4), (3,3), (3,4), (4,4)$。\n\n我们使用类似Doolittle的ILU$(0)$过程，该过程应用高斯消去法，但会丢弃所有在 $L$ 和 $U$ 的指定稀疏模式之外的填充元。\n\n参数化\n$$\nL \\;=\\; \\begin{pmatrix}\n1  0  0  0 \\\\\n\\ell_{21}  1  0  0 \\\\\n\\ell_{31}  0  1  0 \\\\\n0  \\ell_{42}  \\ell_{43}  1\n\\end{pmatrix}, \n\\quad\nU \\;=\\; \\begin{pmatrix}\nu_{11}  u_{12}  u_{13}  0 \\\\\n0  u_{22}  0  u_{24} \\\\\n0  0  u_{33}  u_{34} \\\\\n0  0  0  u_{44}\n\\end{pmatrix}.\n$$\n在步骤 $i = 1$ 时，上三角矩阵的第一行为\n$$\nu_{11} \\;=\\; A_{11} \\;=\\; 4,\\quad u_{12} \\;=\\; A_{12} \\;=\\; -1,\\quad u_{13} \\;=\\; A_{13} \\;=\\; -1.\n$$\n第1列中的乘子为\n$$\n\\ell_{21} \\;=\\; \\frac{A_{21}}{u_{11}} \\;=\\; \\frac{-1}{4} \\;=\\; -\\frac{1}{4}, \\qquad\n\\ell_{31} \\;=\\; \\frac{A_{31}}{u_{11}} \\;=\\; \\frac{-1}{4} \\;=\\; -\\frac{1}{4}.\n$$\n在步骤 $i = 2$ 时，对于稀疏模式中的上三角元素，我们计算\n$$\nu_{22} \\;=\\; A_{22} - \\ell_{21} u_{12} \\;=\\; 4 - \\left(-\\frac{1}{4}\\right)(-1) \\;=\\; 4 - \\frac{1}{4} \\;=\\; \\frac{15}{4},\n$$\n$$\nu_{24} \\;=\\; A_{24} - \\ell_{21} u_{14} \\;=\\; -1 - \\left(-\\frac{1}{4}\\right)\\cdot 0 \\;=\\; -1.\n$$\n第2列下方唯一允许的下三角元素是 $\\ell_{42}$，由下式给出\n$$\n\\ell_{42} \\;=\\; \\frac{A_{42} - \\ell_{41} u_{12}}{u_{22}} \\;=\\; \\frac{-1 - 0 \\cdot (-1)}{15/4} \\;=\\; -\\frac{4}{15},\n$$\n其中 $\\ell_{41} = 0$ 是由ILU$(0)$在位置 $(4,1)$ 的稀疏性约束所强制的。\n\n在步骤 $i = 3$ 时，对于允许的上三角元素，我们有\n$$\nu_{33} \\;=\\; A_{33} - \\left(\\ell_{31} u_{13} + \\ell_{32} u_{23}\\right) \\;=\\; 4 - \\left(\\left(-\\frac{1}{4}\\right)(-1) + 0 \\cdot 0\\right) \\;=\\; 4 - \\frac{1}{4} \\;=\\; \\frac{15}{4},\n$$\n$$\nu_{34} \\;=\\; A_{34} - \\left(\\ell_{31} u_{14} + \\ell_{32} u_{24}\\right) \\;=\\; -1 - \\left(\\left(-\\frac{1}{4}\\right)\\cdot 0 + 0 \\cdot (-1)\\right) \\;=\\; -1,\n$$\n其中 $\\ell_{32} = 0$ 和 $u_{23} = 0$ 是根据ILU$(0)$的稀疏性得出的。第3列下方唯一允许的下三角元素是\n$$\n\\ell_{43} \\;=\\; \\frac{A_{43} - \\left(\\ell_{41} u_{13} + \\ell_{42} u_{23}\\right)}{u_{33}} \\;=\\; \\frac{-1 - \\left(0 \\cdot (-1) + \\left(-\\frac{4}{15}\\right)\\cdot 0\\right)}{15/4} \\;=\\; -\\frac{4}{15}.\n$$\n在步骤 $i = 4$ 时，最后的对角线元素为\n$$\nu_{44} \\;=\\; A_{44} - \\left(\\ell_{41} u_{14} + \\ell_{42} u_{24} + \\ell_{43} u_{34}\\right) \\;=\\; 4 - \\left(0 \\cdot 0 + \\left(-\\frac{4}{15}\\right)(-1) + \\left(-\\frac{4}{15}\\right)(-1)\\right) \\;=\\; 4 - \\frac{8}{15} \\;=\\; \\frac{52}{15}.\n$$\n因此，ILU$(0)$ 分解的因子为\n$$\nL \\;=\\; \\begin{pmatrix}\n1  0  0  0 \\\\\n-\\tfrac{1}{4}  1  0  0 \\\\\n-\\tfrac{1}{4}  0  1  0 \\\\\n0  -\\tfrac{4}{15}  -\\tfrac{4}{15}  1\n\\end{pmatrix}, \n\\quad\nU \\;=\\; \\begin{pmatrix}\n4  -1  -1  0 \\\\\n0  \\tfrac{15}{4}  0  -1 \\\\\n0  0  \\tfrac{15}{4}  -1 \\\\\n0  0  0  \\tfrac{52}{15}\n\\end{pmatrix}.\n$$\n为了展示稀疏性约束如何影响近似质量，我们考察分解残差 $E = A - L U$。根据ILU$(0)$的构造，$L U$ 在 $A$ 的非零模式上与 $A$ 匹配，任何差异只能出现在那些在精确高斯消去法下会产生填充元但在此处被禁止的位置。唯一这样的位置是 $(2,3)$ 和 $(3,2)$。我们计算\n$$\n(LU)_{23} \\;=\\; L_{21} U_{13} + L_{22} U_{23} \\;=\\; \\left(-\\frac{1}{4}\\right)\\cdot (-1) + 1 \\cdot 0 \\;=\\; \\frac{1}{4},\n$$\n所以\n$$\nE_{23} \\;=\\; A_{23} - (LU)_{23} \\;=\\; 0 - \\frac{1}{4} \\;=\\; -\\frac{1}{4}.\n$$\n根据构造的对称性，\n$$\n(LU)_{32} \\;=\\; L_{31} U_{12} + L_{33} U_{32} \\;=\\; \\left(-\\frac{1}{4}\\right)\\cdot (-1) + 1 \\cdot 0 \\;=\\; \\frac{1}{4},\n$$\n所以\n$$\nE_{32} \\;=\\; A_{32} - (LU)_{32} \\;=\\; 0 - \\frac{1}{4} \\;=\\; -\\frac{1}{4}.\n$$\n$E$ 的所有其他元素均为零。因此，\n$$\n\\|E\\|_{F}^{2} \\;=\\; \\left(-\\frac{1}{4}\\right)^{2} + \\left(-\\frac{1}{4}\\right)^{2} \\;=\\; \\frac{1}{16} + \\frac{1}{16} \\;=\\; \\frac{1}{8},\n$$\n所以\n$$\n\\|E\\|_{F} \\;=\\; \\sqrt{\\frac{1}{8}} \\;=\\; \\frac{1}{2 \\sqrt{2}}.\n$$\n接下来，计算 $A$ 的Frobenius范数：\n$$\n\\|A\\|_{F}^{2} \\;=\\; 4 \\cdot 4^2 + 8 \\cdot (-1)^2 \\;=\\; 64 + 8 \\;=\\; 72,\n$$\n所以\n$$\n\\|A\\|_{F} \\;=\\; \\sqrt{72} \\;=\\; 6 \\sqrt{2}.\n$$\n因此，相对Frobenius分解误差为\n$$\nr \\;=\\; \\frac{\\|A - L U\\|_{F}}{\\|A\\|_{F}} \\;=\\; \\frac{1/(2 \\sqrt{2})}{6 \\sqrt{2}} \\;=\\; \\frac{1}{24}.\n$$\n这个精确值揭示了ILU$(0)$稀疏性约束的影响：全部误差都来自在该排序下与5点格式的自然填充模式相关的两个被丢弃的填充位置 $(2,3)$ 和 $(3,2)$。在克雷洛夫子空间方法（如广义最小残差(GMRES)方法）的背景下，较小的 $r$ 通常意味着预处理算子 $M^{-1} A$ 更接近单位矩阵，从而加速收敛；在此，$r = 1/24$ 量化了由于在两个耦合位置强制零填充而导致的质量下降。",
            "answer": "$$\\boxed{\\frac{1}{24}}$$"
        },
        {
            "introduction": "理论知识和手动计算最终需要在实际代码中融会贯通，以解决大规模的科学计算问题。本练习是一个综合性的编程实践，要求您实现预条件共轭梯度（PCG）算法——这是求解对称正定线性系统的核心克雷洛夫子空间方法。您将通过解决一个具有各向异性热导率的传热问题，测试不同预条件子（从无预条件到理想预条件）的效果，并将理论收敛边界与实际迭代次数进行比较。这项实践将理论与应用紧密结合，让您深刻理解预条件子如何通过改善谱特性来显著加速现代迭代求解器的收敛。",
            "id": "3979786",
            "problem": "考虑一个矩形域中的稳态热传导方程，其边界条件为均匀狄利克雷边界条件，热导率是常数但各向异性。控制偏微分方程为 $$-\\nabla \\cdot \\left( \\mathbf{K} \\nabla T \\right) = q,$$ 其中 $T$ 是温度，$\\mathbf{K} = \\operatorname{diag}(k_x,k_y)$ 且 $k_x>0$ 和 $k_y>0$，$q$ 是一个体热源。使用标准的中心有限差分格式在均匀笛卡尔网格上离散化该方程，得到一个线性系统 $$A x = b,$$ 其中 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 矩阵，$x \\in \\mathbb{R}^n$ 是节点温度向量，$b \\in \\mathbb{R}^n$ 是离散源项。离散算子 $A$ 是一个5点模板，其非对角权重与 $-k_x/h_x^2$ 和 $-k_y/h_y^2$ 成正比，对角权重与 $2(k_x/h_x^2 + k_y/h_y^2)$ 成正比，其中 $h_x$ 和 $h_y$ 是网格间距。\n\n你需要实现预条件共轭梯度 (PCG) 算法来求解该线性系统，使用一个通用的SPD预条件子 $M$。预处理将以SPD问题的标准方式应用，收敛性将使用残差的欧几里得范数来评估，即当满足以下条件时停止：$$\\frac{\\lVert r_k \\rVert_2}{\\lVert r_0 \\rVert_2} \\leq \\varepsilon,$$ 其中 $r_k = b - A x_k$，$\\varepsilon$ 是一个给定的容差。\n\n从第一性原理出发：\n- 推导SPD离散化如何从热方程中产生，以及为什么在常数 $k_x$ 和 $k_y$ 以及均匀狄利克雷边界条件下 $A$ 是SPD的。\n- 解释为什么对于SPD矩阵 $A$ ，PCG的收敛性取决于对称预处理算子 $$S = M^{-1/2} A M^{-1/2},$$ 的谱，该算子与 $M^{-1}A$ 具有相同的特征值，而不仅仅取决于 $A$ 本身的谱。\n- 通过使用 $M^{-1}$ 对向量的作用（即通过求解与 $M$ 相关的方程来应用预条件子），为通用的SPD $M$ 实现PCG算法。\n- 对于下面的每个测试用例，计算：\n  1. PCG达到容差 $\\varepsilon$ 所需的迭代次数 $k_{\\text{obs}}$（初始猜测为零向量）。\n  2. 谱条件数 $$\\kappa(M^{-1}A) = \\frac{\\lambda_{\\max}(S)}{\\lambda_{\\min}(S)},$$ 其中 $S = M^{-1/2} A M^{-1/2}$，$\\lambda_{\\max}$、$\\lambda_{\\min}$ 分别表示最大和最小特征值。\n  3. 达到容差 $\\varepsilon$ 所需迭代次数的最坏情况上界 $k_{\\text{bound}}$，由经典的共轭梯度估计给出，该估计用 $\\kappa(M^{-1}A)$ 表示，即选择满足 $$2 \\left( \\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1} \\right)^k \\leq \\varepsilon$$ 的最小整数 $k$。对于特殊情况 $\\kappa=1$（即完美预处理），设置 $k_{\\text{bound}} = 1$。\n\n使用以下测试套件，它探索了一个通用案例、一个带简单对角预条件子的各向异性案例，以及一个带精确预处理的极限案例：\n- 案例 $1$：$n_x = n_y = 16$, $k_x = 1$, $k_y = 1$, $M = I$ (单位预条件子), 容差 $\\varepsilon = 10^{-8}$，最大迭代次数 $n$（$A$ 的维度）。这是通用的“理想路径”案例。\n- 案例 $2$：$n_x = n_y = 16$, $k_x = 100$, $k_y = 1$, $M = \\operatorname{diag}(A)$ (雅可比预条件子), 容差 $\\varepsilon = 10^{-8}$，最大迭代次数 $n$。该案例测试各向异性和一个简单的SPD预条件子。\n- 案例 $3$：$n_x = n_y = 16$, $k_x = 100$, $k_y = 1$, $M = A$ (通过Cholesky分解求解实现的精确SPD预条件子), 容差 $\\varepsilon = 10^{-8}$，最大迭代次数 $n$。该案例是一个展示理想预处理的边界情况。\n\n在所有案例中，将 $b$ 设置为所有分量均为1的向量，初始猜测 $x_0$ 设置为零向量。网格间距应为 $h_x = h_y = 1/(n_x+1)$。\n\n你的程序应产生单行输出，其中包含用方括号括起来的逗号分隔的结果列表，条目按案例排序，且每个案例中依次列出 $k_{\\text{obs}}$、$\\kappa(M^{-1}A)$ 和 $k_{\\text{bound}}$。具体来说，输出格式必须是\n$$[k_{\\text{obs},1},\\kappa_1,k_{\\text{bound},1},k_{\\text{obs},2},\\kappa_2,k_{\\text{bound},2},k_{\\text{obs},3},\\kappa_3,k_{\\text{bound},3}],$$\n其中所有条目都是实数或整数，没有额外的输出文本。由于这些量是无量纲的迭代次数和谱条件数，因此不需要物理单位。",
            "solution": "所给问题是计算科学中一个明确定义的练习，要求将预条件共轭梯度 (PCG) 方法应用于离散化的偏微分方程。它具有科学依据，形式上规范，并且内部一致。我们将首先推导离散系统及其性质，解释PCG收敛的原理，然后继续进行指定测试用例的数值实现和求解。\n\n### 1. 离散化与系统矩阵的性质\n\n控制方程是带有各向异性热导率张量 $\\mathbf{K}$ 的稳态热传导方程：\n$$ -\\nabla \\cdot \\left( \\mathbf{K} \\nabla T \\right) = q $$\n给定 $\\mathbf{K} = \\operatorname{diag}(k_x, k_y)$，该方程展开为：\n$$ -\\frac{\\partial}{\\partial x}\\left(k_x \\frac{\\partial T}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(k_y \\frac{\\partial T}{\\partial y}\\right) = q $$\n我们在具有间距 $h_x$ 和 $h_y$ 的均匀笛卡尔网格上离散化该方程。设 $T_{i,j}$ 表示网格节点 $(x_i, y_j)$ 处的温度。我们使用中心有限差分格式来近似内部节点 $(i,j)$ 处的导数。\n\n外部导数 $\\frac{\\partial}{\\partial x}(\\cdot)$ 近似为：\n$$ \\left. \\frac{\\partial F}{\\partial x} \\right|_{i,j} \\approx \\frac{F_{i+1/2,j} - F_{i-1/2,j}}{h_x} $$\n其中 $F = k_x \\frac{\\partial T}{\\partial x}$。半网格点处的项则近似为：\n$$ F_{i+1/2,j} = \\left. k_x \\frac{\\partial T}{\\partial x} \\right|_{i+1/2,j} \\approx k_x \\frac{T_{i+1,j} - T_{i,j}}{h_x} $$\n$$ F_{i-1/2,j} = \\left. k_x \\frac{\\partial T}{\\partial x} \\right|_{i-1/2,j} \\approx k_x \\frac{T_{i,j} - T_{i-1,j}}{h_x} $$\n将这些代回，散度的 $x$ 分量为：\n$$ -\\frac{\\partial}{\\partial x}\\left(k_x \\frac{\\partial T}{\\partial x}\\right)_{i,j} \\approx -\\frac{k_x}{h_x^2} \\left( (T_{i+1,j} - T_{i,j}) - (T_{i,j} - T_{i-1,j}) \\right) = \\frac{k_x}{h_x^2} (-T_{i+1,j} + 2T_{i,j} - T_{i-1,j}) $$\n对 $y$ 分量进行类似的推导可得：\n$$ -\\frac{\\partial}{\\partial y}\\left(k_y \\frac{\\partial T}{\\partial y}\\right)_{i,j} \\approx \\frac{k_y}{h_y^2} (-T_{i,j+1} + 2T_{i,j} - T_{i,j-1}) $$\n将这些项组合起来，并使它们等于节点处的源项 $q_{i,j}$，得到离散方程：\n$$ \\frac{k_x}{h_x^2} (2T_{i,j} - T_{i+1,j} - T_{i-1,j}) + \\frac{k_y}{h_y^2} (2T_{i,j} - T_{i,j+1} - T_{i,j-1}) = q_{i,j} $$\n重新整理关于 $T_{i,j}$ 的项，得到5点模板形式：\n$$ \\left(\\frac{2k_x}{h_x^2} + \\frac{2k_y}{h_y^2}\\right)T_{i,j} - \\frac{k_x}{h_x^2}T_{i+1,j} - \\frac{k_x}{h_x^2}T_{i-1,j} - \\frac{k_y}{h_y^2}T_{i,j+1} - \\frac{k_y}{h_y^2}T_{i,j-1} = q_{i,j} $$\n均匀狄利克雷边界条件（边界上 $T=0$）意味着对于任何与边界相邻的节点 $(i,j)$，相应的邻居项（例如，如果节点在左边界上，则为 $T_{i-1,j}$）为零，因此从方程中省略。\n\n通过将 $n = n_x \\times n_y$ 个未知的内部温度排列成一个向量 $x$，这些方程构成一个线性系统 $Ax=b$。\n\n**$A$ 的对称性与正定性**：\n1.  **对称性**：矩阵 $A$ 是对称的。节点 $l$ 对节点 $k$ 方程的影响系数与节点 $k$ 对节点 $l$ 方程的影响系数相同。例如，对于相邻节点 $(i,j)$ 和 $(i+1,j)$，$(i,j)$ 所在行中对应于 $(i+1,j)$ 变量的元素是 $-k_x/h_x^2$。同样，$(i+1,j)$ 所在行中对应于 $(i,j)$ 变量的元素也是 $-k_x/h_x^2$。这对所有相邻对都成立，因此 $A=A^T$。\n\n2.  **正定性**：由于 $k_x > 0$ 且 $k_y > 0$，矩阵 $A$ 的对角元素 $A_{kk} = 2(k_x/h_x^2 + k_y/h_y^2)$ 是严格为正的。非对角元素都是非正的。任何行 $k$ 中非对角元素绝对值之和为 $\\sum_{j \\neq k} |A_{kj}|$。对于不与任何边界相邻的节点，该和等于对角元素 $A_{kk}$。对于与边界相邻的节点，一个或多个邻居项缺失，因此该和严格小于对角元素。因此，$A$ 是对角占优的。此外，该矩阵表示一个连通的节点图，这使其不可约。一个具有正对角元素的不可约对角占优对称矩阵，在至少一行上是严格对角占优的，并且已知是正定的。因此，$A$ 是对称正定 (SPD) 的。\n\n### 2. PCG收敛性与预处理的作用\n\n共轭梯度 (CG) 方法是一种用于求解SPD线性系统 $Ax=b$ 的迭代算法。其收敛速度由矩阵 $A$ 的谱条件数 $\\kappa(A) = \\lambda_{\\max}(A)/\\lambda_{\\min}(A)$ 决定。将误差减小一个因子 $\\varepsilon$ 所需的迭代次数 $k$ 大致与 $\\sqrt{\\kappa(A)}$ 成正比。\n\n预处理旨在通过将原始系统转换为一个具有更有利谱分布（即更小的条件数）的等价系统来提高收敛速度。对于一个SPD预条件子 $M$，我们可以定义其Cholesky分解 $M=LL^T$。系统 $Ax=b$ 可以重写为：\n$$ L^{-1} A x = L^{-1} b \\implies (L^{-1} A (L^T)^{-1}) (L^T x) = L^{-1} b $$\n令 $S = L^{-1} A (L^T)^{-1}$，$\\hat{x} = L^T x$，以及 $\\hat{b} = L^{-1}b$。我们现在使用标准CG方法求解变换后的系统 $S \\hat{x} = \\hat{b}$。矩阵 $S$ 是SPD的，因此CG方法适用。此过程的收敛性由 $\\kappa(S)$ 决定。\n\n$S$ 的特征值与矩阵 $M^{-1}A$ 的特征值相同。这可以通过相似变换看出：\n$$ S = L^{-1} A L^{-T} \\implies L^T S L^{-T} = L^T(L^{-1} A L^{-T})L^{-T} = A (L^T L)^{-1} = A M^{-1} $$\n由于 $AM^{-1}$ 与对称矩阵 $M^{1/2}(AM^{-1})M^{-1/2} = M^{-1/2}AM^{-1/2}=S$ 相似，其特征值是实数且为正。此外，$AM^{-1}$ 的特征值与 $M^{-1}A$ 的特征值相同。（对于任何可逆矩阵 $P$，$PXP^{-1}$ 与 $X$ 具有相同的特征值。令 $X=AM^{-1}$ 和 $P=M^{-1}$，则 $M^{-1}(AM^{-1})M = M^{-1}A$，但这更复杂）。一个更简单的论证是 $\\det(AB - \\lambda I) = \\det(A(B- \\lambda A^{-1})I) = \\det(A)\\det(B-\\lambda A^{-1})$ 和 $\\det(BA - \\lambda I) = \\det((B - \\lambda A^{-1})A) = \\det(B-\\lambda A^{-1})\\det(A)$，这表明 $AB$ 和 $BA$ 具有相同的特征多项式，因此具有相同的特征值。\n\n因此，PCG的收敛性取决于 $\\kappa(S) = \\kappa(M^{-1}A)$。一个有效的预条件子 $M$ 是一个能近似 $A$ 的矩阵，使得 $M^{-1}A$ 接近单位矩阵 $I$，从而使 $\\kappa(M^{-1}A) \\approx 1$。\n\nPCG算法的构造避免了显式构建 $L$、$L^{-1}$ 或 $S$。它在原始向量和矩阵上操作，但在每次迭代 $k$ 中包含一个用预条件子求解系统的步骤，$z_k = M^{-1}r_k$。\n\n### 3. 数值解与分析\n\n对于每个测试用例，实现将包括三个主要部分：\n1.  **组装**：构建矩阵 $A$ 和向量 $b$。\n2.  **PCG执行**：使用指定的预条件子 $M$ 运行PCG算法，以找到迭代次数 $k_{\\text{obs}}$。\n3.  **谱分析**：计算 $M^{-1}A$ 的特征值，以确定条件数 $\\kappa(M^{-1}A)$ 和理论迭代上界 $k_{\\text{bound}}$。\n\n预条件共轭梯度算法的流程如下（$x_0$ 是初始猜测）：\n$r_0 = b - Ax_0$\n$z_0 = M^{-1} r_0$\n$p_0 = z_0$\n对于 $k = 0, 1, 2, \\dots$\n$\\quad \\alpha_k = (r_k^T z_k) / (p_k^T A p_k)$\n$\\quad x_{k+1} = x_k + \\alpha_k p_k$\n$\\quad r_{k+1} = r_k - \\alpha_k A p_k$\n$\\quad$ 如果收敛：停止\n$\\quad z_{k+1} = M^{-1} r_{k+1}$\n$\\quad \\beta_k = (r_{k+1}^T z_{k+1}) / (r_k^T z_k)$\n$\\quad p_{k+1} = z_{k+1} + \\beta_k p_k$\n\n条件数 $\\kappa(M^{-1}A)$ 将通过求解广义特征值问题 $Av = \\lambda Mv$ 的特征值来计算，该问题可以使用 `scipy.linalg.eigh` 高效求解。理论上界 $k_{\\text{bound}}$ 是满足 $2 ((\\sqrt{\\kappa}-1)/(\\sqrt{\\kappa}+1))^k \\leq \\varepsilon$ 的最小整数 $k$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh, cholesky, solve_triangular\n\ndef solve():\n    \"\"\"\n    Main function to run test cases for the PCG algorithm on a discretized\n    heat equation problem.\n    \"\"\"\n\n    def build_A(nx, ny, kx, ky):\n        \"\"\"\n        Builds the sparse matrix A for the 2D heat equation using a 5-point\n        finite-difference stencil.\n        \"\"\"\n        n = nx * ny\n        hx = 1.0 / (nx + 1)\n        hy = 1.0 / (ny + 1)\n        A = np.zeros((n, n))\n\n        # Terms for the stencil\n        term_x = kx / (hx**2)\n        term_y = ky / (hy**2)\n        diag_val = 2.0 * (term_x + term_y)\n\n        for j in range(ny):\n            for i in range(nx):\n                k = j * nx + i  # Row-major mapping from 2D (i,j) to 1D k\n                \n                # Diagonal\n                A[k, k] = diag_val\n                \n                # Off-diagonals\n                # Left neighbor\n                if i > 0:\n                    k_left = j * nx + (i - 1)\n                    A[k, k_left] = -term_x\n                # Right neighbor\n                if i  nx - 1:\n                    k_right = j * nx + (i + 1)\n                    A[k, k_right] = -term_x\n                # Bottom neighbor\n                if j > 0:\n                    k_down = (j - 1) * nx + i\n                    A[k, k_down] = -term_y\n                # Top neighbor\n                if j  ny - 1:\n                    k_up = (j + 1) * nx + i\n                    A[k, k_up] = -term_y\n                    \n        return A\n\n    def pcg_solver(A, b, x0, M_inv, epsilon, max_iter):\n        \"\"\"\n        Implements the Preconditioned Conjugate Gradient (PCG) method.\n        M_inv is a function that computes z = M^{-1}r.\n        \"\"\"\n        x = x0.copy()\n        r = b - A @ x\n        norm_r0 = np.linalg.norm(r)\n\n        if norm_r0  1e-12: # If initial guess is the solution\n            return x, 0\n\n        z = M_inv(r)\n        p = z\n        rs_old = np.dot(r, z)\n\n        for k in range(max_iter):\n            Ap = A @ p\n            alpha = rs_old / np.dot(p, Ap)\n            \n            x = x + alpha * p\n            r = r - alpha * Ap\n\n            if np.linalg.norm(r) / norm_r0 = epsilon:\n                return x, k + 1\n\n            z = M_inv(r)\n            rs_new = np.dot(r, z)\n            beta = rs_new / rs_old\n            p = z + beta * p\n            rs_old = rs_new\n            \n        return x, max_iter\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (nx, ny, kx, ky, M_type, epsilon)\n        (16, 16, 1.0, 1.0, 'identity'),\n        (16, 16, 100.0, 1.0, 'jacobi'),\n        (16, 16, 100.0, 1.0, 'exact')\n    ]\n    \n    epsilon = 1e-8\n    results = []\n\n    for nx, ny, kx, ky, M_type in test_cases:\n        n = nx * ny\n        max_iter = n\n\n        # Assemble the matrix and vectors\n        A = build_A(nx, ny, kx, ky)\n        b = np.ones(n)\n        x0 = np.zeros(n)\n\n        # Define preconditioner M and its inverse action M_inv\n        if M_type == 'identity':\n            M = np.eye(n)\n            M_inv = lambda v: v\n        elif M_type == 'jacobi':\n            diag_A = np.diag(A)\n            M = np.diag(diag_A)\n            M_inv = lambda v: v / diag_A\n        elif M_type == 'exact':\n            M = A\n            # Pre-factor for efficient solves in PCG\n            L = cholesky(A, lower=True)\n            M_inv = lambda v:solve_triangular(L.T, solve_triangular(L, v, lower=True), lower=False)\n\n        # 1. Compute observed iterations k_obs\n        _, k_obs = pcg_solver(A, b, x0, M_inv, epsilon, max_iter)\n        \n        # 2. Compute spectral condition number kappa\n        # Use generalized eigenvalue solver for eigs of M^{-1}A\n        eigenvalues = eigh(A, M, eigvals_only=True)\n        lambda_min = np.min(eigenvalues)\n        lambda_max = np.max(eigenvalues)\n        \n        # Guard against division by zero and handle ideal case\n        if np.isclose(lambda_min, 0.0):\n            kappa = np.inf\n        elif np.isclose(lambda_min, lambda_max):\n            kappa = 1.0\n        else:\n            kappa = lambda_max / lambda_min\n\n        # 3. Compute worst-case iteration bound k_bound\n        if np.isclose(kappa, 1.0):\n            k_bound = 1\n        else:\n            # Formula: k >= log(eps/2) / log((sqrt(kappa)-1)/(sqrt(kappa)+1))\n            sqrt_kappa = np.sqrt(kappa)\n            term = (sqrt_kappa - 1) / (sqrt_kappa + 1)\n            k_bound = np.ceil(np.log(epsilon / 2.0) / np.log(term))\n\n        results.extend([k_obs, kappa, int(k_bound)])\n\n    # Format output according to problem specification\n    # k_obs and k_bound are integers, kappa is a float\n    output_str = ','.join(map(str, results))\n    print(f\"[{output_str}]\")\n\nsolve()\n```"
        }
    ]
}