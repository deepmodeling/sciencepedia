{
    "hands_on_practices": [
        {
            "introduction": "本练习是应用Brinkman模型的一个基础实践。通过求解多孔介质中的经典泊肃叶流动问题，我们可以深入理解粘性边界层（如无滑移壁面）如何修正经典的达西流剖面。这个练习强调了从第一性原理推导控制方程的重要性，并利用无量纲化方法识别出关键参数，如布林克曼筛选参数 $\\Lambda$。",
            "id": "3989572",
            "problem": "一种动力粘度为 $\\mu$ 的牛顿不可压缩流体，在完全填充于间距为 $2H$ 的两块无限大平行平板之间的各向同性、均匀的多孔介质层中稳定流动。位于 $y=\\pm H$ 处的壁面是不可渗透的，并施加无滑移条件。施加的流向压力梯度是均匀的，为 $\\partial p/\\partial x=-G$，其中 $G>0$ 是常数。宏观（体积平均）速度场是单向且充分发展的，$\\boldsymbol{u}(x,y,z)=u(y)\\,\\boldsymbol{e}_{x}$。乘以宏观粘性扩散（Brinkman）项的有效粘度为 $\\mu_{e}$，其值可能与 $\\mu$ 不同。\n\n仅从牛顿流体的质量守恒（不可压缩性）和线性动量守恒出发，并援引多孔介质流动的标准体积平均法，推导由 Brinkman–Forchheimer 扩展 Darcy 模型 (BFE) 控制的一维典型流动。然后，在宏观上 Forchheimer 惯性阻力可以忽略的渐近状态下，精确求解在 $y=\\pm H$ 处满足无滑移条件的所得边值问题，并积分速度剖面以获得单位宽度的体积流量，\n$$\nQ'=\\int_{-H}^{H} u(y)\\,\\mathrm{d}y.\n$$\n最后，用特征 Darcy 速度 $U_{D}=GK/\\mu$ 和半间距 $H$ 对 $Q'$ 进行无量纲化，并给出无量纲流量的精确闭式表达式\n$$\n\\Phi=\\frac{Q'}{2HU_{D}}\n$$\n作为单一无量纲 Brinkman 筛选参数的函数\n$$\n\\Lambda=H\\sqrt{\\frac{\\mu}{\\mu_{e}K}}.\n$$\n请以 $\\Phi$ 关于 $\\Lambda$ 的单一闭式解析表达式的形式给出最终答案。请勿代入数值，也勿在最终方框内的表达式中包含单位。",
            "solution": "题目要求推导并求解一个由 Brinkman–Forchheimer 扩展 Darcy (BFE) 模型控制的多孔介质流体流动问题，然后对所得流量进行无量纲化。\n\n出发点是稳定、不可压缩牛顿流体的线性动量守恒，然后对其进行体积平均，以获得多孔介质中流动的宏观动量方程。这就是 Brinkman–Forchheimer 扩展 Darcy (BFE) 方程。对于由宏观压力梯度驱动的流动，该矢量方程为：\n$$\n\\frac{\\rho}{\\phi^2} (\\boldsymbol{u} \\cdot \\nabla) \\boldsymbol{u} = -\\nabla p + \\mu_e \\nabla^2 \\boldsymbol{u} - \\frac{\\mu}{K} \\boldsymbol{u} - \\frac{\\rho c_F}{\\sqrt{K}}|\\boldsymbol{u}|\\boldsymbol{u}\n$$\n此处，$\\boldsymbol{u}$ 是表观（或 Darcy）速度，$\\rho$ 是流体密度，$\\phi$ 是孔隙率，$p$ 是宏观压力，$\\mu_e$ 是有效粘度，$\\mu$ 是流体粘度，$K$ 是渗透率，$c_F$ 是 Forchheimer 形状阻力系数。\n\n题目指定在 $y = \\pm H$ 的两平行平板之间，流动是充分发展的单向流场 $\\boldsymbol{u}(x,y,z) = u(y)\\,\\boldsymbol{e}_x$。对于该速度场：\n- 不可压缩流体的连续性方程 $\\nabla \\cdot \\boldsymbol{u} = 0$，由于 $\\frac{\\partial u}{\\partial x} = 0$ 而恒等满足。\n- 对流加速项 $(\\boldsymbol{u} \\cdot \\nabla) \\boldsymbol{u} = (u(y) \\frac{\\partial}{\\partial x}) (u(y)\\boldsymbol{e}_x)$ 为零，因为 $u$ 不是 $x$ 的函数。\n- 粘性扩散（Brinkman）项变为 $\\mu_e \\nabla^2 \\boldsymbol{u} = \\mu_e (\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2})(u(y)\\boldsymbol{e}_x) = \\mu_e \\frac{d^2 u}{dy^2}\\boldsymbol{e}_x$。\n- 施加的压力梯度为 $\\frac{\\partial p}{\\partial x} = -G$，其中 $G>0$ 是常数。因此，$-\\nabla p = G\\,\\boldsymbol{e}_x$。\n- 由于流动是由正值 $G$ 驱动向 $x$ 正方向运动，速度 $u(y)$ 将是非负的。因此，$|\\boldsymbol{u}| = u(y)$。Forchheimer 项简化为 $-\\frac{\\rho c_F}{\\sqrt{K}}u(y)^2\\,\\boldsymbol{e}_x$。\n\n将这些项代入 BFE 方程，并仅考虑 $\\boldsymbol{e}_x$ 方向上的非平凡分量，得到此问题的一维典型 BFE 方程：\n$$\n0 = G + \\mu_e \\frac{d^2 u}{dy^2} - \\frac{\\mu}{K} u - \\frac{\\rho c_F}{\\sqrt{K}} u^2\n$$\n这就完成了所要求的控制方程的推导。\n\n题目接着要求分析 Forchheimer 惯性阻力可以忽略的渐近状态。这对应于将与 $u^2$ 成正比的项设为零。控制方程简化为线性 Brinkman 方程：\n$$\n\\mu_e \\frac{d^2 u}{dy^2} - \\frac{\\mu}{K} u + G = 0\n$$\n我们可以将其重排为二阶线性常微分方程 (ODE) 的标准形式：\n$$\n\\frac{d^2 u}{dy^2} - \\frac{\\mu}{\\mu_e K} u = -\\frac{G}{\\mu_e}\n$$\n这是一个常系数非齐次常微分方程。其通解是特解 $u_p(y)$ 和齐次解 $u_h(y)$ 的和。\n对于特解，我们假设一个常数 $u_p = C$。代入 ODE 中得到：\n$$\n0 - \\frac{\\mu}{\\mu_e K} C = -\\frac{G}{\\mu_e} \\implies C = \\frac{G \\mu_e K}{\\mu \\mu_e} = \\frac{GK}{\\mu}\n$$\n因此，$u_p(y) = \\frac{GK}{\\mu}$。这个速度被认为是 Darcy 速度 $U_D$。\n\n对于齐次解，我们求解 $\\frac{d^2 u_h}{dy^2} - \\frac{\\mu}{\\mu_e K} u_h = 0$。特征方程是 $r^2 - \\frac{\\mu}{\\mu_e K} = 0$，其根为 $r = \\pm \\sqrt{\\frac{\\mu}{\\mu_e K}}$。我们定义 $\\alpha = \\sqrt{\\frac{\\mu}{\\mu_e K}}$。齐次解是 $u_h(y) = C_1 \\cosh(\\alpha y) + C_2 \\sinh(\\alpha y)$。\n\n速度剖面的通解是：\n$$\nu(y) = C_1 \\cosh(\\alpha y) + C_2 \\sinh(\\alpha y) + \\frac{GK}{\\mu}\n$$\n常数 $C_1$ 和 $C_2$ 由壁面处的无滑移边界条件 $u(y=\\pm H) = 0$ 确定。\n$u(H) = C_1 \\cosh(\\alpha H) + C_2 \\sinh(\\alpha H) + \\frac{GK}{\\mu} = 0$\n$u(-H) = C_1 \\cosh(-\\alpha H) + C_2 \\sinh(-\\alpha H) + \\frac{GK}{\\mu} = C_1 \\cosh(\\alpha H) - C_2 \\sinh(\\alpha H) + \\frac{GK}{\\mu} = 0$\n第一个方程减去第二个方程得到 $2 C_2 \\sinh(\\alpha H) = 0$。由于 $\\alpha > 0$ 且 $H>0$，所以 $\\sinh(\\alpha H) \\neq 0$，这意味着 $C_2 = 0$。这证实了由于问题的对称性，速度剖面必须是 $y$ 的偶函数的预期。\n将 $C_2=0$ 代入第一个边界条件方程，得到：\n$C_1 \\cosh(\\alpha H) + \\frac{GK}{\\mu} = 0 \\implies C_1 = -\\frac{GK/\\mu}{\\cosh(\\alpha H)}$。\n\n将常数代回通解，我们得到精确的速度剖面：\n$$\nu(y) = \\frac{GK}{\\mu} - \\frac{GK/\\mu}{\\cosh(\\alpha H)} \\cosh(\\alpha y) = \\frac{GK}{\\mu} \\left( 1 - \\frac{\\cosh(\\alpha y)}{\\cosh(\\alpha H)} \\right)\n$$\n接下来，我们通过将速度剖面从 $y=-H$ 到 $y=H$ 积分来计算单位宽度的体积流量 $Q'$：\n$$\nQ' = \\int_{-H}^{H} u(y) \\, \\mathrm{d}y = \\int_{-H}^{H} \\frac{GK}{\\mu} \\left( 1 - \\frac{\\cosh(\\alpha y)}{\\cosh(\\alpha H)} \\right) \\, \\mathrm{d}y\n$$\n由于被积函数是偶函数，我们可以简化积分：\n$$\nQ' = 2 \\frac{GK}{\\mu} \\int_{0}^{H} \\left( 1 - \\frac{\\cosh(\\alpha y)}{\\cosh(\\alpha H)} \\right) \\, \\mathrm{d}y\n$$\n$$\nQ' = 2 \\frac{GK}{\\mu} \\left[ y - \\frac{\\sinh(\\alpha y)}{\\alpha \\cosh(\\alpha H)} \\right]_{0}^{H} = 2 \\frac{GK}{\\mu} \\left( (H - \\frac{\\sinh(\\alpha H)}{\\alpha \\cosh(\\alpha H)}) - (0 - 0) \\right)\n$$\n$$\nQ' = 2 \\frac{GK}{\\mu} \\left( H - \\frac{\\tanh(\\alpha H)}{\\alpha} \\right)\n$$\n最后，我们对流量 $Q'$ 进行无量纲化以获得 $\\Phi$。题目定义了 $\\Phi = \\frac{Q'}{2HU_{D}}$，其中特征 Darcy 速度为 $U_D = \\frac{GK}{\\mu}$。\n$$\n\\Phi = \\frac{2 \\frac{GK}{\\mu} \\left( H - \\frac{\\tanh(\\alpha H)}{\\alpha} \\right)}{2H \\left(\\frac{GK}{\\mu}\\right)}\n$$\n消去公因子得到：\n$$\n\\Phi = \\frac{H - \\frac{\\tanh(\\alpha H)}{\\alpha}}{H} = 1 - \\frac{\\tanh(\\alpha H)}{\\alpha H}\n$$\n题目要求用无量纲 Brinkman 筛选参数 $\\Lambda = H\\sqrt{\\frac{\\mu}{\\mu_{e}K}}$ 来表示结果。将其与我们的定义 $\\alpha = \\sqrt{\\frac{\\mu}{\\mu_e K}}$ 进行比较，我们看到 $\\alpha H = H\\sqrt{\\frac{\\mu}{\\mu_e K}} = \\Lambda$。\n将 $\\alpha H = \\Lambda$ 代入 $\\Phi$ 的表达式中，得到最终结果：\n$$\n\\Phi = 1 - \\frac{\\tanh(\\Lambda)}{\\Lambda}\n$$",
            "answer": "$$\\boxed{1 - \\frac{\\tanh(\\Lambda)}{\\Lambda}}$$"
        },
        {
            "introduction": "在掌握了线性的Brinkman模型后，我们转向更完整的非线性Brinkman–Forchheimer模型。当流速增加时，流体惯性变得不可忽略，导致压降与速度之间出现二次关系。本练习引导我们通过比较线性达西阻力项和二次Forchheimer阻力项的量级，来量化从达西流向惯性流的转变，这是判断模型复杂度的关键一步。",
            "id": "4079860",
            "problem": "一个储能系统使用一个陶瓷填充床蓄热器，液态水流经其中。在一个计算流体动力学 (CFD) 求解器中，该填充床被建模为一个均匀、各向同性的多孔介质连续体。流体是牛顿流体且不可压缩，流动是稳态的。孔隙率为 $\\varepsilon$，渗透率为 $K$，动力粘度为 $\\mu$，密度为 $\\rho$。Darcy 定律表述了体积平均的表观速度 $\\mathbf{u}$ 与压力梯度之间的线性关系，但在较高流速下，由于孔隙尺度动量输运中的有限孔隙粘性扩散和惯性效应，观察到偏离线性的现象。Darcy 定律的 Brinkman–Forchheimer 扩展增加了一个考虑多孔介质中剪切的粘性扩散项，以及一个与 $|\\mathbf{u}|\\mathbf{u}$ 成正比的二次惯性项。Forchheimer 系数 $C_F$ 具有长度倒数的量纲；在填充床中一个常见的标度关系是 $C_F = \\beta/\\sqrt{K}$，其中 $\\beta = \\mathcal{O}(1)$ 是一个无量纲数。\n\n从孔隙尺度上不可压缩牛顿流体的动量守恒方程出发，使用体积平均法和宏观尺度上的本构封闭，来确定扩展动量平衡的正确形式，并确定一个定量条件，在该条件下，惯性项 $C_F \\rho |\\mathbf{u}|\\mathbf{u}$ 在高表观速度下与粘性阻力项 $\\mu \\mathbf{u}/K$ 在动力学上变得相当。对于所考虑的填充床，取以下数值：\n- $\\rho = 1000\\,\\mathrm{kg/m^3}$，\n- $\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa \\cdot s}$，\n- $K = 5.0\\times 10^{-9}\\,\\mathrm{m^2}$，\n- $\\varepsilon = 0.40$，\n- $\\beta = 1.8$，因此 $C_F = \\beta/\\sqrt{K}$。\n\n哪个选项正确地给出了扩展动量方程以及当 $C_F \\rho |\\mathbf{u}|\\mathbf{u}$ 与 $\\mu \\mathbf{u}/K$ 是同一量级时的临界表观速度 $|\\mathbf{u}|$？\n\nA. $-\\nabla p + \\mu_e \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} + C_F \\rho |\\mathbf{u}| \\mathbf{u} = \\mathbf{0}$，其中 $\\mu_e = \\mu/\\varepsilon$；当 $C_F \\rho K |\\mathbf{u}|/\\mu \\approx 1$ 时，惯性项与粘性阻力相当，对于给定参数，得出 $|\\mathbf{u}| \\approx 7.9\\times 10^{-3}\\,\\mathrm{m/s}$。\n\nB. $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} + C_F \\rho |\\mathbf{u}|^2 = \\mathbf{0}$；当 $C_F \\rho K |\\mathbf{u}|^2/\\mu \\approx 1$ 时，惯性项变得相当，得出 $|\\mathbf{u}| \\approx 8.8\\times 10^{-2}\\,\\mathrm{m/s}$。\n\nC. $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} = \\mathbf{0}$；惯性项可以忽略，除非 $\\varepsilon > 0.9$，因此对于给定的参数，不需要基于 $|\\mathbf{u}|$ 的阈值。\n\nD. $-\\nabla p - \\dfrac{\\mu}{K}\\mathbf{u} + C_F \\rho |\\mathbf{u}| \\mathbf{u} = \\mathbf{0}$；当 $C_F \\rho K |\\mathbf{u}|\\varepsilon/\\mu \\approx 1$ 时，惯性项变得相当，对于给定参数，得出 $|\\mathbf{u}| \\approx 3.1\\times 10^{-3}\\,\\mathrm{m/s}$。",
            "solution": "用户希望我验证并解决一个关于多孔介质中流体流动的问题，该问题由 Brinkman-Forchheimer 方程控制。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**第1步：提取已知条件**\n\n-   **系统：** 一个陶瓷填充床蓄热器，有液态水流过，被建模为一个均匀、各向同性的多孔介质连续体。\n-   **流体性质：** 牛顿流体、不可压缩、密度 $\\rho$、动力粘度 $\\mu$。\n-   **流动：** 稳态。\n-   **多孔介质性质：** 孔隙率 $\\varepsilon$、渗透率 $K$。\n-   **控制模型：** Darcy 定律的 Brinkman–Forchheimer 扩展，包括一个粘性扩散项和一个二次惯性项。惯性项被给出为与 $|\\mathbf{u}|\\mathbf{u}$ 成正比。\n-   **Forchheimer 系数：** $C_F$，量纲为长度的倒数。\n-   **Forchheimer 系数的标度关系：** $C_F = \\beta/\\sqrt{K}$。\n-   **数值：**\n    -   $\\rho = 1000\\,\\mathrm{kg/m^3}$\n    -   $\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa \\cdot s}$\n    -   $K = 5.0\\times 10^{-9}\\,\\mathrm{m^2}$\n    -   $\\varepsilon = 0.40$\n    -   $\\beta = 1.8$\n-   **问题：**\n    1.  确定扩展动量平衡方程的正确形式。\n    2.  确定惯性项 $C_F \\rho |\\mathbf{u}|\\mathbf{u}$ 与粘性阻力项 $\\mu \\mathbf{u}/K$ 在动力学上相当的条件。\n    3.  根据此条件计算临界表观速度 $|\\mathbf{u}|$。\n\n**第2步：使用提取的已知条件进行验证**\n\n-   **科学依据：** 该问题基于成熟的 Brinkman-Forchheimer 模型，用于描述多孔介质中的流动。该模型是 Darcy 定律的标准扩展，在计算流体动力学中得到应用，并坚实地植根于流体力学原理。\n-   **良态的：** 问题提供了明确的目标和所有必要的物理参数及本构关系（$\\rho$、$\\mu$、$K$、$\\varepsilon$、$\\beta$ 以及 $C_F$ 的标度关系），足以构建方程并进行所需计算。可以确定临界速度的唯一解。\n-   **客观的：** 问题使用精确、客观和标准的科学术语进行陈述。\n-   **缺陷检查表：**\n    1.  **科学/事实不健全：** 无。所描述的物理学是正确的。数值对于水流过填充床是物理上现实的。\n    2.  **非形式化/不相关：** 该问题与能源系统建模直接相关，特别是关于热能储存，并且是计算流体动力学中一个可形式化的问题。\n    3.  **不完整/矛盾的设置：** 设置是完整且自洽的。\n    4.  **不现实/不可行：** 给定的参数值在物理上是合理的。\n    5.  **不适定/结构不良：** 问题结构良好，能导出一个唯一答案。\n    6.  **伪深刻/琐碎：** 该问题需要关于多孔介质中输运现象的非琐碎知识，以及进行标度分析和计算的能力。\n    7.  **超出科学可验证性：** 该问题是一个标准的物理和工程计算，完全可以验证。\n\n**第3步：结论和行动**\n\n问题陈述是**有效的**。我将继续推导解答。\n\n### 解答推导\n\n问题要求给出由 Brinkman-Forchheimer 模型描述的，在多孔介质中不可压缩流体的稳态动量平衡方程的正确形式，并进行后续分析。\n\n**1. Brinkman-Forchheimer 方程**\n\n多孔介质中稳态流动的体积平均动量守恒方程平衡了压力梯度力与各种阻力，并考虑了宏观粘性扩散。该方程是单位体积力的总和。\n\n-   **压力梯度力：** $-\\nabla p$，其中 $p$ 是宏观压力。\n-   **粘性阻力（Darcy 项）：** 该项代表来自固体基质的体积阻力，由 $-\\dfrac{\\mu}{K}\\mathbf{u}$ 给出，其中 $\\mathbf{u}$ 是表观速度。\n-   **惯性阻力（Forchheimer 项）：** 该项解释了由于惯性效应（流动路径的曲折性和孔隙尺度上流体的加减速）引起的压降，并与流动的动能成正比。其形式为 $-C_F \\rho |\\mathbf{u}|\\mathbf{u}$。\n-   **粘性扩散（Brinkman 项）：** 该项解释了宏观尺度上由粘性剪切应力引起的动量输运，类似于 Navier-Stokes 方程中的粘性项。它写作 $\\mu_e \\nabla^2 \\mathbf{u}$，其中 $\\mu_e$ 是有效粘度。\n\n将这些力相加为零，得到 Brinkman-Forchheimer 方程的标准形式：\n$$ -\\nabla p + \\mu_e \\nabla^2 \\mathbf{u} - \\frac{\\mu}{K}\\mathbf{u} - C_F \\rho |\\mathbf{u}|\\mathbf{u} = \\mathbf{0} $$\n请注意，阻力项（Darcy 和 Forchheimer）与流动方向相反，因此在与驱动压力力 $(-\\nabla p)$ 相加时应为负号。所提供的选项似乎对 Forchheimer 项使用了非标准的符号约定，显示为 `+`。我们将基于选项的内部一致性和完整性来分析它们。\n\n**2. 比较惯性阻力项和粘性阻力项的条件**\n\n问题要求找到惯性项何时与粘性阻力项在动力学上相当。这通过将两项的量值相等来确定。\n-   惯性项的量值： $\\| C_F \\rho |\\mathbf{u}|\\mathbf{u} \\| = C_F \\rho |\\mathbf{u}|^2$。\n-   粘性阻力项的量值： $\\| \\dfrac{\\mu}{K}\\mathbf{u} \\| = \\dfrac{\\mu}{K} |\\mathbf{u}|$。\n\n令它们的量级相同：\n$$ C_F \\rho |\\mathbf{u}|^2 \\approx \\frac{\\mu}{K} |\\mathbf{u}| $$\n假设速度不为零，即 $|\\mathbf{u}| \\neq 0$，我们可以两边同除以 $|\\mathbf{u}|$:\n$$ C_F \\rho |\\mathbf{u}| \\approx \\frac{\\mu}{K} $$\n为了将其表示为无量纲准则，我们可以重新排列各项：\n$$ \\frac{C_F \\rho K |\\mathbf{u}|}{\\mu} \\approx 1 $$\n这个无量纲群，有时称为 Forchheimer 数，代表了惯性阻力与粘性阻力之比。当这个数约为1时，流动过渡到惯性区。\n\n**3. 临界表观速度 $|\\mathbf{u}|$ 的计算**\n\n我们求解 $|\\mathbf{u}|$ 的条件：\n$$ |\\mathbf{u}| \\approx \\frac{\\mu}{C_F \\rho K} $$\n问题提供了 $C_F$ 的一个标度关系：$C_F = \\beta/\\sqrt{K}$。代入可得：\n$$ |\\mathbf{u}| \\approx \\frac{\\mu}{(\\beta/\\sqrt{K}) \\rho K} = \\frac{\\mu \\sqrt{K}}{\\beta \\rho K} = \\frac{\\mu}{\\beta \\rho \\sqrt{K}} $$\n现在，我们代入给定的数值：\n-   $\\mu = 1.0\\times 10^{-3}\\,\\mathrm{Pa \\cdot s}$\n-   $\\beta = 1.8$\n-   $\\rho = 1000\\,\\mathrm{kg/m^3}$\n-   $K = 5.0\\times 10^{-9}\\,\\mathrm{m^2}$\n\n首先，计算 $\\sqrt{K}$:\n$$ \\sqrt{K} = \\sqrt{5.0 \\times 10^{-9}}\\,\\mathrm{m} \\approx 7.07107 \\times 10^{-5}\\,\\mathrm{m} $$\n现在，计算 $|\\mathbf{u}|$:\n$$ |\\mathbf{u}| \\approx \\frac{1.0 \\times 10^{-3}\\,\\mathrm{Pa \\cdot s}}{1.8 \\times 1000\\,\\mathrm{kg/m^3} \\times 7.07107 \\times 10^{-5}\\,\\mathrm{m}} $$\n$$ |\\mathbf{u}| \\approx \\frac{1.0 \\times 10^{-3}}{1.8 \\times 10^3 \\times 7.07107 \\times 10^{-5}} \\,\\mathrm{m/s} $$\n$$ |\\mathbf{u}| \\approx \\frac{1.0 \\times 10^{-3}}{12.7279 \\times 10^{-2}} \\,\\mathrm{m/s} \\approx \\frac{1.0 \\times 10^{-3}}{0.127279} \\,\\mathrm{m/s} $$\n$$ |\\mathbf{u}| \\approx 7.8567 \\times 10^{-3}\\,\\mathrm{m/s} $$\n四舍五入到两位有效数字，我们得到 $|\\mathbf{u}| \\approx 7.9 \\times 10^{-3}\\,\\mathrm{m/s}$。\n\n### 逐项分析选项\n\n**A. $-\\nabla p + \\mu_e \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} + C_F \\rho |\\mathbf{u}| \\mathbf{u} = \\mathbf{0}$，其中 $\\mu_e = \\mu/\\varepsilon$；当 $C_F \\rho K |\\mathbf{u}|/\\mu \\approx 1$ 时，惯性项与粘性阻力相当，对于给定参数，得出 $|\\mathbf{u}| \\approx 7.9\\times 10^{-3}\\,\\mathrm{m/s}$。**\n-   **方程：** 该方程包含了 Brinkman-Forchheimer 模型的所有组成部分（压力、Brinkman、Darcy、Forchheimer）。有效粘度 $\\mu_e = \\mu/\\varepsilon$ 的选择是一个物理上合理的封闭模型。Forchheimer 项的符号非标准，但可能是问题中的有意约定或印刷错误。在所有选项中，这是最完整的形式。\n-   **条件：** 条件 $C_F \\rho K |\\mathbf{u}|/\\mu \\approx 1$ 正确地表示了惯性阻力项和粘性阻力项的量值之比。\n-   **计算：** 计算出的速度 $|\\mathbf{u}| \\approx 7.9\\times 10^{-3}\\,\\mathrm{m/s}$ 与我们的推导相符。\n-   **结论：** **正确**。尽管 Forchheimer 项上可能存在符号错误（这也是其他选项的共同问题），但该选项正确地指出了方程的组成部分、标度条件以及最终的数值结果。\n\n**B. $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} + C_F \\rho |\\mathbf{u}|^2 = \\mathbf{0}$；当 $C_F \\rho K |\\mathbf{u}|^2/\\mu \\approx 1$ 时，惯性项变得相当，得出 $|\\mathbf{u}| \\approx 8.8\\times 10^{-2}\\,\\mathrm{m/s}$。**\n-   **方程：** 项 $C_F \\rho |\\mathbf{u}|^2$ 是一个标量。它不能与动量方程中的其他矢量项相加。这是矢量/张量代数中的一个基本错误。\n-   **条件：** 该条件在量纲上也是错误的，它比较了一个与 $|\\mathbf{u}|^2$ 成正比的项和一个常数。\n-   **结论：** **不正确**。\n\n**C. $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} - \\dfrac{\\mu}{K}\\mathbf{u} = \\mathbf{0}$；惯性项可以忽略，除非 $\\varepsilon > 0.9$，因此对于给定的参数，不需要基于 $|\\mathbf{u}|$ 的阈值。**\n-   **方程：** 这是 Brinkman-Darcy 方程；它完全忽略了 Forchheimer 惯性项，而这正是问题的核心。\n-   **条件：** 关于惯性项可以忽略的说法与问题的前提相矛盾，问题的前提是找到它*不可*忽略的条件。关于 $\\varepsilon > 0.9$ 的说法是一个没有根据基本力比较的任意断言。\n-   **结论：** **不正确**。\n\n**D. $-\\nabla p - \\dfrac{\\mu}{K}\\mathbf{u} + C_F \\rho |\\mathbf{u}| \\mathbf{u} = \\mathbf{0}$；当 $C_F \\rho K |\\mathbf{u}|\\varepsilon/\\mu \\approx 1$ 时，惯性项变得相当，对于给定参数，得出 $|\\mathbf{u}| \\approx 3.1\\times 10^{-3}\\,\\mathrm{m/s}$。**\n-   **方程：** 该方程忽略了 Brinkman 项 ($\\mu_e \\nabla^2 \\mathbf{u}$)。问题明确要求 \"Brinkman-Forchheimer\" 模型，该模型 \"增加了一个粘性扩散项\"。因此，根据问题描述，该方程是不完整的。\n-   **条件：** 所提出的条件 $C_F \\rho K |\\mathbf{u}|\\varepsilon/\\mu \\approx 1$ 在没有从宏观项 $\\mu\\mathbf{u}/K$ 和 $C_F \\rho |\\mathbf{u}|\\mathbf{u}$ 的直接比较中得到证明的情况下，引入了孔隙率 $\\varepsilon$。\n-   **计算：** 此外，数值 $|\\mathbf{u}| \\approx 3.1\\times 10^{-3}\\,\\mathrm{m/s}$ 与所述条件不一致。条件 $C_F \\rho K |\\mathbf{u}|\\varepsilon/\\mu \\approx 1$ 将得出 $|\\mathbf{u}| \\approx \\mu / (C_F \\rho K \\varepsilon) \\approx (7.9 \\times 10^{-3})/0.4 \\approx 2.0 \\times 10^{-2}\\,\\mathrm{m/s}$。给出的值 $3.1\\times 10^{-3}\\,\\mathrm{m/s}$ 似乎来自一个未说明的替代条件。\n-   **结论：** **不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "该练习旨在连接理论模型与工程实际。它演示了如何利用实验数据（压降与流速的关系）来确定Forchheimer-Darcy模型的关键参数：渗透率 $K$ 和惯性系数 $\\beta$。通过将控制方程转化为一个线性回归问题，本练习介绍了一种强大的模型校准与验证技术，这是计算工程师的核心技能之一。",
            "id": "3989580",
            "problem": "您的任务是为受 Brinkman–Forchheimer 扩展 Darcy 模型支配的、流经刚性、均匀、各向同性多孔介质的流动，推导、实现并验证一个参数辨识程序。重点是稳态、不可压缩、等温状态，并具有恒定的横截面和可忽略的体积力。您的工作必须从基本定律出发，得出一个能够从压力-流量测量中估算渗透率和惯性阻力的计算方法，然后进行定量模型验证。\n\n起点和建模假设：\n- 从牛顿流体（动力粘度为 $\\mu$，密度为 $\\rho$）在多孔介质中稳态流动的线性动量守恒定律开始。使用适用于多孔介质的体积平均形式的方程，其中包括与表观速度成正比的线性拖曳项（Darcy 贡献）、与表观速度大小和表观速度的乘积成正比的二次拖曳项（Forchheimer 贡献），以及与表观速度的拉普拉斯算子成正比的粘性扩散项（Brinkman 贡献）。\n- 假设流动为流向的一维、充分发展的流动，孔隙率恒定，横截面恒定，且横截面平均的流向速度剖面的空间变化可忽略，因此在流向的平均长度尺度上，可以忽略横截面平均的粘性扩散项。在您的推导中明确陈述这些假设。\n\n任务：\n1) 在上述假设下，从第一性原理推导出一维、稳态、横截面平均的流向动量平衡。您的推导应说明为何流向压力梯度可以表示为由表观速度构建的两个回归量的线性组合，并且必须明确指出哪些未知参数是线性进入的。除了线性和二次拖曳贡献的存在之外，不要引用任何经验方程；相反，将这些拖曳项与动量平衡联系起来，并清楚地证明在所述假设下忽略横截面平均粘性扩散项的合理性。明确指出渗透率和惯性阻力系数与线性回归系数的关系。\n\n2) 基于您推导出的可用于回归的形式，为未知参数设计一个普通最小二乘估计器。提供从拟合的回归系数中恢复渗透率 $K$（单位 $\\text{m}^{2}$）和 Forchheimer 惯性阻力系数 $\\beta$（单位 $\\text{m}^{-1}$）的明确公式。定义将用于评估拟合优度的均方根误差 (RMSE) 和决定系数 $R^{2}$。RMSE 必须以 $\\text{Pa}/\\text{m}$ 为单位报告。$R^{2}$ 必须作为纯数字报告。\n\n3) 实现一个完整的程序，该程序对以下每个独立的测试数据集，估算 $K$ 和 $\\beta$，并计算 RMSE 和 $R^{2}$。在您的推导所隐含的回归结构上使用普通最小二乘法。所有情况均使用以下材料属性：$\\mu = 1.0\\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$ 和 $\\rho = 1000\\ \\text{kg}/\\text{m}^{3}$。表观速度用 $U$ 表示，单位为 $\\text{m}/\\text{s}$，测量的流向压力梯度用 $g$ 表示，单位为 $\\text{Pa}/\\text{m}$。\n\n测试套件（每个案例提供 $\\{U_{i}\\}$ 和 $\\{g_{i}\\}$）：\n- 案例 1（一般混合状态）：\n  - $U = [0.02, 0.04, 0.06, 0.10, 0.15]\\ \\text{m}/\\text{s}$\n  - $g = [7066.6666667, 14933.3333333, 23600.0, 43333.3333333, 72500.0]\\ \\text{Pa}/\\text{m}$\n- 案例 2（Darcy 主导状态）：\n  - $U = [0.002, 0.004, 0.006, 0.008, 0.010]\\ \\text{m}/\\text{s}$\n  - $g = [200.8, 403.2, 607.2, 812.8, 1020.0]\\ \\text{Pa}/\\text{m}$\n- 案例 3（Forchheimer 主导状态）：\n  - $U = [0.5, 0.7, 0.9, 1.1]\\ \\text{m}/\\text{s}$\n  - $g = [635000.0, 1239000.0, 2043000.0, 3047000.0]\\ \\text{Pa}/\\text{m}$\n- 案例 4（符号变化以测试方向处理）：\n  - $U = [-0.2, -0.1, 0.0, 0.1, 0.2]\\ \\text{m}/\\text{s}$\n  - $g = [-160000.0, -65000.0, 0.0, 65000.0, 160000.0]\\ \\text{Pa}/\\text{m}$\n- 案例 5（二次拖曳可忽略的边界情况）：\n  - $U = [0.01, 0.02, 0.03, 0.04]\\ \\text{m}/\\text{s}$\n  - $g = [8333.3333333, 16666.6666667, 25000.0, 33333.3333333]\\ \\text{Pa}/\\text{m}$\n\n数值与报告要求：\n- 在您的推导所隐含的回归结构上实现不带正则化的普通最小二乘法，并计算估计值 $\\widehat{K}$ 和 $\\widehat{\\beta}$。\n- 使用您的拟合模型预测值，为每个案例计算 RMSE（单位 $\\text{Pa}/\\text{m}$）和 $R^{2}$。\n- 报告 $\\widehat{K}$（单位 $\\text{m}^{2}$）、$\\widehat{\\beta}$（单位 $\\text{m}^{-1}$）和 RMSE（单位 $\\text{Pa}/\\text{m}$）。$R^{2}$ 是无单位的。将每个报告的数字四舍五入到 $6$ 位有效数字。\n- 您的程序应生成单行输出，其中包含所有案例的结果，形式为列表的列表，按案例顺序排列，每个内部列表为 $[\\widehat{K}, \\widehat{\\beta}, \\text{RMSE}, R^{2}]$。输出必须是严格符合以下格式的单行：\n\"[ [k1,beta1,rmse1,r21], [k2,beta2,rmse2,r22], [k3,beta3,rmse3,r23], [k4,beta4,rmse4,r24], [k5,beta5,rmse5,r25] ]\"\n根据需要使用标准十进制或科学记数法，四舍五入到 $6$ 位有效数字。不应打印任何附加文本。",
            "solution": "我们从在刚性、均匀、各向同性的多孔介质中流动的稳态、不可压缩牛顿流体（动力粘度为 $\\mu$，密度为 $\\rho$）的线性动量守恒开始。在适用于多孔介质的体积平均公式中，Brinkman–Forchheimer 扩展 Darcy 模型在 Darcy 的线性拖曳基础上增加了 Brinkman 的粘性扩散和 Forchheimer 的二次惯性拖曳。体积平均动量平衡的流向分量可以写为\n$$\n\\mathbf{0} = - \\nabla \\langle p \\rangle + \\mu_{\\text{eff}} \\nabla^{2} \\langle \\mathbf{u} \\rangle - \\frac{\\mu}{K}\\, \\langle \\mathbf{u} \\rangle - \\rho\\, \\beta\\, \\left\\lVert \\langle \\mathbf{u} \\rangle \\right\\rVert \\langle \\mathbf{u} \\rangle,\n$$\n其中 $\\langle \\cdot \\rangle$ 表示在代表性单元体积上的内在或表观平均，$K$ 是渗透率（单位 $\\text{m}^{2}$），$\\beta$ 是惯性阻力系数（单位 $\\text{m}^{-1}$）。项 $\\mu_{\\text{eff}} \\nabla^{2} \\langle \\mathbf{u} \\rangle$ 是 Brinkman 粘性扩散贡献，其中 $\\mu_{\\text{eff}}$ 是有效粘度。对于在 $x$ 方向上具有恒定横截面且平均流向速度剖面的横截面变化可忽略的一维、稳态、充分发展的流动，平均流向速度的横截面平均拉普拉斯算子在 $x$ 方向的平均长度上为零。当特征流向变化长度尺度远大于孔隙尺度，且流动已充分发展，使得入口和壁面层效应局限于对平均尺度无贡献的薄区域时，这一假设是合理的。在这些条件下，横截面平均的 Brinkman 项可以在流向平衡中被忽略。\n\n令 $U$ 表示 $x$ 方向上横截面平均的表观速度，令 $g = - \\mathrm{d}\\langle p \\rangle / \\mathrm{d}x$ 表示流向压力梯度（当压力沿流动方向下降时为正）。一维、充分发展、横截面平均的流向动量平衡简化为拖曳力与压力梯度之间的代数平衡：\n$$\ng = \\frac{\\mu}{K}\\, U + \\rho\\, \\beta\\, \\lvert U \\rvert\\, U.\n$$\n这个表达式将 $g$ 表示为由 $U$ 构建的两个回归量（即 $U$ 和 $\\lvert U \\rvert U$）的线性组合，其未知系数是线性进入的。定义两个回归系数\n$$\na \\equiv \\frac{\\mu}{K}, \\qquad b \\equiv \\rho\\, \\beta.\n$$\n于是模型变为\n$$\ng = a\\, U + b\\, \\lvert U \\rvert\\, U,\n$$\n这对于未知数 $a$ 和 $b$ 是线性的。一旦从数据中估计出 $a$ 和 $b$，物理参数可通过以下方式恢复\n$$\n\\widehat{K} = \\frac{\\mu}{\\widehat{a}}, \\qquad \\widehat{\\beta} = \\frac{\\widehat{b}}{\\rho}.\n$$\n\n给定 $n$ 个测量值 $\\{(U_{i}, g_{i})\\}_{i=1}^{n}$，构建 $n \\times 2$ 的设计矩阵\n$$\n\\mathbf{X} = \\begin{bmatrix}\nU_{1} & \\lvert U_{1} \\rvert U_{1} \\\\\nU_{2} & \\lvert U_{2} \\rvert U_{2} \\\\\n\\vdots & \\vdots \\\\\nU_{n} & \\lvert U_{n} \\rvert U_{n}\n\\end{bmatrix},\n$$\n和观测向量\n$$\n\\mathbf{y} = \\begin{bmatrix} g_{1} \\\\ g_{2} \\\\ \\vdots \\\\ g_{n} \\end{bmatrix}.\n$$\n普通最小二乘估计器 $\\widehat{\\boldsymbol{\\theta}} = [\\widehat{a}, \\widehat{b}]^{\\top}$ 最小化残差平方和，由下式给出\n$$\n\\widehat{\\boldsymbol{\\theta}} = \\underset{\\boldsymbol{\\theta} \\in \\mathbb{R}^{2}}{\\arg\\min}\\ \\lVert \\mathbf{X}\\, \\boldsymbol{\\theta} - \\mathbf{y} \\rVert_{2}^{2} = \\left(\\mathbf{X}^{\\top} \\mathbf{X}\\right)^{-1} \\mathbf{X}^{\\top} \\mathbf{y},\n$$\n前提是 $\\mathbf{X}^{\\top} \\mathbf{X}$ 是可逆的，或者更一般地，通过 Moore–Penrose 伪逆。模型预测值为 $\\widehat{\\mathbf{y}} = \\mathbf{X}\\, \\widehat{\\boldsymbol{\\theta}}$，其中 $\\widehat{y}_{i}$ 是与 $U_{i}$ 对应的预测压力梯度。\n\n为量化模型拟合度，计算均方根误差 (RMSE) 和决定系数 $R^{2}$：\n$$\n\\mathrm{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} \\left(g_{i} - \\widehat{g}_{i}\\right)^{2}}, \\qquad\nR^{2} = 1 - \\frac{\\sum_{i=1}^{n}\\left(g_{i} - \\widehat{g}_{i}\\right)^{2}}{\\sum_{i=1}^{n}\\left(g_{i} - \\overline{g}\\right)^{2}},\n$$\n其中 $\\overline{g} = \\frac{1}{n} \\sum_{i=1}^{n} g_{i}$。RMSE 的单位是 $\\text{Pa}/\\text{m}$，$R^{2}$ 是无单位的。\n\n算法设计：\n- 对于每个数据集，用列 $U_{i}$ 和 $\\lvert U_{i} \\rvert U_{i}$ 组装 $\\mathbf{X}$，用 $g_{i}$ 组装 $\\mathbf{y}$。\n- 使用普通最小二乘法（例如，通过数值稳定的最小二乘求解器）求解 $\\widehat{a}$ 和 $\\widehat{b}$。\n- 恢复 $\\widehat{K} = \\mu / \\widehat{a}$（单位 $\\text{m}^{2}$）和 $\\widehat{\\beta} = \\widehat{b} / \\rho$（单位 $\\text{m}^{-1}$）。\n- 计算 $\\widehat{\\mathbf{y}}$、RMSE（单位 $\\text{Pa}/\\text{m}$）和 $R^{2}$。\n- 将每个报告值四舍五入到 $6$ 位有效数字以供输出。\n\n应用于所提供的测试套件：\n- 所有案例共享 $\\mu = 1.0 \\times 10^{-3}\\ \\text{Pa}\\cdot\\text{s}$ 和 $\\rho = 1000\\ \\text{kg}/\\text{m}^{3}$。\n- 五个数据集提供了 $\\{U_{i}\\}$ 和 $\\{g_{i}\\}$，其中 $U_{i}$ 单位为 $\\text{m}/\\text{s}$，$g_{i}$ 单位为 $\\text{Pa}/\\text{m}$。\n- 组装设计矩阵和观测向量，解决最小二乘问题，并如上所述计算所要求的度量指标。\n\n最终输出规范：\n- 生成单行输出，包含一个含五个内部列表的列表，按案例顺序排列，每个内部列表为 $[\\widehat{K}, \\widehat{\\beta}, \\mathrm{RMSE}, R^{2}]$。\n- 单位和四舍五入：$\\widehat{K}$ 单位为 $\\text{m}^{2}$，$\\widehat{\\beta}$ 单位为 $\\text{m}^{-1}$，$\\mathrm{RMSE}$ 单位为 $\\text{Pa}/\\text{m}$，$R^{2}$ 无单位；每个值都四舍五入到 $6$ 位有效数字。\n- 输出格式必须严格为：\n\"[ [k1,beta1,rmse1,r21], [k2,beta2,rmse2,r22], [k3,beta3,rmse3,r23], [k4,beta4,rmse4,r24], [k5,beta5,rmse5,r25] ]\"\n除了所示的空格外，不需要额外的空格，但条目和列表之间用逗号分隔，且无附加文本。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef ols_fit(U, g):\n    \"\"\"\n    Ordinary least squares fit for g = a*U + b*|U|*U.\n    Returns (a_hat, b_hat), predictions g_hat.\n    \"\"\"\n    U = np.asarray(U, dtype=float)\n    g = np.asarray(g, dtype=float)\n    X = np.column_stack([U, np.abs(U) * U])\n    # Use least squares solver for numerical stability\n    theta, *_ = np.linalg.lstsq(X, g, rcond=None)\n    g_hat = X @ theta\n    return theta, g_hat\n\ndef rmse_and_r2(g, g_hat):\n    g = np.asarray(g, dtype=float)\n    g_hat = np.asarray(g_hat, dtype=float)\n    resid = g - g_hat\n    rmse = np.sqrt(np.mean(resid**2))\n    # Numerical guard for tiny negative due to rounding\n    if abs(rmse)  1e-12:\n        rmse = 0.0\n    # R^2\n    denom = np.sum((g - np.mean(g))**2)\n    # If denom is zero (constant g), define R^2 = 1 if perfect fit else 0\n    if denom == 0.0:\n        r2 = 1.0 if np.allclose(g, g_hat, atol=1e-12, rtol=0.0) else 0.0\n    else:\n        r2 = 1.0 - np.sum(resid**2) / denom\n    # Clamp R^2 to [0,1] within numerical tolerance\n    if abs(r2 - 1.0)  1e-12:\n        r2 = 1.0\n    if abs(r2)  1e-12:\n        r2 = 0.0\n    return rmse, r2\n\ndef format_sigfig(x, sig=6):\n    # Format to a string with a given number of significant figures\n    # Use general format; ensure \"0\" for very small numbers\n    if x == 0.0:\n        return \"0\"\n    return f\"{x:.{sig}g}\"\n\ndef solve():\n    # Fluid properties (common to all cases)\n    mu = 1.0e-3  # Pa*s\n    rho = 1000.0  # kg/m^3\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case: (U_list [m/s], g_list [Pa/m])\n        ([0.02, 0.04, 0.06, 0.10, 0.15],\n         [7066.6666667, 14933.3333333, 23600.0, 43333.3333333, 72500.0]),\n        ([0.002, 0.004, 0.006, 0.008, 0.010],\n         [200.8, 403.2, 607.2, 812.8, 1020.0]),\n        ([0.5, 0.7, 0.9, 1.1],\n         [635000.0, 1239000.0, 2043000.0, 3047000.0]),\n        ([-0.2, -0.1, 0.0, 0.1, 0.2],\n         [-160000.0, -65000.0, 0.0, 65000.0, 160000.0]),\n        ([0.01, 0.02, 0.03, 0.04],\n         [8333.3333333, 16666.6666667, 25000.0, 33333.3333333]),\n    ]\n\n    results = []\n    for U, g in test_cases:\n        theta, g_hat = ols_fit(U, g)\n        a_hat, b_hat = theta[0], theta[1]\n        # Recover physical parameters\n        # K_hat in m^2, beta_hat in 1/m\n        K_hat = mu / a_hat\n        beta_hat = b_hat / rho\n        # Validation metrics\n        rmse, r2 = rmse_and_r2(g, g_hat)\n        results.append([K_hat, beta_hat, rmse, r2])\n\n    # Format results to required 6 significant figures\n    formatted = []\n    for K_hat, beta_hat, rmse, r2 in results:\n        formatted.append(\n            \"[\" + \",\".join([\n                format_sigfig(K_hat, 6),\n                format_sigfig(beta_hat, 6),\n                format_sigfig(rmse, 6),\n                format_sigfig(r2, 6)\n            ]) + \"]\"\n        )\n\n    # Final print statement in the exact required format.\n    print(\"[\" + \", \".join(formatted) + \"]\")\n\nsolve()\n```"
        }
    ]
}