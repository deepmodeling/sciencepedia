{
    "hands_on_practices": [
        {
            "introduction": "本练习为理解物理可压缩性与不可压缩流动近似之间的区别奠定了理论基础。我们将从基本的热力学原理出发，推导液体中的声速，并将其与等熵体积模量这一材料属性联系起来。通过这个练习 ()，您将计算水中声速，并深入分析为何一种物理上可压缩的流体，在许多计算流体动力学应用中，通常可以被精确地建模为具有无散度的速度场。",
            "id": "3940188",
            "problem": "一个充满水的通道被建模用于在温度 $T = 25\\,\\mathrm{^\\circ C}$ 和绝对压力 $p = 0.1\\,\\mathrm{MPa}$ 下进行计算热工学中的计算流体力学 (CFD) 分析。对于小振幅扰动，压缩波的传播速度（声速）由流体在等熵约束下的热力学响应决定。从基本热力学定义和连续介质质量平衡出发，推导液体声速 $c$ 的表达式，该表达式用等熵体积模量 $K_s$ 和质量密度 $\\rho$ 表示，然后使用以下测得的性质，计算在该给定条件下水的声速 $c$：\n- 等熵体积模量 $K_s = 2.20 \\times 10^{9}\\,\\mathrm{Pa}$，\n- 质量密度 $\\rho = 997\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$。\n将最终数值结果四舍五入至四位有效数字，并以 $\\mathrm{m}\\,\\mathrm{s}^{-1}$ 为单位表示速度。\n\n在您的解答中，还需提供一个简短的、基于第一性原理的分析性讨论，解释液体在物理上如何以及为何是可压缩的（具有有限的等熵体积模量），但在许多工程流动中却表现出几乎无散的速度场。讨论应围绕质量守恒方程、材料响应函数（如等熵压缩率 $\\beta_s$ 和体积热膨胀系数 $\\alpha$）以及适当的无量纲标度分析（例如，马赫数 $M$）展开，并明确指出在何种条件下不可压缩公式是合理的。",
            "solution": "该问题被评估为有效，因为它具有科学依据、提法明确、客观，并包含完整解答所需的所有信息。它提出了一个连续介质力学和计算热工学领域的标准但有实质内容的问题。\n\n解答按要求分为三部分：首先，推导声速；其次，对水进行数值计算；第三，对液体的不可压缩流近似进行分析性讨论。\n\n第一部分：声速 $c$ 的推导\n\n流体中小振幅扰动（声波）的传播由质量和动量守恒定律控制。对于一维、无粘性、非导热流，其欧拉形式的控制方程为连续性方程和欧拉方程。\n\n连续性方程：\n$$ \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0 $$\n\n动量方程：\n$$ \\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0 $$\n\n此处，$\\rho$ 是流体密度，$u$ 是 $x$ 方向的流体速度，$p$ 是压力，$t$ 是时间。\n\n我们分析一个静止介质中的小扰动传播。流体初始处于静止状态，密度为 $\\rho_0$，压力为 $p_0$。扰动引入了微小的变化：\n$$ \\rho(x,t) = \\rho_0 + \\rho' (x,t) $$\n$$ u(x,t) = 0 + u' (x,t) $$\n$$ p(x,t) = p_0 + p' (x,t) $$\n其中带撇的量（$\\rho'$, $u'$, $p'$）是小扰动，即 $|\\rho'| \\ll \\rho_0$， $|u'| \\ll c$，$|p'| \\ll p_0$。\n\n将这些代入连续性方程并展开：\n$$ \\frac{\\partial (\\rho_0 + \\rho')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial x} = 0 $$\n$$ \\frac{\\partial \\rho'}{\\partial t} + \\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial x} = 0 $$\n忽略二阶项 $\\rho' u'$，我们得到线性化的连续性方程：\n$$ \\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0 \\quad (1) $$\n\n同样，代入动量方程：\n$$ \\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') (u')^2 + p_0 + p')}{\\partial x} = 0 $$\n$$ \\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial t} + \\frac{\\partial (\\rho_0 (u')^2 + \\rho' (u')^2 + p_0 + p')}{\\partial x} = 0 $$\n忽略二阶项（$\\rho' u'$, $(u')^2$, $\\rho'(u')^2$），方程简化为：\n$$ \\rho_0 \\frac{\\partial u'}{\\partial t} + \\frac{\\partial p'}{\\partial x} = 0 \\quad (2) $$\n\n问题指出过程是等熵的。这意味着压力扰动 $p'$ 仅是密度扰动 $\\rho'$ 在熵 $s$ 恒定时的函数。对于小扰动，我们可以使用泰勒展开在平衡态附近表示这种关系，只保留一阶项：\n$$ p' \\approx \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s \\rho' $$\n项 $\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$ 是我们定义为 $c^2$ 的声速的平方：\n$$ c^2 \\equiv \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s $$\n因此，$p' = c^2 \\rho'$。将此代入线性化的动量方程 (2)：\n$$ \\rho_0 \\frac{\\partial u'}{\\partial t} + c^2 \\frac{\\partial \\rho'}{\\partial x} = 0 \\quad (3) $$\n\n我们现在有一个由 (1) 和 (3) 组成的两个一阶线性偏微分方程组。我们可以将它们组合成一个二阶波动方程。对 (1) 式关于 $t$ 求导，对 (3) 式关于 $x$ 求导：\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} + \\rho_0 \\frac{\\partial^2 u'}{\\partial t \\partial x} = 0 $$\n$$ \\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} + c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2} = 0 $$\n假设扰动足够光滑，可以交换求导顺序（$\\frac{\\partial^2 u'}{\\partial t \\partial x} = \\frac{\\partial^2 u'}{\\partial x \\partial t}$）。我们可以将第二个方程中的 $\\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} = -c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2}$ 代入第一个方程：\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2} = 0 $$\n这是一维波动方程，它描述了以速度 $c$ 传播的扰动。\n\n接下来，我们将 $c^2$ 与等熵体积模量 $K_s$ 联系起来。体积模量定义为物质抵抗均匀压缩能力的度量：\n$$ K = -V \\left(\\frac{\\partial p}{\\partial V}\\right) $$\n其中 $V$ 是体积。对于等熵过程，这变为：\n$$ K_s = -V \\left(\\frac{\\partial p}{\\partial V}\\right)_s $$\n密度 $\\rho$ 是单位体积 $V$ 的质量 $m$，所以 $\\rho = m/V$。对于固定的质量，$V = m/\\rho$，其微分关系为 $dV = -m/\\rho^2 \\, d\\rho$。将此代入导数的链式法则：\n$$ \\left(\\frac{\\partial p}{\\partial V}\\right)_s = \\frac{(\\partial p/\\partial \\rho)_s}{(\\partial V/\\partial \\rho)_s} = \\frac{(\\partial p/\\partial \\rho)_s}{-m/\\rho^2} $$\n将此代入 $K_s$ 的定义：\n$$ K_s = - \\left(\\frac{m}{\\rho}\\right) \\left[ \\frac{(\\partial p/\\partial \\rho)_s}{-m/\\rho^2} \\right] = \\rho \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s $$\n因为我们定义了 $c^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$，我们有：\n$$ K_s = \\rho c^2 $$\n求解声速 $c$ 得到所需的表达式：\n$$ c = \\sqrt{\\frac{K_s}{\\rho}} $$\n\n第二部分：对水的数值计算\n\n给定水在 $T = 25\\,\\mathrm{^\\circ C}$ 和 $p = 0.1\\,\\mathrm{MPa}$ 下的数值：\n- 等熵体积模量：$K_s = 2.20 \\times 10^{9}\\,\\mathrm{Pa}$\n- 质量密度：$\\rho = 997\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n\n我们将这些值代入推导出的 $c$ 的表达式中：\n$$ c = \\sqrt{\\frac{2.20 \\times 10^9\\,\\mathrm{Pa}}{997\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}}} $$\n$$ c = \\sqrt{2206619.86...\\,\\mathrm{m^2}\\,\\mathrm{s}^{-2}} $$\n$$ c \\approx 1485.4695... \\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n按要求将结果四舍五入到四位有效数字：\n$$ c \\approx 1485\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n\n第三部分：关于不可压缩流近似的分析性讨论\n\n像水这样的液体在物理上是可压缩的。这一点由有限的等熵体积模量 $K_s$ 值以及由此产生的有限声速 $c$ 所证实。然而，在广泛的工程应用中，液体流动被建模为不可压缩公式，该公式假定密度恒定，从而速度场无散，即 $\\nabla \\cdot \\mathbf{u} = 0$。这个明显矛盾的合理解释在于对质量守恒方程的标度分析。\n\n质量守恒方程的精确形式是：\n$$ \\frac{1}{\\rho}\\frac{D\\rho}{Dt} + \\nabla \\cdot \\mathbf{u} = 0 $$\n其中 $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$ 是物质导数，表示跟随流体质点变化的变化率。不可压缩近似 $\\nabla \\cdot \\mathbf{u} = 0$ 在表示密度分数变化率的项 $\\frac{1}{\\rho}\\frac{D\\rho}{Dt}$ 可以忽略不计时是有效的。\n\n纯物质的密度是两个独立热力学性质的函数，通常是压力 $p$ 和温度 $T$，因此 $\\rho = \\rho(p, T)$。密度的物质导数为：\n$$ \\frac{D\\rho}{Dt} = \\left(\\frac{\\partial \\rho}{\\partial p}\\right)_T \\frac{Dp}{Dt} + \\left(\\frac{\\partial \\rho}{\\partial T}\\right)_p \\frac{DT}{Dt} $$\n我们可以用标准的材料响应函数来表示这些偏导数：等温压缩率 $\\beta_T = \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial p}\\right)_T$ 和体积热膨胀系数 $\\alpha = -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_p$。对于等熵过程，相关的性质是等熵压缩率 $\\beta_s = \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial p}\\right)_s$。对于液体，$\\beta_s$ 和 $\\beta_T$ 的值非常接近。为与问题的第一部分保持一致，使用 $\\beta_s$，则密度变化主要由压力和熵的变化驱动。速度散度的完整表达式为：\n$$ \\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho}\\frac{D\\rho}{Dt} = -\\beta_s \\frac{Dp}{Dt} - \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial s}\\right)_p \\frac{Ds}{Dt} $$\n让我们分析每一项的贡献：\n\n1.  **压力引起的（声学）压缩**：项 $-\\beta_s \\frac{Dp}{Dt}$ 量化了由于压力变化引起的密度变化。在特征速度为 $U$、长度尺度为 $L$ 的流动中，由惯性（动压）引起的压力变化尺度为 $\\Delta p \\sim \\rho U^2$。压力的物质导数尺度为 $\\frac{Dp}{Dt} \\sim \\frac{U \\Delta p}{L} \\sim \\frac{\\rho U^3}{L}$。由该效应引起的速度散度量级为 $|\\nabla \\cdot \\mathbf{u}|_{p} \\sim \\beta_s \\frac{\\rho U^3}{L}$。我们已经证明 $\\beta_s = 1/K_s = 1/(\\rho c^2)$。因此：\n    $$ |\\nabla \\cdot \\mathbf{u}|_{p} \\sim \\frac{1}{\\rho c^2} \\frac{\\rho U^3}{L} = \\frac{U^3}{c^2 L} $$\n    要使该效应可忽略，其对速度散度的贡献必须远小于特征速度梯度 $U/L$。其比率为：\n    $$ \\frac{|\\nabla \\cdot \\mathbf{u}|_{p}}{U/L} \\sim \\frac{U^3/(c^2 L)}{U/L} = \\frac{U^2}{c^2} = M^2 $$\n    其中 $M = U/c$ 是马赫数。对于液体，声速 $c$ 非常高（例如，水的声速约为 $c \\approx 1485\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$）。对于典型的工程流动，例如速度 $U \\ll 30\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，马赫数非常小 ($M \\ll 0.02$)。因此，马赫数的平方极小 ($M^2 \\ll 0.0004$)，这意味着由动压变化引起的密度变化可以忽略不计。\n\n2.  **温度引起的（热）膨胀**：散度方程中的第二项与熵的变化有关，或者在 $(p, T)$ 坐标系中与温度的变化有关。项 $-\\alpha \\frac{DT}{Dt}$ 代表由于加热、冷却或粘性耗散引起的密度变化。不可压缩性假设要求 $|\\alpha \\frac{DT}{Dt}|$ 远小于特征速度梯度 $U/L$。这等同于说由热效应引起的总密度变化（其尺度为 $\\alpha \\Delta T$）必须很小，即 $|\\alpha \\Delta T| \\ll 1$。对于水，在 $T = 20\\,\\mathrm{^\\circ C}$ 时 $\\alpha \\approx 2.1 \\times 10^{-4}\\,\\mathrm{K}^{-1}$。对于温差为 $\\Delta T = 10\\,\\mathrm{K}$ 的流动，密度变化约为 $0.21\\%$。虽然很小，但在浮力驱动流（自然对流）中可能很重要，因为这些微小的密度差异驱动了整个流动。在这种情况下，通常采用 Boussinesq 近似，该近似在除重力体积力项外的所有项中都将密度视为常数。\n\n总之，液体被视为不可压缩，不是因为它在物理上如此，而是因为在许多工程流动中遇到的压力和温度变化不足以引起显著的密度变化。主要条件是马赫数非常低 ($M \\ll 1$)，这对于液体来说几乎总是满足的，因为它们的声速很高。次要条件是温度变化适中，使得热膨胀效应也可以忽略。",
            "answer": "$$\\boxed{1485}$$"
        },
        {
            "introduction": "在基本概念的基础上，本练习将探讨热工领域一个常见的场景：存在显著加热的流动，此时标准的不可压缩假设 ($\\nabla \\cdot \\mathbf{u} = 0$) 已不再适用。我们将研究热膨胀如何引起速度散度，这是一个纯粹的不可压缩求解器会忽略的关键效应。在这个编程实践中 ()，您将实现一个低马赫数可压缩模型，以正确捕捉这些热膨胀效应并量化由此产生的误差，从而凸显在热驱动流动问题中采用中间模型的必要性。",
            "id": "3940195",
            "problem": "考虑一种一维、稳态、充分发展的理想气体在亚音速低马赫数下的受热通道流。该通道具有恒定的横截面积和恒定的周长。热力学压力在空间上是均匀的。沿整个湿润周界施加均匀的壁面热通量。本文将从概念上比较两种数值公式：一种是强制速度散度为零的不可压缩公式，另一种是通过状态方程耦合允许热致膨胀的低马赫数可压缩公式。您的任务是，通过将速度散度和温度-散度耦合与一致的低马赫数可压缩求解器的结果进行比较，从第一性原理出发，量化在名义马赫数 $M=0.15$ 下使用不可压缩求解器所产生的误差。\n\n您必须从基本守恒定律和理想气体状态方程出发，推导出所需的关系式，不得引用任何预先推导的简化公式。具体而言：\n\n- 从质量守恒、能量守恒和理想气体状态关系式开始。\n- 使用合理的低马赫数假设，以在科学上仍然合理的方式简化控制方程。\n- 在稳态、均匀壁面热通量条件下，推导出沿通道中心线的空间温度场表达式。\n- 推导由热膨胀引起的一维速度散度，并确定在内能公式中该散度如何与温度方程耦合。\n- 为不可压缩公式定义一个定量误差度量：\n  1. 绝对散度误差，定义为可压缩模型的速度散度大小减去不可压缩模型的散度（其恒为零），单位为 $\\mathrm{s}^{-1}$。\n  2. 一个无量纲温度耦合系数 $C_T$，用于衡量可压缩功项相对于主导的对流焓输运的强度。根据定义，当轴向温度梯度为零时，设 $C_T=0$。\n\n在一个完整的、可运行的程序中，以算法形式实现您的推导。使用以下科学上一致的常数、几何形状和测试组。测试组中的所有数值均已明确给出；必须遵守指定的单位。\n\n常数和气体性质：\n- 理想气体常数 $R = 287\\,\\mathrm{J/(kg\\cdot K)}$。\n- 比热比 $\\gamma = 1.4$。\n- 定压比热 $c_p = \\dfrac{\\gamma R}{\\gamma - 1}\\,\\mathrm{J/(kg\\cdot K)}$。\n- 热力学压力 $p_0 = 101325\\,\\mathrm{Pa}$。\n- 入口静温 $T_0 = 300\\,\\mathrm{K}$。\n- 名义入口马赫数 $M = 0.15$。\n- 声速 $a_0 = \\sqrt{\\gamma R T_0}\\,\\mathrm{m/s}$。\n- 入口速度 $U_0 = M a_0\\,\\mathrm{m/s}$。\n- 入口密度 $\\rho_0 = \\dfrac{p_0}{R T_0}\\,\\mathrm{kg/m^3}$。\n\n几何参数：\n- 横截面积 $A = 0.005\\,\\mathrm{m^2}$。\n- 湿润周长 $P = 0.3\\,\\mathrm{m}$。\n- 通道长度 $L = 5.0\\,\\mathrm{m}$。\n\n包含均匀壁面热通量和轴向位置的测试组：\n- 情况1（常规路径）：壁面热通量 $q'' = 1000\\,\\mathrm{W/m^2}$，轴向位置 $x = 3.0\\,\\mathrm{m}$。\n- 情况2（边界，无加热）：壁面热通量 $q'' = 0\\,\\mathrm{W/m^2}$，轴向位置 $x = 3.0\\,\\mathrm{m}$。\n- 情况3（边缘情况，强加热）：壁面热通量 $q'' = 10000\\,\\mathrm{W/m^2}$，轴向位置 $x = 5.0\\,\\mathrm{m}$。\n\n对于每种情况，计算：\n- 绝对散度误差，单位为 $\\mathrm{s}^{-1}$，如上文所定义。\n- 无量纲温度耦合系数 $C_T$，并约定当轴向温度梯度为零时 $C_T = 0$。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个测试用例结果本身是一个形式为 $[\\text{散度误差}, \\text{耦合系数}]$ 的双元素列表。例如：$[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$。\n- 将单位为 $\\mathrm{s}^{-1}$ 的散度误差表示为浮点数，将耦合系数 $C_T$ 表示为不带百分号的浮点数。",
            "solution": "分析首先为理想气体的受热通道流建立一个一维、稳态、低马赫数模型。在这些假设下，基本控制方程——质量守恒、能量守恒和理想气体状态方程——被简化，以推导所需的物理量。\n\n首先，我们规范化控制关系式。对于恒定横截面积 $A$ 通道中的稳态一维流动，质量守恒方程为 $\\dfrac{d}{dx}(\\rho u A) = 0$。由于 $A$ 是常数，这意味着质量通量 $\\rho(x) u(x)$ 沿通道是恒定的。这个恒定的质量通量等于其在入口（$x=0$）处的值：\n$$ \\rho(x) u(x) = \\rho_0 U_0 = \\text{const.} $$\n理想气体定律 $p = \\rho R T$ 提供了压力 $p$、密度 $\\rho$ 和温度 $T$ 之间的关系。低马赫数公式的一个关键假设是，热力学压力在空间上是均匀的，并等于参考压力，即 $p(x) = p_0$。这使我们能够将局部密度表示为局部温度的函数：\n$$ \\rho(x) = \\dfrac{p_0}{R T(x)} $$\n通过结合质量守恒和状态方程，我们将局部速度 $u(x)$ 与局部温度 $T(x)$ 联系起来。\n$$ \\dfrac{p_0}{R T(x)} u(x) = \\rho_0 U_0 $$\n使用入口条件 $\\rho_0 = \\frac{p_0}{R T_0}$，我们得到：\n$$ \\dfrac{p_0}{R T(x)} u(x) = \\dfrac{p_0}{R T_0} U_0 \\implies u(x) = U_0 \\dfrac{T(x)}{T_0} $$\n该方程表明，当流体被加热且温度升高时，其速度会增加。\n\n接下来，我们通过应用热力学第一定律（能量守恒）来推导温度场。对于长度为 $dx$ 的稳态流控制体，对流焓通量的变化必须与从壁面添加的热量相平衡。总质量流率为 $\\dot{m} = \\rho_0 U_0 A$，单位长度上增加的热量为 $q'' P$。能量平衡可写为：\n$$ \\dfrac{d}{dx}(\\dot{m} h) = q'' P $$\n其中 $h = c_p T$ 是比焓。在低马赫数流动中，一个标准的简化是忽略能量平衡中的动能项，因为其贡献为 $O(M^2)$ 量级，与焓相比很小。因此，我们有：\n$$ \\dot{m} c_p \\dfrac{dT}{dx} = q'' P $$\n代入 $\\dot{m} = \\rho_0 U_0 A$，我们求解轴向温度梯度：\n$$ \\dfrac{dT}{dx} = \\dfrac{q'' P}{\\rho_0 U_0 A c_p} $$\n由于右侧所有项均为常数，因此温度梯度沿通道是均匀的。通过从入口条件 $T(x=0) = T_0$ 对此表达式进行积分，我们得到线性温度分布：\n$$ T(x) = T_0 + \\left( \\dfrac{q'' P}{\\rho_0 U_0 A c_p} \\right) x $$\n\n在确定了温度场和速度场之后，我们可以计算速度散度，这是可压缩性效应的主要指标。对于速度矢量为 $\\mathbf{u} = u(x) \\mathbf{i}$ 的一维流动，其散度为 $\\nabla \\cdot \\mathbf{u} = \\dfrac{du}{dx}$。使用先前推导的关系式 $u(x) = U_0 \\frac{T(x)}{T_0}$，我们对 $x$ 求导：\n$$ \\nabla \\cdot \\mathbf{u} = \\dfrac{du}{dx} = \\dfrac{U_0}{T_0} \\dfrac{dT}{dx} $$\n代入恒定温度梯度的表达式，我们得到低马赫数可压缩模型的散度：\n$$ \\nabla \\cdot \\mathbf{u} = \\dfrac{U_0}{T_0} \\left( \\dfrac{q'' P}{\\rho_0 U_0 A c_p} \\right) = \\dfrac{q'' P}{\\rho_0 A c_p T_0} $$\n这种由热膨胀驱动的散度，在均匀热通量下沿通道是恒定的。相比之下，不可压缩公式严格强制条件 $\\nabla \\cdot \\mathbf{u}_{\\text{inc}} = 0$。绝对散度误差定义为可压缩模型和不可压缩模型之间差异的大小：\n$$ \\text{Error}_{\\nabla \\cdot \\mathbf{u}} = |\\nabla \\cdot \\mathbf{u}_{\\text{comp}}| - |\\nabla \\cdot \\mathbf{u}_{\\text{inc}}| = \\left| \\dfrac{q'' P}{\\rho_0 A c_p T_0} \\right| - 0 = \\dfrac{|q''| P}{\\rho_0 A c_p T_0} $$\n\n最后，我们推导无量纲温度耦合系数 $C_T$。该系数用于量化可压缩功项相对于主导的对流焓输运的强度。当用内能 $e=c_vT$ 来表述时，稳态能量方程为：\n$$ \\rho u \\dfrac{de}{dx} = \\text{source} - p (\\nabla \\cdot \\mathbf{u}) $$\n在这里，来自壁面加热的源项是 $\\frac{q''P}{A}$，而 $p (\\nabla \\cdot \\mathbf{u})$ 项是可压缩功项（压力-膨胀项）。从基于焓的能量方程 $\\rho u \\frac{dh}{dx} = \\text{source}$ 中可以发现，主导的对流焓输运项是 $\\rho u \\frac{dh}{dx}$，其大小等于 $\\frac{q''P}{A}$。系数 $C_T$ 是这两个项的量值之比：\n$$ C_T = \\left| \\dfrac{p_0 (\\nabla \\cdot \\mathbf{u})}{\\rho u \\frac{dh}{dx}} \\right| = \\left| \\dfrac{p_0 \\left( \\frac{q'' P}{\\rho_0 A c_p T_0} \\right)}{\\frac{q'' P}{A}} \\right| $$\n该定义在 $q'' \\ne 0$ 时有效。根据问题陈述，如果 $q'' = 0$，则 $C_T=0$。对于 $q'' \\ne 0$，该表达式可简化为：\n$$ C_T = \\left| \\dfrac{p_0}{\\rho_0 c_p T_0} \\right| $$\n使用理想气体定律 $p_0 = \\rho_0 R T_0$，上式变为：\n$$ C_T = \\dfrac{\\rho_0 R T_0}{\\rho_0 c_p T_0} = \\dfrac{R}{c_p} $$\n利用比热之间的关系式 $R = c_p - c_v$ 和比热比的定义 $\\gamma = c_p/c_v$，可以进一步简化：\n$$ C_T = \\dfrac{c_p - c_v}{c_p} = 1 - \\dfrac{c_v}{c_p} = 1 - \\dfrac{1}{\\gamma} = \\dfrac{\\gamma-1}{\\gamma} $$\n此结果表明，对于任何非零加热情况，$C_T$ 是一个仅由理想气体的热力学性质决定的常数。\n\n总而言之，每个测试用例的算法步骤如下：\n1.  计算派生常数：$c_p = \\frac{\\gamma R}{\\gamma - 1}$ 和 $\\rho_0 = \\frac{p_0}{R T_0}$。\n2.  计算绝对散度误差：$\\text{Error}_{\\nabla \\cdot \\mathbf{u}} = \\frac{|q''| P}{\\rho_0 A c_p T_0}$。\n3.  计算耦合系数：如果 $q''=0$，则 $C_T=0$。否则，$C_T = \\frac{\\gamma-1}{\\gamma}$。\n计算这两个特定指标不需要轴向位置 $x$，因为它们在整个通道中是恒定的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the heated channel flow problem by deriving and calculating\n    the divergence error and temperature-coupling coefficient for different\n    heating scenarios.\n    \"\"\"\n\n    # Constants and gas properties\n    R = 287.0      # J/(kg*K)\n    gamma = 1.4\n    p0 = 101325.0  # Pa\n    T0 = 300.0     # K\n    M = 0.15\n\n    # Geometry\n    A = 0.005      # m^2\n    P = 0.3        # m\n\n    # Test suite: (wall heat flux q'' [W/m^2], axial position x [m])\n    # The axial position 'x' is provided for problem completeness but is not\n    # needed for the calculation of divergence or C_T, which are uniform.\n    test_cases = [\n        (1000.0, 3.0),\n        (0.0, 3.0),\n        (10000.0, 5.0),\n    ]\n\n    # Derived constants\n    cp = (gamma * R) / (gamma - 1.0)\n    rho0 = p0 / (R * T0)\n\n    results = []\n    for q_double_prime, x_pos in test_cases:\n        # 1. Absolute divergence error\n        # Formula: |q''| * P / (rho0 * A * cp * T0)\n        # The incompressible divergence is 0 by definition.\n        # So the error is simply the magnitude of the compressible divergence.\n        divergence_error = (abs(q_double_prime) * P) / (rho0 * A * cp * T0)\n\n        # 2. Dimensionless temperature-coupling coefficient C_T\n        # As derived, C_T = (gamma - 1) / gamma for non-zero heating.\n        # By problem definition, C_T = 0 if a temperature gradient is zero (q''=0).\n        if q_double_prime == 0.0:\n            coupling_coefficient = 0.0\n        else:\n            coupling_coefficient = (gamma - 1.0) / gamma\n\n        results.append([divergence_error, coupling_coefficient])\n\n    # Format the final output string to match the specification: [[a1,b1],[a2,b2],...]\n    # without any spaces.\n    results_str_parts = []\n    for res_pair in results:\n        results_str_parts.append(f\"[{res_pair[0]},{res_pair[1]}]\")\n    \n    final_output = f\"[{','.join(results_str_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "数值公式的选择不仅取决于物理准确性，还受到计算效率的驱动。最后一个实践将通过分析可压缩与不可压缩求解器的稳定性约束及其性能，直接探讨选择不同求解器所带来的实际影响。通过将 Courant-Friedrichs-Lewy (CFL) 条件应用于一个加热射流的仿真场景 ()，您将计算每种公式下的最大稳定时间步长，并量化不可压缩求解器所允许的更大时间步长与其通常更高的单步计算成本之间的权衡。该分析将为您在计算热工领域中指导求解器选择的实际效率考量提供关键的洞察。",
            "id": "3940215",
            "problem": "考虑一个三维空间中的加热射流，其耦合的动量和能量方程的可压缩和不可压缩公式采用显式时间积分。该射流在间距为 $\\Delta x$、$\\Delta y$、$\\Delta z$ 的均匀笛卡尔网格上进行离散化。射流流体为理想气体，其比热比 $\\gamma$、特定气体常数 $R$ 以及热扩散系数 $\\alpha$ 均为常数。设平均速度分量为 $u$、$v$、$w$，绝对温度为 $T$。声速定义为 $a = \\sqrt{\\gamma R T}$。假设一个显式格式，其稳定性由双曲（平流和声学）Courant 约束和抛物（扩散）Fourier 约束控制。为双曲项定义一个用户选择的 Courant 数 $C_{\\mathrm{CFL}}$，并使用标准的显式扩散稳定性界限。\n\n从守恒定律及其特征速度出发，为可压缩求解器构建最大稳定时间步长，该时间步长为双曲界限和扩散界限的最小值。对于双曲界限，使用各方向平流速度之和以及多维声学贡献：\n$$\nS_{\\mathrm{conv}} = \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}, \\quad\nS_{\\mathrm{acoust}} = a \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}},\n$$\n以及\n$$\n\\Delta t_{\\mathrm{hyper,comp}} = \\frac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}} + S_{\\mathrm{acoust}}}.\n$$\n对于显式扩散约束，使用二阶中心离散化的多维稳定性界限：\n$$\n\\Delta t_{\\mathrm{diff}} = \\frac{1}{2 \\alpha \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\\right)}.\n$$\n因此，可压缩求解器的时间步长为\n$$\n\\Delta t_{\\mathrm{comp}} = \\min\\left(\\Delta t_{\\mathrm{hyper,comp}}, \\Delta t_{\\mathrm{diff}}\\right).\n$$\n\n对于不可压缩求解器，假设压力投影消除了声波；因此，双曲界限不包括声学项。使用\n$$\n\\Delta t_{\\mathrm{hyper,inc}} =\n\\begin{cases}\n\\dfrac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}}},  \\text{if } S_{\\mathrm{conv}} > 0, \\\\\n+\\infty,  \\text{if } S_{\\mathrm{conv}} = 0,\n\\end{cases}\n$$\n以及\n$$\n\\Delta t_{\\mathrm{inc}} = \\min\\left(\\Delta t_{\\mathrm{hyper,inc}}, \\Delta t_{\\mathrm{diff}}\\right).\n$$\n\n为量化效率权衡，定义可压缩和不可压缩求解器每个时间步的计算成本（单位：秒）分别为 $c_{\\mathrm{comp}}$ 和 $c_{\\mathrm{inc}}$。将每个求解器单位计算时间内推进的物理时间（吞吐量）定义为\n$$\n\\Theta_{\\mathrm{comp}} = \\frac{\\Delta t_{\\mathrm{comp}}}{c_{\\mathrm{comp}}}, \\quad\n\\Theta_{\\mathrm{inc}} = \\frac{\\Delta t_{\\mathrm{inc}}}{c_{\\mathrm{inc}}},\n$$\n并定义一个效率比\n$$\n\\eta = \\frac{\\Theta_{\\mathrm{inc}}}{\\Theta_{\\mathrm{comp}}},\n$$\n该比值为无量纲。\n\n实现一个程序，针对以下测试套件，为每个案例计算 $\\Delta t_{\\mathrm{comp}}$ 和 $\\Delta t_{\\mathrm{inc}}$（单位：秒）以及 $\\eta$（无量纲浮点数）。所有案例均使用 $C_{\\mathrm{CFL}} = 0.5$。所有输入必须使用下述单位进行解释，所有时间步长必须以秒表示。角度单位不适用。不使用百分比；所有比率均为纯小数。\n\n测试套件（每个元组列出 $(\\Delta x,\\Delta y,\\Delta z)$ 单位米，$(u,v,w)$ 单位 $\\mathrm{m/s}$，$T$ 单位 $\\mathrm{K}$，$\\gamma$ 无量纲，$R$ 单位 $\\mathrm{J/(kg\\cdot K)}$，$\\alpha$ 单位 $\\mathrm{m^2/s}$，$c_{\\mathrm{comp}}$ 单位秒，$c_{\\mathrm{inc}}$ 单位秒）：\n- 案例 $1$（典型亚音速、均匀网格、环境射流）：$(\\Delta x,\\Delta y,\\Delta z) = (1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3})$，$(u,v,w) = (80,\\,0,\\,0)$，$T = 300$，$\\gamma = 1.4$，$R = 287$，$\\alpha = 2.1\\times 10^{-5}$，$c_{\\mathrm{comp}} = 6.0\\times 10^{-3}$，$c_{\\mathrm{inc}} = 1.2\\times 10^{-2}$。\n- 案例 $2$（加热射流、更细网格）：$(\\Delta x,\\Delta y,\\Delta z) = (5.0\\times 10^{-4},\\,5.0\\times 10^{-4},\\,5.0\\times 10^{-4})$，$(u,v,w) = (100,\\,10,\\,0)$，$T = 1200$，$\\gamma = 1.4$，$R = 287$，$\\alpha = 8.0\\times 10^{-5}$，$c_{\\mathrm{comp}} = 8.0\\times 10^{-3}$，$c_{\\mathrm{inc}} = 1.5\\times 10^{-2}$。\n- 案例 $3$（各向异性网格、中度加热）：$(\\Delta x,\\Delta y,\\Delta z) = (2.0\\times 10^{-4},\\,1.0\\times 10^{-3},\\,5.0\\times 10^{-4})$，$(u,v,w) = (10,\\,5,\\,0)$，$T = 800$，$\\gamma = 1.4$，$R = 287$，$\\alpha = 5.0\\times 10^{-5}$，$c_{\\mathrm{comp}} = 7.0\\times 10^{-3}$，$c_{\\mathrm{inc}} = 1.3\\times 10^{-2}$。\n- 案例 $4$（极低对流速度、强加热）：$(\\Delta x,\\Delta y,\\Delta z) = (1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3})$，$(u,v,w) = (0.5,\\,0,\\,0)$，$T = 1500$，$\\gamma = 1.4$，$R = 287$，$\\alpha = 1.2\\times 10^{-4}$，$c_{\\mathrm{comp}} = 6.5\\times 10^{-3}$，$c_{\\mathrm{inc}} = 1.4\\times 10^{-2}$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。对于每个案例，按顺序附加 $\\Delta t_{\\mathrm{comp}}$（单位：秒）、$\\Delta t_{\\mathrm{inc}}$（单位：秒）和 $\\eta$（无量纲）。因此，对于 $N=4$ 个案例，输出必须是\n$$\n[\\Delta t_{\\mathrm{comp}}^{(1)},\\Delta t_{\\mathrm{inc}}^{(1)},\\eta^{(1)},\\Delta t_{\\mathrm{comp}}^{(2)},\\Delta t_{\\mathrm{inc}}^{(2)},\\eta^{(2)},\\Delta t_{\\mathrm{comp}}^{(3)},\\Delta t_{\\mathrm{inc}}^{(3)},\\eta^{(3)},\\Delta t_{\\mathrm{comp}}^{(4)},\\Delta t_{\\mathrm{inc}}^{(4)},\\eta^{(4)}].\n$$\n所有返回的时间步长必须以秒为单位，所有比率必须是无量纲的小数。",
            "solution": "该问题已经过验证，被认为是科学上合理、适定且自洽的。所有提供的数据、常数和公式均符合计算流体动力学 (CFD) 和数值分析的既定原则。任务是在指定条件下，计算并比较可压缩和不可压缩数值求解器的最大稳定时间步长和计算效率。\n\n问题的核心在于应用于流体动力学方程的显式时间推进格式的稳定性约束。最大允许时间步长 $\\Delta t$ 受限于所解析的物理现象。这些约束通常分为两类：与波传播（平流和声学）相关的双曲约束，以及与扩散过程（粘性和热传导）相关的抛物约束。\n\n首先，我们定义几个两种求解器公式共有的中间量。多维效应的网格相关项是网格间距平方倒数之和：\n$$\nD_2 = \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\n$$\n特征平流速度之和表示信息因流体流过网格单元而传播的速率，由下式给出：\n$$\nS_{\\mathrm{conv}} = \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}\n$$\n理想气体中的声速 $a$ 为：\n$$\na = \\sqrt{\\gamma R T}\n$$\n\n**可压缩求解器时间步长，$\\Delta t_{\\mathrm{comp}}$**\n\n对于可压缩求解器，时间步长必须足够小，以解析流体运动（平流）和声波传播（声学）。问题定义了一个组合的双曲稳定性极限。多维声波的特征速度由 $S_{\\mathrm{acoust}}$ 给出：\n$$\nS_{\\mathrm{acoust}} = a \\sqrt{D_2} = a \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}\n$$\n一个保守的双曲时间步长约束，通常称为 Courant-Friedrichs-Lewy (CFL) 条件，通过将平流速度和声学速度相加来构建：\n$$\n\\Delta t_{\\mathrm{hyper,comp}} = \\frac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}} + S_{\\mathrm{acoust}}}\n$$\n其中 $C_{\\mathrm{CFL}}$ 是 Courant 数，给定值为 $0.5$。\n\n除了双曲约束外，热扩散的显式处理还施加了一个抛物线型稳定性约束，通常称为 Fourier 条件。对于空间上的标准二阶中心差分格式，该约束为：\n$$\n\\Delta t_{\\mathrm{diff}} = \\frac{1}{2 \\alpha D_2} = \\frac{1}{2 \\alpha \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\\right)}\n$$\n可压缩求解器的总稳定时间步长是这两个约束中最严格的（即最小值）：\n$$\n\\Delta t_{\\mathrm{comp}} = \\min\\left(\\Delta t_{\\mathrm{hyper,comp}}, \\Delta t_{\\mathrm{diff}}\\right)\n$$\n\n**不可压缩求解器时间步长，$\\Delta t_{\\mathrm{inc}}$**\n\n不可压缩求解器的建立基于流体马赫数较低的假设，因此声速可被视为无穷大。像压力投影法这样的数值方法旨在滤除声波。因此，基于声学的时间步长约束被移除。双曲约束仅由平流速度决定：\n$$\n\\Delta t_{\\mathrm{hyper,inc}} =\n\\begin{cases}\n\\dfrac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}}},  \\text{if } S_{\\mathrm{conv}} > 0 \\\\\n+\\infty,  \\text{if } S_{\\mathrm{conv}} = 0\n\\end{cases}\n$$\n扩散稳定性约束 $\\Delta t_{\\mathrm{diff}}$ 保持不变，因为它取决于热力学性质和网格间距，而不是声学模型。因此，不可压缩求解器的总稳定时间步长为：\n$$\n\\Delta t_{\\mathrm{inc}} = \\min\\left(\\Delta t_{\\mathrm{hyper,inc}}, \\Delta t_{\\mathrm{diff}}\\right)\n$$\n\n**效率比较，$\\eta$**\n\n虽然不可压缩求解器通常允许更大的时间步长（$\\Delta t_{\\mathrm{inc}} \\geq \\Delta t_{\\mathrm{comp}}$），但由于需要求解全局的压力泊松方程，每一步的计算成本可能更高（通常 $c_{\\mathrm{inc}} > c_{\\mathrm{comp}}$）。为了比较总体效率，我们评估单位计算时间内推进的物理时间，定义为吞吐量 $\\Theta$。\n$$\n\\Theta_{\\mathrm{comp}} = \\frac{\\Delta t_{\\mathrm{comp}}}{c_{\\mathrm{comp}}}, \\quad \\Theta_{\\mathrm{inc}} = \\frac{\\Delta t_{\\mathrm{inc}}}{c_{\\mathrm{inc}}}\n$$\n效率比 $\\eta$ 比较了不可压缩求解器与可压缩求解器的吞吐量：\n$$\n\\eta = \\frac{\\Theta_{\\mathrm{inc}}}{\\Theta_{\\mathrm{comp}}} = \\frac{\\Delta t_{\\mathrm{inc}} / c_{\\mathrm{inc}}}{\\Delta t_{\\mathrm{comp}} / c_{\\mathrm{comp}}} = \\frac{\\Delta t_{\\mathrm{inc}}}{\\Delta t_{\\mathrm{comp}}} \\frac{c_{\\mathrm{comp}}}{c_{\\mathrm{inc}}}\n$$\n效率比 $\\eta > 1$ 表明，对于给定的流动条件，不可压缩公式的计算效率更高，即在相同的计算量下，模拟在物理时间上推进得更远。\n\n以下程序为问题陈述中提供的每个测试用例实现了这些计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates time steps and efficiency for compressible and incompressible solvers\n    based on provided stability criteria for a series of test cases.\n    \"\"\"\n\n    # Global Courant number for hyperbolic stability constraints\n    C_CFL = 0.5\n\n    # Test Suite (each tuple lists (dx,dy,dz), (u,v,w), T, gamma, R, alpha, c_comp, c_inc)\n    test_cases = [\n        # Case 1 (typical subsonic, uniform grid, ambient jet)\n        ((1.0e-3, 1.0e-3, 1.0e-3), (80.0, 0.0, 0.0), 300.0, 1.4, 287.0, 2.1e-5, 6.0e-3, 1.2e-2),\n        # Case 2 (heated jet, finer grid)\n        ((5.0e-4, 5.0e-4, 5.0e-4), (100.0, 10.0, 0.0), 1200.0, 1.4, 287.0, 8.0e-5, 8.0e-3, 1.5e-2),\n        # Case 3 (anisotropic grid, moderate heating)\n        ((2.0e-4, 1.0e-3, 5.0e-4), (10.0, 5.0, 0.0), 800.0, 1.4, 287.0, 5.0e-5, 7.0e-3, 1.3e-2),\n        # Case 4 (very low convective speed, strong heating)\n        ((1.0e-3, 1.0e-3, 1.0e-3), (0.5, 0.0, 0.0), 1500.0, 1.4, 287.0, 1.2e-4, 6.5e-3, 1.4e-2),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        delta, vel, T, gamma, R, alpha, c_comp, c_inc = case\n        dx, dy, dz = delta\n        u, v, w = vel\n\n        # --- Intermediate Calculations ---\n        \n        # Acoustic speed: a = sqrt(gamma * R * T)\n        a = np.sqrt(gamma * R * T)\n\n        # Sum of inverse squared grid spacings for diffusion and acoustic terms:\n        # D2 = 1/dx^2 + 1/dy^2 + 1/dz^2\n        D2 = (1.0 / dx**2) + (1.0 / dy**2) + (1.0 / dz**2)\n        \n        # Sum of convective speeds: S_conv = |u|/dx + |v|/dy + |w|/dz\n        S_conv = (np.abs(u) / dx) + (np.abs(v) / dy) + (np.abs(w) / dz)\n        \n        # --- Common Diffusive Time Step ---\n        \n        # dt_diff = 1 / (2 * alpha * D2)\n        dt_diff = 1.0 / (2.0 * alpha * D2)\n\n        # --- Compressible Solver Time Step ---\n        \n        # Acoustic speed contribution: S_acoust = a * sqrt(D2)\n        S_acoust = a * np.sqrt(D2)\n        \n        # Hyperbolic time step for compressible solver\n        dt_hyper_comp = C_CFL / (S_conv + S_acoust)\n        \n        # Total compressible time step\n        dt_comp = min(dt_hyper_comp, dt_diff)\n\n        # --- Incompressible Solver Time Step ---\n        \n        # Hyperbolic time step for incompressible solver\n        if S_conv > 0:\n            dt_hyper_inc = C_CFL / S_conv\n        else:\n            dt_hyper_inc = np.inf\n            \n        # Total incompressible time step\n        dt_inc = min(dt_hyper_inc, dt_diff)\n        \n        # --- Efficiency Ratio ---\n        \n        # Throughput ratio: eta = (dt_inc / c_inc) / (dt_comp / c_comp)\n        # Avoid division by zero if dt_comp is zero (though unlikely in these cases)\n        if dt_comp > 0:\n            eta = (dt_inc / c_inc) / (dt_comp / c_comp)\n        else:\n            eta = np.inf # Or handle as a special case if needed.\n\n        # Append results for this case to the list\n        results.extend([dt_comp, dt_inc, eta])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}