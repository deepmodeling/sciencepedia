{
    "hands_on_practices": [
        {
            "introduction": "Understanding the distinction between compressible and incompressible flow begins with the fluid's fundamental physical properties. This first practice challenges you to connect a thermodynamic property, the bulk modulus, to the finite speed at which pressure waves propagate through a medium. By deriving and calculating the acoustic speed, you will build a first-principles justification for why liquids, though physically compressible, can often be modeled as incompressible for a vast range of engineering flows ().",
            "id": "3940188",
            "problem": "A water-filled channel is modeled for Computational Fluid Dynamics (CFD) analysis in computational thermal engineering at temperature $T = 25\\,\\mathrm{^\\circ C}$ and absolute pressure $p = 0.1\\,\\mathrm{MPa}$. For small-amplitude disturbances, the propagation speed of compressive waves (the acoustic speed) is governed by the fluid’s thermodynamic response under an isentropic constraint. Starting from fundamental thermodynamic definitions and the continuum balance of mass, derive an expression for the acoustic speed $c$ of a liquid in terms of the isentropic bulk modulus $K_s$ and the mass density $\\rho$, and then evaluate $c$ for water at the stated conditions using the following measured properties:\n- isentropic bulk modulus $K_s = 2.20 \\times 10^{9}\\,\\mathrm{Pa}$,\n- mass density $\\rho = 997\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$.\nRound your final numerical value to four significant figures and express the speed in $\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n\nWithin your solution, also provide a brief analytical discussion—grounded in first principles—explaining how and why liquids can be physically compressible (finite isentropic bulk modulus) yet exhibit nearly divergence-free velocity fields in many engineering flows. Frame the discussion in terms of the mass conservation equation, material response functions such as the isentropic compressibility $\\beta_s$ and the volumetric thermal expansion coefficient $\\alpha$, and appropriate nondimensional scaling (for example, the Mach number $M$), stating clear conditions under which the incompressible formulation is justified.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, objective, and contains all necessary information for a complete solution. It presents a standard but substantive problem in continuum mechanics and computational thermal engineering.\n\nThe solution is partitioned into three parts as requested: first, the derivation of the acoustic speed; second, the numerical evaluation for water; and third, an analytical discussion on the incompressible flow approximation for liquids.\n\nPart 1: Derivation of the Acoustic Speed $c$\n\nThe propagation of a small-amplitude disturbance (an acoustic wave) in a fluid is governed by the conservation laws of mass and momentum. For a one-dimensional, inviscid, and non-heat-conducting flow, the governing equations in Eulerian form are the continuity equation and the Euler equation.\n\nContinuity Equation:\n$$ \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0 $$\n\nMomentum Equation:\n$$ \\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0 $$\n\nHere, $\\rho$ is the fluid density, $u$ is the fluid velocity in the $x$-direction, $p$ is the pressure, and $t$ is time.\n\nWe analyze the propagation of a small perturbation in a quiescent medium. The fluid is initially at rest with uniform density $\\rho_0$ and pressure $p_0$. The disturbance introduces small changes:\n$$ \\rho(x,t) = \\rho_0 + \\rho' (x,t) $$\n$$ u(x,t) = 0 + u' (x,t) $$\n$$ p(x,t) = p_0 + p' (x,t) $$\nwhere the primed quantities ($\\rho'$, $u'$, $p'$) are small perturbations, i.e., $|\\rho'| \\ll \\rho_0$, $|u'| \\ll c$, and $|p'| \\ll p_0$.\n\nSubstituting these into the continuity equation and expanding:\n$$ \\frac{\\partial (\\rho_0 + \\rho')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial x} = 0 $$\n$$ \\frac{\\partial \\rho'}{\\partial t} + \\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial x} = 0 $$\nNeglecting the second-order term $\\rho' u'$, we obtain the linearized continuity equation:\n$$ \\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0 \\quad (1) $$\n\nSimilarly, substituting into the momentum equation:\n$$ \\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') (u')^2 + p_0 + p')}{\\partial x} = 0 $$\n$$ \\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial t} + \\frac{\\partial (\\rho_0 (u')^2 + \\rho' (u')^2 + p_0 + p')}{\\partial x} = 0 $$\nNeglecting second-order terms ($\\rho' u'$, $(u')^2$, $\\rho'(u')^2$), the equation simplifies to:\n$$ \\rho_0 \\frac{\\partial u'}{\\partial t} + \\frac{\\partial p'}{\\partial x} = 0 \\quad (2) $$\n\nThe problem states that the process is isentropic. This means the pressure perturbation $p'$ is a function of the density perturbation $\\rho'$ only, at constant entropy $s$. For small perturbations, we can express this relationship using a Taylor expansion around the equilibrium state, keeping only the first-order term:\n$$ p' \\approx \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s \\rho' $$\nThe term $\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$ is the square of the speed of sound, which we define as $c^2$:\n$$ c^2 \\equiv \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s $$\nThus, $p' = c^2 \\rho'$. Substituting this into the linearized momentum equation (2):\n$$ \\rho_0 \\frac{\\partial u'}{\\partial t} + c^2 \\frac{\\partial \\rho'}{\\partial x} = 0 \\quad (3) $$\n\nWe now have a system of two first-order linear partial differential equations, (1) and (3). We can combine them to form a single second-order wave equation. Differentiate (1) with respect to $t$ and (3) with respect to $x$:\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} + \\rho_0 \\frac{\\partial^2 u'}{\\partial t \\partial x} = 0 $$\n$$ \\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} + c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2} = 0 $$\nAssuming the perturbations are sufficiently smooth, the order of differentiation can be interchanged ($\\frac{\\partial^2 u'}{\\partial t \\partial x} = \\frac{\\partial^2 u'}{\\partial x \\partial t}$). We can substitute $\\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} = -c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2}$ from the second equation into the first:\n$$ \\frac{\\partial^2 \\rho'}{\\partial t^2} - c^2 \\frac{\\partial^2 \\rho'}{\\partial x^2} = 0 $$\nThis is the one-dimensional wave equation, which describes disturbances propagating with speed $c$.\n\nNext, we relate $c^2$ to the isentropic bulk modulus, $K_s$. The bulk modulus is defined as the measure of a substance's resistance to uniform compression:\n$$ K = -V \\left(\\frac{\\partial p}{\\partial V}\\right) $$\nwhere $V$ is the volume. For an isentropic process, this becomes:\n$$ K_s = -V \\left(\\frac{\\partial p}{\\partial V}\\right)_s $$\nDensity $\\rho$ is mass $m$ per unit volume $V$, so $\\rho = m/V$. For a fixed mass, $V = m/\\rho$, and the differential relationship is $dV = -m/\\rho^2 \\, d\\rho$. Substituting this into the chain rule for derivatives:\n$$ \\left(\\frac{\\partial p}{\\partial V}\\right)_s = \\frac{(\\partial p/\\partial \\rho)_s}{(\\partial V/\\partial \\rho)_s} = \\frac{(\\partial p/\\partial \\rho)_s}{-m/\\rho^2} $$\nSubstituting this into the definition of $K_s$:\n$$ K_s = - \\left(\\frac{m}{\\rho}\\right) \\left[ \\frac{(\\partial p/\\partial \\rho)_s}{-m/\\rho^2} \\right] = \\rho \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s $$\nSince we defined $c^2 = \\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s$, we have:\n$$ K_s = \\rho c^2 $$\nSolving for the acoustic speed $c$ yields the desired expression:\n$$ c = \\sqrt{\\frac{K_s}{\\rho}} $$\n\nPart 2: Numerical Evaluation for Water\n\nGiven the values for water at $T = 25\\,\\mathrm{^\\circ C}$ and $p = 0.1\\,\\mathrm{MPa}$:\n- Isentropic bulk modulus: $K_s = 2.20 \\times 10^{9}\\,\\mathrm{Pa}$\n- Mass density: $\\rho = 997\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n\nWe substitute these values into the derived expression for $c$:\n$$ c = \\sqrt{\\frac{2.20 \\times 10^9\\,\\mathrm{Pa}}{997\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}}} $$\n$$ c = \\sqrt{2206619.86...\\,\\mathrm{m^2}\\,\\mathrm{s}^{-2}} $$\n$$ c \\approx 1485.4695... \\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\nRounding the result to four significant figures as requested:\n$$ c \\approx 1485\\,\\mathrm{m}\\,\\mathrm{s}^{-1} $$\n\nPart 3: Analytical Discussion on Incompressible Flow Approximation\n\nLiquids, like water, are physically compressible. This is confirmed by the finite value of the isentropic bulk modulus $K_s$ and, consequently, a finite acoustic speed $c$. Yet, in a vast range of engineering applications, liquid flows are modeled using the incompressible formulation, which assumes a constant density and thus a divergence-free velocity field, $\\nabla \\cdot \\mathbf{u} = 0$. The justification for this apparent contradiction lies in a scaling analysis of the mass conservation equation.\n\nThe exact form of the mass conservation equation is:\n$$ \\frac{1}{\\rho}\\frac{D\\rho}{Dt} + \\nabla \\cdot \\mathbf{u} = 0 $$\nwhere $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\mathbf{u} \\cdot \\nabla$ is the material derivative, which represents the rate of change following a fluid particle. The incompressible approximation $\\nabla \\cdot \\mathbf{u} = 0$ is valid if the term $\\frac{1}{\\rho}\\frac{D\\rho}{Dt}$, representing the fractional rate of change of density, is negligible.\n\nThe density of a pure substance is a function of two independent thermodynamic properties, typically pressure $p$ and temperature $T$, so $\\rho = \\rho(p, T)$. The material derivative of density is:\n$$ \\frac{D\\rho}{Dt} = \\left(\\frac{\\partial \\rho}{\\partial p}\\right)_T \\frac{Dp}{Dt} + \\left(\\frac{\\partial \\rho}{\\partial T}\\right)_p \\frac{DT}{Dt} $$\nWe can express the partial derivatives in terms of standard material response functions: the isothermal compressibility, $\\beta_T = \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial p}\\right)_T$, and the volumetric thermal expansion coefficient, $\\alpha = -\\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial T}\\right)_p$. For an isentropic process, the relevant property is the isentropic compressibility, $\\beta_s = \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial p}\\right)_s$. For liquids, $\\beta_s$ and $\\beta_T$ are very close in value. Using $\\beta_s$ for consistency with the first part of the problem, the density change is primarily driven by pressure and entropy changes. The full expression for the velocity divergence is:\n$$ \\nabla \\cdot \\mathbf{u} = -\\frac{1}{\\rho}\\frac{D\\rho}{Dt} = -\\beta_s \\frac{Dp}{Dt} - \\frac{1}{\\rho}\\left(\\frac{\\partial \\rho}{\\partial s}\\right)_p \\frac{Ds}{Dt} $$\nLet's analyze the contribution from each term:\n\n1.  **Pressure-induced (acoustic) compression**: The term $-\\beta_s \\frac{Dp}{Dt}$ quantifies density changes due to pressure variations. In a flow with characteristic velocity $U$ and length scale $L$, pressure changes due to inertia (dynamic pressure) scale as $\\Delta p \\sim \\rho U^2$. The material derivative of pressure scales as $\\frac{Dp}{Dt} \\sim \\frac{U \\Delta p}{L} \\sim \\frac{\\rho U^3}{L}$. The magnitude of the velocity divergence caused by this effect is $|\\nabla \\cdot \\mathbf{u}|_{p} \\sim \\beta_s \\frac{\\rho U^3}{L}$. We have shown that $\\beta_s = 1/K_s = 1/(\\rho c^2)$. Therefore:\n    $$ |\\nabla \\cdot \\mathbf{u}|_{p} \\sim \\frac{1}{\\rho c^2} \\frac{\\rho U^3}{L} = \\frac{U^3}{c^2 L} $$\n    The condition for this effect to be negligible is that its contribution to the velocity divergence is small compared to a characteristic velocity gradient, which scales as $U/L$. The ratio is:\n    $$ \\frac{|\\nabla \\cdot \\mathbf{u}|_{p}}{U/L} \\sim \\frac{U^3/(c^2 L)}{U/L} = \\frac{U^2}{c^2} = M^2 $$\n    where $M = U/c$ is the Mach number. For liquids, the acoustic speed $c$ is very high (e.g., $c \\approx 1485\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ for water). For typical engineering flows with velocities of, say, $U  30\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, the Mach number is very small ($M  0.02$). Consequently, the Mach number squared is exceedingly small ($M^2  0.0004$), meaning that density variations due to dynamic pressure changes are negligible.\n\n2.  **Temperature-induced (thermal) expansion**: The second term in the divergence equation relates to changes in entropy or, in the $(p, T)$ frame, temperature. The term $-\\alpha \\frac{DT}{Dt}$ represents density changes due to heating, cooling, or viscous dissipation. The incompressibility assumption requires $|\\alpha \\frac{DT}{Dt}|$ to be small compared to characteristic velocity gradients $U/L$. This is equivalent to stating that the total density change from thermal effects, which scales with $\\alpha \\Delta T$, must be small, i.e., $|\\alpha \\Delta T| \\ll 1$. For water, $\\alpha \\approx 2.1 \\times 10^{-4}\\,\\mathrm{K}^{-1}$ at $T = 20\\,\\mathrm{^\\circ C}$. For a flow with a temperature change of $\\Delta T = 10\\,\\mathrm{K}$, the density change is on the order of $0.21\\%$. While small, this can be significant in buoyancy-driven flows (natural convection), where these small density differences drive the entire flow. In such cases, the Boussinesq approximation is often employed, which treats density as constant in all terms except for the gravitational body force.\n\nIn summary, a liquid is treated as incompressible not because it is physically so, but because the pressure and temperature changes encountered in many engineering flows are insufficient to cause significant density variations. The primary condition is a very low Mach number ($M \\ll 1$), which is almost always satisfied for liquids due to their high acoustic speed. A secondary condition is that temperature variations are moderate, such that thermal expansion effects are also negligible.",
            "answer": "$$\\boxed{1485}$$"
        },
        {
            "introduction": "While the Mach number provides a primary criterion for incompressibility, thermal effects can introduce significant density changes even in low-speed flows. This exercise explores a classic thermal engineering scenario—a heated channel—to quantify the error introduced by a strict incompressible assumption (). You will derive the velocity divergence caused by thermal expansion and contrast the incompressible model against a more accurate low Mach number compressible formulation, highlighting a crucial subtlety in thermal-fluid modeling.",
            "id": "3940195",
            "problem": "Consider a one-dimensional, steady, fully developed heated channel flow of an ideal gas at subsonic low Mach number. The channel has constant cross-sectional area and constant perimeter. The thermodynamic pressure is spatially uniform. A uniform wall heat flux is applied along the entire wetted perimeter. Two numerical formulations are conceptually compared: an incompressible formulation that enforces zero velocity divergence and a low Mach number compressible formulation that allows thermally induced dilatation via an equation of state coupling. Your task is to quantify, from first principles, the error incurred by using an incompressible solver at a nominal Mach number $M=0.15$ by comparing the velocity divergence and temperature-to-divergence coupling against those of a consistent low Mach compressible solver.\n\nYou must derive the necessary relations starting from fundamental conservation laws and the ideal gas equation of state, without invoking any pre-derived shortcut formulas. Specifically:\n\n- Begin from mass conservation, energy conservation, and the ideal gas state relation.\n- Use rational low Mach number assumptions to simplify the governing equations in a way that remains scientifically sound.\n- Derive an expression for the spatial temperature field along the channel centerline under steady, uniform wall heat flux.\n- Derive the one-dimensional velocity divergence resulting from thermal expansion and identify how this divergence couples into the temperature equation in the internal energy formulation.\n- Define a quantitative error metric for the incompressible formulation:\n  1. The absolute divergence error, defined as the magnitude of the compressible-model velocity divergence minus the incompressible-model divergence (which is identically zero), expressed in $\\mathrm{s}^{-1}$.\n  2. A dimensionless temperature-coupling coefficient $C_T$ that measures the strength of the compressible work term relative to the dominant convective enthalpy transport. When the axial temperature gradient vanishes, set $C_T=0$ by definition.\n\nImplement your derivations algorithmically in a complete, runnable program. Use the following scientifically consistent constants, geometry, and test suite. All numerical values in the test suite are given explicitly; units must be adhered to as specified.\n\nConstants and gas properties:\n- Ideal gas constant $R = 287\\,\\mathrm{J/(kg\\cdot K)}$.\n- Ratio of specific heats $\\gamma = 1.4$.\n- Specific heat at constant pressure $c_p = \\dfrac{\\gamma R}{\\gamma - 1}\\,\\mathrm{J/(kg\\cdot K)}$.\n- Thermodynamic pressure $p_0 = 101325\\,\\mathrm{Pa}$.\n- Inlet static temperature $T_0 = 300\\,\\mathrm{K}$.\n- Nominal inlet Mach number $M = 0.15$.\n- Speed of sound $a_0 = \\sqrt{\\gamma R T_0}\\,\\mathrm{m/s}$.\n- Inlet velocity $U_0 = M a_0\\,\\mathrm{m/s}$.\n- Inlet density $\\rho_0 = \\dfrac{p_0}{R T_0}\\,\\mathrm{kg/m^3}$.\n\nGeometry:\n- Cross-sectional area $A = 0.005\\,\\mathrm{m^2}$.\n- Wetted perimeter $P = 0.3\\,\\mathrm{m}$.\n- Channel length $L = 5.0\\,\\mathrm{m}$.\n\nTest suite with uniform wall heat fluxes and axial locations:\n- Case 1 (happy path): wall heat flux $q'' = 1000\\,\\mathrm{W/m^2}$, axial position $x = 3.0\\,\\mathrm{m}$.\n- Case 2 (boundary, no heating): wall heat flux $q'' = 0\\,\\mathrm{W/m^2}$, axial position $x = 3.0\\,\\mathrm{m}$.\n- Case 3 (edge, strong heating): wall heat flux $q'' = 10000\\,\\mathrm{W/m^2}$, axial position $x = 5.0\\,\\mathrm{m}$.\n\nFor each case, compute:\n- The absolute divergence error in $\\mathrm{s}^{-1}$, as defined above.\n- The dimensionless temperature-coupling coefficient $C_T$, with the convention $C_T = 0$ if the axial temperature gradient is zero.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s result is itself a two-element list of the form $[\\text{divergence\\_error}, \\text{coupling\\_coefficient}]$. For example: $[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$.\n- Express the divergence error in $\\mathrm{s}^{-1}$ as a floating-point number, and the coupling coefficient $C_T$ as a floating-point number without a percent sign.",
            "solution": "The analysis begins by establishing a one-dimensional, steady-state, low Mach number model for the heated channel flow of an ideal gas. The fundamental governing equations—mass conservation, energy conservation, and the ideal gas equation of state—are simplified under these assumptions to derive the required quantities.\n\nFirst, we formalize the governing relations. For a steady, one-dimensional flow in a channel of constant cross-sectional area $A$, the mass conservation equation is $\\dfrac{d}{dx}(\\rho u A) = 0$. Since $A$ is constant, this implies that the mass flux, $\\rho(x) u(x)$, is constant along the channel. This constant mass flux is equal to its value at the inlet ($x=0$):\n$$ \\rho(x) u(x) = \\rho_0 U_0 = \\text{const.} $$\nThe ideal gas law, $p = \\rho R T$, provides a relationship between pressure $p$, density $\\rho$, and temperature $T$. A key assumption of the low Mach number formulation is that the thermodynamic pressure is spatially uniform and equal to the reference pressure, $p(x) = p_0$. This allows us to express the local density as a function of the local temperature:\n$$ \\rho(x) = \\dfrac{p_0}{R T(x)} $$\nBy combining the mass conservation and state equations, we relate the local velocity $u(x)$ to the local temperature $T(x)$.\n$$ \\dfrac{p_0}{R T(x)} u(x) = \\rho_0 U_0 $$\nUsing the inlet condition $\\rho_0 = \\frac{p_0}{R T_0}$, we find:\n$$ \\dfrac{p_0}{R T(x)} u(x) = \\dfrac{p_0}{R T_0} U_0 \\implies u(x) = U_0 \\dfrac{T(x)}{T_0} $$\nThis equation shows that the fluid accelerates as it is heated and its temperature increases.\n\nNext, we derive the temperature field by applying the first law of thermodynamics (energy conservation). For a steady-flow control volume of length $dx$, the change in the convected enthalpy flux must balance the heat added from the walls. The total mass flow rate is $\\dot{m} = \\rho_0 U_0 A$, and the heat added per unit length is $q'' P$. The energy balance is written as:\n$$ \\dfrac{d}{dx}(\\dot{m} h) = q'' P $$\nwhere $h = c_p T$ is the specific enthalpy. A standard simplification in low Mach number flows is to neglect the kinetic energy term in the energy balance, as its contribution is of order $O(M^2)$ and is small compared to the enthalpy. Thus, we have:\n$$ \\dot{m} c_p \\dfrac{dT}{dx} = q'' P $$\nSubstituting $\\dot{m} = \\rho_0 U_0 A$, we solve for the axial temperature gradient:\n$$ \\dfrac{dT}{dx} = \\dfrac{q'' P}{\\rho_0 U_0 A c_p} $$\nSince all terms on the right-hand side are constants, the temperature gradient is uniform along the channel. By integrating this expression from the inlet condition $T(x=0) = T_0$, we obtain the linear temperature profile:\n$$ T(x) = T_0 + \\left( \\dfrac{q'' P}{\\rho_0 U_0 A c_p} \\right) x $$\n\nWith the temperature and velocity fields established, we can calculate the velocity divergence, which is a principal indicator of compressibility effects. For a one-dimensional flow where a velocity vector is $\\mathbf{u} = u(x) \\mathbf{i}$, the divergence is $\\nabla \\cdot \\mathbf{u} = \\dfrac{du}{dx}$. Using the previously derived relation $u(x) = U_0 \\frac{T(x)}{T_0}$, we differentiate with respect to $x$:\n$$ \\nabla \\cdot \\mathbf{u} = \\dfrac{du}{dx} = \\dfrac{U_0}{T_0} \\dfrac{dT}{dx} $$\nSubstituting the expression for the constant temperature gradient, we find the divergence for the low Mach number compressible model:\n$$ \\nabla \\cdot \\mathbf{u} = \\dfrac{U_0}{T_0} \\left( \\dfrac{q'' P}{\\rho_0 U_0 A c_p} \\right) = \\dfrac{q'' P}{\\rho_0 A c_p T_0} $$\nThis divergence, driven by thermal expansion, is constant along the channel for a uniform heat flux. An incompressible formulation, by contrast, strictly enforces the condition $\\nabla \\cdot \\mathbf{u}_{\\text{inc}} = 0$. The absolute divergence error is defined as the magnitude of the difference between the compressible and incompressible models:\n$$ \\text{Error}_{\\nabla \\cdot \\mathbf{u}} = |\\nabla \\cdot \\mathbf{u}_{\\text{comp}}| - |\\nabla \\cdot \\mathbf{u}_{\\text{inc}}| = \\left| \\dfrac{q'' P}{\\rho_0 A c_p T_0} \\right| - 0 = \\dfrac{|q''| P}{\\rho_0 A c_p T_0} $$\n\nFinally, we derive the dimensionless temperature-coupling coefficient $C_T$. This coefficient quantifies the strength of the compressible work term relative to the dominant convective enthalpy transport. The steady-state energy equation, when formulated in terms of internal energy $e=c_vT$, is:\n$$ \\rho u \\dfrac{de}{dx} = \\text{source} - p (\\nabla \\cdot \\mathbf{u}) $$\nHere, the source term from wall heating is $\\frac{q''P}{A}$, and the term $p (\\nabla \\cdot \\mathbf{u})$ is the compressible work term (pressure-dilatation). The dominant convective enthalpy transport, as found from the enthalpy-based energy equation $\\rho u \\frac{dh}{dx} = \\text{source}$, is the term $\\rho u \\frac{dh}{dx}$, which equals $\\frac{q''P}{A}$. The coefficient $C_T$ is the ratio of the magnitudes of these two terms:\n$$ C_T = \\left| \\dfrac{p_0 (\\nabla \\cdot \\mathbf{u})}{\\rho u \\frac{dh}{dx}} \\right| = \\left| \\dfrac{p_0 \\left( \\frac{q'' P}{\\rho_0 A c_p T_0} \\right)}{\\frac{q'' P}{A}} \\right| $$\nThis definition is valid for $q'' \\ne 0$. Per the problem statement, if $q'' = 0$, then $C_T=0$. For $q'' \\ne 0$, the expression simplifies to:\n$$ C_T = \\left| \\dfrac{p_0}{\\rho_0 c_p T_0} \\right| $$\nUsing the ideal gas law, $p_0 = \\rho_0 R T_0$, this becomes:\n$$ C_T = \\dfrac{\\rho_0 R T_0}{\\rho_0 c_p T_0} = \\dfrac{R}{c_p} $$\nThe relationship between a specific heats, $R = c_p - c_v$, and the definition of the ratio of specific heats, $\\gamma = c_p/c_v$, allows further simplification:\n$$ C_T = \\dfrac{c_p - c_v}{c_p} = 1 - \\dfrac{c_v}{c_p} = 1 - \\dfrac{1}{\\gamma} = \\dfrac{\\gamma-1}{\\gamma} $$\nThis result demonstrates that for any non-zero heating, $C_T$ is a constant determined solely by the thermodynamic properties of the ideal gas.\n\nTo summarize, the algorithmic steps for each test case are:\n1.  Calculate the derived constants: $c_p = \\frac{\\gamma R}{\\gamma - 1}$ and $\\rho_0 = \\frac{p_0}{R T_0}$.\n2.  Calculate the absolute divergence error: $\\text{Error}_{\\nabla \\cdot \\mathbf{u}} = \\frac{|q''| P}{\\rho_0 A c_p T_0}$.\n3.  Calculate the coupling coefficient: If $q''=0$, $C_T=0$. Otherwise, $C_T = \\frac{\\gamma-1}{\\gamma}$.\nThe axial position $x$ is not required for these two specific metrics, as they are constant throughout the channel.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the heated channel flow problem by deriving and calculating\n    the divergence error and temperature-coupling coefficient for different\n    heating scenarios.\n    \"\"\"\n\n    # Constants and gas properties\n    R = 287.0      # J/(kg*K)\n    gamma = 1.4\n    p0 = 101325.0  # Pa\n    T0 = 300.0     # K\n    M = 0.15\n\n    # Geometry\n    A = 0.005      # m^2\n    P = 0.3        # m\n\n    # Test suite: (wall heat flux q'' [W/m^2], axial position x [m])\n    # The axial position 'x' is provided for problem completeness but is not\n    # needed for the calculation of divergence or C_T, which are uniform.\n    test_cases = [\n        (1000.0, 3.0),\n        (0.0, 3.0),\n        (10000.0, 5.0),\n    ]\n\n    # Derived constants\n    cp = (gamma * R) / (gamma - 1.0)\n    rho0 = p0 / (R * T0)\n\n    results = []\n    for q_double_prime, x_pos in test_cases:\n        # 1. Absolute divergence error\n        # Formula: |q''| * P / (rho0 * A * cp * T0)\n        # The incompressible divergence is 0 by definition.\n        # So the error is simply the magnitude of the compressible divergence.\n        divergence_error = (abs(q_double_prime) * P) / (rho0 * A * cp * T0)\n\n        # 2. Dimensionless temperature-coupling coefficient C_T\n        # As derived, C_T = (gamma - 1) / gamma for non-zero heating.\n        # By problem definition, C_T = 0 if a temperature gradient is zero (q''=0).\n        if q_double_prime == 0.0:\n            coupling_coefficient = 0.0\n        else:\n            coupling_coefficient = (gamma - 1.0) / gamma\n\n        results.append([divergence_error, coupling_coefficient])\n\n    # Format the final output string to match the specification: [[a1,b1],[a2,b2],...]\n    # without any spaces.\n    results_str_parts = []\n    for res_pair in results:\n        results_str_parts.append(f\"[{res_pair[0]},{res_pair[1]}]\")\n    \n    final_output = f\"[{','.join(results_str_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "The choice between a compressible and an incompressible formulation is not just about physical accuracy; it has profound implications for computational cost and efficiency. This final practice delves into the practical trade-offs by analyzing the numerical stability constraints that govern explicit solvers (). You will compare the maximum allowable time steps for each formulation, revealing how the stiff acoustic timescale can make compressible solvers inefficient for low-Mach-number problems, and quantify the resulting impact on overall computational throughput.",
            "id": "3940215",
            "problem": "Consider explicit time integration of the compressible and incompressible formulations of the coupled momentum and energy equations for a heated jet in three spatial dimensions, discretized on a uniform Cartesian grid with spacings $\\Delta x$, $\\Delta y$, $\\Delta z$. The jet fluid is an ideal gas with constant ratio of specific heats $\\gamma$, specific gas constant $R$, and thermal diffusivity $\\alpha$. Let the mean velocity components be $u$, $v$, $w$, and the absolute temperature be $T$. The acoustic speed is defined by $a = \\sqrt{\\gamma R T}$. Assume an explicit scheme whose stability is governed by hyperbolic (advective and acoustic) Courant constraints and parabolic (diffusive) Fourier constraints. Define a user-selected Courant number $C_{\\mathrm{CFL}}$ for the hyperbolic terms and use the canonical explicit diffusion stability bound.\n\nStarting from the conservation laws and their characteristic speeds, formulate the maximum stable time step for the compressible solver as the minimum of a hyperbolic bound and a diffusive bound. For the hyperbolic bound, use the sum over directional advective speeds and the multidimensional acoustic contribution:\n$$\nS_{\\mathrm{conv}} = \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}, \\quad\nS_{\\mathrm{acoust}} = a \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}},\n$$\nand\n$$\n\\Delta t_{\\mathrm{hyper,comp}} = \\frac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}} + S_{\\mathrm{acoust}}}.\n$$\nFor the explicit diffusion constraint, use the multidimensional stability bound for a second-order central discretization:\n$$\n\\Delta t_{\\mathrm{diff}} = \\frac{1}{2 \\alpha \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\\right)}.\n$$\nThus, the compressible solver time step is\n$$\n\\Delta t_{\\mathrm{comp}} = \\min\\left(\\Delta t_{\\mathrm{hyper,comp}}, \\Delta t_{\\mathrm{diff}}\\right).\n$$\n\nFor the incompressible solver, assume the pressure-projection eliminates acoustic waves; therefore, the hyperbolic bound excludes the acoustic term. Use\n$$\n\\Delta t_{\\mathrm{hyper,inc}} =\n\\begin{cases}\n\\dfrac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}}},  \\text{if } S_{\\mathrm{conv}}  0, \\\\\n+\\infty,  \\text{if } S_{\\mathrm{conv}} = 0,\n\\end{cases}\n$$\nand\n$$\n\\Delta t_{\\mathrm{inc}} = \\min\\left(\\Delta t_{\\mathrm{hyper,inc}}, \\Delta t_{\\mathrm{diff}}\\right).\n$$\n\nTo quantify efficiency trade-offs, define per-time-step computational costs in seconds $c_{\\mathrm{comp}}$ and $c_{\\mathrm{inc}}$ for the compressible and incompressible solvers, respectively. Define the physical-time-advanced per unit compute time (throughput) for each solver as\n$$\n\\Theta_{\\mathrm{comp}} = \\frac{\\Delta t_{\\mathrm{comp}}}{c_{\\mathrm{comp}}}, \\quad\n\\Theta_{\\mathrm{inc}} = \\frac{\\Delta t_{\\mathrm{inc}}}{c_{\\mathrm{inc}}},\n$$\nand define an efficiency ratio\n$$\n\\eta = \\frac{\\Theta_{\\mathrm{inc}}}{\\Theta_{\\mathrm{comp}}},\n$$\nwhich is dimensionless.\n\nImplement a program that, for the following test suite, computes $\\Delta t_{\\mathrm{comp}}$ and $\\Delta t_{\\mathrm{inc}}$ in seconds, and $\\eta$ as a dimensionless float, for each case. Use $C_{\\mathrm{CFL}} = 0.5$ for all cases. All inputs must be interpreted using the units specified below, and all time steps must be expressed in seconds. The angle unit is not applicable. Percentages are not used; all ratios are pure decimals.\n\nTest Suite (each tuple lists $(\\Delta x,\\Delta y,\\Delta z)$ in meters, $(u,v,w)$ in $\\mathrm{m/s}$, $T$ in $\\mathrm{K}$, $\\gamma$ unitless, $R$ in $\\mathrm{J/(kg\\cdot K)}$, $\\alpha$ in $\\mathrm{m^2/s}$, $c_{\\mathrm{comp}}$ in seconds, $c_{\\mathrm{inc}}$ in seconds):\n- Case $1$ (typical subsonic, uniform grid, ambient jet): $(\\Delta x,\\Delta y,\\Delta z) = (1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3})$, $(u,v,w) = (80,\\,0,\\,0)$, $T = 300$, $\\gamma = 1.4$, $R = 287$, $\\alpha = 2.1\\times 10^{-5}$, $c_{\\mathrm{comp}} = 6.0\\times 10^{-3}$, $c_{\\mathrm{inc}} = 1.2\\times 10^{-2}$.\n- Case $2$ (heated jet, finer grid): $(\\Delta x,\\Delta y,\\Delta z) = (5.0\\times 10^{-4},\\,5.0\\times 10^{-4},\\,5.0\\times 10^{-4})$, $(u,v,w) = (100,\\,10,\\,0)$, $T = 1200$, $\\gamma = 1.4$, $R = 287$, $\\alpha = 8.0\\times 10^{-5}$, $c_{\\mathrm{comp}} = 8.0\\times 10^{-3}$, $c_{\\mathrm{inc}} = 1.5\\times 10^{-2}$.\n- Case $3$ (anisotropic grid, moderate heating): $(\\Delta x,\\Delta y,\\Delta z) = (2.0\\times 10^{-4},\\,1.0\\times 10^{-3},\\,5.0\\times 10^{-4})$, $(u,v,w) = (10,\\,5,\\,0)$, $T = 800$, $\\gamma = 1.4$, $R = 287$, $\\alpha = 5.0\\times 10^{-5}$, $c_{\\mathrm{comp}} = 7.0\\times 10^{-3}$, $c_{\\mathrm{inc}} = 1.3\\times 10^{-2}$.\n- Case $4$ (very low convective speed, strong heating): $(\\Delta x,\\Delta y,\\Delta z) = (1.0\\times 10^{-3},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-3})$, $(u,v,w) = (0.5,\\,0,\\,0)$, $T = 1500$, $\\gamma = 1.4$, $R = 287$, $\\alpha = 1.2\\times 10^{-4}$, $c_{\\mathrm{comp}} = 6.5\\times 10^{-3}$, $c_{\\mathrm{inc}} = 1.4\\times 10^{-2}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, append $\\Delta t_{\\mathrm{comp}}$ (in seconds), $\\Delta t_{\\mathrm{inc}}$ (in seconds), and $\\eta$ (dimensionless) in that order. Thus, with $N=4$ cases, the output must be\n$$\n[\\Delta t_{\\mathrm{comp}}^{(1)},\\Delta t_{\\mathrm{inc}}^{(1)},\\eta^{(1)},\\Delta t_{\\mathrm{comp}}^{(2)},\\Delta t_{\\mathrm{inc}}^{(2)},\\eta^{(2)},\\Delta t_{\\mathrm{comp}}^{(3)},\\Delta t_{\\mathrm{inc}}^{(3)},\\eta^{(3)},\\Delta t_{\\mathrm{comp}}^{(4)},\\Delta t_{\\mathrm{inc}}^{(4)},\\eta^{(4)}].\n$$\nAll returned time steps must be in seconds and all ratios must be dimensionless decimals.",
            "solution": "The problem has been validated and is deemed scientifically sound, well-posed, and self-contained. All provided data, constants, and formulas are consistent with established principles in computational fluid dynamics (CFD) and numerical analysis. The task is to calculate and compare the maximum stable time steps and computational efficiencies for compressible and incompressible numerical solvers under specified conditions.\n\nThe core of the problem lies in the stability constraints for explicit time-marching schemes applied to fluid dynamics equations. The maximum permissible time step, $\\Delta t$, is limited by the physical phenomena being resolved. The constraints are generally of two types: hyperbolic, related to wave propagation (advection and acoustics), and parabolic, related to diffusion processes (viscosity and thermal conduction).\n\nFirst, we define several intermediate quantities that are common to both solver formulations. The grid-dependent term for multidimensional effects is the sum of the inverse squared grid spacings:\n$$\nD_2 = \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\n$$\nThe sum of characteristic advective speeds, which represents the rate at which information propagates due to fluid flow across grid cells, is given by:\n$$\nS_{\\mathrm{conv}} = \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z}\n$$\nThe speed of sound, $a$, in the ideal gas is:\n$$\na = \\sqrt{\\gamma R T}\n$$\n\n**Compressible Solver Time Step, $\\Delta t_{\\mathrm{comp}}$**\n\nFor a compressible solver, the time step must be small enough to resolve both the fluid motion (advection) and the propagation of sound waves (acoustics). The problem defines a combined hyperbolic stability limit. The characteristic speed of acoustic waves in multiple dimensions is given by $S_{\\mathrm{acoust}}$:\n$$\nS_{\\mathrm{acoust}} = a \\sqrt{D_2} = a \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}\n$$\nA conservative hyperbolic time step constraint, often called the Courant-Friedrichs-Lewy (CFL) condition, is formulated by summing the advective and acoustic speeds:\n$$\n\\Delta t_{\\mathrm{hyper,comp}} = \\frac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}} + S_{\\mathrm{acoust}}}\n$$\nwhere $C_{\\mathrm{CFL}}$ is the Courant number, given as $0.5$.\n\nIn addition to the hyperbolic constraint, the explicit treatment of thermal diffusion imposes a parabolic stability constraint, often called the Fourier condition. For a standard second-order central difference scheme in space, this is:\n$$\n\\Delta t_{\\mathrm{diff}} = \\frac{1}{2 \\alpha D_2} = \\frac{1}{2 \\alpha \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\\right)}\n$$\nThe overall stable time step for the compressible solver is the most restrictive (i.e., the minimum) of these two constraints:\n$$\n\\Delta t_{\\mathrm{comp}} = \\min\\left(\\Delta t_{\\mathrm{hyper,comp}}, \\Delta t_{\\mathrm{diff}}\\right)\n$$\n\n**Incompressible Solver Time Step, $\\Delta t_{\\mathrm{inc}}$**\n\nIncompressible solvers are formulated under the assumption that the flow Mach number is low, and thus the speed of sound can be considered infinite. Numerical methods like pressure-projection schemes are designed to filter out acoustic waves. Consequently, the acoustic-based time step constraint is removed. The hyperbolic constraint is determined solely by the advective speeds:\n$$\n\\Delta t_{\\mathrm{hyper,inc}} =\n\\begin{cases}\n\\dfrac{C_{\\mathrm{CFL}}}{S_{\\mathrm{conv}}},  \\text{if } S_{\\mathrm{conv}}  0 \\\\\n+\\infty,  \\text{if } S_{\\mathrm{conv}} = 0\n\\end{cases}\n$$\nThe diffusive stability constraint, $\\Delta t_{\\mathrm{diff}}$, remains unchanged, as it depends on thermal properties and grid spacing, not on the acoustic model. The total stable time step for the incompressible solver is therefore:\n$$\n\\Delta t_{\\mathrm{inc}} = \\min\\left(\\Delta t_{\\mathrm{hyper,inc}}, \\Delta t_{\\mathrm{diff}}\\right)\n$$\n\n**Efficiency Comparison, $\\eta$**\n\nWhile the incompressible solver often permits a larger time step ($\\Delta t_{\\mathrm{inc}} \\geq \\Delta t_{\\mathrm{comp}}$), each step can be more computationally expensive (typically $c_{\\mathrm{inc}}  c_{\\mathrm{comp}}$) due to the need to solve a global Poisson equation for pressure. To compare overall efficiency, we assess the physical time advanced per unit of computational time, defined as the throughput, $\\Theta$.\n$$\n\\Theta_{\\mathrm{comp}} = \\frac{\\Delta t_{\\mathrm{comp}}}{c_{\\mathrm{comp}}}, \\quad \\Theta_{\\mathrm{inc}} = \\frac{\\Delta t_{\\mathrm{inc}}}{c_{\\mathrm{inc}}}\n$$\nThe efficiency ratio, $\\eta$, compares the throughput of the incompressible solver to that of the compressible solver:\n$$\n\\eta = \\frac{\\Theta_{\\mathrm{inc}}}{\\Theta_{\\mathrm{comp}}} = \\frac{\\Delta t_{\\mathrm{inc}} / c_{\\mathrm{inc}}}{\\Delta t_{\\mathrm{comp}} / c_{\\mathrm{comp}}} = \\frac{\\Delta t_{\\mathrm{inc}}}{\\Delta t_{\\mathrm{comp}}} \\frac{c_{\\mathrm{comp}}}{c_{\\mathrm{inc}}}\n$$\nAn efficiency ratio $\\eta  1$ indicates that the incompressible formulation is more computationally efficient for the given flow conditions, advancing the simulation further in physical time for the same amount of computation.\n\nThe following program implements these calculations for each test case provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates time steps and efficiency for compressible and incompressible solvers\n    based on provided stability criteria for a series of test cases.\n    \"\"\"\n\n    # Global Courant number for hyperbolic stability constraints\n    C_CFL = 0.5\n\n    # Test Suite (each tuple lists (dx,dy,dz), (u,v,w), T, gamma, R, alpha, c_comp, c_inc)\n    test_cases = [\n        # Case 1 (typical subsonic, uniform grid, ambient jet)\n        ((1.0e-3, 1.0e-3, 1.0e-3), (80.0, 0.0, 0.0), 300.0, 1.4, 287.0, 2.1e-5, 6.0e-3, 1.2e-2),\n        # Case 2 (heated jet, finer grid)\n        ((5.0e-4, 5.0e-4, 5.0e-4), (100.0, 10.0, 0.0), 1200.0, 1.4, 287.0, 8.0e-5, 8.0e-3, 1.5e-2),\n        # Case 3 (anisotropic grid, moderate heating)\n        ((2.0e-4, 1.0e-3, 5.0e-4), (10.0, 5.0, 0.0), 800.0, 1.4, 287.0, 5.0e-5, 7.0e-3, 1.3e-2),\n        # Case 4 (very low convective speed, strong heating)\n        ((1.0e-3, 1.0e-3, 1.0e-3), (0.5, 0.0, 0.0), 1500.0, 1.4, 287.0, 1.2e-4, 6.5e-3, 1.4e-2),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        delta, vel, T, gamma, R, alpha, c_comp, c_inc = case\n        dx, dy, dz = delta\n        u, v, w = vel\n\n        # --- Intermediate Calculations ---\n        \n        # Acoustic speed: a = sqrt(gamma * R * T)\n        a = np.sqrt(gamma * R * T)\n\n        # Sum of inverse squared grid spacings for diffusion and acoustic terms:\n        # D2 = 1/dx^2 + 1/dy^2 + 1/dz^2\n        D2 = (1.0 / dx**2) + (1.0 / dy**2) + (1.0 / dz**2)\n        \n        # Sum of convective speeds: S_conv = |u|/dx + |v|/dy + |w|/dz\n        S_conv = (np.abs(u) / dx) + (np.abs(v) / dy) + (np.abs(w) / dz)\n        \n        # --- Common Diffusive Time Step ---\n        \n        # dt_diff = 1 / (2 * alpha * D2)\n        dt_diff = 1.0 / (2.0 * alpha * D2)\n\n        # --- Compressible Solver Time Step ---\n        \n        # Acoustic speed contribution: S_acoust = a * sqrt(D2)\n        S_acoust = a * np.sqrt(D2)\n        \n        # Hyperbolic time step for compressible solver\n        dt_hyper_comp = C_CFL / (S_conv + S_acoust)\n        \n        # Total compressible time step\n        dt_comp = min(dt_hyper_comp, dt_diff)\n\n        # --- Incompressible Solver Time Step ---\n        \n        # Hyperbolic time step for incompressible solver\n        if S_conv  0:\n            dt_hyper_inc = C_CFL / S_conv\n        else:\n            dt_hyper_inc = np.inf\n            \n        # Total incompressible time step\n        dt_inc = min(dt_hyper_inc, dt_diff)\n        \n        # --- Efficiency Ratio ---\n        \n        # Throughput ratio: eta = (dt_inc / c_inc) / (dt_comp / c_comp)\n        # Avoid division by zero if dt_comp is zero (though unlikely in these cases)\n        if dt_comp  0:\n            eta = (dt_inc / c_inc) / (dt_comp / c_comp)\n        else:\n            eta = np.inf # Or handle as a special case if needed.\n\n        # Append results for this case to the list\n        results.extend([dt_comp, dt_inc, eta])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}