{
    "hands_on_practices": [
        {
            "introduction": "Mastering the compressible energy equation begins with its application to fundamental phenomena. This first practice challenges you to derive the classic Rankine-Hugoniot relations for a normal shock wave directly from the integral conservation laws. By algebraically verifying that stagnation enthalpy is conserved across the shock , you will solidify your understanding of how the energy equation governs the state changes in one of the most important features of supersonic flow.",
            "id": "3940536",
            "problem": "Consider a steady, one-dimensional, inviscid, adiabatic normal shock in a calorically perfect gas with ratio of specific heats $\\gamma$. The upstream state is characterized by static pressure $p_{1}$, static temperature $T_{1}$, density $\\rho_{1}$, and flow speed $u_{1}$. The upstream Mach number is $M_{1} \\equiv u_{1}/a_{1}$, where the speed of sound is $a \\equiv \\sqrt{\\gamma R T}$ for an ideal gas with constant gas constant $R$ and constant specific heat at constant pressure $c_{p} \\equiv \\gamma R / (\\gamma - 1)$. Downstream quantities are $p_{2}$, $T_{2}$, $\\rho_{2}$, and $u_{2}$. The shock is stationary and planar, and there is no external shaft work or heat addition to the control volume.\n\nStarting only from the integral conservation laws of mass, momentum, and energy across the shock, the ideal gas equation of state $p=\\rho R T$, the definition of enthalpy for a calorically perfect gas $h=c_{p} T$, and the definition of the Mach number, perform the following:\n\n- Derive closed-form analytic expressions for the dimensionless downstream-to-upstream ratios $p_{2}/p_{1}$ and $T_{2}/T_{1}$ in terms of $M_{1}$ and $\\gamma$.\n- Using the compressible energy equation, form the stagnation enthalpy difference $h_{0,2} - h_{0,1}$, where $h_{0} \\equiv h + u^{2}/2$, and express it entirely in terms of $M_{1}$ and $\\gamma$ by substituting your derived relations, to verify energy conservation.\n\nExpress your final answer as a single row matrix whose entries are, in order, $\\left(p_{2}/p_{1}\\right)$, $\\left(T_{2}/T_{1}\\right)$, and $\\left(h_{0,2} - h_{0,1}\\right)$, all as exact symbolic functions of $M_{1}$ and $\\gamma$. These quantities are dimensionless except $h_{0,2} - h_{0,1}$, which you should express in a form that shows it evaluates identically to zero without needing units. No numerical approximation or rounding is required.",
            "solution": "The user-provided problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **System:** Steady, one-dimensional, inviscid, adiabatic normal shock.\n- **Fluid:** Calorically perfect gas.\n- **Upstream State (1):** Static pressure $p_{1}$, static temperature $T_{1}$, density $\\rho_{1}$, flow speed $u_{1}$, Mach number $M_{1}$.\n- **Downstream State (2):** Static pressure $p_{2}$, static temperature $T_{2}$, density $\\rho_{2}$, flow speed $u_{2}$.\n- **Constants and Definitions:**\n    - Ratio of specific heats: $\\gamma$.\n    - Gas constant: $R$.\n    - Speed of sound: $a \\equiv \\sqrt{\\gamma R T}$.\n    - Mach number: $M_{1} \\equiv u_{1}/a_{1}$.\n    - Ideal gas equation of state: $p=\\rho R T$.\n    - Specific heat at constant pressure: $c_{p} \\equiv \\gamma R / (\\gamma - 1)$.\n    - Enthalpy for a calorically perfect gas: $h=c_{p} T$.\n    - Stagnation enthalpy: $h_{0} \\equiv h + u^{2}/2$.\n- **Constraints:** No external shaft work or heat addition.\n- **Task:**\n    1. Derive expressions for $p_{2}/p_{1}$ and $T_{2}/T_{1}$ in terms of $M_{1}$ and $\\gamma$.\n    2. Verify energy conservation by showing $h_{0,2} - h_{0,1} = 0$ using the derived relations.\n    3. Provide the final answer as a row matrix containing the expressions for $p_{2}/p_{1}$, $T_{2}/T_{1}$, and $h_{0,2} - h_{0,1}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a classic exercise in compressible fluid dynamics, dealing with the fundamental physics of normal shock waves. The governing equations and gas model are standard and scientifically sound.\n- **Well-Posed:** All necessary information, including the fundamental conservation laws and equations of state, are provided to derive the required quantities. The problem is well-defined and has a unique solution.\n- **Objective:** The language is formal, precise, and devoid of any subjective or opinion-based content.\n\n### Step 3: Verdict and Action\nThe problem is scientifically valid, well-posed, and objective. It passes all validation criteria. A solution will be generated.\n\n### Derivation\nWe begin with the one-dimensional integral conservation laws for a control volume across a stationary normal shock:\n\n1.  **Conservation of Mass (Continuity):**\n    $$ \\rho_{1} u_{1} = \\rho_{2} u_{2} $$\n2.  **Conservation of Momentum:**\n    $$ p_{1} + \\rho_{1} u_{1}^{2} = p_{2} + \\rho_{2} u_{2}^{2} $$\n3.  **Conservation of Energy:** For adiabatic flow with no shaft work, stagnation enthalpy is conserved.\n    $$ h_{1} + \\frac{1}{2} u_{1}^{2} = h_{2} + \\frac{1}{2} u_{2}^{2} $$\n    This is equivalent to stating that the change in stagnation enthalpy is zero: $h_{0,2} - h_{0,1} = 0$.\n\nThese three laws must be solved simultaneously along with the equation of state and definitions for a calorically perfect gas:\n-   **Ideal Gas Law:** $p = \\rho R T$\n-   **Enthalpy:** $h = c_{p} T = \\frac{\\gamma R}{\\gamma-1} T = \\frac{\\gamma}{\\gamma-1} \\frac{p}{\\rho}$\n\nLet's combine the conservation laws to form the Rankine-Hugoniot relations. From the energy equation:\n$h_{2} - h_{1} = \\frac{1}{2}(u_{1}^{2} - u_{2}^{2})$.\nFrom continuity, $u_2 = u_1 (\\rho_1 / \\rho_2)$, so $u_{1}^{2} - u_{2}^{2} = u_{1}^{2}(1 - (\\rho_1/\\rho_2)^2) = u_1^2(\\frac{\\rho_2-\\rho_1}{\\rho_2})(\\frac{\\rho_2+\\rho_1}{\\rho_2})$. This is not the most direct path.\n\nLet's reformulate the momentum equation:\n$p_{2} - p_{1} = \\rho_{1} u_{1}^{2} - \\rho_{2} u_{2}^{2}$. Using continuity, $\\rho_2 u_2^2 = (\\rho_1 u_1) u_2$.\n$p_{2} - p_{1} = \\rho_{1} u_{1} u_{1} - (\\rho_1 u_1) u_2 = \\rho_{1} u_{1} (u_1 - u_2)$.\nLet's return to the energy equation: $h_{2} - h_{1} = \\frac{1}{2}(u_1 - u_2)(u_1 + u_2)$.\nDividing these two expressions yields:\n$\\frac{h_2 - h_1}{p_2 - p_1} = \\frac{1}{2} \\frac{(u_1 - u_2)(u_1 + u_2)}{\\rho_1 u_1 (u_1 - u_2)} = \\frac{u_1+u_2}{2\\rho_1 u_1}$.\nUsing $u_2 = u_1 \\rho_1/\\rho_2$:\n$\\frac{u_1+u_2}{2\\rho_1 u_1} = \\frac{u_1(1+\\rho_1/\\rho_2)}{2\\rho_1 u_1} = \\frac{1}{2\\rho_1} (1+\\frac{\\rho_1}{\\rho_2}) = \\frac{1}{2}(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2})$.\nThus we obtain the Rankine-Hugoniot relation connecting enthalpy, pressure, and density:\n$$ h_{2} - h_{1} = \\frac{1}{2}(p_{2} - p_{1}) \\left(\\frac{1}{\\rho_{1}} + \\frac{1}{\\rho_{2}}\\right) $$\nNow, we substitute the enthalpy relation for a calorically perfect gas, $h = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}$:\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{p_{2}}{\\rho_{2}} - \\frac{p_{1}}{\\rho_{1}}\\right) = \\frac{1}{2}(p_{2} - p_{1}) \\left(\\frac{1}{\\rho_{1}} + \\frac{1}{\\rho_{2}}\\right) $$\nLet the pressure ratio be $P \\equiv p_{2}/p_{1}$ and the density ratio be $X \\equiv \\rho_{2}/\\rho_{1}$. Dividing the equation by $p_{1}/\\rho_{1}$:\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{P}{X} - 1\\right) = \\frac{1}{2}(P - 1) \\left(1 + \\frac{1}{X}\\right) $$\n$$ \\frac{\\gamma}{\\gamma-1} \\frac{P-X}{X} = \\frac{1}{2}(P-1) \\frac{X+1}{X} $$\nAssuming a shock exists ($X \\ne 1$), we multiply by $2X$:\n$2\\gamma(P-X) = (\\gamma-1)(P-1)(X+1)$.\n$2\\gamma P - 2\\gamma X = (\\gamma-1)(PX + P - X - 1)$.\nSolving for $X$:\n$2\\gamma P - 2\\gamma X = (\\gamma-1)PX + (\\gamma-1)P - (\\gamma-1)X - (\\gamma-1)$.\n$X [ -2\\gamma - (\\gamma-1)P + (\\gamma-1)] = (\\gamma-1)P - 2\\gamma P - (\\gamma-1)$.\n$X [ -(\\gamma+1) - (\\gamma-1)P ] = -(\\gamma+1)P - (\\gamma-1)$.\n$X [ (\\gamma-1)P + (\\gamma+1) ] = (\\gamma+1)P + (\\gamma-1)$.\n$$ \\frac{\\rho_{2}}{\\rho_{1}} = \\frac{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)} $$\nNext, we relate this to the incoming Mach number, $M_{1}$. From the momentum equation:\n$p_{2} - p_{1} = \\rho_{1} u_{1}^{2} - \\rho_{2} u_{2}^{2} = \\rho_{1} u_{1}^{2} - \\rho_{1} u_{1} u_{2} = \\rho_{1} u_{1}^2 (1 - u_{2}/u_{1})$.\nUsing continuity, $u_{2}/u_{1} = \\rho_{1}/\\rho_{2}$.\n$p_{2} - p_{1} = \\rho_{1} u_{1}^{2} (1 - \\rho_{1}/\\rho_{2})$.\nDivide by $p_{1}$:\n$\\frac{p_{2}}{p_{1}} - 1 = \\frac{\\rho_{1} u_{1}^{2}}{p_{1}} \\left(1 - \\frac{\\rho_{1}}{\\rho_{2}}\\right)$.\nThe definition of the Mach number is $M_{1}^{2} = u_{1}^{2}/a_{1}^{2} = u_{1}^{2}/(\\gamma p_{1}/\\rho_{1}) = \\rho_{1} u_{1}^{2} / (\\gamma p_{1})$. So, $\\rho_{1} u_{1}^{2}/p_{1} = \\gamma M_{1}^{2}$.\n$\\frac{p_{2}}{p_{1}} - 1 = \\gamma M_{1}^{2} \\left(1 - \\frac{\\rho_{1}}{\\rho_{2}}\\right)$.\nLet's substitute $\\rho_1/\\rho_2$ from the relation derived before.\n$\\frac{\\rho_{1}}{\\rho_{2}} = \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}$.\n$\\frac{p_{2}}{p_{1}} - 1 = \\gamma M_{1}^{2} \\left(1 - \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}\\right) = \\gamma M_{1}^{2} \\left(\\frac{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1) - [(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)]}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}\\right)$.\n$\\frac{p_{2}}{p_{1}} - 1 = \\gamma M_{1}^{2} \\left(\\frac{2\\frac{p_{2}}{p_{1}} - 2}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}\\right) = \\frac{2\\gamma M_{1}^{2} (\\frac{p_{2}}{p_{1}} - 1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}$.\nFor a shock, $p_{2}/p_{1} \\ne 1$, so we can divide by $(\\frac{p_{2}}{p_{1}}-1)$.\n$1 = \\frac{2\\gamma M_{1}^{2}}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}$.\n$(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1) = 2\\gamma M_{1}^{2}$.\n$(\\gamma+1)\\frac{p_{2}}{p_{1}} = 2\\gamma M_{1}^{2} - (\\gamma-1)$.\nThis yields the pressure ratio:\n$$ \\frac{p_{2}}{p_{1}} = \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1} $$\nTo find the temperature ratio $T_{2}/T_{1}$, we use the ideal gas law: $p/\\rho = RT$.\n$\\frac{T_{2}}{T_{1}} = \\frac{p_{2}/\\rho_{2}}{p_{1}/\\rho_{1}} = \\frac{p_{2}}{p_{1}} \\frac{\\rho_{1}}{\\rho_{2}}$.\nWe have the expression for $\\rho_1/\\rho_2$ in terms of $p_2/p_1$, so\n$\\frac{T_{2}}{T_{1}} = \\frac{p_{2}}{p_{1}} \\left( \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)} \\right)$.\nFrom the previous step, the denominator is $(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1) = 2\\gamma M_{1}^{2}$.\nSo, $\\frac{T_{2}}{T_{1}} = \\frac{p_{2}}{p_{1}} \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{2\\gamma M_{1}^{2}}$.\nSubstitute the derived expression for $p_{2}/p_{1}$:\n$\\frac{T_{2}}{T_{1}} = \\left( \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1} \\right) \\frac{(\\gamma-1)\\left(\\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1}\\right) + (\\gamma+1)}{2\\gamma M_{1}^{2}}$.\nThe numerator term is $\\frac{(\\gamma-1)(2\\gamma M_{1}^{2} - (\\gamma-1)) + (\\gamma+1)^2}{\\gamma+1} = \\frac{2\\gamma(\\gamma-1)M_1^2 - (\\gamma-1)^2 + (\\gamma+1)^2}{\\gamma+1}$.\nUsing the identity $(\\gamma+1)^2 - (\\gamma-1)^2 = 4\\gamma$, this becomes $\\frac{2\\gamma(\\gamma-1)M_1^2 + 4\\gamma}{\\gamma+1} = \\frac{2\\gamma[(\\gamma-1)M_1^2+2]}{\\gamma+1}$.\nSubstituting back:\n$\\frac{T_{2}}{T_{1}} = \\left( \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1} \\right) \\frac{1}{2\\gamma M_{1}^{2}} \\left( \\frac{2\\gamma[(\\gamma-1)M_1^2+2]}{\\gamma+1} \\right)$.\n$$ \\frac{T_{2}}{T_{1}} = \\frac{(2\\gamma M_{1}^{2} - (\\gamma-1))((\\gamma-1)M_{1}^{2}+2)}{(\\gamma+1)^{2}M_{1}^{2}} $$\nFinally, we must verify that $h_{0,2} - h_{0,1} = 0$ using these derived results.\n$h_{0,2} - h_{0,1} = (h_2 - h_1) + \\frac{1}{2}(u_2^2 - u_1^2) = c_p(T_2 - T_1) + \\frac{1}{2}u_1^2((\\frac{u_2}{u_1})^2-1)$.\nUsing $c_p = \\frac{\\gamma R}{\\gamma-1}$ and $u_1^2 = M_1^2 a_1^2 = M_1^2 \\gamma R T_1$:\n$h_{0,2} - h_{0,1} = \\frac{\\gamma R T_1}{\\gamma-1}(\\frac{T_2}{T_1}-1) + \\frac{1}{2} M_1^2 \\gamma R T_1 ((\\frac{u_2}{u_1})^2-1)$.\nWe need the velocity ratio $u_2/u_1 = \\rho_1/\\rho_2$.\n$\\frac{\\rho_{2}}{\\rho_{1}} = \\frac{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)} = \\frac{2\\gamma M_1^2}{\\frac{2\\gamma[(\\gamma-1)M_1^2+2]}{\\gamma+1}} = \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2+2}$.\nSo, $\\frac{u_2}{u_1} = \\frac{\\rho_1}{\\rho_2} = \\frac{(\\gamma-1)M_1^2+2}{(\\gamma+1)M_1^2}$.\nLet's evaluate the terms in brackets for the stagnation enthalpy difference.\n$\\frac{T_2}{T_1}-1 = \\frac{(2\\gamma M_1^2 - (\\gamma-1))((\\gamma-1)M_1^2+2) - (\\gamma+1)^2 M_1^2}{(\\gamma+1)^2 M_1^2} = \\frac{2(\\gamma-1)(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2}$.\n$(\\frac{u_2}{u_1})^2-1 = \\left(\\frac{(\\gamma-1)M_1^2+2}{(\\gamma+1)M_1^2}\\right)^2 - 1 = \\frac{((\\gamma-1)M_1^2+2)^2 - ((\\gamma+1)M_1^2)^2}{((\\gamma+1)M_1^2)^2}$.\nThe numerator is a difference of squares $(A-B)(A+B)$:\n$A-B = (\\gamma-1-\\gamma-1)M_1^2+2 = -2M_1^2+2 = -2(M_1^2-1)$.\n$A+B = (\\gamma-1+\\gamma+1)M_1^2+2 = 2\\gamma M_1^2+2 = 2(\\gamma M_1^2+1)$.\nSo, $(\\frac{u_2}{u_1})^2-1 = \\frac{-4(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^4}$.\nSubstituting these into the expression for $h_{0,2}-h_{0,1}$:\n$h_{0,2}-h_{0,1} = \\gamma R T_1 \\left[ \\frac{1}{\\gamma-1}\\frac{2(\\gamma-1)(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2} + \\frac{M_1^2}{2}\\frac{-4(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^4} \\right]$.\n$h_{0,2}-h_{0,1} = \\gamma R T_1 \\left[ \\frac{2(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2} - \\frac{2(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2} \\right]$.\nThe terms in the bracket cancel exactly.\n$h_{0,2}-h_{0,1} = \\gamma R T_1 [0] = 0$.\nThis confirms that the derived expressions for pressure and temperature ratios are consistent with the conservation of energy, which was used as a starting point. The value of the stagnation enthalpy difference is identically zero.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1}  \\frac{\\left(2\\gamma M_{1}^{2} - (\\gamma-1)\\right)\\left((\\gamma-1)M_{1}^{2}+2\\right)}{(\\gamma+1)^{2}M_{1}^{2}}  0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "The formulation of the energy equation is not complete without specifying the thermodynamic properties of the fluid. In high-temperature regimes, the common calorically perfect gas assumption fails, and this exercise explores the consequences of that failure. You will quantify the error in wall heat flux prediction that arises from using a simplified constant specific heat model , providing a crucial lesson in the importance of accurate thermodynamic closure for high-enthalpy flows.",
            "id": "3940573",
            "problem": "A high-temperature compressible boundary layer of a thermally perfect but calorically imperfect ideal gas flows over a zero-pressure-gradient flat plate. At a streamwise station, the edge (free-stream) temperature is $T_{e} = 2400\\ \\mathrm{K}$ and the isothermal wall temperature is $T_{w} = 600\\ \\mathrm{K}$. Over the interval $[T_{w}, T_{e}]$, the specific heat at constant pressure is known and accurately represented by\n$$\nc_{p}(T) \\;=\\; \\alpha \\;+\\; \\beta\\,T \\;+\\; \\gamma\\,T^{2},\n$$\nwith $\\alpha = 0.967\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$, $\\beta = 1.00\\times 10^{-4}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$, and $\\gamma = 3.00\\times 10^{-8}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-3}$. Assume negligible pressure work and body forces, and that the flow is steady and two-dimensional.\n\nAn engineer computes the wall heat flux by adopting a calorically perfect approximation with a constant specific heat equal to its edge value $c_{p}(T_{e})$, while using the same enthalpy-based Stanton number (Stanton number (St) defined as the ratio of wall heat flux to the edge advective enthalpy flux) that applies at the station. Let $q_{\\mathrm{true}}$ denote the wall heat flux consistent with the actual $c_{p}(T)$, and let $q_{\\mathrm{cal}}$ denote the wall heat flux predicted under the calorically perfect assumption with $c_{p}(T_{e})$.\n\nUsing only conservation of energy and the definition of the enthalpy-based Stanton number, derive an expression for the relative error\n$$\n\\varepsilon \\;=\\; \\frac{q_{\\mathrm{cal}} - q_{\\mathrm{true}}}{q_{\\mathrm{true}}}\n$$\nin terms of $c_{p}(T)$, $T_{e}$, and $T_{w}$, and then evaluate it for the data given above. Express your final answer as a decimal (no percent sign). Round your answer to four significant figures.",
            "solution": "The problem asks for the relative error in the wall heat flux calculation when approximating a calorically imperfect gas as a calorically perfect gas with a constant specific heat evaluated at the free-stream edge temperature.\n\n### Step 1: Problem Validation\n\nFirst, I will extract the given information and validate the problem statement.\n\n**Givens:**\n*   Flow is a steady, two-dimensional, compressible boundary layer over a zero-pressure-gradient flat plate.\n*   The gas is thermally perfect but calorically imperfect.\n*   Edge temperature: $T_{e} = 2400\\ \\mathrm{K}$.\n*   Isothermal wall temperature: $T_{w} = 600\\ \\mathrm{K}$.\n*   Specific heat at constant pressure: $c_{p}(T) \\;=\\; \\alpha \\;+\\; \\beta\\,T \\;+\\; \\gamma\\,T^{2}$.\n*   Constant $\\alpha = 0.967\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$.\n*   Constant $\\beta = 1.00\\times 10^{-4}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$.\n*   Constant $\\gamma = 3.00\\times 10^{-8}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-3}$.\n*   Assumptions: Negligible pressure work and body forces.\n*   $q_{\\mathrm{true}}$ is the heat flux using the variable $c_p(T)$.\n*   $q_{\\mathrm{cal}}$ is the heat flux using a constant $c_p(T_e)$.\n*   The same enthalpy-based Stanton number, $\\mathrm{St}$, is used for both calculations.\n*   The relative error to be found is $\\varepsilon \\;=\\; \\frac{q_{\\mathrm{cal}} - q_{\\mathrm{true}}}{q_{\\mathrm{true}}}$.\n\n**Validation:**\nThe problem is scientifically grounded in the field of high-temperature gas dynamics and heat transfer. The premise of comparing a real gas model to a simplified ideal gas model is a standard engineering analysis task. The provided data for $c_p(T)$ are physically realistic for a gas like air at high temperatures.\n\nThere is, however, a critical ambiguity in the definition of the \"enthalpy-based Stanton number\". The standard definition for compressible flow is $\\mathrm{St} = \\frac{q_w}{\\rho_e u_e (h_{aw} - h_w)}$, where $h_{aw} = h_e + r\\frac{u_e^2}{2}$ is the adiabatic wall enthalpy, which accounts for viscous dissipation (aerodynamic heating). To calculate $h_{aw}$, one would need the recovery factor $r$ and the edge velocity $u_e$ (or Mach number), which are not provided. This would render the problem underspecified.\n\nHowever, the problem instructs the use of \"only conservation of energy and the definition of the enthalpy-based Stanton number\". This suggests a simplified context. A plausible interpretation, which makes the problem self-contained and solvable, is that the kinetic energy recovery effects are to be neglected in the definition of the driving enthalpy potential. This leads to the definition $\\mathrm{St} = \\frac{q_w}{\\rho_e u_e (h_e - h_w)}$. This is a less general definition but is frequently used as a first approximation. Under this interpretation, the problem is well-posed and complete.\n\nTherefore, I will proceed by adopting this simplified definition of the Stanton number's driving potential. The problem is deemed valid under this explicit and necessary assumption.\n\n### Step 2: Derivation of the Relative Error\n\nThe fundamental assumption is that the enthalpy-based Stanton number, $\\mathrm{St}$, is the same for both the 'true' and the 'calorically perfect' calculations. Let the constant of proportionality relating heat flux to the driving enthalpy difference be $C = \\mathrm{St} \\cdot \\rho_e u_e$. Based on the validation analysis, the driving potential is assumed to be the difference between the edge static enthalpy and the wall static enthalpy.\n\nFor the true case (calorically imperfect gas):\n$$\nq_{\\mathrm{true}} = C (h_{e, \\mathrm{true}} - h_{w, \\mathrm{true}})\n$$\n\nFor the calorically perfect approximation:\n$$\nq_{\\mathrm{cal}} = C (h_{e, \\mathrm{cal}} - h_{w, \\mathrm{cal}})\n$$\n\nThe relative error $\\varepsilon$ is defined as:\n$$\n\\varepsilon = \\frac{q_{\\mathrm{cal}} - q_{\\mathrm{true}}}{q_{\\mathrm{true}}} = \\frac{q_{\\mathrm{cal}}}{q_{\\mathrm{true}}} - 1\n$$\nSubstituting the expressions for the heat fluxes:\n$$\n\\frac{q_{\\mathrm{cal}}}{q_{\\mathrm{true}}} = \\frac{C(h_{e, \\mathrm{cal}} - h_{w, \\mathrm{cal}})}{C(h_{e, \\mathrm{true}} - h_{w, \\mathrm{true}})} = \\frac{h_{e, \\mathrm{cal}} - h_{w, \\mathrm{cal}}}{h_{e, \\mathrm{true}} - h_{w, \\mathrm{true}}}\n$$\nLet $\\Delta h_{\\mathrm{cal}} = h_{e, \\mathrm{cal}} - h_{w, \\mathrm{cal}}$ and $\\Delta h_{\\mathrm{true}} = h_{e, \\mathrm{true}} - h_{w, \\mathrm{true}}$. The error is then:\n$$\n\\varepsilon = \\frac{\\Delta h_{\\mathrm{cal}}}{\\Delta h_{\\mathrm{true}}} - 1\n$$\n\n### Step 3: Calculation of Enthalpy Differences\n\nNow we compute the two enthalpy differences. For enthalpy calculations, we can choose an arbitrary reference state. Let's define enthalpy to be zero at $T=0\\ \\mathrm{K}$.\n\n**True Enthalpy Difference ($\\Delta h_{\\mathrm{true}}$)**\nFor the calorically imperfect gas, the enthalpy is obtained by integrating $c_p(T)$:\n$$\nh(T) = \\int_{0}^{T} c_p(T') \\,dT' = \\int_{0}^{T} (\\alpha + \\beta T' + \\gamma T'^2) \\,dT' = \\alpha T + \\frac{\\beta}{2} T^2 + \\frac{\\gamma}{3} T^3\n$$\nThe enthalpy difference between the edge and the wall is:\n$$\n\\Delta h_{\\mathrm{true}} = h(T_e) - h(T_w) = \\left(\\alpha T_e + \\frac{\\beta}{2} T_e^2 + \\frac{\\gamma}{3} T_e^3\\right) - \\left(\\alpha T_w + \\frac{\\beta}{2} T_w^2 + \\frac{\\gamma}{3} T_w^3\\right)\n$$\n$$\n\\Delta h_{\\mathrm{true}} = \\alpha (T_e - T_w) + \\frac{\\beta}{2} (T_e^2 - T_w^2) + \\frac{\\gamma}{3} (T_e^3 - T_w^3)\n$$\n\n**Calorically Perfect Enthalpy Difference ($\\Delta h_{\\mathrm{cal}}$)**\nIn the simplified model, the specific heat is constant and equal to its value at the edge temperature, $c_{p, \\mathrm{cal}} = c_p(T_e)$.\n$$\nc_{p, \\mathrm{cal}} = \\alpha + \\beta T_e + \\gamma T_e^2\n$$\nThe enthalpy in this model is $h_{\\mathrm{cal}}(T) = c_{p, \\mathrm{cal}} T$. The enthalpy difference is:\n$$\n\\Delta h_{\\mathrm{cal}} = h_{\\mathrm{cal}}(T_e) - h_{\\mathrm{cal}}(T_w) = c_{p, \\mathrm{cal}} T_e - c_{p, \\mathrm{cal}} T_w = c_{p, \\mathrm{cal}}(T_e - T_w)\n$$\n$$\n\\Delta h_{\\mathrm{cal}} = (\\alpha + \\beta T_e + \\gamma T_e^2)(T_e - T_w)\n$$\n\n### Step 4: Final Expression for Error and Numerical Evaluation\n\nSubstituting the expressions for $\\Delta h_{\\mathrm{cal}}$ and $\\Delta h_{\\mathrm{true}}$ into the formula for $\\varepsilon$:\n$$\n\\varepsilon = \\frac{(\\alpha + \\beta T_e + \\gamma T_e^2)(T_e - T_w)}{\\alpha (T_e - T_w) + \\frac{\\beta}{2} (T_e^2 - T_w^2) + \\frac{\\gamma}{3} (T_e^3 - T_w^3)} - 1\n$$\nWe can simplify this expression by factoring out $(T_e - T_w)$ from the denominator:\n$T_e^2 - T_w^2 = (T_e-T_w)(T_e+T_w)$\n$T_e^3 - T_w^3 = (T_e-T_w)(T_e^2 + T_e T_w + T_w^2)$\n$$\n\\varepsilon = \\frac{\\alpha + \\beta T_e + \\gamma T_e^2}{\\alpha + \\frac{\\beta}{2}(T_e + T_w) + \\frac{\\gamma}{3}(T_e^2 + T_e T_w + T_w^2)} - 1\n$$\nThis expression demonstrates that the error is a ratio of the specific heat at the edge temperature to a certain average specific heat over the temperature interval $[T_w, T_e]$.\n\nNow, we substitute the given values:\n$T_e = 2400\\ \\mathrm{K}$\n$T_w = 600\\ \\mathrm{K}$\n$\\alpha = 0.967\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n$\\beta = 1.00 \\times 10^{-4}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$\n$\\gamma = 3.00 \\times 10^{-8}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-3}$\n\nFirst, calculate the numerator, which is $c_p(T_e)$:\n$$\n\\text{Numerator} = 0.967 + (1.00 \\times 10^{-4})(2400) + (3.00 \\times 10^{-8})(2400)^2\n$$\n$$\n\\text{Numerator} = 0.967 + 0.240 + (3.00 \\times 10^{-8})(5.76 \\times 10^6) = 0.967 + 0.240 + 0.1728 = 1.3798\n$$\nThe units are $\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$.\n\nNext, calculate the denominator:\n$$\n\\text{Term 1} = \\alpha = 0.967\n$$\n$$\n\\text{Term 2} = \\frac{\\beta}{2}(T_e + T_w) = \\frac{1.00 \\times 10^{-4}}{2}(2400 + 600) = (5.00 \\times 10^{-5})(3000) = 0.150\n$$\n$$\n\\text{Term 3} = \\frac{\\gamma}{3}(T_e^2 + T_e T_w + T_w^2) = \\frac{3.00 \\times 10^{-8}}{3}(2400^2 + (2400)(600) + 600^2)\n$$\n$$\n\\text{Term 3} = 1.00 \\times 10^{-8}(5.76 \\times 10^6 + 1.44 \\times 10^6 + 0.36 \\times 10^6) = 1.00 \\times 10^{-8}(7.56 \\times 10^6) = 0.0756\n$$\n$$\n\\text{Denominator} = 0.967 + 0.150 + 0.0756 = 1.1926\n$$\nThe units are also $\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$.\n\nFinally, calculate the relative error $\\varepsilon$:\n$$\n\\varepsilon = \\frac{1.3798}{1.1926} - 1 \\approx 1.156968 - 1 = 0.156968\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\varepsilon \\approx 0.1570\n$$",
            "answer": "$$\\boxed{0.1570}$$"
        },
        {
            "introduction": "Bridging the gap from continuous equations to computational simulation requires a robust and verifiable discretization. This practice guides you through the implementation of the semi-discrete conservative energy equation using a finite-volume approach. By computing the energy residual for different numerical flux functions and verifying the fundamental properties of free-stream preservation and exact conservation , you will gain essential skills for developing and debugging computational fluid dynamics codes.",
            "id": "3940584",
            "problem": "Consider the one-dimensional compressible inviscid energy equation in conservative form, derived from the conservation of energy for a thermally perfect gas with ratio of specific heats $\\gamma$:\n$$\n\\frac{\\partial (\\rho E)}{\\partial t} + \\frac{\\partial \\left( (\\rho E + p)\\,u \\right)}{\\partial x} = 0,\n$$\nwhere $\\rho$ is the mass density, $u$ is the velocity, $p$ is the pressure, and $E$ is the specific total energy defined by $E = e + \\frac{1}{2}u^2$, with the internal energy $e = \\frac{p}{(\\gamma - 1)\\rho}$. For a one-dimensional finite-volume discretization on a uniform grid with $N$ control volumes of width $\\Delta x$, periodic boundary conditions, and cell-centered primitive variables $(\\rho_i, u_i, p_i)$ for $i = 1, 2, \\dots, N$, define the conservative energy variable per unit volume in cell $i$ as\n$$\nU_{E,i} = \\rho_i E_i = \\frac{p_i}{\\gamma - 1} + \\frac{1}{2}\\rho_i u_i^2,\n$$\nand the physical energy flux as\n$$\nF_{E,i} = (U_{E,i} + p_i)\\,u_i.\n$$\nDefine numerical interface fluxes $\\hat{F}_{E,i+1/2}$ between cells $i$ and $i+1$ using two different flux functions:\n- Central flux:\n$$\n\\hat{F}_{E,i+1/2}^{\\text{central}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right),\n$$\nwhere $L$ denotes the left state $(\\rho_i, u_i, p_i)$ and $R$ denotes the right state $(\\rho_{i+1}, u_{i+1}, p_{i+1})$, and $F_{E,L}$ and $F_{E,R}$ are the corresponding physical energy fluxes computed from $U_{E,L}$ and $U_{E,R}$.\n- Rusanov (local Laxâ€“Friedrichs) flux:\n$$\n\\hat{F}_{E,i+1/2}^{\\text{rusanov}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right) - \\frac{1}{2}a_{i+1/2}\\left(U_{E,R} - U_{E,L}\\right),\n$$\nwith the local maximum signal speed\n$$\na_{i+1/2} = \\max\\left(\\left|u_L\\right| + c_L, \\left|u_R\\right| + c_R\\right),\n$$\nand the speed of sound\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}}.\n$$\nImpose periodic boundary conditions such that indices wrap around modulo $N$, i.e., the right neighbor of cell $N$ is cell $1$, and the left neighbor of cell $1$ is cell $N$. Define the semi-discrete finite-volume energy residual in each cell,\n$$\nR_{E,i} = \\frac{\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2}}{\\Delta x},\n$$\nwith units of watts per cubic meter ($\\mathrm{W/m^3}$). The telescoping property of flux differences ensures that the domain-integrated residual satisfies\n$$\n\\sum_{i=1}^{N} R_{E,i}\\,\\Delta x = \\hat{F}_{E,N+1/2} - \\hat{F}_{E,1-1/2},\n$$\nwhich is identically zero under periodic boundary conditions if the same numerical flux function is used consistently at all interfaces.\n\nYour task is to implement a program that computes $R_{E,i}$ for given prescribed states and verifies exact conservation for a uniform free stream. Use the following test suite with specified parameters and units:\n\n- Case $1$ (uniform free stream, periodic):\n  - $N = 8$, $\\Delta x = 0.1\\,\\mathrm{m}$, $\\gamma = 1.4$,\n  - $\\rho_i = 1.2\\,\\mathrm{kg/m^3}$, $u_i = 50\\,\\mathrm{m/s}$, $p_i = 101325\\,\\mathrm{Pa}$ for all $i$.\n  - Compute the maximum absolute residual $\\max_i |R_{E,i}|$ for both $\\hat{F}_{E}^{\\text{central}}$ and $\\hat{F}_{E}^{\\text{rusanov}}$ and verify it is numerically zero by checking against a tolerance $\\varepsilon = 1\\times 10^{-12}\\,\\mathrm{W/m^3}$. Return booleans indicating whether the check passes for each flux function.\n\n- Case $2$ (smooth nonuniform field, periodic):\n  - $N = 64$, $\\Delta x = 0.05\\,\\mathrm{m}$, $\\gamma = 1.4$,\n  - Domain length $L = N\\Delta x$ and cell centers $x_i = \\left(i + \\frac{1}{2}\\right)\\Delta x$ for $i = 0, 1, \\dots, N-1$,\n  - $\\rho_i = 1.0 + 0.1\\sin\\left(\\frac{2\\pi x_i}{L}\\right)\\,\\mathrm{kg/m^3}$,\n  - $u_i = 10 + 2\\cos\\left(\\frac{2\\pi x_i}{L}\\right)\\,\\mathrm{m/s}$,\n  - $p_i = 100000 + 10000\\sin\\left(\\frac{4\\pi x_i}{L}\\right)\\,\\mathrm{Pa}$.\n  - Compute and return the maximum absolute residual $\\max_i |R_{E,i}|$ in $\\mathrm{W/m^3}$ for both $\\hat{F}_{E}^{\\text{central}}$ and $\\hat{F}_{E}^{\\text{rusanov}}$.\n\n- Case $3$ (single-cell periodic edge case):\n  - $N = 1$, $\\Delta x = 0.2\\,\\mathrm{m}$, $\\gamma = 1.4$,\n  - $\\rho_1 = 0.9\\,\\mathrm{kg/m^3}$, $u_1 = -120\\,\\mathrm{m/s}$, $p_1 = 80000\\,\\mathrm{Pa}$.\n  - Compute the maximum absolute residual $\\max_i |R_{E,i}|$ for both flux functions and verify it is numerically zero within $\\varepsilon = 1\\times 10^{-12}\\,\\mathrm{W/m^3}$. Return booleans for each flux function.\n\n- Case $4$ (discontinuous jump, periodic; global conservation check):\n  - $N = 10$, $\\Delta x = 0.1\\,\\mathrm{m}$, $\\gamma = 1.4$,\n  - For $i = 1, 2, \\dots, 5$: $\\rho_i = 1.0\\,\\mathrm{kg/m^3}$, $u_i = 0.0\\,\\mathrm{m/s}$, $p_i = 100000\\,\\mathrm{Pa}$,\n  - For $i = 6, 7, \\dots, 10$: $\\rho_i = 0.8\\,\\mathrm{kg/m^3}$, $u_i = 20\\,\\mathrm{m/s}$, $p_i = 80000\\,\\mathrm{Pa}$.\n  - Using $\\hat{F}_{E}^{\\text{rusanov}}$, compute the domain-integrated residual $\\sum_{i=1}^{N} R_{E,i}\\,\\Delta x$ in $\\mathrm{W/m^2}$ and verify it is numerically zero within $\\varepsilon = 1\\times 10^{-12}\\,\\mathrm{W/m^2}$. Return a boolean indicating whether the check passes.\n\nFinal output specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n$$\n[\\text{Case 1 central boolean}, \\text{Case 1 rusanov boolean}, \\text{Case 2 central max residual}, \\text{Case 2 rusanov max residual}, \\text{Case 3 central boolean}, \\text{Case 3 rusanov boolean}, \\text{Case 4 integrated boolean}].\n$$\nEnsure that all residuals are expressed in the units specified above and that booleans are computed using the tolerance $\\varepsilon$ stated in each case.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of computational fluid dynamics, specifically the finite-volume method applied to the Euler equations. All parameters, equations, and boundary conditions are explicitly defined, constituting a well-posed computational task. The test cases are designed to verify fundamental properties of numerical schemes, such as free-stream preservation and conservation.\n\nThe solution proceeds by first implementing the necessary physical and numerical functions and then applying them to the four specified test cases. The core of the implementation is a function that computes the semi-discrete energy residual $R_{E,i}$ for a given set of primitive variables $(\\rho_i, u_i, p_i)$ under periodic boundary conditions.\n\nThe state of the fluid in each cell $i$ is described by the primitive variables of density $\\rho_i$, velocity $u_i$, and pressure $p_i$. From these, we define the conservative variable for energy, which is the total energy per unit volume, $U_{E,i}$. It is given by\n$$\nU_{E,i} = \\rho_i E_i = \\rho_i \\left( e_i + \\frac{1}{2}u_i^2 \\right)\n$$\nFor a thermally perfect gas, the specific internal energy $e_i$ is related to pressure and density via the ratio of specific heats $\\gamma$:\n$$\ne_i = \\frac{p_i}{(\\gamma - 1)\\rho_i}\n$$\nSubstituting this into the expression for $U_{E,i}$ yields\n$$\nU_{E,i} = \\frac{p_i}{\\gamma - 1} + \\frac{1}{2}\\rho_i u_i^2\n$$\nThe physical energy flux, representing the advection of total enthalpy, is given by\n$$\nF_{E,i} = (\\rho_i E_i + p_i) u_i = (U_{E,i} + p_i) u_i\n$$\nThe finite-volume method approximates the spatial derivative in the conservation law by a difference of fluxes at the cell interfaces. For a cell $i$, the semi-discrete form of the energy equation is\n$$\n\\frac{dU_{E,i}}{dt} = - \\frac{\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2}}{\\Delta x}\n$$\nThe right-hand side is defined as the negative of the residual, $R_{E,i}$:\n$$\nR_{E,i} = \\frac{\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2}}{\\Delta x}\n$$\nHere, $\\hat{F}_{E,i+1/2}$ and $\\hat{F}_{E,i-1/2}$ are the numerical fluxes at the right and left interfaces of cell $i$, respectively. Due to periodic boundary conditions, the left neighbor of cell $i=1$ is cell $N$, and the right neighbor of cell $N$ is cell $1$. In a zero-indexed implementation (for cells $i=0, \\dots, N-1$), the right neighbor of cell $i$ is $(i+1) \\pmod N$, and the left neighbor is $(i-1) \\pmod N$.\n\nThe numerical fluxes are computed based on the states to the left (L) and right (R) of the interface. For interface $i+1/2$ between cells $i$ and $i+1$, the L-state is $(\\rho_i, u_i, p_i)$ and the R-state is $(\\rho_{i+1}, u_{i+1}, p_{i+1})$.\n\nThe central flux is a simple average of the physical fluxes from the L and R states:\n$$\n\\hat{F}_{E,i+1/2}^{\\text{central}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right)\n$$\nThe Rusanov (or local Lax-Friedrichs) flux adds a dissipation term proportional to the jump in the conserved variable across the interface, scaled by the maximum local signal speed:\n$$\n\\hat{F}_{E,i+1/2}^{\\text{rusanov}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right) - \\frac{1}{2}a_{i+1/2}\\left(U_{E,R} - U_{E,L}\\right)\n$$\nThe signal speed $a_{i+1/2}$ is determined by the maximum wave speed propagating away from the interface, given by\n$$\na_{i+1/2} = \\max\\left(\\left|u_L\\right| + c_L, \\left|u_R\\right| + c_R\\right)\n$$\nwhere $c_L$ and $c_R$ are the speeds of sound in the L and R states, calculated as\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\nThe implementation will use vectorized operations provided by the NumPy library for efficiency. Primitive variable fields $(\\rho_i, u_i, p_i)$ are stored in arrays. The left and right states for all interfaces are efficiently generated using array shifting (e.g., `numpy.roll`). This allows for the simultaneous computation of all interface fluxes, which are then used to compute the array of all cell residuals.\n\nCase 1 and Case 3 test the free-stream preservation property. For a uniform flow, the left and right states at every interface are identical. Consequently, $U_{E,L} = U_{E,R}$ and $F_{E,L} = F_{E,R}$. Both central and Rusanov fluxes simplify to $\\hat{F}_E = F_{E,L} = F_{E,R}$. Since the numerical flux is constant for all interfaces, the residual $R_{E,i} = (\\hat{F}_E - \\hat{F}_E) / \\Delta x$ must be identically zero. The computation verifies this to within machine precision.\n\nCase 2 involves a non-uniform field, for which a non-zero residual is expected. The calculation provides the maximum magnitude of this residual, which is a measure of the spatial truncation error of the scheme for the given state.\n\nCase 4 tests the global conservation property of the finite-volume scheme. The domain-integrated residual, when using a consistent numerical flux formulation, is\n$$\n\\sum_{i=1}^{N} R_{E,i}\\,\\Delta x = \\sum_{i=1}^{N} (\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2})\n$$\nThis is a telescoping sum which simplifies to $\\hat{F}_{E,N+1/2} - \\hat{F}_{E,1-1/2}$. For periodic boundaries, the interface to the right of cell $N$ is the same as the interface to the left of cell $1$. Thus, $\\hat{F}_{E,N+1/2} = \\hat{F}_{E,1-1/2}$, and the sum must be identically zero, regardless of the flow field. This holds even for discontinuous fields like the one specified in Case 4. The computation verifies this property for the Rusanov flux.",
            "answer": "```python\nimport numpy as np\n\ndef compute_residuals(rho, u, p, gamma, dx, flux_type):\n    \"\"\"\n    Computes the semi-discrete energy residuals for a 1D system.\n\n    Args:\n        rho (np.ndarray): Density in each cell.\n        u (np.ndarray): Velocity in each cell.\n        p (np.ndarray): Pressure in each cell.\n        gamma (float): Ratio of specific heats.\n        dx (float): Cell width.\n        flux_type (str): Type of numerical flux ('central' or 'rusanov').\n\n    Returns:\n        np.ndarray: The energy residual in each cell.\n    \"\"\"\n    N = len(rho)\n    if N == 0:\n        return np.array([])\n        \n    # Calculate conservative variable U_E and physical flux F_E for all cells\n    U_E = p / (gamma - 1.0) + 0.5 * rho * u**2\n    F_E = (U_E + p) * u\n\n    # Get left and right states at each interface i+1/2\n    # The L state is cell i, the R state is cell (i+1)%N\n    # np.roll(arr, -1) shifts elements to the left, so element i becomes i+1\n    rho_L, u_L, p_L = rho, u, p\n    U_E_L, F_E_L = U_E, F_E\n    \n    rho_R, u_R, p_R = np.roll(rho, -1), np.roll(u, -1), np.roll(p, -1)\n    U_E_R, F_E_R = np.roll(U_E, -1), np.roll(F_E, -1)\n\n    # Calculate numerical flux F_hat at each interface\n    if flux_type == 'central':\n        F_hat = 0.5 * (F_E_L + F_E_R)\n    elif flux_type == 'rusanov':\n        # Sound speed\n        c_L = np.sqrt(gamma * p_L / rho_L)\n        c_R = np.sqrt(gamma * p_R / rho_R)\n        # Max signal speed at interface\n        a = np.maximum(np.abs(u_L) + c_L, np.abs(u_R) + c_R)\n        F_hat = 0.5 * (F_E_L + F_E_R) - 0.5 * a * (U_E_R - U_E_L)\n    else:\n        raise ValueError(\"Unknown flux_type\")\n\n    # The flux at the left interface of cell i (i-1/2) is the flux\n    # at the right interface of cell (i-1).\n    # np.roll(F_hat, 1) shifts elements to the right, so F_hat[i-1] moves to F_hat[i]\n    F_hat_left = np.roll(F_hat, 1)\n    F_hat_right = F_hat\n\n    # Calculate residuals\n    R_E = (F_hat_right - F_hat_left) / dx\n    return R_E\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    results = []\n    \n    # --- Case 1 ---\n    N1, dx1, gamma1, tol1 = 8, 0.1, 1.4, 1e-12\n    rho1 = np.full(N1, 1.2)\n    u1 = np.full(N1, 50.0)\n    p1 = np.full(N1, 101325.0)\n    \n    R1_central = compute_residuals(rho1, u1, p1, gamma1, dx1, 'central')\n    max_abs_res1_central = np.max(np.abs(R1_central))\n    results.append(max_abs_res1_central  tol1)\n    \n    R1_rusanov = compute_residuals(rho1, u1, p1, gamma1, dx1, 'rusanov')\n    max_abs_res1_rusanov = np.max(np.abs(R1_rusanov))\n    results.append(max_abs_res1_rusanov  tol1)\n\n    # --- Case 2 ---\n    N2, dx2, gamma2 = 64, 0.05, 1.4\n    L2 = N2 * dx2\n    # Using 0-based indexing for i = 0, ..., N-1\n    i_indices = np.arange(N2)\n    x2 = (i_indices + 0.5) * dx2\n    \n    rho2 = 1.0 + 0.1 * np.sin(2 * np.pi * x2 / L2)\n    u2 = 10.0 + 2.0 * np.cos(2 * np.pi * x2 / L2)\n    p2 = 100000.0 + 10000.0 * np.sin(4 * np.pi * x2 / L2)\n    \n    R2_central = compute_residuals(rho2, u2, p2, gamma2, dx2, 'central')\n    max_abs_res2_central = np.max(np.abs(R2_central))\n    results.append(max_abs_res2_central)\n    \n    R2_rusanov = compute_residuals(rho2, u2, p2, gamma2, dx2, 'rusanov')\n    max_abs_res2_rusanov = np.max(np.abs(R2_rusanov))\n    results.append(max_abs_res2_rusanov)\n\n    # --- Case 3 ---\n    N3, dx3, gamma3, tol3 = 1, 0.2, 1.4, 1e-12\n    rho3 = np.array([0.9])\n    u3 = np.array([-120.0])\n    p3 = np.array([80000.0])\n\n    R3_central = compute_residuals(rho3, u3, p3, gamma3, dx3, 'central')\n    max_abs_res3_central = np.max(np.abs(R3_central))\n    results.append(max_abs_res3_central  tol3)\n\n    R3_rusanov = compute_residuals(rho3, u3, p3, gamma3, dx3, 'rusanov')\n    max_abs_res3_rusanov = np.max(np.abs(R3_rusanov))\n    results.append(max_abs_res3_rusanov  tol3)\n\n    # --- Case 4 ---\n    N4, dx4, gamma4, tol4 = 10, 0.1, 1.4, 1e-12\n    rho4 = np.zeros(N4)\n    u4 = np.zeros(N4)\n    p4 = np.zeros(N4)\n    # Using 0-based indexing i=0..9. Corresponds to 1-based i=1..10\n    # i=1..5 maps to indices 0..4\n    # i=6..10 maps to indices 5..9\n    rho4[0:5], u4[0:5], p4[0:5] = 1.0, 0.0, 100000.0\n    rho4[5:10], u4[5:10], p4[5:10] = 0.8, 20.0, 80000.0\n\n    R4_rusanov = compute_residuals(rho4, u4, p4, gamma4, dx4, 'rusanov')\n    integrated_res4_rusanov = np.sum(R4_rusanov * dx4)\n    results.append(np.abs(integrated_res4_rusanov)  tol4)\n\n    # Final print statement\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}