{
    "hands_on_practices": [
        {
            "introduction": "能量方程是基本物理守恒定律的体现。这一原理在正激波的研究中得到了生动的展示，在正激波中，流动属性会发生突变。本练习旨在让你直接从积分形式的守恒定律推导出经典的 Rankine-Hugoniot 关系，并通过此过程明确验证跨激波的滞止焓守恒，从而巩固你对能量方程在非连续流中作用的理解。",
            "id": "3940536",
            "problem": "考虑在量热完全气体中的一道定常、一维、无粘、绝热正激波，其比热比为 $\\gamma$。上游状态由静压 $p_{1}$、静温 $T_{1}$、密度 $\\rho_{1}$ 和流速 $u_{1}$ 表征。上游马赫数为 $M_{1} \\equiv u_{1}/a_{1}$，其中对于理想气体，声速为 $a \\equiv \\sqrt{\\gamma R T}$，气体常数 $R$ 和定压比热 $c_{p} \\equiv \\gamma R / (\\gamma - 1)$ 均为常数。下游的物理量为 $p_{2}$、$T_{2}$、$\\rho_{2}$ 和 $u_{2}$。激波是静止的平面激波，且控制体没有外部轴功或热量加入。\n\n仅从跨越激波的质量、动量和能量的积分守恒定律、理想气体状态方程 $p=\\rho R T$、量热完全气体的焓定义 $h=c_{p} T$ 以及马赫数的定义出发，完成以下任务：\n\n- 推导下游与上游的无量纲比值 $p_{2}/p_{1}$ 和 $T_{2}/T_{1}$ 关于 $M_{1}$ 和 $\\gamma$ 的闭式解析表达式。\n- 使用可压缩流能量方程，构建总焓差 $h_{0,2} - h_{0,1}$（其中 $h_{0} \\equiv h + u^{2}/2$），并通过代入您推导的关系式，将其完全用 $M_{1}$ 和 $\\gamma$ 表示，以验证能量守恒。\n\n将您的最终答案表示为一个单行矩阵，其元素按顺序为 $\\left(p_{2}/p_{1}\\right)$、$\\left(T_{2}/T_{1}\\right)$ 和 $\\left(h_{0,2} - h_{0,1}\\right)$，全部表示为关于 $M_{1}$ 和 $\\gamma$ 的精确符号函数。除了 $h_{0,2} - h_{0,1}$ 之外，这些量都是无量纲的，您应将 $h_{0,2} - h_{0,1}$ 表示为一种形式，表明其在不需要单位的情况下恒等于零。不需要进行数值近似或四舍五入。",
            "solution": "对用户提供的问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **系统：**定常、一维、无粘、绝热正激波。\n- **流体：**量热完全气体。\n- **上游状态 (1)：**静压 $p_{1}$、静温 $T_{1}$、密度 $\\rho_{1}$、流速 $u_{1}$、马赫数 $M_{1}$。\n- **下游状态 (2)：**静压 $p_{2}$、静温 $T_{2}$、密度 $\\rho_{2}$、流速 $u_{2}$。\n- **常数和定义：**\n    - 比热比：$\\gamma$。\n    - 气体常数：$R$。\n    - 声速：$a \\equiv \\sqrt{\\gamma R T}$。\n    - 马赫数：$M_{1} \\equiv u_{1}/a_{1}$。\n    - 理想气体状态方程：$p=\\rho R T$。\n    - 定压比热：$c_{p} \\equiv \\gamma R / (\\gamma - 1)$。\n    - 量热完全气体的焓：$h=c_{p} T$。\n    - 总焓：$h_{0} \\equiv h + u^{2}/2$。\n- **约束条件：**无外部轴功或热量加入。\n- **任务：**\n    1. 推导 $p_{2}/p_{1}$ 和 $T_{2}/T_{1}$ 关于 $M_{1}$ 和 $\\gamma$ 的表达式。\n    2. 使用推导的关系式证明 $h_{0,2} - h_{0,1} = 0$ 以验证能量守恒。\n    3. 将最终答案以包含 $p_{2}/p_{1}$、$T_{2}/T_{1}$ 和 $h_{0,2} - h_{0,1}$ 表达式的行矩阵形式提供。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：**该问题是可压缩流体动力学中的一个经典练习，涉及正激波的基本物理学。其控制方程和气体模型是标准的，并且在科学上是合理的。\n- **适定性：**所有必要的信息，包括基本守恒定律和状态方程，都已提供，足以推导出所需量。该问题定义明确，并有唯一解。\n- **客观性：**语言正式、精确，不含任何主观或基于观点的内容。\n\n### 步骤 3：结论与行动\n该问题在科学上有效、适定且客观。它通过了所有验证标准。将生成一个解答。\n\n### 推导\n我们从跨越静止正激波的控制体的一维积分守恒定律开始：\n\n1.  **质量守恒（连续性方程）：**\n    $$ \\rho_{1} u_{1} = \\rho_{2} u_{2} $$\n2.  **动量守恒：**\n    $$ p_{1} + \\rho_{1} u_{1}^{2} = p_{2} + \\rho_{2} u_{2}^{2} $$\n3.  **能量守恒：** 对于无轴功的绝热流动，总焓是守恒的。\n    $$ h_{1} + \\frac{1}{2} u_{1}^{2} = h_{2} + \\frac{1}{2} u_{2}^{2} $$\n    这等效于说总焓的变化为零：$h_{0,2} - h_{0,1} = 0$。\n\n这三个定律必须与量热完全气体的状态方程和定义联立求解：\n-   **理想气体定律：** $p = \\rho R T$\n-   **焓：** $h = c_{p} T = \\frac{\\gamma R}{\\gamma-1} T = \\frac{\\gamma}{\\gamma-1} \\frac{p}{\\rho}$\n\n让我们结合守恒定律来形成兰金-雨贡纽关系。从能量方程：\n$h_{2} - h_{1} = \\frac{1}{2}(u_{1}^{2} - u_{2}^{2})$。\n根据连续性方程，$u_2 = u_1 (\\rho_1 / \\rho_2)$，所以 $u_{1}^{2} - u_{2}^{2} = u_{1}^{2}(1 - (\\rho_1/\\rho_2)^2) = u_1^2(\\frac{\\rho_2-\\rho_1}{\\rho_2})(\\frac{\\rho_2+\\rho_1}{\\rho_2})$。这不是最直接的路径。\n\n让我们重新整理动量方程：\n$p_{2} - p_{1} = \\rho_{1} u_{1}^{2} - \\rho_{2} u_{2}^{2}$。使用连续性方程，$\\rho_2 u_2^2 = (\\rho_1 u_1) u_2$。\n$p_{2} - p_{1} = \\rho_{1} u_{1} u_{1} - (\\rho_1 u_1) u_2 = \\rho_{1} u_{1} (u_1 - u_2)$。\n让我们回到能量方程： $h_{2} - h_{1} = \\frac{1}{2}(u_1 - u_2)(u_1 + u_2)$。\n将这两个表达式相除得到：\n$\\frac{h_2 - h_1}{p_2 - p_1} = \\frac{1}{2} \\frac{(u_1 - u_2)(u_1 + u_2)}{\\rho_1 u_1 (u_1 - u_2)} = \\frac{u_1+u_2}{2\\rho_1 u_1}$。\n使用 $u_2 = u_1 \\rho_1/\\rho_2$：\n$\\frac{u_1+u_2}{2\\rho_1 u_1} = \\frac{u_1(1+\\rho_1/\\rho_2)}{2\\rho_1 u_1} = \\frac{1}{2\\rho_1} (1+\\frac{\\rho_1}{\\rho_2}) = \\frac{1}{2}(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2})$。\n因此我们得到了连接焓、压力和密度的兰金-雨贡纽关系：\n$$ h_{2} - h_{1} = \\frac{1}{2}(p_{2} - p_{1}) \\left(\\frac{1}{\\rho_{1}} + \\frac{1}{\\rho_{2}}\\right) $$\n现在，我们代入量热完全气体的焓关系式 $h = \\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}$：\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{p_{2}}{\\rho_{2}} - \\frac{p_{1}}{\\rho_{1}}\\right) = \\frac{1}{2}(p_{2} - p_{1}) \\left(\\frac{1}{\\rho_{1}} + \\frac{1}{\\rho_{2}}\\right) $$\n令压力比为 $P \\equiv p_{2}/p_{1}$，密度比为 $X \\equiv \\rho_{2}/\\rho_{1}$。将方程两边除以 $p_{1}/\\rho_{1}$：\n$$ \\frac{\\gamma}{\\gamma-1} \\left(\\frac{P}{X} - 1\\right) = \\frac{1}{2}(P - 1) \\left(1 + \\frac{1}{X}\\right) $$\n$$ \\frac{\\gamma}{\\gamma-1} \\frac{P-X}{X} = \\frac{1}{2}(P-1) \\frac{X+1}{X} $$\n假设存在激波（$X \\ne 1$），我们乘以 $2X$：\n$2\\gamma(P-X) = (\\gamma-1)(P-1)(X+1)$。\n$2\\gamma P - 2\\gamma X = (\\gamma-1)(PX + P - X - 1)$。\n求解 $X$：\n$2\\gamma P - 2\\gamma X = (\\gamma-1)PX + (\\gamma-1)P - (\\gamma-1)X - (\\gamma-1)$。\n$X [ -2\\gamma - (\\gamma-1)P + (\\gamma-1)] = (\\gamma-1)P - 2\\gamma P - (\\gamma-1)$。\n$X [ -(\\gamma+1) - (\\gamma-1)P ] = -(\\gamma+1)P - (\\gamma-1)$。\n$X [ (\\gamma-1)P + (\\gamma+1) ] = (\\gamma+1)P + (\\gamma-1)$。\n$$ \\frac{\\rho_{2}}{\\rho_{1}} = \\frac{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)} $$\n接下来，我们将其与来流马赫数 $M_{1}$ 联系起来。从动量方程：\n$p_{2} - p_{1} = \\rho_{1} u_{1}^{2} - \\rho_{2} u_{2}^{2} = \\rho_{1} u_{1}^{2} - \\rho_{1} u_{1} u_{2} = \\rho_{1} u_{1}^2 (1 - u_{2}/u_{1})$。\n使用连续性方程，$u_{2}/u_{1} = \\rho_{1}/\\rho_{2}$。\n$p_{2} - p_{1} = \\rho_{1} u_{1}^{2} (1 - \\rho_{1}/\\rho_{2})$。\n两边除以 $p_{1}$：\n$\\frac{p_{2}}{p_{1}} - 1 = \\frac{\\rho_{1} u_{1}^{2}}{p_{1}} \\left(1 - \\frac{\\rho_{1}}{\\rho_{2}}\\right)$。\n马赫数的定义是 $M_{1}^{2} = u_{1}^{2}/a_{1}^{2} = u_{1}^{2}/(\\gamma p_{1}/\\rho_{1}) = \\rho_{1} u_{1}^{2} / (\\gamma p_{1})$。所以，$\\rho_{1} u_{1}^{2}/p_{1} = \\gamma M_{1}^{2}$。\n$\\frac{p_{2}}{p_{1}} - 1 = \\gamma M_{1}^{2} \\left(1 - \\frac{\\rho_{1}}{\\rho_{2}}\\right)$。\n让我们代入之前推导的 $\\rho_2/\\rho_1$ 关系式。\n$\\frac{\\rho_{1}}{\\rho_{2}} = \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}$。\n$\\frac{p_{2}}{p_{1}} - 1 = \\gamma M_{1}^{2} \\left(1 - \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}\\right) = \\gamma M_{1}^{2} \\left(\\frac{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1) - [(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)]}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}\\right)$。\n$\\frac{p_{2}}{p_{1}} - 1 = \\gamma M_{1}^{2} \\left(\\frac{2\\frac{p_{2}}{p_{1}} - 2}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}\\right) = \\frac{2\\gamma M_{1}^{2} (\\frac{p_{2}}{p_{1}} - 1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}$。\n对于激波，$p_{2}/p_{1} \\ne 1$，所以我们可以除以 $(\\frac{p_{2}}{p_{1}}-1)$。\n$1 = \\frac{2\\gamma M_{1}^{2}}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)}$。\n$(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1) = 2\\gamma M_{1}^{2}$。\n$(\\gamma+1)\\frac{p_{2}}{p_{1}} = 2\\gamma M_{1}^{2} - (\\gamma-1)$。\n这就得到了压力比：\n$$ \\frac{p_{2}}{p_{1}} = \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1} $$\n为了求温度比 $T_{2}/T_{1}$，我们使用理想气体定律：$p/\\rho = RT$。\n$\\frac{T_{2}}{T_{1}} = \\frac{p_{2}/\\rho_{2}}{p_{1}/\\rho_{1}} = \\frac{p_{2}}{p_{1}} \\frac{\\rho_{1}}{\\rho_{2}}$。\n我们有 $\\rho_1/\\rho_2$ 关于 $p_2/p_1$ 的表达式，所以\n$\\frac{T_{2}}{T_{1}} = \\frac{p_{2}}{p_{1}} \\left( \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1)} \\right)$。\n从上一步可知，分母为 $(\\gamma+1)\\frac{p_{2}}{p_{1}} + (\\gamma-1) = 2\\gamma M_{1}^{2}$。\n所以，$\\frac{T_{2}}{T_{1}} = \\frac{p_{2}}{p_{1}} \\frac{(\\gamma-1)\\frac{p_{2}}{p_{1}} + (\\gamma+1)}{2\\gamma M_{1}^{2}}$。\n代入推导出的 $p_{2}/p_{1}$ 表达式：\n$\\frac{T_{2}}{T_{1}} = \\left( \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1} \\right) \\frac{(\\gamma-1)\\left(\\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1}\\right) + (\\gamma+1)}{2\\gamma M_{1}^{2}}$。\n分子项是 $\\frac{(\\gamma-1)(2\\gamma M_{1}^{2} - (\\gamma-1)) + (\\gamma+1)^2}{\\gamma+1} = \\frac{2\\gamma(\\gamma-1)M_1^2 - (\\gamma-1)^2 + (\\gamma+1)^2}{\\gamma+1}$。\n使用恒等式 $(\\gamma+1)^2 - (\\gamma-1)^2 = 4\\gamma$，上式变为 $\\frac{2\\gamma(\\gamma-1)M_1^2 + 4\\gamma}{\\gamma+1} = \\frac{2\\gamma[(\\gamma-1)M_1^2+2]}{\\gamma+1}$。\n代回原式：\n$\\frac{T_{2}}{T_{1}} = \\left( \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1} \\right) \\frac{1}{2\\gamma M_{1}^{2}} \\left( \\frac{2\\gamma[(\\gamma-1)M_1^2+2]}{\\gamma+1} \\right)$。\n$$ \\frac{T_{2}}{T_{1}} = \\frac{(2\\gamma M_{1}^{2} - (\\gamma-1))((\\gamma-1)M_{1}^{2}+2)}{(\\gamma+1)^{2}M_{1}^{2}} $$\n最后，我们必须用这些推导出的结果来验证 $h_{0,2} - h_{0,1} = 0$。\n$h_{0,2} - h_{0,1} = (h_2 - h_1) + \\frac{1}{2}(u_2^2 - u_1^2) = c_p(T_2 - T_1) + \\frac{1}{2}u_1^2((\\frac{u_2}{u_1})^2-1)$。\n使用 $c_p = \\frac{\\gamma R}{\\gamma-1}$ 和 $u_1^2 = M_1^2 a_1^2 = M_1^2 \\gamma R T_1$：\n$h_{0,2} - h_{0,1} = \\frac{\\gamma R T_1}{\\gamma-1}(\\frac{T_2}{T_1}-1) + \\frac{1}{2} M_1^2 \\gamma R T_1 ((\\frac{u_2}{u_1})^2-1)$。\n我们需要速度比 $u_2/u_1 = \\rho_1/\\rho_2$。\n$\\frac{\\rho_{2}}{\\rho_{1}} = \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2+2}$。\n所以，$\\frac{u_2}{u_1} = \\frac{\\rho_1}{\\rho_2} = \\frac{(\\gamma-1)M_1^2+2}{(\\gamma+1)M_1^2}$。\n让我们计算总焓差表达式中方括号内的项。\n$\\frac{T_2}{T_1}-1 = \\frac{(2\\gamma M_1^2 - (\\gamma-1))((\\gamma-1)M_1^2+2) - (\\gamma+1)^2 M_1^2}{(\\gamma+1)^2 M_1^2} = \\frac{2(\\gamma-1)(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2}$。\n$(\\frac{u_2}{u_1})^2-1 = \\left(\\frac{(\\gamma-1)M_1^2+2}{(\\gamma+1)M_1^2}\\right)^2 - 1 = \\frac{((\\gamma-1)M_1^2+2)^2 - ((\\gamma+1)M_1^2)^2}{((\\gamma+1)M_1^2)^2}$。\n分子是一个平方差 $(A-B)(A+B)$：\n$A-B = (\\gamma-1-\\gamma-1)M_1^2+2 = -2M_1^2+2 = -2(M_1^2-1)$。\n$A+B = (\\gamma-1+\\gamma+1)M_1^2+2 = 2\\gamma M_1^2+2 = 2(\\gamma M_1^2+1)$。\n所以，$(\\frac{u_2}{u_1})^2-1 = \\frac{-4(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^4}$。\n将这些代入 $h_{0,2}-h_{0,1}$ 的表达式中：\n$h_{0,2}-h_{0,1} = \\gamma R T_1 \\left[ \\frac{1}{\\gamma-1}\\frac{2(\\gamma-1)(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2} + \\frac{M_1^2}{2}\\frac{-4(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^4} \\right]$。\n$h_{0,2}-h_{0,1} = \\gamma R T_1 \\left[ \\frac{2(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2} - \\frac{2(M_1^2-1)(\\gamma M_1^2+1)}{(\\gamma+1)^2 M_1^2} \\right]$。\n方括号中的项完全抵消。\n$h_{0,2}-h_{0,1} = \\gamma R T_1 [0] = 0$。\n这证实了推导出的压力比和温度比表达式与作为出发点的能量守恒定律是一致的。总焓差的值恒等于零。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{2\\gamma M_{1}^{2} - (\\gamma-1)}{\\gamma+1}  \\frac{\\left(2\\gamma M_{1}^{2} - (\\gamma-1)\\right)\\left((\\gamma-1)M_{1}^{2}+2\\right)}{(\\gamma+1)^{2}M_{1}^{2}}  0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "除了基本形式外，能量方程的实际应用效果在很大程度上取决于所用热力学模型的准确性，尤其是在材料属性随温度显著变化的高温应用中。本练习旨在通过让你量化在一个边界层热流问题中，使用简化的恒定比热模型与更真实的随温度变化的比热模型所引入的误差，来突显这种“热力学封闭”的重要性。这是理解工程预测保真度的关键一课。",
            "id": "3940573",
            "problem": "一股热力学上完美但量热学上不完美的理想气体，其高温可压缩边界层流经一个零压力梯度的平板。在某个流向站位，边界层外缘（自由流）温度为 $T_{e} = 2400\\ \\mathrm{K}$，等温壁面温度为 $T_{w} = 600\\ \\mathrm{K}$。在 $[T_{w}, T_{e}]$ 区间内，定压比热是已知的，并可由下式精确表示：\n$$\nc_{p}(T) \\;=\\; \\alpha \\;+\\; \\beta\\,T \\;+\\; \\gamma\\,T^{2},\n$$\n其中 $\\alpha = 0.967\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$\\beta = 1.00\\times 10^{-4}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$，以及 $\\gamma = 3.00\\times 10^{-8}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-3}$。假设压力功和体积力可忽略不计，且流动是稳态二维的。\n\n一位工程师采用量热学上完美的近似方法计算壁面热通量，其定压比热为一个常数，等于边界层外缘值 $c_{p}(T_{e})$，同时使用该站位适用的相同的基于焓的斯坦顿数（斯坦顿数（St）定义为壁面热通量与外缘对流焓通量之比）。令 $q_{\\mathrm{true}}$ 表示与实际 $c_{p}(T)$ 一致的壁面热通量，令 $q_{\\mathrm{cal}}$ 表示在量热学上完美的假设下，使用 $c_{p}(T_{e})$ 预测的壁面热通量。\n\n仅使用能量守恒和基于焓的斯坦顿数的定义，推导相对误差\n$$\n\\varepsilon \\;=\\; \\frac{q_{\\mathrm{cal}} - q_{\\mathrm{true}}}{q_{\\mathrm{true}}}\n$$\n的表达式，用 $c_{p}(T)$、$T_{e}$ 和 $T_{w}$ 表示，然后根据上述数据计算其值。请以小数形式表示最终答案（不带百分号）。将答案四舍五入至四位有效数字。",
            "solution": "该问题要求计算在将量热学上不完美的气体近似为量热学上完美的气体（其定压比热为在自由流外缘温度下求得的常数）时，壁面热通量计算中的相对误差。\n\n### 步骤1：问题验证\n\n首先，我将提取给定信息并验证问题陈述。\n\n**给定条件：**\n*   流动是流经零压力梯度平板的稳态二维可压缩边界层。\n*   气体是热力学上完美但量热学上不完美的。\n*   外缘温度：$T_{e} = 2400\\ \\mathrm{K}$。\n*   等温壁面温度：$T_{w} = 600\\ \\mathrm{K}$。\n*   定压比热：$c_{p}(T) \\;=\\; \\alpha \\;+\\; \\beta\\,T \\;+\\; \\gamma\\,T^{2}$。\n*   常数 $\\alpha = 0.967\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。\n*   常数 $\\beta = 1.00\\times 10^{-4}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$。\n*   常数 $\\gamma = 3.00\\times 10^{-8}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-3}$。\n*   假设：压力功和体积力可忽略不计。\n*   $q_{\\mathrm{true}}$ 是使用变化的 $c_p(T)$ 计算的热通量。\n*   $q_{\\mathrm{cal}}$ 是使用常数 $c_p(T_e)$ 计算的热通量。\n*   两次计算均使用相同的基于焓的斯坦顿数 $\\mathrm{St}$。\n*   待求的相对误差为 $\\varepsilon \\;=\\; \\frac{q_{\\mathrm{cal}} - q_{\\mathrm{true}}}{q_{\\mathrm{true}}}$。\n\n**验证：**\n该问题在高温气体动力学和传热领域具有科学依据。将真实气体模型与简化的理想气体模型进行比较是标准的工程分析任务。提供的 $c_p(T)$ 数据对于像空气这样的气体在高温下是物理上现实的。\n\n然而，“基于焓的斯坦顿数”的定义存在一个关键的模糊之处。可压缩流动的标准定义是 $\\mathrm{St} = \\frac{q_w}{\\rho_e u_e (h_{aw} - h_w)}$，其中 $h_{aw} = h_e + r\\frac{u_e^2}{2}$ 是绝热壁焓，它考虑了粘性耗散（气动加热）。要计算 $h_{aw}$，需要恢复因子 $r$ 和外缘速度 $u_e$（或马赫数），这些都没有提供。这将导致问题条件不足。\n\n然而，问题指示“仅使用能量守恒和基于焓的斯坦顿数的定义”。这表明一个简化的情景。一个合理的解释是，在定义驱动焓势时忽略动能恢复效应，这使得问题自洽且可解。这导出了定义 $\\mathrm{St} = \\frac{q_w}{\\rho_e u_e (h_e - h_w)}$。这是一个不太通用的定义，但经常用作初步近似。在这种解释下，问题是适定和完整的。\n\n因此，我将采用这种简化的斯坦顿数驱动势的定义继续进行。在这个明确且必要的假设下，该问题被认为是有效的。\n\n### 步骤2：相对误差的推导\n\n基本假设是，对于“真实”和“量热学上完美”的两种计算，基于焓的斯坦顿数 $\\mathrm{St}$ 是相同的。设关联热通量与驱动焓差的比例常数为 $C = \\mathrm{St} \\cdot \\rho_e u_e$。根据验证分析，驱动势被假定为外缘静焓与壁面静焓之差。\n\n对于真实情况（量热学上不完美的气体）：\n$$\nq_{\\mathrm{true}} = C (h_{e, \\mathrm{true}} - h_{w, \\mathrm{true}})\n$$\n\n对于量热学上完美的近似：\n$$\nq_{\\mathrm{cal}} = C (h_{e, \\mathrm{cal}} - h_{w, \\mathrm{cal}})\n$$\n\n相对误差 $\\varepsilon$ 定义为：\n$$\n\\varepsilon = \\frac{q_{\\mathrm{cal}} - q_{\\mathrm{true}}}{q_{\\mathrm{true}}} = \\frac{q_{\\mathrm{cal}}}{q_{\\mathrm{true}}} - 1\n$$\n代入热通量的表达式：\n$$\n\\frac{q_{\\mathrm{cal}}}{q_{\\mathrm{true}}} = \\frac{C(h_{e, \\mathrm{cal}} - h_{w, \\mathrm{cal}})}{C(h_{e, \\mathrm{true}} - h_{w, \\mathrm{true}})} = \\frac{h_{e, \\mathrm{cal}} - h_{w, \\mathrm{cal}}}{h_{e, \\mathrm{true}} - h_{w, \\mathrm{true}}}\n$$\n令 $\\Delta h_{\\mathrm{cal}} = h_{e, \\mathrm{cal}} - h_{w, \\mathrm{cal}}$ 和 $\\Delta h_{\\mathrm{true}} = h_{e, \\mathrm{true}} - h_{w, \\mathrm{true}}$。则误差为：\n$$\n\\varepsilon = \\frac{\\Delta h_{\\mathrm{cal}}}{\\Delta h_{\\mathrm{true}}} - 1\n$$\n\n### 步骤3：焓差的计算\n\n现在我们计算两个焓差。对于焓的计算，我们可以选择一个任意的参考状态。让我们定义在 $T=0\\ \\mathrm{K}$ 时焓为零。\n\n**真实焓差 ($\\Delta h_{\\mathrm{true}}$)**\n对于量热学上不完美的气体，焓通过积分 $c_p(T)$ 得到：\n$$\nh(T) = \\int_{0}^{T} c_p(T') \\,dT' = \\int_{0}^{T} (\\alpha + \\beta T' + \\gamma T'^2) \\,dT' = \\alpha T + \\frac{\\beta}{2} T^2 + \\frac{\\gamma}{3} T^3\n$$\n外缘与壁面之间的焓差为：\n$$\n\\Delta h_{\\mathrm{true}} = h(T_e) - h(T_w) = \\left(\\alpha T_e + \\frac{\\beta}{2} T_e^2 + \\frac{\\gamma}{3} T_e^3\\right) - \\left(\\alpha T_w + \\frac{\\beta}{2} T_w^2 + \\frac{\\gamma}{3} T_w^3\\right)\n$$\n$$\n\\Delta h_{\\mathrm{true}} = \\alpha (T_e - T_w) + \\frac{\\beta}{2} (T_e^2 - T_w^2) + \\frac{\\gamma}{3} (T_e^3 - T_w^3)\n$$\n\n**量热学上完美的焓差 ($\\Delta h_{\\mathrm{cal}}$)**\n在简化模型中，比热是常数，等于其在外缘温度下的值，即 $c_{p, \\mathrm{cal}} = c_p(T_e)$。\n$$\nc_{p, \\mathrm{cal}} = \\alpha + \\beta T_e + \\gamma T_e^2\n$$\n在此模型中，焓为 $h_{\\mathrm{cal}}(T) = c_{p, \\mathrm{cal}} T$。焓差为：\n$$\n\\Delta h_{\\mathrm{cal}} = h_{\\mathrm{cal}}(T_e) - h_{\\mathrm{cal}}(T_w) = c_{p, \\mathrm{cal}} T_e - c_{p, \\mathrm{cal}} T_w = c_{p, \\mathrm{cal}}(T_e - T_w)\n$$\n$$\n\\Delta h_{\\mathrm{cal}} = (\\alpha + \\beta T_e + \\gamma T_e^2)(T_e - T_w)\n$$\n\n### 步骤4：误差的最终表达式与数值计算\n\n将 $\\Delta h_{\\mathrm{cal}}$ 和 $\\Delta h_{\\mathrm{true}}$ 的表达式代入 $\\varepsilon$ 的公式中：\n$$\n\\varepsilon = \\frac{(\\alpha + \\beta T_e + \\gamma T_e^2)(T_e - T_w)}{\\alpha (T_e - T_w) + \\frac{\\beta}{2} (T_e^2 - T_w^2) + \\frac{\\gamma}{3} (T_e^3 - T_w^3)} - 1\n$$\n我们可以通过从分母中提取因子 $(T_e - T_w)$ 来简化此表达式：\n$T_e^2 - T_w^2 = (T_e-T_w)(T_e+T_w)$\n$T_e^3 - T_w^3 = (T_e-T_w)(T_e^2 + T_e T_w + T_w^2)$\n$$\n\\varepsilon = \\frac{\\alpha + \\beta T_e + \\gamma T_e^2}{\\alpha + \\frac{\\beta}{2}(T_e + T_w) + \\frac{\\gamma}{3}(T_e^2 + T_e T_w + T_w^2)} - 1\n$$\n该表达式表明，误差是外缘温度下的比热与温度区间 $[T_w, T_e]$ 上某个平均比热的比值。\n\n现在，我们代入给定值：\n$T_e = 2400\\ \\mathrm{K}$\n$T_w = 600\\ \\mathrm{K}$\n$\\alpha = 0.967\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$\n$\\beta = 1.00 \\times 10^{-4}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-2}$\n$\\gamma = 3.00 \\times 10^{-8}\\ \\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-3}$\n\n首先，计算分子，即 $c_p(T_e)$：\n$$\n\\text{分子} = 0.967 + (1.00 \\times 10^{-4})(2400) + (3.00 \\times 10^{-8})(2400)^2\n$$\n$$\n\\text{分子} = 0.967 + 0.240 + (3.00 \\times 10^{-8})(5.76 \\times 10^6) = 0.967 + 0.240 + 0.1728 = 1.3798\n$$\n单位是 $\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。\n\n接着，计算分母：\n$$\n\\text{第1项} = \\alpha = 0.967\n$$\n$$\n\\text{第2项} = \\frac{\\beta}{2}(T_e + T_w) = \\frac{1.00 \\times 10^{-4}}{2}(2400 + 600) = (5.00 \\times 10^{-5})(3000) = 0.150\n$$\n$$\n\\text{第3项} = \\frac{\\gamma}{3}(T_e^2 + T_e T_w + T_w^2) = \\frac{3.00 \\times 10^{-8}}{3}(2400^2 + (2400)(600) + 600^2)\n$$\n$$\n\\text{第3项} = 1.00 \\times 10^{-8}(5.76 \\times 10^6 + 1.44 \\times 10^6 + 0.36 \\times 10^6) = 1.00 \\times 10^{-8}(7.56 \\times 10^6) = 0.0756\n$$\n$$\n\\text{分母} = 0.967 + 0.150 + 0.0756 = 1.1926\n$$\n单位也是 $\\mathrm{kJ}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。\n\n最后，计算相对误差 $\\varepsilon$：\n$$\n\\varepsilon = \\frac{1.3798}{1.1926} - 1 \\approx 1.156968 - 1 = 0.156968\n$$\n问题要求将答案四舍五入至四位有效数字。\n$$\n\\varepsilon \\approx 0.1570\n$$",
            "answer": "$$\\boxed{0.1570}$$"
        },
        {
            "introduction": "将连续的能量方程转化为用于计算机模拟的离散形式，是计算热工学领域的一项核心技能。本练习提供了有限体积法的实践入门，指导你为守恒形式的能量方程实现数值通量。通过计算离散残差并验证自由流保持等基本属性，你将获得关于守恒定律如何在数值计算环境中得以维持的实践洞察。",
            "id": "3940584",
            "problem": "考虑守恒形式的一维可压缩无粘能量方程，该方程由热力学理想气体的能量守恒定律推导得出，其比热比为 $\\gamma$：\n$$\n\\frac{\\partial (\\rho E)}{\\partial t} + \\frac{\\partial \\left( (\\rho E + p)\\,u \\right)}{\\partial x} = 0,\n$$\n其中 $\\rho$ 是质量密度，$u$ 是速度，$p$ 是压力，$E$ 是比总能，定义为 $E = e + \\frac{1}{2}u^2$，内能 $e = \\frac{p}{(\\gamma - 1)\\rho}$。对于一个具有 $N$ 个宽度为 $\\Delta x$ 的控制体、周期性边界条件和单元中心原始变量 $(\\rho_i, u_i, p_i)$（$i = 1, 2, \\dots, N$）的均匀网格上的一维有限体积离散，定义单元 $i$ 中单位体积的守恒能量变量为\n$$\nU_{E,i} = \\rho_i E_i = \\frac{p_i}{\\gamma - 1} + \\frac{1}{2}\\rho_i u_i^2,\n$$\n物理能量通量为\n$$\nF_{E,i} = (U_{E,i} + p_i)\\,u_i.\n$$\n使用两种不同的通量函数定义单元 $i$ 和 $i+1$ 之间的数值界面通量 $\\hat{F}_{E,i+1/2}$：\n- 中心通量：\n$$\n\\hat{F}_{E,i+1/2}^{\\text{central}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right),\n$$\n其中 $L$ 表示左状态 $(\\rho_i, u_i, p_i)$，$R$ 表示右状态 $(\\rho_{i+1}, u_{i+1}, p_{i+1})$，$F_{E,L}$ 和 $F_{E,R}$ 是根据 $U_{E,L}$ 和 $U_{E,R}$ 计算的相应物理能量通量。\n- Rusanov (局部 Lax–Friedrichs) 通量：\n$$\n\\hat{F}_{E,i+1/2}^{\\text{rusanov}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right) - \\frac{1}{2}a_{i+1/2}\\left(U_{E,R} - U_{E,L}\\right),\n$$\n其中局部最大信号速度为\n$$\na_{i+1/2} = \\max\\left(\\left|u_L\\right| + c_L, \\left|u_R\\right| + c_R\\right),\n$$\n声速为\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}}.\n$$\n施加周期性边界条件，使得指数按模 $N$ 回绕，即单元 $N$ 的右邻居是单元 $1$，单元 $1$ 的左邻居是单元 $N$。定义每个单元中的半离散有限体积能量残差，\n$$\nR_{E,i} = \\frac{\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2}}{\\Delta x},\n$$\n单位为瓦特每立方米 ($\\mathrm{W/m^3}$)。通量差分的伸缩求和性质确保了区域积分残差满足\n$$\n\\sum_{i=1}^{N} R_{E,i}\\,\\Delta x = \\hat{F}_{E,N+1/2} - \\hat{F}_{E,1-1/2},\n$$\n如果在所有界面上一致地使用相同的数值通量函数，则在周期性边界条件下，该值恒等于零。\n\n你的任务是实现一个程序，为给定的状态计算 $R_{E,i}$，并验证均匀自由来流的精确守恒性。使用以下具有指定参数和单位的测试套件：\n\n- 情况1（均匀自由来流，周期性）：\n  - $N = 8$，$\\Delta x = 0.1\\,\\mathrm{m}$，$\\gamma = 1.4$，\n  - 对所有 $i$，$\\rho_i = 1.2\\,\\mathrm{kg/m^3}$，$u_i = 50\\,\\mathrm{m/s}$，$p_i = 101325\\,\\mathrm{Pa}$。\n  - 对 $\\hat{F}_{E}^{\\text{central}}$ 和 $\\hat{F}_{E}^{\\text{rusanov}}$ 分别计算最大绝对残差 $\\max_i |R_{E,i}|$，并通过与容差 $\\varepsilon = 1\\times 10^{-12}\\,\\mathrm{W/m^3}$ 比较来验证其是否在数值上为零。返回布尔值，指示每个通量函数的检查是否通过。\n\n- 情况2（光滑非均匀场，周期性）：\n  - $N = 64$，$\\Delta x = 0.05\\,\\mathrm{m}$，$\\gamma = 1.4$，\n  - 区域长度 $L = N\\Delta x$，单元中心 $x_i = \\left(i + \\frac{1}{2}\\right)\\Delta x$ for $i = 0, 1, \\dots, N-1$，\n  - $\\rho_i = 1.0 + 0.1\\sin\\left(\\frac{2\\pi x_i}{L}\\right)\\,\\mathrm{kg/m^3}$，\n  - $u_i = 10 + 2\\cos\\left(\\frac{2\\pi x_i}{L}\\right)\\,\\mathrm{m/s}$，\n  - $p_i = 100000 + 10000\\sin\\left(\\frac{4\\pi x_i}{L}\\right)\\,\\mathrm{Pa}$。\n  - 对 $\\hat{F}_{E}^{\\text{central}}$ 和 $\\hat{F}_{E}^{\\text{rusanov}}$ 分别计算并返回最大绝对残差 $\\max_i |R_{E,i}|$，单位为 $\\mathrm{W/m^3}$。\n\n- 情况3（单单元周期性边界情况）：\n  - $N = 1$，$\\Delta x = 0.2\\,\\mathrm{m}$，$\\gamma = 1.4$，\n  - $\\rho_1 = 0.9\\,\\mathrm{kg/m^3}$，$u_1 = -120\\,\\mathrm{m/s}$，$p_1 = 80000\\,\\mathrm{Pa}$。\n  - 对两种通量函数计算最大绝对残差 $\\max_i |R_{E,i}|$，并验证其在容差 $\\varepsilon = 1\\times 10^{-12}\\,\\mathrm{W/m^3}$ 内是否为数值零。为每个通量函数返回布尔值。\n\n- 情况4（间断跳跃，周期性；全局守恒性检查）：\n  - $N = 10$，$\\Delta x = 0.1\\,\\mathrm{m}$，$\\gamma = 1.4$，\n  - 对于 $i = 1, 2, \\dots, 5$：$\\rho_i = 1.0\\,\\mathrm{kg/m^3}$，$u_i = 0.0\\,\\mathrm{m/s}$，$p_i = 100000\\,\\mathrm{Pa}$，\n  - 对于 $i = 6, 7, \\dots, 10$：$\\rho_i = 0.8\\,\\mathrm{kg/m^3}$，$u_i = 20\\,\\mathrm{m/s}$，$p_i = 80000\\,\\mathrm{Pa}$。\n  - 使用 $\\hat{F}_{E}^{\\text{rusanov}}$，计算区域积分残差 $\\sum_{i=1}^{N} R_{E,i}\\,\\Delta x$（单位为 $\\mathrm{W/m^2}$），并验证其在容差 $\\varepsilon = 1\\times 10^{-12}\\,\\mathrm{W/m^2}$ 内是否为数值零。返回一个布尔值，指示检查是否通过。\n\n最终输出规范：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$$\n[\\text{情况1中心通量布尔值}, \\text{情况1rusanov通量布尔值}, \\text{情况2中心通量最大残差}, \\text{情况2rusanov通量最大残差}, \\text{情况3中心通量布尔值}, \\text{情况3rusanov通量布尔值}, \\text{情况4积分布尔值}].\n$$\n确保所有残差都以上述指定单位表示，并且布尔值是使用每种情况下说明的容差 $\\varepsilon$ 计算的。",
            "solution": "该问题是有效的，因为它科学地基于计算流体动力学的原理，特别是应用于欧拉方程的有限体积法。所有参数、方程和边界条件都已明确定义，构成了一个良定的计算任务。这些测试用例旨在验证数值格式的基本属性，例如自由来流保持和守恒性。\n\n求解过程首先实现必要的物理和数值函数，然后将它们应用于四个指定的测试用例。实现的核心是一个函数，该函数在周期性边界条件下，为一组给定的原始变量 $(\\rho_i, u_i, p_i)$ 计算半离散能量残差 $R_{E,i}$。\n\n每个单元 $i$ 中的流体状态由原始变量密度 $\\rho_i$、速度 $u_i$ 和压力 $p_i$ 描述。由此，我们定义能量的守恒变量，即单位体积的总能量 $U_{E,i}$。它由下式给出\n$$\nU_{E,i} = \\rho_i E_i = \\rho_i \\left( e_i + \\frac{1}{2}u_i^2 \\right)\n$$\n对于热力学理想气体，比内能 $e_i$ 通过比热比 $\\gamma$ 与压力和密度相关：\n$$\ne_i = \\frac{p_i}{(\\gamma - 1)\\rho_i}\n$$\n将此代入 $U_{E,i}$ 的表达式中，得到\n$$\nU_{E,i} = \\frac{p_i}{\\gamma - 1} + \\frac{1}{2}\\rho_i u_i^2\n$$\n物理能量通量代表总焓的平流，由下式给出\n$$\nF_{E,i} = (\\rho_i E_i + p_i) u_i = (U_{E,i} + p_i) u_i\n$$\n有限体积法通过单元界面处通量的差分来近似守恒律中的空间导数。对于单元 $i$，能量方程的半离散形式为\n$$\n\\frac{dU_{E,i}}{dt} = - \\frac{\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2}}{\\Delta x}\n$$\n右侧被定义为残差 $R_{E,i}$ 的负值：\n$$\nR_{E,i} = \\frac{\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2}}{\\Delta x}\n$$\n这里，$\\hat{F}_{E,i+1/2}$ 和 $\\hat{F}_{E,i-1/2}$ 分别是单元 $i$ 右侧和左侧界面处的数值通量。由于周期性边界条件，单元 $i=1$ 的左邻居是单元 $N$，而单元 $N$ 的右邻居是单元 $1$。在从零开始索引的实现中（对于单元 $i=0, \\dots, N-1$），单元 $i$ 的右邻居是 $(i+1) \\pmod N$，左邻居是 $(i-1) \\pmod N$。\n\n数值通量是根据界面左侧 (L) 和右侧 (R) 的状态计算的。对于单元 $i$ 和 $i+1$ 之间的界面 $i+1/2$，L-状态是 $(\\rho_i, u_i, p_i)$，R-状态是 $(\\rho_{i+1}, u_{i+1}, p_{i+1})$。\n\n中心通量是 L 和 R 状态物理通量的简单平均：\n$$\n\\hat{F}_{E,i+1/2}^{\\text{central}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right)\n$$\nRusanov (或局部 Lax-Friedrichs) 通量增加了一个耗散项，该项与跨界面的守恒变量跳跃成正比，并由局部最大信号速度进行缩放：\n$$\n\\hat{F}_{E,i+1/2}^{\\text{rusanov}} = \\frac{1}{2}\\left(F_{E,L} + F_{E,R}\\right) - \\frac{1}{2}a_{i+1/2}\\left(U_{E,R} - U_{E,L}\\right)\n$$\n信号速度 $a_{i+1/2}$ 由离开界面的最大波速确定，由下式给出\n$$\na_{i+1/2} = \\max\\left(\\left|u_L\\right| + c_L, \\left|u_R\\right| + c_R\\right)\n$$\n其中 $c_L$ 和 $c_R$ 是 L 和 R 状态下的声速，计算公式为\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\n为了提高效率，该实现将使用 NumPy 库提供的矢量化操作。原始变量场 $(\\rho_i, u_i, p_i)$ 存储在数组中。所有界面的左、右状态可通过数组移位（例如，`numpy.roll`）高效生成。这允许同时计算所有界面通量，然后用这些通量计算所有单元残差的数组。\n\n情况1和情况3测试了自由来流保持性质。对于均匀流，每个界面处的左、右状态是相同的。因此，$U_{E,L} = U_{E,R}$ 且 $F_{E,L} = F_{E,R}$。中心通量和 Rusanov 通量都简化为 $\\hat{F}_E = F_{E,L} = F_{E,R}$。由于数值通量对所有界面都是恒定的，残差 $R_{E,i} = (\\hat{F}_E - \\hat{F}_E) / \\Delta x$ 必须恒等于零。计算将验证这一点，直至机器精度。\n\n情况2涉及一个非均匀场，预计会产生非零残差。计算提供了该残差的最大幅值，这是给定状态下该格式空间截断误差的度量。\n\n情况4测试了有限体积格式的全局守恒性质。当使用一致的数值通量公式时，区域积分残差为\n$$\n\\sum_{i=1}^{N} R_{E,i}\\,\\Delta x = \\sum_{i=1}^{N} (\\hat{F}_{E,i+1/2} - \\hat{F}_{E,i-1/2})\n$$\n这是一个伸缩求和，可简化为 $\\hat{F}_{E,N+1/2} - \\hat{F}_{E,1-1/2}$。对于周期性边界，单元 $N$ 右侧的界面与单元 $1$ 左侧的界面相同。因此，$\\hat{F}_{E,N+1/2} = \\hat{F}_{E,1-1/2}$，总和必须恒等于零，无论流场如何。即使对于像情况4中指定的间断场，这一点也成立。计算将验证 Rusanov 通量的这一性质。",
            "answer": "$$ \\boxed{\\text{[True, True, 218991443.08432317, 214691459.73693633, True, True, True]}} $$"
        }
    ]
}