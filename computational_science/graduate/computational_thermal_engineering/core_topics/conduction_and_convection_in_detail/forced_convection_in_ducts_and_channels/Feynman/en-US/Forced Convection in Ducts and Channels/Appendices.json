{
    "hands_on_practices": [
        {
            "introduction": "Before turning to complex computational codes, it is essential to master the art of modeling physical systems from first principles. This practice grounds your understanding in the fundamentals by having you construct a thermal resistance network for a common engineering system. You will derive the overall heat transfer coefficient for a duct enhanced with external fins, learning to combine conduction and convection resistances and correctly account for the performance of extended surfaces . This skill is crucial for performing quick estimates and validating more complex numerical simulations.",
            "id": "3955569",
            "problem": "A circular duct of length $L$ carries a hot fluid with bulk temperature $T_b$ and experiences steady, fully developed internal forced convection. The duct has inner radius $r_i$ and wall thickness $t_w$, giving outer radius $r_o = r_i + t_w$. The wall is homogeneous with thermal conductivity $k_w$. The outer surface of the duct is fitted with an array of $N$ identical, uniformly distributed cylindrical pin fins (circular rods) of radius $a$ and height $H_f$, made of a material with thermal conductivity $k_f$. The surrounding ambient is at uniform temperature $T_{\\infty}$, and the external flow yields a uniform external convective heat transfer coefficient $h_o$ over all exposed surfaces. The internal convection coefficient is $h_i$ at the inner wall. Assume negligible axial conduction in the wall and fins, steady state, and that the fin tips are adiabatic. The fins are attached to the outer cylindrical wall, and the base temperature of each fin is equal to the outer wall temperature at $r_o$. Treat the fins as one-dimensional extended surfaces exchanging heat with the ambient along their lateral surface only (no tip convection due to the adiabatic tip assumption).\n\nStarting only from the fundamental definitions of Newton’s law of cooling and Fourier’s law of conduction, and treating the extended surface effect rigorously from the differential energy balance on a fin, do the following:\n\n1. Derive a thermal resistance network that connects the bulk fluid temperature $T_b$ to the ambient temperature $T_{\\infty}$ via three serial elements: internal convection inside the duct, radial conduction through the cylindrical wall, and external convection enhanced by the pin fins. Clearly identify the equivalent external convective resistance in terms of an effective external area that accounts for fin efficiency.\n\n2. From your resistance network, derive a symbolic expression for the overall heat transfer coefficient based on the outer cylindrical area, $U_o$, defined by the relation $q = U_o A_o \\left(T_b - T_{\\infty}\\right)$, where $A_o = 2 \\pi r_o L$.\n\n3. Using your derived expression, compute a numerical value of $U_o$ for the following geometrical and thermo-physical parameters:\n- $L = 1.5$ m,\n- $r_i = 0.025$ m,\n- $t_w = 0.003$ m,\n- $k_w = 16$ W m$^{-1}$ K$^{-1}$,\n- $h_i = 800$ W m$^{-2}$ K$^{-1}$,\n- $h_o = 12$ W m$^{-2}$ K$^{-1}$,\n- $N = 132$,\n- $a = 0.002$ m,\n- $H_f = 0.015$ m,\n- $k_f = 200$ W m$^{-1}$ K$^{-1}$.\n\nFor the fins, treat each as a straight pin fin with circular cross-section and adiabatic tip, and derive its efficiency from the governing one-dimensional fin equation. In computing the equivalent external convective resistance, consider the base area between fins as directly exposed to convection and the fin lateral area as contributing through the fin efficiency. Round your final numerical value of $U_o$ to four significant figures. Express the final answer for $U_o$ in W m$^{-2}$ K$^{-1}$.",
            "solution": "The problem is analyzed by constructing a thermal resistance network from the bulk fluid to the ambient air. The total thermal resistance is the sum of three series resistances: internal convection, conduction through the duct wall, and convection from the finned outer surface.\n\n### Part 1: Derivation of the Thermal Resistance Network\n\nThe total heat transfer rate, $q$, from the bulk fluid at temperature $T_b$ to the ambient surroundings at temperature $T_{\\infty}$ can be represented by a thermal circuit. The temperature difference $T_b - T_{\\infty}$ drives the heat flow through a series of thermal resistances.\n\n**1. Internal Convective Resistance, $R_i$**\nThe heat transfer from the bulk fluid to the inner wall of the duct is governed by Newton's law of cooling:\n$$q = h_i A_i (T_b - T_{w,i})$$\nwhere $h_i$ is the internal convective heat transfer coefficient, $A_i = 2 \\pi r_i L$ is the inner surface area of the duct, and $T_{w,i}$ is the temperature of the inner wall. This relationship can be expressed in terms of a thermal resistance, $R_i$:\n$$q = \\frac{T_b - T_{w,i}}{R_i} \\quad \\implies \\quad R_i = \\frac{1}{h_i A_i} = \\frac{1}{2 \\pi r_i L h_i}$$\n\n**2. Wall Conduction Resistance, $R_w$**\nHeat is conducted radially outward through the cylindrical wall. For a hollow cylinder of length $L$, Fourier's law of conduction in cylindrical coordinates is:\n$$q = -k_w A(r) \\frac{dT}{dr} = -k_w (2 \\pi r L) \\frac{dT}{dr}$$\nSeparating variables and integrating from the inner radius $r_i$ (at temperature $T_{w,i}$) to the outer radius $r_o = r_i + t_w$ (at temperature $T_{w,o}$):\n$$\\int_{r_i}^{r_o} \\frac{dr}{r} = -\\frac{2 \\pi k_w L}{q} \\int_{T_{w,i}}^{T_{w,o}} dT$$\n$$\\ln\\left(\\frac{r_o}{r_i}\\right) = \\frac{2 \\pi k_w L}{q} (T_{w,i} - T_{w,o})$$\nThe conductive heat transfer rate is $q = \\frac{T_{w,i} - T_{w,o}}{R_w}$, which defines the wall conduction resistance as:\n$$R_w = \\frac{\\ln(r_o/r_i)}{2 \\pi k_w L}$$\n\n**3. External Convective Resistance, $R_{ext}$**\nThe outer surface transfers heat to the ambient air. This surface consists of the prime (unfinned) area, $A_p$, and the surface area of the $N$ fins. The total heat transfer from the outer surface is the sum of heat transfer from these two types of surfaces, both at a base temperature of $T_{w,o}$:\n$$q = q_p + q_f$$\nThe heat transfer from the prime area is:\n$$q_p = h_o A_p (T_{w,o} - T_{\\infty})$$\nThe prime area is the total outer area of the cylinder, $A_o = 2 \\pi r_o L$, minus the base area of the $N$ fins, $A_{b,f} = N \\pi a^2$.\n$$A_p = A_o - N \\pi a^2 = 2 \\pi r_o L - N \\pi a^2$$\nThe heat transfer from a single fin, $q_{fin}$, is given by $q_{fin} = \\eta_f q_{max}$, where $\\eta_f$ is the fin efficiency and $q_{max}$ is the ideal heat transfer if the entire fin were at the base temperature $T_{w,o}$.\n$$q_{max} = h_o A_f (T_{w,o} - T_{\\infty})$$\nHere, $A_f$ is the heat transfer surface area of a single fin. For a cylindrical pin fin with an adiabatic tip, this is the lateral surface area:\n$$A_f = (2 \\pi a) H_f$$\nThe total heat transfer from all $N$ fins is:\n$$q_f = N q_{fin} = N \\eta_f h_o A_f (T_{w,o} - T_{\\infty})$$\nTo find the fin efficiency, $\\eta_f$, we must solve the 1D steady-state fin equation derived from an energy balance on a differential element of the fin:\n$$\\frac{d^2\\theta}{dx^2} - m^2 \\theta = 0$$\nwhere $\\theta(x) = T(x) - T_{\\infty}$ is the excess temperature, $x$ is the coordinate along the fin axis, and $m = \\sqrt{\\frac{h_o P}{k_f A_c}}$. For a cylindrical fin, the perimeter is $P=2\\pi a$ and the cross-sectional area is $A_c = \\pi a^2$, so:\n$$m = \\sqrt{\\frac{h_o (2\\pi a)}{k_f (\\pi a^2)}} = \\sqrt{\\frac{2h_o}{k_f a}}$$\nThe boundary conditions are:\n1. Base temperature: $\\theta(0) = T_{w,o} - T_{\\infty} = \\theta_b$.\n2. Adiabatic tip: $\\frac{d\\theta}{dx}\\bigg|_{x=H_f} = 0$.\nThe solution to the differential equation with these boundary conditions is $\\theta(x) = \\theta_b \\frac{\\cosh(m(H_f - x))}{\\cosh(mH_f)}$.\nThe heat transfer rate from the fin is the heat conducted into its base at $x=0$:\n$$q_{fin} = -k_f A_c \\frac{d\\theta}{dx}\\bigg|_{x=0} = -k_f A_c \\left( -\\theta_b m \\frac{\\sinh(mH_f)}{\\cosh(mH_f)} \\right) = \\theta_b \\sqrt{h_o P k_f A_c} \\tanh(mH_f)$$\nThe fin efficiency is defined as $\\eta_f = \\frac{q_{fin}}{q_{max}} = \\frac{q_{fin}}{h_o A_f \\theta_b}$.\n$$\\eta_f = \\frac{\\sqrt{h_o P k_f A_c} \\tanh(mH_f)}{h_o P H_f \\theta_b} \\frac{\\theta_b}{\\theta_b} = \\frac{\\sqrt{k_f A_c/(h_o P)}}{H_f} \\tanh(mH_f) = \\frac{1/m}{H_f} \\tanh(mH_f) = \\frac{\\tanh(mH_f)}{mH_f}$$\nThe total heat transfer from the external surface is:\n$$q = h_o A_p (T_{w,o} - T_{\\infty}) + N \\eta_f h_o A_f (T_{w,o} - T_{\\infty}) = h_o (A_p + N \\eta_f A_f) (T_{w,o} - T_{\\infty})$$\nThis can be written as $q = \\frac{T_{w,o} - T_{\\infty}}{R_{ext}}$, which defines the equivalent external convective resistance:\n$$R_{ext} = \\frac{1}{h_o (A_p + N \\eta_f A_f)} = \\frac{1}{h_o [ (2 \\pi r_o L - N \\pi a^2) + N \\eta_f (2 \\pi a H_f) ]}$$\n\nThe thermal resistance network is a series of three resistances:\n$T_b \\xrightarrow{R_i} T_{w,i} \\xrightarrow{R_w} T_{w,o} \\xrightarrow{R_{ext}} T_{\\infty}$\nThe total resistance is $R_{total} = R_i + R_w + R_{ext}$.\n\n### Part 2: Derivation of the Overall Heat Transfer Coefficient, $U_o$\n\nThe total heat transfer rate is defined by $q = \\frac{T_b - T_{\\infty}}{R_{total}}$. The overall heat transfer coefficient based on the outer area, $U_o$, is defined by $q = U_o A_o (T_b - T_{\\infty})$.\nEquating these two expressions for $q$ gives:\n$$U_o A_o = \\frac{1}{R_{total}} = \\frac{1}{R_i + R_w + R_{ext}}$$\n$$U_o = \\frac{1}{A_o (R_i + R_w + R_{ext})} = \\frac{1}{A_o R_i + A_o R_w + A_o R_{ext}}$$\nWe can evaluate each term in the denominator:\n$$A_o R_i = (2 \\pi r_o L) \\left( \\frac{1}{2 \\pi r_i L h_i} \\right) = \\frac{r_o}{r_i h_i}$$\n$$A_o R_w = (2 \\pi r_o L) \\left( \\frac{\\ln(r_o/r_i)}{2 \\pi k_w L} \\right) = \\frac{r_o \\ln(r_o/r_i)}{k_w}$$\n$$A_o R_{ext} = \\frac{A_o}{h_o (A_p + N \\eta_f A_f)} = \\frac{2 \\pi r_o L}{h_o [ (2 \\pi r_o L - N \\pi a^2) + N \\eta_f (2 \\pi a H_f) ]}$$\nThe expression for $U_o$ is the inverse of the sum of these terms, which represent the total thermal resistance per unit outer surface area:\n$$U_o = \\left( \\frac{r_o}{r_i h_i} + \\frac{r_o \\ln(r_o/r_i)}{k_w} + \\frac{A_o}{h_o (A_p + N \\eta_f A_f)} \\right)^{-1}$$\nwhere $A_o = 2 \\pi r_o L$, $A_p = A_o - N\\pi a^2$, $A_f = 2 \\pi a H_f$, and $\\eta_f = \\frac{\\tanh(mH_f)}{mH_f}$ with $m = \\sqrt{\\frac{2h_o}{k_f a}}$.\n\n### Part 3: Numerical Computation of $U_o$\n\nThe given parameters are:\n$L = 1.5$ m, $r_i = 0.025$ m, $t_w = 0.003$ m, $k_w = 16$ W m$^{-1}$ K$^{-1}$, $h_i = 800$ W m$^{-2}$ K$^{-1}$, $h_o = 12$ W m$^{-2}$ K$^{-1}$, $N = 132$, $a = 0.002$ m, $H_f = 0.015$ m, $k_f = 200$ W m$^{-1}$ K$^{-1}$.\n\nFirst, we calculate the geometric and fin parameters.\nOuter radius: $r_o = r_i + t_w = 0.025 + 0.003 = 0.028$ m.\nFin parameter $m$:\n$$m = \\sqrt{\\frac{2 h_o}{k_f a}} = \\sqrt{\\frac{2(12)}{200(0.002)}} = \\sqrt{\\frac{24}{0.4}} = \\sqrt{60} \\approx 7.74597 \\text{ m}^{-1}$$\nProduct $mH_f$:\n$$mH_f = \\sqrt{60} \\times 0.015 \\approx 0.116190$$\nFin efficiency $\\eta_f$:\n$$\\eta_f = \\frac{\\tanh(mH_f)}{mH_f} = \\frac{\\tanh(0.116190)}{0.116190} = \\frac{0.115688}{0.116190} \\approx 0.99568$$\nNext, we calculate the areas:\nOuter surface area (without fins): $A_o = 2 \\pi r_o L = 2 \\pi (0.028)(1.5) \\approx 0.263894$ m$^2$.\nTotal fin base area: $N A_c = N (\\pi a^2) = 132 \\times \\pi (0.002)^2 \\approx 0.0016588$ m$^2$.\nPrime area: $A_p = A_o - N A_c = 0.263894 - 0.0016588 \\approx 0.262235$ m$^2$.\nTotal fin lateral area: $N A_f = N (2 \\pi a H_f) = 132 \\times 2 \\pi (0.002)(0.015) \\approx 0.024881$ m$^2$.\n\nNow, we compute the individual resistance terms for the $\\frac{1}{U_o}$ expression (total resistance per unit outer area, $R''_{total}$):\n$$R''_{i,o} = \\frac{r_o}{r_i h_i} = \\frac{0.028}{0.025 \\times 800} = \\frac{0.028}{20} = 0.0014 \\text{ m}^2\\text{K/W}$$\n$$R''_{w,o} = \\frac{r_o \\ln(r_o/r_i)}{k_w} = \\frac{0.028 \\ln(0.028/0.025)}{16} = \\frac{0.028 \\ln(1.12)}{16} \\approx \\frac{0.028(0.113329)}{16} \\approx 0.0001983 \\text{ m}^2\\text{K/W}$$\n$$R''_{ext,o} = \\frac{A_o}{h_o (A_p + N \\eta_f A_f)} = \\frac{0.263894}{12 \\times (0.262235 + 0.99568 \\times 0.024881)} = \\frac{0.263894}{12 \\times (0.262235 + 0.024775)} = \\frac{0.263894}{12 \\times 0.28701} \\approx 0.076621 \\text{ m}^2\\text{K/W}$$\nThe total resistance per unit outer area is:\n$$R''_{total} = \\frac{1}{U_o} = R''_{i,o} + R''_{w,o} + R''_{ext,o} = 0.0014 + 0.0001983 + 0.076621 = 0.0782193 \\text{ m}^2\\text{K/W}$$\nThe overall heat transfer coefficient is:\n$$U_o = \\frac{1}{R''_{total}} = \\frac{1}{0.0782193} \\approx 12.7846 \\text{ W m}^{-2}\\text{K}^{-1}$$\nRounding to four significant figures, we get $U_o = 12.78$ W m$^{-2}$ K$^{-1}$.",
            "answer": "$$\n\\boxed{12.78}\n$$"
        },
        {
            "introduction": "While analytical models are powerful, most industrial flows are turbulent, necessitating the use of well-validated empirical correlations. This exercise moves from analytical derivation to the computational implementation of such models for turbulent heat transfer in a duct . You will implement the canonical Gnielinski correlation, which first requires numerically solving the implicit Colebrook equation for the friction factor, and then explore the model's sensitivity to the turbulent Prandtl number, a key parameter in turbulence modeling for heat transfer.",
            "id": "3955575",
            "problem": "Consider fully developed, turbulent, forced convection of a single-phase Newtonian fluid in a straight, circular duct of constant diameter, with uniform wall heat flux and negligible axial conduction. The flow is statistically steady and incompressible. You will compute the dimensionless heat transfer using a canonical correlation that links momentum and heat transfer for turbulent internal flow, and incorporate the turbulent friction factor obtained from an implicit smooth-to-rough wall relation. Then, you will augment the heat-transfer correlation with a sensitivity model based on an eddy-diffusivity closure involving the turbulent Prandtl number, and quantify the sensitivity with respect to the turbulent Prandtl number.\n\nFundamental base and definitions to be used:\n- Conservation of momentum and energy in turbulent internal flow, represented by Reynolds-averaged equations.\n- The Reynolds number is defined as $Re = \\dfrac{\\rho U D}{\\mu}$, the Prandtl number as $Pr = \\dfrac{\\nu}{\\alpha}$, and the turbulent Prandtl number as $Pr_t = \\dfrac{\\nu_t}{\\alpha_t}$, where $\\nu = \\mu/\\rho$ is the kinematic viscosity, $\\alpha$ is the molecular thermal diffusivity, and $\\nu_t$, $\\alpha_t$ are turbulent transport coefficients obtained under an eddy diffusivity closure.\n- The Darcy friction factor $f_D$ for turbulent flow in a circular duct with relative roughness $\\varepsilon/D$ is obtained by solving the implicit Colebrook relation for $f_D$.\n- The heat-transfer correlation is the canonical turbulent forced-convection correlation for ducts that depends on $Re$, $Pr$, and $f_D$ in a nonlinearly coupled manner consistent with momentum–heat transfer analogy for internal flows. Do not use any shortcut formula not derived from this base in your reasoning.\n\nSensitivity model specification:\n- Assume a mixing-length eddy-viscosity closure with the von Kármán constant $\\kappa = 0.41$ in the logarithmic layer.\n- Let a representative non-dimensional wall distance be $y^+ = 30$ to characterize buffer/log-layer behavior.\n- Under these assumptions, approximate the ratio of turbulent to molecular momentum diffusivity at the representative location by $\\dfrac{\\nu_t}{\\nu} \\approx \\kappa y^+$.\n- Using $Pr = \\nu/\\alpha$ and $Pr_t = \\nu_t/\\alpha_t$, approximate the ratio of total to molecular thermal diffusivity at the representative location by $1 + \\dfrac{\\alpha_t}{\\alpha} = 1 + \\dfrac{\\nu_t/\\nu}{Pr_t/Pr} = 1 + \\kappa y^+ \\dfrac{Pr}{Pr_t}$.\n- Define a multiplicative correction factor to the temperature-log-law exponent contribution as $\\phi(Pr_t) = \\left(1 + \\kappa y^+ \\dfrac{Pr}{Pr_t}\\right)^{-2/3}$. This factor modifies the molecular-Prandtl-dependent part of the denominator in the canonical turbulent heat-transfer correlation for ducts.\n\nComputational tasks:\n1. For each test case, solve the Colebrook equation to obtain $f_D$ given $Re$ and $\\varepsilon/D$ in the turbulent regime. Assume the domain $3 \\times 10^3 \\le Re \\le 5 \\times 10^6$ and $0 \\le \\varepsilon/D \\le 5 \\times 10^{-3}$.\n2. Compute the baseline turbulent Nusselt number $Nu_{\\text{base}}$ using the canonical correlation for circular ducts that depends on $Re$, $Pr$, and $f_D$.\n3. Apply the sensitivity model by replacing the molecular-Prandtl-dependent exponent contribution in the denominator by its corrected value using $\\phi(Pr_t)$, and compute $Nu_{\\text{corr}}(Pr_t)$ at the nominal $Pr_t = 0.85$.\n4. Quantify sensitivity by computing the numerical derivative $\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}\\big|_{Pr_t=0.85}$ using a central finite difference with a small increment $\\Delta Pr_t = 0.05$.\n5. All inputs are dimensionless; all outputs are dimensionless. The Nusselt number is dimensionless. No angle units are involved.\n\nTest suite:\n- Case 1: $Re = 1.0 \\times 10^5$, $Pr = 0.7$, $\\varepsilon/D = 0.0$.\n- Case 2: $Re = 5.0 \\times 10^4$, $Pr = 7.0$, $\\varepsilon/D = 0.0$.\n- Case 3: $Re = 1.0 \\times 10^4$, $Pr = 100.0$, $\\varepsilon/D = 2.0 \\times 10^{-4}$.\n- Case 4: $Re = 3.0 \\times 10^3$, $Pr = 0.7$, $\\varepsilon/D = 0.0$.\n- Case 5: $Re = 3.0 \\times 10^4$, $Pr = 200.0$, $\\varepsilon/D = 5.0 \\times 10^{-4}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order for the five test cases:\n  $[Nu_{\\text{base}}^{(1)}, Nu_{\\text{corr}}^{(1)}, (\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t})^{(1)}, Nu_{\\text{base}}^{(2)}, Nu_{\\text{corr}}^{(2)}, (\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t})^{(2)}, \\dots, Nu_{\\text{base}}^{(5)}, Nu_{\\text{corr}}^{(5)}, (\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t})^{(5)}]$.\n- Present all numbers as floating-point values.",
            "solution": "The task is to compute the Nusselt number for turbulent forced convection in a circular duct and its sensitivity to the turbulent Prandtl number, based on a set of specified physical models and correlations.\n\n**Step 1: Darcy Friction Factor ($f_D$) Calculation**\n\nThe Darcy friction factor, $f_D$, for fully developed turbulent flow in a duct is determined by the Colebrook-White equation. This is an implicit correlation that relates $f_D$ to the Reynolds number, $Re$, and the relative roughness of the duct wall, $\\varepsilon/D$. The equation is given by:\n$$\n\\frac{1}{\\sqrt{f_D}} = -2.0 \\log_{10} \\left( \\frac{\\varepsilon/D}{3.7} + \\frac{2.51}{Re \\sqrt{f_D}} \\right)\n$$\nThis equation is transcendental and cannot be solved for $f_D$ analytically. Therefore, for each test case defined by a pair of ($Re$, $\\varepsilon/D$), a numerical root-finding algorithm must be employed. We define a function $g(f_D)$ such that finding the root of $g(f_D) = 0$ yields the desired value of $f_D$:\n$$\ng(f_D) = \\frac{1}{\\sqrt{f_D}} + 2.0 \\log_{10} \\left( \\frac{\\varepsilon/D}{3.7} + \\frac{2.51}{Re \\sqrt{f_D}} \\right)\n$$\nThis equation will be solved numerically for $f_D$ within a physically plausible range, for instance, $f_D \\in [0.001, 0.1]$.\n\n**Step 2: Baseline Nusselt Number ($Nu_{\\text{base}}$) Calculation**\n\nThe problem specifies the use of a \"canonical turbulent forced-convection correlation for ducts\" consistent with the momentum-heat transfer analogy. The Gnielinski correlation (1976) is the standard and most appropriate choice for the given conditions (fully developed turbulent flow in a circular duct with uniform heat flux, for $0.5 < Pr < 2000$ and $3 \\times 10^3 < Re < 5 \\times 10^6$). The baseline Nusselt number, $Nu_{\\text{base}}$, is calculated using this correlation:\n$$\nNu_{\\text{base}} = \\frac{(f_D/8)(Re-1000)Pr}{1 + 12.7\\sqrt{f_D/8}(Pr^{2/3}-1)}\n$$\nHere, $f_D$ is the value obtained from solving the Colebrook equation in Step 1, and $Re$ and $Pr$ are the Reynolds and Prandtl numbers for the specific test case.\n\n**Step 3: Corrected Nusselt Number ($Nu_{\\text{corr}}$) Calculation**\n\nThe problem introduces a sensitivity model to augment the heat transfer correlation. This model introduces a correction factor, $\\phi(Pr_t)$, which modifies the contribution of the molecular Prandtl number in the denominator of the Gnielinski correlation. The correction factor is defined as:\n$$\n\\phi(Pr_t) = \\left(1 + \\kappa y^+ \\frac{Pr}{Pr_t}\\right)^{-2/3}\n$$\nThe constants are provided as the von Kármán constant $\\kappa = 0.41$ and a representative non-dimensional wall distance $y^+ = 30$. The turbulent Prandtl number is $Pr_t$.\n\nThe problem states that $\\phi(Pr_t)$ is a \"multiplicative correction factor to the temperature-log-law exponent contribution.\" In the context of the Gnielinski correlation, this corresponds to the $Pr^{2/3}$ term. Thus, to obtain the corrected Nusselt number, $Nu_{\\text{corr}}$, we replace $Pr^{2/3}$ in the original formula with $Pr^{2/3} \\phi(Pr_t)$:\n$$\nNu_{\\text{corr}}(Pr_t) = \\frac{(f_D/8)(Re-1000)Pr}{1 + 12.7\\sqrt{f_D/8}\\left(Pr^{2/3}\\phi(Pr_t) - 1\\right)}\n$$\nFor computational task 3, this value is computed at the nominal turbulent Prandtl number $Pr_t = 0.85$.\n\n**Step 4: Sensitivity Calculation**\n\nThe sensitivity of the corrected Nusselt number with respect to the turbulent Prandtl number is quantified by the numerical derivative $\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}$, evaluated at $Pr_t = 0.85$. The problem specifies using a central finite difference scheme with an increment of $\\Delta Pr_t = 0.05$. The formula is:\n$$\n\\frac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}\\bigg|_{Pr_t=0.85} \\approx \\frac{Nu_{\\text{corr}}(0.85 + \\Delta Pr_t) - Nu_{\\text{corr}}(0.85 - \\Delta Pr_t)}{2 \\Delta Pr_t}\n$$\nSubstituting the given values, $Pr_t = 0.85$ and $\\Delta Pr_t = 0.05$, the derivative is approximated by:\n$$\n\\frac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}\\bigg|_{Pr_t=0.85} \\approx \\frac{Nu_{\\text{corr}}(0.90) - Nu_{\\text{corr}}(0.80)}{0.1}\n$$\nThis requires computing $Nu_{\\text{corr}}$ at two additional values of $Pr_t$: $0.80$ and $0.90$.\n\n**Summary of the Computational Procedure**\n\nFor each test case specified by a tuple of ($Re, Pr, \\varepsilon/D$):\n1.  Solve the Colebrook equation for $f_D$ using the given $Re$ and $\\varepsilon/D$.\n2.  Calculate $Nu_{\\text{base}}$ using the Gnielinski correlation with the computed $f_D$ and given $Re$ and $Pr$.\n3.  Calculate $Nu_{\\text{corr}}(Pr_t=0.85)$ using the modified Gnielinski correlation.\n4.  Calculate $Nu_{\\text{corr}}(Pr_t=0.80)$ and $Nu_{\\text{corr}}(Pr_t=0.90)$ using the same modified correlation.\n5.  Compute the sensitivity $\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}$ using the central difference formula with the values from the previous step.\n6.  Compile the three results ($Nu_{\\text{base}}$, $Nu_{\\text{corr}}(0.85)$, and the derivative) for each test case into a single list as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing baseline and corrected Nusselt numbers\n    for turbulent forced convection in a duct, along with a sensitivity analysis.\n    \"\"\"\n\n    # Define constants from the problem statement.\n    KAPPA = 0.41\n    Y_PLUS = 30.0\n    PR_T_NOMINAL = 0.85\n    DELTA_PR_T = 0.05\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0e5, 0.7, 0.0),          # Case 1\n        (5.0e4, 7.0, 0.0),          # Case 2\n        (1.0e4, 100.0, 2.0e-4),     # Case 3\n        (3.0e3, 0.7, 0.0),          # Case 4\n        (3.0e4, 200.0, 5.0e-4),     # Case 5\n    ]\n\n    def solve_colebrook(Re, rel_rough):\n        \"\"\"\n        Solves the Colebrook equation for the Darcy friction factor f_D.\n        \n        Args:\n            Re (float): Reynolds number.\n            rel_rough (float): Relative roughness (epsilon/D).\n            \n        Returns:\n            float: Darcy friction factor f_D.\n        \"\"\"\n        if not (Re > 2300): # Colebrook is for turbulent flow\n            return 64.0 / Re # Laminar flow, not strictly needed per problem spec\n            \n        # Colebrook equation rearranged to f(f_D) = 0\n        colebrook_func = lambda f_D: 1.0 / np.sqrt(f_D) + 2.0 * np.log10(\n            (rel_rough / 3.7) + (2.51 / (Re * np.sqrt(f_D)))\n        )\n        \n        # Using root_scalar to find the root of the function.\n        # A bracket of [0.001, 0.1] is safe for turbulent flow friction factors.\n        sol = root_scalar(colebrook_func, bracket=[0.001, 0.1], method='brentq')\n        return sol.root\n\n    def calculate_nusselt(Re, Pr, f_D, Pr_t=None):\n        \"\"\"\n        Calculates the Nusselt number using the Gnielinski correlation, with an\n        optional correction based on the turbulent Prandtl number.\n\n        Args:\n            Re (float): Reynolds number.\n            Pr (float): Prandtl number.\n            f_D (float): Darcy friction factor.\n            Pr_t (float, optional): Turbulent Prandtl number. If None, computes\n                                    the baseline Nu. Otherwise, computes the\n                                    corrected Nu.\n\n        Returns:\n            float: Nusselt number.\n        \"\"\"\n        # Common term in Gnielinski correlation\n        f_term = f_D / 8.0\n        \n        # Calculate the molecular prandtl number contribution\n        pr_term_base = Pr**(2.0/3.0)\n        \n        pr_term_modified = pr_term_base\n        if Pr_t is not None:\n            # Apply the sensitivity model correction factor phi(Pr_t)\n            phi = (1.0 + KAPPA * Y_PLUS * Pr / Pr_t)**(-2.0/3.0)\n            pr_term_modified *= phi\n            \n        numerator = f_term * (Re - 1000.0) * Pr\n        denominator = 1.0 + 12.7 * np.sqrt(f_term) * (pr_term_modified - 1.0)\n        \n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        Re, Pr, rel_rough = case\n        \n        # 1. Solve for Darcy friction factor\n        f_D = solve_colebrook(Re, rel_rough)\n        \n        # 2. Compute baseline Nusselt number\n        Nu_base = calculate_nusselt(Re, Pr, f_D)\n        \n        # 3. Compute corrected Nusselt number at the nominal Pr_t\n        Nu_corr_nominal = calculate_nusselt(Re, Pr, f_D, Pr_t=PR_T_NOMINAL)\n        \n        # 4. Compute corrected Nu for finite difference calculation\n        Pr_t_plus = PR_T_NOMINAL + DELTA_PR_T\n        Pr_t_minus = PR_T_NOMINAL - DELTA_PR_T\n        \n        Nu_corr_plus = calculate_nusselt(Re, Pr, f_D, Pr_t=Pr_t_plus)\n        Nu_corr_minus = calculate_nusselt(Re, Pr, f_D, Pr_t=Pr_t_minus)\n        \n        # 5. Compute the sensitivity using central finite difference\n        dNu_dPr_t = (Nu_corr_plus - Nu_corr_minus) / (2.0 * DELTA_PR_T)\n        \n        results.extend([Nu_base, Nu_corr_nominal, dNu_dPr_t])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The most fundamental approach in computational thermal engineering is the direct numerical solution of the governing conservation equations. In this capstone practice, you will develop a finite difference solver for the 2D energy equation in a microchannel, including the critical effects of viscous dissipation . This exercise will demonstrate how complex and sometimes non-intuitive phenomena, such as near-wall temperature overshoot due to viscous heating at low Péclet and high Brinkman numbers, can be captured and analyzed with a custom-built numerical tool.",
            "id": "3955530",
            "problem": "Consider a two-dimensional, steady, incompressible, fully developed laminar flow of a Newtonian fluid in a planar microchannel of half-height $h$ and length $L$. The axial coordinate is $x \\in [0,L]$ and the transverse coordinate is $y \\in [0,h]$, where $y=0$ is the centerline and $y=h$ is the wall. The axial velocity profile is given by the classical plane Poiseuille solution $u(y) = u_{\\max} \\left(1 - \\left(\\frac{y}{h}\\right)^2\\right)$, where $u_{\\max} = \\frac{3}{2} U$ and $U$ is the cross-sectional average velocity. Assume constant properties: density $\\rho$, specific heat at constant pressure $c_p$, dynamic viscosity $\\mu$, and thermal conductivity $k$. Viscous heating enters the energy equation through the volumetric source term $\\mu \\left(\\frac{du}{dy}\\right)^2$. Axial conduction is retained, and the thermally fully developed assumption is not invoked. The temperature field $T(x,y)$ satisfies the steady energy equation\n$$\n\\rho c_p u(y) \\frac{\\partial T}{\\partial x} = k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) + \\mu \\left( \\frac{du}{dy} \\right)^2,\n$$\nwith boundary conditions\n$$\nT(0,y) = T_{\\mathrm{in}}, \\quad T(x,h) = T_w, \\quad \\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0} = 0, \\quad \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} = 0.\n$$\nThe last condition enforces a zero axial temperature gradient at the outlet. The derivative of the velocity profile is $\\frac{du}{dy} = -\\frac{2 u_{\\max} y}{h^2}$, and thus the viscous dissipation source term is $\\mu \\left(\\frac{du}{dy}\\right)^2 = \\mu \\frac{4 u_{\\max}^2 y^2}{h^4}$. The thermal Peclet number (Pe) and Brinkman number (Br) are defined, respectively, as\n$$\n\\mathrm{Pe} = \\frac{\\rho c_p U h}{k}, \\qquad \\mathrm{Br} = \\frac{\\mu U^2}{k \\Delta T_{\\mathrm{ref}}},\n$$\nwhere $\\Delta T_{\\mathrm{ref}}$ is a chosen temperature scale; for reporting purposes in this problem, use $\\Delta T_{\\mathrm{ref}} = 1\\,\\mathrm{K}$. The objective is to compute the near-wall temperature overshoot due to viscous heating at high $\\mathrm{Br}$ and low $\\mathrm{Pe}$, defined as\n$$\n\\Delta T_{\\mathrm{overshoot}} = \\max_{x \\in [0,L],\\, y \\in [y_*, h)} \\left( T(x,y) - T_w \\right),\n$$\nwhere $y_* = h - \\alpha h$ with $\\alpha = 0.1$ specifies a thin near-wall layer (the region $y \\in [0.9 h, h)$). Express the overshoot in kelvin (K) as a real number. The computational approach must solve the above boundary value problem numerically on a uniform grid using finite differences with scientifically sound discretization and convergence criteria.\n\nStarting from the conservation of energy, and incorporating the given velocity field and viscous dissipation, derive the appropriate discrete equations and implement them to compute $\\Delta T_{\\mathrm{overshoot}}$ for the following test suite of physically plausible microchannel cases, all with $T_{\\mathrm{in}} = T_w = 300\\,\\mathrm{K}$ so that any increase in temperature is solely due to viscous heating:\n\n- Case A (happy path, low $\\mathrm{Pe}$, moderate $\\mathrm{Br}$, oil-like fluid):\n  - $\\rho = 900\\,\\mathrm{kg/m^3}$, $c_p = 2000\\,\\mathrm{J/(kg\\,K)}$, $\\mu = 0.20\\,\\mathrm{Pa\\,s}$, $k = 0.14\\,\\mathrm{W/(m\\,K)}$, $U = 0.002\\,\\mathrm{m/s}$, $h = 50\\,\\mu\\mathrm{m}$, $L = 5\\,\\mathrm{mm}$.\n- Case B (boundary, $\\mathrm{Pe} = 0$ effectively, no viscous heating):\n  - $\\rho = 1000\\,\\mathrm{kg/m^3}$, $c_p = 4180\\,\\mathrm{J/(kg\\,K)}$, $\\mu = 0.001\\,\\mathrm{Pa\\,s}$, $k = 0.60\\,\\mathrm{W/(m\\,K)}$, $U = 0\\,\\mathrm{m/s}$, $h = 50\\,\\mu\\mathrm{m}$, $L = 5\\,\\mathrm{mm}$.\n- Case C (edge, higher $\\mathrm{Pe}$, low $\\mathrm{Br}$, water-like fluid):\n  - $\\rho = 1000\\,\\mathrm{kg/m^3}$, $c_p = 4180\\,\\mathrm{J/(kg\\,K)}$, $\\mu = 0.001\\,\\mathrm{Pa\\,s}$, $k = 0.60\\,\\mathrm{W/(m\\,K)}$, $U = 0.05\\,\\mathrm{m/s}$, $h = 50\\,\\mu\\mathrm{m}$, $L = 5\\,\\mathrm{mm}$.\n- Case D (high $\\mathrm{Br}$ and low-to-moderate $\\mathrm{Pe}$, glycerol-like fluid):\n  - $\\rho = 1260\\,\\mathrm{kg/m^3}$, $c_p = 2400\\,\\mathrm{J/(kg\\,K)}$, $\\mu = 1.50\\,\\mathrm{Pa\\,s}$, $k = 0.285\\,\\mathrm{W/(m\\,K)}$, $U = 0.002\\,\\mathrm{m/s}$, $h = 50\\,\\mu\\mathrm{m}$, $L = 5\\,\\mathrm{mm}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $\\left[\\Delta T_{\\mathrm{overshoot}}^{\\mathrm{A}}, \\Delta T_{\\mathrm{overshoot}}^{\\mathrm{B}}, \\Delta T_{\\mathrm{overshoot}}^{\\mathrm{C}}, \\Delta T_{\\mathrm{overshoot}}^{\\mathrm{D}}\\right]$, for the above four cases. Each value must be a floating-point number in kelvin, accurate to at least three significant figures.\n\nAnswer in kelvin (K). Angles are not used. No percentages appear in this problem.",
            "solution": "The temperature field $T(x,y)$ is governed by the steady-state energy equation for an incompressible fluid with constant properties, including viscous dissipation:\n$$\n\\rho c_p u(y) \\frac{\\partial T}{\\partial x} = k \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) + \\mu \\left( \\frac{du}{dy} \\right)^2\n$$\nThe velocity profile $u(y)$ is the plane Poiseuille solution $u(y) = u_{\\max} \\left(1 - (y/h)^2\\right)$, where $u_{\\max} = \\frac{3}{2}U$. The viscous heating source term is $Q(y) = \\mu \\left( \\frac{du}{dy} \\right)^2 = \\mu \\frac{4 u_{\\max}^2 y^2}{h^4}$.\nThe boundary conditions are:\n1. Inlet: $T(0,y) = T_{\\mathrm{in}}$\n2. Wall: $T(x,h) = T_w$\n3. Centerline (symmetry): $\\left.\\frac{\\partial T}{\\partial y}\\right|_{y=0} = 0$\n4. Outlet: $\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} = 0$\n\nThis elliptic partial differential equation is solved numerically using the finite difference method on a uniform two-dimensional grid. The domain $[0,L] \\times [0,h]$ is discretized into a grid of points $(x_i, y_j)$, where $x_i = i \\Delta x$ for $i \\in \\{0, 1, \\dots, N_x\\}$ and $y_j = j \\Delta y$ for $j \\in \\{0, 1, \\dots, N_y\\}$. Here, $\\Delta x = L/N_x$ and $\\Delta y = h/N_y$. The temperature at a grid point is denoted by $T_{i,j} = T(x_i, y_j)$.\n\nAll spatial derivatives in the governing equation are approximated using second-order central difference schemes. For an interior node $(i,j)$, where $i \\in \\{1, \\dots, N_x-1\\}$ and $j \\in \\{1, \\dots, N_y-1\\}$, the discretized equation is:\n$$\n\\rho c_p u_j \\left(\\frac{T_{i+1,j} - T_{i-1,j}}{2 \\Delta x}\\right) = k \\left( \\frac{T_{i+1,j} - 2T_{i,j} + T_{i-1,j}}{(\\Delta x)^2} + \\frac{T_{i,j+1} - 2T_{i,j} + T_{i,j-1}}{(\\Delta y)^2} \\right) + Q_j\n$$\nwhere $u_j = u(y_j)$ and $Q_j = Q(y_j)$. Rearranging this equation for the unknown temperature $T_{i,j}$ and its neighbors gives a linear algebraic equation:\n$$\nT_{i,j} \\left( \\frac{2k}{(\\Delta x)^2} + \\frac{2k}{(\\Delta y)^2} \\right) + T_{i+1,j} \\left( -\\frac{\\rho c_p u_j}{2 \\Delta x} - \\frac{k}{(\\Delta x)^2} \\right) + T_{i-1,j} \\left( \\frac{\\rho c_p u_j}{2 \\Delta x} - \\frac{k}{(\\Delta x)^2} \\right) + T_{i,j+1} \\left( -\\frac{k}{(\\Delta y)^2} \\right) + T_{i,j-1} \\left( -\\frac{k}{(\\Delta y)^2} \\right) = -Q_j\n$$\nThis equation forms the basis of a system of linear equations, $A\\mathbf{T} = \\mathbf{b}$, where $\\mathbf{T}$ is a vector of all unknown temperatures.\n\nThe boundary conditions are incorporated as follows:\n- **Centerline ($j=0$):** The symmetry condition $\\frac{\\partial T}{\\partial y}=0$ is implemented using a ghost node at $j=-1$ such that $T_{i,-1} = T_{i,1}$. The second derivative term becomes $\\frac{\\partial^2 T}{\\partial y^2} \\approx \\frac{2(T_{i,1} - T_{i,0})}{(\\Delta y)^2}$. The resulting discrete equation for a node $(i,0)$ is:\n$$\nT_{i,0} \\left( \\frac{2k}{(\\Delta x)^2} + \\frac{2k}{(\\Delta y)^2} \\right) + T_{i+1,0} \\left(-\\frac{\\rho c_p u_0}{2 \\Delta x} - \\frac{k}{(\\Delta x)^2}\\right) + T_{i-1,0} \\left(\\frac{\\rho c_p u_0}{2 \\Delta x} - \\frac{k}{(\\Delta x)^2}\\right) + T_{i,1} \\left(-\\frac{2k}{(\\Delta y)^2}\\right) = -Q_0\n$$\nNote that $Q_0=0$ since the velocity gradient is zero at the centerline.\n\n- **Outlet ($i=N_x$):** The zero-gradient condition $\\frac{\\partial T}{\\partial x}=0$ is implemented with a ghost node at $i=N_x+1$ such that $T_{N_x+1,j} = T_{N_x-1,j}$. This substitution simplifies the advection term to zero and modifies the axial diffusion term. The discrete equation for a node $(N_x,j)$ becomes:\n$$\nT_{N_x,j} \\left( \\frac{2k}{(\\Delta x)^2} + \\frac{2k}{(\\Delta y)^2} \\right) + T_{N_x-1,j} \\left(-\\frac{2k}{(\\Delta x)^2}\\right) + T_{N_x,j+1} \\left(-\\frac{k}{(\\Delta y)^2}\\right) + T_{N_x,j-1} \\left(-\\frac{k}{(\\Delta y)^2}\\right) = -Q_j\n$$\n\n- **Dirichlet Boundaries ($i=0$ and $j=N_y$):** The temperatures $T_{0,j} = T_{\\mathrm{in}}$ and $T_{i,N_y} = T_w$ are known. For equations involving nodes adjacent to these boundaries (i.e., at $i=1$ or $j=N_y-1$), the terms containing these known temperatures are moved to the right-hand side, becoming part of the vector $\\mathbf{b}$.\n\nThe unknown temperatures are those at nodes $(i,j)$ for $i \\in \\{1, \\dots, N_x\\}$ and $j \\in \\{0, \\dots, N_y-1\\}$. These nodes are mapped to a single vector $\\mathbf{T}$ of size $N_x \\times N_y$. A large, sparse matrix $A$ and a vector $\\mathbf{b}$ are constructed based on the discretized equations for all unknown nodes. The resulting linear system is solved efficiently using a direct sparse solver, specifically `scipy.sparse.linalg.spsolve`.\n\nAfter solving for the unknown temperatures, the solution vector $\\mathbf{T}$ is reshaped into a $N_x \\times N_y$ array. This solution is then combined with the known boundary temperatures to form the complete temperature field on the full $(N_x+1) \\times (N_y+1)$ grid.\n\nFinally, the near-wall temperature overshoot, $\\Delta T_{\\mathrm{overshoot}}$, is computed according to its definition:\n$$\n\\Delta T_{\\mathrm{overshoot}} = \\max_{x \\in [0,L],\\, y \\in [y_*, h)} \\left( T(x,y) - T_w \\right)\n$$\nwhere $y_* = 0.9h$. This is found by taking the maximum value of $(T_{i,j} - T_w)$ over the discrete domain $i \\in \\{0, \\dots, N_x\\}$ and $j \\in \\{j_*, \\dots, N_y-1\\}$, where $j_* = \\mathrm{round}(0.9 N_y)$.\n\nFor Case B, where the average velocity $U=0\\,\\mathrm{m/s}$, the velocity profile $u(y)$ is identically zero everywhere. Consequently, the advection term $\\rho c_p u \\frac{\\partial T}{\\partial x}$ and the viscous dissipation term $\\mu (\\frac{du}{dy})^2$ both vanish. The energy equation reduces to Laplace's equation, $\\nabla^2 T = 0$. Given the boundary conditions $T(0,y) = T_{\\mathrm{in}} = 300\\,\\mathrm{K}$ and $T(x,h) = T_w = 300\\,\\mathrm{K}$, with zero-flux conditions on the other two boundaries, the unique solution is a uniform temperature field $T(x,y) = 300\\,\\mathrm{K}$. Thus, the temperature overshoot must be exactly $0\\,\\mathrm{K}$. This serves as a validation for the numerical implementation. Other cases involve non-zero flow and dissipation, leading to non-trivial temperature fields and potentially non-zero overshoots.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse.linalg import spsolve\n\ndef solve_case(params):\n    \"\"\"\n    Solves the 2D steady-state energy equation for flow in a microchannel.\n    \"\"\"\n    rho, cp, mu, k_th, U, h, L, T_in, T_w = params\n\n    # Grid parameters\n    Nx = 250  # Number of grid points in x-direction\n    Ny = 50   # Number of grid points in y-direction (in the half-height)\n\n    dx = L / Nx\n    dy = h / Ny\n\n    # Grid coordinates\n    x = np.linspace(0, L, Nx + 1)\n    y = np.linspace(0, h, Ny + 1)\n\n    # Velocity profile and viscous dissipation source term\n    u_max = 1.5 * U\n    \n    # Evaluate at y_j for j=0..Ny-1\n    y_nodes = y[:Ny]\n    u_profile = u_max * (1 - (y_nodes / h)**2)\n    \n    # du/dy = -2 * u_max * y / h^2\n    # Q(y) = mu * (du/dy)^2 = mu * 4 * u_max^2 * y^2 / h^4\n    Q_source = mu * 4 * u_max**2 * y_nodes**2 / h**4\n\n    # Special case: no flow\n    if U == 0:\n        return 0.0\n\n    # System size\n    num_unknowns = Nx * Ny\n    A = sparse.lil_matrix((num_unknowns, num_unknowns))\n    b = np.zeros(num_unknowns)\n\n    # Populate the A matrix and b vector\n    # Unknowns are T_ij for i in [1, Nx] and j in [0, Ny-1]\n    # Mapping from (i, j) to 1D index k: k = (i - 1) * Ny + j\n    for i in range(1, Nx + 1):\n        for j in range(Ny):\n            k_idx = (i - 1) * Ny + j\n            \n            # --- Source term ---\n            b[k_idx] = -Q_source[j]\n\n            # --- Central diagonal coefficient for T_ij ---\n            # Default value, modified by Neumann boundaries\n            A[k_idx, k_idx] = 2 * k_th / dx**2 + 2 * k_th / dy**2\n\n            # --- T_{i+1,j} coefficient ---\n            if i < Nx:\n                u_j = u_profile[j]\n                A[k_idx, k_idx + Ny] = -rho * cp * u_j / (2 * dx) - k_th / dx**2\n            # At i=Nx (outlet), the grad T = 0 condition means no T_{i+1,j} term.\n            \n            # --- T_{i-1,j} coefficient ---\n            if i > 1:\n                u_j = u_profile[j]\n                A[k_idx, k_idx - Ny] = rho * cp * u_j / (2 * dx) - k_th / dx**2\n            elif i == 1: # Inlet boundary\n                u_j = u_profile[j]\n                b[k_idx] -= (rho * cp * u_j / (2 * dx) - k_th / dx**2) * T_in\n\n            # --- T_{i,j+1} coefficient ---\n            if j < Ny - 1:\n                A[k_idx, k_idx + 1] = -k_th / dy**2\n            elif j == Ny - 1: # Wall boundary\n                b[k_idx] -= (-k_th / dy**2) * T_w\n\n            # --- T_{i,j-1} coefficient ---\n            if j > 0:\n                A[k_idx, k_idx - 1] = -k_th / dy**2\n            # At j=0 (centerline), symmetry requires special handling below.\n\n    # Apply special boundary conditions by overwriting rows\n    \n    # Centerline (j=0)\n    for i in range(1, Nx + 1):\n        k_idx = (i - 1) * Ny + 0\n        u_0 = u_profile[0]\n        # Modify T_{i,1} coefficient and remove T_{i,-1} term\n        # The equation for T_i,0 involves T_i,1, so the change is at T_i,1's coefficient\n        # From derivation: A_i,1 coeff is -2k/dy^2\n        A[k_idx, k_idx + 1] = -2 * k_th / dy**2\n\n    # Outlet (i=Nx)\n    for j in range(Ny):\n        k_idx = (Nx - 1) * Ny + j\n        # Modify T_{i-1,j} coefficient and remove T_{i+1,j} term\n        # From derivation: A_i-1,j coeff is -2k/dx^2\n        if i > 1: # Should always be true since i=Nx\n          A[k_idx, k_idx - Ny] = -2 * k_th / dx**2\n        \n    # Solve the system\n    A = A.tocsr()\n    T_sol = spsolve(A, b)\n\n    # Reconstruct the full temperature field\n    T_full = np.full((Nx + 1, Ny + 1), T_in)\n    T_full[:, Ny] = T_w\n    \n    T_unknowns = T_sol.reshape((Nx, Ny))\n    T_full[1:, :Ny] = T_unknowns\n\n    # Calculate overshoot\n    j_star = int(0.9 * Ny)\n    # Search region is y in [0.9h, h), corresponding to j in [j_star, Ny-1]\n    # x is over the entire domain, i in [0, Nx]\n    near_wall_region = T_full[:, j_star:Ny]\n    \n    # Ensure region is not empty\n    if near_wall_region.size == 0:\n        return 0.0\n\n    delta_T_overshoot = np.max(near_wall_region - T_w)\n    \n    # Return non-negative overshoot\n    return max(0.0, delta_T_overshoot)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # (rho, cp, mu, k, U, h, L)\n    # Common params\n    T_in = 300.0  # K\n    T_w = 300.0   # K\n    h_val = 50e-6 # m\n    L_val = 5e-3  # m\n\n    test_cases = [\n        # Case A: oil-like\n        (900.0, 2000.0, 0.20, 0.14, 0.002, h_val, L_val, T_in, T_w),\n        # Case B: water-like, U=0\n        (1000.0, 4180.0, 0.001, 0.60, 0.0, h_val, L_val, T_in, T_w),\n        # Case C: water-like, U=0.05\n        (1000.0, 4180.0, 0.001, 0.60, 0.05, h_val, L_val, T_in, T_w),\n        # Case D: glycerol-like\n        (1260.0, 2400.0, 1.50, 0.285, 0.002, h_val, L_val, T_in, T_w),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_case(case)\n        results.append(f\"{result:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}