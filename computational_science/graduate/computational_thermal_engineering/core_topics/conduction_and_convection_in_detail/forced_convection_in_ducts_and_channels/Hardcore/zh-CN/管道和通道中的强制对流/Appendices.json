{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的计算流体动力学（CFD）仿真之前，掌握基于基本原理的分析建模至关重要。本练习将通过构建一个包含内部对流、管壁导热以及外部翅片强化对流的综合热阻网络，来巩固您的基础知识。通过这种方式，您将学会如何将不同的传热模式系统地整合到一个统一的模型中，这是所有热系统设计与分析的基石 。",
            "id": "3955569",
            "problem": "一根长度为 $L$ 的圆形管道输送一种主体温度为 $T_b$ 的热流体，并经历稳态、充分发展的内部强制对流。该管道的内半径为 $r_i$，壁厚为 $t_w$，因此外半径为 $r_o = r_i + t_w$。管壁是均匀的，其导热系数为 $k_w$。管道的外表面装有一组由 $N$ 个相同的、均匀分布的圆柱形针状翅片（圆杆）组成的阵列，翅片半径为 $a$，高度为 $H_f$，由导热系数为 $k_f$ 的材料制成。周围环境温度均匀为 $T_{\\infty}$，外部流动在所有暴露表面上产生均匀的外部对流换热系数 $h_o$。内壁处的内部对流系数为 $h_i$。假设壁和翅片中的轴向导热可忽略不计，处于稳态，且翅片尖端是绝热的。翅片附着在圆柱形外壁上，每个翅片的基底温度等于外壁在 $r_o$ 处的温度。将翅片视为一维扩展表面，仅沿其侧表面与环境进行热交换（根据绝热尖端假设，无尖端对流）。\n\n仅从牛顿冷却定律和傅里叶导热定律的基本定义出发，并通过对翅片进行微分能量平衡来严格处理扩展表面效应，完成以下任务：\n\n1. 推导一个热阻网络，该网络通过三个串联元件将主体流体温度 $T_b$ 连接到环境温度 $T_{\\infty}$：管道内的内部对流、通过圆柱壁的径向导热以及由针状翅片增强的外部对流。明确地用一个考虑了翅片效率的有效外部面积来表示等效外部对流热阻。\n\n2. 根据你的热阻网络，推导基于外圆柱面积的总结传热系数 $U_o$ 的符号表达式，该系数由关系式 $q = U_o A_o \\left(T_b - T_{\\infty}\\right)$ 定义，其中 $A_o = 2 \\pi r_o L$。\n\n3. 使用你推导的表达式，为以下几何和热物理参数计算 $U_o$ 的数值：\n- $L = 1.5$ m,\n- $r_i = 0.025$ m,\n- $t_w = 0.003$ m,\n- $k_w = 16$ W m$^{-1}$ K$^{-1}$,\n- $h_i = 800$ W m$^{-2}$ K$^{-1}$,\n- $h_o = 12$ W m$^{-2}$ K$^{-1}$,\n- $N = 132$,\n- $a = 0.002$ m,\n- $H_f = 0.015$ m,\n- $k_f = 200$ W m$^{-1}$ K$^{-1}$。\n\n对于翅片，将每个翅片视为具有圆形横截面和绝热尖端的直针状翅片，并从其一维控制方程推导其效率。在计算等效外部对流热阻时，将翅片之间的基底面积视为直接暴露于对流，并将翅片侧面积通过翅片效率做出贡献。将 $U_o$ 的最终数值四舍五入到四位有效数字。将 $U_o$ 的最终答案以 W m$^{-2}$ K$^{-1}$ 表示。",
            "solution": "通过构建从主体流体到环境空气的热阻网络来分析此问题。总热阻是三个串联热阻之和：内部对流热阻、通过管道壁的导热热阻以及来自带翅片外表面的对流热阻。\n\n### 第一部分：热阻网络的推导\n\n从温度为 $T_b$ 的主体流体到温度为 $T_{\\infty}$ 的周围环境的总传热速率 $q$ 可以用一个热路图来表示。温差 $T_b - T_{\\infty}$ 驱动热流通过一系列热阻。\n\n**1. 内部对流热阻, $R_i$**\n从主体流体到管道内壁的传热遵循牛顿冷却定律：\n$$q = h_i A_i (T_b - T_{w,i})$$\n其中 $h_i$ 是内部对流换热系数，$A_i = 2 \\pi r_i L$ 是管道的内表面积，$T_{w,i}$ 是内壁的温度。这种关系可以用热阻 $R_i$ 来表示：\n$$q = \\frac{T_b - T_{w,i}}{R_i} \\quad \\implies \\quad R_i = \\frac{1}{h_i A_i} = \\frac{1}{2 \\pi r_i L h_i}$$\n\n**2. 壁导热热阻, $R_w$**\n热量通过圆柱壁径向向外传导。对于长度为 $L$ 的空心圆柱体，圆柱坐标系下的傅里叶导热定律为：\n$$q = -k_w A(r) \\frac{dT}{dr} = -k_w (2 \\pi r L) \\frac{dT}{dr}$$\n分离变量并从内半径 $r_i$（温度为 $T_{w,i}$）积分到外半径 $r_o = r_i + t_w$（温度为 $T_{w,o}$）：\n$$\\int_{r_i}^{r_o} \\frac{dr}{r} = -\\frac{2 \\pi k_w L}{q} \\int_{T_{w,i}}^{T_{w,o}} dT$$\n$$\\ln\\left(\\frac{r_o}{r_i}\\right) = \\frac{2 \\pi k_w L}{q} (T_{w,i} - T_{w,o})$$\n导热传热速率为 $q = \\frac{T_{w,i} - T_{w,o}}{R_w}$，由此定义了壁导热热阻为：\n$$R_w = \\frac{\\ln(r_o/r_i)}{2 \\pi k_w L}$$\n\n**3. 外部对流热阻, $R_{ext}$**\n外表面向环境空气传热。该表面由基底（无翅片）面积 $A_p$ 和 $N$ 个翅片的表面积组成。来自外表面的总传热是来自这两种表面的传热之和，两者都处于基底温度 $T_{w,o}$：\n$$q = q_p + q_f$$\n来自基底面积的传热为：\n$$q_p = h_o A_p (T_{w,o} - T_{\\infty})$$\n基底面积是圆柱体的总外表面积 $A_o = 2 \\pi r_o L$ 减去 $N$ 个翅片的基底面积 $A_{b,f} = N \\pi a^2$。\n$$A_p = A_o - N \\pi a^2 = 2 \\pi r_o L - N \\pi a^2$$\n单个翅片的传热 $q_{fin}$ 由 $q_{fin} = \\eta_f q_{max}$ 给出，其中 $\\eta_f$ 是翅片效率，而 $q_{max}$ 是在整个翅片都处于基底温度 $T_{w,o}$ 时的理想传热。\n$$q_{max} = h_o A_f (T_{w,o} - T_{\\infty})$$\n这里，$A_f$ 是单个翅片的传热表面积。对于具有绝热尖端的圆柱形针状翅片，这是其侧表面积：\n$$A_f = (2 \\pi a) H_f$$\n来自所有 $N$ 个翅片的总传热为：\n$$q_f = N q_{fin} = N \\eta_f h_o A_f (T_{w,o} - T_{\\infty})$$\n为了求得翅片效率 $\\eta_f$，我们必须求解从翅片微分单元的能量平衡推导出的稳态一维翅片方程：\n$$\\frac{d^2\\theta}{dx^2} - m^2 \\theta = 0$$\n其中 $\\theta(x) = T(x) - T_{\\infty}$ 是过余温度，$x$ 是沿翅片轴线的坐标，且 $m = \\sqrt{\\frac{h_o P}{k_f A_c}}$。对于圆柱形翅片，周长为 $P=2\\pi a$，横截面积为 $A_c = \\pi a^2$，因此：\n$$m = \\sqrt{\\frac{h_o (2\\pi a)}{k_f (\\pi a^2)}} = \\sqrt{\\frac{2h_o}{k_f a}}$$\n边界条件是：\n1. 基底温度：$\\theta(0) = T_{w,o} - T_{\\infty} = \\theta_b$。\n2. 绝热尖端：$\\frac{d\\theta}{dx}\\bigg|_{x=H_f} = 0$。\n满足这些边界条件的微分方程的解是 $\\theta(x) = \\theta_b \\frac{\\cosh(m(H_f - x))}{\\cosh(mH_f)}$。\n从翅片传出的热量速率是传导到其基底（$x=0$处）的热量：\n$$q_{fin} = -k_f A_c \\frac{d\\theta}{dx}\\bigg|_{x=0} = -k_f A_c \\left( -\\theta_b m \\frac{\\sinh(mH_f)}{\\cosh(mH_f)} \\right) = \\theta_b \\sqrt{h_o P k_f A_c} \\tanh(mH_f)$$\n翅片效率定义为 $\\eta_f = \\frac{q_{fin}}{q_{max}} = \\frac{q_{fin}}{h_o A_f \\theta_b}$。\n$$\\eta_f = \\frac{\\sqrt{h_o P k_f A_c} \\tanh(mH_f)}{h_o P H_f} = \\frac{\\sqrt{k_f A_c/(h_o P)}}{H_f} \\tanh(mH_f) = \\frac{1/(mH_f)}{1} \\tanh(mH_f) = \\frac{\\tanh(mH_f)}{mH_f}$$\n从外表面的总传热为：\n$$q = h_o A_p (T_{w,o} - T_{\\infty}) + N \\eta_f h_o A_f (T_{w,o} - T_{\\infty}) = h_o (A_p + N \\eta_f A_f) (T_{w,o} - T_{\\infty})$$\n这可以写成 $q = \\frac{T_{w,o} - T_{\\infty}}{R_{ext}}$，由此定义了等效外部对流热阻：\n$$R_{ext} = \\frac{1}{h_o (A_p + N \\eta_f A_f)} = \\frac{1}{h_o [ (2 \\pi r_o L - N \\pi a^2) + N \\eta_f (2 \\pi a H_f) ]}$$\n\n热阻网络由三个串联的热阻组成：\n$T_b \\xrightarrow{R_i} T_{w,i} \\xrightarrow{R_w} T_{w,o} \\xrightarrow{R_{ext}} T_{\\infty}$\n总热阻为 $R_{total} = R_i + R_w + R_{ext}$。\n\n### 第二部分：总结传热系数 $U_o$ 的推导\n\n总传热速率由 $q = \\frac{T_b - T_{\\infty}}{R_{total}}$ 定义。基于外表面积的总结传热系数 $U_o$ 由 $q = U_o A_o (T_b - T_{\\infty})$ 定义。\n将这两个关于 $q$ 的表达式相等，得到：\n$$U_o A_o = \\frac{1}{R_{total}} = \\frac{1}{R_i + R_w + R_{ext}}$$\n$$U_o = \\frac{1}{A_o (R_i + R_w + R_{ext})} = \\frac{1}{A_o R_i + A_o R_w + A_o R_{ext}}$$\n我们可以计算分母中的每一项：\n$$A_o R_i = (2 \\pi r_o L) \\left( \\frac{1}{2 \\pi r_i L h_i} \\right) = \\frac{r_o}{r_i h_i}$$\n$$A_o R_w = (2 \\pi r_o L) \\left( \\frac{\\ln(r_o/r_i)}{2 \\pi k_w L} \\right) = \\frac{r_o \\ln(r_o/r_i)}{k_w}$$\n$$A_o R_{ext} = \\frac{A_o}{h_o (A_p + N \\eta_f A_f)} = \\frac{2 \\pi r_o L}{h_o [ (2 \\pi r_o L - N \\pi a^2) + N \\eta_f (2 \\pi a H_f) ]}$$\n$U_o$ 的表达式是这些项之和的倒数，这些项代表每单位外表面积的总热阻：\n$$U_o = \\left( \\frac{r_o}{r_i h_i} + \\frac{r_o \\ln(r_o/r_i)}{k_w} + \\frac{A_o}{h_o (A_p + N \\eta_f A_f)} \\right)^{-1}$$\n其中 $A_o = 2 \\pi r_o L$， $A_p = A_o - N\\pi a^2$， $A_f = 2 \\pi a H_f$，以及 $\\eta_f = \\frac{\\tanh(mH_f)}{mH_f}$，其中 $m = \\sqrt{\\frac{2h_o}{k_f a}}$。\n\n### 第三部分：$U_o$ 的数值计算\n\n给定参数如下：\n$L = 1.5$ m, $r_i = 0.025$ m, $t_w = 0.003$ m, $k_w = 16$ W m$^{-1}$ K$^{-1}$, $h_i = 800$ W m$^{-2}$ K$^{-1}$, $h_o = 12$ W m$^{-2}$ K$^{-1}$, $N = 132$, $a = 0.002$ m, $H_f = 0.015$ m, $k_f = 200$ W m$^{-1}$ K$^{-1}$。\n\n首先，我们计算几何参数和翅片参数。\n外半径：$r_o = r_i + t_w = 0.025 + 0.003 = 0.028$ m。\n翅片参数 $m$：\n$$m = \\sqrt{\\frac{2 h_o}{k_f a}} = \\sqrt{\\frac{2(12)}{200(0.002)}} = \\sqrt{\\frac{24}{0.4}} = \\sqrt{60} \\approx 7.74597 \\text{ m}^{-1}$$\n乘积 $mH_f$：\n$$mH_f = \\sqrt{60} \\times 0.015 \\approx 0.116190$$\n翅片效率 $\\eta_f$：\n$$\\eta_f = \\frac{\\tanh(mH_f)}{mH_f} = \\frac{\\tanh(0.116190)}{0.116190} = \\frac{0.115688}{0.116190} \\approx 0.99568$$\n接下来，我们计算面积：\n外表面积（不含翅片）：$A_o = 2 \\pi r_o L = 2 \\pi (0.028)(1.5) \\approx 0.263894$ m$^2$。\n翅片总基底面积：$N A_c = N (\\pi a^2) = 132 \\times \\pi (0.002)^2 \\approx 0.0016588$ m$^2$。\n基底面积：$A_p = A_o - N A_c = 0.263894 - 0.0016588 \\approx 0.262235$ m$^2$。\n翅片总侧面积：$N A_f = N (2 \\pi a H_f) = 132 \\times 2 \\pi (0.002)(0.015) \\approx 0.024881$ m$^2$。\n\n现在，我们计算 $\\frac{1}{U_o}$ 表达式中的各项热阻（单位外表面积的总热阻, $R''_{total}$）：\n$$R''_{i,o} = \\frac{r_o}{r_i h_i} = \\frac{0.028}{0.025 \\times 800} = \\frac{0.028}{20} = 0.0014 \\text{ m}^2\\text{K/W}$$\n$$R''_{w,o} = \\frac{r_o \\ln(r_o/r_i)}{k_w} = \\frac{0.028 \\ln(0.028/0.025)}{16} = \\frac{0.028 \\ln(1.12)}{16} \\approx \\frac{0.028(0.113329)}{16} \\approx 0.0001983 \\text{ m}^2\\text{K/W}$$\n$$R''_{ext,o} = \\frac{A_o}{h_o (A_p + N \\eta_f A_f)} = \\frac{0.263894}{12 \\times (0.262235 + 0.99568 \\times 0.024881)} = \\frac{0.263894}{12 \\times (0.262235 + 0.024775)} = \\frac{0.263894}{12 \\times 0.28701} \\approx 0.076621 \\text{ m}^2\\text{K/W}$$\n单位外表面积的总热阻为：\n$$R''_{total} = \\frac{1}{U_o} = R''_{i,o} + R''_{w,o} + R''_{ext,o} = 0.0014 + 0.0001983 + 0.076621 = 0.0782193 \\text{ m}^2\\text{K/W}$$\n总结传热系数为：\n$$U_o = \\frac{1}{R''_{total}} = \\frac{1}{0.0782193} \\approx 12.7846 \\text{ W m}^{-2}\\text{K}^{-1}$$\n四舍五入到四位有效数字，我们得到 $U_o = 12.78$ W m$^{-2}$ K$^{-1}$。",
            "answer": "$$\n\\boxed{12.78}\n$$"
        },
        {
            "introduction": "对于许多工程应用中的湍流问题，成熟的经验关联式提供了一种比完整CFD仿真更高效的替代方案。本练习的核心任务是，在计算脚本中实施一个经典的湍流换热关联式——Gnielinski关联式，以预测管内强制对流的努塞尔数（$Nu$）。您不仅需要通过数值方法求解隐式的Colebrook方程以获得摩擦系数$f_D$，还将对湍流普朗特数（$Pr_t$）进行敏感性分析，这些都是计算热工领域工程师必备的实用技能 。",
            "id": "3955575",
            "problem": "考虑在直径恒定的直圆形管道中，单相牛顿流体的充分发展的湍流强制对流，壁面热通量均匀且轴向热传导可忽略。流动是统计稳态且不可压缩的。您将使用一个连接湍流内部流动动量与热量传递的典型关联式来计算无量纲传热，并结合从一个隐式光滑至粗糙壁面关系式中获得的湍流摩擦因子。然后，您将使用一个基于涡扩散闭合模型的灵敏度模型来增强传热关联式，该模型涉及湍流普朗特数，并量化相对于湍流普朗特数的灵敏度。\n\n需要使用的基本原理和定义：\n- 湍流内部流动中的动量和能量守恒，由雷诺平均方程表示。\n- 雷诺数定义为 $Re = \\dfrac{\\rho U D}{\\mu}$，普朗特数定义为 $Pr = \\dfrac{\\nu}{\\alpha}$，湍流普朗特数定义为 $Pr_t = \\dfrac{\\nu_t}{\\alpha_t}$，其中 $\\nu = \\mu/\\rho$ 是运动粘度，$\\alpha$ 是分子热扩散率，$\\nu_t$ 和 $\\alpha_t$ 是在涡扩散闭合下获得的湍流输运系数。\n- 对于相对粗糙度为 $\\varepsilon/D$ 的圆形管道中的湍流，达西摩擦因子 $f_D$ 通过求解隐式的 Colebrook 关系式得到。\n- 传热关联式是用于管道的典型湍流强制对流关联式，它以与内部流动的动量-传热类比一致的非线性耦合方式依赖于 $Re$、$Pr$ 和 $f_D$。在您的推理中，请勿使用任何非基于此基础推导出的简化公式。\n\n灵敏度模型规范：\n- 在对数层中，假设采用混合长度涡粘性闭合，且 von Kármán 常数 $\\kappa = 0.41$。\n- 设一个代表性的无量纲壁面距离为 $y^+ = 30$，以表征缓冲层/对数层的行为。\n- 在这些假设下，将在该代表性位置的湍流动量扩散率与分子动量扩散率之比近似为 $\\dfrac{\\nu_t}{\\nu} \\approx \\kappa y^+$。\n- 使用 $Pr = \\nu/\\alpha$ 和 $Pr_t = \\nu_t/\\alpha_t$，将在该代表性位置的总热扩散率与分子热扩散率之比近似为 $1 + \\dfrac{\\alpha_t}{\\alpha} = 1 + \\dfrac{\\nu_t/\\nu}{Pr_t/Pr} = 1 + \\kappa y^+ \\dfrac{Pr}{Pr_t}$。\n- 定义一个对温度对数律指数贡献的乘法修正因子为 $\\phi(Pr_t) = \\left(1 + \\kappa y^+ \\dfrac{Pr}{Pr_t}\\right)^{-2/3}$。此因子修正了管道的典型湍流传热关联式分母中依赖于分子普朗特数的部分。\n\n计算任务：\n1. 对于每个测试案例，在湍流区内给定 $Re$ 和 $\\varepsilon/D$ 的情况下，求解 Colebrook 方程以获得 $f_D$。假设定义域为 $3 \\times 10^3 \\le Re \\le 5 \\times 10^6$ 和 $0 \\le \\varepsilon/D \\le 5 \\times 10^{-3}$。\n2. 使用依赖于 $Re$、$Pr$ 和 $f_D$ 的圆形管道典型关联式，计算基准湍流努塞尔数 $Nu_{\\text{base}}$。\n3. 应用灵敏度模型，将分母中依赖于分子普朗特数的指数贡献替换为使用 $\\phi(Pr_t)$ 修正后的值，并在名义 $Pr_t = 0.85$ 时计算 $Nu_{\\text{corr}}(Pr_t)$。\n4. 通过使用中心有限差分和小增量 $\\Delta Pr_t = 0.05$ 计算数值导数 $\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}\\big|_{Pr_t=0.85}$ 来量化灵敏度。\n5. 所有输入均为无量纲；所有输出均为无量纲。努塞尔数是无量纲的。不涉及角度单位。\n\n测试套件：\n- 案例 1：$Re = 1.0 \\times 10^5$，$Pr = 0.7$，$\\varepsilon/D = 0.0$。\n- 案例 2：$Re = 5.0 \\times 10^4$，$Pr = 7.0$，$\\varepsilon/D = 0.0$。\n- 案例 3：$Re = 1.0 \\times 10^4$，$Pr = 100.0$，$\\varepsilon/D = 2.0 \\times 10^{-4}$。\n- 案例 4：$Re = 3.0 \\times 10^3$，$Pr = 0.7$，$\\varepsilon/D = 0.0$。\n- 案例 5：$Re = 3.0 \\times 10^4$，$Pr = 200.0$，$\\varepsilon/D = 5.0 \\times 10^{-4}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，按以下顺序排列五个测试案例的结果：\n  $[Nu_{\\text{base}}^{(1)}, Nu_{\\text{corr}}^{(1)}, (\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t})^{(1)}, Nu_{\\text{base}}^{(2)}, Nu_{\\text{corr}}^{(2)}, (\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t})^{(2)}, \\dots, Nu_{\\text{base}}^{(5)}, Nu_{\\text{corr}}^{(5)}, (\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t})^{(5)}]$。\n- 所有数字均以浮点数值表示。",
            "solution": "### 步骤 1：达西摩擦因子 ($f_D$) 计算\n\n管道中充分发展湍流的达西摩擦因子 $f_D$ 由 Colebrook-White 方程确定。这是一个隐式关联式，将 $f_D$ 与雷诺数 $Re$ 和管道壁面的相对粗糙度 $\\varepsilon/D$ 联系起来。该方程为：\n$$\n\\frac{1}{\\sqrt{f_D}} = -2.0 \\log_{10} \\left( \\frac{\\varepsilon/D}{3.7} + \\frac{2.51}{Re \\sqrt{f_D}} \\right)\n$$\n该方程是超越方程，无法解析地求解 $f_D$。因此，对于由一对 ($Re$, $\\varepsilon/D$) 定义的每个测试案例，必须采用数值求根算法。我们定义一个函数 $g(f_D)$，使得求 $g(f_D) = 0$ 的根可以得到所需的 $f_D$ 值：\n$$\ng(f_D) = \\frac{1}{\\sqrt{f_D}} + 2.0 \\log_{10} \\left( \\frac{\\varepsilon/D}{3.7} + \\frac{2.51}{Re \\sqrt{f_D}} \\right)\n$$\n此方程将在一个物理上合理的范围（例如 $f_D \\in [0.001, 0.1]$）内对 $f_D$ 进行数值求解。\n\n### 步骤 2：基准努塞尔数 ($Nu_{\\text{base}}$) 计算\n\n问题指定使用一个与动量-传热类比一致的“用于管道的典型湍流强制对流关联式”。Gnielinski 关联式 (1976) 是针对给定条件（圆形管道内充分发展的湍流，均匀热通量，适用于 $0.5  Pr  2000$ 和 $3 \\times 10^3  Re  5 \\times 10^6$）的标准且最合适的选择。基准努塞尔数 $Nu_{\\text{base}}$ 使用此关联式计算：\n$$\nNu_{\\text{base}} = \\frac{(f_D/8)(Re-1000)Pr}{1 + 12.7\\sqrt{f_D/8}(Pr^{2/3}-1)}\n$$\n这里，$f_D$ 是步骤 1 中求解 Colebrook 方程得到的值，$Re$ 和 $Pr$ 是特定测试案例的雷诺数和普朗特数。\n\n### 步骤 3：修正努塞尔数 ($Nu_{\\text{corr}}$) 计算\n\n问题引入了一个灵敏度模型来增强传热关联式。该模型引入了一个修正因子 $\\phi(Pr_t)$，它修正了 Gnielinski 关联式分母中分子普朗特数的贡献。修正因子定义为：\n$$\n\\phi(Pr_t) = \\left(1 + \\kappa y^+ \\frac{Pr}{Pr_t}\\right)^{-2/3}\n$$\n给定的常数为 von Kármán 常数 $\\kappa = 0.41$ 和一个代表性的无量纲壁面距离 $y^+ = 30$。湍流普朗特数为 $Pr_t$。\n\n问题指出 $\\phi(Pr_t)$ 是“对温度对数律指数贡献的乘法修正因子”。在 Gnielinski 关联式的背景下，这对应于 $Pr^{2/3}$ 项。因此，为了获得修正后的努塞尔数 $Nu_{\\text{corr}}$，我们将原始公式中的 $Pr^{2/3}$ 替换为 $Pr^{2/3} \\phi(Pr_t)$：\n$$\nNu_{\\text{corr}}(Pr_t) = \\frac{(f_D/8)(Re-1000)Pr}{1 + 12.7\\sqrt{f_D/8}\\left(Pr^{2/3}\\phi(Pr_t) - 1\\right)}\n$$\n对于计算任务 3，此值在名义湍流普朗特数 $Pr_t = 0.85$ 处计算。\n\n### 步骤 4：灵敏度计算\n\n修正努塞尔数相对于湍流普朗特数的灵敏度通过数值导数 $\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}$ 来量化，并在 $Pr_t = 0.85$ 处求值。问题指定使用中心有限差分格式，增量为 $\\Delta Pr_t = 0.05$。公式为：\n$$\n\\frac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}\\bigg|_{Pr_t=0.85} \\approx \\frac{Nu_{\\text{corr}}(0.85 + \\Delta Pr_t) - Nu_{\\text{corr}}(0.85 - \\Delta Pr_t)}{2 \\Delta Pr_t}\n$$\n代入给定值 $Pr_t = 0.85$ 和 $\\Delta Pr_t = 0.05$，导数近似为：\n$$\n\\frac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}\\bigg|_{Pr_t=0.85} \\approx \\frac{Nu_{\\text{corr}}(0.90) - Nu_{\\text{corr}}(0.80)}{0.1}\n$$\n这需要计算 $Nu_{\\text{corr}}$ 在另外两个 $Pr_t$ 值（$0.80$ 和 $0.90$）下的数值。\n\n### 计算过程摘要\n\n对于每个由元组 ($Re, Pr, \\varepsilon/D$) 指定的测试案例：\n1.  使用给定的 $Re$ 和 $\\varepsilon/D$ 求解 Colebrook 方程以得到 $f_D$。\n2.  使用计算出的 $f_D$ 和给定的 $Re$、$Pr$，通过 Gnielinski 关联式计算 $Nu_{\\text{base}}$。\n3.  使用修正的 Gnielinski 关联式计算 $Nu_{\\text{corr}}(Pr_t=0.85)$。\n4.  使用相同的修正关联式计算 $Nu_{\\text{corr}}(Pr_t=0.80)$ 和 $Nu_{\\text{corr}}(Pr_t=0.90)$。\n5.  使用中心差分公式和上一步的值计算灵敏度 $\\dfrac{d\\,Nu_{\\text{corr}}}{d\\,Pr_t}$。\n6.  将每个测试案例的三个结果（$Nu_{\\text{base}}$、$Nu_{\\text{corr}}(0.85)$ 和导数）按规定格式编译成单个列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing baseline and corrected Nusselt numbers\n    for turbulent forced convection in a duct, along with a sensitivity analysis.\n    \"\"\"\n\n    # Define constants from the problem statement.\n    KAPPA = 0.41\n    Y_PLUS = 30.0\n    PR_T_NOMINAL = 0.85\n    DELTA_PR_T = 0.05\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0e5, 0.7, 0.0),          # Case 1\n        (5.0e4, 7.0, 0.0),          # Case 2\n        (1.0e4, 100.0, 2.0e-4),     # Case 3\n        (3.0e3, 0.7, 0.0),          # Case 4\n        (3.0e4, 200.0, 5.0e-4),     # Case 5\n    ]\n\n    def solve_colebrook(Re, rel_rough):\n        \"\"\"\n        Solves the Colebrook equation for the Darcy friction factor f_D.\n        \n        Args:\n            Re (float): Reynolds number.\n            rel_rough (float): Relative roughness (epsilon/D).\n            \n        Returns:\n            float: Darcy friction factor f_D.\n        \"\"\"\n        if not (Re > 2300): # Colebrook is for turbulent flow\n            return 64.0 / Re # Laminar flow, not strictly needed per problem spec\n            \n        # Colebrook equation rearranged to f(f_D) = 0\n        colebrook_func = lambda f_D: 1.0 / np.sqrt(f_D) + 2.0 * np.log10(\n            (rel_rough / 3.7) + (2.51 / (Re * np.sqrt(f_D)))\n        )\n        \n        # Using root_scalar to find the root of the function.\n        # A bracket of [0.001, 0.1] is safe for turbulent flow friction factors.\n        sol = root_scalar(colebrook_func, bracket=[0.001, 0.1], method='brentq')\n        return sol.root\n\n    def calculate_nusselt(Re, Pr, f_D, Pr_t=None):\n        \"\"\"\n        Calculates the Nusselt number using the Gnielinski correlation, with an\n        optional correction based on the turbulent Prandtl number.\n\n        Args:\n            Re (float): Reynolds number.\n            Pr (float): Prandtl number.\n            f_D (float): Darcy friction factor.\n            Pr_t (float, optional): Turbulent Prandtl number. If None, computes\n                                    the baseline Nu. Otherwise, computes the\n                                    corrected Nu.\n\n        Returns:\n            float: Nusselt number.\n        \"\"\"\n        # Common term in Gnielinski correlation\n        f_term = f_D / 8.0\n        \n        # Calculate the molecular prandtl number contribution\n        pr_term_base = Pr**(2.0/3.0)\n        \n        pr_term_modified = pr_term_base\n        if Pr_t is not None:\n            # Apply the sensitivity model correction factor phi(Pr_t)\n            phi = (1.0 + KAPPA * Y_PLUS * Pr / Pr_t)**(-2.0/3.0)\n            pr_term_modified *= phi\n            \n        numerator = f_term * (Re - 1000.0) * Pr\n        denominator = 1.0 + 12.7 * np.sqrt(f_term) * (pr_term_modified - 1.0)\n        \n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        Re, Pr, rel_rough = case\n        \n        # 1. Solve for Darcy friction factor\n        f_D = solve_colebrook(Re, rel_rough)\n        \n        # 2. Compute baseline Nusselt number\n        Nu_base = calculate_nusselt(Re, Pr, f_D)\n        \n        # 3. Compute corrected Nusselt number at the nominal Pr_t\n        Nu_corr_nominal = calculate_nusselt(Re, Pr, f_D, Pr_t=PR_T_NOMINAL)\n        \n        # 4. Compute corrected Nu for finite difference calculation\n        Pr_t_plus = PR_T_NOMINAL + DELTA_PR_T\n        Pr_t_minus = PR_T_NOMINAL - DELTA_PR_T\n        \n        Nu_corr_plus = calculate_nusselt(Re, Pr, f_D, Pr_t=Pr_t_plus)\n        Nu_corr_minus = calculate_nusselt(Re, Pr, f_D, Pr_t=Pr_t_minus)\n        \n        # 5. Compute the sensitivity using central finite difference\n        dNu_dPr_t = (Nu_corr_plus - Nu_corr_minus) / (2.0 * DELTA_PR_T)\n        \n        results.extend([Nu_base, Nu_corr_nominal, dNu_dPr_t])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "任何计算模型的输出都包含离散化误差，保证结果的可靠性是计算工程中的关键一环。本练习将引导您完成一项网格独立性研究，这是验证与确认（Verification and Validation, V extrapolation）来估计无网格影响的“真实”解，并计算网格收敛指数（GCI）来量化和报告数值解的不确定性，从而确保您的计算预测具有可信度 。",
            "id": "3955565",
            "problem": "一根长的、光滑的圆形管道，其直径为 $D$，在充分发展的强制湍流条件下输送流体，并具有均匀的壁面热通量。对流传热系数 $h$ 由 Newton 冷却定律定义，横截面 Nusselt 数定义为 $Nu \\equiv h D / k$，其中 $k$ 是流体的热导率。对于光滑圆管中的充分发展的湍流，一个经过广泛验证的充分发展平均 Nusselt 数关联式是 Gnielinski 关联式，它使用了 Darcy 摩擦因子。对于 Reynolds 数 $Re$ 和 Prandtl 数 $Pr$ 在 $3000 \\le Re \\le 5 \\times 10^6$ 和 $0.5 \\le Pr \\le 2000$ 的范围内，摩擦因子由 $f = \\left(0.79 \\ln(Re) - 1.64\\right)^{-2}$ 给出，而 Nusselt 数的关联式为\n$$\nNu_{\\mathrm{true}} = \\frac{\\frac{f}{8}\\,(Re - 1000)\\,Pr}{1 + 12.7\\left(\\frac{f}{8}\\right)^{1/2}\\left(Pr^{2/3} - 1\\right)}.\n$$\n当使用计算流体动力学 (CFD) 在特征尺寸为 $h$ 的网格上预测 $Nu$ 时，数值解 $Nu_h$ 可以被建模为相对于网格无关值 $Nu^\\ast$ 的一个渐近级数：\n$$\nNu_h = Nu^\\ast + C h^p + \\mathcal{O}\\left(h^{p+1}\\right),\n$$\n其中 $C$ 是一个与 $h$ 无关的常数，$p$ 是离散格式的观测到的精度阶数。网格无关性研究包括在至少三个系统加密的网格（$h_1  h_2  h_3$，具有恒定的加密比 $r = h_2/h_1 = h_3/h_2 > 1$）上获取 $Nu_h$，判断序列是否单调收敛于 $Nu^\\ast$，从数据中估计 $p$，并使用 Richardson 外推法来估计 $Nu^\\ast$ 和最细网格上的有界离散化误差。\n\n仅从上述定义和 CFD 离散化误差具有渐近形式 $Nu_h = Nu^\\ast + C h^p + \\mathcal{O}(h^{p+1})$ 的前提出发，实现一个算法。该算法给定三个具有恒定加密比的网格层级和三个 $Nu_h$ 值，能够 (i) 估计阶数 $p$，(ii) 构建 $Nu^\\ast$ 的 Richardson 外推值 $Nu_{\\mathrm{ext}}$，(iii) 使用带安全因子的网格收敛指数计算有界的最细网格相对误差，以及 (iv) 报告序列是否为单调。对于网格收敛指数 (GCI)，使用安全因子 $F_s = 1.25$ 并报告定义为\n$$\nGCI_1 = F_s \\frac{|Nu_{\\mathrm{ext}} - Nu_{h_1}|}{|Nu_{h_1}|}\n$$\n的最细网格 GCI，其中 $Nu_{h_1}$ 是最细网格上的值。\n\n为了测试，请使用以下合成测试套件。在每个测试中，用单元格数 $\\{N_1, N_2, N_3\\}$（细、中、粗）构建三个网格，使得特征网格尺寸为 $h_i = D/N_i$。使用以下公式构建合成的 CFD 值：\n$$\nNu_{h_i} = Nu_{\\mathrm{true}} + s_i\\,C\\,h_i^{p_{\\mathrm{true}}},\n$$\n其中 $s_i \\in \\{-1,+1\\}$ 施加了主导误差项的符号以模拟可能的振荡行为，$C$ 的单位为 $\\mathrm{m}^{-p_{\\mathrm{true}}}$，因此乘积 $C h_i^{p_{\\mathrm{true}}}$ 是无量纲的。Gnielinski 关联式为每个案例提供 $Nu_{\\mathrm{true}}$。\n\n测试套件：\n- 案例 1（理想情况，接近二阶，加密比为 2）：$Re = 50000$, $Pr = 7.0$, $D = 0.05\\,\\mathrm{m}$, $\\{N_1, N_2, N_3\\} = \\{200, 100, 50\\}$, $p_{\\mathrm{true}} = 2.0$, $C = 10^4\\,\\mathrm{m}^{-2}$, $s = \\{+1, +1, +1\\}$。\n- 案例 2（较低阶行为，加密比为 1.5）：$Re = 10000$, $Pr = 0.7$, $D = 0.10\\,\\mathrm{m}$, $\\{N_1, N_2, N_3\\} = \\{90, 60, 40\\}$, $p_{\\mathrm{true}} = 1.4$, $C = 100\\,\\mathrm{m}^{-1.4}$, $s = \\{+1, +1, +1\\}$。\n- 案例 3（振荡误差符号，加密比为 2）：$Re = 30000$, $Pr = 2.0$, $D = 0.08\\,\\mathrm{m}$, $\\{N_1, N_2, N_3\\} = \\{256, 128, 64\\}$, $p_{\\mathrm{true}} = 2.2$, $C = 2 \\times 10^5\\,\\mathrm{m}^{-2.2}$, $s = \\{+1, -1, +1\\}$。\n- 案例 4（非常小的细网格误差，加密比为 2）：$Re = 8000$, $Pr = 5.0$, $D = 0.05\\,\\mathrm{m}$, $\\{N_1, N_2, N_3\\} = \\{320, 160, 80\\}$, $p_{\\mathrm{true}} = 2.0$, $C = 20000\\,\\mathrm{m}^{-2}$, $s = \\{+1, +1, +1\\}$。\n\n实现要求：\n- 为每个案例使用 Gnielinski 关联式计算 $Nu_{\\mathrm{true}}$。\n- 根据测试套件参数构建 $\\{h_1, h_2, h_3\\}$ 和 $\\{Nu_{h_1}, Nu_{h_2}, Nu_{h_3}\\}$。\n- 仅使用 $\\{Nu_{h_i}\\}$ 和 $\\{h_i\\}$（而不是提供的 $p_{\\mathrm{true}}$ 或 $C$），估计 $p$，形成 Richardson 外推值 $Nu_{\\mathrm{ext}}$，计算 $GCI_1$，并报告一个由连续差值 $\\left(Nu_{h_3} - Nu_{h_2}\\right)$ 和 $\\left(Nu_{h_2} - Nu_{h_1}\\right)$ 的符号一致性定义的单调收敛布尔值。\n- 将所有输出表示为无量纲浮点数（$Nu_{\\mathrm{ext}}$、$GCI_1$ 和 $p$）和布尔值（单调性）。将浮点数四舍五入到六位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试案例贡献一个四元素列表 $[Nu_{\\mathrm{ext}}, GCI_1, p, \\text{monotonic}]$。例如，总输出应类似于 $[[x_1, y_1, z_1, b_1],[x_2, y_2, z_2, b_2],[x_3, y_3, z_3, b_3],[x_4, y_4, z_4, b_4]]$。",
            "solution": "### 1. 理论框架\n\n分析的基础是这样一个假设：Nusselt 数数值解 $Nu_h$ 的离散化误差可以表示为特征网格尺寸 $h$ 的渐近级数。对于足够小的 $h$，该级数由其主导项决定：\n$$\nNu_h = Nu^\\ast + C h^p + \\mathcal{O}\\left(h^{p+1}\\right)\n$$\n其中 $Nu^\\ast$ 是当 $h \\to 0$ 时离散化方程的精确解（网格无关解），$C$ 是一个常数，$p$ 是数值格式的形式精度阶数。\n\n让我们考虑在三个系统加密的网格上获得的三个解（$Nu_{h_1}$、$Nu_{h_2}$、$Nu_{h_3}$），其特征尺寸为 $h_1  h_2  h_3$。这些网格由一个恒定的加密比 $r$ 定义，使得 $h_2 = r h_1$ 和 $h_3 = r h_2 = r^2 h_1$，其中 $r > 1$。忽略高阶项，我们可以写出：\n1. $Nu_{h_1} = Nu^\\ast + C h_1^p$\n2. $Nu_{h_2} = Nu^\\ast + C h_2^p = Nu^\\ast + C (r h_1)^p = Nu^\\ast + C r^p h_1^p$\n3. $Nu_{h_3} = Nu^\\ast + C h_3^p = Nu^\\ast + C (r^2 h_1)^p = Nu^\\ast + C r^{2p} h_1^p$\n\n### 2. 验证算法的推导\n\n**a. 单调性分析**\n如果解从一侧逼近渐近值，则收敛是单调的。这意味着误差符号相同，并且解值 $Nu_{h_1}, Nu_{h_2}, Nu_{h_3}$ 形成一个单调序列。这通过检查连续网格上解之间差值的符号一致性来确定。当且仅当差值的乘积为正时，布尔值 `monotonic` 为 `True`：\n$$\n(Nu_{h_3} - Nu_{h_2})(Nu_{h_2} - Nu_{h_1}) > 0\n$$\n\n**b. 观测到的精度阶数 ($p$) 的估计**\n为了估计 $p$，我们从方程组中消去 $Nu^\\ast$ 和 $C$。首先，我们计算连续解之间的差值：\n$$\n\\epsilon_{21} = Nu_{h_2} - Nu_{h_1}\n$$\n$$\n\\epsilon_{32} = Nu_{h_3} - Nu_{h_2}\n$$\n取这些差值的比值可以消去 $C$ 和 $h_1$：\n$$\n\\frac{\\epsilon_{32}}{\\epsilon_{21}} = \\frac{Nu_{h_3} - Nu_{h_2}}{Nu_{h_2} - Nu_{h_1}} = r^p\n$$\n通过取对数求解 $p$ 得：\n$$\np = \\frac{\\ln\\left(\\frac{Nu_{h_3} - Nu_{h_2}}{Nu_{h_2} - Nu_{h_1}}\\right)}{\\ln(r)}\n$$\n如果收敛不是单调的（振荡的），比值 $\\frac{\\epsilon_{32}}{\\epsilon_{21}}$ 可能为负，使其对数成为复数。在这种情况下，标准做法是使用比值的绝对值来获得 $p$ 的实数值估计，因为这仍然反映了误差大小随 $h$ 变化的速率。因此，实现的公式是：\n$$\np = \\frac{\\ln\\left(\\left|\\frac{Nu_{h_3} - Nu_{h_2}}{Nu_{h_2} - Nu_{h_1}}\\right|\\right)}{\\ln(r)}\n$$\n\n**c. Richardson 外推法**\nRichardson 外推法使用两个网格的解和估计的精度阶数 $p$ 来产生一个对网格无关解 $Nu^\\ast$ 的更高阶估计。使用 $Nu_{h_1}$ 和 $Nu_{h_2}$ 的方程：\n$$\nNu_{h_1} - Nu^\\ast = C h_1^p\n$$\n$$\nNu_{h_2} - Nu^\\ast = C r^p h_1^p\n$$\n将第一个方程代入第二个方程得到 $Nu_{h_2} - Nu^\\ast = r^p (Nu_{h_1} - Nu^\\ast)$。重新整理以求解 $Nu^\\ast$，得到外推值，记为 $Nu_{\\mathrm{ext}}$：\n$$\nNu_{\\mathrm{ext}} = \\frac{r^p Nu_{h_1} - Nu_{h_2}}{r^p - 1}\n$$\n一个代数上等价且通常数值上更稳定的形式是：\n$$\nNu_{\\mathrm{ext}} = Nu_{h_1} + \\frac{Nu_{h_1} - Nu_{h_2}}{r^p - 1}\n$$\n该公式提供了对 $Nu^\\ast$ 的估计。\n\n**d. 网格收敛指数 (GCI)**\nGCI 提供了对给定网格上离散化误差的保守估计。最细网格的 GCI，即 $GCI_1$，使用安全因子 $F_s = 1.25$ 计算。它表示最细网格 ($h_1$) 上的相对误差：\n$$\nGCI_1 = F_s \\frac{|Nu_{\\mathrm{ext}} - Nu_{h_1}|}{|Nu_{h_1}|}\n$$\n项 $|Nu_{\\mathrm{ext}} - Nu_{h_1}|$ 是最细网格解 $Nu_{h_1}$ 中的估计误差。\n\n### 3. 实现计划\n\n该算法使用 Python 实现。对于指定的每个测试案例：\n1.  使用 Gnielinski 关联式计算真实的 Nusselt 数 $Nu_{\\mathrm{true}}$。首先由 $f = (0.79 \\ln(Re) - 1.64)^{-2}$ 计算 Darcy 摩擦因子 $f$。然后通过以下公式找到 $Nu_{\\mathrm{true}}$：\n    $$\n    Nu_{\\mathrm{true}} = \\frac{\\frac{f}{8}\\,(Re - 1000)\\,Pr}{1 + 12.7\\left(\\frac{f}{8}\\right)^{1/2}\\left(Pr^{2/3} - 1\\right)}\n    $$\n2.  从管道直径 $D$ 和单元格数 $\\{N_1, N_2, N_3\\}$ 确定特征网格尺寸 $\\{h_1, h_2, h_3\\}$，即 $h_i = D/N_i$。\n3.  使用提供的公式生成合成数值解 $\\{Nu_{h_1}, Nu_{h_2}, Nu_{h_3}\\}$：$Nu_{h_i} = Nu_{\\mathrm{true}} + s_i\\,C\\,h_i^{p_{\\mathrm{true}}}$。\n4.  对合成数据 $\\{Nu_{h_i}\\}$ 和网格参数执行核心验证分析，以计算所需的输出：$p$、$Nu_{\\mathrm{ext}}$、$GCI_1$ 和单调性布尔值。\n5.  所有浮点结果（$Nu_{\\mathrm{ext}}$、$GCI_1$、$p$）在格式化为最终输出结构之前，四舍五入到六位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the grid convergence analysis problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"Re\": 50000, \"Pr\": 7.0, \"D\": 0.05,\n            \"N_vals\": [200, 100, 50],\n            \"p_true\": 2.0, \"C\": 1e4, \"s\": [1, 1, 1],\n        },\n        {\n            \"Re\": 10000, \"Pr\": 0.7, \"D\": 0.10,\n            \"N_vals\": [90, 60, 40],\n            \"p_true\": 1.4, \"C\": 100, \"s\": [1, 1, 1],\n        },\n        {\n            \"Re\": 30000, \"Pr\": 2.0, \"D\": 0.08,\n            \"N_vals\": [256, 128, 64],\n            \"p_true\": 2.2, \"C\": 2e5, \"s\": [1, -1, 1],\n        },\n        {\n            \"Re\": 8000, \"Pr\": 5.0, \"D\": 0.05,\n            \"N_vals\": [320, 160, 80],\n            \"p_true\": 2.0, \"C\": 20000, \"s\": [1, 1, 1],\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Re, Pr, D = case[\"Re\"], case[\"Pr\"], case[\"D\"]\n        N1, N2, N3 = case[\"N_vals\"]\n        p_true, C, s_vals = case[\"p_true\"], case[\"C\"], case[\"s\"]\n        \n        # 1. Calculate Nu_true using Gnielinski correlation\n        f_darcy = (0.79 * np.log(Re) - 1.64)**(-2)\n        numerator = (f_darcy / 8) * (Re - 1000) * Pr\n        denominator = 1 + 12.7 * (f_darcy / 8)**0.5 * (Pr**(2/3) - 1)\n        Nu_true = numerator / denominator\n\n        # 2. Generate synthetic CFD data\n        h1, h2, h3 = D / N1, D / N2, D / N3\n        h_vals = np.array([h1, h2, h3])\n        s_vals = np.array(s_vals)\n        \n        Nu_h_vals = Nu_true + s_vals * C * np.power(h_vals, p_true)\n        Nu_h1, Nu_h2, Nu_h3 = Nu_h_vals[0], Nu_h_vals[1], Nu_h_vals[2]\n        \n        # 3. Perform Verification Analysis\n        Fs = 1.25 # Safety factor\n        \n        # Refinement ratio\n        r = h2 / h1 \n        \n        # Monotonicity check\n        diff_21 = Nu_h2 - Nu_h1\n        diff_32 = Nu_h3 - Nu_h2\n        # Product > 0 ensures both are same sign (and non-zero)\n        is_monotonic = (diff_21 * diff_32) > 0\n        \n        # Estimate order of accuracy, p\n        p_est = float('nan') # Default for non-computable cases\n        if not np.isclose(diff_21, 0):\n            ratio = diff_32 / diff_21\n            if ratio = 0: # Oscillatory or divergent behavior\n                # Use absolute value to get a real p\n                p_est = np.log(abs(ratio)) / np.log(r)\n            else:\n                p_est = np.log(ratio) / np.log(r)\n\n        # Richardson Extrapolation for Nu_ext\n        Nu_ext = float('nan') # Default\n        if not np.isnan(p_est) and not np.isclose(r**p_est, 1.0):\n            # Using stable form Nu_ext = Nu_h1 + (Nu_h1 - Nu_h2) / (r^p - 1)\n            Nu_ext = Nu_h1 + (Nu_h1 - Nu_h2) / (r**p_est - 1)\n            \n        # Calculate Grid Convergence Index (GCI)\n        gci_1 = float('nan') # Default\n        if not np.isnan(Nu_ext) and not np.isclose(Nu_h1, 0.0):\n            relative_error = abs((Nu_ext - Nu_h1) / Nu_h1)\n            gci_1 = Fs * relative_error\n        \n        # 4. Format outputs\n        Nu_ext_rounded = round(Nu_ext, 6) if not np.isnan(Nu_ext) else 'nan'\n        gci_1_rounded = round(gci_1, 6) if not np.isnan(gci_1) else 'nan'\n        p_est_rounded = round(p_est, 6) if not np.isnan(p_est) else 'nan'\n        \n        case_result = [Nu_ext_rounded, gci_1_rounded, p_est_rounded, is_monotonic]\n        results.append(case_result)\n\n    # Final print statement in the exact required format\n    # Custom string formatting to handle boolean correctly as lower case\n    final_output_str = \"[\"\n    for i, res in enumerate(results):\n        final_output_str += f\"[{res[0]},{res[1]},{res[2]},{str(res[3]).lower()}]\"\n        if i  len(results) - 1:\n            final_output_str += \",\"\n    final_output_str += \"]\"\n    print(final_output_str)\n\nsolve()\n\n```"
        }
    ]
}