{
    "hands_on_practices": [
        {
            "introduction": "Understanding the transient evolution of natural convection begins with identifying the key physical processes and their characteristic timescales. This exercise guides you through a fundamental scaling analysis to derive the thermal diffusion time and the convective circulation time from first principles. By comparing these scales, you will develop the physical intuition needed to predict the dominant mechanism controlling the system's approach to steady state, a crucial skill for both theoretical analysis and designing efficient numerical simulations.",
            "id": "2509823",
            "problem": "A square, two-dimensional, sealed cavity of side length $L$ is filled with air initially at a uniform temperature $T_{0}$. At time $t=0$, the left and right vertical walls are suddenly brought and held at uniform temperatures $T_{h}$ and $T_{c}$, respectively, with $T_{h}-T_{c}=\\Delta T$. The top and bottom horizontal walls are perfectly insulated. All walls are no-slip. Assume the Boussinesq approximation is valid and that properties are constant.\n\nStarting from the incompressible mass, momentum, and energy balances and using rational scaling arguments, derive expressions for (a) the characteristic thermal diffusion time across the cavity and (b) the characteristic convective circulation time associated with buoyancy-driven motion, considering both viscous-dominated and inertia-dominated balances in the momentum equation. Use these to propose a single composite estimate for the time to reach a quasi-steady temperature field as the slower of the two mechanisms.\n\nThen, using the given data for air at $T_{0}=300\\,\\mathrm{K}$,\n- $L=1.00\\times 10^{-2}\\,\\mathrm{m}$,\n- $\\Delta T=10.0\\,\\mathrm{K}$,\n- gravitational acceleration $g=9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$,\n- kinematic viscosity $\\nu=1.50\\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$,\n- thermal diffusivity $\\alpha=2.10\\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$,\n- thermal expansion coefficient $\\beta=1/T_{0}$,\n\nevaluate the appropriate velocity scaling regime and compute the numerical estimate of the time to reach quasi-steady conditions. Round your final answer to three significant figures. Express the final time in seconds.",
            "solution": "The problem requires the derivation of characteristic time scales for natural convection in a differentially heated square cavity and a subsequent numerical estimation. I will first validate the problem, which is a necessary prerequisite for any rigorous scientific analysis.\n\nThe problem statement provides a well-defined physical scenario: a two-dimensional square cavity of side $L$ filled with air, initially at $T_0$. At $t=0$, the vertical walls are set to $T_h$ and $T_c$ ($T_h  T_c$), while horizontal walls are insulated. The analysis is to be based on the incompressible Navier-Stokes and energy equations, simplified by the Boussinesq approximation. All necessary data, including geometric, thermal, and fluid properties, are provided. The problem is scientifically grounded, well-posed, objective, and complete. There are no contradictions or physically implausible conditions. The problem is declared valid.\n\nWe begin with the governing equations for mass, momentum, and energy in two dimensions, assuming gravity acts in the $-y$ direction and the temperature gradient is imposed in the $x$ direction.\nContinuity:\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0 $$\nMomentum ($x$):\n$$ \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = -\\frac{1}{\\rho_0} \\frac{\\partial P'}{\\partial x} + \\nu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right) $$\nMomentum ($y$):\n$$ \\frac{\\partial v}{\\partial t} + u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} = -\\frac{1}{\\rho_0} \\frac{\\partial P'}{\\partial y} + g\\beta(T - T_c) + \\nu \\left( \\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2} \\right) $$\nEnergy:\n$$ \\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) $$\nHere, $u$ and $v$ are velocity components, $P'$ is dynamic pressure, $T$ is temperature, $\\rho_0$ is reference density, $\\nu$ is kinematic viscosity, $\\alpha$ is thermal diffusivity, $g$ is gravitational acceleration, and $\\beta$ is the thermal expansion coefficient. We have chosen the reference temperature for buoyancy to be $T_c$ for convenience, but any reference temperature would lead to a temperature difference scale of $\\Delta T = T_h - T_c$.\n\nWe perform a scaling analysis by introducing characteristic scales: length $L$, velocity $U$, time $t_{char}$, and temperature difference $\\Delta T$.\nThe derivatives scale as $\\frac{\\partial}{\\partial t} \\sim \\frac{1}{t_{char}}$, spatial gradients $\\nabla \\sim \\frac{1}{L}$, and Laplacian $\\nabla^2 \\sim \\frac{1}{L^2}$.\n\n(a) Characteristic Thermal Diffusion Time ($t_{diff}$)\nThis time scale governs heat transfer in the absence of fluid motion (convection). It is found by balancing the unsteady term and the diffusion term in the energy equation:\n$$ \\frac{\\partial T}{\\partial t} \\sim \\alpha \\nabla^2 T $$\nSubstituting the scales:\n$$ \\frac{\\Delta T}{t_{diff}} \\sim \\alpha \\frac{\\Delta T}{L^2} $$\nThis yields the expression for the thermal diffusion time:\n$$ t_{diff} \\sim \\frac{L^2}{\\alpha} $$\n\n(b) Characteristic Convective Circulation Time ($t_{conv}$)\nThis is the time required for a fluid parcel to travel a characteristic distance $L$ at the characteristic velocity $U$.\n$$ t_{conv} \\sim \\frac{L}{U} $$\nThe velocity scale $U$ is unknown and must be determined from a force balance in the momentum equation. In the quasi-steady state, the driving buoyancy force is balanced by either viscous or inertial forces. We scale the vertical momentum equation, which contains the buoyancy term $g\\beta(T - T_c) \\sim g\\beta\\Delta T$. The opposing forces are inertia, $\\mathbf{u} \\cdot \\nabla \\mathbf{u} \\sim U^2/L$, and viscous drag, $\\nu \\nabla^2 \\mathbf{u} \\sim \\nu U/L^2$.\n\nViscous-dominated balance: This occurs when viscous forces are much larger than inertial forces.\n$$ g\\beta\\Delta T \\sim \\nu \\frac{U_{visc}}{L^2} $$\nThe resulting velocity scale is:\n$$ U_{visc} \\sim \\frac{g\\beta\\Delta T L^2}{\\nu} $$\nThe corresponding convective time is:\n$$ t_{conv, visc} \\sim \\frac{L}{U_{visc}} = \\frac{\\nu}{g\\beta\\Delta T L} $$\n\nInertia-dominated balance: This occurs when inertial forces are much larger than viscous forces.\n$$ g\\beta\\Delta T \\sim \\frac{U_{inert}^2}{L} $$\nThe resulting velocity scale is:\n$$ U_{inert} \\sim \\sqrt{g\\beta\\Delta T L} $$\nThe corresponding convective time is:\n$$ t_{conv, inert} \\sim \\frac{L}{U_{inert}} = \\sqrt{\\frac{L}{g\\beta\\Delta T}} $$\n\nThe prevailing regime is determined by the ratio of the inertial term to the viscous term. Using the viscous velocity scale $U_{visc}$, we can form a Reynolds number that indicates the importance of inertia: $Re = \\frac{U_{visc}L}{\\nu} = \\frac{(g\\beta\\Delta T L^2/\\nu)L}{\\nu} = \\frac{g\\beta\\Delta T L^3}{\\nu^2}$. This dimensionless group is the ratio of the Rayleigh number ($Ra = \\frac{g\\beta\\Delta T L^3}{\\nu\\alpha}$) to the Prandtl number ($Pr = \\frac{\\nu}{\\alpha}$). So, the criterion is $Ra/Pr$. If $Ra/Pr \\ll 1$, the flow is viscous-dominated. If $Ra/Pr \\gg 1$, the flow is inertia-dominated.\n\nComposite Estimate for Time to Quasi-Steady State ($t_{qs}$)\nThe problem explicitly instructs to estimate the time to reach a quasi-steady field as the *slower* of the two mechanisms: thermal diffusion and convective circulation. The slower mechanism is the one with the longer characteristic time. Therefore, the composite time is:\n$$ t_{qs} = \\max(t_{diff}, t_{conv}) $$\n\nNumerical Evaluation\nWe now substitute the provided numerical values:\n- $L = 1.00 \\times 10^{-2}\\,\\mathrm{m}$\n- $\\Delta T = 10.0\\,\\mathrm{K}$\n- $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- $\\nu = 1.50 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n- $\\alpha = 2.10 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n- $T_{0} = 300\\,\\mathrm{K}$, so $\\beta = 1/T_0 = 1/300\\,\\mathrm{K}^{-1}$\n\nFirst, we determine the flow regime by calculating the dimensionless parameter $Ra/Pr$.\n$$ Pr = \\frac{\\nu}{\\alpha} = \\frac{1.50 \\times 10^{-5}}{2.10 \\times 10^{-5}} \\approx 0.7143 $$\n$$ Ra = \\frac{g\\beta\\Delta T L^3}{\\nu\\alpha} = \\frac{(9.81)\\left(\\frac{1}{300}\\right)(10.0)(1.00 \\times 10^{-2})^3}{(1.50 \\times 10^{-5})(2.10 \\times 10^{-5})} $$\n$$ Ra = \\frac{(9.81)(10.0)(10^{-6})}{300(3.15 \\times 10^{-10})} = \\frac{9.81 \\times 10^{-5}}{9.45 \\times 10^{-8}} \\approx 1038 $$\nThe regime criterion is:\n$$ \\frac{Ra}{Pr} = \\frac{1038}{0.7143} \\approx 1453 $$\nSince $Ra/Pr = 1453 \\gg 1$, the momentum balance is inertia-dominated. We must use the expressions for this regime.\n\nNext, we compute the characteristic times.\nThe thermal diffusion time is:\n$$ t_{diff} = \\frac{L^2}{\\alpha} = \\frac{(1.00 \\times 10^{-2})^2}{2.10 \\times 10^{-5}} = \\frac{1.00 \\times 10^{-4}}{2.10 \\times 10^{-5}}\\,\\mathrm{s} \\approx 4.7619\\,\\mathrm{s} $$\nThe convective circulation time is $t_{conv, inert}$:\n$$ t_{conv} = \\sqrt{\\frac{L}{g\\beta\\Delta T}} = \\sqrt{\\frac{1.00 \\times 10^{-2}}{(9.81)\\left(\\frac{1}{300}\\right)(10.0)}} = \\sqrt{\\frac{1.00 \\times 10^{-2}}{0.327}}\\,\\mathrm{s} \\approx \\sqrt{0.03058}\\,\\mathrm{s} \\approx 0.1749\\,\\mathrm{s} $$\nFinally, we determine the time to reach quasi-steady state using the specified composite model:\n$$ t_{qs} = \\max(t_{diff}, t_{conv}) = \\max(4.7619\\,\\mathrm{s}, 0.1749\\,\\mathrm{s}) = 4.7619\\,\\mathrm{s} $$\nRounding the final answer to three significant figures, we get $4.76\\,\\mathrm{s}$.\nThe physical interpretation is that, for these parameters, convection establishes a flow pattern very quickly relative to the time it takes for heat to diffuse across the bulk of the cavity. Thus, according to the problem's specified criterion, the overall transient is limited by the much slower thermal diffusion process.",
            "answer": "$$\n\\boxed{4.76}\n$$"
        },
        {
            "introduction": "While the Boussinesq approximation is a powerful simplification, many real-world applications involve large temperature differences that necessitate accounting for variable fluid properties. This practice challenges you to move beyond this idealization by modeling natural convection in an ideal gas with temperature-dependent viscosity and conductivity. You will derive and implement an effective Rayleigh number based on property averages, providing a more accurate measure of convective driving force and a quantitative metric to assess the validity of the Boussinesq assumption itself.",
            "id": "3975207",
            "problem": "Consider a two-dimensional, differentially heated, sealed rectangular enclosure of height $H$ and width $W$ filled with a single-component ideal gas. The left wall is isothermal at temperature $T_h$ and the right wall is isothermal at temperature $T_c$, with $T_h gt; T_c$. Assume gravity of magnitude $g$ acts downward. In the absence of motion, the conduction baseline temperature field varies linearly across the width: $T(x) = T_c + (T_h - T_c) x / W$ for $x \\in [0,W]$, and is uniform in the vertical direction. You are tasked with quantifying variable-property and non-Boussinesq effects on the buoyancy driving of natural convection by constructing an effective dimensionless control parameter and a non-Boussinesq validity metric, starting from first principles.\n\nFundamental base and constitutive assumptions:\n- Mass conservation: $\\dfrac{D \\rho}{D t} + \\rho \\nabla \\cdot \\mathbf{u} = 0$.\n- Momentum: $\\rho \\dfrac{D \\mathbf{u}}{D t} = -\\nabla p + \\rho \\mathbf{g} + \\nabla \\cdot \\left[ \\mu \\left( \\nabla \\mathbf{u} + \\nabla \\mathbf{u}^\\top \\right) \\right]$.\n- Energy (neglecting viscous dissipation and volumetric heating): $\\rho c_p \\dfrac{D T}{D t} = \\nabla \\cdot (k \\nabla T)$.\n- Equation of state (ideal gas): $\\rho = \\dfrac{p}{R T}$.\n- Pressure is decomposed into a spatially uniform reference $p_0$ and a small perturbation $p^\\prime$ consistent with a low-Mach-number assumption; material properties depend on temperature only.\n- Dynamic viscosity and thermal conductivity follow temperature power laws: $\\mu(T) = \\mu_0 \\left( \\dfrac{T}{T_0} \\right)^{s_\\mu}$ and $k(T) = k_0 \\left( \\dfrac{T}{T_0} \\right)^{s_k}$, where $T_0$ is a reference temperature and $s_\\mu$, $s_k$ are given exponents. The specific heat at constant pressure $c_p$ is constant.\n\nDefinitions to be used:\n- Kinematic viscosity: $\\nu(T) = \\dfrac{\\mu(T)}{\\rho(T)}$.\n- Thermal diffusivity: $\\alpha(T) = \\dfrac{k(T)}{\\rho(T) c_p}$.\n- Isobaric thermal expansion coefficient for an ideal gas: $\\beta(T) = \\dfrac{1}{T}$.\n- Conduction-field spatial average across the width for any scalar function $g(T(x))$: $\\langle g \\rangle = \\dfrac{1}{W} \\int_0^W g(T(x)) \\, dx$. Because $T(x)$ is linear in $x$, this average can be equivalently expressed as $\\langle g \\rangle = \\dfrac{1}{\\Delta T} \\int_{T_c}^{T_h} g(T) \\, dT$, where $\\Delta T = T_h - T_c$.\n\nTasks:\n1) Starting from the governing equations and the above definitions, and using the conduction baseline temperature field for averaging, construct an effective dimensionless control parameter that reduces to the classical Rayleigh number under constant-property conditions but accounts for temperature-dependent properties by replacing constant properties with conduction-field averages. Express it in terms of $g$, $H$, $\\Delta T$, and the conduction-field averages $\\langle \\beta \\rangle$, $\\langle \\nu \\rangle$, and $\\langle \\alpha \\rangle$. The final quantity must be dimensionless. No physical units should appear in your final numerical results.\n\n2) Quantify non-Boussinesq effects using the maximum relative density variation across the width with respect to a reference temperature $T_{\\text{ref}} = \\dfrac{T_h + T_c}{2}$:\n$$\n\\mathcal{N}_B = \\max_{x \\in [0,W]} \\left| \\dfrac{\\rho(T(x)) - \\rho(T_{\\text{ref}})}{\\rho(T_{\\text{ref}})} \\right|.\n$$\nReport $\\mathcal{N}_B$ and a boolean flag indicating whether the Oberbeck–Boussinesq approximation is acceptable, using the criterion $\\mathcal{N}_B \\le 0.1$.\n\n3) Implement a program that, for each test case below, computes:\n- The effective dimensionless control parameter from Task $1$ (call it the effective Rayleigh number).\n- The non-Boussinesq metric $\\mathcal{N}_B$ from Task $2$.\n- The boolean validity flag defined in Task $2$.\n\nTest suite specification:\nUse the following parameter sets. All inputs are to be interpreted in the units indicated here: $g$ in $\\mathrm{m/s^2}$, $H$ and $W$ in $\\mathrm{m}$, $T_h$, $T_c$, and $T_0$ in $\\mathrm{K}$, $p_0$ in $\\mathrm{Pa}$, $\\mu_0$ in $\\mathrm{Pa \\cdot s}$, $k_0$ in $\\mathrm{W/(m \\cdot K)}$, $c_p$ and $R$ in $\\mathrm{J/(kg \\cdot K)}$. The outputs must be dimensionless.\n- Case A (small temperature difference, variable properties): $g=9.81$, $H=0.5$, $W$ arbitrary, $T_h=301$, $T_c=300$, $T_0=300$, $p_0=101325$, $\\mu_0=1.846\\times 10^{-5}$, $k_0=0.02624$, $c_p=1005$, $R=287.058$, $s_\\mu=1.5$, $s_k=1.5$.\n- Case B (moderate temperature difference, variable properties): same as Case A but $T_h=340$, $T_c=300$.\n- Case C (large temperature difference, variable properties): same as Case A but $T_h=450$, $T_c=300$.\n- Case D (moderate temperature difference, constant transport properties): same as Case B but $s_\\mu=0$, $s_k=0$.\n- Case E (moderate temperature difference, reduced ambient pressure): same as Case B but $p_0=50662.5$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of the form $[ \\text{Ra\\_eff}, \\mathcal{N}_B, \\text{BoussinesqValid} ]$, where $\\text{Ra\\_eff}$ and $\\mathcal{N}_B$ are floating-point numbers and $\\text{BoussinesqValid}$ is a boolean. For example: \"[[1.23,0.01,True],[...],...]\". All outputs are dimensionless; do not include any physical units in the printed results.",
            "solution": "The user-provided problem has been analyzed and is deemed valid. It is scientifically grounded in the principles of fluid dynamics and heat transfer, is well-posed with all necessary information provided, and is expressed in objective, formal language. The task is to derive and compute two key dimensionless parameters related to natural convection in an enclosure with an ideal gas, accounting for temperature-dependent properties.\n\n### Task 1: Derivation of the Effective Rayleigh Number ($\\text{Ra}_{\\text{eff}}$)\n\nThe objective is to construct an effective Rayleigh number that extends the classical definition to account for temperature-dependent fluid properties. The classical Rayleigh number for a Boussinesq fluid is given by:\n$$\n\\text{Ra} = \\frac{g \\beta \\Delta T H^3}{\\nu \\alpha}\n$$\nwhere $g$ is the acceleration due to gravity, $\\beta$ is the thermal expansion coefficient, $\\Delta T = T_h - T_c$ is the temperature difference across the enclosure, $H$ is the enclosure height, $\\nu$ is the kinematic viscosity, and $\\alpha$ is the thermal diffusivity.\n\nFor a non-Boussinesq fluid where properties vary significantly with temperature, we replace the constant properties $\\beta$, $\\nu$, and $\\alpha$ with effective values obtained by averaging them over the conduction temperature profile $T(x)$. The problem defines this average for a function $f(T)$ as:\n$$\n\\langle f \\rangle = \\frac{1}{\\Delta T} \\int_{T_c}^{T_h} f(T) \\, dT\n$$\nThe effective Rayleigh number, $\\text{Ra}_{\\text{eff}}$, is thus defined as:\n$$\n\\text{Ra}_{\\text{eff}} = \\frac{g \\langle \\beta \\rangle \\Delta T H^3}{\\langle \\nu \\rangle \\langle \\alpha \\rangle}\n$$\nWe now derive the expressions for the averaged properties.\n\n**1. Average Thermal Expansion Coefficient, $\\langle \\beta \\rangle$**\nFor an ideal gas, the isobaric coefficient of thermal expansion is $\\beta(T) = 1/T$. Its average is:\n$$\n\\langle \\beta \\rangle = \\frac{1}{\\Delta T} \\int_{T_c}^{T_h} \\frac{1}{T} \\, dT = \\frac{1}{\\Delta T} [\\ln(T)]_{T_c}^{T_h} = \\frac{\\ln(T_h) - \\ln(T_c)}{\\Delta T} = \\frac{\\ln(T_h/T_c)}{T_h - T_c}\n$$\nThe term $g \\langle \\beta \\rangle \\Delta T$ in the numerator of $\\text{Ra}_{\\text{eff}}$ simplifies to $g \\ln(T_h/T_c)$.\n\n**2. Average Kinematic Viscosity, $\\langle \\nu \\rangle$**\nKinematic viscosity is $\\nu(T) = \\mu(T)/\\rho(T)$. The dynamic viscosity $\\mu(T)$ and density $\\rho(T)$ are given by:\n$$\n\\mu(T) = \\mu_0 \\left( \\frac{T}{T_0} \\right)^{s_\\mu} \\quad \\text{and} \\quad \\rho(T) = \\frac{p_0}{R T}\n$$\nwhere the low-Mach-number assumption allows using the reference pressure $p_0$ in the ideal gas law. Combining these gives:\n$$\n\\nu(T) = \\frac{\\mu_0 (T/T_0)^{s_\\mu}}{p_0/(R T)} = \\frac{\\mu_0 R}{p_0 T_0^{s_\\mu}} T^{s_\\mu+1}\n$$\nAveraging this expression over the temperature range:\n$$\n\\langle \\nu \\rangle = \\frac{1}{\\Delta T} \\int_{T_c}^{T_h} \\left( \\frac{\\mu_0 R}{p_0 T_0^{s_\\mu}} T^{s_\\mu+1} \\right) dT = \\frac{\\mu_0 R}{p_0 T_0^{s_\\mu} \\Delta T} \\left[ \\frac{T^{s_\\mu+2}}{s_\\mu+2} \\right]_{T_c}^{T_h}\n$$\n$$\n\\langle \\nu \\rangle = \\frac{\\mu_0 R}{p_0 T_0^{s_\\mu} (s_\\mu+2)} \\frac{T_h^{s_\\mu+2} - T_c^{s_\\mu+2}}{T_h - T_c}\n$$\nThis formula is valid for $s_\\mu \\neq -2$.\n\n**3. Average Thermal Diffusivity, $\\langle \\alpha \\rangle$**\nThermal diffusivity is $\\alpha(T) = k(T) / (\\rho(T) c_p)$. The thermal conductivity $k(T)$ is given as:\n$$\nk(T) = k_0 \\left( \\frac{T}{T_0} \\right)^{s_k}\n$$\nWith constant $c_p$ and $\\rho(T) = p_0/(RT)$, the thermal diffusivity is:\n$$\n\\alpha(T) = \\frac{k_0 (T/T_0)^{s_k}}{(p_0/(R T)) c_p} = \\frac{k_0 R}{p_0 c_p T_0^{s_k}} T^{s_k+1}\n$$\nThe functional form is identical to that of $\\nu(T)$. The average is therefore:\n$$\n\\langle \\alpha \\rangle = \\frac{1}{\\Delta T} \\int_{T_c}^{T_h} \\left( \\frac{k_0 R}{p_0 c_p T_0^{s_k}} T^{s_k+1} \\right) dT = \\frac{k_0 R}{p_0 c_p T_0^{s_k} \\Delta T} \\left[ \\frac{T^{s_k+2}}{s_k+2} \\right]_{T_c}^{T_h}\n$$\n$$\n\\langle \\alpha \\rangle = \\frac{k_0 R}{p_0 c_p T_0^{s_k} (s_k+2)} \\frac{T_h^{s_k+2} - T_c^{s_k+2}}{T_h - T_c}\n$$\nThis formula is valid for $s_k \\neq -2$.\n\nBy substituting these averaged quantities into the definition of $\\text{Ra}_{\\text{eff}}$, we can compute its value for the given test cases.\n\n### Task 2: Derivation of the Non-Boussinesq Metric ($\\mathcal{N}_B$)\n\nThe non-Boussinesq metric $\\mathcal{N}_B$ is defined as the maximum relative density variation across the domain with respect to the density at the arithmetic mean temperature, $T_{\\text{ref}} = (T_h + T_c)/2$.\n$$\n\\mathcal{N}_B = \\max_{x \\in [0,W]} \\left| \\frac{\\rho(T(x)) - \\rho(T_{\\text{ref}})}{\\rho(T_{\\text{ref}})} \\right|\n$$\nSince temperature $T(x)$ varies monotonically from $T_c$ to $T_h$, this is equivalent to maximizing over the temperature interval $T \\in [T_c, T_h]$. Substituting the ideal gas law $\\rho(T) = p_0/(RT)$:\n$$\n\\mathcal{N}_B = \\max_{T \\in [T_c, T_h]} \\left| \\frac{p_0/(RT) - p_0/(RT_{\\text{ref}})}{p_0/(RT_{\\text{ref}})} \\right| = \\max_{T \\in [T_c, T_h]} \\left| \\frac{1/T - 1/T_{\\text{ref}}}{1/T_{\\text{ref}}} \\right| = \\max_{T \\in [T_c, T_h]} \\left| \\frac{T_{\\text{ref}}}{T} - 1 \\right|\n$$\nThe function $f(T) = T_{\\text{ref}}/T - 1$ is a strictly monotonic decreasing function for $T  0$. Therefore, the maximum of its absolute value on the interval $[T_c, T_h]$ must occur at one of the endpoints. We evaluate $|f(T)|$ at $T=T_c$ and $T=T_h$:\n$$\n|f(T_c)| = \\left| \\frac{T_{\\text{ref}}}{T_c} - 1 \\right| = \\left| \\frac{(T_h+T_c)/2}{T_c} - 1 \\right| = \\left| \\frac{T_h+T_c-2T_c}{2T_c} \\right| = \\frac{T_h - T_c}{2T_c}\n$$\n$$\n|f(T_h)| = \\left| \\frac{T_{\\text{ref}}}{T_h} - 1 \\right| = \\left| \\frac{(T_h+T_c)/2}{T_h} - 1 \\right| = \\left| \\frac{T_h+T_c-2T_h}{2T_h} \\right| = \\frac{T_h - T_c}{2T_h}\n$$\nSince $T_h  T_c  0$, we have $1/T_c  1/T_h$, which implies $|f(T_c)|  |f(T_h)|$. Thus, the maximum occurs at $T=T_c$:\n$$\n\\mathcal{N}_B = \\frac{T_h - T_c}{2 T_c}\n$$\nThe Oberbeck-Boussinesq approximation is considered acceptable if $\\mathcal{N}_B \\le 0.1$. This condition provides a quantitative criterion for the boolean flag.\nThese derived formulas will be implemented in the final program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effective Rayleigh number and non-Boussinesq metric for a series of test cases.\n    \"\"\"\n    # Test suite specification as a list of tuples.\n    # Format: (g, H, Th, Tc, T0, p0, mu0, k0, cp, R, s_mu, s_k)\n    test_cases = [\n        # Case A\n        (9.81, 0.5, 301.0, 300.0, 300.0, 101325.0, 1.846e-5, 0.02624, 1005.0, 287.058, 1.5, 1.5),\n        # Case B\n        (9.81, 0.5, 340.0, 300.0, 300.0, 101325.0, 1.846e-5, 0.02624, 1005.0, 287.058, 1.5, 1.5),\n        # Case C\n        (9.81, 0.5, 450.0, 300.0, 300.0, 101325.0, 1.846e-5, 0.02624, 1005.0, 287.058, 1.5, 1.5),\n        # Case D\n        (9.81, 0.5, 340.0, 300.0, 300.0, 101325.0, 1.846e-5, 0.02624, 1005.0, 287.058, 0.0, 0.0),\n        # Case E\n        (9.81, 0.5, 340.0, 300.0, 300.0, 50662.5, 1.846e-5, 0.02624, 1005.0, 287.058, 1.5, 1.5)\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        g, H, T_h, T_c, T_0, p_0, mu_0, k_0, c_p, R, s_mu, s_k = case\n\n        delta_T = T_h - T_c\n\n        # Task 1: Calculate the effective Rayleigh number (Ra_eff)\n        \n        # Numerator of Ra_eff: g * beta * delta_T * H^3\n        # This simplifies to g * ln(T_h/T_c) * H^3\n        numerator_ra = g * np.log(T_h / T_c) * H**3\n\n        # Denominator of Ra_eff: nu * alpha\n        # Calculate conduction-field average of kinematic viscosity, nu\n        if s_mu == -2.0:\n            # This edge case is not in the test suite but included for robustness\n            integral_term_nu = np.log(T_h / T_c)\n        else:\n            integral_term_nu = (T_h**(s_mu + 2.0) - T_c**(s_mu + 2.0)) / (s_mu + 2.0)\n        \n        avg_nu = (mu_0 * R) / (p_0 * T_0**s_mu * delta_T) * integral_term_nu\n\n        # Calculate conduction-field average of thermal diffusivity, alpha\n        if s_k == -2.0:\n            # This edge case is not in the test suite but included for robustness\n            integral_term_alpha = np.log(T_h / T_c)\n        else:\n            integral_term_alpha = (T_h**(s_k + 2.0) - T_c**(s_k + 2.0)) / (s_k + 2.0)\n            \n        avg_alpha = (k_0 * R) / (p_0 * c_p * T_0**s_k * delta_T) * integral_term_alpha\n        \n        denominator_ra = avg_nu * avg_alpha\n        \n        ra_eff = numerator_ra / denominator_ra\n\n        # Task 2: Calculate the non-Boussinesq metric (N_B) and validity flag\n        n_b = (T_h - T_c) / (2.0 * T_c)\n        boussinesq_valid = n_b = 0.1\n\n        results.append([ra_eff, n_b, boussinesq_valid])\n\n    # Format the final output string as a list of lists, without extra spaces.\n    # Example: [[Ra_eff1,N_B1,Valid1],[Ra_eff2,N_B2,Valid2],...]\n    result_strings = []\n    for res_list in results:\n        # Python's str(bool) produces 'True' or 'False', which matches the desired format.\n        result_strings.append(f\"[{res_list[0]},{res_list[1]},{res_list[2]}]\")\n    \n    final_output_string = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "Accurate computational simulations depend not only on a correct physical model but also on the numerical method's ability to resolve key features of the solution. This exercise focuses on a common challenge in enclosure flows: the presence of heat flux singularities at corners where isothermal and adiabatic walls meet. By modeling this singularity and testing the performance of a standard numerical integration scheme at different resolutions, you will gain practical insight into how solution smoothness impacts numerical accuracy and the importance of grid refinement in computational heat transfer.",
            "id": "3975221",
            "problem": "Consider a two-dimensional square enclosure of characteristic length $L$ filled with a Newtonian fluid under the Boussinesq approximation. The left wall is held at a uniform nondimensional temperature $T = 1$, the right wall is held at a uniform nondimensional temperature $T = 0$, and the top and bottom walls are adiabatic. Gravity acts downward, driving buoyancy-induced natural convection. Under nondimensionalization by $L$, the characteristic velocity $U$ arising from the buoyancy scaling, and the temperature difference $\\Delta T$, the governing equations for the velocity field $\\boldsymbol{u} = (u, v)$, pressure $p$, and temperature $T$ are the incompressible Navier–Stokes equations with buoyancy and the energy equation:\n- Continuity: $\\nabla \\cdot \\boldsymbol{u} = 0$.\n- Momentum: $\\boldsymbol{u} \\cdot \\nabla \\boldsymbol{u} = -\\nabla p + \\frac{1}{\\sqrt{\\mathrm{Gr}}} \\nabla^2 \\boldsymbol{u} + \\mathrm{Ra}^{1/2} \\, \\mathrm{Pr}^{1/2} \\, T \\, \\hat{\\boldsymbol{g}}$.\n- Energy: $\\boldsymbol{u} \\cdot \\nabla T = \\frac{1}{\\sqrt{\\mathrm{Gr}}\\mathrm{Pr}} \\nabla^2 T$.\n\nHere, $\\mathrm{Gr}$ is the Grashof number, $\\mathrm{Pr}$ is the Prandtl number, and $\\mathrm{Ra} = \\mathrm{Gr}\\,\\mathrm{Pr}$ is the Rayleigh number. Near the lower-left corner where the hot wall meets the adiabatic bottom wall, the velocity magnitude is small due to the no-slip condition, and the convective term in the energy equation becomes negligible compared to conduction. In this local regime, the temperature field is governed by the Laplace equation $\\nabla^2 T = 0$ in a right-angled wedge with mixed boundary conditions (Dirichlet on the hot wall, Neumann on the bottom wall). From classical potential theory for mixed boundary conditions in convex wedges, the normal heat flux along the hot wall exhibits a corner singularity of the form $q(y) \\sim C y^{-1/2}$ as $y \\to 0^+$, where $y$ is the vertical distance measured upward from the corner along the hot wall, $q(y)$ is the nondimensional local normal heat flux, and $C$ is a positive amplitude that depends on the global solution but is treated as a parameter in a localized model. Physical diffusion regularizes the singularity at very small scales, which can be modeled by a small positive smoothing length $\\epsilon$ so that the local flux is approximated by $q(y) = C\\, (y + \\epsilon)^{-1/2} + q_{\\infty}$, where $q_{\\infty} \\ge 0$ is a slowly varying background contribution away from the corner.\n\nYour task is to write a complete, runnable program that quantifies how a uniform numerical resolution with nominal spacing $h$ represents the corner singular contribution to the average wall heat transfer. Specifically:\n\n- Model the nondimensional local heat flux along the hot wall as $q(y) = C\\, (y + \\epsilon)^{-1/2} + q_{\\infty}$ for $y \\in [0, L]$, where $L$ is the nondimensional wall length, $C  0$ is the singular amplitude, $q_{\\infty} \\ge 0$ is a background contribution, and $\\epsilon  0$ is a small regularization length.\n- Define the exact average Nusselt number on the hot wall as $\\overline{\\mathrm{Nu}}_{\\mathrm{exact}} = \\frac{1}{L} \\int_{0}^{L} q(y) \\, dy$ and the numerically resolved average Nusselt number $\\overline{\\mathrm{Nu}}_{h}$ by applying the composite trapezoidal rule on a uniform mesh determined by the nominal spacing $h$:\n  - Choose the number of panels as $N = \\max\\left(1, \\left\\lfloor \\frac{L}{h} + \\frac{1}{2} \\right\\rfloor\\right)$.\n  - Set the uniform step $\\Delta = \\frac{L}{N}$ and the nodes $y_i = i \\Delta$ for $i = 0, 1, \\dots, N$.\n  - Compute the trapezoidal approximation $I_h = \\Delta \\left( \\frac{q(y_0)}{2} + \\sum_{i=1}^{N-1} q(y_i) + \\frac{q(y_N)}{2} \\right)$ and $\\overline{\\mathrm{Nu}}_{h} = \\frac{I_h}{L}$.\n- Compute the relative error $E = \\left|\\overline{\\mathrm{Nu}}_{h} - \\overline{\\mathrm{Nu}}_{\\mathrm{exact}}\\right| \\big/ \\overline{\\mathrm{Nu}}_{\\mathrm{exact}}$.\n\nAll quantities are nondimensional; thus, report all outputs as unitless decimal numbers rounded to six digits after the decimal point.\n\nTest Suite:\nUse the following parameter sets $(L, C, q_{\\infty}, \\epsilon, h)$ to test different numerical resolutions and corner regularizations:\n- Case 1: $(L, C, q_{\\infty}, \\epsilon, h) = (1, 1.0, 0.0, 10^{-6}, 0.02)$\n- Case 2: $(L, C, q_{\\infty}, \\epsilon, h) = (1, 1.0, 0.0, 10^{-6}, 0.2)$\n- Case 3: $(L, C, q_{\\infty}, \\epsilon, h) = (1, 1.0, 0.1, 10^{-4}, 0.05)$\n- Case 4: $(L, C, q_{\\infty}, \\epsilon, h) = (0.5, 0.5, 0.05, 10^{-5}, 0.025)$\n- Case 5: $(L, C, q_{\\infty}, \\epsilon, h) = (1, 2.0, 0.0, 10^{-8}, 0.01)$\n\nYour program should produce a single line of output containing the relative error results $E$ for the five cases, as a comma-separated list enclosed in square brackets, with each entry rounded to six digits after the decimal point (for example, $[0.123456,0.000001,0.987654,0.500000,0.333333]$).",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Physical System**: A two-dimensional square enclosure of characteristic length $L$ filled with a Newtonian fluid under the Boussinesq approximation.\n- **Boundary Conditions**: Left wall at nondimensional temperature $T=1$, right wall at $T=0$, top and bottom walls are adiabatic. Gravity acts downward.\n- **Governing Equations (Nondimensional)**:\n  - Continuity: $\\nabla \\cdot \\boldsymbol{u} = 0$.\n  - Momentum: $\\boldsymbol{u} \\cdot \\nabla \\boldsymbol{u} = -\\nabla p + \\frac{1}{\\sqrt{\\mathrm{Gr}}} \\nabla^2 \\boldsymbol{u} + \\mathrm{Ra}^{1/2} \\, \\mathrm{Pr}^{1/2} \\, T \\, \\hat{\\boldsymbol{g}}$.\n  - Energy: $\\boldsymbol{u} \\cdot \\nabla T = \\frac{1}{\\sqrt{\\mathrm{Gr}}\\mathrm{Pr}} \\nabla^2 T$.\n- **Local Heat Flux Model**: The nondimensional local heat flux along the hot wall ($y \\in [0, L]$) is modeled as $q(y) = C\\, (y + \\epsilon)^{-1/2} + q_{\\infty}$.\n- **Parameters**: $L$ is the nondimensional wall length, $C  0$ is the singular amplitude, $q_{\\infty} \\ge 0$ is a background contribution, and $\\epsilon  0$ is a small regularization length.\n- **Exact Average Nusselt Number**: $\\overline{\\mathrm{Nu}}_{\\mathrm{exact}} = \\frac{1}{L} \\int_{0}^{L} q(y) \\, dy$.\n- **Numerical Average Nusselt Number**: $\\overline{\\mathrm{Nu}}_{h}$ is computed using the composite trapezoidal rule.\n  - **Number of Panels**: $N = \\max\\left(1, \\left\\lfloor \\frac{L}{h} + \\frac{1}{2} \\right\\rfloor\\right)$, where $h$ is the nominal spacing.\n  - **Mesh**: Uniform step $\\Delta = \\frac{L}{N}$ and nodes $y_i = i \\Delta$ for $i = 0, 1, \\dots, N$.\n  - **Trapezoidal Rule Integral**: $I_h = \\Delta \\left( \\frac{q(y_0)}{2} + \\sum_{i=1}^{N-1} q(y_i) + \\frac{q(y_N)}{2} \\right)$.\n  - **Numerical Average**: $\\overline{\\mathrm{Nu}}_{h} = \\frac{I_h}{L}$.\n- **Error Metric**: Relative error $E = \\left|\\overline{\\mathrm{Nu}}_{h} - \\overline{\\mathrm{Nu}}_{\\mathrm{exact}}\\right| \\big/ \\overline{\\mathrm{Nu}}_{\\mathrm{exact}}$.\n- **Test Suite**:\n  - Case $1$: $(L, C, q_{\\infty}, \\epsilon, h) = (1, 1.0, 0.0, 10^{-6}, 0.02)$.\n  - Case $2$: $(L, C, q_{\\infty}, \\epsilon, h) = (1, 1.0, 0.0, 10^{-6}, 0.2)$.\n  - Case $3$: $(L, C, q_{\\infty}, \\epsilon, h) = (1, 1.0, 0.1, 10^{-4}, 0.05)$.\n  - Case $4$: $(L, C, q_{\\infty}, \\epsilon, h) = (0.5, 0.5, 0.05, 10^{-5}, 0.025)$.\n  - Case $5$: $(L, C, q_{\\infty}, \\epsilon, h) = (1, 2.0, 0.0, 10^{-8}, 0.01)$.\n- **Output Format**: A comma-separated list of the five relative error values $E$, enclosed in square brackets, with each value rounded to six digits after the decimal point.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established validation criteria.\n\n- **Scientifically Grounded**: The problem is set within the classical context of natural convection in an enclosure, a fundamental topic in heat transfer and fluid dynamics. The governing equations are the standard nondimensional Navier-Stokes equations under the Boussinesq approximation. The local analysis of the temperature field near the corner, leading to a $\\nabla^2 T = 0$ problem and the resulting $y^{-1/2}$ singularity in the heat flux for a right-angled wedge with mixed Dirichlet-Neumann boundary conditions, is a well-established result from potential theory. The regularization with a small parameter $\\epsilon$ is a standard mathematical technique to handle such singularities in numerical computations. The problem is scientifically sound.\n- **Well-Posed**: The problem asks for the computation of a relative error between an analytically calculable integral and its numerical approximation using a clearly defined method (composite trapezoidal rule). All functions, parameters, and procedures are explicitly defined, leading to a unique and meaningful solution for each test case. The problem is well-posed.\n- **Objective**: The problem is described using precise mathematical formalism and objective language. There are no subjective or ambiguous statements.\n- **Incomplete or Contradictory Setup**: All necessary parameters ($L, C, q_{\\infty}, \\epsilon, h$), formulas for the exact and numerical quantities, and the error metric are provided. The procedure to determine the grid parameters ($N, \\Delta$) is unambiguous. The problem is self-contained and free of contradictions.\n- **Unrealistic or Infeasible**: The physical model is an idealization, but a standard one in the field. The provided parameter values are numerically feasible and serve to test the robustness of the numerical approximation under different conditions (e.g., fine vs. coarse mesh, strong vs. weak singularity regularization). There are no physical or dimensional inconsistencies.\n- **Ill-Posed or Poorly Structured**: All terms are defined. The rounding rule for $N$, $\\lfloor L/h + 1/2 \\rfloor$, is a standard method for rounding to the nearest integer. The use of $\\max(1, \\dots)$ ensures the number of panels is always at least one, which is a sensible safeguard.\n- **Other Flaws**: The problem is neither trivial, as it requires careful implementation of both analytical and numerical components, nor pseudo-profound. It represents a valid and common exercise in numerical analysis applied to engineering problems. It is fully verifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. A reasoned solution will be provided.\n\nThe task is to compute the relative error between the exact analytical value of the average wall heat transfer and its numerical approximation obtained via the composite trapezoidal rule. The solution proceeds in three stages: first, the derivation of the analytical expression for the exact average Nusselt number; second, the formulation of the numerical approximation; and third, the calculation of the relative error.\n\n**1. Analytical Calculation of the Exact Average Nusselt Number**\n\nThe exact average Nusselt number, $\\overline{\\mathrm{Nu}}_{\\mathrm{exact}}$, is defined by the integral of the local heat flux $q(y)$ over the wall length $L$:\n$$\n\\overline{\\mathrm{Nu}}_{\\mathrm{exact}} = \\frac{1}{L} \\int_{0}^{L} q(y) \\, dy\n$$\nThe local heat flux is given by the function:\n$$\nq(y) = C (y + \\epsilon)^{-1/2} + q_{\\infty}\n$$\nThe integral is computed by splitting it into two parts:\n$$\n\\int_{0}^{L} q(y) \\, dy = \\int_{0}^{L} \\left[ C (y + \\epsilon)^{-1/2} + q_{\\infty} \\right] dy = C \\int_{0}^{L} (y + \\epsilon)^{-1/2} \\, dy + q_{\\infty} \\int_{0}^{L} 1 \\, dy\n$$\nThe first term is evaluated using the power rule for integration:\n$$\n\\int (y + \\epsilon)^{-1/2} \\, dy = \\frac{(y + \\epsilon)^{1/2}}{1/2} = 2 \\sqrt{y + \\epsilon}\n$$\nTherefore, the definite integral is:\n$$\nC \\int_{0}^{L} (y + \\epsilon)^{-1/2} \\, dy = C \\left[ 2 \\sqrt{y + \\epsilon} \\right]_{0}^{L} = 2C \\left( \\sqrt{L + \\epsilon} - \\sqrt{\\epsilon} \\right)\n$$\nThe second term is simply:\n$$\nq_{\\infty} \\int_{0}^{L} 1 \\, dy = q_{\\infty} [y]_{0}^{L} = q_{\\infty} L\n$$\nCombining these results, the total integrated heat transfer is:\n$$\nI_{\\mathrm{exact}} = \\int_{0}^{L} q(y) \\, dy = 2C \\left( \\sqrt{L + \\epsilon} - \\sqrt{\\epsilon} \\right) + q_{\\infty} L\n$$\nFinally, dividing by the length $L$ yields the exact average Nusselt number:\n$$\n\\overline{\\mathrm{Nu}}_{\\mathrm{exact}} = \\frac{I_{\\mathrm{exact}}}{L} = \\frac{2C}{L} \\left( \\sqrt{L + \\epsilon} - \\sqrt{\\epsilon} \\right) + q_{\\infty}\n$$\nThis analytical expression will be used to compute the exact value for each test case.\n\n**2. Numerical Approximation of the Average Nusselt Number**\n\nThe numerical approximation, $\\overline{\\mathrm{Nu}}_{h}$, is calculated using the composite trapezoidal rule on a uniform grid. The procedure is as follows:\n\nFirst, the number of panels (subintervals) $N$ is determined from the nominal grid spacing $h$ and the wall length $L$. The formula provided, $N = \\max\\left(1, \\left\\lfloor \\frac{L}{h} + \\frac{1}{2} \\right\\rfloor\\right)$, corresponds to rounding the ratio $L/h$ to the nearest integer, with a minimum value of $1$.\n\nSecond, the uniform step size $\\Delta$ for the grid is calculated as $\\Delta = L/N$. This creates a set of $N+1$ equally spaced nodes $y_i = i \\Delta$ for $i = 0, 1, \\dots, N$, covering the interval $[0, L]$.\n\nThird, the function $q(y)$ is evaluated at each node $y_i$ to obtain the values $q(y_i)$.\n\nFourth, the composite trapezoidal rule is applied to approximate the integral $I_h = \\int_{0}^{L} q(y) \\, dy$:\n$$\nI_{h} = \\Delta \\left( \\frac{q(y_0)}{2} + \\sum_{i=1}^{N-1} q(y_i) + \\frac{q(y_N)}{2} \\right)\n$$\nThis formula can be rewritten for efficient computation as:\n$$\nI_{h} = \\Delta \\left( \\left(\\sum_{i=0}^{N} q(y_i)\\right) - \\frac{q(y_0) + q(y_N)}{2} \\right)\n$$\nThe numerically resolved average Nusselt number is then:\n$$\n\\overline{\\mathrm{Nu}}_{h} = \\frac{I_h}{L}\n$$\n\n**3. Computation of the Relative Error**\n\nWith both the exact value $\\overline{\\mathrm{Nu}}_{\\mathrm{exact}}$ and the numerical approximation $\\overline{\\mathrm{Nu}}_{h}$ computed, the relative error $E$ is calculated according to its definition:\n$$\nE = \\frac{\\left|\\overline{\\mathrm{Nu}}_{h} - \\overline{\\mathrm{Nu}}_{\\mathrm{exact}}\\right|}{\\overline{\\mathrm{Nu}}_{\\mathrm{exact}}}\n$$\nThis calculation will be performed for each of the five test cases provided. The final result for each case will be rounded to six decimal places, as specified. The underlying principle being tested is the accuracy of a standard numerical integration scheme when applied to a function with a near-singular behavior, which is a common challenge in computational physics and engineering. The error is expected to be larger for coarser meshes (larger $h$) and more pronounced singularities (smaller $\\epsilon$).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative error between the exact and numerically approximated\n    average wall heat transfer for several test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (L, C, q_inf, epsilon, h)\n        (1.0, 1.0, 0.0, 1e-6, 0.02),\n        # Case 2:\n        (1.0, 1.0, 0.0, 1e-6, 0.2),\n        # Case 3:\n        (1.0, 1.0, 0.1, 1e-4, 0.05),\n        # Case 4:\n        (0.5, 0.5, 0.05, 1e-5, 0.025),\n        # Case 5:\n        (1.0, 2.0, 0.0, 1e-8, 0.01),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, C, q_inf, epsilon, h = case\n\n        # 1. Analytical Calculation of the Exact Average Nusselt Number\n        # The exact average Nusselt number is given by:\n        # Nu_exact_avg = (1/L) * integral_0^L [C*(y+epsilon)**(-1/2) + q_inf] dy\n        # Nu_exact_avg = (2*C/L) * (sqrt(L+epsilon) - sqrt(epsilon)) + q_inf\n        nu_exact_avg = (2.0 * C / L) * (np.sqrt(L + epsilon) - np.sqrt(epsilon)) + q_inf\n\n        # 2. Numerical Approximation of the Average Nusselt Number\n        \n        # Local heat flux function q(y)\n        def q(y, C_val, epsilon_val, q_inf_val):\n            return C_val * (y + epsilon_val)**(-0.5) + q_inf_val\n\n        # Determine the number of panels, N\n        # N = max(1, floor(L/h + 1/2)), which is rounding L/h to the nearest integer\n        N = max(1, int(L / h + 0.5))\n        \n        # Determine the step size, delta\n        delta = L / N\n        \n        # Create the grid nodes y_i from 0 to L\n        # There are N+1 nodes for N panels\n        y_nodes = np.linspace(0.0, L, N + 1)\n        \n        # Evaluate the function q(y) at each node\n        q_values = q(y_nodes, C, epsilon, q_inf)\n        \n        # Apply the composite trapezoidal rule:\n        # I_h = delta * (q(y0)/2 + sum_{i=1}^{N-1} q(yi) + q(yN)/2)\n        # A numerically stable way to compute this is:\n        # I_h = delta * (sum_{i=0}^{N} q(yi) - (q(y0) + q(yN))/2)\n        integral_sum = np.sum(q_values) - 0.5 * (q_values[0] + q_values[-1])\n        I_h = delta * integral_sum\n        \n        # The numerical average Nusselt number\n        nu_h_avg = I_h / L\n\n        # 3. Computation of the Relative Error\n        if nu_exact_avg == 0:\n            # Avoid division by zero, though unlikely with the given parameters\n            relative_error = 0.0 if nu_h_avg == 0.0 else np.inf\n        else:\n            relative_error = np.abs(nu_h_avg - nu_exact_avg) / np.abs(nu_exact_avg)\n        \n        results.append(relative_error)\n\n    # Format results to six decimal places for the final output\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}