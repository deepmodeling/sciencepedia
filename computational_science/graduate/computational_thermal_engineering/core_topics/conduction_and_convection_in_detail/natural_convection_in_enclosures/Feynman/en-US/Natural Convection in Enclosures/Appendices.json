{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex numerical simulations, a skilled engineer often begins with scaling analysis. This powerful technique provides invaluable physical insight by estimating the magnitude of different terms in the governing equations, revealing the dominant physical processes and their characteristic time scales. This first practice challenges you to dissect the transient natural convection problem in a cavity, deriving the time scales for thermal diffusion and convective circulation to determine which process is the rate-limiting step in reaching a steady state .",
            "id": "2509823",
            "problem": "A square, two-dimensional, sealed cavity of side length $L$ is filled with air initially at a uniform temperature $T_{0}$. At time $t=0$, the left and right vertical walls are suddenly brought and held at uniform temperatures $T_{h}$ and $T_{c}$, respectively, with $T_{h}-T_{c}=\\Delta T$. The top and bottom horizontal walls are perfectly insulated. All walls are no-slip. Assume the Boussinesq approximation is valid and that properties are constant.\n\nStarting from the incompressible mass, momentum, and energy balances and using rational scaling arguments, derive expressions for (a) the characteristic thermal diffusion time across the cavity and (b) the characteristic convective circulation time associated with buoyancy-driven motion, considering both viscous-dominated and inertia-dominated balances in the momentum equation. Use these to propose a single composite estimate for the time to reach a quasi-steady temperature field as the slower of the two mechanisms.\n\nThen, using the given data for air at $T_{0}=300\\,\\mathrm{K}$,\n- $L=1.00\\times 10^{-2}\\,\\mathrm{m}$,\n- $\\Delta T=10.0\\,\\mathrm{K}$,\n- gravitational acceleration $g=9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$,\n- kinematic viscosity $\\nu=1.50\\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$,\n- thermal diffusivity $\\alpha=2.10\\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$,\n- thermal expansion coefficient $\\beta=1/T_{0}$,\n\nevaluate the appropriate velocity scaling regime and compute the numerical estimate of the time to reach quasi-steady conditions. Round your final answer to three significant figures. Express the final time in seconds.",
            "solution": "We begin with the governing equations for mass, momentum, and energy in two dimensions, assuming gravity acts in the $-y$ direction and the temperature gradient is imposed in the $x$ direction.\nContinuity:\n$$ \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0 $$\nMomentum ($x$):\n$$ \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = -\\frac{1}{\\rho_0} \\frac{\\partial P'}{\\partial x} + \\nu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right) $$\nMomentum ($y$):\n$$ \\frac{\\partial v}{\\partial t} + u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} = -\\frac{1}{\\rho_0} \\frac{\\partial P'}{\\partial y} + g\\beta(T - T_c) + \\nu \\left( \\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2} \\right) $$\nEnergy:\n$$ \\frac{\\partial T}{\\partial t} + u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right) $$\nHere, $u$ and $v$ are velocity components, $P'$ is dynamic pressure, $T$ is temperature, $\\rho_0$ is reference density, $\\nu$ is kinematic viscosity, $\\alpha$ is thermal diffusivity, $g$ is gravitational acceleration, and $\\beta$ is the thermal expansion coefficient. We have chosen the reference temperature for buoyancy to be $T_c$ for convenience, but any reference temperature would lead to a temperature difference scale of $\\Delta T = T_h - T_c$.\n\nWe perform a scaling analysis by introducing characteristic scales: length $L$, velocity $U$, time $t_{char}$, and temperature difference $\\Delta T$.\nThe derivatives scale as $\\frac{\\partial}{\\partial t} \\sim \\frac{1}{t_{char}}$, spatial gradients $\\nabla \\sim \\frac{1}{L}$, and Laplacian $\\nabla^2 \\sim \\frac{1}{L^2}$.\n\n(a) Characteristic Thermal Diffusion Time ($t_{diff}$)\nThis time scale governs heat transfer in the absence of fluid motion (convection). It is found by balancing the unsteady term and the diffusion term in the energy equation:\n$$ \\frac{\\partial T}{\\partial t} \\sim \\alpha \\nabla^2 T $$\nSubstituting the scales:\n$$ \\frac{\\Delta T}{t_{diff}} \\sim \\alpha \\frac{\\Delta T}{L^2} $$\nThis yields the expression for the thermal diffusion time:\n$$ t_{diff} \\sim \\frac{L^2}{\\alpha} $$\n\n(b) Characteristic Convective Circulation Time ($t_{conv}$)\nThis is the time required for a fluid parcel to travel a characteristic distance $L$ at the characteristic velocity $U$.\n$$ t_{conv} \\sim \\frac{L}{U} $$\nThe velocity scale $U$ is unknown and must be determined from a force balance in the momentum equation. In the quasi-steady state, the driving buoyancy force is balanced by either viscous or inertial forces. We scale the vertical momentum equation, which contains the buoyancy term $g\\beta(T - T_c) \\sim g\\beta\\Delta T$. The opposing forces are inertia, $\\mathbf{u} \\cdot \\nabla \\mathbf{u} \\sim U^2/L$, and viscous drag, $\\nu \\nabla^2 \\mathbf{u} \\sim \\nu U/L^2$.\n\nViscous-dominated balance: This occurs when viscous forces are much larger than inertial forces.\n$$ g\\beta\\Delta T \\sim \\nu \\frac{U_{visc}}{L^2} $$\nThe resulting velocity scale is:\n$$ U_{visc} \\sim \\frac{g\\beta\\Delta T L^2}{\\nu} $$\nThe corresponding convective time is:\n$$ t_{conv, visc} \\sim \\frac{L}{U_{visc}} = \\frac{\\nu}{g\\beta\\Delta T L} $$\n\nInertia-dominated balance: This occurs when inertial forces are much larger than viscous forces.\n$$ g\\beta\\Delta T \\sim \\frac{U_{inert}^2}{L} $$\nThe resulting velocity scale is:\n$$ U_{inert} \\sim \\sqrt{g\\beta\\Delta T L} $$\nThe corresponding convective time is:\n$$ t_{conv, inert} \\sim \\frac{L}{U_{inert}} = \\sqrt{\\frac{L}{g\\beta\\Delta T}} $$\n\nThe prevailing regime is determined by the ratio of the inertial term to the viscous term. Using the viscous velocity scale $U_{visc}$, we can form a Reynolds number that indicates the importance of inertia: $Re = \\frac{U_{visc}L}{\\nu} = \\frac{(g\\beta\\Delta T L^2/\\nu)L}{\\nu} = \\frac{g\\beta\\Delta T L^3}{\\nu^2}$. This dimensionless group is the ratio of the Rayleigh number ($Ra = \\frac{g\\beta\\Delta T L^3}{\\nu\\alpha}$) to the Prandtl number ($Pr = \\frac{\\nu}{\\alpha}$). So, the criterion is $Ra/Pr$. If $Ra/Pr \\ll 1$, the flow is viscous-dominated. If $Ra/Pr \\gg 1$, the flow is inertia-dominated.\n\nComposite Estimate for Time to Quasi-Steady State ($t_{qs}$)\nThe problem explicitly instructs to estimate the time to reach a quasi-steady field as the *slower* of the two mechanisms: thermal diffusion and convective circulation. The slower mechanism is the one with the longer characteristic time. Therefore, the composite time is:\n$$ t_{qs} = \\max(t_{diff}, t_{conv}) $$\n\nNumerical Evaluation\nWe now substitute the provided numerical values:\n- $L = 1.00 \\times 10^{-2}\\,\\mathrm{m}$\n- $\\Delta T = 10.0\\,\\mathrm{K}$\n- $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- $\\nu = 1.50 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n- $\\alpha = 2.10 \\times 10^{-5}\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n- $T_{0} = 300\\,\\mathrm{K}$, so $\\beta = 1/T_0 = 1/300\\,\\mathrm{K}^{-1}$\n\nFirst, we determine the flow regime by calculating the dimensionless parameter $Ra/Pr$.\n$$ Pr = \\frac{\\nu}{\\alpha} = \\frac{1.50 \\times 10^{-5}}{2.10 \\times 10^{-5}} \\approx 0.7143 $$\n$$ Ra = \\frac{g\\beta\\Delta T L^3}{\\nu\\alpha} = \\frac{(9.81)\\left(\\frac{1}{300}\\right)(10.0)(1.00 \\times 10^{-2})^3}{(1.50 \\times 10^{-5})(2.10 \\times 10^{-5})} $$\n$$ Ra = \\frac{(9.81)(10.0)(10^{-6})}{300(3.15 \\times 10^{-10})} = \\frac{9.81 \\times 10^{-5}}{9.45 \\times 10^{-8}} \\approx 1038 $$\nThe regime criterion is:\n$$ \\frac{Ra}{Pr} = \\frac{1038}{0.7143} \\approx 1453 $$\nSince $Ra/Pr = 1453 \\gg 1$, the momentum balance is inertia-dominated. We must use the expressions for this regime.\n\nNext, we compute the characteristic times.\nThe thermal diffusion time is:\n$$ t_{diff} = \\frac{L^2}{\\alpha} = \\frac{(1.00 \\times 10^{-2})^2}{2.10 \\times 10^{-5}} = \\frac{1.00 \\times 10^{-4}}{2.10 \\times 10^{-5}}\\,\\mathrm{s} \\approx 4.7619\\,\\mathrm{s} $$\nThe convective circulation time is $t_{conv, inert}$:\n$$ t_{conv} = \\sqrt{\\frac{L}{g\\beta\\Delta T}} = \\sqrt{\\frac{1.00 \\times 10^{-2}}{(9.81)\\left(\\frac{1}{300}\\right)(10.0)}} = \\sqrt{\\frac{1.00 \\times 10^{-2}}{0.327}}\\,\\mathrm{s} \\approx \\sqrt{0.03058}\\,\\mathrm{s} \\approx 0.1749\\,\\mathrm{s} $$\nFinally, we determine the time to reach quasi-steady state using the specified composite model:\n$$ t_{qs} = \\max(t_{diff}, t_{conv}) = \\max(4.7619\\,\\mathrm{s}, 0.1749\\,\\mathrm{s}) = 4.7619\\,\\mathrm{s} $$\nRounding the final answer to three significant figures, we get $4.76\\,\\mathrm{s}$.\nThe physical interpretation is that, for these parameters, convection establishes a flow pattern very quickly relative to the time it takes for heat to diffuse across the bulk of the cavity. Thus, according to the problem's specified criterion, the overall transient is limited by the much slower thermal diffusion process.",
            "answer": "$$\n\\boxed{4.76}\n$$"
        },
        {
            "introduction": "In computational science, verifying that a code correctly solves the intended mathematical model is a critical, non-negotiable step. The Method of Manufactured Solutions (MMS) is a rigorous and universal technique for code verification, where an exact analytical solution is constructed for a modified set of governing equations. This practice will guide you through the creation of a manufactured solution for the vorticity-streamfunction formulation of natural convection, providing the necessary source terms and boundary conditions to create a benchmark against which a numerical solver's accuracy can be systematically tested .",
            "id": "2509883",
            "problem": "A two-dimensional, steady, laminar natural convection flow of a Boussinesq fluid in a square cavity occupying $0 \\le x \\le 1$, $0 \\le y \\le 1$ is modeled in vorticity–streamfunction form. Using characteristic length $L$, temperature difference $\\Delta T$, and velocity scale $\\alpha/L$ (where $\\alpha$ is the thermal diffusivity), the dimensionless governing equations are\n$$\n\\nabla^2 \\psi \\;=\\; -\\omega,\n$$\n$$\nu \\,\\frac{\\partial \\omega}{\\partial x} \\;+\\; v \\,\\frac{\\partial \\omega}{\\partial y} \\;=\\; \\mathrm{Pr}\\,\\nabla^2 \\omega \\;+\\; \\mathrm{Ra}\\,\\mathrm{Pr}\\,\\frac{\\partial \\theta}{\\partial x},\n$$\n$$\nu \\,\\frac{\\partial \\theta}{\\partial x} \\;+\\; v \\,\\frac{\\partial \\theta}{\\partial y} \\;=\\; \\nabla^2 \\theta,\n$$\nwith the kinematic relations $u = \\frac{\\partial \\psi}{\\partial y}$, $v = -\\frac{\\partial \\psi}{\\partial x}$. Here $\\psi$ is the streamfunction, $\\omega$ is the vorticity, $\\theta$ is the dimensionless temperature, $\\mathrm{Pr}$ is the Prandtl number, and $\\mathrm{Ra}$ is the Rayleigh number. Gravity acts in the -y direction. \n\nUse the method of manufactured solutions to create an exact, smooth solution of a modified problem with added source terms $S_{\\omega}(x,y)$ and $S_{\\theta}(x,y)$:\n$$\nu \\,\\frac{\\partial \\omega}{\\partial x} \\;+\\; v \\,\\frac{\\partial \\omega}{\\partial y} \\;=\\; \\mathrm{Pr}\\,\\nabla^2 \\omega \\;+\\; \\mathrm{Ra}\\,\\mathrm{Pr}\\,\\frac{\\partial \\theta}{\\partial x} \\;+\\; S_{\\omega}(x,y),\n$$\n$$\nu \\,\\frac{\\partial \\theta}{\\partial x} \\;+\\; v \\,\\frac{\\partial \\theta}{\\partial y} \\;=\\; \\nabla^2 \\theta \\;+\\; S_{\\theta}(x,y),\n$$\nwith boundary conditions taken directly from the manufactured fields. Specifically, adopt the manufactured fields\n$$\n\\psi(x,y) \\;=\\; \\sin(\\pi x)\\,\\sin(\\pi y), \n\\qquad \n\\theta(x,y) \\;=\\; -\\,\\sin(\\pi x)\\,\\sin(\\pi y),\n$$\nfrom which $u(x,y)$, $v(x,y)$, and $\\omega(x,y)$ must be constructed via definitions. \n\nTasks:\n- Starting from the above fundamental governing equations and definitions, derive explicit expressions for $S_{\\omega}(x,y)$ and $S_{\\theta}(x,y)$ that make the chosen fields an exact steady solution of the forced vorticity and energy equations for arbitrary positive $\\mathrm{Pr}$ and $\\mathrm{Ra}$.\n- State the boundary data that must be imposed for $\\psi$, $\\omega$, and $\\theta$ on $\\partial \\Omega$ so that the manufactured fields are enforced at the boundary in a numerical code, and explain the rationale using the fundamental definitions.\n- Briefly describe a systematic verification procedure to assess code accuracy using the manufactured solution, including how to define an error norm and how to infer the observed order of accuracy.\n\nFinally, compute the wall-averaged Nusselt number at the left boundary $x=0$ for the manufactured temperature field, defined by\n$$\n\\overline{\\mathrm{Nu}}_{x=0} \\;=\\; \\int_{0}^{1} \\left(-\\,\\frac{\\partial \\theta}{\\partial x}(0,y)\\right)\\,dy.\n$$\nExpress your final answer as a pure number with no units, in exact form (no rounding).",
            "solution": "The solution is constructed by following the sequence of tasks presented in the problem.\n\n**1. Derivation of Fields from Manufactured Solution**\n\nFirst, we derive the velocity components and the vorticity field from the manufactured streamfunction $\\psi(x,y) = \\sin(\\pi x)\\sin(\\pi y)$.\n\nThe velocity components $u$ and $v$ are defined by the kinematic relations:\n$$\nu(x,y) = \\frac{\\partial \\psi}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sin(\\pi x)\\sin(\\pi y) \\right) = \\pi \\sin(\\pi x)\\cos(\\pi y)\n$$\n$$\nv(x,y) = -\\frac{\\partial \\psi}{\\partial x} = -\\frac{\\partial}{\\partial x} \\left( \\sin(\\pi x)\\sin(\\pi y) \\right) = -\\pi \\cos(\\pi x)\\sin(\\pi y)\n$$\nThe vorticity $\\omega$ is defined by the Poisson equation for the streamfunction, $\\omega = -\\nabla^2 \\psi$:\n$$\n\\omega(x,y) = -\\left( \\frac{\\partial^2 \\psi}{\\partial x^2} + \\frac{\\partial^2 \\psi}{\\partial y^2} \\right) = -\\left( -\\pi^2 \\sin(\\pi x)\\sin(\\pi y) - \\pi^2 \\sin(\\pi x)\\sin(\\pi y) \\right) = 2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\n$$\n\n**2. Derivation of Source Terms $S_{\\theta}(x,y)$ and $S_{\\omega}(x,y)$**\n\nThe source terms are found by substituting the manufactured fields into the modified governing equations and solving for $S_{\\theta}$ and $S_{\\omega}$.\n\nThe source term for the energy equation is $S_{\\theta}(x,y) = u \\frac{\\partial \\theta}{\\partial x} + v \\frac{\\partial \\theta}{\\partial y} - \\nabla^2 \\theta$.\nWe compute each term:\n- Derivatives of temperature $\\theta(x,y) = -\\sin(\\pi x)\\sin(\\pi y)$:\n$$\n\\frac{\\partial \\theta}{\\partial x} = -\\pi \\cos(\\pi x)\\sin(\\pi y)\n$$\n$$\n\\frac{\\partial \\theta}{\\partial y} = -\\pi \\sin(\\pi x)\\cos(\\pi y)\n$$\n$$\n\\nabla^2 \\theta = \\frac{\\partial^2 \\theta}{\\partial x^2} + \\frac{\\partial^2 \\theta}{\\partial y^2} = \\pi^2 \\sin(\\pi x)\\sin(\\pi y) + \\pi^2 \\sin(\\pi x)\\sin(\\pi y) = 2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\n$$\n- Advection term for temperature, $u \\frac{\\partial \\theta}{\\partial x} + v \\frac{\\partial \\theta}{\\partial y}$:\n$$\n(\\pi \\sin(\\pi x)\\cos(\\pi y))(-\\pi \\cos(\\pi x)\\sin(\\pi y)) + (-\\pi \\cos(\\pi x)\\sin(\\pi y))(-\\pi \\sin(\\pi x)\\cos(\\pi y))\n$$\n$$\n= -\\pi^2 \\sin(\\pi x)\\cos(\\pi x)\\sin(\\pi y)\\cos(\\pi y) + \\pi^2 \\cos(\\pi x)\\sin(\\pi x)\\sin(\\pi y)\\cos(\\pi y) = 0\n$$\nThe advection term is identically zero for this specific choice of fields.\n- Assembling the source term $S_{\\theta}$:\n$$\nS_{\\theta}(x,y) = 0 - \\nabla^2 \\theta = -2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)\n$$\nThe source term for the vorticity equation is $S_{\\omega}(x,y) = u \\frac{\\partial \\omega}{\\partial x} + v \\frac{\\partial \\omega}{\\partial y} - \\mathrm{Pr}\\,\\nabla^2 \\omega - \\mathrm{Ra}\\,\\mathrm{Pr}\\,\\frac{\\partial \\theta}{\\partial x}$.\nWe compute each term:\n- Derivatives of vorticity $\\omega(x,y) = 2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)$:\n$$\n\\frac{\\partial \\omega}{\\partial x} = 2\\pi^3 \\cos(\\pi x)\\sin(\\pi y)\n$$\n$$\n\\frac{\\partial \\omega}{\\partial y} = 2\\pi^3 \\sin(\\pi x)\\cos(\\pi y)\n$$\n$$\n\\nabla^2 \\omega = \\frac{\\partial^2 \\omega}{\\partial x^2} + \\frac{\\partial^2 \\omega}{\\partial y^2} = -2\\pi^4 \\sin(\\pi x)\\sin(\\pi y) - 2\\pi^4 \\sin(\\pi x)\\sin(\\pi y) = -4\\pi^4 \\sin(\\pi x)\\sin(\\pi y)\n$$\n- Advection term for vorticity, $u \\frac{\\partial \\omega}{\\partial x} + v \\frac{\\partial \\omega}{\\partial y}$:\nThis term is also identically zero, as $\\omega$ is directly proportional to $\\psi$.\n- Assembling the source term $S_{\\omega}$:\n$$\nS_{\\omega}(x,y) = 0 - \\mathrm{Pr}(-4\\pi^4 \\sin(\\pi x)\\sin(\\pi y)) - \\mathrm{Ra}\\,\\mathrm{Pr}(-\\pi \\cos(\\pi x)\\sin(\\pi y))\n$$\n$$\nS_{\\omega}(x,y) = 4\\pi^4 \\mathrm{Pr} \\sin(\\pi x)\\sin(\\pi y) + \\pi \\mathrm{Ra}\\,\\mathrm{Pr} \\cos(\\pi x)\\sin(\\pi y)\n$$\nThis can be factored as:\n$$\nS_{\\omega}(x,y) = \\pi \\mathrm{Pr} \\sin(\\pi y) \\left( 4\\pi^3 \\sin(\\pi x) + \\mathrm{Ra} \\cos(\\pi x) \\right)\n$$\n\n**3. Boundary Conditions for Verification**\n\nIn MMS, the boundary conditions for the solved variables are taken directly from the manufactured fields evaluated at the boundaries of the domain $\\partial \\Omega$. The domain is the unit square defined by $x=0$, $x=1$, $y=0$, and $y=1$.\n\n- **Streamfunction Boundary Condition**:\n$\\psi(x,y) = \\sin(\\pi x)\\sin(\\pi y)$. Since $\\sin(0) = 0$ and $\\sin(\\pi) = 0$, the streamfunction is zero on all four boundaries:\n$$\n\\psi(0,y) = 0, \\quad \\psi(1,y) = 0, \\quad \\psi(x,0) = 0, \\quad \\psi(x,1) = 0\n$$\n- **Temperature Boundary Condition**:\n$\\theta(x,y) = -\\sin(\\pi x)\\sin(\\pi y)$. Similarly, the temperature is zero on all four boundaries:\n$$\n\\theta(0,y) = 0, \\quad \\theta(1,y) = 0, \\quad \\theta(x,0) = 0, \\quad \\theta(x,1) = 0\n$$\n- **Vorticity Boundary Condition**:\n$\\omega(x,y) = 2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)$. The vorticity is also zero on all four boundaries:\n$$\n\\omega(0,y) = 0, \\quad \\omega(1,y) = 0, \\quad \\omega(x,0) = 0, \\quad \\omega(x,1) = 0\n$$\nRationale: A numerical code implementing the solution must solve for the fields $\\psi$, $\\omega$, and $\\theta$. To verify the code's implementation of the interior governing equations, one must eliminate any error from the boundary condition implementation. This is achieved by imposing the known, exact values of the manufactured solution as Dirichlet boundary conditions for all solved fields. This forces the numerical solution to match the exact solution at the boundary, isolating the discretization error in the domain's interior.\n\n**4. Procedure for Code Verification**\n\nA systematic procedure to assess code accuracy using this manufactured solution is as follows:\n1.  **Code Modification**: The numerical solver is modified to include the derived source terms $S_{\\omega}(x,y)$ and $S_{\\theta}(x,y)$ in the discretized vorticity and energy equations, respectively.\n2.  **Boundary & Initial Conditions**: The Dirichlet boundary conditions $\\psi=0$, $\\omega=0$, $\\theta=0$ are implemented on all boundaries. The manufactured solution fields can be used as an initial guess to accelerate convergence for a steady-state solver.\n3.  **Simulation on Refined Grids**: The simulation is executed on a sequence of progressively refined computational grids. For instance, grids of size $N \\times N$ with $N = 16, 32, 64, 128, \\dots$. The characteristic grid spacing is $h = 1/N$.\n4.  **Error Calculation**: On each grid, the error between the computed numerical solution $\\phi_h$ (where $\\phi$ can be $\\psi$, $\\omega$, or $\\theta$) and the exact manufactured solution $\\phi_{ex}$ is quantified using a grid norm. A common choice is the discrete $L_2$ norm:\n    $$\n    E_{L_2}(\\phi) = \\sqrt{\\frac{1}{N^2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\left( \\phi_{h}(x_i, y_j) - \\phi_{ex}(x_i, y_j) \\right)^2}\n    $$\n5.  **Inferring Order of Accuracy**: The theoretical order of accuracy $p$ of the discretization scheme implies that the error $E$ behaves as $E \\approx C h^p$ for some constant $C$ as $h \\to 0$. The observed order of accuracy can be computed from the errors $E_1$ and $E_2$ on two grids with spacings $h_1$ and $h_2 = h_1/r$ (where $r$ is the refinement factor, typically $r=2$):\n    $$\n    p_{obs} = \\frac{\\ln(E_1 / E_2)}{\\ln(h_1 / h_2)} = \\frac{\\ln(E_1 / E_2)}{\\ln(r)}\n    $$\n    For $r=2$, this becomes $p_{obs} = \\log_2(E_1/E_2)$.\n6.  **Verification**: The code is considered verified if the observed order of accuracy $p_{obs}$ converges to the theoretical order of accuracy $p$ of the numerical scheme as the grid is refined.\n\n**5. Calculation of Average Nusselt Number**\n\nFinally, the wall-averaged Nusselt number at the left boundary $x=0$ is computed. The definition is:\n$$\n\\overline{\\mathrm{Nu}}_{x=0} \\;=\\; \\int_{0}^{1} \\left(-\\,\\frac{\\partial \\theta}{\\partial x}(0,y)\\right)\\,dy\n$$\nWe have the temperature derivative $\\frac{\\partial \\theta}{\\partial x} = -\\pi \\cos(\\pi x)\\sin(\\pi y)$.\nEvaluate this derivative at $x=0$:\n$$\n\\frac{\\partial \\theta}{\\partial x}(0,y) = -\\pi \\cos(0)\\sin(\\pi y) = -\\pi \\sin(\\pi y)\n$$\nSubstitute this into the integral expression for the Nusselt number:\n$$\n\\overline{\\mathrm{Nu}}_{x=0} = \\int_{0}^{1} -(-\\pi \\sin(\\pi y))\\,dy = \\int_{0}^{1} \\pi \\sin(\\pi y)\\,dy\n$$\nPerforming the definite integration:\n$$\n\\overline{\\mathrm{Nu}}_{x=0} = \\pi \\left[ -\\frac{1}{\\pi} \\cos(\\pi y) \\right]_{0}^{1} = -\\left[ \\cos(\\pi y) \\right]_{0}^{1} = -(\\cos(\\pi) - \\cos(0))\n$$\n$$\n\\overline{\\mathrm{Nu}}_{x=0} = -(-1 - 1) = -(-2) = 2\n$$\nThe wall-averaged Nusselt number at $x=0$ is exactly $2$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "While the Boussinesq approximation offers a convenient simplification, its validity is limited to scenarios with small temperature differences. To model many real-world engineering problems, such as natural convection in gases, we must account for the significant variation of fluid properties with temperature. This final practice bridges the gap between idealized models and physical reality, demonstrating how to construct an effective Rayleigh number for a non-Boussinesq ideal gas and how to define a quantitative metric to assess the validity of the Boussinesq approximation itself .",
            "id": "3975207",
            "problem": "Consider a two-dimensional, differentially heated, sealed rectangular enclosure of height $H$ and width $W$ filled with a single-component ideal gas. The left wall is isothermal at temperature $T_h$ and the right wall is isothermal at temperature $T_c$, with $T_h &gt; T_c$. Assume gravity of magnitude $g$ acts downward. In the absence of motion, the conduction baseline temperature field varies linearly across the width: $T(x) = T_c + (T_h - T_c) x / W$ for $x \\in [0,W]$, and is uniform in the vertical direction. You are tasked with quantifying variable-property and non-Boussinesq effects on the buoyancy driving of natural convection by constructing an effective dimensionless control parameter and a non-Boussinesq validity metric, starting from first principles.\n\nFundamental base and constitutive assumptions:\n- Mass conservation: $\\dfrac{D \\rho}{D t} + \\rho \\nabla \\cdot \\mathbf{u} = 0$.\n- Momentum: $\\rho \\dfrac{D \\mathbf{u}}{D t} = -\\nabla p + \\rho \\mathbf{g} + \\nabla \\cdot \\left[ \\mu \\left( \\nabla \\mathbf{u} + \\nabla \\mathbf{u}^\\top \\right) \\right]$.\n- Energy (neglecting viscous dissipation and volumetric heating): $\\rho c_p \\dfrac{D T}{D t} = \\nabla \\cdot (k \\nabla T)$.\n- Equation of state (ideal gas): $\\rho = \\dfrac{p}{R T}$.\n- Pressure is decomposed into a spatially uniform reference $p_0$ and a small perturbation $p^\\prime$ consistent with a low-Mach-number assumption; material properties depend on temperature only.\n- Dynamic viscosity and thermal conductivity follow temperature power laws: $\\mu(T) = \\mu_0 \\left( \\dfrac{T}{T_0} \\right)^{s_\\mu}$ and $k(T) = k_0 \\left( \\dfrac{T}{T_0} \\right)^{s_k}$, where $T_0$ is a reference temperature and $s_\\mu$, $s_k$ are given exponents. The specific heat at constant pressure $c_p$ is constant.\n\nDefinitions to be used:\n- Kinematic viscosity: $\\nu(T) = \\dfrac{\\mu(T)}{\\rho(T)}$.\n- Thermal diffusivity: $\\alpha(T) = \\dfrac{k(T)}{\\rho(T) c_p}$.\n- Isobaric thermal expansion coefficient for an ideal gas: $\\beta(T) = \\dfrac{1}{T}$.\n- Conduction-field spatial average across the width for any scalar function $g(T(x))$: $\\langle g \\rangle = \\dfrac{1}{W} \\int_0^W g(T(x)) \\, dx$. Because $T(x)$ is linear in $x$, this average can be equivalently expressed as $\\langle g \\rangle = \\dfrac{1}{\\Delta T} \\int_{T_c}^{T_h} g(T) \\, dT$, where $\\Delta T = T_h - T_c$.\n\nTasks:\n1) Starting from the governing equations and the above definitions, and using the conduction baseline temperature field for averaging, construct an effective dimensionless control parameter that reduces to the classical Rayleigh number under constant-property conditions but accounts for temperature-dependent properties by replacing constant properties with conduction-field averages. Express it in terms of $g$, $H$, $\\Delta T$, and the conduction-field averages $\\langle \\beta \\rangle$, $\\langle \\nu \\rangle$, and $\\langle \\alpha \\rangle$. The final quantity must be dimensionless. No physical units should appear in your final numerical results.\n\n2) Quantify non-Boussinesq effects using the maximum relative density variation across the width with respect to a reference temperature $T_{\\text{ref}} = \\dfrac{T_h + T_c}{2}$:\n$$\n\\mathcal{N}_B = \\max_{x \\in [0,W]} \\left| \\dfrac{\\rho(T(x)) - \\rho(T_{\\text{ref}})}{\\rho(T_{\\text{ref}})} \\right|.\n$$\nReport $\\mathcal{N}_B$ and a boolean flag indicating whether the Oberbeck–Boussinesq approximation is acceptable, using the criterion $\\mathcal{N}_B \\le 0.1$.\n\n3) Implement a program that, for each test case below, computes:\n- The effective dimensionless control parameter from Task $1$ (call it the effective Rayleigh number).\n- The non-Boussinesq metric $\\mathcal{N}_B$ from Task $2$.\n- The boolean validity flag defined in Task $2$.\n\nTest suite specification:\nUse the following parameter sets. All inputs are to be interpreted in the units indicated here: $g$ in $\\mathrm{m/s^2}$, $H$ and $W$ in $\\mathrm{m}$, $T_h$, $T_c$, and $T_0$ in $\\mathrm{K}$, $p_0$ in $\\mathrm{Pa}$, $\\mu_0$ in $\\mathrm{Pa \\cdot s}$, $k_0$ in $\\mathrm{W/(m \\cdot K)}$, $c_p$ and $R$ in $\\mathrm{J/(kg \\cdot K)}$. The outputs must be dimensionless.\n- Case A (small temperature difference, variable properties): $g=9.81$, $H=0.5$, $W$ arbitrary, $T_h=301$, $T_c=300$, $T_0=300$, $p_0=101325$, $\\mu_0=1.846\\times 10^{-5}$, $k_0=0.02624$, $c_p=1005$, $R=287.058$, $s_\\mu=1.5$, $s_k=1.5$.\n- Case B (moderate temperature difference, variable properties): same as Case A but $T_h=340$, $T_c=300$.\n- Case C (large temperature difference, variable properties): same as Case A but $T_h=450$, $T_c=300$.\n- Case D (moderate temperature difference, constant transport properties): same as Case B but $s_\\mu=0$, $s_k=0$.\n- Case E (moderate temperature difference, reduced ambient pressure): same as Case B but $p_0=50662.5$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must itself be a list of the form $[ \\text{Ra\\_eff}, \\mathcal{N}_B, \\text{BoussinesqValid} ]$, where $\\text{Ra\\_eff}$ and $\\mathcal{N}_B$ are floating-point numbers and $\\text{BoussinesqValid}$ is a boolean. For example: \"[[1.23,0.01,True],[...],...]\". All outputs are dimensionless; do not include any physical units in the printed results.",
            "solution": "### Task 1: Derivation of the Effective Rayleigh Number ($\\text{Ra}_{\\text{eff}}$)\n\nThe objective is to construct an effective Rayleigh number that extends the classical definition to account for temperature-dependent fluid properties. The classical Rayleigh number for a Boussinesq fluid is given by:\n$$\n\\text{Ra} = \\frac{g \\beta \\Delta T H^3}{\\nu \\alpha}\n$$\nwhere $g$ is the acceleration due to gravity, $\\beta$ is the thermal expansion coefficient, $\\Delta T = T_h - T_c$ is the temperature difference across the enclosure, $H$ is the enclosure height, $\\nu$ is the kinematic viscosity, and $\\alpha$ is the thermal diffusivity.\n\nFor a non-Boussinesq fluid where properties vary significantly with temperature, we replace the constant properties $\\beta$, $\\nu$, and $\\alpha$ with effective values obtained by averaging them over the conduction temperature profile $T(x)$. The problem defines this average for a function $f(T)$ as:\n$$\n\\langle f \\rangle = \\frac{1}{\\Delta T} \\int_{T_c}^{T_h} f(T) \\, dT\n$$\nThe effective Rayleigh number, $\\text{Ra}_{\\text{eff}}$, is thus defined as:\n$$\n\\text{Ra}_{\\text{eff}} = \\frac{g \\langle \\beta \\rangle \\Delta T H^3}{\\langle \\nu \\rangle \\langle \\alpha \\rangle}\n$$\nWe now derive the expressions for the averaged properties.\n\n**1. Average Thermal Expansion Coefficient, $\\langle \\beta \\rangle$**\nFor an ideal gas, the isobaric coefficient of thermal expansion is $\\beta(T) = 1/T$. Its average is:\n$$\n\\langle \\beta \\rangle = \\frac{1}{\\Delta T} \\int_{T_c}^{T_h} \\frac{1}{T} \\, dT = \\frac{1}{\\Delta T} [\\ln(T)]_{T_c}^{T_h} = \\frac{\\ln(T_h) - \\ln(T_c)}{\\Delta T} = \\frac{\\ln(T_h/T_c)}{T_h - T_c}\n$$\nThe term $g \\langle \\beta \\rangle \\Delta T$ in the numerator of $\\text{Ra}_{\\text{eff}}$ simplifies to $g \\ln(T_h/T_c)$.\n\n**2. Average Kinematic Viscosity, $\\langle \\nu \\rangle$**\nKinematic viscosity is $\\nu(T) = \\mu(T)/\\rho(T)$. The dynamic viscosity $\\mu(T)$ and density $\\rho(T)$ are given by:\n$$\n\\mu(T) = \\mu_0 \\left( \\frac{T}{T_0} \\right)^{s_\\mu} \\quad \\text{and} \\quad \\rho(T) = \\frac{p_0}{R T}\n$$\nwhere the low-Mach-number assumption allows using the reference pressure $p_0$ in the ideal gas law. Combining these gives:\n$$\n\\nu(T) = \\frac{\\mu_0 (T/T_0)^{s_\\mu}}{p_0/(R T)} = \\frac{\\mu_0 R}{p_0 T_0^{s_\\mu}} T^{s_\\mu+1}\n$$\nAveraging this expression over the temperature range:\n$$\n\\langle \\nu \\rangle = \\frac{1}{\\Delta T} \\int_{T_c}^{T_h} \\left( \\frac{\\mu_0 R}{p_0 T_0^{s_\\mu}} T^{s_\\mu+1} \\right) dT = \\frac{\\mu_0 R}{p_0 T_0^{s_\\mu} \\Delta T} \\left[ \\frac{T^{s_\\mu+2}}{s_\\mu+2} \\right]_{T_c}^{T_h}\n$$\n$$\n\\langle \\nu \\rangle = \\frac{\\mu_0 R}{p_0 T_0^{s_\\mu} (s_\\mu+2)} \\frac{T_h^{s_\\mu+2} - T_c^{s_\\mu+2}}{T_h - T_c}\n$$\nThis formula is valid for $s_\\mu \\neq -2$.\n\n**3. Average Thermal Diffusivity, $\\langle \\alpha \\rangle$**\nThermal diffusivity is $\\alpha(T) = k(T) / (\\rho(T) c_p)$. The thermal conductivity $k(T)$ is given as:\n$$\nk(T) = k_0 \\left( \\frac{T}{T_0} \\right)^{s_k}\n$$\nWith constant $c_p$ and $\\rho(T) = p_0/(RT)$, the thermal diffusivity is:\n$$\n\\alpha(T) = \\frac{k_0 (T/T_0)^{s_k}}{(p_0/(R T)) c_p} = \\frac{k_0 R}{p_0 c_p T_0^{s_k}} T^{s_k+1}\n$$\nThe functional form is identical to that of $\\nu(T)$. The average is therefore:\n$$\n\\langle \\alpha \\rangle = \\frac{1}{\\Delta T} \\int_{T_c}^{T_h} \\left( \\frac{k_0 R}{p_0 c_p T_0^{s_k}} T^{s_k+1} \\right) dT = \\frac{k_0 R}{p_0 c_p T_0^{s_k} \\Delta T} \\left[ \\frac{T^{s_k+2}}{s_k+2} \\right]_{T_c}^{T_h}\n$$\n$$\n\\langle \\alpha \\rangle = \\frac{k_0 R}{p_0 c_p T_0^{s_k} (s_k+2)} \\frac{T_h^{s_k+2} - T_c^{s_k+2}}{T_h - T_c}\n$$\nThis formula is valid for $s_k \\neq -2$.\n\nBy substituting these averaged quantities into the definition of $\\text{Ra}_{\\text{eff}}$, we can compute its value for the given test cases.\n\n### Task 2: Derivation of the Non-Boussinesq Metric ($\\mathcal{N}_B$)\n\nThe non-Boussinesq metric $\\mathcal{N}_B$ is defined as the maximum relative density variation across the domain with respect to the density at the arithmetic mean temperature, $T_{\\text{ref}} = (T_h + T_c)/2$.\n$$\n\\mathcal{N}_B = \\max_{x \\in [0,W]} \\left| \\frac{\\rho(T(x)) - \\rho(T_{\\text{ref}})}{\\rho(T_{\\text{ref}})} \\right|\n$$\nSince temperature $T(x)$ varies monotonically from $T_c$ to $T_h$, this is equivalent to maximizing over the temperature interval $T \\in [T_c, T_h]$. Substituting the ideal gas law $\\rho(T) = p_0/(RT)$:\n$$\n\\mathcal{N}_B = \\max_{T \\in [T_c, T_h]} \\left| \\frac{p_0/(RT) - p_0/(RT_{\\text{ref}})}{p_0/(RT_{\\text{ref}})} \\right| = \\max_{T \\in [T_c, T_h]} \\left| \\frac{1/T - 1/T_{\\text{ref}}}{1/T_{\\text{ref}}} \\right| = \\max_{T \\in [T_c, T_h]} \\left| \\frac{T_{\\text{ref}}}{T} - 1 \\right|\n$$\nThe function $f(T) = T_{\\text{ref}}/T - 1$ is a strictly monotonic decreasing function for $T > 0$. Therefore, the maximum of its absolute value on the interval $[T_c, T_h]$ must occur at one of the endpoints. We evaluate $|f(T)|$ at $T=T_c$ and $T=T_h$:\n$$\n|f(T_c)| = \\left| \\frac{T_{\\text{ref}}}{T_c} - 1 \\right| = \\left| \\frac{(T_h+T_c)/2}{T_c} - 1 \\right| = \\left| \\frac{T_h+T_c-2T_c}{2T_c} \\right| = \\frac{T_h - T_c}{2T_c}\n$$\n$$\n|f(T_h)| = \\left| \\frac{T_{\\text{ref}}}{T_h} - 1 \\right| = \\left| \\frac{(T_h+T_c)/2}{T_h} - 1 \\right| = \\left| \\frac{T_h+T_c-2T_h}{2T_h} \\right| = \\frac{T_h - T_c}{2T_h}\n$$\nSince $T_h > T_c > 0$, we have $1/T_c > 1/T_h$, which implies $|f(T_c)| > |f(T_h)|$. Thus, the maximum occurs at $T=T_c$:\n$$\n\\mathcal{N}_B = \\frac{T_h - T_c}{2 T_c}\n$$\nThe Oberbeck-Boussinesq approximation is considered acceptable if $\\mathcal{N}_B \\le 0.1$. This condition provides a quantitative criterion for the boolean flag.\nThese derived formulas will be implemented in the final program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effective Rayleigh number and non-Boussinesq metric for a series of test cases.\n    \"\"\"\n    # Test suite specification as a list of tuples.\n    # Format: (g, H, Th, Tc, T0, p0, mu0, k0, cp, R, s_mu, s_k)\n    test_cases = [\n        # Case A\n        (9.81, 0.5, 301.0, 300.0, 300.0, 101325.0, 1.846e-5, 0.02624, 1005.0, 287.058, 1.5, 1.5),\n        # Case B\n        (9.81, 0.5, 340.0, 300.0, 300.0, 101325.0, 1.846e-5, 0.02624, 1005.0, 287.058, 1.5, 1.5),\n        # Case C\n        (9.81, 0.5, 450.0, 300.0, 300.0, 101325.0, 1.846e-5, 0.02624, 1005.0, 287.058, 1.5, 1.5),\n        # Case D\n        (9.81, 0.5, 340.0, 300.0, 300.0, 101325.0, 1.846e-5, 0.02624, 1005.0, 287.058, 0.0, 0.0),\n        # Case E\n        (9.81, 0.5, 340.0, 300.0, 300.0, 50662.5, 1.846e-5, 0.02624, 1005.0, 287.058, 1.5, 1.5)\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        g, H, T_h, T_c, T_0, p_0, mu_0, k_0, c_p, R, s_mu, s_k = case\n\n        delta_T = T_h - T_c\n\n        # Task 1: Calculate the effective Rayleigh number (Ra_eff)\n        \n        # Numerator of Ra_eff: g * <beta> * delta_T * H^3\n        # This simplifies to g * ln(T_h/T_c) * H^3\n        numerator_ra = g * np.log(T_h / T_c) * H**3\n\n        # Denominator of Ra_eff: <nu> * <alpha>\n        # Calculate conduction-field average of kinematic viscosity, <nu>\n        if s_mu == -2.0:\n            # This edge case is not in the test suite but included for robustness\n            integral_term_nu = np.log(T_h / T_c)\n        else:\n            integral_term_nu = (T_h**(s_mu + 2.0) - T_c**(s_mu + 2.0)) / (s_mu + 2.0)\n        \n        avg_nu = (mu_0 * R) / (p_0 * T_0**s_mu * delta_T) * integral_term_nu\n\n        # Calculate conduction-field average of thermal diffusivity, <alpha>\n        if s_k == -2.0:\n            # This edge case is not in the test suite but included for robustness\n            integral_term_alpha = np.log(T_h / T_c)\n        else:\n            integral_term_alpha = (T_h**(s_k + 2.0) - T_c**(s_k + 2.0)) / (s_k + 2.0)\n            \n        avg_alpha = (k_0 * R) / (p_0 * c_p * T_0**s_k * delta_T) * integral_term_alpha\n        \n        denominator_ra = avg_nu * avg_alpha\n        \n        ra_eff = numerator_ra / denominator_ra\n\n        # Task 2: Calculate the non-Boussinesq metric (N_B) and validity flag\n        n_b = (T_h - T_c) / (2.0 * T_c)\n        boussinesq_valid = n_b <= 0.1\n\n        results.append([ra_eff, n_b, boussinesq_valid])\n\n    # Format the final output string as a list of lists, without extra spaces.\n    # Example: [[Ra_eff1,N_B1,Valid1],[Ra_eff2,N_B2,Valid2],...]\n    result_strings = []\n    for res_list in results:\n        # Python's str(bool) produces 'True' or 'False', which matches the desired format.\n        result_strings.append(f\"[{res_list[0]},{res_list[1]},{res_list[2]}]\")\n    \n    final_output_string = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}