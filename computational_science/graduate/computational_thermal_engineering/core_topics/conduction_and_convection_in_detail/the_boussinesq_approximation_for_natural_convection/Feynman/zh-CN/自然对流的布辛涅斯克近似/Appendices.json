{
    "hands_on_practices": [
        {
            "introduction": "为了有效地研究和模拟自然对流，我们首先必须理解控制流动的基本参数。本练习将引导您完成对布辛涅斯克（Boussinesq）方程进行无量纲化的核心过程。通过执行这种尺度分析 ，您将看到浮力、粘性力及热扩散效应之间的竞争如何被归结为一个关键参数：瑞利数（Rayleigh number）。",
            "id": "2384541",
            "problem": "一个特征长度为 $L$ 的二维垂直腔体中充满了牛顿流体，其具有恒定的参考密度 $\\rho_{0}$、动力粘度 $\\mu$、恒压比热容 $c_{p}$、热导率 $k$、热膨胀系数 $\\beta$ 和热扩散系数 $\\alpha$，其中 $\\alpha = k/(\\rho_{0} c_{p})$。重力是均匀的，加速度矢量为 $\\mathbf{g} = -g\\,\\hat{\\mathbf{z}}$。左壁保持均匀温度 $T_{\\text{hot}}$，右壁保持均匀温度 $T_{\\text{cold}}$，且 $T_{\\text{hot}} - T_{\\text{cold}} = \\Delta T > 0$。顶壁和底壁是绝热的。假设 Boussinesq 近似成立：除浮力项外，密度的变化被忽略，对于恒定的参考温度 $T_{0}$，有 $\\rho \\approx \\rho_{0} \\left(1 - \\beta (T - T_{0})\\right)$。\n\n从应用于该不可压缩流的质量守恒、动量守恒（流体牛顿第二定律）和能量守恒（热力学第一定律）出发，Boussinesq 方程组可以用速度场 $\\mathbf{u}(\\mathbf{x}, t)$、压力 $p'(\\mathbf{x}, t)$（吸收了静水压分量后的修正压力）和温度 $T(\\mathbf{x}, t)$ 表示：\n- 连续性方程：$\\nabla \\cdot \\mathbf{u} = 0$。\n- 动量方程：$\\rho_{0}\\left(\\dfrac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u}\\right) = -\\nabla p' + \\mu \\nabla^{2} \\mathbf{u} + \\rho_{0} \\beta \\left(T - T_{0}\\right)\\mathbf{g}$。\n- 能量方程：$\\dfrac{\\partial T}{\\partial t} + \\mathbf{u} \\cdot \\nabla T = \\alpha \\nabla^{2} T$。\n\n使用特征尺度：长度 $L$、温度 $\\Delta T$、速度 $U = \\alpha/L$、时间 $L^{2}/\\alpha$ 和压力 $\\rho_{0} U^{2}$，通过定义无量纲变量 $x^{\\ast} = x/L$、 $t^{\\ast} = t\\,\\alpha/L^{2}$、$\\mathbf{u}^{\\ast} = \\mathbf{u}/U$、 $p^{\\ast} = p'/(\\rho_{0} U^{2})$ 和 $\\Theta = (T - T_{0})/\\Delta T$ 来对系统进行无量纲化。在代入和简化后，当粘性项的前置因子为1时，找出在无量纲动量方程的浮力项中乘以温度场的那个唯一的涌现的无量纲参数组合。\n\n以仅包含 $g$、$\\beta$、$\\Delta T$、 $L$、$\\nu$ 和 $\\alpha$ 的封闭形式解析表达式报告该组合，其中 $\\nu = \\mu/\\rho_{0}$ 是运动粘度。最终表达式中不要包含单位。最终答案必须是单一的解析表达式。不需要进行数值计算。",
            "solution": "首先必须验证问题陈述的科学合理性、完整性和清晰度。\n\n步骤 1：提取已知条件。\n问题提供了以下信息：\n- 特征长度：$L$\n- 流体属性：恒定参考密度 $\\rho_{0}$、动力粘度 $\\mu$、恒压比热容 $c_{p}$、热导率 $k$、热膨胀系数 $\\beta$。\n- 重力加速度：$\\mathbf{g} = -g\\,\\hat{\\mathbf{z}}$\n- 热扩散系数：$\\alpha = k/(\\rho_{0} c_{p})$\n- 温差：$\\Delta T = T_{\\text{hot}} - T_{\\text{cold}} > 0$\n- 密度的 Boussinesq 近似：$\\rho \\approx \\rho_{0} \\left(1 - \\beta (T - T_{0})\\right)$\n- 速度 $\\mathbf{u}$、压力 $p'$ 和温度 $T$ 的控制方程：\n  - 连续性方程：$\\nabla \\cdot \\mathbf{u} = 0$\n  - 动量方程：$\\rho_{0}\\left(\\dfrac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u}\\right) = -\\nabla p' + \\mu \\nabla^{2} \\mathbf{u} + \\rho_{0} \\beta \\left(T - T_{0}\\right)\\mathbf{g}$\n  - 能量方程：$\\dfrac{\\partial T}{\\partial t} + \\mathbf{u} \\cdot \\nabla T = \\alpha \\nabla^{2} T$\n- 用于无量纲化的特征尺度：\n  - 长度：$L$\n  - 温度：$\\Delta T$ (相对于参考温度 $T_0$)\n  - 速度：$U = \\alpha/L$\n  - 时间：$L^{2}/\\alpha$\n  - 压力：$\\rho_{0} U^{2}$\n- 无量纲变量：\n  - $x^{\\ast} = x/L$\n  - $t^{\\ast} = t\\,\\alpha/L^{2}$\n  - $\\mathbf{u}^{\\ast} = \\mathbf{u}/U$\n  - $p^{\\ast} = p'/(\\rho_{0} U^{2})$\n  - $\\Theta = (T - T_{0})/\\Delta T$\n- 运动粘度定义：$\\nu = \\mu/\\rho_{0}$\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学依据，描述了公认的自然对流 Boussinesq 模型。所提供的控制方程是在此近似下的标准守恒定律。该任务是计算工程和流体动力学中的一个标准程序：对控制方程进行无量纲化以确定关键的无量纲参数。该问题是适定的、客观的，并包含推导所要求的无量纲数组所需的所有必要信息。不存在科学缺陷、矛盾或模糊之处。\n\n步骤 3：结论与行动。\n问题有效。将推导解答。\n\n目标是对动量方程进行无量纲化，并在粘性项的前置因子为1的条件下，确定浮力项中乘以温度的无量纲数组。\n\n首先，用无量纲对应项表示有量纲变量和微分算子。\n- 位置：$\\mathbf{x} = L\\mathbf{x}^{\\ast} \\implies \\nabla = \\frac{1}{L}\\nabla^{\\ast}$ and $\\nabla^2 = \\frac{1}{L^2}\\nabla^{2\\ast}$\n- 时间：$t = \\frac{L^2}{\\alpha} t^{\\ast} \\implies \\frac{\\partial}{\\partial t} = \\frac{\\alpha}{L^2}\\frac{\\partial}{\\partial t^{\\ast}}$\n- 速度：$\\mathbf{u} = U \\mathbf{u}^{\\ast} = \\frac{\\alpha}{L} \\mathbf{u}^{\\ast}$\n- 压力：$p' = \\rho_{0} U^{2} p^{\\ast} = \\rho_{0} \\left(\\frac{\\alpha}{L}\\right)^2 p^{\\ast}$\n- 温度：$T - T_0 = \\Delta T \\Theta$\n\n现在，将这些表达式代入动量方程：\n$$\n\\rho_{0}\\left(\\dfrac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u}\\right) = -\\nabla p' + \\mu \\nabla^{2} \\mathbf{u} + \\rho_{0} \\beta \\left(T - T_{0}\\right)\\mathbf{g}\n$$\n我们分析每一项的变换。\n\n- 瞬态项：$\\rho_{0}\\dfrac{\\partial \\mathbf{u}}{\\partial t} = \\rho_{0} \\dfrac{\\partial}{\\partial t}(U \\mathbf{u}^{\\ast}) = \\rho_{0} U \\dfrac{\\partial \\mathbf{u}^{\\ast}}{\\partial t} = \\rho_{0} \\left(\\frac{\\alpha}{L}\\right) \\left(\\frac{\\alpha}{L^2}\\right) \\dfrac{\\partial \\mathbf{u}^{\\ast}}{\\partial t^{\\ast}} = \\frac{\\rho_{0} \\alpha^2}{L^3} \\dfrac{\\partial \\mathbf{u}^{\\ast}}{\\partial t^{\\ast}}$\n- 对流项：$\\rho_{0} \\mathbf{u} \\cdot \\nabla \\mathbf{u} = \\rho_{0} (U \\mathbf{u}^{\\ast}) \\cdot \\left(\\frac{1}{L}\\nabla^{\\ast}\\right) (U \\mathbf{u}^{\\ast}) = \\frac{\\rho_{0} U^2}{L} (\\mathbf{u}^{\\ast} \\cdot \\nabla^{\\ast} \\mathbf{u}^{\\ast}) = \\frac{\\rho_{0}}{L}\\left(\\frac{\\alpha}{L}\\right)^2 (\\mathbf{u}^{\\ast} \\cdot \\nabla^{\\ast} \\mathbf{u}^{\\ast}) = \\frac{\\rho_{0} \\alpha^2}{L^3} (\\mathbf{u}^{\\ast} \\cdot \\nabla^{\\ast} \\mathbf{u}^{\\ast})$\n- 压力梯度项：$-\\nabla p' = -\\left(\\frac{1}{L}\\nabla^{\\ast}\\right) (\\rho_{0} U^{2} p^{\\ast}) = -\\frac{\\rho_{0} U^2}{L} \\nabla^{\\ast} p^{\\ast} = -\\frac{\\rho_{0}}{L} \\left(\\frac{\\alpha}{L}\\right)^2 \\nabla^{\\ast} p^{\\ast} = -\\frac{\\rho_{0} \\alpha^2}{L^3} \\nabla^{\\ast} p^{\\ast}$\n- 粘性项：$\\mu \\nabla^{2} \\mathbf{u} = \\mu \\left(\\frac{1}{L^2}\\nabla^{2\\ast}\\right) (U \\mathbf{u}^{\\ast}) = \\frac{\\mu U}{L^2}\\nabla^{2\\ast} \\mathbf{u}^{\\ast} = \\frac{\\mu}{L^2}\\left(\\frac{\\alpha}{L}\\right)\\nabla^{2\\ast} \\mathbf{u}^{\\ast} = \\frac{\\mu \\alpha}{L^3}\\nabla^{2\\ast} \\mathbf{u}^{\\ast}$\n- 浮力项：$\\rho_{0} \\beta \\left(T - T_{0}\\right)\\mathbf{g} = \\rho_{0} \\beta (\\Delta T \\Theta) \\mathbf{g}$\n\n将这些代入动量方程：\n$$\n\\frac{\\rho_{0} \\alpha^2}{L^3} \\left( \\dfrac{\\partial \\mathbf{u}^{\\ast}}{\\partial t^{\\ast}} + \\mathbf{u}^{\\ast} \\cdot \\nabla^{\\ast} \\mathbf{u}^{\\ast} \\right) = -\\frac{\\rho_{0} \\alpha^2}{L^3} \\nabla^{\\ast} p^{\\ast} + \\frac{\\mu \\alpha}{L^3}\\nabla^{2\\ast} \\mathbf{u}^{\\ast} + \\rho_{0} \\beta \\Delta T \\Theta \\mathbf{g}\n$$\n问题要求方程的无量纲形式中，粘性项的前置因子为1。变换后粘性项的有量纲系数是 $\\frac{\\mu \\alpha}{L^3}$。为了使无量纲前置因子为1，我们必须用这个系数去除整个方程。\n\n用 $\\frac{\\mu \\alpha}{L^3}$ 去除：\n$$\n\\frac{\\rho_{0} \\alpha^2 / L^3}{\\mu \\alpha / L^3} \\left( \\dfrac{\\partial \\mathbf{u}^{\\ast}}{\\partial t^{\\ast}} + \\mathbf{u}^{\\ast} \\cdot \\nabla^{\\ast} \\mathbf{u}^{\\ast} \\right) = -\\frac{\\rho_{0} \\alpha^2 / L^3}{\\mu \\alpha / L^3} \\nabla^{\\ast} p^{\\ast} + \\frac{\\mu \\alpha / L^3}{\\mu \\alpha / L^3}\\nabla^{2\\ast} \\mathbf{u}^{\\ast} + \\frac{\\rho_{0} \\beta \\Delta T \\mathbf{g}}{\\mu \\alpha / L^3} \\Theta\n$$\n现在，我们简化系数。\n惯性项（左侧）和压力项的系数是：\n$$\n\\frac{\\rho_{0} \\alpha^2}{\\mu \\alpha} = \\frac{\\rho_{0} \\alpha}{\\mu} = \\frac{\\alpha}{\\mu/\\rho_{0}} = \\frac{\\alpha}{\\nu}\n$$\n这是普朗特数 $\\text{Pr} = \\nu/\\alpha$ 的倒数。\n\n根据构造，粘性项的系数是：\n$$\n\\frac{\\mu \\alpha / L^3}{\\mu \\alpha / L^3} = 1\n$$\n浮力项的系数是：\n$$\n\\frac{\\rho_{0} g \\beta \\Delta T L^3}{\\mu \\alpha}\n$$\n注意，我们在标量系数中使用了重力矢量 $\\mathbf{g}$ 的大小 $g$。\n问题要求表达式以 $g$、$\\beta$、$\\Delta T$、 $L$、$\\nu$ 和 $\\alpha$ 表示。分母中有 $\\mu$，所以我们代入 $\\mu = \\rho_0 \\nu$：\n$$\n\\text{系数} = \\frac{\\rho_{0} g \\beta \\Delta T L^3}{(\\rho_{0} \\nu) \\alpha} = \\frac{g \\beta \\Delta T L^3}{\\nu \\alpha}\n$$\n这个无量纲数组是瑞利数，$\\text{Ra}$。这就是在浮力项中乘以温度场 $\\Theta$ 的涌现参数组合。\n\n最终的无量纲动量方程是：\n$$\n\\frac{\\alpha}{\\nu} \\left( \\dfrac{\\partial \\mathbf{u}^{\\ast}}{\\partial t^{\\ast}} + \\mathbf{u}^{\\ast} \\cdot \\nabla^{\\ast} \\mathbf{u}^{\\ast} \\right) = - \\frac{\\alpha}{\\nu} \\nabla^{\\ast} p^{\\ast} + \\nabla^{2\\ast} \\mathbf{u}^{\\ast} + \\left( \\frac{g \\beta \\Delta T L^3}{\\nu \\alpha} \\right) \\Theta \\frac{\\mathbf{g}}{g}\n$$\n乘以无量纲温度场的量确实是推导出的那个。它是一个仅由指定参数组成的封闭形式解析表达式。",
            "answer": "$$\\boxed{\\frac{g \\beta \\Delta T L^3}{\\nu \\alpha}}$$"
        },
        {
            "introduction": "一个正确编写的模拟程序必须首先能够再现已知的简单物理状态。本问题为实现了布辛涅斯克近似的求解器提供了一个经典的验证测试：一个处于静止状态的稳定分层流体。您的任务是推导精确的解析压力分布 ，该分布为验证数值求解器的输出提供了一个精确的基准，以确保其正确地耦合了温度、密度和压力。",
            "id": "1810217",
            "problem": "一名学生正在开发一个定制的计算流体动力学 (CFD) 求解器，用于模拟新制造工艺中的热效应。作为对代码中自然对流实现的关键验证测试，该学生模拟了在稳定温度梯度下处于静止状态的流体。\n\n物理场景包含一个完全填充在密封、静止的竖直通道中的流体，通道高度为 $H$。通道的侧壁是完全绝热的。位于垂直位置 $z=0$ 的平坦底板保持在恒定的均匀温度 $T_0$。位于 $z=H$ 的平坦顶板保持在更高的恒定均匀温度 $T_H$。整个系统处于均匀重力场中，由矢量 $\\mathbf{g} = -g\\hat{\\mathbf{k}}$ 表示，其中 $g$ 是重力加速度的大小，$\\hat{\\mathbf{k}}$ 是正 $z$ 方向的单位矢量。\n\n假设流体的密度根据 Boussinesq 近似随温度变化，由方程 $\\rho(T) = \\rho_{ref}[1 - \\beta(T - T_{ref})]$ 给出。这里，$\\rho_{ref}$ 是流体在指定参考温度 $T_{ref}$ 下的参考密度，$\\beta$ 是恒定的热膨胀系数。\n\n对于这种稳定分层结构 ($T_H > T_0$)，一个正确实现的求解器应该预测流体保持完全静止（静止或零速度场）。你的任务是推导出求解器必须复现才能通过此验证测试的理论压力分布 $P(z)$。底板处的压力给定为 $P(0) = P_0$。\n\n推导压力 $P(z)$ 作为垂直坐标 $z$ 的函数的闭式解析表达式。你的最终表达式应以给定的参数表示：$P_0, g, \\rho_{ref}, \\beta, T_{ref}, T_0, T_H, H$ 和 $z$。",
            "solution": "问题要求在稳定的温度梯度下，使用 Boussinesq 近似计算静止流体中的压力分布 $P(z)$。\n\n步骤 1：写出静态流体的控制方程。\n对于静止的流体，速度场处处为零。在这种情况下，动量方程简化为流体静力学方程，它将压力梯度与局部流体密度和重力联系起来。对于垂直的 $z$ 方向，该方程为：\n$$\n\\frac{dP}{dz} = -\\rho(z) g\n$$\n这里，$\\rho(z)$ 是流体的密度，它因温度变化而随高度变化。\n\n步骤 2：确定温度分布 $T(z)$。\n流体是静止的，且垂直壁面是绝热的。因此，热量只能通过传导在垂直方向上传递。稳态一维热传导方程为：\n$$\n\\frac{d^2T}{dz^2} = 0\n$$\n对此方程关于 $z$ 积分两次，得到一个通用的线性温度分布：\n$$\nT(z) = C_1 z + C_2\n$$\n常数 $C_1$ 和 $C_2$ 由顶部和底部板的边界条件确定。\n在 $z=0$ 处，我们有 $T(0) = T_0$。将其代入方程得到：\n$$\nT(0) = C_1(0) + C_2 = T_0 \\implies C_2 = T_0\n$$\n在 $z=H$ 处，我们有 $T(H) = T_H$。将其和 $C_2$ 的值代入得到：\n$$\nT(H) = C_1 H + T_0 = T_H \\implies C_1 = \\frac{T_H - T_0}{H}\n$$\n因此，整个流体中的温度分布为：\n$$\nT(z) = T_0 + \\left(\\frac{T_H - T_0}{H}\\right)z\n$$\n\n步骤 3：使用 Boussinesq 近似表示密度分布 $\\rho(z)$。\n问题指出密度由 Boussinesq 近似控制：\n$$\n\\rho(T) = \\rho_{ref}[1 - \\beta(T - T_{ref})]\n$$\n将步骤 2 中的 $T(z)$ 表达式代入此方程，以求得密度作为高度的函数 $\\rho(z)$：\n$$\n\\rho(z) = \\rho_{ref}\\left[1 - \\beta\\left(\\left(T_0 + \\left(\\frac{T_H - T_0}{H}\\right)z\\right) - T_{ref}\\right)\\right]\n$$\n为清晰起见，我们可以重新排列括号内的项：\n$$\n\\rho(z) = \\rho_{ref}\\left[1 - \\beta(T_0 - T_{ref}) - \\beta\\left(\\frac{T_H - T_0}{H}\\right)z\\right]\n$$\n\n步骤 4：将密度分布代入流体静力学方程并积分。\n现在，我们将步骤 3 中的 $\\rho(z)$ 表达式代入步骤 1 的流体静力学方程：\n$$\n\\frac{dP}{dz} = -g \\rho_{ref}\\left[1 - \\beta(T_0 - T_{ref}) - \\beta\\left(\\frac{T_H - T_0}{H}\\right)z\\right]\n$$\n为了求出压力 $P(z)$，我们对该微分方程从底板（其中 $z=0$ 且 $P=P_0$）积分到一个任意高度 $z$（其中压力为 $P(z)$）：\n$$\n\\int_{P_0}^{P(z)} dP' = \\int_{0}^{z} -g \\rho_{ref}\\left[1 - \\beta(T_0 - T_{ref}) - \\beta\\left(\\frac{T_H - T_0}{H}\\right)z'\\right] dz'\n$$\n左侧计算结果为 $P(z) - P_0$。右侧逐项积分：\n$$\nP(z) - P_0 = -g \\rho_{ref} \\int_{0}^{z} \\left[ (1 - \\beta(T_0 - T_{ref})) - \\left(\\frac{\\beta(T_H - T_0)}{H}\\right)z' \\right] dz'\n$$\n$$\nP(z) - P_0 = -g \\rho_{ref} \\left[ (1 - \\beta(T_0 - T_{ref}))z' - \\left(\\frac{\\beta(T_H - T_0)}{H}\\right)\\frac{z'^2}{2} \\right]_{0}^{z}\n$$\n计算积分在上限 $z$ 和下限 $0$ 处的值：\n$$\nP(z) - P_0 = -g \\rho_{ref} \\left( (1 - \\beta(T_0 - T_{ref}))z - \\frac{\\beta(T_H - T_0)}{2H}z^2 \\right)\n$$\n最后，求解 $P(z)$ 得到所需的压力分布：\n$$\nP(z) = P_0 - g \\rho_{ref} (1 - \\beta(T_0 - T_{ref}))z + g \\rho_{ref}\\frac{\\beta(T_H - T_0)}{2H}z^2\n$$\n为了匹配一种常见的形式，可以稍微重新整理此表达式，展开各项：\n$$\nP(z) = P_0 - g \\rho_{ref}z + g \\rho_{ref}\\beta(T_0 - T_{ref})z + g \\rho_{ref}\\frac{\\beta(T_H - T_0)}{2H}z^2\n$$\n推导出的表达式是 CFD 模拟应该再现的理论压力场。它表明，由于密度随温度变化，压力是高度的二次函数，这与在等温流体中发现的线性分布有所不同。",
            "answer": "$$\\boxed{P_0 - g \\rho_{ref} \\left(1 - \\beta(T_0 - T_{ref})\\right)z + \\frac{g \\rho_{ref} \\beta (T_H - T_0)}{2H}z^{2}}$$"
        },
        {
            "introduction": "在验证了我们的求解器之后，我们便可以充满信心地将其应用于更复杂的动态问题。这最后一个练习将探讨在完全对流流动中，热量传递（以努塞尔数 $\\mathrm{Nu}$ 表示）与瑞利数 $\\mathrm{Ra}$ 之间的关系。您将首先使用尺度分析来推导层流状态下的理论幂律关系，然后编写一个程序，将这一理论预测与已有的经验关联式进行比较 ，这个过程反映了在研究和工程实践中验证和理解计算模型的方法。",
            "id": "3989167",
            "problem": "考虑一个在 Oberbeck–Boussinesq 近似下的差热垂直矩形腔内的二维自然对流，其中密度变化仅限于浮力项。位于 $x=0$ 的左壁在温度 $T_{\\mathrm{hot}}$ 下是等温的，位于 $x=L$ 的右壁在温度 $T_{\\mathrm{cold}}$ 下是等温的，顶壁和底壁是绝热的。设 $H$ 为腔体高度，并假设平面外方向的深度为单位长度，重力为 $\\mathbf{g}= - g \\,\\hat{\\mathbf{y}}$。工作流体的运动粘度为 $\\nu$，热扩散率为 $\\alpha$，热膨胀系数为 $\\beta$，导热系数为 $k$。特征温差为 $\\Delta T = T_{\\mathrm{hot}} - T_{\\mathrm{cold}} > 0$。\n\n从带有 Boussinesq 浮力项的不可压缩 Navier–Stokes 方程和热能方程出发，\n- 质量守恒: $\\nabla \\cdot \\mathbf{u} = 0$，\n- 动量守恒: $\\rho_0 \\left( \\dfrac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u} \\right) = - \\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\rho_0 g \\beta \\left( T - T_0 \\right)\\hat{\\mathbf{y}}$，\n- 能量守恒: $\\dfrac{\\partial T}{\\partial t} + \\mathbf{u}\\cdot\\nabla T = \\alpha \\nabla^2 T$，\n其中 $\\mu=\\rho_0 \\nu$，推导在稳定层流状态下，当沿垂直壁形成薄边界层时，平均努塞尔数 $\\,\\mathrm{Nu}\\,$ 随瑞利数 $\\,\\mathrm{Ra}\\,$ 的标度关系。使用腔体高度 $H$ 作为参考长度，通过无量纲化和适用于边界层主导的层流的主导平衡分析，证明在固定普朗特数 $\\,\\mathrm{Pr}=\\nu/\\alpha\\,$ 时，$\\mathrm{Nu}\\sim \\mathrm{Ra}^{\\,n}$ 中的幂律指数 $n$ 的预测值是多少。\n\n然后，实现一个程序，将此理论推导的标度关系与用作垂直表面平均壁面传热代理的两个经验关联式进行比较：\n- 经验关联式 L（层流垂直板形式）：\n$$\n\\mathrm{Nu}_L(\\mathrm{Ra},\\mathrm{Pr}) \\;=\\; 0.68 \\;+\\; \\dfrac{0.670\\, \\mathrm{Ra}^{1/4}}{\\left[\\,1 + \\left(0.492/\\mathrm{Pr}\\right)^{9/16}\\right]^{4/9}} \\, .\n$$\n- 经验关联式 A（全工况垂直板形式）：\n$$\n\\mathrm{Nu}_A(\\mathrm{Ra},\\mathrm{Pr}) \\;=\\; \\left[\\,0.825 \\;+\\; \\dfrac{0.387\\, \\mathrm{Ra}^{1/6}}{\\left[\\,1 + \\left(0.492/\\mathrm{Pr}\\right)^{9/16}\\right]^{8/27}}\\,\\right]^2 .\n$$\n\n对于每个关联式，还需计算在固定 $\\,\\mathrm{Pr}\\,$ 下相对于 $\\,\\mathrm{Ra}\\,$ 的局部对数斜率（局部标度指数），定义为\n$$\nn_{\\star}(\\mathrm{Ra},\\mathrm{Pr}) \\;=\\; \\dfrac{d \\ln \\mathrm{Nu}_{\\star}}{d \\ln \\mathrm{Ra}} \\;=\\; \\dfrac{\\mathrm{Ra}}{\\mathrm{Nu}_{\\star}} \\dfrac{\\partial \\mathrm{Nu}_{\\star}}{\\partial \\mathrm{Ra}} \\, ,\n$$\n其中 $\\,\\star \\in \\{L,A\\}\\,$。\n\n你的程序必须：\n- 硬编码你分析中理论推导出的指数 $\\,n_{\\mathrm{th}}\\,$。\n- 对每个测试用例，计算包含五个浮点数的元组：\n  1) $n_{\\mathrm{th}}$，\n  2) $n_L(\\mathrm{Ra},\\mathrm{Pr})$，\n  3) $n_A(\\mathrm{Ra},\\mathrm{Pr})$，\n  4) $\\mathrm{Nu}_L(\\mathrm{Ra},\\mathrm{Pr})$，\n  5) $\\mathrm{Nu}_A(\\mathrm{Ra},\\mathrm{Pr})$。\n- 将报告的每个浮点数四舍五入到小数点后六位。\n\n使用以下 $(\\mathrm{Ra},\\mathrm{Pr})$ 对的测试套件，其涵盖了一系列层流条件和普朗特数：\n- 测试 1: $(\\mathrm{Ra},\\mathrm{Pr}) = (10^{3},\\,0.71)$，\n- 测试 2: $(\\mathrm{Ra},\\mathrm{Pr}) = (10^{5},\\,0.71)$，\n- 测试 3: $(\\mathrm{Ra},\\mathrm{Pr}) = (10^{7},\\,0.71)$，\n- 测试 4: $(\\mathrm{Ra},\\mathrm{Pr}) = (10^{5},\\,7.0)$，\n- 测试 5: $(\\mathrm{Ra},\\mathrm{Pr}) = (5\\times 10^{5},\\,2.0)$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，按上述顺序为每个测试用例连接五个浮点数。例如，输出格式为\n“[n_th_1,n_L_1,n_A_1,Nu_L_1,Nu_A_1,n_th_2,n_L_2,n_A_2,Nu_L_2,Nu_A_2,...]”。\n- 报告值中没有物理单位，因为 $\\,\\mathrm{Nu}\\,$, $\\,\\mathrm{Ra}\\,$ 和 $\\,\\mathrm{Pr}\\,$ 都是无量纲的。",
            "solution": "该问题需要两部分的回答：首先，理论推导自然对流中努塞尔数的标度关系；其次，将此标度关系与已有的经验关联式进行计算比较。\n\n该问题具有科学依据，提法明确，客观，并包含足够的信息以获得唯一解。它是对流传热领域的标准问题。因此，我们开始求解。\n\n**第一部分：标度律的理论推导**\n\n我们的目标是确定在差热腔体中，由薄边界层主导的稳定层流自然对流的标度关系 $\\mathrm{Nu} \\sim \\mathrm{Ra}^{\\,n}$ 中的指数 $n$。我们使用腔体高度 $H$ 作为特征长度尺度。\n\n流动由 Oberbeck–Boussinesq 方程控制，包括质量守恒、动量守恒和能量守恒。对于稳态（$ \\partial/\\partial t = 0 $）二维流动，速度场为 $\\mathbf{u} = (u,v)$，方程组为：\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0\n$$\n$$\nu \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} = - \\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial y} + \\nu \\left( \\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2} \\right) + g \\beta (T - T_0)\n$$\n$$\nu \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\left( \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} \\right)\n$$\n此处，$p'$ 是动压，参考温度 $T_0$ 可以方便地选择为 $T_{\\mathrm{cold}}$。y 轴与重力方向对齐，热壁和冷壁分别位于 $x=0$ 和 $x=L$。\n\n对于高瑞利数，沿垂直壁会形成厚度为 $\\delta_V$ 和 $\\delta_T$ 的薄速度边界层和热边界层。在这些边界层内部，垂直于壁面的梯度远大于平行于壁面的梯度。令 $\\delta$ 代表特征边界层厚度。\n坐标及其导数的标度为：$x \\sim \\delta$，$y \\sim H$，$\\partial/\\partial x \\sim 1/\\delta$，以及 $\\partial/\\partial y \\sim 1/H$。由于 $\\delta \\ll H$，我们有 $\\partial/\\partial x \\gg \\partial/\\partial y$。\n\n令 $V_c$ 为边界层内垂直（$y$）方向的特征速度。根据连续性方程，$\\partial u/\\partial x \\sim -\\partial v/\\partial y$，其标度为 $u/\\delta \\sim V_c/H$。这意味着水平速度远小于垂直速度：$u \\sim V_c (\\delta/H)$。\n\n将此标度应用于能量和动量方程，并仅保留主导项，我们得到边界层方程：\n$$\nu \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} \\approx \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\quad \\text{(能量)}\n$$\n$$\nu \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} \\approx \\nu \\frac{\\partial^2 v}{\\partial x^2} + g \\beta (T - T_{\\mathrm{cold}}) \\quad \\text{(y-动量)}\n$$\n我们对这些方程进行量级分析。跨越边界层的特征温差为 $\\Delta T = T_{\\mathrm{hot}} - T_{\\mathrm{cold}}$。\n\n从能量方程看，垂直热对流与水平热扩散之间达到平衡。\n$$\nv \\frac{\\partial T}{\\partial y} \\sim \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n代入各尺度：\n$$\nV_c \\frac{\\Delta T}{H} \\sim \\alpha \\frac{\\Delta T}{\\delta^2}\n$$\n这给出了特征速度 $V_c$ 和边界层厚度 $\\delta$ 之间的第一个关系式：\n$$\nV_c \\sim \\frac{\\alpha H}{\\delta^2} \\quad (1)\n$$\n从动量方程看，流体因浮力而加速，该力与粘性力相平衡。对于边界层流动，主导平衡发生在粘性项和浮力项之间。（如果 $\\mathrm{Pr} \\sim 1$，惯性项具有相同的量级，从而导致相同的标度关系）。\n$$\n\\nu \\frac{\\partial^2 v}{\\partial x^2} \\sim g \\beta (T - T_{\\mathrm{cold}})\n$$\n代入各尺度：\n$$\n\\nu \\frac{V_c}{\\delta^2} \\sim g \\beta \\Delta T\n$$\n这提供了第二个关系式：\n$$\nV_c \\sim \\frac{g \\beta \\Delta T \\delta^2}{\\nu} \\quad (2)\n$$\n现在我们通过令 $V_c$ 的两个表达式相等来求解 $\\delta$：\n$$\n\\frac{\\alpha H}{\\delta^2} \\sim \\frac{g \\beta \\Delta T \\delta^2}{\\nu}\n$$\n$$\n\\delta^4 \\sim \\frac{\\alpha \\nu H}{g \\beta \\Delta T} = \\frac{H^4 \\nu \\alpha}{g \\beta \\Delta T H^3}\n$$\n我们识别出分母是基于高度的瑞利数，$\\mathrm{Ra}_H = \\frac{g \\beta \\Delta T H^3}{\\nu \\alpha}$。\n$$\n\\delta^4 \\sim H^4 \\mathrm{Ra}_H^{-1} \\implies \\delta \\sim H \\mathrm{Ra}_H^{-1/4}\n$$\n因此，无量纲边界层厚度的标度关系为 $\\delta/H \\sim \\mathrm{Ra}_H^{-1/4}$。\n\n平均努塞尔数 $\\mathrm{Nu}$ 定义为对流传热与导热传热之比，使用 $H$ 作为参考长度：\n$$\n\\mathrm{Nu} = \\frac{h H}{k}\n$$\n其中 $h$ 是平均传热系数。壁面的平均热通量为 $q'' = h \\Delta T$。该通量也可由沿高度平均的傅里叶定律给出：$q'' \\approx -k (\\partial T / \\partial x)_{wall}$。\n壁面处的温度梯度标度为 $(\\partial T / \\partial x)_{wall} \\sim \\Delta T / \\delta$。\n因此，$h \\Delta T \\sim k (\\Delta T / \\delta)$，这意味着 $h \\sim k/\\delta$。\n将此代入努塞尔数的定义：\n$$\n\\mathrm{Nu} \\sim \\frac{(k/\\delta) H}{k} = \\frac{H}{\\delta} = \\left(\\frac{\\delta}{H}\\right)^{-1}\n$$\n使用我们对 $\\delta/H$ 的标度关系：\n$$\n\\mathrm{Nu} \\sim (\\mathrm{Ra}_H^{-1/4})^{-1} = \\mathrm{Ra}_H^{1/4}\n$$\n该分析表明，对于层流、边界层主导的自然对流，努塞尔数与瑞利数的标度关系为 $1/4$ 次幂。\n因此，理论推导的指数为 $n_{\\mathrm{th}} = 1/4 = 0.25$。\n\n**第二部分：经验关联式的局部标度指数**\n\n局部标度指数定义为 $n_{\\star} = \\frac{d \\ln \\mathrm{Nu}_{\\star}}{d \\ln \\mathrm{Ra}} = \\frac{\\mathrm{Ra}}{\\mathrm{Nu}_{\\star}} \\frac{\\partial \\mathrm{Nu}_{\\star}}{\\partial \\mathrm{Ra}}$。\n\n对于关联式 L: $\\mathrm{Nu}_L = 0.68 + C_L(\\mathrm{Pr}) \\mathrm{Ra}^{1/4}$，其中 $C_L(\\mathrm{Pr})$ 是依赖于 $\\mathrm{Pr}$ 的项。\n$$\n\\frac{\\partial \\mathrm{Nu}_L}{\\partial \\mathrm{Ra}} = C_L(\\mathrm{Pr}) \\frac{1}{4} \\mathrm{Ra}^{-3/4}\n$$\n$$\nn_L = \\frac{\\mathrm{Ra}}{\\mathrm{Nu}_L} \\left( C_L(\\mathrm{Pr}) \\frac{1}{4} \\mathrm{Ra}^{-3/4} \\right) = \\frac{1}{4} \\frac{C_L(\\mathrm{Pr}) \\mathrm{Ra}^{1/4}}{\\mathrm{Nu}_L}\n$$\n根据 $\\mathrm{Nu}_L$ 的定义，我们有 $C_L(\\mathrm{Pr}) \\mathrm{Ra}^{1/4} = \\mathrm{Nu}_L - 0.68$。\n$$\nn_L = \\frac{1}{4} \\frac{\\mathrm{Nu}_L - 0.68}{\\mathrm{Nu}_L} = \\frac{1}{4} \\left( 1 - \\frac{0.68}{\\mathrm{Nu}_L} \\right)\n$$\n\n对于关联式 A: $\\mathrm{Nu}_A = G^2$，其中 $G = 0.825 + C_A(\\mathrm{Pr}) \\mathrm{Ra}^{1/6}$。\n$$\n\\frac{\\partial \\mathrm{Nu}_A}{\\partial \\mathrm{Ra}} = 2 G \\frac{\\partial G}{\\partial \\mathrm{Ra}} = 2 G \\left( C_A(\\mathrm{Pr}) \\frac{1}{6} \\mathrm{Ra}^{-5/6} \\right)\n$$\n$$\nn_A = \\frac{\\mathrm{Ra}}{\\mathrm{Nu}_A} \\frac{\\partial \\mathrm{Nu}_A}{\\partial \\mathrm{Ra}} = \\frac{\\mathrm{Ra}}{G^2} \\left( 2 G \\frac{C_A(\\mathrm{Pr})}{6} \\mathrm{Ra}^{-5/6} \\right) = \\frac{1}{3} \\frac{C_A(\\mathrm{Pr}) \\mathrm{Ra}^{1/6}}{G}\n$$\n根据 $G$ 的定义，我们有 $C_A(\\mathrm{Pr}) \\mathrm{Ra}^{1/6} = G - 0.825$。\n$$\nn_A = \\frac{1}{3} \\frac{G - 0.825}{G} = \\frac{1}{3} \\left( 1 - \\frac{0.825}{G} \\right) = \\frac{1}{3} \\left( 1 - \\frac{0.825}{\\sqrt{\\mathrm{Nu}_A}} \\right)\n$$\n这些推导出的表达式简化了局部指数的计算。以下程序实现了这些公式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes theoretical and empirical scaling exponents and Nusselt numbers\n    for natural convection based on a set of test cases.\n    \"\"\"\n    # Hard-code the theoretically derived exponent 'n' from boundary-layer theory.\n    # Nu ~ Ra^n, where n = 1/4.\n    n_th = 0.25\n\n    # Define the test cases from the problem statement as (Ra, Pr) pairs.\n    test_cases = [\n        (1.0E3, 0.71),\n        (1.0E5, 0.71),\n        (1.0E7, 0.71),\n        (1.0E5, 7.0),\n        (5.0E5, 2.0),\n    ]\n\n    results = []\n    \n    for ra, pr in test_cases:\n        # --- Correlation L (Laminar) ---\n        # Nu_L = 0.68 + (0.670 * Ra^(1/4)) / [1 + (0.492/Pr)^(9/16)]^(4/9)\n        pr_term_l_den = 1.0 + (0.492 / pr)**(9.0 / 16.0)\n        numerator_l = 0.670 * ra**(1.0 / 4.0)\n        denominator_l = pr_term_l_den**(4.0 / 9.0)\n        nu_l = 0.68 + numerator_l / denominator_l\n        \n        # Local exponent n_L = (1/4) * (1 - 0.68 / Nu_L)\n        n_l = 0.25 * (1.0 - 0.68 / nu_l)\n\n        # --- Correlation A (All-regime) ---\n        # Nu_A = [0.825 + (0.387 * Ra^(1/6)) / [1 + (0.492/Pr)^(9/16)]^(8/27)]^2\n        pr_term_a_den = 1.0 + (0.492 / pr)**(9.0 / 16.0)\n        numerator_a = 0.387 * ra**(1.0 / 6.0)\n        denominator_a = pr_term_a_den**(8.0 / 27.0)\n        g_term = 0.825 + numerator_a / denominator_a\n        nu_a = g_term**2\n\n        # Local exponent n_A = (1/3) * (1 - 0.825 / sqrt(Nu_A))\n        n_a = (1.0 / 3.0) * (1.0 - 0.825 / (nu_a**0.5))\n        \n        # Collect the five required values for the current test case\n        # and round them to six decimal places.\n        current_results = [\n            round(n_th, 6),\n            round(n_l, 6),\n            round(n_a, 6),\n            round(nu_l, 6),\n            round(nu_a, 6),\n        ]\n        results.extend(current_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}