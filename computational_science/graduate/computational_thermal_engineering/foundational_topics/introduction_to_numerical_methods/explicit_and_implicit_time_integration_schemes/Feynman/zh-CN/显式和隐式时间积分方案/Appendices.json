{
    "hands_on_practices": [
        {
            "introduction": "离散瞬态热方程最直接的方法是使用显式格式，例如前向时间中心空间（FTCS）格式。虽然这种方法计算成本低且易于实现，但其应用受到严格的稳定性条件限制。本练习将引导你通过经典的冯·诺依曼稳定性分析，推导出这一关键约束，帮助你定量地理解为什么显式格式的时间步长与空间网格尺寸紧密耦合。",
            "id": "2483538",
            "problem": "一个均匀、各向同性、热扩散系数为常数的一维固体遵循瞬态热方程 $\\frac{\\partial T}{\\partial t}=\\alpha\\,\\frac{\\partial^{2}T}{\\partial x^{2}}$，该方程由能量守恒和傅里叶定律推导得出。其中，$T$ 是温度，$t$ 是时间，$x$ 是沿杆的空间坐标，$\\alpha$ 是热扩散系数。考虑一个间距为 $\\Delta x$ 的均匀网格，并应用前向时间中心空间（FTCS）显式时间积分格式，该格式使用前向欧拉步长来推进时间上的 $T$，并用二阶中心差分来近似空间二阶导数。使用 von Neumann（傅里叶）稳定性分析，确定使得该格式对所有空间傅里叶模式都处于临界稳定状态的最大时间步长 $\\Delta t_{\\max}$。\n\n使用数据 $\\alpha = 1.4 \\times 10^{-5}\\,\\mathrm{m^2/s}$ 和 $\\Delta x = 0.5\\,\\mathrm{mm}$，计算此一维 FTCS 离散化对应的 $\\Delta t_{\\max}$。将您的答案四舍五入到四位有效数字，并以秒为单位表示时间。",
            "solution": "该问题陈述科学严谨，提法适定，且包含得到唯一解所需的全部必要信息。因此，该问题被视为有效。我们继续进行求解。\n\n一维瞬态热传导的控制方程如下：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n这里，$T(x, t)$ 是温度，$x$ 是空间坐标，$t$ 是时间，$\\alpha$ 是热扩散系数。我们需要分析该方程的前向时间中心空间（FTCS）离散格式的稳定性。\n\n我们定义一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格。网格节点 $i$ 在时间层 $n$ 的温度表示为 $T_i^n \\equiv T(i\\Delta x, n\\Delta t)$。\n\nFTCS 格式对偏导数的近似如下：\n时间导数使用一阶前向差分进行近似：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i,n} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n空间二阶导数使用二阶中心差分进行近似：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i,n} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\n將这些近似代入控制方程，得到 FTCS 格式的离散形式：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} \\right)\n$$\n我们可以重新整理这个方程，以显式求解下一个时间步的温度 $T_i^{n+1}$：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\n我们定义无量纲傅里叶数 $\\mathrm{Fo}$（也称为扩散数）为：\n$$\n\\mathrm{Fo} = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\n离散方程简化为：\n$$\nT_i^{n+1} = T_i^n + \\mathrm{Fo} (T_{i+1}^n - 2T_i^n + T_{i-1}^n) = \\mathrm{Fo} \\, T_{i+1}^n + (1 - 2\\mathrm{Fo})T_i^n + \\mathrm{Fo} \\, T_{i-1}^n\n$$\n为了确定此数值格式的稳定性，我们进行 von Neumann 稳定性分析。我们考虑解的单个傅里叶模式的行为。设时间层 $n$ 的温度分布由一个傅里叶分量表示：\n$$\nT_i^n = \\hat{T}^n(k) e^{I k x_i}\n$$\n其中 $k$ 是波数，$x_i = i\\Delta x$ 是节点 $i$ 的空间位置，$I = \\sqrt{-1}$ 是虚数单位。在时间 $n$ 时，该模式的振幅是 $\\hat{T}^n(k)$。经过一个时间步长后，该模式将被一个放大因子 $G(k)$ 放大：\n$$\nT_i^{n+1} = \\hat{T}^{n+1}(k) e^{I k x_i} = G(k) \\hat{T}^n(k) e^{I k x_i}\n$$\n为使数值格式稳定，对任何波数 $k$，放大因子的模都不得超过 1。稳定性条件是：\n$$\n|G(k)| \\le 1\n$$\n我们将傅里叶模式的表达式代入离散方程：\n$$\nG(k) \\hat{T}^n(k) e^{I k (i\\Delta x)} = \\mathrm{Fo} \\, \\hat{T}^n(k) e^{I k ((i+1)\\Delta x)} + (1 - 2\\mathrm{Fo}) \\hat{T}^n(k) e^{I k (i\\Delta x)} + \\mathrm{Fo} \\, \\hat{T}^n(k) e^{I k ((i-1)\\Delta x)}\n$$\n两边同除以 $\\hat{T}^n(k) e^{I k (i\\Delta x)}$，得到放大因子 $G(k)$ 的表达式：\n$$\nG(k) = \\mathrm{Fo} \\, e^{I k \\Delta x} + (1 - 2\\mathrm{Fo}) + \\mathrm{Fo} \\, e^{-I k \\Delta x}\n$$\n使用欧拉恒等式 $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$，我们可以简化此表达式：\n$$\nG(k) = 1 - 2\\mathrm{Fo} + \\mathrm{Fo} (e^{I k \\Delta x} + e^{-I k \\Delta x}) = 1 - 2\\mathrm{Fo} + 2\\mathrm{Fo} \\cos(k \\Delta x)\n$$\n$$\nG(k) = 1 - 2\\mathrm{Fo}(1 - \\cos(k \\Delta x))\n$$\n使用三角半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$\nG(k) = 1 - 4\\mathrm{Fo} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n现在我们应用稳定性条件 $|G(k)| \\le 1$。由于 $\\mathrm{Fo} > 0$，项 $4\\mathrm{Fo} \\sin^2(k\\Delta x/2)$ 是非负的。因此，$G(k)$ 总是小于或等于 $1$。稳定性因而由下界决定：\n$$\nG(k) \\ge -1\n$$\n$$\n1 - 4\\mathrm{Fo} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4\\mathrm{Fo} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\frac{1}{2} \\ge \\mathrm{Fo} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n这个不等式必须对所有可能的波数 $k$ 都成立。当 $\\sin^2(k\\Delta x/2)$ 项达到其最大值时，出现最严格的条件。$\\sin^2(\\theta)$ 的最大值为 $1$。这对应于网格上可表示的最高频率（振荡最快）模式，此时 $k \\Delta x = \\pi$。\n因此，稳定性条件变为：\n$$\n\\mathrm{Fo} \\le \\frac{1}{2}\n$$\n在该条件的极限处，即 $\\mathrm{Fo} = 1/2$ 时，达到临界稳定。最大允许时间步长 $\\Delta t_{\\max}$ 对应于此极限：\n$$\n\\frac{\\alpha \\Delta t_{\\max}}{(\\Delta x)^2} = \\frac{1}{2}\n$$\n求解 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^2}{2\\alpha}\n$$\n给定数据如下：\n$\\alpha = 1.4 \\times 10^{-5} \\, \\mathrm{m^2/s}$\n$\\Delta x = 0.5 \\, \\mathrm{mm} = 0.5 \\times 10^{-3} \\, \\mathrm{m}$\n\n将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n(\\Delta x)^2 = (0.5 \\times 10^{-3} \\, \\mathrm{m})^2 = 0.25 \\times 10^{-6} \\, \\mathrm{m^2}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25 \\times 10^{-6} \\, \\mathrm{m^2}}{2 \\times (1.4 \\times 10^{-5} \\, \\mathrm{m^2/s})} = \\frac{0.25 \\times 10^{-6}}{2.8 \\times 10^{-5}} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25}{2.8} \\times 10^{-1} \\, \\mathrm{s} \\approx 0.0892857 \\times 10^{-1} \\, \\mathrm{s} = 0.00892857 \\, \\mathrm{s}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Delta t_{\\max} \\approx 0.008929 \\, \\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{0.008929}\n$$"
        },
        {
            "introduction": "为了克服显式格式对时间步长的严格限制，我们可以转向隐式方法。通过在未来的时间层（$t^{n+1}$）上计算空间导数，我们可以构建出无条件稳定的格式，从而允许使用更大的时间步长。本练习将重点推导典型的后向时间中心空间（BTCS）隐式格式，并揭示其求解过程中产生的线性代数方程组的结构，这是隐式积分的一个标志性特征。",
            "id": "2483544",
            "problem": "一个长度为 $L$ 的均匀、各向同性的一维固态平板，具有恒定的热导率 $k$、密度 $\\rho$ 和比热容 $c_p$，正在经历无内部热源的瞬态热传导。令 $T(x,t)$ 表示温度，并定义热扩散系数 $\\alpha = \\dfrac{k}{\\rho c_p}$。其能量平衡控制方程和傅里叶定律导出一维瞬态热方程\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}.\n$$\n用均匀网格 $x_i = i\\,\\Delta x$（其中 $i=0,1,\\dots,N-1$，$ \\Delta x = L/(N-1)$）对空间域 $[0,L]$ 进行离散化，并将时间离散化为 $t^n = n\\,\\Delta t$（其中 $n=0,1,2,\\dots$）。施加狄利克雷边界条件 $T(0,t) = T_L(t)$ 和 $T(L,t) = T_R(t)$，假定它们在所有时间 $t$ 上都已知。对于内部节点 $i=1,2,\\dots,N-2$，使用在时间层 $t^{n+1}$ 上求值的全隐式时间后向、空间中心有限差分近似来处理控制方程。\n\n任务：\n- 从能量守恒定律和傅里叶定律的陈述出发，推导由所述时间和空间离散化得出的内部节点的离散有限差分方程。引入无量纲参数 $r = \\dfrac{\\alpha\\,\\Delta t}{\\Delta x^2}$，并将离散方程简化为左侧包含 $T_{i-1}^{n+1}$、$T_{i}^{n+1}$ 和 $T_{i+1}^{n+1}$、右侧包含 $T_i^{n}$ 的三点格式。\n- 将 $i=1,2,\\dots,N-2$ 的方程组装成一个关于内部未知数 $\\mathbf{T}^{n+1}_{\\text{int}} = \\big(T_1^{n+1},\\dots,T_{N-2}^{n+1}\\big)^{\\top}$ 的三对角线性系统 $\\mathbf{A}\\,\\mathbf{T}^{n+1}_{\\text{int}} = \\mathbf{b}$，明确指出矩阵 $\\mathbf{A}$ 的次对角线、对角线和超对角线元素，以及向量 $\\mathbf{b}$ 的结构，包括时间 $t^{n+1}$ 的狄利克雷边界值如何进入第一个和最后一个方程。\n- 作为最终答案，报告三对角矩阵 $\\mathbf{A}$ 中内部节点的次对角线、对角线和超对角线系数组成的三元组，按此顺序用 $r$ 表示。将此三元组以单行矩阵的形式提供。不需要进行数值计算，也无需四舍五入。最终答案中不包含物理单位。",
            "solution": "所述问题是适定的、科学上合理的，并包含了唯一解所需的所有信息。我们直接进行推导。\n\n无内部热源的一维瞬态热传导的控制方程如下：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $T(x,t)$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\alpha$ 是热扩散系数。\n\n根据要求，我们使用全隐式有限差分格式。这意味着空间导数在未来的时间层 $t^{n+1}$ 上进行计算，而时间导数则使用后向差分进行近似。令 $T_i^n$ 表示在节点 $x_i$ 和时间 $t^n$ 的温度。\n\n在点 $(x_i, t^{n+1})$ 处的时间导数 $\\frac{\\partial T}{\\partial t}$ 通过一阶后向差分近似为：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i}^{n+1} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n\n在点 $(x_i, t^{n+1})$ 处的空间导数 $\\frac{\\partial^2 T}{\\partial x^2}$ 通过二阶中心差分近似为：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i}^{n+1} \\approx \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\n\n将这些近似代入控制偏微分方程，我们得到内部节点 $i$ 的有限差分方程：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n该方程对 $i = 1, 2, \\dots, N-2$ 有效。\n\n为得到要求的形式，我们首先将两边同乘以 $\\Delta t$：\n$$\nT_i^{n+1} - T_i^n = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\n现在我们引入无量纲参数，即网格的傅里叶数 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。方程变为：\n$$\nT_i^{n+1} - T_i^n = r \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\n任务要求将此方程整理成新时间层 $n+1$ 的所有项在左侧（LHS），当前时间层 $n$ 的项在右侧（RHS）的形式。\n$$\nT_i^{n+1} - r T_{i-1}^{n+1} + 2r T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n收集时间层 $n+1$ 处未知温度的系数，我们得到三点格式：\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n这完成了第一个任务。\n\n对于第二个任务，我们为未知的内部温度 $\\mathbf{T}^{n+1}_{\\text{int}} = (T_1^{n+1}, T_2^{n+1}, \\dots, T_{N-2}^{n+1})^{\\top}$ 组装线性方程组。从 $i=1$ 到 $i=N-2$，每个内部节点对应一个方程，共 $N-2$ 个方程。\n\n对于第一个内部节点，$i=1$：\n$$\n-r T_{0}^{n+1} + (1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n\n$$\n此处，$T_0^{n+1}$ 由 $x=0$ 处的狄利克雷边界条件确定，因此 $T_0^{n+1} = T_L(t^{n+1})$。由于这是一个已知值，我们将其移到右侧（RHS）：\n$$\n(1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n + r T_L(t^{n+1})\n$$\n\n对于一个通用内部节点 $i$，其中 $1  i  N-2$：\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n\n对于最后一个内部节点，$i=N-2$：\n$$\n-r T_{N-3}^{n+1} + (1 + 2r) T_{N-2}^{n+1} - r T_{N-1}^{n+1} = T_{N-2}^n\n$$\n此处，$T_{N-1}^{n+1}$ 由 $x=L$ 处的狄利克雷边界条件确定，因此 $T_{N-1}^{n+1} = T_R(t^{n+1})$。我们将这个已知值移到右侧（RHS）：\n$$\n-r T_{N-3}^{n+1} + (1 + 2r) T_{N-2}^{n+1} = T_{N-2}^n + r T_R(t^{n+1})\n$$\n\n将这 $N-2$ 个方程组装成矩阵形式 $\\mathbf{A} \\mathbf{T}^{n+1}_{\\text{int}} = \\mathbf{b}$：\n- 矩阵 $\\mathbf{A}$ 是一个 $(N-2) \\times (N-2)$ 的三对角矩阵。\n- 向量 $\\mathbf{b}$ 是一个 $(N-2) \\times 1$ 的列向量。\n\n矩阵 $\\mathbf{A}$ 具有以下结构：\n$$\n\\mathbf{A} =\n\\begin{pmatrix}\n1+2r  -r  0  \\cdots  0 \\\\\n-r  1+2r  -r  \\cdots  0 \\\\\n0  -r  1+2r  \\ddots  \\vdots \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  -r \\\\\n0  \\cdots  0  -r  1+2r\n\\end{pmatrix}\n$$\n对于任意内部行，矩阵 $\\mathbf{A}$ 的元素由通用格式导出：\n- 次对角线元素（$T_{i-1}^{n+1}$ 的系数）：$-r$\n- 对角线元素（$T_i^{n+1}$ 的系数）：$1+2r$\n- 超对角线元素（$T_{i+1}^{n+1}$ 的系数）：$-r$\n\n向量 $\\mathbf{b}$ 的构造如下：\n$$\n\\mathbf{b} =\n\\begin{pmatrix}\nT_1^n + r T_L(t^{n+1}) \\\\\nT_2^n \\\\\n\\vdots \\\\\nT_{N-3}^n \\\\\nT_{N-2}^n + r T_R(t^{n+1})\n\\end{pmatrix}\n$$\n时间 $t^{n+1}$ 的边界条件贡献给右侧向量 $\\mathbf{b}$ 的第一个和最后一个元素。\n\n最后的任务是报告矩阵 $\\mathbf{A}$ 中内部节点的次对角线、对角线和超对角线系数的三元组。对于矩阵的所有内部行，这些系数是恒定的。根据我们的分析，它们是：\n- 次对角线：$-r$\n- 对角线：$1+2r$\n- 超对角线：$-r$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -r  1+2r  -r \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个稳健的数值模拟不仅需要稳定的内部格式，还需要物理上一致的边界条件处理。在边界上看似合理但数值上不一致的处理方式，可能会引入非物理的人为现象，例如振荡或负的绝对温度，即使内部格式本身是稳定的。本练习通过一个常见的、但存在缺陷的“虚拟单元”方法给出一个极具说服力的反例，然后引导你推导出一个修正的、能够保持正定性的离散格式，以确保模拟结果的物理真实性。",
            "id": "3952016",
            "problem": "考虑均匀平板中的一维瞬态热传导，其热扩散率 $\\alpha$ 为常数，由热方程 $\\partial T/\\partial t = \\alpha \\,\\partial^{2}T/\\partial x^{2}$ 控制。使用间距为 $\\Delta x$ 的均匀网格，内部节点索引为 $i=1,2,\\dots,N-1$，并采用时间增量为 $\\Delta t$ 的前向欧拉法进行时间步进。节点 $i$ 处的标准显式内部更新使用中心差分来近似二阶导数。在左边界 $x=0$ 处，物理边界条件为狄利克雷（Dirichlet）指定条件 $T(0,t)=T_{b}$，其中 $T_{b}\\ge 0$ 是以开尔文（Kelvin）表示的恒定温度。\n\n在程序代码中，一种常见的边界实施方式是通过二阶狄利克雷关系式 $T_{0}^{n}=2\\,T_{b}-T_{1}^{n}$ 插入一个虚构单元值 $T_{0}^{n}$，以便在 $i=1$ 处复用内部格式。将傅里叶数（Fo）定义为 $\\mathrm{Fo} = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。使用显式内部更新和此虚构单元边界处理方法构建 $T_{1}^{n+1}$，然后使用 $\\mathrm{Fo}=0.49$、$T_{b}=300\\ \\mathrm{K}$、$T_{1}^{n}=900\\ \\mathrm{K}$ 和 $T_{2}^{n}=100\\ \\mathrm{K}$ 对其进行求值。证明此方法在一个时间步后，在节点 $i=1$ 处会产生负温度。\n\n然后，从相同的控制方程和显式方法出发，为 $i=1$ 处提出一种修正的单边离散格式，该格式在实施狄利克雷边界条件时，能确保对于所有 $\\mathrm{Fo}\\le 1/2$ 的情况，显式更新中的系数均保持非负。推导出最终的 $T_{1}^{n+1}$ 显式更新公式，其表达式完全由 $\\mathrm{Fo}$、$T_{1}^{n}$、$T_{2}^{n}$ 和 $T_{b}$ 构成。\n\n你的最终答案必须是修正后的 $T_{1}^{n+1}$ 更新的单一闭式解析表达式。无需进行数值四舍五入。如果计算任何中间数值，温度以开尔文表示。",
            "solution": "首先验证问题，以确保其科学上成立、适定且客观。\n\n### 步骤1：提取已知条件\n- 控制方程：$\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^{2}T}{\\partial x^{2}}$，用于一维瞬态热传导。\n- 材料属性：热扩散率 $\\alpha$ 为常数。\n- 离散化：间距为 $\\Delta x$ 的均匀网格，时间增量为 $\\Delta t$ 的前向欧拉时间步进。内部节点索引为 $i=1,2,\\dots,N-1$。\n- 内部更新格式：显式，使用中心差分近似二阶导数。\n- 边界条件：在左边界（$x=0$），指定狄利克雷条件 $T(0,t)=T_{b}$，其中 $T_{b}\\ge 0$ 是以开尔文为单位的恒定温度。\n- 方法1（虚构单元）：通过虚构单元值 $T_{0}^{n}=2\\,T_{b}-T_{1}^{n}$ 实施边界条件，并在节点 $i=1$ 处复用内部格式。\n- 傅里叶数：$\\mathrm{Fo}=\\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}$。\n- 方法1评估所用数值：$\\mathrm{Fo}=0.49$，$T_{b}=300\\ \\mathrm{K}$，$T_{1}^{n}=900\\ \\mathrm{K}$，$T_{2}^{n}=100\\ \\mathrm{K}$。\n- 方法2（修正后）的要求：在 $i=1$ 处提出一种修正的单边离散格式，该格式能在所有 $\\mathrm{Fo}\\le \\frac{1}{2}$ 的情况下保持显式更新中系数的非负性。\n- 期望结果：为修正方法推导 $T_{1}^{n+1}$ 的显式更新公式。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学和数学上是合理的。它涉及计算传热学中的一个标准课题：使用显式有限差分法对热方程进行数值求解。核心任务是分析一种常见但可能存在缺陷的狄利克雷边界条件实施方式，然后推导出一个更稳健、能保持正值的格式。给定的参数和方程都是标准的。问题本身是自洽的、客观的且适定的，不存在矛盾或模糊之处。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n\n一维热传导控制方程为：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^{2}T}{\\partial x^{2}}\n$$\n我们使用前向欧拉格式在时间上进行离散，并使用二阶中心差分格式在空间上进行离散。内部节点 $i$ 的离散方程为：\n$$\n\\frac{T_{i}^{n+1} - T_{i}^{n}}{\\Delta t} = \\alpha \\frac{T_{i-1}^{n} - 2T_{i}^{n} + T_{i+1}^{n}}{(\\Delta x)^{2}}\n$$\n为求解新时间步的温度 $T_{i}^{n+1}$ 进行整理，并引入傅里叶数 $\\mathrm{Fo} = \\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}$，我们得到显式的内部更新公式：\n$$\nT_{i}^{n+1} = T_{i}^{n} + \\mathrm{Fo} (T_{i-1}^{n} - 2T_{i}^{n} + T_{i+1}^{n})\n$$\n$$\nT_{i}^{n+1} = \\mathrm{Fo}\\,T_{i-1}^{n} + (1 - 2\\mathrm{Fo})T_{i}^{n} + \\mathrm{Fo}\\,T_{i+1}^{n}\n$$\n已知当系数为非负时，此格式是稳定的，这要求 $1 - 2\\mathrm{Fo} \\ge 0$，即 $\\mathrm{Fo} \\le \\frac{1}{2}$。\n\n**第一部分：虚构单元法分析**\n\n题目指定在节点 $i=1$ 应用内部格式，这需要一个 $T_{0}^{n}$ 的值。给定的虚构单元关系式是 $T_{0}^{n} = 2T_{b} - T_{1}^{n}$。如果假设网格是单元中心的，则此关系是在位于 $x=\\frac{\\Delta x}{2}$ 的边界面上对 $T=T_b$ 的二阶精度施加；或者，在节点中心网格上，它是 $\\frac{T(x_1) + T(x_{-1})}{2} = T(0)$ 的近似，但这对于一个固定值来说是不正确的。我们遵循题目的指示。\n$T_{1}^{n+1}$ 的更新公式为：\n$$\nT_{1}^{n+1} = \\mathrm{Fo}\\,T_{0}^{n} + (1 - 2\\mathrm{Fo})T_{1}^{n} + \\mathrm{Fo}\\,T_{2}^{n}\n$$\n代入给定的 $T_{0}^{n}$ 表达式：\n$$\nT_{1}^{n+1} = \\mathrm{Fo}(2T_{b} - T_{1}^{n}) + (1 - 2\\mathrm{Fo})T_{1}^{n} + \\mathrm{Fo}\\,T_{2}^{n}\n$$\n$$\nT_{1}^{n+1} = 2\\mathrm{Fo}\\,T_{b} - \\mathrm{Fo}\\,T_{1}^{n} + T_{1}^{n} - 2\\mathrm{Fo}\\,T_{1}^{n} + \\mathrm{Fo}\\,T_{2}^{n}\n$$\n$$\nT_{1}^{n+1} = (1 - 3\\mathrm{Fo})T_{1}^{n} + \\mathrm{Fo}\\,T_{2}^{n} + 2\\mathrm{Fo}\\,T_{b}\n$$\n为使系数非负，我们需要 $1 - 3\\mathrm{Fo} \\ge 0$，这意味着 $\\mathrm{Fo} \\le \\frac{1}{3}$。这是一个比内部节点更严格的稳定性要求。\n\n现在，我们使用给定的数值对此表达式进行求值：$\\mathrm{Fo}=0.49$，$T_{b}=300\\ \\mathrm{K}$，$T_{1}^{n}=900\\ \\mathrm{K}$ 和 $T_{2}^{n}=100\\ \\mathrm{K}$。傅里叶数 $\\mathrm{Fo}=0.49$ 违反了局部稳定性条件 $\\mathrm{Fo} \\le \\frac{1}{3}$。\n$$\nT_{1}^{n+1} = (1 - 3 \\times 0.49)(900) + (0.49)(100) + 2(0.49)(300)\n$$\n$$\nT_{1}^{n+1} = (1 - 1.47)(900) + 49 + 294\n$$\n$$\nT_{1}^{n+1} = (-0.47)(900) + 343\n$$\n$$\nT_{1}^{n+1} = -423 + 343 = -80\n$$\n结果温度为 $T_{1}^{n+1} = -80\\ \\mathrm{K}$。这是一个负绝对温度，在物理上是不可能的，这证明了在给定条件下此数值边界处理方法的失败。\n\n**第二部分：修正格式的推导**\n\n我们为节点 $i=1$ 寻求一种修正的单边离散格式，该格式对于标准显式稳定性极限 $\\mathrm{Fo} \\le \\frac{1}{2}$ 是稳健的。最直接且物理上一致的方法是将狄利克雷边界值 $T_b$ 直接纳入节点 $i=1$ 处二阶导数的有限差分格式中。\n\n节点 $i=1$ 位于 $x_1=\\Delta x$ 处。其相邻点是 $x=0$ 处的边界和 $x_2=2\\Delta x$ 处的节点 $i=2$。我们可以使用一个以 $x_1$ 为中心，并利用 $x=0$、$x_1=\\Delta x$ 和 $x_2=2\\Delta x$ 这三个点的标准三点中心差分公式来计算 $\\frac{\\partial^2 T}{\\partial x^2}$：\n$$\n\\left. \\frac{\\partial^{2}T}{\\partial x^{2}} \\right|_{x_1} \\approx \\frac{T(x_1-\\Delta x) - 2T(x_1) + T(x_1+\\Delta x)}{(\\Delta x)^2}\n$$\n在时间层 $n$，对于节点 $i=1$，此公式变为：\n$$\n\\left. \\frac{\\partial^{2}T}{\\partial x^{2}} \\right|_{x_1, t_n} \\approx \\frac{T(0, t_n) - 2T(\\Delta x, t_n) + T(2\\Delta x, t_n)}{(\\Delta x)^2} = \\frac{T_{b} - 2T_{1}^{n} + T_{2}^{n}}{(\\Delta x)^2}\n$$\n该近似是二阶精确的。将其代入时间离散化的热方程：\n$$\n\\frac{T_{1}^{n+1} - T_{1}^{n}}{\\Delta t} = \\alpha \\left( \\frac{T_{b} - 2T_{1}^{n} + T_{2}^{n}}{(\\Delta x)^2} \\right)\n$$\n求解 $T_{1}^{n+1}$：\n$$\nT_{1}^{n+1} = T_{1}^{n} + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{b} - 2T_{1}^{n} + T_{2}^{n})\n$$\n代入傅里叶数 $\\mathrm{Fo}$：\n$$\nT_{1}^{n+1} = T_1^n + \\mathrm{Fo} (T_{b} - 2T_{1}^{n} + T_{2}^{n})\n$$\n按时间层 $n$ 的温度值对各项进行分组：\n$$\nT_{1}^{n+1} = (1 - 2\\mathrm{Fo})T_{1}^{n} + \\mathrm{Fo}\\,T_{2}^{n} + \\mathrm{Fo}\\,T_{b}\n$$\n这就是边界节点 $i=1$ 的修正后显式更新公式。\n我们必须验证它是否满足在 $\\mathrm{Fo} \\le \\frac{1}{2}$ 条件下保持系数非负的要求。系数如下：\n- $T_{1}^{n}$ 的系数：$(1 - 2\\mathrm{Fo})$\n- $T_{2}^{n}$ 的系数：$\\mathrm{Fo}$\n- $T_{b}$ 的系数：$\\mathrm{Fo}$\n\n由于 $\\mathrm{Fo} > 0$，$T_{2}^{n}$ 和 $T_{b}$ 的系数总是正的。当 $1 - 2\\mathrm{Fo} \\ge 0$ 时，$T_{1}^{n}$ 的系数为非负，这在 $\\mathrm{Fo} \\le \\frac{1}{2}$ 时成立。因此，此修正格式满足了题目的要求，因为它在显式方法的标准稳定性条件下是保正的。该格式通常可通过对边界处的半控制体进行能量平衡来推导，或简单地将一个计算节点置于边界上得到，两种方法会产生相同的结果。最终的表达式即为推导出的 $T_{1}^{n+1}$ 更新法则。",
            "answer": "$$\n\\boxed{(1 - 2\\mathrm{Fo})T_{1}^{n} + \\mathrm{Fo}\\,T_{2}^{n} + \\mathrm{Fo}\\,T_{b}}\n$$"
        }
    ]
}