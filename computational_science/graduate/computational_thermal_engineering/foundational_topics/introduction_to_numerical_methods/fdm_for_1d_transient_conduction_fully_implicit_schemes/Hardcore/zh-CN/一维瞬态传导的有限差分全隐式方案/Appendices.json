{
    "hands_on_practices": [
        {
            "introduction": "应用任何数值方法的首要步骤，都是将控制偏微分方程及其边界条件转化为一组代数方程。本练习将引导您完成这一基本过程，针对一个具有指定温度（狄利克雷条件）的一维热传导问题。您将重点学习如何正确地将边界节点的影响整合到其相邻内部节点的方程中，从而构建出完整的线性系统。",
            "id": "3952708",
            "problem": "一根长度为 $L$ 的一维均匀杆，具有恒定的热物性（导热系数 $k$、质量密度 $\\rho$ 和比热 $c_p$），在没有内部热源的情况下进行瞬态热传导。控制方程是瞬态热传导方程，边界条件是在两端 $x=0$ 和 $x=L$ 处给定温度（狄利克雷类型）。您将使用均匀网格对区域进行离散化，并采用全隐式时间积分方案应用有限差分法（FDM）。\n\n从应用于通用内部节点 $i$ 周围控制体的能量守恒积分形式和傅里叶热传导定律出发，推导在时间层 $n+1$ 时，一个内部节点的代数方程，该方程依赖于节点 $i-1$、$i$ 和 $i+1$ 的温度。明确指出乘以空间离散项的无量纲数群。然后，利用在 $x=0$ 和 $x=L$ 处给定边界温度（狄利克雷边界条件）这一事实，说明如何修改第一个和最后一个内部节点的方程，以便将已知的边界温度正确地并入线性系统 $\\mathbf{A}\\mathbf{T}^{n+1}=\\mathbf{b}$。\n\n最后，对于具有以下参数的特定情况：\n- 杆长 $L=0.1\\,\\mathrm{m}$，\n- 均匀区间数 $N=5$（因此在节点 $i=1,2,3,4$ 处有 $N-1=4$ 个内部未知数），\n- 时间步长 $\\Delta t=20\\,\\mathrm{s}$，\n- 热扩散系数 $\\alpha=k/(\\rho c_p)=1.0\\times 10^{-5}\\,\\mathrm{m^2/s}$，\n- 时间层 $n$ 的内部节点温度：$T_1^n=310\\,\\mathrm{K}$，$T_2^n=300\\,\\mathrm{K}$，$T_3^n=295\\,\\mathrm{K}$，$T_4^n=290\\,\\mathrm{K}$，\n- 狄利克雷边界值 $T(0,t)=T_L=400\\,\\mathrm{K}$ 和 $T(L,t)=T_R=280\\,\\mathrm{K}$，\n\n明确写出关于未知向量 $\\mathbf{T}^{n+1}=\\big[T_1^{n+1},T_2^{n+1},T_3^{n+1},T_4^{n+1}\\big]^{\\top}$ 的第一个和最后一个方程，并按以下顺序报告其系数和右侧项的串联行向量：\n$$\\big[a_{11}\\ a_{12}\\ a_{13}\\ a_{14}\\ b_1\\ a_{41}\\ a_{42}\\ a_{43}\\ a_{44}\\ b_4\\big],$$\n其中 $a_{jk}$ 表示方程 $j$ 中乘以 $T_k^{n+1}$ 的系数，$b_j$ 是相应的右侧项。将您的答案四舍五入到四位有效数字，并以无单位的形式表示行向量的条目。",
            "solution": "**第 1 部分：内部节点全隐式代数方程的推导**\n\n我们从长度为 $\\Delta x$、单位横截面积、以节点 $i$ 为中心的一维控制体的能量守恒积分形式开始。该原理指出，控制体内储存能量的变化率等于净传入的热传导速率。\n$$\n\\frac{dE_{st}}{dt} = \\dot{E}_{in} - \\dot{E}_{out}\n$$\n对于从 $x_{i-1/2}$ 延伸到 $x_{i+1/2}$ 的控制体，储存的能量为 $E_{st} = (\\rho c_p \\Delta x) T_i$。因此，变化率为 $\\rho c_p \\Delta x \\frac{dT_i}{dt}$。传热速率由控制体表面上的热通量 $q$ 给出：$\\dot{E}_{in} = q_{x, i-1/2}$ 和 $\\dot{E}_{out} = q_{x, i+1/2}$。能量平衡变为：\n$$\n\\rho c_p \\Delta x \\frac{dT_i}{dt} = q_{x, i-1/2} - q_{x, i+1/2}\n$$\n使用傅里叶热传导定律 $q = -k \\frac{\\partial T}{\\partial x}$，我们使用中心差分来近似热通量：\n$$\nq_{x, i-1/2} \\approx -k \\frac{T_i - T_{i-1}}{\\Delta x} \\quad \\text{和} \\quad q_{x, i+1/2} \\approx -k \\frac{T_{i+1} - T_i}{\\Delta x}\n$$\n将这些代入能量平衡方程得到：\n$$\n\\rho c_p \\Delta x \\frac{dT_i}{dt} \\approx -k \\frac{T_i - T_{i-1}}{\\Delta x} - \\left(-k \\frac{T_{i+1} - T_i}{\\Delta x}\\right) = \\frac{k}{\\Delta x} (T_{i-1} - 2T_i + T_{i+1})\n$$\n现在，我们在时间上进行离散化。时间导数使用时间层 $n$ 和 $n+1$ 之间的一阶差分来近似：\n$$\n\\frac{dT_i}{dt} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n对于**全隐式**方案，空间导数（能量平衡方程的右侧）在未来的时间层 $n+1$ 处进行评估：\n$$\n\\rho c_p \\Delta x \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{k}{(\\Delta x)^2} (T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1})\n$$\n两边除以 $\\rho c_p$ 并引入热扩散系数 $\\alpha = k/(\\rho c_p)$：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{\\alpha}{(\\Delta x)^2} (T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1})\n$$\n乘以空间离散项的无量纲数群是**网格傅里叶数**，定义为 $Fo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。代入此定义，我们得到：\n$$\nT_i^{n+1} - T_i^n = Fo (T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1})\n$$\n重新整理此方程，将时间 $n+1$ 的所有未知温度分组到左侧，将时间 $n$ 的已知温度分组到右侧，得到内部节点 $i$ 的最终代数方程：\n$$\n-Fo \\cdot T_{i-1}^{n+1} + (1 + 2Fo) \\cdot T_i^{n+1} - Fo \\cdot T_{i+1}^{n+1} = T_i^n\n$$\n\n**第 2 部分：针对狄利克雷边界条件的修改**\n\n问题指定了狄利克雷边界条件，即杆两端的温度是给定的：$T(0,t) = T_L$ 和 $T(L,t) = T_R$。在我们具有 $N$ 个区间的离散域中，有 $N+1$ 个节点，索引从 $i=0$ 到 $i=N$。边界节点是 $i=0$ 和 $i=N$，所以 $T_0^{n+1} = T_L$ 和 $T_N^{n+1} = T_R$。未知温度位于内部节点 $i=1, 2, \\ldots, N-1$。\n\n对于**第一个内部节点 ($i=1$)**：\n应用通用方程：\n$$\n-Fo \\cdot T_{0}^{n+1} + (1 + 2Fo) \\cdot T_1^{n+1} - Fo \\cdot T_2^{n+1} = T_1^n\n$$\n由于 $T_0^{n+1} = T_L$ 是一个已知值，我们将其所在的项移到方程的右侧：\n$$\n(1 + 2Fo) \\cdot T_1^{n+1} - Fo \\cdot T_2^{n+1} = T_1^n + Fo \\cdot T_L\n$$\n这是线性系统 $\\mathbf{A}\\mathbf{T}^{n+1}=\\mathbf{b}$ 的第一行。\n\n对于**最后一个内部节点 ($i=N-1$)**：\n应用通用方程：\n$$\n-Fo \\cdot T_{N-2}^{n+1} + (1 + 2Fo) \\cdot T_{N-1}^{n+1} - Fo \\cdot T_{N}^{n+1} = T_{N-1}^n\n$$\n由于 $T_N^{n+1} = T_R$ 是一个已知值，我们将其所在的项移到右侧：\n$$\n-Fo \\cdot T_{N-2}^{n+1} + (1 + 2Fo) \\cdot T_{N-1}^{n+1} = T_{N-1}^n + Fo \\cdot T_R\n$$\n这是线性系统的最后一行。\n\n**第 3 部分：数值计算**\n\n给定的参数是：\n- $L = 0.1\\,\\mathrm{m}$\n- $N = 5$ 个区间，这意味着有 $N-1=4$ 个内部节点 ($i=1, 2, 3, 4$) 和 $N+1=6$ 个总节点 ($i=0, \\ldots, 5$)。\n- $\\Delta t = 20\\,\\mathrm{s}$\n- $\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n- $T_1^n = 310\\,\\mathrm{K}$，$T_2^n = 300\\,\\mathrm{K}$，$T_3^n = 295\\,\\mathrm{K}$，$T_4^n = 290\\,\\mathrm{K}$\n- 边界温度：$T_L = T_0^{n+1} = 400\\,\\mathrm{K}$ 和 $T_R = T_5^{n+1} = 280\\,\\mathrm{K}$\n\n首先，我们计算网格间距 $\\Delta x$：\n$$\n\\Delta x = \\frac{L}{N} = \\frac{0.1\\,\\mathrm{m}}{5} = 0.02\\,\\mathrm{m}\n$$\n接下来，我们计算网格傅里叶数 $Fo$：\n$$\nFo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} = \\frac{(1.0 \\times 10^{-5}\\,\\mathrm{m^2/s})(20\\,\\mathrm{s})}{(0.02\\,\\mathrm{m})^2} = \\frac{2.0 \\times 10^{-4}\\,\\mathrm{m^2}}{4.0 \\times 10^{-4}\\,\\mathrm{m^2}} = 0.5\n$$\n线性系统涉及未知向量 $\\mathbf{T}^{n+1}=\\big[T_1^{n+1}, T_2^{n+1}, T_3^{n+1}, T_4^{n+1}\\big]^{\\top}$。\n\n**第一个内部节点 ($i=1$) 的方程**：\n这对应于系统的第一行 ($j=1$)。\n$$\n(1 + 2Fo) T_1^{n+1} - Fo T_2^{n+1} = T_1^n + Fo T_L\n$$\n代入数值：\n$$\n(1 + 2(0.5)) T_1^{n+1} - 0.5 T_2^{n+1} = 310 + (0.5)(400)\n$$\n$$\n2.0 T_1^{n+1} - 0.5 T_2^{n+1} = 310 + 200 = 510\n$$\n包含 $\\mathbf{T}^{n+1}$ 中所有未知数的完整方程是：\n$$\n2.0 T_1^{n+1} - 0.5 T_2^{n+1} + 0 T_3^{n+1} + 0 T_4^{n+1} = 510\n$$\n第一个方程的系数和右侧项是：\n$a_{11} = 2.0$，$a_{12} = -0.5$，$a_{13} = 0$，$a_{14} = 0$，$b_1 = 510$。\n\n**最后一个内部节点 ($i=4$) 的方程**：\n这对应于系统的第四行 ($j=4$)。内部节点是 $1, 2, 3, 4$，所以最后一个是 $i=4$，因为 $N=5$，这对应于 $i=N-1$。\n$$\n-Fo T_{3}^{n+1} + (1 + 2Fo) T_{4}^{n+1} = T_4^n + Fo T_R\n$$\n代入数值：\n$$\n-0.5 T_3^{n+1} + (1 + 2(0.5)) T_4^{n+1} = 290 + (0.5)(280)\n$$\n$$\n-0.5 T_3^{n+1} + 2.0 T_4^{n+1} = 290 + 140 = 430\n$$\n完整的方程是：\n$$\n0 T_1^{n+1} + 0 T_2^{n+1} - 0.5 T_3^{n+1} + 2.0 T_4^{n+1} = 430\n$$\n第四个方程的系数和右侧项是：\n$a_{41} = 0$，$a_{42} = 0$，$a_{43} = -0.5$，$a_{44} = 2.0$，$b_4 = 430$。\n\n**最终结果组合：**\n我们需要报告串联的行向量 $\\big[a_{11}\\ a_{12}\\ a_{13}\\ a_{14}\\ b_1\\ a_{41}\\ a_{42}\\ a_{43}\\ a_{44}\\ b_4\\big]$。将每个值四舍五入到四位有效数字：\n- $a_{11} = 2.0 \\rightarrow 2.000$\n- $a_{12} = -0.5 \\rightarrow -0.5000$\n- $a_{13} = 0 \\rightarrow 0.000$\n- $a_{14} = 0 \\rightarrow 0.000$\n- $b_1 = 510 \\rightarrow 510.0$\n- $a_{41} = 0 \\rightarrow 0.000$\n- $a_{42} = 0 \\rightarrow 0.000$\n- $a_{43} = -0.5 \\rightarrow -0.5000$\n- $a_{44} = 2.0 \\rightarrow 2.000$\n- $b_4 = 430 \\rightarrow 430.0$\n\n最终的数值向量是：\n$\\begin{pmatrix} 2.000  -0.5000  0.000  0.000  510.0  0.000  0.000  -0.5000  2.000  430.0 \\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.000  -0.5000  0.000  0.000  510.0  0.000  0.000  -0.5000  2.000  430.0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了狄利克雷边界条件的处理方法后，我们进一步探讨不同类型的边界条件所带来的影响，特别是绝热边界（均匀诺伊曼条件）。这个场景揭示了离散系统更深层次的数学特性。通过分析，您将理解为何稳态算子是奇异的，以及瞬态项中的单位矩阵如何保证每个时间步解的唯一性，并探索离散格式如何保持物理上的能量守恒定律。",
            "id": "3952712",
            "problem": "考虑一根长度为 $L$、热扩散系数 $\\alpha$ 为常数的均匀杆中的一维瞬态热传导，该过程由能量守恒和 Fourier 定律支配，在一维空间上导出偏微分方程 $\\partial T/\\partial t = \\alpha \\, \\partial^{2} T/\\partial x^{2}$，并在 $x=0$ 和 $x=L$ 处服从齐次 Neumann（零热通量）边界条件。使用包含 $N$ 个节点、间距为 $\\Delta x = L/(N-1)$ 的均匀网格对空间域进行离散化，并采用有限差分法 (FDM)，在内部使用二阶中心差分，并通过一致地消除虚拟节点来施加端点上的齐次 Neumann 边界条件。记 $K \\in \\mathbb{R}^{N \\times N}$ 为对称矩阵，它表示在这些齐次 Neumann 边界条件下与 $-\\,\\partial^{2}/\\partial x^{2}$ 对应的离散算子。考虑带有离散源向量 $b \\in \\mathbb{R}^{N}$ 的稳态问题，以及时间步长 $\\Delta t > 0$ 的瞬态问题的全隐式（后向 Euler）时间离散。\n\n下列哪个陈述是正确的？\n\n- A. 对于无源的稳态纯 Neumann 问题，离散刚度矩阵 $K$ 的秩为 $N-1$，其一维零空间由常数向量张成，且稳态解在相差一个加性常数的意义下是唯一的。\n\n- B. 对于带有任意非零离散源 $b$ 的稳态纯 Neumann 问题，总存在唯一的离散解，而无需对 $b$ 施加任何附加条件。\n\n- C. 在全隐式格式中，每个时间步的线性系统矩阵可以写成 $I + \\alpha \\,\\Delta t \\, K$ 的形式，并且对于任何 $\\Delta t>0$，即使在纯 Neumann 边界条件下，该矩阵也是非奇异的。\n\n- D. 隐式步长矩阵 $I + \\alpha \\,\\Delta t \\, K$ 的条件数当 $\\Delta t \\to \\infty$ 时保持有界，因为零空间被 Neumann 边界条件移除了。\n\n- E. 在齐次 Neumann 边界条件且无内部源的情况下，离散温度的空间平均值（在均匀网格上 $N$ 个节点的算术平均值）在全隐式时间步进中是守恒的。\n\n选择所有适用项。",
            "solution": "## 推导\n\n该问题围绕矩阵 $K$ 的性质以及由此产生的数值格式展开。问题明确指出，$K$ 是在齐次 Neumann 边界条件下算子 $-\\frac{\\partial^2}{\\partial x^2}$ 的对称矩阵。对于一个有 $N$ 个节点的网格，该矩阵由下式给出：\n$$\nK = \\frac{1}{(\\Delta x)^2}\n\\begin{pmatrix}\n1  -1  0  \\dots  0  0 \\\\\n-1  2  -1  \\dots  0  0 \\\\\n0  -1  2  \\dots  0  0 \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  \\vdots  \\vdots \\\\\n0  0  0  \\dots  2  -1 \\\\\n0  0  0  \\dots  -1  1\n\\end{pmatrix}\n$$\n该矩阵有几个关键性质：\n1.  **对称性：** $K = K^T$。这是给定的，并且通过观察可知是正确的。\n2.  **半正定性：** 对于任意向量 $\\mathbf{v} \\in \\mathbb{R}^N$，二次型为 $\\mathbf{v}^T K \\mathbf{v} = \\frac{1}{(\\Delta x)^2} \\sum_{i=1}^{N-1} (v_i - v_{i+1})^2 \\ge 0$。因此，$K$ 是半正定的，其所有特征值 $\\lambda_k$ 都是实数且非负。\n3.  **零空间：** 二次型 $\\mathbf{v}^T K \\mathbf{v} = 0$ 当且仅当对于所有 $i=1, \\dots, N-1$ 都有 $v_i - v_{i+1} = 0$。这意味着 $v_1 = v_2 = \\dots = v_N$。因此，$K$ 的零空间是所有常数向量的集合，由向量 $\\mathbf{1} = [1, 1, \\dots, 1]^T$ 张成。\n4.  **秩：** 由于 $K$ 是一个 $N \\times N$ 矩阵，其零空间的维数为 1，根据秩-零度定理，$K$ 的秩为 $N-1$。\n5.  **行/列和：** 每行元素的和为 0。例如，对于第 $i$ 行（对于 $1 < i < N$ 的行），和为 $-1+2-1=0$。对于第 1 行，和为 $1-1=0$。由于 $K$ 是对称的，每列元素的和也为 0。行和为零的性质等价于陈述 $K\\mathbf{1} = \\mathbf{0}$。列和为零的性质等价于 $\\mathbf{1}^T K = \\mathbf{0}^T$。\n\n在确定了这些性质后，我们可以分析每个陈述。\n\n### 逐项分析\n\n**A. 对于无源的稳态纯 Neumann 问题，离散刚度矩阵 $K$ 的秩为 $N-1$，其一维零空间由常数向量张成，且稳态解在相差一个加性常数的意义下是唯一的。**\n\n无源的稳态问题是 $K\\mathbf{T} = \\mathbf{0}$。这个齐次系统的解是 $K$ 的零空间中的向量。\n- 如上所述，$K$ 的零空间是一维的，由常数向量 $\\mathbf{1}$ 张成。\n- 根据秩-零度定理，$K$ 的秩是 $N - \\dim(\\text{nullspace}(K)) = N-1$。\n- 解集是 $\\{\\mathbf{T} | \\mathbf{T} = c\\mathbf{1} \\text{ 对于某个常数 } c \\in \\mathbb{R}\\}$。这意味着任何常数温度分布都是一个解。\n- “在相差一个加性常数的意义下是唯一的”这一短语意味着如果 $\\mathbf{T}_{\\text{sol}}$ 是一个解，那么对于任意标量常数 $C$，$\\mathbf{T}_{\\text{sol}} + C\\mathbf{1}$ 也是一个解。我们来验证一下：如果 $\\mathbf{T}_{\\text{sol}} = c_1\\mathbf{1}$ 是一个解，那么 $\\mathbf{T}_{\\text{sol}} + C\\mathbf{1} = c_1\\mathbf{1} + C\\mathbf{1} = (c_1+C)\\mathbf{1}$。这是零空间中的另一个向量，所以它也是一个解。这个措辞是恰当的。\n这个陈述准确地描述了稳态、无源的 Neumann 问题的性质。\n\n**结论：正确**\n\n**B. 对于带有任意非零离散源 $b$ 的稳态纯 Neumann 问题，总存在唯一的离散解，而无需对 $b$ 施加任何附加条件。**\n\n问题是求解线性系统 $K\\mathbf{T} = \\mathbf{b}$。\n- 根据 Fredholm 择一定理，该系统有解当且仅当源向量 $\\mathbf{b}$ 与伴随算子 $K^T$ 的零空间正交。由于 $K$ 是对称的，我们要求 $\\mathbf{b}$ 与 $K$ 的零空间正交。\n- $K$ 的零空间由 $\\mathbf{1}$ 张成。正交性条件是 $\\mathbf{1}^T \\mathbf{b} = 0$，即 $\\sum_{i=1}^N b_i = 0$。\n- 该陈述声称对于*任意*非零源 $\\mathbf{b}$ 都存在解。这是错误的，因为只有当 $\\mathbf{b}$ 满足条件 $\\sum b_i = 0$ 时才存在解。这个条件代表了孤立系统在稳态下的全局能量守恒的物理约束。\n- 此外，如果存在一个解 $\\mathbf{T}_p$，通解是 $\\mathbf{T} = \\mathbf{T}_p + c\\mathbf{1}$，其中 $c\\mathbf{1}$ 是零空间中的任意向量。因此解不是唯一的；它仅在相差一个加性常数的意义下是唯一的。\n- 该陈述在两个方面是错误的：如其所述，存在性和唯一性都无法保证。\n\n**结论：不正确**\n\n**C. 在全隐式格式中，每个时间步的线性系统矩阵可以写成 $I + \\alpha \\,\\Delta t \\, K$ 的形式，并且对于任何 $\\Delta t>0$，即使在纯 Neumann 边界条件下，该矩阵也是非奇异的。**\n\n空间离散化后的一维瞬态热方程为 $\\frac{d\\mathbf{T}}{dt} = -\\alpha K \\mathbf{T}$。\n- 全隐式（后向 Euler）方法将时间导数离散化为 $\\frac{\\mathbf{T}^{p+1} - \\mathbf{T}^p}{\\Delta t}$，并在未来的时间步 $p+1$ 处计算右侧项：\n$$ \\frac{\\mathbf{T}^{p+1} - \\mathbf{T}^p}{\\Delta t} = -\\alpha K \\mathbf{T}^{p+1} $$\n- 重新整理此方程以求解 $\\mathbf{T}^{p+1}$：\n$$ \\mathbf{T}^{p+1} + \\alpha \\Delta t K \\mathbf{T}^{p+1} = \\mathbf{T}^p \\implies (I + \\alpha \\Delta t K) \\mathbf{T}^{p+1} = \\mathbf{T}^p $$\n- 线性系统矩阵为 $M = I + \\alpha \\Delta t K$。为了检查它是否非奇异，我们考察它的特征值。设 $\\lambda_k$ 是 $K$ 的特征值。$M$ 的特征值是 $\\mu_k = 1 + \\alpha \\Delta t \\lambda_k$。\n- 我们已经确定 $K$ 是对称半正定的，所以它的特征值 $\\lambda_k$ 是实数且非负（$\\lambda_k \\ge 0$）。其中一个特征值是 $\\lambda_1 = 0$，所有其他特征值都是严格为正的。\n- 因此，$M$ 的特征值为：\n  $\\mu_1 = 1 + \\alpha \\Delta t \\lambda_1 = 1 + 0 = 1$。\n  对于 $k > 1$，有 $\\lambda_k > 0$，并且由于 $\\alpha > 0$ 和 $\\Delta t > 0$，有 $\\mu_k = 1 + \\alpha \\Delta t \\lambda_k > 1$。\n- 矩阵 $M$ 的所有特征值 $\\mu_k$ 都大于或等于 1。没有一个为零。一个矩阵是非奇异的当且仅当它没有零特征值。因此，对于任何 $\\Delta t > 0$，$M$ 都是非奇异的。\n\n**结论：正确**\n\n**D. 隐式步长矩阵 $I + \\alpha \\,\\Delta t \\, K$ 的条件数当 $\\Delta t \\to \\infty$ 时保持有界，因为零空间被 Neumann 边界条件移除了。**\n\n矩阵是 $M = I + \\alpha \\Delta t K$。由于 $K$ 是对称的，$M$ 也是对称的。谱条件数（使用 2-范数）是最大特征值与最小特征值大小之比：$\\text{cond}_2(M) = |\\mu_{\\max}| / |\\mu_{\\min}|$。\n- $M$ 的特征值是 $\\mu_k = 1 + \\alpha \\Delta t \\lambda_k$。所有特征值都是正的。\n- 最小特征值是 $\\mu_{\\min} = 1 + \\alpha \\Delta t \\lambda_{\\min} = 1 + \\alpha \\Delta t (0) = 1$。\n- 最大特征值是 $\\mu_{\\max} = 1 + \\alpha \\Delta t \\lambda_{\\max}$，其中 $\\lambda_{\\max}$ 是 $K$ 的最大特征值。由于网格是有限的，$\\lambda_{\\max}$ 是一个有限的正数。（具体来说，$\\lambda_{\\max} \\approx 4/(\\Delta x)^2$）。\n- 条件数是 $\\text{cond}_2(M) = \\frac{1 + \\alpha \\Delta t \\lambda_{\\max}}{1} = 1 + \\alpha \\Delta t \\lambda_{\\max}$。\n- 当 $\\Delta t \\to \\infty$ 时，项 $\\alpha \\Delta t \\lambda_{\\max}$ 无界增长。因此，$\\lim_{\\Delta t \\to \\infty} \\text{cond}_2(M) = \\infty$。\n- 当 $\\Delta t \\to \\infty$ 时，条件数是无界的。系统变得越来越病态。陈述中给出的理由也是错误的；$K$ 的零空间是纯 Neumann 边界条件的*结果*，而不是被它们移除。\n\n**结论：不正确**\n\n**E. 在齐次 Neumann 边界条件且无内部源的情况下，离散温度的空间平均值（在均匀网格上 $N$ 个节点的算术平均值）在全隐式时间步进中是守恒的。**\n\n在时间步 $p$ 的空间平均温度是 $\\bar{T}^p = \\frac{1}{N} \\sum_{i=1}^N T^p_i$。用向量表示法，这是 $\\bar{T}^p = \\frac{1}{N} \\mathbf{1}^T \\mathbf{T}^p$。我们需要验证是否 $\\bar{T}^{p+1} = \\bar{T}^p$，这等价于证明 $\\mathbf{1}^T \\mathbf{T}^{p+1} = \\mathbf{1}^T \\mathbf{T}^p$。\n- 时间步进方程是 $(I + \\alpha \\Delta t K) \\mathbf{T}^{p+1} = \\mathbf{T}^p$。\n- 用行向量 $\\mathbf{1}^T$ 左乘两边：\n$$ \\mathbf{1}^T (I + \\alpha \\Delta t K) \\mathbf{T}^{p+1} = \\mathbf{1}^T \\mathbf{T}^p $$\n$$ (\\mathbf{1}^T I + \\alpha \\Delta t \\mathbf{1}^T K) \\mathbf{T}^{p+1} = \\mathbf{1}^T \\mathbf{T}^p $$\n- 如前文所述，对于行和为零的对称矩阵 $K$，我们有 $K\\mathbf{1}=\\mathbf{0}$。由于 $K$ 是对称的，这也意味着 $\\mathbf{1}^T K = (K\\mathbf{1})^T = \\mathbf{0}^T$。\n- 将 $\\mathbf{1}^T K = \\mathbf{0}^T$ 代入方程中：\n$$ (\\mathbf{1}^T + \\alpha \\Delta t \\mathbf{0}^T) \\mathbf{T}^{p+1} = \\mathbf{1}^T \\mathbf{T}^p $$\n$$ \\mathbf{1}^T \\mathbf{T}^{p+1} = \\mathbf{1}^T \\mathbf{T}^p $$\n- 这证实了在每个时间步中温度的总和是守恒的。因此，它们的算术平均值也是守恒的。这是孤立系统中总热能守恒的离散模拟。\n\n**结论：正确**",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "本综合练习旨在连接理论与实践，要求您将全隐式格式编写为可执行的代码。通过将数值结果与一个单模态问题的已知解析解进行对比，您将执行一个关键的验证步骤。此外，您还将量化后向欧拉格式固有的数值阻尼，从而深入了解其作为一种耗散格式的精度特性。",
            "id": "3952709",
            "problem": "考虑一个有限长杆上的一维瞬态热传导初边值问题，其边界条件为齐次狄利克雷边界条件。设温度场为 $T(x,t)$，热扩散率为 $\\alpha$（单位为 $\\mathrm{m}^2/\\mathrm{s}$），杆长为 $L$（单位为 $\\mathrm{m}$）。控制方程和数据如下：\n- 控制方程：$\\dfrac{\\partial T}{\\partial t} = \\alpha \\dfrac{\\partial^2 T}{\\partial x^2}$，对于 $0  x  L$，$t > 0$。\n- 边界条件：$T(0,t) = 0$ 且 $T(L,t) = 0$，对于所有 $t \\ge 0$。\n- 初始条件（单模）：$T(x,0) = T_{\\mathrm{ref}} \\sin\\!\\left(\\dfrac{m \\pi x}{L}\\right)$，其中 $m$ 是一个正整数模态指数，$T_{\\mathrm{ref}}$ 是参考温度幅值。使用 $T_{\\mathrm{ref}} = 1$ K，因此温度单位为开尔文。\n\n使用有限差分法（FDM），在具有 $N$ 个内部节点的均匀网格上，采用全隐式（后向欧拉）时间积分和二阶中心差分进行空间离散：\n- 定义空间步长 $\\Delta x = \\dfrac{L}{N+1}$ 和网格点 $x_i = i \\Delta x$，其中 $i=1,2,\\dots,N$。\n- 将时间步长记为 $\\Delta t$（单位为 $\\mathrm{s}$）。\n- 在从 $t=0$ 到 $t=\\Delta t$ 的单个时间步长内，使用标准的二阶差分离散空间算子，并使用后向欧拉法离散时间。利用能量守恒基本定律和傅里叶定律来推导热方程，然后从第一性原理进行离散（本问题陈述中不应假设使用任何快捷公式）。\n\n任务：\n1. 从控制方程和指定的离散化选择出发，建立求解在时间 $t=\\Delta t$ 时的全隐式解向量 $T^{1}$（从初始节点向量 $T^{0}$ 得到）所必须的线性系统。\n2. 对于给定的单模初始条件，使用精确的变量分离解，写出在 $t=\\Delta t$ 时的精确温度作为 $x$ 的函数；然后，在网格点 $x_i$ 上对其进行求值，以获得参考的精确节点向量 $T^{\\mathrm{exact}}$。\n3. 对于单个时间步长，通过在网格节点上计算以下两个指标，来量化后向欧拉法引入的数值阻尼：\n   - 放大比 $G_{\\mathrm{num}} = \\dfrac{\\lVert T^{1} \\rVert_2}{\\lVert T^{0} \\rVert_2}$（无量纲），其中 $\\lVert \\cdot \\rVert_2$ 表示欧几里得范数；以及精确模态放大系数 $G_{\\mathrm{exact}} = \\exp\\!\\left(-\\alpha \\left(\\dfrac{m \\pi}{L}\\right)^2 \\Delta t\\right)$（无量纲）。定义相对阻尼因子 $R = \\dfrac{G_{\\mathrm{num}}}{G_{\\mathrm{exact}}}$（无量纲）。将 $R>1$ 解释为相对于一个时间步长内的精确解而言的欠阻尼，将 $R<1$ 解释为过阻尼。\n   - 无穷范数误差 $E_{\\infty} = \\max_i \\left| T^{1}_i - T^{\\mathrm{exact}}_i \\right|$（单位为开尔文）。\n4. 实现一个程序，对于下面的每个测试用例，计算上面定义的 $R$ 和 $E_{\\infty}$ 并输出它们。\n\n使用以下测试套件（每个元组为 $(L \\ \\mathrm{[m]}, \\ \\alpha \\ \\mathrm{[m}^2/\\mathrm{s}], \\ N, \\ \\Delta t \\ \\mathrm{[s]}, \\ m)$）：\n- 测试 1：$(L=\\;1.0,\\ \\alpha=\\;1.0\\times 10^{-4},\\ N=\\;20,\\ \\Delta t=\\;0.1,\\ m=\\;1)$。\n- 测试 2：$(L=\\;1.0,\\ \\alpha=\\;1.0\\times 10^{-4},\\ N=\\;20,\\ \\Delta t=\\;10.0,\\ m=\\;1)$。\n- 测试 3：$(L=\\;1.0,\\ \\alpha=\\;1.0\\times 10^{-4},\\ N=\\;10,\\ \\Delta t=\\;1.0,\\ m=\\;5)$。\n- 测试 4：$(L=\\;1.0,\\ \\alpha=\\;1.0\\times 10^{-4},\\ N=\\;8,\\ \\Delta t=\\;1.0,\\ m=\\;8)$。\n- 测试 5：$(L=\\;2.0,\\ \\alpha=\\;5.0\\times 10^{-5},\\ N=\\;40,\\ \\Delta t=\\;0.5,\\ m=\\;3)$。\n\n数值和输出要求：\n- 所有计算必须使用 $T_{\\mathrm{ref}} = 1$ K，因此 $T(x,0)$ 的单位是开尔文，$E_{\\infty}$ 以开尔文为单位报告。\n- 角度是无量纲的（正弦函数使用弧度作为参数）。\n- 程序的最终输出必须是单行，包含一个结果列表，每个测试用例对应一个结果，每个结果是一个双元素列表 $[R,E_{\\infty}]$，两个条目都四舍五入到八位小数。整个输出必须是 $[[R_1,E_{\\infty,1}],[R_2,E_{\\infty,2}],\\dots]$ 形式的单行，不含任何额外文本。",
            "solution": "我们根据问题陈述中概述的任务，逐步进行推导和求解。\n\n### 步骤 1：全隐式有限差分格式的推导\n\n一维瞬态热传导的偏微分控制方程（PDE）如下：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} \\quad \\text{for } 0  x  L, \\ t > 0\n$$\n其中 $T(x,t)$ 是温度场，$\\alpha$ 是热扩散率，$x$ 是空间坐标，$t$ 是时间。该方程源于将能量守恒原理应用于无穷小控制体，并结合傅里叶热传导定律 $q = -k A \\frac{\\partial T}{\\partial x}$，其中 $\\alpha = k/(\\rho c_p)$。\n\n我们使用具有 $N$ 个内部节点的均匀网格对空间域 $[0, L]$ 进行离散。空间步长为 $\\Delta x = \\frac{L}{N+1}$，网格点为 $x_i = i \\Delta x$，其中 $i=0, 1, \\dots, N+1$。这些节点上的温度表示为 $T_i(t) = T(x_i, t)$。边界条件为 $T_0(t) = 0$ 和 $T_{N+1}(t) = 0$。\n\n我们使用时间步长 $\\Delta t$ 对时间进行离散，将在时间 $t_n = n \\Delta t$ 的温度表示为 $T_i^n = T(x_i, t_n)$。\n\n问题要求采用全隐式格式，这意味着空间导数在未来的时间层 $n+1$ 进行计算。时间导数使用一阶后向欧拉法进行近似，空间二阶导数使用二阶中心差分公式进行近似。在内部节点 $i$ 和时间层 $n+1$，离散化的 PDE 为：\n\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\n\n我们的任务是求解时间 $t=\\Delta t$（即 $n=0$）时的温度向量 $T^1$。方程变为：\n\n$$\n\\frac{T_i^{1} - T_i^0}{\\Delta t} = \\alpha \\frac{T_{i-1}^{1} - 2T_i^{1} + T_{i+1}^{1}}{(\\Delta x)^2}\n$$\n\n为了构成一个线性系统，我们重新整理各项，将所有未知数（在时间层 $1$）移到左侧，将所有已知数（在时间层 $0$）移到右侧。\n\n$$\nT_i^{1} - T_i^0 = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{i-1}^{1} - 2T_i^{1} + T_{i+1}^{1})\n$$\n\n我们定义无量纲的傅里叶数 $F_o = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。方程简化为：\n\n$$\nT_i^{1} - T_i^0 = F_o (T_{i-1}^{1} - 2T_i^{1} + T_{i+1}^{1})\n$$\n\n$$\n-F_o T_{i-1}^{1} + (1 + 2F_o) T_i^{1} - F_o T_{i+1}^{1} = T_i^0\n$$\n\n该方程对所有内部节点 $i=1, 2, \\dots, N$ 均有效。我们必须引入边界条件 $T(0,t)=0$ 和 $T(L,t)=0$，在我们的离散表示法中即为 $T_0^1=0$ 和 $T_{N+1}^1=0$。\n\n对于节点 $i=1$：\n$$\n-F_o T_0^1 + (1 + 2F_o) T_1^1 - F_o T_2^1 = T_1^0 \\implies (1 + 2F_o) T_1^1 - F_o T_2^1 = T_1^0\n$$\n\n对于节点 $i=N$：\n$$\n-F_o T_{N-1}^1 + (1 + 2F_o) T_N^1 - F_o T_{N+1}^1 = T_N^0 \\implies -F_o T_{N-1}^1 + (1 + 2F_o) T_N^1 = T_N^0\n$$\n\n这组 $N$ 个线性方程可以写成矩阵形式 $A T^1 = T^0$，其中 $T^1 = [T_1^1, T_2^1, \\dots, T_N^1]^T$ 是未知温度向量，$T^0 = [T_1^0, T_2^0, \\dots, T_N^0]^T$ 是已知的初始温度向量。矩阵 $A$ 是一个 $N \\times N$ 的对称三对角矩阵：\n\n$$\nA = \\begin{pmatrix}\n1+2F_o  -F_o  0  \\dots  0 \\\\\n-F_o  1+2F_o  -F_o  \\dots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  0 \\\\\n0  \\dots  -F_o  1+2F_o  -F_o \\\\\n0  \\dots  0  -F_o  1+2F_o\n\\end{pmatrix}\n$$\n\n为了求得数值解 $T^1$，我们求解这个线性系统。\n\n### 步骤 2：精确解\n\n对于给定的初始条件和边界条件，该偏微分方程的解析解可以通过变量分离法得到。通解是一个傅里叶正弦级数。对于特定的单模初始条件 $T(x,0) = T_{\\mathrm{ref}} \\sin\\left(\\frac{m \\pi x}{L}\\right)$，解会显著简化，因为只有第 $m$ 个模态被激发。精确解为：\n$$\nT(x,t) = T_{\\mathrm{ref}} \\sin\\left(\\frac{m \\pi x}{L}\\right) \\exp\\left(-\\alpha \\left(\\frac{m \\pi}{L}\\right)^2 t\\right)\n$$\n根据问题陈述，我们设定 $T_{\\mathrm{ref}} = 1$ K。在时间 $t=\\Delta t$ 时，网格节点 $x_i$ 上的精确温度由向量 $T^{\\mathrm{exact}}$ 给出，其分量为：\n$$\nT_i^{\\mathrm{exact}} = T(x_i, \\Delta t) = \\sin\\left(\\frac{m \\pi x_i}{L}\\right) \\exp\\left(-\\alpha \\left(\\frac{m \\pi}{L}\\right)^2 \\Delta t\\right) \\quad \\text{for } i=1, \\dots, N\n$$\n\n### 步骤 3：指标计算\n\n现在我们定义为每个测试用例计算所需指标的步骤。\n首先，我们通过在网格点 $x_i$ 上计算 $T(x,0)$ 来建立初始节点温度向量 $T^0$：\n$$\nT_i^0 = T(x_i, 0) = \\sin\\left(\\frac{m \\pi x_i}{L}\\right) \\quad \\text{for } i=1, \\dots, N\n$$\n\n1.  **求解 $T^1$**：使用向量 $T^0$ 作为右端项，求解线性系统 $A T^1 = T^0$ 以获得数值解向量 $T^1$。\n\n2.  **计算 $G_{\\mathrm{num}}$**：计算数值解向量 $T^1$ 和初始向量 $T^0$ 的欧几里得范数（L2-范数）。\n    $$\n    G_{\\mathrm{num}} = \\frac{\\lVert T^1 \\rVert_2}{\\lVert T^0 \\rVert_2} = \\frac{\\sqrt{\\sum_{i=1}^N (T_i^1)^2}}{\\sqrt{\\sum_{i=1}^N (T_i^0)^2}}\n    $$\n\n3.  **计算 $G_{\\mathrm{exact}}$**：精确模态放大因子由解析解中的指数衰减项给出：\n    $$\n    G_{\\mathrm{exact}} = \\exp\\left(-\\alpha \\left(\\frac{m \\pi}{L}\\right)^2 \\Delta t\\right)\n    $$\n    注意，$T_i^{\\mathrm{exact}} = T_i^0 \\cdot G_{\\mathrm{exact}}$，这意味着 $\\lVert T^{\\mathrm{exact}} \\rVert_2 = G_{\\mathrm{exact}} \\lVert T^0 \\rVert_2$。\n\n4.  **计算 $R$**：相对阻尼因子是数值放大与精确放大之比：\n    $$\n    R = \\frac{G_{\\mathrm{num}}}{G_{\\mathrm{exact}}}\n    $$\n\n5.  **计算 $E_{\\infty}$**：无穷范数误差是数值解与精确解在网格节点上的最大绝对差值：\n    $$\n    E_{\\infty} = \\max_{i=1, \\dots, N} |T_i^1 - T_i^{\\mathrm{exact}}|\n    $$\n\n将对问题陈述中提供的每个测试用例实施此程序。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D transient heat conduction problem for multiple test cases\n    using a fully implicit finite difference method and evaluates numerical\n    damping and error metrics.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (L [m], alpha [m^2/s], N, dt [s], m).\n    test_cases = [\n        (1.0, 1.0e-4, 20, 0.1, 1),\n        (1.0, 1.0e-4, 20, 10.0, 1),\n        (1.0, 1.0e-4, 10, 1.0, 5),\n        (1.0, 1.0e-4, 8, 1.0, 8),\n        (2.0, 5.0e-5, 40, 0.5, 3),\n    ]\n\n    T_ref = 1.0 # Reference temperature amplitude in kelvin.\n    results = []\n    \n    for case in test_cases:\n        L, alpha, N, dt, m = case\n\n        # 1. Define grid and initial conditions\n        # Spatial step for N interior nodes\n        dx = L / (N + 1)\n        # Grid points for interior nodes x_1, ..., x_N\n        x_nodes = np.arange(1, N + 1) * dx\n\n        # Initial temperature vector T^0 at t=0\n        T0 = T_ref * np.sin(m * np.pi * x_nodes / L)\n\n        # 2. Set up and solve the linear system A * T^1 = T^0\n        # Calculate the dimensionless Fourier number\n        Fo = alpha * dt / (dx**2)\n\n        # Construct the tridiagonal matrix A in the banded format required by\n        # scipy.linalg.solve_banded. For a tridiagonal matrix, the banded\n        # matrix 'ab' has 3 rows: super-diagonal, main-diagonal, sub-diagonal.\n        ab = np.zeros((3, N))\n        ab[0, 1:] = -Fo          # Super-diagonal (1st row, shifted)\n        ab[1, :] = 1.0 + 2.0 * Fo # Main diagonal (2nd row)\n        ab[2, :-1] = -Fo         # Sub-diagonal (3rd row, shifted)\n\n        # Solve the linear system for T^1, the temperature vector at t=dt\n        T1 = solve_banded((1, 1), ab, T0)\n\n        # 3. Calculate the exact solution at t=dt\n        # The exact amplification factor for the single mode\n        G_exact = np.exp(-alpha * (m * np.pi / L)**2 * dt)\n        \n        # The exact solution vector is the initial vector scaled by G_exact\n        T_exact = T0 * G_exact\n\n        # 4. Compute the required metrics\n        # Euclidean (L2) norms of the initial and numerical solution vectors\n        norm_T0 = np.linalg.norm(T0, 2)\n        norm_T1 = np.linalg.norm(T1, 2)\n\n        # The numerical amplification ratio G_num\n        # Handle the case where norm_T0 is zero to avoid division by zero\n        if norm_T0 > 1e-15:\n            G_num = norm_T1 / norm_T0\n        else:\n            G_num = 0.0\n\n        # The relative damping factor R\n        R = G_num / G_exact\n\n        # The infinity-norm discrepancy E_inf\n        E_inf = np.linalg.norm(T1 - T_exact, np.inf)\n\n        # Append the computed metrics, rounded to 8 decimal places\n        results.append([round(R, 8), round(E_inf, 8)])\n\n    # 5. Format the final output string as specified\n    # Create a list of strings, e.g., [\"[1.23456789,0.98765432]\"]\n    result_strings = [f\"[{r[0]:.8f},{r[1]:.8f}]\" for r in results]\n    # Join them with commas and enclose in brackets\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}