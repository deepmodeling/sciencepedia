{
    "hands_on_practices": [
        {
            "introduction": "The first step in numerically solving a partial differential equation is to transform it into a system of algebraic equations, a process known as discretization. This exercise guides you through this fundamental procedure for the one-dimensional transient heat equation using the backward (implicit) Euler method. By starting from the physical principle of energy conservation, you will derive the discrete equations for each node and assemble them into the canonical matrix form $\\mathbf{A}\\mathbf{T}^{n+1} = \\mathbf{b}$, a critical skill for understanding and implementing robust numerical solvers .",
            "id": "3964336",
            "problem": "A one-dimensional, homogeneous rod of length $L$ with constant thermal diffusivity $\\alpha$ evolves thermally according to the partial differential equation (PDE) for transient heat conduction derived from conservation of energy and Fourier’s law: $T_{t}=\\alpha\\,T_{xx}$. Suppose the rod is subject to Dirichlet boundary conditions $T(0,t)=T_{L}$ and $T(L,t)=T_{R}$, where $T_{L}$ and $T_{R}$ are prescribed constants, and an initial condition $T(x,0)=T_{0}(x)$. Let the spatial domain be discretized by a uniform grid of $N+1$ nodes including the boundaries, with spacing $\\Delta x=L/N$, and let the temporal domain be advanced with a uniform time step $\\Delta t$ using the backward (implicit) Euler method.\n\nStarting from the fundamental statements of conservation of energy applied to a differential control volume and Fourier’s law of heat conduction, derive the backward Euler finite difference discretization of the PDE on the interior nodes. Assemble the resulting linear system at a generic time step $t^{n+1}$ in the matrix form $\\mathbf{A}\\,\\mathbf{T}^{n+1}=\\mathbf{b}$ for the interior unknown temperatures. Clearly identify how the Dirichlet boundary values enter the right-hand side. Denote the vector of interior temperatures at time level $t^{n}$ by $\\mathbf{T}^{n}\\in\\mathbb{R}^{M}$, where $M=N-1$ is the number of interior nodes.\n\nFinally, define the dimensionless ratio $r=\\alpha\\,\\Delta t/\\Delta x^{2}$ and provide a closed-form analytic expression for the entries $A_{ij}$ of the system matrix $\\mathbf{A}\\in\\mathbb{R}^{M\\times M}$ using the Kronecker delta $\\delta_{ij}$, where $\\delta_{ij}=1$ if $i=j$ and $\\delta_{ij}=0$ otherwise. Your final answer must be this single analytic expression for $A_{ij}$ in terms of $r$. No numerical evaluation is required, and no units are to be provided in the final answer.",
            "solution": "The posed problem is a standard exercise in the numerical solution of partial differential equations and is valid. We will proceed with the derivation as requested.\n\nThe governing partial differential equation (PDE) for one-dimensional transient heat conduction is given as:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nwhere $T(x,t)$ is the temperature, $\\alpha$ is the constant thermal diffusivity, $x$ is the spatial coordinate, and $t$ is time.\n\nThe problem asks for a discretization derived from the fundamental principles of energy conservation and Fourier's law. We consider the integral form of the energy conservation equation applied to a finite control volume (CV) centered at an interior node $x_i = i\\Delta x$. The CV spans from $x_{i-1/2} = x_i - \\frac{\\Delta x}{2}$ to $x_{i+1/2} = x_i + \\frac{\\Delta x}{2}$. For a homogeneous material with no internal heat generation, the rate of change of internal energy within the CV equals the net rate of heat conducted into it:\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\rho c_p A_{cs} T(x, t) \\, dx = q(x_{i-1/2}, t) - q(x_{i+1/2}, t)\n$$\nHere, $\\rho$ is the density, $c_p$ is the specific heat capacity, $A_{cs}$ is the constant cross-sectional area, and $q(x,t)$ is the heat flow rate. Approximating the integral with the value at the node $T_i(t) = T(x_i, t)$ multiplied by the volume $(\\Delta x A_{cs})$, we get:\n$$\n\\rho c_p A_{cs} \\Delta x \\frac{dT_i}{dt} \\approx q_{i-1/2} - q_{i+1/2}\n$$\nFourier's law of conduction states $q = -k A_{cs} \\frac{\\partial T}{\\partial x}$, where $k$ is the thermal conductivity. Substituting this into the energy balance:\n$$\n\\rho c_p A_{cs} \\Delta x \\frac{dT_i}{dt} \\approx \\left(-k A_{cs} \\frac{\\partial T}{\\partial x}\\right)\\bigg|_{i-1/2} - \\left(-k A_{cs} \\frac{\\partial T}{\\partial x}\\right)\\bigg|_{i+1/2}\n$$\nDividing by $\\rho c_p A_{cs} \\Delta x$ and recalling the definition of thermal diffusivity $\\alpha = k/(\\rho c_p)$:\n$$\n\\frac{dT_i}{dt} \\approx \\frac{\\alpha}{\\Delta x} \\left( \\frac{\\partial T}{\\partial x}\\bigg|_{i+1/2} - \\frac{\\partial T}{\\partial x}\\bigg|_{i-1/2} \\right)\n$$\nWe approximate the temperature gradients at the CV faces using central finite differences between adjacent nodes:\n$$\n\\frac{\\partial T}{\\partial x}\\bigg|_{i+1/2} \\approx \\frac{T_{i+1}(t) - T_i(t)}{\\Delta x} \\quad \\text{and} \\quad \\frac{\\partial T}{\\partial x}\\bigg|_{i-1/2} \\approx \\frac{T_i(t) - T_{i-1}(t)}{\\Delta x}\n$$\nSubstituting these approximations yields the semi-discretized system of ordinary differential equations (ODEs), known as the method of lines:\n$$\n\\frac{dT_i}{dt} = \\frac{\\alpha}{\\Delta x^2} \\left( T_{i-1}(t) - 2T_i(t) + T_{i+1}(t) \\right)\n$$\nNext, we discretize in time using the backward (implicit) Euler method. We approximate the time derivative at the future time level $t^{n+1} = (n+1)\\Delta t$, and crucially, we evaluate the spatial derivative term at the same future time level $t^{n+1}$:\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\frac{\\alpha}{(\\Delta x)^2} \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\nwhere $T_i^n$ denotes the temperature at node $i$ and time level $n$. Introducing the dimensionless ratio $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$:\n$$\nT_i^{n+1} - T_i^n = r \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\nTo form the linear system, we rearrange this equation by grouping all unknown terms (at time level $n+1$) on the left-hand side and all known terms (at time level $n$) on the right-hand side:\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\nThis equation holds for all interior nodes, $i=1, 2, ..., M$, where $M=N-1$. We now assemble the system $\\mathbf{A}\\,\\mathbf{T}^{n+1}=\\mathbf{b}$ by considering the boundary conditions $T(0,t)=T_L$ and $T(L,t)=T_R$, which in discrete form are $T_0^{n+1} = T_L$ and $T_N^{n+1} = T_R$.\n\nFor the first interior node, $i=1$:\n$$\n-r T_0^{n+1} + (1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n\n$$\nSubstituting $T_0^{n+1} = T_L$ and moving the known term to the right-hand side:\n$$\n(1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n + r T_L\n$$\nFor a general interior node, $i \\in \\{2, ..., M-1\\}$:\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\nFor the last interior node, $i=M=N-1$:\n$$\n-r T_{M-1}^{n+1} + (1 + 2r) T_M^{n+1} - r T_N^{n+1} = T_M^n\n$$\nSubstituting $T_N^{n+1} = T_R$ and moving the known term to the right-hand side:\n$$\n-r T_{M-1}^{n+1} + (1 + 2r) T_M^{n+1} = T_M^n + r T_R\n$$\nThe linear system $\\mathbf{A}\\,\\mathbf{T}^{n+1}=\\mathbf{b}$ is thus defined by:\nThe vector of unknowns $\\mathbf{T}^{n+1} = [T_1^{n+1}, T_2^{n+1}, \\dots, T_M^{n+1}]^T$.\nThe system matrix $\\mathbf{A} \\in \\mathbb{R}^{M\\times M}$ is a symmetric tridiagonal matrix:\n$$\n\\mathbf{A} = \\begin{pmatrix}\n1+2r & -r & 0 & \\cdots & 0 \\\\\n-r & 1+2r & -r & \\cdots & 0 \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n\\vdots & \\cdots & -r & 1+2r & -r \\\\\n0 & \\cdots & 0 & -r & 1+2r\n\\end{pmatrix}\n$$\nThe right-hand side vector $\\mathbf{b} \\in \\mathbb{R}^{M}$ is given by:\n$$\n\\mathbf{b} = \\begin{pmatrix} T_1^n + r T_L \\\\ T_2^n \\\\ \\vdots \\\\ T_{M-1}^n \\\\ T_M^n + r T_R \\end{pmatrix}\n$$\nThis clearly shows how the Dirichlet boundary values $T_L$ and $T_R$ enter the first and last elements of the vector $\\mathbf{b}$, scaled by the dimensionless parameter $r$.\n\nFinally, we provide a closed-form expression for the entries $A_{ij}$ of the matrix $\\mathbf{A}$ for $i,j \\in \\{1, 2, ..., M\\}$, using the Kronecker delta $\\delta_{ij}$. The matrix has entries $(1+2r)$ on the main diagonal ($i=j$) and $-r$ on the super-diagonal ($j=i+1$) and sub-diagonal ($j=i-1$). All other entries are zero. This structure can be compactly written as:\n$$\nA_{ij} = (1+2r)\\delta_{ij} - r\\delta_{i, j-1} - r\\delta_{i, j+1}\n$$\nThis single expression accurately represents every entry in the matrix $\\mathbf{A}$.",
            "answer": "$$\n\\boxed{(1+2r)\\delta_{ij} - r\\delta_{i,j-1} - r\\delta_{i,j+1}}\n$$"
        },
        {
            "introduction": "While implicit methods are unconditionally stable, explicit methods like Forward Euler are often simpler to code, but their stability is conditional. This practice moves from theoretical formulation to hands-on implementation, tackling a one-dimensional finite volume scheme for a more realistic scenario involving nonuniform grids and heterogeneous material properties. The core task is to derive the stability constraint from first principles, determining the maximum allowable time step $\\Delta t$ to prevent the simulation from becoming unstable, a crucial consideration in any practical application of explicit time integration .",
            "id": "3964328",
            "problem": "Consider one-dimensional transient heat conduction in a heterogeneous medium with piecewise-constant thermal properties. The governing equations arise from conservation of energy and Fourier’s law of heat conduction. Starting from the physical laws, the constitutive relation is Fourier’s law, $q_x = -k \\, \\partial T/\\partial x$, and conservation of energy in a control volume states that the rate of change of internal energy equals the net conductive heat flux into the control volume. Together these imply the transient heat equation $ \\rho c \\, \\partial T / \\partial t = \\partial / \\partial x \\left( k(x) \\, \\partial T / \\partial x \\right) $ where $T$ is temperature, $k$ is thermal conductivity, $\\rho$ is density, and $c$ is specific heat capacity.\n\nImplement a one-dimensional Finite Volume Method (FVM) explicit time-integration scheme (Forward Euler) for this equation on a nonuniform cell-centered mesh with $N$ control volumes of widths $\\Delta x_i$. Use harmonic-averaged face conductivity at interior faces derived from series addition of half-cell resistances. The face-to-face separation $\\delta_{i+1/2}$ is half the sum of adjacent cell widths. For boundary faces, impose either fixed-temperature (Dirichlet) boundaries or zero-flux (Neumann) boundaries; for Dirichlet boundaries, model the boundary face as a half-cell conduction path from the cell centroid to the boundary, and for Neumann boundaries, impose zero flux at the boundary face.\n\nYour task is to:\n\n- Derive and implement the explicit Forward Euler FVM update for $T_i^{n+1}$ using fluxes computed with harmonic-averaged face conductivity at interior faces and appropriate boundary-face treatment.\n- From the discrete operator, determine for each cell the locally most restrictive time step (the maximum allowable local time step for monotone stability and nonnegativity of the explicit update) and return the minimum of these local values as the global most restrictive time step. The required unit is seconds.\n\nStart from first principles (conservation of energy and Fourier’s law) and the definition of the FVM fluxes on a nonuniform mesh; do not use shortcut formulas without derivation.\n\nUse the following test suite. Each test case specifies the nonuniform mesh cell widths $\\Delta x_i$ in meters, thermal conductivities $k_i$ in watts per meter-kelvin, densities $\\rho_i$ in kilograms per cubic meter, specific heats $c_i$ in joules per kilogram-kelvin, and boundary types at the left and right ends. Assume unit cross-sectional area $A = 1\\,\\mathrm{m}^2$. The boundary types are given as either Dirichlet (fixed temperature, $T_b$, which is specified but does not affect the stability limit) or Neumann (zero flux). In all cases, express the final answer in seconds.\n\nTest suite:\n\n- Case $1$ (general nonuniform, Dirichlet on both ends):\n  - $\\Delta x = [\\,0.008,\\,0.012,\\,0.010,\\,0.015,\\,0.005\\,]$\n  - $k = [\\,15,\\,22,\\,18,\\,40,\\,10\\,]$\n  - $\\rho = [\\,7800,\\,7800,\\,7800,\\,7800,\\,7800\\,]$\n  - $c = [\\,500,\\,500,\\,500,\\,500,\\,500\\,]$\n  - Left boundary: Dirichlet with $T_b = 300\\,\\mathrm{K}$, Right boundary: Dirichlet with $T_b = 300\\,\\mathrm{K}$.\n\n- Case $2$ (includes a very small cell, Dirichlet on both ends):\n  - $\\Delta x = [\\,0.0005,\\,0.002,\\,0.0015,\\,0.0025,\\,0.002\\,]$\n  - $k = [\\,30,\\,30,\\,30,\\,30,\\,30\\,]$\n  - $\\rho = [\\,7900,\\,7900,\\,7900,\\,7900,\\,7900\\,]$\n  - $c = [\\,460,\\,460,\\,460,\\,460,\\,460\\,]$\n  - Left boundary: Dirichlet with $T_b = 350\\,\\mathrm{K}$, Right boundary: Dirichlet with $T_b = 350\\,\\mathrm{K}$.\n\n- Case $3$ (mixed boundary conditions, Neumann-Dirichlet):\n  - $\\Delta x = [\\,0.01,\\,0.02,\\,0.015,\\,0.025\\,]$\n  - $k = [\\,12,\\,20,\\,14,\\,16\\,]$\n  - $\\rho = [\\,8500,\\,8500,\\,8500,\\,8500\\,]$\n  - $c = [\\,500,\\,500,\\,500,\\,500\\,]$\n  - Left boundary: Neumann zero flux, Right boundary: Dirichlet with $T_b = 300\\,\\mathrm{K}$.\n\n- Case $4$ (strong conductivity contrast near a small cell, Dirichlet on both ends):\n  - $\\Delta x = [\\,0.006,\\,0.004,\\,0.007,\\,0.005\\,]$\n  - $k = [\\,20,\\,400,\\,15,\\,25\\,]$\n  - $\\rho = [\\,7800,\\,7800,\\,7800,\\,7800\\,]$\n  - $c = [\\,500,\\,500,\\,500,\\,500\\,]$\n  - Left boundary: Dirichlet with $T_b = 320\\,\\mathrm{K}$, Right boundary: Dirichlet with $T_b = 320\\,\\mathrm{K}$.\n\n- Case $5$ (variable $\\rho$ and $c$, Dirichlet on both ends):\n  - $\\Delta x = [\\,0.009,\\,0.011,\\,0.008\\,]$\n  - $k = [\\,18,\\,22,\\,19\\,]$\n  - $\\rho = [\\,3000,\\,8000,\\,6000\\,]$\n  - $c = [\\,800,\\,500,\\,700\\,]$\n  - Left boundary: Dirichlet with $T_b = 300\\,\\mathrm{K}$, Right boundary: Dirichlet with $T_b = 300\\,\\mathrm{K}$.\n\nYour program should produce a single line of output containing the global most restrictive time step for each test case, as a comma-separated list enclosed in square brackets, with each float rounded to $10$ significant digits, in seconds. For example, an output line has the form $[t_1,t_2,t_3,t_4,t_5]$ where each $t_i$ is a float representing seconds.",
            "solution": "The problem requires the derivation and implementation of a stability criterion for a one-dimensional Finite Volume Method (FVM) explicit scheme for transient heat conduction. The derivation must originate from first principles: conservation of energy and Fourier's law of heat conduction.\n\nThe governing partial differential equation for one-dimensional transient heat conduction in a medium with spatially varying properties is:\n$$\n\\rho(x) c(x) \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x} \\left( k(x) \\frac{\\partial T}{\\partial x} \\right)\n$$\nwhere $T$ is temperature, $t$ is time, $x$ is the spatial coordinate, $\\rho$ is density, $c$ is specific heat capacity, and $k$ is thermal conductivity.\n\nWe consider a cell-centered finite volume discretization with $N$ control volumes (CVs). For a generic control volume $CV_i$ centered at $x_i$ with width $\\Delta x_i$ and uniform properties $\\rho_i, c_i, k_i$, the integral form of the energy conservation law is:\n$$\n\\frac{d}{dt} \\int_{CV_i} \\rho_i c_i T \\, dV = Q_{i-1/2} - Q_{i+1/2}\n$$\nwhere $dV = A \\, dx$ with cross-sectional area $A=1 \\, \\text{m}^2$. $Q_{i-1/2}$ and $Q_{i+1/2}$ are the rates of heat transfer into $CV_i$ through its left and right faces, respectively. Assuming the temperature $T_i$ represents the average temperature over the cell, the equation becomes:\n$$\n\\rho_i c_i (A \\Delta x_i) \\frac{dT_i}{dt} = Q_{i-1/2} - Q_{i+1/2}\n$$\nSince $A=1$, we have:\n$$\n(\\rho_i c_i \\Delta x_i) \\frac{dT_i}{dt} = q_{i-1/2} - q_{i+1/2}\n$$\nwhere $q = Q/A$ is the heat flux per unit area.\n\nWe discretize the time derivative using the explicit Forward Euler scheme, where fluxes on the right-hand side are evaluated at the current time level $n$:\n$$\n(\\rho_i c_i \\Delta x_i) \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = q_{i-1/2}^n - q_{i+1/2}^n\n$$\nRearranging for the temperature at the new time level, $T_i^{n+1}$:\n$$\nT_i^{n+1} = T_i^n + \\frac{\\Delta t}{\\rho_i c_i \\Delta x_i} (q_{i-1/2}^n - q_{i+1/2}^n)\n$$\n\nThe heat fluxes are defined using a thermal resistance network analogy based on Fourier's law. The flux between two points is the temperature difference divided by the thermal resistance. The thermal resistance of a slab of material is $R_{th} = L / (k A)$, where $L$ is the thickness. Since $A=1$, $R_{th} = L/k$. The inverse of resistance is conductance, $K = 1/R_{th}$.\n\nFor an interior face at location $x_{i+1/2}$ between cell $i$ and cell $i+1$, the flux is driven by the temperature difference between the cell centers, $T_i^n$ and $T_{i+1}^n$. The total thermal resistance is the sum of two half-cell resistances in series:\n$$\nR_{i+1/2} = R_{i \\to i+1/2} + R_{i+1/2 \\to i+1} = \\frac{\\Delta x_i/2}{k_i} + \\frac{\\Delta x_{i+1}/2}{k_{i+1}}\n$$\nThe corresponding thermal conductance is $K_{i+1/2} = 1/R_{i+1/2}$. The heat flux is then:\n$$\nq_{i+1/2}^n = K_{i+1/2} (T_i^n - T_{i+1}^n) = \\frac{T_i^n - T_{i+1}^n}{\\frac{\\Delta x_i}{2k_i} + \\frac{\\Delta x_{i+1}}{2k_{i+1}}}\n$$\nBy symmetry, the flux at the left face of cell $i$ is $q_{i-1/2}^n = K_{i-1/2} (T_{i-1}^n - T_i^n)$.\n\nSubstituting these flux expressions for an interior cell ($0 < i < N-1$) into the discretized energy equation yields:\n$$\nT_i^{n+1} = T_i^n + \\frac{\\Delta t}{\\rho_i c_i \\Delta x_i} [K_{i-1/2}(T_{i-1}^n - T_i^n) - K_{i+1/2}(T_i^n - T_{i+1}^n)]\n$$\nGrouping terms by temperature at time level $n$:\n$$\nT_i^{n+1} = \\frac{\\Delta t K_{i-1/2}}{\\rho_i c_i \\Delta x_i} T_{i-1}^n + \\left(1 - \\frac{\\Delta t (K_{i-1/2} + K_{i+1/2})}{\\rho_i c_i \\Delta x_i}\\right) T_i^n + \\frac{\\Delta t K_{i+1/2}}{\\rho_i c_i \\Delta x_i} T_{i+1}^n\n$$\n\nFor the scheme to be numerically stable and guarantee physical solutions (non-negativity), the coefficients of the temperatures $T^n$ on the right-hand side must be non-negative. The coefficients for $T_{i-1}^n$ and $T_{i+1}^n$ are inherently non-negative. The stability constraint thus arises from the coefficient of $T_i^n$:\n$$\n1 - \\frac{\\Delta t (K_{i-1/2} + K_{i+1/2})}{\\rho_i c_i \\Delta x_i} \\ge 0\n$$\nSolving for $\\Delta t$ gives the local stability-limited time step for an interior cell $i$:\n$$\n\\Delta t \\le \\frac{\\rho_i c_i \\Delta x_i}{K_{i-1/2} + K_{i+1/2}} \\equiv \\Delta t_{i, \\text{max}}\n$$\n\nNow we must consider the boundary cells. Let the cell indices run from $i=0$ to $i=N-1$.\n\nFor the first cell ($i=0$):\nThe update equation is $T_0^{n+1} = T_0^n + \\frac{\\Delta t}{\\rho_0 c_0 \\Delta x_0} (q_{-1/2}^n - q_{1/2}^n)$, where $q_{-1/2}^n$ is the boundary flux and $q_{1/2}^n=K_{1/2}(T_0^n-T_1^n)$.\n- If the left boundary is Dirichlet (fixed temperature $T_{b,L}$), the flux is modeled with a half-cell resistance $R_{-1/2} = (\\Delta x_0/2)/k_0$. The conductance is $K_{-1/2} = 2k_0/\\Delta x_0$. The flux is $q_{-1/2}^n = K_{-1/2}(T_{b,L} - T_0^n)$. The coefficient of $T_0^n$ in the update equation becomes $1 - \\frac{\\Delta t (K_{-1/2} + K_{1/2})}{\\rho_0 c_0 \\Delta x_0}$. The stability limit is $\\Delta t_{0, \\text{max}} = \\frac{\\rho_0 c_0 \\Delta x_0}{K_{-1/2} + K_{1/2}}$.\n- If the left boundary is Neumann (zero flux), $q_{-1/2}^n = 0$. The coefficient of $T_0^n$ becomes $1 - \\frac{\\Delta t K_{1/2}}{\\rho_0 c_0 \\Delta x_0}$. The stability limit is $\\Delta t_{0, \\text{max}} = \\frac{\\rho_0 c_0 \\Delta x_0}{K_{1/2}}$. This is equivalent to setting the boundary conductance $K_{-1/2}=0$.\n\nFor the last cell ($i=N-1$):\nThe update equation is $T_{N-1}^{n+1} = T_{N-1}^n + \\frac{\\Delta t}{\\rho_{N-1} c_{N-1} \\Delta x_{N-1}} (q_{N-3/2}^n - q_{N-1/2}^n)$, where $q_{N-3/2}^n = K_{N-3/2}(T_{N-2}^n-T_{N-1}^n)$ and $q_{N-1/2}^n$ is the boundary flux.\n- If the right boundary is Dirichlet (fixed temperature $T_{b,R}$), the flux resistance is $R_{N-1/2} = (\\Delta x_{N-1}/2)/k_{N-1}$. The conductance is $K_{N-1/2} = 2k_{N-1}/\\Delta x_{N-1}$. The flux is $q_{N-1/2}^n = K_{N-1/2}(T_{N-1}^n - T_{b,R})$. The coefficient of $T_{N-1}^n$ is $1 - \\frac{\\Delta t (K_{N-3/2} + K_{N-1/2})}{\\rho_{N-1} c_{N-1} \\Delta x_{N-1}}$. The stability limit is $\\Delta t_{N-1, \\text{max}} = \\frac{\\rho_{N-1} c_{N-1} \\Delta x_{N-1}}{K_{N-3/2} + K_{N-1/2}}$.\n- If the right boundary is Neumann (zero flux), $q_{N-1/2}^n = 0$. The coefficient of $T_{N-1}^n$ is $1 - \\frac{\\Delta t K_{N-3/2}}{\\rho_{N-1} c_{N-1} \\Delta x_{N-1}}$. The stability limit is $\\Delta t_{N-1, \\text{max}} = \\frac{\\rho_{N-1} c_{N-1} \\Delta x_{N-1}}{K_{N-3/2}}$. This is equivalent to setting the boundary conductance $K_{N-1/2}=0$.\n\nIn summary, for any cell $i$, the locally most restrictive time step is given by:\n$$\n\\Delta t_{i, \\text{max}} = \\frac{\\rho_i c_i \\Delta x_i}{K_{left, i} + K_{right, i}}\n$$\nwhere $K_{left, i}$ and $K_{right, i}$ are the conductances on the left and right faces of cell $i$, respectively.\n- For an interior face between cell $i-1$ and $i$: $K_{left, i} = \\frac{1}{\\frac{\\Delta x_{i-1}}{2k_{i-1}} + \\frac{\\Delta x_i}{2k_i}}$.\n- For an interior face between cell $i$ and $i+1$: $K_{right, i} = \\frac{1}{\\frac{\\Delta x_i}{2k_i} + \\frac{\\Delta x_{i+1}}{2k_{i+1}}}$.\n- For a Dirichlet boundary at the left of cell $0$: $K_{left, 0} = \\frac{2k_0}{\\Delta x_0}$.\n- For a Neumann boundary at the left of cell $0$: $K_{left, 0} = 0$.\n- For a Dirichlet boundary at the right of cell $N-1$: $K_{right, N-1} = \\frac{2k_{N-1}}{\\Delta x_{N-1}}$.\n- For a Neumann boundary at the right of cell $N-1$: $K_{right, N-1} = 0$.\n\nThe global most restrictive time step for the entire system is the minimum of all the local time step limits, as the system must be stable for every cell simultaneously:\n$$\n\\Delta t_{\\text{global}} = \\min_{i=0, \\dots, N-1} (\\Delta t_{i, \\text{max}})\n$$\nThis value gives the largest possible time step $\\Delta t$ for which the explicit Forward Euler scheme is guaranteed to be stable.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the most restrictive time step for a series of 1D transient heat\n    conduction problems discretized using the Finite Volume Method.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"dx\": np.array([0.008, 0.012, 0.010, 0.015, 0.005]),\n            \"k\": np.array([15, 22, 18, 40, 10]),\n            \"rho\": np.array([7800, 7800, 7800, 7800, 7800]),\n            \"c\": np.array([500, 500, 500, 500, 500]),\n            \"bc_left\": \"Dirichlet\",\n            \"bc_right\": \"Dirichlet\",\n        },\n        {\n            \"dx\": np.array([0.0005, 0.002, 0.0015, 0.0025, 0.002]),\n            \"k\": np.array([30, 30, 30, 30, 30]),\n            \"rho\": np.array([7900, 7900, 7900, 7900, 7900]),\n            \"c\": np.array([460, 460, 460, 460, 460]),\n            \"bc_left\": \"Dirichlet\",\n            \"bc_right\": \"Dirichlet\",\n        },\n        {\n            \"dx\": np.array([0.01, 0.02, 0.015, 0.025]),\n            \"k\": np.array([12, 20, 14, 16]),\n            \"rho\": np.array([8500, 8500, 8500, 8500]),\n            \"c\": np.array([500, 500, 500, 500]),\n            \"bc_left\": \"Neumann\",\n            \"bc_right\": \"Dirichlet\",\n        },\n        {\n            \"dx\": np.array([0.006, 0.004, 0.007, 0.005]),\n            \"k\": np.array([20, 400, 15, 25]),\n            \"rho\": np.array([7800, 7800, 7800, 7800]),\n            \"c\": np.array([500, 500, 500, 500]),\n            \"bc_left\": \"Dirichlet\",\n            \"bc_right\": \"Dirichlet\",\n        },\n        {\n            \"dx\": np.array([0.009, 0.011, 0.008]),\n            \"k\": np.array([18, 22, 19]),\n            \"rho\": np.array([3000, 8000, 6000]),\n            \"c\": np.array([800, 500, 700]),\n            \"bc_left\": \"Dirichlet\",\n            \"bc_right\": \"Dirichlet\",\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        dt_global = calculate_dt_max(case)\n        results.append(dt_global)\n\n    # Format output to 10 significant digits per problem specification\n    formatted_results = [f\"{r:.9e}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_dt_max(case_data):\n    \"\"\"\n    Calculates the global most restrictive time step for a single case.\n    \n    The stability limit for each cell i is given by:\n    dt_i = (rho_i * c_i * dx_i) / (K_left + K_right)\n    where K_left and K_right are the thermal conductances at the cell faces.\n    The global limit is the minimum of all dt_i.\n    \"\"\"\n    dx = case_data[\"dx\"]\n    k = case_data[\"k\"]\n    rho = case_data[\"rho\"]\n    c = case_data[\"c\"]\n    bc_left_type = case_data[\"bc_left\"]\n    bc_right_type = case_data[\"bc_right\"]\n    \n    N = len(dx)\n    local_dt_max = np.zeros(N)\n\n    for i in range(N):\n        # Thermal capacitance of cell i (per unit area)\n        cell_capacitance = rho[i] * c[i] * dx[i]\n        \n        # Conductance on the left face of cell i\n        if i == 0:\n            if bc_left_type == \"Dirichlet\":\n                # Half-cell resistance from boundary to cell center\n                K_left = 2.0 * k[0] / dx[0]\n            else:  # Neumann zero-flux\n                K_left = 0.0\n        else:\n            # Interior face: harmonic mean conductivity based on series resistance\n            R_left = (dx[i-1] / (2.0 * k[i-1])) + (dx[i] / (2.0 * k[i]))\n            K_left = 1.0 / R_left\n            \n        # Conductance on the right face of cell i\n        if i == N - 1:\n            if bc_right_type == \"Dirichlet\":\n                # Half-cell resistance from cell center to boundary\n                K_right = 2.0 * k[N-1] / dx[N-1]\n            else:  # Neumann zero-flux\n                K_right = 0.0\n        else:\n            # Interior face: harmonic mean conductivity based on series resistance\n            R_right = (dx[i] / (2.0 * k[i])) + (dx[i+1] / (2.0 * k[i+1]))\n            K_right = 1.0 / R_right\n            \n        total_conductance = K_left + K_right\n        \n        # Stability limit requires TotalConductance to be non-zero\n        if total_conductance > 0:\n            local_dt_max[i] = cell_capacitance / total_conductance\n        else:\n            # Occurs for N=1 with Neumann B.C. on both sides; dt is infinite\n            local_dt_max[i] = np.inf\n\n    return np.min(local_dt_max)\n\nsolve()\n```"
        },
        {
            "introduction": "After discretizing a PDE and implementing a solver, a critical final step is verification: ensuring the code is free of bugs and performs at its theoretical order of accuracy. This exercise introduces the use of manufactured solutions and grid convergence studies, which are gold standards for code verification in computational science. You will learn to calculate discrete error norms, such as the $L_2$ and $L_{\\infty}$ norms, and use the results from a series of grid refinements to empirically determine the order of convergence, a process that builds essential confidence in your simulation tools .",
            "id": "3964340",
            "problem": "Consider one-dimensional, steady heat conduction in a homogeneous slab occupying the spatial domain $x \\in [0,1]$, with constant thermal conductivity $k$ and a volumetric heat source $s(x)$. The governing conservation law for energy in steady state is the boundary value problem $-\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) = s(x)$ with Dirichlet boundary conditions $T(0)=0$ and $T(1)=0$. Let $k$ be constant and equal to a positive constant, and let the source be such that the exact solution is $T(x) = \\sin(\\pi x)$. A second-order central finite difference method on uniform grids with mesh spacing $h$ is used to compute discrete solutions $\\{T_j^{(i)}\\}$ at grid points $\\{x_j\\}$ for four grid resolutions with $h_1 = \\frac{1}{16}$, $h_2 = \\frac{1}{32}$, $h_3 = \\frac{1}{64}$, and $h_4 = \\frac{1}{128}$. For each grid $i \\in \\{1,2,3,4\\}$, the pointwise errors $e_j^{(i)} = T_j^{(i)} - T(x_j)$ are recorded, and the following grid-refinement data are provided:\n- For the discrete $L_2$ error calculations, the sums $S^{(i)} = \\sum_{j} \\left(e_j^{(i)}\\right)^2$ are:\n$$S^{(1)} = 1.6 \\times 10^{-5}, \\quad S^{(2)} = 2.0 \\times 10^{-6}, \\quad S^{(3)} = 2.5 \\times 10^{-7}, \\quad S^{(4)} = 3.125 \\times 10^{-8}.$$\n- For the discrete $L_{\\infty}$ error calculations, the maxima $M^{(i)} = \\max_{j} \\left|e_j^{(i)}\\right|$ are:\n$$M^{(1)} = 2.0 \\times 10^{-3}, \\quad M^{(2)} = 5.0 \\times 10^{-4}, \\quad M^{(3)} = 1.25 \\times 10^{-4}, \\quad M^{(4)} = 3.125 \\times 10^{-5}.$$\n\nTasks:\n1. Starting from the continuous definitions of the $L_2$ and $L_{\\infty}$ norms of the error $e(x) = T_h(x) - T(x)$ on $[0,1]$, derive consistent discrete definitions $E_2^{(i)}$ and $E_{\\infty}^{(i)}$ for a uniform grid with spacing $h_i$, expressed in terms of the pointwise errors $e_j^{(i)}$, the grid spacing $h_i$, and the provided quantities $S^{(i)}$ and $M^{(i)}$.\n2. Using your discrete definitions, compute the $L_2$ error norms $E_2^{(i)}$ for $i=1,2,3,4$ from the provided $S^{(i)}$ and $h_i$.\n3. Using the $L_2$ norms, estimate the observed order of convergence $p$ by fitting the model $\\ln\\left(E_2^{(i)}\\right) \\approx \\alpha + p \\,\\ln(h_i)$ via least squares over the four grids. Report the final value of $p$ rounded to four significant figures. No units are required for $p$.",
            "solution": "The user has provided a problem statement that must first be validated for correctness, completeness, and scientific soundness before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation:** One-dimensional, steady heat conduction: $-\\frac{d}{dx}\\left(k \\frac{dT}{dx}\\right) = s(x)$ for $x \\in [0,1]$.\n- **Domain:** $x \\in [0,1]$.\n- **Thermal Conductivity:** $k$ is a positive constant.\n- **Boundary Conditions:** $T(0)=0$ and $T(1)=0$.\n- **Exact Solution:** $T(x) = \\sin(\\pi x)$. This implies the source term is $s(x) = k \\pi^2 \\sin(\\pi x)$.\n- **Numerical Method:** Second-order central finite difference method on uniform grids.\n- **Grid Spacings:** $h_1 = \\frac{1}{16}$, $h_2 = \\frac{1}{32}$, $h_3 = \\frac{1}{64}$, and $h_4 = \\frac{1}{128}$.\n- **Pointwise Error:** $e_j^{(i)} = T_j^{(i)} - T(x_j)$ for grid $i$ at point $x_j$.\n- **$L_2$ Error Sums:** $S^{(i)} = \\sum_{j} \\left(e_j^{(i)}\\right)^2$\n  - $S^{(1)} = 1.6 \\times 10^{-5}$\n  - $S^{(2)} = 2.0 \\times 10^{-6}$\n  - $S^{(3)} = 2.5 \\times 10^{-7}$\n  - $S^{(4)} = 3.125 \\times 10^{-8}$\n- **$L_{\\infty}$ Error Maxima:** $M^{(i)} = \\max_{j} \\left|e_j^{(i)}\\right|$\n  - $M^{(1)} = 2.0 \\times 10^{-3}$\n  - $M^{(2)} = 5.0 \\times 10^{-4}$\n  - $M^{(3)} = 1.25 \\times 10^{-4}$\n  - $M^{(4)} = 3.125 \\times 10^{-5}$\n- **Tasks:**\n  1. Derive discrete error norms $E_2^{(i)}$ and $E_{\\infty}^{(i)}$.\n  2. Compute $E_2^{(i)}$ for $i=1,2,3,4$.\n  3. Estimate the order of convergence $p$ for the $L_2$ error using a least squares fit to the model $\\ln\\left(E_2^{(i)}\\right) \\approx \\alpha + p \\,\\ln(h_i)$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Soundness:** The problem describes steady-state heat conduction governed by the Poisson equation, a fundamental concept in thermal engineering and physics. The use of finite difference methods, grid refinement, error norms, and convergence analysis are standard and correct procedures in numerical analysis. The provided exact solution $T(x) = \\sin(\\pi x)$ correctly satisfies the Dirichlet boundary conditions $T(0)=0$ and $T(1)=0$. The problem is scientifically and mathematically sound.\n2.  **Well-Posedness and Completeness:** The problem is a well-posed boundary value problem. All data required to perform the three specified tasks are provided. The tasks themselves are clearly defined and admit a unique solution. A check of the provided error data shows internal consistency. For a second-order method, halving the mesh size $h$ should reduce the error by a factor of $2^2=4$. The $M^{(i)}$ values show this exactly: $M^{(i)}/M^{(i+1)}=4$. For the $L_2$ norm, which scales as $\\sqrt{h S}$, the quantity $hS$ should be proportional to $h^4$, meaning $S$ should be proportional to $h^3$. Halving $h$ should reduce $S$ by a factor of $2^3=8$. The $S^{(i)}$ values show this exactly: $S^{(i)}/S^{(i+1)}=8$. The data is consistent with the premise of a second-order method.\n3.  **Objectivity:** The problem is stated using precise, objective mathematical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, and internally consistent. It is a valid problem. A solution will be provided.\n\n---\n\n### Solution\n\nThe solution is divided into three parts corresponding to the tasks specified in the problem statement.\n\n**Task 1: Derive the discrete error norms**\n\nThe error function is $e(x) = T_h(x) - T(x)$, where $T_h(x)$ is a representation of the discrete solution and $T(x)$ is the exact solution.\n\nThe continuous $L_{\\infty}$ norm of the error on the domain $[0,1]$ is defined as:\n$$\n\\|e\\|_{\\infty} = \\max_{x \\in [0,1]} |e(x)|\n$$\nA consistent discrete analogue of this norm, denoted $E_{\\infty}^{(i)}$ for a grid $i$, is the maximum of the absolute pointwise errors over all grid points $\\{x_j\\}$. The problem provides this quantity directly as $M^{(i)} = \\max_{j} |e_j^{(i)}| = \\max_{j} |T_j^{(i)} - T(x_j)|$. Therefore, the discrete $L_{\\infty}$ error norm is:\n$$\nE_{\\infty}^{(i)} = M^{(i)}\n$$\n\nThe continuous $L_2$ norm of the error on the domain $[0,1]$ is defined as:\n$$\n\\|e\\|_{2} = \\left( \\int_{0}^{1} (e(x))^2 dx \\right)^{1/2}\n$$\nTo find a discrete analogue, we approximate the integral using a numerical quadrature rule on the uniform grid $i$ with spacing $h_i$. The domain $[0,1]$ is partitioned into subintervals, and we can approximate the integral as a sum. Using the left-hand rectangle rule, the integral is approximated by:\n$$\n\\int_{0}^{1} (e(x))^2 dx \\approx \\sum_{j=0}^{N_i-1} (e(x_j))^2 h_i\n$$\nwhere $N_i = 1/h_i$ is the number of intervals. Since the error is zero at the boundaries, $e_0^{(i)} = e(0) = 0$ and $e_{N_i}^{(i)} = e(1) = 0$, the summation is effectively over the interior points $j=1, \\dots, N_i-1$. The problem defines $S^{(i)} = \\sum_{j} (e_j^{(i)})^2$. It is standard to assume this sum is over the interior nodes where the error is computed. Thus, we have:\n$$\n\\int_{0}^{1} (e(x))^2 dx \\approx h_i \\sum_{j=1}^{N_i-1} (e_j^{(i)})^2 = h_i S^{(i)}\n$$\nTaking the square root gives the discrete $L_2$ error norm, $E_2^{(i)}$:\n$$\nE_2^{(i)} = \\left( h_i S^{(i)} \\right)^{1/2} = \\sqrt{h_i S^{(i)}}\n$$\n\n**Task 2: Compute the $L_2$ error norms**\n\nUsing the derived formula $E_2^{(i)} = \\sqrt{h_i S^{(i)}}$ and the provided data, we compute the norms for each of the $4$ grids.\n\nFor grid $i=1$: $h_1 = \\frac{1}{16}$, $S^{(1)} = 1.6 \\times 10^{-5}$.\n$$\nE_2^{(1)} = \\sqrt{\\frac{1}{16} \\times 1.6 \\times 10^{-5}} = \\sqrt{0.1 \\times 10^{-5}} = \\sqrt{1.0 \\times 10^{-6}} = 1.0 \\times 10^{-3}\n$$\n\nFor grid $i=2$: $h_2 = \\frac{1}{32}$, $S^{(2)} = 2.0 \\times 10^{-6}$.\n$$\nE_2^{(2)} = \\sqrt{\\frac{1}{32} \\times 2.0 \\times 10^{-6}} = \\sqrt{\\frac{1}{16} \\times 1.0 \\times 10^{-6}} = \\frac{1}{4} \\times 1.0 \\times 10^{-3} = 2.5 \\times 10^{-4}\n$$\n\nFor grid $i=3$: $h_3 = \\frac{1}{64}$, $S^{(3)} = 2.5 \\times 10^{-7}$.\n$$\nE_2^{(3)} = \\sqrt{\\frac{1}{64} \\times 2.5 \\times 10^{-7}} = \\sqrt{\\frac{1}{64} \\times 25 \\times 10^{-8}} = \\frac{5}{8} \\times 10^{-4} = 0.625 \\times 10^{-4} = 6.25 \\times 10^{-5}\n$$\n\nFor grid $i=4$: $h_4 = \\frac{1}{128}$, $S^{(4)} = 3.125 \\times 10^{-8}$.\n$$\nE_2^{(4)} = \\sqrt{\\frac{1}{128} \\times 3.125 \\times 10^{-8}} = \\sqrt{\\frac{1}{128} \\times \\frac{25}{8} \\times 10^{-8}} = \\sqrt{\\frac{25}{1024} \\times 10^{-8}} = \\frac{5}{32} \\times 10^{-4} = 0.15625 \\times 10^{-4} = 1.5625 \\times 10^{-5}\n$$\n\n**Task 3: Estimate the order of convergence $p$**\n\nThe model for the error is $E_2 \\approx C h^p$, where $p$ is the order of convergence. Taking the natural logarithm gives the linear model:\n$$\n\\ln(E_2^{(i)}) \\approx \\ln(C) + p \\ln(h_i)\n$$\nThis corresponds to a linear regression of $y_i = \\ln(E_2^{(i)})$ on $x_i = \\ln(h_i)$, where the slope is $p$.\n\nLet's examine the relationship between our computed $E_2^{(i)}$ and $h_i$. The grid spacing $h_i$ is successively halved: $h_i = \\frac{1}{16} \\left(\\frac{1}{2}\\right)^{i-1}$.\nThe computed errors are:\n$E_2^{(1)} = 1.0 \\times 10^{-3}$\n$E_2^{(2)} = E_2^{(1)} / 4$\n$E_2^{(3)} = E_2^{(2)} / 4 = E_2^{(1)} / 16$\n$E_2^{(4)} = E_2^{(3)} / 4 = E_2^{(1)} / 64$\n\nThis can be written as $E_2^{(i)} = E_2^{(1)} \\left(\\frac{1}{4}\\right)^{i-1}$.\nLet's express both $E_2^{(i)}$ and $h_i$ in terms of their initial values:\n$h_i = h_1 \\left(\\frac{1}{2}\\right)^{i-1}$\n$E_2^{(i)} = E_2^{(1)} \\left(\\frac{1}{4}\\right)^{i-1} = E_2^{(1)} \\left(\\left(\\frac{1}{2}\\right)^{2}\\right)^{i-1} = E_2^{(1)} \\left(\\left(\\frac{1}{2}\\right)^{i-1}\\right)^{2}$\nSubstituting the expression for $h_i$:\n$E_2^{(i)} = E_2^{(1)} \\left(\\frac{h_i}{h_1}\\right)^2 = \\frac{E_2^{(1)}}{h_1^2} h_i^2$\n\nThis shows that $E_2^{(i)} = C (h_i)^2$ where the constant $C = \\frac{E_2^{(1)}}{h_1^2} = \\frac{1.0 \\times 10^{-3}}{(1/16)^2} = 256 \\times 10^{-3} = 0.256$.\nThe relationship is exact for the given data. Taking the natural logarithm:\n$$\n\\ln(E_2^{(i)}) = \\ln(C (h_i)^2) = \\ln(C) + 2 \\ln(h_i)\n$$\nThe data points $(x_i, y_i) = (\\ln(h_i), \\ln(E_2^{(i)}))$ lie perfectly on a straight line with slope $p=2$. A least squares regression fit to data that is perfectly linear will return the exact slope of the line. Therefore, the estimated order of convergence is exactly $2$.\n\nThe problem requires the result to be rounded to four significant figures.",
            "answer": "$$\n\\boxed{2.000}\n$$"
        }
    ]
}