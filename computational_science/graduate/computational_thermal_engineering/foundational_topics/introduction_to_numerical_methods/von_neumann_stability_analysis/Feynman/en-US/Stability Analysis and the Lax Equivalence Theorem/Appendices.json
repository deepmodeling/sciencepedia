{
    "hands_on_practices": [
        {
            "introduction": "This exercise demonstrates a crucial starting point in numerical analysis: understanding why a seemingly intuitive scheme can fail. We will analyze the Forward-Time, Centered-Space (FTCS) scheme for the linear advection equation, a fundamental model for transport phenomena. By deriving its amplification factor, you will discover why this method is unconditionally unstable and appreciate the critical need for stability analysis before implementing a numerical solution .",
            "id": "2225597",
            "problem": "Consider the one-dimensional linear advection equation, which describes the transport of a scalar quantity $u(x, t)$ with a constant velocity $c$:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\nTo solve this equation numerically, we can discretize it on a grid with time step $\\Delta t$ and spatial step $\\Delta x$. The value of the function at grid point $j$ and time step $n$ is denoted by $u_j^n = u(j\\Delta x, n\\Delta t)$.\n\nA common discretization approach is the Forward-Time, Centered-Space (FTCS) scheme. In this scheme, the time derivative is approximated using a forward difference and the spatial derivative is approximated using a central difference, both evaluated at time step $n$:\n$$\n\\frac{\\partial u}{\\partial t} \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\n$$\n\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x}\n$$\nTo analyze the stability of such a scheme, we use von Neumann stability analysis. We consider a single Fourier mode of the solution, represented by the ansatz $u_j^n = G^n e^{i k j \\Delta x}$, where $k$ is the wavenumber and $G$ is the complex amplification factor. This factor determines how the amplitude of a mode changes from one time step to the next.\n\nLet the Courant number be defined as $C = \\frac{c \\Delta t}{\\Delta x}$. By substituting the discretized derivatives and the Fourier mode ansatz into the original advection equation, an expression for the amplification factor $G$ can be found as a function of the wavenumber $k$ and the Courant number $C$.\n\nWhat is the maximum possible magnitude of the amplification factor, $|G|_{max}$, over all possible real wavenumbers $k$?\n\nA. $1$\n\nB. $\\sqrt{1+C^2}$\n\nC. $1+C$\n\nD. $\\sqrt{1-C^2}$\n\nE. $C$",
            "solution": "We start from the FTCS discretization of the advection equation. Approximating the derivatives at time level $n$ gives\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}+c\\,\\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\Delta x}=0.\n$$\nMultiplying by $\\Delta t$ and introducing the Courant number $C=\\frac{c\\Delta t}{\\Delta x}$ yields the recurrence\n$$\nu_{j}^{n+1}=u_{j}^{n}-\\frac{C}{2}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right).\n$$\nFor von Neumann analysis, use the Fourier mode ansatz $u_{j}^{n}=G^{n}\\exp(i k j \\Delta x)$. Then\n$$\nu_{j+1}^{n}=G^{n}\\exp\\!\\big(i k (j+1)\\Delta x\\big)=\\exp(i k \\Delta x)\\,u_{j}^{n},\\qquad\nu_{j-1}^{n}=G^{n}\\exp\\!\\big(i k (j-1)\\Delta x\\big)=\\exp(-i k \\Delta x)\\,u_{j}^{n}.\n$$\nSubstituting into the recurrence gives\n$$\nG^{n+1}\\exp(i k j \\Delta x)=G^{n}\\exp(i k j \\Delta x)-\\frac{C}{2}\\,G^{n}\\exp(i k j \\Delta x)\\left[\\exp(i k \\Delta x)-\\exp(-i k \\Delta x)\\right].\n$$\nDividing by $G^{n}\\exp(i k j \\Delta x)$ yields the amplification factor\n$$\nG=1-\\frac{C}{2}\\left[\\exp(i k \\Delta x)-\\exp(-i k \\Delta x)\\right].\n$$\nUsing $\\exp(i\\theta)-\\exp(-i\\theta)=2i\\sin(\\theta)$ with $\\theta=k\\Delta x$, we obtain\n$$\nG=1-i\\,C\\,\\sin(k\\Delta x).\n$$\nIts magnitude is\n$$\n|G|=\\sqrt{(\\Re G)^{2}+(\\Im G)^{2}}=\\sqrt{1+C^{2}\\sin^{2}(k\\Delta x)}.\n$$\nMaximizing over all real $k$ is equivalent to maximizing over $\\theta=k\\Delta x\\in\\mathbb{R}$, for which $\\sin^{2}(\\theta)\\in[0,1]$. Hence\n$$\n|G|_{\\max}=\\sqrt{1+C^{2}}.\n$$\nTherefore, the correct option is B.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Having seen how a simple scheme can be unstable, we now explore a method designed to be stable, the Richtmyer two-step method. This practice applies the von Neumann analysis to a multi-step scheme for the same linear advection equation, revealing the concept of conditional stability. You will derive the famous Courant-Friedrichs-Lewy (CFL) condition, which relates the time step, spatial grid size, and wave speed to ensure a stable simulation .",
            "id": "2225605",
            "problem": "An electrical engineer is modeling the propagation of a voltage pulse, $u(x, t)$, along a lossless transmission line. The behavior is governed by the one-dimensional linear advection equation:\n$$ \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0 $$\nwhere $c$ is the constant speed of signal propagation. To solve this equation numerically, a two-step finite difference scheme, known as the Richtmyer method, is proposed. Let $u_j^n$ be the numerical approximation of the voltage at position $x_j = j\\Delta x$ and time $t_n = n\\Delta t$, where $\\Delta x$ is the spatial grid spacing and $\\Delta t$ is the time step.\n\nThe scheme is defined by two sequential steps:\n1.  A provisional value is calculated at a half-time step and a mid-grid point:\n    $$ u_{j+1/2}^{n+1/2} = \\frac{1}{2}(u_{j+1}^n + u_j^n) - \\frac{c\\Delta t}{2\\Delta x}(u_{j+1}^n - u_j^n) $$\n2.  The final value at the next full time step is computed using these provisional values:\n    $$ u_j^{n+1} = u_j^n - \\frac{c\\Delta t}{\\Delta x}(u_{j+1/2}^{n+1/2} - u_{j-1/2}^{n+1/2}) $$\n\nTo ensure that numerical errors do not grow uncontrollably, the scheme must be stable. By performing a von Neumann stability analysis, determine the stability condition for the Courant number, $\\mu = \\frac{c\\Delta t}{\\Delta x}$.\n\nWhich of the following inequalities represents the necessary condition for this scheme to be numerically stable?\n\nA. $|\\mu| \\le 2$\n\nB. $|\\mu| \\le \\frac{1}{2}$\n\nC. $|\\mu| \\le 1$\n\nD. $|\\mu| \\le \\sqrt{2}$\n\nE. The scheme is unconditionally unstable.\n\nF. The scheme is unconditionally stable.",
            "solution": "We perform a von Neumann stability analysis by assuming a single Fourier mode of the form $u_{j}^{n}=\\hat{u}^{n}\\exp(i\\theta j)$, where $\\theta=k\\Delta x$ and $k$ is the wavenumber. Then $u_{j+1}^{n}=\\hat{u}^{n}\\exp(i\\theta(j+1))=\\hat{u}^{n}\\exp(i\\theta j)\\exp(i\\theta)$ and $u_{j-1}^{n}=\\hat{u}^{n}\\exp(i\\theta(j-1))=\\hat{u}^{n}\\exp(i\\theta j)\\exp(-i\\theta)$.\n\nDefine the Courant number $\\mu=\\frac{c\\Delta t}{\\Delta x}$. The provisional half-step value is\n$$\nu_{j+1/2}^{n+1/2}=\\frac{1}{2}\\left(u_{j+1}^{n}+u_{j}^{n}\\right)-\\frac{\\mu}{2}\\left(u_{j+1}^{n}-u_{j}^{n}\\right).\n$$\nSubstituting the Fourier mode and factoring $\\hat{u}^{n}\\exp(i\\theta j)$ gives\n$$\nu_{j+1/2}^{n+1/2}=\\hat{u}^{n}\\exp(i\\theta j)\\left[\\frac{1}{2}\\left(\\exp(i\\theta)+1\\right)-\\frac{\\mu}{2}\\left(\\exp(i\\theta)-1\\right)\\right].\n$$\nSimilarly,\n$$\nu_{j-1/2}^{n+1/2}=\\frac{1}{2}\\left(u_{j}^{n}+u_{j-1}^{n}\\right)-\\frac{\\mu}{2}\\left(u_{j}^{n}-u_{j-1}^{n}\\right)\n=\\hat{u}^{n}\\exp(i\\theta j)\\left[\\frac{1}{2}\\left(1+\\exp(-i\\theta)\\right)-\\frac{\\mu}{2}\\left(1-\\exp(-i\\theta)\\right)\\right].\n$$\nThe update to the next time level is\n$$\nu_{j}^{n+1}=u_{j}^{n}-\\mu\\left(u_{j+1/2}^{n+1/2}-u_{j-1/2}^{n+1/2}\\right).\n$$\nWriting $u_{j}^{n}=\\hat{u}^{n}\\exp(i\\theta j)$ and $u_{j}^{n+1}=\\hat{u}^{n+1}\\exp(i\\theta j)$, the amplification factor $G$ defined by $\\hat{u}^{n+1}=G\\,\\hat{u}^{n}$ is\n$$\nG=1-\\mu\\left\\{\\left[\\frac{1}{2}\\left(\\exp(i\\theta)+1\\right)-\\frac{\\mu}{2}\\left(\\exp(i\\theta)-1\\right)\\right]-\\left[\\frac{1}{2}\\left(1+\\exp(-i\\theta)\\right)-\\frac{\\mu}{2}\\left(1-\\exp(-i\\theta)\\right)\\right]\\right\\}.\n$$\nCompute the bracketed difference:\n$$\n\\frac{1}{2}\\left(\\exp(i\\theta)+1\\right)-\\frac{1}{2}\\left(1+\\exp(-i\\theta)\\right)=\\frac{1}{2}\\left(\\exp(i\\theta)-\\exp(-i\\theta)\\right)=i\\sin\\theta,\n$$\n$$\n-\\frac{\\mu}{2}\\left[\\left(\\exp(i\\theta)-1\\right)-\\left(1-\\exp(-i\\theta)\\right)\\right]=-\\frac{\\mu}{2}\\left(\\exp(i\\theta)+\\exp(-i\\theta)-2\\right)=-\\mu\\left(\\cos\\theta-1\\right)=\\mu\\left(1-\\cos\\theta\\right).\n$$\nHence\n$$\nG=1-\\mu\\left[i\\sin\\theta+\\mu\\left(1-\\cos\\theta\\right)\\right]=1-i\\mu\\sin\\theta-\\mu^{2}\\left(1-\\cos\\theta\\right).\n$$\nThe squared modulus is\n$$\n|G|^{2}=\\left[1-\\mu^{2}\\left(1-\\cos\\theta\\right)\\right]^{2}+\\left[\\mu\\sin\\theta\\right]^{2}.\n$$\nLet $S=\\sin\\theta$ and $C=\\cos\\theta$. Using $S^{2}=1-C^{2}$,\n$$\n|G|^{2}=1-2\\mu^{2}(1-C)+\\mu^{4}(1-2C+C^{2})+\\mu^{2}(1-C^{2}).\n$$\nCombine the $\\mu^{2}$ terms:\n$$\n(1-C^{2})-2(1-C)=-\\left(1-2C+C^{2}\\right)=-(1-C)^{2},\n$$\nand note $(1-2C+C^{2})=(1-C)^{2}$. Therefore\n$$\n|G|^{2}=1-\\mu^{2}(1-C)^{2}+\\mu^{4}(1-C)^{2}=1+(1-C)^{2}\\mu^{2}\\left(\\mu^{2}-1\\right).\n$$\nSince $(1-C)^{2}\\geq 0$ for all $\\theta$, the necessary and sufficient condition for $|G|\\leq 1$ for all $\\theta$ is\n$$\n\\mu^{2}\\left(\\mu^{2}-1\\right)\\leq 0 \\quad \\Longleftrightarrow \\quad \\mu^{2}\\leq 1 \\quad \\Longleftrightarrow \\quad |\\mu|\\leq 1.\n$$\nThus the scheme is stable if and only if $|\\mu|\\leq 1$, corresponding to option C.",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "We now shift our focus from hyperbolic advection problems to parabolic diffusion problems, which are central to thermal engineering. This exercise examines the Backward-Time, Centered-Space (BTCS) scheme for the one-dimensional heat equation, a classic example of an implicit method. By analyzing its amplification factor, you will understand the concept of unconditional stability, a powerful feature that removes the time step constraint found in many explicit schemes .",
            "id": "2225612",
            "problem": "The one-dimensional heat equation, which describes the distribution of heat in a long thin rod, is given by the partial differential equation $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$. Here, $u(x, t)$ represents the temperature at position $x$ and time $t$, and $\\alpha$ is the constant thermal diffusivity of the material.\n\nTo solve this equation numerically, one can use a finite difference method. Consider the fully implicit Backward-Time, Centered-Space (BTCS) scheme. Let $u_j^n$ denote the numerical approximation of $u(j\\Delta x, n\\Delta t)$, where $\\Delta x$ is the spatial step size and $\\Delta t$ is the time step size. The BTCS scheme is defined by the following discretized equation:\n\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\alpha \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n\nThe stability of this scheme can be analyzed by investigating the behavior of a single Fourier mode. The amplification factor, $G$, represents how the amplitude of a Fourier mode with wave number $k$ changes over a single time step.\n\nDetermine the amplification factor $G$. Express your answer as an analytic function of the dimensionless diffusion number $d = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ and the dimensionless phase angle $\\xi = k \\Delta x$.",
            "solution": "We analyze the BTCS scheme\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\alpha \\frac{u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1}}{(\\Delta x)^{2}}\n$$\nby inserting a single Fourier mode. Let $u_{j}^{n}=\\hat{u}^{n}\\exp(i j \\xi)$, where $\\xi=k\\Delta x$ is the dimensionless phase angle. Then $u_{j\\pm 1}^{n+1}=\\hat{u}^{n+1}\\exp(i (j\\pm 1)\\xi)=\\hat{u}^{n+1}\\exp(i j \\xi)\\exp(\\pm i \\xi)$ and $u_{j}^{n+1}=\\hat{u}^{n+1}\\exp(i j \\xi)$. Substituting into the scheme and canceling the common factor $\\exp(i j \\xi)$ gives\n$$\n\\frac{\\hat{u}^{n+1}-\\hat{u}^{n}}{\\Delta t}=\\alpha \\frac{\\hat{u}^{n+1}\\left(\\exp(i\\xi)-2+\\exp(-i\\xi)\\right)}{(\\Delta x)^{2}}.\n$$\nDefine the amplification factor $G=\\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$. Then\n$$\n\\frac{G-1}{\\Delta t}=\\alpha \\frac{G\\left(\\exp(i\\xi)-2+\\exp(-i\\xi)\\right)}{(\\Delta x)^{2}}.\n$$\nUse $\\exp(i\\xi)+\\exp(-i\\xi)=2\\cos\\xi$ to write $\\exp(i\\xi)-2+\\exp(-i\\xi)=2\\cos\\xi-2=-4\\sin^{2}\\!\\left(\\frac{\\xi}{2}\\right)$. Hence\n$$\nG-1=-4\\,\\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}\\,G\\,\\sin^{2}\\!\\left(\\frac{\\xi}{2}\\right).\n$$\nWith the dimensionless diffusion number $d=\\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}$, we obtain\n$$\nG\\left(1+4 d \\sin^{2}\\!\\left(\\frac{\\xi}{2}\\right)\\right)=1,\n$$\nso the amplification factor is\n$$\nG=\\frac{1}{1+4 d \\sin^{2}\\!\\left(\\frac{\\xi}{2}\\right)}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{1+4 d \\sin^{2}\\!\\left(\\frac{\\xi}{2}\\right)}}$$"
        }
    ]
}