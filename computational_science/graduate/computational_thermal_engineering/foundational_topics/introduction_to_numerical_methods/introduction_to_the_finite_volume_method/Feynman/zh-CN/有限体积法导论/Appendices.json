{
    "hands_on_practices": [
        {
            "introduction": "有限体积法（FVM）的核心是确保离散守恒，即每个控制体内的物理量变化精确等于通过其边界的通量。本练习通过一个理想化的思想实验——线性温度场——来揭示这一基本原则。通过分析这个案例 ，我们将证明，对于一个无源区域，一个精确的FVM离散格式如何自然地满足净扩散通量为零的守恒定律，这为更复杂问题的数值求解奠定了理论基石。",
            "id": "3964711",
            "problem": "考虑一个具有平面面的通用三维六面体控制体，其面集记为 $\\{f\\}$，外向单位法向量为 $\\mathbf{n}_{f}$，面面积为 $A_{f}$。设温度场在空间中呈线性分布，$T(\\mathbf{x}) = a + \\mathbf{b}\\cdot \\mathbf{x}$，其中常数 $a \\in \\mathbb{R}$ 且 $\\mathbf{b} \\in \\mathbb{R}^{3}$。热导率为常数且各向同性，$k>0$。无体积热源，且情况为稳态。扩散热通量矢量由 Fourier 定律给出：$\\mathbf{q}(\\mathbf{x}) = -k \\nabla T(\\mathbf{x})$。在有限体积法 (Finite Volume Method, FVM) 中，穿过控制体边界的净扩散热率是 $\\mathbf{q}$ 的法向分量在闭合曲面上的面积分。\n\n仅使用基本原理（固定控制体上的能量守恒、Fourier 热传导定律和标准矢量微积分恒等式），推导穿过闭合曲面的净扩散热率的有限体积法面求和表达式，然后计算其在给定线性温度场和常数 $k$ 下的精确值。将最终答案表示为以瓦特 (W) 为单位的净扩散热率。提供精确值。\n\n此外，通过直接计算验证该控制体的体积积分 $\\int_{V} \\left[-\\nabla \\cdot \\left(k \\nabla T\\right)\\right] \\,\\mathrm{d}V$ 等于零，并解释为什么只要六面体的面是平面的，这个结果就与六面体的具体形状无关。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n**步骤 1：提取已知条件**\n-   控制体：一个具有平面面的通用三维六面体控制体 $V$。\n-   面：面集记为 $\\{f\\}$。\n-   面法向量：每个面 $f$ 的外向单位法向量为 $\\mathbf{n}_{f}$。\n-   面面积：每个面 $f$ 的面积为 $A_{f}$。\n-   温度场：$T(\\mathbf{x}) = a + \\mathbf{b}\\cdot \\mathbf{x}$，其中 $a \\in \\mathbb{R}$ 为标量常数，$\\mathbf{b} \\in \\mathbb{R}^{3}$ 为常数矢量。\n-   热导率：$k$ 是一个正常数 ($k>0$) 且各向同性。\n-   热源：无体积热源。\n-   时间依赖性：过程处于稳态。\n-   热通量：Fourier 定律给出扩散热通量矢量为 $\\mathbf{q}(\\mathbf{x}) = -k \\nabla T(\\mathbf{x})$。\n-   目标 1：推导净扩散热率的有限体积法面求和表达式并计算其精确值。\n-   目标 2：通过直接计算验证 $\\int_{V} \\left[-\\nabla \\cdot \\left(k \\nabla T\\right)\\right] \\,\\mathrm{d}V = 0$。\n-   目标 3：解释为什么目标 2 的结果与六面体的具体形状无关。\n\n**步骤 2：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n-   **科学依据**：该问题基于热传导的基本原理，即能量守恒定律和 Fourier 热传导定律。其数学框架依赖于标准矢量微积分。线性温度场的假设是数值分析和理论推导中一种有效且常见的简化方法。\n-   **适定性**：该问题是完全确定的。它提供了确定唯一解所需的所有必要定义、物理定律和属性（$T(\\mathbf{x})$，$k$）。\n-   **客观性**：该问题使用精确、无歧义的数学和物理术语进行陈述。它不含主观或基于意见的内容。\n-   **一致性与完备性**：所给条件是自洽且充分的。无体积热源的条件与给定的线性温度场和恒定热导率的推论相一致，这将在解答中展示。\n-   **现实性**：虽然在宏观体积上完美的线性温度场是一种理想化情况，但它是一种物理上合理的局部近似，也是分析有限体积法 (FVM) 等数值方法的标准情景。\n\n**步骤 3：结论与行动**\n该问题被认为是有效的，因为它科学合理、适定且内部一致。可以开始求解过程。\n\n按要求，解答分为三部分。\n\n**第 1 部分：净扩散热率**\n穿过具有闭合边界曲面 $S$ 的固定控制体 $V$ 的净扩散热率，记为 $\\dot{Q}_{\\text{net}}$，定义为热通量矢量 $\\mathbf{q}$ 法向分量的面积分。\n$$ \\dot{Q}_{\\text{net}} = \\oint_{S} \\mathbf{q} \\cdot \\mathrm{d}\\mathbf{S} = \\oint_{S} \\mathbf{q} \\cdot \\mathbf{n} \\, \\mathrm{d}S $$\n在有限体积法中，控制体是一个具有一组离散平面面 $\\{f\\}$ 的多面体。面积分被替换为在每个面上的积分之和：\n$$ \\dot{Q}_{\\text{net}} = \\sum_{f} \\int_{A_f} \\mathbf{q} \\cdot \\mathbf{n}_f \\, \\mathrm{d}A_f $$\n其中 $\\mathbf{n}_f$ 是面积为 $A_f$ 的平面面 $f$ 的恒定外向单位法向量。一种常见的 FVM 近似假设面上的通量是均匀的，等于其在面心处的值，从而得到代数表达式 $\\dot{Q}_{\\text{net}} \\approx \\sum_{f} (\\mathbf{q}_f \\cdot \\mathbf{n}_f) A_f$。然而，在本问题中，我们可以精确地计算该表达式。\n\n首先，我们根据给定的温度场 $T(\\mathbf{x}) = a + \\mathbf{b}\\cdot \\mathbf{x}$ 来确定热通量矢量 $\\mathbf{q}(\\mathbf{x})$。温度场的梯度是：\n$$ \\nabla T = \\nabla(a + \\mathbf{b}\\cdot \\mathbf{x}) = \\nabla a + \\nabla(\\mathbf{b}\\cdot \\mathbf{x}) $$\n由于 $a$ 是标量常数，$\\nabla a = \\mathbf{0}$。对于项 $\\mathbf{b}\\cdot \\mathbf{x}$，其中 $\\mathbf{b} = (b_1, b_2, b_3)$ 和 $\\mathbf{x} = (x_1, x_2, x_3)$ 分别是常数矢量和位置矢量，我们有 $\\mathbf{b}\\cdot \\mathbf{x} = b_1 x_1 + b_2 x_2 + b_3 x_3$。其梯度为：\n$$ \\nabla(\\mathbf{b}\\cdot \\mathbf{x}) = \\left(\\frac{\\partial}{\\partial x_1}, \\frac{\\partial}{\\partial x_2}, \\frac{\\partial}{\\partial x_3}\\right) (b_1 x_1 + b_2 x_2 + b_3 x_3) = (b_1, b_2, b_3) = \\mathbf{b} $$\n因此，温度梯度是常数矢量 $\\mathbf{b}$：\n$$ \\nabla T = \\mathbf{b} $$\n现在，我们应用 Fourier 定律 $\\mathbf{q}(\\mathbf{x}) = -k \\nabla T(\\mathbf{x})$。由于 $k$ 和 $\\nabla T = \\mathbf{b}$ 都是常数，热通量矢量 $\\mathbf{q}$ 在整个区域内也是恒定的：\n$$ \\mathbf{q}(\\mathbf{x}) = -k \\mathbf{b} $$\n将这个恒定的热通量矢量代入净热率的表达式中：\n$$ \\dot{Q}_{\\text{net}} = \\sum_{f} \\int_{A_f} (-k \\mathbf{b}) \\cdot \\mathbf{n}_f \\, \\mathrm{d}A_f $$\n由于 $(-k \\mathbf{b})$ 和 $\\mathbf{n}_f$ 相对于面积 $A_f$ 的积分都是常数，点积可以移到积分之外：\n$$ \\dot{Q}_{\\text{net}} = \\sum_{f} \\left( (-k \\mathbf{b}) \\cdot \\mathbf{n}_f \\right) \\int_{A_f} \\mathrm{d}A_f = \\sum_{f} \\left( (-k \\mathbf{b}) \\cdot \\mathbf{n}_f \\right) A_f $$\n这就是净扩散热率的有限体积法面求和表达式。我们可以通过提出常数矢量 $-k \\mathbf{b}$ 来进一步简化这个表达式：\n$$ \\dot{Q}_{\\text{net}} = (-k \\mathbf{b}) \\cdot \\left( \\sum_{f} A_f \\mathbf{n}_f \\right) $$\n任何闭合多面体的一个基本几何特性是，其所有外向面面积矢量的矢量和为零矢量。即：\n$$ \\sum_{f} A_f \\mathbf{n}_f = \\oint_S \\mathbf{n} \\, \\mathrm{d}S = \\mathbf{0} $$\n这个恒等式可以通过对任意常数矢量场 $\\mathbf{c}$ 应用散度定理来证明：$\\int_V (\\nabla \\cdot \\mathbf{c}) \\, \\mathrm{d}V = \\oint_S \\mathbf{c} \\cdot \\mathbf{n} \\, \\mathrm{d}S$。由于 $\\nabla \\cdot \\mathbf{c} = 0$，左侧为零。右侧为 $\\mathbf{c} \\cdot \\oint_S \\mathbf{n} \\, \\mathrm{d}S$。要使此式对任意 $\\mathbf{c}$ 都为零，法向量的积分（或和）必须为零。\n\n将这个几何恒等式代入我们关于 $\\dot{Q}_{\\text{net}}$ 的表达式中：\n$$ \\dot{Q}_{\\text{net}} = (-k \\mathbf{b}) \\cdot \\mathbf{0} = 0 $$\n净扩散热率的精确值为 $0$ W。\n\n**第 2 部分：体积积分的验证**\n我们被要求验证 $\\int_{V} \\left[-\\nabla \\cdot \\left(k \\nabla T\\right)\\right] \\,\\mathrm{d}V = 0$。\n项 $-\\nabla \\cdot (k \\nabla T)$ 是稳态热方程中的扩散源项。在没有体积源的情况下，热方程为 $\\nabla \\cdot (k \\nabla T) = 0$。让我们明确地计算这个散度项。\n从第 1 部分，我们已经确定对于给定的线性温度场，$\\nabla T = \\mathbf{b}$，其中 $\\mathbf{b}$ 是一个常数矢量。\n散度算子内部的表达式是 $k \\nabla T = k \\mathbf{b}$。由于 $k$ 是常数标量，$\\mathbf{b}$ 是常数矢量，所以 $k \\mathbf{b}$ 是一个常数矢量场。\n令 $\\mathbf{F} = k\\mathbf{b}$。这个常数矢量场的散度是：\n$$ \\nabla \\cdot \\mathbf{F} = \\nabla \\cdot (k\\mathbf{b}) = \\frac{\\partial(k b_1)}{\\partial x_1} + \\frac{\\partial(k b_2)}{\\partial x_2} + \\frac{\\partial(k b_3)}{\\partial x_3} = 0 + 0 + 0 = 0 $$\n在空间的每一点，散度都恒为零。因此，被积函数在体积 $V$ 内的任何地方都为零：\n$$ -\\nabla \\cdot (k \\nabla T) = 0 $$\n零在任何体积上的体积积分都为零：\n$$ \\int_{V} 0 \\, \\mathrm{d}V = 0 $$\n这验证了该论断。根据散度定理，此体积积分必须等于净表面热通量，$\\oint_S (k \\nabla T) \\cdot \\mathrm{d}\\mathbf{S} = -\\oint_S \\mathbf{q} \\cdot \\mathrm{d}\\mathbf{S} = -\\dot{Q}_{\\text{net}}$。由于我们在第 1 部分中发现 $\\dot{Q}_{\\text{net}} = 0$，此结果是一致的。\n\n**第 3 部分：与形状的无关性**\n结果 $\\int_{V} \\left[-\\nabla \\cdot \\left(k \\nabla T\\right)\\right] \\,\\mathrm{d}V = 0$ 与六面体的具体形状无关。原因在于被积函数 $-\\nabla \\cdot (k \\nabla T)$ 的计算。\n如第 2 部分所示，计算出 $\\nabla \\cdot (k \\nabla T)$ 为零仅依赖于两个事实：\n1.  热导率 $k$ 是常数。\n2.  温度场 $T(\\mathbf{x})$ 是位置的线性函数，这使其梯度 $\\nabla T$ 成为一个常数矢量。\n\n结果是常数矢量场 $k \\nabla T$ 的散度在空间的每一点都为零，即 $\\nabla \\cdot (k \\nabla T) \\equiv 0$。这是一个逐点成立的恒等式，与任何控制体的存在或几何形状无关。由于被积函数恒为零，它在*任何*体积 $V$（无论是六面体、球体、棱锥体还是任何其他形状）上的积分都将永远为零。控制体的属性（例如，它是一个具有平面面的六面体）与此结论完全无关。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在将守恒定律离散化后，我们面临一个实际挑战：如何精确计算驱动扩散等现象的物理量梯度？本练习  将带你深入FVM的一个关键技术环节——梯度重构。你将亲手实现并比较两种主流方法（格林-高斯法和最小二乘法），并在一个倾斜的网格单元上评估它们的表现，从而直观理解不同数值策略对计算精度的影响。",
            "id": "3964691",
            "problem": "一个平面上的单个倾斜四边形控制体由其按逆时针顺序列出的顶点定义：$\\left(0,0\\right)$、$\\left(1.8,0.2\\right)$、$\\left(2.0,1.3\\right)$ 和 $\\left(0.2,1.1\\right)$。考虑标量温度场 $T(x,y)=x^{2}+y$。使用适用于有限体积法 (FVM) 的原理，执行以下步骤，以比较两种梯度重构策略并量化它们对线性重构误差的影响：\n\n- 使用简单多边形的标准几何公式计算多边形面积 $A$ 和形心 $\\boldsymbol{x}_{P}=\\left(x_{P},y_{P}\\right)$。\n\n- 使用格林-高斯 (GG) 梯度，该梯度由在控制体边界上离散化的散度定理获得，通过以下公式近似计算单元中心的梯度 $\\nabla T\\big|_{P}$\n$$\n\\nabla T\\big|_{P}\\approx \\frac{1}{A}\\sum_{f=1}^{4}T\\big(\\boldsymbol{m}_{f}\\big)\\,\\boldsymbol{s}_{f},\n$$\n其中 $\\boldsymbol{m}_{f}$ 是面 $f$ 的中点，$\\boldsymbol{s}_{f}$ 是面 $f$ 的外向边法向量，其大小等于面长（通过将边向量 $\\Delta \\boldsymbol{x}_{f}$ 旋转 $+90^{\\circ}$ 构造，因此对于逆时针排序的多边形，$\\boldsymbol{s}_{f}=\\big(\\Delta y_{f},-\\Delta x_{f}\\big)$）。\n\n- 使用均匀加权的最小二乘 (LS) 梯度，通过最小化由四个顶点样本构建的残差平方和来近似计算单元中心的梯度 $\\nabla T\\big|_{P}$。在均匀权重下，这导出了正规方程组\n$$\n\\left(\\sum_{i=1}^{4}\\boldsymbol{d}_{i}\\boldsymbol{d}_{i}^{\\mathsf{T}}\\right)\\boldsymbol{g}=\\sum_{i=1}^{4}\\boldsymbol{d}_{i}\\left[T\\left(\\boldsymbol{x}_{i}\\right)-T\\left(\\boldsymbol{x}_{P}\\right)\\right],\n$$\n其中 $\\boldsymbol{d}_{i}=\\boldsymbol{x}_{i}-\\boldsymbol{x}_{P}$ 是从形心到顶点 $i$ 的向量，$\\boldsymbol{g}$ 是 $\\nabla T\\big|_{P}$ 的最小二乘估计。\n\n- 对于每种方法（GG 和 LS），使用以下公式在四个面中点处形成一阶线性重构：\n$$\nT_{\\text{rec}}^{(\\cdot)}\\big(\\boldsymbol{m}_{f}\\big)=T\\left(\\boldsymbol{x}_{P}\\right)+\\left[\\nabla T\\big|_{P}\\right]^{(\\cdot)}\\cdot\\left(\\boldsymbol{m}_{f}-\\boldsymbol{x}_{P}\\right),\n$$\n并计算这四个面上的均方根 (RMS) 重构误差，\n$$\nE^{(\\cdot)}=\\sqrt{\\frac{1}{4}\\sum_{f=1}^{4}\\left[T_{\\text{rec}}^{(\\cdot)}\\big(\\boldsymbol{m}_{f}\\big)-T\\big(\\boldsymbol{m}_{f}\\big)\\right]^{2}}.\n$$\n\n以纯数（无量纲）的形式报告 RMS 误差之比 $E^{(\\mathrm{GG})}/E^{(\\mathrm{LS})}$。将您的最终答案四舍五入到四位有效数字。",
            "solution": "该问题要求在一个指定的四边形控制体上，对给定的标量场，比较两种梯度重构方案：格林-高斯 (GG) 和最小二乘 (LS)。最终目标是计算在面中点处的均方根 (RMS) 重构误差之比。\n\n该四边形的顶点按逆时针顺序列出如下：\n$\\boldsymbol{x}_{1} = (0,0)$\n$\\boldsymbol{x}_{2} = (1.8,0.2)$\n$\\boldsymbol{x}_{3} = (2.0,1.3)$\n$\\boldsymbol{x}_{4} = (0.2,1.1)$\n\n标量温度场由 $T(x,y) = x^2 + y$ 给出。\n\n首先，我们计算控制体的面积 $A$ 和形心 $\\boldsymbol{x}_{P} = (x_P, y_P)$。\n使用鞋带公式计算简单多边形的面积：\n$$A = \\frac{1}{2} \\left| \\sum_{i=1}^{4} (x_i y_{i+1} - x_{i+1} y_i) \\right|$$\n其中 $\\boldsymbol{x}_{5} = \\boldsymbol{x}_{1}$。\n$A = \\frac{1}{2} |(x_1 y_2 - x_2 y_1) + (x_2 y_3 - x_3 y_2) + (x_3 y_4 - x_4 y_3) + (x_4 y_1 - x_1 y_4)|$\n$A = \\frac{1}{2} |(0 \\cdot 0.2 - 1.8 \\cdot 0) + (1.8 \\cdot 1.3 - 2.0 \\cdot 0.2) + (2.0 \\cdot 1.1 - 0.2 \\cdot 1.3) + (0.2 \\cdot 0 - 0 \\cdot 1.1)|$\n$A = \\frac{1}{2} |0 + (2.34 - 0.4) + (2.2 - 0.26) + 0| = \\frac{1}{2} |1.94 + 1.94| = \\frac{1}{2}(3.88) = 1.94$\n\n该控制体是一个平行四边形，这可以通过检查对边的向量来确认：\n$\\boldsymbol{x}_{2}-\\boldsymbol{x}_{1} = (1.8-0, 0.2-0) = (1.8, 0.2)$\n$\\boldsymbol{x}_{3}-\\boldsymbol{x}_{4} = (2.0-0.2, 1.3-1.1) = (1.8, 0.2)$\n对于平行四边形，其形心是顶点坐标的平均值：\n$x_P = \\frac{1}{4}(x_1+x_2+x_3+x_4) = \\frac{1}{4}(0+1.8+2.0+0.2) = \\frac{4.0}{4} = 1.0$\n$y_P = \\frac{1}{4}(y_1+y_2+y_3+y_4) = \\frac{1}{4}(0+0.2+1.3+1.1) = \\frac{2.6}{4} = 0.65$\n因此，形心为 $\\boldsymbol{x}_{P} = (1.0, 0.65)$。\n\n接下来，我们计算格林-高斯 (GG) 梯度，$\\nabla T\\big|_{P}^{(\\mathrm{GG})} = \\frac{1}{A} \\sum_{f=1}^{4} T(\\boldsymbol{m}_{f}) \\boldsymbol{s}_{f}$。\n我们需要面中点 $\\boldsymbol{m}_f$ 和外向法向量 $\\boldsymbol{s}_f$。\n\n面 1 (v1 到 v2):\n$\\Delta \\boldsymbol{x}_1 = \\boldsymbol{x}_2 - \\boldsymbol{x}_1 = (1.8, 0.2)$.\n$\\boldsymbol{s}_1 = (\\Delta y_1, -\\Delta x_1) = (0.2, -1.8)$.\n$\\boldsymbol{m}_1 = \\frac{\\boldsymbol{x}_1+\\boldsymbol{x}_2}{2} = (0.9, 0.1)$.\n$T(\\boldsymbol{m}_1) = (0.9)^2 + 0.1 = 0.81 + 0.1 = 0.91$.\n$T(\\boldsymbol{m}_1)\\boldsymbol{s}_1 = 0.91(0.2, -1.8) = (0.182, -1.638)$.\n\n面 2 (v2 到 v3):\n$\\Delta \\boldsymbol{x}_2 = \\boldsymbol{x}_3 - \\boldsymbol{x}_2 = (0.2, 1.1)$.\n$\\boldsymbol{s}_2 = (1.1, -0.2)$.\n$\\boldsymbol{m}_2 = \\frac{\\boldsymbol{x}_2+\\boldsymbol{x}_3}{2} = (1.9, 0.75)$.\n$T(\\boldsymbol{m}_2) = (1.9)^2 + 0.75 = 3.61 + 0.75 = 4.36$.\n$T(\\boldsymbol{m}_2)\\boldsymbol{s}_2 = 4.36(1.1, -0.2) = (4.796, -0.872)$.\n\n面 3 (v3 到 v4):\n$\\Delta \\boldsymbol{x}_3 = \\boldsymbol{x}_4 - \\boldsymbol{x}_3 = (-1.8, -0.2)$.\n$\\boldsymbol{s}_3 = (-0.2, 1.8)$.\n$\\boldsymbol{m}_3 = \\frac{\\boldsymbol{x}_3+\\boldsymbol{x}_4}{2} = (1.1, 1.2)$.\n$T(\\boldsymbol{m}_3) = (1.1)^2 + 1.2 = 1.21 + 1.2 = 2.41$.\n$T(\\boldsymbol{m}_3)\\boldsymbol{s}_3 = 2.41(-0.2, 1.8) = (-0.482, 4.338)$.\n\n面 4 (v4 到 v1):\n$\\Delta \\boldsymbol{x}_4 = \\boldsymbol{x}_1 - \\boldsymbol{x}_4 = (-0.2, -1.1)$.\n$\\boldsymbol{s}_4 = (-1.1, 0.2)$.\n$\\boldsymbol{m}_4 = \\frac{\\boldsymbol{x}_4+\\boldsymbol{x}_1}{2} = (0.1, 0.55)$.\n$T(\\boldsymbol{m}_4) = (0.1)^2 + 0.55 = 0.01 + 0.55 = 0.56$.\n$T(\\boldsymbol{m}_4)\\boldsymbol{s}_4 = 0.56(-1.1, 0.2) = (-0.616, 0.112)$.\n\n总和为：\n$\\sum_{f=1}^{4} T(\\boldsymbol{m}_{f})\\boldsymbol{s}_{f} = (0.182+4.796-0.482-0.616, -1.638-0.872+4.338+0.112)$\n$\\sum_{f=1}^{4} T(\\boldsymbol{m}_{f})\\boldsymbol{s}_{f} = (3.88, 1.94)$.\n\nGG 梯度为：\n$\\nabla T\\big|_{P}^{(\\mathrm{GG})} = \\frac{1}{1.94} (3.88, 1.94) = (2.0, 1.0)$.\n\n接下来，我们通过求解正规方程组 $\\left(\\sum_{i=1}^{4}\\boldsymbol{d}_{i}\\boldsymbol{d}_{i}^{\\mathsf{T}}\\right)\\boldsymbol{g}=\\sum_{i=1}^{4}\\boldsymbol{d}_{i}\\left[T\\left(\\boldsymbol{x}_{i}\\right)-T\\left(\\boldsymbol{x}_{P}\\right)\\right]$ 来计算最小二乘 (LS) 梯度 $\\boldsymbol{g}=[\\nabla T\\big|_{P}]^{(\\mathrm{LS)}}$。\n$T(\\boldsymbol{x}_P) = (1.0)^2 + 0.65 = 1.65$.\n位移向量 $\\boldsymbol{d}_i = \\boldsymbol{x}_i - \\boldsymbol{x}_P$ 和顶点温度 $T(\\boldsymbol{x}_i)$ 如下：\n$\\boldsymbol{d}_1 = (0,0) - (1.0, 0.65) = (-1.0, -0.65)$; $T(\\boldsymbol{x}_1) = 0$.\n$\\boldsymbol{d}_2 = (1.8,0.2) - (1.0, 0.65) = (0.8, -0.45)$; $T(\\boldsymbol{x}_2) = 1.8^2+0.2 = 3.44$.\n$\\boldsymbol{d}_3 = (2.0,1.3) - (1.0, 0.65) = (1.0, 0.65)$; $T(\\boldsymbol{x}_3) = 2.0^2+1.3 = 5.3$.\n$\\boldsymbol{d}_4 = (0.2,1.1) - (1.0, 0.65) = (-0.8, 0.45)$; $T(\\boldsymbol{x}_4) = 0.2^2+1.1 = 1.14$.\n\n左侧矩阵 $M = \\sum \\boldsymbol{d}_i\\boldsymbol{d}_i^{\\mathsf{T}}$ 为：\n$M_{11} = (-1.0)^2 + (0.8)^2 + (1.0)^2 + (-0.8)^2 = 1.0 + 0.64 + 1.0 + 0.64 = 3.28$.\n$M_{12} = M_{21} = (-1.0)(-0.65) + (0.8)(-0.45) + (1.0)(0.65) + (-0.8)(0.45) = 0.65 - 0.36 + 0.65 - 0.36 = 0.58$.\n$M_{22} = (-0.65)^2 + (-0.45)^2 + (0.65)^2 + (0.45)^2 = 0.4225 + 0.2025 + 0.4225 + 0.2025 = 1.25$.\n$M = \\begin{pmatrix} 3.28 & 0.58 \\\\ 0.58 & 1.25 \\end{pmatrix}$.\n\n右侧向量 $\\boldsymbol{b} = \\sum \\boldsymbol{d}_i(T_i - T_P)$ 为：\n第 1 项: $(-1.0, -0.65)(0 - 1.65) = (1.65, 1.0725)$.\n第 2 项: $(0.8, -0.45)(3.44 - 1.65) = (0.8, -0.45)(1.79) = (1.432, -0.8055)$.\n第 3 项: $(1.0, 0.65)(5.3 - 1.65) = (1.0, 0.65)(3.65) = (3.65, 2.3725)$.\n第 4 项: $(-0.8, 0.45)(1.14 - 1.65) = (-0.8, 0.45)(-0.51) = (0.408, -0.2295)$.\n$\\boldsymbol{b} = (1.65+1.432+3.65+0.408, 1.0725-0.8055+2.3725-0.2295)^{\\mathsf{T}} = (7.14, 2.41)^{\\mathsf{T}}$.\n\n求解 $M\\boldsymbol{g}=\\boldsymbol{b}$：\n$\\det(M) = (3.28)(1.25)-(0.58)^2 = 4.1 - 0.3364 = 3.7636$.\n$\\boldsymbol{g} = M^{-1}\\boldsymbol{b} = \\frac{1}{3.7636}\\begin{pmatrix} 1.25 & -0.58 \\\\ -0.58 & 3.28 \\end{pmatrix} \\begin{pmatrix} 7.14 \\\\ 2.41 \\end{pmatrix}$.\n$g_x = \\frac{1}{3.7636}(1.25 \\cdot 7.14 - 0.58 \\cdot 2.41) = \\frac{8.925 - 1.3978}{3.7636} = \\frac{7.5272}{3.7636} = 2.0$.\n$g_y = \\frac{1}{3.7636}(-0.58 \\cdot 7.14 + 3.28 \\cdot 2.41) = \\frac{-4.1412 + 7.9048}{3.7636} = \\frac{3.7636}{3.7636} = 1.0$.\nLS 梯度为 $\\nabla T\\big|_{P}^{(\\mathrm{LS})} = (2.0, 1.0)$。\n\n$T(x,y)=x^2+y$ 的精确梯度是 $\\nabla T = (2x, 1)$。在形心 $\\boldsymbol{x}_P=(1.0, 0.65)$ 处，精确梯度为 $\\nabla T(\\boldsymbol{x}_P) = (2(1.0), 1) = (2.0, 1.0)$。\n对于这个特定问题，GG 和 LS 方法都在形心处得到了精确梯度。这是因为几何形状是平行四边形，且场是二次的。\n\n由于两种方法产生了相同的梯度向量，$\\nabla T\\big|_{P}^{(\\mathrm{GG})} = \\nabla T\\big|_{P}^{(\\mathrm{LS})}$，因此两种方法在面中点处的线性重构将是相同的：\n$T_{\\text{rec}}^{(\\mathrm{GG})}\\big(\\boldsymbol{m}_{f}\\big) = T(\\boldsymbol{x}_{P})+\\nabla T\\big|_{P}^{(\\mathrm{GG})}\\cdot(\\boldsymbol{m}_{f}-\\boldsymbol{x}_{P})$\n$T_{\\text{rec}}^{(\\mathrm{LS})}\\big(\\boldsymbol{m}_{f}\\big) = T(\\boldsymbol{x}_{P})+\\nabla T\\big|_{P}^{(\\mathrm{LS})}\\cdot(\\boldsymbol{m}_{f}-\\boldsymbol{x}_{P})$\n鉴于梯度相同，对于所有 $f=1,..,4$，有 $T_{\\text{rec}}^{(\\mathrm{GG})}\\big(\\boldsymbol{m}_{f}\\big) = T_{\\text{rec}}^{(\\mathrm{LS})}\\big(\\boldsymbol{m}_{f}\\big)$。\n\n因此，两种方法在每个面上的重构误差将是相同的。RMS 误差定义为：\n$E^{(\\mathrm{GG})}=\\sqrt{\\frac{1}{4}\\sum_{f=1}^{4}\\left[T_{\\text{rec}}^{(\\mathrm{GG})}\\big(\\boldsymbol{m}_{f}\\big)-T\\big(\\boldsymbol{m}_{f}\\big)\\right]^{2}}$\n$E^{(\\mathrm{LS})}=\\sqrt{\\frac{1}{4}\\sum_{f=1}^{4}\\left[T_{\\text{rec}}^{(\\mathrm{LS})}\\big(\\boldsymbol{m}_{f}\\big)-T\\big(\\boldsymbol{m}_{f}\\big)\\right]^{2}}$\n由于求和中的项是相同的，因此必然有 $E^{(\\mathrm{GG})} = E^{(\\mathrm{LS})}$。\n重构误差不为零，因为二次函数的线性重构不是完美的。例如，对于面 1：\n$\\boldsymbol{r}_1 = \\boldsymbol{m}_1 - \\boldsymbol{x}_P = (0.9, 0.1) - (1.0, 0.65) = (-0.1, -0.55)$.\n$T_{\\text{rec}}(\\boldsymbol{m}_1) = T(\\boldsymbol{x}_P) + \\nabla T\\big|_{P} \\cdot \\boldsymbol{r}_1 = 1.65 + (2.0, 1.0)\\cdot(-0.1, -0.55) = 1.65 - 0.2 - 0.55 = 0.90$.\n精确温度为 $T(\\boldsymbol{m}_1) = 0.91$。\n面 1 的平方误差为 $(0.90 - 0.91)^2 = (-0.01)^2 = 0.0001$。由于此误差不为零，所以 $E^{(\\mathrm{GG})}$ 和 $E^{(\\mathrm{LS})}$ 均不为零且相等。\n\n因此，RMS 误差之比为：\n$\\frac{E^{(\\mathrm{GG})}}{E^{(\\mathrm{LS})}} = 1$.\n\n按要求四舍五入到四位有效数字，结果为 $1.000$。",
            "answer": "$$\n\\boxed{1.000}\n$$"
        },
        {
            "introduction": "编写数值求解器只是第一步，如何确定代码的正确性才是关键。本综合练习  将指导你运用“人造解法”（Method of Manufactured Solutions, MMS）这一强大的代码验证技术。你将从一个预设的精确解出发，反向推导控制方程所需的源项，然后构建一个二维有限体积求解器，并通过网格加密研究来系统地验证你的程序是否达到了预期的理论精度。",
            "id": "3964725",
            "problem": "考虑一个正方形域中的稳态二维热扩散方程，该方程由包含体积源项的能量守恒定律控制。控制方程为 $-\\nabla \\cdot (k \\nabla T) = q$，并在所有边界上施加 Dirichlet 边界条件。假设热导率 $k$ 为常数且各向同性，域为边长以米为单位的正方形 $\\Omega = [0,1] \\times [0,1]$。在正方形的所有四条边上，规定边界温度为 $T=0$。使用“人造解法”(Method of Manufactured Solutions, MMS)，选择精确解为 $T(x,y) = \\sin(\\pi x)\\sin(\\pi y)$，并推导源项 $q(x,y)$，使得所选的 $T(x,y)$ 在 $k$ 为常数时精确满足控制方程。将 $k$ 视为一个已知的正常数，单位为瓦特每米开尔文 (W/(m·K))。\n\n您的任务是为上述问题实现一个均匀笛卡尔、单元中心的有限体积法 (Finite Volume Method, FVM) 离散化。离散化必须从每个控制体上的守恒积分形式开始，应用散度定理，并使用常数 $k$ 和内部相邻单元中心之间的二阶中心差分来近似面上的扩散通量。对于与边界相邻的控制体，通过使用面上已知的边界温度，以边界通量的形式弱施加 Dirichlet 边界条件。将体积源处理为在单元中心计算的 $q(x,y)$ 值乘以控制体面积。求解得到的线性系统以获得单元中心的温度场，并计算单元中心处相对于人造精确解的误差。\n\n在网格上定义控制体，其中 $x$ 方向有 $N_x$ 个单元，$y$ 方向有 $N_y$ 个单元，均匀间距为 $\\Delta x = 1/N_x$ 和 $\\Delta y = 1/N_y$。单元中心位于 $x_i = (i+1/2)\\Delta x$（$i=0,1,\\dots,N_x-1$）和 $y_j = (j+1/2)\\Delta y$（$j=0,1,\\dots,N_y-1$）。面面积为 $S_e=S_w=\\Delta y$ 和 $S_n=S_s=\\Delta x$，相邻单元中心之间的距离为 $d_e=d_w=\\Delta x$ 和 $d_n=d_s=\\Delta y$。对于边界面，使用到边界面的一半距离 $d=\\Delta x/2$ 或 $d=\\Delta y/2$，并使用面上的精确边界温度值 $T_b=0$ 来计算边界通量。体积源项通过将局部源 $q(x_i,y_j)$ 乘以控制体面积 $\\Delta x \\Delta y$ 来引入。\n\n单位：所有温度误差以开尔文 (K) 表示。热导率 $k$ 的单位应为瓦特每米开尔文 (W/(m·K))，源项 $q$ 的单位应为瓦特每立方米 (W/m$^3$)。在适用时，三角函数中的角度以弧度表示。\n\n测试套件：\n- 案例 A (正常路径): $N_x=N_y=10$, $k=1$ W/(m·K)。\n- 案例 B (加密): $N_x=N_y=20$, $k=1$ W/(m·K)。\n- 案例 C (加密): $N_x=N_y=40$, $k=1$ W/(m·K)。\n- 案例 D (加密，接近渐近): $N_x=N_y=80$, $k=1$ W/(m·K)。\n\n对于每个案例，计算：\n- 离散 $L^2$ 误差范数，定义为 $\\|e\\|_{L^2} = \\left( \\sum_{i,j} \\left( T_{ij}^{\\text{num}} - T(x_i,y_j) \\right)^2 \\Delta x \\Delta y \\right)^{1/2}$，单位为开尔文 (K)。\n计算误差 $(E_{10},E_{20},E_{40},E_{80})$ 后，使用 $r_{m \\to n} = \\dfrac{\\ln(E_m/E_n)}{\\ln(h_m/h_n)}$（其中 $h = \\max(\\Delta x,\\Delta y)$）计算连续加密之间的观测精度阶，特别是 $r_{10 \\to 20}$、$r_{20 \\to 40}$ 和 $r_{40 \\to 80}$。最后，包含一个布尔标志，如果所有三个观测精度阶都大于或等于 $1.8$，则该标志为真。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下：$[E_{10},E_{20},E_{40},E_{80},r_{10 \\to 20},r_{20 \\to 40},r_{40 \\to 80},\\text{passed}]$。每个误差和阶数必须是浮点数，最后的标志必须是布尔字面量。所有温度误差必须以开尔文 (K) 报告。",
            "solution": "该问题是有效的，因为它在科学上基于传热学原理，在数学上是适定的，并为使用有限体积法 (FVM) 的数值求解以及通过人造解法 (MMS) 的验证提供了完整而明确的规范。\n\n求解过程包括三个主要阶段：\n1.  使用人造解推导源项 $q(x,y)$。\n2.  使用单元中心的 FVM 对控制偏微分方程 (PDE) 进行离散化，以获得一个线性代数方程组。\n3.  实现一个数值求解器，为指定的测试案例求解线性系统，并随后计算误差范数和收敛阶。\n\n**1. 源项的推导**\n\n控制方程是带源项 $q$ 的稳态热扩散方程：\n$$ -\\nabla \\cdot (k \\nabla T) = q $$\n鉴于热导率 $k$ 是一个常数标量，这可以简化为泊松方程：\n$$ -k \\nabla^2 T = q $$\n其中 $\\nabla^2$ 是拉普拉斯算子，$\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2}$。\n\n问题指定了一个人造解 $T(x,y) = \\sin(\\pi x)\\sin(\\pi y)$。我们必须推导源项 $q(x,y)$，使得这个 $T(x,y)$ 成为偏微分方程的精确解。首先，我们计算 $T(x,y)$ 的二阶偏导数：\n$$ \\frac{\\partial T}{\\partial x} = \\pi \\cos(\\pi x)\\sin(\\pi y) \\implies \\frac{\\partial^2 T}{\\partial x^2} = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y) $$\n$$ \\frac{\\partial T}{\\partial y} = \\pi \\sin(\\pi x)\\cos(\\pi y) \\implies \\frac{\\partial^2 T}{\\partial y^2} = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y) $$\n$T$ 的拉普拉斯算子是这些导数的和：\n$$ \\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} = -2\\pi^2 \\sin(\\pi x)\\sin(\\pi y) $$\n将此代入控制方程 $q = -k \\nabla^2 T$，我们得到源项：\n$$ q(x,y) = -k (-2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)) = 2k\\pi^2 \\sin(\\pi x)\\sin(\\pi y) $$\n当在模拟中使用此源项时，函数 $T(x,y) = \\sin(\\pi x)\\sin(\\pi y)$ 将是其精确解。所选的 $T(x,y)$ 也满足域 $\\Omega = [0,1] \\times [0,1]$ 边界上的 Dirichlet 边界条件 $T=0$。\n\n**2. 有限体积离散化**\n\n我们使用单元中心的有限体积法对控制偏微分方程进行离散化。我们首先将偏微分方程在一个通用控制体 (CV) 上进行积分，该控制体记为 $V_{ij}$，中心位于 $(x_i, y_j)$，面积为 $\\Delta V = \\Delta x \\Delta y$：\n$$ - \\int_{V_{ij}} \\nabla \\cdot (k \\nabla T) \\, dV = \\int_{V_{ij}} q \\, dV $$\n对左侧应用散度定理，将体积分转换为控制体边界 $\\partial V_{ij}$ 上的面积分：\n$$ - \\oint_{\\partial V_{ij}} (k \\nabla T) \\cdot \\mathbf{n} \\, dS = \\int_{V_{ij}} q \\, dV $$\n其中 $\\mathbf{n}$ 是控制体边界上的外向法向量。面积分表示流出控制体的净热通量。我们可以将其表示为矩形单元四个面（东、西、南、北，用下标 $e, w, n, s$ 表示）上的通量之和：\n$$ - \\left[ J_e + J_w + J_n + J_s \\right] = Q_{ij} $$\n其中 $J_f = \\int_f (k \\nabla T) \\cdot \\mathbf{n} \\, dS$ 是通过面 $f$ 的积分热通量，而 $Q_{ij} = \\int_{V_{ij}} q \\, dV$ 是在控制体内生成的总热量。\n\n让我们使用物理解释：对于稳态，进入控制体的热量速率必须与热生成速率相平衡。从邻近单元流入该单元的净热流由下式给出：\n$$ (J_w^{\\text{in}} - J_e^{\\text{out}}) + (J_s^{\\text{in}} - J_n^{\\text{out}}) + Q_{ij} = 0 $$\n近似通量和源项：\n- **源项**：积分源项通过单元中心的值乘以单元体积来近似：$Q_{ij} \\approx q(x_i, y_j) \\Delta x \\Delta y$。\n- **通量**：热通量矢量为 $\\mathbf{j} = -k \\nabla T$。通过一个面的热流是该通量的法向分量在面面积上的积分。对于东面，其法向量为 $\\mathbf{n}_e = (1,0)$，面积为 $S_e = \\Delta y$：\n$$ J_e^{\\text{out}} \\approx \\left( -k \\frac{\\partial T}{\\partial x} \\right)_e \\Delta y $$\n面上的梯度通过相邻单元中心 $P(i,j)$ 和 $E(i+1,j)$ 之间的二阶中心差分来近似。中心之间的距离为 $d_e = \\Delta x$。\n$$ \\left( \\frac{\\partial T}{\\partial x} \\right)_e \\approx \\frac{T_{i+1,j} - T_{ij}}{\\Delta x} \\implies J_e^{\\text{out}} \\approx -k \\frac{T_{i+1,j} - T_{ij}}{\\Delta x} \\Delta y $$\n对于内部单元的其他面，类似地：\n$$ J_w^{\\text{in}} \\approx -k \\frac{T_{ij} - T_{i-1,j}}{\\Delta x} \\Delta y $$\n$$ J_n^{\\text{out}} \\approx -k \\frac{T_{i,j+1} - T_{ij}}{\\Delta y} \\Delta x $$\n$$ J_s^{\\text{in}} \\approx -k \\frac{T_{ij} - T_{i,j-1}}{\\Delta y} \\Delta x $$\n将这些近似值代入平衡方程：\n$$ -k \\frac{T_{ij} - T_{i-1,j}}{\\Delta x} \\Delta y - \\left(-k \\frac{T_{i+1,j} - T_{ij}}{\\Delta x} \\Delta y\\right) -k \\frac{T_{ij} - T_{i,j-1}}{\\Delta y} \\Delta x - \\left(-k \\frac{T_{i,j+1} - T_{ij}}{\\Delta y} \\Delta x\\right) + q_{ij} \\Delta x \\Delta y = 0 $$\n重新排列并合并关于 $T_{ij}$ 的项：\n$$ k\\frac{\\Delta y}{\\Delta x}(T_{i-1,j} - T_{ij}) + k\\frac{\\Delta y}{\\Delta x}(T_{i+1,j} - T_{ij}) + k\\frac{\\Delta x}{\\Delta y}(T_{i,j-1} - T_{ij}) + k\\frac{\\Delta x}{\\Delta y}(T_{i,j+1} - T_{ij}) + q_{ij}\\Delta x \\Delta y = 0 $$\n我们定义系数 $a_W = a_E = k\\frac{\\Delta y}{\\Delta x}$ 和 $a_S = a_N = k\\frac{\\Delta x}{\\Delta y}$。方程变为：\n$$ (a_W+a_E+a_S+a_N)T_{ij} - a_W T_{i-1,j} - a_E T_{i+1,j} - a_S T_{i,j-1} - a_N T_{i,j+1} = q_{ij} \\Delta x \\Delta y $$\n令 $a_P = a_W+a_E+a_S+a_N$，我们得到内部单元的标准五点格式：\n$$ a_P T_{ij} - a_W T_{i-1,j} - a_E T_{i+1,j} - a_S T_{i,j-1} - a_N T_{i,j+1} = q_{ij} \\Delta x \\Delta y $$\n\n**边界条件：**\n对于与边界相邻的单元，必须使用规定的边界温度 $T_b=0$ 来计算通量。考虑西边界上的一个单元（$i=0$）。其中心到边界的距离为 $d_w = \\Delta x/2$。从边界流入该单元的热流为：\n$$ J_w^{\\text{in}} \\approx -k \\frac{T_{0j} - T_b}{\\Delta x/2} \\Delta y = -2k \\frac{\\Delta y}{\\Delta x}(T_{0j} - T_b) $$\n单元 $(0,j)$（非角点）的平衡方程包含此边界通量项。项 $a_W(T_{i-1,j} - T_{ij})$ 被这个新表达式所取代。\n对于邻近边界的单元，其离散方程通过将所有已知的边界温度项移到右侧（源项）并调整中心系数 $a_P$ 来进行修改。\n令 $a_{W,b} = 2k \\frac{\\Delta y}{\\Delta x}$。来自西面的贡献是 $a_{W,b}(T_b - T_{0j})$。项 $-a_{W,b}T_{0j}$ 修改了对角系数 $a_P$，而 $a_{W,b}T_b$ 则被加到源向量中。\n-   **西边界 ($i=0$)**：$a_P$ 增加 $a_{W,b} = 2k\\frac{\\Delta y}{\\Delta x}$，源项增加 $a_{W,b} T_b$。由于 $T_b=0$，源项不变。\n-   **东边界 ($i=N_x-1$)**：$a_P$ 增加 $a_{E,b} = 2k\\frac{\\Delta y}{\\Delta x}$。\n-   **南边界 ($j=0$)**：$a_P$ 增加 $a_{S,b} = 2k\\frac{\\Delta x}{\\Delta y}$。\n-   **北边界 ($j=N_y-1$)**：$a_P$ 增加 $a_{N,b} = 2k\\frac{\\Delta x}{\\Delta y}$。\n一个角点单元，例如 $(0,0)$，会受到两个边界（西和南）的修正。\n\n**3. 线性系统与求解**\n\n所有 $N_x \\times N_y$ 个单元的这些离散方程构成一个大型、稀疏、对角占优的线性方程组 $A\\mathbf{T} = \\mathbf{b}$，其中 $\\mathbf{T}$ 是未知单元中心温度的向量，$A$ 是系数矩阵，$\\mathbf{b}$ 是源向量。该系统通过数值方法求解。\n\n最终步骤是：\n1.  对于给定的网格 $(N_x, N_y)$ 和热导率 $k$，构造矩阵 $A$ 和向量 $\\mathbf{b}$。\n2.  求解 $A\\mathbf{T} = \\mathbf{b}$ 以找到数值解 $T_{ij}^{\\text{num}}$。\n3.  在所有单元中心计算精确解 $T(x_i, y_j)$。\n4.  计算离散 $L^2$ 误差范数：$\\|e\\|_{L^2} = \\left( \\sum_{i,j} \\left( T_{ij}^{\\text{num}} - T(x_i,y_j) \\right)^2 \\Delta x \\Delta y \\right)^{1/2}$。\n5.  对于特征单元尺寸为 $h_m$ 和 $h_n$ 的网格，其误差分别为 $E_m$ 和 $E_n$，计算观测到的精度阶：$r_{m \\to n} = \\frac{\\ln(E_m/E_n)}{\\ln(h_m/h_n)}$。对于连续的网格加密，其中 $h_n = h_m/2$，该式简化为 $r = \\frac{\\ln(E_m/E_n)}{\\ln(2)}$。对于这种二阶格式，预期的阶数约为 $r \\approx 2$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\nimport math\n\n# --- DO NOT MODIFY THE CODE BELOW ---\n\ndef run_fvm_solver(Nx, Ny, k):\n    \"\"\"\n    Solves the 2D steady heat diffusion problem using a cell-centered FVM.\n\n    Args:\n        Nx (int): Number of cells in the x-direction.\n        Ny (int): Number of cells in the y-direction.\n        k (float): Thermal conductivity.\n\n    Returns:\n        float: The discrete L2 error norm of the solution.\n    \"\"\"\n    dx = 1.0 / Nx\n    dy = 1.0 / Ny\n    total_cells = Nx * Ny\n    \n    # Cell center coordinates\n    x_centers = (np.arange(Nx) + 0.5) * dx\n    y_centers = (np.arange(Ny) + 0.5) * dy\n    \n    A = lil_matrix((total_cells, total_cells))\n    b = np.zeros(total_cells)\n\n    def q_func(x, y, k_val):\n        return 2 * k_val * math.pi**2 * np.sin(math.pi * x) * np.sin(math.pi * y)\n    \n    T_b = 0.0\n\n    for j in range(Ny):\n        for i in range(Nx):\n            p = i + j * Nx\n            \n            # Source term contribution\n            b[p] = q_func(x_centers[i], y_centers[j], k) * dx * dy\n            \n            a_P = 0.0\n\n            # West face contribution\n            if i > 0:\n                a_W = k * dy / dx\n                A[p, p - 1] = -a_W\n                a_P += a_W\n            else: # West boundary\n                a_W_b = 2.0 * k * dy / dx\n                a_P += a_W_b\n                b[p] += a_W_b * T_b\n\n            # East face contribution\n            if i  Nx - 1:\n                a_E = k * dy / dx\n                A[p, p + 1] = -a_E\n                a_P += a_E\n            else: # East boundary\n                a_E_b = 2.0 * k * dy / dx\n                a_P += a_E_b\n                b[p] += a_E_b * T_b\n\n            # South face contribution\n            if j > 0:\n                a_S = k * dx / dy\n                A[p, p - Nx] = -a_S\n                a_P += a_S\n            else: # South boundary\n                a_S_b = 2.0 * k * dx / dy\n                a_P += a_S_b\n                b[p] += a_S_b * T_b\n            \n            # North face contribution\n            if j  Ny - 1:\n                a_N = k * dx / dy\n                A[p, p + Nx] = -a_N\n                a_P += a_N\n            else: # North boundary\n                a_N_b = 2.0 * k * dx / dy\n                a_P += a_N_b\n                b[p] += a_N_b * T_b\n\n            A[p, p] = a_P\n\n    A_csr = A.tocsr()\n    \n    T_vec = spsolve(A_csr, b)\n    T_num = T_vec.reshape((Ny, Nx))\n    \n    X, Y = np.meshgrid(x_centers, y_centers)\n    T_exact = np.sin(np.pi * X) * np.sin(np.pi * Y)\n    \n    error_sq_sum = np.sum((T_num - T_exact)**2)\n    l2_error = np.sqrt(error_sq_sum * dx * dy)\n    \n    return l2_error\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and compute results.\n    \"\"\"\n    test_cases = [\n        (10, 10, 1.0),\n        (20, 20, 1.0),\n        (40, 40, 1.0),\n        (80, 80, 1.0),\n    ]\n\n    errors = []\n    h_values = []\n    for Nx, Ny, k in test_cases:\n        error = run_fvm_solver(Nx, Ny, k)\n        errors.append(error)\n        h_values.append(max(1.0/Nx, 1.0/Ny))\n\n    E10, E20, E40, E80 = errors\n\n    if E20 == 0 or E40 == 0 or E80 == 0:\n        # Avoid division by zero if error is unexpectedly zero\n        r10_20, r20_40, r40_80 = (0.0, 0.0, 0.0)\n    else:\n        r10_20 = np.log(E10 / E20) / np.log(h_values[0] / h_values[1])\n        r20_40 = np.log(E20 / E40) / np.log(h_values[1] / h_values[2])\n        r40_80 = np.log(E40 / E80) / np.log(h_values[2] / h_values[3])\n\n    rates = [r10_20, r20_40, r40_80]\n    passed = all(rate >= 1.8 for rate in rates)\n\n    results = [E10, E20, E40, E80, r10_20, r20_40, r40_80, passed]\n    \n    # Format the output string correctly\n    result_str_parts = []\n    for item in results[:-1]:\n        result_str_parts.append(f\"{item}\")\n    result_str_parts.append(str(results[-1]).lower()) # for boolean 'true'/'false'\n\n    print(f\"[{','.join(result_str_parts)}]\")\n\nsolve()\n```"
        }
    ]
}