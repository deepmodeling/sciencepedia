{
    "hands_on_practices": [
        {
            "introduction": "The foundation of robust numerical simulation lies in understanding how discretization choices constrain the time step. This exercise  provides essential practice in this area by asking you to perform a von Neumann stability analysis for the linear advection-diffusion equation. By deriving the amplification factor for a combined upwind advection and central diffusion scheme, you will determine the maximum stable time step, revealing how both physical processes—advection and diffusion—jointly constrain the explicit algorithm.",
            "id": "3985772",
            "problem": "Consider one-dimensional thermal transport in a uniform, incompressible flow, modeled by the linear advection–diffusion equation for temperature $u(x,t)$,\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}},\n$$\nwhere $a0$ is a constant advection speed and $\\nu0$ is the constant thermal diffusivity. Assume a periodic domain and a uniform spatial grid $x_j = j\\,h$ with spacing $h0$. You are to advance the solution in time using an explicit forward Euler scheme. For spatial discretization, use a first-order upwind approximation for the advection term (appropriate for $a0$) and a second-order centered approximation for the diffusion term, resulting in the update\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\frac{a\\,\\Delta t}{h}\\left(u_j^n - u_{j-1}^n\\right) \\;+\\; \\frac{\\nu\\,\\Delta t}{h^2}\\left(u_{j+1}^n - 2\\,u_j^n + u_{j-1}^n\\right).\n$$\nStarting from the partial differential equation and these standard discretizations, perform a Fourier (von Neumann) stability analysis under the assumption of periodicity. Derive the amplification factor and enforce the condition that its magnitude does not exceed $1$ for all resolvable wavenumbers. From this requirement, determine the maximum stable time step $\\Delta t$ as a closed-form expression in terms of the parameters $a$, $\\nu$, and $h$.\n\nExpress your final $\\Delta t$ in seconds. No numerical values are provided; give the exact analytic expression. No rounding is required.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\nThe given information is as follows:\n- **Partial Differential Equation (PDE)**: The one-dimensional linear advection–diffusion equation for temperature $u(x,t)$:\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}}\n$$\n- **Constants**: Advection speed $a0$ and thermal diffusivity $\\nu0$.\n- **Domain and Grid**: A periodic domain with a uniform spatial grid $x_j = j\\,h$, where $h0$ is the grid spacing.\n- **Numerical Scheme**: The time integration is performed using an explicit forward Euler scheme. The spatial derivatives are approximated using a first-order upwind scheme for the advection term ($\\frac{\\partial u}{\\partial x}$) and a second-order centered difference scheme for the diffusion term ($\\frac{\\partial^2 u}{\\partial x^2}$).\n- **Finite Difference Equation (FDE)**: The resulting discrete update rule is provided as:\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\frac{a\\,\\Delta t}{h}\\left(u_j^n - u_{j-1}^n\\right) \\;+\\; \\frac{\\nu\\,\\Delta t}{h^2}\\left(u_{j+1}^n - 2\\,u_j^n + u_{j-1}^n\\right)\n$$\nwhere $\\Delta t$ is the time step.\n- **Task**: Perform a Fourier (von Neumann) stability analysis to find the maximum stable time step $\\Delta t$ as a closed-form expression in terms of $a$, $\\nu$, and $h$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the advection-diffusion equation, a fundamental model in transport phenomena. The numerical methods described (forward Euler, upwind, central difference) and the analysis technique (von Neumann stability analysis) are standard, well-established tools in computational physics and engineering. The problem is entirely scientifically sound.\n- **Well-Posed**: The problem is clearly defined. It specifies the governing equation, the numerical scheme, and the analytical method to be used. The objective is to derive a specific quantity, the stability limit, which is expected to be unique for the given scheme.\n- **Objective**: The problem is expressed in precise mathematical language, free from any subjectivity or ambiguity.\n- **Completeness and Consistency**: All necessary information is provided. The PDE and the corresponding FDE are given and are consistent with the described discretization methods. The constraints $a0$, $\\nu0$, and $h0$ are physically meaningful and mathematically necessary.\n- **Realism**: The setup is a standard model for computational thermal engineering problems.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. A solution will be provided.\n\n### Solution Derivation\nTo perform the von Neumann stability analysis, we consider a single Fourier mode of the numerical solution on the grid. We express the solution at grid point $j$ and time step $n$ as:\n$$\nu_j^n = \\hat{u}^n(k) \\, e^{i k x_j} = \\hat{u}^n(k) \\, e^{i k j h}\n$$\nwhere $k$ is the wavenumber, $i$ is the imaginary unit, and $\\hat{u}^n(k)$ is the amplitude of the mode at time step $n$. The stability of the scheme depends on the amplification factor, $G(k)$, which relates the amplitudes at successive time steps:\n$$\n\\hat{u}^{n+1}(k) = G(k) \\, \\hat{u}^n(k)\n$$\nSubstituting the Fourier mode representation into the finite difference equation, we have:\n$$\nG(k) \\hat{u}^n(k) e^{i k j h} = \\hat{u}^n(k) e^{i k j h} - \\frac{a \\Delta t}{h} \\left( \\hat{u}^n(k) e^{i k j h} - \\hat{u}^n(k) e^{i k (j-1) h} \\right) + \\frac{\\nu \\Delta t}{h^2} \\left( \\hat{u}^n(k) e^{i k (j+1) h} - 2 \\hat{u}^n(k) e^{i k j h} + \\hat{u}^n(k) e^{i k (j-1) h} \\right)\n$$\nWe can cancel the common factor $\\hat{u}^n(k) e^{i k j h}$ from all terms:\n$$\nG(k) = 1 - \\frac{a \\Delta t}{h} (1 - e^{-i k h}) + \\frac{\\nu \\Delta t}{h^2} (e^{i k h} - 2 + e^{-i k h})\n$$\nLet's define two dimensionless numbers: the Courant number, $C = \\frac{a \\Delta t}{h}$, and the diffusion number, $d = \\frac{\\nu \\Delta t}{h^2}$. Let $\\theta = k h$. The expression for the amplification factor becomes:\n$$\nG(\\theta) = 1 - C (1 - e^{-i \\theta}) + d (e^{i \\theta} - 2 + e^{-i \\theta})\n$$\nUsing Euler's identity ($e^{i\\phi} = \\cos\\phi + i\\sin\\phi$), we can simplify the terms:\n$$\n1 - e^{-i \\theta} = 1 - (\\cos\\theta - i\\sin\\theta) = 1 - \\cos\\theta + i\\sin\\theta\n$$\n$$\ne^{i \\theta} - 2 + e^{-i \\theta} = (\\cos\\theta + i\\sin\\theta) - 2 + (\\cos\\theta - i\\sin\\theta) = 2\\cos\\theta - 2\n$$\nSubstituting these back into the expression for $G(\\theta)$:\n$$\nG(\\theta) = 1 - C(1 - \\cos\\theta + i\\sin\\theta) + d(2\\cos\\theta - 2)\n$$\nSeparating the real and imaginary parts:\n$$\nG(\\theta) = [1 - C(1 - \\cos\\theta) - 2d(1 - \\cos\\theta)] - i[C\\sin\\theta]\n$$\n$$\nG(\\theta) = [1 - (C + 2d)(1 - \\cos\\theta)] - i[C\\sin\\theta]\n$$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must not exceed $1$ for any possible wavenumber, i.e., $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$. This is equivalent to $|G(\\theta)|^2 \\le 1$.\n$$\n|G(\\theta)|^2 = [1 - (C + 2d)(1 - \\cos\\theta)]^2 + (C\\sin\\theta)^2 \\le 1\n$$\nExpanding the expression:\n$$\n1 - 2(C + 2d)(1 - \\cos\\theta) + (C + 2d)^2(1 - \\cos\\theta)^2 + C^2\\sin^2\\theta \\le 1\n$$\nSubtracting $1$ from both sides and simplifying:\n$$\n-2(C + 2d)(1 - \\cos\\theta) + (C + 2d)^2(1 - \\cos\\theta)^2 + C^2\\sin^2\\theta \\le 0\n$$\nTo simplify this expression, we use the half-angle identity $1 - \\cos\\theta = 2\\sin^2(\\frac{\\theta}{2})$ and the identity $\\sin^2\\theta = 4\\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2}) = 4\\sin^2(\\frac{\\theta}{2})(1-\\sin^2(\\frac{\\theta}{2}))$. Let $S = \\sin^2(\\frac{\\theta}{2})$. The inequality becomes:\n$$\n-2(C + 2d)(2S) + (C + 2d)^2(2S)^2 + C^2(4S(1-S)) \\le 0\n$$\nFor $S \\ne 0$ (i.e., for non-zero wavenumbers), we can divide by $4S$:\n$$\n-(C + 2d) + S(C + 2d)^2 + C^2(1-S) \\le 0\n$$\nRearranging the terms based on $S$:\n$$\nS [(C + 2d)^2 - C^2] + [C^2 - (C + 2d)] \\le 0\n$$\nSimplifying the coefficient of $S$:\n$$\n(C + 2d)^2 - C^2 = C^2 + 4Cd + 4d^2 - C^2 = 4Cd + 4d^2 = 4d(C+d)\n$$\nThe inequality is now:\n$$\nS [4d(C+d)] + C^2 - C - 2d \\le 0\n$$\nThis inequality must hold for all resolvable modes. The range of $\\theta$ is $[-\\pi, \\pi]$, which means $\\frac{\\theta}{2}$ is in $[-\\frac{\\pi}{2}, \\frac{\\pi}{2}]$, and therefore $S = \\sin^2(\\frac{\\theta}{2})$ is in $[0, 1]$.\nSince $a, \\nu, h, \\Delta t$ are all positive, $C0$ and $d0$. The coefficient of $S$, which is $4d(C+d)$, is therefore positive. This means the left-hand side of the inequality is a monotonically increasing function of $S$. The most restrictive condition (the maximum value of the left-hand side) occurs when $S$ is at its maximum value, $S=1$ (corresponding to the highest frequency mode with $\\theta=\\pi$). We must enforce the inequality for $S=1$:\n$$\n(1) [4d(C+d)] + C^2 - C - 2d \\le 0\n$$\n$$\n4Cd + 4d^2 + C^2 - C - 2d \\le 0\n$$\nThis expression can be conveniently rearranged as:\n$$\n(C^2 + 4Cd + 4d^2) - (C + 2d) \\le 0\n$$\n$$\n(C + 2d)^2 - (C + 2d) \\le 0\n$$\nLet $Z = C + 2d$. The inequality is $Z^2 - Z \\le 0$, or $Z(Z-1) \\le 0$.\nSince $C = \\frac{a \\Delta t}{h}  0$ and $d = \\frac{\\nu \\Delta t}{h^2}  0$, their sum $Z = C+2d$ must also be positive. For the product $Z(Z-1)$ to be non-positive, we must have $Z-1 \\le 0$, which implies $Z \\le 1$.\nThe condition for stability is therefore:\n$$\nC + 2d \\le 1\n$$\nSubstituting the definitions of $C$ and $d$ back into this inequality:\n$$\n\\frac{a \\Delta t}{h} + 2\\frac{\\nu \\Delta t}{h^2} \\le 1\n$$\nTo find the maximum stable time step, $\\Delta t$, we solve for $\\Delta t$:\n$$\n\\Delta t \\left( \\frac{a}{h} + \\frac{2\\nu}{h^2} \\right) \\le 1\n$$\nSince the term in the parentheses is positive, we can write:\n$$\n\\Delta t \\le \\frac{1}{\\frac{a}{h} + \\frac{2\\nu}{h^2}}\n$$\nCombining the terms in the denominator into a single fraction:\n$$\n\\Delta t \\le \\frac{1}{\\frac{ah + 2\\nu}{h^2}}\n$$\nThus, the maximum stable time step is:\n$$\n\\Delta t_{\\text{max}} = \\frac{h^2}{ah + 2\\nu}\n$$\nThis expression gives the stability limit in terms of the physical and numerical parameters of the problem.",
            "answer": "$$\n\\boxed{\\frac{h^2}{ah + 2\\nu}}\n$$"
        },
        {
            "introduction": "A numerical scheme can be perfectly stable yet produce physically nonsensical results. This exercise  explores this critical distinction by examining the Crank-Nicolson scheme, which is well-known for being unconditionally stable. You will discover that despite its stability, the scheme can lose monotonicity and introduce spurious oscillations, and you will derive the precise condition under which this occurs, connecting it to fundamental matrix properties.",
            "id": "3985733",
            "problem": "Consider the one-dimensional heat conduction equation for a homogeneous rod,\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^{2} u}{\\partial x^{2}},\n$$\non the spatial interval $[0,1]$ with homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(1,t)=0$. Discretize the spatial domain using a uniform grid with $N=2$ interior nodes and standard second-order central differences for the Laplacian. Advance in time with the Crank–Nicolson scheme. Define the non-dimensional parameter $r = \\alpha \\Delta t / \\Delta x^{2}$, where $\\Delta x$ is the uniform grid spacing and $\\Delta t$ is the time step. Monotonicity (discrete maximum principle) refers here to the property that if the current interior temperature vector $u^{n}$ is entrywise nonnegative, then the next-step vector $u^{n+1}$ is also entrywise nonnegative.\n\nStarting from the governing equation and the stated discretizations, derive the $2\\times 2$ linear time-stepping map $u^{n+1} = \\mathbf{T}(r)\\,u^{n}$ for the interior degrees of freedom. Then, using the initial discrete state $u^{n} = \\begin{pmatrix}1  0\\end{pmatrix}^{\\mathsf{T}}$, determine the smallest value of $r$ for which the first interior component of $u^{n+1}$ becomes negative, thereby providing an explicit counterexample to monotonicity at large $\\Delta t$. Express your final answer as a single closed-form expression in terms of radicals, without units. No intermediate inequalities are accepted as the final answer.\n\nAdditionally, explain how the loss of monotonicity is connected to the violation of a matrix monotonicity condition associated with an M-matrix (Monotone-matrix), defined here as a matrix with nonpositive off-diagonal entries whose inverse is entrywise nonnegative. You may reference the Courant–Friedrichs–Lewy (CFL) condition to contrast stability and monotonicity, but do not assume any pre-derived time-stepping formulas; derive all required matrices from the stated fundamentals.\n\nRound nothing; provide the exact expression requested for the threshold in $r$.",
            "solution": "The problem is first validated against the specified criteria.\n\n**Step 1: Extract Givens**\n-   Governing Equation: $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^{2} u}{\\partial x^{2}}$\n-   Spatial Domain: $x \\in [0, 1]$\n-   Boundary Conditions: $u(0,t)=0$ and $u(1,t)=0$ (homogeneous Dirichlet)\n-   Spatial Discretization: Uniform grid with $N=2$ interior nodes. Second-order central differences for the Laplacian.\n-   Temporal Discretization: Crank–Nicolson scheme.\n-   Parameter Definition: $r = \\alpha \\Delta t / \\Delta x^{2}$\n-   Monotonicity Definition: If the current interior temperature vector $u^{n}$ is entrywise nonnegative, then the next-step vector $u^{n+1}$ is also entrywise nonnegative.\n-   Initial Condition for test: $u^{n} = \\begin{pmatrix}1  0\\end{pmatrix}^{\\mathsf{T}}$\n-   Objective 1: Derive the $2\\times 2$ time-stepping map $u^{n+1} = \\mathbf{T}(r)\\,u^{n}$.\n-   Objective 2: Find the smallest value of $r$ for which $u^{n+1}_1  0$ given the test initial condition.\n-   Objective 3: Explain the connection between loss of monotonicity and M-matrix properties.\n-   Objective 4: Contrast monotonicity with stability.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It provides a complete and consistent setup for a standard problem in computational thermal engineering, namely the analysis of the Crank-Nicolson scheme for the $1$D heat equation. The tasks are specific, formalizable, and mathematically verifiable. The problem does not violate any of the invalidity criteria.\n\n**Verdict**\nThe problem is valid.\n\n**Solution Derivation**\n\nWe begin by discretizing the governing partial differential equation.\n\n**Spatial Discretization**\nThe spatial domain is $[0, 1]$. With $N=2$ interior nodes, the total number of grid points is $N+2=4$. Let these points be indexed from $i=0$ to $i=3$. The grid spacing is uniform, so $\\Delta x = \\frac{1-0}{N+1} = \\frac{1}{3}$. The interior nodes are at $x_1 = \\frac{1}{3}$ and $x_2 = \\frac{2}{3}$, with corresponding temperature variables $u_1(t)$ and $u_2(t)$. The boundary conditions impose $u_0(t) = u(0, t) = 0$ and $u_3(t) = u(1, t) = 0$.\n\nThe second-order central difference approximation for the Laplacian $\\frac{\\partial^2 u}{\\partial x^2}$ at an interior node $x_i$ is given by:\n$$ \\left.\\frac{\\partial^2 u}{\\partial x^2}\\right|_{x_i} \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{\\Delta x^2} $$\nApplying this to our two interior nodes:\n-   At $x_1$: $\\frac{u_0 - 2u_1 + u_2}{\\Delta x^2} = \\frac{0 - 2u_1 + u_2}{\\Delta x^2}$\n-   At $x_2$: $\\frac{u_1 - 2u_2 + u_3}{\\Delta x^2} = \\frac{u_1 - 2u_2 + 0}{\\Delta x^2}$\n\nLet $u(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix}$ be the vector of interior temperatures. The system of ordinary differential equations resulting from spatial discretization (the method of lines) is:\n$$ \\frac{d u}{d t} = \\frac{\\alpha}{\\Delta x^2} \\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix} u = \\frac{\\alpha}{\\Delta x^2} \\mathbf{L} u $$\nwhere $\\mathbf{L} = \\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix}$ is the discrete Laplacian matrix for the interior nodes.\n\n**Temporal Discretization: Crank-Nicolson Scheme**\nThe Crank-Nicolson scheme averages the right-hand side at time levels $t_n$ and $t_{n+1}$:\n$$ \\frac{u^{n+1} - u^n}{\\Delta t} = \\frac{1}{2} \\left[ \\left(\\alpha \\frac{\\partial^2 u}{\\partial x^2}\\right)^{n+1} + \\left(\\alpha \\frac{\\partial^2 u}{\\partial x^2}\\right)^n \\right] $$\nSubstituting the matrix form of the spatial discretization:\n$$ \\frac{u^{n+1} - u^n}{\\Delta t} = \\frac{1}{2} \\left( \\frac{\\alpha}{\\Delta x^2} \\mathbf{L} u^{n+1} + \\frac{\\alpha}{\\Delta x^2} \\mathbf{L} u^n \\right) $$\nUsing the non-dimensional parameter $r = \\frac{\\alpha \\Delta t}{\\Delta x^2}$:\n$$ u^{n+1} - u^n = \\frac{r}{2} \\mathbf{L} u^{n+1} + \\frac{r}{2} \\mathbf{L} u^n $$\nRearranging the terms to solve for $u^{n+1}$:\n$$ \\left(\\mathbf{I} - \\frac{r}{2}\\mathbf{L}\\right) u^{n+1} = \\left(\\mathbf{I} + \\frac{r}{2}\\mathbf{L}\\right) u^n $$\nwhere $\\mathbf{I}$ is the $2 \\times 2$ identity matrix.\n\n**Derivation of the Time-Stepping Map $\\mathbf{T}(r)$**\nThe equation is of the form $\\mathbf{A} u^{n+1} = \\mathbf{B} u^n$, where $\\mathbf{A} = \\mathbf{I} - \\frac{r}{2}\\mathbf{L}$ and $\\mathbf{B} = \\mathbf{I} + \\frac{r}{2}\\mathbf{L}$. The time-stepping map is $\\mathbf{T}(r) = \\mathbf{A}^{-1}\\mathbf{B}$.\n\nFirst, we compute $\\mathbf{A}$ and $\\mathbf{B}$:\n$$ \\mathbf{A} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{r}{2}\\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix} = \\begin{pmatrix} 1+r  -r/2 \\\\ -r/2  1+r \\end{pmatrix} $$\n$$ \\mathbf{B} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\frac{r}{2}\\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix} = \\begin{pmatrix} 1-r  r/2 \\\\ r/2  1-r \\end{pmatrix} $$\n\nNext, we find the inverse of $\\mathbf{A}$. The determinant of $\\mathbf{A}$ is:\n$$ \\det(\\mathbf{A}) = (1+r)^2 - \\left(-\\frac{r}{2}\\right)^2 = 1 + 2r + r^2 - \\frac{r^2}{4} = 1 + 2r + \\frac{3}{4}r^2 $$\nThe inverse $\\mathbf{A}^{-1}$ is:\n$$ \\mathbf{A}^{-1} = \\frac{1}{1 + 2r + \\frac{3}{4}r^2} \\begin{pmatrix} 1+r  r/2 \\\\ r/2  1+r \\end{pmatrix} $$\n\nNow, we compute $\\mathbf{T}(r) = \\mathbf{A}^{-1}\\mathbf{B}$:\n$$ \\mathbf{T}(r) = \\frac{1}{1 + 2r + \\frac{3}{4}r^2} \\begin{pmatrix} 1+r  r/2 \\\\ r/2  1+r \\end{pmatrix} \\begin{pmatrix} 1-r  r/2 \\\\ r/2  1-r \\end{pmatrix} $$\nThe matrix product is:\n$$ \\begin{pmatrix} (1+r)(1-r) + (r/2)^2  (1+r)(r/2) + (r/2)(1-r) \\\\ (r/2)(1-r) + (1+r)(r/2)  (r/2)^2 + (1+r)(1-r) \\end{pmatrix} = \\begin{pmatrix} 1-r^2 + \\frac{r^2}{4}  \\frac{r}{2} + \\frac{r^2}{2} + \\frac{r}{2} - \\frac{r^2}{2} \\\\ \\frac{r}{2} - \\frac{r^2}{2} + \\frac{r}{2} + \\frac{r^2}{2}  \\frac{r^2}{4} + 1-r^2 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{3}{4}r^2  r \\\\ r  1 - \\frac{3}{4}r^2 \\end{pmatrix} $$\nSo, the time-stepping map is:\n$$ \\mathbf{T}(r) = \\frac{1}{1 + 2r + \\frac{3}{4}r^2} \\begin{pmatrix} 1 - \\frac{3}{4}r^2  r \\\\ r  1 - \\frac{3}{4}r^2 \\end{pmatrix} $$\n\n**Determining the Critical Value of $r$**\nWe are given the initial state $u^n = \\begin{pmatrix}1  0\\end{pmatrix}^{\\mathsf{T}}$, which is entrywise nonnegative. We compute $u^{n+1} = \\mathbf{T}(r)u^n$:\n$$ u^{n+1} = \\frac{1}{1 + 2r + \\frac{3}{4}r^2} \\begin{pmatrix} 1 - \\frac{3}{4}r^2  r \\\\ r  1 - \\frac{3}{4}r^2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{1 + 2r + \\frac{3}{4}r^2} \\begin{pmatrix} 1 - \\frac{3}{4}r^2 \\\\ r \\end{pmatrix} $$\nThe components of the next state are $u^{n+1}_1 = \\frac{1 - \\frac{3}{4}r^2}{1 + 2r + \\frac{3}{4}r^2}$ and $u^{n+1}_2 = \\frac{r}{1 + 2r + \\frac{3}{4}r^2}$.\nFor $r  0$, the denominator $1 + 2r + \\frac{3}{4}r^2$ is always positive. The component $u^{n+1}_2$ is also always positive. The first component, $u^{n+1}_1$, becomes negative when its numerator becomes negative. The loss of monotonicity for this specific initial condition occurs when $u^{n+1}_1  0$.\nThe threshold condition is $u^{n+1}_1 = 0$, which requires the numerator to be zero:\n$$ 1 - \\frac{3}{4}r^2 = 0 $$\n$$ 1 = \\frac{3}{4}r^2 $$\n$$ r^2 = \\frac{4}{3} $$\nSince $r$ must be positive, we take the positive square root:\n$$ r = \\sqrt{\\frac{4}{3}} = \\frac{2}{\\sqrt{3}} $$\nFor any value of $r$ greater than $\\frac{2}{\\sqrt{3}}$, the component $u^{n+1}_1$ will be negative, thus violating monotonicity. The smallest value of $r$ at which this transition occurs is the threshold value itself.\n\n**Connection to M-Matrices, Monotonicity, and Stability**\nThe scheme is monotone if, for any non-negative vector $u^n$, the resulting vector $u^{n+1} = \\mathbf{T}(r)u^n$ is also non-negative. This holds if and only if the propagator matrix $\\mathbf{T}(r)$ is entrywise non-negative. For $r  0$, the denominator of $\\mathbf{T}(r)$ and its off-diagonal entries are positive. Monotonicity is thus lost when the diagonal entries $1 - \\frac{3}{4}r^2$ become negative. This yields the condition for monotonicity: $1 - \\frac{3}{4}r^2 \\geq 0$, or $r \\le \\frac{2}{\\sqrt{3}}$.\n\nThe problem defines an M-matrix as having nonpositive off-diagonal entries and an entrywise nonnegative inverse. The matrix $\\mathbf{A} = \\mathbf{I} - \\frac{r}{2}\\mathbf{L}$ from the implicit part of the scheme has off-diagonal entries $-r/2 \\le 0$ for $r  0$. Its inverse, $\\mathbf{A}^{-1}$, was shown to be entrywise positive for all $r0$. Therefore, $\\mathbf{A}$ is an M-matrix for all $r  0$. The existence of this M-matrix guarantees that the implicit system for $u^{n+1}$ is always uniquely solvable.\n\nThe loss of monotonicity is the violation of the condition that $\\mathbf{T}(r)$ must be a non-negative matrix. The fact that $\\mathbf{A}$ is an M-matrix (and thus $\\mathbf{A}^{-1} \\ge 0$) is a crucial part of the structure, but it is not sufficient for monotonicity on its own. A common sufficient (but not necessary) condition for monotonicity of the scheme $\\mathbf{A}u^{n+1} = \\mathbf{B}u^n$ is that $\\mathbf{A}$ is an M-matrix and $\\mathbf{B}$ is a non-negative matrix. In our case, $\\mathbf{B} = \\begin{pmatrix} 1-r  r/2 \\\\ r/2  1-r \\end{pmatrix}$ is non-negative only if $1-r \\ge 0$, i.e., $r \\le 1$. Our analysis shows that monotonicity actually holds up to a larger value, $r \\le \\frac{2}{\\sqrt{3}} \\approx 1.1547$. The loss of monotonicity is therefore directly tied to the propagator $\\mathbf{T}(r) = \\mathbf{A}^{-1}\\mathbf{B}$ ceasing to be a non-negative matrix, which occurs at the identified critical value of $r$.\n\nFinally, we contrast this with stability. The Crank-Nicolson scheme is unconditionally stable in the von Neumann sense, meaning the magnitude of the amplification factor is less than or equal to $1$ for all $r  0$. This ensures that numerical errors do not grow unboundedly. However, as derived, the scheme is only conditionally monotone. For $r  \\frac{2}{\\sqrt{3}}$, the scheme is stable but not monotone, permitting physically unrealistic oscillations (e.g., negative temperatures from positive initial data) to appear in the solution even though their amplitude does not grow. The Courant–Friedrichs–Lewy (CFL) condition, typically a stability constraint, does not limit the time step for stability in this case. However, a similar-looking constraint on $r$ arises from the requirement of monotonicity, which is often a more desirable property for diffusion problems than stability alone.",
            "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{3}}}\n$$"
        },
        {
            "introduction": "Choosing a time step for a real-world simulation involves balancing the demands of numerical stability with the need for physical accuracy. This problem  moves from pure theory to practical application, requiring you to select an optimal time step that satisfies two distinct criteria. You must not only enforce the CFL and diffusive stability limits but also ensure the time step is small enough to adequately resolve the fastest physical transport phenomena occurring on the grid, a common task for any computational scientist or engineer.",
            "id": "3985787",
            "problem": "A one-dimensional transient thermal transport in a uniform, incompressible, thermally homogeneous flow is modeled on the spatial interval $[0,L]$ by the advection–diffusion energy equation\n$$\n\\frac{\\partial T}{\\partial t} + a\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2},\n$$\nwhere $T(x,t)$ is temperature, $a0$ is a constant flow speed, and $\\alpha0$ is the constant thermal diffusivity. Consider a uniform spatial grid with spacing $h$ and a fully explicit time integration using forward Euler in time. The spatial advection term is discretized by a first-order upwind difference consistent with $a0$, and the diffusion term by a second-order centered difference. Assume interior stability can be assessed by a Fourier (von Neumann) mode analysis under periodicity of the discrete operator.\n\nYou will choose a single global time step $\\Delta t$ to advance the explicit scheme. Your choice must satisfy two requirements simultaneously:\n\n- Linear stability of the explicit scheme for all Fourier modes under the stated discretizations.\n- Resolution of the shortest physically relevant grid-scale time among advection and diffusion, in the following sense: the discrete time step must produce at least $5$ resolved time levels across the fastest grid-scale transport process. Define the grid-scale advection time as the time a material element needs to traverse one grid cell, and define the grid-scale diffusion time as the time needed for thermal diffusion to spread over a distance comparable to one grid cell. Use fundamental definitions (for advection, $v = dx/dt$; for diffusion, the diffusive length scaling $\\ell \\sim \\sqrt{\\alpha t}$) to identify the relevant time scales.\n\nGiven the parameters $h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $a = 0.5\\,\\mathrm{m/s}$, and $\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$, which of the following choices for $\\Delta t$ is the largest value that meets both the stability requirement arising from the discretization and the resolution requirement described above? Justify your choice based on first principles and the appropriate stability reasoning, including the Courant–Friedrichs–Lewy (CFL) condition and any diffusion-related constraint emerging from the Fourier analysis.\n\n- A. $\\Delta t = 2.0 \\times 10^{-3}\\,\\mathrm{s}$\n\n- B. $\\Delta t = 4.0 \\times 10^{-4}\\,\\mathrm{s}$\n\n- C. $\\Delta t = 5.0 \\times 10^{-2}\\,\\mathrm{s}$\n\n- D. $\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$",
            "solution": "The problem statement is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The one-dimensional advection–diffusion equation is given as $\\frac{\\partial T}{\\partial t} + a\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2}$.\n- **Parameters**:\n    - Flow speed: $a  0$, constant.\n    - Thermal diffusivity: $\\alpha  0$, constant.\n    - Grid spacing: $h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$.\n    - Flow speed value: $a = 0.5\\,\\mathrm{m/s}$.\n    - Thermal diffusivity value: $\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$.\n- **Discretization Scheme**:\n    - Time: Fully explicit, forward Euler.\n    - Advection term ($\\partial T/\\partial x$): First-order upwind difference for $a0$.\n    - Diffusion term ($\\partial^2 T/\\partial x^2$): Second-order centered difference.\n- **Requirements for the time step $\\Delta t$**:\n    1.  **Stability**: The scheme must be linearly stable for all Fourier modes.\n    2.  **Resolution**: The time step must provide at least $5$ resolved time levels across the fastest grid-scale transport process.\n        -   Grid-scale advection time ($\\tau_{adv}$): time to traverse one grid cell, defined by $v = dx/dt$.\n        -   Grid-scale diffusion time ($\\tau_{diff}$): time for diffusion to spread over a distance of one grid cell, defined by $\\ell \\sim \\sqrt{\\alpha t}$.\n- **Objective**: Find the largest value of $\\Delta t$ from the options that satisfies both requirements.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a standard setup in computational thermal engineering. The advection-diffusion equation is a fundamental physical model. The numerical methods (Forward Euler, upwind, central differencing) and stability analysis (von Neumann) are canonical topics in numerical analysis for PDEs. The problem is scientifically valid.\n- **Well-Posed**: The problem provides all necessary data and definitions to establish two clear, quantitative constraints on the time step $\\Delta t$. The task to find the largest option satisfying these constraints is unambiguous and leads to a unique solution.\n- **Objective**: The problem is stated in precise mathematical and physical terms, free from any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. The solution process will now proceed.\n\n### Derivation of the Solution\n\nThe solution requires satisfying two distinct constraints on the time step $\\Delta t$. We will derive each constraint separately and then combine them to find the most restrictive bound.\n\n**1. Requirement 1: Linear Stability**\n\nThe governing partial differential equation is:\n$$\n\\frac{\\partial T}{\\partial t} + a\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2}\n$$\nLet $T_j^n$ represent the temperature at spatial grid point $j$ and time level $n$, where $x_j = j h$ and $t_n = n \\Delta t$. The specified discretization schemes are:\n- Forward Euler in time: $\\frac{\\partial T}{\\partial t} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}$\n- First-order upwind for advection (since $a0$): $a\\,\\frac{\\partial T}{\\partial x} \\approx a\\,\\frac{T_j^n - T_{j-1}^n}{h}$\n- Second-order centered difference for diffusion: $\\alpha\\,\\frac{\\partial^2 T}{\\partial x^2} \\approx \\alpha\\,\\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{h^2}$\n\nSubstituting these into the PDE gives the fully discrete equation:\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} + a\\,\\frac{T_j^n - T_{j-1}^n}{h} = \\alpha\\,\\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{h^2}\n$$\nSolving for $T_j^{n+1}$:\n$$\nT_j^{n+1} = T_j^n - \\frac{a \\Delta t}{h}(T_j^n - T_{j-1}^n) + \\frac{\\alpha \\Delta t}{h^2}(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\nWe define the Courant number $C = \\frac{a \\Delta t}{h}$ and the diffusion number $d = \\frac{\\alpha \\Delta t}{h^2}$. The equation becomes:\n$$\nT_j^{n+1} = T_j^n - C(T_j^n - T_{j-1}^n) + d(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n$$\nT_j^{n+1} = (1 - C - 2d)T_j^n + (C+d)T_{j-1}^n + d T_{j+1}^n\n$$\nFor von Neumann stability analysis, we substitute a Fourier mode $T_j^n = G^n e^{i k x_j} = G^n e^{i \\theta j}$, where $\\theta = k h$ is the dimensionless wavenumber. This yields the amplification factor $G$:\n$$\nG = (1 - C - 2d) + (C+d)e^{-i\\theta} + d e^{i\\theta}\n$$\nThe stability condition is $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$. A widely-known necessary and sufficient condition for this specific scheme is derived from requiring $|G(\\theta)| \\le 1$ for all $\\theta$. The most stringent constraint arises at $\\theta = \\pi$, which results in the condition:\n$$\nC + 2d \\leq 1\n$$\nSubstituting the definitions of $C$ and $d$:\n$$\n\\frac{a \\Delta t}{h} + \\frac{2\\alpha \\Delta t}{h^2} \\leq 1\n$$\n$$\n\\Delta t \\left( \\frac{a}{h} + \\frac{2\\alpha}{h^2} \\right) \\leq 1\n$$\nThis gives the stability constraint on $\\Delta t$:\n$$\n\\Delta t \\leq \\frac{1}{\\frac{a}{h} + \\frac{2\\alpha}{h^2}}\n$$\nUsing the given parameter values:\n- $h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$\n- $a = 0.5\\,\\mathrm{m/s}$\n- $\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n\nWe calculate the terms in the denominator:\n$$\n\\frac{a}{h} = \\frac{0.5\\,\\mathrm{m/s}}{1.0 \\times 10^{-3}\\,\\mathrm{m}} = 500\\,\\mathrm{s}^{-1}\n$$\n$$\n\\frac{2\\alpha}{h^2} = \\frac{2 \\times (1.0 \\times 10^{-5}\\,\\mathrm{m^2/s})}{(1.0 \\times 10^{-3}\\,\\mathrm{m})^2} = \\frac{2.0 \\times 10^{-5}}{1.0 \\times 10^{-6}}\\,\\mathrm{s}^{-1} = 20\\,\\mathrm{s}^{-1}\n$$\nThe maximum time step allowed by stability is:\n$$\n\\Delta t_{stability} \\leq \\frac{1}{500\\,\\mathrm{s}^{-1} + 20\\,\\mathrm{s}^{-1}} = \\frac{1}{520}\\,\\mathrm{s} \\approx 1.923 \\times 10^{-3}\\,\\mathrm{s}\n$$\n\n**2. Requirement 2: Temporal Resolution**\n\nThis requirement constrains $\\Delta t$ based on resolving physical time scales. We must identify the shortest characteristic time for transport over a single grid cell.\n\n- **Grid-scale advection time ($\\tau_{adv}$)**: The time for a fluid element to travel a distance $h$ at speed $a$.\n$$\n\\tau_{adv} = \\frac{h}{a} = \\frac{1.0 \\times 10^{-3}\\,\\mathrm{m}}{0.5\\,\\mathrm{m/s}} = 2.0 \\times 10^{-3}\\,\\mathrm{s}\n$$\n\n- **Grid-scale diffusion time ($\\tau_{diff}$)**: The time for heat to diffuse over a characteristic distance $h$, based on the scaling $\\ell \\sim \\sqrt{\\alpha t}$. Setting $\\ell = h$ and $t=\\tau_{diff}$:\n$$\nh^2 = \\alpha \\tau_{diff} \\implies \\tau_{diff} = \\frac{h^2}{\\alpha} = \\frac{(1.0 \\times 10^{-3}\\,\\mathrm{m})^2}{1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}} = \\frac{1.0 \\times 10^{-6}}{1.0 \\times 10^{-5}}\\,\\mathrm{s} = 0.1\\,\\mathrm{s}\n$$\n\nThe fastest (i.e., shortest) of these two time scales is:\n$$\n\\tau_{fastest} = \\min(\\tau_{adv}, \\tau_{diff}) = \\min(2.0 \\times 10^{-3}\\,\\mathrm{s}, 0.1\\,\\mathrm{s}) = 2.0 \\times 10^{-3}\\,\\mathrm{s}\n$$\nThe resolution requirement states there must be at least $5$ time steps within this fastest time scale:\n$$\n5 \\Delta t \\leq \\tau_{fastest}\n$$\n$$\n\\Delta t \\leq \\frac{\\tau_{fastest}}{5} = \\frac{2.0 \\times 10^{-3}\\,\\mathrm{s}}{5} = 0.4 \\times 10^{-3}\\,\\mathrm{s} = 4.0 \\times 10^{-4}\\,\\mathrm{s}\n$$\nSo, the resolution constraint is $\\Delta t_{resolution} \\leq 4.0 \\times 10^{-4}\\,\\mathrm{s}$.\n\n**3. Overall Constraint and Option Evaluation**\n\nTo satisfy both requirements simultaneously, $\\Delta t$ must be less than or equal to the minimum of the two derived bounds:\n$$\n\\Delta t \\leq \\min(\\Delta t_{stability}, \\Delta t_{resolution})\n$$\n$$\n\\Delta t \\leq \\min(1.923 \\times 10^{-3}\\,\\mathrm{s}, 4.0 \\times 10^{-4}\\,\\mathrm{s})\n$$\n$$\n\\Delta t \\leq 4.0 \\times 10^{-4}\\,\\mathrm{s}\n$$\nThe resolution requirement is the more restrictive constraint. The largest possible time step that satisfies both conditions is $\\Delta t_{max} = 4.0 \\times 10^{-4}\\,\\mathrm{s}$. We now evaluate the given options against this limit.\n\n- **A. $\\Delta t = 2.0 \\times 10^{-3}\\,\\mathrm{s}$**: This value is $20.0 \\times 10^{-4}\\,\\mathrm{s}$. Since $20.0 \\times 10^{-4}\\,\\mathrm{s}  4.0 \\times 10^{-4}\\,\\mathrm{s}$, this option violates the resolution constraint. It also violates the stability constraint ($2.0 \\times 10^{-3}\\,\\mathrm{s}  1.923 \\times 10^{-3}\\,\\mathrm{s}$). **Incorrect**.\n\n- **B. $\\Delta t = 4.0 \\times 10^{-4}\\,\\mathrm{s}$**: This value is exactly equal to the maximum allowed time step, $\\Delta t_{max}$. It satisfies both the resolution constraint ($\\Delta t \\le 4.0 \\times 10^{-4}\\,\\mathrm{s}$) and the stability constraint ($\\Delta t \\le 1.923 \\times 10^{-3}\\,\\mathrm{s}$). This is a valid choice. **Correct**.\n\n- **C. $\\Delta t = 5.0 \\times 10^{-2}\\,\\mathrm{s}$**: This value is $500 \\times 10^{-4}\\,\\mathrm{s}$. This is far larger than $\\Delta t_{max}$ and violates both constraints. **Incorrect**.\n\n- **D. $\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$**: This value is less than $\\Delta t_{max}$. Since $1.0 \\times 10^{-4}\\,\\mathrm{s}  4.0 \\times 10^{-4}\\,\\mathrm{s}$, it satisfies both constraints and is a valid choice. **Correct**.\n\nThe question asks for the **largest value** from the options that meets both requirements. Between the two valid options, B ($\\Delta t = 4.0 \\times 10^{-4}\\,\\mathrm{s}$) and D ($\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$), option B is the larger value.",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}