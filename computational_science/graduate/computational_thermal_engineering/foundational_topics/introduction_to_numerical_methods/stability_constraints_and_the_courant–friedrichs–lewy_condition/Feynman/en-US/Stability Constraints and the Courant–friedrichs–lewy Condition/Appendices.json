{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a foundational walkthrough of von Neumann stability analysis, a cornerstone technique in computational fluid dynamics. By analyzing the amplification of Fourier modes for a combined advection-diffusion problem, you will derive the maximum stable time step from first principles. Mastering this process is essential for understanding how numerical schemes can introduce instabilities and how to formulate the constraints needed to prevent them. ",
            "id": "3985772",
            "problem": "Consider one-dimensional thermal transport in a uniform, incompressible flow, modeled by the linear advection–diffusion equation for temperature $u(x,t)$,\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}},\n$$\nwhere $a>0$ is a constant advection speed and $\\nu>0$ is the constant thermal diffusivity. Assume a periodic domain and a uniform spatial grid $x_j = j\\,h$ with spacing $h>0$. You are to advance the solution in time using an explicit forward Euler scheme. For spatial discretization, use a first-order upwind approximation for the advection term (appropriate for $a>0$) and a second-order centered approximation for the diffusion term, resulting in the update\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\frac{a\\,\\Delta t}{h}\\left(u_j^n - u_{j-1}^n\\right) \\;+\\; \\frac{\\nu\\,\\Delta t}{h^2}\\left(u_{j+1}^n - 2\\,u_j^n + u_{j-1}^n\\right).\n$$\nStarting from the partial differential equation and these standard discretizations, perform a Fourier (von Neumann) stability analysis under the assumption of periodicity. Derive the amplification factor and enforce the condition that its magnitude does not exceed $1$ for all resolvable wavenumbers. From this requirement, determine the maximum stable time step $\\Delta t$ as a closed-form expression in terms of the parameters $a$, $\\nu$, and $h$.\n\nExpress your final $\\Delta t$ in seconds. No numerical values are provided; give the exact analytic expression. No rounding is required.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\nThe given information is as follows:\n- **Partial Differential Equation (PDE)**: The one-dimensional linear advection–diffusion equation for temperature $u(x,t)$:\n$$\n\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} \\;=\\; \\nu\\,\\frac{\\partial^{2}u}{\\partial x^{2}}\n$$\n- **Constants**: Advection speed $a>0$ and thermal diffusivity $\\nu>0$.\n- **Domain and Grid**: A periodic domain with a uniform spatial grid $x_j = j\\,h$, where $h>0$ is the grid spacing.\n- **Numerical Scheme**: The time integration is performed using an explicit forward Euler scheme. The spatial derivatives are approximated using a first-order upwind scheme for the advection term ($\\frac{\\partial u}{\\partial x}$) and a second-order centered difference scheme for the diffusion term ($\\frac{\\partial^2 u}{\\partial x^2}$).\n- **Finite Difference Equation (FDE)**: The resulting discrete update rule is provided as:\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\frac{a\\,\\Delta t}{h}\\left(u_j^n - u_{j-1}^n\\right) \\;+\\; \\frac{\\nu\\,\\Delta t}{h^2}\\left(u_{j+1}^n - 2\\,u_j^n + u_{j-1}^n\\right)\n$$\nwhere $\\Delta t$ is the time step.\n- **Task**: Perform a Fourier (von Neumann) stability analysis to find the maximum stable time step $\\Delta t$ as a closed-form expression in terms of $a$, $\\nu$, and $h$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the advection-diffusion equation, a fundamental model in transport phenomena. The numerical methods described (forward Euler, upwind, central difference) and the analysis technique (von Neumann stability analysis) are standard, well-established tools in computational physics and engineering. The problem is entirely scientifically sound.\n- **Well-Posed**: The problem is clearly defined. It specifies the governing equation, the numerical scheme, and the analytical method to be used. The objective is to derive a specific quantity, the stability limit, which is expected to be unique for the given scheme.\n- **Objective**: The problem is expressed in precise mathematical language, free from any subjectivity or ambiguity.\n- **Completeness and Consistency**: All necessary information is provided. The PDE and the corresponding FDE are given and are consistent with the described discretization methods. The constraints $a>0$, $\\nu>0$, and $h>0$ are physically meaningful and mathematically necessary.\n- **Realism**: The setup is a standard model for computational thermal engineering problems.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. A solution will be provided.\n\n### Solution Derivation\nTo perform the von Neumann stability analysis, we consider a single Fourier mode of the numerical solution on the grid. We express the solution at grid point $j$ and time step $n$ as:\n$$\nu_j^n = \\hat{u}^n(k) \\, e^{i k x_j} = \\hat{u}^n(k) \\, e^{i k j h}\n$$\nwhere $k$ is the wavenumber, $i$ is the imaginary unit, and $\\hat{u}^n(k)$ is the amplitude of the mode at time step $n$. The stability of the scheme depends on the amplification factor, $G(k)$, which relates the amplitudes at successive time steps:\n$$\n\\hat{u}^{n+1}(k) = G(k) \\, \\hat{u}^n(k)\n$$\nSubstituting the Fourier mode representation into the finite difference equation, we have:\n$$\nG(k) \\hat{u}^n(k) e^{i k j h} = \\hat{u}^n(k) e^{i k j h} - \\frac{a \\Delta t}{h} \\left( \\hat{u}^n(k) e^{i k j h} - \\hat{u}^n(k) e^{i k (j-1) h} \\right) + \\frac{\\nu \\Delta t}{h^2} \\left( \\hat{u}^n(k) e^{i k (j+1) h} - 2 \\hat{u}^n(k) e^{i k j h} + \\hat{u}^n(k) e^{i k (j-1) h} \\right)\n$$\nWe can cancel the common factor $\\hat{u}^n(k) e^{i k j h}$ from all terms:\n$$\nG(k) = 1 - \\frac{a \\Delta t}{h} (1 - e^{-i k h}) + \\frac{\\nu \\Delta t}{h^2} (e^{i k h} - 2 + e^{-i k h})\n$$\nLet's define two dimensionless numbers: the Courant number, $C = \\frac{a \\Delta t}{h}$, and the diffusion number, $d = \\frac{\\nu \\Delta t}{h^2}$. Let $\\theta = k h$. The expression for the amplification factor becomes:\n$$\nG(\\theta) = 1 - C (1 - e^{-i \\theta}) + d (e^{i \\theta} - 2 + e^{-i \\theta})\n$$\nUsing Euler's identity ($e^{i\\phi} = \\cos\\phi + i\\sin\\phi$), we can simplify the terms:\n$$\n1 - e^{-i \\theta} = 1 - (\\cos\\theta - i\\sin\\theta) = 1 - \\cos\\theta + i\\sin\\theta\n$$\n$$\ne^{i \\theta} - 2 + e^{-i \\theta} = (\\cos\\theta + i\\sin\\theta) - 2 + (\\cos\\theta - i\\sin\\theta) = 2\\cos\\theta - 2\n$$\nSubstituting these back into the expression for $G(\\theta)$:\n$$\nG(\\theta) = 1 - C(1 - \\cos\\theta + i\\sin\\theta) + d(2\\cos\\theta - 2)\n$$\nSeparating the real and imaginary parts:\n$$\nG(\\theta) = [1 - C(1 - \\cos\\theta) - 2d(1 - \\cos\\theta)] - i[C\\sin\\theta]\n$$\n$$\nG(\\theta) = [1 - (C + 2d)(1 - \\cos\\theta)] - i[C\\sin\\theta]\n$$\nFor the numerical scheme to be stable, the magnitude of the amplification factor must not exceed $1$ for any possible wavenumber, i.e., $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$. This is equivalent to $|G(\\theta)|^2 \\le 1$.\n$$\n|G(\\theta)|^2 = [1 - (C + 2d)(1 - \\cos\\theta)]^2 + (C\\sin\\theta)^2 \\le 1\n$$\nExpanding the expression:\n$$\n1 - 2(C + 2d)(1 - \\cos\\theta) + (C + 2d)^2(1 - \\cos\\theta)^2 + C^2\\sin^2\\theta \\le 1\n$$\nSubtracting $1$ from both sides and simplifying:\n$$\n-2(C + 2d)(1 - \\cos\\theta) + (C + 2d)^2(1 - \\cos\\theta)^2 + C^2\\sin^2\\theta \\le 0\n$$\nTo simplify this expression, we use the half-angle identity $1 - \\cos\\theta = 2\\sin^2(\\frac{\\theta}{2})$ and the identity $\\sin^2\\theta = 4\\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2}) = 4\\sin^2(\\frac{\\theta}{2})(1-\\sin^2(\\frac{\\theta}{2}))$. Let $S = \\sin^2(\\frac{\\theta}{2})$. The inequality becomes:\n$$\n-2(C + 2d)(2S) + (C + 2d)^2(2S)^2 + C^2(4S(1-S)) \\le 0\n$$\nFor $S \\ne 0$ (i.e., for non-zero wavenumbers), we can divide by $4S$:\n$$\n-(C + 2d) + S(C + 2d)^2 + C^2(1-S) \\le 0\n$$\nRearranging the terms based on $S$:\n$$\nS [(C + 2d)^2 - C^2] + [C^2 - (C + 2d)] \\le 0\n$$\nSimplifying the coefficient of $S$:\n$$\n(C + 2d)^2 - C^2 = C^2 + 4Cd + 4d^2 - C^2 = 4Cd + 4d^2 = 4d(C+d)\n$$\nThe inequality is now:\n$$\nS [4d(C+d)] + C^2 - C - 2d \\le 0\n$$\nThis inequality must hold for all resolvable modes. The range of $\\theta$ is $[-\\pi, \\pi]$, which means $\\frac{\\theta}{2}$ is in $[-\\frac{\\pi}{2}, \\frac{\\pi}{2}]$, and therefore $S = \\sin^2(\\frac{\\theta}{2})$ is in $[0, 1]$.\nSince $a, \\nu, h, \\Delta t$ are all positive, $C>0$ and $d>0$. The coefficient of $S$, which is $4d(C+d)$, is therefore positive. This means the left-hand side of the inequality is a monotonically increasing function of $S$. The most restrictive condition (the maximum value of the left-hand side) occurs when $S$ is at its maximum value, $S=1$ (corresponding to the highest frequency mode with $\\theta=\\pi$). We must enforce the inequality for $S=1$:\n$$\n(1) [4d(C+d)] + C^2 - C - 2d \\le 0\n$$\n$$\n4Cd + 4d^2 + C^2 - C - 2d \\le 0\n$$\nThis expression can be conveniently rearranged as:\n$$\n(C^2 + 4Cd + 4d^2) - (C + 2d) \\le 0\n$$\n$$\n(C + 2d)^2 - (C + 2d) \\le 0\n$$\nLet $Z = C + 2d$. The inequality is $Z^2 - Z \\le 0$, or $Z(Z-1) \\le 0$.\nSince $C = \\frac{a \\Delta t}{h} > 0$ and $d = \\frac{\\nu \\Delta t}{h^2} > 0$, their sum $Z = C+2d$ must also be positive. For the product $Z(Z-1)$ to be non-positive, we must have $Z-1 \\le 0$, which implies $Z \\le 1$.\nThe condition for stability is therefore:\n$$\nC + 2d \\le 1\n$$\nSubstituting the definitions of $C$ and $d$ back into this inequality:\n$$\n\\frac{a \\Delta t}{h} + 2\\frac{\\nu \\Delta t}{h^2} \\le 1\n$$\nTo find the maximum stable time step, $\\Delta t$, we solve for $\\Delta t$:\n$$\n\\Delta t \\left( \\frac{a}{h} + \\frac{2\\nu}{h^2} \\right) \\le 1\n$$\nSince the term in the parentheses is positive, we can write:\n$$\n\\Delta t \\le \\frac{1}{\\frac{a}{h} + \\frac{2\\nu}{h^2}}\n$$\nCombining the terms in the denominator into a single fraction:\n$$\n\\Delta t \\le \\frac{1}{\\frac{ah + 2\\nu}{h^2}}\n$$\nThus, the maximum stable time step is:\n$$\n\\Delta t_{\\text{max}} = \\frac{h^2}{ah + 2\\nu}\n$$\nThis expression gives the stability limit in terms of the physical and numerical parameters of the problem.",
            "answer": "$$\n\\boxed{\\frac{h^2}{ah + 2\\nu}}\n$$"
        },
        {
            "introduction": "Beyond ensuring numerical stability, a reliable simulation must also accurately resolve the underlying physics. This practice problem moves from pure stability analysis to the practical art of time step selection, where you must balance the mathematical constraint from the numerical scheme against the physical requirement to capture the fastest relevant time scales in the system. This exercise highlights the crucial distinction between a stable solution and a physically meaningful one, a key consideration in all simulation work. ",
            "id": "3985787",
            "problem": "A one-dimensional transient thermal transport in a uniform, incompressible, thermally homogeneous flow is modeled on the spatial interval $[0,L]$ by the advection–diffusion energy equation\n$$\n\\frac{\\partial T}{\\partial t} + a\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2},\n$$\nwhere $T(x,t)$ is temperature, $a>0$ is a constant flow speed, and $\\alpha>0$ is the constant thermal diffusivity. Consider a uniform spatial grid with spacing $h$ and a fully explicit time integration using forward Euler in time. The spatial advection term is discretized by a first-order upwind difference consistent with $a>0$, and the diffusion term by a second-order centered difference. Assume interior stability can be assessed by a Fourier (von Neumann) mode analysis under periodicity of the discrete operator.\n\nYou will choose a single global time step $\\Delta t$ to advance the explicit scheme. Your choice must satisfy two requirements simultaneously:\n\n- Linear stability of the explicit scheme for all Fourier modes under the stated discretizations.\n- Resolution of the shortest physically relevant grid-scale time among advection and diffusion, in the following sense: the discrete time step must produce at least $5$ resolved time levels across the fastest grid-scale transport process. Define the grid-scale advection time as the time a material element needs to traverse one grid cell, and define the grid-scale diffusion time as the time needed for thermal diffusion to spread over a distance comparable to one grid cell. Use fundamental definitions (for advection, $v = dx/dt$; for diffusion, the diffusive length scaling $\\ell \\sim \\sqrt{\\alpha t}$) to identify the relevant time scales.\n\nGiven the parameters $h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $a = 0.5\\,\\mathrm{m/s}$, and $\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$, which of the following choices for $\\Delta t$ is the largest value that meets both the stability requirement arising from the discretization and the resolution requirement described above? Justify your choice based on first principles and the appropriate stability reasoning, including the Courant–Friedrichs–Lewy (CFL) condition and any diffusion-related constraint emerging from the Fourier analysis.\n\nA. $\\Delta t = 2.0 \\times 10^{-3}\\,\\mathrm{s}$\n\nB. $\\Delta t = 4.0 \\times 10^{-4}\\,\\mathrm{s}$\n\nC. $\\Delta t = 5.0 \\times 10^{-2}\\,\\mathrm{s}$\n\nD. $\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$",
            "solution": "The problem statement is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The one-dimensional advection–diffusion equation is given as $\\frac{\\partial T}{\\partial t} + a\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2}$.\n- **Parameters**:\n    - Flow speed: $a > 0$, constant.\n    - Thermal diffusivity: $\\alpha > 0$, constant.\n    - Grid spacing: $h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$.\n    - Flow speed value: $a = 0.5\\,\\mathrm{m/s}$.\n    - Thermal diffusivity value: $\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$.\n- **Discretization Scheme**:\n    - Time: Fully explicit, forward Euler.\n    - Advection term ($\\partial T/\\partial x$): First-order upwind difference for $a>0$.\n    - Diffusion term ($\\partial^2 T/\\partial x^2$): Second-order centered difference.\n- **Requirements for the time step $\\Delta t$**:\n    1.  **Stability**: The scheme must be linearly stable for all Fourier modes.\n    2.  **Resolution**: The time step must provide at least $5$ resolved time levels across the fastest grid-scale transport process.\n        -   Grid-scale advection time ($\\tau_{adv}$): time to traverse one grid cell, defined by $v = dx/dt$.\n        -   Grid-scale diffusion time ($\\tau_{diff}$): time for diffusion to spread over a distance of one grid cell, defined by $\\ell \\sim \\sqrt{\\alpha t}$.\n- **Objective**: Find the largest value of $\\Delta t$ from the options that satisfies both requirements.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a standard setup in computational thermal engineering. The advection-diffusion equation is a fundamental physical model. The numerical methods (Forward Euler, upwind, central differencing) and stability analysis (von Neumann) are canonical topics in numerical analysis for PDEs. The problem is scientifically valid.\n- **Well-Posed**: The problem provides all necessary data and definitions to establish two clear, quantitative constraints on the time step $\\Delta t$. The task to find the largest option satisfying these constraints is unambiguous and leads to a unique solution.\n- **Objective**: The problem is stated in precise mathematical and physical terms, free from any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. The solution process will now proceed.\n\n### Derivation of the Solution\n\nThe solution requires satisfying two distinct constraints on the time step $\\Delta t$. We will derive each constraint separately and then combine them to find the most restrictive bound.\n\n**1. Requirement 1: Linear Stability**\n\nThe governing partial differential equation is:\n$$\n\\frac{\\partial T}{\\partial t} + a\\,\\frac{\\partial T}{\\partial x} = \\alpha\\,\\frac{\\partial^2 T}{\\partial x^2}\n$$\nLet $T_j^n$ represent the temperature at spatial grid point $j$ and time level $n$, where $x_j = j h$ and $t_n = n \\Delta t$. The specified discretization schemes are:\n- Forward Euler in time: $\\frac{\\partial T}{\\partial t} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}$\n- First-order upwind for advection (since $a>0$): $a\\,\\frac{\\partial T}{\\partial x} \\approx a\\,\\frac{T_j^n - T_{j-1}^n}{h}$\n- Second-order centered difference for diffusion: $\\alpha\\,\\frac{\\partial^2 T}{\\partial x^2} \\approx \\alpha\\,\\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{h^2}$\n\nSubstituting these into the PDE gives the fully discrete equation:\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} + a\\,\\frac{T_j^n - T_{j-1}^n}{h} = \\alpha\\,\\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{h^2}\n$$\nSolving for $T_j^{n+1}$:\n$$\nT_j^{n+1} = T_j^n - \\frac{a \\Delta t}{h}(T_j^n - T_{j-1}^n) + \\frac{\\alpha \\Delta t}{h^2}(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\nWe define the Courant number $C = \\frac{a \\Delta t}{h}$ and the diffusion number $d = \\frac{\\alpha \\Delta t}{h^2}$. The equation becomes:\n$$\nT_j^{n+1} = T_j^n - C(T_j^n - T_{j-1}^n) + d(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n$$\nT_j^{n+1} = (1 - C - 2d)T_j^n + (C+d)T_{j-1}^n + d T_{j+1}^n\n$$\nFor von Neumann stability analysis, we substitute a Fourier mode $T_j^n = G^n e^{i k x_j} = G^n e^{i \\theta j}$, where $\\theta = k h$ is the dimensionless wavenumber. This yields the amplification factor $G$:\n$$\nG = (1 - C - 2d) + (C+d)e^{-i\\theta} + d e^{i\\theta}\n$$\nThe stability condition is $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$. A widely-known necessary and sufficient condition for this specific scheme is derived from requiring $|G(\\theta)| \\le 1$ for all $\\theta$. The most stringent constraint arises at $\\theta = \\pi$, which results in the condition:\n$$\nC + 2d \\leq 1\n$$\nSubstituting the definitions of $C$ and $d$:\n$$\n\\frac{a \\Delta t}{h} + \\frac{2\\alpha \\Delta t}{h^2} \\leq 1\n$$\n$$\n\\Delta t \\left( \\frac{a}{h} + \\frac{2\\alpha}{h^2} \\right) \\leq 1\n$$\nThis gives the stability constraint on $\\Delta t$:\n$$\n\\Delta t \\leq \\frac{1}{\\frac{a}{h} + \\frac{2\\alpha}{h^2}}\n$$\nUsing the given parameter values:\n- $h = 1.0 \\times 10^{-3}\\,\\mathrm{m}$\n- $a = 0.5\\,\\mathrm{m/s}$\n- $\\alpha = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n\nWe calculate the terms in the denominator:\n$$\n\\frac{a}{h} = \\frac{0.5\\,\\mathrm{m/s}}{1.0 \\times 10^{-3}\\,\\mathrm{m}} = 500\\,\\mathrm{s}^{-1}\n$$\n$$\n\\frac{2\\alpha}{h^2} = \\frac{2 \\times (1.0 \\times 10^{-5}\\,\\mathrm{m^2/s})}{(1.0 \\times 10^{-3}\\,\\mathrm{m})^2} = \\frac{2.0 \\times 10^{-5}}{1.0 \\times 10^{-6}}\\,\\mathrm{s}^{-1} = 20\\,\\mathrm{s}^{-1}\n$$\nThe maximum time step allowed by stability is:\n$$\n\\Delta t_{stability} \\leq \\frac{1}{500\\,\\mathrm{s}^{-1} + 20\\,\\mathrm{s}^{-1}} = \\frac{1}{520}\\,\\mathrm{s} \\approx 1.923 \\times 10^{-3}\\,\\mathrm{s}\n$$\n\n**2. Requirement 2: Temporal Resolution**\n\nThis requirement constrains $\\Delta t$ based on resolving physical time scales. We must identify the shortest characteristic time for transport over a single grid cell.\n\n- **Grid-scale advection time ($\\tau_{adv}$)**: The time for a fluid element to travel a distance $h$ at speed $a$.\n$$\n\\tau_{adv} = \\frac{h}{a} = \\frac{1.0 \\times 10^{-3}\\,\\mathrm{m}}{0.5\\,\\mathrm{m/s}} = 2.0 \\times 10^{-3}\\,\\mathrm{s}\n$$\n\n- **Grid-scale diffusion time ($\\tau_{diff}$)**: The time for heat to diffuse over a characteristic distance $h$, based on the scaling $\\ell \\sim \\sqrt{\\alpha t}$. Setting $\\ell = h$ and $t=\\tau_{diff}$:\n$$\nh^2 = \\alpha \\tau_{diff} \\implies \\tau_{diff} = \\frac{h^2}{\\alpha} = \\frac{(1.0 \\times 10^{-3}\\,\\mathrm{m})^2}{1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}} = \\frac{1.0 \\times 10^{-6}}{1.0 \\times 10^{-5}}\\,\\mathrm{s} = 0.1\\,\\mathrm{s}\n$$\n\nThe fastest (i.e., shortest) of these two time scales is:\n$$\n\\tau_{fastest} = \\min(\\tau_{adv}, \\tau_{diff}) = \\min(2.0 \\times 10^{-3}\\,\\mathrm{s}, 0.1\\,\\mathrm{s}) = 2.0 \\times 10^{-3}\\,\\mathrm{s}\n$$\nThe resolution requirement states there must be at least $5$ time steps within this fastest time scale:\n$$\n5 \\Delta t \\leq \\tau_{fastest}\n$$\n$$\n\\Delta t \\leq \\frac{\\tau_{fastest}}{5} = \\frac{2.0 \\times 10^{-3}\\,\\mathrm{s}}{5} = 0.4 \\times 10^{-3}\\,\\mathrm{s} = 4.0 \\times 10^{-4}\\,\\mathrm{s}\n$$\nSo, the resolution constraint is $\\Delta t_{resolution} \\leq 4.0 \\times 10^{-4}\\,\\mathrm{s}$.\n\n**3. Overall Constraint and Option Evaluation**\n\nTo satisfy both requirements simultaneously, $\\Delta t$ must be less than or equal to the minimum of the two derived bounds:\n$$\n\\Delta t \\leq \\min(\\Delta t_{stability}, \\Delta t_{resolution})\n$$\n$$\n\\Delta t \\leq \\min(1.923 \\times 10^{-3}\\,\\mathrm{s}, 4.0 \\times 10^{-4}\\,\\mathrm{s})\n$$\n$$\n\\Delta t \\leq 4.0 \\times 10^{-4}\\,\\mathrm{s}\n$$\nThe resolution requirement is the more restrictive constraint. The largest possible time step that satisfies both conditions is $\\Delta t_{max} = 4.0 \\times 10^{-4}\\,\\mathrm{s}$. We now evaluate the given options against this limit.\n\n- **A. $\\Delta t = 2.0 \\times 10^{-3}\\,\\mathrm{s}$**: This value is $20.0 \\times 10^{-4}\\,\\mathrm{s}$. Since $20.0 \\times 10^{-4}\\,\\mathrm{s} > 4.0 \\times 10^{-4}\\,\\mathrm{s}$, this option violates the resolution constraint. It also violates the stability constraint ($2.0 \\times 10^{-3}\\,\\mathrm{s} > 1.923 \\times 10^{-3}\\,\\mathrm{s}$). **Incorrect**.\n\n- **B. $\\Delta t = 4.0 \\times 10^{-4}\\,\\mathrm{s}$**: This value is exactly equal to the maximum allowed time step, $\\Delta t_{max}$. It satisfies both the resolution constraint ($\\Delta t \\le 4.0 \\times 10^{-4}\\,\\mathrm{s}$) and the stability constraint ($\\Delta t \\le 1.923 \\times 10^{-3}\\,\\mathrm{s}$). This is a valid choice. **Correct**.\n\n- **C. $\\Delta t = 5.0 \\times 10^{-2}\\,\\mathrm{s}$**: This value is $500 \\times 10^{-4}\\,\\mathrm{s}$. This is far larger than $\\Delta t_{max}$ and violates both constraints. **Incorrect**.\n\n- **D. $\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$**: This value is less than $\\Delta t_{max}$. Since $1.0 \\times 10^{-4}\\,\\mathrm{s} < 4.0 \\times 10^{-4}\\,\\mathrm{s}$, it satisfies both constraints and is a valid choice. **Correct**.\n\nThe question asks for the **largest value** from the options that meets both requirements. Between the two valid options, B ($\\Delta t = 4.0 \\times 10^{-4}\\,\\mathrm{s}$) and D ($\\Delta t = 1.0 \\times 10^{-4}\\,\\mathrm{s}$), option B is the larger value.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Real-world engineering systems are rarely uniform; they involve complex geometries and heterogeneous materials, leading to stability limits that vary throughout the domain. This final exercise challenges you to design a practical time step controller that automates the process of ensuring global stability by finding the most restrictive local constraint across the entire simulation domain. By translating theoretical stability conditions into a robust algorithm, you will gain insight into how modern simulation software manages time stepping to ensure both efficiency and reliability. ",
            "id": "3985745",
            "problem": "You are tasked with designing and implementing a time step controller for an explicit transient thermal simulation in one spatial dimension that must enforce stability constraints across a spatially heterogeneous domain. The governing physics is the one-dimensional transient energy balance with advection and diffusion,\n$$\\rho c_p \\frac{\\partial T}{\\partial t} + \\rho c_p u \\frac{\\partial T}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(k \\frac{\\partial T}{\\partial x}\\right),$$\nwhere $T$ is temperature, $t$ is time, $x$ is space, $\\rho$ is density, $c_p$ is specific heat capacity, $u$ is the advective velocity, and $k$ is thermal conductivity. The thermal diffusivity is defined by $\\alpha = \\frac{k}{\\rho c_p}$. For an explicit time integrator, stability constraints are expressed using two local, dimensionless groups at each cell $j$: the Courant number $C_j$ and the Fourier number $Fo_j$, defined by\n$$C_j = \\frac{|u_j| \\Delta t}{\\Delta x_j}, \\qquad Fo_j = \\frac{\\alpha_j \\Delta t}{\\Delta x_j^2},$$\nwhere $\\Delta x_j$ is the cell size, $u_j$ is the local advective speed, and $\\alpha_j$ is the local thermal diffusivity. You are given two targets $C_{\\text{tgt}}$ and $Fo_{\\text{tgt}}$, and a safety factor $s \\in (0, 1]$. The controller must, at each step, choose the largest time step $\\Delta t$ such that the maximum Courant number and the maximum Fourier number across the domain do not exceed $C_{\\text{tgt}}$ and $Fo_{\\text{tgt}}$ respectively, each scaled by the safety factor $s$. Formally, your chosen $\\Delta t$ must satisfy\n$$\\max_j C_j \\le s\\, C_{\\text{tgt}}, \\qquad \\max_j Fo_j \\le s\\, Fo_{\\text{tgt}}.$$\nIf a local advective speed $u_j$ is zero, then the local Courant constraint at that cell does not limit $\\Delta t$; if a local thermal diffusivity $\\alpha_j$ is zero, then the local Fourier constraint at that cell does not limit $\\Delta t$. Units must be handled consistently: $\\Delta x_j$ in $\\mathrm{m}$, $u_j$ in $\\mathrm{m/s}$, $\\rho_j$ in $\\mathrm{kg/m^3}$, $c_{p,j}$ in $\\mathrm{J/(kg\\,K)}$, $k_j$ in $\\mathrm{W/(m\\,K)}$, and the result $\\Delta t$ in $\\mathrm{s}$. Express the final time steps in seconds as decimal numbers.\n\nYour program must implement a function that, given arrays $\\{\\Delta x_j\\}$, $\\{u_j\\}$, $\\{k_j\\}$, $\\{\\rho_j\\}$, $\\{c_{p,j}\\}$, a target Courant number $C_{\\text{tgt}}$, a target Fourier number $Fo_{\\text{tgt}}$, and a safety factor $s$, returns the selected $\\Delta t$ that simultaneously respects both domain-wide constraints. The program must evaluate the following test suite and report the resulting $\\Delta t$ for each case.\n\nTest suite:\n- Case $1$ (advection-limited, uniform medium):\n  - $\\Delta x = [\\,0.01,\\,0.01,\\,0.01,\\,0.01\\,]\\,\\mathrm{m}$,\n  - $u = [\\,0.5,\\,0.5,\\,0.5,\\,0.5\\,]\\,\\mathrm{m/s}$,\n  - $k = [\\,20,\\,20,\\,20,\\,20\\,]\\,\\mathrm{W/(m\\,K)}$,\n  - $\\rho = [\\,7800,\\,7800,\\,7800,\\,7800\\,]\\,\\mathrm{kg/m^3}$,\n  - $c_p = [\\,500,\\,500,\\,500,\\,500\\,]\\,\\mathrm{J/(kg\\,K)}$,\n  - $C_{\\text{tgt}} = 0.5$, $Fo_{\\text{tgt}} = 0.25$, $s = 0.9$.\n- Case $2$ (diffusion-limited, heterogeneous and nonuniform):\n  - $\\Delta x = [\\,0.02,\\,0.01,\\,0.005,\\,0.02\\,]\\,\\mathrm{m}$,\n  - $u = [\\,0,\\,0,\\,0,\\,0\\,]\\,\\mathrm{m/s}$,\n  - $k = [\\,200,\\,15,\\,40,\\,100\\,]\\,\\mathrm{W/(m\\,K)}$,\n  - $\\rho = [\\,8000,\\,2700,\\,8900,\\,7800\\,]\\,\\mathrm{kg/m^3}$,\n  - $c_p = [\\,500,\\,900,\\,380,\\,500\\,]\\,\\mathrm{J/(kg\\,K)}$,\n  - $C_{\\text{tgt}} = 0.6$, $Fo_{\\text{tgt}} = 0.2$, $s = 1.0$.\n- Case $3$ (mixed advection–diffusion, with zeros in $u$ and strong local constraint):\n  - $\\Delta x = [\\,0.005,\\,0.01,\\,0.002,\\,0.02\\,]\\,\\mathrm{m}$,\n  - $u = [\\,2.0,\\,0.0,\\,-1.0,\\,0.5\\,]\\,\\mathrm{m/s}$,\n  - $k = [\\,15,\\,30,\\,12,\\,20\\,]\\,\\mathrm{W/(m\\,K)}$,\n  - $\\rho = [\\,7800,\\,7800,\\,8900,\\,1000\\,]\\,\\mathrm{kg/m^3}$,\n  - $c_p = [\\,500,\\,500,\\,380,\\,4184\\,]\\,\\mathrm{J/(kg\\,K)}$,\n  - $C_{\\text{tgt}} = 0.8$, $Fo_{\\text{tgt}} = 0.3$, $s = 0.95$.\n- Case $4$ (pure diffusion, small cell drives tight step):\n  - $\\Delta x = [\\,0.001,\\,0.002,\\,0.004\\,]\\,\\mathrm{m}$,\n  - $u = [\\,0.0,\\,0.0,\\,0.0\\,]\\,\\mathrm{m/s}$,\n  - $k = [\\,180,\\,180,\\,180\\,]\\,\\mathrm{W/(m\\,K)}$,\n  - $\\rho = [\\,9000,\\,9000,\\,9000\\,]\\,\\mathrm{kg/m^3}$,\n  - $c_p = [\\,400,\\,400,\\,400\\,]\\,\\mathrm{J/(kg\\,K)}$,\n  - $C_{\\text{tgt}} = 0.7$, $Fo_{\\text{tgt}} = 0.5$, $s = 0.8$.\n- Case $5$ (diffusion-dominated mixed case):\n  - $\\Delta x = [\\,0.01,\\,0.01\\,]\\,\\mathrm{m}$,\n  - $u = [\\,0.01,\\,0.02\\,]\\,\\mathrm{m/s}$,\n  - $k = [\\,200,\\,200\\,]\\,\\mathrm{W/(m\\,K)}$,\n  - $\\rho = [\\,1000,\\,1000\\,]\\,\\mathrm{kg/m^3}$,\n  - $c_p = [\\,1000,\\,1000\\,]\\,\\mathrm{J/(kg\\,K)}$,\n  - $C_{\\text{tgt}} = 0.8$, $Fo_{\\text{tgt}} = 0.2$, $s = 1.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above, for example, \"[0.1,0.2,0.3,0.4,0.5]\". Ensure each reported $\\Delta t$ is in $\\mathrm{s}$.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and complete. All provided data and physical principles are consistent with established theories in computational heat transfer. Therefore, a solution can be derived.\n\nThe core of the problem is to determine the largest possible time step, $\\Delta t$, for an explicit numerical simulation that remains stable. The simulation solves the one-dimensional advection-diffusion equation for energy transport:\n$$\n\\rho c_p \\frac{\\partial T}{\\partial t} + \\rho c_p u \\frac{\\partial T}{\\partial x} = \\frac{\\partial}{\\partial x}\\left(k \\frac{\\partial T}{\\partial x}\\right)\n$$\nStability for explicit methods is governed by local, cell-wise constraints that limit how far information can propagate in a single time step. The problem provides two such constraints based on the Courant number, $C_j$, for advection and the Fourier number, $Fo_j$, for diffusion. To ensure stability across the entire computational domain, the time step $\\Delta t$ must be chosen such that the stability condition is met in every single cell $j$. This means $\\Delta t$ is limited by the most restrictive cell in the domain.\n\nThe objective is to find the maximum $\\Delta t > 0$ that satisfies two global conditions:\n$$\n\\max_j C_j \\le s \\, C_{\\text{tgt}} \\quad \\text{and} \\quad \\max_j Fo_j \\le s \\, Fo_{\\text{tgt}}\n$$\nwhere $s$ is a safety factor, $C_{\\text{tgt}}$ and $Fo_{\\text{tgt}}$ are target stability numbers. We can analyze each constraint separately to find its respective maximum allowable time step, and then combine them.\n\nFirst, consider the advective constraint (Courant condition). The local Courant number at cell $j$ is given by $C_j = \\frac{|u_j| \\Delta t}{\\Delta x_j}$. The stability requirement for cell $j$ is thus:\n$$\n\\frac{|u_j| \\Delta t}{\\Delta x_j} \\le s \\, C_{\\text{tgt}}\n$$\nSolving for $\\Delta t$ gives a local time step limit:\n$$\n\\Delta t \\le \\frac{s \\, C_{\\text{tgt}} \\Delta x_j}{|u_j|}\n$$\nThis inequality must hold for all cells $j$ in the domain where advection is present (i.e., $|u_j| > 0$). If $u_j = 0$ for a particular cell, that cell imposes no advective restriction on the time step. To satisfy the constraint for all relevant cells simultaneously, $\\Delta t$ must be less than or equal to the minimum of all these local limits. This gives us the global advection time step limit, $\\Delta t_C$:\n$$\n\\Delta t_C = \\min_{j \\, | \\, u_j \\neq 0} \\left( \\frac{s \\, C_{\\text{tgt}} \\Delta x_j}{|u_j|} \\right)\n$$\nIf all velocities $u_j$ are zero, this constraint is inactive, and we can consider $\\Delta t_C$ to be infinitely large.\n\nSecond, consider the diffusive constraint (Fourier condition). The local Fourier number at cell $j$ is $Fo_j = \\frac{\\alpha_j \\Delta t}{\\Delta x_j^2}$, where the thermal diffusivity is $\\alpha_j = \\frac{k_j}{\\rho_j c_{p,j}}$. The stability requirement for cell $j$ is:\n$$\n\\frac{\\alpha_j \\Delta t}{\\Delta x_j^2} \\le s \\, Fo_{\\text{tgt}}\n$$\nSolving for $\\Delta t$ provides another local time step limit:\n$$\n\\Delta t \\le \\frac{s \\, Fo_{\\text{tgt}} \\Delta x_j^2}{\\alpha_j} = \\frac{s \\, Fo_{\\text{tgt}} \\rho_j c_{p,j} \\Delta x_j^2}{k_j}\n$$\nThis inequality must hold for all cells $j$ where diffusion is present (i.e., $\\alpha_j > 0$, which implies $k_j > 0$). If $k_j = 0$, that cell imposes no diffusive restriction. To satisfy the constraint for all relevant cells, $\\Delta t$ must be less than or equal to the minimum of all these local diffusive limits. This defines the global diffusion time step limit, $\\Delta t_F$:\n$$\n\\Delta t_F = \\min_{j \\, | \\, k_j \\neq 0} \\left( \\frac{s \\, Fo_{\\text{tgt}} \\rho_j c_{p,j} \\Delta x_j^2}{k_j} \\right)\n$$\nIf all thermal conductivities $k_j$ are zero, this constraint is inactive, and $\\Delta t_F$ can be considered infinite.\n\nTo ensure the overall simulation is stable, the chosen time step $\\Delta t$ must satisfy both the advective and diffusive constraints simultaneously. Therefore, it must be less than or equal to both $\\Delta t_C$ and $\\Delta t_F$. To find the largest possible time step that meets this requirement, we must choose the smaller of the two global limits:\n$$\n\\Delta t_{\\text{final}} = \\min(\\Delta t_C, \\Delta t_F)\n$$\nThis is the final, globally stable time step.\n\nThe algorithm for each test case is as follows:\n1.  Receive the arrays of cell properties $\\{\\Delta x_j\\}$, $\\{u_j\\}$, $\\{k_j\\}$, $\\{\\rho_j\\}$, $\\{c_{p,j}\\}$ and the scalar parameters $C_{\\text{tgt}}$, $Fo_{\\text{tgt}}$, $s$.\n2.  Calculate the vector of local advective time step limits, $\\Delta t_{C,j} = \\frac{s C_{\\text{tgt}} \\Delta x_j}{|u_j|}$. For any cell $j$ where $u_j=0$, this limit is infinite.\n3.  Find the global advective limit $\\Delta t_C = \\min_j(\\{\\Delta t_{C,j}\\})$.\n4.  Calculate the vector of local diffusive time step limits, $\\Delta t_{F,j} = \\frac{s Fo_{\\text{tgt}} \\rho_j c_{p,j} \\Delta x_j^2}{k_j}$. For any cell $j$ where $k_j=0$, this limit is infinite.\n5.  Find the global diffusive limit $\\Delta t_F = \\min_j(\\{\\Delta t_{F,j}\\})$.\n6.  The result for the case is $\\Delta t = \\min(\\Delta t_C, \\Delta t_F)$.\nThis procedure is applied to each test case in the suite to produce the final list of results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum stable time step for a series of 1D transient\n    thermal simulation test cases, based on Courant and Fourier stability\n    constraints.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (advection-limited, uniform medium)\n        {\n            \"dx\": np.array([0.01, 0.01, 0.01, 0.01]),\n            \"u\": np.array([0.5, 0.5, 0.5, 0.5]),\n            \"k\": np.array([20, 20, 20, 20]),\n            \"rho\": np.array([7800, 7800, 7800, 7800]),\n            \"cp\": np.array([500, 500, 500, 500]),\n            \"C_tgt\": 0.5, \"Fo_tgt\": 0.25, \"s\": 0.9\n        },\n        # Case 2 (diffusion-limited, heterogeneous and nonuniform)\n        {\n            \"dx\": np.array([0.02, 0.01, 0.005, 0.02]),\n            \"u\": np.array([0, 0, 0, 0]),\n            \"k\": np.array([200, 15, 40, 100]),\n            \"rho\": np.array([8000, 2700, 8900, 7800]),\n            \"cp\": np.array([500, 900, 380, 500]),\n            \"C_tgt\": 0.6, \"Fo_tgt\": 0.2, \"s\": 1.0\n        },\n        # Case 3 (mixed advection–diffusion, with zeros in u and strong local constraint)\n        {\n            \"dx\": np.array([0.005, 0.01, 0.002, 0.02]),\n            \"u\": np.array([2.0, 0.0, -1.0, 0.5]),\n            \"k\": np.array([15, 30, 12, 20]),\n            \"rho\": np.array([7800, 7800, 8900, 1000]),\n            \"cp\": np.array([500, 500, 380, 4184]),\n            \"C_tgt\": 0.8, \"Fo_tgt\": 0.3, \"s\": 0.95\n        },\n        # Case 4 (pure diffusion, small cell drives tight step)\n        {\n            \"dx\": np.array([0.001, 0.002, 0.004]),\n            \"u\": np.array([0.0, 0.0, 0.0]),\n            \"k\": np.array([180, 180, 180]),\n            \"rho\": np.array([9000, 9000, 9000]),\n            \"cp\": np.array([400, 400, 400]),\n            \"C_tgt\": 0.7, \"Fo_tgt\": 0.5, \"s\": 0.8\n        },\n        # Case 5 (diffusion-dominated mixed case)\n        {\n            \"dx\": np.array([0.01, 0.01]),\n            \"u\": np.array([0.01, 0.02]),\n            \"k\": np.array([200, 200]),\n            \"rho\": np.array([1000, 1000]),\n            \"cp\": np.array([1000, 1000]),\n            \"C_tgt\": 0.8, \"Fo_tgt\": 0.2, \"s\": 1.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        dx, u, k = case[\"dx\"], case[\"u\"], case[\"k\"]\n        rho, cp = case[\"rho\"], case[\"cp\"]\n        C_tgt, Fo_tgt, s = case[\"C_tgt\"], case[\"Fo_tgt\"], case[\"s\"]\n\n        # Advective (Courant) time step constraint\n        # dt_C_local = (s * C_tgt * dx) / |u|\n        # If u is zero, the constraint is inactive (dt -> infinity)\n        # Using np.divide handles division by zero by outputting np.inf\n        # where the condition u != 0 is false.\n        abs_u = np.abs(u)\n        dt_C_local = np.divide(s * C_tgt * dx, abs_u, \n                               out=np.full_like(dx, np.inf), \n                               where=abs_u != 0)\n        dt_C = np.min(dt_C_local)\n\n        # Diffusive (Fourier) time step constraint\n        # dt_F_local = (s * Fo_tgt * rho * cp * dx^2) / k\n        # If k is zero, thermal diffusivity is zero, constraint is inactive (dt -> infinity)\n        dt_F_local = np.divide(s * Fo_tgt * rho * cp * dx**2, k,\n                               out=np.full_like(dx, np.inf),\n                               where=k != 0)\n        dt_F = np.min(dt_F_local)\n\n        # The final time step must satisfy both constraints, so we take the minimum\n        final_dt = min(dt_C, dt_F)\n        results.append(final_dt)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}