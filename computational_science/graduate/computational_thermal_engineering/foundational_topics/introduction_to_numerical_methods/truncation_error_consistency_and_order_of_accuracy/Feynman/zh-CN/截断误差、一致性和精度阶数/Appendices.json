{
    "hands_on_practices": [
        {
            "introduction": "泰勒级数展开不仅能揭示数值格式的精度阶数，还能深入揭示其内在行为。本练习将分析经典的一阶迎风格式，通过推导其修正方程，我们将揭示一个由离散化引入的、非物理的“人工扩散”效应，这是计算热工学中的一个基本概念。",
            "id": "4000118",
            "problem": "在计算热工学中，被动热标量的对流输运可以通过一维 (1D) 线性平流偏微分方程（PDE）来建模：\n$$\nu_t + a\\,u_x = 0,\n$$\n其中 $u(x,t)$ 是被输运的标量（例如，温度脉动），$a>0$ 是恒定的平流速度，$x$ 是空间坐标，$t$ 是时间。考虑一个具有恒定间距 $\\Delta x>0$ 的均匀网格 $x_i = i\\,\\Delta x$，在网格点 $x_i$ 处，空间导数 $u_x$ 的一阶迎风有限差分近似由下式给出\n$$\n\\left(u_x\\right)_i \\approx \\frac{u_i - u_{i-1}}{\\Delta x}, \\quad \\text{for } a>0,\n$$\n其中 $u_i \\equiv u(x_i,t)$。\n\n您的任务是：\n- 从局部截断误差的定义和关于 $x_i$ 的泰勒级数展开出发，推导平流项 $a\\,u_x$ 在 $x_i$ 处的离散近似的截断误差，并确定其关于 $\\Delta x$ 的精度阶。\n- 使用相同的展开，为半离散格式 $u_t + a\\,\\left(u_i - u_{i-1}\\right)/\\Delta x = 0$ 构建修正方程，方法是将其表示为一个 $u(x,t)$ 近似满足的连续偏微分方程，并保留截至并包括与 $\\Delta x^2$ 成比例的项。\n- 识别并解释修正方程中出现的人工扩散项，并提取其扩散系数。\n\n请用一个包含 $a$ 和 $\\Delta x$ 的符号表达式来表示人工扩散系数的最终答案。不要包含单位，也不要四舍五入；请以精确解析形式提供该表达式。",
            "solution": "该问题要求分析用于一维线性平流方程的一阶迎风有限差分格式。分析将分三步进行：首先，推导局部截断误差和精度阶；其次，构建修正偏微分方程（PDE）；第三，识别并提取人工扩散项及其系数。\n\n控制偏微分方程是线性平流方程：\n$$\nu_t + a u_x = 0\n$$\n其中 $u(x,t)$ 是被输运的标量，$a > 0$ 是恒定的平流速度，$x$ 是空间坐标，$t$ 是时间。空间域在间距为 $\\Delta x > 0$ 的均匀网格 $x_i = i \\Delta x$ 上被离散化。在网格点 $x_i$ 处，关于空间的偏导数 $u_x$ 使用一阶迎风（后向差分）格式进行近似：\n$$\n(u_x)_i \\approx \\frac{u_i - u_{i-1}}{\\Delta x}\n$$\n其中 $u_i \\equiv u(x_i, t)$。\n\n**第一部分：截断误差和精度阶**\n\n空间离散化的局部截断误差 $\\tau_i$ 是将精确解 $u(x,t)$ 代入有限差分公式时得到的残差。它被定义为离散算子与作用于精确解的连续算子之间的差。\n\n令连续微分算子为 $L(u) = a u_x$。\n令离散差分算子为 $L_{\\Delta x}(u_i) = a \\frac{u_i - u_{i-1}}{\\Delta x}$。\n\n截断误差则为：\n$$\n\\tau_i = L_{\\Delta x}(u_i) - (L u)_i = a \\frac{u_i - u_{i-1}}{\\Delta x} - a (u_x)_i\n$$\n为分析 $\\tau_i$，我们在点 $x_i$ 附近对函数 $u(x, t)$ 在点 $x_{i-1} = x_i - \\Delta x$ 处进行泰勒级数展开。假设解 $u(x,t)$ 具有足够的光滑性，我们有：\n$$\nu_{i-1} = u(x_i - \\Delta x, t) = u(x_i, t) - \\Delta x \\left(\\frac{\\partial u}{\\partial x}\\right)_i + \\frac{(\\Delta x)^2}{2!} \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i - \\frac{(\\Delta x)^3}{3!} \\left(\\frac{\\partial^3 u}{\\partial x^3}\\right)_i + \\mathcal{O}((\\Delta x)^4)\n$$\n使用下标表示空间导数，即 $(u_x)_i = (\\partial u/\\partial x)_i$，$(u_{xx})_i = (\\partial^2 u/\\partial x^2)_i$ 等，展开式变为：\n$$\nu_{i-1} = u_i - \\Delta x (u_x)_i + \\frac{(\\Delta x)^2}{2} (u_{xx})_i - \\frac{(\\Delta x)^3}{6} (u_{xxx})_i + \\mathcal{O}((\\Delta x)^4)\n$$\n将此展开式代入截断误差的表达式中：\n$$\n\\tau_i = a \\frac{u_i - \\left(u_i - \\Delta x (u_x)_i + \\frac{(\\Delta x)^2}{2} (u_{xx})_i - \\frac{(\\Delta x)^3}{6} (u_{xxx})_i + \\mathcal{O}((\\Delta x)^4)\\right)}{\\Delta x} - a (u_x)_i\n$$\n简化分子中的项：\n$$\n\\tau_i = a \\frac{\\Delta x (u_x)_i - \\frac{(\\Delta x)^2}{2} (u_{xx})_i + \\frac{(\\Delta x)^3}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^4)}{\\Delta x} - a (u_x)_i\n$$\n除以 $\\Delta x$：\n$$\n\\tau_i = a \\left( (u_x)_i - \\frac{\\Delta x}{2} (u_{xx})_i + \\frac{(\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3) \\right) - a (u_x)_i\n$$\n项 $a (u_x)_i$ 被消去，留下截断误差的表达式：\n$$\n\\tau_i = - \\frac{a \\Delta x}{2} (u_{xx})_i + \\frac{a (\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3)\n$$\n精度阶由截断误差首项中 $\\Delta x$ 的最低次幂决定。在这种情况下，首项是 $- \\frac{a \\Delta x}{2} (u_{xx})_i$，它与 $(\\Delta x)^1$ 成正比。因此，空间离散化对于 $\\Delta x$ 是一阶精度的。\n\n**第二部分：修正方程**\n\n修正方程是数值格式实际求解的偏微分方程，包括其误差项。我们从半离散格式开始，其中空间导数被其有限差分近似所取代：\n$$\n(u_t)_i + a \\frac{u_i - u_{i-1}}{\\Delta x} = 0\n$$\n我们已经找到了离散空间项的泰勒级数展开：\n$$\na \\frac{u_i - u_{i-1}}{\\Delta x} = a (u_x)_i - \\frac{a \\Delta x}{2} (u_{xx})_i + \\frac{a (\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3)\n$$\n将此代入半离散方程中得到：\n$$\n(u_t)_i + a (u_x)_i - \\frac{a \\Delta x}{2} (u_{xx})_i + \\frac{a (\\Delta x)^2}{6} (u_{xxx})_i - \\mathcal{O}((\\Delta x)^3) = 0\n$$\n我们可以通过去掉下标 $i$ 来为连续函数 $u(x,t)$ 表达这种关系。该方程表示数值解近似满足的偏微分方程。将其重新整理以匹配原始偏微分方程加误差项的结构，即可得到修正方程：\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{a (\\Delta x)^2}{6} u_{xxx} + \\mathcal{O}((\\Delta x)^3)\n$$\n问题要求保留截至并包括与 $(\\Delta x)^2$ 成比例的项。因此，修正方程为：\n$$\nu_t + a u_x = \\frac{a \\Delta x}{2} u_{xx} - \\frac{a (\\Delta x)^2}{6} u_{xxx}\n$$\n\n**第三部分：人工扩散项和系数**\n\n修正方程显示了数值格式如何偏离原始偏微分方程。右侧的项是离散化引入的误差项。原始方程 $u_t + a u_x = 0$ 描述了纯平流，没有任何扩散。\n\n修正方程中的首项误差项是 $\\frac{a \\Delta x}{2} u_{xx}$。该项具有扩散项 $D u_{xx}$ 的形式，这是热方程或扩散方程的特征。由于该项是数值方法的产物，而不是原始物理模型的一部分，因此被称为“人工扩散”或“数值扩散”项。\n\n该项是耗散的，意味着它倾向于衰减或平滑解中的陡峭梯度，这是一阶迎风格式的一个已知特性。系数的正号（因为 $a > 0$ 和 $\\Delta x > 0$）证实了它作为一个正向扩散过程，以牺牲精度的代价确保了数值稳定性。\n\n通过将首项误差项与扩散项的一般形式 $D_{art} u_{xx}$ 进行比较，我们可以提取出人工扩散系数 $D_{art}$。\n$$\nD_{art} u_{xx} = \\frac{a \\Delta x}{2} u_{xx}\n$$\n因此，人工扩散系数为：\n$$\nD_{art} = \\frac{a \\Delta x}{2}\n$$\n该系数量化了格式引入的非物理扩散量。它与平流速度 $a$ 和网格间距 $\\Delta x$ 都成正比。",
            "answer": "$$\\boxed{\\frac{a \\Delta x}{2}}$$"
        },
        {
            "introduction": "截断误差分析不仅适用于偏微分方程的空间离散，同样是理解常微分方程时间积分方法的核心。本练习将研究一个二阶龙格-库塔法（Heun法），通过细致的泰勒展开，我们将精确计算其单步局部截断误差，并阐明局部误差阶数与方法的全局精度阶数之间的关键关系。",
            "id": "3817323",
            "problem": "一个经典的一维海洋混合层模型通过标量常微分方程 $T^{\\prime}(t) = f(t, T(t))$ 来近似一个控制体积内垂直均匀示踪剂（例如温度）的演化，其中函数 $f$ 对其两个自变量都足够光滑，并且源于具有指定源和汇的热量守恒。考虑使用霍恩方法（Heun's method，也称为显式梯形法则或显式二阶龙格-库塔方法）将该模型从时间 $t_n$ 推进到 $t_{n+1} = t_n + h$，其定义如下：\n- $k_1 = f(t_n, T_n)$,\n- $k_2 = f(t_n + h, T_n + h k_1)$,\n- $T_{n+1}^{H} = T_n + \\frac{h}{2}\\left(k_1 + k_2\\right)$,\n其中 $T_n$ 是 $T(t_n)$ 的近似值。\n\n从精确值 $T(t_n)$（而非 $T_n$）出发，通过将所有项在点 $\\,(t_n, T(t_n))\\,$ 附近进行泰勒展开，并保留所有直至 $h^3$ 阶（含 $h^3$ 阶）的贡献项，来推导单步局部截断误差 $\\,\\tau_{n+1} \\equiv T(t_{n+1}) - T_{n+1}^{H}\\,$。将你的结果用时间导数 $T^{\\prime\\prime}(t_n)$、$T^{(3)}(t_n)$ 以及在 $t_n$ 处的精确解上求值的偏导数 $f_T(t_n, T(t_n)) \\equiv \\partial f/\\partial T$ 表示成一个闭合解析形式。使用这个误差项，在适用于相容单步方法的光滑性和稳定性假设下，证明霍恩方法（Heun's method）对于此海洋混合层常微分方程具有二阶全局精度。\n\n你的最终答案必须是 $\\,\\tau_{n+1}\\,$ 主阶项的单个闭合解析表达式，用 $\\,h\\,$, $\\,T^{\\prime\\prime}(t_n)\\,$, $\\,T^{(3)}(t_n)\\,$ 和 $\\,f_T(t_n, T(t_n))\\,$ 表示。不包含单位。不要四舍五入。",
            "solution": "问题陈述具有科学依据、提法恰当且客观。它提出了一个数值分析中的标准任务：为一个著名的龙格-库塔方法（霍恩方法）推导局部截断误差，并随后分析其精度阶。所有定义和条件都是标准的且自洽的。因此，该问题是有效的，我们可以开始求解。\n\n目标是推导霍恩方法（Heun's method）的单步局部截断误差 $\\tau_{n+1}$。局部截断误差定义为在时间 $t_{n+1}$ 的精确解与从时间 $t_n$ 的精确解出发单步计算得到的数值近似解之间的差值。设 $T(t)$ 是常微分方程 $T^{\\prime}(t) = f(t, T(t))$ 的精确解。因此，局部截断误差为 $\\tau_{n+1} \\equiv T(t_{n+1}) - T_{n+1}^{H}$，其中数值步 $T_{n+1}^{H}$ 是从精确值 $T_n = T(t_n)$ 开始计算的。\n\n首先，我们使用泰勒级数将精确解 $T(t_{n+1})$ 在 $t_n$ 附近展开，其中 $t_{n+1} = t_n + h$。\n$$T(t_{n+1}) = T(t_n + h) = T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{6} T^{(3)}(t_n) + O(h^4)$$\n$T(t)$ 的导数在 $t_n$ 处求值。\n\n接下来，我们分析从精确解值 $T(t_n)$ 出发，经过一步霍恩方法（Heun's method）得到的数值解 $T_{n+1}^{H}$：\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2}(k_1 + k_2)$$\n系数 $k_1$ 和 $k_2$ 定义如下：\n$$k_1 = f(t_n, T(t_n))$$\n$$k_2 = f(t_n + h, T(t_n) + h k_1)$$\n由于 $T(t)$ 是精确解，我们有 $T^{\\prime}(t) = f(t, T(t))$。因此，$k_1 = T^{\\prime}(t_n)$。\n\n为了得到一个与 $T(t_{n+1})$ 的泰勒级数可比较的 $T_{n+1}^{H}$ 表达式，我们必须将 $k_2$ 作为一个二元函数在点 $(t_n, T(t_n))$ 附近进行泰勒展开。设 $f_t = \\frac{\\partial f}{\\partial t}$，$f_T = \\frac{\\partial f}{\\partial T}$，$f_{tt} = \\frac{\\partial^2 f}{\\partial t^2}$，$f_{tT} = \\frac{\\partial^2 f}{\\partial t \\partial T}$ 以及 $f_{TT} = \\frac{\\partial^2 f}{\\partial T^2}$，所有偏导数均在点 $(t_n, T(t_n))$ 求值。其展开式为：\n$$k_2 = f(t_n+h, T(t_n)+hk_1) = f(t_n, T(t_n)) + h f_t + (hk_1) f_T + \\frac{1}{2}\\left(h^2 f_{tt} + 2h(hk_1)f_{tT} + (hk_1)^2 f_{TT}\\right) + O(h^3)$$\n代入 $k_1 = T^{\\prime}(t_n)$ 和 $f(t_n, T(t_n)) = T^{\\prime}(t_n)$：\n$$k_2 = T^{\\prime}(t_n) + h \\left(f_t + T^{\\prime}(t_n) f_T\\right) + \\frac{h^2}{2}\\left(f_{tt} + 2T^{\\prime}(t_n) f_{tT} + (T^{\\prime}(t_n))^2 f_{TT}\\right) + O(h^3)$$\n\n现在，我们将 $f$ 的偏导数与 $T$ 的全时间导数联系起来。对 $T^{\\prime}(t) = f(t, T(t))$ 使用链式法则：\n$$T^{\\prime\\prime}(t) = \\frac{d}{dt}f(t, T(t)) = \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial T}\\frac{dT}{dt} = f_t + f_T T^{\\prime}(t)$$\n再次对 $t$ 求导：\n$$T^{(3)}(t) = \\frac{d}{dt}\\left(f_t + f_T T^{\\prime}(t)\\right) = \\left(\\frac{\\partial f_t}{\\partial t} + \\frac{\\partial f_t}{\\partial T}\\frac{dT}{dt}\\right) + \\left(\\frac{\\partial f_T}{\\partial t} + \\frac{\\partial f_T}{\\partial T}\\frac{dT}{dt}\\right)T^{\\prime}(t) + f_T T^{\\prime\\prime}(t)$$\n$$T^{(3)}(t) = (f_{tt} + f_{tT}T^{\\prime}) + (f_{Tt} + f_{TT}T^{\\prime})T^{\\prime} + f_T T^{\\prime\\prime}$$\n由于假设 $f$ 足够光滑，混合偏导数相等，$f_{tT} = f_{Tt}$。\n$$T^{(3)}(t_n) = f_{tt} + 2T^{\\prime}(t_n)f_{tT} + (T^{\\prime}(t_n))^2 f_{TT} + f_T T^{\\prime\\prime}(t_n)$$\n由此，我们可以表示出 $k_2$ 展开式中 $O(h^2)$ 部分的项：\n$$f_{tt} + 2T^{\\prime}(t_n)f_{tT} + (T^{\\prime}(t_n))^2 f_{TT} = T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)$$\n\n将这些全导数表达式代回到 $k_2$ 的展开式中：\n$$k_2 = T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}\\left(T^{(3)}(t_n) - f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n)\\right) + O(h^3)$$\n\n现在我们将 $k_1$ 和 $k_2$ 的表达式代入 $T_{n+1}^{H}$ 的公式中：\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2} \\left[ T^{\\prime}(t_n) + \\left( T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}(T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)) + O(h^3) \\right) \\right]$$\n$$T_{n+1}^{H} = T(t_n) + \\frac{h}{2} \\left[ 2T^{\\prime}(t_n) + h T^{\\prime\\prime}(t_n) + \\frac{h^2}{2}(T^{(3)}(t_n) - f_T T^{\\prime\\prime}(t_n)) + O(h^3) \\right]$$\n$$T_{n+1}^{H} = T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{4}\\left( T^{(3)}(t_n) - f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) \\right) + O(h^4)$$\n\n最后，我们计算局部截断误差 $\\tau_{n+1} = T(t_{n+1}) - T_{n+1}^{H}$：\n$$\\tau_{n+1} = \\left( T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{6} T^{(3)}(t_n) \\right) - \\left( T(t_n) + h T^{\\prime}(t_n) + \\frac{h^2}{2} T^{\\prime\\prime}(t_n) + \\frac{h^3}{4} T^{(3)}(t_n) - \\frac{h^3}{4} f_T T^{\\prime\\prime}(t_n) \\right) + O(h^4)$$\n$h^0$、$h^1$ 和 $h^2$ 阶的项相互抵消。我们收集 $h^3$ 阶的项：\n$$\\tau_{n+1} = \\left(\\frac{1}{6} - \\frac{1}{4}\\right) h^3 T^{(3)}(t_n) + \\frac{h^3}{4} f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) + O(h^4)$$\n$$\\tau_{n+1} = -\\frac{1}{12} h^3 T^{(3)}(t_n) + \\frac{3}{12} h^3 f_T(t_n, T(t_n)) T^{\\prime\\prime}(t_n) + O(h^4)$$\n局部截断误差的主阶项是：\n$$\\tau_{n+1} = \\frac{h^3}{12} \\left( 3 T^{\\prime\\prime}(t_n) f_T(t_n, T(t_n)) - T^{(3)}(t_n) \\right) + O(h^4)$$\n\n为了证明其二阶全局精度，我们分析这个结果。如果一个数值方法的局部截断误差 $\\tau_{n+1}$ 为 $h^{p+1}$ 阶，则称该方法为 $p$ 阶方法。在本例中，我们发现 $\\tau_{n+1} = O(h^3)$，这意味着该方法是 $p=2$ 阶的。\n该方法是相容的，因为 $\\lim_{h\\to 0} \\frac{\\tau_{n+1}}{h} = \\lim_{h\\to 0} O(h^2) = 0$。\n常微分方程数值分析的基本定理（归功于 Dahlquist）指出，对于一个相容的单步方法，稳定性是收敛的充分条件。此外，如果该方法是 $p$ 阶且稳定的（对于龙格-库塔方法，如果 $f$ 是利普希茨连续的，这是光滑性假设的一个推论，那么稳定性可以得到保证），那么在固定时间 $t_N = t_0 + Nh$ 的全局误差 $E_N = T(t_N) - T_N$ 是 $p$ 阶的。\n由于霍恩方法（Heun's method）是 $p=2$ 阶的，其全局误差为 $O(h^2)$。因此，该方法具有二阶全局精度。\n局部截断误差的主阶项是 $h^3$ 阶的表达式。",
            "answer": "$$\\boxed{\\frac{h^3}{12} \\left( 3 T^{\\prime\\prime}(t_n) f_T(t_n, T(t_n)) - T^{(3)}(t_n) \\right)}$$"
        },
        {
            "introduction": "一个数值方案的整体精度受其最薄弱环节的限制，而这个薄弱环节常常出现在计算域的边界上。本练习将探讨一个关键的实际问题：边界条件处理。我们将分析一个朴素的边界处理如何导致全局精度下降，并学习如何通过设计“虚拟单元”来修正边界格式，从而恢复并保持内部格式的高精度。",
            "id": "4000115",
            "problem": "考虑一个占据区域 $x \\in [0,L]$ 的均匀杆中的一维稳态热传导，其热导率 $k$ 为常数。设温度场为 $T(x)$，假设其足够光滑，傅里叶热传导定律指出热通量为 $q(x) = -k \\,\\frac{dT}{dx}(x)$。位于 $x=0$ 的左边界保持在固定温度 $T(0)=T_{b}$（狄利克雷条件）。使用包含 $N$ 个控制体的均匀有限体积网格对区域进行离散化，每个控制体宽度为 $h = L/N$，单元中心位于 $x_{i} = \\left(i - \\tfrac{1}{2}\\right) h$（其中 $i=1,2,\\dots,N$）。左边界界面位于 $x=\\tfrac{1}{2}(x_{0}+x_{1})=0$，其中 $x_{0}=-\\tfrac{h}{2}$ 是为了在边界处能够使用内部格式而引入的虚拟单元中心的位置。相邻单元中心之间的面法向温度梯度的内部二阶中心差分近似为\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=(x_{i}+x_{i+1})/2} \\approx \\frac{T_{i+1}-T_{i}}{h}.\n$$\n在左边界界面处，假设通过使用朴素的单边面到中心公式来近似面法向梯度，从而施加狄利克雷边界条件，而未进行任何特殊的边界修正\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=0} \\approx \\frac{T_{1} - T_{b}}{h/2}.\n$$\n利用关于 $x=0$ 的泰勒级数展开以及截断误差和相容性的定义，确定此朴素边界近似对面法向梯度的局部精度阶，并将其与内部的二阶精度进行比较。然后，提出并推导一种边界修正方法，通过选择一个表示为 $T_b$、$T_1$ 和 $T_2$ 线性组合的适当虚拟单元值 $T_0$，在左边界处恢复二阶精度，同时允许使用内部中心差分格式 $\\frac{T_1-T_0}{h}$。\n\n您的任务是：\n- 推导朴素边界近似 $\\frac{T_1 - T_b}{h/2}$ 对 $\\left.\\frac{dT}{dx}\\right|_{x=0}$ 的截断误差，并说明其关于 $h$ 的阶数。\n- 确定相对于内部二阶近似，边界处产生的精度损失阶数。\n- 通过选择 $T_0$，使得内部中心差分格式 $\\frac{T_1-T_0}{h}$ 以二阶精度近似 $\\left.\\frac{dT}{dx}\\right|_{x=0}$，从而推导一个二阶精度的边界修正，并提供 $T_0$ 以 $T_b$、$T_1$ 和 $T_2$ 表示的显式表达式。\n\n将你的最终答案表示为一个行矩阵，其中包含：1) 边界处的整数精度损失阶数，以及 2) 以 $T_b$、$T_1$ 和 $T_2$ 符号化表示的修正后的虚拟单元值 $T_0$。\n\n无需进行数值计算；请提供精确的符号表达式。最终答案中无需报告物理单位。",
            "solution": "问题要求三项内容：温度梯度的朴素边界近似的精度阶，与内部格式相比产生的精度损失阶数，以及一个能够恢复边界二阶精度的虚拟单元值 $T_{0}$ 的推导。我们将使用泰勒级数分析依次解决每个任务。\n\n区域被离散化，单元中心位于 $x_{i} = \\left(i - \\tfrac{1}{2}\\right) h$。因此，第一个单元中心在 $x_{1} = h/2$，第二个在 $x_{2} = 3h/2$。狄利克雷边界在 $x=0$ 处，其中 $T(0) = T_{b}$。我们假设温度场 $T(x)$ 足够光滑，可以进行泰勒级数展开。\n\n首先，我们分析梯度 $\\left.\\frac{dT}{dx}\\right|_{x=0}$ 的朴素边界近似的截断误差。该近似由下式给出：\n$$\nD_{\\text{naive}} = \\frac{T_{1} - T_{b}}{h/2}\n$$\n其中 $T_{1}$ 是第一个单元中心的温度，$T(x_1) = T(h/2)$，$T_b$ 是边界温度，$T(0)$。为了求截断误差，我们将 $T(h/2)$ 在 $x=0$ 处进行泰勒级数展开：\n$$\nT_{1} = T(h/2) = T(0) + \\left.\\frac{dT}{dx}\\right|_{x=0} \\left(\\frac{h}{2}\\right) + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{(h/2)^2}{2!} + \\left.\\frac{d^3T}{dx^3}\\right|_{x=0} \\frac{(h/2)^3}{3!} + \\dots\n$$\n代入 $T(0) = T_{b}$ 并化简：\n$$\nT_{1} = T_{b} + \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3)\n$$\n现在，将此展开式代入 $D_{\\text{naive}}$ 的公式中：\n$$\nD_{\\text{naive}} = \\frac{1}{h/2} \\left[ \\left( T_{b} + \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3) \\right) - T_{b} \\right]\n$$\n$$\nD_{\\text{naive}} = \\frac{2}{h} \\left[ \\left.\\frac{dT}{dx}\\right|_{x=0} \\frac{h}{2} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h^2}{8} + O(h^3) \\right]\n$$\n$$\nD_{\\text{naive}} = \\left.\\frac{dT}{dx}\\right|_{x=0} + \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} \\frac{h}{4} + O(h^2)\n$$\n截断误差 $\\tau_{\\text{naive}}$ 是近似值与精确值之差：\n$$\n\\tau_{\\text{naive}} = D_{\\text{naive}} - \\left.\\frac{dT}{dx}\\right|_{x=0} = \\frac{h}{4} \\left.\\frac{d^2T}{dx^2}\\right|_{x=0} + O(h^2)\n$$\n误差中的首项与 $h^1$ 成正比，因此朴素边界近似是一阶精度的，即其精度阶为 $p_{\\text{naive}} = 1$。\n\n问题指出，内部近似是二阶精度的（$p_{\\text{int}} = 2$）。边界处的精度损失阶数是内部精度阶与边界精度阶之差：\n$$\n\\text{Order Loss} = p_{\\text{int}} - p_{\\text{naive}} = 2 - 1 = 1\n$$\n这完成了前两个任务。\n\n对于第三个任务，我们需要找到一个虚拟单元温度值 $T_0$，使得中心差分格式 $\\frac{T_1 - T_0}{h}$ 能为边界处的梯度 $\\left.\\frac{dT}{dx}\\right|_{x=0}$ 提供一个二阶精度的近似。该格式是中心差分，因为它使用了点 $x_1 = h/2$ 和虚拟单元中心 $x_0 = -h/2$，并以它们的中点 $x=0$ 为中心。\n已知此中心差分格式的截断误差是二阶的：\n$$\n\\frac{T(h/2) - T(-h/2)}{h} = \\left.\\frac{dT}{dx}\\right|_{x=0} + O(h^2)\n$$\n为达到此精度，我们必须将 $T_0$ 定义为 $T(-h/2)$ 的一个二阶精度近似。我们可以通过对已知值 $T_b = T(0)$、$T_1 = T(h/2)$ 和 $T_2 = T(3h/2)$ 进行外推来构造这样的近似。我们可以拟合一个通过这三个点的二次多项式 $P(x)$，并在 $x=-h/2$ 处对其求值。\n设插值多项式为 $P(x) = ax^2 + bx + c$。则 $T_0$ 的值为 $P(-h/2)$。\n求 $P(-h/2)$ 的一个直接方法是使用拉格朗日插值公式。这三个点是 $(0, T_b)$、$(h/2, T_1)$ 和 $(3h/2, T_2)$。我们想要求出插值多项式在 $x = -h/2$ 处的值。\n$$\nP(x) = T_b L_0(x) + T_1 L_1(x) + T_2 L_2(x)\n$$\n其中 $L_i(x)$ 是拉格朗日基多项式。我们需要在 $x=-h/2$ 处对它们求值。\n对于 $L_0(x) = \\frac{(x-h/2)(x-3h/2)}{(0-h/2)(0-3h/2)}$：\n$$\nL_0(-h/2) = \\frac{(-h/2-h/2)(-h/2-3h/2)}{(0-h/2)(0-3h/2)} = \\frac{(-h)(-2h)}{3h^2/4} = \\frac{2h^2}{3h^2/4} = \\frac{8}{3}\n$$\n对于 $L_1(x) = \\frac{(x-0)(x-3h/2)}{(h/2-0)(h/2-3h/2)}$：\n$$\nL_1(-h/2) = \\frac{(-h/2)(-h/2-3h/2)}{(h/2)(-h)} = \\frac{(-h/2)(-2h)}{-h^2/2} = \\frac{h^2}{-h^2/2} = -2\n$$\n对于 $L_2(x) = \\frac{(x-0)(x-h/2)}{(3h/2-0)(3h/2-h/2)}$：\n$$\nL_2(-h/2) = \\frac{(-h/2)(-h/2-h/2)}{(3h/2)(h)} = \\frac{(-h/2)(-h)}{3h^2/2} = \\frac{h^2/2}{3h^2/2} = \\frac{1}{3}\n$$\n现在，我们将这些结合起来求得 $T_0 = P(-h/2)$：\n$$\nT_0 = T_b L_0(-h/2) + T_1 L_1(-h/2) + T_2 L_2(-h/2) = T_b \\left(\\frac{8}{3}\\right) + T_1(-2) + T_2\\left(\\frac{1}{3}\\right)\n$$\n$$\nT_0 = \\frac{8}{3}T_b - 2T_1 + \\frac{1}{3}T_2\n$$\n整理此表达式得到虚拟单元值的最终形式：\n$$\nT_0 = \\frac{8T_b - 6T_1 + T_2}{3}\n$$\n使用这个 $T_0$ 值可确保格式 $\\frac{T_1 - T_0}{h}$ 以二阶精度近似 $\\left.\\frac{dT}{dx}\\right|_{x=0}$。\n\n最终答案的两个部分是整数精度损失阶数（为 $1$）和推导出的 $T_0$ 表达式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{8T_b - 6T_1 + T_2}{3} \\end{pmatrix}}\n$$"
        }
    ]
}