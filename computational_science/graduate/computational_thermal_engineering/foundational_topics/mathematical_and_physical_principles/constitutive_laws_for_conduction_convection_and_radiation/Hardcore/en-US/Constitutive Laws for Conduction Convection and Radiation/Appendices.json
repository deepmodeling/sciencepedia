{
    "hands_on_practices": [
        {
            "introduction": "We begin by revisiting the foundational Fourier's law of conduction, but with a crucial real-world complexity. In many materials, thermal conductivity $k$ is not a constant but varies significantly with temperature $T$. This practice explores a common non-linear scenario where $k$ is modeled as a linear function of $T$. By deriving the exact temperature profile and comparing it to the simplified constant-property assumption , you will gain a quantitative understanding of the errors introduced by linearization and sharpen your skills in solving the resulting non-linear differential equations.",
            "id": "3944394",
            "problem": "A straight, homogeneous bar of length $L$, uniform cross-sectional area, and negligible axial heat generation is held at fixed temperatures at both ends: $T(0) = T_0$ and $T(L) = T_L$. The thermal conductivity follows a temperature-dependent constitutive law $k(T) = k_0 \\left(1 + \\beta T\\right)$. Assume steady, One-Dimensional (1D) conduction along the bar, with no internal sources and no motion, and neglect any axial convection or radiation exchange within the bar interior. The ends are perfectly thermostatted (Dirichlet boundary conditions), so boundary heat exchange via Newton’s law of cooling for convection and the Stefan–Boltzmann law for thermal radiation is not directly invoked; however, state clearly the conduction constitutive law used and begin from conservation of energy.\n\nStarting only from conservation of energy in 1D steady state and the constitutive law of heat conduction (Fourier’s law), derive the governing Ordinary Differential Equation (ODE) and obtain an analytic expression for the steady temperature field $T(x)$ for $0 \\le x \\le L$ in terms of $L$, $T_0$, $T_L$, $k_0$, and $\\beta$. Then, using the following parameter values that are scientifically plausible for a metallic bar,\n- $L = 0.20$ m,\n- $T_0 = 300$ K,\n- $T_L = 600$ K,\n- $k_0 = 200$ W m$^{-1}$ K$^{-1}$,\n- $\\beta = 1.0 \\times 10^{-3}$ K$^{-1}$,\nevaluate the exact temperature at the bar midpoint $x = L/2$.\n\nFor comparison, define the “constant-$k$ approximation” as replacing $k(T)$ by the constant $k_0$ (i.e., ignoring temperature dependence), and compute the corresponding midpoint temperature $T_{\\text{const}}(L/2)$. Finally, compute the difference between the exact midpoint temperature and the constant-$k$ approximation at the midpoint,\n$$\\Delta T_{\\text{mid}} = T(L/2) - T_{\\text{const}}(L/2).$$\nExpress the final answer for $\\Delta T_{\\text{mid}}$ in Kelvin. Round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, objective, and complete.\n\n### Step 1: Extract Givens\n- **System**: A straight, homogeneous bar.\n- **Geometry**: Length $L$, uniform cross-sectional area.\n- **Physics**: Steady, One-Dimensional (1D) conduction.\n- **Source Term**: Negligible axial heat generation.\n- **Boundary Conditions**: $T(x=0) = T_0$ and $T(x=L) = T_L$. These are Dirichlet boundary conditions.\n- **Constitutive Law**: Temperature-dependent thermal conductivity $k(T) = k_0 \\left(1 + \\beta T\\right)$.\n- **Numerical Parameters**:\n  - $L = 0.20$ m\n  - $T_0 = 300$ K\n  - $T_L = 600$ K\n  - $k_0 = 200$ W m$^{-1}$ K$^{-1}$\n  - $\\beta = 1.0 \\times 10^{-3}$ K$^{-1}$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes 1D steady-state heat conduction governed by Fourier's law. A linear temperature dependence for thermal conductivity, $k(T) = k_0 (1 + \\beta T)$, is a standard and physically realistic approximation for many materials over a limited temperature range. The provided parameters are plausible for a metallic bar. The problem is based on fundamental principles of heat transfer.\n- **Well-Posed**: The problem requires solving a second-order nonlinear Ordinary Differential Equation (ODE), which will be derived, subject to two Dirichlet boundary conditions. This constitutes a well-posed boundary value problem, for which a unique, stable, and meaningful solution is expected.\n- **Objective**: The problem is stated using precise, unambiguous scientific language.\n- **Conclusion**: The problem is valid. It is free from any scientific flaws, ambiguities, or missing information. The cross-sectional area $A$ is uniform and will cancel from the 1D governing equation, thus its specific value is not required.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Derivation of the Temperature Profile $T(x)$\n\nThe analysis begins with the principle of conservation of energy. For a 1D steady-state system with no internal heat generation, the energy balance on a differential control volume of length $dx$ and cross-sectional area $A$ is:\n$$ (A q_x)|_x - (A q_x)|_{x+dx} = 0 $$\nwhere $q_x$ is the heat flux in the $x$-direction. Dividing by the volume $A \\, dx$ and taking the limit as $dx \\to 0$ yields:\n$$ -\\frac{d(q_x)}{dx} = 0 $$\nThis implies that the heat flux $q_x$ is a constant along the bar. Let this constant be $C$.\n$$ q_x = C $$\nThe constitutive law for heat conduction (Fourier's law) relates the heat flux to the temperature gradient:\n$$ q_x = -k(T) \\frac{dT}{dx} $$\nSubstituting the given temperature-dependent thermal conductivity, $k(T) = k_0(1+\\beta T)$, we obtain:\n$$ C = -k_0(1+\\beta T) \\frac{dT}{dx} $$\nThis is a first-order separable ODE. We can separate variables and integrate.\n$$ \\int_0^x C \\, dx' = \\int_{T_0}^{T(x)} -k_0(1+\\beta T') \\, dT' $$\nIntegrating both sides gives:\n$$ C x = -k_0 \\left[ T' + \\frac{\\beta}{2} (T')^2 \\right]_{T_0}^{T(x)} $$\n$$ C x = -k_0 \\left( \\left( T(x) + \\frac{\\beta}{2} T(x)^2 \\right) - \\left( T_0 + \\frac{\\beta}{2} T_0^2 \\right) \\right) $$\nTo find the constant $C$, we apply the second boundary condition at $x=L$, where $T(L) = T_L$:\n$$ C L = -k_0 \\left( \\left( T_L + \\frac{\\beta}{2} T_L^2 \\right) - \\left( T_0 + \\frac{\\beta}{2} T_0^2 \\right) \\right) $$\n$$ C = -\\frac{k_0}{L} \\left( (T_L - T_0) + \\frac{\\beta}{2}(T_L^2 - T_0^2) \\right) $$\nSubstituting this expression for $C$ back into the integrated equation gives:\n$$ -\\frac{k_0 x}{L} \\left( (T_L - T_0) + \\frac{\\beta}{2}(T_L^2 - T_0^2) \\right) = -k_0 \\left( \\left( T(x) + \\frac{\\beta}{2} T(x)^2 \\right) - \\left( T_0 + \\frac{\\beta}{2} T_0^2 \\right) \\right) $$\nDividing by $-k_0$ and rearranging to solve for the quadratic term in $T(x)$:\n$$ T(x) + \\frac{\\beta}{2} T(x)^2 = \\left( T_0 + \\frac{\\beta}{2} T_0^2 \\right) + \\frac{x}{L} \\left( \\left( T_L + \\frac{\\beta}{2} T_L^2 \\right) - \\left( T_0 + \\frac{\\beta}{2} T_0^2 \\right) \\right) $$\nThis is a quadratic equation for $T(x)$ of the form $\\frac{\\beta}{2} T^2 + T - F(x) = 0$, where $F(x)$ represents the right-hand side.\nTo solve for $T(x)$, it is more elegant to complete the square on the quantity $(1+\\beta T)$. Let's multiply the equation by $2\\beta$ and add $1$:\n$$ \\beta^2 T(x)^2 + 2\\beta T(x) + 1 = 1 + 2\\beta \\left( T_0 + \\frac{\\beta}{2} T_0^2 \\right) + \\frac{x}{L} \\left[ 2\\beta\\left(T_L + \\frac{\\beta}{2}T_L^2\\right) - 2\\beta\\left(T_0 + \\frac{\\beta}{2}T_0^2\\right) \\right] $$\nThe left side is $(1+\\beta T(x))^2$. The right side simplifies to:\n$$ (1+\\beta T_0)^2 + \\frac{x}{L} \\left[ (1+\\beta T_L)^2 - (1+\\beta T_0)^2 \\right] $$\nThus, we have:\n$$ (1+\\beta T(x))^2 = (1+\\beta T_0)^2 + \\frac{x}{L} \\left[ (1+\\beta T_L)^2 - (1+\\beta T_0)^2 \\right] $$\nTaking the square root and solving for $T(x)$ (we choose the positive root since $T > 0$ and $\\beta > 0$):\n$$ T(x) = \\frac{1}{\\beta} \\left( \\sqrt{(1+\\beta T_0)^2 + \\frac{x}{L} \\left[ (1+\\beta T_L)^2 - (1+\\beta T_0)^2 \\right]} - 1 \\right) $$\nThis is the general analytic expression for the temperature profile.\n\n### Calculation of Midpoint Temperature $T(L/2)$\n\nAt the midpoint, $x=L/2$, the expression simplifies:\n$$ T(L/2) = \\frac{1}{\\beta} \\left( \\sqrt{(1+\\beta T_0)^2 + \\frac{1}{2} \\left[ (1+\\beta T_L)^2 - (1+\\beta T_0)^2 \\right]} - 1 \\right) $$\n$$ T(L/2) = \\frac{1}{\\beta} \\left( \\sqrt{\\frac{1}{2}(1+\\beta T_0)^2 + \\frac{1}{2}(1+\\beta T_L)^2} - 1 \\right) $$\nSubstituting the given numerical values: $T_0 = 300$ K, $T_L = 600$ K, and $\\beta = 1.0 \\times 10^{-3}$ K$^{-1}$.\nFirst, calculate the terms $(1+\\beta T)$:\n$$ 1 + \\beta T_0 = 1 + (1.0 \\times 10^{-3})(300) = 1 + 0.3 = 1.3 $$\n$$ 1 + \\beta T_L = 1 + (1.0 \\times 10^{-3})(600) = 1 + 0.6 = 1.6 $$\nNow, substitute these into the expression for $T(L/2)$:\n$$ T(L/2) = \\frac{1}{1.0 \\times 10^{-3}} \\left( \\sqrt{\\frac{1}{2}(1.3)^2 + \\frac{1}{2}(1.6)^2} - 1 \\right) $$\n$$ T(L/2) = 1000 \\left( \\sqrt{\\frac{1.69}{2} + \\frac{2.56}{2}} - 1 \\right) = 1000 \\left( \\sqrt{0.845 + 1.28} - 1 \\right) $$\n$$ T(L/2) = 1000 \\left( \\sqrt{2.125} - 1 \\right) $$\nUsing a calculator, $\\sqrt{2.125} \\approx 1.45773797$.\n$$ T(L/2) \\approx 1000 (1.45773797 - 1) = 457.73797 \\text{ K} $$\n\n### Constant-$k$ Approximation\n\nFor the constant-$k$ approximation, we set $k(T) = k_0$, which means $\\beta=0$. The governing ODE becomes:\n$$ \\frac{d}{dx} \\left( -k_0 \\frac{dT}{dx} \\right) = 0 \\implies \\frac{d^2T}{dx^2} = 0 $$\nThe solution is a linear profile:\n$$ T_{\\text{const}}(x) = C_1 x + C_2 $$\nApplying boundary conditions:\n- $T_{\\text{const}}(0) = T_0 \\implies C_2 = T_0$.\n- $T_{\\text{const}}(L) = T_L \\implies C_1 L + T_0 = T_L \\implies C_1 = \\frac{T_L - T_0}{L}$.\nSo, the temperature profile is:\n$$ T_{\\text{const}}(x) = T_0 + \\frac{T_L - T_0}{L} x $$\nAt the midpoint, $x=L/2$:\n$$ T_{\\text{const}}(L/2) = T_0 + \\frac{T_L - T_0}{2} = \\frac{T_0 + T_L}{2} $$\nSubstituting numerical values:\n$$ T_{\\text{const}}(L/2) = \\frac{300 + 600}{2} = \\frac{900}{2} = 450 \\text{ K} $$\n\n### Calculation of the Temperature Difference $\\Delta T_{\\text{mid}}$\n\nThe difference between the exact midpoint temperature and the constant-$k$ approximation is:\n$$ \\Delta T_{\\text{mid}} = T(L/2) - T_{\\text{const}}(L/2) $$\n$$ \\Delta T_{\\text{mid}} \\approx 457.73797 \\text{ K} - 450 \\text{ K} = 7.73797 \\text{ K} $$\nRounding to four significant figures as required:\n$$ \\Delta T_{\\text{mid}} \\approx 7.738 \\text{ K} $$",
            "answer": "$$\\boxed{7.738}$$"
        },
        {
            "introduction": "The classical constitutive laws often have limits, and this practice explores the frontier where Fourier's law breaks down. At the micro and nanoscales, or in materials subjected to extremely rapid heating, the assumption of instantaneous heat propagation is no longer valid. Here, we introduce the Cattaneo-Vernotte relation, which incorporates a heat-flux relaxation time $\\tau$ to account for the finite speed of thermal energy transport. This exercise  guides you through deriving the resulting hyperbolic \"telegrapher's equation,\" allowing you to calculate the speed of these thermal waves and determine the conditions under which this more advanced model is necessary.",
            "id": "3944409",
            "problem": "A one-dimensional crystalline nanoribbon of thickness much smaller than its other dimensions is suspended in high vacuum, so that convective and radiative exchanges with the environment are negligible during the transient of interest. Heat transport within the solid is governed by the energy conservation law and a hyperbolic conduction constitutive relation that accounts for finite heat-flux relaxation. Let the energy equation be $ \\rho c \\, \\frac{\\partial T}{\\partial t} + \\nabla \\cdot \\boldsymbol{q} = 0 $, where $ \\rho $ is the mass density, $ c $ is the specific heat capacity, $ T $ is the temperature field, $ t $ is time, and $ \\boldsymbol{q} $ is the heat flux vector. The conduction constitutive relation is the Cattaneo–Vernotte (CV) law: $ \\tau \\, \\frac{\\partial \\boldsymbol{q}}{\\partial t} + \\boldsymbol{q} = - k \\, \\nabla T $, where $ \\tau $ is the heat-flux relaxation time and $ k $ is the thermal conductivity. The thermal diffusivity is $ \\alpha = k / (\\rho c) $. Assume the material is homogeneous and isotropic, and consider small-amplitude, spatially one-dimensional disturbances.\n\nA localized heat pulse of duration $ \\Delta t $ is applied, and the relevant length scale for the temperature disturbance is $ L $. Starting from the stated energy conservation law and CV constitutive law, derive the hyperbolic temperature evolution equation, identify the characteristic thermal wave speed that emerges from this model, and compute its value. Then use that speed and the relaxation time to construct and evaluate the two dimensionless ratios $ \\Theta_t = \\Delta t / \\tau $ and $ \\Theta_L = L / \\ell $, where $ \\ell $ is the characteristic thermal propagation length over time $ \\tau $ implied by the hyperbolic model, and classify the transport regime as ballistic if both $ \\Theta_t < 1 $ and $ \\Theta_L < 1 $, otherwise diffusive. In the final answer, encode ballistic as $ 1 $ and diffusive as $ 0 $.\n\nUse the following data: $ \\alpha = 1.6 \\times 10^{-4} \\ \\mathrm{m^2/s} $, $ \\tau = 2.5 \\times 10^{-12} \\ \\mathrm{s} $, $ \\Delta t = 8.0 \\times 10^{-13} \\ \\mathrm{s} $, and $ L = 1.0 \\times 10^{-8} \\ \\mathrm{m} $. Express the thermal wave speed in $ \\mathrm{m/s} $ and round it to three significant figures. The final answer must be a two-entry row matrix containing the rounded thermal wave speed and the regime indicator as defined above.",
            "solution": "The problem is scientifically grounded, well-posed, objective, and contains all necessary information to proceed with a solution. The provided physical model and constants are consistent and realistic for nanoscale heat transport.\n\nThe derivation of the hyperbolic temperature evolution equation begins with the two provided governing laws:\nThe energy conservation law:\n$$ \\rho c \\, \\frac{\\partial T}{\\partial t} + \\nabla \\cdot \\boldsymbol{q} = 0 \\quad (1) $$\nThe Cattaneo–Vernotte (CV) constitutive relation:\n$$ \\tau \\, \\frac{\\partial \\boldsymbol{q}}{\\partial t} + \\boldsymbol{q} = - k \\, \\nabla T \\quad (2) $$\nHere, $T$ is temperature, $\\boldsymbol{q}$ is the heat flux vector, $t$ is time, $\\rho$ is mass density, $c$ is specific heat capacity, $k$ is thermal conductivity, and $\\tau$ is the heat-flux relaxation time.\n\nTo obtain a single equation for the temperature field $T$, we must eliminate the heat flux vector $\\boldsymbol{q}$. One method is to take the time derivative of the energy conservation equation $(1)$:\n$$ \\frac{\\partial}{\\partial t} \\left( \\rho c \\, \\frac{\\partial T}{\\partial t} + \\nabla \\cdot \\boldsymbol{q} \\right) = 0 $$\nSince $\\rho$ and $c$ are constant for a homogeneous material, this yields:\n$$ \\rho c \\, \\frac{\\partial^2 T}{\\partial t^2} + \\nabla \\cdot \\left( \\frac{\\partial \\boldsymbol{q}}{\\partial t} \\right) = 0 \\quad (3) $$\nNext, we rearrange the CV law $(2)$ to express $\\frac{\\partial \\boldsymbol{q}}{\\partial t}$:\n$$ \\frac{\\partial \\boldsymbol{q}}{\\partial t} = -\\frac{1}{\\tau} \\boldsymbol{q} - \\frac{k}{\\tau} \\nabla T $$\nSubstituting this expression into equation $(3)$:\n$$ \\rho c \\, \\frac{\\partial^2 T}{\\partial t^2} + \\nabla \\cdot \\left( -\\frac{1}{\\tau} \\boldsymbol{q} - \\frac{k}{\\tau} \\nabla T \\right) = 0 $$\nDistributing the divergence operator and assuming $k$ and $\\tau$ are spatially constant:\n$$ \\rho c \\, \\frac{\\partial^2 T}{\\partial t^2} - \\frac{1}{\\tau} (\\nabla \\cdot \\boldsymbol{q}) - \\frac{k}{\\tau} \\nabla^2 T = 0 $$\nNow, we use the original energy equation $(1)$ to substitute for $\\nabla \\cdot \\boldsymbol{q} = - \\rho c \\, \\frac{\\partial T}{\\partial t}$:\n$$ \\rho c \\, \\frac{\\partial^2 T}{\\partial t^2} - \\frac{1}{\\tau} \\left( - \\rho c \\, \\frac{\\partial T}{\\partial t} \\right) - \\frac{k}{\\tau} \\nabla^2 T = 0 $$\nThis simplifies to:\n$$ \\rho c \\, \\frac{\\partial^2 T}{\\partial t^2} + \\frac{\\rho c}{\\tau} \\frac{\\partial T}{\\partial t} - \\frac{k}{\\tau} \\nabla^2 T = 0 $$\nDividing the entire equation by $\\rho c$ gives:\n$$ \\frac{\\partial^2 T}{\\partial t^2} + \\frac{1}{\\tau} \\frac{\\partial T}{\\partial t} - \\frac{k}{\\rho c \\tau} \\nabla^2 T = 0 $$\nUsing the definition of thermal diffusivity, $\\alpha = k / (\\rho c)$, we arrive at the final hyperbolic temperature evolution equation, also known as the Telegrapher's equation for heat conduction:\n$$ \\frac{\\partial^2 T}{\\partial t^2} + \\frac{1}{\\tau} \\frac{\\partial T}{\\partial t} = \\frac{\\alpha}{\\tau} \\nabla^2 T $$\nFor the specified one-dimensional case, $\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2}$.\n\nThis equation is a form of the general wave equation. The standard form of a 1D damped wave equation is $ \\frac{\\partial^2 u}{\\partial t^2} + \\gamma \\frac{\\partial u}{\\partial t} = v^2 \\frac{\\partial^2 u}{\\partial x^2} $, where $v$ is the wave propagation speed. By comparing our derived equation to this standard form, we identify the square of the characteristic thermal wave speed, $v_{th}$, as the coefficient of the spatial derivative term:\n$$ v_{th}^2 = \\frac{\\alpha}{\\tau} $$\nTherefore, the thermal wave speed is:\n$$ v_{th} = \\sqrt{\\frac{\\alpha}{\\tau}} $$\nUsing the provided data, $\\alpha = 1.6 \\times 10^{-4} \\ \\mathrm{m^2/s}$ and $\\tau = 2.5 \\times 10^{-12} \\ \\mathrm{s}$:\n$$ v_{th} = \\sqrt{\\frac{1.6 \\times 10^{-4} \\ \\mathrm{m^2/s}}{2.5 \\times 10^{-12} \\ \\mathrm{s}}} = \\sqrt{0.64 \\times 10^{8} \\ \\mathrm{m^2/s^2}} = \\sqrt{64 \\times 10^{6} \\ \\mathrm{m^2/s^2}} $$\n$$ v_{th} = 8.0 \\times 10^3 \\ \\mathrm{m/s} $$\nRounding to three significant figures, the speed is $8.00 \\times 10^3 \\ \\mathrm{m/s}$.\n\nNext, we evaluate the dimensionless ratios. First, we compute the characteristic thermal propagation length, $\\ell$, defined as the distance a thermal wave travels in the relaxation time $\\tau$:\n$$ \\ell = v_{th} \\times \\tau = (8.00 \\times 10^3 \\ \\mathrm{m/s}) \\times (2.5 \\times 10^{-12} \\ \\mathrm{s}) = 20 \\times 10^{-9} \\ \\mathrm{m} = 2.0 \\times 10^{-8} \\ \\mathrm{m} $$\nThe two dimensionless ratios are $\\Theta_t = \\Delta t / \\tau$ and $\\Theta_L = L / \\ell$.\nUsing the given data, $\\Delta t = 8.0 \\times 10^{-13} \\ \\mathrm{s}$, $\\tau = 2.5 \\times 10^{-12} \\ \\mathrm{s}$, and $L = 1.0 \\times 10^{-8} \\ \\mathrm{m}$:\n$$ \\Theta_t = \\frac{8.0 \\times 10^{-13} \\ \\mathrm{s}}{2.5 \\times 10^{-12} \\ \\mathrm{s}} = 0.32 $$\n$$ \\Theta_L = \\frac{1.0 \\times 10^{-8} \\ \\mathrm{m}}{2.0 \\times 10^{-8} \\ \\mathrm{m}} = 0.5 $$\nThe transport regime is classified as ballistic if both $\\Theta_t < 1$ and $\\Theta_L < 1$.\nIn this case, we have $0.32 < 1$ and $0.5 < 1$. Both conditions are satisfied. Thus, the regime is ballistic.\nThe problem requires encoding the ballistic regime as the number $1$.\n\nThe final answer requires a two-entry row matrix containing the rounded thermal wave speed and the regime indicator.\nThe thermal wave speed is $8.00 \\times 10^3 \\ \\mathrm{m/s}$.\nThe regime indicator is $1$.\nThe final matrix is $(8.00 \\times 10^3, 1)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 8.00 \\times 10^{3} & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Moving from conduction to radiation, we tackle the complex problem of heat exchange within an enclosure of multiple surfaces. The radiosity method, which is derived from the constitutive laws governing emission and reflection from diffuse-gray surfaces, provides a powerful framework for this analysis. This hands-on computational exercise  requires you to translate these fundamental physical principles—including view factors, emissivity, and the Stefan-Boltzmann law—into a robust numerical solver. Building this program from the ground up will solidify your understanding of how radiative properties and geometry are formulated into a solvable system of equations, a cornerstone of computational thermal analysis.",
            "id": "3944336",
            "problem": "You are to develop a complete, runnable program that constructs and solves the radiation network for an enclosure of $N$ diffuse gray, isothermal surfaces in a vacuum (no participating medium), using view factors. The computational task is to derive the system of equations from first principles and then solve for the unknown surface radiosities and the net radiative heat rates. The implementation must adhere to the following requirements.\n\nFundamental base to use and derive from:\n- Radiative heat transfer in a vacuum is governed by the Stefan–Boltzmann law, where the ideal blackbody emission from surface $i$ at absolute temperature $T_i$ is $E_{b,i} = \\sigma T_i^4$, with $\\sigma$ the Stefan–Boltzmann constant.\n- For a diffuse gray surface $i$, the radiosity $J_i$ (the total radiant energy leaving the surface per unit area) is the sum of emitted and reflected radiation. Let the emissivity be $\\varepsilon_i$ and the reflectivity be $\\rho_i$, with the constraint $\\varepsilon_i + \\rho_i = 1$ for an opaque surface. The irradiation $H_i$ (incident radiation on the surface per unit area) is due to radiation leaving other surfaces.\n- View factors $F_{ij}$ quantify the fraction of radiation leaving surface $i$ that arrives at surface $j$. They satisfy the constraints $\\sum_{j=1}^{N} F_{ij} = 1$ for each $i$, and the reciprocity relation $A_i F_{ij} = A_j F_{ji}$ for all $i,j$, where $A_i$ is the area of surface $i$.\n- The physical energy balance for each surface supplies the equations needed to solve for $J_i$ and the net heat rate $q_i$. Derive the relationship for $J_i$ in terms of $\\varepsilon_i$, $T_i$, and the irradiation $H_i$, and then express $H_i$ in terms of the view factors and the unknown radiosities of all surfaces. Use these to formulate a linear system of $N$ equations in $N$ unknown radiosities. Then, compute the net radiative heat rate for each surface from the solved radiosities and irradiations.\n- Do not introduce any shortcut formulas not directly derivable from the above physical definitions and constraints. The derivation must proceed from the definitions of radiosity, irradiation, emissivity, reflectivity, and the view factor relations.\n\nDefinitions and units:\n- The Stefan–Boltzmann constant is $\\sigma = 5.670374419 \\times 10^{-8} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}$.\n- The unknown radiosities $J_i$ must be reported in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n- The net radiative heat rates $q_i$ must be reported in $\\mathrm{W}$ and are defined as the net outward radiation from each surface.\n\nNumerical test suite:\nImplement your solution for the following test cases. Each test case specifies $N$, areas $A$, emissivities $\\varepsilon$, temperatures $T$ (absolute, in $\\mathrm{K}$), and a view factor matrix $F$ with entries $F_{ij}$.\n\n- Test case $1$ (two parallel plates):\n    - $N = 2$\n    - $A = [\\,1.0,\\,1.0\\,] \\,\\mathrm{m^2}$\n    - $\\varepsilon = [\\,0.8,\\,0.6\\,]$\n    - $T = [\\,1200.0,\\,800.0\\,] \\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0.0 & 1.0 \\\\ 1.0 & 0.0 \\end{bmatrix}$\n\n- Test case $2$ (one large surface facing two small patches, enclosure closed):\n    - $N = 3$\n    - $A = [\\,2.0,\\,1.0,\\,1.0\\,] \\,\\mathrm{m^2}$\n    - $\\varepsilon = [\\,0.9,\\,0.3,\\,0.7\\,]$\n    - $T = [\\,900.0,\\,600.0,\\,300.0\\,] \\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0.0 & 0.5 & 0.5 \\\\ 1.0 & 0.0 & 0.0 \\\\ 1.0 & 0.0 & 0.0 \\end{bmatrix}$\n\n- Test case $3$ (concave surfaces with self-view and equal temperatures):\n    - $N = 2$\n    - $A = [\\,1.0,\\,1.0\\,] \\,\\mathrm{m^2}$\n    - $\\varepsilon = [\\,1.0,\\,0.05\\,]$\n    - $T = [\\,1000.0,\\,1000.0\\,] \\,\\mathrm{K}$\n    - $F = \\begin{bmatrix} 0.2 & 0.8 \\\\ 0.8 & 0.2 \\end{bmatrix}$\n\n- Test case $4$ (four-surface symmetric cavity with equal areas):\n    - $N = 4$\n    - $A = [\\,1.0,\\,1.0,\\,1.0,\\,1.0\\,] \\,\\mathrm{m^2}$\n    - $\\varepsilon = [\\,0.4,\\,1.0,\\,0.6,\\,0.2\\,]$\n    - $T = [\\,500.0,\\,700.0,\\,650.0,\\,300.0\\,] \\,\\mathrm{K}$\n    - $F$ has $F_{ii} = 0.0$ and $F_{ij} = \\frac{1}{3}$ for $i \\neq j$:\n      $F = \\begin{bmatrix}\n      0.0 & \\tfrac{1}{3} & \\tfrac{1}{3} & \\tfrac{1}{3} \\\\\n      \\tfrac{1}{3} & 0.0 & \\tfrac{1}{3} & \\tfrac{1}{3} \\\\\n      \\tfrac{1}{3} & \\tfrac{1}{3} & 0.0 & \\tfrac{1}{3} \\\\\n      \\tfrac{1}{3} & \\tfrac{1}{3} & \\tfrac{1}{3} & 0.0\n      \\end{bmatrix}$\n\nProgram requirements and output specification:\n- For each test case, compute the radiosities $J_i$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}$ and the net radiative heat rates $q_i$ in $\\mathrm{W}$, for $i = 1,\\dots,N$, strictly derived from the base principles listed above. Additionally, compute a boolean indicator that is true if the total net heat rate satisfies the enclosure energy conservation to within a tight numerical tolerance, i.e., $\\left|\\sum_{i=1}^{N} q_i\\right| \\leq \\delta$, where $\\delta$ is a small positive threshold chosen by you for numerical stability.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. Each test case result must be a list of the form $[J_1,\\dots,J_N,q_1,\\dots,q_N,\\text{energy\\_balance\\_ok}]$. Therefore, the final output must be a single list whose elements are these per-test-case lists, printed as a single line, like $[\\,[\\dots],\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$.",
            "solution": "The problem of determining the steady-state radiative heat exchange among $N$ diffuse, gray, isothermal surfaces forming an enclosure in a vacuum is a classic problem in thermal engineering. The solution requires formulating and solving a system of linear algebraic equations for the surface radiosities, from which the net heat rates can then be calculated. The derivation proceeds from the fundamental principles of radiative transfer as specified.\n\nFirst, we define the key quantities for each surface $i$ in the enclosure, where $i$ ranges from $1$ to $N$.\nThe blackbody emissive power, $E_{b,i}$, is the total thermal radiation emitted per unit area by an ideal blackbody at an absolute temperature $T_i$. It is given by the Stefan-Boltzmann law:\n$$ E_{b,i} = \\sigma T_i^4 $$\nwhere $\\sigma$ is the Stefan-Boltzmann constant ($\\sigma = 5.670374419 \\times 10^{-8} \\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}$).\n\nThe radiosity, $J_i$, is the total radiant energy leaving surface $i$ per unit area. For a diffuse, gray surface, this is the sum of the energy emitted by the surface and the portion of incident energy that is reflected. The emitted energy is $\\varepsilon_i E_{b,i}$, where $\\varepsilon_i$ is the emissivity of the surface. The reflected energy is $\\rho_i H_i$, where $H_i$ is the irradiation (total incident radiation per unit area on surface $i$) and $\\rho_i$ is the reflectivity. Thus, the definition of radiosity is:\n$$ J_i = \\varepsilon_i E_{b,i} + \\rho_i H_i $$\nFor an opaque surface, the properties of emissivity, reflectivity, and absorptivity ($\\alpha_i$) are related. For a gray surface, $\\alpha_i = \\varepsilon_i$. By conservation of energy for an opaque surface, $\\alpha_i + \\rho_i = 1$, which implies $\\varepsilon_i + \\rho_i = 1$. Therefore, we can write the reflectivity as $\\rho_i = 1 - \\varepsilon_i$. Substituting this into the radiosity equation yields:\n$$ J_i = \\varepsilon_i E_{b,i} + (1 - \\varepsilon_i) H_i \\quad (1) $$\n\nNext, we must express the irradiation $H_i$ in terms of the radiosities of all surfaces in the enclosure. The total radiative energy leaving surface $j$ is $A_j J_j$, where $A_j$ is the area of surface $j$. The view factor $F_{ji}$ represents the fraction of energy leaving surface $j$ that is intercepted by surface $i$. The total energy incident upon surface $i$ from all surfaces (including itself if $F_{ii} > 0$) is the sum $\\sum_{j=1}^{N} (A_j J_j) F_{ji}$. The irradiation $H_i$ is this total incident energy divided by the area $A_i$:\n$$ H_i = \\frac{1}{A_i} \\sum_{j=1}^{N} A_j J_j F_{ji} $$\nA fundamental property of view factors is the reciprocity relation: $A_i F_{ij} = A_j F_{ji}$. Applying this relation simplifies the expression for irradiation:\n$$ H_i = \\frac{1}{A_i} \\sum_{j=1}^{N} (A_i F_{ij}) J_j = \\sum_{j=1}^{N} F_{ij} J_j \\quad (2) $$\nThis equation elegantly states that the irradiation on a surface is the view-factor-weighted sum of all radiosities in the enclosure.\n\nWe now have a system of $N$ equations relating the radiosities $J_i$ and irradiations $H_i$. To solve for the unknown radiosities, we substitute the expression for $H_i$ from equation $(2)$ into equation $(1)$:\n$$ J_i = \\varepsilon_i E_{b,i} + (1 - \\varepsilon_i) \\sum_{j=1}^{N} F_{ij} J_j $$\nThis equation holds for each surface $i = 1, \\dots, N$. To solve for the vector of unknown radiosities $\\mathbf{J} = [J_1, J_2, \\dots, J_N]^T$, we rearrange the equation to group all terms involving $J_j$ on one side:\n$$ J_i - (1 - \\varepsilon_i) \\sum_{j=1}^{N} F_{ij} J_j = \\varepsilon_i E_{b,i} $$\nThis can be written as a single system of $N$ linear equations in $N$ unknowns. For each equation $i$, the coefficient of $J_j$ can be identified. Using the Kronecker delta, $\\delta_{ij}$ (which is $1$ if $i=j$ and $0$ otherwise), we can write the system compactly:\n$$ \\sum_{j=1}^{N} (\\delta_{ij} - (1 - \\varepsilon_i) F_{ij}) J_j = \\varepsilon_i E_{b,i} $$\nThis represents the linear system $\\mathbf{M} \\mathbf{J} = \\mathbf{C}$, where:\n- The coefficient matrix $\\mathbf{M}$ has elements $M_{ij} = \\delta_{ij} - (1 - \\varepsilon_i) F_{ij}$.\n- The unknown vector is $\\mathbf{J} = [J_1, J_2, \\dots, J_N]^T$.\n- The right-hand side vector $\\mathbf{C}$ has elements $C_i = \\varepsilon_i E_{b,i} = \\varepsilon_i \\sigma T_i^4$.\nThis system can be solved using standard linear algebra libraries to obtain the radiosities $J_i$ for all surfaces. Note that if a surface $i$ is a blackbody ($\\varepsilon_i = 1$), the $i$-th equation correctly simplifies to $J_i = E_{b,i}$.\n\nOnce the radiosities $J_i$ are determined, we can calculate the net radiative heat rate, $q_i$, for each surface. The net heat rate is the difference between the total energy leaving the surface and the total energy incident upon it. On a per-unit-area basis (flux), this is $J_i - H_i$. The total net heat rate for surface $i$ is thus:\n$$ q_i = A_i (J_i - H_i) $$\nSubstituting the expression for $H_i$ from equation $(2)$:\n$$ q_i = A_i \\left( J_i - \\sum_{j=1}^{N} F_{ij} J_j \\right) \\quad (3) $$\nThis form is computationally robust and directly applicable once the vector $\\mathbf{J}$ is known. The term $\\sum_{j=1}^{N} F_{ij} J_j$ is simply the $i$-th component of the matrix-vector product $\\mathbf{F} \\mathbf{J}$. A positive value of $q_i$ indicates net heat flow out of the surface, while a negative value indicates net heat flow into the surface.\n\nFinally, for an enclosure, the total net heat exchange must be zero due to energy conservation. A numerical check can be performed by summing the calculated heat rates:\n$$ \\sum_{i=1}^{N} q_i \\approx 0 $$\nThe deviation from zero is a measure of the numerical accuracy of the solution. We will verify that $|\\sum_{i=1}^{N} q_i| \\le \\delta$ for a small tolerance $\\delta$.\n\nThe computational procedure is as follows:\n1. For each test case, given $N$, $A_i$, $\\varepsilon_i$, $T_i$, and the view factor matrix $F_{ij}$, compute the blackbody emissive powers $E_{b,i} = \\sigma T_i^4$.\n2. Construct the $N \\times N$ matrix $\\mathbf{M}$ and the $N \\times 1$ vector $\\mathbf{C}$ as derived above.\n3. Solve the linear system $\\mathbf{M} \\mathbf{J} = \\mathbf{C}$ for the radiosity vector $\\mathbf{J}$.\n4. Compute the irradiation vector $\\mathbf{H} = \\mathbf{F} \\mathbf{J}$.\n5. Calculate the net heat rate for each surface using $q_i = A_i(J_i - H_i)$.\n6. Verify energy conservation by checking if $|\\sum q_i|$ is within a specified numerical tolerance.\n7. Collate results $[J_1, \\dots, J_N, q_1, \\dots, q_N, \\text{energy\\_balance\\_ok}]$ for each test case.\nThis systematic approach, derived from first principles, provides a complete solution to the problem.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and solves the radiation network for an enclosure of N diffuse\n    gray, isothermal surfaces, based on first principles.\n    \"\"\"\n    # Define the Stefan-Boltzmann constant\n    SIGMA = 5.670374419e-8  # W m^-2 K^-4\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"N\": 2,\n            \"A\": np.array([1.0, 1.0]),\n            \"eps\": np.array([0.8, 0.6]),\n            \"T\": np.array([1200.0, 800.0]),\n            \"F\": np.array([[0.0, 1.0], [1.0, 0.0]])\n        },\n        {\n            \"N\": 3,\n            \"A\": np.array([2.0, 1.0, 1.0]),\n            \"eps\": np.array([0.9, 0.3, 0.7]),\n            \"T\": np.array([900.0, 600.0, 300.0]),\n            \"F\": np.array([[0.0, 0.5, 0.5], [1.0, 0.0, 0.0], [1.0, 0.0, 0.0]])\n        },\n        {\n            \"N\": 2,\n            \"A\": np.array([1.0, 1.0]),\n            \"eps\": np.array([1.0, 0.05]),\n            \"T\": np.array([1000.0, 1000.0]),\n            \"F\": np.array([[0.2, 0.8], [0.8, 0.2]])\n        },\n        {\n            \"N\": 4,\n            \"A\": np.array([1.0, 1.0, 1.0, 1.0]),\n            \"eps\": np.array([0.4, 1.0, 0.6, 0.2]),\n            \"T\": np.array([500.0, 700.0, 650.0, 300.0]),\n            \"F\": np.array([\n                [0.0, 1/3, 1/3, 1/3],\n                [1/3, 0.0, 1/3, 1/3],\n                [1/3, 1/3, 0.0, 1/3],\n                [1/3, 1/3, 1/3, 0.0]\n            ])\n        }\n    ]\n\n    results = []\n    # Tolerance for energy balance check\n    delta_tolerance = 1e-6\n\n    for case in test_cases:\n        N = case[\"N\"]\n        A = case[\"A\"]\n        eps = case[\"eps\"]\n        T = case[\"T\"]\n        F = case[\"F\"]\n\n        # Step 1: Calculate blackbody emissive power for each surface\n        E_b = SIGMA * (T ** 4)\n\n        # Step 2: Construct the coefficient matrix M for the linear system M*J = C\n        # M_ij = delta_ij - (1 - eps_i) * F_ij\n        M = np.identity(N) - np.diag(1 - eps) @ F\n\n        # Step 3: Construct the constant vector C\n        # C_i = eps_i * E_b_i\n        C = eps * E_b\n\n        # Step 4: Solve the linear system for the radiosities J\n        J = np.linalg.solve(M, C)\n\n        # Step 5: Calculate the irradiation H vector\n        # H_i = sum_j(F_ij * J_j)\n        H = F @ J\n\n        # Step 6: Calculate the net radiative heat rates q\n        # q_i = A_i * (J_i - H_i)\n        q = A * (J - H)\n\n        # Step 7: Check for energy conservation\n        total_q = np.sum(q)\n        energy_balance_ok = abs(total_q) <= delta_tolerance\n\n        # Step 8: Format the results for this case\n        case_result = list(J) + list(q) + [energy_balance_ok]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The string representation of a list includes spaces, which we remove\n    # to match a compact list style representation if needed, but standard str() is fine.\n    # e.g., '[1.0, 2.0]' becomes '[1.0,2.0]'\n    result_strings = []\n    for res in results:\n        # Convert each item in the list to its string representation\n        # and format floats to a consistent number of decimal places for cleaner output.\n        s = '[' + ', '.join([f'{x:.7f}' if isinstance(x, float) else str(x) for x in res]) + ']'\n        result_strings.append(s)\n\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}