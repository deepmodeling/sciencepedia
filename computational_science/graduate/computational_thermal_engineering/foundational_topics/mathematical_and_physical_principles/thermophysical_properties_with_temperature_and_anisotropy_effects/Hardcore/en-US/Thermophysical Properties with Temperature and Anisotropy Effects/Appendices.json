{
    "hands_on_practices": [
        {
            "introduction": "In anisotropic materials, heat does not necessarily flow in the direction of the steepest temperature drop. This complex behavior is captured by the thermal conductivity tensor, $\\mathbf{K}$. This exercise provides hands-on practice in diagonalizing this tensor to find its principal conductivities and directions, which correspond to its eigenvalues and eigenvectors, respectively. Mastering this fundamental analysis is the first step toward building accurate computational models for anisotropic heat transfer.",
            "id": "3997961",
            "problem": "Consider steady conduction in an anisotropic solid where the constitutive relation is given by Fourier’s law in tensor form, $\\,\\boldsymbol{q}=-\\boldsymbol{K}(T)\\,\\nabla T\\,$, with $\\boldsymbol{K}(T)$ the second-order thermal conductivity tensor that may depend on temperature $T$. For macroscopically homogeneous media without external fields, reciprocity implies that $\\boldsymbol{K}(T)$ is symmetric and, for physical stability, positive definite. Principal conductivities and principal directions are defined by the spectral properties of $\\boldsymbol{K}(T)$.\n\nA unidirectionally reinforced composite exhibits in-plane coupling due to fiber misalignment, while remaining uncoupled in the thickness direction. Its temperature-dependent conductivity tensor in the laboratory basis $\\{x,y,z\\}$ is modeled as\n$$\n\\boldsymbol{K}(T)=\n\\begin{pmatrix}\nk_{xx}(T) & k_{xy}(T) & 0 \\\\\nk_{xy}(T) & k_{yy}(T) & 0 \\\\\n0 & 0 & k_{zz}(T)\n\\end{pmatrix},\n$$\nwith linear temperature dependence about $T_{0} = 300\\,\\mathrm{K}$,\n$$\nk_{xx}(T)=k_{xx,0}+\\alpha_{xx}\\,(T-T_{0}),\\quad\nk_{yy}(T)=k_{yy,0}+\\alpha_{yy}\\,(T-T_{0}),\\quad\nk_{xy}(T)=k_{xy,0}+\\alpha_{xy}\\,(T-T_{0}),\\quad\nk_{zz}(T)=k_{zz,0}+\\alpha_{zz}\\,(T-T_{0}),\n$$\nwhere $k_{xx,0}=6$, $\\alpha_{xx}=0.03$, $k_{yy,0}=5$, $\\alpha_{yy}=0.03$, $k_{xy,0}=2$, $\\alpha_{xy}=0.02$, $k_{zz,0}=3$, and $\\alpha_{zz}=0.04$, in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ per kelvin for the coefficients $\\alpha$. At $T=330\\,\\mathrm{K}$, evaluate the principal conductivities and the corresponding principal directions by computing the eigenvalues and normalized eigenvectors of $\\boldsymbol{K}(T)$.\n\nStarting from Fourier’s law and the symmetry/positive-definiteness of $\\boldsymbol{K}(T)$, first justify why principal conductivities and directions are obtained from the eigenvalue problem for $\\boldsymbol{K}(T)$. Then compute the eigenvalues and normalized eigenvectors explicitly for the given $\\boldsymbol{K}(T)$ at $T=330\\,\\mathrm{K}$.\n\nExpress the principal conductivities in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ and express the principal directions as direction cosines (dimensionless) with respect to the $\\{x,y,z\\}$ basis. Provide exact analytical forms; do not round. For the final answer, list in order the three principal conductivities followed by the $x$, $y$, and $z$ components of each corresponding normalized eigenvector.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of continuum mechanics and heat transfer, is well-posed, and provides all necessary information for a unique solution.\n\nFirst, we justify the use of an eigenvalue problem to find the principal conductivities and directions. A principal direction of thermal conductivity is a direction, represented by a unit vector $\\boldsymbol{n}$, in which a temperature gradient, $\\nabla T$, produces a heat flux vector, $\\boldsymbol{q}$, that is purely anti-parallel to the gradient. That is, if $\\nabla T$ is aligned with $\\boldsymbol{n}$, then $\\boldsymbol{q}$ is also aligned with $\\boldsymbol{n}$ but in the opposite direction.\n\nLet the temperature gradient be $\\nabla T = G\\boldsymbol{n}$, where $G = |\\nabla T|$ is the magnitude of the gradient. The condition for $\\boldsymbol{n}$ to be a principal direction is that the resulting heat flux is $\\boldsymbol{q} = -k_n G\\boldsymbol{n}$, where $k_n$ is the scalar conductivity in that direction, i.e., the principal conductivity.\n\nSubstituting these into Fourier's law, $\\boldsymbol{q} = -\\boldsymbol{K}(T)\\nabla T$, we get:\n$$ -k_n G\\boldsymbol{n} = -\\boldsymbol{K}(T)(G\\boldsymbol{n}) $$\nSince $G$ is a non-zero scalar, we can divide by $-G$:\n$$ k_n \\boldsymbol{n} = \\boldsymbol{K}(T)\\boldsymbol{n} $$\nRewriting this in the standard form for an eigenvalue problem:\n$$ \\boldsymbol{K}(T)\\boldsymbol{n} = k_n \\boldsymbol{n} $$\nThis equation shows that the principal conductivities, $k_n$, are the eigenvalues of the thermal conductivity tensor $\\boldsymbol{K}(T)$, and the corresponding principal directions are its eigenvectors $\\boldsymbol{n}$. Since the problem states that $\\boldsymbol{K}(T)$ is symmetric and positive definite, the spectral theorem guarantees that it has real, positive eigenvalues (physically necessary conductivities) and a set of three mutually orthogonal eigenvectors (the principal axes of conductivity).\n\nNow, we proceed to compute these quantities for the given problem.\nThe temperature is $T = 330\\,\\mathrm{K}$, and the reference temperature is $T_0 = 300\\,\\mathrm{K}$. The temperature difference is $T - T_0 = 30\\,\\mathrm{K}$.\nWe first evaluate the components of the conductivity tensor $\\boldsymbol{K}$ at $T=330\\,\\mathrm{K}$:\n$k_{xx}(T) = k_{xx,0} + \\alpha_{xx}(T-T_0) = 6 + (0.03)(30) = 6 + 0.9 = 6.9$\n$k_{yy}(T) = k_{yy,0} + \\alpha_{yy}(T-T_0) = 5 + (0.03)(30) = 5 + 0.9 = 5.9$\n$k_{xy}(T) = k_{xy,0} + \\alpha_{xy}(T-T_0) = 2 + (0.02)(30) = 2 + 0.6 = 2.6$\n$k_{zz}(T) = k_{zz,0} + \\alpha_{zz}(T-T_0) = 3 + (0.04)(30) = 3 + 1.2 = 4.2$\n\nAll values are in units of $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$. The conductivity tensor is:\n$$\n\\boldsymbol{K} =\n\\begin{pmatrix}\n6.9 & 2.6 & 0 \\\\\n2.6 & 5.9 & 0 \\\\\n0 & 0 & 4.2\n\\end{pmatrix}\n$$\nTo find the eigenvalues $\\lambda$, we solve the characteristic equation $\\det(\\boldsymbol{K} - \\lambda\\boldsymbol{I}) = 0$:\n$$\n\\det\n\\begin{pmatrix}\n6.9 - \\lambda & 2.6 & 0 \\\\\n2.6 & 5.9 - \\lambda & 0 \\\\\n0 & 0 & 4.2 - \\lambda\n\\end{pmatrix} = 0\n$$\nDue to the block-diagonal structure, this expands to:\n$$ (4.2 - \\lambda) \\left[ (6.9 - \\lambda)(5.9 - \\lambda) - (2.6)^2 \\right] = 0 $$\nOne eigenvalue is immediately apparent: $\\lambda_3 = 4.2$.\n\nThe other two eigenvalues are roots of the quadratic equation from the $2 \\times 2$ sub-block:\n$$ \\lambda^2 - (6.9 + 5.9)\\lambda + (6.9)(5.9) - (2.6)^2 = 0 $$\n$$ \\lambda^2 - 12.8\\lambda + 40.71 - 6.76 = 0 $$\n$$ \\lambda^2 - 12.8\\lambda + 33.95 = 0 $$\nTo maintain precision, we work with fractions: $k_{xx} = \\frac{69}{10}$, $k_{yy} = \\frac{59}{10}$, $k_{xy} = \\frac{26}{10}$. The equation is $\\lambda^2 - \\frac{128}{10}\\lambda + \\frac{3395}{100} = 0$, which is $20\\lambda^2 - 256\\lambda + 679 = 0$.\nUsing the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$ \\lambda = \\frac{256 \\pm \\sqrt{(-256)^2 - 4(20)(679)}}{2(20)} = \\frac{256 \\pm \\sqrt{65536 - 54320}}{40} = \\frac{256 \\pm \\sqrt{11216}}{40} $$\nThe discriminant can be simplified: $\\sqrt{11216} = \\sqrt{16 \\times 701} = 4\\sqrt{701}$.\n$$ \\lambda = \\frac{256 \\pm 4\\sqrt{701}}{40} = \\frac{64 \\pm \\sqrt{701}}{10} $$\nSo, the other two principal conductivities are $\\lambda_1 = \\frac{64 + \\sqrt{701}}{10}$ and $\\lambda_2 = \\frac{64 - \\sqrt{701}}{10}$.\n\nThe three principal conductivities are:\n$\\lambda_1 = \\frac{64 + \\sqrt{701}}{10}$\n$\\lambda_2 = \\frac{64 - \\sqrt{701}}{10}$\n$\\lambda_3 = 4.2 = \\frac{21}{5}$\n\nNext, we find the corresponding normalized eigenvectors (principal directions).\nFor $\\lambda_3 = 4.2$, we solve $(\\boldsymbol{K} - 4.2\\boldsymbol{I})\\boldsymbol{v}_3 = \\boldsymbol{0}$:\n$$\n\\begin{pmatrix}\n2.7 & 2.6 & 0 \\\\\n2.6 & 1.7 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix} v_x \\\\ v_y \\\\ v_z \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe first two rows give a system for $v_x, v_y$ with a non-zero determinant ($(2.7)(1.7) - (2.6)^2 = 4.59 - 6.76 = -2.17$), so $v_x=0$ and $v_y=0$. The third row $0 \\cdot v_z=0$ is satisfied for any $v_z$. We choose $v_z=1$ to get a unit vector.\nThe normalized eigenvector for $\\lambda_3$ is $\\boldsymbol{n}_3 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$.\n\nFor $\\lambda_1$ and $\\lambda_2$, the eigenvectors lie in the $xy$-plane, so $v_z=0$. We solve $(\\boldsymbol{K}_{xy} - \\lambda \\boldsymbol{I})\\boldsymbol{v} = \\boldsymbol{0}$, where $\\boldsymbol{K}_{xy}$ is the upper-left $2 \\times 2$ submatrix.\nUsing the first row of the system, $(6.9 - \\lambda)v_x + 2.6v_y = 0$, or $(69-10\\lambda)v_x + 26v_y = 0$.\n\nFor $\\lambda_1 = \\frac{64 + \\sqrt{701}}{10}$:\n$10\\lambda_1 = 64 + \\sqrt{701}$.\n$(69 - (64 + \\sqrt{701}))v_x + 26v_y = 0 \\implies (5 - \\sqrt{701})v_x + 26v_y = 0$.\nWe can choose an unnormalized eigenvector as $\\boldsymbol{v}_1' = \\begin{pmatrix} 26 \\\\ \\sqrt{701} - 5 \\\\ 0 \\end{pmatrix}$.\nThe squared norm is $|\\boldsymbol{v}_1'|^2 = 26^2 + (\\sqrt{701}-5)^2 = 676 + (701 - 10\\sqrt{701} + 25) = 1402 - 10\\sqrt{701}$.\nThe normalized eigenvector is $\\boldsymbol{n}_1 = \\frac{1}{\\sqrt{1402 - 10\\sqrt{701}}} \\begin{pmatrix} 26 \\\\ \\sqrt{701}-5 \\\\ 0 \\end{pmatrix}$.\n\nFor $\\lambda_2 = \\frac{64 - \\sqrt{701}}{10}$:\n$10\\lambda_2 = 64 - \\sqrt{701}$.\n$(69 - (64 - \\sqrt{701}))v_x + 26v_y = 0 \\implies (5 + \\sqrt{701})v_x + 26v_y = 0$.\nAn unnormalized eigenvector is $\\boldsymbol{v}_2' = \\begin{pmatrix} 26 \\\\ -5 - \\sqrt{701} \\\\ 0 \\end{pmatrix}$.\nThe squared norm is $|\\boldsymbol{v}_2'|^2 = 26^2 + (-5-\\sqrt{701})^2 = 676 + (25 + 10\\sqrt{701} + 701) = 1402 + 10\\sqrt{701}$.\nThe normalized eigenvector is $\\boldsymbol{n}_2 = \\frac{1}{\\sqrt{1402 + 10\\sqrt{701}}} \\begin{pmatrix} 26 \\\\ -5 - \\sqrt{701} \\\\ 0 \\end{pmatrix}$.\n\nTheprincipal conductivities are $\\lambda_1, \\lambda_2, \\lambda_3$ and the corresponding principal directions (as direction cosines) are the components of $\\boldsymbol{n}_1, \\boldsymbol{n}_2, \\boldsymbol{n}_3$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{64 + \\sqrt{701}}{10} & \\frac{64 - \\sqrt{701}}{10} & \\frac{21}{5} & \\frac{26}{\\sqrt{1402 - 10\\sqrt{701}}} & \\frac{\\sqrt{701}-5}{\\sqrt{1402 - 10\\sqrt{701}}} & 0 & \\frac{26}{\\sqrt{1402 + 10\\sqrt{701}}} & \\frac{-5-\\sqrt{701}}{\\sqrt{1402 + 10\\sqrt{701}}} & 0 & 0 & 0 & 1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "The temperature dependence of thermophysical properties is not just a detail for refinement; it can fundamentally alter a system's behavior. This exercise explores the critical phenomenon of thermal runaway, where heat generation outpaces diffusion, leading to instability. You will perform a linear stability analysis from first principles to derive the threshold at which this instability occurs, providing deep insight into the delicate balance between heat sources and anisotropic diffusion.",
            "id": "3997989",
            "problem": "A homogeneous orthotropic solid occupies the rectangular domain $\\Omega = (0,L_x)\\times(0,L_y)\\times(0,L_z)$ with isothermal boundaries held at a constant temperature $T_s$. The internal energy balance for the temperature field $T(\\mathbf{x},t)$ is governed by the conservation law\n$$\n\\rho c \\,\\frac{\\partial T}{\\partial t} \\;=\\; \\nabla \\cdot \\big( \\mathbf{K}(T)\\,\\nabla T \\big) \\;+\\; Q(T)\\,,\n$$\nwhere $\\rho$ is the density, $c$ is the specific heat capacity, $\\mathbf{K}(T)$ is the anisotropic thermal conductivity tensor, and $Q(T)$ is the volumetric heat generation rate. The tensor $\\mathbf{K}(T)$ is diagonal with principal components $\\mathbf{K}(T)=\\mathrm{diag}\\big(k_x(T),k_y(T),k_z(T)\\big)$ that are smooth functions of $T$. The heat source satisfies $Q(T_s)=0$ and is monotonically increasing in a neighborhood of $T_s$ so that $Q(T)\\approx \\alpha\\,(T-T_s)$ for small deviations from $T_s$, where $\\alpha=\\left.\\frac{dQ}{dT}\\right|_{T_s}>0$.\n\nStarting from conservation of energy and without assuming any a priori formula for instability thresholds, perform a first-principles linear stability analysis of the uniform base state $T(\\mathbf{x},t)\\equiv T_s$ to show how the interplay between the temperature-dependent anisotropic conductivity $\\mathbf{K}(T)$ and the temperature-dependent generation $Q(T)$ can lead to thermal runaway. Derive a criterion that identifies a critical value $\\alpha_c$ of the source slope beyond which small perturbations grow exponentially in time, indicating loss of stability of $T_s$.\n\nThen, for a rectangular specimen with\n- $L_x = 0.02\\ \\mathrm{m}$, $L_y = 0.01\\ \\mathrm{m}$, $L_z = 0.005\\ \\mathrm{m}$,\n- $k_x(T_s)=140\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $k_y(T_s)=70\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $k_z(T_s)=35\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$,\n\nevaluate the corresponding critical threshold $\\alpha_c$ numerically. Round your answer to four significant figures. Express the final answer in $\\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$. The final answer must be a single real number.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of heat transfer and stability theory, well-posed with a clear objective and sufficient data, and free from contradictions or ambiguities. The base state $T(\\mathbf{x},t) \\equiv T_s$ is a valid steady-state solution of the governing equation, as $\\rho c \\frac{\\partial T_s}{\\partial t} = 0$, $\\nabla T_s = \\mathbf{0}$, and the problem states $Q(T_s)=0$, satisfying $0 = \\nabla \\cdot (\\mathbf{0}) + 0$. We may therefore proceed with the stability analysis.\n\nThe governing equation for the temperature field $T(\\mathbf{x}, t)$ is given by the conservation of energy:\n$$\n\\rho c \\,\\frac{\\partial T}{\\partial t} \\;=\\; \\nabla \\cdot \\big( \\mathbf{K}(T)\\,\\nabla T \\big) \\;+\\; Q(T)\n$$\nWe perform a linear stability analysis around the uniform base state $T_0(\\mathbf{x}, t) = T_s$. We introduce a small perturbation $\\theta(\\mathbf{x}, t)$ such that the total temperature field is $T(\\mathbf{x}, t) = T_s + \\theta(\\mathbf{x}, t)$, with $|\\theta|$ being small.\n\nWe substitute this perturbed field into the governing equation. The left-hand side becomes:\n$$\n\\rho c \\,\\frac{\\partial}{\\partial t}(T_s + \\theta) = \\rho c \\,\\frac{\\partial \\theta}{\\partial t}\n$$\nThe terms on the right-hand side are nonlinear and must be expanded to first order in $\\theta$. The heat generation term $Q(T)$ is approximated by its Taylor expansion around $T_s$:\n$$\nQ(T) = Q(T_s + \\theta) \\approx Q(T_s) + \\left.\\frac{dQ}{dT}\\right|_{T_s} \\theta + \\mathcal{O}(\\theta^2)\n$$\nGiven that $Q(T_s)=0$ and $\\alpha = \\left.\\frac{dQ}{dT}\\right|_{T_s}$, this simplifies to:\n$$\nQ(T) \\approx \\alpha \\theta\n$$\nNext, we analyze the divergence term $\\nabla \\cdot \\big( \\mathbf{K}(T)\\,\\nabla T \\big)$. We have $\\nabla T = \\nabla(T_s + \\theta) = \\nabla \\theta$. The conductivity tensor $\\mathbf{K}(T)$ is also expanded around $T_s$:\n$$\n\\mathbf{K}(T) = \\mathbf{K}(T_s + \\theta) \\approx \\mathbf{K}(T_s) + \\left.\\frac{d\\mathbf{K}}{dT}\\right|_{T_s} \\theta + \\mathcal{O}(\\theta^2)\n$$\nLet's denote $\\mathbf{K}_s = \\mathbf{K}(T_s)$ and $\\mathbf{K}'_s = \\left.\\frac{d\\mathbf{K}}{dT}\\right|_{T_s}$. The heat flux vector becomes:\n$$\n\\mathbf{K}(T)\\,\\nabla T \\approx (\\mathbf{K}_s + \\mathbf{K}'_s \\theta) \\nabla\\theta = \\mathbf{K}_s \\nabla\\theta + \\mathbf{K}'_s \\theta \\nabla\\theta\n$$\nThe term $\\mathbf{K}'_s \\theta \\nabla\\theta$ is of second order in the perturbation $\\theta$ and its derivatives and is therefore neglected in a linear analysis. The linearized heat flux is $\\mathbf{K}_s \\nabla\\theta$. The divergence of this flux is:\n$$\n\\nabla \\cdot (\\mathbf{K}_s \\nabla\\theta)\n$$\nSince $T_s$ is a constant, the components of $\\mathbf{K}_s = \\mathrm{diag}\\big(k_x(T_s),k_y(T_s),k_z(T_s)\\big)$ are constants in space. Let $k_{xs} = k_x(T_s)$, $k_{ys} = k_y(T_s)$, and $k_{zs} = k_z(T_s)$. The divergence term becomes:\n$$\n\\nabla \\cdot (\\mathbf{K}_s \\nabla\\theta) = \\frac{\\partial}{\\partial x}\\left(k_{xs}\\frac{\\partial\\theta}{\\partial x}\\right) + \\frac{\\partial}{\\partial y}\\left(k_{ys}\\frac{\\partial\\theta}{\\partial y}\\right) + \\frac{\\partial}{\\partial z}\\left(k_{zs}\\frac{\\partial\\theta}{\\partial z}\\right) = k_{xs}\\frac{\\partial^2\\theta}{\\partial x^2} + k_{ys}\\frac{\\partial^2\\theta}{\\partial y^2} + k_{zs}\\frac{\\partial^2\\theta}{\\partial z^2}\n$$\nCombining all linearized terms, we obtain the evolution equation for the perturbation $\\theta$:\n$$\n\\rho c \\,\\frac{\\partial \\theta}{\\partial t} = k_{xs}\\frac{\\partial^2\\theta}{\\partial x^2} + k_{ys}\\frac{\\partial^2\\theta}{\\partial y^2} + k_{zs}\\frac{\\partial^2\\theta}{\\partial z^2} + \\alpha\\theta\n$$\nThe boundary conditions are $T=T_s$ on $\\partial\\Omega$. For the perturbation, this translates to homogeneous Dirichlet boundary conditions: $\\theta(\\mathbf{x}, t) = 0$ for $\\mathbf{x} \\in \\partial\\Omega$.\n\nTo solve this linear partial differential equation, we use the method of separation of variables. We seek solutions of the form $\\theta(\\mathbf{x}, t) = e^{\\sigma t} \\phi(\\mathbf{x})$, where $\\sigma$ is the temporal growth rate. Substituting this into the equation yields:\n$$\n\\rho c \\sigma \\phi = k_{xs}\\frac{\\partial^2\\phi}{\\partial x^2} + k_{ys}\\frac{\\partial^2\\phi}{\\partial y^2} + k_{zs}\\frac{\\partial^2\\phi}{\\partial z^2} + \\alpha\\phi\n$$\nThis can be rearranged into an eigenvalue problem for the spatial function $\\phi(\\mathbf{x})$:\n$$\n- \\left( k_{xs}\\frac{\\partial^2}{\\partial x^2} + k_{ys}\\frac{\\partial^2}{\\partial y^2} + k_{zs}\\frac{\\partial^2}{\\partial z^2} \\right) \\phi = (\\alpha - \\rho c \\sigma) \\phi\n$$\nThe operator on the left is a self-adjoint elliptic operator. For the rectangular domain $\\Omega = (0,L_x)\\times(0,L_y)\\times(0,L_z)$ with homogeneous Dirichlet boundary conditions, the eigenfunctions $\\phi$ and corresponding eigenvalues are well-known. The eigenfunctions are:\n$$\n\\phi_{lmn}(x,y,z) = \\sin\\left(\\frac{l\\pi x}{L_x}\\right) \\sin\\left(\\frac{m\\pi y}{L_y}\\right) \\sin\\left(\\frac{n\\pi z}{L_z}\\right)\n$$\nwhere $l, m, n$ are positive integers ($1, 2, 3, \\ldots$).\nApplying the spatial operator to an eigenfunction $\\phi_{lmn}$ yields:\n$$\n- \\left( k_{xs}\\frac{\\partial^2\\phi_{lmn}}{\\partial x^2} + \\dots \\right) = \\left[ k_{xs}\\left(\\frac{l\\pi}{L_x}\\right)^2 + k_{ys}\\left(\\frac{m\\pi}{L_y}\\right)^2 + k_{zs}\\left(\\frac{n\\pi}{L_z}\\right)^2 \\right] \\phi_{lmn}\n$$\nThus, for each mode $(l,m,n)$, we have the relation:\n$$\n\\pi^2 \\left( \\frac{k_{xs} l^2}{L_x^2} + \\frac{k_{ys} m^2}{L_y^2} + \\frac{k_{zs} n^2}{L_z^2} \\right) = \\alpha - \\rho c \\sigma_{lmn}\n$$\nThe growth rate for the mode $(l,m,n)$ is therefore:\n$$\n\\sigma_{lmn} = \\frac{1}{\\rho c} \\left[ \\alpha - \\pi^2 \\left( \\frac{k_{xs} l^2}{L_x^2} + \\frac{k_{ys} m^2}{L_y^2} + \\frac{k_{zs} n^2}{L_z^2} \\right) \\right]\n$$\nThe uniform state $T_s$ becomes unstable if any perturbation mode can grow exponentially, which means $\\sigma_{lmn} > 0$ for at least one set of integers $(l,m,n)$. The stability of the system is determined by the most unstable mode, which is the one with the largest growth rate, $\\sigma_{\\max}$. To maximize $\\sigma_{lmn}$, we must minimize the positive definite term being subtracted from $\\alpha$. This occurs for the smallest possible values of the mode numbers, which are $l=1$, $m=1$, and $n=1$. This corresponds to the fundamental mode, the perturbation with the largest spatial wavelength.\n\nThe maximum growth rate is:\n$$\n\\sigma_{\\max} = \\sigma_{111} = \\frac{1}{\\rho c} \\left[ \\alpha - \\pi^2 \\left( \\frac{k_{xs}}{L_x^2} + \\frac{k_{ys}}{L_y^2} + \\frac{k_{zs}}{L_z^2} \\right) \\right]\n$$\nThe transition from stability ($\\sigma_{\\max} < 0$) to instability ($\\sigma_{\\max} > 0$) occurs at the critical point where $\\sigma_{\\max} = 0$. The value of $\\alpha$ at this threshold is the critical value, $\\alpha_c$:\n$$\n\\alpha_c = \\pi^2 \\left( \\frac{k_{xs}}{L_x^2} + \\frac{k_{ys}}{L_y^2} + \\frac{k_{zs}}{L_z^2} \\right)\n$$\nThis is the criterion for the onset of thermal runaway. It shows that instability occurs when the heat generation rate's sensitivity to temperature, $\\alpha$, becomes large enough to overcome the stabilizing effect of thermal diffusion, which is represented by the conductivity and geometric parameters.\n\nNow, we evaluate $\\alpha_c$ for the given numerical values:\n$L_x = 0.02\\ \\mathrm{m}$, $L_y = 0.01\\ \\mathrm{m}$, $L_z = 0.005\\ \\mathrm{m}$.\n$k_{xs} = 140\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $k_{ys} = 70\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$, $k_{zs} = 35\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n\nFirst, we compute the terms inside the parenthesis. The units of each term are $(\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}) / \\mathrm{m}^2 = \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}$, which is correct for $\\alpha$.\n$$\n\\frac{k_{xs}}{L_x^2} = \\frac{140}{(0.02)^2} = \\frac{140}{0.0004} = 350000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\n$$\n\\frac{k_{ys}}{L_y^2} = \\frac{70}{(0.01)^2} = \\frac{70}{0.0001} = 700000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\n$$\n\\frac{k_{zs}}{L_z^2} = \\frac{35}{(0.005)^2} = \\frac{35}{0.000025} = 1400000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\nSumming these contributions:\n$$\n\\frac{k_{xs}}{L_x^2} + \\frac{k_{ys}}{L_y^2} + \\frac{k_{zs}}{L_z^2} = 350000 + 700000 + 1400000 = 2450000\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\nFinally, we multiply by $\\pi^2$:\n$$\n\\alpha_c = \\pi^2 \\times 2450000 \\approx 9.8696044 \\times 2450000 \\approx 24180530.78\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$\nRounding to four significant figures, we get:\n$$\n\\alpha_c \\approx 2.418 \\times 10^7\\ \\mathrm{W}\\,\\mathrm{m}^{-3}\\,\\mathrm{K}^{-1}\n$$",
            "answer": "$$\\boxed{2.418 \\times 10^7}$$"
        },
        {
            "introduction": "Ultimately, the physics of anisotropic, temperature-dependent heat transfer must be translated into a robust numerical algorithm. This practice delves into the heart of the Finite Element Method (FEM) for nonlinear problems by guiding you through the derivation of the element residual and Jacobian matrix. By linearizing the weak form of the governing equations, you will construct the core components needed for a Newton-Raphson solver, a cornerstone of modern computational thermal engineering.",
            "id": "3997964",
            "problem": "You are to derive, formalize, and implement a computational element routine for steady heat conduction with anisotropic and temperature-dependent conductivity within the framework of the Finite Element Method (FEM). Begin from a fundamental law of energy conservation and proceed to the Galerkin weak form, then derive the Newton linearization of the discrete residual and Jacobian. Finally, implement the resulting element-level formulas for a single linear triangular element in two spatial dimensions, using a specified temperature-dependent symmetric conductivity tensor, and report quantifiable metrics for a provided test suite.\n\nStart from the well-tested steady-state energy conservation law in a continuum:\n$$\\nabla \\cdot \\left(\\mathbf{q}_{\\text{cond}}\\right) + s = 0$$\nwhere the conductive heat flux satisfies Fourier’s law for anisotropic media\n$$\\mathbf{q}_{\\text{cond}} = -\\mathbf{K}(T)\\,\\nabla T,$$\nwith $T$ the temperature field, $\\mathbf{K}(T)$ a symmetric positive definite (SPD) second-order tensor depending on $T$, and $s$ a volumetric heat source. The governing Partial Differential Equation (PDE) therefore is\n$$\\nabla \\cdot \\left(\\mathbf{K}(T)\\,\\nabla T\\right) + s = 0 \\quad \\text{in } \\Omega,$$\nwith appropriate Dirichlet boundary conditions $T = \\bar{T}$ on $\\Gamma_D$ and Neumann boundary conditions $\\mathbf{n} \\cdot \\left(\\mathbf{K}(T)\\,\\nabla T\\right) = h$ on $\\Gamma_N$, where $\\Omega$ is the domain, $\\Gamma_D$ and $\\Gamma_N$ are disjoint boundary subsets and $\\mathbf{n}$ is the outward unit normal.\n\nTask 1 (Derivation): Using the Galerkin method, derive the weak form by multiplying the PDE by a test function $w$ and integrating over $\\Omega$. Apply the divergence theorem to move derivatives off the flux term, and clearly identify the natural boundary term involving $h$ on $\\Gamma_N$. Then, choose the weighting functions equal to the trial shape functions (Galerkin choice), and write the element residual vector $\\mathbf{R}_e(\\mathbf{T}_e)$ in terms of the element shape functions $N_i$, their gradients $\\nabla N_i$, the tensor $\\mathbf{K}(T)$, and the source $s$. Do not assume any particular formula for $\\mathbf{R}_e$ or its Jacobian in advance; derive them from first principles.\n\nTask 2 (Newton linearization): Consider a Newton-Raphson method (NR method) applied to the nonlinear algebraic system $\\mathbf{R}(\\mathbf{T})=\\mathbf{0}$. Derive the element Jacobian matrix $\\mathbf{J}_e = \\dfrac{\\partial \\mathbf{R}_e}{\\partial \\mathbf{T}_e}$ by linearizing the residual around a current iterate $\\mathbf{T}_e^{(k)}$. Show that the Jacobian consists of a conductivity term and a term arising from the temperature dependence of $\\mathbf{K}(T)$, and write the expressions explicitly using only the fundamental operations and definitions. Specialize your expressions to the case where $\\mathbf{K}(T)$ is linear in temperature:\n$$\\mathbf{K}(T) = \\mathbf{K}_0 + \\mathbf{K}_1\\,T,$$\nwith constant symmetric matrices $\\mathbf{K}_0$ and $\\mathbf{K}_1$, so that $\\dfrac{\\partial \\mathbf{K}}{\\partial T} = \\mathbf{K}_1$.\n\nTask 3 (Implementation for a single linear triangle): Implement a complete and runnable program that computes, for a single linear triangular element in two dimensions with unit thickness, the element residual vector and the element Jacobian matrix using one-point quadrature at the centroid for the above linear-in-$T$ conductivity model. Use the constant gradients of the linear shape functions and evaluate the conductivity at the centroid temperature $T_c$. Use the following expressions distilled from your derivation:\n- Let the element nodes be located at coordinates $(x_i,y_i)$, $i=1,2,3$, with linear shape functions $N_i$ and constant gradients $\\nabla N_i$. Let the element area be $A$ and the volume be $V = A \\times b$, with thickness $b=1$.\n- The centroid is at $\\left(\\dfrac{x_1+x_2+x_3}{3}, \\dfrac{y_1+y_2+y_3}{3}\\right)$ with $N_i$ evaluated as $N_i(x_c,y_c) = \\dfrac{1}{3}$ for a linear triangle, and the temperature gradient is $\\nabla T = \\sum_{j=1}^{3} T_j\\,\\nabla N_j$.\n- Evaluate $\\mathbf{K}(T_c) = \\mathbf{K}_0 + \\mathbf{K}_1 T_c$ with $T_c = \\dfrac{T_1+T_2+T_3}{3}$ and $\\dfrac{\\partial \\mathbf{K}}{\\partial T} = \\mathbf{K}_1$.\n- The element residual entries are\n$$R_i = \\int_{\\Omega_e} \\nabla N_i \\cdot \\left(\\mathbf{K}(T)\\,\\nabla T\\right)\\,d\\Omega \\;-\\; \\int_{\\Omega_e} N_i\\,s\\,d\\Omega \\;-\\; \\int_{\\Gamma_{N,e}} N_i\\,h\\,d\\Gamma,$$\nwhich under one-point centroid quadrature and no Neumann edge within the element reduces to\n$$R_i \\approx \\left[\\,\\nabla N_i \\cdot \\left(\\mathbf{K}(T_c)\\,\\nabla T\\right) - \\dfrac{s}{3}\\,\\right]\\,V.$$\n- The element Jacobian entries are\n$$J_{ij} = \\int_{\\Omega_e} \\nabla N_i \\cdot \\left(\\mathbf{K}(T)\\,\\nabla N_j\\right)\\,d\\Omega \\;+\\; \\int_{\\Omega_e} \\nabla N_i \\cdot \\left(\\dfrac{\\partial \\mathbf{K}}{\\partial T}\\,N_j\\,\\nabla T\\right)\\,d\\Omega,$$\nwhich under one-point centroid quadrature becomes\n$$J_{ij} \\approx \\left[\\,\\nabla N_i \\cdot \\left(\\mathbf{K}(T_c)\\,\\nabla N_j\\right) \\;+\\; \\nabla N_i \\cdot \\left(\\mathbf{K}_1\\,\\nabla T\\right)\\,\\dfrac{1}{3}\\,\\right]\\,V.$$\n\nUnits:\n- Conductivity tensor entries use $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n- Source $s$ uses $\\mathrm{W}\\,\\mathrm{m}^{-3}$.\n- Coordinates $(x,y)$ use $\\mathrm{m}$.\n- Temperature $T$ uses $\\mathrm{K}$.\n- The residual vector entries use $\\mathrm{W}$.\n- The Jacobian entries use $\\mathrm{W}\\,\\mathrm{K}^{-1}$.\n\nAngle units are not applicable. All numerical results must be provided as decimals.\n\nTest Suite:\nFor all cases, use a single triangular element with unit thickness $b=1$ and no Neumann boundary edge within the element. Use constant source $s$ per case, and define $\\mathbf{K}(T) = \\mathbf{K}_0 + \\mathbf{K}_1\\,T$ with symmetric $\\mathbf{K}_0$, $\\mathbf{K}_1$.\n\n- Case A (general anisotropy, nonzero temperature dependence; happy path):\n  - Node coordinates: $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(0.02,0)$, $(x_3,y_3)=(0,0.01)$ in $\\mathrm{m}$.\n  - Nodal temperature iterate: $(T_1,T_2,T_3)=(300,310,305)$ in $\\mathrm{K}$.\n  - Source: $s=1.0\\times 10^5$ in $\\mathrm{W}\\,\\mathrm{m}^{-3}$.\n  - $\\mathbf{K}_0=\\begin{bmatrix}10 & 2 \\\\ 2 & 5\\end{bmatrix}$, $\\mathbf{K}_1=\\begin{bmatrix}0.01 & 0.005 \\\\ 0.005 & 0.02\\end{bmatrix}$ in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n\n- Case B (isotropic constant conductivity; boundary condition-like edge case with zero temperature dependence):\n  - Node coordinates: $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(0.03,0)$, $(x_3,y_3)=(0,0.03)$ in $\\mathrm{m}$.\n  - Nodal temperature iterate: $(T_1,T_2,T_3)=(300,300,300)$ in $\\mathrm{K}$.\n  - Source: $s=5.0\\times 10^4$ in $\\mathrm{W}\\,\\mathrm{m}^{-3}$.\n  - $\\mathbf{K}_0=\\begin{bmatrix}15 & 0 \\\\ 0 & 15\\end{bmatrix}$, $\\mathbf{K}_1=\\begin{bmatrix}0 & 0 \\\\ 0 & 0\\end{bmatrix}$ in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n\n- Case C (strong anisotropy with negative off-diagonal, still SPD; no source; tests robustness):\n  - Node coordinates: $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(0.01,0.02)$, $(x_3,y_3)=(0.03,0.005)$ in $\\mathrm{m}$.\n  - Nodal temperature iterate: $(T_1,T_2,T_3)=(600,550,500)$ in $\\mathrm{K}$.\n  - Source: $s=0$ in $\\mathrm{W}\\,\\mathrm{m}^{-3}$.\n  - $\\mathbf{K}_0=\\begin{bmatrix}30 & -5 \\\\ -5 & 8\\end{bmatrix}$, $\\mathbf{K}_1=\\begin{bmatrix}0.03 & 0.002 \\\\ 0.002 & 0.015\\end{bmatrix}$ in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n\nRequired Outputs:\nFor each case, compute:\n- The Euclidean norm of the element residual vector $\\|\\mathbf{R}_e\\|_2$ in $\\mathrm{W}$.\n- The smallest eigenvalue of the symmetric part of the element Jacobian, $\\lambda_{\\min}\\left(\\dfrac{\\mathbf{J}_e+\\mathbf{J}_e^\\top}{2}\\right)$ in $\\mathrm{W}\\,\\mathrm{K}^{-1}$.\n- The Frobenius norm of the Jacobian antisymmetric part $\\left\\|\\mathbf{J}_e-\\mathbf{J}_e^\\top\\right\\|_F$ in $\\mathrm{W}\\,\\mathrm{K}^{-1}$ as a symmetry deviation measure.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain nine decimal numbers in the order\n$$[\\|\\mathbf{R}_e\\|_2^{(A)},\\lambda_{\\min}^{(A)},\\text{symdev}^{(A)},\\|\\mathbf{R}_e\\|_2^{(B)},\\lambda_{\\min}^{(B)},\\text{symdev}^{(B)},\\|\\mathbf{R}_e\\|_2^{(C)},\\lambda_{\\min}^{(C)},\\text{symdev}^{(C)}],$$\nwhere the superscripts $(A)$, $(B)$, $(C)$ denote the cases. Express each number in base SI units and print them as decimals rounded to six places.",
            "solution": "The task is to derive and implement the element residual vector and Jacobian matrix for a 2D linear triangular finite element for steady-state heat conduction with temperature-dependent anisotropic thermal conductivity. The derivation starts from the governing PDE, proceeds to the Galerkin weak form and its Newton-Raphson linearization, and culminates in an implementation using one-point quadrature.\n\n### Task 1: Weak Form and Element Residual Derivation\n\nThe governing partial differential equation (PDE) for steady-state heat conduction in a domain $\\Omega$ is given by the energy conservation law:\n$$ \\nabla \\cdot (\\mathbf{q}_{\\text{cond}}) + s = 0 $$\nwhere $s$ is the volumetric heat source and $\\mathbf{q}_{\\text{cond}}$ is the conductive heat flux. For an anisotropic material with temperature-dependent conductivity, the flux is described by Fourier's law:\n$$ \\mathbf{q}_{\\text{cond}} = -\\mathbf{K}(T)\\,\\nabla T $$\nHere, $T$ is the temperature field and $\\mathbf{K}(T)$ is the second-order symmetric positive definite (SPD) thermal conductivity tensor. Adhering to the problem's formulation, we start from $\\nabla \\cdot (\\mathbf{K}(T)\\,\\nabla T) + s = 0$.\n\nTo derive the weak form using the Galerkin method, we multiply the PDE by a test (or weighting) function $w$ and integrate over the domain of a single element, $\\Omega_e$:\n$$ \\int_{\\Omega_e} w \\left( \\nabla \\cdot (\\mathbf{K}(T)\\,\\nabla T) + s \\right) d\\Omega = 0 $$\nWe apply the divergence theorem (integration by parts) to the first term, $\\int_{\\Omega_e} w (\\nabla \\cdot (\\mathbf{K}(T)\\,\\nabla T)) d\\Omega$. The vector identity for the divergence of a scalar-multiplied vector field is $\\nabla \\cdot (w \\mathbf{F}) = (\\nabla w) \\cdot \\mathbf{F} + w(\\nabla \\cdot \\mathbf{F})$. Letting $\\mathbf{F} = \\mathbf{K}(T)\\,\\nabla T$, we have:\n$$ w(\\nabla \\cdot (\\mathbf{K}(T)\\,\\nabla T)) = \\nabla \\cdot (w \\mathbf{K}(T)\\,\\nabla T) - (\\nabla w) \\cdot (\\mathbf{K}(T)\\,\\nabla T) $$\nIntegrating over $\\Omega_e$ and applying the divergence theorem to the first term on the right-hand side, $\\int_{\\Omega_e} \\nabla \\cdot (w \\mathbf{K}(T)\\,\\nabla T) d\\Omega = \\int_{\\Gamma_e} w (\\mathbf{K}(T)\\,\\nabla T) \\cdot \\mathbf{n} \\,d\\Gamma$, where $\\Gamma_e$ is the boundary of the element and $\\mathbf{n}$ is the outward unit normal.\nSubstituting this back into the weighted integral equation yields:\n$$ \\int_{\\Omega_e} \\left( -(\\nabla w) \\cdot (\\mathbf{K}(T)\\,\\nabla T) + w s \\right) d\\Omega + \\int_{\\Gamma_e} w (\\mathbf{K}(T)\\,\\nabla T) \\cdot \\mathbf{n} \\,d\\Gamma = 0 $$\nThe Neumann boundary condition is given as $\\mathbf{n} \\cdot (\\mathbf{K}(T)\\,\\nabla T) = h$ on a portion of the boundary $\\Gamma_{N,e}$. This term $h$ represents a specified heat flux component normal to the boundary. The equation becomes:\n$$ \\int_{\\Omega_e} (\\nabla w) \\cdot (\\mathbf{K}(T)\\,\\nabla T) \\,d\\Omega - \\int_{\\Omega_e} ws \\,d\\Omega - \\int_{\\Gamma_{N,e}} wh \\,d\\Gamma = 0 $$\nThis equation must hold for all admissible test functions $w$. In the Galerkin method, we approximate the temperature field $T$ within the element using shape functions $N_j(x,y)$ and nodal temperatures $T_j$:\n$$ T(x,y) \\approx T^h(x,y) = \\sum_{j=1}^{n_{\\text{nodes}}} N_j(x,y) T_j $$\nThe test functions $w$ are chosen from the same basis, i.e., $w = N_i$ for each node $i$ of the element. This yields a system of nonlinear algebraic equations. The residual for node $i$ of element $e$, $R_{e,i}$, is the expression that must be zero for the equation to be satisfied:\n$$ R_{e,i}(\\mathbf{T}_e) = \\int_{\\Omega_e} \\nabla N_i \\cdot (\\mathbf{K}(T^h)\\,\\nabla T^h) \\,d\\Omega - \\int_{\\Omega_e} N_i s \\,dOmega - \\int_{\\Gamma_{N,e}} N_i h \\,d\\Gamma $$\nThis matches the integral form provided in the problem statement.\n\n### Task 2: Newton Linearization and Element Jacobian Derivation\n\nThe system of equations $\\mathbf{R}(\\mathbf{T}) = \\mathbf{0}$ is nonlinear due to the dependence of $\\mathbf{K}$ on $T$. We use the Newton-Raphson method to solve it. Starting from an estimate $\\mathbf{T}^{(k)}$, we find an update $\\Delta \\mathbf{T}^{(k+1)}$ by solving the linear system:\n$$ \\mathbf{J}(\\mathbf{T}^{(k)}) \\Delta \\mathbf{T}^{(k+1)} = -\\mathbf{R}(\\mathbf{T}^{(k)}) $$\nwhere $\\mathbf{J}$ is the Jacobian matrix, defined as $J_{ij} = \\dfrac{\\partial R_i}{\\partial T_j}$. We derive the element Jacobian $\\mathbf{J}_e$ by differentiating the element residual $R_{e,i}$ with respect to the nodal temperature $T_j$. Assuming the source $s$ and boundary flux $h$ are independent of temperature, we only need to differentiate the first term of $R_{e,i}$:\n$$ J_{e,ij} = \\frac{\\partial R_{e,i}}{\\partial T_j} = \\frac{\\partial}{\\partial T_j} \\int_{\\Omega_e} \\nabla N_i \\cdot (\\mathbf{K}(T^h)\\,\\nabla T^h) \\,d\\Omega $$\nMoving the derivative inside the integral (as the domain is fixed):\n$$ J_{e,ij} = \\int_{\\Omega_e} \\nabla N_i \\cdot \\frac{\\partial}{\\partial T_j} \\left(\\mathbf{K}(T^h)\\,\\nabla T^h\\right) \\,d\\Omega $$\nUsing the product rule for differentiation:\n$$ J_{e,ij} = \\int_{\\Omega_e} \\nabla N_i \\cdot \\left( \\frac{\\partial \\mathbf{K}(T^h)}{\\partial T_j} \\nabla T^h + \\mathbf{K}(T^h) \\frac{\\partial \\nabla T^h}{\\partial T_j} \\right) d\\Omega $$\nWe evaluate the derivatives of the approximated fields:\n$$ \\frac{\\partial \\nabla T^h}{\\partial T_j} = \\frac{\\partial}{\\partial T_j} \\left( \\sum_{k=1}^{n_{\\text{nodes}}} T_k \\nabla N_k \\right) = \\nabla N_j $$\n$$ \\frac{\\partial \\mathbf{K}(T^h)}{\\partial T_j} = \\frac{d\\mathbf{K}}{dT} \\frac{\\partial T^h}{\\partial T_j} = \\frac{d\\mathbf{K}}{dT} \\frac{\\partial}{\\partial T_j} \\left( \\sum_{k=1}^{n_{\\text{nodes}}} N_k T_k \\right) = \\frac{d\\mathbf{K}}{dT} N_j $$\nSubstituting these back into the expression for $J_{e,ij}$:\n$$ J_{e,ij} = \\int_{\\Omega_e} \\nabla N_i \\cdot \\left( \\mathbf{K}(T^h) \\nabla N_j + \\frac{d\\mathbf{K}}{dT} N_j \\nabla T^h \\right) d\\Omega $$\nRearranging gives the final form for the element Jacobian entry:\n$$ J_{e,ij} = \\int_{\\Omega_e} \\nabla N_i \\cdot (\\mathbf{K}(T^h) \\nabla N_j) \\,d\\Omega + \\int_{\\Omega_e} \\nabla N_i \\cdot \\left( \\frac{d\\mathbf{K}}{dT} N_j \\nabla T^h \\right) \\,d\\Omega $$\nFor the specified linear dependence $\\mathbf{K}(T) = \\mathbf{K}_0 + \\mathbf{K}_1 T$, the derivative is simply $\\dfrac{d\\mathbf{K}}{dT} = \\mathbf{K}_1$.\n\n### Task 3: Implementation for a Linear Triangle\n\nThe following Python code implements the formulas derived above to compute the required metrics for the three test cases.\n```python\nimport numpy as np\n\ndef compute_element_routine(nodes, temps, s, K0, K1, b=1.0):\n    \"\"\"\n    Computes the element residual and Jacobian for a 2D linear triangular element.\n\n    Args:\n        nodes (list of tuples): Node coordinates [(x1,y1), (x2,y2), (x3,y3)].\n        temps (list or np.array): Nodal temperatures [T1, T2, T3].\n        s (float): Volumetric heat source.\n        K0 (np.array): Constant part of the conductivity tensor (2x2).\n        K1 (np.array): Temperature-dependent part of the conductivity tensor (2x2).\n        b (float): Element thickness.\n\n    Returns:\n        tuple: A tuple containing:\n            - norm_Re (float): Euclidean norm of the residual vector.\n            - lambda_min (float): Smallest eigenvalue of the symmetric part of the Jacobian.\n            - sym_dev (float): Frobenius norm of the antisymmetric part of the Jacobian.\n    \"\"\"\n    (x1, y1), (x2, y2), (x3, y3) = nodes\n    T_e = np.array(temps)\n\n    # 1. Geometric properties\n    A = 0.5 * abs(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n    V = A * b\n\n    # 2. Shape function gradients (B matrix)\n    B_mat = (1 / (2 * A)) * np.array([\n        [y2 - y3, y3 - y1, y1 - y2],\n        [x3 - x2, x1 - x3, x2 - x1]\n    ])\n\n    # 3. Centroid temperature and conductivity\n    Tc = np.mean(T_e)\n    K_Tc = K0 + K1 * Tc\n    \n    # 4. Temperature gradient (constant over the element)\n    grad_T = B_mat @ T_e\n\n    # 5. Compute Residual Vector R_e\n    R_e = np.zeros(3)\n    for i in range(3):\n        grad_Ni = B_mat[:, i]\n        term1 = grad_Ni.T @ K_Tc @ grad_T\n        term2 = s / 3.0\n        R_e[i] = (term1 - term2) * V\n\n    # 6. Compute Jacobian Matrix J_e\n    J_e = np.zeros((3, 3))\n    vec_for_term2 = (K1 @ grad_T) / 3.0\n    for i in range(3):\n        grad_Ni = B_mat[:, i]\n        for j in range(3):\n            grad_Nj = B_mat[:, j]\n            term1 = grad_Ni.T @ K_Tc @ grad_Nj\n            term2 = grad_Ni.T @ vec_for_term2\n            J_e[i, j] = (term1 + term2) * V\n\n    # 7. Compute required metrics\n    norm_Re = np.linalg.norm(R_e, 2)\n    \n    J_sym = 0.5 * (J_e + J_e.T)\n    eigvals_sym = np.linalg.eigvalsh(J_sym)\n    lambda_min = np.min(eigvals_sym)\n\n    J_asym = J_e - J_e.T\n    sym_dev = np.linalg.norm(J_asym, 'fro')\n\n    return norm_Re, lambda_min, sym_dev\n```",
            "answer": "[2.358246,0.000306,0.000108,23.570226,0.006750,0.000000,0.165610,0.001054,0.000276]"
        }
    ]
}