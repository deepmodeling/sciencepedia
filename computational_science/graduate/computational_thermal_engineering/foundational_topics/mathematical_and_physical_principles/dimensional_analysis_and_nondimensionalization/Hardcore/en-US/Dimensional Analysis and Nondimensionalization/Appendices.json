{
    "hands_on_practices": [
        {
            "introduction": "This first practice provides a comprehensive, end-to-end application of dimensional analysis to a core thermal engineering problem. Starting from the first principles of energy conservation, you will model a transient heat exchanger, use the Buckingham Pi theorem to formally identify the governing dimensionless groups, and derive a complete analytical solution in dimensionless form . This exercise demonstrates how nondimensionalization transforms a problem with multiple physical parameters into a universal solution governed by a few essential ratios.",
            "id": "3946255",
            "problem": "Consider two well-mixed thermal reservoirs exchanging heat through a fixed thermal contact area, forming a transient, zero-dimensional model of a heat exchanger segment. Let the hot-side reservoir have thermal capacitance $C_h$ and initial uniform temperature $T_{h,0}$, and the cold-side reservoir have thermal capacitance $C_c$ and initial uniform temperature $T_{c,0}$. The interface between them is idealized as a single thermal conductance $G$ that relates the instantaneous heat rate to the instantaneous temperature difference via Newton’s law of cooling. There is no external heat loss and no mass exchange between the reservoirs.\n\nThe governing principles to be used as the fundamental base are:\n- Energy conservation for each reservoir.\n- Newton’s law of cooling at the interface.\n\nUsing these principles:\n1. Formulate the coupled Ordinary Differential Equations (ODEs) for the reservoir temperatures $T_h(t)$ and $T_c(t)$, explicitly using $C_h$, $C_c$, $G$, $T_h(t)$, and $T_c(t)$.\n2. Perform dimensional analysis via the Buckingham Pi Theorem to identify a minimal set of dimensionless groups that govern the transient response. Explicitly define these groups and justify their independence.\n3. Nondimensionalize the ODE system to express it entirely in terms of the derived dimensionless groups and dimensionless time. Show that the dimensionless solution depends only on these groups.\n4. Derive the closed-form expression (in dimensionless form) for the cold-side temperature rise normalized by the initial temperature difference, namely the quantity\n$$\n\\theta_c(t) \\equiv \\frac{T_c(t) - T_{c,0}}{T_{h,0} - T_{c,0}}.\n$$\nExpress $\\theta_c(t)$ only in terms of the dimensionless groups and dimensionless time obtained in parts 2 and 3.\n\nYour program must implement the final dimensionless expression you derive to compute $\\theta_c(t)$ for the following test suite. All physical inputs must be treated with the following units: $C_h$ and $C_c$ in $\\mathrm{J/K}$, $G$ in $\\mathrm{W/K}$, $t$ in $\\mathrm{s}$, and temperatures $T_{h,0}$ and $T_{c,0}$ in $\\mathrm{K}$. The outputs are unitless floats.\n\nTest suite (each case is $(C_h,\\,C_c,\\,G,\\,T_{h,0},\\,T_{c,0},\\,t)$):\n- Case 1 (general case): $(8000,\\,5000,\\,200,\\,360,\\,300,\\,50)$.\n- Case 2 (equal capacitances): $(6000,\\,6000,\\,180,\\,350,\\,300,\\,40)$.\n- Case 3 (high hot-side capacitance, small cold-side capacitance): $(10000,\\,1000,\\,150,\\,370,\\,300,\\,20)$.\n- Case 4 (short time behavior): $(3000,\\,9000,\\,120,\\,340,\\,320,\\,0.1)$.\n- Case 5 (long time behavior): $(4000,\\,16000,\\,100,\\,330,\\,290,\\,5000)$.\n- Case 6 (initial condition boundary): $(8000,\\,5000,\\,200,\\,360,\\,300,\\,0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\"[result1,result2,\\dots]\"$), where each entry is the value of $\\theta_c(t)$ for the corresponding case in the order listed above.",
            "solution": "The problem requires the analysis of a transient, zero-dimensional heat exchange process between two thermal reservoirs. The analysis will proceed in four sequential parts: formulation of the governing differential equations, dimensional analysis using the Buckingham Pi theorem, nondimensionalization of the governing equations, and derivation of the closed-form analytical solution for the normalized cold-side temperature.\n\n### 1. Formulation of the Coupled Ordinary Differential Equations (ODEs)\n\nThe system consists of a hot reservoir with thermal capacitance $C_h$ and temperature $T_h(t)$, and a cold reservoir with thermal capacitance $C_c$ and temperature $T_c(t)$. Heat is exchanged between them through a thermal conductance $G$. The fundamental principles governing the system are energy conservation for each reservoir and Newton's law of cooling for the heat transfer between them.\n\nAccording to Newton's law of cooling, the instantaneous rate of heat transfer, $\\dot{Q}$, from the hot reservoir to the cold reservoir is proportional to the temperature difference:\n$$\n\\dot{Q}(t) = G \\cdot [T_h(t) - T_c(t)]\n$$\nThis heat transfer rate has units of watts ($W$) or joules per second ($J/s$).\n\nThe principle of energy conservation applied to each reservoir states that the rate of change of internal energy is equal to the net rate of heat transfer into the reservoir. Since the reservoirs are assumed to be well-mixed (lumped capacitance model), their internal energies $U_h$ and $U_c$ are given by $U_h(t) = C_h T_h(t)$ and $U_c(t) = C_c T_c(t)$, respectively.\n\nFor the hot reservoir, heat is flowing out, so its energy decreases. The first law of thermodynamics is:\n$$\n\\frac{dU_h}{dt} = C_h \\frac{dT_h}{dt} = -\\dot{Q}\n$$\nSubstituting the expression for $\\dot{Q}$ gives the first governing ODE:\n$$\nC_h \\frac{dT_h}{dt} = -G [T_h(t) - T_c(t)]\n$$\n\nFor the cold reservoir, heat is flowing in, so its energy increases:\n$$\n\\frac{dU_c}{dt} = C_c \\frac{dT_c}{dt} = +\\dot{Q}\n$$\nSubstituting the expression for $\\dot{Q}$ gives the second governing ODE:\n$$\nC_c \\frac{dT_c}{dt} = G [T_h(t) - T_c(t)]\n$$\n\nThis system of two coupled, first-order, linear ordinary differential equations is subject to the initial conditions specified in the problem:\n$$\nT_h(t=0) = T_{h,0} \\quad \\text{and} \\quad T_c(t=0) = T_{c,0}\n$$\n\n### 2. Dimensional Analysis via the Buckingham Pi Theorem\n\nThe goal is to find a functional relationship for the response, which is characterized by the temperature change. The quantity of interest is the normalized cold-side temperature rise, $\\theta_c(t)$. The relevant physical parameters that determine this response are: the temperature rise itself, $(T_c(t) - T_{c,0})$; the time, $t$; the thermal capacitances, $C_h$ and $C_c$; the thermal conductance, $G$; and the initial driving temperature difference, $(T_{h,0} - T_{c,0})$.\n\nLet's list these $n=6$ physical quantities and their fundamental dimensions in a system of energy (E), time (t), and temperature ($\\Theta$):\n- $T_c(t) - T_{c,0}$: $[\\Theta]$\n- $t$: $[\\mathrm{t}]$\n- $C_h$: $[\\mathrm{E} \\cdot \\Theta^{-1}]$\n- $C_c$: $[\\mathrm{E} \\cdot \\Theta^{-1}]$\n- $G$: $[\\mathrm{E} \\cdot \\mathrm{t}^{-1} \\cdot \\Theta^{-1}]$\n- $T_{h,0} - T_{c,0}$: $[\\Theta]$\n\nThe number of fundamental dimensions is $k=3$. According to the Buckingham Pi theorem, the number of independent dimensionless groups (Pi groups) is $n - k = 6 - 3 = 3$.\n\nTo find these groups, we select $k=3$ repeating variables that, combined, contain all fundamental dimensions and are dimensionally independent. A suitable set of repeating variables is $G$, $C_c$, and the initial temperature difference $\\Delta T_0 = T_{h,0} - T_{c,0}$.\n- $[G] = \\mathrm{E} \\cdot \\mathrm{t}^{-1} \\cdot \\Theta^{-1}$\n- $[C_c] = \\mathrm{E} \\cdot \\Theta^{-1}$\n- $[\\Delta T_0] = \\Theta$\n\nThese are dimensionally independent as no combination $[G]^a [C_c]^b [\\Delta T_0]^c$ can form a dimensionless group unless $a=b=c=0$.\n\nNow we form the Pi groups by combining the repeating variables with each of the remaining non-repeating variables: $(T_c(t) - T_{c,0})$, $t$, and $C_h$.\n\n**$\\Pi_1$ (Dimensionless Temperature):** We combine with $(T_c(t) - T_{c,0})$.\n$$\n\\Pi_1 = (T_c(t) - T_{c,0}) \\cdot G^a C_c^b (\\Delta T_0)^c\n$$\nFor $\\Pi_1$ to be dimensionless, the dimensions must cancel:\n$[\\Theta] \\cdot [\\mathrm{E} \\cdot \\mathrm{t}^{-1} \\cdot \\Theta^{-1}]^a \\cdot [\\mathrm{E} \\cdot \\Theta^{-1}]^b \\cdot [\\Theta]^c = \\mathrm{E}^0 \\mathrm{t}^0 \\Theta^0$.\n- For E: $a+b=0$\n- For t: $-a=0 \\implies a=0$\n- For $\\Theta$: $1-a-b+c=0$\nSolving yields $a=0$, $b=0$, and $c=-1$. Thus:\n$$\n\\Pi_1 = \\frac{T_c(t) - T_{c,0}}{T_{h,0} - T_{c,0}} \\equiv \\theta_c\n$$\n\n**$\\Pi_2$ (Dimensionless Time):** We combine with $t$.\n$$\n\\Pi_2 = t \\cdot G^a C_c^b (\\Delta T_0)^c\n$$\n$[\\mathrm{t}] \\cdot [\\mathrm{E} \\cdot \\mathrm{t}^{-1} \\cdot \\Theta^{-1}]^a \\cdot [\\mathrm{E} \\cdot \\Theta^{-1}]^b \\cdot [\\Theta]^c = \\mathrm{E}^0 \\mathrm{t}^0 \\Theta^0$.\n- For E: $a+b=0$\n- For t: $1-a=0 \\implies a=1$\n- For $\\Theta$: $-a-b+c=0$\nSolving yields $a=1$, $b=-1$, and $c=0$. Thus:\n$$\n\\Pi_2 = \\frac{Gt}{C_c} \\equiv \\tau\n$$\n\n**$\\Pi_3$ (Dimensionless Capacitance Ratio):** We combine with $C_h$.\n$$\n\\Pi_3 = C_h \\cdot G^a C_c^b (\\Delta T_0)^c\n$$\n$[\\mathrm{E} \\cdot \\Theta^{-1}] \\cdot [\\mathrm{E} \\cdot \\mathrm{t}^{-1} \\cdot \\Theta^{-1}]^a \\cdot [\\mathrm{E} \\cdot \\Theta^{-1}]^b \\cdot [\\Theta]^c = \\mathrm{E}^0 \\mathrm{t}^0 \\Theta^0$.\n- For E: $1+a+b=0$\n- For t: $-a=0 \\implies a=0$\n- For $\\Theta$: $-1-a-b+c=0$\nSolving yields $a=0$, $b=-1$, and $c=0$. Thus:\n$$\n\\Pi_3 = \\frac{C_h}{C_c} \\equiv C_R\n$$\n\nThe minimal set of dimensionless groups is therefore $\\theta_c$, $\\tau$, and $C_R$. The functional relationship is $\\Pi_1 = f(\\Pi_2, \\Pi_3)$, or $\\theta_c = f(\\tau, C_R)$, confirming that the dimensionless solution depends only on these groups.\n\n### 3. Nondimensionalization of the ODE System\n\nWe now rewrite the governing ODEs in terms of the dimensionless groups identified above. Let's define the dimensionless temperatures and time:\n- $\\theta_c(\\tau) = \\frac{T_c(t) - T_{c,0}}{T_{h,0} - T_{c,0}}$\n- $\\theta_h(\\tau) = \\frac{T_h(t) - T_{c,0}}{T_{h,0} - T_{c,0}}$\n- $\\tau = \\frac{Gt}{C_c}$\n\nFrom these definitions, we can express the dimensional temperatures as:\n- $T_c(t) = T_{c,0} + \\theta_c(\\tau) (T_{h,0} - T_{c,0})$\n- $T_h(t) = T_{c,0} + \\theta_h(\\tau) (T_{h,0} - T_{c,0})$\n\nThe time derivative must be transformed using the chain rule:\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt} \\frac{d}{d\\tau} = \\frac{G}{C_c} \\frac{d}{d\\tau}\n$$\n\nSubstitute these into the original ODEs.\n**Hot-side ODE:** $C_h \\frac{dT_h}{dt} = -G(T_h - T_c)$\n$$\nC_h \\left( \\frac{G}{C_c} \\frac{d}{d\\tau} [T_{c,0} + \\theta_h (T_{h,0} - T_{c,0})] \\right) = -G \\left( [T_{c,0} + \\theta_h (T_{h,0}-T_{c,0})] - [T_{c,0} + \\theta_c (T_{h,0}-T_{c,0})] \\right)\n$$\n$$\n\\frac{C_h}{C_c} G (T_{h,0}-T_{c,0}) \\frac{d\\theta_h}{d\\tau} = -G (T_{h,0}-T_{c,0}) (\\theta_h - \\theta_c)\n$$\nDividing by $G(T_{h,0}-T_{c,0})$ and substituting $C_R = C_h/C_c$ yields the first dimensionless ODE:\n$$\nC_R \\frac{d\\theta_h}{d\\tau} = -(\\theta_h - \\theta_c)\n$$\n\n**Cold-side ODE:** $C_c \\frac{dT_c}{dt} = G(T_h - T_c)$\n$$\nC_c \\left( \\frac{G}{C_c} \\frac{d}{d\\tau} [T_{c,0} + \\theta_c (T_{h,0} - T_{c,0})] \\right) = G \\left( [T_{c,0} + \\theta_h (T_{h,0}-T_{c,0})] - [T_{c,0} + \\theta_c (T_{h,0}-T_{c,0})] \\right)\n$$\n$$\nG (T_{h,0}-T_{c,0}) \\frac{d\\theta_c}{d\\tau} = G (T_{h,0}-T_{c,0}) (\\theta_h - \\theta_c)\n$$\nDividing by $G(T_{h,0}-T_{c,0})$ yields the second dimensionless ODE:\n$$\n\\frac{d\\theta_c}{d\\tau} = \\theta_h - \\theta_c\n$$\n\nThe dimensionless initial conditions at $\\tau=0$ (which corresponds to $t=0$) are:\n- $\\theta_h(0) = \\frac{T_{h,0} - T_{c,0}}{T_{h,0} - T_{c,0}} = 1$\n- $\\theta_c(0) = \\frac{T_{c,0} - T_{c,0}}{T_{h,0} - T_{c,0}} = 0$\n\nThe nondimensionalized system depends only on the single parameter $C_R$, as predicted by the dimensional analysis.\n\n### 4. Derivation of the Closed-Form Expression\n\nWe have a system of two linear ODEs. To solve for $\\theta_c(\\tau)$, we can decouple the equations. From the second dimensionless ODE, we express $\\theta_h$ in terms of $\\theta_c$:\n$$\n\\theta_h = \\theta_c + \\frac{d\\theta_c}{d\\tau}\n$$\nDifferentiating this with respect to $\\tau$ gives $\\frac{d\\theta_h}{d\\tau} = \\frac{d\\theta_c}{d\\tau} + \\frac{d^2\\theta_c}{d\\tau^2}$.\nSubstitute these into the first dimensionless ODE, $C_R \\frac{d\\theta_h}{d\\tau} = -(\\theta_h - \\theta_c)$:\n$$\nC_R \\left( \\frac{d\\theta_c}{d\\tau} + \\frac{d^2\\theta_c}{d\\tau^2} \\right) = -\\left( \\left(\\theta_c + \\frac{d\\theta_c}{d\\tau}\\right) - \\theta_c \\right)\n$$\n$$\nC_R \\frac{d^2\\theta_c}{d\\tau^2} + C_R \\frac{d\\theta_c}{d\\tau} = -\\frac{d\\theta_c}{d\\tau}\n$$\nThis simplifies to a second-order, linear, homogeneous ODE with constant coefficients for $\\theta_c(\\tau)$:\n$$\nC_R \\frac{d^2\\theta_c}{d\\tau^2} + (C_R + 1) \\frac{d\\theta_c}{d\\tau} = 0\n$$\nThe characteristic equation is $C_R r^2 + (C_R+1)r = 0$, which factors as $r(C_R r + C_R+1) = 0$. The roots are:\n$$\nr_1 = 0 \\quad \\text{and} \\quad r_2 = -\\frac{C_R+1}{C_R} = -\\left(1 + \\frac{1}{C_R}\\right)\n$$\nThe general solution for $\\theta_c(\\tau)$ is:\n$$\n\\theta_c(\\tau) = A e^{r_1 \\tau} + B e^{r_2 \\tau} = A + B e^{-(1 + 1/C_R)\\tau}\n$$\nThe constants $A$ and $B$ are determined from the initial conditions. We have $\\theta_c(0)=0$. We need a second condition for the derivative $\\frac{d\\theta_c}{d\\tau}$ at $\\tau=0$. From the dimensionless system, $\\frac{d\\theta_c}{d\\tau} = \\theta_h - \\theta_c$. At $\\tau=0$:\n$$\n\\frac{d\\theta_c}{d\\tau}(0) = \\theta_h(0) - \\theta_c(0) = 1 - 0 = 1\n$$\nApplying the first condition to the general solution:\n$$\n\\theta_c(0) = A + B = 0 \\implies A = -B\n$$\nDifferentiating the general solution with respect to $\\tau$:\n$$\n\\frac{d\\theta_c}{d\\tau} = -B \\left(1 + \\frac{1}{C_R}\\right) e^{-(1 + 1/C_R)\\tau}\n$$\nApplying the second condition at $\\tau=0$:\n$$\n\\frac{d\\theta_c}{d\\tau}(0) = -B \\left(1 + \\frac{1}{C_R}\\right) = 1 \\implies B = -\\frac{1}{1 + 1/C_R} = -\\frac{C_R}{C_R+1}\n$$\nThen, $A = -B = \\frac{C_R}{C_R+1}$.\nSubstituting $A$ and $B$ back into the general solution for $\\theta_c(\\tau)$ gives the final expression:\n$$\n\\theta_c(\\tau) = \\frac{C_R}{C_R+1} - \\frac{C_R}{C_R+1} e^{-(1 + 1/C_R)\\tau}\n$$\nFactoring this expression yields the desired closed-form solution:\n$$\n\\theta_c(t) = \\frac{C_R}{C_R+1} \\left( 1 - \\exp\\left[ -\\left(1 + \\frac{1}{C_R}\\right) \\tau \\right] \\right)\n$$\nwhere $\\theta_c(t)$ is the normalized temperature, $C_R = C_h/C_c$ is the capacitance ratio, and $\\tau = Gt/C_c$ is the dimensionless time. This expression is exclusively in terms of the derived dimensionless groups.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the normalized cold-side temperature rise for a transient,\n    zero-dimensional heat exchanger model based on a derived dimensionless expression.\n    \"\"\"\n    \n    # Define the test suite. Each case is a tuple:\n    # (C_h, C_c, G, T_h,0, T_c,0, t)\n    # Units: C in J/K, G in W/K, T in K, t in s.\n    test_cases = [\n        # Case 1 (general case)\n        (8000.0, 5000.0, 200.0, 360.0, 300.0, 50.0),\n        # Case 2 (equal capacitances)\n        (6000.0, 6000.0, 180.0, 350.0, 300.0, 40.0),\n        # Case 3 (high hot-side capacitance, small cold-side capacitance)\n        (10000.0, 1000.0, 150.0, 370.0, 300.0, 20.0),\n        # Case 4 (short time behavior)\n        (3000.0, 9000.0, 120.0, 340.0, 320.0, 0.1),\n        # Case 5 (long time behavior)\n        (4000.0, 16000.0, 100.0, 330.0, 290.0, 5000.0),\n        # Case 6 (initial condition boundary)\n        (8000.0, 5000.0, 200.0, 360.0, 300.0, 0.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Ch, Cc, G, Th0, Tc0, t = case\n\n        # The analytical solution is derived for T_h,0 != T_c,0.\n        # If they are equal, the temperature change is 0.\n        if Th0 == Tc0:\n            results.append(0.0)\n            continue\n\n        # The solution is numerically unstable if Cc or Ch are zero.\n        # The problem statement ensures Cc > 0 and Ch > 0.\n        \n        # Calculate the dimensionless groups\n        # Capacitance Ratio, C_R\n        C_R = Ch / Cc\n        \n        # Dimensionless Time, tau\n        tau = (G * t) / Cc\n        \n        # Calculate the normalized cold-side temperature rise, theta_c,\n        # using the derived dimensionless formula:\n        # theta_c = (C_R / (C_R + 1)) * (1 - exp(-(1 + 1/C_R) * tau))\n        \n        # This form is robust for all positive C_R and tau.\n        pre_factor = C_R / (C_R + 1.0)\n        exponent_factor = -(1.0 + 1.0/C_R) * tau\n        \n        # Handle the t=0 case explicitly to avoid potential floating point inaccuracies\n        # with exp(0) for very small tau.\n        if t == 0.0:\n            theta_c = 0.0\n        else:\n            theta_c = pre_factor * (1.0 - np.exp(exponent_factor))\n            \n        results.append(theta_c)\n\n    # Format the final output string as a comma-separated list in brackets.\n    # Using a general format specifier to avoid trailing zeros where not needed\n    # while maintaining precision.\n    print(f\"[{','.join(f'{r:.7g}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from system-level modeling to the specifics of computational implementation, this practice focuses on a crucial, practical skill: the unit-consistency audit of a numerical scheme. You will analyze the popular Forward Time Centered Space (FTCS) method for the heat equation to verify that each term in the discrete update rule is dimensionally homogeneous . This exercise highlights the implicit scaling assumptions made in code and reinforces the principle that dimensional integrity must be maintained from the continuous governing equation down to the individual lines of the algorithm.",
            "id": "3117457",
            "problem": "In simulating diffusion in one spatial dimension, consider the scalar field $u(x,t)$ governed by Fick's second law (also known as the heat equation) $\\,\\partial u/\\partial t = \\kappa\\, \\partial^{2} u/\\partial x^{2}\\,$, where $u$ has physical units $[u]=\\mathcal U$ for some base unit $\\mathcal U$ (for example, temperature or concentration), $x$ has units of length $[x]=\\mathcal L$, and $t$ has units of time $[t]=\\mathcal T$. A common explicit Forward Time Centered Space (FTCS) finite-difference implementation advances the nodal values via\n$$\nu^{n+1}_i \\;=\\; u^n_i \\;+\\; \\left(\\kappa\\,\\frac{\\Delta t}{\\Delta x^2}\\right)\\,\\Big(u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}\\Big),\n$$\nwhere $u^n_i$ approximates $u(x_i,t^n)$, $x_i = i\\,\\Delta x$, $t^n = n\\,\\Delta t$, with spatial step $\\Delta x$ and time step $\\Delta t$. Perform a unit-consistency audit of this update: starting from the governing law and core definitions of units, determine the units of each factor and term, check dimensional homogeneity of the right-hand side with the left-hand side, and identify any hidden scaling assumptions embedded in the implementation. Which option best captures a correct audit and the implied scaling assumptions?\n\nA. The scheme is dimensionally homogeneous provided $[\\kappa]=\\mathcal L^{2}\\,\\mathcal T^{-1}$, $[\\Delta x]=\\mathcal L$, $[\\Delta t]=\\mathcal T$, and $[u]=\\mathcal U$. The combination $\\kappa\\,\\Delta t/\\Delta x^{2}$ is dimensionless, and the parenthetical difference has units $\\mathcal U$, so the increment has units $\\mathcal U$ and can be added to $u^n_i$. Hidden assumptions include: uniform grid spacing (constant $\\Delta x$ so that a single $\\Delta x^{2}$ factors the discrete Laplacian), consistent units for $u$ at all nodes and times, indices $i$ and $n$ are dimensionless labels, and any coding choice like setting $\\kappa=1$ or $\\Delta x=1$ implies a deliberate nondimensionalization with reference scales, e.g., $x=L_{\\mathrm{ref}}\\,\\hat x$, $t=(L_{\\mathrm{ref}}^{2}/\\kappa_{\\mathrm{ref}})\\,\\hat t$, and $u=U_{\\mathrm{ref}}\\,\\hat u$.\n\nB. The factor $\\kappa\\,\\Delta t/\\Delta x^{2}$ has units $\\mathcal T^{-1}$, so the term $\\left(\\kappa\\,\\Delta t/\\Delta x^{2}\\right)\\left(u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}\\right)$ has units $\\mathcal U\\,\\mathcal T^{-1}$. Therefore, $u$ must be scaled to have units $\\mathcal U\\,\\mathcal T$ for the sum to be meaningful. No assumptions about grid uniformity are required.\n\nC. Because $u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}$ is a discrete second derivative, it already has units $\\mathcal U\\,\\mathcal L^{-2}$. Thus, the denominator $\\Delta x^{2}$ in the update is redundant and should be removed to maintain consistency, giving $u^{n+1}_i = u^n_i + \\kappa\\,\\Delta t\\,\\left(u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}\\right)$.\n\nD. The update is dimensionally homogeneous only if $u$ is nondimensional (that is, $[u]=1$). If $u$ carries physical units, the sum $u^n_i + \\cdots$ is not defined, so $u$ must be scaled to be unitless before applying the scheme.\n\nE. Since indices $i$ and $n$ are integers, both $\\Delta x$ and $\\Delta t$ must be dimensionless increments; therefore, to balance units, $\\kappa$ must carry the same units as $u$ so that the added term matches $u^n_i$. This removes any need for nondimensionalization or reference scales.",
            "solution": "The user has requested a meticulous audit of a finite-difference scheme for the one-dimensional diffusion equation.\n\n### Step 1: Extract Givens\n\nThe problem provides the following information:\n-   **Governing Law:** The scalar field $u(x,t)$ is governed by Fick's second law, $\\partial u/\\partial t = \\kappa\\, \\partial^{2} u/\\partial x^{2}$.\n-   **Physical Units:**\n    -   $[u] = \\mathcal U$ (e.g., concentration or temperature)\n    -   $[x] = \\mathcal L$ (length)\n    -   $[t] = \\mathcal T$ (time)\n-   **Finite-Difference Scheme:** The Forward Time Centered Space (FTCS) implementation is given by\n    $$\n    u^{n+1}_i \\;=\\; u^n_i \\;+\\; \\left(\\kappa\\,\\frac{\\Delta t}{\\Delta x^2}\\right)\\,\\Big(u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}\\Big)\n    $$\n-   **Discretization Definitions:**\n    -   $u^n_i$ is the numerical approximation of $u(x_i, t^n)$.\n    -   $x_i = i\\,\\Delta x$, where $\\Delta x$ is the spatial step.\n    -   $t^n = n\\,\\Delta t$, where $\\Delta t$ is the time step.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientific Grounding:** The problem is based on the diffusion equation (or heat equation), a cornerstone of physics and engineering, and the FTCS method, a standard and fundamental numerical scheme for its solution. The concepts of dimensional analysis and nondimensionalization are core principles in computational science. The problem is scientifically sound.\n-   **Well-Posedness:** The task is to perform a \"unit-consistency audit\" and identify hidden assumptions. This is a well-defined analytical task with a unique set of correct conclusions based on the provided equations and definitions.\n-   **Objectivity:** The problem is stated in precise, objective mathematical and physical terms. There are no subjective elements.\n-   **Completeness and Consistency:** All information required to perform a dimensional analysis of both the continuous PDE and the discrete numerical scheme is provided. There are no contradictions.\n-   **Other Flaws:** The problem does not exhibit any other flaws. It is a standard, valid problem in an introductory computational science or numerical analysis context.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. A full solution will be derived.\n\n### Derivation and Audit\n\nThe principle of dimensional homogeneity states that for an equation to be physically meaningful, all terms being added or subtracted must have the same physical dimensions, and the dimensions of the left-hand side must equal the dimensions of the right-hand side.\n\n**1. Dimensional Analysis of the Governing PDE**\n\nWe begin with the continuous governing law:\n$$\n\\frac{\\partial u}{\\partial t} = \\kappa\\, \\frac{\\partial^{2} u}{\\partial x^{2}}\n$$\nLet's analyze the units of each side.\n-   **Left-Hand Side (LHS):** The term $\\partial u/\\partial t$ is a rate of change of $u$ with respect to time. Its units are:\n    $$\n    \\left[\\frac{\\partial u}{\\partial t}\\right] = \\frac{[u]}{[t]} = \\frac{\\mathcal U}{\\mathcal T} = \\mathcal{U}\\mathcal{T}^{-1}\n    $$\n-   **Right-Hand Side (RHS):** The term $\\kappa\\, \\partial^{2} u/\\partial x^{2}$ involves the second spatial derivative of $u$. Its units are:\n    $$\n    \\left[\\kappa\\, \\frac{\\partial^{2} u}{\\partial x^{2}}\\right] = [\\kappa] \\left[\\frac{\\partial^{2} u}{\\partial x^{2}}\\right] = [\\kappa] \\frac{[u]}{[x]^2} = [\\kappa] \\frac{\\mathcal U}{\\mathcal L^2}\n    $$\nFor the PDE to be dimensionally homogeneous, we must have $[LHS] = [RHS]$:\n$$\n\\mathcal{U}\\mathcal{T}^{-1} = [\\kappa] \\frac{\\mathcal U}{\\mathcal L^2}\n$$\nSolving for the dimensions of the diffusivity constant $\\kappa$:\n$$\n[\\kappa] = \\frac{\\mathcal{U}\\mathcal{T}^{-1}}{\\mathcal{U}\\mathcal{L}^{-2}} = \\mathcal{L}^{2}\\mathcal{T}^{-1}\n$$\nThis is a fundamental result: the units of diffusivity are length-squared per time.\n\n**2. Dimensional Analysis of the Finite-Difference Scheme**\n\nNow we audit the discrete update equation:\n$$\nu^{n+1}_i \\;=\\; u^n_i \\;+\\; \\underbrace{\\left(\\kappa\\,\\frac{\\Delta t}{\\Delta x^2}\\right)\\,\\Big(u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}\\Big)}_{\\text{Increment Term}}\n$$\nThis is an additive equation. For it to be consistent, all three terms ($u^{n+1}_i$, $u^n_i$, and the increment term) must have the same units.\n\n-   **LHS Term:** The term $u^{n+1}_i$ is a value of the field $u$, so its units are $[u^{n+1}_i] = [u] = \\mathcal U$.\n-   **First RHS Term:** The term $u^n_i$ is also a value of the field $u$, so its units are $[u^n_i] = [u] = \\mathcal U$. This is consistent with the LHS.\n-   **Second RHS Term (Increment Term):** We must verify that this entire term also has units of $\\mathcal U$. Let's break it down.\n    -   **Parenthetical Difference:** The term $(u^n_{i+1} - 2\\,u^n_i + u^n_{i-1})$ is a linear combination of values of $u$. The numerical factor $2$ is dimensionless. Therefore, the units of this entire expression are simply the units of $u$:\n        $$\n        \\left[u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}\\right] = [u] = \\mathcal U\n        $$\n    -   **Prefactor:** The prefactor is the group $\\kappa\\,\\frac{\\Delta t}{\\Delta x^2}$. Let's determine its units using the result for $[\\kappa]$ and the definitions of the step sizes.\n        -   $[\\kappa] = \\mathcal{L}^{2}\\mathcal{T}^{-1}$\n        -   $\\Delta t$ is a time step, so $[\\Delta t] = [t] = \\mathcal T$.\n        -   $\\Delta x$ is a spatial step, so $[\\Delta x] = [x] = \\mathcal L$. Thus, $[\\Delta x^2] = \\mathcal L^2$.\n        -   The units of the prefactor are:\n            $$\n            \\left[\\kappa\\,\\frac{\\Delta t}{\\Delta x^2}\\right] = [\\kappa]\\,\\frac{[\\Delta t]}{[\\Delta x^2]} = (\\mathcal{L}^{2}\\mathcal{T}^{-1}) \\frac{\\mathcal T}{\\mathcal L^2} = \\mathcal{L}^{2-2}\\mathcal{T}^{-1+1} = \\mathcal{L}^{0}\\mathcal{T}^{0} = 1\n            $$\n            The prefactor $\\kappa\\,\\Delta t/\\Delta x^2$ is a dimensionless number. This group is often called the diffusion number or discrete Courant number.\n    -   **Total Increment Term:** The units of the increment term are the product of the units of its two parts:\n        $$\n        \\left[\\left(\\kappa\\,\\frac{\\Delta t}{\\Delta x^2}\\right)\\,\\Big(u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}\\Big)\\right] = 1 \\times \\mathcal U = \\mathcal U\n        $$\nSince the increment term has units $\\mathcal U$, it can be validly added to $u^n_i$ (units $\\mathcal U$) to yield $u^{n+1}_i$ (units $\\mathcal U$). The scheme is dimensionally homogeneous.\n\n**3. Hidden Assumptions**\n\n-   **Uniform Grid:** The finite-difference approximation for the second derivative, $\\frac{u^n_{i+1} - 2u^n_i + u^n_{i-1}}{\\Delta x^2}$, is valid for a grid with uniform spacing $\\Delta x$. The use of a single $\\Delta x^2$ term as a factor for the entire spatial domain implies this assumption.\n-   **Dimensionless Indices:** The indices $i$ and $n$ are dimensionless integers that serve as counters or labels for grid points and time levels, respectively.\n-   **Nondimensionalization:** If a user implements this scheme in code and sets a dimensional parameter like $\\kappa$ or $\\Delta x$ to a value like $1.0$, they are implicitly working in a nondimensional system of units. For example, to make the PDE dimensionless, one defines dimensionless variables $\\hat x = x/L_{\\mathrm{ref}}$, $\\hat t = t/T_{\\mathrm{ref}}$, and $\\hat u = u/U_{\\mathrm{ref}}$, where $L_{\\mathrm{ref}}$, $T_{\\mathrm{ref}}$, and $U_{\\mathrm{ref}}$ are characteristic reference scales. A judicious choice of $T_{\\mathrm{ref}} = L_{\\mathrm{ref}}^2 / \\kappa$ (where $\\kappa$ is the physical diffusivity) transforms the PDE into $\\partial \\hat u/\\partial \\hat t = \\partial^2 \\hat u/\\partial \\hat x^2$, where the effective dimensionless diffusivity is $1$. This practice is an application of formal nondimensionalization.\n\n### Option-by-Option Analysis\n\n**A. The scheme is dimensionally homogeneous provided $[\\kappa]=\\mathcal L^{2}\\,\\mathcal T^{-1}$, $[\\Delta x]=\\mathcal L$, $[\\Delta t]=\\mathcal T$, and $[u]=\\mathcal U$. The combination $\\kappa\\,\\Delta t/\\Delta x^{2}$ is dimensionless, and the parenthetical difference has units $\\mathcal U$, so the increment has units $\\mathcal U$ and can be added to $u^n_i$. Hidden assumptions include: uniform grid spacing (constant $\\Delta x$ so that a single $\\Delta x^{2}$ factors the discrete Laplacian), consistent units for $u$ at all nodes and times, indices $i$ and $n$ are dimensionless labels, and any coding choice like setting $\\kappa=1$ or $\\Delta x=1$ implies a deliberate nondimensionalization with reference scales, e.g., $x=L_{\\mathrm{ref}}\\,\\hat x$, $t=(L_{\\mathrm{ref}}^{2}/\\kappa_{\\mathrm{ref}})\\,\\hat t$, and $u=U_{\\mathrm{ref}}\\,\\hat u$.**\n-   This option correctly identifies that $[\\kappa]=\\mathcal L^{2}\\,\\mathcal T^{-1}$.\n-   It correctly states that $\\kappa\\,\\Delta t/\\Delta x^{2}$ is dimensionless.\n-   It correctly identifies the units of the difference term as $\\mathcal U$ and the increment as $\\mathcal U$.\n-   It correctly identifies the key assumptions: uniform grid, consistent units, dimensionless indices, and the implications of setting parameters to unity as a form of nondimensionalization. The example reference scales are standard.\n-   This option provides a complete and accurate audit.\n**Verdict: Correct.**\n\n**B. The factor $\\kappa\\,\\Delta t/\\Delta x^{2}$ has units $\\mathcal T^{-1}$, so the term $\\left(\\kappa\\,\\Delta t/\\Delta x^{2}\\right)\\left(u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}\\right)$ has units $\\mathcal U\\,\\mathcal T^{-1}$. Therefore, $u$ must be scaled to have units $\\mathcal U\\,\\mathcal T$ for the sum to be meaningful. No assumptions about grid uniformity are required.**\n-   The claim that $[\\kappa\\,\\Delta t/\\Delta x^{2}] = \\mathcal T^{-1}$ is incorrect. As derived, this group is dimensionless.\n-   The conclusion that the increment has units $\\mathcal U\\,\\mathcal T^{-1}$ is therefore also incorrect.\n-   The suggestion that $u$ must have units of $\\mathcal U\\,\\mathcal T$ is absurd and violates the very premise of the problem where $[u]=\\mathcal U$.\n-   The claim that no grid uniformity is required is false.\n**Verdict: Incorrect.**\n\n**C. Because $u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}$ is a discrete second derivative, it already has units $\\mathcal U\\,\\mathcal L^{-2}$. Thus, the denominator $\\Delta x^{2}$ in the update is redundant and should be removed to maintain consistency, giving $u^{n+1}_i = u^n_i + \\kappa\\,\\Delta t\\,\\left(u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}\\right)$.**\n-   This option makes a fundamental error. The expression $u^n_{i+1} - 2\\,u^n_i + u^n_{i-1}$ is a finite difference, but its units are simply $[u]=\\mathcal U$. It only becomes an approximation of the second derivative *after* division by $\\Delta x^2$. The premise that it has units $\\mathcal U\\,\\mathcal L^{-2}$ is false.\n-   Removing $\\Delta x^2$ would make the equation dimensionally inconsistent, as the added term would have units $[\\kappa][\\Delta t][u] = (\\mathcal{L}^2\\mathcal{T}^{-1})(\\mathcal T)(\\mathcal U) = \\mathcal{L}^2\\mathcal{U}$, which cannot be added to $u_i^n$ (units $\\mathcal U$).\n**Verdict: Incorrect.**\n\n**D. The update is dimensionally homogeneous only if $u$ is nondimensional (that is, $[u]=1$). If $u$ carries physical units, the sum $u^n_i + \\cdots$ is not defined, so $u$ must be scaled to be unitless before applying the scheme.**\n-   The word \"only\" makes this statement false. Our analysis proved that the scheme is perfectly dimensionally homogeneous even when $u$ carries physical units $\\mathcal U$. The claim that the sum is not defined for physical units is demonstrably false.\n**Verdict: Incorrect.**\n\n**E. Since indices $i$ and $n$ are integers, both $\\Delta x$ and $\\Delta t$ must be dimensionless increments; therefore, to balance units, $\\kappa$ must carry the same units as $u$ so that the added term matches $u^n_i$. This removes any need for nondimensionalization or reference scales.**\n-   The premise is flawed. From $x_i = i\\,\\Delta x$, if $[x_i]=\\mathcal L$ and $[i]=1$, then by dimensional analysis, $[\\Delta x]$ must be $\\mathcal L$. Similarly, $[\\Delta t]$ must be $\\mathcal T$. The claim that they are dimensionless is incorrect.\n-   The subsequent reasoning is built on this false premise and is therefore incorrect. For instance, requiring $[\\kappa]=[u]$ would lead to contradictions with the original PDE.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "This final practice reveals the profound connection between dimensionless parameters and the fundamental behavior of numerical algorithms. By analyzing the linear advection equation, you will see how the dimensionless Courant-Friedrichs-Lewy (CFL) number, $C = c \\Delta t / \\Delta x$, emerges as the sole parameter controlling the numerical stability of several common finite-difference schemes . This exercise demonstrates that dimensionless groups are not merely for scaling results but often act as the critical determinants of whether a computational simulation is physically meaningful or numerically unstable.",
            "id": "3117411",
            "problem": "Consider the one-dimensional linear advection equation with constant wave speed $c$,\n$$\nu_t + c\\,u_x = 0,\n$$\nwhere $u(x,t)$ is a scalar field, $x$ denotes position, and $t$ denotes time. The wave speed $c$ has physical units of length per time. You will analyze this equation through dimensional analysis and nondimensionalization, then connect the dimensionless parameter to stability of several explicit finite-difference schemes via von Neumann analysis.\n\nTasks:\n1) Nondimensionalization. Let $L$ be a positive characteristic length scale. Define the dimensionless spatial coordinate $\\hat{x} = x/L$ and the dimensionless time $\\hat{t} = t\\,c/L$. Show that in terms of $(\\hat{x},\\hat{t})$, the advection equation reduces to a parameter-free form\n$$\nu_{\\hat{t}} + u_{\\hat{x}} = 0.\n$$\nExplicitly state the change of variables and the chain-rule relations used. Explain, using dimensional reasoning, why $L$ and $c$ are sufficient to define a dimensionless time $\\hat{t}$.\n\n2) Discretization and the Courant-Friedrichs-Lewy (CFL) number. Consider a uniform grid with spacing $\\Delta x$ in space and $\\Delta t$ in time. Define the dimensionless Courant-Friedrichs-Lewy (CFL) number\n$$\n\\mathrm{C} = \\frac{c\\,\\Delta t}{\\Delta x}.\n$$\nFor each of the following explicit schemes applied to the advection equation, write the fully discrete update in terms of $u_j^n \\approx u(x_j,t_n)$ and express it entirely using the dimensionless parameter $\\mathrm{C}$:\n- Forward-Time Centered-Space (FTCS).\n- First-order upwind with correct upwind direction (use the backward difference in space if $c \\ge 0$ and the forward difference in space if $c  0$).\n- Lax-Wendroff.\n\nYou must present each scheme in a nondimensional form in which any reference to $c$, $\\Delta x$, and $\\Delta t$ appears only through $\\mathrm{C}$.\n\n3) Von Neumann stability analysis. For each scheme, assume a trial solution of the form $u_j^n = \\zeta^n e^{i j \\theta}$ where $\\theta$ is the dimensionless wavenumber measured in radians ($\\theta \\in [0,2\\pi)$), and $i$ is the imaginary unit. Derive the amplification factor $G(\\theta;\\mathrm{C})$ defined by $\\zeta^{n+1} = G(\\theta;\\mathrm{C}) \\zeta^n$ and give a necessary and sufficient condition for stability in terms of the requirement\n$$\n\\max_{\\theta \\in [0,2\\pi)} \\left|G(\\theta;\\mathrm{C})\\right| \\le 1.\n$$\nExplain how the inequality depends on $\\mathrm{C}$ for each scheme, and identify any boundary cases (for example, equality at $|G|=1$).\n\n4) Programmatic verification. Implement a program that, for a given list of test cases, uses your derived amplification factors to numerically approximate\n$$\n\\max_{\\theta \\in [0,2\\pi)} \\left|G(\\theta;\\mathrm{C})\\right|\n$$\nby sampling $\\theta$ uniformly over the interval $[0,2\\pi)$ in radians. For each test case, return a boolean value indicating stability, defined as true if the maximum modulus is less than or equal to $1$ up to a small numerical tolerance and false otherwise. Use a fixed absolute tolerance of $\\varepsilon = 10^{-10}$ in the inequality comparison.\n\nAngle unit requirement: All angles $\\theta$ must be treated in radians.\n\nTest suite:\nProvide results for the following ordered list of $(\\text{scheme}, \\mathrm{C})$ test cases:\n- $(\\text{\"upwind\"}, 0.5)$\n- $(\\text{\"upwind\"}, 1.0)$\n- $(\\text{\"upwind\"}, 1.2)$\n- $(\\text{\"upwind\"}, -0.8)$\n- $(\\text{\"lax\\_wendroff\"}, 0.9)$\n- $(\\text{\"lax\\_wendroff\"}, 1.0)$\n- $(\\text{\"lax\\_wendroff\"}, 1.1)$\n- $(\\text{\"ftcs\"}, 0.1)$\n- $(\\text{\"ftcs\"}, 0.0)$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of booleans enclosed in square brackets (for example, $[\\text{True},\\text{False},\\text{True}]$) in the exact order of the test cases above. No additional text should be printed.\n\nNotes:\n- The program must be self-contained and must not read any input.\n- The result for each test case must be a boolean.\n- Ensure that your implementation follows the nondimensional design in which stability depends only on the dimensionless number $\\mathrm{C}$ and the scheme choice.",
            "solution": "The validity of the problem statement is hereby confirmed. It is scientifically grounded, well-posed, and objective, presenting a standard problem in the field of numerical analysis for partial differential equations.\n\n### Step 1: Problem Validation\n\n**1. Extracted Givens:**\n- **Equation:** One-dimensional linear advection equation, $u_t + c\\,u_x = 0$.\n- **Variables:** $u(x,t)$ is a scalar field, $x$ is position, $t$ is time.\n- **Constant:** $c$ is a constant wave speed with units of length per time.\n- **Characteristic Scale:** $L$ is a positive characteristic length scale.\n- **Dimensionless Variables:** $\\hat{x} = x/L$ and $\\hat{t} = t\\,c/L$.\n- **Target Dimensionless Equation:** $u_{\\hat{t}} + u_{\\hat{x}} = 0$.\n- **Discretization:** Uniform grid with spacing $\\Delta x$ (space) and $\\Delta t$ (time). Grid function notation $u_j^n \\approx u(x_j, t_n)$.\n- **CFL Number Definition:** $\\mathrm{C} = \\frac{c\\,\\Delta t}{\\Delta x}$.\n- **Schemes for Analysis:** Forward-Time Centered-Space (FTCS), First-order upwind (with correct directionality based on sign of $c$), and Lax-Wendroff.\n- **Von Neumann Analysis:** Trial solution $u_j^n = \\zeta^n e^{i j \\theta}$. Amplification factor $G(\\theta;\\mathrm{C})$ where $\\zeta^{n+1} = G(\\theta;\\mathrm{C}) \\zeta^n$.\n- **Stability Condition:** $\\max_{\\theta \\in [0,2\\pi)} \\left|G(\\theta;\\mathrm{C})\\right| \\le 1$.\n- **Numerical Verification:** Programmatically approximate $\\max_{\\theta \\in [0,2\\pi)} |G(\\theta;\\mathrm{C})|$ by sampling $\\theta$. The stability check must use an absolute tolerance $\\varepsilon = 10^{-10}$.\n- **Test Cases:** A specific list of pairs $(\\text{scheme}, \\mathrm{C})$.\n- **Output Format:** A single-line comma-separated list of booleans in square brackets.\n\n**2. Validation Verdict:**\nThe problem is **valid**. It is a standard, self-contained educational problem from computational science. It is scientifically sound, relying on fundamental principles of calculus, dimensional analysis, and numerical methods. The definitions are precise, the tasks are well-defined, and the problem is free of ambiguity or contradiction.\n\n### Step 2: Solution\n\n#### 1) Nondimensionalization\n\nWe are given the advection equation $u_t + c u_x = 0$, where the partial derivatives are denoted by subscripts. The dimensionless variables are defined as $\\hat{x} = x/L$ and $\\hat{t} = (t c)/L$. We transform the partial derivatives using the multivariate chain rule.\n\nThe partial derivative with respect to time $t$ is:\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial u}{\\partial \\hat{t}} \\frac{\\partial \\hat{t}}{\\partial t} + \\frac{\\partial u}{\\partial \\hat{x}} \\frac{\\partial \\hat{x}}{\\partial t}\n$$\nWe compute the partial derivatives of the new coordinates with respect to the old ones:\n$$\n\\frac{\\partial \\hat{t}}{\\partial t} = \\frac{\\partial}{\\partial t} \\left(\\frac{tc}{L}\\right) = \\frac{c}{L}\n$$\n$$\n\\frac{\\partial \\hat{x}}{\\partial t} = \\frac{\\partial}{\\partial t} \\left(\\frac{x}{L}\\right) = 0 \\quad (\\text{since } x \\text{ and } t \\text{ are independent variables})\n$$\nSubstituting these back, we get:\n$$\nu_t = u_{\\hat{t}} \\left(\\frac{c}{L}\\right) + u_{\\hat{x}}(0) = \\frac{c}{L} u_{\\hat{t}}\n$$\n\nThe partial derivative with respect to position $x$ is:\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial u}{\\partial \\hat{x}} \\frac{\\partial \\hat{x}}{\\partial x} + \\frac{\\partial u}{\\partial \\hat{t}} \\frac{\\partial \\hat{t}}{\\partial x}\n$$\nThe required partial derivatives are:\n$$\n\\frac{\\partial \\hat{x}}{\\partial x} = \\frac{\\partial}{\\partial x} \\left(\\frac{x}{L}\\right) = \\frac{1}{L}\n$$\n$$\n\\frac{\\partial \\hat{t}}{\\partial x} = \\frac{\\partial}{\\partial x} \\left(\\frac{tc}{L}\\right) = 0\n$$\nSubstituting these back, we get:\n$$\nu_x = u_{\\hat{x}} \\left(\\frac{1}{L}\\right) + u_{\\hat{t}}(0) = \\frac{1}{L} u_{\\hat{x}}\n$$\n\nNow, we substitute the expressions for $u_t$ and $u_x$ into the original advection equation:\n$$\nu_t + c u_x = 0 \\implies \\left(\\frac{c}{L} u_{\\hat{t}}\\right) + c \\left(\\frac{1}{L} u_{\\hat{x}}\\right) = 0\n$$\nFactoring out the common term $(c/L)$:\n$$\n\\frac{c}{L} (u_{\\hat{t}} + u_{\\hat{x}}) = 0\n$$\nSince $c \\neq 0$ and $L  0$, the term $c/L$ is non-zero. Thus, we can divide by it to obtain the parameter-free dimensionless equation:\n$$\nu_{\\hat{t}} + u_{\\hat{x}} = 0\n$$\n\n**Dimensional Reasoning for $\\hat{t}$:**\nThe physical dimensions of the quantities are: time $[t] = T$, length $[x] = [L] = L$, and wave speed $[c] = L T^{-1}$. To make time $t$ dimensionless, we must multiply or divide it by a combination of other parameters that has the dimension of time, $T$. The parameters available are $L$ and $c$. The unique combination (up to a power) of $L$ and $c$ that yields a dimension of time is $L/c$, which has dimensions $L / (L T^{-1}) = T$. Therefore, the quantity $t / (L/c) = tc/L$ is a dimensionless time variable.\n\n#### 2) Discretization and the CFL Number\n\nThe Courant-Friedrichs-Lewy (CFL) number is defined as the dimensionless parameter $\\mathrm{C} = \\frac{c \\Delta t}{\\Delta x}$. We now express each finite difference scheme in terms of $\\mathrm{C}$.\n\n**Forward-Time Centered-Space (FTCS):**\nThe discretization is forward in time and centered in space:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x} = 0\n$$\nRearranging for the update rule $u_j^{n+1}$:\n$$\nu_j^{n+1} = u_j^n - c \\frac{\\Delta t}{2 \\Delta x} (u_{j+1}^n - u_{j-1}^n)\n$$\nSubstituting $\\mathrm{C} = c \\Delta t / \\Delta x$:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\mathrm{C}}{2} (u_{j+1}^n - u_{j-1}^n)\n$$\n\n**First-Order Upwind:**\nThe spatial derivative is chosen based on the direction of wave propagation, i.e., the sign of $c$ (and thus $\\mathrm{C}$).\n- If $c \\ge 0$ (so $\\mathrm{C} \\ge 0$), information propagates from left to right. We use a backward difference:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0 \\implies u_j^{n+1} = u_j^n - \\frac{c \\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n)\n$$\nIn dimensionless form:\n$$\nu_j^{n+1} = u_j^n - \\mathrm{C} (u_j^n - u_{j-1}^n)\n$$\n- If $c  0$ (so $\\mathrm{C}  0$), information propagates from right to left. We use a forward difference:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0 \\implies u_j^{n+1} = u_j^n - \\frac{c \\Delta t}{\\Delta x} (u_{j+1}^n - u_j^n)\n$$\nIn dimensionless form:\n$$\nu_j^{n+1} = u_j^n - \\mathrm{C} (u_{j+1}^n - u_j^n)\n$$\n\n**Lax-Wendroff:**\nThis scheme is derived from a second-order Taylor expansion in time, using the PDE to replace time derivatives with spatial derivatives ($u_t = -c u_x$, $u_{tt} = c^2 u_{xx}$).\n$$\nu_j^{n+1} = u_j^n + \\Delta t (u_t)_j^n + \\frac{(\\Delta t)^2}{2} (u_{tt})_j^n + \\mathcal{O}((\\Delta t)^3) = u_j^n - c \\Delta t (u_x)_j^n + \\frac{c^2 (\\Delta t)^2}{2} (u_{xx})_j^n\n$$\nUsing centered finite differences for the spatial derivatives:\n$$\nu_j^{n+1} = u_j^n - c \\Delta t \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x} \\right) + \\frac{c^2 (\\Delta t)^2}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\nSubstituting $\\mathrm{C} = c \\Delta t / \\Delta x$:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\mathrm{C}}{2} (u_{j+1}^n - u_{j-1}^n) + \\frac{\\mathrm{C}^2}{2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\n#### 3) Von Neumann Stability Analysis\n\nWe substitute the trial solution $u_j^n = \\zeta^n e^{i j \\theta}$ into each discrete equation. We use the relations $u_j^{n+1} = \\zeta G \\zeta^{n-1} e^{ij\\theta} = G\\zeta^n e^{i j \\theta}$ and $u_{j\\pm 1}^n = \\zeta^n e^{i (j\\pm 1) \\theta} = \\zeta^n e^{i j \\theta} e^{\\pm i \\theta}$. Dividing the resulting equation by $\\zeta^n e^{i j \\theta}$ yields the amplification factor $G(\\theta; \\mathrm{C})$.\n\n**FTCS:**\n$$\nG = 1 - \\frac{\\mathrm{C}}{2} (e^{i\\theta} - e^{-i\\theta}) = 1 - \\frac{\\mathrm{C}}{2} (2i\\sin\\theta) = 1 - i\\mathrm{C}\\sin\\theta\n$$\nThe modulus squared is $|G|^2 = 1^2 + (-\\mathrm{C}\\sin\\theta)^2 = 1 + \\mathrm{C}^2\\sin^2\\theta$.\nThe stability condition $|G| \\le 1$ requires $|G|^2 \\le 1$, so $1 + \\mathrm{C}^2\\sin^2\\theta \\le 1$, which implies $\\mathrm{C}^2\\sin^2\\theta \\le 0$. Since both terms are non-negative, this is only possible if $\\mathrm{C}\\sin\\theta = 0$ for all $\\theta \\in [0, 2\\pi)$. This requires $\\mathrm{C}=0$. The scheme is unconditionally unstable for any $\\mathrm{C} \\neq 0$. If $\\mathrm{C}=0$, $|G|=1$.\n\n**First-Order Upwind:**\n- For $\\mathrm{C} \\ge 0$:\n$$\nG = 1 - \\mathrm{C}(1 - e^{-i\\theta})\n$$\nThe modulus squared is $|G|^2 = |(1-\\mathrm{C}) + \\mathrm{C}e^{-i\\theta}|^2 = |(1-\\mathrm{C}) + \\mathrm{C}(\\cos\\theta - i\\sin\\theta)|^2 = ((1-\\mathrm{C}) + \\mathrm{C}\\cos\\theta)^2 + (-\\mathrm{C}\\sin\\theta)^2$. After simplification, this yields $|G|^2 = 1 - 2\\mathrm{C}(1-\\mathrm{C})(1-\\cos\\theta)$. For stability ($|G|^2 \\le 1$), we need $-2\\mathrm{C}(1-\\mathrm{C})(1-\\cos\\theta) \\le 0$. Since $1-\\cos\\theta \\ge 0$, this requires $\\mathrm{C}(1-\\mathrm{C}) \\ge 0$. Given $\\mathrm{C} \\ge 0$, this is true if $1-\\mathrm{C} \\ge 0$, i.e., $0 \\le \\mathrm{C} \\le 1$.\n- For $\\mathrm{C}  0$:\n$$\nG = 1 - \\mathrm{C}(e^{i\\theta} - 1)\n$$\nThe modulus squared is $|G|^2 = |(1+\\mathrm{C}) - \\mathrm{C}e^{i\\theta}|^2 = ((1+\\mathrm{C}) - \\mathrm{C}\\cos\\theta)^2 + (-\\mathrm{C}\\sin\\theta)^2$. This simplifies to $|G|^2 = 1 + 2\\mathrm{C}(1+\\mathrm{C})(1-\\cos\\theta)$. For stability ($|G|^2 \\le 1$), we need $2\\mathrm{C}(1+\\mathrm{C})(1-\\cos\\theta) \\le 0$. Since $\\mathrm{C}  0$ and $1-\\cos\\theta \\ge 0$, this requires $1+\\mathrm{C} \\ge 0$, i.e., $-1 \\le \\mathrm{C}  0$.\n**Combined Condition:** For the correct upwind scheme, stability is achieved for $0 \\le \\mathrm{C} \\le 1$ (backward difference) or $-1 \\le \\mathrm{C} \\le 0$ (forward difference).\n\n**Lax-Wendroff:**\n$$\nG = 1 - \\frac{\\mathrm{C}}{2} (e^{i\\theta} - e^{-i\\theta}) + \\frac{\\mathrm{C}^2}{2} (e^{i\\theta} - 2 + e^{-i\\theta})\n$$\nUsing $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ and $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$:\n$$\nG = 1 - i\\mathrm{C}\\sin\\theta + \\mathrm{C}^2(\\cos\\theta - 1)\n$$\nThe modulus squared is $|G|^2 = |(1 + \\mathrm{C}^2(\\cos\\theta-1)) - i\\mathrm{C}\\sin\\theta|^2$. A detailed calculation yields:\n$$\n|G|^2 = 1 - 4\\mathrm{C}^2(1-\\mathrm{C}^2)\\sin^4(\\theta/2)\n$$\nFor stability ($|G|^2 \\le 1$), we need $-4\\mathrm{C}^2(1-\\mathrm{C}^2)\\sin^4(\\theta/2) \\le 0$. Since $\\mathrm{C}^2 \\ge 0$ and $\\sin^4(\\theta/2) \\ge 0$, this condition holds if and only if $1-\\mathrm{C}^2 \\ge 0$, which is equivalent to $\\mathrm{C}^2 \\le 1$, or $|\\mathrm{C}| \\le 1$. At the boundaries $|\\mathrm{C}|=1$, we have $|G|=1$ for all $\\theta$.\n\n#### 4) Programmatic Verification\n\nThe following Python code implements the derived amplification factors to test the stability for the specified cases. The maximum modulus of $G$ is approximated by evaluating it at $2000$ uniformly spaced points for $\\theta$ in $[0, 2\\pi)$. Stability is determined by checking if this maximum is less than or equal to $1$ plus a small tolerance $\\varepsilon = 10^{-10}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates the stability of finite-difference schemes for the 1D advection equation\n    by numerically calculating the maximum modulus of the amplification factor.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\"upwind\", 0.5),\n        (\"upwind\", 1.0),\n        (\"upwind\", 1.2),\n        (\"upwind\", -0.8),\n        (\"lax_wendroff\", 0.9),\n        (\"lax_wendroff\", 1.0),\n        (\"lax_wendroff\", 1.1),\n        (\"ftcs\", 0.1),\n        (\"ftcs\", 0.0),\n    ]\n\n    results = []\n    # Use a sufficient number of points to sample the wavenumber theta\n    num_theta_points = 2000\n    theta = np.linspace(0, 2 * np.pi, num_theta_points)\n    \n    # Define absolute tolerance for stability check\n    tolerance = 1e-10\n\n    for scheme, C in test_cases:\n        G = None  # Amplification factor\n        \n        if scheme == \"ftcs\":\n            # G = 1 - i*C*sin(theta)\n            G = 1 - 1j * C * np.sin(theta)\n        \n        elif scheme == \"upwind\":\n            # The correct upwind scheme depends on the sign of C (which has the sign of c)\n            if C >= 0:\n                # Backward difference for c >= 0\n                # G = 1 - C * (1 - exp(-i*theta))\n                G = 1 - C * (1 - np.exp(-1j * theta))\n            else: # C  0\n                # Forward difference for c  0\n                # G = 1 - C * (exp(i*theta) - 1)\n                G = 1 - C * (np.exp(1j * theta) - 1)\n        \n        elif scheme == \"lax_wendroff\":\n            # G = 1 - i*C*sin(theta) + C^2*(cos(theta) - 1)\n            G = 1 - 1j * C * np.sin(theta) + C**2 * (np.cos(theta) - 1)\n\n        # Calculate the maximum modulus of the amplification factor\n        max_mod_G = np.max(np.abs(G))\n        \n        # A scheme is stable if max|G| = 1. We check with a small tolerance.\n        is_stable = max_mod_G = 1.0 + tolerance\n        results.append(is_stable)\n\n    # Format output as a comma-separated list of booleans inside square brackets.\n    # Python's str() for a boolean (True/False) produces correctly capitalized 'True'/'False'.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}