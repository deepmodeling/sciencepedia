{
    "hands_on_practices": [
        {
            "introduction": "对无量纲数的深刻理解始于观察它们如何从第一性原理中产生。第一个实践将引导你解决经典的瑞利-贝纳德（Rayleigh-Bénard）问题，其中一个底部受热的流体层会从纯粹的导热状态转变为活跃的对流状态。通过线性稳定性分析，你将推导出临界瑞利数（$Ra_c$），这是一个能够独立预测这种不稳定性何时发生的无量纲参数。这个练习  不仅巩固了瑞利数的物理意义，还让你亲身体验了一个强大的分析工具，该工具被广泛用于预测科学与工程中许多领域的临界现象。",
            "id": "3946574",
            "problem": "考虑一个厚度为 $H$ 的无限大水平牛顿流体层，其底部和顶部表面之间存在一个固定的温差 $\\Delta T$，并从下方加热。假设 Boussinesq 近似成立，基态为纯导热态，且边界为理想热传导边界，因此温度扰动在边界上为零。设无量纲垂直坐标为 $z \\in [0,1]$，并用 $H$ 对长度进行无量纲化，用 $H^{2}/\\alpha$ 对时间进行无量纲化，用 $\\alpha/H$ 对速度进行无量纲化，用 $\\Delta T$ 对温度扰动进行无量纲化，其中 $\\alpha$ 是热扩散系数。\n\n- 在 Boussinesq 近似下，从描述导热基态无穷小扰动的线性化、无量纲控制方程出发，这些方程用无量纲速度场 $\\boldsymbol{u}$、压力 $p$ 和温度扰动 $\\theta$ 表示。使用具有水平波数大小 $a$ 和增长率 $\\sigma$ 的简正模假设，得到一个关于 $z$ 的一维特征值问题，该问题确定了对流起始时的中性稳定性条件（$\\sigma = 0$）。\n\n- 对于在 $z=0$ 和 $z=1$ 处的机械自由-自由（无应力）边界，施加适用于无应力表面的运动学条件，以及在两个边界上均施加热边界条件 $\\theta=0$。利用这些边界条件，确定瑞利数 $Ra$ 和水平波数 $a$ 之间的中性稳定性关系 $Ra(a)$。然后，通过在 $a0$ 上最小化 $Ra(a)$ 来找到对流起始的临界瑞利数 $Ra_{c,\\text{FF}}$，并给出 $Ra_{c,\\text{FF}}$ 的精确解析表达式。\n\n- 对于具有相同热边界条件的机械刚性-刚性（无滑移）边界，相应的线性特征值问题不接受简单的闭合形式解析中性曲线，但其临界瑞利数在数值上是已知的。使用从无滑移边界特征值问题的数值解中得到的已知值 $Ra_{c,\\text{RR}} = 1707.76$。\n\n计算比率\n$$\\chi = \\frac{Ra_{c,\\text{RR}}}{Ra_{c,\\text{FF}}}$$\n并报告保留四位有效数字的 $\\chi$。最终答案必须是这个单一的实数值。由于瑞利数是无量纲的，因此不需要单位。",
            "solution": "该问题要求计算在下方加热的流体层中，对于两种不同的机械边界条件（刚性-刚性和自由-自由），对流起始时的临界瑞利数之比。\n\n首先，我们建立控制方程。描述静止导热基态扰动的线性化、无量纲 Boussinesq 方程如下：\n连续性方程：\n$$ \\nabla \\cdot \\boldsymbol{u} = 0 $$\n动量方程：\n$$ \\frac{1}{\\text{Pr}} \\frac{\\partial \\boldsymbol{u}}{\\partial t} = -\\nabla p + \\nabla^2 \\boldsymbol{u} + \\text{Ra} \\, \\theta \\, \\hat{\\boldsymbol{k}} $$\n能量方程：\n$$ \\frac{\\partial \\theta}{\\partial t} = w + \\nabla^2 \\theta $$\n此处，$\\boldsymbol{u} = (u,v,w)$ 是无量纲速度扰动，$p$ 是压力扰动，$\\theta$ 是温度扰动，$\\text{Ra}$ 是瑞利数，$\\text{Pr}$ 是普朗特数，$\\hat{\\boldsymbol{k}}$ 是垂直方向 $z$ 上的单位向量。\n\n我们通过为变量引入简正模来分析稳定性。我们寻求以下形式的解：\n$$ (w, \\theta) = (W(z), \\Theta(z)) \\exp(i(k_x x + k_y y) + \\sigma t) $$\n其中 $a = \\sqrt{k_x^2 + k_y^2}$ 是水平波数的大小，$\\sigma$ 是增长率。算子 $\\nabla^2$ 和水平拉普拉斯算子 $\\nabla_h^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ 变换为：\n$$ \\nabla^2 \\rightarrow D^2 - a^2 \\quad \\text{和} \\quad \\nabla_h^2 \\rightarrow -a^2 $$\n其中 $D = d/dz$。\n\n为了简化系统，我们消去水平速度分量 $u$、$v$ 和压力 $p$。将算子 $\\hat{\\boldsymbol{k}} \\cdot (\\nabla \\times \\nabla \\times \\cdot)$ 应用于动量方程，并使用连续性方程，得到一个关于垂直速度分量 $w$ 的方程。这产生了一个关于 $w$ 和 $\\theta$ 的耦合方程组：\n$$ \\frac{1}{\\text{Pr}} \\frac{\\partial}{\\partial t}(\\nabla^2 w) = \\nabla^4 w + \\text{Ra} \\, \\nabla_h^2 \\theta $$\n$$ \\frac{\\partial \\theta}{\\partial t} = w + \\nabla^2 \\theta $$\n将简正模形式代入这些方程，得到两个关于振幅 $W(z)$ 和 $\\Theta(z)$ 的常微分方程：\n$$ \\frac{\\sigma}{\\text{Pr}} (D^2 - a^2)W = (D^2 - a^2)^2 W - \\text{Ra} \\, a^2 \\Theta $$\n$$ \\sigma \\Theta = W + (D^2 - a^2) \\Theta $$\n我们关心的是中性稳定性条件，它标志着对流的开始。这对应于增长率 $\\sigma$ 为零的情况。令 $\\sigma=0$ 可将系统简化为：\n$$ (D^2 - a^2)^2 W = \\text{Ra} \\, a^2 \\Theta $$\n$$ W = -(D^2 - a^2) \\Theta $$\n我们可以合并这两个方程，得到一个关于 $W(z)$ 的六阶常微分方程：\n$$ (D^2 - a^2) W = -(D^2 - a^2) (-(D^2 - a^2) \\Theta) = (D^2 - a^2)^2 \\Theta $$\n从第一个方程，$\\Theta = \\frac{1}{\\text{Ra}\\,a^2}(D^2 - a^2)^2 W$。将此代入 $W$ 的方程中：\n$$ W = -(D^2 - a^2) \\left[ \\frac{1}{\\text{Ra}\\,a^2}(D^2 - a^2)^2 W \\right] $$\n$$ (D^2 - a^2)^3 W + \\text{Ra} \\, a^2 W = 0 $$\n这就是关于瑞利数 $\\text{Ra}$ 的特征值问题。\n\n对于在 $z=0$ 和 $z=1$ 处的自由-自由边界情况，边界条件为：\n1.  边界上无垂直速度：$w=0 \\implies W(0)=W(1)=0$。\n2.  理想导热边界：$\\theta=0 \\implies \\Theta(0)=\\Theta(1)=0$。\n3.  无应力（零切向应力）表面：$\\frac{\\partial u}{\\partial z} = \\frac{\\partial v}{\\partial z} = 0$。可以证明，该条件等价于在边界处 $\\frac{\\partial^2 w}{\\partial z^2}=0$，因此 $D^2W(0)=D^2W(1)=0$。\n\n从方程 $W=-(D^2-a^2)\\Theta$ 可知，条件 $\\theta=0$ 和 $W=0$ 意味着在边界处 $D^2\\Theta=0$。对该方程求导两次，得到 $D^2W = -(D^4 - a^2 D^2)\\Theta$。在边界上，由于 $W=0, D^2W=0, \\Theta=0, D^2\\Theta=0$，因此可以推断出 $D^4\\Theta=0$。观察常微分方程，边界条件 $W=0$ 和 $\\Theta=0$ 意味着 $(D^2-a^2)^2 W = 0$。由于 $W=0$ 和 $D^2W=0$，这进一步意味着在边界处 $D^4W=0$。因此，$W(z)$ 的完整边界条件集为：\n$$ W = D^2 W = D^4 W = 0 \\quad \\text{at } z=0, 1 $$\n满足这些边界条件的最简单的非平凡特征函数的形式为 $W(z) = A \\sin(n\\pi z)$，其中 $n$ 为整数。我们来验证一下：\n$W(0)=A\\sin(0)=0$ 且 $W(1)=A\\sin(n\\pi)=0$。\n$D^2 W = -A(n\\pi)^2 \\sin(n\\pi z)$，所以 $D^2W(0)=0$ 且 $D^2W(1)=0$。\n$D^4 W = A(n\\pi)^4 \\sin(n\\pi z)$，所以 $D^4W(0)=0$ 且 $D^4W(1)=0$。\n条件得到满足。\n\n现在我们将 $W(z) \\propto \\sin(n\\pi z)$ 代入控制常微分方程。对于这个特征函数，$D^2W = -(n\\pi)^2 W$。算子 $(D^2 - a^2)$ 相当于一个简单的乘法常数：$(-(n\\pi)^2 - a^2)$。该常微分方程变成了关于特征值 $\\text{Ra}$ 的一个代数方程：\n$$ ((-(n\\pi)^2 - a^2))^3 + \\text{Ra} \\, a^2 = 0 $$\n$$ -((n\\pi)^2 + a^2)^3 + \\text{Ra} \\, a^2 = 0 $$\n$$ \\text{Ra}(a, n) = \\frac{((n\\pi)^2 + a^2)^3}{a^2} $$\n对流的起始对应于最低可能的瑞利数。这发生在 $n$ 取最小可能值时，即 $n=1$。因此我们考虑：\n$$ \\text{Ra}(a) = \\frac{(\\pi^2 + a^2)^3}{a^2} $$\n为了找到临界瑞利数，我们必须对 $\\text{Ra}(a)$ 关于水平波数 $a$ 求最小值。我们计算其导数并令其为零：\n$$ \\frac{d\\text{Ra}}{da} = \\frac{3(\\pi^2+a^2)^2(2a)(a^2) - (\\pi^2+a^2)^3(2a)}{a^4} = 0 $$\n对于 $a0$ 且 $\\pi^2+a^2 \\neq 0$，我们可以将其简化为：\n$$ 3a^2(\\pi^2+a^2)^2 = (\\pi^2+a^2)^3 $$\n$$ 3a^2 = \\pi^2 + a^2 $$\n$$ 2a^2 = \\pi^2 \\implies a_c^2 = \\frac{\\pi^2}{2} $$\n临界波数为 $a_c = \\pi/\\sqrt{2}$。将此值代回 $\\text{Ra}(a)$ 的表达式中，得到自由-自由边界的临界瑞利数 $\\text{Ra}_{c,\\text{FF}}$：\n$$ \\text{Ra}_{c,\\text{FF}} = \\frac{(\\pi^2 + \\frac{\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{(\\frac{3\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{\\frac{27\\pi^6}{8}}{\\frac{\\pi^2}{2}} = \\frac{27\\pi^4}{4} $$\n这就是 $\\text{Ra}_{c,\\text{FF}}$ 的精确解析表达式。\n\n问题给出了刚性-刚性边界下数值计算的临界瑞利数：\n$$ \\text{Ra}_{c,\\text{RR}} = 1707.76 $$\n我们现在可以计算比率 $\\chi$：\n$$ \\chi = \\frac{\\text{Ra}_{c,\\text{RR}}}{\\text{Ra}_{c,\\text{FF}}} = \\frac{1707.76}{\\frac{27\\pi^4}{4}} $$\n首先，我们计算 $\\text{Ra}_{c,\\text{FF}}$ 的数值：\n$$ \\text{Ra}_{c,\\text{FF}} = \\frac{27}{4}\\pi^4 \\approx 6.75 \\times (3.14159265...)^4 \\approx 6.75 \\times 97.409091... \\approx 657.51136... $$\n现在，该比率为：\n$$ \\chi = \\frac{1707.76}{657.51136...} \\approx 2.597305... $$\n将此值四舍五入到四位有效数字，得到：\n$$ \\chi \\approx 2.597 $$",
            "answer": "$$\\boxed{2.597}$$"
        },
        {
            "introduction": "无量纲数是描绘复杂物理现象版图的强大工具。本实践将探讨普朗特数（$Pr$），即动量扩散率与热扩散率之比，是如何决定平板上强制对流传热的基本性质的。你将采用匹配渐近分析方法，研究两种截然不同的情况：$Pr \\sim 1$ 的流体（如空气）和 $Pr \\ll 1$ 的流体（如液态金属）。这个问题  将训练你从控制方程中推导标度律的技能，揭示单个无量纲数如何能极大地改变解的结构和其背后的物理机制。",
            "id": "3946643",
            "problem": "考虑一个物性恒定的不可压缩流体，以自由来流速度 $U_{\\infty}$ 稳态、二维、层流强制对流流过一块壁面温度为 $T_{w}$ 的等温半无限长平板，其自由来流温度为 $T_{\\infty}$。设运动粘度为 $\\nu$，热扩散系数为 $\\alpha$，热导率为 $k$。在边界层条件下（动量和能量方程中流向扩散可忽略，压力梯度可忽略），控制边界层方程为\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0,\n$$\n$$\nu \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^{2} u}{\\partial y^{2}},\n$$\n$$\nu \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}},\n$$\n边界条件为 $u(x,0)=0$，$T(x,0)=T_{w}$，$u(x,y\\to\\infty)=U_{\\infty}$，$T(x,y\\to\\infty)=T_{\\infty}$。\n\n定义雷诺数 $Re_{x} = \\frac{U_{\\infty} x}{\\nu}$、普朗特数 $Pr = \\frac{\\nu}{\\alpha}$ 和局部努塞尔数 $Nu_{x} = \\frac{h_{x} x}{k}$，其中 $h_{x}$ 是局部对流换热系数。在适当的情况下，您可以使用经过充分检验的 Blasius 标度来描述速度边界层厚度 $\\delta_{v}(x) \\sim x\\,Re_{x}^{-1/2}$ 和近壁线性剪切近似 $u \\approx a\\,y$，其中 $a \\sim \\left.\\frac{\\partial u}{\\partial y}\\right|_{y=0} \\sim \\frac{U_{\\infty}}{\\delta_{v}}$。\n\n使用内层区域（$y = \\mathcal{O}(\\delta_{v})$）和外层热区域（$y = \\mathcal{O}(\\delta_{T})$）之间的匹配渐近分析，确定当流体从 $Pr \\approx 0.7$（空气，$Pr = \\mathcal{O}(1)$）变为 $Pr \\approx 0.01$（液态金属，$Pr \\ll 1$）时，典型形式\n$$\nNu_{x} \\sim K\\,Re_{x}^{a}\\,Pr^{b}\n$$\n中的标度指数必须如何变化。此处 $K$ 是一个无量纲常数，在不同区域可能不同，但无需计算；任务是通过主导平衡论证和内外解的渐近匹配来推导指数 $a$ 和 $b$。\n\n假设 $Re_{x}$ 足够大，使得层流边界层存在，并且能量方程中的流向热传导可以忽略。不要使用经验传热关联式；从边界层方程和渐近匹配中推导出其依赖关系。将您的最终答案表示为一个有序四元组 $\\left(a_{\\text{air}},\\,b_{\\text{air}},\\,a_{\\text{metal}},\\,b_{\\text{metal}}\\right)$ 的单行矩阵。不需要进行数值取整，指数应以精确的分数形式给出，不带单位。",
            "solution": "该问题要求确定关系式 $Nu_{x} \\sim K\\,Re_{x}^{a}\\,Pr^{b}$ 中，对于普朗特数的两个不同区域，$Pr \\sim \\mathcal{O}(1)$ 和 $Pr \\ll 1$，标度指数 $a$ 和 $b$ 的值。\n\n局部努塞尔数 $Nu_{x}$ 的标度与热边界层厚度 $\\delta_T$ 相关，其关系为：\n$$\nNu_{x} = \\frac{h_{x} x}{k} = \\frac{(-k \\frac{\\partial T}{\\partial y}|_{y=0}) x}{k(T_w - T_\\infty)} \\sim \\frac{x}{\\delta_T}\n$$\n因此，我们的任务是找到两种情况下 $\\delta_T(x)$ 的标度关系。\n\n**情况1：空气 ($Pr \\approx 0.7$, 即 $Pr = \\mathcal{O}(1)$)**\n\n当普朗特数是$O(1)$量级时，动量扩散率 $\\nu$ 和热扩散率 $\\alpha$ 大小相当。这意味着动量边界层厚度 $\\delta_v$ 和热边界层厚度 $\\delta_T$ 也是同一量级：\n$$\n\\delta_T \\sim \\delta_v\n$$\n问题中给出了速度边界层的标准 Blasius 标度：\n$$\n\\delta_v(x) \\sim x\\,Re_{x}^{-1/2}\n$$\n因此，对于 $Pr \\sim 1$ 的情况，热边界层也遵循此标度：\n$$\n\\delta_T(x) \\sim x\\,Re_{x}^{-1/2}\n$$\n代入努塞尔数的标度关系中：\n$$\nNu_x \\sim \\frac{x}{\\delta_T} \\sim \\frac{x}{x\\,Re_x^{-1/2}} = Re_x^{1/2}\n$$\n这确定了指数 $a_{\\text{air}} = 1/2$。对于 $Pr$ 的依赖关系，一个更详细的分析（如 Pohlhausen 相似解）表明，对于 $Pr \\gtrsim 0.6$ 的流体，关系式可以由 $Nu_x \\propto Pr^{1/3}$ 精确描述。因此，我们确定指数 $b_{\\text{air}} = 1/3$。\n对于空气，我们得到 $(a_{\\text{air}}, b_{\\text{air}}) = (\\frac{1}{2}, \\frac{1}{3})$。\n\n**情况2：液态金属 ($Pr \\ll 1$)**\n\n当普朗特数远小于1时，热扩散率远大于动量扩散率 ($\\alpha \\gg \\nu$)。这意味着热量比动量扩散得更远，导致热边界层比速度边界层厚得多：\n$$\n\\delta_T \\gg \\delta_v\n$$\n因此，在热边界层的大部分区域（外层），速度可以近似为自由来流速度 $u \\approx U_{\\infty}$。能量边界层方程 $u \\frac{\\partial T}{\\partial x} + v \\frac{\\partial T}{\\partial y} = \\alpha \\frac{\\partial^{2} T}{\\partial y^{2}}$ 中的主导平衡在自由来流的平流项和法向的热扩散项之间：\n$$\nU_{\\infty} \\frac{\\partial T}{\\partial x} \\approx \\alpha \\frac{\\partial^2 T}{\\partial y^2}\n$$\n对此方程进行标度分析，特征尺度分别为流向的 $x$、法向的 $\\delta_T$ 以及温差 $\\Delta T$：\n$$\nU_{\\infty} \\frac{\\Delta T}{x} \\sim \\alpha \\frac{\\Delta T}{\\delta_T^2}\n$$\n求解 $\\delta_T$：\n$$\n\\delta_T^2 \\sim \\frac{\\alpha x}{U_\\infty} \\implies \\delta_T \\sim \\sqrt{\\frac{\\alpha x}{U_\\infty}}\n$$\n为了用无量纲数表示，我们整理得到：\n$$\n\\delta_T \\sim \\sqrt{\\frac{\\nu x}{U_\\infty} \\cdot \\frac{\\alpha}{\\nu}} = \\sqrt{\\frac{x^2}{Re_x} \\cdot \\frac{1}{Pr}} = x\\,Re_x^{-1/2}\\,Pr^{-1/2}\n$$\n(该结果与我们的初始假设 $\\delta_T/\\delta_v \\sim Pr^{-1/2} \\gg 1$ 是一致的。)\n现在，我们计算努塞尔数的标度：\n$$\nNu_x \\sim \\frac{x}{\\delta_T} \\sim \\frac{x}{x\\,Re_x^{-1/2}\\,Pr^{-1/2}} = Re_x^{1/2}\\,Pr^{1/2}\n$$\n这给出了液态金属情况下的指数 $(a_{\\text{metal}}, b_{\\text{metal}}) = (\\frac{1}{2}, \\frac{1}{2})$。\n\n**指数总结**\n\n将结果组合成有序四元组 $(a_{\\text{air}}, b_{\\text{air}}, a_{\\text{metal}}, b_{\\text{metal}})$：\n$$\n\\left( \\frac{1}{2}, \\frac{1}{3}, \\frac{1}{2}, \\frac{1}{2} \\right)\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{3}  \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在计算工程时代，无量纲数的作用已从物理分析延伸到数值建模。最后的这个实践将通过研究用克兰克-尼科尔森（Crank-Nicolson）方法求解的一维热方程来弥合这一差距。你会发现，傅里葉数（$Fo$），作为一个无量纲时间，不仅是控制物理扩散过程的关键参数，同样也支配着数值模拟的稳定性和准确性。通过执行冯·诺依曼（von Neumann）稳定性分析并推导准确性约束，你将能制定一个实用的时间步长控制策略 ，从而将理论洞察力直接转化为稳健高效的计算程序设计。",
            "id": "3946581",
            "problem": "考虑一个长度为 $L$ 的均匀平板中的一维瞬态热传导，其边界条件为狄利克雷（Dirichlet）边界条件，初始温度场 $u(x,0)$ 光滑且可分解为空间傅里叶（Fourier）模态。控制方程为热方程 $u_t = \\alpha u_{xx}$，其中 $\\alpha$ 是热扩散率。使用包含 $n_x$ 个节点、间距为 $\\Delta x = L/(n_x-1)$ 的均匀网格对空间进行离散化。使用 Crank–Nicolson (CN) 方法对时间进行离散化，这是一种在时间上二阶精度的隐式格式。将无量纲时间步长（傅里叶数）记为 $\\Delta Fo = \\alpha \\Delta t/\\Delta x^2$，其中 $\\Delta t$ 是物理时间步长。\n\n你的任务是：\n- 从热方程和应用于标准二阶中心空间离散的 Crank–Nicolson 更新出发，执行傅里叶（von Neumann）模态分析，以获得每个时间步长的放大因子。由此推导出 $\\Delta Fo$ 与稳定性之间的精确关系。特别解释在何种条件下，对于所有可分辨的空间模态，放大因子保持非负。\n- 使用精确的半离散演化 $u(t+\\Delta t) = \\exp\\!\\big( (\\alpha \\Delta t/\\Delta x^2)\\,L \\big)\\,u(t)$（其中 $L$ 是离散拉普拉斯算子），将 CN 放大因子与精确的指数放大因子进行比较，以确定在固定的物理时间范围 $t_f$ 内，主阶全局误差对 $\\Delta Fo$ 的依赖关系。推导出一个关于 $\\Delta Fo$ 的保守界限，该界限用目标无量纲相对振幅容差 $\\varepsilon$ 表示，并确保在时间 $t_f$ 时，CN 解的模态振幅与精确半离散演化的偏差不超过 $\\varepsilon$。\n- 设计一个时间步长控制策略，在给定 $L$、 $n_x$、 $\\alpha$、 $t_f$ 和 $\\varepsilon$ 的情况下，计算一个推荐的 $\\Delta Fo^\\star$。该值应在 $[0,t_f]$ 区间内，对所有可分辨的空间模态，同时满足你得出的单调性约束和精度要求。该控制策略必须只表示为这些输入的函数，并且不得依赖于实际的初始条件。\n\n实现一个程序，为每个测试用例计算并输出你的控制策略返回的单个浮点数值 $\\Delta Fo^\\star$。每个输出值必须四舍五入到六位小数。你的策略中使用的空间网格间距必须为 $\\Delta x = L/(n_x-1)$。你的程序应产生单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，$[0.123000,0.500000]$）。不允许有任何其他输出。\n\n使用以下科学上合理的测试套件，其中所有量在适用情况下均采用国际单位制 (SI)：\n- 测试用例 1（一般情况）：$\\alpha = 1.0\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, $L = 0.1\\,\\mathrm{m}$, $n_x = 51$, $t_f = 2.0\\,\\mathrm{s}$, $\\varepsilon = 1.0\\times 10^{-3}$。\n- 测试用例 2（受单调性限制）：$\\alpha = 1.0\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, $L = 0.1\\,\\mathrm{m}$, $n_x = 51$, $t_f = 0.1\\,\\mathrm{s}$, $\\varepsilon = 1.0$。\n- 测试用例 3（单调性与精度限制重合的边界条件）：$\\alpha = 1.0\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, $L = 0.1\\,\\mathrm{m}$, $n_x = 51$, $t_f = 0.1\\,\\mathrm{s}$, $\\varepsilon = 1/3$。\n- 测试用例 4（精细空间分辨率）：$\\alpha = 1.0\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, $L = 0.1\\,\\mathrm{m}$, $n_x = 201$, $t_f = 2.0\\,\\mathrm{s}$, $\\varepsilon = 1.0\\times 10^{-3}$。\n- 测试用例 5（更高的热扩散率和更严格的容差）：$\\alpha = 1.0\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, $L = 0.1\\,\\mathrm{m}$, $n_x = 51$, $t_f = 2.0\\,\\mathrm{s}$, $\\varepsilon = 1.0\\times 10^{-4}$。\n\n你的程序必须输出单行 $[\\Delta Fo^\\star_1,\\Delta Fo^\\star_2,\\Delta Fo^\\star_3,\\Delta Fo^\\star_4,\\Delta Fo^\\star_5]$，其中每个条目都四舍五入到六位小数且无量纲。",
            "solution": "该问题需要推导一个应用于一维热方程的 Crank–Nicolson (CN) 方法的时间步长选择策略，该策略基于单调性和精度的约束。该策略将得出一个推荐的无量纲时间步长，即傅里叶数 $\\Delta Fo^\\star$。\n\n**1. 傅里叶稳定性分析与单调性约束**\n\n一维热方程为 $u_t = \\alpha u_{xx}$。使用 Crank–Nicolson 方法对其进行离散化，并令 $\\Delta Fo = \\alpha \\Delta t / \\Delta x^2$ 为傅里叶数。\n为执行 von Neumann 稳定性分析，我们考虑单个傅里叶模态的演化，$u_j^n = G^n e^{i k j \\Delta x}$，其中 $k$ 是波数，$G(k)$ 是每个时间步长的放大因子。代入差分方程并化简，得到：\n$$ G(k) = \\frac{1 - 2\\Delta Fo \\sin^2(k\\Delta x/2)}{1 + 2\\Delta Fo \\sin^2(k\\Delta x/2)} $$\n为了数值稳定性，我们需要 $|G(k)| \\le 1$。由于 $\\Delta Fo \\ge 0$ 且 $\\sin^2(k\\Delta x/2) \\ge 0$，分母总是大于或等于分子的绝对值。因此，对于所有 $\\Delta Fo \\ge 0$，都有 $|G(k)| \\le 1$，所以 Crank–Nicolson 方法是无条件稳定的。\n\n然而，为了防止非物理振荡，通常希望格式是单调的，这要求放大因子为非负值，即 $G(k) \\ge 0$。由于分母恒为正，我们要求分子为非负：\n$$ 1 - 2\\Delta Fo \\sin^2(k\\Delta x/2) \\ge 0 $$\n这个不等式必须对所有可分辨的空间模态都成立。限制性最强的情况发生在最高可分辨波数 $k_{max} = \\pi/\\Delta x$ 时，此时 $\\sin^2(k_{max}\\Delta x/2) = \\sin^2(\\pi/2) = 1$。因此，条件变为：\n$$ 1 - 2\\Delta Fo \\ge 0 \\implies \\Delta Fo \\le \\frac{1}{2} $$\n这就确立了单调性约束：$\\Delta Fo_{mono} \\le 0.5$。\n\n**2. 精度分析与约束**\n\n我们通过比较数值放大因子 $G_{CN}(k)$ 与半离散系统的精确放大因子 $G_{exact}(k)$ 来量化精度。\n半离散方程在一个时间步长 $\\Delta t$ 内的精确模态放大因子为：\n$$ G_{exact}(k) = \\exp \\left(-\\alpha \\Delta t \\frac{4}{\\Delta x^2} \\sin^2(k\\Delta x/2)\\right) = \\exp \\left(-4 \\Delta Fo \\sin^2(k\\Delta x/2)\\right) $$\n令变量 $\\beta = 2 \\Delta Fo \\sin^2(k\\Delta x/2)$。放大因子为：\n$$ G_{exact}(k) = e^{-2\\beta} \\quad \\text{和} \\quad G_{CN}(k) = \\frac{1-\\beta}{1+\\beta} $$\n经过 $N$ 个时间步长到达最终时间 $t_f = N\\Delta t$ 后，一个模态振幅的相对误差由 $\\left| (G_{CN}/G_{exact})^N - 1 \\right|$ 给出。对于每步的小误差，这可以近似为 $|N \\ln(G_{CN}/G_{exact})|$。使用泰勒级数展开 $\\ln(1+x) \\approx x - x^2/2 + x^3/3$：\n$$ \\ln\\left(\\frac{G_{CN}}{G_{exact}}\\right) = \\ln\\left(\\frac{1-\\beta}{1+\\beta}\\right) - \\ln(e^{-2\\beta}) = (\\ln(1-\\beta) - \\ln(1+\\beta)) + 2\\beta $$\n$$ \\ln\\left(\\frac{G_{CN}}{G_{exact}}\\right) \\approx \\left(-\\beta-\\frac{\\beta^2}{2}-\\frac{\\beta^3}{3}\\right) - \\left(\\beta-\\frac{\\beta^2}{2}+\\frac{\\beta^3}{3}\\right) + 2\\beta = -\\frac{2}{3}\\beta^3 $$\n在 $t_f$ 时的总相对误差近似为：\n$$ \\text{Error} \\approx \\left| N \\left(-\\frac{2}{3}\\beta^3\\right) \\right| = \\frac{t_f}{\\Delta t} \\frac{2}{3} \\left( 2 \\Delta Fo \\sin^2(k\\Delta x/2) \\right)^3 $$\n代入 $\\Delta t = \\Delta Fo \\Delta x^2 / \\alpha$：\n$$ \\text{Error} \\approx \\frac{t_f \\alpha}{\\Delta Fo \\Delta x^2} \\frac{16}{3} \\Delta Fo^3 \\sin^6(k\\Delta x/2) = \\frac{16}{3} \\frac{t_f \\alpha}{\\Delta x^2} \\Delta Fo^2 \\sin^6(k\\Delta x/2) $$\n对于最高频率模态（$k=\\pi/\\Delta x$），误差最大，此时 $\\sin^6(k\\Delta x/2) = 1$。问题要求这种最坏情况下的相对误差受容差 $\\varepsilon$ 的限制：\n$$ \\frac{16}{3} \\frac{t_f \\alpha}{\\Delta x^2} \\Delta Fo^2 \\le \\varepsilon $$\n解出 $\\Delta Fo$ 得到精度约束：\n$$ \\Delta Fo \\le \\sqrt{\\frac{3 \\varepsilon \\Delta x^2}{16 t_f \\alpha}} = \\frac{\\Delta x}{4} \\sqrt{\\frac{3 \\varepsilon}{t_f \\alpha}} $$\n我们将这个基于精度的限制记为 $\\Delta Fo_{acc}$。\n\n**3. 时间步长控制策略**\n\n最终推荐的时间步长 $\\Delta Fo^\\star$ 必须同时满足单调性约束和精度约束，因此它必须是两个推导出的界限中较小的那个：\n$$ \\Delta Fo^\\star = \\min(\\Delta Fo_{mono}, \\Delta Fo_{acc}) $$\n代入推导出的表达式：\n$$ \\Delta Fo^\\star = \\min\\left(0.5, \\frac{\\Delta x}{4} \\sqrt{\\frac{3 \\varepsilon}{t_f \\alpha}}\\right) $$\n其中空间步长为 $\\Delta x = L/(n_x-1)$。该策略为傅里叶数提供了一个保守的选择，确保了非振荡行为，并在整个模拟时程内满足指定的全局误差容差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the recommended Fourier number (Delta Fo_star) for a series of test cases\n    based on derived monotonicity and accuracy constraints for the Crank-Nicolson scheme.\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    # Each tuple contains: (alpha, L, n_x, t_f, epsilon)\n    test_cases = [\n        # Test case 1 (general case)\n        (1.0e-5, 0.1, 51, 2.0, 1.0e-3),\n        # Test case 2 (monotonicity-limited)\n        (1.0e-5, 0.1, 51, 0.1, 1.0),\n        # Test case 3 (boundary condition where monotonicity and accuracy limits coincide)\n        (1.0e-5, 0.1, 51, 0.1, 1.0/3.0),\n        # Test case 4 (fine spatial resolution)\n        (1.0e-5, 0.1, 201, 2.0, 1.0e-3),\n        # Test case 5 (higher thermal diffusivity and stricter tolerance)\n        (1.0e-4, 0.1, 51, 2.0, 1.0e-4),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        alpha, L, n_x, t_f, epsilon = case\n        \n        # Calculate the spatial grid spacing, delta_x.\n        # As per the problem, dx = L / (nx - 1).\n        delta_x = L / (n_x - 1)\n        \n        # 1. Monotonicity constraint for the Crank-Nicolson scheme.\n        # This constraint requires Delta Fo = 0.5 to avoid non-physical oscillations.\n        delta_fo_mono = 0.5\n        \n        # 2. Accuracy constraint derived from the global error analysis.\n        # The relative error in amplitude must be less than or equal to epsilon.\n        # The formula is Delta Fo = (delta_x / 4) * sqrt(3 * epsilon / (t_f * alpha)).\n        # We ensure the argument of the square root is non-negative.\n        arg_sqrt = (3.0 * epsilon) / (t_f * alpha)\n        if arg_sqrt  0:\n            delta_fo_acc = 0.0\n        else:\n            delta_fo_acc = (delta_x / 4.0) * np.sqrt(arg_sqrt)\n            \n        # The recommended Fourier number, Delta Fo_star, must satisfy both constraints.\n        # Therefore, we take the minimum of the two bounds.\n        delta_fo_star = min(delta_fo_mono, delta_fo_acc)\n        \n        # Format the result to six decimal places as a string for the final output.\n        results.append(\"{:.6f}\".format(delta_fo_star))\n\n    # Print the final result in the exact required format: [res1,res2,...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}