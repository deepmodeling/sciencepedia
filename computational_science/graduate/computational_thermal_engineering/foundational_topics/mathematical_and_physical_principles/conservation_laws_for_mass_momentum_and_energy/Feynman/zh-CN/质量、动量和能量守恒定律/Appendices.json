{
    "hands_on_practices": [
        {
            "introduction": "本章节的实践始于最基本的层面。我们将回顾质量守恒定律的积分形式。通过将雷诺输运定理应用于一个变形的控制体，你将推导出控制体内质量的变化率与其边界上质量流量之间的关系。这项练习旨在巩固你对如何将一个基本物理原理转化为适用于控制体的数学表述的理解，这是有限体积法的基石。",
            "id": "3944078",
            "problem": "一个密度场为 $\\rho(\\mathbf{x},t)$ 的可压缩流体占据了一个变形控制体 $V(t)$，该控制体由一个光滑的控制面 $S(t)$ 界定，其外法向单位矢量为 $\\mathbf{n}(\\mathbf{x},t)$。该控制面有两个设有仪表的端口：一个面积为 $A_{\\mathrm{in}}(t)$ 的入口和一个面积为 $A_{\\mathrm{out}}(t)$ 的出口。控制体的其余表面是质量不可渗透的。流体速度为 $\\mathbf{u}(\\mathbf{x},t)$，局部边界速度为 $\\mathbf{u}_{b}(\\mathbf{x},t)$。入口和出口的质量流量是相对于移动边界测量的，分别由\n$$\n\\dot{m}_{\\mathrm{in}}(t) \\text{ 和 } \\dot{m}_{\\mathrm{out}}(t),\n$$\n给出，其符号约定为：$\\dot{m}_{\\mathrm{in}}(t) \\ge 0$ 表示质量通过 $A_{\\mathrm{in}}(t)$ 流入 $V(t)$，$\\dot{m}_{\\mathrm{out}}(t) \\ge 0$ 表示质量通过 $A_{\\mathrm{out}}(t)$ 流出 $V(t)$。在 $V(t)$ 内部没有质量的体积源或汇。\n\n从物质系统的质量守恒第一性原理出发，并使用适当的输运定理将物质系统与变形控制体联系起来，写出 $V(t)$ 的积分质量平衡方程，并求解它以获得控制体中总质量变化率\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{V(t)} \\rho(\\mathbf{x},t)\\,\\mathrm{d}V,\n$$\n的表达式，该表达式仅用 $\\dot{m}_{\\mathrm{in}}(t)$ 和 $\\dot{m}_{\\mathrm{out}}(t)$ 表示。用千克每秒（kg s$^{-1}$）表示你的最终答案。无需数值计算；提供一个封闭形式的符号表达式。",
            "solution": "该问题要求从质量守恒的基本原理出发，推导变形控制体内总质量变化率的表达式。\n\n第一个原理是应用于物质系统的质量守恒定律。物质系统定义为固定的物质集合，因此其总质量 $M_{sys}$ 不随时间变化。该物质系统占据一个随流体移动和变形的物质体积 $V_m(t)$。该系统的质量守恒表示为：\n$$\n\\frac{\\mathrm{d}M_{sys}}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V_m(t)} \\rho(\\mathbf{x},t) \\, \\mathrm{d}V = 0\n$$\n其中 $\\rho(\\mathbf{x},t)$ 是流体密度场。\n\n下一步是将物质系统的变化率与相对于控制体 $V(t)$ 测量的量联系起来。问题指定了一个变形控制体 $V(t)$，由一个以局部速度 $\\mathbf{u}_b(\\mathbf{x},t)$ 移动的表面 $S(t)$ 界定。进行此转换的合适工具是广义Reynolds输运定理（也称为Leibniz-Reynolds定理）。对于任意广延性质 $B_{sys} = \\int_{V_m(t)} \\beta(\\mathbf{x},t) \\, \\mathrm{d}V$，其中 $\\beta$ 是相应的单位体积内涵性质，该定理表述为：\n$$\n\\frac{\\mathrm{d}B_{sys}}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\beta \\, \\mathrm{d}V + \\int_{S(t)} \\beta (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\n这里，$\\mathbf{u}(\\mathbf{x},t)$ 是流体速度，$\\mathbf{n}(\\mathbf{x},t)$ 是控制面 $S(t)$ 上的外法向单位矢量。项 $(\\mathbf{u} - \\mathbf{u}_b)$ 表示流体相对于移动边界的速度。该定理应用于物质体积 $V_m(t)$ 和控制体 $V(t)$ 重合的瞬间。\n\n对于质量守恒，广延性质是质量本身 $M_{sys}$，因此相应的单位体积内涵性质是密度 $\\rho$。在Reynolds输运定理中令 $\\beta = \\rho$ 得到：\n$$\n\\frac{\\mathrm{d}M_{sys}}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho \\, \\mathrm{d}V + \\int_{S(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\n将质量守恒原理 $\\frac{\\mathrm{d}M_{sys}}{\\mathrm{d}t} = 0$ 应用于上述方程，得出变形控制体的积分质量平衡方程：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho \\, \\mathrm{d}V + \\int_{S(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = 0\n$$\n问题要求的是控制体中总质量变化率的表达式，即 $\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho \\, \\mathrm{d}V$ 这一项。我们将其记为 $\\frac{\\mathrm{d}M_{CV}}{\\mathrm{d}t}$。重新整理该方程可得：\n$$\n\\frac{\\mathrm{d}M_{CV}}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho \\, \\mathrm{d}V = - \\int_{S(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\n右侧是穿过控制面 $S(t)$ 的净质量流入率。控制面由三个不相交的部分组成：入口 $A_{\\mathrm{in}}(t)$、出口 $A_{\\mathrm{out}}(t)$ 和不可渗透的壁面 $S_{wall}(t)$。面积分可以相应地分解为：\n$$\n\\int_{S(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = \\int_{A_{\\mathrm{in}}(t)} \\! \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S + \\int_{A_{\\mathrm{out}}(t)} \\! \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S + \\int_{S_{wall}(t)} \\! \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\n我们逐一分析每个积分：\n1.  在不可渗透的壁面 $S_{wall}(t)$ 上，没有质量可以穿过。这意味着流体相对于边界速度的法向分量为零：$(\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} = 0$。因此，在壁面上的积分为零：\n    $$\n    \\int_{S_{wall}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = 0\n    $$\n2.  在入口 $A_{\\mathrm{in}}(t)$ 处，问题陈述*流入*控制体的质量流量为 $\\dot{m}_{\\mathrm{in}}(t) \\ge 0$。积分 $\\int_{A_{\\mathrm{in}}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S$ 表示通过入口表面的质量通量。对于入口，相对速度矢量 $(\\mathbf{u} - \\mathbf{u}_b)$ 指向体积内部，与外法向矢量 $\\mathbf{n}$ 的方向相反。因此，点积 $(\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n}$ 为负。该积分表示通过入口的净质量*流出*，其值必须为负。给定的*流入*质量流量 $\\dot{m}_{\\mathrm{in}}(t)$ 定义为正值。因此，它必须是该面积分的负值：\n    $$\n    \\dot{m}_{\\mathrm{in}}(t) = - \\int_{A_{\\mathrm{in}}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S \\implies \\int_{A_{\\mathrm{in}}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = - \\dot{m}_{\\mathrm{in}}(t)\n    $$\n3.  在出口 $A_{\\mathrm{out}}(t)$ 处，*流出*控制体的质量流量为 $\\dot{m}_{\\mathrm{out}}(t) \\ge 0$。对于出口，流体离开该体积，因此相对速度 $(\\mathbf{u} - \\mathbf{u}_b)$ 与外法向 $\\mathbf{n}$ 方向相同。点积 $(\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n}$ 为正。积分 $\\int_{A_{\\mathrm{out}}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S$ 表示质量流出率，这正是 $\\dot{m}_{\\mathrm{out}}(t)$ 的定义：\n    $$\n    \\int_{A_{\\mathrm{out}}(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = \\dot{m}_{\\mathrm{out}}(t)\n    $$\n将这些结果代回总面积分的表达式中：\n$$\n\\int_{S(t)} \\rho (\\mathbf{u} - \\mathbf{u}_b) \\cdot \\mathbf{n} \\, \\mathrm{d}S = (-\\dot{m}_{\\mathrm{in}}(t)) + (\\dot{m}_{\\mathrm{out}}(t)) + 0 = \\dot{m}_{\\mathrm{out}}(t) - \\dot{m}_{\\mathrm{in}}(t)\n$$\n该项表示从控制体流出的净质量流出率。\n最后，我们将其代入整理后的质量平衡方程：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho \\, \\mathrm{d}V = - \\left( \\dot{m}_{\\mathrm{out}}(t) - \\dot{m}_{\\mathrm{in}}(t) \\right)\n$$\n这可化简为控制体内质量变化率的最终表达式：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{V(t)} \\rho(\\mathbf{x},t) \\, \\mathrm{d}V = \\dot{m}_{\\mathrm{in}}(t) - \\dot{m}_{\\mathrm{out}}(t)\n$$\n该表达式表明，控制体中质量的累积率等于质量流入率减去质量流出率。量 $\\dot{m}_{\\mathrm{in}}(t)$ 和 $\\dot{m}_{\\mathrm{out}}(t)$ 是质量流量，其单位是单位时间的质量，例如千克每秒（$kg s^{-1}$），这与问题的要求一致。",
            "answer": "$$\n\\boxed{\\dot{m}_{\\mathrm{in}}(t) - \\dot{m}_{\\mathrm{out}}(t)}\n$$"
        },
        {
            "introduction": "在积分守恒定律的基础上，这项实践将带你进入数值离散化的世界。你将把有限体积法（FVM）应用于一个通用非结构化网格上的连续性方程。本练习的一个关键部分是证明所得到的半离散格式是全局守恒的——这是任何可靠模拟都必须具备的关键属性。这个动手编程任务将弥合连续方程与其离散形式之间的鸿沟，并阐明为何有限体积法是确保守恒性的首选方法。",
            "id": "3944083",
            "problem": "考虑一个控制体积 $V$ 内，密度为 $\\rho$、速度为 $\\mathbf{u}$ 的流体的质量守恒（连续性方程）的积分形式：$$\\frac{d}{dt}\\int_{V} \\rho \\, dV + \\oint_{\\partial V} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n} \\, dA = 0.$$ 使用有限体积法 (FVM)，一个通用的非结构化网格将计算域划分为由索引 $i$ 标识的不重叠单元，每个单元的体积为 $|V_i|$，其边界 $\\partial V_i$ 由索引为 $f$ 的面组成。将每个面 $f$ 上的单值质量通量定义为 $$\\Phi_f = \\rho_f\\, (\\mathbf{u}_f\\cdot\\mathbf{n}_f)\\, A_f,$$ 其中 $\\rho_f$ 是面密度的近似值，$\\mathbf{u}_f\\cdot\\mathbf{n}_f$ 是面上速度的法向分量，而 $A_f$ 是面的面积（在二维情况下是长度）。对于由相邻单元 $i$ 和 $j$ 共享的每个内部面 $f$，固定一个方向，其单位法向量 $\\mathbf{n}_f$ 从单元 $i$（左单元）指向单元 $j$（右单元）。对于单元 $i$ 的边界面 $f$，不存在相邻的右单元；不可穿透边界条件强制 $(\\mathbf{u}_f\\cdot\\mathbf{n}_f) = 0$，而周期性边界条件将成对的边界面识别为适当单元对之间的内部连接，从而使 $\\Phi_f$ 是单值的。\n\n任务A（推导）：严格地从积分形式和上述定义出发，在通用非结构化网格上推导连续性方程的半离散FVM格式。引入每个单元 $i$ 的半离散残差 $R_i$（用定向的单值面通量 $\\Phi_f$ 表示），并证明半离散常微分方程具有以下形式：$$\\frac{d}{dt}\\left(\\rho_i\\, |V_i|\\right) + R_i = 0,$$ 其中 $\\rho_i$ 是由 $\\rho_i = \\frac{1}{|V_i|}\\int_{V_i}\\rho\\, dV$ 定义的单元平均密度，并且 $$R_i = \\sum_{f\\in \\partial V_i} s_{i,f}\\, \\Phi_f,$$ 其中 $s_{i,f} = +1$ 如果面 $f$ 的方向是自单元 $i$ 向外（单元 $i$ 是 $f$ 的左单元），$s_{i,f} = -1$ 如果面 $f$ 的方向是指向单元 $i$（单元 $i$ 是 $f$ 的右单元）。\n\n任务B（全局守恒证明）：证明当所有边界面都是不可穿透或周期性的时候，所有单元上半离散残差 $R_i$ 的总和精确为零。你的证明必须仅依赖于单值面通量的性质和方向约定，而不假设除 $\\rho_f$ 对于引用同一面 $f$ 的两个相邻单元是相同之外的任何特定插值格式。\n\n任务C（程序）：实现一个程序，为每个单元计算半离散残差，并在以下测试套件上数值验证全局守恒性质。在所有测试中，将所有量视为无量纲的，这意味着输出是无单位的浮点数。\n\n测试定义：\n- 程序必须使用单值面通量 $\\Phi_f = \\rho_f\\, u_{n,f}\\, A_f$，其中 $u_{n,f}$ 表示面 $f$ 上的法向速度分量。对于由单元 $i$ 和 $j$ 共享的内部面，使用算术平均 $\\rho_f = \\frac{1}{2}(\\rho_i + \\rho_j)$。对于边界面，使用 $\\rho_f = \\rho_i$（这个选择不影响不可穿透面，因为 $u_{n,f} = 0$），对于周期性边界，将它们视为映射的单元对之间的内部面，并使用相同的单值 $\\Phi_f$。\n\n测试套件：\n- 测试 $1$（通用非结构化网格，不可穿透边界）：单元索引为 $i \\in \\{0,1,2,3,4\\}$，单元密度为 $[\\rho_0,\\rho_1,\\rho_2,\\rho_3,\\rho_4] = [1.0, 0.8, 1.3, 0.9, 1.1]$。面被指定为元组 $(\\ell, r, A_f, u_{n,f})$，其中 $\\ell$ 是左单元索引，$r$ 是右单元索引（对于边界面，$r$ 可以是 $\\text{None}$），$A_f$ 是面面积，$u_{n,f}$ 是法向速度。内部面：$(0,1,1.2,0.7)$、$(1,2,0.9,-1.1)$、$(2,3,1.5,0.3)$、$(3,4,1.1,-0.5)$、$(4,0,1.0,0.9)$、$(0,2,0.8,-0.4)$、$(1,3,1.3,0.2)$。不可穿透边界面：$(0,\\text{None},2.0,0.0)$、$(1,\\text{None},2.1,0.0)$、$(2,\\text{None},1.9,0.0)$、$(3,\\text{None},2.2,0.0)$、$(4,\\text{None},2.0,0.0)$。\n- 测试 $2$（具有左右周期性边界和上下不可穿透边界的结构化网格）：单元索引为 $i \\in \\{0,1,2,3\\}$，密度为 $[\\rho_0,\\rho_1,\\rho_2,\\rho_3] = [1.2, 0.7, 1.0, 0.9]$。内部面：$(0,1,1.0,0.4)$、$(2,3,1.0,-0.6)$、$(0,2,1.0,0.5)$、$(1,3,1.0,-0.3)$。作为内部面处理的周期性面：$(0,1,0.8,0.33)$、$(2,3,0.8,-0.21)$。不可穿透边界面（顶部和底部）：$(0,\\text{None},0.9,0.0)$、$(1,\\text{None},0.9,0.0)$、$(2,\\text{None},0.9,0.0)$、$(3,\\text{None},0.9,0.0)$。\n- 测试 $3$（所有面上的速度均为零）：使用与测试1相同的单元和面，但为所有面（包括内部面）设置 $u_{n,f} = 0.0$。\n\n你的程序应使用上述定向残差的定义，为每个测试计算全局总和 $\\sum_i R_i$。最终输出必须是单行，包含一个由方括号括起来的逗号分隔列表，其中按顺序包含测试1、测试2和测试3的三个浮点数。例如，输出格式必须与 $[x_1,x_2,x_3]$ 完全一样，其中每个 $x_k$ 是你的程序计算出的浮点数。输出是无单位的，不需要任何单位转换。",
            "solution": "该问题具有科学依据，内容自洽，且提法适定。任务涉及质量守恒方程的半离散有限体积法（FVM）格式的标准推导、其内在守恒性质的证明，以及数值验证。所有需要的数据和定义均已提供。该问题是有效的，下面给出了一个解决方案。\n\n**任务A：半离散FVM格式的推导**\n\n出发点是控制体积 $V$ 内流体密度为 $\\rho$、速度矢量为 $\\mathbf{u}$ 的质量守恒积分形式：\n$$ \\frac{d}{dt}\\int_{V} \\rho \\, dV + \\oint_{\\partial V} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n} \\, dA = 0 $$\n在有限体积法中，我们将此方程应用于计算网格中的每个单独单元（或控制体积）$V_i$。对于单个单元 $i$，方程为：\n$$ \\frac{d}{dt}\\int_{V_i} \\rho \\, dV + \\oint_{\\partial V_i} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n}_i \\, dA = 0 $$\n其中 $\\mathbf{n}_i$ 是单元 $i$ 边界 $\\partial V_i$ 上的局部向外单位法向量。\n\n第一项表示单元 $i$ 内质量的变化率。我们引入单元平均密度 $\\rho_i$ 为：\n$$ \\rho_i = \\frac{1}{|V_i|}\\int_{V_i}\\rho\\, dV $$\n其中 $|V_i|$ 是单元 $i$ 的体积。因此，单元中的质量为 $m_i = \\rho_i |V_i|$。时间导数项是：\n$$ \\frac{d}{dt}\\int_{V_i} \\rho \\, dV = \\frac{d}{dt} \\left(\\rho_i |V_i|\\right) $$\n问题陈述要求这种形式，它对固定网格和移动网格都具有通用性。\n\n第二项是表面积分，表示流出单元 $i$ 的净质量通量。边界 $\\partial V_i$ 由一组平面组成，索引为 $f$。该积分可以离散化为对这些面的求和：\n$$ \\oint_{\\partial V_i} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n}_i \\, dA = \\sum_{f \\in \\partial V_i} \\int_{A_f} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n}_i \\, dA $$\nFVM通过假设面上的值为常数（等于某个具有代表性的面心值 $\\rho_f$ 和 $\\mathbf{u}_f$）来近似每个面上的积分。单个面 $f$ 上的积分于是近似为：\n$$ \\int_{A_f} \\rho \\, \\mathbf{u}\\cdot\\mathbf{n}_i \\, dA \\approx \\rho_f (\\mathbf{u}_f \\cdot \\mathbf{n}_i) A_f $$\n其中 $A_f$ 是面 $f$ 的面积。\n\n问题定义了一个单值的、定向的面通量 $\\Phi_f$。对于“左”单元 $i$ 和“右”单元 $j$ 之间共享的每个内部面 $f$，定义了一个固定的单位法向量 $\\mathbf{n}_f$，从 $i$ 指向 $j$。通量为 $\\Phi_f = \\rho_f\\, (\\mathbf{u}_f\\cdot\\mathbf{n}_f)\\, A_f$。我们必须将局部向外法向量 $\\mathbf{n}_i$ 与这个定向法向量 $\\mathbf{n}_f$ 联系起来。\n\n1.  如果单元 $i$ 是面 $f$ 的“左”单元，其向外法向量 $\\mathbf{n}_i$ 与面定向法向量相同，即 $\\mathbf{n}_i = \\mathbf{n}_f$。问题为此情况定义了一个符号因子 $s_{i,f} = +1$。流出单元 $i$ 且通过面 $f$ 的质量通量为：\n    $$ \\rho_f (\\mathbf{u}_f \\cdot \\mathbf{n}_i) A_f = \\rho_f (\\mathbf{u}_f \\cdot \\mathbf{n}_f) A_f = \\Phi_f = s_{i,f} \\Phi_f $$\n2.  如果单元 $i$ 是面 $f$ 的“右”单元（而某个其他单元 $j$ 是“左”单元），其向外法向量 $\\mathbf{n}_i$ 与面定向法向量相反，即 $\\mathbf{n}_i = -\\mathbf{n}_f$。问题为此情况定义了一个符号因子 $s_{i,f} = -1$。流出单元 $i$ 且通过面 $f$ 的质量通量为：\n    $$ \\rho_f (\\mathbf{u}_f \\cdot \\mathbf{n}_i) A_f = \\rho_f (\\mathbf{u}_f \\cdot (-\\mathbf{n}_f)) A_f = - \\rho_f (\\mathbf{u}_f \\cdot \\mathbf{n}_f) A_f = -\\Phi_f = s_{i,f} \\Phi_f $$\n\n在这两种情况下，面 $f$ 对单元 $i$ 平衡的通量贡献都是 $s_{i,f}\\Phi_f$。对单元 $i$ 的所有面求和，总净通量为 $\\sum_{f \\in \\partial V_i} s_{i,f} \\Phi_f$。这个和被定义为单元 $i$ 的半离散残差 $R_i$。\n\n将离散化的项代回单元 $i$ 的守恒律，得到所需的半离散常微分方程：\n$$ \\frac{d}{dt}\\left(\\rho_i\\, |V_i|\\right) + R_i = 0 $$\n其中 $R_i = \\sum_{f\\in \\partial V_i} s_{i,f}\\, \\Phi_f$。推导至此完成。\n\n**任务B：全局质量守恒的证明**\n\n我们需要证明，对于一个只有不可穿透或周期性边界的计算域，所有单元的半离散残差之和为零，即 $\\sum_i R_i = 0$。\n\n总和为：\n$$ \\sum_{i} R_i = \\sum_{i} \\left( \\sum_{f \\in \\partial V_i} s_{i,f} \\Phi_f \\right) $$\n该表达式对每个单元的面进行求和。我们可以将其重构为对网格中所有唯一面的求和。每个面对这个全局总和的贡献可以根据其类型进行分析。\n\n1.  **内部面**：根据方向的定义，一个内部面 $f$ 由恰好两个单元共享，即“左”单元 $i$ 和“右”单元 $j$。\n    -   它对左单元 $i$ 的残差 $R_i$ 有贡献。对于此贡献，$s_{i,f} = +1$，因此该项为 $+ \\Phi_f$。\n    -   它对右单元 $j$ 的残差 $R_j$ 有贡献。对于此贡献，$s_{j,f} = -1$，因此该项为 $- \\Phi_f$。\n    -   通量 $\\Phi_f$ 被定义为该面的单值。因此，该面 $f$ 对全局总和 $\\sum_k R_k$ 的总贡献是其对 $R_i$ 和 $R_j$ 贡献之和：\n    $$ (+1)\\Phi_f + (-1)\\Phi_f = 0 $$\n    因此，所有内部面的贡献两两抵消，所有内部面对全局总和的净贡献为零。\n\n2.  **边界面**：一个边界面 $f$ 只属于一个单元 $i$。\n    -   **不可穿透边界**：物理条件是法向速度为零，$(\\mathbf{u}_f\\cdot\\mathbf{n}_f) = 0$。这直接导致通量为零：\n    $$ \\Phi_f = \\rho_f (\\mathbf{u}_f\\cdot\\mathbf{n}_f) A_f = 0 $$\n    该面对全局总和的贡献为 $s_{i,f}\\Phi_f = 0$。\n    -   **周期性边界**：一个周期性边界面在概念上与另一个不同单元上的周期性边界面配对，这对面被视为一个连接单元的内部面。也就是说，如果单元 $a$ 上的面 $f_a$ 与单元 $b$ 上的面 $f_b$ 周期性相连，这对面就被视为一个连接单元 $a$ 和 $b$ 的概念性内部面 $f$。一个单元（例如 $a$）被指定为“左”单元，另一个（$b$）为“右”单元。此连接的通量 $\\Phi_f$ 是单值的。就像一个常规内部面一样，对 $R_a$ 的贡献是 $+\\Phi_f$，对 $R_b$ 的贡献是 $-\\Phi_f$。它们的和为 $0$。\n\n由于计算域边界完全是不可穿透或周期性的，所有面要么是内部面，要么是不可穿透面，要么是周期性面。如上所示，每种类型的面对全局总和 $\\sum_i R_i$ 的贡献之和为零。因此，该离散格式是总质量守恒的：\n$$ \\sum_i R_i = 0 $$\n证明至此完成。\n\n**任务C：算法设计与实现**\n\n任务C的程序在数值上验证了任务B中证明的守恒性质。该算法直接实现了为提供的测试用例计算总残差和 $\\sum_i R_i$。\n\n算法的核心如下：\n1.  对于每个测试用例，初始化一个残差数组 $R$，其大小等于单元数，所有元素设置为 $0.0$。\n2.  遍历测试用例网格数据中定义的每个面。每个面被指定为一个元组 $(\\ell, r, A_f, u_{n,f})$，其中 $\\ell$ 是左单元的索引，$r$ 是右单元的索引，$A_f$ 是面面积，$u_{n,f}$ 是法向速度分量。\n3.  对于每个面，计算单值通量 $\\Phi_f = \\rho_f u_{n,f} A_f$。面密度 $\\rho_f$ 根据问题规则计算：\n    -   如果面是内部的（即 $r$ 不是 `None`），则 $\\rho_f = \\frac{1}{2}(\\rho_\\ell + \\rho_r)$，其中 $\\rho_\\ell$ 和 $\\rho_r$ 是左右单元的密度。这也适用于给定的周期性连接，它们被指定为内部面。\n    -   如果面是边界面（即 $r$ 是 `None`），则 $\\rho_f = \\rho_\\ell$。对于给定的不可穿透边界，这个选择无关紧要，因为 $u_{n,f}=0$。\n4.  根据方向更新相邻单元的残差。\n    -   将 $\\Phi_f$ 加到左单元的残差上：$R_\\ell \\leftarrow R_\\ell + \\Phi_f$。\n    -   如果面是内部的，从右单元的残差中减去 $\\Phi_f$：$R_r \\leftarrow R_r - \\Phi_f$。\n5.  处理完所有面后，计算残差数组中所有元素的和 $\\sum_i R_i$。这个和是该测试用例的结果。\n\n根据任务B的证明，所有测试用例都描述了封闭系统（只有内部、不可穿透或作为内部处理的周期性面）。因此，在所有三个测试中，$\\sum_i R_i$ 的解析结果都精确为 $0$。数值实现应得到 $0.0$ 或一个在浮点精度限制内非常接近它的值。测试3中所有速度均为零，提供了一个平凡的检验，因为所有通量 $\\Phi_f$ 必定为零，导致所有残差 $R_i$ 及其总和都恒为零。下面的程序实现了这一逻辑。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by computing the sum of semi-discrete residuals for three test cases.\n    \"\"\"\n\n    # Test cases data structure:\n    # Each test case is a dictionary containing:\n    # 'densities': a list of cell densities [rho_0, rho_1, ...]\n    # 'faces': a list of face tuples (left_cell, right_cell, area, normal_velocity).\n    #          right_cell is None for boundary faces.\n    \n    test_cases_data = [\n        {\n            \"densities\": [1.0, 0.8, 1.3, 0.9, 1.1],\n            \"faces\": [\n                # Interior faces\n                (0, 1, 1.2, 0.7), \n                (1, 2, 0.9, -1.1),\n                (2, 3, 1.5, 0.3),\n                (3, 4, 1.1, -0.5),\n                (4, 0, 1.0, 0.9),\n                (0, 2, 0.8, -0.4),\n                (1, 3, 1.3, 0.2),\n                # Impermeable boundary faces\n                (0, None, 2.0, 0.0),\n                (1, None, 2.1, 0.0),\n                (2, None, 1.9, 0.0),\n                (3, None, 2.2, 0.0),\n                (4, None, 2.0, 0.0)\n            ],\n        },\n        {\n            \"densities\": [1.2, 0.7, 1.0, 0.9],\n            \"faces\": [\n                # Interior faces\n                (0, 1, 1.0, 0.4),\n                (2, 3, 1.0, -0.6),\n                (0, 2, 1.0, 0.5),\n                (1, 3, 1.0, -0.3),\n                # Periodic faces (treated as interior)\n                (0, 1, 0.8, 0.33),\n                (2, 3, 0.8, -0.21),\n                # Impermeable boundary faces\n                (0, None, 0.9, 0.0),\n                (1, None, 0.9, 0.0),\n                (2, None, 0.9, 0.0),\n                (3, None, 0.9, 0.0)\n            ],\n        },\n        {\n            # Test 3 uses Test 1 topology with zero velocities\n            \"densities\": [1.0, 0.8, 1.3, 0.9, 1.1],\n            \"faces\": [\n                (0, 1, 1.2, 0.0), \n                (1, 2, 0.9, 0.0),\n                (2, 3, 1.5, 0.0),\n                (3, 4, 1.1, 0.0),\n                (4, 0, 1.0, 0.0),\n                (0, 2, 0.8, 0.0),\n                (1, 3, 1.3, 0.0),\n                (0, None, 2.0, 0.0),\n                (1, None, 2.1, 0.0),\n                (2, None, 1.9, 0.0),\n                (3, None, 2.2, 0.0),\n                (4, None, 2.0, 0.0)\n            ],\n        },\n    ]\n\n    def compute_total_residual(densities, faces):\n        \"\"\"\n        Computes the sum of semi-discrete residuals for a given mesh configuration.\n        \"\"\"\n        num_cells = len(densities)\n        residuals = np.zeros(num_cells, dtype=np.float64)\n        \n        rho_cells = np.array(densities, dtype=np.float64)\n\n        for face in faces:\n            left_cell, right_cell, area, u_normal = face\n            \n            rho_face = 0.0\n            if right_cell is not None:\n                # Interior or periodic face\n                rho_face = 0.5 * (rho_cells[left_cell] + rho_cells[right_cell])\n            else:\n                # Boundary face\n                rho_face = rho_cells[left_cell]\n\n            # Calculate the single-valued face flux\n            flux = rho_face * u_normal * area\n            \n            # Update residuals for adjacent cells based on orientation\n            # Left cell ('i') has s_if = +1\n            residuals[left_cell] += flux\n            \n            if right_cell is not None:\n                # Right cell ('j') has s_jf = -1\n                residuals[right_cell] -= flux\n        \n        # Return the sum of all residuals, which should be zero for a closed system\n        return np.sum(residuals)\n\n    results = []\n    for case in test_cases_data:\n        total_residual = compute_total_residual(case[\"densities\"], case[\"faces\"])\n        results.append(total_residual)\n\n    # Format and print the final output as a single-line string\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个稳健的数值模拟不仅需要对内部域进行守恒离散，还需要对边界进行物理上精确的表述。最后一项实践聚焦于使用“虚拟单元法”（ghost-cell method）——一种计算流体力学中的常用技术——来实现边界条件。你将推导并实现绝热滑移壁面的反射准则，以确保数值格式在边界上能正确地施加零质量通量、零热通量和零切向应力。这项练习突出了物理边界现象与其数值实现之间的关键联系。",
            "id": "3944112",
            "problem": "考虑一种牛顿可压缩流体，其密度为 $ \\rho $、速度矢量为 $ \\boldsymbol{u} $、温度为 $ T $、热导率为 $ k $、动力黏度为 $ \\mu $，该流体毗邻一个静止的局部平面壁面。设壁面的单位法向矢量为 $ \\boldsymbol{n} $，指向流体域内部。假设流动在平行于壁面的切向方向上是局部均匀的，因此所有空间变化仅发生在法向方向上，并且壁面是绝热的且施加滑移边界条件。为了在有限体积虚拟单元法中评估与边界相容的通量，位于距壁面距离为 $ h $ 的内部单元中心的流体状态，将被跨过壁面反射到另一侧同样距离为 $ h $ 的虚拟单元中心。\n\n您的任务是推导速度和温度的反射条件，以保证以下所有条件在壁面处精确成立：\n- 法向质量通量为零。\n- 法向热通量为零。\n- 切向剪切应力为零。\n\n仅从基本定律和定义出发，推导分解后的法向和切向速度分量以及温度的反射约束条件，这些条件需用相对于壁面法向 $ \\boldsymbol{n} $ 的形式表示。然后，将这些约束条件实现为一个算法，该算法在给定已知距离 $ h $ 处的内部状态和壁面法向 $ \\boldsymbol{n} $ 的条件下，生成虚拟状态，并计算在壁面处评估的以下三个标量值：\n- 法向质量通量 $ j_{m,n} $，单位为 $\\mathrm{kg/(m^2\\cdot s)}$。\n- 法向热通量 $ q_n $，单位为 $\\mathrm{W/m^2}$。\n- 切向剪切应力的大小 $ \\tau_t $，单位为 $\\mathrm{Pa}$。\n\n使用以下对称两点公式，并将壁面置于内部和虚拟单元中心的中间位置：\n- 壁面法向速度 $ u_n^{w} $ 等于内部和虚拟法向速度分量的算术平均值，$ u_n^{w} = \\dfrac{u_n^{i} + u_n^{g}}{2} $。\n- 壁面法向温度梯度等于 $ \\dfrac{T^{g} - T^{i}}{2h} $。\n- 切向速度的壁面法向梯度等于 $ \\dfrac{\\boldsymbol{u}_{t}^{g} - \\boldsymbol{u}_{t}^{i}}{2h} $。\n\n定义矢量分解 $ u_n = \\boldsymbol{u}\\cdot\\boldsymbol{n} $ 和 $ \\boldsymbol{u}_{t} = \\boldsymbol{u} - u_n \\boldsymbol{n} $。您必须根据这些定义和基本定律来表述您的推导过程，并且必须设计算法来计算虚拟状态，然后评估 $ j_{m,n} $、$ q_n $ 和 $ \\tau_t $。\n\n所有输入和输出必须采用国际单位制 (SI)：\n- 速度分量，单位为 $ \\mathrm{m/s} $。\n- 温度，单位为 $ \\mathrm{K} $。\n- 密度，单位为 $ \\mathrm{kg/m^3} $。\n- 热导率，单位为 $ \\mathrm{W/(m\\cdot K)} $。\n- 动力黏度，单位为 $ \\mathrm{Pa\\cdot s} $。\n- 距离 $ h $，单位为 $ \\mathrm{m} $。\n\n测试套件：\n使用该算法处理以下四个测试用例。对于每个用例，根据内部状态构建虚拟状态，然后计算三个壁面量。使用前必须将壁面法向 $ \\boldsymbol{n} $ 单位化。\n\n- 用例 1 (一般斜向入射):\n  - $ \\boldsymbol{n} = (0,\\,1,\\,0) $,\n  - $ \\boldsymbol{u}^{i} = (3,\\,-2,\\,1)\\,\\mathrm{m/s} $,\n  - $ T^{i} = 400\\,\\mathrm{K} $,\n  - $ \\rho^{i} = 1.2\\,\\mathrm{kg/m^3} $,\n  - $ k = 0.026\\,\\mathrm{W/(m\\cdot K)} $,\n  - $ \\mu = 1.8\\times 10^{-5}\\,\\mathrm{Pa\\cdot s} $,\n  - $ h = 0.01\\,\\mathrm{m} $。\n\n- 用例 2 (任意壁面朝向):\n  - $ \\boldsymbol{n} = (1,\\,2,\\,2) $,\n  - $ \\boldsymbol{u}^{i} = (10,\\,0,\\,-5)\\,\\mathrm{m/s} $,\n  - $ T^{i} = 300\\,\\mathrm{K} $,\n  - $ \\rho^{i} = 0.8\\,\\mathrm{kg/m^3} $,\n  - $ k = 0.5\\,\\mathrm{W/(m\\cdot K)} $,\n  - $ \\mu = 0.1\\,\\mathrm{Pa\\cdot s} $,\n  - $ h = 0.005\\,\\mathrm{m} $。\n\n- 用例 3 (极小单元间距):\n  - $ \\boldsymbol{n} = (0,\\,0,\\,1) $,\n  - $ \\boldsymbol{u}^{i} = (0.0,\\,5.0,\\,7.0)\\,\\mathrm{m/s} $,\n  - $ T^{i} = 750\\,\\mathrm{K} $,\n  - $ \\rho^{i} = 20.0\\,\\mathrm{kg/m^3} $,\n  - $ k = 15.0\\,\\mathrm{W/(m\\cdot K)} $,\n  - $ \\mu = 5.0\\,\\mathrm{Pa\\cdot s} $,\n  - $ h = 1.0\\times 10^{-9}\\,\\mathrm{m} $。\n\n- 用例 4 (内部法向速度为零):\n  - $ \\boldsymbol{n} = (0,\\,1,\\,0) $,\n  - $ \\boldsymbol{u}^{i} = (1,\\,0,\\,2)\\,\\mathrm{m/s} $,\n  - $ T^{i} = 500\\,\\mathrm{K} $,\n  - $ \\rho^{i} = 5.0\\,\\mathrm{kg/m^3} $,\n  - $ k = 2.0\\,\\mathrm{W/(m\\cdot K)} $,\n  - $ \\mu = 0.02\\,\\mathrm{Pa\\cdot s} $,\n  - $ h = 0.002\\,\\mathrm{m} $。\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个测试用例的结果本身必须是使用上述公式计算出的三个浮点数 $ [j_{m,n},\\,q_n,\\,\\tau_t] $ 的列表，单位为国际单位制。例如，包含 $ N $ 个用例的输出应如 $ [[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots,[a_N,b_N,c_N]] $ 所示，使用所示的精确方括号和逗号格式。",
            "solution": "经评估，该问题陈述是有效的。它以连续介质力学原理为科学基础，特别是质量、动量和能量守恒定律。该问题是适定的，提供了所有必要的定义、物理量和数值公式，以推导出唯一且有意义的解。问题是客观、完整的，其要求在计算流体动力学中使用的理想化边界条件模型的背景下是物理上合理的。\n\n任务是推导壁面处速度和温度的反射条件，然后实现一个算法来计算壁面通量和应力。壁面是静止、绝热的，并施加滑移条件。\n\n给定的是一个有限体积虚拟单元的背景，其中壁面位于内部单元中心（状态上标为 $i$）和虚拟单元中心（状态上标为 $g$）的中间。单元中心到壁面的距离是 $h$。\n\n设 $\\boldsymbol{n}$ 是从壁面指向流体的单位法向矢量。速度矢量 $\\boldsymbol{u}$被分解为其法向分量 $u_n = \\boldsymbol{u}\\cdot\\boldsymbol{n}$ 和切向分量 $\\boldsymbol{u}_{t} = \\boldsymbol{u} - u_n \\boldsymbol{n}$。\n\n提供了以下用于计算壁面处（上标为 $w$）各物理量的对称两点有限差分公式：\n- 壁面法向速度：$ u_n^{w} = \\dfrac{u_n^{i} + u_n^{g}}{2} $\n- 壁面法向温度梯度：$ \\left(\\dfrac{\\partial T}{\\partial n}\\right)\\bigg|_w = \\dfrac{T^{g} - T^{i}}{2h} $\n- 切向速度的壁面法向梯度：$ \\left(\\dfrac{\\partial \\boldsymbol{u}_{t}}{\\partial n}\\right)\\bigg|_w = \\dfrac{\\boldsymbol{u}_{t}^{g} - \\boldsymbol{u}_{t}^{i}}{2h} $\n\n现在我们根据内部单元状态（$T^i$, $u_n^i$, $\\boldsymbol{u}_t^i$）推导虚拟单元状态变量（$T^g$, $u_n^g$, $\\boldsymbol{u}_t^g$）的反射条件。\n\n**1. 法向质量通量为零**\n壁面处的法向质量通量为 $j_{m,n}^w = \\rho^w u_n^w$。条件是 $j_{m,n}^w = 0$。假设流体在壁面处的密度非零，即 $\\rho^w > 0$，则此条件等效于要求壁面处的法向速度为零：\n$$ u_n^w = 0 $$\n使用为 $u_n^w$ 提供的有限差分公式：\n$$ \\dfrac{u_n^{i} + u_n^{g}}{2} = 0 $$\n求解虚拟单元法向速度分量 $u_n^g$，得到反射条件：\n$$ u_n^{g} = -u_n^{i} $$\n该条件在物理上代表一个不可穿透的壁面。\n\n**2. 法向热通量为零（绝热壁）**\n法向热通量由傅里叶热传导定律给出，$q_n = -k \\frac{\\partial T}{\\partial n}$。绝热壁条件要求壁面上的热通量为零：\n$$ q_n^w = -k^w \\left(\\dfrac{\\partial T}{\\partial n}\\right)\\bigg|_w = 0 $$\n假设壁面处的热导率 $k^w$ 非零，这意味着壁面处的法向温度梯度必须为零：\n$$ \\left(\\dfrac{\\partial T}{\\partial n}\\right)\\bigg|_w = 0 $$\n使用为梯度提供的有限差分公式：\n$$ \\dfrac{T^{g} - T^{i}}{2h} = 0 $$\n这给出了温度的反射条件：\n$$ T^{g} = T^{i} $$\n这是一个关于温度的齐次诺伊曼边界条件。\n\n**3. 切向剪切应力为零（滑移壁）**\n对于仅在法向有变化的牛顿流体，壁面处的切向剪切应力矢量由 $\\boldsymbol{\\tau}_{t}^w = \\mu^w \\left(\\dfrac{\\partial \\boldsymbol{u}_t}{\\partial n}\\right)\\bigg|_w$ 给出。滑移壁条件要求该应力为零：\n$$ \\boldsymbol{\\tau}_{t}^w = \\boldsymbol{0} $$\n假设壁面处的动力黏度 $\\mu^w > 0$ 非零，这意味着壁面处切向速度的法向梯度必须为零：\n$$ \\left(\\dfrac{\\partial \\boldsymbol{u}_t}{\\partial n}\\right)\\bigg|_w = \\boldsymbol{0} $$\n使用为此梯度提供的有限差分公式：\n$$ \\dfrac{\\boldsymbol{u}_{t}^{g} - \\boldsymbol{u}_{t}^{i}}{2h} = \\boldsymbol{0} $$\n这给出了切向速度矢量的反射条件：\n$$ \\boldsymbol{u}_{t}^{g} = \\boldsymbol{u}_{t}^{i} $$\n这是一个自由滑移条件。\n\n**反射规则和虚拟状态构建总结**\n推导出的反射规则如下：\n- 温度：$T^g = T^i$\n- 法向速度：$u_n^g = -u_n^i$\n- 切向速度：$\\boldsymbol{u}_t^g = \\boldsymbol{u}_t^i$\n对于一个完整的状态，我们还需要密度。对于虚拟单元，一个常见的非耗散选择是反射密度：$\\rho^g = \\rho^i$。\n\n虚拟速度矢量 $\\boldsymbol{u}^g$ 可以从其分量重构：\n$$ \\boldsymbol{u}^g = \\boldsymbol{u}_t^g + u_n^g \\boldsymbol{n} = \\boldsymbol{u}_t^i - u_n^i \\boldsymbol{n} $$\n代入 $\\boldsymbol{u}_t^i = \\boldsymbol{u}^i - u_n^i \\boldsymbol{n}$：\n$$ \\boldsymbol{u}^g = (\\boldsymbol{u}^i - u_n^i \\boldsymbol{n}) - u_n^i \\boldsymbol{n} = \\boldsymbol{u}^i - 2u_n^i \\boldsymbol{n} = \\boldsymbol{u}^i - 2(\\boldsymbol{u}^i \\cdot \\boldsymbol{n})\\boldsymbol{n} $$\n\n**计算算法**\n要实现的算法如下：\n1. 对于给定的测试用例，接收内部状态 $(\\boldsymbol{u}^i, T^i, \\rho^i)$、流体属性 $(k, \\mu)$ 和几何参数 $(\\boldsymbol{n}, h)$。\n2. 将壁面法向矢量单位化：$\\boldsymbol{n} \\leftarrow \\boldsymbol{n} / ||\\boldsymbol{n}||$。\n3. 将内部速度 $\\boldsymbol{u}^i$ 分解为法向和切向分量：$u_n^i = \\boldsymbol{u}^i \\cdot \\boldsymbol{n}$ 和 $\\boldsymbol{u}_t^i = \\boldsymbol{u}^i - u_n^i \\boldsymbol{n}$。\n4. 使用推导出的反射规则确定虚拟状态变量：$T^g = T^i$、$u_n^g = -u_n^i$ 和 $\\boldsymbol{u}_t^g = \\boldsymbol{u}_t^i$。我们也可以设置 $\\rho^g = \\rho^i$。\n5. 使用给定的数值公式和流体属性计算所要求的三个壁面标量值。\n    - **法向质量通量 $j_{m,n}$**：\n      设 $\\rho^w = (\\rho^i + \\rho^g)/2 = \\rho^i$。\n      $u_n^w = (u_n^i + u_n^g)/2 = (u_n^i - u_n^i)/2 = 0$。\n      $j_{m,n} = \\rho^w u_n^w = \\rho^i \\times 0 = 0$。\n    - **法向热通量 $q_n$**：\n      设 $k^w = k$。\n      $q_n = -k^w \\left(\\frac{T^g - T^i}{2h}\\right) = -k \\left(\\frac{T^i - T^i}{2h}\\right) = 0$。\n    - **切向剪切应力的大小 $\\tau_t$**：\n      设 $\\mu^w = \\mu$。应力矢量为 $\\boldsymbol{\\tau}_t^w = \\mu^w \\left(\\frac{\\boldsymbol{u}_t^g - \\boldsymbol{u}_t^i}{2h}\\right) = \\mu \\left(\\frac{\\boldsymbol{u}_t^i - \\boldsymbol{u}_t^i}{2h}\\right) = \\boldsymbol{0}$。\n      其大小为 $\\tau_t = ||\\boldsymbol{\\tau}_t^w|| = 0$。\n\n该推导证实了，如果根据这些规则构建虚拟单元状态，那么壁面处的质量通量、热通量和切向应力的数值计算结果将精确为零，从而在离散有限差分框架内满足物理边界条件。该实现将显式执行这些计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of deriving and applying ghost-cell reflection conditions\n    for an adiabatic, slip wall in a compressible Newtonian fluid.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general oblique incidence)\n        {\n            \"n\": (0.0, 1.0, 0.0), \"u_i\": (3.0, -2.0, 1.0), \"T_i\": 400.0,\n            \"rho_i\": 1.2, \"k\": 0.026, \"mu\": 1.8e-5, \"h\": 0.01\n        },\n        # Case 2 (arbitrary wall orientation)\n        {\n            \"n\": (1.0, 2.0, 2.0), \"u_i\": (10.0, 0.0, -5.0), \"T_i\": 300.0,\n            \"rho_i\": 0.8, \"k\": 0.5, \"mu\": 0.1, \"h\": 0.005\n        },\n        # Case 3 (very small cell spacing)\n        {\n            \"n\": (0.0, 0.0, 1.0), \"u_i\": (0.0, 5.0, 7.0), \"T_i\": 750.0,\n            \"rho_i\": 20.0, \"k\": 15.0, \"mu\": 5.0, \"h\": 1.0e-9\n        },\n        # Case 4 (zero interior normal velocity)\n        {\n            \"n\": (0.0, 1.0, 0.0), \"u_i\": (1.0, 0.0, 2.0), \"T_i\": 500.0,\n            \"rho_i\": 5.0, \"k\": 2.0, \"mu\": 0.02, \"h\": 0.002\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract interior state and parameters\n        n_unnormalized = np.array(case[\"n\"], dtype=float)\n        u_i = np.array(case[\"u_i\"], dtype=float)\n        T_i = float(case[\"T_i\"])\n        rho_i = float(case[\"rho_i\"])\n        k = float(case[\"k\"])\n        mu = float(case[\"mu\"])\n        h = float(case[\"h\"])\n        \n        # --- Step 1: Normalize the wall normal vector ---\n        n = n_unnormalized / np.linalg.norm(n_unnormalized)\n\n        # --- Step 2: Decompose interior velocity ---\n        # Normal component of interior velocity\n        u_n_i = np.dot(u_i, n)\n        # Tangential component of interior velocity\n        u_t_i = u_i - u_n_i * n\n\n        # --- Step 3: Determine ghost state variables from reflection rules ---\n        # Ghost temperature for adiabatic wall (zero gradient)\n        T_g = T_i\n        # Ghost normal velocity for impermeable wall (zero normal velocity)\n        u_n_g = -u_n_i\n        # Ghost tangential velocity for slip wall (zero tangential stress)\n        u_t_g = u_t_i\n        # Ghost density is typically reflected\n        rho_g = rho_i\n\n        # --- Step 4: Compute wall quantities using the provided formulas ---\n        \n        # Normal mass flux (j_m,n)\n        # Wall density is the average of interior and ghost cell densities\n        rho_w = (rho_i + rho_g) / 2.0\n        # Wall normal velocity from the symmetric formula\n        u_n_w = (u_n_i + u_n_g) / 2.0\n        j_mn_w = rho_w * u_n_w\n\n        # Normal heat flux (q_n)\n        # Wall thermal conductivity is assumed to be the given value k\n        # Wall-normal temperature gradient from the symmetric formula\n        dT_dn_w = (T_g - T_i) / (2.0 * h)\n        q_n_w = -k * dT_dn_w\n        \n        # Magnitude of tangential shear stress (tau_t)\n        # Wall viscosity is assumed to be the given value mu\n        # Wall-normal gradient of tangential velocity from the symmetric formula\n        du_tdn_w_vec = (u_t_g - u_t_i) / (2.0 * h)\n        # Tangential stress vector at the wall\n        tau_t_vec_w = mu * du_tdn_w_vec\n        # Magnitude of the tangential stress vector\n        tau_t_w = np.linalg.norm(tau_t_vec_w)\n        \n        results.append([j_mn_w, q_n_w, tau_t_w])\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) is used to correctly format the list of lists.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}