{
    "hands_on_practices": [
        {
            "introduction": "在分析瞬态传热问题之前，一个关键的初始步骤是确定合适的模型复杂度。本练习将引导您从第一性原理出发，推导毕渥数($Bi$)，并以此为依据判断是否可以使用简化的集总电容模型，还是必须采用更详细的空间分辨模型。理解这一区别对于高效、准确地进行热建模至关重要。",
            "id": "3987069",
            "problem": "一块半厚度为 $L_c$ 的均质平板初始温度均匀为 $T_i$。在时间 $t=0$ 时，其两个表面突然暴露于温度为 $T_{\\infty}$、对流换热系数为常数 $h$ 的流体中。该平板的导热系数为 $k$。你需要从第一性原理出发，判断其瞬态热响应应被建模为空间均匀的集总电容系统，还是需要空间分辨的温度场，并估算在瞬态开始时（$t \\to 0^{+}$）表面处的预期内部温度梯度大小。请使用能量守恒和本构定律，不依赖问题陈述中给出的简化准则。\n\n定义分类指标 $S$：如果集总电容模型适用，则 $S=1$；如果需要空间分辨模型，则 $S=0$。将 $t \\to 0^{+}$ 时的表面法向温度梯度大小报告为 $|\\partial T / \\partial x|_{x=L_c, t \\to 0^{+}}$。\n\n使用以下数值：$k = 25\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$，$h = 220\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$L_c = 0.020\\,\\mathrm{m}$，$T_i = 80\\,^{\\circ}\\mathrm{C}$，$T_{\\infty} = 20\\,^{\\circ}\\mathrm{C}$。\n\n将最终数值结果四舍五入至四位有效数字。内部温度梯度大小以 $\\mathrm{K\\,m^{-1}}$ 为单位表示。最终答案必须以行矩阵 $\\begin{pmatrix}S & |\\partial T / \\partial x|_{x=L_c, t \\to 0^{+}}\\end{pmatrix}$ 的形式给出，矩阵内不包含单位。",
            "solution": "该问题将分两部分解决：首先，确定合适的热模型（集总电容模型与空间分辨模型）；其次，计算瞬态过程开始时的表面温度梯度。\n\n我们建立一个坐标系，原点 $x=0$ 位于平板中心，因此平板占据区域 $-L_c \\le x \\le L_c$。该平板是均质的，导热系数为 $k$，初始温度均匀为 $T(x, 0) = T_i$。在时间 $t=0$ 时，位于 $x = \\pm L_c$ 的表面暴露于温度为 $T_{\\infty}$、对流换热系数为 $h$ 的流体中。由于对称性，我们只需要分析区域 $0 \\le x \\le L_c$。\n\n**第一部分：确定合适的热模型**\n\n选择集总电容模型还是空间分辨模型，取决于内部（导热）传热热阻和外部（对流）传热热阻的相对大小。\n\n如果固体内部的温度在任何给定时间都近似均匀，即 $T(x, t) \\approx T(t)$，则集总电容模型有效。这意味着平板内部的温差与平板表面和周围流体之间的温差相比可以忽略不计。\n\n让我们从第一性原理出发将其形式化。从平板中心流向环境流体的热通量 $q''$ 必须克服两个串联的热阻：平板的内部导热热阻和表面的外部对流热阻。\n\n在半厚度 $L_c$ 上，单位面积的特征导热热阻 $R''_{\\text{cond}}$ 为：\n$$ R''_{\\text{cond}} = \\frac{L_c}{k} $$\n\n在表面上，单位面积的对流换热热阻 $R''_{\\text{conv}}$ 为：\n$$ R''_{\\text{conv}} = \\frac{1}{h} $$\n\n平板内部的温降（从中心到表面）$\\Delta T_{\\text{int}}$ 和流体边界层上的温降（从表面到环境）$\\Delta T_{\\text{ext}}$ 与热通量 $q''$ 通过这些热阻相关联：\n$$ \\Delta T_{\\text{int}} = q'' \\cdot R''_{\\text{cond}} = q'' \\frac{L_c}{k} $$\n$$ \\Delta T_{\\text{ext}} = q'' \\cdot R''_{\\text{conv}} = q'' \\frac{1}{h} $$\n\n当内部温降远小于外部温降时，即 $\\Delta T_{\\text{int}} \\ll \\Delta T_{\\text{ext}}$，集总电容假设成立。这些温降的比值提供了一个定量准则：\n$$ \\frac{\\Delta T_{\\text{int}}}{\\Delta T_{\\text{ext}}} = \\frac{q'' (L_c/k)}{q'' (1/h)} = \\frac{h L_c}{k} $$\n\n这个无量纲比值被称为 Biot 数，$Bi$。\n$$ Bi = \\frac{h L_c}{k} $$\n它表示内部导热热阻与外部对流热阻的比值。要使集总电容近似适用，该比值必须很小，通常为 $Bi \\ll 1$。一个广泛使用的工程阈值是 $Bi  0.1$。\n\n我们现在使用给定的数值计算 Biot 数：$h = 220\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$L_c = 0.020\\,\\mathrm{m}$，$k = 25\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$。\n$$ Bi = \\frac{(220\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}) \\cdot (0.020\\,\\mathrm{m})}{25\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}} = \\frac{4.4}{25} = 0.176 $$\n由于 $Bi = 0.176$，大于阈值 $0.1$，因此内部导热热阻与外部对流热阻相比不可忽略。平板内部的温度梯度将是显著的，空间均匀温度的假设不成立。因此，需要一个空间分辨模型。\n\n根据问题定义，这对应于分类指标 $S=0$。\n\n**第二部分：$t \\to 0^{+}$ 时的表面温度梯度**\n\n瞬态传热过程由一维热传导方程控制。在表面 $x=L_c$ 处，对于所有 $t > 0$，必须保持能量平衡。从内部传导到表面的热量速率必须等于从表面对流到流体的热量速率。这由对流边界条件表示：\n$$ -k \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=L_c} = h [T(L_c, t) - T_{\\infty}] $$\n我们关心的是在瞬态刚刚开始时的系统状态，即当 $t \\to 0^{+}$ 时。在任何具有有限热扩散系数的物理介质中，在任何给定的空间点，温度都是时间的连续函数。因此，平板内部任何一点（包括表面）的温度都不能瞬时改变。在紧随 $t=0$ 的时刻，表面温度还没有时间偏离其初始值。\n因此，我们有：\n$$ T(L_c, t \\to 0^{+}) = T(L_c, 0) = T_i $$\n将此代入 $t \\to 0^{+}$ 极限下的边界条件方程：\n$$ -k \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=L_c, \\, t \\to 0^{+}} = h [T(L_c, t \\to 0^{+}) - T_{\\infty}] = h [T_i - T_{\\infty}] $$\n求解 $t \\to 0^{+}$ 时表面的温度梯度：\n$$ \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=L_c, \\, t \\to 0^{+}} = -\\frac{h}{k} (T_i - T_{\\infty}) $$\n问题要求的是该梯度的大小：\n$$ \\left| \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=L_c, \\, t \\to 0^{+}} \\right| = \\left| -\\frac{h}{k} (T_i - T_{\\infty}) \\right| = \\frac{h}{k} |T_i - T_{\\infty}| $$\n使用给定的数值：$h = 220\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$k = 25\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$，$T_i = 80\\,^{\\circ}\\mathrm{C}$，$T_{\\infty} = 20\\,^{\\circ}\\mathrm{C}$。温差为 $T_i - T_{\\infty} = (80 - 20)\\,\\mathrm{K} = 60\\,\\mathrm{K}$。\n$$ \\left| \\left. \\frac{\\partial T}{\\partial x} \\right|_{x=L_c, \\, t \\to 0^{+}} \\right| = \\frac{220\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}}{25\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}} (60\\,\\mathrm{K}) = 8.8 \\cdot 60\\,\\mathrm{K\\,m^{-1}} = 528\\,\\mathrm{K\\,m^{-1}} $$\n四舍五入到四位有效数字，梯度的大小为 $528.0\\,\\mathrm{K\\,m^{-1}}$。\n\n**结果总结**\n1. 分类指标：$S = 0$（需要空间分辨模型）。\n2. $t \\to 0^{+}$ 时的表面温度梯度大小：$|\\partial T / \\partial x|_{x=L_c, t \\to 0^{+}} = 528.0\\,\\mathrm{K\\,m^{-1}}$。\n最终答案按要求以行矩阵的形式呈现。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0  528.0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "当我们确定空间温度梯度非常重要后，接下来的问题是这些梯度如何随时间演变并最终衰减。本练习将深入探讨瞬态热传导方程的解析解，通过分离变量法揭示系统如何趋近其最终的稳态。通过计算第一个特征值，您将能更深刻地理解控制这一转变过程的物理时间尺度，并学会估算瞬态效应变得可以忽略不计所需的时间。",
            "id": "3987107",
            "problem": "一根长度为 $L = 0.10$ $\\mathrm{m}$ 的均匀细铜棒，其热导率恒为 $k = 400$ $\\mathrm{W\\,m^{-1}\\,K^{-1}}$，质量密度为 $\\rho = 8960$ $\\mathrm{kg\\,m^{-3}}$，比热容为 $c = 385$ $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。其侧面绝热，因此热传导是沿 $x$ 轴的一维过程。对于 $t \\ge 0$，杆的两端保持在固定温度，\n$$\nT(0,t) = 350\\ \\mathrm{K}, \\qquad T(L,t) = 300\\ \\mathrm{K}.\n$$\n杆内没有热源生成。初始温度为\n$$\nT(x,0) = T_{s}(x) + A \\sin\\!\\left(\\frac{\\pi x}{L}\\right),\n$$\n其中 $T_{s}(x)$ 是稳态温度分布，$A$ 是一个单位为开尔文的非零振幅。\n\n从局部能量守恒和傅里叶热传导定律出发，推导 $T(x,t)$ 的控制偏微分方程 (PDE)以及稳态 $T_{s}(x)$ 对应的边值问题。引入偏差场 $\\theta(x,t) = T(x,t) - T_{s}(x)$，并建立相应的齐次初边值问题。通过对偏差场应用分离变量法，推导由 Dirichlet–Dirichlet 边界条件所对应的空间 Sturm–Liouville 特征值问题，并计算第一个特征值。使用这个首个特征值和热扩散系数 $\\alpha = k/(\\rho c)$，求出时间 $t_{0.01}$ 的主阶估计值，在该时刻，杆上偏离稳态的最大绝对偏差处于其初始最大值的 1% 以内，即满足\n$$\n\\frac{\\|\\theta(\\cdot,t)\\|_{\\infty}}{\\|\\theta(\\cdot,0)\\|_{\\infty}} \\le 0.01,\n$$\n的最小时间 $t$，此估计仅使用衰减最慢的模态进行近似。将最终的时间估计值以秒为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n-   **杆的属性**:\n    -   长度：$L = 0.10$ $\\mathrm{m}$\n    -   材料：铜\n    -   热导率：$k = 400$ $\\mathrm{W\\,m^{-1}\\,K^{-1}}$ (恒定)\n    -   质量密度：$\\rho = 8960$ $\\mathrm{kg\\,m^{-3}}$\n    -   比热容：$c = 385$ $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n-   **问题几何形状和条件**:\n    -   均匀细杆。\n    -   侧面绝热（热传导是一维的）。\n    -   无内部热源。\n-   **$t \\ge 0$ 的边界条件 (BCs)**:\n    -   $T(0,t) = 350$ $\\mathrm{K}$\n    -   $T(L,t) = 300$ $\\mathrm{K}$\n-   **$t=0$ 时的初始条件 (IC)**:\n    -   $T(x,0) = T_{s}(x) + A \\sin\\!\\left(\\frac{\\pi x}{L}\\right)$\n    -   $T_{s}(x)$ 是稳态温度分布。\n    -   $A$ 是一个单位为开尔文的非零振幅。\n-   **任务**:\n    1.  推导 $T(x,t)$ 的控制偏微分方程 (PDE)。\n    2.  推导稳态 $T_{s}(x)$ 的边值问题。\n    3.  为偏差场 $\\theta(x,t) = T(x,t) - T_{s}(x)$ 建立齐次初边值问题。\n    4.  推导空间 Sturm–Liouville 特征值问题并计算第一个特征值。\n    5.  定义热扩散系数 $\\alpha = k/(\\rho c)$。\n    6.  仅使用衰减最慢的模态，估计最大绝对偏差达到其初始最大值 1% 以内的时间 $t_{0.01}$，即 $\\|\\theta(\\cdot,t)\\|_{\\infty} / \\|\\theta(\\cdot,0)\\|_{\\infty} \\le 0.01$。\n    7.  将最终时间四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n这是一个典型的一维瞬态热传导练习题。\n-   **科学依据**：该问题基于热传导的基本原理，即局部能量守恒和傅里叶热传导定律。所提供的铜的材料属性是标准且符合实际的。设置在物理上是合理的。\n-   **良态性**：问题指定了一个 PDE（将从第一性原理推导）、边界条件（Dirichlet 类型）和一个初始条件。这构成了一个良态的初边值问题，预计其具有唯一且稳定的解。\n-   **客观性**：问题以精确、客观和数学化的语言陈述。没有主观或模棱两可的术语。\n\n### 步骤3：结论与行动\n问题有效。将提供完整的解答。\n\n### 解题推导\n\n**1. $T(x,t)$ 的控制偏微分方程**\n对于长度为 $\\Delta x$、横截面积为 $A_{c}$ 的一维杆单元，局部能量守恒原理指出，内能的变化率等于净传入该单元的热传导速率。此处没有内部热源生成。\n体积 $A_{c}\\Delta x$ 内内能的变化率为：\n$$\n\\frac{\\partial}{\\partial t} \\int_{x}^{x+\\Delta x} \\rho c T(x',t) A_{c} dx' = \\int_{x}^{x+\\Delta x} \\rho c \\frac{\\partial T}{\\partial t} A_{c} dx'\n$$\n热传导速率由傅里叶定律给出，$q(x,t) = -k A_{c} \\frac{\\partial T}{\\partial x}$。净传入该单元的热传导速率为 $q(x,t) - q(x+\\Delta x,t)$。\n令两者相等得到：\n$$\n\\int_{x}^{x+\\Delta x} \\rho c A_{c} \\frac{\\partial T}{\\partial t} dx' = -k A_{c} \\frac{\\partial T}{\\partial x}\\bigg|_{x} - \\left(-k A_{c} \\frac{\\partial T}{\\partial x}\\bigg|_{x+\\Delta x}\\right)\n$$\n两边同除以 $A_{c}\\Delta x$ 并取 $\\Delta x \\to 0$ 的极限：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = \\lim_{\\Delta x \\to 0} \\frac{k\\frac{\\partial T}{\\partial x}\\big|_{x+\\Delta x} - k\\frac{\\partial T}{\\partial x}\\big|_{x}}{\\Delta x} = \\frac{\\partial}{\\partial x}\\left(k \\frac{\\partial T}{\\partial x}\\right)\n$$\n由于热导率 $k$ 是常数，控制偏微分方程为：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2} \\implies \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $\\alpha = k/(\\rho c)$ 是热扩散系数。\n\n**2. $T_s(x)$ 的稳态问题**\n在稳态下，温度不随时间变化，因此 $\\frac{\\partial T}{\\partial t} = 0$。偏微分方程简化为关于稳态温度分布 $T_s(x)$ 的常微分方程 (ODE)：\n$$\n\\frac{d^2 T_s}{dx^2} = 0\n$$\n边界条件不随时间变化：$T_s(0) = 350$ 和 $T_s(L) = 300$。\n对 ODE 积分两次得到线性分布：$T_s(x) = C_1 x + C_2$。\n应用边界条件：\n- $T_s(0) = C_2 = 350$。\n- $T_s(L) = C_1 L + 350 = 300 \\implies C_1 L = -50 \\implies C_1 = -\\frac{50}{L}$。\n因此，稳态温度分布为：\n$$\nT_s(x) = 350 - \\frac{50}{L}x\n$$\n\n**3. 偏差场 $\\theta(x,t)$ 的齐次问题**\n我们定义偏差场 $\\theta(x,t) = T(x,t) - T_s(x)$。根据线性偏微分方程的叠加原理，我们可以为 $\\theta(x,t)$ 建立一个问题。\n将 $T(x,t) = \\theta(x,t) + T_s(x)$ 代入热传导方程：\n$$\n\\frac{\\partial}{\\partial t}(\\theta + T_s) = \\alpha \\frac{\\partial^2}{\\partial x^2}(\\theta + T_s) \\implies \\frac{\\partial\\theta}{\\partial t} + \\frac{\\partial T_s}{\\partial t} = \\alpha \\frac{\\partial^2\\theta}{\\partial x^2} + \\alpha \\frac{\\partial^2 T_s}{\\partial x^2}\n$$\n因为 $T_s(x)$ 是稳态解，所以 $\\frac{\\partial T_s}{\\partial t} = 0$ 且 $\\frac{\\partial^2 T_s}{\\partial x^2} = 0$。因此，$\\theta$ 的偏微分方程是齐次的：\n$$\n\\frac{\\partial\\theta}{\\partial t} = \\alpha \\frac{\\partial^2\\theta}{\\partial x^2}\n$$\n$\\theta$ 的边界条件变为齐次的（Dirichlet 类型）：\n- $\\theta(0,t) = T(0,t) - T_s(0) = 350 - 350 = 0$。\n- $\\theta(L,t) = T(L,t) - T_s(L) = 300 - \\left(350 - \\frac{50}{L}L\\right) = 300 - 300 = 0$。\n$\\theta$ 的初始条件为：\n- $\\theta(x,0) = T(x,0) - T_s(x) = \\left(T_s(x) + A \\sin\\left(\\frac{\\pi x}{L}\\right)\\right) - T_s(x) = A \\sin\\left(\\frac{\\pi x}{L}\\right)$。\n\n**4. Sturm-Liouville 特征值问题**\n我们使用分离变量法求解 $\\theta(x,t)$ 的齐次偏微分方程。设 $\\theta(x,t) = X(x)\\mathcal{T}(t)$。将其代入偏微分方程得到：\n$$\nX(x)\\frac{d\\mathcal{T}}{dt} = \\alpha \\frac{d^2X}{dx^2}\\mathcal{T}(t) \\implies \\frac{1}{\\alpha \\mathcal{T}}\\frac{d\\mathcal{T}}{dt} = \\frac{1}{X}\\frac{d^2X}{dx^2} = -\\lambda\n$$\n其中 $-\\lambda$ 是分离常数。这产生了一个时间常微分方程和一个空间常微分方程。\n空间部分与齐次边界条件 $X(0)=0$ 和 $X(L)=0$ 构成一个 Sturm-Liouville 问题：\n$$\n\\frac{d^2X}{dx^2} + \\lambda X = 0, \\quad X(0)=0, \\quad X(L)=0\n$$\n对于 $\\lambda > 0$，通解为 $X(x) = C_1 \\cos(\\sqrt{\\lambda} x) + C_2 \\sin(\\sqrt{\\lambda} x)$。\n- $X(0) = C_1 = 0$。\n- $X(L) = C_2 \\sin(\\sqrt{\\lambda} L) = 0$。为得到非平凡解（$C_2 \\neq 0$），必须有 $\\sin(\\sqrt{\\lambda} L) = 0$。\n当 $\\sqrt{\\lambda}L = n\\pi$（整数 $n=1, 2, 3, \\ldots$）时，此条件成立。\n特征值为 $\\lambda_n = \\left(\\frac{n\\pi}{L}\\right)^2$，对应的特征函数为 $X_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$。\n对应于 $n=1$ 的第一个特征值为：\n$$\n\\lambda_1 = \\left(\\frac{\\pi}{L}\\right)^2\n$$\n\n**5. 衰减时间估计**\n时间部分的解为 $\\frac{d\\mathcal{T}_n}{dt} = -\\lambda_n \\alpha \\mathcal{T}_n$，得到 $\\mathcal{T}_n(t) = \\exp(-\\lambda_n \\alpha t)$。\n$\\theta(x,t)$ 的通解是各模态的叠加：\n$$\n\\theta(x,t) = \\sum_{n=1}^{\\infty} B_n \\exp(-\\lambda_n \\alpha t) \\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\n我们从初始条件中求出系数 $B_n$：\n$$\n\\theta(x,0) = \\sum_{n=1}^{\\infty} B_n \\sin\\left(\\frac{n\\pi x}{L}\\right) = A \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n通过观察可知，初始条件纯粹是第一模态（$n=1$）。因此，$B_1 = A$ 且对于所有 $n > 1$，$B_n=0$。偏差的解恰好是衰减最慢的模态：\n$$\n\\theta(x,t) = A \\exp(-\\lambda_1 \\alpha t) \\sin\\left(\\frac{\\pi x}{L}\\right) = A \\exp\\left(-\\left(\\frac{\\pi}{L}\\right)^2 \\alpha t\\right) \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n在任意时刻 $t$ 的最大绝对偏差是 $L^{\\infty}$-范数，即 $\\|\\theta(\\cdot,t)\\|_{\\infty}$，它出现在 $|\\sin(\\pi x/L)|=1$ 的地方：\n$$\n\\|\\theta(\\cdot,t)\\|_{\\infty} = \\max_{x \\in [0,L]} |\\theta(x,t)| = |A| \\exp\\left(-\\left(\\frac{\\pi}{L}\\right)^2 \\alpha t\\right)\n$$\n在 $t=0$ 时的初始最大绝对偏差是 $\\|\\theta(\\cdot,0)\\|_{\\infty} = |A|$。\n我们需要找到时间 $t_{0.01}$，使得这些最大值的比率小于或等于 0.01：\n$$\n\\frac{\\|\\theta(\\cdot,t_{0.01})\\|_{\\infty}}{\\|\\theta(\\cdot,0)\\|_{\\infty}} = \\frac{|A| \\exp\\left(-\\left(\\frac{\\pi}{L}\\right)^2 \\alpha t_{0.01}\\right)}{|A|} = \\exp\\left(-\\left(\\frac{\\pi}{L}\\right)^2 \\alpha t_{0.01}\\right) \\le 0.01\n$$\n求解最小时间 $t_{0.01}$ 得到等式：\n$$\n-\\left(\\frac{\\pi}{L}\\right)^2 \\alpha t_{0.01} = \\ln(0.01) = -\\ln(100)\n$$\n$$\nt_{0.01} = \\frac{L^2 \\ln(100)}{\\pi^2 \\alpha}\n$$\n\n**6. 数值计算**\n首先，我们计算热扩散系数 $\\alpha$：\n$$\n\\alpha = \\frac{k}{\\rho c} = \\frac{400\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}}{8960\\,\\mathrm{kg\\,m^{-3}} \\times 385\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}} = \\frac{400}{3449600}\\,\\mathrm{m^2\\,s^{-1}} \\approx 1.15955 \\times 10^{-4}\\,\\mathrm{m^2\\,s^{-1}}\n$$\n现在，将这些值代入 $t_{0.01}$ 的表达式中：\n$$\nL = 0.10\\,\\mathrm{m}\n$$\n$$\nt_{0.01} = \\frac{(0.10)^2 \\ln(100)}{\\pi^2 \\left(\\frac{400}{3449600}\\right)} = \\frac{0.01 \\times \\ln(100) \\times 3449600}{400 \\pi^2}\n$$\n$$\nt_{0.01} = \\frac{34496 \\ln(100)}{400 \\pi^2} = \\frac{86.24 \\ln(100)}{\\pi^2}\n$$\n使用 $\\ln(100) \\approx 4.605170$ 和 $\\pi^2 \\approx 9.869604$：\n$$\nt_{0.01} \\approx \\frac{86.24 \\times 4.605170}{9.869604} \\approx \\frac{397.161}{9.869604} \\approx 40.24096\\,\\mathrm{s}\n$$\n四舍五入到四位有效数字，估计时间为 $40.24$ $\\mathrm{s}$。",
            "answer": "$$\\boxed{40.24}$$"
        },
        {
            "introduction": "在计算实践中，我们常常通过模拟瞬态过程直至系统稳定来获得稳态解。这个动手编程练习旨在阐明该方法的关键细微之处，要求您区分空间离散化误差和残余瞬态误差。前者决定了最终稳态解本身的精度上限，而后者则源于在有限时间内停止模拟；掌握这一概念对于确保通过瞬态数值求解器获得的稳态结果的有效性和准确性至关重要。",
            "id": "3987067",
            "problem": "考虑一根长度为 $L$ 的均匀杆中的一维热传导，其具有狄利克雷边界条件和内部体积源，该过程受能量守恒和傅里叶定律支配。能量守恒意味着内能的变化率等于热通量的散度加上体积加热。傅里叶定律指出，热通量与负温度梯度成正比。将这两者结合，得到瞬态热方程\n$$\n\\frac{\\partial T(x,t)}{\\partial t} = \\alpha \\frac{\\partial^2 T(x,t)}{\\partial x^2} + s(x),\n$$\n其中 $T(x,t)$ 是温度，$\\alpha = \\frac{k}{\\rho c}$ 是热扩散率，$k$ 是热导率，$\\rho$ 是密度，$c$ 是比热容，$s(x)$ 是一个源项，其单位为温度/时间。施加狄利克雷边界条件 $T(0,t)=0$ 和 $T(L,t)=0$ 以及初始条件 $T(x,0)=0$（对于 $x \\in (0,L)$）。\n\n为便于对稳态进行解析验证，考虑源项\n$$\ns(x) = \\alpha S_0 \\sin\\left(\\frac{\\pi x}{L}\\right),\n$$\n其中 $S_0$ 是一个常数，其单位为温度/长度的平方。稳态解 $T_s(x)$ 满足\n$$\n\\alpha \\frac{\\partial^2 T_s(x)}{\\partial x^2} + s(x) = 0, \\quad T_s(0)=0, \\quad T_s(L)=0,\n$$\n其精确解为\n$$\nT_s(x) = S_0 \\frac{L^2}{\\pi^2} \\sin\\left(\\frac{\\pi x}{L}\\right).\n$$\n\n通过 $N$ 个内部网格点将空间域离散化，网格点间距均匀，为 $h = \\frac{L}{N+1}$，并使用二阶中心有限差分算子来近似二阶导数。设 $\\mathbf{T}(t) \\in \\mathbb{R}^N$ 为内部节点温度向量，$\\mathbf{s} \\in \\mathbb{R}^N$ 为在内部网格点上计算的源项值向量。半离散的线方法公式为\n$$\n\\frac{d \\mathbf{T}(t)}{dt} = \\mathbf{A}\\,\\mathbf{T}(t) + \\mathbf{s},\n$$\n其中 $\\mathbf{A} = \\alpha \\mathbf{D}$，$\\mathbf{D}$ 是一个三对角矩阵，其元素为\n$$\n\\mathbf{D}_{ii} = -\\frac{2}{h^2}, \\quad \\mathbf{D}_{i,i+1} = \\mathbf{D}_{i,i-1} = \\frac{1}{h^2}\n$$\n对于 $i=1,\\dots,N$，具有相应的非对角线元素，其他位置为零。离散稳态解 $\\mathbf{T}_d$ 满足\n$$\n\\mathbf{A}\\,\\mathbf{T}_d + \\mathbf{s} = \\mathbf{0}.\n$$\n\n使用时间步长为 $\\Delta t$ 的后向（隐式）欧拉格式来推进瞬态解：\n$$\n\\left(\\mathbf{I} - \\Delta t\\,\\mathbf{A}\\right)\\mathbf{T}^{n+1} = \\mathbf{T}^n + \\Delta t\\,\\mathbf{s},\n$$\n从 $\\mathbf{T}^0 = \\mathbf{0}$ 开始，经过 $N_t$ 步后推进到时间 $t_{\\text{final}} = N_t \\Delta t$。对于给定的线性、相容的单步格式，当 $t \\to \\infty$ 时，$\\mathbf{T}^{n}$ 收敛于 $\\mathbf{T}_d$，并且时间离散化对稳态极限的影响消失。然而，对于有限的 $t_{\\text{final}}$，空间离散误差与残余瞬态误差之间存在相互作用，这取决于 $\\Delta t$、$h$ 和 $t_{\\text{final}}$。\n\n在内部网格点上定义三种误差度量，以离散欧几里得范数计算，并以开尔文表示：\n- 在网格上采样的精确稳态解是 $\\mathbf{T}_s$，其元素为 $T_s(x_i)$，其中 $x_i = i h$，对于 $i=1,\\dots,N$。在 $t_{\\text{final}}$ 时的总误差为\n$$\nE_{\\text{total}} = \\left\\Vert \\mathbf{T}^{N_t} - \\mathbf{T}_s \\right\\Vert_2.\n$$\n- 空间离散误差为\n$$\nE_{\\text{spatial}} = \\left\\Vert \\mathbf{T}_d - \\mathbf{T}_s \\right\\Vert_2,\n$$\n它分离了由空间算子的有限差分近似引起的误差。\n- 在 $t_{\\text{final}}$ 时的残余瞬态误差为\n$$\nE_{\\text{transient}} = \\left\\Vert \\mathbf{T}^{N_t} - \\mathbf{T}_d \\right\\Vert_2,\n$$\n它量化了在有限的 $t_{\\text{final}}$ 时，瞬态数值解状态与离散稳态解之间的偏差。\n\n你的任务：\n- 从能量守恒和傅里叶定律出发，解释为什么该模型方程和边界条件是合适的，以及为什么所选的源项能够得到所述的精确稳态解。\n- 从第一性原理出发，构建有限差分空间算子和后向欧拉时间推进格式，不使用简化公式。分析时间积分器在线性系统上的稳定性和渐近行为，并根据矩阵 $\\mathbf{A}$ 的特征值来描述当 $t \\to \\infty$ 时 $E_{\\text{transient}}$ 的衰减特性。\n- 使用指定的参数，实现一个程序，计算 $\\mathbf{T}^{N_t}$、$\\mathbf{T}_d$ 和 $\\mathbf{T}_s$，然后为每个测试用例输出 $E_{\\text{total}}$、$E_{\\text{spatial}}$ 和 $E_{\\text{transient}}$，结果四舍五入到六位小数，并以开尔文表示。提出一个有原则的策略来选择 $\\Delta t$ 和终止条件，以确保计算出的稳态极限是正确的，即 $E_{\\text{transient}}$ 相对于 $E_{\\text{spatial}}$ 可以忽略不计。\n\n使用以下带有单位的固定物理和数值参数：\n- 杆长 $L = 1\\,\\text{m}$，\n- 热扩散率 $\\alpha = 0.1\\,\\text{m}^2/\\text{s}$，\n- 源幅值 $S_0 = 10\\,\\text{K}/\\text{m}^2$，\n- 狄利克雷边界温度 $T(0,t)=0\\,\\text{K}$ 和 $T(L,t)=0\\,\\text{K}$，\n- 初始条件 $T(x,0)=0\\,\\text{K}$。\n\n参数集 $(N, \\Delta t, t_{\\text{final}})$ 的测试套件，覆盖不同情况：\n- 情况 $1$ (一般情况): $(N, \\Delta t, t_{\\text{final}}) = (50, 0.01\\,\\text{s}, 2.0\\,\\text{s})$，\n- 情况 $2$ (粗空间网格): $(N, \\Delta t, t_{\\text{final}}) = (10, 0.01\\,\\text{s}, 2.0\\,\\text{s})$，\n- 情况 $3$ (相同时间范围但大时间步长): $(N, \\Delta t, t_{\\text{final}}) = (50, 0.2\\,\\text{s}, 2.0\\,\\text{s})$，\n- 情况 $4$ (细空间网格但短时间范围): $(N, \\Delta t, t_{\\text{final}}) = (100, 0.05\\,\\text{s}, 0.5\\,\\text{s})$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含所有测试用例的结果，形式为一个用方括号括起来的逗号分隔列表，每个测试用例的结果是列表 $[E_{\\text{total}},E_{\\text{spatial}},E_{\\text{transient}}]$，其中每个值都四舍五入到六位小数，并以开尔文表示。例如，\n$$\n\\text{\"}[[e_{11},e_{12},e_{13}],[e_{21},e_{22},e_{23}],\\dots]\\text{\"}.\n$$\n不应打印任何其他文本。",
            "solution": "所述问题具有科学依据，数学上一致，是适定的，并包含了获得唯一解所需的所有信息。控制方程、边界条件和数值方法在计算传热学领域都是标准的。所提供的解析稳态解是正确的，这可以通过将其代入稳态微分方程并检查边界条件来验证。因此，该问题被认为是有效的。\n\n解决方案分三部分呈现：物理模型的推导与验证、数值方法的构建与分析，以及误差分量和模拟策略的讨论。\n\n### 1. 模型推导与验证\n\n瞬态热方程源自能量守恒原理。对于一个从 $x$ 到 $x+\\Delta x$、横截面积为 $A$ 的一维控制体，能量守恒定律指出，内能的变化率等于传入该控制体的净热传导率加上在该控制体内生成的能量率。其微分形式为：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = -\\frac{\\partial q_x}{\\partial x} + Q'''\n$$\n其中 $\\rho$ 是材料密度，$c$ 是比热容，$T(x,t)$ 是温度，$q_x$ 是 x 方向的热通量，$Q'''$ 是体积生热率。\n\n傅里叶热传导定律为热通量提供了一个本构关系，指出热通量与温度梯度的负值成正比：\n$$\nq_x = -k \\frac{\\partial T}{\\partial x}\n$$\n其中 $k$ 是热导率。将傅里叶定律代入能量守恒方程，并假设材料属性是均匀的（即 $k, \\rho, c$ 为常数），可得：\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left(-k \\frac{\\partial T}{\\partial x}\\right) + Q''' = k \\frac{\\partial^2 T}{\\partial x^2} + Q'''\n$$\n两边同除以 $\\rho c$ 得到热方程的最终形式：\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{k}{\\rho c} \\frac{\\partial^2 T}{\\partial x^2} + \\frac{Q'''}{\\rho c}\n$$\n令热扩散率为 $\\alpha = k/(\\rho c)$，并定义一个单位为温度/时间的源项 $s(x) = Q'''/(\\rho c)$，我们便得到了问题中给出的控制方程：\n$$\n\\frac{\\partial T(x,t)}{\\partial t} = \\alpha \\frac{\\partial^2 T(x,t)}{\\partial x^2} + s(x)\n$$\n狄利克雷边界条件 $T(0,t)=0\\,\\text{K}$ 和 $T(L,t)=0\\,\\text{K}$ 对于两端保持在恒定参考温度的杆是物理上合适的。初始条件 $T(x,0)=0\\,\\text{K}$ 指明在 $t=0$ 时刻，整根杆都处于此参考温度。\n\n选择特定的源项 $s(x) = \\alpha S_0 \\sin\\left(\\frac{\\pi x}{L}\\right)$ 是为了便于解析验证。稳态解 $T_s(x)$ 通过将时间导数设为零（$\\frac{\\partial T}{\\partial t} = 0$）来求得：\n$$\n\\alpha \\frac{d^2 T_s(x)}{dx^2} + s(x) = 0 \\quad \\implies \\quad \\alpha \\frac{d^2 T_s(x)}{dx^2} = -\\alpha S_0 \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n$$\n\\frac{d^2 T_s(x)}{dx^2} = -S_0 \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n对 $x$ 积分两次，得到：\n$$\n\\frac{d T_s(x)}{dx} = S_0 \\frac{L}{\\pi} \\cos\\left(\\frac{\\pi x}{L}\\right) + C_1\n$$\n$$\nT_s(x) = S_0 \\frac{L^2}{\\pi^2} \\sin\\left(\\frac{\\pi x}{L}\\right) + C_1 x + C_2\n$$\n应用边界条件来求解积分常数 $C_1$ 和 $C_2$：\n$T_s(0) = 0 \\implies S_0 \\frac{L^2}{\\pi^2} \\sin(0) + C_1(0) + C_2 = 0 \\implies C_2=0$。\n$T_s(L) = 0 \\implies S_0 \\frac{L^2}{\\pi^2} \\sin(\\pi) + C_1 L = 0 \\implies C_1 L = 0 \\implies C_1=0$。\n因此，精确稳态解确实是 $T_s(x) = S_0 \\frac{L^2}{\\pi^2} \\sin\\left(\\frac{\\pi x}{L}\\right)$，这证实了问题陈述的正确性。\n\n### 2. 数值方法构建与分析\n\n该问题使用线方法进行数值求解，即首先对空间域进行离散化，将偏微分方程 (PDE) 转换为一个常微分方程组 (ODEs)，然后使用时间积分格式求解该方程组。\n\n**空间离散化：**\n空间域 $[0, L]$ 通过 $N$ 个等距的内部点 $x_i = i h$（$i=1, \\dots, N$）和边界点 $x_0=0$ 及 $x_{N+1}=L$ 进行离散化。网格间距为 $h=L/(N+1)$。内部节点 $x_i$ 处的空间二阶导数使用从泰勒级数展开推导出的二阶中心有限差分公式来近似：\n$$\nT(x_i+h) = T(x_i) + h \\frac{\\partial T}{\\partial x}\\bigg|_{x_i} + \\frac{h^2}{2} \\frac{\\partial^2 T}{\\partial x^2}\\bigg|_{x_i} + O(h^3)\n$$\n$$\nT(x_i-h) = T(x_i) - h \\frac{\\partial T}{\\partial x}\\bigg|_{x_i} + \\frac{h^2}{2} \\frac{\\partial^2 T}{\\partial x^2}\\bigg|_{x_i} + O(h^3)\n$$\n将这两个展开式相加并求解二阶导数，得到：\n$$\n\\frac{\\partial^2 T}{\\partial x^2}\\bigg|_{x_i} = \\frac{T(x_{i+1}) - 2T(x_i) + T(x_{i-1})}{h^2} + O(h^2)\n$$\n将此近似代入每个内部节点 $T_i(t) \\approx T(x_i, t)$ 的偏微分方程，得到一个包含 $N$ 个耦合常微分方程的方程组：\n$$\n\\frac{d T_i(t)}{dt} = \\alpha \\frac{T_{i+1}(t) - 2T_i(t) + T_{i-1}(t)}{h^2} + s(x_i), \\quad i=1, \\dots, N\n$$\n边界条件 $T(0,t)=T_0=0$ 和 $T(L,t)=T_{N+1}=0$ 在 $i=1$ 和 $i=N$ 处被引入。设 $\\mathbf{T}(t) = [T_1(t), \\dots, T_N(t)]^T$ 为内部节点温度向量，$\\mathbf{s}$ 为源项向量。该系统可以写成矩阵形式：\n$$\n\\frac{d \\mathbf{T}(t)}{dt} = \\mathbf{A}\\,\\mathbf{T}(t) + \\mathbf{s}\n$$\n其中 $\\mathbf{A} = \\alpha \\mathbf{D}$。矩阵 $\\mathbf{D}$ 是一个 $N \\times N$ 的三对角矩阵，其元素为 $\\mathbf{D}_{ii} = -2/h^2$ 和 $\\mathbf{D}_{i, i\\pm 1} = 1/h^2$，这是离散拉普拉斯算子。\n\n**时间离散化与稳定性：**\n该常微分方程组使用后向（隐式）欧拉格式在时间上进行推进。在时间步 $n+1$ 处的时间导数由后向差分近似：$\\frac{d\\mathbf{T}}{dt} \\approx \\frac{\\mathbf{T}^{n+1} - \\mathbf{T}^n}{\\Delta t}$。该格式在新的时间层 $n+1$ 上计算右侧项：\n$$\n\\frac{\\mathbf{T}^{n+1} - \\mathbf{T}^n}{\\Delta t} = \\mathbf{A}\\mathbf{T}^{n+1} + \\mathbf{s}\n$$\n重新整理以求解未知量 $\\mathbf{T}^{n+1}$：\n$$\n(\\mathbf{I} - \\Delta t\\,\\mathbf{A})\\mathbf{T}^{n+1} = \\mathbf{T}^n + \\Delta t\\,\\mathbf{s}\n$$\n这表示在每个时间步都需要求解一个线性系统。为分析稳定性，考虑齐次方程 $\\dot{\\mathbf{T}} = \\mathbf{A}\\mathbf{T}$。后向欧拉格式为 $\\mathbf{T}^{n+1} = (\\mathbf{I} - \\Delta t \\mathbf{A})^{-1} \\mathbf{T}^n$。稳定性要求放大矩阵 $\\mathbf{G} = (\\mathbf{I} - \\Delta t \\mathbf{A})^{-1}$ 的谱半径小于或等于 1。矩阵 $\\mathbf{A}$ 的特征值为 $\\lambda_j(\\mathbf{A}) = \\alpha \\lambda_j(\\mathbf{D}) = -\\frac{4\\alpha}{h^2}\\sin^2\\left(\\frac{j\\pi}{2(N+1)}\\right)$，其中 $j=1, \\dots, N$。所有特征值 $\\lambda_j(\\mathbf{A})$ 都是实数且为负。矩阵 $\\mathbf{G}$ 的特征值为 $g_j = (1 - \\Delta t \\lambda_j(\\mathbf{A}))^{-1}$。由于 $\\lambda_j(\\mathbf{A})  0$ 且 $\\Delta t > 0$，我们有 $1 - \\Delta t \\lambda_j(\\mathbf{A}) > 1$，这意味着对所有 $j$ 都有 $|g_j|  1$。因此，对于此问题，后向欧拉方法是无条件稳定的。\n\n**渐近行为：**\n离散稳态解 $\\mathbf{T}_d$ 是通过在半离散系统中将时间导数设为零得到的：$\\mathbf{A}\\mathbf{T}_d + \\mathbf{s} = \\mathbf{0}$。与此稳态解的误差 $\\mathbf{e}^n = \\mathbf{T}^n - \\mathbf{T}_d$ 根据 $\\mathbf{e}^{n+1} = \\mathbf{G} \\mathbf{e}^n$ 演化。经过 $N_t$ 步后，$\\mathbf{e}^{N_t} = \\mathbf{G}^{N_t} \\mathbf{e}^0$。瞬态误差的范数 $E_{\\text{transient}} = \\|\\mathbf{e}^{N_t}\\|_2$ 的衰减速率由 $\\mathbf{G}$ 的最大特征值（绝对值）决定，这对应于 $\\mathbf{A}$ 的最小绝对值特征值 $\\lambda_1$。这个最慢衰减模式的特征值为 $\\lambda_1 \\approx -\\alpha(\\pi/L)^2$。瞬态误差随时间指数衰减：$E_{\\text{transient}} \\propto |g_1|^{N_t} \\approx e^{\\lambda_1 t_{\\text{final}}}$。此衰减的特征时间尺度为 $\\tau = -1/\\lambda_1 \\approx L^2/(\\alpha \\pi^2)$。\n\n### 3. 误差分析与模拟策略\n\n总误差 $E_{\\text{total}}$ 是最终瞬态数值解 $\\mathbf{T}^{N_t}$ 与在网格上采样的精确稳态解 $\\mathbf{T}_s$ 之间的差。根据三角不等式，此误差的上限是空间误差和瞬态误差之和：\n$$\nE_{\\text{total}} = \\|\\mathbf{T}^{N_t} - \\mathbf{T}_s\\|_2 = \\|(\\mathbf{T}^{N_t} - \\mathbf{T}_d) + (\\mathbf{T}_d - \\mathbf{T}_s)\\|_2 \\le \\|\\mathbf{T}^{N_t} - \\mathbf{T}_d\\|_2 + \\|\\mathbf{T}_d - \\mathbf{T}_s\\|_2 = E_{\\text{transient}} + E_{\\text{spatial}}\n$$\n- $E_{\\text{spatial}}$ 是由有限差分近似引起的误差。它与时间步进无关，对于这个二阶格式，其量级为 $O(h^2)$。\n- $E_{\\text{transient}}$ 是由于模拟没有运行到无限时间而产生的误差。它取决于 $t_{\\text{final}}$ 并呈指数衰减。\n\n获得精确数值稳态解的一个有原则的策略是，确保瞬态误差相对于固有的空间离散误差可以忽略不计。\n1.  **估计空间误差：** 根据网格大小 $N$，可以预测 $E_{\\text{spatial}}$ 的量级。这就为残余瞬态误差设定了一个目标。\n2.  **选择足够大的最终时间：** 最终时间 $t_{\\text{final}}$ 应选择为特征扩散时间 $\\tau = L^2/(\\alpha \\pi^2)$ 的几倍。对于给定参数，$\\tau = (1\\,\\text{m})^2 / (0.1\\,\\text{m}^2/\\text{s} \\cdot \\pi^2) \\approx 1.013\\,\\text{s}$。选择 $t_{\\text{final}} = 5\\tau \\approx 5\\,\\text{s}$ 会将初始瞬态误差减少一个因子 $e^{-5} \\approx 6.7 \\times 10^{-3}$，这通常是足够的。\n3.  **选择时间步长：** 对于后向欧拉格式，由于稳定性得到保证，$\\Delta t$ 可以根据计算成本来选择。较大的 $\\Delta t$ 意味着到达 $t_{\\text final}$ 的步数更少，但可能无法很好地解析瞬态动力学（这里这不是目标）。\n4.  **终止条件：** 在 $t_{\\text{final}}$ 不固定的实际应用中，人们会迭代直到解不再发生显著变化。一个常见的终止准则是当离散变化率低于某个容差时，例如 $\\|\\mathbf{T}^{n+1} - \\mathbf{T}^n\\|_2 / \\Delta t  \\epsilon$，或者当稳态方程的残差很小时，$\\|\\mathbf{A}\\mathbf{T}^n + \\mathbf{s}\\|_2  \\epsilon'$。容差 $\\epsilon$ 或 $\\epsilon'$ 的选择应相对于 $E_{\\text{spatial}}$ 的预期量级。\n\n以下程序实现了所述的数值解法，并为指定的测试用例计算了所要求的误差度量。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D transient heat equation and computes error metrics.\n    \"\"\"\n    \n    # Fixed physical parameters\n    L = 1.0  # m\n    alpha = 0.1  # m^2/s\n    S0 = 10.0  # K/m^2\n\n    # Test suite of simulation parameters (N, dt, t_final)\n    test_cases = [\n        (50, 0.01, 2.0),\n        (10, 0.01, 2.0),\n        (50, 0.2, 2.0),\n        (100, 0.05, 0.5),\n    ]\n\n    all_results = []\n\n    for N, dt, t_final in test_cases:\n        # --- 1. Setup Grid and Exact Solutions ---\n        \n        # Spatial grid\n        h = L / (N + 1)\n        x_nodes = np.linspace(h, L - h, N)\n\n        # Exact steady-state solution sampled on the grid (Ts_vec)\n        Ts_vec = S0 * (L**2 / np.pi**2) * np.sin(np.pi * x_nodes / L)\n\n        # Source term vector (s_vec)\n        s_vec = alpha * S0 * np.sin(np.pi * x_nodes / L)\n\n        # --- 2. Compute Discrete Steady-State and Spatial Error ---\n\n        # Construct the spatial discretization matrix A\n        # D is the NxN discrete Laplacian operator for Dirichlet BCs\n        D = (np.diag(np.ones(N - 1), 1) + \n             np.diag(np.ones(N - 1), -1) - \n             2 * np.diag(np.ones(N))) / h**2\n        A_mat = alpha * D\n\n        # Solve for discrete steady-state solution Td from A*Td = -s\n        Td_vec = np.linalg.solve(A_mat, -s_vec)\n\n        # Compute spatial discretization error\n        E_spatial = np.linalg.norm(Td_vec - Ts_vec)\n\n        # --- 3. Compute Transient Solution and Errors ---\n\n        # Time-marching with Backward Euler\n        # (I - dt*A) * T_n+1 = T_n + dt*s\n        \n        # Initial condition: T(x,0) = 0\n        T_n = np.zeros(N)\n\n        # Construct the Backward Euler matrix (constant for all steps)\n        BE_mat = np.identity(N) - dt * A_mat\n\n        # Number of time steps\n        num_steps = int(round(t_final / dt))\n\n        # Time-stepping loop\n        for _ in range(num_steps):\n            # Construct right-hand side vector\n            RHS_vec = T_n + dt * s_vec\n            # Solve the linear system for the next time step\n            T_n = np.linalg.solve(BE_mat, RHS_vec)\n        \n        # The final transient solution is T_n, now named T_final\n        T_final = T_n\n        \n        # Compute total error\n        E_total = np.linalg.norm(T_final - Ts_vec)\n        \n        # Compute residual transient error\n        E_transient = np.linalg.norm(T_final - Td_vec)\n\n        # --- 4. Store Results ---\n        all_results.append([\n            round(E_total, 6),\n            round(E_spatial, 6),\n            round(E_transient, 6)\n        ])\n\n    # Final print statement in the exact required format\n    # Example: [[0.1,0.2,0.3],[0.4,0.5,0.6]]\n    # str() adds spaces, so we remove them.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}