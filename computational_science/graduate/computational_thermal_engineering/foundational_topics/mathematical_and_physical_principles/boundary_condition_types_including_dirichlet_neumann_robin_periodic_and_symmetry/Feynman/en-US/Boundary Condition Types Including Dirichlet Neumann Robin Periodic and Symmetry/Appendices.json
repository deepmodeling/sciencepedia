{
    "hands_on_practices": [
        {
            "introduction": "This first practice builds a foundational understanding of the most fundamental boundary condition: the Dirichlet type, which prescribes a fixed value for the temperature. We will begin from first principles to derive the transient heat equation and then discretize it using an explicit forward-in-time, centered-in-space (FTCS) finite difference scheme. This exercise is crucial for understanding not only how to implement a numerical simulation but also for analyzing its practical limitations, specifically the critical concept of numerical stability that governs the choice of time step size .",
            "id": "3938346",
            "problem": "Consider one-dimensional heat conduction in a homogeneous slab occupying the interval $x \\in [0,L]$ with constant thermal properties. Let $T(x,t)$ denote the temperature field. The slab obeys conservation of energy and Fourier's law. Dirichlet boundary conditions impose that the temperature at the boundaries is fixed by external reservoirs. The physical meaning of such Dirichlet boundary conditions is that the boundaries are maintained at prescribed temperatures by ideal thermostats with infinite heat capacity and infinite thermal conductance, thereby enforcing $T(0,t)=T_L$ and $T(L,t)=T_R$ for all time $t$.\n\nStarting from the conservation of energy and Fourier's law, derive the governing Partial Differential Equation (PDE) for transient heat conduction in the slab with constant density $\\rho$, specific heat capacity $c$, and thermal conductivity $k$. Explain, on physical grounds, why a Dirichlet boundary condition enforces a fixed temperature at the boundary and how it differs from a Neumann boundary condition and a Robin boundary condition. Then, discretize the PDE in space using a uniform grid and central differences with spacing $h$, and discretize in time using the forward Euler method with time step $\\Delta t$ to obtain a Finite Difference Method (FDM) update equation for interior nodes under Dirichlet boundary conditions. Using a principle-based stability analysis (energy method or Fourier/von Neumann analysis), derive the necessary and sufficient condition on the parameters $\\alpha$, $\\Delta t$, and $h$ that guarantees stability of the explicit scheme, where $\\alpha = k/(\\rho c)$ is the thermal diffusivity. Finally, in the steady state with no internal heat generation, derive the temperature distribution and the constant heat flux according to Fourier's law.\n\nYour program must implement these derived results to evaluate a test suite of parameter sets. For each test case, compute:\n- A boolean indicating whether the explicit forward-Euler central-difference discretization is stable under Dirichlet boundary conditions.\n- The steady-state boundary heat flux at $x=0$ in watts per square meter (W/m$^2$), expressed as a float.\n\nUse the following test suite. All quantities are specified with units and must be interpreted as such:\n- Test case $1$: $L = 0.1\\,\\mathrm{m}$, $N_c = 20$ uniform cells, $h = L/N_c$, $\\alpha = 1.2\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t = 0.052083333333\\,\\mathrm{s}$, $k = 400\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $T_L = 300\\,\\mathrm{K}$, $T_R = 350\\,\\mathrm{K}$.\n- Test case $2$: $L = 0.2\\,\\mathrm{m}$, $N_c = 40$ uniform cells, $h = L/N_c$, $\\alpha = 1.0\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t = 1.25\\,\\mathrm{s}$, $k = 50\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $T_L = 300\\,\\mathrm{K}$, $T_R = 300\\,\\mathrm{K}$.\n- Test case $3$: $L = 0.1\\,\\mathrm{m}$, $N_c = 20$ uniform cells, $h = L/N_c$, $\\alpha = 1.2\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t = 0.12\\,\\mathrm{s}$, $k = 400\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $T_L = 350\\,\\mathrm{K}$, $T_R = 300\\,\\mathrm{K}$.\n- Test case $4$: $L = 0.05\\,\\mathrm{m}$, $N_c = 100$ uniform cells, $h = L/N_c$, $\\alpha = 8.0\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$, $\\Delta t = 1.0\\times 10^{-4}\\,\\mathrm{s}$, $k = 150\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $T_L = 310\\,\\mathrm{K}$, $T_R = 330\\,\\mathrm{K}$.\n\nIn all cases, assume no internal volumetric heat generation, and express the steady-state heat flux in W/m$^2$. The final output format must be a single line containing a comma-separated list enclosed in square brackets, where each test case result is itself a two-element list of the form `[stable, flux]` with the boolean followed by the float. For example, the program should print a line like `[[True,-123.456],[False,0.0]]`. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces inside brackets.",
            "solution": "The problem requires a comprehensive derivation and analysis of one-dimensional transient heat conduction, followed by the implementation of the derived results to solve specific test cases. The steps are as follows: derivation of the governing partial differential equation (PDE), a physical explanation of boundary conditions, discretization of the PDE, stability analysis of the numerical scheme, and derivation of the steady-state solution.\n\n**1. Derivation of the Governing PDE**\n\nThe governing equation for heat conduction is derived from the principle of conservation of energy. Consider a one-dimensional slab of homogeneous material with constant properties: density $\\rho$, specific heat capacity $c$, and thermal conductivity $k$. For an arbitrary control volume within the slab from $x$ to $x+\\Delta x$ with a uniform cross-sectional area $A$, the energy balance equation is:\n\nRate of change of internal energy = Rate of heat entering - Rate of heat leaving + Rate of heat generation\n\nMathematically, this is expressed as:\n$$\n\\frac{\\partial}{\\partial t} \\int_{x}^{x+\\Delta x} \\rho c T(u,t) A \\, du = A q(x,t) - A q(x+\\Delta x, t) + \\int_{x}^{x+\\Delta x} \\dot{q}_{gen}(u,t) A \\, du\n$$\nwhere $T(x,t)$ is the temperature, $q(x,t)$ is the heat flux (energy per unit area per unit time), and $\\dot{q}_{gen}$ is the volumetric rate of internal heat generation. Dividing by $A\\Delta x$ and taking the limit as $\\Delta x \\to 0$ yields the differential form of the energy conservation equation:\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = -\\frac{\\partial q}{\\partial x} + \\dot{q}_{gen}\n$$\nFourier's law of heat conduction relates the heat flux to the temperature gradient:\n$$\nq = -k \\frac{\\partial T}{\\partial x}\n$$\nThe negative sign indicates that heat flows from higher to lower temperatures. Substituting Fourier's law into the energy equation gives:\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left(-k \\frac{\\partial T}{\\partial x}\\right) + \\dot{q}_{gen} = \\frac{\\partial}{\\partial x} \\left(k \\frac{\\partial T}{\\partial x}\\right) + \\dot{q}_{gen}\n$$\nFor a homogeneous material with constant thermal conductivity $k$, and with no internal heat generation ($\\dot{q}_{gen}=0$ as specified), the equation simplifies to:\n$$\n\\rho c \\frac{\\partial T}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2}\n$$\nDividing by $\\rho c$ gives the final form of the one-dimensional transient heat conduction equation:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nwhere $\\alpha = k/(\\rho c)$ is the thermal diffusivity, a material property that measures how quickly heat propagates through the material.\n\n**2. Physical Meaning of Boundary Conditions**\n\nBoundary conditions are essential for obtaining a unique solution to the PDE. They represent the thermal interaction of the system with its surroundings.\n\n- **Dirichlet Boundary Condition (Type I)**: This condition specifies a fixed temperature at the boundary, i.e., $T(x_b, t) = T_{prescribed}$. Physically, this represents a boundary in contact with an ideal thermal reservoir that has an infinite heat capacity and infinite thermal conductance. Such a reservoir can absorb or supply any amount of heat required to maintain its temperature, which is imposed on the boundary. Examples include a boundary in contact with a large body of fluid undergoing a phase change (e.g., an ice-water bath).\n\n- **Neumann Boundary Condition (Type II)**: This condition specifies the heat flux at the boundary, i.e., $-k \\frac{\\partial T}{\\partial x}\\big|_{x_b} = q_{prescribed}$. A special and common case is the adiabatic or insulated boundary, where the heat flux is zero ($q_{prescribed}=0$). Physically, this models a boundary where a known heating or cooling rate is applied, such as from an electrical heater of known power output, or a boundary that is perfectly insulated, preventing any heat from crossing it. In contrast to the Dirichlet condition where the temperature is fixed, here the temperature at the boundary is free to evolve based on the heat flow within the domain.\n\n- **Robin Boundary Condition (Type III)**: This condition specifies a relationship between the temperature at the boundary and the heat flux, typically representing convective heat transfer to a surrounding fluid. It is expressed as $-k \\frac{\\partial T}{\\partial x}\\big|_{x_b} = h_{conv} (T(x_b, t) - T_{\\infty})$, where $h_{conv}$ is the convection heat transfer coefficient and $T_{\\infty}$ is the temperature of the surrounding fluid. This condition is a more realistic representation for many engineering systems than either Dirichlet or Neumann, as it models a finite rate of heat transfer to or from an external medium. It bridges the gap between the ideal fixed temperature (Dirichlet, corresponding to $h_{conv} \\to \\infty$) and fixed flux (Neumann).\n\n**3. Finite Difference Discretization**\n\nTo solve the PDE numerically, we discretize the domain in space and time. The spatial domain $x \\in [0,L]$ is divided into $N_c$ uniform cells, resulting in $N_c+1$ nodes indexed $i=0, 1, \\dots, N_c$. The spacing is $h=L/N_c$. The time is discretized with a step $\\Delta t$, with time levels indexed by $n$.\nLet $T_i^n \\approx T(x_i, t_n)$, where $x_i = i h$ and $t_n = n \\Delta t$.\n\nThe PDE is $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$.\n- The time derivative is approximated using the **Forward Euler** method (a first-order forward difference):\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i,n} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n- The spatial second derivative is approximated using the **Central Difference** scheme (a second-order central difference):\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i,n} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{h^2}\n$$\nSubstituting these approximations into the PDE:\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{h^2} \\right)\n$$\nSolving for the temperature at the next time step, $T_i^{n+1}$, gives the explicit update equation for interior nodes ($i=1, \\dots, N_c-1$):\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{h^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\nThis can be written using the non-dimensional mesh Fourier number, $Fo = \\frac{\\alpha \\Delta t}{h^2}$:\n$$\nT_i^{n+1} = T_i^n + Fo (T_{i+1}^n - 2T_i^n + T_{i-1}^n) = (1-2Fo)T_i^n + Fo(T_{i+1}^n + T_{i-1}^n)\n$$\nThe Dirichlet boundary conditions are applied directly at the boundary nodes: $T_0^n = T_L$ and $T_{N_c}^n = T_R$ for all time steps $n$.\n\n**4. Stability Analysis**\n\nThe stability of the explicit scheme is analyzed using the von Neumann method. We consider the propagation of a single Fourier mode of error, $E_i^n = \\xi^n e^{j k_m i h}$, where $E_i^n$ is the error at node $i$ and time $n$, $\\xi$ is the amplification factor per time step, $k_m$ is the wave number, and $j=\\sqrt{-1}$. The scheme is stable if the magnitude of the amplification factor $|\\xi| \\le 1$ for all possible wave numbers. The error must satisfy the same homogeneous finite difference equation.\nSubstituting the error term into the update equation:\n$$\n\\xi^{n+1} e^{j k_m i h} = \\xi^n e^{j k_m i h} + Fo(\\xi^n e^{j k_m (i+1)h} - 2\\xi^n e^{j k_m i h} + \\xi^n e^{j k_m (i-1)h})\n$$\nDividing by $\\xi^n e^{j k_m i h}$:\n$$\n\\xi = 1 + Fo(e^{j k_m h} - 2 + e^{-j k_m h})\n$$\nUsing the identity $e^{j\\theta} + e^{-j\\theta} = 2\\cos(\\theta)$, this becomes:\n$$\n\\xi = 1 + Fo(2\\cos(k_m h) - 2) = 1 - 2Fo(1 - \\cos(k_m h))\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\n\\xi = 1 - 4Fo \\sin^2(k_m h / 2)\n$$\nFor stability, we require $|\\xi| \\le 1$, which translates to $-1 \\le \\xi \\le 1$.\nThe condition $\\xi \\le 1$ is always met because $Fo > 0$ and $\\sin^2(k_m h/2) \\ge 0$.\nThe critical condition is $\\xi \\ge -1$:\n$$\n1 - 4Fo \\sin^2(k_m h / 2) \\ge -1\n$$\n$$\n2 \\ge 4Fo \\sin^2(k_m h / 2)\n$$\n$$\nFo \\le \\frac{1}{2 \\sin^2(k_m h / 2)}\n$$\nThis condition must hold for all wave numbers $k_m$. The most restrictive case occurs when the denominator is minimal, i.e., when $\\sin^2(k_m h/2)$ is maximal. The maximum value of $\\sin^2(\\theta)$ is $1$. This corresponds to the highest frequency (shortest wavelength) error mode that can be represented on the grid, where $k_m h = \\pi$.\nThus, the necessary and sufficient condition for stability is:\n$$\nFo \\le \\frac{1}{2} \\quad \\text{or} \\quad \\frac{\\alpha \\Delta t}{h^2} \\le \\frac{1}{2}\n$$\n\n**5. Steady-State Solution**\n\nIn the steady state, the temperature field no longer changes with time, so $\\frac{\\partial T}{\\partial t} = 0$. The governing PDE simplifies to an ordinary differential equation (ODE):\n$$\n\\alpha \\frac{d^2 T}{dx^2} = 0 \\quad \\implies \\quad \\frac{d^2 T}{dx^2} = 0\n$$\nIntegrating this ODE twice with respect to $x$ yields a linear temperature profile:\n$$\n\\frac{dT}{dx} = C_1\n$$\n$$\nT(x) = C_1 x + C_2\n$$\nThe integration constants $C_1$ and $C_2$ are determined by applying the boundary conditions $T(0)=T_L$ and $T(L)=T_R$:\n- At $x=0$: $T(0) = C_1(0) + C_2 = T_L \\implies C_2 = T_L$.\n- At $x=L$: $T(L) = C_1 L + C_2 = T_R \\implies C_1 L + T_L = T_R \\implies C_1 = \\frac{T_R - T_L}{L}$.\n\nThe steady-state temperature distribution is therefore:\n$$\nT(x) = \\left(\\frac{T_R - T_L}{L}\\right)x + T_L\n$$\nThe heat flux is found using Fourier's law with this temperature profile:\n$$\nq = -k \\frac{dT}{dx} = -k C_1 = -k \\left(\\frac{T_R - T_L}{L}\\right) = k \\frac{T_L - T_R}{L}\n$$\nSince the temperature gradient $\\frac{dT}{dx}$ is constant, the heat flux $q$ is also constant throughout the slab in the steady state with no internal heat generation. The flux at $x=0$ is the same as the flux at any other position $x \\in [0,L]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for a suite of test cases.\n    For each case, it computes:\n    1. A boolean indicating if the FDM scheme is stable.\n    2. The steady-state heat flux at x=0.\n    \"\"\"\n    test_cases = [\n        # Test case 1: L, Nc, alpha, dt, k, T_L, T_R\n        (0.1, 20, 1.2e-4, 0.052083333333, 400, 300, 350),\n        # Test case 2\n        (0.2, 40, 1.0e-5, 1.25, 50, 300, 300),\n        # Test case 3\n        (0.1, 20, 1.2e-4, 0.12, 400, 350, 300),\n        # Test case 4\n        (0.05, 100, 8.0e-5, 1.0e-4, 150, 310, 330),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, Nc, alpha, dt, k, T_L, T_R = case\n        \n        # Calculate grid spacing h\n        h = L / Nc\n        \n        # --- Stability Check ---\n        # The stability condition for the explicit forward-Euler central-difference\n        # scheme for the 1D heat equation is alpha * dt / h^2 <= 0.5.\n        # This is also known as the Fourier number, Fo.\n        fourier_number = alpha * dt / (h**2)\n        is_stable = fourier_number <= 0.5\n        \n        # --- Steady-State Heat Flux Calculation ---\n        # In steady state with no internal generation, the temperature profile is linear.\n        # T(x) = (T_R - T_L)/L * x + T_L\n        # The heat flux q is constant and given by Fourier's law:\n        # q = -k * dT/dx\n        # dT/dx = (T_R - T_L) / L\n        # q = -k * (T_R - T_L) / L = k * (T_L - T_R) / L\n        # The flux is constant for all x in [0, L].\n        if L > 0:\n            flux = k * (T_L - T_R) / L\n        else: # Avoid division by zero, though L > 0 in all test cases.\n            flux = float('nan') \n            \n        results.append([is_stable, flux])\n\n    # Format the final output string exactly as required,\n    # e.g., [[True,-123.456],[False,0.0]] a list of lists.\n    # The str() of a list adds spaces, so we remove them.\n    result_strings = [str(r).replace(\" \", \"\") for r in results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\n# Execute the solution function.\nsolve()\n```"
        },
        {
            "introduction": "Moving beyond fixed temperatures, this practice focuses on Neumann boundary conditions, which prescribe the heat flux across a boundary, modeling phenomena like insulation or applied heating. We will employ an unconditionally stable implicit time-integration scheme, deriving the discrete equations from a physically intuitive finite volume method that inherently guarantees energy conservation. A key part of this exercise is to implement a verification step that confirms your simulation conserves energy, a cornerstone of building reliable computational models .",
            "id": "3938343",
            "problem": "Consider one-dimensional transient heat conduction in a homogeneous rod of length $L$ (in $\\mathrm{m}$) and constant cross-sectional area $A$ (in $\\mathrm{m^2}$). Let $x \\in [0,L]$ denote position along the rod and $t \\ge 0$ denote time (in $\\mathrm{s}$). The temperature field $T(x,t)$ (in $\\mathrm{K}$) evolves according to the conservation of energy and Fourier’s law, which together yield the governing partial differential equation (PDE): $$\\rho c_p \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k \\frac{\\partial T}{\\partial x}\\right),$$ where $\\rho$ (in $\\mathrm{kg/m^3}$) is the density, $c_p$ (in $\\mathrm{J}/(\\mathrm{kg}\\cdot\\mathrm{K})$) is the specific heat capacity at constant pressure, and $k$ (in $\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$) is the thermal conductivity. Assume $k$, $\\rho$, and $c_p$ are constant in space and time, so the thermal diffusivity $\\alpha = k/(\\rho c_p)$ (in $\\mathrm{m^2/s}$) is constant, and the PDE reduces to $$\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}.$$\n\nAt the boundary $x=0$, a prescribed heat flux $q_0(t)$ (in $\\mathrm{W/m^2}$) enters the rod; at the boundary $x=L$, the rod is insulated so the heat flux $q_L(t)$ equals $0$. The Neumann boundary conditions are therefore $$-k\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=0} = q_0(t), \\qquad -k\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} = q_L(t) = 0.$$ The initial condition is spatially uniform, $$T(x,0) = T_0,$$ with $T_0$ (in $\\mathrm{K}$) a given constant. Symmetry boundary conditions in one dimension correspond to zero normal temperature gradient, which is the same mathematical form as an insulating Neumann boundary; hence, the $x=L$ boundary here is also a symmetry plane for the temperature field.\n\nTask. Starting strictly from conservation of energy and Fourier’s law, and without invoking any pre-derived discretization shortcuts, derive a finite difference method (FDM) in space and an implicit first-order scheme in time for the above PDE, making explicit how to impose the Neumann boundary conditions at $x=0$ and $x=L$ via flux-based relations. Implement the resulting scheme in a single program that, for each test case below, advances the temperature to the specified final time and evaluates energy conservation by comparing the change in internal energy of the rod to the net energy input through the boundaries.\n\nDefinitions to use in your implementation and evaluation:\n- The discrete internal energy of the rod at time $t$ is $$U(t) = \\rho c_p A \\int_0^L T(x,t)\\,dx,$$ to be approximated numerically on a uniform grid in $x$ with spacing $\\Delta x$ (in $\\mathrm{m}$) using a composite trapezoidal rule.\n- The net energy input through the boundaries over $[0,t]$ is $$E_{\\text{in}}(t) = A \\int_0^t \\big(q_0(\\tau) - q_L(\\tau)\\big)\\,d\\tau,$$ to be approximated numerically using the same time step $\\Delta t$ (in $\\mathrm{s}$) as your implicit scheme.\n- The energy conservation residual to report for each test case is $$R(t_{\\text{final}}) = U(t_{\\text{final}}) - U(0) - E_{\\text{in}}(t_{\\text{final}}),$$ which must be expressed in $\\mathrm{J}$.\n\nYour program must implement the implicit time integrator with flux-based Neumann boundary treatment derived from first principles, and for each test case below, compute the scalar residual $R(t_{\\text{final}})$ in $\\mathrm{J}$.\n\nGrid and discretization requirements:\n- Use a uniform spatial grid with $N$ nodes (including $x=0$ and $x=L$) and spacing $\\Delta x = L/(N-1)$ (in $\\mathrm{m}$).\n- Use a constant time step $\\Delta t$ (in $\\mathrm{s}$) for $n_{\\text{steps}}$ steps so that $n_{\\text{steps}}\\Delta t = t_{\\text{final}}$.\n- Impose the Neumann boundary conditions through flux-based derivative relations, not by prescribing ghost temperatures arbitrarily.\n\nTest suite. Implement the following four test cases, each physically self-consistent and designed to exercise the boundary implementation and energy accounting:\n1. Happy path with constant flux:\n   - $L = 0.05\\,\\mathrm{m}$, $A = 5.0\\times 10^{-4}\\,\\mathrm{m^2}$, $N = 101$, $\\Delta t = 0.01\\,\\mathrm{s}$, $t_{\\text{final}} = 0.5\\,\\mathrm{s}$.\n   - Material: $k = 200\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $\\rho = 8900\\,\\mathrm{kg/m^3}$, $c_p = 385\\,\\mathrm{J}/(\\mathrm{kg}\\cdot\\mathrm{K})$.\n   - Initial temperature: $T_0 = 300\\,\\mathrm{K}$.\n   - Boundary fluxes: $q_0(t) = 2.0\\times 10^{4}\\,\\mathrm{W/m^2}$, $q_L(t) = 0\\,\\mathrm{W/m^2}$.\n2. Oscillatory flux with zero net energy input over one period:\n   - $L = 0.05\\,\\mathrm{m}$, $A = 5.0\\times 10^{-4}\\,\\mathrm{m^2}$, $N = 101$, $\\Delta t = 0.002\\,\\mathrm{s}$, $t_{\\text{final}} = 0.2\\,\\mathrm{s}$.\n   - Material: $k = 200\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $\\rho = 8900\\,\\mathrm{kg/m^3}$, $c_p = 385\\,\\mathrm{J}/(\\mathrm{kg}\\cdot\\mathrm{K})$.\n   - Initial temperature: $T_0 = 300\\,\\mathrm{K}$.\n   - Boundary fluxes: $q_0(t) = 1.0\\times 10^{5}\\sin\\left(\\frac{2\\pi t}{0.2}\\right)\\,\\mathrm{W/m^2}$, $q_L(t) = 0\\,\\mathrm{W/m^2}$.\n3. Edge case with zero flux:\n   - $L = 0.05\\,\\mathrm{m}$, $A = 5.0\\times 10^{-4}\\,\\mathrm{m^2}$, $N = 101$, $\\Delta t = 0.01\\,\\mathrm{s}$, $t_{\\text{final}} = 0.5\\,\\mathrm{s}$.\n   - Material: $k = 200\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $\\rho = 8900\\,\\mathrm{kg/m^3}$, $c_p = 385\\,\\mathrm{J}/(\\mathrm{kg}\\cdot\\mathrm{K})$.\n   - Initial temperature: $T_0 = 300\\,\\mathrm{K}$.\n   - Boundary fluxes: $q_0(t) = 0\\,\\mathrm{W/m^2}$, $q_L(t) = 0\\,\\mathrm{W/m^2}$.\n4. Strong flux with coarse grid and larger time step:\n   - $L = 0.02\\,\\mathrm{m}$, $A = 1.0\\times 10^{-4}\\,\\mathrm{m^2}$, $N = 11$, $\\Delta t = 0.1\\,\\mathrm{s}$, $t_{\\text{final}} = 0.1\\,\\mathrm{s}$.\n   - Material: $k = 200\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $\\rho = 8900\\,\\mathrm{kg/m^3}$, $c_p = 385\\,\\mathrm{J}/(\\mathrm{kg}\\cdot\\mathrm{K})$.\n   - Initial temperature: $T_0 = 300\\,\\mathrm{K}$.\n   - Boundary fluxes: $q_0(t) = 1.0\\times 10^{6}\\,\\mathrm{W/m^2}$, $q_L(t) = 0\\,\\mathrm{W/m^2}$.\n\nOutput specification. Your program should produce a single line of output containing the energy conservation residuals as a comma-separated list enclosed in square brackets, in the same order as the test cases, each value expressed in $\\mathrm{J}$ as a decimal float. For example, the output must be of the form `[residual_1,residual_2,residual_3,residual_4]`, where each `residual_i` is $R(t_{\\text{final}})$ for test case $i$ in $\\mathrm{J}$.",
            "solution": "The problem requires the derivation and implementation of a numerical scheme to solve the one-dimensional transient heat equation, with a specific focus on deriving the finite difference equations from first principles and correctly implementing Neumann boundary conditions. The validity of the implementation is to be checked by evaluating energy conservation.\n\nThe governing partial differential equation (PDE) for the temperature field $T(x,t)$ in a homogeneous rod is:\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2} $$\nwhere $\\alpha = k/(\\rho c_p)$ is the constant thermal diffusivity. This equation is defined on the spatial domain $x \\in [0, L]$ for time $t \\ge 0$. The initial condition is a uniform temperature $T(x,0) = T_0$. The boundary conditions are of the Neumann type, specifying heat fluxes:\n$$ -k\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=0} = q_0(t) \\quad \\text{and} \\quad -k\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} = q_L(t) = 0 $$\n\nThe derivation will be based on the finite volume method (FVM), which starts from the integral form of the conservation of energy. This approach ensures that the resulting numerical scheme is inherently conservative, which is a central theme of this problem.\n\nFirst, we discretize the spatial domain $[0,L]$ into $N$ nodes, indexed by $i = 0, 1, \\dots, N-1$. The nodes are located at positions $x_i = i \\Delta x$, where the uniform grid spacing is $\\Delta x = L/(N-1)$. We define control volumes (CVs) around each node. For interior nodes ($1 \\le i \\le N-2$), the CV extends from $x_i - \\Delta x/2$ to $x_i + \\Delta x/2$, having a length of $\\Delta x$. For the boundary nodes, the CVs have length $\\Delta x/2$: CV$_0$ is $[0, \\Delta x/2]$ and CV$_{N-1}$ is $[L-\\Delta x/2, L]$.\n\nThe integral form of the energy conservation for any control volume $V$ with boundary $\\partial V$ states that the rate of change of internal energy equals the net rate of heat flow into the volume:\n$$ \\frac{d}{dt} \\int_V \\rho c_p T \\,dV = -\\int_{\\partial V} \\mathbf{q} \\cdot \\mathbf{n} \\,dS $$\nIn one dimension, with a constant cross-sectional area $A$, this simplifies to:\n$$ \\frac{d}{dt} \\int_{x_a}^{x_b} \\rho c_p A T(x,t) \\,dx = A [q(x_a,t) - q(x_b,t)] $$\nwhere $q = -k \\frac{\\partial T}{\\partial x}$ is the heat flux according to Fourier's law.\n\n**1. Discretization for an Interior Node ($1 \\le i \\le N-2$)**\nThe control volume is CV$_i = [x_i - \\Delta x/2, x_i + \\Delta x/2]$. Applying the energy balance:\n$$ \\rho c_p A \\frac{d}{dt} \\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} T(x,t) \\,dx = A [q(x_i-\\Delta x/2, t) - q(x_i+\\Delta x/2, t)] $$\nWe approximate the integral assuming the temperature $T_i(t)$ at the node is representative of the average temperature in the CV, and discretize the fluxes using central differences between adjacent nodes:\n$$ \\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} T(x,t) \\,dx \\approx T_i(t) \\Delta x $$\n$$ q(x_i-\\Delta x/2, t) \\approx -k \\frac{T_i(t) - T_{i-1}(t)}{\\Delta x} $$\n$$ q(x_i+\\Delta x/2, t) \\approx -k \\frac{T_{i+1}(t) - T_i(t)}{\\Delta x} $$\nSubstituting these approximations into the energy balance and simplifying:\n$$ \\rho c_p A \\Delta x \\frac{dT_i}{dt} = A \\left[ -k \\frac{T_i - T_{i-1}}{\\Delta x} - \\left(-k \\frac{T_{i+1} - T_i}{\\Delta x}\\right) \\right] $$\n$$ \\frac{dT_i}{dt} = \\frac{k}{\\rho c_p} \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2} = \\alpha \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2} $$\nThis is the semi-discrete equation for an interior node.\n\n**2. Discretization for the Boundary Node at $x=0$ ($i=0$)**\nThe control volume is CV$_0 = [0, \\Delta x/2]$, with length $\\Delta x/2$. The heat flux at the left face is the prescribed boundary flux, $q(0,t) = q_0(t)$.\n$$ \\rho c_p A \\frac{d}{dt} \\int_{0}^{\\Delta x/2} T(x,t) \\,dx = A [q(0, t) - q(\\Delta x/2, t)] $$\nUsing similar approximations:\n$$ \\int_{0}^{\\Delta x/2} T(x,t) \\,dx \\approx T_0(t) \\frac{\\Delta x}{2} $$\n$$ q(\\Delta x/2, t) \\approx -k \\frac{T_1(t) - T_0(t)}{\\Delta x} $$\nThe energy balance becomes:\n$$ \\rho c_p A \\frac{\\Delta x}{2} \\frac{dT_0}{dt} = A \\left[ q_0(t) - \\left(-k \\frac{T_1 - T_0}{\\Delta x}\\right) \\right] $$\n$$ \\frac{dT_0}{dt} = \\frac{2}{\\rho c_p \\Delta x} q_0(t) + \\frac{2k}{\\rho c_p (\\Delta x)^2} (T_1 - T_0) = \\frac{2\\alpha}{k \\Delta x} q_0(t) + \\frac{2\\alpha}{(\\Delta x)^2} (T_1 - T_0) $$\n\n**3. Discretization for the Boundary Node at $x=L$ ($i=N-1$)**\nThe control volume is CV$_{N-1} = [L - \\Delta x/2, L]$, with length $\\Delta x/2$. The boundary is insulated, so $q(L,t) = q_L(t) = 0$.\n$$ \\rho c_p A \\frac{d}{dt} \\int_{L-\\Delta x/2}^{L} T(x,t) \\,dx = A [q(L-\\Delta x/2, t) - q(L, t)] $$\nThe approximations are:\n$$ \\int_{L-\\Delta x/2}^{L} T(x,t) \\,dx \\approx T_{N-1}(t) \\frac{\\Delta x}{2} $$\n$$ q(L-\\Delta x/2, t) \\approx -k \\frac{T_{N-1}(t) - T_{N-2}(t)}{\\Delta x} $$\nThe energy balance becomes:\n$$ \\rho c_p A \\frac{\\Delta x}{2} \\frac{dT_{N-1}}{dt} = A \\left[ -k \\frac{T_{N-1} - T_{N-2}}{\\Delta x} - 0 \\right] $$\n$$ \\frac{dT_{N-1}}{dt} = \\frac{2k}{\\rho c_p (\\Delta x)^2} (T_{N-2} - T_{N-1}) = \\frac{2\\alpha}{(\\Delta x)^2} (T_{N-2} - T_{N-1}) $$\n\n**4. Implicit Time Integration (Backward Euler)**\nWe discretize in time using a constant step $\\Delta t$. Let $T_i^n$ be the temperature at node $i$ at time $t_n = n \\Delta t$. The first-order implicit (Backward Euler) scheme approximates the time derivative as $\\frac{dT_i}{dt} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}$ and evaluates all spatial terms at the new time level $n+1$. Let $\\lambda = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ be the dimensionless mesh Fourier number.\n\nFor interior nodes ($1 \\le i \\le N-2$):\n$$ \\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\frac{T_{i+1}^{n+1} - 2T_i^{n+1} + T_{i-1}^{n+1}}{(\\Delta x)^2} $$\n$$ -\\lambda T_{i-1}^{n+1} + (1+2\\lambda)T_i^{n+1} - \\lambda T_{i+1}^{n+1} = T_i^n $$\n\nFor the boundary node $i=0$:\n$$ \\frac{T_0^{n+1} - T_0^n}{\\Delta t} = \\frac{2\\alpha}{k \\Delta x} q_0(t^{n+1}) + \\frac{2\\alpha}{(\\Delta x)^2} (T_1^{n+1} - T_0^{n+1}) $$\n$$ (1+2\\lambda)T_0^{n+1} - 2\\lambda T_1^{n+1} = T_0^n + \\frac{2\\alpha \\Delta t}{k \\Delta x} q_0^{n+1} = T_0^n + \\frac{2\\lambda \\Delta x}{k} q_0^{n+1} $$\n\nFor the boundary node $i=N-1$:\n$$ \\frac{T_{N-1}^{n+1} - T_{N-1}^n}{\\Delta t} = \\frac{2\\alpha}{(\\Delta x)^2} (T_{N-2}^{n+1} - T_{N-1}^{n+1}) $$\n$$ -2\\lambda T_{N-2}^{n+1} + (1+2\\lambda)T_{N-1}^{n+1} = T_{N-1}^n $$\n\n**5. Linear System Formulation**\nThese equations form a system of $N$ linear equations for the $N$ unknown temperatures $\\mathbf{T}^{n+1} = [T_0^{n+1}, \\dots, T_{N-1}^{n+1}]^T$. The system can be written in matrix form as $\\mathbf{A} \\mathbf{T}^{n+1} = \\mathbf{b}^n$.\n\nThe matrix $\\mathbf{A}$ is an $N \\times N$ tridiagonal matrix, constant in time:\n$$ \\mathbf{A} = \\begin{pmatrix}\n1+2\\lambda & -2\\lambda & & & \\\\\n-\\lambda & 1+2\\lambda & -\\lambda & & \\\\\n& \\ddots & \\ddots & \\ddots & \\\\\n& & -\\lambda & 1+2\\lambda & -\\lambda \\\\\n& & & -2\\lambda & 1+2\\lambda\n\\end{pmatrix} $$\n\nThe right-hand side vector $\\mathbf{b}^n$ is:\n$$ \\mathbf{b}^n = \\begin{pmatrix}\nT_0^n + \\frac{2\\lambda \\Delta x}{k} q_0(t^{n+1}) \\\\\nT_1^n \\\\\n\\vdots \\\\\nT_{N-2}^n \\\\\nT_{N-1}^n\n\\endpmatrix} $$\n\n**6. Algorithm and Energy Conservation**\nThe algorithm proceeds as follows:\n1.  Initialize the temperature field: $T_i^0 = T_0$ for all $i=0, \\dots, N-1$.\n2.  Calculate the initial internal energy $U(0)$ using the composite trapezoidal rule:\n    $U(0) = \\rho c_p A \\int_0^L T(x,0) dx \\approx \\rho c_p A \\Delta x \\left( \\frac{T_0^0}{2} + \\sum_{i=1}^{N-2} T_i^0 + \\frac{T_{N-1}^0}{2} \\right)$.\n3.  Construct the matrix $\\mathbf{A}$.\n4.  Loop for $n$ from $0$ to $n_{\\text{steps}}-1$:\n    a. Construct the vector $\\mathbf{b}^n$ using $\\mathbf{T}^n$ and the boundary flux $q_0(t^{n+1})$.\n    b. Solve the linear system $\\mathbf{A} \\mathbf{T}^{n+1} = \\mathbf{b}^n$ to find the temperatures at the next time step.\n    c. Update the total energy input $E_{\\text{in}}$ by adding the contribution from the current step: $A (q_0(t^{n+1}) - q_L(t^{n+1})) \\Delta t$. We use a right-sided sum for the time integral, consistent with the Backward Euler scheme.\n5.  After the final time step, calculate the final internal energy $U(t_{\\text{final}})$ using the temperature field $\\mathbf{T}^{n_{\\text{steps}}}$ and the trapezoidal rule.\n6.  Compute the energy conservation residual: $R(t_{\\text{final}}) = U(t_{\\text{final}}) - U(0) - E_{\\text{in}}(t_{\\text{final}})$.\n\nDue to the finite volume formulation, which discretizes the integral conservation law directly, the numerical scheme is inherently energy-conserving. This means the calculated residual $R(t_{\\text{final}})$ should be close to zero, limited only by floating-point precision. This provides a strong verification of the correctness of the derivation and implementation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the 1D transient heat conduction problem.\n    \"\"\"\n\n    def run_simulation(params):\n        \"\"\"\n        Executes a single simulation case for the heat conduction problem.\n\n        This function sets up and solves the 1D transient heat equation using a\n        finite volume method in space and an implicit first-order (Backward Euler)\n        scheme in time. It implements Neumann boundary conditions via a flux-based\n        formulation derived from first principles. The primary output is the\n        energy conservation residual, which verifies the implementation's correctness.\n\n        Args:\n            params (dict): A dictionary containing all physical and numerical\n                           parameters for the simulation case.\n\n        Returns:\n            float: The energy conservation residual R(t_final) in Joules.\n        \"\"\"\n        # Extract physical and numerical parameters from the dictionary\n        L = params['L']\n        A = params['A']\n        N = params['N']\n        dt = params['dt']\n        t_final = params['t_final']\n        k = params['k']\n        rho = params['rho']\n        cp = params['cp']\n        T0 = params['T0']\n        q0_func = params['q0_func']\n\n        # Calculate derived discretization parameters\n        dx = L / (N - 1)\n        n_steps = int(round(t_final / dt))\n        alpha = k / (rho * cp)\n        lam = alpha * dt / (dx**2)\n\n        # Initialize temperature field\n        T = np.full(N, T0, dtype=float)\n        x_nodes = np.linspace(0, L, N)\n\n        # 1. Calculate initial internal energy U(0) using the composite trapezoidal rule.\n        # np.trapz implements this rule: integral(y*dx) ~ dx * (y_0/2 + y_1 + ... + y_{N-1}/2)\n        U0 = rho * cp * A * np.trapz(T, x=x_nodes)\n        \n        # Initialize total net energy input\n        E_in_total = 0.0\n\n        # 2. Assemble the time-independent linear system matrix A\n        A_matrix = np.zeros((N, N))\n\n        # Equation for node i=0 (left boundary)\n        A_matrix[0, 0] = 1.0 + 2.0 * lam\n        A_matrix[0, 1] = -2.0 * lam\n\n        # Equations for interior nodes i=1 to N-2\n        for i in range(1, N - 1):\n            A_matrix[i, i - 1] = -lam\n            A_matrix[i, i]     = 1.0 + 2.0 * lam\n            A_matrix[i, i + 1] = -lam\n\n        # Equation for node i=N-1 (right boundary)\n        A_matrix[N - 1, N - 2] = -2.0 * lam\n        A_matrix[N - 1, N - 1] = 1.0 + 2.0 * lam\n\n        # 3. Time-stepping loop\n        for n in range(n_steps):\n            t_new = (n + 1) * dt\n\n            # Assemble the right-hand side vector b\n            b = T.copy()  # Start with temperatures from the previous step\n            q0_new = q0_func(t_new)\n            \n            # Update the first element of b with the boundary flux term. q_L is always 0.\n            flux_term = (2.0 * lam * dx / k) * q0_new\n            b[0] += flux_term\n\n            # Solve the linear system A * T_new = b\n            T = np.linalg.solve(A_matrix, b)\n\n            # Update total energy input using a right-hand sum, consistent with Backward Euler\n            E_in_total += A * q0_new * dt\n\n        # 4. Calculate final internal energy U(t_final)\n        Uf = rho * cp * A * np.trapz(T, x=x_nodes)\n\n        # 5. Calculate the energy conservation residual\n        residual = Uf - U0 - E_in_total\n        return residual\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'L': 0.05, 'A': 5.0e-4, 'N': 101, 'dt': 0.01, 't_final': 0.5,\n            'k': 200.0, 'rho': 8900.0, 'cp': 385.0, 'T0': 300.0,\n            'q0_func': lambda t: 2.0e4\n        },\n        {\n            'L': 0.05, 'A': 5.0e-4, 'N': 101, 'dt': 0.002, 't_final': 0.2,\n            'k': 200.0, 'rho': 8900.0, 'cp': 385.0, 'T0': 300.0,\n            'q0_func': lambda t: 1.0e5 * np.sin(2.0 * np.pi * t / 0.2)\n        },\n        {\n            'L': 0.05, 'A': 5.0e-4, 'N': 101, 'dt': 0.01, 't_final': 0.5,\n            'k': 200.0, 'rho': 8900.0, 'cp': 385.0, 'T0': 300.0,\n            'q0_func': lambda t: 0.0\n        },\n        {\n            'L': 0.02, 'A': 1.0e-4, 'N': 11, 'dt': 0.1, 't_final': 0.1,\n            'k': 200.0, 'rho': 8900.0, 'cp': 385.0, 'T0': 300.0,\n            'q0_func': lambda t: 1.0e6\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Our final practice tackles the more physically realistic Robin boundary condition, which models the interaction between a surface and its environment through convection and radiation. This steady-state problem introduces a significant real-world complexity: nonlinearity, arising from the $T^4$ dependence of thermal radiation. Mastering this exercise will require you to move beyond linear algebra and implement a numerical root-finding algorithm to solve the resulting system of nonlinear algebraic equations, a vital skill for advanced thermal analysis .",
            "id": "3938330",
            "problem": "A one-dimensional slab of thickness $L$ and constant thermal conductivity $k$ undergoes steady heat conduction with uniform volumetric heat generation $\\dot{q}'''$ (units: $\\mathrm{W/m^3}$). The governing balance is conservation of energy and Fourier’s law of heat conduction. Starting from energy conservation and the definition of heat flux, derive a discrete system that enforces the following in steady state:\n- In the interior, the second derivative of temperature plus the source term divided by conductivity vanishes.\n- At the left boundary, a Robin boundary condition models simultaneous convection and thermal radiation to surroundings.\n- At the right boundary, implement any one of Dirichlet, Neumann, symmetry, or periodic boundary types.\n\nThe fundamental base is:\n- Energy conservation in a control volume: the divergence of the conductive heat flux plus volumetric generation is zero in steady state.\n- Fourier’s law: $q_x = -k \\,\\frac{dT}{dx}$.\n- Convective heat transfer at a surface: $q_{\\text{conv}} = h \\,\\left(T_s - T_\\infty\\right)$, where $h$ is the convective heat transfer coefficient, $T_s$ is the surface temperature, and $T_\\infty$ is the ambient fluid temperature.\n- Thermal radiation to a large isothermal surrounding: $q_{\\text{rad}} = \\varepsilon \\sigma \\left(T_s^4 - T_{\\text{surr}}^4\\right)$, where $\\varepsilon$ is the surface emissivity and $\\sigma$ is the Stefan–Boltzmann constant.\n\nLet $x \\in [0,L]$ denote position, and $T(x)$ the temperature field (units: $\\mathrm{K}$). In steady state:\n- Interior balance: $\\frac{d^2 T}{dx^2} + \\frac{\\dot{q}'''}{k} = 0$.\n- Left boundary at $x=0$ (Robin condition modeling convection and radiation): $-k \\,\\frac{dT}{dx}\\big|_{x=0} = h \\,\\left( T(0) - T_\\infty \\right) + \\varepsilon \\sigma \\left( T(0)^4 - T_{\\text{surr}}^4 \\right)$.\n- Right boundary at $x=L$ can be one of:\n    1. Dirichlet: $T(L) = T_R$.\n    2. Neumann (specified heat flux): $-k \\,\\frac{dT}{dx}\\big|_{x=L} = q''_R$.\n    3. Symmetry: $-k \\,\\frac{dT}{dx}\\big|_{x=L} = 0$.\n    4. Periodic: $T(0) = T(L)$ and $\\frac{dT}{dx}\\big|_{x=0} = \\frac{dT}{dx}\\big|_{x=L}$.\n\nDiscretize the domain uniformly into $N$ nodes, including boundaries, with spacing $\\Delta x = \\frac{L}{N-1}$. Use central differences for the interior second derivative, and one-sided differences to approximate boundary derivatives. For the periodic case, use wrap-around neighbors, and to resolve the constant nullspace when $\\dot{q}'''=0$, impose a mean-temperature constraint $\\frac{1}{N}\\sum_{i=0}^{N-1} T_i = T_{\\text{mean}}$ in place of one residual equation. The radiation term must be treated in its exact nonlinear form, not linearized.\n\nYour program must construct the nonlinear algebraic system resulting from these balances and solve for the nodal temperatures. Then, for each test case below, report:\n- The left-wall temperature $T(0)$ in $\\mathrm{K}$.\n- The net heat flux at the left boundary $q''_{\\text{left}}$ in $\\mathrm{W/m^2}$, defined by the conductive approximation $q''_{\\text{left}} = -k \\,\\frac{T_1 - T_0}{\\Delta x}$, which, at convergence, matches the sum of the convective and radiative heat fluxes.\n\nPhysical units must be maintained consistently:\n- $L$ in $\\mathrm{m}$, $k$ in $\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $\\dot{q}'''$ in $\\mathrm{W/m^3}$, $h$ in $\\mathrm{W}/(\\mathrm{m}^2\\cdot\\mathrm{K})$, $\\varepsilon$ dimensionless, $\\sigma$ in $\\mathrm{W}/(\\mathrm{m}^2\\cdot\\mathrm{K}^4)$, temperatures in $\\mathrm{K}$, and heat fluxes in $\\mathrm{W/m^2}$.\n\nTest Suite:\nUse the Stefan–Boltzmann constant $\\sigma = 5.670374419 \\times 10^{-8}\\,\\mathrm{W}/(\\mathrm{m}^2\\cdot\\mathrm{K}^4)$. For each case, discretize with the specified $N$.\n\n- Case 1 (happy path, mixed Robin–Dirichlet):\n    - $L = 0.02\\,\\mathrm{m}$, $k = 16\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $N = 41$, $\\dot{q}''' = 5.0\\times 10^5\\,\\mathrm{W/m^3}$,\n    - $h = 35\\,\\mathrm{W}/(\\mathrm{m}^2\\cdot\\mathrm{K})$, $\\varepsilon = 0.8$, $T_\\infty = 300\\,\\mathrm{K}$, $T_{\\text{surr}} = 300\\,\\mathrm{K}$,\n    - Right boundary: Dirichlet with $T_R = 310\\,\\mathrm{K}$.\n\n- Case 2 (radiation-dominated Robin–symmetry):\n    - $L = 0.01\\,\\mathrm{m}$, $k = 200\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $N = 31$, $\\dot{q}''' = 0\\,\\mathrm{W/m^3}$,\n    - $h = 5\\,\\mathrm{W}/(\\mathrm{m}^2\\cdot\\mathrm{K})$, $\\varepsilon = 0.95$, $T_\\infty = 300\\,\\mathrm{K}$, $T_{\\text{surr}} = 1000\\,\\mathrm{K}$,\n    - Right boundary: symmetry (Neumann with $q''_R = 0$).\n\n- Case 3 (convection-dominated Robin–Dirichlet with low conductivity):\n    - $L = 0.05\\,\\mathrm{m}$, $k = 0.2\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $N = 51$, $\\dot{q}''' = 2.0\\times 10^5\\,\\mathrm{W/m^3}$,\n    - $h = 100\\,\\mathrm{W}/(\\mathrm{m}^2\\cdot\\mathrm{K})$, $\\varepsilon = 0.0$, $T_\\infty = 280\\,\\mathrm{K}$, $T_{\\text{surr}} = 280\\,\\mathrm{K}$,\n    - Right boundary: Dirichlet with $T_R = 280\\,\\mathrm{K}$.\n\n- Case 4 (mixed Robin–Neumann with specified heat flux):\n    - $L = 0.02\\,\\mathrm{m}$, $k = 50\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $N = 41$, $\\dot{q}''' = 1.0\\times 10^4\\,\\mathrm{W/m^3}$,\n    - $h = 10\\,\\mathrm{W}/(\\mathrm{m}^2\\cdot\\mathrm{K})$, $\\varepsilon = 0.9$, $T_\\infty = 295\\,\\mathrm{K}$, $T_{\\text{surr}} = 600\\,\\mathrm{K}$,\n    - Right boundary: Neumann with specified $q''_R = 200\\,\\mathrm{W/m^2}$.\n\n- Case 5 (periodic boundary, no generation, mean temperature constraint):\n    - $L = 0.10\\,\\mathrm{m}$, $k = 100\\,\\mathrm{W}/(\\mathrm{m}\\cdot\\mathrm{K})$, $N = 51$, $\\dot{q}''' = 0\\,\\mathrm{W/m^3}$,\n    - Periodic boundary at both ends, with imposed mean temperature $T_{\\text{mean}} = 300\\,\\mathrm{K}$.\n    - For this case, do not apply the Robin condition; enforce periodicity and the mean-temperature constraint.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Aggregate the results from all test cases in the order given, flattening the pair for each case into the final list as\n`[T_0^(1), q''_left^(1), T_0^(2), q''_left^(2), ..., T_0^(5), q''_left^(5)]`,\nwhere $T_0^{(i)}$ is in $\\mathrm{K}$ and $q''_{\\text{left}}^{(i)}$ is in $\\mathrm{W/m^2}$.",
            "solution": "The problem requires the derivation and numerical solution of a system of discrete equations representing one-dimensional, steady-state heat conduction in a slab of thickness $L$. The analysis begins with the fundamental principles of energy conservation and Fourier's law, leading to the heat equation, which is then discretized using the finite difference method.\n\nThe governing partial differential equation for the temperature field $T(x)$ in the interior of the domain $x \\in (0, L)$ is given as:\n$$\n\\frac{d^2 T}{dx^2} + \\frac{\\dot{q}'''}{k} = 0\n$$\nwhere $k$ is the thermal conductivity and $\\dot{q}'''$ is the volumetric heat generation rate. This equation must be solved subject to specified boundary conditions at $x=0$ and $x=L$.\n\nTo obtain a numerical solution, the continuous domain is discretized into a set of $N$ discrete nodes. The position of each node $i$ is given by $x_i = i \\cdot \\Delta x$ for $i = 0, 1, \\dots, N-1$, where the uniform grid spacing is $\\Delta x = L/(N-1)$. The temperature at each node is denoted by $T_i \\equiv T(x_i)$. The goal is to find the vector of nodal temperatures $\\mathbf{T} = [T_0, T_1, \\dots, T_{N-1}]^T$.\n\nThe governing differential equation is converted into a system of algebraic equations by approximating the derivatives.\n\n**Interior Nodes ($i=1, \\dots, N-2$)**\nFor nodes not on a boundary, the second derivative is approximated using a second-order central difference scheme:\n$$\n\\frac{d^2 T}{dx^2}\\bigg|_{x_i} \\approx \\frac{T(x_{i+1}) - 2T(x_i) + T(x_{i-1})}{(\\Delta x)^2} = \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2}\n$$\nSubstituting this into the governing equation yields a residual equation for each interior node $i$:\n$$\nR_i(\\mathbf{T}) = \\frac{T_{i+1} - 2T_i + T_{i-1}}{(\\Delta x)^2} + \\frac{\\dot{q}'''}{k} = 0\n$$\n\n**Boundary Nodes**\nThe equations for the boundary nodes at $i=0$ and $i=N-1$ are derived from the specified boundary conditions.\n\n**Left Boundary ($i=0$): Robin Condition**\nThe boundary at $x=0$ is subject to a mixed condition involving both convection and radiation:\n$$\n-k \\,\\frac{dT}{dx}\\bigg|_{x=0} = h \\,\\left( T(0) - T_\\infty \\right) + \\varepsilon \\sigma \\left( T(0)^4 - T_{\\text{surr}}^4 \\right)\n$$\nThe derivative at the boundary is approximated using a first-order forward difference:\n$$\n\\frac{dT}{dx}\\bigg|_{x=0} \\approx \\frac{T_1 - T_0}{\\Delta x}\n$$\nSubstituting this approximation into the boundary condition gives the residual equation for node $i=0$:\n$$\nR_0(\\mathbf{T}) = -k \\frac{T_1 - T_0}{\\Delta x} - h(T_0 - T_\\infty) - \\varepsilon \\sigma (T_0^4 - T_{\\text{surr}}^4) = 0\n$$\nThis equation is nonlinear due to the $T_0^4$ term from thermal radiation.\n\n**Right Boundary ($i=N-1$)**\nThe formulation for the node at $x=L$ depends on the type of boundary condition specified.\n\n1.  **Dirichlet Condition:** The temperature is fixed, $T(L) = T_R$. The discrete equation is direct:\n    $$\n    R_{N-1}(\\mathbf{T}) = T_{N-1} - T_R = 0\n    $$\n\n2.  **Neumann Condition:** A heat flux is specified, $-k \\,\\frac{dT}{dx}\\big|_{x=L} = q''_R$. The derivative is approximated using a first-order backward difference:\n    $$\n    \\frac{dT}{dx}\\bigg|_{x=L} \\approx \\frac{T_{N-1} - T_{N-2}}{\\Delta x}\n    $$\n    This leads to the residual equation:\n    $$\n    R_{N-1}(\\mathbf{T}) = -k \\frac{T_{N-1} - T_{N-2}}{\\Delta x} - q''_R = 0\n    $$\n\n3.  **Symmetry Condition:** This is a special case of the Neumann condition with zero specified flux, $q''_R = 0$. The residual simplifies to:\n    $$\n    R_{N-1}(\\mathbf{T}) = -k \\frac{T_{N-1} - T_{N-2}}{\\Delta x} = 0 \\quad \\implies \\quad T_{N-1} - T_{N-2} = 0\n    $$\n\n**Periodic Boundary Condition**\nFor the periodic case, the slab is treated as if its ends are connected, forming a ring. This implies that $T(0) = T(L)$ and $\\frac{dT}{dx}|_{x=0} = \\frac{dT}{dx}|_{x=L}$. The discretization scheme uses \"wrap-around\" neighbors. For any node $i \\in \\{0, \\dots, N-1\\}$, its left neighbor is at index $(i-1+N)\\%N$ and its right neighbor is at index $(i+1)\\%N$. The finite difference equation for the interior holds for all nodes:\n$$\nR_i^{\\text{periodic}}(\\mathbf{T}) = \\frac{T_{(i+1)\\%N} - 2T_i + T_{(i-1+N)\\%N}}{(\\Delta x)^2} + \\frac{\\dot{q}'''}{k} = 0 \\quad \\text{for } i=0, \\dots, N-1\n$$\nIn the specific case where $\\dot{q}'''=0$, this system of linear equations is singular. This corresponds to the physical reality that if $T(x)$ is a solution, then $T(x)+C$ is also a solution for any constant $C$. To obtain a unique solution, an additional constraint must be imposed. As specified, the problem replaces one of the residual equations (e.g., for $i=N-1$) with a mean-temperature constraint:\n$$\nR_{N-1}(\\mathbf{T}) = \\frac{1}{N}\\sum_{j=0}^{N-1} T_j - T_{\\text{mean}} = 0\n$$\nThis makes the overall system well-posed. For this case, the Robin condition at $x=0$ is not applied.\n\n**System Solution**\nThe $N$ residual equations, $R_i(\\mathbf{T})=0$ for $i=0, \\dots, N-1$, form a system of algebraic equations, $\\mathbf{R}(\\mathbf{T}) = \\mathbf{0}$. Due to the nonlinear radiation term, this system must be solved numerically. A Newton-type root-finding algorithm, such as the one provided by `scipy.optimize.root`, is suitable for this purpose. The algorithm iteratively refines an initial guess for $\\mathbf{T}$ until the norm of the residual vector $\\mathbf{R}$ is below a specified tolerance.\n\nUpon convergence, the solution vector $\\mathbf{T}$ containing the nodal temperatures is obtained. From this, the required output quantities are calculated: the left-wall temperature, $T_0$, and the conductive heat flux at the left wall, $q''_{\\text{left}} = -k \\frac{T_1 - T_0}{\\Delta x}$.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Sets up and solves five 1D steady-state heat conduction problems\n    with various boundary conditions.\n    \"\"\"\n    SIGMA = 5.670374419e-8\n\n    test_cases = [\n        # Case 1: Robin-Dirichlet\n        {'L': 0.02, 'k': 16, 'N': 41, 'q_ppp': 5.0e5, 'h': 35, 'eps': 0.8,\n         'T_inf': 300, 'T_surr': 300, 'bc_type': 'Dirichlet', 'bc_val': 310},\n        # Case 2: Robin-Symmetry\n        {'L': 0.01, 'k': 200, 'N': 31, 'q_ppp': 0, 'h': 5, 'eps': 0.95,\n         'T_inf': 300, 'T_surr': 1000, 'bc_type': 'Symmetry', 'bc_val': 0},\n        # Case 3: Robin-Dirichlet (low-k)\n        {'L': 0.05, 'k': 0.2, 'N': 51, 'q_ppp': 2.0e5, 'h': 100, 'eps': 0.0,\n         'T_inf': 280, 'T_surr': 280, 'bc_type': 'Dirichlet', 'bc_val': 280},\n        # Case 4: Robin-Neumann\n        {'L': 0.02, 'k': 50, 'N': 41, 'q_ppp': 1.0e4, 'h': 10, 'eps': 0.9,\n         'T_inf': 295, 'T_surr': 600, 'bc_type': 'Neumann', 'bc_val': 200},\n        # Case 5: Periodic\n        {'L': 0.10, 'k': 100, 'N': 51, 'q_ppp': 0, 'h': 0, 'eps': 0,\n         'T_inf': 0, 'T_surr': 0, 'bc_type': 'Periodic', 'bc_val': 300},\n    ]\n\n    results = []\n    for params in test_cases:\n        T0, q_left = solve_case(params, SIGMA)\n        results.extend([T0, q_left])\n\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\n\ndef solve_case(params, sigma):\n    \"\"\"\n    Solves a single heat conduction problem for a given set of parameters.\n    \"\"\"\n    L = params['L']\n    k = params['k']\n    N = params['N']\n    q_ppp = params['q_ppp']\n    h = params['h']\n    eps = params['eps']\n    T_inf = params['T_inf']\n    T_surr = params['T_surr']\n    bc_type = params['bc_type']\n    bc_val = params['bc_val']\n    \n    dx = L / (N - 1)\n\n    def residuals(T):\n        \"\"\"\n        Calculates the residuals for the system of N algebraic equations.\n        \"\"\"\n        R = np.zeros(N)\n\n        if bc_type == 'Periodic':\n            # This logic is for the periodic case (Case 5)\n            # All nodes use a wrap-around stencil\n            for i in range(N):\n                T_left = T[(i - 1 + N) % N]\n                T_right = T[(i + 1) % N]\n                R[i] = (T_right - 2 * T[i] + T_left) / dx**2 + q_ppp / k\n            \n            # Replace the last residual with the mean temperature constraint\n            R[N - 1] = np.mean(T) - bc_val  # bc_val is T_mean\n        else:\n            # Interior nodes (for non-periodic cases)\n            for i in range(1, N - 1):\n                R[i] = (T[i+1] - 2 * T[i] + T[i-1]) / dx**2 + q_ppp / k\n\n            # Left boundary (Robin condition for Cases 1-4)\n            R[0] = -k * (T[1] - T[0]) / dx - h * (T[0] - T_inf) - eps * sigma * (T[0]**4 - T_surr**4)\n\n            # Right boundary\n            if bc_type == 'Dirichlet':\n                R[N - 1] = T[N - 1] - bc_val  # bc_val is T_R\n            elif bc_type == 'Symmetry':\n                # from -k * (T[N-1] - T[N-2]) / dx = 0\n                R[N - 1] = T[N - 1] - T[N - 2]\n            elif bc_type == 'Neumann':\n                # from -k * (T[N-1] - T[N-2]) / dx = q_R\n                R[N - 1] = -k * (T[N - 1] - T[N - 2]) / dx - bc_val # bc_val is q''_R\n        \n        return R\n\n    # Create an initial guess for the temperature profile\n    if bc_type == 'Periodic':\n        initial_guess = np.full(N, bc_val) # T_mean\n    elif bc_type == 'Dirichlet':\n        initial_guess = np.linspace(300, bc_val, N)\n    else:\n        initial_guess = np.full(N, 300.0)\n\n    # Solve the nonlinear system of equations\n    sol = root(residuals, initial_guess, method='hybr')\n    \n    if not sol.success:\n        # Fallback to a different solver or guess if needed, though 'hybr' is robust.\n        sol = root(residuals, initial_guess, method='lm')\n        if not sol.success:\n             raise RuntimeError(f\"Solver failed for case: {params}\")\n\n    T_solution = sol.x\n    \n    # Calculate required outputs\n    T0 = T_solution[0]\n    if bc_type == 'Periodic':\n        # For the periodic case, the definition of \"left flux\" is ambiguous,\n        # but we can calculate it using the wrap-around neighbor.\n        T1 = T_solution[1]\n        q_left = -k * (T1 - T0) / dx\n    else:\n        q_left = -k * (T_solution[1] - T_solution[0]) / dx\n    \n    return T0, q_left\n\nsolve()\n```"
        }
    ]
}