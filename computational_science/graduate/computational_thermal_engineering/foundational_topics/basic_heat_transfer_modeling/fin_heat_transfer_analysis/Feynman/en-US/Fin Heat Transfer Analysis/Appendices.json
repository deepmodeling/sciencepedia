{
    "hands_on_practices": [
        {
            "introduction": "Understanding the performance of a fin begins with deriving its efficiency from first principles. This foundational exercise guides you through the process of applying an energy balance to a differential fin element to derive the governing second-order ordinary differential equation for temperature distribution. By solving this equation for a fin with an insulated tip, you will derive the classic expression for fin efficiency, a key metric in thermal design, and see how it relates to the crucial dimensionless fin parameter $mL$ .",
            "id": "3953420",
            "problem": "A straight longitudinal fin of uniform rectangular cross-section, thickness $t$ and width $w$, made of a solid with thermal conductivity $k$, is attached to a wall at $x=0$ and extends into a fluid at $x=L$. The wall at the fin base maintains a uniform temperature $T_{b}$, and the ambient fluid is at uniform temperature $T_{\\infty}$; assume $T_{b} > T_{\\infty}$. Heat transfer from the fin’s lateral surfaces to the fluid is by convection with a uniform heat transfer coefficient $h$. Neglect radiation. The tip at $x=L$ is perfectly insulated. Assume steady state, one-dimensional axial conduction in the fin, and uniform material properties. Let the perimeter of the fin’s cross-section be $P$ and the cross-sectional area be $A_{c}$, and define the excess temperature $\\theta(x) = T(x) - T_{\\infty}$.\n\nStarting only from Fourier’s law of heat conduction and Newton’s law of cooling, and using the insulated tip boundary condition $\\left.\\frac{d\\theta}{dx}\\right|_{x=L} = 0$ together with the base condition $\\theta(0) = \\theta_{b} = T_{b} - T_{\\infty}$, derive an analytic expression for the fin efficiency $\\eta_{f}$, defined as the ratio of the actual heat transferred by the fin to the hypothetical heat transfer if the entire fin lateral surface were maintained at the base excess temperature $\\theta_{b}$. Express your final answer solely as a function of the nondimensional group $mL$, where $m$ is the fin parameter formed from $h$, $P$, $k$, and $A_{c}$.\n\nYour final answer must be a single closed-form analytic expression in terms of $mL$. No numerical evaluation is required and no rounding is necessary. Since efficiency is dimensionless, do not include any units in your final expression.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of heat transfer, well-posed with a clear differential equation and boundary conditions, and objectively stated with no ambiguities. We may proceed with the derivation.\n\nThe analysis begins by applying the principle of conservation of energy to a differential element of the fin of length $dx$ located at a distance $x$ from the base. In the steady state, the rate of heat conducted into the element at $x$ must equal the sum of the rate of heat conducted out of the element at $x+dx$ and the rate of heat convected from the surface of the element.\n$$ q_x = q_{x+dx} + dq_{\\text{conv}} $$\nHere, $q_x$ is the rate of heat conduction at location $x$, and $q_{x+dx}$ is the rate at $x+dx$. The term $dq_{\\text{conv}}$ is the rate of heat convection from the differential surface area $dA_s = P dx$, where $P$ is the perimeter of the fin's cross-section.\n\nAccording to Fourier's law of heat conduction, the heat flow rate is given by:\n$$ q_x = -kA_c \\frac{dT}{dx} $$\nwhere $k$ is the thermal conductivity and $A_c$ is the cross-sectional area. Since the excess temperature is defined as $\\theta(x) = T(x) - T_{\\infty}$, and $T_{\\infty}$ is a constant, we have $\\frac{d\\theta}{dx} = \\frac{dT}{dx}$. Thus, Fourier's law can be written in terms of $\\theta(x)$ as:\n$$ q_x = -kA_c \\frac{d\\theta}{dx} $$\nThe heat conducted out at $x+dx$ can be expressed using a first-order Taylor series expansion of $q_x$:\n$$ q_{x+dx} = q_x + \\frac{dq_x}{dx}dx $$\nAccording to Newton's law of cooling, the heat convected from the differential surface is:\n$$ dq_{\\text{conv}} = h(P dx)(T(x) - T_{\\infty}) = hP\\theta(x)dx $$\nwhere $h$ is the convective heat transfer coefficient.\n\nSubstituting these expressions into the energy balance equation gives:\n$$ q_x = \\left(q_x + \\frac{dq_x}{dx}dx\\right) + hP\\theta(x)dx $$\nThis simplifies to:\n$$ -\\frac{dq_x}{dx} - hP\\theta(x) = 0 $$\nNow, we substitute the expression for $q_x$ from Fourier's law:\n$$ -\\frac{d}{dx}\\left(-kA_c \\frac{d\\theta}{dx}\\right) - hP\\theta(x) = 0 $$\nSince $k$ and $A_c$ are uniform, they can be taken out of the derivative, yielding the governing ordinary differential equation (ODE) for one-dimensional heat transfer in the fin:\n$$ kA_c \\frac{d^2\\theta}{dx^2} - hP\\theta(x) = 0 $$\nThis equation is conventionally written as:\n$$ \\frac{d^2\\theta}{dx^2} - m^2\\theta = 0 $$\nwhere $m$ is the fin parameter, defined as $m^2 = \\frac{hP}{kA_c}$, so $m = \\sqrt{\\frac{hP}{kA_c}}$.\n\nThis is a second-order, linear, homogeneous ODE. Its general solution can be expressed in terms of hyperbolic functions, which is convenient for the given boundary conditions:\n$$ \\theta(x) = C_1 \\cosh(mx) + C_2 \\sinh(mx) $$\nThe constants of integration, $C_1$ and $C_2$, are determined by applying the boundary conditions.\n\nThe first boundary condition (BC1) is at the fin tip, $x=L$, which is perfectly insulated. This means there is no heat flow, so the temperature gradient is zero:\n$$ \\left.\\frac{d\\theta}{dx}\\right|_{x=L} = 0 $$\nFirst, we find the derivative of the general solution:\n$$ \\frac{d\\theta}{dx} = mC_1 \\sinh(mx) + mC_2 \\cosh(mx) $$\nApplying BC1 at $x=L$:\n$$ mC_1 \\sinh(mL) + mC_2 \\cosh(mL) = 0 $$\n$$ C_2 = -C_1 \\frac{\\sinh(mL)}{\\cosh(mL)} = -C_1 \\tanh(mL) $$\n\nThe second boundary condition (BC2) is at the fin base, $x=0$, where the temperature is specified as $T_b$. In terms of excess temperature:\n$$ \\theta(0) = T_b - T_{\\infty} = \\theta_b $$\nApplying BC2 to the general solution:\n$$ \\theta(0) = C_1 \\cosh(0) + C_2 \\sinh(0) = C_1(1) + C_2(0) = C_1 $$\nTherefore, $C_1 = \\theta_b$.\n\nSubstituting $C_1 = \\theta_b$ into the expression for $C_2$ gives $C_2 = -\\theta_b \\tanh(mL)$. The particular solution for the temperature distribution is:\n$$ \\theta(x) = \\theta_b \\cosh(mx) - \\theta_b \\tanh(mL) \\sinh(mx) $$\n$$ \\theta(x) = \\theta_b \\left( \\cosh(mx) - \\frac{\\sinh(mL)}{\\cosh(mL)}\\sinh(mx) \\right) = \\frac{\\theta_b}{\\cosh(mL)} \\left( \\cosh(mL)\\cosh(mx) - \\sinh(mL)\\sinh(mx) \\right) $$\nUsing the hyperbolic identity $\\cosh(A-B) = \\cosh(A)\\cosh(B) - \\sinh(A)\\sinh(B)$, the temperature distribution simplifies to:\n$$ \\theta(x) = \\frac{\\theta_b \\cosh(m(L-x))}{\\cosh(mL)} $$\n\nNext, we calculate the actual heat transferred by the fin, $q_f$. This is the heat conducted into the fin at its base, $x=0$:\n$$ q_f = q_{x=0} = -kA_c \\left.\\frac{d\\theta}{dx}\\right|_{x=0} $$\nThe derivative of the temperature distribution is:\n$$ \\frac{d\\theta}{dx} = \\frac{d}{dx}\\left( \\frac{\\theta_b \\cosh(m(L-x))}{\\cosh(mL)} \\right) = \\frac{\\theta_b}{\\cosh(mL)} [ \\sinh(m(L-x)) \\cdot (-m) ] = -\\frac{m\\theta_b \\sinh(m(L-x))}{\\cosh(mL)} $$\nEvaluating this derivative at $x=0$:\n$$ \\left.\\frac{d\\theta}{dx}\\right|_{x=0} = -\\frac{m\\theta_b \\sinh(mL)}{\\cosh(mL)} = -m\\theta_b \\tanh(mL) $$\nSubstituting this back into the expression for $q_f$:\n$$ q_f = -kA_c(-m\\theta_b \\tanh(mL)) = kA_c m \\theta_b \\tanh(mL) $$\n\nThe fin efficiency, $\\eta_f$, is defined as the ratio of the actual heat transfer, $q_f$, to the maximum possible heat transfer, $q_{\\text{max}}$. The maximum heat transfer would occur if the entire fin surface were maintained at the base temperature, $T_b$. In this ideal case, heat would be transferred by convection from the total lateral surface area of the fin, $A_s = PL$, with a uniform temperature difference $\\theta_b$:\n$$ q_{\\text{max}} = h A_s \\theta_b = h(PL)\\theta_b $$\n\nNow, we can compute the efficiency:\n$$ \\eta_f = \\frac{q_f}{q_{\\text{max}}} = \\frac{kA_c m \\theta_b \\tanh(mL)}{hPL\\theta_b} $$\nThe $\\theta_b$ terms cancel. We are left with:\n$$ \\eta_f = \\frac{kA_c m \\tanh(mL)}{hPL} $$\nTo express this solely in terms of $mL$, we use the definition of $m^2 = \\frac{hP}{kA_c}$, which can be rearranged to $hP = kA_c m^2$. Substituting this for $hP$ in the denominator:\n$$ \\eta_f = \\frac{kA_c m \\tanh(mL)}{(kA_c m^2)L} $$\nCanceling the common term $kA_c$ and one factor of $m$:\n$$ \\eta_f = \\frac{\\tanh(mL)}{mL} $$\nThis expression gives the fin efficiency for a straight fin of uniform cross-section with an insulated tip, as a function of the dimensionless group $mL$, as required.",
            "answer": "$$ \\boxed{\\frac{\\tanh(mL)}{mL}} $$"
        },
        {
            "introduction": "Building on the fundamental model, this practice introduces a more realistic scenario where the fin tip also loses heat to the surroundings through convection. You will apply a Robin boundary condition to the governing fin equation, which is a common and important case in engineering applications. The exercise culminates in a practical application by requiring you to calculate the numerical heat transfer rate for a fin with specified material properties and dimensions, bridging the gap between abstract theory and tangible engineering results .",
            "id": "3953834",
            "problem": "A straight, uniform rectangular fin of length $L$, thickness $t$, and width $w$ is attached to a wall maintained at temperature $T_{b}$ and extends into a quiescent fluid at temperature $T_{\\infty}$. The thermal conductivity of the fin material is $k$. The lateral surfaces of the fin (the two large faces and the two edges running along $x$) exchange heat with the surrounding fluid by convection, characterized by a uniform convective heat transfer coefficient $h$. The fin tip at $x=L$ also exchanges heat by convection with coefficient $h_{\\mathrm{tip}}$. Assume steady state, one-dimensional conduction along $x$ with constant properties, no radiation, no internal heat generation, and negligible axial variation of $h$ and $h_{\\mathrm{tip}}$. Let the cross-sectional area be $A = t w$ and the perimeter exposed to convection along the fin length be $P = 2(w + t)$. Define the excess temperature $\\theta(x) = T(x) - T_{\\infty}$ and the base excess temperature $\\theta_{b} = T_{b} - T_{\\infty}$. The fin-tip convective boundary condition is\n$$\n\\left.\\frac{d\\theta}{dx}\\right|_{x=L} = -\\frac{h_{\\mathrm{tip}}}{k}\\,\\theta(L),\n$$\nassuming the tip end area equals the cross-sectional area $A$.\n\nStarting from energy conservation applied to a differential control volume of the fin and appropriate constitutive relations, derive the governing ordinary differential equation for $\\theta(x)$ and obtain the closed-form temperature distribution $\\theta(x)$ that satisfies the base condition $\\theta(0)=\\theta_{b}$ and the convective-tip boundary condition above. Then, determine the net heat flow into the fin at the base,\n$$\nQ = -k A \\left.\\frac{d\\theta}{dx}\\right|_{x=0},\n$$\nand evaluate it numerically for the following values:\n- $k = 180\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$,\n- $L = 0.05\\,\\mathrm{m}$,\n- $t = 0.002\\,\\mathrm{m}$,\n- $w = 0.05\\,\\mathrm{m}$,\n- $h = 40\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$,\n- $h_{\\mathrm{tip}} = 150\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$,\n- $T_{b} = 100\\,^{\\circ}\\mathrm{C}$,\n- $T_{\\infty} = 25\\,^{\\circ}\\mathrm{C}$.\n\nRound your final numerical value of $Q$ to four significant figures. Express $Q$ in $\\mathrm{W}$.",
            "solution": "The user-provided problem statement is a standard exercise in heat transfer analysis of an extended surface (fin) and is deemed valid. It is scientifically grounded in the principles of conductive and convective heat transfer, is well-posed with sufficient data and consistent boundary conditions, and is stated objectively. We shall now proceed with the derivation and solution.\n\nFirst, we derive the governing differential equation for the temperature distribution along the fin. We perform an energy balance on a differential control volume of the fin having a length $dx$ and a cross-sectional area $A$. The control volume is located at a distance $x$ from the base. Under the assumption of steady-state, one-dimensional conduction along the $x$-axis and no internal heat generation, the energy balance is:\n$$\n(\\text{Rate of heat conduction into the element at } x) = (\\text{Rate of heat conduction out of the element at } x+dx) + (\\text{Rate of heat convection from the surface})\n$$\nSymbolically, this is expressed as:\n$$\nq_x = q_{x+dx} + dq_{\\text{conv}}\n$$\nUsing Fourier's law of conduction, $q_x = -k A \\frac{dT}{dx}$, where $T(x)$ is the temperature at position $x$, $k$ is the thermal conductivity, and $A$ is the cross-sectional area. The conduction rate at $x+dx$ can be expressed by a Taylor series expansion as $q_{x+dx} = q_x + \\frac{dq_x}{dx}dx$. The convection heat loss from the lateral surface of the element is given by Newton's law of cooling, $dq_{\\text{conv}} = h P dx (T(x) - T_{\\infty})$, where $h$ is the convective heat transfer coefficient, $P$ is the perimeter of the fin's cross-section, and $T_{\\infty}$ is the ambient fluid temperature.\n\nSubstituting these expressions into the energy balance gives:\n$$\nq_x = \\left(q_x + \\frac{dq_x}{dx}dx\\right) + h P dx (T(x) - T_{\\infty})\n$$\nThis simplifies to:\n$$\n-\\frac{dq_x}{dx} - h P (T(x) - T_{\\infty}) = 0\n$$\nSubstituting Fourier's law for $q_x$:\n$$\n-\\frac{d}{dx}\\left(-k A \\frac{dT}{dx}\\right) - h P (T(x) - T_{\\infty}) = 0\n$$\nSince $k$ and $A$ are constant, we obtain:\n$$\nk A \\frac{d^2T}{dx^2} - h P (T(x) - T_{\\infty}) = 0\n$$\nTo simplify this equation, we introduce the excess temperature, defined as $\\theta(x) = T(x) - T_{\\infty}$. Its derivatives are $\\frac{d\\theta}{dx} = \\frac{dT}{dx}$ and $\\frac{d^2\\theta}{dx^2} = \\frac{d^2T}{dx^2}$. The equation becomes:\n$$\nk A \\frac{d^2\\theta}{dx^2} - h P \\theta = 0\n$$\nRearranging into the standard form for a second-order linear homogeneous ordinary differential equation (ODE):\n$$\n\\frac{d^2\\theta}{dx^2} - \\frac{hP}{kA} \\theta = 0\n$$\nWe define the fin parameter $m$ as $m^2 = \\frac{hP}{kA}$. The governing ODE is therefore:\n$$\n\\frac{d^2\\theta}{dx^2} - m^2 \\theta = 0\n$$\nThe general solution to this ODE can be written in terms of hyperbolic functions:\n$$\n\\theta(x) = C_1 \\cosh(mx) + C_2 \\sinh(mx)\n$$\nThe constants of integration, $C_1$ and $C_2$, are determined from the boundary conditions.\nThe first boundary condition is at the fin base ($x=0$):\n$$\n\\theta(0) = T(0) - T_{\\infty} = T_b - T_{\\infty} = \\theta_b\n$$\nApplying this to the general solution:\n$$\n\\theta(0) = C_1 \\cosh(0) + C_2 \\sinh(0) = C_1(1) + C_2(0) = C_1\n$$\nThus, $C_1 = \\theta_b$. The solution becomes:\n$$\n\\theta(x) = \\theta_b \\cosh(mx) + C_2 \\sinh(mx)\n$$\nThe second boundary condition is at the fin tip ($x=L$), which involves convection:\n$$\n-k A \\left.\\frac{dT}{dx}\\right|_{x=L} = h_{\\mathrm{tip}} A (T(L) - T_{\\infty})\n$$\nIn terms of the excess temperature $\\theta$, this is:\n$$\n-k \\left.\\frac{d\\theta}{dx}\\right|_{x=L} = h_{\\mathrm{tip}} \\theta(L) \\implies \\left.\\frac{d\\theta}{dx}\\right|_{x=L} = -\\frac{h_{\\mathrm{tip}}}{k} \\theta(L)\n$$\nFirst, we find the derivative of our solution for $\\theta(x)$:\n$$\n\\frac{d\\theta}{dx} = m \\theta_b \\sinh(mx) + m C_2 \\cosh(mx)\n$$\nEvaluating the solution and its derivative at $x=L$:\n$$\n\\theta(L) = \\theta_b \\cosh(mL) + C_2 \\sinh(mL)\n$$\n$$\n\\left.\\frac{d\\theta}{dx}\\right|_{x=L} = m \\theta_b \\sinh(mL) + m C_2 \\cosh(mL)\n$$\nSubstituting these into the tip boundary condition equation:\n$$\nm \\theta_b \\sinh(mL) + m C_2 \\cosh(mL) = -\\frac{h_{\\mathrm{tip}}}{k} (\\theta_b \\cosh(mL) + C_2 \\sinh(mL))\n$$\nWe solve for $C_2$:\n$$\nC_2 \\left(m \\cosh(mL) + \\frac{h_{\\mathrm{tip}}}{k} \\sinh(mL)\\right) = -\\theta_b \\left(m \\sinh(mL) + \\frac{h_{\\mathrm{tip}}}{k} \\cosh(mL)\\right)\n$$\n$$\nC_2 = -\\theta_b \\frac{m \\sinh(mL) + \\frac{h_{\\mathrm{tip}}}{k} \\cosh(mL)}{m \\cosh(mL) + \\frac{h_{\\mathrm{tip}}}{k} \\sinh(mL)}\n$$\nSubstituting $C_2$ back into the expression for $\\theta(x)$ gives the complete temperature distribution. However, for determining the heat flow at the base, it is more direct to use the derivative.\n\nThe net heat flow into the fin at the base ($x=0$) is given by Fourier's law:\n$$\nQ = -k A \\left.\\frac{d\\theta}{dx}\\right|_{x=0}\n$$\nFrom our expression for the derivative, we evaluate it at $x=0$:\n$$\n\\left.\\frac{d\\theta}{dx}\\right|_{x=0} = m \\theta_b \\sinh(0) + m C_2 \\cosh(0) = m C_2\n$$\nSubstituting the expression for $C_2$:\n$$\n\\left.\\frac{d\\theta}{dx}\\right|_{x=0} = -m \\theta_b \\frac{m \\sinh(mL) + \\frac{h_{\\mathrm{tip}}}{k} \\cosh(mL)}{m \\cosh(mL) + \\frac{h_{\\mathrm{tip}}}{k} \\sinh(mL)}\n$$\nNow, we find the heat flow $Q$:\n$$\nQ = -k A \\left(-m \\theta_b \\frac{m \\sinh(mL) + \\frac{h_{\\mathrm{tip}}}{k} \\cosh(mL)}{m \\cosh(mL) + \\frac{h_{\\mathrm{tip}}}{k} \\sinh(mL)}\\right)\n$$\n$$\nQ = k A m \\theta_b \\frac{m \\sinh(mL) + \\frac{h_{\\mathrm{tip}}}{k} \\cosh(mL)}{m \\cosh(mL) + \\frac{h_{\\mathrm{tip}}}{k} \\sinh(mL)}\n$$\nUsing $m = \\sqrt{\\frac{hP}{kA}}$, we have $kAm = \\sqrt{hPkA}$. Dividing the numerator and denominator of the fraction by $m\\cosh(mL)$ yields the more common form:\n$$\nQ = \\sqrt{hPkA} \\, \\theta_b \\frac{\\tanh(mL) + \\frac{h_{\\mathrm{tip}}}{mk}}{1 + \\frac{h_{\\mathrm{tip}}}{mk} \\tanh(mL)}\n$$\nNow we evaluate this expression numerically with the given values:\n- $k = 180\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- $L = 0.05\\,\\mathrm{m}$\n- $t = 0.002\\,\\mathrm{m}$\n- $w = 0.05\\,\\mathrm{m}$\n- $h = 40\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$\n- $h_{\\mathrm{tip}} = 150\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$\n- $T_{b} = 100\\,^{\\circ}\\mathrm{C}$\n- $T_{\\infty} = 25\\,^{\\circ}\\mathrm{C}$\n\nFirst, we calculate the required parameters:\n- Cross-sectional area: $A = t w = (0.002\\,\\mathrm{m})(0.05\\,\\mathrm{m}) = 1 \\times 10^{-4}\\,\\mathrm{m}^2$.\n- Perimeter: $P = 2(w + t) = 2(0.05\\,\\mathrm{m} + 0.002\\,\\mathrm{m}) = 0.104\\,\\mathrm{m}$.\n- Base excess temperature: $\\theta_b = T_b - T_{\\infty} = (100 - 25)\\,\\mathrm{K} = 75\\,\\mathrm{K}$.\n- Fin parameter squared: $m^2 = \\frac{hP}{kA} = \\frac{(40\\,\\mathrm{W\\,m^{-2}\\,K^{-1}})(0.104\\,\\mathrm{m})}{(180\\,\\mathrm{W\\,m^{-1}\\,K^{-1}})(1 \\times 10^{-4}\\,\\mathrm{m}^2)} = \\frac{4.16}{0.018} \\approx 231.111\\,\\mathrm{m}^{-2}$.\n- Fin parameter: $m = \\sqrt{231.111...} \\approx 15.2023\\,\\mathrm{m}^{-1}$.\n- Dimensionless fin length: $mL = (15.2023\\,\\mathrm{m}^{-1})(0.05\\,\\mathrm{m}) \\approx 0.76012$.\n- The term $\\sqrt{hPkA}$: $\\sqrt{hPkA} = \\sqrt{(40)(0.104)(180)(1 \\times 10^{-4})} = \\sqrt{0.07488} \\approx 0.273642\\,\\mathrm{W\\,K^{-1}}$.\n- Dimensionless tip convection parameter: $\\frac{h_{\\mathrm{tip}}}{mk} = \\frac{150}{(15.2023)(180)} \\approx 0.054816$.\n\nNow, we compute the components of the heat flow expression:\n- $\\tanh(mL) = \\tanh(0.76012) \\approx 0.64098$.\n- The fraction term:\n$$\n\\frac{\\tanh(mL) + \\frac{h_{\\mathrm{tip}}}{mk}}{1 + \\frac{h_{\\mathrm{tip}}}{mk} \\tanh(mL)} \\approx \\frac{0.64098 + 0.054816}{1 + (0.054816)(0.64098)} = \\frac{0.69580}{1.03514} \\approx 0.67217\n$$\nFinally, we calculate the total heat flow $Q$:\n$$\nQ = (\\sqrt{hPkA}) (\\theta_b) (\\text{fraction})\n$$\n$$\nQ \\approx (0.273642\\,\\mathrm{W\\,K^{-1}})(75\\,\\mathrm{K})(0.67217) \\approx 13.80017\\,\\mathrm{W}\n$$\nRounding the result to four significant figures, we get $Q = 13.80\\,\\mathrm{W}$.",
            "answer": "$$\n\\boxed{13.80}\n$$"
        },
        {
            "introduction": "Real-world thermal systems are often dynamic. This advanced practice transitions from steady-state analysis to the transient behavior of a fin, a topic for which numerical methods are indispensable. You will formulate a Crank-Nicolson finite-difference scheme to solve the time-dependent fin equation, learning how to discretize both space and time and handle complex boundary conditions within a computational framework . This exercise provides direct experience with setting up the matrix equations that form the foundation of modern computational heat transfer solvers.",
            "id": "3953813",
            "problem": "Consider a slender one-dimensional straight fin of length $L$ with constant cross-sectional area $A$ and perimeter $P$ made of a homogeneous material with thermal conductivity $k$, mass density $\\rho$, and specific heat capacity $c$. The lateral surface of the fin is exposed to a uniform ambient at temperature $T_{\\infty}$ with convection coefficient $h$. Let $\\theta(x,t) = T(x,t) - T_{\\infty}$ denote the excess temperature. Assume spatially uniform properties and negligible axial radiation. The energy conservation per unit length combined with Fourier’s law yields the transient fin equation\n$$\n\\rho c A \\frac{\\partial \\theta}{\\partial t} = k A \\frac{\\partial^2 \\theta}{\\partial x^2} - h P \\theta,\n$$\nfor $x \\in (0,L)$ and $t  0$. Define the thermal diffusivity $\\alpha = \\frac{k}{\\rho c}$ and the lateral convection sink coefficient $s = \\frac{h P}{\\rho c A}$ to write\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta.\n$$\nThe base of the fin at $x=0$ is maintained at a known excess temperature $\\theta(0,t) = \\theta_b$ for all $t \\ge 0$. The tip at $x=L$ exchanges heat through its end area $A_e$ with an ambient at temperature $T_{\\infty}$ via convection with coefficient $h_e$. The resulting Robin boundary condition (RBC) for the excess temperature is\n$$\n-k A \\frac{\\partial \\theta}{\\partial x}(L,t) = h_e A_e \\theta(L,t),\n$$\nwhich can be written as\n$$\n-\\frac{\\partial \\theta}{\\partial x}(L,t) = \\beta \\theta(L,t), \\quad \\text{where} \\quad \\beta = \\frac{h_e A_e}{k A}.\n$$\nYou are to formulate a Crank-Nicolson (CN) finite difference scheme for one time step of this transient fin equation on a uniform grid and derive the associated linear algebraic system including the Robin tip boundary. Work from first principles by discretizing the spatial second derivative using central differences on a uniform mesh $x_i = i \\Delta x$ for $i = 0,1,\\dots,N$ with $\\Delta x = \\frac{L}{N}$, and discretize time using the CN method with time step $\\Delta t$. Treat the base boundary at $x_0 = 0$ as a Dirichlet condition with the known value $\\theta_b$, and enforce the Robin boundary at $x_N = L$ via a one-sided second-order accurate elimination of the ghost node consistent with the derivative boundary condition.\n\nTasks:\n- Starting from the finite difference approximations and the CN time discretization applied to $\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta$, derive the tridiagonal matrix system for the unknown vector $\\boldsymbol{\\theta}^{n+1} = [\\theta_1^{n+1}, \\theta_2^{n+1}, \\dots, \\theta_{N}^{n+1}]^{\\top}$ at the new time level $t^{n+1} = t^n + \\Delta t$, where the base node $\\theta_0$ is known and not included in the unknown vector. Explicitly state the coefficients of the matrix row for interior nodes $i=1,\\dots,N-1$, the modification for the first interior node $i=1$ due to the Dirichlet boundary, and the modification for the tip node $i=N$ due to the Robin boundary with parameter $\\beta$.\n- Provide the resulting right-hand side vector in terms of the known previous state $\\boldsymbol{\\theta}^{n} = [\\theta_1^{n}, \\theta_2^{n}, \\dots, \\theta_{N}^{n}]^{\\top}$, the Dirichlet boundary value $\\theta_b$, and the parameters $\\alpha$, $s$, $\\beta$, $\\Delta x$, and $\\Delta t$.\n\nYour program must implement the derived CN scheme to perform a single time step from $\\boldsymbol{\\theta}^{n}$ to $\\boldsymbol{\\theta}^{n+1}$ for each of the following test cases. In all cases, assume a spatially uniform initial excess temperature $\\theta(x,0) = \\theta_{\\text{init}}$ given below, and use a uniform spatial grid of $N+1$ points with $N$ interior intervals. Report the excess temperatures in kelvin at all grid points $x_i$ including the base, that is, output the list $[\\theta_0^{n+1}, \\theta_1^{n+1}, \\dots, \\theta_N^{n+1}]$ for each case. Express all temperatures in $\\mathrm{K}$ and time in $\\mathrm{s}$, and lengths in $\\mathrm{m}$.\n\nUse the following test suite of parameter values:\n- Case $1$ (general case, moderate lateral convection, moderate tip convection):\n  - $L = 0.05\\,\\mathrm{m}$, $N = 10$, $\\Delta t = 0.2\\,\\mathrm{s}$,\n  - $k = 205\\,\\mathrm{W/(m\\,K)}$, $\\rho = 2700\\,\\mathrm{kg/m^3}$, $c = 900\\,\\mathrm{J/(kg\\,K)}$, $A = 1.0\\times 10^{-4}\\,\\mathrm{m^2}$, $P = 0.02\\,\\mathrm{m}$,\n  - $h = 55\\,\\mathrm{W/(m^2\\,K)}$, $h_e = 55\\,\\mathrm{W/(m^2\\,K)}$, $A_e = A$,\n  - $\\theta_b = 50\\,\\mathrm{K}$, $\\theta_{\\text{init}} = 0\\,\\mathrm{K}$.\n- Case $2$ (insulated tip, i.e., zero tip convection):\n  - $L = 0.05\\,\\mathrm{m}$, $N = 10$, $\\Delta t = 0.2\\,\\mathrm{s}$,\n  - $k = 205\\,\\mathrm{W/(m\\,K)}$, $\\rho = 2700\\,\\mathrm{kg/m^3}$, $c = 900\\,\\mathrm{J/(kg\\,K)}$, $A = 1.0\\times 10^{-4}\\,\\mathrm{m^2}$, $P = 0.02\\,\\mathrm{m}$,\n  - $h = 55\\,\\mathrm{W/(m^2\\,K)}$, $h_e = 0\\,\\mathrm{W/(m^2\\,K)}$, $A_e = A$,\n  - $\\theta_b = 50\\,\\mathrm{K}$, $\\theta_{\\text{init}} = 0\\,\\mathrm{K}$.\n- Case $3$ (shorter fin, strong lateral and tip convection, different material):\n  - $L = 0.03\\,\\mathrm{m}$, $N = 6$, $\\Delta t = 0.01\\,\\mathrm{s}$,\n  - $k = 150\\,\\mathrm{W/(m\\,K)}$, $\\rho = 8000\\,\\mathrm{kg/m^3}$, $c = 500\\,\\mathrm{J/(kg\\,K)}$, $A = 2.0\\times 10^{-4}\\,\\mathrm{m^2}$, $P = 0.03\\,\\mathrm{m}$,\n  - $h = 250\\,\\mathrm{W/(m^2\\,K)}$, $h_e = 4000\\,\\mathrm{W/(m^2\\,K)}$, $A_e = A$,\n  - $\\theta_b = 20\\,\\mathrm{K}$, $\\theta_{\\text{init}} = 0\\,\\mathrm{K}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each list entry corresponds to one case and is itself a comma-separated list of the gridpoint temperatures at time $t^{n+1}$. For example, the output format must be\n$$\n[\\,[\\theta_0^{n+1},\\theta_1^{n+1},\\dots,\\theta_N^{n+1}],\\,[\\theta_0^{n+1},\\theta_1^{n+1},\\dots,\\theta_N^{n+1}],\\,[\\theta_0^{n+1},\\theta_1^{n+1},\\dots,\\theta_N^{n+1}]\\,].\n$$",
            "solution": "The user wants to solve a transient heat conduction problem for a one-dimensional fin using the Crank-Nicolson finite difference method.\n\n### 1. Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Governing Equation:** $\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta$ for $x \\in (0,L)$, $t > 0$.\n- **Definitions:**\n    - Excess temperature: $\\theta(x,t) = T(x,t) - T_{\\infty}$.\n    - Thermal diffusivity: $\\alpha = \\frac{k}{\\rho c}$.\n    - Lateral convection sink coefficient: $s = \\frac{h P}{\\rho c A}$.\n- **Boundary Conditions:**\n    - Base (Dirichlet at $x=0$): $\\theta(0,t) = \\theta_b$ for $t \\ge 0$.\n    - Tip (Robin at $x=L$): $-\\frac{\\partial \\theta}{\\partial x}(L,t) = \\beta \\theta(L,t)$, where $\\beta = \\frac{h_e A_e}{k A}$.\n- **Initial Condition:** Spatially uniform excess temperature $\\theta(x,0) = \\theta_{\\text{init}}$.\n- **Numerical Scheme:**\n    - Crank-Nicolson (CN) method for time discretization.\n    - Uniform spatial grid: $x_i = i \\Delta x$ for $i = 0, 1, \\dots, N$, with $\\Delta x = L/N$.\n    - Central difference for spatial second derivative.\n    - Second-order accurate one-sided elimination for the Robin boundary condition at the tip.\n- **Task:**\n    1.  Derive the tridiagonal matrix system for the unknown vector $\\boldsymbol{\\theta}^{n+1} = [\\theta_1^{n+1}, \\theta_2^{n+1}, \\dots, \\theta_{N}^{n+1}]^{\\top}$.\n    2.  Provide the expressions for the matrix coefficients and the right-hand side vector.\n    3.  Implement the scheme for a single time step and report the temperature distribution $[\\theta_0^{n+1}, \\theta_1^{n+1}, \\dots, \\theta_N^{n+1}]$ for three specific test cases.\n- **Test Cases:**\n    - **Case 1:** $L = 0.05$, $N = 10$, $\\Delta t = 0.2$, $k = 205$, $\\rho = 2700$, $c = 900$, $A = 10^{-4}$, $P = 0.02$, $h = 55$, $h_e = 55$, $A_e = A$, $\\theta_b = 50$, $\\theta_{\\text{init}} = 0$.\n    - **Case 2:** Same as Case 1 but with $h_e = 0$.\n    - **Case 3:** $L = 0.03$, $N = 6$, $\\Delta t = 0.01$, $k = 150$, $\\rho = 8000$, $c = 500$, $A = 2 \\times 10^{-4}$, $P = 0.03$, $h = 250$, $h_e = 4000$, $A_e = A$, $\\theta_b = 20$, $\\theta_{\\text{init}} = 0$.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded:** The problem is based on the well-established one-dimensional transient fin equation, a standard model in heat transfer analysis derived from the principle of energy conservation and Fourier's law of conduction. The boundary conditions (Dirichlet and Robin) are physically realistic representations of common thermal conditions. All parameters are standard physical properties. The problem is free of pseudoscience and factually sound.\n- **Well-Posed:** The problem is a linear parabolic partial differential equation with well-defined initial and boundary conditions. This constitutes a well-posed initial-boundary value problem. The task of deriving and implementing a standard numerical method (Crank-Nicolson) for its solution is also well-posed.\n- **Objective:** The problem is stated using precise mathematical and physical terminology. The tasks are specific and quantitative. There are no subjective or opinion-based elements.\n- **Completeness and Consistency:** All necessary physical parameters, geometric dimensions, initial/boundary conditions, and numerical parameters are provided for each test case. The data is self-consistent and sufficient to formulate and solve the problem.\n- **Realism and Feasibility:** The values of thermal properties and dimensions correspond to realistic engineering materials (e.g., aluminum alloy in Case 1, steel/copper alloy in Case 3) and fin geometries. The specified numerical methods are standard and computationally feasible.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. It is a scientifically sound, well-posed, and complete problem in computational heat transfer. I will proceed with the derivation and solution.\n\n### 2. Derivation of the Crank-Nicolson Scheme\n\nThe governing transient fin equation is:\n$$\n\\frac{\\partial \\theta}{\\partial t} = \\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta\n$$\nLet $\\theta_i^n \\approx \\theta(x_i, t^n)$ be the numerical approximation of the excess temperature at spatial grid point $x_i = i\\Delta x$ and time level $t^n = n\\Delta t$.\n\nThe Crank-Nicolson method approximates the time derivative with a forward difference centered at $t^{n+1/2}$, and averages the spatial terms over the time levels $n$ and $n+1$:\n$$\n\\frac{\\theta_i^{n+1} - \\theta_i^n}{\\Delta t} = \\frac{1}{2} \\left[ \\left(\\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta\\right)\\right]_i^{n+1} + \\frac{1}{2} \\left[ \\left(\\alpha \\frac{\\partial^2 \\theta}{\\partial x^2} - s \\theta\\right)\\right]_i^{n}\n$$\nWe use a second-order central difference approximation for the spatial second derivative:\n$$\n\\frac{\\partial^2 \\theta}{\\partial x^2}\\bigg|_i \\approx \\frac{\\theta_{i-1} - 2\\theta_i + \\theta_{i+1}}{(\\Delta x)^2}\n$$\nSubstituting this into the Crank-Nicolson formula gives:\n$$\n\\frac{\\theta_i^{n+1} - \\theta_i^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{\\theta_{i-1}^{n+1} - 2\\theta_i^{n+1} + \\theta_{i+1}^{n+1}}{(\\Delta x)^2} + \\frac{\\theta_{i-1}^{n} - 2\\theta_i^{n} + \\theta_{i+1}^{n}}{(\\Delta x)^2} \\right) - \\frac{s}{2}(\\theta_i^{n+1} + \\theta_i^n)\n$$\nLet's define the diffusion number $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$. Multiplying by $\\Delta t$ and rearranging terms to group unknowns (at time level $n+1$) on the left-hand side (LHS) and knowns (at time level $n$) on the right-hand side (RHS), we get:\n$$\n-\\frac{r}{2}\\theta_{i-1}^{n+1} + \\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_i^{n+1} - \\frac{r}{2}\\theta_{i+1}^{n+1} = \\frac{r}{2}\\theta_{i-1}^{n} + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_i^{n} + \\frac{r}{2}\\theta_{i+1}^{n}\n$$\nThis equation is valid for the interior nodes $i = 1, 2, \\dots, N-1$. We must now incorporate the boundary conditions to modify the equations for nodes $i=1$ and $i=N$. The unknown vector is $\\boldsymbol{\\theta}^{n+1} = [\\theta_1^{n+1}, \\theta_2^{n+1}, \\dots, \\theta_N^{n+1}]^{\\top}$.\n\n**Base Boundary Condition (Dirichlet at $i=0$):**\nThe base temperature is fixed: $\\theta(0, t) = \\theta_b$. In our discretized grid, this means $\\theta_0^n = \\theta_b$ for all $n \\ge 0$.\nFor the first interior node, $i=1$, the general equation is:\n$$\n-\\frac{r}{2}\\theta_{0}^{n+1} + \\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_1^{n+1} - \\frac{r}{2}\\theta_2^{n+1} = \\frac{r}{2}\\theta_{0}^{n} + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_1^{n} + \\frac{r}{2}\\theta_2^{n}\n$$\nSince $\\theta_0^{n+1} = \\theta_0^n = \\theta_b$, we move the known terms involving $\\theta_0$ to the RHS:\n$$\n\\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_1^{n+1} - \\frac{r}{2}\\theta_2^{n+1} = \\frac{r}{2}\\theta_b + \\frac{r}{2}\\theta_b + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_1^{n} + \\frac{r}{2}\\theta_2^{n}\n$$\nThe equation for the first unknown $\\theta_1^{n+1}$ is:\n$$\n\\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_1^{n+1} - \\frac{r}{2}\\theta_2^{n+1} = r\\theta_b + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_1^{n} + \\frac{r}{2}\\theta_2^{n}.\n$$\n\n**Tip Boundary Condition (Robin at $i=N$):**\nThe condition is $-\\frac{\\partial \\theta}{\\partial x}(L,t) = \\beta \\theta(L,t)$. We use a second-order accurate central difference for the derivative at $x_N=L$ by introducing a \"ghost\" node at $x_{N+1} = x_N + \\Delta x$.\n$$\n\\frac{\\partial \\theta}{\\partial x}\\bigg|_N \\approx \\frac{\\theta_{N+1} - \\theta_{N-1}}{2\\Delta x}\n$$\nSubstituting this into the Robin boundary condition yields:\n$$\n-\\left(\\frac{\\theta_{N+1} - \\theta_{N-1}}{2\\Delta x}\\right) = \\beta \\theta_N \\quad \\implies \\quad \\theta_{N+1} = \\theta_{N-1} - 2\\beta\\Delta x \\theta_N\n$$\nThis relation is used to eliminate the ghost node $\\theta_{N+1}$ from the general difference equation at $i=N$. We apply this at both time levels $n$ and $n+1$.\nThe equation for node $i=N$ is:\n$$\n-\\frac{r}{2}\\theta_{N-1}^{n+1} + \\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_N^{n+1} - \\frac{r}{2}\\theta_{N+1}^{n+1} = \\frac{r}{2}\\theta_{N-1}^{n} + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_N^{n} + \\frac{r}{2}\\theta_{N+1}^{n}\n$$\nSubstitute $\\theta_{N+1}^{n+1} = \\theta_{N-1}^{n+1} - 2\\beta\\Delta x \\theta_N^{n+1}$ on the LHS and $\\theta_{N+1}^{n} = \\theta_{N-1}^{n} - 2\\beta\\Delta x \\theta_N^{n}$ on the RHS:\nLHS: $-\\frac{r}{2}\\theta_{N-1}^{n+1} + \\left(1 + r + \\frac{s \\Delta t}{2}\\right)\\theta_N^{n+1} - \\frac{r}{2}\\left(\\theta_{N-1}^{n+1} - 2\\beta\\Delta x \\theta_N^{n+1}\\right) = -r \\theta_{N-1}^{n+1} + \\left(1 + r + \\frac{s \\Delta t}{2} + r\\beta\\Delta x\\right)\\theta_N^{n+1}$\n\nRHS: $\\frac{r}{2}\\theta_{N-1}^{n} + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_N^{n} + \\frac{r}{2}\\left(\\theta_{N-1}^{n} - 2\\beta\\Delta x \\theta_N^{n}\\right) = r \\theta_{N-1}^{n} + \\left(1 - r - \\frac{s \\Delta t}{2} - r\\beta\\Delta x\\right)\\theta_N^{n}$\n\n### 3. Tridiagonal System Summary\n\nWe have a linear system of $N$ equations for the $N$ unknowns $\\boldsymbol{\\theta}^{n+1} = [\\theta_1^{n+1}, \\dots, \\theta_N^{n+1}]^{\\top}$ of the form $\\mathbf{M} \\boldsymbol{\\theta}^{n+1} = \\mathbf{d}$.\n\n**Matrix $\\mathbf{M}$ ($N \\times N$):**\nThis is a tridiagonal matrix with the following coefficients. Let the row index be $j \\in \\{1,\\dots,N\\}$.\n- **Sub-diagonal ($a_j$):**\n  - For $j = 2, \\dots, N-1$: $a_j = -\\frac{r}{2}$\n  - For $j = N$: $a_N = -r$\n- **Main diagonal ($b_j$):**\n  - For $j = 1, \\dots, N-1$: $b_j = 1 + r + \\frac{s \\Delta t}{2}$\n  - For $j = N$: $b_N = 1 + r + \\frac{s \\Delta t}{2} + r\\beta\\Delta x$\n- **Super-diagonal ($c_j$):**\n  - For $j = 1, \\dots, N-1$: $c_j = -\\frac{r}{2}$\n\n**Right-hand side vector $\\mathbf{d}$ (size $N$):**\nLet the component index be $j \\in \\{1,\\dots,N\\}$.\n- **First component ($d_1$):**\n  - $d_1 = r\\theta_b + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_1^n + \\frac{r}{2}\\theta_2^n$\n- **Interior components ($d_j$ for $j=2, \\dots, N-1$):**\n  - $d_j = \\frac{r}{2}\\theta_{j-1}^n + \\left(1 - r - \\frac{s \\Delta t}{2}\\right)\\theta_j^n + \\frac{r}{2}\\theta_{j+1}^n$\n- **Last component ($d_N$):**\n  - $d_N = r\\theta_{N-1}^n + \\left(1 - r - \\frac{s \\Delta t}{2} - r\\beta\\Delta x\\right)\\theta_N^n$\n\nThe solution for the temperatures at the new time step $t^{n+1}$ is found by setting up this system with the known values from time $t^n$ and solving for $\\boldsymbol{\\theta}^{n+1}$. The final temperature vector is then constructed by prepending the known base temperature $\\theta_b$ to the solution vector: $[\\theta_b, \\theta_1^{n+1}, \\dots, \\theta_N^{n+1}]$.",
            "answer": "```python\nimport numpy as np\n\ndef setup_and_solve_cn_step(params):\n    \"\"\"\n    Sets up and solves the Crank-Nicolson system for one time step.\n\n    Args:\n        params (dict): A dictionary containing all problem parameters.\n\n    Returns:\n        np.array: The temperature vector at the new time step, including the base.\n    \"\"\"\n    # Unpack parameters\n    L = params['L']\n    N = params['N']\n    dt = params['dt']\n    k = params['k']\n    rho = params['rho']\n    c = params['c']\n    A = params['A']\n    P = params['P']\n    h = params['h']\n    h_e = params['h_e']\n    A_e = params['A_e']\n    theta_b = params['theta_b']\n    theta_init = params['theta_init']\n    \n    # Calculate derived parameters\n    dx = L / N\n    alpha = k / (rho * c)\n    s = (h * P) / (rho * c * A)\n    beta = (h_e * A_e) / (k * A)\n    r = alpha * dt / (dx**2)\n\n    # Initial temperature vector theta^n for the single step calculation\n    # theta_n[0] is at x=0, theta_n[N] is at x=L\n    theta_n = np.full(N + 1, theta_init)\n    theta_n[0] = theta_b\n\n    # The vector of unknowns contains N elements: theta_{1} to theta_{N}\n    # We will construct an N x N matrix M and an N-element RHS vector d.\n    M = np.zeros((N, N))\n    d = np.zeros(N)\n\n    # --- Fill Matrix M (LHS coefficients) ---\n\n    # Main diagonal\n    diag_val = 1 + r + (s * dt / 2)\n    np.fill_diagonal(M, diag_val)\n    \n    # Sub-diagonal and Super-diagonal for interior nodes\n    sub_sup_val = -r / 2\n    if N > 1:\n        np.fill_diagonal(M[1:], sub_sup_val)  # Sub-diagonal\n        np.fill_diagonal(M[:, 1:], sub_sup_val) # Super-diagonal\n\n    # Modify last row for Robin BC at i=N\n    if N > 1:\n        M[N-1, N-2] = -r\n    M[N-1, N-1] = diag_val + r * beta * dx\n\n    # --- Fill RHS vector d ---\n\n    # First interior node (i=1)\n    # d[0] corresponds to the equation for theta_1\n    d[0] = r * theta_b + (1 - r - s * dt / 2) * theta_n[1]\n    if N > 1:\n        d[0] += (r / 2) * theta_n[2]\n\n    # Interior nodes (i=2 to N-1)\n    # d[j] corresponds to equation for theta_{j+1}\n    for j in range(1, N - 1):\n        d[j] = (r / 2) * theta_n[j] + \\\n               (1 - r - s * dt / 2) * theta_n[j+1] + \\\n               (r / 2) * theta_n[j+2]\n\n    # Last node (i=N)\n    # d[N-1] corresponds to equation for theta_N\n    if N > 1:\n        d[N-1] = r * theta_n[N-1] + \\\n                 (1 - r - s * dt / 2 - r * beta * dx) * theta_n[N]\n    \n    # Solve the linear system M * theta_unknown_np1 = d\n    theta_unknown_np1 = np.linalg.solve(M, d)\n    \n    # Construct the full solution vector for t^{n+1}\n    theta_np1 = np.concatenate(([theta_b], theta_unknown_np1))\n\n    return theta_np1\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {\n            'L': 0.05, 'N': 10, 'dt': 0.2,\n            'k': 205.0, 'rho': 2700.0, 'c': 900.0,\n            'A': 1.0e-4, 'P': 0.02, 'h': 55.0,\n            'h_e': 55.0, 'A_e': 1.0e-4,\n            'theta_b': 50.0, 'theta_init': 0.0\n        },\n        # Case 2\n        {\n            'L': 0.05, 'N': 10, 'dt': 0.2,\n            'k': 205.0, 'rho': 2700.0, 'c': 900.0,\n            'A': 1.0e-4, 'P': 0.02, 'h': 55.0,\n            'h_e': 0.0, 'A_e': 1.0e-4,\n            'theta_b': 50.0, 'theta_init': 0.0\n        },\n        # Case 3\n        {\n            'L': 0.03, 'N': 6, 'dt': 0.01,\n            'k': 150.0, 'rho': 8000.0, 'c': 500.0,\n            'A': 2.0e-4, 'P': 0.03, 'h': 250.0,\n            'h_e': 4000.0, 'A_e': 2.0e-4,\n            'theta_b': 20.0, 'theta_init': 0.0\n        }\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result_vector = setup_and_solve_cn_step(case_params)\n        # Format the result vector as a list of strings\n        result_str_list = [f\"{x:.10f}\" for x in result_vector]\n        results.append(f\"[{','.join(result_str_list)}]\")\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}