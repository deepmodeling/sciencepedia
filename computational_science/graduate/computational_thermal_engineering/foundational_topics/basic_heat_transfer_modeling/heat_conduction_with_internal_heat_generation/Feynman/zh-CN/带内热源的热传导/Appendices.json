{
    "hands_on_practices": [
        {
            "introduction": "为建立坚实的理论基础，我们从一个经典问题入手：一个具有均匀内部热源和对称面对流冷却的平板中的稳态热传导。本练习  将引导你从第一性原理出发，推导温度分布，正确应用对称性和对流边界条件。通过这个过程，你将理解最高温度如何受到毕渥数 $Bi$ 的影响，而掌握这种解析解对于验证计算模型和建立物理直觉至关重要。",
            "id": "3960425",
            "problem": "一块厚度为 $2L$ 的平板，其热导率 $k$ 为常数，并具有均匀的内部体积生热率 $q'''$。该平板关于其中间平面对称，我们将该中间平面作为一维坐标系 $x \\in [-L, L]$ 的原点。位于 $x = -L$ 和 $x = +L$ 的两个表面都暴露在温度为 $T_{\\infty}$ 的相同环境流体中，并具有均匀的对流换热系数 $h$。假设为稳态、一维热传导，无辐射，且无轴向属性变化。\n\n仅从微分控制体上的能量守恒和傅里叶热传导定律出发，推导平板内最高温度 $T_{\\max}$ 的精确表达式。您的结果需要用 $T_{\\infty}$、$q'''$、$k$、$L$ 和毕渥数 (Biot number) $\\mathrm{Bi} = \\dfrac{hL}{k}$ 明确表示。\n\n您的推导过程应包括：\n- 在所述假设下，建立控制温度场的适当微分方程。\n- 论证并应用由对称性和对流所隐含的正确边界条件。\n- 求解温度分布，并确定 $T_{\\max}$ 的位置和数值。\n- 将最终表达式简化为一个闭式解析表达式，并明确显示其对 $\\mathrm{Bi}$ 的依赖关系。\n\n将最终答案表示为用给定参数表示的关于 $T_{\\max}$ 的单一闭式解析表达式。最终答案中不要提供中间步骤。最终答案中不要包含单位。",
            "solution": "在稳态、一维、常物性和均匀热生成的假设下，热扩散方程简化为：\n$$ \\frac{d^2T}{dx^2} = -\\frac{q'''}{k} $$\n该问题的边界条件由对称性和表面对流给出：\n1.  **对称边界条件**：由于几何和热边界条件关于中心平面对称，温度分布也必须是对称的。这意味着在中心 $x=0$ 处，温度梯度为零。\n    $$ \\left. \\frac{dT}{dx} \\right|_{x=0} = 0 $$\n2.  **对流边界条件**：在表面 $x=L$ 处，从内部传导至表面的热通量必须等于从表面对流到周围流体的热通量。\n    $$ -k \\left. \\frac{dT}{dx} \\right|_{x=L} = h [T(L) - T_{\\infty}] $$\n为了求解温度分布 $T(x)$，我们将控制方程对 $x$ 积分两次。第一次积分得到：\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k}x + C_1 $$\n应用对称边界条件，我们在 $x=0$ 处计算上式：\n$$ \\left. \\frac{dT}{dx} \\right|_{x=0} = -\\frac{q'''}{k}(0) + C_1 = 0 \\implies C_1 = 0 $$\n因此，温度梯度为 $\\frac{dT}{dx} = -\\frac{q'''}{k}x$。\n第二次积分得到温度分布：\n$$ T(x) = \\int \\left(-\\frac{q'''}{k}x\\right) dx = -\\frac{q'''}{2k}x^2 + C_2 $$\n为了确定常数 $C_2$，我们应用对流边界条件。首先，计算在 $x=L$ 处的温度和温度梯度：\n$$ T(L) = -\\frac{q'''L^2}{2k} + C_2 $$\n$$ \\left. \\frac{dT}{dx} \\right|_{x=L} = -\\frac{q'''L}{k} $$\n将这些代入对流边界条件方程：\n$$ -k \\left( -\\frac{q'''L}{k} \\right) = h \\left[ \\left( -\\frac{q'''L^2}{2k} + C_2 \\right) - T_{\\infty} \\right] $$\n$$ q'''L = h \\left( -\\frac{q'''L^2}{2k} + C_2 - T_{\\infty} \\right) $$\n求解 $C_2$：\n$$ C_2 = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k} $$\n温度分布是抛物线形的，且开口向下（因为 $x^2$ 的系数为负），因此最高温度 $T_{\\max}$ 出现在 $x=0$ 处。\n$$ T_{\\max} = T(0) = -\\frac{q'''}{2k}(0)^2 + C_2 = C_2 $$\n所以，\n$$ T_{\\max} = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k} $$\n最后，我们使用毕渥数 $\\mathrm{Bi} = \\frac{hL}{k}$ 来简化表达式。我们可以将 $\\frac{1}{h}$ 替换为 $\\frac{L}{k \\cdot \\mathrm{Bi}}$：\n$$ T_{\\max} = T_{\\infty} + q'''L \\left( \\frac{L}{k \\cdot \\mathrm{Bi}} \\right) + \\frac{q'''L^2}{2k} = T_{\\infty} + \\frac{q'''L^2}{k \\cdot \\mathrm{Bi}} + \\frac{q'''L^2}{2k} $$\n提出公因式 $\\frac{q'''L^2}{2k}$：\n$$ T_{\\max} = T_{\\infty} + \\frac{q'''L^2}{2k} \\left( 1 + \\frac{2}{\\mathrm{Bi}} \\right) $$\n这便是最高温度的最终表达式。",
            "answer": "$$\\boxed{T_{\\infty} + \\frac{q'''L^2}{2k} \\left( 1 + \\frac{2}{\\mathrm{Bi}} \\right)}$$"
        },
        {
            "introduction": "在实际工程应用中，材料的物性往往随温度变化。本练习  将通过分析一种热导率 $k(T)$ 依赖于温度的材料，来探讨这一复杂情况。通过解析求解这个非线性问题，你将学会处理更贴近现实的材料模型，并深入理解其与常物性假设下的区别，这是高级传热分析中的一项宝贵技术。",
            "id": "3960405",
            "problem": "一个厚度为 $L$ 的平板占据区域 $0 \\le x \\le L$。该材料的热导率 $k(T)$ 随温度变化，呈线性形式 $k(T) = k_0 \\left(1 + \\beta T\\right)$，其中 $k_0  0$ 和 $\\beta$ 是常数。其体积内热生成率为空间均匀且稳定的，大小为 $q_0  0$。在 $x = 0$ 处的边界是绝热的，而在 $x = L$ 处的边界是等温的，温度为 $T_s$。假设为一维稳态热传导，忽略对流和辐射，并假设对于所有 $x \\in [0, L]$ 都有 $1 + \\beta T(x)  0$，因此 $k(T)$ 在整个区域内为正。\n\n仅从应用于微分控制体的稳态能量守恒积分形式和傅里叶热传导定律出发，推导温度场 $T(x)$ 的闭合形式解，并确定通过 $x = L$ 处等温边界离开平板的单位面积热通量。您的推导必须从第一性原理出发，除了这些基本定律外，不得引用任何预先推导出的热传导方程。\n\n以 $k_0$、$\\beta$、 $q_0$、 $L$、 $T_s$ 和 $x$ 的解析表达式形式给出您的最终结果。不需要进行数值计算。最终答案必须是单一的复合解析表达式。如果提供多个表达式，它们必须作为单行矩阵的条目放置。最终的方框答案中不要包含单位。",
            "solution": "首先对问题进行验证，以确保其科学上合理、内容独立完备且提法恰当。\n\n**步骤1：提取已知条件**\n- 平板区域：$0 \\le x \\le L$。\n- 随温度变化的热导率：$k(T) = k_0 (1 + \\beta T)$，其中 $k_0  0$。\n- 体积内热生成：$q_0  0$，均匀且稳定。\n- $x=0$ 处的边界条件：绝热。\n- $x=L$ 处的边界条件：等温，温度为 $T_s$。\n- 假设：一维稳态热传导；忽略对流和辐射；$k(T)  0$ 在整个区域内成立，即对于所有 $x \\in [0, L]$ 都有 $1 + \\beta T(x)  0$。\n- 要求推导：$T(x)$ 和在 $x=L$ 处的热通量，从能量守恒积分形式和傅里叶定律出发。\n\n**步骤2：验证与结论**\n该问题描述了工程热传学中的一个经典场景。其物理基础是热力学第一定律（能量守恒）和傅里叶传导定律。对于随温度变化的热导率，线性模型是一种常用且有效的近似。该问题指定了一个诺伊曼(Neumann)边界条件（在 $x=0$ 处）和一个狄利克雷(Dirichlet)边界条件（在 $x=L$ 处），这为底层的二阶微分方程构成了一个适定边值问题。所有给定的常数和条件在物理上是现实的，在数学上是一致的。该问题被判定为**有效**。\n\n**步骤3：推导**\n\n我们首先将稳态能量守恒原理应用于一个微分控制体，该控制体由厚度为 $\\Delta x$、横截面积为 $A$ 的平板薄片定义，位于空间坐标 $x$ 和 $x + \\Delta x$ 之间。能量平衡的积分形式为：\n$$ \\dot{E}_{in} - \\dot{E}_{out} + \\dot{E}_{gen} = \\dot{E}_{st} $$\n对于稳态条件，能量储存率 $\\dot{E}_{st}$ 为零。能量传递项为：\n- 在 $x$ 处传入的能量传导率：$\\dot{E}_{in} = q_x A$，其中 $q_x$ 是单位面积的热通量。\n- 在 $x + \\Delta x$ 处传出的能量传导率：$\\dot{E}_{out} = q_{x+\\Delta x} A$。\n- 内热生成率：$\\dot{E}_{gen} = q_0 (A \\Delta x)$，因为 $q_0$ 是单位体积的生成率。\n\n将这些项代入能量平衡方程，得到：\n$$ q_x A - q_{x+\\Delta x} A + q_0 A \\Delta x = 0 $$\n除以微元的体积 $A \\Delta x$，我们得到：\n$$ \\frac{q_x - q_{x+\\Delta x}}{\\Delta x} + q_0 = 0 $$\n取 $\\Delta x \\to 0$ 的极限，得到能量守恒方程的微分形式：\n$$ -\\frac{dq_x}{dx} + q_0 = 0 $$\n傅里叶热传导定律将热通量 $q_x$ 与温度梯度 $\\frac{dT}{dx}$ 联系起来：\n$$ q_x(x) = -k(T) \\frac{dT}{dx} $$\n将傅里叶定律代入能量守恒方程，得到温度场 $T(x)$ 的控制微分方程：\n$$ \\frac{d}{dx}\\left(k(T) \\frac{dT}{dx}\\right) + q_0 = 0 $$\n我们将此方程对 $x$ 积分一次：\n$$ \\int \\frac{d}{dx}\\left(k(T) \\frac{dT}{dx}\\right) dx = \\int -q_0 dx $$\n$$ k(T) \\frac{dT}{dx} = -q_0 x + C_1 $$\n其中 $C_1$ 是一个积分常数。为了确定 $C_1$，我们使用 $x=0$ 处的边界条件，即完全绝热。这意味着在该边界处的热通量为零，即 $q_x(0) = 0$。根据傅里叶定律，$q_x(0) = -k(T(0))\\frac{dT}{dx}\\big|_{x=0} = 0$。在 $x=0$ 处计算积分后的方程：\n$$ k(T(0))\\frac{dT}{dx}\\big|_{x=0} = -q_0 (0) + C_1 \\implies -q_x(0) = C_1 \\implies 0 = C_1 $$\n因此，常数 $C_1$ 为零，方程简化为：\n$$ k(T) \\frac{dT}{dx} = -q_0 x $$\n这为热通量提供了一个直接的表达式：$q_x(x) = -k(T)\\frac{dT}{dx} = -(-q_0 x) = q_0 x$。\n\n为了求得温度场 $T(x)$，我们代入给定的热导率表达式 $k(T) = k_0(1+\\beta T)$：\n$$ k_0(1+\\beta T) \\frac{dT}{dx} = -q_0 x $$\n这是一个可分离的常微分方程。我们分离变量并积分：\n$$ \\int k_0(1+\\beta T) dT = \\int -q_0 x dx $$\n$$ k_0 \\left(T + \\frac{\\beta}{2}T^2\\right) = -\\frac{q_0}{2}x^2 + C_2 $$\n常数 $C_2$ 通过使用 $x=L$ 处的第二个边界条件确定，该处的温度固定为 $T(L) = T_s$：\n$$ k_0 \\left(T_s + \\frac{\\beta}{2}T_s^2\\right) = -\\frac{q_0}{2}L^2 + C_2 $$\n求解 $C_2$：\n$$ C_2 = k_0 T_s + \\frac{k_0\\beta}{2}T_s^2 + \\frac{q_0}{2}L^2 $$\n将 $C_2$ 代回 $T(x)$ 的解中：\n$$ k_0 \\left(T(x) + \\frac{\\beta}{2}T(x)^2\\right) = -\\frac{q_0}{2}x^2 + k_0 T_s + \\frac{k_0\\beta}{2}T_s^2 + \\frac{q_0}{2}L^2 $$\n整理各项，我们得到一个关于 $T(x)$ 的二次方程：\n$$ \\frac{k_0\\beta}{2}T(x)^2 + k_0 T(x) - \\left[ \\frac{q_0}{2}(L^2 - x^2) + k_0 T_s + \\frac{k_0\\beta}{2}T_s^2 \\right] = 0 $$\n求解这个关于 $T(x)$ 的二次方程，得到：\n$$ T(x) = \\frac{-k_0 \\pm \\sqrt{k_0^2 - 4\\left(\\frac{k_0\\beta}{2}\\right)\\left( -\\left[ \\frac{q_0}{2}(L^2 - x^2) + k_0 T_s + \\frac{k_0\\beta}{2}T_s^2 \\right] \\right)}}{2\\left(\\frac{k_0\\beta}{2}\\right)} $$\n$$ T(x) = -\\frac{1}{\\beta} \\pm \\frac{1}{k_0\\beta} \\sqrt{k_0^2 + k_0\\beta q_0(L^2-x^2) + 2k_0^2\\beta T_s + k_0^2\\beta^2 T_s^2} $$\n平方根下的项可以简化为：\n$$ \\sqrt{k_0^2(1 + 2\\beta T_s + \\beta^2 T_s^2) + k_0\\beta q_0(L^2 - x^2)} = \\sqrt{k_0^2(1+\\beta T_s)^2 + k_0\\beta q_0(L^2-x^2)} $$\n因此，$T(x)$ 的解是：\n$$ T(x) = -\\frac{1}{\\beta} \\pm \\frac{1}{\\beta}\\sqrt{(1+\\beta T_s)^2 + \\frac{\\beta q_0}{k_0}(L^2-x^2)} $$\n我们必须根据物理约束 $k(T) = k_0(1+\\beta T)  0$ 来选择符号。这意味着 $1+\\beta T(x)  0$。将我们的 $T(x)$ 表达式乘以 $\\beta$ 再加 1，得到：\n$$ 1 + \\beta T(x) = \\pm \\sqrt{(1+\\beta T_s)^2 + \\frac{\\beta q_0}{k_0}(L^2-x^2)} $$\n由于平方根总是非负的，且我们要求 $1+\\beta T(x)0$，因此必须选择正号。温度场的最终表达式为：\n$$ T(x) = -\\frac{1}{\\beta} + \\frac{1}{\\beta} \\sqrt{(1 + \\beta T_s)^2 + \\frac{\\beta q_0}{k_0}(L^2 - x^2)} $$\n第二个要确定的量是在 $x=L$ 处离开平板的单位面积热通量，记为 $q_x(L)$。根据我们之前的发现，任意位置 $x$ 处的热通量由 $q_x(x) = q_0 x$ 给出。在 $x=L$ 处计算该式：\n$$ q_x(L) = q_0 L $$\n这个结果与全局能量平衡是一致的：在稳态下，平板内单位面积产生的总热量 $\\int_0^L q_0 dx = q_0 L$，必须通过边界排出。由于 $x=0$ 处的边界是绝热的（$q_x(0)=0$），所有产生的热量都必须通过 $x=L$ 处的边界离开。\n\n所要求的两个表达式是温度场 $T(x)$ 和在 $x=L$ 处的热通量。",
            "answer": "$$ \\boxed{\\begin{pmatrix} -\\frac{1}{\\beta} + \\frac{1}{\\beta} \\sqrt{(1 + \\beta T_s)^2 + \\frac{\\beta q_0}{k_0}(L^2 - x^2)}  q_0 L \\end{pmatrix}} $$"
        },
        {
            "introduction": "从解析解过渡到计算方法，我们现在关注有限体积法（FVM）中的一个关键步骤：源项的处理。本计算练习  要求你针对多种非均匀热源分布 $q'''(x)$，编程实现并比较两种离散源项的计算方法。通过量化常见简化方法所引入的误差，你将深刻理解精确的源项积分对于保证数值模拟整体保真度的重要性。",
            "id": "3960350",
            "problem": "考虑一个长度为 $L$、横截面积恒为 $A$ 的板中的一维稳态热传导，其内部有体积热源 $q'''(x)$，其中 $x$ 表示以米为单位的空间坐标。从能量守恒出发，有限体积法（FVM）对每个控制体积上的控制方程进行积分，得到一个离散源项，该源项必须等于 $q'''$ 在该控制体积上的积分。您的任务是构建一个程序，针对一组指定的测试用例，演示如何通过在控制体积上积分 $q'''$ 来正确构建离散源项，并量化用单元中心处的非加权点采样替代该积分所产生的误差。\n\n基本原理：对于有内部热源的稳态热传导，关于温度 $T(x)$ 和热导率 $k$ 的能量守恒定律表明，其控制方程为 $\\nabla \\cdot (k \\nabla T) + q''' = 0$。有限体积法将此方程在每个控制体积 $V_i$ 上积分，得到离散源项 $S_i = \\int_{V_i} q''' \\,\\mathrm{d}V$。对于一个横截面积为 $A$ 的一维板，其控制体积范围为 $[x_{i-1/2}, x_{i+1/2}]$，离散源项为 $S_i = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\,\\mathrm{d}x$。定义体积加权平均值 $\\overline{q'''}_i = \\dfrac{1}{V_i} \\int_{V_i} q''' \\,\\mathrm{d}V$，其中 $V_i = A \\Delta x_i$，并注意到 $S_i = \\overline{q'''}_i V_i$。一种简单的非加权替代方法是 $S_i^{\\mathrm{center}} = A \\, q'''(x_i^{\\mathrm{c}}) \\, \\Delta x_i$，其中 $x_i^{\\mathrm{c}} = \\dfrac{x_{i-1/2} + x_{i+1/2}}{2}$ 是单元中心。本程序将在几种情况下，比较所有控制体积的 $S_i$ 和 $S_i^{\\mathrm{center}}$。\n\n您必须实现一个程序，对每个测试用例计算：\n1. 使用 $q'''(x)$ 的解析不定积分，计算每个控制体积的精确离散源项 $S_i = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\,\\mathrm{d}x$。\n2. 点采样近似值 $S_i^{\\mathrm{center}} = A \\, q'''(x_i^{\\mathrm{c}}) \\, \\Delta x_i$。\n3. 所有控制体积中的最大相对误差，定义为 $e_{\\max} = \\max_i \\left( \\left| S_i^{\\mathrm{center}} - S_i \\right| \\big/ \\left| S_i \\right| \\right)$，表示为无单位小数。\n4. 精确的总积分源项 $S_{\\mathrm{tot}} = \\sum_i S_i$，以瓦特（W）为单位表示。\n\n通过使用物理上合理的量级和维度，确保科学真实性和计算一致性。所有量都必须使用国际单位制（SI units）处理。在适用物理单位的地方，您必须用指定的单位表示数值。\n\n测试套件：\n- 案例 1（恒定热源，均匀网格）：\n  - $L = 0.2$ m, $A = 0.01$ m$^2$。\n  - 均匀网格，含 10 个单元，每个宽度为 0.02 m。\n  - $q'''(x) = 1.0 \\times 10^6$ W/m$^3$。\n  - 要求输出：$e_{\\max}$（无单位）和 $S_{\\mathrm{tot}}$（单位 W）。\n\n- 案例 2（线性变化，非均匀网格）：\n  - $L = 0.2$ m, $A = 0.01$ m$^2$。\n  - 非均匀网格，宽度为 $[0.02, 0.03, 0.05, 0.04, 0.06]$ m。\n  - $q'''(x) = 2.0 \\times 10^6 + 1.0 \\times 10^7 \\, x$ W/m$^3$。\n  - 要求输出：$e_{\\max}$（无单位）和 $S_{\\mathrm{tot}}$（单位 W）。\n\n- 案例 3（正弦变化，均匀网格）：\n  - $L = 0.2$ m, $A = 0.01$ m$^2$。\n  - 均匀网格，含 8 个单元，每个宽度为 0.025 m。\n  - $q'''(x) = 4.0 \\times 10^6 + 3.0 \\times 10^6 \\, \\sin\\left( \\dfrac{2\\pi x}{0.05} \\right)$ W/m$^3$。\n  - 要求输出：$e_{\\max}$（无单位）和 $S_{\\mathrm{tot}}$（单位 W）。\n\n- 案例 4（指数变化，强非均匀网格）：\n  - $L = 0.2$ m, $A = 0.01$ m$^2$。\n  - 非均匀网格，宽度为 $[0.08, 0.05, 0.03, 0.02, 0.02]$ m。\n  - $q'''(x) = 1.0 \\times 10^6 \\exp(20x)$ W/m$^3$。\n  - 要求输出：$e_{\\max}$（无单位）和 $S_{\\mathrm{tot}}$（单位 W）。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含案例 1 到 4 的结果，即最大相对误差（无单位小数）后跟精确的总积分源项（单位瓦特），因此最终输出必须为 $[e_{\\max,1},S_{\\mathrm{tot},1},e_{\\max,2},S_{\\mathrm{tot},2},e_{\\max,3},S_{\\mathrm{tot},3},e_{\\max,4},S_{\\mathrm{tot},4}]$ 的形式。",
            "solution": "问题陈述已经过验证，被认为是合理、独立且科学严谨的。它提出了热工领域一个适定的计算问题。\n\n此问题的核心在于一维稳态热传导问题中，有限体积法（FVM）对源项的数值近似。控制微分方程由下式给出：\n$$\n\\nabla \\cdot (k \\nabla T) + q'''(x) = 0\n$$\n其中 $k$ 是热导率，$T$ 是温度，$q'''(x)$ 是单位体积的内部热源生成率。在一维情况下，该方程简化为：\n$$\n\\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) + q'''(x) = 0\n$$\n有限体积法将空间域离散为有限数量的控制体积（单元）。将控制方程在对应于区间 $[x_{i-1/2}, x_{i+1/2}]$ 的控制体积 $V_i$ 上积分，得到：\n$$\n\\int_{V_i} \\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) dV + \\int_{V_i} q'''(x) dV = 0\n$$\n对于横截面积恒为 $A$ 的板，体积元为 $dV = A dx$。第一项代表穿过控制体积边界的净热通量，通过离散化通量项来处理。第二项是积分源项 $S_i$：\n$$\nS_i = \\int_{V_i} q'''(x) dV = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) dx\n$$\n必须为每个控制体积计算此积分。在可行的情况下，最精确的方法是使用 $q'''(x)$ 的解析不定积分。设 $Q(x) = \\int q'''(x) dx$。那么，根据微积分基本定理：\n$$\nS_i = A \\left[ Q(x_{i+1/2}) - Q(x_{i-1/2}) \\right]\n$$\n一种常见且更简单的数值近似是假设 $q'''(x)$ 在控制体积上是恒定的，且等于其在单元中心 $x_i^{\\mathrm{c}} = (x_{i-1/2} + x_{i+1/2})/2$ 处的值。这等效于使用中点法则进行数值积分。近似源项 $S_i^{\\mathrm{center}}$ 为：\n$$\nS_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot (x_{i+1/2} - x_{i-1/2}) = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i\n$$\n此问题要求对这两种方法进行定量比较。中点法则近似的误差与被积函数的二阶导数有关。具体来说，积分的误差项约为 $\\frac{f''(\\xi)}{24}(\\Delta x)^3$，其中 $\\xi$ 在区间内。因此，如果 $q'''(x)$ 是常数或线性的（因为其二阶导数为零），源项的相对误差 $e_i = |S_i^{\\mathrm{center}} - S_i| / |S_i|$ 预计为零；对于更高阶的函数，则为非零。\n\n我们现在将分析每个测试用例。\n\n**案例 1：恒定热源生成**\n-   $q'''(x) = C_1 = 1.0 \\times 10^6 \\, \\text{W/m}^3$。\n-   不定积分为 $Q(x) = C_1 x$。\n-   精确源项为 $S_i = A [C_1 x_{i+1/2} - C_1 x_{i-1/2}] = A C_1 \\Delta x_i$。\n-   近似源项为 $S_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i = A C_1 \\Delta x_i$。\n-   由于 $S_i = S_i^{\\mathrm{center}}$，误差 $e_{\\max}$ 精确为 $0$。\n-   总源项为 $S_{\\mathrm{tot}} = \\sum S_i = A C_1 \\sum \\Delta x_i = A C_1 L = (0.01)(1.0 \\times 10^6)(0.2) = 2000 \\, \\text{W}$。\n\n**案例 2：线性热源生成**\n-   $q'''(x) = C_1 + C_2 x$，其中 $C_1 = 2.0 \\times 10^6 \\, \\text{W/m}^3$ 且 $C_2 = 1.0 \\times 10^7 \\, \\text{W/m}^4$。\n-   不定积分为 $Q(x) = C_1 x + \\frac{1}{2} C_2 x^2$。\n-   精确源项为 $S_i = A \\left[ (C_1 x_{i+1/2} + \\frac{1}{2} C_2 x_{i+1/2}^2) - (C_1 x_{i-1/2} + \\frac{1}{2} C_2 x_{i-1/2}^2) \\right] = A \\left[ C_1 \\Delta x_i + \\frac{1}{2} C_2 (x_{i+1/2}^2 - x_{i-1/2}^2) \\right]$。\n-   使用恒等式 $a^2-b^2 = (a-b)(a+b)$ 以及定义 $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ 和 $x_i^{\\mathrm{c}} = (x_{i+1/2} + x_{i-1/2})/2$，我们得到 $S_i = A [C_1 \\Delta x_i + C_2 \\Delta x_i x_i^{\\mathrm{c}}] = A (C_1 + C_2 x_i^{\\mathrm{c}}) \\Delta x_i$。\n-   近似源项为 $S_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i = A (C_1 + C_2 x_i^{\\mathrm{c}}) \\Delta x_i$。\n-   与恒定情况一样，$S_i = S_i^{\\mathrm{center}}$，所以误差 $e_{\\max}$ 精确为 $0$。\n-   总源项为 $S_{\\mathrm{tot}} = A \\int_0^L (C_1 + C_2 x) dx = A [C_1 L + \\frac{1}{2} C_2 L^2] = 0.01 [ (2 \\times 10^6)(0.2) + 0.5(10^7)(0.2)^2 ] = 6000 \\, \\text{W}$。\n\n**案例 3：正弦热源生成**\n-   $q'''(x) = C_1 + C_2 \\sin(kx)$，其中 $C_1 = 4.0 \\times 10^6$，$C_2 = 3.0 \\times 10^6$，且 $k = \\frac{2\\pi}{0.05} = 40\\pi \\, \\text{m}^{-1}$。\n-   该函数是非线性的，所以预计会产生非零误差。\n-   不定积分为 $Q(x) = C_1 x - \\frac{C_2}{k} \\cos(kx)$。\n-   精确源项为 $S_i = A \\left[ (C_1 x_{i+1/2} - \\frac{C_2}{k} \\cos(kx_{i+1/2})) - (C_1 x_{i-1/2} - \\frac{C_2}{k} \\cos(kx_{i-1/2})) \\right]$。\n-   近似源项为 $S_i^{\\mathrm{center}} = A (C_1 + C_2 \\sin(kx_i^{\\mathrm{c}})) \\Delta x_i$。\n-   将对 8 个单元中的每一个进行数值计算，以找出最大相对误差 $e_{\\max}$。\n-   总源项为 $S_{\\mathrm{tot}} = A \\int_0^L q'''(x) dx = A [C_1 L - \\frac{C_2}{k}(\\cos(kL) - \\cos(0))]$。当 $L=0.2$ m 时，$kL = 40\\pi(0.2) = 8\\pi$。由于 $\\cos(8\\pi) = 1$，正弦部分在整个域上的积分为零。\n-   $S_{\\mathrm{tot}} = A C_1 L = (0.01)(4.0 \\times 10^6)(0.2) = 8000 \\, \\text{W}$。\n\n**案例 4：指数热源生成**\n-   $q'''(x) = C_1 \\exp(kx)$，其中 $C_1 = 1.0 \\times 10^6 \\, \\text{W/m}^3$ 且 $k=20 \\, \\text{m}^{-1}$。\n-   此函数也是非线性的，会产生非零误差。\n-   不定积分为 $Q(x) = \\frac{C_1}{k} \\exp(kx)$。\n-   精确源项为 $S_i = A \\frac{C_1}{k} [\\exp(kx_{i+1/2}) - \\exp(kx_{i-1/2})]$。\n-   近似源项为 $S_i^{\\mathrm{center}} = A (C_1 \\exp(kx_i^{\\mathrm{c}})) \\Delta x_i$。\n-   将对非均匀网格上的每个单元计算误差。中点法则的误差与 $(\\Delta x)^2$ 成正比，因此我们预计最大误差将出现在宽度最大的单元中，即 $\\Delta x = 0.08$ m。\n-   总源项为 $S_{\\mathrm{tot}} = A \\int_0^L C_1 e^{kx} dx = A \\frac{C_1}{k} [e^{kx}]_0^L = A \\frac{C_1}{k} (e^{kL}-1)$。\n-   $S_{\\mathrm{tot}} = (0.01) \\frac{1.0 \\times 10^6}{20} (e^{20 \\times 0.2} - 1) = 500(e^4 - 1) \\approx 26799.0751 \\, \\text{W}$。\n\n以下程序为所有案例系统地实现了这些计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the final result.\n    The primary logic is encapsulated in the solve_case function.\n    \"\"\"\n\n    def solve_case(L, A, mesh_widths, q_func, Q_func):\n        \"\"\"\n        Calculates the maximum relative error and total exact source for a single test case.\n\n        Args:\n            L (float): Total length of the slab.\n            A (float): Cross-sectional area of the slab.\n            mesh_widths (list[float]): A list of cell widths.\n            q_func (callable): The volumetric heat generation function q'''(x).\n            Q_func (callable): The analytic antiderivative of q'''(x).\n\n        Returns:\n            tuple[float, float]: A tuple containing the maximum relative error (e_max)\n                                 and the total exact integrated source (S_tot).\n        \"\"\"\n        # Construct the mesh by defining the coordinates of cell faces\n        # starting from x=0.\n        cell_faces = np.cumsum([0.0] + mesh_widths)\n        num_cells = len(mesh_widths)\n\n        relative_errors = []\n        total_source_exact = 0.0\n\n        for i in range(num_cells):\n            x_left = cell_faces[i]\n            x_right = cell_faces[i+1]\n            delta_x = x_right - x_left\n            x_center = (x_left + x_right) / 2.0\n\n            # 1. Exact discrete source term using the antiderivative\n            # S_i = A * integral from x_left to x_right of q'''(x) dx\n            S_exact = A * (Q_func(x_right) - Q_func(x_left))\n\n            # 2. Point-sampled approximation at the cell center\n            # S_i_center = A * q'''(x_center) * delta_x\n            S_approx = A * q_func(x_center) * delta_x\n\n            # 3. Relative error for the current cell\n            # The problem statement guarantees S_exact is non-zero for all cases.\n            if S_exact != 0:\n                error = abs(S_approx - S_exact) / abs(S_exact)\n            else:\n                # This case is avoided by problem design, but handled for completeness.\n                error = 0.0 if S_approx == 0.0 else float('inf')\n            \n            relative_errors.append(error)\n            total_source_exact += S_exact\n        \n        # 4. Maximum relative error across all control volumes\n        max_relative_error = max(relative_errors) if relative_errors else 0.0\n\n        # Optional check: The sum of cell-wise integrals must equal the total integral\n        # total_source_check = A * (Q_func(L) - Q_func(0.0))\n        # assert np.isclose(total_source_exact, total_source_check)\n        \n        return max_relative_error, total_source_exact\n\n    # --- Define Test Cases ---\n    \n    # Common parameters\n    L = 0.2\n    A = 0.01\n\n    test_cases = [\n        # Case 1: Constant generation, uniform mesh\n        {\n            'mesh_widths': [0.02] * 10,\n            'q_func': lambda x: 1.0e6,\n            'Q_func': lambda x: 1.0e6 * x\n        },\n        # Case 2: Linear variation, nonuniform mesh\n        {\n            'mesh_widths': [0.02, 0.03, 0.05, 0.04, 0.06],\n            'q_func': lambda x: 2.0e6 + 1.0e7 * x,\n            'Q_func': lambda x: 2.0e6 * x + 0.5 * 1.0e7 * x**2\n        },\n        # Case 3: Sinusoidal variation, uniform mesh\n        {\n            'mesh_widths': [0.025] * 8,\n            'q_func': lambda x, c1=4.0e6, c2=3.0e6, k=2*np.pi/0.05: c1 + c2 * np.sin(k * x),\n            'Q_func': lambda x, c1=4.0e6, c2=3.0e6, k=2*np.pi/0.05: c1 * x - (c2 / k) * np.cos(k * x)\n        },\n        # Case 4: Exponential variation, strongly nonuniform mesh\n        {\n            'mesh_widths': [0.08, 0.05, 0.03, 0.02, 0.02],\n            'q_func': lambda x, c1=1.0e6, k=20.0: c1 * np.exp(k * x),\n            'Q_func': lambda x, c1=1.0e6, k=20.0: (c1 / k) * np.exp(k * x)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        e_max, S_tot = solve_case(\n            L, A, case['mesh_widths'], case['q_func'], case['Q_func']\n        )\n        results.extend([e_max, S_tot])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}