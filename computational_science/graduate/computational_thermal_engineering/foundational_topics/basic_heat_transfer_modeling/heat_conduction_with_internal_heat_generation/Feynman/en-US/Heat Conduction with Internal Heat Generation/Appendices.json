{
    "hands_on_practices": [
        {
            "introduction": "Before solving any heat transfer problem, one must correctly define the computational or analytical domain and its boundary conditions. This exercise  serves as a crucial thought experiment on the physical and mathematical implications of symmetry. By comparing a fully symmetric domain with a half-domain utilizing an insulated boundary, you will explore the profound connection between physical symmetry and the mathematical condition of a zero-gradient (adiabatic) boundary, a concept that is foundational for simplifying complex problems and reducing computational cost.",
            "id": "3960364",
            "problem": "A homogeneous slab is characterized by constant thermal conductivity $k$ and a uniform volumetric heat generation rate $q'''$. Consider steady, one-dimensional conduction with spatial coordinate $x$ normal to the slab. Two configurations are examined:\n\n(i) A full slab occupying $-L \\le x \\le +L$ with both external faces held isothermal at temperature $T_s$. Because the external boundary conditions and material are mirror-symmetric about $x=0$, the plane at $x=0$ is a symmetry plane.\n\n(ii) A half slab occupying $0 \\le x \\le L$ with the face at $x=L$ held isothermal at temperature $T_s$ and the face at $x=0$ perfectly insulated. The governing physics must be based on conservation of energy and Fourier’s law of heat conduction, and no other simplifying formulas should be assumed a priori.\n\nUsing first principles, answer the following conceptual and quantitative questions about how symmetry planes and insulated boundaries modify the solution structure for internally heated domains. Select all statements that are correct.\n\nA. In steady, one-dimensional conduction with constant $k$ and uniform $q'''$, both a symmetry plane at $x=0$ and a perfectly insulated boundary at $x=0$ enforce $dT/dx|_{x=0}=0$. Consequently, with $T(L)=T_s$, the temperature profile $T(x)$ obtained on the half-domain $0 \\le x \\le L$ is identical in the two cases.\n\nB. In either configuration with $T(L)=T_s$ and $dT/dx|_{x=0}=0$, the outward heat flux at $x=L$ equals the volumetric heat generation integrated over the half-domain, i.e., $q_x(L)=\\int_0^L q''' \\, dx = q''' L$, where $q_x(x)$ is the heat flux defined by Fourier’s law.\n\nC. In the full slab $-L \\le x \\le +L$ with $T(-L)=T(+L)=T_s$, introducing a midplane symmetry condition at $x=0$ yields a maximum temperature that is half of the maximum temperature obtained in the half-slab with $T(L)=T_s$ and an insulated boundary at $x=0$.\n\nD. In computational modeling, replacing an insulated boundary at $x=0$ by a symmetry plane at $x=0$ is valid for all internally heated problems, regardless of external boundary conditions or material anisotropy.\n\nE. For constant $k$ and uniform $q'''$, the temperature field $T(x)$ has spatially uniform negative curvature throughout the slab, and this curvature does not depend on whether $x=0$ is treated as a symmetry plane or as a perfectly insulated boundary.\n\nF. In the symmetric full-domain problem $-L \\le x \\le +L$ with $T(-L)=T(+L)=T_s$ and uniform $q'''$, the temperature $T(x)$ is an even function of $x$ about $x=0$, while the heat flux $q_x(x)$ is an odd function of $x$ about $x=0$.",
            "solution": "The problem statement describes one-dimensional, steady-state heat conduction in a homogeneous slab with constant thermal conductivity $k$ and uniform volumetric heat generation $q'''$. We must validate the problem statement before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **System**: Homogeneous slab.\n- **Physics**: Steady, one-dimensional conduction.\n- **Coordinate**: $x$, normal to the slab.\n- **Properties**: Constant thermal conductivity $k$, uniform volumetric heat generation rate $q'''$.\n- **Governing Laws**: Conservation of energy, Fourier's law of heat conduction ($q_x = -k \\frac{dT}{dx}$).\n- **Configuration (i)**:\n    - Domain: $-L \\le x \\le +L$.\n    - Boundary Conditions (BCs): $T(-L) = T_s$ and $T(L) = T_s$.\n    - Implication: The plane at $x=0$ is a symmetry plane.\n- **Configuration (ii)**:\n    - Domain: $0 \\le x \\le L$.\n    - BCs: The face at $x=0$ is perfectly insulated, and the face at $x=L$ is held at $T(L) = T_s$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a canonical case of heat conduction with internal generation.\n- **Scientifically Grounded**: The problem is based on the fundamental principles of heat transfer (the heat diffusion equation derived from energy conservation and Fourier's law). It is a standard, well-established problem in thermal engineering.\n- **Well-Posed**: For both configurations, a second-order ordinary differential equation governs the temperature, and two boundary conditions are provided, ensuring a unique solution exists.\n- **Objective**: The problem is stated using precise, unambiguous scientific language.\n- **Flaws**: The problem statement is free from scientific unsoundness, ambiguity, missing information, or contradictions. It is a valid, formalizable problem.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. We may proceed with the solution derivation.\n\n### Derivation from First Principles\n\nThe general one-dimensional heat diffusion equation is:\n$$ \\frac{\\partial}{\\partial x} \\left( k \\frac{\\partial T}{\\partial x} \\right) + q''' = \\rho c_p \\frac{\\partial T}{\\partial t} $$\nApplying the given conditions (steady-state $\\frac{\\partial T}{\\partial t} = 0$, constant $k$, uniform $q'''$), the equation simplifies to a second-order ordinary differential equation:\n$$ k \\frac{d^2 T}{dx^2} + q''' = 0 $$\n$$ \\frac{d^2 T}{dx^2} = -\\frac{q'''}{k} $$\nThis equation governs the temperature distribution $T(x)$ in both configurations. Integrating once with respect to $x$ gives the temperature gradient:\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k} x + C_1 $$\nIntegrating a second time gives the general solution for the a temperature profile:\n$$ T(x) = -\\frac{q'''}{2k} x^2 + C_1 x + C_2 $$\nThe constants $C_1$ and $C_2$ are determined by applying the boundary conditions for each case.\n\n**Analysis of the Half-Domain ($0 \\le x \\le L$)**\nLet's analyze the problem on the domain $0 \\le x \\le L$.\n- For **Configuration (i)**, the problem is symmetric about $x=0$. Due to the symmetric geometry, material properties, heat generation, and boundary conditions ($T(-L)=T(L)$), the temperature profile must be an even function, $T(x) = T(-x)$. The derivative of an even function is an odd function, so $\\frac{dT}{dx}$ must be zero at $x=0$. Thus, the symmetry condition at the midplane $x=0$ imposes the boundary condition $\\frac{dT}{dx}|_{x=0}=0$.\n- For **Configuration (ii)**, the boundary at $x=0$ is perfectly insulated. This means the heat flux at this boundary is zero. According to Fourier's law, $q_x(0) = -k \\frac{dT}{dx}|_{x=0} = 0$. Since $k$ is a non-zero positive constant, this also imposes the boundary condition $\\frac{dT}{dx}|_{x=0}=0$.\n\nBoth configurations, when viewed on the domain $0 \\le x \\le L$, share the same boundary conditions:\n1. At $x=0$: $\\frac{dT}{dx}|_{x=0} = 0$.\n2. At $x=L$: $T(L) = T_s$.\n\nApplying the first condition to the gradient equation:\n$$ \\frac{dT}{dx}|_{x=0} = -\\frac{q'''}{k}(0) + C_1 = 0 \\implies C_1 = 0 $$\nWith $C_1 = 0$, the temperature profile becomes:\n$$ T(x) = -\\frac{q'''}{2k} x^2 + C_2 $$\nApplying the second condition to find $C_2$:\n$$ T(L) = T_s = -\\frac{q'''}{2k} L^2 + C_2 \\implies C_2 = T_s + \\frac{q''' L^2}{2k} $$\nSubstituting $C_2$ back, we get the specific temperature profile for both configurations on the domain $0 \\le x \\le L$:\n$$ T(x) = T_s + \\frac{q''' L^2}{2k} - \\frac{q'''}{2k} x^2 = T_s + \\frac{q'''}{2k}(L^2 - x^2) $$\n\n### Option-by-Option Analysis\n\n**A. In steady, one-dimensional conduction with constant $k$ and uniform $q'''$, both a symmetry plane at $x=0$ and a perfectly insulated boundary at $x=0$ enforce $dT/dx|_{x=0}=0$. Consequently, with $T(L)=T_s$, the temperature profile $T(x)$ obtained on the half-domain $0 \\le x \\le L$ is identical in the two cases.**\nAs shown in the derivation above, a symmetry plane in a symmetric problem implies $T(x)$ is even, so its derivative is odd and must be $0$ at $x=0$. An insulated boundary implies zero heat flux, which by Fourier's law ($q_x = -k \\frac{dT}{dx}$) means $\\frac{dT}{dx}=0$. So, both conditions impose $\\frac{dT}{dx}|_{x=0}=0$. Since the governing differential equation and the other boundary condition ($T(L)=T_s$) are also identical for the domain $0 \\le x \\le L$, the resulting boundary value problem is identical. By the existence and uniqueness theorem for such problems, the solution $T(x)$ must be identical.\n**Verdict: Correct.**\n\n**B. In either configuration with $T(L)=T_s$ and $dT/dx|_{x=0}=0$, the outward heat flux at $x=L$ equals the volumetric heat generation integrated over the half-domain, i.e., $q_x(L)=\\int_0^L q''' \\, dx = q''' L$, where $q_x(x)$ is the heat flux defined by Fourier’s law.**\nWe can verify this in two ways. First, by an energy balance on the control volume $0 \\le x \\le L$. In steady state, the rate of energy generated within the volume must equal the net rate of energy leaving the volume.\n$$ E_{gen} = E_{out} - E_{in} $$\nPer unit area, the generation rate is $\\int_0^L q''' dx = q'''L$. The flux out at $x=L$ is $q_x(L)$ and the flux in at $x=0$ is $q_x(0)$. Since the boundary at $x=0$ is adiabatic ($\\frac{dT}{dx}=0 \\implies q_x(0)=0$), the balance becomes $q'''L = q_x(L) - 0$. Thus, $q_x(L) = q'''L$.\nSecond, using the derived solution. The heat flux is $q_x(x) = -k \\frac{dT}{dx}$. From our derivation, with $C_1=0$, $\\frac{dT}{dx} = -\\frac{q'''}{k}x$. Therefore, $q_x(x) = -k(-\\frac{q'''}{k}x) = q'''x$. At $x=L$, the flux is $q_x(L) = q'''L$.\n**Verdict: Correct.**\n\n**C. In the full slab $-L \\le x \\le +L$ with $T(-L)=T(+L)=T_s$, introducing a midplane symmetry condition at $x=0$ yields a maximum temperature that is half of the maximum temperature obtained in the half-slab with $T(L)=T_s$ and an insulated boundary at $x=0$.**\nThe temperature is maximum where $\\frac{dT}{dx}=0$, which occurs at $x=0$ in both cases. The temperature profile on the domain $0 \\le x \\le L$ is identical for both configurations, as established in A.\nThe maximum temperature is $T_{max} = T(0)$. Using the derived profile $T(x) = T_s + \\frac{q'''}{2k}(L^2 - x^2)$:\n$$ T_{max} = T(0) = T_s + \\frac{q'''}{2k}(L^2 - 0) = T_s + \\frac{q'''L^2}{2k} $$\nThis is the maximum temperature for both configuration (i) (the full symmetric slab) and configuration (ii) (the half-slab with insulation). The maximum temperatures are identical, not in a $1:2$ ratio. The statement is false. Note that temperature is an affine quantity, so taking ratios of absolute temperatures (in Kelvin or Rankine) is seldom meaningful unless they are differences. Even if we compared the temperature rise $\\Delta T_{max} = T_{max}-T_s = \\frac{q'''L^2}{2k}$, they are still identical.\n**Verdict: Incorrect.**\n\n**D. In computational modeling, replacing an insulated boundary at $x=0$ by a symmetry plane at $x=0$ is valid for all internally heated problems, regardless of external boundary conditions or material anisotropy.**\nThis statement is a broad generalization that is false. The equivalence shown in this specific problem relies on the fact that the larger problem being modeled is perfectly symmetric. An insulated boundary condition at $x=0$ does not, by itself, guarantee that the problem is symmetric about $x=0$. For example, if the heat generation were a function of $x$, say $q'''(x) = c_0 x$, or if the boundary condition at the other end was convective into a fluid whose temperature varied with time, the problem would not be symmetric. Furthermore, if the material were anisotropic, the insulated boundary condition at $x=0$ for a 2D/3D problem is $\\mathbf{q} \\cdot \\mathbf{n} = 0$, which does not necessarily simplify to $\\frac{\\partial T}{\\partial x}=0$, while the symmetry condition always requires it. The replacement is only valid when the physical problem being modeled is genuinely symmetric about that plane.\n**Verdict: Incorrect.**\n\n**E. For constant $k$ and uniform $q'''$, the temperature field $T(x)$ has spatially uniform negative curvature throughout the slab, and this curvature does not depend on whether $x=0$ is treated as a symmetry plane or as a perfectly insulated boundary.**\nIn one dimension, the curvature of the function $T(x)$ is colloquially represented by its second derivative, $\\frac{d^2T}{dx^2}$. From the governing equation, we have:\n$$ \\frac{d^2 T}{dx^2} = -\\frac{q'''}{k} $$\nSince $q'''$ (heat generation) is a non-negative constant and $k$ is a positive constant, their ratio is a non-negative constant. Assuming $q'''>0$, the second derivative is a negative constant. This means the curvature is negative and uniform (it does not vary with $x$). This value is determined by the governing equation itself, which depends only on material properties ($k$) and internal sources ($q'''$), not on the boundary conditions. The boundary conditions determine the specific parabola (its position and orientation), but not its \"openness\" or curvature.\n**Verdict: Correct.**\n\n**F. In the symmetric full-domain problem $-L \\le x \\le +L$ with $T(-L)=T(+L)=T_s$ and uniform $q'''$, the temperature $T(x)$ is an even function of $x$ about $x=0$, while the heat flux $q_x(x)$ is an odd function of $x$ about $x=0$.**\nThe solution for the full domain is the same as the half-domain solution extended symmetrically. From the half-domain analysis, we have $T(x) = T_s + \\frac{q'''}{2k}(L^2 - x^2)$ for $x \\in [0, L]$. For the full domain $-L \\le x \\le L$, this form is correct throughout.\nLet's check the parity of $T(x)$:\n$$ T(-x) = T_s + \\frac{q'''}{2k}(L^2 - (-x)^2) = T_s + \\frac{q'''}{2k}(L^2 - x^2) = T(x) $$\nSo, $T(x)$ is an even function.\nNow, let's find the heat flux $q_x(x) = -k \\frac{dT}{dx}$.\n$$ \\frac{dT}{dx} = \\frac{d}{dx} \\left[ T_s + \\frac{q'''}{2k}(L^2 - x^2) \\right] = \\frac{q'''}{2k}(-2x) = -\\frac{q'''x}{k} $$\n$$ q_x(x) = -k \\left( -\\frac{q'''x}{k} \\right) = q'''x $$\nLet's check the parity of $q_x(x)$:\n$$ q_x(-x) = q'''(-x) = -q'''x = -q_x(x) $$\nSo, $q_x(x)$ is an odd function. This aligns with physical intuition: for $x>0$, heat flows in the $+x$ direction ($q_x>0$), and for $x<0$, heat flows in the $-x$ direction ($q_x<0$), with equal magnitude at $\\pm x$.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ABEF}$$"
        },
        {
            "introduction": "Analytical solutions, where attainable, provide invaluable physical insight. This practice  challenges you to derive the temperature distribution in a classic configuration: a slab with uniform internal heat generation cooled by convection. The goal is to obtain the maximum temperature not just as a formula, but as an expression that clearly reveals its dependence on the Biot number, $\\mathrm{Bi}$. This process solidifies first-principles derivation skills and illuminates the crucial role of the Biot number in relating internal conductive resistance to external convective resistance.",
            "id": "3960425",
            "problem": "A plane wall (slab) of thickness $2L$ has constant thermal conductivity $k$ and a uniform internal volumetric heat generation rate $q'''$. The slab is symmetric about its mid-plane, which we take as the origin of a one-dimensional coordinate system $x \\in [-L, L]$. Both faces at $x = -L$ and $x = +L$ are exposed to the same ambient fluid at temperature $T_{\\infty}$ with a uniform convection coefficient $h$. Assume steady state, one-dimensional heat conduction, no radiation, and no axial property variations. \n\nStarting only from conservation of energy on a differential control volume and Fourier’s law of heat conduction, derive the exact expression for the maximum temperature $T_{\\max}$ in the slab. Express your result explicitly in terms of $T_{\\infty}$, $q'''$, $k$, $L$, and the Biot number $\\mathrm{Bi} = \\dfrac{hL}{k}$. \n\nYour derivation should:\n- Formulate the appropriate differential equation governing the temperature field under the stated assumptions.\n- Justify and apply the correct boundary conditions implied by symmetry and convection.\n- Solve for the temperature distribution and identify the location and value of $T_{\\max}$.\n- Reduce the final expression to a closed-form analytic expression that makes the dependence on $\\mathrm{Bi}$ explicit.\n\nExpress the final answer as a single closed-form analytic expression for $T_{\\max}$ in terms of the given parameters. Do not provide intermediate steps in the final answer. Do not include units in the final answer.",
            "solution": "The problem describes steady, one-dimensional heat conduction in a slab with uniform internal generation and symmetric convective boundary conditions. We will derive the temperature distribution from first principles.\n\nThe governing differential equation for steady, one-dimensional heat conduction with constant thermal conductivity $k$ and uniform volumetric heat generation $q'''$ is obtained from an energy balance on a differential control volume:\n$$ \\frac{d^2T}{dx^2} = -\\frac{q'''}{k} $$\n\nWe integrate this equation twice with respect to $x$:\n$$ \\frac{dT}{dx} = -\\frac{q'''}{k}x + C_1 $$\n$$ T(x) = -\\frac{q'''}{2k}x^2 + C_1 x + C_2 $$\nwhere $C_1$ and $C_2$ are integration constants determined by the boundary conditions.\n\nThe problem is symmetric about the mid-plane $x=0$. This physical symmetry implies that the temperature profile must be even, and thus the heat flux at the center must be zero. This gives us our first boundary condition:\n**BC 1 (Symmetry):** At $x=0$, $\\dfrac{dT}{dx} = 0$.\nApplying BC 1 to the gradient equation:\n$$ 0 = -\\frac{q'''}{k}(0) + C_1 \\implies C_1 = 0 $$\nThe temperature profile simplifies to $T(x) = -\\dfrac{q'''}{2k}x^2 + C_2$.\n\nThe second boundary condition is at the surface $x=L$, where heat conducted to the surface is removed by convection to the surrounding fluid. This energy balance is expressed as:\n**BC 2 (Convection):** At $x=L$, $-k\\dfrac{dT}{dx} = h[T(L) - T_{\\infty}]$.\nFrom our gradient equation with $C_1=0$, we have $\\dfrac{dT}{dx} = -\\dfrac{q'''}{k}x$. At $x=L$, this is $\\dfrac{dT}{dx}\\Big|_{x=L} = -\\dfrac{q'''L}{k}$.\nSubstituting this into the convection boundary condition:\n$$ -k\\left(-\\frac{q'''L}{k}\\right) = h[T(L) - T_{\\infty}] $$\n$$ q'''L = h[T(L) - T_{\\infty}] $$\nWe can solve for the surface temperature $T(L)$:\n$$ T(L) = T_{\\infty} + \\frac{q'''L}{h} $$\nNow we use this result to find the second integration constant, $C_2$, by evaluating our temperature profile at $x=L$:\n$$ T(L) = -\\frac{q'''L^2}{2k} + C_2 $$\nEquating the two expressions for $T(L)$:\n$$ T_{\\infty} + \\frac{q'''L}{h} = -\\frac{q'''L^2}{2k} + C_2 $$\n$$ C_2 = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k} $$\nThe full temperature distribution is $T(x) = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k} - \\frac{q'''}{2k}x^2$.\n\nThe maximum temperature $T_{\\max}$ occurs where the gradient is zero, which is at the center of the slab, $x=0$.\n$$ T_{\\max} = T(0) = C_2 = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k} $$\n\nFinally, we express this result in terms of the Biot number, $\\mathrm{Bi} = \\dfrac{hL}{k}$. We can rewrite the term $\\dfrac{q'''L}{h}$ as:\n$$ \\frac{q'''L}{h} = \\frac{q'''L^2}{hL} = \\frac{q'''L^2}{k \\cdot (hL/k)} = \\frac{q'''L^2}{k \\cdot \\mathrm{Bi}} = \\frac{q'''L^2}{2k} \\left(\\frac{2}{\\mathrm{Bi}}\\right) $$\nSubstituting this back into the expression for $T_{\\max}$:\n$$ T_{\\max} = T_{\\infty} + \\frac{q'''L^2}{2k}\\left(\\frac{2}{\\mathrm{Bi}}\\right) + \\frac{q'''L^2}{2k} $$\nFactoring out the common term $\\dfrac{q'''L^2}{2k}$:\n$$ T_{\\max} = T_{\\infty} + \\frac{q'''L^2}{2k} \\left(1 + \\frac{2}{\\mathrm{Bi}}\\right) $$\nThis is the final expression for the maximum temperature.",
            "answer": "$$\\boxed{T_{\\infty} + \\frac{q'''L^2}{2k} \\left( 1 + \\frac{2}{\\mathrm{Bi}} \\right)}$$"
        },
        {
            "introduction": "Moving from analytical models to computational simulation requires translating continuous physical laws into discrete algebraic equations. This coding exercise  focuses on a critical step in the Finite Volume Method (FVM): the treatment of the source term, $q'''$. You will implement and compare an exact integration of the source term against a common point-sampling approximation, quantifying the error for various non-uniform heat generation profiles. This practice is essential for understanding the origins of numerical error and the importance of conservative discretization for ensuring the physical accuracy of a simulation.",
            "id": "3960350",
            "problem": "Consider one-dimensional steady heat conduction in a slab of length $L$ with constant cross-sectional area $A$ and internal volumetric heat generation $q'''(x)$, where $x$ denotes the spatial coordinate measured in meters. Starting from the conservation of energy, the Finite Volume Method (FVM) integrates the governing equation over each control volume to produce a discrete source term that must equal the integral of $q'''$ over that control volume. Your task is to construct a program that, for a set of specified test cases, demonstrates how to correctly form discrete source terms by integrating $q'''$ over control volumes and quantifies the error incurred by replacing the integral with a non-weighted point sample at the cell center.\n\nFundamental base: For steady conduction with internal heat generation, the conservation of energy for temperature $T(x)$ and thermal conductivity $k$ states that the governing equation is $\\nabla \\cdot (k \\nabla T) + q''' = 0$. The FVM integrates this over each control volume $V_i$, yielding a discrete source term $S_i = \\int_{V_i} q''' \\,\\mathrm{d}V$. For a one-dimensional slab with cross-sectional area $A$ and control volume spanning $[x_{i-1/2}, x_{i+1/2}]$, the discrete source term is $S_i = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\,\\mathrm{d}x$. Define the volume-weighted average $\\overline{q'''}_i = \\dfrac{1}{V_i} \\int_{V_i} q''' \\,\\mathrm{d}V$, where $V_i = A \\Delta x_i$, and observe that $S_i = \\overline{q'''}_i V_i$. A naive non-weighted alternative is $S_i^{\\mathrm{center}} = A \\, q'''(x_i^{\\mathrm{c}}) \\, \\Delta x_i$, where $x_i^{\\mathrm{c}} = \\dfrac{x_{i-1/2} + x_{i+1/2}}{2}$ is the cell center. This program will compare $S_i$ against $S_i^{\\mathrm{center}}$ across all control volumes in several scenarios.\n\nYou must implement a program that, for each test case, computes:\n1. The exact discrete source term per control volume $S_i = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\,\\mathrm{d}x$ using an analytic antiderivative of $q'''(x)$.\n2. The point-sampled approximation $S_i^{\\mathrm{center}} = A \\, q'''(x_i^{\\mathrm{c}}) \\, \\Delta x_i$.\n3. The maximum relative error across all control volumes, defined as $e_{\\max} = \\max_i \\left( \\left| S_i^{\\mathrm{center}} - S_i \\right| \\big/ \\left| S_i \\right| \\right)$, expressed as a unitless decimal.\n4. The exact total integrated source $S_{\\mathrm{tot}} = \\sum_i S_i$, expressed in Watts (W).\n\nScientific realism and computational consistency are ensured by using physically plausible magnitudes and dimensions. All quantities must be handled in International System of Units (SI units). Where physical units apply, you must express values in the specified units.\n\nTest suite:\n- Case $1$ (constant generation, uniform mesh):\n  - $L = 0.2$ m, $A = 0.01$ m$^2$.\n  - Uniform mesh with $10$ cells, each of width $0.02$ m.\n  - $q'''(x) = 1.0 \\times 10^6 \\, \\mathrm{W/m}^3$.\n  - Required outputs: $e_{\\max}$ (unitless) and $S_{\\mathrm{tot}}$ in W.\n\n- Case $2$ (linear variation, nonuniform mesh):\n  - $L = 0.2$ m, $A = 0.01$ m$^2$.\n  - Nonuniform mesh with widths $[0.02, 0.03, 0.05, 0.04, 0.06]$ m.\n  - $q'''(x) = (2.0 \\times 10^6 + 1.0 \\times 10^7 \\, x) \\, \\mathrm{W/m}^3$.\n  - Required outputs: $e_{\\max}$ (unitless) and $S_{\\mathrm{tot}}$ in W.\n\n- Case $3$ (sinusoidal variation, uniform mesh):\n  - $L = 0.2$ m, $A = 0.01$ m$^2$.\n  - Uniform mesh with $8$ cells, each of width $0.025$ m.\n  - $q'''(x) = \\left(4.0 \\times 10^6 + 3.0 \\times 10^6 \\, \\sin\\!\\left( \\dfrac{2\\pi x}{0.05} \\right)\\right) \\, \\mathrm{W/m}^3$.\n  - Required outputs: $e_{\\max}$ (unitless) and $S_{\\mathrm{tot}}$ in W.\n\n- Case $4$ (exponential variation, strongly nonuniform mesh):\n  - $L = 0.2$ m, $A = 0.01$ m$^2$.\n  - Nonuniform mesh with widths $[0.08, 0.05, 0.03, 0.02, 0.02]$ m.\n  - $q'''(x) = 1.0 \\times 10^6 \\, \\exp(20 \\, x) \\, \\mathrm{W/m}^3$.\n  - Required outputs: $e_{\\max}$ (unitless) and $S_{\\mathrm{tot}}$ in W.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order, for Cases $1$ through $4$, the maximum relative error (unitless decimal) followed by the exact total integrated source in Watts, so the final output must be of the form $[e_{\\max,1},S_{\\mathrm{tot},1},e_{\\max,2},S_{\\mathrm{tot},2},e_{\\max,3},S_{\\mathrm{tot},3},e_{\\max,4},S_{\\mathrm{tot},4}]$.",
            "solution": "The problem statement has been validated and is deemed sound, self-contained, and scientifically rigorous. It presents a well-posed computational problem in the field of thermal engineering.\n\nThe core of this problem lies in the numerical approximation of the source term in the Finite Volume Method (FVM) for a one-dimensional steady-state heat conduction problem. The governing differential equation is given by:\n$$\n\\nabla \\cdot (k \\nabla T) + q'''(x) = 0\n$$\nwhere $k$ is the thermal conductivity, $T$ is the temperature, and $q'''(x)$ is the volumetric rate of internal heat generation. In one dimension, this simplifies to:\n$$\n\\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) + q'''(x) = 0\n$$\nThe Finite Volume Method discretizes the spatial domain into a finite number of control volumes (cells). Integrating the governing equation over a control volume $V_i$ corresponding to the interval $[x_{i-1/2}, x_{i+1/2}]$ gives:\n$$\n\\int_{V_i} \\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) dV + \\int_{V_i} q'''(x) dV = 0\n$$\nFor a slab of constant cross-sectional area $A$, the volume element is $dV = A dx$. The first term, representing the net heat flux across the control volume boundaries, is handled by discretizing the flux terms. The second term is the integrated source term, $S_i$:\n$$\nS_i = \\int_{V_i} q'''(x) dV = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) dx\n$$\nThis integral must be computed for each control volume. The most accurate approach, when feasible, is to use the analytical antiderivative of $q'''(x)$. Let $Q(x) = \\int q'''(x) dx$. Then, by the fundamental theorem of calculus:\n$$\nS_i = A \\left[ Q(x_{i+1/2}) - Q(x_{i-1/2}) \\right]\n$$\nA common and simpler numerical approximation is to assume that $q'''(x)$ is constant over the control volume and equal to its value at the cell center, $x_i^{\\mathrm{c}} = (x_{i-1/2} + x_{i+1/2})/2$. This is equivalent to using the midpoint rule for numerical integration. The approximate source term, $S_i^{\\mathrm{center}}$, is:\n$$\nS_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot (x_{i+1/2} - x_{i-1/2}) = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i\n$$\nThis problem requires a quantitative comparison of these two methods. The error of the midpoint rule approximation is related to the second derivative of the integrand. Specifically, the error term for the integral is approximately $\\frac{f''(\\xi)}{24}(\\Delta x)^3$ for some $\\xi$ in the interval. Thus, the relative error in the source term, $e_i = |S_i^{\\mathrm{center}} - S_i| / |S_i|$, is expected to be zero if $q'''(x)$ is constant or linear (since its second derivative would be zero), and non-zero for higher-order functions.\n\nWe will now analyze each test case.\n\n**Case 1: Constant Heat Generation**\n-   $q'''(x) = C_1 = 1.0 \\times 10^6 \\, \\mathrm{W/m}^3$.\n-   The antiderivative is $Q(x) = C_1 x$.\n-   The exact source term is $S_i = A [C_1 x_{i+1/2} - C_1 x_{i-1/2}] = A C_1 \\Delta x_i$.\n-   The approximate source term is $S_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i = A C_1 \\Delta x_i$.\n-   Since $S_i = S_i^{\\mathrm{center}}$, the error $e_{\\max}$ is exactly $0$.\n-   The total source is $S_{\\mathrm{tot}} = \\sum S_i = A C_1 \\sum \\Delta x_i = A C_1 L = (0.01)(1.0 \\times 10^6)(0.2) = 2000 \\, \\mathrm{W}$.\n\n**Case 2: Linear Heat Generation**\n-   $q'''(x) = C_1 + C_2 x$, with $C_1 = 2.0 \\times 10^6 \\, \\mathrm{W/m}^3$ and $C_2 = 1.0 \\times 10^7 \\, \\mathrm{W/m}^4$.\n-   The antiderivative is $Q(x) = C_1 x + \\frac{1}{2} C_2 x^2$.\n-   The exact source term is $S_i = A \\left[ (C_1 x_{i+1/2} + \\frac{1}{2} C_2 x_{i+1/2}^2) - (C_1 x_{i-1/2} + \\frac{1}{2} C_2 x_{i-1/2}^2) \\right] = A \\left[ C_1 \\Delta x_i + \\frac{1}{2} C_2 (x_{i+1/2}^2 - x_{i-1/2}^2) \\right]$.\n-   Using the identity $a^2-b^2 = (a-b)(a+b)$ and the definitions $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ and $x_i^{\\mathrm{c}} = (x_{i+1/2} + x_{i-1/2})/2$, we get $S_i = A [C_1 \\Delta x_i + C_2 \\Delta x_i x_i^{\\mathrm{c}}] = A (C_1 + C_2 x_i^{\\mathrm{c}}) \\Delta x_i$.\n-   The approximate source term is $S_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i = A (C_1 + C_2 x_i^{\\mathrm{c}}) \\Delta x_i$.\n-   As with the constant case, $S_i = S_i^{\\mathrm{center}}$, so the error $e_{\\max}$ is exactly $0$.\n-   The total source is $S_{\\mathrm{tot}} = A \\int_0^L (C_1 + C_2 x) dx = A [C_1 L + \\frac{1}{2} C_2 L^2] = 0.01 [ (2 \\times 10^6)(0.2) + 0.5(10^7)(0.2)^2 ] = 6000 \\, \\mathrm{W}$.\n\n**Case 3: Sinusoidal Heat Generation**\n-   $q'''(x) = C_1 + C_2 \\sin(kx)$, with $C_1 = 4.0 \\times 10^6$, $C_2 = 3.0 \\times 10^6$, and $k = \\frac{2\\pi}{0.05} = 40\\pi \\, \\mathrm{m}^{-1}$.\n-   The function is non-linear, so a non-zero error is expected.\n-   The antiderivative is $Q(x) = C_1 x - \\frac{C_2}{k} \\cos(kx)$.\n-   The exact source term is $S_i = A \\left[ (C_1 x_{i+1/2} - \\frac{C_2}{k} \\cos(kx_{i+1/2})) - (C_1 x_{i-1/2} - \\frac{C_2}{k} \\cos(kx_{i-1/2})) \\right]$.\n-   The approximate source term is $S_i^{\\mathrm{center}} = A (C_1 + C_2 \\sin(kx_i^{\\mathrm{c}})) \\Delta x_i$.\n-   The values for each of the $8$ cells will be computed numerically to find the maximum relative error $e_{\\max}$.\n-   The total source is $S_{\\mathrm{tot}} = A \\int_0^L q'''(x) dx = A [C_1 L - \\frac{C_2}{k}(\\cos(kL) - \\cos(0))]$. With $L=0.2$ m, $kL = 40\\pi(0.2) = 8\\pi$. Since $\\cos(8\\pi) = 1$, the integral of the sinusoidal part over the domain is zero.\n-   $S_{\\mathrm{tot}} = A C_1 L = (0.01)(4.0 \\times 10^6)(0.2) = 8000 \\, \\mathrm{W}$.\n\n**Case 4: Exponential Heat Generation**\n-   $q'''(x) = C_1 \\exp(kx)$, with $C_1 = 1.0 \\times 10^6 \\, \\mathrm{W/m}^3$ and $k=20 \\, \\mathrm{m}^{-1}$.\n-   This function is also non-linear, yielding a non-zero error.\n-   The antiderivative is $Q(x) = \\frac{C_1}{k} \\exp(kx)$.\n-   The exact source term is $S_i = A \\frac{C_1}{k} [\\exp(kx_{i+1/2}) - \\exp(kx_{i-1/2})]$.\n-   The approximate source term is $S_i^{\\mathrm{center}} = A (C_1 \\exp(kx_i^{\\mathrm{c}})) \\Delta x_i$.\n-   The error will be computed for each cell on the non-uniform mesh. The error of the midpoint rule scales with $(\\Delta x)^2$, so we expect the largest error to occur in the cell with the largest width, $\\Delta x = 0.08$ m.\n-   The total source is $S_{\\mathrm{tot}} = A \\int_0^L C_1 e^{kx} dx = A \\frac{C_1}{k} [e^{kx}]_0^L = A \\frac{C_1}{k} (e^{kL}-1)$.\n-   $S_{\\mathrm{tot}} = (0.01) \\frac{1.0 \\times 10^6}{20} (e^{20 \\times 0.2} - 1) = 500(e^4 - 1) \\approx 26799.08 \\, \\mathrm{W}$.\n\nThe following program implements these calculations systematically for all cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the final result.\n    The primary logic is encapsulated in the solve_case function.\n    \"\"\"\n\n    def solve_case(L, A, mesh_widths, q_func, Q_func):\n        \"\"\"\n        Calculates the maximum relative error and total exact source for a single test case.\n\n        Args:\n            L (float): Total length of the slab.\n            A (float): Cross-sectional area of the slab.\n            mesh_widths (list[float]): A list of cell widths.\n            q_func (callable): The volumetric heat generation function q'''(x).\n            Q_func (callable): The analytic antiderivative of q'''(x).\n\n        Returns:\n            tuple[float, float]: A tuple containing the maximum relative error (e_max)\n                                 and the total exact integrated source (S_tot).\n        \"\"\"\n        # Construct the mesh by defining the coordinates of cell faces\n        # starting from x=0.\n        cell_faces = np.cumsum([0.0] + mesh_widths)\n        num_cells = len(mesh_widths)\n\n        relative_errors = []\n        total_source_exact = 0.0\n\n        for i in range(num_cells):\n            x_left = cell_faces[i]\n            x_right = cell_faces[i+1]\n            delta_x = x_right - x_left\n            x_center = (x_left + x_right) / 2.0\n\n            # 1. Exact discrete source term using the antiderivative\n            # S_i = A * integral from x_left to x_right of q'''(x) dx\n            S_exact = A * (Q_func(x_right) - Q_func(x_left))\n\n            # 2. Point-sampled approximation at the cell center\n            # S_i_center = A * q'''(x_center) * delta_x\n            S_approx = A * q_func(x_center) * delta_x\n\n            # 3. Relative error for the current cell\n            # The problem statement guarantees S_exact is non-zero for all cases.\n            if S_exact != 0:\n                error = abs(S_approx - S_exact) / abs(S_exact)\n            else:\n                # This case is avoided by problem design, but handled for completeness.\n                error = 0.0 if S_approx == 0.0 else float('inf')\n            \n            relative_errors.append(error)\n            total_source_exact += S_exact\n        \n        # 4. Maximum relative error across all control volumes\n        max_relative_error = max(relative_errors) if relative_errors else 0.0\n\n        # Optional check: The sum of cell-wise integrals must equal the total integral\n        # total_source_check = A * (Q_func(L) - Q_func(0.0))\n        # assert np.isclose(total_source_exact, total_source_check)\n        \n        return max_relative_error, total_source_exact\n\n    # --- Define Test Cases ---\n    \n    # Common parameters\n    L = 0.2\n    A = 0.01\n\n    test_cases = [\n        # Case 1: Constant generation, uniform mesh\n        {\n            'mesh_widths': [0.02] * 10,\n            'q_func': lambda x: 1.0e6,\n            'Q_func': lambda x: 1.0e6 * x\n        },\n        # Case 2: Linear variation, nonuniform mesh\n        {\n            'mesh_widths': [0.02, 0.03, 0.05, 0.04, 0.06],\n            'q_func': lambda x: 2.0e6 + 1.0e7 * x,\n            'Q_func': lambda x: 2.0e6 * x + 0.5 * 1.0e7 * x**2\n        },\n        # Case 3: Sinusoidal variation, uniform mesh\n        {\n            'mesh_widths': [0.025] * 8,\n            'q_func': lambda x, c1=4.0e6, c2=3.0e6, k=2*np.pi/0.05: c1 + c2 * np.sin(k * x),\n            'Q_func': lambda x, c1=4.0e6, c2=3.0e6, k=2*np.pi/0.05: c1 * x - (c2 / k) * np.cos(k * x)\n        },\n        # Case 4: Exponential variation, strongly nonuniform mesh\n        {\n            'mesh_widths': [0.08, 0.05, 0.03, 0.02, 0.02],\n            'q_func': lambda x, c1=1.0e6, k=20.0: c1 * np.exp(k * x),\n            'Q_func': lambda x, c1=1.0e6, k=20.0: (c1 / k) * np.exp(k * x)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        e_max, S_tot = solve_case(\n            L, A, case['mesh_widths'], case['q_func'], case['Q_func']\n        )\n        results.extend([e_max, S_tot])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}