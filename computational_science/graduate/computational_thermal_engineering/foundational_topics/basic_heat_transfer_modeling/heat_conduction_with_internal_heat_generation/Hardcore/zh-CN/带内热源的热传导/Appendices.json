{
    "hands_on_practices": [
        {
            "introduction": "在深入研究计算方法之前，掌握一个典型问题的解析解至关重要。本练习要求您从第一性原理出发，推导在均匀内热源和对称面对流冷却条件下平板内的温度分布 。通过完成此推导，您将巩固对能量守恒和边界条件应用的理解，并洞悉最高温度是如何由内部导热和外部对流之间的相互作用（通过毕渥数 $\\mathrm{Bi}$ 体现）所决定的。",
            "id": "3960425",
            "problem": "一个厚度为 $2L$ 的平板，其导热系数 $k$ 为常数，且具有均匀的内部体积生热率 $q'''$。该平板关于其中间平面对称，我们将该中间平面作为一维坐标系 $x \\in [-L, L]$ 的原点。位于 $x = -L$ 和 $x = +L$ 的两个表面均暴露在温度为 $T_{\\infty}$ 的相同环境流体中，并具有均匀的对流换热系数 $h$。假设为稳态、一维热传导，无辐射，且物性不沿轴向变化。\n\n仅从微分控制体上的能量守恒和傅里叶热传导定律出发，推导该平板中最高温度 $T_{\\max}$ 的精确表达式。用 $T_{\\infty}$、$q'''$、$k$、$L$ 和毕渥数 $\\mathrm{Bi} = \\dfrac{hL}{k}$ 来明确表示您的结果。\n\n您的推导过程应包括：\n- 在所述假设条件下，建立控制温度场的相应微分方程。\n- 论证并应用由对称性和对流所决定的正确边界条件。\n- 求解温度分布，并确定 $T_{\\max}$ 的位置和值。\n- 将最终表达式简化为一个能明确显示其对 $\\mathrm{Bi}$ 依赖关系的闭式解析表达式。\n\n将最终答案表示为用给定参数表示的 $T_{\\max}$ 的单个闭式解析表达式。最终答案中不应包含中间步骤。最终答案中不应包含单位。",
            "solution": "**问题验证**\n\n*   **提取的已知条件**:\n    *   几何构型：厚度为 $2L$ 的平板。\n    *   坐标系：一维，$x \\in [-L, L]$，原点在中心平面。\n    *   热源：均匀体积生热率 $q'''$。\n    *   物性：导热系数 $k$ 为常数。\n    *   边界条件：两侧表面（$x = \\pm L$）与温度为 $T_{\\infty}$ 的流体对流换热，换热系数为 $h$。\n    *   假设：稳态、一维传导、无辐射、物性恒定。\n*   **验证分析**: 该问题是一个经典、适定的稳态热传导问题。所有必要的物理参数、几何尺寸和边界条件均已明确给出，可以唯一确定温度分布。对称性条件可用于简化求解过程。\n*   **结论**: 问题有效。\n\n**解答**\n\n**温度场的推导**\n根据一维稳态热传导的能量守恒，并考虑内部热源，控制微分方程为：\n$$\n\\frac{d^2T}{dx^2} = -\\frac{q'''}{k}\n$$\n对该方程进行两次积分，得到温度分布的通解：\n$$\n\\frac{dT}{dx} = -\\frac{q'''}{k}x + C_1\n$$\n$$\nT(x) = -\\frac{q'''}{2k}x^2 + C_1 x + C_2\n$$\n为了确定积分常数 $C_1$ 和 $C_2$，我们应用边界条件。\n\n**边界条件1（对称性）**: 由于几何结构和边界条件关于中心平面 $x=0$ 对称，温度分布也必然是对称的。因此，在中心平面上的温度梯度必须为零：\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=0} = 0\n$$\n将此条件代入一阶积分式，得到：\n$$\n-\\frac{q'''}{k}(0) + C_1 = 0 \\implies C_1 = 0\n$$\n因此，温度分布是 $x$ 的一个偶函数：$T(x) = -\\frac{q'''}{2k}x^2 + C_2$。\n\n**边界条件2（表面对流）**: 在表面 $x=L$ 处，从平板内部传导至表面的热流密度必须等于表面与周围流体之间的对流热流密度。根据傅里叶定律和牛顿冷却定律：\n$$\n-k\\left.\\frac{dT}{dx}\\right|_{x=L} = h(T(L)-T_{\\infty})\n$$\n将 $\\frac{dT}{dx} = -\\frac{q'''}{k}x$ 代入左侧：\n$$\n-k\\left(-\\frac{q'''L}{k}\\right) = q'''L\n$$\n将 $T(x)$ 的表达式代入右侧的 $T(L)$：\n$$\nT(L) = -\\frac{q'''L^2}{2k} + C_2\n$$\n将两者结合，得到：\n$$\nq'''L = h\\left(\\left(-\\frac{q'''L^2}{2k} + C_2\\right) - T_{\\infty}\\right)\n$$\n解出 $C_2$：\n$$\n\\frac{q'''L}{h} = -\\frac{q'''L^2}{2k} + C_2 - T_{\\infty}\n$$\n$$\nC_2 = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k}\n$$\n**最高温度的确定**\n由于温度分布 $T(x) = -\\frac{q'''}{2k}x^2 + C_2$ 是一个开口向下的抛物线，其最高温度 $T_{\\max}$ 出现在顶点，即对称中心 $x=0$ 处。\n$$\nT_{\\max} = T(0) = C_2 = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k}\n$$\n**用毕渥数表示**\n问题要求用毕渥数 $\\mathrm{Bi} = \\frac{hL}{k}$ 来表示结果。我们重排 $T_{\\max}$ 的表达式：\n$$\nT_{\\max} - T_{\\infty} = \\frac{q'''L^2}{2k} + \\frac{q'''L}{h}\n$$\n从第二项中提出因子 $\\frac{q'''L^2}{2k}$：\n$$\n\\frac{q'''L}{h} = \\frac{q'''L^2}{2k} \\cdot \\frac{2k}{Lh} = \\frac{q'''L^2}{2k} \\cdot \\frac{2}{hL/k} = \\frac{q'''L^2}{2k} \\cdot \\frac{2}{\\mathrm{Bi}}\n$$\n因此，\n$$\nT_{\\max} - T_{\\infty} = \\frac{q'''L^2}{2k} + \\frac{q'''L^2}{2k} \\cdot \\frac{2}{\\mathrm{Bi}} = \\frac{q'''L^2}{2k} \\left( 1 + \\frac{2}{\\mathrm{Bi}} \\right)\n$$\n最终，最高温度的表达式为：\n$$\nT_{\\max} = T_{\\infty} + \\frac{q'''L^2}{2k} \\left( 1 + \\frac{2}{\\mathrm{Bi}} \\right)\n$$",
            "answer": "$$\\boxed{T_{\\max} = T_{\\infty} + \\frac{q'''L^2}{2k} \\left( 1 + \\frac{2}{\\mathrm{Bi}} \\right)}$$"
        },
        {
            "introduction": "从连续的解析方程过渡到离散的计算模型，需要对每一项进行审慎处理。本实践聚焦于内部热源项 $q'''$，这是许多热模拟中的一个关键组成部分 。您将通过编程来比较控制体积上源项的精确积分值与一种常用近似值，从而揭示体积加权平均对于保证计算精度的重要性，尤其是在源项非均匀分布的情况下。",
            "id": "3960350",
            "problem": "考虑一个长度为 $L$、横截面积恒为 $A$ 的平板内的一维稳态热传导，其内部体积热生成率为 $q'''(x)$，其中 $x$ 表示以米为单位的空间坐标。从能量守恒出发，有限体积法 (FVM) 对每个控制体积上的控制方程进行积分，以产生一个离散源项，该源项必须等于 $q'''$ 在该控制体积上的积分。你的任务是构建一个程序，针对一组指定的测试用例，演示如何通过对控制体积上的 $q'''$ 进行积分来正确构建离散源项，并量化因使用单元中心的非加权点采样替换该积分而产生的误差。\n\n基本原理：对于带内部热生成的稳态热传导，关于温度 $T(x)$ 和热导率 $k$ 的能量守恒定律表明，控制方程为 $\\nabla \\cdot (k \\nabla T) + q''' = 0$。FVM 对每个控制体积 $V_i$ 上的此方程进行积分，得到离散源项 $S_i = \\int_{V_i} q''' \\,\\mathrm{d}V$。对于一个横截面积为 $A$、控制体积跨越 $[x_{i-1/2}, x_{i+1/2}]$ 的一维平板，离散源项为 $S_i = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\,\\mathrm{d}x$。定义体积加权平均值 $\\overline{q'''}_i = \\dfrac{1}{V_i} \\int_{V_i} q''' \\,\\mathrm{d}V$，其中 $V_i = A \\Delta x_i$，并注意到 $S_i = \\overline{q'''}_i V_i$。一个简单的非加权替代方案是 $S_i^{\\mathrm{center}} = A \\, q'''(x_i^{\\mathrm{c}}) \\, \\Delta x_i$，其中 $x_i^{\\mathrm{c}} = \\dfrac{x_{i-1/2} + x_{i+1/2}}{2}$ 是单元中心。本程序将在几种情景下，对所有控制体积的 $S_i$ 和 $S_i^{\\mathrm{center}}$ 进行比较。\n\n你必须实现一个程序，对于每个测试用例，计算：\n1. 使用 $q'''(x)$ 的解析反导数计算每个控制体积的精确离散源项 $S_i = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\,\\mathrm{d}x$。\n2. 点采样近似值 $S_i^{\\mathrm{center}} = A \\, q'''(x_i^{\\mathrm{c}}) \\, \\Delta x_i$。\n3. 所有控制体积上的最大相对误差，定义为 $e_{\\max} = \\max_i \\left( \\left| S_i^{\\mathrm{center}} - S_i \\right| \\big/ \\left| S_i \\right| \\right)$，表示为无单位小数。\n4. 精确的总积分源项 $S_{\\mathrm{tot}} = \\sum_i S_i$，以瓦特 (W) 为单位表示。\n\n通过使用物理上合理的量级和维度来确保科学真实性和计算一致性。所有量必须使用国际单位制 (SI 单位) 处理。在适用物理单位的地方，你必须以指定的单位表示数值。\n\n测试套件：\n- 案例 $1$（恒定生成率，均匀网格）：\n  - $L = 0.2$ m, $A = 0.01$ m$^2$。\n  - 具有 10 个单元的均匀网格，每个单元宽度为 0.02 m。\n  - $q'''(x) = 1.0 \\times 10^6$ W/m$^3$。\n  - 要求输出：$e_{\\max}$（无单位）和 $S_{\\mathrm{tot}}$（单位：W）。\n\n- 案例 $2$（线性变化，非均匀网格）：\n  - $L = 0.2$ m, $A = 0.01$ m$^2$。\n  - 宽度为 $[0.02, 0.03, 0.05, 0.04, 0.06]$ m 的非均匀网格。\n  - $q'''(x) = 2.0 \\times 10^6 + 1.0 \\times 10^7 \\, x$ W/m$^3$。\n  - 要求输出：$e_{\\max}$（无单位）和 $S_{\\mathrm{tot}}$（单位：W）。\n\n- 案例 $3$（正弦变化，均匀网格）：\n  - $L = 0.2$ m, $A = 0.01$ m$^2$。\n  - 具有 8 个单元的均匀网格，每个单元宽度为 0.025 m。\n  - $q'''(x) = 4.0 \\times 10^6 + 3.0 \\times 10^6 \\, \\sin\\!\\left( \\dfrac{2\\pi x}{0.05} \\right)$ W/m$^3$。\n  - 要求输出：$e_{\\max}$（无单位）和 $S_{\\mathrm{tot}}$（单位：W）。\n\n- 案例 $4$（指数变化，强非均匀网格）：\n  - $L = 0.2$ m, $A = 0.01$ m$^2$。\n  - 宽度为 $[0.08, 0.05, 0.03, 0.02, 0.02]$ m 的非均匀网格。\n  - $q'''(x) = 1.0 \\times 10^6 \\, \\exp(20 \\, x)$ W/m$^3$。\n  - 要求输出：$e_{\\max}$（无单位）和 $S_{\\mathrm{tot}}$（单位：W）。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含案例 1 到 4 的结果，即最大相对误差（无单位小数），后跟精确的总积分源项（单位：瓦特），因此最终输出必须为 $[e_{\\max,1},S_{\\mathrm{tot},1},e_{\\max,2},S_{\\mathrm{tot},2},e_{\\max,3},S_{\\mathrm{tot},3},e_{\\max,4},S_{\\mathrm{tot},4}]$ 的形式。",
            "solution": "问题陈述已经过验证，被认为是合理的、自洽的且科学严谨的。它提出了一个热工学领域的良态计算问题。\n\n这个问题的核心在于针对一维稳态热传导问题，在有限体积法 (FVM) 中对源项进行数值近似。其控制微分方程由下式给出：\n$$\n\\nabla \\cdot (k \\nabla T) + q'''(x) = 0\n$$\n其中 $k$ 是热导率，$T$ 是温度，$q'''(x)$ 是内部热生成的体积率。在一维情况下，这简化为：\n$$\n\\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) + q'''(x) = 0\n$$\n有限体积法将空间域离散为有限数量的控制体积（单元）。对与区间 $[x_{i-1/2}, x_{i+1/2}]$ 对应的控制体积 $V_i$ 上的控制方程进行积分，得到：\n$$\n\\int_{V_i} \\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) dV + \\int_{V_i} q'''(x) dV = 0\n$$\n对于一个横截面积恒为 $A$ 的平板，体积元为 $dV = A dx$。第一项代表穿过控制体积边界的净热通量，通过离散化通量项来处理。第二项是积分源项 $S_i$：\n$$\nS_i = \\int_{V_i} q'''(x) dV = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) dx\n$$\n这个积分必须为每个控制体积计算。在可行的情况下，最精确的方法是使用 $q'''(x)$ 的解析反导数。设 $Q(x) = \\int q'''(x) dx$。那么，根据微积分基本定理：\n$$\nS_i = A \\left[ Q(x_{i+1/2}) - Q(x_{i-1/2}) \\right]\n$$\n一种常见且更简单的数值近似方法是假设 $q'''(x)$ 在控制体积上是恒定的，并等于其在单元中心 $x_i^{\\mathrm{c}} = (x_{i-1/2} + x_{i+1/2})/2$ 处的值。这等效于使用中点法则进行数值积分。近似源项 $S_i^{\\mathrm{center}}$ 为：\n$$\nS_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot (x_{i+1/2} - x_{i-1/2}) = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i\n$$\n本问题要求对这两种方法进行定量比较。中点法则近似的误差与被积函数的二阶导数有关。具体来说，对于积分，其误差项约为 $\\frac{f''(\\xi)}{24}(\\Delta x)^3$，其中 $\\xi$ 在区间内。因此，如果 $q'''(x)$ 是常数或线性的（因为其二阶导数为零），源项的相对误差 $e_i = |S_i^{\\mathrm{center}} - S_i| / |S_i|$ 预计为零；而对于更高阶的函数，则为非零。\n\n我们现在将分析每个测试用例。\n\n**案例 1：恒定热生成**\n-   $q'''(x) = C_1 = 1.0 \\times 10^6 \\, \\text{W/m}^3$。\n-   反导数为 $Q(x) = C_1 x$。\n-   精确源项为 $S_i = A [C_1 x_{i+1/2} - C_1 x_{i-1/2}] = A C_1 \\Delta x_i$。\n-   近似源项为 $S_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i = A C_1 \\Delta x_i$。\n-   由于 $S_i = S_i^{\\mathrm{center}}$，误差 $e_{\\max}$ 精确为 $0$。\n-   总源项为 $S_{\\mathrm{tot}} = \\sum S_i = A C_1 \\sum \\Delta x_i = A C_1 L = (0.01)(1.0 \\times 10^6)(0.2) = 2000 \\, \\text{W}$。\n\n**案例 2：线性热生成**\n-   $q'''(x) = C_1 + C_2 x$，其中 $C_1 = 2.0 \\times 10^6 \\, \\text{W/m}^3$，$C_2 = 1.0 \\times 10^7 \\, \\text{W/m}^4$。\n-   反导数为 $Q(x) = C_1 x + \\frac{1}{2} C_2 x^2$。\n-   精确源项为 $S_i = A \\left[ (C_1 x_{i+1/2} + \\frac{1}{2} C_2 x_{i+1/2}^2) - (C_1 x_{i-1/2} + \\frac{1}{2} C_2 x_{i-1/2}^2) \\right] = A \\left[ C_1 \\Delta x_i + \\frac{1}{2} C_2 (x_{i+1/2}^2 - x_{i-1/2}^2) \\right]$。\n-   使用恒等式 $a^2-b^2 = (a-b)(a+b)$ 以及定义 $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ 和 $x_i^{\\mathrm{c}} = (x_{i+1/2} + x_{i-1/2})/2$，我们得到 $S_i = A [C_1 \\Delta x_i + C_2 \\Delta x_i x_i^{\\mathrm{c}}] = A (C_1 + C_2 x_i^{\\mathrm{c}}) \\Delta x_i$。\n-   近似源项为 $S_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i = A (C_1 + C_2 x_i^{\\mathrm{c}}) \\Delta x_i$。\n-   与常数情况一样，$S_i = S_i^{\\mathrm{center}}$，所以误差 $e_{\\max}$ 精确为 $0$。\n-   总源项为 $S_{\\mathrm{tot}} = A \\int_0^L (C_1 + C_2 x) dx = A [C_1 L + \\frac{1}{2} C_2 L^2] = 0.01 [ (2 \\times 10^6)(0.2) + 0.5(10^7)(0.2)^2 ] = 6000 \\, \\text{W}$。\n\n**案例 3：正弦热生成**\n-   $q'''(x) = C_1 + C_2 \\sin(kx)$，其中 $C_1 = 4.0 \\times 10^6$，$C_2 = 3.0 \\times 10^6$，$k = \\frac{2\\pi}{0.05} = 40\\pi \\, \\text{m}^{-1}$。\n-   该函数是非线性的，所以预计会产生非零误差。\n-   反导数为 $Q(x) = C_1 x - \\frac{C_2}{k} \\cos(kx)$。\n-   精确源项为 $S_i = A \\left[ (C_1 x_{i+1/2} - \\frac{C_2}{k} \\cos(kx_{i+1/2})) - (C_1 x_{i-1/2} - \\frac{C_2}{k} \\cos(kx_{i-1/2})) \\right]$。\n-   近似源项为 $S_i^{\\mathrm{center}} = A (C_1 + C_2 \\sin(kx_i^{\\mathrm{c}})) \\Delta x_i$。\n-   将对 8 个单元中的每一个进行数值计算，以找出最大相对误差 $e_{\\max}$。\n-   总源项为 $S_{\\mathrm{tot}} = A \\int_0^L q'''(x) dx = A [C_1 L - \\frac{C_2}{k}(\\cos(kL) - \\cos(0))]$。当 $L=0.2$ m 时，$kL = 40\\pi(0.2) = 8\\pi$。由于 $\\cos(8\\pi) = 1$，正弦部分在整个域上的积分为零。\n-   $S_{\\mathrm{tot}} = A C_1 L = (0.01)(4.0 \\times 10^6)(0.2) = 8000 \\, \\text{W}$。\n\n**案例 4：指数热生成**\n-   $q'''(x) = C_1 \\exp(kx)$，其中 $C_1 = 1.0 \\times 10^6 \\, \\text{W/m}^3$，$k=20 \\, \\text{m}^{-1}$。\n-   这个函数也是非线性的，会产生非零误差。\n-   反导数为 $Q(x) = \\frac{C_1}{k} \\exp(kx)$。\n-   精确源项为 $S_i = A \\frac{C_1}{k} [\\exp(kx_{i+1/2}) - \\exp(kx_{i-1/2})]$。\n-   近似源项为 $S_i^{\\mathrm{center}} = A (C_1 \\exp(kx_i^{\\mathrm{c}})) \\Delta x_i$。\n-   将在非均匀网格上为每个单元计算误差。中点法则的误差与 $(\\Delta x)^2$ 成正比，因此我们预计最大误差将出现在宽度最大的单元中，即 $\\Delta x = 0.08$ m。\n-   总源项为 $S_{\\mathrm{tot}} = A \\int_0^L C_1 e^{kx} dx = A \\frac{C_1}{k} [e^{kx}]_0^L = A \\frac{C_1}{k} (e^{kL}-1)$。\n-   $S_{\\mathrm{tot}} = (0.01) \\frac{1.0 \\times 10^6}{20} (e^{20 \\times 0.2} - 1) = 500(e^4 - 1) \\approx 26799.0751 \\, \\text{W}$。\n\n以下程序为所有案例系统地实现了这些计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the final result.\n    The primary logic is encapsulated in the solve_case function.\n    \"\"\"\n\n    def solve_case(L, A, mesh_widths, q_func, Q_func):\n        \"\"\"\n        Calculates the maximum relative error and total exact source for a single test case.\n\n        Args:\n            L (float): Total length of the slab.\n            A (float): Cross-sectional area of the slab.\n            mesh_widths (list[float]): A list of cell widths.\n            q_func (callable): The volumetric heat generation function q'''(x).\n            Q_func (callable): The analytic antiderivative of q'''(x).\n\n        Returns:\n            tuple[float, float]: A tuple containing the maximum relative error (e_max)\n                                 and the total exact integrated source (S_tot).\n        \"\"\"\n        # Construct the mesh by defining the coordinates of cell faces\n        # starting from x=0.\n        cell_faces = np.cumsum([0.0] + mesh_widths)\n        num_cells = len(mesh_widths)\n\n        relative_errors = []\n        total_source_exact = 0.0\n\n        for i in range(num_cells):\n            x_left = cell_faces[i]\n            x_right = cell_faces[i+1]\n            delta_x = x_right - x_left\n            x_center = (x_left + x_right) / 2.0\n\n            # 1. Exact discrete source term using the antiderivative\n            # S_i = A * integral from x_left to x_right of q'''(x) dx\n            S_exact = A * (Q_func(x_right) - Q_func(x_left))\n\n            # 2. Point-sampled approximation at the cell center\n            # S_i_center = A * q'''(x_center) * delta_x\n            S_approx = A * q_func(x_center) * delta_x\n\n            # 3. Relative error for the current cell\n            # The problem statement guarantees S_exact is non-zero for all cases.\n            if S_exact != 0:\n                error = abs(S_approx - S_exact) / abs(S_exact)\n            else:\n                # This case is avoided by problem design, but handled for completeness.\n                error = 0.0 if S_approx == 0.0 else float('inf')\n            \n            relative_errors.append(error)\n            total_source_exact += S_exact\n        \n        # 4. Maximum relative error across all control volumes\n        max_relative_error = max(relative_errors) if relative_errors else 0.0\n\n        # Optional check: The sum of cell-wise integrals must equal the total integral\n        # total_source_check = A * (Q_func(L) - Q_func(0.0))\n        # assert np.isclose(total_source_exact, total_source_check)\n        \n        return max_relative_error, total_source_exact\n\n    # --- Define Test Cases ---\n    \n    # Common parameters\n    L = 0.2\n    A = 0.01\n\n    test_cases = [\n        # Case 1: Constant generation, uniform mesh\n        {\n            'mesh_widths': [0.02] * 10,\n            'q_func': lambda x: 1.0e6,\n            'Q_func': lambda x: 1.0e6 * x\n        },\n        # Case 2: Linear variation, nonuniform mesh\n        {\n            'mesh_widths': [0.02, 0.03, 0.05, 0.04, 0.06],\n            'q_func': lambda x: 2.0e6 + 1.0e7 * x,\n            'Q_func': lambda x: 2.0e6 * x + 0.5 * 1.0e7 * x**2\n        },\n        # Case 3: Sinusoidal variation, uniform mesh\n        {\n            'mesh_widths': [0.025] * 8,\n            'q_func': lambda x, c1=4.0e6, c2=3.0e6, k=2*np.pi/0.05: c1 + c2 * np.sin(k * x),\n            'Q_func': lambda x, c1=4.0e6, c2=3.0e6, k=2*np.pi/0.05: c1 * x - (c2 / k) * np.cos(k * x)\n        },\n        # Case 4: Exponential variation, strongly nonuniform mesh\n        {\n            'mesh_widths': [0.08, 0.05, 0.03, 0.02, 0.02],\n            'q_func': lambda x, c1=1.0e6, k=20.0: c1 * np.exp(k * x),\n            'Q_func': lambda x, c1=1.0e6, k=20.0: (c1 / k) * np.exp(k * x)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        e_max, S_tot = solve_case(\n            L, A, case['mesh_widths'], case['q_func'], case['Q_func']\n        )\n        results.extend([e_max, S_tot])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "计算科学的一个基石是验证仿真代码，以确保其正确地求解了预设的数学方程。为此，“人造解法”（Method of Manufactured Solutions, MMS）是一种严谨而强大的技术 。在本练习中，您将推导出一个必要的热源项 $q'''(x,t)$，该源项能使一个选定的人造温度场成为热方程的精确解，从而运用它来验证代码实现的正确性。",
            "id": "3960297",
            "problem": "考虑一个均匀、各向同性的固体，其占据空间域 $x\\in[0,1]$ 且时间 $t\\ge 0$，在该固体中存在带内部体积热生成的一维瞬态热传导。设热导率在空间和时间上恒定为 $k=1\\,\\mathrm{W/(m\\cdot K)}$，体积热容恒定为 $\\rho c=1\\,\\mathrm{J/(m^3\\cdot K)}$。温度场 $T(x,t)$ 由能量守恒定律决定，该定律表示为以下偏微分方程（PDE）：\n$$\n\\rho c\\,\\frac{\\partial T}{\\partial t}=\\frac{\\partial}{\\partial x}\\!\\left(k\\,\\frac{\\partial T}{\\partial x}\\right)+q'''(x,t),\n$$\n其中 $q'''(x,t)$ 是单位体积的内部热生成率，单位为 $\\mathrm{W/m^3}$。假设对于所有 $t\\ge 0$，狄利克雷边界条件为 $T(0,t)=0\\,\\mathrm{K}$ 和 $T(1,t)=0\\,\\mathrm{K}$，初始条件为 $T(x,0)=\\sin(\\pi x)\\,\\mathrm{K}$，其中正弦函数的角度以弧度为单位。您需要使用人工解法：强制施加人工设定的温度场\n$$\nT(x,t)=\\sin(\\pi x)\\,\\mathrm{K}\n$$\n对于所有 $x\\in[0,1]$ 和 $t\\ge 0$，并确定相应的源项 $q'''(x,t)$，使得该人工设定的温度在给定的材料属性下成为此偏微分方程的精确解。从上述能量守恒表达式出发，仅通过第一性原理和微分法推导出 $q'''(x,t)$。然后，在指定的测试点集上计算推导出的 $q'''(x,t)$ 的值。\n\n使用的物理单位为：$x$ 用米，$t$ 用秒，$T$ 用开尔文。所有 $q'''$ 的值都以 $\\mathrm{W/m^3}$ 表示。三角函数中使用的角度必须是弧度。\n\n您的程序必须计算由人工设定的温度场所蕴含的源项 $q'''(x,t)$，并为以下有序的输入对 $(x,t)$ 测试集生成数值（单位为 $\\mathrm{W/m^3}$）：\n- $(x,t)=\\big(0,\\,0\\big)$,\n- $(x,t)=\\big(1,\\,0\\big)$,\n- $(x,t)=\\big(0.25,\\,0\\big)$,\n- $(x,t)=\\big(0.5,\\,0\\big)$,\n- $(x,t)=\\big(0.75,\\,0\\big)$,\n- $(x,t)=\\big(0.5,\\,2\\big)$.\n\n为覆盖率而设计：该测试集包括边界点 $x=0$ 和 $x=1$，内部对称点 $x=0.25$、$x=0.5$、$x=0.75$，以及两个不同的时间点 $t=0$ 和 $t=2$，以评估任何显式的时间依赖性。\n\n最终输出格式：您的程序应生成单行输出，其中包含六个结果，形式为方括号括起来的逗号分隔列表，顺序如上所列，每个值四舍五入到恰好8位小数，例如 $[v_1,v_2,v_3,v_4,v_5,v_6]$，其中每个 $v_i$ 是一个浮点数，代表 $q'''(x,t)$ 的值，单位为 $\\mathrm{W/m^3}$。",
            "solution": "该问题已经过验证，并被认为是有效的。它在科学上基于热传导原理，在数学上是一致的，并且是适定的。所有必要的数据和条件都已提供，以确定源项 $q'''(x,t)$ 的唯一解。人工解 $T(x,t)=\\sin(\\pi x)$ 正确地满足了指定的初始条件 $T(x,0)=\\sin(\\pi x)$ 和边界条件 $T(0,t)=0$ 及 $T(1,t)=0$。该问题是人工解法的一个直接应用，这是计算科学中的一种标准验证技术。\n\n任务是找出在固体介质中维持一个给定温度场 $T(x,t)$ 所需的内部热生成率 $q'''(x,t)$。控制此过程的物理原理是能量守恒，由给定的一维瞬态热传导方程表示：\n$$\n\\rho c\\,\\frac{\\partial T}{\\partial t}=\\frac{\\partial}{\\partial x}\\!\\left(k\\,\\frac{\\partial T}{\\partial x}\\right)+q'''(x,t)\n$$\n其中 $T$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\rho c$ 是体积热容，$k$ 是热导率，$q'''(x,t)$ 是体积源项。\n\n材料属性为给定常数：$k=1\\,\\mathrm{W/(m\\cdot K)}$ 和 $\\rho c=1\\,\\mathrm{J/(m^3\\cdot K)}$。由于 k 是常数，热传导方程简化为：\n$$\n\\rho c\\,\\frac{\\partial T}{\\partial t}=k\\,\\frac{\\partial^2 T}{\\partial x^2}+q'''(x,t)\n$$\n为确定源项 $q'''(x,t)$，我们重排此方程：\n$$\nq'''(x,t) = \\rho c\\,\\frac{\\partial T}{\\partial t} - k\\,\\frac{\\partial^2 T}{\\partial x^2}\n$$\n问题指定了温度场的人工解：\n$$\nT(x,t) = \\sin(\\pi x)\n$$\n我们现在必须计算此函数关于时间 $t$ 和空间 $x$ 的偏导数。\n\n关于时间 $t$ 的偏导数为：\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial t}(\\sin(\\pi x)) = 0\n$$\n这是因为人工设定的温度场与时间无关。这意味着这是一个稳态条件，其中任何点 $x$ 的温度不随时间变化。\n\n关于空间 $x$ 的一阶偏导数为：\n$$\n\\frac{\\partial T}{\\partial x} = \\frac{\\partial}{\\partial x}(\\sin(\\pi x)) = \\pi \\cos(\\pi x)\n$$\n关于空间 $x$ 的二阶偏导数为：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial}{\\partial x}(\\pi \\cos(\\pi x)) = -\\pi^2 \\sin(\\pi x)\n$$\n现在，我们将这些导数和给定的常数（$\\rho c=1$，$k=1$）代入 $q'''(x,t)$ 的表达式中：\n$$\nq'''(x,t) = (1)\\cdot(0) - (1)\\cdot(-\\pi^2 \\sin(\\pi x))\n$$\n这简化为源项的最终表达式：\n$$\nq'''(x,t) = \\pi^2 \\sin(\\pi x)\n$$\n在物理上，这意味着要使温度场保持在 $T(x,t) = \\sin(\\pi x)$ 的静态状态，每个点 $x$ 内部产生的热量必须精确地平衡掉向边界扩散的热量。由于温度分布和材料属性都与时间无关，所需的源项也与时间无关。\n\n最后，我们在指定的测试点 $(x,t)$ 上计算该源项 $q'''(x,t)$ 的值。注意该函数与 $t$ 无关。\n\n1.  对于 $(x,t) = (0,0)$:\n    $q'''(0,0) = \\pi^2 \\sin(\\pi \\cdot 0) = \\pi^2 \\cdot 0 = 0$\n\n2.  对于 $(x,t) = (1,0)$:\n    $q'''(1,0) = \\pi^2 \\sin(\\pi \\cdot 1) = \\pi^2 \\cdot 0 = 0$\n\n3.  对于 $(x,t) = (0.25,0)$:\n    $q'''(0.25,0) = \\pi^2 \\sin(\\pi \\cdot 0.25) = \\pi^2 \\sin(\\pi/4) = \\pi^2 \\frac{\\sqrt{2}}{2} \\approx 6.97881189\\,\\mathrm{W/m^3}$\n\n4.  对于 $(x,t) = (0.5,0)$:\n    $q'''(0.5,0) = \\pi^2 \\sin(\\pi \\cdot 0.5) = \\pi^2 \\sin(\\pi/2) = \\pi^2 \\cdot 1 = \\pi^2 \\approx 9.86960440\\,\\mathrm{W/m^3}$\n\n5.  对于 $(x,t) = (0.75,0)$:\n    $q'''(0.75,0) = \\pi^2 \\sin(\\pi \\cdot 0.75) = \\pi^2 \\sin(3\\pi/4) = \\pi^2 \\frac{\\sqrt{2}}{2} \\approx 6.97881189\\,\\mathrm{W/m^3}$\n\n6.  对于 $(x,t) = (0.5,2)$:\n    $q'''(0.5,2) = \\pi^2 \\sin(\\pi \\cdot 0.5) = \\pi^2 \\sin(\\pi/2) = \\pi^2 \\cdot 1 = \\pi^2 \\approx 9.86960440\\,\\mathrm{W/m^3}$\n\n这些值将在提供的 Python 代码中进行计算和格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the source term q'''(x,t) for a manufactured temperature profile\n    in a 1D transient heat conduction problem and evaluates it at specific points.\n    \"\"\"\n\n    # The problem asks to solve for the source term q'''(x,t) in the equation:\n    # rho*c * dT/dt = d/dx(k * dT/dx) + q'''(x,t)\n    # Given rho*c = 1, k = 1, and the manufactured solution T(x,t) = sin(pi*x).\n    #\n    # Rearranging for q'''(x,t):\n    # q'''(x,t) = rho*c * dT/dt - k * d^2T/dx^2\n    #\n    # The partial derivatives of T(x,t) = sin(pi*x) are:\n    # dT/dt = 0 (since T is not a function of t)\n    # dT/dx = pi * cos(pi*x)\n    # d^2T/dx^2 = -pi^2 * sin(pi*x)\n    #\n    # Substituting these into the expression for q'''(x,t):\n    # q'''(x,t) = (1)*(0) - (1)*(-pi^2 * sin(pi*x))\n    # q'''(x,t) = pi^2 * sin(pi*x)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.0),\n        (1.0, 0.0),\n        (0.25, 0.0),\n        (0.5, 0.0),\n        (0.75, 0.0),\n        (0.5, 2.0),\n    ]\n\n    results = []\n    for x, t in test_cases:\n        # The derived source term is independent of time t.\n        q_triple_prime = np.pi**2 * np.sin(np.pi * x)\n        results.append(q_triple_prime)\n\n    # Format the results to exactly 8 decimal places.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}