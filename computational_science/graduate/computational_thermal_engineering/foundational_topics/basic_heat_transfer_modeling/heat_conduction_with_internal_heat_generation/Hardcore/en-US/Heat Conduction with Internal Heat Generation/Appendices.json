{
    "hands_on_practices": [
        {
            "introduction": "Deriving analytical solutions from first principles is a cornerstone skill that builds deep physical intuition and provides invaluable benchmarks for verifying complex numerical simulations. This exercise  guides you through the process for a canonical problem: a slab with internal heat generation cooled symmetrically by convection. By systematically applying energy conservation and appropriate boundary conditions, you will not only determine the temperature distribution but also see how it is governed by the Biot number ($\\mathrm{Bi}$), a crucial dimensionless parameter that compares internal conductive resistance to external convective resistance.",
            "id": "3960425",
            "problem": "A plane wall (slab) of thickness $2L$ has constant thermal conductivity $k$ and a uniform internal volumetric heat generation rate $q'''$. The slab is symmetric about its mid-plane, which we take as the origin of a one-dimensional coordinate system $x \\in [-L, L]$. Both faces at $x = -L$ and $x = +L$ are exposed to the same ambient fluid at temperature $T_{\\infty}$ with a uniform convection coefficient $h$. Assume steady state, one-dimensional heat conduction, no radiation, and no axial property variations. \n\nStarting only from conservation of energy on a differential control volume and Fourier’s law of heat conduction, derive the exact expression for the maximum temperature $T_{\\max}$ in the slab. Express your result explicitly in terms of $T_{\\infty}$, $q'''$, $k$, $L$, and the Biot number $\\mathrm{Bi} = \\dfrac{hL}{k}$. \n\nYour derivation should:\n- Formulate the appropriate differential equation governing the temperature field under the stated assumptions.\n- Justify and apply the correct boundary conditions implied by symmetry and convection.\n- Solve for the temperature distribution and identify the location and value of $T_{\\max}$.\n- Reduce the final expression to a closed-form analytic expression that makes the dependence on $\\mathrm{Bi}$ explicit.\n\nExpress the final answer as a single closed-form analytic expression for $T_{\\max}$ in terms of the given parameters. Do not provide intermediate steps in the final answer. Do not include units in the final answer.",
            "solution": "**Problem Validation**\nThe problem statement is validated as scientifically sound, well-posed, and self-contained. It presents a canonical problem in heat conduction theory. The assumptions (steady-state, 1D, constant properties, uniform generation) are clearly stated, and the required output is unambiguously defined.\n\n**Derivation of the Temperature Field**\nWe begin by applying the principle of conservation of energy to a differential control volume of thickness $dx$ and area $A$ within the slab. Under steady-state conditions, the rate of heat conducted in at $x$ minus the rate of heat conducted out at $x+dx$ plus the rate of heat generated within the volume must be zero. This leads to the one-dimensional steady-state heat equation with internal generation:\n$$\n\\frac{d^2T}{dx^2} = -\\frac{q'''}{k}\n$$\nTo solve this second-order ordinary differential equation, we need two boundary conditions.\n1.  **Symmetry Condition**: Due to the symmetrical geometry and boundary conditions, the temperature profile must be symmetric about the mid-plane ($x=0$). This implies that the temperature gradient, and thus the heat flux, is zero at the center:\n    $$ \\left.\\frac{dT}{dx}\\right|_{x=0}=0 $$\n2.  **Convection Condition**: At the surface $x=L$, the heat conducted to the surface from the interior must be equal to the heat convected away from the surface into the ambient fluid. This energy balance is expressed as:\n    $$ -k\\left.\\frac{dT}{dx}\\right|_{x=L} = h(T(L)-T_{\\infty}) $$\nIntegrating the governing equation once with respect to $x$ yields the temperature gradient:\n$$\n\\frac{dT}{dx} = -\\frac{q'''}{k}x + C_1\n$$\nApplying the symmetry condition (BC1), we find that $C_1=0$.\nIntegrating a second time gives the temperature distribution:\n$$\nT(x) = -\\frac{q'''}{2k}x^2 + C_2\n$$\nTo find the second integration constant, $C_2$, we apply the convection condition (BC2). First, we evaluate the temperature gradient at $x=L$:\n$$\n\\left.\\frac{dT}{dx}\\right|_{x=L} = -\\frac{q'''L}{k}\n$$\nAnd the temperature at $x=L$:\n$$\nT(L) = -\\frac{q'''L^2}{2k} + C_2\n$$\nSubstituting these into the convection boundary condition equation:\n$$\n-k\\left(-\\frac{q'''L}{k}\\right) = h\\left(\\left(-\\frac{q'''L^2}{2k} + C_2\\right) - T_{\\infty}\\right)\n$$\n$$\nq'''L = h\\left(-\\frac{q'''L^2}{2k} + C_2 - T_{\\infty}\\right)\n$$\nSolving for $C_2$:\n$$\n\\frac{q'''L}{h} = -\\frac{q'''L^2}{2k} + C_2 - T_{\\infty}\n$$\n$$\nC_2 = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k}\n$$\nThe full temperature distribution is therefore:\n$$\nT(x) = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k} - \\frac{q'''x^2}{2k} = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''}{2k}(L^2 - x^2)\n$$\nThe maximum temperature $T_{\\max}$ occurs where the temperature gradient is zero, which is at the centerline $x=0$.\n$$\nT_{\\max} = T(0) = C_2 = T_{\\infty} + \\frac{q'''L}{h} + \\frac{q'''L^2}{2k}\n$$\nFinally, we express this result in terms of the Biot number, $\\mathrm{Bi} = \\frac{hL}{k}$. We can rewrite the term $\\frac{q'''L}{h}$ as $\\frac{q'''L^2}{k} \\cdot \\frac{k}{hL} = \\frac{q'''L^2}{k} \\frac{1}{\\mathrm{Bi}}$.\nSubstituting this into the expression for $T_{\\max}$:\n$$\nT_{\\max} = T_{\\infty} + \\frac{q'''L^2}{k} \\frac{1}{\\mathrm{Bi}} + \\frac{q'''L^2}{2k} = T_{\\infty} + \\frac{q'''L^2}{2k}\\left(\\frac{2}{\\mathrm{Bi}} + 1\\right)\n$$",
            "answer": "$$\\boxed{T_{\\infty} + \\frac{q'''L^2}{2k} \\left( 1 + \\frac{2}{\\mathrm{Bi}} \\right)}$$"
        },
        {
            "introduction": "Moving from the continuous world of analytical solutions to the discrete domain of computational methods requires careful treatment of physical terms. In the Finite Volume Method (FVM), ensuring conservation requires that source terms like internal heat generation ($q'''$) are integrated over each control volume. This computational exercise  directly addresses this challenge by having you compare the exact, integrated source term with a common approximation based on the cell-center value. By analyzing cases with constant, linear, and highly nonlinear generation profiles, you will gain practical insight into the accuracy of source term discretization, a fundamental aspect of building reliable solvers.",
            "id": "3960350",
            "problem": "Consider one-dimensional steady heat conduction in a slab of length $L$ with constant cross-sectional area $A$ and internal volumetric heat generation $q'''(x)$, where $x$ denotes the spatial coordinate measured in meters. Starting from the conservation of energy, the Finite Volume Method (FVM) integrates the governing equation over each control volume to produce a discrete source term that must equal the integral of $q'''$ over that control volume. Your task is to construct a program that, for a set of specified test cases, demonstrates how to correctly form discrete source terms by integrating $q'''$ over control volumes and quantifies the error incurred by replacing the integral with a non-weighted point sample at the cell center.\n\nFundamental base: For steady conduction with internal heat generation, the conservation of energy for temperature $T(x)$ and thermal conductivity $k$ states that the governing equation is $\\nabla \\cdot (k \\nabla T) + q''' = 0$. The FVM integrates this over each control volume $V_i$, yielding a discrete source term $S_i = \\int_{V_i} q''' \\,\\mathrm{d}V$. For a one-dimensional slab with cross-sectional area $A$ and control volume spanning $[x_{i-1/2}, x_{i+1/2}]$, the discrete source term is $S_i = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\,\\mathrm{d}x$. Define the volume-weighted average $\\overline{q'''}_i = \\dfrac{1}{V_i} \\int_{V_i} q''' \\,\\mathrm{d}V$, where $V_i = A \\Delta x_i$, and observe that $S_i = \\overline{q'''}_i V_i$. A naive non-weighted alternative is $S_i^{\\mathrm{center}} = A \\, q'''(x_i^{\\mathrm{c}}) \\, \\Delta x_i$, where $x_i^{\\mathrm{c}} = \\dfrac{x_{i-1/2} + x_{i+1/2}}{2}$ is the cell center. This program will compare $S_i$ against $S_i^{\\mathrm{center}}$ across all control volumes in several scenarios.\n\nYou must implement a program that, for each test case, computes:\n1. The exact discrete source term per control volume $S_i = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) \\,\\mathrm{d}x$ using an analytic antiderivative of $q'''(x)$.\n2. The point-sampled approximation $S_i^{\\mathrm{center}} = A \\, q'''(x_i^{\\mathrm{c}}) \\, \\Delta x_i$.\n3. The maximum relative error across all control volumes, defined as $e_{\\max} = \\max_i \\left( \\left| S_i^{\\mathrm{center}} - S_i \\right| \\big/ \\left| S_i \\right| \\right)$, expressed as a unitless decimal.\n4. The exact total integrated source $S_{\\mathrm{tot}} = \\sum_i S_i$, expressed in Watts (W).\n\nScientific realism and computational consistency are ensured by using physically plausible magnitudes and dimensions. All quantities must be handled in International System of Units (SI units). Where physical units apply, you must express values in the specified units.\n\nTest suite:\n- Case $1$ (constant generation, uniform mesh):\n  - $L = 0.2$ m, $A = 0.01$ m$^2$.\n  - Uniform mesh with $10$ cells, each of width $0.02$ m.\n  - $q'''(x) = 1.0 \\times 10^6$ W/m$^3$.\n  - Required outputs: $e_{\\max}$ (unitless) and $S_{\\mathrm{tot}}$ in W.\n\n- Case $2$ (linear variation, nonuniform mesh):\n  - $L = 0.2$ m, $A = 0.01$ m$^2$.\n  - Nonuniform mesh with widths $[0.02, 0.03, 0.05, 0.04, 0.06]$ m.\n  - $q'''(x) = 2.0 \\times 10^6 + 1.0 \\times 10^7 \\, x$ W/m$^3$.\n  - Required outputs: $e_{\\max}$ (unitless) and $S_{\\mathrm{tot}}$ in W.\n\n- Case $3$ (sinusoidal variation, uniform mesh):\n  - $L = 0.2$ m, $A = 0.01$ m$^2$.\n  - Uniform mesh with $8$ cells, each of width $0.025$ m.\n  - $q'''(x) = 4.0 \\times 10^6 + 3.0 \\times 10^6 \\, \\sin\\!\\left( \\dfrac{2\\pi x}{0.05} \\right)$ W/m$^3$.\n  - Required outputs: $e_{\\max}$ (unitless) and $S_{\\mathrm{tot}}$ in W.\n\n- Case $4$ (exponential variation, strongly nonuniform mesh):\n  - $L = 0.2$ m, $A = 0.01$ m$^2$.\n  - Nonuniform mesh with widths $[0.08, 0.05, 0.03, 0.02, 0.02]$ m.\n  - $q'''(x) = 1.0 \\times 10^6 \\, \\exp(20 \\, x)$ W/m$^3$.\n  - Required outputs: $e_{\\max}$ (unitless) and $S_{\\mathrm{tot}}$ in W.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order, for Cases $1$ through $4$, the maximum relative error (unitless decimal) followed by the exact total integrated source in Watts, so the final output must be of the form $[e_{\\max,1},S_{\\mathrm{tot},1},e_{\\max,2},S_{\\mathrm{tot},2},e_{\\max,3},S_{\\mathrm{tot},3},e_{\\max,4},S_{\\mathrm{tot},4}]$.",
            "solution": "The problem statement has been validated and is deemed sound, self-contained, and scientifically rigorous. It presents a well-posed computational problem in the field of thermal engineering.\n\nThe core of this problem lies in the numerical approximation of the source term in the Finite Volume Method (FVM) for a one-dimensional steady-state heat conduction problem. The governing differential equation is given by:\n$$\n\\nabla \\cdot (k \\nabla T) + q'''(x) = 0\n$$\nwhere $k$ is the thermal conductivity, $T$ is the temperature, and $q'''(x)$ is the volumetric rate of internal heat generation. In one dimension, this simplifies to:\n$$\n\\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) + q'''(x) = 0\n$$\nThe Finite Volume Method discretizes the spatial domain into a finite number of control volumes (cells). Integrating the governing equation over a control volume $V_i$ corresponding to the interval $[x_{i-1/2}, x_{i+1/2}]$ gives:\n$$\n\\int_{V_i} \\frac{d}{dx} \\left( k \\frac{dT}{dx} \\right) dV + \\int_{V_i} q'''(x) dV = 0\n$$\nFor a slab of constant cross-sectional area $A$, the volume element is $dV = A dx$. The first term, representing the net heat flux across the control volume boundaries, is handled by discretizing the flux terms. The second term is the integrated source term, $S_i$:\n$$\nS_i = \\int_{V_i} q'''(x) dV = A \\int_{x_{i-1/2}}^{x_{i+1/2}} q'''(x) dx\n$$\nThis integral must be computed for each control volume. The most accurate approach, when feasible, is to use the analytical antiderivative of $q'''(x)$. Let $Q(x) = \\int q'''(x) dx$. Then, by the fundamental theorem of calculus:\n$$\nS_i = A \\left[ Q(x_{i+1/2}) - Q(x_{i-1/2}) \\right]\n$$\nA common and simpler numerical approximation is to assume that $q'''(x)$ is constant over the control volume and equal to its value at the cell center, $x_i^{\\mathrm{c}} = (x_{i-1/2} + x_{i+1/2})/2$. This is equivalent to using the midpoint rule for numerical integration. The approximate source term, $S_i^{\\mathrm{center}}$, is:\n$$\nS_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot (x_{i+1/2} - x_{i-1/2}) = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i\n$$\nThis problem requires a quantitative comparison of these two methods. The error of the midpoint rule approximation is related to the second derivative of the integrand. Specifically, the error term for the integral is approximately $\\frac{f''(\\xi)}{24}(\\Delta x)^3$ for some $\\xi$ in the interval. Thus, the relative error in the source term, $e_i = |S_i^{\\mathrm{center}} - S_i| / |S_i|$, is expected to be zero if $q'''(x)$ is constant or linear (since its second derivative would be zero), and non-zero for higher-order functions.\n\nWe will now analyze each test case.\n\n**Case 1: Constant Heat Generation**\n-   $q'''(x) = C_1 = 1.0 \\times 10^6 \\, \\text{W/m}^3$.\n-   The antiderivative is $Q(x) = C_1 x$.\n-   The exact source term is $S_i = A [C_1 x_{i+1/2} - C_1 x_{i-1/2}] = A C_1 \\Delta x_i$.\n-   The approximate source term is $S_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i = A C_1 \\Delta x_i$.\n-   Since $S_i = S_i^{\\mathrm{center}}$, the error $e_{\\max}$ is exactly $0$.\n-   The total source is $S_{\\mathrm{tot}} = \\sum S_i = A C_1 \\sum \\Delta x_i = A C_1 L = (0.01)(1.0 \\times 10^6)(0.2) = 2000 \\, \\text{W}$.\n\n**Case 2: Linear Heat Generation**\n-   $q'''(x) = C_1 + C_2 x$, with $C_1 = 2.0 \\times 10^6 \\, \\text{W/m}^3$ and $C_2 = 1.0 \\times 10^7 \\, \\text{W/m}^4$.\n-   The antiderivative is $Q(x) = C_1 x + \\frac{1}{2} C_2 x^2$.\n-   The exact source term is $S_i = A \\left[ (C_1 x_{i+1/2} + \\frac{1}{2} C_2 x_{i+1/2}^2) - (C_1 x_{i-1/2} + \\frac{1}{2} C_2 x_{i-1/2}^2) \\right] = A \\left[ C_1 \\Delta x_i + \\frac{1}{2} C_2 (x_{i+1/2}^2 - x_{i-1/2}^2) \\right]$.\n-   Using the identity $a^2-b^2 = (a-b)(a+b)$ and the definitions $\\Delta x_i = x_{i+1/2} - x_{i-1/2}$ and $x_i^{\\mathrm{c}} = (x_{i+1/2} + x_{i-1/2})/2$, we get $S_i = A [C_1 \\Delta x_i + C_2 \\Delta x_i x_i^{\\mathrm{c}}] = A (C_1 + C_2 x_i^{\\mathrm{c}}) \\Delta x_i$.\n-   The approximate source term is $S_i^{\\mathrm{center}} = A \\cdot q'''(x_i^{\\mathrm{c}}) \\cdot \\Delta x_i = A (C_1 + C_2 x_i^{\\mathrm{c}}) \\Delta x_i$.\n-   As with the constant case, $S_i = S_i^{\\mathrm{center}}$, so the error $e_{\\max}$ is exactly $0$.\n-   The total source is $S_{\\mathrm{tot}} = A \\int_0^L (C_1 + C_2 x) dx = A [C_1 L + \\frac{1}{2} C_2 L^2] = 0.01 [ (2 \\times 10^6)(0.2) + 0.5(10^7)(0.2)^2 ] = 6000 \\, \\text{W}$.\n\n**Case 3: Sinusoidal Heat Generation**\n-   $q'''(x) = C_1 + C_2 \\sin(kx)$, with $C_1 = 4.0 \\times 10^6$, $C_2 = 3.0 \\times 10^6$, and $k = \\frac{2\\pi}{0.05} = 40\\pi \\, \\text{m}^{-1}$.\n-   The function is non-linear, so a non-zero error is expected.\n-   The antiderivative is $Q(x) = C_1 x - \\frac{C_2}{k} \\cos(kx)$.\n-   The exact source term is $S_i = A \\left[ (C_1 x_{i+1/2} - \\frac{C_2}{k} \\cos(kx_{i+1/2})) - (C_1 x_{i-1/2} - \\frac{C_2}{k} \\cos(kx_{i-1/2})) \\right]$.\n-   The approximate source term is $S_i^{\\mathrm{center}} = A (C_1 + C_2 \\sin(kx_i^{\\mathrm{c}})) \\Delta x_i$.\n-   The values for each of the $8$ cells will be computed numerically to find the maximum relative error $e_{\\max}$.\n-   The total source is $S_{\\mathrm{tot}} = A \\int_0^L q'''(x) dx = A [C_1 L - \\frac{C_2}{k}(\\cos(kL) - \\cos(0))]$. With $L=0.2$ m, $kL = 40\\pi(0.2) = 8\\pi$. Since $\\cos(8\\pi) = 1$, the integral of the sinusoidal part over the domain is zero.\n-   $S_{\\mathrm{tot}} = A C_1 L = (0.01)(4.0 \\times 10^6)(0.2) = 8000 \\, \\text{W}$.\n\n**Case 4: Exponential Heat Generation**\n-   $q'''(x) = C_1 \\exp(kx)$, with $C_1 = 1.0 \\times 10^6 \\, \\text{W/m}^3$ and $k=20 \\, \\text{m}^{-1}$.\n-   This function is also non-linear, yielding a non-zero error.\n-   The antiderivative is $Q(x) = \\frac{C_1}{k} \\exp(kx)$.\n-   The exact source term is $S_i = A \\frac{C_1}{k} [\\exp(kx_{i+1/2}) - \\exp(kx_{i-1/2})]$.\n-   The approximate source term is $S_i^{\\mathrm{center}} = A (C_1 \\exp(kx_i^{\\mathrm{c}})) \\Delta x_i$.\n-   The error will be computed for each cell on the non-uniform mesh. The error of the midpoint rule scales with $(\\Delta x)^2$, so we expect the largest error to occur in the cell with the largest width, $\\Delta x = 0.08$ m.\n-   The total source is $S_{\\mathrm{tot}} = A \\int_0^L C_1 e^{kx} dx = A \\frac{C_1}{k} [e^{kx}]_0^L = A \\frac{C_1}{k} (e^{kL}-1)$.\n-   $S_{\\mathrm{tot}} = (0.01) \\frac{1.0 \\times 10^6}{20} (e^{20 \\times 0.2} - 1) = 500(e^4 - 1) \\approx 26799.0751 \\, \\text{W}$.\n\nThe following program implements these calculations systematically for all cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the final result.\n    The primary logic is encapsulated in the solve_case function.\n    \"\"\"\n\n    def solve_case(L, A, mesh_widths, q_func, Q_func):\n        \"\"\"\n        Calculates the maximum relative error and total exact source for a single test case.\n\n        Args:\n            L (float): Total length of the slab.\n            A (float): Cross-sectional area of the slab.\n            mesh_widths (list[float]): A list of cell widths.\n            q_func (callable): The volumetric heat generation function q'''(x).\n            Q_func (callable): The analytic antiderivative of q'''(x).\n\n        Returns:\n            tuple[float, float]: A tuple containing the maximum relative error (e_max)\n                                 and the total exact integrated source (S_tot).\n        \"\"\"\n        # Construct the mesh by defining the coordinates of cell faces\n        # starting from x=0.\n        cell_faces = np.cumsum([0.0] + mesh_widths)\n        num_cells = len(mesh_widths)\n\n        relative_errors = []\n        total_source_exact = 0.0\n\n        for i in range(num_cells):\n            x_left = cell_faces[i]\n            x_right = cell_faces[i+1]\n            delta_x = x_right - x_left\n            x_center = (x_left + x_right) / 2.0\n\n            # 1. Exact discrete source term using the antiderivative\n            # S_i = A * integral from x_left to x_right of q'''(x) dx\n            S_exact = A * (Q_func(x_right) - Q_func(x_left))\n\n            # 2. Point-sampled approximation at the cell center\n            # S_i_center = A * q'''(x_center) * delta_x\n            S_approx = A * q_func(x_center) * delta_x\n\n            # 3. Relative error for the current cell\n            # The problem statement guarantees S_exact is non-zero for all cases.\n            if S_exact != 0:\n                error = abs(S_approx - S_exact) / abs(S_exact)\n            else:\n                # This case is avoided by problem design, but handled for completeness.\n                error = 0.0 if S_approx == 0.0 else float('inf')\n            \n            relative_errors.append(error)\n            total_source_exact += S_exact\n        \n        # 4. Maximum relative error across all control volumes\n        max_relative_error = max(relative_errors) if relative_errors else 0.0\n\n        # Optional check: The sum of cell-wise integrals must equal the total integral\n        # total_source_check = A * (Q_func(L) - Q_func(0.0))\n        # assert np.isclose(total_source_exact, total_source_check)\n        \n        return max_relative_error, total_source_exact\n\n    # --- Define Test Cases ---\n    \n    # Common parameters\n    L = 0.2\n    A = 0.01\n\n    test_cases = [\n        # Case 1: Constant generation, uniform mesh\n        {\n            'mesh_widths': [0.02] * 10,\n            'q_func': lambda x: 1.0e6,\n            'Q_func': lambda x: 1.0e6 * x\n        },\n        # Case 2: Linear variation, nonuniform mesh\n        {\n            'mesh_widths': [0.02, 0.03, 0.05, 0.04, 0.06],\n            'q_func': lambda x: 2.0e6 + 1.0e7 * x,\n            'Q_func': lambda x: 2.0e6 * x + 0.5 * 1.0e7 * x**2\n        },\n        # Case 3: Sinusoidal variation, uniform mesh\n        {\n            'mesh_widths': [0.025] * 8,\n            'q_func': lambda x, c1=4.0e6, c2=3.0e6, k=2*np.pi/0.05: c1 + c2 * np.sin(k * x),\n            'Q_func': lambda x, c1=4.0e6, c2=3.0e6, k=2*np.pi/0.05: c1 * x - (c2 / k) * np.cos(k * x)\n        },\n        # Case 4: Exponential variation, strongly nonuniform mesh\n        {\n            'mesh_widths': [0.08, 0.05, 0.03, 0.02, 0.02],\n            'q_func': lambda x, c1=1.0e6, k=20.0: c1 * np.exp(k * x),\n            'Q_func': lambda x, c1=1.0e6, k=20.0: (c1 / k) * np.exp(k * x)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        e_max, S_tot = solve_case(\n            L, A, case['mesh_widths'], case['q_func'], case['Q_func']\n        )\n        results.extend([e_max, S_tot])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A critical question in computational engineering is: \"How do I know my code is correct?\" The Method of Manufactured Solutions (MMS) provides a rigorous mathematical framework for answering this. This practice  introduces this powerful verification technique, where you will work backward: starting with a chosen \"manufactured\" temperature field, you will derive the unique source term ($q'''$) that makes it an exact solution to the governing heat equation. Implementing this allows you to test every part of a numerical solver—discretized derivatives, source terms, and boundary conditions—against a problem with a known, exact answer, which is essential for building confidence in simulation results.",
            "id": "3960297",
            "problem": "Consider one-dimensional transient heat conduction with internal volumetric heat generation in a homogeneous, isotropic solid occupying the spatial domain $x\\in[0,1]$ for time $t\\ge 0$. Let the thermal conductivity be spatially and temporally constant $k=1\\,\\mathrm{W/(m\\cdot K)}$, and the volumetric heat capacity be constant $\\rho c=1\\,\\mathrm{J/(m^3\\cdot K)}$. The temperature field $T(x,t)$ is governed by conservation of energy expressed as the partial differential equation (PDE)\n$$\n\\rho c\\,\\frac{\\partial T}{\\partial t}=\\frac{\\partial}{\\partial x}\\!\\left(k\\,\\frac{\\partial T}{\\partial x}\\right)+q'''(x,t),\n$$\nwhere $q'''(x,t)$ is the internal heat generation rate per unit volume in $\\mathrm{W/m^3}$. Assume Dirichlet boundary conditions $T(0,t)=0\\,\\mathrm{K}$ and $T(1,t)=0\\,\\mathrm{K}$ for all $t\\ge 0$, and an initial condition $T(x,0)=\\sin(\\pi x)\\,\\mathrm{K}$, with the sine function interpreted using angles in radians. You are to use the method of manufactured solutions: enforce the manufactured temperature field\n$$\nT(x,t)=\\sin(\\pi x)\\,\\mathrm{K}\n$$\nfor all $x\\in[0,1]$ and $t\\ge 0$, and determine the corresponding source term $q'''(x,t)$ that makes this manufactured temperature an exact solution of the PDE under the stated material properties. Begin from the conservation of energy statement given above, and derive $q'''(x,t)$ solely from first principles and differentiation. Then evaluate the derived $q'''(x,t)$ at the specified test suite of points.\n\nPhysical units to use are: meters for $x$, seconds for $t$, and Kelvin for $T$. Express all $q'''$ values in $\\mathrm{W/m^3}$. Angles used within trigonometric functions must be in radians.\n\nYour program must compute the source term $q'''(x,t)$ implied by the manufactured temperature field and produce numerical values (in $\\mathrm{W/m^3}$) for the following ordered test suite of input pairs $(x,t)$:\n- $(x,t)=\\big(0,\\,0\\big)$,\n- $(x,t)=\\big(1,\\,0\\big)$,\n- $(x,t)=\\big(0.25,\\,0\\big)$,\n- $(x,t)=\\big(0.5,\\,0\\big)$,\n- $(x,t)=\\big(0.75,\\,0\\big)$,\n- $(x,t)=\\big(0.5,\\,2\\big)$.\n\nDesign for coverage: the suite includes boundary points $x=0$ and $x=1$, interior symmetry points $x=0.25$, $x=0.5$, $x=0.75$, and two distinct times $t=0$ and $t=2$ to assess any explicit time dependence.\n\nFinal Output Format: Your program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets, in the order listed above, with each value rounded to exactly $8$ decimal places, for example, $[v_1,v_2,v_3,v_4,v_5,v_6]$, where each $v_i$ is a float representing $q'''(x,t)$ in $\\mathrm{W/m^3}$.",
            "solution": "The problem is subjected to validation and is deemed valid. It is scientifically grounded in the principles of heat transfer, mathematically consistent, and well-posed. All necessary data and conditions are provided to determine a unique solution for the source term $q'''(x,t)$. The manufactured solution $T(x,t)=\\sin(\\pi x)$ correctly satisfies the specified initial condition $T(x,0)=\\sin(\\pi x)$ and the boundary conditions $T(0,t)=0$ and $T(1,t)=0$. The problem is a direct application of the method of manufactured solutions, a standard verification technique in computational science.\n\nThe task is to find the internal heat generation rate $q'''(x,t)$ required to sustain a prescribed temperature field $T(x,t)$ within a solid medium. The physical principle governing this process is the conservation of energy, expressed by the given one-dimensional transient heat conduction equation:\n$$\n\\rho c\\,\\frac{\\partial T}{\\partial t}=\\frac{\\partial}{\\partial x}\\!\\left(k\\,\\frac{\\partial T}{\\partial x}\\right)+q'''(x,t)\n$$\nwhere $T$ is the temperature, $t$ is time, $x$ is the spatial coordinate, $\\rho c$ is the volumetric heat capacity, $k$ is the thermal conductivity, and $q'''(x,t)$ is the volumetric source term.\n\nThe material properties are given as constants: $k=1\\,\\mathrm{W/(m\\cdot K)}$ and $\\rho c=1\\,\\mathrm{J/(m^3\\cdot K)}$. With constant $k$, the heat conduction equation simplifies to:\n$$\n\\rho c\\,\\frac{\\partial T}{\\partial t}=k\\,\\frac{\\partial^2 T}{\\partial x^2}+q'''(x,t)\n$$\nTo determine the source term $q'''(x,t)$, we rearrange this equation:\n$$\nq'''(x,t) = \\rho c\\,\\frac{\\partial T}{\\partial t} - k\\,\\frac{\\partial^2 T}{\\partial x^2}\n$$\nThe problem specifies a manufactured solution for the temperature field:\n$$\nT(x,t) = \\sin(\\pi x)\n$$\nWe must now compute the partial derivatives of this function with respect to time $t$ and space $x$.\n\nThe partial derivative with respect to time $t$ is:\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial t}(\\sin(\\pi x)) = 0\n$$\nThis is because the manufactured temperature field is independent of time. This implies a steady-state condition where the temperature at any point $x$ does not change over time.\n\nThe first partial derivative with respect to space $x$ is:\n$$\n\\frac{\\partial T}{\\partial x} = \\frac{\\partial}{\\partial x}(\\sin(\\pi x)) = \\pi \\cos(\\pi x)\n$$\nThe second partial derivative with respect to space $x$ is:\n$$\n\\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial}{\\partial x}(\\pi \\cos(\\pi x)) = -\\pi^2 \\sin(\\pi x)\n$$\nNow, we substitute these derivatives and the given constants ($\\rho c=1$, $k=1$) into the expression for $q'''(x,t)$:\n$$\nq'''(x,t) = (1)\\cdot(0) - (1)\\cdot(-\\pi^2 \\sin(\\pi x))\n$$\nThis simplifies to the final expression for the source term:\n$$\nq'''(x,t) = \\pi^2 \\sin(\\pi x)\n$$\nPhysically, this means that for the temperature field to remain static at $T(x,t) = \\sin(\\pi x)$, the heat generated internally at each point $x$ must exactly balance the heat diffused away to the boundaries. Since the temperature profile and material properties are time-independent, the required source term is also time-independent.\n\nFinally, we evaluate this source term $q'''(x,t)$ at the specified test points $(x,t)$. Note that the function is independent of $t$.\n\n1.  For $(x,t) = (0,0)$:\n    $q'''(0,0) = \\pi^2 \\sin(\\pi \\cdot 0) = \\pi^2 \\cdot 0 = 0$\n\n2.  For $(x,t) = (1,0)$:\n    $q'''(1,0) = \\pi^2 \\sin(\\pi \\cdot 1) = \\pi^2 \\cdot 0 = 0$\n\n3.  For $(x,t) = (0.25,0)$:\n    $q'''(0.25,0) = \\pi^2 \\sin(\\pi \\cdot 0.25) = \\pi^2 \\sin(\\pi/4) = \\pi^2 \\frac{\\sqrt{2}}{2} \\approx 6.97881189\\,\\mathrm{W/m^3}$\n\n4.  For $(x,t) = (0.5,0)$:\n    $q'''(0.5,0) = \\pi^2 \\sin(\\pi \\cdot 0.5) = \\pi^2 \\sin(\\pi/2) = \\pi^2 \\cdot 1 = \\pi^2 \\approx 9.86960440\\,\\mathrm{W/m^3}$\n\n5.  For $(x,t) = (0.75,0)$:\n    $q'''(0.75,0) = \\pi^2 \\sin(\\pi \\cdot 0.75) = \\pi^2 \\sin(3\\pi/4) = \\pi^2 \\frac{\\sqrt{2}}{2} \\approx 6.97881189\\,\\mathrm{W/m^3}$\n\n6.  For $(x,t) = (0.5,2)$:\n    $q'''(0.5,2) = \\pi^2 \\sin(\\pi \\cdot 0.5) = \\pi^2 \\sin(\\pi/2) = \\pi^2 \\cdot 1 = \\pi^2 \\approx 9.86960440\\,\\mathrm{W/m^3}$\n\nThese values will be computed and formatted in the provided Python code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the source term q'''(x,t) for a manufactured temperature profile\n    in a 1D transient heat conduction problem and evaluates it at specific points.\n    \"\"\"\n\n    # The problem asks to solve for the source term q'''(x,t) in the equation:\n    # rho*c * dT/dt = d/dx(k * dT/dx) + q'''(x,t)\n    # Given rho*c = 1, k = 1, and the manufactured solution T(x,t) = sin(pi*x).\n    #\n    # Rearranging for q'''(x,t):\n    # q'''(x,t) = rho*c * dT/dt - k * d^2T/dx^2\n    #\n    # The partial derivatives of T(x,t) = sin(pi*x) are:\n    # dT/dt = 0 (since T is not a function of t)\n    # dT/dx = pi * cos(pi*x)\n    # d^2T/dx^2 = -pi^2 * sin(pi*x)\n    #\n    # Substituting these into the expression for q'''(x,t):\n    # q'''(x,t) = (1)*(0) - (1)*(-pi^2 * sin(pi*x))\n    # q'''(x,t) = pi^2 * sin(pi*x)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.0),\n        (1.0, 0.0),\n        (0.25, 0.0),\n        (0.5, 0.0),\n        (0.75, 0.0),\n        (0.5, 2.0),\n    ]\n\n    results = []\n    for x, t in test_cases:\n        # The derived source term is independent of time t.\n        q_triple_prime = np.pi**2 * np.sin(np.pi * x)\n        results.append(q_triple_prime)\n\n    # Format the results to exactly 8 decimal places.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}