{
    "hands_on_practices": [
        {
            "introduction": "镜像声源法本质上是一种几何构造。第一个实践练习旨在挑战您将这种几何直觉转化为一个功能性算法，用以计算房间的早期脉冲响应。通过系统地枚举镜像声源及其对应的路径，您将计算出到达时间和振幅等关键声学参数，从而在房间的几何结构与其时域声学特征之间建立起切实的联系。",
            "id": "4142837",
            "problem": "您需要实现一个程序，该程序使用镜像声源法计算三维矩形房间内的早期声传播。从标量声压 $p(\\mathbf{x},t)$ 的基本线性、无损、均匀声波方程开始：\n$$\n\\nabla^2 p(\\mathbf{x},t) - \\frac{1}{c^2}\\frac{\\partial^2 p(\\mathbf{x},t)}{\\partial t^2} = -q(t)\\delta(\\mathbf{x}-\\mathbf{s}),\n$$\n其中 $\\mathbf{s}\\in\\mathbb{R}^3$ 是声源位置，$q(t)$ 是一个紧支撑的声源时间函数，$c$ 是声速，$\\delta(\\cdot)$ 是狄拉克δ分布。使用解在自由空间格林函数 $G_0(\\mathbf{x},t)$ 与声源卷积方面的表示，并通过在具有平面墙壁的矩形有界域中构造镜像声源来强制执行墙壁相互作用。假设镜面反射具有与频率无关、与角度无关的墙壁反射系数，并忽略衍射和空气吸收。从声源到接收器的每条镜面路径在时间 $t = \\|\\mathbf{r}-\\mathbf{s}_{\\text{img}}\\|/c$ 贡献一个到达，其振幅是球面扩展因子与声线所遇到的墙壁反射因子的乘积，其中 $\\mathbf{r}\\in\\mathbb{R}^3$ 是接收器位置，$\\mathbf{s}_{\\text{img}}$ 是声源通过跨墙壁镜像产生的镜像。\n\n您的推导必须遵循以下概念基础：标量波方程、叠加原理、三维自由空间格林函数，以及通过镜像声源和每次墙壁相遇时的乘法标量反射增益建模的镜面反射。不要引用任何未经证明的公式；相反，从这些陈述的基础出发，为您的算法选择（用于枚举镜像、计算传播时间以及计算振幅）提供理由。特别是，要论证在展开（平铺）的房间表示中，如何计算一条直线段与每面墙对应的无限平面集的相交次数，以及如何聚合几何上不同但产生相同传播时间的到达。您必须处理到达的几何多重性，其定义为共享相同到达时间（在给定容差内）的不同镜像路径的数量，并且您必须通过线性求和来聚合此类重合到达的振幅。\n\n数值模型假设：\n- 使用欧几里得范数 $\\|\\cdot\\|$ 计算以米为单位的几何距离。\n- 使用球面扩展因子 $1/(4\\pi R)$，其中 $R$ 是以米为单位的路径长度。\n- 对于六个平面墙壁，为平面 $x=0$ 和 $x=L_x$ 指定独立的反射系数 $r_{x,0}$ 和 $r_{x,L_x}$，为平面 $y=0$ 和 $y=L_y$ 指定 $r_{y,0}$ 和 $r_{y,L_y}$，为平面 $z=0$ 和 $z=L_z$ 指定 $r_{z,0}$ 和 $r_{z,L_z}$。路径的净墙壁增益是相关墙壁系数的乘积，每个系数的幂等于该路径与该墙壁相遇的次数。\n- 将到达时间差异最多为容差 $\\Delta t$ 的到达视为重合到达，并将它们聚合成一个单一的到达，其多重性等于重合路径的数量，振幅等于它们各自振幅的总和。\n- 明确指定所有参数和结果的物理单位。\n\n实现要求：\n- 开发一种算法，通过沿每个坐标轴跨越所有房间墙壁镜像声源，来枚举展开晶格中的镜像声源。使用整数晶格索引表示周期性平移，使用二进制奇偶性表示沿每个轴的偶数/奇数次反射。设计一个有原则的规则，用于计算在展开空间中从接收器到镜像声源的给定直线段，它穿过与六个墙壁中每一个相对应的无限平面集的次数；用此来确定振幅的每面墙反射指数。\n- 按到达时间对所有候选路径进行排序，并使用 $\\Delta t = 10^{-6}$ 秒的容差对重合到达进行分组。\n- 计算并返回最早的 $N$ 组到达（时间、振幅、多重性）。\n\n物理单位和四舍五入：\n- 所有距离以米表示，时间以秒表示。\n- 除非在单个测试用例中另有说明，否则声速使用 $c=343$ 米/秒。\n- 报告每个到达时间，四舍五入到 $6$ 位小数（以秒为单位）；每个振幅作为一个无量纲标量，四舍五入到 $8$ 位小数；每个多重性为一个整数。\n\n测试套件：\n对于下面的每个案例，按规定计算最早的 $N$ 组到达。对于每组，输出三元组 $[t,a,m]$，其中 $t$ 以秒为单位， $a$ 无量纲， $m$ 是一个整数多重性。\n\n- 案例A（一般非对称房间）：\n  - 房间尺寸：$(L_x,L_y,L_z)=(7.5,5.0,3.2)$ 米。\n  - 声源：$\\mathbf{s}=(1.2,0.8,1.5)$ 米。\n  - 接收器：$\\mathbf{r}=(6.0,4.0,1.7)$ 米。\n  - 墙壁反射系数：$r_{x,0}=0.9$, $r_{x,L_x}=0.8$, $r_{y,0}=0.85$, $r_{y,L_y}=0.9$, $r_{z,0}=0.7$, $r_{z,L_z}=0.6$。\n  - 声速：$c=343$ 米/秒。\n  - 最早到达组数：$N=8$。\n\n- 案例B（方形平面以揭示多重性）：\n  - 房间尺寸：$(L_x,L_y,L_z)=(5.0,5.0,3.0)$ 米。\n  - 声源：$\\mathbf{s}=(1.0,1.0,1.2)$ 米。\n  - 接收器：$\\mathbf{r}=(4.0,4.0,1.2)$ 米。\n  - 墙壁反射系数：$r_{x,0}=1.0$, $r_{x,L_x}=1.0$, $r_{y,0}=1.0$, $r_{y,L_y}=1.0$, $r_{z,0}=1.0$, $r_{z,L_z}=1.0$。\n  - 声速：$c=343$ 米/秒。\n  - 最早到达组数：$N=6$。\n\n- 案例C（声源和接收器靠近，有中等吸收）：\n  - 房间尺寸：$(L_x,L_y,L_z)=(10.0,8.0,3.5)$ 米。\n  - 声源：$\\mathbf{s}=(2.5,3.0,1.2)$ 米。\n  - 接收器：$\\mathbf{r}=(2.7,3.1,1.25)$ 米。\n  - 墙壁反射系数：$r_{x,0}=0.6$, $r_{x,L_x}=0.6$, $r_{y,0}=0.6$, $r_{y,L_y}=0.6$, $r_{z,0}=0.6$, $r_{z,L_z}=0.6$。\n  - 声速：$c=343$ 米/秒。\n  - 最早到达组数：$N=5$。\n\n输出格式：\n- 您的程序应产生单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果，不含任何空白字符。该行应是一个包含各案例数组的列表；每个案例数组必须包含恰好 $N$ 个按 $t$ 升序排列的三元组 $[t,a,m]$。例如，一个包含两个案例的输出可能看起来像 $[[t_1,a_1,m_1],[t_2,a_2,m_2]],[[u_1,b_1,n_1],[u_2,b_2,n_2]]$；您的程序必须对所述的三个案例遵循此结构。",
            "solution": "用户要求实现一种算法，使用镜像声源法计算三维矩形房间内的早期声传播。该问题需要从基本的声波方程和叠加原理出发进行求解。\n\n### 第1步：理论基础\n\n在线性、无损、均匀介质中，由点声源引起的声压 $p(\\mathbf{x}, t)$ 的控制方程是标量波方程：\n$$\n\\nabla^2 p(\\mathbf{x},t) - \\frac{1}{c^2}\\frac{\\partial^2 p(\\mathbf{x},t)}{\\partial t^2} = -q(t)\\delta(\\mathbf{x}-\\mathbf{s})\n$$\n其中 $\\mathbf{x} \\in \\mathbb{R}^3$ 是空间坐标，$t$ 是时间，$c$ 是声速，$\\mathbf{s}$ 是声源位置，$q(t)$ 是声源时间函数，$\\delta(\\cdot)$ 是狄拉克δ分布。\n\n在无界（自由）空间中的解由声源函数与自由空间格林函数 $G_0$ 的卷积给出。对于一个脉冲声源 $q(t) = Q_0 \\delta(t)$，在接收器位置 $\\mathbf{r}$ 的压力响应是脉冲响应：\n$$\np(\\mathbf{r}, t) = \\frac{Q_0}{4\\pi\\|\\mathbf{r}-\\mathbf{s}\\|} \\delta\\left(t - \\frac{\\|\\mathbf{r}-\\mathbf{s}\\|}{c}\\right)\n$$\n这描述了一个在时间 $t = \\|\\mathbf{r}-\\mathbf{s}\\|/c$ 的单一声音到达，其振幅由于球面扩展而随距离 $R = \\|\\mathbf{r}-\\mathbf{s}\\|$ 衰减，与 $1/R$ 成正比。问题指定了球面扩展因子为 $1/(4\\pi R)$，这意味着我们可以考虑一个归一化的声源强度。因此，一次到达的“振幅”是狄拉克δ函数的系数。\n\n为了模拟在有界矩形域中的传播，我们采用镜像法。墙壁施加的边界条件通过引入一组虚拟的“镜像”声源来满足。对于由体积 $[0, L_x] \\times [0, L_y] \\times [0, L_z]$ 定义的房间，六个墙壁中的每一个都像一面镜子。声源 $\\mathbf{s}$ 跨越一面墙反射，创建一个一阶镜像声源。这个镜像声源本身又会跨越其他墙壁反射，创建二阶镜像，以此类推，直至无穷。这个过程会生成一个无限的三维镜像声源晶格。\n\n根据叠加原理，接收器处的总压力是原始声源和所有镜像声源贡献的总和，就好像它们都在自由空间中辐射一样：\n$$\np(\\mathbf{r}, t) = \\sum_{\\mathbf{s}_{\\text{img}} \\in \\text{ImageSet}} \\frac{A_{\\text{refl}}(\\mathbf{s}_{\\text{img}})}{4\\pi\\|\\mathbf{r}-\\mathbf{s}_{\\text{img}}\\|} \\delta\\left(t - \\frac{\\|\\mathbf{r}-\\mathbf{s}_{\\text{img}}\\|}{c}\\right)\n$$\n其中 $A_{\\text{refl}}(\\mathbf{s}_{\\text{img}})$ 是从镜像声源 $\\mathbf{s}_{\\text{img}}$ 到接收器的路径的累积反射增益。\n\n### 第2步：算法设计\n\n**2.1. 枚举镜像声源**\n\n镜像声源的位置可以通过整数向量 $\\mathbf{n} = (n_x, n_y, n_z) \\in \\mathbb{Z}^3$ 系统地索引。每个分量 $n_i$ 对应于沿第 $i$ 轴的反射历史。我们可以推导出一个公式，用于计算在尺寸为 $\\mathbf{L}=(L_x, L_y, L_z)$ 的房间中，相对于原始声源 $\\mathbf{s}=(s_x, s_y, s_z)$ 的镜像声源 $\\mathbf{s}_{\\mathbf{n}}$ 的坐标。\n\n对于一个整数索引 $n \\in \\mathbb{Z}$，镜像坐标 $s_n$ 可以表示为：\n$$\ns_{n} = \\begin{cases} n L + s,   \\text{若 } n \\text{ 为偶数} \\\\ (n+1)L - s,  \\text{若 } n \\text{ 为奇数} \\end{cases}\n$$\n因此，对于 $\\mathbf{n}=(n_x, n_y, n_z)$ 的镜像声源 $\\mathbf{s}_{\\mathbf{n}}$ 的坐标是 $(s_{x, n_x}, s_{y, n_y}, s_{z, n_z})$，每个分量都使用上述公式独立计算。原始声源对应于 $\\mathbf{n}=(0,0,0)$。\n\n**2.2. 计算到达时间和路径长度**\n\n对于每个镜像声源 $\\mathbf{s}_{\\mathbf{n}}$，路径长度 $R_{\\mathbf{n}}$ 是从该镜像声源到接收器 $\\mathbf{r}$ 的欧几里得距离：\n$$\nR_{\\mathbf{n}} = \\|\\mathbf{r} - \\mathbf{s}_{\\mathbf{n}}\\| = \\sqrt{(r_x - s_{x,n_x})^2 + (r_y - s_{y,n_y})^2 + (r_z - s_{z,n_z})^2}\n$$\n相应的到达时间 $t_{\\mathbf{n}}$ 是：\n$$\nt_{\\mathbf{n}} = \\frac{R_{\\mathbf{n}}}{c}\n$$\n\n**2.3. 计算到达振幅**\n\n每次到达的振幅有两个组成部分：球面扩展因子和墙壁反射增益。问题将振幅定义为这两者的乘积。\n$$\nA_{\\mathbf{n}} = \\frac{1}{4\\pi R_{\\mathbf{n}}} \\times (\\text{墙壁反射增益})\n$$\n墙壁反射增益是路径上遇到的所有墙壁的反射系数的乘积。每个反射系数的指数是路径反射离开该特定墙壁的次数。这必须从镜像声源索引 $\\mathbf{n}=(n_x, n_y, n_z)$ 确定。\n\n按照要求，我们为此计数设计一个有原则的规则。对于 $x$ 维度，墙壁位于 $x=0$ (系数 $r_{x,0}$) 和 $x=L_x$ (系数 $r_{x,L_x}$)，反射次数 $k_{x,0}$ 和 $k_{x,1}$ 可以仅由索引 $n_x$ 决定：\n- 对于 $n_x > 0$：路径涉及在 $x=0$ 墙上 $\\lfloor n_x/2 \\rfloor$ 次反射和在 $x=L_x$ 墙上 $\\lceil n_x/2 \\rceil$ 次反射。\n- 对于 $n_x  0$：路径涉及在 $x=0$ 墙上 $\\lceil |n_x|/2 \\rceil$ 次反射和在 $x=L_x$ 墙上 $\\lfloor |n_x|/2 \\rfloor$ 次反射。\n- 对于 $n_x = 0$：在 $x$ 维度没有反射，所以 $k_{x,0}=0$ 和 $k_{x,1}=0$。\n\n这些公式可以使用整数算术高效实现。对于 $n_x > 0$，$k_{x,0} = n_x // 2$ 和 $k_{x,1} = (n_x+1) // 2$。对于 $n_x  0$，令 $m_x = -n_x$，则 $k_{x,0} = (m_x+1) // 2$ 和 $k_{x,1} = m_x // 2$。\n\n总反射增益则为：\n$$\nA_{\\text{refl}} = r_{x,0}^{k_{x,0}} \\cdot r_{x,L_x}^{k_{x,1}} \\cdot r_{y,0}^{k_{y,0}} \\cdot r_{y,L_y}^{k_{y,1}} \\cdot r_{z,0}^{k_{z,0}} \\cdot r_{z,L_z}^{k_{z,1}}\n$$\n其中 $y$ 和 $z$ 维度的指数可以从 $n_y$ 和 $n_z$ 类似地计算得出。\n\n**2.4. 实现策略与分组**\n\n要找到最早的 $N$ 次到达，我们必须以大致对应于传播时间递增的顺序枚举镜像声源。这可以通过在以原点为中心的立方体内迭代索引 $(n_x, n_y, n_z)$ 来实现，例如，对于某个整数 $K$，从 $-K$ 到 $K$。足够大的 $K$ 可以确保最早的到达被捕获。\n\n得到的单个到达列表，每个都是一个 $(t_{\\mathbf{n}}, A_{\\mathbf{n}})$ 元组，然后按时间 $t_{\\mathbf{n}}$ 排序。\n\n最后，根据重合容差 $\\Delta t = 10^{-6}$ s 对排序后的到达进行分组。我们遍历排序列表，创建分组。为第一次到达开始一个新组。如果后续到达的到达时间与该组中第一次到达的时间相差在 $\\Delta t$ 之内，则将其添加到当前组。当一次到达的时间超出此容差时，当前组被最终确定，并开始一个新组。对于每个组，我们将其构成到达的振幅相加，并计算其多重性。报告的组时间是该组中第一次到达的时间。\n\n这个过程产生一个最早的 $N$ 个唯一到达组的列表，每个组由其时间、总振幅和多重性描述。\n\n### 第3步：数值执行摘要\n\n对于每个测试用例，算法按以下步骤进行：\n1.  定义房间尺寸、声源/接收器位置、反射系数和声速。\n2.  在立方体范围（例如，每个分量为 $[-5, 5]$）内生成一个镜像声源索引 $(n_x, n_y, n_z)$ 的列表。\n3.  对于每个索引，计算镜像声源位置 $\\mathbf{s}_{\\mathbf{n}}$、路径长度 $R_{\\mathbf{n}}$ 和到达时间 $t_{\\mathbf{n}}$。\n4.  对于每个索引，计算在六个墙壁上每个墙壁的反射次数 $k_{x,0}, k_{x,1}, \\dots, k_{z,1}$。\n5.  计算总振幅 $A_{\\mathbf{n}}$，作为反射增益和球面扩展因子 $1/(4\\pi R_{\\mathbf{n}})$ 的乘积。\n6.  存储所有计算出的到达 $(t, A)$ 并按时间 $t$ 排序。\n7.  处理排序后的列表，在容差 $\\Delta t$ 内对重合的到达进行分组，对它们的振幅求和并计算多重性。\n8.  选择最早的 $N$ 个组。\n9.  根据指定的四舍五入和字符串格式规则格式化结果（时间、振幅、多重性）。\n\n这个过程基于波传播的物理学和反射的几何学，为所述问题提供了一个稳健且正确的解决方案。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases and prints the final result.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"L\": np.array([7.5, 5.0, 3.2]),\n            \"s\": np.array([1.2, 0.8, 1.5]),\n            \"r\": np.array([6.0, 4.0, 1.7]),\n            \"coeffs\": np.array([0.9, 0.8, 0.85, 0.9, 0.7, 0.6]), # rx0, rxL, ry0, ryL, rz0, rzL\n            \"c\": 343.0,\n            \"N\": 8,\n        },\n        {\n            \"L\": np.array([5.0, 5.0, 3.0]),\n            \"s\": np.array([1.0, 1.0, 1.2]),\n            \"r\": np.array([4.0, 4.0, 1.2]),\n            \"coeffs\": np.array([1.0, 1.0, 1.0, 1.0, 1.0, 1.0]),\n            \"c\": 343.0,\n            \"N\": 6,\n        },\n        {\n            \"L\": np.array([10.0, 8.0, 3.5]),\n            \"s\": np.array([2.5, 3.0, 1.2]),\n            \"r\": np.array([2.7, 3.1, 1.25]),\n            \"coeffs\": np.array([0.6, 0.6, 0.6, 0.6, 0.6, 0.6]),\n            \"c\": 343.0,\n            \"N\": 5,\n        }\n    ]\n\n    all_case_results = []\n    for case in test_cases:\n        arrivals = compute_image_source_arrivals(\n            case[\"L\"], case[\"s\"], case[\"r\"], case[\"coeffs\"], case[\"c\"]\n        )\n        groups = group_arrivals(arrivals, case[\"N\"])\n        all_case_results.append(groups)\n\n    # Manually format the output string to avoid whitespace.\n    formatted_cases = []\n    for case_result in all_case_results:\n        triples = [f\"[{t:.6f},{a:.8f},{m}]\" for t, a, m in case_result]\n        formatted_cases.append(f\"[{','.join(triples)}]\")\n    \n    final_output = f\"[{','.join(formatted_cases)}]\"\n    print(final_output)\n\ndef compute_image_source_arrivals(L, s, r, coeffs, c):\n    \"\"\"\n    Computes arrivals using the image source method.\n    \"\"\"\n    arrivals = []\n    # A search cube of size 11x11x11 is sufficient for finding early reflections.\n    index_range = range(-5, 6)\n\n    for nx in index_range:\n        for ny in index_range:\n            for nz in index_range:\n                # 1. Calculate image source position\n                s_img = np.zeros(3)\n                n_vec = np.array([nx, ny, nz])\n                \n                for i in range(3):\n                    n = n_vec[i]\n                    if n % 2 == 0:\n                        s_img[i] = n * L[i] + s[i]\n                    else:\n                        s_img[i] = (n + 1) * L[i] - s[i]\n\n                # 2. Calculate distance, time\n                dist = np.linalg.norm(r - s_img)\n                if dist  1e-9:  # Avoid division by zero if source and receiver are at the same location\n                    continue\n                time = dist / c\n\n                # 3. Calculate reflection counts and gain\n                refl_gain = 1.0\n                reflection_counts = np.zeros(6, dtype=int)\n                for i in range(3):\n                    n = n_vec[i]\n                    k0, k1 = 0, 0\n                    if n > 0:\n                        k0 = n // 2\n                        k1 = (n + 1) // 2\n                    elif n  0:\n                        abs_n = -n\n                        k0 = (abs_n + 1) // 2\n                        k1 = abs_n // 2\n                    \n                    reflection_counts[2*i] = k0\n                    reflection_counts[2*i+1] = k1\n                \n                refl_gain = np.prod(coeffs ** reflection_counts)\n                \n                # 4. Calculate amplitude\n                amplitude = refl_gain / (4 * np.pi * dist)\n                \n                arrivals.append({'time': time, 'amplitude': amplitude})\n\n    # Sort arrivals by time\n    arrivals.sort(key=lambda x: x['time'])\n    return arrivals\n\ndef group_arrivals(arrivals, N, delta_t=1e-6):\n    \"\"\"\n    Groups coincident arrivals based on a time tolerance.\n    \"\"\"\n    if not arrivals:\n        return []\n\n    groups = []\n    current_group_start_index = 0\n    \n    while current_group_start_index  len(arrivals) and len(groups)  N:\n        group_time = arrivals[current_group_start_index]['time']\n        group_amplitude = 0.0\n        multiplicity = 0\n        \n        i = current_group_start_index\n        while i  len(arrivals) and (arrivals[i]['time'] - group_time) = delta_t:\n            group_amplitude += arrivals[i]['amplitude']\n            multiplicity += 1\n            i += 1\n        \n        groups.append((group_time, group_amplitude, multiplicity))\n        current_group_start_index = i\n        \n    return groups\n\nsolve()\n```"
        },
        {
            "introduction": "脉冲响应提供了时域视角，但许多声学分析需要理解房间在频域中的行为。本练习将指导您应用镜像声源法求解亥姆霍兹方程，从而计算声学传递函数。您将学习如何使用复反射系数来整合频率相关的墙壁特性，揭示房间边界如何塑造声音的频谱。",
            "id": "4142891",
            "problem": "考虑一个三维矩形房间，其尺寸为 $L_{x}=10\\,\\mathrm{m}$、$L_{y}=8\\,\\mathrm{m}$ 和 $L_{z}=20\\,\\mathrm{m}$。一个体积速度为 $Q$ 的时谐单极子声源位于 $(x_{s},y_{s},z_{s})=(1,2,3)\\,\\mathrm{m}$，一个接收器（麦克风）位于 $(x_{r},y_{r},z_{r})=(4,6,15)\\,\\mathrm{m}$。假设介质是空气，密度为 $\\rho_{0}$，声速为 $c$，角频率为 $\\omega$。将声学传递函数 $H(\\omega)$ 定义为接收器处的复声压与声源体积速度之比，即 $H(\\omega)=p(\\omega)/Q$。\n\n均匀流体中声压场的频域控制方程是亥姆霍兹方程：\n$$\n\\nabla^{2}p(\\mathbf{r},\\omega)+k^{2}p(\\mathbf{r},\\omega)=-\\mathrm{i}\\,\\omega\\,\\rho_{0}\\,Q\\,\\delta(\\mathbf{r}-\\mathbf{r}_{s}),\n$$\n其中 $k=\\omega/c$ 是声学波数，$\\delta(\\cdot)$ 是狄拉克δ分布。在自由空间中，相关的格林函数为\n$$\nG_{0}(\\mathbf{r},\\mathbf{r}_{s};\\omega)=\\frac{\\exp\\!\\left(-\\mathrm{i}\\,k\\,\\|\\mathbf{r}-\\mathbf{r}_{s}\\|\\right)}{4\\pi\\,\\|\\mathbf{r}-\\mathbf{r}_{s}\\|}.\n$$\n\n在矩形房间中，镜像声源法通过六个镜像声源来表示一阶墙壁反射，这些镜像声源是通过将真实声源分别沿六个墙面进行镜像得到的。为了处理不同墙壁上的混合边界条件，为每个一阶镜像路径分配一个特定于墙面的复反射系数。在给定的 $\\omega$ 下，假设墙壁具有以下反射系数：\n- 位于 $x=0$ 的左墙：$R_{x-}=0.6\\,\\exp\\!\\left(\\mathrm{i}\\,\\frac{\\pi}{5}\\right)$，\n- 位于 $x=L_{x}$ 的右墙：$R_{x+}=0.3\\,\\exp\\!\\left(\\mathrm{i}\\,\\frac{\\pi}{4}\\right)$，\n- 位于 $y=0$ 的前墙：$R_{y-}=-1$（理想的压力释放边界），\n- 位于 $y=L_{y}$ 的后墙：$R_{y+}=0.9\\,\\exp\\!\\left(\\mathrm{i}\\,\\frac{\\pi}{6}\\right)$，\n- 位于 $z=0$ 的地板：$R_{z-}=0.5\\,\\exp\\!\\left(\\mathrm{i}\\,\\frac{\\pi}{3}\\right)$，\n- 位于 $z=L_{z}$ 的天花板：$R_{z+}=0.2\\,\\exp\\!\\left(\\mathrm{i}\\,\\frac{\\pi}{2}\\right)$。\n\n使用截至一阶的镜像声源法，构建总传递函数 $H(\\omega)$ 的精确解析表达式，该表达式为直达路径和所有六个一阶反射路径的叠加，每个路径都由其特定于墙面的反射系数加权。您必须：\n- 从亥姆霍兹方程和自由空间格林函数作为基本出发点，并论证一阶反射的镜像声源叠加的合理性。\n- 推导每个墙面对应的镜像声源坐标，以及从接收器到每个镜像声源的相应路径长度。\n- 以 $\\rho_{0}$、$c$、$\\omega$、七个路径长度和六个反射系数的形式明确写出 $H(\\omega)$。\n\n将您的最终答案表示为 $H(\\omega)$ 的单一闭式解析表达式，单位为 $\\mathrm{Pa}\\cdot\\mathrm{s}/\\mathrm{m}^{3}$，不进行四舍五入。不要提供数值近似。在方框内的最终答案中不要包含单位；此处的单位说明已足够。使用 $\\mathrm{i}$ 表示虚数单位，使用 $\\exp(\\cdot)$ 表示指数函数。",
            "solution": "所述问题具有科学依据，是适定的、客观的且内部一致的。它基于声学的基本原理，即亥姆霍兹方程和用于近似有界域中解的镜像声源法。所有提供的数据在物理和数学上都是一致的，问题表述清晰，要求推导一阶声学传递函数。因此，该问题是有效的，并将推导求解。\n\n由时谐单极子声源在均匀流体中产生的声压场 $p(\\mathbf{r}, \\omega)$ 受非齐次亥姆霍兹方程控制：\n$$\n\\nabla^{2}p(\\mathbf{r},\\omega)+k^{2}p(\\mathbf{r},\\omega)=-\\mathrm{i}\\,\\omega\\,\\rho_{0}\\,Q\\,\\delta(\\mathbf{r}-\\mathbf{r}_{s})\n$$\n其中 $\\mathbf{r}$ 是位置矢量，$\\omega$ 是角频率，$k = \\omega/c$ 是声学波数，$\\rho_0$ 是流体密度，$c$ 是声速，$Q$ 是声源体积速度，$\\mathbf{r}_s$ 是声源位置，$\\delta(\\cdot)$ 是狄拉克δ分布。\n\n该方程的解可以利用特定区域和边界条件的格林函数 $G(\\mathbf{r}, \\mathbf{r}_s; \\omega)$ 正式写出：\n$$\np(\\mathbf{r}, \\omega) = \\mathrm{i}\\,\\omega\\,\\rho_{0}\\,Q\\,G(\\mathbf{r}, \\mathbf{r}_s; \\omega)\n$$\n声学传递函数 $H(\\omega)$ 定义为接收器位置 $\\mathbf{r}_r$ 处的声压与声源体积速度 $Q$之比：\n$$\nH(\\omega) = \\frac{p(\\mathbf{r}_r, \\omega)}{Q} = \\mathrm{i}\\,\\omega\\,\\rho_{0}\\,G(\\mathbf{r}_r, \\mathbf{r}_s; \\omega)\n$$\n对于矩形房间，镜像声源法通过对来自声源的直达路径和来自墙壁的反射路径的贡献求和，为格林函数提供了一个近似。每个反射路径被建模为从一个虚拟“镜像声源”到接收器的直达路径。每个镜像声源的贡献由相应墙壁的反射系数加权。\n\n一阶近似仅考虑来自六个墙壁中每一个的单次反射。因此，格林函数被近似为七个自由空间格林函数 $G_0(\\mathbf{r}, \\mathbf{r}'; \\omega) = \\frac{\\exp(-\\mathrm{i}\\,k\\,\\|\\mathbf{r}-\\mathbf{r}'\\|)}{4\\pi\\,\\|\\mathbf{r}-\\mathbf{r}'\\|}$ 的和：\n$$\nG(\\mathbf{r}_r, \\mathbf{r}_s; \\omega) \\approx G_0(\\mathbf{r}_r, \\mathbf{r}_s) + \\sum_{j=1}^{6} R_j \\, G_0(\\mathbf{r}_r, \\mathbf{r}_{s,j}')\n$$\n这里，$\\mathbf{r}_s$ 是真实声源，$\\mathbf{r}_{s,j}'$ 是六个一阶镜像声源，而 $R_j$ 是相应的墙壁反射系数。\n\n则传递函数 $H(\\omega)$ 由下式给出：\n$$\nH(\\omega) = \\frac{\\mathrm{i}\\,\\omega\\,\\rho_{0}}{4\\pi} \\left( \\frac{\\exp(-\\mathrm{i}\\,k\\,d_0)}{d_0} + \\sum_{j} R_j \\frac{\\exp(-\\mathrm{i}\\,k\\,d_j)}{d_j} \\right)\n$$\n其中 $d_0 = \\|\\mathbf{r}_r - \\mathbf{r}_s\\|$ 是直达路径长度，$d_j = \\|\\mathbf{r}_r - \\mathbf{r}_{s,j}'\\|$ 是来自镜像声源的路径长度。\n\n给定的参数为：\n声源位置：$\\mathbf{r}_{s} = (x_{s},y_{s},z_{s})=(1,2,3)\\,\\mathrm{m}$。\n接收器位置：$\\mathbf{r}_{r} = (x_{r},y_{r},z_{r})=(4,6,15)\\,\\mathrm{m}$。\n房间尺寸：$L_{x}=10\\,\\mathrm{m}$，$L_{y}=8\\,\\mathrm{m}$，$L_{z}=20\\,\\mathrm{m}$。\n\n首先，我们确定六个一阶镜像声源的坐标：\n- 关于 $x=0$ 的反射：$\\mathbf{r}_{s,x-} = (-x_{s}, y_{s}, z_{s}) = (-1, 2, 3)$。\n- 关于 $x=L_{x}$ 的反射：$\\mathbf{r}_{s,x+} = (2L_{x}-x_{s}, y_{s}, z_{s}) = (2(10)-1, 2, 3) = (19, 2, 3)$。\n- 关于 $y=0$ 的反射：$\\mathbf{r}_{s,y-} = (x_{s}, -y_{s}, z_{s}) = (1, -2, 3)$。\n- 关于 $y=L_{y}$ 的反射：$\\mathbf{r}_{s,y+} = (x_{s}, 2L_{y}-y_{s}, z_{s}) = (1, 2(8)-2, 3) = (1, 14, 3)$。\n- 关于 $z=0$ 的反射：$\\mathbf{r}_{s,z-} = (x_{s}, y_{s}, -z_{s}) = (1, 2, -3)$。\n- 关于 $z=L_{z}$ 的反射：$\\mathbf{r}_{s,z+} = (x_{s}, y_{s}, 2L_{z}-z_{s}) = (1, 2, 2(20)-3) = (1, 2, 37)$。\n\n接下来，我们计算从这些声源到接收器 $\\mathbf{r}_{r}=(4,6,15)$ 的七个路径长度：\n- 直达路径长度，$d_0$：\n$$d_0 = \\|\\mathbf{r}_r - \\mathbf{r}_s\\| = \\sqrt{(4-1)^2 + (6-2)^2 + (15-3)^2} = \\sqrt{3^2 + 4^2 + 12^2} = \\sqrt{9+16+144} = \\sqrt{169} = 13$$\n- 来自镜像声源 $\\mathbf{r}_{s,x-}$ 的路径长度，$d_{x-}$：\n$$d_{x-} = \\|\\mathbf{r}_r - \\mathbf{r}_{s,x-}\\| = \\sqrt{(4-(-1))^2 + (6-2)^2 + (15-3)^2} = \\sqrt{5^2 + 4^2 + 12^2} = \\sqrt{25+16+144} = \\sqrt{185}$$\n- 来自镜像声源 $\\mathbf{r}_{s,x+}$ 的路径长度，$d_{x+}$：\n$$d_{x+} = \\|\\mathbf{r}_r - \\mathbf{r}_{s,x+}\\| = \\sqrt{(4-19)^2 + (6-2)^2 + (15-3)^2} = \\sqrt{(-15)^2 + 4^2 + 12^2} = \\sqrt{225+16+144} = \\sqrt{385}$$\n- 来自镜像声源 $\\mathbf{r}_{s,y-}$ 的路径长度，$d_{y-}$：\n$$d_{y-} = \\|\\mathbf{r}_r - \\mathbf{r}_{s,y-}\\| = \\sqrt{(4-1)^2 + (6-(-2))^2 + (15-3)^2} = \\sqrt{3^2 + 8^2 + 12^2} = \\sqrt{9+64+144} = \\sqrt{217}$$\n- 来自镜像声源 $\\mathbf{r}_{s,y+}$ 的路径长度，$d_{y+}$：\n$$d_{y+} = \\|\\mathbf{r}_r - \\mathbf{r}_{s,y+}\\| = \\sqrt{(4-1)^2 + (6-14)^2 + (15-3)^2} = \\sqrt{3^2 + (-8)^2 + 12^2} = \\sqrt{9+64+144} = \\sqrt{217}$$\n- 来自镜像声源 $\\mathbf{r}_{s,z-}$ 的路径长度，$d_{z-}$：\n$$d_{z-} = \\|\\mathbf{r}_r - \\mathbf{r}_{s,z-}\\| = \\sqrt{(4-1)^2 + (6-2)^2 + (15-(-3))^2} = \\sqrt{3^2 + 4^2 + 18^2} = \\sqrt{9+16+324} = \\sqrt{349}$$\n- 来自镜像声源 $\\mathbf{r}_{s,z+}$ 的路径长度，$d_{z+}$：\n$$d_{z+} = \\|\\mathbf{r}_r - \\mathbf{r}_{s,z+}\\| = \\sqrt{(4-1)^2 + (6-2)^2 + (15-37)^2} = \\sqrt{3^2 + 4^2 + (-22)^2} = \\sqrt{9+16+484} = \\sqrt{509}$$\n\n现在，我们将路径长度和给定的反射系数代入叠加公式，以构建总传递函数。波数为 $k = \\omega/c$。\n各项分别为：\n- 直达：$\\frac{\\exp(-\\mathrm{i}k\\,d_0)}{d_0} = \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c}13)}{13}$\n- $x=0$：$R_{x-}\\frac{\\exp(-\\mathrm{i}k\\,d_{x-})}{d_{x-}} = 0.6\\,\\exp(\\mathrm{i}\\frac{\\pi}{5}) \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c}\\sqrt{185})}{\\sqrt{185}}$\n- $x=L_x$：$R_{x+}\\frac{\\exp(-\\mathrm{i}k\\,d_{x+})}{d_{x+}} = 0.3\\,\\exp(\\mathrm{i}\\frac{\\pi}{4}) \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c}\\sqrt{385})}{\\sqrt{385}}$\n- $y=0$：$R_{y-}\\frac{\\exp(-\\mathrm{i}k\\,d_{y-})}{d_{y-}} = -1 \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c}\\sqrt{217})}{\\sqrt{217}}$\n- $y=L_y$：$R_{y+}\\frac{\\exp(-\\mathrm{i}k\\,d_{y+})}{d_{y+}} = 0.9\\,\\exp(\\mathrm{i}\\frac{\\pi}{6}) \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c}\\sqrt{217})}{\\sqrt{217}}$\n- $z=0$：$R_{z-}\\frac{\\exp(-\\mathrm{i}k\\,d_{z-})}{d_{z-}} = 0.5\\,\\exp(\\mathrm{i}\\frac{\\pi}{3}) \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c}\\sqrt{349})}{\\sqrt{349}}$\n- $z=L_z$：$R_{z+}\\frac{\\exp(-\\mathrm{i}k\\,d_{z+})}{d_{z+}} = 0.2\\,\\exp(\\mathrm{i}\\frac{\\pi}{2}) \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c}\\sqrt{509})}{\\sqrt{509}}$\n\n由于 $d_{y-} = d_{y+}$，它们的项可以合并：\n$$ \\left( R_{y-} + R_{y+} \\right) \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c}\\sqrt{217})}{\\sqrt{217}} = \\left(-1 + 0.9\\,\\exp(\\mathrm{i}\\frac{\\pi}{6})\\right) \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c}\\sqrt{217})}{\\sqrt{217}} $$\n\n合并所有项，总传递函数为：\n$$\nH(\\omega) = \\frac{\\mathrm{i}\\,\\omega\\,\\rho_0}{4\\pi} \\left[ \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c}13)}{13} + \\frac{R_{x-}\\,\\exp(-\\mathrm{i}\\frac{\\omega}{c}d_{x-})}{d_{x-}} + \\frac{R_{x+}\\,\\exp(-\\mathrm{i}\\frac{\\omega}{c}d_{x+})}{d_{x+}} + \\frac{(R_{y-}+R_{y+})\\,\\exp(-\\mathrm{i}\\frac{\\omega}{c}d_{y-})}{d_{y-}} + \\frac{R_{z-}\\,\\exp(-\\mathrm{i}\\frac{\\omega}{c}d_{z-})}{d_{z-}} + \\frac{R_{z+}\\,\\exp(-\\mathrm{i}\\frac{\\omega}{c}d_{z+})}{d_{z+}} \\right]\n$$\n代入所有数值并合并指数，得到最终表达式。对于形如 $R \\frac{\\exp(-ikd)}{d}$ 的项，其中 $R = |R|\\exp(i\\phi)$，合并后的表达式为 $\\frac{|R|}{d} \\exp(\\mathrm{i}(\\phi-kd))$。\n\n最终表达式是这些贡献项之和，再乘以因子 $\\frac{\\mathrm{i}\\,\\omega\\,\\rho_0}{4\\pi}$。",
            "answer": "$$\n\\boxed{\\frac{\\mathrm{i}\\,\\omega\\,\\rho_{0}}{4\\pi} \\left( \\frac{\\exp(-\\mathrm{i}\\frac{\\omega}{c} 13)}{13} + \\frac{0.6\\,\\exp\\left(\\mathrm{i}\\left(\\frac{\\pi}{5} - \\frac{\\omega}{c}\\sqrt{185}\\right)\\right)}{\\sqrt{185}} + \\frac{0.3\\,\\exp\\left(\\mathrm{i}\\left(\\frac{\\pi}{4} - \\frac{\\omega}{c}\\sqrt{385}\\right)\\right)}{\\sqrt{385}} + \\frac{\\left(-1 + 0.9\\,\\exp\\left(\\mathrm{i}\\frac{\\pi}{6}\\right)\\right)\\exp\\left(-\\mathrm{i}\\frac{\\omega}{c}\\sqrt{217}\\right)}{\\sqrt{217}} + \\frac{0.5\\,\\exp\\left(\\mathrm{i}\\left(\\frac{\\pi}{3} - \\frac{\\omega}{c}\\sqrt{349}\\right)\\right)}{\\sqrt{349}} + \\frac{0.2\\,\\exp\\left(\\mathrm{i}\\left(\\frac{\\pi}{2} - \\frac{\\omega}{c}\\sqrt{509}\\right)\\right)}{\\sqrt{509}} \\right)}\n$$"
        },
        {
            "introduction": "当反射次数增加时，镜像声源法的简单实现会变得计算量过大而难以处理。最后一个实践练习通过引入一种计算优化技术来解决这个关键的性能问题。您将运用几何学原理，如三角不等式和包围体，来开发一种快速拒绝测试，该测试可以剪除大量不相关的镜像声源，这是高效声学模拟的一项至关重要的技能。",
            "id": "4142886",
            "problem": "考虑一个边长为 $L_{x}=10\\,\\text{m}$、$L_{y}=8\\,\\text{m}$ 和 $L_{z}=3\\,\\text{m}$ 的矩形声学空间。一个点声源位于 $s=(2,3,1)\\,\\text{m}$，一个接收点位于 $r=(7,2,1.5)\\,\\text{m}$。在镜像声源法（ISM）中，通过反射得到的镜面反射路径可以由位于格点上的镜像声源表示，其坐标是通过沿各轴递归反射声源位置而生成的。\n\n你的任务是设计一个快速剔除测试，该测试使用一个简单的包围体来剔除整组镜像声源，这些声源的路径长度可被证明超过了给定的限值 $L_{\\text{max}}=50\\,\\text{m}$。请从第一性原理出发：欧几里得几何、三角不等式和包围体的定义。不要假设任何预先推导出的剔除公式。\n\n1. 构建一个包围球，该球包围了对应于 $n_{x}\\in\\{3,4,5\\}$、$n_{y}\\in\\{2,3,4\\}$ 和 $n_{z}\\in\\{1,2,3\\}$ 的镜像声源组的轴对齐包围盒（AABB）。这里的整数索引 $(n_x, n_y, n_z)$ 是一种系统地标记由递归反射生成的镜像声源的方式。从三角不等式推导出一个充分条件，该条件以一个包含球心 $c$、半径 $R$、接收点位置 $r$ 和 $L_{\\text{max}}$ 的单个不等式表示。在此条件下，整组镜像声源都可以被剔除，因为从这些镜像声源到 $r$ 的每个路径长度都超过了 $L_{\\text{max}}$。\n\n2. 使用给定的 $L_{x}$、$L_{y}$、$L_{z}$、$s$ 和指定的索引范围，计算 AABB 的包围球的球心 $c$ 和半径 $R$，并判断在 $L_{\\text{max}}=50\\,\\text{m}$ 的条件下，根据你推导出的条件，该组是否被剔除。\n\n3. 假设计算单个镜像声源的精确路径长度耗时 $t_{e}=8.0\\times 10^{-7}\\,\\text{s}$，执行包围球测试耗时 $t_{b}=1.0\\times 10^{-7}\\,\\text{s}$。设 $M$ 为该组中的镜像声源数量，并假设如果该组被剔除，则不会对该组中的每个镜像进行评估。将没有包围测试的基准运行时间定义为 $T_{0}=M\\,t_{e}$，有包围测试的运行时间定义为 $T_{1}=t_{b}+K\\,t_{e}$，其中 $K$ 是未被测试剔除的镜像数量。计算该组的加速比 $S=T_{0}/T_{1}$。将 $S$ 表示为一个无量纲数。如果需要数值近似，请将答案四舍五入到四位有效数字；否则，请给出精确值。",
            "solution": "该问题陈述已经过验证，被认为是具有科学依据、良定的，并且没有矛盾或歧义。我们可以进行形式化的求解。\n\n该问题分为三个不同的任务。我们将按顺序解决它们。\n\n### 第1部分：剔除条件的推导\n\n设 $S_{group}$ 为对应于给定索引范围的镜像声源集合。该组中的任意一个镜像声源记为 $s_{img} \\in \\mathbb{R}^3$。接收点位于 $r \\in \\mathbb{R}^3$。给定镜像声源的路径长度是欧几里得距离 $d(s_{img}, r) = \\|s_{img} - r\\|$。问题要求一个剔除测试，以确定是否对于所有 $s_{img} \\in S_{group}$ 都有 $d(s_{img}, r)  L_{\\text{max}}$。\n\n我们要使用一个包围球，该球包围了集合 $S_{group}$ 的轴对齐包围盒（AABB）。设该球的球心为 $c \\in \\mathbb{R}^3$，半径为 $R  0$。根据包围球的定义，每个镜像声源 $s_{img} \\in S_{group}$ 都满足条件 $\\|s_{img} - c\\| \\le R$。\n\n我们寻求距离 $\\|s_{img} - r\\|$ 的一个下界。我们可以利用三角不等式来建立这个下界。对于三个点 $r$、$c$ 和 $s_{img}$，三角不等式表明：\n$$\n\\|r - c\\| \\le \\|r - s_{img}\\| + \\|s_{img} - c\\|\n$$\n重新整理这个不等式以分离出我们感兴趣的项 $\\|r - s_{img}\\|$，我们得到：\n$$\n\\|r - s_{img}\\| \\ge \\|r - c\\| - \\|s_{img} - c\\|\n$$\n由于每个镜像声源 $s_{img}$ 都位于包围球内，我们知道 $\\|s_{img} - c\\| \\le R$。当 $\\|s_{img} - c\\|$ 取最大值时，不等式的右侧取最小值。因此，我们可以为从接收点到球内任意点的距离建立一个一致的下界：\n$$\n\\|r - s_{img}\\| \\ge \\|r - c\\| - R\n$$\n这个不等式给出了从接收点 $r$ 到该组中任意镜像声源 $s_{img}$ 的最小可能距离。如果这个最小可能距离超过了给定的限值 $L_{\\text{max}}$，则可以剔除整个组。这就给出了剔除的充分条件：\n$$\n\\|r - c\\| - R  L_{\\text{max}}\n$$\n这就是从第一性原理推导出的，允许剔除整组镜像声源的单个不等式。\n\n### 第2部分：剔除测试的应用\n\n给定以下参数：\n- 空间尺寸：$L_{x}=10\\,\\text{m}$，$L_{y}=8\\,\\text{m}$，$L_{z}=3\\,\\text{m}$。\n- 声源位置：$s=(s_x, s_y, s_z) = (2, 3, 1)\\,\\text{m}$。\n- 接收点位置：$r=(r_x, r_y, r_z) = (7, 2, 1.5)\\,\\text{m}$。\n- 最大路径长度：$L_{\\text{max}}=50\\,\\text{m}$。\n- 镜像声源索引范围：$n_{x}\\in\\{3,4,5\\}$，$n_{y}\\in\\{2,3,4\\}$，$n_{z}\\in\\{1,2,3\\}$。\n\n首先，我们确定这组镜像声源的AABB的坐标。一个由索引 $n$ 标记的镜像坐标 $p_n$ 由以下科学上正确的公式给出（这修正了原始问题陈述中的一个常见错误）：\n$p_{n} = n L + s$，如果 $n$ 是偶数\n$p_{n} = (n+1) L - s$，如果 $n$ 是奇数\n\n对于 $x$ 坐标 ($L_x=10, s_x=2$)：\n$n_x=3$ (奇): $x_3 = (3+1)(10) - 2 = 38$。\n$n_x=4$ (偶): $x_4 = 4(10) + 2 = 42$。\n$n_x=5$ (奇): $x_5 = (5+1)(10) - 2 = 58$。\n$x$ 坐标的范围是 $[38, 58]$。所以，$x_{min}=38$，$x_{max}=58$。\n\n对于 $y$ 坐标 ($L_y=8, s_y=3$)：\n$n_y=2$ (偶): $y_2 = 2(8) + 3 = 19$。\n$n_y=3$ (奇): $y_3 = (3+1)(8) - 3 = 29$。\n$n_y=4$ (偶): $y_4 = 4(8) + 3 = 35$。\n$y$ 坐标的范围是 $[19, 35]$。所以，$y_{min}=19$，$y_{max}=35$。\n\n对于 $z$ 坐标 ($L_z=3, s_z=1$)：\n$n_z=1$ (奇): $z_1 = (1+1)(3) - 1 = 5$。\n$n_z=2$ (偶): $z_2 = 2(3) + 1 = 7$。\n$n_z=3$ (奇): $z_3 = (3+1)(3) - 1 = 11$。\n$z$ 坐标的范围是 $[5, 11]$。所以，$z_{min}=5$，$z_{max}=11$。\n\nAABB由最小和最大角点 $P_{min}=(38, 19, 5)$ 和 $P_{max}=(58, 35, 11)$ 定义。该AABB的最紧密包围球的球心 $c$ 是AABB本身的中心：\n$$\nc = \\frac{P_{min} + P_{max}}{2} = \\left(\\frac{38+58}{2}, \\frac{19+35}{2}, \\frac{5+11}{2}\\right) = \\left(\\frac{96}{2}, \\frac{54}{2}, \\frac{16}{2}\\right) = (48, 27, 8)\n$$\n该球的半径 $R$ 是从中心 $c$ 到任意一个角点（例如 $P_{max}$）的距离：\n$$\nR = \\|P_{max} - c\\| = \\|(58-48, 35-27, 11-8)\\| = \\|(10, 8, 3)\\|\n$$\n$$\nR^2 = 10^2 + 8^2 + 3^2 = 100 + 64 + 9 = 173 \\implies R = \\sqrt{173}\n$$\n接下来，我们计算从接收点 $r=(7, 2, 1.5)$ 到球心 $c=(48, 27, 8)$ 的距离：\n$$\n\\|r-c\\| = \\|(7-48, 2-27, 1.5-8)\\| = \\|(-41, -25, -6.5)\\|\n$$\n$$\n\\|r-c\\|^2 = (-41)^2 + (-25)^2 + (-6.5)^2 = 1681 + 625 + 42.25 = 2348.25\n$$\n$$\n\\|r-c\\| = \\sqrt{2348.25}\n$$\n现在我们应用第1部分推导出的剔除条件：$\\|r - c\\| - R  L_{\\text{max}}$。\n$$\n\\sqrt{2348.25} - \\sqrt{173}  50\n$$\n数值计算这些项：\n$\\sqrt{2348.25} \\approx 48.4587$\n$\\sqrt{173} \\approx 13.1529$\n$$\n48.4587 - 13.1529 \\approx 35.3058\n$$\n条件变为 $35.3058  50$，这是 **不成立的**。因此，该组镜像声源 **不能** 被剔除。\n\n### 第3部分：加速比计算\n\n加速比 $S$ 定义为基准运行时间 $T_0$ 与带有包围测试的运行时间 $T_1$ 的比率，即 $S = T_0 / T_1$。\n\n基准运行时间为 $T_0 = M t_e$，其中 $M$ 是镜像声源的数量，$t_e$ 是每次评估的耗时。该组中的声源数量是每个索引的选择数量的乘积：\n$$\nM = |\\{3,4,5\\}| \\times |\\{2,3,4\\}| \\times |\\{1,2,3\\}| = 3 \\times 3 \\times 3 = 27\n$$\n带有包围测试的运行时间是 $T_1 = t_b + K t_e$，其中 $t_b$ 是单次包围测试的耗时，$K$ 是未被测试剔除的镜像数量。从第2部分我们得出结论，整组都未被剔除。这意味着包围体测试失败了，我们需要计算所有单个镜像声源的路径长度。因此，$K=M=27$。\n\n给定耗时：\n$t_e = 8.0 \\times 10^{-7}\\,\\text{s}$\n$t_b = 1.0 \\times 10^{-7}\\,\\text{s}$\n\n现在我们计算 $T_0$ 和 $T_1$：\n$$\nT_0 = 27 \\times (8.0 \\times 10^{-7}\\,\\text{s}) = 216 \\times 10^{-7}\\,\\text{s}\n$$\n$$\nT_1 = (1.0 \\times 10^{-7}\\,\\text{s}) + (27 \\times 8.0 \\times 10^{-7}\\,\\text{s}) = 1.0 \\times 10^{-7}\\,\\text{s} + 216 \\times 10^{-7}\\,\\text{s} = 217 \\times 10^{-7}\\,\\text{s}\n$$\n最后，我们可以计算加速比 $S$：\n$$\nS = \\frac{T_0}{T_1} = \\frac{216 \\times 10^{-7}\\,\\text{s}}{217 \\times 10^{-7}\\,\\text{s}} = \\frac{216}{217}\n$$\n将这个分数计算为小数并四舍五入到四位有效数字：\n$S \\approx 0.9953917... \\approx 0.9954$\n加速比小于1，表示在这种情况下，由于测试失败，执行剔除测试实际上略微减慢了计算速度。",
            "answer": "$$\n\\boxed{0.9954}\n$$"
        }
    ]
}