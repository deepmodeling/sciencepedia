{
    "hands_on_practices": [
        {
            "introduction": "浸入边界法和水平集法提供了一个强大的框架来模拟复杂界面。为了建立对这些方法的信心，我们首先从一个经典声学问题入手：平面波在两种不同流体界面上的正入射。这个练习  将指导你从基本控制方程出发，利用浸入边界和水平集方法的思想，推导出界面的连续性条件，并最终获得反射和透射系数。通过这个过程，你将验证这些现代计算方法如何与基础物理原理和谐统一。",
            "id": "4127025",
            "problem": "考虑占据半空间 $x0$ 和 $x>0$ 的两种半无限、无粘性、可压缩流体，它们被一个位于 $x=0$ 处的完美尖锐的平面界面所分隔。设在 $x0$ 和 $x>0$ 中的质量密度分别为 $\\rho_{1}$ 和 $\\rho_{2}$，体积模量分别为 $K_{1}$ 和 $K_{2}$。声速为 $c_{j}=\\sqrt{K_{j}/\\rho_{j}}$，声阻抗为 $Z_{j}=\\rho_{j} c_{j}$，其中 $j\\in\\{1,2\\}$。一个角频率为 $\\omega$ 的时谐平面声波，其压力场从 $x0$ 入射，并垂直入射到界面上。\n\n将界面建模为水平集函数 $\\phi(x)=x$ 的零等值线，并通过 $H(\\phi)$ 表示材料属性，其中 $H$ 是亥维赛函数（在中间计算中平滑为 $H_{\\varepsilon}$，并最终取 $\\varepsilon\\to 0^{+}$）。声场由线性化的可压缩方程控制\n$$\n\\rho(x)\\,\\frac{\\partial \\mathbf{u}}{\\partial t}(x,t)=-\\nabla p(x,t),\\qquad\n\\frac{\\partial p}{\\partial t}(x,t)+K(x)\\,\\nabla\\cdot \\mathbf{u}(x,t)=0,\n$$\n其中 $\\rho(x)=\\rho_{1}\\,H(-\\phi(x))+\\rho_{2}\\,H(\\phi(x))$ 且 $K(x)=K_{1}\\,H(-\\phi(x))+K_{2}\\,H(\\phi(x))$。界面条件通过浸入边界法（IBM）和水平集法（LSM）来施加，这需要满足在极限 $\\varepsilon\\to 0^{+}$ 下对控制方程跨界面积分所得到的适当跳跃条件。\n\n设入射、反射和透射的压力场（对于 $x0$ 和 $x>0$）由形式为 $p(x,t)=\\Re\\{P(x)\\,\\exp(i\\omega t)\\}$ 的右行和左行谐波平面波叠加表示，其中 $P(x)$ 是在每个均匀半空间中满足一维波动方程的复振幅。定义压力振幅反射系数和透射系数为 $R=\\frac{P_{r}}{P_{i}}$ 和 $T=\\frac{P_{t}}{P_{i}}$，其中 $P_{i}$、$P_{r}$ 和 $P_{t}$ 分别是入射波、反射波和透射波在界面处计算的复压力振幅。\n\n从上述线性化方程出发，并使用由水平集表示和浸入边界法施加界面条件所隐含的分布框架，推导在极限 $\\varepsilon\\to 0^{+}$ 下声场在 $x=0$ 处的界面连续性要求，并用 $\\rho_{1}$、$\\rho_{2}$、$K_{1}$ 和 $K_{2}$ 计算压力振幅反射系数 $R$ 和透射系数 $T$。您的最终答案必须是使用 $\\mathrm{pmatrix}$ 环境写成单个行矩阵的对 $(R,T)$ 的闭式解析表达式。不需要进行数值计算。这些系数是无量纲的；最终答案中不要包含单位。",
            "solution": "该问题考虑了一个尖锐的材料界面，该界面通过水平集法（LSM）建模，其中 $\\phi(x)=x$，材料属性通过亥维赛函数 $H(\\phi)$ 表示（使用平滑版本 $H_{\\varepsilon}$ 来为分布操作提供依据）。浸入边界法（IBM）通过确保在 $\\varepsilon\\to 0^{+}$ 时，对控制线性化方程在界面无穷小邻域内积分能产生物理上正确的跳跃条件，从而施加界面条件。\n\n我们从无粘性声学的线性化动量方程和连续性方程开始，\n$$\n\\rho(x)\\,\\frac{\\partial \\mathbf{u}}{\\partial t}(x,t)=-\\nabla p(x,t),\\qquad\n\\frac{\\partial p}{\\partial t}(x,t)+K(x)\\,\\nabla\\cdot \\mathbf{u}(x,t)=0.\n$$\n此处 $\\rho(x)$ 和 $K(x)$ 是在 $x=0$ 处有跳跃的分段常数函数。在一维空间中，设 $\\mathbf{u}(x,t)=u(x,t)\\,\\hat{\\mathbf{x}}$，则方程简化为\n$$\n\\rho(x)\\,\\frac{\\partial u}{\\partial t}(x,t)=-\\frac{\\partial p}{\\partial x}(x,t),\\qquad\n\\frac{\\partial p}{\\partial t}(x,t)+K(x)\\,\\frac{\\partial u}{\\partial x}(x,t)=0.\n$$\n我们现在考察 $x=0$ 处的界面条件。考虑界面周围的一个无穷小控制体积 $[-\\delta,\\delta]$。将动量方程在 $x$ 方向上从 $-\\delta$ 积分到 $\\delta$：\n$$\n\\int_{-\\delta}^{\\delta}\\rho(x)\\,\\frac{\\partial u}{\\partial t}(x,t)\\,\\mathrm{d}x\n=-\\int_{-\\delta}^{\\delta}\\frac{\\partial p}{\\partial x}(x,t)\\,\\mathrm{d}x\n=-(p(\\delta,t)-p(-\\delta,t)).\n$$\n在极限 $\\delta\\to 0^{+}$ 下，只要 $u$ 及其时间导数保持有界，左侧项趋于 $0$。因此，\n$$\n\\lim_{\\delta\\to 0^{+}}\\left[p(\\delta,t)-p(-\\delta,t)\\right]=0,\n$$\n这意味着界面处压力连续，\n$$\n[p]_{x=0}=0.\n$$\n此处 $[f]_{x=0}$ 表示跳跃量 $f(0^{+},t)-f(0^{-},t)$。\n\n接下来，为了推导速度的连续性，我们将连续性方程改写为 $\\frac{1}{K(x)}\\frac{\\partial p}{\\partial t}(x,t)+\\frac{\\partial u}{\\partial x}(x,t)=0$。同样在 $[-\\delta,\\delta]$ 上积分：\n$$\n\\int_{-\\delta}^{\\delta}\\frac{1}{K(x)}\\frac{\\partial p}{\\partial t}(x,t)\\,\\mathrm{d}x + \\int_{-\\delta}^{\\delta}\\frac{\\partial u}{\\partial x}(x,t)\\,\\mathrm{d}x = 0.\n$$\n在极限 $\\delta\\to 0^{+}$ 下，由于压力 $p$ 是连续的，其时间导数 $\\frac{\\partial p}{\\partial t}$ 也是连续且有界的。而 $1/K(x)$ 是分段常数且有界的，因此第一个积分项趋于 $0$。第二个积分项精确等于 $u(\\delta,t) - u(-\\delta,t)$。因此，在极限下我们得到：\n$$\n[u]_{x=0}=0.\n$$\n这些条件 $[p]_{x=0}=0$ 和 $[u]_{x=0}=0$ 是声学中标准的压力和法向速度的界面连续性条件。在 IBM-LSM 公式中，这些条件可以通过支撑在 $\\phi=0$ 上的奇异源项弱施加，或通过鬼点流体构造强施加；在分布极限下，它们与推导出的跳跃条件一致。\n\n我们现在专门研究垂直入射的谐波平面波。在每个均匀半空间中，场满足一维波动方程，其速度为 $c_{j}=\\sqrt{K_{j}/\\rho_{j}}$，这导出了行波的压力与质点速度之间的关系。设复压力振幅为\n$$\nP(x)=\n\\begin{cases}\nP_{i}\\,\\exp(-i k_{1} x)+P_{r}\\,\\exp(i k_{1} x),  x0,\\\\\nP_{t}\\,\\exp(-i k_{2} x),  x>0,\n\\end{cases}\n$$\n其中 $k_{j}=\\omega/c_{j}$，$j\\in\\{1,2\\}$。相应的复质点速度振幅 $U(x)$ 满足频域中的线性化动量方程，\n$$\n-i\\omega \\rho(x)\\,U(x)=-\\frac{\\mathrm{d}P}{\\mathrm{d}x}(x),\n$$\n对于右行波和左行波，这会产生标准的阻抗关系\n$$\nU_{\\text{right}}=\\frac{P_{\\text{right}}}{Z_{j}},\\qquad U_{\\text{left}}=-\\frac{P_{\\text{left}}}{Z_{j}},\\qquad Z_{j}=\\rho_{j} c_{j}=\\sqrt{\\rho_{j} K_{j}}.\n$$\n因此，在 $x=0^{-}$（在介质 1 中），\n$$\nU(0^{-})=\\frac{P_{i}}{Z_{1}}-\\frac{P_{r}}{Z_{1}},\n$$\n且在 $x=0^{+}$（在介质 2 中），\n$$\nU(0^{+})=\\frac{P_{t}}{Z_{2}}.\n$$\n界面连续性条件 $[p]_{x=0}=0$ 和 $[u]_{x=0}=0$ 变为\n$$\nP_{i}+P_{r}=P_{t},\\qquad \\frac{P_{i}}{Z_{1}}-\\frac{P_{r}}{Z_{1}}=\\frac{P_{t}}{Z_{2}}.\n$$\n定义压力振幅反射系数和透射系数\n$$\nR=\\frac{P_{r}}{P_{i}},\\qquad T=\\frac{P_{t}}{P_{i}}.\n$$\n将两个界面方程两边同除以 $P_{i}$ 得到\n$$\n1+R=T,\\qquad \\frac{1}{Z_{1}}-\\frac{R}{Z_{1}}=\\frac{T}{Z_{2}}.\n$$\n使用 $T=1+R$ 消去 $T$：\n$$\n\\frac{1}{Z_{1}}-\\frac{R}{Z_{1}}=\\frac{1+R}{Z_{2}}\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{Z_{2}}{Z_{1}}-R\\,\\frac{Z_{2}}{Z_{1}}=1+R.\n$$\n合并 $R$ 的项：\n$$\n\\left(\\frac{Z_{2}}{Z_{1}}+1\\right)R=\\frac{Z_{2}}{Z_{1}}-1\n\\;\\;\\Longrightarrow\\;\\;\nR=\\frac{\\frac{Z_{2}}{Z_{1}}-1}{\\frac{Z_{2}}{Z_{1}}+1}\n=\\frac{Z_{2}-Z_{1}}{Z_{2}+Z_{1}}.\n$$\n于是\n$$\nT=1+R=1+\\frac{Z_{2}-Z_{1}}{Z_{2}+Z_{1}}\n=\\frac{Z_{2}+Z_{1}+Z_{2}-Z_{1}}{Z_{2}+Z_{1}}\n=\\frac{2 Z_{2}}{Z_{2}+Z_{1}}.\n$$\n将 $Z_{j}$ 用 $\\rho_{j}$ 和 $K_{j}$ 表示，得到 $Z_{j}=\\sqrt{\\rho_{j} K_{j}}$。因此，\n$$\nR=\\frac{\\sqrt{\\rho_{2} K_{2}}-\\sqrt{\\rho_{1} K_{1}}}{\\sqrt{\\rho_{2} K_{2}}+\\sqrt{\\rho_{1} K_{1}}},\n\\qquad\nT=\\frac{2\\,\\sqrt{\\rho_{2} K_{2}}}{\\sqrt{\\rho_{2} K_{2}}+\\sqrt{\\rho_{1} K_{1}}}.\n$$\n这些是在平面界面上垂直入射时的压力振幅反射和透射系数，它们是从基本的线性化声学方程和由浸入边界法及水平集法框架施加的界面连续性条件推导出来的。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\sqrt{\\rho_{2} K_{2}}-\\sqrt{\\rho_{1} K_{1}}}{\\sqrt{\\rho_{2} K_{2}}+\\sqrt{\\rho_{1} K_{1}}}  \\frac{2\\,\\sqrt{\\rho_{2} K_{2}}}{\\sqrt{\\rho_{2} K_{2}}+\\sqrt{\\rho_{1} K_{1}}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "水平集方法的核心优势在于其能够隐式地表示和追踪复杂几何形状。为了在计算中精确地施加边界条件或模拟与几何相关的物理效应（如表面张力），我们必须能够从离散的水平集函数 $\\phi$ 中提取关键的几何信息。这个练习  将让你亲手实践如何利用中心差分格式，从给定的离散 $\\phi$ 场计算出界面的单位法向量和曲率。这不仅是一项基本的数值技能，更是理解水平集方法如何将连续的几何概念转化为离散计算量的关键。",
            "id": "4126954",
            "problem": "考虑一个密度为 $\\rho$、声速为 $c$ 的均匀流体中的二维线性声学问题，其中一个光滑的刚性夹杂物通过浸入边界法 (IBM) 表示，其几何形状通过水平集方法 (LSM) 捕捉。该夹杂物的边界是在一个均匀笛卡尔网格上定义的标量场 $\\phi(x,y)$ 的零水平集，网格在两个方向上的间距均为 $h$。在 IBM 使用的离散化公式中，需要水平集的外向单位法线和曲率来评估声学边界条件中的高阶界面项，并构建几何一致的浸入边界求积。\n\n给定 $\\phi$ 是到以原点为中心、半径为 $R$ 的圆的有符号距离，其中 $R=h$，网格间距为 $h=1.0\\times 10^{-3}$ 米。关注以网格索引 $(i_{0},j_{0})=(1,0)$ 为中心的 $3\\times 3$ 模板，该点对应物理位置 $(x,y)=(h,0)$。该模板上 $\\phi$ 的离散值为\n$$\n\\begin{aligned}\n\\phi_{0,-1}=0, \\quad \\phi_{1,-1}=(\\sqrt{2}-1)h, \\quad \\phi_{2,-1}=(\\sqrt{5}-1)h,\\\\\n\\phi_{0,0}=-h, \\quad \\phi_{1,0}=0, \\quad \\phi_{2,0}=h,\\\\\n\\phi_{0,1}=0, \\quad \\phi_{1,1}=(\\sqrt{2}-1)h, \\quad \\phi_{2,1}=(\\sqrt{5}-1)h.\n\\end{aligned}\n$$\n\n从 $\\mathbb{R}^{2}$ 中隐式定义曲线的微分几何第一性原理出发，执行以下操作：\n\n- 推导在 $(i_{0},j_{0})$ 处的外向单位法线 $\\mathbf{n}$，用 $\\phi$ 的空间导数表示，并使用给定模板上的二阶中心有限差分进行评估。\n- 推导在 $(i_{0},j_{0})$ 处的曲率 $\\kappa$，用 $\\phi$ 的一阶和二阶偏导数表示，然后使用给定模板上的二阶中心有限差分进行评估。\n\n假设 $\\phi$ 在模板上是光滑的，并且没有应用任何滤波或重新初始化。对于数值评估，对一阶和二阶偏导数使用标准的二阶中心差分，混合导数使用对称的 $4$ 点公式。仅提交 $(i_{0},j_{0})$ 处的曲率；以 $\\mathrm{m}^{-1}$ 为单位表示曲率，并将最终数值四舍五入至四位有效数字。",
            "solution": "问题是在离散网格上，使用二阶有限差分计算由水平集函数 $\\phi$ 定义的边界的曲率。\n\n### 求解过程\n\n夹杂物的边界由方程 $\\phi(x,y)=0$ 隐式定义。计算在物理点 $(x,y)=(h,0)$ 进行，该点对应于网格索引 $(i_0, j_0)=(1,0)$。\n\n**第一部分：外向单位法向量 ($\\mathbf{n}$)**\n\n梯度向量 $\\nabla \\phi = \\left(\\frac{\\partial \\phi}{\\partial x}, \\frac{\\partial \\phi}{\\partial y}\\right)$ 与 $\\phi$ 的水平集正交。外向单位法向量 $\\mathbf{n}$ 通过将梯度归一化得到：\n$$ \\mathbf{n} = \\frac{\\nabla \\phi}{|\\nabla \\phi|} = \\frac{(\\phi_x, \\phi_y)}{\\sqrt{\\phi_x^2 + \\phi_y^2}} $$\n其中下标表示偏微分。在 $(i_0, j_0)=(1,0)$ 处的一阶导数 $\\phi_x$ 和 $\\phi_y$ 使用二阶中心差分近似：\n$$ \\phi_x|_{(1,0)} \\approx \\frac{\\phi_{1+1, 0} - \\phi_{1-1, 0}}{2h} = \\frac{\\phi_{2,0} - \\phi_{0,0}}{2h} $$\n$$ \\phi_y|_{(1,0)} \\approx \\frac{\\phi_{1, 0+1} - \\phi_{1, 0-1}}{2h} = \\frac{\\phi_{1,1} - \\phi_{1,-1}}{2h} $$\n代入给定值：\n$$ \\phi_x|_{(1,0)} \\approx \\frac{h - (-h)}{2h} = \\frac{2h}{2h} = 1 $$\n$$ \\phi_y|_{(1,0)} \\approx \\frac{(\\sqrt{2}-1)h - (\\sqrt{2}-1)h}{2h} = \\frac{0}{2h} = 0 $$\n梯度向量的数值估计为 $\\nabla \\phi \\approx (1,0)$。其大小为 $|\\nabla \\phi| \\approx \\sqrt{1^2+0^2} = 1$。\n因此，外向单位法向量为：\n$$ \\mathbf{n} \\approx \\frac{(1,0)}{1} = (1,0) $$\n\n**第二部分：曲率 ($\\kappa$)**\n\n水平集曲线 $\\phi(x,y)=0$ 的曲率 $\\kappa$ 由单位法向量的散度给出，即 $\\kappa = \\nabla \\cdot \\mathbf{n}$。用 $\\phi$ 的偏导数表示为：\n$$ \\kappa = \\frac{\\phi_x^2 \\phi_{yy} - 2\\phi_x \\phi_y \\phi_{xy} + \\phi_y^2 \\phi_{xx}}{(\\phi_x^2 + \\phi_y^2)^{3/2}} $$\n为了评估此表达式，我们需要 $\\phi$ 在 $(1,0)$ 处的二阶偏导数。我们对 $\\phi_{xx}$ 和 $\\phi_{yy}$ 使用二阶中心差分，对 $\\phi_{xy}$ 使用指定的对称 $4$ 点公式。\n\n二阶导数 $\\phi_{xx}$ 为：\n$$ \\phi_{xx}|_{(1,0)} \\approx \\frac{\\phi_{1+1,0} - 2\\phi_{1,0} + \\phi_{1-1,0}}{h^2} = \\frac{\\phi_{2,0} - 2\\phi_{1,0} + \\phi_{0,0}}{h^2} $$\n代入数值：\n$$ \\phi_{xx}|_{(1,0)} \\approx \\frac{h - 2(0) + (-h)}{h^2} = \\frac{0}{h^2} = 0 $$\n\n二阶导数 $\\phi_{yy}$ 为：\n$$ \\phi_{yy}|_{(1,0)} \\approx \\frac{\\phi_{1,0+1} - 2\\phi_{1,0} + \\phi_{1,0-1}}{h^2} = \\frac{\\phi_{1,1} - 2\\phi_{1,0} + \\phi_{1,-1}}{h^2} $$\n代入数值：\n$$ \\phi_{yy}|_{(1,0)} \\approx \\frac{(\\sqrt{2}-1)h - 2(0) + (\\sqrt{2}-1)h}{h^2} = \\frac{2(\\sqrt{2}-1)h}{h^2} = \\frac{2(\\sqrt{2}-1)}{h} $$\n\n混合偏导数 $\\phi_{xy}$ 为：\n$$ \\phi_{xy}|_{(1,0)} \\approx \\frac{\\phi_{1+1, 0+1} - \\phi_{1-1, 0+1} - \\phi_{1+1, 0-1} + \\phi_{1-1, 0-1}}{4h^2} = \\frac{\\phi_{2,1} - \\phi_{0,1} - \\phi_{2,-1} + \\phi_{0,-1}}{4h^2} $$\n代入数值：\n$$ \\phi_{xy}|_{(1,0)} \\approx \\frac{(\\sqrt{5}-1)h - 0 - (\\sqrt{5}-1)h + 0}{4h^2} = \\frac{0}{4h^2} = 0 $$\n\n现在，我们将导数的数值代入曲率公式：\n-   $\\phi_x \\approx 1$\n-   $\\phi_y \\approx 0$\n-   $\\phi_{xx} \\approx 0$\n-   $\\phi_{yy} \\approx \\frac{2(\\sqrt{2}-1)}{h}$\n-   $\\phi_{xy} \\approx 0$\n\n$$ \\kappa \\approx \\frac{(1)^2 \\left(\\frac{2(\\sqrt{2}-1)}{h}\\right) - 2(1)(0)(0) + (0)^2 (0)}{( (1)^2 + (0)^2 )^{3/2}} $$\n$$ \\kappa \\approx \\frac{\\frac{2(\\sqrt{2}-1)}{h}}{1^{3/2}} = \\frac{2(\\sqrt{2}-1)}{h} $$\n最后一步是计算数值。给定 $h = 1.0 \\times 10^{-3}$ 米：\n$$ \\kappa \\approx \\frac{2(\\sqrt{2} - 1)}{1.0 \\times 10^{-3}} \\ \\mathrm{m}^{-1} $$\n使用 $\\sqrt{2} \\approx 1.41421356$：\n$$ \\kappa \\approx \\frac{2(1.41421356 - 1)}{1.0 \\times 10^{-3}} = \\frac{2(0.41421356)}{1.0 \\times 10^{-3}} = \\frac{0.82842712}{1.0 \\times 10^{-3}} \\approx 828.42712 \\ \\mathrm{m}^{-1} $$\n四舍五入至四位有效数字，我们得到 $828.4 \\ \\mathrm{m}^{-1}$。用标准科学记数法表示，即为 $8.284 \\times 10^2 \\ \\mathrm{m}^{-1}$。",
            "answer": "$$\\boxed{8.284 \\times 10^2}$$"
        },
        {
            "introduction": "在计算网格中精确地施加沉浸边界上的物理条件是该方法成败的关键。“虚拟流体法”（Ghost Fluid Method, GFM）是一种强大而流行的技术，它通过在界面外的“虚拟”网格点上巧妙地设定数值，使得标准的有限差分格式能够自动满足所需的边界条件。在这个高级练习  中，你将基于声学特征理论，为给定的声阻抗边界条件推导虚拟单元的压力和速度值。这能让你深入理解虚拟流体法的工作原理，并将抽象的边界条件转化为具体的数值算法。",
            "id": "4126889",
            "problem": "考虑均匀介质中的一维 ($1\\mathrm{D}$) 线性声学问题，介质的质量密度为 $\\rho_{0}$，声速为 $c$。线性化方程为耦合一阶偏微分方程 (PDE)：\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0, \\qquad \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0,\n$$\n其中 $p(x,t)$ 是声压，$u(x,t)$ 是 $x$ 方向上的质点速度。定义特征（平面波）阻抗为 $Z_{0} = \\rho_{0} c$。\n\n一个具有指定声阻抗 $Z$（假设为实数、不随时间变化，且 $Z \\neq Z_{0}$）的界面被浸入计算域中，并通过水平集方法 (Level Set Method, LSM) 函数 $\\phi(x)$ 进行隐式表示。界面位于 $\\phi(x)=0$ 处，其外法线局部上与 $x$ 轴负方向对齐。在一个间距为 $\\Delta x$ 的均匀有限差分 (Finite Difference, FD) 网格上，设最近的内部节点索引为 $i=0$，位于 $x_{0}$ 处，此处 $\\phi_{0} > 0$；最近的外部（虚拟）节点索引为 $i=-1$，位于 $x_{-1} = x_{0} - \\Delta x$ 处，此处 $\\phi_{-1}  0$。零水平集位于这两个节点之间，其在单元格内的分数位置为\n$$\n\\theta = \\frac{|\\phi_{0}|}{|\\phi_{0}| + |\\phi_{-1}|} \\in (0,1),\n$$\n因此界面位置为 $x_{I} = x_{0} - \\theta \\Delta x$。\n\n您正在对 $i=0$ 处的空间导数使用二阶中心有限差分格式，这需要虚拟值 $p_{-1}$ 和 $u_{-1}$。为在界面上施加阻抗边界条件，\n$$\np(x_{I},t) = Z\\, u(x_{I},t),\n$$\n虚拟流体法 (Ghost Fluid Method, GFM) 通过沿界面法线方向结合内部状态和边界关系来指定与界面一致的值，然后确定虚拟值，使得从内部节点到虚拟节点的线性插值能够恢复这些界面值。\n\n仅从上述偏微分方程、 $Z_0$ 的定义以及边界关系 $p(x_{I},t) = Z\\, u(x_{I},t)$ 出发，推导虚拟值 $p_{-1}$ 和 $u_{-1}$ 的闭式表达式。这些表达式应以同一时间层上的已知内部值 $p_0$ 和 $u_0$、参数 $\\rho_0$、$c$、$Z$ 以及几何分数 $\\theta$ 来表示。将最终结果表示为 $p_{-1}$ 和 $u_{-1}$ 的解析公式，这些公式需确保线性插值\n$$\np(x_{I},t) = (1-\\theta)\\, p_{0} + \\theta\\, p_{-1}, \\qquad u(x_{I},t) = (1-\\theta)\\, u_{0} + \\theta\\, u_{-1}\n$$\n对给定的 $Z$ 满足 $p(x_{I},t) = Z\\, u(x_{I},t)$。\n\n您的最终答案必须是关于 $p_{-1}$ 和 $u_{-1}$ 的单一闭式解析表达式，并且必须不带单位。如果您引入任何缩写，请在首次使用时写出全称；例如，水平集方法 (Level Set Method, LSM)、虚拟流体法 (Ghost Fluid Method, GFM) 和有限差分 (Finite Difference, FD)。",
            "solution": "该问题要求推导用于有限差分 (FD) 格式的虚拟单元压力 $p_{-1}$ 和速度 $u_{-1}$ 的闭式表达式。这些表达式必须在一个浸入式界面上施加一个特定的声阻抗边界条件，且与虚拟流体法 (GFM) 的原理一致。\n\n求解策略包括为两个未知数 $p_{-1}$ 和 $u_{-1}$ 建立一个二元线性方程组，然后用代数方法求解该方程组。\n\n第一个方程是通过在界面位置 $x_I$ 施加阻抗边界条件推导出来的。问题陈述，界面上的压力值 $p(x_I, t)$ 和速度值 $u(x_I, t)$ 是通过在最近的内部节点 ($i=0$) 和外部虚拟节点 ($i=-1$) 之间进行线性插值得到的：\n$$\np(x_{I},t) = (1-\\theta)\\, p_{0} + \\theta\\, p_{-1}\n$$\n$$\nu(x_{I},t) = (1-\\theta)\\, u_{0} + \\theta\\, u_{-1}\n$$\n界面上的阻抗边界条件为 $p(x_{I},t) = Z\\, u(x_{I},t)$。将插值公式代入此条件，得到我们的第一个方程：\n$$\n(1-\\theta)\\, p_{0} + \\theta\\, p_{-1} = Z \\left[ (1-\\theta)\\, u_{0} + \\theta\\, u_{-1} \\right]\n\\quad \\quad (1)\n$$\n\n第二个方程源于控制偏微分方程 (PDE) 的内在物理原理，这是 GFM 中的一个关键步骤。一维线性声学方程为：\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0, \\qquad \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0\n$$\n使用特征阻抗 $Z_{0} = \\rho_{0} c$ 的定义，这些方程可以改写为特征变量或黎曼不变量的形式。将第二个偏微分方程乘以 $Z_0$ 后（经过整理）与第一个方程相加和相减，我们得到两个解耦的平流方程：\n$$\n\\frac{\\partial}{\\partial t}(p + Z_{0} u) + c \\frac{\\partial}{\\partial x}(p + Z_{0} u) = 0\n$$\n$$\n\\frac{\\partial}{\\partial t}(p - Z_{0} u) - c \\frac{\\partial}{\\partial x}(p - Z_{0} u) = 0\n$$\n这些方程描述了两个波族：$W_1 = p + Z_{0} u$ 以速度 $c$ 向右传播，以及 $W_2 = p - Z_{0} u$ 以速度 $-c$ 向左传播。\n\n流体域被指定在 $\\phi > 0$ 的区域，因此对于 $x > x_I$。界面法线指向 $x$ 轴负方向，这意味着它从流体域指向虚拟单元区域。将信息从流体域携带至边界的特征变量是向 $x$ 轴负方向传播的那个，即 $W_2 = p - Z_0 u$。GFM 通过从流体域外推来指定该量在虚拟区域的值。最简单的零阶外推假设该量跨界面为常数。因此，我们将它在虚拟节点 $x_{-1}$ 处的值设为与它在内部节点 $x_0$ 处的值相等：\n$$\np(x_{-1},t) - Z_{0} u(x_{-1},t) = p(x_{0},t) - Z_{0} u(x_{0},t)\n$$\n在我们的离散记法中，这成为所需的第二个方程：\n$$\np_{-1} - Z_{0} u_{-1} = p_{0} - Z_{0} u_{0}\n\\quad \\quad (2)\n$$\n\n现在我们得到了一个关于 $p_{-1}$ 和 $u_{-1}$ 的二元线性方程组。从方程 $(2)$，我们可以用 $u_{-1}$ 表示 $p_{-1}$：\n$$\np_{-1} = p_{0} - Z_{0} u_{0} + Z_{0} u_{-1}\n$$\n将这个 $p_{-1}$ 的表达式代入方程 $(1)$：\n$$\n(1-\\theta)\\, p_{0} + \\theta\\, (p_{0} - Z_{0} u_{0} + Z_{0} u_{-1}) = Z \\left[ (1-\\theta)\\, u_{0} + \\theta\\, u_{-1} \\right]\n$$\n我们化简并合并包含未知数 $u_{-1}$ 的项：\n$$\np_0 - \\theta p_0 + \\theta p_0 - \\theta Z_0 u_0 + \\theta Z_0 u_{-1} = Z(1-\\theta)u_0 + \\theta Z u_{-1}\n$$\n$$\np_0 - \\theta Z_0 u_0 + \\theta Z_0 u_{-1} = Z u_0 - \\theta Z u_0 + \\theta Z u_{-1}\n$$\n移项，将含有 $u_{-1}$ 的项分离到一边：\n$$\n\\theta Z_0 u_{-1} - \\theta Z u_{-1} = Z u_0 - \\theta Z u_0 - p_0 + \\theta Z_0 u_0\n$$\n$$\nu_{-1} \\theta (Z_0 - Z) = u_0 (Z - \\theta Z + \\theta Z_0) - p_0\n$$\n求解 $u_{-1}$，同时为了得到更简洁的形式，我们加上再减去 $\\theta u_0(Z_0-Z)$：\n$$\n(u_{-1} - u_0) \\theta (Z_0 - Z) = u_0 Z - p_0\n$$\n这就给出了 $u_{-1}$ 的最终表达式：\n$$\nu_{-1} = u_0 + \\frac{p_0 - u_0 Z}{\\theta(Z - Z_0)}\n$$\n\n现在，我们将此结果代回到 $p_{-1}$ 的表达式中：\n$$\np_{-1} = p_{0} - Z_{0} u_{0} + Z_{0} u_{-1}\n$$\n$$\np_{-1} = p_{0} - Z_{0} u_{0} + Z_{0} \\left( u_0 + \\frac{p_0 - u_0 Z}{\\theta(Z - Z_0)} \\right)\n$$\n$$\np_{-1} = p_{0} - Z_{0} u_{0} + Z_{0} u_{0} + \\frac{Z_0 (p_0 - u_0 Z)}{\\theta(Z - Z_0)}\n$$\n这就给出了 $p_{-1}$ 的最终表达式：\n$$\np_{-1} = p_0 + \\frac{Z_0 (p_0 - u_0 Z)}{\\theta(Z - Z_0)}\n$$\n\n因此，虚拟压力 $p_{-1}$ 和虚拟速度 $u_{-1}$ 的结果用内部值 $p_0, u_0$、阻抗值 $Z, Z_0$ 以及几何因子 $\\theta$ 表示。特征阻抗 $Z_0$ 定义为 $\\rho_0 c$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np_0 + \\frac{Z_0 (p_0 - u_0 Z)}{\\theta(Z - Z_0)}  u_0 + \\frac{p_0 - u_0 Z}{\\theta(Z - Z_0)}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}