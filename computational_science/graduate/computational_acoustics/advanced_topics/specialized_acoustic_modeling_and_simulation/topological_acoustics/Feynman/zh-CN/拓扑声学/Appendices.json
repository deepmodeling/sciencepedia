{
    "hands_on_practices": [
        {
            "introduction": "拓扑不变量是用于区分不同拓扑相的整数，它不会在系统经历绝热演化时改变。对于破坏了时间反演对称性的二维系统，陈数（Chern number）是最基本的拓扑不变量。本练习将指导您使用稳健的福井-初贝-铃木（Fukai-Hatsugai-Suzuki）方法，在离散化的布里渊区上直接从布洛赫本征态计算陈数，从而提供一种识别和量化拓扑相的实用技能。",
            "id": "4147729",
            "problem": "考虑一个二维周期性声学超材料，其在低频下通过一个耦合模式有效布洛赫算子建模，每个晶胞包含两种杂化压力模式。根据空间周期性和布洛赫定理，小振幅压力场可以由布洛赫波解来表示。这些解由第一布里渊区上的布洛赫波矢 $k = (k_x,k_y)$ 标记，第一布里渊区取为方形区域 $k_x,k_y \\in [-\\pi,\\pi]$，角度以弧度为单位。模式耦合被选择为对称性允许且非互易的，从而产生一个有效的 $2 \\times 2$ 厄米布洛赫算子\n$$\nH(k) = \\sin(k_x)\\,\\sigma_x + \\sin(k_y)\\,\\sigma_y + \\left(m + \\cos(k_x) + \\cos(k_y)\\right)\\,\\sigma_z,\n$$\n其中 $m$ 是一个无量纲的偏置参数，可通过旋转谐振器或施加稳定声流来调节，而 $\\sigma_x,\\sigma_y,\\sigma_z$ 是泡利矩阵。对于每个 $k$，本征值问题 $H(k)\\,u_b(k) = \\omega_b(k)\\,u_b(k)$ 定义了由能带索引的归一化本征模式 $u_b(k)$。\n\n一个孤立能带 $b$ 的第一陈数是一个整数，由贝里曲率在布里渊区上的积分给出。该陈数源于在 $k$ 空间中，将 $u_b(k)$ 绕无穷小回路进行平行输运时累积的几何相位。从贝里联络和贝里曲率的定义出发，并利用数值计算在有限网格上操作这一事实，构建一个基于布里渊区均匀网格上规范不变链路变量的、针对较低能带 $b=0$（具有较小本征值的能带）的陈数的离散近似。通过将布里渊区离散化为一个均匀的 $N \\times N$ $k$ 点网格来实现该方法，其中 $k_x$ 和 $k_y$ 在 $[-\\pi,\\pi]$ 内均匀采样。在网格上使用周期性边界条件，以便边界上的相邻点可以环绕。\n\n通过计算本征矢量绕元格输运一周所累积的相位，来计算每个元格上的离散贝里通量，并将所有元格的通量相加来估计较低能带的陈数。为保证数值稳定性，请确保在每个 $k$ 点对本征矢量进行归一化，并使用规范不变的方法比较相邻的本征矢量。角度必须以弧度处理。\n\n除了计算陈数，还需估计两个数值误差度量：\n\n- 有限网格离散化误差估计：计算在基础网格尺寸 $N$ 和加密网格尺寸 $2N$ 上得到的陈数之间的绝对差，两者均使用相同的 $m$ 和上述方法。将此差值报告为一个非负实数。\n\n- 模式正交性稳定性度量：对于基础网格尺寸 $N$，计算较低能带在整个网格上相邻重叠的模与单位量级1的平均偏差。具体来说，在网格上的每个 $k$ 点，计算重叠的模 $s_x(k) = \\left|\\langle u_0(k)\\,|\\,u_0(k+\\Delta_x)\\rangle\\right|$ 和 $s_y(k) = \\left|\\langle u_0(k)\\,|\\,u_0(k+\\Delta_y)\\rangle\\right|$，其中 $\\Delta_x$ 和 $\\Delta_y$ 表示在 $k_x$ 和 $k_y$ 方向上带周期性环绕的一个网格步长的位移。然后，将正交性稳定性度量定义为所有 $k$ 点上 $\\left(1 - s_x(k)\\right)$ 和 $\\left(1 - s_y(k)\\right)$ 的算术平均值；将此平均值报告为一个在 $[0,1]$ 区间内的实数。较大的值表示由于粗糙采样或近简并而导致的更强的局域规范涨落。\n\n您的程序必须为以下测试套件中的每个测试用例输出一个包含三个条目的列表 $[C, E_{\\mathrm{mesh}}, E_{\\mathrm{ortho}}]$，其中 $C$ 是在基础网格 $N$ 上计算的较低能带陈数（报告为不进行四舍五入的实数），$E_{\\mathrm{mesh}}$ 是如上定义的有限网格离散化误差估计，而 $E_{\\mathrm{ortho}}$ 是如上定义的模式正交性稳定性度量。测试套件包含以下参数集 $(m,N)$：\n\n- 测试用例 1：$(m,N) = (-1.0,\\,21)$。\n- 测试用例 2：$(m,N) = (0.0,\\,21)$，一个能隙闭合的边界情况。\n- 测试用例 3：$(m,N) = (1.0,\\,21)$。\n- 测试用例 4：$(m,N) = (3.0,\\,21)$。\n- 测试用例 5：$(m,N) = (-1.0,\\,9)$，一个用于强调正交性稳定性的粗糙网格。\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的列表的列表，例如 $[[r_{11},r_{12},r_{13}],[r_{21},r_{22},r_{23}],\\ldots]$，其中每个 $r_{ij}$ 都是一个实数。角度必须以弧度为单位，并且由于所有量都是无量纲的，因此不需要物理单位。代码必须是自包含的，无需任何输入即可运行。",
            "solution": "该问题要求计算一个二维拓扑声学超材料较低能带的第一陈数，以及两个数值误差度量。解决方案需要一种基于布里渊区晶格离散化的数值方法。\n\n该系统由一个 $2 \\times 2$ 的厄米布洛赫算子（或哈密顿量）描述，它是布洛赫波矢 $k = (k_x, k_y)$ 的函数：\n$$\nH(k) = d_x(k)\\,\\sigma_x + d_y(k)\\,\\sigma_y + d_z(k)\\,\\sigma_z\n$$\n其中 $\\sigma_x, \\sigma_y, \\sigma_z$ 是泡利矩阵：\n$$\n\\sigma_x = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad \\sigma_y = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}, \\quad \\sigma_z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\n向量 $\\vec{d}(k)$ 的分量由 $d_x(k) = \\sin(k_x)$、$d_y(k) = \\sin(k_y)$ 和 $d_z(k) = m + \\cos(k_x) + \\cos(k_y)$ 给出。参数 $m$ 用于调控系统使其经历不同的拓扑相。该哈密顿量的本征值为 $\\omega(k) = \\pm|\\vec{d}(k)|$，定义了两个能带。问题关注的是较低的能带，对应于本征值 $\\omega_0(k) = -|\\vec{d}(k)|$。\n\n第一陈数 $C$ 是一个表征能带结构的拓扑不变量。它被定义为贝里曲率 $\\mathcal{F}(k)$ 在第一布里渊区（BZ）上的积分：\n$$\nC = \\frac{1}{2\\pi} \\int_{\\mathrm{BZ}} \\mathcal{F}(k) \\, dk_x dk_y\n$$\n贝里曲率源于本征态的几何结构。对于在有限网格上的数值计算，由于底层贝里联络的规范依赖性，直接对该积分进行离散化是繁琐的。一个更稳健的方法，如问题所建议的，是基于 Fukui、Hatsugai 和 Suzuki 提出的晶格规范理论公式。\n\n数值计算步骤如下：\n\n1.  **布里渊区的离散化**：将布里渊区 BZ，$k_x, k_y \\in [-\\pi, \\pi]$，离散化为一个均匀的 $N \\times N$ 网格。为了遵循 BZ 的周期性，网格点选择为 $k_{i_x, i_y} = (k_x^{(i_x)}, k_y^{(i_y)})$，其中对于 $i_{x,y} \\in \\{0, 1, \\dots, N-1\\}$，$k_{x,y}^{(i)} = -\\pi + i \\frac{2\\pi}{N}$。\n\n2.  **本征矢量计算**：在每个网格点 $k$ 处，构建哈密顿矩阵 $H(k)$ 并对其进行对角化，以找到其本征值和本征矢量。我们关心的是与最低本征值 $\\omega_0(k)$ 对应的归一化本征矢量 $u_0(k)$。此操作在网格上的所有 $N^2$ 个点上执行。\n\n3.  **链路变量**：我们定义连接晶格上相邻本征矢量的链路变量。这些是复数，表示平行输运的规范不变部分：\n    $$\n    U_x(k) = \\langle u_0(k) | u_0(k + \\Delta_x) \\rangle\n    $$\n    $$\n    U_y(k) = \\langle u_0(k) | u_0(k + \\Delta_y) \\rangle\n    $$\n    其中 $\\Delta_x$ 和 $\\Delta_y$ 分别是 $k_x$ 和 $k_y$ 方向上的晶格矢量。内积为 $\\langle a | b \\rangle = a^\\dagger b$。\n\n4.  **元格贝里通量**：通过一个从点 $k$ 开始的元格的局域贝里通量，是通过该元格的威尔逊环的辐角计算得到的。这个围绕元格的四个链路变量的乘积是一个规范不变量：\n    $$\n    W(k) = U_x(k) \\, U_y(k+\\Delta_x) \\, U_x(k+\\Delta_y)^* \\, U_y(k)^*\n    $$\n    局域通量则为 $\\mathcal{F}_{\\text{lat}}(k) = \\arg(W(k))$。复对数的支必须选择在 $(-\\pi, \\pi]$ 范围内，这可以很自然地由 `atan2` 函数（或 `numpy.angle`）处理。\n\n5.  **陈数求和**：总陈数是 BZ 中所有 $N^2$ 个元格上这些局域通量之和，再除以 $2\\pi$：\n    $$\n    C = \\frac{1}{2\\pi} \\sum_{k \\in \\text{grid}} \\mathcal{F}_{\\text{lat}}(k)\n    $$\n    对于有能隙的系统和足够精细的网格，这个和会收敛到一个整数。\n\n除了在基础网格尺寸为 $N$ 上计算陈数 $C$ 外，还计算了两个误差度量：\n\n-   **有限网格离散化误差 ($E_{\\mathrm{mesh}}$)**：此度量估计了计算结果相对于网格尺寸的收敛性。它计算为在基础网格（$N \\times N$）和加密网格（$2N \\times 2N$）上计算的陈数之间的绝对差：\n    $$\n    E_{\\mathrm{mesh}} = |C_N - C_{2N}|\n    $$\n\n-   **模式正交性稳定性度量 ($E_{\\mathrm{ortho}}$)**：此度量量化了本征矢量场在 BZ 上的“平滑度”。由于在相邻点 $k$ 和 $k'$ 处的归一化本征矢量应该几乎相同（仅相差一个小的旋转），它们的内积的模 $|\\langle u_0(k) | u_0(k') \\rangle|$ 应该接近于 1。与 1 的显著偏差表明本征矢量发生了快速变化，这种情况发生在能带简并（能隙闭合点）附近，或者网格过于粗糙时。该度量被定义为在基础 $N \\times N$ 网格上所有链路上与1的偏差的平均值：\n    $$\n    E_{\\mathrm{ortho}} = \\frac{1}{2N^2} \\sum_{k \\in \\text{grid}} \\left[ \\left(1 - |\\langle u_0(k)|u_0(k+\\Delta_x)\\rangle|\\right) + \\left(1 - |\\langle u_0(k)|u_0(k+\\Delta_y)\\rangle|\\right) \\right]\n    $$\n\n该实现利用 `numpy` 进行高效的矢量化计算。k空间网格使用 `meshgrid` 生成。哈密顿量被构建为一个形状为 $(N, N, 2, 2)$ 的数组。`numpy.linalg.eigh` 用于同时对所有 $N^2$ 个矩阵进行对角化。周期性边界条件通过使用 `numpy.roll` 来移动数组以访问相邻网格点而得到高效处理。这种矢量化方法避免了缓慢的 Python 循环，非常适合此类问题。",
            "answer": "```python\nimport numpy as np\n\ndef compute_properties(m, N_grid):\n    \"\"\"\n    Computes the Chern number and orthogonality metrics for a given m and grid size N.\n\n    Args:\n        m (float): The bias parameter in the Hamiltonian.\n        N_grid (int): The number of points along one dimension of the BZ grid.\n\n    Returns:\n        tuple: A tuple containing:\n            - chern_number (float): The computed Chern number for the lower band.\n            - s_x (np.ndarray): Array of overlap magnitudes in the x-direction.\n            - s_y (np.ndarray): Array of overlap magnitudes in the y-direction.\n    \"\"\"\n    # Create the k-space grid.\n    k_vals = np.linspace(-np.pi, np.pi, N_grid, endpoint=False)\n    kx, ky = np.meshgrid(k_vals, k_vals, indexing='ij')\n\n    # Construct the Hamiltonian H(k) = d(k) . sigma over the entire grid.\n    H = np.zeros((N_grid, N_grid, 2, 2), dtype=complex)\n    \n    d_x = np.sin(kx)\n    d_y = np.sin(ky)\n    d_z = m + np.cos(kx) + np.cos(ky)\n\n    H[..., 0, 0] = d_z\n    H[..., 1, 1] = -d_z\n    H[..., 0, 1] = d_x - 1j * d_y\n    H[..., 1, 0] = d_x + 1j * d_y\n\n    # Diagonalize the Hamiltonian at each k-point.\n    # eigh returns sorted eigenvalues and corresponding normalized eigenvectors.\n    _, evecs = np.linalg.eigh(H)\n\n    # Extract the eigenvectors for the lower band (the first one).\n    u0 = evecs[..., 0]\n\n    # Compute link variables (overlaps) using periodic boundary conditions via np.roll.\n    u0_shifted_x = np.roll(u0, -1, axis=0)\n    u0_shifted_y = np.roll(u0, -1, axis=1)\n    \n    # Use einsum for vectorized inner products: conj(u0) * u0_shifted\n    link_x = np.einsum('ijk,ijk->ij', u0.conj(), u0_shifted_x)\n    link_y = np.einsum('ijk,ijk->ij', u0.conj(), u0_shifted_y)\n    \n    # Magnitudes for orthogonality metric\n    s_x = np.abs(link_x)\n    s_y = np.abs(link_y)\n    \n    # Compute the plaquette flux (Berry flux)\n    # W(k) = U_x(k) * U_y(k+dx) * conj(U_x(k+dy)) * conj(U_y(k))\n    link_y_shifted_x = np.roll(link_y, -1, axis=0)\n    link_x_shifted_y = np.roll(link_x, -1, axis=1)\n    \n    plaquette_wilson = link_x * link_y_shifted_x * link_x_shifted_y.conj() * link_y.conj()\n    \n    # Sum the angles (arguments) of the plaquette values\n    flux_per_plaquette = np.angle(plaquette_wilson)\n    \n    # The total Chern number is the sum over all plaquettes divided by 2*pi\n    chern_number = np.sum(flux_per_plaquette) / (2 * np.pi)\n    \n    return chern_number, s_x, s_y\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results in the specified format.\n    \"\"\"\n    test_suite = [\n        (-1.0, 21),\n        (0.0, 21),\n        (1.0, 21),\n        (3.0, 21),\n        (-1.0, 9),\n    ]\n\n    all_results = []\n    for m, N in test_suite:\n        # Calculate for base grid N\n        C_N, s_x_N, s_y_N = compute_properties(m, N)\n        \n        # Calculate for refined grid 2N for the error estimate\n        C_2N, _, _ = compute_properties(m, 2 * N)\n        \n        # Calculate finite grid discretization error\n        E_mesh = np.abs(C_N - C_2N)\n        \n        # Calculate mode orthogonality stability metric\n        ortho_dev_x = 1 - s_x_N\n        ortho_dev_y = 1 - s_y_N\n        E_ortho = np.mean(np.concatenate([ortho_dev_x.flatten(), ortho_dev_y.flatten()]))\n        \n        all_results.append([C_N, E_mesh, E_ortho])\n        \n    # Print in the required format: list of lists of real numbers\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "声学系统常常伴随着能量的损耗或增益，这需要使用非厄米哈密顿量来描述。与能量守恒的厄米系统不同，非厄米系统拥有一种被称为奇异点（Exceptional Point, EP）的特殊简并点，在该点上不仅本征值发生简并，本征矢量也会合并。本练习将通过一个物理意义明确的双耦合谐振器模型，引导您从第一性原理出发，推导奇异点出现的代数条件，从而揭示这一非厄米物理学核心概念的本质。",
            "id": "4147745",
            "problem": "考虑两个弱耦合声学谐振器，其小振幅运动由线性声学控制。从线性化的连续性方程和动量方程，结合无粘性流体的本构关系，可以得到声波方程。在清晰定义的共振点附近，将模型简化为一对缓慢变化的复模态振幅 $a_{1}(t)$ 和 $a_{2}(t)$ 是合理的。在存在固有粘性损耗和辐射损耗的情况下，振幅遵循耦合模理论（CMT）的一阶线性动力学，其中有效的非厄米 $2 \\times 2$ 时间演化生成元包含了耦合和衰减。在频域本征问题中，复本征频率由一个非厄米矩阵得到\n$$\nH \\;=\\; \\begin{pmatrix}\n\\omega_{1} - i \\frac{\\gamma_{1}}{2} & g \\\\\ng & \\omega_{2} - i \\frac{\\gamma_{2}}{2}\n\\end{pmatrix},\n$$\n其中 $\\omega_{1}$ 和 $\\omega_{2}$ 是未耦合谐振器的裸角共振频率，$\\gamma_{1} > 0$ 和 $\\gamma_{2} > 0$ 是它们的振幅衰减率，而 $g \\in \\mathbb{R}$ 是由倏逝声学耦合产生的对称实值谐振器间耦合率。奇异点（EP）是参数空间中的一个分支点奇点，在该点上，本征值和本征向量都发生合并，使得 $H$ 成为亏损矩阵且不可对角化。\n\n任务：\n- 在非厄米声学的背景下定义奇异点（EP），并从基本的线性声学模型和上述双模简化出发，推导在这个双模有损谐振器系统中本征值和本征向量同时合并的代数条件。您的推导必须从第一性原理出发，并证明为何这些条件意味着在EP点 $H$ 是一个亏损矩阵。\n- 在 $g$ 是实数且裸共振频率调谐相等（即 $\\omega_{1} = \\omega_{2}$）的约束下，确定实现EP所需的耦合率 $g$ 关于 $\\gamma_{1}$ 和 $\\gamma_{2}$ 的闭式解析表达式。\n\n将最终的耦合率以弧度/秒表示。无需四舍五入；请以单个闭式解析表达式的形式提供答案。",
            "solution": "问题陈述经评估为有效。它科学地基于线性声学和耦合模理论的原理，构成了一个适定的数学物理问题。术语精确，并且提供了推导唯一解所需的所有必要参数和条件。\n\n奇异点（EP）是非厄米系统参数空间中的一个奇点，在该点上，两个或多个本征值及其对应的本征向量同时合并。在EP点，系统的矩阵表示变为亏损的，意味着它不再可对角化。\n\n我们从给定的非厄米矩阵 $H$ 开始，它在频域中控制着双模声学系统的时间演化：\n$$\nH = \\begin{pmatrix}\n\\omega_{1} - i \\frac{\\gamma_{1}}{2} & g \\\\\ng & \\omega_{2} - i \\frac{\\gamma_{2}}{2}\n\\end{pmatrix}\n$$\n耦合系统的复本征频率 $\\lambda$ 是 $H$ 的本征值。它们通过求解特征方程 $\\det(H - \\lambda I) = 0$ 得到，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det \\begin{pmatrix}\n\\omega_{1} - i \\frac{\\gamma_{1}}{2} - \\lambda & g \\\\\ng & \\omega_{2} - i \\frac{\\gamma_{2}}{2} - \\lambda\n\\end{pmatrix} = 0\n$$\n展开行列式得到特征多项式：\n$$\n\\left( \\left(\\omega_{1} - i \\frac{\\gamma_{1}}{2}\\right) - \\lambda \\right) \\left( \\left(\\omega_{2} - i \\frac{\\gamma_{2}}{2}\\right) - \\lambda \\right) - g^2 = 0\n$$\n这是一个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda^2 - \\left( \\omega_{1} + \\omega_{2} - i \\frac{\\gamma_{1} + \\gamma_{2}}{2} \\right) \\lambda + \\left( \\omega_{1} - i \\frac{\\gamma_{1}}{2} \\right) \\left( \\omega_{2} - i \\frac{\\gamma_{2}}{2} \\right) - g^2 = 0\n$$\n两个解（本征值）由二次公式给出：\n$$\n\\lambda_{\\pm} = \\frac{1}{2} \\left[ \\left(\\omega_{1} + \\omega_{2} - i \\frac{\\gamma_{1} + \\gamma_{2}}{2}\\right) \\pm \\sqrt{\\left(\\omega_{1} + \\omega_{2} - i \\frac{\\gamma_{1} + \\gamma_{2}}{2}\\right)^2 - 4 \\left( \\left(\\omega_{1} - i \\frac{\\gamma_{1}}{2}\\right)\\left(\\omega_{2} - i \\frac{\\gamma_{2}}{2}\\right) - g^2 \\right)} \\right]\n$$\n平方根下的项，即判别式 $\\Delta$，可以被简化：\n$$\n\\Delta = \\left(\\left(\\omega_{1} - i \\frac{\\gamma_{1}}{2}\\right) + \\left(\\omega_{2} - i \\frac{\\gamma_{2}}{2}\\right)\\right)^2 - 4 \\left( \\left(\\omega_{1} - i \\frac{\\gamma_{1}}{2}\\right)\\left(\\omega_{2} - i \\frac{\\gamma_{2}}{2}\\right) - g^2 \\right)\n$$\n使用恒等式 $(a+b)^2 - 4ab = (a-b)^2$，其中 $a = \\omega_{1} - i \\frac{\\gamma_{1}}{2}$ 且 $b = \\omega_{2} - i \\frac{\\gamma_{2}}{2}$，我们得到：\n$$\n\\Delta = \\left(\\left(\\omega_{1} - i \\frac{\\gamma_{1}}{2}\\right) - \\left(\\omega_{2} - i \\frac{\\gamma_{2}}{2}\\right)\\right)^2 + 4g^2\n$$\n$$\n\\Delta = \\left( (\\omega_{1} - \\omega_{2}) - i \\frac{\\gamma_{1} - \\gamma_{2}}{2} \\right)^2 + 4g^2\n$$\n于是本征值可以紧凑地表示为：\n$$\n\\lambda_{\\pm} = \\frac{\\omega_{1} + \\omega_{2}}{2} - i\\frac{\\gamma_{1} + \\gamma_{2}}{4} \\pm \\frac{1}{2}\\sqrt{\\Delta}\n$$\n本征值合并发生在 $\\lambda_{+} = \\lambda_{-}$ 时。这要求判别式 $\\Delta$ 为零。因此，EP的代数条件是：\n$$\n\\left( (\\omega_{1} - \\omega_{2}) - i \\frac{\\gamma_{1} - \\gamma_{2}}{2} \\right)^2 + 4g^2 = 0\n$$\n在此点上，只有一个本征值 $\\lambda_{EP} = \\frac{\\omega_{1} + \\omega_{2}}{2} - i\\frac{\\gamma_{1} + \\gamma_{2}}{4}$，其代数重数为 $2$。为了证明本征向量也合并，我们考察矩阵 $H - \\lambda_{EP}I$。本征向量是该矩阵零空间中的非零向量。$\\lambda_{EP}$ 的几何重数是该零空间的维度。\n$$\nH - \\lambda_{EP}I = \\begin{pmatrix}\n(\\omega_{1} - i\\frac{\\gamma_{1}}{2}) - \\lambda_{EP} & g \\\\\ng & (\\omega_{2} - i\\frac{\\gamma_{2}}{2}) - \\lambda_{EP}\n\\end{pmatrix}\n$$\n代入 $\\lambda_{EP}$ 的表达式：\n$$\nH - \\lambda_{EP}I = \\begin{pmatrix}\n\\frac{1}{2}\\left((\\omega_{1} - \\omega_{2}) - i\\frac{\\gamma_{1}-\\gamma_{2}}{2}\\right) & g \\\\\ng & -\\frac{1}{2}\\left((\\omega_{1} - \\omega_{2}) - i\\frac{\\gamma_{1}-\\gamma_{2}}{2}\\right)\n\\end{pmatrix}\n$$\n该矩阵的行列式为 $-\\frac{1}{4}\\left((\\omega_{1} - \\omega_{2}) - i\\frac{\\gamma_{1}-\\gamma_{2}}{2}\\right)^2 - g^2 = -\\frac{1}{4}\\Delta$。由于在EP点 $\\Delta=0$，行列式为零，这意味着 $H - \\lambda_{EP}I$ 的秩小于 $2$。除非所有项都为零（一个 $g=0$, $\\omega_1=\\omega_2$, 且 $\\gamma_1=\\gamma_2$ 的平凡情况，此时 $H$ 已经是-对角矩阵），否则秩为 $1$。秩-零度定理指出，对于一个 $n \\times n$ 矩阵 $A$，有 $\\text{rank}(A) + \\text{nullity}(A) = n$。这里，$n=2$ 且秩为 $1$，所以零度（零空间的维度）为 $2 - 1 = 1$。这意味着只有一个线性无关的本征向量。\n由于代数重数（$2$）大于几何重数（$1$），矩阵 $H$ 是亏损的且不可对角化，这正是EP的定义。这完成了任务的第一部分。\n\n对于第二部分，我们给定了裸共振频率调谐相等的约束，即 $\\omega_{1} = \\omega_{2}$。我们将此条件代入上面推导的一般EP条件中：\n$$\n\\left( (0) - i \\frac{\\gamma_{1} - \\gamma_{2}}{2} \\right)^2 + 4g^2 = 0\n$$\n$$\n(i^2) \\left( \\frac{\\gamma_{1} - \\gamma_{2}}{2} \\right)^2 + 4g^2 = 0\n$$\n$$\n- \\frac{(\\gamma_{1} - \\gamma_{2})^2}{4} + 4g^2 = 0\n$$\n我们现在求解耦合率 $g$：\n$$\n4g^2 = \\frac{(\\gamma_{1} - \\gamma_{2})^2}{4}\n$$\n$$\ng^2 = \\frac{(\\gamma_{1} - \\gamma_{2})^2}{16}\n$$\n对两边取平方根得到：\n$$\ng = \\pm \\sqrt{\\frac{(\\gamma_{1} - \\gamma_{2})^2}{16}} = \\pm \\frac{|\\gamma_{1} - \\gamma_{2}|}{4}\n$$\n耦合率 $g$ 是一个表示相互作用强度的物理参数。尽管问题陈述 $g \\in \\mathbb{R}$，但 $g$ 的符号通常可以被吸收到基模的相位定义中。耦合的幅度是实现EP所需的具有物理意义的量。按照惯例，耦合率报告为非负值。因此，我们取正根。\n$$\ng = \\frac{|\\gamma_{1} - \\gamma_{2}|}{4}\n$$\n该表达式给出了在具有相同裸频率但不同损耗率的两个耦合谐振器系统中引发奇异点所需的精确耦合率。它是单个谐振器衰减率失配的函数。",
            "answer": "$$\\boxed{\\frac{|\\gamma_{1} - \\gamma_{2}|}{4}}$$"
        },
        {
            "introduction": "在非厄米系统的基础上，我们将进一步探索其在晶格模型中的拓扑效应。我们将引入一种新的体拓扑不变量——点隙拓扑数（point-gap winding number），并将其与一种独特的边界效应联系起来。这个练习将演示非厄米系统中奇特的体-边对应关系：一个非零的体拓扑数预示着所有本征态都会在系统边界上指数局域化，这一惊人现象被称为非厄米趋肤效应（non-Hermitian skin effect）。您将通过计算体不变量并数值化地观察其边界效应，来验证这一深刻的物理原理。",
            "id": "4147680",
            "problem": "考虑一个一维非互易紧束缚模型，该模型是二维声学晶格带状结构在$x$方向具有开放边界、在$y$方向具有周期性时的有效描述。该晶格被建模为一组声学谐振器，通过管道耦合。由于粘滞损耗和流动偏置，管道的几何形状被设计成在$x$方向产生不对称的耦合强度，从而产生一个非厄米算符。对于布里渊区(BZ)中每个固定的横向布洛赫波矢$k_y$，沿$x$方向的有效一维布洛赫算符是一个标量能带，其复值色散关系由$E(k_x,k_y)$给出，其中$k_x$是纵向布洛赫波矢。向右和向左的不对称最近邻耦合分别表示为$t_R(k_y)$和$t_L(k_y)$，在位项$m(k_y)$则考虑了由横向耦合和局域损耗引起的失谐。假设$t_R(k_y)$、$t_L(k_y)$和$m(k_y)$是$k_y$的实值函数，且与$k_x$无关。为了计算，使用参数化$t_R(k_y) = t_R$、$t_L(k_y) = t_L$和$m(k_y) = m_0 + M \\cos(k_y)$，其中$t_R$、$t_L$、$m_0$和$M$为常数。\n\n从线性化声波方程及其有限差分方法离散化出发，当谐振器弱耦合且波长远大于管道长度时，有效的非厄米紧束缚描述是成立的，因此在带状几何中，动力学可简化为最近邻模型。对于每个固定的$k_y$，当$k_x$遍历布里渊区时，复能带$E(k_x,k_y)$在复平面上描绘出一条闭合曲线。考虑一个固定的复基点$E_0$，它在周期性边界条件下不是算符的本征值。如果对于给定的$k_y$，复能量曲线$E(k_x,k_y)$不经过$E_0$，则在$E_0$处存在一个非厄米点能隙(NHPG)。在该$k_y$下，$E_0$处的点能隙绕数是该闭合曲线以逆时针方向环绕基点$E_0$的净圈数的整数。预测非零绕数的存在与在$x$方向开放边界条件(OBC)下的手性边缘局域化相关，即靠近$E_0$的本征态会根据非互易耦合的方向性在某一边界（左或右）呈指数局域化。\n\n任务：针对指定类型的模型，编写一个完整的程序，该程序能够：\n- 对给定测试集中的每个$k_y$，通过追踪当$k_x$遍历布里渊区时$E(k_x,k_y)-E_0$的复变参数的净变化，计算选定基点$E_0$处的点能隙绕数。\n- 对每个$k_y$，构建沿$x$方向的有限OBC哈密顿量，它是一个$N_x \\times N_x$的三对角矩阵，其对角元为$m(k_y)$，上对角元为$t_R$，下对角元为$t_L$。计算其谱和本征向量，并检测是否存在本征值位于以$E_0$为中心的复平面邻域内且其概率密度在左边界或右边界附近呈指数局域化的本征态。对给定的$k_y$使用以下定量检测标准：\n    1. 选择本征值在复数距离上最接近$E_0$的$K$个本征对，其中复数距离是$E - E_0$的模。\n    2. 如果一个本征态的复数距离小于阈值$\\varepsilon$，则认为其“靠近基点”。\n    3. 如果一个本征态沿$x$方向的概率质心（由归一化的本征向量分量的模平方计算）小于链长$N_x$的一个分数$\\alpha$，则认为其“左局域化”。如果质心超过$(1-\\alpha) N_x$，则认为其“右局域化”。\n    4. 对每个测试用例，报告在所有给定的$k_y$值上汇总后，是否存在至少一个左局域化的近基点本征态，以及是否存在至少一个右局域化的近基点本征态，结果以布尔值表示。\n\n您的程序必须实现以下数学对象和操作：\n- 将$k_x$视为在$[0,2\\pi]$上均匀网格采样的连续变量，将$k_y$视为一组指定的离散样本。所建模的布洛赫能带必须按如下公式计算\n$$\nE(k_x,k_y) = m(k_y) + t_R e^{i k_x} + t_L e^{-i k_x},\n$$\n其中$m(k_y) = m_0 + M \\cos(k_y)$，且$t_R>0$和$t_L>0$根据每个测试用例选取。\n- 通过数值计算当$k_x$在布里渊区上递增时$E(k_x,k_y)-E_0$的复变参数的净变化，并将其除以$2\\pi$得到一个整数，从而计算绕数。\n- 在OBC下，构建$N_x \\times N_x$矩阵\n$$\nH_{ij}(k_y) = m(k_y)\\,\\delta_{ij} + t_R\\,\\delta_{i,j-1} + t_L\\,\\delta_{i,j+1},\n$$\n其中$i,j \\in \\{1,\\dots,N_x\\}$，$\\delta_{ij}$是克罗内克$\\delta$函数，并分析其本征对，以根据所述定量标准检测边缘局域化的近基点态。\n\n测试套件和输出规范：\n- 对所有测试用例，使用$E_0 = 0$（无量纲单位），角度以弧度为单位，以及以下固定的检测参数：$N_x = 80$, $K = 5$, $\\varepsilon = 0.05$, and $\\alpha = 0.2$。\n- 对$k_x \\in [0,2\\pi]$，使用一个包含$N_k = 4096$个样本的均匀网格。\n- 对每个测试用例，使用$k_y$集合$\\{0,\\pi/3,\\pi\\}$。\n- 测试用例：\n    1. $(t_R,t_L,m_0,M) = (1.2,0.8,0.0,0.2)$。\n    2. $(t_R,t_L,m_0,M) = (0.7,1.3,0.0,0.2)$。\n    3. $(t_R,t_L,m_0,M) = (0.6,0.5,1.5,0.3)$。\n    4. $(t_R,t_L,m_0,M) = (0.8,0.7,1.4,0.2)$。\n    5. $(t_R,t_L,m_0,M) = (1.0,1.0,0.0,0.2)$。\n- 对每个测试用例，计算：\n    - 在集合$\\{0,\\pi/3,\\pi\\}$中，$E_0$处绕数非零的$k_y$值的整数计数。\n    - 一个布尔值，指示在这三个$k_y$值中，OBC下是否存在至少一个左局域化的近基点本征态。\n    - 一个布尔值，指示在这三个$k_y$值中，OBC下是否存在至少一个右局域化的近基点本征态。\n- 最终输出格式：您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身是一个形如$[w\\_count,\\text{left},\\text{right}]$的列表。例如，输出必须看起来像：$[[w\\_count\\_1,\\text{left\\_1},\\text{right\\_1}],[w\\_count\\_2,\\text{left\\_2},\\text{right\\_2}],\\dots]$。\n\n不允许外部输入。所有量均为无量纲，最终答案中无需物理单位。角度以弧度为单位。通过保持$t_R>0$和$t_L>0$来确保科学真实性。程序必须是完整且可运行的。",
            "solution": "在尝试任何解决方案之前，需对问题进行验证。\n\n### 步骤1：提取给定条件\n- **模型**：源自二维声学晶格的一维非互易紧束缚模型。\n- **布洛赫能带色散**：$E(k_x,k_y) = m(k_y) + t_R e^{i k_x} + t_L e^{-i k_x}$。\n- **参数化**：$m(k_y) = m_0 + M \\cos(k_y)$，其中$t_R$、$t_L$、$m_0$、$M$是实常数。$t_R > 0$, $t_L > 0$。\n- **布里渊区(BZ)**：$k_x$遍历布里渊区，在数值上由网格表示。\n- **基点**：一个固定的复能量$E_0$。\n- **非厄米点能隙(NHPG)绕数**：当$k_x \\in [0, 2\\pi]$时，曲线$E(k_x,k_y)$环绕$E_0$的整数次数。通过追踪$E(k_x,k_y)-E_0$的复变参数的净变化来计算。\n- **开放边界条件(OBC)哈密顿量**：一个$N_x \\times N_x$的矩阵$H_{ij}(k_y) = m(k_y)\\,\\delta_{ij} + t_R\\,\\delta_{i,j-1} + t_L\\,\\delta_{i,j+1}$，其中$i,j \\in \\{1,\\dots,N_x\\}$。\n- **本征态局域化判据**：\n    1.  选择本征值在复数距离上最接近$E_0$的$K$个本征对。\n    2.  如果本征值$E$满足$|E - E_0| < \\varepsilon$，则本征态被视为“靠近基点”。\n    3.  如果本征态的概率质心(COM)小于$\\alpha N_x$，则其为“左局域化”。\n    4.  如果其COM大于$(1-\\alpha) N_x$，则其为“右局域化”。\n    5.  COM根据归一化的本征向量分量的模平方计算，格点索引从1到$N_x$。\n- **固定参数**：\n    - 基点：$E_0 = 0$。\n    - 系统尺寸：$N_x = 80$。\n    - 候选态：$K = 5$。\n    - 能量阈值：$\\varepsilon = 0.05$。\n    - 局域化分数：$\\alpha = 0.2$。\n    - $k_x$网格尺寸：在$[0, 2\\pi]$内有$N_k = 4096$个样本点。\n    - $k_y$样本集：$\\{0, \\pi/3, \\pi\\}$。\n- **测试用例**：\n    1.  $(t_R,t_L,m_0,M) = (1.2,0.8,0.0,0.2)$。\n    2.  $(t_R,t_L,m_0,M) = (0.7,1.3,0.0,0.2)$。\n    3.  $(t_R,t_L,m_0,M) = (0.6,0.5,1.5,0.3)$。\n    4.  $(t_R,t_L,m_0,M) = (0.8,0.7,1.4,0.2)$。\n    5.  $(t_R,t_L,m_0,M) = (1.0,1.0,0.0,0.2)$。\n- **每个测试用例的必需输出**：\n    1.  `w_count`：绕数非零的$k_y$值的整数计数。\n    2.  `left`：布尔值，如果在所有指定的$k_y$中找到任何左局域化的近基点态，则为真。\n    3.  `right`：布尔值，如果在所有指定的$k_y$中找到任何右局域化的近基点态，则为真。\n- **输出格式**：`[[w_count_1,left_1,right_1],[w_count_2,left_2,right_2],...]`。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学依据**：该问题坚实地植根于非厄米拓扑系统的既定理论，这是凝聚态物理和声学的一个子领域。紧束缚模型、非互易跳跃($t_R \\neq t_L$)、复能带结构、点能隙绕数以及相关的体-边界对应（非厄米趋肤效应）都是标准且严格定义的概念。指定的模型是一个著名的例子（Hatano-Nelson模型的一个变体）。该问题在科学上是合理的。\n- **良定性**：该问题是良定的。它提供了所有必要的参数、方程和定量标准，以为每个测试用例计算出唯一的结果。计算复路径的绕数和对矩阵进行本征值分析等任务在数学上和计算上都是明确定义的。\n- **客观性**：问题以精确、客观和技术性的语言陈述，没有任何主观或基于意见的主张。\n- **缺陷清单**：该问题没有表现出任何列举的缺陷。它在科学上有效、可形式化、完整、一致、在理论模型范围内是现实的，并提出了一个与其所述拓扑声学主题直接相关的非平凡但可解决的挑战。在无量纲的背景下，参数是物理上合理的。\n\n### 步骤3：结论与行动\n问题有效。将提供解决方案。\n\n### 解决方案\n该问题要求分析一个一维非厄米紧束缚模型，其特征在于周期性边界条件(PBC)下的体拓扑性质和开放边界条件(OBC)下的边界局域态。这两者之间的联系是非厄米体-边界对应的一种体现。\n\n**第1部分：体拓扑不变量（绕数）**\n\n对于一个固定的横向波矢$k_y$，系统由布洛赫哈密顿量描述，其谱由复色散关系给出：\n$$\nE(k_x, k_y) = m(k_y) + t_R e^{i k_x} + t_L e^{-i k_x}\n$$\n其中$k_x \\in [0, 2\\pi]$是纵向波矢。通过分离实部和虚部，可以重写为：\n$$\nE(k_x, k_y) = [m(k_y) + (t_R + t_L)\\cos(k_x)] + i[(t_R - t_L)\\sin(k_x)]\n$$\n当$k_x$从$0$到$2\\pi$遍历布里渊区时，$E(k_x, k_y)$在复平面上描绘出一条闭合回路。这条回路是一个以$(m(k_y), 0)$为中心、沿实轴的半长轴为$t_R + t_L$、沿虚轴的半短轴为$|t_R - t_L|$的椭圆。如果$t_R = t_L$，系统是厄米的，椭圆退化为实轴上的一条线段。\n\n在复基点$E_0$处的点能隙绕数$w$由以下积分定义：\n$$\nw = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{d}{dk_x} \\left( \\arg[E(k_x, k_y) - E_0] \\right) dk_x\n$$\n这个整数计算了复能量曲线环绕$E_0$的净圈数。在数值上，这是通过离散化$k_x$路径并对复函数$f(k_x) = E(k_x, k_y) - E_0$的辐角变化求和来计算的。为了正确地跨越复辐角函数（通常在$\\pm\\pi$处）的分支切割来求和，需要一个解缠绕过程。然后将总的解缠绕相位变化除以$2\\pi$并四舍五入到最近的整数。\n\n对于给定的$k_y$，算法如下：\n1.  为$k_x$在$[0, 2\\pi]$内定义一个包含$N_k$个点的均匀网格。\n2.  对网格上所有点计算复向量$Z = E(k_x, k_y) - E_0$。\n3.  计算相位角$\\theta = \\arg(Z)$。\n4.  对相位角进行解缠绕，以获得连续的相位演化$\\theta_{\\text{unwrapped}}$。\n5.  绕数为$w = \\text{round}((\\theta_{\\text{unwrapped}}[N_k-1] - \\theta_{\\text{unwrapped}}[0]) / (2\\pi))$。\n\n解析上，对于椭圆路径，环绕$E_0=0$的绕数非零当且仅当原点被椭圆包围。这发生在$|m(k_y)| < t_R + t_L$且$t_R \\neq t_L$时。绕数的符号由$\\text{sgn}(t_R - t_L)$给出。\n\n**第2部分：边界态分析（OBC谱）**\n\n在OBC下，系统由一个$N_x \\times N_x$的非厄米三对角矩阵$H(k_y)$描述。根据问题定义$H_{ij}(k_y) = m(k_y)\\,\\delta_{ij} + t_R\\,\\delta_{i,j-1} + t_L\\,\\delta_{i,j+1}$，其中$i,j \\in \\{1,...,N_x\\}$，矩阵元素为：\n-   对角线($i=j$)：$H_{ii} = m(k_y)$\n-   上对角线($j=i+1 \\implies i=j-1$)：$H_{i,i+1} = t_R$\n-   下对角线($j=i-1 \\implies i=j+1$)：$H_{i,i-1} = t_L$\n\n非厄米体-边界对应预测，非零的体绕数($w \\neq 0$)意味着在OBC下存在稳健的、受拓扑保护的边缘态。具体来说，对于此模型，所有本征态都指数局域化在其中一个边界——这种现象被称为非厄米趋肤效应。局域化的方向由跳跃振幅之比决定：\n-   如果$|t_R| > |t_L|$，本征态局域化在左边界（格点$i=1$）。\n-   如果$|t_L| > |t_R|$，本征态局域化在右边界（格点$i=N_x$）。\n-   如果$|t_R| = |t_L|$（厄米情况），本征态是扩展的（体态）或在两个边界形成对称/反对称对。\n\n检测这些态的算法是：\n1.  对于给定的$k_y$，构建$N_x \\times N_x$矩阵$H(k_y)$。\n2.  数值计算其复本征值$\\{E_n\\}$和相应的右本征向量$\\{\\psi_n\\}$。\n3.  计算每个本征值的复数距离$|E_n - E_0|$。\n4.  识别最接近$E_0$的$K$个本征值。\n5.  过滤这个集合，只保留满足$|E_n - E_0| < \\varepsilon$的那些。\n6.  对于每个近基点本征态$\\psi_n$：\n    a.  计算每个格点$i$的概率密度：$p_i = |\\psi_{n,i}|^2$。\n    b.  归一化概率密度：$p'_i = p_i / \\sum_j p_j$。\n    c.  使用基于1的格点索引计算概率质心(COM)：$\\text{COM} = \\sum_{i=1}^{N_x} i \\cdot p'_i$。\n    d.  检查该态是左局域化($\\text{COM} < \\alpha N_x$)还是右局域化($\\text{COM} > (1-\\alpha) N_x$)。\n7.  对每个测试用例，汇总所有指定$k_y$值的发现，以确定最终的`left`和`right`局域化布尔标志。\n\n此过程系统地检验了非厄米体-边界对应对于每组参数的预测。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Solves the topological acoustics problem for the given test cases.\n    \"\"\"\n    # Fixed parameters from the problem statement\n    Nx = 80\n    K = 5\n    epsilon = 0.05\n    alpha = 0.2\n    Nk = 4096\n    E0 = 0.0\n    ky_set = np.array([0, np.pi / 3, np.pi])\n\n    # Test cases: (tR, tL, m0, M)\n    test_cases = [\n        (1.2, 0.8, 0.0, 0.2),\n        (0.7, 1.3, 0.0, 0.2),\n        (0.6, 0.5, 1.5, 0.3),\n        (0.8, 0.7, 1.4, 0.2),\n        (1.0, 1.0, 0.0, 0.2),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        tR, tL, m0, M = case\n        \n        w_count = 0\n        found_left_localized = False\n        found_right_localized = False\n\n        for ky in ky_set:\n            m_ky = m0 + M * np.cos(ky)\n\n            # Part 1: Winding number calculation\n            kx_grid = np.linspace(0, 2 * np.pi, Nk, endpoint=True)\n            exp_ikx = np.exp(1j * kx_grid)\n            \n            E_vals = m_ky + tR * exp_ikx + tL / exp_ikx\n            \n            winding = 0\n            # Analytically, the winding number is non-zero iff the origin is inside the ellipse\n            # defined by E(kx). This happens when |m_ky|  tR + tL for the real axis, and tR != tL.\n            # The winding number will be sgn(tR - tL) if the origin is enclosed.\n            if not np.isclose(tR, tL):\n                if np.abs(m_ky)  tR + tL:\n                     # For a more robust numerical calculation:\n                    angles = np.angle(E_vals - E0)\n                    unwrapped_angles = np.unwrap(angles)\n                    total_phase_change = unwrapped_angles[-1] - unwrapped_angles[0]\n                    winding = int(np.round(total_phase_change / (2 * np.pi)))\n            \n            if winding != 0:\n                w_count += 1\n\n            # Part 2: OBC eigenstate analysis\n            # Construct the OBC Hamiltonian matrix H\n            diag_main = np.full(Nx, m_ky, dtype=np.complex128)\n            diag_upper = np.full(Nx - 1, tR, dtype=np.complex128)\n            diag_lower = np.full(Nx - 1, tL, dtype=np.complex128)\n            \n            H_obc = np.diag(diag_main) + np.diag(diag_upper, k=1) + np.diag(diag_lower, k=-1)\n            \n            # Compute eigenvalues and right eigenvectors\n            eigenvalues, eigenvectors = eig(H_obc)\n            \n            # Find K eigenvalues closest to E0\n            distances = np.abs(eigenvalues - E0)\n            sorted_indices = np.argsort(distances)\n            \n            candidate_indices = sorted_indices[:K]\n            \n            # Check localization for near-basepoint states\n            site_indices = np.arange(1, Nx + 1)\n            left_threshold = alpha * Nx\n            right_threshold = (1 - alpha) * Nx\n\n            for i in candidate_indices:\n                if distances[i]  epsilon:\n                    eigenvector = eigenvectors[:, i]\n                    prob_density = np.abs(eigenvector)**2\n                    norm = np.sum(prob_density)\n                    if norm > 1e-9: # Avoid division by zero for null vectors\n                        prob_density_normalized = prob_density / norm\n                        \n                        com = np.sum(site_indices * prob_density_normalized)\n                        \n                        if com  left_threshold:\n                            found_left_localized = True\n                        if com > right_threshold:\n                            found_right_localized = True\n\n        formatted_res = f\"[{w_count},{str(found_left_localized).lower()},{str(found_right_localized).lower()}]\"\n        all_results.append(formatted_res)\n\n    final_output_string = f\"[{','.join(all_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}