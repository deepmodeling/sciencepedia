{
    "hands_on_practices": [
        {
            "introduction": "The characterization of two-dimensional topological materials often begins with computing a key topological invariant known as the Chern number. This integer quantity classifies the geometric structure of the energy bands and, via the bulk-boundary correspondence, directly predicts the number of robust, one-way edge modes. This exercise  offers a practical, hands-on implementation of the Fukui-Hatsugai-Suzuki method, a powerful and numerically stable algorithm for calculating the Chern number on a discretized Brillouin zone.",
            "id": "4147729",
            "problem": "Consider a two-dimensional periodic acoustic metamaterial modeled at low frequencies by a coupled-mode effective Bloch operator with two hybridized pressure modes per unit cell. By spatial periodicity and the Bloch theorem, the small-amplitude pressure field can be represented by Bloch wave solutions labeled by a Bloch wavevector $k = (k_x,k_y)$ on the first Brillouin zone, which is taken to be the square domain $k_x,k_y \\in [-\\pi,\\pi]$ with angles in radians. The mode coupling is chosen to be symmetry-allowed and non-reciprocal, producing an effective $2 \\times 2$ Hermitian Bloch operator\n$$\nH(k) = \\sin(k_x)\\,\\sigma_x + \\sin(k_y)\\,\\sigma_y + \\left(m + \\cos(k_x) + \\cos(k_y)\\right)\\,\\sigma_z,\n$$\nwhere $m$ is a dimensionless bias parameter tunable by rotating the resonators or by imposing a steady acoustic flow, and $\\sigma_x,\\sigma_y,\\sigma_z$ are the Pauli matrices. For each $k$, the eigenvalue problem $H(k)\\,u_b(k) = \\omega_b(k)\\,u_b(k)$ defines band-indexed normalized eigenmodes $u_b(k)$.\n\nThe first Chern number of an isolated band $b$ is the integer given by the integral of the Berry curvature over the Brillouin zone, which arises from the geometric phase accumulated by parallel transport of $u_b(k)$ around infinitesimal loops in $k$-space. Starting from the definition of the Berry connection and Berry curvature and using the fact that numerical computation operates on a finite mesh, construct a discrete approximation of the Chern number for the lower band $b=0$ (the band with the smaller eigenvalue) based on gauge-invariant link variables on a uniform grid of the Brillouin zone. Implement the method by discretizing the Brillouin zone into a uniform $N \\times N$ mesh of $k$-points, with $k_x$ and $k_y$ sampled uniformly in $[-\\pi,\\pi]$. Use periodic boundary conditions on the mesh so that neighboring points at the boundary wrap around.\n\nCompute the discrete Berry flux over each elementary plaquette from the phase accumulated by transporting the eigenvector around the plaquette, and sum over all plaquettes to estimate the lower-band Chern number. For numerical stability, ensure that eigenvectors are normalized at each $k$ and use gauge-invariant comparisons of neighboring eigenvectors. The angles must be treated in radians.\n\nIn addition to computing the Chern number, estimate two numerical error metrics:\n\n- A finite-mesh discretization error estimate: compute the absolute difference between the Chern number obtained on the base mesh size $N$ and the refined mesh size $2N$, both using the same $m$ and the same method described above. Report this difference as a non-negative real number.\n\n- A mode orthogonality stability metric: for the base mesh size $N$, compute the average deviation of the neighbor overlaps from unit magnitude across the mesh for the lower band. Specifically, at each $k$ on the mesh, compute the overlap magnitudes $s_x(k) = \\left|\\langle u_0(k)\\,|\\,u_0(k+\\Delta_x)\\rangle\\right|$ and $s_y(k) = \\left|\\langle u_0(k)\\,|\\,u_0(k+\\Delta_y)\\rangle\\right|$, where $\\Delta_x$ and $\\Delta_y$ denote one-mesh-step displacements in the $k_x$ and $k_y$ directions with periodic wrapping. Then define the orthogonality stability metric as the arithmetic mean over all $k$ of $\\left(1 - s_x(k)\\right)$ and $\\left(1 - s_y(k)\\right)$; report this mean as a real number in $[0,1]$. Larger values indicate stronger local gauge fluctuations due to coarse sampling or near-degeneracies.\n\nYour program must, for each test case in the following test suite, output a list with three entries $[C, E_{\\mathrm{mesh}}, E_{\\mathrm{ortho}}]$ where $C$ is the computed lower-band Chern number on the base mesh $N$ (reported as a real number without rounding), $E_{\\mathrm{mesh}}$ is the finite-mesh discretization error estimate as defined above, and $E_{\\mathrm{ortho}}$ is the mode orthogonality stability metric as defined above. The test suite contains the following parameter sets $(m,N)$:\n\n- Test case $1$: $(m,N) = (-1.0,\\,21)$.\n- Test case $2$: $(m,N) = (0.0,\\,21)$, a gap-closing boundary case.\n- Test case $3$: $(m,N) = (1.0,\\,21)$.\n- Test case $4$: $(m,N) = (3.0,\\,21)$.\n- Test case $5$: $(m,N) = (-1.0,\\,9)$, a coarse mesh to stress orthogonality stability.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets, for example, $[[r_{11},r_{12},r_{13}],[r_{21},r_{22},r_{23}],\\ldots]$, where each $r_{ij}$ is a real number. Angles must be in radians, and no physical units are required because all quantities are dimensionless. The code must be self-contained and runnable without any input.",
            "solution": "The problem requires the computation of the first Chern number for the lower band of a two-dimensional topological acoustic metamaterial, along with two numerical error metrics. The solution necessitates a numerical approach based on a lattice discretization of the Brillouin zone.\n\nThe system is described by a $2 \\times 2$ Hermitian Bloch operator, or Hamiltonian, which is a function of the Bloch wavevector $k = (k_x, k_y)$:\n$$\nH(k) = d_x(k)\\,\\sigma_x + d_y(k)\\,\\sigma_y + d_z(k)\\,\\sigma_z\n$$\nwhere $\\sigma_x, \\sigma_y, \\sigma_z$ are the Pauli matrices:\n$$\n\\sigma_x = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad \\sigma_y = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}, \\quad \\sigma_z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\nThe components of the vector $\\vec{d}(k)$ are given by $d_x(k) = \\sin(k_x)$, $d_y(k) = \\sin(k_y)$, and $d_z(k) = m + \\cos(k_x) + \\cos(k_y)$. The parameter $m$ tunes the system through different topological phases. The eigenvalues of this Hamiltonian are $\\omega(k) = \\pm|\\vec{d}(k)|$, defining two energy bands. The problem focuses on the lower band, corresponding to the eigenvalue $\\omega_0(k) = -|\\vec{d}(k)|$.\n\nThe first Chern number, $C$, is a topological invariant that characterizes the band structure. It is defined as the integral of the Berry curvature, $\\mathcal{F}(k)$, over the first Brillouin zone (BZ):\n$$\nC = \\frac{1}{2\\pi} \\int_{\\mathrm{BZ}} \\mathcal{F}(k) \\, dk_x dk_y\n$$\nThe Berry curvature arises from the geometry of the eigenstates. For a numerical calculation on a finite grid, a direct discretization of this integral is cumbersome due to the gauge-dependent nature of the underlying Berry connection. A more robust method, as suggested by the problem, is based on a lattice gauge theory formulation proposed by Fukui, Hatsugai, and Suzuki.\n\nThe numerical procedure is as follows:\n\n1.  **Discretization of the Brillouin Zone**: The BZ, $k_x, k_y \\in [-\\pi, \\pi]$, is discretized into a uniform $N \\times N$ grid. To respect the periodic nature of the BZ, the grid points are chosen as $k_{i_x, i_y} = (k_x^{(i_x)}, k_y^{(i_y)})$ where $k_{x,y}^{(i)} = -\\pi + i \\frac{2\\pi}{N}$ for $i_{x,y} \\in \\{0, 1, \\dots, N-1\\}$.\n\n2.  **Eigenvector Calculation**: At each grid point $k$, the Hamiltonian matrix $H(k)$ is constructed and diagonalized to find its eigenvalues and eigenvectors. We are interested in the normalized eigenvector $u_0(k)$ corresponding to the lowest eigenvalue $\\omega_0(k)$. This is performed for all $N^2$ points on the grid.\n\n3.  **Link Variables**: We define link variables that connect adjacent eigenvectors on the lattice. These are complex numbers representing the gauge-invariant part of the parallel transport:\n    $$\n    U_x(k) = \\langle u_0(k) | u_0(k + \\Delta_x) \\rangle\n    $$\n    $$\n    U_y(k) = \\langle u_0(k) | u_0(k + \\Delta_y) \\rangle\n    $$\n    where $\\Delta_x$ and $\\Delta_y$ are the lattice vectors in the $k_x$ and $k_y$ directions, respectively. The inner product is $\\langle a | b \\rangle = a^\\dagger b$.\n\n4.  **Plaquette Berry Flux**: The local Berry flux through an elementary plaquette starting at point $k$ is calculated from the argument of the plaquette's Wilson loop. This product of four link variables around the plaquette is a gauge-invariant quantity:\n    $$\n    W(k) = U_x(k) \\, U_y(k+\\Delta_x) \\, U_x(k+\\Delta_y)^* \\, U_y(k)^*\n    $$\n    The local flux is then $\\mathcal{F}_{\\text{lat}}(k) = \\arg(W(k))$. The branch of the complex logarithm must be chosen in $(-\\pi, \\pi]$, which is naturally handled by the `atan2` function (or `numpy.angle`).\n\n5.  **Chern Number Summation**: The total Chern number is the sum of these local fluxes over all $N^2$ plaquettes in the BZ, normalized by $2\\pi$:\n    $$\n    C = \\frac{1}{2\\pi} \\sum_{k \\in \\text{grid}} \\mathcal{F}_{\\text{lat}}(k)\n    $$\n    For a gapped system and a sufficiently fine mesh, this sum converges to an integer.\n\nIn addition to the Chern number $C$ for a base mesh of size $N$, two error metrics are computed:\n\n-   **Finite-mesh discretization error ($E_{\\mathrm{mesh}}$)**: This metric estimates the convergence of the calculation with respect to the mesh size. It is computed as the absolute difference between the Chern numbers calculated on the base ($N \\times N$) and a refined ($2N \\times 2N$) mesh:\n    $$\n    E_{\\mathrm{mesh}} = |C_N - C_{2N}|\n    $$\n\n-   **Mode orthogonality stability metric ($E_{\\mathrm{ortho}}$)**: This metric quantifies the \"smoothness\" of the eigenvector field across the BZ. Since normalized eigenvectors at neighboring points $k$ and $k'$ should be nearly identical (differing by a small rotation), the magnitude of their inner product $|\\langle u_0(k) | u_0(k') \\rangle|$ should be close to $1$. A significant deviation from $1$ indicates a rapid change in the eigenvector, which occurs near band degeneracies (gap-closing points) or if the mesh is too coarse. The metric is defined as the average deviation from unity over all links on the base $N \\times N$ grid:\n    $$\n    E_{\\mathrm{ortho}} = \\frac{1}{2N^2} \\sum_{k \\in \\text{grid}} \\left[ \\left(1 - |\\langle u_0(k)|u_0(k+\\Delta_x)\\rangle|\\right) + \\left(1 - |\\langle u_0(k)|u_0(k+\\Delta_y)\\rangle|\\right) \\right]\n    $$\n\nThe implementation leverages `numpy` for efficient, vectorized computations. The k-space grid is generated using `meshgrid`. The Hamiltonian is constructed as an array of shape $(N, N, 2, 2)$. `numpy.linalg.eigh` is used to diagonalize all $N^2$ matrices simultaneously. Periodic boundary conditions are handled efficiently using `numpy.roll` for shifting arrays to access neighboring grid points. This vectorized approach avoids slow Python loops and is well-suited for this class of problem.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_properties(m, N_grid):\n    \"\"\"\n    Computes the Chern number and orthogonality metrics for a given m and grid size N.\n\n    Args:\n        m (float): The bias parameter in the Hamiltonian.\n        N_grid (int): The number of points along one dimension of the BZ grid.\n\n    Returns:\n        tuple: A tuple containing:\n            - chern_number (float): The computed Chern number for the lower band.\n            - s_x (np.ndarray): Array of overlap magnitudes in the x-direction.\n            - s_y (np.ndarray): Array of overlap magnitudes in the y-direction.\n    \"\"\"\n    # Create the k-space grid. np.linspace with endpoint=False is standard for\n    # periodic Fourier-space calculations.\n    k_vals = np.linspace(-np.pi, np.pi, N_grid, endpoint=False)\n    kx, ky = np.meshgrid(k_vals, k_vals, indexing='ij')\n\n    # Construct the Hamiltonian H(k) = d(k) . sigma over the entire grid.\n    # The shape will be (N_grid, N_grid, 2, 2).\n    H = np.zeros((N_grid, N_grid, 2, 2), dtype=complex)\n    \n    # Components of the d-vector\n    d_x = np.sin(kx)\n    d_y = np.sin(ky)\n    d_z = m + np.cos(kx) + np.cos(ky)\n\n    # Populate the Hamiltonian matrices using Pauli matrix definitions\n    H[..., 0, 0] = d_z\n    H[..., 1, 1] = -d_z\n    H[..., 0, 1] = d_x - 1j * d_y\n    H[..., 1, 0] = d_x + 1j * d_y\n\n    # Diagonalize the Hamiltonian at each k-point.\n    # np.linalg.eigh is for Hermitian matrices and returns sorted eigenvalues\n    # and corresponding normalized eigenvectors.\n    # evals shape: (N_grid, N_grid, 2)\n    # evecs shape: (N_grid, N_grid, 2, 2)\n    evals, evecs = np.linalg.eigh(H)\n\n    # Extract the eigenvectors for the lower band (corresponding to the first eigenvalue).\n    # u0 shape: (N_grid, N_grid, 2)\n    u0 = evecs[..., 0]\n\n    # Compute link variables (overlaps) using periodic boundary conditions via np.roll.\n    # The inner product is <u|v> = u*.v\n    link_x = np.sum(u0.conj() * np.roll(u0, -1, axis=0), axis=2)\n    link_y = np.sum(u0.conj() * np.roll(u0, -1, axis=1), axis=2)\n\n    # Compute the plaquette Wilson loop product: U_x(k) U_y(k+dx) U_x(k+dy)* U_y(k)*\n    plaquette_prod = link_x * np.roll(link_y, -1, axis=0) * np.conj(np.roll(link_x, -1, axis=1)) * np.conj(link_y)\n\n    # The Chern number is the sum of the argument of the plaquette products, normalized by 2*pi.\n    # np.angle correctly handles the principal value of the argument.\n    chern_number = np.sum(np.angle(plaquette_prod)) / (2 * np.pi)\n\n    # For the orthogonality metric, we need the magnitudes of the link variables.\n    s_x = np.abs(link_x)\n    s_y = np.abs(link_y)\n    \n    return chern_number, s_x, s_y\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all specified test cases.\n    \"\"\"\n    # (Parameter set 1), (Parameter set 2), ...\n    test_cases = [\n        (-1.0, 21),  # Test case 1\n        (0.0, 21),   # Test case 2\n        (1.0, 21),   # Test case 3\n        (3.0, 21),   # Test case 4\n        (-1.0, 9)    # Test case 5\n    ]\n\n    results = []\n    for m, N in test_cases:\n        # Calculate properties for the base mesh size N\n        C_N, s_x_N, s_y_N = compute_properties(m, N)\n\n        # Calculate Chern number for the refined mesh size 2N for the error estimate\n        C_2N, _, _ = compute_properties(m, 2 * N)\n\n        # E_mesh: Finite-mesh discretization error estimate\n        E_mesh = np.abs(C_N - C_2N)\n\n        # E_ortho: Mode orthogonality stability metric for the base mesh N\n        # This is the arithmetic mean of (1 - s) over all links\n        num_links = 2 * N * N\n        total_deviation = np.sum(1 - s_x_N) + np.sum(1 - s_y_N)\n        E_ortho = total_deviation / num_links\n\n        # Append results for the current test case\n        # C_N is reported, not rounded, as per instructions.\n        results.append([C_N, E_mesh, E_ortho])\n\n    # Final print statement in the exact required format.\n    # map(str, results) converts each inner list to its string representation.\n    # e.g., [1.0, 0.1, 0.01] -> '[1.0, 0.1, 0.01]'\n    # ','.join(...) joins these strings with commas.\n    # f\"[{...}]\" wraps the entire thing in the outermost brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving beyond idealized lossless systems, non-Hermitian models are essential for describing realistic acoustic metamaterials with intrinsic loss or gain. These systems can host topological phenomena with no Hermitian equivalent, most notably the non-Hermitian skin effect. This practice  provides a concrete computational example of the non-Hermitian bulk-boundary correspondence, demonstrating how a non-trivial winding number calculated for the bulk material predicts the exponential localization of all eigenstates at the system's edge under open boundary conditions.",
            "id": "4147680",
            "problem": "Consider a one-dimensional non-reciprocal tight-binding model that arises as an effective description of a strip of a two-dimensional acoustic lattice with open boundaries along the $x$-direction and periodicity along the $y$-direction. The lattice is modeled as a set of acoustic resonators coupled by ducts whose geometry is engineered to yield asymmetric coupling strengths in the $x$-direction due to viscous losses and flow bias, producing a non-Hermitian operator. For each fixed transverse Bloch wave number $k_y$ in the Brillouin Zone (BZ), the effective one-dimensional Bloch operator along $x$ is a scalar band with complex-valued dispersion given by $E(k_x,k_y)$, where $k_x$ is the longitudinal Bloch wave number. The asymmetric nearest-neighbor couplings are denoted by $t_R(k_y)$ to the right and $t_L(k_y)$ to the left, and the on-site term $m(k_y)$ accounts for detuning caused by transverse coupling and local losses. Assume $t_R(k_y)$, $t_L(k_y)$, and $m(k_y)$ are real-valued functions of $k_y$ and independent of $k_x$. For the purposes of computation, use the parametrization $t_R(k_y) = t_R$, $t_L(k_y) = t_L$, and $m(k_y) = m_0 + M \\cos(k_y)$ with constants $t_R$, $t_L$, $m_0$, and $M$.\n\nStarting from the linearized acoustic wave equation and its finite-difference discretization, the effective non-Hermitian tight-binding description is valid when the resonators are weakly coupled and the wavelength is large compared to the duct lengths, so that the dynamics reduces to a nearest-neighbor model in the strip geometry. The complex band $E(k_x,k_y)$ traces a closed curve in the complex plane as $k_x$ runs over the Brillouin Zone for each fixed $k_y$. Consider a fixed complex basepoint $E_0$ which is not an eigenvalue of the operator under periodic boundary conditions. A Non-Hermitian Point-Gap (NHPG) exists at $E_0$ for a given $k_y$ if the complex energy curve $E(k_x,k_y)$ does not pass through $E_0$. The point-gap winding number at $E_0$ for that $k_y$ is the integer counting the net number of times the closed curve winds around the basepoint $E_0$ in the counterclockwise sense. The presence of a nonzero winding number is predicted to correlate with chiral edge localization under Open Boundary Conditions (OBC) along $x$, in the sense that eigenstates near $E_0$ become exponentially localized at one boundary (left or right) depending on the directionality of the non-reciprocal coupling.\n\nTask: For the specified class of models, write a complete program that:\n- Computes, for each $k_y$ in a provided test set, the point-gap winding number at a chosen basepoint $E_0$ by tracking the net change in the complex argument of $E(k_x,k_y)-E_0$ as $k_x$ traverses the Brillouin Zone.\n- Builds the finite OBC Hamiltonian along $x$ for each $k_y$ as an $N_x \\times N_x$ tridiagonal matrix with diagonal entries $m(k_y)$, upper diagonal entries $t_R$, and lower diagonal entries $t_L$, computes its spectrum and eigenvectors, and detects whether there exist eigenstates whose eigenvalues lie within an $E_0$-centered neighborhood in the complex plane and whose probability density is exponentially localized near the left or the right boundary. Use the following quantitative detection criteria for a given $k_y$:\n    1. Select the $K$ eigenpairs with eigenvalues closest in complex distance to $E_0$, where the complex distance is the magnitude of $E - E_0$.\n    2. An eigenstate is considered \"near the basepoint\" if its complex distance is less than a threshold $\\varepsilon$.\n    3. An eigenstate is considered \"left-localized\" if its probability center of mass along $x$ (computed from the normalized squared magnitude of the eigenvector components) is less than a fraction $\\alpha$ of the chain length $N_x$. It is considered \"right-localized\" if the center of mass exceeds $(1-\\alpha) N_x$.\n    4. Report the presence of at least one left-localized near-basepoint eigenstate and the presence of at least one right-localized near-basepoint eigenstate as booleans for each test case, aggregated across the provided $k_y$ values.\n\nYour program must implement the following mathematical objects and operations:\n- Treat $k_x$ as a continuous variable sampled on a uniform grid in $[0,2\\pi]$ and $k_y$ as a set of specified discrete samples. The modeled Bloch band must be evaluated as\n$$\nE(k_x,k_y) = m(k_y) + t_R e^{i k_x} + t_L e^{-i k_x},\n$$\nwhere $m(k_y) = m_0 + M \\cos(k_y)$, $t_R>0$, and $t_L>0$ are chosen per test case.\n- Compute the winding number by numerically evaluating the net change in the complex argument of $E(k_x,k_y)-E_0$ as $k_x$ increments over the Brillouin Zone and normalizing by $2\\pi$ to obtain an integer.\n- Under OBC, construct the $N_x \\times N_x$ matrix\n$$\nH_{ij}(k_y) = m(k_y)\\,\\delta_{ij} + t_R\\,\\delta_{i,j-1} + t_L\\,\\delta_{i,j+1},\n$$\nwith $i,j \\in \\{1,\\dots,N_x\\}$, where $\\delta_{ij}$ is the Kronecker delta, and analyze its eigenpairs to detect edge-localized near-basepoint states per the quantitative criteria stated.\n\nTest suite and output specification:\n- Use $E_0 = 0$ (dimensionless units), angle in radians, and the following fixed detection parameters for all test cases: $N_x = 80$, $K = 5$, $\\varepsilon = 0.05$, and $\\alpha = 0.2$.\n- Use a uniform grid of $N_k = 4096$ samples for $k_x \\in [0,2\\pi]$.\n- For each test case, use the $k_y$ set $\\{0,\\pi/3,\\pi\\}$.\n- Test cases:\n    1. $(t_R,t_L,m_0,M) = (1.2,0.8,0.0,0.2)$.\n    2. $(t_R,t_L,m_0,M) = (0.7,1.3,0.0,0.2)$.\n    3. $(t_R,t_L,m_0,M) = (0.6,0.5,1.5,0.3)$.\n    4. $(t_R,t_L,m_0,M) = (0.8,0.7,1.4,0.2)$.\n    5. $(t_R,t_L,m_0,M) = (1.0,1.0,0.0,0.2)$.\n- For each test case, compute:\n    - The integer count of $k_y$ values in the set $\\{0,\\pi/3,\\pi\\}$ for which the winding number at $E_0$ is nonzero.\n    - A boolean indicating whether there exists at least one left-localized near-basepoint eigenstate under OBC among those three $k_y$ values.\n    - A boolean indicating whether there exists at least one right-localized near-basepoint eigenstate under OBC among those three $k_y$ values.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of the form $[w\\_count,\\text{left},\\text{right}]$. For example, the output must look like: $[[w\\_count\\_1,\\text{left\\_1},\\text{right\\_1}],[w\\_count\\_2,\\text{left\\_2},\\text{right\\_2}],\\dots]$.\n\nNo external inputs are permitted. All quantities are dimensionless and require no physical units in the final answers. Angles are in radians. Ensure scientific realism by keeping $t_R>0$ and $t_L>0$. The program must be complete and runnable.",
            "solution": "The problem requires the analysis of a one-dimensional non-Hermitian tight-binding model, characterized by its bulk topological properties under Periodic Boundary Conditions (PBC) and its boundary-localized states under Open Boundary Conditions (OBC). The connection between these two is a manifestation of the non-Hermitian bulk-boundary correspondence.\n\n**Part 1: Bulk Topological Invariant (Winding Number)**\n\nFor a fixed transverse wave number $k_y$, the system is described by the Bloch Hamiltonian whose spectrum is given by the complex dispersion relation:\n$$\nE(k_x, k_y) = m(k_y) + t_R e^{i k_x} + t_L e^{-i k_x}\n$$\nwhere $k_x \\in [0, 2\\pi]$ is the longitudinal wave number. This can be rewritten by separating real and imaginary parts:\n$$\nE(k_x, k_y) = [m(k_y) + (t_R + t_L)\\cos(k_x)] + i[(t_R - t_L)\\sin(k_x)]\n$$\nAs $k_x$ traverses the Brillouin zone from $0$ to $2\\pi$, $E(k_x, k_y)$ traces a closed loop in the complex plane. This loop is an ellipse centered at $(m(k_y), 0)$, with semi-major axis $t_R + t_L$ along the real axis and semi-minor axis $|t_R - t_L|$ along the imaginary axis. If $t_R = t_L$, the system is Hermitian, and the ellipse degenerates into a line segment on the real axis.\n\nThe point-gap winding number, $w$, at a complex basepoint $E_0$ is defined by the integral:\n$$\nw = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{d}{dk_x} \\left( \\arg[E(k_x, k_y) - E_0] \\right) dk_x\n$$\nThis integer counts the net number of times the complex energy curve winds around $E_0$. Numerically, this is calculated by discretizing the $k_x$ path and summing the changes in the argument of the complex function $f(k_x) = E(k_x, k_y) - E_0$. To correctly sum these changes across the branch cut of the complex argument function (typically at $\\pm\\pi$), an unwrapping procedure is necessary. The total unwrapped phase change is then divided by $2\\pi$ and rounded to the nearest integer.\n\nThe algorithm for a given $k_y$ is:\n1.  Define a uniform grid of $N_k$ points for $k_x$ in $[0, 2\\pi]$.\n2.  Evaluate the complex vector $Z = E(k_x, k_y) - E_0$ for all points on the grid.\n3.  Compute the phase angles $\\theta = \\arg(Z)$.\n4.  Unwrap the phase angles to obtain a continuous phase evolution, $\\theta_{\\text{unwrapped}}$.\n5.  The winding number is $w = \\text{round}((\\theta_{\\text{unwrapped}}[N_k-1] - \\theta_{\\text{unwrapped}}[0]) / (2\\pi))$.\n\nAnalytically, for the elliptical path, the winding number around $E_0=0$ is non-zero if and only if the origin is enclosed by the ellipse. This occurs when $|m(k_y)| < t_R + t_L$ and $t_R \\neq t_L$. The sign of the winding number is given by $\\text{sgn}(t_R - t_L)$.\n\n**Part 2: Boundary State Analysis (OBC Spectrum)**\n\nUnder OBC, the system is described by an $N_x \\times N_x$ non-Hermitian, tridiagonal matrix $H(k_y)$. From the problem definition $H_{ij}(k_y) = m(k_y)\\,\\delta_{ij} + t_R\\,\\delta_{i,j-1} + t_L\\,\\delta_{i,j+1}$ with $i,j \\in \\{1,...,N_x\\}$, the matrix elements are:\n-   Diagonal ($i=j$): $H_{ii} = m(k_y)$\n-   Super-diagonal ($j=i+1 \\implies i=j-1$): $H_{i,i+1} = t_R$\n-   Sub-diagonal ($j=i-1 \\implies i=j+1$): $H_{i,i-1} = t_L$\n\nThe non-Hermitian bulk-boundary correspondence predicts that a non-zero bulk winding number ($w \\neq 0$) implies the existence of robust, topologically protected edge states under OBC. Specifically, for this model, all eigenstates become exponentially localized at one of the boundariesâ€”a phenomenon known as the non-Hermitian skin effect. The direction of localization is determined by the ratio of hopping amplitudes:\n-   If $|t_R| > |t_L|$, eigenstates localize at the left boundary (site $i=1$).\n-   If $|t_L| > |t_R|$, eigenstates localize at the right boundary (site $i=N_x$).\n-   If $|t_R| = |t_L|$ (Hermitian case), eigenstates are extended (bulk states) or form symmetric/antisymmetric pairs at both boundaries.\n\nThe algorithm to detect these states is:\n1.  For a given $k_y$, construct the $N_x \\times N_x$ matrix $H(k_y)$.\n2.  Numerically compute its complex eigenvalues $\\{E_n\\}$ and corresponding right eigenvectors $\\{\\psi_n\\}$.\n3.  Calculate the complex distance $|E_n - E_0|$ for each eigenvalue.\n4.  Identify the $K$ eigenvalues closest to $E_0$.\n5.  Filter this set, retaining only those for which $|E_n - E_0| < \\varepsilon$.\n6.  For each of these near-basepoint eigenstates $\\psi_n$:\n    a.  Compute the probability density at each site $i$: $p_i = |\\psi_{n,i}|^2$.\n    b.  Normalize the probability density: $p'_i = p_i / \\sum_j p_j$.\n    c.  Calculate the probability center of mass (COM) using $1$-based indexing for sites: $\\text{COM} = \\sum_{i=1}^{N_x} i \\cdot p'_i$.\n    d.  Check if the state is left-localized ($\\text{COM} < \\alpha N_x$) or right-localized ($\\text{COM} > (1-\\alpha) N_x$).\n7.  Aggregate the findings across all specified $k_y$ values for each test case to determine the final boolean flags for `left` and `right` localization.\n\nThis procedure systematically tests the predictions of the non-Hermitian bulk-boundary correspondence for each set of parameters.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Solves the topological acoustics problem for the given test cases.\n    \"\"\"\n    # Fixed parameters from the problem statement\n    Nx = 80\n    K = 5\n    epsilon = 0.05\n    alpha = 0.2\n    Nk = 4096\n    E0 = 0.0\n    ky_set = np.array([0, np.pi / 3, np.pi])\n\n    # Test cases: (tR, tL, m0, M)\n    test_cases = [\n        (1.2, 0.8, 0.0, 0.2),\n        (0.7, 1.3, 0.0, 0.2),\n        (0.6, 0.5, 1.5, 0.3),\n        (0.8, 0.7, 1.4, 0.2),\n        (1.0, 1.0, 0.0, 0.2),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        tR, tL, m0, M = case\n        \n        w_count = 0\n        found_left_localized = False\n        found_right_localized = False\n\n        for ky in ky_set:\n            m_ky = m0 + M * np.cos(ky)\n\n            # Part 1: Winding number calculation\n            kx_grid = np.linspace(0, 2 * np.pi, Nk, endpoint=True)\n            exp_ikx = np.exp(1j * kx_grid)\n            \n            E_vals = m_ky + tR * exp_ikx + tL / exp_ikx\n            \n            winding = 0\n            # E0 cannot be an eigenvalue for PBC, so the curve E(kx) does not pass through E0.\n            # Thus, np.any(np.isclose(E_vals, E0)) should be False.\n            if not np.allclose(tR, tL):\n                angles = np.angle(E_vals - E0)\n                unwrapped_angles = np.unwrap(angles)\n                total_phase_change = unwrapped_angles[-1] - unwrapped_angles[0]\n                winding = int(np.round(total_phase_change / (2 * np.pi)))\n            \n            if winding != 0:\n                w_count += 1\n\n            # Part 2: OBC eigenstate analysis\n            # Construct the OBC Hamiltonian matrix H\n            diag_main = np.full(Nx, m_ky, dtype=np.complex128)\n            diag_upper = np.full(Nx - 1, tR, dtype=np.complex128)\n            diag_lower = np.full(Nx - 1, tL, dtype=np.complex128)\n            \n            H_obc = np.diag(diag_main) + np.diag(diag_upper, k=1) + np.diag(diag_lower, k=-1)\n            \n            # Compute eigenvalues and right eigenvectors\n            eigenvalues, eigenvectors = eig(H_obc)\n            \n            # Find K eigenvalues closest to E0\n            distances = np.abs(eigenvalues - E0)\n            sorted_indices = np.argsort(distances)\n            \n            candidate_indices = sorted_indices[:K]\n            \n            # Check localization for near-basepoint states\n            site_indices = np.arange(1, Nx + 1)\n            left_threshold = alpha * Nx\n            right_threshold = (1 - alpha) * Nx\n\n            for i in candidate_indices:\n                if distances[i] < epsilon:\n                    eigenvector = eigenvectors[:, i]\n                    prob_density = np.abs(eigenvector)**2\n                    norm = np.sum(prob_density)\n                    if norm > 1e-9: # Avoid division by zero for null vectors\n                        prob_density_normalized = prob_density / norm\n                        \n                        com = np.sum(site_indices * prob_density_normalized)\n                        \n                        if com < left_threshold:\n                            found_left_localized = True\n                        if com > right_threshold:\n                            found_right_localized = True\n\n        all_results.append([w_count, found_left_localized, found_right_localized])\n\n    # Format final output\n    def format_bool(b):\n        return 'true' if b else 'false'\n\n    formatted_results = []\n    for res in all_results:\n        w_c, l_loc, r_loc = res\n        formatted_results.append(f\"[{w_c},{str(l_loc).lower()},{str(r_loc).lower()}]\")\n\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "A hallmark of non-Hermitian physics is the existence of spectral singularities known as exceptional points (EPs), which have no counterpart in Hermitian systems. At an EP, two or more eigenvalues and their corresponding eigenvectors coalesce, leading to a defective Hamiltonian and a host of unusual physical phenomena. This exercise  is a fundamental analytical practice that builds intuition by deriving the precise conditions for an EP's existence in a simple yet physically relevant model of two coupled lossy acoustic resonators.",
            "id": "4147745",
            "problem": "Consider two weakly coupled acoustic resonators with small-amplitude motion governed by linear acoustics. Starting from the linearized continuity and momentum equations combined with a constitutive relation for an inviscid fluid, one obtains the acoustic wave equation. Near sharply defined resonances, a modal reduction to a pair of slowly varying complex mode amplitudes $a_{1}(t)$ and $a_{2}(t)$ is justified. In the presence of intrinsic viscous and radiation losses, the amplitudes obey first-order linear dynamics of the Coupled Mode Theory (CMT), where the effective non-Hermitian $2 \\times 2$ generator of time evolution incorporates both coupling and decay. In the frequency-domain eigenproblem, the complex eigenfrequencies are obtained from a non-Hermitian matrix\n$$\nH \\;=\\; \\begin{pmatrix}\n\\omega_{1} - i \\frac{\\gamma_{1}}{2} & g \\\\\ng & \\omega_{2} - i \\frac{\\gamma_{2}}{2}\n\\end{pmatrix},\n$$\nwhere $\\omega_{1}$ and $\\omega_{2}$ are the bare angular resonance frequencies of the uncoupled resonators, $\\gamma_{1} > 0$ and $\\gamma_{2} > 0$ are their amplitude decay rates, and $g \\in \\mathbb{R}$ is a symmetric real-valued inter-resonator coupling rate arising from evanescent acoustic coupling. An Exceptional Point (EP) is a branch point singularity in parameter space at which both eigenvalues and eigenvectors coalesce, rendering $H$ defective and non-diagonalizable.\n\nTask:\n- Define an Exceptional Point (EP) in the context of non-Hermitian acoustics and, starting from the fundamental linear acoustic model and the above two-mode reduction, derive the algebraic conditions for simultaneous eigenvalue and eigenvector coalescence in this two-mode lossy resonator system. Your derivation must proceed from first principles and demonstrate why the conditions imply a defective $H$ at the EP.\n- Under the constraint that $g$ is real and the bare resonance frequencies are tuned equal, i.e., $\\omega_{1} = \\omega_{2}$, determine the closed-form analytic expression for the coupling rate $g$ required to realize the EP in terms of $\\gamma_{1}$ and $\\gamma_{2}$.\n\nExpress the final coupling rate in radians per second. No rounding is required; provide your answer as a single closed-form analytic expression.",
            "solution": "An Exceptional Point (EP) is a singularity in the parameter space of a non-Hermitian system where two or more eigenvalues and their corresponding eigenvectors simultaneously coalesce. At an EP, the system's matrix representation becomes defective, meaning it is no longer diagonalizable.\n\nWe begin with the provided non-Hermitian matrix $H$, which governs the time evolution of the two-mode acoustic system in the frequency domain:\n$$\nH = \\begin{pmatrix}\n\\omega_{1} - i \\frac{\\gamma_{1}}{2} & g \\\\\ng & \\omega_{2} - i \\frac{\\gamma_{2}}{2}\n\\end{pmatrix}\n$$\nThe complex eigenfrequencies $\\lambda$ of the coupled system are the eigenvalues of $H$. They are found by solving the characteristic equation $\\det(H - \\lambda I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\det \\begin{pmatrix}\n\\omega_{1} - i \\frac{\\gamma_{1}}{2} - \\lambda & g \\\\\ng & \\omega_{2} - i \\frac{\\gamma_{2}}{2} - \\lambda\n\\end{pmatrix} = 0\n$$\nExpanding the determinant gives the characteristic polynomial:\n$$\n\\left( \\left(\\omega_{1} - i \\frac{\\gamma_{1}}{2}\\right) - \\lambda \\right) \\left( \\left(\\omega_{2} - i \\frac{\\gamma_{2}}{2}\\right) - \\lambda \\right) - g^2 = 0\n$$\nThis is a quadratic equation for $\\lambda$:\n$$\n\\lambda^2 - \\left( \\omega_{1} + \\omega_{2} - i \\frac{\\gamma_{1} + \\gamma_{2}}{2} \\right) \\lambda + \\left( \\omega_{1} - i \\frac{\\gamma_{1}}{2} \\right) \\left( \\omega_{2} - i \\frac{\\gamma_{2}}{2} \\right) - g^2 = 0\n$$\nThe two solutions (eigenvalues) are given by the quadratic formula:\n$$\n\\lambda_{\\pm} = \\frac{1}{2} \\left[ \\left(\\omega_{1} + \\omega_{2} - i \\frac{\\gamma_{1} + \\gamma_{2}}{2}\\right) \\pm \\sqrt{\\left(\\omega_{1} + \\omega_{2} - i \\frac{\\gamma_{1} + \\gamma_{2}}{2}\\right)^2 - 4 \\left( \\left(\\omega_{1} - i \\frac{\\gamma_{1}}{2}\\right)\\left(\\omega_{2} - i \\frac{\\gamma_{2}}{2}\\right) - g^2 \\right)} \\right]\n$$\nThe term under the square root, the discriminant $\\Delta$, can be simplified:\n$$\n\\Delta = \\left(\\left(\\omega_{1} - i \\frac{\\gamma_{1}}{2}\\right) + \\left(\\omega_{2} - i \\frac{\\gamma_{2}}{2}\\right)\\right)^2 - 4 \\left( \\left(\\omega_{1} - i \\frac{\\gamma_{1}}{2}\\right)\\left(\\omega_{2} - i \\frac{\\gamma_{2}}{2}\\right) - g^2 \\right)\n$$\nUsing the identity $(a+b)^2 - 4ab = (a-b)^2$, with $a = \\omega_{1} - i \\frac{\\gamma_{1}}{2}$ and $b = \\omega_{2} - i \\frac{\\gamma_{2}}{2}$, we get:\n$$\n\\Delta = \\left(\\left(\\omega_{1} - i \\frac{\\gamma_{1}}{2}\\right) - \\left(\\omega_{2} - i \\frac{\\gamma_{2}}{2}\\right)\\right)^2 + 4g^2\n$$\n$$\n\\Delta = \\left( (\\omega_{1} - \\omega_{2}) - i \\frac{\\gamma_{1} - \\gamma_{2}}{2} \\right)^2 + 4g^2\n$$\nThe eigenvalues are then expressed compactly as:\n$$\n\\lambda_{\\pm} = \\frac{\\omega_{1} + \\omega_{2}}{2} - i\\frac{\\gamma_{1} + \\gamma_{2}}{4} \\pm \\frac{1}{2}\\sqrt{\\Delta}\n$$\nEigenvalue coalescence occurs when $\\lambda_{+} = \\lambda_{-}$. This requires the discriminant $\\Delta$ to be zero. Thus, the algebraic condition for an EP is:\n$$\n\\left( (\\omega_{1} - \\omega_{2}) - i \\frac{\\gamma_{1} - \\gamma_{2}}{2} \\right)^2 + 4g^2 = 0\n$$\nAt this point, there is only one eigenvalue, $\\lambda_{EP} = \\frac{\\omega_{1} + \\omega_{2}}{2} - i\\frac{\\gamma_{1} + \\gamma_{2}}{4}$, with algebraic multiplicity $2$. To demonstrate that the eigenvectors also coalesce, we examine the matrix $H - \\lambda_{EP}I$. The eigenvectors are the non-zero vectors in the null space of this matrix. The geometric multiplicity of $\\lambda_{EP}$ is the dimension of this null space.\n$$\nH - \\lambda_{EP}I = \\begin{pmatrix}\n(\\omega_{1} - i\\frac{\\gamma_{1}}{2}) - \\lambda_{EP} & g \\\\\ng & (\\omega_{2} - i\\frac{\\gamma_{2}}{2}) - \\lambda_{EP}\n\\end{pmatrix}\n$$\nSubstituting the expression for $\\lambda_{EP}$:\n$$\nH - \\lambda_{EP}I = \\begin{pmatrix}\n\\frac{1}{2}\\left((\\omega_{1} - \\omega_{2}) - i\\frac{\\gamma_{1}-\\gamma_{2}}{2}\\right) & g \\\\\ng & -\\frac{1}{2}\\left((\\omega_{1} - \\omega_{2}) - i\\frac{\\gamma_{1}-\\gamma_{2}}{2}\\right)\n\\end{pmatrix}\n$$\nThe determinant of this matrix is $-\\frac{1}{4}\\left((\\omega_{1} - \\omega_{2}) - i\\frac{\\gamma_{1}-\\gamma_{2}}{2}\\right)^2 - g^2 = -\\frac{1}{4}\\Delta$. Since $\\Delta=0$ at the EP, the determinant is zero, meaning the rank of $H - \\lambda_{EP}I$ is less than $2$. Unless all entries are zero (a trivial case where $g=0$, $\\omega_1=\\omega_2$, and $\\gamma_1=\\gamma_2$, making $H$ already diagonal), the rank is $1$. The rank-nullity theorem states that $\\text{rank}(A) + \\text{nullity}(A) = n$ for an $n \\times n$ matrix $A$. Here, $n=2$ and the rank is $1$, so the nullity (the dimension of the null space) is $2 - 1 = 1$. This means there is only one linearly independent eigenvector.\nSince the algebraic multiplicity ($2$) is greater than the geometric multiplicity ($1$), the matrix $H$ is defective and non-diagonalizable, which is the definition of an EP. This completes the first part of the task.\n\nFor the second part, we are given the constraint that the bare resonance frequencies are tuned to be equal, i.e., $\\omega_{1} = \\omega_{2}$. We substitute this condition into the general EP condition derived above:\n$$\n\\left( (0) - i \\frac{\\gamma_{1} - \\gamma_{2}}{2} \\right)^2 + 4g^2 = 0\n$$\n$$\n(i^2) \\left( \\frac{\\gamma_{1} - \\gamma_{2}}{2} \\right)^2 + 4g^2 = 0\n$$\n$$\n- \\frac{(\\gamma_{1} - \\gamma_{2})^2}{4} + 4g^2 = 0\n$$\nWe now solve for the coupling rate $g$:\n$$\n4g^2 = \\frac{(\\gamma_{1} - \\gamma_{2})^2}{4}\n$$\n$$\ng^2 = \\frac{(\\gamma_{1} - \\gamma_{2})^2}{16}\n$$\nTaking the square root of both sides yields:\n$$\ng = \\pm \\sqrt{\\frac{(\\gamma_{1} - \\gamma_{2})^2}{16}} = \\pm \\frac{|\\gamma_{1} - \\gamma_{2}|}{4}\n$$\nThe coupling rate $g$ is a physical parameter representing the strength of the interaction. While the problem states $g \\in \\mathbb{R}$, the sign of $g$ can typically be absorbed into the phase definition of the basis modes. The magnitude of the coupling is the physically significant quantity required to achieve the EP. By convention, the coupling rate is reported as a non-negative value. Therefore, we take the positive root.\n$$\ng = \\frac{|\\gamma_{1} - \\gamma_{2}|}{4}\n$$\nThis expression gives the precise coupling rate required to induce an exceptional point in a system of two coupled resonators with identical bare frequencies but different loss rates. It is a function of the mismatch in the decay rates of the individual resonators.",
            "answer": "$$\\boxed{\\frac{|\\gamma_{1} - \\gamma_{2}|}{4}}$$"
        }
    ]
}