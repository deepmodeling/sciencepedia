{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of hybrid modeling, particularly FEM-SEA coupling, is the ability to determine *when* a subsystem transitions from deterministic, mode-by-mode behavior to a statistical regime. This transition is governed by modal density and modal overlap, which quantify how many resonant modes exist in a given frequency band. This practice guides you through the fundamental derivation of modal density for two canonical subsystems—an acoustic cavity and a plate—providing the essential tool to justify the use of SEA in a vibroacoustic problem. ",
            "id": "4126648",
            "problem": "Consider a vibroacoustic system comprised of a thin, homogeneous, isotropic elastic plate closing a rigid-walled rectangular acoustic cavity. The plate is modeled by the Kirchhoff–Love theory, and the cavity is modeled by the scalar acoustic wave equation under rigid boundary conditions. Let the cavity dimensions be $L_{x}$, $L_{y}$, and $L_{z}$, so its volume is $V = L_{x} L_{y} L_{z}$. Let the plate dimensions be $L_{x}$ and $L_{y}$, so its area is $S = L_{x} L_{y}$, thickness is $h$, mass density is $\\rho$, Young’s modulus is $E$, and Poisson’s ratio is $\\nu$. The acoustic medium has sound speed $c$. Assume high-frequency asymptotics where mode counting via phase-space volume is applicable. \n\nStarting from the governing equations appropriate to each subsystem and without invoking any pre-specified counting formulas, derive the asymptotic expressions for the modal density $n(\\omega)$ in terms of angular frequency $\\omega$ for:\n- the rectangular acoustic cavity, and\n- the thin elastic plate.\n\nExpress the cavity modal density $n_{\\mathrm{cav}}(\\omega)$ in terms of $V$ and $c$, and the plate modal density $n_{\\mathrm{plate}}(\\omega)$ in terms of $S$, $h$, $\\rho$, and the bending stiffness $D$. Then write $D$ in terms of $E$, $h$, and $\\nu$. Present the final modal density expressions in closed form.\n\nFinally, using the Statistical Energy Analysis (SEA) modal overlap criterion in angular frequency form $M(\\omega) = \\eta \\, \\omega \\, n(\\omega)$, where $\\eta$ is a dimensionless loss factor for the subsystem, discuss the frequency ranges where SEA assumptions are expected to be valid for the cavity and the plate. Explain briefly how these ranges inform hybrid coupling strategies between the Finite Element Method (FEM) and Statistical Energy Analysis (SEA), and between the Finite Element Method (FEM) or the Boundary Element Method (BEM) and Statistical Energy Analysis (SEA).\n\nYour final answer must be the two derived modal density expressions as a single closed-form analytic row vector. Do not include units in your final answer.",
            "solution": "The objective is to derive high-frequency asymptotic expressions for the modal density $n(\\omega)$ for the acoustic cavity and the thin plate. The modal density $n(\\omega)$ is defined as $n(\\omega) = \\frac{\\mathrm{d}N(\\omega)}{\\mathrm{d}\\omega}$, where $N(\\omega)$ is the number of modes with natural angular frequency less than or equal to $\\omega$. We use asymptotic mode counting via phase-space volume, which is a well-tested approach grounded in the spectral properties of elliptic operators and known as Weyl-type estimates for large wavenumber.\n\nFor the acoustic cavity, the governing equation for time-harmonic acoustic pressure $p(\\mathbf{x}, t) = P(\\mathbf{x}) \\exp(\\mathrm{i} \\omega t)$ under rigid boundaries is\n$$\n\\nabla^{2} P + k^{2} P = 0,\n$$\nwith dispersion relation\n$$\n\\omega = c k,\n$$\nwhere $k = |\\mathbf{k}|$ is the acoustic wavenumber and $c$ is the sound speed. The eigenvalues correspond to discrete wavenumbers indexed by integer triplets $(n_{x}, n_{y}, n_{z})$ determined by the cavity dimensions. In the high-frequency limit, the number of modes with $|\\mathbf{k}| \\leq k$ can be obtained by counting the integer lattice points in the positive octant of a sphere of radius $k$ in $\\mathbf{k}$-space and approximating by the volume. The fundamental cell volume in $\\mathbf{k}$-space is $(\\pi/L_{x})(\\pi/L_{y})(\\pi/L_{z}) = \\pi^{3}/V$. The volume of the positive octant of the sphere is $\\frac{1}{8} \\cdot \\frac{4}{3} \\pi k^{3} = \\frac{1}{6} \\pi k^{3}$. Therefore, the leading-order counting function is\n$$\nN_{\\mathrm{cav}}(k) \\approx \\frac{\\frac{1}{6} \\pi k^{3}}{\\pi^{3}/V} = \\frac{V k^{3}}{6 \\pi^{2}}.\n$$\nUsing the dispersion relation $\\omega = c k$, we obtain\n$$\nN_{\\mathrm{cav}}(\\omega) \\approx \\frac{V}{6 \\pi^{2}} \\left( \\frac{\\omega}{c} \\right)^{3} = \\frac{V \\, \\omega^{3}}{6 \\pi^{2} c^{3}}.\n$$\nDifferentiating with respect to $\\omega$ yields the modal density for the cavity,\n$$\nn_{\\mathrm{cav}}(\\omega) = \\frac{\\mathrm{d}N_{\\mathrm{cav}}}{\\mathrm{d}\\omega} = \\frac{V}{2 \\pi^{2}} \\frac{\\omega^{2}}{c^{3}}.\n$$\n\nFor the thin elastic plate, the Kirchhoff–Love plate equation for time-harmonic transverse displacement $w(\\mathbf{x}, t) = W(\\mathbf{x}) \\exp(\\mathrm{i} \\omega t)$ is\n$$\nD \\nabla^{4} W - \\rho h \\, \\omega^{2} W = 0,\n$$\nwhere $D$ is the bending stiffness. Introducing the bending wavenumber $k$ by writing the biharmonic eigenproblem as\n$$\n\\nabla^{4} W - k^{4} W = 0,\n$$\nthe dispersion relation follows from balancing $D k^{4} W = \\rho h \\, \\omega^{2} W$, giving\n$$\n\\omega = \\sqrt{\\frac{D}{\\rho h}} \\, k^{2}.\n$$\nDefine the parameter\n$$\n\\beta = \\sqrt{\\frac{D}{\\rho h}},\n$$\nso that the dispersion relation is $\\omega = \\beta k^{2}$. For a two-dimensional domain, the high-frequency counting function for wavenumbers $|\\mathbf{k}| \\leq k$ is given by the area of a quarter circle in $\\mathbf{k}$-space divided by the $\\mathbf{k}$-space cell area. The $\\mathbf{k}$-space cell area is $(\\pi/L_{x})(\\pi/L_{y}) = \\pi^{2}/S$, and the area of the positive quadrant of the circle is $\\frac{1}{4} \\cdot \\pi k^{2}$. Hence,\n$$\nN_{\\mathrm{plate}}(k) \\approx \\frac{\\frac{1}{4} \\pi k^{2}}{\\pi^{2}/S} = \\frac{S k^{2}}{4 \\pi}.\n$$\nUsing $\\omega = \\beta k^{2}$, we have $k^{2} = \\omega / \\beta$, and thus\n$$\nN_{\\mathrm{plate}}(\\omega) \\approx \\frac{S}{4 \\pi} \\frac{\\omega}{\\beta}.\n$$\nDifferentiating with respect to $\\omega$ yields the plate modal density,\n$$\nn_{\\mathrm{plate}}(\\omega) = \\frac{\\mathrm{d}N_{\\mathrm{plate}}}{\\mathrm{d}\\omega} = \\frac{S}{4 \\pi} \\frac{1}{\\beta} = \\frac{S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}}.\n$$\nThe bending stiffness is\n$$\nD = \\frac{E h^{3}}{12 \\left( 1 - \\nu^{2} \\right)}.\n$$\nIf desired, substituting $D$ gives\n$$\nn_{\\mathrm{plate}}(\\omega) = \\frac{S}{4 \\pi} \\sqrt{ \\frac{\\rho h}{\\frac{E h^{3}}{12 (1 - \\nu^{2})}} } = \\frac{S}{4 \\pi} \\sqrt{ \\frac{12 (1 - \\nu^{2}) \\, \\rho}{E h^{2}} }.\n$$\n\nWe now address Statistical Energy Analysis (SEA) validity via the modal overlap criterion. The modal overlap in angular frequency form is\n$$\nM(\\omega) = \\eta \\, \\omega \\, n(\\omega),\n$$\nwhere $\\eta$ is the dimensionless loss factor representing damping. SEA assumptions are typically valid when $M(\\omega)$ is sufficiently large, often $M(\\omega) \\gtrsim 3$ being a pragmatic threshold for strong modal overlap.\n\nFor the cavity,\n$$\nM_{\\mathrm{cav}}(\\omega) = \\eta \\, \\omega \\, \\frac{V}{2 \\pi^{2}} \\frac{\\omega^{2}}{c^{3}} = \\frac{\\eta V}{2 \\pi^{2} c^{3}} \\, \\omega^{3},\n$$\nwhich grows as $\\omega^{3}$. A threshold angular frequency for SEA validity can be estimated by solving $M_{\\mathrm{cav}}(\\omega) = 3$,\n$$\n\\omega_{\\mathrm{SEA,cav}} \\approx \\left( \\frac{6 \\pi^{2} c^{3}}{\\eta V} \\right)^{1/3}.\n$$\nThis indicates that larger cavity volumes $V$ and smaller damping $\\eta$ push SEA validity to higher frequencies, whereas smaller volumes and higher damping bring the SEA regime down.\n\nFor the plate,\n$$\nM_{\\mathrm{plate}}(\\omega) = \\eta \\, \\omega \\, \\frac{S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}} = \\frac{\\eta S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}} \\, \\omega,\n$$\nwhich grows linearly with $\\omega$. The threshold angular frequency follows from $M_{\\mathrm{plate}}(\\omega) = 3$,\n$$\n\\omega_{\\mathrm{SEA,plate}} \\approx \\frac{12 \\pi}{\\eta S} \\sqrt{ \\frac{D}{\\rho h} } = \\frac{12 \\pi \\beta}{\\eta S }.\n$$\nThis shows that larger plate area $S$ and smaller damping $\\eta$ push SEA validity to higher frequencies, while smaller areas or higher damping lower the SEA onset.\n\nImplications for hybrid coupling between the Finite Element Method (FEM) and Statistical Energy Analysis (SEA), and between the Finite Element Method (FEM) or the Boundary Element Method (BEM) and Statistical Energy Analysis (SEA), follow from these trends. In practice, one performs detailed deterministic modeling (FEM for the plate, FEM or BEM for the cavity) up to a crossover frequency where $M(\\omega)$ becomes sufficiently large for the subsystem, above which SEA is employed. Because $M_{\\mathrm{cav}}(\\omega)$ grows faster with frequency than $M_{\\mathrm{plate}}(\\omega)$, the acoustic cavity may enter the SEA regime at a different frequency than the plate; hybrid FEM/SEA coupling can therefore use subsystem-specific crossovers. The derived modal densities provide the necessary inputs to SEA for coupling loss factors and energy flow predictions in the high-frequency regime while FEM/BEM captures low-frequency modal detail and boundary-condition sensitivity.\n\nThe final modal density expressions are thus\n$$\nn_{\\mathrm{cav}}(\\omega) = \\frac{V \\, \\omega^{2}}{2 \\pi^{2} c^{3}}, \\qquad n_{\\mathrm{plate}}(\\omega) = \\frac{S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{V\\,\\omega^{2}}{2\\pi^{2}c^{3}} & \\dfrac{S}{4\\pi}\\sqrt{\\dfrac{\\rho h}{D}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "When coupling FEM with BEM for exterior radiation problems, the robustness of the BEM formulation is paramount. A well-known challenge is the failure of standard boundary integral equations at 'fictitious frequencies,' which can contaminate the entire hybrid solution. This exercise provides a hands-on numerical investigation into this phenomenon using the analytically solvable case of a sphere, demonstrating precisely how the Combined Field Integral Equation (CFIE) overcomes this critical instability. ",
            "id": "4126605",
            "problem": "Consider exterior acoustic scattering from a perfectly rigid sphere of radius $a$ immersed in a homogeneous fluid of sound speed $c$. The total acoustic pressure field $p(\\mathbf{x})$ satisfies the Helmholtz equation $\\nabla^2 p + k^2 p = 0$ in the unbounded exterior domain, where $k = 2\\pi f / c$ is the wavenumber associated with the excitation frequency $f$ measured in hertz (Hz). The rigid boundary condition is the Neumann condition $\\partial p / \\partial n = 0$ on the sphere surface $\\Gamma$, with $\\partial / \\partial n$ denoting differentiation along the outward normal. In a Boundary Element Method (BEM) setting, one common representation for the scattered field is via a single-layer potential with an unknown density, which leads, upon taking the normal derivative on $\\Gamma$, to a boundary integral operator (often referred to as a hypersingular operator) acting on the density. On a sphere, the spherical harmonics $Y_{\\ell m}$ diagonalize the boundary integral operators. Denote by $\\mathcal{T}$ the normalized Neumann (hypersingular) operator restricted to the boundary and by $\\mathcal{S}$ the normalized single-layer operator restricted to the boundary, both normalized so that their eigenvalues with respect to $Y_{\\ell m}$ depend only on the degree $\\ell$ and are given by $\\lambda^{(\\mathcal{T})}_\\ell(ka) = j_\\ell'(ka)$ and $\\lambda^{(\\mathcal{S})}_\\ell(ka) = j_\\ell(ka)$, respectively, where $j_\\ell$ is the spherical Bessel function of the first kind of order $\\ell$ and $j_\\ell'$ is its derivative with respect to the argument. The Combined Field Integral Equation (CFIE) augments the Neumann operator with a weighted contribution of the single-layer operator to form $\\mathcal{C}_\\eta = \\mathcal{T} + i \\eta \\mathcal{S}$, whose eigenvalues on $Y_{\\ell m}$ become $\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) = j_\\ell'(ka) + i \\eta \\, j_\\ell(ka)$ for a real positive coupling parameter $\\eta > 0$. \n\nYour task is to compute, for a given set of frequencies and parameters, the spectrum of the normalized Neumann BEM operator $\\mathcal{T}$, i.e., the list $\\left\\{\\lambda^{(\\mathcal{T})}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$, and the spectrum of the CFIE operator $\\mathcal{C}_\\eta$, i.e., the list $\\left\\{\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$, and then determine whether the standard Neumann formulation fails (operator is numerically singular) while the CFIE formulation remains unique for the specified frequency. Declare failure of the standard Neumann formulation if $\\min_{\\ell \\in \\{0,\\dots,L_{\\max}\\}} \\left| \\lambda^{(\\mathcal{T})}_\\ell(ka) \\right| \\leq \\varepsilon$, and declare CFIE uniqueness if $\\min_{\\ell \\in \\{0,\\dots,L_{\\max}\\}} \\left| \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) \\right| > \\varepsilon$, where $\\varepsilon$ is a specified tolerance. All eigenvalues are dimensionless; $a$ must be provided in meters (m), $c$ in meters per second (m/s), and $f$ in hertz (Hz).\n\nUse the following test suite. For each test case, use the given $(a,c,L_{\\max},\\eta,\\varepsilon)$ and the specified rule for $f$ to determine $k = 2\\pi f / c$ and $z = k a$. When a test case defines $f$ via a root condition, the program must compute $f$ by numerically finding the smallest positive root $z_{\\ell,1} > 0$ of $j_\\ell'(z) = 0$ and setting $f = z_{\\ell,1} c / (2\\pi a)$. The test suite is:\n\n- Test case 1 (general case away from resonance): $a = 0.5$ m, $c = 343$ m/s, $L_{\\max} = 6$, $\\eta = 1.0$, $\\varepsilon = 10^{-8}$, and choose $f$ such that $k a = 2.0$.\n- Test case 2 (irregular frequency at $\\ell = 0$): same $a, c, L_{\\max}, \\eta, \\varepsilon$ as above, and choose $f$ such that $k a$ equals the smallest positive root of $j_0'(z) = 0$.\n- Test case 3 (irregular frequency at $\\ell = 1$): same $a, c, L_{\\max}, \\eta, \\varepsilon$, and choose $f$ such that $k a$ equals the smallest positive root of $j_1'(z) = 0$.\n- Test case 4 (low-frequency edge case): same $a, c, L_{\\max}, \\eta, \\varepsilon$, and choose $f = 1.0$ Hz.\n- Test case 5 (high-frequency case): same $a, c, L_{\\max}, \\eta, \\varepsilon$, and choose $f$ such that $k a = 20.0$.\n\nFor each test case, compute the spectra $\\left\\{\\lambda^{(\\mathcal{T})}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$ and $\\left\\{\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$, then compute the two scalars $\\min_{\\ell} \\left| \\lambda^{(\\mathcal{T})}_\\ell(ka) \\right|$ and $\\min_{\\ell} \\left| \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) \\right|$, and finally the boolean flag indicating whether the standard Neumann formulation fails while the CFIE remains unique, i.e., $\\left(\\min_{\\ell} \\left| \\lambda^{(\\mathcal{T})}_\\ell(ka) \\right| \\leq \\varepsilon\\right) \\land \\left(\\min_{\\ell} \\left| \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) \\right| > \\varepsilon\\right)$.\n\nFinal Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be itself a list of the form $[\\min\\_T, \\min\\_{CFIE}, \\mathrm{flag}]$, where $\\min\\_T$ and $\\min\\_{CFIE}$ are floats (dimensionless) and $\\mathrm{flag}$ is a boolean. For example, the entire output will look like $[[\\dots],[\\dots],[\\dots],[\\dots],[\\dots]]$.",
            "solution": "The user has provided a valid problem statement grounded in the principles of computational acoustics and the Boundary Element Method (BEM). The problem is self-contained, scientifically sound, and well-posed. I will proceed with a full solution.\n\nThe problem requires an analysis of the eigenvalues of boundary integral operators associated with acoustic scattering from a rigid sphere. The total acoustic pressure field $p(\\mathbf{x})$ in the domain exterior to the sphere $\\Omega_e$ is governed by the Helmholtz equation:\n$$ \\nabla^2 p + k^2 p = 0 \\quad \\text{in } \\Omega_e $$\nwhere $k = 2\\pi f / c$ is the wavenumber, with $f$ being the frequency and $c$ the sound speed. The \"perfectly rigid\" condition translates to a homogeneous Neumann boundary condition on the sphere's surface $\\Gamma$:\n$$ \\frac{\\partial p}{\\partial n} = 0 \\quad \\text{on } \\Gamma $$\nIn the BEM, the problem is reformulated as a boundary integral equation (BIE). For the exterior Neumann problem, a standard approach leads to a BIE involving the hypersingular operator, which we denote by $\\mathcal{T}$. This formulation is known to fail at a discrete set of \"irregular\" or \"fictitious\" frequencies. These frequencies correspond to the eigenfrequencies of the associated *interior* problem. For the Neumann problem, these are the frequencies at which the interior Neumann problem (i.e., the Helmholtz equation inside the sphere with a homogeneous Neumann condition on the boundary) has a non-trivial solution.\n\nOn a sphere of radius $a$, the boundary integral operators are diagonalized by the spherical harmonics $Y_{\\ell m}$. The problem states that the eigenvalues of the normalized hypersingular operator $\\mathcal{T}$ and the normalized single-layer operator $\\mathcal{S}$ are given by:\n$$ \\lambda^{(\\mathcal{T})}_\\ell(ka) = j_\\ell'(ka) $$\n$$ \\lambda^{(\\mathcal{S})}_\\ell(ka) = j_\\ell(ka) $$\nwhere $j_\\ell$ is the spherical Bessel function of the first kind of order $\\ell$, and $j_\\ell'$ is its derivative with respect to its argument.\n\nThe failure of the standard BIE formulation occurs when the operator $\\mathcal{T}$ becomes singular, which happens if any of its eigenvalues are zero. The irregular frequencies for the exterior Neumann problem are therefore the values of $k$ for which $\\lambda^{(\\mathcal{T})}_\\ell(ka) = j_\\ell'(ka) = 0$ for some integer $\\ell \\ge 0$. At these frequencies, the BEM matrix is ill-conditioned or singular, and a unique solution cannot be guaranteed.\n\nTo remedy this, the Combined Field Integral Equation (CFIE) is often employed. It constructs a new operator by taking a linear combination of the hypersingular operator $\\mathcal{T}$ and the single-layer operator $\\mathcal{S}$. The specific form given is:\n$$ \\mathcal{C}_\\eta = \\mathcal{T} + i \\eta \\mathcal{S} $$\nwhere $\\eta > 0$ is a real coupling parameter. The eigenvalues of this new operator are:\n$$ \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) = j_\\ell'(ka) + i \\eta \\, j_\\ell(ka) $$\nThe CFIE is guaranteed to have a unique solution for all real frequencies provided $\\eta > 0$. This is because the irregular frequencies of the interior Neumann problem (where $j_\\ell'(ka) = 0$) and the irregular frequencies of the interior Dirichlet problem (where $j_\\ell(ka) = 0$) are disjoint for a sphere. Thus, if $j_\\ell'(ka) = 0$ for some $\\ell$, then $j_\\ell(ka) \\neq 0$. In this case, the CFIE eigenvalue becomes $\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) = 0 + i \\eta \\, j_\\ell(ka) = i \\eta \\, j_\\ell(ka)$, which is non-zero. Consequently, the operator $\\mathcal{C}_\\eta$ remains non-singular.\n\nThe task is to verify this behavior for a set of test cases. For each case, we must:\n1.  Determine the non-dimensional frequency parameter $z = ka$. For some cases, this involves numerically finding the smallest positive root of $j'_\\ell(z)=0$.\n2.  Compute the spectra of $\\mathcal{T}$ and $\\mathcal{C}_\\eta$ for $\\ell$ from $0$ to $L_{\\max}$. The spectrum of $\\mathcal{T}$ is the set $\\{\\lambda^{(\\mathcal{T})}_\\ell(z)\\}_{\\ell=0}^{L_{\\max}}$ and the spectrum of $\\mathcal{C}_\\eta$ is $\\{\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(z)\\}_{\\ell=0}^{L_{\\max}}$.\n3.  Find the minimum magnitude of the eigenvalues for each operator: $\\min_{\\ell} |\\lambda^{(\\mathcal{T})}_\\ell(z)|$ and $\\min_{\\ell} |\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(z)|$.\n4.  Apply the conditions: the Neumann formulation fails if $\\min_{\\ell} |\\lambda^{(\\mathcal{T})}_\\ell(z)| \\le \\varepsilon$, and the CFIE is unique if $\\min_{\\ell} |\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(z)| > \\varepsilon$. A boolean flag is set if the first condition is met and the second is also met.\n\nWe will use numerical libraries to evaluate the spherical Bessel functions $j_\\ell(z)$ and their derivatives $j'_\\ell(z)$, and a numerical root-finding algorithm to determine $z$ in the relevant test cases. The derivative of the spherical Bessel function can be obtained using the `derivative=True` argument in `scipy.special.spherical_jn` or via recurrence relations such as $j'_\\ell(z) = j_{\\ell-1}(z) - \\frac{\\ell+1}{z}j_\\ell(z)$. Note that for $\\ell=0$, $j'_0(z) = -j_1(z)$.\n\nThe procedure for each test case is as follows:\n- **Test Case 1:** $z = ka = 2.0$. This is not an irregular frequency for low $\\ell$.\n- **Test Case 2:** $z = ka$ is the smallest positive root of $j'_0(z)=0$. Since $j'_0(z) = -j_1(z)$, we find the smallest positive root of $j_1(z)=0$. This corresponds to an irregular frequency for the $\\ell=0$ mode.\n- **Test Case 3:** $z = ka$ is the smallest positive root of $j'_1(z)=0$. This corresponds to an irregular frequency for the $\\ell=1$ mode.\n- **Test Case 4:** $f = 1.0$ Hz. Calculate $z = ka = (2\\pi f/c)a = (2\\pi \\times 1.0 / 343) \\times 0.5$. This is a very low-frequency case.\n- **Test Case 5:** $z = ka = 20.0$. This is a high-frequency case, not specifically chosen to be an irregular frequency.\n\nThese steps will be implemented programmatically to generate the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import spherical_jn\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the stability of Neumann and CFIE BEM formulations for acoustic scattering\n    from a rigid sphere at various frequencies.\n    \"\"\"\n    \n    # Common parameters for all test cases as specified in the problem.\n    a = 0.5  # meters\n    c = 343.0  # m/s\n    L_max = 6\n    eta = 1.0\n    epsilon = 1e-8\n\n    # Define the test cases based on the problem statement.\n    # The 'type' key specifies how to determine ka (z).\n    test_cases = [\n        {'type': 'fixed_ka', 'value': 2.0},\n        {'type': 'root_j_prime', 'l': 0},\n        {'type': 'root_j_prime', 'l': 1},\n        {'type': 'fixed_f', 'value': 1.0},\n        {'type': 'fixed_ka', 'value': 20.0},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Step 1: Determine the non-dimensional wavenumber z = ka\n        z = 0.0\n        if case['type'] == 'fixed_ka':\n            z = case['value']\n        elif case['type'] == 'fixed_f':\n            f = case['value']\n            k = 2 * np.pi * f / c\n            z = k * a\n        elif case['type'] == 'root_j_prime':\n            l_val = case['l']\n            # The function whose root we want to find.\n            func_to_solve = lambda x: spherical_jn(l_val, x, derivative=True)\n            \n            # Find appropriate bracket for root finding.\n            # Roots of j_l'(z) are known to exist. We search in a reasonable interval.\n            if l_val == 0:\n                # j_0'(z) = -j_1(z). Smallest positive root of j_1(z) is ~4.49.\n                # Search bracket [3, 5] is safe.\n                z = brentq(func_to_solve, 3.0, 5.0)\n            elif l_val == 1:\n                # Smallest positive root of j_1'(z) is ~2.08.\n                # Search bracket [1, 3] is safe.\n                z = brentq(func_to_solve, 1.0, 3.0)\n            # Other orders are not required by the problem statement.\n\n        # Step 2: Compute spectra for T and C_eta\n        orders = np.arange(L_max + 1)\n        \n        # Eigenvalues for the Neumann operator T\n        lambda_T = spherical_jn(orders, z, derivative=True)\n        \n        # Eigenvalues for the single-layer operator S\n        lambda_S = spherical_jn(orders, z)\n        \n        # Eigenvalues for the CFIE operator C_eta\n        lambda_CFIE = lambda_T + 1j * eta * lambda_S\n\n        # Step 3: Compute minimum magnitudes\n        min_T = np.min(np.abs(lambda_T))\n        min_CFIE = np.min(np.abs(lambda_CFIE))\n\n        # Step 4: Determine the boolean flag\n        # True if Neumann fails AND CFIE is unique\n        is_failure_remedied = (min_T <= epsilon) and (min_CFIE > epsilon)\n        \n        # Store results for this test case\n        results.append([min_T, min_CFIE, is_failure_remedied])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, e.g., [[res1], [res2], ...]\n    # str() on a list gives spaces, so they are removed.\n    formatted_results = [str(r).replace(\" \", \"\") for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The numerical challenges of one subsystem can compromise the stability of the entire hybrid model. This practice moves from the operator level to the algebraic system level, demonstrating how near-resonance in the BEM component can lead to severe ill-conditioning of the fully coupled FEM-BEM matrix. By computing condition numbers and solution sensitivity for a representative system, you will gain a tangible understanding of why stabilization techniques like CFIE are not just theoretical remedies but essential for obtaining reliable numerical results. ",
            "id": "4126667",
            "problem": "Consider a hybrid computational acoustics model that couples a Finite Element Method (FEM) discretization of the interior Helmholtz problem with a Boundary Element Method (BEM) representation of the exterior radiation, optionally stabilized using the Combined Field Integral Equation (CFIE). Let the acoustic pressure satisfy the Helmholtz equation in the interior domain with wavenumber $k$ (in $\\mathrm{rad/m}$). After spatial discretization, the interior FEM block yields a linear system of the form $(\\mathbf{K}-k^2\\mathbf{M})\\mathbf{u}=\\mathbf{f}$, where $\\mathbf{K}\\in\\mathbb{R}^{n\\times n}$ is the stiffness matrix, $\\mathbf{M}\\in\\mathbb{R}^{n\\times n}$ is the mass matrix, and $\\mathbf{u}\\in\\mathbb{R}^n$ is the vector of nodal pressures. The boundary coupling to the exterior via BEM introduces a boundary variable $\\boldsymbol{\\lambda}\\in\\mathbb{C}^m$ and an operator $\\mathbf{T}(k)\\in\\mathbb{R}^{m\\times m}$ representing an approximation of the exterior integral operator. The algebraic coupled system without CFIE stabilization can be represented by the block matrix\n$$\n\\mathbf{A}(k)=\\begin{bmatrix}\n\\mathbf{K}-k^2\\mathbf{M} & \\mathbf{C}^{\\top} \\\\\n\\mathbf{C} & -\\mathbf{T}(k)\n\\end{bmatrix},\n$$\nand with CFIE stabilization by adding a complex shift to the exterior operator,\n$$\n\\mathbf{A}_{\\mathrm{CFIE}}(k)=\\begin{bmatrix}\n\\mathbf{K}-k^2\\mathbf{M} & \\mathbf{C}^{\\top} \\\\\n\\mathbf{C} & -\\big(\\mathbf{T}(k)+\\mathrm{i}\\,\\eta(k)\\mathbf{I}\\big)\n\\end{bmatrix},\n$$\nwhere $\\mathbf{C}\\in\\mathbb{R}^{m\\times n}$ is the coupling operator and $\\eta(k)$ is a real stabilization parameter that depends on $k$. The Combined Field Integral Equation (CFIE) is a well-known approach to mitigate non-uniqueness and near-resonance ill-conditioning by combining integral equations and adding a complex shift.\n\nYou must derive and implement a program to analyze the behavior of this coupled system near resonance by computing the condition number and solution sensitivity of the linear system with and without CFIE. Use the following principled construction based on fundamental definitions and well-tested facts:\n\n1. The Helmholtz interior operator is discretized on a one-dimensional domain of length $L=1\\,\\mathrm{m}$ with $n=3$ interior degrees of freedom. Use a standard second-order discretization with uniform spacing $h=L/(n+1)$, and scale the stiffness by a factor $s_K=10$ to separate interior resonance from the exterior resonance described below. Specifically,\n   $$\n   \\mathbf{K}=s_K\\frac{1}{h}\\begin{bmatrix}1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1\\end{bmatrix},\\quad\n   \\mathbf{M}=\\frac{h}{6}\\begin{bmatrix}2 & 1 & 0 \\\\ 1 & 4 & 1 \\\\ 0 & 1 & 2\\end{bmatrix}.\n   $$\n2. Set the coupling operator to be the identity scaled by $\\gamma=1$ so that $\\mathbf{C}=\\gamma\\,\\mathbf{I}_{m\\times n}$ with $m=n=3$.\n3. Model the exterior BEM operator as a real, diagonal matrix depending on $k$, constructed to have a resonance near $k=10\\,\\mathrm{rad/m}$:\n   $$\n   \\mathbf{T}(k)=\\mathbf{R}-k^2\\mathbf{S},\\quad\n   \\mathbf{R}=\\mathrm{diag}(2.0,\\,2.5,\\,3.0),\\quad\n   \\mathbf{S}=\\mathrm{diag}(0.02,\\,0.025,\\,0.03).\n   $$\n   This construction ensures $\\mathbf{T}(k)$ becomes nearly singular near $k=10\\,\\mathrm{rad/m}$.\n4. Use CFIE stabilization with parameter $\\eta(k)=k$, i.e., modify the exterior operator by adding $\\mathrm{i}\\,k\\mathbf{I}$, yielding $\\mathbf{T}_{\\mathrm{CFIE}}(k)=\\mathbf{T}(k)+\\mathrm{i}\\,k\\mathbf{I}$.\n5. Define the right-hand-side load vector as a nontrivial deterministic vector, split into interior and boundary parts:\n   $$\n   \\mathbf{b}=\\begin{bmatrix}\\mathbf{f}\\\\ \\mathbf{g}\\end{bmatrix},\\quad\n   \\mathbf{f}=\\begin{bmatrix}1\\\\0.5\\\\-0.5\\end{bmatrix},\\quad\n   \\mathbf{g}=\\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix}.\n   $$\n6. Define a small deterministic perturbation vector to assess solution sensitivity:\n   $$\n   \\Delta\\mathbf{b}=\\varepsilon\\,\\frac{\\mathbf{v}}{\\|\\mathbf{v}\\|_2},\\quad \\varepsilon=10^{-6}\\|\\mathbf{b}\\|_2,\\quad\n   \\mathbf{v}=\\begin{bmatrix}1\\\\-1\\\\0.5\\\\0.2\\\\-0.3\\\\0.1\\end{bmatrix}.\n   $$\n7. The matrix condition number is defined in the $2$-norm as\n   $$\n   \\kappa_2(\\mathbf{A})=\\frac{\\sigma_{\\max}(\\mathbf{A})}{\\sigma_{\\min}(\\mathbf{A})},\n   $$\n   where $\\sigma_{\\max}$ and $\\sigma_{\\min}$ are the largest and smallest singular values. The solution sensitivity is quantified as the amplification factor from perturbation in the load to the change in solution,\n   $$\n   s(\\mathbf{A},\\mathbf{b})=\\frac{\\|\\mathbf{x}'-\\mathbf{x}\\|_2}{\\|\\Delta\\mathbf{b}\\|_2},\n   $$\n   with $\\mathbf{x}$ solving $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$ and $\\mathbf{x}'$ solving $\\mathbf{A}\\mathbf{x}'=\\mathbf{b}+\\Delta\\mathbf{b}$.\n\nImplement a program that, for each test case wavenumber $k$ (in $\\mathrm{rad/m}$), constructs $\\mathbf{A}(k)$ and $\\mathbf{A}_{\\mathrm{CFIE}}(k)$, computes $\\kappa_2(\\mathbf{A})$ and $\\kappa_2(\\mathbf{A}_{\\mathrm{CFIE}})$, and computes sensitivities $s(\\mathbf{A},\\mathbf{b})$ and $s(\\mathbf{A}_{\\mathrm{CFIE}},\\mathbf{b})$. If the smallest singular value is numerically zero, report the condition number as $+\\infty$ and, if the linear solve fails, report the sensitivity as $+\\infty$. The angle unit does not apply here. All results must be computed as unitless floats.\n\nTest suite:\n- Case 1 (happy path): $k=8.0\\,\\mathrm{rad/m}$.\n- Case 2 (near-resonance): $k=9.9\\,\\mathrm{rad/m}$.\n- Case 3 (very close to resonance): $k=9.999\\,\\mathrm{rad/m}$.\n- Case 4 (high frequency): $k=40.0\\,\\mathrm{rad/m}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list of four floats in the order\n$[\\kappa_2(\\mathbf{A}),\\ \\kappa_2(\\mathbf{A}_{\\mathrm{CFIE}}),\\ s(\\mathbf{A},\\mathbf{b}),\\ s(\\mathbf{A}_{\\mathrm{CFIE}},\\mathbf{b})]$.\nFor example: \"[[cond_nc1,cond_c1,sens_nc1,sens_c1],[cond_nc2,cond_c2,sens_nc2,sens_c2],...]\".",
            "solution": "The user-provided problem is assessed to be **valid**. It is a self-contained, scientifically grounded, and well-posed problem in the field of computational acoustics. It asks for the numerical analysis of a simplified but representative hybrid FEM/BEM system, a standard topic in advanced computational methods. All required data, matrices, constants, and definitions are provided, and there are no internal contradictions, ambiguities, or violations of scientific principles.\n\nThe task is to analyze the condition number and solution sensitivity of a coupled FEM/BEM acoustic system near a resonance, both with and without Combined Field Integral Equation (CFIE) stabilization. The analysis is performed for a set of specified wavenumbers $k$.\n\nThe methodology involves constructing the system matrices, calculating their condition numbers based on singular values, and computing the solution sensitivity to a small perturbation in the load vector.\n\n**1. System Definition and Matrix Construction**\n\nFirst, we define the constants and base matrices as specified in the problem statement.\n\nThe problem is set on a one-dimensional domain of length $L=1\\,\\mathrm{m}$ with $n=3$ interior degrees of freedom. The grid spacing is $h = L/(n+1) = 1/(3+1) = 0.25\\,\\mathrm{m}$. The stiffness scaling factor is $s_K=10$.\n\nThe stiffness matrix $\\mathbf{K}\\in\\mathbb{R}^{3\\times 3}$ is given by:\n$$\n\\mathbf{K} = s_K\\frac{1}{h}\\begin{bmatrix}1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1\\end{bmatrix} = 10 \\cdot \\frac{1}{0.25} \\begin{bmatrix}1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1\\end{bmatrix} = \\begin{bmatrix}40 & -40 & 0 \\\\ -40 & 80 & -40 \\\\ 0 & -40 & 40\\end{bmatrix}\n$$\n\nThe mass matrix $\\mathbf{M}\\in\\mathbb{R}^{3\\times 3}$ is given by:\n$$\n\\mathbf{M} = \\frac{h}{6}\\begin{bmatrix}2 & 1 & 0 \\\\ 1 & 4 & 1 \\\\ 0 & 1 & 2\\end{bmatrix} = \\frac{0.25}{6} \\begin{bmatrix}2 & 1 & 0 \\\\ 1 & 4 & 1 \\\\ 0 & 1 & 2\\end{bmatrix} = \\frac{1}{24}\\begin{bmatrix}2 & 1 & 0 \\\\ 1 & 4 & 1 \\\\ 0 & 1 & 2\\end{bmatrix}\n$$\n\nThe coupling operator $\\mathbf{C}\\in\\mathbb{R}^{m\\times n}$ is defined with $\\gamma=1$ and $m=n=3$, so it is the $3 \\times 3$ identity matrix:\n$$\n\\mathbf{C} = \\gamma\\,\\mathbf{I}_{3\\times 3} = \\mathbf{I}\n$$\n\nThe exterior BEM operator $\\mathbf{T}(k)\\in\\mathbb{R}^{3\\times 3}$ is modeled as a real, diagonal matrix dependent on the wavenumber $k$:\n$$\n\\mathbf{T}(k) = \\mathbf{R} - k^2\\mathbf{S}\n$$\nwith $\\mathbf{R}=\\mathrm{diag}(2.0, 2.5, 3.0)$ and $\\mathbf{S}=\\mathrm{diag}(0.02, 0.025, 0.03)$. This construction creates a resonance at $k=10\\,\\mathrm{rad/m}$, where $\\mathbf{T}(10)=\\mathbf{0}$.\n\nFor a given $k$, the interior FEM block is $\\mathbf{H}(k) = \\mathbf{K} - k^2\\mathbf{M}$. The full system matrices, without and with CFIE stabilization, are assembled as $6 \\times 6$ block matrices.\n\nThe non-stabilized system matrix $\\mathbf{A}(k)$ is:\n$$\n\\mathbf{A}(k) = \\begin{bmatrix} \\mathbf{K}-k^2\\mathbf{M} & \\mathbf{C}^{\\top} \\\\ \\mathbf{C} & -\\mathbf{T}(k) \\end{bmatrix}\n$$\n\nFor the CFIE stabilized system, the stabilization parameter is $\\eta(k)=k$. The stabilized exterior operator is $\\mathbf{T}_{\\mathrm{CFIE}}(k) = \\mathbf{T}(k) + \\mathrm{i}\\,k\\mathbf{I}$. The resulting system matrix $\\mathbf{A}_{\\mathrm{CFIE}}(k)$ is complex-valued:\n$$\n\\mathbf{A}_{\\mathrm{CFIE}}(k) = \\begin{bmatrix} \\mathbf{K}-k^2\\mathbf{M} & \\mathbf{C}^{\\top} \\\\ \\mathbf{C} & -(\\mathbf{T}(k)+\\mathrm{i}\\,k\\mathbf{I}) \\end{bmatrix}\n$$\nThe imaginary term $\\mathrm{i}\\,k\\mathbf{I}$ prevents the lower-right block from becoming singular at the resonance of $\\mathbf{T}(k)$, thus stabilizing the entire system.\n\n**2. Load and Perturbation Vectors**\n\nThe right-hand-side load vector $\\mathbf{b}\\in\\mathbb{R}^{6}$ is formed by concatenating the interior and boundary loads $\\mathbf{f}$ and $\\mathbf{g}$:\n$$\n\\mathbf{f} = \\begin{bmatrix} 1 \\\\ 0.5 \\\\ -0.5 \\end{bmatrix}, \\quad \\mathbf{g} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix} \\quad \\implies \\quad \\mathbf{b} = \\begin{bmatrix} 1 \\\\ 0.5 \\\\ -0.5 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\nThe $2$-norm of $\\mathbf{b}$ is $\\|\\mathbf{b}\\|_2 = \\sqrt{1^2 + 0.5^2 + (-0.5)^2} = \\sqrt{1.5}$.\n\nThe perturbation vector $\\Delta\\mathbf{b}\\in\\mathbb{R}^{6}$ is defined as:\n$$\n\\Delta\\mathbf{b} = \\varepsilon\\,\\frac{\\mathbf{v}}{\\|\\mathbf{v}\\|_2}, \\quad \\text{where} \\quad \\varepsilon = 10^{-6}\\|\\mathbf{b}\\|_2 \\quad \\text{and} \\quad \\mathbf{v} = \\begin{bmatrix} 1, -1, 0.5, 0.2, -0.3, 0.1 \\end{bmatrix}^{\\top}\n$$\nThe norm of $\\mathbf{v}$ is $\\|\\mathbf{v}\\|_2 = \\sqrt{1^2 + (-1)^2 + 0.5^2 + 0.2^2 + (-0.3)^2 + 0.1^2} = \\sqrt{2.39}$. The norm of the perturbation is thus fixed at $\\|\\Delta\\mathbf{b}\\|_2 = \\varepsilon = 10^{-6}\\sqrt{1.5}$.\n\n**3. Computation of Metrics**\n\nFor each system matrix ($\\mathbf{A}$ and $\\mathbf{A}_{\\mathrm{CFIE}}$) and for each test case wavenumber $k$, we compute two metrics.\n\n**Condition Number:**\nThe condition number in the $2$-norm is defined as the ratio of the largest to the smallest singular value:\n$$\n\\kappa_2(\\mathbf{X}) = \\frac{\\sigma_{\\max}(\\mathbf{X})}{\\sigma_{\\min}(\\mathbf{X})}\n$$\nThe singular values are computed using a standard Singular Value Decomposition (SVD) algorithm. If $\\sigma_{\\min}(\\mathbf{X})$ is numerically indistinguishable from zero (i.e., below machine precision tolerance), the matrix is singular, and its condition number is reported as infinity ($\\infty$).\n\n**Solution Sensitivity:**\nThe solution sensitivity $s$ is defined by the amplification of the solution's change relative to the perturbation in the load vector:\n$$\ns(\\mathbf{X}, \\mathbf{b}) = \\frac{\\|\\mathbf{x}' - \\mathbf{x}\\|_2}{\\|\\Delta\\mathbf{b}\\|_2}\n$$\nwhere $\\mathbf{X}\\mathbf{x} = \\mathbf{b}$ and $\\mathbf{X}\\mathbf{x}' = \\mathbf{b} + \\Delta\\mathbf{b}$. By linearity, $\\mathbf{X}(\\mathbf{x}' - \\mathbf{x}) = \\Delta\\mathbf{b}$. Letting $\\Delta\\mathbf{x} = \\mathbf{x}' - \\mathbf{x}$, we can compute the change in the solution $\\Delta\\mathbf{x}$ by solving the linear system:\n$$\n\\mathbf{X}\\Delta\\mathbf{x} = \\Delta\\mathbf{b}\n$$\nThe sensitivity is then calculated as:\n$$\ns = \\frac{\\|\\Delta\\mathbf{x}\\|_2}{\\|\\Delta\\mathbf{b}\\|_2}\n$$\nThis approach avoids potential floating-point cancellation errors from subtracting $\\mathbf{x}$ from $\\mathbf{x}'$. If the matrix $\\mathbf{X}$ is singular, this linear system has no unique solution, the solver will fail, and the sensitivity is reported as infinity ($\\infty$).\n\nThe implementation will loop through the specified test cases for $k$, construct the matrices and vectors, and perform these calculations using numerical libraries. The results for the non-CFIE and CFIE systems are collected and formatted as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Analyzes a hybrid FEM/BEM system near resonance.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [8.0, 9.9, 9.999, 40.0]\n\n    results = []\n    for k in test_cases:\n        case_result = analyze_system(k)\n        # Format each sub-list as a string \"[v1,v2,v3,v4]\"\n        results.append(f\"[{','.join(map(str, case_result))}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef analyze_system(k):\n    \"\"\"\n    Constructs matrices and computes metrics for a given wavenumber k.\n    \"\"\"\n    # 1. Define Constants and Base Matrices\n    L = 1.0\n    n = 3\n    h = L / (n + 1)\n    s_K = 10.0\n    gamma = 1.0\n\n    K = (s_K / h) * np.array([[1.0, -1.0, 0.0],\n                              [-1.0, 2.0, -1.0],\n                              [0.0, -1.0, 1.0]])\n\n    M = (h / 6.0) * np.array([[2.0, 1.0, 0.0],\n                               [1.0, 4.0, 1.0],\n                               [0.0, 1.0, 2.0]])\n\n    C = gamma * np.eye(n)\n\n    R = np.diag([2.0, 2.5, 3.0])\n    S = np.diag([0.02, 0.025, 0.03])\n\n    # 2. Construct Wavenumber-Dependent Matrices\n    k2 = k * k\n    H_k = K - k2 * M\n    T_k = R - k2 * S\n\n    # 3. Assemble the Full System Matrices\n    # Non-CFIE System (real)\n    A = np.block([\n        [H_k, C.T],\n        [C, -T_k]\n    ])\n\n    # CFIE System (complex)\n    eta_k = k\n    T_CFIE_k = T_k + 1j * eta_k * np.eye(n)\n    A_CFIE = np.block([\n        [H_k, C.T],\n        [C, -T_CFIE_k]\n    ]).astype(np.complex128)\n\n    # 4. Define Load and Perturbation Vectors\n    f = np.array([1.0, 0.5, -0.5])\n    g = np.zeros(n)\n    b = np.concatenate((f, g))\n\n    v = np.array([1.0, -1.0, 0.5, 0.2, -0.3, 0.1])\n    epsilon = 1e-6 * linalg.norm(b)\n    delta_b = epsilon * v / linalg.norm(v)\n    norm_delta_b = linalg.norm(delta_b) # This is equal to epsilon\n\n    # 5. Compute Metrics for both systems\n    cond_A, sens_A = compute_metrics(A, delta_b, norm_delta_b)\n    cond_A_CFIE, sens_A_CFIE = compute_metrics(A_CFIE, delta_b, norm_delta_b)\n\n    return [cond_A, cond_A_CFIE, sens_A, sens_A_CFIE]\n\ndef compute_metrics(matrix, delta_b, norm_delta_b):\n    \"\"\"\n    Computes condition number and sensitivity for a given matrix and perturbation.\n    \"\"\"\n    # Use a tolerance for checking singularity, relative to the max singular value.\n    # A very small number like 1e-15 might be too absolute.\n    # Standard practice is to use a tolerance relative to machine epsilon and matrix norm.\n    # Here, a simple absolute tolerance on sigma_min is sufficient as per\n    # the problem's spirit.\n    sig_min_tol = 1e-15\n\n    # Condition Number\n    try:\n        # compute_uv=False is more efficient as we only need singular values\n        singular_values = linalg.svd(matrix, compute_uv=False)\n        sigma_min = singular_values[-1]\n        sigma_max = singular_values[0]\n\n        if sigma_min < sig_min_tol:\n            cond = float('inf')\n        else:\n            cond = sigma_max / sigma_min\n    except linalg.LinAlgError:\n        cond = float('inf')\n\n    # Sensitivity\n    try:\n        if cond == float('inf'):\n            # If matrix is singular, solve will fail.\n            raise linalg.LinAlgError(\"Singular matrix\")\n            \n        # More stable to solve for delta_x directly\n        delta_x = linalg.solve(matrix, delta_b)\n        norm_delta_x = linalg.norm(delta_x)\n        sens = norm_delta_x / norm_delta_b\n\n    except linalg.LinAlgError:\n        sens = float('inf')\n\n    return cond, sens\n\nsolve()\n```"
        }
    ]
}