{
    "hands_on_practices": [
        {
            "introduction": "混合方法的核心思想是在不同频率范围应用最合适的建模技术。本练习将引导你从第一性原理出发，为声腔和板结构推导模态密度，这是区分低频“确定性”区域和高频“统计”区域的关键物理量。通过这个实践，你将深刻理解统计能量分析（SEA）的适用性判据，为构建可靠的有限元-统计能量分析（FEM-SEA）混合模型奠定理论基础。",
            "id": "4126648",
            "problem": "考虑一个振动声学系统，该系统由一块封闭刚性壁矩形声腔的薄、均匀、各向同性弹性板组成。该板采用 Kirchhoff–Love 理论建模，声腔采用刚性边界条件下的标量声波方程建模。设声腔的尺寸为 $L_{x}$、$L_{y}$ 和 $L_{z}$，因此其体积为 $V = L_{x} L_{y} L_{z}$。设板的尺寸为 $L_{x}$ 和 $L_{y}$，因此其面积为 $S = L_{x} L_{y}$，厚度为 $h$，质量密度为 $\\rho$，杨氏模量为 $E$，泊松比为 $\\nu$。声介质的声速为 $c$。假设在高频渐近条件下，通过相空间体积进行模态计数的方法适用。\n\n从各子系统相应的控制方程出发，且不援引任何预先指定的计数公式，推导以下系统的模态密度 $n(\\omega)$ 关于角频率 $\\omega$ 的渐近表达式：\n- 矩形声腔，以及\n- 薄弹性板。\n\n将声腔的模态密度 $n_{\\mathrm{cav}}(\\omega)$ 表示为 $V$ 和 $c$ 的函数，并将板的模态密度 $n_{\\mathrm{plate}}(\\omega)$ 表示为 $S$、$h$、$\\rho$ 和抗弯刚度 $D$ 的函数。然后将 $D$ 表示为 $E$、$h$ 和 $\\nu$ 的函数。以闭合形式给出最终的模态密度表达式。\n\n最后，使用统计能量分析 (SEA) 的角频率形式的模态重叠准则 $m(\\omega) = \\eta \\, \\omega \\, n(\\omega)$，其中 $\\eta$ 是子系统的无量纲损耗因子，讨论声腔和板的 SEA 假设预计有效的频率范围。简要解释这些频率范围如何为有限元法 (FEM) 与统计能量分析 (SEA) 之间，以及有限元法 (FEM) 或边界元法 (BEM) 与统计能量分析 (SEA) 之间的混合耦合策略提供信息。\n\n你的最终答案必须是两个推导出的模态密度表达式，形式为一个单一的闭合形式解析行向量。最终答案中不要包含单位。",
            "solution": "目标是为声腔和薄板推导模态密度 $n(\\omega)$ 的高频渐近表达式。模态密度 $n(\\omega)$ 定义为 $n(\\omega) = \\frac{\\mathrm{d}N(\\omega)}{\\mathrm{d}\\omega}$，其中 $N(\\omega)$ 是固有角频率小于或等于 $\\omega$ 的模态数量。我们使用通过相空间体积进行渐近模态计数的方法，这是一种经过充分检验的方法，其基础是椭圆算子的谱特性，并被称为针对大波数的 Weyl 型估计。\n\n对于声腔，在刚性边界条件下，时谐声压 $p(\\mathbf{x}, t) = P(\\mathbf{x}) \\exp(\\mathrm{i} \\omega t)$ 的控制方程为\n$$\n\\nabla^{2} P + k^{2} P = 0,\n$$\n其色散关系为\n$$\n\\omega = c k,\n$$\n其中 $k = |\\mathbf{k}|$ 是声波数，$c$ 是声速。特征值对应于由声腔尺寸决定的、由整数三元组 $(n_{x}, n_{y}, n_{z})$ 索引的离散波数。在高频极限下，波数满足 $|\\mathbf{k}| \\leq k$ 的模态数量可以通过计算 $\\mathbf{k}$ 空间中半径为 $k$ 的球体正八分圆内的整数格点数来获得，并用其体积来近似。$\\mathbf{k}$ 空间中的基本单元体积为 $(\\pi/L_{x})(\\pi/L_{y})(\\pi/L_{z}) = \\pi^{3}/V$。球体正八分圆的体积为 $\\frac{1}{8} \\cdot \\frac{4}{3} \\pi k^{3} = \\frac{1}{6} \\pi k^{3}$。因此，主阶计数函数为\n$$\nN_{\\mathrm{cav}}(k) \\approx \\frac{\\frac{1}{6} \\pi k^{3}}{\\pi^{3}/V} = \\frac{V k^{3}}{6 \\pi^{2}}.\n$$\n使用色散关系 $\\omega = c k$，我们得到\n$$\nN_{\\mathrm{cav}}(\\omega) \\approx \\frac{V}{6 \\pi^{2}} \\left( \\frac{\\omega}{c} \\right)^{3} = \\frac{V \\, \\omega^{3}}{6 \\pi^{2} c^{3}}.\n$$\n对 $\\omega$ 求导，得到声腔的模态密度，\n$$\nn_{\\mathrm{cav}}(\\omega) = \\frac{\\mathrm{d}N_{\\mathrm{cav}}}{\\mathrm{d}\\omega} = \\frac{V}{2 \\pi^{2}} \\frac{\\omega^{2}}{c^{3}}.\n$$\n\n对于薄弹性板，其时谐横向位移 $w(\\mathbf{x}, t) = W(\\mathbf{x}) \\exp(\\mathrm{i} \\omega t)$ 的 Kirchhoff–Love 板方程为\n$$\nD \\nabla^{4} W - \\rho h \\, \\omega^{2} W = 0,\n$$\n其中 $D$ 是抗弯刚度。通过将双调和特征问题写为\n$$\n\\nabla^{4} W - k^{4} W = 0,\n$$\n引入弯曲波数 $k$，通过平衡 $D k^{4} W = \\rho h \\, \\omega^{2} W$ 可得出色散关系，即\n$$\n\\omega = \\sqrt{\\frac{D}{\\rho h}} \\, k^{2}.\n$$\n定义参数\n$$\n\\beta = \\sqrt{\\frac{D}{\\rho h}},\n$$\n使得色散关系为 $\\omega = \\beta k^{2}$。对于二维域，波数满足 $|\\mathbf{k}| \\leq k$ 的高频计数函数由 $\\mathbf{k}$ 空间中四分之一圆的面积除以 $\\mathbf{k}$ 空间单元面积给出。$\\mathbf{k}$ 空间单元面积为 $(\\pi/L_{x})(\\pi/L_{y}) = \\pi^{2}/S$，圆的正象限面积为 $\\frac{1}{4} \\cdot \\pi k^{2}$。因此，\n$$\nN_{\\mathrm{plate}}(k) \\approx \\frac{\\frac{1}{4} \\pi k^{2}}{\\pi^{2}/S} = \\frac{S k^{2}}{4 \\pi}.\n$$\n使用 $\\omega = \\beta k^{2}$，我们有 $k^{2} = \\omega / \\beta$，因此\n$$\nN_{\\mathrm{plate}}(\\omega) \\approx \\frac{S}{4 \\pi} \\frac{\\omega}{\\beta}.\n$$\n对 $\\omega$ 求导，得到板的模态密度，\n$$\nn_{\\mathrm{plate}}(\\omega) = \\frac{\\mathrm{d}N_{\\mathrm{plate}}}{\\mathrm{d}\\omega} = \\frac{S}{4 \\pi} \\frac{1}{\\beta} = \\frac{S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}}.\n$$\n抗弯刚度为\n$$\nD = \\frac{E h^{3}}{12 \\left( 1 - \\nu^{2} \\right)}.\n$$\n如果需要，代入 $D$ 可得\n$$\nn_{\\mathrm{plate}}(\\omega) = \\frac{S}{4 \\pi} \\sqrt{ \\frac{\\rho h}{\\frac{E h^{3}}{12 (1 - \\nu^{2})}} } = \\frac{S}{4 \\pi} \\sqrt{ \\frac{12 (1 - \\nu^{2}) \\, \\rho}{E h^{2}} }.\n$$\n\n我们现在通过模态重叠准则来讨论统计能量分析 (SEA) 的有效性。角频率形式的模态重叠为\n$$\nm(\\omega) = \\eta \\, \\omega \\, n(\\omega),\n$$\n其中 $\\eta$ 是代表阻尼的无量纲损耗因子。当 $m(\\omega)$ 足够大时，SEA 假设通常有效，通常 $m(\\omega) \\gtrsim 3$ 是强模态重叠的一个实用阈值。\n\n对于声腔，\n$$\nm_{\\mathrm{cav}}(\\omega) = \\eta \\, \\omega \\, \\frac{V}{2 \\pi^{2}} \\frac{\\omega^{2}}{c^{3}} = \\frac{\\eta V}{2 \\pi^{2} c^{3}} \\, \\omega^{3},\n$$\n该值随 $\\omega^{3}$ 增长。SEA 有效性的阈值角频率可以通过求解 $m_{\\mathrm{cav}}(\\omega) = 3$ 来估计，\n$$\n\\omega_{\\mathrm{SEA,cav}} \\approx \\left( \\frac{6 \\pi^{2} c^{3}}{\\eta V} \\right)^{1/3}.\n$$\n这表明，较大的声腔体积 $V$ 和较小的阻尼 $\\eta$ 会将 SEA 的有效性推向更高频率，而较小的体积和较高的阻尼则会降低 SEA 的适用频率范围。\n\n对于板，\n$$\nm_{\\mathrm{plate}}(\\omega) = \\eta \\, \\omega \\, \\frac{S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}} = \\frac{\\eta S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}} \\, \\omega,\n$$\n该值随 $\\omega$ 线性增长。阈值角频率由 $m_{\\mathrm{plate}}(\\omega) = 3$ 得出，\n$$\n\\omega_{\\mathrm{SEA,plate}} \\approx \\frac{12 \\pi}{\\eta S} \\sqrt{ \\frac{D}{\\rho h} } = \\frac{12 \\pi \\beta}{\\eta S }.\n$$\n这表明，较大的板面积 $S$ 和较小的阻尼 $\\eta$ 会将 SEA 的有效性推向更高频率，而较小的面积或较高的阻尼则会降低 SEA 的起始频率。\n\n有限元法 (FEM) 与统计能量分析 (SEA) 之间，以及有限元法 (FEM) 或边界元法 (BEM) 与统计能量分析 (SEA) 之间混合耦合的启示，可以从这些趋势中得出。在实践中，人们会对子系统进行详细的确定性建模（板用 FEM，声腔用 FEM 或 BEM），直到一个交叉频率，在该频率以上子系统的 $m(\\omega)$ 变得足够大，然后采用 SEA。由于 $m_{\\mathrm{cav}}(\\omega)$ 随频率的增长速度比 $m_{\\mathrm{plate}}(\\omega)$ 快，声腔进入 SEA 状态的频率可能与板不同；因此，混合 FEM/SEA 耦合可以使用特定于子系统的交叉频率。推导出的模态密度为 SEA 提供了必要的输入，用于计算高频范围内的耦合损耗因子和进行能量流预测，而 FEM/BEM 则用于捕捉低频模态细节和边界条件敏感性。\n\n因此，最终的模态密度表达式为\n$$\nn_{\\mathrm{cav}}(\\omega) = \\frac{V \\, \\omega^{2}}{2 \\pi^{2} c^{3}}, \\qquad n_{\\mathrm{plate}}(\\omega) = \\frac{S}{4 \\pi} \\sqrt{\\frac{\\rho h}{D}}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{V\\,\\omega^{2}}{2\\pi^{2}c^{3}}  \\dfrac{S}{4\\pi}\\sqrt{\\dfrac{\\rho h}{D}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在确定性方法适用的频率范围内，边界元法（BEM）是处理声辐射和散射问题的有力工具，但其标准形式存在“伪频率”问题，会在特定频率下导致数值解崩溃。本练习通过一个经典的球体散射案例，让你动手计算并观察标准BEM算子在伪频率处的奇异性，并验证组合场积分方程（CFIE）如何有效克服这一缺陷。这项实践对于理解和实现稳健的有限元-边界元（FEM-BEM）耦合至关重要。",
            "id": "4126605",
            "problem": "考虑一个半径为 $a$ 的理想刚性球体浸没在声速为 $c$ 的均匀流体中的外部声散射问题。总声压场 $p(\\mathbf{x})$ 在无界外部区域中满足亥姆霍兹方程 $\\nabla^2 p + k^2 p = 0$，其中 $k = 2\\pi f / c$ 是与激励频率 $f$（单位为赫兹，Hz）相关的波数。刚性边界条件是球体表面 $\\Gamma$ 上的诺伊曼条件 $\\partial p / \\partial n = 0$，其中 $\\partial / \\partial n$ 表示沿外法线方向的微分。在边界元法 (BEM) 的框架下，散射场的一种常见表示方法是通过带有未知密度的单层势，在球体表面 $\\Gamma$ 上取法向导数后，会得到一个作用于该密度的边界积分算子（通常称为超奇异算子）。在球体上，球谐函数 $Y_{\\ell m}$ 可以对角化这些边界积分算子。记 $\\mathcal{T}$ 为限制在边界上的归一化诺伊曼（超奇异）算子，$\\mathcal{S}$ 为限制在边界上的归一化单层算子，两者都经过归一化，使得它们关于 $Y_{\\ell m}$ 的特征值仅依赖于阶数 $\\ell$，并分别由 $\\lambda^{(\\mathcal{T})}_\\ell(ka) = j_\\ell'(ka)$ 和 $\\lambda^{(\\mathcal{S})}_\\ell(ka) = j_\\ell(ka)$ 给出。其中 $j_\\ell$ 是 $\\ell$ 阶第一类球贝塞尔函数，$j_\\ell'$ 是它对其自变量的导数。组合场积分方程 (CFIE) 通过在诺伊曼算子上增加单层算子的加权贡献来构造 $\\mathcal{C}_\\eta = \\mathcal{T} + i \\eta \\mathcal{S}$，其在 $Y_{\\ell m}$ 上的特征值变为 $\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) = j_\\ell'(ka) + i \\eta \\, j_\\ell(ka)$，其中耦合参数 $\\eta > 0$ 为正实数。\n\n您的任务是，对于给定的一组频率和参数，计算归一化诺伊曼 BEM 算子 $\\mathcal{T}$ 的谱，即列表 $\\left\\{\\lambda^{(\\mathcal{T})}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$，以及 CFIE 算子 $\\mathcal{C}_\\eta$ 的谱，即列表 $\\left\\{\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$，然后判断对于指定频率，标准的诺伊曼公式是否失效（算子数值奇异），而 CFIE 公式是否保持唯一性。如果 $\\min_{\\ell \\in \\{0,\\dots,L_{\\max}\\}} \\left| \\lambda^{(\\mathcal{T})}_\\ell(ka) \\right| \\leq \\varepsilon$，则宣告标准诺伊曼公式失效；如果 $\\min_{\\ell \\in \\{0,\\dots,L_{\\max}\\}} \\left| \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) \\right| > \\varepsilon$，则宣告 CFIE 具有唯一性。其中 $\\varepsilon$ 是一个指定的容差。所有特征值都是无量纲的；$a$ 必须以米 (m) 为单位提供，$c$ 以米/秒 (m/s) 为单位提供，$f$ 以赫兹 (Hz) 为单位提供。\n\n使用以下测试套件。对于每个测试用例，使用给定的 $(a,c,L_{\\max},\\eta,\\varepsilon)$ 和指定的 $f$ 规则来确定 $k = 2\\pi f / c$ 和 $z = k a$。当测试用例通过根条件定义 $f$ 时，程序必须通过数值方法找到 $j_\\ell'(z) = 0$ 的最小正根 $z_{\\ell,1} > 0$，并设置 $f = z_{\\ell,1} c / (2\\pi a)$ 来计算 $f$。测试套件如下：\n\n- 测试用例1（远离共振的一般情况）：$a = 0.5$ m，$c = 343$ m/s，$L_{\\max} = 6$，$\\eta = 1.0$，$\\varepsilon = 10^{-8}$，并选择 $f$ 使 $k a = 2.0$。\n- 测试用例2（$\\ell = 0$ 处的非正则频率）：$a, c, L_{\\max}, \\eta, \\varepsilon$ 与上述相同，并选择 $f$ 使 $k a$ 等于 $j_0'(z) = 0$ 的最小正根。\n- 测试用例3（$\\ell = 1$ 处的非正则频率）：$a, c, L_{\\max}, \\eta, \\varepsilon$ 与上述相同，并选择 $f$ 使 $k a$ 等于 $j_1'(z) = 0$ 的最小正根。\n- 测试用例4（低频边界情况）：$a, c, L_{\\max}, \\eta, \\varepsilon$ 与上述相同，并选择 $f = 1.0$ Hz。\n- 测试用例5（高频情况）：$a, c, L_{\\max}, \\eta, \\varepsilon$ 与上述相同，并选择 $f$ 使 $k a = 20.0$。\n\n对于每个测试用例，计算谱 $\\left\\{\\lambda^{(\\mathcal{T})}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$ 和 $\\left\\{\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka)\\right\\}_{\\ell=0}^{L_{\\max}}$，然后计算两个标量 $\\min_{\\ell} \\left| \\lambda^{(\\mathcal{T})}_\\ell(ka) \\right|$ 和 $\\min_{\\ell} \\left| \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) \\right|$，最后计算一个布尔标志，指示标准诺伊曼公式是否失效而 CFIE 保持唯一性，即 $\\left(\\min_{\\ell} \\left| \\lambda^{(\\mathcal{T})}_\\ell(ka) \\right| \\leq \\varepsilon\\right) \\land \\left(\\min_{\\ell} \\left| \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) \\right| > \\varepsilon\\right)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个形式为 $[\\min\\_T, \\min\\_{CFIE}, \\mathrm{flag}]$ 的列表，其中 $\\min\\_T$ 和 $\\min\\_{CFIE}$ 是浮点数（无量纲），$\\mathrm{flag}$ 是一个布尔值。例如，整个输出将看起来像 $[[\\dots],[\\dots],[\\dots],[\\dots],[\\dots]]$。",
            "solution": "用户提供了一个有效的问题陈述，该陈述基于计算声学和边界元法 (BEM) 的原理。该问题是自洽的、科学上合理的且适定的。我将提供一个完整的解决方案。\n\n该问题要求分析与刚性球体声散射相关的边界积分算子的特征值。球体外部区域 $\\Omega_e$ 中的总声压场 $p(\\mathbf{x})$ 受亥姆霍兹方程的支配：\n$$ \\nabla^2 p + k^2 p = 0 \\quad \\text{in } \\Omega_e $$\n其中 $k = 2\\pi f / c$ 是波数，$f$ 是频率，$c$ 是声速。“理想刚性”条件转化为球面 $\\Gamma$ 上的齐次诺伊曼边界条件：\n$$ \\frac{\\partial p}{\\partial n} = 0 \\quad \\text{on } \\Gamma $$\n在 BEM 中，该问题被重新表述为边界积分方程 (BIE)。对于外部诺伊曼问题，标准方法会得到一个涉及超奇异算子的 BIE，我们将其表示为 $\\mathcal{T}$。已知此公式会在一组离散的“非正则”或“伪”频率上失效。这些频率对应于相关的*内部*问题的本征频率。对于诺伊曼问题，这些频率是指内部诺伊曼问题（即球体内部的亥姆霍兹方程，在边界上具有齐次诺伊曼条件）存在非平凡解的频率。\n\n在半径为 $a$ 的球体上，边界积分算子可由球谐函数 $Y_{\\ell m}$ 对角化。问题陈述中给出，归一化的超奇异算子 $\\mathcal{T}$ 和归一化的单层算子 $\\mathcal{S}$ 的特征值为：\n$$ \\lambda^{(\\mathcal{T})}_\\ell(ka) = j_\\ell'(ka) $$\n$$ \\lambda^{(\\mathcal{S})}_\\ell(ka) = j_\\ell(ka) $$\n其中 $j_\\ell$ 是 $\\ell$ 阶第一类球贝塞尔函数，$j_\\ell'$ 是它对其自变量的导数。\n\n当算子 $\\mathcal{T}$ 变得奇异时，标准的 BIE 公式就会失效，这发生在它的任何一个特征值为零时。因此，外部诺伊曼问题的非正则频率是使得对于某个整数 $\\ell \\ge 0$ 有 $\\lambda^{(\\mathcal{T})}_\\ell(ka) = j_\\ell'(ka) = 0$ 成立的 $k$ 值。在这些频率下，BEM 矩阵是病态或奇异的，无法保证解的唯一性。\n\n为了解决这个问题，通常采用组合场积分方程 (CFIE)。它通过取超奇异算子 $\\mathcal{T}$ 和单层算子 $\\mathcal{S}$ 的线性组合来构造一个新的算子。给出的具体形式是：\n$$ \\mathcal{C}_\\eta = \\mathcal{T} + i \\eta \\mathcal{S} $$\n其中 $\\eta > 0$ 是一个实数耦合参数。这个新算子的特征值为：\n$$ \\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) = j_\\ell'(ka) + i \\eta \\, j_\\ell(ka) $$\n只要 $\\eta > 0$，CFIE 就能保证对所有实数频率都有唯一解。这是因为对于球体而言，内部诺伊曼问题的非正则频率（其中 $j_\\ell'(ka) = 0$）和内部狄利克雷问题的非正则频率（其中 $j_\\ell(ka) = 0$）是不相交的。因此，如果对于某个 $\\ell$ 有 $j_\\ell'(ka) = 0$，那么 $j_\\ell(ka) \\neq 0$。在这种情况下，CFIE 特征值变为 $\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(ka) = 0 + i \\eta \\, j_\\ell(ka) = i \\eta \\, j_\\ell(ka)$，这是非零的。因此，算子 $\\mathcal{C}_\\eta$ 保持非奇异性。\n\n任务是为一组测试用例验证这种行为。对于每个用例，我们必须：\n1.  确定无量纲频率参数 $z = ka$。对于某些用例，这涉及到数值求解 $j'_\\ell(z)=0$ 的最小正根。\n2.  计算 $\\mathcal{T}$ 和 $\\mathcal{C}_\\eta$ 在 $\\ell$ 从 $0$ 到 $L_{\\max}$ 范围内的谱。$\\mathcal{T}$ 的谱是集合 $\\{\\lambda^{(\\mathcal{T})}_\\ell(z)\\}_{\\ell=0}^{L_{\\max}}$，$\\mathcal{C}_\\eta$ 的谱是集合 $\\{\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(z)\\}_{\\ell=0}^{L_{\\max}}$。\n3.  找到每个算子特征值的最小模：$\\min_{\\ell} |\\lambda^{(\\mathcal{T})}_\\ell(z)|$ 和 $\\min_{\\ell} |\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(z)|$。\n4.  应用条件：如果 $\\min_{\\ell} |\\lambda^{(\\mathcal{T})}_\\ell(z)| \\le \\varepsilon$，则诺伊曼公式失效；如果 $\\min_{\\ell} |\\lambda^{(\\mathcal{C}_\\eta)}_\\ell(z)| > \\varepsilon$，则 CFIE 是唯一的。如果第一个条件和第二个条件都满足，则设置一个布尔标志。\n\n我们将使用数值库来计算球贝塞尔函数 $j_\\ell(z)$ 及其导数 $j'_\\ell(z)$，并使用数值求根算法来确定相关测试用例中的 $z$。球贝塞尔函数的导数可以通过在 `scipy.special.spherical_jn` 中使用 `derivative=True` 参数获得，或者通过递推关系式如 $j'_\\ell(z) = j_{\\ell-1}(z) - \\frac{\\ell+1}{z}j_\\ell(z)$ 获得。请注意，对于 $\\ell=0$，$j'_0(z) = -j_1(z)$。\n\n每个测试用例的步骤如下：\n- **测试用例1：** $z = ka = 2.0$。对于低阶 $\\ell$，这不是一个非正则频率。\n- **测试用例2：** $z = ka$ 是 $j'_0(z)=0$ 的最小正根。由于 $j'_0(z) = -j_1(z)$，我们找到 $j_1(z)=0$ 的最小正根。这对应于 $\\ell=0$ 模式的非正则频率。\n- **测试用例3：** $z = ka$ 是 $j'_1(z)=0$ 的最小正根。这对应于 $\\ell=1$ 模式的非正则频率。\n- **测试用例4：** $f = 1.0$ Hz。计算 $z = ka = (2\\pi f/c)a = (2\\pi \\times 1.0 / 343) \\times 0.5$。这是一个非常低频的情况。\n- **测试用例5：** $z = ka = 20.0$。这是一个高频情况，并未特意选择为非正则频率。\n\n这些步骤将通过编程实现以生成最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import spherical_jn\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the stability of Neumann and CFIE BEM formulations for acoustic scattering\n    from a rigid sphere at various frequencies.\n    \"\"\"\n    \n    # Common parameters for all test cases as specified in the problem.\n    a = 0.5  # meters\n    c = 343.0  # m/s\n    L_max = 6\n    eta = 1.0\n    epsilon = 1e-8\n\n    # Define the test cases based on the problem statement.\n    # The 'type' key specifies how to determine ka (z).\n    test_cases = [\n        {'type': 'fixed_ka', 'value': 2.0},\n        {'type': 'root_j_prime', 'l': 0},\n        {'type': 'root_j_prime', 'l': 1},\n        {'type': 'fixed_f', 'value': 1.0},\n        {'type': 'fixed_ka', 'value': 20.0},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Step 1: Determine the non-dimensional wavenumber z = ka\n        z = 0.0\n        if case['type'] == 'fixed_ka':\n            z = case['value']\n        elif case['type'] == 'fixed_f':\n            f = case['value']\n            k = 2 * np.pi * f / c\n            z = k * a\n        elif case['type'] == 'root_j_prime':\n            l_val = case['l']\n            # The function whose root we want to find.\n            func_to_solve = lambda x: spherical_jn(l_val, x, derivative=True)\n            \n            # Find appropriate bracket for root finding.\n            # Roots of j_l'(z) are known to exist. We search in a reasonable interval.\n            if l_val == 0:\n                # j_0'(z) = -j_1(z). Smallest positive root of j_1(z) is ~4.49.\n                # Search bracket [3, 5] is safe.\n                z = brentq(func_to_solve, 3.0, 5.0)\n            elif l_val == 1:\n                # Smallest positive root of j_1'(z) is ~2.08.\n                # Search bracket [1, 3] is safe.\n                z = brentq(func_to_solve, 1.0, 3.0)\n            # Other orders are not required by the problem statement.\n\n        # Step 2: Compute spectra for T and C_eta\n        orders = np.arange(L_max + 1)\n        \n        # Eigenvalues for the Neumann operator T\n        lambda_T = spherical_jn(orders, z, derivative=True)\n        \n        # Eigenvalues for the single-layer operator S\n        lambda_S = spherical_jn(orders, z)\n        \n        # Eigenvalues for the CFIE operator C_eta\n        lambda_CFIE = lambda_T + 1j * eta * lambda_S\n\n        # Step 3: Compute minimum magnitudes\n        min_T = np.min(np.abs(lambda_T))\n        min_CFIE = np.min(np.abs(lambda_CFIE))\n\n        # Step 4: Determine the boolean flag\n        # True if Neumann fails AND CFIE is unique\n        is_failure_remedied = (min_T = epsilon) and (min_CFIE > epsilon)\n        \n        # Store results for this test case\n        results.append([min_T, min_CFIE, is_failure_remedied])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, e.g., [[res1], [res2], ...]\n    # str() on a list gives spaces, so they are removed.\n    formatted_results = [str(r).replace(\" \", \"\") for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "将有限元（FEM）和边界元（BEM）两个子系统耦合起来后，整个系统的数值稳定性成为新的挑战，尤其是在共振频率附近，耦合矩阵可能变得病态。本练习构建了一个简化的FEM-BEM耦合模型，要求你通过编程计算系统矩阵的条件数和解的敏感度，以量化分析系统在共振点附近的稳定性。通过对比使用和不使用CFIE稳定化的结果，你将直观地理解稳定化技术对于保证混合方法求解器精度的重要作用。",
            "id": "4126667",
            "problem": "考虑一个混合计算声学模型，该模型将内部亥姆霍兹问题的有限元方法（FEM）离散与外部辐射的边界元方法（BEM）表示耦合起来，并可选择使用组合场积分方程（CFIE）进行稳定。设声压在内部域中满足亥姆霍兹方程，波数为 $k$（单位为 $\\mathrm{rad/m}$）。空间离散后，内部 FEM 块产生一个形式为 $(\\mathbf{K}-k^2\\mathbf{M})\\mathbf{u}=\\mathbf{f}$ 的线性系统，其中 $\\mathbf{K}\\in\\mathbb{R}^{n\\times n}$ 是刚度矩阵，$\\mathbf{M}\\in\\mathbb{R}^{n\\times n}$ 是质量矩阵，$\\mathbf{u}\\in\\mathbb{R}^n$ 是节点压力向量。通过 BEM 与外部的边界耦合引入了一个边界变量 $\\boldsymbol{\\lambda}\\in\\mathbb{C}^m$ 和一个算子 $\\mathbf{T}(k)\\in\\mathbb{R}^{m\\times m}$，该算子代表了外部积分算子的一个近似。不带 CFIE 稳定的代数耦合系统可以由以下块矩阵表示：\n$$\n\\mathbf{A}(k)=\\begin{bmatrix}\n\\mathbf{K}-k^2\\mathbf{M}  \\mathbf{C}^{\\top} \\\\\n\\mathbf{C}  -\\mathbf{T}(k)\n\\end{bmatrix},\n$$\n而带 CFIE 稳定时，通过向外部算子添加一个复数位移得到：\n$$\n\\mathbf{A}_{\\mathrm{CFIE}}(k)=\\begin{bmatrix}\n\\mathbf{K}-k^2\\mathbf{M}  \\mathbf{C}^{\\top} \\\\\n\\mathbf{C}  -\\big(\\mathbf{T}(k)+\\mathrm{i}\\,\\eta(k)\\mathbf{I}\\big)\n\\end{bmatrix},\n$$\n其中 $\\mathbf{C}\\in\\mathbb{R}^{m\\times n}$ 是耦合算子，$\\eta(k)$ 是一个依赖于 $k$ 的实数稳定化参数。组合场积分方程（CFIE）是一种著名的方法，通过组合积分方程并添加复数位移来减轻非唯一性和近共振病态问题。\n\n您必须推导并实现一个程序，通过计算有和没有 CFIE 的线性系统的条件数和解的灵敏度，来分析该耦合系统在共振附近的行为。请使用以下基于基本定义和经过充分检验的事实的原则性构造：\n\n1.  亥姆霍兹内部算子在一个长度为 $L=1\\,\\mathrm{m}$、具有 $n=3$ 个内部自由度的一维域上进行离散。使用均匀间距 $h=L/(n+1)$ 的标准二阶离散，并将刚度按因子 $s_K=10$ 进行缩放，以区分内部共振和下面描述的外部共振。具体而言，\n   $$\n   \\mathbf{K}=s_K\\frac{1}{h}\\begin{bmatrix}1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1\\end{bmatrix},\\quad\n   \\mathbf{M}=\\frac{h}{6}\\begin{bmatrix}2  1  0 \\\\ 1  4  1 \\\\ 0  1  2\\end{bmatrix}.\n   $$\n2.  将耦合算子设为由 $\\gamma=1$ 缩放的单位矩阵，因此 $\\mathbf{C}=\\gamma\\,\\mathbf{I}_{m\\times n}$，其中 $m=n=3$。\n3.  将外部 BEM 算子建模为一个依赖于 $k$ 的实的、对角的矩阵，构造为在 $k=10\\,\\mathrm{rad/m}$ 附近有共振：\n   $$\n   \\mathbf{T}(k)=\\mathbf{R}-k^2\\mathbf{S},\\quad\n   \\mathbf{R}=\\mathrm{diag}(2.0,\\,2.5,\\,3.0),\\quad\n   \\mathbf{S}=\\mathrm{diag}(0.02,\\,0.025,\\,0.03).\n   $$\n   这种构造确保了 $\\mathbf{T}(k)$ 在 $k=10\\,\\mathrm{rad/m}$ 附近变得近乎奇异。\n4.  使用参数 $\\eta(k)=k$ 进行 CFIE 稳定，即通过添加 $\\mathrm{i}\\,k\\mathbf{I}$ 来修改外部算子，得到 $\\mathbf{T}_{\\mathrm{CFIE}}(k)=\\mathbf{T}(k)+\\mathrm{i}\\,k\\mathbf{I}$。\n5.  将右端载荷向量定义为一个非平凡的确定性向量，分为内部和边界部分：\n   $$\n   \\mathbf{b}=\\begin{bmatrix}\\mathbf{f}\\\\ \\mathbf{g}\\end{bmatrix},\\quad\n   \\mathbf{f}=\\begin{bmatrix}1\\\\0.5\\\\-0.5\\end{bmatrix},\\quad\n   \\mathbf{g}=\\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix}.\n   $$\n6.  定义一个小的确定性扰动向量以评估解的灵敏度：\n   $$\n   \\Delta\\mathbf{b}=\\varepsilon\\,\\frac{\\mathbf{v}}{\\|\\mathbf{v}\\|_2},\\quad \\varepsilon=10^{-6}\\|\\mathbf{b}\\|_2,\\quad\n   \\mathbf{v}=\\begin{bmatrix}1\\\\-1\\\\0.5\\\\0.2\\\\-0.3\\\\0.1\\end{bmatrix}.\n   $$\n7.  矩阵条件数在 2-范数下定义为\n   $$\n   \\kappa_2(\\mathbf{A})=\\frac{\\sigma_{\\max}(\\mathbf{A})}{\\sigma_{\\min}(\\mathbf{A})},\n   $$\n   其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 是最大和最小奇异值。解的灵敏度量化为从载荷的扰动到解的变化的放大因子，\n   $$\n   s(\\mathbf{A},\\mathbf{b})=\\frac{\\|\\mathbf{x}'-\\mathbf{x}\\|_2}{\\|\\Delta\\mathbf{b}\\|_2},\n   $$\n   其中 $\\mathbf{x}$ 是 $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$ 的解，$\\mathbf{x}'$ 是 $\\mathbf{A}\\mathbf{x}'=\\mathbf{b}+\\Delta\\mathbf{b}$ 的解。\n\n实现一个程序，对于每个测试用例的波数 $k$（单位为 $\\mathrm{rad/m}$），构造 $\\mathbf{A}(k)$ 和 $\\mathbf{A}_{\\mathrm{CFIE}}(k)$，计算 $\\kappa_2(\\mathbf{A})$ 和 $\\kappa_2(\\mathbf{A}_{\\mathrm{CFIE}})$，并计算灵敏度 $s(\\mathbf{A},\\mathbf{b})$ 和 $s(\\mathbf{A}_{\\mathrm{CFIE}},\\mathbf{b})$。如果最小奇异值在数值上为零，将条件数报告为 $+\\infty$；如果线性求解失败，将灵敏度报告为 $+\\infty$。角度单位在此不适用。所有结果必须计算为无单位的浮点数。\n\n测试套件：\n- 用例 1 (正常路径): $k=8.0\\,\\mathrm{rad/m}$。\n- 用例 2 (近共振): $k=9.9\\,\\mathrm{rad/m}$。\n- 用例 3 (非常接近共振): $k=9.999\\,\\mathrm{rad/m}$。\n- 用例 4 (高频): $k=40.0\\,\\mathrm{rad/m}$。\n\n最终输出格式：\n您的程序应产生单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个测试用例的结果必须是按 $[\\kappa_2(\\mathbf{A}),\\ \\kappa_2(\\mathbf{A}_{\\mathrm{CFIE}}),\\ s(\\mathbf{A},\\mathbf{b}),\\ s(\\mathbf{A}_{\\mathrm{CFIE}},\\mathbf{b})]$ 顺序排列的四个浮点数的列表。\n例如：\"[[cond_nc1,cond_c1,sens_nc1,sens_c1],[cond_nc2,cond_c2,sens_nc2,sens_c2],...]\"。",
            "solution": "用户提供的问题被评估为 **有效**。它是在计算声学领域中一个自洽的、有科学依据且适定的问题。它要求对一个简化但具有代表性的混合 FEM/BEM 系统进行数值分析，这是高等计算方法中的一个标准课题。所有需要的数据、矩阵、常数和定义都已提供，没有任何内部矛盾、歧义或违反科学原则的地方。\n\n任务是分析一个耦合 FEM/BEM 声学系统在共振点附近的条件数和解的灵敏度，同时包括使用和不使用组合场积分方程（CFIE）稳定两种情况。该分析是针对一组指定的波数 $k$ 进行的。\n\n该方法论涉及构造系统矩阵，基于奇异值计算它们的条件数，以及计算解对载荷向量中微小扰动的灵敏度。\n\n**1. 系统定义与矩阵构造**\n\n首先，我们根据问题陈述定义常数和基本矩阵。\n\n问题设定在一个长度为 $L=1\\,\\mathrm{m}$、具有 $n=3$ 个内部自由度的一维域上。网格间距为 $h = L/(n+1) = 1/(3+1) = 0.25\\,\\mathrm{m}$。刚度缩放因子为 $s_K=10$。\n\n刚度矩阵 $\\mathbf{K}\\in\\mathbb{R}^{3\\times 3}$ 由下式给出：\n$$\n\\mathbf{K} = s_K\\frac{1}{h}\\begin{bmatrix}1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1\\end{bmatrix} = 10 \\cdot \\frac{1}{0.25} \\begin{bmatrix}1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1\\end{bmatrix} = \\begin{bmatrix}40  -40  0 \\\\ -40  80  -40 \\\\ 0  -40  40\\end{bmatrix}\n$$\n\n质量矩阵 $\\mathbf{M}\\in\\mathbb{R}^{3\\times 3}$ 由下式给出：\n$$\n\\mathbf{M} = \\frac{h}{6}\\begin{bmatrix}2  1  0 \\\\ 1  4  1 \\\\ 0  1  2\\end{bmatrix} = \\frac{0.25}{6} \\begin{bmatrix}2  1  0 \\\\ 1  4  1 \\\\ 0  1  2\\end{bmatrix} = \\frac{1}{24}\\begin{bmatrix}2  1  0 \\\\ 1  4  1 \\\\ 0  1  2\\end{bmatrix}\n$$\n\n耦合算子 $\\mathbf{C}\\in\\mathbb{R}^{m\\times n}$ 定义为 $\\gamma=1$ 且 $m=n=3$，所以它是 $3 \\times 3$ 的单位矩阵：\n$$\n\\mathbf{C} = \\gamma\\,\\mathbf{I}_{3\\times 3} = \\mathbf{I}\n$$\n\n外部 BEM 算子 $\\mathbf{T}(k)\\in\\mathbb{R}^{3\\times 3}$ 被建模为一个依赖于波数 $k$ 的实的、对角的矩阵：\n$$\n\\mathbf{T}(k) = \\mathbf{R} - k^2\\mathbf{S}\n$$\n其中 $\\mathbf{R}=\\mathrm{diag}(2.0, 2.5, 3.0)$ 且 $\\mathbf{S}=\\mathrm{diag}(0.02, 0.025, 0.03)$。这种构造在 $k=10\\,\\mathrm{rad/m}$ 处产生一个共振，此时 $\\mathbf{T}(10)=\\mathbf{0}$。\n\n对于给定的 $k$，内部 FEM 块为 $\\mathbf{H}(k) = \\mathbf{K} - k^2\\mathbf{M}$。包含和不含 CFIE 稳定的完整系统矩阵被组装成 $6 \\times 6$ 的块矩阵。\n\n非稳定系统矩阵 $\\mathbf{A}(k)$ 为：\n$$\n\\mathbf{A}(k) = \\begin{bmatrix} \\mathbf{K}-k^2\\mathbf{M}  \\mathbf{C}^{\\top} \\\\ \\mathbf{C}  -\\mathbf{T}(k) \\end{bmatrix}\n$$\n\n对于 CFIE 稳定系统，稳定化参数为 $\\eta(k)=k$。稳定化的外部算子为 $\\mathbf{T}_{\\mathrm{CFIE}}(k) = \\mathbf{T}(k) + \\mathrm{i}\\,k\\mathbf{I}$。得到的系统矩阵 $\\mathbf{A}_{\\mathrm{CFIE}}(k)$ 是复值的：\n$$\n\\mathbf{A}_{\\mathrm{CFIE}}(k) = \\begin{bmatrix} \\mathbf{K}-k^2\\mathbf{M}  \\mathbf{C}^{\\top} \\\\ \\mathbf{C}  -(\\mathbf{T}(k)+\\mathrm{i}\\,k\\mathbf{I}) \\end{bmatrix}\n$$\n虚数项 $\\mathrm{i}\\,k\\mathbf{I}$ 防止右下角的块在 $\\mathbf{T}(k)$ 的共振点处变为奇异，从而稳定整个系统。\n\n**2. 载荷向量和扰动向量**\n\n右端载荷向量 $\\mathbf{b}\\in\\mathbb{R}^{6}$ 通过连接内部和边界载荷 $\\mathbf{f}$ 和 $\\mathbf{g}$ 形成：\n$$\n\\mathbf{f} = \\begin{bmatrix} 1 \\\\ 0.5 \\\\ -0.5 \\end{bmatrix}, \\quad \\mathbf{g} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix} \\quad \\implies \\quad \\mathbf{b} = \\begin{bmatrix} 1 \\\\ 0.5 \\\\ -0.5 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n$\\mathbf{b}$ 的 2-范数是 $\\|\\mathbf{b}\\|_2 = \\sqrt{1^2 + 0.5^2 + (-0.5)^2} = \\sqrt{1.5}$。\n\n扰动向量 $\\Delta\\mathbf{b}\\in\\mathbb{R}^{6}$ 定义为：\n$$\n\\Delta\\mathbf{b} = \\varepsilon\\,\\frac{\\mathbf{v}}{\\|\\mathbf{v}\\|_2}, \\quad \\text{其中} \\quad \\varepsilon = 10^{-6}\\|\\mathbf{b}\\|_2 \\quad \\text{且} \\quad \\mathbf{v} = \\begin{bmatrix} 1, -1, 0.5, 0.2, -0.3, 0.1 \\end{bmatrix}^{\\top}\n$$\n$\\mathbf{v}$ 的范数是 $\\|\\mathbf{v}\\|_2 = \\sqrt{1^2 + (-1)^2 + 0.5^2 + 0.2^2 + (-0.3)^2 + 0.1^2} = \\sqrt{2.39}$。因此，扰动的范数固定为 $\\|\\Delta\\mathbf{b}\\|_2 = \\varepsilon = 10^{-6}\\sqrt{1.5}$。\n\n**3. 度量指标的计算**\n\n对于每个系统矩阵（$\\mathbf{A}$ 和 $\\mathbf{A}_{\\mathrm{CFIE}}$）以及每个测试用例的波数 $k$，我们计算两个度量指标。\n\n**条件数：**\n2-范数下的条件数定义为最大奇异值与最小奇异值之比：\n$$\n\\kappa_2(\\mathbf{X}) = \\frac{\\sigma_{\\max}(\\mathbf{X})}{\\sigma_{\\min}(\\mathbf{X})}\n$$\n奇异值使用标准的奇异值分解（SVD）算法计算。如果 $\\sigma_{\\min}(\\mathbf{X})$ 在数值上与零无法区分（即低于机器精度容差），则该矩阵是奇异的，其条件数报告为无穷大（$\\infty$）。\n\n**解的灵敏度：**\n解的灵敏度 $s$ 定义为解的变化相对于载荷向量中扰动的放大：\n$$\ns(\\mathbf{X}, \\mathbf{b}) = \\frac{\\|\\mathbf{x}' - \\mathbf{x}\\|_2}{\\|\\Delta\\mathbf{b}\\|_2}\n$$\n其中 $\\mathbf{X}\\mathbf{x} = \\mathbf{b}$ 且 $\\mathbf{X}\\mathbf{x}' = \\mathbf{b} + \\Delta\\mathbf{b}$。根据线性性质，$\\mathbf{X}(\\mathbf{x}' - \\mathbf{x}) = \\Delta\\mathbf{b}$。令 $\\Delta\\mathbf{x} = \\mathbf{x}' - \\mathbf{x}$，我们可以通过求解线性系统来计算解的变化 $\\Delta\\mathbf{x}$：\n$$\n\\mathbf{X}\\Delta\\mathbf{x} = \\Delta\\mathbf{b}\n$$\n然后灵敏度计算为：\n$$\ns = \\frac{\\|\\Delta\\mathbf{x}\\|_2}{\\|\\Delta\\mathbf{b}\\|_2}\n$$\n这种方法避免了从 $\\mathbf{x}'$ 中减去 $\\mathbf{x}$ 时可能出现的浮点抵消错误。如果矩阵 $\\mathbf{X}$ 是奇异的，这个线性系统没有唯一解，求解器将失败，灵敏度报告为无穷大（$\\infty$）。\n\n实现将循环遍历指定的 $k$ 的测试用例，构造矩阵和向量，并使用数值库执行这些计算。针对非 CFIE 和 CFIE 系统的结果将被收集并按要求格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Analyzes a hybrid FEM/BEM system near resonance.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [8.0, 9.9, 9.999, 40.0]\n\n    results = []\n    for k in test_cases:\n        case_result = analyze_system(k)\n        # Format each sub-list as a string \"[v1,v2,v3,v4]\"\n        results.append(f\"[{','.join(map(str, case_result))}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef analyze_system(k):\n    \"\"\"\n    Constructs matrices and computes metrics for a given wavenumber k.\n    \"\"\"\n    # 1. Define Constants and Base Matrices\n    L = 1.0\n    n = 3\n    h = L / (n + 1)\n    s_K = 10.0\n    gamma = 1.0\n\n    K = (s_K / h) * np.array([[1.0, -1.0, 0.0],\n                              [-1.0, 2.0, -1.0],\n                              [0.0, -1.0, 1.0]])\n\n    M = (h / 6.0) * np.array([[2.0, 1.0, 0.0],\n                               [1.0, 4.0, 1.0],\n                               [0.0, 1.0, 2.0]])\n\n    C = gamma * np.eye(n)\n\n    R = np.diag([2.0, 2.5, 3.0])\n    S = np.diag([0.02, 0.025, 0.03])\n\n    # 2. Construct Wavenumber-Dependent Matrices\n    k2 = k * k\n    H_k = K - k2 * M\n    T_k = R - k2 * S\n\n    # 3. Assemble the Full System Matrices\n    # Non-CFIE System (real)\n    A = np.block([\n        [H_k, C.T],\n        [C, -T_k]\n    ])\n\n    # CFIE System (complex)\n    eta_k = k\n    T_CFIE_k = T_k + 1j * eta_k * np.eye(n)\n    A_CFIE = np.block([\n        [H_k, C.T],\n        [C, -T_CFIE_k]\n    ]).astype(np.complex128)\n\n    # 4. Define Load and Perturbation Vectors\n    f = np.array([1.0, 0.5, -0.5])\n    g = np.zeros(n)\n    b = np.concatenate((f, g))\n\n    v = np.array([1.0, -1.0, 0.5, 0.2, -0.3, 0.1])\n    epsilon = 1e-6 * linalg.norm(b)\n    delta_b = epsilon * v / linalg.norm(v)\n    norm_delta_b = linalg.norm(delta_b) # This is equal to epsilon\n\n    # 5. Compute Metrics for both systems\n    cond_A, sens_A = compute_metrics(A, delta_b, norm_delta_b)\n    cond_A_CFIE, sens_A_CFIE = compute_metrics(A_CFIE, delta_b, norm_delta_b)\n\n    return [cond_A, cond_A_CFIE, sens_A, sens_A_CFIE]\n\ndef compute_metrics(matrix, delta_b, norm_delta_b):\n    \"\"\"\n    Computes condition number and sensitivity for a given matrix and perturbation.\n    \"\"\"\n    # Use a tolerance for checking singularity.\n    sig_min_tol = 1e-15\n\n    # Condition Number\n    try:\n        # compute_uv=False is more efficient as we only need singular values\n        singular_values = linalg.svd(matrix, compute_uv=False)\n        sigma_min = singular_values[-1]\n        sigma_max = singular_values[0]\n\n        if sigma_min  sig_min_tol:\n            cond = float('inf')\n        else:\n            cond = sigma_max / sigma_min\n    except linalg.LinAlgError:\n        cond = float('inf')\n\n    # Sensitivity\n    try:\n        if cond == float('inf'):\n            # If matrix is singular, solve will fail.\n            raise linalg.LinAlgError(\"Singular matrix\")\n            \n        # More stable to solve for delta_x directly\n        delta_x = linalg.solve(matrix, delta_b)\n        norm_delta_x = linalg.norm(delta_x)\n        sens = norm_delta_x / norm_delta_b\n\n    except linalg.LinAlgError:\n        sens = float('inf')\n\n    return cond, sens\n\nsolve()\n```"
        }
    ]
}