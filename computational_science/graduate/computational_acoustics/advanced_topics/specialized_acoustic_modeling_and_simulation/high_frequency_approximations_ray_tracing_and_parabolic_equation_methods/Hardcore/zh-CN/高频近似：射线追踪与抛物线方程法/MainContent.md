## 引言
在计算声学领域，精确模拟声波在[复杂介质](@entry_id:164088)（如海洋）中的传播是一个核心挑战。直接求解完整的波动方程（[亥姆霍兹方程](@entry_id:149977)）在处理大尺度、高频率问题时，往往会面临巨大的计算量，甚至变得不切实际。为了克服这一障碍，[高频近似](@entry_id:1126066)方法应运而生，它们在保证足够精度的前提下，极大地提高了计算效率，成为[水下声学](@entry_id:1129046)、地球物理勘探等领域不可或缺的分析工具。

本文旨在系统性地介绍两种最重要的[高频近似](@entry_id:1126066)方法：射线追踪法和抛物方程法。文章将带领读者从理论基础走向实际应用，全面掌握这两种方法的精髓。在“原理与机制”一章中，我们将从亥姆霍兹方程出发，深入剖析这两种方法的数学推导、物理假设及其内在的优势与局限性。随后，在“应用与交叉学科联系”一章中，我们将展示这些理论如何在[海洋声学](@entry_id:1129046)等真实场景中大显身手，并探讨其与[数值分析](@entry_id:142637)、[科学计算](@entry_id:143987)等学科的深刻联系。最后，通过“动手实践”环节，读者将有机会通过具体的编程练习，将理论知识转化为解决实际问题的能力。

通过这一由浅入深、理论与实践相结合的结构，本文将为您构建一个关于高频声学近似的完整知识体系。

## 原理与机制

在“引言”章节之后，本章将深入探讨高频声学近似方法的两大支柱：射线追踪法和抛物方程法。我们将从[波动理论](@entry_id:180588)的共同基础——亥姆霍兹方程出发，系统地推导这两种方法的关键原理，阐明其内在机制，并探讨它们的[适用范围](@entry_id:636189)与局限性。

### 声学[波动理论](@entry_id:180588)基础：[亥姆霍兹方程](@entry_id:149977)

为了给[高频近似](@entry_id:1126066)建立一个坚实的理论基础，我们首先需要从[流体动力](@entry_id:750449)学的基本定律推导出描述声波在非均匀介质中传播的控制方程。考虑一个无粘、无损耗的流体，其背景密度 $\rho_0$ 为常数，但声速 $c(\mathbf{x})$ 随空间位置 $\mathbf{x}$ 变化。在这种介质中，微小的声学扰动由线性化的[动量方程](@entry_id:197225)、[连续性方程](@entry_id:195013)和状态方程所描述。

对于[角频率](@entry_id:261565)为 $\omega$ 的时谐声场，声压扰动 $p'(\mathbf{x}, t)$ 可以表示为其[复振幅](@entry_id:164138) $p(\mathbf{x})$ 的实部，即 $p'(\mathbf{x},t) = \Re\{p(\mathbf{x})\,e^{-i\omega t}\}$。通过将时谐形式代入[线性声学](@entry_id:1127264)方程组并消去速度和密度扰动，我们可以得到一个关于复声压振幅 $p(\mathbf{x})$ 的标量方程 。这个过程最终导出了著名的**[亥姆霍兹方程](@entry_id:149977) (Helmholtz equation)**：

$$
\nabla^2 p(\mathbf{x}) + \frac{\omega^2}{c^2(\mathbf{x})} p(\mathbf{x}) = 0
$$

为了方便分析，我们通常引入一个参考声速 $c_0$（常数）和一个参考波数 $k_0 = \omega / c_0$。这样，空间变化的声速可以用无量纲的**[折射](@entry_id:163428)率 (refractive index)** $n(\mathbf{x}) = c_0 / c(\mathbf{x})$ 来描述。利用这些定义，亥姆霍兹方程可以写成更紧凑的形式：

$$
\nabla^2 p(\mathbf{x}) + k_0^2 n^2(\mathbf{x})\,p(\mathbf{x}) = 0
$$

这个方程是波动声学中几乎所有[计算模型](@entry_id:637456)的出发点。[高频近似](@entry_id:1126066)方法的核心目标，就是在这个方程的基础上，寻找当频率非常高时的有效解法。

**高频机制 (high-frequency regime)** 的物理意义是声波的波长 $\lambda$ 远小于介质属性（即声速 $c(\mathbf{x})$）发生显著变化的特征长度 $L$。用数学语言表达，这个条件是 $k_0L \gg 1$ 。在这种情况下，声波在局部感受到的介质是近似均匀的，其传播路径主要由介质的大尺度变化决定，这为几何近似提供了物理基础。

### 方法一：[几何声学](@entry_id:1125600)与射线追踪

[几何声学](@entry_id:1125600)（或[射线声学](@entry_id:188106)）是最高频的近似，它将波的传播简化为沿着“射线”的能量传输。

#### 程函方程与[输运方程](@entry_id:174281)

[几何声学](@entry_id:1125600)的数学基础源于为[亥姆霍兹方程](@entry_id:149977)寻求一个渐近解。我们采用 **Wentzel–Kramers–Brillouin (WKB) ansatz**，假设声压场可以表示为一个缓慢变化的振幅 $A(\mathbf{x})$ 和一个快速变化的相位 $S(\mathbf{x})$ 的乘积：

$$
p(\mathbf{x}) \sim A(\mathbf{x}) \exp\big(i k_0 S(\mathbf{x})\big)
$$

这里，$S(\mathbf{x})$ 被称为**程函 (eikonal)**，它与波的走时直接相关。将此解形式代入[亥姆霍兹方程](@entry_id:149977)，并根据 $k_0$ 的幂次进行项的收集与分离，我们可以进行[尺度分离](@entry_id:270204)分析。在高频极限下 ($k_0 \to \infty$)，方程必须对 $k_0$ 的每一阶都成立。

在最高阶，即 $\mathcal{O}(k_0^2)$ 阶，我们通过平衡由相位项的二[次微分](@entry_id:175641)产生的[主导项](@entry_id:167418)，得到了著名的**程函方程 (eikonal equation)** ：

$$
|\nabla S(\mathbf{x})|^{2} = n^{2}(\mathbf{x})
$$

这是一个[非线性](@entry_id:637147)的、一阶的[偏微分](@entry_id:194612)方程，它描述了等相位面（即波前）的几何形状。程函方程的解定义了波的传播轨迹，即**声射线 (acoustic rays)**，它们是垂直于等相位面的曲线。

在下一阶，即 $\mathcal{O}(k_0)$ 阶，我们得到**[输运方程](@entry_id:174281) (transport equation)**，它控制着振幅 $A(\mathbf{x})$ 的变化。这个方程（此处不展开）[实质](@entry_id:149406)上描述了能量在沿射线传播的“射线管”内的守恒。

#### [费马原理](@entry_id:175608)、多途传播与[斯涅尔定律](@entry_id:162003)

求解程函方程的一个等效且更具物理直观性的方法是**[费马原理](@entry_id:175608) (Fermat's principle)**。该原理指出，声波在两点之间传播的实际路径是使总传播时间为驻定值（极大、极小或鞍点）的路径 。走时泛函 $T$ 定义为：

$$
T[\gamma] = \int_{\gamma} \frac{ds}{c(\mathbf{r})} = \frac{1}{c_0}\int_{\gamma} n(\mathbf{r})\,ds
$$

这是一个典型的[变分问题](@entry_id:756445)。在水平分层介质中，即声速仅随深度 $z$ 变化 ($c(z)$)，应用此变分原理的[欧拉-拉格朗日方程](@entry_id:137827)会导出一个[守恒量](@entry_id:161475)，即**[斯涅尔定律](@entry_id:162003) (Snell's law)**。它表明，沿单一射线路径，水平慢度（或射线参数）$p$ 是一个常数：

$$
p = \frac{n(z)}{c_0} \sin\theta(z) = \text{常数}
$$

其中 $\theta(z)$ 是射线与垂直方向的夹角。

对于给定的声源和接收器，寻找连接它们的射线路径（称为**本征射线 (eigenrays)**）成为一个[边值问题](@entry_id:1121801)。在许多实际的[海洋声学](@entry_id:1129046)环境中，例如存在声速极小值的声信道中，将声源的初始发射角 $\theta_0$ 映射到接收器深度处的水平距离 $R(\theta_0)$ 的函数并非单调。这意味着对于一个给定的距离 $R$，可能存在多个发射角 $\theta_0$ 都能使射线到达接收器。这种现象就是**多途传播 (multipath propagation)**，它导致接收器接收到来自同一声源的多个、在不同时间到达的信号 。寻找满足边界条件的多个不同射线参数 $p$ 的解，是计算多途到达的实用基础 。

#### [几何声学](@entry_id:1125600)的失效：焦散与转折点

尽管[射线理论](@entry_id:754096)非常直观，但它在某些关键区域会失效，预测出非物理的无限大振幅。

一个重要的失效点是**转折点 (turning point)**。在一个分层介质中，当一条射线传播到其路径变为水平的深度时，该深度即为转折点。在这一点上，射线的垂直慢度 $p_z = \sqrt{c^{-2}(z) - p_x^2}$ 变为零 。标准的WKB解的振幅因子正比于 $1/\sqrt{p_z}$，因此在转折点处会发散。此外，局地垂直波长 $\lambda_z = 2\pi/k_z$ 会趋于无穷大，这严重违反了[WKB方法](@entry_id:178439)要求波长远小于介质变化尺度的基本假设。

为了在转折点附近获得正确的解，需要对控制方程进行[局部线性化](@entry_id:169489)。这会将原始方程转化为**[艾里方程](@entry_id:166233) (Airy's equation)**，其解是**[艾里函数](@entry_id:198690) (Airy functions)**，如 $\operatorname{Ai}(\xi)$。[艾里函数](@entry_id:198690)在转折点处是有限的，并且能够平滑地连接一侧的振荡解和另一侧的衰减（隐失）解，从而恢复了物理上合理的有限振幅，并给出了正确的相位连接  。

另一个更普遍的失效区域是**焦散 (caustic)**。焦散是射线族的一条[包络线](@entry_id:174062)，相邻的射线在此处汇聚。从数学上讲，焦散是射线从初始条件（如发射角 $\theta$）到物理空间坐标 $(x,z)$ 的映射的雅可比行列式 $J$ 为零的轨迹 。由于射线振幅 $A$ 的变化与射线管的[截面](@entry_id:154995)积相关，而[截面](@entry_id:154995)积正比于 $J$，因此振幅近似满足 $A \propto |J|^{-1/2}$。当射线趋近焦散时，$J \to 0$，导致[几何声学](@entry_id:1125600)预测的振幅发散。

沿着一条射线的**[共轭点](@entry_id:160335) (conjugate points)** 是指从声源发出的邻近射线族重新聚焦的点，这些点构成了焦散。[共轭点](@entry_id:160335)的出现标志着该射线路径不再是走时泛函的局部最小值 。与转折点类似，焦散处的场也可以通过更高阶的均匀[渐近方法](@entry_id:177759)来描述，该方法通常也涉及[艾里函数](@entry_id:198690)。此外，每当一条射线穿过一个简单的[焦散面](@entry_id:158966)时，其相位会额外增加一个 $\pi/2$ 的相移，这被称为**马斯洛夫相移 (Maslov phase shift)** 。

### 方法二：抛物方程法

抛物方程（Parabolic Equation, PE）方法是一种介于精确的[亥姆霍兹方程](@entry_id:149977)和高度近似的[射线理论](@entry_id:754096)之间的强大工具。它保留了波的衍射效应，能够自然地处理焦散问题，但通过一个关键的近似将原本的椭圆型[边值问题](@entry_id:1121801)转化为一个可以高效进行距离步进计算的抛物型[初值问题](@entry_id:142753)。

#### 标准抛物方程的推导

PE方法的核心思想是：假设波主要沿着一个优选方向（例如水平距离 $r$）传播，并且与该方向的偏离角度很小。基于此，我们可以将总声压场 $p(\mathbf{x})$ 分解为一个快速振荡的参考相位和一个“慢变”的[包络函数](@entry_id:749028) $\psi(\mathbf{x})$：

$$
p(r, \mathbf{x}_\perp) = \psi(r, \mathbf{x}_\perp) \mathrm{e}^{\mathrm{i} k_0 r}
$$

其中 $k_0$ 是参考波数，$\mathbf{x}_\perp$ 代表横向坐标（在二维情况下为深度 $z$，三维情况下为 $(y,z)$）。

将这个ansatz代入亥姆霍兹方程，我们会得到一个关于 $\psi$ 的精确方程。然后，我们引入**[近轴近似](@entry_id:177930) (paraxial approximation)**：假设[包络函数](@entry_id:749028) $\psi$ 沿距离 $r$ 的变化远比其快速振荡的相位因子 $e^{ik_0 r}$ 慢得多。这一假设在数学上体现为忽略 $\psi$ 对 $r$ 的二阶导数项 $\partial^2 \psi / \partial r^2$，因为它与 $2ik_0 \partial \psi / \partial r$ 相比是一个小量 。

经过这个近似，亥姆霍兹方程就转化为一个在 $r$ 方向上是一阶的[偏微分](@entry_id:194612)方程，这就是**标准抛物方程 (Standard Parabolic Equation, SPE)**，也称为窄角PE：

$$
2 \mathrm{i} k_0 \frac{\partial \psi}{\partial r} + \nabla_\perp^2 \psi + k_0^2 (n^2 - 1) \psi = 0
$$

其中 $\nabla_\perp^2$ 是横向[拉普拉斯算子](@entry_id:146319)。在二维 $(r,z)$ 情况下，$\nabla_\perp^2 = \partial^2 / \partial z^2$ 。在三维 $(r,y,z)$ 情况下，$\nabla_\perp^2 = \partial^2 / \partial y^2 + \partial^2 / \partial z^2$ 。这个方程的结构使其可以作为关于距离 $r$ 的“初值”问题来求解，从而可以高效地进行步进计算。

#### 数值解法：分裂步长傅里叶方法

PE的数值求解最常用且最高效的方法之一是**分裂步长傅里叶方法 (Split-Step Fourier Method, SSFM)**。该方法将PE的演化算子分裂为两个部分：衍射算子和折射算子 。PE可以抽象地写成：

$$
\frac{\partial \psi}{\partial r} = (A + B) \psi
$$

其中 $A = \frac{i}{2k_0}\nabla_\perp^2$ 代表**衍射 (diffraction)**，而 $B = \frac{ik_0}{2}(n^2-1)$ 代表**[折射](@entry_id:163428) (refraction)**。SSFM的关键思想是，算子 $B$ 在物理空间中是对角化的（即简单的乘法），而算子 $A$ 在波数空间中是对角化的。通过傅里叶变换，我们可以在两个空间中交替地精确求解这两个算子引起的演化。

一个步长为 $\Delta r$ 的演化可以近似为：

1.  **[Lie-Trotter 分裂](@entry_id:751267) (一阶)**：$\psi(r+\Delta r) \approx e^{\Delta r A} e^{\Delta r B} \psi(r)$。这是一个非对称的分裂，其[全局误差](@entry_id:147874)为 $O(\Delta r)$ 。

2.  **Strang 分裂 (二阶)**：$\psi(r+\Delta r) \approx e^{\Delta r B/2} e^{\Delta r A} e^{\Delta r B/2} \psi(r)$。这是一个对称的分裂，它通过对称结构消除了低阶误差项，使得[全局误差](@entry_id:147874)提高到 $O(\Delta r^2)$ 。

SSFM方法因其高效率和良好的稳定性而成为PE计算的黄金标准。

#### 局限性与扩展

标准PE的成功是建立在[近轴近似](@entry_id:177930)之上的，这也带来了其固有的局限性。它是一个**单向 (one-way)** 模型，其数学结构从根本上排除了后向传播的声能。因此，它无法模拟由介质突变（如陡峭的海底斜坡）引起的**后向散射 (backscatter)**。此外，它只对与主传播轴夹角很小的声能（通常在 $15^\circ$ 以内）是准确的 。在模拟强上坡传播等大角度问题时，标准PE的精度会迅速下降 。

为了克服这些限制，研究人员开发了多种扩展的PE模型：

-   **宽角抛物方程 (Wide-Angle PE)**：为了提高对大角度传播能量的建模精度，宽角PE采用更精确的方法来近似[亥姆霍兹方程](@entry_id:149977)的算子。一个标准做法是，将亥姆霍兹方程分解后得到的平方根算子 $\sqrt{1+X}$ 用**[帕德近似](@entry_id:268838) (Padé approximant)** 代替简单的[泰勒展开](@entry_id:145057)。例如，使用 `$[1/1]$` 阶的[帕德近似](@entry_id:268838)可以推导出能够精确处理高达 $40^\circ$ 传播角的宽角PE 。

-   **双向抛物方程 (Two-Way PE)**：为了处理后向散射，双向P[E模](@entry_id:160271)型通过求解一个耦合方程组来同时计算[前向传播](@entry_id:193086)场和后向传播场，并在介质变化处将它们耦合起来。这使得模型能够描述反射和混响等双向传播现象 。

#### 三维抛物方程的计算考量

将PE方法从二维扩展到三维，会带来计算复杂度的显著增加。

-   **方位耦合与边界条件**：三维PE中的横向拉普拉斯算子 $\nabla_\perp^2 = \partial_y^2 + \partial_z^2$ 包含了方位向（$y$ 方向）的二阶导数。这意味着声能可以在水平面上发生折射和衍射，即存在**方位耦合 (azimuthal coupling)**。因此，数值计算不仅需要在垂直方向（如海面和海底）设置[吸收边界](@entry_id:201489)，也必须在方位向的两侧设置[吸收边界](@entry_id:201489)，以防止能量从计算域的侧面反射回来 。

-   **内存与计算量**：在数值实现上，从二维到三维的转变是巨大的。如果二维问题在一个横向维度上需要 $N_z$ 个格点，那么三维问题则需要在 $N_y \times N_z$ 的二维网格上存储场。内存需求从 $O(N_z)$ 增长到 $O(N_y N_z)$。对于SSFM算法，每个距离步长的计算复杂度也从执行一维FFT的 $O(N_z \log N_z)$ 增长到执行二维FFT的 $O(N_y N_z \log(N_y N_z))$。对于基于有限差分的[隐式方法](@entry_id:138537)，如**交替方向隐式 (ADI)** 方法，其计算量约为 $O(N_y N_z)$，但避免了大规模[矩阵求逆](@entry_id:636005) 。这些因素使得三维PE计算比二维计算昂贵得多。