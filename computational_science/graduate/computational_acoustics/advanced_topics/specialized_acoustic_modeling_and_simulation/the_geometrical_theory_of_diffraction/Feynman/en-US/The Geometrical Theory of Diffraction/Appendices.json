{
    "hands_on_practices": [
        {
            "introduction": "The power of the Geometrical Theory of Diffraction (GTD) lies in its ability to describe complex wave phenomena through a set of intuitive geometric paths. However, the first challenge in any computational application of GTD is to algorithmically identify which of these paths are physically valid. This practice  guides you through the process of developing a robust detection engine for edge diffraction, translating the abstract principles of GTD into concrete vector algebra and computational logic. By building the criteria for path admissibility from the ground up, you will gain a foundational understanding of how ray-tracing simulations find the hidden connections that diffraction creates between sources and receivers.",
            "id": "4142696",
            "problem": "You must design and implement a complete, runnable program that formalizes and detects edge diffraction events in a three-dimensional ray tracer consistent with the Geometrical Theory of Diffraction (GTD) in computational acoustics. The program must define appropriate data structures and implement geometric admissibility criteria that decide, for each test case, whether a valid edge diffraction event occurs. The detection logic must be derived from first principles of high-frequency acoustics without using shortcut formulas provided in this statement. All distances must be expressed in meters, all frequencies in Hertz, all speeds in meters per second, and all angles in radians.\n\nThe setting and constraints are as follows.\n\n- Fundamental base:\n  - Start from the acoustic wave equation for pressure field $p(\\mathbf{x},t)$ in a homogeneous medium with constant sound speed $c$, and from the high-frequency asymptotic (ray) regime in which phase $S(\\mathbf{x})$ satisfies the eikonal equation and amplitudes are transported along rays.\n  - Adopt the canonical understanding that diffraction arises as an edge contribution to the high-frequency asymptotics, producing diffracted rays that emanate from a geometrical edge in directions constrained by edge geometry and incident ray direction, consistent with Geometrical Theory of Diffraction.\n  - Define the acoustic wavenumber $k$ as $k = \\dfrac{2\\pi f}{c}$ for frequency $f$ and sound speed $c$.\n\n- Required data structures:\n  - A ray characterized by origin $\\mathbf{x}_0 \\in \\mathbb{R}^3$ (in meters), unit direction $\\mathbf{u} \\in \\mathbb{R}^3$, frequency $f$ (in Hertz), and sound speed $c$ (in meters per second).\n  - An edge characterized by endpoints $\\mathbf{p}_0,\\mathbf{p}_1 \\in \\mathbb{R}^3$ (in meters), and the outward unit normals $\\mathbf{n}_1,\\mathbf{n}_2 \\in \\mathbb{R}^3$ of the two adjacent planar faces that form the wedge. The wedge angle $\\alpha$ is the angle between the two face normals, and must be in the open interval $(0,\\pi)$.\n\n- Detection criteria to be implemented from first principles:\n  - A local geometric proximity test determines whether the incident ray passes sufficiently close to the edge line, with the closest-approach distance $\\rho$ bounded by a physically motivated threshold $r_c$. You must express $r_c$ in terms of $k$ and a dimensionless parameter $\\beta$ provided per test case.\n  - A forward-propagation admissibility test determines whether the closest-approach point lies in the forward direction of the ray.\n  - A segment admissibility test determines whether the closest-approach point projects onto the finite edge segment between $\\mathbf{p}_0$ and $\\mathbf{p}_1$.\n  - An illumination test determines whether at least one of the two faces is illuminated by the incident ray direction, in accordance with the GTD notion that edge diffraction is excited by illumination of the wedge.\n  - A degeneracy exclusion test rules out near-parallel configurations in which the incident ray direction is nearly parallel to the edge, controlled by a small angle threshold $\\gamma_{\\min}$ provided per test case.\n\n- Output specification:\n  - Your program must evaluate the detection for each test case in the provided test suite and produce a single line of output containing the boolean results as a comma-separated list enclosed in square brackets. For example, the output must look like $[\\text{result}_1,\\text{result}_2,\\dots]$.\n\n- Test suite (all vectors in meters; angles in radians; speed in meters per second; frequency in Hertz):\n  - Global constants used in all test cases: $c = 343\\,\\mathrm{m/s}$, $\\beta = 2.0$, and $\\gamma_{\\min} = 0.01$.\n  - Test case $1$ (happy path): \n    - Ray: $\\mathbf{x}_0 = (-0.02,-0.02,0.5)$, $\\mathbf{u} = (1,1,0)$ normalized, $f = 1000$.\n    - Edge: $\\mathbf{p}_0 = (0,0,0)$, $\\mathbf{p}_1 = (0,0,1)$, $\\mathbf{n}_1 = (-1,0,0)$, $\\mathbf{n}_2 = (0,-1,0)$.\n    - Expected to be admissible under the criteria when properly derived.\n  - Test case $2$ (outside proximity threshold):\n    - Ray: $\\mathbf{x}_0 = (-0.1,-0.3,0.5)$, $\\mathbf{u} = (1,1,0)$ normalized, $f = 1000$.\n    - Edge: $\\mathbf{p}_0 = (0,0,0)$, $\\mathbf{p}_1 = (0,0,1)$, $\\mathbf{n}_1 = (-1,0,0)$, $\\mathbf{n}_2 = (0,-1,0)$.\n    - Expected to fail the proximity test when properly derived.\n  - Test case $3$ (closest point outside the finite segment):\n    - Ray: $\\mathbf{x}_0 = (-0.02,-0.02,0.5)$, $\\mathbf{u} = (1,1,0)$ normalized, $f = 1000$.\n    - Edge: $\\mathbf{p}_0 = (0,0,0)$, $\\mathbf{p}_1 = (0,0,0.4)$, $\\mathbf{n}_1 = (-1,0,0)$, $\\mathbf{n}_2 = (0,-1,0)$.\n    - Expected to fail the segment admissibility test when properly derived.\n  - Test case $4$ (non-illuminated wedge):\n    - Ray: $\\mathbf{x}_0 = (-0.02,-0.02,0.5)$, $\\mathbf{u} = (-1,-1,0)$ normalized, $f = 1000$.\n    - Edge: $\\mathbf{p}_0 = (0,0,0)$, $\\mathbf{p}_1 = (0,0,1)$, $\\mathbf{n}_1 = (-1,0,0)$, $\\mathbf{n}_2 = (0,-1,0)$.\n    - Expected to fail the illumination test when properly derived.\n  - Test case $5$ (near-parallel degeneracy):\n    - Ray: $\\mathbf{x}_0 = (-0.05,0.05,0.5)$, $\\mathbf{u} = (0,0,1)$, $f = 1000$.\n    - Edge: $\\mathbf{p}_0 = (0,0,0)$, $\\mathbf{p}_1 = (0,0,1)$, $\\mathbf{n}_1 = (-1,0,0)$, $\\mathbf{n}_2 = (0,-1,0)$.\n    - Expected to fail the degeneracy exclusion test when properly derived.\n\nYour program must implement the detection function in a way that is invariant under rigid motions of the coordinate system. The final print statement must produce exactly one line in the single-line format specified above, with booleans corresponding in order to the five test cases.",
            "solution": "The problem posed is to construct a computational procedure for detecting edge diffraction events in a three-dimensional acoustic ray tracer, consistent with the Geometrical Theory of Diffraction (GTD). The detection is to be based on a set of five admissibility criteria, which must be derived from first principles. The entire formulation must be invariant under rigid motions of the coordinate system.\n\nFirst, we establish the mathematical representation of the entities involved. A ray is a semi-infinite line parameterized by its origin $\\mathbf{x}_0 \\in \\mathbb{R}^3$, its unit direction vector $\\mathbf{u} \\in \\mathbb{R}^3$, and a path-length parameter $t \\ge 0$. A point on the ray is given by $\\mathbf{r}(t) = \\mathbf{x}_0 + t\\mathbf{u}$. An edge is a finite line segment defined by its endpoints $\\mathbf{p}_0 \\in \\mathbb{R}^3$ and $\\mathbf{p}_1 \\in \\mathbb{R}^3$. We define the associated infinite edge line by the point $\\mathbf{p}_0$ and the unit direction vector $\\mathbf{e} = (\\mathbf{p}_1 - \\mathbf{p}_0) / \\|\\mathbf{p}_1 - \\mathbf{p}_0\\|$. A point on this line is given by $\\mathbf{p}(s) = \\mathbf{p}_0 + s\\mathbf{e}$, where $s \\in \\mathbb{R}$. The finite edge segment corresponds to the interval $s \\in [0, L_e]$, where $L_e = \\|\\mathbf{p}_1 - \\mathbf{p}_0\\|$ is the length of the edge. The wedge geometry is further specified by the outward unit normals, $\\mathbf{n}_1$ and $\\mathbf{n}_2$, of the two planar faces intersecting at the edge. The angle $\\alpha$ between these normals, given by $\\alpha = \\arccos(\\mathbf{n}_1 \\cdot \\mathbf{n}_2)$, is constrained to the interval $(0, \\pi)$, which ensures the faces form a non-degenerate wedge. This angle is crucial for calculating the diffraction coefficient in a full GTD model but is not directly required for the detection logic itself.\n\nOur solution is built upon vector-algebraic formulations of the five criteria, which guarantees invariance under rigid motions (translations and rotations) as vector operations such as the dot product and cross product are intrinsically coordinate-system independent.\n\nWe now derive the formal test for each of the five criteria.\n\n1.  **Degeneracy Exclusion Test**: This test prevents configurations where the incident ray is nearly parallel to the edge. Such cases are typically handled by different physical approximations (e.g., equivalent edge currents) and lead to singularities in the standard diffraction formulas. The condition is that the angle $\\gamma$ between the ray direction $\\mathbf{u}$ and the edge direction $\\mathbf{e}$ must not be too close to $0$ or $\\pi$. Let $\\gamma_{\\min}$ be a small angle threshold. The admissibility condition is $\\gamma > \\gamma_{\\min}$ and $\\pi - \\gamma > \\gamma_{\\min}$. Since $\\gamma \\in [0, \\pi]$, this is equivalent to $\\sin\\gamma > \\sin\\gamma_{\\min}$. Using the identity $\\|\\mathbf{u} \\times \\mathbf{e}\\| = \\|\\mathbf{u}\\|\\|\\mathbf{e}\\|\\sin\\gamma$ and the fact that $\\mathbf{u}$ and $\\mathbf{e}$ are unit vectors, we have $\\sin\\gamma = \\|\\mathbf{u} \\times \\mathbf{e}\\|$. Also, from the Lagrange identity, $\\|\\mathbf{u} \\times \\mathbf{e}\\|^2 = \\|\\mathbf{u}\\|^2\\|\\mathbf{e}\\|^2 - (\\mathbf{u} \\cdot \\mathbf{e})^2 = 1 - (\\mathbf{u} \\cdot \\mathbf{e})^2$. The test thus becomes $1 - (\\mathbf{u} \\cdot \\mathbf{e})^2 > \\sin^2(\\gamma_{\\min})$. This check is performed first to prevent division by near-zero denominators in subsequent calculations.\n\n2.  **Illumination Test**: For an edge to diffract an incident ray, the ray must illuminate at least one of the faces forming the wedge. A planar face with an outward normal $\\mathbf{n}$ is illuminated by a ray with direction $\\mathbf{u}$ if the ray impinges on its \"front\" side. This occurs when the angle between $\\mathbf{u}$ and $\\mathbf{n}$ is obtuse, i.e., greater than $\\pi/2$. The algebraic condition is $\\mathbf{u} \\cdot \\mathbf{n} < 0$. Given the two face normals $\\mathbf{n}_1$ and $\\mathbf{n}_2$, the edge is considered illuminated if $(\\mathbf{u} \\cdot \\mathbf{n}_1 < 0) \\lor (\\mathbf{u} \\cdot \\mathbf{n}_2 < 0)$. If $\\mathbf{u} \\cdot \\mathbf{n}_1 \\ge 0$ and $\\mathbf{u} \\cdot \\mathbf{n}_2 \\ge 0$, the ray is approaching from the geometric shadow region of the wedge and cannot excite diffraction at the edge.\n\n3.  **Local Geometric Proximity Test**: In high-frequency acoustics, diffraction is a local phenomenon. A ray must pass \"close enough\" to an edge to excite a diffracted field. The distance of closest approach, $\\rho$, between the infinite ray line and the infinite edge line must be smaller than a physically motivated threshold, $r_c$. The distance $\\rho$ between two skew lines, $\\mathbf{r}(t) = \\mathbf{x}_0 + t\\mathbf{u}$ and $\\mathbf{p}(s) = \\mathbf{p}_0 + s\\mathbf{e}$, is the length of the projection of the vector connecting their origins, $\\mathbf{w}_0 = \\mathbf{p}_0 - \\mathbf{x}_0$, onto the unit vector mutually perpendicular to both lines. This vector is $\\hat{\\mathbf{n}}_{perp} = (\\mathbf{u} \\times \\mathbf{e}) / \\|\\mathbf{u} \\times \\mathbf{e}\\|$. The distance is therefore $\\rho = |\\mathbfw_0 \\cdot \\hat{\\mathbf{n}}_{perp}| = \\frac{|(\\mathbf{p}_0 - \\mathbf{x}_0) \\cdot (\\mathbf{u} \\times \\mathbf{e})|}{\\|\\mathbf{u} \\times \\mathbf{e}\\|}$. The threshold $r_c$ is defined to be proportional to the acoustic wavelength $\\lambda = c/f = 2\\pi/k$, where $k = 2\\pi f/c$ is the wavenumber. The problem specifies $r_c$ in terms of $k$ and a dimensionless parameter $\\beta$, which we formalize as $r_c = \\beta/k$. The test is $\\rho < r_c$.\n\nTo perform the final two tests, we must find the parameters $s_{ca}$ and $t_{ca}$ that correspond to the points of closest approach on the edge line and ray line, respectively. These parameters minimize the squared distance $\\|(\\mathbf{p}_0 + s\\mathbf{e}) - (\\mathbf{x}_0 + t\\mathbf{u})\\|^2$. Setting the partial derivatives with respect to $s$ and $t$ to zero yields a linear system of equations for $s$ and $t$:\n$$\n\\begin{pmatrix} 1 & -(\\mathbf{u}\\cdot\\mathbf{e}) \\\\ -(\\mathbf{u}\\cdot\\mathbf{e}) & 1 \\end{pmatrix}\n\\begin{pmatrix} s \\\\ -t \\end{pmatrix} =\n\\begin{pmatrix} -(\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{e} \\\\ -(\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{u} \\end{pmatrix}\n$$\nSolving this system yields:\n$$s_{ca} = \\frac{(\\mathbf{u}\\cdot\\mathbf{e})((\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{u}) - ((\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{e})}{1 - (\\mathbf{u}\\cdot\\mathbf{e})^2}$$\n$$t_{ca} = \\frac{((\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{u}) - (\\mathbf{u}\\cdot\\mathbf{e})((\\mathbf{p}_0 - \\mathbf{x}_0)\\cdot\\mathbf{e})}{1 - (\\mathbf{u}\\cdot\\mathbf{e})^2}$$\n\n4.  **Forward-Propagation Admissibility Test**: The ray parameterization $\\mathbf{r}(t) = \\mathbf{x}_0 + t\\mathbf{u}$ defines a direction of propagation. A physical interaction can only happen \"downstream\" from the ray's origin. Thus, the parameter $t_{ca}$ corresponding to the point of closest approach on the ray must be positive. The test is $t_{ca} > 0$.\n\n5.  **Segment Admissibility Test**: The point of diffraction must physically lie on the finite material edge. The point of closest approach on the infinite edge line is $\\mathbf{p}(s_{ca})$. This point must lie within the segment defined by $\\mathbf{p}_0$ and $\\mathbf{p}_1$. This corresponds to the parameter $s_{ca}$ being within the interval $[0, L_e]$, where $L_e = \\|\\mathbf{p}_1 - \\mathbf{p}_0\\|$. The test is $0 \\le s_{ca} \\le L_e$.\n\nA diffraction event is admissible if and only if all five of these criteria are met. The implementation will evaluate these tests sequentially, terminating and returning `False` as soon as one fails. If all tests pass, it will return `True`.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef is_diffraction_admissible(ray_params, edge_params, constants):\n    \"\"\"\n    Checks if a ray-edge interaction constitutes a valid diffraction event\n    based on Geometrical Theory of Diffraction (GTD) criteria.\n\n    Args:\n        ray_params (dict): Dictionary with ray parameters:\n            'x0': np.array, origin of the ray (m).\n            'u': np.array, direction of the ray (unnormalized).\n            'f': float, frequency of the wave (Hz).\n        edge_params (dict): Dictionary with edge parameters:\n            'p0': np.array, first endpoint of the edge segment (m).\n            'p1': np.array, second endpoint of the edge segment (m).\n            'n1': np.array, outward normal of the first face.\n            'n2': np.array, outward normal of the second face.\n        constants (dict): Dictionary with global constants:\n            'c': float, speed of sound (m/s).\n            'beta': float, dimensionless parameter for proximity threshold.\n            'gamma_min': float, minimum angle for non-parallelism (rad).\n\n    Returns:\n        bool: True if the diffraction event is admissible, False otherwise.\n    \"\"\"\n    # Extract parameters and perform initial calculations\n    x0, u_unnormalized, f = ray_params['x0'], ray_params['u'], ray_params['f']\n    p0, p1, n1, n2 = edge_params['p0'], edge_params['p1'], edge_params['n1'], edge_params['n2']\n    c, beta, gamma_min = constants['c'], constants['beta'], constants['gamma_min']\n\n    # Normalize ray direction vector\n    u = u_unnormalized / np.linalg.norm(u_unnormalized)\n\n    # Calculate edge vector, direction, and length\n    edge_vec = p1 - p0\n    Le = np.linalg.norm(edge_vec)\n    if Le == 0:  # Degenerate edge\n        return False\n    e = edge_vec / Le\n\n    # --- Criterion 1: Degeneracy Exclusion Test ---\n    # Check for near-parallelism between ray and edge\n    ue_dot = np.dot(u, e)\n    # sin^2(gamma) = 1 - cos^2(gamma) = 1 - (u.e)^2\n    sin2_gamma = 1.0 - ue_dot**2\n    if sin2_gamma <= np.sin(gamma_min)**2:\n        return False\n\n    # --- Criterion 2: Illumination Test ---\n    # At least one face must be illuminated by the ray\n    un1_dot = np.dot(u, n1)\n    un2_dot = np.dot(u, n2)\n    if not (un1_dot < 0 or un2_dot < 0):\n        return False\n\n    # --- Criterion 3: Local Geometric Proximity Test ---\n    # Distance of closest approach between ray and edge line\n    k = 2.0 * np.pi * f / c\n    rc = beta / k  # Proximity threshold\n    w0 = p0 - x0\n    \n    # rho = |w0 . (u x e)| / ||u x e||\n    # ||u x e|| = sin(gamma)\n    # The scalar triple product w0 . (u x e) can be computed with a determinant\n    rho = np.abs(np.dot(w0, np.cross(u, e))) / np.sqrt(sin2_gamma)\n    \n    if not (rho < rc):\n        return False\n\n    # --- Calculate closest-approach parameters s_ca and t_ca ---\n    # These are needed for the final two tests\n    w0e_dot = np.dot(w0, e)\n    w0u_dot = np.dot(w0, u)\n    \n    # Denominator is sin^2(gamma), already calculated as sin2_gamma\n    denom = sin2_gamma\n    \n    # Parameter for the point on the edge line\n    sca = (ue_dot * w0u_dot - w0e_dot) / denom\n    \n    # Parameter for the point on the ray line\n    tca = (w0u_dot - ue_dot * w0e_dot) / denom\n    \n    # --- Criterion 4: Forward-Propagation Admissibility Test ---\n    # Closest-approach point must be in the forward direction of the ray\n    if not (tca > 0):\n        return False\n\n    # --- Criterion 5: Segment Admissibility Test ---\n    # Closest-approach point must lie on the finite edge segment\n    if not (0 <= sca <= Le):\n        return False\n\n    # If all tests pass, the event is admissible\n    return True\n\ndef solve():\n    \"\"\"\n    Defines the test suite and runs the diffraction detection logic for each case.\n    \"\"\"\n    constants = {\n        'c': 343.0,\n        'beta': 2.0,\n        'gamma_min': 0.01\n    }\n\n    test_cases = [\n        # Test Case 1 (happy path)\n        {\n            'ray': {'x0': np.array([-0.02, -0.02, 0.5]), 'u': np.array([1.0, 1.0, 0.0]), 'f': 1000.0},\n            'edge': {'p0': np.array([0.0, 0.0, 0.0]), 'p1': np.array([0.0, 0.0, 1.0]), 'n1': np.array([-1.0, 0.0, 0.0]), 'n2': np.array([0.0, -1.0, 0.0])}\n        },\n        # Test Case 2 (outside proximity threshold)\n        {\n            'ray': {'x0': np.array([-0.1, -0.3, 0.5]), 'u': np.array([1.0, 1.0, 0.0]), 'f': 1000.0},\n            'edge': {'p0': np.array([0.0, 0.0, 0.0]), 'p1': np.array([0.0, 0.0, 1.0]), 'n1': np.array([-1.0, 0.0, 0.0]), 'n2': np.array([0.0, -1.0, 0.0])}\n        },\n        # Test Case 3 (closest point outside the finite segment)\n        {\n            'ray': {'x0': np.array([-0.02, -0.02, 0.5]), 'u': np.array([1.0, 1.0, 0.0]), 'f': 1000.0},\n            'edge': {'p0': np.array([0.0, 0.0, 0.0]), 'p1': np.array([0.0, 0.0, 0.4]), 'n1': np.array([-1.0, 0.0, 0.0]), 'n2': np.array([0.0, -1.0, 0.0])}\n        },\n        # Test Case 4 (non-illuminated wedge)\n        {\n            'ray': {'x0': np.array([-0.02, -0.02, 0.5]), 'u': np.array([-1.0, -1.0, 0.0]), 'f': 1000.0},\n            'edge': {'p0': np.array([0.0, 0.0, 0.0]), 'p1': np.array([0.0, 0.0, 1.0]), 'n1': np.array([-1.0, 0.0, 0.0]), 'n2': np.array([0.0, -1.0, 0.0])}\n        },\n        # Test Case 5 (near-parallel degeneracy)\n        {\n            'ray': {'x0': np.array([-0.05, 0.05, 0.5]), 'u': np.array([0.0, 0.0, 1.0]), 'f': 1000.0},\n            'edge': {'p0': np.array([0.0, 0.0, 0.0]), 'p1': np.array([0.0, 0.0, 1.0]), 'n1': np.array([-1.0, 0.0, 0.0]), 'n2': np.array([0.0, -1.0, 0.0])}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = is_diffraction_admissible(case['ray'], case['edge'], constants)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once a valid ray path has been identified, the next critical step is to determine its contribution to the total acoustic field. The phase of the ray is especially important, as it governs how the ray will interfere with other contributions. This exercise  focuses on the meticulous accounting required for phase calculation along a complex path involving both reflection and diffraction, integrating the eikonal, the Maslov index, and phase shifts from interaction coefficients. Mastering this phase calculus is essential for moving beyond simple path-finding to predicting the intricate wave phenomena that GTD can describe.",
            "id": "4142698",
            "problem": "An acoustic point source emits a time-harmonic pressure field at angular frequency $\\omega$ in a homogeneous, lossless fluid of sound speed $c$. The resulting field satisfies the Helmholtz equation $(\\nabla^2 + k^2)p = 0$ with wavenumber $k = \\omega/c$. Consider a receiver that is reached predominantly by a single high-frequency path composed of three straight segments: from the source to a specular reflection point on a smooth, locally convex, perfectly rigid (Neumann) plane, then from the reflection point to a sharp right-angled wedge edge, and finally from the edge to the receiver. Let the geometric lengths of these three segments be $L_{1}$, $L_{2}$, and $L_{3}$, respectively. Work within the high-frequency asymptotics of the geometrical theory of diffraction (GTD) and the method of stationary phase for boundary and edge canonical integrals.\n\nStarting from the stationary-phase evaluation of the boundary integral representation of the Helmholtz solution and the GTD canonical edge integral for a right-angled wedge, determine the total accumulated phase of the complex exponential along this path, including both the eikonal contribution and the phase shifts induced by the reflection and the diffraction. In the same framework, identify the Maslov index contribution associated with the reflection and with the diffraction. Assume the following physically standard facts:\n- For a specular reflection from a smooth Neumann plane, the reflection coefficient introduces no constant phase shift beyond geometry.\n- The stationary-phase contribution at a single non-degenerate specular point on a smooth boundary increases the Maslov index by one.\n- The canonical edge diffraction by a right-angled wedge contributes a constant phase shift equal to $-\\pi/4$ and does not change the Maslov index.\n\nExpress the total phase in radians as a closed-form analytic expression in terms of $k$, $L_{1}$, $L_{2}$, and $L_{3}$, and state the Maslov index values for the reflection and the diffraction as integers. Report the final total phase in radians. No numerical values are provided; do not approximate. The final answer must be given as a single row matrix containing three entries: the total phase, the Maslov index for the reflection, and the Maslov index for the diffraction. Angles must be expressed in radians.",
            "solution": "The problem requires the determination of the total accumulated phase of a high-frequency acoustic wave traveling along a specific path and the identification of Maslov index contributions from reflection and diffraction events. The framework is the geometrical theory of diffraction (GTD).\n\nIn the high-frequency limit, the complex pressure field $p$ along a ray path can be expressed asymptotically as $p \\approx A \\exp(i\\Phi)$, where $A$ is a slowly varying amplitude and $\\Phi$ is the rapidly varying phase. The total phase $\\Phi$ is the quantity of interest. It is an accumulation of several contributions along the path from the source to the receiver.\n\nThe general form for the total accumulated phase $\\Phi$ is given by:\n$$\n\\Phi = kS - m\\frac{\\pi}{2} + \\phi_{coeffs}\n$$\nwhere:\n1.  $kS$ is the eikonal phase, with $k$ being the wavenumber and $S$ the total geometric path length.\n2.  $-m\\frac{\\pi}{2}$ is the phase correction due to the Maslov index $m$, which accounts for phase shifts at caustics (focal points or lines).\n3.  $\\phi_{coeffs}$ is the sum of any additional constant phase shifts introduced by interaction coefficients, such as reflection and diffraction coefficients.\n\nWe will evaluate each of these contributions based on the information provided in the problem statement.\n\n**1. Eikonal Phase Contribution ($kS$)**\n\nThe wave travels along a path composed of three straight segments of lengths $L_1$, $L_2$, and $L_3$. The total geometric path length $S$ is the sum of these lengths:\n$$\nS = L_1 + L_2 + L_3\n$$\nThe wavenumber is given as $k$. Therefore, the eikonal phase contribution is:\n$$\nkS = k(L_1 + L_2 + L_3)\n$$\n\n**2. Maslov Index and its Phase Contribution ($-m\\frac{\\pi}{2}$)**\n\nThe Maslov index $m$ is an integer that accumulates along the ray path. It starts at $m=0$ for a ray originating from a simple point source.\nThe path involves two interactions: a specular reflection and a wedge diffraction. We trace the value of $m$:\n- **Initial value:** The ray leaves the source, so its initial Maslov index is $m_{initial} = 0$.\n- **Specular Reflection:** The problem states, \"The stationary-phase contribution at a single non-degenerate specular point on a smooth boundary increases the Maslov index by one.\" This means the change in the Maslov index upon reflection, $\\Delta m_{\\text{refl}}$, is $1$. The index after reflection is $m_{after\\_refl} = m_{initial} + \\Delta m_{\\text{refl}} = 0 + 1 = 1$. The problem asks for the Maslov index contribution associated with the reflection, which is $\\Delta m_{\\text{refl}} = 1$.\n- **Edge Diffraction:** The problem states that the canonical edge diffraction \"does not change the Maslov index.\" This means the change in the Maslov index upon diffraction, $\\Delta m_{\\text{diff}}$, is $0$. The final Maslov index at the receiver is $m_{final} = m_{after\\_refl} + \\Delta m_{\\text{diff}} = 1 + 0 = 1$. The problem asks for the Maslov index contribution associated with the diffraction, which is $\\Delta m_{\\text{diff}} = 0$.\n\nThe total phase contribution from the Maslov index is determined by its final value, $m_{final} = 1$. The phase shift is:\n$$\n-m_{final}\\frac{\\pi}{2} = -(1)\\frac{\\pi}{2} = -\\frac{\\pi}{2}\n$$\n\n**3. Additional Phase Shifts from Coefficients ($\\phi_{coeffs}$)**\n\nThese are phase shifts arising from the inherent complex nature of reflection and diffraction coefficients.\n- **Reflection:** The problem specifies a perfectly rigid (Neumann) plane. It is stated that \"the reflection coefficient introduces no constant phase shift\". This implies that the phase of the reflection coefficient is zero. Thus, the phase contribution from reflection is $\\phi_{\\text{refl}} = 0$.\n- **Diffraction:** The problem states that the canonical edge diffraction by the right-angled wedge \"contributes a constant phase shift equal to $-\\pi/4$\". This is an explicit phase contribution from the diffraction process. Thus, $\\phi_{\\text{diff}} = -\\frac{\\pi}{4}$.\n\nThe total additional phase shift from coefficients is the sum of these contributions:\n$$\n\\phi_{coeffs} = \\phi_{\\text{refl}} + \\phi_{\\text{diff}} = 0 + \\left(-\\frac{\\pi}{4}\\right) = -\\frac{\\pi}{4}\n$$\n\n**4. Total Accumulated Phase ($\\Phi$)**\n\nWe now sum all the contributions to find the total phase $\\Phi$:\n$$\n\\Phi = kS - m_{final}\\frac{\\pi}{2} + \\phi_{coeffs}\n$$\nSubstituting the derived values:\n$$\n\\Phi = k(L_1 + L_2 + L_3) - \\frac{\\pi}{2} - \\frac{\\pi}{4}\n$$\nCombining the constant phase terms:\n$$\n\\Phi = k(L_1 + L_2 + L_3) - \\left(\\frac{2\\pi}{4} + \\frac{\\pi}{4}\\right)\n$$\n$$\n\\Phi = k(L_1 + L_2 + L_3) - \\frac{3\\pi}{4}\n$$\n\nThe three quantities requested by the problem are:\n1.  The total accumulated phase: $\\Phi = k(L_1 + L_2 + L_3) - \\frac{3\\pi}{4}$ radians.\n2.  The Maslov index contribution for the reflection: $\\Delta m_{\\text{refl}} = 1$.\n3.  The Maslov index contribution for the diffraction: $\\Delta m_{\\text{diff}} = 0$.\n\nThese results will be presented in a single row matrix as requested.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} k(L_1 + L_2 + L_3) - \\frac{3\\pi}{4} & 1 & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The ultimate goal of identifying and characterizing individual rays is to combine them to predict the total acoustic field at a receiver. This final superposition is where the wave-like nature of sound truly manifests through interference. This practice  explores the direct consequence of summing multiple ray contributions, demonstrating how small changes in receiver position can lead to large fluctuations in sound intensity. By analyzing a simple two-ray interference model, you will gain tangible insight into how the high-frequency approximation captures the rapid spatial variations that define complex soundscapes.",
            "id": "4142707",
            "problem": "Consider a high-frequency acoustic field in a homogeneous medium governed by the Helmholtz equation for the time-harmonic acoustic pressure field. In the high-frequency limit, the Geometrical Theory of Diffraction (GTD) approximates the total field at a receiver as a coherent superposition of contributions from a finite set of ray families, each represented by a locally slowly varying complex amplitude and a rapidly varying phase given by the wave number multiplied by the geometric path length. \n\nA receiver moves along a straight line parameterized by a coordinate $x$ in a neighborhood of $x=0$. In this neighborhood, the total acoustic pressure is dominated by two contributions, labeled $j=1,2$, each arriving at a fixed angle $\\theta_{j}$ with respect to the positive $x$-axis (angles measured in radians). Assume that over the small neighborhood of interest the complex amplitudes of the two contributions can be taken equal and constant, denoted $A>0$, while their phases are $k L_{j}(x)$ with $k>0$ the wave number and $L_{j}(x)$ the geometric path lengths. Suppose further that at $x=0$ the two contributions are in phase (constructive interference), that the medium is lossless and homogeneous, and that the angles $\\theta_{1}$ and $\\theta_{2}$ remain constant as the receiver moves.\n\nStarting only from the linear acoustics Helmholtz equation and the high-frequency ray ansatz, derive the leading-order expression for the smallest positive displacement $\\Delta x$ along the receiver trajectory that takes the total field magnitude from a local maximum at $x=0$ to the first local minimum as $x$ increases. Express your final result in meters and as an explicit closed-form analytic expression in terms of $k$, $\\theta_{1}$, and $\\theta_{2}$. Angles must be treated in radians. No numerical evaluation is required.",
            "solution": "The total time-harmonic acoustic pressure field, $p(x)$, at a position $x$ along the receiver's trajectory is given by the coherent superposition of the two dominant ray contributions, $p_1(x)$ and $p_2(x)$:\n$$\np(x) = p_1(x) + p_2(x)\n$$\nAccording to the high-frequency ray ansatz (GTD), each contribution can be modeled as a local plane wave with a slowly varying amplitude and a rapidly varying phase. The problem states that the complex amplitudes can be considered constant and equal, denoted by $A$. The phase is given by $kL_j(x)$, where $k$ is the wave number and $L_j(x)$ is the geometric path length. A more direct way to express the phase is by considering the phase evolution of a plane wave. The complex pressure for a plane wave propagating with wave vector $\\vec{k}_j$ is proportional to $\\exp(i \\vec{k}_j \\cdot \\vec{r})$, where $\\vec{r}$ is the position vector.\n\nThe receiver moves along a straight line, which we align with the $x$-axis, so its position vector is $\\vec{r}(x) = (x, 0, 0)$. Each ray arrives at a constant angle $\\theta_j$ with respect to the positive $x$-axis. The wave vector for the $j$-th ray is thus $\\vec{k}_j = k(\\cos \\theta_j, \\sin \\theta_j, \\dots)$, where $k = |\\vec{k}_j|$ is the wave number.\n\nThe phase of the $j$-th contribution at position $x$ is given by $\\phi_j(x) = \\phi_{j,0} + \\vec{k}_j \\cdot \\vec{r}(x)$, where $\\phi_{j,0}$ is the phase at the origin ($x=0$).\n$$\n\\phi_j(x) = \\phi_{j,0} + k(\\cos \\theta_j, \\sin \\theta_j, \\dots) \\cdot (x, 0, 0) = \\phi_{j,0} + kx\\cos\\theta_j\n$$\nThe problem states that at $x=0$, the two contributions are in phase. This implies that their phases differ by an integer multiple of $2\\pi$: $\\phi_{1,0} - \\phi_{2,0} = 2\\pi m$ for some integer $m$. We can absorb this constant phase difference and, without loss of generality, set $\\phi_{1,0} = \\phi_{2,0} = \\phi_0$.\n\nThe total complex pressure field is then:\n$$\np(x) = A e^{i \\phi_1(x)} + A e^{i \\phi_2(x)} = A e^{i(\\phi_0 + kx\\cos\\theta_1)} + A e^{i(\\phi_0 + kx\\cos\\theta_2)}\n$$\nWe can factor out the common term $A e^{i\\phi_0}$:\n$$\np(x) = A e^{i\\phi_0} \\left( e^{ikx\\cos\\theta_1} + e^{ikx\\cos\\theta_2} \\right)\n$$\nTo find the magnitude of the total field, $|p(x)|$, we can ignore the constant phase factor $e^{i\\phi_0}$, as its modulus is unity.\n$$\n|p(x)| = A \\left| e^{ikx\\cos\\theta_1} + e^{ikx\\cos\\theta_2} \\right|\n$$\nTo simplify this expression, we factor out the mean phase:\n$$\ne^{ikx\\cos\\theta_1} + e^{ikx\\cos\\theta_2} = e^{i\\frac{kx}{2}(\\cos\\theta_1 + \\cos\\theta_2)} \\left( e^{i\\frac{kx}{2}(\\cos\\theta_1 - \\cos\\theta_2)} + e^{-i\\frac{kx}{2}(\\cos\\theta_1 - \\cos\\theta_2)} \\right)\n$$\nUsing Euler's formula, $\\cos\\alpha = \\frac{e^{i\\alpha} + e^{-i\\alpha}}{2}$, the term in the parenthesis becomes $2\\cos\\left(\\frac{kx(\\cos\\theta_1 - \\cos\\theta_2)}{2}\\right)$.\nSubstituting this back, we get:\n$$\np(x) = 2A e^{i\\phi_0} e^{i\\frac{kx}{2}(\\cos\\theta_1 + \\cos\\theta_2)} \\cos\\left(\\frac{kx(\\cos\\theta_1 - \\cos\\theta_2)}{2}\\right)\n$$\nThe magnitude of the pressure field is the absolute value of this expression. Since $|A|=A$, $|e^{i\\alpha}|=1$, the magnitude is:\n$$\n|p(x)| = 2A \\left| \\cos\\left(\\frac{kx(\\cos\\theta_1 - \\cos\\theta_2)}{2}\\right) \\right|\n$$\nAt $x=0$, the argument of the cosine is $0$. Since $\\cos(0)=1$, the magnitude is $|p(0)| = 2A$. This is a maximum (constructive interference), as stated in the problem.\n\nA local minimum in the field magnitude occurs when the cosine term is zero. This corresponds to perfect destructive interference. This happens when the argument of the cosine function is an odd integer multiple of $\\frac{\\pi}{2}$:\n$$\n\\frac{kx(\\cos\\theta_1 - \\cos\\theta_2)}{2} = \\left(n + \\frac{1}{2}\\right)\\pi, \\quad n \\in \\mathbb{Z}\n$$\nWe are looking for the smallest positive displacement, $\\Delta x > 0$, that results in the first local minimum. This corresponds to the case where the argument of the cosine, starting from $0$ at $x=0$, first reaches a value of $\\pm\\frac{\\pi}{2}$. This corresponds to $n=0$ or $n=-1$.\n$$\n\\frac{k(\\Delta x)(\\cos\\theta_1 - \\cos\\theta_2)}{2} = \\pm\\frac{\\pi}{2}\n$$\nSolving for $\\Delta x$:\n$$\nk(\\Delta x)(\\cos\\theta_1 - \\cos\\theta_2) = \\pm\\pi\n$$\nSince $k>0$ and we seek $\\Delta x > 0$, we take the absolute value of the trigonometric part to ensure $\\Delta x$ is positive:\n$$\n\\Delta x = \\frac{\\pi}{k |\\cos\\theta_1 - \\cos\\theta_2|}\n$$\nThis expression gives the smallest positive displacement from the maximum at $x=0$ to the first minimum. The units of $k$ are inverse meters ($m^{-1}$), and the angles are in radians, making the expression dimensionless. Therefore, the resulting $\\Delta x$ has units of meters, as required. The expression is a closed-form analytic result in terms of the given parameters $k$, $\\theta_1$, and $\\theta_2$.",
            "answer": "$$\n\\boxed{\\frac{\\pi}{k |\\cos\\theta_1 - \\cos\\theta_2|}}\n$$"
        }
    ]
}