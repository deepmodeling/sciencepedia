{
    "hands_on_practices": [
        {
            "introduction": "Understanding acoustic metamaterials begins with the principle of homogenization. In the long-wavelength limit, where waves do not resolve the fine details of a structure, a complex composite can be described as a uniform medium with 'effective' properties. This foundational exercise  guides you through deriving the effective density and bulk modulus for a simple 1D layered medium from first principles, revealing how material properties average differently depending on the direction of wave propagation.",
            "id": "4113355",
            "problem": "Consider a one-dimensional periodic layered acoustic medium composed of two lossless, inviscid fluids, denoted by layer $1$ and layer $2$. Let the spatial period be $d$, with layer thicknesses $d_1$ and $d_2$ such that the volume fractions are $f_1 = d_1/d$ and $f_2 = d_2/d$, with $f_1 + f_2 = 1$. Each fluid $i \\in \\{1,2\\}$ is characterized by a constant bulk modulus $K_i > 0$ and a constant mass density $\\rho_i > 0$. Assume time-harmonic, small-amplitude, plane, longitudinal waves under the long-wavelength (quasi-static) homogenization regime where the wavelength is much larger than $d$, so that field variations across a unit cell are negligible at leading order.\n\nUsing first principles of linear acoustics—namely, the linearized momentum balance and the linear constitutive relation between pressure and volumetric strain—and appropriate interface continuity conditions for normal incidence on the layering, derive the effective bulk modulus $K_{\\text{eff}}^{\\perp}$ and effective density $\\rho_{\\text{eff}}^{\\perp}$ that govern propagation normal to the layers. Then, to elucidate the contrast between series versus parallel mixing in layered composites, also derive the corresponding mixing expressions $K_{\\text{mix}}^{\\parallel}$ obtained under a uniform volumetric strain assumption across layers (parallel mixing for stiffness-like properties), and $\\rho_{\\text{mix}}^{\\text{series}}$ obtained under a uniform momentum-flux assumption across layers (series mixing for inertia-like properties).\n\nProvide your final answer as analytic expressions in terms of $f_1$, $f_2$, $K_1$, $K_2$, $\\rho_1$, and $\\rho_2$. Do not substitute numerical values. No rounding is required. Express the four results in a single row matrix in the order $\\left(K_{\\text{eff}}^{\\perp},\\, \\rho_{\\text{eff}}^{\\perp},\\, K_{\\text{mix}}^{\\parallel},\\, \\rho_{\\text{mix}}^{\\text{series}}\\right)$. No units are required in the final answer. For clarity, all mathematical symbols and expressions must be written in LaTeX using inline math delimiters.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of linear acoustics and homogenization theory, is well-posed with sufficient information, and is expressed in objective, formal language. We may proceed with the derivation.\n\nThe problem asks for the derivation of four quantities related to the homogenization of a one-dimensional layered acoustic medium in the long-wavelength limit. The medium consists of alternating layers of two fluids with properties ($K_1, \\rho_1$) and ($K_2, \\rho_2$), and respective volume fractions $f_1$ and $f_2$. We will derive the effective bulk modulus $K_{\\text{eff}}^{\\perp}$ and effective density $\\rho_{\\text{eff}}^{\\perp}$ for wave propagation normal to the layers. Then, we will derive two mixing-rule expressions, $K_{\\text{mix}}^{\\parallel}$ and $\\rho_{\\text{mix}}^{\\text{series}}$, based on specified assumptions.\n\nThe fundamental one-dimensional equations of linear acoustics for an inhomogeneous fluid are the continuity equation (or momentum balance) and the constitutive relation. Let $x$ be the coordinate normal to the layers, $p(x,t)$ be the acoustic pressure, and $v(x,t)$ be the particle velocity.\nThe linearized momentum equation is:\n$$ \\rho(x) \\frac{\\partial v}{\\partial t} = -\\frac{\\partial p}{\\partial x} $$\nThe linear constitutive relation between pressure and volumetric strain, $\\epsilon_V = \\frac{\\partial u}{\\partial x}$ where $v = \\frac{\\partial u}{\\partial t}$, can be written in rate form as:\n$$ \\frac{\\partial p}{\\partial t} = -K(x) \\frac{\\partial v}{\\partial x} $$\nIn this layered medium, the density $\\rho(x)$ and bulk modulus $K(x)$ are piecewise constant functions of position. The homogenization procedure in the long-wavelength limit ($\\lambda \\gg d$) relies on spatial averaging of the fields over a unit cell of period $d$. The spatial average of a quantity $g(x)$ is denoted by $\\langle g \\rangle = \\frac{1}{d}\\int_0^d g(x) dx$.\n\n**1. Derivation of Effective Density $\\rho_{\\text{eff}}^{\\perp}$**\n\nFor wave propagation normal to the layers, the effective density $\\rho_{\\text{eff}}^{\\perp}$ relates the average particle acceleration to the macroscopic pressure gradient. We average the momentum equation over one unit cell:\n$$ \\left\\langle \\rho(x) \\frac{\\partial v}{\\partial t} \\right\\rangle = \\left\\langle -\\frac{\\partial p}{\\partial x} \\right\\rangle = -\\frac{1}{d} \\int_0^d \\frac{\\partial p}{\\partial x} dx = -\\frac{p(d) - p(0)}{d} $$\nThe right-hand side represents the macroscopic pressure gradient, $\\nabla \\langle p \\rangle$.\nAt the interface between layers, the normal particle velocity $v$ must be continuous to prevent cavitation or material overlap. In the long-wavelength limit, the velocity field $v(x,t)$ varies slowly across the microscopic scale of a single unit cell. Consequently, the acceleration $\\frac{\\partial v}{\\partial t}$ is approximately uniform within the cell, i.e., $\\frac{\\partial v}{\\partial t}(x) \\approx \\langle \\frac{\\partial v}{\\partial t} \\rangle$.\nApplying this to the left-hand side of the averaged momentum equation:\n$$ \\left\\langle \\rho(x) \\frac{\\partial v}{\\partial t} \\right\\rangle \\approx \\left\\langle \\rho(x) \\right\\rangle \\left\\langle \\frac{\\partial v}{\\partial t} \\right\\rangle = \\langle \\rho \\rangle \\frac{\\partial \\langle v \\rangle}{\\partial t} $$\nThe average density $\\langle \\rho \\rangle$ is calculated as:\n$$ \\langle \\rho \\rangle = \\frac{1}{d} \\int_0^d \\rho(x) dx = \\frac{1}{d} (\\rho_1 d_1 + \\rho_2 d_2) = \\rho_1 f_1 + \\rho_2 f_2 $$\nThe effective momentum equation is defined as $\\rho_{\\text{eff}}^{\\perp} \\frac{\\partial \\langle v \\rangle}{\\partial t} = -\\nabla \\langle p \\rangle$. By comparing this with our derived averaged equation, we identify the effective density for normal propagation:\n$$ \\rho_{\\text{eff}}^{\\perp} = \\langle \\rho \\rangle = f_1 \\rho_1 + f_2 \\rho_2 $$\nThis is the arithmetic mean, or the rule of mixtures, corresponding to a \"parallel\" connection for mass elements subjected to the same acceleration.\n\n**2. Derivation of Effective Bulk Modulus $K_{\\text{eff}}^{\\perp}$**\n\nThe effective bulk modulus $K_{\\text{eff}}^{\\perp}$ relates the average pressure to the average strain. The normal stress is $\\sigma_{xx} = -p$. At fluid-fluid interfaces, the normal stress (pressure) is continuous. In the long-wavelength limit, the pressure field $p(x,t)$ is approximately uniform within a unit cell, so $p(x) \\approx \\langle p \\rangle$.\nThe local strain rate is $\\frac{\\partial v}{\\partial x} = -\\frac{1}{K(x)} \\frac{\\partial p}{\\partial t}$. We average this relation over the unit cell:\n$$ \\left\\langle \\frac{\\partial v}{\\partial x} \\right\\rangle = \\left\\langle -\\frac{1}{K(x)} \\frac{\\partial p}{\\partial t} \\right\\rangle $$\nThe average strain rate is $\\langle \\frac{\\partial v}{\\partial x} \\rangle = \\frac{v(d)-v(0)}{d}$, which corresponds to the macroscopic strain rate $\\frac{\\partial \\langle v \\rangle}{\\partial x}$.\nUsing the uniformity of pressure, we have $\\frac{\\partial p}{\\partial t}(x) \\approx \\langle \\frac{\\partial p}{\\partial t} \\rangle = \\frac{\\partial \\langle p \\rangle}{\\partial t}$.\n$$ \\frac{\\partial \\langle v \\rangle}{\\partial x} \\approx -\\left\\langle \\frac{1}{K(x)} \\right\\rangle \\frac{\\partial \\langle p \\rangle}{\\partial t} $$\nThe average of the inverse bulk modulus (compliance) is:\n$$ \\left\\langle \\frac{1}{K} \\right\\rangle = \\frac{1}{d} \\int_0^d \\frac{1}{K(x)} dx = \\frac{1}{d} \\left(\\frac{d_1}{K_1} + \\frac{d_2}{K_2}\\right) = \\frac{f_1}{K_1} + \\frac{f_2}{K_2} $$\nThe effective constitutive relation is defined as $\\frac{\\partial \\langle p \\rangle}{\\partial t} = -K_{\\text{eff}}^{\\perp} \\frac{\\partial \\langle v \\rangle}{\\partial x}$. Rearranging our averaged equation gives $\\frac{\\partial \\langle p \\rangle}{\\partial t} \\approx - \\left( \\left\\langle \\frac{1}{K} \\right\\rangle \\right)^{-1} \\frac{\\partial \\langle v \\rangle}{\\partial x}$.\nBy comparison, we identify the effective bulk modulus for normal propagation:\n$$ K_{\\text{eff}}^{\\perp} = \\left\\langle \\frac{1}{K} \\right\\rangle^{-1} = \\left( \\frac{f_1}{K_1} + \\frac{f_2}{K_2} \\right)^{-1} $$\nThis is the harmonic mean, corresponding to a \"series\" connection for springs under the same stress.\n\n**3. Derivation of $K_{\\text{mix}}^{\\parallel}$ (Parallel Mixing Rule)**\n\nThis quantity is derived under the explicit assumption of uniform volumetric strain, $\\epsilon(x) = \\langle \\epsilon \\rangle$. This condition is physically realized when layers are loaded in parallel. The local pressure is $p(x) = -K(x)\\epsilon(x)$. We seek an effective modulus $K_{\\text{mix}}^{\\parallel}$ such that $\\langle p \\rangle = -K_{\\text{mix}}^{\\parallel} \\langle \\epsilon \\rangle$.\nAveraging the local relation:\n$$ \\langle p \\rangle = \\langle -K(x)\\epsilon(x) \\rangle $$\nUnder the uniform strain assumption, $\\epsilon(x)$ is constant and can be factored out of the averaging integral:\n$$ \\langle p \\rangle = -\\langle K(x) \\rangle \\langle \\epsilon \\rangle $$\nWe calculate the average bulk modulus $\\langle K \\rangle$:\n$$ \\langle K \\rangle = \\frac{1}{d} \\int_0^d K(x) dx = \\frac{1}{d}(K_1 d_1 + K_2 d_2) = f_1 K_1 + f_2 K_2 $$\nBy comparing with the definition of the effective modulus, we find:\n$$ K_{\\text{mix}}^{\\parallel} = \\langle K \\rangle = f_1 K_1 + f_2 K_2 $$\nThis is the arithmetic mean, or the rule of mixtures for stiffness.\n\n**4. Derivation of $\\rho_{\\text{mix}}^{\\text{series}}$ (Series Mixing Rule)**\n\nThis quantity is derived from an assumption described as \"uniform momentum-flux\" and \"series mixing for inertia-like properties\". This is analogous to the derivation of $K_{\\text{eff}}^{\\perp}$, where the \"force\"-like quantity (stress) was uniform and the \"displacement\"-like quantity (strain) was averaged. For inertia, the \"force\" is the pressure gradient $-\\frac{\\partial p}{\\partial x}$ and the \"response\" is the acceleration $\\frac{\\partial v}{\\partial t}$.\nThus, the underlying assumption is a uniform pressure gradient: $-\\frac{\\partial p}{\\partial x}(x) = \\left\\langle -\\frac{\\partial p}{\\partial x} \\right\\rangle$.\nFrom the local momentum equation, the acceleration is $\\frac{\\partial v}{\\partial t}(x) = \\frac{1}{\\rho(x)} \\left(-\\frac{\\partial p}{\\partial x}\\right)$.\nAveraging the acceleration:\n$$ \\left\\langle \\frac{\\partial v}{\\partial t} \\right\\rangle = \\left\\langle \\frac{1}{\\rho(x)} \\left(-\\frac{\\partial p}{\\partial x}\\right) \\right\\rangle $$\nUsing the uniform pressure gradient assumption, we factor it out:\n$$ \\left\\langle \\frac{\\partial v}{\\partial t} \\right\\rangle = \\left\\langle \\frac{1}{\\rho} \\right\\rangle \\left\\langle -\\frac{\\partial p}{\\partial x} \\right\\rangle $$\nThe average inverse density is:\n$$ \\left\\langle \\frac{1}{\\rho} \\right\\rangle = \\frac{1}{d} \\int_0^d \\frac{1}{\\rho(x)} dx = \\frac{1}{d} \\left(\\frac{d_1}{\\rho_1} + \\frac{d_2}{\\rho_2}\\right) = \\frac{f_1}{\\rho_1} + \\frac{f_2}{\\rho_2} $$\nThe effective momentum equation for this type of mixing is $\\rho_{\\text{mix}}^{\\text{series}} \\langle \\frac{\\partial v}{\\partial t} \\rangle = \\langle -\\frac{\\partial p}{\\partial x} \\rangle$. Rearranging our averaged equation yields $\\langle \\frac{\\partial v}{\\partial t} \\rangle = \\left\\langle \\frac{1}{\\rho} \\right\\rangle \\langle -\\frac{\\partial p}{\\partial x} \\rangle$.\nBy comparison, we find that $\\rho_{\\text{mix}}^{\\text{series}} = \\left(\\left\\langle \\frac{1}{\\rho} \\right\\rangle\\right)^{-1}$.\n$$ \\rho_{\\text{mix}}^{\\text{series}} = \\left( \\frac{f_1}{\\rho_1} + \\frac{f_2}{\\rho_2} \\right)^{-1} $$\nThis is the harmonic mean of the densities, representing series mixing for inertia.\nThe four results are now compiled for the final answer.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\left(\\frac{f_1}{K_1} + \\frac{f_2}{K_2}\\right)^{-1} & f_1 \\rho_1 + f_2 \\rho_2 & f_1 K_1 + f_2 K_2 & \\left(\\frac{f_1}{\\rho_1} + \\frac{f_2}{\\rho_2}\\right)^{-1} \\end{pmatrix} } $$"
        },
        {
            "introduction": "While static homogenization explains the behavior of many composites, the most striking properties of acoustic metamaterials emerge from dynamic, frequency-dependent effects. This practice  introduces the core concept of local resonance, the mechanism behind phenomena like negative effective mass. By modeling an inclusion as a simple mass-spring-damper system, you will derive the famous Lorentz-form expression for the effective dynamic mass density and understand how it leads to anomalous behavior near the resonant frequency.",
            "id": "4113334",
            "problem": "Consider a one-dimensional, long-wavelength acoustic metamaterial composed of a homogeneous host medium of mass density $\\rho_{0}$ and bulk modulus $K_{0}$, embedded with a dilute number density $n$ of identical subwavelength resonant inclusions. Each inclusion is modeled as a lumped mass $m$ attached to the host continuum by a linear spring of stiffness $\\kappa$ and a linear dashpot (viscous damper) of coefficient $\\eta$ that acts on the inclusion’s absolute velocity. Assume the host medium undergoes a time-harmonic displacement $u_{h}(t)=\\Re\\{U\\exp(-i\\omega t)\\}$, and let the inclusion’s absolute displacement be $u_{m}(t)=\\Re\\{U_{m}\\exp(-i\\omega t)\\}$. The spring connects $u_{m}$ to $u_{h}$, and the dashpot exerts a viscous force proportional to $\\dot{u}_{m}$ on the inclusion. The wave is spatially slowly varying so that all inclusions in a representative volume element experience the same $u_{h}(t)$ and $u_{m}(t)$.\n\nStarting from Newton’s second law for the inclusion and the linear momentum conservation for the composite, define the effective mass density $\\rho_{\\text{eff}}(\\omega)$ of the homogenized medium as the ratio of the average momentum density to the host velocity $v_{h}(t)=\\dot{u}_{h}(t)$ under time-harmonic excitation. Introduce the resonant angular frequency $\\omega_{0}$ via $\\omega_{0}^{2}=\\kappa/m$, the damping parameter $\\gamma=\\eta/m$, and the filling factor $F$ via $F=\\frac{n m}{\\rho_{0}}$. Using these definitions and the long-wavelength homogenization, derive the closed-form expression for $\\rho_{\\text{eff}}(\\omega)$ in terms of $\\rho_{0}$, $\\omega$, $\\omega_{0}$, $\\gamma$, and $F$. Express your final answer as a single analytic expression. If you include physical units, use kilograms per cubic meter ($\\mathrm{kg}\\,\\mathrm{m}^{-3}$). Do not provide intermediate formulas that shortcut the derivation path; start from the fundamental laws described above and carry the derivation to completion.",
            "solution": "The goal is to derive the frequency-dependent effective mass density $\\rho_{\\text{eff}}(\\omega)$ of a homogenized acoustic metamaterial that consists of a host medium plus embedded resonant inclusions. The derivation must start from first principles: Newton’s second law for the inclusion and momentum conservation for the composite. The long-wavelength assumption ensures that spatial variations across the unit cell are negligible, so averaging is valid.\n\nWe first write Newton’s second law for the inclusion mass. The inclusion is connected to the host by a spring of stiffness $\\kappa$ and experiences viscous damping $\\eta$ acting on its absolute velocity. Denote the host displacement by $u_{h}(t)$ and the inclusion displacement by $u_{m}(t)$. The spring force is $\\kappa\\,(u_{m}-u_{h})$, and the dashpot force on the inclusion is $\\eta\\,\\dot{u}_{m}$. Newton’s second law for the inclusion yields\n$$\nm\\,\\ddot{u}_{m} + \\eta\\,\\dot{u}_{m} + \\kappa\\,(u_{m}-u_{h}) = 0.\n$$\nAssume time-harmonic motion $u_{h}(t)=\\Re\\{U\\exp(-i\\omega t)\\}$ and $u_{m}(t)=\\Re\\{U_{m}\\exp(-i\\omega t)\\}$. Substituting $u_{h}(t)$ and $u_{m}(t)$ into the inclusion’s equation of motion and dividing by $\\exp(-i\\omega t)$ gives\n$$\n\\left(-m\\omega^{2} - i\\eta\\omega\\right)U_{m} + \\kappa\\,(U_{m}-U) = 0,\n$$\nwhich can be rearranged to\n$$\n(\\kappa - m\\omega^{2} - i\\eta\\omega)\\,U_{m} = \\kappa\\,U.\n$$\nSolving for the transfer ratio $U_{m}/U$ yields\n$$\n\\frac{U_{m}}{U} = \\frac{\\kappa}{\\kappa - m\\omega^{2} - i\\eta\\omega}.\n$$\nWith the definitions $\\omega_{0}^{2}=\\kappa/m$ and $\\gamma=\\eta/m$, we have\n$$\n\\frac{U_{m}}{U} = \\frac{m\\omega_{0}^{2}}{m(\\omega_{0}^{2} - \\omega^{2} - i\\gamma\\omega)} = \\frac{\\omega_{0}^{2}}{\\omega_{0}^{2} - \\omega^{2} - i\\gamma\\omega}.\n$$\n\nNext, we form the average momentum density of the composite under the long-wavelength approximation. The host medium has velocity $v_{h}(t)=\\dot{u}_{h}(t)=\\Re\\{-i\\omega U\\exp(-i\\omega t)\\}$, and the inclusion has velocity $v_{m}(t)=\\dot{u}_{m}(t)=\\Re\\{-i\\omega U_{m}\\exp(-i\\omega t)\\}$. The number density of inclusions is $n$, so the inclusion mass per unit volume is $nm$. The average momentum density $\\Pi(t)$ in the representative volume element is the sum of the host momentum density and the inclusion momentum density,\n$$\n\\Pi(t) = \\rho_{0}\\,v_{h}(t) + n m\\,v_{m}(t).\n$$\nUnder time-harmonic excitation, the ratio of inclusion to host velocities equals the ratio of displacements: $v_{m}/v_{h} = U_{m}/U$. Therefore, the time-harmonic amplitude of the average momentum density can be written as\n$$\n\\Pi = \\rho_{0}\\,v_{h} + n m\\,v_{h}\\left(\\frac{U_{m}}{U}\\right) = v_{h}\\left[\\rho_{0} + n m\\left(\\frac{U_{m}}{U}\\right)\\right].\n$$\nBy definition of the effective mass density, $\\rho_{\\text{eff}}(\\omega)$ is the proportionality factor between the average momentum density and the host velocity amplitude under homogenization:\n$$\n\\rho_{\\text{eff}}(\\omega) = \\rho_{0} + n m\\left(\\frac{U_{m}}{U}\\right).\n$$\nIntroduce the filling factor $F$ via $F=\\frac{n m}{\\rho_{0}}$. Substituting the transfer ratio and $F$ gives\n$$\n\\rho_{\\text{eff}}(\\omega) = \\rho_{0}\\left[1 + F\\,\\frac{\\omega_{0}^{2}}{\\omega_{0}^{2} - \\omega^{2} - i\\gamma\\omega}\\right].\n$$\nIt is often convenient to express the result with a denominator in the form $(\\omega^{2} - \\omega_{0}^{2} + i\\gamma\\omega)$. Multiplying numerator and denominator of the fraction by $-1$ yields\n$$\n\\rho_{\\text{eff}}(\\omega) = \\rho_{0}\\left[1 - F\\,\\frac{\\omega_{0}^{2}}{\\omega^{2} - \\omega_{0}^{2} + i\\gamma\\omega}\\right].\n$$\nThis is the desired closed-form expression for the effective mass density of the locally resonant acoustic metamaterial obtained from the mass-spring-dashpot model, expressed in terms of $\\rho_{0}$, $\\omega$, $\\omega_{0}$, $\\gamma$, and $F$. The quantity $\\rho_{\\text{f}}(\\omega)$ has the same physical units as $\\rho_{0}$, namely kilograms per cubic meter, which can be indicated as $\\mathrm{kg}\\,\\mathrm{m}^{-3}$ when reporting units outside the final boxed expression.",
            "answer": "$$\\boxed{\\rho_{0}\\left(1-\\frac{F\\,\\omega_{0}^{2}}{\\omega^{2}-\\omega_{0}^{2}+i\\,\\gamma\\,\\omega}\\right)}$$"
        },
        {
            "introduction": "This final exercise connects the abstract theory of dynamic effective properties to a concrete, observable phenomenon. Having derived the frequency-dependent effective density, this computational practice  challenges you to simulate wave transmission through a metamaterial slab. By implementing the model and testing various frequencies, you will computationally discover the formation of a deep attenuation band gap—a direct and powerful consequence of the negative effective density you previously modeled.",
            "id": "4113345",
            "problem": "A one-dimensional, normally incident, time-harmonic plane acoustic wave traverses a finite slab of a locally resonant metamaterial embedded in a homogeneous background fluid. The background fluid occupies the semi-infinite regions to the left and to the right of the slab and is characterized by constant mass density $\\rho_0$ and sound speed $c_0$, so the bulk modulus is $K_0 = \\rho_0 c_0^2$ and the acoustic impedance is $Z_0 = \\rho_0 c_0$. The metamaterial slab has thickness $d$, an effective bulk modulus $K_{\\text{eff}}(\\omega)$ assumed to be dispersionless and equal to the background bulk modulus $K_0$, and an effective dynamic mass density $\\rho_{\\text{eff}}(\\omega)$ that captures the locally resonant behavior.\n\nStarting from the linearized acoustic equations for small perturbations, namely the linearized momentum balance and continuity equations,\n$$\n\\rho(\\mathbf{x},t)\\,\\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p, \\quad \\frac{\\partial p}{\\partial t} = -K(\\mathbf{x},t)\\,\\nabla\\cdot \\mathbf{u}\n$$\nand restricting to one-dimensional propagation along $x$ with time-harmonic fields of angular frequency $\\omega$ (with the time dependence $e^{-i \\omega t}$), derive the one-dimensional Helmholtz equation in each homogeneous region, specify the continuity conditions for pressure and normal particle velocity at interfaces, and compute the complex amplitude transmission coefficient $t(\\omega)$ through the slab and the corresponding power transmittance $T(\\omega) = |t(\\omega)|^2$.\n\nModel the locally resonant metamaterial effective density with a causal Lorentz-type resonance,\n$$\n\\rho_{\\text{eff}}(\\omega) = \\rho_b\\left(1 - \\frac{F\\,\\omega^2}{\\omega^2 - \\omega_0^2 + i\\,\\gamma\\,\\omega}\\right),\n$$\nwhere $\\rho_b$ is the base (host) density, $F$ is a dimensionless coupling factor satisfying $0  F  1$, $\\omega_0$ is the resonance angular frequency, and $\\gamma$ is the damping rate. Assume $K_{\\text{eff}}(\\omega) = K_0$ to isolate the mass-density resonance, and assume the background fluid on both sides is identical and semi-infinite. Use the fundamental definitions for wavenumber and impedance in each homogeneous region,\n$$\nk(\\omega) = \\omega\\,\\sqrt{\\frac{\\rho(\\omega)}{K(\\omega)}}, \\quad Z(\\omega) = \\sqrt{\\rho(\\omega)\\,K(\\omega)}.\n$$\nYour program must implement the calculation of $t(\\omega)$ by enforcing the boundary conditions of continuity of pressure and normal particle velocity at the slab interfaces, and the radiation conditions of a unit-amplitude incident wave from the left and only a forward-propagating transmitted wave to the right. Do not introduce any additional fitting parameters beyond those specified.\n\nPhysical parameters for the background fluid must be set to $\\rho_0 = 1.21\\,\\text{kg/m}^3$ and $c_0 = 343\\,\\text{m/s}$, so $K_0 = \\rho_0 c_0^2$ and $Z_0 = \\rho_0 c_0$. Take the metamaterial base density $\\rho_b = \\rho_0$. Use $\\omega_0 = 2\\pi \\times 800\\,\\text{rad/s}$ for the resonance angular frequency. All angular frequencies must be handled and reported internally in $\\text{rad/s}$, all lengths in $\\text{m}$, densities in $\\text{kg/m}^3$, moduli in $\\text{Pa}$, and damping rates in $\\text{s}^{-1}$. The transmittance is dimensionless.\n\nConstruct the following test suite of parameter sets $(\\omega, d, F, \\gamma)$ to probe frequencies below, near, and above $\\omega_0$, including boundary and edge cases:\n- Case A (below resonance): $(\\omega, d, F, \\gamma) = (0.5\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$.\n- Case B (near below resonance): $(\\omega, d, F, \\gamma) = (0.99\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$.\n- Case C (near above resonance): $(\\omega, d, F, \\gamma) = (1.01\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$.\n- Case D (above resonance): $(\\omega, d, F, \\gamma) = (1.5\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$.\n- Case E (far above resonance): $(\\omega, d, F, \\gamma) = (3.0\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$.\n- Case F (edge: very low damping near above resonance): $(\\omega, d, F, \\gamma) = (1.01\\,\\omega_0, 0.1\\,\\text{m}, 0.8, 10^{-4}\\,\\omega_0)$.\n- Case G (edge: weak coupling near above resonance): $(\\omega, d, F, \\gamma) = (1.01\\,\\omega_0, 0.1\\,\\text{m}, 0.1, 0.05\\,\\omega_0)$.\n- Case H (boundary: zero thickness): $(\\omega, d, F, \\gamma) = (1.2\\,\\omega_0, 0.0\\,\\text{m}, 0.8, 0.05\\,\\omega_0)$.\n\nYour program should compute the power transmittance $T(\\omega)$ for each case. The final output format must be a single line containing a comma-separated list of the transmittances for the cases A through H, enclosed in square brackets, with each value rounded to $6$ decimal places (for example, $[0.123456,0.654321,\\dots]$). In addition to calculating $T(\\omega)$, the interpretation that relates the observed attenuation to the sign and magnitude of $\\rho_{\\text{eff}}(\\omega)$ should be established in the derivation, but the program must output only the numerical transmittances as specified.",
            "solution": "The user has provided a valid problem statement in computational acoustics. The task is to derive the transmission coefficient for a plane acoustic wave normally incident on a slab of a locally resonant metamaterial and then to compute the power transmittance for a given set of parameters. The problem is well-posed, scientifically sound, and provides all necessary information.\n\n### **Part 1: Derivation of the 1D Helmholtz Equation**\n\nWe begin with the linearized acoustic equations for pressure perturbation $p(\\mathbf{x}, t)$ and particle velocity $\\mathbf{u}(\\mathbf{x}, t)$ in a medium with density $\\rho(\\mathbf{x}, t)$ and bulk modulus $K(\\mathbf{x}, t)$:\n$$\n\\rho\\,\\frac{\\partial \\mathbf{u}}{\\partial t} = -\\nabla p, \\quad \\frac{\\partial p}{\\partial t} = -K\\,\\nabla\\cdot \\mathbf{u}\n$$\nWe consider one-dimensional propagation along the $x$-axis, so $\\mathbf{u} = u(x,t)\\hat{\\mathbf{x}}$ and $\\nabla = \\frac{\\partial}{\\partial x}\\hat{\\mathbf{x}}$. The equations reduce to:\n$$\n\\rho(x,t)\\,\\frac{\\partial u}{\\partial t} = -\\frac{\\partial p}{\\partial x}, \\quad \\frac{\\partial p}{\\partial t} = -K(x,t)\\,\\frac{\\partial u}{\\partial x}\n$$\nFor time-harmonic fields with an angular frequency $\\omega$, the fields can be written as $p(x,t) = p(x)e^{-i\\omega t}$ and $u(x,t) = u(x)e^{-i\\omega t}$. The time derivative operator becomes $\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$. The material properties $\\rho$ and $K$ are now effective parameters that depend on frequency, $\\rho_{\\text{eff}}(\\omega)$ and $K_{\\text{eff}}(\\omega)$. Within any homogeneous region, they are spatially constant. The time-harmonic equations are:\n$$\n-i\\omega\\rho_{\\text{eff}}(\\omega)u(x) = -\\frac{dp}{dx} \\implies \\frac{dp}{dx} = i\\omega\\rho_{\\text{eff}}(\\omega)u(x)\n$$\n$$\n-i\\omega p(x) = -K_{\\text{eff}}(\\omega)\\frac{du}{dx} \\implies \\frac{du}{dx} = \\frac{i\\omega}{K_{\\text{eff}}(\\omega)}p(x)\n$$\nTo derive the Helmholtz equation for pressure, we differentiate the first equation with respect to $x$ and substitute the second:\n$$\n\\frac{d^2p}{dx^2} = i\\omega\\rho_{\\text{eff}}(\\omega)\\frac{du}{dx} = i\\omega\\rho_{\\text{eff}}(\\omega)\\left(\\frac{i\\omega}{K_{\\text{eff}}(\\omega)}p(x)\\right) = -\\omega^2\\frac{\\rho_{\\text{eff}}(\\omega)}{K_{\\text{eff}}(\\omega)}p(x)\n$$\nThis gives the one-dimensional Helmholtz equation:\n$$\n\\frac{d^2p}{dx^2} + k^2(\\omega)p(x) = 0\n$$\nwhere the complex wavenumber $k(\\omega)$ is defined as:\n$$\nk(\\omega) = \\omega\\sqrt{\\frac{\\rho_{\\text{eff}}(\\omega)}{K_{\\text{eff}}(\\omega)}}\n$$\n\n### **Part 2: Wave Propagation Through a Slab**\n\nThe system consists of three regions:\n- Region 1 ($x0$): Background fluid with properties $\\rho_0$, $K_0 = \\rho_0 c_0^2$. Wavenumber $k_0 = \\omega/c_0$.\n- Region 2 ($0 \\le x \\le d$): Metamaterial slab with properties $\\rho_{\\text{eff}}(\\omega)$, $K_{\\text{eff}}(\\omega) = K_0$. Wavenumber $k_{\\text{eff}}(\\omega) = \\omega\\sqrt{\\rho_{\\text{eff}}(\\omega)/K_0}$.\n- Region 3 ($xd$): Background fluid, same as Region 1.\n\nThe pressure field in each region is a solution to the Helmholtz equation:\n- $p_1(x) = e^{ik_0x} + R\\,e^{-ik_0x}$ for $x0$. Incident wave has unit amplitude. $R$ is the complex reflection coefficient.\n- $p_2(x) = A\\,e^{ik_{\\text{eff}}x} + B\\,e^{-ik_{\\text{eff}}x}$ for $0 \\le x \\le d$.\n- $p_3(x) = t\\,e^{ik_0(x-d)}$ for $xd$. Only a forward-propagating transmitted wave exists. $t$ is the complex transmission coefficient.\n\nThe particle velocity $u(x)$ is related to the pressure by $u(x) = \\frac{1}{i\\omega\\rho}\\frac{dp}{dx}$. For a plane wave $p=p_0 e^{\\pm ikx}$, $u = \\pm\\frac{k}{\\omega\\rho}p = \\pm\\frac{1}{Z}p$, where $Z=\\sqrt{\\rho K}$ is the characteristic acoustic impedance.\nThe impedances are $Z_0 = \\sqrt{\\rho_0 K_0}$ and $Z_{\\text{eff}} = \\sqrt{\\rho_{\\text{eff}} K_0}$. The velocity fields are:\n- $u_1(x) = \\frac{1}{Z_0}(e^{ik_0x} - R\\,e^{-ik_0x})$\n- $u_2(x) = \\frac{1}{Z_{\\text{eff}}}(A\\,e^{ik_{\\text{eff}}x} - B\\,e^{-ik_{\\text{eff}}x})$\n- $u_3(x) = \\frac{1}{Z_0}t\\,e^{ik_0(x-d)}$\n\nThe boundary conditions are continuity of pressure and particle velocity at the interfaces $x=0$ and $x=d$. A robust method to solve for $t$ is the transfer matrix method. The state vector $(p(x), u(x))^T$ at $x=0$ is related to the state vector at $x=d$ by a propagation matrix:\n$$\n\\begin{pmatrix} p(0) \\\\ u(0) \\end{pmatrix} = \\begin{pmatrix} \\cos(k_{\\text{eff}}d)  i Z_{\\text{eff}}\\sin(k_{\\text{eff}}d) \\\\ i \\frac{1}{Z_{\\text{eff}}}\\sin(k_{\\text{eff}}d)  \\cos(k_{\\text{eff}}d) \\end{pmatrix} \\begin{pmatrix} p(d) \\\\ u(d) \\end{pmatrix}\n$$\nFrom the wave solutions, we have:\n- At $x=0$: $p_1(0) = 1+R$, $u_1(0) = (1-R)/Z_0$.\n- At $x=d$: $p_3(d) = t$, $u_3(d) = t/Z_0$.\nSubstituting these into the matrix equation:\n$$\n\\begin{pmatrix} 1+R \\\\ (1-R)/Z_0 \\end{pmatrix} = \\begin{pmatrix} \\cos(k_{\\text{eff}}d)  i Z_{\\text{eff}}\\sin(k_{\\text{eff}}d) \\\\ i \\frac{1}{Z_{\\text{eff}}}\\sin(k_{\\text{eff}}d)  \\cos(k_{\\text{eff}}d) \\end{pmatrix} \\begin{pmatrix} t \\\\ t/Z_0 \\end{pmatrix}\n$$\nThis represents two linear equations:\n1. $1+R = t \\left( \\cos(k_{\\text{eff}}d) + i\\frac{Z_{\\text{eff}}}{Z_0}\\sin(k_{\\text{eff}}d) \\right)$\n2. $1-R = t \\left( Z_0 \\left(i\\frac{1}{Z_{\\text{eff}}}\\sin(k_{\\text{eff}}d)\\right) + Z_0\\left(\\frac{1}{Z_0}\\cos(k_{\\text{eff}}d)\\right) \\right) = t \\left( \\cos(k_{\\text{eff}}d) + i\\frac{Z_0}{Z_{\\text{eff}}}\\sin(k_{\\text{eff}}d) \\right)$\n\nAdding these two equations eliminates $R$:\n$$\n2 = t \\left[ 2\\cos(k_{\\text{eff}}d) + i\\left(\\frac{Z_{\\text{eff}}}{Z_0} + \\frac{Z_0}{Z_{\\text{eff}}}\\right)\\sin(k_{\\text{eff}}d) \\right]\n$$\nSolving for the complex transmission coefficient $t \\equiv t(\\omega)$:\n$$\nt(\\omega) = \\left[ \\cos(k_{\\text{eff}}d) + \\frac{i}{2}\\left(\\frac{Z_{\\text{eff}}(\\omega)}{Z_0} + \\frac{Z_0}{Z_{\\text{eff}}(\\omega)}\\right)\\sin(k_{\\text{eff}}d) \\right]^{-1}\n$$\nThe power transmittance is $T(\\omega) = |t(\\omega)|^2$.\n\n### **Part 3: Metamaterial Properties and Interpretation**\n\nThe effective density is given by a Lorentz model:\n$$\n\\rho_{\\text{eff}}(\\omega) = \\rho_b\\left(1 - \\frac{F\\,\\omega^2}{\\omega^2 - \\omega_0^2 + i\\,\\gamma\\,\\omega}\\right)\n$$\nWith $\\rho_b = \\rho_0$, the behavior is governed by the frequency-dependent term.\n- Near the resonance $\\omega_0$, the denominator becomes small.\n- For a frequency band just above $\\omega_0$, the term $\\omega^2 - \\omega_0^2$ is positive and small. For small damping $\\gamma$, the fraction $\\frac{F\\omega^2}{\\dots}$ can be a large real number greater than $1$.\n- This results in a frequency range where $\\text{Re}(\\rho_{\\text{eff}}(\\omega))$ is negative.\n- When $\\rho_{\\text{eff}}$ is negative (and real for simplicity), the impedance $Z_{\\text{eff}} = \\sqrt{\\rho_{\\text{eff}}K_0}$ and wavenumber $k_{\\text{eff}} = \\omega\\sqrt{\\rho_{\\text{eff}}/K_0}$ become purely imaginary.\n- An imaginary wavenumber, $k_{\\text{eff}} = i\\kappa$ where $\\kappa$ is real and positive, implies that the wave amplitude decays exponentially as $e^{-\\kappa x}$ inside the slab. This creates a band gap with very low transmission, which is a key feature of such metamaterials. The calculation will capture this effect. For the zero-thickness case ($d=0$), $\\cos(0)=1$ and $\\sin(0)=0$, so $t(\\omega)=1$ and $T(\\omega)=1$, as expected.\n\n### **Part 4: Algorithm for Numerical Computation**\n\nThe computation for each test case $(\\omega, d, F, \\gamma)$ follows these steps:\n1. Define the physical constants: $\\rho_0 = 1.21\\,\\text{kg/m}^3$, $c_0 = 343\\,\\text{m/s}$, $K_0 = \\rho_0 c_0^2$, $Z_0 = \\rho_0 c_0$, and $\\omega_0 = 2\\pi \\times 800\\,\\text{rad/s}$.\n2. For the given $\\omega, F, \\gamma$, calculate the complex effective density $\\rho_{\\text{eff}}(\\omega)$ using the Lorentz model with $\\rho_b=\\rho_0$. This requires complex number arithmetic.\n3. Calculate the complex effective impedance $Z_{\\text{eff}}(\\omega) = \\sqrt{\\rho_{\\text{eff}}(\\omega) K_0}$. The `sqrt` function must handle complex arguments, returning the principal root (with non-negative real part).\n4. Calculate the complex effective wavenumber $k_{\\text{eff}}(\\omega) = \\omega \\sqrt{\\rho_{\\text{eff}}(\\omega)/K_0}$.\n5. Substitute $k_{\\text{eff}}$, $Z_{\\text{eff}}$, $Z_0$, and $d$ into the derived formula for $t(\\omega)$. All trigonometric functions must support complex arguments.\n6. Compute the power transmittance $T(\\omega) = |t(\\omega)|^2$.\n7. Repeat for all test cases and format the output as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the power transmittance of an acoustic plane wave through\n    a metamaterial slab for a suite of test cases.\n    \"\"\"\n    # Define physical constants for the background fluid (air)\n    rho_0 = 1.21  # kg/m^3\n    c_0 = 343.0  # m/s\n    K_0 = rho_0 * c_0**2  # Pa\n    Z_0 = rho_0 * c_0  # Acoustic impedance (Rayls)\n\n    # Define metamaterial resonance frequency\n    w_0 = 2.0 * np.pi * 800.0  # rad/s\n\n    # Construct the test suite of parameter sets (omega, d, F, gamma)\n    test_cases = [\n        # Case A (below resonance)\n        (0.5 * w_0, 0.1, 0.8, 0.05 * w_0),\n        # Case B (near below resonance)\n        (0.99 * w_0, 0.1, 0.8, 0.05 * w_0),\n        # Case C (near above resonance)\n        (1.01 * w_0, 0.1, 0.8, 0.05 * w_0),\n        # Case D (above resonance)\n        (1.5 * w_0, 0.1, 0.8, 0.05 * w_0),\n        # Case E (far above resonance)\n        (3.0 * w_0, 0.1, 0.8, 0.05 * w_0),\n        # Case F (edge: very low damping near above resonance)\n        (1.01 * w_0, 0.1, 0.8, 1.0e-4 * w_0),\n        # Case G (edge: weak coupling near above resonance)\n        (1.01 * w_0, 0.1, 0.1, 0.05 * w_0),\n        # Case H (boundary: zero thickness)\n        (1.2 * w_0, 0.0, 0.8, 0.05 * w_0),\n    ]\n\n    results = []\n    for case in test_cases:\n        w, d, F, gamma = case\n\n        # Step 1: Calculate the complex effective density rho_eff(w)\n        # rho_eff(w) = rho_b * (1 - (F*w^2) / (w^2 - w_0^2 + i*gamma*w))\n        # Assuming base density rho_b = rho_0\n        w2 = w**2\n        w02 = w_0**2\n        numerator = F * w2\n        denominator = (w2 - w02) + 1j * gamma * w\n        \n        # Avoid division by zero, although not expected for real w  0\n        if np.isclose(denominator, 0):\n            # This case shouldn't be reached with the given parameters\n            rho_eff = np.inf\n        else:\n            rho_eff = rho_0 * (1.0 - numerator / denominator)\n\n        # Step 2: Calculate effective impedance and wavenumber\n        # Z_eff = sqrt(rho_eff * K_eff) where K_eff = K_0\n        # k_eff = w * sqrt(rho_eff / K_eff)\n        # Using numpy's sqrt which properly handles complex numbers (principal root)\n        Z_eff = np.sqrt(rho_eff * K_0)\n        k_eff = w * np.sqrt(rho_eff / K_0)\n        \n        # Step 3: Calculate the complex transmission coefficient t(w)\n        # t(w) = 1 / [cos(k_eff*d) + (i/2)*(Z_eff/Z_0 + Z_0/Z_eff)*sin(k_eff*d)]\n        if d == 0.0:\n            # For zero thickness, transmission is perfect (t=1)\n            t = 1.0\n        else:\n            cos_kd = np.cos(k_eff * d)\n            sin_kd = np.sin(k_eff * d)\n            \n            # Impedance mismatch term\n            # Handle potential division by zero if Z_eff is close to zero\n            if np.isclose(Z_eff, 0):\n                # This corresponds to rho-near-zero resonance\n                # The term with Z_0/Z_eff dominates.\n                # In the limit, t(w) = 1 / ( (i/2) * (Z_0/Z_eff) * (k_eff*d) )\n                # Using k_eff/Z_eff = w/K_0, we can find a finite limit\n                # t_inv = (i/2)*Z_0*(w/K_0)*d = i*k_0*d/2 where k_0 = w*Z_0/K_0\n                k0 = w/c_0\n                t_inv = 0.5j * k0 * d\n                t = 1.0 / t_inv\n            else:\n                impedance_term = (Z_eff / Z_0) + (Z_0 / Z_eff)\n                t_inv = cos_kd + 0.5j * impedance_term * sin_kd\n                t = 1.0 / t_inv\n\n        # Step 4: Calculate the power transmittance T(w) = |t(w)|^2\n        T = np.abs(t)**2\n        results.append(T)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}