{
    "hands_on_practices": [
        {
            "introduction": "To understand thermoviscous acoustics, we must first appreciate the length scales over which viscous and thermal diffusion are significant. This exercise  guides you through a foundational derivation of the viscous and thermal penetration depths, $\\delta_{\\nu}$ and $\\delta_{T}$, directly from the linearized governing equations. By calculating these values for air and water, you will develop a concrete understanding of how material properties determine the thickness of these crucial boundary layers.",
            "id": "4146583",
            "problem": "A plane time-harmonic acoustic field of angular frequency $\\omega$ impinges on a rigid, isothermal, planar wall in a quiescent fluid. The no-slip kinematic boundary condition and isothermal thermal boundary condition produce near-wall oscillatory boundary layers in the tangential velocity and temperature fields. Define the viscous penetration depth $\\delta_{\\nu}$ and the thermal penetration depth $\\delta_{T}$ as the characteristic distances from the wall over which the respective oscillation amplitudes decay by a factor $\\exp(-1)$.\n\nStarting only from the linearized governing laws for a Newtonian fluid and Fourier heat conduction, namely Newton’s second law (momentum balance with viscosity) and energy balance with Fourier’s law of heat conduction, and assuming small-amplitude, time-harmonic fields adjacent to the wall, derive closed-form expressions for $\\delta_{\\nu}$ and $\\delta_{T}$ in terms of the kinematic viscosity $\\nu$, the thermal diffusivity $\\alpha$, and the angular frequency $\\omega$. Then, using these expressions, compute $\\delta_{\\nu}$ and $\\delta_{T}$ for dry air and liquid water at $f=1\\,\\mathrm{kHz}$ ($\\omega = 2\\pi f$), taking the following standard property values at $T \\approx 20\\,^{\\circ}\\mathrm{C}$ and $p \\approx 1\\,\\mathrm{atm}$:\n\n- Dry air: mass density $\\rho_{\\mathrm{air}} = 1.204\\,\\mathrm{kg/m^{3}}$, dynamic viscosity $\\mu_{\\mathrm{air}} = 1.81 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$, thermal conductivity $k_{\\mathrm{air}} = 0.0262\\,\\mathrm{W/(m\\cdot K)}$, constant-pressure specific heat $c_{p,\\mathrm{air}} = 1005\\,\\mathrm{J/(kg\\cdot K)}$.\n- Liquid water: mass density $\\rho_{\\mathrm{w}} = 998\\,\\mathrm{kg/m^{3}}$, dynamic viscosity $\\mu_{\\mathrm{w}} = 1.002 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, thermal conductivity $k_{\\mathrm{w}} = 0.598\\,\\mathrm{W/(m\\cdot K)}$, constant-pressure specific heat $c_{p,\\mathrm{w}} = 4182\\,\\mathrm{J/(kg\\cdot K)}$.\n\nUse the definitions $\\nu = \\mu/\\rho$ and $\\alpha = k/(\\rho c_{p})$. Round each numerical value of $\\delta_{\\nu}$ and $\\delta_{T}$ to three significant figures and express all answers in meters. Provide your final numerical results as a single row matrix in the order $\\delta_{\\nu,\\mathrm{air}},\\,\\delta_{T,\\mathrm{air}},\\,\\delta_{\\nu,\\mathrm{w}},\\,\\delta_{T,\\mathrm{w}}$.\n\nFinally, explain—based on your derived expressions and the computed values—how the relative magnitudes of $\\delta_{\\nu}$ and $\\delta_{T}$ differ between air and water, and why this difference arises from the material properties.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- **System**: A plane time-harmonic acoustic field of angular frequency $\\omega$ impinges on a rigid, isothermal, planar wall in a quiescent fluid.\n- **Boundary Conditions**: No-slip kinematic boundary condition and isothermal thermal boundary condition at the wall.\n- **Definitions**:\n    - Viscous penetration depth $\\delta_{\\nu}$: characteristic distance where the tangential velocity oscillation amplitude decays by a factor $\\exp(-1)$.\n    - Thermal penetration depth $\\delta_{T}$: characteristic distance where the temperature oscillation amplitude decays by a factor $\\exp(-1)$.\n- **Governing Physics**: Linearized Newton’s second law (momentum balance with viscosity) and energy balance with Fourier’s law of heat conduction.\n- **Assumptions**: Small-amplitude, time-harmonic fields adjacent to the wall.\n- **Task 1 (Derivation)**: Derive closed-form expressions for $\\delta_{\\nu}$ and $\\delta_{T}$ in terms of kinematic viscosity $\\nu$, thermal diffusivity $\\alpha$, and angular frequency $\\omega$.\n- **Task 2 (Calculation)**: Compute numerical values for $\\delta_{\\nu}$ and $\\delta_{T}$ for dry air and liquid water at $f=1\\,\\mathrm{kHz}$ ($\\omega = 2\\pi f$).\n- **Material Properties (Dry Air at $T \\approx 20\\,^{\\circ}\\mathrm{C}$, $p \\approx 1\\,\\mathrm{atm}$)**:\n    - Mass density: $\\rho_{\\mathrm{air}} = 1.204\\,\\mathrm{kg/m^{3}}$\n    - Dynamic viscosity: $\\mu_{\\mathrm{air}} = 1.81 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}$\n    - Thermal conductivity: $k_{\\mathrm{air}} = 0.0262\\,\\mathrm{W/(m\\cdot K)}$\n    - Constant-pressure specific heat: $c_{p,\\mathrm{air}} = 1005\\,\\mathrm{J/(kg\\cdot K)}$\n- **Material Properties (Liquid Water at $T \\approx 20\\,^{\\circ}\\mathrm{C}$, $p \\approx 1\\,\\mathrm{atm}$)**:\n    - Mass density: $\\rho_{\\mathrm{w}} = 998\\,\\mathrm{kg/m^{3}}$\n    - Dynamic viscosity: $\\mu_{\\mathrm{w}} = 1.002 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\n    - Thermal conductivity: $k_{\\mathrm{w}} = 0.598\\,\\mathrm{W/(m\\cdot K)}$\n    - Constant-pressure specific heat: $c_{p,\\mathrm{w}} = 4182\\,\\mathrm{J/(kg\\cdot K)}$\n- **Auxiliary Definitions**: $\\nu = \\mu/\\rho$, $\\alpha = k/(\\rho c_{p})$.\n- **Output Requirements**: Round numerical results to three significant figures, express in meters, and provide as a single row matrix in the order $\\delta_{\\nu,\\mathrm{air}},\\,\\delta_{T,\\mathrm{air}},\\,\\delta_{\\nu,\\mathrm{w}},\\,\\delta_{T,\\mathrm{w}}$.\n- **Task 3 (Explanation)**: Explain the relative magnitudes of $\\delta_{\\nu}$ and $\\delta_{T}$ for the two fluids based on material properties.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on the linearized Navier-Stokes and energy equations, which are the standard, fundamental models for describing thermoviscous effects in acoustics. The concepts of viscous and thermal boundary layers (or penetration depths) are central to this field. All premises are factually and scientifically sound.\n- **Well-Posed**: The problem is clearly defined. It provides the governing physical principles, boundary conditions, and asks for a derivation and calculation based on these. The provided data is sufficient to obtain a unique solution.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language. All terms are standard within physics and fluid mechanics.\n- **Conclusion**: The problem is self-contained, consistent, and scientifically valid. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The solution will be derived as requested.\n\n### Solution Derivation and Calculation\n\nLet the planar wall be located at $y=0$, with the fluid occupying the half-space $y > 0$. The acoustic wave propagates primarily in the $x$-direction, parallel to the wall. We analyze the viscous and thermal boundary layers that form near this wall.\n\n**1. Viscous Penetration Depth, $\\delta_{\\nu}$**\nThe motion of the fluid tangential to the wall is governed by the diffusion of momentum. For small-amplitude, time-harmonic perturbations, the linearized momentum equation for the tangential velocity component $v_x(y,t)$ in a region where viscous forces are dominant reduces to a one-dimensional diffusion equation:\n$$\n\\frac{\\partial v_x}{\\partial t} = \\nu \\frac{\\partial^2 v_x}{\\partial y^2}\n$$\nwhere $\\nu = \\mu/\\rho$ is the kinematic viscosity. This equation describes the viscous shear wave propagating away from the wall. We assume a time-harmonic solution of the form $v_x(y,t) = \\text{Re}\\{\\hat{v}_x(y) \\exp(-i\\omega t)\\}$, where $\\omega$ is the angular frequency. Substituting this into the governing equation yields an ordinary differential equation for the complex velocity amplitude $\\hat{v}_x(y)$:\n$$\n-i\\omega \\hat{v}_x = \\nu \\frac{d^2 \\hat{v}_x}{dy^2}\n$$\nRearranging gives:\n$$\n\\frac{d^2 \\hat{v}_x}{dy^2} - \\frac{-i\\omega}{\\nu} \\hat{v}_x = 0 \\implies \\frac{d^2 \\hat{v}_x}{dy^2} - k_{\\nu}^2 \\hat{v}_x = 0\n$$\nwhere $k_{\\nu}^2 = -i\\omega/\\nu$. The wavenumber $k_{\\nu}$ is found by taking the square root:\n$$\nk_{\\nu} = \\sqrt{\\frac{-i\\omega}{\\nu}} = \\sqrt{\\frac{\\omega}{\\nu}} \\sqrt{-i} = \\sqrt{\\frac{\\omega}{\\nu}} \\left(\\frac{1-i}{\\sqrt{2}}\\right) = (1-i)\\sqrt{\\frac{\\omega}{2\\nu}}\n$$\nThe general solution for $\\hat{v}_x(y)$ is of the form $C_1 \\exp(k_{\\nu}y) + C_2 \\exp(-k_{\\nu}y)$. For the boundary layer problem, the solution represents a deviation from the bulk (inviscid) flow velocity, $\\hat{v}_{x,\\infty}$. This deviation must decay to zero as $y \\to \\infty$. This physical requirement means we must choose the solution that decays with increasing $y$. The term $\\exp(k_{\\nu}y) = \\exp\\left((1-i)\\sqrt{\\frac{\\omega}{2\\nu}}y\\right)$ grows exponentially as $y\\to\\infty$, so we must discard it. The relevant part of the solution, which describes the oscillatory boundary layer field, has the spatial dependence $\\exp(-k_{\\nu}y)$:\n$$\n\\exp(-k_{\\nu}y) = \\exp\\left(-(1-i)\\sqrt{\\frac{\\omega}{2\\nu}}y\\right) = \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\nu}}y\\right) \\exp\\left(i\\sqrt{\\frac{\\omega}{2\\nu}}y\\right)\n$$\nThe amplitude of this oscillatory field is given by the magnitude of this complex exponential, which is $\\exp\\left(-\\sqrt{\\frac{\\omega}{2\\nu}}y\\right)$. The viscous penetration depth $\\delta_{\\nu}$ is defined as the distance $y$ at which this amplitude decays by a factor of $\\exp(-1)$.\n$$\n\\exp\\left(-\\sqrt{\\frac{\\omega}{2\\nu}}\\delta_{\\nu}\\right) = \\exp(-1)\n$$\nThis implies that the exponent must be equal to $1$:\n$$\n\\sqrt{\\frac{\\omega}{2\\nu}}\\delta_{\\nu} = 1 \\implies \\delta_{\\nu} = \\sqrt{\\frac{2\\nu}{\\omega}}\n$$\n\n**2. Thermal Penetration Depth, $\\delta_{T}$**\nThe analysis for the thermal boundary layer is analogous. The wall is isothermal, meaning temperature fluctuations must vanish at $y=0$. Far from the wall, the temperature fluctuates due to the acoustic pressure wave. Near the wall, heat conduction dominates, and the evolution of the temperature perturbation $T'(y,t)$ is governed by the one-dimensional heat diffusion equation:\n$$\n\\frac{\\partial T'}{\\partial t} = \\alpha \\frac{\\partial^2 T'}{\\partial y^2}\n$$\nwhere $\\alpha = k/(\\rho c_p)$ is the thermal diffusivity. Assuming a time-harmonic solution $T'(y,t) = \\text{Re}\\{\\hat{T}'(y) \\exp(-i\\omega t)\\}$, we obtain the ODE for the complex amplitude $\\hat{T}'(y)$:\n$$\n-i\\omega \\hat{T}' = \\alpha \\frac{d^2 \\hat{T}'}{dy^2} \\implies \\frac{d^2 \\hat{T}'}{dy^2} - \\frac{-i\\omega}{\\alpha} \\hat{T}' = 0\n$$\nThis equation is mathematically identical to the one for $\\hat{v}_x$, with $\\nu$ replaced by $\\alpha$. By direct analogy, the spatial decay of the thermal boundary layer oscillation amplitude is governed by a factor $\\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}y\\right)$. The thermal penetration depth $\\delta_{T}$ is the distance at which this amplitude decays by $\\exp(-1)$:\n$$\n\\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}}\\delta_{T}\\right) = \\exp(-1)\n$$\nThis gives:\n$$\n\\sqrt{\\frac{\\omega}{2\\alpha}}\\delta_{T} = 1 \\implies \\delta_{T} = \\sqrt{\\frac{2\\alpha}{\\omega}}\n$$\n\n**3. Numerical Calculations**\nThe angular frequency is $\\omega = 2\\pi f = 2\\pi(1000\\,\\mathrm{s^{-1}}) = 2000\\pi\\,\\mathrm{rad/s}$.\n\n**For Dry Air:**\nFirst, we compute the material diffusivities.\n- Kinematic viscosity: $\\nu_{\\mathrm{air}} = \\frac{\\mu_{\\mathrm{air}}}{\\rho_{\\mathrm{air}}} = \\frac{1.81 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s}}{1.204\\,\\mathrm{kg/m^{3}}} \\approx 1.5033 \\times 10^{-5}\\,\\mathrm{m^2/s}$.\n- Thermal diffusivity: $\\alpha_{\\mathrm{air}} = \\frac{k_{\\mathrm{air}}}{\\rho_{\\mathrm{air}} c_{p,\\mathrm{air}}} = \\frac{0.0262\\,\\mathrm{W/(m\\cdot K)}}{(1.204\\,\\mathrm{kg/m^{3}})(1005\\,\\mathrm{J/(kg\\cdot K)})} \\approx 2.1652 \\times 10^{-5}\\,\\mathrm{m^2/s}$.\n\nNow, we calculate the penetration depths.\n- $\\delta_{\\nu,\\mathrm{air}} = \\sqrt{\\frac{2\\nu_{\\mathrm{air}}}{\\omega}} = \\sqrt{\\frac{2(1.5033 \\times 10^{-5}\\,\\mathrm{m^2/s})}{2000\\pi\\,\\mathrm{s^{-1}}}} \\approx 6.917 \\times 10^{-5}\\,\\mathrm{m}$.\n  Rounded to three significant figures: $\\delta_{\\nu,\\mathrm{air}} = 6.92 \\times 10^{-5}\\,\\mathrm{m}$.\n- $\\delta_{T,\\mathrm{air}} = \\sqrt{\\frac{2\\alpha_{\\mathrm{air}}}{\\omega}} = \\sqrt{\\frac{2(2.1652 \\times 10^{-5}\\,\\mathrm{m^2/s})}{2000\\pi\\,\\mathrm{s^{-1}}}} \\approx 8.301 \\times 10^{-5}\\,\\mathrm{m}$.\n  Rounded to three significant figures: $\\delta_{T,\\mathrm{air}} = 8.30 \\times 10^{-5}\\,\\mathrm{m}$.\n\n**For Liquid Water:**\nFirst, we compute the material diffusivities.\n- Kinematic viscosity: $\\nu_{\\mathrm{w}} = \\frac{\\mu_{\\mathrm{w}}}{\\rho_{\\mathrm{w}}} = \\frac{1.002 \\times 10^{-3}\\,\\mathrm{Pa\\cdot s}}{998\\,\\mathrm{kg/m^{3}}} \\approx 1.0040 \\times 10^{-6}\\,\\mathrm{m^2/s}$.\n- Thermal diffusivity: $\\alpha_{\\mathrm{w}} = \\frac{k_{\\mathrm{w}}}{\\rho_{\\mathrm{w}} c_{p,\\mathrm{w}}} = \\frac{0.598\\,\\mathrm{W/(m\\cdot K)}}{(998\\,\\mathrm{kg/m^{3}})(4182\\,\\mathrm{J/(kg\\cdot K)})} \\approx 1.4328 \\times 10^{-7}\\,\\mathrm{m^2/s}$.\n\nNow, we calculate the penetration depths.\n- $\\delta_{\\nu,\\mathrm{w}} = \\sqrt{\\frac{2\\nu_{\\mathrm{w}}}{\\omega}} = \\sqrt{\\frac{2(1.0040 \\times 10^{-6}\\,\\mathrm{m^2/s})}{2000\\pi\\,\\mathrm{s^{-1}}}} \\approx 1.788 \\times 10^{-5}\\,\\mathrm{m}$.\n  Rounded to three significant figures: $\\delta_{\\nu,\\mathrm{w}} = 1.79 \\times 10^{-5}\\,\\mathrm{m}$.\n- $\\delta_{T,\\mathrm{w}} = \\sqrt{\\frac{2\\alpha_{\\mathrm{w}}}{\\omega}} = \\sqrt{\\frac{2(1.4328 \\times 10^{-7}\\,\\mathrm{m^2/s})}{2000\\pi\\,\\mathrm{s^{-1}}}} \\approx 6.754 \\times 10^{-6}\\,\\mathrm{m}$.\n  Rounded to three significant figures: $\\delta_{T,\\mathrm{w}} = 6.75 \\times 10^{-6}\\,\\mathrm{m}$.\n\n**4. Explanation of Relative Magnitudes**\nThe derived expressions are $\\delta_{\\nu} = \\sqrt{2\\nu/\\omega}$ and $\\delta_{T} = \\sqrt{2\\alpha/\\omega}$. The ratio of the thermal to viscous penetration depth is:\n$$\n\\frac{\\delta_{T}}{\\delta_{\\nu}} = \\frac{\\sqrt{2\\alpha/\\omega}}{\\sqrt{2\\nu/\\omega}} = \\sqrt{\\frac{\\alpha}{\\nu}}\n$$\nThis ratio depends only on the material properties of the fluid. The dimensionless quantity $\\mathrm{Pr} = \\nu/\\alpha$ is known as the Prandtl number. Therefore, the ratio of the penetration depths can be expressed as:\n$$\n\\frac{\\delta_{T}}{\\delta_{\\nu}} = \\sqrt{\\frac{1}{\\mathrm{Pr}}} = \\frac{1}{\\sqrt{\\mathrm{Pr}}}\n$$\n- **For Air**: The Prandtl number is $\\mathrm{Pr}_{\\mathrm{air}} = \\frac{\\nu_{\\mathrm{air}}}{\\alpha_{\\mathrm{air}}} \\approx \\frac{1.5033 \\times 10^{-5}}{2.1652 \\times 10^{-5}} \\approx 0.694$. Since $\\mathrm{Pr}_{\\mathrm{air}} < 1$, it follows that $\\delta_{T,\\mathrm{air}} > \\delta_{\\nu,\\mathrm{air}}$. Our calculations confirm this: the thermal boundary layer ($83.0\\,\\mathrm{\\mu m}$) is thicker than the viscous boundary layer ($69.2\\,\\mathrm{\\mu m}$). This is because for a gas like air, heat diffuses slightly more effectively than momentum, so the thermal effects penetrate further from the wall.\n\n- **For Water**: The Prandtl number is $\\mathrm{Pr}_{\\mathrm{w}} = \\frac{\\nu_{\\mathrm{w}}}{\\alpha_{\\mathrm{w}}} \\approx \\frac{1.0040 \\times 10^{-6}}{1.4328 \\times 10^{-7}} \\approx 7.01$. Since $\\mathrm{Pr}_{\\mathrm{w}} \\gg 1$, it follows that $\\delta_{T,\\mathrm{w}} \\ll \\delta_{\\nu,\\mathrm{w}}$. Our calculations confirm this: the thermal boundary layer ($6.75\\,\\mathrm{\\mu m}$) is significantly thinner than the viscous boundary layer ($17.9\\,\\mathrm{\\mu m}$). The reason for the large Prandtl number in water stems from its very high specific heat capacity $c_{p,\\mathrm{w}}$. The thermal diffusivity $\\alpha = k/(\\rho c_{p})$ is inversely proportional to $c_p$. Water's ability to store a large amount of thermal energy for a small temperature change makes it a poor thermal diffuser. Consequently, momentum diffuses much more effectively than heat, causing viscous effects to penetrate much further into the fluid than thermal effects.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 6.92 \\times 10^{-5} & 8.30 \\times 10^{-5} & 1.79 \\times 10^{-5} & 6.75 \\times 10^{-6} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Having established the fundamental length scales, we now explore their impact on wave propagation in confined spaces. This practice  challenges you to derive the thermoviscous attenuation coefficient for sound in a microchannel, directly linking energy dissipation in the boundary layers to a measurable macroscopic effect. Comparing the results for air and water will illuminate how fluid properties, particularly the kinematic viscosity $\\nu$ and the Prandtl number $\\mathrm{Pr}$, govern the magnitude of these losses in practical applications.",
            "id": "4146637",
            "problem": "A rigid, straight, circular microchannel of radius $a=50\\ \\mu\\mathrm{m}$ supports plane-wave acoustic propagation at frequency $f=1\\ \\mathrm{MHz}$ driven along its axis. Consider two cases: the microchannel is filled with dry air at $20^{\\circ}\\mathrm{C}$, and, separately, with liquid water at $20^{\\circ}\\mathrm{C}$. Assume thin boundary layers, meaning $\\delta_{\\nu}/a \\ll 1$ and $\\delta_{T}/a \\ll 1$, where the viscous penetration depth is $\\delta_{\\nu}=\\sqrt{2 \\nu / \\omega}$ and the thermal penetration depth is $\\delta_{T}=\\sqrt{2 \\alpha / \\omega}$ with $\\omega=2\\pi f$. The no-slip velocity condition and isothermal wall condition hold at the rigid boundary. The fluids have the following properties at $20^{\\circ}\\mathrm{C}$:\n- Air: kinematic viscosity $\\nu_{\\mathrm{air}}=1.5\\times 10^{-5}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$, Prandtl number $\\mathrm{Pr}_{\\mathrm{air}}=0.71$, ratio of specific heats $\\gamma_{\\mathrm{air}}=1.40$, speed of sound $c_{0,\\mathrm{air}}=343\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$.\n- Water: kinematic viscosity $\\nu_{\\mathrm{water}}=1.0\\times 10^{-6}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$, Prandtl number $\\mathrm{Pr}_{\\mathrm{water}}=7.0$, ratio of specific heats $\\gamma_{\\mathrm{water}}=1.00$, speed of sound $c_{0,\\mathrm{water}}=1480\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$.\n\nStarting from the linearized compressible Navier–Stokes equations with viscosity and the linearized energy equation with Fourier heat conduction, together with the ideal acoustic constitutive relations, derive the leading-order thermoviscous attenuation coefficient per unit length, $α$, for plane-wave propagation in the thin-boundary-layer limit in a rigid circular microchannel, expressed in terms of the fluid properties $ν$, $\\mathrm{Pr}$, $c_{0}$, and $γ$, the channel radius $a$, and the angular frequency $ω$. Use this expression to compute the ratio\n$$\nR \\equiv \\frac{\\alpha_{\\mathrm{air}}}{\\alpha_{\\mathrm{water}}}.\n$$\nExplain, within your derivation, how the Prandtl number $\\mathrm{Pr}$ and viscosity (via $ν$) modulate thermoviscous damping. Round your final ratio $R$ to three significant figures. Do not include units with your final boxed answer; the ratio is dimensionless.",
            "solution": "The problem statement is evaluated for validity before attempting a solution.\n\n### Step 1: Extract Givens\n- Geometry: Rigid, straight, circular microchannel, radius $a=50\\ \\mu\\mathrm{m}$.\n- Wave: Plane-wave acoustic propagation along the axis.\n- Frequency: $f=1\\ \\mathrm{MHz}$.\n- Fluids: Dry air at $20^{\\circ}\\mathrm{C}$, liquid water at $20^{\\circ}\\mathrm{C}$.\n- Assumption: Thin boundary layers, $\\delta_{\\nu}/a \\ll 1$ and $\\delta_{T}/a \\ll 1$.\n- Definitions: Viscous penetration depth $\\delta_{\\nu}=\\sqrt{2 \\nu / \\omega}$, thermal penetration depth $\\delta_{T}=\\sqrt{2 \\alpha / \\omega}$, angular frequency $\\omega=2\\pi f$.\n- Boundary conditions: No-slip velocity, isothermal wall.\n- Air properties ($20^{\\circ}\\mathrm{C}$):\n  - Kinematic viscosity: $\\nu_{\\mathrm{air}}=1.5\\times 10^{-5}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$\n  - Prandtl number: $\\mathrm{Pr}_{\\mathrm{air}}=0.71$\n  - Ratio of specific heats: $\\gamma_{\\mathrm{air}}=1.40$\n  - Speed of sound: $c_{0,\\mathrm{air}}=343\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n- Water properties ($20^{\\circ}\\mathrm{C}$):\n  - Kinematic viscosity: $\\nu_{\\mathrm{water}}=1.0\\times 10^{-6}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$\n  - Prandtl number: $\\mathrm{Pr}_{\\mathrm{water}}=7.0$\n  - Ratio of specific heats: $\\gamma_{\\mathrm{water}}=1.00$\n  - Speed of sound: $c_{0,\\mathrm{water}}=1480\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n- Task:\n  1. Derive the leading-order thermoviscous attenuation coefficient per unit length, $\\alpha$, in terms of $\\nu$, $\\mathrm{Pr}$, $c_{0}$, $\\gamma$, $a$, and $\\omega$.\n  2. Explain the roles of $\\mathrm{Pr}$ and $\\nu$.\n  3. Compute the ratio $R \\equiv \\alpha_{\\mathrm{air}}/\\alpha_{\\mathrm{water}}$.\n  4. Round $R$ to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing the well-established phenomenon of thermoviscous acoustic attenuation in a duct. The theoretical framework requested—linearized Navier–Stokes and energy equations—is standard for this analysis. All physical constants and fluid properties provided are realistic for the specified conditions. The assumption of thin boundary layers is explicitly given and is a standard simplification (the Kirchhoff approximation) leading to a well-posed problem. Let's verify this assumption with the given data. $\\omega=2\\pi f = 2\\pi \\times 10^6\\ \\mathrm{rad/s}$ and $a=50 \\times 10^{-6}\\ \\mathrm{m}$.\nFor air: $\\delta_{\\nu, \\text{air}}=\\sqrt{2(1.5\\times 10^{-5})/(2\\pi \\times 10^6)} \\approx 2.18\\ \\mu\\mathrm{m}$, so $\\delta_{\\nu, \\text{air}}/a \\approx 0.044 \\ll 1$. The thermal depth is $\\delta_{T, \\text{air}} = \\delta_{\\nu, \\text{air}}/\\sqrt{\\mathrm{Pr}_{\\mathrm{air}}} \\approx 2.59\\ \\mu\\mathrm{m}$, so $\\delta_{T, \\text{air}}/a \\approx 0.052 \\ll 1$.\nFor water: $\\delta_{\\nu, \\text{water}}=\\sqrt{2(1.0\\times 10^{-6})/(2\\pi \\times 10^6)} \\approx 0.564\\ \\mu\\mathrm{m}$, so $\\delta_{\\nu, \\text{water}}/a \\approx 0.011 \\ll 1$. The thermal depth is $\\delta_{T, \\text{water}} = \\delta_{\\nu, \\text{water}}/\\sqrt{\\mathrm{Pr}_{\\mathrm{water}}} \\approx 0.213\\ \\mu\\mathrm{m}$, so $\\delta_{T, \\text{water}}/a \\approx 0.004 \\ll 1$.\nThe thin-boundary-layer assumption is internally consistent with the provided data. The problem is complete, objective, and well-posed. The fact that $\\gamma_{\\mathrm{water}}=1.00$ is a reasonable approximation for water, where the specific heats at constant pressure and volume are nearly equal.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\nThe attenuation of a plane acoustic wave in a duct is caused by irreversible energy loss mechanisms occurring at the fluid-wall interface. In this case, these are viscous drag due to the no-slip condition and heat transfer due to the isothermal wall condition. The attenuation coefficient, $\\alpha$, can be derived by calculating the power dissipated per unit length and relating it to the power carried by the wave.\n\nThe time-averaged acoustic energy flux (power) $\\mathcal{P}$ of a plane wave in a duct of cross-sectional area $S$ is\n$$ \\mathcal{P} = \\frac{S}{2\\rho_0 c_0} |\\hat{p}|^2 $$\nwhere $\\hat{p}$ is the complex pressure amplitude, $\\rho_0$ is the mean fluid density, and $c_0$ is the ideal speed of sound.\nThe attenuation coefficient $\\alpha$ is defined by the spatial decay of power, $\\mathcal{P}(x) = \\mathcal{P}(0) \\exp(-2\\alpha x)$. This gives\n$$ \\alpha = \\frac{-d\\mathcal{P}/dx}{2\\mathcal{P}} $$\nwhere $-d\\mathcal{P}/dx$ is the power dissipated per unit length of the duct. The total dissipation is the sum of viscous dissipation $D_{\\text{visc}}$ and thermal dissipation $D_{\\text{therm}}$.\n\n1.  **Viscous Dissipation**: The no-slip condition creates a thin viscous boundary layer of characteristic thickness $\\delta_\\nu = \\sqrt{2\\nu/\\omega}$. The power dissipated per unit area of the wall due to shear stress can be calculated, and the total viscous dissipation per unit length of duct (perimeter $P$) is found to be:\n    $$ D_{\\text{visc}} = \\frac{P |\\hat{p}|^2}{2 \\rho_0 c_0^2} \\sqrt{\\frac{\\nu\\omega}{2}} $$\n\n2.  **Thermal Dissipation**: The isothermal wall condition creates a thermal boundary layer of thickness $\\delta_T = \\sqrt{2\\alpha/\\omega}$. The compression and expansion cycles of the acoustic wave cause temperature fluctuations in the core flow, which drive irreversible heat conduction into the wall. The resulting thermal dissipation per unit length can be shown to be:\n    $$ D_{\\text{therm}} = \\frac{P |\\hat{p}|^2}{2 \\rho_0 c_0^2} \\frac{(\\gamma-1)}{\\sqrt{\\mathrm{Pr}}} \\sqrt{\\frac{\\nu\\omega}{2}} $$\n    where we have used the relation $\\alpha = \\nu/\\mathrm{Pr}$.\n\nThe total power dissipated per unit length is $-d\\mathcal{P}/dx = D_{\\text{visc}} + D_{\\text{therm}}$:\n$$ -\\frac{d\\mathcal{P}}{dx} = \\frac{P |\\hat{p}|^2}{2 \\rho_0 c_0^2} \\sqrt{\\frac{\\nu\\omega}{2}} \\left( 1 + \\frac{\\gamma-1}{\\sqrt{\\mathrm{Pr}}} \\right) $$\nNow we find the attenuation coefficient $\\alpha$:\n$$ \\alpha = \\frac{-d\\mathcal{P}/dx}{2\\mathcal{P}} = \\frac{\\frac{P |\\hat{p}|^2}{2 \\rho_0 c_0^2} \\sqrt{\\frac{\\nu\\omega}{2}} \\left( 1 + \\frac{\\gamma-1}{\\sqrt{\\mathrm{Pr}}} \\right)}{2 \\frac{S|\\hat{p}|^2}{2\\rho_0 c_0}} = \\frac{P}{2S} \\frac{1}{c_0} \\sqrt{\\frac{\\nu\\omega}{2}} \\left( 1 + \\frac{\\gamma-1}{\\sqrt{\\mathrm{Pr}}} \\right) $$\nFor a circular channel of radius $a$, the perimeter is $P=2\\pi a$ and the area is $S=\\pi a^2$, so $P/(2S) = (2\\pi a)/(2\\pi a^2) = 1/a$.\nThe final expression for the attenuation coefficient is:\n$$ \\alpha = \\frac{1}{a c_0} \\sqrt{\\frac{\\nu\\omega}{2}} \\left( 1 + \\frac{\\gamma-1}{\\sqrt{\\mathrm{Pr}}} \\right) $$\nThis is the required leading-order expression for thermoviscous attenuation.\n\nThe roles of kinematic viscosity $\\nu$ and Prandtl number $\\mathrm{Pr}$ in thermoviscous damping are as follows:\n- **Kinematic Viscosity ($\\nu$)**: The term $\\sqrt{\\nu}$ appears in the overall prefactor, affecting both viscous and thermal loss terms. Viscosity is the direct cause of fluid friction. An increase in $\\nu$ leads to stronger shear forces in the viscous boundary layer, increasing the rate at which acoustic kinetic energy is converted into heat. This directly increases the viscous contribution to damping. Because thermal diffusivity $\\alpha = \\nu/\\mathrm{Pr}$, $\\nu$ also influences the thermal damping. Overall, attenuation $\\alpha$ is proportional to $\\sqrt{\\nu}$.\n- **Prandtl Number ($\\mathrm{Pr}$)**: The Prandtl number, $\\mathrm{Pr} = \\nu/\\alpha$, represents the ratio of momentum diffusivity to thermal diffusivity. It controls the relative importance of thermal dissipation compared to viscous dissipation. The thermal loss term is proportional to $(\\gamma-1)/\\sqrt{\\mathrm{Pr}}$. For a fixed $\\gamma > 1$, a smaller $\\mathrm{Pr}$ means thermal effects diffuse over a larger distance compared to viscous effects ($\\delta_T > \\delta_\\nu$), leading to a greater thermal contribution to the total attenuation. For fluids with $\\gamma \\approx 1$ (like water) or very large $\\mathrm{Pr}$, the thermal loss becomes negligible.\n\nNow, we compute the ratio $R \\equiv \\alpha_{\\mathrm{air}}/\\alpha_{\\mathrm{water}}$.\n$$ R = \\frac{\\alpha_{\\mathrm{air}}}{\\alpha_{\\mathrm{water}}} = \\frac{\\frac{1}{a c_{0,\\mathrm{air}}} \\sqrt{\\frac{\\nu_{\\mathrm{air}} \\omega}{2}} \\left( 1 + \\frac{\\gamma_{\\mathrm{air}}-1}{\\sqrt{\\mathrm{Pr}_{\\mathrm{air}}}} \\right)}{\\frac{1}{a c_{0,\\mathrm{water}}} \\sqrt{\\frac{\\nu_{\\mathrm{water}} \\omega}{2}} \\left( 1 + \\frac{\\gamma_{\\mathrm{water}}-1}{\\sqrt{\\mathrm{Pr}_{\\mathrm{water}}}} \\right)} $$\nThe common terms $a$, $\\omega$, and $\\sqrt{2}$ cancel, yielding:\n$$ R = \\left(\\frac{c_{0,\\mathrm{water}}}{c_{0,\\mathrm{air}}}\\right) \\sqrt{\\frac{\\nu_{\\mathrm{air}}}{\\nu_{\\mathrm{water}}}} \\frac{\\left( 1 + \\frac{\\gamma_{\\mathrm{air}}-1}{\\sqrt{\\mathrm{Pr}_{\\mathrm{air}}}} \\right)}{\\left( 1 + \\frac{\\gamma_{\\mathrm{water}}-1}{\\sqrt{\\mathrm{Pr}_{\\mathrm{water}}}} \\right)} $$\nSubstitute the given numerical values:\n- For the numerator (air):\n  - $c_{0,\\mathrm{air}} = 343\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n  - $\\nu_{\\mathrm{air}} = 1.5\\times 10^{-5}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$\n  - $\\gamma_{\\mathrm{air}} = 1.40$\n  - $\\mathrm{Pr}_{\\mathrm{air}} = 0.71$\n- For the denominator (water):\n  - $c_{0,\\mathrm{water}} = 1480\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n  - $\\nu_{\\mathrm{water}} = 1.0\\times 10^{-6}\\ \\mathrm{m}^{2}\\ \\mathrm{s}^{-1}$\n  - $\\gamma_{\\mathrm{water}} = 1.00$\n  - $\\mathrm{Pr}_{\\mathrm{water}} = 7.0$\n\nCalculate each part of the ratio:\n- Speed of sound ratio: $\\frac{c_{0,\\mathrm{water}}}{c_{0,\\mathrm{air}}} = \\frac{1480}{343}$\n- Viscosity ratio: $\\sqrt{\\frac{\\nu_{\\mathrm{air}}}{\\nu_{\\mathrm{water}}}} = \\sqrt{\\frac{1.5\\times 10^{-5}}{1.0\\times 10^{-6}}} = \\sqrt{15}$\n- Air's thermoviscous factor: $1 + \\frac{1.40 - 1}{\\sqrt{0.71}} = 1 + \\frac{0.40}{\\sqrt{0.71}}$\n- Water's thermoviscous factor: $1 + \\frac{1.00 - 1}{\\sqrt{7.0}} = 1 + 0 = 1$\n\nNow combine these parts:\n$$ R = \\left(\\frac{1480}{343}\\right) \\sqrt{15} \\left( 1 + \\frac{0.40}{\\sqrt{0.71}} \\right) $$\n$$ R \\approx (4.31487) \\times (3.87298) \\times \\left( 1 + \\frac{0.40}{0.84261} \\right) $$\n$$ R \\approx (16.7087) \\times (1 + 0.47473) $$\n$$ R \\approx (16.7087) \\times (1.47473) \\approx 24.6495 $$\nRounding to three significant figures, the ratio is $24.6$.",
            "answer": "$$\\boxed{24.6}$$"
        },
        {
            "introduction": "For efficient numerical simulation, explicitly resolving thin boundary layers is often computationally prohibitive. This practice  introduces the powerful concept of effective medium theory, where the complex physics of thermoviscous boundary layers are absorbed into frequency-dependent complex material parameters, such as the effective density $ \\rho(\\omega) $ and bulk modulus $ K(\\omega) $. By implementing and testing a reduced-order model against a reference solution, you will gain hands-on experience with a cornerstone technique in computational acoustics for modeling wave propagation in ducts and porous materials.",
            "id": "4146621",
            "problem": "Consider a thermoviscous plane-wave propagation problem in a rigid, rectangular, parallel-plate channel of length $L$ and half-gap $a$ (total height $2a$) filled with air at rest. The analysis domain is the axial direction $x$, and the cross-section is uniform along $x$. The channel walls are rigid and impose a no-slip boundary condition on the fluid velocity and an isothermal boundary condition on the temperature at the walls. Assume small-amplitude, time-harmonic fields with angular frequency $\\omega$ and no mean flow. The objective is to implement and test a reduced-order model that captures thermoviscous effects via complex, frequency-dependent material parameters $ \\rho(\\omega) $ and $ K(\\omega) $, and to compare its predictions against a reference solution obtained from the full coupled pressure–temperature model in the benchmark geometry.\n\nStart from the following fundamental base valid for small-amplitude acoustics with thermoviscous effects:\n- Linearized continuity, linearized momentum (including viscous stress), and linearized energy equations with Fourier heat conduction, along with the linearized ideal gas equation of state, all for a Newtonian fluid. These equations form a coupled set of partial differential equations that determine the pressure, velocity, density, and temperature perturbations.\n- Known physical properties of air at ambient conditions: density $ \\rho_0 $, dynamic viscosity $ \\eta $, isobaric specific heat $ c_p $, thermal conductivity $ \\kappa $, heat capacity ratio $ \\gamma $, and ambient pressure $ p_0 $. The kinematic viscosity is $ \\nu = \\eta / \\rho_0 $, and the thermal diffusivity is $ \\alpha = \\kappa / (\\rho_0 c_p) $.\n\nIn a parallel-plate channel, viscous and thermal boundary layers of characteristic thicknesses $ \\delta_v = \\sqrt{2 \\nu / \\omega} $ and $ \\delta_t = \\sqrt{2 \\alpha / \\omega} $ arise near the walls. Cross-sectional averaging of the full coupled model in this geometry yields frequency-dependent corrections to inertia and compressibility that are encoded by complex functions of the non-dimensional parameters $ \\xi_v = (1 + i)\\, a / \\delta_v $ and $ \\xi_t = (1 + i)\\, a / \\delta_t $. These corrections lead to an effective complex density $ \\rho(\\omega) $ and a complex bulk modulus $ K(\\omega) $; the reduced-order one-dimensional propagation model uses these quantities in place of the inviscid $ \\rho_0 $ and $ K_0 $ and captures thermoviscous dispersion and attenuation without explicitly resolving transverse fields.\n\nYour tasks are:\n1. Derive, from the fundamental base, how viscous and thermal boundary layers in a parallel-plate channel modify inertia and compressibility, resulting in complex effective material parameters $ \\rho(\\omega) $ and $ K(\\omega) $ that depend on $ \\xi_v $ and $ \\xi_t $ through viscous and thermal correction functions. Explain why the isothermal wall boundary condition leads to frequency-dependent transition between isothermal and adiabatic compressibility, and how the no-slip condition leads to frequency-dependent inertial loading.\n2. Implement two models for a uniform line terminated by a rigid end (zero velocity at $x=L$):\n   - A reduced-order model that uses complex, frequency-dependent $ \\rho(\\omega) $ and $ K(\\omega) $ obtained from rational approximations of the viscous and thermal correction functions that retain correct asymptotic behavior as $ \\omega \\to 0 $ and $ \\omega \\to \\infty $ but avoid solving the full coupled fields.\n   - A reference model that uses the exact correction functions for the parallel-plate geometry obtained by solving the coupled pressure–temperature problem in the transverse direction. Treat this exact formulation as the ground truth for the benchmark geometry.\n3. For each model, compute the characteristic impedance $ Z_c(\\omega) $ and axial wavenumber $ k(\\omega) $ and then the input impedance at $ x=0 $ for a rigid termination at $ x=L $, given by the uniform-line formula\n   $$\n   Z_{\\mathrm{in}}(\\omega) = - i\\, Z_c(\\omega)\\, \\cot( k(\\omega)\\, L )\n   $$\n   with complex $ Z_c(\\omega) $ and $ k(\\omega) $ from each model.\n4. Define the error metric as the relative complex impedance error\n   $$\n   e = \\frac{\\left| Z_{\\mathrm{in,red}} - Z_{\\mathrm{in,ref}} \\right|}{\\left| Z_{\\mathrm{in,ref}} \\right|}\n   $$\n   (dimensionless). For each test case, report $ e $ as a floating-point number.\n\nUse the following air properties (assumed constants, scientifically standard for approximately $20\\,^\\circ\\mathrm{C}$): $ \\rho_0 = 1.204\\,\\mathrm{kg/m^3} $, $ \\eta = 1.84 \\times 10^{-5}\\,\\mathrm{Pa\\cdot s} $, $ c_p = 1007\\,\\mathrm{J/(kg\\cdot K)} $, $ \\kappa = 0.0257\\,\\mathrm{W/(m\\cdot K)} $, $ \\gamma = 1.4 $, $ p_0 = 101325\\,\\mathrm{Pa} $. The speed of sound is $ c_0 = \\sqrt{\\gamma p_0 / \\rho_0} $ but is not directly used in the reduced-order formulation. The kinematic viscosity is $ \\nu = \\eta / \\rho_0 $, and the thermal diffusivity is $ \\alpha = \\kappa / (\\rho_0 c_p) $.\n\nImplement the reduced-order model using rational approximations for the correction functions as follows. Let $ \\xi $ represent either $ \\xi_v $ or $ \\xi_t $. Use the approximation $ F_{\\mathrm{approx}}(\\xi) = \\dfrac{\\xi^2 / 3}{1 + \\xi^2 / 3} $, which matches the low-frequency series $ F(\\xi) \\sim \\xi^2/3 $ and the high-frequency limit $ F(\\xi) \\to 1 $ for the parallel-plate geometry. Use $ F_{\\mathrm{approx}}(\\xi_v) $ for viscous corrections and $ F_{\\mathrm{approx}}(\\xi_t) $ for thermal corrections.\n\nUse the reference model based on the exact parallel-plate correction functions derived from the full coupled pressure–temperature solution in the transverse direction. In this benchmark geometry, these functions are $ F_v(\\xi_v) $ and $ F_t(\\xi_t) $ with $ F(\\xi) = 1 - \\tanh(\\xi)/\\xi $. From these, obtain the exact complex effective density $ \\rho(\\omega) $ and bulk modulus $ K(\\omega) $ for the reference model.\n\nFor both models, define\n- Complex effective density $ \\rho(\\omega) = \\rho_0 / F_v $.\n- Complex effective bulk modulus $ K(\\omega) = \\dfrac{\\gamma p_0}{1 + (\\gamma - 1)\\, (1 - F_t)} $.\n- Characteristic impedance $ Z_c(\\omega) = \\sqrt{ \\rho(\\omega)\\, K(\\omega) } $.\n- Wavenumber $ k(\\omega) = \\omega\\, \\sqrt{ \\rho(\\omega) / K(\\omega) } $.\n\nUse the following test suite to assess model accuracy. Each test case is a triple $ (L, a, f) $ with length $L$ in meters, half-gap $a$ in meters, and frequency $f$ in hertz:\n- Case $1$: $ (0.1, 0.0005, 200) $.\n- Case $2$: $ (0.1, 0.0005, 2000) $.\n- Case $3$: $ (0.02, 0.0001, 500) $.\n- Case $4$: $ (0.2, 0.0015, 50) $.\n- Case $5$: $ (0.05, 0.0005, 10000) $.\n\nCompute $ \\omega = 2\\pi f $ (in radians per second). For each case, compute $ Z_{\\mathrm{in}} $ using the reduced-order model and using the reference model, then compute the error metric $ e $ as defined above. All intermediate computations must be performed in the International System of Units (SI). The final outputs are dimensionless.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each floating-point error $ e $ rounded to six decimal places, in the order of the test cases given above (for example, $ [e_1,e_2,e_3,e_4,e_5] $). Angles, where applicable, must be handled in radians. No external input is permitted, and no data other than the constants and test suite specified here may be used.",
            "solution": "The problem requires an analysis and implementation of two models for thermoviscous acoustic wave propagation in a parallel-plate channel. The first is a reduced-order model (ROM) based on a rational approximation of the viscous and thermal effects, and the second is a reference model based on the exact solution for this specific geometry. The goal is to quantify the error of the ROM.\n\nFirst, the physical principles underlying the thermoviscous effects must be elucidated. The analysis starts from the linearized equations for conservation of mass, momentum, and energy for a Newtonian fluid, coupled with the equation of state. In the absence of viscosity and thermal conductivity, sound propagation is an isentropic process governed by the simple wave equation, characterized by the constant real-valued density $\\rho_0$ and adiabatic bulk modulus $K_a = \\gamma p_0$. The presence of viscous and thermal boundary layers at the channel walls introduces dissipation and dispersion, which can be modeled by replacing $\\rho_0$ and $K_a$ with complex, frequency-dependent effective parameters, $\\rho(\\omega)$ and $K(\\omega)$.\n\n**1. Derivation and Physical Explanation of Effective Parameters**\n\nThe emergence of effective parameters is a direct consequence of the boundary conditions imposed by the walls.\n\n**Viscous Effects and Effective Density $\\rho(\\omega)$**: The no-slip boundary condition dictates that the fluid velocity must be zero at the stationary channel walls. In a time-harmonic pressure field oscillating with angular frequency $\\omega$, this creates a velocity profile across the channel that is non-uniform. A thin viscous boundary layer, with a characteristic thickness $\\delta_v = \\sqrt{2 \\nu / \\omega}$ (where $\\nu = \\eta / \\rho_0$ is the kinematic viscosity), forms near each wall. Within this layer, high velocity gradients exist, leading to shear stresses that dissipate acoustic energy.\n\nFrom a macroscopic perspective, the oscillating pressure gradient must accelerate the fluid against both its own inertia and these viscous shear forces. The fluid within the boundary layer, being \"stuck\" to the wall, moves with a smaller amplitude and a different phase compared to the fluid in the central core of the channel. When averaging the velocity across the channel's cross-section, this lag and damping manifest as an increase in the effective inertia of the fluid. The fluid behaves as if it were denser. This is captured by the complex effective density $\\rho(\\omega) = \\rho_0 / F_v(\\xi_v)$.\n\nThe viscous correction function, $F_v(\\xi_v)$, relates the cross-sectionally averaged velocity to the axial pressure gradient. The non-dimensional parameter $\\xi_v = (1 + i) a / \\delta_v$ compares the channel half-gap $a$ to the viscous boundary layer thickness $\\delta_v$.\n- At low frequencies ($\\omega \\to 0$), $\\delta_v \\gg a$, and the flow profile is fully developed and parabolic (Poiseuille flow). $F_v \\to 0$, causing $\\rho(\\omega)$ to become very large, signifying high viscous resistance.\n- At high frequencies ($\\omega \\to \\infty$), $\\delta_v \\ll a$, the boundary layer is very thin, and the core flow is nearly uniform and inviscid. $F_v \\to 1$, and thus $\\rho(\\omega) \\to \\rho_0$.\nThe imaginary part of $\\rho(\\omega)$ accounts for the phase difference between pressure gradient and velocity, representing viscous dissipation.\n\n**Thermal Effects and Effective Bulk Modulus $K(\\omega)$**: The isothermal boundary condition dictates that the temperature perturbation is zero at the walls. During the compression phase of an acoustic wave, the fluid temperature rises; during rarefaction, it falls. This temperature difference between the fluid and the wall drives heat conduction. A thermal boundary layer of characteristic thickness $\\delta_t = \\sqrt{2 \\alpha / \\omega}$ (where $\\alpha = \\kappa / (\\rho_0 c_p)$ is the thermal diffusivity) forms near each wall. The heat exchange within this layer is an irreversible process that dissipates acoustic energy and modifies the thermodynamic behavior of the fluid.\n\nThe effective bulk modulus $K(\\omega)$ describes the relationship between pressure and density changes and captures the transition between two thermodynamic limits:\n- At low frequencies ($\\omega \\to 0$), $\\delta_t \\gg a$, and there is sufficient time for heat to diffuse across the entire channel. The temperature remains nearly constant and equal to the wall temperature throughout the cross-section. The process is almost purely isothermal, and the effective bulk modulus approaches the isothermal bulk modulus, $K_T = p_0$.\n- At high frequencies ($\\omega \\to \\infty$), $\\delta_t \\ll a$, the thermal boundary layer is very thin. The core of the fluid undergoes compression and rarefaction with negligible heat exchange with the walls. The process is nearly adiabatic, and the effective bulk modulus approaches the adiabatic bulk modulus, $K_a = \\gamma p_0$.\n\nThe provided formula for the effective bulk modulus, $K(\\omega) = \\dfrac{\\gamma p_0}{1 + (\\gamma - 1)(1 - F_t(\\xi_t))}$, correctly models this transition. The thermal correction function $F_t(\\xi_t)$ depends on the non-dimensional parameter $\\xi_t = (1 + i) a / \\delta_t$. As frequency increases from $0$ to $\\infty$, $F_t$ transitions from $0$ to $1$.\n- For $\\omega \\to 0$, $F_t \\to 0$, so $K(\\omega) \\to \\frac{\\gamma p_0}{1 + (\\gamma - 1)(1)} = p_0$ (isothermal limit).\n- For $\\omega \\to \\infty$, $F_t \\to 1$, so $K(\\omega) \\to \\frac{\\gamma p_0}{1 + (\\gamma - 1)(0)} = \\gamma p_0$ (adiabatic limit).\n\n**2. Model Implementation and Calculation**\n\nThe problem specifies two models for the correction functions $F_v$ and $F_t$. For both models, the subsequent calculations for $\\rho(\\omega)$, $K(\\omega)$, characteristic impedance $Z_c(\\omega)$, wavenumber $k(\\omega)$, and input impedance $Z_{\\mathrm{in}}(\\omega)$ follow the same path.\n\n**Reference Model**: This model uses the exact analytical solution for the parallel-plate geometry:\n$$F(\\xi) = 1 - \\frac{\\tanh(\\xi)}{\\xi}$$\nwhere $\\xi$ is either $\\xi_v$ or $\\xi_t$. This function is applied to compute $F_{v,\\mathrm{ref}}$ and $F_{t,\\mathrm{ref}}$.\n\n**Reduced-Order Model (ROM)**: This model employs a rational approximation for the correction function:\n$$F_{\\mathrm{approx}}(\\xi) = \\frac{\\xi^2 / 3}{1 + \\xi^2 / 3}$$\nThis function is a simple algebraic form that correctly reproduces the low-frequency asymptotic behavior ($F(\\xi) \\sim \\xi^2/3$ as $\\xi \\to 0$) and the high-frequency limit ($F(\\xi) \\to 1$ as $|\\xi| \\to \\infty$) of the exact function for the parallel-plate geometry. It is used to compute $F_{v,\\mathrm{red}}$ and $F_{t,\\mathrm{red}}$.\n\n**Acoustic Line Parameters**: With the effective material properties determined, the channel is treated as a one-dimensional waveguide. The characteristic impedance $Z_c(\\omega)$ and the wavenumber $k(\\omega)$ are given by:\n$$Z_c(\\omega) = \\sqrt{\\rho(\\omega) K(\\omega)}$$\n$$k(\\omega) = \\omega \\sqrt{\\frac{\\rho(\\omega)}{K(\\omega)}}$$\nThese quantities are complex, with their real and imaginary parts representing the dispersive and dissipative nature of the wave propagation.\n\n**Input Impedance**: For a uniform acoustic line of length $L$ terminated by a rigid end (zero velocity, equivalent to an infinite impedance), the input impedance at the entrance ($x=0$) is given by the standard transmission line formula:\n$$Z_{\\mathrm{in}}(\\omega) = -i Z_c(\\omega) \\cot(k(\\omega) L)$$\nThe cotangent function, $\\cot(z) = 1/\\tan(z)$, is used here.\n\n**Computational Procedure**:\nFor each test case $(L, a, f)$:\n1. Calculate the physical constants: $\\nu = \\eta/\\rho_0$ and $\\alpha = \\kappa/(\\rho_0 c_p)$.\n2. Calculate the angular frequency: $\\omega = 2\\pi f$.\n3. Compute the boundary layer thicknesses $\\delta_v$ and $\\delta_t$.\n4. Compute the non-dimensional parameters $\\xi_v$ and $\\xi_t$.\n5. For the reference model:\n   a. Calculate $F_{v,\\mathrm{ref}}$ and $F_{t,\\mathrm{ref}}$ using $F(\\xi) = 1 - \\tanh(\\xi)/\\xi$.\n   b. Calculate $\\rho_{\\mathrm{ref}}(\\omega)$, $K_{\\mathrm{ref}}(\\omega)$, $Z_{c,\\mathrm{ref}}(\\omega)$, and $k_{\\mathrm{ref}}(\\omega)$.\n   c. Calculate the input impedance $Z_{\\mathrm{in,ref}}$.\n6. For the reduced-order model:\n   a. Calculate $F_{v,\\mathrm{red}}$ and $F_{t,\\mathrm{red}}$ using $F_{\\mathrm{approx}}(\\xi) = (\\xi^2/3)/(1+\\xi^2/3)$.\n   b. Calculate $\\rho_{\\mathrm{red}}(\\omega)$, $K_{\\mathrm{red}}(\\omega)$, $Z_{c,\\mathrm{red}}(\\omega)$, and $k_{\\mathrm{red}}(\\omega)$.\n   c. Calculate the input impedance $Z_{\\mathrm{in,red}}$.\n7. Compute the relative error: $e = |Z_{\\mathrm{in,red}} - Z_{\\mathrm{in,ref}}| / |Z_{\\mathrm{in,ref}}|$.\n\nThis structured procedure allows for a direct comparison of the impedance predicted by the computationally inexpensive rational approximation against the benchmark solution for the specified geometry. The resulting error $e$ quantifies the accuracy of this common reduced-order modeling approach.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the thermoviscous acoustic problem by comparing a reduced-order model\n    to a reference model for a set of test cases.\n    \"\"\"\n    \n    # Physical properties of air at ambient conditions (SI units)\n    rho_0 = 1.204  # kg/m^3\n    eta = 1.84e-5  # Pa.s\n    c_p = 1007.0  # J/(kg.K)\n    kappa = 0.0257  # W/(m.K)\n    gamma = 1.4  # dimensionless\n    p_0 = 101325.0  # Pa\n\n    # Derived fluid properties\n    nu = eta / rho_0  # Kinematic viscosity, m^2/s\n    alpha = kappa / (rho_0 * c_p)  # Thermal diffusivity, m^2/s\n\n    # Test suite: (L, a, f)\n    # L: length in meters\n    # a: half-gap in meters\n    # f: frequency in Hertz\n    test_cases = [\n        (0.1, 0.0005, 200),\n        (0.1, 0.0005, 2000),\n        (0.02, 0.0001, 500),\n        (0.2, 0.0015, 50),\n        (0.05, 0.0005, 10000),\n    ]\n\n    results = []\n    \n    # --- Model Functions ---\n\n    def F_exact(xi):\n        \"\"\"Exact correction function for parallel-plate channels.\"\"\"\n        # Handle xi=0 case to avoid division by zero, although f>0 ensures xi!=0.\n        if xi == 0:\n            return 0.0\n        return 1.0 - np.tanh(xi) / xi\n\n    def F_approx(xi):\n        \"\"\"Rational approximation for the correction function.\"\"\"\n        s = xi**2 / 3.0\n        return s / (1.0 + s)\n\n    def calculate_impedance(L, a, f, F_func):\n        \"\"\"\n        Calculates the input impedance for a given model.\n        Args:\n            L (float): Channel length.\n            a (float): Channel half-gap.\n            f (float): Frequency.\n            F_func (function): The correction function to use (exact or approx).\n        Returns:\n            complex: The input impedance Zin.\n        \"\"\"\n        omega = 2.0 * np.pi * f\n        \n        # Characteristic boundary layer thicknesses\n        delta_v = np.sqrt(2.0 * nu / omega)\n        delta_t = np.sqrt(2.0 * alpha / omega)\n        \n        # Non-dimensional parameters (complex)\n        xi_v = (1.0 + 1.0j) * a / delta_v\n        xi_t = (1.0 + 1.0j) * a / delta_t\n        \n        # Viscous and thermal correction functions\n        Fv = F_func(xi_v)\n        Ft = F_func(xi_t)\n        \n        # Effective complex density and bulk modulus\n        rho_eff = rho_0 / Fv\n        K_eff = (gamma * p_0) / (1.0 + (gamma - 1.0) * (1.0 - Ft))\n        \n        # Characteristic impedance and wavenumber\n        Zc = np.sqrt(rho_eff * K_eff)\n        k = omega * np.sqrt(rho_eff / K_eff)\n        \n        # Input impedance for a rigidly terminated line\n        # cot(z) = 1/tan(z)\n        # Using a small epsilon to avoid potential division by zero in tan(k*L)\n        # although with complex k, tan(k*L) should not be exactly zero.\n        tan_kL = np.tan(k * L)\n        if abs(tan_kL)  1e-15: # Practically zero\n            # This corresponds to a resonance where impedance is very high\n            # The cotangent would be very large. We can approximate with a large number\n            # but using direct division should be stable due to complex nature of k.\n             Z_in = -1.0j * Zc * (1.0 / (tan_kL + 1e-30j))\n        else:\n             Z_in = -1.0j * Zc / tan_kL\n        \n        return Z_in\n\n    # --- Main Calculation Loop ---\n    \n    for L, a, f in test_cases:\n        # Calculate impedance using the reference (exact) model\n        Z_in_ref = calculate_impedance(L, a, f, F_exact)\n        \n        # Calculate impedance using the reduced-order (approximate) model\n        Z_in_red = calculate_impedance(L, a, f, F_approx)\n        \n        # Calculate the relative complex impedance error\n        # Add a small epsilon to denominator to prevent division by zero if Z_in_ref is zero\n        # which can happen at anti-resonances.\n        denominator = np.abs(Z_in_ref)\n        if denominator  1e-9: # Effectively zero impedance\n            # If both are near zero, error is small. If only ref is zero, error is large.\n             error = np.abs(Z_in_red)\n        else:\n             error = np.abs(Z_in_red - Z_in_ref) / denominator\n        \n        results.append(round(error, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}