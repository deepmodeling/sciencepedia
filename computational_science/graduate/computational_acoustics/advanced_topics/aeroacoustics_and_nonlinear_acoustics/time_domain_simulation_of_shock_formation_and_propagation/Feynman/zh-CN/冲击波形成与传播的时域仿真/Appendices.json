{
    "hands_on_practices": [
        {
            "introduction": "在投入计算资源进行仿真之前，首要步骤是深入理解问题的物理特性。无量纲分析是一种强有力的工具，它能帮助我们判断主导的物理效应，例如，非线性陡峭效应是否会压倒耗散效应并形成冲击波。\n\n本练习将引导你计算如戈德堡数（Gol'dberg number）等关键的无量纲参数。通过比较这些参数的量级，你将为预测高强度超声场景下的波动行为建立物理直觉，并为你的建模选择提供坚实的依据 。",
            "id": "4147004",
            "problem": "考虑一个角频率为 $\\omega$、峰值声压幅值为 $p_{a}$ 的一维行进平面声波，该声波在一种黏性、热学上近等熵的液体中传播。该液体的环境密度为 $\\rho_{0}$，小信号声速为 $c_{0}$。液体的剪切黏度为 $\\mu$，体积黏度为 $\\zeta$。材料的非线性由标准系数 $\\beta$ 表征（该系数由状态方程的二阶等熵展开定义）。假设在所考虑的频率范围内，该液体的热效应与黏性效应相比可以忽略不计。\n\n从可压缩黏性流体的质量守恒和动量守恒出发，结合一个二阶等熵状态方程，推导在迟滞时间下适用于弱非线性、弱衰减平面波的规范一维演化方程。识别出乘以非线性陡峭项和代表黏性衰减的耗散项的自然无量纲群。用量纲参数 $\\{\\rho_{0}, c_{0}, \\beta, \\mu, \\zeta, p_{a}, \\omega\\}$ 和波数 $k=\\omega/c_{0}$ 来表示这些群。从此演化方程的无黏极限出发，求出正弦波的激波形成距离 $x_{s}$，并将 Gol'dberg 数 $\\Gamma$ 定义为激波形成距离与线性吸收长度之比。\n\n使用以下符合科学实际的室温液体参数值：\n- $\\rho_{0}=1000\\,\\mathrm{kg/m^{3}}$，\n- $c_{0}=1500\\,\\mathrm{m/s}$，\n- $\\beta=3.5$，\n- $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$，\n- $\\zeta=2.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$，\n- $p_{a}=1.5\\times 10^{6}\\,\\mathrm{Pa}$，\n- $f=2.0\\,\\mathrm{MHz}$ (因此 $\\omega=2\\pi f$)，\n\n计算以下四个无量纲群：\n1. 基于峰值幅度的声马赫数 $M$。\n2. 非线性耦合强度 $\\epsilon$。\n3. 出现在黏性液体中平面波的迟滞时间 Burgers 型演化方程中的无量纲耗散参数 $\\delta$。\n4. Gol'dberg 数 $\\Gamma$。\n\n将你的四个数值答案四舍五入到三位有效数字，并以无量纲数的形式报告。然后，根据它们的大小，论证在这种情况下，哪些项在导致激波形成的动力学中占主导地位，哪些项在时域模拟框架中可以忽略。为本题目的，您必须将四个无量纲值作为最终答案。任何定性论证只应出现在您的解答中。",
            "solution": "该问题陈述具有科学依据，问题设定良好，并包含足够的信息来推导所要求的量并计算其数值。该物理情景描述了耗散流体中的弱非线性声传播，这是非线性声学中的一个经典课题，由诸如 Burgers 方程之类的方程所支配。所提供的参数对于高强度超声条件下的水是符合实际的。因此，该问题被认为是有效的。\n\n推导始于可压缩黏性流体的一维质量守恒和动量守恒方程，以及一个二阶等熵状态方程。\n\n质量守恒方程为：\n$$ \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0 $$\n动量守恒方程，包括纵向平面波的黏性应力，为：\n$$ \\rho \\left( \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} \\right) = -\\frac{\\partial p}{\\partial x} + \\left(\\zeta + \\frac{4}{3}\\mu\\right) \\frac{\\partial^2 u}{\\partial x^2} $$\n其中 $\\rho$ 是密度，$u$ 是质点速度，$p$ 是压力，$\\mu$ 是剪切黏度，$\\zeta$ 是体积黏度。\n\n状态方程关联了压力和密度。对于等熵过程，我们可以将 $p(\\rho)$ 在环境状态 $(p_0, \\rho_0)$ 附近展开为泰勒级数：\n$$ p - p_0 = A \\left(\\frac{\\rho - \\rho_0}{\\rho_0}\\right) + \\frac{B}{2} \\left(\\frac{\\rho - \\rho_0}{\\rho_0}\\right)^2 + \\mathcal{O}\\left(\\left(\\frac{\\rho - \\rho_0}{\\rho_0}\\right)^3\\right) $$\n小信号声速 $c_0$ 由 $c_0^2 = (\\partial p/\\partial \\rho)_S |_{\\rho_0} = A/\\rho_0$ 定义。非线性系数 $\\beta$ 定义为 $\\beta = 1 + \\frac{B}{2A}$。\n\n对于弱非线性（$p'/\\rho_0 c_0^2 \\ll 1$）和弱耗散波，使用微扰分析可以将这些方程组合成一个单一的演化方程。这是非线性声学中的一个标准程序。对于沿 $+x$ 方向传播的行进波，使用迟滞时间坐标 $\\tau = t - x/c_0$ 很方便。得到的演化方程，通常是平面波的 Burgers 方程或 Westervelt 方程的一种形式，为：\n$$ \\frac{\\partial p'}{\\partial x} - \\frac{\\beta}{\\rho_0 c_0^3} p' \\frac{\\partial p'}{\\partial \\tau} = \\frac{b}{2\\rho_0 c_0^3} \\frac{\\partial^2 p'}{\\partial \\tau^2} $$\n其中 $p' = p-p_0$ 是声压，$b = \\zeta + \\frac{4}{3}\\mu$ 是有效黏度系数。\n\n该方程描述了波形 $p'(\\tau)$ 在沿 $x$ 传播时的变化。左边第二项是非线性陡峭项，右边项是由于黏性引起的耗散项。\n\n我们现在识别自然的无量纲群。\n1.  **声马赫数 $M$**：这是峰值质点速度 $u_a$ 与声速 $c_0$ 的比值。使用平面波声阻抗关系 $p_a = \\rho_0 c_0 u_a$，我们有：\n    $$ M = \\frac{u_a}{c_0} = \\frac{p_a}{\\rho_0 c_0^2} $$\n    该参数量化了波的振幅。\n\n2.  **非线性耦合强度 $\\epsilon$**：虽然有时与 $M$ 可互换使用，但问题要求分开列出。演化方程中非线性项强度的一个逻辑定义是组合 $\\beta M$。这个参数 $\\epsilon = \\beta M$，通过结合材料属性 $\\beta$ 和波幅 $M$ 来代表有效非线性。\n    $$ \\epsilon = \\beta M = \\frac{\\beta p_a}{\\rho_0 c_0^2} $$\n\n3.  **无量纲耗散参数 $\\delta$**：一个自然的耗散无量纲参数是声雷诺数的倒数，它比较了在特征频率 $\\omega$ 下的黏性力与惯性力。\n    $$ \\delta = \\frac{b\\omega}{\\rho_0 c_0^2} = \\frac{(\\zeta + \\frac{4}{3}\\mu)\\omega}{\\rho_0 c_0^2} $$\n\n4.  **Gol'dberg 数 $\\Gamma$**：问题将其定义为激波形成距离 $x_s$ 与线性吸收长度 $L_a$ 之比。\n    在无黏极限（$b=0$）下，演化方程预测一个初始为正弦波的波 $p'(x=0,t) = p_a \\sin(\\omega t)$ 将会变陡并在距离 $x_s$ 处形成一个不连续面（激波）：\n    $$ x_s = \\frac{\\rho_0 c_0^3}{\\beta \\omega p_a} $$\n    线性吸收长度 $L_a$ 是波幅仅因黏性损失而衰减到 $1/e$ 倍时所经过的距离。它是振幅衰减系数 $\\alpha$ 的倒数。从演化方程的线性部分，可以找到 $\\alpha$ 为：\n    $$ \\alpha = \\frac{b\\omega^2}{2\\rho_0 c_0^3} $$\n    因此，$L_a = 1/\\alpha = \\frac{2\\rho_0 c_0^3}{b\\omega^2}$。\n    于是 Gol'dberg 数 $\\Gamma$ 为：\n    $$ \\Gamma = \\frac{x_s}{L_a} = x_s \\alpha = \\left(\\frac{\\rho_0 c_0^3}{\\beta \\omega p_a}\\right) \\left(\\frac{b\\omega^2}{2\\rho_0 c_0^3}\\right) = \\frac{b\\omega}{2\\beta p_a} $$\n    注意已定义参数之间的关系：$\\Gamma = \\frac{1}{2}\\frac{\\delta}{\\epsilon}$。\n\n现在，我们使用提供的数据计算这四个群的数值：\n- $\\rho_{0}=1000\\,\\mathrm{kg/m^{3}}$\n- $c_{0}=1500\\,\\mathrm{m/s}$\n- $\\beta=3.5$\n- $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\n- $\\zeta=2.5\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$\n- $p_{a}=1.5\\times 10^{6}\\,\\mathrm{Pa}$\n- $f=2.0\\,\\mathrm{MHz} = 2.0 \\times 10^6 \\, \\mathrm{Hz}$\n\n首先，我们计算中间量：\n- 角频率：$\\omega = 2\\pi f = 2\\pi (2.0 \\times 10^6) = 4\\pi \\times 10^6 \\, \\mathrm{rad/s} \\approx 1.2566 \\times 10^7 \\, \\mathrm{rad/s}$。\n- 有效黏度：$b = \\zeta + \\frac{4}{3}\\mu = (2.5 \\times 10^{-3}) + \\frac{4}{3}(1.0 \\times 10^{-3}) = (\\frac{7.5}{3} + \\frac{4}{3}) \\times 10^{-3} = \\frac{11.5}{3} \\times 10^{-3} \\, \\mathrm{Pa\\cdot s} \\approx 3.833 \\times 10^{-3} \\, \\mathrm{Pa\\cdot s}$。\n- 特征阻抗平方：$\\rho_0 c_0^2 = 1000 \\, (1500)^2 = 10^3 \\times 2.25 \\times 10^6 = 2.25 \\times 10^9 \\, \\mathrm{Pa}$。\n\n1.  **声马赫数 $M$**：\n    $$ M = \\frac{p_a}{\\rho_0 c_0^2} = \\frac{1.5 \\times 10^6}{2.25 \\times 10^9} = \\frac{1.5}{2.25} \\times 10^{-3} = \\frac{2}{3} \\times 10^{-3} \\approx 6.667 \\times 10^{-4} $$\n    保留三位有效数字，$M = 6.67 \\times 10^{-4}$。\n\n2.  **非线性耦合强度 $\\epsilon$**：\n    $$ \\epsilon = \\frac{\\beta p_a}{\\rho_0 c_0^2} = \\beta M = 3.5 \\times \\left(\\frac{2}{3} \\times 10^{-3}\\right) = \\frac{7}{3} \\times 10^{-3} \\approx 2.333 \\times 10^{-3} $$\n    保留三位有效数字，$\\epsilon = 2.33 \\times 10^{-3}$。\n\n3.  **无量纲耗散参数 $\\delta$**：\n    $$ \\delta = \\frac{b\\omega}{\\rho_0 c_0^2} = \\frac{(\\frac{11.5}{3} \\times 10^{-3}) \\times (4\\pi \\times 10^6)}{2.25 \\times 10^9} = \\frac{46\\pi \\times 10^3}{3 \\times 2.25 \\times 10^9} \\approx 2.141 \\times 10^{-5} $$\n    保留三位有效数字，$\\delta = 2.14 \\times 10^{-5}$。\n\n4.  **Gol'dberg 数 $\\Gamma$**：\n    $$ \\Gamma = \\frac{b\\omega}{2\\beta p_a} = \\frac{(\\frac{11.5}{3} \\times 10^{-3}) \\times (4\\pi \\times 10^6)}{2 \\times 3.5 \\times (1.5 \\times 10^6)} = \\frac{46\\pi \\times 10^3}{3 \\times 10.5 \\times 10^6} \\approx 4.587 \\times 10^{-3} $$\n    保留三位有效数字，$\\Gamma = 4.59 \\times 10^{-3}$。\n\n基于这些数值，Gol'dberg 数 $\\Gamma \\approx 4.59 \\times 10^{-3}$，远小于 $1$。由于 $\\Gamma = x_s/L_a$，这意味着激波形成距离 $x_s$ 显著短于吸收长度 $L_a$。因此，非线性波形陡峭是主导的物理效应。声波将在黏性力能够显著衰减整个波之前迅速发生畸变并形成类似激波的波前。在时域模拟中，非线性项是至关重要的，并将驱动动力学过程，而耗散项虽然总体影响较小，但对于规范化激波波前并确定其有限厚度是必不可少的。",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n6.67 \\times 10^{-4} & 2.33 \\times 10^{-3} & 2.14 \\times 10^{-5} & 4.59 \\times 10^{-3}\n\\end{pmatrix}\n} $$"
        },
        {
            "introduction": "一旦预测到冲击波的形成，常规的数值格式可能会产生非物理的解（如稀疏激波），从而导致模拟失败。这种失败源于在特定点上数值耗散不足，违反了被称为熵条件的物理学基本原理。\n\n在这个编程实践中，你将为伯格斯方程（Burgers' equation）——一个模拟冲击波形成的关键模型——实现多种数值通量。你将直接观察到简单的中心格式和迎风格式的失效，并理解“熵修正”是如何纠正解，从而确保模拟结果尊重物理定律的 。",
            "id": "4147034",
            "problem": "考虑由无粘性标量守恒律（即 Burgers 方程）建模的一维非线性声波陡峭化，该方程在计算声学中被广泛用于近似单向传播下有限振幅波中激波的形成：\n$$\n\\partial_t u(x,t) + \\partial_x f\\big(u(x,t)\\big) = 0,\n$$\n其中通量为 $$f(u) = \\tfrac{1}{2} u^2$$，特征速度为 $$a(u) = f'(u) = u$$。对于形成激波的波场，物理上相关的解是熵解，它满足凸熵对 $$\\eta(u) = \\tfrac{1}{2}u^2$$ 和 $$q(u) = \\tfrac{1}{3}u^3$$ 的熵不等式：\n$$\n\\partial_t \\eta(u) + \\partial_x q(u) \\le 0,\n$$\n在穿过激波时为严格不等式。这意味着，当激波形成时，$$\\eta$$ 在周期性闭合域上的空间积分 $$S(t) = \\int_0^L \\eta\\big(u(x,t)\\big) \\, dx,$$ 不应随时间增加；而在没有激波的光滑稀疏波情况下，该积分应保持恒定。\n\n你需要在一个周期性域 $$x \\in [0,L]$$（其中 $$L=1$$）上实现一个有限体积、时域的模拟器，以比较应用于 Burgers 方程的不同数值格式中的熵行为：\n- 使用简单算术平均界面通量的中心格式，\n- 基于 Roe 线性化且无熵修正的迎风格式，\n- 在声速点附近增加了 Harten 熵修正的相同 Roe 迎风格式。\n\n在包含 $$N$$ 个尺寸为 $$\\Delta x = L/N$$ 的单元的均匀网格上，对于单元平均值 $$u_i(t)$$ 的半离散有限体积更新公式为\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right),\n$$\n其中 $$F_{i+\\frac{1}{2}}$$ 是界面 $$x_{i+\\frac{1}{2}}$$ 处的数值通量。使用周期性索引，使得 $$u_{-1} \\equiv u_{N-1}$$ 且 $$u_{N} \\equiv u_{0}$$。\n\n定义以下通量：\n- 中心平均通量：\n$$\nF_{i+\\frac{1}{2}}^{\\mathrm{central}} = \\frac{1}{2}\\left(f(u_i) + f(u_{i+1})\\right).\n$$\n- 无熵修正的 Roe 迎风通量：\n$$\na_{i+\\frac{1}{2}}^{\\mathrm{Roe}} = \\frac{u_i + u_{i+1}}{2}, \\quad\nF_{i+\\frac{1}{2}}^{\\mathrm{Roe}} = \\frac{1}{2} \\left( f(u_i) + f(u_{i+1}) \\right) - \\frac{1}{2} \\left| a_{i+\\frac{1}{2}}^{\\mathrm{Roe}} \\right| \\left( u_{i+1} - u_i \\right).\n$$\n- 带 Harten 熵修正的 Roe 迎风通量（在声速点附近）：\n引入一个平滑阈值 $$\\delta_{i+\\frac{1}{2}} = \\varepsilon \\, \\max_j \\left| a_{j+\\frac{1}{2}}^{\\mathrm{Roe}} \\right|$$，其中 $$\\varepsilon \\in (0,1)$$ 是一个小参数，并将 $$\\left| a_{i+\\frac{1}{2}}^{\\mathrm{Roe}} \\right|$$ 替换为\n$$\n\\phi\\!\\left(a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}\\right) =\n\\begin{cases}\n\\frac{1}{2}\\left(\\frac{a^2}{\\delta} + \\delta\\right), & \\text{if } |a| < \\delta, \\\\\n|a|, & \\text{otherwise,}\n\\end{cases}\n$$\n其中 $$a \\equiv a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}$$ 且 $$\\delta \\equiv \\delta_{i+\\frac{1}{2}}$$。然后定义\n$$\nF_{i+\\frac{1}{2}}^{\\mathrm{Roe\\text{-}fix}} = \\frac{1}{2} \\left( f(u_i) + f(u_{i+1}) \\right) - \\frac{1}{2} \\, \\phi\\!\\left(a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}\\right) \\left( u_{i+1} - u_i \\right).\n$$\n\n使用基于 $$\\max_i |u_i|$$ 的标准显式时间步进法和 Courant–Friedrichs–Lewy (CFL) 准则：\n$$\n\\Delta t = \\mathrm{CFL} \\, \\frac{\\Delta x}{\\max_i |u_i| + 10^{-12}},\n$$\n其中中心格式的 $$\\mathrm{CFL}=0.2$$，Roe 变体的 $$\\mathrm{CFL}=0.5$$。初始化熵\n$$\nS(t) = \\sum_{i=0}^{N-1} \\frac{1}{2} u_i(t)^2 \\, \\Delta x,\n$$\n并监测其变化 $$\\Delta S = S(t_{\\mathrm{end}}) - S(0)$$。\n\n对于下方的测试套件，按照指示在 $$N$$ 个均匀单元上定义初始条件，并演化至 $$t_{\\mathrm{end}}$$。在整个过程中使用指定的周期性边界和无量纲单位。对于每个测试用例，计算三个布尔值，根据以下标准指示相应格式是否表现出熵违背：\n- 对于形成激波的情况：如果 $$\\Delta S > 10^{-6}$$，则发生违背（当激波形成时，熵不应增加）。\n- 对于光滑稀疏波的情况：如果 $$|\\Delta S| > 10^{-6}$$，则发生违背（在没有激波的情况下，熵应保持恒定）。\n\n测试套件：\n1. 形成激波的正弦波：\n   - $$N = 400$$，初始条件 $$u(x,0) = A \\sin(2\\pi x)$$，其中 $$A=1.0$$，演化至 $$t_{\\mathrm{end}} = 0.20$$。\n2. 跨声速稀疏阶跃：\n   - $$N = 400$$，初始条件为当 $x < 0.5$ 时 $u(x,0) = u_L$，当 $x \\ge 0.5$ 时 $u(x,0) = u_R$，其中 $$u_L = -0.2$$ 且 $$u_R = 0.2$$，演化至 $$t_{\\mathrm{end}} = 0.10$$。\n3. 强稀疏阶跃：\n   - $$N = 400$$，初始条件为当 $x < 0.5$ 时 $u(x,0) = u_L$，当 $x \\ge 0.5$ 时 $u(x,0) = u_R$，其中 $$u_L = -1.0$$ 且 $$u_R = 1.0$$，演化至 $$t_{\\mathrm{end}} = 0.05$$。\n\n你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中每个测试用例贡献一个包含三个布尔值的列表，顺序为 [central,roe,roe_fix]。例如：\n\"[ [False,True,False] , [False,False,False] , [True,False,False] ]\"",
            "solution": "用户提供了一个有效且适定的计算声学领域的问题陈述。该问题具有科学依据、内容自洽，并要求实现和比较求解双曲守恒律的标准数值方法。所有提供的数据、方程和条件都是一致且足以开发解决方案的。\n\n该问题要求使用有限体积法模拟一维无粘 Burgers 方程，这是一个典型的标量守恒律，由下式给出：\n$$\n\\partial_t u(x,t) + \\partial_x f(u(x,t)) = 0\n$$\n其中状态变量为 $$u(x,t)$$，非线性通量为 $$f(u) = \\frac{1}{2} u^2$$。特征速度为 $$a(u) = f'(u) = u$$。我们要在周期性域 $$x \\in [0,L]$$（其中 $$L=1$$）上求解此方程。目标是研究不同的数值通量函数如何影响总熵的离散版本 $$S(t) = \\int_0^L \\eta(u) \\, dx$$ 的守恒性，其中 $$\\eta(u) = \\frac{1}{2}u^2$$ 是熵函数。对于物理上正确的（熵）解，这个量必须不随时间增加，即对于 $$t_2 > t_1$$，有 $$S(t_2) \\le S(t_1)$$。\n\n数值框架是一个在包含 $$N$$ 个单元（每个宽度为 $$\\Delta x = L/N$$）的均匀网格上的半离散有限体积方法。单元平均状态 $$u_i$$ 的更新方程为：\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right)\n$$\n此处，$$F_{i+\\frac{1}{2}}$$ 是单元 $$i$$ 和单元 $$i+1$$ 之间界面处的数值通量。强制使用周期性边界条件。时间积分使用显式前向欧拉法执行，时间步长 $$\\Delta t$$ 由 Courant–Friedrichs–Lewy (CFL) 条件确定：\n$$\n\\Delta t = \\mathrm{CFL} \\, \\frac{\\Delta x}{\\max_i |u_i| + 10^{-12}}\n$$\n为保证数值稳定性，在分母上增加了一个小常数 $$10^{-12}$$。\n\n我们将实现并比较三种不同的数值通量公式：\n\n1.  **中心平均通量**：\n    $$\n    F_{i+\\frac{1}{2}}^{\\mathrm{central}} = \\frac{1}{2}\\left(f(u_i) + f(u_{i+1})\\right)\n    $$\n    这是最简单的通量。它是非耗散的，这意味着它不会抑制数值振荡。对于双曲问题，这种耗散的缺乏常导致不稳定，尤其是在激波附近，可能导致总熵的非物理解增。\n\n2.  **Roe 迎风通量**：\n    $$\n    F_{i+\\frac{1}{2}}^{\\mathrm{Roe}} = \\frac{1}{2} \\left( f(u_i) + f(u_{i+1}) \\right) - \\frac{1}{2} \\left| a_{i+\\frac{1}{2}}^{\\mathrm{Roe}} \\right| \\left( u_{i+1} - u_i \\right)\n    $$\n    其中 $$a_{i+\\frac{1}{2}}^{\\mathrm{Roe}} = \\frac{u_i + u_{i+1}}{2}$$ 是 Roe 平均特征速度。第二项与 $$|a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}|$$ 成正比，引入了依赖于波速的数值耗散，使该格式成为“迎风”格式。此格式对于间断具有很高的精度。然而，它在声速点处有一个众所周知的缺陷，即特征速度穿过零的点（例如，$u_i < 0$ 且 $u_{i+1} > 0$）。在此处，$$a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}$$ 可能接近零，导致耗散不足。这允许形成违背熵条件的稀疏激波。\n\n3.  **带 Harten 熵修正的 Roe 迎风通量**：\n    为了修正 Roe 通量的缺陷，需要修改耗散项。我们将 $$\\left| a_{i+\\frac{1}{2}}^{\\mathrm{Roe}} \\right|$$ 替换为一个函数 $$\\phi(a_{i+\\frac{1}{2}}^{\\mathrm{Roe}})$$，该函数在声速点附近增加数值粘性。修正后的绝对值函数为：\n    $$\n    \\phi(a) =\n    \\begin{cases}\n    \\frac{1}{2}\\left(\\frac{a^2}{\\delta} + \\delta\\right), & \\text{if } |a| < \\delta \\\\\n    |a|, & \\text{otherwise}\n    \\end{cases}\n    $$\n    阈值 $$\\delta$$ 基于域中的最大波速，即 $$\\delta = \\varepsilon \\, \\max_j \\left| a_{j+\\frac{1}{2}}^{\\mathrm{Roe}} \\right|$$，其中我们选择一个小参数 $$\\varepsilon = 0.1$$。这种“熵修正”确保了有足够的数值耗散来防止在跨声速稀疏波中形成非物理解，从而强制执行熵条件。通量变为：\n    $$\n    F_{i+\\frac{1}{2}}^{\\mathrm{Roe\\text{-}fix}} = \\frac{1}{2} \\left( f(u_i) + f(u_{i+1}) \\right) - \\frac{1}{2} \\, \\phi\\left(a_{i+\\frac{1}{2}}^{\\mathrm{Roe}}\\right) \\left( u_{i+1} - u_i \\right)\n    $$\n\n算法首先根据给定的测试用例在 $$N$$ 个单元上初始化状态向量 $$u_0$$。计算并存储初始离散熵 $$S(0) = \\sum_{i=0}^{N-1} \\frac{1}{2} u_i(0)^2 \\, \\Delta x$$。然后，解在时间上被演化到 $$t_{\\mathrm{end}}$$。在每个时间步中，计算所有单元界面处的相应数值通量，并更新状态向量 $$u$$。在最后一个时间步之后，计算最终熵 $$S(t_{\\mathrm{end}})$$，并确定其变化量 $$\\Delta S = S(t_{\\mathrm{end}}) - S(0)$$。\n\n最后，我们根据提供的标准来判断是否发生了熵违背：\n-   对于形成激波的问题（预期会有一些物理耗散），如果 $$\\Delta S > 10^{-6}$$，则标记为违背。\n-   对于光滑稀疏波问题（精确解的熵是守恒的），如果 $$|\\Delta S| > 10^{-6}$$，则标记为违背。\n\n对三个测试用例中的每一个和三种数值格式中的每一种都重复此过程，以生成所需的布尔结果矩阵。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef flux_function(u):\n    \"\"\"Computes the Burgers' flux F(u) = 0.5 * u^2.\"\"\"\n    return 0.5 * u**2\n\ndef get_flux_central(u):\n    \"\"\"Computes the central average flux F_{i+1/2}.\"\"\"\n    f_u = flux_function(u)\n    f_u_ip1 = np.roll(f_u, -1)\n    flux_interface = 0.5 * (f_u + f_u_ip1)\n    return flux_interface\n\ndef get_flux_roe(u):\n    \"\"\"Computes the Roe upwind flux F_{i+1/2} without entropy fix.\"\"\"\n    f_u = flux_function(u)\n    u_ip1 = np.roll(u, -1)\n    f_u_ip1 = flux_function(u_ip1)\n\n    a_roe = 0.5 * (u + u_ip1)\n    dissipation = np.abs(a_roe) * (u_ip1 - u)\n\n    flux_interface = 0.5 * (f_u + f_u_ip1) - 0.5 * dissipation\n    return flux_interface\n\ndef get_flux_roe_fix(u, epsilon):\n    \"\"\"Computes the Roe upwind flux F_{i+1/2} with Harten entropy fix.\"\"\"\n    f_u = flux_function(u)\n    u_ip1 = np.roll(u, -1)\n    f_u_ip1 = flux_function(u_ip1)\n\n    a_roe = 0.5 * (u + u_ip1)\n\n    max_abs_a_roe = np.max(np.abs(a_roe))\n    delta = epsilon * max_abs_a_roe\n    \n    phi_a = np.abs(a_roe)\n    # The check for delta > 0 avoids division by zero if all a_roe are zero\n    if delta > 1e-12:\n        sonic_points = np.abs(a_roe)  delta\n        a_sonic = a_roe[sonic_points]\n        phi_a[sonic_points] = 0.5 * (a_sonic**2 / delta + delta)\n\n    dissipation = phi_a * (u_ip1 - u)\n    flux_interface = 0.5 * (f_u + f_u_ip1) - 0.5 * dissipation\n    return flux_interface\n\ndef simulate(u0, N, L, t_end, scheme, cfl, epsilon=0.1):\n    \"\"\"Runs a single finite-volume simulation.\"\"\"\n    dx = L / N\n    u = u0.copy()\n    \n    # Calculate initial entropy: S(t) = sum(eta(u_i) * dx)\n    S0 = 0.5 * np.sum(u**2) * dx\n    \n    t = 0.0\n    while t  t_end:\n        max_u = np.max(np.abs(u))\n        dt = cfl * dx / (max_u + 1e-12)\n        \n        # Ensure the final time step does not overshoot t_end\n        if t + dt > t_end:\n            dt = t_end - t\n            \n        # Select flux calculation based on scheme type\n        if scheme == 'central':\n            flux = get_flux_central(u)\n        elif scheme == 'roe':\n            flux = get_flux_roe(u)\n        elif scheme == 'roe_fix':\n            flux = get_flux_roe_fix(u, epsilon)\n        \n        # Flux at interface i-1/2 is np.roll(flux, 1)\n        flux_im12 = np.roll(flux, 1)\n        \n        # Update cell averages using FV formaula\n        u = u - (dt / dx) * (flux - flux_im12)\n        \n        t += dt\n\n    # Calculate final entropy and the change\n    S_final = 0.5 * np.sum(u**2) * dx\n    delta_S = S_final - S0\n    return delta_S\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # 1. Shock-forming sinusoid\n        {\n            \"N\": 400, \"L\": 1.0, \n            \"u0_func\": lambda x: 1.0 * np.sin(2 * np.pi * x),\n            \"t_end\": 0.20, \"type\": \"shock\",\n        },\n        # 2. Transonic rarefaction step\n        {\n            \"N\": 400, \"L\": 1.0, \n            \"u0_func\": lambda x: np.where(x  0.5, -0.2, 0.2),\n            \"t_end\": 0.10, \"type\": \"rarefaction\",\n        },\n        # 3. Strong rarefaction step\n        {\n            \"N\": 400, \"L\": 1.0,\n            \"u0_func\": lambda x: np.where(x  0.5, -1.0, 1.0),\n            \"t_end\": 0.05, \"type\": \"rarefaction\",\n        }\n    ]\n\n    all_results = []\n    # Epsilon for Harten's entropy fix\n    epsilon_fix = 0.1\n    tolerance = 1e-6\n\n    for case in test_cases:\n        N = case[\"N\"]\n        L = case[\"L\"]\n        dx = L / N\n        # Define cell-centered grid\n        x = (np.arange(N) + 0.5) * dx\n\n        u0 = case[\"u0_func\"](x)\n\n        # CFL numbers for each scheme\n        cfl_central = 0.2\n        cfl_roe = 0.5\n\n        # Run simulations\n        delta_S_central = simulate(u0, N, L, case[\"t_end\"], 'central', cfl=cfl_central)\n        delta_S_roe = simulate(u0, N, L, case[\"t_end\"], 'roe', cfl=cfl_roe)\n        delta_S_roe_fix = simulate(u0, N, L, case[\"t_end\"], 'roe_fix', cfl=cfl_roe, epsilon=epsilon_fix)\n\n        delta_S_values = [delta_S_central, delta_S_roe, delta_S_roe_fix]\n        \n        case_violations = []\n        for ds in delta_S_values:\n            violation = False\n            if case[\"type\"] == \"shock\":\n                if ds > tolerance:\n                    violation = True\n            elif case[\"type\"] == \"rarefaction\":\n                if abs(ds) > tolerance:\n                    violation = True\n            case_violations.append(violation)\n        \n        all_results.append(case_violations)\n\n    # Format the final output string to match the specified format\n    # Example: \"[ [False,True,False] , [False,False,False] ]\"\n    inner_strings = [str(r).replace(\" \", \"\") for r in all_results]\n    final_output_string = f\"[{' , '.join(inner_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "一个正确的数值格式本身并不足够；我们还需要足够的网格分辨率来精确地捕捉冲击波的结构。网格过粗会使冲击波过度弥散，而网格过密则会浪费宝贵的计算资源。\n\n这最后一个练习将理论与应用联系起来，要求你推导出一个计算所需网格分辨率的解析表达式。通过将物理冲击波厚度与数值格式的人工粘性联系起来，你将学会如何估算为达到特定精度所需的“每冲击波点数” 。",
            "id": "4146987",
            "problem": "考虑热粘性流体中的一维弱非线性行进声学平面波，在以线性声速移动的参考系中，该波动可通过粘性 Burgers 方程来建模\n$$\nu_{t} + \\beta\\, u\\, u_{z} = \\nu\\, u_{zz},\n$$\n其中 $u(z,t)$ 是质点速度，$\\beta0$ 是非线性系数，$\\nu0$ 是代表热粘性损失的有效扩散系数。假设形成一个定常激波，连接左右两种状态 $u_{L}u_{R}$，其跳跃值为 $\\Delta u = u_{L}-u_{R}$，中心位于 $z=z_{0}$。将物理激波厚度 $\\delta$ 定义为 $u$ 等于 $u_{R}+0.1\\,\\Delta u$ 和 $u_{R}+0.9\\,\\Delta u$ 的位置之间的空间距离。\n\n现对方程的守恒形式进行离散化，采用的是结合了 Lax–Friedrichs (LF) 通量分裂的五阶有限体积特征向加权基本无振荡 (WENO) 格式。在激波附近，该方法简化为一阶单调离散格式，其主导修正方程的人工粘性可建模为\n$$\n\\nu_{\\text{num}} = \\frac{\\alpha\\,\\Delta x}{2},\n$$\n其中 $\\alpha0$ 是局部特征速度大小的上限（对于标量 Burgers 通量 $f(u)=\\tfrac{\\beta}{2}u^{2}$，可取 $\\alpha=\\max| \\beta u |$ 跨越激波），$\\Delta x$ 是网格间距。\n\n施加精度要求，即捕捉到的厚度 $\\delta_{\\text{cap}}$ 须满足\n$$\n\\frac{|\\delta_{\\text{cap}}-\\delta|}{\\delta} \\le \\varepsilon,\n$$\n其中 $0  \\varepsilon  1$ 是一个给定的容差。请推导出一个闭式解析表达式，用以表示使用所选格式达到此容差所需的最小每激波点数 $N_{\\min}=\\delta/\\Delta x$，并用 $\\alpha$、$\\beta$、$\\Delta u$ 和 $\\varepsilon$ 来表示。最终答案应表示为单个解析表达式。无需进行数值四舍五入，最终表达式中不应包含单位。",
            "solution": "本问题要求推导以指定精度解析一个定常激波所需的、每个激波厚度内的最小网格点数 $N_{\\min}$。该激波由粘性 Burgers 方程控制，数值解析度受到一阶格式人工粘性的限制。\n\n首先，我们确定定常激波剖面的解析结构，它是粘性 Burgers 方程的一个行波解 $u(z,t) = U(\\xi)$，其中 $\\xi = z-st$：\n$$\nu_{t} + \\beta\\, u\\, u_{z} = \\nu\\, u_{zz}\n$$\n将 $U(\\xi)$ 代入方程并对 $\\xi$ 积分一次，得到波剖面的常微分方程：\n$$\n\\nu U' = \\frac{\\beta}{2}(U-u_L)(U-u_R)\n$$\n其中激波速度 $s$ 由 Rankine-Hugoniot 条件 $s = \\frac{\\beta}{2}(u_L+u_R)$ 给出。精确剖面不依赖于 $s$。此方程可通过分离变量法求解。以 $\\xi_0$ 为中心的解通常用双曲正切函数表示：\n$$\nU(\\xi) = \\frac{u_L+u_R}{2} - \\frac{u_L-u_R}{2}\\tanh\\left(\\frac{\\beta(u_L-u_R)}{4\\nu}(\\xi-\\xi_0)\\right)\n$$\n使用定义 $\\Delta u = u_L - u_R$ 并关注定常激波的空间依赖性（用 $z$ 代替 $\\xi$），剖面为：\n$$\nu(z) = \\frac{u_L+u_R}{2} - \\frac{\\Delta u}{2}\\tanh\\left(\\frac{\\beta\\Delta u}{4\\nu}(z-z_0)\\right)\n$$\n\n接下来，我们计算物理激波厚度 $\\delta$。它被定义为速度 $u$ 等于 $u(z_1) = u_R + 0.9\\,\\Delta u$ 和 $u(z_2) = u_R + 0.1\\,\\Delta u$ 的两点之间的距离 $z_2 - z_1$。由于 $\\beta0$ 且 $\\Delta u0$，$u(z)$ 是一个单调递减函数，因此 $z_1  z_2$。\n\n对于点 $z_1$：\n$$\nu_R + 0.9\\,\\Delta u = \\frac{u_L+u_R}{2} - \\frac{\\Delta u}{2}\\tanh\\left(\\frac{\\beta\\Delta u}{4\\nu}(z_1-z_0)\\right)\n$$\n代入 $u_L = u_R + \\Delta u$：\n$$\nu_R + 0.9\\,\\Delta u = \\frac{(u_R+\\Delta u)+u_R}{2} - \\frac{\\Delta u}{2}\\tanh\\left(\\frac{\\beta\\Delta u}{4\\nu}(z_1-z_0)\\right)\n$$\n$$\nu_R + 0.9\\,\\Delta u = u_R + \\frac{\\Delta u}{2} - \\frac{\\Delta u}{2}\\tanh\\left(\\frac{\\beta\\Delta u}{4\\nu}(z_1-z_0)\\right)\n$$\n$$\n0.4\\,\\Delta u = - \\frac{\\Delta u}{2}\\tanh\\left(\\frac{\\beta\\Delta u}{4\\nu}(z_1-z_0)\\right)\n$$\n$$\n\\tanh\\left(\\frac{\\beta\\Delta u}{4\\nu}(z_1-z_0)\\right) = -0.8\n$$\n$$\nz_1 - z_0 = \\frac{4\\nu}{\\beta\\Delta u}\\arctanh(-0.8) = -\\frac{4\\nu}{\\beta\\Delta u}\\arctanh(0.8)\n$$\n\n对于点 $z_2$：\n$$\nu_R + 0.1\\,\\Delta u = u_R + \\frac{\\Delta u}{2} - \\frac{\\Delta u}{2}\\tanh\\left(\\frac{\\beta\\Delta u}{4\\nu}(z_2-z_0)\\right)\n$$\n$$\n-0.4\\,\\Delta u = - \\frac{\\Delta u}{2}\\tanh\\left(\\frac{\\beta\\Delta u}{4\\nu}(z_2-z_0)\\right)\n$$\n$$\n\\tanh\\left(\\frac{\\beta\\Delta u}{4\\nu}(z_2-z_0)\\right) = 0.8\n$$\n$$\nz_2 - z_0 = \\frac{4\\nu}{\\beta\\Delta u}\\arctanh(0.8)\n$$\n\n物理激波厚度 $\\delta$ 为：\n$$\n\\delta = z_2 - z_1 = (z_2-z_0) - (z_1-z_0) = \\frac{8\\nu}{\\beta\\Delta u}\\arctanh(0.8)\n$$\n利用恒等式 $\\arctanh(x) = \\frac{1}{2}\\ln\\left(\\frac{1+x}{1-x}\\right)$，我们得到 $\\arctanh(0.8) = \\frac{1}{2}\\ln\\left(\\frac{1.8}{0.2}\\right) = \\frac{1}{2}\\ln(9) = \\ln(3)$。\n因此，物理激波厚度为：\n$$\n\\delta = \\frac{8\\nu\\ln(3)}{\\beta\\Delta u}\n$$\n由数值格式解析得到的捕捉激波剖面，会因格式的人工粘性而被展宽。与数值格式对应的修正方程将具有一个有效粘性，该粘性是物理粘性与数值粘性之和，即 $\\nu_{\\text{eff}} = \\nu + \\nu_{\\text{num}}$。因此，捕捉到的激波厚度 $\\delta_{\\text{cap}}$ 将具有与 $\\delta$ 相同的解析形式，但需将 $\\nu$ 替换为 $\\nu_{\\text{eff}}$：\n$$\n\\delta_{\\text{cap}} = \\frac{8\\nu_{\\text{eff}}\\ln(3)}{\\beta\\Delta u} = \\frac{8(\\nu + \\nu_{\\text{num}})\\ln(3)}{\\beta\\Delta u}\n$$\n问题给出了数值粘性的模型：$\\nu_{\\text{num}} = \\frac{\\alpha\\Delta x}{2}$。\n\n精度要求由激波厚度的相对误差给出：\n$$\n\\frac{|\\delta_{\\text{cap}}-\\delta|}{\\delta} \\le \\varepsilon\n$$\n厚度之差为：\n$$\n\\delta_{\\text{cap}}-\\delta = \\frac{8(\\nu + \\nu_{\\text{num}})\\ln(3)}{\\beta\\Delta u} - \\frac{8\\nu\\ln(3)}{\\beta\\Delta u} = \\frac{8\\nu_{\\text{num}}\\ln(3)}{\\beta\\Delta u}\n$$\n由于 $\\nu_{\\text{num}}0$，因此不需要绝对值。不等式变为：\n$$\n\\frac{\\frac{8\\nu_{\\text{num}}\\ln(3)}{\\beta\\Delta u}}{\\frac{8\\nu\\ln(3)}{\\beta\\Delta u}} \\le \\varepsilon\n$$\n$$\n\\frac{\\nu_{\\text{num}}}{\\nu} \\le \\varepsilon\n$$\n代入 $\\nu_{\\text{num}}$ 的表达式：\n$$\n\\frac{\\alpha\\Delta x}{2\\nu} \\le \\varepsilon\n$$\n此不等式给出了允许的网格间距 $\\Delta x$ 的上限：\n$$\n\\Delta x \\le \\frac{2\\nu\\varepsilon}{\\alpha}\n$$\n为确保满足精度要求，我们必须使用不大于此最大值的网格间距 $\\Delta x$，即 $\\Delta x_{\\max} = \\frac{2\\nu\\varepsilon}{\\alpha}$。\n\n待求的量是最小每激波点数 $N_{\\min} = \\delta/\\Delta x$。为了找到所需的最小分辨率 $N$，我们必须使用允许的最大网格间距 $\\Delta x_{\\max}$：\n$$\nN_{\\min} = \\frac{\\delta}{\\Delta x_{\\max}}\n$$\n代入 $\\delta$ 和 $\\Delta x_{\\max}$ 的表达式：\n$$\nN_{\\min} = \\frac{\\frac{8\\nu\\ln(3)}{\\beta\\Delta u}}{\\frac{2\\nu\\varepsilon}{\\alpha}} = \\frac{8\\nu\\ln(3)}{\\beta\\Delta u} \\cdot \\frac{\\alpha}{2\\nu\\varepsilon}\n$$\n通过消去 $2\\nu$ 项来简化表达式：\n$$\nN_{\\min} = \\frac{4\\alpha\\ln(3)}{\\beta\\Delta u\\varepsilon}\n$$\n这就是关于指定参数的最小所需每激波点数的最终闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{4\\alpha\\ln(3)}{\\beta\\Delta u\\varepsilon}}$$"
        }
    ]
}