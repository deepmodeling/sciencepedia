{
    "hands_on_practices": [
        {
            "introduction": "The foundation of many modern shock-capturing methods, including Godunov's scheme, lies in solving the exact Riemann problem at each cell interface. This exercise  provides essential practice with this fundamental building block using the inviscid Burgers' equation, a canonical model for nonlinear wave steepening. By analyzing the initial left and right states, you will determine the resulting wave pattern and compute the numerical flux, reinforcing your understanding of the Rankine–Hugoniot condition and its role in defining the intercell flux.",
            "id": "4136718",
            "problem": "Consider one-dimensional nonlinear acoustic wave propagation in non-dimensional variables modeled by the inviscid Burgers equation, which is a scalar conservation law,\n$$\nu_{t} + \\left(\\frac{1}{2} u^{2}\\right)_{x} = 0,\n$$\nwhere $u(x,t)$ denotes the non-dimensional velocity potential gradient. In shock-capturing finite volume methods of Godunov type, the intercell numerical flux at an interface is defined as the physical flux evaluated at the interface location $x=0$ from the exact self-similar solution of the Riemann problem posed with left and right constant states.\n\nAt a particular interface, the left and right states are\n$$\nu_{L} = 1.5, \\quad u_{R} = -0.5.\n$$\nTreat these states as the initial data for the Riemann problem at $x=0$:\n$$\nu(x,0) = \\begin{cases}\nu_{L}, & x<0, \\\\\nu_{R}, & x>0.\n\\end{cases}\n$$\n\nStarting from the conservation law and the definition of a weak solution, determine the appropriate self-similar solution (shock or rarefaction), identify the wave speed if a shock forms using the Rankine–Hugoniot jump condition, and then evaluate the Godunov intercell flux $F_{G}$, defined as the physical flux $\\frac{1}{2}u^{2}$ at $x=0$ and $t>0$ along the exact solution of the Riemann problem. Express your final answer as a single real number in non-dimensional units. No rounding is required.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It poses a standard question in the field of computational fluid dynamics concerning the solution of a Riemann problem for the inviscid Burgers equation. All necessary information is provided, and the requested quantity is well-defined.\n\nThe governing equation is the inviscid Burgers equation, a scalar conservation law of the form $u_{t} + f(u)_{x} = 0$, where $u(x,t)$ is the conserved variable and $f(u)$ is the flux function.\nFor this problem, the flux function is given by\n$$\nf(u) = \\frac{1}{2} u^{2}\n$$\nThe problem considers the exact solution to the Riemann problem with initial data consisting of two constant states, $u_{L}$ and $u_{R}$, separated by a discontinuity at $x=0$:\n$$\nu(x,0) = \\begin{cases}\nu_{L} = 1.5, & x<0 \\\\\nu_{R} = -0.5, & x>0\n\\end{cases}\n$$\nThe solution to this Riemann problem is self-similar, meaning it depends only on the ratio $\\xi = x/t$. The nature of the solution, whether it is a shock wave or a rarefaction wave, is determined by the characteristic speeds associated with the left and right states. The characteristic speed, $a(u)$, is given by the derivative of the flux function:\n$$\na(u) = f'(u) = \\frac{d}{du}\\left(\\frac{1}{2} u^{2}\\right) = u\n$$\nWe evaluate the characteristic speeds for the given left and right states:\n$$\na(u_{L}) = u_{L} = 1.5\n$$\n$$\na(u_{R}) = u_{R} = -0.5\n$$\nSince $a(u_{L}) > a(u_{R})$ (that is, $1.5 > -0.5$), the characteristics are converging, which leads to the formation of a discontinuous solution known as a shock wave. If the characteristics were diverging ($a(u_{L}) < a(u_{R})$), the solution would be a continuous rarefaction wave.\n\nFor a shock wave, the speed of the discontinuity, $s$, must satisfy the Rankine–Hugoniot jump condition. This condition ensures that the integral form of the conservation law is satisfied across the discontinuity. It is given by:\n$$\ns = \\frac{\\Delta f}{\\Delta u} = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}\n$$\nWe first compute the flux values for the left and right states:\n$$\nf(u_{L}) = f(1.5) = \\frac{1}{2} (1.5)^{2} = \\frac{1}{2} (2.25) = 1.125\n$$\n$$\nf(u_{R}) = f(-0.5) = \\frac{1}{2} (-0.5)^{2} = \\frac{1}{2} (0.25) = 0.125\n$$\nNow, we substitute these values along with $u_{L}$ and $u_{R}$ into the Rankine–Hugoniot condition to find the shock speed $s$:\n$$\ns = \\frac{0.125 - 1.125}{-0.5 - 1.5} = \\frac{-1.0}{-2.0} = 0.5\n$$\nThe shock speed is $s = 0.5$. Since $s > 0$, the shock wave propagates to the right, into the region where $x > 0$. The self-similar solution for $u(x,t)$ is thus given by:\n$$\nu(x,t) = u(x/t) = \\begin{cases}\nu_{L} = 1.5, & \\text{if } x/t < s = 0.5 \\\\\nu_{R} = -0.5, & \\text{if } x/t > s = 0.5\n\\end{cases}\n$$\nThe Godunov intercell flux, $F_{G}$, is defined as the physical flux evaluated at the cell interface, which is located at $x=0$, for any time $t > 0$. We need to determine the value of the state $u$ at this location, i.e., $u(0,t)$. This corresponds to the self-similar variable value $\\xi = x/t = 0/t = 0$.\n\nAccording to the shock solution structure, we must compare $\\xi=0$ to the shock speed $s=0.5$. Since $0 < 0.5$, the position $x=0$ lies in the region where the state is $u_{L}$.\nTherefore, for any $t>0$, the state at the interface is:\n$$\nu(0,t) = u_{L} = 1.5\n$$\nThe Godunov flux $F_{G}$ is the physical flux $f(u)$ evaluated at this state:\n$$\nF_{G} = f(u(0,t)) = f(u_{L}) = f(1.5)\n$$\nUsing our previously calculated value for $f(1.5)$:\n$$\nF_{G} = 1.125\n$$\nThis is the value of the intercell numerical flux for the given Riemann problem.",
            "answer": "$$\\boxed{1.125}$$"
        },
        {
            "introduction": "To achieve higher-order accuracy while maintaining stability, shock-capturing schemes employ reconstruction techniques like the Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL). A critical component of these schemes is the slope limiter, which prevents the formation of spurious oscillations near sharp gradients. This practice problem  allows you to perform a hands-on calculation of a limited slope using the `minmod` function, a key step in understanding how high-resolution methods balance accuracy in smooth regions with robustness at discontinuities.",
            "id": "4136698",
            "problem": "Consider one-dimensional linearized acoustics on a uniform grid with spacing $\\Delta x$, governed by the conservation form of the linearized Euler equations,\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0, \\qquad \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0,\n$$\nwhere $p$ is acoustic pressure, $u$ is particle velocity, $\\rho_{0}$ is the ambient density, and $c$ is the sound speed. In high-resolution shock-capturing finite-volume methods, such as the Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL), one reconstructs piecewise linear profiles inside each cell using a slope-limiter to ensure the Total Variation Diminishing (TVD) property. For a scalar field reconstruction (here, $p$), the limited slope in cell $i$ is defined by the minmod limiter,\n$$\ns_{i} = \\operatorname{minmod}\\!\\left(\\frac{p_{i} - p_{i-1}}{\\Delta x}, \\frac{p_{i+1} - p_{i}}{\\Delta x}\\right),\n$$\nwhere the minmod function is\n$$\n\\operatorname{minmod}(a,b) = \n\\begin{cases}\n\\phantom{-}\\min\\{|a|,|b|\\} \\,\\operatorname{sign}(a), & \\text{if } \\operatorname{sign}(a)=\\operatorname{sign}(b), \\\\\n0, & \\text{otherwise.}\n\\end{cases}\n$$\nWith this slope, the MUSCL left and right interface states reconstructed from cell $i$ are\n$$\np_{i,-}^{R} = p_{i} - \\frac{\\Delta x}{2} \\, s_{i} \\quad \\text{at } x_{i-\\frac{1}{2}}, \n\\qquad \np_{i,+}^{L} = p_{i} + \\frac{\\Delta x}{2} \\, s_{i} \\quad \\text{at } x_{i+\\frac{1}{2}},\n$$\nwhere $p_{i,-}^{R}$ denotes the right state at the left interface from cell $i$, and $p_{i,+}^{L}$ denotes the left state at the right interface from cell $i$.\n\nAssume a uniform grid with spacing $\\Delta x = 1\\,\\mathrm{m}$ and the following cell-average pressures: $p_{i-1} = 100\\,\\mathrm{Pa}$, $p_{i} = 200\\,\\mathrm{Pa}$, $p_{i+1} = 300\\,\\mathrm{Pa}$. Compute the limited slope $s_{i}$ using the minmod limiter, then compute the MUSCL-reconstructed interface states $p_{i,-}^{R}$ at $x_{i-\\frac{1}{2}}$ and $p_{i,+}^{L}$ at $x_{i+\\frac{1}{2}}$.\n\nExpress the slope in $\\mathrm{Pa}/\\mathrm{m}$ and the interface states in $\\mathrm{Pa}$. No rounding is required; provide exact values. The final answer should be a single row matrix containing, in order, the limited slope $s_{i}$, the left interface state $p_{i,-}^{R}$, and the right interface state $p_{i,+}^{L}$.",
            "solution": "The user wants to compute the limited slope and reconstructed interface states for a given set of cell-average pressures using the Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) with a minmod limiter.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- Cell-average pressures: $p_{i-1} = 100\\,\\mathrm{Pa}$, $p_{i} = 200\\,\\mathrm{Pa}$, $p_{i+1} = 300\\,\\mathrm{Pa}$.\n- Uniform grid spacing: $\\Delta x = 1\\,\\mathrm{m}$.\n- Definition of the minmod limiter for the slope $s_{i}$ in cell $i$:\n$$s_{i} = \\operatorname{minmod}\\!\\left(\\frac{p_{i} - p_{i-1}}{\\Delta x}, \\frac{p_{i+1} - p_{i}}{\\Delta x}\\right)$$\n- Definition of the minmod function:\n$$\n\\operatorname{minmod}(a,b) = \n\\begin{cases}\n\\phantom{-}\\min\\{|a|,|b|\\} \\,\\operatorname{sign}(a), & \\text{if } \\operatorname{sign}(a)=\\operatorname{sign}(b), \\\\\n0, & \\text{otherwise.}\n\\end{cases}\n$$\n- Formulas for the MUSCL reconstructed interface states from cell $i$:\n  - Right state at the left interface ($x_{i-\\frac{1}{2}}$): $p_{i,-}^{R} = p_{i} - \\frac{\\Delta x}{2} \\, s_{i}$\n  - Left state at the right interface ($x_{i+\\frac{1}{2}}$): $p_{i,+}^{L} = p_{i} + \\frac{\\Delta x}{2} \\, s_{i}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is validated as follows:\n- **Scientifically Grounded:** The problem describes the MUSCL scheme and the minmod limiter, which are standard and well-established techniques in computational fluid dynamics and acoustics for solving hyperbolic conservation laws. The linearized Euler equations for acoustics are fundamental. Thus, the problem is scientifically sound.\n- **Well-Posed:** The problem provides all necessary data and unambiguous formulas to compute a unique solution. The definitions are clear and precise.\n- **Objective:** The problem is stated using formal mathematical and physical language, free of subjective or opinion-based claims.\n- **Complete and Consistent:** All required values ($p_{i-1}$, $p_{i}$, $p_{i+1}$, $\\Delta x$) are provided. The definitions and formulas are self-consistent. The contextual information about the acoustic equations does not create any contradiction, as the required calculation is purely about the spatial reconstruction step.\n\nThe problem is deemed valid.\n\n### Step 3: Solution\nThe solution proceeds by first calculating the limited slope $s_i$ and then using it to find the interface states $p_{i,-}^{R}$ and $p_{i,+}^{L}$.\n\n**Part 1: Calculation of the limited slope $s_i$**\n\nThe limited slope $s_i$ is determined by the `minmod` of the backward and forward difference slopes.\n\nFirst, we compute the two arguments for the `minmod` function.\nThe backward difference slope is:\n$$ a = \\frac{p_{i} - p_{i-1}}{\\Delta x} = \\frac{200 - 100}{1} = 100\\,\\mathrm{Pa}/\\mathrm{m} $$\nThe forward difference slope is:\n$$ b = \\frac{p_{i+1} - p_{i}}{\\Delta x} = \\frac{300 - 200}{1} = 100\\,\\mathrm{Pa}/\\mathrm{m} $$\nNow, we apply the `minmod` function to these two values:\n$$ s_{i} = \\operatorname{minmod}(a, b) = \\operatorname{minmod}(100, 100) $$\nAccording to the definition of the `minmod` function, we first check the signs of the arguments.\n$$ \\operatorname{sign}(a) = \\operatorname{sign}(100) = +1 $$\n$$ \\operatorname{sign}(b) = \\operatorname{sign}(100) = +1 $$\nSince $\\operatorname{sign}(a) = \\operatorname{sign}(b)$, the first case of the `minmod` definition applies:\n$$ s_{i} = \\min\\{|a|, |b|\\} \\operatorname{sign}(a) = \\min\\{|100|, |100|\\} \\operatorname{sign}(100) $$\n$$ s_{i} = \\min\\{100, 100\\} \\times 1 = 100 \\times 1 = 100\\,\\mathrm{Pa}/\\mathrm{m} $$\nSo, the limited slope is $s_{i} = 100\\,\\mathrm{Pa}/\\mathrm{m}$. This result is expected, as the data points lie on a straight line, and the limiter correctly reproduces the gradient of that line.\n\n**Part 2: Calculation of the interface states $p_{i,-}^{R}$ and $p_{i,+}^{L}$**\n\nNext, we use the calculated slope $s_i$ to find the reconstructed pressure values at the cell interfaces.\n\nThe right state at the left interface, $p_{i,-}^{R}$, is calculated using the formula:\n$$ p_{i,-}^{R} = p_{i} - \\frac{\\Delta x}{2} s_{i} $$\nSubstituting the given and calculated values:\n$$ p_{i,-}^{R} = 200 - \\frac{1}{2} \\times 100 = 200 - 50 = 150\\,\\mathrm{Pa} $$\n\nThe left state at the right interface, $p_{i,+}^{L}$, is calculated using the formula:\n$$ p_{i,+}^{L} = p_{i} + \\frac{\\Delta x}{2} s_{i} $$\nSubstituting the given and calculated values:\n$$ p_{i,+}^{L} = 200 + \\frac{1}{2} \\times 100 = 200 + 50 = 250\\,\\mathrm{Pa} $$\n\nThe final results are: the limited slope $s_i=100\\,\\mathrm{Pa}/\\mathrm{m}$, the left interface state $p_{i,-}^{R}=150\\,\\mathrm{Pa}$, and the right interface state $p_{i,+}^{L}=250\\,\\mathrm{Pa}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 100 & 150 & 250 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A crucial aspect of developing and using numerical methods is verification: ensuring the code behaves as theoretically expected. This comprehensive practice  guides you through implementing a full MUSCL-Hancock scheme and performing an empirical convergence rate study, a standard validation technique in computational science. By comparing the results for smooth solutions versus those with shocks, you will gain practical insight into why high-resolution schemes are designed to locally reduce their order of accuracy at discontinuities to guarantee a stable and physically meaningful solution.",
            "id": "4136762",
            "problem": "Consider one-dimensional nonlinear acoustics modeled through scalar conservation laws and high-resolution shock-capturing schemes. Use a Total Variation Diminishing (TVD) finite volume method with Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) reconstruction and the Hancock predictor, coupled with the local Lax-Friedrichs (Rusanov) numerical flux. The Courant-Friedrichs-Lewy (CFL) number, denoted by $\\nu$, is fixed and the time step is chosen adaptively to respect $\\Delta t \\le \\nu \\,\\Delta x / \\max \\alpha$, where $\\alpha$ is the characteristic speed. All variables in this problem are dimensionless, so no physical units are required.\n\nFundamental base for derivation:\n- The scalar conservation law is $u_t + f(u)_x = 0$ for a flux function $f(u)$.\n- For small-amplitude linear acoustics with constant sound speed $c$, use $f(u) = c\\,u$ for the advection of an acoustic variable $u$.\n- For nonlinear acoustic wave steepening, use the inviscid Burgers equation with $f(u) = \\tfrac{1}{2} u^2$.\n- The domain is periodic on $[0,1]$, and the initial condition is $u(x,0) = \\sin(2\\pi x)$ for all tests.\n- For the smooth advection test, the exact solution is $u(x,t) = \\sin(2\\pi(x - c t))$.\n\nAlgorithmic requirements:\n- Implement a TVD MUSCL-Hancock finite volume scheme:\n  - Reconstruct piecewise linear states with a limiter to obtain left and right interface values at time $t^n$.\n  - Evolve these interface values to $t^{n+1/2}$ using a Hancock predictor.\n  - Solve Riemann problems via the Rusanov flux at interfaces and update cell averages.\n- Use periodic boundary conditions.\n\nEmpirical convergence rate calculation:\n- For a smooth case with known exact solution, compute the $L^1$ error $E(N)$ between the numerical solution at time $T$ and the exact solution sampled at cell centers, for several grid sizes $N$. Estimate the observed order $p$ by fitting $\\log E(N)$ versus $\\log \\Delta x$ via least squares, where $\\Delta x = 1/N$.\n- In the presence of shocks, exact solutions are not available in closed form beyond shock formation. Instead, use self-convergence: for three nested grids with sizes $N_0$, $N_1 = 2 N_0$, and $N_2 = 4 N_0$, compute the $L^1$ differences $D_1 = \\|u_{N_0} - \\mathcal{R}(u_{N_1})\\|_{L^1}$ and $D_2 = \\|u_{N_1} - \\mathcal{R}(u_{N_2})\\|_{L^1}$, where $\\mathcal{R}$ denotes restriction by averaging pairs of fine cells onto the next coarser grid. Estimate $p$ by $p \\approx \\dfrac{\\log(D_1/D_2)}{\\log 2}$.\n\nWhy the observed order drops in shocks:\n- In smooth regions, linear reconstruction with the Hancock predictor delivers second-order consistency. However, in nonsmooth regions containing shocks, TVD limiters enforce monotonicity and compress reconstructed slopes to avoid spurious oscillations, which effectively reduces the local order to first order. The $L^1$ error is dominated by the $O(1)$ jump over an $O(\\Delta x)$ shock thickness, yielding $O(\\Delta x)$ scaling and an empirical order near $1$.\n\nTest Suite:\n- Test case $A$ (smooth advection):\n  - Model: $u_t + c\\,u_x = 0$, $c = 1$.\n  - Time: $T = 0.5$.\n  - Grids: $N \\in \\{50, 100, 200, 400\\}$.\n  - CFL number: $\\nu = 0.45$.\n  - Compute the empirical order $p_A$ by fitting $\\log E(N)$ versus $\\log \\Delta x$ as described.\n- Test case $B$ (nonlinear acoustics with shock):\n  - Model: $u_t + \\left(\\tfrac{1}{2}u^2\\right)_x = 0$.\n  - Time: $T = 0.3$ (post shock-formation time for the given sine wave initial condition, since the first shock forms at approximately $t_s = \\dfrac{1}{2\\pi}$).\n  - Grids: $N_0 = 200$, $N_1 = 400$, $N_2 = 800$.\n  - CFL number: $\\nu = 0.45$.\n  - Compute self-convergence order $p_B$ using the $D_1$, $D_2$ ratio defined above.\n- Test case $C$ (nonlinear acoustics pre-shock):\n  - Model: $u_t + \\left(\\tfrac{1}{2}u^2\\right)_x = 0$.\n  - Time: $T = 0.1$ (before shock-formation).\n  - Grids: $N_0 = 200$, $N_1 = 400$, $N_2 = 800$.\n  - CFL number: $\\nu = 0.45$.\n  - Compute self-convergence order $p_C$ as in test case $B$.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[p_A, p_B, p_C]$. For example, the program must print exactly in the format $[p_A,p_B,p_C]$ where $p_A$, $p_B$, and $p_C$ are floating-point numbers.",
            "solution": "The problem statement has been validated and found to be scientifically grounded, well-posed, and objective. It presents a standard, non-trivial problem in computational acoustics and fluid dynamics, specifying the governing equations, numerical methods, and analysis procedures with sufficient detail to permit a unique and meaningful solution. The problem is valid. A complete solution is provided below.\n\nThe core of the problem is to solve the scalar conservation law\n$$u_t + f(u)_x = 0$$\non a periodic domain $[0,1]$ using a high-resolution finite volume scheme. A finite volume method discretizes the domain into $N$ cells $I_i = [x_{i-1/2}, x_{i+1/2}]$ of size $\\Delta x = 1/N$, with cell centers $x_i = (i+1/2)\\Delta x$ for $i=0, \\dots, N-1$. The method evolves the cell averages, $u_i(t) \\approx \\frac{1}{\\Delta x} \\int_{I_i} u(x,t) dx$, forward in time. The semi-discrete form of the update equation is\n$$ \\frac{du_i}{dt} = -\\frac{1}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\nwhere $F_{i+1/2}$ is the numerical flux at the interface between cell $i$ and cell $i+1$. The problem specifies a Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) with a Hancock predictor and a Rusanov flux, which is a specific predictor-corrector approach for determining $F_{i+1/2}$ and updating the solution from time $t^n$ to $t^{n+1}$.\n\nThe MUSCL-Hancock scheme achieves second-order accuracy in space and time for smooth solutions. It consists of three main steps within each time step:\n\n1.  **Reconstruction:** Within each cell $i$, the data is represented by a piecewise linear function instead of a piecewise constant (cell average).\n    $$u_i(x, t^n) = u_i^n + \\frac{\\sigma_i}{\\Delta x}(x - x_i)$$\n    where $u_i^n$ is the cell average at time $t^n$. The slope $\\sigma_i$ is calculated using data from neighboring cells and is limited to prevent spurious oscillations near sharp gradients, thereby ensuring the Total Variation Diminishing (TVD) property. A standard choice for the slope limiter is the minmod function:\n    $$\\sigma_i = \\text{minmod}(u_{i+1}^n - u_i^n, u_i^n - u_{i-1}^n)$$\n    where $\\text{minmod}(a, b) = \\text{sgn}(a) \\max(0, \\min(|a|, b \\cdot \\text{sgn}(a)))$. This slope reconstruction yields states at the left and right boundaries of cell $i$:\n    $$u_{i,L} = u_i^n - \\frac{1}{2}\\sigma_i \\quad \\text{and} \\quad u_{i,R} = u_i^n + \\frac{1}{2}\\sigma_i$$\n\n2.  **Predictor (Hancock Step):** The reconstructed boundary values $u_{i,L}$ and $u_{i,R}$ are evolved forward over a half time step, $\\Delta t/2$, to obtain time-centered interface values. This prediction step is based on applying the conservation law within each cell:\n    $$u_i^* = u_i^n - \\frac{\\Delta t}{2\\Delta x} \\left(f(u_{i,R}) - f(u_{i,L})\\right)$$\n    The Hancock predictor assumes this update applies uniformly across the cell, so the predicted boundary values are:\n    $$u_{i,L}^* = u_{i,L} - \\frac{\\Delta t}{2\\Delta x} \\left(f(u_{i,R}) - f(u_{i,L})\\right)$$\n    $$u_{i,R}^* = u_{i,R} - \\frac{\\Delta t}{2\\Delta x} \\left(f(u_{i,R}) - f(u_{i,L})\\right)$$\n    At each interface $x_{i+1/2}$, we now have a pair of predicted states: the state on the left side is $u_{i,R}^*$ (from cell $i$), and the state on the right is $u_{i+1,L}^*$ (from cell $i+1$).\n\n3.  **Corrector (Flux and Update):** A Riemann problem is solved at each interface $x_{i+1/2}$ using the predicted states $(u_{i,R}^*, u_{i+1,L}^*)$. The problem specifies the local Lax-Friedrichs (Rusanov) numerical flux:\n    $$F(u_L, u_R) = \\frac{1}{2}\\left[ f(u_L) + f(u_R) - S_{\\max}(u_R - u_L) \\right]$$\n    where $S_{\\max} = \\max(|f'(u_L)|, |f'(u_R)|)$ is the maximum local characteristic speed. The numerical flux at interface $x_{i+1/2}$ is thus $F_{i+1/2} = F(u_{i,R}^*, u_{i+1,L}^*)$. Finally, the cell averages are updated to the next time level $t^{n+1} = t^n + \\Delta t$:\n    $$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right)$$\nThe time step $\\Delta t$ is chosen adaptively to satisfy the Courant-Friedrichs-Lewy (CFL) stability condition, $\\Delta t = \\nu \\Delta x / \\max_i |f'(u_i^n)|$, with a fixed CFL number $\\nu$.\n\nA key aspect of this problem is to analyze the empirical order of convergence. This method's accuracy depends on the smoothness of the solution.\nIn smooth regions, the minmod limiter allows for non-zero slopes, preserving the second-order accuracy of the linear reconstruction and Hancock predictor.\nHowever, in regions with shocks or steep gradients, the TVD limiter becomes active. To prevent oscillations, it \"flattens\" the reconstruction by setting the slope $\\sigma_i$ to zero or a small value. For example, at a sharp shock, the `minmod` function will typically pick the smaller slope, effectively reducing the scheme's spatial accuracy to first order in the immediate vicinity of the discontinuity. The global $L^1$ error, which is an integral over the domain, becomes dominated by this localized first-order error. The error at a shock of magnitude a constant $O(1)$ that is smeared over a region of width $O(\\Delta x)$ contributes an amount proportional to $O(\\Delta x)$ to the total $L^1$ error. Consequently, the global convergence rate degrades from second order ($p=2$) for smooth problems to first order ($p=1$) for problems with shocks.\n\nThe solution is computed for three test cases.\n\n**Test Case A: Smooth Advection**\nThe model is the linear advection equation, $u_t + c u_x = 0$, with $c=1$. The flux function is $f(u)=c u$ and its derivative is $f'(u)=c$. The initial condition $u(x,0)=\\sin(2\\pi x)$ is evolved to $T=0.5$. The exact solution is $u(x,T)=\\sin(2\\pi(x-cT))$. The $L^1$ error, $E(N) = \\Delta x \\sum_i |u_i(T) - u_{\\text{exact}}(x_i, T)|$, is computed for grids of size $N \\in \\{50, 100, 200, 400\\}$. The convergence order $p_A$ is estimated from the slope of a least-squares fit to $\\log(E(N))$ versus $\\log(\\Delta x)$. As the solution remains smooth, we expect $p_A \\approx 2$.\n\n**Test Case B: Nonlinear Acoustics with Shock**\nThe model is the inviscid Burgers' equation, $u_t + (\\frac{1}{2}u^2)_x = 0$, with $f(u)=\\frac{1}{2}u^2$ and $f'(u)=u$. The sine wave initial condition leads to wave steepening and the formation of a shock at time $t_s = 1/(2\\pi) \\approx 0.159$. The solution is computed to $T=0.3$, well after the shock has formed. Lacking a simple closed-form exact solution, a self-convergence study is performed using three nested grids ($N_0=200, N_1=400, N_2=800$). The solutions $u_{N_1}$ and $u_{N_2}$ are restricted to the coarser grids by averaging adjacent cell values. The $L^1$ differences $D_1 = \\|u_{N_0} - \\mathcal{R}(u_{N_1})\\|_{L^1}$ and $D_2 = \\|u_{N_1} - \\mathcal{R}(u_{N_2})\\|_{L^1}$ are computed. The convergence order is estimated as $p_B = \\log(D_1/D_2)/\\log(2)$. Due to the presence of the shock, we expect $p_B \\approx 1$.\n\n**Test Case C: Nonlinear Acoustics Pre-Shock**\nThis case uses the same Burgers' equation model as Test Case B but is evolved only to $T=0.1$, before the shock forms. The solution is still smooth, although it has steepened. The self-convergence analysis is repeated with the same three grids as in Test B. Since the solution remains smooth, the scheme should exhibit its designed second-order accuracy. We therefore expect to find $p_C \\approx 2$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational acoustics problem specified.\n    Implements a TVD MUSCL-Hancock finite volume scheme for scalar conservation laws.\n    Calculates empirical convergence orders for three test cases:\n    A) Smooth linear advection.\n    B) Nonlinear acoustics (Burgers' eq.) with a shock.\n    C) Nonlinear acoustics (Burgers' eq.) before shock formation.\n    \"\"\"\n\n    def muscl_solver(N, T, nu, f, f_prime, u0_func):\n        \"\"\"\n        A 1D finite volume solver using the MUSCL-Hancock scheme.\n        \n        Args:\n            N (int): Number of grid cells.\n            T (float): Final simulation time.\n            nu (float): CFL number.\n            f (callable): The flux function f(u).\n            f_prime (callable): The derivative of the flux function, f'(u).\n            u0_func (callable): Function to set the initial condition u(x, 0).\n\n        Returns:\n            numpy.ndarray: The numerical solution u at time T.\n        \"\"\"\n        dx = 1.0 / N\n        x = np.linspace(0.5 * dx, 1.0 - 0.5 * dx, N)\n        u = u0_func(x)\n\n        t = 0.0\n        while t  T:\n            # Adaptive time step based on CFL condition\n            max_speed = np.max(np.abs(f_prime(u)))\n            dt = nu * dx / max_speed if max_speed > 0 else T # Handle constant speed case\n            if t + dt > T:\n                dt = T - t\n\n            # Pad array with 2 ghost cells on each side for periodic BC\n            u_padded = np.pad(u, 2, 'wrap')\n\n            # 1. Reconstruction: Compute slopes with minmod limiter\n            # Differences for slope calculation: u_i - u_{i-1} and u_{i+1} - u_i\n            # u corresponds to u_padded[2:-2]\n            d_left = u_padded[2:-2] - u_padded[1:-3]\n            d_right = u_padded[3:-1] - u_padded[2:-2]\n            \n            # Vectorized minmod limiter: sgn(a) * max(0, min(|a|, b*sgn(a)))\n            # This handles the case where slopes have different signs (returns 0).\n            sigma_unlim = np.sign(d_left) * np.minimum(np.abs(d_left), d_right * np.sign(d_left))\n            sigma = np.where(d_left * d_right > 0, sigma_unlim, 0)\n\n            # 2. Predictor (Hancock): Evolve reconstructed boundary values\n            # Reconstructed values at cell edges (within each cell)\n            u_L_edge = u - 0.5 * sigma\n            u_R_edge = u + 0.5 * sigma\n            \n            # Flux difference within each cell\n            flux_diff_cell = f(u_R_edge) - f(u_L_edge)\n            \n            # Evolve edge values for dt/2\n            u_L_pred = u_L_edge - 0.5 * (dt / dx) * flux_diff_cell\n            u_R_pred = u_R_edge - 0.5 * (dt / dx) * flux_diff_cell\n\n            # 3. Corrector: Solve Riemann problems at interfaces with Rusanov flux\n            # States for Riemann problem at interface i+1/2:\n            # Left state is u_R_pred from cell i\n            # Right state is u_L_pred from cell i+1, handled by np.roll\n            u_L_flux = np.roll(u_L_pred, -1)\n            u_R_flux = u_R_pred\n            \n            # Rusanov flux calculation\n            s_max = np.maximum(np.abs(f_prime(u_L_flux)), np.abs(f_prime(u_R_flux)))\n            flux_interface = 0.5 * (f(u_L_flux) + f(u_R_flux) - s_max * (u_L_flux - u_R_flux))\n            \n            # Flux at previous interface (i-1/2)\n            flux_prev_interface = np.roll(flux_interface, 1)\n            \n            # 4. Update cell averages\n            u = u - (dt / dx) * (flux_interface - flux_prev_interface)\n\n            t += dt\n            \n        return u\n\n    def restrict(u_fine):\n        \"\"\"Restriction operator: average pairs of fine cells.\"\"\"\n        return 0.5 * (u_fine[0::2] + u_fine[1::2])\n\n    nu = 0.45\n    u0 = lambda x: np.sin(2 * np.pi * x)\n\n    # --- Test Case A: Smooth Advection ---\n    c = 1.0\n    f_A = lambda u: c * u\n    f_prime_A = lambda u: c * np.ones_like(u)\n    T_A = 0.5\n    N_A_vals = np.array([50, 100, 200, 400])\n    dx_A_vals = 1.0 / N_A_vals\n    errors_A = []\n\n    for N in N_A_vals:\n        u_num = muscl_solver(N, T_A, nu, f_A, f_prime_A, u0)\n        x = np.linspace(0.5 / N, 1.0 - 0.5 / N, N)\n        u_exact = np.sin(2 * np.pi * (x - c * T_A))\n        error_l1 = np.sum(np.abs(u_num - u_exact)) * (1.0 / N)\n        errors_A.append(error_l1)\n    \n    log_dx_A = np.log(dx_A_vals)\n    log_err_A = np.log(errors_A)\n    p_A = np.polyfit(log_dx_A, log_err_A, 1)[0]\n\n    # --- Test Case B: Nonlinear with Shock ---\n    f_B = lambda u: 0.5 * u**2\n    f_prime_B = lambda u: u\n    T_B = 0.3\n    N_B_vals = [200, 400, 800]\n    \n    u_N0 = muscl_solver(N_B_vals[0], T_B, nu, f_B, f_prime_B, u0)\n    u_N1 = muscl_solver(N_B_vals[1], T_B, nu, f_B, f_prime_B, u0)\n    u_N2 = muscl_solver(N_B_vals[2], T_B, nu, f_B, f_prime_B, u0)\n    \n    u_N1_r = restrict(u_N1)\n    u_N2_r = restrict(u_N2)\n    \n    D1 = np.sum(np.abs(u_N0 - u_N1_r)) * (1.0 / N_B_vals[0])\n    D2 = np.sum(np.abs(u_N1 - u_N2_r)) * (1.0 / N_B_vals[1])\n    \n    p_B = np.log(D1 / D2) / np.log(2.0)\n\n    # --- Test Case C: Nonlinear Pre-Shock ---\n    T_C = 0.1\n    \n    u_N0_C = muscl_solver(N_B_vals[0], T_C, nu, f_B, f_prime_B, u0)\n    u_N1_C = muscl_solver(N_B_vals[1], T_C, nu, f_B, f_prime_B, u0)\n    u_N2_C = muscl_solver(N_B_vals[2], T_C, nu, f_B, f_prime_B, u0)\n\n    u_N1_r_C = restrict(u_N1_C)\n    u_N2_r_C = restrict(u_N2_C)\n    \n    D1_C = np.sum(np.abs(u_N0_C - u_N1_r_C)) * (1.0 / N_B_vals[0])\n    D2_C = np.sum(np.abs(u_N1_C - u_N2_r_C)) * (1.0 / N_B_vals[1])\n    \n    p_C = np.log(D1_C / D2_C) / np.log(2.0)\n    \n    results = [p_A, p_B, p_C]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}