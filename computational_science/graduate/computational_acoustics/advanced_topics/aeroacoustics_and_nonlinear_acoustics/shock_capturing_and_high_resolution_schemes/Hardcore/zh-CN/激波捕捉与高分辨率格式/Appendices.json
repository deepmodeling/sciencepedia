{
    "hands_on_practices": [
        {
            "introduction": "Godunov 方法为现代激波捕捉格式奠定了概念基础。其核心思想是通过求解每个界面上的精确黎曼问题来计算单元间的数值通量。这个基础练习将引导您完成非粘性 Burgers 方程的这一过程，该方程是研究非线性声学的关键模型，让您能够将物理上的解（激波）与最终的数值通量直接联系起来。",
            "id": "4136718",
            "problem": "考虑由无粘性伯格斯方程建模的无量纲变量中的一维非线性声波传播，这是一个标量守恒律，\n$$\nu_{t} + \\left(\\frac{1}{2} u^{2}\\right)_{x} = 0,\n$$\n其中 $u(x,t)$ 表示无量纲速度势梯度。在 Godunov 型的激波捕捉有限体积法中，界面处的单元间数值通量被定义为，根据具有左右常数状态的黎曼问题的精确自相似解，在界面位置 $x=0$ 处计算的物理通量。\n\n在某个特定界面处，左右状态为\n$$\nu_{L} = 1.5, \\quad u_{R} = -0.5.\n$$\n将这些状态视为 $x=0$ 处黎曼问题的初始数据：\n$$\nu(x,0) = \\begin{cases}\nu_{L},   x0, \\\\\nu_{R},   x>0.\n\\end{cases}\n$$\n\n从守恒律和弱解的定义出发，确定适当的自相似解（激波或稀疏波），如果形成激波，则使用郎肯-雨贡纽跳跃条件确定波速，然后计算 Godunov 单元间通量 $F_{G}$，其定义为沿着黎曼问题的精确解在 $x=0$ 和 $t>0$ 处的物理通量 $\\frac{1}{2}u^{2}$。以无量纲单位的单个实数表示您的最终答案。无需四舍五入。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它提出了计算流体动力学领域中一个关于无粘性伯格斯方程黎曼问题解的标准问题。所有必要信息都已提供，并且所要求的量是明确定义的。\n\n控制方程是无粘性伯格斯方程，一种形式为 $u_{t} + f(u)_{x} = 0$ 的标量守恒律，其中 $u(x,t)$ 是守恒变量，$f(u)$ 是通量函数。\n对于此问题，通量函数由下式给出\n$$\nf(u) = \\frac{1}{2} u^{2}\n$$\n该问题考虑的是具有初始数据的黎曼问题的精确解，该初始数据由在 $x=0$ 处被间断分开的两个恒定状态 $u_{L}$ 和 $u_{R}$ 组成：\n$$\nu(x,0) = \\begin{cases}\nu_{L} = 1.5,   x0 \\\\\nu_{R} = -0.5,   x>0\n\\end{cases}\n$$\n这个黎曼问题的解是自相似的，意味着它仅取决于比值 $\\xi = x/t$。解的性质，无论是激波还是稀疏波，都由与左右状态相关的特征速度决定。特征速度 $a(u)$ 由通量函数的导数给出：\n$$\na(u) = f'(u) = \\frac{d}{du}\\left(\\frac{1}{2} u^{2}\\right) = u\n$$\n我们计算给定左右状态的特征速度：\n$$\na(u_{L}) = u_{L} = 1.5\n$$\n$$\na(u_{R}) = u_{R} = -0.5\n$$\n由于 $a(u_{L}) > a(u_{R})$ （即 $1.5 > -0.5$），特征线是汇聚的，这导致形成称为激波的间断解。如果特征线是发散的（$a(u_{L})  a(u_{R})$），解将是一个连续的稀疏波。\n\n对于激波，间断的速度 $s$ 必须满足郎肯-雨贡纽跳跃条件。该条件确保守恒律的积分形式在间断处得到满足。它由下式给出：\n$$\ns = \\frac{\\Delta f}{\\Delta u} = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}\n$$\n我们首先计算左右状态的通量值：\n$$\nf(u_{L}) = f(1.5) = \\frac{1}{2} (1.5)^{2} = \\frac{1}{2} (2.25) = 1.125\n$$\n$$\nf(u_{R}) = f(-0.5) = \\frac{1}{2} (-0.5)^{2} = \\frac{1}{2} (0.25) = 0.125\n$$\n现在，我们将这些值与 $u_{L}$ 和 $u_{R}$ 一起代入郎肯-雨贡纽条件，以求出激波速度 $s$：\n$$\ns = \\frac{0.125 - 1.125}{-0.5 - 1.5} = \\frac{-1.0}{-2.0} = 0.5\n$$\n激波速度为 $s = 0.5$。由于 $s > 0$，激波向右传播，进入 $x > 0$ 的区域。因此，$u(x,t)$ 的自相似解由下式给出：\n$$\nu(x,t) = u(x/t) = \\begin{cases}\nu_{L} = 1.5,   \\text{if } x/t  s = 0.5 \\\\\nu_{R} = -0.5,   \\text{if } x/t > s = 0.5\n\\end{cases}\n$$\nGodunov 单元间通量 $F_{G}$ 定义为在单元界面（位于 $x=0$）处对任何时间 $t > 0$ 计算的物理通量。我们需要确定该位置处的状态 $u$ 的值，即 $u(0,t)$。这对应于自相似变量值 $\\xi = x/t = 0/t = 0$。\n\n根据激波解的结构，我们必须将 $\\xi=0$ 与激波速度 $s=0.5$ 进行比较。由于 $0  0.5$，位置 $x=0$ 位于状态为 $u_{L}$ 的区域内。\n因此，对于任何 $t>0$，界面处的状态是：\n$$\nu(0,t) = u_{L} = 1.5\n$$\nGodunov 通量 $F_{G}$ 是在此状态下计算的物理通量 $f(u)$：\n$$\nF_{G} = f(u(0,t)) = f(u_{L}) = f(1.5)\n$$\n使用我们先前计算的 $f(1.5)$ 的值：\n$$\nF_{G} = 1.125\n$$\n这是给定黎曼问题的单元间数值通量的值。",
            "answer": "$$\\boxed{1.125}$$"
        },
        {
            "introduction": "为了改进 Godunov 格式的一阶精度，像 MUSCL 这样的高分辨率方法在每个计算单元内引入了更复杂的数据表示。本练习聚焦于分段线性重构这一关键步骤，以及为保证稳定性而使用的斜率限制器。通过应用 `minmod` 限制器，您将亲身体验这些格式如何避免在陡峭梯度附近产生伪振荡，这是稳健捕捉激波所必需的特性。",
            "id": "4136698",
            "problem": "考虑一个间距为 $\\Delta x$ 的均匀网格上的一维线性声学问题，该问题由守恒形式的线性化欧拉方程组控制：\n$$\n\\frac{\\partial p}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0, \\qquad \\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x} = 0,\n$$\n其中 $p$ 是声压，$u$ 是质点速度，$\\rho_{0}$ 是环境密度，$c$ 是声速。在高分辨率激波捕捉有限体积法中，例如守恒律单调上游中心格式 (Monotonic Upstream-centered Scheme for Conservation Laws, MUSCL)，在每个单元内部使用斜率限制器重构分段线性剖面，以确保总变差减小 (Total Variation Diminishing, TVD) 特性。对于标量场（此处为 $p$）的重构，单元 $i$ 内的受限斜率由 minmod 限制器定义为：\n$$\ns_{i} = \\operatorname{minmod}\\!\\left(\\frac{p_{i} - p_{i-1}}{\\Delta x}, \\frac{p_{i+1} - p_{i}}{\\Delta x}\\right),\n$$\n其中 minmod 函数为\n$$\n\\operatorname{minmod}(a,b) = \n\\begin{cases}\n\\phantom{-}\\min\\{|a|,|b|\\} \\,\\operatorname{sign}(a),  \\text{if } \\operatorname{sign}(a)=\\operatorname{sign}(b), \\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n利用此斜率，从单元 $i$ 重构的 MUSCL 左右界面状态为\n$$\np_{i,-}^{R} = p_{i} - \\frac{\\Delta x}{2} \\, s_{i} \\quad \\text{在 } x_{i-\\frac{1}{2}}, \n\\qquad \np_{i,+}^{L} = p_{i} + \\frac{\\Delta x}{2} \\, s_{i} \\quad \\text{在 } x_{i+\\frac{1}{2}},\n$$\n其中 $p_{i,-}^{R}$ 表示来自单元 $i$ 的左侧界面的右状态，$p_{i,+}^{L}$ 表示来自单元 $i$ 的右侧界面的左状态。\n\n假设一个均匀网格，其间距 $\\Delta x = 1\\,\\mathrm{m}$，且具有以下单元平均压力：$p_{i-1} = 100\\,\\mathrm{Pa}$，$p_{i} = 200\\,\\mathrm{Pa}$，$p_{i+1} = 300\\,\\mathrm{Pa}$。使用 minmod 限制器计算受限斜率 $s_{i}$，然后计算在 $x_{i-\\frac{1}{2}}$ 处的 MUSCL 重构界面状态 $p_{i,-}^{R}$ 和在 $x_{i+\\frac{1}{2}}$ 处的 $p_{i,+}^{L}$。\n\n斜率以 $\\mathrm{Pa}/\\mathrm{m}$ 为单位，界面状态以 $\\mathrm{Pa}$ 为单位表示。无需四舍五入，请提供精确值。最终答案应为一个单行矩阵，依次包含受限斜率 $s_{i}$、左界面状态 $p_{i,-}^{R}$ 和右界面状态 $p_{i,+}^{L}$。",
            "solution": "本题要求使用带有 minmod 限制器的守恒律单调上游中心格式 (MUSCL)，根据给定的单元平均压力，计算受限斜率和重构的界面状态。\n\n### 步骤 1：提取已知条件\n题目提供了以下信息：\n- 单元平均压力：$p_{i-1} = 100\\,\\mathrm{Pa}$，$p_{i} = 200\\,\\mathrm{Pa}$，$p_{i+1} = 300\\,\\mathrm{Pa}$。\n- 均匀网格间距：$\\Delta x = 1\\,\\mathrm{m}$。\n- 单元 $i$ 中斜率 $s_{i}$ 的 minmod 限制器定义：\n$$s_{i} = \\operatorname{minmod}\\!\\left(\\frac{p_{i} - p_{i-1}}{\\Delta x}, \\frac{p_{i+1} - p_{i}}{\\Delta x}\\right)$$\n- minmod 函数的定义：\n$$\n\\operatorname{minmod}(a,b) = \n\\begin{cases}\n\\phantom{-}\\min\\{|a|,|b|\\} \\,\\operatorname{sign}(a),  \\text{if } \\operatorname{sign}(a)=\\operatorname{sign}(b), \\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n- 从单元 $i$ 重构的 MUSCL 界面状态公式：\n  - 左侧界面 ($x_{i-\\frac{1}{2}}$) 的右状态：$p_{i,-}^{R} = p_{i} - \\frac{\\Delta x}{2} \\, s_{i}$\n  - 右侧界面 ($x_{i+\\frac{1}{2}}$) 的左状态：$p_{i,+}^{L} = p_{i} + \\frac{\\Delta x}{2} \\, s_{i}$\n\n### 步骤 2：使用提取的已知条件进行验证\n问题验证如下：\n- **科学依据：** 问题描述了 MUSCL 格式和 minmod 限制器，它们是计算流体动力学和声学中求解双曲守恒律的标准且成熟的技术。声学的线性化欧拉方程是基础。因此，该问题在科学上是合理的。\n- **适定性：** 问题提供了计算唯一解所需的所有必要数据和明确的公式。定义清晰而精确。\n- **客观性：** 问题使用正式的数学和物理语言陈述，没有主观或基于观点的论断。\n- **完整性和一致性：** 所有需要的值（$p_{i-1}$、$p_{i}$、$p_{i+1}$、$\\Delta x$）都已提供。定义和公式是自洽的。关于声学方程的背景信息没有产生任何矛盾，因为所需的计算纯粹是关于空间重构步骤。\n\n该问题被认为是有效的。\n\n### 步骤 3：求解\n求解过程首先计算受限斜率 $s_i$，然后用它来求得界面状态 $p_{i,-}^{R}$ 和 $p_{i,+}^{L}$。\n\n**第 1 部分：计算受限斜率 $s_i$**\n\n受限斜率 $s_i$ 由后向差分斜率和前向差分斜率的 `minmod` 运算决定。\n\n首先，我们计算 `minmod` 函数的两个参数。\n后向差分斜率为：\n$$ a = \\frac{p_{i} - p_{i-1}}{\\Delta x} = \\frac{200 - 100}{1} = 100\\,\\mathrm{Pa}/\\mathrm{m} $$\n前向差分斜率为：\n$$ b = \\frac{p_{i+1} - p_{i}}{\\Delta x} = \\frac{300 - 200}{1} = 100\\,\\mathrm{Pa}/\\mathrm{m} $$\n现在，我们将 `minmod` 函数应用于这两个值：\n$$ s_{i} = \\operatorname{minmod}(a, b) = \\operatorname{minmod}(100, 100) $$\n根据 `minmod` 函数的定义，我们首先检查参数的符号。\n$$ \\operatorname{sign}(a) = \\operatorname{sign}(100) = +1 $$\n$$ \\operatorname{sign}(b) = \\operatorname{sign}(100) = +1 $$\n由于 $\\operatorname{sign}(a) = \\operatorname{sign}(b)$，适用 `minmod` 定义的第一种情况：\n$$ s_{i} = \\min\\{|a|, |b|\\} \\operatorname{sign}(a) = \\min\\{|100|, |100|\\} \\operatorname{sign}(100) $$\n$$ s_{i} = \\min\\{100, 100\\} \\times 1 = 100 \\times 1 = 100\\,\\mathrm{Pa}/\\mathrm{m} $$\n因此，受限斜率为 $s_{i} = 100\\,\\mathrm{Pa}/\\mathrm{m}$。这个结果是符合预期的，因为数据点位于一条直线上，限制器正确地再现了该直线的梯度。\n\n**第 2 部分：计算界面状态 $p_{i,-}^{R}$ 和 $p_{i,+}^{L}$**\n\n接下来，我们使用计算出的斜率 $s_i$ 来求得单元界面上重构的压力值。\n\n左侧界面的右状态 $p_{i,-}^{R}$，使用以下公式计算：\n$$ p_{i,-}^{R} = p_{i} - \\frac{\\Delta x}{2} s_{i} $$\n代入给定值和计算值：\n$$ p_{i,-}^{R} = 200 - \\frac{1}{2} \\times 100 = 200 - 50 = 150\\,\\mathrm{Pa} $$\n\n右侧界面的左状态 $p_{i,+}^{L}$，使用以下公式计算：\n$$ p_{i,+}^{L} = p_{i} + \\frac{\\Delta x}{2} s_{i} $$\n代入给定值和计算值：\n$$ p_{i,+}^{L} = 200 + \\frac{1}{2} \\times 100 = 200 + 50 = 250\\,\\mathrm{Pa} $$\n\n最终结果是：受限斜率 $s_i=100\\,\\mathrm{Pa}/\\mathrm{m}$，左界面状态 $p_{i,-}^{R}=150\\,\\mathrm{Pa}$，以及右界面状态 $p_{i,+}^{L}=250\\,\\mathrm{Pa}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 100  150  250 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "数值格式的最终检验在于其实际性能。这个综合性练习要求您实现一个完整的 TVD MUSCL-Hancock 格式，并进行收敛阶分析——这是代码验证中的一个标准且至关重要的任务。通过在光滑流和含激波流上测试该格式，您将凭经验验证高分辨率方法的决定性特征：它们能够在光滑区域达到高阶精度，同时在捕捉不连续点时优雅地降阶以保持稳健且无振荡，正如前面练习 (, ) 所探讨的那样。",
            "id": "4136762",
            "problem": "考虑通过标量守恒律和高分辨率激波捕捉格式建模的一维非线性声学。使用总变差递减（TVD）有限体积法，该方法采用守恒律单调上游中心格式（MUSCL）重构和 Hancock 预测子，并与局部 Lax-Friedrichs (Rusanov) 数值通量相结合。Courant-Friedrichs-Lewy (CFL) 数（记为 $\\nu$）是固定的，时间步长自适应选择以满足 $\\Delta t \\le \\nu \\,\\Delta x / \\max \\alpha$，其中 $\\alpha$ 是特征速度。本问题中的所有变量均为无量纲，因此不需要物理单位。\n\n推导的基本依据：\n- 标量守恒律为 $u_t + f(u)_x = 0$，其中 $f(u)$ 是通量函数。\n- 对于声速 $c$ 恒定的小振幅线性声学，使用 $f(u) = c\\,u$ 来描述声学变量 $u$ 的平流。\n- 对于非线性声波的陡峭化，使用无粘性 Burgers 方程，其通量函数为 $f(u) = \\tfrac{1}{2} u^2$。\n- 在所有测试中，区域为 $[0,1]$ 上的周期性区域，初始条件为 $u(x,0) = \\sin(2\\pi x)$。\n- 对于平滑平流测试，精确解为 $u(x,t) = \\sin(2\\pi(x - c t))$。\n\n算法要求：\n- 实现一个 TVD MUSCL-Hancock 有限体积格式：\n  - 使用限制器重构分段线性状态，以获得 $t^n$ 时刻的左右界面值。\n  - 使用 Hancock 预测子将这些界面值演化到 $t^{n+1/2}$ 时刻。\n  - 通过 Rusanov 通量在界面处求解黎曼问题，并更新单元平均值。\n- 使用周期性边界条件。\n\n经验收敛阶计算：\n- 对于具有已知精确解的光滑情况，计算在时间 $T$ 的数值解与在单元中心采样的精确解之间的 $L^1$ 误差 $E(N)$，这需要对几个网格尺寸 $N$ 进行计算。通过最小二乘法拟合 $\\log E(N)$ 与 $\\log \\Delta x$ 的关系来估计观测阶 $p$，其中 $\\Delta x = 1/N$。\n- 在存在激波的情况下，激波形成后的精确解没有闭合形式。此时应使用自收敛方法：对于三个嵌套网格，尺寸分别为 $N_0$、$N_1 = 2 N_0$ 和 $N_2 = 4 N_0$，计算 $L^1$ 差值 $D_1 = \\|u_{N_0} - \\mathcal{R}(u_{N_1})\\|_{L^1}$ 和 $D_2 = \\|u_{N_1} - \\mathcal{R}(u_{N_2})\\|_{L^1}$，其中 $\\mathcal{R}$ 表示通过对精细网格上的单元对进行平均来将其限制到下一个更粗的网格上。通过 $p \\approx \\dfrac{\\log(D_1/D_2)}{\\log 2}$ 来估计 $p$。\n\n为什么在激波处观测阶会下降：\n- 在光滑区域，带有 Hancock 预测子的线性重构可提供二阶一致性。然而，在包含激波的非光滑区域，TVD 限制器强制执行单调性并压缩重构的斜率以避免伪振荡，这实际上将局部阶降至一阶。$L^1$ 误差由一个跨越 $O(\\Delta x)$ 激波厚度的 $O(1)$ 跳跃主导，从而产生 $O(\\Delta x)$ 的缩放行为和接近 1 的经验阶。\n\n测试套件：\n- 测试用例 A（光滑平流）：\n  - 模型：$u_t + c\\,u_x = 0$，$c = 1$。\n  - 时间：$T = 0.5$。\n  - 网格：$N \\in \\{50, 100, 200, 400\\}$。\n  - CFL 数：$\\nu = 0.45$。\n  - 如上所述，通过拟合 $\\log E(N)$ 与 $\\log \\Delta x$ 来计算经验阶 $p_A$。\n- 测试用例 B（带激波的非线性声学）：\n  - 模型：$u_t + \\left(\\tfrac{1}{2}u^2\\right)_x = 0$。\n  - 时间：$T = 0.3$（对于给定的正弦波初始条件，这是激波形成后的时间，因为第一个激波大约在 $t_s = \\dfrac{1}{2\\pi}$ 时形成）。\n  - 网格：$N_0 = 200$，$N_1 = 400$，$N_2 = 800$。\n  - CFL 数：$\\nu = 0.45$。\n  - 使用上面定义的 $D_1$、$D_2$ 比率计算自收敛阶 $p_B$。\n- 测试用例 C（激波前的非线性声学）：\n  - 模型：$u_t + \\left(\\tfrac{1}{2}u^2\\right)_x = 0$。\n  - 时间：$T = 0.1$（激波形成之前）。\n  - 网格：$N_0 = 200$，$N_1 = 400$，$N_2 = 800$。\n  - CFL 数：$\\nu = 0.45$。\n  - 与测试用例 B 一样，计算自收敛阶 $p_C$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[p_A, p_B, p_C]$。例如，程序必须严格按照 $[p_A,p_B,p_C]$ 的格式打印，其中 $p_A$、$p_B$ 和 $p_C$ 是浮点数。",
            "solution": "问题陈述已经过验证，被认为是科学合理的、适定的和客观的。它提出了一个计算声学和流体动力学中的标准而非平凡的问题，详细说明了控制方程、数值方法和分析程序，足以得出一个唯一且有意义的解。该问题有效。下面提供了完整的解答。\n\n问题的核心是使用高分辨率有限体积格式在周期性区域 $[0,1]$ 上求解标量守恒律 $$u_t + f(u)_x = 0$$。\n有限体积法将区域离散化为 $N$ 个大小为 $\\Delta x = 1/N$ 的单元 $I_i = [x_{i-1/2}, x_{i+1/2}]$，单元中心为 $x_i = (i+1/2)\\Delta x$，其中 $i=0, \\dots, N-1$。该方法将单元平均值 $u_i(t) \\approx \\frac{1}{\\Delta x} \\int_{I_i} u(x,t) dx$ 在时间上向前推进。更新方程的半离散形式为\n$$ \\frac{du_i}{dt} = -\\frac{1}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\n其中 $F_{i+1/2}$ 是单元 $i$ 和单元 $i+1$ 之间界面上的数值通量。问题指定了带有 Hancock 预测子和 Rusanov 通量的守恒律单调上游中心格式 (MUSCL)，这是一种用于确定 $F_{i+1/2}$ 并将解从时间 $t^n$ 更新到 $t^{n+1}$ 的特定预测-校正方法。\n\n对于光滑解，MUSCL-Hancock 格式在空间和时间上均达到二阶精度。它在每个时间步内包括三个主要步骤：\n\n1.  **重构：** 在每个单元 $i$ 内，数据由分段线性函数表示，而不是分段常数（单元平均值）。\n    $$u_i(x, t^n) = u_i^n + \\frac{\\sigma_i}{\\Delta x}(x - x_i)$$\n    其中 $u_i^n$ 是 $t^n$ 时刻的单元平均值。斜率 $\\sigma_i$ 使用相邻单元的数据计算，并加以限制以防止在陡峭梯度附近产生伪振荡，从而确保总变差递减（TVD）属性。斜率限制器的标准选择是 minmod 函数：\n    $$\\sigma_i = \\text{minmod}(u_{i+1}^n - u_i^n, u_i^n - u_{i-1}^n)$$\n    其中 $\\text{minmod}(a, b) = \\text{sgn}(a) \\max(0, \\min(|a|, b \\cdot \\text{sgn}(a)))$。这种斜率重构得出了单元 $i$ 左右边界上的状态：\n    $$u_{i,L} = u_i^n - \\frac{1}{2}\\sigma_i \\quad \\text{和} \\quad u_{i,R} = u_i^n + \\frac{1}{2}\\sigma_i$$\n\n2.  **预测子 (Hancock 步)：** 重构的边界值 $u_{i,L}$ 和 $u_{i,R}$ 在半个时间步 $\\Delta t/2$ 内向前演化，以获得时间中心化的界面值。此预测步骤基于在每个单元内应用守恒律：\n    $$u_i^* = u_i^n - \\frac{\\Delta t}{2\\Delta x} \\left(f(u_{i,R}) - f(u_{i,L})\\right)$$\n    Hancock 预测子假设此更新在整个单元内均匀适用，因此预测的边界值为：\n    $$u_{i,L}^* = u_{i,L} - \\frac{\\Delta t}{2\\Delta x} \\left(f(u_{i,R}) - f(u_{i,L})\\right)$$\n    $$u_{i,R}^* = u_{i,R} - \\frac{\\Delta t}{2\\Delta x} \\left(f(u_{i,R}) - f(u_{i,L})\\right)$$\n    在每个界面 $x_{i+1/2}$ 处，我们现在有一对预测状态：左侧状态是 $u_{i,R}^*$（来自单元 $i$），右侧状态是 $u_{i+1,L}^*$（来自单元 $i+1$）。\n\n3.  **校正子 (通量与更新)：** 在每个界面 $x_{i+1/2}$ 处使用预测状态 $(u_{i,R}^*, u_{i+1,L}^*)$ 求解一个黎曼问题。问题指定了局部 Lax-Friedrichs (Rusanov) 数值通量：\n    $$ F(u_L, u_R) = \\frac{1}{2}\\left[ f(u_L) + f(u_R) - S_{\\max}(u_R - u_L) \\right] $$\n    其中 $S_{\\max} = \\max(|f'(u_L)|, |f'(u_R)|)$ 是最大局部特征速度。因此，界面 $x_{i+1/2}$ 处的数值通量为 $F_{i+1/2} = F(u_{i,R}^*, u_{i+1,L}^*)$。最后，将单元平均值更新到下一个时间层 $t^{n+1} = t^n + \\Delta t$：\n    $$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\n时间步 $\\Delta t$ 被自适应选择以满足 Courant-Friedrichs-Lewy (CFL) 稳定性条件 $\\Delta t = \\nu \\Delta x / \\max_i |f'(u_i^n)|$，其中 CFL 数 $\\nu$ 是固定的。\n\n此问题的一个关键方面是分析经验收敛阶。该方法的精度取决于解的光滑性。\n在光滑区域，minmod 限制器允许非零斜率，从而保留了线性重构和 Hancock 预测子的二阶精度。\n然而，在有激波或陡峭梯度的区域，TVD 限制器会变得活跃。为防止振荡，它通过将斜率 $\\sigma_i$ 设置为零或一个很小的值来“平坦化”重构。例如，在一个尖锐的激波处，`minmod` 函数通常会选择较小的斜率，从而有效地将格式在间断点附近的局部空间精度降低到一阶。全局 $L^1$ 误差是整个区域上的积分，它将由这种局部化的一阶误差主导。在一个大小为常数 $O(1)$ 的激波处，误差被涂抹在宽度为 $O(\\Delta x)$ 的区域上，对总 $L^1$ 误差的贡献与 $O(\\Delta x)$ 成正比。因此，对于有激波的问题，全局收敛阶从光滑问题的二阶（$p=2$）降至一阶（$p=1$）。\n\n为三个测试用例计算了解。\n\n**测试用例 A：光滑平流**\n模型是线性平流方程 $u_t + c u_x = 0$，其中 $c=1$。通量函数为 $f(u)=c u$，其导数为 $f'(u)=c$。初始条件 $u(x,0)=\\sin(2\\pi x)$ 被演化到 $T=0.5$。精确解为 $u(x,T)=\\sin(2\\pi(x-cT))$。对于大小为 $N \\in \\{50, 100, 200, 400\\}$ 的网格，计算 $L^1$ 误差 $E(N) = \\Delta x \\sum_i |u_i(T) - u_{\\text{exact}}(x_i, T)|$。收敛阶 $p_A$ 通过对 $\\log(E(N))$ 与 $\\log(\\Delta x)$ 进行最小二乘拟合的斜率来估计。由于解保持光滑，我们期望 $p_A \\approx 2$。\n\n**测试用例 B：带激波的非线性声学**\n模型是无粘性 Burgers' 方程 $u_t + (\\frac{1}{2}u^2)_x = 0$，其中 $f(u)=\\frac{1}{2}u^2$ 且 $f'(u)=u$。正弦波初始条件导致波形陡峭化，并在时间 $t_s = 1/(2\\pi) \\approx 0.159$ 形成激波。解被计算到 $T=0.3$，此时激波已形成很久。由于缺乏简单的闭合形式精确解，使用三个嵌套网格（$N_0=200, N_1=400, N_2=800$）进行自收敛研究。解 $u_{N_1}$ 和 $u_{N_2}$ 通过对相邻单元值进行平均来限制到较粗的网格上。计算 $L^1$ 差值 $D_1 = \\|u_{N_0} - \\mathcal{R}(u_{N_1})\\|_{L^1}$ 和 $D_2 = \\|u_{N_1} - \\mathcal{R}(u_{N_2})\\|_{L^1}$。收敛阶估计为 $p_B = \\log(D_1/D_2)/\\log(2)$。由于激波的存在，我们期望 $p_B \\approx 1$。\n\n**测试用例 C：激波前的非线性声学**\n此用例使用与测试用例 B 相同的 Burgers' 方程模型，但只演化到 $T=0.1$，即激波形成之前。此时解虽然已经陡峭化，但仍然是光滑的。使用与测试 B 相同的三个网格重复自收敛分析。由于解保持光滑，该格式应表现出其设计的二阶精度。因此，我们期望得到 $p_C \\approx 2$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational acoustics problem specified.\n    Implements a TVD MUSCL-Hancock finite volume scheme for scalar conservation laws.\n    Calculates empirical convergence orders for three test cases:\n    A) Smooth linear advection.\n    B) Nonlinear acoustics (Burgers' eq.) with a shock.\n    C) Nonlinear acoustics (Burgers' eq.) before shock formation.\n    \"\"\"\n\n    def muscl_solver(N, T, nu, f, f_prime, u0_func):\n        \"\"\"\n        A 1D finite volume solver using the MUSCL-Hancock scheme.\n        \n        Args:\n            N (int): Number of grid cells.\n            T (float): Final simulation time.\n            nu (float): CFL number.\n            f (callable): The flux function f(u).\n            f_prime (callable): The derivative of the flux function, f'(u).\n            u0_func (callable): Function to set the initial condition u(x, 0).\n\n        Returns:\n            numpy.ndarray: The numerical solution u at time T.\n        \"\"\"\n        dx = 1.0 / N\n        x = np.linspace(0.5 * dx, 1.0 - 0.5 * dx, N)\n        u = u0_func(x)\n\n        t = 0.0\n        while t  T:\n            # Adaptive time step based on CFL condition\n            max_speed = np.max(np.abs(f_prime(u)))\n            dt = nu * dx / max_speed if max_speed > 0 else T # Handle constant speed case\n            if t + dt > T:\n                dt = T - t\n\n            # Pad array with 2 ghost cells on each side for periodic BC\n            u_padded = np.pad(u, 2, 'wrap')\n\n            # 1. Reconstruction: Compute slopes with minmod limiter\n            # Differences for slope calculation: u_i - u_{i-1} and u_{i+1} - u_i\n            # u corresponds to u_padded[2:-2]\n            d_left = u_padded[2:-2] - u_padded[1:-3]\n            d_right = u_padded[3:-1] - u_padded[2:-2]\n            \n            # Vectorized minmod limiter: sgn(a) * max(0, min(|a|, b*sgn(a)))\n            # This handles the case where slopes have different signs (returns 0).\n            sigma_unlim = np.sign(d_left) * np.minimum(np.abs(d_left), d_right * np.sign(d_left))\n            sigma = np.where(d_left * d_right > 0, sigma_unlim, 0)\n\n            # 2. Predictor (Hancock): Evolve reconstructed boundary values\n            # Reconstructed values at cell edges (within each cell)\n            u_L_edge = u - 0.5 * sigma\n            u_R_edge = u + 0.5 * sigma\n            \n            # Flux difference within each cell\n            flux_diff_cell = f(u_R_edge) - f(u_L_edge)\n            \n            # Evolve edge values for dt/2\n            u_L_pred = u_L_edge - 0.5 * (dt / dx) * flux_diff_cell\n            u_R_pred = u_R_edge - 0.5 * (dt / dx) * flux_diff_cell\n\n            # 3. Corrector: Solve Riemann problems at interfaces with Rusanov flux\n            # States for Riemann problem at interface i+1/2:\n            # Left state is u_R_pred from cell i\n            # Right state is u_L_pred from cell i+1, handled by np.roll\n            u_left_at_interface = u_R_pred\n            u_right_at_interface = np.roll(u_L_pred, -1)\n            \n            # Rusanov flux calculation\n            s_max = np.maximum(np.abs(f_prime(u_left_at_interface)), np.abs(f_prime(u_right_at_interface)))\n            flux_interface = 0.5 * (f(u_left_at_interface) + f(u_right_at_interface) - s_max * (u_right_at_interface - u_left_at_interface))\n            \n            # Flux at previous interface (i-1/2)\n            flux_prev_interface = np.roll(flux_interface, 1)\n            \n            # 4. Update cell averages\n            u = u - (dt / dx) * (flux_interface - flux_prev_interface)\n\n            t += dt\n            \n        return u\n\n    def restrict(u_fine):\n        \"\"\"Restriction operator: average pairs of fine cells.\"\"\"\n        return 0.5 * (u_fine[0::2] + u_fine[1::2])\n\n    nu = 0.45\n    u0 = lambda x: np.sin(2 * np.pi * x)\n\n    # --- Test Case A: Smooth Advection ---\n    c = 1.0\n    f_A = lambda u: c * u\n    f_prime_A = lambda u: c * np.ones_like(u)\n    T_A = 0.5\n    N_A_vals = np.array([50, 100, 200, 400])\n    dx_A_vals = 1.0 / N_A_vals\n    errors_A = []\n\n    for N in N_A_vals:\n        u_num = muscl_solver(N, T_A, nu, f_A, f_prime_A, u0)\n        x = np.linspace(0.5 / N, 1.0 - 0.5 / N, N)\n        u_exact = np.sin(2 * np.pi * (x - c * T_A))\n        error_l1 = np.sum(np.abs(u_num - u_exact)) * (1.0 / N)\n        errors_A.append(error_l1)\n    \n    log_dx_A = np.log(dx_A_vals)\n    log_err_A = np.log(errors_A)\n    p_A = np.polyfit(log_dx_A, log_err_A, 1)[0]\n\n    # --- Test Case B: Nonlinear with Shock ---\n    f_B = lambda u: 0.5 * u**2\n    f_prime_B = lambda u: u\n    T_B = 0.3\n    N_B_vals = [200, 400, 800]\n    \n    u_N0 = muscl_solver(N_B_vals[0], T_B, nu, f_B, f_prime_B, u0)\n    u_N1 = muscl_solver(N_B_vals[1], T_B, nu, f_B, f_prime_B, u0)\n    u_N2 = muscl_solver(N_B_vals[2], T_B, nu, f_B, f_prime_B, u0)\n    \n    u_N1_r = restrict(u_N1)\n    u_N2_r = restrict(u_N2)\n    \n    D1 = np.sum(np.abs(u_N0 - u_N1_r)) * (1.0 / N_B_vals[0])\n    D2 = np.sum(np.abs(u_N1 - u_N2_r)) * (1.0 / N_B_vals[1])\n    \n    p_B = np.log(D1 / D2) / np.log(2.0)\n\n    # --- Test Case C: Nonlinear Pre-Shock ---\n    T_C = 0.1\n    \n    u_N0_C = muscl_solver(N_B_vals[0], T_C, nu, f_B, f_prime_B, u0)\n    u_N1_C = muscl_solver(N_B_vals[1], T_C, nu, f_B, f_prime_B, u0)\n    u_N2_C = muscl_solver(N_B_vals[2], T_C, nu, f_B, f_prime_B, u0)\n\n    u_N1_r_C = restrict(u_N1_C)\n    u_N2_r_C = restrict(u_N2_C)\n    \n    D1_C = np.sum(np.abs(u_N0_C - u_N1_r_C)) * (1.0 / N_B_vals[0])\n    D2_C = np.sum(np.abs(u_N1_C - u_N2_r_C)) * (1.0 / N_B_vals[1])\n    \n    p_C = np.log(D1_C / D2_C) / np.log(2.0)\n    \n    results = [p_A, p_B, p_C]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}