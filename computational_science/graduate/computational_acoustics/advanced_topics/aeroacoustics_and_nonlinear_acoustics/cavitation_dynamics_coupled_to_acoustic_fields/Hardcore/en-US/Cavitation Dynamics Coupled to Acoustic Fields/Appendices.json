{
    "hands_on_practices": [
        {
            "introduction": "To understand how bubbles interact with acoustic fields, we first model their response to small-amplitude sound waves. This exercise guides you through the linearization of the Rayleigh-Plesset equation to treat a bubble of equilibrium radius $R_0$ as a simple harmonic oscillator, allowing you to derive its natural resonance frequency. By comparing the results under isothermal ($\\kappa=1$) and polytropic ($\\kappa  1$) assumptions for the gas inside, you will gain hands-on insight into how thermal effects influence a bubble's acoustic signature and energy dissipation .",
            "id": "4117937",
            "problem": "A single spherical gas bubble of equilibrium radius $R_0$ oscillates in an incompressible liquid of density $\\rho_\\ell$, dynamic viscosity $\\mu$, and surface tension $\\sigma$ when driven by a low-frequency acoustic field. The bubble interior gas follows a polytropic relation characterized by the exponent $\\kappa$. At low acoustic frequencies, thermal conduction makes the gas response approach the isothermal limit $\\kappa = 1$, whereas an adiabatic or polytropic model at the same ambient conditions uses $\\kappa = \\kappa_g  1$. Starting strictly from the Rayleigh–Plesset momentum balance for a spherical bubble and the ideal gas polytropic relation, derive the linearized small-oscillation model about equilibrium and determine the natural (resonance) angular frequency and the Quality factor (Q) under two modeling assumptions for the gas thermodynamics: (i) polytropic with $\\kappa = \\kappa_g$, and (ii) isothermal with $\\kappa = 1$. The Quality factor (Q) is defined as the ratio of $2\\pi$ times the peak energy stored to the energy dissipated per cycle in the linear oscillator approximation; for weak damping, this equals $Q = m \\omega_0 / c$, where $m$ is the effective mass coefficient, $\\omega_0$ is the natural angular frequency, and $c$ is the effective linear damping coefficient.\n\nYour program must implement the formulas you derive for the resonance frequency and Quality factor, using only the linear viscous damping from the surrounding liquid. Neglect acoustic radiation losses and liquid compressibility in the damping. Assume ambient static pressure $p_{\\infty 0}$ and enforce mechanical equilibrium of the bubble so that the equilibrium gas pressure satisfies $p_{g0} = p_{\\infty 0} + 2\\sigma/R_0$. The program must compute, for each test case:\n- The polytropic resonance frequency in hertz, $f_{\\mathrm{poly}}$.\n- The polytropic Quality factor, $Q_{\\mathrm{poly}}$.\n- The isothermal resonance frequency in hertz, $f_{\\mathrm{iso}}$.\n- The isothermal Quality factor, $Q_{\\mathrm{iso}}$.\n- The thermal-effect shifts $\\Delta f = f_{\\mathrm{poly}} - f_{\\mathrm{iso}}$ and $\\Delta Q = Q_{\\mathrm{poly}} - Q_{\\mathrm{iso}}$.\n\nUse the International System of Units (SI): $R_0$ in meters, $\\rho_\\ell$ in kilograms per cubic meter, $\\mu$ in pascal-seconds, $\\sigma$ in newtons per meter, $p_{\\infty 0}$ in pascals, and frequencies $f$ in hertz. If the derived natural frequency squared is non-positive for any parameter set, your program must return the floating-point value $\\mathrm{nan}$ for both the frequency and the Quality factor of that model in the output list of that test case.\n\nTest Suite:\n- Case A (happy path, moderate bubble): $R_0 = 10\\times 10^{-6}$, $\\rho_\\ell = 998$, $\\mu = 1.0\\times 10^{-3}$, $\\sigma = 0.072$, $p_{\\infty 0} = 101325$, $\\kappa_g = 1.4$.\n- Case B (higher resonance, smaller bubble): $R_0 = 2\\times 10^{-6}$, $\\rho_\\ell = 998$, $\\mu = 1.0\\times 10^{-3}$, $\\sigma = 0.072$, $p_{\\infty 0} = 101325$, $\\kappa_g = 1.4$.\n- Case C (surface-tension-influenced, very small bubble): $R_0 = 2\\times 10^{-7}$, $\\rho_\\ell = 998$, $\\mu = 1.0\\times 10^{-3}$, $\\sigma = 0.072$, $p_{\\infty 0} = 101325$, $\\kappa_g = 1.4$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list of lists, each inner list ordered as $[f_{\\mathrm{poly}},Q_{\\mathrm{poly}},f_{\\mathrm{iso}},Q_{\\mathrm{iso}},\\Delta f,\\Delta Q]$. For example, the output should look exactly like:\n$[[f_{\\mathrm{poly},A},Q_{\\mathrm{poly},A},f_{\\mathrm{iso},A},Q_{\\mathrm{iso},A},\\Delta f_A,\\Delta Q_A],[f_{\\mathrm{poly},B},Q_{\\mathrm{poly},B},f_{\\mathrm{iso},B},Q_{\\mathrm{iso},B},\\Delta f_B,\\Delta Q_B],[f_{\\mathrm{poly},C},Q_{\\mathrm{poly},C},f_{\\mathrm{iso},C},Q_{\\mathrm{iso},C},\\Delta f_C,\\Delta Q_C]]$.\nAll numerical entries must be floating-point numbers in SI units as specified, with frequencies in hertz and $Q$ dimensionless.",
            "solution": "The problem requires the derivation of the natural resonance frequency and Quality factor for small-amplitude radial oscillations of a spherical gas bubble in a liquid. The derivation begins with the Rayleigh-Plesset equation, which governs the dynamics of the bubble radius $R(t)$ in an incompressible liquid of density $\\rho_\\ell$ and dynamic viscosity $\\mu$.\n\nThe Rayleigh-Plesset equation is given by:\n$$\n\\rho_\\ell \\left( R \\ddot{R} + \\frac{3}{2} \\dot{R}^2 \\right) = p_g(t) - p_\\infty(t) - \\frac{2\\sigma}{R} - \\frac{4\\mu}{R} \\dot{R}\n$$\nHere, $p_g(t)$ is the gas pressure inside the bubble, $p_\\infty(t)$ is the pressure in the liquid far from the bubble, and $\\sigma$ is the surface tension at the gas-liquid interface. The dots denote time derivatives.\n\nThe gas pressure $p_g(t)$ is related to the bubble volume $V(t) = \\frac{4}{3}\\pi R(t)^3$ through a polytropic relation, $p_g(t) V(t)^\\kappa = \\text{constant}$. This implies $p_g(t) R(t)^{3\\kappa}$ is constant. At equilibrium, the bubble has radius $R_0$ and the gas pressure is $p_{g0}$. Thus, the instantaneous gas pressure is:\n$$\np_g(t) = p_{g0} \\left( \\frac{R_0}{R(t)} \\right)^{3\\kappa}\n$$\nwhere $\\kappa$ is the polytropic exponent. For an isothermal process, $\\kappa=1$, and for a polytropic process, it is given as $\\kappa = \\kappa_g  1$.\n\nThe pressure in the liquid, $p_\\infty(t)$, consists of a static ambient pressure $p_{\\infty 0}$ and a time-varying acoustic component $p_A(t)$, so $p_\\infty(t) = p_{\\infty 0} + p_A(t)$. At static equilibrium ($R = R_0$, $\\dot{R}=0$, $\\ddot{R}=0$, $p_A(t)=0$), the Rayleigh-Plesset equation reduces to the mechanical balance equation:\n$$\np_{g0} - p_{\\infty 0} - \\frac{2\\sigma}{R_0} = 0 \\implies p_{g0} = p_{\\infty 0} + \\frac{2\\sigma}{R_0}\n$$\nThis matches the equilibrium condition provided in the problem statement.\n\nTo analyze small oscillations, we linearize the system around the equilibrium state. We express the radius as a small perturbation from equilibrium: $R(t) = R_0(1 + x(t))$, where $|x(t)| \\ll 1$. Consequently, $\\dot{R} = R_0 \\dot{x}$ and $\\ddot{R} = R_0 \\ddot{x}$. We substitute this into the Rayleigh-Plesset equation and retain only terms linear in $x$ and its derivatives.\n\nThe terms in the equation are linearized as follows:\n- LHS: $\\rho_\\ell ( R \\ddot{R} + \\frac{3}{2} \\dot{R}^2 ) = \\rho_\\ell ( R_0(1+x) R_0 \\ddot{x} + \\frac{3}{2} (R_0 \\dot{x})^2 ) \\approx \\rho_\\ell R_0^2 \\ddot{x}$. The terms $x\\ddot{x}$ and $\\dot{x}^2$ are second-order and neglected.\n- $p_g(t) = p_{g0} (1+x)^{-3\\kappa} \\approx p_{g0} (1 - 3\\kappa x)$.\n- $p_\\infty(t) = p_{\\infty 0} + p_A(t)$.\n- $\\frac{2\\sigma}{R} = \\frac{2\\sigma}{R_0(1+x)} \\approx \\frac{2\\sigma}{R_0}(1-x)$.\n- $\\frac{4\\mu \\dot{R}}{R} = \\frac{4\\mu R_0 \\dot{x}}{R_0(1+x)} \\approx 4\\mu \\dot{x}$.\n\nSubstituting these linearized expressions into the Rayleigh-Plesset equation:\n$$\n\\rho_\\ell R_0^2 \\ddot{x} \\approx \\left[ p_{g0}(1-3\\kappa x) \\right] - \\left[ p_{\\infty 0} + p_A(t) \\right] - \\left[ \\frac{2\\sigma}{R_0}(1-x) \\right] - \\left[ 4\\mu \\dot{x} \\right]\n$$\nGrouping terms:\n$$\n\\rho_\\ell R_0^2 \\ddot{x} + 4\\mu \\dot{x} + \\left( 3\\kappa p_{g0} - \\frac{2\\sigma}{R_0} \\right) x \\approx (p_{g0} - p_{\\infty 0} - \\frac{2\\sigma}{R_0}) - p_A(t)\n$$\nThe static equilibrium term on the right-hand side is zero. We substitute $p_{g0} = p_{\\infty 0} + 2\\sigma/R_0$ into the coefficient of $x$:\n$$\n3\\kappa p_{g0} - \\frac{2\\sigma}{R_0} = 3\\kappa \\left( p_{\\infty 0} + \\frac{2\\sigma}{R_0} \\right) - \\frac{2\\sigma}{R_0} = 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}\n$$\nThe linearized equation of motion for the bubble wall displacement $x(t)$ becomes:\n$$\n\\rho_\\ell R_0^2 \\ddot{x} + 4\\mu \\dot{x} + \\left[ 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0} \\right] x = -p_A(t)\n$$\nThis is the equation of a forced, damped harmonic oscillator, $m\\ddot{x} + c\\dot{x} + kx = F(t)$, with the following effective coefficients:\n- Effective mass: $m = \\rho_\\ell R_0^2$\n- Effective damping coefficient: $c = 4\\mu$\n- Effective spring constant: $k = 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}$\n\nThe undamped natural angular frequency $\\omega_0$ is given by $\\omega_0 = \\sqrt{k/m}$.\n$$\n\\omega_0^2 = \\frac{k}{m} = \\frac{3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}}{\\rho_\\ell R_0^2}\n$$\nThe natural frequency in hertz is $f_0 = \\omega_0 / (2\\pi)$.\n\nThe Quality factor, $Q$, for weak damping is defined as $Q = m\\omega_0/c$. Substituting the derived coefficients:\n$$\nQ = \\frac{(\\rho_\\ell R_0^2)\\omega_0}{4\\mu}\n$$\nWe now apply these general formulas to the two specified cases.\n\n(i) Polytropic case: $\\kappa = \\kappa_g$.\nThe squared natural angular frequency is:\n$$\n\\omega_{0, \\text{poly}}^2 = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3\\kappa_g p_{\\infty 0} + (3\\kappa_g - 1)\\frac{2\\sigma}{R_0} \\right]\n$$\nIf $\\omega_{0, \\text{poly}}^2  0$, the polytropic resonance frequency is $f_{\\text{poly}} = \\frac{\\sqrt{\\omega_{0, \\text{poly}}^2}}{2\\pi}$, and the Quality factor is $Q_{\\text{poly}} = \\frac{\\rho_\\ell R_0^2 \\sqrt{\\omega_{0, \\text{poly}}^2}}{4\\mu}$.\n\n(ii) Isothermal case: $\\kappa = 1$.\nThe squared natural angular frequency is:\n$$\n\\omega_{0, \\text{iso}}^2 = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3(1) p_{\\infty 0} + (3(1) - 1)\\frac{2\\sigma}{R_0} \\right] = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3 p_{\\infty 0} + \\frac{4\\sigma}{R_0} \\right]\n$$\nIf $\\omega_{0, \\text{iso}}^2  0$, the isothermal resonance frequency is $f_{\\text{iso}} = \\frac{\\sqrt{\\omega_{0, \\text{iso}}^2}}{2\\pi}$, and the Quality factor is $Q_{\\text{iso}} = \\frac{\\rho_\\ell R_0^2 \\sqrt{\\omega_{0, \\text{iso}}^2}}{4\\mu}$.\n\nIf $\\omega_0^2$ for any case is non-positive, the corresponding frequency and Q factor are undefined and will be reported as `nan`. For the given physical parameters ($\\rho_\\ell, \\mu, \\sigma, p_{\\infty 0}, R_0  0$ and $\\kappa \\ge 1$), the term $k$ is always positive, so $\\omega_0^2$ will be positive.\n\nThe program will implement these formulas to compute $f_{\\text{poly}}$, $Q_{\\text{poly}}$, $f_{\\text{iso}}$, $Q_{\\text{iso}}$, and the differences $\\Delta f = f_{\\text{poly}} - f_{\\text{iso}}$ and $\\Delta Q = Q_{\\text{poly}} - Q_{\\text{iso}}$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the bubble resonance problem for the given test cases.\n    \"\"\"\n    # Test cases as provided in the problem statement.\n    # Each tuple contains: (R0, rho_l, mu, sigma, p_inf0, kappa_g)\n    test_cases = [\n        # Case A (happy path, moderate bubble)\n        (10e-6, 998, 1.0e-3, 0.072, 101325, 1.4),\n        # Case B (higher resonance, smaller bubble)\n        (2e-6, 998, 1.0e-3, 0.072, 101325, 1.4),\n        # Case C (surface-tension-influenced, very small bubble)\n        (2e-7, 998, 1.0e-3, 0.072, 101325, 1.4),\n    ]\n\n    def calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, kappa):\n        \"\"\"\n        Calculates resonance frequency (Hz) and Quality factor for a bubble.\n\n        Args:\n            R0 (float): Equilibrium radius in meters.\n            rho_l (float): Liquid density in kg/m^3.\n            mu (float): Liquid dynamic viscosity in Pa*s.\n            sigma (float): Surface tension in N/m.\n            p_inf0 (float): Ambient static pressure in Pa.\n            kappa (float): Polytropic exponent.\n\n        Returns:\n            tuple[float, float]: A tuple containing the resonance frequency (f0)\n                                 and the Quality factor (Q). Returns (nan, nan)\n                                 if resonance frequency is not real.\n        \"\"\"\n        # Numerator of the omega_0^2 expression, related to the effective spring constant k\n        # k = 3*kappa*p_inf0 + (3*kappa - 1) * 2*sigma/R0\n        k_numerator = 3 * kappa * p_inf0 + (3 * kappa - 1) * (2 * sigma / R0)\n\n        # Denominator of the omega_0^2 expression, related to the effective mass m\n        # m = rho_l * R0^2\n        m_denominator = rho_l * R0**2\n        \n        if k_numerator = 0 or m_denominator = 0:\n            return np.nan, np.nan\n\n        # Squared natural angular frequency (rad/s)^2\n        omega0_sq = k_numerator / m_denominator\n\n        # Natural angular frequency in rad/s\n        omega0 = np.sqrt(omega0_sq)\n\n        # Natural frequency in Hz\n        f0 = omega0 / (2 * np.pi)\n\n        # Quality factor Q = m * omega0 / c, where m = rho_l * R0^2 and c = 4 * mu\n        Q = (rho_l * R0**2 * omega0) / (4 * mu)\n        \n        return f0, Q\n\n    results = []\n    for case in test_cases:\n        R0, rho_l, mu, sigma, p_inf0, kappa_g = case\n\n        # (i) Polytropic case\n        f_poly, Q_poly = calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, kappa_g)\n\n        # (ii) Isothermal case\n        f_iso, Q_iso = calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, 1.0)\n        \n        # Calculate differences\n        if np.isnan(f_poly) or np.isnan(f_iso):\n            delta_f = np.nan\n        else:\n            delta_f = f_poly - f_iso\n            \n        if np.isnan(Q_poly) or np.isnan(Q_iso):\n            delta_Q = np.nan\n        else:\n            delta_Q = Q_poly - Q_iso\n\n        case_results = [f_poly, Q_poly, f_iso, Q_iso, delta_f, delta_Q]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    # Using map(str, ...) and join is robust for formatting the final string.\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n\n```"
        },
        {
            "introduction": "While linear models describe a bubble's gentle response, the most dramatic effects of cavitation arise from violent, non-linear collapse. This practice problem shifts focus to this extreme regime, using first principles of thermodynamics to estimate the peak temperatures ($T_{\\max}$) reached inside the bubble. By applying the adiabatic compression model to a bubble with initial radius $R_0$ and temperature $T_0$, you will derive an analytical expression revealing how external pressure and gas properties lead to the extraordinary energy concentration characteristic of inertial cavitation .",
            "id": "4117916",
            "problem": "A spherical cavitation bubble containing a noncondensable ideal gas is driven by a one-dimensional plane acoustic field in an incompressible liquid of density that can be treated as constant. The far-field acoustic pressure is modeled as $p_{\\text{ext}}(t) = p_{\\infty} + P_{a} \\sin(\\omega t)$, where $p_{\\infty}$ is the ambient static pressure and $P_{a}$ is the acoustic amplitude. At the instant of maximum expansion $t = t_{e}$, the bubble has radius $R_{0}$ and internal gas temperature $T_{0}$. Assume the gas dynamics in the bubble are adiabatic and the gas obeys the ideal gas law with ratio of specific heats $\\kappa$. Thermal conduction, mass exchange, and chemical reactions are negligible over the collapse cycle, so the number of gas molecules is constant. At the instants of extreme expansion and extreme compression, assume mechanical equilibrium at the interface and neglect both the vapor pressure and surface tension relative to the peak compressive and tensile acoustic pressures, so that the internal gas pressure equals the external pressure at those instants.\n\nStarting from first principles and core definitions (the First Law of Thermodynamics for an adiabatic process and the ideal gas law), derive a relation between the gas temperature $T(t)$ and bubble radius $R(t)$ during the collapse. Use this to obtain an analytic expression for the peak gas temperature $T_{\\max}$ at the instant of minimum radius $R_{\\min}$, expressed in terms of $T_{0}$, $\\kappa$, $p_{\\infty}$, and $P_{a}$, under the assumptions stated.\n\nThen, evaluate the resulting expression for the following parameters:\n- $T_{0} = 300\\,\\text{K}$,\n- $R_{0} = 10\\,\\mu\\text{m}$,\n- $\\kappa = 1.4$,\n- $p_{\\infty} = 2.0\\,\\text{MPa}$,\n- $P_{a} = 1.0\\,\\text{MPa}$.\n\nExpress the final temperature in $\\text{K}$. Round your answer to four significant figures.",
            "solution": "The problem asks for a derivation of the peak temperature in a sonically driven gas bubble, under several simplifying assumptions. The process begins with validating the problem statement.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- System: Spherical cavitation bubble with a noncondensable ideal gas.\n- Liquid: Incompressible, constant density.\n- External field: $p_{\\text{ext}}(t) = p_{\\infty} + P_{a} \\sin(\\omega t)$.\n- State at maximum expansion ($t=t_e$): Radius $R_{0}$, temperature $T_{0}$.\n- Thermodynamics: Gas compression and expansion are adiabatic.\n- Gas properties: Ideal gas with ratio of specific heats $\\kappa$.\n- Excluded phenomena: Thermal conduction, mass exchange, chemical reactions.\n- Conservation: Number of gas molecules is constant.\n- Equilibrium conditions: At extreme expansion and compression, the internal gas pressure equals the external pressure, neglecting vapor pressure and surface tension.\n- Numerical parameters: $T_{0} = 300\\ \\text{K}$, $R_{0} = 10\\ \\mu\\text{m}$, $\\kappa = 1.4$, $p_{\\infty} = 2.0\\ \\text{MPa}$, $P_{a} = 1.0\\ \\text{MPa}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, using standard models from thermodynamics and acoustics (ideal gas, adiabatic process, sinusoidal pressure field). It is well-posed, asking for a specific derivation and calculation based on the provided information. The language is objective and precise. The assumptions, while strong (e.g., neglecting surface tension and assuming instantaneous equilibrium at extrema), are clearly stated and common in simplified theoretical treatments of bubble dynamics. A check on the given pressures, $p_{\\infty} = 2.0\\ \\text{MPa}$ and $P_{a} = 1.0\\ \\text{MPa}$, shows that the minimum external pressure $p_{\\infty} - P_a = 1.0\\ \\text{MPa}$ is positive, avoiding the physical inconsistency of negative absolute pressure. The inclusion of $R_0 = 10\\ \\mu\\text{m}$ is noted; it is likely extraneous to the final analytical expression for temperature but does not invalidate the problem. The problem is deemed valid.\n\n### Solution Derivation\n\nThe gas inside the bubble is treated as an ideal gas undergoing an adiabatic process. From the First Law of Thermodynamics, an adiabatic process (where heat exchange $dQ=0$) is described by the relation $p V^{\\kappa} = \\text{constant}$, where $p$ is the pressure, $V$ is the volume, and $\\kappa$ is the ratio of specific heats.\n\nUsing the ideal gas law, $pV=nRT$ (where $n$ is the number of moles and $R$ is the universal gas constant), we can derive a relationship between temperature $T$ and volume $V$. From the ideal gas law, $p = \\frac{nRT}{V}$. Substituting this into the adiabatic relation:\n$$ \\left(\\frac{nRT}{V}\\right) V^{\\kappa} = \\text{constant} $$\nSince $n$ and $R$ are constants, they can be absorbed into the constant on the right-hand side, yielding:\n$$ T V^{\\kappa-1} = C $$\nwhere $C$ is a constant for a given process.\n\nThe bubble is spherical, so its volume $V(t)$ is related to its radius $R(t)$ by $V(t) = \\frac{4}{3}\\pi [R(t)]^3$. Substituting this into the temperature-volume relation:\n$$ T(t) \\left( \\frac{4}{3}\\pi [R(t)]^3 \\right)^{\\kappa-1} = C $$\n$$ T(t) [R(t)]^{3(\\kappa-1)} \\left( \\frac{4}{3}\\pi \\right)^{\\kappa-1} = C $$\nThe term $(\\frac{4}{3}\\pi)^{\\kappa-1}$ is also a constant and can be absorbed into a new constant, let's call it $C'$. Thus, we have the relation:\n$$ T(t) [R(t)]^{3(\\kappa-1)} = C' $$\nWe can determine the constant $C'$ from the given conditions at the moment of maximum expansion, where $t=t_e$, $R(t_e) = R_0$, and $T(t_e) = T_0$.\n$$ T_0 R_0^{3(\\kappa-1)} = C' $$\nThis allows us to write the relation between temperature and radius at any time $t$:\n$$ T(t) [R(t)]^{3(\\kappa-1)} = T_0 R_0^{3(\\kappa-1)} $$\n$$ T(t) = T_0 \\left( \\frac{R_0}{R(t)} \\right)^{3(\\kappa-1)} $$\nThis is the required relation between $T(t)$ and $R(t)$.\n\nNext, we seek an expression for the peak temperature, $T_{\\max}$, which occurs at the minimum radius, $R_{\\min}$. Using the relation above:\n$$ T_{\\max} = T_0 \\left( \\frac{R_0}{R_{\\min}} \\right)^{3(\\kappa-1)} $$\nTo find the ratio $R_0/R_{\\min}$, we use the adiabatic pressure-volume relation, $p V^{\\kappa} = \\text{constant}$, applied to the two extreme states: maximum expansion (state 0) and maximum compression (state max). Let $p_{g,0}$ be the gas pressure at maximum expansion ($R_0$) and $p_{g,\\max}$ be the gas pressure at maximum compression ($R_{\\min}$).\n$$ p_{g,0} V_0^{\\kappa} = p_{g,\\max} V_{\\min}^{\\kappa} $$\nwhere $V_0 = \\frac{4}{3}\\pi R_0^3$ and $V_{\\min} = \\frac{4}{3}\\pi R_{\\min}^3$. Rearranging gives:\n$$ \\left( \\frac{V_0}{V_{\\min}} \\right)^{\\kappa} = \\frac{p_{g,\\max}}{p_{g,0}} \\implies \\frac{V_0}{V_{\\min}} = \\left( \\frac{p_{g,\\max}}{p_{g,0}} \\right)^{1/\\kappa} $$\nThe ratio of volumes is also $(\\frac{R_0}{R_{\\min}})^3$. So,\n$$ \\left( \\frac{R_0}{R_{\\min}} \\right)^3 = \\left( \\frac{p_{g,\\max}}{p_{g,0}} \\right)^{1/\\kappa} $$\nNow we can express the term in the $T_{\\max}$ equation:\n$$ \\left( \\frac{R_0}{R_{\\min}} \\right)^{3(\\kappa-1)} = \\left[ \\left( \\frac{R_0}{R_{\\min}} \\right)^3 \\right]^{(\\kappa-1)} = \\left[ \\left( \\frac{p_{g,\\max}}{p_{g,0}} \\right)^{1/\\kappa} \\right]^{(\\kappa-1)} = \\left( \\frac{p_{g,\\max}}{p_{g,0}} \\right)^{\\frac{\\kappa-1}{\\kappa}} $$\nSubstituting this back into the equation for $T_{\\max}$:\n$$ T_{\\max} = T_0 \\left( \\frac{p_{g,\\max}}{p_{g,0}} \\right)^{\\frac{\\kappa-1}{\\kappa}} $$\nThe problem states that at the extreme points, we assume mechanical equilibrium where the internal gas pressure equals the external pressure (neglecting surface tension and vapor pressure). The external pressure is $p_{\\text{ext}}(t) = p_{\\infty} + P_a \\sin(\\omega t)$.\nAt maximum expansion ($R_0$), the external pressure is at its minimum:\n$$ p_{g,0} = p_{\\text{ext,min}} = p_{\\infty} - P_a $$\nAt maximum compression ($R_{\\min}$), the external pressure is at its maximum:\n$$ p_{g,\\max} = p_{\\text{ext,max}} = p_{\\infty} + P_a $$\nSubstituting these into the expression for $T_{\\max}$:\n$$ T_{\\max} = T_0 \\left( \\frac{p_{\\infty} + P_a}{p_{\\infty} - P_a} \\right)^{\\frac{\\kappa-1}{\\kappa}} $$\nThis is the final analytical expression for the peak gas temperature.\n\n### Numerical Evaluation\nWe are given the following parameters:\n- $T_{0} = 300\\,\\text{K}$\n- $\\kappa = 1.4$\n- $p_{\\infty} = 2.0\\,\\text{MPa} = 2.0 \\times 10^6\\,\\text{Pa}$\n- $P_{a} = 1.0\\,\\text{MPa} = 1.0 \\times 10^6\\,\\text{Pa}$\n\nFirst, we calculate the exponent:\n$$ \\frac{\\kappa-1}{\\kappa} = \\frac{1.4 - 1}{1.4} = \\frac{0.4}{1.4} = \\frac{2}{7} $$\nNext, we calculate the pressure ratio. The units of pressure cancel out:\n$$ \\frac{p_{\\infty} + P_a}{p_{\\infty} - P_a} = \\frac{2.0\\,\\text{MPa} + 1.0\\,\\text{MPa}}{2.0\\,\\text{MPa} - 1.0\\,\\text{MPa}} = \\frac{3.0}{1.0} = 3 $$\nNow, we substitute these values into the expression for $T_{\\max}$:\n$$ T_{\\max} = 300 \\cdot (3)^{2/7} $$\nCalculating the value:\n$$ (3)^{2/7} \\approx 1.3686806 $$\n$$ T_{\\max} \\approx 300 \\times 1.3686806 \\approx 410.60418\\,\\text{K} $$\nThe problem asks to round the final answer to four significant figures.\n$$ T_{\\max} \\approx 410.6\\,\\text{K} $$",
            "answer": "$$\\boxed{410.6}$$"
        },
        {
            "introduction": "In realistic acoustic environments, pressure fields are rarely uniform, leading to complex bubble behavior beyond simple radial pulsation. This culminating exercise challenges you to model the coupled radial ($R(t)$) and translational ($x(t)$) dynamics of a bubble near a rigid wall, driven by the primary Bjerknes force. By setting up and solving the full system of differential equations, you will simulate the bubble's trajectory and predict its potential for wall impact, a critical consideration in understanding cavitation-induced surface damage and manipulation .",
            "id": "4117935",
            "problem": "A single spherical gas bubble of initial radius $R_0$ oscillates in a quiescent Newtonian liquid of density $\\rho_\\ell$, dynamic viscosity $\\mu$, and surface tension $\\sigma$, adjacent to a rigid planar wall located at $x=0$. The bubble center is constrained to one-dimensional motion along the wall-normal coordinate $x(t)0$. The liquid is driven by a one-dimensional standing acoustic field consistent with a rigid wall such that the acoustic pressure is $p_{\\mathrm{ac}}(x,t)=P_A \\cos(k x)\\sin(\\omega t)$, with $k=\\omega/c$ and $c$ the sound speed in water. The bubble experiences coupled radial and translational dynamics due to the acoustic field. You must determine, by first-principles derivation and numerical simulation, for a given set of parameters, whether the bubble will impact the wall (i.e., whether $x(t)-R(t)\\le 0$ for some $t$ within a prescribed simulation horizon), and if so, at what time this first impact occurs.\n\nYour model and algorithm must be derived from a valid fundamental base appropriate to computational acoustics and cavitation dynamics. Begin from Newton’s second law applied to the bubble interface for the radial motion and to the bubble’s translational motion including added mass effects, and use well-tested constitutive relations. The following physically grounded modeling assumptions are to be used:\n\n- The bubble gas pressure follows a polytropic law $p_g(R)=p_{g0}\\left(\\dfrac{R_0}{R}\\right)^{3\\gamma}$, where $\\gamma$ is the polytropic exponent and $p_{g0}$ is the initial gas pressure consistent with mechanical equilibrium at $t=0$.\n- The far-field liquid pressure away from the bubble is $p_\\infty(t)=p_0+p_{\\mathrm{ac}}(x(t),t)$, where $p_0$ is the ambient static pressure.\n- The radial dynamics of the bubble interface follow from a balance of normal stresses at the interface in incompressible, irrotational liquid flow with viscous and capillary corrections appropriate for small Mach number cavitation, and must be expressed as a second-order ordinary differential equation for $R(t)$.\n- The translational dynamics along $x(t)$ follow from Newton’s second law for a body with time-varying added mass. Model the hydrodynamic added mass as $m_{\\mathrm{eff}}(t)=C_m \\rho_\\ell V(t)$, where $C_m$ is the added-mass coefficient for a sphere in potential flow, $\\rho_\\ell$ is the liquid density, and $V(t)=\\dfrac{4}{3}\\pi R^3(t)$ is the instantaneous bubble volume. Include viscous drag appropriate for small Reynolds number, and the Primary Bjerknes force obtained from the pressure gradient of the acoustic field acting on the instantaneous bubble volume.\n- The Primary Bjerknes force is defined as $F_B(t)=-V(t)\\,\\nabla p_{\\mathrm{ac}}(x(t),t)$ along the $x$-direction. Use the given $p_{\\mathrm{ac}}(x,t)$ to obtain an explicit $F_B(t)$ as a function of $R(t)$, $x(t)$, and $t$.\n- Adopt a clean-bubble Stokes drag $F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$ along the $x$-direction.\n- Implement the translational dynamics in a form that correctly accounts for the time variation of $m_{\\mathrm{eff}}(t)$ by using $ \\dfrac{d}{dt}\\left(m_{\\mathrm{eff}}(t)\\dot{x}(t)\\right)=F_B(t)-F_D(t)$.\n\nYou must:\n\n1. Derive the coupled system of ordinary differential equations for the state vector $[R(t),\\dot{R}(t),x(t),\\dot{x}(t)]$ from the stated physical assumptions.\n2. Implement a robust numerical integrator to evolve the state until either the simulation horizon $T_{\\mathrm{end}}$ is reached or the wall-impact event $x(t)-R(t)=0$ occurs. The wall-impact condition must be implemented as an event that terminates integration at the first occurrence.\n3. For each test case, report the first impact time in seconds as a floating-point number. If no impact occurs within $T_{\\mathrm{end}}$, report $-1.0$.\n\nUse the following constants and units: $\\rho_\\ell=1000\\,\\mathrm{kg/m^3}$, $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\sigma=0.072\\,\\mathrm{N/m}$, $p_0=101325\\,\\mathrm{Pa}$, $c=1480\\,\\mathrm{m/s}$, $C_m=0.5$, and $\\gamma=1.4$. The initial gas pressure must satisfy mechanical equilibrium at $t=0$ with $p_g(R_0) = p_0 + \\dfrac{2\\sigma}{R_0}$.\n\nTest suite (each case specifies $P_A$ in pascals, $f$ in hertz, $R_0$ in meters, $x_0$ in meters, and $T_{\\mathrm{end}}$ in seconds; angles are implicitly in radians through $\\sin(\\cdot)$ and $\\cos(\\cdot)$):\n\n- Case 1 (general case near Minnaert resonance with moderate amplitude): $P_A=80000$, $f=300000$, $R_0=8\\times 10^{-6}$, $x_0=6.0\\times 10^{-4}$, $T_{\\mathrm{end}}=1.0\\times 10^{-3}$.\n- Case 2 (happy-path impact with higher amplitude and proximity): $P_A=150000$, $f=300000$, $R_0=8\\times 10^{-6}$, $x_0=1.0\\times 10^{-4}$, $T_{\\mathrm{end}}=5.0\\times 10^{-4}$.\n- Case 3 (boundary condition grazing scenario): $P_A=120000$, $f=330000$, $R_0=1.0\\times 10^{-5}$, $x_0=1.08\\times R_0$, $T_{\\mathrm{end}}=2.0\\times 10^{-4}$.\n- Case 4 (edge case with very low amplitude): $P_A=5000$, $f=100000$, $R_0=1.0\\times 10^{-5}$, $x_0=5.0\\times 10^{-5}$, $T_{\\mathrm{end}}=1.0\\times 10^{-3}$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry the impact time in seconds for the corresponding case in the order given above, using the unit $\\mathrm{s}$ and the convention that $-1.0$ indicates no impact within $T_{\\mathrm{end}}$. For example: $[t_1,t_2,t_3,t_4]$ where each $t_i$ is a floating-point number in seconds.",
            "solution": "The state of the system at any time $t$ can be described by a state vector $Y(t) = [R(t), \\dot{R}(t), x(t), \\dot{x}(t)]^T$. To solve for the evolution of this state, we formulate a system of four coupled first-order ODEs, $\\dot{Y} = f(t, Y)$. Let $y_1=R$, $y_2=\\dot{R}$, $y_3=x$, and $y_4=\\dot{x}$. The system is:\n$$\n\\begin{cases}\n\\dot{y_1} = y_2 \\\\\n\\dot{y_2} = \\ddot{R}(t) \\\\\n\\dot{y_3} = y_4 \\\\\n\\dot{y_4} = \\ddot{x}(t)\n\\end{cases}\n$$\nWe must now derive the expressions for the second derivatives $\\ddot{R}$ and $\\ddot{x}$ based on the physical principles outlined in the problem.\n\nThe radial dynamics are governed by the Rayleigh-Plesset equation, which arises from the momentum equation for an incompressible fluid in spherical coordinates, combined with a normal stress balance at the bubble interface. The equation is:\n$$ R\\ddot{R} + \\frac{3}{2}\\dot{R}^2 = \\frac{1}{\\rho_\\ell} \\left( p_B(t) - p_\\infty(t) \\right) $$\nHere, $p_B(t)$ is the pressure in the liquid at the bubble wall, and $p_\\infty(t) = p_0 + p_{\\mathrm{ac}}(x(t), t)$ is the pressure far from the bubble. The pressure $p_B(t)$ is related to the internal gas pressure $p_g(t)$, surface tension $\\sigma$, and viscous stress by the normal stress balance:\n$$ p_B(t) = p_g(t) - \\frac{2\\sigma}{R} - \\frac{4\\mu\\dot{R}}{R} $$\nSubstituting this into the Rayleigh-Plesset equation and using the given expressions for $p_g$ and $p_\\infty$ yields:\n$$ R\\ddot{R} + \\frac{3}{2}\\dot{R}^2 = \\frac{1}{\\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{R}\\right)^{3\\gamma} - \\frac{2\\sigma}{R} - \\frac{4\\mu\\dot{R}}{R} - p_0 - P_A \\cos(k x) \\sin(\\omega t) \\right) $$\nSolving for $\\ddot{R}$, we obtain the second ODE of our system:\n$$ \\ddot{R} = \\frac{1}{R\\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{R}\\right)^{3\\gamma} - \\frac{2\\sigma}{R} - p_0 - P_A \\cos(k x) \\sin(\\omega t) \\right) - \\frac{4\\mu\\dot{R}}{\\rho_\\ell R^2} - \\frac{3\\dot{R}^2}{2R} $$\n\nThe translational dynamics are governed by Newton's second law for a body with time-varying mass, written as $\\frac{d}{dt}(m_{\\mathrm{eff}}\\dot{x}) = F_{\\mathrm{net}}$. Expanding the derivative and solving for the acceleration $\\ddot{x}$ gives:\n$$ \\ddot{x} = \\frac{1}{m_{\\mathrm{eff}}} \\left( F_{\\mathrm{net}} - \\dot{m}_{\\mathrm{eff}}\\dot{x} \\right) $$\nThe net external force is the sum of the Primary Bjerknes force $F_B$ and the drag force. The problem defines the equation as $F_B - F_D$, where $F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$ is the Stokes drag. This implies the drag force component is $-F_D$. The Bjerknes force is $F_B(t) = -V(t) \\nabla p_{\\mathrm{ac}}$. The pressure gradient in the $x$-direction is $\\frac{\\partial p_{\\mathrm{ac}}}{\\partial x} = -k P_A \\sin(kx) \\sin(\\omega t)$. Thus:\n$$ F_B(t) = - \\left(\\frac{4}{3}\\pi R^3\\right) \\left(-k P_A \\sin(kx) \\sin(\\omega t)\\right) = \\frac{4}{3}\\pi R^3 k P_A \\sin(kx) \\sin(\\omega t) $$\nThe effective added mass is $m_{\\mathrm{eff}}(t) = C_m \\rho_\\ell V(t) = C_m \\rho_\\ell \\frac{4}{3}\\pi R^3$. Its time derivative is $\\dot{m}_{\\mathrm{eff}}(t) = C_m \\rho_\\ell (4\\pi R^2 \\dot{R})$.\nSubstituting these into the equation for $\\ddot{x}$:\n$$ \\ddot{x} = \\frac{F_B - F_D}{m_{\\mathrm{eff}}} - \\frac{\\dot{m}_{\\mathrm{eff}}}{m_{\\mathrm{eff}}}\\dot{x} = \\frac{\\frac{4}{3}\\pi R^3 k P_A \\sin(kx) \\sin(\\omega t) - 6\\pi \\mu R \\dot{x}}{C_m \\rho_\\ell \\frac{4}{3}\\pi R^3} - \\frac{C_m \\rho_\\ell 4\\pi R^2 \\dot{R}}{C_m \\rho_\\ell \\frac{4}{3}\\pi R^3}\\dot{x} $$\nSimplifying this expression yields the fourth ODE of our system:\n$$ \\ddot{x} = \\frac{k P_A \\sin(kx) \\sin(\\omega t)}{C_m \\rho_\\ell} - \\frac{9\\mu}{2C_m \\rho_\\ell R^2}\\dot{x} - \\frac{3\\dot{R}}{R}\\dot{x} $$\n\nThe complete system of first-order ODEs is:\n$$\n\\begin{align*}\n\\dot{y_1} = y_2 \\\\\n\\dot{y_2} = \\frac{1}{y_1 \\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{y_1}\\right)^{3\\gamma} - \\frac{2\\sigma}{y_1} - p_0 - P_A \\cos(k y_3) \\sin(\\omega t) \\right) - \\frac{4\\mu y_2}{\\rho_\\ell y_1^2} - \\frac{3y_2^2}{2y_1} \\\\\n\\dot{y_3} = y_4 \\\\\n\\dot{y_4} = \\frac{k P_A \\sin(k y_3) \\sin(\\omega t)}{C_m \\rho_\\ell} - \\left( \\frac{9\\mu}{2C_m \\rho_\\ell y_1^2} + \\frac{3y_2}{y_1} \\right) y_4\n\\end{align*}\n$$\nThe initial conditions corresponding to a bubble at rest are $Y_0 = [R_0, 0, x_0, 0]^T$.\n\nTo solve this initial value problem, we employ a numerical ODE solver. The `scipy.integrate.solve_ivp` function from the SciPy library is a suitable choice, providing robust adaptive step-size Runge-Kutta methods. The simulation for each test case is run from $t=0$ to $t=T_{\\mathrm{end}}$.\nA critical requirement is to detect the moment of impact with the wall. The impact condition is $x(t) - R(t) \\le 0$. We implement this as a termination event for the ODE solver. We define an event function $g(t,Y) = y_3(t) - y_1(t)$. The solver is instructed to find the root of this function (i.e., when $g(t,Y)=0$) and terminate the integration at the first occurrence. Since the bubble starts with $x_0  R_0$, the event function is initially positive, and we look for a zero-crossing in the negative direction.\nThe algorithm proceeds as follows: for each test case, we set up all physical parameters and initial conditions. We then call `solve_ivp` with the ODE system, the time interval $[0, T_{\\mathrm{end}}]$, the initial state vector, and the wall-impact event function. If the solver detects an event, the corresponding time is recorded as the impact time. If the integration completes up to $T_{\\mathrm{end}}$ without any event, it signifies no impact, and the result is recorded as $-1.0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves the coupled equations for bubble radius and translation\n    to determine the wall impact time.\n    \"\"\"\n\n    # --- Constants and Units ---\n    # All values are in SI units.\n    RHO_L = 1000.0  # kg/m^3\n    MU = 1.0e-3    # Pa*s\n    SIGMA = 0.072   # N/m\n    P0 = 101325.0  # Pa\n    C = 1480.0     # m/s\n    C_M = 0.5      # Added-mass coefficient (dimensionless)\n    GAMMA = 1.4    # Polytropic exponent (dimensionless)\n\n    # --- Test Cases ---\n    # Each case: (P_A [Pa], f [Hz], R_0 [m], x_0 [m], T_end [s])\n    test_cases = [\n        (80000.0, 300000.0, 8.0e-6, 6.0e-4, 1.0e-3),\n        (150000.0, 300000.0, 8.0e-6, 1.0e-4, 5.0e-4),\n        (120000.0, 330000.0, 1.0e-5, 1.08 * 1.0e-5, 2.0e-4),\n        (5000.0, 100000.0, 1.0e-5, 5.0e-5, 1.0e-3),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        P_A, f, R0, x0, T_end = case\n        \n        # --- Derived Parameters ---\n        omega = 2.0 * np.pi * f\n        k = omega / C\n        pg0 = P0 + 2.0 * SIGMA / R0\n\n        # --- Pack parameters for the solver ---\n        params = (RHO_L, MU, SIGMA, P0, C_M, GAMMA, P_A, omega, k, R0, pg0)\n\n        def ode_system(t, y, params):\n            \"\"\"\n            Defines the coupled system of 4 first-order ODEs.\n            y = [R, R_dot, x, x_dot]\n            \"\"\"\n            R, R_dot, x, x_dot = y\n            rho_l, mu, sigma, p0, c_m, gamma, pa, w, k_wave, r0, pg_0 = params\n            \n            # Defensive check for non-physical radius\n            if R = 0:\n                return [0, 0, 0, 0]\n\n            # --- Radial Dynamics (Rayleigh-Plesset) ---\n            # y_dot[1] = R_ddot\n            p_acoustic = pa * np.cos(k_wave * x) * np.sin(w * t)\n            \n            pressure_term = (pg_0 * (r0 / R)**(3.0 * gamma) -\n                             2.0 * sigma / R -\n                             4.0 * mu * R_dot / R -\n                             p0 - p_acoustic)\n            \n            R_ddot = (pressure_term / rho_l - 1.5 * R_dot**2) / R\n            \n            # --- Translational Dynamics ---\n            # y_dot[3] = x_ddot\n            bjerknes_term = (k_wave * pa * np.sin(k_wave * x) * np.sin(w * t)) / (c_m * rho_l)\n            drag_term = (9.0 * mu) / (2.0 * c_m * rho_l * R**2) * x_dot\n            added_mass_change_term = (3.0 * R_dot / R) * x_dot\n            \n            x_ddot = bjerknes_term - drag_term - added_mass_change_term\n\n            return [R_dot, R_ddot, x_dot, x_ddot]\n\n        def wall_impact(t, y, params):\n            \"\"\"\n            Event function to detect wall impact: x(t) - R(t) = 0.\n            \"\"\"\n            return y[2] - y[0]\n        \n        wall_impact.terminal = True  # Stop integration at impact\n        wall_impact.direction = -1   # Trigger when going from positive to negative\n\n        # --- Initial Conditions ---\n        y0 = [R0, 0.0, x0, 0.0]  # [R(0), R_dot(0), x(0), x_dot(0)]\n\n        # --- Solve the ODE System ---\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[0, T_end],\n            y0=y0,\n            method='RK45',  # Standard robust solver\n            args=(params,),\n            events=wall_impact,\n            dense_output=True,\n            rtol=1e-8,\n            atol=1e-12\n        )\n\n        # --- Process Results ---\n        if sol.t_events[0].size  0:\n            impact_time = sol.t_events[0][0]\n            results.append(impact_time)\n        else:\n            results.append(-1.0)\n            \n    # --- Final Output Formatting ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}