{
    "hands_on_practices": [
        {
            "introduction": "Before we can analyze a bubble's response, we must first understand how to generate the acoustic field that drives its dynamics. This first practice focuses on modeling a common source—a focused piston transducer—using the fundamental Rayleigh integral to determine the pressure at its focal point . This exercise builds a crucial link between a transducer's physical design and the acoustic conditions it creates, setting the stage for predicting cavitation.",
            "id": "4117903",
            "problem": "Consider a lossless, inviscid fluid with constant mass density $\\rho$ and sound speed $c$, and time-harmonic linear acoustics governed by the scalar acoustic wave equation. Let a baffled, circular piston transducer of aperture radius $a$ be embedded in an infinite rigid plane, operating in the upper half-space. The piston applies a prescribed normal surface velocity amplitude $v_0$ (uniform over the aperture) and a spatial phase chosen to focus at an on-axis field point located at an axial distance $f$ from the center of the aperture. Let the acoustic angular frequency be $\\omega$ with wavelength $\\lambda$ so that the wavenumber $k$ satisfies $k = 2\\pi / \\lambda$.\n\nStarting from the Helmholtz equation for the complex acoustic pressure $p$ and the free-space Green's function $G(\\mathbf{r},\\mathbf{r}') = \\exp(i k \\|\\mathbf{r} - \\mathbf{r}'\\|)/(4\\pi \\|\\mathbf{r} - \\mathbf{r}'\\|)$, invoke the Rayleigh integral for a baffled aperture in the upper half-space to express the on-axis complex focal pressure $p_{\\text{focus}}$ at axial distance $f$ in terms of an integral over the circular aperture. Use the prescription of uniform normal velocity amplitude $v_0$ with focusing phase that equalizes the phase at the focal point (that is, the aperture normal velocity includes a phase factor that cancels the path-dependent phase from each aperture point to the focus). Your derivation must begin from the linear acoustic wave equation and the definition of the Green's function, and proceed through the Rayleigh integral without skipping intermediate reasoning.\n\nUnder these assumptions, formulate a computational method that evaluates the focal pressure amplitude $|p_{\\text{focus}}|$ using a numerical quadrature of the Rayleigh integral reduced to polar coordinates. The computation must explicitly show the dependence on the aperture radius $a$, the wavelength $\\lambda$ (through $k$), and the focal distance $f$.\n\nCouple the focal pressure to a simple cavitation feasibility check based on a static inequality for a pre-existing spherical gas nucleus of radius $R_0$ in water. Let the ambient static pressure be $p_0$, the water vapor pressure be $p_v$, and the water surface tension be $\\sigma$. Define the crude cavitation criterion that cavitation is feasible if the peak negative acoustic pressure magnitude at the focus exceeds the difference between ambient static pressure and the sum of vapor pressure and the Laplace pressure at the initial bubble radius. That is, define\n$$\np_{\\text{crit}} = p_0 - \\left(p_v + \\frac{2\\sigma}{R_0}\\right),\n$$\nand declare cavitation feasible if $|p_{\\text{focus}}| \\ge p_{\\text{crit}}$. This criterion neglects dynamic effects and is only a conservative static check.\n\nImplement a single, self-contained program that:\n- Computes $|p_{\\text{focus}}|$ in Pascals (Pa) based on the Rayleigh integral with focusing phase as described, using numerical quadrature in polar coordinates (you may reduce the azimuthal integral analytically but must perform the radial integral numerically).\n- Computes the normalized geometric gain factor $G$ defined by\n$$\nG = \\frac{|p_{\\text{focus}}|}{\\rho c k |v_0|},\n$$\nwhich has units of meters (m), thereby isolating the dependence on $a$ and $f$ separate from the explicit factor $\\rho c k |v_0|$.\n- Computes the cavitation feasibility boolean based on $p_{\\text{crit}}$ defined above.\n\nUse the following fluid and transducer parameters, held constant across all test cases:\n- $\\rho = 1000$ kilograms per cubic meter,\n- $c = 1500$ meters per second,\n- $v_0 = 0.01$ meters per second,\n- $p_0 = 101325$ Pascals,\n- $p_v = 2330$ Pascals,\n- $\\sigma = 0.072$ Newtons per meter,\n- $R_0 = 5\\times 10^{-6}$ meters.\n\nEvaluate the following test suite of parameter sets $(a,\\lambda,f)$:\n- Case $1$ (general \"happy path\"): $a = 0.005$ meters, $\\lambda = 0.0015$ meters, $f = 0.03$ meters.\n- Case $2$ (larger aperture and shorter wavelength to test stronger focusing): $a = 0.0125$ meters, $\\lambda = 0.0005$ meters, $f = 0.04$ meters.\n- Case $3$ (small aperture and longer wavelength): $a = 0.001$ meters, $\\lambda = 0.002$ meters, $f = 0.01$ meters.\n- Case $4$ (far-field axial point): $a = 0.005$ meters, $\\lambda = 0.0015$ meters, $f = 0.2$ meters.\n- Case $5$ (near-field axial point): $a = 0.005$ meters, $\\lambda = 0.0015$ meters, $f = 0.001$ meters.\n\nFor each case, your program must produce the triple of results:\n- $|p_{\\text{focus}}|$ in Pascals (Pa),\n- $G$ in meters (m),\n- cavitation feasibility as a boolean.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing all case results concatenated and enclosed in one square-bracketed list, with entries ordered as $[|p_{\\text{focus}}|_1, G_1, \\text{cav}_1, |p_{\\text{focus}}|_2, G_2, \\text{cav}_2, \\ldots, |p_{\\text{focus}}|_5, G_5, \\text{cav}_5]$, where $\\text{cav}_i$ is the boolean cavitation feasibility for case $i$.\n- Numerical values must be printed as Python floats without unit strings; angles are not used; physical units have been specified above and must be adhered to.",
            "solution": "The problem is to determine the on-axis focal pressure of a baffled circular piston transducer, and to assess a simplified cavitation feasibility criterion. The derivation and computation must adhere to the specified constraints.\n\n**1. Problem Validation**\n\nFirst, I will validate the problem statement.\n\n**Step 1: Extract Givens**\n- **Physical System**: A lossless, inviscid fluid with constant mass density $\\rho$ and sound speed $c$.\n- **Governing Equation**: Time-harmonic linear acoustics governed by the scalar acoustic wave equation (Helmholtz equation).\n- **Source**: A baffled, circular piston transducer of aperture radius $a$ in an infinite rigid plane ($z=0$), operating in the upper half-space ($z>0$).\n- **Source Velocity**: Prescribed normal surface velocity with uniform amplitude $v_0$ and a spatial phase to focus at an on-axis point $(0,0,f)$. The phase equalizes path-dependent phase delays to the focus.\n- **Acoustic Parameters**: Angular frequency $\\omega$, wavelength $\\lambda$, wavenumber $k = 2\\pi / \\lambda$.\n- **Mathematical Tools**: Helmholtz equation for complex pressure $p$, free-space Green's function $G(\\mathbf{r},\\mathbf{r}') = \\exp(i k \\|\\mathbf{r} - \\mathbf{r}'\\|)/(4\\pi \\|\\mathbf{r} - \\mathbf{r}'\\|)$, Rayleigh integral.\n- **Objective 1 (Pressure)**: Formulate a computational method for the focal pressure amplitude $|p_{\\text{focus}}|$ at $(0,0,f)$ using numerical quadrature of the Rayleigh integral in polar coordinates. The azimuthal integral can be solved analytically.\n- **Objective 2 (Gain)**: Compute the normalized geometric gain factor $G = |p_{\\text{focus}}|/(\\rho c k |v_0|)$.\n- **Objective 3 (Cavitation)**: Implement a cavitation feasibility check. The criterion is $|p_{\\text{focus}}| \\ge p_{\\text{crit}}$, where the critical pressure is defined as $p_{\\text{crit}} = p_0 - (p_v + 2\\sigma/R_0)$.\n- **Constants**:\n    - $\\rho = 1000$ kg/m$^3$\n    - $c = 1500$ m/s\n    - $v_0 = 0.01$ m/s\n    - $p_0 = 101325$ Pa\n    - $p_v = 2330$ Pa\n    - $\\sigma = 0.072$ N/m\n    - $R_0 = 5\\times 10^{-6}$ m\n- **Test Cases**:\n    - Case 1: $(a, \\lambda, f) = (0.005, 0.0015, 0.03)$ m\n    - Case 2: $(a, \\lambda, f) = (0.0125, 0.0005, 0.04)$ m\n    - Case 3: $(a, \\lambda, f) = (0.001, 0.002, 0.01)$ m\n    - Case 4: $(a, \\lambda, f) = (0.005, 0.0015, 0.2)$ m\n    - Case 5: $(a, \\lambda, f) = (0.005, 0.0015, 0.001)$ m\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is based on the standard principles of linear acoustics: the Helmholtz equation, Green's functions, and the Rayleigh integral for baffled sources. The concept of a phased aperture for focusing is fundamental in ultrasonics. The cavitation criterion is explicitly labeled as a \"crude\" and \"static\" check, which acknowledges its simplified nature. While it is a non-standard formulation of the Blake threshold, it is presented as a definition for the purpose of the problem, which is acceptable within a self-contained problem statement.\n- **Well-Posed**: All necessary physical constants, geometric parameters, and source conditions are provided. The objectives are clearly defined, and the required calculations lead to a unique solution for each test case.\n- **Objective**: The problem is stated in precise, quantitative terms, free from subjective language.\n- **No other flaws detected**: The problem is not incomplete, contradictory, unrealistic, ill-posed, or trivial. It requires a standard derivation and a straightforward numerical implementation.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. I will proceed with the solution.\n\n**2. Derivation and Formulation**\n\nThe derivation starts from the fundamental equations of linear acoustics as requested.\n\n**From Helmholtz Equation to Rayleigh Integral**\nFor a time-harmonic acoustic field with angular frequency $\\omega$, the complex pressure amplitude $p(\\mathbf{r})$ in a source-free, homogeneous, inviscid fluid is governed by the Helmholtz equation:\n$$\n(\\nabla^2 + k^2)p(\\mathbf{r}) = 0\n$$\nwhere $k = \\omega/c$ is the acoustic wavenumber, with $c$ being the speed of sound. The solution to this partial differential equation can be formulated using a Green's function approach. The free-space Green's function, $G(\\mathbf{r}, \\mathbf{r}')$, is the solution to $(\\nabla^2 + k^2)G(\\mathbf{r}, \\mathbf{r}') = -\\delta(\\mathbf{r}-\\mathbf{r}')$, which represents the field from a point source at $\\mathbf{r}'$:\n$$\nG(\\mathbf{r}, \\mathbf{r}') = \\frac{e^{ik\\|\\mathbf{r} - \\mathbf{r}'\\|}}{4\\pi\\|\\mathbf{r} - \\mathbf{r}'\\|}\n$$\nThe problem considers a planar source in an infinite rigid baffle. This is a boundary value problem in a half-space. The pressure field in the half-space $z>0$ generated by a vibrating surface $S$ on the $z=0$ plane is given by the Rayleigh integral (also known as the Rayleigh-Sommerfeld I integral):\n$$\np(\\mathbf{r}) = \\frac{i\\omega\\rho}{2\\pi} \\iint_S v_n(\\mathbf{r}') \\frac{e^{ik\\|\\mathbf{r} - \\mathbf{r}'\\|}}{\\|\\mathbf{r} - \\mathbf{r}'\\|} dS'\n$$\nHere, $\\rho$ is the fluid density, $v_n(\\mathbf{r}')$ is the normal velocity on the surface element $dS'$ at position $\\mathbf{r}'$, and the integral is taken over the entire vibrating surface $S$. This integral is a specific solution to the Helmholtz equation for the given boundary conditions.\n\n**Applying to the Focused Circular Piston**\nThe transducer is a circular aperture of radius $a$ centered at the origin in the $xy$-plane. We use polar coordinates for the source surface: $\\mathbf{r}' = (r' \\cos\\phi', r' \\sin\\phi', 0)$, with $0 \\le r' \\le a$ and $0 \\le \\phi' < 2\\pi$. The surface element is $dS' = r' dr' d\\phi'$.\n\nThe target field point is the on-axis focus, $\\mathbf{r} = (0, 0, f)$. The distance from a source point $\\mathbf{r}'$ to the focus is:\n$$\nR = \\|\\mathbf{r} - \\mathbf{r}'\\| = \\sqrt{(r'\\cos\\phi')^2 + (r'\\sin\\phi')^2 + f^2} = \\sqrt{r'^2 + f^2}\n$$\nThe normal velocity $v_n(\\mathbf{r}')$ has a uniform amplitude $v_0$. The phase is chosen to ensure that wavefronts from all points on the aperture arrive at the focus $(0,0,f)$ simultaneously and in phase. The propagation phase from $\\mathbf{r}'$ to the focus is $kR = k\\sqrt{r'^2+f^2}$. To cancel this path-dependent phase, the source velocity is given a conjugate phase. A common convention is to set the arrival phase to be equivalent to the on-axis path, i.e., $e^{ikf}$. The velocity phase must therefore be $k(f-R)$. The complex normal velocity is:\n$$\nv_n(\\mathbf{r}') = v_0 e^{ik(f - \\sqrt{r'^2+f^2})}\n$$\nSubstituting these expressions into the Rayleigh integral:\n$$\np_{\\text{focus}} = \\frac{i\\omega\\rho}{2\\pi} \\int_0^{2\\pi} \\int_0^a v_0 e^{ik(f - \\sqrt{r'^2+f^2})} \\frac{e^{ik\\sqrt{r'^2+f^2}}}{\\sqrt{r'^2+f^2}} r' dr' d\\phi'\n$$\nThe phase terms in the integrand simplify:\n$$\ne^{ik(f - \\sqrt{r'^2+f^2})} e^{ik\\sqrt{r'^2+f^2}} = e^{ikf-ik\\sqrt{r'^2+f^2}+ik\\sqrt{r'^2+f^2}} = e^{ikf}\n$$\nThe integrand becomes independent of the azimuthal angle $\\phi'$. The integral over $d\\phi'$ from $0$ to $2\\pi$ yields a factor of $2\\pi$:\n$$\np_{\\text{focus}} = \\frac{i\\omega\\rho v_0}{2\\pi} (2\\pi) e^{ikf} \\int_0^a \\frac{r'}{\\sqrt{r'^2+f^2}} dr'\n$$\nUsing the relation $\\omega=ck$:\n$$\np_{\\text{focus}} = i\\rho c k v_0 e^{ikf} \\int_0^a \\frac{r'}{\\sqrt{r'^2+f^2}} dr'\n$$\nThe problem requires that this radial integral be performed numerically. Let's define the integral as $I_{rad}$:\n$$\nI_{rad}(a, f) = \\int_0^a \\frac{r'}{\\sqrt{r'^2+f^2}} dr'\n$$\n\n**Computation of Physical Quantities**\n1.  **Focal Pressure Amplitude, $|p_{\\text{focus}}|$**: The amplitude is the magnitude of the complex pressure $p_{\\text{focus}}$. Since $|i|=1$ and $|e^{ikf}|=1$, we have:\n    $$\n    |p_{\\text{focus}}| = \\left| i\\rho c k v_0 e^{ikf} I_{rad}(a, f) \\right| = \\rho c k |v_0| I_{rad}(a, f)\n    $$\n    This will be computed by first evaluating $I_{rad}$ using numerical quadrature.\n\n2.  **Geometric Gain Factor, $G$**: The problem defines this as:\n    $$\n    G = \\frac{|p_{\\text{focus}}|}{\\rho c k |v_0|}\n    $$\n    Substituting the expression for $|p_{\\text{focus}}|$:\n    $$\n    G = \\frac{\\rho c k |v_0| I_{rad}(a, f)}{\\rho c k |v_0|} = I_{rad}(a, f)\n    $$\n    Thus, the geometric gain factor is simply the value of the radial integral. Although this integral has a simple analytical solution, $G = \\sqrt{a^2+f^2}-f$, the problem mandates its numerical evaluation.\n\n3.  **Cavitation Feasibility**: The critical pressure threshold is given by:\n    $$\n    p_{\\text{crit}} = p_0 - \\left(p_v + \\frac{2\\sigma}{R_0}\\right)\n    $$\n    With the provided constants:\n    - Laplace pressure $p_L = \\frac{2\\sigma}{R_0} = \\frac{2 \\times 0.072}{5 \\times 10^{-6}} = 28800$ Pa.\n    - $p_{\\text{crit}} = 101325 - (2330 + 28800) = 101325 - 31130 = 70195$ Pa.\n    The cavitation feasibility is determined by the boolean condition:\n    $$\n    \\text{CavitationFeasible} = (|p_{\\text{focus}}| \\ge p_{\\text{crit}})\n    $$\n\n**Computational Procedure**\nFor each test case $(a, \\lambda, f)$:\n1.  Calculate the wavenumber $k = 2\\pi/\\lambda$.\n2.  Define the integrand function $g(r') = r'/\\sqrt{r'^2 + f^2}$.\n3.  Numerically compute the integral $G = \\int_0^a g(r') dr'$ using a quadrature routine. This value is the geometric gain factor.\n4.  Calculate the focal pressure amplitude $|p_{\\text{focus}}| = \\rho c k |v_0| G$.\n5.  Compare $|p_{\\text{focus}}|$ with the pre-computed $p_{\\text{crit}} = 70195$ Pa to determine the boolean cavitation feasibility.\n6.  Store the triplet $(|p_{\\text{focus}}|, G, \\text{Feasibility})$ for each case.\n\nThis procedure will be implemented in the provided Python environment.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the focal pressure, geometric gain, and cavitation feasibility\n    for a focused circular piston transducer based on the Rayleigh integral.\n    \"\"\"\n    \n    # --- Constant Parameters ---\n    # Fluid properties (water)\n    RHO = 1000.0  # density in kg/m^3\n    C = 1500.0   # sound speed in m/s\n\n    # Source parameters\n    V0 = 0.01     # piston velocity amplitude in m/s\n\n    # Cavitation parameters\n    P0 = 101325.0  # ambient static pressure in Pa\n    PV = 2330.0    # water vapor pressure in Pa\n    SIGMA = 0.072  # surface tension in N/m\n    R0 = 5.0e-6    # initial bubble nucleus radius in m\n\n    # --- Test Cases ---\n    # Each case is a tuple: (a, lambda, f)\n    # a: aperture radius (m)\n    # lambda: wavelength (m)\n    # f: focal distance (m)\n    test_cases = [\n        (0.005, 0.0015, 0.03),    # Case 1\n        (0.0125, 0.0005, 0.04),   # Case 2\n        (0.001, 0.002, 0.01),     # Case 3\n        (0.005, 0.0015, 0.2),     # Case 4\n        (0.005, 0.0015, 0.001)    # Case 5\n    ]\n    \n    # --- Pre-calculate Cavitation Threshold Pressure ---\n    # p_crit = p0 - (pv + 2*sigma/R0)\n    p_crit = P0 - (PV + (2 * SIGMA / R0))\n    \n    # --- Main Calculation Loop ---\n    results = []\n    for a, lambda_val, f in test_cases:\n        # Calculate wavenumber k\n        k = 2 * np.pi / lambda_val\n        \n        # Define the integrand for the radial integral\n        # integrand(r') = r' / sqrt(r'^2 + f^2)\n        def integrand(r_prime):\n            return r_prime / np.sqrt(r_prime**2 + f**2)\n        \n        # Perform numerical quadrature to get the geometric gain G\n        # G is equal to the value of the radial integral\n        # quad returns a tuple (integral_value, estimated_error)\n        G, _ = quad(integrand, 0, a)\n        \n        # Calculate the focal pressure amplitude |p_focus|\n        # |p_focus| = rho * c * k * |v0| * G\n        p_focus_amp = RHO * C * k * V0 * G\n        \n        # Determine cavitation feasibility\n        cavitation_feasible = p_focus_amp >= p_crit\n        \n        # Append the triple of results to the list\n        results.extend([p_focus_amp, G, cavitation_feasible])\n        \n    # --- Format and Print Final Output ---\n    # The format must be a single line: [res1_1,res1_2,res1_3,res2_1,res2_2,res2_3,...]\n    # The map(str, ...) will convert floats and booleans to their string representations.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Having modeled the acoustic source, we now turn to the bubble itself. This practice simplifies the complex, nonlinear behavior of a bubble by treating its small oscillations around equilibrium, effectively modeling it as a linear resonator . By deriving and computing the bubble's natural resonance frequency, you will uncover the physical basis for its role as a powerful amplifier of acoustic energy and see how thermodynamics affects its response.",
            "id": "4117937",
            "problem": "A single spherical gas bubble of equilibrium radius $R_0$ oscillates in an incompressible liquid of density $\\rho_\\ell$, dynamic viscosity $\\mu$, and surface tension $\\sigma$ when driven by a low-frequency acoustic field. The bubble interior gas follows a polytropic relation characterized by the exponent $\\kappa$. At low acoustic frequencies, thermal conduction makes the gas response approach the isothermal limit $\\kappa = 1$, whereas an adiabatic or polytropic model at the same ambient conditions uses $\\kappa = \\kappa_g > 1$. Starting strictly from the Rayleigh–Plesset momentum balance for a spherical bubble and the ideal gas polytropic relation, derive the linearized small-oscillation model about equilibrium and determine the natural (resonance) angular frequency and the Quality factor (Q) under two modeling assumptions for the gas thermodynamics: (i) polytropic with $\\kappa = \\kappa_g$, and (ii) isothermal with $\\kappa = 1$. The Quality factor (Q) is defined as the ratio of $2\\pi$ times the peak energy stored to the energy dissipated per cycle in the linear oscillator approximation; for weak damping, this equals $Q = m \\omega_0 / c$, where $m$ is the effective mass coefficient, $\\omega_0$ is the natural angular frequency, and $c$ is the effective linear damping coefficient.\n\nYour program must implement the formulas you derive for the resonance frequency and Quality factor, using only the linear viscous damping from the surrounding liquid. Neglect acoustic radiation losses and liquid compressibility in the damping. Assume ambient static pressure $p_{\\infty 0}$ and enforce mechanical equilibrium of the bubble so that the equilibrium gas pressure satisfies $p_{g0} = p_{\\infty 0} + 2\\sigma/R_0$. The program must compute, for each test case:\n- The polytropic resonance frequency in hertz, $f_{\\mathrm{poly}}$.\n- The polytropic Quality factor, $Q_{\\mathrm{poly}}$.\n- The isothermal resonance frequency in hertz, $f_{\\mathrm{iso}}$.\n- The isothermal Quality factor, $Q_{\\mathrm{iso}}$.\n- The thermal-effect shifts $\\Delta f = f_{\\mathrm{poly}} - f_{\\mathrm{iso}}$ and $\\Delta Q = Q_{\\mathrm{poly}} - Q_{\\mathrm{iso}}$.\n\nUse the International System of Units (SI): $R_0$ in meters, $\\rho_\\ell$ in kilograms per cubic meter, $\\mu$ in pascal-seconds, $\\sigma$ in newtons per meter, $p_{\\infty 0}$ in pascals, and frequencies $f$ in hertz. If the derived natural frequency squared is non-positive for any parameter set, your program must return the floating-point value $\\mathrm{nan}$ for both the frequency and the Quality factor of that model in the output list of that test case.\n\nTest Suite:\n- Case A (happy path, moderate bubble): $R_0 = 10\\times 10^{-6}$, $\\rho_\\ell = 998$, $\\mu = 1.0\\times 10^{-3}$, $\\sigma = 0.072$, $p_{\\infty 0} = 101325$, $\\kappa_g = 1.4$.\n- Case B (higher resonance, smaller bubble): $R_0 = 2\\times 10^{-6}$, $\\rho_\\ell = 998$, $\\mu = 1.0\\times 10^{-3}$, $\\sigma = 0.072$, $p_{\\infty 0} = 101325$, $\\kappa_g = 1.4$.\n- Case C (surface-tension-influenced, very small bubble): $R_0 = 2\\times 10^{-7}$, $\\rho_\\ell = 998$, $\\mu = 1.0\\times 10^{-3}$, $\\sigma = 0.072$, $p_{\\infty 0} = 101325$, $\\kappa_g = 1.4$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list of lists, each inner list ordered as $[f_{\\mathrm{poly}},Q_{\\mathrm{poly}},f_{\\mathrm{iso}},Q_{\\mathrm{iso}},\\Delta f,\\Delta Q]$. For example, the output should look exactly like:\n[[f_{\\mathrm{poly},A},Q_{\\mathrm{poly},A},f_{\\mathrm{iso},A},Q_{\\mathrm{iso},A},\\Delta f_A,\\Delta Q_A],[f_{\\mathrm{poly},B},Q_{\\mathrm{poly},B},f_{\\mathrm{iso},B},Q_{\\mathrm{iso},B},\\Delta f_B,\\Delta Q_B],[f_{\\mathrm{poly},C},Q_{\\mathrm{poly},C},f_{\\mathrm{iso},C},Q_{\\mathrm{iso},C},\\Delta f_C,\\Delta Q_C]].\nAll numerical entries must be floating-point numbers in SI units as specified, with frequencies in hertz and $Q$ dimensionless.",
            "solution": "The problem requires the derivation of the natural resonance frequency and Quality factor for small-amplitude radial oscillations of a spherical gas bubble in a liquid. The derivation begins with the Rayleigh-Plesset equation, which governs the dynamics of the bubble radius $R(t)$ in an incompressible liquid of density $\\rho_\\ell$ and dynamic viscosity $\\mu$.\n\nThe Rayleigh-Plesset equation is given by:\n$$\n\\rho_\\ell \\left( R \\ddot{R} + \\frac{3}{2} \\dot{R}^2 \\right) = p_g(t) - p_\\infty(t) - \\frac{2\\sigma}{R} - \\frac{4\\mu}{R} \\dot{R}\n$$\nHere, $p_g(t)$ is the gas pressure inside the bubble, $p_\\infty(t)$ is the pressure in the liquid far from the bubble, and $\\sigma$ is the surface tension at the gas-liquid interface. The dots denote time derivatives.\n\nThe gas pressure $p_g(t)$ is related to the bubble volume $V(t) = \\frac{4}{3}\\pi R(t)^3$ through a polytropic relation, $p_g(t) V(t)^\\kappa = \\text{constant}$. This implies $p_g(t) R(t)^{3\\kappa}$ is constant. At equilibrium, the bubble has radius $R_0$ and the gas pressure is $p_{g0}$. Thus, the instantaneous gas pressure is:\n$$\np_g(t) = p_{g0} \\left( \\frac{R_0}{R(t)} \\right)^{3\\kappa}\n$$\nwhere $\\kappa$ is the polytropic exponent. For an isothermal process, $\\kappa=1$, and for a polytropic process, it is given as $\\kappa = \\kappa_g > 1$.\n\nThe pressure in the liquid, $p_\\infty(t)$, consists of a static ambient pressure $p_{\\infty 0}$ and a time-varying acoustic component $p_A(t)$, so $p_\\infty(t) = p_{\\infty 0} + p_A(t)$. At static equilibrium ($R = R_0$, $\\dot{R}=0$, $\\ddot{R}=0$, $p_A(t)=0$), the Rayleigh-Plesset equation reduces to the mechanical balance equation:\n$$\np_{g0} - p_{\\infty 0} - \\frac{2\\sigma}{R_0} = 0 \\implies p_{g0} = p_{\\infty 0} + \\frac{2\\sigma}{R_0}\n$$\nThis matches the equilibrium condition provided in the problem statement.\n\nTo analyze small oscillations, we linearize the system around the equilibrium state. We express the radius as a small perturbation from equilibrium: $R(t) = R_0(1 + x(t))$, where $|x(t)| \\ll 1$. Consequently, $\\dot{R} = R_0 \\dot{x}$ and $\\ddot{R} = R_0 \\ddot{x}$. We substitute this into the Rayleigh-Plesset equation and retain only terms linear in $x$ and its derivatives.\n\nThe terms in the equation are linearized as follows:\n- LHS: $\\rho_\\ell ( R \\ddot{R} + \\frac{3}{2} \\dot{R}^2 ) = \\rho_\\ell ( R_0(1+x) R_0 \\ddot{x} + \\frac{3}{2} (R_0 \\dot{x})^2 ) \\approx \\rho_\\ell R_0^2 \\ddot{x}$. The terms $x\\ddot{x}$ and $\\dot{x}^2$ are second-order and neglected.\n- $p_g(t) = p_{g0} (1+x)^{-3\\kappa} \\approx p_{g0} (1 - 3\\kappa x)$.\n- $p_\\infty(t) = p_{\\infty 0} + p_A(t)$.\n- $\\frac{2\\sigma}{R} = \\frac{2\\sigma}{R_0(1+x)} \\approx \\frac{2\\sigma}{R_0}(1-x)$.\n- $\\frac{4\\mu \\dot{R}}{R} = \\frac{4\\mu R_0 \\dot{x}}{R_0(1+x)} \\approx 4\\mu \\dot{x}$.\n\nSubstituting these linearized expressions into the Rayleigh-Plesset equation:\n$$\n\\rho_\\ell R_0^2 \\ddot{x} \\approx \\left[ p_{g0}(1-3\\kappa x) \\right] - \\left[ p_{\\infty 0} + p_A(t) \\right] - \\left[ \\frac{2\\sigma}{R_0}(1-x) \\right] - \\left[ 4\\mu \\dot{x} \\right]\n$$\nGrouping terms:\n$$\n\\rho_\\ell R_0^2 \\ddot{x} + 4\\mu \\dot{x} + \\left( 3\\kappa p_{g0} - \\frac{2\\sigma}{R_0} \\right) x \\approx (p_{g0} - p_{\\infty 0} - \\frac{2\\sigma}{R_0}) - p_A(t)\n$$\nThe static equilibrium term on the right-hand side is zero. We substitute $p_{g0} = p_{\\infty 0} + 2\\sigma/R_0$ into the coefficient of $x$:\n$$\n3\\kappa p_{g0} - \\frac{2\\sigma}{R_0} = 3\\kappa \\left( p_{\\infty 0} + \\frac{2\\sigma}{R_0} \\right) - \\frac{2\\sigma}{R_0} = 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}\n$$\nThe linearized equation of motion for the bubble wall displacement $x(t)$ becomes:\n$$\n\\rho_\\ell R_0^2 \\ddot{x} + 4\\mu \\dot{x} + \\left[ 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0} \\right] x = -p_A(t)\n$$\nThis is the equation of a forced, damped harmonic oscillator, $m\\ddot{x} + c\\dot{x} + kx = F(t)$, with the following effective coefficients:\n- Effective mass: $m = \\rho_\\ell R_0^2$\n- Effective damping coefficient: $c = 4\\mu$\n- Effective spring constant: $k = 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}$\n\nThe undamped natural angular frequency $\\omega_0$ is given by $\\omega_0 = \\sqrt{k/m}$.\n$$\n\\omega_0^2 = \\frac{k}{m} = \\frac{3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}}{\\rho_\\ell R_0^2}\n$$\nThe natural frequency in hertz is $f_0 = \\omega_0 / (2\\pi)$.\n\nThe Quality factor, $Q$, for weak damping is defined as $Q = m\\omega_0/c$. Substituting the derived coefficients:\n$$\nQ = \\frac{(\\rho_\\ell R_0^2)\\omega_0}{4\\mu}\n$$\nWe now apply these general formulas to the two specified cases.\n\n(i) Polytropic case: $\\kappa = \\kappa_g$.\nThe squared natural angular frequency is:\n$$\n\\omega_{0, \\text{poly}}^2 = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3\\kappa_g p_{\\infty 0} + (3\\kappa_g - 1)\\frac{2\\sigma}{R_0} \\right]\n$$\nIf $\\omega_{0, \\text{poly}}^2 > 0$, the polytropic resonance frequency is $f_{\\text{poly}} = \\frac{\\sqrt{\\omega_{0, \\text{poly}}^2}}{2\\pi}$, and the Quality factor is $Q_{\\text{poly}} = \\frac{\\rho_\\ell R_0^2 \\sqrt{\\omega_{0, \\text{poly}}^2}}{4\\mu}$.\n\n(ii) Isothermal case: $\\kappa = 1$.\nThe squared natural angular frequency is:\n$$\n\\omega_{0, \\text{iso}}^2 = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3(1) p_{\\infty 0} + (3(1) - 1)\\frac{2\\sigma}{R_0} \\right] = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3 p_{\\infty 0} + \\frac{4\\sigma}{R_0} \\right]\n$$\nIf $\\omega_{0, \\text{iso}}^2 > 0$, the isothermal resonance frequency is $f_{\\text{iso}} = \\frac{\\sqrt{\\omega_{0, \\text{iso}}^2}}{2\\pi}$, and the Quality factor is $Q_{\\text{iso}} = \\frac{\\rho_\\ell R_0^2 \\sqrt{\\omega_{0, \\text{iso}}^2}}{4\\mu}$.\n\nIf $\\omega_0^2$ for any case is non-positive, the corresponding frequency and Q factor are undefined and will be reported as `nan`. For the given physical parameters ($\\rho_\\ell, \\mu, \\sigma, p_{\\infty 0}, R_0 > 0$ and $\\kappa \\ge 1$), the term $k$ is always positive, so $\\omega_0^2$ will be positive.\n\nThe program will implement these formulas to compute $f_{\\text{poly}}$, $Q_{\\text{poly}}$, $f_{\\text{iso}}$, $Q_{\\text{iso}}$, and the differences $\\Delta f = f_{\\text{poly}} - f_{\\text{iso}}$ and $\\Delta Q = Q_{\\text{poly}} - Q_{\\text{iso}}$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the bubble resonance problem for the given test cases.\n    \"\"\"\n    # Test cases as provided in the problem statement.\n    # Each tuple contains: (R0, rho_l, mu, sigma, p_inf0, kappa_g)\n    test_cases = [\n        # Case A (happy path, moderate bubble)\n        (10e-6, 998, 1.0e-3, 0.072, 101325, 1.4),\n        # Case B (higher resonance, smaller bubble)\n        (2e-6, 998, 1.0e-3, 0.072, 101325, 1.4),\n        # Case C (surface-tension-influenced, very small bubble)\n        (2e-7, 998, 1.0e-3, 0.072, 101325, 1.4),\n    ]\n\n    def calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, kappa):\n        \"\"\"\n        Calculates resonance frequency (Hz) and Quality factor for a bubble.\n\n        Args:\n            R0 (float): Equilibrium radius in meters.\n            rho_l (float): Liquid density in kg/m^3.\n            mu (float): Liquid dynamic viscosity in Pa*s.\n            sigma (float): Surface tension in N/m.\n            p_inf0 (float): Ambient static pressure in Pa.\n            kappa (float): Polytropic exponent.\n\n        Returns:\n            tuple[float, float]: A tuple containing the resonance frequency (f0)\n                                 and the Quality factor (Q). Returns (nan, nan)\n                                 if resonance frequency is not real.\n        \"\"\"\n        # Numerator of the omega_0^2 expression, related to the effective spring constant k\n        # k = 3*kappa*p_inf0 + (3*kappa - 1) * 2*sigma/R0\n        k_numerator = 3 * kappa * p_inf0 + (3 * kappa - 1) * (2 * sigma / R0)\n\n        # Denominator of the omega_0^2 expression, related to the effective mass m\n        # m = rho_l * R0^2\n        m_denominator = rho_l * R0**2\n        \n        if k_numerator = 0 or m_denominator = 0:\n            return np.nan, np.nan\n\n        # Squared natural angular frequency (rad/s)^2\n        omega0_sq = k_numerator / m_denominator\n\n        # Natural angular frequency in rad/s\n        omega0 = np.sqrt(omega0_sq)\n\n        # Natural frequency in Hz\n        f0 = omega0 / (2 * np.pi)\n\n        # Quality factor Q = m * omega0 / c, where m = rho_l * R0^2 and c = 4 * mu\n        Q = (rho_l * R0**2 * omega0) / (4 * mu)\n        \n        return f0, Q\n\n    results = []\n    for case in test_cases:\n        R0, rho_l, mu, sigma, p_inf0, kappa_g = case\n\n        # (i) Polytropic case\n        f_poly, Q_poly = calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, kappa_g)\n\n        # (ii) Isothermal case\n        f_iso, Q_iso = calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, 1.0)\n        \n        # Calculate differences\n        if np.isnan(f_poly) or np.isnan(f_iso):\n            delta_f = np.nan\n        else:\n            delta_f = f_poly - f_iso\n            \n        if np.isnan(Q_poly) or np.isnan(Q_iso):\n            delta_Q = np.nan\n        else:\n            delta_Q = Q_poly - Q_iso\n\n        case_results = [f_poly, Q_poly, f_iso, Q_iso, delta_f, delta_Q]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    # Using map(str, ...) and join is robust for formatting the final string.\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n\n```"
        },
        {
            "introduction": "Our final practice moves beyond simplified models to simulate the rich, coupled dynamics of a bubble in a more realistic setting. This exercise requires you to build a model that captures not only the bubble's radial pulsation but also its translation through the fluid under the influence of acoustic radiation forces near a boundary . Successfully completing this simulation demonstrates how to integrate multiple physical principles to predict complex behaviors, such as a bubble's migration and potential impact with a surface.",
            "id": "4117935",
            "problem": "A single spherical gas bubble of initial radius $R_0$ oscillates in a quiescent Newtonian liquid of density $\\rho_\\ell$, dynamic viscosity $\\mu$, and surface tension $\\sigma$, adjacent to a rigid planar wall located at $x=0$. The bubble center is constrained to one-dimensional motion along the wall-normal coordinate $x(t)0$. The liquid is driven by a one-dimensional standing acoustic field consistent with a rigid wall such that the acoustic pressure is $p_{\\mathrm{ac}}(x,t)=P_A \\cos(k x)\\sin(\\omega t)$, with $k=\\omega/c$ and $c$ the sound speed in water. The bubble experiences coupled radial and translational dynamics due to the acoustic field. You must determine, by first-principles derivation and numerical simulation, for a given set of parameters, whether the bubble will impact the wall (i.e., whether $x(t)-R(t)\\le 0$ for some $t$ within a prescribed simulation horizon), and if so, at what time this first impact occurs.\n\nYour model and algorithm must be derived from a valid fundamental base appropriate to computational acoustics and cavitation dynamics. Begin from Newton’s second law applied to the bubble interface for the radial motion and to the bubble’s translational motion including added mass effects, and use well-tested constitutive relations. The following physically grounded modeling assumptions are to be used:\n\n- The bubble gas pressure follows a polytropic law $p_g(R)=p_{g0}\\left(\\dfrac{R_0}{R}\\right)^{3\\gamma}$, where $\\gamma$ is the polytropic exponent and $p_{g0}$ is the initial gas pressure consistent with mechanical equilibrium at $t=0$.\n- The far-field liquid pressure away from the bubble is $p_\\infty(t)=p_0+p_{\\mathrm{ac}}(x(t),t)$, where $p_0$ is the ambient static pressure.\n- The radial dynamics of the bubble interface follow from a balance of normal stresses at the interface in incompressible, irrotational liquid flow with viscous and capillary corrections appropriate for small Mach number cavitation, and must be expressed as a second-order ordinary differential equation for $R(t)$.\n- The translational dynamics along $x(t)$ follow from Newton’s second law for a body with time-varying added mass. Model the hydrodynamic added mass as $m_{\\mathrm{eff}}(t)=C_m \\rho_\\ell V(t)$, where $C_m$ is the added-mass coefficient for a sphere in potential flow, $\\rho_\\ell$ is the liquid density, and $V(t)=\\dfrac{4}{3}\\pi R^3(t)$ is the instantaneous bubble volume. Include viscous drag appropriate for small Reynolds number, and the Primary Bjerknes force obtained from the pressure gradient of the acoustic field acting on the instantaneous bubble volume.\n- The Primary Bjerknes force is defined as $F_B(t)=-V(t)\\,\\nabla p_{\\mathrm{ac}}(x(t),t)$ along the $x$-direction. Use the given $p_{\\mathrm{ac}}(x,t)$ to obtain an explicit $F_B(t)$ as a function of $R(t)$, $x(t)$, and $t$.\n- Adopt a clean-bubble Stokes drag $F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$ along the $x$-direction.\n- Implement the translational dynamics in a form that correctly accounts for the time variation of $m_{\\mathrm{eff}}(t)$ by using $ \\dfrac{d}{dt}\\left(m_{\\mathrm{eff}}(t)\\dot{x}(t)\\right)=F_B(t)-F_D(t)$.\n\nYou must:\n\n1. Derive the coupled system of ordinary differential equations for the state vector $[R(t),\\dot{R}(t),x(t),\\dot{x}(t)]$ from the stated physical assumptions.\n2. Implement a robust numerical integrator to evolve the state until either the simulation horizon $T_{\\mathrm{end}}$ is reached or the wall-impact event $x(t)-R(t)=0$ occurs. The wall-impact condition must be implemented as an event that terminates integration at the first occurrence.\n3. For each test case, report the first impact time in seconds as a floating-point number. If no impact occurs within $T_{\\mathrm{end}}$, report $-1.0$.\n\nUse the following constants and units: $\\rho_\\ell=1000\\,\\mathrm{kg/m^3}$, $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\sigma=0.072\\,\\mathrm{N/m}$, $p_0=101325\\,\\mathrm{Pa}$, $c=1480\\,\\mathrm{m/s}$, $C_m=0.5$, and $\\gamma=1.4$. The initial gas pressure must satisfy mechanical equilibrium at $t=0$ with $p_g(R_0) = p_0 + \\dfrac{2\\sigma}{R_0}$.\n\nTest suite (each case specifies $P_A$ in pascals, $f$ in hertz, $R_0$ in meters, $x_0$ in meters, and $T_{\\mathrm{end}}$ in seconds; angles are implicitly in radians through $\\sin(\\cdot)$ and $\\cos(\\cdot)$):\n\n- Case 1 (general case near Minnaert resonance with moderate amplitude): $P_A=80000$, $f=300000$, $R_0=8\\times 10^{-6}$, $x_0=6.0\\times 10^{-4}$, $T_{\\mathrm{end}}=1.0\\times 10^{-3}$.\n- Case 2 (happy-path impact with higher amplitude and proximity): $P_A=150000$, $f=300000$, $R_0=8\\times 10^{-6}$, $x_0=1.0\\times 10^{-4}$, $T_{\\mathrm{end}}=5.0\\times 10^{-4}$.\n- Case 3 (boundary condition grazing scenario): $P_A=120000$, $f=330000$, $R_0=1.0\\times 10^{-5}$, $x_0=1.08\\times R_0$, $T_{\\mathrm{end}}=2.0\\times 10^{-4}$.\n- Case 4 (edge case with very low amplitude): $P_A=5000$, $f=100000$, $R_0=1.0\\times 10^{-5}$, $x_0=5.0\\times 10^{-5}$, $T_{\\mathrm{end}}=1.0\\times 10^{-3}$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry the impact time in seconds for the corresponding case in the order given above, using the unit $\\mathrm{s}$ and the convention that $-1.0$ indicates no impact within $T_{\\mathrm{end}}$. For example: $[t_1,t_2,t_3,t_4]$ where each $t_i$ is a floating-point number in seconds.",
            "solution": "The user-provided problem has been analyzed and is determined to be valid. The following sections provide a complete derivation of the governing equations and a description of the numerical algorithm designed to solve them.\n\nFirst, we establish the validity of the problem statement.\nThe problem is scientifically grounded, well-posed, and objective. It describes the coupled radial and translational dynamics of a single gas bubble near a rigid wall under acoustic forcing, a canonical problem in the field of cavitation dynamics.\nThe givens are:\n- Liquid properties: density $\\rho_\\ell$, dynamic viscosity $\\mu$, surface tension $\\sigma$.\n- Ambient conditions: static pressure $p_0$, sound speed $c$.\n- Geometric setup: Rigid wall at $x=0$, bubble center at $x(t)$.\n- Initial conditions: Initial radius $R_0$, initial position $x_0$. The liquid is \"quiescent,\" implying initial velocities $\\dot{R}(0)=0$ and $\\dot{x}(0)=0$.\n- Acoustic field: $p_{\\mathrm{ac}}(x,t)=P_A \\cos(k x)\\sin(\\omega t)$, with $k=\\omega/c$ and $\\omega=2\\pi f$.\n- Gas properties: Polytropic behavior $p_g(R)=p_{g0}\\left(R_0/R\\right)^{3\\gamma}$ with initial mechanical equilibrium $p_{g0} = p_0 + 2\\sigma/R_0$.\n- Dynamic models:\n  - Radial motion governed by a second-order ODE for $R(t)$ derived from normal stress balance.\n  - Translational motion for $x(t)$ from Newton's second law with time-varying added mass: $\\frac{d}{dt}\\left(m_{\\mathrm{eff}}(t)\\dot{x}(t)\\right)=F_B(t)-F_D(t)$.\n  - Added mass: $m_{\\mathrm{eff}}(t)=C_m \\rho_\\ell V(t)$ where $V(t)=\\frac{4}{3}\\pi R^3(t)$.\n  - Primary Bjerknes force: $F_B(t)=-V(t)\\,\\nabla p_{\\mathrm{ac}}(x(t),t)$.\n  - Stokes drag: $F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$.\n- Constants: $\\rho_\\ell=1000\\,\\mathrm{kg/m^3}$, $\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$, $\\sigma=0.072\\,\\mathrm{N/m}$, $p_0=101325\\,\\mathrm{Pa}$, $c=1480\\,\\mathrm{m/s}$, $C_m=0.5$, $\\gamma=1.4$.\n- Task: For each test case ($P_A, f, R_0, x_0, T_{\\mathrm{end}}$), find the first impact time $t_{\\mathrm{impact}}$ where $x(t)-R(t) \\le 0$, or report $-1.0$ if no impact occurs by $T_{\\mathrm{end}}$.\n\nThe problem does not violate any scientific principles. The models prescribed (Rayleigh-Plesset equation for radial dynamics, Bjerknes force and added mass formalism for translation) are standard and appropriate for this physical regime. The setup is self-contained and mathematically formalizable into a system of ordinary differential equations (ODEs) with well-defined initial conditions. Therefore, the problem is deemed valid and a solution is derived.\n\nThe state of the system at any time $t$ can be described by a state vector $Y(t) = [R(t), \\dot{R}(t), x(t), \\dot{x}(t)]^T$. To solve for the evolution of this state, we formulate a system of four coupled first-order ODEs, $\\dot{Y} = f(t, Y)$. Let $y_1=R$, $y_2=\\dot{R}$, $y_3=x$, and $y_4=\\dot{x}$. The system is:\n$$\n\\begin{cases}\n\\dot{y_1} = y_2 \\\\\n\\dot{y_2} = \\ddot{R}(t) \\\\\n\\dot{y_3} = y_4 \\\\\n\\dot{y_4} = \\ddot{x}(t)\n\\end{cases}\n$$\nWe must now derive the expressions for the second derivatives $\\ddot{R}$ and $\\ddot{x}$ based on the physical principles outlined in the problem.\n\nThe radial dynamics are governed by the Rayleigh-Plesset equation, which arises from the momentum equation for an incompressible fluid in spherical coordinates, combined with a normal stress balance at the bubble interface. The equation is:\n$$ R\\ddot{R} + \\frac{3}{2}\\dot{R}^2 = \\frac{1}{\\rho_\\ell} \\left( p_B(t) - p_\\infty(t) \\right) $$\nHere, $p_B(t)$ is the pressure in the liquid at the bubble wall, and $p_\\infty(t) = p_0 + p_{\\mathrm{ac}}(x(t), t)$ is the pressure far from the bubble. The pressure $p_B(t)$ is related to the internal gas pressure $p_g(t)$, surface tension $\\sigma$, and viscous stress by the normal stress balance:\n$$ p_B(t) = p_g(t) - \\frac{2\\sigma}{R} - \\frac{4\\mu\\dot{R}}{R} $$\nSubstituting this into the Rayleigh-Plesset equation and using the given expressions for $p_g$ and $p_\\infty$ yields:\n$$ R\\ddot{R} + \\frac{3}{2}\\dot{R}^2 = \\frac{1}{\\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{R}\\right)^{3\\gamma} - \\frac{2\\sigma}{R} - \\frac{4\\mu\\dot{R}}{R} - p_0 - P_A \\cos(k x) \\sin(\\omega t) \\right) $$\nSolving for $\\ddot{R}$, we obtain the second ODE of our system:\n$$ \\ddot{R} = \\frac{1}{R\\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{R}\\right)^{3\\gamma} - \\frac{2\\sigma}{R} - p_0 - P_A \\cos(k x) \\sin(\\omega t) \\right) - \\frac{4\\mu\\dot{R}}{\\rho_\\ell R^2} - \\frac{3\\dot{R}^2}{2R} $$\n\nThe translational dynamics are governed by Newton's second law for a body with time-varying mass, written as $\\frac{d}{dt}(m_{\\mathrm{eff}}\\dot{x}) = F_{\\mathrm{net}}$. Expanding the derivative and solving for the acceleration $\\ddot{x}$ gives:\n$$ \\ddot{x} = \\frac{1}{m_{\\mathrm{eff}}} \\left( F_{\\mathrm{net}} - \\dot{m}_{\\mathrm{eff}}\\dot{x} \\right) $$\nThe net external force is the sum of the Primary Bjerknes force $F_B$ and the drag force. The problem defines the equation as $F_B - F_D$, where $F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$ is the Stokes drag. This implies the drag force component is $-F_D$. The Bjerknes force is $F_B(t) = -V(t) \\nabla p_{\\mathrm{ac}}$. The pressure gradient in the $x$-direction is $\\frac{\\partial p_{\\mathrm{ac}}}{\\partial x} = -k P_A \\sin(kx) \\sin(\\omega t)$. Thus:\n$$ F_B(t) = - \\left(\\frac{4}{3}\\pi R^3\\right) \\left(-k P_A \\sin(kx) \\sin(\\omega t)\\right) = \\frac{4}{3}\\pi R^3 k P_A \\sin(kx) \\sin(\\omega t) $$\nThe effective added mass is $m_{\\mathrm{eff}}(t) = C_m \\rho_\\ell V(t) = C_m \\rho_\\ell \\frac{4}{3}\\pi R^3$. Its time derivative is $\\dot{m}_{\\mathrm{eff}}(t) = C_m \\rho_\\ell (4\\pi R^2 \\dot{R})$.\nSubstituting these into the equation for $\\ddot{x}$:\n$$ \\ddot{x} = \\frac{F_B - F_D}{m_{\\mathrm{eff}}} - \\frac{\\dot{m}_{\\mathrm{eff}}}{m_{\\mathrm{eff}}}\\dot{x} = \\frac{\\frac{4}{3}\\pi R^3 k P_A \\sin(kx) \\sin(\\omega t) - 6\\pi \\mu R \\dot{x}}{C_m \\rho_\\ell \\frac{4}{3}\\pi R^3} - \\frac{C_m \\rho_\\ell 4\\pi R^2 \\dot{R}}{C_m \\rho_\\ell \\frac{4}{3}\\pi R^3}\\dot{x} $$\nSimplifying this expression yields the fourth ODE of our system:\n$$ \\ddot{x} = \\frac{k P_A \\sin(kx) \\sin(\\omega t)}{C_m \\rho_\\ell} - \\frac{9\\mu}{2C_m \\rho_\\ell R^2}\\dot{x} - \\frac{3\\dot{R}}{R}\\dot{x} $$\n\nThe complete system of first-order ODEs is:\n$$\n\\begin{align*}\n\\dot{y_1} = y_2 \\\\\n\\dot{y_2} = \\frac{1}{y_1 \\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{y_1}\\right)^{3\\gamma} - \\frac{2\\sigma}{y_1} - p_0 - P_A \\cos(k y_3) \\sin(\\omega t) \\right) - \\frac{4\\mu y_2}{\\rho_\\ell y_1^2} - \\frac{3y_2^2}{2y_1} \\\\\n\\dot{y_3} = y_4 \\\\\n\\dot{y_4} = \\frac{k P_A \\sin(k y_3) \\sin(\\omega t)}{C_m \\rho_\\ell} - \\left( \\frac{9\\mu}{2C_m \\rho_\\ell y_1^2} + \\frac{3y_2}{y_1} \\right) y_4\n\\end{align*}\n$$\nThe initial conditions corresponding to a bubble at rest are $Y_0 = [R_0, 0, x_0, 0]^T$.\n\nTo solve this initial value problem, we employ a numerical ODE solver. The `scipy.integrate.solve_ivp` function from the SciPy library is a suitable choice, providing robust adaptive step-size Runge-Kutta methods. The simulation for each test case is run from $t=0$ to $t=T_{\\mathrm{end}}$.\nA critical requirement is to detect the moment of impact with the wall. The impact condition is $x(t) - R(t) \\le 0$. We implement this as a termination event for the ODE solver. We define an event function $g(t,Y) = y_3(t) - y_1(t)$. The solver is instructed to find the root of this function (i.e., when $g(t,Y)=0$) and terminate the integration at the first occurrence. Since the bubble starts with $x_0  R_0$, the event function is initially positive, and we look for a zero-crossing in the negative direction.\nThe algorithm proceeds as follows: for each test case, we set up all physical parameters and initial conditions. We then call `solve_ivp` with the ODE system, the time interval $[0, T_{\\mathrm{end}}]$, the initial state vector, and the wall-impact event function. If the solver detects an event, the corresponding time is recorded as the impact time. If the integration completes up to $T_{\\mathrm{end}}$ without any event, it signifies no impact, and the result is recorded as $-1.0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves the coupled equations for bubble radius and translation\n    to determine the wall impact time.\n    \"\"\"\n\n    # --- Constants and Units ---\n    # All values are in SI units.\n    RHO_L = 1000.0  # kg/m^3\n    MU = 1.0e-3    # Pa*s\n    SIGMA = 0.072   # N/m\n    P0 = 101325.0  # Pa\n    C = 1480.0     # m/s\n    C_M = 0.5      # Added-mass coefficient (dimensionless)\n    GAMMA = 1.4    # Polytropic exponent (dimensionless)\n\n    # --- Test Cases ---\n    # Each case: (P_A [Pa], f [Hz], R_0 [m], x_0 [m], T_end [s])\n    test_cases = [\n        (80000.0, 300000.0, 8.0e-6, 6.0e-4, 1.0e-3),\n        (150000.0, 300000.0, 8.0e-6, 1.0e-4, 5.0e-4),\n        (120000.0, 330000.0, 1.0e-5, 1.08 * 1.0e-5, 2.0e-4),\n        (5000.0, 100000.0, 1.0e-5, 5.0e-5, 1.0e-3),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        P_A, f, R0, x0, T_end = case\n        \n        # --- Derived Parameters ---\n        omega = 2.0 * np.pi * f\n        k = omega / C\n        pg0 = P0 + 2.0 * SIGMA / R0\n\n        # --- Pack parameters for the solver ---\n        params = (RHO_L, MU, SIGMA, P0, C_M, GAMMA, P_A, omega, k, R0, pg0)\n\n        def ode_system(t, y, params):\n            \"\"\"\n            Defines the coupled system of 4 first-order ODEs.\n            y = [R, R_dot, x, x_dot]\n            \"\"\"\n            R, R_dot, x, x_dot = y\n            rho_l, mu, sigma, p0, c_m, gamma, pa, w, k_wave, r0, pg_0 = params\n            \n            # Defensive check for non-physical radius\n            if R = 0:\n                return [0, 0, 0, 0]\n\n            # --- Radial Dynamics (Rayleigh-Plesset) ---\n            # y_dot[1] = R_ddot\n            p_acoustic = pa * np.cos(k_wave * x) * np.sin(w * t)\n            \n            pressure_term = (pg_0 * (r0 / R)**(3.0 * gamma) -\n                             2.0 * sigma / R -\n                             4.0 * mu * R_dot / R -\n                             p0 - p_acoustic)\n            \n            R_ddot = (pressure_term / rho_l - 1.5 * R_dot**2) / R\n            \n            # --- Translational Dynamics ---\n            # y_dot[3] = x_ddot\n            bjerknes_term = (k_wave * pa * np.sin(k_wave * x) * np.sin(w * t)) / (c_m * rho_l)\n            drag_term = (9.0 * mu) / (2.0 * c_m * rho_l * R**2) * x_dot\n            added_mass_change_term = (3.0 * R_dot / R) * x_dot\n            \n            x_ddot = bjerknes_term - drag_term - added_mass_change_term\n\n            return [R_dot, R_ddot, x_dot, x_ddot]\n\n        def wall_impact(t, y, params):\n            \"\"\"\n            Event function to detect wall impact: x(t) - R(t) = 0.\n            \"\"\"\n            return y[2] - y[0]\n        \n        wall_impact.terminal = True  # Stop integration at impact\n        wall_impact.direction = -1   # Trigger when going from positive to negative\n\n        # --- Initial Conditions ---\n        y0 = [R0, 0.0, x0, 0.0]  # [R(0), R_dot(0), x(0), x_dot(0)]\n\n        # --- Solve the ODE System ---\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[0, T_end],\n            y0=y0,\n            method='RK45',  # Standard robust solver\n            args=(params,),\n            events=wall_impact,\n            dense_output=True,\n            rtol=1e-8,\n            atol=1e-12\n        )\n\n        # --- Process Results ---\n        if sol.t_events[0].size > 0:\n            impact_time = sol.t_events[0][0]\n            results.append(impact_time)\n        else:\n            results.append(-1.0)\n            \n    # --- Final Output Formatting ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}