{
    "hands_on_practices": [
        {
            "introduction": "声空化是由液体中剧烈的压力波动引发的。本实践旨在量化声源，特别是计算聚焦超声换能器产生的声压场。通过实现瑞利积分，您将获得模拟换能器几何形状和频率如何决定焦点压力的实践经验，这是预测空化起始的关键参数。",
            "id": "4117903",
            "problem": "考虑一种无损、无粘性的流体，其质量密度 $\\rho$ 和声速 $c$ 为常数，时谐线性声学行为由标量声波方程控制。设一个孔径半径为 $a$ 的带障板的圆形活塞换能器嵌入一个无限大的刚性平面中，并在上半空间工作。该活塞施加一个指定的法向表面速度幅值 $v_0$（在整个孔径上均匀），并选择一个空间相位，以聚焦到距离孔径中心轴向距离为 $f$ 的轴上场点。设声角频率为 $\\omega$，波长为 $\\lambda$，因此波数 $k$ 满足 $k = 2\\pi / \\lambda$。\n\n从复声压 $p$ 的亥姆霍兹方程和自由空间格林函数 $G(\\mathbf{r},\\mathbf{r}') = \\exp(i k \\|\\mathbf{r} - \\mathbf{r}'\\|)/(4\\pi \\|\\mathbf{r} - \\mathbf{r}'\\|)$ 出发，调用上半空间中带障板孔径的瑞利积分 (Rayleigh integral)，将轴向距离 $f$ 处的轴上复焦压 $p_{\\text{focus}}$ 表示为圆形孔径上的积分。使用均匀法向速度幅值 $v_0$ 和聚焦相位的规定，该相位使焦点处的相位一致（即，孔径法向速度包含一个相位因子，该因子抵消了从每个孔径点到焦点的路径相关相位）。你的推导必须从线性声波方程和格林函数的定义开始，并通过瑞利积分 (Rayleigh integral) 进行，不得跳过中间的推理过程。\n\n在这些假设下，建立一个计算方法，通过对简化为极坐标的瑞利积分 (Rayleigh integral) 进行数值积分来评估焦压幅值 $|p_{\\text{focus}}|$。该计算必须明确显示对孔径半径 $a$、波长 $\\lambda$（通过 $k$）和焦距 $f$ 的依赖性。\n\n将焦压与一个简单的空化可行性检查相结合，该检查基于对水中预先存在的半径为 $R_0$ 的球形气核的静态不等式。设环境静压为 $p_0$，水蒸气压为 $p_v$，水的表面张力为 $\\sigma$。定义一个粗略的空化判据：如果在焦点处的声压负峰值的大小超过了环境静压与（蒸气压和初始气泡半径处的拉普拉斯压力之和）的差值，则空化是可行的。也就是说，定义\n$$\np_{\\text{crit}} = p_0 - \\left(p_v + \\frac{2\\sigma}{R_0}\\right),\n$$\n如果 $|p_{\\text{focus}}| \\ge p_{\\text{crit}}$，则宣布空化可行。该判据忽略了动态效应，只是一个保守的静态检查。\n\n实现一个独立的、自包含的程序，该程序：\n- 基于所述的带聚焦相位的瑞利积分 (Rayleigh integral)，使用极坐标下的数值积分方法计算 $|p_{\\text{focus}}|$（单位为帕斯卡，Pa）（你可以对方位角积分进行解析简化，但必须对径向积分进行数值计算）。\n- 计算由下式定义的归一化几何增益因子 $G$\n$$\nG = \\frac{|p_{\\text{focus}}|}{\\rho c k |v_0|},\n$$\n其单位为米 (m)，从而将对 $a$ 和 $f$ 的依赖性与显式因子 $\\rho c k |v_0|$ 分离。\n- 基于上面定义的 $p_{\\text{crit}}$ 计算空化可行性的布尔值。\n\n在所有测试案例中，使用以下保持不变的流体和换能器参数：\n- $\\rho = 1000$ 千克/立方米,\n- $c = 1500$ 米/秒,\n- $v_0 = 0.01$ 米/秒,\n- $p_0 = 101325$ 帕斯卡,\n- $p_v = 2330$ 帕斯卡,\n- $\\sigma = 0.072$ 牛顿/米,\n- $R_0 = 5\\times 10^{-6}$ 米.\n\n评估以下参数集 $(a,\\lambda,f)$ 的测试套件：\n- 案例1（通用“理想路径”）：$a = 0.005$ 米, $\\lambda = 0.0015$ 米, $f = 0.03$ 米。\n- 案例2（较大孔径和较短波长以测试更强的聚焦）：$a = 0.0125$ 米, $\\lambda = 0.0005$ 米, $f = 0.04$ 米。\n- 案例3（小孔径和较长波长）：$a = 0.001$ 米, $\\lambda = 0.002$ 米, $f = 0.01$ 米。\n- 案例4（远场轴上点）：$a = 0.005$ 米, $\\lambda = 0.0015$ 米, $f = 0.2$ 米。\n- 案例5（近场轴上点）：$a = 0.005$ 米, $\\lambda = 0.0015$ 米, $f = 0.001$ 米。\n\n对于每个案例，你的程序必须生成以下三元组结果：\n- 以帕斯卡 (Pa) 为单位的 $|p_{\\text{focus}}|$，\n- 以米 (m) 为单位的 $G$，\n- 作为布尔值的空化可行性。\n\n最终输出格式要求：\n- 你的程序应生成单行输出，其中包含所有案例结果，这些结果连接并包含在一个方括号列表中，条目按 $[|p_{\\text{focus}}|_1, G_1, \\text{cav}_1, |p_{\\text{focus}}|_2, G_2, \\text{cav}_2, \\ldots, |p_{\\text{focus}}|_5, G_5, \\text{cav}_5]$ 的顺序列出，其中 $\\text{cav}_i$ 是案例 $i$ 的布尔型空化可行性。\n- 数值必须打印为不带单位字符串的 Python 浮点数；不使用角度；必须遵守上文指定的物理单位。",
            "solution": "该问题旨在确定带障板的圆形活塞换能器的轴上焦压，并评估一个简化的空化可行性判据。推导和计算必须遵守指定的约束条件。\n\n**1. 问题验证**\n\n首先，我将验证问题陈述。\n\n**第1步：提取已知条件**\n- **物理系统**：一种无损、无粘性的流体，其质量密度 $\\rho$ 和声速 $c$ 为常数。\n- **控制方程**：由标量声波方程（亥姆霍兹方程）控制的时谐线性声学。\n- **声源**：一个孔径半径为 $a$ 的带障板的圆形活塞换能器，位于无限刚性平面（$z=0$）上，并在上半空间（$z>0$）工作。\n- **声源速度**：指定的法向表面速度，具有均匀幅值 $v_0$ 和一个空间相位，以聚焦在轴上点 $(0,0,f)$。该相位用于均衡到达焦点的路径相关相位延迟。\n- **声学参数**：角频率 $\\omega$，波长 $\\lambda$，波数 $k = 2\\pi / \\lambda$。\n- **数学工具**：复声压 $p$ 的亥姆霍兹方程，自由空间格林函数 $G(\\mathbf{r},\\mathbf{r}') = \\exp(i k \\|\\mathbf{r} - \\mathbf{r}'\\|)/(4\\pi \\|\\mathbf{r} - \\mathbf{r}'\\|)$，瑞利积分 (Rayleigh integral)。\n- **目标1（压力）**：建立一个计算方法，通过对简化为极坐标的瑞利积分 (Rayleigh integral) 进行数值积分，计算焦压幅值 $|p_{\\text{focus}}|$。方位角积分可以解析求解。\n- **目标2（增益）**：计算归一化几何增益因子 $G = |p_{\\text{focus}}|/(\\rho c k |v_0|)$。\n- **目标3（空化）**：实现一个空化可行性检查。判据为 $|p_{\\text{focus}}| \\ge p_{\\text{crit}}$，其中临界压力定义为 $p_{\\text{crit}} = p_0 - (p_v + 2\\sigma/R_0)$。\n- **常量**：\n    - $\\rho = 1000$ kg/m$^3$\n    - $c = 1500$ m/s\n    - $v_0 = 0.01$ m/s\n    - $p_0 = 101325$ Pa\n    - $p_v = 2330$ Pa\n    - $\\sigma = 0.072$ N/m\n    - $R_0 = 5\\times 10^{-6}$ m\n- **测试案例**：\n    - 案例1：$(a, \\lambda, f) = (0.005, 0.0015, 0.03)$ m\n    - 案例2：$(a, \\lambda, f) = (0.0125, 0.0005, 0.04)$ m\n    - 案例3：$(a, \\lambda, f) = (0.001, 0.002, 0.01)$ m\n    - 案例4：$(a, \\lambda, f) = (0.005, 0.0015, 0.2)$ m\n    - 案例5：$(a, \\lambda, f) = (0.005, 0.0015, 0.001)$ m\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于线性声学的标准原理：亥姆霍兹方程、格林函数以及用于障板声源的瑞利积分 (Rayleigh integral)。用于聚焦的相控孔径概念是超声学的基础。空化判据被明确标记为“粗略”和“静态”检查，这承认了其简化性质。尽管这是对 `Blake` 阈值的一种非标准表述，但它被作为此问题的目的而给出的一个定义，这在一个自包含的问题陈述中是可以接受的。\n- **适定性**：所有必需的物理常数、几何参数和声源条件都已提供。目标定义明确，所需的计算对每个测试案例都会产生唯一的解。\n- **客观性**：问题以精确、定量的术语陈述，不含主观语言。\n- **未检测到其他缺陷**：该问题不完整、不矛盾、不切实际、不适定或琐碎。它需要一个标准的推导和一个直接的数值实现。\n\n**第3步：结论与行动**\n问题被判定为**有效**。我将继续进行解答。\n\n**2. 推导与公式化**\n\n按要求，推导从线性声学的基础方程开始。\n\n**从亥姆霍兹方程到瑞利积分**\n对于角频率为 $\\omega$ 的时谐声场，在无源、均匀、无粘性的流体中，复声压幅值 $p(\\mathbf{r})$ 由亥姆霍兹方程控制：\n$$\n(\\nabla^2 + k^2)p(\\mathbf{r}) = 0\n$$\n其中 $k = \\omega/c$ 是声波数， $c$ 是声速。此偏微分方程的解可以通过格林函数方法构建。自由空间格林函数 $G(\\mathbf{r}, \\mathbf{r}')$ 是 $(\\nabla^2 + k^2)G(\\mathbf{r}, \\mathbf{r}') = -\\delta(\\mathbf{r}-\\mathbf{r}')$ 的解，代表位于 $\\mathbf{r}'$ 的点源产生的声场：\n$$\nG(\\mathbf{r}, \\mathbf{r}') = \\frac{e^{ik\\|\\mathbf{r} - \\mathbf{r}'\\|}}{4\\pi\\|\\mathbf{r} - \\mathbf{r}'\\|}\n$$\n该问题考虑的是一个位于无限大刚性障板中的平面声源。这是一个半空间中的边值问题。由位于 $z=0$ 平面上的振动表面 $S$ 在半空间 $z>0$ 中产生的声压场由瑞利积分（也称为 Rayleigh-Sommerfeld I 积分）给出：\n$$\np(\\mathbf{r}) = \\frac{i\\omega\\rho}{2\\pi} \\iint_S v_n(\\mathbf{r}') \\frac{e^{ik\\|\\mathbf{r} - \\mathbf{r}'\\|}}{\\|\\mathbf{r} - \\mathbf{r}'\\|} dS'\n$$\n这里，$\\rho$ 是流体密度，$v_n(\\mathbf{r}')$ 是位于位置 $\\mathbf{r}'$ 的表面元 $dS'$ 上的法向速度，积分遍及整个振动表面 $S$。该积分是给定边界条件下亥姆霍兹方程的一个特定解。\n\n**应用于聚焦圆形活塞**\n换能器是一个半径为 $a$ 的圆形孔径，中心在 $xy$ 平面的原点。我们对源表面使用极坐标：$\\mathbf{r}' = (r' \\cos\\phi', r' \\sin\\phi', 0)$，其中 $0 \\le r' \\le a$ 且 $0 \\le \\phi' < 2\\pi$。表面元为 $dS' = r' dr' d\\phi'$。\n\n目标场点是轴上焦点 $\\mathbf{r} = (0, 0, f)$。从源点 $\\mathbf{r}'$ 到焦点的距离是：\n$$\nR = \\|\\mathbf{r} - \\mathbf{r}'\\| = \\sqrt{(r'\\cos\\phi')^2 + (r'\\sin\\phi')^2 + f^2} = \\sqrt{r'^2 + f^2}\n$$\n法向速度 $v_n(\\mathbf{r}')$ 有一个均匀的幅值 $v_0$。相位的选择是为了确保来自孔径上所有点的波前能同时同相到达焦点 $(0,0,f)$。从 $\\mathbf{r}'$ 到焦点的传播相位是 $kR = k\\sqrt{r'^2+f^2}$。为了抵消这个与路径相关的相位，源速度被赋予一个共轭相位。一个常见的约定是，将到达相位设置为等同于轴上传播的路径，即 $e^{ikf}$。因此，源速度的相位必须是 $k(f-R)$。复法向速度为：\n$$\nv_n(\\mathbf{r}') = v_0 e^{ik(f - \\sqrt{r'^2+f^2})}\n$$\n将这些表达式代入瑞利积分：\n$$\np_{\\text{focus}} = \\frac{i\\omega\\rho}{2\\pi} \\int_0^{2\\pi} \\int_0^a v_0 e^{ik(f - \\sqrt{r'^2+f^2})} \\frac{e^{ik\\sqrt{r'^2+f^2}}}{\\sqrt{r'^2+f^2}} r' dr' d\\phi'\n$$\n被积函数中的相位项简化为：\n$$\ne^{ik(f - \\sqrt{r'^2+f^2})} e^{ik\\sqrt{r'^2+f^2}} = e^{ikf-ik\\sqrt{r'^2+f^2}+ik\\sqrt{r'^2+f^2}} = e^{ikf}\n$$\n被积函数变得与方位角 $\\phi'$ 无关。对 $d\\phi'$ 从 $0$ 到 $2\\pi$ 的积分得到一个因子 $2\\pi$：\n$$\np_{\\text{focus}} = \\frac{i\\omega\\rho v_0}{2\\pi} (2\\pi) e^{ikf} \\int_0^a \\frac{r'}{\\sqrt{r'^2+f^2}} dr'\n$$\n使用关系式 $\\omega=ck$：\n$$\np_{\\text{focus}} = i\\rho c k v_0 e^{ikf} \\int_0^a \\frac{r'}{\\sqrt{r'^2+f^2}} dr'\n$$\n问题要求这个径向积分要用数值方法计算。我们将该积分定义为 $I_{rad}$：\n$$\nI_{rad}(a, f) = \\int_0^a \\frac{r'}{\\sqrt{r'^2+f^2}} dr'\n$$\n\n**物理量的计算**\n1.  **焦压幅值, $|p_{\\text{focus}}|$**: 幅值是复声压 $p_{\\text{focus}}$ 的模。由于 $|i|=1$ 且 $|e^{ikf}|=1$，我们有：\n    $$\n    |p_{\\text{focus}}| = \\left| i\\rho c k v_0 e^{ikf} I_{rad}(a, f) \\right| = \\rho c k |v_0| I_{rad}(a, f)\n    $$\n    这将通过首先使用数值积分计算 $I_{rad}$ 来得到。\n\n2.  **几何增益因子, $G$**: 问题将其定义为：\n    $$\n    G = \\frac{|p_{\\text{focus}}|}{\\rho c k |v_0|}\n    $$\n    代入 $|p_{\\text{focus}}|$ 的表达式：\n    $$\n    G = \\frac{\\rho c k |v_0| I_{rad}(a, f)}{\\rho c k |v_0|} = I_{rad}(a, f)\n    $$\n    因此，几何增益因子就是径向积分的值。尽管该积分有一个简单的解析解 $G = \\sqrt{a^2+f^2}-f$，但问题要求进行数值评估。\n\n3.  **空化可行性**: 临界压力阈值由下式给出：\n    $$\n    p_{\\text{crit}} = p_0 - \\left(p_v + \\frac{2\\sigma}{R_0}\\right)\n    $$\n    使用给定的常数：\n    - 拉普拉斯压力 $p_L = \\frac{2\\sigma}{R_0} = \\frac{2 \\times 0.072}{5 \\times 10^{-6}} = 28800$ Pa。\n    - $p_{\\text{crit}} = 101325 - (2330 + 28800) = 101325 - 31130 = 70195$ Pa。\n    空化可行性由布尔条件确定：\n    $$\n    \\text{CavitationFeasible} = (|p_{\\text{focus}}| \\ge p_{\\text{crit}})\n    $$\n\n**计算步骤**\n对于每个测试案例 $(a, \\lambda, f)$:\n1.  计算波数 $k = 2\\pi/\\lambda$。\n2.  定义被积函数 $g(r') = r'/\\sqrt{r'^2 + f^2}$。\n3.  使用积分程序数值计算积分 $G = \\int_0^a g(r') dr'$。这个值就是几何增益因子。\n4.  计算焦压幅值 $|p_{\\text{focus}}| = \\rho c k |v_0| G$。\n5.  将 $|p_{\\text{focus}}|$ 与预先计算的 $p_{\\text{crit}} = 70195$ Pa 进行比较，以确定布尔型空化可行性。\n6.  为每个案例存储三元组 $(|p_{\\text{focus}}|, G, \\text{Feasibility})$。\n\n此过程将在提供的 Python 环境中实现。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the focal pressure, geometric gain, and cavitation feasibility\n    for a focused circular piston transducer based on the Rayleigh integral.\n    \"\"\"\n    \n    # --- Constant Parameters ---\n    # Fluid properties (water)\n    RHO = 1000.0  # density in kg/m^3\n    C = 1500.0   # sound speed in m/s\n\n    # Source parameters\n    V0 = 0.01     # piston velocity amplitude in m/s\n\n    # Cavitation parameters\n    P0 = 101325.0  # ambient static pressure in Pa\n    PV = 2330.0    # water vapor pressure in Pa\n    SIGMA = 0.072  # surface tension in N/m\n    R0 = 5.0e-6    # initial bubble nucleus radius in m\n\n    # --- Test Cases ---\n    # Each case is a tuple: (a, lambda, f)\n    # a: aperture radius (m)\n    # lambda: wavelength (m)\n    # f: focal distance (m)\n    test_cases = [\n        (0.005, 0.0015, 0.03),    # Case 1\n        (0.0125, 0.0005, 0.04),   # Case 2\n        (0.001, 0.002, 0.01),     # Case 3\n        (0.005, 0.0015, 0.2),     # Case 4\n        (0.005, 0.0015, 0.001)    # Case 5\n    ]\n    \n    # --- Pre-calculate Cavitation Threshold Pressure ---\n    # p_crit = p0 - (pv + 2*sigma/R0)\n    p_crit = P0 - (PV + (2 * SIGMA / R0))\n    \n    # --- Main Calculation Loop ---\n    results = []\n    for a, lambda_val, f in test_cases:\n        # Calculate wavenumber k\n        k = 2 * np.pi / lambda_val\n        \n        # Define the integrand for the radial integral\n        # integrand(r') = r' / sqrt(r'^2 + f^2)\n        def integrand(r_prime):\n            return r_prime / np.sqrt(r_prime**2 + f**2)\n        \n        # Perform numerical quadrature to get the geometric gain G\n        # G is equal to the value of the radial integral\n        # quad returns a tuple (integral_value, estimated_error)\n        G, _ = quad(integrand, 0, a)\n        \n        # Calculate the focal pressure amplitude |p_focus|\n        # |p_focus| = rho * c * k * |v0| * G\n        p_focus_amp = RHO * C * k * V0 * G\n        \n        # Determine cavitation feasibility\n        cavitation_feasible = p_focus_amp >= p_crit\n        \n        # Append the triple of results to the list\n        results.extend([p_focus_amp, G, cavitation_feasible])\n        \n    # --- Format and Print Final Output ---\n    # The format must be a single line: [res1_1,res1_2,res1_3,res2_1,res2_2,res2_3,...]\n    # The map(str, ...) will convert floats and booleans to their string representations.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "一旦受到声场作用，气泡的响应就由其内在动力学决定，其中共振是一个关键现象。本练习将指导您对瑞利-普莱赛特方程进行线性化，以推导气泡的固有频率和品质因数。通过比较等温和多方气体模型，您将探索热效应对气泡共振行为的影响，这是从造影剂到声化学等应用的基础概念。",
            "id": "4117937",
            "problem": "一个平衡半径为 $R_0$ 的单个球形气泡，在低频声场的驱动下，在密度为 $\\rho_\\ell$、动力粘度为 $\\mu$、表面张力为 $\\sigma$ 的不可压缩液体中振荡。气泡内部气体遵循一个以指数 $\\kappa$ 为特征的多方关系。在低声频下，热传导使气体响应趋近于等温极限 $\\kappa = 1$，而在相同环境条件下的绝热或多方模型则使用 $\\kappa = \\kappa_g > 1$。严格地从球形气泡的 Rayleigh–Plesset 动量平衡和理想气体多方关系出发，推导关于平衡点的线性化小振荡模型，并确定在以下两种气体热力学模型假设下的固有（共振）角频率和品质因数（Q）：(i) 多方过程，$\\kappa = \\kappa_g$；(ii) 等温过程，$\\kappa = 1$。在线性振子近似中，品质因数（Q）定义为存储的峰值能量的 $2\\pi$ 倍与每个周期耗散的能量之比；对于弱阻尼，这等于 $Q = m \\omega_0 / c$，其中 $m$ 是有效质量系数，$\\omega_0$ 是固有角频率，$c$ 是有效线性阻尼系数。\n\n你的程序必须实现你为共振频率和品质因数推导出的公式，阻尼仅考虑周围液体的线性粘性阻尼。在阻尼计算中忽略声辐射损失和液体可压缩性。假设环境静压为 $p_{\\infty 0}$，并强制气泡处于力学平衡状态，以使平衡气体压力满足 $p_{g0} = p_{\\infty 0} + 2\\sigma/R_0$。程序必须为每个测试用例计算：\n- 多方共振频率（单位：赫兹），$f_{\\mathrm{poly}}$。\n- 多方品质因数，$Q_{\\mathrm{poly}}$。\n- 等温共振频率（单位：赫兹），$f_{\\mathrm{iso}}$。\n- 等温品质因数，$Q_{\\mathrm{iso}}$。\n- 热效应引起的偏移量 $\\Delta f = f_{\\mathrm{poly}} - f_{\\mathrm{iso}}$ 和 $\\Delta Q = Q_{\\mathrm{poly}} - Q_{\\mathrm{iso}}$。\n\n使用国际单位制（SI）：$R_0$ 单位为米，$\\rho_\\ell$ 单位为千克/立方米，$\\mu$ 单位为帕斯卡·秒，$\\sigma$ 单位为牛顿/米，$p_{\\infty 0}$ 单位为帕斯卡，频率 $f$ 单位为赫兹。如果对于任何参数集，推导出的固有频率的平方为非正值，你的程序必须在该测试用例的输出列表中为该模型的频率和品质因数返回浮点值 $\\mathrm{nan}$。\n\n测试套件：\n- 用例 A（正常路径，中等大小气泡）：$R_0 = 10\\times 10^{-6}$，$\\rho_\\ell = 998$，$\\mu = 1.0\\times 10^{-3}$，$\\sigma = 0.072$，$p_{\\infty 0} = 101325$，$\\kappa_g = 1.4$。\n- 用例 B（更高共振，较小气泡）：$R_0 = 2\\times 10^{-6}$，$\\rho_\\ell = 998$，$\\mu = 1.0\\times 10^{-3}$，$\\sigma = 0.072$，$p_{\\infty 0} = 101325$，$\\kappa_g = 1.4$。\n- 用例 C（受表面张力影响，极小气泡）：$R_0 = 2\\times 10^{-7}$，$\\rho_\\ell = 998$，$\\mu = 1.0\\times 10^{-3}$，$\\sigma = 0.072$，$p_{\\infty 0} = 101325$，$\\kappa_g = 1.4$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含所有测试用例的结果，格式为以逗号分隔的列表的列表，每个内部列表按 $[f_{\\mathrm{poly}},Q_{\\mathrm{poly}},f_{\\mathrm{iso}},Q_{\\mathrm{iso}},\\Delta f,\\Delta Q]$ 的顺序排列。例如，输出应精确如下所示：\n$[[f_{\\mathrm{poly},A},Q_{\\mathrm{poly},A},f_{\\mathrm{iso},A},Q_{\\mathrm{iso},A},\\Delta f_A,\\Delta Q_A],[f_{\\mathrm{poly},B},Q_{\\mathrm{poly},B},f_{\\mathrm{iso},B},Q_{\\mathrm{iso},B},\\Delta f_B,\\Delta Q_B],[f_{\\mathrm{poly},C},Q_{\\mathrm{poly},C},f_{\\mathrm{iso},C},Q_{\\mathrm{iso},C},\\Delta f_C,\\Delta Q_C]]$。\n所有数值条目必须是指定 SI 单位的浮点数，频率单位为赫兹，$Q$ 为无量纲。",
            "solution": "该问题要求推导液体中球形气泡小振幅径向振荡的固有共振频率和品质因数。推导从 Rayleigh-Plesset 方程开始，该方程控制着密度为 $\\rho_\\ell$、动力粘度为 $\\mu$ 的不可压缩液体中气泡半径 $R(t)$ 的动力学。\n\nRayleigh-Plesset 方程如下：\n$$\n\\rho_\\ell \\left( R \\ddot{R} + \\frac{3}{2} \\dot{R}^2 \\right) = p_g(t) - p_\\infty(t) - \\frac{2\\sigma}{R} - \\frac{4\\mu}{R} \\dot{R}\n$$\n此处，$p_g(t)$ 是气泡内部的气体压力，$p_\\infty(t)$ 是远离气泡的液体中的压力，$\\sigma$ 是气液界面处的表面张力。点表示对时间的导数。\n\n气体压力 $p_g(t)$ 通过多方关系 $p_g(t) V(t)^\\kappa = \\text{常数}$ 与气泡体积 $V(t) = \\frac{4}{3}\\pi R(t)^3$ 相关。这意味着 $p_g(t) R(t)^{3\\kappa}$ 是一个常数。在平衡状态下，气泡半径为 $R_0$，气体压力为 $p_{g0}$。因此，瞬时气体压力为：\n$$\np_g(t) = p_{g0} \\left( \\frac{R_0}{R(t)} \\right)^{3\\kappa}\n$$\n其中 $\\kappa$ 是多方指数。对于等温过程，$\\kappa=1$；对于多方过程，给定为 $\\kappa = \\kappa_g > 1$。\n\n液体中的压力 $p_\\infty(t)$ 由静态环境压力 $p_{\\infty 0}$ 和一个时变声学分量 $p_A(t)$ 组成，因此 $p_\\infty(t) = p_{\\infty 0} + p_A(t)$。在静态平衡时（$R = R_0$, $\\dot{R}=0$, $\\ddot{R}=0$, $p_A(t)=0$），Rayleigh-Plesset 方程简化为力学平衡方程：\n$$\np_{g0} - p_{\\infty 0} - \\frac{2\\sigma}{R_0} = 0 \\implies p_{g0} = p_{\\infty 0} + \\frac{2\\sigma}{R_0}\n$$\n这与问题描述中提供的平衡条件相符。\n\n为了分析小振荡，我们在平衡态附近对系统进行线性化。我们将半径表示为对平衡态的小扰动：$R(t) = R_0(1 + x(t))$，其中 $|x(t)| \\ll 1$。因此，$\\dot{R} = R_0 \\dot{x}$ 且 $\\ddot{R} = R_0 \\ddot{x}$。我们将此代入 Rayleigh-Plesset 方程，并仅保留 $x$ 及其导数的一次项。\n\n方程中的各项线性化如下：\n- 左侧（LHS）：$\\rho_\\ell ( R \\ddot{R} + \\frac{3}{2} \\dot{R}^2 ) = \\rho_\\ell ( R_0(1+x) R_0 \\ddot{x} + \\frac{3}{2} (R_0 \\dot{x})^2 ) \\approx \\rho_\\ell R_0^2 \\ddot{x}$。$x\\ddot{x}$ 和 $\\dot{x}^2$ 项是二阶小量，被忽略。\n- $p_g(t) = p_{g0} (1+x)^{-3\\kappa} \\approx p_{g0} (1 - 3\\kappa x)$.\n- $p_\\infty(t) = p_{\\infty 0} + p_A(t)$.\n- $\\frac{2\\sigma}{R} = \\frac{2\\sigma}{R_0(1+x)} \\approx \\frac{2\\sigma}{R_0}(1-x)$.\n- $\\frac{4\\mu \\dot{R}}{R} = \\frac{4\\mu R_0 \\dot{x}}{R_0(1+x)} \\approx 4\\mu \\dot{x}$.\n\n将这些线性化表达式代入 Rayleigh-Plesset 方程：\n$$\n\\rho_\\ell R_0^2 \\ddot{x} \\approx \\left[ p_{g0}(1-3\\kappa x) \\right] - \\left[ p_{\\infty 0} + p_A(t) \\right] - \\left[ \\frac{2\\sigma}{R_0}(1-x) \\right] - \\left[ 4\\mu \\dot{x} \\right]\n$$\n整理各项：\n$$\n\\rho_\\ell R_0^2 \\ddot{x} + 4\\mu \\dot{x} + \\left( 3\\kappa p_{g0} - \\frac{2\\sigma}{R_0} \\right) x \\approx (p_{g0} - p_{\\infty 0} - \\frac{2\\sigma}{R_0}) - p_A(t)\n$$\n右侧的静态平衡项为零。我们将 $p_{g0} = p_{\\infty 0} + 2\\sigma/R_0$ 代入 $x$ 的系数中：\n$$\n3\\kappa p_{g0} - \\frac{2\\sigma}{R_0} = 3\\kappa \\left( p_{\\infty 0} + \\frac{2\\sigma}{R_0} \\right) - \\frac{2\\sigma}{R_0} = 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}\n$$\n气泡壁位移 $x(t)$ 的线性化运动方程变为：\n$$\n\\rho_\\ell R_0^2 \\ddot{x} + 4\\mu \\dot{x} + \\left[ 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0} \\right] x = -p_A(t)\n$$\n这是一个受迫阻尼谐振子方程 $m\\ddot{x} + c\\dot{x} + kx = F(t)$，具有以下有效系数：\n- 有效质量：$m = \\rho_\\ell R_0^2$\n- 有效阻尼系数：$c = 4\\mu$\n- 有效弹簧常数：$k = 3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}$\n\n无阻尼固有角频率 $\\omega_0$ 由 $\\omega_0 = \\sqrt{k/m}$ 给出。\n$$\n\\omega_0^2 = \\frac{k}{m} = \\frac{3\\kappa p_{\\infty 0} + (3\\kappa - 1)\\frac{2\\sigma}{R_0}}{\\rho_\\ell R_0^2}\n$$\n以赫兹为单位的固有频率为 $f_0 = \\omega_0 / (2\\pi)$。\n\n对于弱阻尼，品质因数 $Q$ 定义为 $Q = m\\omega_0/c$。代入推导出的系数：\n$$\nQ = \\frac{(\\rho_\\ell R_0^2)\\omega_0}{4\\mu}\n$$\n我们现在将这些通用公式应用于指定的两种情况。\n\n(i) 多方情况：$\\kappa = \\kappa_g$。\n固有角频率的平方为：\n$$\n\\omega_{0, \\text{poly}}^2 = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3\\kappa_g p_{\\infty 0} + (3\\kappa_g - 1)\\frac{2\\sigma}{R_0} \\right]\n$$\n如果 $\\omega_{0, \\text{poly}}^2 > 0$，则多方共振频率为 $f_{\\text{poly}} = \\frac{\\sqrt{\\omega_{0, \\text{poly}}^2}}{2\\pi}$，品质因数为 $Q_{\\text{poly}} = \\frac{\\rho_\\ell R_0^2 \\sqrt{\\omega_{0, \\text{poly}}^2}}{4\\mu}$。\n\n(ii) 等温情况：$\\kappa = 1$。\n固有角频率的平方为：\n$$\n\\omega_{0, \\text{iso}}^2 = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3(1) p_{\\infty 0} + (3(1) - 1)\\frac{2\\sigma}{R_0} \\right] = \\frac{1}{\\rho_\\ell R_0^2} \\left[ 3 p_{\\infty 0} + \\frac{4\\sigma}{R_0} \\right]\n$$\n如果 $\\omega_{0, \\text{iso}}^2 > 0$，则等温共振频率为 $f_{\\text{iso}} = \\frac{\\sqrt{\\omega_{0, \\text{iso}}^2}}{2\\pi}$，品质因数为 $Q_{\\text{iso}} = \\frac{\\rho_\\ell R_0^2 \\sqrt{\\omega_{0, \\text{iso}}^2}}{4\\mu}$。\n\n如果任何情况下的 $\\omega_0^2$ 为非正值，则相应的频率和 Q 因子未定义，并将报告为 `nan`。对于给定的物理参数（$\\rho_\\ell, \\mu, \\sigma, p_{\\infty 0}, R_0 > 0$ 且 $\\kappa \\ge 1$），$k$ 项总是正的，因此 $\\omega_0^2$ 也将是正的。\n\n程序将实现这些公式，为每个测试用例计算 $f_{\\text{poly}}$、$Q_{\\text{poly}}$、$f_{\\text{iso}}$、$Q_{\\text{iso}}$ 以及差值 $\\Delta f = f_{\\text{poly}} - f_{\\text{iso}}$ 和 $\\Delta Q = Q_{\\text{poly}} - Q_{\\mathrm{iso}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the bubble resonance problem for the given test cases.\n    \"\"\"\n    # Test cases as provided in the problem statement.\n    # Each tuple contains: (R0, rho_l, mu, sigma, p_inf0, kappa_g)\n    test_cases = [\n        # Case A (happy path, moderate bubble)\n        (10e-6, 998, 1.0e-3, 0.072, 101325, 1.4),\n        # Case B (higher resonance, smaller bubble)\n        (2e-6, 998, 1.0e-3, 0.072, 101325, 1.4),\n        # Case C (surface-tension-influenced, very small bubble)\n        (2e-7, 998, 1.0e-3, 0.072, 101325, 1.4),\n    ]\n\n    def calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, kappa):\n        \"\"\"\n        Calculates resonance frequency (Hz) and Quality factor for a bubble.\n\n        Args:\n            R0 (float): Equilibrium radius in meters.\n            rho_l (float): Liquid density in kg/m^3.\n            mu (float): Liquid dynamic viscosity in Pa*s.\n            sigma (float): Surface tension in N/m.\n            p_inf0 (float): Ambient static pressure in Pa.\n            kappa (float): Polytropic exponent.\n\n        Returns:\n            tuple[float, float]: A tuple containing the resonance frequency (f0)\n                                 and the Quality factor (Q). Returns (nan, nan)\n                                 if resonance frequency is not real.\n        \"\"\"\n        # Numerator of the omega_0^2 expression, related to the effective spring constant k\n        # k = 3*kappa*p_inf0 + (3*kappa - 1) * 2*sigma/R0\n        k_numerator = 3 * kappa * p_inf0 + (3 * kappa - 1) * (2 * sigma / R0)\n\n        # Denominator of the omega_0^2 expression, related to the effective mass m\n        # m = rho_l * R0^2\n        m_denominator = rho_l * R0**2\n        \n        if k_numerator = 0 or m_denominator == 0:\n            return np.nan, np.nan\n\n        # Squared natural angular frequency (rad/s)^2\n        omega0_sq = k_numerator / m_denominator\n\n        # Natural angular frequency in rad/s\n        omega0 = np.sqrt(omega0_sq)\n\n        # Natural frequency in Hz\n        f0 = omega0 / (2 * np.pi)\n\n        # Quality factor Q = m * omega0 / c, where m = rho_l * R0^2 and c = 4 * mu\n        Q = (rho_l * R0**2 * omega0) / (4 * mu)\n        \n        return f0, Q\n\n    results = []\n    for case in test_cases:\n        R0, rho_l, mu, sigma, p_inf0, kappa_g = case\n\n        # (i) Polytropic case\n        f_poly, Q_poly = calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, kappa_g)\n\n        # (ii) Isothermal case\n        f_iso, Q_iso = calculate_resonance_properties(R0, rho_l, mu, sigma, p_inf0, 1.0)\n        \n        # Calculate differences\n        if np.isnan(f_poly) or np.isnan(f_iso):\n            delta_f = np.nan\n        else:\n            delta_f = f_poly - f_iso\n            \n        if np.isnan(Q_poly) or np.isnan(Q_iso):\n            delta_Q = np.nan\n        else:\n            delta_Q = Q_poly - Q_iso\n\n        case_results = [f_poly, Q_poly, f_iso, Q_iso, delta_f, delta_Q]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    # Using map(str, ...) and join is robust for formatting the final string.\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n\n```"
        },
        {
            "introduction": "除了简单的线性振荡，气泡在实际声场中还表现出复杂的非线性行为，包括在声辐射力作用下的平移运动。这项高级实践要求您模拟靠近刚性边界的气泡在主比耶克尼斯力驱动下的耦合径向和平动动力学。成功地对此场景进行建模，包括撞击壁面的可能性，能够让您深入理解控制气泡操控和空化侵蚀的复杂相互作用。",
            "id": "4117935",
            "problem": "一个初始半径为 $R_0$ 的球形气泡，在密度为 $\\rho_\\ell$、动力粘度为 $\\mu$、表面张力为 $\\sigma$ 的静止牛顿流体中，于 $x=0$ 处的刚性平面壁旁振荡。气泡中心被约束在沿壁面法线坐标 $x(t)0$ 的一维运动上。液体由与刚性壁面相符的一维驻波声场驱动，其声压为 $p_{\\mathrm{ac}}(x,t)=P_A \\cos(k x)\\sin(\\omega t)$，其中 $k=\\omega/c$，$c$ 为水中的声速。由于声场的作用，气泡经历耦合的径向和一维平移动力学过程。您必须通过第一性原理推导和数值模拟，针对一组给定的参数，确定气泡是否会撞击壁面（即，在规定的模拟时域内是否存在某个时刻 $t$ 使得 $x(t)-R(t)\\le 0$），如果会，确定首次撞击发生的时间。\n\n您的模型和算法必须从适用于计算声学和空化动力学的有效基本理论推导得出。从应用于气泡界面的牛顿第二定律出发，分别描述径向运动和包含附加质量效应的平移运动，并使用经过充分检验的本构关系。需使用以下基于物理的模型假设：\n\n- 气泡内的气体压力遵循多方定律 $p_g(R)=p_{g0}\\left(\\dfrac{R_0}{R}\\right)^{3\\gamma}$，其中 $\\gamma$ 是多方指数，$p_{g0}$ 是与 $t=0$ 时机械平衡相符的初始气体压力。\n- 远离气泡的远场液体压力为 $p_\\infty(t)=p_0+p_{\\mathrm{ac}}(x(t),t)$，其中 $p_0$ 是环境静压。\n- 气泡界面的径向动力学遵循不可压缩、无旋液体流动中界面上的法向应力平衡，并包含适用于小马赫数空化的粘性和毛细修正。该动力学过程必须表示为关于 $R(t)$ 的二阶常微分方程。\n- 沿 $x(t)$ 的平移动力学遵循适用于时变附加质量物体的牛顿第二定律。将流体动力附加质量建模为 $m_{\\mathrm{eff}}(t)=C_m \\rho_\\ell V(t)$，其中 $C_m$ 是势流中球体的附加质量系数，$\\rho_\\ell$ 是液体密度，$V(t)=\\dfrac{4}{3}\\pi R^3(t)$ 是瞬时气泡体积。模型应包括适用于小雷诺数的粘性阻力，以及由作用于瞬时气泡体积的声场压力梯度产生的主 Bjerknes 力。\n- 主 Bjerknes 力沿 $x$ 方向定义为 $F_B(t)=-V(t)\\,\\nabla p_{\\mathrm{ac}}(x(t),t)$。使用给定的 $p_{\\mathrm{ac}}(x,t)$ 获得 $F_B(t)$ 作为 $R(t)$、$x(t)$ 和 $t$ 的显式函数。\n- 沿 $x$ 方向采用清洁气泡的 Stokes 阻力 $F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$。\n- 以 $ \\dfrac{d}{dt}\\left(m_{\\mathrm{eff}}(t)\\dot{x}(t)\\right)=F_B(t)-F_D(t)$ 的形式实现平移动力学，以正确考虑 $m_{\\mathrm{eff}}(t)$ 的时间变化。\n\n您必须：\n\n1. 根据所述物理假设，推导状态向量 $[R(t),\\dot{R}(t),x(t),\\dot{x}(t)]$ 的耦合常微分方程组。\n2. 实现一个鲁棒的数值积分器来演化状态，直到达到模拟时域上限 $T_{\\mathrm{end}}$ 或发生撞壁事件 $x(t)-R(t)=0$。撞壁条件必须实现为一个在首次发生时终止积分的事件。\n3. 对于每个测试用例，以浮点数形式报告首次撞击时间（单位为秒）。如果在 $T_{\\mathrm{end}}$ 内没有发生撞击，则报告 $-1.0$。\n\n使用以下常数和单位：$\\rho_\\ell=1000\\,\\mathrm{kg/m^3}$，$\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$，$\\sigma=0.072\\,\\mathrm{N/m}$， $p_0=101325\\,\\mathrm{Pa}$，$c=1480\\,\\mathrm{m/s}$，$C_m=0.5$，以及 $\\gamma=1.4$。初始气体压力必须满足 $t=0$ 时的机械平衡条件 $p_g(R_0) = p_0 + \\dfrac{2\\sigma}{R_0}$。\n\n测试组（每个用例指定 $P_A$（帕斯卡），$f$（赫兹），$R_0$（米），$x_0$（米）和 $T_{\\mathrm{end}}$（秒）；角度通过 $\\sin(\\cdot)$ 和 $\\cos(\\cdot)$ 隐式地以弧度为单位）：\n\n- 用例 1（靠近 Minnaert 共振、中等振幅的一般情况）：$P_A=80000$, $f=300000$, $R_0=8\\times 10^{-6}$, $x_0=6.0\\times 10^{-4}$, $T_{\\mathrm{end}}=1.0\\times 10^{-3}$。\n- 用例 2（高振幅和近距离下的理想撞击情况）：$P_A=150000$, $f=300000$, $R_0=8\\times 10^{-6}$, $x_0=1.0\\times 10^{-4}$, $T_{\\mathrm{end}}=5.0\\times 10^{-4}$。\n- 用例 3（边界条件擦边情况）：$P_A=120000$, $f=330000$, $R_0=1.0\\times 10^{-5}$, $x_0=1.08\\times R_0$, $T_{\\mathrm{end}}=2.0\\times 10^{-4}$。\n- 用例 4（极低振幅的边缘情况）：$P_A=5000$, $f=100000$, $R_0=1.0\\times 10^{-5}$, $x_0=5.0\\times 10^{-5}$, $T_{\\mathrm{end}}=1.0\\times 10^{-3}$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目是按上述顺序对应的用例的撞击时间（单位为秒），使用单位 $\\mathrm{s}$，并遵循惯例，用 $-1.0$ 表示在 $T_{\\mathrm{end}}$ 内未发生撞击。例如：$[t_1,t_2,t_3,t_4]$，其中每个 $t_i$ 是以秒为单位的浮点数。",
            "solution": "已对用户提供的问题进行分析，并确定其有效。以下各节提供了控制方程的完整推导，并描述了为求解这些方程而设计的数值算法。\n\n首先，我们确认问题陈述的有效性。\n该问题具有科学依据，是适定且客观的。它描述了在声场驱动下，单个气泡在刚性壁面附近的耦合径向和一维平移动力学，这是空化动力学领域的一个典型问题。\n给定条件如下：\n- 液体性质：密度 $\\rho_\\ell$、动力粘度 $\\mu$、表面张力 $\\sigma$。\n- 环境条件：静压 $p_0$、声速 $c$。\n- 几何设置：刚性壁面位于 $x=0$，气泡中心位于 $x(t)$。\n- 初始条件：初始半径 $R_0$、初始位置 $x_0$。液体为“静止”状态，意味着初始速度 $\\dot{R}(0)=0$ 和 $\\dot{x}(0)=0$。\n- 声场：$p_{\\mathrm{ac}}(x,t)=P_A \\cos(k x)\\sin(\\omega t)$，其中 $k=\\omega/c$ 且 $\\omega=2\\pi f$。\n- 气体性质：多方行为 $p_g(R)=p_{g0}\\left(R_0/R\\right)^{3\\gamma}$，初始机械平衡为 $p_{g0} = p_0 + 2\\sigma/R_0$。\n- 动力学模型：\n  - 径向运动由从法向应力平衡推导出的关于 $R(t)$ 的二阶常微分方程控制。\n  - 沿 $x(t)$ 的平移运动遵循带时变附加质量的牛顿第二定律：$\\frac{d}{dt}\\left(m_{\\mathrm{eff}}(t)\\dot{x}(t)\\right)=F_B(t)-F_D(t)$。\n  - 附加质量：$m_{\\mathrm{eff}}(t)=C_m \\rho_\\ell V(t)$，其中 $V(t)=\\frac{4}{3}\\pi R^3(t)$。\n  - 主 Bjerknes 力：$F_B(t)=-V(t)\\,\\nabla p_{\\mathrm{ac}}(x(t),t)$。\n  - Stokes 阻力：$F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$。\n- 常数：$\\rho_\\ell=1000\\,\\mathrm{kg/m^3}$，$\\mu=1.0\\times 10^{-3}\\,\\mathrm{Pa\\cdot s}$，$\\sigma=0.072\\,\\mathrm{N/m}$， $p_0=101325\\,\\mathrm{Pa}$，$c=1480\\,\\mathrm{m/s}$，$C_m=0.5$，$\\gamma=1.4$。\n- 任务：对每个测试用例（$P_A, f, R_0, x_0, T_{\\mathrm{end}}$），找出首次撞击时间 $t_{\\mathrm{impact}}$（即 $x(t)-R(t) \\le 0$ 的时刻），若在 $T_{\\mathrm{end}}$ 前未发生撞击则报告 $-1.0$。\n\n该问题不违反任何科学原理。所规定的模型（用于径向动力学的 Rayleigh-Plesset 方程、用于平移运动的 Bjerknes 力和附加质量形式）是标准的，并且适用于此物理体系。该设置是自洽的，并且可以在数学上形式化为一个具有明确初始条件的常微分方程组（ODEs）。因此，该问题被视为有效，并推导求解。\n\n系统在任意时刻 $t$ 的状态可以用状态向量 $Y(t) = [R(t), \\dot{R}(t), x(t), \\dot{x}(t)]^T$ 来描述。为求解此状态的演化，我们构建一个由四个耦合的一阶常微分方程组成的方程组 $\\dot{Y} = f(t, Y)$。令 $y_1=R$, $y_2=\\dot{R}$, $y_3=x$, $y_4=\\dot{x}$。该方程组为：\n$$\n\\begin{cases}\n\\dot{y_1} = y_2 \\\\\n\\dot{y_2} = \\ddot{R}(t) \\\\\n\\dot{y_3} = y_4 \\\\\n\\dot{y_4} = \\ddot{x}(t)\n\\end{cases}\n$$\n我们现在必须根据问题中概述的物理原理，推导二阶导数 $\\ddot{R}$ 和 $\\ddot{x}$ 的表达式。\n\n径向动力学由 Rayleigh-Plesset 方程控制，该方程源于球坐标系下不可压缩流体的动量方程，并结合了气泡界面处的法向应力平衡。该方程为：\n$$ R\\ddot{R} + \\frac{3}{2}\\dot{R}^2 = \\frac{1}{\\rho_\\ell} \\left( p_B(t) - p_\\infty(t) \\right) $$\n这里，$p_B(t)$ 是气泡壁处的液体压力，$p_\\infty(t) = p_0 + p_{\\mathrm{ac}}(x(t), t)$ 是远离气泡处的压力。压力 $p_B(t)$ 通过法向应力平衡与内部气体压力 $p_g(t)$、表面张力 $\\sigma$ 和粘性应力相关：\n$$ p_B(t) = p_g(t) - \\frac{2\\sigma}{R} - \\frac{4\\mu\\dot{R}}{R} $$\n将此式代入 Rayleigh-Plesset 方程，并使用 $p_g$ 和 $p_\\infty$ 的给定表达式，可得：\n$$ R\\ddot{R} + \\frac{3}{2}\\dot{R}^2 = \\frac{1}{\\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{R}\\right)^{3\\gamma} - \\frac{2\\sigma}{R} - \\frac{4\\mu\\dot{R}}{R} - p_0 - P_A \\cos(k x) \\sin(\\omega t) \\right) $$\n求解 $\\ddot{R}$，我们得到方程组中的第二个常微分方程：\n$$ \\ddot{R} = \\frac{1}{R\\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{R}\\right)^{3\\gamma} - \\frac{2\\sigma}{R} - p_0 - P_A \\cos(k x) \\sin(\\omega t) \\right) - \\frac{4\\mu\\dot{R}}{\\rho_\\ell R^2} - \\frac{3\\dot{R}^2}{2R} $$\n\n平移动力学由适用于时变质量物体的牛顿第二定律控制，写作 $\\frac{d}{dt}(m_{\\mathrm{eff}}\\dot{x}) = F_{\\mathrm{net}}$。展开导数并求解加速度 $\\ddot{x}$ 可得：\n$$ \\ddot{x} = \\frac{1}{m_{\\mathrm{eff}}} \\left( F_{\\mathrm{net}} - \\dot{m}_{\\mathrm{eff}}\\dot{x} \\right) $$\n净外力是主 Bjerknes 力 $F_B$ 和阻力之和。问题将方程定义为 $F_B - F_D$，其中 $F_D(t)=6\\pi \\mu R(t) \\,\\dot{x}(t)$ 是 Stokes 阻力。这意味着阻力分量是 $-F_D$。Bjerknes 力是 $F_B(t) = -V(t) \\nabla p_{\\mathrm{ac}}$。$x$ 方向的压力梯度是 $\\frac{\\partial p_{\\mathrm{ac}}}{\\partial x} = -k P_A \\sin(kx) \\sin(\\omega t)$。因此：\n$$ F_B(t) = - \\left(\\frac{4}{3}\\pi R^3\\right) \\left(-k P_A \\sin(kx) \\sin(\\omega t)\\right) = \\frac{4}{3}\\pi R^3 k P_A \\sin(kx) \\sin(\\omega t) $$\n有效附加质量为 $m_{\\mathrm{eff}}(t) = C_m \\rho_\\ell V(t) = C_m \\rho_\\ell \\frac{4}{3}\\pi R^3$。其时间导数为 $\\dot{m}_{\\mathrm{eff}}(t) = C_m \\rho_\\ell (4\\pi R^2 \\dot{R})$。\n将这些代入 $\\ddot{x}$ 的方程中：\n$$ \\ddot{x} = \\frac{F_B - F_D}{m_{\\mathrm{eff}}} - \\frac{\\dot{m}_{\\mathrm{eff}}}{m_{\\mathrm{eff}}}\\dot{x} = \\frac{\\frac{4}{3}\\pi R^3 k P_A \\sin(kx) \\sin(\\omega t) - 6\\pi \\mu R \\dot{x}}{C_m \\rho_\\ell \\frac{4}{3}\\pi R^3} - \\frac{C_m \\rho_\\ell 4\\pi R^2 \\dot{R}}{C_m \\rho_\\ell \\frac{4}{3}\\pi R^3}\\dot{x} $$\n简化此表达式可得到我们方程组中的第四个常微分方程：\n$$ \\ddot{x} = \\frac{k P_A \\sin(kx) \\sin(\\omega t)}{C_m \\rho_\\ell} - \\frac{9\\mu}{2C_m \\rho_\\ell R^2}\\dot{x} - \\frac{3\\dot{R}}{R}\\dot{x} $$\n\n完整的一阶常微分方程组为：\n$$\n\\begin{align*}\n\\dot{y_1} = y_2 \\\\\n\\dot{y_2} = \\frac{1}{y_1 \\rho_\\ell} \\left( \\left(p_0 + \\frac{2\\sigma}{R_0}\\right)\\left(\\frac{R_0}{y_1}\\right)^{3\\gamma} - \\frac{2\\sigma}{y_1} - p_0 - P_A \\cos(k y_3) \\sin(\\omega t) \\right) - \\frac{4\\mu y_2}{\\rho_\\ell y_1^2} - \\frac{3y_2^2}{2y_1} \\\\\n\\dot{y_3} = y_4 \\\\\n\\dot{y_4} = \\frac{k P_A \\sin(k y_3) \\sin(\\omega t)}{C_m \\rho_\\ell} - \\left( \\frac{9\\mu}{2C_m \\rho_\\ell y_1^2} + \\frac{3y_2}{y_1} \\right) y_4\n\\end{align*}\n$$\n对应于静止气泡的初始条件为 $Y_0 = [R_0, 0, x_0, 0]^T$。\n\n为求解此初值问题，我们采用数值常微分方程求解器。SciPy 库中的 `scipy.integrate.solve_ivp` 函数是一个合适的选择，它提供了鲁棒的自适应步长 Runge-Kutta 方法。每个测试用例的模拟从 $t=0$ 运行到 $t=T_{\\mathrm{end}}$。\n一个关键要求是检测与壁面撞击的时刻。撞击条件是 $x(t) - R(t) \\le 0$。我们将其实现为常微分方程求解器的一个终止事件。我们定义一个事件函数 $g(t,Y) = y_3(t) - y_1(t)$。求解器被指示寻找该函数的根（即当 $g(t,Y)=0$ 时），并在首次发生时终止积分。由于气泡起始时满足 $x_0  R_0$，事件函数初始为正，我们寻找一个负向的零点穿越。\n算法流程如下：对于每个测试用例，我们设置所有物理参数和初始条件。然后，我们使用常微分方程组、时间区间 $[0, T_{\\mathrm{end}}]$、初始状态向量和撞壁事件函数来调用 `solve_ivp`。如果求解器检测到事件，相应的时间被记录为撞击时间。如果积分完成至 $T_{\\mathrm{end}}$ 仍未发生任何事件，则表示没有撞击，结果记录为 $-1.0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and solves the coupled equations for bubble radius and translation\n    to determine the wall impact time.\n    \"\"\"\n\n    # --- Constants and Units ---\n    # All values are in SI units.\n    RHO_L = 1000.0  # kg/m^3\n    MU = 1.0e-3    # Pa*s\n    SIGMA = 0.072   # N/m\n    P0 = 101325.0  # Pa\n    C = 1480.0     # m/s\n    C_M = 0.5      # Added-mass coefficient (dimensionless)\n    GAMMA = 1.4    # Polytropic exponent (dimensionless)\n\n    # --- Test Cases ---\n    # Each case: (P_A [Pa], f [Hz], R_0 [m], x_0 [m], T_end [s])\n    test_cases = [\n        (80000.0, 300000.0, 8.0e-6, 6.0e-4, 1.0e-3),\n        (150000.0, 300000.0, 8.0e-6, 1.0e-4, 5.0e-4),\n        (120000.0, 330000.0, 1.0e-5, 1.08 * 1.0e-5, 2.0e-4),\n        (5000.0, 100000.0, 1.0e-5, 5.0e-5, 1.0e-3),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        P_A, f, R0, x0, T_end = case\n        \n        # --- Derived Parameters ---\n        omega = 2.0 * np.pi * f\n        k = omega / C\n        pg0 = P0 + 2.0 * SIGMA / R0\n\n        # --- Pack parameters for the solver ---\n        params = (RHO_L, MU, SIGMA, P0, C_M, GAMMA, P_A, omega, k, R0, pg0)\n\n        def ode_system(t, y, params):\n            \"\"\"\n            Defines the coupled system of 4 first-order ODEs.\n            y = [R, R_dot, x, x_dot]\n            \"\"\"\n            R, R_dot, x, x_dot = y\n            rho_l, mu, sigma, p0, c_m, gamma, pa, w, k_wave, r0, pg_0 = params\n            \n            # Defensive check for non-physical radius\n            if R = 0:\n                return [0, 0, 0, 0]\n\n            # --- Radial Dynamics (Rayleigh-Plesset) ---\n            # y_dot[1] = R_ddot\n            p_acoustic = pa * np.cos(k_wave * x) * np.sin(w * t)\n            \n            pressure_term = (pg_0 * (r0 / R)**(3.0 * gamma) -\n                             2.0 * sigma / R -\n                             4.0 * mu * R_dot / R -\n                             p0 - p_acoustic)\n            \n            R_ddot = (pressure_term / rho_l - 1.5 * R_dot**2) / R\n            \n            # --- Translational Dynamics ---\n            # y_dot[3] = x_ddot\n            bjerknes_term = (k_wave * pa * np.sin(k_wave * x) * np.sin(w * t)) / (c_m * rho_l)\n            drag_term = (9.0 * mu) / (2.0 * c_m * rho_l * R**2) * x_dot\n            added_mass_change_term = (3.0 * R_dot / R) * x_dot\n            \n            x_ddot = bjerknes_term - drag_term - added_mass_change_term\n\n            return [R_dot, R_ddot, x_dot, x_ddot]\n\n        def wall_impact(t, y, params):\n            \"\"\"\n            Event function to detect wall impact: x(t) - R(t) = 0.\n            \"\"\"\n            return y[2] - y[0]\n        \n        wall_impact.terminal = True  # Stop integration at impact\n        wall_impact.direction = -1   # Trigger when going from positive to negative\n\n        # --- Initial Conditions ---\n        y0 = [R0, 0.0, x0, 0.0]  # [R(0), R_dot(0), x(0), x_dot(0)]\n\n        # --- Solve the ODE System ---\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[0, T_end],\n            y0=y0,\n            method='RK45',  # Standard robust solver\n            args=(params,),\n            events=wall_impact,\n            dense_output=True,\n            rtol=1e-8,\n            atol=1e-12\n        )\n\n        # --- Process Results ---\n        if sol.t_events[0].size > 0:\n            impact_time = sol.t_events[0][0]\n            results.append(impact_time)\n        else:\n            results.append(-1.0)\n            \n    # --- Final Output Formatting ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}