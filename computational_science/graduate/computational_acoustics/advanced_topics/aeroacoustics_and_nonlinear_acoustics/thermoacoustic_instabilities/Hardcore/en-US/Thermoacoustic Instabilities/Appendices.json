{
    "hands_on_practices": [
        {
            "introduction": "Thermoacoustic instabilities are fundamentally driven by a closed feedback loop between unsteady heat release and the acoustic field. This practice delves into the core of this mechanism by analyzing a simplified, yet powerful, time-delay model . By applying the Nyquist stability criterion, a cornerstone of control theory, you will determine the critical gain and phase conditions that trigger self-excited oscillations, providing a foundational understanding of linear thermoacoustic instability.",
            "id": "4146189",
            "problem": "A straight, uniform duct of length $L$ at low mean Mach number contains a compact heat source (flame) located at $x=x_{f}$. The thermoacoustic feedback between unsteady pressure and unsteady heat release is modeled by a two-parameter, time-delay plus gain relation in the frequency domain, $G(\\omega)=\\alpha \\exp(-i \\omega \\tau)$, where $p^{\\prime}(t)$ is the acoustic pressure fluctuation and $q^{\\prime}(t)$ is the unsteady heat-release fluctuation, with the input-output relation $q^{\\prime}(t)=\\int_{-\\infty}^{\\infty} g(\\theta) p^{\\prime}(t-\\theta)\\, \\mathrm{d}\\theta$ and Fourier transform $G(\\omega)$. The parameters $\\alpha$ and $\\tau$ are the real gain and time delay, respectively. Assume all fields are nondimensionalized so that $\\alpha$ is dimensionless.\n\nTo isolate the essential loop physics, approximate the linear acoustic plant mapping the compact heat-release source to the local pressure at $x=x_{f}$ by a stable, scalar, Linear Time-Invariant (LTI) transfer function $R(\\omega)$ that is dominated by a single, weakly damped, round-trip propagation. Specifically, assume $R(\\omega)=\\beta \\exp(-i \\omega T)$ with real $\\beta \\in (0,1)$ and a positive time-of-flight $T0$. This model represents a single-pass acoustic gain $\\beta$ and a pure propagation delay $T$ for the pressure feedback to the flame.\n\nStarting from the linearized conservation laws for acoustics, the definition of the convolutional input-output relation, and the Fourier transform, set up the closed-loop condition for self-excited thermoacoustic oscillations as a consistency condition between $p^{\\prime}$ and $q^{\\prime}$. Use this to: \n- Identify and justify the causality constraints on $\\tau$ and on the admissible form of $\\alpha$ in this model.\n- Using the Nyquist stability argument for the loop transfer function, determine the exact marginal-stability gain magnitude $\\alpha_{\\mathrm{crit}}$ in closed form as a function of $\\beta$ only, such that for some frequency $\\omega$ the system is exactly neutrally stable. You may assume that the model $G(\\omega)=\\alpha \\exp(-i \\omega \\tau)$ concentrates all non-propagation phase in the time delay $\\tau$, so that $\\alpha$ is real and nonnegative.\n\nExpress your final answer as a single closed-form analytic expression for $\\alpha_{\\mathrm{crit}}$. No numerical rounding is required.",
            "solution": "The problem asks for an analysis of a thermoacoustic feedback loop, including justification of causality constraints and the derivation of the marginal-stability gain using the Nyquist criterion. The system consists of a heat source (flame) and an acoustic plant, modeled as a closed-loop system.\n\nFirst, we establish the characteristic equation for self-excited oscillations. The system is described by two coupled relationships in the frequency domain. The flame's response, which relates the unsteady heat release rate $\\hat{q}(\\omega)$ to the acoustic pressure fluctuation $\\hat{p}(\\omega)$ at the flame location, is given by the transfer function $G(\\omega)$:\n$$\n\\hat{q}(\\omega) = G(\\omega) \\hat{p}(\\omega)\n$$\nThe acoustic plant's response, which maps the heat release rate $\\hat{q}(\\omega)$ back to the pressure fluctuation $\\hat{p}(\\omega)$ at the same location, is given by the transfer function $R(\\omega)$:\n$$\n\\hat{p}(\\omega) = R(\\omega) \\hat{q}(\\omega)\n$$\nFor a feedback loop, these two equations must hold simultaneously. Substituting the first equation into the second yields:\n$$\n\\hat{p}(\\omega) = R(\\omega) G(\\omega) \\hat{p}(\\omega)\n$$\nThis can be rearranged into a homogeneous equation:\n$$\n(1 - R(\\omega) G(\\omega)) \\hat{p}(\\omega) = 0\n$$\nSelf-excited oscillations are non-trivial solutions to this system, meaning $\\hat{p}(\\omega) \\neq 0$. This requires the coefficient of $\\hat{p}(\\omega)$ to be zero. Thus, the characteristic equation for the closed-loop system is:\n$$\n1 - L(\\omega) = 0 \\quad \\text{where} \\quad L(\\omega) = R(\\omega) G(\\omega)\n$$\nHere, $L(\\omega)$ is the open-loop transfer function.\n\nNext, we address the causality constraints on the parameters of the flame model $G(\\omega) = \\alpha \\exp(-i \\omega \\tau)$. The input-output relation in the time domain is given as a convolution:\n$$\nq^{\\prime}(t) = \\int_{-\\infty}^{\\infty} g(\\theta) p^{\\prime}(t-\\theta) \\, \\mathrm{d}\\theta\n$$\nwhere $g(t)$ is the impulse response function, whose Fourier transform is $G(\\omega)$. For this system to be causal, the output $q^{\\prime}(t)$ at time $t$ can only depend on the input $p^{\\prime}(s)$ at times $s \\le t$. In the integral, the input is evaluated at time $t-\\theta$. Causality thus requires that the integral only includes contributions from past or present inputs, which means $t-\\theta \\le t$, or $\\theta \\ge 0$. Therefore, the impulse response function $g(\\theta)$ must be zero for all negative arguments: $g(\\theta) = 0$ for $\\theta  0$.\n\nThe inverse Fourier transform of $G(\\omega) = \\alpha \\exp(-i \\omega \\tau)$ gives the impulse response:\n$$\ng(t) = \\mathcal{F}^{-1}\\{G(\\omega)\\} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\alpha \\exp(-i \\omega \\tau) \\exp(i \\omega t) \\, \\mathrm{d}\\omega = \\alpha \\left( \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\exp(i \\omega (t-\\tau)) \\, \\mathrm{d}\\omega \\right)\n$$\nThe term in parentheses is the definition of the Dirac delta function, $\\delta(t-\\tau)$. So, $g(t) = \\alpha \\delta(t-\\tau)$.\nThe delta function is non-zero only at $t=\\tau$. For $g(t)$ to satisfy the causality condition $g(t)=0$ for $t0$, its non-zero point must be at a non-negative time. This imposes the constraint $\\tau \\ge 0$. A negative time delay would imply a non-causal system where the flame responds to pressure fluctuations before they occur.\n\nThe problem states to assume $\\alpha$ is real and non-negative. This is a common and physically meaningful assumption. The parameter $\\alpha$ represents a gain. For a combustion process, a positive pressure fluctuation often leads to an enhanced reaction rate and thus an increased heat release rate (after some delay $\\tau$). A positive $\\alpha$ models this direct relationship. A negative $\\alpha$ would imply an inverse relationship (e.g., a process where increased pressure suppresses heat release), which is less typical for simple flame models. The assumption $\\alpha \\ge 0$ ensures that the flame acts as a source of energy that can potentially drive oscillations, rather than damp them.\n\nNow, we determine the marginal-stability gain $\\alpha_{\\mathrm{crit}}$. Marginal, or neutral, stability occurs when the system can sustain an oscillation at a constant amplitude. In the context of the Nyquist stability criterion for an open-loop stable system (which $L(\\omega)$ is), this corresponds to the locus of $L(\\omega)$ passing through the critical point $(1, 0)$ in the complex plane for some real frequency $\\omega > 0$. This is equivalent to solving the characteristic equation $L(\\omega) = 1$.\n\nWe substitute the given expressions for $G(\\omega)$ and $R(\\omega)$:\n$$\nL(\\omega) = G(\\omega) R(\\omega) = (\\alpha \\exp(-i \\omega \\tau)) (\\beta \\exp(-i \\omega T)) = \\alpha \\beta \\exp(-i \\omega (T + \\tau))\n$$\nThe marginal stability condition is $L(\\omega) = 1$:\n$$\n\\alpha \\beta \\exp(-i \\omega (T + \\tau)) = 1\n$$\nFor this complex equation to hold, both the magnitude and the phase of the left side must match the right side. The magnitude of $1$ is $1$ and its phase is $2k\\pi$ for any integer $k$.\n\n1.  **Magnitude Condition:**\n    $$\n    |\\alpha \\beta \\exp(-i \\omega (T + \\tau))| = 1\n    $$\n    Given that $\\alpha \\ge 0$ and $\\beta \\in (0,1)$ are real and positive, and $|\\exp(-i \\phi)| = 1$ for any real $\\phi$, the condition simplifies to:\n    $$\n    \\alpha \\beta = 1\n    $$\n    This gives the critical gain $\\alpha_{\\mathrm{crit}}$ at which the loop gain magnitude is unity. For any $\\alpha  1/\\beta$, the loop gain is less than $1$, and perturbations will die out. For $\\alpha > 1/\\beta$, the loop gain is greater than $1$, and perturbations can grow. The marginal case is exact equality.\n    $$\n    \\alpha_{\\mathrm{crit}} = \\frac{1}{\\beta}\n    $$\n    This expression depends only on $\\beta$, as required.\n\n2.  **Phase Condition:**\n    The phase of the loop transfer function must match the phase of $1$, which is $0$ (modulo $2\\pi$).\n    $$\n    \\arg(\\alpha \\beta \\exp(-i \\omega (T + \\tau))) = 2k\\pi, \\quad k \\in \\mathbb{Z}\n    $$\n    Since $\\alpha$ and $\\beta$ are positive real numbers, their phase is $0$. The phase of the expression is determined by the exponential term:\n    $$\n    -\\omega (T + \\tau) = 2k\\pi\n    $$\n    We are interested in physical oscillations, for which $\\omega > 0$. The problem specifies $T > 0$ and we deduced $\\tau \\ge 0$, so $(T+\\tau) > 0$. This means the left-hand side, $-\\omega(T+\\tau)$, must be negative. Therefore, we must choose negative integers for $k$. Let $k = -n$, where $n$ is a positive integer ($n=1, 2, 3, ...$).\n    $$\n    \\omega (T + \\tau) = 2n\\pi\n    $$\n    This condition gives the possible frequencies of oscillation:\n    $$\n    \\omega_n = \\frac{2n\\pi}{T + \\tau}, \\quad n = 1, 2, 3, \\dots\n    $$\n    Since $T + \\tau$ is a positive, finite value, there always exists a set of positive frequencies $\\omega_n$ that satisfy the phase condition for constructive interference.\n\nThe problem asks for the gain $\\alpha_{\\mathrm{crit}}$ such that for *some* frequency $\\omega$, the system is neutrally stable. We have found that the gain condition $\\alpha = 1/\\beta$ is independent of frequency, and that there always exist frequencies $\\omega_n$ that satisfy the phase condition. Therefore, the critical gain required for marginal stability is determined solely by the magnitude condition.",
            "answer": "$$\\boxed{\\frac{1}{\\beta}}$$"
        },
        {
            "introduction": "While linear models like the one in our first practice  can predict the onset of instability, they cannot describe the finite, often large, amplitude oscillations observed in reality. This exercise introduces the crucial concept of nonlinear saturation, where amplitude-dependent damping mechanisms limit exponential growth and lead to a stable limit-cycle oscillation. Using the method of averaging, a powerful asymptotic technique, you will analyze a canonical nonlinear oscillator to predict the final amplitude of the self-sustained oscillations .",
            "id": "4146162",
            "problem": "Consider a one-dimensional thermoacoustic resonator whose dominant acoustic mode can be reduced, via single-mode Galerkin projection of the linearized compressible Navier–Stokes equations and conservation of energy, to a weakly nonlinear oscillator for a generalized displacement coordinate $\\xi(t)$. Let the perturbation acoustic velocity at the antinode be $u'(t) = \\dot{\\xi}(t)$. The conservative part of the dynamics is characterized by a natural angular frequency $\\omega_0  0$. A compact heat-release feedback provides net linear thermoacoustic gain that can be modeled as an effective negative damping of magnitude $\\sigma  0$, while acoustic dissipation comprises linear and nonlinear losses modeled by coefficients $C_1  0$ and $C_3  0$, respectively. Under the assumption that the net growth and losses are weak compared to the conservative dynamics, the slow-time dynamics is captured by\n$$\n\\ddot{\\xi} + \\omega_0^2 \\xi \\;=\\; \\varepsilon \\Big[ (\\sigma - C_1)\\,\\dot{\\xi} \\;-\\; C_3\\,\\dot{\\xi}^3 \\Big],\n$$\nwith $0  \\varepsilon \\ll 1$. Assume $(\\sigma - C_1)  0$ so that a self-excited limit cycle exists. Starting only from conservation of linear acoustic energy for the conservative oscillator, namely $E(t) = \\tfrac{1}{2}\\big(\\dot{\\xi}^2 + \\omega_0^2 \\xi^2\\big)$, and using asymptotic averaging justified by time-scale separation, derive the leading-order limit-cycle amplitude of the perturbation acoustic velocity, $U_{\\mathrm{LC}}$, and the leading-order frequency shift relative to $\\omega_0$, denoted $\\Delta \\omega$, that arise solely from the nonlinear acoustic loss $C_3\\,\\dot{\\xi}^3$ in the presence of the net linear growth $(\\sigma - C_1)$. Express $U_{\\mathrm{LC}}$ in meters per second and $\\Delta \\omega$ in radians per second. Provide your final result as a single row vector $\\big(U_{\\mathrm{LC}}, \\Delta \\omega\\big)$ in closed form in terms of $\\sigma$, $C_1$, $C_3$, and $\\omega_0$. No numerical rounding is required, and you must not include units in the final boxed answer.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It describes a canonical model in nonlinear dynamics—a Rayleigh-type oscillator—which is a standard representation for self-excited oscillations in thermoacoustic systems. All parameters and objectives are clearly defined, and the methodology of asymptotic averaging is appropriate for the given equation under the condition $0  \\varepsilon \\ll 1$. The problem is therefore valid and a solution can be formulated.\n\nThe governing equation for the generalized displacement coordinate $\\xi(t)$ is given by\n$$\n\\ddot{\\xi} + \\omega_0^2 \\xi \\;=\\; \\varepsilon \\Big[ (\\sigma - C_1)\\,\\dot{\\xi} \\;-\\; C_3\\,\\dot{\\xi}^3 \\Big]\n$$\nwhere $0  \\varepsilon \\ll 1$ is a small parameter indicating that the terms on the right-hand side are weak. This justifies the use of time-scale separation methods, such as asymptotic averaging. The condition $(\\sigma - C_1)  0$ ensures the system has a net linear instability, which is balanced by the nonlinear damping term $-C_3\\dot{\\xi}^3$ (with $C_3  0$), leading to a stable limit-cycle oscillation.\n\nWe seek a solution of the form\n$$\n\\xi(t) = A(t) \\cos(\\omega_0 t + \\phi(t))\n$$\nwhere $A(t)$ is the slowly varying amplitude and $\\phi(t)$ is the slowly varying phase. Because the variations are slow, we have $\\dot{A} \\sim \\mathcal{O}(\\varepsilon)$ and $\\dot{\\phi} \\sim \\mathcal{O}(\\varepsilon)$.\nThe velocity is then given by $\\dot{\\xi}(t) = -A(t)\\omega_0 \\sin(\\omega_0 t + \\phi(t)) + \\mathcal{O}(\\varepsilon)$. To leading order, the acoustic velocity perturbation is $u'(t) = \\dot{\\xi}(t) \\approx -A\\omega_0 \\sin(\\omega_0 t + \\phi)$, and its amplitude is $U = A \\omega_0$.\n\nWe will first derive the limit-cycle amplitude, $U_{\\mathrm{LC}}$, by considering the evolution of the system's energy, as suggested. The energy of the unperturbed, conservative oscillator ($\\varepsilon=0$) is\n$$\nE(t) = \\frac{1}{2}\\big(\\dot{\\xi}^2 + \\omega_0^2 \\xi^2\\big)\n$$\nThe rate of change of energy is\n$$\n\\frac{dE}{dt} = \\dot{\\xi}\\ddot{\\xi} + \\omega_0^2 \\xi \\dot{\\xi} = \\dot{\\xi} (\\ddot{\\xi} + \\omega_0^2 \\xi)\n$$\nSubstituting the governing differential equation, we find that the energy changes due to the weak perturbation terms:\n$$\n\\frac{dE}{dt} = \\dot{\\xi} \\cdot \\varepsilon \\Big[ (\\sigma - C_1)\\,\\dot{\\xi} \\;-\\; C_3\\,\\dot{\\xi}^3 \\Big] = \\varepsilon \\Big[ (\\sigma - C_1)\\,\\dot{\\xi}^2 \\;-\\; C_3\\,\\dot{\\xi}^4 \\Big]\n$$\nThe method of averaging posits that the slow evolution of energy (or amplitude) is given by the average of its rate of change over one period of a fast oscillation, $T_0 = 2\\pi/\\omega_0$.\n$$\n\\Big\\langle \\frac{dE}{dt} \\Big\\rangle = \\frac{1}{T_0} \\int_0^{T_0} \\varepsilon \\Big[ (\\sigma - C_1)\\,\\dot{\\xi}^2 \\;-\\; C_3\\,\\dot{\\xi}^4 \\Big] dt\n$$\nWe substitute the leading-order solution $\\dot{\\xi}(t) \\approx -A\\omega_0 \\sin(\\omega_0 t + \\phi_0)$, where $A$ and $\\phi_0$ are treated as constant over the single-period integration:\n$$\n\\Big\\langle \\frac{dE}{dt} \\Big\\rangle = \\varepsilon \\Big[ (\\sigma - C_1) A^2 \\omega_0^2 \\langle\\sin^2(\\theta)\\rangle - C_3 A^4 \\omega_0^4 \\langle\\sin^4(\\theta)\\rangle \\Big]\n$$\nwhere $\\theta = \\omega_0 t + \\phi_0$. The required time averages over one period are:\n$$\n\\langle\\sin^2(\\theta)\\rangle = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\sin^2(\\theta) d\\theta = \\frac{1}{2}\n$$\n$$\n\\langle\\sin^4(\\theta)\\rangle = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\left(\\frac{1-\\cos(2\\theta)}{2}\\right)^2 d\\theta = \\frac{1}{8\\pi} \\int_0^{2\\pi} (1 - 2\\cos(2\\theta) + \\cos^2(2\\theta)) d\\theta = \\frac{1}{8\\pi} \\int_0^{2\\pi} \\left(\\frac{3}{2} - 2\\cos(2\\theta) + \\frac{1}{2}\\cos(4\\theta)\\right) d\\theta = \\frac{3}{8}\n$$\nSubstituting these averages gives the slow-time evolution of energy:\n$$\n\\frac{dE_{slow}}{dt} = \\varepsilon \\Big[ (\\sigma - C_1) A^2 \\omega_0^2 \\frac{1}{2} - C_3 A^4 \\omega_0^4 \\frac{3}{8} \\Big]\n$$\nThe energy is related to the amplitude by $E = \\frac{1}{2}A^2\\omega_0^2$. Differentiating with respect to the slow time gives $\\frac{dE_{slow}}{dt} = A\\dot{A}\\omega_0^2$. Equating the two expressions for the energy evolution rate:\n$$\nA\\dot{A}\\omega_0^2 = \\varepsilon \\Big[ \\frac{1}{2}(\\sigma - C_1) A^2 \\omega_0^2 - \\frac{3}{8} C_3 A^4 \\omega_0^4 \\Big]\n$$\nFor a non-trivial solution ($A \\neq 0$), we can divide by $A\\omega_0^2$ to find the amplitude evolution equation:\n$$\n\\dot{A} = \\varepsilon \\Big[ \\frac{1}{2}(\\sigma - C_1) A - \\frac{3}{8} C_3 \\omega_0^2 A^3 \\Big]\n$$\nThe limit cycle is a fixed point of this slow-flow equation, where the amplitude is constant ($\\dot{A}=0$). The limit-cycle amplitude $A_{\\mathrm{LC}}$ is found by solving:\n$$\n\\frac{1}{2}(\\sigma - C_1) A_{\\mathrm{LC}} = \\frac{3}{8} C_3 \\omega_0^2 A_{\\mathrm{LC}}^3\n$$\nFor $A_{\\mathrm{LC}} \\neq 0$, we have:\n$$\nA_{\\mathrm{LC}}^2 = \\frac{1/2}{3/8} \\frac{\\sigma - C_1}{C_3 \\omega_0^2} = \\frac{4}{3} \\frac{\\sigma - C_1}{C_3 \\omega_0^2}\n$$\nThe problem asks for the amplitude of the perturbation acoustic velocity, $U_{\\mathrm{LC}} = A_{\\mathrm{LC}}\\omega_0$. Squaring this relation gives $U_{\\mathrm{LC}}^2 = A_{\\mathrm{LC}}^2 \\omega_0^2$.\n$$\nU_{\\mathrm{LC}}^2 = \\left( \\frac{4}{3} \\frac{\\sigma - C_1}{C_3 \\omega_0^2} \\right) \\omega_0^2 = \\frac{4(\\sigma - C_1)}{3 C_3}\n$$\nTaking the square root for the positive amplitude yields:\n$$\nU_{\\mathrm{LC}} = \\sqrt{\\frac{4(\\sigma - C_1)}{3 C_3}} = 2 \\sqrt{\\frac{\\sigma - C_1}{3 C_3}}\n$$\n\nNext, we derive the leading-order frequency shift, $\\Delta \\omega$. The energy-based method does not provide information about phase, and thus frequency. We must analyze the phase evolution equation from the method of averaging. The averaged equation for the slow evolution of the phase $\\phi$ is given by:\n$$\n\\langle\\dot{\\phi}\\rangle = -\\frac{\\varepsilon}{A \\omega_0} \\Big\\langle F(\\xi, \\dot{\\xi}) \\cos(\\omega_0 t + \\phi) \\Big\\rangle\n$$\nwhere $F(\\xi, \\dot{\\xi})$ is the perturbation term from the right-hand side of the governing equation. Here, $F = (\\sigma - C_1)\\,\\dot{\\xi} - C_3\\,\\dot{\\xi}^3$.\nTo leading order, we substitute $\\dot{\\xi} \\approx -A\\omega_0\\sin(\\omega_0 t + \\phi)$ into $F$:\n$$\nF \\approx -(\\sigma - C_1)A\\omega_0\\sin(\\omega_0 t + \\phi) - C_3(-A\\omega_0\\sin(\\omega_0 t + \\phi))^3\n$$\n$$\nF \\approx -(\\sigma - C_1)A\\omega_0\\sin(\\psi) + C_3 A^3 \\omega_0^3\\sin^3(\\psi)\n$$\nwhere $\\psi = \\omega_0 t + \\phi$. The integrand for the phase evolution is $F \\cos(\\psi)$:\n$$\nF \\cos(\\psi) \\approx \\left[ -(\\sigma - C_1)A\\omega_0\\sin(\\psi) + C_3 A^3 \\omega_0^3\\sin^3(\\psi) \\right] \\cos(\\psi)\n$$\nWe must average this expression over one period.\n$$\n\\langle F \\cos(\\psi) \\rangle \\approx -(\\sigma - C_1)A\\omega_0\\langle\\sin(\\psi)\\cos(\\psi)\\rangle + C_3 A^3 \\omega_0^3\\langle\\sin^3(\\psi)\\cos(\\psi)\\rangle\n$$\nThe integrals of the trigonometric terms over one period $[0, 2\\pi]$ are:\n$$\n\\int_0^{2\\pi} \\sin(\\psi)\\cos(\\psi) d\\psi = \\frac{1}{2} \\int_0^{2\\pi} \\sin(2\\psi) d\\psi = 0\n$$\n$$\n\\int_0^{2\\pi} \\sin^3(\\psi)\\cos(\\psi) d\\psi = \\left[ \\frac{\\sin^4(\\psi)}{4} \\right]_0^{2\\pi} = 0\n$$\nBoth terms average to zero. This is a general property for a Rayleigh-type oscillator, where the perturbation $F$ is an odd function of $\\dot{\\xi}$. In the Fourier series expansion of $F$ as a function of $\\psi$, all coefficients of the $\\cos(k\\psi)$ terms are zero. The frequency shift at this order is determined by the coefficient of the $\\cos(\\psi)$ term, which is zero.\nTherefore, the averaged rate of change of phase is zero:\n$$\n\\langle\\dot{\\phi}\\rangle = 0\n$$\nThe leading-order frequency shift is defined as $\\Delta \\omega = \\langle\\dot{\\phi}\\rangle$. Thus,\n$$\n\\Delta \\omega = 0\n$$\nThe problem specifies to find the frequency shift arising *solely* from the nonlinear term $C_3 \\dot{\\xi}^3$. As demonstrated, this term, like the linear term, contributes nothing to the first-order frequency shift.\n\nThe final result is the row vector $(U_{\\mathrm{LC}}, \\Delta \\omega)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\sqrt{\\frac{\\sigma - C_1}{3C_3}}  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Analytical solutions provide deep insight but are often restricted to idealized systems. To tackle the complex geometries and physics of real-world combustors, we turn to numerical methods. This practice provides hands-on experience in computational acoustics by guiding you through the implementation of a Finite Element Method (FEM) solver for a coupled thermoacoustic model . You will learn to translate the governing equations into a discrete system and, crucially, verify your code's accuracy using the Method of Manufactured Solutions, a standard and vital skill for any computational scientist.",
            "id": "4146174",
            "problem": "Consider a one-dimensional duct of length $L$, with negligible mean flow and small acoustic perturbations described in the frequency domain. Let $p(x)$ denote the complex-valued amplitude of acoustic pressure and $q(x)$ denote the complex-valued amplitude of heat-release rate per unit volume. The governing coupled equations for thermoacoustic interaction can be modeled, after non-dimensionalization and suitable scaling of parameters, by the following linear system on the interval $x \\in [0,L]$:\n$$\\frac{d^2 p}{dx^2} + k^2 p - s\\, q = f(x),$$\n$$q - \\beta\\, p = 0,$$\nwith Neumann boundary conditions\n$$\\frac{dp}{dx}(0) = 0, \\quad \\frac{dp}{dx}(L) = 0.$$\nHere $k$ is the acoustic wave number, $s$ is a real coupling strength associated with the acoustic response to heat release, and $\\beta$ is a real proportionality coefficient relating heat-release fluctuations to pressure fluctuations. Assume $p$ and $q$ are real-valued for this study.\n\nTo enable verification against an analytical solution, set the exact solution target to\n$$p^\\star(x) = \\cos\\!\\left(\\frac{n\\pi x}{L}\\right), \\qquad q^\\star(x) = \\beta\\, p^\\star(x),$$\nfor a chosen positive integer mode index $n$. Define the forcing term $f(x)$ such that the above pair $(p^\\star,q^\\star)$ satisfies the coupled equations:\n$$f(x) = \\left(k^2 - s\\,\\beta - \\left(\\frac{n\\pi}{L}\\right)^2\\right)\\cos\\!\\left(\\frac{n\\pi x}{L}\\right).$$\n\nYour task is to implement a Finite Element Method (FEM) using Weighted Residuals (WR) with continuous, piecewise-linear basis functions on a uniform mesh of $N$ elements over $[0,L]$ to solve for the discrete approximations $p_h(x)$ and $q_h(x)$. Use the standard Galerkin approach. The weak form is: find $p \\in H^1([0,L])$ and $q \\in L^2([0,L])$ such that for all test functions $v \\in H^1([0,L])$ and $w \\in L^2([0,L])$,\n$$\\int_{0}^{L} \\frac{dp}{dx}\\frac{dv}{dx}\\,dx + k^2 \\int_{0}^{L} p\\, v\\,dx - s \\int_{0}^{L} q\\, v\\,dx = \\int_{0}^{L} f\\, v\\,dx,$$\n$$\\int_{0}^{L} q\\, w\\,dx - \\beta \\int_{0}^{L} p\\, w\\,dx = 0.$$\nThe Neumann boundary conditions are naturally enforced by the weak form.\n\nDiscretize the problem with a uniform mesh and continuous, piecewise-linear basis functions $\\{\\phi_i(x)\\}_{i=0}^{N}$ for both $p$ and $q$, assemble the global block linear system for the nodal coefficients of $p_h$ and $q_h$, and solve it. Compute the discrete $L^2$-norm of the error in $p$ using the finite element mass matrix $M$:\n$$\\|e\\|_{L^2} \\approx \\sqrt{e^\\top M\\, e}, \\quad e = \\mathbf{p}_h - \\mathbf{p}^\\star,$$\nwhere $\\mathbf{p}^\\star$ is the vector of exact nodal values $p^\\star(x_i)$ at the mesh nodes $\\{x_i\\}_{i=0}^{N}$.\n\nEstimate the empirical convergence rate by fitting a line to the data $\\{(\\ln(h), \\ln(\\|e\\|_{L^2}))\\}$, where $h = L/N$ is the element size for each mesh, and report the slope as the estimated order. The expected rate for the $L^2$-norm with continuous, piecewise-linear elements on sufficiently smooth solutions is approximately $2$.\n\nImplement your program to run the following test suite of parameter sets, each solved on meshes with $N \\in \\{20, 40, 80, 160\\}$:\n- Test case $1$ (happy path): $L = 1$, $k = 7$, $n = 2$, $s = 0.5$, $\\beta = 0.2$.\n- Test case $2$ (near-cancellation): $L = 1$, $k = 2\\pi$, $n = 2$, $s = 1.196$, $\\beta = 0.4$.\n- Test case $3$ (low-frequency dominated): $L = 1$, $k = 1$, $n = 1$, $s = 0.25$, $\\beta = 0.1$.\n\nFor each test case:\n- Assemble and solve the discrete coupled system for $p_h$ and $q_h$.\n- Compute the discrete $L^2$-error in $p$ for each $N \\in \\{20, 40, 80, 160\\}$.\n- Compute the empirical convergence order using linear regression on $\\ln(h)$ vs $\\ln(\\|e\\|_{L^2})$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result is a Python-style list of five floating-point numbers $[\\text{err}_{20}, \\text{err}_{40}, \\text{err}_{80}, \\text{err}_{160}, \\text{order}]$ placed in the overall list. For example, the output must look like\n$$[\\,[e_{1,20}, e_{1,40}, e_{1,80}, e_{1,160}, r_1],\\,[e_{2,20}, e_{2,40}, e_{2,80}, e_{2,160}, r_2],\\,[e_{3,20}, e_{3,40}, e_{3,80}, e_{3,160}, r_3]\\,].$$\nAll quantities are dimensionless, so no physical units are required.",
            "solution": "The problem statement is assessed to be valid. It is a well-posed, scientifically grounded problem in computational acoustics, requiring the implementation of a standard numerical verification procedure (the Method of Manufactured Solutions) using the Finite Element Method (FEM). All necessary parameters, equations, and conditions are provided, and no contradictions or ambiguities are present.\n\nThe problem requires the numerical solution of a coupled one-dimensional thermoacoustic system using the FEM. The system is described by two linear differential equations for the acoustic pressure $p(x)$ and the heat release rate $q(x)$ on the domain $x \\in [0, L]$. The governing equations are:\n$$ \\frac{d^2 p}{dx^2} + k^2 p - s\\, q = f(x) $$\n$$ q - \\beta\\, p = 0 $$\nsubject to homogeneous Neumann boundary conditions $\\frac{dp}{dx}(0) = 0$ and $\\frac{dp}{dx}(L) = 0$. The parameters $k$, $s$, and $\\beta$ are given real constants. The forcing term $f(x)$ is specifically designed such that $p^\\star(x) = \\cos(\\frac{n\\pi x}{L})$ is the exact solution for pressure, a standard technique in code verification.\n\nThe solution is found using the provided Galerkin weak formulation. Find $p \\in H^1([0,L])$ and $q \\in L^2([0,L])$ such that for all test functions $v \\in H^1([0,L])$ and $w \\in L^2([0,L])$:\n$$ \\int_{0}^{L} \\frac{dp}{dx}\\frac{dv}{dx}\\,dx + k^2 \\int_{0}^{L} p\\, v\\,dx - s \\int_{0}^{L} q\\, v\\,dx = \\int_{0}^{L} f\\, v\\,dx $$\n$$ \\int_{0}^{L} q\\, w\\,dx - \\beta \\int_{0}^{L} p\\, w\\,dx = 0 $$\nThe integration by parts, used to derive the weak form for the $\\frac{d^2p}{dx^2}$ term, produces a boundary term $[\\frac{dp}{dx}v]_0^L$. This term vanishes due to the specified Neumann boundary conditions, which are thus naturally incorporated into the weak formulation.\n\nTo discretize the problem, the domain $[0, L]$ is partitioned into a uniform mesh of $N$ elements, with element size $h = L/N$. The nodes are located at $x_i = i h$ for $i \\in \\{0, 1, \\dots, N\\}$. Both the pressure $p(x)$ and heat release $q(x)$ are approximated using continuous, piecewise-linear basis functions, $\\{\\phi_j(x)\\}_{j=0}^{N}$:\n$$ p_h(x) = \\sum_{j=0}^{N} p_j \\phi_j(x) \\qquad \\text{and} \\qquad q_h(x) = \\sum_{j=0}^{N} q_j \\phi_j(x) $$\nHere, $\\mathbf{p} = \\{p_j\\}_{j=0}^{N}$ and $\\mathbf{q} = \\{q_j\\}_{j=0}^{N}$ are the vectors of unknown nodal values.\n\nFollowing the Galerkin method, the test functions $v(x)$ and $w(x)$ are chosen from the same space as the trial solutions, i.e., $v(x) = \\phi_i(x)$ and $w(x) = \\phi_i(x)$ for each $i \\in \\{0, 1, \\dots, N\\}$. Substituting these expansions into the weak formulation yields a system of linear algebraic equations.\n\nThe first equation becomes:\n$$ \\sum_{j=0}^{N} \\left( \\int_{0}^{L} \\frac{d\\phi_j}{dx}\\frac{d\\phi_i}{dx}\\,dx \\right) p_j + k^2 \\sum_{j=0}^{N} \\left( \\int_{0}^{L} \\phi_j \\phi_i\\,dx \\right) p_j - s \\sum_{j=0}^{N} \\left( \\int_{0}^{L} \\phi_j \\phi_i\\,dx \\right) q_j = \\int_{0}^{L} f(x) \\phi_i(x)\\,dx $$\nThis can be written in matrix form as $(K + k^2 M) \\mathbf{p} - s M \\mathbf{q} = \\mathbf{f}$, where $K$ is the stiffness matrix, $M$ is the mass matrix, and $\\mathbf{f}$ is the force vector, with entries:\n$$ K_{ij} = \\int_{0}^{L} \\frac{d\\phi_i}{dx}\\frac{d\\phi_j}{dx}\\,dx, \\qquad M_{ij} = \\int_{0}^{L} \\phi_i \\phi_j\\,dx, \\qquad f_i = \\int_{0}^{L} f(x) \\phi_i(x)\\,dx $$\n\nThe second equation becomes:\n$$ \\sum_{j=0}^{N} \\left( \\int_{0}^{L} \\phi_j \\phi_i\\,dx \\right) q_j - \\beta \\sum_{j=0}^{N} \\left( \\int_{0}^{L} \\phi_j \\phi_i\\,dx \\right) p_j = 0 $$\nIn matrix form, this is $M \\mathbf{q} - \\beta M \\mathbf{p} = \\mathbf{0}$.\n\nCombining these two matrix equations gives the global block linear system for the concatenated vector of unknowns $\\mathbf{U} = [\\mathbf{p}^T, \\mathbf{q}^T]^T$:\n$$\n\\begin{pmatrix}\nK + k^2 M  -s M \\\\\n-\\beta M  M\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{p} \\\\\n\\mathbf{q}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f} \\\\\n\\mathbf{0}\n\\end{pmatrix}\n$$\nThe system size is $2(N+1) \\times 2(N+1)$.\n\nTo construct the matrices, we use element-wise assembly. For a generic element of length $h$, the local stiffness and mass matrices ($K^e$, $M^e$) for linear basis functions are:\n$$ K^e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\qquad M^e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\nThese are assembled into the global $(N+1) \\times (N+1)$ matrices $K$ and $M$. The force vector $\\mathbf{f}$ is assembled by numerically integrating $f(x)\\phi_i(x)$ over each element. For the given problem, where $f(x) = C_f \\cos(\\frac{n\\pi x}{L})$ with $C_f = k^2 - s\\beta - (\\frac{n\\pi}{L})^2$, a two-point Gauss-Legendre quadrature on each element is sufficient for accurate integration.\n\nAfter assembling the block system, it is solved for the nodal values $\\mathbf{p}$ and $\\mathbf{q}$. The numerical solution for pressure is given by the vector $\\mathbf{p}_h$, which is the subvector $\\mathbf{p}$ of the full solution $\\mathbf{U}$. To assess accuracy, we compute the error vector $\\mathbf{e} = \\mathbf{p}_h - \\mathbf{p}^\\star$, where $\\mathbf{p}^\\star$ is the vector of exact solution values at the nodes, $(\\mathbf{p}^\\star)_i = p^\\star(x_i) = \\cos(\\frac{n\\pi x_i}{L})$. The discrete $L^2$-norm of this error is calculated as $\\|e\\|_{L^2} \\approx \\sqrt{\\mathbf{e}^T M \\mathbf{e}}$.\n\nThe empirical convergence rate is estimated to verify the method's theoretical performance. For piecewise-linear elements, the $L^2$-error is expected to converge as $\\|e\\|_{L^2} \\propto h^2$. By computing the error on a sequence of successively refined meshes with element sizes $h$, the order of convergence $r$ can be estimated from the relation $\\ln(\\|e\\|_{L^2}) \\approx r \\ln(h) + C$. This is achieved by fitting a straight line to the data points $(\\ln(h), \\ln(\\|e\\|_{L^2}))$ and taking its slope. The implementation will perform this analysis for each test case using the specified mesh sizes $N \\in \\{20, 40, 80, 160\\}$.\n\nThe algorithm proceeds as follows for each test case:\n1. For each mesh size $N$, define the mesh nodes and element size $h=L/N$.\n2. Assemble the global stiffness matrix $K$ and mass matrix $M$ of size $(N+1) \\times (N+1)$.\n3. Assemble the global force vector $\\mathbf{f}$ of size $(N+1)$ using numerical quadrature.\n4. Construct the $2(N+1) \\times 2(N+1)$ block matrix and right-hand side vector.\n5. Solve the linear system to find the nodal solution vectors $\\mathbf{p}_h$ and $\\mathbf{q}_h$.\n6. Calculate the vector of exact solution values $\\mathbf{p}^\\star$ at the nodes.\n7. Compute the discrete $L^2$-error $\\| \\mathbf{p}_h - \\mathbf{p}^\\star \\|_{L^2}$ using the mass matrix.\n8. After collecting the errors for all $N$, compute the convergence rate $r$ using a linear fit on the log-log data.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef run_fem_simulation(L, k, n, s, beta, N):\n    \"\"\"\n    Runs a single FEM simulation for a given set of parameters and mesh size.\n\n    Returns:\n        tuple: (L2 error, element size h, mass matrix M)\n    \"\"\"\n    # 1. Mesh setup\n    h = L / N\n    nodes = np.linspace(0, L, N + 1)\n    \n    # 2. Assemble Global Matrices K and M\n    size = N + 1\n    K_global = np.zeros((size, size))\n    M_global = np.zeros((size, size))\n    \n    K_elem = (1/h) * np.array([[1, -1], [-1, 1]])\n    M_elem = (h/6) * np.array([[2, 1], [1, 2]])\n\n    for i in range(N):\n        # Global indices for element i are i, i+1\n        K_global[i:i+2, i:i+2] += K_elem\n        M_global[i:i+2, i:i+2] += M_elem\n\n    # 3. Assemble Force Vector F\n    F_global = np.zeros(size)\n    C_f = k**2 - s * beta - (n * np.pi / L)**2\n    \n    def f_func(x):\n        return C_f * np.cos(n * np.pi * x / L)\n        \n    # 2-point Gauss quadrature points and weights on [0, 1] for reference element\n    gp = np.array([0.5 - 0.5/np.sqrt(3), 0.5 + 0.5/np.sqrt(3)])\n    gw = np.array([0.5, 0.5])\n    \n    # Linear basis functions on reference element\n    def phi1(xi): return 1 - xi\n    def phi2(xi): return xi\n    \n    for i in range(N):  # Loop over elements\n        # Physical coordinates of Gauss points in element i\n        x_coords = nodes[i] + h * gp\n        \n        # Evaluate forcing function at Gauss points\n        f_vals = f_func(x_coords)\n        \n        # Integrate f*phi_1 for the i-th node\n        F_global[i] += h * np.sum(gw * f_vals * phi1(gp))\n        \n        # Integrate f*phi_2 for the (i+1)-th node\n        F_global[i+1] += h * np.sum(gw * f_vals * phi2(gp))\n\n    # 4. Assemble and solve the block system\n    A_block = np.zeros((2 * size, 2 * size))\n    B_block = np.zeros(2 * size)\n\n    # Top-left block: K + k^2 * M\n    A_block[0:size, 0:size] = K_global + (k**2) * M_global\n    # Top-right block: -s * M\n    A_block[0:size, size:] = -s * M_global\n    # Bottom-left block: -beta * M\n    A_block[size:, 0:size] = -beta * M_global\n    # Bottom-right block: M\n    A_block[size:, size:] = M_global\n    \n    # RHS vector\n    B_block[0:size] = F_global\n    \n    U_block = np.linalg.solve(A_block, B_block)\n    \n    p_h = U_block[0:size]\n\n    # 5. Calculate Error\n    p_star = np.cos(n * np.pi * nodes / L)\n    error_vec = p_h - p_star\n    \n    # Discrete L2 norm of error: sqrt(e^T * M * e)\n    l2_error_sq = error_vec.T @ M_global @ error_vec\n    l2_error = np.sqrt(l2_error_sq)\n    \n    return l2_error, h, M_global\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (L, k, n, s, beta)\n        (1.0, 7.0, 2, 0.5, 0.2),         # Test case 1\n        (1.0, 2*np.pi, 2, 1.196, 0.4),  # Test case 2\n        (1.0, 1.0, 1, 0.25, 0.1)          # Test case 3\n    ]\n    N_values = [20, 40, 80, 160]\n    \n    all_results = []\n    \n    for case_params in test_cases:\n        L, k, n, s, beta = case_params\n        errors = []\n        h_values = []\n        \n        for N in N_values:\n            error, h, _ = run_fem_simulation(L, k, n, s, beta, N)\n            errors.append(error)\n            h_values.append(h)\n    \n        # 6. Calculate Convergence Order\n        log_h = np.log(h_values)\n        log_err = np.log(errors)\n        \n        # Fit a line (degree 1 polynomial) to the log-log data\n        # np.polyfit returns [slope, intercept]\n        # The slope is the empirical order of convergence.\n        order, _ = np.polyfit(log_h, log_err, 1)\n        \n        case_result = errors + [order]\n        all_results.append(case_result)\n        \n    # Format the final output string as specified\n    # Example: [[err1,err2,err3,err4,rate1],[err5,err6,...]]\n    inner_lists_str = []\n    for res_list in all_results:\n        inner_str = f\"[{','.join(map(str, res_list))}]\"\n        inner_lists_str.append(inner_str)\n    \n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}