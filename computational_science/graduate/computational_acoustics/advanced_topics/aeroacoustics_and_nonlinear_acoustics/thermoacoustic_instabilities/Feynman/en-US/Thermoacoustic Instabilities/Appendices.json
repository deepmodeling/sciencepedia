{
    "hands_on_practices": [
        {
            "introduction": "Thermoacoustic instability fundamentally arises from a feedback loop between acoustic waves and unsteady heat release. This exercise provides a foundational analysis of this feedback mechanism using simplified, linear transfer functions. By applying the Nyquist stability criterion to a basic gain-plus-delay model, you will determine the precise conditions under which small disturbances grow into large-scale oscillations, providing a clear illustration of the onset of instability .",
            "id": "4146189",
            "problem": "A straight, uniform duct of length $L$ at low mean Mach number contains a compact heat source (flame) located at $x=x_{f}$. The thermoacoustic feedback between unsteady pressure and unsteady heat release is modeled by a two-parameter, time-delay plus gain relation in the frequency domain, $G(\\omega)=\\alpha \\exp(-i \\omega \\tau)$, where $p^{\\prime}(t)$ is the acoustic pressure fluctuation and $q^{\\prime}(t)$ is the unsteady heat-release fluctuation, with the input-output relation $q^{\\prime}(t)=\\int_{-\\infty}^{\\infty} g(\\theta) p^{\\prime}(t-\\theta)\\, \\mathrm{d}\\theta$ and Fourier transform $G(\\omega)$. The parameters $\\alpha$ and $\\tau$ are the real gain and time delay, respectively. Assume all fields are nondimensionalized so that $\\alpha$ is dimensionless.\n\nTo isolate the essential loop physics, approximate the linear acoustic plant mapping the compact heat-release source to the local pressure at $x=x_{f}$ by a stable, scalar, Linear Time-Invariant (LTI) transfer function $R(\\omega)$ that is dominated by a single, weakly damped, round-trip propagation. Specifically, assume $R(\\omega)=\\beta \\exp(-i \\omega T)$ with real $\\beta \\in (0,1)$ and a positive time-of-flight $T0$. This model represents a single-pass acoustic gain $\\beta$ and a pure propagation delay $T$ for the pressure feedback to the flame.\n\nStarting from the linearized conservation laws for acoustics, the definition of the convolutional input-output relation, and the Fourier transform, set up the closed-loop condition for self-excited thermoacoustic oscillations as a consistency condition between $p^{\\prime}$ and $q^{\\prime}$. Use this to: \n- Identify and justify the causality constraints on $\\tau$ and on the admissible form of $\\alpha$ in this model.\n- Using the Nyquist stability argument for the loop transfer function, determine the exact marginal-stability gain magnitude $\\alpha_{\\mathrm{crit}}$ in closed form as a function of $\\beta$ only, such that for some frequency $\\omega$ the system is exactly neutrally stable. You may assume that the model $G(\\omega)=\\alpha \\exp(-i \\omega \\tau)$ concentrates all non-propagation phase in the time delay $\\tau$, so that $\\alpha$ is real and nonnegative.\n\nExpress your final answer as a single closed-form analytic expression for $\\alpha_{\\mathrm{crit}}$. No numerical rounding is required.",
            "solution": "The problem asks for an analysis of a thermoacoustic feedback loop, including justification of causality constraints and the derivation of the marginal-stability gain using the Nyquist criterion. The system consists of a heat source (flame) and an acoustic plant, modeled as a closed-loop system.\n\nFirst, we establish the characteristic equation for self-excited oscillations. The system is described by two coupled relationships in the frequency domain. The flame's response, which relates the unsteady heat release rate $\\hat{q}(\\omega)$ to the acoustic pressure fluctuation $\\hat{p}(\\omega)$ at the flame location, is given by the transfer function $G(\\omega)$:\n$$\n\\hat{q}(\\omega) = G(\\omega) \\hat{p}(\\omega)\n$$\nThe acoustic plant's response, which maps the heat release rate $\\hat{q}(\\omega)$ back to the pressure fluctuation $\\hat{p}(\\omega)$ at the same location, is given by the transfer function $R(\\omega)$:\n$$\n\\hat{p}(\\omega) = R(\\omega) \\hat{q}(\\omega)\n$$\nFor a feedback loop, these two equations must hold simultaneously. Substituting the first equation into the second yields:\n$$\n\\hat{p}(\\omega) = R(\\omega) G(\\omega) \\hat{p}(\\omega)\n$$\nThis can be rearranged into a homogeneous equation:\n$$\n(1 - R(\\omega) G(\\omega)) \\hat{p}(\\omega) = 0\n$$\nSelf-excited oscillations are non-trivial solutions to this system, meaning $\\hat{p}(\\omega) \\neq 0$. This requires the coefficient of $\\hat{p}(\\omega)$ to be zero. Thus, the characteristic equation for the closed-loop system is:\n$$\n1 - L(\\omega) = 0 \\quad \\text{where} \\quad L(\\omega) = R(\\omega) G(\\omega)\n$$\nHere, $L(\\omega)$ is the open-loop transfer function.\n\nNext, we address the causality constraints on the parameters of the flame model $G(\\omega) = \\alpha \\exp(-i \\omega \\tau)$. The input-output relation in the time domain is given as a convolution:\n$$\nq^{\\prime}(t) = \\int_{-\\infty}^{\\infty} g(\\theta) p^{\\prime}(t-\\theta) \\, \\mathrm{d}\\theta\n$$\nwhere $g(t)$ is the impulse response function, whose Fourier transform is $G(\\omega)$. For this system to be causal, the output $q^{\\prime}(t)$ at time $t$ can only depend on the input $p^{\\prime}(s)$ at times $s \\le t$. In the integral, the input is evaluated at time $t-\\theta$. Causality thus requires that the integral only includes contributions from past or present inputs, which means $t-\\theta \\le t$, or $\\theta \\ge 0$. Therefore, the impulse response function $g(\\theta)$ must be zero for all negative arguments: $g(\\theta) = 0$ for $\\theta  0$.\n\nThe inverse Fourier transform of $G(\\omega) = \\alpha \\exp(-i \\omega \\tau)$ gives the impulse response:\n$$\ng(t) = \\mathcal{F}^{-1}\\{G(\\omega)\\} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\alpha \\exp(-i \\omega \\tau) \\exp(i \\omega t) \\, \\mathrm{d}\\omega = \\alpha \\left( \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\exp(i \\omega (t-\\tau)) \\, \\mathrm{d}\\omega \\right)\n$$\nThe term in parentheses is the definition of the Dirac delta function, $\\delta(t-\\tau)$. So, $g(t) = \\alpha \\delta(t-\\tau)$.\nThe delta function is non-zero only at $t=\\tau$. For $g(t)$ to satisfy the causality condition $g(t)=0$ for $t0$, its non-zero point must be at a non-negative time. This imposes the constraint $\\tau \\ge 0$. A negative time delay would imply a non-causal system where the flame responds to pressure fluctuations before they occur.\n\nThe problem states to assume $\\alpha$ is real and non-negative. This is a common and physically meaningful assumption. The parameter $\\alpha$ represents a gain. For a combustion process, a positive pressure fluctuation often leads to an enhanced reaction rate and thus an increased heat release rate (after some delay $\\tau$). A positive $\\alpha$ models this direct relationship. A negative $\\alpha$ would imply an inverse relationship (e.g., a process where increased pressure suppresses heat release), which is less typical for simple flame models. The assumption $\\alpha \\ge 0$ ensures that the flame acts as a source of energy that can potentially drive oscillations, rather than damp them.\n\nNow, we determine the marginal-stability gain $\\alpha_{\\mathrm{crit}}$. Marginal, or neutral, stability occurs when the system can sustain an oscillation at a constant amplitude. In the context of the Nyquist stability criterion for an open-loop stable system (which $L(\\omega)$ is), this corresponds to the locus of $L(i\\omega)$ passing through the critical point $(1, 0)$ in the complex plane for some real frequency $\\omega > 0$. This is equivalent to solving the characteristic equation $L(\\omega) = 1$.\n\nWe substitute the given expressions for $G(\\omega)$ and $R(\\omega)$:\n$$\nL(\\omega) = G(\\omega) R(\\omega) = (\\alpha \\exp(-i \\omega \\tau)) (\\beta \\exp(-i \\omega T)) = \\alpha \\beta \\exp(-i \\omega (T + \\tau))\n$$\nThe marginal stability condition is $L(\\omega) = 1$:\n$$\n\\alpha \\beta \\exp(-i \\omega (T + \\tau)) = 1\n$$\nFor this complex equation to hold, both the magnitude and the phase of the left side must match the right side. The magnitude of $1$ is $1$ and its phase is $2k\\pi$ for any integer $k$.\n\n1.  **Magnitude Condition:**\n    $$\n    |\\alpha \\beta \\exp(-i \\omega (T + \\tau))| = 1\n    $$\n    Given that $\\alpha \\ge 0$ and $\\beta \\in (0,1)$ are real and positive, and $|\\exp(-i \\phi)| = 1$ for any real $\\phi$, the condition simplifies to:\n    $$\n    \\alpha \\beta = 1\n    $$\n    This gives the critical gain $\\alpha_{\\mathrm{crit}}$ at which the loop gain magnitude is unity. For any $\\alpha  1/\\beta$, the loop gain is less than $1$, and perturbations will die out. For $\\alpha > 1/\\beta$, the loop gain is greater than $1$, and perturbations can grow. The marginal case is exact equality.\n    $$\n    \\alpha_{\\mathrm{crit}} = \\frac{1}{\\beta}\n    $$\n    This expression depends only on $\\beta$, as required.\n\n2.  **Phase Condition:**\n    The phase of the loop transfer function must match the phase of $1$, which is $0$ (modulo $2\\pi$).\n    $$\n    \\arg(\\alpha \\beta \\exp(-i \\omega (T + \\tau))) = 2k\\pi, \\quad k \\in \\mathbb{Z}\n    $$\n    Since $\\alpha$ and $\\beta$ are positive real numbers, their phase is $0$. The phase of the expression is determined by the exponential term:\n    $$\n    -\\omega (T + \\tau) = 2k\\pi\n    $$\n    We are interested in physical oscillations, for which $\\omega > 0$. The problem specifies $T > 0$ and we deduced $\\tau \\ge 0$, so $(T+\\tau) > 0$. This means the left-hand side, $-\\omega(T+\\tau)$, must be negative. Therefore, we must choose negative integers for $k$. Let $k = -n$, where $n$ is a positive integer ($n=1, 2, 3, ...$).\n    $$\n    \\omega (T + \\tau) = 2n\\pi\n    $$\n    This condition gives the possible frequencies of oscillation:\n    $$\n    \\omega_n = \\frac{2n\\pi}{T + \\tau}, \\quad n = 1, 2, 3, \\dots\n    $$\n    Since $T + \\tau$ is a positive, finite value, there always exists a set of positive frequencies $\\omega_n$ that satisfy the phase condition for constructive interference.\n\nThe problem asks for the gain $\\alpha_{\\mathrm{crit}}$ such that for *some* frequency $\\omega$, the system is neutrally stable. We have found that the gain condition $\\alpha = 1/\\beta$ is independent of frequency, and that there always exist frequencies $\\omega_n$ that satisfy the phase condition. Therefore, the critical gain required for marginal stability is determined solely by the magnitude condition.",
            "answer": "$$\\boxed{\\frac{1}{\\beta}}$$"
        },
        {
            "introduction": "While linear models predict the onset of instability, they cannot explain the finite, stable amplitude of the resulting oscillations. This saturation is due to nonlinearities in the system, which this practice explores using the describing function method. You will analyze a classic Rijke tube model with a nonlinear heat source to understand how to approximate the effect of saturation, a crucial step in predicting the amplitude of thermoacoustic limit cycles in real-world devices .",
            "id": "4146221",
            "problem": "A straight, rigid-walled, open–open duct of length $L$ contains a compact electrical heater at position $x_{h}$, forming a canonical Rijke tube. Consider small-to-moderate amplitude longitudinal acoustic oscillations at angular frequency $\\omega$ with speed of sound $c$. The duct is modeled in the one-dimensional compressible limit, linearizing the mass and momentum equations about a quiescent base state, and coupling them to an unsteady volumetric heat-release rate $q^{\\prime}(t)$ concentrated at $x_{h}$ (acoustically compact source). Assume that acoustic losses in the duct are weak and that the dominant oscillation is near the fundamental duct mode, so that the acoustic field may be approximated by a single harmonic ansatz. The heater’s unsteady heat-release rate depends nonlinearly on the delayed local acoustic velocity $u(x_{h},t-\\tau)$ due to finite convection time $\\tau$ of hot fluid, and exhibits amplitude saturation. Specifically, suppose the heater’s nonlinear response law is\n$$\nq^{\\prime}(t) \\;=\\; \\frac{\\alpha\\,u(x_{h},t-\\tau)}{\\,1+\\gamma\\,u(x_{h},t-\\tau)^{2}\\,}\\,,\n$$\nwith $\\alpha0$ and $\\gamma0$ constants characterizing the linear coupling strength and the saturation level, respectively. Let the local acoustic velocity at the heater be approximated by a single-frequency harmonic $u(x_{h},t)\\approx A\\cos(\\omega t)$, where $A0$ is the finite oscillation amplitude to be determined by the loop dynamics. The heater is acoustically compact, and the rest of the duct behaves as a Linear Time-Invariant (LTI) system that maps $q^{\\prime}(t)$ to $u(x_{h},t)$ via a real, positive gain factor $K$ at frequency $\\omega$ and a phase $\\phi_{\\mathrm{ac}}(\\omega)$ originating from acoustic propagation and boundary conditions.\n\nStarting from the linearized acoustic equations and the assumption of compact energy addition, use harmonic balance on the fundamental component to construct the describing function $N(A)$ of the heater nonlinearity at amplitude $A$. By definition, the describing function is the complex gain that maps the first harmonic of $u(x_{h},t)$ to the first harmonic of $q^{\\prime}(t)$. You must explicitly account for the convection delay $\\tau$ in your describing function. Assume that the overall loop phase condition is satisfied at $\\omega$ by appropriate choice of $L$, $x_{h}$, and $\\tau$, so the harmonic balance for the amplitude reduces to a real gain condition. Do not invoke or quote any pre-derived describing-function formulas; derive the required integrals from first principles.\n\nYour task is to derive the exact, closed-form analytic expression for the amplitude-dependent effective gain $N(A)$ of the heater’s describing function, including the delay $\\tau$. Provide your final answer as a single analytic expression. No numerical evaluation is required and no units should be included in the final boxed expression.",
            "solution": "The problem statement has been evaluated and is determined to be valid. It is a well-posed, scientifically grounded problem in the field of thermoacoustics and nonlinear systems analysis. The premises are consistent and sufficient for the derivation of the requested describing function.\n\nThe objective is to derive the describing function, $N(A)$, for the given nonlinear heater response law. The describing function method is an application of harmonic balance used to analyze the behavior of nonlinear systems under sinusoidal forcing. By definition, the describing function $N(A)$ is the complex gain that relates a sinusoidal input to the fundamental component of the periodic, non-sinusoidal output.\n\nLet the input to the nonlinear element be the local acoustic velocity at the heater, which is approximated as a single harmonic:\n$$\nu(x_h, t) = A \\cos(\\omega t)\n$$\nwhere $A  0$ is the amplitude and $\\omega$ is the angular frequency.\n\nThe heater's nonlinear response law is a function of the delayed velocity, $u(x_h, t-\\tau)$, where $\\tau$ is the convection delay. The output of the nonlinearity is the heat-release rate, $q^{\\prime}(t)$:\n$$\nq^{\\prime}(t) = f(u(x_h, t-\\tau)) = \\frac{\\alpha\\,u(x_h,t-\\tau)}{1+\\gamma\\,u(x_h,t-\\tau)^{2}}\n$$\nSubstituting the expression for the velocity, we get:\n$$\nq^{\\prime}(t) = \\frac{\\alpha A \\cos(\\omega(t-\\tau))}{1+\\gamma A^{2} \\cos^{2}(\\omega(t-\\tau))}\n$$\nThe output $q^{\\prime}(t)$ is a periodic function with the same fundamental frequency $\\omega$ as the input. We can express it as a Fourier series. The describing function $N(A)$ captures the gain and phase shift of the fundamental harmonic of $q^{\\prime}(t)$ relative to the input $u(x_h, t)$. The fundamental component of $q^{\\prime}(t)$ is given by:\n$$\nq^{\\prime}_{1}(t) = a_1 \\cos(\\omega t) + b_1 \\sin(\\omega t)\n$$\nwhere $a_1$ and $b_1$ are the Fourier coefficients:\n$$\na_1 = \\frac{1}{\\pi} \\int_{0}^{2\\pi} q^{\\prime}(t) \\cos(\\omega t) \\,d(\\omega t)\n$$\n$$\nb_1 = \\frac{1}{\\pi} \\int_{0}^{2\\pi} q^{\\prime}(t) \\sin(\\omega t) \\,d(\\omega t)\n$$\nFor an input $A\\cos(\\omega t)$, the describing function is defined as $N(A) = \\frac{a_1 - i b_1}{A}$. Let us compute the coefficients $a_1$ and $b_1$. Let the phase angle $\\phi = \\omega\\tau$ and the integration variable $\\theta = \\omega t$.\n$$\nq^{\\prime}(t) = \\frac{\\alpha A \\cos(\\theta - \\phi)}{1+\\gamma A^{2} \\cos^{2}(\\theta - \\phi)}\n$$\nThe integrals for the coefficients become:\n$$\na_1 = \\frac{\\alpha A}{\\pi} \\int_{0}^{2\\pi} \\frac{\\cos(\\theta - \\phi)}{1+\\gamma A^{2} \\cos^{2}(\\theta - \\phi)} \\cos(\\theta) \\,d\\theta\n$$\n$$\nb_1 = \\frac{\\alpha A}{\\pi} \\int_{0}^{2\\pi} \\frac{\\cos(\\theta - \\phi)}{1+\\gamma A^{2} \\cos^{2}(\\theta - \\phi)} \\sin(\\theta) \\,d\\theta\n$$\nWe perform a change of variable $\\psi = \\theta - \\phi$, so $\\theta = \\psi + \\phi$. Since the integrand is $2\\pi$-periodic in $\\theta$, we can integrate $\\psi$ over any interval of length $2\\pi$, such as $[0, 2\\pi]$.\n$$\na_1 = \\frac{\\alpha A}{\\pi} \\int_{0}^{2\\pi} \\frac{\\cos(\\psi)}{1+\\gamma A^{2} \\cos^{2}(\\psi)} \\cos(\\psi+\\phi) \\,d\\psi\n$$\n$$\nb_1 = \\frac{\\alpha A}{\\pi} \\int_{0}^{2\\pi} \\frac{\\cos(\\psi)}{1+\\gamma A^{2} \\cos^{2}(\\psi)} \\sin(\\psi+\\phi) \\,d\\psi\n$$\nUsing the trigonometric identities for the sum of angles, $\\cos(\\psi+\\phi) = \\cos\\psi\\cos\\phi - \\sin\\psi\\sin\\phi$ and $\\sin(\\psi+\\phi) = \\sin\\psi\\cos\\phi + \\cos\\psi\\sin\\phi$:\n$$\na_1 = \\frac{\\alpha A}{\\pi} \\left[ \\cos\\phi \\int_{0}^{2\\pi} \\frac{\\cos^{2}\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi} d\\psi - \\sin\\phi \\int_{0}^{2\\pi} \\frac{\\cos\\psi\\sin\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi} d\\psi \\right]\n$$\n$$\nb_1 = \\frac{\\alpha A}{\\pi} \\left[ \\cos\\phi \\int_{0}^{2\\pi} \\frac{\\cos\\psi\\sin\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi} d\\psi + \\sin\\phi \\int_{0}^{2\\pi} \\frac{\\cos^{2}\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi} d\\psi \\right]\n$$\nThe integrand $\\frac{\\cos\\psi\\sin\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi}$ is an odd function of $\\psi$ over the symmetric interval $[-\\pi, \\pi]$. Since it is $2\\pi$-periodic, its integral over $[0, 2\\pi]$ is zero. Thus, the second term in the expression for $a_1$ and the first term in the expression for $b_1$ vanish.\nThe expressions for the coefficients simplify to:\n$$\na_1 = \\frac{\\alpha A \\cos\\phi}{\\pi} I \\quad \\text{and} \\quad b_1 = \\frac{\\alpha A \\sin\\phi}{\\pi} I\n$$\nwhere the integral $I$ is defined as:\n$$\nI = \\int_{0}^{2\\pi} \\frac{\\cos^{2}\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi} \\,d\\psi\n$$\nNow we must evaluate $I$. We can rewrite the integrand using algebraic manipulation:\n$$\n\\frac{\\cos^{2}\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi} = \\frac{1}{\\gamma A^{2}} \\frac{\\gamma A^{2}\\cos^{2}\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi} = \\frac{1}{\\gamma A^{2}} \\frac{(1+\\gamma A^{2}\\cos^{2}\\psi) - 1}{1+\\gamma A^{2}\\cos^{2}\\psi} = \\frac{1}{\\gamma A^{2}} \\left(1 - \\frac{1}{1+\\gamma A^{2}\\cos^{2}\\psi}\\right)\n$$\nSubstituting this into the integral for $I$:\n$$\nI = \\frac{1}{\\gamma A^{2}} \\int_{0}^{2\\pi} \\left(1 - \\frac{1}{1+\\gamma A^{2}\\cos^{2}\\psi}\\right) \\,d\\psi = \\frac{1}{\\gamma A^{2}} \\left( 2\\pi - \\int_{0}^{2\\pi} \\frac{d\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi} \\right)\n$$\nLet's evaluate the remaining integral, $J = \\int_{0}^{2\\pi} \\frac{d\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi}$. The integrand is an even function, so we can write:\n$$\nJ = 4 \\int_{0}^{\\pi/2} \\frac{d\\psi}{1+\\gamma A^{2}\\cos^{2}\\psi}\n$$\nDividing the numerator and denominator by $\\cos^{2}\\psi$:\n$$\nJ = 4 \\int_{0}^{\\pi/2} \\frac{\\sec^{2}\\psi \\,d\\psi}{\\sec^{2}\\psi+\\gamma A^{2}} = 4 \\int_{0}^{\\pi/2} \\frac{\\sec^{2}\\psi \\,d\\psi}{1+\\tan^{2}\\psi+\\gamma A^{2}}\n$$\nUsing the substitution $u=\\tan\\psi$, $du = \\sec^{2}\\psi \\,d\\psi$. The limits of integration become $0$ to $\\infty$.\n$$\nJ = 4 \\int_{0}^{\\infty} \\frac{du}{u^{2} + (1+\\gamma A^{2})}\n$$\nThis is a standard integral form $\\int \\frac{dx}{x^{2}+b^{2}} = \\frac{1}{b}\\arctan(\\frac{x}{b})$. Here, $b = \\sqrt{1+\\gamma A^{2}}$.\n$$\nJ = 4 \\left[ \\frac{1}{\\sqrt{1+\\gamma A^{2}}} \\arctan\\left(\\frac{u}{\\sqrt{1+\\gamma A^{2}}}\\right) \\right]_{0}^{\\infty} = 4 \\frac{1}{\\sqrt{1+\\gamma A^{2}}} \\left( \\frac{\\pi}{2} - 0 \\right) = \\frac{2\\pi}{\\sqrt{1+\\gamma A^{2}}}\n$$\nSubstituting $J$ back into the expression for $I$:\n$$\nI = \\frac{1}{\\gamma A^{2}} \\left( 2\\pi - \\frac{2\\pi}{\\sqrt{1+\\gamma A^{2}}} \\right) = \\frac{2\\pi}{\\gamma A^{2}} \\left( 1 - \\frac{1}{\\sqrt{1+\\gamma A^{2}}} \\right)\n$$\nFinally, we assemble the describing function $N(A)$:\n$$\nN(A) = \\frac{a_1 - i b_1}{A} = \\frac{1}{A} \\left( \\frac{\\alpha A \\cos\\phi}{\\pi} I - i \\frac{\\alpha A \\sin\\phi}{\\pi} I \\right) = \\frac{\\alpha I}{\\pi} (\\cos\\phi - i\\sin\\phi) = \\frac{\\alpha I}{\\pi} e^{-i\\phi}\n$$\nSubstituting the expression for $I$ and remembering that $\\phi = \\omega\\tau$:\n$$\nN(A) = \\frac{\\alpha}{\\pi} \\left[ \\frac{2\\pi}{\\gamma A^{2}} \\left( 1 - \\frac{1}{\\sqrt{1+\\gamma A^{2}}} \\right) \\right] e^{-i\\omega\\tau}\n$$\n$$\nN(A) = \\frac{2\\alpha}{\\gamma A^{2}} \\left( 1 - \\frac{1}{\\sqrt{1+\\gamma A^{2}}} \\right) e^{-i\\omega\\tau}\n$$\nThis is the final closed-form analytic expression for the describing function of the heater. It correctly captures the amplitude dependence of the gain and the phase shift due to the convective time delay $\\tau$.",
            "answer": "$$\\boxed{ \\frac{2\\alpha}{\\gamma A^{2}} \\left( 1 - \\frac{1}{\\sqrt{1+\\gamma A^{2}}} \\right) \\exp(-i\\omega\\tau) }$$"
        },
        {
            "introduction": "For complex geometries and realistic physical models where analytical solutions are not feasible, numerical methods are essential. This practice transitions from analytical techniques to computational analysis by guiding you through the implementation of a Finite Element Method (FEM) solver. By setting up and solving the weak form of the coupled thermoacoustic equations, you will gain hands-on experience with a powerful tool used in modern engineering design and develop skills in the critical process of code verification .",
            "id": "4146174",
            "problem": "Consider a one-dimensional duct of length $L$, with negligible mean flow and small acoustic perturbations described in the frequency domain. Let $p(x)$ denote the complex-valued amplitude of acoustic pressure and $q(x)$ denote the complex-valued amplitude of heat-release rate per unit volume. The governing coupled equations for thermoacoustic interaction can be modeled, after non-dimensionalization and suitable scaling of parameters, by the following linear system on the interval $x \\in [0,L]$:\n$$\\frac{d^2 p}{dx^2} + k^2 p - s\\, q = f(x),$$\n$$q - \\beta\\, p = 0,$$\nwith Neumann boundary conditions\n$$\\frac{dp}{dx}(0) = 0, \\quad \\frac{dp}{dx}(L) = 0.$$\nHere $k$ is the acoustic wave number, $s$ is a real coupling strength associated with the acoustic response to heat release, and $\\beta$ is a real proportionality coefficient relating heat-release fluctuations to pressure fluctuations. Assume $p$ and $q$ are real-valued for this study.\n\nTo enable verification against an analytical solution, set the exact solution target to\n$$p^\\star(x) = \\cos\\!\\left(\\frac{n\\pi x}{L}\\right), \\qquad q^\\star(x) = \\beta\\, p^\\star(x),$$\nfor a chosen positive integer mode index $n$. Define the forcing term $f(x)$ such that the above pair $(p^\\star,q^\\star)$ satisfies the coupled equations:\n$$f(x) = \\left(k^2 - s\\,\\beta - \\left(\\frac{n\\pi}{L}\\right)^2\\right)\\cos\\!\\left(\\frac{n\\pi x}{L}\\right).$$\n\nYour task is to implement a Finite Element Method (FEM) using Weighted Residuals (WR) with continuous, piecewise-linear basis functions on a uniform mesh of $N$ elements over $[0,L]$ to solve for the discrete approximations $p_h(x)$ and $q_h(x)$. Use the standard Galerkin approach. The weak form is: find $p \\in H^1([0,L])$ and $q \\in L^2([0,L])$ such that for all test functions $v \\in H^1([0,L])$ and $w \\in L^2([0,L])$,\n$$\\int_{0}^{L} \\frac{dp}{dx}\\frac{dv}{dx}\\,dx + k^2 \\int_{0}^{L} p\\, v\\,dx - s \\int_{0}^{L} q\\, v\\,dx = \\int_{0}^{L} f\\, v\\,dx,$$\n$$\\int_{0}^{L} q\\, w\\,dx - \\beta \\int_{0}^{L} p\\, w\\,dx = 0.$$\nThe Neumann boundary conditions are naturally enforced by the weak form.\n\nDiscretize the problem with a uniform mesh and continuous, piecewise-linear basis functions $\\{\\phi_i(x)\\}_{i=0}^{N}$ for both $p$ and $q$, assemble the global block linear system for the nodal coefficients of $p_h$ and $q_h$, and solve it. Compute the discrete $L^2$-norm of the error in $p$ using the finite element mass matrix $M$:\n$$\\|e\\|_{L^2} \\approx \\sqrt{e^\\top M\\, e}, \\quad e = \\mathbf{p}_h - \\mathbf{p}^\\star,$$\nwhere $\\mathbf{p}^\\star$ is the vector of exact nodal values $p^\\star(x_i)$ at the mesh nodes $\\{x_i\\}_{i=0}^{N}$.\n\nEstimate the empirical convergence rate by fitting a line to the data $\\{(\\ln(h), \\ln(\\|e\\|_{L^2}))\\}$, where $h = L/N$ is the element size for each mesh, and report the slope as the estimated order. The expected rate for the $L^2$-norm with continuous, piecewise-linear elements on sufficiently smooth solutions is approximately $2$.\n\nImplement your program to run the following test suite of parameter sets, each solved on meshes with $N \\in \\{20, 40, 80, 160\\}$:\n- Test case $1$ (happy path): $L = 1$, $k = 7$, $n = 2$, $s = 0.5$, $\\beta = 0.2$.\n- Test case $2$ (near-cancellation): $L = 1$, $k = 2\\pi$, $n = 2$, $s = 1.196$, $\\beta = 0.4$.\n- Test case $3$ (low-frequency dominated): $L = 1$, $k = 1$, $n = 1$, $s = 0.25$, $\\beta = 0.1$.\n\nFor each test case:\n- Assemble and solve the discrete coupled system for $p_h$ and $q_h$.\n- Compute the discrete $L^2$-error in $p$ for each $N \\in \\{20, 40, 80, 160\\}$.\n- Compute the empirical convergence order using linear regression on $\\ln(h)$ vs $\\ln(\\|e\\|_{L^2})$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result is a Python-style list of five floating-point numbers $[\\text{err}_{20}, \\text{err}_{40}, \\text{err}_{80}, \\text{err}_{160}, \\text{order}]$ placed in the overall list. For example, the output must look like\n$$[\\,[e_{1,20}, e_{1,40}, e_{1,80}, e_{1,160}, r_1],\\,[e_{2,20}, e_{2,40}, e_{2,80}, e_{2,160}, r_2],\\,[e_{3,20}, e_{3,40}, e_{3,80}, e_{3,160}, r_3]\\,].$$\nAll quantities are dimensionless, so no physical units are required.",
            "solution": "The problem statement is assessed to be valid. It is a well-posed, scientifically grounded problem in computational acoustics, requiring the implementation of a standard numerical verification procedure (the Method of Manufactured Solutions) using the Finite Element Method (FEM). All necessary parameters, equations, and conditions are provided, and no contradictions or ambiguities are present.\n\nThe problem requires the numerical solution of a coupled one-dimensional thermoacoustic system using the FEM. The system is described by two linear differential equations for the acoustic pressure $p(x)$ and the heat release rate $q(x)$ on the domain $x \\in [0, L]$. The governing equations are:\n$$ \\frac{d^2 p}{dx^2} + k^2 p - s\\, q = f(x) $$\n$$ q - \\beta\\, p = 0 $$\nsubject to homogeneous Neumann boundary conditions $\\frac{dp}{dx}(0) = 0$ and $\\frac{dp}{dx}(L) = 0$. The parameters $k$, $s$, and $\\beta$ are given real constants. The forcing term $f(x)$ is specifically designed such that $p^\\star(x) = \\cos(\\frac{n\\pi x}{L})$ is the exact solution for pressure, a standard technique in code verification.\n\nThe solution is found using the provided Galerkin weak formulation. Find $p \\in H^1([0,L])$ and $q \\in L^2([0,L])$ such that for all test functions $v \\in H^1([0,L])$ and $w \\in L^2([0,L])$:\n$$ \\int_{0}^{L} \\frac{dp}{dx}\\frac{dv}{dx}\\,dx + k^2 \\int_{0}^{L} p\\, v\\,dx - s \\int_{0}^{L} q\\, v\\,dx = \\int_{0}^{L} f\\, v\\,dx $$\n$$ \\int_{0}^{L} q\\, w\\,dx - \\beta \\int_{0}^{L} p\\, w\\,dx = 0 $$\nThe integration by parts, used to derive the weak form for the $\\frac{d^2p}{dx^2}$ term, produces a boundary term $[\\frac{dp}{dx}v]_0^L$. This term vanishes due to the specified Neumann boundary conditions, which are thus naturally incorporated into the weak formulation.\n\nTo discretize the problem, the domain $[0, L]$ is partitioned into a uniform mesh of $N$ elements, with element size $h = L/N$. The nodes are located at $x_i = i h$ for $i \\in \\{0, 1, \\dots, N\\}$. Both the pressure $p(x)$ and heat release $q(x)$ are approximated using continuous, piecewise-linear basis functions, $\\{\\phi_j(x)\\}_{j=0}^{N}$:\n$$ p_h(x) = \\sum_{j=0}^{N} p_j \\phi_j(x) \\qquad \\text{and} \\qquad q_h(x) = \\sum_{j=0}^{N} q_j \\phi_j(x) $$\nHere, $\\mathbf{p} = \\{p_j\\}_{j=0}^{N}$ and $\\mathbf{q} = \\{q_j\\}_{j=0}^{N}$ are the vectors of unknown nodal values.\n\nFollowing the Galerkin method, the test functions $v(x)$ and $w(x)$ are chosen from the same space as the trial solutions, i.e., $v(x) = \\phi_i(x)$ and $w(x) = \\phi_i(x)$ for each $i \\in \\{0, 1, \\dots, N\\}$. Substituting these expansions into the weak formulation yields a system of linear algebraic equations.\n\nThe first equation becomes:\n$$ \\sum_{j=0}^{N} \\left( \\int_{0}^{L} \\frac{d\\phi_j}{dx}\\frac{d\\phi_i}{dx}\\,dx \\right) p_j + k^2 \\sum_{j=0}^{N} \\left( \\int_{0}^{L} \\phi_j \\phi_i\\,dx \\right) p_j - s \\sum_{j=0}^{N} \\left( \\int_{0}^{L} \\phi_j \\phi_i\\,dx \\right) q_j = \\int_{0}^{L} f(x) \\phi_i(x)\\,dx $$\nThis can be written in matrix form as $(K + k^2 M) \\mathbf{p} - s M \\mathbf{q} = \\mathbf{f}$, where $K$ is the stiffness matrix, $M$ is the mass matrix, and $\\mathbf{f}$ is the force vector, with entries:\n$$ K_{ij} = \\int_{0}^{L} \\frac{d\\phi_i}{dx}\\frac{d\\phi_j}{dx}\\,dx, \\qquad M_{ij} = \\int_{0}^{L} \\phi_i \\phi_j\\,dx, \\qquad f_i = \\int_{0}^{L} f(x) \\phi_i(x)\\,dx $$\n\nThe second equation becomes:\n$$ \\sum_{j=0}^{N} \\left( \\int_{0}^{L} \\phi_j \\phi_i\\,dx \\right) q_j - \\beta \\sum_{j=0}^{N} \\left( \\int_{0}^{L} \\phi_j \\phi_i\\,dx \\right) p_j = 0 $$\nIn matrix form, this is $M \\mathbf{q} - \\beta M \\mathbf{p} = \\mathbf{0}$.\n\nCombining these two matrix equations gives the global block linear system for the concatenated vector of unknowns $\\mathbf{U} = [\\mathbf{p}^T, \\mathbf{q}^T]^T$:\n$$\n\\begin{pmatrix}\nK + k^2 M  -s M \\\\\n-\\beta M  M\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{p} \\\\\n\\mathbf{q}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{f} \\\\\n\\mathbf{0}\n\\end{pmatrix}\n$$\nThe system size is $2(N+1) \\times 2(N+1)$.\n\nTo construct the matrices, we use element-wise assembly. For a generic element of length $h$, the local stiffness and mass matrices ($K^e$, $M^e$) for linear basis functions are:\n$$ K^e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\qquad M^e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\nThese are assembled into the global $(N+1) \\times (N+1)$ matrices $K$ and $M$. The force vector $\\mathbf{f}$ is assembled by numerically integrating $f(x)\\phi_i(x)$ over each element. For the given problem, where $f(x) = C_f \\cos(\\frac{n\\pi x}{L})$ with $C_f = k^2 - s\\beta - (\\frac{n\\pi}{L})^2$, a two-point Gauss-Legendre quadrature on each element is sufficient for accurate integration.\n\nAfter assembling the block system, it is solved for the nodal values $\\mathbf{p}$ and $\\mathbf{q}$. The numerical solution for pressure is given by the vector $\\mathbf{p}_h$, which is the subvector $\\mathbf{p}$ of the full solution $\\mathbf{U}$. To assess accuracy, we compute the error vector $\\mathbf{e} = \\mathbf{p}_h - \\mathbf{p}^\\star$, where $\\mathbf{p}^\\star$ is the vector of exact solution values at the nodes, $(\\mathbf{p}^\\star)_i = p^\\star(x_i) = \\cos(\\frac{n\\pi x_i}{L})$. The discrete $L^2$-norm of this error is calculated as $\\|e\\|_{L^2} \\approx \\sqrt{\\mathbf{e}^T M \\mathbf{e}}$.\n\nThe empirical convergence rate is estimated to verify the method's theoretical performance. For piecewise-linear elements, the $L^2$-error is expected to converge as $\\|e\\|_{L^2} \\propto h^2$. By computing the error on a sequence of successively refined meshes with element sizes $h$, the order of convergence $r$ can be estimated from the relation $\\ln(\\|e\\|_{L^2}) \\approx r \\ln(h) + C$. This is achieved by fitting a straight line to the data points $(\\ln(h), \\ln(\\|e\\|_{L^2}))$ and taking its slope. The implementation will perform this analysis for each test case using the specified mesh sizes $N \\in \\{20, 40, 80, 160\\}$.\n\nThe algorithm proceeds as follows for each test case:\n1. For each mesh size $N$, define the mesh nodes and element size $h=L/N$.\n2. Assemble the global stiffness matrix $K$ and mass matrix $M$ of size $(N+1) \\times (N+1)$.\n3. Assemble the global force vector $\\mathbf{f}$ of size $(N+1)$ using numerical quadrature.\n4. Construct the $2(N+1) \\times 2(N+1)$ block matrix and right-hand side vector.\n5. Solve the linear system to find the nodal solution vectors $\\mathbf{p}_h$ and $\\mathbf{q}_h$.\n6. Calculate the vector of exact solution values $\\mathbf{p}^\\star$ at the nodes.\n7. Compute the discrete $L^2$-error $\\| \\mathbf{p}_h - \\mathbf{p}^\\star \\|_{L^2}$ using the mass matrix.\n8. After collecting the errors for all $N$, compute the convergence rate $r$ using a linear fit on the log-log data.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef run_fem_simulation(L, k, n, s, beta, N):\n    \"\"\"\n    Runs a single FEM simulation for a given set of parameters and mesh size.\n\n    Returns:\n        tuple: (L2 error, element size h, mass matrix M)\n    \"\"\"\n    # 1. Mesh setup\n    h = L / N\n    nodes = np.linspace(0, L, N + 1)\n    \n    # 2. Assemble Global Matrices K and M\n    size = N + 1\n    K_global = np.zeros((size, size))\n    M_global = np.zeros((size, size))\n    \n    K_elem = (1/h) * np.array([[1, -1], [-1, 1]])\n    M_elem = (h/6) * np.array([[2, 1], [1, 2]])\n\n    for i in range(N):\n        # Global indices for element i are i, i+1\n        K_global[i:i+2, i:i+2] += K_elem\n        M_global[i:i+2, i:i+2] += M_elem\n\n    # 3. Assemble Force Vector F\n    F_global = np.zeros(size)\n    C_f = k**2 - s * beta - (n * np.pi / L)**2\n    \n    def f_func(x):\n        return C_f * np.cos(n * np.pi * x / L)\n        \n    # 2-point Gauss quadrature points and weights on [0, 1] for reference element\n    gp = np.array([0.5 - 0.5/np.sqrt(3), 0.5 + 0.5/np.sqrt(3)])\n    gw = np.array([0.5, 0.5])\n    \n    # Linear basis functions on reference element\n    def phi1(xi): return 1 - xi\n    def phi2(xi): return xi\n    \n    for i in range(N):  # Loop over elements\n        # Physical coordinates of Gauss points in element i\n        x_coords = nodes[i] + h * gp\n        \n        # Evaluate forcing function at Gauss points\n        f_vals = f_func(x_coords)\n        \n        # Integrate f*phi_1 for the i-th node\n        F_global[i] += h * np.sum(gw * f_vals * phi1(gp))\n        \n        # Integrate f*phi_2 for the (i+1)-th node\n        F_global[i+1] += h * np.sum(gw * f_vals * phi2(gp))\n\n    # 4. Assemble and solve the block system\n    A_block = np.zeros((2 * size, 2 * size))\n    B_block = np.zeros(2 * size)\n\n    # Top-left block: K + k^2 * M\n    A_block[0:size, 0:size] = K_global + (k**2) * M_global\n    # Top-right block: -s * M\n    A_block[0:size, size:] = -s * M_global\n    # Bottom-left block: -beta * M\n    A_block[size:, 0:size] = -beta * M_global\n    # Bottom-right block: M\n    A_block[size:, size:] = M_global\n    \n    # RHS vector\n    B_block[0:size] = F_global\n    \n    U_block = np.linalg.solve(A_block, B_block)\n    \n    p_h = U_block[0:size]\n\n    # 5. Calculate Error\n    p_star = np.cos(n * np.pi * nodes / L)\n    error_vec = p_h - p_star\n    \n    # Discrete L2 norm of error: sqrt(e^T * M * e)\n    l2_error_sq = error_vec.T @ M_global @ error_vec\n    l2_error = np.sqrt(l2_error_sq)\n    \n    return l2_error, h, M_global\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (L, k, n, s, beta)\n        (1.0, 7.0, 2, 0.5, 0.2),         # Test case 1\n        (1.0, 2*np.pi, 2, 1.196, 0.4),  # Test case 2\n        (1.0, 1.0, 1, 0.25, 0.1)          # Test case 3\n    ]\n    N_values = [20, 40, 80, 160]\n    \n    all_results = []\n    \n    for case_params in test_cases:\n        L, k, n, s, beta = case_params\n        errors = []\n        h_values = []\n        \n        for N in N_values:\n            error, h, _ = run_fem_simulation(L, k, n, s, beta, N)\n            errors.append(error)\n            h_values.append(h)\n    \n        # 6. Calculate Convergence Order\n        log_h = np.log(h_values)\n        log_err = np.log(errors)\n        \n        # Fit a line (degree 1 polynomial) to the log-log data\n        # np.polyfit returns [slope, intercept]\n        # The slope is the empirical order of convergence.\n        order, _ = np.polyfit(log_h, log_err, 1)\n        \n        case_result = errors + [order]\n        all_results.append(case_result)\n        \n    # Format the final output string as specified\n    # Example: [[err1,err2,err3,err4,rate1],[err5,err6,...]]\n    inner_lists_str = []\n    for res_list in all_results:\n        inner_str = f\"[{','.join(map(str, res_list))}]\"\n        inner_lists_str.append(inner_str)\n    \n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}