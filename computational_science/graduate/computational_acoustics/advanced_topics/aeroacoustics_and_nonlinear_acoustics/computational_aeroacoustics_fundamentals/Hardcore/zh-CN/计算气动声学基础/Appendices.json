{
    "hands_on_practices": [
        {
            "introduction": "计算航空声学的基础始于对声波物理本质的深刻理解。本练习将引导你回归第一性原理，从流体动力学的基本守恒定律出发，推导出描述声学扰动的线性波动方程。通过这个实践，你不仅将巩固声波的物理起源，还将验证声速 $c_0$ 与介质热力学性质之间的基本关系 $c_0^2 = (\\partial p / \\partial \\rho)_s$，这是任何声学模拟的基石 。",
            "id": "4118565",
            "problem": "在计算气动声学（CAA）框架下，考虑无粘性可压缩理想气体中的小振幅一维声学扰动。基态是均匀且静止的，其压力为 $p_0$，密度为 $\\rho_0$，速度为 $u_0=0$。流体是理想气体，其定比热容比 $\\gamma$ 为常数。假设扰动是等熵的。从无粘性可压缩流的质量和动量守恒方程出发，结合等熵热力学封闭关系，推导声场的线性波动方程，并根据在基态下求值的等熵热力学导数 $\\left(\\partial p / \\partial \\rho\\right)_s$ 求出传播速度 $c_0$。然后，仅使用理想气体定律和等熵条件，计算理想气体的 $\\left(\\partial p / \\partial \\rho\\right)_s$（用 $\\gamma$、$p$ 和 $\\rho$ 表示），并将其应用于基态。最后，根据给定的基态数据 $p_0=101325$ Pa，$\\rho_0=1.225$ kg/m$^3$ 和 $\\gamma=1.4$，计算等熵声速 $c_0$ 的数值。将最终的 $c_0$ 数值答案以 m/s 为单位表示，并四舍五入到四位有效数字。除了计算，推导过程必须明确论证为什么等熵声速等于在基态下求值的等熵热力学导数的平方根，从而验证对于这种理想气体情况，$c_0^2=\\left(\\partial p / \\partial \\rho\\right)_s$ 成立。",
            "solution": "该问题要求推导静止理想气体中一维等熵扰动的线性声波方程，确定声速，对理想气体的声速进行热力学评估，最后进行数值计算。该问题具有科学依据，提法明确且完整。\n\n分析始于无粘性可压缩流体的一维欧拉方程，它们代表了质量和动量守恒。\n\n质量守恒（连续性方程）：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0\n$$\n\n动量守恒：\n$$\n\\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0\n$$\n\n此处，$\\rho$ 是流体密度，$u$ 是流体速度，$p$ 是压力，$t$ 是时间，$x$ 是空间坐标。\n\n我们考虑在均匀、静止介质中传播的小振幅声学扰动。流动变量被分解为一个恒定的基态（下标为 $0$）和一个微小的、波动的声学扰动（带撇号的量）：\n$$\n\\rho(x,t) = \\rho_0 + \\rho'(x,t)\n$$\n$$\np(x,t) = p_0 + p'(x,t)\n$$\n$$\nu(x,t) = u_0 + u'(x,t) = u'(x,t) \\quad (\\text{因为基流是静止的，} u_0 = 0)\n$$\n假设扰动很小，即 $|\\rho'| \\ll \\rho_0$，$|p'| \\ll p_0$ 且 $|u'|$ 很小。我们将这些表达式代入欧拉方程，并忽略所有扰动量的二阶或更高阶项（例如 $\\rho'u'$，$u'^2$）。\n\n连续性方程的线性化：\n$$\n\\frac{\\partial (\\rho_0 + \\rho')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial x} = 0\n$$\n省略二阶项 $\\rho' u'$，我们得到线性化的连续性方程：\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n\\quad (1)\n$$\n\n动量方程的线性化：\n$$\n\\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') u'^2 + p_0 + p')}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial t} + \\frac{\\partial (\\rho_0 u'^2 + \\rho' u'^2 + p')}{\\partial x} = 0\n$$\n省略二阶项 $\\rho'u'$ 和 $(\\rho_0+\\rho')u'^2$，我们得到线性化的动量方程：\n$$\n\\rho_0 \\frac{\\partial u'}{\\partial t} + \\frac{\\partial p'}{\\partial x} = 0\n\\quad (2)\n$$\n\n该系统需要一个连接热力学变量的封闭关系。问题陈述扰动是等熵的。这意味着在恒定熵 $s$ 下存在函数关系 $p = p(\\rho)$。对于基态 $(\\rho_0, p_0)$ 附近的小扰动，我们可以使用一阶泰勒级数展开：\n$$\np' = p - p_0 \\approx \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0} (\\rho - \\rho_0) = \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0} \\rho'\n$$\n下标 $s$ 表示该导数是在恒定熵下求得的。我们将这个常数系数定义为 $c_0^2$，其单位是速度的平方：\n$$\nc_0^2 \\equiv \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0}\n$$\n因此，线性声学的等熵封闭关系是：\n$$\np' = c_0^2 \\rho'\n\\quad (3)\n$$\n\n现在，我们推导波动方程。我们试图将方程 $(1)$、$(2)$ 和 $(3)$ 结合起来，得到一个关于某个扰动变量的单一方程。让我们推导关于压力扰动 $p'$ 的方程。\n\n首先，对方程 $(2)$ 对 $x$ 求导：\n$$\n\\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} + \\frac{\\partial^2 p'}{\\partial x^2} = 0\n\\quad (4)\n$$\n接下来，使用方程 $(3)$ 将 $\\rho'$ 表示为 $p'/c_0^2$。将其代入方程 $(1)$：\n$$\n\\frac{\\partial}{\\partial t} \\left(\\frac{p'}{c_0^2}\\right) + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n由于 $c_0^2$ 和 $\\rho_0$ 是常数：\n$$\n\\frac{1}{c_0^2} \\frac{\\partial p'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\n现在，将此方程对 $t$ 求导：\n$$\n\\frac{1}{c_0^2} \\frac{\\partial^2 p'}{\\partial t^2} + \\rho_0 \\frac{\\partial^2 u'}{\\partial t \\partial x} = 0\n\\quad (5)\n$$\n从方程 $(4)$，我们可以将混合导数项表示为 $\\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} = -\\frac{\\partial^2 p'}{\\partial x^2}$。将其代入方程 $(5)$ 得到：\n$$\n\\frac{1}{c_0^2} \\frac{\\partial^2 p'}{\\partial t^2} - \\frac{\\partial^2 p'}{\\partial x^2} = 0\n$$\n整理后得到一维线性波动方程：\n$$\n\\frac{\\partial^2 p'}{\\partial t^2} = c_0^2 \\frac{\\partial^2 p'}{\\partial x^2}\n$$\n这个推导明确地表明，代表扰动传播速度的参数 $c_0$ 由我们定义为 $c_0^2$ 的量的平方根给出。因此，声速等于等熵热力学导数的平方根这一论证得到了证实：$c_0^2 = (\\partial p / \\partial \\rho)_s$ 在基态下求值。\n\n接下来，我们计算理想气体的这个导数。对于理想气体中的等熵过程，压力和密度通过 $p_0/\\rho_0^\\gamma = p/\\rho^\\gamma = K$ 相关联，其中对于给定的熵态，$K$ 是一个常数，$\\gamma$ 是定比热容比。这给出了关系 $p = K\\rho^\\gamma$。我们现在计算所需的偏导数：\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s = \\frac{d}{d\\rho} (K\\rho^\\gamma) = K \\gamma \\rho^{\\gamma-1}\n$$\n将常数 $K = p/\\rho^\\gamma$ 的表达式代回：\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s = \\left( \\frac{p}{\\rho^\\gamma} \\right) \\gamma \\rho^{\\gamma-1} = \\frac{\\gamma p}{\\rho}\n$$\n这是理想气体的一般表达式。为了求出静止基态下的声速 $c_0$，我们在 $p=p_0$ 和 $\\rho=\\rho_0$ 处计算这个导数：\n$$\nc_0^2 = \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0} = \\frac{\\gamma p_0}{\\rho_0}\n$$\n因此，理想气体的等熵声速是：\n$$\nc_0 = \\sqrt{\\frac{\\gamma p_0}{\\rho_0}}\n$$\n\n最后，我们使用给定的基态数据 $p_0 = 101325$ Pa，$\\rho_0 = 1.225$ kg/m$^3$ 和 $\\gamma = 1.4$ 计算 $c_0$ 的数值。\n$$\nc_0 = \\sqrt{\\frac{1.4 \\times 101325}{1.225}}\n$$\n$$\nc_0 = \\sqrt{\\frac{141855}{1.225}} = \\sqrt{115800} \\approx 340.29399 \\text{ m/s}\n$$\n按照要求将结果四舍五入到四位有效数字，得到：\n$$\nc_0 \\approx 340.3 \\text{ m/s}\n$$",
            "answer": "$$\\boxed{340.3}$$"
        },
        {
            "introduction": "在理解了声波在自由场中的传播之后，下一个关键步骤是分析其与边界的相互作用，这在真实的工程问题中无处不在。本练习探讨了一个经典场景：平面声波垂直入射到一个声阻抗边界上。通过推导反射系数 $R$，你将深入了解如何通过边界条件来模拟材料的声学特性，并掌握分析声波反射、吸收以及刚性壁和压力释放等极限情况的核心技能 。",
            "id": "4118601",
            "problem": "考虑一个来自计算航空声学 (CAA) 基础的一维线性声学问题。一个具有平衡密度 $\\rho_0$ 和声速 $c_0$ 的均匀、静止介质占据了半空间 $x > 0$。一束时谐平面声波从 $x > 0$ 一侧正入射到位于 $x = 0$ 处的平面边界。该边界施加了一个线性阻抗条件，将 $x=0$ 处的声压脉动 $p'(0,t)$ 和法向速度脉动 $u_n'(0,t)$ 关联起来，关系式为 $p'(0,t) = Z \\, u_n'(0,t)$，其中 $Z$ 是一个复数的、与频率相关的声阻抗。假设扰动为小振幅，并忽略平均流的影响。\n\n使用线性化 Euler 方程和一个与控制方程一致的平面波拟设，推導复压反射系数 $R$，该系数定义为边界处反射波与入射波压力相量振幅之比 $R = \\hat{p}_r / \\hat{p}_i$，并用 $Z$、$\\rho_0$ 和 $c_0$ 表示。清楚地说明您为确定入射波和反射波的压力-速度关系符号所使用的波传播方向假设。然后，讨论在以下几种物理上相关的情况下 $R$ 的极限行为：$Z = \\rho_0 c_0$（阻抗匹配边界）、$Z \\to 0$（压力释放边界）、$Z \\to \\infty$（刚性边界）以及纯电抗性阻抗 $Z = \\mathrm{i} X$（其中 $X$ 为实数且 $X \\neq 0$）。最终答案必须是 $R$ 的闭式表达式。反射系数是无量纲的；不要包含单位。无需进行四舍五入。",
            "solution": "本题要求推导一个平面声波入射到具有特定声阻抗的边界上时的复压反射系数。推导从均匀、静止介质的一维线性化 Euler 方程开始。\n\n首先，我们为时谐平面波建立一个约定。设时间依赖性为 $\\exp(-\\mathrm{i}\\omega t)$。对于此约定，沿 $+x$ 方向传播的波具有空间依赖性 $\\exp(\\mathrm{i}kx)$，而沿 $-x$ 方向传播的波具有空间依赖性 $\\exp(-\\mathrm{i}kx)$，其中 $k=\\omega/c_0$ 是波数。\n\n问题设定介质在 $x > 0$ 区域，声波从该区域入射到位于 $x=0$ 的边界。因此，入射波沿 $-x$ 方向传播，而反射波沿 $+x$ 方向传播。总声场可以表示为入射波 ($p'_i$) 和反射波 ($p'_r$) 的叠加。它们的压力相量为：\n$$\n\\hat{p}(x) = \\hat{p}_i(x) + \\hat{p}_r(x) = \\hat{p}_i \\exp(-\\mathrm{i}kx) + \\hat{p}_r \\exp(\\mathrm{i}kx)\n$$\n其中 $\\hat{p}_i$ 和 $\\hat{p}_r$ 是在 $x=0$ 处的复振幅。\n\n接下来，我们从线性化动量方程 $\\rho_0 \\partial u'/\\partial t = -\\partial p'/\\partial x$ 推导每个波分量的速度。对于相量形式，该方程为 $-\\mathrm{i}\\omega\\rho_0 \\hat{u} = -d\\hat{p}/dx$。\n\n对于入射波（沿 $-x$ 方向）：\n$d\\hat{p}_i(x)/dx = -\\mathrm{i}k \\hat{p}_i(x)$。\n因此，$\\hat{u}_i(x) = \\frac{-1}{-\\mathrm{i}\\omega\\rho_0} (-\\mathrm{i}k \\hat{p}_i(x)) = -\\frac{k}{\\omega\\rho_0} \\hat{p}_i(x) = -\\frac{1}{\\rho_0 c_0} \\hat{p}_i(x)$。\n这给出了正确的压力-速度关系 $\\hat{p}_i(x) = -\\rho_0 c_0 \\hat{u}_i(x)$。\n\n对于反射波（沿 $+x$ 方向）：\n$d\\hat{p}_r(x)/dx = \\mathrm{i}k \\hat{p}_r(x)$。\n因此，$\\hat{u}_r(x) = \\frac{-1}{-\\mathrm{i}\\omega\\rho_0} (\\mathrm{i}k \\hat{p}_r(x)) = \\frac{k}{\\omega\\rho_0} \\hat{p}_r(x) = \\frac{1}{\\rho_0 c_0} \\hat{p}_r(x)$。\n这给出了正确的压力-速度关系 $\\hat{p}_r(x) = \\rho_0 c_0 \\hat{u}_r(x)$。\n\n总速度相量是 $\\hat{u}(x) = \\hat{u}_i(x) + \\hat{u}_r(x)$。在边界 $x=0$ 处，总压力和速度为：\n$$\n\\hat{p}(0) = \\hat{p}_i + \\hat{p}_r\n$$\n$$\n\\hat{u}(0) = \\hat{u}_i(0) + \\hat{u}_r(0) = -\\frac{\\hat{p}_i}{\\rho_0 c_0} + \\frac{\\hat{p}_r}{\\rho_0 c_0}\n$$\n边界条件为 $p'(0,t) = Z \\, u_n'(0,t)$。流体域为 $x>0$，因此在边界 $x=0$ 处指向流体域外部的法线向量为 $\\mathbf{n} = -\\mathbf{e}_x$。法向速度 $u_n'$ 是速度矢量 $\\mathbf{u}' = u'\\mathbf{e}_x$ 在法线方向上的投影：$u_n' = \\mathbf{u}' \\cdot \\mathbf{n} = -u'$。因此，边界条件变为 $p'(0,t) = -Z \\, u'(0,t)$，其相量形式为：\n$$\n\\hat{p}(0) = -Z \\hat{u}(0)\n$$\n代入 $x=0$ 处的总压力和速度表达式：\n$$\n\\hat{p}_i + \\hat{p}_r = -Z \\left( -\\frac{\\hat{p}_i}{\\rho_0 c_0} + \\frac{\\hat{p}_r}{\\rho_0 c_0} \\right) = \\frac{Z}{\\rho_0 c_0} \\hat{p}_i - \\frac{Z}{\\rho_0 c_0} \\hat{p}_r\n$$\n我们要求解反射系数 $R = \\hat{p}_r / \\hat{p}_i$。将方程两边同除以 $\\hat{p}_i$：\n$$\n1 + R = \\frac{Z}{\\rho_0 c_0} - \\frac{Z}{\\rho_0 c_0} R\n$$\n整理后求解 $R$：\n$$\nR \\left(1 + \\frac{Z}{\\rho_0 c_0}\\right) = \\frac{Z}{\\rho_0 c_0} - 1\n$$\n$$\nR \\left(\\frac{\\rho_0 c_0 + Z}{\\rho_0 c_0}\\right) = \\frac{Z - \\rho_0 c_0}{\\rho_0 c_0}\n$$\n$$\nR = \\frac{Z - \\rho_0 c_0}{Z + \\rho_0 c_0}\n$$\n这就是复压反射系数。项 $\\rho_0 c_0$ 是介质的特性声阻抗。\n\n现在，我们分析极限情况：\n1.  **阻抗匹配边界 ($Z = \\rho_0 c_0$):**\n    $R = \\frac{\\rho_0 c_0 - \\rho_0 c_0}{\\rho_0 c_0 + \\rho_0 c_0} = \\frac{0}{2\\rho_0 c_0} = 0$。没有反射。边界完全吸收了入射波，因为其阻抗与介质的特性阻抗相同。\n\n2.  **压力释放边界 ($Z \\to 0$):**\n    $R = \\frac{0 - \\rho_0 c_0}{0 + \\rho_0 c_0} = -1$。这对应于全反射，且压力波发生相位反转。边界上的总压力为 $\\hat{p}(0) = \\hat{p}_i(1+R) = \\hat{p}_i(1-1) = 0$，这定义了一个“软”墙。\n\n3.  **刚性边界 ($Z \\to \\infty$):**\n    为计算此极限，我们将分子和分母同除以 $Z$：\n    $R = \\frac{1 - (\\rho_0 c_0)/Z}{1 + (\\rho_0 c_0)/Z}$。\n    当 $Z \\to \\infty$时，项 $(\\rho_0 c_0)/Z \\to 0$，因此 $R \\to \\frac{1-0}{1+0} = 1$。这对应于全反射，且压力波没有相位变化。边界处的法向速度为 $\\hat{u}_n(0) = \\hat{p}(0)/Z \\to 0$，这定义了一个“硬”墙。\n\n4.  **纯电抗性阻抗 ($Z = \\mathrm{i}X$，其中 $X$ 为实数且 $X \\neq 0$):**\n    $R = \\frac{\\mathrm{i}X - \\rho_0 c_0}{\\mathrm{i}X + \\rho_0 c_0}$。\n    反射系数的模为 $|R| = \\frac{|\\mathrm{i}X - \\rho_0 c_0|}{|\\mathrm{i}X + \\rho_0 c_0|} = \\frac{\\sqrt{X^2 + (-\\rho_0 c_0)^2}}{\\sqrt{X^2 + (\\rho_0 c_0)^2}} = 1$。\n    由于 $|R|=1$，波被完全反射。纯电抗性阻抗不耗散能量；它只储存和释放能量，导致反射波发生相移。相移由 $\\arg(R)$ 给出，它不同于 $0$ 或 $\\pi$（除非 $X=0$ 或 $X \\to \\infty$）。这代表一个无损边界。",
            "answer": "$$\n\\boxed{\\frac{Z - \\rho_0 c_0}{Z + \\rho_0 c_0}}\n$$"
        },
        {
            "introduction": "计算航空声学的核心挑战在于如何在计算机上精确地求解声学波动方程，而数值色散是其中最关键的障碍之一，它会导致不同频率的波在模拟中以错误的速度传播。这个实践练习要求你编写一个程序，以量化和比较不同数值格式（空间差分和时间积分）的色散误差。通过亲手实现这一分析过程，你将获得评估和选择适用于高保真度航空声学模拟算法的宝贵实践经验 。",
            "id": "4118552",
            "problem": "考虑一个由线性平流方程 $\\partial u/\\partial t + c_0 \\,\\partial u/\\partial x = 0$ 表示的一维线性声学传播模型，其中 $u(x,t)$ 是一个标量扰动，$c_0$ 是恒定的声速。计算航空声学（CAA, Computational Aeroacoustics）的基础理论通常通过平面波分析来评估数值格式的数值色散。设无量纲波数为 $\\theta = k\\,\\Delta x$，其中 $k$ 是物理波数，$\\Delta x$ 是网格间距。对于一个离散的有限差分空间导数和一个时间积分器，离散傅里叶分析得出一个由空间模板决定的修正波数 $k^*(\\theta) = \\alpha(\\theta)/\\Delta x$，以及一个由时间积分器决定的每时间步的放大因子 $G(\\theta)$。数值角频率 $\\omega(\\theta)$ 使用复数辐角的主值由 $G(\\theta) = \\exp(-\\mathrm{i}\\,\\omega(\\theta)\\,\\Delta t)$ 定义，数值相速度为 $c_{\\text{num}}(\\theta) = \\omega(\\theta)/k^*(\\theta)$。我们感兴趣的量是相对相速度误差 $e(\\theta) = c_{\\text{num}}(\\theta)/c_0 - 1$，表示为一个无量纲的小数。\n\n从线性平流方程出发，在均匀网格 $x_j = j\\,\\Delta x$ 上使用平面波拟设 $u_j^n = \\exp(\\mathrm{i}\\,(j\\,\\theta - n\\,\\omega\\,\\Delta t))$，推导组合中心有限差分空间格式和显式 Runge–Kutta 时间积分器的半离散和全离散色散关系。使用以下中心有限差分一阶导数模板及其对应的无量纲修正波数函数 $\\alpha(\\theta)$：\n\n- 二阶中心差分 ($p=2$): $\\alpha_{2}(\\theta) = \\sin(\\theta)$。\n- 四阶中心差分 ($p=4$): $\\alpha_{4}(\\theta) = \\dfrac{8\\,\\sin(\\theta) - \\sin(2\\theta)}{6}$。\n- 六阶中心差分 ($p=6$): $\\alpha_{6}(\\theta) = \\dfrac{45\\,\\sin(\\theta) - 9\\,\\sin(2\\theta) + \\sin(3\\theta)}{30}$。\n\n设 Courant–Friedrichs–Lewy 数为 $\\lambda = c_0\\,\\Delta t/\\Delta x$，并设 $z(\\theta) = -\\mathrm{i}\\,\\lambda\\,\\alpha(\\theta)$。对于显式 Runge–Kutta 时间积分器，使用它们在 $z(\\theta)$ 处求值的稳定性多项式 $R(z)$：\n- 二阶 Runge–Kutta (Heun 法, $s=2$): $R_{2}(z) = 1 + z + \\dfrac{z^2}{2}$。\n- 经典四阶 Runge–Kutta ($s=4$): $R_{4}(z) = 1 + z + \\dfrac{z^2}{2} + \\dfrac{z^3}{6} + \\dfrac{z^4}{24}$。\n\n定义 $G(\\theta) = R_{s}(z(\\theta))$，使用在 $(-\\pi,\\pi]$ 区间内的辐角主值取 $\\omega(\\theta) = -\\mathrm{arg}(G(\\theta))/\\Delta t$，并用 $k^*(\\theta) = \\alpha(\\theta)/\\Delta x$ 计算 $c_{\\text{num}}(\\theta) = \\omega(\\theta)/k^*(\\theta)$。相对相速度误差为 $e(\\theta) = c_{\\text{num}}(\\theta)/c_0 - 1$。为避免除以零，仅在 $\\alpha(\\theta) \\neq 0$ 的地方计算 $\\theta$（不包括 $\\theta=0$ 和 $\\theta=\\pi$）。\n\n你的任务是编写一个完整、可运行的程序，该程序：\n1. 实现上述分析，在 $\\theta \\in (\\varepsilon,\\pi-\\varepsilon)$ (其中 $\\varepsilon = 10^{-6}$) 的密集采样上计算 $e(\\theta)$，使用 $N=4096$ 个均匀间隔的样本。\n2. 对下面的每个测试用例，从 $e(\\theta)$ 计算三个标量指标：\n   - $E_{\\max} = \\max_{\\theta} |e(\\theta)|$，\n   - $E_{\\text{mid}} = e(\\pi/3)$，\n   - $E_{\\mathrm{rms}} = \\sqrt{\\dfrac{1}{M}\\sum_{m=1}^{M} e(\\theta_m)^2}$，其中 $\\{\\theta_m\\}$ 是采样集合，$M=N$。\n3. 生成单行输出，其中包含所有测试用例的所有结果，格式为方括号内以逗号分隔的列表，顺序如下文所述。所有输出均为无量纲的小数。\n\n除非另有说明，所有情况均使用以下物理和数值参数：\n- 声速 $c_0 = 340$ $\\mathrm{m/s}$。\n- 网格间距 $\\Delta x = 10^{-3}$ $\\mathrm{m}$。\n- 时间步长 $\\Delta t$ 由指定的 $\\lambda$ 通过 $\\Delta t = \\lambda\\,\\Delta x/c_0$ 设置。\n\n测试套件（每个用例指定为 $(p,s,\\lambda)$）：\n- 用例 1: $(2,2,0.3)$。\n- 用例 2: $(4,4,0.5)$。\n- 用例 3: $(6,4,0.9)$。\n- 用例 4: $(4,2,0.9)$。\n- 用例 5: $(6,4,0.05)$。\n\n你的程序应生成一行输出，其中按以下顺序包含结果：\n$[E_{\\max}^{(1)},E_{\\text{mid}}^{(1)},E_{\\mathrm{rms}}^{(1)},E_{\\max}^{(2)},E_{\\text{mid}}^{(2)},E_{\\mathrm{rms}}^{(2)},E_{\\max}^{(3)},E_{\\text{mid}}^{(3)},E_{\\mathrm{rms}}^{(3)},E_{\\max}^{(4)},E_{\\text{mid}}^{(4)},E_{\\mathrm{rms}}^{(4)},E_{\\max}^{(5)},E_{\\text{mid}}^{(5)},E_{\\mathrm{rms}}^{(5)}]$，其中上标表示用例索引。每个条目必须是使用 Python 默认格式打印的浮点数，并且所有值都是无量纲的小数。",
            "solution": "该问题要求对一维线性平流方程 $\\partial u/\\partial t + c_0 \\,\\partial u/\\partial x = 0$ 的几种有限差分和时间积分格式进行数值色散分析。目标是计算相对相速度误差 $e(\\theta)$，并为空间和时间格式的几种组合推导出特定的度量指标。该分析基于平面波解在离散网格上的行为。\n\n首先，我们建立理论框架。控制方程模拟了以恒定相速度 $c_0$ 传播的波。我们用均匀网格 $x_j = j\\,\\Delta x$ 离散化空间域，用时间步长 $t_n = n\\,\\Delta t$ 离散化时间域。网格点上的解表示为 $u_j^n = u(x_j, t_n)$。我们采用平面波拟设（一种傅里叶模式的离散形式）来分析单个波数分量的行为：\n$$\nu_j^n = \\hat{u}(k) \\exp(\\mathrm{i}(k x_j - \\omega t_n)) = \\hat{u}(k) \\exp(\\mathrm{i}(k j \\Delta x - \\omega n \\Delta t))\n$$\n在此表达式中，$k$ 是物理波数，$\\omega = k c_0$ 是精确角频率。我们引入无量纲波数 $\\theta = k\\,\\Delta x$。\n\n第一步是半离散化，其中空间导数 $\\partial u/\\partial x$ 被有限差分近似（我们将其表示为 $\\delta_x u_j$）所取代。这将偏微分方程 (PDE) 转化为常微分方程组 (ODEs)：\n$$\n\\frac{d u_j}{d t} + c_0 (\\delta_x u_j) = 0\n$$\n对于一个 $p$ 阶中心有限差分格式，其对平面波 $e^{\\mathrm{i} j \\theta}$ 的作用等效于乘以一个因子 $\\mathrm{i} k^*(\\theta) = \\mathrm{i}\\alpha_p(\\theta)/\\Delta x$。函数 $\\alpha_p(\\theta)$ 是从差分算子的泰勒级数展开中导出的。问题为无量纲修正波数 $\\alpha(\\theta)$ 提供了以下函数：\n- 对于 $p=2$: $\\alpha_{2}(\\theta) = \\sin(\\theta)$\n- 对于 $p=4$: $\\alpha_{4}(\\theta) = \\dfrac{8\\,\\sin(\\theta) - \\sin(2\\theta)}{6}$\n- 对于 $p=6$: $\\alpha_{6}(\\theta) = \\dfrac{45\\,\\sin(\\theta) - 9\\,\\sin(2\\theta) + \\sin(3\\theta)}{30}$\n\n将平面波和差分算子代入半离散方程，得到一个关于给定波数下随时间变化的振幅 $\\hat{u}(t)$ 的常微分方程：\n$$\n\\frac{d \\hat{u}}{dt} + c_0 \\left( \\frac{\\mathrm{i}\\alpha(\\theta)}{\\Delta x} \\right) \\hat{u} = 0\n$$\n下一步是全离散化，即使用数值时间积分格式求解此常微分方程。对于应用于 $\\frac{dy}{dt} = \\Lambda y$ 形式方程的显式 $s$ 级 Runge–Kutta 方法，一个时间步长 $\\Delta t$ 后的解由 $y^{n+1} = R_s(\\Lambda \\Delta t) y^n$ 给出，其中 $R_s(z)$ 是该方法的稳定性多项式。在我们的例子中，特征值为 $\\Lambda = -c_0 \\mathrm{i}\\alpha(\\theta)/\\Delta x$。因此，稳定性多项式的自变量为：\n$$\nz(\\theta) = \\Lambda \\Delta t = - \\frac{\\mathrm{i} c_0 \\alpha(\\theta)}{\\Delta x} \\Delta t = -\\mathrm{i} \\alpha(\\theta) \\frac{c_0 \\Delta t}{\\Delta x}\n$$\n定义 Courant–Friedrichs–Lewy (CFL) 数为 $\\lambda = c_0\\,\\Delta t/\\Delta x$，我们得到 $z(\\theta) = -\\mathrm{i}\\,\\lambda\\,\\alpha(\\theta)$。数值解随时间推进的方式为 $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^n$，其中放大因子 $G(\\theta)$ 由稳定性多项式在 $z(\\theta)$ 处的值给出：\n$$\nG(\\theta) = R_s(z(\\theta))\n$$\n问题提供了二阶 ($s=2$) 和四阶 ($s=4$) Runge–Kutta 方法的稳定性多项式：\n- $R_{2}(z) = 1 + z + \\dfrac{z^2}{2}$\n- $R_{4}(z) = 1 + z + \\dfrac{z^2}{2} + \\dfrac{z^3}{6} + \\dfrac{z^4}{24}$\n\n$n$ 步后的数值解为 $u_j^n \\propto \\exp(\\mathrm{i} j\\theta) (G(\\theta))^n$。为了分析其相位行为，我们定义一个数值角频率 $\\omega_{\\text{num}}(\\theta)$，使得解的传播部分可以写成 $\\exp(-\\mathrm{i} \\omega_{\\text{num}} n \\Delta t)$。这需要设 $G(\\theta) = \\exp(-\\mathrm{i} \\omega_{\\text{num}} \\Delta t)$，并假设 $\\omega_{\\text{num}}$ 可以是复数。问题陈述指定只使用相位分量，通过将数值频率（在此如问题中所述记为 $\\omega(\\theta)$）定义为一个实数来实现：\n$$\n\\omega(\\theta) = -\\frac{\\mathrm{arg}(G(\\theta))}{\\Delta t}\n$$\n其中 $\\mathrm{arg}(G(\\theta))$ 是复数 $G(\\theta)$ 的辐角主值，通常在范围 $(-\\pi, \\pi]$ 内。于是，数值相速度是数值频率与修正波数的比值：\n$$\nc_{\\text{num}}(\\theta) = \\frac{\\omega(\\theta)}{k^*(\\theta)} = \\frac{-\\mathrm{arg}(G(\\theta))/\\Delta t}{\\alpha(\\theta)/\\Delta x} = \\frac{-\\mathrm{arg}(G(\\theta))}{\\alpha(\\theta)} \\frac{\\Delta x}{\\Delta t}\n$$\n我们感兴趣的量是相对相速度误差 $e(\\theta)$，定义为：\n$$\ne(\\theta) = \\frac{c_{\\text{num}}(\\theta)}{c_0} - 1 = \\left( \\frac{-\\mathrm{arg}(G(\\theta))}{\\alpha(\\theta)} \\frac{\\Delta x}{\\Delta t} \\right) \\frac{1}{c_0} - 1\n$$\n通过代入 $\\lambda = c_0 \\Delta t / \\Delta x$（这意味着 $\\frac{\\Delta x}{c_0 \\Delta t} = \\frac{1}{\\lambda}$），我们得到了误差的简化表达式：\n$$\ne(\\theta) = \\frac{-\\mathrm{arg}(G(\\theta))}{\\lambda\\,\\alpha(\\theta)} - 1 = \\frac{-\\mathrm{arg}(R_s(-\\mathrm{i}\\,\\lambda\\,\\alpha(\\theta)))}{\\lambda\\,\\alpha(\\theta)} - 1\n$$\n这个最终表达式优雅地表明，相对相速度误差仅是无量纲波数 $\\theta$、CFL 数 $\\lambda$ 以及空间($p$)和时间($s$)格式选择的函数。它与具体的物理参数 $c_0$、$\\Delta x$ 和 $\\Delta t$ 无关。\n\n计算步骤如下：\n1.  对于由 $(p, s, \\lambda)$ 给出的每个测试用例：\n2.  在区间 $(\\varepsilon, \\pi-\\varepsilon)$ (其中 $\\varepsilon=10^{-6}$) 内生成一个包含 $N=4096$ 个均匀间隔的 $\\theta$ 样本的数组。\n3.  选择相应的函数 $\\alpha_p(\\theta)$ 和稳定性多项式 $R_s(z)$。\n4.  计算 $\\alpha(\\theta)$ 的值数组。\n5.  计算复数值数组 $z(\\theta) = -\\mathrm{i}\\lambda\\alpha(\\theta)$。\n6.  计算稳定性多项式以获得放大因子数组 $G(\\theta) = R_s(z(\\theta))$。\n7.  计算 $G(\\theta)$ 数组中每个元素的辐角主值（相位）。\n8.  使用简化公式计算相对相位误差数组 $e(\\theta)$。\n9.  从 $e(\\theta)$ 数组中计算所需的三个度量指标：\n    - $E_{\\max} = \\max_{\\theta} |e(\\theta)|$。\n    - $E_{\\text{mid}} = e(\\pi/3)$，在最接近 $\\theta=\\pi/3$ 的采样点处计算。\n    - $E_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_{m=1}^{N} e(\\theta_m)^2}$。\n10. 收集所有测试用例的所有度量指标，并将其格式化为指定的输出字符串。\n\n此过程在以下 Python 程序中实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical dispersion error metrics for various finite-difference\n    and Runge-Kutta schemes applied to the 1D linear advection equation.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    N = 4096  # Number of samples for theta\n    epsilon = 1e-6  # Small offset for theta interval\n\n    # Define the nondimensional wavenumber theta\n    theta = np.linspace(epsilon, np.pi - epsilon, N)\n\n    # --- Scheme Definitions ---\n\n    # Nondimensional modified wavenumber alpha(theta) for centered finite-difference schemes\n    def alpha2(th):\n        return np.sin(th)\n\n    def alpha4(th):\n        return (8 * np.sin(th) - np.sin(2 * th)) / 6\n\n    def alpha6(th):\n        return (45 * np.sin(th) - 9 * np.sin(2 * th) + np.sin(3 * th)) / 30\n\n    alpha_funcs = {2: alpha2, 4: alpha4, 6: alpha6}\n\n    # Stability polynomials R(z) for explicit Runge-Kutta methods\n    def R2(z):\n        return 1 + z + 0.5 * z**2\n\n    def R4(z):\n        return 1 + z + 0.5 * z**2 + (1/6) * z**3 + (1/24) * z**4\n\n    R_funcs = {2: R2, 4: R4}\n\n    # --- Test Suite ---\n    test_cases = [\n        (2, 2, 0.3),  # Case 1\n        (4, 4, 0.5),  # Case 2\n        (6, 4, 0.9),  # Case 3\n        (4, 2, 0.9),  # Case 4\n        (6, 4, 0.05), # Case 5\n    ]\n\n    all_results = []\n\n    for p, s, lambda_val in test_cases:\n        # Select the appropriate functions for the current case\n        alpha_func = alpha_funcs.get(p)\n        R_func = R_funcs.get(s)\n\n        if not alpha_func or not R_func:\n            raise ValueError(f\"Invalid scheme parameters p={p} or s={s}\")\n\n        # --- Calculation of Relative Phase Speed Error e(theta) ---\n\n        # 1. Calculate alpha(theta) for the spatial scheme\n        alpha_theta = alpha_func(theta)\n\n        # 2. Calculate z(theta)\n        z_theta = -1j * lambda_val * alpha_theta\n\n        # 3. Calculate the amplification factor G(theta) using the stability polynomial\n        G_theta = R_func(z_theta)\n\n        # 4. Calculate the relative phase speed error e(theta)\n        # e(theta) = -arg(G(theta)) / (lambda * alpha(theta)) - 1\n        arg_G = np.angle(G_theta)\n        e_theta = -arg_G / (lambda_val * alpha_theta) - 1\n\n        # --- Calculation of Metrics ---\n\n        # E_max: Maximum absolute error\n        E_max = np.max(np.abs(e_theta))\n\n        # E_mid: Error at theta = pi/3\n        # Find the index of the theta sample closest to pi/3\n        mid_idx = np.abs(theta - np.pi / 3).argmin()\n        E_mid = e_theta[mid_idx]\n\n        # E_rms: Root mean square error\n        E_rms = np.sqrt(np.mean(e_theta**2))\n\n        # Append results for the current case\n        all_results.extend([E_max, E_mid, E_rms])\n\n    # --- Final Output ---\n    # Format the results as a comma-separated list in brackets\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}