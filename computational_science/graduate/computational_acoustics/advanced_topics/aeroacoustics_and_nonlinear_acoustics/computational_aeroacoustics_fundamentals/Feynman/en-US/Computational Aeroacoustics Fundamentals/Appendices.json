{
    "hands_on_practices": [
        {
            "introduction": "The foundation of aeroacoustics rests on the principles of fluid dynamics. This exercise guides you through the essential process of deriving the linear acoustic wave equation directly from the fundamental conservation laws of mass and momentum. By linearizing the Euler equations for small disturbances in a quiescent medium, you will see how the complex dynamics of a compressible fluid simplify to the familiar wave equation, and you will establish the crucial link between the propagation speed of sound, $c_0$, and the thermodynamic properties of the fluid .",
            "id": "4118565",
            "problem": "Consider small-amplitude one-dimensional acoustic disturbances in an inviscid compressible ideal gas within the framework of Computational Aeroacoustics (CAA). The base state is uniform and quiescent with pressure $p_0$, density $\\rho_0$, and velocity $u_0=0$. The fluid is an ideal gas with constant ratio of specific heats $\\gamma$. Assume isentropic disturbances. Starting from the conservation of mass and momentum for an inviscid compressible flow, together with the isentropic thermodynamic closure, derive a linear wave equation for the acoustic field and obtain the propagation speed $c_0$ in terms of the isentropic thermodynamic derivative $\\left(\\partial p / \\partial \\rho\\right)_s$ evaluated at the base state. Then, using only the ideal-gas law and the condition of constant entropy, evaluate $\\left(\\partial p / \\partial \\rho\\right)_s$ for an ideal gas in terms of $\\gamma$, $p$, and $\\rho$, and specialize it to the base state. Finally, compute the numerical value of the isentropic sound speed $c_0$ for the given base-state data $p_0=101325$ Pa, $\\rho_0=1.225$ kg/m$^3$, and $\\gamma=1.4$. Express your final numerical answer for $c_0$ in m/s and round your result to four significant figures. In addition to the computation, the derivation must explicitly justify why the isentropic sound speed equals the square root of the isentropic thermodynamic derivative evaluated at the base state, thereby verifying that $c_0^2=\\left(\\partial p / \\partial \\rho\\right)_s$ holds for this ideal-gas case.",
            "solution": "The problem requires the derivation of the linear acoustic wave equation for one-dimensional isentropic disturbances in a quiescent ideal gas, the identification of the sound speed, a thermodynamic evaluation of this speed for an ideal gas, and finally, a numerical calculation. The problem is scientifically grounded, well-posed, and complete.\n\nThe analysis begins with the one-dimensional Euler equations for an inviscid, compressible fluid, representing the conservation of mass and momentum.\n\nConservation of Mass (Continuity Equation):\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0\n$$\n\nConservation of Momentum:\n$$\n\\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0\n$$\n\nHere, $\\rho$ is the fluid density, $u$ is the fluid velocity, $p$ is the pressure, $t$ is time, and $x$ is the spatial coordinate.\n\nWe consider small-amplitude acoustic disturbances propagating through a uniform, quiescent medium. The flow variables are decomposed into a constant base state (subscript $0$) and a small, fluctuating acoustic perturbation (primed quantity):\n$$\n\\rho(x,t) = \\rho_0 + \\rho'(x,t)\n$$\n$$\np(x,t) = p_0 + p'(x,t)\n$$\n$$\nu(x,t) = u_0 + u'(x,t) = u'(x,t) \\quad (\\text{since the base flow is quiescent, } u_0 = 0)\n$$\nThe perturbations are assumed to be small, i.e., $|\\rho'| \\ll \\rho_0$, $|p'| \\ll p_0$, and $|u'|$ is small. We substitute these expressions into the Euler equations and neglect all terms that are of second order or higher in the perturbation quantities (e.g., $\\rho'u'$, $u'^2$).\n\nLinearization of the Continuity Equation:\n$$\n\\frac{\\partial (\\rho_0 + \\rho')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial x} = 0\n$$\nDropping the second-order term $\\rho' u'$, we obtain the linearized continuity equation:\n$$\n\\frac{\\partial \\rho'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n\\quad (1)\n$$\n\nLinearization of the Momentum Equation:\n$$\n\\frac{\\partial ((\\rho_0 + \\rho') u')}{\\partial t} + \\frac{\\partial ((\\rho_0 + \\rho') u'^2 + p_0 + p')}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial (\\rho_0 u' + \\rho' u')}{\\partial t} + \\frac{\\partial (\\rho_0 u'^2 + \\rho' u'^2 + p')}{\\partial x} = 0\n$$\nDropping the second-order terms $\\rho'u'$ and $(\\rho_0+\\rho')u'^2$, we obtain the linearized momentum equation:\n$$\n\\rho_0 \\frac{\\partial u'}{\\partial t} + \\frac{\\partial p'}{\\partial x} = 0\n\\quad (2)\n$$\n\nThe system requires a closure relation connecting the thermodynamic variables. The problem states that the disturbances are isentropic. This implies a functional relationship $p = p(\\rho)$ at constant entropy $s$. For small perturbations around the base state $(\\rho_0, p_0)$, we can use a first-order Taylor series expansion:\n$$\np' = p - p_0 \\approx \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0} (\\rho - \\rho_0) = \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0} \\rho'\n$$\nThe subscript $s$ denotes that the derivative is taken at constant entropy. We define the constant coefficient, which has units of velocity squared, as $c_0^2$:\n$$\nc_0^2 \\equiv \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0}\n$$\nThus, the isentropic closure relation for linear acoustics is:\n$$\np' = c_0^2 \\rho'\n\\quad (3)\n$$\n\nNow, we derive the wave equation. We seek to combine equations $(1)$, $(2)$, and $(3)$ to obtain a single equation for one of the perturbation variables. Let us derive the equation for the pressure perturbation $p'$.\n\nFirst, differentiate equation $(2)$ with respect to $x$:\n$$\n\\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} + \\frac{\\partial^2 p'}{\\partial x^2} = 0\n\\quad (4)\n$$\nNext, use equation $(3)$ to express $\\rho'$ in terms of $p'$ as $\\rho' = p'/c_0^2$. Substitute this into equation $(1)$:\n$$\n\\frac{\\partial}{\\partial t} \\left(\\frac{p'}{c_0^2}\\right) + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\nSince $c_0^2$ and $\\rho_0$ are constants:\n$$\n\\frac{1}{c_0^2} \\frac{\\partial p'}{\\partial t} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0\n$$\nNow, differentiate this equation with respect to $t$:\n$$\n\\frac{1}{c_0^2} \\frac{\\partial^2 p'}{\\partial t^2} + \\rho_0 \\frac{\\partial^2 u'}{\\partial t \\partial x} = 0\n\\quad (5)\n$$\nFrom equation $(4)$, we can express the mixed derivative term as $\\rho_0 \\frac{\\partial^2 u'}{\\partial x \\partial t} = -\\frac{\\partial^2 p'}{\\partial x^2}$. Substituting this into equation $(5)$ yields:\n$$\n\\frac{1}{c_0^2} \\frac{\\partial^2 p'}{\\partial t^2} - \\frac{\\partial^2 p'}{\\partial x^2} = 0\n$$\nRearranging gives the one-dimensional linear wave equation:\n$$\n\\frac{\\partial^2 p'}{\\partial t^2} = c_0^2 \\frac{\\partial^2 p'}{\\partial x^2}\n$$\nThis derivation explicitly demonstrates that the parameter $c_0$, which represents the propagation speed of the disturbances, is given by the square root of the quantity we defined as $c_0^2$. Therefore, the justification for the sound speed being the square root of the isentropic thermodynamic derivative is confirmed: $c_0^2 = (\\partial p / \\partial \\rho)_s$ evaluated at the base state.\n\nNext, we evaluate this derivative for an ideal gas. For an isentropic process in an ideal gas, the pressure and density are related by $p_0/\\rho_0^\\gamma = p/\\rho^\\gamma = K$, where $K$ is a constant for a given entropic state and $\\gamma$ is the ratio of specific heats. This gives the relation $p = K\\rho^\\gamma$. We now compute the required partial derivative:\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s = \\frac{d}{d\\rho} (K\\rho^\\gamma) = K \\gamma \\rho^{\\gamma-1}\n$$\nSubstitute back the expression for the constant $K = p/\\rho^\\gamma$:\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s = \\left( \\frac{p}{\\rho^\\gamma} \\right) \\gamma \\rho^{\\gamma-1} = \\frac{\\gamma p}{\\rho}\n$$\nThis is the general expression for an ideal gas. To find the sound speed $c_0$ in the quiescent base state, we evaluate this derivative at $p=p_0$ and $\\rho=\\rho_0$:\n$$\nc_0^2 = \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s \\bigg|_{\\rho_0} = \\frac{\\gamma p_0}{\\rho_0}\n$$\nTherefore, the isentropic sound speed for an ideal gas is:\n$$\nc_0 = \\sqrt{\\frac{\\gamma p_0}{\\rho_0}}\n$$\n\nFinally, we compute the numerical value for $c_0$ using the provided base-state data: $p_0 = 101325$ Pa, $\\rho_0 = 1.225$ kg/m$^3$, and $\\gamma = 1.4$.\n$$\nc_0 = \\sqrt{\\frac{1.4 \\times 101325}{1.225}}\n$$\n$$\nc_0 = \\sqrt{\\frac{141855}{1.225}} = \\sqrt{115800} \\approx 340.29399 \\text{ m/s}\n$$\nRounding the result to four significant figures as requested gives:\n$$\nc_0 \\approx 340.3 \\text{ m/s}\n$$",
            "answer": "$$\\boxed{340.3}$$"
        },
        {
            "introduction": "Once we have an equation for how sound propagates, the next question is what generates it. This practice explores the fundamental nature of compact aeroacoustic sources using the multipole expansion, a powerful tool for characterizing the radiation from sources that are small compared to the acoustic wavelength. By deriving the distinct far-field directivity patterns for an acoustic dipole and quadrupole, you will gain physical insight into how different types of fluid motion generate unique sound fields, a concept central to all of aeroacoustics .",
            "id": "4118586",
            "problem": "Consider a homogeneous, quiescent fluid of constant density $\\rho_0$ and sound speed $c_0$. Let $(r,\\theta,\\phi)$ denote spherical coordinates with unit observation vector $\\mathbf{n} = (\\sin\\theta\\cos\\phi,\\sin\\theta\\sin\\phi,\\cos\\theta)$ and $\\theta$ measured from the $+z$ axis. In the frequency domain at angular frequency $\\omega$, the acoustic pressure amplitude $p(\\mathbf{x})$ produced by a compact time-harmonic source with spatial support confined to a ball of radius $a$ centered at the origin, with $k a \\ll 1$ where $k = \\omega/c_0$, satisfies the inhomogeneous Helmholtz equation with free-space radiation conditions. Using as a starting point the linear wave equation and the free-space Green’s function, and relying only on the far-field ($r \\to \\infty$) compact-source ($k a \\ll 1$) multipole expansion of the Green’s representation integral, derive the normalized far-field directivity functions for the following two sources, both aligned with the $z$ axis and located at the origin:\n\n- A pure compact dipole with vanishing monopole moment and nonzero first spatial moment vector aligned with $+z$.\n\n- A pure compact axisymmetric, traceless quadrupole with principal axis along $z$, whose second spatial moment tensor is proportional to $\\mathrm{diag}(-\\tfrac{1}{2},-\\tfrac{1}{2},1)$.\n\nDefine the normalized far-field directivity $D(\\theta,\\phi)$ as the real angular factor multiplying the leading-order asymptotic $r^{-1}\\exp(i k r)$ amplitude after removal of all source-strength, frequency, and dimensional prefactors, and normalize such that the maximum magnitude over all angles is $1$. Express your results explicitly in terms of $\\theta$ and $\\phi$.\n\nYour final answer must be a single row matrix containing, in order, the two analytic expressions for the normalized directivities of the dipole and the quadrupole. Do not include units. Do not approximate or round any quantities. Retain the angular dependence exactly.",
            "solution": "The problem is first validated. The givens are: a homogeneous, quiescent fluid with constant density $\\rho_0$ and sound speed $c_0$; spherical coordinates $(r,\\theta,\\phi)$; unit observation vector $\\mathbf{n}$; angular frequency $\\omega$; wavenumber $k = \\omega/c_0$; a compact source with radius $a$ such that $ka \\ll 1$ centered at the origin; the governing equation is the inhomogeneous Helmholtz equation; the method is a far-field ($r \\to \\infty$) compact-source multipole expansion. The goal is to find the normalized far-field directivity functions $D(\\theta,\\phi)$ for a pure $z$-aligned dipole and a pure axisymmetric, traceless $z$-aligned quadrupole. The directivity is defined as the real angular factor of the leading-order far-field pressure, normalized to a maximum magnitude of $1$.\n\nThe problem is scientifically grounded, well-posed, objective, and internally consistent. It represents a standard application of classical acoustic theory. Therefore, the problem is valid, and we proceed with the solution.\n\nThe acoustic pressure $p(\\mathbf{x})$ in the frequency domain for a source distribution $S(\\mathbf{y})$ is given by the solution to the inhomogeneous Helmholtz equation, which can be written using the free-space Green's function $G(\\mathbf{x}|\\mathbf{y})$ as:\n$$p(\\mathbf{x}) = \\int_{\\mathcal{V}} S(\\mathbf{y}) G(\\mathbf{x}|\\mathbf{y}) d^3\\mathbf{y}$$\nwhere the source $S(\\mathbf{y})$ is non-zero only within a sphere of radius $a$ around the origin. The free-space Green's function for the Helmholtz equation $(\\nabla^2 + k^2)p = -S$ in three dimensions is:\n$$G(\\mathbf{x}|\\mathbf{y}) = \\frac{\\exp(i k |\\mathbf{x} - \\mathbf{y}|)}{4 \\pi |\\mathbf{x} - \\mathbf{y}|}$$\nHere, $\\mathbf{x}$ is the observation point and $\\mathbf{y}$ is the source point.\n\nWe apply the far-field approximation, where the observer is far from the source, i.e., $r = |\\mathbf{x}| \\to \\infty$. In this limit, for a source confined to $|\\mathbf{y}| \\le a$, the distance $|\\mathbf{x} - \\mathbf{y}|$ can be approximated. For the magnitude in the denominator, $|\\mathbf{x} - \\mathbf{y}| \\approx r$. For the phase in the exponent, a more accurate approximation is needed:\n$$|\\mathbf{x} - \\mathbf{y}| = \\sqrt{r^2 - 2\\mathbf{x} \\cdot \\mathbf{y} + |\\mathbf{y}|^2} = r\\sqrt{1 - \\frac{2\\mathbf{n} \\cdot \\mathbf{y}}{r} + \\frac{|\\mathbf{y}|^2}{r^2}} \\approx r \\left(1 - \\frac{\\mathbf{n} \\cdot \\mathbf{y}}{r}\\right) = r - \\mathbf{n} \\cdot \\mathbf{y}$$\nwhere $\\mathbf{n} = \\mathbf{x}/r$ is the unit vector pointing to the observer. Substituting these into the Green's function gives the far-field approximation:\n$$G(\\mathbf{x}|\\mathbf{y}) \\approx \\frac{\\exp(i k (r - \\mathbf{n} \\cdot \\mathbf{y}))}{4 \\pi r} = \\frac{\\exp(i k r)}{4 \\pi r} \\exp(-i k \\mathbf{n} \\cdot \\mathbf{y})$$\nFor a compact source, we have $k|\\mathbf{y}| \\le ka \\ll 1$. This allows for a Taylor series expansion of the exponential term $\\exp(-i k \\mathbf{n} \\cdot \\mathbf{y})$:\n$$\\exp(-i k \\mathbf{n} \\cdot \\mathbf{y}) = \\sum_{m=0}^{\\infty} \\frac{(-i k \\mathbf{n} \\cdot \\mathbf{y})^m}{m!} = 1 - i k (\\mathbf{n} \\cdot \\mathbf{y}) + \\frac{1}{2}(-i k)^2 (\\mathbf{n} \\cdot \\mathbf{y})^2 + \\mathcal{O}((ka)^3)$$\nUsing index notation with Einstein summation, where $\\mathbf{n} = (n_1, n_2, n_3)$ and $\\mathbf{y} = (y_1, y_2, y_3)$, this is:\n$$\\exp(-i k n_j y_j) \\approx 1 - i k n_j y_j - \\frac{k^2}{2} n_j n_l y_j y_l$$\nSubstituting this expanded Green's function into the pressure integral gives the multipole expansion of the acoustic field:\n$$p(\\mathbf{x}) \\approx \\frac{\\exp(i k r)}{4 \\pi r} \\int_{\\mathcal{V}} S(\\mathbf{y}) \\left( 1 - i k n_j y_j - \\frac{k^2}{2} n_j n_l y_j y_l + \\dots \\right) d^3\\mathbf{y}$$\n$$p(\\mathbf{x}) \\approx \\frac{\\exp(i k r)}{4 \\pi r} \\left( Q_0 - i k n_j F_j - \\frac{k^2}{2} n_j n_l T_{jl} \\right)$$\nwhere we have defined the multipole moments of the source distribution:\n- Monopole moment: $Q_0 = \\int S(\\mathbf{y}) d^3\\mathbf{y}$\n- Dipole moment vector: $F_j = \\int y_j S(\\mathbf{y}) d^3\\mathbf{y}$\n- Quadrupole moment tensor: $T_{jl} = \\int y_j y_l S(\\mathbf{y}) d^3\\mathbf{y}$\n\nWe now analyze the two specific cases described in the problem.\n\n**Case 1: Pure Compact Dipole**\nFor a pure dipole source, the monopole moment is zero, $Q_0=0$. The leading-order term in the expansion is the dipole term. The pressure is:\n$$p(\\mathbf{x}) \\approx \\frac{\\exp(i k r)}{4 \\pi r} (-i k n_j F_j) = \\frac{-i k \\exp(i k r)}{4 \\pi r} (\\mathbf{n} \\cdot \\mathbf{F})$$\nThe problem states that the dipole moment vector $\\mathbf{F}$ is aligned with the $+z$ axis. Thus, $\\mathbf{F} = (0, 0, F_z)$ for some source strength $F_z$. The dot product becomes:\n$$\\mathbf{n} \\cdot \\mathbf{F} = n_z F_z = (\\cos\\theta) F_z$$\nThe pressure field is:\n$$p(\\mathbf{x}) \\approx \\left(\\frac{-i k F_z}{4 \\pi}\\right) \\cos\\theta \\frac{\\exp(i k r)}{r}$$\nThe directivity function $D(\\theta,\\phi)$ is the real angular factor that multiplies the term $\\exp(ikr)/r$, after removing all prefactors related to source strength ($F_z$), frequency ($k$), and dimensions ($4\\pi$). This factor is $\\cos\\theta$. We must then normalize it such that its maximum magnitude is $1$. The function $f(\\theta) = \\cos\\theta$ has a range of $[-1, 1]$, so its maximum magnitude is $\\max|\\cos\\theta| = 1$. The function is already normalized.\nThus, the normalized directivity for the z-aligned dipole is:\n$$D_{\\text{dipole}}(\\theta, \\phi) = \\cos\\theta$$\n\n**Case 2: Pure Compact Axisymmetric Quadrupole**\nFor a pure quadrupole source, both the monopole moment $Q_0$ and the dipole moment vector $\\mathbf{F}$ are zero. The leading-order term is the quadrupole term:\n$$p(\\mathbf{x}) \\approx \\frac{\\exp(i k r)}{4 \\pi r} \\left( -\\frac{k^2}{2} n_j n_l T_{jl} \\right)$$\nThe problem specifies that the source is an axisymmetric, traceless quadrupole with its principal axis along $z$. Its second moment tensor $T_{jl}$ is proportional to $\\mathrm{diag}(-\\frac{1}{2},-\\frac{1}{2},1)$. Let the constant of proportionality, which encapsulates the source strength, be $C_T$. Then:\n$$T_{jl} = C_T \\begin{pmatrix} -1/2 & 0 & 0 \\\\ 0 & -1/2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nWe evaluate the quadratic form $n_j n_l T_{jl}$. In Cartesian components with $\\mathbf{n} = (n_x, n_y, n_z)$:\n$$n_j n_l T_{jl} = n_x^2 T_{xx} + n_y^2 T_{yy} + n_z^2 T_{zz} = C_T \\left(-\\frac{1}{2} n_x^2 - \\frac{1}{2} n_y^2 + n_z^2 \\right)$$\nUsing the identity $n_x^2 + n_y^2 + n_z^2 = 1$ for the unit vector $\\mathbf{n}$, we have $n_x^2 + n_y^2 = 1-n_z^2$. Substituting this gives:\n$$n_j n_l T_{jl} = C_T \\left(-\\frac{1}{2}(1 - n_z^2) + n_z^2 \\right) = C_T \\left(-\\frac{1}{2} + \\frac{1}{2}n_z^2 + n_z^2 \\right) = C_T \\left(\\frac{3}{2}n_z^2 - \\frac{1}{2}\\right)$$\nIn spherical coordinates, $n_z = \\cos\\theta$. The quadratic form becomes:\n$$n_j n_l T_{jl} = C_T \\left(\\frac{3}{2}\\cos^2\\theta - \\frac{1}{2}\\right) = \\frac{C_T}{2}(3\\cos^2\\theta - 1)$$\nThe pressure field is:\n$$p(\\mathbf{x}) \\approx \\frac{\\exp(i k r)}{4 \\pi r} \\left(-\\frac{k^2}{2}\\right) \\frac{C_T}{2}(3\\cos^2\\theta - 1) = \\left(\\frac{-k^2 C_T}{16\\pi}\\right) (3\\cos^2\\theta - 1) \\frac{\\exp(i k r)}{r}$$\nThe real angular factor is $f(\\theta) = 3\\cos^2\\theta - 1$. To find the normalized directivity, we must divide this by its maximum absolute value. Let's find the extrema of $f(\\theta)$. Since $\\cos^2\\theta$ ranges from $0$ to $1$, the maximum value of $f(\\theta)$ occurs at $\\cos^2\\theta=1$ (i.e., $\\theta=0, \\pi$), giving $f_{max} = 3(1) - 1 = 2$. The minimum value occurs at $\\cos^2\\theta=0$ (i.e., $\\theta=\\pi/2$), giving $f_{min}=3(0)-1=-1$. The maximum magnitude of $f(\\theta)$ is $\\max(|2|,|-1|) = 2$.\nThe normalized directivity is therefore:\n$$D_{\\text{quad}}(\\theta, \\phi) = \\frac{3\\cos^2\\theta - 1}{2}$$\nThis expression is the Legendre polynomial of degree $2$, $P_2(\\cos\\theta)$.\n\nThe two normalized directivity functions are $D_{\\text{dipole}} = \\cos\\theta$ and $D_{\\text{quad}} = \\frac{3\\cos^2\\theta - 1}{2}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\cos\\theta & \\frac{3\\cos^{2}\\theta - 1}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The ultimate goal of computational aeroacoustics is to solve the governing equations numerically with high fidelity. This hands-on coding exercise addresses one of the most significant challenges in the field: numerical dispersion, the phenomenon where numerical schemes cause waves of different frequencies to travel at incorrect speeds. You will implement a dispersion analysis to quantify the phase speed error for various combinations of spatial and temporal discretization schemes, providing a direct understanding of how numerical choices impact the accuracy of a wave propagation simulation .",
            "id": "4118552",
            "problem": "Consider a one-dimensional linear acoustics propagation model represented by the linear advection equation $\\partial u/\\partial t + c_0 \\,\\partial u/\\partial x = 0$, where $u(x,t)$ is a scalar perturbation and $c_0$ is a constant sound speed. Computational Aeroacoustics (CAA) fundamentals often assess numerical dispersion of schemes via plane-wave analysis. Let the nondimensional wavenumber be $\\theta = k\\,\\Delta x$, where $k$ is the physical wavenumber and $\\Delta x$ is the grid spacing. For a discrete finite-difference spatial derivative and a time integrator, the discrete Fourier analysis yields a modified wavenumber $k^*(\\theta) = \\alpha(\\theta)/\\Delta x$ determined by the spatial stencil, and an amplification factor per time step $G(\\theta)$ determined by the time integrator. The numerical angular frequency $\\omega(\\theta)$ is defined by $G(\\theta) = \\exp(-\\mathrm{i}\\,\\omega(\\theta)\\,\\Delta t)$ using the principal branch of the complex argument, and the numerical phase speed is $c_{\\text{num}}(\\theta) = \\omega(\\theta)/k^*(\\theta)$. The quantity of interest is the relative phase speed error $e(\\theta) = c_{\\text{num}}(\\theta)/c_0 - 1$, expressed as a dimensionless decimal fraction.\n\nStarting from the linear advection equation and using the plane-wave ansatz $u_j^n = \\exp(\\mathrm{i}\\,(j\\,\\theta - n\\,\\omega\\,\\Delta t))$ on a uniform grid $x_j = j\\,\\Delta x$, derive the semi-discrete and fully discrete dispersion relations for combined centered finite-difference spatial schemes and explicit Runge–Kutta time integrators. Use the following centered finite-difference first-derivative stencils and their corresponding nondimensional modified wavenumber functions $\\alpha(\\theta)$:\n\n- Second-order centered difference ($p=2$): $\\alpha_{2}(\\theta) = \\sin(\\theta)$.\n- Fourth-order centered difference ($p=4$): $\\alpha_{4}(\\theta) = \\dfrac{8\\,\\sin(\\theta) - \\sin(2\\theta)}{6}$.\n- Sixth-order centered difference ($p=6$): $\\alpha_{6}(\\theta) = \\dfrac{45\\,\\sin(\\theta) - 9\\,\\sin(2\\theta) + \\sin(3\\theta)}{30}$.\n\nLet the Courant–Friedrichs–Lewy number be $\\lambda = c_0\\,\\Delta t/\\Delta x$, and let $z(\\theta) = -\\mathrm{i}\\,\\lambda\\,\\alpha(\\theta)$. For the explicit Runge–Kutta time integrators, use their stability polynomials $R(z)$ evaluated at $z(\\theta)$:\n- Second-order Runge–Kutta (Heun, $s=2$): $R_{2}(z) = 1 + z + \\dfrac{z^2}{2}$.\n- Classical fourth-order Runge–Kutta ($s=4$): $R_{4}(z) = 1 + z + \\dfrac{z^2}{2} + \\dfrac{z^3}{6} + \\dfrac{z^4}{24}$.\n\nDefine $G(\\theta) = R_{s}(z(\\theta))$, take $\\omega(\\theta) = -\\mathrm{arg}(G(\\theta))/\\Delta t$ using the principal value of the argument in $(-\\pi,\\pi]$, and compute $c_{\\text{num}}(\\theta) = \\omega(\\theta)/k^*(\\theta)$ with $k^*(\\theta) = \\alpha(\\theta)/\\Delta x$. The relative phase speed error is $e(\\theta) = c_{\\text{num}}(\\theta)/c_0 - 1$. Only evaluate $\\theta$ where $\\alpha(\\theta) \\neq 0$ to avoid division by zero (exclude $\\theta=0$ and $\\theta=\\pi$).\n\nYour task is to write a complete, runnable program that:\n1. Implements the above analysis to compute $e(\\theta)$ over a dense sampling of $\\theta \\in (\\varepsilon,\\pi-\\varepsilon)$ with $\\varepsilon = 10^{-6}$, using $N=4096$ uniformly spaced samples.\n2. For each test case below, computes three scalar metrics from $e(\\theta)$:\n   - $E_{\\max} = \\max_{\\theta} |e(\\theta)|$,\n   - $E_{\\text{mid}} = e(\\pi/3)$,\n   - $E_{\\mathrm{rms}} = \\sqrt{\\dfrac{1}{M}\\sum_{m=1}^{M} e(\\theta_m)^2}$, where $\\{\\theta_m\\}$ is the sampled set and $M=N$.\n3. Produces a single line of output containing all results for all test cases as a comma-separated list enclosed in square brackets, in the order specified below. All outputs are dimensionless decimal fractions.\n\nUse the following physical and numerical parameters for all cases unless otherwise stated:\n- Sound speed $c_0 = 340$ in $\\mathrm{m/s}$.\n- Grid spacing $\\Delta x = 10^{-3}$ in $\\mathrm{m}$.\n- The time step $\\Delta t$ is set from the specified $\\lambda$ via $\\Delta t = \\lambda\\,\\Delta x/c_0$.\n\nTest Suite (each case specified as $(p,s,\\lambda)$):\n- Case 1: $(2,2,0.3)$.\n- Case 2: $(4,4,0.5)$.\n- Case 3: $(6,4,0.9)$.\n- Case 4: $(4,2,0.9)$.\n- Case 5: $(6,4,0.05)$.\n\nYour program should produce a single line of output containing the results in the following sequence:\n$[E_{\\max}^{(1)},E_{\\text{mid}}^{(1)},E_{\\mathrm{rms}}^{(1)},E_{\\max}^{(2)},E_{\\text{mid}}^{(2)},E_{\\mathrm{rms}}^{(2)},E_{\\max}^{(3)},E_{\\text{mid}}^{(3)},E_{\\mathrm{rms}}^{(3)},E_{\\max}^{(4)},E_{\\text{mid}}^{(4)},E_{\\mathrm{rms}}^{(4)},E_{\\max}^{(5)},E_{\\text{mid}}^{(5)},E_{\\mathrm{rms}}^{(5)}]$, where superscripts indicate the case index. Each entry must be a float printed in Python’s default formatting, and all values are dimensionless decimal fractions.",
            "solution": "The problem requires a numerical dispersion analysis of several finite-difference and time-integration schemes for the one-dimensional linear advection equation, $\\partial u/\\partial t + c_0 \\,\\partial u/\\partial x = 0$. The objective is to compute the relative phase speed error $e(\\theta)$ and derive specific metrics for several combinations of spatial and temporal schemes. The analysis is based on the behavior of plane-wave solutions on a discrete grid.\n\nFirst, we establish the theoretical framework. The governing equation models wave propagation with a constant phase speed $c_0$. We discretize the spatial domain with a uniform grid $x_j = j\\,\\Delta x$ and the temporal domain with steps $t_n = n\\,\\Delta t$. The solution at grid points is denoted $u_j^n = u(x_j, t_n)$. We employ the plane-wave ansatz, a discrete form of a Fourier mode, to analyze the behavior of a single wavenumber component:\n$$\nu_j^n = \\hat{u}(k) \\exp(\\mathrm{i}(k x_j - \\omega t_n)) = \\hat{u}(k) \\exp(\\mathrm{i}(k j \\Delta x - \\omega n \\Delta t))\n$$\nIn this expression, $k$ is the physical wavenumber and $\\omega = k c_0$ is the exact angular frequency. We introduce the nondimensional wavenumber $\\theta = k\\,\\Delta x$.\n\nThe first step is semi-discretization, where the spatial derivative $\\partial u/\\partial x$ is replaced by a finite-difference approximation, which we denote as $\\delta_x u_j$. This transforms the partial differential equation (PDE) into a system of ordinary differential equations (ODEs):\n$$\n\\frac{d u_j}{d t} + c_0 (\\delta_x u_j) = 0\n$$\nFor a centered finite-difference scheme of order $p$, its action on a plane wave $e^{\\mathrm{i} j \\theta}$ is equivalent to multiplication by a factor $\\mathrm{i} k^*(\\theta) = \\mathrm{i}\\alpha_p(\\theta)/\\Delta x$. The function $\\alpha_p(\\theta)$ is derived from the Taylor series expansion of the difference operator. The problem provides the following functions for the nondimensional modified wavenumber $\\alpha(\\theta)$:\n- For $p=2$: $\\alpha_{2}(\\theta) = \\sin(\\theta)$\n- For $p=4$: $\\alpha_{4}(\\theta) = \\dfrac{8\\,\\sin(\\theta) - \\sin(2\\theta)}{6}$\n- For $p=6$: $\\alpha_{6}(\\theta) = \\dfrac{45\\,\\sin(\\theta) - 9\\,\\sin(2\\theta) + \\sin(3\\theta)}{30}$\n\nSubstituting the plane wave and the difference operator into the semi-discrete equation yields an ODE for the time-dependent amplitude at a given wavenumber, $\\hat{u}(t)$:\n$$\n\\frac{d \\hat{u}}{dt} + c_0 \\left( \\frac{\\mathrm{i}\\alpha(\\theta)}{\\Delta x} \\right) \\hat{u} = 0\n$$\nThe next step is the full discretization, where this ODE is solved using a numerical time-integration scheme. For an explicit $s$-stage Runge–Kutta method applied to an equation of the form $\\frac{dy}{dt} = \\Lambda y$, the solution after one time step $\\Delta t$ is given by $y^{n+1} = R_s(\\Lambda \\Delta t) y^n$, where $R_s(z)$ is the stability polynomial of the method. In our case, the eigenvalue is $\\Lambda = -c_0 \\mathrm{i}\\alpha(\\theta)/\\Delta x$. The argument to the stability polynomial is thus:\n$$\nz(\\theta) = \\Lambda \\Delta t = - \\frac{\\mathrm{i} c_0 \\alpha(\\theta)}{\\Delta x} \\Delta t = -\\mathrm{i} \\alpha(\\theta) \\frac{c_0 \\Delta t}{\\Delta x}\n$$\nDefining the Courant–Friedrichs–Lewy (CFL) number as $\\lambda = c_0\\,\\Delta t/\\Delta x$, we get $z(\\theta) = -\\mathrm{i}\\,\\lambda\\,\\alpha(\\theta)$. The numerical solution advances in time as $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^n$, where the amplification factor $G(\\theta)$ is given by the stability polynomial evaluated at $z(\\theta)$:\n$$\nG(\\theta) = R_s(z(\\theta))\n$$\nThe problem provides the stability polynomials for the second-order ($s=2$) and fourth-order ($s=4$) Runge–Kutta methods:\n- $R_{2}(z) = 1 + z + \\dfrac{z^2}{2}$\n- $R_{4}(z) = 1 + z + \\dfrac{z^2}{2} + \\dfrac{z^3}{6} + \\dfrac{z^4}{24}$\n\nThe numerical solution after $n$ steps is $u_j^n \\propto \\exp(\\mathrm{i} j\\theta) (G(\\theta))^n$. To analyze its phase behavior, we define a numerical angular frequency $\\omega_{\\text{num}}(\\theta)$ such that the propagation part of the solution can be written as $\\exp(-\\mathrm{i} \\omega_{\\text{num}} n \\Delta t)$. This requires setting $G(\\theta) = \\exp(-\\mathrm{i} \\omega_{\\text{num}} \\Delta t)$, assuming $\\omega_{\\text{num}}$ may be complex. The problem statement specifies using only the phase component by defining the numerical frequency (here denoted $\\omega(\\theta)$ as in the problem) as a real quantity:\n$$\n\\omega(\\theta) = -\\frac{\\mathrm{arg}(G(\\theta))}{\\Delta t}\n$$\nwhere $\\mathrm{arg}(G(\\theta))$ is the principal value of the argument of the complex number $G(\\theta)$, typically in the range $(-\\pi, \\pi]$. The numerical phase speed is then the ratio of the numerical frequency to the modified wavenumber:\n$$\nc_{\\text{num}}(\\theta) = \\frac{\\omega(\\theta)}{k^*(\\theta)} = \\frac{-\\mathrm{arg}(G(\\theta))/\\Delta t}{\\alpha(\\theta)/\\Delta x} = \\frac{-\\mathrm{arg}(G(\\theta))}{\\alpha(\\theta)} \\frac{\\Delta x}{\\Delta t}\n$$\nThe quantity of interest is the relative phase speed error, $e(\\theta)$, defined as:\n$$\ne(\\theta) = \\frac{c_{\\text{num}}(\\theta)}{c_0} - 1 = \\left( \\frac{-\\mathrm{arg}(G(\\theta))}{\\alpha(\\theta)} \\frac{\\Delta x}{\\Delta t} \\right) \\frac{1}{c_0} - 1\n$$\nBy substituting $\\lambda = c_0 \\Delta t / \\Delta x$, which implies $\\frac{\\Delta x}{c_0 \\Delta t} = \\frac{1}{\\lambda}$, we obtain a simplified expression for the error:\n$$\ne(\\theta) = \\frac{-\\mathrm{arg}(G(\\theta))}{\\lambda\\,\\alpha(\\theta)} - 1 = \\frac{-\\mathrm{arg}(R_s(-\\mathrm{i}\\,\\lambda\\,\\alpha(\\theta)))}{\\lambda\\,\\alpha(\\theta)} - 1\n$$\nThis final expression elegantly shows that the relative phase speed error is a function of only the nondimensional wavenumber $\\theta$, the CFL number $\\lambda$, and the choice of the spatial ($p$) and temporal ($s$) schemes. It is independent of the specific physical parameters $c_0$, $\\Delta x$, and $\\Delta t$.\n\nThe computational procedure is as follows:\n1.  For each test case given by $(p, s, \\lambda)$:\n2.  Generate an array of $N=4096$ uniformly spaced samples of $\\theta$ in the interval $(\\varepsilon, \\pi-\\varepsilon)$, with $\\varepsilon=10^{-6}$.\n3.  Select the corresponding function $\\alpha_p(\\theta)$ and stability polynomial $R_s(z)$.\n4.  Calculate the array of values for $\\alpha(\\theta)$.\n5.  Calculate the array of complex values $z(\\theta) = -\\mathrm{i}\\lambda\\alpha(\\theta)$.\n6.  Evaluate the stability polynomial to get the array of amplification factors $G(\\theta) = R_s(z(\\theta))$.\n7.  Compute the principal argument (phase) of each element in the $G(\\theta)$ array.\n8.  Calculate the relative phase error array $e(\\theta)$ using the simplified formula.\n9.  From the $e(\\theta)$ array, compute the three required metrics:\n    - $E_{\\max} = \\max_{\\theta} |e(\\theta)|$.\n    - $E_{\\text{mid}} = e(\\pi/3)$, evaluated at the sample point closest to $\\theta=\\pi/3$.\n    - $E_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_{m=1}^{N} e(\\theta_m)^2}$.\n10. Collect and format all metrics from all test cases into the specified output string.\n\nThis procedure is implemented in the following Python program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical dispersion error metrics for various finite-difference\n    and Runge-Kutta schemes applied to the 1D linear advection equation.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    N = 4096  # Number of samples for theta\n    epsilon = 1e-6  # Small offset for theta interval\n\n    # Define the nondimensional wavenumber theta\n    theta = np.linspace(epsilon, np.pi - epsilon, N)\n\n    # --- Scheme Definitions ---\n\n    # Nondimensional modified wavenumber alpha(theta) for centered finite-difference schemes\n    def alpha2(th):\n        return np.sin(th)\n\n    def alpha4(th):\n        return (8 * np.sin(th) - np.sin(2 * th)) / 6\n\n    def alpha6(th):\n        return (45 * np.sin(th) - 9 * np.sin(2 * th) + np.sin(3 * th)) / 30\n\n    alpha_funcs = {2: alpha2, 4: alpha4, 6: alpha6}\n\n    # Stability polynomials R(z) for explicit Runge-Kutta methods\n    def R2(z):\n        return 1 + z + 0.5 * z**2\n\n    def R4(z):\n        return 1 + z + 0.5 * z**2 + (1/6) * z**3 + (1/24) * z**4\n\n    R_funcs = {2: R2, 4: R4}\n\n    # --- Test Suite ---\n    test_cases = [\n        (2, 2, 0.3),  # Case 1\n        (4, 4, 0.5),  # Case 2\n        (6, 4, 0.9),  # Case 3\n        (4, 2, 0.9),  # Case 4\n        (6, 4, 0.05), # Case 5\n    ]\n\n    all_results = []\n\n    for p, s, lambda_val in test_cases:\n        # Select the appropriate functions for the current case\n        alpha_func = alpha_funcs.get(p)\n        R_func = R_funcs.get(s)\n\n        if not alpha_func or not R_func:\n            raise ValueError(f\"Invalid scheme parameters p={p} or s={s}\")\n\n        # --- Calculation of Relative Phase Speed Error e(theta) ---\n\n        # 1. Calculate alpha(theta) for the spatial scheme\n        alpha_theta = alpha_func(theta)\n\n        # 2. Calculate z(theta)\n        z_theta = -1j * lambda_val * alpha_theta\n\n        # 3. Calculate the amplification factor G(theta) using the stability polynomial\n        G_theta = R_func(z_theta)\n\n        # 4. Calculate the relative phase speed error e(theta)\n        # e(theta) = -arg(G(theta)) / (lambda * alpha(theta)) - 1\n        arg_G = np.angle(G_theta)\n        e_theta = -arg_G / (lambda_val * alpha_theta) - 1\n\n        # --- Calculation of Metrics ---\n\n        # E_max: Maximum absolute error\n        E_max = np.max(np.abs(e_theta))\n\n        # E_mid: Error at theta = pi/3\n        # Find the index of the theta sample closest to pi/3\n        mid_idx = np.abs(theta - np.pi / 3).argmin()\n        E_mid = e_theta[mid_idx]\n\n        # E_rms: Root mean square error\n        E_rms = np.sqrt(np.mean(e_theta**2))\n\n        # Append results for the current case\n        all_results.extend([E_max, E_mid, E_rms])\n\n    # --- Final Output ---\n    # Format the results as a comma-separated list in brackets\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}